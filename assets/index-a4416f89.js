function dP(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();function DS(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var MS={exports:{}},Sh={},LS={exports:{}},ue={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xc=Symbol.for("react.element"),hP=Symbol.for("react.portal"),fP=Symbol.for("react.fragment"),mP=Symbol.for("react.strict_mode"),pP=Symbol.for("react.profiler"),gP=Symbol.for("react.provider"),yP=Symbol.for("react.context"),vP=Symbol.for("react.forward_ref"),xP=Symbol.for("react.suspense"),wP=Symbol.for("react.memo"),_P=Symbol.for("react.lazy"),ux=Symbol.iterator;function EP(t){return t===null||typeof t!="object"?null:(t=ux&&t[ux]||t["@@iterator"],typeof t=="function"?t:null)}var FS={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},$S=Object.assign,zS={};function xo(t,e,n){this.props=t,this.context=e,this.refs=zS,this.updater=n||FS}xo.prototype.isReactComponent={};xo.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};xo.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function US(){}US.prototype=xo.prototype;function X0(t,e,n){this.props=t,this.context=e,this.refs=zS,this.updater=n||FS}var Y0=X0.prototype=new US;Y0.constructor=X0;$S(Y0,xo.prototype);Y0.isPureReactComponent=!0;var dx=Array.isArray,BS=Object.prototype.hasOwnProperty,J0={current:null},VS={key:!0,ref:!0,__self:!0,__source:!0};function HS(t,e,n){var r,i={},s=null,a=null;if(e!=null)for(r in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(s=""+e.key),e)BS.call(e,r)&&!VS.hasOwnProperty(r)&&(i[r]=e[r]);var o=arguments.length-2;if(o===1)i.children=n;else if(1<o){for(var l=Array(o),u=0;u<o;u++)l[u]=arguments[u+2];i.children=l}if(t&&t.defaultProps)for(r in o=t.defaultProps,o)i[r]===void 0&&(i[r]=o[r]);return{$$typeof:xc,type:t,key:s,ref:a,props:i,_owner:J0.current}}function SP(t,e){return{$$typeof:xc,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Z0(t){return typeof t=="object"&&t!==null&&t.$$typeof===xc}function kP(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var hx=/\/+/g;function hm(t,e){return typeof t=="object"&&t!==null&&t.key!=null?kP(""+t.key):e.toString(36)}function Ou(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case xc:case hP:a=!0}}if(a)return a=t,i=i(a),t=r===""?"."+hm(a,0):r,dx(i)?(n="",t!=null&&(n=t.replace(hx,"$&/")+"/"),Ou(i,e,n,"",function(u){return u})):i!=null&&(Z0(i)&&(i=SP(i,n+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(hx,"$&/")+"/")+t)),e.push(i)),1;if(a=0,r=r===""?".":r+":",dx(t))for(var o=0;o<t.length;o++){s=t[o];var l=r+hm(s,o);a+=Ou(s,e,n,l,i)}else if(l=EP(t),typeof l=="function")for(t=l.call(t),o=0;!(s=t.next()).done;)s=s.value,l=r+hm(s,o++),a+=Ou(s,e,n,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function Xc(t,e,n){if(t==null)return t;var r=[],i=0;return Ou(t,r,"","",function(s){return e.call(n,s,i++)}),r}function bP(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Xt={current:null},Du={transition:null},TP={ReactCurrentDispatcher:Xt,ReactCurrentBatchConfig:Du,ReactCurrentOwner:J0};ue.Children={map:Xc,forEach:function(t,e,n){Xc(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Xc(t,function(){e++}),e},toArray:function(t){return Xc(t,function(e){return e})||[]},only:function(t){if(!Z0(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ue.Component=xo;ue.Fragment=fP;ue.Profiler=pP;ue.PureComponent=X0;ue.StrictMode=mP;ue.Suspense=xP;ue.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=TP;ue.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=$S({},t.props),i=t.key,s=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,a=J0.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var o=t.type.defaultProps;for(l in e)BS.call(e,l)&&!VS.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&o!==void 0?o[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){o=Array(l);for(var u=0;u<l;u++)o[u]=arguments[u+2];r.children=o}return{$$typeof:xc,type:t.type,key:i,ref:s,props:r,_owner:a}};ue.createContext=function(t){return t={$$typeof:yP,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:gP,_context:t},t.Consumer=t};ue.createElement=HS;ue.createFactory=function(t){var e=HS.bind(null,t);return e.type=t,e};ue.createRef=function(){return{current:null}};ue.forwardRef=function(t){return{$$typeof:vP,render:t}};ue.isValidElement=Z0;ue.lazy=function(t){return{$$typeof:_P,_payload:{_status:-1,_result:t},_init:bP}};ue.memo=function(t,e){return{$$typeof:wP,type:t,compare:e===void 0?null:e}};ue.startTransition=function(t){var e=Du.transition;Du.transition={};try{t()}finally{Du.transition=e}};ue.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};ue.useCallback=function(t,e){return Xt.current.useCallback(t,e)};ue.useContext=function(t){return Xt.current.useContext(t)};ue.useDebugValue=function(){};ue.useDeferredValue=function(t){return Xt.current.useDeferredValue(t)};ue.useEffect=function(t,e){return Xt.current.useEffect(t,e)};ue.useId=function(){return Xt.current.useId()};ue.useImperativeHandle=function(t,e,n){return Xt.current.useImperativeHandle(t,e,n)};ue.useInsertionEffect=function(t,e){return Xt.current.useInsertionEffect(t,e)};ue.useLayoutEffect=function(t,e){return Xt.current.useLayoutEffect(t,e)};ue.useMemo=function(t,e){return Xt.current.useMemo(t,e)};ue.useReducer=function(t,e,n){return Xt.current.useReducer(t,e,n)};ue.useRef=function(t){return Xt.current.useRef(t)};ue.useState=function(t){return Xt.current.useState(t)};ue.useSyncExternalStore=function(t,e,n){return Xt.current.useSyncExternalStore(t,e,n)};ue.useTransition=function(){return Xt.current.useTransition()};ue.version="18.2.0";LS.exports=ue;var f=LS.exports;const WS=DS(f),IP=dP({__proto__:null,default:WS},[f]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var CP=f,AP=Symbol.for("react.element"),RP=Symbol.for("react.fragment"),PP=Object.prototype.hasOwnProperty,NP=CP.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,jP={key:!0,ref:!0,__self:!0,__source:!0};function qS(t,e,n){var r,i={},s=null,a=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(a=e.ref);for(r in e)PP.call(e,r)&&!jP.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:AP,type:t,key:s,ref:a,props:i,_owner:NP.current}}Sh.Fragment=RP;Sh.jsx=qS;Sh.jsxs=qS;MS.exports=Sh;var c=MS.exports;var zp={},GS={exports:{}},bn={},KS={exports:{}},QS={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(D,G){var Y=D.length;D.push(G);e:for(;0<Y;){var Se=Y-1>>>1,le=D[Se];if(0<i(le,G))D[Se]=G,D[Y]=le,Y=Se;else break e}}function n(D){return D.length===0?null:D[0]}function r(D){if(D.length===0)return null;var G=D[0],Y=D.pop();if(Y!==G){D[0]=Y;e:for(var Se=0,le=D.length,cn=le>>>1;Se<cn;){var ae=2*(Se+1)-1,lt=D[ae],vt=ae+1,Xe=D[vt];if(0>i(lt,Y))vt<le&&0>i(Xe,lt)?(D[Se]=Xe,D[vt]=Y,Se=vt):(D[Se]=lt,D[ae]=Y,Se=ae);else if(vt<le&&0>i(Xe,Y))D[Se]=Xe,D[vt]=Y,Se=vt;else break e}}return G}function i(D,G){var Y=D.sortIndex-G.sortIndex;return Y!==0?Y:D.id-G.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();t.unstable_now=function(){return a.now()-o}}var l=[],u=[],d=1,h=null,m=3,p=!1,g=!1,w=!1,E=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(D){for(var G=n(u);G!==null;){if(G.callback===null)r(u);else if(G.startTime<=D)r(u),G.sortIndex=G.expirationTime,e(l,G);else break;G=n(u)}}function _(D){if(w=!1,x(D),!g)if(n(l)!==null)g=!0,nt(S);else{var G=n(u);G!==null&&De(_,G.startTime-D)}}function S(D,G){g=!1,w&&(w=!1,v(T),T=-1),p=!0;var Y=m;try{for(x(G),h=n(l);h!==null&&(!(h.expirationTime>G)||D&&!B());){var Se=h.callback;if(typeof Se=="function"){h.callback=null,m=h.priorityLevel;var le=Se(h.expirationTime<=G);G=t.unstable_now(),typeof le=="function"?h.callback=le:h===n(l)&&r(l),x(G)}else r(l);h=n(l)}if(h!==null)var cn=!0;else{var ae=n(u);ae!==null&&De(_,ae.startTime-G),cn=!1}return cn}finally{h=null,m=Y,p=!1}}var k=!1,b=null,T=-1,P=5,N=-1;function B(){return!(t.unstable_now()-N<P)}function F(){if(b!==null){var D=t.unstable_now();N=D;var G=!0;try{G=b(!0,D)}finally{G?$():(k=!1,b=null)}}else k=!1}var $;if(typeof y=="function")$=function(){y(F)};else if(typeof MessageChannel<"u"){var L=new MessageChannel,Oe=L.port2;L.port1.onmessage=F,$=function(){Oe.postMessage(null)}}else $=function(){E(F,0)};function nt(D){b=D,k||(k=!0,$())}function De(D,G){T=E(function(){D(t.unstable_now())},G)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(D){D.callback=null},t.unstable_continueExecution=function(){g||p||(g=!0,nt(S))},t.unstable_forceFrameRate=function(D){0>D||125<D?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<D?Math.floor(1e3/D):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(D){switch(m){case 1:case 2:case 3:var G=3;break;default:G=m}var Y=m;m=G;try{return D()}finally{m=Y}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(D,G){switch(D){case 1:case 2:case 3:case 4:case 5:break;default:D=3}var Y=m;m=D;try{return G()}finally{m=Y}},t.unstable_scheduleCallback=function(D,G,Y){var Se=t.unstable_now();switch(typeof Y=="object"&&Y!==null?(Y=Y.delay,Y=typeof Y=="number"&&0<Y?Se+Y:Se):Y=Se,D){case 1:var le=-1;break;case 2:le=250;break;case 5:le=1073741823;break;case 4:le=1e4;break;default:le=5e3}return le=Y+le,D={id:d++,callback:G,priorityLevel:D,startTime:Y,expirationTime:le,sortIndex:-1},Y>Se?(D.sortIndex=Y,e(u,D),n(l)===null&&D===n(u)&&(w?(v(T),T=-1):w=!0,De(_,Y-Se))):(D.sortIndex=le,e(l,D),g||p||(g=!0,nt(S))),D},t.unstable_shouldYield=B,t.unstable_wrapCallback=function(D){var G=m;return function(){var Y=m;m=G;try{return D.apply(this,arguments)}finally{m=Y}}}})(QS);KS.exports=QS;var OP=KS.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var XS=f,En=OP;function j(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var YS=new Set,Cl={};function Gs(t,e){Ha(t,e),Ha(t+"Capture",e)}function Ha(t,e){for(Cl[t]=e,t=0;t<e.length;t++)YS.add(e[t])}var Yr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Up=Object.prototype.hasOwnProperty,DP=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,fx={},mx={};function MP(t){return Up.call(mx,t)?!0:Up.call(fx,t)?!1:DP.test(t)?mx[t]=!0:(fx[t]=!0,!1)}function LP(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function FP(t,e,n,r){if(e===null||typeof e>"u"||LP(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Yt(t,e,n,r,i,s,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=a}var Tt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Tt[t]=new Yt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Tt[e]=new Yt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Tt[t]=new Yt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Tt[t]=new Yt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Tt[t]=new Yt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Tt[t]=new Yt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Tt[t]=new Yt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Tt[t]=new Yt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Tt[t]=new Yt(t,5,!1,t.toLowerCase(),null,!1,!1)});var ey=/[\-:]([a-z])/g;function ty(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(ey,ty);Tt[e]=new Yt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(ey,ty);Tt[e]=new Yt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(ey,ty);Tt[e]=new Yt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Tt[t]=new Yt(t,1,!1,t.toLowerCase(),null,!1,!1)});Tt.xlinkHref=new Yt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Tt[t]=new Yt(t,1,!1,t.toLowerCase(),null,!0,!0)});function ny(t,e,n,r){var i=Tt.hasOwnProperty(e)?Tt[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(FP(e,n,i,r)&&(n=null),r||i===null?MP(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var oi=XS.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Yc=Symbol.for("react.element"),ma=Symbol.for("react.portal"),pa=Symbol.for("react.fragment"),ry=Symbol.for("react.strict_mode"),Bp=Symbol.for("react.profiler"),JS=Symbol.for("react.provider"),ZS=Symbol.for("react.context"),iy=Symbol.for("react.forward_ref"),Vp=Symbol.for("react.suspense"),Hp=Symbol.for("react.suspense_list"),sy=Symbol.for("react.memo"),pi=Symbol.for("react.lazy"),e2=Symbol.for("react.offscreen"),px=Symbol.iterator;function Lo(t){return t===null||typeof t!="object"?null:(t=px&&t[px]||t["@@iterator"],typeof t=="function"?t:null)}var Fe=Object.assign,fm;function el(t){if(fm===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);fm=e&&e[1]||""}return`
`+fm+t}var mm=!1;function pm(t,e){if(!t||mm)return"";mm=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=r.stack.split(`
`),a=i.length-1,o=s.length-1;1<=a&&0<=o&&i[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(i[a]!==s[o]){if(a!==1||o!==1)do if(a--,o--,0>o||i[a]!==s[o]){var l=`
`+i[a].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=a&&0<=o);break}}}finally{mm=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?el(t):""}function $P(t){switch(t.tag){case 5:return el(t.type);case 16:return el("Lazy");case 13:return el("Suspense");case 19:return el("SuspenseList");case 0:case 2:case 15:return t=pm(t.type,!1),t;case 11:return t=pm(t.type.render,!1),t;case 1:return t=pm(t.type,!0),t;default:return""}}function Wp(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case pa:return"Fragment";case ma:return"Portal";case Bp:return"Profiler";case ry:return"StrictMode";case Vp:return"Suspense";case Hp:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case ZS:return(t.displayName||"Context")+".Consumer";case JS:return(t._context.displayName||"Context")+".Provider";case iy:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case sy:return e=t.displayName||null,e!==null?e:Wp(t.type)||"Memo";case pi:e=t._payload,t=t._init;try{return Wp(t(e))}catch{}}return null}function zP(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Wp(e);case 8:return e===ry?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Vi(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function t2(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function UP(t){var e=t2(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(a){r=""+a,s.call(this,a)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Jc(t){t._valueTracker||(t._valueTracker=UP(t))}function n2(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=t2(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function id(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function qp(t,e){var n=e.checked;return Fe({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function gx(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Vi(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function r2(t,e){e=e.checked,e!=null&&ny(t,"checked",e,!1)}function Gp(t,e){r2(t,e);var n=Vi(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Kp(t,e.type,n):e.hasOwnProperty("defaultValue")&&Kp(t,e.type,Vi(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function yx(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Kp(t,e,n){(e!=="number"||id(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var tl=Array.isArray;function Aa(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Vi(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Qp(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(j(91));return Fe({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function vx(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(j(92));if(tl(n)){if(1<n.length)throw Error(j(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Vi(n)}}function i2(t,e){var n=Vi(e.value),r=Vi(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function xx(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function s2(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Xp(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?s2(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Zc,a2=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Zc=Zc||document.createElement("div"),Zc.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Zc.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Al(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var dl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},BP=["Webkit","ms","Moz","O"];Object.keys(dl).forEach(function(t){BP.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),dl[e]=dl[t]})});function o2(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||dl.hasOwnProperty(t)&&dl[t]?(""+e).trim():e+"px"}function l2(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=o2(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var VP=Fe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Yp(t,e){if(e){if(VP[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(j(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(j(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(j(61))}if(e.style!=null&&typeof e.style!="object")throw Error(j(62))}}function Jp(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Zp=null;function ay(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var eg=null,Ra=null,Pa=null;function wx(t){if(t=Ec(t)){if(typeof eg!="function")throw Error(j(280));var e=t.stateNode;e&&(e=Ch(e),eg(t.stateNode,t.type,e))}}function c2(t){Ra?Pa?Pa.push(t):Pa=[t]:Ra=t}function u2(){if(Ra){var t=Ra,e=Pa;if(Pa=Ra=null,wx(t),e)for(t=0;t<e.length;t++)wx(e[t])}}function d2(t,e){return t(e)}function h2(){}var gm=!1;function f2(t,e,n){if(gm)return t(e,n);gm=!0;try{return d2(t,e,n)}finally{gm=!1,(Ra!==null||Pa!==null)&&(h2(),u2())}}function Rl(t,e){var n=t.stateNode;if(n===null)return null;var r=Ch(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(j(231,e,typeof n));return n}var tg=!1;if(Yr)try{var Fo={};Object.defineProperty(Fo,"passive",{get:function(){tg=!0}}),window.addEventListener("test",Fo,Fo),window.removeEventListener("test",Fo,Fo)}catch{tg=!1}function HP(t,e,n,r,i,s,a,o,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(d){this.onError(d)}}var hl=!1,sd=null,ad=!1,ng=null,WP={onError:function(t){hl=!0,sd=t}};function qP(t,e,n,r,i,s,a,o,l){hl=!1,sd=null,HP.apply(WP,arguments)}function GP(t,e,n,r,i,s,a,o,l){if(qP.apply(this,arguments),hl){if(hl){var u=sd;hl=!1,sd=null}else throw Error(j(198));ad||(ad=!0,ng=u)}}function Ks(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function m2(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function _x(t){if(Ks(t)!==t)throw Error(j(188))}function KP(t){var e=t.alternate;if(!e){if(e=Ks(t),e===null)throw Error(j(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return _x(i),t;if(s===r)return _x(i),e;s=s.sibling}throw Error(j(188))}if(n.return!==r.return)n=i,r=s;else{for(var a=!1,o=i.child;o;){if(o===n){a=!0,n=i,r=s;break}if(o===r){a=!0,r=i,n=s;break}o=o.sibling}if(!a){for(o=s.child;o;){if(o===n){a=!0,n=s,r=i;break}if(o===r){a=!0,r=s,n=i;break}o=o.sibling}if(!a)throw Error(j(189))}}if(n.alternate!==r)throw Error(j(190))}if(n.tag!==3)throw Error(j(188));return n.stateNode.current===n?t:e}function p2(t){return t=KP(t),t!==null?g2(t):null}function g2(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=g2(t);if(e!==null)return e;t=t.sibling}return null}var y2=En.unstable_scheduleCallback,Ex=En.unstable_cancelCallback,QP=En.unstable_shouldYield,XP=En.unstable_requestPaint,Ge=En.unstable_now,YP=En.unstable_getCurrentPriorityLevel,oy=En.unstable_ImmediatePriority,v2=En.unstable_UserBlockingPriority,od=En.unstable_NormalPriority,JP=En.unstable_LowPriority,x2=En.unstable_IdlePriority,kh=null,xr=null;function ZP(t){if(xr&&typeof xr.onCommitFiberRoot=="function")try{xr.onCommitFiberRoot(kh,t,void 0,(t.current.flags&128)===128)}catch{}}var Zn=Math.clz32?Math.clz32:n4,e4=Math.log,t4=Math.LN2;function n4(t){return t>>>=0,t===0?32:31-(e4(t)/t4|0)|0}var eu=64,tu=4194304;function nl(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function ld(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,a=n&268435455;if(a!==0){var o=a&~i;o!==0?r=nl(o):(s&=a,s!==0&&(r=nl(s)))}else a=n&~i,a!==0?r=nl(a):s!==0&&(r=nl(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Zn(e),i=1<<n,r|=t[n],e&=~i;return r}function r4(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function i4(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var a=31-Zn(s),o=1<<a,l=i[a];l===-1?(!(o&n)||o&r)&&(i[a]=r4(o,e)):l<=e&&(t.expiredLanes|=o),s&=~o}}function rg(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function w2(){var t=eu;return eu<<=1,!(eu&4194240)&&(eu=64),t}function ym(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function wc(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Zn(e),t[e]=n}function s4(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-Zn(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function ly(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Zn(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var ve=0;function _2(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var E2,cy,S2,k2,b2,ig=!1,nu=[],Ai=null,Ri=null,Pi=null,Pl=new Map,Nl=new Map,yi=[],a4="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Sx(t,e){switch(t){case"focusin":case"focusout":Ai=null;break;case"dragenter":case"dragleave":Ri=null;break;case"mouseover":case"mouseout":Pi=null;break;case"pointerover":case"pointerout":Pl.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Nl.delete(e.pointerId)}}function $o(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=Ec(e),e!==null&&cy(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function o4(t,e,n,r,i){switch(e){case"focusin":return Ai=$o(Ai,t,e,n,r,i),!0;case"dragenter":return Ri=$o(Ri,t,e,n,r,i),!0;case"mouseover":return Pi=$o(Pi,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return Pl.set(s,$o(Pl.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,Nl.set(s,$o(Nl.get(s)||null,t,e,n,r,i)),!0}return!1}function T2(t){var e=gs(t.target);if(e!==null){var n=Ks(e);if(n!==null){if(e=n.tag,e===13){if(e=m2(n),e!==null){t.blockedOn=e,b2(t.priority,function(){S2(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Mu(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=sg(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Zp=r,n.target.dispatchEvent(r),Zp=null}else return e=Ec(n),e!==null&&cy(e),t.blockedOn=n,!1;e.shift()}return!0}function kx(t,e,n){Mu(t)&&n.delete(e)}function l4(){ig=!1,Ai!==null&&Mu(Ai)&&(Ai=null),Ri!==null&&Mu(Ri)&&(Ri=null),Pi!==null&&Mu(Pi)&&(Pi=null),Pl.forEach(kx),Nl.forEach(kx)}function zo(t,e){t.blockedOn===e&&(t.blockedOn=null,ig||(ig=!0,En.unstable_scheduleCallback(En.unstable_NormalPriority,l4)))}function jl(t){function e(i){return zo(i,t)}if(0<nu.length){zo(nu[0],t);for(var n=1;n<nu.length;n++){var r=nu[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Ai!==null&&zo(Ai,t),Ri!==null&&zo(Ri,t),Pi!==null&&zo(Pi,t),Pl.forEach(e),Nl.forEach(e),n=0;n<yi.length;n++)r=yi[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<yi.length&&(n=yi[0],n.blockedOn===null);)T2(n),n.blockedOn===null&&yi.shift()}var Na=oi.ReactCurrentBatchConfig,cd=!0;function c4(t,e,n,r){var i=ve,s=Na.transition;Na.transition=null;try{ve=1,uy(t,e,n,r)}finally{ve=i,Na.transition=s}}function u4(t,e,n,r){var i=ve,s=Na.transition;Na.transition=null;try{ve=4,uy(t,e,n,r)}finally{ve=i,Na.transition=s}}function uy(t,e,n,r){if(cd){var i=sg(t,e,n,r);if(i===null)Im(t,e,r,ud,n),Sx(t,r);else if(o4(i,t,e,n,r))r.stopPropagation();else if(Sx(t,r),e&4&&-1<a4.indexOf(t)){for(;i!==null;){var s=Ec(i);if(s!==null&&E2(s),s=sg(t,e,n,r),s===null&&Im(t,e,r,ud,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else Im(t,e,r,null,n)}}var ud=null;function sg(t,e,n,r){if(ud=null,t=ay(r),t=gs(t),t!==null)if(e=Ks(t),e===null)t=null;else if(n=e.tag,n===13){if(t=m2(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return ud=t,null}function I2(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(YP()){case oy:return 1;case v2:return 4;case od:case JP:return 16;case x2:return 536870912;default:return 16}default:return 16}}var bi=null,dy=null,Lu=null;function C2(){if(Lu)return Lu;var t,e=dy,n=e.length,r,i="value"in bi?bi.value:bi.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var a=n-t;for(r=1;r<=a&&e[n-r]===i[s-r];r++);return Lu=i.slice(t,1<r?1-r:void 0)}function Fu(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function ru(){return!0}function bx(){return!1}function Tn(t){function e(n,r,i,s,a){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(n=t[o],this[o]=n?n(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?ru:bx,this.isPropagationStopped=bx,this}return Fe(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=ru)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=ru)},persist:function(){},isPersistent:ru}),e}var wo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},hy=Tn(wo),_c=Fe({},wo,{view:0,detail:0}),d4=Tn(_c),vm,xm,Uo,bh=Fe({},_c,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:fy,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Uo&&(Uo&&t.type==="mousemove"?(vm=t.screenX-Uo.screenX,xm=t.screenY-Uo.screenY):xm=vm=0,Uo=t),vm)},movementY:function(t){return"movementY"in t?t.movementY:xm}}),Tx=Tn(bh),h4=Fe({},bh,{dataTransfer:0}),f4=Tn(h4),m4=Fe({},_c,{relatedTarget:0}),wm=Tn(m4),p4=Fe({},wo,{animationName:0,elapsedTime:0,pseudoElement:0}),g4=Tn(p4),y4=Fe({},wo,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),v4=Tn(y4),x4=Fe({},wo,{data:0}),Ix=Tn(x4),w4={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},_4={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},E4={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function S4(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=E4[t])?!!e[t]:!1}function fy(){return S4}var k4=Fe({},_c,{key:function(t){if(t.key){var e=w4[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Fu(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?_4[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:fy,charCode:function(t){return t.type==="keypress"?Fu(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Fu(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),b4=Tn(k4),T4=Fe({},bh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Cx=Tn(T4),I4=Fe({},_c,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:fy}),C4=Tn(I4),A4=Fe({},wo,{propertyName:0,elapsedTime:0,pseudoElement:0}),R4=Tn(A4),P4=Fe({},bh,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),N4=Tn(P4),j4=[9,13,27,32],my=Yr&&"CompositionEvent"in window,fl=null;Yr&&"documentMode"in document&&(fl=document.documentMode);var O4=Yr&&"TextEvent"in window&&!fl,A2=Yr&&(!my||fl&&8<fl&&11>=fl),Ax=String.fromCharCode(32),Rx=!1;function R2(t,e){switch(t){case"keyup":return j4.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function P2(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var ga=!1;function D4(t,e){switch(t){case"compositionend":return P2(e);case"keypress":return e.which!==32?null:(Rx=!0,Ax);case"textInput":return t=e.data,t===Ax&&Rx?null:t;default:return null}}function M4(t,e){if(ga)return t==="compositionend"||!my&&R2(t,e)?(t=C2(),Lu=dy=bi=null,ga=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return A2&&e.locale!=="ko"?null:e.data;default:return null}}var L4={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Px(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!L4[t.type]:e==="textarea"}function N2(t,e,n,r){c2(r),e=dd(e,"onChange"),0<e.length&&(n=new hy("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var ml=null,Ol=null;function F4(t){V2(t,0)}function Th(t){var e=xa(t);if(n2(e))return t}function $4(t,e){if(t==="change")return e}var j2=!1;if(Yr){var _m;if(Yr){var Em="oninput"in document;if(!Em){var Nx=document.createElement("div");Nx.setAttribute("oninput","return;"),Em=typeof Nx.oninput=="function"}_m=Em}else _m=!1;j2=_m&&(!document.documentMode||9<document.documentMode)}function jx(){ml&&(ml.detachEvent("onpropertychange",O2),Ol=ml=null)}function O2(t){if(t.propertyName==="value"&&Th(Ol)){var e=[];N2(e,Ol,t,ay(t)),f2(F4,e)}}function z4(t,e,n){t==="focusin"?(jx(),ml=e,Ol=n,ml.attachEvent("onpropertychange",O2)):t==="focusout"&&jx()}function U4(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Th(Ol)}function B4(t,e){if(t==="click")return Th(e)}function V4(t,e){if(t==="input"||t==="change")return Th(e)}function H4(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var tr=typeof Object.is=="function"?Object.is:H4;function Dl(t,e){if(tr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!Up.call(e,i)||!tr(t[i],e[i]))return!1}return!0}function Ox(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Dx(t,e){var n=Ox(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Ox(n)}}function D2(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?D2(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function M2(){for(var t=window,e=id();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=id(t.document)}return e}function py(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function W4(t){var e=M2(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&D2(n.ownerDocument.documentElement,n)){if(r!==null&&py(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=Dx(n,s);var a=Dx(n,r);i&&a&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var q4=Yr&&"documentMode"in document&&11>=document.documentMode,ya=null,ag=null,pl=null,og=!1;function Mx(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;og||ya==null||ya!==id(r)||(r=ya,"selectionStart"in r&&py(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),pl&&Dl(pl,r)||(pl=r,r=dd(ag,"onSelect"),0<r.length&&(e=new hy("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=ya)))}function iu(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var va={animationend:iu("Animation","AnimationEnd"),animationiteration:iu("Animation","AnimationIteration"),animationstart:iu("Animation","AnimationStart"),transitionend:iu("Transition","TransitionEnd")},Sm={},L2={};Yr&&(L2=document.createElement("div").style,"AnimationEvent"in window||(delete va.animationend.animation,delete va.animationiteration.animation,delete va.animationstart.animation),"TransitionEvent"in window||delete va.transitionend.transition);function Ih(t){if(Sm[t])return Sm[t];if(!va[t])return t;var e=va[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in L2)return Sm[t]=e[n];return t}var F2=Ih("animationend"),$2=Ih("animationiteration"),z2=Ih("animationstart"),U2=Ih("transitionend"),B2=new Map,Lx="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function es(t,e){B2.set(t,e),Gs(e,[t])}for(var km=0;km<Lx.length;km++){var bm=Lx[km],G4=bm.toLowerCase(),K4=bm[0].toUpperCase()+bm.slice(1);es(G4,"on"+K4)}es(F2,"onAnimationEnd");es($2,"onAnimationIteration");es(z2,"onAnimationStart");es("dblclick","onDoubleClick");es("focusin","onFocus");es("focusout","onBlur");es(U2,"onTransitionEnd");Ha("onMouseEnter",["mouseout","mouseover"]);Ha("onMouseLeave",["mouseout","mouseover"]);Ha("onPointerEnter",["pointerout","pointerover"]);Ha("onPointerLeave",["pointerout","pointerover"]);Gs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Gs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Gs("onBeforeInput",["compositionend","keypress","textInput","paste"]);Gs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Gs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Gs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var rl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Q4=new Set("cancel close invalid load scroll toggle".split(" ").concat(rl));function Fx(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,GP(r,e,void 0,t),t.currentTarget=null}function V2(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var a=r.length-1;0<=a;a--){var o=r[a],l=o.instance,u=o.currentTarget;if(o=o.listener,l!==s&&i.isPropagationStopped())break e;Fx(i,o,u),s=l}else for(a=0;a<r.length;a++){if(o=r[a],l=o.instance,u=o.currentTarget,o=o.listener,l!==s&&i.isPropagationStopped())break e;Fx(i,o,u),s=l}}}if(ad)throw t=ng,ad=!1,ng=null,t}function Te(t,e){var n=e[hg];n===void 0&&(n=e[hg]=new Set);var r=t+"__bubble";n.has(r)||(H2(e,t,2,!1),n.add(r))}function Tm(t,e,n){var r=0;e&&(r|=4),H2(n,t,r,e)}var su="_reactListening"+Math.random().toString(36).slice(2);function Ml(t){if(!t[su]){t[su]=!0,YS.forEach(function(n){n!=="selectionchange"&&(Q4.has(n)||Tm(n,!1,t),Tm(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[su]||(e[su]=!0,Tm("selectionchange",!1,e))}}function H2(t,e,n,r){switch(I2(e)){case 1:var i=c4;break;case 4:i=u4;break;default:i=uy}n=i.bind(null,e,n,t),i=void 0,!tg||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function Im(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var o=r.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(a===4)for(a=r.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;a=a.return}for(;o!==null;){if(a=gs(o),a===null)return;if(l=a.tag,l===5||l===6){r=s=a;continue e}o=o.parentNode}}r=r.return}f2(function(){var u=s,d=ay(n),h=[];e:{var m=B2.get(t);if(m!==void 0){var p=hy,g=t;switch(t){case"keypress":if(Fu(n)===0)break e;case"keydown":case"keyup":p=b4;break;case"focusin":g="focus",p=wm;break;case"focusout":g="blur",p=wm;break;case"beforeblur":case"afterblur":p=wm;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=Tx;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=f4;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=C4;break;case F2:case $2:case z2:p=g4;break;case U2:p=R4;break;case"scroll":p=d4;break;case"wheel":p=N4;break;case"copy":case"cut":case"paste":p=v4;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=Cx}var w=(e&4)!==0,E=!w&&t==="scroll",v=w?m!==null?m+"Capture":null:m;w=[];for(var y=u,x;y!==null;){x=y;var _=x.stateNode;if(x.tag===5&&_!==null&&(x=_,v!==null&&(_=Rl(y,v),_!=null&&w.push(Ll(y,_,x)))),E)break;y=y.return}0<w.length&&(m=new p(m,g,null,n,d),h.push({event:m,listeners:w}))}}if(!(e&7)){e:{if(m=t==="mouseover"||t==="pointerover",p=t==="mouseout"||t==="pointerout",m&&n!==Zp&&(g=n.relatedTarget||n.fromElement)&&(gs(g)||g[Jr]))break e;if((p||m)&&(m=d.window===d?d:(m=d.ownerDocument)?m.defaultView||m.parentWindow:window,p?(g=n.relatedTarget||n.toElement,p=u,g=g?gs(g):null,g!==null&&(E=Ks(g),g!==E||g.tag!==5&&g.tag!==6)&&(g=null)):(p=null,g=u),p!==g)){if(w=Tx,_="onMouseLeave",v="onMouseEnter",y="mouse",(t==="pointerout"||t==="pointerover")&&(w=Cx,_="onPointerLeave",v="onPointerEnter",y="pointer"),E=p==null?m:xa(p),x=g==null?m:xa(g),m=new w(_,y+"leave",p,n,d),m.target=E,m.relatedTarget=x,_=null,gs(d)===u&&(w=new w(v,y+"enter",g,n,d),w.target=x,w.relatedTarget=E,_=w),E=_,p&&g)t:{for(w=p,v=g,y=0,x=w;x;x=aa(x))y++;for(x=0,_=v;_;_=aa(_))x++;for(;0<y-x;)w=aa(w),y--;for(;0<x-y;)v=aa(v),x--;for(;y--;){if(w===v||v!==null&&w===v.alternate)break t;w=aa(w),v=aa(v)}w=null}else w=null;p!==null&&$x(h,m,p,w,!1),g!==null&&E!==null&&$x(h,E,g,w,!0)}}e:{if(m=u?xa(u):window,p=m.nodeName&&m.nodeName.toLowerCase(),p==="select"||p==="input"&&m.type==="file")var S=$4;else if(Px(m))if(j2)S=V4;else{S=U4;var k=z4}else(p=m.nodeName)&&p.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(S=B4);if(S&&(S=S(t,u))){N2(h,S,n,d);break e}k&&k(t,m,u),t==="focusout"&&(k=m._wrapperState)&&k.controlled&&m.type==="number"&&Kp(m,"number",m.value)}switch(k=u?xa(u):window,t){case"focusin":(Px(k)||k.contentEditable==="true")&&(ya=k,ag=u,pl=null);break;case"focusout":pl=ag=ya=null;break;case"mousedown":og=!0;break;case"contextmenu":case"mouseup":case"dragend":og=!1,Mx(h,n,d);break;case"selectionchange":if(q4)break;case"keydown":case"keyup":Mx(h,n,d)}var b;if(my)e:{switch(t){case"compositionstart":var T="onCompositionStart";break e;case"compositionend":T="onCompositionEnd";break e;case"compositionupdate":T="onCompositionUpdate";break e}T=void 0}else ga?R2(t,n)&&(T="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(T="onCompositionStart");T&&(A2&&n.locale!=="ko"&&(ga||T!=="onCompositionStart"?T==="onCompositionEnd"&&ga&&(b=C2()):(bi=d,dy="value"in bi?bi.value:bi.textContent,ga=!0)),k=dd(u,T),0<k.length&&(T=new Ix(T,t,null,n,d),h.push({event:T,listeners:k}),b?T.data=b:(b=P2(n),b!==null&&(T.data=b)))),(b=O4?D4(t,n):M4(t,n))&&(u=dd(u,"onBeforeInput"),0<u.length&&(d=new Ix("onBeforeInput","beforeinput",null,n,d),h.push({event:d,listeners:u}),d.data=b))}V2(h,e)})}function Ll(t,e,n){return{instance:t,listener:e,currentTarget:n}}function dd(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Rl(t,n),s!=null&&r.unshift(Ll(t,s,i)),s=Rl(t,e),s!=null&&r.push(Ll(t,s,i))),t=t.return}return r}function aa(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function $x(t,e,n,r,i){for(var s=e._reactName,a=[];n!==null&&n!==r;){var o=n,l=o.alternate,u=o.stateNode;if(l!==null&&l===r)break;o.tag===5&&u!==null&&(o=u,i?(l=Rl(n,s),l!=null&&a.unshift(Ll(n,l,o))):i||(l=Rl(n,s),l!=null&&a.push(Ll(n,l,o)))),n=n.return}a.length!==0&&t.push({event:e,listeners:a})}var X4=/\r\n?/g,Y4=/\u0000|\uFFFD/g;function zx(t){return(typeof t=="string"?t:""+t).replace(X4,`
`).replace(Y4,"")}function au(t,e,n){if(e=zx(e),zx(t)!==e&&n)throw Error(j(425))}function hd(){}var lg=null,cg=null;function ug(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var dg=typeof setTimeout=="function"?setTimeout:void 0,J4=typeof clearTimeout=="function"?clearTimeout:void 0,Ux=typeof Promise=="function"?Promise:void 0,Z4=typeof queueMicrotask=="function"?queueMicrotask:typeof Ux<"u"?function(t){return Ux.resolve(null).then(t).catch(eN)}:dg;function eN(t){setTimeout(function(){throw t})}function Cm(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),jl(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);jl(e)}function Ni(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Bx(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var _o=Math.random().toString(36).slice(2),dr="__reactFiber$"+_o,Fl="__reactProps$"+_o,Jr="__reactContainer$"+_o,hg="__reactEvents$"+_o,tN="__reactListeners$"+_o,nN="__reactHandles$"+_o;function gs(t){var e=t[dr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Jr]||n[dr]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Bx(t);t!==null;){if(n=t[dr])return n;t=Bx(t)}return e}t=n,n=t.parentNode}return null}function Ec(t){return t=t[dr]||t[Jr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function xa(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(j(33))}function Ch(t){return t[Fl]||null}var fg=[],wa=-1;function ts(t){return{current:t}}function Ae(t){0>wa||(t.current=fg[wa],fg[wa]=null,wa--)}function be(t,e){wa++,fg[wa]=t.current,t.current=e}var Hi={},$t=ts(Hi),rn=ts(!1),Cs=Hi;function Wa(t,e){var n=t.type.contextTypes;if(!n)return Hi;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function sn(t){return t=t.childContextTypes,t!=null}function fd(){Ae(rn),Ae($t)}function Vx(t,e,n){if($t.current!==Hi)throw Error(j(168));be($t,e),be(rn,n)}function W2(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(j(108,zP(t)||"Unknown",i));return Fe({},n,r)}function md(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Hi,Cs=$t.current,be($t,t),be(rn,rn.current),!0}function Hx(t,e,n){var r=t.stateNode;if(!r)throw Error(j(169));n?(t=W2(t,e,Cs),r.__reactInternalMemoizedMergedChildContext=t,Ae(rn),Ae($t),be($t,t)):Ae(rn),be(rn,n)}var $r=null,Ah=!1,Am=!1;function q2(t){$r===null?$r=[t]:$r.push(t)}function rN(t){Ah=!0,q2(t)}function ns(){if(!Am&&$r!==null){Am=!0;var t=0,e=ve;try{var n=$r;for(ve=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}$r=null,Ah=!1}catch(i){throw $r!==null&&($r=$r.slice(t+1)),y2(oy,ns),i}finally{ve=e,Am=!1}}return null}var _a=[],Ea=0,pd=null,gd=0,Rn=[],Pn=0,As=null,zr=1,Ur="";function us(t,e){_a[Ea++]=gd,_a[Ea++]=pd,pd=t,gd=e}function G2(t,e,n){Rn[Pn++]=zr,Rn[Pn++]=Ur,Rn[Pn++]=As,As=t;var r=zr;t=Ur;var i=32-Zn(r)-1;r&=~(1<<i),n+=1;var s=32-Zn(e)+i;if(30<s){var a=i-i%5;s=(r&(1<<a)-1).toString(32),r>>=a,i-=a,zr=1<<32-Zn(e)+i|n<<i|r,Ur=s+t}else zr=1<<s|n<<i|r,Ur=t}function gy(t){t.return!==null&&(us(t,1),G2(t,1,0))}function yy(t){for(;t===pd;)pd=_a[--Ea],_a[Ea]=null,gd=_a[--Ea],_a[Ea]=null;for(;t===As;)As=Rn[--Pn],Rn[Pn]=null,Ur=Rn[--Pn],Rn[Pn]=null,zr=Rn[--Pn],Rn[Pn]=null}var wn=null,gn=null,je=!1,qn=null;function K2(t,e){var n=On(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Wx(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,wn=t,gn=Ni(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,wn=t,gn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=As!==null?{id:zr,overflow:Ur}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=On(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,wn=t,gn=null,!0):!1;default:return!1}}function mg(t){return(t.mode&1)!==0&&(t.flags&128)===0}function pg(t){if(je){var e=gn;if(e){var n=e;if(!Wx(t,e)){if(mg(t))throw Error(j(418));e=Ni(n.nextSibling);var r=wn;e&&Wx(t,e)?K2(r,n):(t.flags=t.flags&-4097|2,je=!1,wn=t)}}else{if(mg(t))throw Error(j(418));t.flags=t.flags&-4097|2,je=!1,wn=t}}}function qx(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;wn=t}function ou(t){if(t!==wn)return!1;if(!je)return qx(t),je=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!ug(t.type,t.memoizedProps)),e&&(e=gn)){if(mg(t))throw Q2(),Error(j(418));for(;e;)K2(t,e),e=Ni(e.nextSibling)}if(qx(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(j(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){gn=Ni(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}gn=null}}else gn=wn?Ni(t.stateNode.nextSibling):null;return!0}function Q2(){for(var t=gn;t;)t=Ni(t.nextSibling)}function qa(){gn=wn=null,je=!1}function vy(t){qn===null?qn=[t]:qn.push(t)}var iN=oi.ReactCurrentBatchConfig;function Hn(t,e){if(t&&t.defaultProps){e=Fe({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var yd=ts(null),vd=null,Sa=null,xy=null;function wy(){xy=Sa=vd=null}function _y(t){var e=yd.current;Ae(yd),t._currentValue=e}function gg(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function ja(t,e){vd=t,xy=Sa=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(nn=!0),t.firstContext=null)}function Ln(t){var e=t._currentValue;if(xy!==t)if(t={context:t,memoizedValue:e,next:null},Sa===null){if(vd===null)throw Error(j(308));Sa=t,vd.dependencies={lanes:0,firstContext:t}}else Sa=Sa.next=t;return e}var ys=null;function Ey(t){ys===null?ys=[t]:ys.push(t)}function X2(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,Ey(e)):(n.next=i.next,i.next=n),e.interleaved=n,Zr(t,r)}function Zr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var gi=!1;function Sy(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Y2(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Gr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function ji(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,me&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Zr(t,n)}return i=r.interleaved,i===null?(e.next=e,Ey(r)):(e.next=i.next,i.next=e),r.interleaved=e,Zr(t,n)}function $u(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,ly(t,n)}}function Gx(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=a:s=s.next=a,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function xd(t,e,n,r){var i=t.updateQueue;gi=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var l=o,u=l.next;l.next=null,a===null?s=u:a.next=u,a=l;var d=t.alternate;d!==null&&(d=d.updateQueue,o=d.lastBaseUpdate,o!==a&&(o===null?d.firstBaseUpdate=u:o.next=u,d.lastBaseUpdate=l))}if(s!==null){var h=i.baseState;a=0,d=u=l=null,o=s;do{var m=o.lane,p=o.eventTime;if((r&m)===m){d!==null&&(d=d.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var g=t,w=o;switch(m=e,p=n,w.tag){case 1:if(g=w.payload,typeof g=="function"){h=g.call(p,h,m);break e}h=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=w.payload,m=typeof g=="function"?g.call(p,h,m):g,m==null)break e;h=Fe({},h,m);break e;case 2:gi=!0}}o.callback!==null&&o.lane!==0&&(t.flags|=64,m=i.effects,m===null?i.effects=[o]:m.push(o))}else p={eventTime:p,lane:m,tag:o.tag,payload:o.payload,callback:o.callback,next:null},d===null?(u=d=p,l=h):d=d.next=p,a|=m;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;m=o,o=m.next,m.next=null,i.lastBaseUpdate=m,i.shared.pending=null}}while(1);if(d===null&&(l=h),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=d,e=i.shared.interleaved,e!==null){i=e;do a|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Ps|=a,t.lanes=a,t.memoizedState=h}}function Kx(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(j(191,i));i.call(r)}}}var J2=new XS.Component().refs;function yg(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Fe({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Rh={isMounted:function(t){return(t=t._reactInternals)?Ks(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Gt(),i=Di(t),s=Gr(r,i);s.payload=e,n!=null&&(s.callback=n),e=ji(t,s,i),e!==null&&(er(e,t,i,r),$u(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Gt(),i=Di(t),s=Gr(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=ji(t,s,i),e!==null&&(er(e,t,i,r),$u(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Gt(),r=Di(t),i=Gr(n,r);i.tag=2,e!=null&&(i.callback=e),e=ji(t,i,r),e!==null&&(er(e,t,r,n),$u(e,t,r))}};function Qx(t,e,n,r,i,s,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,a):e.prototype&&e.prototype.isPureReactComponent?!Dl(n,r)||!Dl(i,s):!0}function Z2(t,e,n){var r=!1,i=Hi,s=e.contextType;return typeof s=="object"&&s!==null?s=Ln(s):(i=sn(e)?Cs:$t.current,r=e.contextTypes,s=(r=r!=null)?Wa(t,i):Hi),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Rh,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function Xx(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Rh.enqueueReplaceState(e,e.state,null)}function vg(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs=J2,Sy(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=Ln(s):(s=sn(e)?Cs:$t.current,i.context=Wa(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(yg(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Rh.enqueueReplaceState(i,i.state,null),xd(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Bo(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(j(309));var r=n.stateNode}if(!r)throw Error(j(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(a){var o=i.refs;o===J2&&(o=i.refs={}),a===null?delete o[s]:o[s]=a},e._stringRef=s,e)}if(typeof t!="string")throw Error(j(284));if(!n._owner)throw Error(j(290,t))}return t}function lu(t,e){throw t=Object.prototype.toString.call(e),Error(j(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Yx(t){var e=t._init;return e(t._payload)}function ek(t){function e(v,y){if(t){var x=v.deletions;x===null?(v.deletions=[y],v.flags|=16):x.push(y)}}function n(v,y){if(!t)return null;for(;y!==null;)e(v,y),y=y.sibling;return null}function r(v,y){for(v=new Map;y!==null;)y.key!==null?v.set(y.key,y):v.set(y.index,y),y=y.sibling;return v}function i(v,y){return v=Mi(v,y),v.index=0,v.sibling=null,v}function s(v,y,x){return v.index=x,t?(x=v.alternate,x!==null?(x=x.index,x<y?(v.flags|=2,y):x):(v.flags|=2,y)):(v.flags|=1048576,y)}function a(v){return t&&v.alternate===null&&(v.flags|=2),v}function o(v,y,x,_){return y===null||y.tag!==6?(y=Mm(x,v.mode,_),y.return=v,y):(y=i(y,x),y.return=v,y)}function l(v,y,x,_){var S=x.type;return S===pa?d(v,y,x.props.children,_,x.key):y!==null&&(y.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===pi&&Yx(S)===y.type)?(_=i(y,x.props),_.ref=Bo(v,y,x),_.return=v,_):(_=Wu(x.type,x.key,x.props,null,v.mode,_),_.ref=Bo(v,y,x),_.return=v,_)}function u(v,y,x,_){return y===null||y.tag!==4||y.stateNode.containerInfo!==x.containerInfo||y.stateNode.implementation!==x.implementation?(y=Lm(x,v.mode,_),y.return=v,y):(y=i(y,x.children||[]),y.return=v,y)}function d(v,y,x,_,S){return y===null||y.tag!==7?(y=ks(x,v.mode,_,S),y.return=v,y):(y=i(y,x),y.return=v,y)}function h(v,y,x){if(typeof y=="string"&&y!==""||typeof y=="number")return y=Mm(""+y,v.mode,x),y.return=v,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Yc:return x=Wu(y.type,y.key,y.props,null,v.mode,x),x.ref=Bo(v,null,y),x.return=v,x;case ma:return y=Lm(y,v.mode,x),y.return=v,y;case pi:var _=y._init;return h(v,_(y._payload),x)}if(tl(y)||Lo(y))return y=ks(y,v.mode,x,null),y.return=v,y;lu(v,y)}return null}function m(v,y,x,_){var S=y!==null?y.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return S!==null?null:o(v,y,""+x,_);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Yc:return x.key===S?l(v,y,x,_):null;case ma:return x.key===S?u(v,y,x,_):null;case pi:return S=x._init,m(v,y,S(x._payload),_)}if(tl(x)||Lo(x))return S!==null?null:d(v,y,x,_,null);lu(v,x)}return null}function p(v,y,x,_,S){if(typeof _=="string"&&_!==""||typeof _=="number")return v=v.get(x)||null,o(y,v,""+_,S);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Yc:return v=v.get(_.key===null?x:_.key)||null,l(y,v,_,S);case ma:return v=v.get(_.key===null?x:_.key)||null,u(y,v,_,S);case pi:var k=_._init;return p(v,y,x,k(_._payload),S)}if(tl(_)||Lo(_))return v=v.get(x)||null,d(y,v,_,S,null);lu(y,_)}return null}function g(v,y,x,_){for(var S=null,k=null,b=y,T=y=0,P=null;b!==null&&T<x.length;T++){b.index>T?(P=b,b=null):P=b.sibling;var N=m(v,b,x[T],_);if(N===null){b===null&&(b=P);break}t&&b&&N.alternate===null&&e(v,b),y=s(N,y,T),k===null?S=N:k.sibling=N,k=N,b=P}if(T===x.length)return n(v,b),je&&us(v,T),S;if(b===null){for(;T<x.length;T++)b=h(v,x[T],_),b!==null&&(y=s(b,y,T),k===null?S=b:k.sibling=b,k=b);return je&&us(v,T),S}for(b=r(v,b);T<x.length;T++)P=p(b,v,T,x[T],_),P!==null&&(t&&P.alternate!==null&&b.delete(P.key===null?T:P.key),y=s(P,y,T),k===null?S=P:k.sibling=P,k=P);return t&&b.forEach(function(B){return e(v,B)}),je&&us(v,T),S}function w(v,y,x,_){var S=Lo(x);if(typeof S!="function")throw Error(j(150));if(x=S.call(x),x==null)throw Error(j(151));for(var k=S=null,b=y,T=y=0,P=null,N=x.next();b!==null&&!N.done;T++,N=x.next()){b.index>T?(P=b,b=null):P=b.sibling;var B=m(v,b,N.value,_);if(B===null){b===null&&(b=P);break}t&&b&&B.alternate===null&&e(v,b),y=s(B,y,T),k===null?S=B:k.sibling=B,k=B,b=P}if(N.done)return n(v,b),je&&us(v,T),S;if(b===null){for(;!N.done;T++,N=x.next())N=h(v,N.value,_),N!==null&&(y=s(N,y,T),k===null?S=N:k.sibling=N,k=N);return je&&us(v,T),S}for(b=r(v,b);!N.done;T++,N=x.next())N=p(b,v,T,N.value,_),N!==null&&(t&&N.alternate!==null&&b.delete(N.key===null?T:N.key),y=s(N,y,T),k===null?S=N:k.sibling=N,k=N);return t&&b.forEach(function(F){return e(v,F)}),je&&us(v,T),S}function E(v,y,x,_){if(typeof x=="object"&&x!==null&&x.type===pa&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case Yc:e:{for(var S=x.key,k=y;k!==null;){if(k.key===S){if(S=x.type,S===pa){if(k.tag===7){n(v,k.sibling),y=i(k,x.props.children),y.return=v,v=y;break e}}else if(k.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===pi&&Yx(S)===k.type){n(v,k.sibling),y=i(k,x.props),y.ref=Bo(v,k,x),y.return=v,v=y;break e}n(v,k);break}else e(v,k);k=k.sibling}x.type===pa?(y=ks(x.props.children,v.mode,_,x.key),y.return=v,v=y):(_=Wu(x.type,x.key,x.props,null,v.mode,_),_.ref=Bo(v,y,x),_.return=v,v=_)}return a(v);case ma:e:{for(k=x.key;y!==null;){if(y.key===k)if(y.tag===4&&y.stateNode.containerInfo===x.containerInfo&&y.stateNode.implementation===x.implementation){n(v,y.sibling),y=i(y,x.children||[]),y.return=v,v=y;break e}else{n(v,y);break}else e(v,y);y=y.sibling}y=Lm(x,v.mode,_),y.return=v,v=y}return a(v);case pi:return k=x._init,E(v,y,k(x._payload),_)}if(tl(x))return g(v,y,x,_);if(Lo(x))return w(v,y,x,_);lu(v,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,y!==null&&y.tag===6?(n(v,y.sibling),y=i(y,x),y.return=v,v=y):(n(v,y),y=Mm(x,v.mode,_),y.return=v,v=y),a(v)):n(v,y)}return E}var Ga=ek(!0),tk=ek(!1),Sc={},wr=ts(Sc),$l=ts(Sc),zl=ts(Sc);function vs(t){if(t===Sc)throw Error(j(174));return t}function ky(t,e){switch(be(zl,e),be($l,t),be(wr,Sc),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Xp(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Xp(e,t)}Ae(wr),be(wr,e)}function Ka(){Ae(wr),Ae($l),Ae(zl)}function nk(t){vs(zl.current);var e=vs(wr.current),n=Xp(e,t.type);e!==n&&(be($l,t),be(wr,n))}function by(t){$l.current===t&&(Ae(wr),Ae($l))}var Me=ts(0);function wd(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Rm=[];function Ty(){for(var t=0;t<Rm.length;t++)Rm[t]._workInProgressVersionPrimary=null;Rm.length=0}var zu=oi.ReactCurrentDispatcher,Pm=oi.ReactCurrentBatchConfig,Rs=0,Le=null,it=null,dt=null,_d=!1,gl=!1,Ul=0,sN=0;function Ct(){throw Error(j(321))}function Iy(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!tr(t[n],e[n]))return!1;return!0}function Cy(t,e,n,r,i,s){if(Rs=s,Le=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,zu.current=t===null||t.memoizedState===null?cN:uN,t=n(r,i),gl){s=0;do{if(gl=!1,Ul=0,25<=s)throw Error(j(301));s+=1,dt=it=null,e.updateQueue=null,zu.current=dN,t=n(r,i)}while(gl)}if(zu.current=Ed,e=it!==null&&it.next!==null,Rs=0,dt=it=Le=null,_d=!1,e)throw Error(j(300));return t}function Ay(){var t=Ul!==0;return Ul=0,t}function cr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return dt===null?Le.memoizedState=dt=t:dt=dt.next=t,dt}function Fn(){if(it===null){var t=Le.alternate;t=t!==null?t.memoizedState:null}else t=it.next;var e=dt===null?Le.memoizedState:dt.next;if(e!==null)dt=e,it=t;else{if(t===null)throw Error(j(310));it=t,t={memoizedState:it.memoizedState,baseState:it.baseState,baseQueue:it.baseQueue,queue:it.queue,next:null},dt===null?Le.memoizedState=dt=t:dt=dt.next=t}return dt}function Bl(t,e){return typeof e=="function"?e(t):e}function Nm(t){var e=Fn(),n=e.queue;if(n===null)throw Error(j(311));n.lastRenderedReducer=t;var r=it,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var a=i.next;i.next=s.next,s.next=a}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var o=a=null,l=null,u=s;do{var d=u.lane;if((Rs&d)===d)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(o=l=h,a=r):l=l.next=h,Le.lanes|=d,Ps|=d}u=u.next}while(u!==null&&u!==s);l===null?a=r:l.next=o,tr(r,e.memoizedState)||(nn=!0),e.memoizedState=r,e.baseState=a,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,Le.lanes|=s,Ps|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function jm(t){var e=Fn(),n=e.queue;if(n===null)throw Error(j(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var a=i=i.next;do s=t(s,a.action),a=a.next;while(a!==i);tr(s,e.memoizedState)||(nn=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function rk(){}function ik(t,e){var n=Le,r=Fn(),i=e(),s=!tr(r.memoizedState,i);if(s&&(r.memoizedState=i,nn=!0),r=r.queue,Ry(ok.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||dt!==null&&dt.memoizedState.tag&1){if(n.flags|=2048,Vl(9,ak.bind(null,n,r,i,e),void 0,null),mt===null)throw Error(j(349));Rs&30||sk(n,e,i)}return i}function sk(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Le.updateQueue,e===null?(e={lastEffect:null,stores:null},Le.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function ak(t,e,n,r){e.value=n,e.getSnapshot=r,lk(e)&&ck(t)}function ok(t,e,n){return n(function(){lk(e)&&ck(t)})}function lk(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!tr(t,n)}catch{return!0}}function ck(t){var e=Zr(t,1);e!==null&&er(e,t,1,-1)}function Jx(t){var e=cr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Bl,lastRenderedState:t},e.queue=t,t=t.dispatch=lN.bind(null,Le,t),[e.memoizedState,t]}function Vl(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Le.updateQueue,e===null?(e={lastEffect:null,stores:null},Le.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function uk(){return Fn().memoizedState}function Uu(t,e,n,r){var i=cr();Le.flags|=t,i.memoizedState=Vl(1|e,n,void 0,r===void 0?null:r)}function Ph(t,e,n,r){var i=Fn();r=r===void 0?null:r;var s=void 0;if(it!==null){var a=it.memoizedState;if(s=a.destroy,r!==null&&Iy(r,a.deps)){i.memoizedState=Vl(e,n,s,r);return}}Le.flags|=t,i.memoizedState=Vl(1|e,n,s,r)}function Zx(t,e){return Uu(8390656,8,t,e)}function Ry(t,e){return Ph(2048,8,t,e)}function dk(t,e){return Ph(4,2,t,e)}function hk(t,e){return Ph(4,4,t,e)}function fk(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function mk(t,e,n){return n=n!=null?n.concat([t]):null,Ph(4,4,fk.bind(null,e,t),n)}function Py(){}function pk(t,e){var n=Fn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Iy(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function gk(t,e){var n=Fn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Iy(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function yk(t,e,n){return Rs&21?(tr(n,e)||(n=w2(),Le.lanes|=n,Ps|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,nn=!0),t.memoizedState=n)}function aN(t,e){var n=ve;ve=n!==0&&4>n?n:4,t(!0);var r=Pm.transition;Pm.transition={};try{t(!1),e()}finally{ve=n,Pm.transition=r}}function vk(){return Fn().memoizedState}function oN(t,e,n){var r=Di(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},xk(t))wk(e,n);else if(n=X2(t,e,n,r),n!==null){var i=Gt();er(n,t,r,i),_k(n,e,r)}}function lN(t,e,n){var r=Di(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(xk(t))wk(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var a=e.lastRenderedState,o=s(a,n);if(i.hasEagerState=!0,i.eagerState=o,tr(o,a)){var l=e.interleaved;l===null?(i.next=i,Ey(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}n=X2(t,e,i,r),n!==null&&(i=Gt(),er(n,t,r,i),_k(n,e,r))}}function xk(t){var e=t.alternate;return t===Le||e!==null&&e===Le}function wk(t,e){gl=_d=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function _k(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,ly(t,n)}}var Ed={readContext:Ln,useCallback:Ct,useContext:Ct,useEffect:Ct,useImperativeHandle:Ct,useInsertionEffect:Ct,useLayoutEffect:Ct,useMemo:Ct,useReducer:Ct,useRef:Ct,useState:Ct,useDebugValue:Ct,useDeferredValue:Ct,useTransition:Ct,useMutableSource:Ct,useSyncExternalStore:Ct,useId:Ct,unstable_isNewReconciler:!1},cN={readContext:Ln,useCallback:function(t,e){return cr().memoizedState=[t,e===void 0?null:e],t},useContext:Ln,useEffect:Zx,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Uu(4194308,4,fk.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Uu(4194308,4,t,e)},useInsertionEffect:function(t,e){return Uu(4,2,t,e)},useMemo:function(t,e){var n=cr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=cr();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=oN.bind(null,Le,t),[r.memoizedState,t]},useRef:function(t){var e=cr();return t={current:t},e.memoizedState=t},useState:Jx,useDebugValue:Py,useDeferredValue:function(t){return cr().memoizedState=t},useTransition:function(){var t=Jx(!1),e=t[0];return t=aN.bind(null,t[1]),cr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Le,i=cr();if(je){if(n===void 0)throw Error(j(407));n=n()}else{if(n=e(),mt===null)throw Error(j(349));Rs&30||sk(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,Zx(ok.bind(null,r,s,t),[t]),r.flags|=2048,Vl(9,ak.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=cr(),e=mt.identifierPrefix;if(je){var n=Ur,r=zr;n=(r&~(1<<32-Zn(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Ul++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=sN++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},uN={readContext:Ln,useCallback:pk,useContext:Ln,useEffect:Ry,useImperativeHandle:mk,useInsertionEffect:dk,useLayoutEffect:hk,useMemo:gk,useReducer:Nm,useRef:uk,useState:function(){return Nm(Bl)},useDebugValue:Py,useDeferredValue:function(t){var e=Fn();return yk(e,it.memoizedState,t)},useTransition:function(){var t=Nm(Bl)[0],e=Fn().memoizedState;return[t,e]},useMutableSource:rk,useSyncExternalStore:ik,useId:vk,unstable_isNewReconciler:!1},dN={readContext:Ln,useCallback:pk,useContext:Ln,useEffect:Ry,useImperativeHandle:mk,useInsertionEffect:dk,useLayoutEffect:hk,useMemo:gk,useReducer:jm,useRef:uk,useState:function(){return jm(Bl)},useDebugValue:Py,useDeferredValue:function(t){var e=Fn();return it===null?e.memoizedState=t:yk(e,it.memoizedState,t)},useTransition:function(){var t=jm(Bl)[0],e=Fn().memoizedState;return[t,e]},useMutableSource:rk,useSyncExternalStore:ik,useId:vk,unstable_isNewReconciler:!1};function Qa(t,e){try{var n="",r=e;do n+=$P(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function Om(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function xg(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var hN=typeof WeakMap=="function"?WeakMap:Map;function Ek(t,e,n){n=Gr(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){kd||(kd=!0,Ag=r),xg(t,e)},n}function Sk(t,e,n){n=Gr(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){xg(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){xg(t,e),typeof r!="function"&&(Oi===null?Oi=new Set([this]):Oi.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),n}function ew(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new hN;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=TN.bind(null,t,e,n),e.then(t,t))}function tw(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function nw(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Gr(-1,1),e.tag=2,ji(n,e,1))),n.lanes|=1),t)}var fN=oi.ReactCurrentOwner,nn=!1;function Ht(t,e,n,r){e.child=t===null?tk(e,null,n,r):Ga(e,t.child,n,r)}function rw(t,e,n,r,i){n=n.render;var s=e.ref;return ja(e,i),r=Cy(t,e,n,r,s,i),n=Ay(),t!==null&&!nn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,ei(t,e,i)):(je&&n&&gy(e),e.flags|=1,Ht(t,e,r,i),e.child)}function iw(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!$y(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,kk(t,e,s,r,i)):(t=Wu(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var a=s.memoizedProps;if(n=n.compare,n=n!==null?n:Dl,n(a,r)&&t.ref===e.ref)return ei(t,e,i)}return e.flags|=1,t=Mi(s,r),t.ref=e.ref,t.return=e,e.child=t}function kk(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(Dl(s,r)&&t.ref===e.ref)if(nn=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(nn=!0);else return e.lanes=t.lanes,ei(t,e,i)}return wg(t,e,n,r,i)}function bk(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},be(ba,fn),fn|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,be(ba,fn),fn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,be(ba,fn),fn|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,be(ba,fn),fn|=r;return Ht(t,e,i,n),e.child}function Tk(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function wg(t,e,n,r,i){var s=sn(n)?Cs:$t.current;return s=Wa(e,s),ja(e,i),n=Cy(t,e,n,r,s,i),r=Ay(),t!==null&&!nn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,ei(t,e,i)):(je&&r&&gy(e),e.flags|=1,Ht(t,e,n,i),e.child)}function sw(t,e,n,r,i){if(sn(n)){var s=!0;md(e)}else s=!1;if(ja(e,i),e.stateNode===null)Bu(t,e),Z2(e,n,r),vg(e,n,r,i),r=!0;else if(t===null){var a=e.stateNode,o=e.memoizedProps;a.props=o;var l=a.context,u=n.contextType;typeof u=="object"&&u!==null?u=Ln(u):(u=sn(n)?Cs:$t.current,u=Wa(e,u));var d=n.getDerivedStateFromProps,h=typeof d=="function"||typeof a.getSnapshotBeforeUpdate=="function";h||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==r||l!==u)&&Xx(e,a,r,u),gi=!1;var m=e.memoizedState;a.state=m,xd(e,r,a,i),l=e.memoizedState,o!==r||m!==l||rn.current||gi?(typeof d=="function"&&(yg(e,n,d,r),l=e.memoizedState),(o=gi||Qx(e,n,o,r,m,l,u))?(h||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),a.props=r,a.state=l,a.context=u,r=o):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{a=e.stateNode,Y2(t,e),o=e.memoizedProps,u=e.type===e.elementType?o:Hn(e.type,o),a.props=u,h=e.pendingProps,m=a.context,l=n.contextType,typeof l=="object"&&l!==null?l=Ln(l):(l=sn(n)?Cs:$t.current,l=Wa(e,l));var p=n.getDerivedStateFromProps;(d=typeof p=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==h||m!==l)&&Xx(e,a,r,l),gi=!1,m=e.memoizedState,a.state=m,xd(e,r,a,i);var g=e.memoizedState;o!==h||m!==g||rn.current||gi?(typeof p=="function"&&(yg(e,n,p,r),g=e.memoizedState),(u=gi||Qx(e,n,u,r,m,g,l)||!1)?(d||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,g,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,g,l)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=g),a.props=r,a.state=g,a.context=l,r=u):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),r=!1)}return _g(t,e,n,r,s,i)}function _g(t,e,n,r,i,s){Tk(t,e);var a=(e.flags&128)!==0;if(!r&&!a)return i&&Hx(e,n,!1),ei(t,e,s);r=e.stateNode,fN.current=e;var o=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&a?(e.child=Ga(e,t.child,null,s),e.child=Ga(e,null,o,s)):Ht(t,e,o,s),e.memoizedState=r.state,i&&Hx(e,n,!0),e.child}function Ik(t){var e=t.stateNode;e.pendingContext?Vx(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Vx(t,e.context,!1),ky(t,e.containerInfo)}function aw(t,e,n,r,i){return qa(),vy(i),e.flags|=256,Ht(t,e,n,r),e.child}var Eg={dehydrated:null,treeContext:null,retryLane:0};function Sg(t){return{baseLanes:t,cachePool:null,transitions:null}}function Ck(t,e,n){var r=e.pendingProps,i=Me.current,s=!1,a=(e.flags&128)!==0,o;if((o=a)||(o=t!==null&&t.memoizedState===null?!1:(i&2)!==0),o?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),be(Me,i&1),t===null)return pg(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=r.children,t=r.fallback,s?(r=e.mode,s=e.child,a={mode:"hidden",children:a},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=Oh(a,r,0,null),t=ks(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=Sg(n),e.memoizedState=Eg,t):Ny(e,a));if(i=t.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return mN(t,e,a,r,o,i,n);if(s){s=r.fallback,a=e.mode,i=t.child,o=i.sibling;var l={mode:"hidden",children:r.children};return!(a&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=Mi(i,l),r.subtreeFlags=i.subtreeFlags&14680064),o!==null?s=Mi(o,s):(s=ks(s,a,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,a=t.child.memoizedState,a=a===null?Sg(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=t.childLanes&~n,e.memoizedState=Eg,r}return s=t.child,t=s.sibling,r=Mi(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Ny(t,e){return e=Oh({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function cu(t,e,n,r){return r!==null&&vy(r),Ga(e,t.child,null,n),t=Ny(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function mN(t,e,n,r,i,s,a){if(n)return e.flags&256?(e.flags&=-257,r=Om(Error(j(422))),cu(t,e,a,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=Oh({mode:"visible",children:r.children},i,0,null),s=ks(s,i,a,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&Ga(e,t.child,null,a),e.child.memoizedState=Sg(a),e.memoizedState=Eg,s);if(!(e.mode&1))return cu(t,e,a,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var o=r.dgst;return r=o,s=Error(j(419)),r=Om(s,r,void 0),cu(t,e,a,r)}if(o=(a&t.childLanes)!==0,nn||o){if(r=mt,r!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|a)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Zr(t,i),er(r,t,i,-1))}return Fy(),r=Om(Error(j(421))),cu(t,e,a,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=IN.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,gn=Ni(i.nextSibling),wn=e,je=!0,qn=null,t!==null&&(Rn[Pn++]=zr,Rn[Pn++]=Ur,Rn[Pn++]=As,zr=t.id,Ur=t.overflow,As=e),e=Ny(e,r.children),e.flags|=4096,e)}function ow(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),gg(t.return,e,n)}function Dm(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function Ak(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(Ht(t,e,r.children,n),r=Me.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&ow(t,n,e);else if(t.tag===19)ow(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(be(Me,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&wd(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),Dm(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&wd(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}Dm(e,!0,n,null,s);break;case"together":Dm(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Bu(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function ei(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Ps|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(j(153));if(e.child!==null){for(t=e.child,n=Mi(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Mi(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function pN(t,e,n){switch(e.tag){case 3:Ik(e),qa();break;case 5:nk(e);break;case 1:sn(e.type)&&md(e);break;case 4:ky(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;be(yd,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(be(Me,Me.current&1),e.flags|=128,null):n&e.child.childLanes?Ck(t,e,n):(be(Me,Me.current&1),t=ei(t,e,n),t!==null?t.sibling:null);be(Me,Me.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return Ak(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),be(Me,Me.current),r)break;return null;case 22:case 23:return e.lanes=0,bk(t,e,n)}return ei(t,e,n)}var Rk,kg,Pk,Nk;Rk=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};kg=function(){};Pk=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,vs(wr.current);var s=null;switch(n){case"input":i=qp(t,i),r=qp(t,r),s=[];break;case"select":i=Fe({},i,{value:void 0}),r=Fe({},r,{value:void 0}),s=[];break;case"textarea":i=Qp(t,i),r=Qp(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=hd)}Yp(n,r);var a;n=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var o=i[u];for(a in o)o.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Cl.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var l=r[u];if(o=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&l!==o&&(l!=null||o!=null))if(u==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(n||(n={}),n[a]=l[a])}else n||(s||(s=[]),s.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Cl.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&Te("scroll",t),s||o===l||(s=[])):(s=s||[]).push(u,l))}n&&(s=s||[]).push("style",n);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};Nk=function(t,e,n,r){n!==r&&(e.flags|=4)};function Vo(t,e){if(!je)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function At(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function gN(t,e,n){var r=e.pendingProps;switch(yy(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return At(e),null;case 1:return sn(e.type)&&fd(),At(e),null;case 3:return r=e.stateNode,Ka(),Ae(rn),Ae($t),Ty(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(ou(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,qn!==null&&(Ng(qn),qn=null))),kg(t,e),At(e),null;case 5:by(e);var i=vs(zl.current);if(n=e.type,t!==null&&e.stateNode!=null)Pk(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(j(166));return At(e),null}if(t=vs(wr.current),ou(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[dr]=e,r[Fl]=s,t=(e.mode&1)!==0,n){case"dialog":Te("cancel",r),Te("close",r);break;case"iframe":case"object":case"embed":Te("load",r);break;case"video":case"audio":for(i=0;i<rl.length;i++)Te(rl[i],r);break;case"source":Te("error",r);break;case"img":case"image":case"link":Te("error",r),Te("load",r);break;case"details":Te("toggle",r);break;case"input":gx(r,s),Te("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Te("invalid",r);break;case"textarea":vx(r,s),Te("invalid",r)}Yp(n,s),i=null;for(var a in s)if(s.hasOwnProperty(a)){var o=s[a];a==="children"?typeof o=="string"?r.textContent!==o&&(s.suppressHydrationWarning!==!0&&au(r.textContent,o,t),i=["children",o]):typeof o=="number"&&r.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&au(r.textContent,o,t),i=["children",""+o]):Cl.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&Te("scroll",r)}switch(n){case"input":Jc(r),yx(r,s,!0);break;case"textarea":Jc(r),xx(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=hd)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=s2(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=a.createElement(n,{is:r.is}):(t=a.createElement(n),n==="select"&&(a=t,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):t=a.createElementNS(t,n),t[dr]=e,t[Fl]=r,Rk(t,e,!1,!1),e.stateNode=t;e:{switch(a=Jp(n,r),n){case"dialog":Te("cancel",t),Te("close",t),i=r;break;case"iframe":case"object":case"embed":Te("load",t),i=r;break;case"video":case"audio":for(i=0;i<rl.length;i++)Te(rl[i],t);i=r;break;case"source":Te("error",t),i=r;break;case"img":case"image":case"link":Te("error",t),Te("load",t),i=r;break;case"details":Te("toggle",t),i=r;break;case"input":gx(t,r),i=qp(t,r),Te("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=Fe({},r,{value:void 0}),Te("invalid",t);break;case"textarea":vx(t,r),i=Qp(t,r),Te("invalid",t);break;default:i=r}Yp(n,i),o=i;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?l2(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&a2(t,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Al(t,l):typeof l=="number"&&Al(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Cl.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Te("scroll",t):l!=null&&ny(t,s,l,a))}switch(n){case"input":Jc(t),yx(t,r,!1);break;case"textarea":Jc(t),xx(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Vi(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?Aa(t,!!r.multiple,s,!1):r.defaultValue!=null&&Aa(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=hd)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return At(e),null;case 6:if(t&&e.stateNode!=null)Nk(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(j(166));if(n=vs(zl.current),vs(wr.current),ou(e)){if(r=e.stateNode,n=e.memoizedProps,r[dr]=e,(s=r.nodeValue!==n)&&(t=wn,t!==null))switch(t.tag){case 3:au(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&au(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[dr]=e,e.stateNode=r}return At(e),null;case 13:if(Ae(Me),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(je&&gn!==null&&e.mode&1&&!(e.flags&128))Q2(),qa(),e.flags|=98560,s=!1;else if(s=ou(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(j(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(j(317));s[dr]=e}else qa(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;At(e),s=!1}else qn!==null&&(Ng(qn),qn=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Me.current&1?st===0&&(st=3):Fy())),e.updateQueue!==null&&(e.flags|=4),At(e),null);case 4:return Ka(),kg(t,e),t===null&&Ml(e.stateNode.containerInfo),At(e),null;case 10:return _y(e.type._context),At(e),null;case 17:return sn(e.type)&&fd(),At(e),null;case 19:if(Ae(Me),s=e.memoizedState,s===null)return At(e),null;if(r=(e.flags&128)!==0,a=s.rendering,a===null)if(r)Vo(s,!1);else{if(st!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=wd(t),a!==null){for(e.flags|=128,Vo(s,!1),r=a.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,t=a.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return be(Me,Me.current&1|2),e.child}t=t.sibling}s.tail!==null&&Ge()>Xa&&(e.flags|=128,r=!0,Vo(s,!1),e.lanes=4194304)}else{if(!r)if(t=wd(a),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Vo(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!je)return At(e),null}else 2*Ge()-s.renderingStartTime>Xa&&n!==1073741824&&(e.flags|=128,r=!0,Vo(s,!1),e.lanes=4194304);s.isBackwards?(a.sibling=e.child,e.child=a):(n=s.last,n!==null?n.sibling=a:e.child=a,s.last=a)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Ge(),e.sibling=null,n=Me.current,be(Me,r?n&1|2:n&1),e):(At(e),null);case 22:case 23:return Ly(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?fn&1073741824&&(At(e),e.subtreeFlags&6&&(e.flags|=8192)):At(e),null;case 24:return null;case 25:return null}throw Error(j(156,e.tag))}function yN(t,e){switch(yy(e),e.tag){case 1:return sn(e.type)&&fd(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Ka(),Ae(rn),Ae($t),Ty(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return by(e),null;case 13:if(Ae(Me),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(j(340));qa()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ae(Me),null;case 4:return Ka(),null;case 10:return _y(e.type._context),null;case 22:case 23:return Ly(),null;case 24:return null;default:return null}}var uu=!1,jt=!1,vN=typeof WeakSet=="function"?WeakSet:Set,U=null;function ka(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){ze(t,e,r)}else n.current=null}function bg(t,e,n){try{n()}catch(r){ze(t,e,r)}}var lw=!1;function xN(t,e){if(lg=cd,t=M2(),py(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var a=0,o=-1,l=-1,u=0,d=0,h=t,m=null;t:for(;;){for(var p;h!==n||i!==0&&h.nodeType!==3||(o=a+i),h!==s||r!==0&&h.nodeType!==3||(l=a+r),h.nodeType===3&&(a+=h.nodeValue.length),(p=h.firstChild)!==null;)m=h,h=p;for(;;){if(h===t)break t;if(m===n&&++u===i&&(o=a),m===s&&++d===r&&(l=a),(p=h.nextSibling)!==null)break;h=m,m=h.parentNode}h=p}n=o===-1||l===-1?null:{start:o,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(cg={focusedElem:t,selectionRange:n},cd=!1,U=e;U!==null;)if(e=U,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,U=t;else for(;U!==null;){e=U;try{var g=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var w=g.memoizedProps,E=g.memoizedState,v=e.stateNode,y=v.getSnapshotBeforeUpdate(e.elementType===e.type?w:Hn(e.type,w),E);v.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var x=e.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(j(163))}}catch(_){ze(e,e.return,_)}if(t=e.sibling,t!==null){t.return=e.return,U=t;break}U=e.return}return g=lw,lw=!1,g}function yl(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&bg(e,n,s)}i=i.next}while(i!==r)}}function Nh(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Tg(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function jk(t){var e=t.alternate;e!==null&&(t.alternate=null,jk(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[dr],delete e[Fl],delete e[hg],delete e[tN],delete e[nN])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Ok(t){return t.tag===5||t.tag===3||t.tag===4}function cw(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Ok(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Ig(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=hd));else if(r!==4&&(t=t.child,t!==null))for(Ig(t,e,n),t=t.sibling;t!==null;)Ig(t,e,n),t=t.sibling}function Cg(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Cg(t,e,n),t=t.sibling;t!==null;)Cg(t,e,n),t=t.sibling}var xt=null,Wn=!1;function ui(t,e,n){for(n=n.child;n!==null;)Dk(t,e,n),n=n.sibling}function Dk(t,e,n){if(xr&&typeof xr.onCommitFiberUnmount=="function")try{xr.onCommitFiberUnmount(kh,n)}catch{}switch(n.tag){case 5:jt||ka(n,e);case 6:var r=xt,i=Wn;xt=null,ui(t,e,n),xt=r,Wn=i,xt!==null&&(Wn?(t=xt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):xt.removeChild(n.stateNode));break;case 18:xt!==null&&(Wn?(t=xt,n=n.stateNode,t.nodeType===8?Cm(t.parentNode,n):t.nodeType===1&&Cm(t,n),jl(t)):Cm(xt,n.stateNode));break;case 4:r=xt,i=Wn,xt=n.stateNode.containerInfo,Wn=!0,ui(t,e,n),xt=r,Wn=i;break;case 0:case 11:case 14:case 15:if(!jt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&bg(n,e,a),i=i.next}while(i!==r)}ui(t,e,n);break;case 1:if(!jt&&(ka(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(o){ze(n,e,o)}ui(t,e,n);break;case 21:ui(t,e,n);break;case 22:n.mode&1?(jt=(r=jt)||n.memoizedState!==null,ui(t,e,n),jt=r):ui(t,e,n);break;default:ui(t,e,n)}}function uw(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new vN),e.forEach(function(r){var i=CN.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Bn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 5:xt=o.stateNode,Wn=!1;break e;case 3:xt=o.stateNode.containerInfo,Wn=!0;break e;case 4:xt=o.stateNode.containerInfo,Wn=!0;break e}o=o.return}if(xt===null)throw Error(j(160));Dk(s,a,i),xt=null,Wn=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){ze(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Mk(e,t),e=e.sibling}function Mk(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Bn(e,t),ar(t),r&4){try{yl(3,t,t.return),Nh(3,t)}catch(w){ze(t,t.return,w)}try{yl(5,t,t.return)}catch(w){ze(t,t.return,w)}}break;case 1:Bn(e,t),ar(t),r&512&&n!==null&&ka(n,n.return);break;case 5:if(Bn(e,t),ar(t),r&512&&n!==null&&ka(n,n.return),t.flags&32){var i=t.stateNode;try{Al(i,"")}catch(w){ze(t,t.return,w)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,a=n!==null?n.memoizedProps:s,o=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&r2(i,s),Jp(o,a);var u=Jp(o,s);for(a=0;a<l.length;a+=2){var d=l[a],h=l[a+1];d==="style"?l2(i,h):d==="dangerouslySetInnerHTML"?a2(i,h):d==="children"?Al(i,h):ny(i,d,h,u)}switch(o){case"input":Gp(i,s);break;case"textarea":i2(i,s);break;case"select":var m=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var p=s.value;p!=null?Aa(i,!!s.multiple,p,!1):m!==!!s.multiple&&(s.defaultValue!=null?Aa(i,!!s.multiple,s.defaultValue,!0):Aa(i,!!s.multiple,s.multiple?[]:"",!1))}i[Fl]=s}catch(w){ze(t,t.return,w)}}break;case 6:if(Bn(e,t),ar(t),r&4){if(t.stateNode===null)throw Error(j(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(w){ze(t,t.return,w)}}break;case 3:if(Bn(e,t),ar(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{jl(e.containerInfo)}catch(w){ze(t,t.return,w)}break;case 4:Bn(e,t),ar(t);break;case 13:Bn(e,t),ar(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(Dy=Ge())),r&4&&uw(t);break;case 22:if(d=n!==null&&n.memoizedState!==null,t.mode&1?(jt=(u=jt)||d,Bn(e,t),jt=u):Bn(e,t),ar(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!d&&t.mode&1)for(U=t,d=t.child;d!==null;){for(h=U=d;U!==null;){switch(m=U,p=m.child,m.tag){case 0:case 11:case 14:case 15:yl(4,m,m.return);break;case 1:ka(m,m.return);var g=m.stateNode;if(typeof g.componentWillUnmount=="function"){r=m,n=m.return;try{e=r,g.props=e.memoizedProps,g.state=e.memoizedState,g.componentWillUnmount()}catch(w){ze(r,n,w)}}break;case 5:ka(m,m.return);break;case 22:if(m.memoizedState!==null){hw(h);continue}}p!==null?(p.return=m,U=p):hw(h)}d=d.sibling}e:for(d=null,h=t;;){if(h.tag===5){if(d===null){d=h;try{i=h.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=h.stateNode,l=h.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=o2("display",a))}catch(w){ze(t,t.return,w)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(w){ze(t,t.return,w)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Bn(e,t),ar(t),r&4&&uw(t);break;case 21:break;default:Bn(e,t),ar(t)}}function ar(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(Ok(n)){var r=n;break e}n=n.return}throw Error(j(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Al(i,""),r.flags&=-33);var s=cw(t);Cg(t,s,i);break;case 3:case 4:var a=r.stateNode.containerInfo,o=cw(t);Ig(t,o,a);break;default:throw Error(j(161))}}catch(l){ze(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function wN(t,e,n){U=t,Lk(t)}function Lk(t,e,n){for(var r=(t.mode&1)!==0;U!==null;){var i=U,s=i.child;if(i.tag===22&&r){var a=i.memoizedState!==null||uu;if(!a){var o=i.alternate,l=o!==null&&o.memoizedState!==null||jt;o=uu;var u=jt;if(uu=a,(jt=l)&&!u)for(U=i;U!==null;)a=U,l=a.child,a.tag===22&&a.memoizedState!==null?fw(i):l!==null?(l.return=a,U=l):fw(i);for(;s!==null;)U=s,Lk(s),s=s.sibling;U=i,uu=o,jt=u}dw(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,U=s):dw(t)}}function dw(t){for(;U!==null;){var e=U;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:jt||Nh(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!jt)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:Hn(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&Kx(e,s,r);break;case 3:var a=e.updateQueue;if(a!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Kx(e,a,n)}break;case 5:var o=e.stateNode;if(n===null&&e.flags&4){n=o;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&jl(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(j(163))}jt||e.flags&512&&Tg(e)}catch(m){ze(e,e.return,m)}}if(e===t){U=null;break}if(n=e.sibling,n!==null){n.return=e.return,U=n;break}U=e.return}}function hw(t){for(;U!==null;){var e=U;if(e===t){U=null;break}var n=e.sibling;if(n!==null){n.return=e.return,U=n;break}U=e.return}}function fw(t){for(;U!==null;){var e=U;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Nh(4,e)}catch(l){ze(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){ze(e,i,l)}}var s=e.return;try{Tg(e)}catch(l){ze(e,s,l)}break;case 5:var a=e.return;try{Tg(e)}catch(l){ze(e,a,l)}}}catch(l){ze(e,e.return,l)}if(e===t){U=null;break}var o=e.sibling;if(o!==null){o.return=e.return,U=o;break}U=e.return}}var _N=Math.ceil,Sd=oi.ReactCurrentDispatcher,jy=oi.ReactCurrentOwner,Dn=oi.ReactCurrentBatchConfig,me=0,mt=null,Ze=null,St=0,fn=0,ba=ts(0),st=0,Hl=null,Ps=0,jh=0,Oy=0,vl=null,tn=null,Dy=0,Xa=1/0,Lr=null,kd=!1,Ag=null,Oi=null,du=!1,Ti=null,bd=0,xl=0,Rg=null,Vu=-1,Hu=0;function Gt(){return me&6?Ge():Vu!==-1?Vu:Vu=Ge()}function Di(t){return t.mode&1?me&2&&St!==0?St&-St:iN.transition!==null?(Hu===0&&(Hu=w2()),Hu):(t=ve,t!==0||(t=window.event,t=t===void 0?16:I2(t.type)),t):1}function er(t,e,n,r){if(50<xl)throw xl=0,Rg=null,Error(j(185));wc(t,n,r),(!(me&2)||t!==mt)&&(t===mt&&(!(me&2)&&(jh|=n),st===4&&vi(t,St)),an(t,r),n===1&&me===0&&!(e.mode&1)&&(Xa=Ge()+500,Ah&&ns()))}function an(t,e){var n=t.callbackNode;i4(t,e);var r=ld(t,t===mt?St:0);if(r===0)n!==null&&Ex(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Ex(n),e===1)t.tag===0?rN(mw.bind(null,t)):q2(mw.bind(null,t)),Z4(function(){!(me&6)&&ns()}),n=null;else{switch(_2(r)){case 1:n=oy;break;case 4:n=v2;break;case 16:n=od;break;case 536870912:n=x2;break;default:n=od}n=Wk(n,Fk.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function Fk(t,e){if(Vu=-1,Hu=0,me&6)throw Error(j(327));var n=t.callbackNode;if(Oa()&&t.callbackNode!==n)return null;var r=ld(t,t===mt?St:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Td(t,r);else{e=r;var i=me;me|=2;var s=zk();(mt!==t||St!==e)&&(Lr=null,Xa=Ge()+500,Ss(t,e));do try{kN();break}catch(o){$k(t,o)}while(1);wy(),Sd.current=s,me=i,Ze!==null?e=0:(mt=null,St=0,e=st)}if(e!==0){if(e===2&&(i=rg(t),i!==0&&(r=i,e=Pg(t,i))),e===1)throw n=Hl,Ss(t,0),vi(t,r),an(t,Ge()),n;if(e===6)vi(t,r);else{if(i=t.current.alternate,!(r&30)&&!EN(i)&&(e=Td(t,r),e===2&&(s=rg(t),s!==0&&(r=s,e=Pg(t,s))),e===1))throw n=Hl,Ss(t,0),vi(t,r),an(t,Ge()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(j(345));case 2:ds(t,tn,Lr);break;case 3:if(vi(t,r),(r&130023424)===r&&(e=Dy+500-Ge(),10<e)){if(ld(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){Gt(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=dg(ds.bind(null,t,tn,Lr),e);break}ds(t,tn,Lr);break;case 4:if(vi(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var a=31-Zn(r);s=1<<a,a=e[a],a>i&&(i=a),r&=~s}if(r=i,r=Ge()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*_N(r/1960))-r,10<r){t.timeoutHandle=dg(ds.bind(null,t,tn,Lr),r);break}ds(t,tn,Lr);break;case 5:ds(t,tn,Lr);break;default:throw Error(j(329))}}}return an(t,Ge()),t.callbackNode===n?Fk.bind(null,t):null}function Pg(t,e){var n=vl;return t.current.memoizedState.isDehydrated&&(Ss(t,e).flags|=256),t=Td(t,e),t!==2&&(e=tn,tn=n,e!==null&&Ng(e)),t}function Ng(t){tn===null?tn=t:tn.push.apply(tn,t)}function EN(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!tr(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function vi(t,e){for(e&=~Oy,e&=~jh,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Zn(e),r=1<<n;t[n]=-1,e&=~r}}function mw(t){if(me&6)throw Error(j(327));Oa();var e=ld(t,0);if(!(e&1))return an(t,Ge()),null;var n=Td(t,e);if(t.tag!==0&&n===2){var r=rg(t);r!==0&&(e=r,n=Pg(t,r))}if(n===1)throw n=Hl,Ss(t,0),vi(t,e),an(t,Ge()),n;if(n===6)throw Error(j(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,ds(t,tn,Lr),an(t,Ge()),null}function My(t,e){var n=me;me|=1;try{return t(e)}finally{me=n,me===0&&(Xa=Ge()+500,Ah&&ns())}}function Ns(t){Ti!==null&&Ti.tag===0&&!(me&6)&&Oa();var e=me;me|=1;var n=Dn.transition,r=ve;try{if(Dn.transition=null,ve=1,t)return t()}finally{ve=r,Dn.transition=n,me=e,!(me&6)&&ns()}}function Ly(){fn=ba.current,Ae(ba)}function Ss(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,J4(n)),Ze!==null)for(n=Ze.return;n!==null;){var r=n;switch(yy(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&fd();break;case 3:Ka(),Ae(rn),Ae($t),Ty();break;case 5:by(r);break;case 4:Ka();break;case 13:Ae(Me);break;case 19:Ae(Me);break;case 10:_y(r.type._context);break;case 22:case 23:Ly()}n=n.return}if(mt=t,Ze=t=Mi(t.current,null),St=fn=e,st=0,Hl=null,Oy=jh=Ps=0,tn=vl=null,ys!==null){for(e=0;e<ys.length;e++)if(n=ys[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var a=s.next;s.next=i,r.next=a}n.pending=r}ys=null}return t}function $k(t,e){do{var n=Ze;try{if(wy(),zu.current=Ed,_d){for(var r=Le.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}_d=!1}if(Rs=0,dt=it=Le=null,gl=!1,Ul=0,jy.current=null,n===null||n.return===null){st=1,Hl=e,Ze=null;break}e:{var s=t,a=n.return,o=n,l=e;if(e=St,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,d=o,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var m=d.alternate;m?(d.updateQueue=m.updateQueue,d.memoizedState=m.memoizedState,d.lanes=m.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=tw(a);if(p!==null){p.flags&=-257,nw(p,a,o,s,e),p.mode&1&&ew(s,u,e),e=p,l=u;var g=e.updateQueue;if(g===null){var w=new Set;w.add(l),e.updateQueue=w}else g.add(l);break e}else{if(!(e&1)){ew(s,u,e),Fy();break e}l=Error(j(426))}}else if(je&&o.mode&1){var E=tw(a);if(E!==null){!(E.flags&65536)&&(E.flags|=256),nw(E,a,o,s,e),vy(Qa(l,o));break e}}s=l=Qa(l,o),st!==4&&(st=2),vl===null?vl=[s]:vl.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var v=Ek(s,l,e);Gx(s,v);break e;case 1:o=l;var y=s.type,x=s.stateNode;if(!(s.flags&128)&&(typeof y.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(Oi===null||!Oi.has(x)))){s.flags|=65536,e&=-e,s.lanes|=e;var _=Sk(s,o,e);Gx(s,_);break e}}s=s.return}while(s!==null)}Bk(n)}catch(S){e=S,Ze===n&&n!==null&&(Ze=n=n.return);continue}break}while(1)}function zk(){var t=Sd.current;return Sd.current=Ed,t===null?Ed:t}function Fy(){(st===0||st===3||st===2)&&(st=4),mt===null||!(Ps&268435455)&&!(jh&268435455)||vi(mt,St)}function Td(t,e){var n=me;me|=2;var r=zk();(mt!==t||St!==e)&&(Lr=null,Ss(t,e));do try{SN();break}catch(i){$k(t,i)}while(1);if(wy(),me=n,Sd.current=r,Ze!==null)throw Error(j(261));return mt=null,St=0,st}function SN(){for(;Ze!==null;)Uk(Ze)}function kN(){for(;Ze!==null&&!QP();)Uk(Ze)}function Uk(t){var e=Hk(t.alternate,t,fn);t.memoizedProps=t.pendingProps,e===null?Bk(t):Ze=e,jy.current=null}function Bk(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=yN(n,e),n!==null){n.flags&=32767,Ze=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{st=6,Ze=null;return}}else if(n=gN(n,e,fn),n!==null){Ze=n;return}if(e=e.sibling,e!==null){Ze=e;return}Ze=e=t}while(e!==null);st===0&&(st=5)}function ds(t,e,n){var r=ve,i=Dn.transition;try{Dn.transition=null,ve=1,bN(t,e,n,r)}finally{Dn.transition=i,ve=r}return null}function bN(t,e,n,r){do Oa();while(Ti!==null);if(me&6)throw Error(j(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(j(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(s4(t,s),t===mt&&(Ze=mt=null,St=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||du||(du=!0,Wk(od,function(){return Oa(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=Dn.transition,Dn.transition=null;var a=ve;ve=1;var o=me;me|=4,jy.current=null,xN(t,n),Mk(n,t),W4(cg),cd=!!lg,cg=lg=null,t.current=n,wN(n),XP(),me=o,ve=a,Dn.transition=s}else t.current=n;if(du&&(du=!1,Ti=t,bd=i),s=t.pendingLanes,s===0&&(Oi=null),ZP(n.stateNode),an(t,Ge()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(kd)throw kd=!1,t=Ag,Ag=null,t;return bd&1&&t.tag!==0&&Oa(),s=t.pendingLanes,s&1?t===Rg?xl++:(xl=0,Rg=t):xl=0,ns(),null}function Oa(){if(Ti!==null){var t=_2(bd),e=Dn.transition,n=ve;try{if(Dn.transition=null,ve=16>t?16:t,Ti===null)var r=!1;else{if(t=Ti,Ti=null,bd=0,me&6)throw Error(j(331));var i=me;for(me|=4,U=t.current;U!==null;){var s=U,a=s.child;if(U.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var u=o[l];for(U=u;U!==null;){var d=U;switch(d.tag){case 0:case 11:case 15:yl(8,d,s)}var h=d.child;if(h!==null)h.return=d,U=h;else for(;U!==null;){d=U;var m=d.sibling,p=d.return;if(jk(d),d===u){U=null;break}if(m!==null){m.return=p,U=m;break}U=p}}}var g=s.alternate;if(g!==null){var w=g.child;if(w!==null){g.child=null;do{var E=w.sibling;w.sibling=null,w=E}while(w!==null)}}U=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,U=a;else e:for(;U!==null;){if(s=U,s.flags&2048)switch(s.tag){case 0:case 11:case 15:yl(9,s,s.return)}var v=s.sibling;if(v!==null){v.return=s.return,U=v;break e}U=s.return}}var y=t.current;for(U=y;U!==null;){a=U;var x=a.child;if(a.subtreeFlags&2064&&x!==null)x.return=a,U=x;else e:for(a=y;U!==null;){if(o=U,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Nh(9,o)}}catch(S){ze(o,o.return,S)}if(o===a){U=null;break e}var _=o.sibling;if(_!==null){_.return=o.return,U=_;break e}U=o.return}}if(me=i,ns(),xr&&typeof xr.onPostCommitFiberRoot=="function")try{xr.onPostCommitFiberRoot(kh,t)}catch{}r=!0}return r}finally{ve=n,Dn.transition=e}}return!1}function pw(t,e,n){e=Qa(n,e),e=Ek(t,e,1),t=ji(t,e,1),e=Gt(),t!==null&&(wc(t,1,e),an(t,e))}function ze(t,e,n){if(t.tag===3)pw(t,t,n);else for(;e!==null;){if(e.tag===3){pw(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Oi===null||!Oi.has(r))){t=Qa(n,t),t=Sk(e,t,1),e=ji(e,t,1),t=Gt(),e!==null&&(wc(e,1,t),an(e,t));break}}e=e.return}}function TN(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Gt(),t.pingedLanes|=t.suspendedLanes&n,mt===t&&(St&n)===n&&(st===4||st===3&&(St&130023424)===St&&500>Ge()-Dy?Ss(t,0):Oy|=n),an(t,e)}function Vk(t,e){e===0&&(t.mode&1?(e=tu,tu<<=1,!(tu&130023424)&&(tu=4194304)):e=1);var n=Gt();t=Zr(t,e),t!==null&&(wc(t,e,n),an(t,n))}function IN(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),Vk(t,n)}function CN(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(j(314))}r!==null&&r.delete(e),Vk(t,n)}var Hk;Hk=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||rn.current)nn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return nn=!1,pN(t,e,n);nn=!!(t.flags&131072)}else nn=!1,je&&e.flags&1048576&&G2(e,gd,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Bu(t,e),t=e.pendingProps;var i=Wa(e,$t.current);ja(e,n),i=Cy(null,e,r,t,i,n);var s=Ay();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,sn(r)?(s=!0,md(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Sy(e),i.updater=Rh,e.stateNode=i,i._reactInternals=e,vg(e,r,t,n),e=_g(null,e,r,!0,s,n)):(e.tag=0,je&&s&&gy(e),Ht(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Bu(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=RN(r),t=Hn(r,t),i){case 0:e=wg(null,e,r,t,n);break e;case 1:e=sw(null,e,r,t,n);break e;case 11:e=rw(null,e,r,t,n);break e;case 14:e=iw(null,e,r,Hn(r.type,t),n);break e}throw Error(j(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Hn(r,i),wg(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Hn(r,i),sw(t,e,r,i,n);case 3:e:{if(Ik(e),t===null)throw Error(j(387));r=e.pendingProps,s=e.memoizedState,i=s.element,Y2(t,e),xd(e,r,null,n);var a=e.memoizedState;if(r=a.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Qa(Error(j(423)),e),e=aw(t,e,r,n,i);break e}else if(r!==i){i=Qa(Error(j(424)),e),e=aw(t,e,r,n,i);break e}else for(gn=Ni(e.stateNode.containerInfo.firstChild),wn=e,je=!0,qn=null,n=tk(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(qa(),r===i){e=ei(t,e,n);break e}Ht(t,e,r,n)}e=e.child}return e;case 5:return nk(e),t===null&&pg(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,a=i.children,ug(r,i)?a=null:s!==null&&ug(r,s)&&(e.flags|=32),Tk(t,e),Ht(t,e,a,n),e.child;case 6:return t===null&&pg(e),null;case 13:return Ck(t,e,n);case 4:return ky(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Ga(e,null,r,n):Ht(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Hn(r,i),rw(t,e,r,i,n);case 7:return Ht(t,e,e.pendingProps,n),e.child;case 8:return Ht(t,e,e.pendingProps.children,n),e.child;case 12:return Ht(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,a=i.value,be(yd,r._currentValue),r._currentValue=a,s!==null)if(tr(s.value,a)){if(s.children===i.children&&!rn.current){e=ei(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var o=s.dependencies;if(o!==null){a=s.child;for(var l=o.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=Gr(-1,n&-n),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?l.next=l:(l.next=d.next,d.next=l),u.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),gg(s.return,n,e),o.lanes|=n;break}l=l.next}}else if(s.tag===10)a=s.type===e.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(j(341));a.lanes|=n,o=a.alternate,o!==null&&(o.lanes|=n),gg(a,n,e),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===e){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}Ht(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,ja(e,n),i=Ln(i),r=r(i),e.flags|=1,Ht(t,e,r,n),e.child;case 14:return r=e.type,i=Hn(r,e.pendingProps),i=Hn(r.type,i),iw(t,e,r,i,n);case 15:return kk(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Hn(r,i),Bu(t,e),e.tag=1,sn(r)?(t=!0,md(e)):t=!1,ja(e,n),Z2(e,r,i),vg(e,r,i,n),_g(null,e,r,!0,t,n);case 19:return Ak(t,e,n);case 22:return bk(t,e,n)}throw Error(j(156,e.tag))};function Wk(t,e){return y2(t,e)}function AN(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function On(t,e,n,r){return new AN(t,e,n,r)}function $y(t){return t=t.prototype,!(!t||!t.isReactComponent)}function RN(t){if(typeof t=="function")return $y(t)?1:0;if(t!=null){if(t=t.$$typeof,t===iy)return 11;if(t===sy)return 14}return 2}function Mi(t,e){var n=t.alternate;return n===null?(n=On(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Wu(t,e,n,r,i,s){var a=2;if(r=t,typeof t=="function")$y(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case pa:return ks(n.children,i,s,e);case ry:a=8,i|=8;break;case Bp:return t=On(12,n,e,i|2),t.elementType=Bp,t.lanes=s,t;case Vp:return t=On(13,n,e,i),t.elementType=Vp,t.lanes=s,t;case Hp:return t=On(19,n,e,i),t.elementType=Hp,t.lanes=s,t;case e2:return Oh(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case JS:a=10;break e;case ZS:a=9;break e;case iy:a=11;break e;case sy:a=14;break e;case pi:a=16,r=null;break e}throw Error(j(130,t==null?t:typeof t,""))}return e=On(a,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function ks(t,e,n,r){return t=On(7,t,r,e),t.lanes=n,t}function Oh(t,e,n,r){return t=On(22,t,r,e),t.elementType=e2,t.lanes=n,t.stateNode={isHidden:!1},t}function Mm(t,e,n){return t=On(6,t,null,e),t.lanes=n,t}function Lm(t,e,n){return e=On(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function PN(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ym(0),this.expirationTimes=ym(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ym(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function zy(t,e,n,r,i,s,a,o,l){return t=new PN(t,e,n,o,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=On(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Sy(s),t}function NN(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ma,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function qk(t){if(!t)return Hi;t=t._reactInternals;e:{if(Ks(t)!==t||t.tag!==1)throw Error(j(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(sn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(j(171))}if(t.tag===1){var n=t.type;if(sn(n))return W2(t,n,e)}return e}function Gk(t,e,n,r,i,s,a,o,l){return t=zy(n,r,!0,t,i,s,a,o,l),t.context=qk(null),n=t.current,r=Gt(),i=Di(n),s=Gr(r,i),s.callback=e??null,ji(n,s,i),t.current.lanes=i,wc(t,i,r),an(t,r),t}function Dh(t,e,n,r){var i=e.current,s=Gt(),a=Di(i);return n=qk(n),e.context===null?e.context=n:e.pendingContext=n,e=Gr(s,a),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=ji(i,e,a),t!==null&&(er(t,i,a,s),$u(t,i,a)),a}function Id(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function gw(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Uy(t,e){gw(t,e),(t=t.alternate)&&gw(t,e)}function jN(){return null}var Kk=typeof reportError=="function"?reportError:function(t){console.error(t)};function By(t){this._internalRoot=t}Mh.prototype.render=By.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(j(409));Dh(t,e,null,null)};Mh.prototype.unmount=By.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Ns(function(){Dh(null,t,null,null)}),e[Jr]=null}};function Mh(t){this._internalRoot=t}Mh.prototype.unstable_scheduleHydration=function(t){if(t){var e=k2();t={blockedOn:null,target:t,priority:e};for(var n=0;n<yi.length&&e!==0&&e<yi[n].priority;n++);yi.splice(n,0,t),n===0&&T2(t)}};function Vy(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Lh(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function yw(){}function ON(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var u=Id(a);s.call(u)}}var a=Gk(e,r,t,0,null,!1,!1,"",yw);return t._reactRootContainer=a,t[Jr]=a.current,Ml(t.nodeType===8?t.parentNode:t),Ns(),a}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var o=r;r=function(){var u=Id(l);o.call(u)}}var l=zy(t,0,!1,null,null,!1,!1,"",yw);return t._reactRootContainer=l,t[Jr]=l.current,Ml(t.nodeType===8?t.parentNode:t),Ns(function(){Dh(e,l,n,r)}),l}function Fh(t,e,n,r,i){var s=n._reactRootContainer;if(s){var a=s;if(typeof i=="function"){var o=i;i=function(){var l=Id(a);o.call(l)}}Dh(e,a,t,i)}else a=ON(n,e,t,i,r);return Id(a)}E2=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=nl(e.pendingLanes);n!==0&&(ly(e,n|1),an(e,Ge()),!(me&6)&&(Xa=Ge()+500,ns()))}break;case 13:Ns(function(){var r=Zr(t,1);if(r!==null){var i=Gt();er(r,t,1,i)}}),Uy(t,1)}};cy=function(t){if(t.tag===13){var e=Zr(t,134217728);if(e!==null){var n=Gt();er(e,t,134217728,n)}Uy(t,134217728)}};S2=function(t){if(t.tag===13){var e=Di(t),n=Zr(t,e);if(n!==null){var r=Gt();er(n,t,e,r)}Uy(t,e)}};k2=function(){return ve};b2=function(t,e){var n=ve;try{return ve=t,e()}finally{ve=n}};eg=function(t,e,n){switch(e){case"input":if(Gp(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=Ch(r);if(!i)throw Error(j(90));n2(r),Gp(r,i)}}}break;case"textarea":i2(t,n);break;case"select":e=n.value,e!=null&&Aa(t,!!n.multiple,e,!1)}};d2=My;h2=Ns;var DN={usingClientEntryPoint:!1,Events:[Ec,xa,Ch,c2,u2,My]},Ho={findFiberByHostInstance:gs,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},MN={bundleType:Ho.bundleType,version:Ho.version,rendererPackageName:Ho.rendererPackageName,rendererConfig:Ho.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:oi.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=p2(t),t===null?null:t.stateNode},findFiberByHostInstance:Ho.findFiberByHostInstance||jN,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var hu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!hu.isDisabled&&hu.supportsFiber)try{kh=hu.inject(MN),xr=hu}catch{}}bn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=DN;bn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Vy(e))throw Error(j(200));return NN(t,e,null,n)};bn.createRoot=function(t,e){if(!Vy(t))throw Error(j(299));var n=!1,r="",i=Kk;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=zy(t,1,!1,null,null,n,!1,r,i),t[Jr]=e.current,Ml(t.nodeType===8?t.parentNode:t),new By(e)};bn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(j(188)):(t=Object.keys(t).join(","),Error(j(268,t)));return t=p2(e),t=t===null?null:t.stateNode,t};bn.flushSync=function(t){return Ns(t)};bn.hydrate=function(t,e,n){if(!Lh(e))throw Error(j(200));return Fh(null,t,e,!0,n)};bn.hydrateRoot=function(t,e,n){if(!Vy(t))throw Error(j(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",a=Kk;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),e=Gk(e,null,t,1,n??null,i,!1,s,a),t[Jr]=e.current,Ml(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new Mh(e)};bn.render=function(t,e,n){if(!Lh(e))throw Error(j(200));return Fh(null,t,e,!1,n)};bn.unmountComponentAtNode=function(t){if(!Lh(t))throw Error(j(40));return t._reactRootContainer?(Ns(function(){Fh(null,null,t,!1,function(){t._reactRootContainer=null,t[Jr]=null})}),!0):!1};bn.unstable_batchedUpdates=My;bn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Lh(n))throw Error(j(200));if(t==null||t._reactInternals===void 0)throw Error(j(38));return Fh(t,e,n,!1,r)};bn.version="18.2.0-next-9e3b772b8-20220608";function Qk(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Qk)}catch(t){console.error(t)}}Qk(),GS.exports=bn;var Eo=GS.exports,vw=Eo;zp.createRoot=vw.createRoot,zp.hydrateRoot=vw.hydrateRoot;/**
 * @remix-run/router v1.7.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Wl(){return Wl=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Wl.apply(this,arguments)}var Ii;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Ii||(Ii={}));const xw="popstate";function LN(t){t===void 0&&(t={});function e(i,s){let{pathname:a="/",search:o="",hash:l=""}=Qs(i.location.hash.substr(1));return jg("",{pathname:a,search:o,hash:l},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(i,s){let a=i.document.querySelector("base"),o="";if(a&&a.getAttribute("href")){let l=i.location.href,u=l.indexOf("#");o=u===-1?l:l.slice(0,u)}return o+"#"+(typeof s=="string"?s:Cd(s))}function r(i,s){$h(i.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(s)+")")}return $N(e,n,r,t)}function Qe(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function $h(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function FN(){return Math.random().toString(36).substr(2,8)}function ww(t,e){return{usr:t.state,key:t.key,idx:e}}function jg(t,e,n,r){return n===void 0&&(n=null),Wl({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Qs(e):e,{state:n,key:e&&e.key||r||FN()})}function Cd(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Qs(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function $N(t,e,n,r){r===void 0&&(r={});let{window:i=document.defaultView,v5Compat:s=!1}=r,a=i.history,o=Ii.Pop,l=null,u=d();u==null&&(u=0,a.replaceState(Wl({},a.state,{idx:u}),""));function d(){return(a.state||{idx:null}).idx}function h(){o=Ii.Pop;let E=d(),v=E==null?null:E-u;u=E,l&&l({action:o,location:w.location,delta:v})}function m(E,v){o=Ii.Push;let y=jg(w.location,E,v);n&&n(y,E),u=d()+1;let x=ww(y,u),_=w.createHref(y);try{a.pushState(x,"",_)}catch(S){if(S instanceof DOMException&&S.name==="DataCloneError")throw S;i.location.assign(_)}s&&l&&l({action:o,location:w.location,delta:1})}function p(E,v){o=Ii.Replace;let y=jg(w.location,E,v);n&&n(y,E),u=d();let x=ww(y,u),_=w.createHref(y);a.replaceState(x,"",_),s&&l&&l({action:o,location:w.location,delta:0})}function g(E){let v=i.location.origin!=="null"?i.location.origin:i.location.href,y=typeof E=="string"?E:Cd(E);return Qe(v,"No window.location.(origin|href) available to create URL for href: "+y),new URL(y,v)}let w={get action(){return o},get location(){return t(i,a)},listen(E){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(xw,h),l=E,()=>{i.removeEventListener(xw,h),l=null}},createHref(E){return e(i,E)},createURL:g,encodeLocation(E){let v=g(E);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:m,replace:p,go(E){return a.go(E)}};return w}var _w;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(_w||(_w={}));function zN(t,e,n){n===void 0&&(n="/");let r=typeof e=="string"?Qs(e):e,i=Hy(r.pathname||"/",n);if(i==null)return null;let s=Xk(t);UN(s);let a=null;for(let o=0;a==null&&o<s.length;++o)a=XN(s[o],ZN(i));return a}function Xk(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let i=(s,a,o)=>{let l={relativePath:o===void 0?s.path||"":o,caseSensitive:s.caseSensitive===!0,childrenIndex:a,route:s};l.relativePath.startsWith("/")&&(Qe(l.relativePath.startsWith(r),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(r.length));let u=Li([r,l.relativePath]),d=n.concat(l);s.children&&s.children.length>0&&(Qe(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),Xk(s.children,e,d,u)),!(s.path==null&&!s.index)&&e.push({path:u,score:KN(u,s.index),routesMeta:d})};return t.forEach((s,a)=>{var o;if(s.path===""||!((o=s.path)!=null&&o.includes("?")))i(s,a);else for(let l of Yk(s.path))i(s,a,l)}),e}function Yk(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,i=n.endsWith("?"),s=n.replace(/\?$/,"");if(r.length===0)return i?[s,""]:[s];let a=Yk(r.join("/")),o=[];return o.push(...a.map(l=>l===""?s:[s,l].join("/"))),i&&o.push(...a),o.map(l=>t.startsWith("/")&&l===""?"/":l)}function UN(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:QN(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const BN=/^:\w+$/,VN=3,HN=2,WN=1,qN=10,GN=-2,Ew=t=>t==="*";function KN(t,e){let n=t.split("/"),r=n.length;return n.some(Ew)&&(r+=GN),e&&(r+=HN),n.filter(i=>!Ew(i)).reduce((i,s)=>i+(BN.test(s)?VN:s===""?WN:qN),r)}function QN(t,e){return t.length===e.length&&t.slice(0,-1).every((r,i)=>r===e[i])?t[t.length-1]-e[e.length-1]:0}function XN(t,e){let{routesMeta:n}=t,r={},i="/",s=[];for(let a=0;a<n.length;++a){let o=n[a],l=a===n.length-1,u=i==="/"?e:e.slice(i.length)||"/",d=YN({path:o.relativePath,caseSensitive:o.caseSensitive,end:l},u);if(!d)return null;Object.assign(r,d.params);let h=o.route;s.push({params:r,pathname:Li([i,d.pathname]),pathnameBase:r3(Li([i,d.pathnameBase])),route:h}),d.pathnameBase!=="/"&&(i=Li([i,d.pathnameBase]))}return s}function YN(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=JN(t.path,t.caseSensitive,t.end),i=e.match(n);if(!i)return null;let s=i[0],a=s.replace(/(.)\/+$/,"$1"),o=i.slice(1);return{params:r.reduce((u,d,h)=>{if(d==="*"){let m=o[h]||"";a=s.slice(0,s.length-m.length).replace(/(.)\/+$/,"$1")}return u[d]=e3(o[h]||"",d),u},{}),pathname:s,pathnameBase:a,pattern:t}}function JN(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),$h(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/\/:(\w+)/g,(a,o)=>(r.push(o),"/([^\\/]+)"));return t.endsWith("*")?(r.push("*"),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function ZN(t){try{return decodeURI(t)}catch(e){return $h(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function e3(t,e){try{return decodeURIComponent(t)}catch(n){return $h(!1,'The value for the URL param "'+e+'" will not be decoded because'+(' the string "'+t+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+n+").")),t}}function Hy(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function t3(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:i=""}=typeof t=="string"?Qs(t):t;return{pathname:n?n.startsWith("/")?n:n3(n,e):e,search:i3(r),hash:s3(i)}}function n3(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function Fm(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Wy(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function qy(t,e,n,r){r===void 0&&(r=!1);let i;typeof t=="string"?i=Qs(t):(i=Wl({},t),Qe(!i.pathname||!i.pathname.includes("?"),Fm("?","pathname","search",i)),Qe(!i.pathname||!i.pathname.includes("#"),Fm("#","pathname","hash",i)),Qe(!i.search||!i.search.includes("#"),Fm("#","search","hash",i)));let s=t===""||i.pathname==="",a=s?"/":i.pathname,o;if(r||a==null)o=n;else{let h=e.length-1;if(a.startsWith("..")){let m=a.split("/");for(;m[0]==="..";)m.shift(),h-=1;i.pathname=m.join("/")}o=h>=0?e[h]:"/"}let l=t3(i,o),u=a&&a!=="/"&&a.endsWith("/"),d=(s||a===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(u||d)&&(l.pathname+="/"),l}const Li=t=>t.join("/").replace(/\/\/+/g,"/"),r3=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),i3=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,s3=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function a3(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const Jk=["post","put","patch","delete"];new Set(Jk);const o3=["get",...Jk];new Set(o3);/**
 * React Router v6.14.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ad(){return Ad=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Ad.apply(this,arguments)}const Gy=f.createContext(null),l3=f.createContext(null),So=f.createContext(null),zh=f.createContext(null),Ar=f.createContext({outlet:null,matches:[],isDataRoute:!1}),Zk=f.createContext(null);function c3(t,e){let{relative:n}=e===void 0?{}:e;ko()||Qe(!1);let{basename:r,navigator:i}=f.useContext(So),{hash:s,pathname:a,search:o}=tb(t,{relative:n}),l=a;return r!=="/"&&(l=a==="/"?r:Li([r,a])),i.createHref({pathname:l,search:o,hash:s})}function ko(){return f.useContext(zh)!=null}function Rr(){return ko()||Qe(!1),f.useContext(zh).location}function eb(t){f.useContext(So).static||f.useLayoutEffect(t)}function ir(){let{isDataRoute:t}=f.useContext(Ar);return t?k3():u3()}function u3(){ko()||Qe(!1);let t=f.useContext(Gy),{basename:e,navigator:n}=f.useContext(So),{matches:r}=f.useContext(Ar),{pathname:i}=Rr(),s=JSON.stringify(Wy(r).map(l=>l.pathnameBase)),a=f.useRef(!1);return eb(()=>{a.current=!0}),f.useCallback(function(l,u){if(u===void 0&&(u={}),!a.current)return;if(typeof l=="number"){n.go(l);return}let d=qy(l,JSON.parse(s),i,u.relative==="path");t==null&&e!=="/"&&(d.pathname=d.pathname==="/"?e:Li([e,d.pathname])),(u.replace?n.replace:n.push)(d,u.state,u)},[e,n,s,i,t])}const d3=f.createContext(null);function h3(t){let e=f.useContext(Ar).outlet;return e&&f.createElement(d3.Provider,{value:t},e)}function Ky(){let{matches:t}=f.useContext(Ar),e=t[t.length-1];return e?e.params:{}}function tb(t,e){let{relative:n}=e===void 0?{}:e,{matches:r}=f.useContext(Ar),{pathname:i}=Rr(),s=JSON.stringify(Wy(r).map(a=>a.pathnameBase));return f.useMemo(()=>qy(t,JSON.parse(s),i,n==="path"),[t,s,i,n])}function f3(t,e){return m3(t,e)}function m3(t,e,n){ko()||Qe(!1);let{navigator:r}=f.useContext(So),{matches:i}=f.useContext(Ar),s=i[i.length-1],a=s?s.params:{};s&&s.pathname;let o=s?s.pathnameBase:"/";s&&s.route;let l=Rr(),u;if(e){var d;let w=typeof e=="string"?Qs(e):e;o==="/"||(d=w.pathname)!=null&&d.startsWith(o)||Qe(!1),u=w}else u=l;let h=u.pathname||"/",m=o==="/"?h:h.slice(o.length)||"/",p=zN(t,{pathname:m}),g=x3(p&&p.map(w=>Object.assign({},w,{params:Object.assign({},a,w.params),pathname:Li([o,r.encodeLocation?r.encodeLocation(w.pathname).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?o:Li([o,r.encodeLocation?r.encodeLocation(w.pathnameBase).pathname:w.pathnameBase])})),i,n);return e&&g?f.createElement(zh.Provider,{value:{location:Ad({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:Ii.Pop}},g):g}function p3(){let t=S3(),e=a3(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},s=null;return f.createElement(f.Fragment,null,f.createElement("h2",null,"Unexpected Application Error!"),f.createElement("h3",{style:{fontStyle:"italic"}},e),n?f.createElement("pre",{style:i},n):null,s)}const g3=f.createElement(p3,null);class y3 extends f.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error||n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error?f.createElement(Ar.Provider,{value:this.props.routeContext},f.createElement(Zk.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function v3(t){let{routeContext:e,match:n,children:r}=t,i=f.useContext(Gy);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),f.createElement(Ar.Provider,{value:e},r)}function x3(t,e,n){var r;if(e===void 0&&(e=[]),n===void 0&&(n=null),t==null){var i;if((i=n)!=null&&i.errors)t=n.matches;else return null}let s=t,a=(r=n)==null?void 0:r.errors;if(a!=null){let o=s.findIndex(l=>l.route.id&&(a==null?void 0:a[l.route.id]));o>=0||Qe(!1),s=s.slice(0,Math.min(s.length,o+1))}return s.reduceRight((o,l,u)=>{let d=l.route.id?a==null?void 0:a[l.route.id]:null,h=null;n&&(h=l.route.errorElement||g3);let m=e.concat(s.slice(0,u+1)),p=()=>{let g;return d?g=h:l.route.Component?g=f.createElement(l.route.Component,null):l.route.element?g=l.route.element:g=o,f.createElement(v3,{match:l,routeContext:{outlet:o,matches:m,isDataRoute:n!=null},children:g})};return n&&(l.route.ErrorBoundary||l.route.errorElement||u===0)?f.createElement(y3,{location:n.location,revalidation:n.revalidation,component:h,error:d,children:p(),routeContext:{outlet:null,matches:m,isDataRoute:!0}}):p()},null)}var Og;(function(t){t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate"})(Og||(Og={}));var ql;(function(t){t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId"})(ql||(ql={}));function w3(t){let e=f.useContext(Gy);return e||Qe(!1),e}function _3(t){let e=f.useContext(l3);return e||Qe(!1),e}function E3(t){let e=f.useContext(Ar);return e||Qe(!1),e}function nb(t){let e=E3(),n=e.matches[e.matches.length-1];return n.route.id||Qe(!1),n.route.id}function S3(){var t;let e=f.useContext(Zk),n=_3(ql.UseRouteError),r=nb(ql.UseRouteError);return e||((t=n.errors)==null?void 0:t[r])}function k3(){let{router:t}=w3(Og.UseNavigateStable),e=nb(ql.UseNavigateStable),n=f.useRef(!1);return eb(()=>{n.current=!0}),f.useCallback(function(i,s){s===void 0&&(s={}),n.current&&(typeof i=="number"?t.navigate(i):t.navigate(i,Ad({fromRouteId:e},s)))},[t,e])}function b3(t){let{to:e,replace:n,state:r,relative:i}=t;ko()||Qe(!1);let{matches:s}=f.useContext(Ar),{pathname:a}=Rr(),o=ir(),l=qy(e,Wy(s).map(d=>d.pathnameBase),a,i==="path"),u=JSON.stringify(l);return f.useEffect(()=>o(JSON.parse(u),{replace:n,state:r,relative:i}),[o,u,i,n,r]),null}function rb(t){return h3(t.context)}function mi(t){Qe(!1)}function T3(t){let{basename:e="/",children:n=null,location:r,navigationType:i=Ii.Pop,navigator:s,static:a=!1}=t;ko()&&Qe(!1);let o=e.replace(/^\/*/,"/"),l=f.useMemo(()=>({basename:o,navigator:s,static:a}),[o,s,a]);typeof r=="string"&&(r=Qs(r));let{pathname:u="/",search:d="",hash:h="",state:m=null,key:p="default"}=r,g=f.useMemo(()=>{let w=Hy(u,o);return w==null?null:{location:{pathname:w,search:d,hash:h,state:m,key:p},navigationType:i}},[o,u,d,h,m,p,i]);return g==null?null:f.createElement(So.Provider,{value:l},f.createElement(zh.Provider,{children:n,value:g}))}function I3(t){let{children:e,location:n}=t;return f3(Dg(e),n)}var Sw;(function(t){t[t.pending=0]="pending",t[t.success=1]="success",t[t.error=2]="error"})(Sw||(Sw={}));new Promise(()=>{});function Dg(t,e){e===void 0&&(e=[]);let n=[];return f.Children.forEach(t,(r,i)=>{if(!f.isValidElement(r))return;let s=[...e,i];if(r.type===f.Fragment){n.push.apply(n,Dg(r.props.children,s));return}r.type!==mi&&Qe(!1),!r.props.index||!r.props.children||Qe(!1);let a={id:r.props.id||s.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(a.children=Dg(r.props.children,s)),n.push(a)}),n}/**
 * React Router DOM v6.14.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Mg(){return Mg=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Mg.apply(this,arguments)}function C3(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function A3(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function R3(t,e){return t.button===0&&(!e||e==="_self")&&!A3(t)}const P3=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset"],N3="startTransition",kw=IP[N3];function j3(t){let{basename:e,children:n,future:r,window:i}=t,s=f.useRef();s.current==null&&(s.current=LN({window:i,v5Compat:!0}));let a=s.current,[o,l]=f.useState({action:a.action,location:a.location}),{v7_startTransition:u}=r||{},d=f.useCallback(h=>{u&&kw?kw(()=>l(h)):l(h)},[l,u]);return f.useLayoutEffect(()=>a.listen(d),[a,d]),f.createElement(T3,{basename:e,children:n,location:o.location,navigationType:o.action,navigator:a})}const O3=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",D3=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Br=f.forwardRef(function(e,n){let{onClick:r,relative:i,reloadDocument:s,replace:a,state:o,target:l,to:u,preventScrollReset:d}=e,h=C3(e,P3),{basename:m}=f.useContext(So),p,g=!1;if(typeof u=="string"&&D3.test(u)&&(p=u,O3))try{let y=new URL(window.location.href),x=u.startsWith("//")?new URL(y.protocol+u):new URL(u),_=Hy(x.pathname,m);x.origin===y.origin&&_!=null?u=_+x.search+x.hash:g=!0}catch{}let w=c3(u,{relative:i}),E=M3(u,{replace:a,state:o,target:l,preventScrollReset:d,relative:i});function v(y){r&&r(y),y.defaultPrevented||E(y)}return f.createElement("a",Mg({},h,{href:p||w,onClick:g||s?r:v,ref:n,target:l}))});var bw;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher"})(bw||(bw={}));var Tw;(function(t){t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(Tw||(Tw={}));function M3(t,e){let{target:n,replace:r,state:i,preventScrollReset:s,relative:a}=e===void 0?{}:e,o=ir(),l=Rr(),u=tb(t,{relative:a});return f.useCallback(d=>{if(R3(d,n)){d.preventDefault();let h=r!==void 0?r:Cd(l)===Cd(u);o(t,{replace:h,state:i,preventScrollReset:s,relative:a})}},[l,o,u,r,i,n,t,s,a])}function ib(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t))for(e=0;e<t.length;e++)t[e]&&(n=ib(t[e]))&&(r&&(r+=" "),r+=n);else for(e in t)t[e]&&(r&&(r+=" "),r+=e);return r}function L3(){for(var t,e,n=0,r="";n<arguments.length;)(t=arguments[n++])&&(e=ib(t))&&(r&&(r+=" "),r+=e);return r}const Iw=t=>typeof t=="boolean"?"".concat(t):t===0?"0":t,Cw=L3,sb=(t,e)=>n=>{var r;if((e==null?void 0:e.variants)==null)return Cw(t,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:i,defaultVariants:s}=e,a=Object.keys(i).map(u=>{const d=n==null?void 0:n[u],h=s==null?void 0:s[u];if(d===null)return null;const m=Iw(d)||Iw(h);return i[u][m]}),o=n&&Object.entries(n).reduce((u,d)=>{let[h,m]=d;return m===void 0||(u[h]=m),u},{}),l=e==null||(r=e.compoundVariants)===null||r===void 0?void 0:r.reduce((u,d)=>{let{class:h,className:m,...p}=d;return Object.entries(p).every(g=>{let[w,E]=g;return Array.isArray(E)?E.includes({...s,...o}[w]):{...s,...o}[w]===E})?[...u,h,m]:u},[]);return Cw(t,a,l,n==null?void 0:n.class,n==null?void 0:n.className)};function F3({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 6h9.75M10.5 6a1.5 1.5 0 11-3 0m3 0a1.5 1.5 0 10-3 0M3.75 6H7.5m3 12h9.75m-9.75 0a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0m-3.75 0H7.5m9-6h3.75m-3.75 0a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0m-9.75 0h9.75"}))}const $3=f.forwardRef(F3),ab=$3;function z3({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3"}))}const U3=f.forwardRef(z3),B3=U3;function V3({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6a2.25 2.25 0 00-2.25 2.25v13.5A2.25 2.25 0 007.5 21h6a2.25 2.25 0 002.25-2.25V15M12 9l-3 3m0 0l3 3m-3-3h12.75"}))}const H3=f.forwardRef(V3),W3=H3;function q3({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 12c0-1.232-.046-2.453-.138-3.662a4.006 4.006 0 00-3.7-3.7 48.678 48.678 0 00-7.324 0 4.006 4.006 0 00-3.7 3.7c-.017.22-.032.441-.046.662M19.5 12l3-3m-3 3l-3-3m-12 3c0 1.232.046 2.453.138 3.662a4.006 4.006 0 003.7 3.7 48.656 48.656 0 007.324 0 4.006 4.006 0 003.7-3.7c.017-.22.032-.441.046-.662M4.5 12l3 3m-3-3l-3 3"}))}const G3=f.forwardRef(q3),K3=G3;function Q3({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99"}))}const X3=f.forwardRef(Q3),rs=X3;function Y3({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6a2.25 2.25 0 00-2.25 2.25v13.5A2.25 2.25 0 007.5 21h6a2.25 2.25 0 002.25-2.25V15m3 0l3-3m0 0l-3-3m3 3H9"}))}const J3=f.forwardRef(Y3),Qy=J3;function Z3({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 18L9 11.25l4.306 4.307a11.95 11.95 0 015.814-5.519l2.74-1.22m0 0l-5.94-2.28m5.94 2.28l-2.28 5.941"}))}const e5=f.forwardRef(Z3),t5=e5;function n5({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5m-13.5-9L12 3m0 0l4.5 4.5M12 3v13.5"}))}const r5=f.forwardRef(n5),ob=r5;function i5({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 16.811c0 .864-.933 1.405-1.683.977l-7.108-4.062a1.125 1.125 0 010-1.953l7.108-4.062A1.125 1.125 0 0121 8.688v8.123zM11.25 16.811c0 .864-.933 1.405-1.683.977l-7.108-4.062a1.125 1.125 0 010-1.953L9.567 7.71a1.125 1.125 0 011.683.977v8.123z"}))}const s5=f.forwardRef(i5),Xy=s5;function a5({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}))}const o5=f.forwardRef(a5),l5=o5;function c5({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 12.75l6 6 9-13.5"}))}const u5=f.forwardRef(c5),Uh=u5;function d5({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 8.25l-7.5 7.5-7.5-7.5"}))}const h5=f.forwardRef(d5),f5=h5;function m5({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 4.5l7.5 7.5-7.5 7.5"}))}const p5=f.forwardRef(m5),$m=p5;function g5({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 15.75l7.5-7.5 7.5 7.5"}))}const y5=f.forwardRef(g5),v5=y5;function x5({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z"}))}const w5=f.forwardRef(x5),lb=w5;function _5({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.324.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 011.37.49l1.296 2.247a1.125 1.125 0 01-.26 1.431l-1.003.827c-.293.24-.438.613-.431.992a6.759 6.759 0 010 .255c-.007.378.138.75.43.99l1.005.828c.424.35.534.954.26 1.43l-1.298 2.247a1.125 1.125 0 01-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.57 6.57 0 01-.22.128c-.331.183-.581.495-.644.869l-.213 1.28c-.09.543-.56.941-1.11.941h-2.594c-.55 0-1.02-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 01-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 01-1.369-.49l-1.297-2.247a1.125 1.125 0 01.26-1.431l1.004-.827c.292-.24.437-.613.43-.992a6.932 6.932 0 010-.255c.007-.378-.138-.75-.43-.99l-1.004-.828a1.125 1.125 0 01-.26-1.43l1.297-2.247a1.125 1.125 0 011.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.087.22-.128.332-.183.582-.495.644-.869l.214-1.281z"}),f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}))}const E5=f.forwardRef(_5),cb=E5;function S5({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 17.25v1.007a3 3 0 01-.879 2.122L7.5 21h9l-.621-.621A3 3 0 0115 18.257V17.25m6-12V15a2.25 2.25 0 01-2.25 2.25H5.25A2.25 2.25 0 013 15V5.25m18 0A2.25 2.25 0 0018.75 3H5.25A2.25 2.25 0 003 5.25m18 0V12a2.25 2.25 0 01-2.25 2.25H5.25A2.25 2.25 0 013 12V5.25"}))}const k5=f.forwardRef(S5),b5=k5;function T5({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z"}))}const I5=f.forwardRef(T5),ub=I5;function C5({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m9-.75a9 9 0 11-18 0 9 9 0 0118 0zm-9 3.75h.008v.008H12v-.008z"}))}const A5=f.forwardRef(C5),Bh=A5;function R5({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 8.688c0-.864.933-1.405 1.683-.977l7.108 4.062a1.125 1.125 0 010 1.953l-7.108 4.062A1.125 1.125 0 013 16.81V8.688zM12.75 8.688c0-.864.933-1.405 1.683-.977l7.108 4.062a1.125 1.125 0 010 1.953l-7.108 4.062a1.125 1.125 0 01-1.683-.977V8.688z"}))}const P5=f.forwardRef(R5),Vh=P5;function N5({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12z"}))}const j5=f.forwardRef(N5),O5=j5;function D5({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 12l8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25"}))}const M5=f.forwardRef(D5),L5=M5;function F5({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z"}))}const $5=f.forwardRef(F5),db=$5;function z5({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z"}))}const U5=f.forwardRef(z5),Aw=U5;function B5({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 12h-15"}))}const V5=f.forwardRef(B5),hb=V5;function H5({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 9l10.5-3m0 6.553v3.75a2.25 2.25 0 01-1.632 2.163l-1.32.377a1.803 1.803 0 11-.99-3.467l2.31-.66a2.25 2.25 0 001.632-2.163zm0 0V2.25L9 5.25v10.303m0 0v3.75a2.25 2.25 0 01-1.632 2.163l-1.32.377a1.803 1.803 0 01-.99-3.467l2.31-.66A2.25 2.25 0 009 15.553z"}))}const W5=f.forwardRef(H5),Ya=W5;function q5({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.53 16.122a3 3 0 00-5.78 1.128 2.25 2.25 0 01-2.4 2.245 4.5 4.5 0 008.4-2.245c0-.399-.078-.78-.22-1.128zm0 0a15.998 15.998 0 003.388-1.62m-5.043-.025a15.994 15.994 0 011.622-3.395m3.42 3.42a15.995 15.995 0 004.764-4.648l3.876-5.814a1.151 1.151 0 00-1.597-1.597L14.146 6.32a15.996 15.996 0 00-4.649 4.763m3.42 3.42a6.776 6.776 0 00-3.42-3.42"}))}const G5=f.forwardRef(q5),fb=G5;function K5({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.25 9v6m-4.5 0V9M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}))}const Q5=f.forwardRef(K5),Hh=Q5;function X5({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 5.25v13.5m-7.5-13.5v13.5"}))}const Y5=f.forwardRef(X5),Yy=Y5;function J5({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10"}))}const Z5=f.forwardRef(J5),Lg=Z5;function ej({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}),f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.91 11.672a.375.375 0 010 .656l-5.603 3.113a.375.375 0 01-.557-.328V8.887c0-.286.307-.466.557-.327l5.603 3.112z"}))}const tj=f.forwardRef(ej),Wh=tj;function nj({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 5.653c0-.856.917-1.398 1.667-.986l11.54 6.348a1.125 1.125 0 010 1.971l-11.54 6.347a1.125 1.125 0 01-1.667-.985V5.653z"}))}const rj=f.forwardRef(nj),Rd=rj;function ij({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v6m3-3H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z"}))}const sj=f.forwardRef(ij),aj=sj;function oj({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"}))}const lj=f.forwardRef(oj),Xn=lj;function cj({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442-.745.361-1.45.999-1.45 1.827v.75M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9 5.25h.008v.008H12v-.008z"}))}const uj=f.forwardRef(cj),dj=uj;function hj({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 12h16.5m-16.5 3.75h16.5M3.75 19.5h16.5M5.625 4.5h12.75a1.875 1.875 0 010 3.75H5.625a1.875 1.875 0 010-3.75z"}))}const fj=f.forwardRef(hj),mj=fj;function pj({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.114 5.636a9 9 0 010 12.728M16.463 8.288a5.25 5.25 0 010 7.424M6.75 8.25l4.72-4.72a.75.75 0 011.28.53v15.88a.75.75 0 01-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.01 9.01 0 012.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75z"}))}const gj=f.forwardRef(pj),yj=gj;function vj({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17.25 9.75L19.5 12m0 0l2.25 2.25M19.5 12l2.25-2.25M19.5 12l-2.25 2.25m-10.5-6l4.72-4.72a.75.75 0 011.28.531V19.94a.75.75 0 01-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.506-1.938-1.354A9.01 9.01 0 012.25 12c0-.83.112-1.633.322-2.395C2.806 8.757 3.63 8.25 4.51 8.25H6.75z"}))}const xj=f.forwardRef(vj),wj=xj;function _j({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 7.5A2.25 2.25 0 017.5 5.25h9a2.25 2.25 0 012.25 2.25v9a2.25 2.25 0 01-2.25 2.25h-9a2.25 2.25 0 01-2.25-2.25v-9z"}))}const Ej=f.forwardRef(_j),Pd=Ej;function Sj({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"}))}const kj=f.forwardRef(Sj),Ja=kj;function bj({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"}))}const Tj=f.forwardRef(bj),js=Tj,Ij=sb("inline-flex font-[500] items-center ",{variants:{variant:{default:"",circle:"rounded-full",list:"flex items-center py-[5px] w-full",outline:"border rounded-full",primary:""},size:{primary:"px-4 py-[6px]",small:"px-2 py-1",half:"w-1/2",full:"w-full",clear:""},hover:{default:"hover:brightness-90",scale:"transition-transform hover:scale-[1.05]",clear:""}},defaultVariants:{variant:"default",size:"primary",hover:"default"}});function Cj({className:t,children:e,variant:n,size:r,disabled:i,isLoading:s,hover:a,onClick:o,...l},u){return c.jsxs("button",{ref:u,type:"button",onClick:d=>o?o(d):"",...l,className:Ij({variant:n,size:r,hover:a,className:t}),disabled:s||i,children:[s?c.jsx(rs,{className:"w-6 animate-spin"}):null,!s&&e]})}const V=f.forwardRef(Cj),Nd=[{name:"Red",id:"red",type:"dark",bottom_player_bg:"bg-[#3b1113]",side_bar_bg:"bg-[#391b1c]",content_text:"text-[#ca4954]",content_hover_text:"hover:text-[#ca4954]",content_border:"border-[#ca4954]",content_hover_border:"hover:border-[#ca4954]",content_bg:"!bg-[#ca4954] text-[#fff]",content_code:"#ca4954",content_hover_bg:"hover:!bg-[#ca4954] hover:text-[#fff] ",container:"bg-[#2e0f10]",container_code:"#2e0f10",text_color:""},{name:"Black",id:"black",type:"dark",bottom_player_bg:"bg-[#181818]",side_bar_bg:"bg-[#242424]",content_text:"text-[#198585]",content_hover_text:"hover:text-[#198585]",content_border:"border-[#198585]",content_hover_border:"hover:border-[#198585]",content_bg:"!bg-[#198585]  text-[#fff]",content_code:"#198585",content_hover_bg:"hover:!bg-[#198585] hover:text-[#fff] ",container:"bg-[#1e1e1e]",container_code:"#1e1e1e",text_color:""},{name:"Deep blue",id:"deep_blue",type:"dark",bottom_player_bg:"bg-[#111f3b]",side_bar_bg:"bg-[#1b2639]",content_text:"text-[#0c9e85]",content_hover_text:"hover:text-[#0c9e85]",content_border:"border-[#0c9e85]",content_hover_border:"hover:border-[#0c9e85]",content_bg:"!bg-[#0c9e85]  text-[#fff]",content_code:"#0c9e85",content_hover_bg:"hover:!bg-[#0c9e85] hover:text-[#fff] ",container:"bg-[#0f1a2e]",container_code:"#0f1a2e",text_color:""},{name:"White",id:"white",type:"light",bottom_player_bg:"bg-[#fff]",side_bar_bg:"bg-[#f2f2f2]",content_text:"text-[#198585]",content_hover_text:"hover:text-[#198585]",content_border:"border-[#198585]",content_hover_border:"hover:border-[#198585]",content_bg:"!bg-[#198585] text-[#fff]",content_code:"#198585",content_hover_bg:"hover:!bg-[#198585] hover:text-[#fff]",container:"bg-[#fff]",container_code:"#fff",text_color:""},{name:"Light green",id:"green_light",type:"light",bottom_player_bg:"bg-[#c0d8d8]",side_bar_bg:"bg-[#dde5e5]",content_text:"text-[#198585]",content_hover_text:"hover:text-[#198585]",content_border:"border-[#198585]",content_hover_border:"hover:border-[#198585]",content_bg:"!bg-[#198585] text-[#fff]",content_code:"#198585",content_hover_bg:"hover:!bg-[#198585] hover:text-[#fff]",container:"bg-[#ced9d9]",container_code:"#ced9d9",text_color:""},{name:"Brown",id:"gray",type:"light",bottom_player_bg:"bg-[#dedad1]",side_bar_bg:"bg-[#d9d7d4]",content_text:"text-[#644646]",content_hover_text:"hover:text-[#644646]",content_border:"border-[#644646]",content_hover_border:"hover:border-[#644646]",content_bg:"!bg-[#644646]  text-[#fff]",content_code:"#644646",content_hover_bg:"hover:!bg-[#644646] hover:text-[#fff]",container:"bg-[#e5e3df]",container_code:"#e5e3df",text_color:""}],mb=[{name:"Tet",id:"tet",type:"light",bottom_player_bg:"bg-[#fdf6e3]",side_bar_bg:"bg-[#fdf6e3]",content_text:"text-[#644646]",content_hover_text:"hover:text-[#644646]",content_border:"border-[#644646]",content_hover_border:"hover:border-[#644646]",content_bg:"!bg-[#644646]  text-[#fff]",content_code:"#644646",content_hover_bg:"hover:!bg-[#644646] hover:text-[#fff]",container:"bg-[#fdf6e3]",container_code:"#fdf6e3",text_color:"",image:"tet_theme_image.png"}];let Xs=(t=21)=>crypto.getRandomValues(new Uint8Array(t)).reduce((e,n)=>(n&=63,n<36?e+=n.toString(36):n<62?e+=(n-26).toString(36).toUpperCase():n>62?e+="-":e+="_",e),"");function pb(t,e){return function(){return t.apply(e,arguments)}}const{toString:Aj}=Object.prototype,{getPrototypeOf:Jy}=Object,qh=(t=>e=>{const n=Aj.call(e);return t[n]||(t[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),Pr=t=>(t=t.toLowerCase(),e=>qh(e)===t),Gh=t=>e=>typeof e===t,{isArray:bo}=Array,Gl=Gh("undefined");function Rj(t){return t!==null&&!Gl(t)&&t.constructor!==null&&!Gl(t.constructor)&&Mn(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const gb=Pr("ArrayBuffer");function Pj(t){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&gb(t.buffer),e}const Nj=Gh("string"),Mn=Gh("function"),yb=Gh("number"),Kh=t=>t!==null&&typeof t=="object",jj=t=>t===!0||t===!1,qu=t=>{if(qh(t)!=="object")return!1;const e=Jy(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},Oj=Pr("Date"),Dj=Pr("File"),Mj=Pr("Blob"),Lj=Pr("FileList"),Fj=t=>Kh(t)&&Mn(t.pipe),$j=t=>{let e;return t&&(typeof FormData=="function"&&t instanceof FormData||Mn(t.append)&&((e=qh(t))==="formdata"||e==="object"&&Mn(t.toString)&&t.toString()==="[object FormData]"))},zj=Pr("URLSearchParams"),Uj=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function kc(t,e,{allOwnKeys:n=!1}={}){if(t===null||typeof t>"u")return;let r,i;if(typeof t!="object"&&(t=[t]),bo(t))for(r=0,i=t.length;r<i;r++)e.call(null,t[r],r,t);else{const s=n?Object.getOwnPropertyNames(t):Object.keys(t),a=s.length;let o;for(r=0;r<a;r++)o=s[r],e.call(null,t[o],o,t)}}function vb(t,e){e=e.toLowerCase();const n=Object.keys(t);let r=n.length,i;for(;r-- >0;)if(i=n[r],e===i.toLowerCase())return i;return null}const xb=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),wb=t=>!Gl(t)&&t!==xb;function Fg(){const{caseless:t}=wb(this)&&this||{},e={},n=(r,i)=>{const s=t&&vb(e,i)||i;qu(e[s])&&qu(r)?e[s]=Fg(e[s],r):qu(r)?e[s]=Fg({},r):bo(r)?e[s]=r.slice():e[s]=r};for(let r=0,i=arguments.length;r<i;r++)arguments[r]&&kc(arguments[r],n);return e}const Bj=(t,e,n,{allOwnKeys:r}={})=>(kc(e,(i,s)=>{n&&Mn(i)?t[s]=pb(i,n):t[s]=i},{allOwnKeys:r}),t),Vj=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),Hj=(t,e,n,r)=>{t.prototype=Object.create(e.prototype,r),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),n&&Object.assign(t.prototype,n)},Wj=(t,e,n,r)=>{let i,s,a;const o={};if(e=e||{},t==null)return e;do{for(i=Object.getOwnPropertyNames(t),s=i.length;s-- >0;)a=i[s],(!r||r(a,t,e))&&!o[a]&&(e[a]=t[a],o[a]=!0);t=n!==!1&&Jy(t)}while(t&&(!n||n(t,e))&&t!==Object.prototype);return e},qj=(t,e,n)=>{t=String(t),(n===void 0||n>t.length)&&(n=t.length),n-=e.length;const r=t.indexOf(e,n);return r!==-1&&r===n},Gj=t=>{if(!t)return null;if(bo(t))return t;let e=t.length;if(!yb(e))return null;const n=new Array(e);for(;e-- >0;)n[e]=t[e];return n},Kj=(t=>e=>t&&e instanceof t)(typeof Uint8Array<"u"&&Jy(Uint8Array)),Qj=(t,e)=>{const r=(t&&t[Symbol.iterator]).call(t);let i;for(;(i=r.next())&&!i.done;){const s=i.value;e.call(t,s[0],s[1])}},Xj=(t,e)=>{let n;const r=[];for(;(n=t.exec(e))!==null;)r.push(n);return r},Yj=Pr("HTMLFormElement"),Jj=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,r,i){return r.toUpperCase()+i}),Rw=(({hasOwnProperty:t})=>(e,n)=>t.call(e,n))(Object.prototype),Zj=Pr("RegExp"),_b=(t,e)=>{const n=Object.getOwnPropertyDescriptors(t),r={};kc(n,(i,s)=>{let a;(a=e(i,s,t))!==!1&&(r[s]=a||i)}),Object.defineProperties(t,r)},e6=t=>{_b(t,(e,n)=>{if(Mn(t)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const r=t[n];if(Mn(r)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},t6=(t,e)=>{const n={},r=i=>{i.forEach(s=>{n[s]=!0})};return bo(t)?r(t):r(String(t).split(e)),n},n6=()=>{},r6=(t,e)=>(t=+t,Number.isFinite(t)?t:e),zm="abcdefghijklmnopqrstuvwxyz",Pw="0123456789",Eb={DIGIT:Pw,ALPHA:zm,ALPHA_DIGIT:zm+zm.toUpperCase()+Pw},i6=(t=16,e=Eb.ALPHA_DIGIT)=>{let n="";const{length:r}=e;for(;t--;)n+=e[Math.random()*r|0];return n};function s6(t){return!!(t&&Mn(t.append)&&t[Symbol.toStringTag]==="FormData"&&t[Symbol.iterator])}const a6=t=>{const e=new Array(10),n=(r,i)=>{if(Kh(r)){if(e.indexOf(r)>=0)return;if(!("toJSON"in r)){e[i]=r;const s=bo(r)?[]:{};return kc(r,(a,o)=>{const l=n(a,i+1);!Gl(l)&&(s[o]=l)}),e[i]=void 0,s}}return r};return n(t,0)},o6=Pr("AsyncFunction"),l6=t=>t&&(Kh(t)||Mn(t))&&Mn(t.then)&&Mn(t.catch),A={isArray:bo,isArrayBuffer:gb,isBuffer:Rj,isFormData:$j,isArrayBufferView:Pj,isString:Nj,isNumber:yb,isBoolean:jj,isObject:Kh,isPlainObject:qu,isUndefined:Gl,isDate:Oj,isFile:Dj,isBlob:Mj,isRegExp:Zj,isFunction:Mn,isStream:Fj,isURLSearchParams:zj,isTypedArray:Kj,isFileList:Lj,forEach:kc,merge:Fg,extend:Bj,trim:Uj,stripBOM:Vj,inherits:Hj,toFlatObject:Wj,kindOf:qh,kindOfTest:Pr,endsWith:qj,toArray:Gj,forEachEntry:Qj,matchAll:Xj,isHTMLForm:Yj,hasOwnProperty:Rw,hasOwnProp:Rw,reduceDescriptors:_b,freezeMethods:e6,toObjectSet:t6,toCamelCase:Jj,noop:n6,toFiniteNumber:r6,findKey:vb,global:xb,isContextDefined:wb,ALPHABET:Eb,generateString:i6,isSpecCompliantForm:s6,toJSONObject:a6,isAsyncFn:o6,isThenable:l6};function fe(t,e,n,r,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",e&&(this.code=e),n&&(this.config=n),r&&(this.request=r),i&&(this.response=i)}A.inherits(fe,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:A.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const Sb=fe.prototype,kb={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{kb[t]={value:t}});Object.defineProperties(fe,kb);Object.defineProperty(Sb,"isAxiosError",{value:!0});fe.from=(t,e,n,r,i,s)=>{const a=Object.create(Sb);return A.toFlatObject(t,a,function(l){return l!==Error.prototype},o=>o!=="isAxiosError"),fe.call(a,t.message,e,n,r,i),a.cause=t,a.name=t.name,s&&Object.assign(a,s),a};const c6=null;function $g(t){return A.isPlainObject(t)||A.isArray(t)}function bb(t){return A.endsWith(t,"[]")?t.slice(0,-2):t}function Nw(t,e,n){return t?t.concat(e).map(function(i,s){return i=bb(i),!n&&s?"["+i+"]":i}).join(n?".":""):e}function u6(t){return A.isArray(t)&&!t.some($g)}const d6=A.toFlatObject(A,{},null,function(e){return/^is[A-Z]/.test(e)});function Qh(t,e,n){if(!A.isObject(t))throw new TypeError("target must be an object");e=e||new FormData,n=A.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(w,E){return!A.isUndefined(E[w])});const r=n.metaTokens,i=n.visitor||d,s=n.dots,a=n.indexes,l=(n.Blob||typeof Blob<"u"&&Blob)&&A.isSpecCompliantForm(e);if(!A.isFunction(i))throw new TypeError("visitor must be a function");function u(g){if(g===null)return"";if(A.isDate(g))return g.toISOString();if(!l&&A.isBlob(g))throw new fe("Blob is not supported. Use a Buffer instead.");return A.isArrayBuffer(g)||A.isTypedArray(g)?l&&typeof Blob=="function"?new Blob([g]):Buffer.from(g):g}function d(g,w,E){let v=g;if(g&&!E&&typeof g=="object"){if(A.endsWith(w,"{}"))w=r?w:w.slice(0,-2),g=JSON.stringify(g);else if(A.isArray(g)&&u6(g)||(A.isFileList(g)||A.endsWith(w,"[]"))&&(v=A.toArray(g)))return w=bb(w),v.forEach(function(x,_){!(A.isUndefined(x)||x===null)&&e.append(a===!0?Nw([w],_,s):a===null?w:w+"[]",u(x))}),!1}return $g(g)?!0:(e.append(Nw(E,w,s),u(g)),!1)}const h=[],m=Object.assign(d6,{defaultVisitor:d,convertValue:u,isVisitable:$g});function p(g,w){if(!A.isUndefined(g)){if(h.indexOf(g)!==-1)throw Error("Circular reference detected in "+w.join("."));h.push(g),A.forEach(g,function(v,y){(!(A.isUndefined(v)||v===null)&&i.call(e,v,A.isString(y)?y.trim():y,w,m))===!0&&p(v,w?w.concat(y):[y])}),h.pop()}}if(!A.isObject(t))throw new TypeError("data must be an object");return p(t),e}function jw(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(r){return e[r]})}function Zy(t,e){this._pairs=[],t&&Qh(t,this,e)}const Tb=Zy.prototype;Tb.append=function(e,n){this._pairs.push([e,n])};Tb.toString=function(e){const n=e?function(r){return e.call(this,r,jw)}:jw;return this._pairs.map(function(i){return n(i[0])+"="+n(i[1])},"").join("&")};function h6(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Ib(t,e,n){if(!e)return t;const r=n&&n.encode||h6,i=n&&n.serialize;let s;if(i?s=i(e,n):s=A.isURLSearchParams(e)?e.toString():new Zy(e,n).toString(r),s){const a=t.indexOf("#");a!==-1&&(t=t.slice(0,a)),t+=(t.indexOf("?")===-1?"?":"&")+s}return t}class f6{constructor(){this.handlers=[]}use(e,n,r){return this.handlers.push({fulfilled:e,rejected:n,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){A.forEach(this.handlers,function(r){r!==null&&e(r)})}}const Ow=f6,Cb={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},m6=typeof URLSearchParams<"u"?URLSearchParams:Zy,p6=typeof FormData<"u"?FormData:null,g6=typeof Blob<"u"?Blob:null,y6=(()=>{let t;return typeof navigator<"u"&&((t=navigator.product)==="ReactNative"||t==="NativeScript"||t==="NS")?!1:typeof window<"u"&&typeof document<"u"})(),v6=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),mr={isBrowser:!0,classes:{URLSearchParams:m6,FormData:p6,Blob:g6},isStandardBrowserEnv:y6,isStandardBrowserWebWorkerEnv:v6,protocols:["http","https","file","blob","url","data"]};function x6(t,e){return Qh(t,new mr.classes.URLSearchParams,Object.assign({visitor:function(n,r,i,s){return mr.isNode&&A.isBuffer(n)?(this.append(r,n.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)}},e))}function w6(t){return A.matchAll(/\w+|\[(\w*)]/g,t).map(e=>e[0]==="[]"?"":e[1]||e[0])}function _6(t){const e={},n=Object.keys(t);let r;const i=n.length;let s;for(r=0;r<i;r++)s=n[r],e[s]=t[s];return e}function Ab(t){function e(n,r,i,s){let a=n[s++];const o=Number.isFinite(+a),l=s>=n.length;return a=!a&&A.isArray(i)?i.length:a,l?(A.hasOwnProp(i,a)?i[a]=[i[a],r]:i[a]=r,!o):((!i[a]||!A.isObject(i[a]))&&(i[a]=[]),e(n,r,i[a],s)&&A.isArray(i[a])&&(i[a]=_6(i[a])),!o)}if(A.isFormData(t)&&A.isFunction(t.entries)){const n={};return A.forEachEntry(t,(r,i)=>{e(w6(r),i,n,0)}),n}return null}function E6(t,e,n){if(A.isString(t))try{return(e||JSON.parse)(t),A.trim(t)}catch(r){if(r.name!=="SyntaxError")throw r}return(n||JSON.stringify)(t)}const ev={transitional:Cb,adapter:["xhr","http"],transformRequest:[function(e,n){const r=n.getContentType()||"",i=r.indexOf("application/json")>-1,s=A.isObject(e);if(s&&A.isHTMLForm(e)&&(e=new FormData(e)),A.isFormData(e))return i&&i?JSON.stringify(Ab(e)):e;if(A.isArrayBuffer(e)||A.isBuffer(e)||A.isStream(e)||A.isFile(e)||A.isBlob(e))return e;if(A.isArrayBufferView(e))return e.buffer;if(A.isURLSearchParams(e))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let o;if(s){if(r.indexOf("application/x-www-form-urlencoded")>-1)return x6(e,this.formSerializer).toString();if((o=A.isFileList(e))||r.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return Qh(o?{"files[]":e}:e,l&&new l,this.formSerializer)}}return s||i?(n.setContentType("application/json",!1),E6(e)):e}],transformResponse:[function(e){const n=this.transitional||ev.transitional,r=n&&n.forcedJSONParsing,i=this.responseType==="json";if(e&&A.isString(e)&&(r&&!this.responseType||i)){const a=!(n&&n.silentJSONParsing)&&i;try{return JSON.parse(e)}catch(o){if(a)throw o.name==="SyntaxError"?fe.from(o,fe.ERR_BAD_RESPONSE,this,null,this.response):o}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:mr.classes.FormData,Blob:mr.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};A.forEach(["delete","get","head","post","put","patch"],t=>{ev.headers[t]={}});const tv=ev,S6=A.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),k6=t=>{const e={};let n,r,i;return t&&t.split(`
`).forEach(function(a){i=a.indexOf(":"),n=a.substring(0,i).trim().toLowerCase(),r=a.substring(i+1).trim(),!(!n||e[n]&&S6[n])&&(n==="set-cookie"?e[n]?e[n].push(r):e[n]=[r]:e[n]=e[n]?e[n]+", "+r:r)}),e},Dw=Symbol("internals");function Wo(t){return t&&String(t).trim().toLowerCase()}function Gu(t){return t===!1||t==null?t:A.isArray(t)?t.map(Gu):String(t)}function b6(t){const e=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(t);)e[r[1]]=r[2];return e}const T6=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function Um(t,e,n,r,i){if(A.isFunction(r))return r.call(this,e,n);if(i&&(e=n),!!A.isString(e)){if(A.isString(r))return e.indexOf(r)!==-1;if(A.isRegExp(r))return r.test(e)}}function I6(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,n,r)=>n.toUpperCase()+r)}function C6(t,e){const n=A.toCamelCase(" "+e);["get","set","has"].forEach(r=>{Object.defineProperty(t,r+n,{value:function(i,s,a){return this[r].call(this,e,i,s,a)},configurable:!0})})}class Xh{constructor(e){e&&this.set(e)}set(e,n,r){const i=this;function s(o,l,u){const d=Wo(l);if(!d)throw new Error("header name must be a non-empty string");const h=A.findKey(i,d);(!h||i[h]===void 0||u===!0||u===void 0&&i[h]!==!1)&&(i[h||l]=Gu(o))}const a=(o,l)=>A.forEach(o,(u,d)=>s(u,d,l));return A.isPlainObject(e)||e instanceof this.constructor?a(e,n):A.isString(e)&&(e=e.trim())&&!T6(e)?a(k6(e),n):e!=null&&s(n,e,r),this}get(e,n){if(e=Wo(e),e){const r=A.findKey(this,e);if(r){const i=this[r];if(!n)return i;if(n===!0)return b6(i);if(A.isFunction(n))return n.call(this,i,r);if(A.isRegExp(n))return n.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,n){if(e=Wo(e),e){const r=A.findKey(this,e);return!!(r&&this[r]!==void 0&&(!n||Um(this,this[r],r,n)))}return!1}delete(e,n){const r=this;let i=!1;function s(a){if(a=Wo(a),a){const o=A.findKey(r,a);o&&(!n||Um(r,r[o],o,n))&&(delete r[o],i=!0)}}return A.isArray(e)?e.forEach(s):s(e),i}clear(e){const n=Object.keys(this);let r=n.length,i=!1;for(;r--;){const s=n[r];(!e||Um(this,this[s],s,e,!0))&&(delete this[s],i=!0)}return i}normalize(e){const n=this,r={};return A.forEach(this,(i,s)=>{const a=A.findKey(r,s);if(a){n[a]=Gu(i),delete n[s];return}const o=e?I6(s):String(s).trim();o!==s&&delete n[s],n[o]=Gu(i),r[o]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const n=Object.create(null);return A.forEach(this,(r,i)=>{r!=null&&r!==!1&&(n[i]=e&&A.isArray(r)?r.join(", "):r)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,n])=>e+": "+n).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...n){const r=new this(e);return n.forEach(i=>r.set(i)),r}static accessor(e){const r=(this[Dw]=this[Dw]={accessors:{}}).accessors,i=this.prototype;function s(a){const o=Wo(a);r[o]||(C6(i,a),r[o]=!0)}return A.isArray(e)?e.forEach(s):s(e),this}}Xh.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);A.reduceDescriptors(Xh.prototype,({value:t},e)=>{let n=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(r){this[n]=r}}});A.freezeMethods(Xh);const Kr=Xh;function Bm(t,e){const n=this||tv,r=e||n,i=Kr.from(r.headers);let s=r.data;return A.forEach(t,function(o){s=o.call(n,s,i.normalize(),e?e.status:void 0)}),i.normalize(),s}function Rb(t){return!!(t&&t.__CANCEL__)}function bc(t,e,n){fe.call(this,t??"canceled",fe.ERR_CANCELED,e,n),this.name="CanceledError"}A.inherits(bc,fe,{__CANCEL__:!0});function A6(t,e,n){const r=n.config.validateStatus;!n.status||!r||r(n.status)?t(n):e(new fe("Request failed with status code "+n.status,[fe.ERR_BAD_REQUEST,fe.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}const R6=mr.isStandardBrowserEnv?function(){return{write:function(n,r,i,s,a,o){const l=[];l.push(n+"="+encodeURIComponent(r)),A.isNumber(i)&&l.push("expires="+new Date(i).toGMTString()),A.isString(s)&&l.push("path="+s),A.isString(a)&&l.push("domain="+a),o===!0&&l.push("secure"),document.cookie=l.join("; ")},read:function(n){const r=document.cookie.match(new RegExp("(^|;\\s*)("+n+")=([^;]*)"));return r?decodeURIComponent(r[3]):null},remove:function(n){this.write(n,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}();function P6(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function N6(t,e){return e?t.replace(/\/+$/,"")+"/"+e.replace(/^\/+/,""):t}function Pb(t,e){return t&&!P6(e)?N6(t,e):e}const j6=mr.isStandardBrowserEnv?function(){const e=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");let r;function i(s){let a=s;return e&&(n.setAttribute("href",a),a=n.href),n.setAttribute("href",a),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:n.pathname.charAt(0)==="/"?n.pathname:"/"+n.pathname}}return r=i(window.location.href),function(a){const o=A.isString(a)?i(a):a;return o.protocol===r.protocol&&o.host===r.host}}():function(){return function(){return!0}}();function O6(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}function D6(t,e){t=t||10;const n=new Array(t),r=new Array(t);let i=0,s=0,a;return e=e!==void 0?e:1e3,function(l){const u=Date.now(),d=r[s];a||(a=u),n[i]=l,r[i]=u;let h=s,m=0;for(;h!==i;)m+=n[h++],h=h%t;if(i=(i+1)%t,i===s&&(s=(s+1)%t),u-a<e)return;const p=d&&u-d;return p?Math.round(m*1e3/p):void 0}}function Mw(t,e){let n=0;const r=D6(50,250);return i=>{const s=i.loaded,a=i.lengthComputable?i.total:void 0,o=s-n,l=r(o),u=s<=a;n=s;const d={loaded:s,total:a,progress:a?s/a:void 0,bytes:o,rate:l||void 0,estimated:l&&a&&u?(a-s)/l:void 0,event:i};d[e?"download":"upload"]=!0,t(d)}}const M6=typeof XMLHttpRequest<"u",L6=M6&&function(t){return new Promise(function(n,r){let i=t.data;const s=Kr.from(t.headers).normalize(),a=t.responseType;let o;function l(){t.cancelToken&&t.cancelToken.unsubscribe(o),t.signal&&t.signal.removeEventListener("abort",o)}let u;A.isFormData(i)&&(mr.isStandardBrowserEnv||mr.isStandardBrowserWebWorkerEnv?s.setContentType(!1):s.getContentType(/^\s*multipart\/form-data/)?A.isString(u=s.getContentType())&&s.setContentType(u.replace(/^\s*(multipart\/form-data);+/,"$1")):s.setContentType("multipart/form-data"));let d=new XMLHttpRequest;if(t.auth){const g=t.auth.username||"",w=t.auth.password?unescape(encodeURIComponent(t.auth.password)):"";s.set("Authorization","Basic "+btoa(g+":"+w))}const h=Pb(t.baseURL,t.url);d.open(t.method.toUpperCase(),Ib(h,t.params,t.paramsSerializer),!0),d.timeout=t.timeout;function m(){if(!d)return;const g=Kr.from("getAllResponseHeaders"in d&&d.getAllResponseHeaders()),E={data:!a||a==="text"||a==="json"?d.responseText:d.response,status:d.status,statusText:d.statusText,headers:g,config:t,request:d};A6(function(y){n(y),l()},function(y){r(y),l()},E),d=null}if("onloadend"in d?d.onloadend=m:d.onreadystatechange=function(){!d||d.readyState!==4||d.status===0&&!(d.responseURL&&d.responseURL.indexOf("file:")===0)||setTimeout(m)},d.onabort=function(){d&&(r(new fe("Request aborted",fe.ECONNABORTED,t,d)),d=null)},d.onerror=function(){r(new fe("Network Error",fe.ERR_NETWORK,t,d)),d=null},d.ontimeout=function(){let w=t.timeout?"timeout of "+t.timeout+"ms exceeded":"timeout exceeded";const E=t.transitional||Cb;t.timeoutErrorMessage&&(w=t.timeoutErrorMessage),r(new fe(w,E.clarifyTimeoutError?fe.ETIMEDOUT:fe.ECONNABORTED,t,d)),d=null},mr.isStandardBrowserEnv){const g=j6(h)&&t.xsrfCookieName&&R6.read(t.xsrfCookieName);g&&s.set(t.xsrfHeaderName,g)}i===void 0&&s.setContentType(null),"setRequestHeader"in d&&A.forEach(s.toJSON(),function(w,E){d.setRequestHeader(E,w)}),A.isUndefined(t.withCredentials)||(d.withCredentials=!!t.withCredentials),a&&a!=="json"&&(d.responseType=t.responseType),typeof t.onDownloadProgress=="function"&&d.addEventListener("progress",Mw(t.onDownloadProgress,!0)),typeof t.onUploadProgress=="function"&&d.upload&&d.upload.addEventListener("progress",Mw(t.onUploadProgress)),(t.cancelToken||t.signal)&&(o=g=>{d&&(r(!g||g.type?new bc(null,t,d):g),d.abort(),d=null)},t.cancelToken&&t.cancelToken.subscribe(o),t.signal&&(t.signal.aborted?o():t.signal.addEventListener("abort",o)));const p=O6(h);if(p&&mr.protocols.indexOf(p)===-1){r(new fe("Unsupported protocol "+p+":",fe.ERR_BAD_REQUEST,t));return}d.send(i||null)})},zg={http:c6,xhr:L6};A.forEach(zg,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch{}Object.defineProperty(t,"adapterName",{value:e})}});const Lw=t=>`- ${t}`,F6=t=>A.isFunction(t)||t===null||t===!1,Nb={getAdapter:t=>{t=A.isArray(t)?t:[t];const{length:e}=t;let n,r;const i={};for(let s=0;s<e;s++){n=t[s];let a;if(r=n,!F6(n)&&(r=zg[(a=String(n)).toLowerCase()],r===void 0))throw new fe(`Unknown adapter '${a}'`);if(r)break;i[a||"#"+s]=r}if(!r){const s=Object.entries(i).map(([o,l])=>`adapter ${o} `+(l===!1?"is not supported by the environment":"is not available in the build"));let a=e?s.length>1?`since :
`+s.map(Lw).join(`
`):" "+Lw(s[0]):"as no adapter specified";throw new fe("There is no suitable adapter to dispatch the request "+a,"ERR_NOT_SUPPORT")}return r},adapters:zg};function Vm(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new bc(null,t)}function Fw(t){return Vm(t),t.headers=Kr.from(t.headers),t.data=Bm.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),Nb.getAdapter(t.adapter||tv.adapter)(t).then(function(r){return Vm(t),r.data=Bm.call(t,t.transformResponse,r),r.headers=Kr.from(r.headers),r},function(r){return Rb(r)||(Vm(t),r&&r.response&&(r.response.data=Bm.call(t,t.transformResponse,r.response),r.response.headers=Kr.from(r.response.headers))),Promise.reject(r)})}const $w=t=>t instanceof Kr?t.toJSON():t;function Za(t,e){e=e||{};const n={};function r(u,d,h){return A.isPlainObject(u)&&A.isPlainObject(d)?A.merge.call({caseless:h},u,d):A.isPlainObject(d)?A.merge({},d):A.isArray(d)?d.slice():d}function i(u,d,h){if(A.isUndefined(d)){if(!A.isUndefined(u))return r(void 0,u,h)}else return r(u,d,h)}function s(u,d){if(!A.isUndefined(d))return r(void 0,d)}function a(u,d){if(A.isUndefined(d)){if(!A.isUndefined(u))return r(void 0,u)}else return r(void 0,d)}function o(u,d,h){if(h in e)return r(u,d);if(h in t)return r(void 0,u)}const l={url:s,method:s,data:s,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:o,headers:(u,d)=>i($w(u),$w(d),!0)};return A.forEach(Object.keys(Object.assign({},t,e)),function(d){const h=l[d]||i,m=h(t[d],e[d],d);A.isUndefined(m)&&h!==o||(n[d]=m)}),n}const jb="1.6.0",nv={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{nv[t]=function(r){return typeof r===t||"a"+(e<1?"n ":" ")+t}});const zw={};nv.transitional=function(e,n,r){function i(s,a){return"[Axios v"+jb+"] Transitional option '"+s+"'"+a+(r?". "+r:"")}return(s,a,o)=>{if(e===!1)throw new fe(i(a," has been removed"+(n?" in "+n:"")),fe.ERR_DEPRECATED);return n&&!zw[a]&&(zw[a]=!0,console.warn(i(a," has been deprecated since v"+n+" and will be removed in the near future"))),e?e(s,a,o):!0}};function $6(t,e,n){if(typeof t!="object")throw new fe("options must be an object",fe.ERR_BAD_OPTION_VALUE);const r=Object.keys(t);let i=r.length;for(;i-- >0;){const s=r[i],a=e[s];if(a){const o=t[s],l=o===void 0||a(o,s,t);if(l!==!0)throw new fe("option "+s+" must be "+l,fe.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new fe("Unknown option "+s,fe.ERR_BAD_OPTION)}}const Ug={assertOptions:$6,validators:nv},di=Ug.validators;class jd{constructor(e){this.defaults=e,this.interceptors={request:new Ow,response:new Ow}}request(e,n){typeof e=="string"?(n=n||{},n.url=e):n=e||{},n=Za(this.defaults,n);const{transitional:r,paramsSerializer:i,headers:s}=n;r!==void 0&&Ug.assertOptions(r,{silentJSONParsing:di.transitional(di.boolean),forcedJSONParsing:di.transitional(di.boolean),clarifyTimeoutError:di.transitional(di.boolean)},!1),i!=null&&(A.isFunction(i)?n.paramsSerializer={serialize:i}:Ug.assertOptions(i,{encode:di.function,serialize:di.function},!0)),n.method=(n.method||this.defaults.method||"get").toLowerCase();let a=s&&A.merge(s.common,s[n.method]);s&&A.forEach(["delete","get","head","post","put","patch","common"],g=>{delete s[g]}),n.headers=Kr.concat(a,s);const o=[];let l=!0;this.interceptors.request.forEach(function(w){typeof w.runWhen=="function"&&w.runWhen(n)===!1||(l=l&&w.synchronous,o.unshift(w.fulfilled,w.rejected))});const u=[];this.interceptors.response.forEach(function(w){u.push(w.fulfilled,w.rejected)});let d,h=0,m;if(!l){const g=[Fw.bind(this),void 0];for(g.unshift.apply(g,o),g.push.apply(g,u),m=g.length,d=Promise.resolve(n);h<m;)d=d.then(g[h++],g[h++]);return d}m=o.length;let p=n;for(h=0;h<m;){const g=o[h++],w=o[h++];try{p=g(p)}catch(E){w.call(this,E);break}}try{d=Fw.call(this,p)}catch(g){return Promise.reject(g)}for(h=0,m=u.length;h<m;)d=d.then(u[h++],u[h++]);return d}getUri(e){e=Za(this.defaults,e);const n=Pb(e.baseURL,e.url);return Ib(n,e.params,e.paramsSerializer)}}A.forEach(["delete","get","head","options"],function(e){jd.prototype[e]=function(n,r){return this.request(Za(r||{},{method:e,url:n,data:(r||{}).data}))}});A.forEach(["post","put","patch"],function(e){function n(r){return function(s,a,o){return this.request(Za(o||{},{method:e,headers:r?{"Content-Type":"multipart/form-data"}:{},url:s,data:a}))}}jd.prototype[e]=n(),jd.prototype[e+"Form"]=n(!0)});const Ku=jd;class rv{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(s){n=s});const r=this;this.promise.then(i=>{if(!r._listeners)return;let s=r._listeners.length;for(;s-- >0;)r._listeners[s](i);r._listeners=null}),this.promise.then=i=>{let s;const a=new Promise(o=>{r.subscribe(o),s=o}).then(i);return a.cancel=function(){r.unsubscribe(s)},a},e(function(s,a,o){r.reason||(r.reason=new bc(s,a,o),n(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const n=this._listeners.indexOf(e);n!==-1&&this._listeners.splice(n,1)}static source(){let e;return{token:new rv(function(i){e=i}),cancel:e}}}const z6=rv;function U6(t){return function(n){return t.apply(null,n)}}function B6(t){return A.isObject(t)&&t.isAxiosError===!0}const Bg={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Bg).forEach(([t,e])=>{Bg[e]=t});const V6=Bg;function Ob(t){const e=new Ku(t),n=pb(Ku.prototype.request,e);return A.extend(n,Ku.prototype,e,{allOwnKeys:!0}),A.extend(n,e,null,{allOwnKeys:!0}),n.create=function(i){return Ob(Za(t,i))},n}const tt=Ob(tv);tt.Axios=Ku;tt.CanceledError=bc;tt.CancelToken=z6;tt.isCancel=Rb;tt.VERSION=jb;tt.toFormData=Qh;tt.AxiosError=fe;tt.Cancel=tt.CanceledError;tt.all=function(e){return Promise.all(e)};tt.spread=U6;tt.isAxiosError=B6;tt.mergeConfig=Za;tt.AxiosHeaders=Kr;tt.formToJSON=t=>Ab(A.isHTMLForm(t)?new FormData(t):t);tt.getAdapter=Nb.getAdapter;tt.HttpStatusCode=V6;tt.default=tt;const H6=tt,Db=H6.create({baseURL:{}.VITE_ENDPOINT||"https://express-zingmp3-awx6.vercel.app"}),Yn=()=>JSON.parse(localStorage.getItem("HD-MP3")||"{}"),kt=(t,e)=>{const n=Yn();return n[t]=e,localStorage.setItem("HD-MP3",JSON.stringify(n))},iv=t=>(n=>n.toLocaleLowerCase().replace(/à|á|ạ|ả|ã|â|ầ|ấ|ậ|ẩ|ẫ/g,"a").replace(/è|é|ẹ|ẻ|ẽ|ê|ề|ế|ệ|ể|ễ/g,"e").replace(/ì|í|ị|ỉ|ĩ/g,"i").replace(/ò|ó|ọ|ỏ|õ|ô|ồ|ố|ộ|ổ|ỗ/g,"o").replace(/ù|ú|ụ|ủ|ũ|ư|ừ|ứ|ự|ử|ữ/g,"u").replace(/ỳ|ý|ỵ|ỷ|ỹ/g,"y").replace(/đ/g,"d"))(t).toLocaleLowerCase().replaceAll(/[\W_]/g,"")+"_"+Xs(4),eo=t=>{const e=Math.floor(t/60),n=Math.round(t%60);return`${e}:${n.toString().padStart(2,"0")}`},W6=({...t})=>({...{name:"",singer:"",image_url:"",song_url:"",by:"",duration:0,lyric_id:"",image_file_path:"",song_file_path:"",id:"",song_in:"",blurhash_encode:"",size:0,queue_id:""},...t}),Mb=({...t})=>({...{id:"",name:"",song_ids:[],by:"",image_url:"",blurhash_encode:""},...t}),Vg=async t=>new Promise(e=>setTimeout(e,t)),Lb=(t,e)=>{t.scrollIntoView({behavior:e||"smooth",block:"center"})},Fb=t=>t?"disable":"",Uw=t=>t?"hidden":"";let Qu=Nd[3];const q6=Yn(),Bw=q6.theme;Bw&&[...Nd,...mb].forEach(t=>{t.id===Bw&&(Qu=t)});const $b={theme:{...Qu,alpha:Qu.type==="light"?"[#000]/[.1]":"[#fff]/[.1]",text_color:Qu.type==="light"?"text-[#333]":"text-[#fff]"},isOnMobile:window.innerWidth<800,isDev:!1},G6=(t,e)=>{switch(e.type){case 0:{const n=e.payload.theme;return{...t,theme:{...n,alpha:n.type==="dark"?"[#fff]/[.1]":"[#000]/[.1]",text_color:n.type==="light"?"text-[#333]":"text-[#fff]"}}}}},K6=()=>{const[t,e]=f.useReducer(G6,$b),n=f.useCallback(r=>{console.log("set theme"),e({type:0,payload:{theme:r}})},[]);return{state:t,setTheme:n}},Q6={state:$b,setTheme:()=>{}},zb=f.createContext(Q6),X6=({children:t})=>c.jsx(zb.Provider,{value:K6(),children:t}),H=()=>{const{state:{...t},...e}=f.useContext(zb);return{...t,...e}};function ft({className:t}){const{theme:e}=H();return c.jsx("div",{className:`animate-pulse rounded-[4px] bg-${e.alpha} ${t}`})}const Yh=[...Array(4).keys()].map(t=>c.jsxs("div",{className:"flex items-center p-[10px] border-b-[1px] border-transparent",children:[c.jsx(ft,{className:"h-[18px] w-[18px]"}),c.jsx(ft,{className:"h-[54px] w-[54px] ml-[10px] rounded-[4px]"}),c.jsxs("div",{className:"ml-[10px]",children:[c.jsx(ft,{className:"h-[20px] mb-[5px] w-[150px]"}),c.jsx(ft,{className:"h-[12px] mt-[5px] w-[100px]"})]})]},t)),Ub=()=>c.jsx("div",{className:"py-3",children:c.jsx(ft,{className:"w-full h-[28px]"})}),Y6=[...Array(2).keys()].map(t=>c.jsxs("div",{className:"w-1/4 p-[8px] max-[549px]:w-1/2",children:[c.jsx(ft,{className:"pt-[100%] rounded-[8px]"}),c.jsx(ft,{className:"h-[22px] mt-[6px] w-[50%]"})]},t));var J6=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","#","$","%","*","+",",","-",".",":",";","=","?","@","[","]","^","_","{","|","}","~"],il=t=>{let e=0;for(let n=0;n<t.length;n++){let r=t[n],i=J6.indexOf(r);e=e*83+i}return e},Hm=t=>{let e=t/255;return e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)},Wm=t=>{let e=Math.max(0,Math.min(1,t));return e<=.0031308?Math.trunc(e*12.92*255+.5):Math.trunc((1.055*Math.pow(e,.4166666666666667)-.055)*255+.5)},Z6=t=>t<0?-1:1,qm=(t,e)=>Z6(t)*Math.pow(Math.abs(t),e),Vw=class extends Error{constructor(e){super(e),this.name="ValidationError",this.message=e}},eO=t=>{if(!t||t.length<6)throw new Vw("The blurhash string must be at least 6 characters");let e=il(t[0]),n=Math.floor(e/9)+1,r=e%9+1;if(t.length!==4+2*r*n)throw new Vw(`blurhash length mismatch: length is ${t.length} but it should be ${4+2*r*n}`)},tO=t=>{let e=t>>16,n=t>>8&255,r=t&255;return[Hm(e),Hm(n),Hm(r)]},nO=(t,e)=>{let n=Math.floor(t/361),r=Math.floor(t/19)%19,i=t%19;return[qm((n-9)/9,2)*e,qm((r-9)/9,2)*e,qm((i-9)/9,2)*e]},rO=(t,e,n,r)=>{eO(t),r=r|1;let i=il(t[0]),s=Math.floor(i/9)+1,a=i%9+1,o=(il(t[1])+1)/166,l=new Array(a*s);for(let h=0;h<l.length;h++)if(h===0){let m=il(t.substring(2,6));l[h]=tO(m)}else{let m=il(t.substring(4+h*2,6+h*2));l[h]=nO(m,o*r)}let u=e*4,d=new Uint8ClampedArray(u*n);for(let h=0;h<n;h++)for(let m=0;m<e;m++){let p=0,g=0,w=0;for(let x=0;x<s;x++)for(let _=0;_<a;_++){let S=Math.cos(Math.PI*m*_/e)*Math.cos(Math.PI*h*x/n),k=l[_+x*a];p+=k[0]*S,g+=k[1]*S,w+=k[2]*S}let E=Wm(p),v=Wm(g),y=Wm(w);d[4*m+0+h*u]=E,d[4*m+1+h*u]=v,d[4*m+2+h*u]=y,d[4*m+3+h*u]=255}return d},iO=rO,sO=Object.defineProperty,aO=Object.defineProperties,oO=Object.getOwnPropertyDescriptors,Od=Object.getOwnPropertySymbols,Bb=Object.prototype.hasOwnProperty,Vb=Object.prototype.propertyIsEnumerable,Hw=(t,e,n)=>e in t?sO(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Hg=(t,e)=>{for(var n in e||(e={}))Bb.call(e,n)&&Hw(t,n,e[n]);if(Od)for(var n of Od(e))Vb.call(e,n)&&Hw(t,n,e[n]);return t},Wg=(t,e)=>aO(t,oO(e)),Hb=(t,e)=>{var n={};for(var r in t)Bb.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&Od)for(var r of Od(t))e.indexOf(r)<0&&Vb.call(t,r)&&(n[r]=t[r]);return n},Wb=class extends f.PureComponent{constructor(){super(...arguments),this.canvas=null,this.handleRef=e=>{this.canvas=e,this.draw()},this.draw=()=>{let{hash:e,height:n,punch:r,width:i}=this.props;if(this.canvas){let s=iO(e,i,n,r),a=this.canvas.getContext("2d"),o=a.createImageData(i,n);o.data.set(s),a.putImageData(o,0,0)}}}componentDidUpdate(){this.draw()}render(){let e=this.props,{hash:n,height:r,width:i}=e,s=Hb(e,["hash","height","width"]);return f.createElement("canvas",Wg(Hg({},s),{height:r,width:i,ref:this.handleRef}))}};Wb.defaultProps={height:128,width:128};var lO={position:"absolute",top:0,bottom:0,left:0,right:0,width:"100%",height:"100%"},Jh=class extends f.PureComponent{componentDidUpdate(){if(this.props.resolutionX<=0)throw new Error("resolutionX must be larger than zero");if(this.props.resolutionY<=0)throw new Error("resolutionY must be larger than zero")}render(){let e=this.props,{hash:n,height:r,width:i,punch:s,resolutionX:a,resolutionY:o,style:l}=e,u=Hb(e,["hash","height","width","punch","resolutionX","resolutionY","style"]);return f.createElement("div",Wg(Hg({},u),{style:Wg(Hg({display:"inline-block",height:r,width:i},l),{position:"relative"})}),f.createElement(Wb,{hash:n,height:o,width:a,punch:s,style:lO}))}};Jh.defaultProps={height:128,width:128,resolutionX:32,resolutionY:32};const Ww="/HD-MP3/assets/song-image-143f7bf0.png";function Nr({src:t,className:e,blurHashEncode:n,onError:r}){const[i,s]=f.useState(!1),a=f.useRef(null),o=()=>{s(!0),t&&t!=null&&t.includes("blob")&&URL.revokeObjectURL(t)},l=()=>{const d=a.current;d.src=Ww,s(!0)},u=()=>{r?(r(),l()):l()};return c.jsxs(c.Fragment,{children:[!i&&c.jsx(c.Fragment,{children:n?c.jsx(Jh,{hash:n,height:"100%",width:"100%"}):c.jsx(ft,{className:"w-full h-0"})}),c.jsx("img",{onLoad:o,onError:u,className:`${e||""} w-full ${i?"":"hidden"}`,src:t||Ww,ref:a})]})}const qb=({className:t,onClick:e,theme:n,children:r})=>c.jsx("div",{className:`w-full hover:brightness-[90%] rounded-[8px] overflow-hidden cursor-pointer border ${n.side_bar_bg} border-${n.alpha}  ${t}`,children:c.jsx("div",{onClick:()=>e&&e(),className:`${n==null?void 0:n.content_hover_text} pt-[100%] relative`,children:r||c.jsx(V,{className:`!absolute top-1/2 left-1/2 -translate-x-[50%] -translate-y-[50%] ${n.text_color}`,children:c.jsx(Xn,{className:"w-7 md:w-10"})})})}),cO=sb("",{variants:{p:{3:"p-3",2:"p-2",1:"p-1",clear:""},rounded:{xl:"rounded-xl",lg:"rounded-lg",md:"rounded-md",sm:"rounded-sm"}},defaultVariants:{p:3,rounded:"xl"}});function Ys({children:t,theme:e,className:n,color:r="container",p:i,rounded:s}){const a={black:"bg-[#292929]",container:e.container,sidebar:e.side_bar_bg};return c.jsx("div",{className:`  ${e.text_color} ${a[r]} border-[1px] border-${e.alpha} ${cO({p:i,rounded:s,className:n})}`,children:t})}function Gm({className:t,icon:e,label:n,to:r,arrowIcon:i,children:s}){return r?c.jsxs(Br,{className:`w-full flex  justify-between  ${t}`,to:r,children:[c.jsxs("div",{className:"inline-flex items-center ",children:[e,c.jsx("span",{className:"text-lg font-medium",children:n})]}),s,i&&c.jsx("span",{children:i})]}):c.jsx("p",{children:"No onClick"})}function uO(){const[t,e]=f.useState({songs:[],playlists:[]}),[n,r]=f.useState([]),[i,s]=f.useState([]),a=f.useRef(!1);return{songs:n,ranGetSong:a,setSongs:r,playlists:i,setPlaylists:s,sysSongPlaylist:t,setSysSongPlaylist:e,updateSong:l=>{const u=[...n],d=u.findIndex(h=>h.id===l.id);d!==-1&&(Object.assign(u[d],l.song),r(u))}}}const Gb=f.createContext(null);function dO({children:t}){return c.jsx(Gb.Provider,{value:uO(),children:t})}const Jt=()=>{const t=f.useContext(Gb);if(!t)throw new Error("SongContext not provided");return t},hO=()=>{const[t,e]=f.useState(!1),[n,r]=f.useState(!1),[i,s]=f.useState([]);return{isChecked:t,setIsChecked:e,isSelectAll:n,setIsSelectAll:r,setSelectedSongs:s,selectedSongs:i,selectAllSong:u=>{e(!0),r(!0),s(u)},selectSong:u=>{const d=[...i],h=d.findIndex(m=>m.id===u.id);h===-1?d.push(u):d.splice(h,1),e(!!d.length),s(d)},resetSelect:()=>{e(!1),r(!1),s([])}}},Kb=f.createContext(null);function Js({children:t}){return c.jsx(Kb.Provider,{value:hO(),children:t})}const To=()=>{const t=f.useContext(Kb);if(!t)throw new Error("SelectSongContext not provided");return t};function Qb({song:t,theme:e,...n}){const{selectedSongs:r,selectSong:i}=To(),s=u=>{switch(n.variant){case"default":case"playing-next":return n.onClick(u);case"select":return i(t)}},a=f.useMemo(()=>n.variant!=="select"?!1:r.findIndex(u=>u.id===t.id)!=-1,[r]),o={itemContainer:`items-center justify-between cursor-pointer border-b 
    last:border-none border-${e.alpha} flex rounded-md p-2 ${a&&"bg-"+e.alpha}`,button:`${e.content_bg} rounded-full`,songListButton:"mr-[10px] px-[5px]",imageFrame:"w-[54px] h-[54px] relative rounded-[4px] overflow-hidden flex-shrink-0",before:"after:content-[''] after:absolute after:h-[100%] after:w-[10px] after:right-[100%]"},l=()=>{switch(n.variant){case"select":return c.jsx(c.Fragment,{children:a?c.jsx(Uh,{className:"w-5 mr-1"}):c.jsx(Pd,{className:"w-5 mr-1"})});default:return c.jsx(c.Fragment,{})}};return c.jsx(c.Fragment,{children:c.jsx("div",{onClick:s,className:`target-class opacity-100 transition-[opacity,transform] duration-500 ${o.itemContainer} `,children:c.jsxs("div",{className:"flex flex-row w-[100%]",children:[l(),c.jsxs("div",{className:"flex-grow flex",children:[c.jsx("div",{className:`${o.imageFrame}  `,children:c.jsx(Nr,{blurHashEncode:t.blurhash_encode,src:t.image_url})}),c.jsxs("div",{className:"ml-[10px]",children:[c.jsx("h5",{className:`text-lg line-clamp-1 ${a&&e.content_text}`,children:t.name}),c.jsx("p",{className:"opacity-60 bg-blend-lighten line-clamp-1",children:t.singer})]})]})]})})})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xb=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},fO=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[n++],a=t[n++],o=t[n++],l=((i&7)<<18|(s&63)<<12|(a&63)<<6|o&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const s=t[n++],a=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},Yb={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const s=t[i],a=i+1<t.length,o=a?t[i+1]:0,l=i+2<t.length,u=l?t[i+2]:0,d=s>>2,h=(s&3)<<4|o>>4;let m=(o&15)<<2|u>>6,p=u&63;l||(p=64,a||(m=64)),r.push(n[d],n[h],n[m],n[p])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Xb(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):fO(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const s=n[t.charAt(i++)],o=i<t.length?n[t.charAt(i)]:0;++i;const u=i<t.length?n[t.charAt(i)]:64;++i;const h=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||o==null||u==null||h==null)throw new mO;const m=s<<2|o>>4;if(r.push(m),u!==64){const p=o<<4&240|u>>2;if(r.push(p),h!==64){const g=u<<6&192|h;r.push(g)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class mO extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const pO=function(t){const e=Xb(t);return Yb.encodeByteArray(e,!0)},Dd=function(t){return pO(t).replace(/\./g,"")},Jb=function(t){try{return Yb.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gO(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yO=()=>gO().__FIREBASE_DEFAULTS__,vO=()=>{if(typeof process>"u"||typeof process.env>"u")return;const t={}.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},xO=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&Jb(t[1]);return e&&JSON.parse(e)},Zh=()=>{try{return yO()||vO()||xO()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Zb=t=>{var e,n;return(n=(e=Zh())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},eT=t=>{const e=Zb(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},tT=()=>{var t;return(t=Zh())===null||t===void 0?void 0:t.config},nT=t=>{var e;return(e=Zh())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wO{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rT(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t),o="";return[Dd(JSON.stringify(n)),Dd(JSON.stringify(a)),o].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function _O(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(zt())}function EO(){var t;const e=(t=Zh())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function SO(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function kO(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function bO(){const t=zt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function TO(){try{return typeof indexedDB=="object"}catch{return!1}}function IO(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CO="FirebaseError";class jr extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=CO,Object.setPrototypeOf(this,jr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Tc.prototype.create)}}class Tc{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?AO(s,r):"Error",o=`${this.serviceName}: ${a} (${i}).`;return new jr(i,o,r)}}function AO(t,e){return t.replace(RO,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const RO=/\{\$([^}]+)}/g;function PO(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Md(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const s=t[i],a=e[i];if(qw(s)&&qw(a)){if(!Md(s,a))return!1}else if(s!==a)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function qw(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ic(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function NO(t,e){const n=new jO(t,e);return n.subscribe.bind(n)}class jO{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");OO(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=Km),i.error===void 0&&(i.error=Km),i.complete===void 0&&(i.complete=Km);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function OO(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Km(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ot(t){return t&&t._delegate?t._delegate:t}class Wi{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hs="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let DO=class{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new wO;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(LO(e))try{this.getOrInitializeService({instanceIdentifier:hs})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=hs){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=hs){return this.instances.has(e)}getOptions(e=hs){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(s);r===o&&a.resolve(i)}return i}onInit(e,n){var r;const i=this.normalizeInstanceIdentifier(n),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);const a=this.instances.get(i);return a&&e(a,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:MO(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=hs){return this.component?this.component.multipleInstances?e:hs:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function MO(t){return t===hs?void 0:t}function LO(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FO{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new DO(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var pe;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(pe||(pe={}));const $O={debug:pe.DEBUG,verbose:pe.VERBOSE,info:pe.INFO,warn:pe.WARN,error:pe.ERROR,silent:pe.SILENT},zO=pe.INFO,UO={[pe.DEBUG]:"log",[pe.VERBOSE]:"log",[pe.INFO]:"info",[pe.WARN]:"warn",[pe.ERROR]:"error"},BO=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=UO[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class sv{constructor(e){this.name=e,this._logLevel=zO,this._logHandler=BO,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in pe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?$O[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,pe.DEBUG,...e),this._logHandler(this,pe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,pe.VERBOSE,...e),this._logHandler(this,pe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,pe.INFO,...e),this._logHandler(this,pe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,pe.WARN,...e),this._logHandler(this,pe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,pe.ERROR,...e),this._logHandler(this,pe.ERROR,...e)}}const VO=(t,e)=>e.some(n=>t instanceof n);let Gw,Kw;function HO(){return Gw||(Gw=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function WO(){return Kw||(Kw=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const iT=new WeakMap,qg=new WeakMap,sT=new WeakMap,Qm=new WeakMap,av=new WeakMap;function qO(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",a)},s=()=>{n(Fi(t.result)),i()},a=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",a)});return e.then(n=>{n instanceof IDBCursor&&iT.set(n,t)}).catch(()=>{}),av.set(e,t),e}function GO(t){if(qg.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",a),t.removeEventListener("abort",a)},s=()=>{n(),i()},a=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",a),t.addEventListener("abort",a)});qg.set(t,e)}let Gg={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return qg.get(t);if(e==="objectStoreNames")return t.objectStoreNames||sT.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Fi(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function KO(t){Gg=t(Gg)}function QO(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Xm(this),e,...n);return sT.set(r,e.sort?e.sort():[e]),Fi(r)}:WO().includes(t)?function(...e){return t.apply(Xm(this),e),Fi(iT.get(this))}:function(...e){return Fi(t.apply(Xm(this),e))}}function XO(t){return typeof t=="function"?QO(t):(t instanceof IDBTransaction&&GO(t),VO(t,HO())?new Proxy(t,Gg):t)}function Fi(t){if(t instanceof IDBRequest)return qO(t);if(Qm.has(t))return Qm.get(t);const e=XO(t);return e!==t&&(Qm.set(t,e),av.set(e,t)),e}const Xm=t=>av.get(t);function YO(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const a=indexedDB.open(t,e),o=Fi(a);return r&&a.addEventListener("upgradeneeded",l=>{r(Fi(a.result),l.oldVersion,l.newVersion,Fi(a.transaction),l)}),n&&a.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),o.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),o}const JO=["get","getKey","getAll","getAllKeys","count"],ZO=["put","add","delete","clear"],Ym=new Map;function Qw(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Ym.get(e))return Ym.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=ZO.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||JO.includes(n)))return;const s=async function(a,...o){const l=this.transaction(a,i?"readwrite":"readonly");let u=l.store;return r&&(u=u.index(o.shift())),(await Promise.all([u[n](...o),i&&l.done]))[0]};return Ym.set(e,s),s}KO(t=>({...t,get:(e,n,r)=>Qw(e,n)||t.get(e,n,r),has:(e,n)=>!!Qw(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eD{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(tD(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function tD(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Kg="@firebase/app",Xw="0.9.17";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Os=new sv("@firebase/app"),nD="@firebase/app-compat",rD="@firebase/analytics-compat",iD="@firebase/analytics",sD="@firebase/app-check-compat",aD="@firebase/app-check",oD="@firebase/auth",lD="@firebase/auth-compat",cD="@firebase/database",uD="@firebase/database-compat",dD="@firebase/functions",hD="@firebase/functions-compat",fD="@firebase/installations",mD="@firebase/installations-compat",pD="@firebase/messaging",gD="@firebase/messaging-compat",yD="@firebase/performance",vD="@firebase/performance-compat",xD="@firebase/remote-config",wD="@firebase/remote-config-compat",_D="@firebase/storage",ED="@firebase/storage-compat",SD="@firebase/firestore",kD="@firebase/firestore-compat",bD="firebase",TD="10.3.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qg="[DEFAULT]",ID={[Kg]:"fire-core",[nD]:"fire-core-compat",[iD]:"fire-analytics",[rD]:"fire-analytics-compat",[aD]:"fire-app-check",[sD]:"fire-app-check-compat",[oD]:"fire-auth",[lD]:"fire-auth-compat",[cD]:"fire-rtdb",[uD]:"fire-rtdb-compat",[dD]:"fire-fn",[hD]:"fire-fn-compat",[fD]:"fire-iid",[mD]:"fire-iid-compat",[pD]:"fire-fcm",[gD]:"fire-fcm-compat",[yD]:"fire-perf",[vD]:"fire-perf-compat",[xD]:"fire-rc",[wD]:"fire-rc-compat",[_D]:"fire-gcs",[ED]:"fire-gcs-compat",[SD]:"fire-fst",[kD]:"fire-fst-compat","fire-js":"fire-js",[bD]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ld=new Map,Xg=new Map;function CD(t,e){try{t.container.addComponent(e)}catch(n){Os.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Ds(t){const e=t.name;if(Xg.has(e))return Os.debug(`There were multiple attempts to register component ${e}.`),!1;Xg.set(e,t);for(const n of Ld.values())CD(n,t);return!0}function ef(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AD={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},$i=new Tc("app","Firebase",AD);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RD{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Wi("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw $i.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zs=TD;function aT(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:Qg,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw $i.create("bad-app-name",{appName:String(i)});if(n||(n=tT()),!n)throw $i.create("no-options");const s=Ld.get(i);if(s){if(Md(n,s.options)&&Md(r,s.config))return s;throw $i.create("duplicate-app",{appName:i})}const a=new FO(i);for(const l of Xg.values())a.addComponent(l);const o=new RD(n,r,a);return Ld.set(i,o),o}function ov(t=Qg){const e=Ld.get(t);if(!e&&t===Qg&&tT())return aT();if(!e)throw $i.create("no-app",{appName:t});return e}function _r(t,e,n){var r;let i=(r=ID[t])!==null&&r!==void 0?r:t;n&&(i+=`-${n}`);const s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){const o=[`Unable to register library "${i}" with version "${e}":`];s&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&o.push("and"),a&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Os.warn(o.join(" "));return}Ds(new Wi(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PD="firebase-heartbeat-database",ND=1,Kl="firebase-heartbeat-store";let Jm=null;function oT(){return Jm||(Jm=YO(PD,ND,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Kl)}}}).catch(t=>{throw $i.create("idb-open",{originalErrorMessage:t.message})})),Jm}async function jD(t){try{return await(await oT()).transaction(Kl).objectStore(Kl).get(lT(t))}catch(e){if(e instanceof jr)Os.warn(e.message);else{const n=$i.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Os.warn(n.message)}}}async function Yw(t,e){try{const r=(await oT()).transaction(Kl,"readwrite");await r.objectStore(Kl).put(e,lT(t)),await r.done}catch(n){if(n instanceof jr)Os.warn(n.message);else{const r=$i.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Os.warn(r.message)}}}function lT(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OD=1024,DD=30*24*60*60*1e3;class MD{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new FD(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=Jw();if(this._heartbeatsCache===null&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(i=>i.date===r)))return this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(i=>{const s=new Date(i.date).valueOf();return Date.now()-s<=DD}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache===null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Jw(),{heartbeatsToSend:n,unsentEntries:r}=LD(this._heartbeatsCache.heartbeats),i=Dd(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}}function Jw(){return new Date().toISOString().substring(0,10)}function LD(t,e=OD){const n=[];let r=t.slice();for(const i of t){const s=n.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),Zw(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),Zw(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class FD{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return TO()?IO().then(()=>!0).catch(()=>!1):!1}async read(){return await this._canUseIndexedDBPromise?await jD(this.app)||{heartbeats:[]}:{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return Yw(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return Yw(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function Zw(t){return Dd(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $D(t){Ds(new Wi("platform-logger",e=>new eD(e),"PRIVATE")),Ds(new Wi("heartbeat",e=>new MD(e),"PRIVATE")),_r(Kg,Xw,t),_r(Kg,Xw,"esm2017"),_r("fire-js","")}$D("");function lv(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function cT(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const zD=cT,uT=new Tc("auth","Firebase",cT());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fd=new sv("@firebase/auth");function UD(t,...e){Fd.logLevel<=pe.WARN&&Fd.warn(`Auth (${Zs}): ${t}`,...e)}function Xu(t,...e){Fd.logLevel<=pe.ERROR&&Fd.error(`Auth (${Zs}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ir(t,...e){throw cv(t,...e)}function Er(t,...e){return cv(t,...e)}function dT(t,e,n){const r=Object.assign(Object.assign({},zD()),{[e]:n});return new Tc("auth","Firebase",r).create(e,{appName:t.name})}function BD(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&Ir(t,"argument-error"),dT(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function cv(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return uT.create(t,...e)}function te(t,e,...n){if(!t)throw cv(e,...n)}function Vr(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Xu(e),new Error(e)}function ti(t,e){t||Vr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yg(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function VD(){return e_()==="http:"||e_()==="https:"}function e_(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HD(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(VD()||SO()||"connection"in navigator)?navigator.onLine:!0}function WD(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cc{constructor(e,n){this.shortDelay=e,this.longDelay=n,ti(n>e,"Short delay should be less than long delay!"),this.isMobile=_O()||kO()}get(){return HD()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uv(t,e){ti(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hT{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;Vr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;Vr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;Vr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qD={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GD=new Cc(3e4,6e4);function fT(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Ac(t,e,n,r,i={}){return mT(t,i,async()=>{let s={},a={};r&&(e==="GET"?a=r:s={body:JSON.stringify(r)});const o=Ic(Object.assign({key:t.config.apiKey},a)).slice(1),l=await t._getAdditionalHeaders();return l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode),hT.fetch()(pT(t,t.config.apiHost,n,o),Object.assign({method:e,headers:l,referrerPolicy:"no-referrer"},s))})}async function mT(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},qD),e);try{const i=new QD(t),s=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const a=await s.json();if("needConfirmation"in a)throw fu(t,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{const o=s.ok?a.errorMessage:a.error.message,[l,u]=o.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw fu(t,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw fu(t,"email-already-in-use",a);if(l==="USER_DISABLED")throw fu(t,"user-disabled",a);const d=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw dT(t,d,u);Ir(t,d)}}catch(i){if(i instanceof jr)throw i;Ir(t,"network-request-failed",{message:String(i)})}}async function KD(t,e,n,r,i={}){const s=await Ac(t,e,n,r,i);return"mfaPendingCredential"in s&&Ir(t,"multi-factor-auth-required",{_serverResponse:s}),s}function pT(t,e,n,r){const i=`${e}${n}?${r}`;return t.config.emulator?uv(t.config,i):`${t.config.apiScheme}://${i}`}class QD{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Er(this.auth,"network-request-failed")),GD.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function fu(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=Er(t,e,r);return i.customData._tokenResponse=n,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function XD(t,e){return Ac(t,"POST","/v1/accounts:delete",e)}async function YD(t,e){return Ac(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wl(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function JD(t,e=!1){const n=ot(t),r=await n.getIdToken(e),i=dv(r);te(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,a=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:wl(Zm(i.auth_time)),issuedAtTime:wl(Zm(i.iat)),expirationTime:wl(Zm(i.exp)),signInProvider:a||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function Zm(t){return Number(t)*1e3}function dv(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Xu("JWT malformed, contained fewer than 3 sections"),null;try{const i=Jb(n);return i?JSON.parse(i):(Xu("Failed to decode base64 JWT payload"),null)}catch(i){return Xu("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function ZD(t){const e=dv(t);return te(e,"internal-error"),te(typeof e.exp<"u","internal-error"),te(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ql(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof jr&&eM(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function eM({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tM{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const i=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gT{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=wl(this.lastLoginAt),this.creationTime=wl(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $d(t){var e;const n=t.auth,r=await t.getIdToken(),i=await Ql(t,YD(n,{idToken:r}));te(i==null?void 0:i.users.length,n,"internal-error");const s=i.users[0];t._notifyReloadListener(s);const a=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?iM(s.providerUserInfo):[],o=rM(t.providerData,a),l=t.isAnonymous,u=!(t.email&&s.passwordHash)&&!(o!=null&&o.length),d=l?u:!1,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new gT(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(t,h)}async function nM(t){const e=ot(t);await $d(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function rM(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function iM(t){return t.map(e=>{var{providerId:n}=e,r=lv(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sM(t,e){const n=await mT(t,{},async()=>{const r=Ic({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,a=pT(t,i,"/v1/token",`key=${s}`),o=await t._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",hT.fetch()(a,{method:"POST",headers:o,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){te(e.idToken,"internal-error"),te(typeof e.idToken<"u","internal-error"),te(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):ZD(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}async getToken(e,n=!1){return te(!this.accessToken||this.refreshToken,e,"user-token-expired"),!n&&this.accessToken&&!this.isExpired?this.accessToken:this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:i,expiresIn:s}=await sM(e,n);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:i,expirationTime:s}=n,a=new Xl;return r&&(te(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),i&&(te(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),s&&(te(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Xl,this.toJSON())}_performRefresh(){return Vr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hi(t,e){te(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class bs{constructor(e){var{uid:n,auth:r,stsTokenManager:i}=e,s=lv(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new tM(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new gT(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await Ql(this,this.stsTokenManager.getToken(this.auth,e));return te(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return JD(this,e)}reload(){return nM(this)}_assign(e){this!==e&&(te(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new bs(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){te(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await $d(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await Ql(this,XD(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,i,s,a,o,l,u,d;const h=(r=n.displayName)!==null&&r!==void 0?r:void 0,m=(i=n.email)!==null&&i!==void 0?i:void 0,p=(s=n.phoneNumber)!==null&&s!==void 0?s:void 0,g=(a=n.photoURL)!==null&&a!==void 0?a:void 0,w=(o=n.tenantId)!==null&&o!==void 0?o:void 0,E=(l=n._redirectEventId)!==null&&l!==void 0?l:void 0,v=(u=n.createdAt)!==null&&u!==void 0?u:void 0,y=(d=n.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:x,emailVerified:_,isAnonymous:S,providerData:k,stsTokenManager:b}=n;te(x&&b,e,"internal-error");const T=Xl.fromJSON(this.name,b);te(typeof x=="string",e,"internal-error"),hi(h,e.name),hi(m,e.name),te(typeof _=="boolean",e,"internal-error"),te(typeof S=="boolean",e,"internal-error"),hi(p,e.name),hi(g,e.name),hi(w,e.name),hi(E,e.name),hi(v,e.name),hi(y,e.name);const P=new bs({uid:x,auth:e,email:m,emailVerified:_,displayName:h,isAnonymous:S,photoURL:g,phoneNumber:p,tenantId:w,stsTokenManager:T,createdAt:v,lastLoginAt:y});return k&&Array.isArray(k)&&(P.providerData=k.map(N=>Object.assign({},N))),E&&(P._redirectEventId=E),P}static async _fromIdTokenResponse(e,n,r=!1){const i=new Xl;i.updateFromServerResponse(n);const s=new bs({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await $d(s),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t_=new Map;function Hr(t){ti(t instanceof Function,"Expected a class definition");let e=t_.get(t);return e?(ti(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,t_.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yT{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}yT.type="NONE";const n_=yT;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yu(t,e,n){return`firebase:${t}:${e}:${n}`}class Da{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=Yu(this.userKey,i.apiKey,s),this.fullPersistenceKey=Yu("persistence",i.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?bs._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new Da(Hr(n_),e,r);const i=(await Promise.all(n.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let s=i[0]||Hr(n_);const a=Yu(r,e.config.apiKey,e.name);let o=null;for(const u of n)try{const d=await u._get(a);if(d){const h=bs._fromJSON(e,d);u!==s&&(o=h),s=u;break}}catch{}const l=i.filter(u=>u._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new Da(s,e,r):(s=l[0],o&&await s._set(a,o.toJSON()),await Promise.all(n.map(async u=>{if(u!==s)try{await u._remove(a)}catch{}})),new Da(s,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r_(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(wT(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(vT(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(ET(e))return"Blackberry";if(ST(e))return"Webos";if(hv(e))return"Safari";if((e.includes("chrome/")||xT(e))&&!e.includes("edge/"))return"Chrome";if(_T(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function vT(t=zt()){return/firefox\//i.test(t)}function hv(t=zt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function xT(t=zt()){return/crios\//i.test(t)}function wT(t=zt()){return/iemobile/i.test(t)}function _T(t=zt()){return/android/i.test(t)}function ET(t=zt()){return/blackberry/i.test(t)}function ST(t=zt()){return/webos/i.test(t)}function tf(t=zt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function aM(t=zt()){var e;return tf(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function oM(){return bO()&&document.documentMode===10}function kT(t=zt()){return tf(t)||_T(t)||ST(t)||ET(t)||/windows phone/i.test(t)||wT(t)}function lM(){try{return!!(window&&window!==window.top)}catch{return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bT(t,e=[]){let n;switch(t){case"Browser":n=r_(zt());break;case"Worker":n=`${r_(zt())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Zs}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cM{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=s=>new Promise((a,o)=>{try{const l=e(s);a(l)}catch(l){o(l)}});r.onAbort=n,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uM(t,e={}){return Ac(t,"GET","/v2/passwordPolicy",fT(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dM=6;class hM{constructor(e){var n,r,i,s;const a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=a.minPasswordLength)!==null&&n!==void 0?n:dM,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,i,s,a,o;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(n=l.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(r=l.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(i=l.containsLowercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(s=l.containsUppercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(a=l.containsNumericCharacter)!==null&&a!==void 0?a:!0),l.isValid&&(l.isValid=(o=l.containsNonAlphanumericCharacter)!==null&&o!==void 0?o:!0),l}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fM{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new i_(this),this.idTokenSubscription=new i_(this),this.beforeStateQueue=new cM(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=uT,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Hr(n)),this._initializationPromise=this.queue(async()=>{var r,i;if(!this._deleted&&(this.persistenceManager=await Da.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUser(e){var n;const r=await this.assertedPersistence.getCurrentUser();let i=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,o=i==null?void 0:i._redirectEventId,l=await this.tryRedirectSignIn(e);(!a||a===o)&&(l!=null&&l.user)&&(i=l.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(a){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return te(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await $d(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=WD()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const n=e?ot(e):null;return n&&te(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&te(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(e){return this.queue(async()=>{await this.assertedPersistence.setPersistence(Hr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await uM(this),n=new hM(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Tc("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Hr(e)||this._popupRedirectResolver;te(n,this,"argument-error"),this.redirectPersistenceManager=await Da.create(this,[Hr(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};const s=typeof n=="function"?n:n.next.bind(n);let a=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(te(o,this,"internal-error"),o.then(()=>{a||s(this.currentUser)}),typeof n=="function"){const l=e.addObserver(n,r,i);return()=>{a=!0,l()}}else{const l=e.addObserver(n);return()=>{a=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return te(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=bT(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const i=await this._getAppCheckToken();return i&&(n["X-Firebase-AppCheck"]=i),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&UD(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function nf(t){return ot(t)}class i_{constructor(e){this.auth=e,this.observer=null,this.addObserver=NO(n=>this.observer=n)}get next(){return te(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mM(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}function pM(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{const s=Er("internal-error");s.customData=i,n(s)},r.type="text/javascript",r.charset="UTF-8",mM().appendChild(r)})}function gM(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yM(t,e){const n=ef(t,"auth");if(n.isInitialized()){const i=n.getImmediate(),s=n.getOptions();if(Md(s,e??{}))return i;Ir(i,"already-initialized")}return n.initialize({options:e})}function vM(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Hr);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function xM(t,e,n){const r=nf(t);te(r._canInitEmulator,r,"emulator-config-failed"),te(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!!(n!=null&&n.disableWarnings),s=TT(e),{host:a,port:o}=wM(e),l=o===null?"":`:${o}`;r.config.emulator={url:`${s}//${a}${l}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:a,port:o,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||_M()}function TT(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function wM(t){const e=TT(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:s_(r.substr(s.length+1))}}else{const[s,a]=r.split(":");return{host:s,port:s_(a)}}}function s_(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function _M(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IT{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Vr("not implemented")}_getIdTokenResponse(e){return Vr("not implemented")}_linkToIdToken(e,n){return Vr("not implemented")}_getReauthenticationResolver(e){return Vr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ma(t,e){return KD(t,"POST","/v1/accounts:signInWithIdp",fT(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EM="http://localhost";class Ms extends IT{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Ms(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Ir("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=n,s=lv(n,["providerId","signInMethod"]);if(!r||!i)return null;const a=new Ms(r,i);return a.idToken=s.idToken||void 0,a.accessToken=s.accessToken||void 0,a.secret=s.secret,a.nonce=s.nonce,a.pendingToken=s.pendingToken||null,a}_getIdTokenResponse(e){const n=this.buildRequest();return Ma(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Ma(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Ma(e,n)}buildRequest(){const e={requestUri:EM,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Ic(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fv{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rc extends fv{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xi extends Rc{constructor(){super("facebook.com")}static credential(e){return Ms._fromParams({providerId:xi.PROVIDER_ID,signInMethod:xi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return xi.credentialFromTaggedObject(e)}static credentialFromError(e){return xi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return xi.credential(e.oauthAccessToken)}catch{return null}}}xi.FACEBOOK_SIGN_IN_METHOD="facebook.com";xi.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hr extends Rc{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Ms._fromParams({providerId:hr.PROVIDER_ID,signInMethod:hr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return hr.credentialFromTaggedObject(e)}static credentialFromError(e){return hr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return hr.credential(n,r)}catch{return null}}}hr.GOOGLE_SIGN_IN_METHOD="google.com";hr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wi extends Rc{constructor(){super("github.com")}static credential(e){return Ms._fromParams({providerId:wi.PROVIDER_ID,signInMethod:wi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return wi.credentialFromTaggedObject(e)}static credentialFromError(e){return wi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return wi.credential(e.oauthAccessToken)}catch{return null}}}wi.GITHUB_SIGN_IN_METHOD="github.com";wi.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _i extends Rc{constructor(){super("twitter.com")}static credential(e,n){return Ms._fromParams({providerId:_i.PROVIDER_ID,signInMethod:_i.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return _i.credentialFromTaggedObject(e)}static credentialFromError(e){return _i.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return _i.credential(n,r)}catch{return null}}}_i.TWITTER_SIGN_IN_METHOD="twitter.com";_i.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class to{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,i=!1){const s=await bs._fromIdTokenResponse(e,r,i),a=a_(r);return new to({user:s,providerId:a,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const i=a_(r);return new to({user:e,providerId:i,_tokenResponse:r,operationType:n})}}function a_(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zd extends jr{constructor(e,n,r,i){var s;super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,zd.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,i){return new zd(e,n,r,i)}}function CT(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?zd._fromErrorAndOperation(t,s,e,r):s})}async function SM(t,e,n=!1){const r=await Ql(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return to._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kM(t,e,n=!1){const{auth:r}=t,i="reauthenticate";try{const s=await Ql(t,CT(r,i,e,t),n);te(s.idToken,r,"internal-error");const a=dv(s.idToken);te(a,r,"internal-error");const{sub:o}=a;return te(t.uid===o,r,"user-mismatch"),to._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&Ir(r,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bM(t,e,n=!1){const r="signIn",i=await CT(t,r,e),s=await to._fromIdTokenResponse(t,r,i);return n||await t._updateCurrentUser(s.user),s}function TM(t,e,n,r){return ot(t).onIdTokenChanged(e,n,r)}function IM(t,e,n){return ot(t).beforeAuthStateChanged(e,n)}function CM(t,e,n,r){return ot(t).onAuthStateChanged(e,n,r)}function AT(t){return ot(t).signOut()}const Ud="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RT{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Ud,"1"),this.storage.removeItem(Ud),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AM(){const t=zt();return hv(t)||tf(t)}const RM=1e3,PM=10;class PT extends RT{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=AM()&&lM(),this.fallbackToPolling=kT(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),i=this.localCache[n];r!==i&&e(n,i,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((a,o,l)=>{this.notifyListeners(a,l)});return}const r=e.key;if(n?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const a=this.storage.getItem(r);if(e.newValue!==a)e.newValue!==null?this.storage.setItem(r,e.newValue):this.storage.removeItem(r);else if(this.localCache[r]===e.newValue&&!n)return}const i=()=>{const a=this.storage.getItem(r);!n&&this.localCache[r]===a||this.notifyListeners(r,a)},s=this.storage.getItem(r);oM()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,PM):i()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},RM)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}PT.type="LOCAL";const NM=PT;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NT extends RT{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}NT.type="SESSION";const jT=NT;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jM(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const r=new rf(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:i,data:s}=n.data,a=this.handlersMap[i];if(!(a!=null&&a.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const o=Array.from(a).map(async u=>u(n.origin,s)),l=await jM(o);n.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}rf.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mv(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OM{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,a;return new Promise((o,l)=>{const u=mv("",20);i.port1.start();const d=setTimeout(()=>{l(new Error("unsupported_event"))},r);a={messageChannel:i,onMessage(h){const m=h;if(m.data.eventId===u)switch(m.data.status){case"ack":clearTimeout(d),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),o(m.data.response);break;default:clearTimeout(d),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:u,data:n},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sr(){return window}function DM(t){Sr().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OT(){return typeof Sr().WorkerGlobalScope<"u"&&typeof Sr().importScripts=="function"}async function MM(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function LM(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function FM(){return OT()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DT="firebaseLocalStorageDb",$M=1,Bd="firebaseLocalStorage",MT="fbase_key";class Pc{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function sf(t,e){return t.transaction([Bd],e?"readwrite":"readonly").objectStore(Bd)}function zM(){const t=indexedDB.deleteDatabase(DT);return new Pc(t).toPromise()}function Jg(){const t=indexedDB.open(DT,$M);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Bd,{keyPath:MT})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Bd)?e(r):(r.close(),await zM(),e(await Jg()))})})}async function o_(t,e,n){const r=sf(t,!0).put({[MT]:e,value:n});return new Pc(r).toPromise()}async function UM(t,e){const n=sf(t,!1).get(e),r=await new Pc(n).toPromise();return r===void 0?null:r.value}function l_(t,e){const n=sf(t,!0).delete(e);return new Pc(n).toPromise()}const BM=800,VM=3;class LT{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Jg(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>VM)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return OT()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=rf._getInstance(FM()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await MM(),!this.activeServiceWorker)return;this.sender=new OM(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||LM()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Jg();return await o_(e,Ud,"1"),await l_(e,Ud),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>o_(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>UM(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>l_(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=sf(i,!1).getAll();return new Pc(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),BM)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}LT.type="LOCAL";const HM=LT;new Cc(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FT(t,e){return e?Hr(e):(te(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pv extends IT{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ma(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Ma(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Ma(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function WM(t){return bM(t.auth,new pv(t),t.bypassAuthState)}function qM(t){const{auth:e,user:n}=t;return te(n,e,"internal-error"),kM(n,new pv(t),t.bypassAuthState)}async function GM(t){const{auth:e,user:n}=t;return te(n,e,"internal-error"),SM(n,new pv(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $T{constructor(e,n,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:i,tenantId:s,error:a,type:o}=e;if(a){this.reject(a);return}const l={auth:this.auth,requestUri:n,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(l))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return WM;case"linkViaPopup":case"linkViaRedirect":return GM;case"reauthViaPopup":case"reauthViaRedirect":return qM;default:Ir(this.auth,"internal-error")}}resolve(e){ti(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ti(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KM=new Cc(2e3,1e4);async function QM(t,e,n){const r=nf(t);BD(t,e,fv);const i=FT(r,n);return new xs(r,"signInViaPopup",e,i).executeNotNull()}class xs extends $T{constructor(e,n,r,i,s){super(e,n,i,s),this.provider=r,this.authWindow=null,this.pollId=null,xs.currentPopupAction&&xs.currentPopupAction.cancel(),xs.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return te(e,this.auth,"internal-error"),e}async onExecution(){ti(this.filter.length===1,"Popup operations only handle one event");const e=mv();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Er(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Er(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,xs.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Er(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,KM.get())};e()}}xs.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XM="pendingRedirect",Ju=new Map;class YM extends $T{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Ju.get(this.auth._key());if(!e){try{const r=await JM(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Ju.set(this.auth._key(),e)}return this.bypassAuthState||Ju.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function JM(t,e){const n=tL(e),r=eL(t);if(!await r._isAvailable())return!1;const i=await r._get(n)==="true";return await r._remove(n),i}function ZM(t,e){Ju.set(t._key(),e)}function eL(t){return Hr(t._redirectPersistence)}function tL(t){return Yu(XM,t.config.apiKey,t.name)}async function nL(t,e,n=!1){const r=nf(t),i=FT(r,e),a=await new YM(r,i,n).execute();return a&&!n&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rL=10*60*1e3;class iL{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!sL(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!zT(e)){const i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(Er(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=rL&&this.cachedEventUids.clear(),this.cachedEventUids.has(c_(e))}saveEventToCache(e){this.cachedEventUids.add(c_(e)),this.lastProcessedEventTime=Date.now()}}function c_(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function zT({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function sL(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return zT(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aL(t,e={}){return Ac(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oL=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,lL=/^https?/;async function cL(t){if(t.config.emulator)return;const{authorizedDomains:e}=await aL(t);for(const n of e)try{if(uL(n))return}catch{}Ir(t,"unauthorized-domain")}function uL(t){const e=Yg(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&a.hostname===r}if(!lL.test(n))return!1;if(oL.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dL=new Cc(3e4,6e4);function u_(){const t=Sr().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function hL(t){return new Promise((e,n)=>{var r,i,s;function a(){u_(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{u_(),n(Er(t,"network-request-failed"))},timeout:dL.get()})}if(!((i=(r=Sr().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=Sr().gapi)===null||s===void 0)&&s.load)a();else{const o=gM("iframefcb");return Sr()[o]=()=>{gapi.load?a():n(Er(t,"network-request-failed"))},pM(`https://apis.google.com/js/api.js?onload=${o}`).catch(l=>n(l))}}).catch(e=>{throw Zu=null,e})}let Zu=null;function fL(t){return Zu=Zu||hL(t),Zu}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mL=new Cc(5e3,15e3),pL="__/auth/iframe",gL="emulator/auth/iframe",yL={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},vL=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function xL(t){const e=t.config;te(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?uv(e,gL):`https://${t.config.authDomain}/${pL}`,r={apiKey:e.apiKey,appName:t.name,v:Zs},i=vL.get(t.config.apiHost);i&&(r.eid=i);const s=t._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${Ic(r).slice(1)}`}async function wL(t){const e=await fL(t),n=Sr().gapi;return te(n,t,"internal-error"),e.open({where:document.body,url:xL(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:yL,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const a=Er(t,"network-request-failed"),o=Sr().setTimeout(()=>{s(a)},mL.get());function l(){Sr().clearTimeout(o),i(r)}r.ping(l).then(l,()=>{s(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _L={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},EL=500,SL=600,kL="_blank",bL="http://localhost";class d_{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function TL(t,e,n,r=EL,i=SL){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let o="";const l=Object.assign(Object.assign({},_L),{width:r.toString(),height:i.toString(),top:s,left:a}),u=zt().toLowerCase();n&&(o=xT(u)?kL:n),vT(u)&&(e=e||bL,l.scrollbars="yes");const d=Object.entries(l).reduce((m,[p,g])=>`${m}${p}=${g},`,"");if(aM(u)&&o!=="_self")return IL(e||"",o),new d_(null);const h=window.open(e||"",o,d);te(h,t,"popup-blocked");try{h.focus()}catch{}return new d_(h)}function IL(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CL="__/auth/handler",AL="emulator/auth/handler",RL=encodeURIComponent("fac");async function h_(t,e,n,r,i,s){te(t.config.authDomain,t,"auth-domain-config-required"),te(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Zs,eventId:i};if(e instanceof fv){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",PO(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,h]of Object.entries(s||{}))a[d]=h}if(e instanceof Rc){const d=e.getScopes().filter(h=>h!=="");d.length>0&&(a.scopes=d.join(","))}t.tenantId&&(a.tid=t.tenantId);const o=a;for(const d of Object.keys(o))o[d]===void 0&&delete o[d];const l=await t._getAppCheckToken(),u=l?`#${RL}=${encodeURIComponent(l)}`:"";return`${PL(t)}?${Ic(o).slice(1)}${u}`}function PL({config:t}){return t.emulator?uv(t,AL):`https://${t.authDomain}/${CL}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ep="webStorageSupport";class NL{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=jT,this._completeRedirectFn=nL,this._overrideRedirectResult=ZM}async _openPopup(e,n,r,i){var s;ti((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const a=await h_(e,n,r,Yg(),i);return TL(e,a,mv())}async _openRedirect(e,n,r,i){await this._originValidation(e);const s=await h_(e,n,r,Yg(),i);return DM(s),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:s}=this.eventManagers[n];return i?Promise.resolve(i):(ti(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await wL(e),r=new iL(e);return n.register("authEvent",i=>(te(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(ep,{type:ep},i=>{var s;const a=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[ep];a!==void 0&&n(!!a),Ir(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=cL(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return kT()||hv()||tf()}}const jL=NL;var f_="@firebase/auth",m_="1.3.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OL{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){te(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DL(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}function ML(t){Ds(new Wi("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=r.options;te(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:a,authDomain:o,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:bT(t)},u=new fM(r,i,s,l);return vM(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Ds(new Wi("auth-internal",e=>{const n=nf(e.getProvider("auth").getImmediate());return(r=>new OL(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),_r(f_,m_,DL(t)),_r(f_,m_,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LL=5*60,FL=nT("authIdTokenMaxAge")||LL;let p_=null;const $L=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>FL)return;const i=n==null?void 0:n.token;p_!==i&&(p_=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function zL(t=ov()){const e=ef(t,"auth");if(e.isInitialized())return e.getImmediate();const n=yM(t,{popupRedirectResolver:jL,persistence:[HM,NM,jT]}),r=nT("authTokenSyncURL");if(r){const s=$L(r);IM(n,s,()=>s(n.currentUser)),TM(n,a=>s(a))}const i=Zb("auth");return i&&xM(n,`http://${i}`),n}ML("Browser");var UL="firebase",BL="10.3.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */_r(UL,BL,"app");var VL=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},M,gv=gv||{},Z=VL||self;function af(t){var e=typeof t;return e=e!="object"?e:t?Array.isArray(t)?"array":e:"null",e=="array"||e=="object"&&typeof t.length=="number"}function Nc(t){var e=typeof t;return e=="object"&&t!=null||e=="function"}function HL(t){return Object.prototype.hasOwnProperty.call(t,tp)&&t[tp]||(t[tp]=++WL)}var tp="closure_uid_"+(1e9*Math.random()>>>0),WL=0;function qL(t,e,n){return t.call.apply(t.bind,arguments)}function GL(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),t.apply(e,i)}}return function(){return t.apply(e,arguments)}}function Mt(t,e,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?Mt=qL:Mt=GL,Mt.apply(null,arguments)}function mu(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),t.apply(this,r)}}function gt(t,e){function n(){}n.prototype=e.prototype,t.$=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ac=function(r,i,s){for(var a=Array(arguments.length-2),o=2;o<arguments.length;o++)a[o-2]=arguments[o];return e.prototype[i].apply(r,a)}}function is(){this.s=this.s,this.o=this.o}var KL=0;is.prototype.s=!1;is.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),KL!=0)&&HL(this)};is.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const UT=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(typeof t=="string")return typeof e!="string"||e.length!=1?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function yv(t){const e=t.length;if(0<e){const n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function g_(t,e){for(let n=1;n<arguments.length;n++){const r=arguments[n];if(af(r)){const i=t.length||0,s=r.length||0;t.length=i+s;for(let a=0;a<s;a++)t[i+a]=r[a]}else t.push(r)}}function Lt(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}Lt.prototype.h=function(){this.defaultPrevented=!0};var QL=function(){if(!Z.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{Z.addEventListener("test",()=>{},e),Z.removeEventListener("test",()=>{},e)}catch{}return t}();function Yl(t){return/^[\s\xa0]*$/.test(t)}function of(){var t=Z.navigator;return t&&(t=t.userAgent)?t:""}function fr(t){return of().indexOf(t)!=-1}function vv(t){return vv[" "](t),t}vv[" "]=function(){};function XL(t,e){var n=BF;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}var YL=fr("Opera"),no=fr("Trident")||fr("MSIE"),BT=fr("Edge"),Zg=BT||no,VT=fr("Gecko")&&!(of().toLowerCase().indexOf("webkit")!=-1&&!fr("Edge"))&&!(fr("Trident")||fr("MSIE"))&&!fr("Edge"),JL=of().toLowerCase().indexOf("webkit")!=-1&&!fr("Edge");function HT(){var t=Z.document;return t?t.documentMode:void 0}var e0;e:{var np="",rp=function(){var t=of();if(VT)return/rv:([^\);]+)(\)|;)/.exec(t);if(BT)return/Edge\/([\d\.]+)/.exec(t);if(no)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t);if(JL)return/WebKit\/(\S+)/.exec(t);if(YL)return/(?:Version)[ \/]?(\S+)/.exec(t)}();if(rp&&(np=rp?rp[1]:""),no){var ip=HT();if(ip!=null&&ip>parseFloat(np)){e0=String(ip);break e}}e0=np}var t0;if(Z.document&&no){var y_=HT();t0=y_||parseInt(e0,10)||void 0}else t0=void 0;var ZL=t0;function Jl(t,e){if(Lt.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(VT){e:{try{vv(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else n=="mouseover"?e=t.fromElement:n=="mouseout"&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=t.clientX!==void 0?t.clientX:t.pageX,this.clientY=t.clientY!==void 0?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=typeof t.pointerType=="string"?t.pointerType:eF[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&Jl.$.h.call(this)}}gt(Jl,Lt);var eF={2:"touch",3:"pen",4:"mouse"};Jl.prototype.h=function(){Jl.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var jc="closure_listenable_"+(1e6*Math.random()|0),tF=0;function nF(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.la=i,this.key=++tF,this.fa=this.ia=!1}function lf(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function xv(t,e,n){for(const r in t)e.call(n,t[r],r,t)}function rF(t,e){for(const n in t)e.call(void 0,t[n],n,t)}function WT(t){const e={};for(const n in t)e[n]=t[n];return e}const v_="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function qT(t,e){let n,r;for(let i=1;i<arguments.length;i++){r=arguments[i];for(n in r)t[n]=r[n];for(let s=0;s<v_.length;s++)n=v_[s],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function cf(t){this.src=t,this.g={},this.h=0}cf.prototype.add=function(t,e,n,r,i){var s=t.toString();t=this.g[s],t||(t=this.g[s]=[],this.h++);var a=r0(t,e,r,i);return-1<a?(e=t[a],n||(e.ia=!1)):(e=new nF(e,this.src,s,!!r,i),e.ia=n,t.push(e)),e};function n0(t,e){var n=e.type;if(n in t.g){var r=t.g[n],i=UT(r,e),s;(s=0<=i)&&Array.prototype.splice.call(r,i,1),s&&(lf(e),t.g[n].length==0&&(delete t.g[n],t.h--))}}function r0(t,e,n,r){for(var i=0;i<t.length;++i){var s=t[i];if(!s.fa&&s.listener==e&&s.capture==!!n&&s.la==r)return i}return-1}var wv="closure_lm_"+(1e6*Math.random()|0),sp={};function GT(t,e,n,r,i){if(r&&r.once)return QT(t,e,n,r,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)GT(t,e[s],n,r,i);return null}return n=Sv(n),t&&t[jc]?t.O(e,n,Nc(r)?!!r.capture:!!r,i):KT(t,e,n,!1,r,i)}function KT(t,e,n,r,i,s){if(!e)throw Error("Invalid event type");var a=Nc(i)?!!i.capture:!!i,o=Ev(t);if(o||(t[wv]=o=new cf(t)),n=o.add(e,n,r,a,s),n.proxy)return n;if(r=iF(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)QL||(i=a),i===void 0&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(YT(e.toString()),r);else if(t.addListener&&t.removeListener)t.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return n}function iF(){function t(n){return e.call(t.src,t.listener,n)}const e=sF;return t}function QT(t,e,n,r,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)QT(t,e[s],n,r,i);return null}return n=Sv(n),t&&t[jc]?t.P(e,n,Nc(r)?!!r.capture:!!r,i):KT(t,e,n,!0,r,i)}function XT(t,e,n,r,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)XT(t,e[s],n,r,i);else r=Nc(r)?!!r.capture:!!r,n=Sv(n),t&&t[jc]?(t=t.i,e=String(e).toString(),e in t.g&&(s=t.g[e],n=r0(s,n,r,i),-1<n&&(lf(s[n]),Array.prototype.splice.call(s,n,1),s.length==0&&(delete t.g[e],t.h--)))):t&&(t=Ev(t))&&(e=t.g[e.toString()],t=-1,e&&(t=r0(e,n,r,i)),(n=-1<t?e[t]:null)&&_v(n))}function _v(t){if(typeof t!="number"&&t&&!t.fa){var e=t.src;if(e&&e[jc])n0(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(YT(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Ev(e))?(n0(n,t),n.h==0&&(n.src=null,e[wv]=null)):lf(t)}}}function YT(t){return t in sp?sp[t]:sp[t]="on"+t}function sF(t,e){if(t.fa)t=!0;else{e=new Jl(e,this);var n=t.listener,r=t.la||t.src;t.ia&&_v(t),t=n.call(r,e)}return t}function Ev(t){return t=t[wv],t instanceof cf?t:null}var ap="__closure_events_fn_"+(1e9*Math.random()>>>0);function Sv(t){return typeof t=="function"?t:(t[ap]||(t[ap]=function(e){return t.handleEvent(e)}),t[ap])}function pt(){is.call(this),this.i=new cf(this),this.S=this,this.J=null}gt(pt,is);pt.prototype[jc]=!0;pt.prototype.removeEventListener=function(t,e,n,r){XT(this,t,e,n,r)};function bt(t,e){var n,r=t.J;if(r)for(n=[];r;r=r.J)n.push(r);if(t=t.S,r=e.type||e,typeof e=="string")e=new Lt(e,t);else if(e instanceof Lt)e.target=e.target||t;else{var i=e;e=new Lt(r,t),qT(e,i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var a=e.g=n[s];i=pu(a,r,!0,e)&&i}if(a=e.g=t,i=pu(a,r,!0,e)&&i,i=pu(a,r,!1,e)&&i,n)for(s=0;s<n.length;s++)a=e.g=n[s],i=pu(a,r,!1,e)&&i}pt.prototype.N=function(){if(pt.$.N.call(this),this.i){var t=this.i,e;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)lf(n[r]);delete t.g[e],t.h--}}this.J=null};pt.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)};pt.prototype.P=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};function pu(t,e,n,r){if(e=t.i.g[String(e)],!e)return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var a=e[s];if(a&&!a.fa&&a.capture==n){var o=a.listener,l=a.la||a.src;a.ia&&n0(t.i,a),i=o.call(l,r)!==!1&&i}}return i&&!r.defaultPrevented}var kv=Z.JSON.stringify;class aF{constructor(e,n){this.i=e,this.j=n,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}function oF(){var t=bv;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}class lF{constructor(){this.h=this.g=null}add(e,n){const r=JT.get();r.set(e,n),this.h?this.h.next=r:this.g=r,this.h=r}}var JT=new aF(()=>new cF,t=>t.reset());class cF{constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}}function uF(t){var e=1;t=t.split(":");const n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function dF(t){Z.setTimeout(()=>{throw t},0)}let Zl,ec=!1,bv=new lF,ZT=()=>{const t=Z.Promise.resolve(void 0);Zl=()=>{t.then(hF)}};var hF=()=>{for(var t;t=oF();){try{t.h.call(t.g)}catch(n){dF(n)}var e=JT;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}ec=!1};function uf(t,e){pt.call(this),this.h=t||1,this.g=e||Z,this.j=Mt(this.qb,this),this.l=Date.now()}gt(uf,pt);M=uf.prototype;M.ga=!1;M.T=null;M.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),bt(this,"tick"),this.ga&&(Tv(this),this.start()))}};M.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function Tv(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}M.N=function(){uf.$.N.call(this),Tv(this),delete this.g};function Iv(t,e,n){if(typeof t=="function")n&&(t=Mt(t,n));else if(t&&typeof t.handleEvent=="function")t=Mt(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:Z.setTimeout(t,e||0)}function eI(t){t.g=Iv(()=>{t.g=null,t.i&&(t.i=!1,eI(t))},t.j);const e=t.h;t.h=null,t.m.apply(null,e)}class fF extends is{constructor(e,n){super(),this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:eI(this)}N(){super.N(),this.g&&(Z.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function tc(t){is.call(this),this.h=t,this.g={}}gt(tc,is);var x_=[];function tI(t,e,n,r){Array.isArray(n)||(n&&(x_[0]=n.toString()),n=x_);for(var i=0;i<n.length;i++){var s=GT(e,n[i],r||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}}function nI(t){xv(t.g,function(e,n){this.g.hasOwnProperty(n)&&_v(e)},t),t.g={}}tc.prototype.N=function(){tc.$.N.call(this),nI(this)};tc.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function df(){this.g=!0}df.prototype.Ea=function(){this.g=!1};function mF(t,e,n,r,i,s){t.info(function(){if(t.g)if(s)for(var a="",o=s.split("&"),l=0;l<o.length;l++){var u=o[l].split("=");if(1<u.length){var d=u[0];u=u[1];var h=d.split("_");a=2<=h.length&&h[1]=="type"?a+(d+"="+u+"&"):a+(d+"=redacted&")}}else a=null;else a=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+`
`+n+`
`+a})}function pF(t,e,n,r,i,s,a){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+`
`+n+`
`+s+" "+a})}function Ta(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+yF(t,n)+(r?" "+r:"")})}function gF(t,e){t.info(function(){return"TIMEOUT: "+e})}df.prototype.info=function(){};function yF(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n){for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if(s!="noop"&&s!="stop"&&s!="close")for(var a=1;a<i.length;a++)i[a]=""}}}}return kv(n)}catch{return e}}var ea={},w_=null;function hf(){return w_=w_||new pt}ea.Ta="serverreachability";function rI(t){Lt.call(this,ea.Ta,t)}gt(rI,Lt);function nc(t){const e=hf();bt(e,new rI(e))}ea.STAT_EVENT="statevent";function iI(t,e){Lt.call(this,ea.STAT_EVENT,t),this.stat=e}gt(iI,Lt);function qt(t){const e=hf();bt(e,new iI(e,t))}ea.Ua="timingevent";function sI(t,e){Lt.call(this,ea.Ua,t),this.size=e}gt(sI,Lt);function Oc(t,e){if(typeof t!="function")throw Error("Fn must not be null and must be a function");return Z.setTimeout(function(){t()},e)}var ff={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},aI={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function Cv(){}Cv.prototype.h=null;function __(t){return t.h||(t.h=t.i())}function oI(){}var Dc={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function Av(){Lt.call(this,"d")}gt(Av,Lt);function Rv(){Lt.call(this,"c")}gt(Rv,Lt);var i0;function mf(){}gt(mf,Cv);mf.prototype.g=function(){return new XMLHttpRequest};mf.prototype.i=function(){return{}};i0=new mf;function Mc(t,e,n,r){this.l=t,this.j=e,this.m=n,this.W=r||1,this.U=new tc(this),this.P=vF,t=Zg?125:void 0,this.V=new uf(t),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new lI}function lI(){this.i=null,this.g="",this.h=!1}var vF=45e3,s0={},Vd={};M=Mc.prototype;M.setTimeout=function(t){this.P=t};function a0(t,e,n){t.L=1,t.v=gf(ni(e)),t.s=n,t.S=!0,cI(t,null)}function cI(t,e){t.G=Date.now(),Lc(t),t.A=ni(t.v);var n=t.A,r=t.W;Array.isArray(r)||(r=[String(r)]),yI(n.i,"t",r),t.C=0,n=t.l.J,t.h=new lI,t.g=FI(t.l,n?e:null,!t.s),0<t.O&&(t.M=new fF(Mt(t.Pa,t,t.g),t.O)),tI(t.U,t.g,"readystatechange",t.nb),e=t.I?WT(t.I):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.A,t.u,t.s,e)):(t.u="GET",t.g.ha(t.A,t.u,null,e)),nc(),mF(t.j,t.u,t.A,t.m,t.W,t.s)}M.nb=function(t){t=t.target;const e=this.M;e&&pr(t)==3?e.l():this.Pa(t)};M.Pa=function(t){try{if(t==this.g)e:{const d=pr(this.g);var e=this.g.Ia();const h=this.g.da();if(!(3>d)&&(d!=3||Zg||this.g&&(this.h.h||this.g.ja()||b_(this.g)))){this.J||d!=4||e==7||(e==8||0>=h?nc(3):nc(2)),pf(this);var n=this.g.da();this.ca=n;t:if(uI(this)){var r=b_(this.g);t="";var i=r.length,s=pr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){ws(this),_l(this);var a="";break t}this.h.i=new Z.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,t+=this.h.i.decode(r[e],{stream:s&&e==i-1});r.splice(0,i),this.h.g+=t,this.C=0,a=this.h.g}else a=this.g.ja();if(this.i=n==200,pF(this.j,this.u,this.A,this.m,this.W,d,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var o,l=this.g;if((o=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Yl(o)){var u=o;break t}}u=null}if(n=u)Ta(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,o0(this,n);else{this.i=!1,this.o=3,qt(12),ws(this),_l(this);break e}}this.S?(dI(this,d,a),Zg&&this.i&&d==3&&(tI(this.U,this.V,"tick",this.mb),this.V.start())):(Ta(this.j,this.m,a,null),o0(this,a)),d==4&&ws(this),this.i&&!this.J&&(d==4?OI(this.l,this):(this.i=!1,Lc(this)))}else $F(this.g),n==400&&0<a.indexOf("Unknown SID")?(this.o=3,qt(12)):(this.o=0,qt(13)),ws(this),_l(this)}}}catch{}finally{}};function uI(t){return t.g?t.u=="GET"&&t.L!=2&&t.l.Ha:!1}function dI(t,e,n){let r=!0,i;for(;!t.J&&t.C<n.length;)if(i=xF(t,n),i==Vd){e==4&&(t.o=4,qt(14),r=!1),Ta(t.j,t.m,null,"[Incomplete Response]");break}else if(i==s0){t.o=4,qt(15),Ta(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}else Ta(t.j,t.m,i,null),o0(t,i);uI(t)&&i!=Vd&&i!=s0&&(t.h.g="",t.C=0),e!=4||n.length!=0||t.h.h||(t.o=1,qt(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.ba&&(t.ba=!0,e=t.l,e.g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),Mv(e),e.M=!0,qt(11))):(Ta(t.j,t.m,n,"[Invalid Chunked Response]"),ws(t),_l(t))}M.mb=function(){if(this.g){var t=pr(this.g),e=this.g.ja();this.C<e.length&&(pf(this),dI(this,t,e),this.i&&t!=4&&Lc(this))}};function xF(t,e){var n=t.C,r=e.indexOf(`
`,n);return r==-1?Vd:(n=Number(e.substring(n,r)),isNaN(n)?s0:(r+=1,r+n>e.length?Vd:(e=e.slice(r,r+n),t.C=r+n,e)))}M.cancel=function(){this.J=!0,ws(this)};function Lc(t){t.Y=Date.now()+t.P,hI(t,t.P)}function hI(t,e){if(t.B!=null)throw Error("WatchDog timer not null");t.B=Oc(Mt(t.lb,t),e)}function pf(t){t.B&&(Z.clearTimeout(t.B),t.B=null)}M.lb=function(){this.B=null;const t=Date.now();0<=t-this.Y?(gF(this.j,this.A),this.L!=2&&(nc(),qt(17)),ws(this),this.o=2,_l(this)):hI(this,this.Y-t)};function _l(t){t.l.H==0||t.J||OI(t.l,t)}function ws(t){pf(t);var e=t.M;e&&typeof e.sa=="function"&&e.sa(),t.M=null,Tv(t.V),nI(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function o0(t,e){try{var n=t.l;if(n.H!=0&&(n.g==t||l0(n.i,t))){if(!t.K&&l0(n.i,t)&&n.H==3){try{var r=n.Ja.g.parse(e)}catch{r=null}if(Array.isArray(r)&&r.length==3){var i=r;if(i[0]==0){e:if(!n.u){if(n.g)if(n.g.G+3e3<t.G)qd(n),wf(n);else break e;Dv(n),qt(18)}}else n.Fa=i[1],0<n.Fa-n.V&&37500>i[2]&&n.G&&n.A==0&&!n.v&&(n.v=Oc(Mt(n.ib,n),6e3));if(1>=wI(n.i)&&n.oa){try{n.oa()}catch{}n.oa=void 0}}else _s(n,11)}else if((t.K||n.g==t)&&qd(n),!Yl(e))for(i=n.Ja.g.parse(e),e=0;e<i.length;e++){let u=i[e];if(n.V=u[0],u=u[1],n.H==2)if(u[0]=="c"){n.K=u[1],n.pa=u[2];const d=u[3];d!=null&&(n.ra=d,n.l.info("VER="+n.ra));const h=u[4];h!=null&&(n.Ga=h,n.l.info("SVER="+n.Ga));const m=u[5];m!=null&&typeof m=="number"&&0<m&&(r=1.5*m,n.L=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;const p=t.g;if(p){const g=p.g?p.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(g){var s=r.i;s.g||g.indexOf("spdy")==-1&&g.indexOf("quic")==-1&&g.indexOf("h2")==-1||(s.j=s.l,s.g=new Set,s.h&&(Pv(s,s.h),s.h=null))}if(r.F){const w=p.g?p.g.getResponseHeader("X-HTTP-Session-Id"):null;w&&(r.Da=w,Ie(r.I,r.F,w))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-t.G,n.l.info("Handshake RTT: "+n.S+"ms")),r=n;var a=t;if(r.wa=LI(r,r.J?r.pa:null,r.Y),a.K){_I(r.i,a);var o=a,l=r.L;l&&o.setTimeout(l),o.B&&(pf(o),Lc(o)),r.g=a}else NI(r);0<n.j.length&&_f(n)}else u[0]!="stop"&&u[0]!="close"||_s(n,7);else n.H==3&&(u[0]=="stop"||u[0]=="close"?u[0]=="stop"?_s(n,7):Ov(n):u[0]!="noop"&&n.h&&n.h.Aa(u),n.A=0)}}nc(4)}catch{}}function wF(t){if(t.Z&&typeof t.Z=="function")return t.Z();if(typeof Map<"u"&&t instanceof Map||typeof Set<"u"&&t instanceof Set)return Array.from(t.values());if(typeof t=="string")return t.split("");if(af(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}e=[],n=0;for(r in t)e[n++]=t[r];return e}function _F(t){if(t.ta&&typeof t.ta=="function")return t.ta();if(!t.Z||typeof t.Z!="function"){if(typeof Map<"u"&&t instanceof Map)return Array.from(t.keys());if(!(typeof Set<"u"&&t instanceof Set)){if(af(t)||typeof t=="string"){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(const r in t)e[n++]=r;return e}}}function fI(t,e){if(t.forEach&&typeof t.forEach=="function")t.forEach(e,void 0);else if(af(t)||typeof t=="string")Array.prototype.forEach.call(t,e,void 0);else for(var n=_F(t),r=wF(t),i=r.length,s=0;s<i;s++)e.call(void 0,r[s],n&&n[s],t)}var mI=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function EF(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var s=t[n].substring(0,r);i=t[n].substring(r+1)}else s=t[n];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function Ts(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof Ts){this.h=t.h,Hd(this,t.j),this.s=t.s,this.g=t.g,Wd(this,t.m),this.l=t.l;var e=t.i,n=new rc;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),E_(this,n),this.o=t.o}else t&&(e=String(t).match(mI))?(this.h=!1,Hd(this,e[1]||"",!0),this.s=sl(e[2]||""),this.g=sl(e[3]||"",!0),Wd(this,e[4]),this.l=sl(e[5]||"",!0),E_(this,e[6]||"",!0),this.o=sl(e[7]||"")):(this.h=!1,this.i=new rc(null,this.h))}Ts.prototype.toString=function(){var t=[],e=this.j;e&&t.push(al(e,S_,!0),":");var n=this.g;return(n||e=="file")&&(t.push("//"),(e=this.s)&&t.push(al(e,S_,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&t.push(":",String(n))),(n=this.l)&&(this.g&&n.charAt(0)!="/"&&t.push("/"),t.push(al(n,n.charAt(0)=="/"?bF:kF,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",al(n,IF)),t.join("")};function ni(t){return new Ts(t)}function Hd(t,e,n){t.j=n?sl(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function Wd(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function E_(t,e,n){e instanceof rc?(t.i=e,CF(t.i,t.h)):(n||(e=al(e,TF)),t.i=new rc(e,t.h))}function Ie(t,e,n){t.i.set(e,n)}function gf(t){return Ie(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function sl(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function al(t,e,n){return typeof t=="string"?(t=encodeURI(t).replace(e,SF),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function SF(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(t&15).toString(16)}var S_=/[#\/\?@]/g,kF=/[#\?:]/g,bF=/[#\?]/g,TF=/[#\?@]/g,IF=/#/g;function rc(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function ss(t){t.g||(t.g=new Map,t.h=0,t.i&&EF(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}M=rc.prototype;M.add=function(t,e){ss(this),this.i=null,t=Io(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this};function pI(t,e){ss(t),e=Io(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function gI(t,e){return ss(t),e=Io(t,e),t.g.has(e)}M.forEach=function(t,e){ss(this),this.g.forEach(function(n,r){n.forEach(function(i){t.call(e,i,r,this)},this)},this)};M.ta=function(){ss(this);const t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let r=0;r<e.length;r++){const i=t[r];for(let s=0;s<i.length;s++)n.push(e[r])}return n};M.Z=function(t){ss(this);let e=[];if(typeof t=="string")gI(this,t)&&(e=e.concat(this.g.get(Io(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e};M.set=function(t,e){return ss(this),this.i=null,t=Io(this,t),gI(this,t)&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this};M.get=function(t,e){return t?(t=this.Z(t),0<t.length?String(t[0]):e):e};function yI(t,e,n){pI(t,e),0<n.length&&(t.i=null,t.g.set(Io(t,e),yv(n)),t.h+=n.length)}M.toString=function(){if(this.i)return this.i;if(!this.g)return"";const t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var r=e[n];const s=encodeURIComponent(String(r)),a=this.Z(r);for(r=0;r<a.length;r++){var i=s;a[r]!==""&&(i+="="+encodeURIComponent(String(a[r]))),t.push(i)}}return this.i=t.join("&")};function Io(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function CF(t,e){e&&!t.j&&(ss(t),t.i=null,t.g.forEach(function(n,r){var i=r.toLowerCase();r!=i&&(pI(this,r),yI(this,i,n))},t)),t.j=e}var AF=class{constructor(t,e){this.g=t,this.map=e}};function vI(t){this.l=t||RF,Z.PerformanceNavigationTiming?(t=Z.performance.getEntriesByType("navigation"),t=0<t.length&&(t[0].nextHopProtocol=="hq"||t[0].nextHopProtocol=="h2")):t=!!(Z.g&&Z.g.Ka&&Z.g.Ka()&&Z.g.Ka().ec),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var RF=10;function xI(t){return t.h?!0:t.g?t.g.size>=t.j:!1}function wI(t){return t.h?1:t.g?t.g.size:0}function l0(t,e){return t.h?t.h==e:t.g?t.g.has(e):!1}function Pv(t,e){t.g?t.g.add(e):t.h=e}function _I(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}vI.prototype.cancel=function(){if(this.i=EI(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const t of this.g.values())t.cancel();this.g.clear()}};function EI(t){if(t.h!=null)return t.i.concat(t.h.F);if(t.g!=null&&t.g.size!==0){let e=t.i;for(const n of t.g.values())e=e.concat(n.F);return e}return yv(t.i)}var PF=class{stringify(t){return Z.JSON.stringify(t,void 0)}parse(t){return Z.JSON.parse(t,void 0)}};function NF(){this.g=new PF}function jF(t,e,n){const r=n||"";try{fI(t,function(i,s){let a=i;Nc(i)&&(a=kv(i)),e.push(r+s+"="+encodeURIComponent(a))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function OF(t,e){const n=new df;if(Z.Image){const r=new Image;r.onload=mu(gu,n,r,"TestLoadImage: loaded",!0,e),r.onerror=mu(gu,n,r,"TestLoadImage: error",!1,e),r.onabort=mu(gu,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=mu(gu,n,r,"TestLoadImage: timeout",!1,e),Z.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}function gu(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch{}}function yf(t){this.l=t.fc||null,this.j=t.ob||!1}gt(yf,Cv);yf.prototype.g=function(){return new vf(this.l,this.j)};yf.prototype.i=function(t){return function(){return t}}({});function vf(t,e){pt.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=Nv,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}gt(vf,pt);var Nv=0;M=vf.prototype;M.open=function(t,e){if(this.readyState!=Nv)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,ic(this)};M.send=function(t){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||Z).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))};M.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Fc(this)),this.readyState=Nv};M.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,ic(this)),this.g&&(this.readyState=3,ic(this),this.g)))if(this.responseType==="arraybuffer")t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof Z.ReadableStream<"u"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;SI(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))};function SI(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}M.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?Fc(this):ic(this),this.readyState==3&&SI(this)}};M.Za=function(t){this.g&&(this.response=this.responseText=t,Fc(this))};M.Ya=function(t){this.g&&(this.response=t,Fc(this))};M.ka=function(){this.g&&Fc(this)};function Fc(t){t.readyState=4,t.l=null,t.j=null,t.A=null,ic(t)}M.setRequestHeader=function(t,e){this.v.append(t,e)};M.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""};M.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join(`\r
`)};function ic(t){t.onreadystatechange&&t.onreadystatechange.call(t)}Object.defineProperty(vf.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(t){this.m=t?"include":"same-origin"}});var DF=Z.JSON.parse;function Be(t){pt.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=kI,this.L=this.M=!1}gt(Be,pt);var kI="",MF=/^https?$/i,LF=["POST","PUT"];M=Be.prototype;M.Oa=function(t){this.M=t};M.ha=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():i0.g(),this.C=this.u?__(this.u):__(i0),this.g.onreadystatechange=Mt(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(s){k_(this,s);return}if(t=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else if(typeof r.keys=="function"&&typeof r.get=="function")for(const s of r.keys())n.set(s,r.get(s));else throw Error("Unknown input type for opt_headers: "+String(r));r=Array.from(n.keys()).find(s=>s.toLowerCase()=="content-type"),i=Z.FormData&&t instanceof Z.FormData,!(0<=UT(LF,e))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[s,a]of n)this.g.setRequestHeader(s,a);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{II(this),0<this.B&&((this.L=FF(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Mt(this.ua,this)):this.A=Iv(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(s){k_(this,s)}};function FF(t){return no&&typeof t.timeout=="number"&&t.ontimeout!==void 0}M.ua=function(){typeof gv<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,bt(this,"timeout"),this.abort(8))};function k_(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,bI(t),xf(t)}function bI(t){t.F||(t.F=!0,bt(t,"complete"),bt(t,"error"))}M.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,bt(this,"complete"),bt(this,"abort"),xf(this))};M.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),xf(this,!0)),Be.$.N.call(this)};M.La=function(){this.s||(this.G||this.v||this.l?TI(this):this.kb())};M.kb=function(){TI(this)};function TI(t){if(t.h&&typeof gv<"u"&&(!t.C[1]||pr(t)!=4||t.da()!=2)){if(t.v&&pr(t)==4)Iv(t.La,0,t);else if(bt(t,"readystatechange"),pr(t)==4){t.h=!1;try{const a=t.da();e:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var r;if(r=a===0){var i=String(t.I).match(mI)[1]||null;!i&&Z.self&&Z.self.location&&(i=Z.self.location.protocol.slice(0,-1)),r=!MF.test(i?i.toLowerCase():"")}n=r}if(n)bt(t,"complete"),bt(t,"success");else{t.m=6;try{var s=2<pr(t)?t.g.statusText:""}catch{s=""}t.j=s+" ["+t.da()+"]",bI(t)}}finally{xf(t)}}}}function xf(t,e){if(t.g){II(t);const n=t.g,r=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||bt(t,"ready");try{n.onreadystatechange=r}catch{}}}function II(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(Z.clearTimeout(t.A),t.A=null)}M.isActive=function(){return!!this.g};function pr(t){return t.g?t.g.readyState:0}M.da=function(){try{return 2<pr(this)?this.g.status:-1}catch{return-1}};M.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};M.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&e.indexOf(t)==0&&(e=e.substring(t.length)),DF(e)}};function b_(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case kI:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}function $F(t){const e={};t=(t.g&&2<=pr(t)&&t.g.getAllResponseHeaders()||"").split(`\r
`);for(let r=0;r<t.length;r++){if(Yl(t[r]))continue;var n=uF(t[r]);const i=n[0];if(n=n[1],typeof n!="string")continue;n=n.trim();const s=e[i]||[];e[i]=s,s.push(n)}rF(e,function(r){return r.join(", ")})}M.Ia=function(){return this.m};M.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function CI(t){let e="";return xv(t,function(n,r){e+=r,e+=":",e+=n,e+=`\r
`}),e}function jv(t,e,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=CI(n),typeof t=="string"?n!=null&&encodeURIComponent(String(n)):Ie(t,e,n))}function qo(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function AI(t){this.Ga=0,this.j=[],this.l=new df,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=qo("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=qo("baseRetryDelayMs",5e3,t),this.hb=qo("retryDelaySeedMs",1e4,t),this.eb=qo("forwardChannelMaxRetries",2,t),this.xa=qo("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.dc||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new vI(t&&t.concurrentRequestLimit),this.Ja=new NF,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}M=AI.prototype;M.ra=8;M.H=1;function Ov(t){if(RI(t),t.H==3){var e=t.W++,n=ni(t.I);if(Ie(n,"SID",t.K),Ie(n,"RID",e),Ie(n,"TYPE","terminate"),$c(t,n),e=new Mc(t,t.l,e),e.L=2,e.v=gf(ni(n)),n=!1,Z.navigator&&Z.navigator.sendBeacon)try{n=Z.navigator.sendBeacon(e.v.toString(),"")}catch{}!n&&Z.Image&&(new Image().src=e.v,n=!0),n||(e.g=FI(e.l,null),e.g.ha(e.v)),e.G=Date.now(),Lc(e)}MI(t)}function wf(t){t.g&&(Mv(t),t.g.cancel(),t.g=null)}function RI(t){wf(t),t.u&&(Z.clearTimeout(t.u),t.u=null),qd(t),t.i.cancel(),t.m&&(typeof t.m=="number"&&Z.clearTimeout(t.m),t.m=null)}function _f(t){if(!xI(t.i)&&!t.m){t.m=!0;var e=t.Na;Zl||ZT(),ec||(Zl(),ec=!0),bv.add(e,t),t.C=0}}function zF(t,e){return wI(t.i)>=t.i.j-(t.m?1:0)?!1:t.m?(t.j=e.F.concat(t.j),!0):t.H==1||t.H==2||t.C>=(t.cb?0:t.eb)?!1:(t.m=Oc(Mt(t.Na,t,e),DI(t,t.C)),t.C++,!0)}M.Na=function(t){if(this.m)if(this.m=null,this.H==1){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;const i=new Mc(this,this.l,t);let s=this.s;if(this.U&&(s?(s=WT(s),qT(s,this.U)):s=this.U),this.o!==null||this.O||(i.I=s,s=null),this.P)e:{for(var e=0,n=0;n<this.j.length;n++){t:{var r=this.j[n];if("__data__"in r.map&&(r=r.map.__data__,typeof r=="string")){r=r.length;break t}r=void 0}if(r===void 0)break;if(e+=r,4096<e){e=n;break e}if(e===4096||n===this.j.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=PI(this,i,e),n=ni(this.I),Ie(n,"RID",t),Ie(n,"CVER",22),this.F&&Ie(n,"X-HTTP-Session-Id",this.F),$c(this,n),s&&(this.O?e="headers="+encodeURIComponent(String(CI(s)))+"&"+e:this.o&&jv(n,this.o,s)),Pv(this.i,i),this.bb&&Ie(n,"TYPE","init"),this.P?(Ie(n,"$req",e),Ie(n,"SID","null"),i.aa=!0,a0(i,n,null)):a0(i,n,e),this.H=2}}else this.H==3&&(t?T_(this,t):this.j.length==0||xI(this.i)||T_(this))};function T_(t,e){var n;e?n=e.m:n=t.W++;const r=ni(t.I);Ie(r,"SID",t.K),Ie(r,"RID",n),Ie(r,"AID",t.V),$c(t,r),t.o&&t.s&&jv(r,t.o,t.s),n=new Mc(t,t.l,n,t.C+1),t.o===null&&(n.I=t.s),e&&(t.j=e.F.concat(t.j)),e=PI(t,n,1e3),n.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),Pv(t.i,n),a0(n,r,e)}function $c(t,e){t.na&&xv(t.na,function(n,r){Ie(e,r,n)}),t.h&&fI({},function(n,r){Ie(e,r,n)})}function PI(t,e,n){n=Math.min(t.j.length,n);var r=t.h?Mt(t.h.Va,t.h,t):null;e:{var i=t.j;let s=-1;for(;;){const a=["count="+n];s==-1?0<n?(s=i[0].g,a.push("ofs="+s)):s=0:a.push("ofs="+s);let o=!0;for(let l=0;l<n;l++){let u=i[l].g;const d=i[l].map;if(u-=s,0>u)s=Math.max(0,i[l].g-100),o=!1;else try{jF(d,a,"req"+u+"_")}catch{r&&r(d)}}if(o){r=a.join("&");break e}}}return t=t.j.splice(0,n),e.F=t,r}function NI(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;Zl||ZT(),ec||(Zl(),ec=!0),bv.add(e,t),t.A=0}}function Dv(t){return t.g||t.u||3<=t.A?!1:(t.ba++,t.u=Oc(Mt(t.Ma,t),DI(t,t.A)),t.A++,!0)}M.Ma=function(){if(this.u=null,jI(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=Oc(Mt(this.jb,this),t)}};M.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,qt(10),wf(this),jI(this))};function Mv(t){t.B!=null&&(Z.clearTimeout(t.B),t.B=null)}function jI(t){t.g=new Mc(t,t.l,"rpc",t.ba),t.o===null&&(t.g.I=t.s),t.g.O=0;var e=ni(t.wa);Ie(e,"RID","rpc"),Ie(e,"SID",t.K),Ie(e,"AID",t.V),Ie(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&Ie(e,"TO",t.qa),Ie(e,"TYPE","xmlhttp"),$c(t,e),t.o&&t.s&&jv(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var n=t.g;t=t.pa,n.L=1,n.v=gf(ni(e)),n.s=null,n.S=!0,cI(n,t)}M.ib=function(){this.v!=null&&(this.v=null,wf(this),Dv(this),qt(19))};function qd(t){t.v!=null&&(Z.clearTimeout(t.v),t.v=null)}function OI(t,e){var n=null;if(t.g==e){qd(t),Mv(t),t.g=null;var r=2}else if(l0(t.i,e))n=e.F,_I(t.i,e),r=1;else return;if(t.H!=0){if(e.i)if(r==1){n=e.s?e.s.length:0,e=Date.now()-e.G;var i=t.C;r=hf(),bt(r,new sI(r,n)),_f(t)}else NI(t);else if(i=e.o,i==3||i==0&&0<e.ca||!(r==1&&zF(t,e)||r==2&&Dv(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),i){case 1:_s(t,5);break;case 4:_s(t,10);break;case 3:_s(t,6);break;default:_s(t,2)}}}function DI(t,e){let n=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(n*=2),n*e}function _s(t,e){if(t.l.info("Error code "+e),e==2){var n=null;t.h&&(n=null);var r=Mt(t.pb,t);n||(n=new Ts("//www.google.com/images/cleardot.gif"),Z.location&&Z.location.protocol=="http"||Hd(n,"https"),gf(n)),OF(n.toString(),r)}else qt(2);t.H=0,t.h&&t.h.za(e),MI(t),RI(t)}M.pb=function(t){t?(this.l.info("Successfully pinged google.com"),qt(2)):(this.l.info("Failed to ping google.com"),qt(1))};function MI(t){if(t.H=0,t.ma=[],t.h){const e=EI(t.i);(e.length!=0||t.j.length!=0)&&(g_(t.ma,e),g_(t.ma,t.j),t.i.i.length=0,yv(t.j),t.j.length=0),t.h.ya()}}function LI(t,e,n){var r=n instanceof Ts?ni(n):new Ts(n);if(r.g!="")e&&(r.g=e+"."+r.g),Wd(r,r.m);else{var i=Z.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var s=new Ts(null);r&&Hd(s,r),e&&(s.g=e),i&&Wd(s,i),n&&(s.l=n),r=s}return n=t.F,e=t.Da,n&&e&&Ie(r,n,e),Ie(r,"VER",t.ra),$c(t,r),r}function FI(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return e=n&&t.Ha&&!t.va?new Be(new yf({ob:!0})):new Be(t.va),e.Oa(t.J),e}M.isActive=function(){return!!this.h&&this.h.isActive(this)};function $I(){}M=$I.prototype;M.Ba=function(){};M.Aa=function(){};M.za=function(){};M.ya=function(){};M.isActive=function(){return!0};M.Va=function(){};function Gd(){if(no&&!(10<=Number(ZL)))throw Error("Environmental error: no available transport.")}Gd.prototype.g=function(t,e){return new Sn(t,e)};function Sn(t,e){pt.call(this),this.g=new AI(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!Yl(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Yl(e)&&(this.g.F=e,t=this.h,t!==null&&e in t&&(t=this.h,e in t&&delete t[e])),this.j=new Co(this)}gt(Sn,pt);Sn.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,n=this.h||void 0;qt(0),t.Y=e,t.na=n||{},t.G=t.aa,t.I=LI(t,null,t.Y),_f(t)};Sn.prototype.close=function(){Ov(this.g)};Sn.prototype.u=function(t){var e=this.g;if(typeof t=="string"){var n={};n.__data__=t,t=n}else this.v&&(n={},n.__data__=kv(t),t=n);e.j.push(new AF(e.fb++,t)),e.H==3&&_f(e)};Sn.prototype.N=function(){this.g.h=null,delete this.j,Ov(this.g),delete this.g,Sn.$.N.call(this)};function zI(t){Av.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){e:{for(const n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=e!==null&&t in e?e[t]:void 0),this.data=e}else this.data=t}gt(zI,Av);function UI(){Rv.call(this),this.status=1}gt(UI,Rv);function Co(t){this.g=t}gt(Co,$I);Co.prototype.Ba=function(){bt(this.g,"a")};Co.prototype.Aa=function(t){bt(this.g,new zI(t))};Co.prototype.za=function(t){bt(this.g,new UI)};Co.prototype.ya=function(){bt(this.g,"b")};function UF(){this.blockSize=-1}function nr(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}gt(nr,UF);nr.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function op(t,e,n){n||(n=0);var r=Array(16);if(typeof e=="string")for(var i=0;16>i;++i)r[i]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],i=t.g[2];var s=t.g[3],a=e+(s^n&(i^s))+r[0]+3614090360&4294967295;e=n+(a<<7&4294967295|a>>>25),a=s+(i^e&(n^i))+r[1]+3905402710&4294967295,s=e+(a<<12&4294967295|a>>>20),a=i+(n^s&(e^n))+r[2]+606105819&4294967295,i=s+(a<<17&4294967295|a>>>15),a=n+(e^i&(s^e))+r[3]+3250441966&4294967295,n=i+(a<<22&4294967295|a>>>10),a=e+(s^n&(i^s))+r[4]+4118548399&4294967295,e=n+(a<<7&4294967295|a>>>25),a=s+(i^e&(n^i))+r[5]+1200080426&4294967295,s=e+(a<<12&4294967295|a>>>20),a=i+(n^s&(e^n))+r[6]+2821735955&4294967295,i=s+(a<<17&4294967295|a>>>15),a=n+(e^i&(s^e))+r[7]+4249261313&4294967295,n=i+(a<<22&4294967295|a>>>10),a=e+(s^n&(i^s))+r[8]+1770035416&4294967295,e=n+(a<<7&4294967295|a>>>25),a=s+(i^e&(n^i))+r[9]+2336552879&4294967295,s=e+(a<<12&4294967295|a>>>20),a=i+(n^s&(e^n))+r[10]+4294925233&4294967295,i=s+(a<<17&4294967295|a>>>15),a=n+(e^i&(s^e))+r[11]+2304563134&4294967295,n=i+(a<<22&4294967295|a>>>10),a=e+(s^n&(i^s))+r[12]+1804603682&4294967295,e=n+(a<<7&4294967295|a>>>25),a=s+(i^e&(n^i))+r[13]+4254626195&4294967295,s=e+(a<<12&4294967295|a>>>20),a=i+(n^s&(e^n))+r[14]+2792965006&4294967295,i=s+(a<<17&4294967295|a>>>15),a=n+(e^i&(s^e))+r[15]+1236535329&4294967295,n=i+(a<<22&4294967295|a>>>10),a=e+(i^s&(n^i))+r[1]+4129170786&4294967295,e=n+(a<<5&4294967295|a>>>27),a=s+(n^i&(e^n))+r[6]+3225465664&4294967295,s=e+(a<<9&4294967295|a>>>23),a=i+(e^n&(s^e))+r[11]+643717713&4294967295,i=s+(a<<14&4294967295|a>>>18),a=n+(s^e&(i^s))+r[0]+3921069994&4294967295,n=i+(a<<20&4294967295|a>>>12),a=e+(i^s&(n^i))+r[5]+3593408605&4294967295,e=n+(a<<5&4294967295|a>>>27),a=s+(n^i&(e^n))+r[10]+38016083&4294967295,s=e+(a<<9&4294967295|a>>>23),a=i+(e^n&(s^e))+r[15]+3634488961&4294967295,i=s+(a<<14&4294967295|a>>>18),a=n+(s^e&(i^s))+r[4]+3889429448&4294967295,n=i+(a<<20&4294967295|a>>>12),a=e+(i^s&(n^i))+r[9]+568446438&4294967295,e=n+(a<<5&4294967295|a>>>27),a=s+(n^i&(e^n))+r[14]+3275163606&4294967295,s=e+(a<<9&4294967295|a>>>23),a=i+(e^n&(s^e))+r[3]+4107603335&4294967295,i=s+(a<<14&4294967295|a>>>18),a=n+(s^e&(i^s))+r[8]+1163531501&4294967295,n=i+(a<<20&4294967295|a>>>12),a=e+(i^s&(n^i))+r[13]+2850285829&4294967295,e=n+(a<<5&4294967295|a>>>27),a=s+(n^i&(e^n))+r[2]+4243563512&4294967295,s=e+(a<<9&4294967295|a>>>23),a=i+(e^n&(s^e))+r[7]+1735328473&4294967295,i=s+(a<<14&4294967295|a>>>18),a=n+(s^e&(i^s))+r[12]+2368359562&4294967295,n=i+(a<<20&4294967295|a>>>12),a=e+(n^i^s)+r[5]+4294588738&4294967295,e=n+(a<<4&4294967295|a>>>28),a=s+(e^n^i)+r[8]+2272392833&4294967295,s=e+(a<<11&4294967295|a>>>21),a=i+(s^e^n)+r[11]+1839030562&4294967295,i=s+(a<<16&4294967295|a>>>16),a=n+(i^s^e)+r[14]+4259657740&4294967295,n=i+(a<<23&4294967295|a>>>9),a=e+(n^i^s)+r[1]+2763975236&4294967295,e=n+(a<<4&4294967295|a>>>28),a=s+(e^n^i)+r[4]+1272893353&4294967295,s=e+(a<<11&4294967295|a>>>21),a=i+(s^e^n)+r[7]+4139469664&4294967295,i=s+(a<<16&4294967295|a>>>16),a=n+(i^s^e)+r[10]+3200236656&4294967295,n=i+(a<<23&4294967295|a>>>9),a=e+(n^i^s)+r[13]+681279174&4294967295,e=n+(a<<4&4294967295|a>>>28),a=s+(e^n^i)+r[0]+3936430074&4294967295,s=e+(a<<11&4294967295|a>>>21),a=i+(s^e^n)+r[3]+3572445317&4294967295,i=s+(a<<16&4294967295|a>>>16),a=n+(i^s^e)+r[6]+76029189&4294967295,n=i+(a<<23&4294967295|a>>>9),a=e+(n^i^s)+r[9]+3654602809&4294967295,e=n+(a<<4&4294967295|a>>>28),a=s+(e^n^i)+r[12]+3873151461&4294967295,s=e+(a<<11&4294967295|a>>>21),a=i+(s^e^n)+r[15]+530742520&4294967295,i=s+(a<<16&4294967295|a>>>16),a=n+(i^s^e)+r[2]+3299628645&4294967295,n=i+(a<<23&4294967295|a>>>9),a=e+(i^(n|~s))+r[0]+4096336452&4294967295,e=n+(a<<6&4294967295|a>>>26),a=s+(n^(e|~i))+r[7]+1126891415&4294967295,s=e+(a<<10&4294967295|a>>>22),a=i+(e^(s|~n))+r[14]+2878612391&4294967295,i=s+(a<<15&4294967295|a>>>17),a=n+(s^(i|~e))+r[5]+4237533241&4294967295,n=i+(a<<21&4294967295|a>>>11),a=e+(i^(n|~s))+r[12]+1700485571&4294967295,e=n+(a<<6&4294967295|a>>>26),a=s+(n^(e|~i))+r[3]+2399980690&4294967295,s=e+(a<<10&4294967295|a>>>22),a=i+(e^(s|~n))+r[10]+4293915773&4294967295,i=s+(a<<15&4294967295|a>>>17),a=n+(s^(i|~e))+r[1]+2240044497&4294967295,n=i+(a<<21&4294967295|a>>>11),a=e+(i^(n|~s))+r[8]+1873313359&4294967295,e=n+(a<<6&4294967295|a>>>26),a=s+(n^(e|~i))+r[15]+4264355552&4294967295,s=e+(a<<10&4294967295|a>>>22),a=i+(e^(s|~n))+r[6]+2734768916&4294967295,i=s+(a<<15&4294967295|a>>>17),a=n+(s^(i|~e))+r[13]+1309151649&4294967295,n=i+(a<<21&4294967295|a>>>11),a=e+(i^(n|~s))+r[4]+4149444226&4294967295,e=n+(a<<6&4294967295|a>>>26),a=s+(n^(e|~i))+r[11]+3174756917&4294967295,s=e+(a<<10&4294967295|a>>>22),a=i+(e^(s|~n))+r[2]+718787259&4294967295,i=s+(a<<15&4294967295|a>>>17),a=n+(s^(i|~e))+r[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(i+(a<<21&4294967295|a>>>11))&4294967295,t.g[2]=t.g[2]+i&4294967295,t.g[3]=t.g[3]+s&4294967295}nr.prototype.j=function(t,e){e===void 0&&(e=t.length);for(var n=e-this.blockSize,r=this.m,i=this.h,s=0;s<e;){if(i==0)for(;s<=n;)op(this,t,s),s+=this.blockSize;if(typeof t=="string"){for(;s<e;)if(r[i++]=t.charCodeAt(s++),i==this.blockSize){op(this,r),i=0;break}}else for(;s<e;)if(r[i++]=t[s++],i==this.blockSize){op(this,r),i=0;break}}this.h=i,this.i+=e};nr.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=n&255,n/=256;for(this.j(t),t=Array(16),e=n=0;4>e;++e)for(var r=0;32>r;r+=8)t[n++]=this.g[e]>>>r&255;return t};function xe(t,e){this.h=e;for(var n=[],r=!0,i=t.length-1;0<=i;i--){var s=t[i]|0;r&&s==e||(n[i]=s,r=!1)}this.g=n}var BF={};function Lv(t){return-128<=t&&128>t?XL(t,function(e){return new xe([e|0],0>e?-1:0)}):new xe([t|0],0>t?-1:0)}function gr(t){if(isNaN(t)||!isFinite(t))return La;if(0>t)return Et(gr(-t));for(var e=[],n=1,r=0;t>=n;r++)e[r]=t/n|0,n*=c0;return new xe(e,0)}function BI(t,e){if(t.length==0)throw Error("number format error: empty string");if(e=e||10,2>e||36<e)throw Error("radix out of range: "+e);if(t.charAt(0)=="-")return Et(BI(t.substring(1),e));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var n=gr(Math.pow(e,8)),r=La,i=0;i<t.length;i+=8){var s=Math.min(8,t.length-i),a=parseInt(t.substring(i,i+s),e);8>s?(s=gr(Math.pow(e,s)),r=r.R(s).add(gr(a))):(r=r.R(n),r=r.add(gr(a)))}return r}var c0=4294967296,La=Lv(0),u0=Lv(1),I_=Lv(16777216);M=xe.prototype;M.ea=function(){if(Nn(this))return-Et(this).ea();for(var t=0,e=1,n=0;n<this.g.length;n++){var r=this.D(n);t+=(0<=r?r:c0+r)*e,e*=c0}return t};M.toString=function(t){if(t=t||10,2>t||36<t)throw Error("radix out of range: "+t);if(Wr(this))return"0";if(Nn(this))return"-"+Et(this).toString(t);for(var e=gr(Math.pow(t,6)),n=this,r="";;){var i=Qd(n,e).g;n=Kd(n,i.R(e));var s=((0<n.g.length?n.g[0]:n.h)>>>0).toString(t);if(n=i,Wr(n))return s+r;for(;6>s.length;)s="0"+s;r=s+r}};M.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h};function Wr(t){if(t.h!=0)return!1;for(var e=0;e<t.g.length;e++)if(t.g[e]!=0)return!1;return!0}function Nn(t){return t.h==-1}M.X=function(t){return t=Kd(this,t),Nn(t)?-1:Wr(t)?0:1};function Et(t){for(var e=t.g.length,n=[],r=0;r<e;r++)n[r]=~t.g[r];return new xe(n,~t.h).add(u0)}M.abs=function(){return Nn(this)?Et(this):this};M.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0,i=0;i<=e;i++){var s=r+(this.D(i)&65535)+(t.D(i)&65535),a=(s>>>16)+(this.D(i)>>>16)+(t.D(i)>>>16);r=a>>>16,s&=65535,a&=65535,n[i]=a<<16|s}return new xe(n,n[n.length-1]&-2147483648?-1:0)};function Kd(t,e){return t.add(Et(e))}M.R=function(t){if(Wr(this)||Wr(t))return La;if(Nn(this))return Nn(t)?Et(this).R(Et(t)):Et(Et(this).R(t));if(Nn(t))return Et(this.R(Et(t)));if(0>this.X(I_)&&0>t.X(I_))return gr(this.ea()*t.ea());for(var e=this.g.length+t.g.length,n=[],r=0;r<2*e;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<t.g.length;i++){var s=this.D(r)>>>16,a=this.D(r)&65535,o=t.D(i)>>>16,l=t.D(i)&65535;n[2*r+2*i]+=a*l,yu(n,2*r+2*i),n[2*r+2*i+1]+=s*l,yu(n,2*r+2*i+1),n[2*r+2*i+1]+=a*o,yu(n,2*r+2*i+1),n[2*r+2*i+2]+=s*o,yu(n,2*r+2*i+2)}for(r=0;r<e;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=e;r<2*e;r++)n[r]=0;return new xe(n,0)};function yu(t,e){for(;(t[e]&65535)!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function Go(t,e){this.g=t,this.h=e}function Qd(t,e){if(Wr(e))throw Error("division by zero");if(Wr(t))return new Go(La,La);if(Nn(t))return e=Qd(Et(t),e),new Go(Et(e.g),Et(e.h));if(Nn(e))return e=Qd(t,Et(e)),new Go(Et(e.g),e.h);if(30<t.g.length){if(Nn(t)||Nn(e))throw Error("slowDivide_ only works with positive integers.");for(var n=u0,r=e;0>=r.X(t);)n=C_(n),r=C_(r);var i=oa(n,1),s=oa(r,1);for(r=oa(r,2),n=oa(n,2);!Wr(r);){var a=s.add(r);0>=a.X(t)&&(i=i.add(n),s=a),r=oa(r,1),n=oa(n,1)}return e=Kd(t,i.R(e)),new Go(i,e)}for(i=La;0<=t.X(e);){for(n=Math.max(1,Math.floor(t.ea()/e.ea())),r=Math.ceil(Math.log(n)/Math.LN2),r=48>=r?1:Math.pow(2,r-48),s=gr(n),a=s.R(e);Nn(a)||0<a.X(t);)n-=r,s=gr(n),a=s.R(e);Wr(s)&&(s=u0),i=i.add(s),t=Kd(t,a)}return new Go(i,t)}M.gb=function(t){return Qd(this,t).h};M.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)&t.D(r);return new xe(n,this.h&t.h)};M.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)|t.D(r);return new xe(n,this.h|t.h)};M.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)^t.D(r);return new xe(n,this.h^t.h)};function C_(t){for(var e=t.g.length+1,n=[],r=0;r<e;r++)n[r]=t.D(r)<<1|t.D(r-1)>>>31;return new xe(n,t.h)}function oa(t,e){var n=e>>5;e%=32;for(var r=t.g.length-n,i=[],s=0;s<r;s++)i[s]=0<e?t.D(s+n)>>>e|t.D(s+n+1)<<32-e:t.D(s+n);return new xe(i,t.h)}Gd.prototype.createWebChannel=Gd.prototype.g;Sn.prototype.send=Sn.prototype.u;Sn.prototype.open=Sn.prototype.m;Sn.prototype.close=Sn.prototype.close;ff.NO_ERROR=0;ff.TIMEOUT=8;ff.HTTP_ERROR=6;aI.COMPLETE="complete";oI.EventType=Dc;Dc.OPEN="a";Dc.CLOSE="b";Dc.ERROR="c";Dc.MESSAGE="d";pt.prototype.listen=pt.prototype.O;Be.prototype.listenOnce=Be.prototype.P;Be.prototype.getLastError=Be.prototype.Sa;Be.prototype.getLastErrorCode=Be.prototype.Ia;Be.prototype.getStatus=Be.prototype.da;Be.prototype.getResponseJson=Be.prototype.Wa;Be.prototype.getResponseText=Be.prototype.ja;Be.prototype.send=Be.prototype.ha;Be.prototype.setWithCredentials=Be.prototype.Oa;nr.prototype.digest=nr.prototype.l;nr.prototype.reset=nr.prototype.reset;nr.prototype.update=nr.prototype.j;xe.prototype.add=xe.prototype.add;xe.prototype.multiply=xe.prototype.R;xe.prototype.modulo=xe.prototype.gb;xe.prototype.compare=xe.prototype.X;xe.prototype.toNumber=xe.prototype.ea;xe.prototype.toString=xe.prototype.toString;xe.prototype.getBits=xe.prototype.D;xe.fromNumber=gr;xe.fromString=BI;var VF=function(){return new Gd},HF=function(){return hf()},lp=ff,WF=aI,qF=ea,A_={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},vu=oI,GF=Be,KF=nr,Fa=xe;const R_="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Nt.UNAUTHENTICATED=new Nt(null),Nt.GOOGLE_CREDENTIALS=new Nt("google-credentials-uid"),Nt.FIRST_PARTY=new Nt("first-party-uid"),Nt.MOCK_USER=new Nt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ao="10.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ls=new sv("@firebase/firestore");function P_(){return Ls.logLevel}function W(t,...e){if(Ls.logLevel<=pe.DEBUG){const n=e.map(Fv);Ls.debug(`Firestore (${Ao}): ${t}`,...n)}}function ri(t,...e){if(Ls.logLevel<=pe.ERROR){const n=e.map(Fv);Ls.error(`Firestore (${Ao}): ${t}`,...n)}}function ro(t,...e){if(Ls.logLevel<=pe.WARN){const n=e.map(Fv);Ls.warn(`Firestore (${Ao}): ${t}`,...n)}}function Fv(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J(t="Unexpected state"){const e=`FIRESTORE (${Ao}) INTERNAL ASSERTION FAILED: `+t;throw ri(e),new Error(e)}function Re(t,e){t||J()}function ne(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class z extends jr{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qr{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VI{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class QF{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Nt.UNAUTHENTICATED))}shutdown(){}}class XF{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class YF{constructor(e){this.t=e,this.currentUser=Nt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){let r=this.i;const i=l=>this.i!==r?(r=this.i,n(l)):Promise.resolve();let s=new Qr;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Qr,e.enqueueRetryable(()=>i(this.currentUser))};const a=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},o=l=>{W("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.auth.addAuthTokenListener(this.o),a()};this.t.onInit(l=>o(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?o(l):(W("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Qr)}},0),a()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(W("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Re(typeof r.accessToken=="string"),new VI(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return Re(e===null||typeof e=="string"),new Nt(e)}}class JF{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=Nt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class ZF{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new JF(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(Nt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class e${constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class t${constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){const r=s=>{s.error!=null&&W("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.R;return this.R=s.token,W("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{W("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):W("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Re(typeof n.token=="string"),this.R=n.token,new e$(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n$(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HI{static V(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=n$(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%e.length))}return r}}function ge(t,e){return t<e?-1:t>e?1:0}function io(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class at{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new z(R.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new z(R.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new z(R.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new z(R.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return at.fromMillis(Date.now())}static fromDate(e){return at.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new at(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ge(this.nanoseconds,e.nanoseconds):ge(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ee{constructor(e){this.timestamp=e}static fromTimestamp(e){return new ee(e)}static min(){return new ee(new at(0,0))}static max(){return new ee(new at(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sc{constructor(e,n,r){n===void 0?n=0:n>e.length&&J(),r===void 0?r=e.length-n:r>e.length-n&&J(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return sc.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof sc?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=e.get(i),a=n.get(i);if(s<a)return-1;if(s>a)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class Ce extends sc{construct(e,n,r){return new Ce(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new z(R.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new Ce(n)}static emptyPath(){return new Ce([])}}const r$=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Dt extends sc{construct(e,n,r){return new Dt(e,n,r)}static isValidIdentifier(e){return r$.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Dt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Dt(["__name__"])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new z(R.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let a=!1;for(;i<e.length;){const o=e[i];if(o==="\\"){if(i+1===e.length)throw new z(R.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new z(R.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else o==="`"?(a=!a,i++):o!=="."||a?(r+=o,i++):(s(),i++)}if(s(),a)throw new z(R.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Dt(n)}static emptyPath(){return new Dt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K{constructor(e){this.path=e}static fromPath(e){return new K(Ce.fromString(e))}static fromName(e){return new K(Ce.fromString(e).popFirst(5))}static empty(){return new K(Ce.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ce.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Ce.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new K(new Ce(e.slice()))}}function i$(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=ee.fromTimestamp(r===1e9?new at(n+1,0):new at(n,r));return new qi(i,K.empty(),e)}function s$(t){return new qi(t.readTime,t.key,-1)}class qi{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new qi(ee.min(),K.empty(),-1)}static max(){return new qi(ee.max(),K.empty(),-1)}}function a$(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=K.comparator(t.documentKey,e.documentKey),n!==0?n:ge(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o$="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class l${constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zc(t){if(t.code!==R.FAILED_PRECONDITION||t.message!==o$)throw t;W("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&J(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new O((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof O?n:O.resolve(n)}catch(n){return O.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):O.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):O.reject(n)}static resolve(e){return new O((n,r)=>{n(e)})}static reject(e){return new O((n,r)=>{r(e)})}static waitFor(e){return new O((n,r)=>{let i=0,s=0,a=!1;e.forEach(o=>{++i,o.next(()=>{++s,a&&s===i&&n()},l=>r(l))}),a=!0,s===i&&n()})}static or(e){let n=O.resolve(!1);for(const r of e)n=n.next(i=>i?O.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new O((r,i)=>{const s=e.length,a=new Array(s);let o=0;for(let l=0;l<s;l++){const u=l;n(e[u]).next(d=>{a[u]=d,++o,o===s&&r(a)},d=>i(d))}})}static doWhile(e,n){return new O((r,i)=>{const s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}}function Uc(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $v{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.oe(r),this._e=r=>n.writeSequenceNumber(r))}oe(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this._e&&this._e(e),e}}$v.ae=-1;function Ef(t){return t==null}function Xd(t){return t===0&&1/t==-1/0}function c$(t){return typeof t=="number"&&Number.isInteger(t)&&!Xd(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N_(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Ro(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function WI(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $e{constructor(e,n){this.comparator=e,this.root=n||_t.EMPTY}insert(e,n){return new $e(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,_t.BLACK,null,null))}remove(e){return new $e(this.comparator,this.root.remove(e,this.comparator).copy(null,null,_t.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new xu(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new xu(this.root,e,this.comparator,!1)}getReverseIterator(){return new xu(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new xu(this.root,e,this.comparator,!0)}}class xu{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class _t{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??_t.RED,this.left=i??_t.EMPTY,this.right=s??_t.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new _t(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return _t.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return _t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,_t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,_t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw J();const e=this.left.check();if(e!==this.right.check())throw J();return e+(this.isRed()?0:1)}}_t.EMPTY=null,_t.RED=!0,_t.BLACK=!1;_t.EMPTY=new class{constructor(){this.size=0}get key(){throw J()}get value(){throw J()}get color(){throw J()}get left(){throw J()}get right(){throw J()}copy(e,n,r,i,s){return this}insert(e,n,r){return new _t(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ft{constructor(e){this.comparator=e,this.data=new $e(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new j_(this.data.getIterator())}getIteratorFrom(e){return new j_(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Ft)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Ft(this.comparator);return n.data=e,n}}class j_{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jn{constructor(e){this.fields=e,e.sort(Dt.comparator)}static empty(){return new Jn([])}unionWith(e){let n=new Ft(Dt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Jn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return io(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qI extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ut{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new qI("Invalid base64 string: "+s):s}}(e);return new Ut(n)}static fromUint8Array(e){const n=function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s}(e);return new Ut(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ge(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ut.EMPTY_BYTE_STRING=new Ut("");const u$=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Gi(t){if(Re(!!t),typeof t=="string"){let e=0;const n=u$.exec(t);if(Re(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Je(t.seconds),nanos:Je(t.nanos)}}function Je(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Fs(t){return typeof t=="string"?Ut.fromBase64String(t):Ut.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zv(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function Uv(t){const e=t.mapValue.fields.__previous_value__;return zv(e)?Uv(e):e}function ac(t){const e=Gi(t.mapValue.fields.__local_write_time__.timestampValue);return new at(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d${constructor(e,n,r,i,s,a,o,l,u){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=u}}class oc{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new oc("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof oc&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wu={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function $s(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?zv(t)?4:h$(t)?9007199254740991:10:J()}function Cr(t,e){if(t===e)return!0;const n=$s(t);if(n!==$s(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return ac(t).isEqual(ac(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const a=Gi(i.timestampValue),o=Gi(s.timestampValue);return a.seconds===o.seconds&&a.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return Fs(i.bytesValue).isEqual(Fs(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return Je(i.geoPointValue.latitude)===Je(s.geoPointValue.latitude)&&Je(i.geoPointValue.longitude)===Je(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Je(i.integerValue)===Je(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const a=Je(i.doubleValue),o=Je(s.doubleValue);return a===o?Xd(a)===Xd(o):isNaN(a)&&isNaN(o)}return!1}(t,e);case 9:return io(t.arrayValue.values||[],e.arrayValue.values||[],Cr);case 10:return function(i,s){const a=i.mapValue.fields||{},o=s.mapValue.fields||{};if(N_(a)!==N_(o))return!1;for(const l in a)if(a.hasOwnProperty(l)&&(o[l]===void 0||!Cr(a[l],o[l])))return!1;return!0}(t,e);default:return J()}}function lc(t,e){return(t.values||[]).find(n=>Cr(n,e))!==void 0}function so(t,e){if(t===e)return 0;const n=$s(t),r=$s(e);if(n!==r)return ge(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return ge(t.booleanValue,e.booleanValue);case 2:return function(s,a){const o=Je(s.integerValue||s.doubleValue),l=Je(a.integerValue||a.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1}(t,e);case 3:return O_(t.timestampValue,e.timestampValue);case 4:return O_(ac(t),ac(e));case 5:return ge(t.stringValue,e.stringValue);case 6:return function(s,a){const o=Fs(s),l=Fs(a);return o.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(s,a){const o=s.split("/"),l=a.split("/");for(let u=0;u<o.length&&u<l.length;u++){const d=ge(o[u],l[u]);if(d!==0)return d}return ge(o.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,a){const o=ge(Je(s.latitude),Je(a.latitude));return o!==0?o:ge(Je(s.longitude),Je(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(s,a){const o=s.values||[],l=a.values||[];for(let u=0;u<o.length&&u<l.length;++u){const d=so(o[u],l[u]);if(d)return d}return ge(o.length,l.length)}(t.arrayValue,e.arrayValue);case 10:return function(s,a){if(s===wu.mapValue&&a===wu.mapValue)return 0;if(s===wu.mapValue)return 1;if(a===wu.mapValue)return-1;const o=s.fields||{},l=Object.keys(o),u=a.fields||{},d=Object.keys(u);l.sort(),d.sort();for(let h=0;h<l.length&&h<d.length;++h){const m=ge(l[h],d[h]);if(m!==0)return m;const p=so(o[l[h]],u[d[h]]);if(p!==0)return p}return ge(l.length,d.length)}(t.mapValue,e.mapValue);default:throw J()}}function O_(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return ge(t,e);const n=Gi(t),r=Gi(e),i=ge(n.seconds,r.seconds);return i!==0?i:ge(n.nanos,r.nanos)}function ao(t){return d0(t)}function d0(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Gi(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Fs(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return K.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=d0(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const a of r)s?s=!1:i+=",",i+=`${a}:${d0(n.fields[a])}`;return i+"}"}(t.mapValue):J()}function D_(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function h0(t){return!!t&&"integerValue"in t}function Bv(t){return!!t&&"arrayValue"in t}function M_(t){return!!t&&"nullValue"in t}function L_(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function ed(t){return!!t&&"mapValue"in t}function El(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Ro(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=El(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=El(t.arrayValue.values[n]);return e}return Object.assign({},t)}function h$(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jn{constructor(e){this.value=e}static empty(){return new jn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!ed(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=El(n)}setAll(e){let n=Dt.emptyPath(),r={},i=[];e.forEach((a,o)=>{if(!n.isImmediateParentOf(o)){const l=this.getFieldsMap(n);this.applyChanges(l,r,i),r={},i=[],n=o.popLast()}a?r[o.lastSegment()]=El(a):i.push(o.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());ed(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Cr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];ed(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){Ro(n,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new jn(El(this.value))}}function GI(t){const e=[];return Ro(t.fields,(n,r)=>{const i=new Dt([n]);if(ed(r)){const s=GI(r.mapValue).fields;if(s.length===0)e.push(i);else for(const a of s)e.push(i.child(a))}else e.push(i)}),new Jn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ot{constructor(e,n,r,i,s,a,o){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=a,this.documentState=o}static newInvalidDocument(e){return new Ot(e,0,ee.min(),ee.min(),ee.min(),jn.empty(),0)}static newFoundDocument(e,n,r,i){return new Ot(e,1,n,ee.min(),r,i,0)}static newNoDocument(e,n){return new Ot(e,2,n,ee.min(),ee.min(),jn.empty(),0)}static newUnknownDocument(e,n){return new Ot(e,3,n,ee.min(),ee.min(),jn.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(ee.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=jn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=jn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ee.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Ot&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ot(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yd{constructor(e,n){this.position=e,this.inclusive=n}}function F_(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],a=t.position[i];if(s.field.isKeyField()?r=K.comparator(K.fromName(a.referenceValue),n.key):r=so(a,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function $_(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Cr(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sl{constructor(e,n="asc"){this.field=e,this.dir=n}}function f$(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KI{}class et extends KI{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new p$(e,n,r):n==="array-contains"?new v$(e,r):n==="in"?new x$(e,r):n==="not-in"?new w$(e,r):n==="array-contains-any"?new _$(e,r):new et(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new g$(e,r):new y$(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(so(n,this.value)):n!==null&&$s(this.value)===$s(n)&&this.matchesComparison(so(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return J()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class rr extends KI{constructor(e,n){super(),this.filters=e,this.op=n,this.ce=null}static create(e,n){return new rr(e,n)}matches(e){return QI(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ce!==null||(this.ce=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ce}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){const e=this.le(n=>n.isInequality());return e!==null?e.field:null}le(e){for(const n of this.getFlattenedFilters())if(e(n))return n;return null}}function QI(t){return t.op==="and"}function XI(t){return m$(t)&&QI(t)}function m$(t){for(const e of t.filters)if(e instanceof rr)return!1;return!0}function f0(t){if(t instanceof et)return t.field.canonicalString()+t.op.toString()+ao(t.value);if(XI(t))return t.filters.map(e=>f0(e)).join(",");{const e=t.filters.map(n=>f0(n)).join(",");return`${t.op}(${e})`}}function YI(t,e){return t instanceof et?function(r,i){return i instanceof et&&r.op===i.op&&r.field.isEqual(i.field)&&Cr(r.value,i.value)}(t,e):t instanceof rr?function(r,i){return i instanceof rr&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,a,o)=>s&&YI(a,i.filters[o]),!0):!1}(t,e):void J()}function JI(t){return t instanceof et?function(n){return`${n.field.canonicalString()} ${n.op} ${ao(n.value)}`}(t):t instanceof rr?function(n){return n.op.toString()+" {"+n.getFilters().map(JI).join(" ,")+"}"}(t):"Filter"}class p$ extends et{constructor(e,n,r){super(e,n,r),this.key=K.fromName(r.referenceValue)}matches(e){const n=K.comparator(e.key,this.key);return this.matchesComparison(n)}}class g$ extends et{constructor(e,n){super(e,"in",n),this.keys=ZI("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class y$ extends et{constructor(e,n){super(e,"not-in",n),this.keys=ZI("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function ZI(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>K.fromName(r.referenceValue))}class v$ extends et{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Bv(n)&&lc(n.arrayValue,this.value)}}class x$ extends et{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&lc(this.value.arrayValue,n)}}class w$ extends et{constructor(e,n){super(e,"not-in",n)}matches(e){if(lc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!lc(this.value.arrayValue,n)}}class _$ extends et{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Bv(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>lc(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E${constructor(e,n=null,r=[],i=[],s=null,a=null,o=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=a,this.endAt=o,this.he=null}}function z_(t,e=null,n=[],r=[],i=null,s=null,a=null){return new E$(t,e,n,r,i,s,a)}function Vv(t){const e=ne(t);if(e.he===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>f0(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Ef(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>ao(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>ao(r)).join(",")),e.he=n}return e.he}function Hv(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!f$(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!YI(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!$_(t.startAt,e.startAt)&&$_(t.endAt,e.endAt)}function m0(t){return K.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bc{constructor(e,n=null,r=[],i=[],s=null,a="F",o=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=a,this.startAt=o,this.endAt=l,this.Pe=null,this.Ie=null,this.Te=null,this.startAt,this.endAt}}function S$(t,e,n,r,i,s,a,o){return new Bc(t,e,n,r,i,s,a,o)}function Wv(t){return new Bc(t)}function U_(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function eC(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function qv(t){for(const e of t.filters){const n=e.getFirstInequalityField();if(n!==null)return n}return null}function tC(t){return t.collectionGroup!==null}function kl(t){const e=ne(t);if(e.Pe===null){e.Pe=[];const n=qv(e),r=eC(e);if(n!==null&&r===null)n.isKeyField()||e.Pe.push(new Sl(n)),e.Pe.push(new Sl(Dt.keyField(),"asc"));else{let i=!1;for(const s of e.explicitOrderBy)e.Pe.push(s),s.field.isKeyField()&&(i=!0);if(!i){const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.Pe.push(new Sl(Dt.keyField(),s))}}}return e.Pe}function ii(t){const e=ne(t);return e.Ie||(e.Ie=k$(e,kl(t))),e.Ie}function k$(t,e){if(t.limitType==="F")return z_(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new Sl(i.field,s)});const n=t.endAt?new Yd(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Yd(t.startAt.position,t.startAt.inclusive):null;return z_(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function p0(t,e){e.getFirstInequalityField(),qv(t);const n=t.filters.concat([e]);return new Bc(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Jd(t,e,n){return new Bc(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Sf(t,e){return Hv(ii(t),ii(e))&&t.limitType===e.limitType}function nC(t){return`${Vv(ii(t))}|lt:${t.limitType}`}function g0(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>JI(i)).join(", ")}]`),Ef(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>ao(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>ao(i)).join(",")),`Target(${r})`}(ii(t))}; limitType=${t.limitType})`}function kf(t,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):K.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(const s of kl(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(a,o,l){const u=F_(a,o,l);return a.inclusive?u<=0:u<0}(r.startAt,kl(r),i)||r.endAt&&!function(a,o,l){const u=F_(a,o,l);return a.inclusive?u>=0:u>0}(r.endAt,kl(r),i))}(t,e)}function b$(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function rC(t){return(e,n)=>{let r=!1;for(const i of kl(t)){const s=T$(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function T$(t,e,n){const r=t.field.isKeyField()?K.comparator(e.key,n.key):function(s,a,o){const l=a.data.field(s),u=o.data.field(s);return l!==null&&u!==null?so(l,u):J()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return J()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Po{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Ro(this.inner,(n,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return WI(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I$=new $e(K.comparator);function si(){return I$}const iC=new $e(K.comparator);function ol(...t){let e=iC;for(const n of t)e=e.insert(n.key,n);return e}function sC(t){let e=iC;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Es(){return bl()}function aC(){return bl()}function bl(){return new Po(t=>t.toString(),(t,e)=>t.isEqual(e))}const C$=new $e(K.comparator),A$=new Ft(K.comparator);function ce(...t){let e=A$;for(const n of t)e=e.add(n);return e}const R$=new Ft(ge);function P$(){return R$}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oC(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Xd(e)?"-0":e}}function lC(t){return{integerValue:""+t}}function N$(t,e){return c$(e)?lC(e):oC(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bf{constructor(){this._=void 0}}function j$(t,e,n){return t instanceof Zd?function(i,s){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&zv(s)&&(s=Uv(s)),s&&(a.fields.__previous_value__=s),{mapValue:a}}(n,e):t instanceof cc?uC(t,e):t instanceof uc?dC(t,e):function(i,s){const a=cC(i,s),o=B_(a)+B_(i.Ee);return h0(a)&&h0(i.Ee)?lC(o):oC(i.serializer,o)}(t,e)}function O$(t,e,n){return t instanceof cc?uC(t,e):t instanceof uc?dC(t,e):n}function cC(t,e){return t instanceof eh?function(r){return h0(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class Zd extends bf{}class cc extends bf{constructor(e){super(),this.elements=e}}function uC(t,e){const n=hC(e);for(const r of t.elements)n.some(i=>Cr(i,r))||n.push(r);return{arrayValue:{values:n}}}class uc extends bf{constructor(e){super(),this.elements=e}}function dC(t,e){let n=hC(e);for(const r of t.elements)n=n.filter(i=>!Cr(i,r));return{arrayValue:{values:n}}}class eh extends bf{constructor(e,n){super(),this.serializer=e,this.Ee=n}}function B_(t){return Je(t.integerValue||t.doubleValue)}function hC(t){return Bv(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function D$(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof cc&&i instanceof cc||r instanceof uc&&i instanceof uc?io(r.elements,i.elements,Cr):r instanceof eh&&i instanceof eh?Cr(r.Ee,i.Ee):r instanceof Zd&&i instanceof Zd}(t.transform,e.transform)}class M${constructor(e,n){this.version=e,this.transformResults=n}}class kr{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new kr}static exists(e){return new kr(void 0,e)}static updateTime(e){return new kr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function td(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Tf{}function fC(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Gv(t.key,kr.none()):new Vc(t.key,t.data,kr.none());{const n=t.data,r=jn.empty();let i=new Ft(Dt.comparator);for(let s of e.fields)if(!i.has(s)){let a=n.field(s);a===null&&s.length>1&&(s=s.popLast(),a=n.field(s)),a===null?r.delete(s):r.set(s,a),i=i.add(s)}return new ta(t.key,r,new Jn(i.toArray()),kr.none())}}function L$(t,e,n){t instanceof Vc?function(i,s,a){const o=i.value.clone(),l=H_(i.fieldTransforms,s,a.transformResults);o.setAll(l),s.convertToFoundDocument(a.version,o).setHasCommittedMutations()}(t,e,n):t instanceof ta?function(i,s,a){if(!td(i.precondition,s))return void s.convertToUnknownDocument(a.version);const o=H_(i.fieldTransforms,s,a.transformResults),l=s.data;l.setAll(mC(i)),l.setAll(o),s.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(t,e,n):function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,n)}function Tl(t,e,n,r){return t instanceof Vc?function(s,a,o,l){if(!td(s.precondition,a))return o;const u=s.value.clone(),d=W_(s.fieldTransforms,l,a);return u.setAll(d),a.convertToFoundDocument(a.version,u).setHasLocalMutations(),null}(t,e,n,r):t instanceof ta?function(s,a,o,l){if(!td(s.precondition,a))return o;const u=W_(s.fieldTransforms,l,a),d=a.data;return d.setAll(mC(s)),d.setAll(u),a.convertToFoundDocument(a.version,d).setHasLocalMutations(),o===null?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(h=>h.field))}(t,e,n,r):function(s,a,o){return td(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):o}(t,e,n)}function F$(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=cC(r.transform,i||null);s!=null&&(n===null&&(n=jn.empty()),n.set(r.field,s))}return n||null}function V_(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&io(r,i,(s,a)=>D$(s,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Vc extends Tf{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class ta extends Tf{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function mC(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function H_(t,e,n){const r=new Map;Re(t.length===n.length);for(let i=0;i<n.length;i++){const s=t[i],a=s.transform,o=e.data.field(s.field);r.set(s.field,O$(a,o,n[i]))}return r}function W_(t,e,n){const r=new Map;for(const i of t){const s=i.transform,a=n.data.field(i.field);r.set(i.field,j$(s,a,e))}return r}class Gv extends Tf{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class $$ extends Tf{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z${constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&L$(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Tl(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Tl(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=aC();return this.mutations.forEach(i=>{const s=e.get(i.key),a=s.overlayedDocument;let o=this.applyToLocalView(a,s.mutatedFields);o=n.has(i.key)?null:o;const l=fC(a,o);l!==null&&r.set(i.key,l),a.isValidDocument()||a.convertToNoDocument(ee.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),ce())}isEqual(e){return this.batchId===e.batchId&&io(this.mutations,e.mutations,(n,r)=>V_(n,r))&&io(this.baseMutations,e.baseMutations,(n,r)=>V_(n,r))}}class Kv{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){Re(e.mutations.length===r.length);let i=function(){return C$}();const s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,r[a].version);return new Kv(e,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U${constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B${constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ye,he;function V$(t){switch(t){default:return J();case R.CANCELLED:case R.UNKNOWN:case R.DEADLINE_EXCEEDED:case R.RESOURCE_EXHAUSTED:case R.INTERNAL:case R.UNAVAILABLE:case R.UNAUTHENTICATED:return!1;case R.INVALID_ARGUMENT:case R.NOT_FOUND:case R.ALREADY_EXISTS:case R.PERMISSION_DENIED:case R.FAILED_PRECONDITION:case R.ABORTED:case R.OUT_OF_RANGE:case R.UNIMPLEMENTED:case R.DATA_LOSS:return!0}}function pC(t){if(t===void 0)return ri("GRPC error has no .code"),R.UNKNOWN;switch(t){case Ye.OK:return R.OK;case Ye.CANCELLED:return R.CANCELLED;case Ye.UNKNOWN:return R.UNKNOWN;case Ye.DEADLINE_EXCEEDED:return R.DEADLINE_EXCEEDED;case Ye.RESOURCE_EXHAUSTED:return R.RESOURCE_EXHAUSTED;case Ye.INTERNAL:return R.INTERNAL;case Ye.UNAVAILABLE:return R.UNAVAILABLE;case Ye.UNAUTHENTICATED:return R.UNAUTHENTICATED;case Ye.INVALID_ARGUMENT:return R.INVALID_ARGUMENT;case Ye.NOT_FOUND:return R.NOT_FOUND;case Ye.ALREADY_EXISTS:return R.ALREADY_EXISTS;case Ye.PERMISSION_DENIED:return R.PERMISSION_DENIED;case Ye.FAILED_PRECONDITION:return R.FAILED_PRECONDITION;case Ye.ABORTED:return R.ABORTED;case Ye.OUT_OF_RANGE:return R.OUT_OF_RANGE;case Ye.UNIMPLEMENTED:return R.UNIMPLEMENTED;case Ye.DATA_LOSS:return R.DATA_LOSS;default:return J()}}(he=Ye||(Ye={}))[he.OK=0]="OK",he[he.CANCELLED=1]="CANCELLED",he[he.UNKNOWN=2]="UNKNOWN",he[he.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",he[he.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",he[he.NOT_FOUND=5]="NOT_FOUND",he[he.ALREADY_EXISTS=6]="ALREADY_EXISTS",he[he.PERMISSION_DENIED=7]="PERMISSION_DENIED",he[he.UNAUTHENTICATED=16]="UNAUTHENTICATED",he[he.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",he[he.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",he[he.ABORTED=10]="ABORTED",he[he.OUT_OF_RANGE=11]="OUT_OF_RANGE",he[he.UNIMPLEMENTED=12]="UNIMPLEMENTED",he[he.INTERNAL=13]="INTERNAL",he[he.UNAVAILABLE=14]="UNAVAILABLE",he[he.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H$(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W$=new Fa([4294967295,4294967295],0);function q_(t){const e=H$().encode(t),n=new KF;return n.update(e),new Uint8Array(n.digest())}function G_(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Fa([n,r],0),new Fa([i,s],0)]}class Qv{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new ll(`Invalid padding: ${n}`);if(r<0)throw new ll(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new ll(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new ll(`Invalid padding when bitmap length is 0: ${n}`);this.Ae=8*e.length-n,this.Re=Fa.fromNumber(this.Ae)}Ve(e,n,r){let i=e.add(n.multiply(Fa.fromNumber(r)));return i.compare(W$)===1&&(i=new Fa([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Re).toNumber()}me(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ae===0)return!1;const n=q_(e),[r,i]=G_(n);for(let s=0;s<this.hashCount;s++){const a=this.Ve(r,i,s);if(!this.me(a))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new Qv(s,i,n);return r.forEach(o=>a.insert(o)),a}insert(e){if(this.Ae===0)return;const n=q_(e),[r,i]=G_(n);for(let s=0;s<this.hashCount;s++){const a=this.Ve(r,i,s);this.fe(a)}}fe(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class ll extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class If{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,Hc.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new If(ee.min(),i,new $e(ge),si(),ce())}}class Hc{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Hc(r,n,ce(),ce(),ce())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nd{constructor(e,n,r,i){this.ge=e,this.removedTargetIds=n,this.key=r,this.pe=i}}class gC{constructor(e,n){this.targetId=e,this.ye=n}}class yC{constructor(e,n,r=Ut.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class K_{constructor(){this.we=0,this.Se=X_(),this.be=Ut.EMPTY_BYTE_STRING,this.De=!1,this.ve=!0}get current(){return this.De}get resumeToken(){return this.be}get Ce(){return this.we!==0}get Fe(){return this.ve}Me(e){e.approximateByteSize()>0&&(this.ve=!0,this.be=e)}xe(){let e=ce(),n=ce(),r=ce();return this.Se.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:J()}}),new Hc(this.be,this.De,e,n,r)}Oe(){this.ve=!1,this.Se=X_()}Ne(e,n){this.ve=!0,this.Se=this.Se.insert(e,n)}Be(e){this.ve=!0,this.Se=this.Se.remove(e)}Le(){this.we+=1}ke(){this.we-=1}qe(){this.ve=!0,this.De=!0}}class q${constructor(e){this.Qe=e,this.Ke=new Map,this.$e=si(),this.Ue=Q_(),this.We=new $e(ge)}Ge(e){for(const n of e.ge)e.pe&&e.pe.isFoundDocument()?this.ze(n,e.pe):this.je(n,e.key,e.pe);for(const n of e.removedTargetIds)this.je(n,e.key,e.pe)}He(e){this.forEachTarget(e,n=>{const r=this.Je(n);switch(e.state){case 0:this.Ye(n)&&r.Me(e.resumeToken);break;case 1:r.ke(),r.Ce||r.Oe(),r.Me(e.resumeToken);break;case 2:r.ke(),r.Ce||this.removeTarget(n);break;case 3:this.Ye(n)&&(r.qe(),r.Me(e.resumeToken));break;case 4:this.Ye(n)&&(this.Ze(n),r.Me(e.resumeToken));break;default:J()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Ke.forEach((r,i)=>{this.Ye(i)&&n(i)})}Xe(e){const n=e.targetId,r=e.ye.count,i=this.et(n);if(i){const s=i.target;if(m0(s))if(r===0){const a=new K(s.path);this.je(n,a,Ot.newNoDocument(a,ee.min()))}else Re(r===1);else{const a=this.tt(n);if(a!==r){const o=this.nt(e),l=o?this.rt(o,e,a):1;if(l!==0){this.Ze(n);const u=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.We=this.We.insert(n,u)}}}}}nt(e){const n=e.ye.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let a,o;try{a=Fs(r).toUint8Array()}catch(l){if(l instanceof qI)return ro("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{o=new Qv(a,i,s)}catch(l){return ro(l instanceof ll?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return o.Ae===0?null:o}rt(e,n,r){return n.ye.count===r-this.ot(e,n.targetId)?0:2}ot(e,n){const r=this.Qe.getRemoteKeysForTarget(n);let i=0;return r.forEach(s=>{const a=this.Qe.st(),o=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(o)||(this.je(n,s,null),i++)}),i}_t(e){const n=new Map;this.Ke.forEach((s,a)=>{const o=this.et(a);if(o){if(s.current&&m0(o.target)){const l=new K(o.target.path);this.$e.get(l)!==null||this.ut(a,l)||this.je(a,l,Ot.newNoDocument(l,e))}s.Fe&&(n.set(a,s.xe()),s.Oe())}});let r=ce();this.Ue.forEach((s,a)=>{let o=!0;a.forEachWhile(l=>{const u=this.et(l);return!u||u.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(r=r.add(s))}),this.$e.forEach((s,a)=>a.setReadTime(e));const i=new If(e,n,this.We,this.$e,r);return this.$e=si(),this.Ue=Q_(),this.We=new $e(ge),i}ze(e,n){if(!this.Ye(e))return;const r=this.ut(e,n.key)?2:0;this.Je(e).Ne(n.key,r),this.$e=this.$e.insert(n.key,n),this.Ue=this.Ue.insert(n.key,this.ct(n.key).add(e))}je(e,n,r){if(!this.Ye(e))return;const i=this.Je(e);this.ut(e,n)?i.Ne(n,1):i.Be(n),this.Ue=this.Ue.insert(n,this.ct(n).delete(e)),r&&(this.$e=this.$e.insert(n,r))}removeTarget(e){this.Ke.delete(e)}tt(e){const n=this.Je(e).xe();return this.Qe.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Le(e){this.Je(e).Le()}Je(e){let n=this.Ke.get(e);return n||(n=new K_,this.Ke.set(e,n)),n}ct(e){let n=this.Ue.get(e);return n||(n=new Ft(ge),this.Ue=this.Ue.insert(e,n)),n}Ye(e){const n=this.et(e)!==null;return n||W("WatchChangeAggregator","Detected inactive target",e),n}et(e){const n=this.Ke.get(e);return n&&n.Ce?null:this.Qe.lt(e)}Ze(e){this.Ke.set(e,new K_),this.Qe.getRemoteKeysForTarget(e).forEach(n=>{this.je(e,n,null)})}ut(e,n){return this.Qe.getRemoteKeysForTarget(e).has(n)}}function Q_(){return new $e(K.comparator)}function X_(){return new $e(K.comparator)}const G$=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),K$=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),Q$=(()=>({and:"AND",or:"OR"}))();class X${constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function y0(t,e){return t.useProto3Json||Ef(e)?e:{value:e}}function th(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function vC(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function Y$(t,e){return th(t,e.toTimestamp())}function br(t){return Re(!!t),ee.fromTimestamp(function(n){const r=Gi(n);return new at(r.seconds,r.nanos)}(t))}function Xv(t,e){return function(r){return new Ce(["projects",r.projectId,"databases",r.database])}(t).child("documents").child(e).canonicalString()}function xC(t){const e=Ce.fromString(t);return Re(SC(e)),e}function v0(t,e){return Xv(t.databaseId,e.path)}function cp(t,e){const n=xC(e);if(n.get(1)!==t.databaseId.projectId)throw new z(R.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new z(R.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new K(wC(n))}function x0(t,e){return Xv(t.databaseId,e)}function J$(t){const e=xC(t);return e.length===4?Ce.emptyPath():wC(e)}function w0(t){return new Ce(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function wC(t){return Re(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function Y_(t,e,n){return{name:v0(t,e),fields:n.value.mapValue.fields}}function Z$(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:J()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(u,d){return u.useProto3Json?(Re(d===void 0||typeof d=="string"),Ut.fromBase64String(d||"")):(Re(d===void 0||d instanceof Uint8Array),Ut.fromUint8Array(d||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,o=a&&function(u){const d=u.code===void 0?R.UNKNOWN:pC(u.code);return new z(d,u.message||"")}(a);n=new yC(r,i,s,o||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=cp(t,r.document.name),s=br(r.document.updateTime),a=r.document.createTime?br(r.document.createTime):ee.min(),o=new jn({mapValue:{fields:r.document.fields}}),l=Ot.newFoundDocument(i,s,a,o),u=r.targetIds||[],d=r.removedTargetIds||[];n=new nd(u,d,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=cp(t,r.document),s=r.readTime?br(r.readTime):ee.min(),a=Ot.newNoDocument(i,s),o=r.removedTargetIds||[];n=new nd([],o,a.key,a)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=cp(t,r.document),s=r.removedTargetIds||[];n=new nd([],s,i,null)}else{if(!("filter"in e))return J();{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,a=new B$(i,s),o=r.targetId;n=new gC(o,a)}}return n}function e9(t,e){let n;if(e instanceof Vc)n={update:Y_(t,e.key,e.value)};else if(e instanceof Gv)n={delete:v0(t,e.key)};else if(e instanceof ta)n={update:Y_(t,e.key,e.data),updateMask:c9(e.fieldMask)};else{if(!(e instanceof $$))return J();n={verify:v0(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,a){const o=a.transform;if(o instanceof Zd)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof cc)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof uc)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof eh)return{fieldPath:a.field.canonicalString(),increment:o.Ee};throw J()}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:Y$(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:J()}(t,e.precondition)),n}function t9(t,e){return t&&t.length>0?(Re(e!==void 0),t.map(n=>function(i,s){let a=i.updateTime?br(i.updateTime):br(s);return a.isEqual(ee.min())&&(a=br(s)),new M$(a,i.transformResults||[])}(n,e))):[]}function n9(t,e){return{documents:[x0(t,e.path)]}}function r9(t,e){const n={structuredQuery:{}},r=e.path;e.collectionGroup!==null?(n.parent=x0(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=x0(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);const i=function(l){if(l.length!==0)return EC(rr.create(l,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const s=function(l){if(l.length!==0)return l.map(u=>function(h){return{field:ha(h.field),direction:a9(h.dir)}}(u))}(e.orderBy);s&&(n.structuredQuery.orderBy=s);const a=y0(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(l){return{before:l.inclusive,values:l.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(e.endAt)),n}function i9(t){let e=J$(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){Re(r===1);const d=n.from[0];d.allDescendants?i=d.collectionId:e=e.child(d.collectionId)}let s=[];n.where&&(s=function(h){const m=_C(h);return m instanceof rr&&XI(m)?m.getFilters():[m]}(n.where));let a=[];n.orderBy&&(a=function(h){return h.map(m=>function(g){return new Sl(fa(g.field),function(E){switch(E){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(g.direction))}(m))}(n.orderBy));let o=null;n.limit&&(o=function(h){let m;return m=typeof h=="object"?h.value:h,Ef(m)?null:m}(n.limit));let l=null;n.startAt&&(l=function(h){const m=!!h.before,p=h.values||[];return new Yd(p,m)}(n.startAt));let u=null;return n.endAt&&(u=function(h){const m=!h.before,p=h.values||[];return new Yd(p,m)}(n.endAt)),S$(e,i,a,s,o,"F",l,u)}function s9(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return J()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function _C(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=fa(n.unaryFilter.field);return et.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=fa(n.unaryFilter.field);return et.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=fa(n.unaryFilter.field);return et.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=fa(n.unaryFilter.field);return et.create(a,"!=",{nullValue:"NULL_VALUE"});default:return J()}}(t):t.fieldFilter!==void 0?function(n){return et.create(fa(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return J()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return rr.create(n.compositeFilter.filters.map(r=>_C(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return J()}}(n.compositeFilter.op))}(t):J()}function a9(t){return G$[t]}function o9(t){return K$[t]}function l9(t){return Q$[t]}function ha(t){return{fieldPath:t.canonicalString()}}function fa(t){return Dt.fromServerFormat(t.fieldPath)}function EC(t){return t instanceof et?function(n){if(n.op==="=="){if(L_(n.value))return{unaryFilter:{field:ha(n.field),op:"IS_NAN"}};if(M_(n.value))return{unaryFilter:{field:ha(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(L_(n.value))return{unaryFilter:{field:ha(n.field),op:"IS_NOT_NAN"}};if(M_(n.value))return{unaryFilter:{field:ha(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ha(n.field),op:o9(n.op),value:n.value}}}(t):t instanceof rr?function(n){const r=n.getFilters().map(i=>EC(i));return r.length===1?r[0]:{compositeFilter:{op:l9(n.op),filters:r}}}(t):J()}function c9(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function SC(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ci{constructor(e,n,r,i,s=ee.min(),a=ee.min(),o=Ut.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(e){return new Ci(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Ci(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ci(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ci(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u9{constructor(e){this.ht=e}}function d9(t){const e=i9({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Jd(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h9{constructor(){this._n=new f9}addToCollectionParentIndex(e,n){return this._n.add(n),O.resolve()}getCollectionParents(e,n){return O.resolve(this._n.getEntries(n))}addFieldIndex(e,n){return O.resolve()}deleteFieldIndex(e,n){return O.resolve()}getDocumentsMatchingTarget(e,n){return O.resolve(null)}getIndexType(e,n){return O.resolve(0)}getFieldIndexes(e,n){return O.resolve([])}getNextCollectionGroupToUpdate(e){return O.resolve(null)}getMinOffset(e,n){return O.resolve(qi.min())}getMinOffsetFromCollectionGroup(e,n){return O.resolve(qi.min())}updateCollectionGroup(e,n,r){return O.resolve()}updateIndexEntries(e,n){return O.resolve()}}class f9{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new Ft(Ce.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Ft(Ce.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oo{constructor(e){this.On=e}next(){return this.On+=2,this.On}static Nn(){return new oo(0)}static Bn(){return new oo(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m9{constructor(){this.changes=new Po(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Ot.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?O.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p9{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g9{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&Tl(r.mutation,i,Jn.empty(),at.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,ce()).next(()=>r))}getLocalViewOfDocuments(e,n,r=ce()){const i=Es();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let a=ol();return s.forEach((o,l)=>{a=a.insert(o,l.overlayedDocument)}),a}))}getOverlayedDocuments(e,n){const r=Es();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,ce()))}populateOverlays(e,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((a,o)=>{n.set(a,o)})})}computeViews(e,n,r,i){let s=si();const a=bl(),o=function(){return bl()}();return n.forEach((l,u)=>{const d=r.get(u.key);i.has(u.key)&&(d===void 0||d.mutation instanceof ta)?s=s.insert(u.key,u):d!==void 0?(a.set(u.key,d.mutation.getFieldMask()),Tl(d.mutation,u,d.mutation.getFieldMask(),at.now())):a.set(u.key,Jn.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((u,d)=>a.set(u,d)),n.forEach((u,d)=>{var h;return o.set(u,new p9(d,(h=a.get(u))!==null&&h!==void 0?h:null))}),o))}recalculateAndSaveOverlays(e,n){const r=bl();let i=new $e((a,o)=>a-o),s=ce();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(a=>{for(const o of a)o.keys().forEach(l=>{const u=n.get(l);if(u===null)return;let d=r.get(l)||Jn.empty();d=o.applyToLocalView(u,d),r.set(l,d);const h=(i.get(o.batchId)||ce()).add(l);i=i.insert(o.batchId,h)})}).next(()=>{const a=[],o=i.getReverseIterator();for(;o.hasNext();){const l=o.getNext(),u=l.key,d=l.value,h=aC();d.forEach(m=>{if(!s.has(m)){const p=fC(n.get(m),r.get(m));p!==null&&h.set(m,p),s=s.add(m)}}),a.push(this.documentOverlayCache.saveOverlays(e,u,h))}return O.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r){return function(s){return K.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):tC(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r):this.getDocumentsMatchingCollectionQuery(e,n,r)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{const a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):O.resolve(Es());let o=-1,l=s;return a.next(u=>O.forEach(u,(d,h)=>(o<h.largestBatchId&&(o=h.largestBatchId),s.get(d)?O.resolve():this.remoteDocumentCache.getEntry(e,d).next(m=>{l=l.insert(d,m)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,l,u,ce())).next(d=>({batchId:o,changes:sC(d)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new K(n)).next(r=>{let i=ol();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r){const i=n.collectionGroup;let s=ol();return this.indexManager.getCollectionParents(e,i).next(a=>O.forEach(a,o=>{const l=function(d,h){return new Bc(h,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(n,o.child(i));return this.getDocumentsMatchingCollectionQuery(e,l,r).next(u=>{u.forEach((d,h)=>{s=s.insert(d,h)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,n,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(s=>(i=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i))).next(s=>{i.forEach((o,l)=>{const u=l.getKey();s.get(u)===null&&(s=s.insert(u,Ot.newInvalidDocument(u)))});let a=ol();return s.forEach((o,l)=>{const u=i.get(o);u!==void 0&&Tl(u.mutation,l,Jn.empty(),at.now()),kf(n,l)&&(a=a.insert(o,l))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y9{constructor(e){this.serializer=e,this.cr=new Map,this.lr=new Map}getBundleMetadata(e,n){return O.resolve(this.cr.get(n))}saveBundleMetadata(e,n){return this.cr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:br(i.createTime)}}(n)),O.resolve()}getNamedQuery(e,n){return O.resolve(this.lr.get(n))}saveNamedQuery(e,n){return this.lr.set(n.name,function(i){return{name:i.name,query:d9(i.bundledQuery),readTime:br(i.readTime)}}(n)),O.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v9{constructor(){this.overlays=new $e(K.comparator),this.hr=new Map}getOverlay(e,n){return O.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Es();return O.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.It(e,n,s)}),O.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.hr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.hr.delete(r)),O.resolve()}getOverlaysForCollection(e,n,r){const i=Es(),s=n.length+1,a=new K(n.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){const l=o.getNext().value,u=l.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return O.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new $e((u,d)=>u-d);const a=this.overlays.getIterator();for(;a.hasNext();){const u=a.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>r){let d=s.get(u.largestBatchId);d===null&&(d=Es(),s=s.insert(u.largestBatchId,d)),d.set(u.getKey(),u)}}const o=Es(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((u,d)=>o.set(u,d)),!(o.size()>=i)););return O.resolve(o)}It(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const a=this.hr.get(i.largestBatchId).delete(r.key);this.hr.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new U$(n,r));let s=this.hr.get(n);s===void 0&&(s=ce(),this.hr.set(n,s)),this.hr.set(n,s.add(r.key))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yv{constructor(){this.Pr=new Ft(ut.Ir),this.Tr=new Ft(ut.Er)}isEmpty(){return this.Pr.isEmpty()}addReference(e,n){const r=new ut(e,n);this.Pr=this.Pr.add(r),this.Tr=this.Tr.add(r)}dr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Ar(new ut(e,n))}Rr(e,n){e.forEach(r=>this.removeReference(r,n))}Vr(e){const n=new K(new Ce([])),r=new ut(n,e),i=new ut(n,e+1),s=[];return this.Tr.forEachInRange([r,i],a=>{this.Ar(a),s.push(a.key)}),s}mr(){this.Pr.forEach(e=>this.Ar(e))}Ar(e){this.Pr=this.Pr.delete(e),this.Tr=this.Tr.delete(e)}gr(e){const n=new K(new Ce([])),r=new ut(n,e),i=new ut(n,e+1);let s=ce();return this.Tr.forEachInRange([r,i],a=>{s=s.add(a.key)}),s}containsKey(e){const n=new ut(e,0),r=this.Pr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class ut{constructor(e,n){this.key=e,this.pr=n}static Ir(e,n){return K.comparator(e.key,n.key)||ge(e.pr,n.pr)}static Er(e,n){return ge(e.pr,n.pr)||K.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x9{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.yr=1,this.wr=new Ft(ut.Ir)}checkEmpty(e){return O.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const s=this.yr;this.yr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new z$(s,n,r,i);this.mutationQueue.push(a);for(const o of i)this.wr=this.wr.add(new ut(o.key,s)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return O.resolve(a)}lookupMutationBatch(e,n){return O.resolve(this.Sr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.br(r),s=i<0?0:i;return O.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return O.resolve(this.mutationQueue.length===0?-1:this.yr-1)}getAllMutationBatches(e){return O.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new ut(n,0),i=new ut(n,Number.POSITIVE_INFINITY),s=[];return this.wr.forEachInRange([r,i],a=>{const o=this.Sr(a.pr);s.push(o)}),O.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Ft(ge);return n.forEach(i=>{const s=new ut(i,0),a=new ut(i,Number.POSITIVE_INFINITY);this.wr.forEachInRange([s,a],o=>{r=r.add(o.pr)})}),O.resolve(this.Dr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;K.isDocumentKey(s)||(s=s.child(""));const a=new ut(new K(s),0);let o=new Ft(ge);return this.wr.forEachWhile(l=>{const u=l.key.path;return!!r.isPrefixOf(u)&&(u.length===i&&(o=o.add(l.pr)),!0)},a),O.resolve(this.Dr(o))}Dr(e){const n=[];return e.forEach(r=>{const i=this.Sr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){Re(this.vr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.wr;return O.forEach(n.mutations,i=>{const s=new ut(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.wr=r})}Mn(e){}containsKey(e,n){const r=new ut(n,0),i=this.wr.firstAfterOrEqual(r);return O.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,O.resolve()}vr(e,n){return this.br(e)}br(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Sr(e){const n=this.br(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w9{constructor(e){this.Cr=e,this.docs=function(){return new $e(K.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,a=this.Cr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return O.resolve(r?r.document.mutableCopy():Ot.newInvalidDocument(n))}getEntries(e,n){let r=si();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Ot.newInvalidDocument(i))}),O.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=si();const a=n.path,o=new K(a.child("")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){const{key:u,value:{document:d}}=l.getNext();if(!a.isPrefixOf(u.path))break;u.path.length>a.length+1||a$(s$(d),r)<=0||(i.has(d.key)||kf(n,d))&&(s=s.insert(d.key,d.mutableCopy()))}return O.resolve(s)}getAllFromCollectionGroup(e,n,r,i){J()}Fr(e,n){return O.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new _9(this)}getSize(e){return O.resolve(this.size)}}class _9 extends m9{constructor(e){super(),this.ar=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.ar.addEntry(e,i)):this.ar.removeEntry(r)}),O.waitFor(n)}getFromCache(e,n){return this.ar.getEntry(e,n)}getAllFromCache(e,n){return this.ar.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E9{constructor(e){this.persistence=e,this.Mr=new Po(n=>Vv(n),Hv),this.lastRemoteSnapshotVersion=ee.min(),this.highestTargetId=0,this.Or=0,this.Nr=new Yv,this.targetCount=0,this.Br=oo.Nn()}forEachTarget(e,n){return this.Mr.forEach((r,i)=>n(i)),O.resolve()}getLastRemoteSnapshotVersion(e){return O.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return O.resolve(this.Or)}allocateTargetId(e){return this.highestTargetId=this.Br.next(),O.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Or&&(this.Or=n),O.resolve()}qn(e){this.Mr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.Br=new oo(n),this.highestTargetId=n),e.sequenceNumber>this.Or&&(this.Or=e.sequenceNumber)}addTargetData(e,n){return this.qn(n),this.targetCount+=1,O.resolve()}updateTargetData(e,n){return this.qn(n),O.resolve()}removeTargetData(e,n){return this.Mr.delete(n.target),this.Nr.Vr(n.targetId),this.targetCount-=1,O.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.Mr.forEach((a,o)=>{o.sequenceNumber<=n&&r.get(o.targetId)===null&&(this.Mr.delete(a),s.push(this.removeMatchingKeysForTargetId(e,o.targetId)),i++)}),O.waitFor(s).next(()=>i)}getTargetCount(e){return O.resolve(this.targetCount)}getTargetData(e,n){const r=this.Mr.get(n)||null;return O.resolve(r)}addMatchingKeys(e,n,r){return this.Nr.dr(n,r),O.resolve()}removeMatchingKeys(e,n,r){this.Nr.Rr(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(a=>{s.push(i.markPotentiallyOrphaned(e,a))}),O.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.Nr.Vr(n),O.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Nr.gr(n);return O.resolve(r)}containsKey(e,n){return O.resolve(this.Nr.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S9{constructor(e,n){this.Lr={},this.overlays={},this.kr=new $v(0),this.qr=!1,this.qr=!0,this.referenceDelegate=e(this),this.Qr=new E9(this),this.indexManager=new h9,this.remoteDocumentCache=function(i){return new w9(i)}(r=>this.referenceDelegate.Kr(r)),this.serializer=new u9(n),this.$r=new y9(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new v9,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.Lr[e.toKey()];return r||(r=new x9(n,this.referenceDelegate),this.Lr[e.toKey()]=r),r}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction(e,n,r){W("MemoryPersistence","Starting transaction:",e);const i=new k9(this.kr.next());return this.referenceDelegate.Ur(),r(i).next(s=>this.referenceDelegate.Wr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Gr(e,n){return O.or(Object.values(this.Lr).map(r=>()=>r.containsKey(e,n)))}}class k9 extends l${constructor(e){super(),this.currentSequenceNumber=e}}class Jv{constructor(e){this.persistence=e,this.zr=new Yv,this.jr=null}static Hr(e){return new Jv(e)}get Jr(){if(this.jr)return this.jr;throw J()}addReference(e,n,r){return this.zr.addReference(r,n),this.Jr.delete(r.toString()),O.resolve()}removeReference(e,n,r){return this.zr.removeReference(r,n),this.Jr.add(r.toString()),O.resolve()}markPotentiallyOrphaned(e,n){return this.Jr.add(n.toString()),O.resolve()}removeTarget(e,n){this.zr.Vr(n.targetId).forEach(i=>this.Jr.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.Jr.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}Ur(){this.jr=new Set}Wr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return O.forEach(this.Jr,r=>{const i=K.fromPath(r);return this.Yr(e,i).next(s=>{s||n.removeEntry(i,ee.min())})}).next(()=>(this.jr=null,n.apply(e)))}updateLimboDocument(e,n){return this.Yr(e,n).next(r=>{r?this.Jr.delete(n.toString()):this.Jr.add(n.toString())})}Kr(e){return 0}Yr(e,n){return O.or([()=>O.resolve(this.zr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Gr(e,n)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zv{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.qi=r,this.Qi=i}static Ki(e,n){let r=ce(),i=ce();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new Zv(e,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b9{constructor(){this.$i=!1}initialize(e,n){this.Ui=e,this.indexManager=n,this.$i=!0}getDocumentsMatchingQuery(e,n,r,i){return this.Wi(e,n).next(s=>s||this.Gi(e,n,i,r)).next(s=>s||this.zi(e,n))}Wi(e,n){if(U_(n))return O.resolve(null);let r=ii(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=Jd(n,null,"F"),r=ii(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const a=ce(...s);return this.Ui.getDocuments(e,a).next(o=>this.indexManager.getMinOffset(e,r).next(l=>{const u=this.ji(n,o);return this.Hi(n,u,a,l.readTime)?this.Wi(e,Jd(n,null,"F")):this.Ji(e,u,n,l)}))})))}Gi(e,n,r,i){return U_(n)||i.isEqual(ee.min())?this.zi(e,n):this.Ui.getDocuments(e,r).next(s=>{const a=this.ji(n,s);return this.Hi(n,a,r,i)?this.zi(e,n):(P_()<=pe.DEBUG&&W("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),g0(n)),this.Ji(e,a,n,i$(i,-1)))})}ji(e,n){let r=new Ft(rC(e));return n.forEach((i,s)=>{kf(e,s)&&(r=r.add(s))}),r}Hi(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}zi(e,n){return P_()<=pe.DEBUG&&W("QueryEngine","Using full collection scan to execute query:",g0(n)),this.Ui.getDocumentsMatchingQuery(e,n,qi.min())}Ji(e,n,r,i){return this.Ui.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(a=>{s=s.insert(a.key,a)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T9{constructor(e,n,r,i){this.persistence=e,this.Yi=n,this.serializer=i,this.Zi=new $e(ge),this.Xi=new Po(s=>Vv(s),Hv),this.es=new Map,this.ts=e.getRemoteDocumentCache(),this.Qr=e.getTargetCache(),this.$r=e.getBundleCache(),this.ns(r)}ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new g9(this.ts,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ts.setIndexManager(this.indexManager),this.Yi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Zi))}}function I9(t,e,n,r){return new T9(t,e,n,r)}async function kC(t,e){const n=ne(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.ns(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const a=[],o=[];let l=ce();for(const u of i){a.push(u.batchId);for(const d of u.mutations)l=l.add(d.key)}for(const u of s){o.push(u.batchId);for(const d of u.mutations)l=l.add(d.key)}return n.localDocuments.getDocuments(r,l).next(u=>({rs:u,removedBatchIds:a,addedBatchIds:o}))})})}function C9(t,e){const n=ne(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=n.ts.newChangeBuffer({trackRemovals:!0});return function(o,l,u,d){const h=u.batch,m=h.keys();let p=O.resolve();return m.forEach(g=>{p=p.next(()=>d.getEntry(l,g)).next(w=>{const E=u.docVersions.get(g);Re(E!==null),w.version.compareTo(E)<0&&(h.applyToRemoteDocument(w,u),w.isValidDocument()&&(w.setReadTime(u.commitVersion),d.addEntry(w)))})}),p.next(()=>o.mutationQueue.removeMutationBatch(l,h))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(o){let l=ce();for(let u=0;u<o.mutationResults.length;++u)o.mutationResults[u].transformResults.length>0&&(l=l.add(o.batch.mutations[u].key));return l}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function bC(t){const e=ne(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Qr.getLastRemoteSnapshotVersion(n))}function A9(t,e){const n=ne(t),r=e.snapshotVersion;let i=n.Zi;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const a=n.ts.newChangeBuffer({trackRemovals:!0});i=n.Zi;const o=[];e.targetChanges.forEach((d,h)=>{const m=i.get(h);if(!m)return;o.push(n.Qr.removeMatchingKeys(s,d.removedDocuments,h).next(()=>n.Qr.addMatchingKeys(s,d.addedDocuments,h)));let p=m.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(h)!==null?p=p.withResumeToken(Ut.EMPTY_BYTE_STRING,ee.min()).withLastLimboFreeSnapshotVersion(ee.min()):d.resumeToken.approximateByteSize()>0&&(p=p.withResumeToken(d.resumeToken,r)),i=i.insert(h,p),function(w,E,v){return w.resumeToken.approximateByteSize()===0||E.snapshotVersion.toMicroseconds()-w.snapshotVersion.toMicroseconds()>=3e8?!0:v.addedDocuments.size+v.modifiedDocuments.size+v.removedDocuments.size>0}(m,p,d)&&o.push(n.Qr.updateTargetData(s,p))});let l=si(),u=ce();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(s,d))}),o.push(R9(s,a,e.documentUpdates).next(d=>{l=d.ss,u=d.os})),!r.isEqual(ee.min())){const d=n.Qr.getLastRemoteSnapshotVersion(s).next(h=>n.Qr.setTargetsMetadata(s,s.currentSequenceNumber,r));o.push(d)}return O.waitFor(o).next(()=>a.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,l,u)).next(()=>l)}).then(s=>(n.Zi=i,s))}function R9(t,e,n){let r=ce(),i=ce();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let a=si();return n.forEach((o,l)=>{const u=s.get(o);l.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(o)),l.isNoDocument()&&l.version.isEqual(ee.min())?(e.removeEntry(o,l.readTime),a=a.insert(o,l)):!u.isValidDocument()||l.version.compareTo(u.version)>0||l.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(l),a=a.insert(o,l)):W("LocalStore","Ignoring outdated watch update for ",o,". Current version:",u.version," Watch version:",l.version)}),{ss:a,os:i}})}function P9(t,e){const n=ne(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function N9(t,e){const n=ne(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Qr.getTargetData(r,e).next(s=>s?(i=s,O.resolve(i)):n.Qr.allocateTargetId(r).next(a=>(i=new Ci(e,a,"TargetPurposeListen",r.currentSequenceNumber),n.Qr.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.Zi.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.Zi=n.Zi.insert(r.targetId,r),n.Xi.set(e,r.targetId)),r})}async function _0(t,e,n){const r=ne(t),i=r.Zi.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,a=>r.persistence.referenceDelegate.removeTarget(a,i))}catch(a){if(!Uc(a))throw a;W("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}r.Zi=r.Zi.remove(e),r.Xi.delete(i.target)}function J_(t,e,n){const r=ne(t);let i=ee.min(),s=ce();return r.persistence.runTransaction("Execute query","readonly",a=>function(l,u,d){const h=ne(l),m=h.Xi.get(d);return m!==void 0?O.resolve(h.Zi.get(m)):h.Qr.getTargetData(u,d)}(r,a,ii(e)).next(o=>{if(o)return i=o.lastLimboFreeSnapshotVersion,r.Qr.getMatchingKeysForTargetId(a,o.targetId).next(l=>{s=l})}).next(()=>r.Yi.getDocumentsMatchingQuery(a,e,n?i:ee.min(),n?s:ce())).next(o=>(j9(r,b$(e),o),{documents:o,_s:s})))}function j9(t,e,n){let r=t.es.get(e)||ee.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.es.set(e,r)}class Z_{constructor(){this.activeTargetIds=P$()}Is(e){this.activeTargetIds=this.activeTargetIds.add(e)}Ts(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ps(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class O9{constructor(){this.Ys=new Z_,this.Zs={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e){return this.Ys.Is(e),this.Zs[e]||"not-current"}updateQueryState(e,n,r){this.Zs[e]=n}removeLocalQueryTarget(e){this.Ys.Ts(e)}isLocalQueryTarget(e){return this.Ys.activeTargetIds.has(e)}clearQueryState(e){delete this.Zs[e]}getAllActiveQueryTargets(){return this.Ys.activeTargetIds}isActiveQueryTarget(e){return this.Ys.activeTargetIds.has(e)}start(){return this.Ys=new Z_,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D9{Xs(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eE{constructor(){this.eo=()=>this.no(),this.ro=()=>this.io(),this.so=[],this.oo()}Xs(e){this.so.push(e)}shutdown(){window.removeEventListener("online",this.eo),window.removeEventListener("offline",this.ro)}oo(){window.addEventListener("online",this.eo),window.addEventListener("offline",this.ro)}no(){W("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.so)e(0)}io(){W("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.so)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let _u=null;function up(){return _u===null?_u=function(){return 268435456+Math.round(2147483648*Math.random())}():_u++,"0x"+_u.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M9={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L9{constructor(e){this._o=e._o,this.ao=e.ao}uo(e){this.co=e}lo(e){this.ho=e}onMessage(e){this.Po=e}close(){this.ao()}send(e){this._o(e)}Io(){this.co()}To(e){this.ho(e)}Eo(e){this.Po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rt="WebChannelConnection";class F9 extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Ao=r+"://"+n.host,this.Ro=`projects/${i}/databases/${s}`,this.Vo=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get mo(){return!1}fo(n,r,i,s,a){const o=up(),l=this.po(n,r);W("RestConnection",`Sending RPC '${n}' ${o}:`,l,i);const u={"google-cloud-resource-prefix":this.Ro,"x-goog-request-params":this.Vo};return this.yo(u,s,a),this.wo(n,l,u,i).then(d=>(W("RestConnection",`Received RPC '${n}' ${o}: `,d),d),d=>{throw ro("RestConnection",`RPC '${n}' ${o} failed with error: `,d,"url: ",l,"request:",i),d})}So(n,r,i,s,a,o){return this.fo(n,r,i,s,a)}yo(n,r,i){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Ao}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,a)=>n[a]=s),i&&i.headers.forEach((s,a)=>n[a]=s)}po(n,r){const i=M9[n];return`${this.Ao}/v1/${r}:${i}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}wo(e,n,r,i){const s=up();return new Promise((a,o)=>{const l=new GF;l.setWithCredentials(!0),l.listenOnce(WF.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case lp.NO_ERROR:const d=l.getResponseJson();W(Rt,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(d)),a(d);break;case lp.TIMEOUT:W(Rt,`RPC '${e}' ${s} timed out`),o(new z(R.DEADLINE_EXCEEDED,"Request time out"));break;case lp.HTTP_ERROR:const h=l.getStatus();if(W(Rt,`RPC '${e}' ${s} failed with status:`,h,"response text:",l.getResponseText()),h>0){let m=l.getResponseJson();Array.isArray(m)&&(m=m[0]);const p=m==null?void 0:m.error;if(p&&p.status&&p.message){const g=function(E){const v=E.toLowerCase().replace(/_/g,"-");return Object.values(R).indexOf(v)>=0?v:R.UNKNOWN}(p.status);o(new z(g,p.message))}else o(new z(R.UNKNOWN,"Server responded with status "+l.getStatus()))}else o(new z(R.UNAVAILABLE,"Connection failed."));break;default:J()}}finally{W(Rt,`RPC '${e}' ${s} completed.`)}});const u=JSON.stringify(i);W(Rt,`RPC '${e}' ${s} sending request:`,i),l.send(n,"POST",u,r,15)})}bo(e,n,r){const i=up(),s=[this.Ao,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=VF(),o=HF(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(l.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(l.useFetchStreams=!0),this.yo(l.initMessageHeaders,n,r),l.encodeInitMessageHeaders=!0;const d=s.join("");W(Rt,`Creating RPC '${e}' stream ${i}: ${d}`,l);const h=a.createWebChannel(d,l);let m=!1,p=!1;const g=new L9({_o:E=>{p?W(Rt,`Not sending because RPC '${e}' stream ${i} is closed:`,E):(m||(W(Rt,`Opening RPC '${e}' stream ${i} transport.`),h.open(),m=!0),W(Rt,`RPC '${e}' stream ${i} sending:`,E),h.send(E))},ao:()=>h.close()}),w=(E,v,y)=>{E.listen(v,x=>{try{y(x)}catch(_){setTimeout(()=>{throw _},0)}})};return w(h,vu.EventType.OPEN,()=>{p||W(Rt,`RPC '${e}' stream ${i} transport opened.`)}),w(h,vu.EventType.CLOSE,()=>{p||(p=!0,W(Rt,`RPC '${e}' stream ${i} transport closed`),g.To())}),w(h,vu.EventType.ERROR,E=>{p||(p=!0,ro(Rt,`RPC '${e}' stream ${i} transport errored:`,E),g.To(new z(R.UNAVAILABLE,"The operation could not be completed")))}),w(h,vu.EventType.MESSAGE,E=>{var v;if(!p){const y=E.data[0];Re(!!y);const x=y,_=x.error||((v=x[0])===null||v===void 0?void 0:v.error);if(_){W(Rt,`RPC '${e}' stream ${i} received error:`,_);const S=_.status;let k=function(P){const N=Ye[P];if(N!==void 0)return pC(N)}(S),b=_.message;k===void 0&&(k=R.INTERNAL,b="Unknown error status: "+S+" with message "+_.message),p=!0,g.To(new z(k,b)),h.close()}else W(Rt,`RPC '${e}' stream ${i} received:`,y),g.Eo(y)}}),w(o,qF.STAT_EVENT,E=>{E.stat===A_.PROXY?W(Rt,`RPC '${e}' stream ${i} detected buffering proxy`):E.stat===A_.NOPROXY&&W(Rt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{g.Io()},0),g}}function dp(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cf(t){return new X$(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TC{constructor(e,n,r=1e3,i=1.5,s=6e4){this.oi=e,this.timerId=n,this.Do=r,this.vo=i,this.Co=s,this.Fo=0,this.Mo=null,this.xo=Date.now(),this.reset()}reset(){this.Fo=0}Oo(){this.Fo=this.Co}No(e){this.cancel();const n=Math.floor(this.Fo+this.Bo()),r=Math.max(0,Date.now()-this.xo),i=Math.max(0,n-r);i>0&&W("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Fo} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.Mo=this.oi.enqueueAfterDelay(this.timerId,i,()=>(this.xo=Date.now(),e())),this.Fo*=this.vo,this.Fo<this.Do&&(this.Fo=this.Do),this.Fo>this.Co&&(this.Fo=this.Co)}Lo(){this.Mo!==null&&(this.Mo.skipDelay(),this.Mo=null)}cancel(){this.Mo!==null&&(this.Mo.cancel(),this.Mo=null)}Bo(){return(Math.random()-.5)*this.Fo}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IC{constructor(e,n,r,i,s,a,o,l){this.oi=e,this.ko=r,this.qo=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.Qo=0,this.Ko=null,this.$o=null,this.stream=null,this.Uo=new TC(e,n)}Wo(){return this.state===1||this.state===5||this.Go()}Go(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.zo()}async stop(){this.Wo()&&await this.close(0)}jo(){this.state=0,this.Uo.reset()}Ho(){this.Go()&&this.Ko===null&&(this.Ko=this.oi.enqueueAfterDelay(this.ko,6e4,()=>this.Jo()))}Yo(e){this.Zo(),this.stream.send(e)}async Jo(){if(this.Go())return this.close(0)}Zo(){this.Ko&&(this.Ko.cancel(),this.Ko=null)}Xo(){this.$o&&(this.$o.cancel(),this.$o=null)}async close(e,n){this.Zo(),this.Xo(),this.Uo.cancel(),this.Qo++,e!==4?this.Uo.reset():n&&n.code===R.RESOURCE_EXHAUSTED?(ri(n.toString()),ri("Using maximum backoff delay to prevent overloading the backend."),this.Uo.Oo()):n&&n.code===R.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.e_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.lo(n)}e_(){}auth(){this.state=1;const e=this.t_(this.Qo),n=this.Qo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Qo===n&&this.n_(r,i)},r=>{e(()=>{const i=new z(R.UNKNOWN,"Fetching auth token failed: "+r.message);return this.r_(i)})})}n_(e,n){const r=this.t_(this.Qo);this.stream=this.i_(e,n),this.stream.uo(()=>{r(()=>(this.state=2,this.$o=this.oi.enqueueAfterDelay(this.qo,1e4,()=>(this.Go()&&(this.state=3),Promise.resolve())),this.listener.uo()))}),this.stream.lo(i=>{r(()=>this.r_(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}zo(){this.state=5,this.Uo.No(async()=>{this.state=0,this.start()})}r_(e){return W("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}t_(e){return n=>{this.oi.enqueueAndForget(()=>this.Qo===e?n():(W("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class $9 extends IC{constructor(e,n,r,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,a),this.serializer=s}i_(e,n){return this.connection.bo("Listen",e,n)}onMessage(e){this.Uo.reset();const n=Z$(this.serializer,e),r=function(s){if(!("targetChange"in s))return ee.min();const a=s.targetChange;return a.targetIds&&a.targetIds.length?ee.min():a.readTime?br(a.readTime):ee.min()}(e);return this.listener.s_(n,r)}o_(e){const n={};n.database=w0(this.serializer),n.addTarget=function(s,a){let o;const l=a.target;if(o=m0(l)?{documents:n9(s,l)}:{query:r9(s,l)},o.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){o.resumeToken=vC(s,a.resumeToken);const u=y0(s,a.expectedCount);u!==null&&(o.expectedCount=u)}else if(a.snapshotVersion.compareTo(ee.min())>0){o.readTime=th(s,a.snapshotVersion.toTimestamp());const u=y0(s,a.expectedCount);u!==null&&(o.expectedCount=u)}return o}(this.serializer,e);const r=s9(this.serializer,e);r&&(n.labels=r),this.Yo(n)}__(e){const n={};n.database=w0(this.serializer),n.removeTarget=e,this.Yo(n)}}class z9 extends IC{constructor(e,n,r,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,a),this.serializer=s,this.a_=!1}get u_(){return this.a_}start(){this.a_=!1,this.lastStreamToken=void 0,super.start()}e_(){this.a_&&this.c_([])}i_(e,n){return this.connection.bo("Write",e,n)}onMessage(e){if(Re(!!e.streamToken),this.lastStreamToken=e.streamToken,this.a_){this.Uo.reset();const n=t9(e.writeResults,e.commitTime),r=br(e.commitTime);return this.listener.l_(r,n)}return Re(!e.writeResults||e.writeResults.length===0),this.a_=!0,this.listener.h_()}P_(){const e={};e.database=w0(this.serializer),this.Yo(e)}c_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>e9(this.serializer,r))};this.Yo(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U9 extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.I_=!1}T_(){if(this.I_)throw new z(R.FAILED_PRECONDITION,"The client has already been terminated.")}fo(e,n,r){return this.T_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,s])=>this.connection.fo(e,n,r,i,s)).catch(i=>{throw i.name==="FirebaseError"?(i.code===R.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new z(R.UNKNOWN,i.toString())})}So(e,n,r,i){return this.T_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.So(e,n,r,s,a,i)).catch(s=>{throw s.name==="FirebaseError"?(s.code===R.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new z(R.UNKNOWN,s.toString())})}terminate(){this.I_=!0}}class B9{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.d_=0,this.A_=null,this.R_=!0}V_(){this.d_===0&&(this.m_("Unknown"),this.A_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.A_=null,this.f_("Backend didn't respond within 10 seconds."),this.m_("Offline"),Promise.resolve())))}g_(e){this.state==="Online"?this.m_("Unknown"):(this.d_++,this.d_>=1&&(this.p_(),this.f_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.m_("Offline")))}set(e){this.p_(),this.d_=0,e==="Online"&&(this.R_=!1),this.m_(e)}m_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}f_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.R_?(ri(n),this.R_=!1):W("OnlineStateTracker",n)}p_(){this.A_!==null&&(this.A_.cancel(),this.A_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V9{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.y_=[],this.w_=new Map,this.S_=new Set,this.b_=[],this.D_=s,this.D_.Xs(a=>{r.enqueueAndForget(async()=>{na(this)&&(W("RemoteStore","Restarting streams for network reachability change."),await async function(l){const u=ne(l);u.S_.add(4),await Wc(u),u.v_.set("Unknown"),u.S_.delete(4),await Af(u)}(this))})}),this.v_=new B9(r,i)}}async function Af(t){if(na(t))for(const e of t.b_)await e(!0)}async function Wc(t){for(const e of t.b_)await e(!1)}function CC(t,e){const n=ne(t);n.w_.has(e.targetId)||(n.w_.set(e.targetId,e),n1(n)?t1(n):No(n).Go()&&e1(n,e))}function AC(t,e){const n=ne(t),r=No(n);n.w_.delete(e),r.Go()&&RC(n,e),n.w_.size===0&&(r.Go()?r.Ho():na(n)&&n.v_.set("Unknown"))}function e1(t,e){if(t.C_.Le(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ee.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}No(t).o_(e)}function RC(t,e){t.C_.Le(e),No(t).__(e)}function t1(t){t.C_=new q$({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),lt:e=>t.w_.get(e)||null,st:()=>t.datastore.serializer.databaseId}),No(t).start(),t.v_.V_()}function n1(t){return na(t)&&!No(t).Wo()&&t.w_.size>0}function na(t){return ne(t).S_.size===0}function PC(t){t.C_=void 0}async function H9(t){t.w_.forEach((e,n)=>{e1(t,e)})}async function W9(t,e){PC(t),n1(t)?(t.v_.g_(e),t1(t)):t.v_.set("Unknown")}async function q9(t,e,n){if(t.v_.set("Online"),e instanceof yC&&e.state===2&&e.cause)try{await async function(i,s){const a=s.cause;for(const o of s.targetIds)i.w_.has(o)&&(await i.remoteSyncer.rejectListen(o,a),i.w_.delete(o),i.C_.removeTarget(o))}(t,e)}catch(r){W("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await nh(t,r)}else if(e instanceof nd?t.C_.Ge(e):e instanceof gC?t.C_.Xe(e):t.C_.He(e),!n.isEqual(ee.min()))try{const r=await bC(t.localStore);n.compareTo(r)>=0&&await function(s,a){const o=s.C_._t(a);return o.targetChanges.forEach((l,u)=>{if(l.resumeToken.approximateByteSize()>0){const d=s.w_.get(u);d&&s.w_.set(u,d.withResumeToken(l.resumeToken,a))}}),o.targetMismatches.forEach((l,u)=>{const d=s.w_.get(l);if(!d)return;s.w_.set(l,d.withResumeToken(Ut.EMPTY_BYTE_STRING,d.snapshotVersion)),RC(s,l);const h=new Ci(d.target,l,u,d.sequenceNumber);e1(s,h)}),s.remoteSyncer.applyRemoteEvent(o)}(t,n)}catch(r){W("RemoteStore","Failed to raise snapshot:",r),await nh(t,r)}}async function nh(t,e,n){if(!Uc(e))throw e;t.S_.add(1),await Wc(t),t.v_.set("Offline"),n||(n=()=>bC(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{W("RemoteStore","Retrying IndexedDB access"),await n(),t.S_.delete(1),await Af(t)})}function NC(t,e){return e().catch(n=>nh(t,n,e))}async function Rf(t){const e=ne(t),n=Ki(e);let r=e.y_.length>0?e.y_[e.y_.length-1].batchId:-1;for(;G9(e);)try{const i=await P9(e.localStore,r);if(i===null){e.y_.length===0&&n.Ho();break}r=i.batchId,K9(e,i)}catch(i){await nh(e,i)}jC(e)&&OC(e)}function G9(t){return na(t)&&t.y_.length<10}function K9(t,e){t.y_.push(e);const n=Ki(t);n.Go()&&n.u_&&n.c_(e.mutations)}function jC(t){return na(t)&&!Ki(t).Wo()&&t.y_.length>0}function OC(t){Ki(t).start()}async function Q9(t){Ki(t).P_()}async function X9(t){const e=Ki(t);for(const n of t.y_)e.c_(n.mutations)}async function Y9(t,e,n){const r=t.y_.shift(),i=Kv.from(r,e,n);await NC(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await Rf(t)}async function J9(t,e){e&&Ki(t).u_&&await async function(r,i){if(function(a){return V$(a)&&a!==R.ABORTED}(i.code)){const s=r.y_.shift();Ki(r).jo(),await NC(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await Rf(r)}}(t,e),jC(t)&&OC(t)}async function tE(t,e){const n=ne(t);n.asyncQueue.verifyOperationInProgress(),W("RemoteStore","RemoteStore received new credentials");const r=na(n);n.S_.add(3),await Wc(n),r&&n.v_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.S_.delete(3),await Af(n)}async function Z9(t,e){const n=ne(t);e?(n.S_.delete(2),await Af(n)):e||(n.S_.add(2),await Wc(n),n.v_.set("Unknown"))}function No(t){return t.F_||(t.F_=function(n,r,i){const s=ne(n);return s.T_(),new $9(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{uo:H9.bind(null,t),lo:W9.bind(null,t),s_:q9.bind(null,t)}),t.b_.push(async e=>{e?(t.F_.jo(),n1(t)?t1(t):t.v_.set("Unknown")):(await t.F_.stop(),PC(t))})),t.F_}function Ki(t){return t.M_||(t.M_=function(n,r,i){const s=ne(n);return s.T_(),new z9(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{uo:Q9.bind(null,t),lo:J9.bind(null,t),h_:X9.bind(null,t),l_:Y9.bind(null,t)}),t.b_.push(async e=>{e?(t.M_.jo(),await Rf(t)):(await t.M_.stop(),t.y_.length>0&&(W("RemoteStore",`Stopping write stream with ${t.y_.length} pending writes`),t.y_=[]))})),t.M_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r1{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Qr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}static createAndSchedule(e,n,r,i,s){const a=Date.now()+r,o=new r1(e,n,a,i,s);return o.start(r),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new z(R.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function i1(t,e){if(ri("AsyncQueue",`${e}: ${t}`),Uc(t))return new z(R.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $a{constructor(e){this.comparator=e?(n,r)=>e(n,r)||K.comparator(n.key,r.key):(n,r)=>K.comparator(n.key,r.key),this.keyedMap=ol(),this.sortedSet=new $e(this.comparator)}static emptySet(e){return new $a(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof $a)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new $a;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nE{constructor(){this.x_=new $e(K.comparator)}track(e){const n=e.doc.key,r=this.x_.get(n);r?e.type!==0&&r.type===3?this.x_=this.x_.insert(n,e):e.type===3&&r.type!==1?this.x_=this.x_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.x_=this.x_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.x_=this.x_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.x_=this.x_.remove(n):e.type===1&&r.type===2?this.x_=this.x_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.x_=this.x_.insert(n,{type:2,doc:e.doc}):J():this.x_=this.x_.insert(n,e)}O_(){const e=[];return this.x_.inorderTraversal((n,r)=>{e.push(r)}),e}}class lo{constructor(e,n,r,i,s,a,o,l,u){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=u}static fromInitialDocuments(e,n,r,i,s){const a=[];return n.forEach(o=>{a.push({type:0,doc:o})}),new lo(e,n,$a.emptySet(n),a,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Sf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e8{constructor(){this.N_=void 0,this.listeners=[]}}class t8{constructor(){this.queries=new Po(e=>nC(e),Sf),this.onlineState="Unknown",this.B_=new Set}}async function DC(t,e){const n=ne(t),r=e.query;let i=!1,s=n.queries.get(r);if(s||(i=!0,s=new e8),i)try{s.N_=await n.onListen(r)}catch(a){const o=i1(a,`Initialization of query '${g0(e.query)}' failed`);return void e.onError(o)}n.queries.set(r,s),s.listeners.push(e),e.L_(n.onlineState),s.N_&&e.k_(s.N_)&&s1(n)}async function MC(t,e){const n=ne(t),r=e.query;let i=!1;const s=n.queries.get(r);if(s){const a=s.listeners.indexOf(e);a>=0&&(s.listeners.splice(a,1),i=s.listeners.length===0)}if(i)return n.queries.delete(r),n.onUnlisten(r)}function n8(t,e){const n=ne(t);let r=!1;for(const i of e){const s=i.query,a=n.queries.get(s);if(a){for(const o of a.listeners)o.k_(i)&&(r=!0);a.N_=i}}r&&s1(n)}function r8(t,e,n){const r=ne(t),i=r.queries.get(e);if(i)for(const s of i.listeners)s.onError(n);r.queries.delete(e)}function s1(t){t.B_.forEach(e=>{e.next()})}class LC{constructor(e,n,r){this.query=e,this.q_=n,this.Q_=!1,this.K_=null,this.onlineState="Unknown",this.options=r||{}}k_(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new lo(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Q_?this.U_(e)&&(this.q_.next(e),n=!0):this.W_(e,this.onlineState)&&(this.G_(e),n=!0),this.K_=e,n}onError(e){this.q_.error(e)}L_(e){this.onlineState=e;let n=!1;return this.K_&&!this.Q_&&this.W_(this.K_,e)&&(this.G_(this.K_),n=!0),n}W_(e,n){if(!e.fromCache)return!0;const r=n!=="Offline";return(!this.options.z_||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}U_(e){if(e.docChanges.length>0)return!0;const n=this.K_&&this.K_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}G_(e){e=lo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Q_=!0,this.q_.next(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FC{constructor(e){this.key=e}}class $C{constructor(e){this.key=e}}class i8{constructor(e,n){this.query=e,this.ta=n,this.na=null,this.hasCachedResults=!1,this.current=!1,this.ra=ce(),this.mutatedKeys=ce(),this.ia=rC(e),this.sa=new $a(this.ia)}get oa(){return this.ta}_a(e,n){const r=n?n.aa:new nE,i=n?n.sa:this.sa;let s=n?n.mutatedKeys:this.mutatedKeys,a=i,o=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((d,h)=>{const m=i.get(d),p=kf(this.query,h)?h:null,g=!!m&&this.mutatedKeys.has(m.key),w=!!p&&(p.hasLocalMutations||this.mutatedKeys.has(p.key)&&p.hasCommittedMutations);let E=!1;m&&p?m.data.isEqual(p.data)?g!==w&&(r.track({type:3,doc:p}),E=!0):this.ua(m,p)||(r.track({type:2,doc:p}),E=!0,(l&&this.ia(p,l)>0||u&&this.ia(p,u)<0)&&(o=!0)):!m&&p?(r.track({type:0,doc:p}),E=!0):m&&!p&&(r.track({type:1,doc:m}),E=!0,(l||u)&&(o=!0)),E&&(p?(a=a.add(p),s=w?s.add(d):s.delete(d)):(a=a.delete(d),s=s.delete(d)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const d=this.query.limitType==="F"?a.last():a.first();a=a.delete(d.key),s=s.delete(d.key),r.track({type:1,doc:d})}return{sa:a,aa:r,Hi:o,mutatedKeys:s}}ua(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r){const i=this.sa;this.sa=e.sa,this.mutatedKeys=e.mutatedKeys;const s=e.aa.O_();s.sort((u,d)=>function(m,p){const g=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return J()}};return g(m)-g(p)}(u.type,d.type)||this.ia(u.doc,d.doc)),this.ca(r);const a=n?this.la():[],o=this.ra.size===0&&this.current?1:0,l=o!==this.na;return this.na=o,s.length!==0||l?{snapshot:new lo(this.query,e.sa,i,s,e.mutatedKeys,o===0,l,!1,!!r&&r.resumeToken.approximateByteSize()>0),ha:a}:{ha:a}}L_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({sa:this.sa,aa:new nE,mutatedKeys:this.mutatedKeys,Hi:!1},!1)):{ha:[]}}Pa(e){return!this.ta.has(e)&&!!this.sa.has(e)&&!this.sa.get(e).hasLocalMutations}ca(e){e&&(e.addedDocuments.forEach(n=>this.ta=this.ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.ta=this.ta.delete(n)),this.current=e.current)}la(){if(!this.current)return[];const e=this.ra;this.ra=ce(),this.sa.forEach(r=>{this.Pa(r.key)&&(this.ra=this.ra.add(r.key))});const n=[];return e.forEach(r=>{this.ra.has(r)||n.push(new $C(r))}),this.ra.forEach(r=>{e.has(r)||n.push(new FC(r))}),n}Ia(e){this.ta=e._s,this.ra=ce();const n=this._a(e.documents);return this.applyChanges(n,!0)}Ta(){return lo.fromInitialDocuments(this.query,this.sa,this.mutatedKeys,this.na===0,this.hasCachedResults)}}class s8{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class a8{constructor(e){this.key=e,this.Ea=!1}}class o8{constructor(e,n,r,i,s,a){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.da={},this.Aa=new Po(o=>nC(o),Sf),this.Ra=new Map,this.Va=new Set,this.ma=new $e(K.comparator),this.fa=new Map,this.ga=new Yv,this.pa={},this.ya=new Map,this.wa=oo.Bn(),this.onlineState="Unknown",this.Sa=void 0}get isPrimaryClient(){return this.Sa===!0}}async function l8(t,e){const n=v8(t);let r,i;const s=n.Aa.get(e);if(s)r=s.targetId,n.sharedClientState.addLocalQueryTarget(r),i=s.view.Ta();else{const a=await N9(n.localStore,ii(e)),o=n.sharedClientState.addLocalQueryTarget(a.targetId);r=a.targetId,i=await c8(n,e,r,o==="current",a.resumeToken),n.isPrimaryClient&&CC(n.remoteStore,a)}return i}async function c8(t,e,n,r,i){t.ba=(h,m,p)=>async function(w,E,v,y){let x=E.view._a(v);x.Hi&&(x=await J_(w.localStore,E.query,!1).then(({documents:k})=>E.view._a(k,x)));const _=y&&y.targetChanges.get(E.targetId),S=E.view.applyChanges(x,w.isPrimaryClient,_);return iE(w,E.targetId,S.ha),S.snapshot}(t,h,m,p);const s=await J_(t.localStore,e,!0),a=new i8(e,s._s),o=a._a(s.documents),l=Hc.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),u=a.applyChanges(o,t.isPrimaryClient,l);iE(t,n,u.ha);const d=new s8(e,n,a);return t.Aa.set(e,d),t.Ra.has(n)?t.Ra.get(n).push(e):t.Ra.set(n,[e]),u.snapshot}async function u8(t,e){const n=ne(t),r=n.Aa.get(e),i=n.Ra.get(r.targetId);if(i.length>1)return n.Ra.set(r.targetId,i.filter(s=>!Sf(s,e))),void n.Aa.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||await _0(n.localStore,r.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(r.targetId),AC(n.remoteStore,r.targetId),E0(n,r.targetId)}).catch(zc)):(E0(n,r.targetId),await _0(n.localStore,r.targetId,!0))}async function d8(t,e,n){const r=x8(t);try{const i=await function(a,o){const l=ne(a),u=at.now(),d=o.reduce((p,g)=>p.add(g.key),ce());let h,m;return l.persistence.runTransaction("Locally write mutations","readwrite",p=>{let g=si(),w=ce();return l.ts.getEntries(p,d).next(E=>{g=E,g.forEach((v,y)=>{y.isValidDocument()||(w=w.add(v))})}).next(()=>l.localDocuments.getOverlayedDocuments(p,g)).next(E=>{h=E;const v=[];for(const y of o){const x=F$(y,h.get(y.key).overlayedDocument);x!=null&&v.push(new ta(y.key,x,GI(x.value.mapValue),kr.exists(!0)))}return l.mutationQueue.addMutationBatch(p,u,v,o)}).next(E=>{m=E;const v=E.applyToLocalDocumentSet(h,w);return l.documentOverlayCache.saveOverlays(p,E.batchId,v)})}).then(()=>({batchId:m.batchId,changes:sC(h)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(a,o,l){let u=a.pa[a.currentUser.toKey()];u||(u=new $e(ge)),u=u.insert(o,l),a.pa[a.currentUser.toKey()]=u}(r,i.batchId,n),await qc(r,i.changes),await Rf(r.remoteStore)}catch(i){const s=i1(i,"Failed to persist write");n.reject(s)}}async function zC(t,e){const n=ne(t);try{const r=await A9(n.localStore,e);e.targetChanges.forEach((i,s)=>{const a=n.fa.get(s);a&&(Re(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?a.Ea=!0:i.modifiedDocuments.size>0?Re(a.Ea):i.removedDocuments.size>0&&(Re(a.Ea),a.Ea=!1))}),await qc(n,r,e)}catch(r){await zc(r)}}function rE(t,e,n){const r=ne(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Aa.forEach((s,a)=>{const o=a.view.L_(e);o.snapshot&&i.push(o.snapshot)}),function(a,o){const l=ne(a);l.onlineState=o;let u=!1;l.queries.forEach((d,h)=>{for(const m of h.listeners)m.L_(o)&&(u=!0)}),u&&s1(l)}(r.eventManager,e),i.length&&r.da.s_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function h8(t,e,n){const r=ne(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.fa.get(e),s=i&&i.key;if(s){let a=new $e(K.comparator);a=a.insert(s,Ot.newNoDocument(s,ee.min()));const o=ce().add(s),l=new If(ee.min(),new Map,new $e(ge),a,o);await zC(r,l),r.ma=r.ma.remove(s),r.fa.delete(e),a1(r)}else await _0(r.localStore,e,!1).then(()=>E0(r,e,n)).catch(zc)}async function f8(t,e){const n=ne(t),r=e.batch.batchId;try{const i=await C9(n.localStore,e);BC(n,r,null),UC(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await qc(n,i)}catch(i){await zc(i)}}async function m8(t,e,n){const r=ne(t);try{const i=await function(a,o){const l=ne(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let d;return l.mutationQueue.lookupMutationBatch(u,o).next(h=>(Re(h!==null),d=h.keys(),l.mutationQueue.removeMutationBatch(u,h))).next(()=>l.mutationQueue.performConsistencyCheck(u)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(u,d,o)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,d)).next(()=>l.localDocuments.getDocuments(u,d))})}(r.localStore,e);BC(r,e,n),UC(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await qc(r,i)}catch(i){await zc(i)}}function UC(t,e){(t.ya.get(e)||[]).forEach(n=>{n.resolve()}),t.ya.delete(e)}function BC(t,e,n){const r=ne(t);let i=r.pa[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.pa[r.currentUser.toKey()]=i}}function E0(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ra.get(e))t.Aa.delete(r),n&&t.da.Da(r,n);t.Ra.delete(e),t.isPrimaryClient&&t.ga.Vr(e).forEach(r=>{t.ga.containsKey(r)||VC(t,r)})}function VC(t,e){t.Va.delete(e.path.canonicalString());const n=t.ma.get(e);n!==null&&(AC(t.remoteStore,n),t.ma=t.ma.remove(e),t.fa.delete(n),a1(t))}function iE(t,e,n){for(const r of n)r instanceof FC?(t.ga.addReference(r.key,e),p8(t,r)):r instanceof $C?(W("SyncEngine","Document no longer in limbo: "+r.key),t.ga.removeReference(r.key,e),t.ga.containsKey(r.key)||VC(t,r.key)):J()}function p8(t,e){const n=e.key,r=n.path.canonicalString();t.ma.get(n)||t.Va.has(r)||(W("SyncEngine","New document in limbo: "+n),t.Va.add(r),a1(t))}function a1(t){for(;t.Va.size>0&&t.ma.size<t.maxConcurrentLimboResolutions;){const e=t.Va.values().next().value;t.Va.delete(e);const n=new K(Ce.fromString(e)),r=t.wa.next();t.fa.set(r,new a8(n)),t.ma=t.ma.insert(n,r),CC(t.remoteStore,new Ci(ii(Wv(n.path)),r,"TargetPurposeLimboResolution",$v.ae))}}async function qc(t,e,n){const r=ne(t),i=[],s=[],a=[];r.Aa.isEmpty()||(r.Aa.forEach((o,l)=>{a.push(r.ba(l,e,n).then(u=>{if((u||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(l.targetId,u!=null&&u.fromCache?"not-current":"current"),u){i.push(u);const d=Zv.Ki(l.targetId,u);s.push(d)}}))}),await Promise.all(a),r.da.s_(i),await async function(l,u){const d=ne(l);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>O.forEach(u,m=>O.forEach(m.qi,p=>d.persistence.referenceDelegate.addReference(h,m.targetId,p)).next(()=>O.forEach(m.Qi,p=>d.persistence.referenceDelegate.removeReference(h,m.targetId,p)))))}catch(h){if(!Uc(h))throw h;W("LocalStore","Failed to update sequence numbers: "+h)}for(const h of u){const m=h.targetId;if(!h.fromCache){const p=d.Zi.get(m),g=p.snapshotVersion,w=p.withLastLimboFreeSnapshotVersion(g);d.Zi=d.Zi.insert(m,w)}}}(r.localStore,s))}async function g8(t,e){const n=ne(t);if(!n.currentUser.isEqual(e)){W("SyncEngine","User change. New user:",e.toKey());const r=await kC(n.localStore,e);n.currentUser=e,function(s,a){s.ya.forEach(o=>{o.forEach(l=>{l.reject(new z(R.CANCELLED,a))})}),s.ya.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await qc(n,r.rs)}}function y8(t,e){const n=ne(t),r=n.fa.get(e);if(r&&r.Ea)return ce().add(r.key);{let i=ce();const s=n.Ra.get(e);if(!s)return i;for(const a of s){const o=n.Aa.get(a);i=i.unionWith(o.view.oa)}return i}}function v8(t){const e=ne(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=zC.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=y8.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=h8.bind(null,e),e.da.s_=n8.bind(null,e.eventManager),e.da.Da=r8.bind(null,e.eventManager),e}function x8(t){const e=ne(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=f8.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=m8.bind(null,e),e}class sE{constructor(){this.synchronizeTabs=!1}async initialize(e){this.serializer=Cf(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,n){return null}createIndexBackfillerScheduler(e,n){return null}createLocalStore(e){return I9(this.persistence,new b9,e.initialUser,this.serializer)}createPersistence(e){return new S9(Jv.Hr,this.serializer)}createSharedClientState(e){return new O9}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class w8{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>rE(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=g8.bind(null,this.syncEngine),await Z9(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new t8}()}createDatastore(e){const n=Cf(e.databaseInfo.databaseId),r=function(s){return new F9(s)}(e.databaseInfo);return function(s,a,o,l){return new U9(s,a,o,l)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,a,o){return new V9(r,i,s,a,o)}(this.localStore,this.datastore,e.asyncQueue,n=>rE(this.syncEngine,n,0),function(){return eE.v()?new eE:new D9}())}createSyncEngine(e,n){return function(i,s,a,o,l,u,d){const h=new o8(i,s,a,o,l,u);return d&&(h.Sa=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}terminate(){return async function(n){const r=ne(n);W("RemoteStore","RemoteStore shutting down."),r.S_.add(5),await Wc(r),r.D_.shutdown(),r.v_.set("Unknown")}(this.remoteStore)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HC{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Fa(this.observer.next,e)}error(e){this.observer.error?this.Fa(this.observer.error,e):ri("Uncaught Error in snapshot listener:",e.toString())}Ma(){this.muted=!0}Fa(e,n){this.muted||setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _8{constructor(e,n,r,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=Nt.UNAUTHENTICATED,this.clientId=HI.V(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,async s=>{W("FirestoreClient","Received user=",s.uid),await this.authCredentialListener(s),this.user=s}),this.appCheckCredentials.start(r,s=>(W("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new z(R.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Qr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=i1(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function hp(t,e){t.asyncQueue.verifyOperationInProgress(),W("FirestoreClient","Initializing OfflineComponentProvider");const n=await t.getConfiguration();await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async i=>{r.isEqual(i)||(await kC(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function aE(t,e){t.asyncQueue.verifyOperationInProgress();const n=await S8(t);W("FirestoreClient","Initializing OnlineComponentProvider");const r=await t.getConfiguration();await e.initialize(n,r),t.setCredentialChangeListener(i=>tE(e.remoteStore,i)),t.setAppCheckTokenChangeListener((i,s)=>tE(e.remoteStore,s)),t._onlineComponents=e}function E8(t){return t.name==="FirebaseError"?t.code===R.FAILED_PRECONDITION||t.code===R.UNIMPLEMENTED:!(typeof DOMException<"u"&&t instanceof DOMException)||t.code===22||t.code===20||t.code===11}async function S8(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){W("FirestoreClient","Using user provided OfflineComponentProvider");try{await hp(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!E8(n))throw n;ro("Error using user provided cache. Falling back to memory cache: "+n),await hp(t,new sE)}}else W("FirestoreClient","Using default OfflineComponentProvider"),await hp(t,new sE);return t._offlineComponents}async function WC(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(W("FirestoreClient","Using user provided OnlineComponentProvider"),await aE(t,t._uninitializedComponentsProvider._online)):(W("FirestoreClient","Using default OnlineComponentProvider"),await aE(t,new w8))),t._onlineComponents}function k8(t){return WC(t).then(e=>e.syncEngine)}async function qC(t){const e=await WC(t),n=e.eventManager;return n.onListen=l8.bind(null,e.syncEngine),n.onUnlisten=u8.bind(null,e.syncEngine),n}function b8(t,e,n={}){const r=new Qr;return t.asyncQueue.enqueueAndForget(async()=>function(s,a,o,l,u){const d=new HC({next:m=>{a.enqueueAndForget(()=>MC(s,h));const p=m.docs.has(o);!p&&m.fromCache?u.reject(new z(R.UNAVAILABLE,"Failed to get document because the client is offline.")):p&&m.fromCache&&l&&l.source==="server"?u.reject(new z(R.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(m)},error:m=>u.reject(m)}),h=new LC(Wv(o.path),d,{includeMetadataChanges:!0,z_:!0});return DC(s,h)}(await qC(t),t.asyncQueue,e,n,r)),r.promise}function T8(t,e,n={}){const r=new Qr;return t.asyncQueue.enqueueAndForget(async()=>function(s,a,o,l,u){const d=new HC({next:m=>{a.enqueueAndForget(()=>MC(s,h)),m.fromCache&&l.source==="server"?u.reject(new z(R.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(m)},error:m=>u.reject(m)}),h=new LC(o,d,{includeMetadataChanges:!0,z_:!0});return DC(s,h)}(await qC(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GC(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oE=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KC(t,e,n){if(!n)throw new z(R.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function I8(t,e,n,r){if(e===!0&&r===!0)throw new z(R.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function lE(t){if(!K.isDocumentKey(t))throw new z(R.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function cE(t){if(K.isDocumentKey(t))throw new z(R.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Pf(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":J()}function Qi(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new z(R.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Pf(t);throw new z(R.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function C8(t,e){if(e<=0)throw new z(R.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uE{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new z(R.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new z(R.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}I8("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=GC((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new z(R.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new z(R.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new z(R.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Nf{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new uE({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new z(R.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new z(R.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new uE(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new QF;switch(r.type){case"firstParty":return new ZF(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new z(R.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=oE.get(n);r&&(W("ComponentProvider","Removing Datastore"),oE.delete(n),r.terminate())}(this),Promise.resolve()}}function A8(t,e,n,r={}){var i;const s=(t=Qi(t,Nf))._getSettings(),a=`${e}:${n}`;if(s.host!=="firestore.googleapis.com"&&s.host!==a&&ro("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),r.mockUserToken){let o,l;if(typeof r.mockUserToken=="string")o=r.mockUserToken,l=Nt.MOCK_USER;else{o=rT(r.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);const u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new z(R.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new Nt(u)}t._authCredentials=new XF(new VI(o,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ra{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new ra(this.firestore,e,this._query)}}class on{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new zi(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new on(this.firestore,e,this._key)}}class zi extends ra{constructor(e,n,r){super(e,n,Wv(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new on(this.firestore,null,new K(e))}withConverter(e){return new zi(this.firestore,e,this._path)}}function o1(t,e,...n){if(t=ot(t),KC("collection","path",e),t instanceof Nf){const r=Ce.fromString(e,...n);return cE(r),new zi(t,null,r)}{if(!(t instanceof on||t instanceof zi))throw new z(R.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ce.fromString(e,...n));return cE(r),new zi(t.firestore,null,r)}}function l1(t,e,...n){if(t=ot(t),arguments.length===1&&(e=HI.V()),KC("doc","path",e),t instanceof Nf){const r=Ce.fromString(e,...n);return lE(r),new on(t,null,new K(r))}{if(!(t instanceof on||t instanceof zi))throw new z(R.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ce.fromString(e,...n));return lE(r),new on(t.firestore,t instanceof zi?t.converter:null,new K(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R8{constructor(){this.za=Promise.resolve(),this.ja=[],this.Ha=!1,this.Ja=[],this.Ya=null,this.Za=!1,this.Xa=!1,this.eu=[],this.Uo=new TC(this,"async_queue_retry"),this.tu=()=>{const n=dp();n&&W("AsyncQueue","Visibility state changed to "+n.visibilityState),this.Uo.Lo()};const e=dp();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.tu)}get isShuttingDown(){return this.Ha}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.nu(),this.ru(e)}enterRestrictedMode(e){if(!this.Ha){this.Ha=!0,this.Xa=e||!1;const n=dp();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.tu)}}enqueue(e){if(this.nu(),this.Ha)return new Promise(()=>{});const n=new Qr;return this.ru(()=>this.Ha&&this.Xa?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.ja.push(e),this.iu()))}async iu(){if(this.ja.length!==0){try{await this.ja[0](),this.ja.shift(),this.Uo.reset()}catch(e){if(!Uc(e))throw e;W("AsyncQueue","Operation failed with retryable error: "+e)}this.ja.length>0&&this.Uo.No(()=>this.iu())}}ru(e){const n=this.za.then(()=>(this.Za=!0,e().catch(r=>{this.Ya=r,this.Za=!1;const i=function(a){let o=a.message||"";return a.stack&&(o=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),o}(r);throw ri("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.Za=!1,r))));return this.za=n,n}enqueueAfterDelay(e,n,r){this.nu(),this.eu.indexOf(e)>-1&&(n=0);const i=r1.createAndSchedule(this,e,n,r,s=>this.su(s));return this.Ja.push(i),i}nu(){this.Ya&&J()}verifyOperationInProgress(){}async ou(){let e;do e=this.za,await e;while(e!==this.za)}_u(e){for(const n of this.Ja)if(n.timerId===e)return!0;return!1}au(e){return this.ou().then(()=>{this.Ja.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Ja)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.ou()})}uu(e){this.eu.push(e)}su(e){const n=this.Ja.indexOf(e);this.Ja.splice(n,1)}}class Gc extends Nf{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=function(){return new R8}(),this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||QC(this),this._firestoreClient.terminate()}}function P8(t,e){const n=typeof t=="object"?t:ov(),r=typeof t=="string"?t:e||"(default)",i=ef(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=eT("firestore");s&&A8(i,...s)}return i}function c1(t){return t._firestoreClient||QC(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function QC(t){var e,n,r;const i=t._freezeSettings(),s=function(o,l,u,d){return new d$(o,l,u,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,GC(d.experimentalLongPollingOptions),d.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._firestoreClient=new _8(t._authCredentials,t._appCheckCredentials,t._queue,s),!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class co{constructor(e){this._byteString=e}static fromBase64String(e){try{return new co(Ut.fromBase64String(e))}catch(n){throw new z(R.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new co(Ut.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u1{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new z(R.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Dt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XC{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d1{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new z(R.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new z(R.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ge(this._lat,e._lat)||ge(this._long,e._long)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N8=/^__.*__$/;class j8{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new ta(e,this.data,this.fieldMask,n,this.fieldTransforms):new Vc(e,this.data,n,this.fieldTransforms)}}function YC(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw J()}}class h1{constructor(e,n,r,i,s,a){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.cu(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get lu(){return this.settings.lu}hu(e){return new h1(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Pu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.hu({path:r,Iu:!1});return i.Tu(e),i}Eu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.hu({path:r,Iu:!1});return i.cu(),i}du(e){return this.hu({path:void 0,Iu:!0})}Au(e){return rh(e,this.settings.methodName,this.settings.Ru||!1,this.path,this.settings.Vu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}cu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Tu(this.path.get(e))}Tu(e){if(e.length===0)throw this.Au("Document fields must not be empty");if(YC(this.lu)&&N8.test(e))throw this.Au('Document fields cannot begin and end with "__"')}}class O8{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Cf(e)}mu(e,n,r,i=!1){return new h1({lu:e,methodName:n,Vu:r,path:Dt.emptyPath(),Iu:!1,Ru:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function JC(t){const e=t._freezeSettings(),n=Cf(t._databaseId);return new O8(t._databaseId,!!e.ignoreUndefinedProperties,n)}function D8(t,e,n,r,i,s={}){const a=t.mu(s.merge||s.mergeFields?2:0,e,n,i);tA("Data must be an object, but it was:",a,r);const o=ZC(r,a);let l,u;if(s.merge)l=new Jn(a.fieldMask),u=a.fieldTransforms;else if(s.mergeFields){const d=[];for(const h of s.mergeFields){const m=L8(e,h,n);if(!a.contains(m))throw new z(R.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);$8(d,m)||d.push(m)}l=new Jn(d),u=a.fieldTransforms.filter(h=>l.covers(h.field))}else l=null,u=a.fieldTransforms;return new j8(new jn(o),l,u)}function M8(t,e,n,r=!1){return f1(n,t.mu(r?4:3,e))}function f1(t,e){if(eA(t=ot(t)))return tA("Unsupported field value:",e,t),ZC(t,e);if(t instanceof XC)return function(r,i){if(!YC(i.lu))throw i.Au(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Au(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Iu&&e.lu!==4)throw e.Au("Nested arrays are not supported");return function(r,i){const s=[];let a=0;for(const o of r){let l=f1(o,i.du(a));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),a++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=ot(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return N$(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=at.fromDate(r);return{timestampValue:th(i.serializer,s)}}if(r instanceof at){const s=new at(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:th(i.serializer,s)}}if(r instanceof d1)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof co)return{bytesValue:vC(i.serializer,r._byteString)};if(r instanceof on){const s=i.databaseId,a=r.firestore._databaseId;if(!a.isEqual(s))throw i.Au(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Xv(r.firestore._databaseId||i.databaseId,r._key.path)}}throw i.Au(`Unsupported field value: ${Pf(r)}`)}(t,e)}function ZC(t,e){const n={};return WI(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ro(t,(r,i)=>{const s=f1(i,e.Pu(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function eA(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof at||t instanceof d1||t instanceof co||t instanceof on||t instanceof XC)}function tA(t,e,n){if(!eA(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){const r=Pf(n);throw r==="an object"?e.Au(t+" a custom object"):e.Au(t+" "+r)}}function L8(t,e,n){if((e=ot(e))instanceof u1)return e._internalPath;if(typeof e=="string")return nA(t,e);throw rh("Field path arguments must be of type string or ",t,!1,void 0,n)}const F8=new RegExp("[~\\*/\\[\\]]");function nA(t,e,n){if(e.search(F8)>=0)throw rh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new u1(...e.split("."))._internalPath}catch{throw rh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function rh(t,e,n,r,i){const s=r&&!r.isEmpty(),a=i!==void 0;let o=`Function ${e}() called with invalid data`;n&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(s||a)&&(l+=" (found",s&&(l+=` in field ${r}`),a&&(l+=` in document ${i}`),l+=")"),new z(R.INVALID_ARGUMENT,o+t+l)}function $8(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rA{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new on(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new z8(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(m1("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class z8 extends rA{data(){return super.data()}}function m1(t,e){return typeof e=="string"?nA(t,e):e instanceof u1?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function U8(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new z(R.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class p1{}class iA extends p1{}function za(t,e,...n){let r=[];e instanceof p1&&r.push(e),r=r.concat(n),function(s){const a=s.filter(l=>l instanceof g1).length,o=s.filter(l=>l instanceof jf).length;if(a>1||a>0&&o>0)throw new z(R.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)t=i._apply(t);return t}class jf extends iA{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new jf(e,n,r)}_apply(e){const n=this._parse(e);return sA(e._query,n),new ra(e.firestore,e.converter,p0(e._query,n))}_parse(e){const n=JC(e.firestore);return function(s,a,o,l,u,d,h){let m;if(u.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new z(R.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){fE(h,d);const p=[];for(const g of h)p.push(hE(l,s,g));m={arrayValue:{values:p}}}else m=hE(l,s,h)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||fE(h,d),m=M8(o,a,h,d==="in"||d==="not-in");return et.create(u,d,m)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function Ua(t,e,n){const r=e,i=m1("where",t);return jf._create(i,r,n)}class g1 extends p1{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new g1(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:rr.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let a=i;const o=s.getFlattenedFilters();for(const l of o)sA(a,l),a=p0(a,l)}(e._query,n),new ra(e.firestore,e.converter,p0(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class y1 extends iA{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new y1(e,n,r)}_apply(e){return new ra(e.firestore,e.converter,Jd(e._query,this._limit,this._limitType))}}function dE(t){return C8("limit",t),y1._create("limit",t,"F")}function hE(t,e,n){if(typeof(n=ot(n))=="string"){if(n==="")throw new z(R.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!tC(e)&&n.indexOf("/")!==-1)throw new z(R.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Ce.fromString(n));if(!K.isDocumentKey(r))throw new z(R.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return D_(t,new K(r))}if(n instanceof on)return D_(t,n._key);throw new z(R.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Pf(n)}.`)}function fE(t,e){if(!Array.isArray(t)||t.length===0)throw new z(R.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function sA(t,e){if(e.isInequality()){const r=qv(t),i=e.field;if(r!==null&&!r.isEqual(i))throw new z(R.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${r.toString()}' and '${i.toString()}'`);const s=eC(t);s!==null&&B8(t,i,s)}const n=function(i,s){for(const a of i)for(const o of a.getFlattenedFilters())if(s.indexOf(o.op)>=0)return o.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new z(R.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new z(R.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}function B8(t,e,n){if(!n.isEqual(e))throw new z(R.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${n.toString()}' instead.`)}class V8{convertValue(e,n="none"){switch($s(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Je(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Fs(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw J()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Ro(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertGeoPoint(e){return new d1(Je(e.latitude),Je(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=Uv(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(ac(e));default:return null}}convertTimestamp(e){const n=Gi(e);return new at(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Ce.fromString(e);Re(SC(r));const i=new oc(r.get(1),r.get(3)),s=new K(r.popFirst(5));return i.isEqual(n)||ri(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H8(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cl{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class aA extends rA{constructor(e,n,r,i,s,a){super(e,n,r,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new rd(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(m1("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class rd extends aA{data(e={}){return super.data(e)}}class W8{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new cl(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new rd(this._firestore,this._userDataWriter,r.key,r,new cl(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new z(R.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(o=>{const l=new rd(i._firestore,i._userDataWriter,o.doc.key,o.doc,new cl(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);return o.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(o=>s||o.type!==3).map(o=>{const l=new rd(i._firestore,i._userDataWriter,o.doc.key,o.doc,new cl(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);let u=-1,d=-1;return o.type!==0&&(u=a.indexOf(o.doc.key),a=a.delete(o.doc.key)),o.type!==1&&(a=a.add(o.doc),d=a.indexOf(o.doc.key)),{type:q8(o.type),doc:l,oldIndex:u,newIndex:d}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function q8(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return J()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function G8(t){t=Qi(t,on);const e=Qi(t.firestore,Gc);return b8(c1(e),t._key).then(n=>X8(e,t,n))}class oA extends V8{constructor(e){super(),this.firestore=e}convertBytes(e){return new co(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new on(this.firestore,null,n)}}function v1(t){t=Qi(t,ra);const e=Qi(t.firestore,Gc),n=c1(e),r=new oA(e);return U8(t._query),T8(n,t._query).then(i=>new W8(e,r,t,i))}function K8(t,e,n){t=Qi(t,on);const r=Qi(t.firestore,Gc),i=H8(t.converter,e,n);return lA(r,[D8(JC(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,kr.none())])}function Q8(t){return lA(Qi(t.firestore,Gc),[new Gv(t._key,kr.none())])}function lA(t,e){return function(r,i){const s=new Qr;return r.asyncQueue.enqueueAndForget(async()=>d8(await k8(r),i,s)),s.promise}(c1(t),e)}function X8(t,e,n){const r=n.docs.get(e._key),i=new oA(t);return new aA(t,i,e._key,r,new cl(n.hasPendingWrites,n.fromCache),e.converter)}(function(e,n=!0){(function(i){Ao=i})(Zs),Ds(new Wi("firestore",(r,{instanceIdentifier:i,options:s})=>{const a=r.getProvider("app").getImmediate(),o=new Gc(new YF(r.getProvider("auth-internal")),new t$(r.getProvider("app-check-internal")),function(u,d){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new z(R.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new oc(u.options.projectId,d)}(a,i),a);return s=Object.assign({useFetchStreams:n},s),o._setSettings(s),o},"PUBLIC").setMultipleInstances(!0)),_r(R_,"4.1.2",e),_r(R_,"4.1.2","esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cA="firebasestorage.googleapis.com",uA="storageBucket",Y8=2*60*1e3,J8=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class He extends jr{constructor(e,n,r=0){super(fp(e),`Firebase Storage: ${n} (${fp(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,He.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return fp(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Ve;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Ve||(Ve={}));function fp(t){return"storage/"+t}function x1(){const t="An unknown error occurred, please check the error payload for server response.";return new He(Ve.UNKNOWN,t)}function Z8(t){return new He(Ve.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function ez(t){return new He(Ve.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function tz(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new He(Ve.UNAUTHENTICATED,t)}function nz(){return new He(Ve.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function rz(t){return new He(Ve.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function iz(){return new He(Ve.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function sz(){return new He(Ve.CANCELED,"User canceled the upload/download.")}function az(t){return new He(Ve.INVALID_URL,"Invalid URL '"+t+"'.")}function oz(t){return new He(Ve.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function lz(){return new He(Ve.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+uA+"' property when initializing the app?")}function cz(){return new He(Ve.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function uz(){return new He(Ve.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function dz(t){return new He(Ve.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function S0(t){return new He(Ve.INVALID_ARGUMENT,t)}function dA(){return new He(Ve.APP_DELETED,"The Firebase app was deleted.")}function hz(t){return new He(Ve.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Il(t,e){return new He(Ve.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function Ko(t){throw new He(Ve.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yn{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=yn.makeFromUrl(e,n)}catch{return new yn(e,"")}if(r.path==="")return r;throw oz(e)}static makeFromUrl(e,n){let r=null;const i="([A-Za-z0-9.\\-_]+)";function s(_){_.path.charAt(_.path.length-1)==="/"&&(_.path_=_.path_.slice(0,-1))}const a="(/(.*))?$",o=new RegExp("^gs://"+i+a,"i"),l={bucket:1,path:3};function u(_){_.path_=decodeURIComponent(_.path)}const d="v[A-Za-z0-9_]+",h=n.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",p=new RegExp(`^https?://${h}/${d}/b/${i}/o${m}`,"i"),g={bucket:1,path:3},w=n===cA?"(?:storage.googleapis.com|storage.cloud.google.com)":n,E="([^?#]*)",v=new RegExp(`^https?://${w}/${i}/${E}`,"i"),x=[{regex:o,indices:l,postModify:s},{regex:p,indices:g,postModify:u},{regex:v,indices:{bucket:1,path:2},postModify:u}];for(let _=0;_<x.length;_++){const S=x[_],k=S.regex.exec(e);if(k){const b=k[S.indices.bucket];let T=k[S.indices.path];T||(T=""),r=new yn(b,T),S.postModify(r);break}}if(r==null)throw az(e);return r}}class fz{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mz(t,e,n){let r=1,i=null,s=null,a=!1,o=0;function l(){return o===2}let u=!1;function d(...E){u||(u=!0,e.apply(null,E))}function h(E){i=setTimeout(()=>{i=null,t(p,l())},E)}function m(){s&&clearTimeout(s)}function p(E,...v){if(u){m();return}if(E){m(),d.call(null,E,...v);return}if(l()||a){m(),d.call(null,E,...v);return}r<64&&(r*=2);let x;o===1?(o=2,x=0):x=(r+Math.random())*1e3,h(x)}let g=!1;function w(E){g||(g=!0,m(),!u&&(i!==null?(E||(o=2),clearTimeout(i),h(0)):E||(o=1)))}return h(0),s=setTimeout(()=>{a=!0,w(!0)},n),w}function pz(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gz(t){return t!==void 0}function yz(t){return typeof t=="object"&&!Array.isArray(t)}function w1(t){return typeof t=="string"||t instanceof String}function mE(t){return _1()&&t instanceof Blob}function _1(){return typeof Blob<"u"&&!EO()}function pE(t,e,n,r){if(r<e)throw S0(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw S0(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Of(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function hA(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const i=e(r)+"="+e(t[r]);n=n+i+"&"}return n=n.slice(0,-1),n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Is;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(Is||(Is={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vz(t,e){const n=t>=500&&t<600,i=[408,429].indexOf(t)!==-1,s=e.indexOf(t)!==-1;return n||i||s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xz{constructor(e,n,r,i,s,a,o,l,u,d,h,m=!0){this.url_=e,this.method_=n,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=a,this.callback_=o,this.errorCallback_=l,this.timeout_=u,this.progressCallback_=d,this.connectionFactory_=h,this.retry=m,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((p,g)=>{this.resolve_=p,this.reject_=g,this.start_()})}start_(){const e=(r,i)=>{if(i){r(!1,new Eu(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const a=o=>{const l=o.loaded,u=o.lengthComputable?o.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,u)};this.progressCallback_!==null&&s.addUploadProgressListener(a),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(a),this.pendingConnection_=null;const o=s.getErrorCode()===Is.NO_ERROR,l=s.getStatus();if(!o||vz(l,this.additionalRetryCodes_)&&this.retry){const d=s.getErrorCode()===Is.ABORT;r(!1,new Eu(!1,null,d));return}const u=this.successCodes_.indexOf(l)!==-1;r(!0,new Eu(u,s))})},n=(r,i)=>{const s=this.resolve_,a=this.reject_,o=i.connection;if(i.wasSuccessCode)try{const l=this.callback_(o,o.getResponse());gz(l)?s(l):s()}catch(l){a(l)}else if(o!==null){const l=x1();l.serverResponse=o.getErrorText(),this.errorCallback_?a(this.errorCallback_(o,l)):a(l)}else if(i.canceled){const l=this.appDelete_?dA():sz();a(l)}else{const l=iz();a(l)}};this.canceled_?n(!1,new Eu(!1,null,!0)):this.backoffId_=mz(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&pz(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Eu{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function wz(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function _z(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function Ez(t,e){e&&(t["X-Firebase-GMPID"]=e)}function Sz(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function kz(t,e,n,r,i,s,a=!0){const o=hA(t.urlParams),l=t.url+o,u=Object.assign({},t.headers);return Ez(u,e),wz(u,n),_z(u,s),Sz(u,r),new xz(l,t.method,u,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bz(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function Tz(...t){const e=bz();if(e!==void 0){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(_1())return new Blob(t);throw new He(Ve.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function Iz(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cz(t){if(typeof atob>"u")throw dz("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yr={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class mp{constructor(e,n){this.data=e,this.contentType=n||null}}function Az(t,e){switch(t){case yr.RAW:return new mp(fA(e));case yr.BASE64:case yr.BASE64URL:return new mp(mA(t,e));case yr.DATA_URL:return new mp(Pz(e),Nz(e))}throw x1()}function fA(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const s=r,a=t.charCodeAt(++n);r=65536|(s&1023)<<10|a&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function Rz(t){let e;try{e=decodeURIComponent(t)}catch{throw Il(yr.DATA_URL,"Malformed data URL.")}return fA(e)}function mA(t,e){switch(t){case yr.BASE64:{const i=e.indexOf("-")!==-1,s=e.indexOf("_")!==-1;if(i||s)throw Il(t,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case yr.BASE64URL:{const i=e.indexOf("+")!==-1,s=e.indexOf("/")!==-1;if(i||s)throw Il(t,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=Cz(e)}catch(i){throw i.message.includes("polyfill")?i:Il(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}class pA{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw Il(yr.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=jz(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function Pz(t){const e=new pA(t);return e.base64?mA(yr.BASE64,e.rest):Rz(e.rest)}function Nz(t){return new pA(t).contentType}function jz(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ei{constructor(e,n){let r=0,i="";mE(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,n){if(mE(this.data_)){const r=this.data_,i=Iz(r,e,n);return i===null?null:new Ei(i)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new Ei(r,!0)}}static getBlob(...e){if(_1()){const n=e.map(r=>r instanceof Ei?r.data_:r);return new Ei(Tz.apply(null,n))}else{const n=e.map(a=>w1(a)?Az(yr.RAW,a).data:a.data_);let r=0;n.forEach(a=>{r+=a.byteLength});const i=new Uint8Array(r);let s=0;return n.forEach(a=>{for(let o=0;o<a.length;o++)i[s++]=a[o]}),new Ei(i,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gA(t){let e;try{e=JSON.parse(t)}catch{return null}return yz(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oz(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function Dz(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function yA(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mz(t,e){return e}class Bt{constructor(e,n,r,i){this.server=e,this.local=n||e,this.writable=!!r,this.xform=i||Mz}}let Su=null;function Lz(t){return!w1(t)||t.length<2?t:yA(t)}function vA(){if(Su)return Su;const t=[];t.push(new Bt("bucket")),t.push(new Bt("generation")),t.push(new Bt("metageneration")),t.push(new Bt("name","fullPath",!0));function e(s,a){return Lz(a)}const n=new Bt("name");n.xform=e,t.push(n);function r(s,a){return a!==void 0?Number(a):a}const i=new Bt("size");return i.xform=r,t.push(i),t.push(new Bt("timeCreated")),t.push(new Bt("updated")),t.push(new Bt("md5Hash",null,!0)),t.push(new Bt("cacheControl",null,!0)),t.push(new Bt("contentDisposition",null,!0)),t.push(new Bt("contentEncoding",null,!0)),t.push(new Bt("contentLanguage",null,!0)),t.push(new Bt("contentType",null,!0)),t.push(new Bt("metadata","customMetadata",!0)),Su=t,Su}function Fz(t,e){function n(){const r=t.bucket,i=t.fullPath,s=new yn(r,i);return e._makeStorageReference(s)}Object.defineProperty(t,"ref",{get:n})}function $z(t,e,n){const r={};r.type="file";const i=n.length;for(let s=0;s<i;s++){const a=n[s];r[a.local]=a.xform(r,e[a.server])}return Fz(r,t),r}function xA(t,e,n){const r=gA(e);return r===null?null:$z(t,r,n)}function zz(t,e,n,r){const i=gA(e);if(i===null||!w1(i.downloadTokens))return null;const s=i.downloadTokens;if(s.length===0)return null;const a=encodeURIComponent;return s.split(",").map(u=>{const d=t.bucket,h=t.fullPath,m="/b/"+a(d)+"/o/"+a(h),p=Of(m,n,r),g=hA({alt:"media",token:u});return p+g})[0]}function Uz(t,e){const n={},r=e.length;for(let i=0;i<r;i++){const s=e[i];s.writable&&(n[s.server]=t[s.local])}return JSON.stringify(n)}class E1{constructor(e,n,r,i){this.url=e,this.method=n,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wA(t){if(!t)throw x1()}function Bz(t,e){function n(r,i){const s=xA(t,i,e);return wA(s!==null),s}return n}function Vz(t,e){function n(r,i){const s=xA(t,i,e);return wA(s!==null),zz(s,i,t.host,t._protocol)}return n}function _A(t){function e(n,r){let i;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?i=nz():i=tz():n.getStatus()===402?i=ez(t.bucket):n.getStatus()===403?i=rz(t.path):i=r,i.status=n.getStatus(),i.serverResponse=r.serverResponse,i}return e}function EA(t){const e=_A(t);function n(r,i){let s=e(r,i);return r.getStatus()===404&&(s=Z8(t.path)),s.serverResponse=i.serverResponse,s}return n}function Hz(t,e,n){const r=e.fullServerUrl(),i=Of(r,t.host,t._protocol),s="GET",a=t.maxOperationRetryTime,o=new E1(i,s,Vz(t,n),a);return o.errorHandler=EA(e),o}function Wz(t,e){const n=e.fullServerUrl(),r=Of(n,t.host,t._protocol),i="DELETE",s=t.maxOperationRetryTime;function a(l,u){}const o=new E1(r,i,a,s);return o.successCodes=[200,204],o.errorHandler=EA(e),o}function qz(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function Gz(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=qz(null,e)),r}function Kz(t,e,n,r,i){const s=e.bucketOnlyServerUrl(),a={"X-Goog-Upload-Protocol":"multipart"};function o(){let x="";for(let _=0;_<2;_++)x=x+Math.random().toString().slice(2);return x}const l=o();a["Content-Type"]="multipart/related; boundary="+l;const u=Gz(e,r,i),d=Uz(u,n),h="--"+l+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+d+`\r
--`+l+`\r
Content-Type: `+u.contentType+`\r
\r
`,m=`\r
--`+l+"--",p=Ei.getBlob(h,r,m);if(p===null)throw cz();const g={name:u.fullPath},w=Of(s,t.host,t._protocol),E="POST",v=t.maxUploadRetryTime,y=new E1(w,E,Bz(t,n),v);return y.urlParams=g,y.headers=a,y.body=p.uploadData(),y.errorHandler=_A(e),y}class Qz{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Is.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Is.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Is.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,i){if(this.sent_)throw Ko("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(n,e,!0),i!==void 0)for(const s in i)i.hasOwnProperty(s)&&this.xhr_.setRequestHeader(s,i[s].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Ko("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Ko("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Ko("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Ko("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class Xz extends Qz{initXhr(){this.xhr_.responseType="text"}}function S1(){return new Xz}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zs{constructor(e,n){this._service=e,n instanceof yn?this._location=n:this._location=yn.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new zs(e,n)}get root(){const e=new yn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return yA(this._location.path)}get storage(){return this._service}get parent(){const e=Oz(this._location.path);if(e===null)return null;const n=new yn(this._location.bucket,e);return new zs(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw hz(e)}}function Yz(t,e,n){t._throwIfRoot("uploadBytes");const r=Kz(t.storage,t._location,vA(),new Ei(e,!0),n);return t.storage.makeRequestWithTokens(r,S1).then(i=>({metadata:i,ref:t}))}function Jz(t){t._throwIfRoot("getDownloadURL");const e=Hz(t.storage,t._location,vA());return t.storage.makeRequestWithTokens(e,S1).then(n=>{if(n===null)throw uz();return n})}function Zz(t){t._throwIfRoot("deleteObject");const e=Wz(t.storage,t._location);return t.storage.makeRequestWithTokens(e,S1)}function e7(t,e){const n=Dz(t._location.path,e),r=new yn(t._location.bucket,n);return new zs(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t7(t){return/^[A-Za-z]+:\/\//.test(t)}function n7(t,e){return new zs(t,e)}function SA(t,e){if(t instanceof k1){const n=t;if(n._bucket==null)throw lz();const r=new zs(n,n._bucket);return e!=null?SA(r,e):r}else return e!==void 0?e7(t,e):t}function r7(t,e){if(e&&t7(e)){if(t instanceof k1)return n7(t,e);throw S0("To use ref(service, url), the first argument must be a Storage instance.")}else return SA(t,e)}function gE(t,e){const n=e==null?void 0:e[uA];return n==null?null:yn.makeFromBucketSpec(n,t)}function i7(t,e,n,r={}){t.host=`${e}:${n}`,t._protocol="http";const{mockUserToken:i}=r;i&&(t._overrideAuthToken=typeof i=="string"?i:rT(i,t.app.options.projectId))}class k1{constructor(e,n,r,i,s){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._bucket=null,this._host=cA,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=Y8,this._maxUploadRetryTime=J8,this._requests=new Set,i!=null?this._bucket=yn.makeFromBucketSpec(i,this._host):this._bucket=gE(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=yn.makeFromBucketSpec(this._url,e):this._bucket=gE(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){pE("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){pE("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new zs(this,e)}_makeRequest(e,n,r,i,s=!0){if(this._deleted)return new fz(dA());{const a=kz(e,this._appId,r,i,n,this._firebaseVersion,s);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}async makeRequestWithTokens(e,n){const[r,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,i).getPromise()}}const yE="@firebase/storage",vE="0.11.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kA="storage";function bA(t,e,n){return t=ot(t),Yz(t,e,n)}function TA(t){return t=ot(t),Jz(t)}function s7(t){return t=ot(t),Zz(t)}function b1(t,e){return t=ot(t),r7(t,e)}function a7(t=ov(),e){t=ot(t);const r=ef(t,kA).getImmediate({identifier:e}),i=eT("storage");return i&&o7(r,...i),r}function o7(t,e,n,r={}){i7(t,e,n,r)}function l7(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),i=t.getProvider("app-check-internal");return new k1(n,r,i,e,Zs)}function c7(){Ds(new Wi(kA,l7,"PUBLIC").setMultipleInstances(!0)),_r(yE,vE,""),_r(yE,vE,"esm2017")}c7();const T1=aT({apiKey:"AIzaSyBPNpckpYiu009eSzHz_1YMlwHLtScgVjE",appId:"1:938280289868:web:1b426fc2dba5d03dde96e9",projectId:"zingmp3-clone-61799",storageBucket:"zingmp3-clone-61799.appspot.com",authDomain:"zingmp3-clone-61799.firebaseapp.com",messagingSenderId:"938280289868"}),jo=P8(T1),Us=zL(T1);new hr;const I1=a7(T1);/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function IA(t,e,n,r){function i(s){return s instanceof n?s:new n(function(a){a(s)})}return new(n||(n=Promise))(function(s,a){function o(d){try{u(r.next(d))}catch(h){a(h)}}function l(d){try{u(r.throw(d))}catch(h){a(h)}}function u(d){d.done?s(d.value):i(d.value).then(o,l)}u((r=r.apply(t,e||[])).next())})}function CA(t,e){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,i,s,a;return a={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function o(u){return function(d){return l([u,d])}}function l(u){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,i&&(s=u[0]&2?i.return:u[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,u[1])).done)return s;switch(i=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return n.label++,{value:u[1],done:!1};case 5:n.label++,i=u[1],u=[0];continue;case 7:u=n.ops.pop(),n.trys.pop();continue;default:if(s=n.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){n=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){n.label=u[1];break}if(u[0]===6&&n.label<s[1]){n.label=s[1],s=u;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(u);break}s[2]&&n.ops.pop(),n.trys.pop();continue}u=e.call(t,n)}catch(d){u=[6,d],i=0}finally{r=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Ia=function(){return Ia=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Ia.apply(this,arguments)},AA=function(t){return{loading:t==null,value:t}},u7=function(){return function(t,e){switch(e.type){case"error":return Ia(Ia({},t),{error:e.error,loading:!1,value:void 0});case"reset":return AA(e.defaultValue);case"value":return Ia(Ia({},t),{error:void 0,loading:!1,value:e.value});default:return t}}},d7=function(t){var e=t?t():void 0,n=f.useReducer(u7(),AA(e)),r=n[0],i=n[1],s=f.useCallback(function(){var l=t?t():void 0;i({type:"reset",defaultValue:l})},[t]),a=f.useCallback(function(l){i({type:"error",error:l})},[]),o=f.useCallback(function(l){i({type:"value",value:l})},[]);return f.useMemo(function(){return{error:r.error,loading:r.loading,reset:s,setError:a,setValue:o,value:r.value}},[r.error,r.loading,s,a,o,r.value])},Df=function(t,e){var n=d7(function(){return t.currentUser}),r=n.error,i=n.loading,s=n.setError,a=n.setValue,o=n.value;return f.useEffect(function(){var l=CM(t,function(u){return IA(void 0,void 0,void 0,function(){var d;return CA(this,function(h){switch(h.label){case 0:if(!(e!=null&&e.onUserChanged))return[3,4];h.label=1;case 1:return h.trys.push([1,3,,4]),[4,e.onUserChanged(u)];case 2:return h.sent(),[3,4];case 3:return d=h.sent(),s(d),[3,4];case 4:return a(u),[2]}})})},s);return function(){l()}},[t]),[o,i,r]},h7=function(t){var e=f.useCallback(function(n,r){var i=new hr;return n&&n.forEach(function(s){return i.addScope(s)}),r&&i.setCustomParameters(r),i},[]);return f7(t,e)},f7=function(t,e){var n=f.useState(),r=n[0],i=n[1],s=f.useState(),a=s[0],o=s[1],l=f.useState(!1),u=l[0],d=l[1],h=f.useCallback(function(m,p){return IA(void 0,void 0,void 0,function(){var g,w,E;return CA(this,function(v){switch(v.label){case 0:d(!0),i(void 0),v.label=1;case 1:return v.trys.push([1,3,4,5]),g=e(m,p),[4,QM(t,g)];case 2:return w=v.sent(),o(w),[2,w];case 3:return E=v.sent(),i(E),[3,5];case 4:return d(!1),[7];case 5:return[2]}})})},[t,e]);return[h,a,u,r]};const RA={user:null,loading:!0},m7=(t,e)=>{switch(e.type){case 0:return{user:e.payload.user,loading:!1};case 1:return{user:null,loading:!0};default:return{user:t.user,loading:t.loading}}},p7={state:{user:RA.user,loading:!0},setUser:()=>{}},PA=f.createContext(p7),g7=()=>{const[t,e]=f.useReducer(m7,RA),n=f.useCallback(r=>{switch(r.type){case"set-user":return console.log("set user"),e({type:0,payload:{user:r.user}});case"reset":return console.log("reset user"),e({type:1,payload:{user:null}})}},[]);return{state:{loading:t.loading,user:t.user},setUser:n}},y7=({children:t})=>{const{state:{loading:e,user:n},setUser:r}=g7();return c.jsx(PA.Provider,{value:{state:{loading:e,user:n},setUser:r},children:t})},ln=()=>{const{state:{loading:t,user:e},setUser:n}=f.useContext(PA);return{loading:t,user:e,setUser:n}},Mf=()=>{const[t]=h7(Us);return{logOut:async()=>{await AT(Us),location.reload()},logIn:async()=>{await t()&&location.reload()}}},v7=()=>{const[t,e]=f.useState([]);return{toasts:t,setErrorToast:i=>e(s=>[...s,{variant:"error",id:Date.now()+"",desc:i||"Somethings went wrong"}]),setSuccessToast:i=>e(s=>[...s,{variant:"success",id:Date.now()+"",desc:i||"Successful"}]),setToasts:e}},NA=f.createContext(null);function x7({children:t}){return c.jsx(NA.Provider,{value:v7(),children:t})}const sr=()=>{const t=f.useContext(NA);if(!t)throw new Error("Toast Context not provided");return t},jA={tempSongs:[],status:""},w7=(t,e)=>{switch(e.type){case 0:{const{songs:n}=e.payload;return{...t,tempSongs:n,status:"uploading"}}case 1:{const n=[...t.tempSongs];return n.shift(),{...t,tempSongs:n}}case 2:{const{status:n}=e.payload;return{...t,tempSongs:[],status:n}}}},_7=()=>{const[t,e]=f.useReducer(w7,jA),n=f.useCallback(s=>{e({type:0,payload:{songs:s}})},[]),r=f.useCallback(()=>{e({type:1})},[]),i=f.useCallback(s=>{e({type:2,payload:{status:s}})},[]);return{state:t,setTempSongs:n,shiftSong:r,clearTempSongs:i}},E7={state:jA,setTempSongs:()=>{},shiftSong:()=>{},clearTempSongs:()=>{}},OA=f.createContext(E7),S7=({children:t})=>c.jsx(OA.Provider,{value:_7(),children:t}),Lf=()=>{const{state:{...t},...e}=f.useContext(OA);return{...e,...t}};function k7(){const[t,e]=f.useState(!1),[n,r]=f.useState(!1),[i,s]=f.useState(!1),[a,o]=f.useState(!1),l=f.useRef(null),u=f.useRef(null);return{audioRef:l,controlRef:u,isOpenFullScreen:t,isOpenSongQueue:n,idle:a,setIdle:o,setIsOpenFullScreen:e,setIsOpenSongQueue:r,setIsHasAudioEle:s}}const DA=f.createContext(null);function MA({children:t}){return c.jsx(DA.Provider,{value:k7(),children:t})}function Qt(){const t=f.useContext(DA);if(!t)throw new Error("Player Context not provided");return t}const b7=()=>{const[t,e]=f.useState([]),[n,r]=f.useState(!1),i=f.useRef(!1);return{songLyrics:t,setSongLyrics:e,loading:n,setLoading:r,ranGetLyric:i}},LA=f.createContext(null);function FA({children:t}){return c.jsx(LA.Provider,{value:b7(),children:t})}const T7=()=>{const t=f.useContext(LA);if(!t)throw new Error("Lyric context not found");return t},ih=async({collection:t,id:e,msg:n})=>{await Q8(l1(jo,t,e))},uo=async({collection:t,id:e,msg:n})=>G8(l1(jo,t,e)),mn=async({collection:t,id:e,data:n,msg:r})=>await K8(l1(jo,t,e),{...n},{merge:!0}),$A=async({file:t,folder:e,email:n,msg:r})=>{const i=n.replace("@gmail.com","")+"_"+t.name.replaceAll(" ","").toLowerCase(),s=b1(I1,`${e+i}`),a=await bA(s,t);return{fileURL:await TA(a.ref),filePath:a.metadata.fullPath}},I7=async({blob:t,folder:e,songId:n,msg:r})=>{const i=n+"_stock",s=b1(I1,`${e+i}`),a=await bA(s,t);return{fileURL:await TA(a.ref),filePath:a.metadata.fullPath}},k0=async({filePath:t,msg:e})=>{const n=b1(I1,t);await s7(n)},zA=async t=>{await ih({collection:"songs",id:t.id,msg:">>> api: delete song doc"}),await k0({filePath:t.song_file_path,msg:">>> api: delete song file"}),t.lyric_id&&await ih({collection:"lyrics",id:t.lyric_id,msg:">>> api: delete song lyric doc"}),t.image_file_path&&await k0({filePath:t.image_file_path,msg:">>> api: delete song's image file"})},xE=async(t,e)=>{const n=t.map(r=>r.id);await mn({collection:"users",data:{playlist_ids:n},id:e.email,msg:">>> api: set user playlist_ids"})};var UA={exports:{}},BA={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ho=f;function C7(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var A7=typeof Object.is=="function"?Object.is:C7,R7=ho.useState,P7=ho.useEffect,N7=ho.useLayoutEffect,j7=ho.useDebugValue;function O7(t,e){var n=e(),r=R7({inst:{value:n,getSnapshot:e}}),i=r[0].inst,s=r[1];return N7(function(){i.value=n,i.getSnapshot=e,pp(i)&&s({inst:i})},[t,n,e]),P7(function(){return pp(i)&&s({inst:i}),t(function(){pp(i)&&s({inst:i})})},[t]),j7(n),n}function pp(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!A7(t,n)}catch{return!0}}function D7(t,e){return e()}var M7=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?D7:O7;BA.useSyncExternalStore=ho.useSyncExternalStore!==void 0?ho.useSyncExternalStore:M7;UA.exports=BA;var L7=UA.exports,VA={exports:{}},HA={};/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ff=f,F7=L7;function $7(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var z7=typeof Object.is=="function"?Object.is:$7,U7=F7.useSyncExternalStore,B7=Ff.useRef,V7=Ff.useEffect,H7=Ff.useMemo,W7=Ff.useDebugValue;HA.useSyncExternalStoreWithSelector=function(t,e,n,r,i){var s=B7(null);if(s.current===null){var a={hasValue:!1,value:null};s.current=a}else a=s.current;s=H7(function(){function l(p){if(!u){if(u=!0,d=p,p=r(p),i!==void 0&&a.hasValue){var g=a.value;if(i(g,p))return h=g}return h=p}if(g=h,z7(d,p))return g;var w=r(p);return i!==void 0&&i(g,w)?g:(d=p,h=w)}var u=!1,d,h,m=n===void 0?null:n;return[function(){return l(e())},m===null?void 0:function(){return l(m())}]},[e,n,r,i]);var o=U7(t,s[0],s[1]);return V7(function(){a.hasValue=!0,a.value=o},[o]),W7(o),o};VA.exports=HA;var q7=VA.exports;function G7(t){t()}let WA=G7;const K7=t=>WA=t,Q7=()=>WA,wE=Symbol.for("react-redux-context"),_E=typeof globalThis<"u"?globalThis:{};function X7(){var t;if(!f.createContext)return{};const e=(t=_E[wE])!=null?t:_E[wE]=new Map;let n=e.get(f.createContext);return n||(n=f.createContext(null),e.set(f.createContext,n)),n}const Xi=X7();function C1(t=Xi){return function(){return f.useContext(t)}}const qA=C1(),Y7=()=>{throw new Error("uSES not initialized!")};let GA=Y7;const J7=t=>{GA=t},Z7=(t,e)=>t===e;function eU(t=Xi){const e=t===Xi?qA:C1(t);return function(r,i={}){const{equalityFn:s=Z7,stabilityCheck:a=void 0,noopCheck:o=void 0}=typeof i=="function"?{equalityFn:i}:i,{store:l,subscription:u,getServerState:d,stabilityCheck:h,noopCheck:m}=e();f.useRef(!0);const p=f.useCallback({[r.name](w){return r(w)}}[r.name],[r,h,a]),g=GA(u.addNestedSub,l.getState,d||l.getState,p,s);return f.useDebugValue(g),g}}const oe=eU();var KA={exports:{}},we={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yt=typeof Symbol=="function"&&Symbol.for,A1=yt?Symbol.for("react.element"):60103,R1=yt?Symbol.for("react.portal"):60106,$f=yt?Symbol.for("react.fragment"):60107,zf=yt?Symbol.for("react.strict_mode"):60108,Uf=yt?Symbol.for("react.profiler"):60114,Bf=yt?Symbol.for("react.provider"):60109,Vf=yt?Symbol.for("react.context"):60110,P1=yt?Symbol.for("react.async_mode"):60111,Hf=yt?Symbol.for("react.concurrent_mode"):60111,Wf=yt?Symbol.for("react.forward_ref"):60112,qf=yt?Symbol.for("react.suspense"):60113,tU=yt?Symbol.for("react.suspense_list"):60120,Gf=yt?Symbol.for("react.memo"):60115,Kf=yt?Symbol.for("react.lazy"):60116,nU=yt?Symbol.for("react.block"):60121,rU=yt?Symbol.for("react.fundamental"):60117,iU=yt?Symbol.for("react.responder"):60118,sU=yt?Symbol.for("react.scope"):60119;function In(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case A1:switch(t=t.type,t){case P1:case Hf:case $f:case Uf:case zf:case qf:return t;default:switch(t=t&&t.$$typeof,t){case Vf:case Wf:case Kf:case Gf:case Bf:return t;default:return e}}case R1:return e}}}function QA(t){return In(t)===Hf}we.AsyncMode=P1;we.ConcurrentMode=Hf;we.ContextConsumer=Vf;we.ContextProvider=Bf;we.Element=A1;we.ForwardRef=Wf;we.Fragment=$f;we.Lazy=Kf;we.Memo=Gf;we.Portal=R1;we.Profiler=Uf;we.StrictMode=zf;we.Suspense=qf;we.isAsyncMode=function(t){return QA(t)||In(t)===P1};we.isConcurrentMode=QA;we.isContextConsumer=function(t){return In(t)===Vf};we.isContextProvider=function(t){return In(t)===Bf};we.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===A1};we.isForwardRef=function(t){return In(t)===Wf};we.isFragment=function(t){return In(t)===$f};we.isLazy=function(t){return In(t)===Kf};we.isMemo=function(t){return In(t)===Gf};we.isPortal=function(t){return In(t)===R1};we.isProfiler=function(t){return In(t)===Uf};we.isStrictMode=function(t){return In(t)===zf};we.isSuspense=function(t){return In(t)===qf};we.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===$f||t===Hf||t===Uf||t===zf||t===qf||t===tU||typeof t=="object"&&t!==null&&(t.$$typeof===Kf||t.$$typeof===Gf||t.$$typeof===Bf||t.$$typeof===Vf||t.$$typeof===Wf||t.$$typeof===rU||t.$$typeof===iU||t.$$typeof===sU||t.$$typeof===nU)};we.typeOf=In;KA.exports=we;var aU=KA.exports,XA=aU,oU={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},lU={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},YA={};YA[XA.ForwardRef]=oU;YA[XA.Memo]=lU;var Ee={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var N1=Symbol.for("react.element"),j1=Symbol.for("react.portal"),Qf=Symbol.for("react.fragment"),Xf=Symbol.for("react.strict_mode"),Yf=Symbol.for("react.profiler"),Jf=Symbol.for("react.provider"),Zf=Symbol.for("react.context"),cU=Symbol.for("react.server_context"),em=Symbol.for("react.forward_ref"),tm=Symbol.for("react.suspense"),nm=Symbol.for("react.suspense_list"),rm=Symbol.for("react.memo"),im=Symbol.for("react.lazy"),uU=Symbol.for("react.offscreen"),JA;JA=Symbol.for("react.module.reference");function $n(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case N1:switch(t=t.type,t){case Qf:case Yf:case Xf:case tm:case nm:return t;default:switch(t=t&&t.$$typeof,t){case cU:case Zf:case em:case im:case rm:case Jf:return t;default:return e}}case j1:return e}}}Ee.ContextConsumer=Zf;Ee.ContextProvider=Jf;Ee.Element=N1;Ee.ForwardRef=em;Ee.Fragment=Qf;Ee.Lazy=im;Ee.Memo=rm;Ee.Portal=j1;Ee.Profiler=Yf;Ee.StrictMode=Xf;Ee.Suspense=tm;Ee.SuspenseList=nm;Ee.isAsyncMode=function(){return!1};Ee.isConcurrentMode=function(){return!1};Ee.isContextConsumer=function(t){return $n(t)===Zf};Ee.isContextProvider=function(t){return $n(t)===Jf};Ee.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===N1};Ee.isForwardRef=function(t){return $n(t)===em};Ee.isFragment=function(t){return $n(t)===Qf};Ee.isLazy=function(t){return $n(t)===im};Ee.isMemo=function(t){return $n(t)===rm};Ee.isPortal=function(t){return $n(t)===j1};Ee.isProfiler=function(t){return $n(t)===Yf};Ee.isStrictMode=function(t){return $n(t)===Xf};Ee.isSuspense=function(t){return $n(t)===tm};Ee.isSuspenseList=function(t){return $n(t)===nm};Ee.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===Qf||t===Yf||t===Xf||t===tm||t===nm||t===uU||typeof t=="object"&&t!==null&&(t.$$typeof===im||t.$$typeof===rm||t.$$typeof===Jf||t.$$typeof===Zf||t.$$typeof===em||t.$$typeof===JA||t.getModuleId!==void 0)};Ee.typeOf=$n;function dU(){const t=Q7();let e=null,n=null;return{clear(){e=null,n=null},notify(){t(()=>{let r=e;for(;r;)r.callback(),r=r.next})},get(){let r=[],i=e;for(;i;)r.push(i),i=i.next;return r},subscribe(r){let i=!0,s=n={callback:r,next:null,prev:n};return s.prev?s.prev.next=s:e=s,function(){!i||e===null||(i=!1,s.next?s.next.prev=s.prev:n=s.prev,s.prev?s.prev.next=s.next:e=s.next)}}}}const EE={notify(){},get:()=>[]};function hU(t,e){let n,r=EE;function i(h){return l(),r.subscribe(h)}function s(){r.notify()}function a(){d.onStateChange&&d.onStateChange()}function o(){return!!n}function l(){n||(n=e?e.addNestedSub(a):t.subscribe(a),r=dU())}function u(){n&&(n(),n=void 0,r.clear(),r=EE)}const d={addNestedSub:i,notifyNestedSubs:s,handleChangeWrapper:a,isSubscribed:o,trySubscribe:l,tryUnsubscribe:u,getListeners:()=>r};return d}const fU=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",mU=fU?f.useLayoutEffect:f.useEffect;function pU({store:t,context:e,children:n,serverState:r,stabilityCheck:i="once",noopCheck:s="once"}){const a=f.useMemo(()=>{const u=hU(t);return{store:t,subscription:u,getServerState:r?()=>r:void 0,stabilityCheck:i,noopCheck:s}},[t,r,i,s]),o=f.useMemo(()=>t.getState(),[t]);mU(()=>{const{subscription:u}=a;return u.onStateChange=u.notifyNestedSubs,u.trySubscribe(),o!==t.getState()&&u.notifyNestedSubs(),()=>{u.tryUnsubscribe(),u.onStateChange=void 0}},[a,o]);const l=e||Xi;return f.createElement(l.Provider,{value:a},n)}function ZA(t=Xi){const e=t===Xi?qA:C1(t);return function(){const{store:r}=e();return r}}const gU=ZA();function yU(t=Xi){const e=t===Xi?gU:ZA(t);return function(){return e().dispatch}}const Zt=yU();J7(q7.useSyncExternalStoreWithSelector);K7(Eo.unstable_batchedUpdates);function Gn(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];throw Error("[Immer] minified error nr: "+t+(n.length?" "+n.map(function(i){return"'"+i+"'"}).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function Yi(t){return!!t&&!!t[Pe]}function ai(t){var e;return!!t&&(function(n){if(!n||typeof n!="object")return!1;var r=Object.getPrototypeOf(n);if(r===null)return!0;var i=Object.hasOwnProperty.call(r,"constructor")&&r.constructor;return i===Object||typeof i=="function"&&Function.toString.call(i)===TU}(t)||Array.isArray(t)||!!t[AE]||!!(!((e=t.constructor)===null||e===void 0)&&e[AE])||O1(t)||D1(t))}function Bs(t,e,n){n===void 0&&(n=!1),Oo(t)===0?(n?Object.keys:Va)(t).forEach(function(r){n&&typeof r=="symbol"||e(r,t[r],t)}):t.forEach(function(r,i){return e(i,r,t)})}function Oo(t){var e=t[Pe];return e?e.i>3?e.i-4:e.i:Array.isArray(t)?1:O1(t)?2:D1(t)?3:0}function Ba(t,e){return Oo(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function vU(t,e){return Oo(t)===2?t.get(e):t[e]}function eR(t,e,n){var r=Oo(t);r===2?t.set(e,n):r===3?t.add(n):t[e]=n}function tR(t,e){return t===e?t!==0||1/t==1/e:t!=t&&e!=e}function O1(t){return kU&&t instanceof Map}function D1(t){return bU&&t instanceof Set}function fs(t){return t.o||t.t}function M1(t){if(Array.isArray(t))return Array.prototype.slice.call(t);var e=rR(t);delete e[Pe];for(var n=Va(e),r=0;r<n.length;r++){var i=n[r],s=e[i];s.writable===!1&&(s.writable=!0,s.configurable=!0),(s.get||s.set)&&(e[i]={configurable:!0,writable:!0,enumerable:s.enumerable,value:t[i]})}return Object.create(Object.getPrototypeOf(t),e)}function L1(t,e){return e===void 0&&(e=!1),F1(t)||Yi(t)||!ai(t)||(Oo(t)>1&&(t.set=t.add=t.clear=t.delete=xU),Object.freeze(t),e&&Bs(t,function(n,r){return L1(r,!0)},!0)),t}function xU(){Gn(2)}function F1(t){return t==null||typeof t!="object"||Object.isFrozen(t)}function Tr(t){var e=C0[t];return e||Gn(18,t),e}function wU(t,e){C0[t]||(C0[t]=e)}function b0(){return dc}function gp(t,e){e&&(Tr("Patches"),t.u=[],t.s=[],t.v=e)}function sh(t){T0(t),t.p.forEach(_U),t.p=null}function T0(t){t===dc&&(dc=t.l)}function SE(t){return dc={p:[],l:dc,h:t,m:!0,_:0}}function _U(t){var e=t[Pe];e.i===0||e.i===1?e.j():e.g=!0}function yp(t,e){e._=e.p.length;var n=e.p[0],r=t!==void 0&&t!==n;return e.h.O||Tr("ES5").S(e,t,r),r?(n[Pe].P&&(sh(e),Gn(4)),ai(t)&&(t=ah(e,t),e.l||oh(e,t)),e.u&&Tr("Patches").M(n[Pe].t,t,e.u,e.s)):t=ah(e,n,[]),sh(e),e.u&&e.v(e.u,e.s),t!==nR?t:void 0}function ah(t,e,n){if(F1(e))return e;var r=e[Pe];if(!r)return Bs(e,function(o,l){return kE(t,r,e,o,l,n)},!0),e;if(r.A!==t)return e;if(!r.P)return oh(t,r.t,!0),r.t;if(!r.I){r.I=!0,r.A._--;var i=r.i===4||r.i===5?r.o=M1(r.k):r.o,s=i,a=!1;r.i===3&&(s=new Set(i),i.clear(),a=!0),Bs(s,function(o,l){return kE(t,r,i,o,l,n,a)}),oh(t,i,!1),n&&t.u&&Tr("Patches").N(r,n,t.u,t.s)}return r.o}function kE(t,e,n,r,i,s,a){if(Yi(i)){var o=ah(t,i,s&&e&&e.i!==3&&!Ba(e.R,r)?s.concat(r):void 0);if(eR(n,r,o),!Yi(o))return;t.m=!1}else a&&n.add(i);if(ai(i)&&!F1(i)){if(!t.h.D&&t._<1)return;ah(t,i),e&&e.A.l||oh(t,i)}}function oh(t,e,n){n===void 0&&(n=!1),!t.l&&t.h.D&&t.m&&L1(e,n)}function vp(t,e){var n=t[Pe];return(n?fs(n):t)[e]}function bE(t,e){if(e in t)for(var n=Object.getPrototypeOf(t);n;){var r=Object.getOwnPropertyDescriptor(n,e);if(r)return r;n=Object.getPrototypeOf(n)}}function Si(t){t.P||(t.P=!0,t.l&&Si(t.l))}function xp(t){t.o||(t.o=M1(t.t))}function I0(t,e,n){var r=O1(e)?Tr("MapSet").F(e,n):D1(e)?Tr("MapSet").T(e,n):t.O?function(i,s){var a=Array.isArray(i),o={i:a?1:0,A:s?s.A:b0(),P:!1,I:!1,R:{},l:s,t:i,k:null,o:null,j:null,C:!1},l=o,u=hc;a&&(l=[o],u=ul);var d=Proxy.revocable(l,u),h=d.revoke,m=d.proxy;return o.k=m,o.j=h,m}(e,n):Tr("ES5").J(e,n);return(n?n.A:b0()).p.push(r),r}function EU(t){return Yi(t)||Gn(22,t),function e(n){if(!ai(n))return n;var r,i=n[Pe],s=Oo(n);if(i){if(!i.P&&(i.i<4||!Tr("ES5").K(i)))return i.t;i.I=!0,r=TE(n,s),i.I=!1}else r=TE(n,s);return Bs(r,function(a,o){i&&vU(i.t,a)===o||eR(r,a,e(o))}),s===3?new Set(r):r}(t)}function TE(t,e){switch(e){case 2:return new Map(t);case 3:return Array.from(t)}return M1(t)}function SU(){function t(s,a){var o=i[s];return o?o.enumerable=a:i[s]=o={configurable:!0,enumerable:a,get:function(){var l=this[Pe];return hc.get(l,s)},set:function(l){var u=this[Pe];hc.set(u,s,l)}},o}function e(s){for(var a=s.length-1;a>=0;a--){var o=s[a][Pe];if(!o.P)switch(o.i){case 5:r(o)&&Si(o);break;case 4:n(o)&&Si(o)}}}function n(s){for(var a=s.t,o=s.k,l=Va(o),u=l.length-1;u>=0;u--){var d=l[u];if(d!==Pe){var h=a[d];if(h===void 0&&!Ba(a,d))return!0;var m=o[d],p=m&&m[Pe];if(p?p.t!==h:!tR(m,h))return!0}}var g=!!a[Pe];return l.length!==Va(a).length+(g?0:1)}function r(s){var a=s.k;if(a.length!==s.t.length)return!0;var o=Object.getOwnPropertyDescriptor(a,a.length-1);if(o&&!o.get)return!0;for(var l=0;l<a.length;l++)if(!a.hasOwnProperty(l))return!0;return!1}var i={};wU("ES5",{J:function(s,a){var o=Array.isArray(s),l=function(d,h){if(d){for(var m=Array(h.length),p=0;p<h.length;p++)Object.defineProperty(m,""+p,t(p,!0));return m}var g=rR(h);delete g[Pe];for(var w=Va(g),E=0;E<w.length;E++){var v=w[E];g[v]=t(v,d||!!g[v].enumerable)}return Object.create(Object.getPrototypeOf(h),g)}(o,s),u={i:o?5:4,A:a?a.A:b0(),P:!1,I:!1,R:{},l:a,t:s,k:l,o:null,g:!1,C:!1};return Object.defineProperty(l,Pe,{value:u,writable:!0}),l},S:function(s,a,o){o?Yi(a)&&a[Pe].A===s&&e(s.p):(s.u&&function l(u){if(u&&typeof u=="object"){var d=u[Pe];if(d){var h=d.t,m=d.k,p=d.R,g=d.i;if(g===4)Bs(m,function(x){x!==Pe&&(h[x]!==void 0||Ba(h,x)?p[x]||l(m[x]):(p[x]=!0,Si(d)))}),Bs(h,function(x){m[x]!==void 0||Ba(m,x)||(p[x]=!1,Si(d))});else if(g===5){if(r(d)&&(Si(d),p.length=!0),m.length<h.length)for(var w=m.length;w<h.length;w++)p[w]=!1;else for(var E=h.length;E<m.length;E++)p[E]=!0;for(var v=Math.min(m.length,h.length),y=0;y<v;y++)m.hasOwnProperty(y)||(p[y]=!0),p[y]===void 0&&l(m[y])}}}}(s.p[0]),e(s.p))},K:function(s){return s.i===4?n(s):r(s)}})}var IE,dc,$1=typeof Symbol<"u"&&typeof Symbol("x")=="symbol",kU=typeof Map<"u",bU=typeof Set<"u",CE=typeof Proxy<"u"&&Proxy.revocable!==void 0&&typeof Reflect<"u",nR=$1?Symbol.for("immer-nothing"):((IE={})["immer-nothing"]=!0,IE),AE=$1?Symbol.for("immer-draftable"):"__$immer_draftable",Pe=$1?Symbol.for("immer-state"):"__$immer_state",TU=""+Object.prototype.constructor,Va=typeof Reflect<"u"&&Reflect.ownKeys?Reflect.ownKeys:Object.getOwnPropertySymbols!==void 0?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:Object.getOwnPropertyNames,rR=Object.getOwnPropertyDescriptors||function(t){var e={};return Va(t).forEach(function(n){e[n]=Object.getOwnPropertyDescriptor(t,n)}),e},C0={},hc={get:function(t,e){if(e===Pe)return t;var n=fs(t);if(!Ba(n,e))return function(i,s,a){var o,l=bE(s,a);return l?"value"in l?l.value:(o=l.get)===null||o===void 0?void 0:o.call(i.k):void 0}(t,n,e);var r=n[e];return t.I||!ai(r)?r:r===vp(t.t,e)?(xp(t),t.o[e]=I0(t.A.h,r,t)):r},has:function(t,e){return e in fs(t)},ownKeys:function(t){return Reflect.ownKeys(fs(t))},set:function(t,e,n){var r=bE(fs(t),e);if(r!=null&&r.set)return r.set.call(t.k,n),!0;if(!t.P){var i=vp(fs(t),e),s=i==null?void 0:i[Pe];if(s&&s.t===n)return t.o[e]=n,t.R[e]=!1,!0;if(tR(n,i)&&(n!==void 0||Ba(t.t,e)))return!0;xp(t),Si(t)}return t.o[e]===n&&(n!==void 0||e in t.o)||Number.isNaN(n)&&Number.isNaN(t.o[e])||(t.o[e]=n,t.R[e]=!0),!0},deleteProperty:function(t,e){return vp(t.t,e)!==void 0||e in t.t?(t.R[e]=!1,xp(t),Si(t)):delete t.R[e],t.o&&delete t.o[e],!0},getOwnPropertyDescriptor:function(t,e){var n=fs(t),r=Reflect.getOwnPropertyDescriptor(n,e);return r&&{writable:!0,configurable:t.i!==1||e!=="length",enumerable:r.enumerable,value:n[e]}},defineProperty:function(){Gn(11)},getPrototypeOf:function(t){return Object.getPrototypeOf(t.t)},setPrototypeOf:function(){Gn(12)}},ul={};Bs(hc,function(t,e){ul[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}}),ul.deleteProperty=function(t,e){return ul.set.call(this,t,e,void 0)},ul.set=function(t,e,n){return hc.set.call(this,t[0],e,n,t[0])};var IU=function(){function t(n){var r=this;this.O=CE,this.D=!0,this.produce=function(i,s,a){if(typeof i=="function"&&typeof s!="function"){var o=s;s=i;var l=r;return function(w){var E=this;w===void 0&&(w=o);for(var v=arguments.length,y=Array(v>1?v-1:0),x=1;x<v;x++)y[x-1]=arguments[x];return l.produce(w,function(_){var S;return(S=s).call.apply(S,[E,_].concat(y))})}}var u;if(typeof s!="function"&&Gn(6),a!==void 0&&typeof a!="function"&&Gn(7),ai(i)){var d=SE(r),h=I0(r,i,void 0),m=!0;try{u=s(h),m=!1}finally{m?sh(d):T0(d)}return typeof Promise<"u"&&u instanceof Promise?u.then(function(w){return gp(d,a),yp(w,d)},function(w){throw sh(d),w}):(gp(d,a),yp(u,d))}if(!i||typeof i!="object"){if((u=s(i))===void 0&&(u=i),u===nR&&(u=void 0),r.D&&L1(u,!0),a){var p=[],g=[];Tr("Patches").M(i,u,p,g),a(p,g)}return u}Gn(21,i)},this.produceWithPatches=function(i,s){if(typeof i=="function")return function(u){for(var d=arguments.length,h=Array(d>1?d-1:0),m=1;m<d;m++)h[m-1]=arguments[m];return r.produceWithPatches(u,function(p){return i.apply(void 0,[p].concat(h))})};var a,o,l=r.produce(i,s,function(u,d){a=u,o=d});return typeof Promise<"u"&&l instanceof Promise?l.then(function(u){return[u,a,o]}):[l,a,o]},typeof(n==null?void 0:n.useProxies)=="boolean"&&this.setUseProxies(n.useProxies),typeof(n==null?void 0:n.autoFreeze)=="boolean"&&this.setAutoFreeze(n.autoFreeze)}var e=t.prototype;return e.createDraft=function(n){ai(n)||Gn(8),Yi(n)&&(n=EU(n));var r=SE(this),i=I0(this,n,void 0);return i[Pe].C=!0,T0(r),i},e.finishDraft=function(n,r){var i=n&&n[Pe],s=i.A;return gp(s,r),yp(void 0,s)},e.setAutoFreeze=function(n){this.D=n},e.setUseProxies=function(n){n&&!CE&&Gn(20),this.O=n},e.applyPatches=function(n,r){var i;for(i=r.length-1;i>=0;i--){var s=r[i];if(s.path.length===0&&s.op==="replace"){n=s.value;break}}i>-1&&(r=r.slice(i+1));var a=Tr("Patches").$;return Yi(n)?a(n,r):this.produce(n,function(o){return a(o,r)})},t}(),kn=new IU,iR=kn.produce;kn.produceWithPatches.bind(kn);kn.setAutoFreeze.bind(kn);kn.setUseProxies.bind(kn);kn.applyPatches.bind(kn);kn.createDraft.bind(kn);kn.finishDraft.bind(kn);function fc(t){"@babel/helpers - typeof";return fc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fc(t)}function CU(t,e){if(fc(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(fc(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function AU(t){var e=CU(t,"string");return fc(e)==="symbol"?e:String(e)}function RU(t,e,n){return e=AU(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function RE(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function PE(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?RE(Object(n),!0).forEach(function(r){RU(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):RE(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Pt(t){return"Minified Redux error #"+t+"; visit https://redux.js.org/Errors?code="+t+" for the full message or use the non-minified dev environment for full errors. "}var NE=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}(),wp=function(){return Math.random().toString(36).substring(7).split("").join(".")},lh={INIT:"@@redux/INIT"+wp(),REPLACE:"@@redux/REPLACE"+wp(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+wp()}};function PU(t){if(typeof t!="object"||t===null)return!1;for(var e=t;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}function sR(t,e,n){var r;if(typeof e=="function"&&typeof n=="function"||typeof n=="function"&&typeof arguments[3]=="function")throw new Error(Pt(0));if(typeof e=="function"&&typeof n>"u"&&(n=e,e=void 0),typeof n<"u"){if(typeof n!="function")throw new Error(Pt(1));return n(sR)(t,e)}if(typeof t!="function")throw new Error(Pt(2));var i=t,s=e,a=[],o=a,l=!1;function u(){o===a&&(o=a.slice())}function d(){if(l)throw new Error(Pt(3));return s}function h(w){if(typeof w!="function")throw new Error(Pt(4));if(l)throw new Error(Pt(5));var E=!0;return u(),o.push(w),function(){if(E){if(l)throw new Error(Pt(6));E=!1,u();var y=o.indexOf(w);o.splice(y,1),a=null}}}function m(w){if(!PU(w))throw new Error(Pt(7));if(typeof w.type>"u")throw new Error(Pt(8));if(l)throw new Error(Pt(9));try{l=!0,s=i(s,w)}finally{l=!1}for(var E=a=o,v=0;v<E.length;v++){var y=E[v];y()}return w}function p(w){if(typeof w!="function")throw new Error(Pt(10));i=w,m({type:lh.REPLACE})}function g(){var w,E=h;return w={subscribe:function(y){if(typeof y!="object"||y===null)throw new Error(Pt(11));function x(){y.next&&y.next(d())}x();var _=E(x);return{unsubscribe:_}}},w[NE]=function(){return this},w}return m({type:lh.INIT}),r={dispatch:m,subscribe:h,getState:d,replaceReducer:p},r[NE]=g,r}function NU(t){Object.keys(t).forEach(function(e){var n=t[e],r=n(void 0,{type:lh.INIT});if(typeof r>"u")throw new Error(Pt(12));if(typeof n(void 0,{type:lh.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(Pt(13))})}function jU(t){for(var e=Object.keys(t),n={},r=0;r<e.length;r++){var i=e[r];typeof t[i]=="function"&&(n[i]=t[i])}var s=Object.keys(n),a;try{NU(n)}catch(o){a=o}return function(l,u){if(l===void 0&&(l={}),a)throw a;for(var d=!1,h={},m=0;m<s.length;m++){var p=s[m],g=n[p],w=l[p],E=g(w,u);if(typeof E>"u")throw u&&u.type,new Error(Pt(14));h[p]=E,d=d||E!==w}return d=d||s.length!==Object.keys(l).length,d?h:l}}function ch(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.length===0?function(r){return r}:e.length===1?e[0]:e.reduce(function(r,i){return function(){return r(i.apply(void 0,arguments))}})}function OU(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(r){return function(){var i=r.apply(void 0,arguments),s=function(){throw new Error(Pt(15))},a={getState:i.getState,dispatch:function(){return s.apply(void 0,arguments)}},o=e.map(function(l){return l(a)});return s=ch.apply(void 0,o)(i.dispatch),PE(PE({},i),{},{dispatch:s})}}}function aR(t){var e=function(r){var i=r.dispatch,s=r.getState;return function(a){return function(o){return typeof o=="function"?o(i,s,t):a(o)}}};return e}var oR=aR();oR.withExtraArgument=aR;const jE=oR;var lR=globalThis&&globalThis.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),DU=globalThis&&globalThis.__generator||function(t,e){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,i,s,a;return a={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function o(u){return function(d){return l([u,d])}}function l(u){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,i&&(s=u[0]&2?i.return:u[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,u[1])).done)return s;switch(i=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return n.label++,{value:u[1],done:!1};case 5:n.label++,i=u[1],u=[0];continue;case 7:u=n.ops.pop(),n.trys.pop();continue;default:if(s=n.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){n=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){n.label=u[1];break}if(u[0]===6&&n.label<s[1]){n.label=s[1],s=u;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(u);break}s[2]&&n.ops.pop(),n.trys.pop();continue}u=e.call(t,n)}catch(d){u=[6,d],i=0}finally{r=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},fo=globalThis&&globalThis.__spreadArray||function(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t},MU=Object.defineProperty,LU=Object.defineProperties,FU=Object.getOwnPropertyDescriptors,OE=Object.getOwnPropertySymbols,$U=Object.prototype.hasOwnProperty,zU=Object.prototype.propertyIsEnumerable,DE=function(t,e,n){return e in t?MU(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n},Ui=function(t,e){for(var n in e||(e={}))$U.call(e,n)&&DE(t,n,e[n]);if(OE)for(var r=0,i=OE(e);r<i.length;r++){var n=i[r];zU.call(e,n)&&DE(t,n,e[n])}return t},_p=function(t,e){return LU(t,FU(e))},UU=function(t,e,n){return new Promise(function(r,i){var s=function(l){try{o(n.next(l))}catch(u){i(u)}},a=function(l){try{o(n.throw(l))}catch(u){i(u)}},o=function(l){return l.done?r(l.value):Promise.resolve(l.value).then(s,a)};o((n=n.apply(t,e)).next())})},BU=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?ch:ch.apply(null,arguments)};function VU(t){if(typeof t!="object"||t===null)return!1;var e=Object.getPrototypeOf(t);if(e===null)return!0;for(var n=e;Object.getPrototypeOf(n)!==null;)n=Object.getPrototypeOf(n);return e===n}var HU=function(t){lR(e,t);function e(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var i=t.apply(this,n)||this;return Object.setPrototypeOf(i,e.prototype),i}return Object.defineProperty(e,Symbol.species,{get:function(){return e},enumerable:!1,configurable:!0}),e.prototype.concat=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return t.prototype.concat.apply(this,n)},e.prototype.prepend=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return n.length===1&&Array.isArray(n[0])?new(e.bind.apply(e,fo([void 0],n[0].concat(this)))):new(e.bind.apply(e,fo([void 0],n.concat(this))))},e}(Array),WU=function(t){lR(e,t);function e(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var i=t.apply(this,n)||this;return Object.setPrototypeOf(i,e.prototype),i}return Object.defineProperty(e,Symbol.species,{get:function(){return e},enumerable:!1,configurable:!0}),e.prototype.concat=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return t.prototype.concat.apply(this,n)},e.prototype.prepend=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return n.length===1&&Array.isArray(n[0])?new(e.bind.apply(e,fo([void 0],n[0].concat(this)))):new(e.bind.apply(e,fo([void 0],n.concat(this))))},e}(Array);function A0(t){return ai(t)?iR(t,function(){}):t}function qU(t){return typeof t=="boolean"}function GU(){return function(e){return KU(e)}}function KU(t){t===void 0&&(t={});var e=t.thunk,n=e===void 0?!0:e;t.immutableCheck,t.serializableCheck;var r=new HU;return n&&(qU(n)?r.push(jE):r.push(jE.withExtraArgument(n.extraArgument))),r}var QU=!0;function XU(t){var e=GU(),n=t||{},r=n.reducer,i=r===void 0?void 0:r,s=n.middleware,a=s===void 0?e():s,o=n.devTools,l=o===void 0?!0:o,u=n.preloadedState,d=u===void 0?void 0:u,h=n.enhancers,m=h===void 0?void 0:h,p;if(typeof i=="function")p=i;else if(VU(i))p=jU(i);else throw new Error('"reducer" is a required argument, and must be a function or an object of functions that can be passed to combineReducers');var g=a;typeof g=="function"&&(g=g(e));var w=OU.apply(void 0,g),E=ch;l&&(E=BU(Ui({trace:!QU},typeof l=="object"&&l)));var v=new WU(w),y=v;Array.isArray(m)?y=fo([w],m):typeof m=="function"&&(y=m(v));var x=E.apply(void 0,y);return sR(p,d,x)}function Bi(t,e){function n(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];if(e){var s=e.apply(void 0,r);if(!s)throw new Error("prepareAction did not return an object");return Ui(Ui({type:t,payload:s.payload},"meta"in s&&{meta:s.meta}),"error"in s&&{error:s.error})}return{type:t,payload:r[0]}}return n.toString=function(){return""+t},n.type=t,n.match=function(r){return r.type===t},n}function cR(t){var e={},n=[],r,i={addCase:function(s,a){var o=typeof s=="string"?s:s.type;if(o in e)throw new Error("addCase cannot be called with two reducers for the same action type");return e[o]=a,i},addMatcher:function(s,a){return n.push({matcher:s,reducer:a}),i},addDefaultCase:function(s){return r=s,i}};return t(i),[e,n,r]}function YU(t){return typeof t=="function"}function JU(t,e,n,r){n===void 0&&(n=[]);var i=typeof e=="function"?cR(e):[e,n,r],s=i[0],a=i[1],o=i[2],l;if(YU(t))l=function(){return A0(t())};else{var u=A0(t);l=function(){return u}}function d(h,m){h===void 0&&(h=l());var p=fo([s[m.type]],a.filter(function(g){var w=g.matcher;return w(m)}).map(function(g){var w=g.reducer;return w}));return p.filter(function(g){return!!g}).length===0&&(p=[o]),p.reduce(function(g,w){if(w)if(Yi(g)){var E=g,v=w(E,m);return v===void 0?g:v}else{if(ai(g))return iR(g,function(y){return w(y,m)});var v=w(g,m);if(v===void 0){if(g===null)return g;throw Error("A case reducer on a non-draftable value must not return undefined")}return v}return g},h)}return d.getInitialState=l,d}function ZU(t,e){return t+"/"+e}function z1(t){var e=t.name;if(!e)throw new Error("`name` is a required option for createSlice");typeof process<"u";var n=typeof t.initialState=="function"?t.initialState:A0(t.initialState),r=t.reducers||{},i=Object.keys(r),s={},a={},o={};i.forEach(function(d){var h=r[d],m=ZU(e,d),p,g;"reducer"in h?(p=h.reducer,g=h.prepare):p=h,s[d]=p,a[m]=p,o[d]=g?Bi(m,g):Bi(m)});function l(){var d=typeof t.extraReducers=="function"?cR(t.extraReducers):[t.extraReducers],h=d[0],m=h===void 0?{}:h,p=d[1],g=p===void 0?[]:p,w=d[2],E=w===void 0?void 0:w,v=Ui(Ui({},m),a);return JU(n,function(y){for(var x in v)y.addCase(x,v[x]);for(var _=0,S=g;_<S.length;_++){var k=S[_];y.addMatcher(k.matcher,k.reducer)}E&&y.addDefaultCase(E)})}var u;return{name:e,reducer:function(d,h){return u||(u=l()),u(d,h)},actions:o,caseReducers:s,getInitialState:function(){return u||(u=l()),u.getInitialState()}}}var eB="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",tB=function(t){t===void 0&&(t=21);for(var e="",n=t;n--;)e+=eB[Math.random()*64|0];return e},nB=["name","message","stack","code"],Ep=function(){function t(e,n){this.payload=e,this.meta=n}return t}(),ME=function(){function t(e,n){this.payload=e,this.meta=n}return t}(),rB=function(t){if(typeof t=="object"&&t!==null){for(var e={},n=0,r=nB;n<r.length;n++){var i=r[n];typeof t[i]=="string"&&(e[i]=t[i])}return e}return{message:String(t)}};(function(){function t(e,n,r){var i=Bi(e+"/fulfilled",function(u,d,h,m){return{payload:u,meta:_p(Ui({},m||{}),{arg:h,requestId:d,requestStatus:"fulfilled"})}}),s=Bi(e+"/pending",function(u,d,h){return{payload:void 0,meta:_p(Ui({},h||{}),{arg:d,requestId:u,requestStatus:"pending"})}}),a=Bi(e+"/rejected",function(u,d,h,m,p){return{payload:m,error:(r&&r.serializeError||rB)(u||"Rejected"),meta:_p(Ui({},p||{}),{arg:h,requestId:d,rejectedWithValue:!!m,requestStatus:"rejected",aborted:(u==null?void 0:u.name)==="AbortError",condition:(u==null?void 0:u.name)==="ConditionError"})}}),o=typeof AbortController<"u"?AbortController:function(){function u(){this.signal={aborted:!1,addEventListener:function(){},dispatchEvent:function(){return!1},onabort:function(){},removeEventListener:function(){},reason:void 0,throwIfAborted:function(){}}}return u.prototype.abort=function(){},u}();function l(u){return function(d,h,m){var p=r!=null&&r.idGenerator?r.idGenerator(u):tB(),g=new o,w;function E(y){w=y,g.abort()}var v=function(){return UU(this,null,function(){var y,x,_,S,k,b,T;return DU(this,function(P){switch(P.label){case 0:return P.trys.push([0,4,,5]),S=(y=r==null?void 0:r.condition)==null?void 0:y.call(r,u,{getState:h,extra:m}),sB(S)?[4,S]:[3,2];case 1:S=P.sent(),P.label=2;case 2:if(S===!1||g.signal.aborted)throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};return k=new Promise(function(N,B){return g.signal.addEventListener("abort",function(){return B({name:"AbortError",message:w||"Aborted"})})}),d(s(p,u,(x=r==null?void 0:r.getPendingMeta)==null?void 0:x.call(r,{requestId:p,arg:u},{getState:h,extra:m}))),[4,Promise.race([k,Promise.resolve(n(u,{dispatch:d,getState:h,extra:m,requestId:p,signal:g.signal,abort:E,rejectWithValue:function(N,B){return new Ep(N,B)},fulfillWithValue:function(N,B){return new ME(N,B)}})).then(function(N){if(N instanceof Ep)throw N;return N instanceof ME?i(N.payload,p,u,N.meta):i(N,p,u)})])];case 3:return _=P.sent(),[3,5];case 4:return b=P.sent(),_=b instanceof Ep?a(null,p,u,b.payload,b.meta):a(b,p,u),[3,5];case 5:return T=r&&!r.dispatchConditionRejection&&a.match(_)&&_.meta.condition,T||d(_),[2,_]}})})}();return Object.assign(v,{abort:E,requestId:p,arg:u,unwrap:function(){return v.then(iB)}})}}return Object.assign(l,{pending:s,rejected:a,fulfilled:i,typePrefix:e})}return t.withTypes=function(){return t},t})();function iB(t){if(t.meta&&t.meta.rejectedWithValue)throw t.payload;if(t.error)throw t.error;return t.payload}function sB(t){return t!==null&&typeof t=="object"&&typeof t.then=="function"}var U1="listenerMiddleware";Bi(U1+"/add");Bi(U1+"/removeAll");Bi(U1+"/remove");var LE;typeof queueMicrotask=="function"&&queueMicrotask.bind(typeof window<"u"?window:typeof global<"u"?global:globalThis);SU();const Sp={currentPlaylist:null,playlistSongs:[]},uR=z1({name:"currentPlaylist",initialState:Sp,reducers:{setCurrentPlaylist(t,e){const{playlist:n,songs:r}=e.payload;t.currentPlaylist=n,t.playlistSongs=r},updateCurrentPlaylist:(t,e)=>{if(!t.currentPlaylist)return t;Object.assign(t.currentPlaylist,e.payload)},addSongsToPlaylist(t,e){if(!t.currentPlaylist)return t;const n=e.payload.map(r=>({...r,song_in:`playlist_${t.currentPlaylist.id}`,queue_id:Xs(4)}));t.playlistSongs.push(...n)},setPlaylistSong(t,e){t.playlistSongs=e.payload},removeSong(t,e){const{index:n}=e.payload;t.playlistSongs.splice(n,1)},resetCurrentPlaylist:t=>{t.currentPlaylist=Sp.currentPlaylist,t.playlistSongs=Sp.playlistSongs}}}),as=t=>t.currentPlaylist,{addSongsToPlaylist:aB,removeSong:qG,setCurrentPlaylist:oB,updateCurrentPlaylist:GG,resetCurrentPlaylist:dR,setPlaylistSong:FE}=uR.actions,lB=uR.reducer;function Do(){const t=Zt(),{user:e}=ln(),{currentPlaylist:n,playlistSongs:r}=oe(as),{playlists:i}=Jt(),[s,a]=f.useState(!1),{setErrorToast:o,setSuccessToast:l}=sr(),u=ir(),d=async v=>{if(!e)throw new Error("user not found");if(!v)throw new Error("playlist name invalid");const y=iv(v),x=Mb({id:y,by:e.email,name:v});a(!0);const _=[...i,x];await mn({collection:"playlist",data:x,id:y,msg:">>> api: set playlist doc"}),await xE(_,e),a(!1)},h=async()=>{if(!e||!n)return;a(!0);const v=i.filter(y=>y.id!==n.id);await ih({collection:"playlist",id:n.id,msg:">>> api: delete playlist doc"}),await xE(v,e),a(!1),u("/mysongs")},m=async v=>{try{if(!n)return;a(!0);const y=[...r.map(x=>x.id),...v.map(x=>x.id)];await mn({collection:"playlist",id:n==null?void 0:n.id,data:{song_ids:y},msg:">>> api: update playlist doc"}),t(aB(v)),l(`${v.length} songs added`)}catch(y){console.log({message:y}),o()}finally{a(!1)}},p=async(v,y)=>{try{a(!0);const x={...y,name:v};await mn({collection:"playlist",data:{name:v},id:x.id,msg:">>> api: set playlist doc"}),l("Playlist edited")}catch(x){throw console.log(x),new Error("Error when edit playlist")}finally{a(!1)}},g=async(v,y)=>{try{a(!0);const x=await uo({collection:"playlist",id:y.id});if(!x.exists())return;const _=x.data();if(_.song_ids.includes(v.id)){a(!1);return}const S=[..._.song_ids,v.id];await mn({collection:"playlist",id:_.id,data:{song_ids:S},msg:">>> api: update playlist doc"})}catch(x){throw console.log({message:x}),new Error("Error when edit playlist")}finally{a(!1)}},w=async(v,y)=>{try{if(!n)return;y?y(!0):a(!0);const x=r.filter(_=>_.id!==v.id);await mn({collection:"playlist",id:n.id,data:{song_ids:x.map(_=>_.id)},msg:">>> api: update playlist doc"}),t(FE(x)),l(`'${v.name}' removed`)}catch(x){console.log({message:x})}finally{y?y(!1):a(!1)}};return{isFetching:s,addPlaylist:d,editPlaylist:p,deletePlaylist:h,addSongs:m,removeSelectSongs:async(v,y)=>{try{if(!n||!r.length)return;if(v.length===1)return w(v[0]);y?y(!0):a(!0);const x=v.map(k=>k.id),_=[...r].filter(k=>!x.includes(k.id)),S=_.map(k=>k.id);return await mn({collection:"playlist",id:n.id,data:{song_ids:S},msg:">>> api: update playlist doc"}),t(FE(_)),a(!1),l(`${v.length} songs removed`),_}catch(x){o(),console.log({message:x})}finally{y?y(!1):a(!1)}},removeSong:w,addSongsSongItem:g}}function cB({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{fillRule:"evenodd",d:"M10 17a.75.75 0 01-.75-.75V5.612L5.29 9.77a.75.75 0 01-1.08-1.04l5.25-5.5a.75.75 0 011.08 0l5.25 5.5a.75.75 0 11-1.08 1.04l-3.96-4.158V16.25A.75.75 0 0110 17z",clipRule:"evenodd"}))}const uB=f.forwardRef(cB),dB=uB;function hB({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{fillRule:"evenodd",d:"M2 4.75A.75.75 0 012.75 4h14.5a.75.75 0 010 1.5H2.75A.75.75 0 012 4.75zM2 10a.75.75 0 01.75-.75h14.5a.75.75 0 010 1.5H2.75A.75.75 0 012 10zm0 5.25a.75.75 0 01.75-.75h14.5a.75.75 0 010 1.5H2.75a.75.75 0 01-.75-.75z",clipRule:"evenodd"}))}const fB=f.forwardRef(hB),mB=fB;function pB({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{fillRule:"evenodd",d:"M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.05-.143z",clipRule:"evenodd"}))}const gB=f.forwardRef(pB),R0=gB;function yB({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{fillRule:"evenodd",d:"M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z",clipRule:"evenodd"}))}const vB=f.forwardRef(yB),xB=vB;function wB({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{fillRule:"evenodd",d:"M12.79 5.23a.75.75 0 01-.02 1.06L8.832 10l3.938 3.71a.75.75 0 11-1.04 1.08l-4.5-4.25a.75.75 0 010-1.08l4.5-4.25a.75.75 0 011.06.02z",clipRule:"evenodd"}))}const _B=f.forwardRef(wB),hR=_B;function EB({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{fillRule:"evenodd",d:"M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z",clipRule:"evenodd"}))}const SB=f.forwardRef(EB),kB=SB;function bB({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{fillRule:"evenodd",d:"M7.84 1.804A1 1 0 018.82 1h2.36a1 1 0 01.98.804l.331 1.652a6.993 6.993 0 011.929 1.115l1.598-.54a1 1 0 011.186.447l1.18 2.044a1 1 0 01-.205 1.251l-1.267 1.113a7.047 7.047 0 010 2.228l1.267 1.113a1 1 0 01.206 1.25l-1.18 2.045a1 1 0 01-1.187.447l-1.598-.54a6.993 6.993 0 01-1.929 1.115l-.33 1.652a1 1 0 01-.98.804H8.82a1 1 0 01-.98-.804l-.331-1.652a6.993 6.993 0 01-1.929-1.115l-1.598.54a1 1 0 01-1.186-.447l-1.18-2.044a1 1 0 01.205-1.251l1.267-1.114a7.05 7.05 0 010-2.227L1.821 7.773a1 1 0 01-.206-1.25l1.18-2.045a1 1 0 011.187-.447l1.598.54A6.993 6.993 0 017.51 3.456l.33-1.652zM10 13a3 3 0 100-6 3 3 0 000 6z",clipRule:"evenodd"}))}const TB=f.forwardRef(bB),IB=TB;function CB({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{fillRule:"evenodd",d:"M4.5 2A1.5 1.5 0 003 3.5v13A1.5 1.5 0 004.5 18h11a1.5 1.5 0 001.5-1.5V7.621a1.5 1.5 0 00-.44-1.06l-4.12-4.122A1.5 1.5 0 0011.378 2H4.5zm2.25 8.5a.75.75 0 000 1.5h6.5a.75.75 0 000-1.5h-6.5zm0 3a.75.75 0 000 1.5h6.5a.75.75 0 000-1.5h-6.5z",clipRule:"evenodd"}))}const AB=f.forwardRef(CB),RB=AB;function PB({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{d:"M5.433 13.917l1.262-3.155A4 4 0 017.58 9.42l6.92-6.918a2.121 2.121 0 013 3l-6.92 6.918c-.383.383-.84.685-1.343.886l-3.154 1.262a.5.5 0 01-.65-.65z"}),f.createElement("path",{d:"M3.5 5.75c0-.69.56-1.25 1.25-1.25H10A.75.75 0 0010 3H4.75A2.75 2.75 0 002 5.75v9.5A2.75 2.75 0 004.75 18h9.5A2.75 2.75 0 0017 15.25V10a.75.75 0 00-1.5 0v5.25c0 .69-.56 1.25-1.25 1.25h-9.5c-.69 0-1.25-.56-1.25-1.25v-9.5z"}))}const NB=f.forwardRef(PB),jB=NB;function OB({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{d:"M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"}))}const DB=f.forwardRef(OB),MB=DB;function Or({close:t,title:e}){return c.jsxs("div",{className:"flex justify-between mb-3",children:[c.jsx("div",{className:"text-xl leading-[2.2] font-playwriteCU",children:e}),c.jsx("button",{onClick:t,children:c.jsx(MB,{className:"w-7"})})]})}function LB({closeModal:t,playlistSongs:e,variant:n}){const{theme:r}=H(),{selectedSongs:i}=To(),{songs:s,sysSongPlaylist:a}=Jt(),{addSongs:o,isFetching:l}=Do(),u=f.useMemo(()=>n==="dashboard"?a.songs:n==="my-song"?s:[],[a,s]),d={addSongContainer:"pb-[40px] relative",addSongContent:"max-h-[calc(60vh)] w-[700px] max-w-[80vw] overflow-auto"},h=f.useMemo(()=>!!i.length,[i]),m=async()=>{await o(i),t()};return c.jsxs("div",{className:d.addSongContainer,children:[c.jsx(Or,{close:t,title:"Add song to playlist"}),c.jsxs("div",{className:d.addSongContent,children:[c.jsxs(V,{onClick:m,variant:"primary",isLoading:l,className:`rounded-full ${r.content_bg} absolute bottom-0 right-[15px] min-w-[34px] h-[32px] ${!h&&"disable"}`,children:["Add",`${i.length?` (${i.length})`:""}`]}),u.length?u.map((p,g)=>{if(e.findIndex(E=>E.id===p.id)===-1)return c.jsx(Qb,{song:p,variant:"select",theme:r},g)}):c.jsx("p",{children:"No song jet..."})]})]})}function FB(t){return c.jsx(Js,{children:c.jsx(LB,{...t})})}function $B({text:t,className:e="",status:n,activeColor:r},i){const s=()=>{switch(n){case"coming":return"";case"active":return`${r||"text-[#ffed00]"} active-lyric`;case"done":return"disable"}};return f.useEffect(()=>{n==="active"&&scroll()},[n]),c.jsx("p",{ref:i,className:`${e} select-none  font-[700] ${s()}`,children:t})}const fR=f.forwardRef($B);function $E({handlePlayPause:t,playStatus:e}){const n={icon:"w-[50px] sm:w-10"},r=()=>{switch(e){case"playing":return c.jsx(Hh,{className:`${n.icon}`});case"error":return c.jsx(Bh,{className:`${n.icon}`});case"loading":case"waiting":return c.jsx(rs,{className:`${n.icon} animate-spin`});case"paused":return c.jsx(Wh,{className:`${n.icon}`})}};return c.jsx(c.Fragment,{children:c.jsx("button",{className:"p-1  inline-flex items-center justify-center",onClick:()=>t(),children:r()})})}const zB=()=>{const t=Yn();return{playStatus:"paused",triggerPlayStatus:"",lyricSize:t.lyricSize||"medium",isLoaded:!0,isRepeat:t.isRepeat||"no",isShuffle:t.isShuffle||!1,isCrossFade:t.isCrossFade||!1,songBackground:t.songBackground||!0}},mR=z1({name:"playStatus",initialState:()=>zB(),reducers:{setPlayStatus(t,e){Object.assign(t,e.payload)},togglePlayControl(t,e){const{variant:n}=e.payload;switch(n){default:if(typeof t[n]=="boolean"){const r=!t[n];t[n]=r,kt(n,r)}}}}}),zn=t=>t.playStatus,{setPlayStatus:wt,togglePlayControl:UB}=mR.actions,BB=mR.reducer,VB=Yn().queue||[],zE={queueSongs:VB,currentQueueId:null,currentSongData:null};function kp(t){for(let e=0;e<t.queueSongs.length;e++){const n=t.queueSongs[e];if(n.queue_id===t.currentQueueId){t.currentSongData={song:n,index:e};return}}t.currentSongData=null}const pR=z1({name:"songQueue",initialState:zE,reducers:{setQueue(t,e){const n=e.payload.songs;t.queueSongs=n,kp(t),kt("queue",n)},setCurrentQueueId(t,e){const n=e.payload;t.currentQueueId=n,kp(t)},removeSongFromQueue(t,e){const{index:n}=e.payload;t.queueSongs.splice(n,1),kt("queue",t.queueSongs),t.currentSongData&&n<=t.currentSongData.index&&kp(t)},addSongToQueue:(t,e)=>{const n=e.payload.songs.map(r=>({...r,queue_id:Xs(4)}));t.queueSongs.push(...n),kt("queue",t.queueSongs)},resetSongQueue:t=>{Object.assign(t,zE)}}}),It=t=>t.songQueue,{addSongToQueue:gR,setCurrentQueueId:Ji,removeSongFromQueue:HB,setQueue:WB,resetSongQueue:qB}=pR.actions,GB=pR.reducer;function yR({active:t}){const{audioRef:e}=Qt();if(!e.current)throw new Error("useSongLyric !audioRef.current");const{playStatus:n}=oe(zn),{currentSongData:r}=oe(It),{setLoading:i,setSongLyrics:s,songLyrics:a,loading:o,ranGetLyric:l}=T7(),[u,d]=f.useState(!1),h=f.useRef(),m=async()=>{try{if(!r)return i(!1);i(!0);const g=await uo({collection:"lyrics",id:r.song.id,msg:">>> api: get lyric doc"});if(g.exists()){const w=g.data();typeof w.real_time=="string"?s(JSON.parse(w.real_time||"[]")):s(w.real_time)}}catch(g){console.log({message:g})}finally{i(!1)}},p=()=>{clearTimeout(h.current),d(!1),i(!0),s([]),l.current=!1};return f.useEffect(()=>{const g=async()=>{d(!0)};return e.current.addEventListener("loadeddata",g),()=>{var w;(w=e.current)==null||w.removeEventListener("loadeddata",g)}},[]),f.useEffect(()=>{a.length||u&&t&&(l.current||(l.current=!0,h.current=setTimeout(()=>{m()},500)))},[u,t]),f.useEffect(()=>{if(n==="error"){i(!1);return}return()=>{p()}},[r,n==="error"]),{songLyrics:a,loading:o,playStatus:n}}const vR=(t,e)=>{const[n,r]=f.useState(()=>JSON.parse(localStorage.getItem("HD-MP3")||"{}")[t]||e);return f.useEffect(()=>{const i=JSON.parse(localStorage.getItem("HD-MP3")||"{}");i[t]=n,localStorage.setItem("HD-MP3",JSON.stringify(i))},[n]),[n,r]};function xR({admin:t}){const{currentPlaylist:e,playlistSongs:n}=oe(as),r=f.useRef(!1),i=async()=>{if(!e||e.by==="admin"&&!t)return;if(e.image_url){if(!n[0].image_url&&!r.current)return r.current=!0,await mn({collection:"playlist",id:e.id,data:{blurhash_encode:"",image_url:""},msg:">>> api: clear playlist image"});if(e.image_url===n[0].image_url)return}if(!n[0].image_url)return;const s={image_url:n[0].image_url,blurhash_encode:n[0].blurhash_encode||""};await mn({collection:"playlist",id:e.id,data:s,msg:">>> api: update playlist image"})};f.useEffect(()=>{!n.length||!e||i()},[n])}const wR=()=>{window.dispatchEvent(new Event("mousemove"))},_R=(t,e,n=!1)=>{const r=window.innerWidth,s=t.getBoundingClientRect().left,a=r-(s+t.offsetWidth),o=Math.abs(Math.ceil(s-a))/2;if(o<5)return!1;n&&(e.onscroll=()=>{},setTimeout(()=>{e.onscroll=wR},900)),n||Math.abs(s)>r||Math.abs(a)>r?e.style.scrollBehavior="auto":e.style.scrollBehavior="smooth";let l=e.scrollLeft;return a>s?setTimeout(()=>{e.scrollLeft=l-o},300):a<s&&setTimeout(()=>{e.scrollLeft=l+o},300),!0};function KB({containerRef:t,songItemRef:e,idle:n}){const{isOpenFullScreen:r}=Qt(),{currentQueueId:i}=oe(It),s=()=>{!(e!=null&&e.current)||!(t!=null&&t.current)||_R(e.current,t.current,n)};f.useEffect(()=>{r&&s()},[i,r]),f.useEffect(()=>{const a=t==null?void 0:t.current;if(a)return a.onscroll=wR,()=>{a.onscroll=()=>{}}},[])}function QB({textRef:t,textWrapperRef:e,content:n}){const r=f.useRef(),i=f.useRef(),s=f.useRef(!1),a=f.useRef(0),o=f.useRef(0),l=f.useRef(0),u=()=>{t.current&&(t.current.style.transition="none",t.current.style.transform="translateX(0)")},d=()=>{t.current&&(t.current.style.transition=`transform linear ${o.current}s`,t.current.style.transform=`translateX(-${l.current}px)`,i.current=setTimeout(u,o.current*1e3))},h=()=>{!t.current||!e.current||(l.current=t.current.offsetWidth-a.current,o.current=Math.ceil(l.current/35))},m=()=>{!s.current||!t.current||!e.current||(o.current=0,l.current=0,s.current=!1,clearInterval(r.current),clearTimeout(i.current),e.current.classList.remove("mask-image-horizontal"),u())},p=()=>{!t.current||!e.current||!n||!(t.current.offsetWidth>e.current.offsetWidth)||(s.current=!0,e.current.classList.add("mask-image-horizontal"),a.current=t.current.clientWidth,t.current.innerHTML=t.current.innerText+"&nbsp; &nbsp; &nbsp;"+t.current.innerText,h(),setTimeout(d,1e3),r.current=setInterval(d,o.current*1e3+3e3))};f.useEffect(()=>(p(),m),[n])}const XB=({song:t,closeModal:e,triggerRef:n})=>{const{setErrorToast:r,setSuccessToast:i}=sr(),{songs:s,setSongs:a}=Jt(),[o,l]=f.useState(!1),{removeSong:u,addSongsSongItem:d}=Do();return{handleDeleteSong:async()=>{try{l(!0);const w=s.filter(E=>E.id!==t.id);await zA(t),a(w),i(`'${t.name}' deleted`)}catch(w){throw console.log({message:w}),new Error("Error when delete song")}finally{l(!1),e()}},handleAddSongToPlaylistMobile:async w=>{try{l(!0),await d(t,w),i(`'${t.name}' added to '${w.name}'`)}catch(E){throw console.log(E),new Error("Error when add song to playlist")}finally{l(!1),e()}},handleRemoveSongFromPlaylist:async()=>{await u(t,l)},handleAddSongToPlaylist:async w=>{var E;if(!t||!w){r("Lack of props");return}try{l(!0),await d(t,w),i(`'${t.name}' added to '${w.name}'`)}catch(v){throw console.log(v),new Error("Error when add song to playlist")}finally{l(!1),(E=n.current)==null||E.close()}},loading:o}},YB="End-Of-Stream";class Ke extends Error{constructor(){super(YB)}}class JB{constructor(){this.maxStreamReadSize=1*1024*1024,this.endOfStream=!1,this.peekQueue=[]}async peek(e,n,r){const i=await this.read(e,n,r);return this.peekQueue.push(e.subarray(n,n+i)),i}async read(e,n,r){if(r===0)return 0;let i=this.readFromPeekBuffer(e,n,r);if(i+=await this.readRemainderFromStream(e,n+i,r-i),i===0)throw new Ke;return i}readFromPeekBuffer(e,n,r){let i=r,s=0;for(;this.peekQueue.length>0&&i>0;){const a=this.peekQueue.pop();if(!a)throw new Error("peekData should be defined");const o=Math.min(a.length,i);e.set(a.subarray(0,o),n+s),s+=o,i-=o,o<a.length&&this.peekQueue.push(a.subarray(o))}return s}async readRemainderFromStream(e,n,r){let i=r,s=0;for(;i>0&&!this.endOfStream;){const a=Math.min(i,this.maxStreamReadSize),o=await this.readFromStream(e,n+s,a);if(o===0)break;s+=o,i-=o}return s}}class ZB extends JB{constructor(e){super(),this.reader=e.getReader({mode:"byob"})}async readFromStream(e,n,r){if(this.endOfStream)throw new Ke;const i=await this.reader.read(new Uint8Array(r));return i.done&&(this.endOfStream=i.done),i.value?(e.set(i.value,n),i.value.byteLength):0}}class ER{constructor(e){this.position=0,this.numBuffer=new Uint8Array(8),this.fileInfo=(e==null?void 0:e.fileInfo)??{},this.onClose=e==null?void 0:e.onClose}async readToken(e,n=this.position){const r=new Uint8Array(e.len);if(await this.readBuffer(r,{position:n})<e.len)throw new Ke;return e.get(r,0)}async peekToken(e,n=this.position){const r=new Uint8Array(e.len);if(await this.peekBuffer(r,{position:n})<e.len)throw new Ke;return e.get(r,0)}async readNumber(e){if(await this.readBuffer(this.numBuffer,{length:e.len})<e.len)throw new Ke;return e.get(this.numBuffer,0)}async peekNumber(e){if(await this.peekBuffer(this.numBuffer,{length:e.len})<e.len)throw new Ke;return e.get(this.numBuffer,0)}async ignore(e){if(this.fileInfo.size!==void 0){const n=this.fileInfo.size-this.position;if(e>n)return this.position+=n,n}return this.position+=e,e}async close(){var e;await((e=this.onClose)==null?void 0:e.call(this))}normalizeOptions(e,n){if(n&&n.position!==void 0&&n.position<this.position)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");return n?{mayBeLess:n.mayBeLess===!0,offset:n.offset?n.offset:0,length:n.length?n.length:e.length-(n.offset?n.offset:0),position:n.position?n.position:this.position}:{mayBeLess:!1,offset:0,length:e.length,position:this.position}}}const eV=256e3;class tV extends ER{constructor(e,n){super(n),this.streamReader=e}async readBuffer(e,n){const r=this.normalizeOptions(e,n),i=r.position-this.position;if(i>0)return await this.ignore(i),this.readBuffer(e,n);if(i<0)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");if(r.length===0)return 0;const s=await this.streamReader.read(e,r.offset,r.length);if(this.position+=s,(!n||!n.mayBeLess)&&s<r.length)throw new Ke;return s}async peekBuffer(e,n){const r=this.normalizeOptions(e,n);let i=0;if(r.position){const s=r.position-this.position;if(s>0){const a=new Uint8Array(r.length+s);return i=await this.peekBuffer(a,{mayBeLess:r.mayBeLess}),e.set(a.subarray(s),r.offset),i-s}if(s<0)throw new Error("Cannot peek from a negative offset in a stream")}if(r.length>0){try{i=await this.streamReader.peek(e,r.offset,r.length)}catch(s){if(n!=null&&n.mayBeLess&&s instanceof Ke)return 0;throw s}if(!r.mayBeLess&&i<r.length)throw new Ke}return i}async ignore(e){const n=Math.min(eV,e),r=new Uint8Array(n);let i=0;for(;i<e;){const s=e-i,a=await this.readBuffer(r,{length:Math.min(n,s)});if(a<0)return a;i+=a}return i}}class nV extends ER{constructor(e,n){super(n),this.uint8Array=e,this.fileInfo.size=this.fileInfo.size?this.fileInfo.size:e.length}async readBuffer(e,n){if(n!=null&&n.position){if(n.position<this.position)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");this.position=n.position}const r=await this.peekBuffer(e,n);return this.position+=r,r}async peekBuffer(e,n){const r=this.normalizeOptions(e,n),i=Math.min(this.uint8Array.length-r.position,r.length);if(!r.mayBeLess&&i<r.length)throw new Ke;return e.set(this.uint8Array.subarray(r.position,r.position+i),r.offset),i}close(){return super.close()}}function SR(t,e){return new tV(new ZB(t),e)}function mo(t,e){return new nV(t,e)}/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */var sm=function(t,e,n,r,i){var s,a,o=i*8-r-1,l=(1<<o)-1,u=l>>1,d=-7,h=n?i-1:0,m=n?-1:1,p=t[e+h];for(h+=m,s=p&(1<<-d)-1,p>>=-d,d+=o;d>0;s=s*256+t[e+h],h+=m,d-=8);for(a=s&(1<<-d)-1,s>>=-d,d+=r;d>0;a=a*256+t[e+h],h+=m,d-=8);if(s===0)s=1-u;else{if(s===l)return a?NaN:(p?-1:1)*(1/0);a=a+Math.pow(2,r),s=s-u}return(p?-1:1)*a*Math.pow(2,s-r)},am=function(t,e,n,r,i,s){var a,o,l,u=s*8-i-1,d=(1<<u)-1,h=d>>1,m=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:s-1,g=r?1:-1,w=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(o=isNaN(e)?1:0,a=d):(a=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-a))<1&&(a--,l*=2),a+h>=1?e+=m/l:e+=m*Math.pow(2,1-h),e*l>=2&&(a++,l/=2),a+h>=d?(o=0,a=d):a+h>=1?(o=(e*l-1)*Math.pow(2,i),a=a+h):(o=e*Math.pow(2,h-1)*Math.pow(2,i),a=0));i>=8;t[n+p]=o&255,p+=g,o/=256,i-=8);for(a=a<<i|o,u+=i;u>0;t[n+p]=a&255,p+=g,a/=256,u-=8);t[n+p-g]|=w*128};function re(t){return new DataView(t.buffer,t.byteOffset)}const ie={len:1,get(t,e){return re(t).getUint8(e)},put(t,e,n){return re(t).setUint8(e,n),e+1}},ye={len:2,get(t,e){return re(t).getUint16(e,!0)},put(t,e,n){return re(t).setUint16(e,n,!0),e+2}},_e={len:2,get(t,e){return re(t).getUint16(e)},put(t,e,n){return re(t).setUint16(e,n),e+2}},uh={len:3,get(t,e){const n=re(t);return n.getUint8(e)+(n.getUint16(e+1,!0)<<8)},put(t,e,n){const r=re(t);return r.setUint8(e,n&255),r.setUint16(e+1,n>>8,!0),e+3}},Kt={len:3,get(t,e){const n=re(t);return(n.getUint16(e)<<8)+n.getUint8(e+2)},put(t,e,n){const r=re(t);return r.setUint16(e,n>>8),r.setUint8(e+2,n&255),e+3}},q={len:4,get(t,e){return re(t).getUint32(e,!0)},put(t,e,n){return re(t).setUint32(e,n,!0),e+4}},X={len:4,get(t,e){return re(t).getUint32(e)},put(t,e,n){return re(t).setUint32(e,n),e+4}},mc={len:1,get(t,e){return re(t).getInt8(e)},put(t,e,n){return re(t).setInt8(e,n),e+1}},qr={len:2,get(t,e){return re(t).getInt16(e)},put(t,e,n){return re(t).setInt16(e,n),e+2}},rV={len:2,get(t,e){return re(t).getInt16(e,!0)},put(t,e,n){return re(t).setInt16(e,n,!0),e+2}},iV={len:3,get(t,e){const n=uh.get(t,e);return n>8388607?n-16777216:n},put(t,e,n){const r=re(t);return r.setUint8(e,n&255),r.setUint16(e+1,n>>8,!0),e+3}},B1={len:3,get(t,e){const n=Kt.get(t,e);return n>8388607?n-16777216:n},put(t,e,n){const r=re(t);return r.setUint16(e,n>>8),r.setUint8(e+2,n&255),e+3}},_n={len:4,get(t,e){return re(t).getInt32(e)},put(t,e,n){return re(t).setInt32(e,n),e+4}},qe={len:4,get(t,e){return re(t).getInt32(e,!0)},put(t,e,n){return re(t).setInt32(e,n,!0),e+4}},Wt={len:8,get(t,e){return re(t).getBigUint64(e,!0)},put(t,e,n){return re(t).setBigUint64(e,n,!0),e+8}},dh={len:8,get(t,e){return re(t).getBigInt64(e,!0)},put(t,e,n){return re(t).setBigInt64(e,n,!0),e+8}},V1={len:8,get(t,e){return re(t).getBigUint64(e)},put(t,e,n){return re(t).setBigUint64(e,n),e+8}},kR={len:8,get(t,e){return re(t).getBigInt64(e)},put(t,e,n){return re(t).setBigInt64(e,n),e+8}},sV={len:2,get(t,e){return sm(t,e,!1,10,this.len)},put(t,e,n){return am(t,n,e,!1,10,this.len),e+this.len}},aV={len:2,get(t,e){return sm(t,e,!0,10,this.len)},put(t,e,n){return am(t,n,e,!0,10,this.len),e+this.len}},bR={len:4,get(t,e){return re(t).getFloat32(e)},put(t,e,n){return re(t).setFloat32(e,n),e+4}},oV={len:4,get(t,e){return re(t).getFloat32(e,!0)},put(t,e,n){return re(t).setFloat32(e,n,!0),e+4}},P0={len:8,get(t,e){return re(t).getFloat64(e)},put(t,e,n){return re(t).setFloat64(e,n),e+8}},lV={len:8,get(t,e){return re(t).getFloat64(e,!0)},put(t,e,n){return re(t).setFloat64(e,n,!0),e+8}},cV={len:10,get(t,e){return sm(t,e,!1,63,this.len)},put(t,e,n){return am(t,n,e,!1,63,this.len),e+this.len}},uV={len:10,get(t,e){return sm(t,e,!0,63,this.len)},put(t,e,n){return am(t,n,e,!0,63,this.len),e+this.len}};class dV{constructor(e){this.len=e}get(e,n){}}class en{constructor(e){this.len=e}get(e,n){return e.subarray(n,n+this.len)}}class Q{constructor(e,n){this.len=e,this.encoding=n,this.textDecoder=new TextDecoder(n)}get(e,n){return this.textDecoder.decode(e.subarray(n,n+this.len))}}class hV{constructor(e){this.len=e,this.textDecoder=new TextDecoder("windows-1252")}get(e,n=0){return this.textDecoder.decode(e.subarray(n,n+this.len))}}const fV=Object.freeze(Object.defineProperty({__proto__:null,AnsiStringType:hV,Float16_BE:sV,Float16_LE:aV,Float32_BE:bR,Float32_LE:oV,Float64_BE:P0,Float64_LE:lV,Float80_BE:cV,Float80_LE:uV,INT16_BE:qr,INT16_LE:rV,INT24_BE:B1,INT24_LE:iV,INT32_BE:_n,INT32_LE:qe,INT64_BE:kR,INT64_LE:dh,INT8:mc,IgnoreType:dV,StringType:Q,UINT16_BE:_e,UINT16_LE:ye,UINT24_BE:Kt,UINT24_LE:uh,UINT32_BE:X,UINT32_LE:q,UINT64_BE:V1,UINT64_LE:Wt,UINT8:ie,Uint8ArrayType:en},Symbol.toStringTag,{value:"Module"})),mV=Object.prototype.toString,pV="[object Uint8Array]",gV="[object ArrayBuffer]";function TR(t,e,n){return t?t.constructor===e?!0:mV.call(t)===n:!1}function IR(t){return TR(t,Uint8Array,pV)}function yV(t){return TR(t,ArrayBuffer,gV)}function vV(t){return IR(t)||yV(t)}function xV(t){if(!IR(t))throw new TypeError(`Expected \`Uint8Array\`, got \`${typeof t}\``)}function wV(t){if(!vV(t))throw new TypeError(`Expected \`Uint8Array\` or \`ArrayBuffer\`, got \`${typeof t}\``)}const ku={utf8:new globalThis.TextDecoder("utf8")};function H1(t,e="utf8"){return wV(t),ku[e]??(ku[e]=new globalThis.TextDecoder(e)),ku[e].decode(t)}function CR(t){if(typeof t!="string")throw new TypeError(`Expected \`string\`, got \`${typeof t}\``)}const _V=new globalThis.TextEncoder;function EV(t){return CR(t),_V.encode(t)}const SV=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function W1(t){xV(t);let e="";for(let n=0;n<t.length;n++)e+=SV[t[n]];return e}const UE={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,a:10,b:11,c:12,d:13,e:14,f:15,A:10,B:11,C:12,D:13,E:14,F:15};function BE(t){if(CR(t),t.length%2!==0)throw new Error("Invalid Hex string length.");const e=t.length/2,n=new Uint8Array(e);for(let r=0;r<e;r++){const i=UE[t[r*2]],s=UE[t[r*2+1]];if(i===void 0||s===void 0)throw new Error(`Invalid Hex character encountered at position ${r*2}`);n[r]=i<<4|s}return n}function VE(t){const{byteLength:e}=t;if(e===6)return t.getUint16(0)*2**32+t.getUint32(2);if(e===5)return t.getUint8(0)*2**32+t.getUint32(1);if(e===4)return t.getUint32(0);if(e===3)return t.getUint8(0)*2**16+t.getUint16(1);if(e===2)return t.getUint16(0);if(e===1)return t.getUint8(0)}function AR(t,e){const n=t.length,r=e.length;if(r===0||r>n)return-1;const i=n-r;for(let s=0;s<=i;s++){let a=!0;for(let o=0;o<r;o++)if(t[s+o]!==e[o]){a=!1;break}if(a)return s}return-1}function kV(t,e){return AR(t,e)!==-1}function bV(t){return[...t].map(e=>e.charCodeAt(0))}function TV(t,e=0){const n=Number.parseInt(new Q(6).get(t,148).replace(/\0.*$/,"").trim(),8);if(Number.isNaN(n))return!1;let r=8*32;for(let i=e;i<e+148;i++)r+=t[i];for(let i=e+156;i<e+512;i++)r+=t[i];return n===r}const IV={get:(t,e)=>t[e+3]&127|t[e+2]<<7|t[e+1]<<14|t[e]<<21,len:4},CV=["jpg","png","apng","gif","webp","flif","xcf","cr2","cr3","orf","arw","dng","nef","rw2","raf","tif","bmp","icns","jxr","psd","indd","zip","tar","rar","gz","bz2","7z","dmg","mp4","mid","mkv","webm","mov","avi","mpg","mp2","mp3","m4a","oga","ogg","ogv","opus","flac","wav","spx","amr","pdf","epub","elf","macho","exe","swf","rtf","wasm","woff","woff2","eot","ttf","otf","ico","flv","ps","xz","sqlite","nes","crx","xpi","cab","deb","ar","rpm","Z","lz","cfb","mxf","mts","blend","bpg","docx","pptx","xlsx","3gp","3g2","j2c","jp2","jpm","jpx","mj2","aif","qcp","odt","ods","odp","xml","mobi","heic","cur","ktx","ape","wv","dcm","ics","glb","pcap","dsf","lnk","alias","voc","ac3","m4v","m4p","m4b","f4v","f4p","f4b","f4a","mie","asf","ogm","ogx","mpc","arrow","shp","aac","mp1","it","s3m","xm","ai","skp","avif","eps","lzh","pgp","asar","stl","chm","3mf","zst","jxl","vcf","jls","pst","dwg","parquet","class","arj","cpio","ace","avro","icc","fbx","vsdx"],AV=["image/jpeg","image/png","image/gif","image/webp","image/flif","image/x-xcf","image/x-canon-cr2","image/x-canon-cr3","image/tiff","image/bmp","image/vnd.ms-photo","image/vnd.adobe.photoshop","application/x-indesign","application/epub+zip","application/x-xpinstall","application/vnd.oasis.opendocument.text","application/vnd.oasis.opendocument.spreadsheet","application/vnd.oasis.opendocument.presentation","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/zip","application/x-tar","application/x-rar-compressed","application/gzip","application/x-bzip2","application/x-7z-compressed","application/x-apple-diskimage","application/x-apache-arrow","video/mp4","audio/midi","video/x-matroska","video/webm","video/quicktime","video/vnd.avi","audio/wav","audio/qcelp","audio/x-ms-asf","video/x-ms-asf","application/vnd.ms-asf","video/mpeg","video/3gpp","audio/mpeg","audio/mp4","audio/opus","video/ogg","audio/ogg","application/ogg","audio/x-flac","audio/ape","audio/wavpack","audio/amr","application/pdf","application/x-elf","application/x-mach-binary","application/x-msdownload","application/x-shockwave-flash","application/rtf","application/wasm","font/woff","font/woff2","application/vnd.ms-fontobject","font/ttf","font/otf","image/x-icon","video/x-flv","application/postscript","application/eps","application/x-xz","application/x-sqlite3","application/x-nintendo-nes-rom","application/x-google-chrome-extension","application/vnd.ms-cab-compressed","application/x-deb","application/x-unix-archive","application/x-rpm","application/x-compress","application/x-lzip","application/x-cfb","application/x-mie","application/mxf","video/mp2t","application/x-blender","image/bpg","image/j2c","image/jp2","image/jpx","image/jpm","image/mj2","audio/aiff","application/xml","application/x-mobipocket-ebook","image/heif","image/heif-sequence","image/heic","image/heic-sequence","image/icns","image/ktx","application/dicom","audio/x-musepack","text/calendar","text/vcard","model/gltf-binary","application/vnd.tcpdump.pcap","audio/x-dsf","application/x.ms.shortcut","application/x.apple.alias","audio/x-voc","audio/vnd.dolby.dd-raw","audio/x-m4a","image/apng","image/x-olympus-orf","image/x-sony-arw","image/x-adobe-dng","image/x-nikon-nef","image/x-panasonic-rw2","image/x-fujifilm-raf","video/x-m4v","video/3gpp2","application/x-esri-shape","audio/aac","audio/x-it","audio/x-s3m","audio/x-xm","video/MP1S","video/MP2P","application/vnd.sketchup.skp","image/avif","application/x-lzh-compressed","application/pgp-encrypted","application/x-asar","model/stl","application/vnd.ms-htmlhelp","model/3mf","image/jxl","application/zstd","image/jls","application/vnd.ms-outlook","image/vnd.dwg","application/x-parquet","application/java-vm","application/x-arj","application/x-cpio","application/x-ace-compressed","application/avro","application/vnd.iccprofile","application/x.autodesk.fbx","application/vnd.visio"],HE=4100;async function RR(t){return new RV().fromBuffer(t)}function or(t,e,n){n={offset:0,...n};for(const[r,i]of e.entries())if(n.mask){if(i!==(n.mask[r]&t[r+n.offset]))return!1}else if(i!==t[r+n.offset])return!1;return!0}class RV{constructor(e){this.detectors=e==null?void 0:e.customDetectors,this.fromTokenizer=this.fromTokenizer.bind(this),this.fromBuffer=this.fromBuffer.bind(this),this.parse=this.parse.bind(this)}async fromTokenizer(e){const n=e.position;for(const r of this.detectors||[]){const i=await r(e);if(i)return i;if(n!==e.position)return}return this.parse(e)}async fromBuffer(e){if(!(e instanceof Uint8Array||e instanceof ArrayBuffer))throw new TypeError(`Expected the \`input\` argument to be of type \`Uint8Array\` or \`ArrayBuffer\`, got \`${typeof e}\``);const n=e instanceof Uint8Array?e:new Uint8Array(e);if((n==null?void 0:n.length)>1)return this.fromTokenizer(mo(n))}async fromBlob(e){return this.fromStream(e.stream())}async fromStream(e){const n=await SR(e);try{return await this.fromTokenizer(n)}finally{await n.close()}}async toDetectionStream(e,n){const{sampleSize:r=HE}=n;let i,s;const a=e.getReader({mode:"byob"});try{const{value:u,done:d}=await a.read(new Uint8Array(r));if(s=u,!d&&u)try{i=await this.fromBuffer(u.slice(0,r))}catch(h){if(!(h instanceof Ke))throw h;i=void 0}s=u}finally{a.releaseLock()}const o=new TransformStream({async start(u){u.enqueue(s)},transform(u,d){d.enqueue(u)}}),l=e.pipeThrough(o);return l.fileType=i,l}check(e,n){return or(this.buffer,e,n)}checkString(e,n){return this.check(bV(e),n)}async parse(e){if(this.buffer=new Uint8Array(HE),e.fileInfo.size===void 0&&(e.fileInfo.size=Number.MAX_SAFE_INTEGER),this.tokenizer=e,await e.peekBuffer(this.buffer,{length:12,mayBeLess:!0}),this.check([66,77]))return{ext:"bmp",mime:"image/bmp"};if(this.check([11,119]))return{ext:"ac3",mime:"audio/vnd.dolby.dd-raw"};if(this.check([120,1]))return{ext:"dmg",mime:"application/x-apple-diskimage"};if(this.check([77,90]))return{ext:"exe",mime:"application/x-msdownload"};if(this.check([37,33]))return await e.peekBuffer(this.buffer,{length:24,mayBeLess:!0}),this.checkString("PS-Adobe-",{offset:2})&&this.checkString(" EPSF-",{offset:14})?{ext:"eps",mime:"application/eps"}:{ext:"ps",mime:"application/postscript"};if(this.check([31,160])||this.check([31,157]))return{ext:"Z",mime:"application/x-compress"};if(this.check([199,113]))return{ext:"cpio",mime:"application/x-cpio"};if(this.check([96,234]))return{ext:"arj",mime:"application/x-arj"};if(this.check([239,187,191]))return this.tokenizer.ignore(3),this.parse(e);if(this.check([71,73,70]))return{ext:"gif",mime:"image/gif"};if(this.check([73,73,188]))return{ext:"jxr",mime:"image/vnd.ms-photo"};if(this.check([31,139,8]))return{ext:"gz",mime:"application/gzip"};if(this.check([66,90,104]))return{ext:"bz2",mime:"application/x-bzip2"};if(this.checkString("ID3")){await e.ignore(6);const n=await e.readToken(IV);return e.position+n>e.fileInfo.size?{ext:"mp3",mime:"audio/mpeg"}:(await e.ignore(n),this.fromTokenizer(e))}if(this.checkString("MP+"))return{ext:"mpc",mime:"audio/x-musepack"};if((this.buffer[0]===67||this.buffer[0]===70)&&this.check([87,83],{offset:1}))return{ext:"swf",mime:"application/x-shockwave-flash"};if(this.check([255,216,255]))return this.check([247],{offset:3})?{ext:"jls",mime:"image/jls"}:{ext:"jpg",mime:"image/jpeg"};if(this.check([79,98,106,1]))return{ext:"avro",mime:"application/avro"};if(this.checkString("FLIF"))return{ext:"flif",mime:"image/flif"};if(this.checkString("8BPS"))return{ext:"psd",mime:"image/vnd.adobe.photoshop"};if(this.checkString("WEBP",{offset:8}))return{ext:"webp",mime:"image/webp"};if(this.checkString("MPCK"))return{ext:"mpc",mime:"audio/x-musepack"};if(this.checkString("FORM"))return{ext:"aif",mime:"audio/aiff"};if(this.checkString("icns",{offset:0}))return{ext:"icns",mime:"image/icns"};if(this.check([80,75,3,4])){try{for(;e.position+30<e.fileInfo.size;){await e.readBuffer(this.buffer,{length:30});const n=new DataView(this.buffer.buffer),r={compressedSize:n.getUint32(18,!0),uncompressedSize:n.getUint32(22,!0),filenameLength:n.getUint16(26,!0),extraFieldLength:n.getUint16(28,!0)};if(r.filename=await e.readToken(new Q(r.filenameLength,"utf-8")),await e.ignore(r.extraFieldLength),r.filename==="META-INF/mozilla.rsa")return{ext:"xpi",mime:"application/x-xpinstall"};if(r.filename.endsWith(".rels")||r.filename.endsWith(".xml"))switch(r.filename.split("/")[0]){case"_rels":break;case"word":return{ext:"docx",mime:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"};case"ppt":return{ext:"pptx",mime:"application/vnd.openxmlformats-officedocument.presentationml.presentation"};case"xl":return{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"};case"visio":return{ext:"vsdx",mime:"application/vnd.visio"};default:break}if(r.filename.startsWith("xl/"))return{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"};if(r.filename.startsWith("3D/")&&r.filename.endsWith(".model"))return{ext:"3mf",mime:"model/3mf"};if(r.filename==="mimetype"&&r.compressedSize===r.uncompressedSize){let i=await e.readToken(new Q(r.compressedSize,"utf-8"));switch(i=i.trim(),i){case"application/epub+zip":return{ext:"epub",mime:"application/epub+zip"};case"application/vnd.oasis.opendocument.text":return{ext:"odt",mime:"application/vnd.oasis.opendocument.text"};case"application/vnd.oasis.opendocument.spreadsheet":return{ext:"ods",mime:"application/vnd.oasis.opendocument.spreadsheet"};case"application/vnd.oasis.opendocument.presentation":return{ext:"odp",mime:"application/vnd.oasis.opendocument.presentation"};default:}}if(r.compressedSize===0){let i=-1;for(;i<0&&e.position<e.fileInfo.size;)await e.peekBuffer(this.buffer,{mayBeLess:!0}),i=AR(this.buffer,new Uint8Array([80,75,3,4])),await e.ignore(i>=0?i:this.buffer.length)}else await e.ignore(r.compressedSize)}}catch(n){if(!(n instanceof Ke))throw n}return{ext:"zip",mime:"application/zip"}}if(this.checkString("OggS")){await e.ignore(28);const n=new Uint8Array(8);return await e.readBuffer(n),or(n,[79,112,117,115,72,101,97,100])?{ext:"opus",mime:"audio/opus"}:or(n,[128,116,104,101,111,114,97])?{ext:"ogv",mime:"video/ogg"}:or(n,[1,118,105,100,101,111,0])?{ext:"ogm",mime:"video/ogg"}:or(n,[127,70,76,65,67])?{ext:"oga",mime:"audio/ogg"}:or(n,[83,112,101,101,120,32,32])?{ext:"spx",mime:"audio/ogg"}:or(n,[1,118,111,114,98,105,115])?{ext:"ogg",mime:"audio/ogg"}:{ext:"ogx",mime:"application/ogg"}}if(this.check([80,75])&&(this.buffer[2]===3||this.buffer[2]===5||this.buffer[2]===7)&&(this.buffer[3]===4||this.buffer[3]===6||this.buffer[3]===8))return{ext:"zip",mime:"application/zip"};if(this.checkString("ftyp",{offset:4})&&this.buffer[8]&96){const n=new Q(4,"latin1").get(this.buffer,8).replace("\0"," ").trim();switch(n){case"avif":case"avis":return{ext:"avif",mime:"image/avif"};case"mif1":return{ext:"heic",mime:"image/heif"};case"msf1":return{ext:"heic",mime:"image/heif-sequence"};case"heic":case"heix":return{ext:"heic",mime:"image/heic"};case"hevc":case"hevx":return{ext:"heic",mime:"image/heic-sequence"};case"qt":return{ext:"mov",mime:"video/quicktime"};case"M4V":case"M4VH":case"M4VP":return{ext:"m4v",mime:"video/x-m4v"};case"M4P":return{ext:"m4p",mime:"video/mp4"};case"M4B":return{ext:"m4b",mime:"audio/mp4"};case"M4A":return{ext:"m4a",mime:"audio/x-m4a"};case"F4V":return{ext:"f4v",mime:"video/mp4"};case"F4P":return{ext:"f4p",mime:"video/mp4"};case"F4A":return{ext:"f4a",mime:"audio/mp4"};case"F4B":return{ext:"f4b",mime:"audio/mp4"};case"crx":return{ext:"cr3",mime:"image/x-canon-cr3"};default:return n.startsWith("3g")?n.startsWith("3g2")?{ext:"3g2",mime:"video/3gpp2"}:{ext:"3gp",mime:"video/3gpp"}:{ext:"mp4",mime:"video/mp4"}}}if(this.checkString("MThd"))return{ext:"mid",mime:"audio/midi"};if(this.checkString("wOFF")&&(this.check([0,1,0,0],{offset:4})||this.checkString("OTTO",{offset:4})))return{ext:"woff",mime:"font/woff"};if(this.checkString("wOF2")&&(this.check([0,1,0,0],{offset:4})||this.checkString("OTTO",{offset:4})))return{ext:"woff2",mime:"font/woff2"};if(this.check([212,195,178,161])||this.check([161,178,195,212]))return{ext:"pcap",mime:"application/vnd.tcpdump.pcap"};if(this.checkString("DSD "))return{ext:"dsf",mime:"audio/x-dsf"};if(this.checkString("LZIP"))return{ext:"lz",mime:"application/x-lzip"};if(this.checkString("fLaC"))return{ext:"flac",mime:"audio/x-flac"};if(this.check([66,80,71,251]))return{ext:"bpg",mime:"image/bpg"};if(this.checkString("wvpk"))return{ext:"wv",mime:"audio/wavpack"};if(this.checkString("%PDF")){try{await e.ignore(1350);const n=10*1024*1024,r=new Uint8Array(Math.min(n,e.fileInfo.size));if(await e.readBuffer(r,{mayBeLess:!0}),kV(r,new TextEncoder().encode("AIPrivateData")))return{ext:"ai",mime:"application/postscript"}}catch(n){if(!(n instanceof Ke))throw n}return{ext:"pdf",mime:"application/pdf"}}if(this.check([0,97,115,109]))return{ext:"wasm",mime:"application/wasm"};if(this.check([73,73])){const n=await this.readTiffHeader(!1);if(n)return n}if(this.check([77,77])){const n=await this.readTiffHeader(!0);if(n)return n}if(this.checkString("MAC "))return{ext:"ape",mime:"audio/ape"};if(this.check([26,69,223,163])){async function n(){const o=await e.peekNumber(ie);let l=128,u=0;for(;!(o&l)&&l!==0;)++u,l>>=1;const d=new Uint8Array(u+1);return await e.readBuffer(d),d}async function r(){const o=await n(),l=await n();l[0]^=128>>l.length-1;const u=Math.min(6,l.length),d=new DataView(o.buffer),h=new DataView(l.buffer,l.length-u,u);return{id:VE(d),len:VE(h)}}async function i(o){for(;o>0;){const l=await r();if(l.id===17026)return(await e.readToken(new Q(l.len))).replaceAll(/\00.*$/g,"");await e.ignore(l.len),--o}}const s=await r();switch(await i(s.len)){case"webm":return{ext:"webm",mime:"video/webm"};case"matroska":return{ext:"mkv",mime:"video/x-matroska"};default:return}}if(this.check([82,73,70,70])){if(this.check([65,86,73],{offset:8}))return{ext:"avi",mime:"video/vnd.avi"};if(this.check([87,65,86,69],{offset:8}))return{ext:"wav",mime:"audio/wav"};if(this.check([81,76,67,77],{offset:8}))return{ext:"qcp",mime:"audio/qcelp"}}if(this.checkString("SQLi"))return{ext:"sqlite",mime:"application/x-sqlite3"};if(this.check([78,69,83,26]))return{ext:"nes",mime:"application/x-nintendo-nes-rom"};if(this.checkString("Cr24"))return{ext:"crx",mime:"application/x-google-chrome-extension"};if(this.checkString("MSCF")||this.checkString("ISc("))return{ext:"cab",mime:"application/vnd.ms-cab-compressed"};if(this.check([237,171,238,219]))return{ext:"rpm",mime:"application/x-rpm"};if(this.check([197,208,211,198]))return{ext:"eps",mime:"application/eps"};if(this.check([40,181,47,253]))return{ext:"zst",mime:"application/zstd"};if(this.check([127,69,76,70]))return{ext:"elf",mime:"application/x-elf"};if(this.check([33,66,68,78]))return{ext:"pst",mime:"application/vnd.ms-outlook"};if(this.checkString("PAR1"))return{ext:"parquet",mime:"application/x-parquet"};if(this.check([207,250,237,254]))return{ext:"macho",mime:"application/x-mach-binary"};if(this.check([79,84,84,79,0]))return{ext:"otf",mime:"font/otf"};if(this.checkString("#!AMR"))return{ext:"amr",mime:"audio/amr"};if(this.checkString("{\\rtf"))return{ext:"rtf",mime:"application/rtf"};if(this.check([70,76,86,1]))return{ext:"flv",mime:"video/x-flv"};if(this.checkString("IMPM"))return{ext:"it",mime:"audio/x-it"};if(this.checkString("-lh0-",{offset:2})||this.checkString("-lh1-",{offset:2})||this.checkString("-lh2-",{offset:2})||this.checkString("-lh3-",{offset:2})||this.checkString("-lh4-",{offset:2})||this.checkString("-lh5-",{offset:2})||this.checkString("-lh6-",{offset:2})||this.checkString("-lh7-",{offset:2})||this.checkString("-lzs-",{offset:2})||this.checkString("-lz4-",{offset:2})||this.checkString("-lz5-",{offset:2})||this.checkString("-lhd-",{offset:2}))return{ext:"lzh",mime:"application/x-lzh-compressed"};if(this.check([0,0,1,186])){if(this.check([33],{offset:4,mask:[241]}))return{ext:"mpg",mime:"video/MP1S"};if(this.check([68],{offset:4,mask:[196]}))return{ext:"mpg",mime:"video/MP2P"}}if(this.checkString("ITSF"))return{ext:"chm",mime:"application/vnd.ms-htmlhelp"};if(this.check([202,254,186,190]))return{ext:"class",mime:"application/java-vm"};if(this.check([253,55,122,88,90,0]))return{ext:"xz",mime:"application/x-xz"};if(this.checkString("<?xml "))return{ext:"xml",mime:"application/xml"};if(this.check([55,122,188,175,39,28]))return{ext:"7z",mime:"application/x-7z-compressed"};if(this.check([82,97,114,33,26,7])&&(this.buffer[6]===0||this.buffer[6]===1))return{ext:"rar",mime:"application/x-rar-compressed"};if(this.checkString("solid "))return{ext:"stl",mime:"model/stl"};if(this.checkString("AC")){const n=new Q(4,"latin1").get(this.buffer,2);if(n.match("^d*")&&n>=1e3&&n<=1050)return{ext:"dwg",mime:"image/vnd.dwg"}}if(this.checkString("070707"))return{ext:"cpio",mime:"application/x-cpio"};if(this.checkString("BLENDER"))return{ext:"blend",mime:"application/x-blender"};if(this.checkString("!<arch>"))return await e.ignore(8),await e.readToken(new Q(13,"ascii"))==="debian-binary"?{ext:"deb",mime:"application/x-deb"}:{ext:"ar",mime:"application/x-unix-archive"};if(this.checkString("**ACE",{offset:7})&&(await e.peekBuffer(this.buffer,{length:14,mayBeLess:!0}),this.checkString("**",{offset:12})))return{ext:"ace",mime:"application/x-ace-compressed"};if(this.check([137,80,78,71,13,10,26,10])){await e.ignore(8);async function n(){return{length:await e.readToken(_n),type:await e.readToken(new Q(4,"latin1"))}}do{const r=await n();if(r.length<0)return;switch(r.type){case"IDAT":return{ext:"png",mime:"image/png"};case"acTL":return{ext:"apng",mime:"image/apng"};default:await e.ignore(r.length+4)}}while(e.position+8<e.fileInfo.size);return{ext:"png",mime:"image/png"}}if(this.check([65,82,82,79,87,49,0,0]))return{ext:"arrow",mime:"application/x-apache-arrow"};if(this.check([103,108,84,70,2,0,0,0]))return{ext:"glb",mime:"model/gltf-binary"};if(this.check([102,114,101,101],{offset:4})||this.check([109,100,97,116],{offset:4})||this.check([109,111,111,118],{offset:4})||this.check([119,105,100,101],{offset:4}))return{ext:"mov",mime:"video/quicktime"};if(this.check([73,73,82,79,8,0,0,0,24]))return{ext:"orf",mime:"image/x-olympus-orf"};if(this.checkString("gimp xcf "))return{ext:"xcf",mime:"image/x-xcf"};if(this.check([73,73,85,0,24,0,0,0,136,231,116,216]))return{ext:"rw2",mime:"image/x-panasonic-rw2"};if(this.check([48,38,178,117,142,102,207,17,166,217])){async function n(){const r=new Uint8Array(16);return await e.readBuffer(r),{id:r,size:Number(await e.readToken(Wt))}}for(await e.ignore(30);e.position+24<e.fileInfo.size;){const r=await n();let i=r.size-24;if(or(r.id,[145,7,220,183,183,169,207,17,142,230,0,192,12,32,83,101])){const s=new Uint8Array(16);if(i-=await e.readBuffer(s),or(s,[64,158,105,248,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"audio/x-ms-asf"};if(or(s,[192,239,25,188,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"video/x-ms-asf"};break}await e.ignore(i)}return{ext:"asf",mime:"application/vnd.ms-asf"}}if(this.check([171,75,84,88,32,49,49,187,13,10,26,10]))return{ext:"ktx",mime:"image/ktx"};if((this.check([126,16,4])||this.check([126,24,4]))&&this.check([48,77,73,69],{offset:4}))return{ext:"mie",mime:"application/x-mie"};if(this.check([39,10,0,0,0,0,0,0,0,0,0,0],{offset:2}))return{ext:"shp",mime:"application/x-esri-shape"};if(this.check([255,79,255,81]))return{ext:"j2c",mime:"image/j2c"};if(this.check([0,0,0,12,106,80,32,32,13,10,135,10]))switch(await e.ignore(20),await e.readToken(new Q(4,"ascii"))){case"jp2 ":return{ext:"jp2",mime:"image/jp2"};case"jpx ":return{ext:"jpx",mime:"image/jpx"};case"jpm ":return{ext:"jpm",mime:"image/jpm"};case"mjp2":return{ext:"mj2",mime:"image/mj2"};default:return}if(this.check([255,10])||this.check([0,0,0,12,74,88,76,32,13,10,135,10]))return{ext:"jxl",mime:"image/jxl"};if(this.check([254,255]))return this.check([0,60,0,63,0,120,0,109,0,108],{offset:2})?{ext:"xml",mime:"application/xml"}:void 0;if(this.check([0,0,1,186])||this.check([0,0,1,179]))return{ext:"mpg",mime:"video/mpeg"};if(this.check([0,1,0,0,0]))return{ext:"ttf",mime:"font/ttf"};if(this.check([0,0,1,0]))return{ext:"ico",mime:"image/x-icon"};if(this.check([0,0,2,0]))return{ext:"cur",mime:"image/x-icon"};if(this.check([208,207,17,224,161,177,26,225]))return{ext:"cfb",mime:"application/x-cfb"};if(await e.peekBuffer(this.buffer,{length:Math.min(256,e.fileInfo.size),mayBeLess:!0}),this.check([97,99,115,112],{offset:36}))return{ext:"icc",mime:"application/vnd.iccprofile"};if(this.checkString("BEGIN:")){if(this.checkString("VCARD",{offset:6}))return{ext:"vcf",mime:"text/vcard"};if(this.checkString("VCALENDAR",{offset:6}))return{ext:"ics",mime:"text/calendar"}}if(this.checkString("FUJIFILMCCD-RAW"))return{ext:"raf",mime:"image/x-fujifilm-raf"};if(this.checkString("Extended Module:"))return{ext:"xm",mime:"audio/x-xm"};if(this.checkString("Creative Voice File"))return{ext:"voc",mime:"audio/x-voc"};if(this.check([4,0,0,0])&&this.buffer.length>=16){const n=new DataView(this.buffer.buffer).getUint32(12,!0);if(n>12&&this.buffer.length>=n+16)try{const r=new TextDecoder().decode(this.buffer.slice(16,n+16));if(JSON.parse(r).files)return{ext:"asar",mime:"application/x-asar"}}catch{}}if(this.check([6,14,43,52,2,5,1,1,13,1,2,1,1,2]))return{ext:"mxf",mime:"application/mxf"};if(this.checkString("SCRM",{offset:44}))return{ext:"s3m",mime:"audio/x-s3m"};if(this.check([71])&&this.check([71],{offset:188}))return{ext:"mts",mime:"video/mp2t"};if(this.check([71],{offset:4})&&this.check([71],{offset:196}))return{ext:"mts",mime:"video/mp2t"};if(this.check([66,79,79,75,77,79,66,73],{offset:60}))return{ext:"mobi",mime:"application/x-mobipocket-ebook"};if(this.check([68,73,67,77],{offset:128}))return{ext:"dcm",mime:"application/dicom"};if(this.check([76,0,0,0,1,20,2,0,0,0,0,0,192,0,0,0,0,0,0,70]))return{ext:"lnk",mime:"application/x.ms.shortcut"};if(this.check([98,111,111,107,0,0,0,0,109,97,114,107,0,0,0,0]))return{ext:"alias",mime:"application/x.apple.alias"};if(this.checkString("Kaydara FBX Binary  \0"))return{ext:"fbx",mime:"application/x.autodesk.fbx"};if(this.check([76,80],{offset:34})&&(this.check([0,0,1],{offset:8})||this.check([1,0,2],{offset:8})||this.check([2,0,2],{offset:8})))return{ext:"eot",mime:"application/vnd.ms-fontobject"};if(this.check([6,6,237,245,216,29,70,229,189,49,239,231,254,116,183,29]))return{ext:"indd",mime:"application/x-indesign"};if(await e.peekBuffer(this.buffer,{length:Math.min(512,e.fileInfo.size),mayBeLess:!0}),TV(this.buffer))return{ext:"tar",mime:"application/x-tar"};if(this.check([255,254]))return this.check([60,0,63,0,120,0,109,0,108,0],{offset:2})?{ext:"xml",mime:"application/xml"}:this.check([255,14,83,0,107,0,101,0,116,0,99,0,104,0,85,0,112,0,32,0,77,0,111,0,100,0,101,0,108,0],{offset:2})?{ext:"skp",mime:"application/vnd.sketchup.skp"}:void 0;if(this.checkString("-----BEGIN PGP MESSAGE-----"))return{ext:"pgp",mime:"application/pgp-encrypted"};if(this.buffer.length>=2&&this.check([255,224],{offset:0,mask:[255,224]})){if(this.check([16],{offset:1,mask:[22]}))return this.check([8],{offset:1,mask:[8]})?{ext:"aac",mime:"audio/aac"}:{ext:"aac",mime:"audio/aac"};if(this.check([2],{offset:1,mask:[6]}))return{ext:"mp3",mime:"audio/mpeg"};if(this.check([4],{offset:1,mask:[6]}))return{ext:"mp2",mime:"audio/mpeg"};if(this.check([6],{offset:1,mask:[6]}))return{ext:"mp1",mime:"audio/mpeg"}}}async readTiffTag(e){const n=await this.tokenizer.readToken(e?_e:ye);switch(this.tokenizer.ignore(10),n){case 50341:return{ext:"arw",mime:"image/x-sony-arw"};case 50706:return{ext:"dng",mime:"image/x-adobe-dng"}}}async readTiffIFD(e){const n=await this.tokenizer.readToken(e?_e:ye);for(let r=0;r<n;++r){const i=await this.readTiffTag(e);if(i)return i}}async readTiffHeader(e){const n=(e?_e:ye).get(this.buffer,2),r=(e?X:q).get(this.buffer,4);if(n===42){if(r>=6){if(this.checkString("CR",{offset:8}))return{ext:"cr2",mime:"image/x-canon-cr2"};if(r>=8&&(this.check([28,0,254,0],{offset:8})||this.check([31,0,11,0],{offset:8})))return{ext:"nef",mime:"image/x-nikon-nef"}}return await this.tokenizer.ignore(r),await this.readTiffIFD(e)??{ext:"tif",mime:"image/tiff"}}if(n===43)return{ext:"tif",mime:"image/tiff"}}}new Set(CV);new Set(AV);var q1={};/*!
 * content-type
 * Copyright(c) 2015 Douglas Christopher Wilson
 * MIT Licensed
 */var WE=/; *([!#$%&'*+.^_`|~0-9A-Za-z-]+) *= *("(?:[\u000b\u0020\u0021\u0023-\u005b\u005d-\u007e\u0080-\u00ff]|\\[\u000b\u0020-\u00ff])*"|[!#$%&'*+.^_`|~0-9A-Za-z-]+) */g,PV=/^[\u000b\u0020-\u007e\u0080-\u00ff]+$/,PR=/^[!#$%&'*+.^_`|~0-9A-Za-z-]+$/,NV=/\\([\u000b\u0020-\u00ff])/g,jV=/([\\"])/g,NR=/^[!#$%&'*+.^_`|~0-9A-Za-z-]+\/[!#$%&'*+.^_`|~0-9A-Za-z-]+$/;q1.format=OV;q1.parse=DV;function OV(t){if(!t||typeof t!="object")throw new TypeError("argument obj is required");var e=t.parameters,n=t.type;if(!n||!NR.test(n))throw new TypeError("invalid type");var r=n;if(e&&typeof e=="object")for(var i,s=Object.keys(e).sort(),a=0;a<s.length;a++){if(i=s[a],!PR.test(i))throw new TypeError("invalid parameter name");r+="; "+i+"="+LV(e[i])}return r}function DV(t){if(!t)throw new TypeError("argument string is required");var e=typeof t=="object"?MV(t):t;if(typeof e!="string")throw new TypeError("argument string is required to be a string");var n=e.indexOf(";"),r=n!==-1?e.slice(0,n).trim():e.trim();if(!NR.test(r))throw new TypeError("invalid media type");var i=new FV(r.toLowerCase());if(n!==-1){var s,a,o;for(WE.lastIndex=n;a=WE.exec(e);){if(a.index!==n)throw new TypeError("invalid parameter format");n+=a[0].length,s=a[1].toLowerCase(),o=a[2],o.charCodeAt(0)===34&&(o=o.slice(1,-1),o.indexOf("\\")!==-1&&(o=o.replace(NV,"$1"))),i.parameters[s]=o}if(n!==e.length)throw new TypeError("invalid parameter format")}return i}function MV(t){var e;if(typeof t.getHeader=="function"?e=t.getHeader("content-type"):typeof t.headers=="object"&&(e=t.headers&&t.headers["content-type"]),typeof e!="string")throw new TypeError("content-type header is missing from object");return e}function LV(t){var e=String(t);if(PR.test(e))return e;if(e.length>0&&!PV.test(e))throw new TypeError("invalid parameter value");return'"'+e.replace(jV,"\\$1")+'"'}function FV(t){this.parameters=Object.create(null),this.type=t}/*!
 * media-typer
 * Copyright(c) 2014-2017 Douglas Christopher Wilson
 * MIT Licensed
 */var $V=/^ *([A-Za-z0-9][A-Za-z0-9!#$&^_-]{0,126})\/([A-Za-z0-9][A-Za-z0-9!#$&^_.+-]{0,126}) *$/,zV=UV;function UV(t){if(!t)throw new TypeError("argument string is required");if(typeof t!="string")throw new TypeError("argument string is required to be a string");var e=$V.exec(t.toLowerCase());if(!e)throw new TypeError("invalid media type");var n=e[1],r=e[2],i,s=r.lastIndexOf("+");return s!==-1&&(i=r.substr(s+1),r=r.substr(0,s)),new BV(n,r,i)}function BV(t,e,n){this.type=t,this.subtype=e,this.suffix=n}var N0={exports:{}},bp,qE;function VV(){if(qE)return bp;qE=1;var t=1e3,e=t*60,n=e*60,r=n*24,i=r*7,s=r*365.25;bp=function(d,h){h=h||{};var m=typeof d;if(m==="string"&&d.length>0)return a(d);if(m==="number"&&isFinite(d))return h.long?l(d):o(d);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(d))};function a(d){if(d=String(d),!(d.length>100)){var h=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(d);if(h){var m=parseFloat(h[1]),p=(h[2]||"ms").toLowerCase();switch(p){case"years":case"year":case"yrs":case"yr":case"y":return m*s;case"weeks":case"week":case"w":return m*i;case"days":case"day":case"d":return m*r;case"hours":case"hour":case"hrs":case"hr":case"h":return m*n;case"minutes":case"minute":case"mins":case"min":case"m":return m*e;case"seconds":case"second":case"secs":case"sec":case"s":return m*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return m;default:return}}}}function o(d){var h=Math.abs(d);return h>=r?Math.round(d/r)+"d":h>=n?Math.round(d/n)+"h":h>=e?Math.round(d/e)+"m":h>=t?Math.round(d/t)+"s":d+"ms"}function l(d){var h=Math.abs(d);return h>=r?u(d,h,r,"day"):h>=n?u(d,h,n,"hour"):h>=e?u(d,h,e,"minute"):h>=t?u(d,h,t,"second"):d+" ms"}function u(d,h,m,p){var g=h>=m*1.5;return Math.round(d/m)+" "+p+(g?"s":"")}return bp}function HV(t){n.debug=n,n.default=n,n.coerce=l,n.disable=s,n.enable=i,n.enabled=a,n.humanize=VV(),n.destroy=u,Object.keys(t).forEach(d=>{n[d]=t[d]}),n.names=[],n.skips=[],n.formatters={};function e(d){let h=0;for(let m=0;m<d.length;m++)h=(h<<5)-h+d.charCodeAt(m),h|=0;return n.colors[Math.abs(h)%n.colors.length]}n.selectColor=e;function n(d){let h,m=null,p,g;function w(...E){if(!w.enabled)return;const v=w,y=Number(new Date),x=y-(h||y);v.diff=x,v.prev=h,v.curr=y,h=y,E[0]=n.coerce(E[0]),typeof E[0]!="string"&&E.unshift("%O");let _=0;E[0]=E[0].replace(/%([a-zA-Z%])/g,(k,b)=>{if(k==="%%")return"%";_++;const T=n.formatters[b];if(typeof T=="function"){const P=E[_];k=T.call(v,P),E.splice(_,1),_--}return k}),n.formatArgs.call(v,E),(v.log||n.log).apply(v,E)}return w.namespace=d,w.useColors=n.useColors(),w.color=n.selectColor(d),w.extend=r,w.destroy=n.destroy,Object.defineProperty(w,"enabled",{enumerable:!0,configurable:!1,get:()=>m!==null?m:(p!==n.namespaces&&(p=n.namespaces,g=n.enabled(d)),g),set:E=>{m=E}}),typeof n.init=="function"&&n.init(w),w}function r(d,h){const m=n(this.namespace+(typeof h>"u"?":":h)+d);return m.log=this.log,m}function i(d){n.save(d),n.namespaces=d,n.names=[],n.skips=[];let h;const m=(typeof d=="string"?d:"").split(/[\s,]+/),p=m.length;for(h=0;h<p;h++)m[h]&&(d=m[h].replace(/\*/g,".*?"),d[0]==="-"?n.skips.push(new RegExp("^"+d.slice(1)+"$")):n.names.push(new RegExp("^"+d+"$")))}function s(){const d=[...n.names.map(o),...n.skips.map(o).map(h=>"-"+h)].join(",");return n.enable(""),d}function a(d){if(d[d.length-1]==="*")return!0;let h,m;for(h=0,m=n.skips.length;h<m;h++)if(n.skips[h].test(d))return!1;for(h=0,m=n.names.length;h<m;h++)if(n.names[h].test(d))return!0;return!1}function o(d){return d.toString().substring(2,d.toString().length-2).replace(/\.\*\?$/,"*")}function l(d){return d instanceof Error?d.stack||d.message:d}function u(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return n.enable(n.load()),n}var WV=HV;(function(t,e){e.formatArgs=r,e.save=i,e.load=s,e.useColors=n,e.storage=a(),e.destroy=(()=>{let l=!1;return()=>{l||(l=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function n(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function r(l){if(l[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+l[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;const u="color: "+this.color;l.splice(1,0,u,"color: inherit");let d=0,h=0;l[0].replace(/%[a-zA-Z%]/g,m=>{m!=="%%"&&(d++,m==="%c"&&(h=d))}),l.splice(h,0,u)}e.log=console.debug||console.log||(()=>{});function i(l){try{l?e.storage.setItem("debug",l):e.storage.removeItem("debug")}catch{}}function s(){let l;try{l=e.storage.getItem("debug")}catch{}return!l&&typeof process<"u"&&"env"in process&&(l={}.DEBUG),l}function a(){try{return localStorage}catch{}}t.exports=WV(e);const{formatters:o}=t.exports;o.j=function(l){try{return JSON.stringify(l)}catch(u){return"[UnexpectedJSONParseError]: "+u.message}}})(N0,N0.exports);var qV=N0.exports;const ke=DS(qV);var j0;(function(t){t[t.shot=10]="shot",t[t.scene=20]="scene",t[t.track=30]="track",t[t.part=40]="part",t[t.album=50]="album",t[t.edition=60]="edition",t[t.collection=70]="collection"})(j0||(j0={}));var Vs;(function(t){t[t.video=1]="video",t[t.audio=2]="audio",t[t.complex=3]="complex",t[t.logo=4]="logo",t[t.subtitle=17]="subtitle",t[t.button=18]="button",t[t.control=32]="control"})(Vs||(Vs={}));function Ue(t,e,n){return(t[e]&1<<n)!==0}function un(t,e,n,r){let i=e;if(r==="utf-16le"){for(;t[i]!==0||t[i+1]!==0;){if(i>=n)return n;i+=2}return i}for(;t[i]!==0;){if(i>=n)return n;i++}return i}function jR(t){const e=t.indexOf("\0");return e===-1?t:t.substr(0,e)}function GV(t){const e=t.length;if(e&1)throw new Error("Buffer length must be even");for(let n=0;n<e;n+=2){const r=t[n];t[n]=t[n+1],t[n+1]=r}return t}function rt(t,e){if(t[0]===255&&t[1]===254)return rt(t.subarray(2),e);if(e==="utf-16le"&&t[0]===254&&t[1]===255){if(t.length&1)throw new Error("Expected even number of octets for 16-bit unicode string");return rt(GV(t),e)}return new Q(t.length,e).get(t,0)}function ki(t){return t=t.replace(/^\x00+/g,""),t=t.replace(/\x00+$/g,""),t}function de(t,e,n,r){const i=e+~~(n/8),s=n%8;let a=t[i];a&=255>>s;const o=8-s,l=r-o;return l<0?a>>=8-s-r:l>0&&(a<<=l,a|=de(t,e,n+o,l)),a}function pn(t,e,n){return de(t,e,n,1)===1}function KV(t){const e=[];for(let n=0,r=t.length;n<r;n++){const i=Number(t.charCodeAt(n)).toString(16);e.push(i.length===1?`0${i}`:i)}return e.join(" ")}function QV(t){return 10*Math.log10(t)}function XV(t){return 10**(t/10)}function YV(t){const e=t.split(" ").map(n=>n.trim().toLowerCase());if(e.length>=1){const n=Number.parseFloat(e[0]);return e.length===2&&e[1]==="db"?{dB:n,ratio:XV(n)}:{dB:QV(n),ratio:n}}}var pc;(function(t){t[t.Other=0]="Other",t[t["32x32 pixels 'file icon' (PNG only)"]=1]="32x32 pixels 'file icon' (PNG only)",t[t["Other file icon"]=2]="Other file icon",t[t["Cover (front)"]=3]="Cover (front)",t[t["Cover (back)"]=4]="Cover (back)",t[t["Leaflet page"]=5]="Leaflet page",t[t["Media (e.g. label side of CD)"]=6]="Media (e.g. label side of CD)",t[t["Lead artist/lead performer/soloist"]=7]="Lead artist/lead performer/soloist",t[t["Artist/performer"]=8]="Artist/performer",t[t.Conductor=9]="Conductor",t[t["Band/Orchestra"]=10]="Band/Orchestra",t[t.Composer=11]="Composer",t[t["Lyricist/text writer"]=12]="Lyricist/text writer",t[t["Recording Location"]=13]="Recording Location",t[t["During recording"]=14]="During recording",t[t["During performance"]=15]="During performance",t[t["Movie/video screen capture"]=16]="Movie/video screen capture",t[t["A bright coloured fish"]=17]="A bright coloured fish",t[t.Illustration=18]="Illustration",t[t["Band/artist logotype"]=19]="Band/artist logotype",t[t["Publisher/Studio logotype"]=20]="Publisher/Studio logotype"})(pc||(pc={}));var GE;(function(t){t[t.other=0]="other",t[t.lyrics=1]="lyrics",t[t.text=2]="text",t[t.movement_part=3]="movement_part",t[t.events=4]="events",t[t.chord=5]="chord",t[t.trivia_pop=6]="trivia_pop"})(GE||(GE={}));var KE;(function(t){t[t.notSynchronized0=0]="notSynchronized0",t[t.mpegFrameNumber=1]="mpegFrameNumber",t[t.milliseconds=2]="milliseconds"})(KE||(KE={}));const OR={get:(t,e)=>t[e+3]&127|t[e+2]<<7|t[e+1]<<14|t[e]<<21,len:4},O0={len:10,get:(t,e)=>({fileIdentifier:new Q(3,"ascii").get(t,e),version:{major:mc.get(t,e+3),revision:mc.get(t,e+4)},flags:{unsynchronisation:Ue(t,e+5,7),isExtendedHeader:Ue(t,e+5,6),expIndicator:Ue(t,e+5,5),footer:Ue(t,e+5,4)},size:OR.get(t,e+6)})},QE={len:10,get:(t,e)=>({size:X.get(t,e),extendedFlags:_e.get(t,e+4),sizeOfPadding:X.get(t,e+6),crcDataPresent:Ue(t,e+4,31)})},DR={len:1,get:(t,e)=>{switch(t[e]){case 0:return{encoding:"latin1"};case 1:return{encoding:"utf-16le",bom:!0};case 2:return{encoding:"utf-16le",bom:!1};case 3:return{encoding:"utf8",bom:!1};default:return{encoding:"utf8",bom:!1}}}},D0={len:4,get:(t,e)=>({encoding:DR.get(t,e),language:new Q(3,"latin1").get(t,e+1)})},XE={len:6,get:(t,e)=>{const n=D0.get(t,e);return{encoding:n.encoding,language:n.language,timeStampFormat:ie.get(t,e+4),contentType:ie.get(t,e+5)}}},hh={year:{multiple:!1},track:{multiple:!1},disk:{multiple:!1},title:{multiple:!1},artist:{multiple:!1},artists:{multiple:!0,unique:!0},albumartist:{multiple:!1},album:{multiple:!1},date:{multiple:!1},originaldate:{multiple:!1},originalyear:{multiple:!1},releasedate:{multiple:!1},comment:{multiple:!0,unique:!1},genre:{multiple:!0,unique:!0},picture:{multiple:!0,unique:!0},composer:{multiple:!0,unique:!0},lyrics:{multiple:!0,unique:!1},albumsort:{multiple:!1,unique:!0},titlesort:{multiple:!1,unique:!0},work:{multiple:!1,unique:!0},artistsort:{multiple:!1,unique:!0},albumartistsort:{multiple:!1,unique:!0},composersort:{multiple:!1,unique:!0},lyricist:{multiple:!0,unique:!0},writer:{multiple:!0,unique:!0},conductor:{multiple:!0,unique:!0},remixer:{multiple:!0,unique:!0},arranger:{multiple:!0,unique:!0},engineer:{multiple:!0,unique:!0},producer:{multiple:!0,unique:!0},technician:{multiple:!0,unique:!0},djmixer:{multiple:!0,unique:!0},mixer:{multiple:!0,unique:!0},label:{multiple:!0,unique:!0},grouping:{multiple:!1},subtitle:{multiple:!0},discsubtitle:{multiple:!1},totaltracks:{multiple:!1},totaldiscs:{multiple:!1},compilation:{multiple:!1},rating:{multiple:!0},bpm:{multiple:!1},mood:{multiple:!1},media:{multiple:!1},catalognumber:{multiple:!0,unique:!0},tvShow:{multiple:!1},tvShowSort:{multiple:!1},tvSeason:{multiple:!1},tvEpisode:{multiple:!1},tvEpisodeId:{multiple:!1},tvNetwork:{multiple:!1},podcast:{multiple:!1},podcasturl:{multiple:!1},releasestatus:{multiple:!1},releasetype:{multiple:!0},releasecountry:{multiple:!1},script:{multiple:!1},language:{multiple:!1},copyright:{multiple:!1},license:{multiple:!1},encodedby:{multiple:!1},encodersettings:{multiple:!1},gapless:{multiple:!1},barcode:{multiple:!1},isrc:{multiple:!0},asin:{multiple:!1},musicbrainz_recordingid:{multiple:!1},musicbrainz_trackid:{multiple:!1},musicbrainz_albumid:{multiple:!1},musicbrainz_artistid:{multiple:!0},musicbrainz_albumartistid:{multiple:!0},musicbrainz_releasegroupid:{multiple:!1},musicbrainz_workid:{multiple:!1},musicbrainz_trmid:{multiple:!1},musicbrainz_discid:{multiple:!1},acoustid_id:{multiple:!1},acoustid_fingerprint:{multiple:!1},musicip_puid:{multiple:!1},musicip_fingerprint:{multiple:!1},website:{multiple:!1},"performer:instrument":{multiple:!0,unique:!0},averageLevel:{multiple:!1},peakLevel:{multiple:!1},notes:{multiple:!0,unique:!1},key:{multiple:!1},originalalbum:{multiple:!1},originalartist:{multiple:!1},discogs_artist_id:{multiple:!0,unique:!0},discogs_release_id:{multiple:!1},discogs_label_id:{multiple:!1},discogs_master_release_id:{multiple:!1},discogs_votes:{multiple:!1},discogs_rating:{multiple:!1},replaygain_track_peak:{multiple:!1},replaygain_track_gain:{multiple:!1},replaygain_album_peak:{multiple:!1},replaygain_album_gain:{multiple:!1},replaygain_track_minmax:{multiple:!1},replaygain_album_minmax:{multiple:!1},replaygain_undo:{multiple:!1},description:{multiple:!0},longDescription:{multiple:!1},category:{multiple:!0},hdVideo:{multiple:!1},keywords:{multiple:!0},movement:{multiple:!1},movementIndex:{multiple:!1},movementTotal:{multiple:!1},podcastId:{multiple:!1},showMovement:{multiple:!1},stik:{multiple:!1}};function JV(t){return hh[t]&&!hh[t].multiple}function ZV(t){return!hh[t].multiple||hh[t].unique||!1}class vn{static toIntOrNull(e){const n=Number.parseInt(e,10);return Number.isNaN(n)?null:n}static normalizeTrack(e){const n=e.toString().split("/");return{no:Number.parseInt(n[0],10)||null,of:Number.parseInt(n[1],10)||null}}constructor(e,n){this.tagTypes=e,this.tagMap=n}mapGenericTag(e,n){e={id:e.id,value:e.value},this.postMap(e,n);const r=this.getCommonName(e.id);return r?{id:r,value:e.value}:null}getCommonName(e){return this.tagMap[e]}postMap(e,n){}}vn.maxRatingScore=1;const eH={title:"title",artist:"artist",album:"album",year:"year",comment:"comment",track:"track",genre:"genre"};class tH extends vn{constructor(){super(["ID3v1"],eH)}}class Kc extends vn{constructor(e,n){const r={};for(const i of Object.keys(n))r[i.toUpperCase()]=n[i];super(e,r)}getCommonName(e){return this.tagMap[e.toUpperCase()]}}const nH={TIT2:"title",TPE1:"artist","TXXX:Artists":"artists",TPE2:"albumartist",TALB:"album",TDRV:"date",TORY:"originalyear",TPOS:"disk",TCON:"genre",APIC:"picture",TCOM:"composer",USLT:"lyrics",TSOA:"albumsort",TSOT:"titlesort",TOAL:"originalalbum",TSOP:"artistsort",TSO2:"albumartistsort",TSOC:"composersort",TEXT:"lyricist","TXXX:Writer":"writer",TPE3:"conductor",TPE4:"remixer","IPLS:arranger":"arranger","IPLS:engineer":"engineer","IPLS:producer":"producer","IPLS:DJ-mix":"djmixer","IPLS:mix":"mixer",TPUB:"label",TIT1:"grouping",TIT3:"subtitle",TRCK:"track",TCMP:"compilation",POPM:"rating",TBPM:"bpm",TMED:"media","TXXX:CATALOGNUMBER":"catalognumber","TXXX:MusicBrainz Album Status":"releasestatus","TXXX:MusicBrainz Album Type":"releasetype","TXXX:MusicBrainz Album Release Country":"releasecountry","TXXX:RELEASECOUNTRY":"releasecountry","TXXX:SCRIPT":"script",TLAN:"language",TCOP:"copyright",WCOP:"license",TENC:"encodedby",TSSE:"encodersettings","TXXX:BARCODE":"barcode","TXXX:ISRC":"isrc",TSRC:"isrc","TXXX:ASIN":"asin","TXXX:originalyear":"originalyear","UFID:http://musicbrainz.org":"musicbrainz_recordingid","TXXX:MusicBrainz Release Track Id":"musicbrainz_trackid","TXXX:MusicBrainz Album Id":"musicbrainz_albumid","TXXX:MusicBrainz Artist Id":"musicbrainz_artistid","TXXX:MusicBrainz Album Artist Id":"musicbrainz_albumartistid","TXXX:MusicBrainz Release Group Id":"musicbrainz_releasegroupid","TXXX:MusicBrainz Work Id":"musicbrainz_workid","TXXX:MusicBrainz TRM Id":"musicbrainz_trmid","TXXX:MusicBrainz Disc Id":"musicbrainz_discid","TXXX:ACOUSTID_ID":"acoustid_id","TXXX:Acoustid Id":"acoustid_id","TXXX:Acoustid Fingerprint":"acoustid_fingerprint","TXXX:MusicIP PUID":"musicip_puid","TXXX:MusicMagic Fingerprint":"musicip_fingerprint",WOAR:"website",TDRC:"date",TYER:"year",TDOR:"originaldate","TIPL:arranger":"arranger","TIPL:engineer":"engineer","TIPL:producer":"producer","TIPL:DJ-mix":"djmixer","TIPL:mix":"mixer",TMOO:"mood",SYLT:"lyrics",TSST:"discsubtitle",TKEY:"key",COMM:"comment",TOPE:"originalartist","PRIV:AverageLevel":"averageLevel","PRIV:PeakLevel":"peakLevel","TXXX:DISCOGS_ARTIST_ID":"discogs_artist_id","TXXX:DISCOGS_ARTISTS":"artists","TXXX:DISCOGS_ARTIST_NAME":"artists","TXXX:DISCOGS_ALBUM_ARTISTS":"albumartist","TXXX:DISCOGS_CATALOG":"catalognumber","TXXX:DISCOGS_COUNTRY":"releasecountry","TXXX:DISCOGS_DATE":"originaldate","TXXX:DISCOGS_LABEL":"label","TXXX:DISCOGS_LABEL_ID":"discogs_label_id","TXXX:DISCOGS_MASTER_RELEASE_ID":"discogs_master_release_id","TXXX:DISCOGS_RATING":"discogs_rating","TXXX:DISCOGS_RELEASED":"date","TXXX:DISCOGS_RELEASE_ID":"discogs_release_id","TXXX:DISCOGS_VOTES":"discogs_votes","TXXX:CATALOGID":"catalognumber","TXXX:STYLE":"genre","TXXX:REPLAYGAIN_TRACK_PEAK":"replaygain_track_peak","TXXX:REPLAYGAIN_TRACK_GAIN":"replaygain_track_gain","TXXX:REPLAYGAIN_ALBUM_PEAK":"replaygain_album_peak","TXXX:REPLAYGAIN_ALBUM_GAIN":"replaygain_album_gain","TXXX:MP3GAIN_MINMAX":"replaygain_track_minmax","TXXX:MP3GAIN_ALBUM_MINMAX":"replaygain_album_minmax","TXXX:MP3GAIN_UNDO":"replaygain_undo",MVNM:"movement",MVIN:"movementIndex",PCST:"podcast",TCAT:"category",TDES:"description",TDRL:"releasedate",TGID:"podcastId",TKWD:"keywords",WFED:"podcasturl",GRP1:"grouping"};class G1 extends Kc{static toRating(e){return{source:e.email,rating:e.rating>0?(e.rating-1)/254*vn.maxRatingScore:void 0}}constructor(){super(["ID3v2.3","ID3v2.4"],nH)}postMap(e,n){switch(e.id){case"UFID":{const r=e.value;r.owner_identifier==="http://musicbrainz.org"&&(e.id+=`:${r.owner_identifier}`,e.value=rt(r.identifier,"latin1"))}break;case"PRIV":{const r=e.value;switch(r.owner_identifier){case"AverageLevel":case"PeakValue":e.id+=`:${r.owner_identifier}`,e.value=r.data.length===4?q.get(r.data,0):null,e.value===null&&n.addWarning("Failed to parse PRIV:PeakValue");break;default:n.addWarning(`Unknown PRIV owner-identifier: ${r.data}`)}}break;case"POPM":e.value=G1.toRating(e.value);break}}}const rH={Title:"title",Author:"artist","WM/AlbumArtist":"albumartist","WM/AlbumTitle":"album","WM/Year":"date","WM/OriginalReleaseTime":"originaldate","WM/OriginalReleaseYear":"originalyear",Description:"comment","WM/TrackNumber":"track","WM/PartOfSet":"disk","WM/Genre":"genre","WM/Composer":"composer","WM/Lyrics":"lyrics","WM/AlbumSortOrder":"albumsort","WM/TitleSortOrder":"titlesort","WM/ArtistSortOrder":"artistsort","WM/AlbumArtistSortOrder":"albumartistsort","WM/ComposerSortOrder":"composersort","WM/Writer":"lyricist","WM/Conductor":"conductor","WM/ModifiedBy":"remixer","WM/Engineer":"engineer","WM/Producer":"producer","WM/DJMixer":"djmixer","WM/Mixer":"mixer","WM/Publisher":"label","WM/ContentGroupDescription":"grouping","WM/SubTitle":"subtitle","WM/SetSubTitle":"discsubtitle","WM/IsCompilation":"compilation","WM/SharedUserRating":"rating","WM/BeatsPerMinute":"bpm","WM/Mood":"mood","WM/Media":"media","WM/CatalogNo":"catalognumber","MusicBrainz/Album Status":"releasestatus","MusicBrainz/Album Type":"releasetype","MusicBrainz/Album Release Country":"releasecountry","WM/Script":"script","WM/Language":"language",Copyright:"copyright",LICENSE:"license","WM/EncodedBy":"encodedby","WM/EncodingSettings":"encodersettings","WM/Barcode":"barcode","WM/ISRC":"isrc","MusicBrainz/Track Id":"musicbrainz_recordingid","MusicBrainz/Release Track Id":"musicbrainz_trackid","MusicBrainz/Album Id":"musicbrainz_albumid","MusicBrainz/Artist Id":"musicbrainz_artistid","MusicBrainz/Album Artist Id":"musicbrainz_albumartistid","MusicBrainz/Release Group Id":"musicbrainz_releasegroupid","MusicBrainz/Work Id":"musicbrainz_workid","MusicBrainz/TRM Id":"musicbrainz_trmid","MusicBrainz/Disc Id":"musicbrainz_discid","Acoustid/Id":"acoustid_id","Acoustid/Fingerprint":"acoustid_fingerprint","MusicIP/PUID":"musicip_puid","WM/ARTISTS":"artists","WM/InitialKey":"key",ASIN:"asin","WM/Work":"work","WM/AuthorURL":"website","WM/Picture":"picture"};class K1 extends vn{static toRating(e){return{rating:Number.parseFloat(e+1)/5}}constructor(){super(["asf"],rH)}postMap(e){switch(e.id){case"WM/SharedUserRating":{const n=e.id.split(":");e.value=K1.toRating(e.value),e.id=n[0];break}}}}const iH={TT2:"title",TP1:"artist",TP2:"albumartist",TAL:"album",TYE:"year",COM:"comment",TRK:"track",TPA:"disk",TCO:"genre",PIC:"picture",TCM:"composer",TOR:"originaldate",TOT:"originalalbum",TXT:"lyricist",TP3:"conductor",TPB:"label",TT1:"grouping",TT3:"subtitle",TLA:"language",TCR:"copyright",WCP:"license",TEN:"encodedby",TSS:"encodersettings",WAR:"website",PCS:"podcast",TCP:"compilation",TDR:"date",TS2:"albumartistsort",TSA:"albumsort",TSC:"composersort",TSP:"artistsort",TST:"titlesort",WFD:"podcasturl",TBP:"bpm"};class sH extends Kc{constructor(){super(["ID3v2.2"],iH)}}const aH={Title:"title",Artist:"artist",Artists:"artists","Album Artist":"albumartist",Album:"album",Year:"date",Originalyear:"originalyear",Originaldate:"originaldate",Releasedate:"releasedate",Comment:"comment",Track:"track",Disc:"disk",DISCNUMBER:"disk",Genre:"genre","Cover Art (Front)":"picture","Cover Art (Back)":"picture",Composer:"composer",Lyrics:"lyrics",ALBUMSORT:"albumsort",TITLESORT:"titlesort",WORK:"work",ARTISTSORT:"artistsort",ALBUMARTISTSORT:"albumartistsort",COMPOSERSORT:"composersort",Lyricist:"lyricist",Writer:"writer",Conductor:"conductor",MixArtist:"remixer",Arranger:"arranger",Engineer:"engineer",Producer:"producer",DJMixer:"djmixer",Mixer:"mixer",Label:"label",Grouping:"grouping",Subtitle:"subtitle",DiscSubtitle:"discsubtitle",Compilation:"compilation",BPM:"bpm",Mood:"mood",Media:"media",CatalogNumber:"catalognumber",MUSICBRAINZ_ALBUMSTATUS:"releasestatus",MUSICBRAINZ_ALBUMTYPE:"releasetype",RELEASECOUNTRY:"releasecountry",Script:"script",Language:"language",Copyright:"copyright",LICENSE:"license",EncodedBy:"encodedby",EncoderSettings:"encodersettings",Barcode:"barcode",ISRC:"isrc",ASIN:"asin",musicbrainz_trackid:"musicbrainz_recordingid",musicbrainz_releasetrackid:"musicbrainz_trackid",MUSICBRAINZ_ALBUMID:"musicbrainz_albumid",MUSICBRAINZ_ARTISTID:"musicbrainz_artistid",MUSICBRAINZ_ALBUMARTISTID:"musicbrainz_albumartistid",MUSICBRAINZ_RELEASEGROUPID:"musicbrainz_releasegroupid",MUSICBRAINZ_WORKID:"musicbrainz_workid",MUSICBRAINZ_TRMID:"musicbrainz_trmid",MUSICBRAINZ_DISCID:"musicbrainz_discid",Acoustid_Id:"acoustid_id",ACOUSTID_FINGERPRINT:"acoustid_fingerprint",MUSICIP_PUID:"musicip_puid",Weblink:"website",REPLAYGAIN_TRACK_GAIN:"replaygain_track_gain",REPLAYGAIN_TRACK_PEAK:"replaygain_track_peak",MP3GAIN_MINMAX:"replaygain_track_minmax",MP3GAIN_UNDO:"replaygain_undo"};class oH extends Kc{constructor(){super(["APEv2"],aH)}}const lH={"©nam":"title","©ART":"artist",aART:"albumartist","----:com.apple.iTunes:Band":"albumartist","©alb":"album","©day":"date","©cmt":"comment","©com":"comment",trkn:"track",disk:"disk","©gen":"genre",covr:"picture","©wrt":"composer","©lyr":"lyrics",soal:"albumsort",sonm:"titlesort",soar:"artistsort",soaa:"albumartistsort",soco:"composersort","----:com.apple.iTunes:LYRICIST":"lyricist","----:com.apple.iTunes:CONDUCTOR":"conductor","----:com.apple.iTunes:REMIXER":"remixer","----:com.apple.iTunes:ENGINEER":"engineer","----:com.apple.iTunes:PRODUCER":"producer","----:com.apple.iTunes:DJMIXER":"djmixer","----:com.apple.iTunes:MIXER":"mixer","----:com.apple.iTunes:LABEL":"label","©grp":"grouping","----:com.apple.iTunes:SUBTITLE":"subtitle","----:com.apple.iTunes:DISCSUBTITLE":"discsubtitle",cpil:"compilation",tmpo:"bpm","----:com.apple.iTunes:MOOD":"mood","----:com.apple.iTunes:MEDIA":"media","----:com.apple.iTunes:CATALOGNUMBER":"catalognumber",tvsh:"tvShow",tvsn:"tvSeason",tves:"tvEpisode",sosn:"tvShowSort",tven:"tvEpisodeId",tvnn:"tvNetwork",pcst:"podcast",purl:"podcasturl","----:com.apple.iTunes:MusicBrainz Album Status":"releasestatus","----:com.apple.iTunes:MusicBrainz Album Type":"releasetype","----:com.apple.iTunes:MusicBrainz Album Release Country":"releasecountry","----:com.apple.iTunes:SCRIPT":"script","----:com.apple.iTunes:LANGUAGE":"language",cprt:"copyright","©cpy":"copyright","----:com.apple.iTunes:LICENSE":"license","©too":"encodedby",pgap:"gapless","----:com.apple.iTunes:BARCODE":"barcode","----:com.apple.iTunes:ISRC":"isrc","----:com.apple.iTunes:ASIN":"asin","----:com.apple.iTunes:NOTES":"comment","----:com.apple.iTunes:MusicBrainz Track Id":"musicbrainz_recordingid","----:com.apple.iTunes:MusicBrainz Release Track Id":"musicbrainz_trackid","----:com.apple.iTunes:MusicBrainz Album Id":"musicbrainz_albumid","----:com.apple.iTunes:MusicBrainz Artist Id":"musicbrainz_artistid","----:com.apple.iTunes:MusicBrainz Album Artist Id":"musicbrainz_albumartistid","----:com.apple.iTunes:MusicBrainz Release Group Id":"musicbrainz_releasegroupid","----:com.apple.iTunes:MusicBrainz Work Id":"musicbrainz_workid","----:com.apple.iTunes:MusicBrainz TRM Id":"musicbrainz_trmid","----:com.apple.iTunes:MusicBrainz Disc Id":"musicbrainz_discid","----:com.apple.iTunes:Acoustid Id":"acoustid_id","----:com.apple.iTunes:Acoustid Fingerprint":"acoustid_fingerprint","----:com.apple.iTunes:MusicIP PUID":"musicip_puid","----:com.apple.iTunes:fingerprint":"musicip_fingerprint","----:com.apple.iTunes:replaygain_track_gain":"replaygain_track_gain","----:com.apple.iTunes:replaygain_track_peak":"replaygain_track_peak","----:com.apple.iTunes:replaygain_album_gain":"replaygain_album_gain","----:com.apple.iTunes:replaygain_album_peak":"replaygain_album_peak","----:com.apple.iTunes:replaygain_track_minmax":"replaygain_track_minmax","----:com.apple.iTunes:replaygain_album_minmax":"replaygain_album_minmax","----:com.apple.iTunes:replaygain_undo":"replaygain_undo",gnre:"genre","----:com.apple.iTunes:ALBUMARTISTSORT":"albumartistsort","----:com.apple.iTunes:ARTISTS":"artists","----:com.apple.iTunes:ORIGINALDATE":"originaldate","----:com.apple.iTunes:ORIGINALYEAR":"originalyear","----:com.apple.iTunes:RELEASEDATE":"releasedate",desc:"description",ldes:"longDescription","©mvn":"movement","©mvi":"movementIndex","©mvc":"movementTotal","©wrk":"work",catg:"category",egid:"podcastId",hdvd:"hdVideo",keyw:"keywords",shwm:"showMovement",stik:"stik",rate:"rating"},cH="iTunes";class YE extends Kc{constructor(){super([cH],lH)}postMap(e,n){switch(e.id){case"rate":e.value={source:void 0,rating:Number.parseFloat(e.value)/100};break}}}const uH={TITLE:"title",ARTIST:"artist",ARTISTS:"artists",ALBUMARTIST:"albumartist","ALBUM ARTIST":"albumartist",ALBUM:"album",DATE:"date",ORIGINALDATE:"originaldate",ORIGINALYEAR:"originalyear",RELEASEDATE:"releasedate",COMMENT:"comment",TRACKNUMBER:"track",DISCNUMBER:"disk",GENRE:"genre",METADATA_BLOCK_PICTURE:"picture",COMPOSER:"composer",LYRICS:"lyrics",ALBUMSORT:"albumsort",TITLESORT:"titlesort",WORK:"work",ARTISTSORT:"artistsort",ALBUMARTISTSORT:"albumartistsort",COMPOSERSORT:"composersort",LYRICIST:"lyricist",WRITER:"writer",CONDUCTOR:"conductor",REMIXER:"remixer",ARRANGER:"arranger",ENGINEER:"engineer",PRODUCER:"producer",DJMIXER:"djmixer",MIXER:"mixer",LABEL:"label",GROUPING:"grouping",SUBTITLE:"subtitle",DISCSUBTITLE:"discsubtitle",TRACKTOTAL:"totaltracks",DISCTOTAL:"totaldiscs",COMPILATION:"compilation",RATING:"rating",BPM:"bpm",KEY:"key",MOOD:"mood",MEDIA:"media",CATALOGNUMBER:"catalognumber",RELEASESTATUS:"releasestatus",RELEASETYPE:"releasetype",RELEASECOUNTRY:"releasecountry",SCRIPT:"script",LANGUAGE:"language",COPYRIGHT:"copyright",LICENSE:"license",ENCODEDBY:"encodedby",ENCODERSETTINGS:"encodersettings",BARCODE:"barcode",ISRC:"isrc",ASIN:"asin",MUSICBRAINZ_TRACKID:"musicbrainz_recordingid",MUSICBRAINZ_RELEASETRACKID:"musicbrainz_trackid",MUSICBRAINZ_ALBUMID:"musicbrainz_albumid",MUSICBRAINZ_ARTISTID:"musicbrainz_artistid",MUSICBRAINZ_ALBUMARTISTID:"musicbrainz_albumartistid",MUSICBRAINZ_RELEASEGROUPID:"musicbrainz_releasegroupid",MUSICBRAINZ_WORKID:"musicbrainz_workid",MUSICBRAINZ_TRMID:"musicbrainz_trmid",MUSICBRAINZ_DISCID:"musicbrainz_discid",ACOUSTID_ID:"acoustid_id",ACOUSTID_ID_FINGERPRINT:"acoustid_fingerprint",MUSICIP_PUID:"musicip_puid",WEBSITE:"website",NOTES:"notes",TOTALTRACKS:"totaltracks",TOTALDISCS:"totaldiscs",DISCOGS_ARTIST_ID:"discogs_artist_id",DISCOGS_ARTISTS:"artists",DISCOGS_ARTIST_NAME:"artists",DISCOGS_ALBUM_ARTISTS:"albumartist",DISCOGS_CATALOG:"catalognumber",DISCOGS_COUNTRY:"releasecountry",DISCOGS_DATE:"originaldate",DISCOGS_LABEL:"label",DISCOGS_LABEL_ID:"discogs_label_id",DISCOGS_MASTER_RELEASE_ID:"discogs_master_release_id",DISCOGS_RATING:"discogs_rating",DISCOGS_RELEASED:"date",DISCOGS_RELEASE_ID:"discogs_release_id",DISCOGS_VOTES:"discogs_votes",CATALOGID:"catalognumber",STYLE:"genre",REPLAYGAIN_TRACK_GAIN:"replaygain_track_gain",REPLAYGAIN_TRACK_PEAK:"replaygain_track_peak",REPLAYGAIN_ALBUM_GAIN:"replaygain_album_gain",REPLAYGAIN_ALBUM_PEAK:"replaygain_album_peak",REPLAYGAIN_MINMAX:"replaygain_track_minmax",REPLAYGAIN_ALBUM_MINMAX:"replaygain_album_minmax",REPLAYGAIN_UNDO:"replaygain_undo"};class fh extends vn{static toRating(e,n,r){return{source:e?e.toLowerCase():void 0,rating:Number.parseFloat(n)/r*vn.maxRatingScore}}constructor(){super(["vorbis"],uH)}postMap(e){if(e.id==="RATING")e.value=fh.toRating(void 0,e.value,100);else if(e.id.indexOf("RATING:")===0){const n=e.id.split(":");e.value=fh.toRating(n[1],e.value,1),e.id=n[0]}}}const dH={IART:"artist",ICRD:"date",INAM:"title",TITL:"title",IPRD:"album",ITRK:"track",IPRT:"track",COMM:"comment",ICMT:"comment",ICNT:"releasecountry",GNRE:"genre",IWRI:"writer",RATE:"rating",YEAR:"year",ISFT:"encodedby",CODE:"encodedby",TURL:"website",IGNR:"genre",IENG:"engineer",ITCH:"technician",IMED:"media",IRPD:"album"};class hH extends vn{constructor(){super(["exif"],dH)}}const fH={"segment:title":"title","album:ARTIST":"albumartist","album:ARTISTSORT":"albumartistsort","album:TITLE":"album","album:DATE_RECORDED":"originaldate","album:DATE_RELEASED":"releasedate","album:PART_NUMBER":"disk","album:TOTAL_PARTS":"totaltracks","track:ARTIST":"artist","track:ARTISTSORT":"artistsort","track:TITLE":"title","track:PART_NUMBER":"track","track:MUSICBRAINZ_TRACKID":"musicbrainz_recordingid","track:MUSICBRAINZ_ALBUMID":"musicbrainz_albumid","track:MUSICBRAINZ_ARTISTID":"musicbrainz_artistid","track:PUBLISHER":"label","track:GENRE":"genre","track:ENCODER":"encodedby","track:ENCODER_OPTIONS":"encodersettings","edition:TOTAL_PARTS":"totaldiscs",picture:"picture"};class mH extends Kc{constructor(){super(["matroska"],fH)}}const pH={NAME:"title",AUTH:"artist","(c) ":"copyright",ANNO:"comment"};class gH extends vn{constructor(){super(["AIFF"],pH)}}class yH{constructor(){this.tagMappers={},[new tH,new sH,new G1,new YE,new YE,new fh,new oH,new K1,new hH,new mH,new gH].forEach(e=>{this.registerTagMapper(e)})}mapTag(e,n,r){if(this.tagMappers[e])return this.tagMappers[e].mapGenericTag(n,r);throw new Error(`No generic tag mapper defined for tag-format: ${e}`)}registerTagMapper(e){for(const n of e.tagTypes)this.tagMappers[n]=e}}const os=ke("music-metadata:collector"),vH=["matroska","APEv2","vorbis","ID3v2.4","ID3v2.3","ID3v2.2","exif","asf","iTunes","AIFF","ID3v1"];class xH{constructor(e){this.opts=e,this.format={tagTypes:[],trackInfo:[]},this.native={},this.common={track:{no:null,of:null},disk:{no:null,of:null},movementIndex:{no:null,of:null}},this.quality={warnings:[]},this.commonOrigin={},this.originPriority={},this.tagMapper=new yH;let n=1;for(const r of vH)this.originPriority[r]=n++;this.originPriority.artificial=500,this.originPriority.id3v1=600}hasAny(){return Object.keys(this.native).length>0}addStreamInfo(e){os(`streamInfo: type=${e.type?Vs[e.type]:"?"}, codec=${e.codecName}`),this.format.trackInfo.push(e)}setFormat(e,n){var r;os(`format: ${e} = ${n}`),this.format[e]=n,(r=this.opts)!=null&&r.observer&&this.opts.observer({metadata:this,tag:{type:"format",id:e,value:n}})}async addTag(e,n,r){os(`tag ${e}.${n} = ${r}`),this.native[e]||(this.format.tagTypes.push(e),this.native[e]=[]),this.native[e].push({id:n,value:r}),await this.toCommon(e,n,r)}addWarning(e){this.quality.warnings.push({message:e})}async postMap(e,n){switch(n.id){case"artist":if(this.commonOrigin.artist===this.originPriority[e])return this.postMap("artificial",{id:"artists",value:n.value});this.common.artists||this.setGenericTag("artificial",{id:"artists",value:n.value});break;case"artists":if((!this.common.artist||this.commonOrigin.artist===this.originPriority.artificial)&&(!this.common.artists||this.common.artists.indexOf(n.value)===-1)){const r=(this.common.artists||[]).concat([n.value]),s={id:"artist",value:wH(r)};this.setGenericTag("artificial",s)}break;case"picture":return this.postFixPicture(n.value).then(r=>{r!==null&&(n.value=r,this.setGenericTag(e,n))});case"totaltracks":this.common.track.of=vn.toIntOrNull(n.value);return;case"totaldiscs":this.common.disk.of=vn.toIntOrNull(n.value);return;case"movementTotal":this.common.movementIndex.of=vn.toIntOrNull(n.value);return;case"track":case"disk":case"movementIndex":{const r=this.common[n.id].of;this.common[n.id]=vn.normalizeTrack(n.value),this.common[n.id].of=r??this.common[n.id].of;return}case"bpm":case"year":case"originalyear":n.value=Number.parseInt(n.value,10);break;case"date":{const r=Number.parseInt(n.value.substr(0,4),10);Number.isNaN(r)||(this.common.year=r);break}case"discogs_label_id":case"discogs_release_id":case"discogs_master_release_id":case"discogs_artist_id":case"discogs_votes":n.value=typeof n.value=="string"?Number.parseInt(n.value,10):n.value;break;case"replaygain_track_gain":case"replaygain_track_peak":case"replaygain_album_gain":case"replaygain_album_peak":n.value=YV(n.value);break;case"replaygain_track_minmax":n.value=n.value.split(",").map(r=>Number.parseInt(r,10));break;case"replaygain_undo":{const r=n.value.split(",").map(i=>Number.parseInt(i,10));n.value={leftChannel:r[0],rightChannel:r[1]};break}case"gapless":case"compilation":case"podcast":case"showMovement":n.value=n.value==="1"||n.value===1;break;case"isrc":{const r=this.common[n.id];if(r&&r.indexOf(n.value)!==-1)return;break}case"comment":typeof n.value=="string"&&(n.value={text:n.value}),n.value.descriptor==="iTunPGAP"&&this.setGenericTag(e,{id:"gapless",value:n.value.text==="1"});break}n.value!==null&&this.setGenericTag(e,n)}toCommonMetadata(){return{format:this.format,native:this.native,quality:this.quality,common:this.common}}async postFixPicture(e){if(e.data&&e.data.length>0){if(!e.format){const n=await RR(Uint8Array.from(e.data));if(n)e.format=n.mime;else return null}switch(e.format=e.format.toLocaleLowerCase(),e.format){case"image/jpg":e.format="image/jpeg"}return e}return this.addWarning("Empty picture tag found"),null}async toCommon(e,n,r){const i={id:n,value:r},s=this.tagMapper.mapTag(e,i,this);s&&await this.postMap(e,s)}setGenericTag(e,n){var s;os(`common.${n.id} = ${n.value}`);const r=this.commonOrigin[n.id]||1e3,i=this.originPriority[e];if(JV(n.id))if(i<=r)this.common[n.id]=n.value,this.commonOrigin[n.id]=i;else return os(`Ignore native tag (singleton): ${e}.${n.id} = ${n.value}`);else if(i===r)!ZV(n.id)||this.common[n.id].indexOf(n.value)===-1?this.common[n.id].push(n.value):os(`Ignore duplicate value: ${e}.${n.id} = ${n.value}`);else if(i<r)this.common[n.id]=[n.value],this.commonOrigin[n.id]=i;else return os(`Ignore native tag (list): ${e}.${n.id} = ${n.value}`);(s=this.opts)!=null&&s.observer&&this.opts.observer({metadata:this,tag:{type:"common",id:n.id,value:n.value}})}}function wH(t){return t.length>2?`${t.slice(0,t.length-1).join(", ")} & ${t[t.length-1]}`:t.join(" & ")}class Cn{constructor(){this.metadata=void 0,this.tokenizer=void 0,this.options=void 0}init(e,n,r){return this.metadata=e,this.tokenizer=n,this.options=r,this}}const _H=/^[\x21-\x7e©][\x20-\x7e\x00()]{3}/,Ne={len:4,get:(t,e)=>{const n=H1(t.slice(e,e+Ne.len),"latin1");if(!n.match(_H))throw new Error(`FourCC contains invalid characters: ${KV(n)} "${n}"`);return n},put:(t,e,n)=>{const r=EV(n);if(r.length!==4)throw new Error("Invalid length");return t.set(r,e),e+4}};var Ca;(function(t){t[t.text_utf8=0]="text_utf8",t[t.binary=1]="binary",t[t.external_info=2]="external_info",t[t.reserved=3]="reserved"})(Ca||(Ca={}));const JE={len:52,get:(t,e)=>({ID:Ne.get(t,e),version:q.get(t,e+4)/1e3,descriptorBytes:q.get(t,e+8),headerBytes:q.get(t,e+12),seekTableBytes:q.get(t,e+16),headerDataBytes:q.get(t,e+20),apeFrameDataBytes:q.get(t,e+24),apeFrameDataBytesHigh:q.get(t,e+28),terminatingDataBytes:q.get(t,e+32),fileMD5:new en(16).get(t,e+36)})},EH={len:24,get:(t,e)=>({compressionLevel:ye.get(t,e),formatFlags:ye.get(t,e+2),blocksPerFrame:q.get(t,e+4),finalFrameBlocks:q.get(t,e+8),totalFrames:q.get(t,e+12),bitsPerSample:ye.get(t,e+16),channel:ye.get(t,e+18),sampleRate:q.get(t,e+20)})},An={len:32,get:(t,e)=>({ID:new Q(8,"ascii").get(t,e),version:q.get(t,e+8),size:q.get(t,e+12),fields:q.get(t,e+16),flags:MR(q.get(t,e+20))})},Tp={len:8,get:(t,e)=>({size:q.get(t,e),flags:MR(q.get(t,e+4))})};function MR(t){return{containsHeader:bu(t,31),containsFooter:bu(t,30),isHeader:bu(t,29),readOnly:bu(t,0),dataType:(t&6)>>1}}function bu(t,e){return(t&1<<e)!==0}const ls=ke("music-metadata:parser:APEv2"),ZE="APEv2",eS="APETAGEX";class vr extends Cn{constructor(){super(...arguments),this.ape={}}static tryParseApeHeader(e,n,r){const i=new vr;return i.init(e,n,r),i.tryParseApeHeader()}static calculateDuration(e){let n=e.totalFrames>1?e.blocksPerFrame*(e.totalFrames-1):0;return n+=e.finalFrameBlocks,n/e.sampleRate}static async findApeFooterOffset(e,n){const r=new Uint8Array(An.len);await e.randomRead(r,0,An.len,n-An.len);const i=An.get(r,0);if(i.ID==="APETAGEX")return i.flags.isHeader?ls(`APE Header found at offset=${n-An.len}`):(ls(`APE Footer found at offset=${n-An.len}`),n-=i.size),{footer:i,offset:n}}static parseTagFooter(e,n,r){const i=An.get(n,n.length-An.len);if(i.ID!==eS)throw new Error("Unexpected APEv2 Footer ID preamble value.");mo(n);const s=new vr;return s.init(e,mo(n),r),s.parseTags(i)}async tryParseApeHeader(){if(this.tokenizer.fileInfo.size&&this.tokenizer.fileInfo.size-this.tokenizer.position<An.len){ls("No APEv2 header found, end-of-file reached");return}const e=await this.tokenizer.peekToken(An);if(e.ID===eS)return await this.tokenizer.ignore(An.len),this.parseTags(e);if(ls(`APEv2 header not found at offset=${this.tokenizer.position}`),this.tokenizer.fileInfo.size){const n=this.tokenizer.fileInfo.size-this.tokenizer.position,r=new Uint8Array(n);return await this.tokenizer.readBuffer(r),vr.parseTagFooter(this.metadata,r,this.options)}}async parse(){const e=await this.tokenizer.readToken(JE);if(e.ID!=="MAC ")throw new Error("Unexpected descriptor ID");this.ape.descriptor=e;const n=e.descriptorBytes-JE.len,r=await(n>0?this.parseDescriptorExpansion(n):this.parseHeader());return await this.tokenizer.ignore(r.forwardBytes),this.tryParseApeHeader()}async parseTags(e){const n=new Uint8Array(256);let r=e.size-An.len;ls(`Parse APE tags at offset=${this.tokenizer.position}, size=${r}`);for(let i=0;i<e.fields;i++){if(r<Tp.len){this.metadata.addWarning(`APEv2 Tag-header: ${e.fields-i} items remaining, but no more tag data to read.`);break}const s=await this.tokenizer.readToken(Tp);r-=Tp.len+s.size,await this.tokenizer.peekBuffer(n,{length:Math.min(n.length,r)});let a=un(n,0,n.length);const o=await this.tokenizer.readToken(new Q(a,"ascii"));switch(await this.tokenizer.ignore(1),r-=o.length+1,s.flags.dataType){case Ca.text_utf8:{const u=(await this.tokenizer.readToken(new Q(s.size,"utf8"))).split(/\x00/g);await Promise.all(u.map(d=>this.metadata.addTag(ZE,o,d)));break}case Ca.binary:if(this.options.skipCovers)await this.tokenizer.ignore(s.size);else{const l=new Uint8Array(s.size);await this.tokenizer.readBuffer(l),a=un(l,0,l.length);const u=H1(l.slice(0,a)),d=l.slice(a+1);await this.metadata.addTag(ZE,o,{description:u,data:d})}break;case Ca.external_info:ls(`Ignore external info ${o}`),await this.tokenizer.ignore(s.size);break;case Ca.reserved:ls(`Ignore external info ${o}`),this.metadata.addWarning(`APEv2 header declares a reserved datatype for "${o}"`),await this.tokenizer.ignore(s.size);break}}}async parseDescriptorExpansion(e){return await this.tokenizer.ignore(e),this.parseHeader()}async parseHeader(){const e=await this.tokenizer.readToken(EH);if(this.metadata.setFormat("lossless",!0),this.metadata.setFormat("container","Monkey's Audio"),this.metadata.setFormat("bitsPerSample",e.bitsPerSample),this.metadata.setFormat("sampleRate",e.sampleRate),this.metadata.setFormat("numberOfChannels",e.channel),this.metadata.setFormat("duration",vr.calculateDuration(e)),!this.ape.descriptor)throw new Error("Missing APE descriptor");return{forwardBytes:this.ape.descriptor.seekTableBytes+this.ape.descriptor.headerDataBytes+this.ape.descriptor.apeFrameDataBytes+this.ape.descriptor.terminatingDataBytes}}}const Tu=ke("music-metadata:parser:ID3v1"),mh=["Blues","Classic Rock","Country","Dance","Disco","Funk","Grunge","Hip-Hop","Jazz","Metal","New Age","Oldies","Other","Pop","R&B","Rap","Reggae","Rock","Techno","Industrial","Alternative","Ska","Death Metal","Pranks","Soundtrack","Euro-Techno","Ambient","Trip-Hop","Vocal","Jazz+Funk","Fusion","Trance","Classical","Instrumental","Acid","House","Game","Sound Clip","Gospel","Noise","Alt. Rock","Bass","Soul","Punk","Space","Meditative","Instrumental Pop","Instrumental Rock","Ethnic","Gothic","Darkwave","Techno-Industrial","Electronic","Pop-Folk","Eurodance","Dream","Southern Rock","Comedy","Cult","Gangsta Rap","Top 40","Christian Rap","Pop/Funk","Jungle","Native American","Cabaret","New Wave","Psychedelic","Rave","Showtunes","Trailer","Lo-Fi","Tribal","Acid Punk","Acid Jazz","Polka","Retro","Musical","Rock & Roll","Hard Rock","Folk","Folk/Rock","National Folk","Swing","Fast-Fusion","Bebob","Latin","Revival","Celtic","Bluegrass","Avantgarde","Gothic Rock","Progressive Rock","Psychedelic Rock","Symphonic Rock","Slow Rock","Big Band","Chorus","Easy Listening","Acoustic","Humour","Speech","Chanson","Opera","Chamber Music","Sonata","Symphony","Booty Bass","Primus","Porn Groove","Satire","Slow Jam","Club","Tango","Samba","Folklore","Ballad","Power Ballad","Rhythmic Soul","Freestyle","Duet","Punk Rock","Drum Solo","A Cappella","Euro-House","Dance Hall","Goa","Drum & Bass","Club-House","Hardcore","Terror","Indie","BritPop","Negerpunk","Polsk Punk","Beat","Christian Gangsta Rap","Heavy Metal","Black Metal","Crossover","Contemporary Christian","Christian Rock","Merengue","Salsa","Thrash Metal","Anime","JPop","Synthpop","Abstract","Art Rock","Baroque","Bhangra","Big Beat","Breakbeat","Chillout","Downtempo","Dub","EBM","Eclectic","Electro","Electroclash","Emo","Experimental","Garage","Global","IDM","Illbient","Industro-Goth","Jam Band","Krautrock","Leftfield","Lounge","Math Rock","New Romantic","Nu-Breakz","Post-Punk","Post-Rock","Psytrance","Shoegaze","Space Rock","Trop Rock","World Music","Neoclassical","Audiobook","Audio Theatre","Neue Deutsche Welle","Podcast","Indie Rock","G-Funk","Dubstep","Garage Rock","Psybient"],Iu={len:128,get:(t,e)=>{const n=new la(3).get(t,e);return n==="TAG"?{header:n,title:new la(30).get(t,e+3),artist:new la(30).get(t,e+33),album:new la(30).get(t,e+63),year:new la(4).get(t,e+93),comment:new la(28).get(t,e+97),zeroByte:ie.get(t,e+127),track:ie.get(t,e+126),genre:ie.get(t,e+127)}:null}};class la{constructor(e){this.len=e,this.stringType=new Q(e,"latin1")}get(e,n){let r=this.stringType.get(e,n);return r=jR(r),r=r.trim(),r.length>0?r:void 0}}class Q1 extends Cn{static getGenre(e){if(e<mh.length)return mh[e]}async parse(){if(!this.tokenizer.fileInfo.size){Tu("Skip checking for ID3v1 because the file-size is unknown");return}if(this.options.apeHeader){this.tokenizer.ignore(this.options.apeHeader.offset-this.tokenizer.position);const r=new vr;r.init(this.metadata,this.tokenizer,this.options),await r.parseTags(this.options.apeHeader.footer)}const e=this.tokenizer.fileInfo.size-Iu.len;if(this.tokenizer.position>e){Tu("Already consumed the last 128 bytes");return}const n=await this.tokenizer.readToken(Iu,e);if(n){Tu("ID3v1 header found at: pos=%s",this.tokenizer.fileInfo.size-Iu.len);const r=["title","artist","album","comment","track","year"];for(const s of r)n[s]&&n[s]!==""&&await this.addTag(s,n[s]);const i=Q1.getGenre(n.genre);i&&await this.addTag("genre",i)}else Tu("ID3v1 header not found at: pos=%s",this.tokenizer.fileInfo.size-Iu.len)}async addTag(e,n){await this.metadata.addTag("ID3v1",e,n)}}const tS=ke("music-metadata:id3v2:frame-parser"),Vn="latin1";function SH(t){const e=[];let n,r="";for(const i of t)if(typeof n=="string")if(i==="("&&n==="")r+="(",n=void 0;else if(i===")"){r!==""&&(e.push(r),r="");const s=nS(n);s&&e.push(s),n=void 0}else n+=i;else i==="("?n="":r+=i;return r&&(e.length===0&&r.match(/^\d*$/)&&(r=nS(r)),r&&e.push(r)),e}function nS(t){if(t==="RX")return"Remix";if(t==="CR")return"Cover";if(t.match(/^\d*$/))return mh[Number.parseInt(t)]}class dn{constructor(e,n){this.major=e,this.warningCollector=n}readData(e,n,r){if(e.length===0){this.warningCollector.addWarning(`id3v2.${this.major} header has empty tag type=${n}`);return}const{encoding:i,bom:s}=DR.get(e,0),a=e.length;let o=0,l=[];const u=dn.getNullTerminatorLength(i);let d;switch(tS(`Parsing tag type=${n}, encoding=${i}, bom=${s}`),n!=="TXXX"&&n[0]==="T"?"T*":n){case"T*":case"GRP1":case"IPLS":case"MVIN":case"MVNM":case"PCS":case"PCST":{let h;try{h=rt(e.slice(1),i).replace(/\x00+$/,"")}catch(m){if(m instanceof Error){this.warningCollector.addWarning(`id3v2.${this.major} type=${n} header has invalid string value: ${m.message}`);break}throw m}switch(n){case"TMCL":case"TIPL":case"IPLS":l=dn.functionList(this.splitValue(n,h));break;case"TRK":case"TRCK":case"TPOS":l=h;break;case"TCOM":case"TEXT":case"TOLY":case"TOPE":case"TPE1":case"TSRC":l=this.splitValue(n,h);break;case"TCO":case"TCON":l=this.splitValue(n,h).map(m=>SH(m)).reduce((m,p)=>m.concat(p),[]);break;case"PCS":case"PCST":l=this.major>=4?this.splitValue(n,h):[h],l=Array.isArray(l)&&l[0]===""?1:0;break;default:l=this.major>=4?this.splitValue(n,h):[h]}break}case"TXXX":{const h=dn.readIdentifierAndData(e,o+1,a,i);l={description:h.id,text:this.splitValue(n,rt(h.data,i).replace(/\x00+$/,""))};break}case"PIC":case"APIC":if(r){const h={};switch(o+=1,this.major){case 2:h.format=rt(e.slice(o,o+3),"latin1"),o+=3;break;case 3:case 4:d=un(e,o,a,Vn),h.format=rt(e.slice(o,d),Vn),o=d+1;break;default:throw new Error(`Warning: unexpected major versionIndex: ${this.major}`)}h.format=dn.fixPictureMimeType(h.format),h.type=pc[e[o]],o+=1,d=un(e,o,a,i),h.description=rt(e.slice(o,d),i),o=d+u,h.data=e.slice(o,a),l=h}break;case"CNT":case"PCNT":l=X.get(e,0);break;case"SYLT":{const h=XE.get(e,0);o+=XE.len;const m={descriptor:"",language:h.language,contentType:h.contentType,timeStampFormat:h.timeStampFormat,syncText:[]};let p=!1;for(;o<a;){const g=dn.readNullTerminatedString(e.subarray(o),h.encoding);if(o+=g.len,p){const w=X.get(e,o);o+=X.len,m.syncText.push({text:g.text,timestamp:w})}else m.descriptor=g.text,p=!0}l=m;break}case"ULT":case"USLT":case"COM":case"COMM":{const h=D0.get(e,o);o+=D0.len;const m=dn.readNullTerminatedString(e.subarray(o),h.encoding);o+=m.len;const p=dn.readNullTerminatedString(e.subarray(o),h.encoding);l={language:h.language,descriptor:m.text,text:p.text};break}case"UFID":{const h=dn.readIdentifierAndData(e,o,a,Vn);l={owner_identifier:h.id,identifier:h.data};break}case"PRIV":{const h=dn.readIdentifierAndData(e,o,a,Vn);l={owner_identifier:h.id,data:h.data};break}case"POPM":{d=un(e,o,a,Vn);const h=rt(e.slice(o,d),Vn);o=d+1;const m=a-o;l={email:h,rating:ie.get(e,o),counter:m>=5?X.get(e,o+1):void 0};break}case"GEOB":{d=un(e,o+1,a,i);const h=rt(e.slice(o+1,d),Vn);o=d+1,d=un(e,o,a-o,i);const m=rt(e.slice(o,d),Vn);o=d+1,d=un(e,o,a-o,i);const p=rt(e.slice(o,d),Vn);l={type:h,filename:m,description:p,data:e.slice(o+1,a)};break}case"WCOM":case"WCOP":case"WOAF":case"WOAR":case"WOAS":case"WORS":case"WPAY":case"WPUB":d=un(e,o+1,a,i),l=rt(e.slice(o,d),Vn);break;case"WXXX":{d=un(e,o+1,a,i);const h=rt(e.slice(o+1,d),i);o=d+(i==="utf-16le"?2:1),l={description:h,url:rt(e.slice(o,a),Vn)};break}case"WFD":case"WFED":l=rt(e.slice(o+1,un(e,o+1,a,i)),i);break;case"MCDI":{l=e.slice(0,a);break}default:tS(`Warning: unsupported id3v2-tag-type: ${n}`);break}return l}static readNullTerminatedString(e,n){let r=n.bom?2:0;const i=un(e,r,e.length,n.encoding),s=e.slice(r,i);return n.encoding==="utf-16le"?r=i+2:r=i+1,{text:rt(s,n.encoding),len:r}}static fixPictureMimeType(e){switch(e=e.toLocaleLowerCase(),e){case"jpg":return"image/jpeg";case"png":return"image/png"}return e}static functionList(e){const n={};for(let r=0;r+1<e.length;r+=2){const i=e[r+1].split(",");n[e[r]]=n[e[r]]?n[e[r]].concat(i):i}return n}splitValue(e,n){let r;return this.major<4?(r=n.split(/\x00/g),r.length>1?this.warningCollector.addWarning(`ID3v2.${this.major} ${e} uses non standard null-separator.`):r=n.split(/\//g)):r=n.split(/\x00/g),dn.trimArray(r)}static trimArray(e){return e.map(n=>n.replace(/\x00+$/,"").trim())}static readIdentifierAndData(e,n,r,i){const s=un(e,n,r,i),a=rt(e.slice(n,s),i);return n=s+dn.getNullTerminatorLength(i),{id:a,data:e.slice(n,r)}}static getNullTerminatorLength(e){return e==="utf-16le"?2:1}}const rS=new TextDecoder("ascii");class Kn{constructor(){this.tokenizer=void 0,this.id3Header=void 0,this.metadata=void 0,this.headerType=void 0,this.options=void 0}static removeUnsyncBytes(e){let n=0,r=0;for(;n<e.length-1;)n!==r&&(e[r]=e[n]),n+=e[n]===255&&e[n+1]===0?2:1,r++;return n<e.length&&(e[r++]=e[n]),e.slice(0,r)}static getFrameHeaderLength(e){switch(e){case 2:return 6;case 3:case 4:return 10;default:throw new Error("header versionIndex is incorrect")}}static readFrameFlags(e){return{status:{tag_alter_preservation:Ue(e,0,6),file_alter_preservation:Ue(e,0,5),read_only:Ue(e,0,4)},format:{grouping_identity:Ue(e,1,7),compression:Ue(e,1,3),encryption:Ue(e,1,2),unsynchronisation:Ue(e,1,1),data_length_indicator:Ue(e,1,0)}}}static readFrameData(e,n,r,i,s){var o,l;const a=new dn(r,s);switch(r){case 2:return a.readData(e,n.id,i);case 3:case 4:return(o=n.flags)!=null&&o.format.unsynchronisation&&(e=Kn.removeUnsyncBytes(e)),(l=n.flags)!=null&&l.format.data_length_indicator&&(e=e.slice(4,e.length)),a.readData(e,n.id,i);default:throw new Error(`Unexpected majorVer: ${r}`)}}static makeDescriptionTagName(e,n){return e+(n?`:${n}`:"")}async parse(e,n,r){this.tokenizer=n,this.metadata=e,this.options=r;const i=await this.tokenizer.readToken(O0);if(i.fileIdentifier!=="ID3")throw new Error("expected ID3-header file-identifier 'ID3' was not found");return this.id3Header=i,this.headerType=`ID3v2.${i.version.major}`,i.flags.isExtendedHeader?this.parseExtendedHeader():this.parseId3Data(i.size)}async parseExtendedHeader(){const e=await this.tokenizer.readToken(QE),n=e.size-QE.len;return n>0?this.parseExtendedHeaderData(n,e.size):this.parseId3Data(this.id3Header.size-e.size)}async parseExtendedHeaderData(e,n){return await this.tokenizer.ignore(e),this.parseId3Data(this.id3Header.size-n)}async parseId3Data(e){const n=await this.tokenizer.readToken(new en(e));for(const r of this.parseMetadata(n))switch(r.id){case"TXXX":r.value&&await this.handleTag(r,r.value.text,()=>r.value.description);break;default:await(Array.isArray(r.value)?Promise.all(r.value.map(i=>this.addTag(r.id,i))):this.addTag(r.id,r.value))}}async handleTag(e,n,r,i=s=>s){await Promise.all(n.map(s=>this.addTag(Kn.makeDescriptionTagName(e.id,r(s)),i(s))))}async addTag(e,n){await this.metadata.addTag(this.headerType,e,n)}parseMetadata(e){let n=0;const r=[];for(;n!==e.length;){const i=Kn.getFrameHeaderLength(this.id3Header.version.major);if(n+i>e.length){this.metadata.addWarning("Illegal ID3v2 tag length");break}const s=e.slice(n,n+i);n+=i;const a=this.readFrameHeader(s,this.id3Header.version.major),o=e.slice(n,n+a.length);n+=a.length;const l=Kn.readFrameData(o,a,this.id3Header.version.major,!this.options.skipCovers,this.metadata);l&&r.push({id:a.id,value:l})}return r}readFrameHeader(e,n){let r;switch(n){case 2:r={id:rS.decode(e.slice(0,3)),length:Kt.get(e,3)},r.id.match(/[A-Z0-9]{3}/g)||this.metadata.addWarning(`Invalid ID3v2.${this.id3Header.version.major} frame-header-ID: ${r.id}`);break;case 3:case 4:r={id:rS.decode(e.slice(0,4)),length:(n===4?OR:X).get(e,4),flags:Kn.readFrameFlags(e.slice(8,10))},r.id.match(/[A-Z0-9]{4}/g)||this.metadata.addWarning(`Invalid ID3v2.${this.id3Header.version.major} frame-header-ID: ${r.id}`);break;default:throw new Error(`Unexpected majorVer: ${n}`)}return r}}const kH={NONE:"not compressed	PCM	Apple Computer",sowt:"PCM (byte swapped)",fl32:"32-bit floating point IEEE 32-bit float",fl64:"64-bit floating point IEEE 64-bit float	Apple Computer",alaw:"ALaw 2:1	8-bit ITU-T G.711 A-law",ulaw:"µLaw 2:1	8-bit ITU-T G.711 µ-law	Apple Computer",ULAW:"CCITT G.711 u-law 8-bit ITU-T G.711 µ-law",ALAW:"CCITT G.711 A-law 8-bit ITU-T G.711 A-law",FL32:"Float 32	IEEE 32-bit float "};class bH{constructor(e,n){this.isAifc=n;const r=n?22:18;if(e.chunkSize<r)throw new Error(`COMMON CHUNK size should always be at least ${r}`);this.len=e.chunkSize}get(e,n){const r=_e.get(e,n+8)-16398,i=_e.get(e,n+8+2),s={numChannels:_e.get(e,n),numSampleFrames:X.get(e,n+2),sampleSize:_e.get(e,n+6),sampleRate:r<0?i>>Math.abs(r):i<<r};if(this.isAifc){if(s.compressionType=Ne.get(e,n+18),this.len>22){const a=ie.get(e,n+22);if(a>0){const o=(a+1)%2;if(23+a+o===this.len)s.compressionName=new Q(a,"latin1").get(e,n+23);else throw new Error("Illegal pstring length")}else s.compressionName=void 0}}else s.compressionName="PCM";return s}}const Ip={len:8,get:(t,e)=>({chunkID:Ne.get(t,e),chunkSize:Number(BigInt(X.get(t,e+4)))})},Cp=ke("music-metadata:parser:aiff");class TH extends Cn{constructor(){super(...arguments),this.isCompressed=null}async parse(){if((await this.tokenizer.readToken(Ip)).chunkID!=="FORM")throw new Error("Invalid Chunk-ID, expected 'FORM'");const n=await this.tokenizer.readToken(Ne);switch(n){case"AIFF":this.metadata.setFormat("container",n),this.isCompressed=!1;break;case"AIFC":this.metadata.setFormat("container","AIFF-C"),this.isCompressed=!0;break;default:throw new Error(`Unsupported AIFF type: ${n}`)}this.metadata.setFormat("lossless",!this.isCompressed);try{for(;!this.tokenizer.fileInfo.size||this.tokenizer.fileInfo.size-this.tokenizer.position>=Ip.len;){Cp(`Reading AIFF chunk at offset=${this.tokenizer.position}`);const r=await this.tokenizer.readToken(Ip),i=2*Math.round(r.chunkSize/2),s=await this.readData(r);await this.tokenizer.ignore(i-s)}}catch(r){if(r instanceof Ke)Cp("End-of-stream");else throw r}}async readData(e){switch(e.chunkID){case"COMM":{if(this.isCompressed===null)throw new Error("Failed to parse AIFF.COMM chunk when compression type is unknown");const n=await this.tokenizer.readToken(new bH(e,this.isCompressed));return this.metadata.setFormat("bitsPerSample",n.sampleSize),this.metadata.setFormat("sampleRate",n.sampleRate),this.metadata.setFormat("numberOfChannels",n.numChannels),this.metadata.setFormat("numberOfSamples",n.numSampleFrames),this.metadata.setFormat("duration",n.numSampleFrames/n.sampleRate),(n.compressionName||n.compressionType)&&this.metadata.setFormat("codec",n.compressionName??kH[n.compressionType]),e.chunkSize}case"ID3 ":{const n=await this.tokenizer.readToken(new en(e.chunkSize)),r=mo(n);return await new Kn().parse(this.metadata,r,this.options),e.chunkSize}case"SSND":return this.metadata.format.duration&&this.metadata.setFormat("bitrate",8*e.chunkSize/this.metadata.format.duration),0;case"NAME":case"AUTH":case"(c) ":case"ANNO":return this.readTextChunk(e);default:return Cp(`Ignore chunk id=${e.chunkID}, size=${e.chunkSize}`),0}}async readTextChunk(e){const r=(await this.tokenizer.readToken(new Q(e.chunkSize,"ascii"))).split("\0").map(i=>i.trim()).filter(i=>i==null?void 0:i.length);return await Promise.all(r.map(i=>this.metadata.addTag("AIFF",e.chunkID,i))),e.chunkSize}}class I{static fromBin(e,n=0){return new I(I.decode(e,n))}static decode(e,n=0){const r=new DataView(e.buffer,n);return`${r.getUint32(0,!0).toString(16)}-${r.getUint16(4,!0).toString(16)}-${r.getUint16(6,!0).toString(16)}-${r.getUint16(8).toString(16)}-${W1(e.slice(n+10,n+16))}`.toUpperCase()}static decodeMediaType(e){switch(e.str){case I.AudioMedia.str:return"audio";case I.VideoMedia.str:return"video";case I.CommandMedia.str:return"command";case I.Degradable_JPEG_Media.str:return"degradable-jpeg";case I.FileTransferMedia.str:return"file-transfer";case I.BinaryMedia.str:return"binary"}}static encode(e){const n=new Uint8Array(16),r=new DataView(n.buffer);return r.setUint32(0,Number.parseInt(e.slice(0,8),16),!0),r.setUint16(4,Number.parseInt(e.slice(9,13),16),!0),r.setUint16(6,Number.parseInt(e.slice(14,18),16),!0),n.set(BE(e.slice(19,23)),8),n.set(BE(e.slice(24)),10),n}constructor(e){this.str=e}equals(e){return this.str===e.str}toBin(){return I.encode(this.str)}}I.HeaderObject=new I("75B22630-668E-11CF-A6D9-00AA0062CE6C");I.DataObject=new I("75B22636-668E-11CF-A6D9-00AA0062CE6C");I.SimpleIndexObject=new I("33000890-E5B1-11CF-89F4-00A0C90349CB");I.IndexObject=new I("D6E229D3-35DA-11D1-9034-00A0C90349BE");I.MediaObjectIndexObject=new I("FEB103F8-12AD-4C64-840F-2A1D2F7AD48C");I.TimecodeIndexObject=new I("3CB73FD0-0C4A-4803-953D-EDF7B6228F0C");I.FilePropertiesObject=new I("8CABDCA1-A947-11CF-8EE4-00C00C205365");I.StreamPropertiesObject=new I("B7DC0791-A9B7-11CF-8EE6-00C00C205365");I.HeaderExtensionObject=new I("5FBF03B5-A92E-11CF-8EE3-00C00C205365");I.CodecListObject=new I("86D15240-311D-11D0-A3A4-00A0C90348F6");I.ScriptCommandObject=new I("1EFB1A30-0B62-11D0-A39B-00A0C90348F6");I.MarkerObject=new I("F487CD01-A951-11CF-8EE6-00C00C205365");I.BitrateMutualExclusionObject=new I("D6E229DC-35DA-11D1-9034-00A0C90349BE");I.ErrorCorrectionObject=new I("75B22635-668E-11CF-A6D9-00AA0062CE6C");I.ContentDescriptionObject=new I("75B22633-668E-11CF-A6D9-00AA0062CE6C");I.ExtendedContentDescriptionObject=new I("D2D0A440-E307-11D2-97F0-00A0C95EA850");I.ContentBrandingObject=new I("2211B3FA-BD23-11D2-B4B7-00A0C955FC6E");I.StreamBitratePropertiesObject=new I("7BF875CE-468D-11D1-8D82-006097C9A2B2");I.ContentEncryptionObject=new I("2211B3FB-BD23-11D2-B4B7-00A0C955FC6E");I.ExtendedContentEncryptionObject=new I("298AE614-2622-4C17-B935-DAE07EE9289C");I.DigitalSignatureObject=new I("2211B3FC-BD23-11D2-B4B7-00A0C955FC6E");I.PaddingObject=new I("1806D474-CADF-4509-A4BA-9AABCB96AAE8");I.ExtendedStreamPropertiesObject=new I("14E6A5CB-C672-4332-8399-A96952065B5A");I.AdvancedMutualExclusionObject=new I("A08649CF-4775-4670-8A16-6E35357566CD");I.GroupMutualExclusionObject=new I("D1465A40-5A79-4338-B71B-E36B8FD6C249");I.StreamPrioritizationObject=new I("D4FED15B-88D3-454F-81F0-ED5C45999E24");I.BandwidthSharingObject=new I("A69609E6-517B-11D2-B6AF-00C04FD908E9");I.LanguageListObject=new I("7C4346A9-EFE0-4BFC-B229-393EDE415C85");I.MetadataObject=new I("C5F8CBEA-5BAF-4877-8467-AA8C44FA4CCA");I.MetadataLibraryObject=new I("44231C94-9498-49D1-A141-1D134E457054");I.IndexParametersObject=new I("D6E229DF-35DA-11D1-9034-00A0C90349BE");I.MediaObjectIndexParametersObject=new I("6B203BAD-3F11-48E4-ACA8-D7613DE2CFA7");I.TimecodeIndexParametersObject=new I("F55E496D-9797-4B5D-8C8B-604DFE9BFB24");I.CompatibilityObject=new I("26F18B5D-4584-47EC-9F5F-0E651F0452C9");I.AdvancedContentEncryptionObject=new I("43058533-6981-49E6-9B74-AD12CB86D58C");I.AudioMedia=new I("F8699E40-5B4D-11CF-A8FD-00805F5C442B");I.VideoMedia=new I("BC19EFC0-5B4D-11CF-A8FD-00805F5C442B");I.CommandMedia=new I("59DACFC0-59E6-11D0-A3AC-00A0C90348F6");I.JFIF_Media=new I("B61BE100-5B4E-11CF-A8FD-00805F5C442B");I.Degradable_JPEG_Media=new I("35907DE0-E415-11CF-A917-00805F5C442B");I.FileTransferMedia=new I("91BD222C-F21C-497A-8B6D-5AA86BFC0185");I.BinaryMedia=new I("3AFB65E2-47EF-40F2-AC2C-70A90D71D343");I.ASF_Index_Placeholder_Object=new I("D9AADE20-7C17-4F9C-BC28-8555DD98E2A2");function IH(t){return CH[t]}function om(t){return ki(rt(t,"utf-16le"))}const CH=[om,iS,AH,RH,PH,LR,iS];function iS(t){return new Uint8Array(t)}function AH(t,e=0){return LR(t,e)===1}function RH(t,e=0){return q.get(t,e)}function PH(t,e=0){return Wt.get(t,e)}function LR(t,e=0){return ye.get(t,e)}var sS;(function(t){t[t.UnicodeString=0]="UnicodeString",t[t.ByteArray=1]="ByteArray",t[t.Bool=2]="Bool",t[t.DWord=3]="DWord",t[t.QWord=4]="QWord",t[t.Word=5]="Word"})(sS||(sS={}));const NH={len:30,get:(t,e)=>({objectId:I.fromBin(t,e),objectSize:Number(Wt.get(t,e+16)),numberOfHeaderObjects:q.get(t,e+24)})},ms={len:24,get:(t,e)=>({objectId:I.fromBin(t,e),objectSize:Number(Wt.get(t,e+16))})};class ia{constructor(e){this.len=Number(e.objectSize)-ms.len}postProcessTag(e,n,r,i){if(n==="WM/Picture")e.push({id:n,value:X1.fromBuffer(i)});else{const s=IH(r);if(!s)throw new Error(`unexpected value headerType: ${r}`);e.push({id:n,value:s(i)})}}}class aS extends ia{get(e,n){return null}}class M0 extends ia{get(e,n){return{fileId:I.fromBin(e,n),fileSize:Wt.get(e,n+16),creationDate:Wt.get(e,n+24),dataPacketsCount:Wt.get(e,n+32),playDuration:Wt.get(e,n+40),sendDuration:Wt.get(e,n+48),preroll:Wt.get(e,n+56),flags:{broadcast:Ue(e,n+64,24),seekable:Ue(e,n+64,25)},minimumDataPacketSize:q.get(e,n+68),maximumDataPacketSize:q.get(e,n+72),maximumBitrate:q.get(e,n+76)}}}M0.guid=I.FilePropertiesObject;class L0 extends ia{get(e,n){return{streamType:I.decodeMediaType(I.fromBin(e,n)),errorCorrectionType:I.fromBin(e,n+8)}}}L0.guid=I.StreamPropertiesObject;class F0{constructor(){this.len=22}get(e,n){const r=new DataView(e.buffer,n);return{reserved1:I.fromBin(e,n),reserved2:r.getUint16(16,!0),extensionDataSize:r.getUint16(18,!0)}}}F0.guid=I.HeaderExtensionObject;const jH={len:20,get:(t,e)=>({entryCount:new DataView(t.buffer,e).getUint16(16,!0)})};async function oS(t){const e=await t.readNumber(ye);return(await t.readToken(new Q(e*2,"utf-16le"))).replace("\0","")}async function OH(t){const e=await t.readToken(jH),n=[];for(let r=0;r<e.entryCount;++r)n.push(await MH(t));return n}async function DH(t){const e=await t.readNumber(ye),n=new Uint8Array(e);return await t.readBuffer(n),n}async function MH(t){const e=await t.readNumber(ye);return{type:{videoCodec:(e&1)===1,audioCodec:(e&2)===2},codecName:await oS(t),description:await oS(t),information:await DH(t)}}class Hs extends ia{get(e,n){const r=[],i=new DataView(e.buffer,n);let s=10;for(let a=0;a<Hs.contentDescTags.length;++a){const o=i.getUint16(a*2,!0);if(o>0){const l=Hs.contentDescTags[a],u=s+o;r.push({id:l,value:om(e.slice(n+s,n+u))}),s=u}}return r}}Hs.guid=I.ContentDescriptionObject;Hs.contentDescTags=["Title","Author","Copyright","Description","Rating"];class $0 extends ia{get(e,n){const r=[],i=new DataView(e.buffer,n),s=i.getUint16(0,!0);let a=2;for(let o=0;o<s;o+=1){const l=i.getUint16(a,!0);a+=2;const u=om(e.slice(n+a,n+a+l));a+=l;const d=i.getUint16(a,!0);a+=2;const h=i.getUint16(a,!0);a+=2;const m=e.slice(n+a,n+a+h);a+=h,this.postProcessTag(r,u,d,m)}return r}}$0.guid=I.ExtendedContentDescriptionObject;class z0 extends ia{get(e,n){const r=new DataView(e.buffer,n);return{startTime:Wt.get(e,n),endTime:Wt.get(e,n+8),dataBitrate:r.getInt32(12,!0),bufferSize:r.getInt32(16,!0),initialBufferFullness:r.getInt32(20,!0),alternateDataBitrate:r.getInt32(24,!0),alternateBufferSize:r.getInt32(28,!0),alternateInitialBufferFullness:r.getInt32(32,!0),maximumObjectSize:r.getInt32(36,!0),flags:{reliableFlag:Ue(e,n+40,0),seekableFlag:Ue(e,n+40,1),resendLiveCleanpointsFlag:Ue(e,n+40,2)},streamNumber:r.getInt16(42,!0),streamLanguageId:r.getInt16(44,!0),averageTimePerFrame:r.getInt32(52,!0),streamNameCount:r.getInt32(54,!0),payloadExtensionSystems:r.getInt32(56,!0),streamNames:[],streamPropertiesObject:null}}}z0.guid=I.ExtendedStreamPropertiesObject;class ph extends ia{get(e,n){const r=[],i=new DataView(e.buffer,n),s=i.getUint16(0,!0);let a=2;for(let o=0;o<s;o+=1){a+=4;const l=i.getUint16(a,!0);a+=2;const u=i.getUint16(a,!0);a+=2;const d=i.getUint32(a,!0);a+=4;const h=om(e.slice(n+a,n+a+l));a+=l;const m=e.slice(n+a,n+a+d);a+=d,this.postProcessTag(r,h,u,m)}return r}}ph.guid=I.MetadataObject;class U0 extends ph{}U0.guid=I.MetadataLibraryObject;class X1{static fromBuffer(e){return new X1(e.length).get(e,0)}constructor(e){this.len=e}get(e,n){const r=new DataView(e.buffer,n),i=r.getUint8(0),s=r.getInt32(1,!0);let a=5;for(;r.getUint16(a)!==0;)a+=2;const o=new Q(a-5,"utf-16le").get(e,5);for(;r.getUint16(a)!==0;)a+=2;const l=new Q(a-5,"utf-16le").get(e,5);return{type:pc[i],format:o,description:l,size:s,data:e.slice(a+4)}}}const Cu=ke("music-metadata:parser:ASF"),LH="asf";class FH extends Cn{async parse(){const e=await this.tokenizer.readToken(NH);if(!e.objectId.equals(I.HeaderObject))throw new Error(`expected asf header; but was not found; got: ${e.objectId.str}`);try{await this.parseObjectHeader(e.numberOfHeaderObjects)}catch(n){Cu("Error while parsing ASF: %s",n)}}async parseObjectHeader(e){let n;do{const r=await this.tokenizer.readToken(ms);switch(Cu("header GUID=%s",r.objectId.str),r.objectId.str){case M0.guid.str:{const i=await this.tokenizer.readToken(new M0(r));this.metadata.setFormat("duration",Number(i.playDuration/BigInt(1e3))/1e4-Number(i.preroll)/1e3),this.metadata.setFormat("bitrate",i.maximumBitrate);break}case L0.guid.str:{const i=await this.tokenizer.readToken(new L0(r));this.metadata.setFormat("container",`ASF/${i.streamType}`);break}case F0.guid.str:{const i=await this.tokenizer.readToken(new F0);await this.parseExtensionObject(i.extensionDataSize);break}case Hs.guid.str:n=await this.tokenizer.readToken(new Hs(r)),await this.addTags(n);break;case $0.guid.str:n=await this.tokenizer.readToken(new $0(r)),await this.addTags(n);break;case I.CodecListObject.str:{const i=await OH(this.tokenizer);i.forEach(a=>{this.metadata.addStreamInfo({type:a.type.videoCodec?Vs.video:Vs.audio,codecName:a.codecName})});const s=i.filter(a=>a.type.audioCodec).map(a=>a.codecName).join("/");this.metadata.setFormat("codec",s);break}case I.StreamBitratePropertiesObject.str:await this.tokenizer.ignore(r.objectSize-ms.len);break;case I.PaddingObject.str:Cu("Padding: %s bytes",r.objectSize-ms.len),await this.tokenizer.ignore(r.objectSize-ms.len);break;default:this.metadata.addWarning(`Ignore ASF-Object-GUID: ${r.objectId.str}`),Cu("Ignore ASF-Object-GUID: %s",r.objectId.str),await this.tokenizer.readToken(new aS(r))}}while(--e)}async addTags(e){await Promise.all(e.map(({id:n,value:r})=>this.metadata.addTag(LH,n,r)))}async parseExtensionObject(e){do{const n=await this.tokenizer.readToken(ms),r=n.objectSize-ms.len;switch(n.objectId.str){case z0.guid.str:await this.tokenizer.readToken(new z0(n));break;case ph.guid.str:{const i=await this.tokenizer.readToken(new ph(n));await this.addTags(i);break}case U0.guid.str:{const i=await this.tokenizer.readToken(new U0(n));await this.addTags(i);break}case I.PaddingObject.str:await this.tokenizer.ignore(r);break;case I.CompatibilityObject.str:this.tokenizer.ignore(r);break;case I.ASF_Index_Placeholder_Object.str:await this.tokenizer.ignore(r);break;default:this.metadata.addWarning(`Ignore ASF-Object-GUID: ${n.objectId.str}`),await this.tokenizer.readToken(new aS(n));break}e-=n.objectSize}while(e>0)}}class gc{static fromBase64(e){return gc.fromBuffer(Uint8Array.from(atob(e),n=>n.charCodeAt(0)))}static fromBuffer(e){return new gc(e.length).get(e,0)}constructor(e){this.len=e}get(e,n){const r=pc[X.get(e,n)];n+=4;const i=X.get(e,n);n+=4;const s=new Q(i,"utf-8").get(e,n);n+=i;const a=X.get(e,n);n+=4;const o=new Q(a,"utf-8").get(e,n);n+=a;const l=X.get(e,n);n+=4;const u=X.get(e,n);n+=4;const d=X.get(e,n);n+=4;const h=X.get(e,n);n+=4;const m=X.get(e,n);n+=4;const p=Uint8Array.from(e.slice(n,n+m));return{type:r,format:s,description:o,width:l,height:u,colour_depth:d,indexed_color:h,data:p}}}const Au={len:7,get:(t,e)=>({packetType:ie.get(t,e),vorbis:new Q(6,"ascii").get(t,e+1)})},$H={len:23,get:(t,e)=>({version:q.get(t,e+0),channelMode:ie.get(t,e+4),sampleRate:q.get(t,e+5),bitrateMax:q.get(t,e+9),bitrateNominal:q.get(t,e+13),bitrateMin:q.get(t,e+17)})},Ap=ke("music-metadata:parser:ID3");class lm extends Cn{constructor(){super(...arguments),this.id3parser=new Kn}static async startsWithID3v2Header(e){return(await e.peekToken(O0)).fileIdentifier==="ID3"}async parse(){try{await this.parseID3v2()}catch(e){if(e instanceof Ke)Ap("End-of-stream");else throw e}}finalize(){}async parseID3v2(){await this.tryReadId3v2Headers(),Ap("End of ID3v2 header, go to MPEG-parser: pos=%s",this.tokenizer.position),await this.postId3v2Parse(),this.options.skipPostHeaders&&this.metadata.hasAny()?this.finalize():(await new Q1().init(this.metadata,this.tokenizer,this.options).parse(),this.finalize())}async tryReadId3v2Headers(){if((await this.tokenizer.peekToken(O0)).fileIdentifier==="ID3")return Ap("Found ID3v2 header, pos=%s",this.tokenizer.position),await this.id3parser.parse(this.metadata,this.tokenizer,this.options),this.tryReadId3v2Headers()}}class FR{constructor(e,n){this.data=e,this.offset=n}readInt32(){const e=q.get(this.data,this.offset);return this.offset+=4,e}readStringUtf8(){const e=this.readInt32(),n=new TextDecoder("utf-8").decode(this.data.subarray(this.offset,this.offset+e));return this.offset+=e,n}parseUserComment(){const e=this.offset,n=this.readStringUtf8(),r=n.indexOf("=");return{key:n.slice(0,r).toUpperCase(),value:n.slice(r+1),len:this.offset-e}}}const ca=ke("music-metadata:parser:ogg:vorbis1");class Ws{constructor(e,n){this.metadata=e,this.options=n,this.pageSegments=[]}async parsePage(e,n){if(e.headerType.firstPage)this.parseFirstPage(e,n);else{if(e.headerType.continued){if(this.pageSegments.length===0)throw new Error("Cannot continue on previous page");this.pageSegments.push(n)}if(e.headerType.lastPage||!e.headerType.continued){if(this.pageSegments.length>0){const r=Ws.mergeUint8Arrays(this.pageSegments);await this.parseFullPage(r)}this.pageSegments=e.headerType.lastPage?[]:[n]}}e.headerType.lastPage&&this.calculateDuration(e)}static mergeUint8Arrays(e){const n=e.reduce((i,s)=>i+s.length,0),r=new Uint8Array(n);return e.forEach((i,s,a)=>{const o=a.slice(0,s).reduce((l,u)=>l+u.length,0);r.set(i,o)}),r}async flush(){await this.parseFullPage(Ws.mergeUint8Arrays(this.pageSegments))}async parseUserComment(e,n){const i=new FR(e,n).parseUserComment();return await this.addTag(i.key,i.value),i.len}async addTag(e,n){if(e==="METADATA_BLOCK_PICTURE"&&typeof n=="string"){if(this.options.skipCovers){ca("Ignore picture");return}n=gc.fromBase64(n),ca(`Push picture: id=${e}, format=${n.format}`)}else ca(`Push tag: id=${e}, value=${n}`);await this.metadata.addTag("vorbis",e,n)}calculateDuration(e){this.metadata.format.sampleRate&&e.absoluteGranulePosition>=0&&(this.metadata.setFormat("numberOfSamples",e.absoluteGranulePosition),this.metadata.setFormat("duration",e.absoluteGranulePosition/this.metadata.format.sampleRate))}parseFirstPage(e,n){this.metadata.setFormat("codec","Vorbis I"),ca("Parse first page");const r=Au.get(n,0);if(r.vorbis!=="vorbis")throw new Error("Metadata does not look like Vorbis");if(r.packetType===1){const i=$H.get(n,Au.len);this.metadata.setFormat("sampleRate",i.sampleRate),this.metadata.setFormat("bitrate",i.bitrateNominal),this.metadata.setFormat("numberOfChannels",i.channelMode),ca("sample-rate=%s[hz], bitrate=%s[b/s], channel-mode=%s",i.sampleRate,i.bitrateNominal,i.channelMode)}else throw new Error("First Ogg page should be type 1: the identification header")}async parseFullPage(e){const n=Au.get(e,0);switch(ca("Parse full page: type=%s, byteLength=%s",n.packetType,e.byteLength),n.packetType){case 3:return this.parseUserCommentList(e,Au.len)}}async parseUserCommentList(e,n){const r=q.get(e,n);n+=4,n+=r;let i=q.get(e,n);for(n+=4;i-- >0;)n+=await this.parseUserComment(e,n)}}const zH=ke("music-metadata:parser:FLAC");var Fr;(function(t){t[t.STREAMINFO=0]="STREAMINFO",t[t.PADDING=1]="PADDING",t[t.APPLICATION=2]="APPLICATION",t[t.SEEKTABLE=3]="SEEKTABLE",t[t.VORBIS_COMMENT=4]="VORBIS_COMMENT",t[t.CUESHEET=5]="CUESHEET",t[t.PICTURE=6]="PICTURE"})(Fr||(Fr={}));class UH extends lm{constructor(){super(...arguments),this.padding=0}init(e,n,r){return super.init(e,n,r),this.vorbisParser=new Ws(e,r),this}async postId3v2Parse(){if((await this.tokenizer.readToken(Ne)).toString()!=="fLaC")throw new Error("Invalid FLAC preamble");let n;do n=await this.tokenizer.readToken(BH),await this.parseDataBlock(n);while(!n.lastBlock);if(this.tokenizer.fileInfo.size&&this.metadata.format.duration){const r=this.tokenizer.fileInfo.size-this.tokenizer.position;this.metadata.setFormat("bitrate",8*r/this.metadata.format.duration)}}async parseDataBlock(e){switch(zH(`blockHeader type=${e.type}, length=${e.length}`),e.type){case Fr.STREAMINFO:return this.parseBlockStreamInfo(e.length);case Fr.PADDING:this.padding+=e.length;break;case Fr.APPLICATION:break;case Fr.SEEKTABLE:break;case Fr.VORBIS_COMMENT:return this.parseComment(e.length);case Fr.CUESHEET:break;case Fr.PICTURE:await this.parsePicture(e.length);return;default:this.metadata.addWarning(`Unknown block type: ${e.type}`)}return this.tokenizer.ignore(e.length).then()}async parseBlockStreamInfo(e){if(e!==lS.len)throw new Error("Unexpected block-stream-info length");const n=await this.tokenizer.readToken(lS);this.metadata.setFormat("container","FLAC"),this.metadata.setFormat("codec","FLAC"),this.metadata.setFormat("lossless",!0),this.metadata.setFormat("numberOfChannels",n.channels),this.metadata.setFormat("bitsPerSample",n.bitsPerSample),this.metadata.setFormat("sampleRate",n.sampleRate),n.totalSamples>0&&this.metadata.setFormat("duration",n.totalSamples/n.sampleRate)}async parseComment(e){const n=await this.tokenizer.readToken(new en(e)),r=new FR(n,0);r.readStringUtf8();const i=r.readInt32(),s=new Array(i);for(let a=0;a<i;a++)s[a]=r.parseUserComment();await Promise.all(s.map(a=>this.vorbisParser.addTag(a.key,a.value)))}async parsePicture(e){if(this.options.skipCovers)return this.tokenizer.ignore(e);const n=await this.tokenizer.readToken(new gc(e));this.vorbisParser.addTag("METADATA_BLOCK_PICTURE",n)}}const BH={len:4,get:(t,e)=>({lastBlock:Ue(t,e,7),type:de(t,e,1,7),length:Kt.get(t,e+1)})},lS={len:34,get:(t,e)=>({minimumBlockSize:_e.get(t,e),maximumBlockSize:_e.get(t,e+2)/1e3,minimumFrameSize:Kt.get(t,e+4),maximumFrameSize:Kt.get(t,e+7),sampleRate:Kt.get(t,e+10)>>4,channels:de(t,e+12,4,3)+1,bitsPerSample:de(t,e+12,7,5)+1,totalSamples:de(t,e+13,4,36),fileMD5:new en(16).get(t,e+18)})},$R=ke("music-metadata:parser:MP4:atom"),gh={len:8,get:(t,e)=>{const n=X.get(t,e);if(n<0)throw new Error("Invalid atom header length");return{length:BigInt(n),name:new Q(4,"latin1").get(t,e+4)}},put:(t,e,n)=>(X.put(t,e,Number(n.length)),Ne.put(t,e+4,n.name))},VH=V1,cS={len:4,get:(t,e)=>({type:new Q(4,"ascii").get(t,e)})};class zR{constructor(e,n,r){if(this.len=e,e<n)throw new Error(`Atom ${r} expected to be ${n}, but specifies ${e} bytes long.`);e>n&&$R(`Warning: atom ${r} expected to be ${n}, but was actually ${e} bytes long.`)}}const po={len:4,get:(t,e)=>{const n=X.get(t,e)-2082844800;return new Date(n*1e3)}};class HH extends zR{constructor(e){super(e,24,"mdhd"),this.len=e}get(e,n){return{version:ie.get(e,n+0),flags:Kt.get(e,n+1),creationTime:po.get(e,n+4),modificationTime:po.get(e,n+8),timeScale:X.get(e,n+12),duration:X.get(e,n+16),language:_e.get(e,n+20),quality:_e.get(e,n+22)}}}class WH extends zR{constructor(e){super(e,100,"mvhd"),this.len=e}get(e,n){return{version:ie.get(e,n),flags:Kt.get(e,n+1),creationTime:po.get(e,n+4),modificationTime:po.get(e,n+8),timeScale:X.get(e,n+12),duration:X.get(e,n+16),preferredRate:X.get(e,n+20),preferredVolume:_e.get(e,n+24),previewTime:X.get(e,n+72),previewDuration:X.get(e,n+76),posterTime:X.get(e,n+80),selectionTime:X.get(e,n+84),selectionDuration:X.get(e,n+88),currentTime:X.get(e,n+92),nextTrackID:X.get(e,n+96)}}}class qH{constructor(e){this.len=e}get(e,n){return{type:{set:ie.get(e,n+0),type:Kt.get(e,n+1)},locale:Kt.get(e,n+4),value:new en(this.len-8).get(e,n+8)}}}class GH{constructor(e){this.len=e}get(e,n){return{version:ie.get(e,n),flags:Kt.get(e,n+1),name:new Q(this.len-4,"utf-8").get(e,n+4)}}}class KH{constructor(e){this.len=e}get(e,n){return{version:ie.get(e,n),flags:Kt.get(e,n+1),creationTime:po.get(e,n+4),modificationTime:po.get(e,n+8),trackId:X.get(e,n+12),duration:X.get(e,n+20),layer:_e.get(e,n+24),alternateGroup:_e.get(e,n+26),volume:_e.get(e,n+28)}}}const uS={len:8,get:(t,e)=>({version:ie.get(t,e),flags:Kt.get(t,e+1),numberOfEntries:X.get(t,e+4)})};class QH{constructor(e){this.len=e}get(e,n){return{dataFormat:Ne.get(e,n),dataReferenceIndex:_e.get(e,n+10),description:new en(this.len-12).get(e,n+12)}}}class XH{constructor(e){this.len=e}get(e,n){const r=uS.get(e,n);n+=uS.len;const i=[];for(let s=0;s<r.numberOfEntries;++s){const a=X.get(e,n);n+=X.len,i.push(new QH(a).get(e,n)),n+=a}return{header:r,table:i}}}const dS={len:8,get(t,e){return{version:qr.get(t,e),revision:qr.get(t,e+2),vendor:_n.get(t,e+4)}}},YH={len:12,get(t,e){return{numAudioChannels:qr.get(t,e+0),sampleSize:qr.get(t,e+2),compressionId:qr.get(t,e+4),packetSize:qr.get(t,e+6),sampleRate:_e.get(t,e+8)+_e.get(t,e+10)/1e4}}};class Y1{constructor(e,n){this.len=e,this.token=n}get(e,n){const r=_n.get(e,n+4);return{version:mc.get(e,n+0),flags:B1.get(e,n+1),numberOfEntries:r,entries:UR(e,this.token,n+8,this.len-8,r)}}}const JH={len:8,get(t,e){return{count:_n.get(t,e+0),duration:_n.get(t,e+4)}}};class ZH extends Y1{constructor(e){super(e,JH),this.len=e}}const eW={len:12,get(t,e){return{firstChunk:_n.get(t,e),samplesPerChunk:_n.get(t,e+4),sampleDescriptionId:_n.get(t,e+8)}}};class tW extends Y1{constructor(e){super(e,eW),this.len=e}}class nW{constructor(e){this.len=e}get(e,n){const r=_n.get(e,n+8);return{version:mc.get(e,n),flags:B1.get(e,n+1),sampleSize:_n.get(e,n+4),numberOfEntries:r,entries:UR(e,_n,n+12,this.len-12,r)}}}class rW extends Y1{constructor(e){super(e,_n),this.len=e}}class iW{constructor(e){this.len=e}get(e,n){const r=qr.get(e,n+0);return new Q(r,"utf-8").get(e,n+2)}}function UR(t,e,n,r,i){if($R(`remainingLen=${r}, numberOfEntries=${i} * token-len=${e.len}`),r===0)return[];if(r!==i*e.len)throw new Error("mismatch number-of-entries with remaining atom-length");const s=[];for(let a=0;a<i;++a)s.push(e.get(t,n)),n+=e.len;return s}const sW=ke("music-metadata:parser:MP4:Atom");class yh{static async readAtom(e,n,r,i){const s=e.position,a=await e.readToken(gh);a.length===BigInt(1)&&(a.length=await e.readToken(VH));const l=new yh(a,a.length===BigInt(1),r),u=l.getPayloadLength(i);return sW(`parse atom name=${l.atomPath}, extended=${l.extended}, offset=${s}, len=${l.header.length}`),await l.readData(e,n,u),l}constructor(e,n,r){this.header=e,this.extended=n,this.parent=r,this.children=[],this.atomPath=(this.parent?`${this.parent.atomPath}.`:"")+this.header.name}getHeaderLength(){return this.extended?16:8}getPayloadLength(e){return(this.header.length===BigInt(0)?e:Number(this.header.length))-this.getHeaderLength()}async readAtoms(e,n,r){for(;r>0;){const i=await yh.readAtom(e,n,this,r);this.children.push(i),r-=i.header.length===BigInt(0)?r:Number(i.header.length)}}async readData(e,n,r){switch(this.header.name){case"moov":case"udta":case"trak":case"mdia":case"minf":case"stbl":case"<id>":case"ilst":case"tref":return this.readAtoms(e,n,this.getPayloadLength(r));case"meta":{const s=(await e.peekToken(gh)).name==="hdlr"?0:4;return await e.ignore(s),this.readAtoms(e,n,this.getPayloadLength(r)-s)}default:return n(this,r)}}}const lr=ke("music-metadata:parser:MP4"),aW="iTunes",hS={raw:{lossy:!1,format:"raw"},MAC3:{lossy:!0,format:"MACE 3:1"},MAC6:{lossy:!0,format:"MACE 6:1"},ima4:{lossy:!0,format:"IMA 4:1"},ulaw:{lossy:!0,format:"uLaw 2:1"},alaw:{lossy:!0,format:"uLaw 2:1"},Qclp:{lossy:!0,format:"QUALCOMM PureVoice"},".mp3":{lossy:!0,format:"MPEG-1 layer 3"},alac:{lossy:!1,format:"ALAC"},"ac-3":{lossy:!0,format:"AC-3"},mp4a:{lossy:!0,format:"MPEG-4/AAC"},mp4s:{lossy:!0,format:"MP4S"},c608:{lossy:!0,format:"CEA-608"},c708:{lossy:!0,format:"CEA-708"}};function fS(t,e,n){return n.indexOf(t)===e}class vh extends Cn{constructor(){super(...arguments),this.tracks=[],this.atomParsers={mvhd:async e=>{const n=await this.tokenizer.readToken(new WH(e));this.metadata.setFormat("creationTime",n.creationTime),this.metadata.setFormat("modificationTime",n.modificationTime)},mdhd:async e=>{const n=await this.tokenizer.readToken(new HH(e)),r=this.getTrackDescription();r.creationTime=n.creationTime,r.modificationTime=n.modificationTime,r.timeScale=n.timeScale,r.duration=n.duration},chap:async e=>{const n=this.getTrackDescription(),r=[];for(;e>=X.len;)r.push(await this.tokenizer.readNumber(X)),e-=X.len;n.chapterList=r},tkhd:async e=>{const n=await this.tokenizer.readToken(new KH(e));this.tracks.push(n)},mdat:async e=>{if(this.audioLengthInBytes=e,this.calculateBitRate(),this.options.includeChapters){const n=this.tracks.filter(r=>r.chapterList);if(n.length===1){const r=n[0].chapterList,i=this.tracks.filter(s=>r.indexOf(s.trackId)!==-1);if(i.length===1)return this.parseChapterTrack(i[0],n[0],e)}}await this.tokenizer.ignore(e)},ftyp:async e=>{const n=[];for(;e>0;){const i=await this.tokenizer.readToken(cS);e-=cS.len;const s=i.type.replace(/\W/g,"");s.length>0&&n.push(s)}lr(`ftyp: ${n.join("/")}`);const r=n.filter(fS).join("/");this.metadata.setFormat("container",r)},stsd:async e=>{const n=await this.tokenizer.readToken(new XH(e)),r=this.getTrackDescription();r.soundSampleDescription=n.table.map(i=>this.parseSoundSampleDescription(i))},stsc:async e=>{const n=await this.tokenizer.readToken(new tW(e));this.getTrackDescription().sampleToChunkTable=n.entries},stts:async e=>{const n=await this.tokenizer.readToken(new ZH(e));this.getTrackDescription().timeToSampleTable=n.entries},stsz:async e=>{const n=await this.tokenizer.readToken(new nW(e)),r=this.getTrackDescription();r.sampleSize=n.sampleSize,r.sampleSizeTable=n.entries},stco:async e=>{const n=await this.tokenizer.readToken(new rW(e));this.getTrackDescription().chunkOffsetTable=n.entries},date:async e=>{const n=await this.tokenizer.readToken(new Q(e,"utf-8"));await this.addTag("date",n)}}}static read_BE_Integer(e,n){const r=(n?"INT":"UINT")+e.length*8+(e.length>1?"_BE":""),i=fV[r];if(!i)throw new Error(`Token for integer type not found: "${r}"`);return Number(i.get(e,0))}async parse(){this.tracks=[];let e=this.tokenizer.fileInfo.size||0;for(;!this.tokenizer.fileInfo.size||e>0;){try{if((await this.tokenizer.peekToken(gh)).name==="\0\0\0\0"){const a=`Error at offset=${this.tokenizer.position}: box.id=0`;lr(a),this.addWarning(a);break}}catch(s){if(s instanceof Error){const a=`Error at offset=${this.tokenizer.position}: ${s.message}`;lr(a),this.addWarning(a)}else throw s;break}const i=await yh.readAtom(this.tokenizer,(s,a)=>this.handleAtom(s,a),null,e);e-=i.header.length===BigInt(0)?e:Number(i.header.length)}const n=[];this.tracks.forEach(i=>{const s=[];i.soundSampleDescription.forEach(a=>{const o={},l=hS[a.dataFormat];if(l?(s.push(l.format),o.codecName=l.format):o.codecName=`<${a.dataFormat}>`,a.description){const{description:u}=a;u.sampleRate>0&&(o.type=Vs.audio,o.audio={samplingFrequency:u.sampleRate,bitDepth:u.sampleSize,channels:u.numAudioChannels})}this.metadata.addStreamInfo(o)}),s.length>=1&&n.push(s.join("/"))}),n.length>0&&this.metadata.setFormat("codec",n.filter(fS).join("+"));const r=this.tracks.filter(i=>i.soundSampleDescription.length>=1&&i.soundSampleDescription[0].description&&i.soundSampleDescription[0].description.numAudioChannels>0);if(r.length>=1){const i=r[0];if(i.timeScale>0){const o=i.duration/i.timeScale;this.metadata.setFormat("duration",o)}const s=i.soundSampleDescription[0];if(s.description&&(this.metadata.setFormat("sampleRate",s.description.sampleRate),this.metadata.setFormat("bitsPerSample",s.description.sampleSize),this.metadata.setFormat("numberOfChannels",s.description.numAudioChannels),i.timeScale===0&&i.timeToSampleTable.length>0)){const l=i.timeToSampleTable.map(u=>u.count*u.duration).reduce((u,d)=>u+d)/s.description.sampleRate;this.metadata.setFormat("duration",l)}const a=hS[s.dataFormat];a&&this.metadata.setFormat("lossless",!a.lossy),this.calculateBitRate()}}async handleAtom(e,n){if(e.parent)switch(e.parent.header.name){case"ilst":case"<id>":return this.parseMetadataItemData(e)}if(this.atomParsers[e.header.name])return this.atomParsers[e.header.name](n);lr(`No parser for atom path=${e.atomPath}, payload-len=${n}, ignoring atom`),await this.tokenizer.ignore(n)}getTrackDescription(){return this.tracks[this.tracks.length-1]}calculateBitRate(){this.audioLengthInBytes&&this.metadata.format.duration&&this.metadata.setFormat("bitrate",8*this.audioLengthInBytes/this.metadata.format.duration)}async addTag(e,n){await this.metadata.addTag(aW,e,n)}addWarning(e){lr(`Warning: ${e}`),this.metadata.addWarning(e)}parseMetadataItemData(e){let n=e.header.name;return e.readAtoms(this.tokenizer,async(r,i)=>{const s=r.getPayloadLength(i);switch(r.header.name){case"data":return this.parseValueAtom(n,r);case"name":case"mean":case"rate":{const a=await this.tokenizer.readToken(new GH(s));n+=`:${a.name}`;break}default:{const a=await this.tokenizer.readToken(new en(s));this.addWarning(`Unsupported meta-item: ${n}[${r.header.name}] => value=${W1(a)} ascii=${H1(a,"ascii")}`)}}},e.getPayloadLength(0))}async parseValueAtom(e,n){const r=await this.tokenizer.readToken(new qH(Number(n.header.length)-gh.len));if(r.type.set!==0)throw new Error(`Unsupported type-set != 0: ${r.type.set}`);switch(r.type.type){case 0:switch(e){case"trkn":case"disk":{const i=ie.get(r.value,3),s=ie.get(r.value,5);await this.addTag(e,`${i}/${s}`);break}case"gnre":{const i=ie.get(r.value,1),s=mh[i-1];await this.addTag(e,s);break}case"rate":{const i=new TextDecoder("ascii").decode(r.value);await this.addTag(e,i);break}default:lr(`unknown proprietary value type for: ${n.atomPath}`)}break;case 1:case 18:await this.addTag(e,new TextDecoder("utf-8").decode(r.value));break;case 13:if(this.options.skipCovers)break;await this.addTag(e,{format:"image/jpeg",data:Uint8Array.from(r.value)});break;case 14:if(this.options.skipCovers)break;await this.addTag(e,{format:"image/png",data:Uint8Array.from(r.value)});break;case 21:await this.addTag(e,vh.read_BE_Integer(r.value,!0));break;case 22:await this.addTag(e,vh.read_BE_Integer(r.value,!1));break;case 65:await this.addTag(e,ie.get(r.value,0));break;case 66:await this.addTag(e,_e.get(r.value,0));break;case 67:await this.addTag(e,X.get(r.value,0));break;default:this.addWarning(`atom key=${e}, has unknown well-known-type (data-type): ${r.type.type}`)}}parseSoundSampleDescription(e){const n={dataFormat:e.dataFormat,dataReferenceIndex:e.dataReferenceIndex};let r=0;const i=dS.get(e.description,r);return r+=dS.len,i.version===0||i.version===1?n.description=YH.get(e.description,r):lr(`Warning: sound-sample-description ${i} not implemented`),n}async parseChapterTrack(e,n,r){if(!e.sampleSize&&e.chunkOffsetTable.length!==e.sampleSizeTable.length)throw new Error("Expected equal chunk-offset-table & sample-size-table length.");const i=[];for(let s=0;s<e.chunkOffsetTable.length&&r>0;++s){const o=e.chunkOffsetTable[s]-this.tokenizer.position,l=e.sampleSize>0?e.sampleSize:e.sampleSizeTable[s];if(r-=o+l,r<0)throw new Error("Chapter chunk exceeding token length");await this.tokenizer.ignore(o);const u=await this.tokenizer.readToken(new iW(l));lr(`Chapter ${s+1}: ${u}`);const d={title:u,sampleOffset:this.findSampleOffset(n,this.tokenizer.position)};lr(`Chapter title=${d.title}, offset=${d.sampleOffset}/${this.tracks[0].duration}`),i.push(d)}this.metadata.setFormat("chapters",i),await this.tokenizer.ignore(r)}findSampleOffset(e,n){let r=0;e.timeToSampleTable.forEach(s=>{r+=s.count*s.duration}),lr(`Total duration=${r}`);let i=0;for(;i<e.chunkOffsetTable.length&&e.chunkOffsetTable[i]<n;)++i;return this.getChunkDuration(i+1,e)}getChunkDuration(e,n){let r=0,i=n.timeToSampleTable[r].count,s=n.timeToSampleTable[r].duration,a=1,o=this.getSamplesPerChunk(a,n.sampleToChunkTable),l=0;for(;a<e;){const u=Math.min(i,o);l+=u*s,i-=u,o-=u,o===0?(++a,o=this.getSamplesPerChunk(a,n.sampleToChunkTable)):(++r,i=n.timeToSampleTable[r].count,s=n.timeToSampleTable[r].duration)}return l}getSamplesPerChunk(e,n){for(let r=0;r<n.length-1;++r)if(e>=n[r].firstChunk&&e<n[r+1].firstChunk)return n[r].samplesPerChunk;return n[n.length-1].samplesPerChunk}}var mS;(function(t){t[t.not_set=0]="not_set",t[t.radio=1]="radio",t[t.audiophile=2]="audiophile"})(mS||(mS={}));var pS;(function(t){t[t.unspecified=0]="unspecified",t[t.engineer=1]="engineer",t[t.user=2]="user",t[t.automatic=3]="automatic",t[t.rms_average=4]="rms_average"})(pS||(pS={}));const gS={len:2,get:(t,e)=>{const n=de(t,e,0,3),r=de(t,e,6,1),i=de(t,e,7,9)/10;if(n>0)return{type:de(t,e,0,3),origin:de(t,e,3,3),adjustment:r?-i:i}}},oW={len:27,get:(t,e)=>{const n=X.get(t,e+2);return{revision:de(t,e,0,4),vbr_method:de(t,e,4,4),lowpass_filter:100*ie.get(t,e+1),track_peak:n===0?null:n/2**23,track_gain:gS.get(t,6),album_gain:gS.get(t,8),music_length:X.get(t,e+20),music_crc:ie.get(t,e+24),header_crc:_e.get(t,e+24)}}},yS=new Q(4,"ascii"),Rp=new Q(6,"ascii"),lW={len:4,get:(t,e)=>({frames:pn(t,e,31),bytes:pn(t,e,30),toc:pn(t,e,29),vbrScale:pn(t,e,28)})};async function cW(t){const e=await t.readToken(lW),n={numFrames:null,streamSize:null,vbrScale:null};if(e.frames&&(n.numFrames=await t.readToken(X)),e.bytes&&(n.streamSize=await t.readToken(X)),e.toc&&(n.toc=new Uint8Array(100),await t.readBuffer(n.toc)),e.vbrScale&&(n.vbrScale=await t.readToken(X)),await t.peekToken(new Q(4,"ascii"))==="LAME"){await t.ignore(4),n.lame={version:await t.readToken(new Q(5,"ascii"))};const i=n.lame.version.match(/\d+.\d+/g);if(i!==null){const a=i[0].split(".").map(o=>Number.parseInt(o,10));a[0]>=3&&a[1]>=90&&(n.lame.extended=await t.readToken(oW))}}return n}const hn=ke("music-metadata:parser:mpeg"),vS=1024,xS={AudioObjectTypes:["AAC Main","AAC LC","AAC SSR","AAC LTP"],SamplingFrequencies:[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350,null,null,-1]},uW=[void 0,["front-center"],["front-left","front-right"],["front-center","front-left","front-right"],["front-center","front-left","front-right","back-center"],["front-center","front-left","front-right","back-left","back-right"],["front-center","front-left","front-right","back-left","back-right","LFE-channel"],["front-center","front-left","front-right","side-left","side-right","back-left","back-right","LFE-channel"]];class ht{constructor(e,n){this.bitrateIndex=null,this.sampRateFreqIndex=null,this.padding=null,this.privateBit=null,this.channelModeIndex=null,this.modeExtension=null,this.isOriginalMedia=null,this.version=null,this.bitrate=null,this.samplingRate=null,this.frameLength=0,this.versionIndex=de(e,n+1,3,2),this.layer=ht.LayerDescription[de(e,n+1,5,2)],this.versionIndex>1&&this.layer===0?this.parseAdtsHeader(e,n):this.parseMpegHeader(e,n),this.isProtectedByCRC=!pn(e,n+1,7)}calcDuration(e){return this.samplingRate==null?null:e*this.calcSamplesPerFrame()/this.samplingRate}calcSamplesPerFrame(){return ht.samplesInFrameTable[this.version===1?0:1][this.layer]}calculateSideInfoLength(){if(this.layer!==3)return 2;if(this.channelModeIndex===3){if(this.version===1)return 17;if(this.version===2||this.version===2.5)return 9}else{if(this.version===1)return 32;if(this.version===2||this.version===2.5)return 17}return null}calcSlotSize(){return[null,4,1,1][this.layer]}parseMpegHeader(e,n){this.container="MPEG",this.bitrateIndex=de(e,n+2,0,4),this.sampRateFreqIndex=de(e,n+2,4,2),this.padding=pn(e,n+2,6),this.privateBit=pn(e,n+2,7),this.channelModeIndex=de(e,n+3,0,2),this.modeExtension=de(e,n+3,2,2),this.isCopyrighted=pn(e,n+3,4),this.isOriginalMedia=pn(e,n+3,5),this.emphasis=de(e,n+3,7,2),this.version=ht.VersionID[this.versionIndex],this.channelMode=ht.ChannelMode[this.channelModeIndex],this.codec=`MPEG ${this.version} Layer ${this.layer}`;const r=this.calcBitrate();if(!r)throw new Error("Cannot determine bit-rate");if(this.bitrate=r*1e3,this.samplingRate=this.calcSamplingRate(),this.samplingRate==null)throw new Error("Cannot determine sampling-rate")}parseAdtsHeader(e,n){hn("layer=0 => ADTS"),this.version=this.versionIndex===2?4:2,this.container=`ADTS/MPEG-${this.version}`;const r=de(e,n+2,0,2);this.codec="AAC",this.codecProfile=xS.AudioObjectTypes[r],hn(`MPEG-4 audio-codec=${this.codec}`);const i=de(e,n+2,2,4);this.samplingRate=xS.SamplingFrequencies[i],hn(`sampling-rate=${this.samplingRate}`);const s=de(e,n+2,7,3);this.mp4ChannelConfig=uW[s],hn(`channel-config=${this.mp4ChannelConfig?this.mp4ChannelConfig.join("+"):"?"}`),this.frameLength=de(e,n+3,6,2)<<11}calcBitrate(){if(this.bitrateIndex===0||this.bitrateIndex===15)return null;if(this.version&&this.bitrateIndex){const e=10*Math.floor(this.version)+this.layer;return ht.bitrate_index[this.bitrateIndex][e]}return null}calcSamplingRate(){return this.sampRateFreqIndex===3||this.version===null||this.sampRateFreqIndex==null?null:ht.sampling_rate_freq_index[this.version][this.sampRateFreqIndex]}}ht.SyncByte1=255;ht.SyncByte2=224;ht.VersionID=[2.5,null,2,1];ht.LayerDescription=[0,3,2,1];ht.ChannelMode=["stereo","joint_stereo","dual_channel","mono"];ht.bitrate_index={1:{11:32,12:32,13:32,21:32,22:8,23:8},2:{11:64,12:48,13:40,21:48,22:16,23:16},3:{11:96,12:56,13:48,21:56,22:24,23:24},4:{11:128,12:64,13:56,21:64,22:32,23:32},5:{11:160,12:80,13:64,21:80,22:40,23:40},6:{11:192,12:96,13:80,21:96,22:48,23:48},7:{11:224,12:112,13:96,21:112,22:56,23:56},8:{11:256,12:128,13:112,21:128,22:64,23:64},9:{11:288,12:160,13:128,21:144,22:80,23:80},10:{11:320,12:192,13:160,21:160,22:96,23:96},11:{11:352,12:224,13:192,21:176,22:112,23:112},12:{11:384,12:256,13:224,21:192,22:128,23:128},13:{11:416,12:320,13:256,21:224,22:144,23:144},14:{11:448,12:384,13:320,21:256,22:160,23:160}};ht.sampling_rate_freq_index={1:{0:44100,1:48e3,2:32e3},2:{0:22050,1:24e3,2:16e3},2.5:{0:11025,1:12e3,2:8e3}};ht.samplesInFrameTable=[[0,384,1152,1152],[0,384,1152,576]];const wS={len:4,get:(t,e)=>new ht(t,e)};function dW(t){return`V${Math.floor((100-t)/10)}`}class hW extends lm{constructor(){super(...arguments),this.frameCount=0,this.syncFrameCount=-1,this.countSkipFrameData=0,this.totalDataLength=0,this.bitrates=[],this.offset=0,this.frame_size=0,this.crc=null,this.calculateEofDuration=!1,this.samplesPerFrame=null,this.buf_frame_header=new Uint8Array(4),this.mpegOffset=null,this.syncPeek={buf:new Uint8Array(vS),len:0}}async postId3v2Parse(){this.metadata.setFormat("lossless",!1);try{let e=!1;for(;!e;)await this.sync(),e=await this.parseCommonMpegHeader()}catch(e){if(e instanceof Ke){if(hn("End-of-stream"),this.calculateEofDuration&&this.samplesPerFrame!==null){const n=this.frameCount*this.samplesPerFrame;if(this.metadata.setFormat("numberOfSamples",n),this.metadata.format.sampleRate){const r=n/this.metadata.format.sampleRate;hn(`Calculate duration at EOF: ${r} sec.`,r),this.metadata.setFormat("duration",r)}}}else throw e}}finalize(){const e=this.metadata.format,n=!!this.metadata.native.ID3v1;if(this.mpegOffset!==null){if(e.duration&&this.tokenizer.fileInfo.size){const r=this.tokenizer.fileInfo.size-this.mpegOffset-(n?128:0);e.codecProfile&&e.codecProfile[0]==="V"&&this.metadata.setFormat("bitrate",r*8/e.duration)}else if(this.tokenizer.fileInfo.size&&e.codecProfile==="CBR"){const r=this.tokenizer.fileInfo.size-this.mpegOffset-(n?128:0);if(this.frame_size!==null&&this.samplesPerFrame!==null){const i=Math.round(r/this.frame_size)*this.samplesPerFrame;if(this.metadata.setFormat("numberOfSamples",i),e.sampleRate){const s=i/e.sampleRate;hn("Calculate CBR duration based on file size: %s",s),this.metadata.setFormat("duration",s)}}}}}async sync(){let e=!1;for(;;){let n=0;if(this.syncPeek.len=await this.tokenizer.peekBuffer(this.syncPeek.buf,{length:vS,mayBeLess:!0}),this.syncPeek.len<=163)throw new Ke;for(;;){if(e&&(this.syncPeek.buf[n]&224)===224){this.buf_frame_header[0]=ht.SyncByte1,this.buf_frame_header[1]=this.syncPeek.buf[n],await this.tokenizer.ignore(n),hn(`Sync at offset=${this.tokenizer.position-1}, frameCount=${this.frameCount}`),this.syncFrameCount===this.frameCount&&(hn(`Re-synced MPEG stream, frameCount=${this.frameCount}`),this.frameCount=0,this.frame_size=0),this.syncFrameCount=this.frameCount;return}if(e=!1,n=this.syncPeek.buf.indexOf(ht.SyncByte1,n),n===-1){if(this.syncPeek.len<this.syncPeek.buf.length)throw new Ke;await this.tokenizer.ignore(this.syncPeek.len);break}++n,e=!0}}}async parseCommonMpegHeader(){this.frameCount===0&&(this.mpegOffset=this.tokenizer.position-1),await this.tokenizer.peekBuffer(this.buf_frame_header,{offset:1,length:3});let e;try{e=wS.get(this.buf_frame_header,0)}catch(n){if(await this.tokenizer.ignore(1),n instanceof Error)return this.metadata.addWarning(`Parse error: ${n.message}`),!1;throw n}return await this.tokenizer.ignore(3),this.metadata.setFormat("container",e.container),this.metadata.setFormat("codec",e.codec),this.metadata.setFormat("lossless",!1),this.metadata.setFormat("sampleRate",e.samplingRate),this.frameCount++,e.version!==null&&e.version>=2&&e.layer===0?this.parseAdts(e):this.parseAudioFrameHeader(e)}async parseAudioFrameHeader(e){this.metadata.setFormat("numberOfChannels",e.channelMode==="mono"?1:2),this.metadata.setFormat("bitrate",e.bitrate),this.frameCount<20*1e4&&hn("offset=%s MP%s bitrate=%s sample-rate=%s",this.tokenizer.position-4,e.layer,e.bitrate,e.samplingRate);const n=e.calcSlotSize();if(n===null)throw new Error("invalid slot_size");const r=e.calcSamplesPerFrame();hn(`samples_per_frame=${r}`);const i=r/8;if(e.bitrate!==null&&e.samplingRate!=null){const s=i*e.bitrate/e.samplingRate+(e.padding?n:0);this.frame_size=Math.floor(s)}if(this.audioFrameHeader=e,e.bitrate!==null&&this.bitrates.push(e.bitrate),this.frameCount===1)return this.offset=wS.len,await this.skipSideInformation(),!1;if(this.frameCount===3){if(this.areAllSame(this.bitrates)){if(this.samplesPerFrame=r,this.metadata.setFormat("codecProfile","CBR"),this.tokenizer.fileInfo.size)return!0}else if(this.metadata.format.duration)return!0;if(!this.options.duration)return!0}return this.options.duration&&this.frameCount===4&&(this.samplesPerFrame=r,this.calculateEofDuration=!0),this.offset=4,e.isProtectedByCRC?(await this.parseCrc(),!1):(await this.skipSideInformation(),!1)}async parseAdts(e){const n=new Uint8Array(3);if(await this.tokenizer.readBuffer(n),e.frameLength+=de(n,0,0,11),this.totalDataLength+=e.frameLength,this.samplesPerFrame=1024,e.samplingRate!==null){const r=e.samplingRate/this.samplesPerFrame,s=8*(this.frameCount===0?0:this.totalDataLength/this.frameCount)*r+.5;this.metadata.setFormat("bitrate",s),hn(`frame-count=${this.frameCount}, size=${e.frameLength} bytes, bit-rate=${s}`)}if(await this.tokenizer.ignore(e.frameLength>7?e.frameLength-7:1),this.frameCount===3)if(this.metadata.setFormat("codecProfile",e.codecProfile),e.mp4ChannelConfig&&this.metadata.setFormat("numberOfChannels",e.mp4ChannelConfig.length),this.options.duration)this.calculateEofDuration=!0;else return!0;return!1}async parseCrc(){return this.crc=await this.tokenizer.readNumber(qr),this.offset+=2,this.skipSideInformation()}async skipSideInformation(){if(this.audioFrameHeader){const e=this.audioFrameHeader.calculateSideInfoLength();if(e!==null){await this.tokenizer.readToken(new en(e)),this.offset+=e,await this.readXtraInfoHeader();return}}}async readXtraInfoHeader(){const e=await this.tokenizer.readToken(yS);switch(this.offset+=yS.len,e){case"Info":return this.metadata.setFormat("codecProfile","CBR"),this.readXingInfoHeader();case"Xing":{const r=await this.readXingInfoHeader();if(r.vbrScale!==null){const i=dW(r.vbrScale);this.metadata.setFormat("codecProfile",i)}return null}case"Xtra":break;case"LAME":{const r=await this.tokenizer.readToken(Rp);if(this.frame_size!==null&&this.frame_size>=this.offset+Rp.len)return this.offset+=Rp.len,this.metadata.setFormat("tool",`LAME ${r}`),await this.skipFrameData(this.frame_size-this.offset),null;this.metadata.addWarning("Corrupt LAME header");break}}const n=this.frame_size-this.offset;return n<0?this.metadata.addWarning(`Frame ${this.frameCount}corrupt: negative frameDataLeft`):await this.skipFrameData(n),null}async readXingInfoHeader(){const e=this.tokenizer.position,n=await cW(this.tokenizer);if(this.offset+=this.tokenizer.position-e,n.lame&&(this.metadata.setFormat("tool",`LAME ${ki(n.lame.version)}`),n.lame.extended&&(this.metadata.setFormat("trackPeakLevel",n.lame.extended.track_peak),n.lame.extended.track_gain&&this.metadata.setFormat("trackGain",n.lame.extended.track_gain.adjustment),n.lame.extended.album_gain&&this.metadata.setFormat("albumGain",n.lame.extended.album_gain.adjustment),this.metadata.setFormat("duration",n.lame.extended.music_length/1e3))),n.streamSize&&this.audioFrameHeader&&n.numFrames!==null){const i=this.audioFrameHeader.calcDuration(n.numFrames);return this.metadata.setFormat("duration",i),hn("Get duration from Xing header: %s",this.metadata.format.duration),n}const r=this.frame_size-this.offset;return await this.skipFrameData(r),n}async skipFrameData(e){if(e<0)throw new Error("frame-data-left cannot be negative");await this.tokenizer.ignore(e),this.countSkipFrameData+=e}areAllSame(e){const n=e[0];return e.every(r=>r===n)}}const _S=ke("music-metadata:parser:musepack:sv8"),fW=new Q(2,"latin1"),ES={len:5,get:(t,e)=>({crc:q.get(t,e),streamVersion:ie.get(t,e+4)})},SS={len:2,get:(t,e)=>({sampleFrequency:[44100,48e3,37800,32e3][de(t,e,0,3)],maxUsedBands:de(t,e,3,5),channelCount:de(t,e+1,0,4)+1,msUsed:pn(t,e+1,4),audioBlockFrames:de(t,e+1,5,3)})};class mW{constructor(e){this.tokenizer=e}async readPacketHeader(){const e=await this.tokenizer.readToken(fW),n=await this.readVariableSizeField();return{key:e,payloadLength:n.value-2-n.len}}async readStreamHeader(e){const n={};_S(`Reading SH at offset=${this.tokenizer.position}`);const r=await this.tokenizer.readToken(ES);e-=ES.len,Object.assign(n,r),_S(`SH.streamVersion = ${r.streamVersion}`);const i=await this.readVariableSizeField();e-=i.len,n.sampleCount=i.value;const s=await this.readVariableSizeField();e-=s.len,n.beginningOfSilence=s.value;const a=await this.tokenizer.readToken(SS);return e-=SS.len,Object.assign(n,a),await this.tokenizer.ignore(e),n}async readVariableSizeField(e=1,n=0){let r=await this.tokenizer.readNumber(ie);return r&128?(r&=127,r+=n,this.readVariableSizeField(e+1,r<<7)):{len:e,value:n+r}}}const pW=ke("music-metadata:parser:musepack");class gW extends Cn{constructor(){super(...arguments),this.audioLength=0}async parse(){if(await this.tokenizer.readToken(Ne)!=="MPCK")throw new Error("Invalid Magic number");return this.metadata.setFormat("container","Musepack, SV8"),this.parsePacket()}async parsePacket(){const e=new mW(this.tokenizer);do{const n=await e.readPacketHeader();switch(pW(`packet-header key=${n.key}, payloadLength=${n.payloadLength}`),n.key){case"SH":{const r=await e.readStreamHeader(n.payloadLength);this.metadata.setFormat("numberOfSamples",r.sampleCount),this.metadata.setFormat("sampleRate",r.sampleFrequency),this.metadata.setFormat("duration",r.sampleCount/r.sampleFrequency),this.metadata.setFormat("numberOfChannels",r.channelCount);break}case"AP":this.audioLength+=n.payloadLength,await this.tokenizer.ignore(n.payloadLength);break;case"RG":case"EI":case"SO":case"ST":case"CT":await this.tokenizer.ignore(n.payloadLength);break;case"SE":return this.metadata.format.duration&&this.metadata.setFormat("bitrate",this.audioLength*8/this.metadata.format.duration),vr.tryParseApeHeader(this.metadata,this.tokenizer,this.options);default:throw new Error(`Unexpected header: ${n.key}`)}}while(!0)}}class yW{constructor(e){this.tokenizer=e,this.pos=0,this.dword=null}async read(e){for(;this.dword===null;)this.dword=await this.tokenizer.readToken(q);let n=this.dword;return this.pos+=e,this.pos<32?(n>>>=32-this.pos,n&(1<<e)-1):(this.pos-=32,this.pos===0?(this.dword=null,n&(1<<e)-1):(this.dword=await this.tokenizer.readToken(q),this.pos&&(n<<=this.pos,n|=this.dword>>>32-this.pos),n&(1<<e)-1))}async ignore(e){if(this.pos>0){const i=32-this.pos;this.dword=null,e-=i,this.pos=0}const n=e%32,r=(e-n)/32;return await this.tokenizer.ignore(r*4),this.read(n)}}const vW={len:6*4,get:(t,e)=>{const n={signature:new TextDecoder("latin1").decode(t.subarray(e,e+3)),streamMinorVersion:de(t,e+3,0,4),streamMajorVersion:de(t,e+3,4,4),frameCount:q.get(t,e+4),maxLevel:ye.get(t,e+8),sampleFrequency:[44100,48e3,37800,32e3][de(t,e+10,0,2)],link:de(t,e+10,2,2),profile:de(t,e+10,4,4),maxBand:de(t,e+11,0,6),intensityStereo:pn(t,e+11,6),midSideStereo:pn(t,e+11,7),titlePeak:ye.get(t,e+12),titleGain:ye.get(t,e+14),albumPeak:ye.get(t,e+16),albumGain:ye.get(t,e+18),lastFrameLength:q.get(t,e+20)>>>20&2047,trueGapless:pn(t,e+23,0)};return n.lastFrameLength=n.trueGapless?q.get(t,20)>>>20&2047:0,n}},kS=ke("music-metadata:parser:musepack");class xW extends Cn{constructor(){super(...arguments),this.bitreader=null,this.audioLength=0,this.duration=null}async parse(){const e=await this.tokenizer.readToken(vW);if(e.signature!=="MP+")throw new Error("Unexpected magic number");kS(`stream-version=${e.streamMajorVersion}.${e.streamMinorVersion}`),this.metadata.setFormat("container","Musepack, SV7"),this.metadata.setFormat("sampleRate",e.sampleFrequency);const n=1152*(e.frameCount-1)+e.lastFrameLength;this.metadata.setFormat("numberOfSamples",n),this.duration=n/e.sampleFrequency,this.metadata.setFormat("duration",this.duration),this.bitreader=new yW(this.tokenizer),this.metadata.setFormat("numberOfChannels",e.midSideStereo||e.intensityStereo?2:1);const r=await this.bitreader.read(8);return this.metadata.setFormat("codec",(r/100).toFixed(2)),await this.skipAudioData(e.frameCount),kS(`End of audio stream, switching to APEv2, offset=${this.tokenizer.position}`),vr.tryParseApeHeader(this.metadata,this.tokenizer,this.options)}async skipAudioData(e){for(;e-- >0;){const r=await this.bitreader.read(20);this.audioLength+=20+r,await this.bitreader.ignore(r)}const n=await this.bitreader.read(11);this.audioLength+=n,this.duration!==null&&this.metadata.setFormat("bitrate",this.audioLength/this.duration)}}const bS=ke("music-metadata:parser:musepack");class wW extends lm{async postId3v2Parse(){const e=await this.tokenizer.peekToken(new Q(3,"latin1"));let n;switch(e){case"MP+":{bS("Musepack stream-version 7"),n=new xW;break}case"MPC":{bS("Musepack stream-version 8"),n=new gW;break}default:throw new Error("Invalid Musepack signature prefix")}return n.init(this.metadata,this.tokenizer,this.options),n.parse()}}class _W{constructor(e){if(this.len=e,e<19)throw new Error("ID-header-page 0 should be at least 19 bytes long")}get(e,n){return{magicSignature:new Q(8,"ascii").get(e,n+0),version:ie.get(e,n+8),channelCount:ie.get(e,n+9),preSkip:ye.get(e,n+10),inputSampleRate:q.get(e,n+12),outputGain:ye.get(e,n+16),channelMapping:ie.get(e,n+18)}}}class EW extends Ws{constructor(e,n,r){super(e,n),this.tokenizer=r,this.idHeader=null,this.lastPos=-1}parseFirstPage(e,n){if(this.metadata.setFormat("codec","Opus"),this.idHeader=new _W(n.length).get(n,0),this.idHeader.magicSignature!=="OpusHead")throw new Error("Illegal ogg/Opus magic-signature");this.metadata.setFormat("sampleRate",this.idHeader.inputSampleRate),this.metadata.setFormat("numberOfChannels",this.idHeader.channelCount)}async parseFullPage(e){switch(new Q(8,"ascii").get(e,0)){case"OpusTags":await this.parseUserCommentList(e,8),this.lastPos=this.tokenizer.position-e.length;break}}calculateDuration(e){if(this.metadata.format.sampleRate&&e.absoluteGranulePosition>=0){const n=e.absoluteGranulePosition-this.idHeader.preSkip;if(this.metadata.setFormat("numberOfSamples",n),this.metadata.setFormat("duration",n/48e3),this.lastPos!==-1&&this.tokenizer.fileInfo.size&&this.metadata.format.duration){const r=this.tokenizer.fileInfo.size-this.lastPos;this.metadata.setFormat("bitrate",8*r/this.metadata.format.duration)}}}}const SW={len:80,get:(t,e)=>({speex:new Q(8,"ascii").get(t,e+0),version:jR(new Q(20,"ascii").get(t,e+8)),version_id:qe.get(t,e+28),header_size:qe.get(t,e+32),rate:qe.get(t,e+36),mode:qe.get(t,e+40),mode_bitstream_version:qe.get(t,e+44),nb_channels:qe.get(t,e+48),bitrate:qe.get(t,e+52),frame_size:qe.get(t,e+56),vbr:qe.get(t,e+60),frames_per_packet:qe.get(t,e+64),extra_headers:qe.get(t,e+68),reserved1:qe.get(t,e+72),reserved2:qe.get(t,e+76)})},kW=ke("music-metadata:parser:ogg:speex");class bW extends Ws{constructor(e,n,r){super(e,n),this.tokenizer=r}parseFirstPage(e,n){kW("First Ogg/Speex page");const r=SW.get(n,0);this.metadata.setFormat("codec",`Speex ${r.version}`),this.metadata.setFormat("numberOfChannels",r.nb_channels),this.metadata.setFormat("sampleRate",r.rate),r.bitrate!==-1&&this.metadata.setFormat("bitrate",r.bitrate)}}const TW={len:42,get:(t,e)=>({id:new Q(7,"ascii").get(t,e),vmaj:ie.get(t,e+7),vmin:ie.get(t,e+8),vrev:ie.get(t,e+9),vmbw:_e.get(t,e+10),vmbh:_e.get(t,e+17),nombr:Kt.get(t,e+37),nqual:ie.get(t,e+40)})},Pp=ke("music-metadata:parser:ogg:theora");class IW{constructor(e,n,r){this.metadata=e,this.tokenizer=r}async parsePage(e,n){e.headerType.firstPage&&await this.parseFirstPage(e,n)}async flush(){Pp("flush")}calculateDuration(e){Pp("duration calculation not implemented")}async parseFirstPage(e,n){Pp("First Ogg/Theora page"),this.metadata.setFormat("codec","Theora");const r=TW.get(n,0);this.metadata.setFormat("bitrate",r.nombr)}}const Mr=ke("music-metadata:parser:ogg");class J1{static sum(e,n,r){const i=new DataView(e.buffer,0);let s=0;for(let a=n;a<n+r;++a)s+=i.getUint8(a);return s}constructor(e){this.len=e.page_segments}get(e,n){return{totalPageSize:J1.sum(e,n,this.len)}}}class cm extends Cn{constructor(){super(...arguments),this.header=null,this.pageNumber=0,this.pageConsumer=null}async parse(){Mr("pos=%s, parsePage()",this.tokenizer.position);try{let e;do{if(e=await this.tokenizer.readToken(cm.Header),e.capturePattern!=="OggS")throw new Error("Invalid Ogg capture pattern");this.metadata.setFormat("container","Ogg"),this.header=e,this.pageNumber=e.pageSequenceNo,Mr("page#=%s, Ogg.id=%s",e.pageSequenceNo,e.capturePattern);const n=await this.tokenizer.readToken(new J1(e));Mr("totalPageSize=%s",n.totalPageSize);const r=await this.tokenizer.readToken(new en(n.totalPageSize));if(Mr("firstPage=%s, lastPage=%s, continued=%s",e.headerType.firstPage,e.headerType.lastPage,e.headerType.continued),e.headerType.firstPage){const i=new TextDecoder("ascii").decode(r.subarray(0,7));switch(i){case"vorbis":Mr("Set page consumer to Ogg/Vorbis"),this.pageConsumer=new Ws(this.metadata,this.options);break;case"OpusHea":Mr("Set page consumer to Ogg/Opus"),this.pageConsumer=new EW(this.metadata,this.options,this.tokenizer);break;case"Speex  ":Mr("Set page consumer to Ogg/Speex"),this.pageConsumer=new bW(this.metadata,this.options,this.tokenizer);break;case"fishead":case"\0theora":Mr("Set page consumer to Ogg/Theora"),this.pageConsumer=new IW(this.metadata,this.options,this.tokenizer);break;default:throw new Error(`gg audio-codec not recognized (id=${i})`)}}await this.pageConsumer.parsePage(e,r)}while(!e.headerType.lastPage)}catch(e){if(e instanceof Error)e instanceof Ke?(this.metadata.addWarning("Last OGG-page is not marked with last-page flag"),Mr("End-of-stream"),this.metadata.addWarning("Last OGG-page is not marked with last-page flag"),this.header&&this.pageConsumer.calculateDuration(this.header)):e.message.startsWith("FourCC")&&this.pageNumber>0&&(this.metadata.addWarning("Invalid FourCC ID, maybe last OGG-page is not marked with last-page flag"),await this.pageConsumer.flush());else throw e}}}cm.Header={len:27,get:(t,e)=>({capturePattern:Ne.get(t,e),version:ie.get(t,e+4),headerType:{continued:Ue(t,e+5,0),firstPage:Ue(t,e+5,1),lastPage:Ue(t,e+5,2)},absoluteGranulePosition:Number(Wt.get(t,e+6)),streamSerialNumber:q.get(t,e+14),pageSequenceNo:q.get(t,e+18),pageChecksum:q.get(t,e+22),page_segments:ie.get(t,e+26)})};const Qo={len:8,get:(t,e)=>({chunkID:new Q(4,"latin1").get(t,e),chunkSize:q.get(t,e+4)})};class CW{constructor(e){this.tagHeader=e,this.len=e.chunkSize,this.len+=this.len&1}get(e,n){return new Q(this.tagHeader.chunkSize,"ascii").get(e,n)}}var B0;(function(t){t[t.PCM=1]="PCM",t[t.ADPCM=2]="ADPCM",t[t.IEEE_FLOAT=3]="IEEE_FLOAT",t[t.MPEG_ADTS_AAC=5632]="MPEG_ADTS_AAC",t[t.MPEG_LOAS=5634]="MPEG_LOAS",t[t.RAW_AAC1=255]="RAW_AAC1",t[t.DOLBY_AC3_SPDIF=146]="DOLBY_AC3_SPDIF",t[t.DVM=8192]="DVM",t[t.RAW_SPORT=576]="RAW_SPORT",t[t.ESST_AC3=577]="ESST_AC3",t[t.DRM=9]="DRM",t[t.DTS2=8193]="DTS2",t[t.MPEG=80]="MPEG"})(B0||(B0={}));class AW{constructor(e){if(e.chunkSize<16)throw new Error("Invalid chunk size");this.len=e.chunkSize}get(e,n){return{wFormatTag:ye.get(e,n),nChannels:ye.get(e,n+2),nSamplesPerSec:q.get(e,n+4),nAvgBytesPerSec:q.get(e,n+8),nBlockAlign:ye.get(e,n+12),wBitsPerSample:ye.get(e,n+14)}}}class RW{constructor(e){if(e.chunkSize<4)throw new Error("Invalid fact chunk size.");this.len=e.chunkSize}get(e,n){return{dwSampleLength:q.get(e,n)}}}const TS={len:420,get:(t,e)=>({description:ki(new Q(256,"ascii").get(t,e)).trim(),originator:ki(new Q(32,"ascii").get(t,e+256)).trim(),originatorReference:ki(new Q(32,"ascii").get(t,e+288)).trim(),originationDate:ki(new Q(10,"ascii").get(t,e+320)).trim(),originationTime:ki(new Q(8,"ascii").get(t,e+330)).trim(),timeReferenceLow:q.get(t,e+338),timeReferenceHigh:q.get(t,e+342),version:ye.get(t,e+346),umid:new en(64).get(t,e+348),loudnessValue:ye.get(t,e+412),maxTruePeakLevel:ye.get(t,e+414),maxMomentaryLoudness:ye.get(t,e+416),maxShortTermLoudness:ye.get(t,e+418)})},fi=ke("music-metadata:parser:RIFF");class PW extends Cn{constructor(){super(...arguments),this.blockAlign=0}async parse(){const e=await this.tokenizer.readToken(Qo);if(fi(`pos=${this.tokenizer.position}, parse: chunkID=${e.chunkID}`),e.chunkID==="RIFF")return this.parseRiffChunk(e.chunkSize).catch(n=>{if(!(n instanceof Ke))throw n})}async parseRiffChunk(e){const n=await this.tokenizer.readToken(Ne);switch(this.metadata.setFormat("container",n),n){case"WAVE":return this.readWaveChunk(e-Ne.len);default:throw new Error(`Unsupported RIFF format: RIFF/${n}`)}}async readWaveChunk(e){for(;e>=Qo.len;){const n=await this.tokenizer.readToken(Qo);switch(e-=Qo.len+n.chunkSize,n.chunkSize>e&&this.metadata.addWarning("Data chunk size exceeds file size"),this.header=n,fi(`pos=${this.tokenizer.position}, readChunk: chunkID=RIFF/WAVE/${n.chunkID}`),n.chunkID){case"LIST":await this.parseListTag(n);break;case"fact":this.metadata.setFormat("lossless",!1),this.fact=await this.tokenizer.readToken(new RW(n));break;case"fmt ":{const r=await this.tokenizer.readToken(new AW(n));let i=B0[r.wFormatTag];i||(fi(`WAVE/non-PCM format=${r.wFormatTag}`),i=`non-PCM (${r.wFormatTag})`),this.metadata.setFormat("codec",i),this.metadata.setFormat("bitsPerSample",r.wBitsPerSample),this.metadata.setFormat("sampleRate",r.nSamplesPerSec),this.metadata.setFormat("numberOfChannels",r.nChannels),this.metadata.setFormat("bitrate",r.nBlockAlign*r.nSamplesPerSec*8),this.blockAlign=r.nBlockAlign;break}case"id3 ":case"ID3 ":{const r=await this.tokenizer.readToken(new en(n.chunkSize)),i=mo(r);await new Kn().parse(this.metadata,i,this.options);break}case"data":{this.metadata.format.lossless!==!1&&this.metadata.setFormat("lossless",!0);let r=n.chunkSize;if(this.tokenizer.fileInfo.size){const s=this.tokenizer.fileInfo.size-this.tokenizer.position;s<r&&(this.metadata.addWarning("data chunk length exceeding file length"),r=s)}const i=this.fact?this.fact.dwSampleLength:r===4294967295?void 0:r/this.blockAlign;i&&(this.metadata.setFormat("numberOfSamples",i),this.metadata.format.sampleRate&&this.metadata.setFormat("duration",i/this.metadata.format.sampleRate)),this.metadata.format.codec==="ADPCM"?this.metadata.setFormat("bitrate",352e3):this.metadata.format.sampleRate&&this.metadata.setFormat("bitrate",this.blockAlign*this.metadata.format.sampleRate*8),await this.tokenizer.ignore(n.chunkSize);break}case"bext":{const r=await this.tokenizer.readToken(TS);Object.keys(r).forEach(s=>{this.metadata.addTag("exif",`bext.${s}`,r[s])});const i=n.chunkSize-TS.len;await this.tokenizer.ignore(i);break}case"\0\0\0\0":fi(`Ignore padding chunk: RIFF/${n.chunkID} of ${n.chunkSize} bytes`),this.metadata.addWarning(`Ignore chunk: RIFF/${n.chunkID}`),await this.tokenizer.ignore(n.chunkSize);break;default:fi(`Ignore chunk: RIFF/${n.chunkID} of ${n.chunkSize} bytes`),this.metadata.addWarning(`Ignore chunk: RIFF/${n.chunkID}`),await this.tokenizer.ignore(n.chunkSize)}this.header.chunkSize%2===1&&(fi("Read odd padding byte"),await this.tokenizer.ignore(1))}}async parseListTag(e){const n=await this.tokenizer.readToken(new Q(4,"latin1"));switch(fi("pos=%s, parseListTag: chunkID=RIFF/WAVE/LIST/%s",this.tokenizer.position,n),n){case"INFO":return this.parseRiffInfoTags(e.chunkSize-4);default:return this.metadata.addWarning(`Ignore chunk: RIFF/WAVE/LIST/${n}`),fi(`Ignoring chunkID=RIFF/WAVE/LIST/${n}`),this.tokenizer.ignore(e.chunkSize-4).then()}}async parseRiffInfoTags(e){for(;e>=8;){const n=await this.tokenizer.readToken(Qo),r=new CW(n),i=await this.tokenizer.readToken(r);this.addTag(n.chunkID,ki(i)),e-=8+r.len}if(e!==0)throw new Error(`Illegal remaining size: ${e}`)}addTag(e,n){this.metadata.addTag("exif",e,n)}}const NW=[6e3,8e3,9600,11025,12e3,16e3,22050,24e3,32e3,44100,48e3,64e3,88200,96e3,192e3,-1],Ru={len:32,get:(t,e)=>{const n=q.get(t,e+24),r={BlockID:Ne.get(t,e),blockSize:q.get(t,e+4),version:ye.get(t,e+8),totalSamples:q.get(t,e+12),blockIndex:q.get(t,e+16),blockSamples:q.get(t,e+20),flags:{bitsPerSample:(1+xh(n,0,2))*8,isMono:ur(n,2),isHybrid:ur(n,3),isJointStereo:ur(n,4),crossChannel:ur(n,5),hybridNoiseShaping:ur(n,6),floatingPoint:ur(n,7),samplingRate:NW[xh(n,23,4)],isDSD:ur(n,31)},crc:new en(4).get(t,e+28)};return r.flags.isDSD&&(r.totalSamples*=8),r}},Np={len:1,get:(t,e)=>({functionId:xh(t[e],0,6),isOptional:ur(t[e],5),isOddSize:ur(t[e],6),largeBlock:ur(t[e],7)})};function ur(t,e){return xh(t,e,1)===1}function xh(t,e,n){return t>>>e&4294967295>>>32-n}const cs=ke("music-metadata:parser:WavPack");class jW extends Cn{constructor(){super(...arguments),this.audioDataSize=0}async parse(){return this.audioDataSize=0,await this.parseWavPackBlocks(),vr.tryParseApeHeader(this.metadata,this.tokenizer,this.options)}async parseWavPackBlocks(){do{if(await this.tokenizer.peekToken(Ne)!=="wvpk")break;const n=await this.tokenizer.readToken(Ru);if(n.BlockID!=="wvpk")throw new Error("Invalid WavPack Block-ID");cs(`WavPack header blockIndex=${n.blockIndex}, len=${Ru.len}`),n.blockIndex===0&&!this.metadata.format.container&&(this.metadata.setFormat("container","WavPack"),this.metadata.setFormat("lossless",!n.flags.isHybrid),this.metadata.setFormat("bitsPerSample",n.flags.bitsPerSample),n.flags.isDSD||(this.metadata.setFormat("sampleRate",n.flags.samplingRate),this.metadata.setFormat("duration",n.totalSamples/n.flags.samplingRate)),this.metadata.setFormat("numberOfChannels",n.flags.isMono?1:2),this.metadata.setFormat("numberOfSamples",n.totalSamples),this.metadata.setFormat("codec",n.flags.isDSD?"DSD":"PCM"));const r=n.blockSize-(Ru.len-8);await(n.blockIndex===0?this.parseMetadataSubBlock(n,r):this.tokenizer.ignore(r)),n.blockSamples>0&&(this.audioDataSize+=n.blockSize)}while(!this.tokenizer.fileInfo.size||this.tokenizer.fileInfo.size-this.tokenizer.position>=Ru.len);this.metadata.format.duration&&this.metadata.setFormat("bitrate",this.audioDataSize*8/this.metadata.format.duration)}async parseMetadataSubBlock(e,n){let r=n;for(;r>Np.len;){const i=await this.tokenizer.readToken(Np),s=await this.tokenizer.readNumber(i.largeBlock?uh:ie),a=new Uint8Array(s*2-(i.isOddSize?1:0));switch(await this.tokenizer.readBuffer(a),cs(`Metadata Sub-Blocks functionId=0x${i.functionId.toString(16)}, id.largeBlock=${i.largeBlock},data-size=${a.length}`),i.functionId){case 0:break;case 14:{cs("ID_DSD_BLOCK");const o=1<<ie.get(a,0),l=e.flags.samplingRate*o*8;if(!e.flags.isDSD)throw new Error("Only expect DSD block if DSD-flag is set");this.metadata.setFormat("sampleRate",l),this.metadata.setFormat("duration",e.totalSamples/l);break}case 36:cs("ID_ALT_TRAILER: trailer for non-wav files");break;case 38:this.metadata.setFormat("audioMD5",a);break;case 47:cs(`ID_BLOCK_CHECKSUM: checksum=${W1(a)}`);break;default:cs(`Ignore unsupported meta-sub-block-id functionId=0x${i.functionId.toString(16)}`);break}r-=Np.len+(i.largeBlock?uh.len:ie.len)+s*2,cs(`remainingLength=${r}`),i.isOddSize&&this.tokenizer.ignore(1)}if(r!==0)throw new Error("metadata-sub-block should fit it remaining length")}}const Pu={len:12,get:(t,e)=>({id:Ne.get(t,e),size:Wt.get(t,e+4)})},OW={len:16,get:(t,e)=>({fileSize:dh.get(t,e),metadataPointer:dh.get(t,e+8)})};var IS;(function(t){t[t.mono=1]="mono",t[t.stereo=2]="stereo",t[t.channels=3]="channels",t[t.quad=4]="quad",t[t["4 channels"]=5]="4 channels",t[t["5 channels"]=6]="5 channels",t[t["5.1 channels"]=7]="5.1 channels"})(IS||(IS={}));const DW={len:40,get:(t,e)=>({formatVersion:qe.get(t,e),formatID:qe.get(t,e+4),channelType:qe.get(t,e+8),channelNum:qe.get(t,e+12),samplingFrequency:qe.get(t,e+16),bitsPerSample:qe.get(t,e+20),sampleCount:dh.get(t,e+24),blockSizePerChannel:qe.get(t,e+32)})},jp=ke("music-metadata:parser:DSF");class MW extends lm{async postId3v2Parse(){const e=this.tokenizer.position,n=await this.tokenizer.readToken(Pu);if(n.id!=="DSD ")throw new Error("Invalid chunk signature");this.metadata.setFormat("container","DSF"),this.metadata.setFormat("lossless",!0);const r=await this.tokenizer.readToken(OW);if(r.metadataPointer===BigInt(0))jp("No ID3v2 tag present");else return jp(`expect ID3v2 at offset=${r.metadataPointer}`),await this.parseChunks(r.fileSize-n.size),await this.tokenizer.ignore(Number(r.metadataPointer)-this.tokenizer.position-e),new Kn().parse(this.metadata,this.tokenizer,this.options)}async parseChunks(e){for(;e>=Pu.len;){const n=await this.tokenizer.readToken(Pu);switch(jp(`Parsing chunk name=${n.id} size=${n.size}`),n.id){case"fmt ":{const r=await this.tokenizer.readToken(DW);this.metadata.setFormat("numberOfChannels",r.channelNum),this.metadata.setFormat("sampleRate",r.samplingFrequency),this.metadata.setFormat("bitsPerSample",r.bitsPerSample),this.metadata.setFormat("numberOfSamples",r.sampleCount),this.metadata.setFormat("duration",Number(r.sampleCount)/r.samplingFrequency);const i=r.bitsPerSample*r.samplingFrequency*r.channelNum;this.metadata.setFormat("bitrate",i);return}default:this.tokenizer.ignore(Number(n.size)-Pu.len);break}e-=n.size}}}const ua={len:12,get:(t,e)=>({chunkID:Ne.get(t,e),chunkSize:kR.get(t,e+4)})},Vt=ke("music-metadata:parser:aiff");class LW extends Cn{async parse(){const e=await this.tokenizer.readToken(ua);if(e.chunkID!=="FRM8")throw new Error("Unexpected chunk-ID");const n=(await this.tokenizer.readToken(Ne)).trim();switch(n){case"DSD":return this.metadata.setFormat("container",`DSDIFF/${n}`),this.metadata.setFormat("lossless",!0),this.readFmt8Chunks(e.chunkSize-BigInt(Ne.len));default:throw new Error(`Unsupported DSDIFF type: ${n}`)}}async readFmt8Chunks(e){for(;e>=ua.len;){const n=await this.tokenizer.readToken(ua);Vt(`Chunk id=${n.chunkID}`),await this.readData(n),e-=BigInt(ua.len)+n.chunkSize}}async readData(e){Vt(`Reading data of chunk[ID=${e.chunkID}, size=${e.chunkSize}]`);const n=this.tokenizer.position;switch(e.chunkID.trim()){case"FVER":{const i=await this.tokenizer.readToken(q);Vt(`DSDIFF version=${i}`);break}case"PROP":{if(await this.tokenizer.readToken(Ne)!=="SND ")throw new Error("Unexpected PROP-chunk ID");await this.handleSoundPropertyChunks(e.chunkSize-BigInt(Ne.len));break}case"ID3":{const i=await this.tokenizer.readToken(new en(Number(e.chunkSize))),s=mo(i);await new Kn().parse(this.metadata,s,this.options);break}case"DSD":this.metadata.format.numberOfChannels&&this.metadata.setFormat("numberOfSamples",Number(e.chunkSize*BigInt(8)/BigInt(this.metadata.format.numberOfChannels))),this.metadata.format.numberOfSamples&&this.metadata.format.sampleRate&&this.metadata.setFormat("duration",this.metadata.format.numberOfSamples/this.metadata.format.sampleRate);break;default:Vt(`Ignore chunk[ID=${e.chunkID}, size=${e.chunkSize}]`);break}const r=e.chunkSize-BigInt(this.tokenizer.position-n);r>0&&(Vt(`After Parsing chunk, remaining ${r} bytes`),await this.tokenizer.ignore(Number(r)))}async handleSoundPropertyChunks(e){for(Vt(`Parsing sound-property-chunks, remainingSize=${e}`);e>0;){const n=await this.tokenizer.readToken(ua);Vt(`Sound-property-chunk[ID=${n.chunkID}, size=${n.chunkSize}]`);const r=this.tokenizer.position;switch(n.chunkID.trim()){case"FS":{const s=await this.tokenizer.readToken(X);this.metadata.setFormat("sampleRate",s);break}case"CHNL":{const s=await this.tokenizer.readToken(_e);this.metadata.setFormat("numberOfChannels",s),await this.handleChannelChunks(n.chunkSize-BigInt(_e.len));break}case"CMPR":{const s=(await this.tokenizer.readToken(Ne)).trim(),a=await this.tokenizer.readToken(ie),o=await this.tokenizer.readToken(new Q(a,"ascii"));s==="DSD"&&(this.metadata.setFormat("lossless",!0),this.metadata.setFormat("bitsPerSample",1)),this.metadata.setFormat("codec",`${s} (${o})`);break}case"ABSS":{const s=await this.tokenizer.readToken(_e),a=await this.tokenizer.readToken(ie),o=await this.tokenizer.readToken(ie),l=await this.tokenizer.readToken(X);Vt(`ABSS ${s}:${a}:${o}.${l}`);break}case"LSCO":{const s=await this.tokenizer.readToken(_e);Vt(`LSCO lsConfig=${s}`);break}default:Vt(`Unknown sound-property-chunk[ID=${n.chunkID}, size=${n.chunkSize}]`),await this.tokenizer.ignore(Number(n.chunkSize))}const i=n.chunkSize-BigInt(this.tokenizer.position-r);i>0&&(Vt(`After Parsing sound-property-chunk ${n.chunkSize}, remaining ${i} bytes`),await this.tokenizer.ignore(Number(i))),e-=BigInt(ua.len)+n.chunkSize,Vt(`Parsing sound-property-chunks, remainingSize=${e}`)}if(this.metadata.format.lossless&&this.metadata.format.sampleRate&&this.metadata.format.numberOfChannels&&this.metadata.format.bitsPerSample){const n=this.metadata.format.sampleRate*this.metadata.format.numberOfChannels*this.metadata.format.bitsPerSample;this.metadata.setFormat("bitrate",n)}}async handleChannelChunks(e){Vt(`Parsing channel-chunks, remainingSize=${e}`);const n=[];for(;e>=Ne.len;){const r=await this.tokenizer.readToken(Ne);Vt(`Channel[ID=${r}]`),n.push(r),e-=BigInt(Ne.len)}return Vt(`Channels: ${n.join(", ")}`),n}}var C;(function(t){t[t.string=0]="string",t[t.uint=1]="uint",t[t.uid=2]="uid",t[t.bool=3]="bool",t[t.binary=4]="binary",t[t.float=5]="float"})(C||(C={}));const FW={name:"dtd",container:{440786851:{name:"ebml",container:{17030:{name:"ebmlVersion",value:C.uint},17143:{name:"ebmlReadVersion",value:C.uint},17138:{name:"ebmlMaxIDWidth",value:C.uint},17139:{name:"ebmlMaxSizeWidth",value:C.uint},17026:{name:"docType",value:C.string},17031:{name:"docTypeVersion",value:C.uint},17029:{name:"docTypeReadVersion",value:C.uint}}},408125543:{name:"segment",container:{290298740:{name:"seekHead",container:{19899:{name:"seek",multiple:!0,container:{21419:{name:"id",value:C.binary},21420:{name:"position",value:C.uint}}}}},357149030:{name:"info",container:{29604:{name:"uid",value:C.uid},29572:{name:"filename",value:C.string},3979555:{name:"prevUID",value:C.uid},3965867:{name:"prevFilename",value:C.string},4110627:{name:"nextUID",value:C.uid},4096955:{name:"nextFilename",value:C.string},2807729:{name:"timecodeScale",value:C.uint},17545:{name:"duration",value:C.float},17505:{name:"dateUTC",value:C.uint},31657:{name:"title",value:C.string},19840:{name:"muxingApp",value:C.string},22337:{name:"writingApp",value:C.string}}},524531317:{name:"cluster",multiple:!0,container:{231:{name:"timecode",value:C.uid},22743:{name:"silentTracks ",multiple:!0},167:{name:"position",value:C.uid},171:{name:"prevSize",value:C.uid},160:{name:"blockGroup"},163:{name:"simpleBlock"}}},374648427:{name:"tracks",container:{174:{name:"entries",multiple:!0,container:{215:{name:"trackNumber",value:C.uint},29637:{name:"uid",value:C.uid},131:{name:"trackType",value:C.uint},185:{name:"flagEnabled",value:C.bool},136:{name:"flagDefault",value:C.bool},21930:{name:"flagForced",value:C.bool},156:{name:"flagLacing",value:C.bool},28135:{name:"minCache",value:C.uint},28136:{name:"maxCache",value:C.uint},2352003:{name:"defaultDuration",value:C.uint},2306383:{name:"timecodeScale",value:C.float},21358:{name:"name",value:C.string},2274716:{name:"language",value:C.string},134:{name:"codecID",value:C.string},25506:{name:"codecPrivate",value:C.binary},2459272:{name:"codecName",value:C.string},3839639:{name:"codecSettings",value:C.string},3883072:{name:"codecInfoUrl",value:C.string},2536e3:{name:"codecDownloadUrl",value:C.string},170:{name:"codecDecodeAll",value:C.bool},28587:{name:"trackOverlay",value:C.uint},224:{name:"video",container:{154:{name:"flagInterlaced",value:C.bool},21432:{name:"stereoMode",value:C.uint},176:{name:"pixelWidth",value:C.uint},186:{name:"pixelHeight",value:C.uint},21680:{name:"displayWidth",value:C.uint},21690:{name:"displayHeight",value:C.uint},21683:{name:"aspectRatioType",value:C.uint},3061028:{name:"colourSpace",value:C.uint},3126563:{name:"gammaValue",value:C.float}}},225:{name:"audio",container:{181:{name:"samplingFrequency",value:C.float},30901:{name:"outputSamplingFrequency",value:C.float},159:{name:"channels",value:C.uint},148:{name:"channels",value:C.uint},32123:{name:"channelPositions",value:C.binary},25188:{name:"bitDepth",value:C.uint}}},28032:{name:"contentEncodings",container:{25152:{name:"contentEncoding",container:{20529:{name:"order",value:C.uint},20530:{name:"scope",value:C.bool},20531:{name:"type",value:C.uint},20532:{name:"contentEncoding",container:{16980:{name:"contentCompAlgo",value:C.uint},16981:{name:"contentCompSettings",value:C.binary}}},20533:{name:"contentEncoding",container:{18401:{name:"contentEncAlgo",value:C.uint},18402:{name:"contentEncKeyID",value:C.binary},18403:{name:"contentSignature ",value:C.binary},18404:{name:"ContentSigKeyID  ",value:C.binary},18405:{name:"contentSigAlgo ",value:C.uint},18406:{name:"contentSigHashAlgo ",value:C.uint}}},25188:{name:"bitDepth",value:C.uint}}}}}}}}},475249515:{name:"cues",container:{187:{name:"cuePoint",container:{179:{name:"cueTime",value:C.uid},183:{name:"positions",container:{247:{name:"track",value:C.uint},241:{name:"clusterPosition",value:C.uint},21368:{name:"blockNumber",value:C.uint},234:{name:"codecState",value:C.uint},219:{name:"reference",container:{150:{name:"time",value:C.uint},151:{name:"cluster",value:C.uint},21343:{name:"number",value:C.uint},235:{name:"codecState",value:C.uint}}},240:{name:"relativePosition",value:C.uint}}}}}}},423732329:{name:"attachments",container:{24999:{name:"attachedFiles",multiple:!0,container:{18046:{name:"description",value:C.string},18030:{name:"name",value:C.string},18016:{name:"mimeType",value:C.string},18012:{name:"data",value:C.binary},18094:{name:"uid",value:C.uid}}}}},272869232:{name:"chapters",container:{17849:{name:"editionEntry",container:{182:{name:"chapterAtom",container:{29636:{name:"uid",value:C.uid},145:{name:"timeStart",value:C.uint},146:{name:"timeEnd",value:C.uid},152:{name:"hidden",value:C.bool},17816:{name:"enabled",value:C.uid},143:{name:"track",container:{137:{name:"trackNumber",value:C.uid},128:{name:"display",container:{133:{name:"string",value:C.string},17276:{name:"language ",value:C.string},17278:{name:"country ",value:C.string}}}}}}}}}}},307544935:{name:"tags",container:{29555:{name:"tag",multiple:!0,container:{25536:{name:"target",container:{25541:{name:"tagTrackUID",value:C.uid},25540:{name:"tagChapterUID",value:C.uint},25542:{name:"tagAttachmentUID",value:C.uid},25546:{name:"targetType",value:C.string},26826:{name:"targetTypeValue",value:C.uint},25545:{name:"tagEditionUID",value:C.uid}}},26568:{name:"simpleTags",multiple:!0,container:{17827:{name:"name",value:C.string},17543:{name:"string",value:C.string},17541:{name:"binary",value:C.binary},17530:{name:"language",value:C.string},17531:{name:"languageIETF",value:C.string},17540:{name:"default",value:C.bool}}}}}}}}}}},da=ke("music-metadata:parser:ebml");var Qn;(function(t){t[t.ReadNext=0]="ReadNext",t[t.IgnoreElement=2]="IgnoreElement",t[t.SkipSiblings=3]="SkipSiblings",t[t.TerminateParsing=4]="TerminateParsing",t[t.SkipElement=5]="SkipElement"})(Qn||(Qn={}));class $W{constructor(e){this.tokenizer=e,this.padding=0,this.parserMap=new Map,this.ebmlMaxIDLength=4,this.ebmlMaxSizeLength=8,this.parserMap.set(C.uint,n=>this.readUint(n)),this.parserMap.set(C.string,n=>this.readString(n)),this.parserMap.set(C.binary,n=>this.readBuffer(n)),this.parserMap.set(C.uid,async n=>this.readBuffer(n)),this.parserMap.set(C.bool,n=>this.readFlag(n)),this.parserMap.set(C.float,n=>this.readFloat(n))}async iterate(e,n,r){return this.parseContainer(BR(e),n,r)}async parseContainer(e,n,r){const i={};for(;this.tokenizer.position<n;){let s;const a=this.tokenizer.position;try{s=await this.readElement()}catch(l){if(l instanceof Ke)break;throw l}const o=e.container[s.id];if(o)switch(r.startNext(o)){case Qn.ReadNext:if(s.id,da(`Read element: name=${ps(o)}{id=0x${s.id.toString(16)}, container=${!!o.container}} at position=${a}`),o.container){const u=await this.parseContainer(o,s.len>=0?this.tokenizer.position+s.len:-1,r);o.multiple?(i[o.name]||(i[o.name]=[]),i[o.name].push(u)):i[o.name]=u,await r.elementValue(o,u,a)}else{const u=this.parserMap.get(o.value);if(typeof u=="function"){const d=await u(s);i[o.name]=d,await r.elementValue(o,d,a)}}break;case Qn.SkipElement:da(`Go to next element: name=${ps(o)}, element.id=0x${s.id}, container=${!!o.container} at position=${a}`);break;case Qn.IgnoreElement:da(`Ignore element: name=${ps(o)}, element.id=0x${s.id}, container=${!!o.container} at position=${a}`),await this.tokenizer.ignore(s.len);break;case Qn.SkipSiblings:da(`Ignore remaining container, at: name=${ps(o)}, element.id=0x${s.id}, container=${!!o.container} at position=${a}`),await this.tokenizer.ignore(n-this.tokenizer.position);break;case Qn.TerminateParsing:return da(`Terminate parsing at element: name=${ps(o)}, element.id=0x${s.id}, container=${!!o.container} at position=${a}`),i}else switch(s.id){case 236:this.padding+=s.len,await this.tokenizer.ignore(s.len);break;default:da(`parseEbml: parent=${ps(e)}, unknown child: id=${s.id.toString(16)} at position=${a}`),this.padding+=s.len,await this.tokenizer.ignore(s.len)}}return i}async readVintData(e){const n=await this.tokenizer.peekNumber(ie);let r=128,i=1;for(;!(n&r);){if(i>e)throw new Error("VINT value exceeding maximum size");++i,r>>=1}const s=new Uint8Array(i);return await this.tokenizer.readBuffer(s),s}async readElement(){const e=await this.readVintData(this.ebmlMaxIDLength),n=await this.readVintData(this.ebmlMaxSizeLength);return n[0]^=128>>n.length-1,{id:Op(e,e.length),len:Op(n,n.length)}}async readFloat(e){switch(e.len){case 0:return 0;case 4:return this.tokenizer.readNumber(bR);case 8:return this.tokenizer.readNumber(P0);case 10:return this.tokenizer.readNumber(P0);default:throw new Error(`Invalid IEEE-754 float length: ${e.len}`)}}async readFlag(e){return await this.readUint(e)===1}async readUint(e){const n=await this.readBuffer(e);return Op(n,e.len)}async readString(e){return(await this.tokenizer.readToken(new Q(e.len,"utf-8"))).replace(/\x00.*$/g,"")}async readBuffer(e){const n=new Uint8Array(e.len);return await this.tokenizer.readBuffer(n),n}}function Op(t,e){return Number(zW(t,e))}function zW(t,e){const n=new Uint8Array(8),r=t.subarray(0,e);try{return n.set(r,8-e),V1.get(n,0)}catch{return BigInt(-1)}}function BR(t){return t.container&&Object.keys(t.container).map(e=>{const n=t.container[e];return n.id=Number.parseInt(e),n}).forEach(e=>{e.parent=t,BR(e)}),t}function ps(t){let e="";return t.parent&&t.parent.name!=="dtd"&&(e+=`${ps(t.parent)}/`),e+t.name}const Nu=ke("music-metadata:parser:matroska");class UW extends Cn{constructor(){super(...arguments),this.seekHeadOffset=0,this.flagUseIndexToSkipClusters=!1}init(e,n,r){return super.init(e,n,r),this.flagUseIndexToSkipClusters=r.mkvUseIndex??!1,this}async parse(){const e=this.tokenizer.fileInfo.size??Number.MAX_SAFE_INTEGER,n=new $W(this.tokenizer);Nu("Initializing DTD end MatroskaIterator"),await n.iterate(FW,e,{startNext:r=>{switch(r.id){case 475249515:return Nu(`Skip element: name=${r.name}, id=0x${r.id.toString(16)}`),Qn.IgnoreElement;case 524531317:if(this.flagUseIndexToSkipClusters&&this.seekHead){const i=this.seekHead.seek.find(s=>s.position+this.seekHeadOffset>this.tokenizer.position);if(i){const s=i.position+this.seekHeadOffset-this.tokenizer.position;return Nu(`Use index to go to next position, ignoring ${s} bytes`),this.tokenizer.ignore(s),Qn.SkipElement}}return Qn.IgnoreElement;default:return Qn.ReadNext}},elementValue:async(r,i,s)=>{switch(Nu(`Received: name=${r.name}, value=${i}`),r.id){case 17026:this.metadata.setFormat("container",`EBML/${i}`);break;case 290298740:this.seekHead=i,this.seekHeadOffset=s;break;case 357149030:{const a=i,o=a.timecodeScale?a.timecodeScale:1e6;if(typeof a.duration=="number"){const l=a.duration*o/1e9;await this.addTag("segment:title",a.title),this.metadata.setFormat("duration",Number(l))}}break;case 374648427:{const a=i;if(a!=null&&a.entries){a.entries.forEach(l=>{const u={codecName:l.codecID.replace("A_","").replace("V_",""),codecSettings:l.codecSettings,flagDefault:l.flagDefault,flagLacing:l.flagLacing,flagEnabled:l.flagEnabled,language:l.language,name:l.name,type:l.trackType,audio:l.audio,video:l.video};this.metadata.addStreamInfo(u)});const o=a.entries.filter(l=>l.trackType===Vs.audio).reduce((l,u)=>!l||u.flagDefault&&!l.flagDefault||u.trackNumber<l.trackNumber?u:l,null);o&&(this.metadata.setFormat("codec",o.codecID.replace("A_","")),this.metadata.setFormat("sampleRate",o.audio.samplingFrequency),this.metadata.setFormat("numberOfChannels",o.audio.channels))}}break;case 307544935:{const a=i;await Promise.all(a.tag.map(async o=>{const l=o.target,u=l!=null&&l.targetTypeValue?j0[l.targetTypeValue]:l!=null&&l.targetType?l.targetType:"track";await Promise.all(o.simpleTags.map(async d=>{const h=d.string?d.string:d.binary;await this.addTag(`${u}:${d.name}`,h)}))}))}break;case 423732329:{const a=i;await Promise.all(a.attachedFiles.filter(o=>o.mimeType.startsWith("image/")).map(o=>this.addTag("picture",{data:o.data,format:o.mimeType,description:o.description,name:o.name})))}break}}})}async addTag(e,n){await this.metadata.addTag("matroska",e,n)}}const wh=ke("music-metadata:parser:factory");function BW(t){const e=q1.parse(t),n=zV(e.type);return{type:n.type,subtype:n.subtype,suffix:n.suffix,parameters:e.parameters}}async function VW(t,e){const{mimeType:n,path:r,url:i}=t.fileInfo,s=VR(n)||V0(r)||V0(i);return s||wh(`No parser found for MIME-type / extension: ${n}`),HW(t,s,e)}async function HW(t,e,n){if(!e){wh("Guess parser on content...");const s=new Uint8Array(4100);if(await t.peekBuffer(s,{mayBeLess:!0}),t.fileInfo.path&&(e=V0(t.fileInfo.path)),!e){const a=await RR(s);if(!a)throw new Error("Failed to determine audio format");if(wh(`Guessed file type is mime=${a.mime}, extension=${a.ext}`),e=VR(a.mime),!e)throw new Error(`Guessed MIME-type not supported: ${a.mime}`)}}const r=await WW(e),i=new xH(n);return await r.init(i,t,n??{}).parse(),i.toCommonMetadata()}function V0(t){if(!t)return;switch(qW(t).toLocaleLowerCase()||t){case".mp2":case".mp3":case".m2a":case".aac":return"mpeg";case".ape":return"apev2";case".mp4":case".m4a":case".m4b":case".m4pa":case".m4v":case".m4r":case".3gp":return"mp4";case".wma":case".wmv":case".asf":return"asf";case".flac":return"flac";case".ogg":case".ogv":case".oga":case".ogm":case".ogx":case".opus":case".spx":return"ogg";case".aif":case".aiff":case".aifc":return"aiff";case".wav":case".bwf":return"riff";case".wv":case".wvp":return"wavpack";case".mpc":return"musepack";case".dsf":return"dsf";case".dff":return"dsdiff";case".mka":case".mkv":case".mk3d":case".mks":case".webm":return"matroska"}}async function WW(t){switch(t){case"aiff":return new TH;case"adts":case"mpeg":return new hW;case"apev2":return new vr;case"asf":return new FH;case"dsf":return new MW;case"dsdiff":return new LW;case"flac":return new UH;case"mp4":return new vh;case"musepack":return new wW;case"ogg":return new cm;case"riff":return new PW;case"wavpack":return new jW;case"matroska":return new UW;default:throw new Error(`Unknown parser type: ${t}`)}}function qW(t){const e=t.lastIndexOf(".");return e===-1?"":t.slice(e)}function VR(t){let e;if(!t)return;try{e=BW(t)}catch{wh(`Invalid HTTP Content-Type header value: ${t}`);return}const n=e.subtype.indexOf("x-")===0?e.subtype.substring(2):e.subtype;switch(e.type){case"audio":switch(n){case"mp3":case"mpeg":return"mpeg";case"aac":case"aacp":return"adts";case"flac":return"flac";case"ape":case"monkeys-audio":return"apev2";case"mp4":case"m4a":return"mp4";case"ogg":case"opus":case"speex":return"ogg";case"ms-wma":case"ms-wmv":case"ms-asf":return"asf";case"aiff":case"aif":case"aifc":return"aiff";case"vnd.wave":case"wav":case"wave":return"riff";case"wavpack":return"wavpack";case"musepack":return"musepack";case"matroska":case"webm":return"matroska";case"dsf":return"dsf"}break;case"video":switch(n){case"ms-asf":case"ms-wmv":return"asf";case"m4v":case"mp4":return"mp4";case"ogg":return"ogg";case"matroska":case"webm":return"matroska"}break;case"application":switch(n){case"vnd.ms-asf":return"asf";case"ogg":return"ogg"}break}}async function GW(t,e={}){const n={mimeType:t.type,size:t.size};return t instanceof File&&(n.path=t.name),KW(t.stream(),n,e)}function KW(t,e,n={}){return QW(SR(t,{fileInfo:typeof e=="string"?{mimeType:e}:e}),n)}function QW(t,e){return VW(t,e)}const XW=async t=>{if(!t)return;const e=await GW(t);if(!e)return;const{common:{title:n,artist:r},format:{duration:i}}=e;return Object.assign({},{name:n||t.name,singer:r||"...",duration:i||0})};function YW({admin:t,inputRef:e}){const{user:n}=ln(),{isDev:r}=H(),{songs:i,setSongs:s}=Jt(),{setTempSongs:a,tempSongs:o,clearTempSongs:l,shiftSong:u,status:d}=Lf(),h=f.useRef([]),m=f.useRef([]),p=f.useRef(!1),{setErrorToast:g,setSuccessToast:w}=sr(),E=y=>{if(!e.current)return;const x=e.current;x&&(x.value="",m.current=[]),l(y)},v=f.useCallback(async y=>{if(!n)return g("Missing user data");l("uploading");const _=y.target.files;if(!_.length){l("finish");return}let S=W6({by:t?"admin":n.email,song_in:t?"admin":"user"}),k=[];const b=Date.now(),T=P=>i.some(N=>N.singer===P.singer&&N.name===P.name&&N.size===P.size)||k.some(N=>N.singer===P.singer&&N.name===P.name&&N.size===P.size);try{let P;for(P=0;P<=_.length-1;P++){const B=_[P],F=await XW(B);if(!F){g("Error when parser song"),E("finish-error");return}let $={...S,name:F.name,singer:F.singer,duration:Math.floor(F.duration),size:Math.floor(B.size/1024)};if(T($)){console.log(">>>duplicate"),p.current=!0,h.current.push($);continue}k.push($),m.current=[...m.current,P]}if(i.length+m.current.length>5&&n.role!=="ADMIN"){E("finish-error"),g("You have reach the upload limit");return}if(!k.length){p.current=!1,E("finish-error"),g("Duplicate song");return}a(k);for(let B=0;B<m.current.length;B++){const F=m.current[B];let $=iv(k[B].name);t&&($+="_admin");const L={...k[B]},{filePath:Oe,fileURL:nt}=await $A({file:_[F],folder:"/songs/",email:n.email,msg:">>> api: upload song file"});Object.assign(L,{id:$,song_file_path:Oe,song_url:nt}),await mn({collection:"songs",data:L,id:L.id,msg:">>> api: set song doc"}),s(De=>[...De,{...L,queue_id:Xs(4)}]),u(),r&&console.log(L.name,"uploaded")}m.current=[],p.current?(E("finish-error"),w()):(E("finish"),w(`${k.length} songs uploaded`));const N=Date.now();r&&console.log(">>> upload songs finished after",(N-b)/1e3);return}catch(P){console.log({message:P}),E("finish-error"),g()}},[n,i]);return f.useEffect(()=>{const y=document.querySelector(".temp-song");y&&y.scrollIntoView({behavior:"smooth",block:"center"})},[o]),{handleInputChange:v}}const Z1=(t,e)=>`linear-gradient(to right, ${t} ${e}%, rgba(255,255,255,.15) ${e}%, rgba(255,255,255,.15) 100%)`;function JW({audioEle:t,volumeLineRef:e}){const{theme:n}=H(),[r,i]=f.useState(!1),[s,a]=vR("volume",1),o=d=>{const m=d.target.getBoundingClientRect(),p=e.current;if(p){let g=+((d.clientX-m.x)/p.clientWidth).toFixed(2);g>.9?g=1:g<.05?(g=0,i(!0)):i(!1),a(g)}},l=d=>{d.preventDefault();const h=.1;let m=s;d.deltaY>0?m-h>0?m-=h:m=0:m+h<1?m+=h:m=1,a(+m.toFixed(2))},u=()=>i(!r);return f.useEffect(()=>{if(e.current&&t){const d=s*100;e.current.style.background=Z1(n.content_code,d),t.volume=s,i(s===0)}},[s,n]),f.useEffect(()=>{t&&(t.muted=r)},[r]),{volume:s,handleSetVolume:o,isMute:r,handleMute:u,handleWheel:l}}const ZW=async t=>{const e=Date.now(),n=await Db.post("/api/image/encode",t);let r;n&&(r=n.data.encode);const i=(Date.now()-e)/1e3;return console.log(">>> api: get blurHash encode finished after",i),{encode:r}},eq=async t=>{const e=new FormData;e.append("file",t);const n=Date.now(),r=await Db.post("/api/image/optimize",e,{responseType:"blob"});let i;r&&(i=r.data);const s=(Date.now()-n)/1e3;return console.log(">>> api: optimize finished after",s),i},tq=/(?:https?):\/\/(\w+:?\w*)?(\S+)(:\d+)?(\/|\/([\w#!:.?+=&%!\-\/]))?/;function nq({song:t,inputFields:e,modalRef:n}){const{user:r}=ln(),{updateSong:i}=Jt(),[s,a]=f.useState(!!t.name),[o,l]=f.useState(!!t.singer),[u,d]=f.useState(!1),[h,m]=f.useState(!1),[p,g]=f.useState(!1),[w,E]=f.useState(!1),[v,y]=f.useState(!1),[x,_]=f.useState(t.image_url),[S,k]=f.useState(""),[b,T]=f.useState(),{setErrorToast:P,setSuccessToast:N}=sr(),B=async()=>{var F,$;if(r){if(!t.id){P("Edit song wrong song id");return}try{E(!0),(F=n.current)==null||F.setModalPersist(!0);let L={name:t.name,singer:t.singer,image_url:t.image_url,image_file_path:t.image_file_path,blurhash_encode:t.blurhash_encode};if(p){if(console.log("is change in edit"),!e.name||!e.singer){console.log("input invalid"),P("");return}const Oe=e.image_url&&u?e.image_url:t.image_url;if(await Vg(1e3),Object.assign(L,{name:e.name,singer:e.singer,image_url:Oe}),L.name!==e.name||L.singer!==e.singer){console.log("input invalid"),P();return}if(b&&v){const{filePath:nt,fileURL:De}=await $A({file:b,folder:"/images/",email:r.email});L.image_file_path=nt,L.image_url=De}else v&&(L.image_file_path="")}if(v&&(E(!0),console.log("isImpactOnImage"),t.image_file_path&&(L.image_file_path="",L.image_url="",await k0({filePath:t.image_file_path,msg:">>> api: delete song's image file"})),!x&&!b&&(console.log("remove current image url"),L.image_file_path="",L.image_url=""),b)){console.log("upload new file");const Oe=await eq(b);if(Oe==null)return;const nt=I7({blob:Oe,folder:"/images/",songId:t.id}),{encode:De}=await ZW(Oe);De&&(L.blurhash_encode=De,console.log("check encode",De));const{filePath:D,fileURL:G}=await nt;L.image_file_path=D,L.image_url=G}await mn({collection:"songs",data:L,id:t.id,msg:">>> api: update song doc"}),i({id:t.id,song:L}),N("Song edited"),($=n.current)==null||$.close()}catch(L){console.log({message:L}),P()}finally{E(!1)}}};return f.useEffect(()=>{e.name?a(!0):a(!1)},[e.name]),f.useEffect(()=>{e.singer?l(!0):l(!1)},[e.singer]),f.useEffect(()=>{if(!e.image_url){d(!0);return}const F=tq.test(e.image_url);d(F)},[e.image_url]),f.useEffect(()=>{(e.name!==t.name||e.singer!==t.singer||e.image_url)&&g(!0)},[e,S]),f.useEffect(()=>{m(s&&o&&u&&p)},[s,o,u,p]),{isFetching:w,validName:s,validSinger:o,validURL:u,isAbleToSubmit:h,isChangeInEdit:p,setValidURL:d,handleSubmit:B,setIsImpactOnImage:y,setStockImageURL:_,setImageURLFromLocal:k,setImageFileFromLocal:T,isImpactOnImage:v,stockImageURL:x,imageURLFromLocal:S,imageFileFromLocal:b}}function rq(){const t=Zt(),{queueSongs:e,currentQueueId:n,currentSongData:r}=oe(It),{isRepeat:i,isShuffle:s,playStatus:a}=oe(zn),o=f.useCallback(()=>{if(!r)return;let h=r.index+1,m;h<e.length?m=e[h]:(h=0,m=e[0]),t(Ji(m.queue_id))},[r,e]),l=f.useCallback(()=>{if(!r)return;let h=r.index-1,m;h>=0?m=e[h]:(m=e[e.length-1],h=e.length-1),t(Ji(m.queue_id))},[r,e]);return{handleNext:o,handlePrevious:l,handleRepeatSong:()=>{let h;switch(i){case"no":h="one";break;case"one":h="all";break;case"all":h="no";break;default:h="no"}kt("isRepeat",h),t(wt({isRepeat:h}))},handleShuffle:()=>{const h=!s;t(wt({isShuffle:h})),kt("isShuffle",h)},playStatus:a,queueSongs:e,currentQueueId:n}}function iq(){const{isOpenFullScreen:t,audioRef:e}=Qt();if(!e.current)throw new Error("Use Control audioRef.current is undefined");const n=Zt(),{theme:r}=H(),{user:i}=ln(),{queueSongs:s,currentSongData:a}=oe(It),{playStatus:o,triggerPlayStatus:l,isRepeat:u,isShuffle:d,isCrossFade:h}=oe(zn),{currentPlaylist:m}=oe(as),p=f.useRef(!0),g=f.useRef(),w=f.useRef(0),E=f.useRef(0),v=f.useRef(r.content_code),y=f.useRef(!1),x=f.useRef(!0),_=f.useRef(!1),S=f.useRef(!1),k=f.useRef(null),b=f.useRef(null),T=f.useRef("paused"),P=Rr(),{setErrorToast:N}=sr(),{currentQueueId:B,handleNext:F,handlePrevious:$,handleRepeatSong:L,handleShuffle:Oe}=rq(),nt=f.useMemo(()=>P.pathname.includes("edit"),[P]),De=f.useMemo(()=>Yn(),[]),D=async se=>{try{if(p.current&&(p.current=!1,se)){const We=Yn().current_time||0;e.current.currentTime=We}if(await e.current.play(),S.current=!1,_.current=!1,!i)return;x.current&&(h&&(e.current.volume=0),x.current=!1)}catch{}},G=()=>{e.current.pause()},Y=se=>s[se],Se=()=>{o==="playing"&&G(),o==="paused"&&D(!0)},le=()=>{n(wt({playStatus:"paused"}))},cn=()=>{o!=="playing"&&n(wt({playStatus:"playing"}))},ae=()=>{k.current&&b.current&&(b.current.innerText="0:00",k.current.style.background="rgba(255, 255, 255, 0.15)")},lt=se=>{const ct=se.target;if(k.current){const We=ct.getBoundingClientRect(),li=(se.clientX-We.left)/k.current.offsetWidth,ci=Math.round(li*e.current.duration),uP=e.current.currentTime;if(w.current&&Math.abs(uP-w.current)<1&&Math.abs(ci-w.current)<1)return;Xe(ci),p.current?kt("current_time",ci):e.current.currentTime=ci,w.current=ci}},vt=se=>{const ct=Yn().volume||1;if(se<=2){const We=se/2*ct;e.current.volume=We}else if(se<E.current){e.current.volume!=ct&&(e.current.volume=ct);return}if(se>=E.current){const We=(e.current.duration-se)/2*ct;e.current.volume=We}},Xe=se=>{const ct=k.current,We=b.current,Un=se||e.current.currentTime;if(e.current.duration&&ct){const li=Un/(e.current.duration/100);ct.style.background=Z1(v.current,+li.toFixed(1))}We&&(We.innerText=eo(Un)||"0:00")},Mo=()=>{const se=e.current.currentTime;T.current!=="paused"&&n(wt({playStatus:"playing"})),Xe(se),h&&vt(se),se&&Math.round(se)%3===0&&kt("current_time",Math.round(se))},sx=()=>{if(!g.current)return;const se=Yn(),ct=se.volume||1,We=se.timer;if(u==="one"&&We&&We!==1)return D();if(e.current.volume=ct,_.current=!0,d){let Un=g.current.index;for(;Un===g.current.index;)Un=Math.round(Math.random()*s.length-1);const li=Y(Un);return n(Ji(li.queue_id))}return We===1?y.current=!0:g.current.index===s.length-1&&(u==="all"?y.current=!1:y.current=!0),F()},ax=()=>{g.current&&n(wt({playStatus:"loading"}))},ox=()=>{var We;if(!g.current)return;const se=e.current.duration,ct=De.current_queue_id;if(E.current=se-3,kt("current_queue_id",g.current.song.queue_id),y.current)return y.current=!1,n(wt({playStatus:"paused"}));if((nt||p.current)&&(n(wt({playStatus:"paused"})),p.current&&ct===((We=g.current)==null?void 0:We.song.queue_id))){Xe(De.current_time||0);return}D()},lx=()=>{n(wt({playStatus:"waiting"}))},cx=()=>{if(g.current){if(S.current||(S.current=!0,N("Found internet error")),!_.current)return n(wt({playStatus:"error"}));if(s.length>1){if(g.current.index===s.length-1){n(wt({playStatus:"error"}));return}F()}else n(wt({playStatus:"error"}))}};return f.useEffect(()=>{const se=De.current_queue_id||null;se&&s.length?n(Ji(se)):p.current=!1},[]),f.useEffect(()=>(e.current.addEventListener("error",cx),e.current.addEventListener("pause",le),e.current.addEventListener("play",cn),e.current.addEventListener("loadstart",ax),e.current.addEventListener("loadedmetadata",ox),e.current.addEventListener("waiting",lx),()=>{var se,ct,We,Un,li,ci;(se=e.current)==null||se.removeEventListener("error",cx),(ct=e.current)==null||ct.removeEventListener("pause",le),(We=e.current)==null||We.removeEventListener("play",cn),(Un=e.current)==null||Un.removeEventListener("loadstart",ax),(li=e.current)==null||li.removeEventListener("loadedmetadata",ox),(ci=e.current)==null||ci.addEventListener("waiting",lx)}),[]),f.useEffect(()=>{if(!a||!B){T.current="paused",G();return}return e.current.src=a.song.song_url,g.current=a,()=>{ae(),x.current=!0}},[a==null?void 0:a.song]),f.useEffect(()=>{if(!a){o==="paused"&&ae();return}let se=`${a.song.name} - ${a.song.singer}`;o==="paused"&&m&&a.song.song_in.includes(m.id)&&(se=`${m.name}`),document.title=se,T.current=o},[o]),f.useEffect(()=>{if(!(!l||l===o))switch(l){case"playing":D();break;case"paused":G();break;default:console.log("no trigger action")}},[l]),f.useEffect(()=>(e.current.addEventListener("ended",sx),()=>{var se;return(se=e.current)==null?void 0:se.removeEventListener("ended",sx)}),[u,d,B,s]),f.useEffect(()=>(e.current.addEventListener("timeupdate",Mo),()=>{var se;(se=e.current)==null||se.removeEventListener("timeupdate",Mo)}),[h]),f.useEffect(()=>{g.current&&(t?v.current="#fff":v.current=r.content_code,Xe(p.current?De.current_time:0))},[r,t]),f.useEffect(()=>{nt&&o==="playing"&&G()},[nt]),{isOpenFullScreen:t,timelineEleRef:k,currentTimeEleRef:b,handleSeek:lt,playStatus:o,currentSongData:a,play:D,pause:G,handlePlayPause:Se,isRepeat:u,isShuffle:d,isCrossFade:h,handlePrevious:$,handleRepeatSong:L,handleShuffle:Oe,queueSongs:s,resetForNewSong:ae,handleNext:F}}function sq({song:t,modalRef:e}){const{theme:n}=H(),[r,i]=f.useState({name:t.name,singer:t.singer,image_url:""}),s=f.useRef(null),{isAbleToSubmit:a,validName:o,validSinger:l,validURL:u,imageURLFromLocal:d,isImpactOnImage:h,setImageFileFromLocal:m,setImageURLFromLocal:p,setStockImageURL:g,setIsImpactOnImage:w,stockImageURL:E,setValidURL:v,isFetching:y,handleSubmit:x}=nq({song:t,inputFields:r,modalRef:e}),_=f.useMemo(()=>{if(d)return d;if(E)return E;if(u)return r.image_url},[r,d,E,t,u]),S=f.useMemo(()=>!!d||!!E,[d,E]),k=(F,$)=>{i({...r,[F]:$})},b=f.useCallback(()=>{t.image_file_path&&!d?g(""):d?(p(""),m(void 0)):g(""),w(!0);const F=s.current;F&&(F.value="")},[d,t.image_file_path]),T=f.useCallback(F=>{const L=F.target.files[0];p(URL.createObjectURL(L)),w(!0),m(L)},[]),P=F=>{var $;F.stopPropagation(),($=e.current)==null||$.close()},N=F=>F?c.jsx(Uh,{className:"w-6 text-emerald-500 ml-2"}):c.jsx(js,{className:"w-6 text-red-500 ml-2"}),B={input:`px-[10px] py-1 outline-none rounded-[4px] text-lg ${n.side_bar_bg} border border-${n.alpha} font-[500]`,label:"text-lg inline-flex"};return c.jsxs("div",{className:`${Fb(y)} w-[500px] max-h-[80vh] max-w-[90vw] flex flex-col`,children:[c.jsx("input",{ref:s,id:"editImageInput",type:"file",accept:"image/*",onChange:T,className:"hidden"}),c.jsx(Or,{title:"Edit song",close:()=>{var F;return(F=e.current)==null?void 0:F.close}}),c.jsxs("div",{className:"flex flex-col flex-grow overflow-auto md:overflow-hidden md:flex-row mt-5",children:[c.jsxs("div",{className:"w-full md:w-[30%]",children:[c.jsx("div",{className:"w-[70%] mx-auto md:w-full",children:c.jsx("div",{className:"pt-[100%] relative",children:c.jsx("div",{className:"absolute inset-0",children:c.jsx(Nr,{className:"object-cover rounded-md object-center w-full h-full",onError:()=>v(!1),src:_,blurHashEncode:t.blurhash_encode})})})}),c.jsxs("div",{className:"mt-3",children:[c.jsxs("div",{className:"flex space-x-2",children:[c.jsx("label",{htmlFor:"editImageInput",className:`inline-block cursor-pointer hover:brightness-90 px-[20px] py-[5px] bg-${n.alpha} rounded-full text-[14px]`,children:c.jsx(ob,{className:"w-5"})}),S&&c.jsx(V,{onClick:()=>b(),className:`inline-block hover:brightness-90 px-[20px] py-[5px] ${n.content_bg} rounded-full text-[14px]`,children:c.jsx(js,{className:"w-5"})})]}),c.jsx("p",{className:`text-sm ${n.text_color} mt-[10px]`,children:"* Image from URL will not be apply until you remove current image"})]})]}),c.jsxs("div",{className:"pt-5 md:pt-0 md:pl-5 flex flex-col md:flex-grow space-y-3",children:[c.jsxs("div",{className:"flex flex-col gap-[5px]",children:[c.jsxs("label",{htmlFor:"name",className:B.label,children:["Name",N(o)]}),c.jsx("input",{className:`${B.input} ${n.text_color}`,value:r.name,type:"text",id:"name",onChange:F=>k("name",F.target.value),placeholder:t.name})]}),c.jsxs("div",{className:"flex flex-col gap-[5px]",children:[c.jsxs("label",{htmlFor:"singer",className:B.label,children:["Singer",N(l)]}),c.jsx("input",{className:B.input,value:r.singer,onChange:F=>k("singer",F.target.value),type:"text",id:"singer",placeholder:t.singer})]}),c.jsxs("div",{className:"flex flex-col gap-[5px]",children:[c.jsxs("label",{htmlFor:"image-url",className:B.label,children:["Image URL",r.image_url&&c.jsx(c.Fragment,{children:N(u)})]}),c.jsx("input",{id:"image-url",className:B.input,value:r.image_url,onChange:F=>k("image_url",F.target.value),type:"text"})]})]})]}),c.jsxs("div",{className:"flex mt-5 space-x-2 justify-end",children:[c.jsx(V,{onClick:P,className:`bg-${n.alpha} rounded-full`,variant:"primary",children:"Close"}),c.jsx(V,{isLoading:y,onClick:x,className:`${n.content_bg} rounded-full ${a?"":!h&&"disable"}`,variant:"primary",children:"Save"})]})]})}function aq({toast:t,theme:e,onClick:n}){const[r,i]=f.useState(!1),s={icon:"w-6",container:`transition-[transform,opacity] text-white px-3 py-1 space-x-1 rounded-md flex items-center ${e.content_bg} border border-${e.alpha}`,text:"font-[500] text-sm",open:"opacity-[1] translate-x-0",init:"opacity-0 -translate-x-10"},a=()=>{switch(t.variant){case"success":return c.jsx(Uh,{className:`${s.icon}`});case"error":return c.jsx(js,{className:`${s.icon}`})}};return f.useEffect(()=>{setTimeout(()=>{i(!0)},0)},[]),c.jsxs("div",{onClick:()=>n?n(t.id):void 0,className:`${s.container} ${r?s.open:s.init} `,children:[a(),c.jsx("p",{className:s.text,children:t.desc})]})}function oq({lyric:t,openModal:e,seek:n,theme:r,isLast:i}){return c.jsx(c.Fragment,{children:c.jsxs("div",{className:"pt-[10px] last:mb-[30vh]",children:[c.jsx("button",{className:`text-[18px] ${r.content_hover_text}`,onClick:()=>n(t.start),children:eo(+t.start)}),c.jsxs("p",{className:"font-[700] select-none flex items-center",children:[t.text,c.jsx("button",{onClick:e,className:"ml-1",children:c.jsx(jB,{className:"w-5"})})]}),i&&c.jsx("button",{className:`${r.content_hover_text}`,onClick:()=>n(t.start),children:eo(t.end)})]})})}function HR({cb:t,active:e,className:n,size:r="default"}){const{theme:i}=H(),s={circle:`${r==="default"?"w-[20px] h-[20px]":"w-[16px] h-[16px]"}  absolute bg-white left-[3px] rounded-[50%] transition-transform top-[50%] translate-y-[-50%]`,active:`${r==="default"?"translate-x-[14px]":"translate-x-[18px]"} `,inActive:"translate-x-[0]"};return c.jsx("div",{onClick:t,className:`relative  cursor-pointer ${r==="default"?"h-[24px]":"h-[20px]"} rounded-[99px] w-[40px] ${n||""} 
         ${e?i.content_bg:"bg-"+i.alpha} `,children:c.jsx("div",{className:`${s.circle} ${e?s.active:s.inActive}`})})}function lq(){const{audioRef:t,controlRef:e}=Qt();if(!t.current)throw new Error("useCountDown audioRef.current is undefined");const{playStatus:n}=oe(zn),[r,i]=f.useState(0),[s,a]=f.useState(0),o=f.useRef(!1),l=d=>{kt("timer",0),i(0),o.current=!0,d&&a(0)},u=()=>{a(d=>d-1>0?(kt("timer",d-1),d-1):(l(),0))};return f.useEffect(()=>{const d=Yn().timer||0;i(d),a(d)},[]),f.useEffect(()=>{if(r)return t.current.addEventListener("ended",u),()=>{t.current.removeEventListener("ended",u)}},[r]),f.useEffect(()=>{var d;r&&(s||(a(r),kt("timer",r),n==="paused"&&((d=e.current)==null||d.handlePlayPause())))},[r]),{countDown:s,clearTimer:l,setCountDown:a,setIsActive:i,isActive:r}}const cq=({appendOnPortal:t})=>{const[e,n]=f.useState(!1),[r,i]=f.useState(!1),s=f.useRef(null),a=f.useRef(null);return{refs:{triggerRef:s,contentRef:a},setTriggerRef:h=>{s.current=h},setContentRef:h=>{a.current=h},state:{isMounted:r,isOpen:e},setIsMounted:i,setIsOpen:n,appendOnPortal:t,close:()=>{i(!1)},toggle:()=>{r&&i(!1),e||n(!0)}}},WR=f.createContext(null),ex=()=>{const t=f.useContext(WR);return t||{}};function go({children:t,relativeWrap:e=!0,appendOnPortal:n,...r}){return c.jsx(WR.Provider,{value:cq({...r,appendOnPortal:n}),children:n?t:c.jsx("div",{className:"relative",children:t})})}const yo=f.forwardRef(function({children:t,needButton:e,setIsOpenParent:n},r){const{refs:i,setIsMounted:s,setIsOpen:a,close:o,toggle:l,state:{isMounted:u,isOpen:d}}=ex();return f.useImperativeHandle(r,()=>({close:o})),f.useEffect(()=>{u||(n&&n(!1),setTimeout(()=>{a(!1)},400))},[u]),f.useEffect(()=>(d&&(n&&n(!0),setTimeout(()=>{s(!0)},100)),()=>{d||s(!1)}),[d]),f.useEffect(()=>{if(!d)return;const h=m=>{var p,g;!i.contentRef||!i.triggerRef||(p=i.triggerRef.current)!=null&&p.contains(m.target)||(g=i.contentRef.current)!=null&&g.contains(m.target)||s(!1)};return document.addEventListener("mousedown",h),document.addEventListener("touchstart",h),()=>{document.removeEventListener("mousedown",h),document.removeEventListener("touchstart",h)}},[d]),!e&&f.isValidElement(t)?f.cloneElement(t,{onClick:l,ref:i.triggerRef}):c.jsx("button",{ref:i.triggerRef,onClick:l,children:t})});function vo({children:t,className:e,animationClassName:n,...r}){const{state:{isMounted:i,isOpen:s},refs:a,close:o,appendOnPortal:l,setContentRef:u}=ex(),d=f.useRef(null),h=()=>{const w=a.triggerRef.current,E=a.contentRef.current,v=d.current;if(!w||!E)return;const y=w.getBoundingClientRect(),x={top:y.top+w.clientHeight,left:y.left-E.clientWidth};if(r.appendTo==="portal"){const{origin:_="top right",position:S,spacer:k=8}=r;switch(S){case"right-bottom":{x.top=y.top+w.clientHeight+k,x.left=y.left;break}}const b=x.top+E.clientHeight>window.innerHeight-90;if(b){let T=x.top-E.clientHeight-w.clientHeight;T-60<0&&(T=60),x.top=T}if(v){let T=_;b&&(T="bottom right"),v.style.transformOrigin=T}}E.style.left=`${x.left}px`,E.style.top=`${x.top}px`},m=o,p={unMountedContent:"opacity-0 scale-[.95]",mountedContent:"opacity-100 scale-[1]"},g=c.jsx("div",{ref:u,className:`${l?"fixed z-[99]":"absolute"} ${e||""}`,children:c.jsx("div",{ref:d,className:` transition-[transform,opacity] duration-[.25s] ease-linear ${n||""} ${i?p.mountedContent:p.unMountedContent}`,children:t})});return f.useEffect(()=>{if(l)return s&&(h(),document.addEventListener("wheel",m)),()=>{document.removeEventListener("wheel",m)}},[s]),s?c.jsx(c.Fragment,{children:l?Eo.createPortal(g,document.getElementById("portals")):g}):c.jsx(c.Fragment,{})}function uq({children:t,className:e="px-2 py-1 text-sm font-[600]",position:n="bottom-[calc(100%+8px)]",content:r,isWrapped:i,...s},a){const[o,l]=f.useState(!1),{theme:u}=H(),{setTriggerRef:d,state:h}=ex(),{onClick:m}=s,p=f.useRef(null),g=()=>{l(!0)},w=()=>{l(!1)};f.useEffect(()=>{const y=p.current;if(y)return d&&d(y),y.addEventListener("mouseenter",g),y.addEventListener("mouseleave",w),()=>{y.removeEventListener("mouseenter",g),y.removeEventListener("mouseleave",w)}},[]);const E={container:`${u.type==="dark"?"bg-white text-[#333]":"bg-slate-700 text-white"}`},v=c.jsx(c.Fragment,{children:f.isValidElement(t)&&c.jsxs(c.Fragment,{children:[Object.keys(s).length?f.cloneElement(t,{ref:p,onClick:m}):f.cloneElement(t,{ref:p}),!(h!=null&&h.isOpen)&&o&&c.jsx("div",{className:`${E.container} absolute whitespace-nowrap -translate-x-1/2 left-1/2 rounded-md ${n} ${e}`,children:r})]})});if(f.isValidElement(t))return c.jsx(c.Fragment,{children:i?v:c.jsx("div",{className:"relative",children:v})})}const Xr=f.forwardRef(uq);function qR(){const{theme:t}=H(),e=f.useRef(null),{countDown:n,isActive:r,clearTimer:i,setIsActive:s}=lq(),a=u=>s(u),o=()=>{var u;r?i(!0):(u=e.current)==null||u.open()},l={container:"w-[54px] sm:w-[50px] flex justify-center",button:`rounded-[99px]  hover:bg-${t.alpha} p-[5px]`,itemContainer:"flex justify-between items-center min-h-[30px]",text:"text-base text-[#ccc]"};return c.jsxs(c.Fragment,{children:[c.jsx("div",{className:l.container,children:r?c.jsx(Xr,{content:"Clear timer",children:c.jsxs("button",{className:"group flex items-center",onClick:o,children:[c.jsx("span",{className:"text-base opacity-70 sm:text-sm group-hover:hidden",children:n.toString().padStart(2,"0")}),c.jsx("span",{className:`hidden group-hover:block ${l.button}`,children:c.jsx(js,{className:"w-8 sm:w-6"})})]})}):c.jsx(Xr,{content:"Sleep timer",children:c.jsx("button",{onClick:o,className:l.button,children:c.jsx(lb,{className:"w-8 sm:w-6"})})})}),c.jsx(Dr,{ref:e,variant:"animation",children:c.jsx(dG,{active:a,closeModal:()=>{var u;return(u=e.current)==null?void 0:u.close()}})})]})}function dq({vinylRef:t}){const{playStatus:e}=oe(zn);f.useEffect(()=>{const n=t.current;n&&(e==="playing"?n.style.animationPlayState="running":n.style.animationPlayState="paused")},[e])}function hq({isOpenFullScreen:t,admin:e,song:n}){const r=f.useRef(null);dq({vinylRef:r});const i={songInfoWrapper:`${e?"w-1/4":"w-1/4 "}`,songInfoChild:"flex flex-row"};return c.jsx("div",{className:`${i.songInfoWrapper}  ${Uw(t)}`,children:c.jsxs("div",{className:`${i.songInfoChild} ${Uw(t)}`,children:[c.jsx("div",{ref:r,className:`${e?"w-[46px]":"w-[56px]"}  animate-[spin_8s_linear_infinite]`,children:c.jsx(Nr,{src:n==null?void 0:n.image_url,className:"rounded-full w-full"})}),c.jsxs("div",{className:"ml-2 flex-grow",children:[c.jsx("div",{className:"h-[32px]",children:c.jsx(Eh,{className:"leading-[1.5] font-playwriteCU",content:(n==null?void 0:n.name)||"Name"})}),c.jsx("div",{className:"h-[20px]",children:c.jsx(Eh,{autoScroll:!0,className:"opacity-70 leading-[1.2]",content:(n==null?void 0:n.singer)||"..."})})]})]})})}function fq({audioEle:t}){const e=f.useRef(null),{handleMute:n,handleWheel:r,handleSetVolume:i,isMute:s}=JW({audioEle:t,volumeLineRef:e}),a={before:"before:content-[''] before:w-[100%] before:h-[16px] before:absolute before:top-[50%] before:translate-y-[-50%]",volumeLineBase:"ml-1 w-full relative h-[4px] cursor-pointer rounded-full shadow-[2px_2px_10px_rgba(0,0,0,.15)]"};return c.jsxs("div",{className:"flex flex-grow items-center max-w-[120px] mr-2",children:[c.jsx("button",{onWheel:r,onClick:()=>n(),children:s?c.jsx(wj,{className:"w-6"}):c.jsx(yj,{className:"w-6"})}),c.jsx("div",{onClick:o=>i(o),ref:e,className:`${a.volumeLineBase} ${a.before}`,style:{background:"#e1e1e1"}})]})}function mq(){const{theme:t}=H(),e=f.useRef(null);return f.useEffect(()=>{if(e.current){if(!t.image){e.current.style.backgroundImage="";return}e.current.style.backgroundImage=`url(${t.image})`}},[t]),{containerRef:e}}function pq(){const{audioRef:t,idle:e}=Qt();if(!t.current)throw new Error("BottomPlayer !audioRef.current");const{theme:n}=H(),{isOpenFullScreen:r,controlRef:i,isOpenSongQueue:s,setIsOpenFullScreen:a,setIsOpenSongQueue:o}=Qt(),{currentQueueId:l,currentSongData:u}=oe(It),{containerRef:d}=mq(),h=Rr(),m=f.useMemo(()=>h.pathname.includes("edit"),[h]),p=()=>{s&&o(!1),a(!0)},g={wrapper:`border-${n.alpha} fixed bottom-0 w-full border-t transition-transform z-50 px-6 h-[90px]`,container:"flex flex-row gap-[10px] h-full items-center",controlWrapper:`flex max-w-[420px] flex-grow ${r?"max-w-[600px] flex-col-reverse pb-[10px]":"flex-col justify-center"}`,right:"w-1/4 flex items-center justify-end",blurBg:`bg-opacity-[0.8] backdrop-blur-[15px] z-[-1] absolute inset-0 ${n.bottom_player_bg}`};return c.jsxs("div",{ref:d,className:`${g.wrapper} ${r?"border-transparent":n.image?n.bottom_player_bg:""} ${m&&"translate-y-[100%] "} `,children:[!n.image&&c.jsx("div",{className:`${g.blurBg} ${r?"opacity-0 transition-opacity delay-[.2s]":""}`}),c.jsxs("div",{className:`${g.container} ${r?"justify-center text-white":"justify-between"} ${e&&"transition-opacity duration-[.3s] opacity-0"}`,children:[c.jsx(hq,{song:u==null?void 0:u.song,isOpenFullScreen:r}),c.jsx("div",{className:` ${g.controlWrapper} ${Fb(l===null)}`,children:c.jsx(GR,{variant:"desktop",ref:i})}),c.jsxs("div",{className:`${g.right}  ${r?"hidden":""}`,children:[c.jsx(fq,{audioEle:t.current}),c.jsxs("div",{className:`flex items-center ${l?"":"disable"}`,children:[c.jsx(Xr,{content:"Fullscreen mode",children:c.jsx("button",{onClick:p,className:`rounded-[99px]  hover:bg-${n.alpha}  p-[5px]`,children:c.jsx(v5,{className:"w-6"})})}),c.jsx(Xr,{content:"Queue",children:c.jsx("button",{onClick:()=>o(!s),className:`ml-1 hover:bg-${n.alpha} rounded-md p-[5px]`,children:c.jsx(mj,{className:"w-6"})})}),c.jsx("div",{className:`w-[2px] h-[26px] ml-2 bg-${n.alpha}`}),c.jsx(qR,{})]})]})]})]})}function gq({admin:t,variant:e},n){var S;const{theme:r}=H(),{isOpenFullScreen:i,currentSongData:s,handleSeek:a,handlePlayPause:o,handleNext:l,handlePrevious:u,handleRepeatSong:d,handleShuffle:h,isRepeat:m,isShuffle:p,playStatus:g,queueSongs:w,currentTimeEleRef:E,timelineEleRef:v,resetForNewSong:y,pause:x}=iq();f.useImperativeHandle(n,()=>({handlePlayPause:o,handleNext:l,pause:x,resetForNewSong:y}));const _={button:"p-1 rounded-full md:bg-transparent ",buttonsContainer:`w-full flex justify-center items-center mb-3 sm:mb-0 space-x-3 ${t?"hidden":""}`,progressContainer:`flex w-full flex-row items-center   ${t?"h-full":""}`,processLineBase:"h-[6px] sm:h-1 flex-grow relative cursor-pointer rounded-[99px] shadow-[2px_2px_10px_rgba(0,0,0,.15)] ",icon:"w-[44px] sm:w-7",before:"before:content-[''] before:w-[100%] before:h-[24px] before:absolute before:top-[50%] before:translate-y-[-50%]"};return c.jsxs(c.Fragment,{children:[c.jsx("div",{className:`${_.buttonsContainer}`,children:!t&&c.jsxs(c.Fragment,{children:[c.jsxs("button",{disabled:w.length<=1,className:`relative ${_.button} ${m!=="no"&&r.content_text}`,onClick:d,children:[c.jsx(K3,{className:_.icon}),c.jsx("span",{className:"absolute font-bold text-[12px] top-1/2 left-1/2 -translate-x-[50%] -translate-y-[50%] ",children:m==="one"?"1":m==="all"?"-":""})]}),c.jsx("button",{disabled:w.length<=1,className:_.button,onClick:()=>u(),children:c.jsx(Xy,{className:_.icon})}),c.jsx($E,{playStatus:g,handlePlayPause:o}),c.jsx("button",{disabled:w.length<=1,className:`${_.button}`,onClick:()=>l(),children:c.jsx(Vh,{className:_.icon})}),c.jsx("button",{disabled:w.length<=1,className:`${_.button} ${p&&r.content_text}`,onClick:h,children:c.jsx(t5,{className:_.icon})})]})}),c.jsxs("div",{className:`${_.progressContainer} ${e==="desktop"&&i?"mb-0":"mb-5 sm:mb-2"} ${g==="error"||g==="loading"?"disable":""}`,children:[c.jsx("div",{className:"w-[44px] sm:w-9",children:c.jsx("span",{ref:E,className:"text-lg sm:text-sm",children:"0:00"})}),c.jsx("div",{ref:v,style:{background:"rgba(255, 255, 255, 0.3)"},onClick:k=>a(k),className:`${_.processLineBase}  ${_.before}`}),c.jsx("div",{className:"w-[44px] sm:w-9 text-right",children:c.jsx("span",{className:"text-lg sm:text-sm",children:s!=null&&s.song?eo((S=s.song)==null?void 0:S.duration):"0:00"})}),t&&c.jsx("div",{className:"flex items-center ml-3",children:c.jsx($E,{playStatus:g,handlePlayPause:o})})]})]})}const GR=f.forwardRef(gq),yc={isDev:!1,focusDelay:3e3,scrollSongDelay:4e3,loadingDuration:200};function CS(t,e){const n=f.useRef(),[r,i]=f.useState(0),[s,a]=f.useState(0);return f.useEffect(()=>{r&&(n.current=setTimeout(()=>n.current=void 0,e))},[s,yc]),f.useEffect(()=>{n.current||(t(),a(Math.random()*10))},[r]),()=>i(Math.random()*10)}function KR(){const{theme:t}=H(),e=Zt(),{lyricSize:n,songBackground:r}=oe(zn),i=a=>{e(wt({lyricSize:a})),kt("lyricSize",a)},s={disableBtn:"bg-white/10 bg-opacity-20",lyricSizeBtn:`group/text justify-center !hover:brightness-100 font-[600] h-[30px] w-[30px] sm:h-[26px] sm:w-[26px] relative ${t.content_hover_bg}`,itemContainer:`flex justify-between  px-3 py-2 items-center min-h-[30px] hover:bg-${t.alpha}`,text:"text-base text-[#ccc]"};return c.jsx(c.Fragment,{children:c.jsx("div",{className:"w-[240px] sm:w-[220px]",children:c.jsxs(Ys,{p:"clear",color:"black",className:"space-y-[6px] text-white py-3",theme:t,children:[c.jsxs("div",{className:`${s.itemContainer}`,children:[c.jsx("p",{className:s.text,children:"Lyric size"}),c.jsxs("div",{className:"flex space-x-[8px]",children:[c.jsx(V,{onClick:()=>i("small"),variant:"circle",size:"clear",className:`${n==="small"?t.content_bg:s.disableBtn} ${s.lyricSizeBtn}`,children:c.jsx("span",{className:"leading-[1] text-[11px]",children:"A"})}),c.jsx(V,{onClick:()=>i("medium"),variant:"circle",size:"clear",className:`${n==="medium"?t.content_bg:s.disableBtn} ${s.lyricSizeBtn}`,children:c.jsx("span",{className:"leading-[1] text-[13px]",children:"A"})}),c.jsx(V,{onClick:()=>i("large"),variant:"circle",size:"clear",className:`${n==="large"?t.content_bg:s.disableBtn} ${s.lyricSizeBtn}`,children:c.jsx("span",{className:"leading-[1] text-[15px]",children:"A"})})]})]}),c.jsxs("div",{className:`${s.itemContainer}`,children:[c.jsx("p",{className:s.text,children:"Song background"}),c.jsx(HR,{size:"thin",className:"bg-white/10",active:r,cb:()=>e(UB({variant:"songBackground"}))})]})]})})})}const QR="U26Qe$KN5i}Y0|IpxH^j0x^P-W0zn7S_OTE2";function XR(t,e){const n=`lyric_${Xs(4)}`,r=document.querySelector("style");if(!r)return n;let i=`@keyframes ${n}{0%{width:0%}`;if(!t.length)return i+="100%{width:100%}}",r.innerText=i,n;let s=t.reduce((u,d)=>u+d,0);const a=[];let o=0,l=0;for(let u=0;u<e.length-1;u++){const d=e[u],h=t[u];l+=d,o+=h,a.push({progress:Math.round(o/s*100),width:l})}for(const u of a)i+=`${u.progress}%{width:${u.width}%}`;return i+="100%{width:100%}}",r.innerText=i,n}const YR=t=>{const e=t.clientWidth,n=[];return t.childNodes.forEach(r=>{n.push(Math.round(r.clientWidth/e*100))}),n},Xo=.3,AS=t=>t%2!==0;function yq({active:t}){const{audioRef:e}=Qt();if(!e.current)throw new Error("useKaraoke !audioRef.current");const[n,r]=f.useState(0),i=f.useRef(null),s=f.useRef(null),a=f.useRef(null),o=f.useRef(null),l=f.useRef(0),u=f.useRef(0),d=f.useRef("paused"),h=f.useRef(!1),{songLyrics:m,loading:p,playStatus:g}=yR({active:t}),w=f.useMemo(()=>{if(m.length){if(n<0)return{odd:"",even:""};const x=AS(n);if(!m[n+1])return{odd:"",even:""};const _=x?[n,n+1]:[n+1,n],S=m[_[0]].text.trim(),k=m[_[1]].text.trim();return{odd:S,even:k}}else return{odd:"",even:""}},[n,m]),E=x=>{x.style.animation="none"},v=(x,_,S,k)=>{var P,N;let b="running";d.current==="paused"&&(b="paused"),S.style.animation=`${x} ${(((P=_==null?void 0:_.tune)==null?void 0:P.end)||_.end)-(((N=_==null?void 0:_.tune)==null?void 0:N.start)||_.start)}s linear ${b} forwards`;const T=+k.toFixed(1);Math.abs(T)>.2&&(S.style.animationDelay=`${T}s`)},y=()=>{var S;if(!m.length)return;const x=e.current.currentTime>=l.current?"forward":"backward";l.current=e.current.currentTime;let _=u.current;switch(x){case"forward":for(;_<m.length&&m[_+1]&&m[_+1].start-Xo<l.current+Xo;)_+=1;break;case"backward":for(;_>0&&m[_-1]&&m[_-1].end-Xo>l.current+Xo;)_-=1;break}if(_!==u.current||h.current||d.current==="paused"||d.current==="waiting"){if(h.current=!1,u.current=_,r(_),!i.current||!s.current||!o.current||!a.current)return;const k=AS(_),b=m[_],{tune:T={grow:"",end:b.end}}=b,P=l.current+Xo-(((S=b==null?void 0:b.tune)==null?void 0:S.start)||b.start),N=T.grow.split("_").filter(L=>L).map(L=>+L),B=YR(k?o.current:a.current),F=k?[i.current,s.current]:[s.current,i.current],$=XR(N,B);v($,b,F[0],-P),E(F[1])}};return f.useEffect(()=>{d.current==="waiting"?setTimeout(()=>{d.current=g},300):d.current=g},[g]),f.useEffect(()=>{t&&(h.current=!0,g==="paused"&&y())},[t]),f.useEffect(()=>{if(!(!m.length||!t))return e.current.addEventListener("timeupdate",y),()=>{e.current.removeEventListener("timeupdate",y)}},[m,t]),f.useEffect(()=>()=>{l.current=0,u.current=-1,r(0)},[m]),{loading:p,currentIndexRef:u,oddOverlay:i,evenOverlay:s,currentIndex:n,textData:w,tempEventText:a,tempOddText:o}}function RS({text:t,overlayRef:e}){const{playStatus:n}=oe(zn),[r,i]=f.useState(t),[s,a]=f.useState(!1),o=f.useRef(!0);f.useEffect(()=>{t&&a(!1)},[t]),f.useEffect(()=>{if(s)return;const u=()=>{i(t),a(!0)};o.current?setTimeout(u,300):(o.current=!0,u())},[s]),f.useEffect(()=>{n==="waiting"&&(o.current=!1),e.current&&(n==="playing"?e.current.style.animationPlayState="running":e.current.style.animationPlayState="paused")},[n]);const l={lyric:"relative duration-300 text-[44px] font-[700] pointer-none whitespace-nowrap"};return c.jsxs("div",{className:`${l.lyric} ${o.current?"transition-opacity":""} ${s?"opacity-[1]":"opacity-0"}`,children:[r||"...",c.jsx("p",{ref:e,className:"absolute whitespace-nowrap w-0 overflow-hidden text-[#ffed00] left-0 top-0 h-full",children:r||"..."})]})}function _h({children:t}){return c.jsx("span",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2",children:t})}function vq({active:t}){const{loading:e,evenOverlay:n,oddOverlay:r,tempEventText:i,tempOddText:s,textData:a}=yq({active:t});return e?c.jsx(_h,{children:c.jsx(rs,{className:"w-7 animate-spin"})}):c.jsxs(c.Fragment,{children:[c.jsx("div",{ref:i,className:"inline-flex h-0 opacity-0",children:a.even.split(" ").map((o,l)=>c.jsx("span",{className:"leading-1",children:o},l))}),c.jsx("div",{ref:s,className:"inline-flex h-0 opacity-0",children:a.odd.split(" ").map((o,l)=>c.jsx("span",{className:"k leading-1",children:o},l))}),c.jsx(RS,{overlayRef:n,text:a.even}),c.jsx("div",{className:"mt-8"}),c.jsx(RS,{overlayRef:r,text:a.odd})]})}function xq(){var S,k,b,T,P,N;const t=Zt(),{theme:e}=H(),{isOpenFullScreen:n,setIsOpenFullScreen:r,idle:i}=Qt(),{queueSongs:s,currentQueueId:a,currentSongData:o}=oe(It),{songBackground:l}=oe(zn),[u,d]=f.useState("Lyric"),h=f.useRef(null),m=f.useRef(null),p=ir();KB({containerRef:h,songItemRef:m,idle:i});const g=CS(()=>v("next"),200),w=CS(()=>v("previous"),200),E=B=>{a!==B&&t(Ji(B))},v=(B="next")=>{const F=h.current;F.style.scrollBehavior="smooth",B==="next"?F.scrollLeft+=500:B==="previous"&&(F.scrollLeft-=500)},y=()=>{o!=null&&o.song&&(r(!1),setTimeout(()=>{p(`/mysongs/edit/${o==null?void 0:o.song.id}`)},300))},x={button:`w-[44px] h-[44px] bg-white/10 rounded-[99px] hover:scale-[1.05] transition-transform ${e.content_hover_bg}`,wrapper:`fixed inset-0 z-50 overflow-hidden text-white bg-zinc-900
    } transition-transform duration-[.7s] linear delay-100`,bg:"absolute inset-0 -z-10 brightness-[70%]",container:"absolute w-full top-0 bottom-[90px] flex flex-col",headerWrapper:"relative flex py-[25px] px-[40px] w-full items-center",content:"flex-grow relative overflow-hidden",songsListTab:" relative h-full no-scrollbar flex items-center flex-row overflow-auto scroll-smooth px-[calc(50%-350px/2)]",absoluteButton:`absolute top-[50%] -translate-y-[50%] p-[8px] bg-white/30 rounded-full ${e.content_hover_bg}`,lyricTabContainer:"px-[40px] min-[1536px]:container  min-[1536px]:px-[200px] h-full flex items-center justify-center flex-row",fadeTransition:"opacity-0 transition-opacity duration-[.3s]",logo:"animate-[spin_8s_linear_infinite] w-[46px] mr-1"},_=f.useMemo(()=>{if(o!=null&&o.song&&s.length)return s.map((B,F)=>{const $=B.queue_id===a;return $?c.jsx(Dp,{ref:m,classNames:"active",hasTitle:!0,onClick:()=>E(B.queue_id),active:$,data:B},F):c.jsx(Dp,{idleClass:`${!$&&i?x.fadeTransition:""}`,hasTitle:!0,active:$,data:B,onClick:()=>E(B.queue_id)},F)})},[o==null?void 0:o.song,s,i]);return c.jsxs("div",{className:`${x.wrapper}  ${n?"translate-y-0":"translate-y-full"}`,children:[c.jsx("div",{className:` ${x.bg}`,children:l&&c.jsx(Jh,{radioGroup:"",height:"100%",width:"100%",hash:((S=o==null?void 0:o.song)==null?void 0:S.blurhash_encode)||QR})}),c.jsxs("div",{className:x.container,children:[c.jsxs("div",{className:x.headerWrapper,children:[i&&c.jsx("div",{className:"absolute flex left-4",children:u!=="Songs"&&c.jsxs(c.Fragment,{children:[c.jsxs("p",{className:"font-playwriteCU text-sm",children:[((k=o==null?void 0:o.song)==null?void 0:k.name)||"..."," "]}),c.jsxs("p",{className:"opacity-70",children:[" - ",((b=o==null?void 0:o.song)==null?void 0:b.singer)||"..."]})]})}),c.jsx(sP,{inFullScreen:!0,activeTab:u,setActiveTab:d,className:`${i&&x.fadeTransition}`,tabs:["Songs","Karaoke","Lyric"],render:B=>B}),c.jsxs("div",{className:`absolute flex right-4 space-x-3 ${i&&x.fadeTransition}`,children:[((T=o==null?void 0:o.song)==null?void 0:T.by)!=="admin"&&u==="Lyric"&&c.jsx(Xr,{position:"top-[calc(100%+8px)]",content:"Edit lyrics",children:c.jsx("button",{onClick:()=>y(),className:`p-3 ${x.button}`,children:c.jsx(RB,{})})}),c.jsxs(go,{children:[c.jsx(yo,{children:c.jsx(Xr,{position:"top-[calc(100%+8px)]",content:"Settings",children:c.jsx("button",{className:`${x.button} p-3`,children:c.jsx(IB,{})})})}),c.jsx(vo,{appendTo:"parent",className:"top-[calc(100%+8px)] right-0 z-[99]",animationClassName:"origin-top-right",children:c.jsx(KR,{})})]}),c.jsx(Xr,{position:"top-[calc(100%+8px)]",content:"Close",children:c.jsx("button",{onClick:()=>r(!1),className:`p-2 ${x.button}`,children:c.jsx(xB,{})})})]})]}),c.jsxs("div",{className:x.content,children:[c.jsx("div",{ref:h,className:`song-list-container ${x.songsListTab} ${u!=="Songs"?"opacity-0":"opacity-100"}`,children:_}),u==="Songs"&&!i&&c.jsxs(c.Fragment,{children:[c.jsx(V,{hover:"scale",size:"clear",onClick:()=>w(),className:`${x.absoluteButton} left-[20px]`,children:c.jsx(hR,{className:"w-[30px]"})}),c.jsx(V,{hover:"scale",size:"clear",onClick:()=>g(),className:`${x.absoluteButton} right-[20px]`,children:c.jsx(kB,{className:"w-[30px]"})})]}),c.jsxs(FA,{children:[c.jsx("div",{className:`absolute inset-0 z-20 ${u==="Lyric"?"":"hidden"}`,children:c.jsxs("div",{className:x.lyricTabContainer,children:[c.jsx(Dp,{active:!0,data:o==null?void 0:o.song}),c.jsx(nP,{className:"w-full ml-[40px] h-full",active:n&&u==="Lyric"})]})}),c.jsx("div",{className:`absolute inset-0 z-20 flex flex-col items-center justify-center ${u==="Karaoke"?"":"hidden"}`,children:c.jsx(vq,{active:n&&u==="Karaoke"})})]})]}),u!=="Songs"&&c.jsxs("p",{className:`text-center ${i&&x.fadeTransition}`,children:[((P=o==null?void 0:o.song)==null?void 0:P.name)||"...",c.jsxs("span",{className:"opacity-70",children:[" - ",((N=o==null?void 0:o.song)==null?void 0:N.singer)||"..."]})]})]})]})}function tx({audioEle:t,progressLineRef:e}){const{theme:n}=H(),[r,i]=f.useState("paused"),[s,a]=f.useState(!1),o=f.useRef(""),l=f.useRef(r),u=()=>{try{t.play(),a(!0)}catch{}},d=()=>{t==null||t.pause(),p()},h=()=>{r==="playing"?d():r==="paused"&&u()},m=()=>{i("playing")},p=()=>{i("paused")},g=_=>{if(!t)return;const S=+(_||t.currentTime/t.duration*100).toFixed(1);e!=null&&e.current&&(e.current.style.background=Z1(o.current,S))},w=()=>{const S=t.currentTime/(t.duration/100);g(+S.toFixed(1))},E=()=>{console.log("error"),i("error")},v=_=>{t.currentTime=_,g(),r!=="playing"&&u()},y=_=>{t.currentTime=t.currentTime+_},x=_=>{t.currentTime=t.currentTime-_};return f.useEffect(()=>{if(t)return t.addEventListener("error",E),t.addEventListener("pause",p),t.addEventListener("playing",m),e!=null&&e.current&&t.addEventListener("timeupdate",w),()=>{t.removeEventListener("error",E),t.removeEventListener("pause",p),t.removeEventListener("playing",m),e!=null&&e.current&&t.removeEventListener("timeupdate",w)}},[t]),f.useEffect(()=>{o.current=n.content_code,r!=="playing"&&g()},[n]),f.useEffect(()=>{l.current=r},[r]),{play:u,pause:d,seek:v,handlePlayPause:h,status:r,forward:y,backward:x,isClickPlay:s,statusRef:l}}const wq=()=>{const[t,e]=f.useState(),[n,r]=f.useState(""),[i,s]=f.useState([]),[a,o]=f.useState([]),[l,u]=f.useState(!1),[d,h]=f.useState(!1),[m,p]=f.useState(),g=f.useRef(0);return{song:t,setSong:e,baseLyric:n,setBaseLyric:r,baseLyricArr:i,setBaseLyricArr:s,lyrics:a,setLyrics:o,updateLyric:(E,v)=>{o(y=>{const x={...y[E],...v};return y[E]=x,[...y]})},isFetching:l,setIsFetching:u,isChanged:d,setIsChanged:h,start:g,selectLyricIndex:m,setSelectLyricIndex:p}},JR=f.createContext(null);function ZR({children:t}){return c.jsx(JR.Provider,{value:wq(),children:t})}const sa=()=>{const t=f.useContext(JR);if(!t)throw new Error("Edit lyric context not found");return t};function _q({audioEle:t,isClickPlay:e,song:n}){const{start:r,baseLyricArr:i,lyrics:s,setLyrics:a,setIsChanged:o,setIsFetching:l,baseLyric:u}=sa(),{setErrorToast:d,setSuccessToast:h}=sr(),m=s.length>=i.length,p=e&&!!i.length&&!m;return{addLyric:()=>{if(!t||!i.length||m)return;const v=+t.currentTime.toFixed(1);if(r.current===v)return;const y=i[s.length],x={start:r.current,text:y,end:v};r.current=v,a(_=>[..._,x]),o(!0)},removeLyric:()=>{if(s.length&&t){const v=s[s.length-1].start;r.current=v,t.currentTime=v,a(y=>y.slice(0,-1)),o(!0)}},isEnableAddBtn:p,submit:async()=>{try{if(l(!0),!n)return;const v={real_time:JSON.stringify(s),base:u};await mn({collection:"lyrics",data:v,id:n.id}).catch(()=>{throw{...v,id:n.id}}),h("Add lyric successful"),o(!1),kt("temp-lyric","")}catch(v){kt("temp-lyric",{...v,real_time:JSON.stringify(v.real_time)}),d()}finally{l(!1)}}}}function Eq({submit:t,title:e,initValue:n,loading:r,variant:i="input",children:s}){const{theme:a}=H(),[o,l]=f.useState(n||""),u=f.useRef(null);f.useEffect(()=>{var m;(m=u.current)==null||m.focus()},[]);const d=m=>{m.preventDefault(),t(o)},h={input:`bg-${a.alpha} w-full py-2 text-lg rounded-lg outline-none px-2 mt-3`};return c.jsxs("div",{className:"w-[500px] max-w-[85vw]",children:[c.jsx("h1",{className:"text-xl font-medium ",children:e||"Title"}),c.jsxs("form",{action:"",onSubmit:d,children:[i==="input"&&c.jsx("input",{className:"w-full",ref:u,placeholder:"name...",value:o,onChange:m=>l(m.target.value)}),i==="text-area"&&c.jsx("textarea",{ref:u,className:`${h.input} min-h-[50vh] no-scrollbar`,value:o,onChange:m=>l(m.target.value)}),s,c.jsx("div",{className:"flex space-x-2 mt-5",children:c.jsx(V,{className:`${a.content_bg} rounded-full`,isLoading:r,type:"submit",children:"Save"})})]})]})}const Sq="/HD-MP3/assets/tutorial1-1bb11af6.png";function PS(t,e){const[n,r]=f.useState(t),i=f.useRef(!1);return f.useEffect(()=>{const s=Yn()[e]||t;r(s)},[]),f.useEffect(()=>{if(!i.current){i.current=!0;return}kt(e,n)},[n]),[n,r]}function kq({audioEle:t,postLocalStorageKey:e}){const[n,r]=PS(1,`audio_speed_${e}`),[i,s]=PS(100,`audio_volume_${e}`);return f.useEffect(()=>{t.volume=i/100,t.playbackRate=n},[i,n]),{speed:n,setSpeed:r,volume:i,setVolume:s}}function eP({className:t,...e}){const{theme:n}=H(),{speed:r,volume:i,setVolume:s,setSpeed:a}=kq(e);return console.log("render"),c.jsxs(go,{children:[c.jsx(yo,{children:c.jsx(V,{className:`${n.content_bg} rounded-full ${t||""}`,children:c.jsx(cb,{className:"w-6"})})}),c.jsx(vo,{className:"top-[calc(100%+8px)] left-0 z-[9]",appendTo:"parent",children:c.jsx(Ys,{className:"w-[240px]",theme:n,children:c.jsxs("div",{className:"space-y-[6px]",children:[c.jsxs("div",{className:"flex space-x-1",children:[c.jsxs("div",{className:"w-[110px] flex-shrink-0",children:["Speed ",r,"x"]}),c.jsx("input",{className:"w-full",type:"range",step:.1,min:1,max:1.5,value:r,onChange:o=>a(+o.target.value)})]}),c.jsxs("div",{className:"flex space-x-1",children:[c.jsxs("div",{className:"w-[110px] flex-shrink-0",children:["Volume ",i,"%"]}),c.jsx("input",{className:"w-full",type:"range",step:1,min:1,max:100,value:i,onChange:o=>s(+o.target.value)})]})]})})})]})}function bq({audioEle:t},e){const{theme:n}=H(),{baseLyric:r,setBaseLyric:i,setIsChanged:s,song:a,lyrics:o}=sa(),[l,u]=f.useState(""),d=f.useRef(null),h=f.useRef(null),{backward:m,forward:p,handlePlayPause:g,pause:w,seek:E,status:v,isClickPlay:y}=tx({audioEle:t,progressLineRef:h}),{addLyric:x,removeLyric:_,isEnableAddBtn:S,submit:k}=_q({audioEle:t,isClickPlay:y,song:a});f.useImperativeHandle(e,()=>({seek:E,pause:w,submit:k}));const b=()=>{if(!y&&o.length){const L=o[o.length-1].end;t.currentTime=L}g()},T=()=>{var L;return(L=d.current)==null?void 0:L.toggle()},P=L=>{var Oe;u(L),(Oe=d.current)==null||Oe.toggle()},N=()=>{if(l)switch(l){case"base-lyric":return c.jsx(Eq,{variant:"text-area",title:"Edit lyric",initValue:r,submit:B});case"tutorial":return c.jsxs("div",{className:"w-[500px] max-w-[90vw]",children:[c.jsx(Or,{title:"Tutorial",close:T}),c.jsx("div",{className:"h-[500px] max-h-[75vh] overflow-y-auto no-scrollbar",children:c.jsx("img",{className:"w-full border rounded-[16px]",src:Sq,alt:""})})]})}},B=L=>{i(L),s(!0),T()},F={button:`mt-2 ml-2 space-x-1 ${n.content_bg} rounded-full`,icon:"w-6",arrow:"before:content-[''] before:absolute before:-translate-x-1/2 before:left-[27px]  before:bottom-[calc(100%-1px)] before:z-[-1] before:border-8 before:border-transparent before:border-b-amber-800"},$=()=>{switch(v){case"error":return c.jsx(Bh,{className:"w-6"});case"playing":return c.jsx(Yy,{className:"w-6"});case"paused":return c.jsx(Rd,{className:"w-6"});case"waiting":return c.jsx(rs,{className:"w-6 animate-spin"})}};return c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex items-start flex-wrap -mt-2 -ml-2",children:[c.jsx(eP,{className:"mt-2 ml-2",audioEle:t,postLocalStorageKey:"edit_lyric"}),c.jsx(V,{className:F.button,onClick:b,children:$()}),c.jsxs(V,{disabled:!S,onClick:x,className:F.button,children:[c.jsx(Xn,{className:"w-6"}),c.jsx("span",{children:"Add"})]}),c.jsxs(V,{disabled:!o.length,onClick:_,className:F.button,children:[c.jsx(hb,{className:"w-6"}),c.jsx("span",{children:"Remove"})]}),c.jsxs(V,{onClick:()=>m(2),className:F.button,children:[c.jsx(Xy,{className:"w-6"}),c.jsx("span",{children:"2s"})]}),c.jsxs(V,{onClick:()=>p(2),className:F.button,children:[c.jsx("span",{children:"2s"}),c.jsx(Vh,{className:"w-6"})]}),c.jsxs(V,{onClick:()=>P("base-lyric"),className:F.button,children:[c.jsx(ub,{className:"w-6"}),c.jsx("span",{children:"Edit lyric"})]}),c.jsx("button",{onClick:()=>P("tutorial"),className:"self-center ml-auto mt-2",children:c.jsx(dj,{className:"w-6"})})]}),c.jsx("div",{ref:h,style:{backgroundColor:"rgba(255,255,255,.3)"},className:"h-1 rounded-full mt-3 w-full"}),c.jsx(Dr,{variant:"animation",ref:d,children:N()})]})}const Tq=f.forwardRef(bq);function Iq(){const{lyrics:t}=sa(),e=f.useRef(null);return f.useEffect(()=>{e.current&&Lb(e.current)},[t.length]),{activeLyricRef:e}}function Cq({controlRef:t,modalRef:e}){const{theme:n}=H(),{baseLyricArr:r,lyrics:i,setSelectLyricIndex:s,song:a}=sa(),{activeLyricRef:o}=Iq(),l=h=>{var m;(m=t.current)==null||m.seek(h)},u=h=>{var m;typeof h=="number"&&(s(h),(m=e.current)==null||m.open())},d=()=>n.type==="dark"?"bg-white/10":"bg-black/10";return c.jsx(c.Fragment,{children:c.jsxs("div",{className:`flex flex-grow overflow-auto no-scrollbar text-[18px] rounded-xl pt-3 mt-3 ${d()}`,children:[c.jsx("div",{className:"w-1/2 px-2",children:r.length?c.jsx(c.Fragment,{children:r.map((h,m)=>{let p=m===i.length?"active":m<i.length-1?"done":"coming";return m===r.length-1&&(p="active"),c.jsx(fR,{ref:p==="active"?o:null,activeColor:n.type==="light"?n.content_text:"",className:"pt-[37px] mr-[24px]",status:p,text:h},m)})}):c.jsx("p",{children:"..."})}),c.jsx("div",{className:"w-1/2 px-2 ",children:!!(i!=null&&i.length)&&a&&i.map((h,m)=>c.jsx(oq,{openModal:()=>u(m),seek:l,lyric:h,isLast:m===i.length-1&&m!==r.length-1,theme:n},m))})]})})}function Aq({audioRef:t,admin:e}){const{user:n}=ln(),{baseLyric:r,setSong:i,song:s,setBaseLyricArr:a,setBaseLyric:o,setLyrics:l,isChanged:u,setIsChanged:d,isFetching:h,start:m}=sa(),[p,g]=f.useState(),[w,E]=f.useState(!0),v=f.useRef(!1),y=Ky(),x=ir(),_=async()=>{try{const S=await uo({collection:"songs",id:y==null?void 0:y.id});if(!S.exists())return x(e?"/dashboard":"/");const k=S.data();if(k){const b=await uo({collection:"lyrics",id:k.id});if(b.exists()){const T=b.data(),P=typeof T.real_time=="string"?JSON.parse(T.real_time):T.real_time;g({base:T.base,id:T.id,real_time:P})}}i(k)}catch(S){console.log({message:S})}finally{E(!1)}};return f.useEffect(()=>{n&&(v.current||(v.current=!0,_()))},[n]),f.useEffect(()=>{const S=Yn()["temp-lyric"]||null;if(S&&S.id===(s==null?void 0:s.id))try{const k={...S,real_time:JSON.parse(S.real_time)};(s==null?void 0:s.id)===k.id&&(g(k),d(!0));return}catch(k){console.log({message:k})}},[s]),f.useEffect(()=>{if(p){const{base:S,real_time:k}=p;if(o(S),l(k),!k.length)return;const b=k.length-1;if(t.current){const T=k[b].end;m.current=T}}},[p]),f.useEffect(()=>{if(!r)return;const S=r.split(/\r?\n/).filter(k=>k);a(S)},[r]),f.useEffect(()=>{if(!u)return;const S=k=>{k.preventDefault()};return window.addEventListener("beforeunload",S),()=>{window.removeEventListener("beforeunload",S)}},[u]),{isFetching:w,song:s,isChanged:u,isSubmitting:h}}function Rq(){const{updateLyric:t,setIsChanged:e,lyrics:n,selectLyricIndex:r}=sa();if(r===void 0)throw new Error("");const[i,s]=f.useState([]),[a,o]=f.useState([]),[l,u]=f.useState(!1),[d,h]=f.useState(!1),m=f.useRef(null),p=f.useRef(null),g=f.useRef(null),w=f.useRef(null),E=f.useRef(null),v=f.useRef(0),y=f.useRef(0),x=f.useRef(null),_=f.useRef(null),S=f.useRef(null),k=f.useRef([]),b=f.useRef([]),T=f.useRef(!1),P=f.useMemo(()=>n[r],[r,n]),{play:N,pause:B,status:F,statusRef:$}=tx({audioEle:g.current}),L=ae=>{r&&(ae.preventDefault(),m.current&&t(r,{text:m.current.value}))},Oe=()=>{console.log("update tune");const ae={start:y.current,end:v.current,grow:a.join("_")};t(r,{tune:ae}),e(!0)},nt=ae=>{ae.variant==="range"&&ae.value<1||(T.current=!0,o(lt=>{const vt=[...lt];let Xe=vt[ae.index];switch(ae.variant){case"range":Xe=ae.value;break;case"button":Xe=+(ae.action==="minus"?Xe-.2:Xe+.2).toFixed(1)}return vt[ae.index]=Xe,vt}))},De=()=>{B(),p.current&&(p.current.style.animation="none")},D=()=>{if(!g.current||!p.current)return;const ae=g.current;ae.currentTime=y.current-.3;const lt=XR(b.current,k.current);p.current.style.animation=`${lt} ${((v.current-y.current)/g.current.playbackRate).toFixed(1)}s linear`,N()},G=()=>{$.current==="paused"?D():De()},Y=ae=>{const lt=+ae.toFixed(1);T.current=!0,v.current=lt,_.current&&(_.current.textContent=`${lt} / ${P.end}`)},Se=ae=>{const lt=+ae.toFixed(1);T.current=!0,y.current=lt,x.current&&(x.current.textContent=`${P.start} / ${lt}`)},le=()=>{if(g.current&&+g.current.currentTime.toFixed(1)>=v.current)return De()},cn=ae=>{ae.key===" "&&(ae.preventDefault(),G())};return f.useEffect(()=>(window.addEventListener("keydown",cn),()=>{window.removeEventListener("keydown",cn)}),[d]),f.useEffect(()=>{h(!0)},[]),f.useEffect(()=>{if(!i.length||!S.current)return;const ae=YR(S.current);k.current=ae},[i]),f.useEffect(()=>{b.current=a},[a]),f.useEffect(()=>{if(g.current)return g.current.addEventListener("timeupdate",le),g.current.playbackRate=1.2,()=>{var ae;(ae=g.current)==null||ae.removeEventListener("timeupdate",le)}},[d]),f.useEffect(()=>{const lt=P.text.trim().split(" ").filter(Xe=>Xe);s(lt);const vt=P!=null&&P.tune?P.tune.grow.split("_").map(Xe=>+Xe):[];lt.forEach((Xe,Mo)=>{typeof vt[Mo]!="number"&&(vt[Mo]=1)}),o(vt),_.current&&x.current&&E.current&&w.current&&(y.current=P!=null&&P.tune?P.tune.start:P.start,x.current.innerText=`${P.start} / ${y.current}`,E.current.max=P.end+"",E.current.value=y.current+"",v.current=P!=null&&P.tune?P.tune.end:P.end,_.current.innerText=`${v.current} / ${P.end}`,w.current.max=P.end+"",w.current.value=v.current+"")},[r]),{refs:{overlayRef:p,tempWordRef:S,textRef:m,endTimeRangeRef:w,startTimeRangeRef:E,startRefText:x,endRefText:_,audioRef:g,isChanged:T},pause:B,setStartPoint:Se,words:i,isEdit:l,setIsEdit:u,handlePlayPause:G,growList:a,handleGrowWord:nt,setEndPoint:Y,handleUpdateLyricText:L,status:F,updateLyricTune:Oe,currentLyric:P}}function Pq({closeModal:t}){const{theme:e}=H(),{setSelectLyricIndex:n,selectLyricIndex:r,lyrics:i,song:s}=sa(),[a,o]=f.useState(0),l=f.useRef(null),{handlePlayPause:u,status:d,pause:h,setStartPoint:m,refs:p,isEdit:g,setIsEdit:w,setEndPoint:E,growList:v,words:y,handleGrowWord:x,handleUpdateLyricText:_,updateLyricTune:S,currentLyric:k}=Rq(),b=()=>{S(),t()},T=$=>{var L;o($),(L=l.current)==null||L.focus()},P=$=>{if(typeof r=="number")switch(p.isChanged.current&&(p.isChanged.current=!1,S()),h(),$){case"next":if(r===i.length-1)return;n(L=>L+1);break;case"prev":if(r===0)return;n(L=>L-1);break}},N=()=>y.map(($,L)=>c.jsx(V,{style:{flexGrow:v[L]},onClick:()=>T(L),size:"clear",className:`justify-center ${e.side_bar_bg} border border-${e.alpha} ${a===L?e.content_bg:""}`,children:$},L)),B=()=>{switch(d){case"playing":return c.jsx(Yy,{className:"w-6"});case"paused":return c.jsx(Rd,{className:"w-6"})}},F={input:`bg-${e.alpha} text-lg rounded-[4px] outline-none w-full px-2 py-1`,button:`${e.content_bg} rounded-full`};return c.jsxs(c.Fragment,{children:[c.jsx("audio",{ref:p.audioRef,src:s==null?void 0:s.song_url,className:"hidden"}),c.jsxs("div",{className:"max-w-[90vw] w-[600px]",children:[c.jsx(Or,{close:t,title:"Edit lyric"}),c.jsx("div",{ref:p.tempWordRef,className:"inline-block opacity-0",children:y.map(($,L)=>c.jsx("span",{className:"leading-[1] inline-block",children:$},L))}),c.jsxs("div",{className:"flex items-center space-x-2 mt-[-20px]",children:[c.jsx(V,{onClick:u,className:F.button,children:B()}),p.audioRef.current&&c.jsx(eP,{audioEle:p.audioRef.current,postLocalStorageKey:"edit_lyric_tune"}),g?c.jsxs(c.Fragment,{children:[c.jsx(V,{onClick:()=>w(!1),className:F.button,children:c.jsx(js,{className:"w-6"})}),c.jsx(V,{onClick:_,className:F.button,children:c.jsx(Uh,{className:"w-6"})})]}):c.jsx(V,{onClick:()=>w(!0),className:F.button,children:c.jsx(Lg,{className:"w-6"})})]}),c.jsxs("div",{className:"flex items-center mt-5 space-x-2",children:[c.jsxs("label",{htmlFor:"start",className:"flex-shrink-0 w-[150px]",children:["Start: ",c.jsx("span",{ref:p.startRefText})]}),c.jsx("input",{ref:p.startTimeRangeRef,type:"range",id:"start",min:k.start,max:k.end,step:.2,className:"w-full",onChange:$=>m(+$.target.value)})]}),c.jsxs("div",{className:"flex items-center mt-3 space-x-2",children:[c.jsxs("label",{htmlFor:"end",className:"flex-shrink-0 w-[150px]",children:["End: ",c.jsx("span",{ref:p.endRefText})]}),c.jsx("input",{id:"end",ref:p.endTimeRangeRef,type:"range",min:k.start,step:.2,className:"w-full",onChange:$=>E(+$.target.value)})]}),c.jsxs("div",{className:"flex items-center mt-3",children:[c.jsxs("label",{htmlFor:"grow",className:"flex-shrink-0 w-[150px] mr-2 leading-[1]",children:["Grow: ",v[a]]}),c.jsx("input",{ref:l,type:"range",id:"grow",min:1,max:30,step:.2,className:"w-full",value:v[a]+"",onChange:$=>x({variant:"range",value:+$.target.value,index:a})})]}),c.jsx("div",{className:"flex justify-center items-center space-x-2 mt-5",children:g?c.jsx("form",{action:"",onSubmit:_,children:c.jsx("textarea",{ref:p.textRef,className:F.input})}):c.jsx(c.Fragment,{children:c.jsxs("div",{className:"relative whitespace-nowrap  sm:text-2xl font-[700]",children:[k.text,c.jsx("div",{ref:p.overlayRef,className:"absolute  top-0 left-0 overflow-hidden text-[#ffed00] whitespace-nowrap w-0",children:k.text})]})})}),c.jsx("div",{className:"flex h-[60px] mt-3",children:N()}),c.jsxs("div",{className:"flex justify-end space-x-2",children:[c.jsxs(V,{onClick:()=>P("prev"),className:`${e.content_bg} font-playwriteCU space-x-1 rounded-full mt-5`,children:[c.jsx(Xy,{className:"w-6"}),c.jsx("span",{children:"Previous"})]}),c.jsxs(V,{onClick:()=>P("next"),className:`${e.content_bg} font-playwriteCU space-x-1 rounded-full mt-5`,children:[c.jsx("span",{children:"Next"}),c.jsx(Vh,{className:"w-6"})]}),c.jsx(V,{onClick:b,className:`${e.content_bg} font-playwriteCU rounded-full mt-5`,children:"Ok"})]})]})]})}function Nq({children:t,className:e,...n},r){const i=n.variant||"default",{theme:s}=H(),[a,o]=f.useState(i==="default"),[l,u]=f.useState(i==="default"),[d,h]=f.useState(!1),m=()=>{l&&u(!1),a||o(!0)},p=()=>{o(!0)},g=()=>{u(!1),h(!1)},w=y=>{h(y)},E=y=>{y.preventDefault(),y.stopPropagation(),!d&&(i==="default"&&n.closeModal&&n.closeModal(),i==="animation"&&m())};f.useImperativeHandle(r,()=>({toggle:m,close:g,open:p,setModalPersist:w})),f.useEffect(()=>{i!=="default"&&(l||setTimeout(()=>{o(!1)},400))},[l]),f.useEffect(()=>{i!=="default"&&a&&setTimeout(()=>{u(!0)},100)},[a]);const v={unMountedContent:"opacity-0 scale-[.95]",mountedContent:"opacity-100 scale-[1]",unMountedLayer:"opacity-0",mountedLayer:"opacity-60"};return c.jsx(c.Fragment,{children:a&&Eo.createPortal(c.jsxs("div",{className:"fixed inset-0 z-[99]",children:[c.jsx("div",{onClick:E,className:`transition-opacity duration-300 absolute bg-black inset-0 z-[90]
                             ${l?v.mountedLayer:v.unMountedLayer}
                        `}),c.jsx("div",{className:`absolute duration-300 transition-[transform,opacity] z-[99] top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2
                            ${l?v.mountedContent:v.unMountedContent}
                        `,children:c.jsx(Ys,{className:e||"",theme:s,children:t})})]}),document.getElementById("portals"))})}const Dr=f.forwardRef(Nq);function tP({admin:t,children:e}){const{theme:n}=H(),r=f.useRef(null),i=f.useRef(null),s=f.useRef(null),{isFetching:a,song:o,isChanged:l,isSubmitting:u}=Aq({audioRef:i,admin:t}),d=()=>{var h,m;(h=r.current)==null||h.pause(),(m=r.current)==null||m.submit()};return c.jsxs(c.Fragment,{children:[c.jsx("audio",{className:"hidden",ref:i,src:o==null?void 0:o.song_url}),a?c.jsx(_h,{children:c.jsx(rs,{className:"w-6 animate-spin"})}):o&&c.jsxs("div",{className:"flex flex-col h-full pb-5",children:[e,c.jsxs("h1",{className:"text-xl font-playwriteCU mt-3 leading-[2.2]",children:["Edit lyric - ",o==null?void 0:o.name]}),c.jsx("div",{className:"mt-3",children:i.current&&c.jsxs(c.Fragment,{children:[c.jsx(Tq,{audioEle:i.current,ref:r}),c.jsx(Dr,{variant:"animation",ref:s,children:c.jsx(Pq,{closeModal:()=>{var h;return(h=s.current)==null?void 0:h.close()}})})]})}),c.jsx(Cq,{modalRef:s,controlRef:r}),c.jsx(V,{className:`${n.content_bg} font-playwriteCU self-start rounded-full mt-5 `,variant:"primary",disabled:!l,isLoading:u,onClick:d,children:"Save"})]})]})}const ju=.3;function jq({active:t}){const{audioRef:e}=Qt();if(!e.current)throw new Error("useSongLyric !audioRef.current");const[n,r]=f.useState(0),i=f.useRef("instant"),s=f.useRef(null),a=f.useRef(0),o=f.useRef([]),l=f.useRef(0),{loading:u,songLyrics:d}=yR({active:t}),h=()=>{const m=e.current.currentTime>a.current?"forward":"backward";a.current=e.current.currentTime;let p=l.current;switch(m){case"forward":for(;d[p+1]&&d[p+1].start-ju<a.current+ju;)p+=1;break;case"backward":for(;d[p-1]&&d[p-1].end-ju>a.current+ju;)p-=1;break}p!==l.current&&(Math.abs(p-l.current)>5&&(i.current="instant"),l.current=p,r(p),Lb(o.current[p],i.current),i.current==="instant"&&(i.current="smooth"))};return f.useEffect(()=>{h()},[t]),f.useEffect(()=>{if(!(!t||!d.length))return e.current.addEventListener("timeupdate",h),()=>{e.current.removeEventListener("timeupdate",h)}},[t,d]),f.useEffect(()=>()=>{r(0),l.current=0},[d]),{songLyrics:d,loading:u,currentIndex:n,containerRef:s,lyricRefs:o,scrollBehavior:i}}const nP=({className:t,active:e})=>{const{lyricSize:n}=oe(zn),{loading:r,songLyrics:i,currentIndex:s,containerRef:a,lyricRefs:o}=jq({active:e}),l={small:"text-[20px] sm:text-[30px]",medium:"text-[25px] sm:text-[35px]",large:"text-[30px] sm:text-[40px]"},u=()=>i.map((h,m)=>{let p="coming";return s===m?p="active":m<s&&(p="done"),c.jsx(fR,{ref:g=>o.current[m]=g,status:p,text:h.text,className:" mb-[30px] last:mb-[50vh]"},m)}),d={container:"no-scrollbar pt-[20px] mask-image overflow-y-auto overflow-x-hidden"};return c.jsxs("div",{ref:a,className:`${d.container} ${l[n||"medium"]} ${t}`,children:[r&&c.jsx("div",{className:"relative w-full h-full",children:c.jsx(_h,{children:c.jsx(rs,{className:"w-7 animate-spin"})})}),!r&&c.jsx(c.Fragment,{children:i.length?u():c.jsx("div",{className:"relative w-full h-full",children:c.jsx(_h,{children:c.jsx("h1",{className:"text-[30px] opacity-60",children:"..."})})})})]})},Oq=()=>{const{theme:t}=H(),{controlRef:e,isOpenFullScreen:n,setIsOpenFullScreen:r}=Qt(),{playStatus:i}=oe(zn),{currentSongData:s}=oe(It),a=Rr(),o=f.useMemo(()=>a.pathname.includes("edit"),[a]),l=f.useMemo(()=>{switch(i){case"playing":return c.jsx(Hh,{className:"w-10"});case"error":return c.jsx(Bh,{className:"w-10"});case"loading":case"waiting":return c.jsx(rs,{className:"w-10 animate-spin"});case"paused":return c.jsx(Wh,{className:"w-10"})}},[i]),u={wrapper:`fixed bottom-0 transition-transform w-full h-[80px] border-t border-${t.alpha} z-40  px-4`,container:`absolute inset-0 ${t.bottom_player_bg} bg-opacity-[0.7] backdrop-blur-[15px] z-[-1]`,songImageWrapper:"flex flex-row items-center flex-grow h-full",image:"w-[54px] h-[54px] flex-shrink-0",cta:"pl-2 flex-shrink-0"};return c.jsxs("div",{className:`${u.wrapper} ${o?"translate-y-full":""}`,children:[c.jsx("div",{className:`${u.container} ${n?"opacity-0 transition-opacity delay-[.3s]":""}`}),c.jsxs("div",{className:"flex items-center  h-full",children:[c.jsx("div",{onClick:()=>s!=null&&s.song.name?r(!0):{},className:"mobile-current-song flex-grow",children:c.jsxs("div",{className:u.songImageWrapper,children:[c.jsx("div",{className:u.image,children:c.jsx(Nr,{src:s==null?void 0:s.song.image_url,className:"rounded-full"})}),c.jsx("div",{className:"flex-grow  ml-[10px]",children:(s==null?void 0:s.song.song_url)&&c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"h-[30px] relative overflow-hidden",children:c.jsx("div",{className:"absolute left-0 whitespace-nowrap font-playwriteCU leading-[1.5]",children:(s==null?void 0:s.song.name)||"name"})}),c.jsx("p",{className:"opacity-70 line-clamp-1",children:(s==null?void 0:s.song.singer)||"singer"})]})})]})}),c.jsxs("div",{className:`${u.cta} ${!(s!=null&&s.song.name)&&"disable"}`,children:[c.jsx("button",{className:"p-[4px]",onClick:()=>{var d;return(d=e.current)==null?void 0:d.handlePlayPause()},children:l}),c.jsx("button",{onClick:()=>{var d;return(d=e.current)==null?void 0:d.handleNext()},className:"p-[4px]",children:c.jsx(Vh,{className:"w-10"})})]})]})]})},Dq=t=>{let e=0,n=t;for(;!n.classList.contains("target-class")&&e<5;)n=n.parentElement,e++;return n},rP={opacity:"0",transform:"translate(-100%, 0)"},Mq=t=>{let e=0,n=t.previousElementSibling;for(;n&&e<100;)Object.assign(n.style,rP),e++,n=n.previousElementSibling};function Lq({currentIndex:t}){const e=Zt(),{theme:n}=H(),{queueSongs:r}=oe(It),i=(a,o)=>{const l=a.target,u=Dq(l);Mq(u),Object.assign(u.style,rP),setTimeout(()=>{e(Ji(o))},500)},s=()=>c.jsx(c.Fragment,{children:t===r.length-1||r.length<=1?c.jsx("p",{children:"..."}):r.map((a,o)=>{if(o>t)return c.jsx(Qb,{variant:"playing-next",theme:n,song:a,onClick:l=>i(l,a.queue_id)},o)})});return c.jsx(c.Fragment,{children:c.jsx(Js,{children:s()})})}function Fq({isOpenFullScreen:t}){const e=f.useRef(null);f.useEffect(()=>{const r=e.current;r&&(t?(r.style.transform="translate(0)",r.style.zIndex="99"):(r.style.transform="translate(0, 100%)",setTimeout(()=>{r.style.zIndex="-10"},500)))},[t]);const n=()=>{const r=document.querySelector("body");r&&(t?r.style.overflow="hidden":r.style.overflow="auto")};return f.useEffect(()=>{n()},[t]),{wrapperRef:e}}function $q(){const{controlRef:t,setIsOpenFullScreen:e,isOpenFullScreen:n}=Qt(),{currentSongData:r}=oe(It),{songBackground:i}=oe(zn),[s,a]=f.useState("Playing"),o=f.useRef(null),{wrapperRef:l}=Fq({isOpenFullScreen:n}),u={headerWrapper:"flex mb-4",container:"flex-grow flex flex-col relative overflow-hidden",control:"flex flex-col-reverse justify-center",bgImage:"absolute inset-0 z-[-9] brightness-[70%] blur-[4px] translate-3d-0",button:"flex justify-center items-center rounded-full w-[38px]"};return c.jsx(c.Fragment,{children:c.jsxs("div",{ref:l,style:{transform:"translate(0, 100%)",zIndex:"-10"},className:"fixed inset-0 bg-zinc-900 text-white overflow-hidden transition-[transform] duration-[.3s] ease-linear",children:[i&&c.jsx("div",{className:u.bgImage,children:c.jsx(Jh,{width:"100%",height:"100%",hash:(r==null?void 0:r.song.blurhash_encode)||QR})}),c.jsxs("div",{className:"h-full z-10 p-4 flex flex-col",children:[c.jsxs("div",{className:u.headerWrapper,children:[c.jsxs(go,{appendOnPortal:!0,children:[c.jsx(yo,{children:c.jsx("button",{className:`${u.button} p-[6px] left-0 bg-gray-500 bg-opacity-20`,children:c.jsx(cb,{className:"w-full"})})}),c.jsx(vo,{appendTo:"portal",position:"right-bottom",origin:"top left",children:c.jsx(KR,{})})]}),c.jsx(sP,{inFullScreen:!0,className:"w-fit font-[500]",setActiveTab:a,activeTab:s,render:d=>d,tabs:["Songs","Playing","Lyric"]}),c.jsx("button",{className:`${u.button} p-[6px] bg-gray-500 bg-opacity-20`,onClick:()=>e(!1),children:c.jsx(f5,{className:"w-full"})})]}),c.jsxs("div",{ref:o,className:u.container,children:[c.jsxs("div",{className:`${s!="Playing"?"flex":"sm:flex"}`,children:[c.jsx(nG,{expand:s==="Playing",imageUrl:r==null?void 0:r.song.image_url}),c.jsxs("div",{className:`ml-2 ${s!="Playing"?"block":"hidden sm:block"}`,children:[c.jsx("p",{className:"font-playwriteCU translate-y-[-6px] leading-[2.4] line-clamp-1",children:r==null?void 0:r.song.name}),c.jsx("div",{className:"opacity-70 translate-y-[-4px] leading-[1] line-clamp-1",children:r==null?void 0:r.song.singer})]})]}),c.jsxs("div",{className:`mt-5 justify-between items-center ${s!="Playing"?"hidden":"flex sm:hidden"}`,children:[c.jsxs("div",{className:"flex-grow",children:[c.jsx("div",{className:"h-[40px]",children:c.jsx(Eh,{autoScroll:!0,className:"text-xl leading-[1.5] font-playwriteCU",content:(r==null?void 0:r.song.name)||"..."})}),c.jsx("div",{className:"h-[28px]",children:c.jsx(Eh,{autoScroll:!0,className:`opacity-60 ${s==="Playing"?"text-lg":"text-base"}`,content:(r==null?void 0:r.song.singer)||"..."})})]}),c.jsx(qR,{})]}),c.jsx(FA,{children:c.jsx(nP,{active:n&&s==="Lyric",className:`text-center ${s==="Lyric"?"flex-1 block":"hidden"}`})}),c.jsx("div",{className:`leading-[2.2] font-playwriteCU my-2 ${s==="Songs"?"":"hidden"}`,children:"Playing next"}),c.jsx("div",{className:`flex-grow no-scrollbar overflow-auto ${s==="Songs"?"":"hidden"}`,children:r&&c.jsx(Lq,{currentIndex:r.index})}),c.jsx("div",{className:`${u.control} ${s==="Songs"?"opacity-0 pointer-events-none h-[0px]":""} ${s==="Playing"?"flex-grow":""}`,children:c.jsx(GR,{variant:"mobile",ref:t})})]})]})]})})}function zq(){const{theme:t}=H(),{loading:e,user:n}=ln(),{logIn:r}=Mf(),i=async()=>{try{await r()}catch(a){console.log(a)}finally{}},s={icon:"w-7 mr-2 inline",linkItem:`py-3 border-b text-lg border-${t.alpha} last:border-none`,button:`${t.content_bg} rounded-full`};return c.jsxs("div",{className:"pb-[30px]",children:[c.jsx("div",{className:"text-xl font-playwriteCU leading-[2.2] mb-3",children:"Library"}),e?[...Array(3).keys()].map(a=>c.jsx(Ub,{},a)):c.jsx(c.Fragment,{children:n?c.jsxs(c.Fragment,{children:[c.jsx(Gm,{className:s.linkItem,to:xn.MySongs,icon:c.jsx(Ya,{className:s.icon+t.content_text}),label:"All songs",arrowIcon:c.jsx($m,{className:"w-6"})}),c.jsx(Gm,{className:s.linkItem,to:xn.MySongs,icon:c.jsx(O5,{className:s.icon+t.content_text}),label:"Favorite",arrowIcon:c.jsx($m,{className:"w-6"})}),c.jsx(Gm,{className:s.linkItem,to:xn.MySongs,icon:c.jsx(lb,{className:s.icon+t.content_text}),label:"Recent",arrowIcon:c.jsx($m,{className:"w-6"})})]}):c.jsxs(V,{onClick:i,className:`${t.content_bg} rounded-md space-x-1 py-1`,children:[c.jsx(Qy,{className:"w-7"}),c.jsx("span",{className:"font-playwriteCU leading-[2.2]",children:"Login"})]})})]})}function Uq(){const{theme:t}=H(),{loading:e,user:n}=ln(),r=f.useRef(null),{logOut:i}=Mf(),[s,a]=f.useState(""),o=()=>{var m;return(m=r.current)==null?void 0:m.toggle()},l=m=>{var p;a(m),(p=r.current)==null||p.toggle()},u=async()=>{try{await i()}catch(m){console.log("signOut error",{messsage:m})}finally{o()}},d=f.useMemo(()=>{switch(s){case"theme":return c.jsx(oP,{close:o});case"info":return c.jsx(aP,{close:o});case"logout":return c.jsx(qs,{close:o,callback:u,loading:!1,theme:t,label:"Log out ?"})}},[s]),h={linkItem:`py-3 text-lg w-full border-b border-${t.alpha} space-x-2 last:border-none flex items-center`,icon:"w-7"};return c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"text-xl font-playwriteCU leading-[2.2] mb-3",children:"Setting"}),n&&c.jsxs("div",{className:`bg-${t.alpha} p-3 rounded-md flex mb-2`,children:[c.jsx(W0,{className:"h-[65px] w-[65px]"}),c.jsxs("div",{className:"ml-3",children:[c.jsx("p",{className:"text-lg font-[500]",children:n.display_name}),c.jsx("p",{className:"opacity-70 font-[500]",children:"Vip member ❤️"})]})]}),e?[...Array(3).keys()].map(m=>c.jsx(Ub,{},m)):c.jsxs("div",{className:"",children:[c.jsxs("button",{className:h.linkItem,onClick:()=>l("theme"),children:[c.jsx(fb,{className:h.icon}),c.jsx("span",{children:"Theme"})]}),c.jsxs("button",{className:h.linkItem,onClick:()=>l("info"),children:[c.jsx(db,{className:h.icon}),c.jsx("span",{children:"Info"})]}),n&&c.jsxs("button",{className:h.linkItem,onClick:()=>l("logout"),children:[c.jsx(Qy,{className:h.icon}),c.jsx("span",{children:"Logout"})]})]}),c.jsx(Dr,{ref:r,variant:"animation",children:d})]})}function Bq(){const t=Zt(),{theme:e}=H(),{isOpenSongQueue:n,setIsOpenSongQueue:r,controlRef:i}=Qt(),{queueSongs:s,currentQueueId:a}=oe(It),o=f.useCallback(d=>{d!==a&&t(Ji(d))},[a]),l=f.useCallback(()=>{var d;t(qB()),(d=i.current)==null||d.resetForNewSong(),r(!1)},[]),u={mainContainer:`fixed w-[300px] flex flex-col bottom-[80px] right-[0] top-[0] z-20 px-3 pt-4 ${e.container} border-l-[1px] border-${e.alpha} transition-[transform] duration-[.5s] linear delay-100`,songListContainer:"flex-grow overflow-y-auto pb-[10px] overflow-x-hidden no-scrollbar"};return c.jsx(Js,{children:c.jsxs("div",{className:`${e.text_color} ${u.mainContainer} ${n?"translate-x-0---":"translate-x-full"}     `,children:[c.jsx("div",{className:"leading-[2.2] font-playwriteCU mb-2",children:"Song queue"}),c.jsx("div",{className:u.songListContainer,children:c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"",children:c.jsx(Zi,{variant:"queue",songs:s,handleSetSong:o})}),c.jsx("div",{className:"text-center",children:!!s.length&&c.jsxs(V,{onClick:l,size:"clear",className:`${e.content_bg} rounded-full my-5 px-3 py-1 space-x-1`,children:[c.jsx(Ja,{className:"w-6"}),c.jsx("span",{className:"font-playwriteCU leading-[2.2]",children:"Clear"})]})})]})})]})})}const Vq=f.memo(Bq);function Hq(t,e){const{currentSongData:n}=oe(It),{isOpenFullScreen:r,setIdle:i}=Qt(),[s,a]=f.useState(0),o=f.useRef(),l=f.useRef(),u=()=>{i(!1),a(Math.random())},d=()=>{clearTimeout(l.current),clearTimeout(o.current)},h=async()=>{if(!r)return;const m=document.querySelector(".song-thumb.active"),p=document.querySelector(".song-list-container");if(m&&p){const g=_R(m,p,!0);let w=yc.focusDelay;g||(w=0),o.current=setTimeout(()=>{i(!0)},w)}};if(f.useEffect(()=>{if(!(e||!n)){if(!r){i(!1);return}return setTimeout(()=>{window.addEventListener("mousemove",u),window.dispatchEvent(new Event("mousemove"))},1e3),()=>{window.removeEventListener("mousemove",u),d()}}},[r]),f.useEffect(()=>(l.current=setTimeout(()=>{h()},t),()=>{d()}),[s]),!r)return!1}const Wq=()=>{const{isOnMobile:t}=H(),{audioRef:e,setIsHasAudioEle:n}=Qt();Hq(yc.focusDelay,t);const r=e.current&&c.jsxs(c.Fragment,{children:[c.jsx(xq,{}),c.jsx(Vq,{}),c.jsx(pq,{})]}),i=e.current&&c.jsxs(c.Fragment,{children:[c.jsx($q,{}),c.jsx(Oq,{})]});return f.useEffect(()=>{e.current&&n(!0)},[]),c.jsxs(c.Fragment,{children:[c.jsx("audio",{ref:e,className:"hidden"}),e.current&&(t?i:r)]})};function qq(){return c.jsx(MA,{children:c.jsx(Wq,{})})}const nx="data:image/gif;base64,R0lGODlhJAAkAIABAP///////yH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQ4IDc5LjE2NDAzNiwgMjAxOS8wOC8xMy0wMTowNjo1NyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo0NmRjOGMyNC03YmYxLTQxZTMtYjQ2Zi1mY2ZhMDk4MDE1YWYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MTBDRTc0QzlGNDBEMTFFQTk4NDZENjI0QzI1MENFQzgiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MTBDRTc0QzhGNDBEMTFFQTk4NDZENjI0QzI1MENFQzgiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6YzBhNGU4OWYtNjc4Yy00NmMyLTg4NmUtYzIxNGE0NTIwZDRjIiBzdFJlZjpkb2N1bWVudElEPSJhZG9iZTpkb2NpZDpwaG90b3Nob3A6ODRlMDBjYmEtZjhlNy03YzQ4LWE4MTgtNDc3NTI3MGQ1ZTAyIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkECQgAAQAsAAAAACQAJAAAAnKMj5nArQ9jc7HWyax+GOx/dCAojltpWmgqYazqvu0kz1StrHgYp6tO6gWAn59wZKSxkjcTM7MUEk/SY1BpmGqeHhs0W8Vywk3tkPw9iztcBLfNW7Pl9PLcXk/f8Xz9vguWB6h254Y2+Id4aLjH2Kc4UQAAIfkECQgAAQAsAAAAACQAJAAAAnSMj6nL7Q+jnAzYS+XFGW7beV/4fADpmGijrkvrJnA2z1Q9hvhG7lznA+lyBpuMGAieDiYlQulkIpvTKk9KFRatv2RW671uxeHskwv+ptHLsRnbhbLPZHW7vK6r6XF21J33Bngnp2fY98UXuNikSOg3B8dYAAAh+QQJCAABACwAAAAAJAAkAAACfIyPqcvtD6OctNqLKdg8N955C7iJI4mQAKam6NUeMTMHda3cr4EnOugCfnY2Yi8Y4hmXKqHSWYQ2mclodSqllmTY7fOqbSK9VnLXHB6Ludk2Vg1nv+Vo9zT+rc/zK3qf/wNmt8aHV0Z4aHj2l+inFqgXiQjJuKgYRnkJUgAAIfkECQgAAQAsAAAAACQAJAAAAnuMj6nL7Q+jnLTaC7K+T2/eeBkYiiQjAlyKsJh5uJYc0BRtTzgMpbsn8fFqQ4cQGCuWjqok0vA7toZR4fRJxDJHzg+Uur16s+Nt86sFM8VcdDncbZPlZvZ5fq/H82rp3m5XxZe29mfoZnWIF9hH1+gDqKiHOPhWSBlJWQAAIfkECQgAAQAsAAAAACQAJAAAAn6Mj6nL7Q8RmDTaQ+u1eW7efVg4ZqLRARIppqsZpW6pQTIbzPZd57jD6+keQQ/NuAu+esDiEkl0HlUxKerXKFKvsCTvuY0qp2Dw8IzTlslTdNf3VrO5Qiu8Hre78d/5HSpHB5imR5g3Jhi2d7OWaGbIN4j4pwjJ6Lco00gJVgAAIfkECQgAAQAsAAAAACQAJAAAAn2EH6nL7XnQmxRGULO7WHsbfRPHiQ95mRsqqQvbBqUGG29K13eYw3tMqXVAwJFOMcsIf7YeizmsLJE45ZHYtPqoPO2TWzxdZVXpOGneYqPBc7mtJnflsekaCkXry3Z61h/VtzcnyGcYN1jnRnj4dQf2V8g46QiIB0ly+bhWAAAh+QQJCAABACwAAAAAJAAkAAACfYyPqcvtD+MDtMobqt6Y7Q90C8iJCamZJ0qpCNu6Bhwen0S/JZTb+wTTpSK92c9RzBwbyRsx6BvyoEYpkCW0RLVVVDbWBSuxW7EzDPrW0OrzmPs2U+Nrevvnzs/11ib+T8ZWVufXB+g1qHZnyAhX6HhIopg4yAfZKEkpiFYAACH5BAkIAAEALAAAAAAkACQAAAJ7jI+py+0Po5y02ouB3tht3jGfFopjuYwqgK5npCLuJ8XHDEK2gZP3ywMGeqwfzZgb9mTCnRLHPAalz1k06SRefVPsEsmthrXgYnf8PZvFa7J6206z4fBs8w4t08t2at+qF6j2h+YnRxiX9ybIhrg3iOdlqDjH6Fa5qFYAACH5BAkIAAEALAAAAAAkACQAAAJ1jI+py+0Po5y02otzArxr1nmfEnIjWZ5bqh4l0Lqs8WK1HNpzcFs9/9o5fkFhg1gUQZBJWISZlECL0l3ThFMCc1lq10mzXhFT8Db6JYubam7Yffa+teVymz5O6+fyuLm+hgd39ReIxRd0d+inmLjH+GX3+FIAACH5BAUIAAEALAAAAAAkACQAAAJwjI+py+0Po5y0PoCzhVlv12EfGI5NCJgMqi5sm7zwIc9BPeOw3vKqb6oBLyUaqshB3o4diZDpSTaN0FTkWUVgo8sslbtlapXh43hqKJfP4Ko1TY574ehue24XffV0KJuf9xa4tifoZih351f4h9hRAAA7",H0=({data:t,inDetail:e,active:n,link:r})=>{const{theme:i}=H(),s={button:`rounded-full text-[#201f1f] p-[4px] hover:bg-${i==null?void 0:i.alpha}`,imageContainer:"absolute inset-0 overflow-hidden flex items-center justify-center "},a=c.jsx(qb,{theme:i,children:c.jsxs("div",{className:s.imageContainer,children:[c.jsx(Nr,{className:`hover:scale-[1.05] transition-transform duration-300 object-center object-cover ${n?"brightness-[90%]":""}`,src:t.image_url,blurHashEncode:t.blurhash_encode}),n&&c.jsx("img",{src:nx,alt:"",className:" absolute w-[30px]"})]})});return e?a:c.jsxs(c.Fragment,{children:[c.jsx(Br,{to:`${r||"/playlist/"+t.id}`,className:"",children:a}),c.jsx("div",{className:"text-xl font-[500] line-clamp-1 leading-[24px]  mt-[6px]",children:t.name})]})};function Gq({content:t,className:e}){const n=f.useRef(null),r=f.useRef(null);return QB({textRef:r,textWrapperRef:n,content:t}),c.jsx("div",{ref:n,className:"overflow-hidden relative h-full ",children:c.jsx("div",{ref:r,className:`absolute left-0 whitespace-nowrap ${e}`,children:t||"..."})})}const Eh=f.memo(Gq);function Kq({openModal:t,admin:e}){const{theme:n}=H(),r=Zt(),i=u=>{t(u)},[s,a]=vR("isCrossFade",!1),o=()=>{a(!s),r(wt({isCrossFade:!s}))},l={menuItem:`${n.content_hover_text} hover:bg-${n.alpha} rounded-md font-[500] px-2 py-2 inline-flex items-center cursor-pointer`,icon:"w-[25px] mr-[8px]",divide:`h-[1px]  w-[calc(100%-20px)] my-[4px] mx-auto bg-${n.alpha}`};return c.jsx(c.Fragment,{children:c.jsx(Ys,{color:"sidebar",theme:n,children:c.jsxs("ul",{className:"flex flex-col w-[200px]",children:[!e&&c.jsxs("li",{className:`${l.menuItem} justify-between cursor-default`,children:[c.jsxs("div",{className:"flex items-center",children:[c.jsx(Wh,{className:l.icon}),"Cross fade"]}),c.jsx(HR,{active:s,cb:o})]}),c.jsxs("li",{className:`${l.menuItem}`,onClick:()=>i("theme"),children:[c.jsx(fb,{className:l.icon}),"Themes"]}),c.jsx("div",{className:l.divide}),!e&&c.jsxs("li",{className:`${l.menuItem}`,onClick:()=>i("info"),children:[c.jsx(db,{className:l.icon}),"Info"]})]})})})}function Qq({className:t}){const[e,n]=f.useState(!1),{theme:r}=H(),i=()=>{const a=document.querySelector(".main-container");if(!a)return;const o=a.scrollTop||0;n(o>100)},s=()=>{const a=document.querySelector(".main-container");a==null||a.scroll({behavior:"smooth",top:0})};return f.useEffect(()=>{const a=document.querySelector(".main-container");if(a)return a.addEventListener("scroll",i),()=>{a.removeEventListener("scroll",i)}},[]),c.jsx(V,{onClick:s,variant:"circle",size:"clear",className:`absolute p-[8px] hover:scale-[1.05] transition-[opacity,transform] 
         ${t||""} 
         w-[36px] 
         ${r.content_hover_bg} h-[36px] bg-${r.alpha} 
      ${e?"opacity-[1]":"opacity-0 translate-y-[20px]"}`,children:c.jsx(dB,{className:"w-full"})})}function Xq(){const{theme:t}=H(),{user:e,loading:n}=ln(),r=Rr(),i=ir(),s=()=>{i("/dashboard")},a=[...Array(2).keys()].map(l=>c.jsxs("div",{className:"px-3 w-full h-[51px] flex items-center",children:[c.jsx(ft,{className:"w-[28px] h-[28px] mr-1 flex-shrink-0"}),c.jsx(ft,{className:"w-[100px] h-[30px]"})]},l)),o={container:`w-[180px] relative  flex-shrink-0 border-r-[1px] h-screen ${t.side_bar_bg} border-${t.alpha}`,navItem:`  px-3 py-2 leading-[2.2] font-playwriteCU flex items-center ${t.content_hover_text}`,icon:"w-7 mr-2",link:"w-full border-l-[4px]",activeLink:`${t.content_text} ${t.container} ${t.content_border}  `};return c.jsxs("div",{className:`hidden md:block ${o.container} ${t.text_color}`,children:[c.jsx("div",{className:"px-[10px] h-[60px] flex items-center justify-center",children:c.jsxs(Br,{to:"/",className:"text-[24px] font-bold",children:["HD",c.jsx("span",{className:`${t.content_text} ml-[4px]`,children:"MP3"})]})}),c.jsxs("div",{className:"flex flex-col items-start",children:[n&&a,!n&&c.jsxs(c.Fragment,{children:[c.jsx(Br,{className:`${o.link} ${r.pathname==="/"?o.activeLink:"border-transparent"}`,to:xn.Home,children:c.jsxs("div",{className:o.navItem,children:[c.jsx(L5,{className:o.icon}),c.jsx("span",{children:"Discover"})]})}),e&&c.jsxs(c.Fragment,{children:[c.jsx(Br,{className:`${o.link}  ${r.pathname.includes("mysongs")?o.activeLink:"border-transparent"}`,to:xn.MySongs,children:c.jsxs("div",{className:o.navItem,children:[c.jsx(Ya,{className:o.icon}),c.jsx("span",{children:"My Song"})]})}),e.role==="ADMIN"&&c.jsx(Br,{to:"/dashboard",className:`${o.link} border-transparent`,children:c.jsxs("div",{onClick:s,className:` ${o.navItem}`,children:[c.jsx(b5,{className:o.icon}),c.jsx("span",{className:"",children:"Dashboard"})]})})]})]})]}),c.jsx(Qq,{className:"left-[50%] translate-x-[-50%] bottom-[80px] md:bottom-[100px]"})]})}function Yq({contentRef:t}){const{theme:e}=H(),[n,r]=f.useState(0),[i,s]=Df(Us),[a,o]=f.useState(""),l=f.useRef(null),u=f.useRef(null),{logOut:d,logIn:h}=Mf(),m=x=>{var _,S;o(x),(_=u.current)==null||_.toggle(),(S=l.current)==null||S.close()},p=async()=>{var x;try{await d()}catch(_){console.log("signOut error",{messsage:_})}finally{(x=u.current)==null||x.toggle()}},g=async()=>{try{const x=document.querySelector(".login-trigger");await h(),x&&x.click()}catch(x){console.log(x)}},w=()=>{var _;const x=((_=t.current)==null?void 0:_.scrollTop)||0;r(x)},E=c.jsx(ft,{className:"h-[40px] w-[40px] rounded-full"}),v=f.useMemo(()=>{switch(a){case"":return c.jsx(c.Fragment,{});case"theme":return c.jsx(oP,{close:()=>{var x;return(x=u.current)==null?void 0:x.toggle()}});case"info":return c.jsx(aP,{close:()=>{var x;return(x=u.current)==null?void 0:x.toggle()}});case"confirm":return c.jsx(qs,{close:()=>{var x;return(x=u.current)==null?void 0:x.toggle()},callback:p,loading:!1,label:"Sign out ?",desc:"",theme:e})}},[a]);f.useEffect(()=>{var x;return(x=t.current)==null||x.addEventListener("scroll",w),()=>{document.removeEventListener("scroll",w)}},[]);const y={userName:"text-[16px] font-[500] ml-[8px] line-clamp-1",button:"h-[40px] w-[40px] rounded-full",menuItem:`hover:bg-${e.alpha} ${e.content_hover_text} rounded-[4px] w-full px-[10px] h-[44px] inline-flex items-center font-[500]`,icon:"w-[25px] mr-[5px]",divide:`h-[1px]  w-[calc(100%-20px)] mb-[10px] mt-[20px] mx-auto bg-${e.alpha}`};return c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:`hidden md:block h-[60px] fixed top-0 right-0 left-[180px] z-[20] ${e.container} ${n?"shadow-lg bg-transparent":""}`,children:[c.jsx("div",{className:`${n?"":"hidden "} absolute  inset-0 ${e.container} bg-opacity-[0.9] backdrop-blur-[15px] z-[-1] `}),c.jsx("div",{className:"px-[40px] flex h-full",children:c.jsxs("div",{className:"flex items-center space-x-3 ml-auto",children:[c.jsxs(go,{children:[c.jsx(yo,{ref:l,children:c.jsx(Xr,{isWrapped:!0,position:"top-[calc(100%+8px)]",content:"Settings",children:c.jsx("button",{className:`flex px-[6px] items-center ${y.button} bg-${e.alpha} ${e.content_hover_bg}`,children:c.jsx(ab,{className:"w-full"})})})}),c.jsx(vo,{appendTo:"parent",className:"top-[calc(100%+8px)] right-0",animationClassName:"origin-top-right",children:c.jsx(Kq,{openModal:m,loggedIn:!1})})]}),c.jsxs(go,{children:[c.jsx(yo,{className:"flex items-center",children:c.jsx("button",{className:"flex hover:brightness-90",children:s?E:c.jsx(W0,{className:"w-[40px] h-[40px]"})})}),c.jsx(vo,{appendTo:"parent",className:"top-[calc(100%+8px)] right-0",animationClassName:"origin-top-right",children:c.jsx(Ys,{color:"sidebar",theme:e,children:c.jsxs("div",{className:"w-[250px] max-h-[50vh]",children:[i&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex items-center p-[10px] pb-0",children:[c.jsx(W0,{className:"login-trigger w-[46px] h-[46px]"}),c.jsx("div",{className:"ml-[12px]",children:c.jsx("h5",{className:"font-semibold line-clamp-1",children:i==null?void 0:i.displayName})})]}),c.jsx("div",{className:y.divide}),c.jsxs("button",{className:`${y.menuItem}`,onClick:()=>m("confirm"),children:[c.jsx(Qy,{className:y.icon}),"Log out"]})]}),!i&&c.jsxs("button",{className:`${y.menuItem}`,onClick:g,children:[c.jsx(W3,{className:y.icon}),"Log in"]})]})})})]})]})})]}),c.jsx(Dr,{variant:"animation",ref:u,children:v})]})}function Jq({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{fillRule:"evenodd",d:"M4.5 5.653c0-1.426 1.529-2.33 2.779-1.643l11.54 6.348c1.295.712 1.295 2.573 0 3.285L7.28 19.991c-1.25.687-2.779-.217-2.779-1.643V5.653z",clipRule:"evenodd"}))}const Zq=f.forwardRef(Jq),eG=Zq;function Yo({song:t,closeMenu:e,...n}){const r=Zt(),{user:i}=ln(),{theme:s,isOnMobile:a}=H(),{setSuccessToast:o}=sr(),{playlists:l}=Jt(),u=()=>{r(gR({songs:[t]})),e(),o("Song added to queue")},d={before:"after:content-[''] after:absolute after:h-[100%] after:w-[10px] after:right-[100%]",level2Menu:"w-[100%] absolute right-[calc(100%+5px)] hidden group-hover/add-playlist:block hover:block",menuItem:`hover:bg-${s.alpha} font-[500] ${s.content_hover_text} max-[549px]:!bg-transparent py-1 pl-2 rounded-md`,menuIcon:"w-5 mr-3",overlay:"absolute flex items-center justify-center inset-0 bg-[#000] bg-opacity-[.5]"},h=f.useMemo(()=>{if(!i)return c.jsx(c.Fragment,{});switch(n.variant){case"home":case"my-songs":case"dashboard-songs":return a?c.jsxs(V,{className:`group relative ${d.menuItem}  ${s.content_hover_text} ${d.before}`,variant:"list",onClick:()=>n.handleOpenModal("add-to-playlist"),children:[c.jsx(Xn,{className:d.menuIcon}),"Add to playlist"]}):c.jsxs(V,{className:`group/add-playlist hover:!brightness-100 relative ${d.menuItem}  ${s.content_hover_text} ${d.before}`,variant:"list",size:"clear",children:[c.jsx(Xn,{className:d.menuIcon}),"Add to playlist",c.jsx(Ys,{className:`${d.level2Menu} z-[99]                  `,color:"sidebar",theme:s,children:c.jsx("ul",{className:"w-full",children:l!=null&&l.length?c.jsx(c.Fragment,{children:l.map((g,w)=>c.jsxs("li",{onClick:()=>n.handleAddSongToPlaylist(g),className:`list-none w-full flex rounded-[4px] p-[5px] ${d.menuItem}`,children:[c.jsx("span",{children:c.jsx(Ya,{className:d.menuIcon})}),c.jsx("p",{className:"line-clamp-1 text-left",children:g.name})]},w))}):c.jsx("p",{children:"No playlist jet..."})})})]})}},[l]),m=()=>{switch(n.variant){case"home":return c.jsxs(c.Fragment,{children:[c.jsxs(V,{onClick:u,className:` ${d.menuItem}`,variant:"list",size:"clear",children:[c.jsx(Xn,{className:d.menuIcon}),"Add to queue"]}),h]});case"playlist":case"dashboard-playlist":return c.jsx(c.Fragment,{children:c.jsxs(V,{className:d.menuItem,variant:"list",size:"clear",onClick:n.handleRemoveSongFromPlaylist,children:[c.jsx(Aw,{className:d.menuIcon}),"Remove"]})});case"my-songs":case"dashboard-songs":return c.jsxs(c.Fragment,{children:[n.variant!=="dashboard-songs"&&c.jsxs(V,{onClick:u,className:` ${d.menuItem}`,variant:"list",size:"clear",children:[c.jsx(Xn,{className:d.menuIcon}),"Add to queue"]}),h,c.jsxs(V,{onClick:()=>n.handleOpenModal("edit"),className:` ${d.menuItem} `,variant:"list",size:"clear",children:[c.jsx(ab,{className:d.menuIcon}),"Edit"]}),c.jsx(Br,{to:`edit/${t.id}`,children:c.jsxs(V,{className:` ${d.menuItem} `,variant:"list",children:[c.jsx(ub,{className:d.menuIcon}),t.lyric_id?"Edit lyric":"Add lyric"]})}),c.jsxs(V,{onClick:()=>n.handleOpenModal("delete"),className:` ${d.menuItem} `,variant:"list",size:"clear",children:[c.jsx(Ja,{className:d.menuIcon}),"Delete"]})]});case"queue":return c.jsxs(c.Fragment,{children:[c.jsxs(V,{onClick:n.handleRemoveSongFromQueue,className:` ${d.menuItem}`,variant:"list",size:"clear",children:[c.jsx(Aw,{className:d.menuIcon}),"Remove"]}),h]})}},p=f.useMemo(()=>{switch(n.variant){case"queue":return c.jsx(c.Fragment,{});default:return c.jsxs("div",{className:`pl-[10px] py-[6px] bg-${s.alpha} rounded-md mb-3`,children:[c.jsx("h5",{className:"line-clamp-1 font-[500]",children:t.name}),c.jsx("p",{className:"text-sm opacity-70 line-clamp-1",children:t.singer})]})}},[t]);return c.jsx(c.Fragment,{children:c.jsxs("div",{className:` ${n.variant==="queue"?"w-[140px]":"w-[200px]"} `,children:[p,m(),c.jsxs("a",{target:"_blank",download:!0,href:t.song_url,className:` ${d.menuItem} w-full inline-flex items-center cursor-pointer`,children:[c.jsx(B3,{className:d.menuIcon}),"Download"]}),n.variant!=="queue"&&!a&&c.jsxs("p",{className:"opacity-50 font-[500] text-center text-[13px] mt-[10px]",children:["Uploaded by ",t.by]})]})})}function Jo({song:t,onClick:e,active:n=!0,index:r,className:i,...s}){const a=Zt(),{theme:o,isOnMobile:l}=H(),{isChecked:u,selectedSongs:d,selectSong:h}=To(),[m,p]=f.useState(!1),[g,w]=f.useState(""),E=f.useRef(null),v=f.useRef(null),y=()=>{var le;return(le=v.current)==null?void 0:le.toggle()},x=()=>{var le;return(le=E.current)==null?void 0:le.close()},{handleDeleteSong:_,handleAddSongToPlaylistMobile:S,handleAddSongToPlaylist:k,handleRemoveSongFromPlaylist:b,loading:T}=XB({song:t,closeModal:y,triggerRef:E}),P=le=>{var cn;w(le),x(),(cn=v.current)==null||cn.toggle()},N=f.useMemo(()=>d?d.indexOf(t)!=-1:!1,[d]),B=()=>{r!==void 0&&a(HB({index:r}))},F=le=>{u!==void 0&&h(le)},$={button:`${o.content_hover_bg} p-[8px] rounded-full`,songListButton:"p-1 mr-1 text-[inherit]",itemContainer:`w-full sm:group/container cursor-pointer flex flex-row rounded justify-between p-[10px] border-b border-${o.alpha} last:border-none`,imageFrame:` relative rounded-[4px] overflow-hidden flex-shrink-0 ${s.variant==="queue"?"w-[40px] h-[40px]":"h-[54px] w-[54px]"}`,overlay:"absolute flex items-center justify-center inset-0 bg-black/40",ctaWrapper:"flex items-center justify-end flex-shrink-0",menuBtnWrapper:"w-[50px] flex justify-center relative"},L=()=>{switch(s.variant){case"queue":return c.jsx(c.Fragment,{});case"uploading":return c.jsx("button",{className:`${$.songListButton}`,children:c.jsx(Ya,{className:"w-[18px]"})});default:return l?c.jsx("button",{onClick:()=>F(t),className:`${$.songListButton} text-[inherit]`,children:N?c.jsx(R0,{className:"w-[18px]"}):c.jsx(Pd,{className:"w-[18px]"})}):c.jsxs(c.Fragment,{children:[c.jsx("button",{onClick:()=>F(t),className:`${$.songListButton} ${!N&&"hidden"} group-hover/main:block`,children:N?c.jsx(R0,{className:"w-[18px]"}):c.jsx(Pd,{className:"w-[18px]"})}),c.jsx("button",{className:`${$.songListButton} ${N&&"hidden"} group-hover/main:hidden group-hover/main:mr-[0px]`,children:c.jsx(Ya,{className:"w-[18px]"})})]})}},Oe=f.useMemo(()=>{switch(s.variant){case"uploading":return c.jsx(c.Fragment,{});default:return c.jsx("div",{className:` ${$.overlay} 
               ${n?"":"hidden sm:group-hover/main:flex"}`,children:n?c.jsx("img",{src:nx,alt:"",className:"h-[18px] w-[18px]"}):c.jsx("div",{onClick:e,className:"cursor-pointer w-full h-full flex items-center justify-center",children:c.jsx(eG,{className:"w-[24px] text-white"})})})}},[n,e]),nt=c.jsxs(c.Fragment,{children:[L(),c.jsxs("div",{className:"flex-grow flex",onClick:l&&s.variant!=="uploading"?e:()=>{},children:[c.jsxs("div",{className:`${$.imageFrame}`,children:[c.jsx(Nr,{src:t.image_url,blurHashEncode:t.blurhash_encode}),Oe]}),c.jsxs("div",{className:`ml-[10px]  ${s.variant==="queue",""}`,children:[c.jsx("h5",{className:`line-clamp-1 font-medium overflow-hidden ${s.variant==="queue"?"text-sm":""}`,children:t.name}),c.jsx("p",{className:`opacity-[.7] leading-[1.2] line-clamp-1 
               ${s.variant==="queue"?"text-xs":""}
                       `,children:t.singer})]})]})]}),De=()=>{switch(s.variant){case"uploading":return c.jsx("div",{className:"opacity-[.7] flex flex-grow overflow-hidden",children:nt});case"queue":return nt;default:return c.jsx("div",{className:"flex flex-grow overflow-hidden",children:nt})}},D=()=>{switch(s.variant){case"home":case"dashboard-songs":return c.jsx(Yo,{closeMenu:x,variant:s.variant,handleAddSongToPlaylist:k,handleOpenModal:P,song:t});case"my-songs":case"favorite":return c.jsx(Yo,{closeMenu:x,variant:"my-songs",handleAddSongToPlaylist:k,handleOpenModal:P,song:t});case"my-playlist":case"dashboard-playlist":return c.jsx(Yo,{closeMenu:x,variant:"playlist",handleRemoveSongFromPlaylist:b,handleOpenModal:P,song:t});case"sys-playlist":return c.jsx(Yo,{closeMenu:x,variant:"sys-playlist",handleOpenModal:P,song:t});case"queue":return c.jsx(Yo,{closeMenu:x,handleRemoveSongFromQueue:B,variant:"queue",handleOpenModal:P,song:t});default:return c.jsx(c.Fragment,{})}},G=f.useMemo(()=>{switch(g){case"":return c.jsx(c.Fragment,{});case"edit":return c.jsx(sq,{modalRef:v,song:t});case"delete":return c.jsx(qs,{loading:T,label:`Delete '${t.name}' ?`,desc:"This action cannot be undone",theme:o,callback:_,close:y});case"add-to-playlist":return c.jsx(cG,{loading:T,handleAddSongToPlaylist:S,closeModal:y})}},[g,T]),Y=()=>{switch(s.variant){case"uploading":return c.jsxs("div",{className:"flex items-center",children:[c.jsx("span",{children:c.jsx(rs,{className:"w-[20px] mr-[10px] animate-spin"})}),c.jsx("p",{className:"text-[14px]",children:"In process..."})]});default:const le=()=>s.variant==="queue"?"":m?`${o.content_bg}`:"block md:hidden";return c.jsx("div",{className:$.ctaWrapper,children:c.jsxs("div",{className:$.menuBtnWrapper,children:[c.jsxs(go,{appendOnPortal:!0,children:[c.jsx(yo,{setIsOpenParent:p,ref:E,children:c.jsx(Xr,{isWrapped:!0,content:"Menu",children:c.jsx("button",{className:`block group-hover/main:block ${$.button} ${le()}`,children:c.jsx(mB,{className:"w-[20px]"})})})}),c.jsx(vo,{appendTo:"portal",children:c.jsxs(Ys,{className:`${T?"overflow-hidden relative":""}`,p:2,color:"sidebar",theme:o,children:[D(),T&&c.jsx("div",{className:$.overlay,children:c.jsx("div",{className:"h-[25px] w-[25px] border-[2px] border-r-black rounded-[50%] animate-spin"})})]})})]}),c.jsx("span",{className:`text-sm font-[500] hidden  group-hover/main:hidden ${m||s.variant==="queue"?"hidden":"md:block"}`,children:eo(t.duration)})]})})}},Se=()=>{switch(s.variant){case"uploading":return c.jsxs("div",{className:`${$.itemContainer} ${i||""} `,children:[De(),Y()]});case"queue":return c.jsxs("div",{className:`${$.itemContainer} group/main py-[6px] ${n?`${o.content_bg} text-white`:`hover:bg-${o.alpha}`}`,children:[De(),Y()]});default:return c.jsxs("div",{className:`${$.itemContainer} ${i||""} group/main ${n||N?`bg-${o.alpha}`:""}`,children:[De(),Y()]})}};return c.jsxs(c.Fragment,{children:[Se(),c.jsx(Dr,{ref:v,variant:"animation",children:G})]})}const tG=({data:t,active:e,onClick:n,hasTitle:r,classNames:i,idleClass:s},a)=>{const{theme:o}=H(),l={container:"flex flex-col",imageFrame:"group relative transition-[width] duration-[.3s] origin-center rounded-[6px] overflow-hidden",image:"select-none object-cover object-center rounded w-full",overlay:`absolute  ${e?"":"inset-0 hidden bg-opacity-60 bg-[#333] items-center justify-center"}   group-hover:flex`,playingGifFrame:"absolute h-[30px] w-[30px] bottom-[15px] left-[15px] -z-1",title:"text-2xl text-white mt-3 font-bold text-ellipsis line-clamp-1"};if(t)return c.jsxs("div",{ref:a,className:`${l.container} ${s||""}`,children:[c.jsx("div",{className:`song-thumb ${i??""} flex items-end justify-center flex-shrink-0 w-[350px] h-[350px] min-[1536px]:w-[450px] min-[1536px]:h-[450px] `,children:c.jsxs("div",{className:`${l.imageFrame} ${e?"w-[350px] min-[1536px]:w-[450px]":"w-[280px] min-[1536px]:w-[330px]"}`,children:[c.jsx(Nr,{className:"rounded-[6px]",src:t.image_url,blurHashEncode:t.blurhash_encode}),c.jsx("div",{className:`${l.overlay}`,children:!e&&c.jsx(V,{onClick:n,variant:"circle",hover:"scale",size:"clear",className:`h-[50px] w-[50px] ${o.content_hover_text}`,children:c.jsx(Hh,{className:"w-full"})})}),e&&c.jsx("div",{className:l.playingGifFrame,children:c.jsx("img",{src:nx,alt:""})})]})}),r&&c.jsxs("div",{className:"text-center",children:[c.jsx("h2",{className:l.title,children:(t==null?void 0:t.name)||"Some song"}),c.jsx("p",{className:"text-md opacity-50 line-clamp-1",children:(t==null?void 0:t.singer)||"..."})]})]})},Dp=f.forwardRef(tG);function nG({imageUrl:t,expand:e}){return c.jsx("div",{className:` ${e?"w-full h-auto px-10 sm:w-[60px] sm:h-[60px] sm:px-0":"w-[60px] h-[60px] p-0 flex-shrink-0"}`,children:c.jsx(Nr,{src:t,className:"w-full rounded-md"})})}function Zi({songs:t,...e}){const{theme:n}=H(),{queueSongs:r,currentSongData:i}=oe(It),s=()=>e.variant!=="uploading"?c.jsx(c.Fragment,{}):t.map((l,u)=>{const d={key:u,onClick:()=>{},song:l};return u==0?c.jsx(Jo,{variant:"uploading",className:"temp-song",...d}):c.jsx(Jo,{variant:"uploading",...d})}),a=c.jsx("p",{className:"text-center my-[60px]",children:"... ¯\\_(ツ)_/¯"}),o=()=>{switch(e.variant){case"uploading":return c.jsx(c.Fragment,{});case"my-songs":if(!t.length&&!e.tempSongs.length)return a;break;default:if(!t.length)return a}return t.map((l,u)=>{let d=l.id===(i==null?void 0:i.song.id);const h=u===r.length-1;switch(e.variant==="queue"&&(d=d&&(i==null?void 0:i.song.queue_id)===l.queue_id),e.variant){case"dashboard-songs":return c.jsx(Jo,{active:d,onClick:()=>e.handleSetSong(l),variant:e.variant,song:l,index:u},l.queue_id);default:return e.variant==="queue"&&d&&!h?c.jsxs("div",{children:[c.jsx(Jo,{active:d,onClick:()=>e.handleSetSong(l.queue_id),variant:e.variant,song:l,index:u}),c.jsx("div",{className:"mt-[12px] mb-[4px]",children:c.jsx("p",{className:`${n.content_text} text-[14px] font-[600]`,children:"Playing next"})})]},l.queue_id):c.jsx(Jo,{active:d,onClick:()=>e.handleSetSong(l.queue_id),variant:e.variant,song:l,index:u},l.queue_id)}})};return c.jsxs(c.Fragment,{children:[o(),s()]})}function Zo({children:t,...e}){const{isSelectAll:n,resetSelect:r}=To();switch(e.variant){case"home":case"dashboard-songs":return c.jsxs(c.Fragment,{children:[t,c.jsx(V,{onClick:r,className:"px-[5px] flex-shrink-0",children:c.jsx(js,{className:"w-[20px]"})})]});case"my-playlist":case"my-songs":case"dashboard-playlist":case"sys-playlist":return c.jsxs(c.Fragment,{children:[c.jsx("button",{onClick:e.selectAll,className:"ml-[10px]",children:n?c.jsx(R0,{className:"w-[20px]"}):c.jsx(Pd,{className:"w-[20px]"})}),t,c.jsx(V,{onClick:r,className:"px-[5px] flex-shrink-0",children:c.jsx(js,{className:"w-[20px]"})})]})}}function rG({modalRef:t}){const e=Zt(),{user:n}=ln(),{selectedSongs:r,resetSelect:i}=To(),{songs:s,setSongs:a}=Jt(),[o,l]=f.useState(!1),{setErrorToast:u,setSuccessToast:d}=sr(),{removeSelectSongs:h}=Do();return{deleteSelectedSong:async()=>{var w;try{if(!n)return;l(!0);const E=r.map(y=>y.id);for(let y of r)await zA(y);const v=s.filter(y=>!E.includes(y.id));a(v),d(`${r.length} songs deleted`)}catch(E){console.log({message:E}),u()}finally{i(),l(!1),(w=t.current)==null||w.close()}},removeSelectedSongFromPlaylist:async()=>{var w;await h(r,l),(w=t.current)==null||w.close(),i()},addSongsToQueue:()=>{e(gR({songs:r})),d("songs added to queue"),i()},isFetching:o}}function vc({children:t,...e}){const{theme:n}=H(),{isChecked:r,selectedSongs:i,selectAllSong:s,resetSelect:a}=To(),{playlistSongs:o}=oe(as),{songs:l}=Jt(),[u,d]=f.useState(""),h=f.useRef(null),{isFetching:m,addSongsToQueue:p,deleteSelectedSong:g,removeSelectedSongFromPlaylist:w}=rG({modalRef:h}),E=()=>{var b;(b=h.current)==null||b.close()},v=b=>{var T;d(b),(T=h.current)==null||T.open()},y=()=>{i.length<l.length?s(l):a()},x=()=>{i.length<o.length?s(o):a()},_={title:"text-xl leading-[2.2] font-playwriteCU",outlineButton:`border-${n.alpha} ${n.side_bar_bg} space-x-1`,icon:"w-[20px]"},S=f.useMemo(()=>{if(u)switch(u){case"delete-selected-songs":return c.jsx(qs,{loading:m,label:`Delete ${i.length} songs ?`,theme:n,callback:g,close:E});case"remove-selects-songs":return c.jsx(qs,{loading:m,label:`Remove ${i.length} songs ?`,theme:n,callback:w,close:E})}},[u,m]),k=f.useMemo(()=>{switch(e.variant){case"home":return c.jsxs(c.Fragment,{children:[!r&&c.jsx("h3",{className:`${_.title} !mr-[14px]`,children:"Songs"}),r&&c.jsxs(Zo,{variant:e.variant,children:[c.jsx("p",{className:"font-playwriteCU mr-1",children:i.length}),c.jsxs(V,{onClick:p,variant:"outline",size:"small",className:_.outlineButton,children:[c.jsx(Xn,{className:_.icon}),c.jsx("span",{className:"",children:"Add to queue"})]})]})]});case"dashboard-songs":return c.jsxs(c.Fragment,{children:[!r&&t,r&&c.jsxs(Zo,{variant:e.variant,children:[c.jsx("div",{className:"font-playwriteCU",children:i.length}),c.jsxs(V,{variant:"outline",size:"small",onClick:()=>v("delete-selected-songs"),className:_.outlineButton,children:[c.jsx(Ja,{className:_.icon}),c.jsx("span",{className:"hidden sm:block",children:"Delete"})]})]})]});case"my-songs":return c.jsxs(c.Fragment,{children:[!r&&t,r&&c.jsxs(Zo,{selectAll:y,variant:e.variant,children:[c.jsx("div",{className:"font-playwriteCU !mr-[14px]",children:i.length}),c.jsxs(V,{variant:"outline",size:"small",onClick:p,className:_.outlineButton,children:[c.jsx(Xn,{className:_.icon}),c.jsx("span",{className:"",children:"Add to queue"})]}),c.jsxs(V,{variant:"outline",size:"small",onClick:()=>v("delete-selected-songs"),className:_.outlineButton,children:[c.jsx(Ja,{className:_.icon}),c.jsx("span",{className:"hidden sm:block",children:"Delete"})]})]})]});case"dashboard-playlist":case"my-playlist":return c.jsxs(c.Fragment,{children:[!r&&t,r&&c.jsxs(Zo,{selectAll:x,variant:e.variant,children:[c.jsx("p",{className:"font-playwriteCU !mr-[14px]",children:i.length}),e.variant==="my-playlist"&&c.jsxs(V,{variant:"outline",size:"small",onClick:p,className:_.outlineButton,children:[c.jsx(Xn,{className:_.icon}),"Add to songs queue"]}),c.jsxs(V,{variant:"outline",size:"small",onClick:()=>v("remove-selects-songs"),className:_.outlineButton,children:[c.jsx(hb,{className:_.icon}),"Remove"]})]})]});case"sys-playlist":return c.jsxs(c.Fragment,{children:[!r&&c.jsx("div",{className:`${_.title} !mr-[14px]`,children:"Songs"}),r&&c.jsxs(Zo,{selectAll:x,variant:e.variant,children:[c.jsx("p",{className:"font-[500]",children:i.length}),c.jsxs(V,{variant:"outline",size:"small",onClick:p,className:_.outlineButton,children:[c.jsx(Xn,{className:_.icon}),"Add to songs queue"]})]})]})}},[r,i,e]);return c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"flex items-center space-x-2 h-[44px] mb-3",children:k}),c.jsx(Dr,{ref:h,variant:"animation",children:S})]})}function Qc({variant:t}){const e=Zt(),{currentQueueId:n,queueSongs:r,currentSongData:i}=oe(It),s=f.useMemo(()=>{switch(t){case"songs":return"queue_id";case"playlist":return"queue_id"}},[]);return{handleSetSong:(o,l)=>{if(n!==o){e(Ji(o)),e(wt({playStatus:"loading"}));const u=r.map(h=>h[s]);(!r.length||r.length!==l.length||!!l.find(h=>!u.includes(h[s])))&&(console.log("set queue"),e(WB({songs:l})))}},currentSongData:i,queueSongs:r,currentQueueId:n}}function iG({loading:t}){const{sysSongPlaylist:e}=Jt(),{handleSetSong:n}=Qc({variant:"songs"}),r=i=>{n(i,e.songs)};return c.jsxs(Js,{children:[c.jsx(vc,{variant:"home"}),t&&Yh,!t&&c.jsx(c.Fragment,{children:e.songs.length?c.jsx(c.Fragment,{children:c.jsx(Zi,{variant:"home",handleSetSong:r,songs:e.songs})}):c.jsx("h1",{className:"text-[22px] text-center",children:"..."})})]})}function iP(){const t=Zt(),{playlists:e,setPlaylists:n}=Jt(),{currentPlaylist:r}=oe(as),[i,s]=f.useState(!1),a=ir(),{setErrorToast:o}=sr();return{isFetching:i,addAdminPlaylist:async d=>{try{if(!d)throw new Error("playlist name invalid");const h=iv(d)+"_admin",m=Mb({id:h,by:"admin",name:d});s(!0);const p=[...e,m];await mn({collection:"playlist",data:m,id:h,msg:">>> api: set playlist doc"}),n(p)}catch(h){console.log({message:h}),o("")}finally{s(!1)}},deleteAdminPlaylist:async()=>{if(!r)return;s(!0),await ih({collection:"playlist",id:r.id,msg:">>> api: delete playlist doc"});const d=e.filter(h=>h.id!==r.id);n(d),t(dR()),s(!1),a("/dashboard")}}}function rx({loading:t,className:e,...n}){const{theme:r}=H(),{currentSongData:i}=oe(It),{playlists:s,sysSongPlaylist:a}=Jt(),o=f.useRef(null),{addPlaylist:l,isFetching:u}=Do(),{addAdminPlaylist:d,isFetching:h}=iP(),m=()=>{var v;return(v=o.current)==null?void 0:v.toggle()},p=f.useMemo(()=>n.variant==="my-song"||n.variant==="dashboard"?s:n.variant==="sys"?a.playlists:[],[a,s]),g={playlistItem:"w-1/4 p-[8px] max-[800px]:w-1/2"},w=()=>p.length?p.map((v,y)=>{const x=i==null?void 0:i.song.song_in.includes(v.id);switch(n.variant){case"sys":case"my-song":return c.jsx("div",{className:g.playlistItem,children:c.jsx(H0,{active:x,data:v})},y);case"dashboard":return c.jsx("div",{className:g.playlistItem,children:c.jsx(H0,{active:x,data:v,link:`/dashboard/playlist/${v.id}`})},y)}}):c.jsx(c.Fragment,{}),E=()=>{switch(n.variant){case"my-song":return c.jsx(NS,{addPlaylist:l,isFetching:u,close:m});case"dashboard":return c.jsx(NS,{addPlaylist:d,isFetching:h,close:m})}};return c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:`flex flex-row flex-wrap -mx-[8px] ${e}`,children:[t&&Y6,!t&&c.jsxs(c.Fragment,{children:[w(),n.variant!=="sys"&&c.jsx("div",{className:`${g.playlistItem} mb-[25px]`,children:c.jsx(qb,{theme:r,onClick:()=>{var v;return(v=o.current)==null?void 0:v.toggle()}})})]})]}),c.jsx(Dr,{variant:"animation",ref:o,children:E()})]})}function sP({tabs:t,activeTab:e,setActiveTab:n,className:r,render:i,inFullScreen:s}){const{theme:a}=H();return c.jsx("ul",{className:`flex space-x-[4px] py-[4px] h-full px-[4px] items-center ${s?"mx-auto":""} rounded-full ${s?"bg-white/10":a.side_bar_bg} ${r&&r}`,children:t.map((o,l)=>c.jsx("li",{onClick:()=>n(o),className:`${s?"px-[30px]":"px-[20px]"}  cursor-pointer hover:bg-white/20 h-full rounded-full max-[549px]:px-4 ${s?"":a.content_hover_text} ${e===o?s?"bg-white/20":`${a.content_text} ${a.container}`:"opacity-60"}`,children:c.jsx("span",{className:"leading-[30px] font-normal sm:font-bold",children:i(o)})},l))})}function um({variant:t}){const{theme:e}=H(),n=ir(),r=()=>{let s="/";switch(t){case"sys-playlist":s="/";break;case"my-playlist":s="/mysongs";break;case"dashboard-playlist":s="/dashboard";break;case"my-songs":s="/";break}n(s)},i={button:`h-[36px] w-[36px] p-[4px] rounded-full ${e.content_hover_bg} bg-${e.alpha}`};return c.jsx("button",{onClick:r,className:`${i.button}`,children:c.jsx(hR,{})})}const sG=({time:t=6e3,autoClose:e})=>{const{setToasts:n,toasts:r}=sr(),{theme:i}=H(),[s,a]=f.useState(""),o=u=>{n(d=>d.filter(h=>h.id!=u))};f.useEffect(()=>{s&&n(u=>u.filter(d=>d.id!=s))},[s]),f.useEffect(()=>{if(!e||!r.length)return;const u=r[r.length-1].id;setTimeout(()=>{a(u)},t)},[r]);const l={container:"toast-portal fixed z-[199] bottom-[100px] left-[20px] max-[549px]:bottom-[unset] max-[540px]:top-[10px] max-[540px]:right-[10px]"};return c.jsx(c.Fragment,{children:Eo.createPortal(c.jsx("div",{className:l.container,children:c.jsx("div",{className:"flex flex-col gap-[10px]",children:!!r.length&&r.map((u,d)=>c.jsx(aq,{onClick:o,theme:i,toast:u},d))})}),document.getElementById("portals"))})};function aG({user:t},e){return e?c.jsx("p",{className:"text-xl mb-4 ml-2",ref:e,children:t.display_name}):c.jsx("p",{className:"text-xl mb-4 ml-2",children:t.display_name})}f.forwardRef(aG);function oG(){const{theme:t}=H(),e={header:`${t.side_bar_bg} fixed top-0 w-full z-[99]`};return c.jsx(c.Fragment,{children:c.jsx("div",{className:`${e.header}`,children:c.jsx("div",{className:"container h-[60px] flex items-center",children:c.jsxs(Br,{to:"/dashboard",className:"text-xl font-[600]",children:["HD",c.jsx("span",{className:`${t.content_text} ml-[4px] uppercase`,children:"Dashboard"})]})})})})}const lG="/HD-MP3/assets/user-default-971f59df.png";function W0({className:t}){const[e]=Df(Us),n={imageFrame:`${t||"w-[35px] h-[35px]"} flex-shrink-0 rounded-full overflow-hidden ${e!=null&&e.photoURL?"":"flex items-center justify-center bg-[#ccc]"}`};return c.jsx("div",{className:n.imageFrame,children:c.jsx(Nr,{src:(e==null?void 0:e.photoURL)||lG,className:"w-full"})})}function aP({close:t}){return c.jsxs("div",{className:"w-[400px] max-w-[calc(90vw-40px)]",children:[c.jsx(Or,{close:t,title:"HD MP3"}),c.jsxs("p",{children:[c.jsx("span",{className:"font-[500]",children:"Technologies: "})," React, Tailwind Css, Google firebase"]})]})}function Mp({onClick:t,theme:e,active:n}){return c.jsx(c.Fragment,{children:c.jsxs("div",{className:"w-[25%] px-2 mt-3 max-[549px]:w-[50%]",children:[c.jsx("div",{onClick:()=>t(e),className:`relative border-l-[20px] ${e.content_border} pt-[100%] rounded-xl ${e.side_bar_bg} ${n?e.content_border:""}`,children:n&&c.jsx("div",{className:"absolute bottom-[10px] right-[10px]",children:c.jsx(l5,{className:`${e.content_text} w-[25px]`})})}),c.jsx("p",{className:"text-base font-[500] mt-1",children:e.name})]})})}function oP({close:t}){const{theme:e,setTheme:n}=H(),r=l=>{kt("theme",l.id),n(l)},i={songItemContainer:`w-full border-b border-${e.alpha} last:border-none`,icon:"w-6 h-6 mr-2 inline",popupWrapper:"w-[900px] max-w-[calc(90vw-40px)]",themeContainer:"overflow-y-auto overflow-x-hidden no-scrollbar h-[calc(70vh-60px)]  pb-[5vh]",themeList:"flex flex-row -mx-2 -mt-3 flex-wrap",linkItem:`py-[10px] border-b border-${e.alpha} last:border-none`},s=Nd.map(l=>{const u=l.id===e.id;if(l.type==="light")return c.jsx(Mp,{active:u,theme:l,onClick:r},l.id)}),a=Nd.map(l=>{const u=l.id===e.id;if(l.type==="dark")return c.jsx(Mp,{active:u,theme:l,onClick:r},l.id)}),o=mb.map(l=>{const u=l.id===e.id;return c.jsx(Mp,{active:u,theme:l,onClick:r},l.id)});return c.jsxs("div",{className:i.popupWrapper,children:[c.jsx(Or,{close:t,title:"Themes"}),c.jsxs("div",{className:i.themeContainer,children:[c.jsx("h2",{className:"text-lg font-semibold mb-[10px] mt-[30px]",children:"Specical"}),c.jsx("div",{className:i.themeList,children:o}),c.jsx("h2",{className:"text-lg font-semibold mb-[10px]",children:"Dark"}),c.jsx("div",{className:i.themeList,children:a}),c.jsx("h2",{className:"text-lg font-semibold mb-[10px] mt-[30px]",children:"Light"}),c.jsx("div",{className:i.themeList,children:s})]})]})}function qs({loading:t,theme:e,callback:n,label:r,close:i,buttonLabel:s,desc:a="This action cannot be undone",className:o}){return c.jsxs("div",{className:`${o||"w-[400px] max-w-[calc(90vw-40px)]"} ${t?"disable":""}`,children:[c.jsx("div",{className:"text-xl font-playwriteCU leading-[2.2] mb-3",children:r||"Wait a minute"}),a&&c.jsx("p",{className:"font-semibold text-lg text-red-500",children:a}),c.jsxs("div",{className:"flex space-x-3 mt-5",children:[c.jsx(V,{onClick:i,className:`${e.content_bg} rounded-full text-lg`,variant:"primary",children:"Close"}),c.jsx(V,{isLoading:t,className:" text-[#fff] bg-red-500 rounded-full text-lg",variant:"primary",onClick:n,children:s||"Yes please"})]})]})}function NS({close:t,addPlaylist:e,isFetching:n}){const{theme:r}=H(),[i,s]=f.useState(""),a=f.useRef(null),o=async l=>{l.preventDefault(),i&&(await e(i),t())};return f.useEffect(()=>{var l;(l=a.current)==null||l.focus()},[]),c.jsxs("div",{className:"w-[400px] max-w-[calc(100vw-40px)]:",children:[c.jsx(Or,{close:t,title:"Add playlist"}),c.jsxs("form",{action:"",onSubmit:o,children:[c.jsx("input",{ref:a,className:`bg-${r.alpha} px-[20px] text-lg rounded-full outline-none  h-[35px] w-full`,type:"text",placeholder:"name...",value:i,onChange:l=>s(l.target.value)}),c.jsx("p",{className:"text-right mt-[20px]",children:c.jsx(V,{type:"submit",isLoading:n,variant:"primary",className:`${r.content_bg} font-playwriteCU rounded-full ${i?"":"disable"}`,children:"Save"})})]})]})}function cG({closeModal:t,handleAddSongToPlaylist:e,loading:n}){const{playlists:r}=Jt(),{theme:i}=H();return c.jsxs("div",{className:`w-[400px] max-h-[80vh] max-w-[calc(90vw-40px)] flex flex-col ${n?"disable":""}`,children:[c.jsx(Or,{close:t,title:"Playlists"}),c.jsx("div",{className:"flex-grow flex flex-col overflow-auto space-y-2",children:r!=null&&r.length?c.jsx(c.Fragment,{children:r.map((s,a)=>c.jsxs("button",{onClick:()=>e(s),className:`flex text-lg rounded-md p-2 hover:${i.content_bg} ${i.side_bar_bg}`,children:[c.jsx(Ya,{className:"w-6 mr-2"}),c.jsx("span",{children:s.name})]},a))}):"No playlist jet..."})]})}const uG=[3,5,7,10];function dG({closeModal:t,active:e}){const{theme:n}=H(),r={button:`bg-${n.alpha} ${n.content_hover_bg} ml-2 mt-2 px-3  py-1 rounded-[99px]`},i=a=>{e(a),t()},s=uG.map(a=>c.jsxs("button",{type:"button",onClick:()=>i(a),className:`${r.button} `,children:[a," songs"]},a));return c.jsxs("div",{className:"w-[300px] max-w-[calc(100vw-40px)]",children:[c.jsx(Or,{close:t,title:"Sleep timer"}),c.jsx("div",{children:c.jsx("div",{className:"flex flex-wrap -mt-2 -ml-2 mb-3",children:s})})]})}function lP({admin:t}){const e=f.useRef(null),n=f.useRef(null),r=f.useRef(null),{handleInputChange:i}=YW({audioRef:e,testImageRef:r,inputRef:n,admin:t}),s={container:"upload portal fixed z-[199] bottom-[120px] right-[30px] max-[549px]:bottom-[unset] max-[540px]:top-[10px] max-[540px]:right-[10px]"};return c.jsx(c.Fragment,{children:Eo.createPortal(c.jsxs("div",{className:s.container,children:[c.jsx("audio",{className:"hidden",ref:e}),c.jsx("input",{ref:n,onChange:i,type:"file",multiple:!0,accept:"audio",id:"song_upload",className:"hidden"}),c.jsx("img",{className:"hidden",ref:r})]}),document.getElementById("portals"))})}function hG({playlist:t,close:e}){const{theme:n}=H(),r=f.useRef(null),[i,s]=f.useState(""),[a,o]=f.useState(!1),{editPlaylist:l,isFetching:u}=Do(),d=async m=>{if(m.preventDefault(),!!a)try{await l(i,t)}catch(p){console.log(p)}finally{e()}},h={editContainer:"w-[400px] max-w-[calc(90vw-40px)]",input:"text-[20px] rounded-[4px] px-[10px] h-[40px] mb-[15px] outline-none w-full"};return f.useEffect(()=>{const m=r.current;m==null||m.focus(),s(t.name)},[]),f.useEffect(()=>{i.trim()&&i.trim()!==t.name?o(!0):o(!1)},[i]),c.jsxs(c.Fragment,{children:[c.jsx(Or,{close:e,title:"Edit playlist"}),c.jsxs("form",{action:"",onSubmit:d,className:`${h.editContainer} ${u?"disable":""}`,children:[c.jsx("input",{ref:r,value:i,onChange:m=>s(m.target.value),type:"text",className:`${h.input} bg-${n.alpha} ${n.text_color}`}),c.jsx(V,{type:"submit",variant:"primary",isLoading:u,className:`${n.content_bg} rounded-full self-end mt-[15px] ${a?"":"disable"}`,children:"Save"})]})]})}const Lp=({onClick:t,children:e,disable:n,text:r})=>{const{theme:i}=H();return c.jsxs(V,{onClick:t,size:"clear",disabled:n,className:`rounded-full px-5 py-1 ${i.content_bg}`,children:[e,c.jsx("span",{className:"font-playwriteCU leading-[2.2]",children:r})]})};function q0({loading:t,...e}){const n=Zt(),{theme:r,isOnMobile:i}=H(),{currentPlaylist:s,playlistSongs:a}=oe(as),{currentSongData:o}=oe(It),{playStatus:l}=oe(zn),[u,d]=f.useState(""),h=f.useRef(null),m=Ky(),{handleSetSong:p}=Qc({variant:"playlist"}),{deletePlaylist:g,isFetching:w}=Do(),{deleteAdminPlaylist:E,isFetching:v}=iP(),y=f.useMemo(()=>a.reduce((L,Oe)=>L+Oe.duration,0),[a]),x=(l==="playing"||l==="waiting")&&(o==null?void 0:o.song.song_in)===`playlist_${s==null?void 0:s.id}`,_=L=>{var Oe;d(L),(Oe=h.current)==null||Oe.toggle()},S=()=>{var L;return(L=h.current)==null?void 0:L.toggle()},k=()=>{if(o!=null&&o.song.song_in.includes(m.name))return;const L=a[0];p(L.queue_id,a)},b=()=>{switch(l){case"playing":return n(wt({triggerPlayStatus:"paused"}));case"paused":return n(wt({triggerPlayStatus:"playing"}))}},T=c.jsxs(c.Fragment,{children:[c.jsx(ft,{className:"h-[38px] mb-[6px] w-[200px]"}),c.jsx(ft,{className:"hidden md:block h-[16px] w-[60px]"}),c.jsx(ft,{className:"hidden md:block h-[16px] w-[200px]"})]}),P=()=>t?T:c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"text-xl leading-[2.2] font-playwriteCU",children:s==null?void 0:s.name}),!i&&c.jsx("p",{className:"text-lg leading-[1] font-[500]",children:eo(y)}),e.variant!=="dashboard-playlist"&&c.jsxs("p",{className:"hidden md:block opacity-60 leading-[1]",children:["created by ",s==null?void 0:s.by]})]}),N=()=>{if(!s)return c.jsx(c.Fragment,{});if(o!=null&&o.song.song_in.includes(s.id))switch(l){case"playing":case"waiting":return c.jsx(Lp,{text:"Pause",onClick:b,children:c.jsx(Yy,{className:"w-7 mr-1"})});case"loading":case"paused":return c.jsx(Lp,{text:"Continue Play",onClick:b,children:c.jsx(Rd,{className:"w-7 mr-1"})})}return c.jsx(Lp,{text:"Play",onClick:k,children:c.jsx(Rd,{className:"w-7 mr-1"})})},B=()=>{if(t)return c.jsx(c.Fragment,{});switch(e.variant){case"my-playlist":return c.jsxs(c.Fragment,{children:[N(),c.jsx(V,{onClick:()=>_("delete"),className:`p-[8px] rounded-full ${r.content_hover_bg} bg-${r.alpha}`,children:c.jsx(Ja,{className:"w-[22px]"})}),c.jsx(V,{onClick:()=>_("edit"),className:`p-[8px] rounded-full ${r.content_hover_bg} bg-${r.alpha}`,children:c.jsx(Lg,{className:"w-[22px]"})})]});case"dashboard-playlist":return c.jsxs(c.Fragment,{children:[c.jsx(V,{onClick:()=>_("delete"),className:`p-[8px] rounded-full ${r.content_hover_bg} bg-${r.alpha}`,children:c.jsx(Ja,{className:"w-[22px]"})}),c.jsx(V,{onClick:()=>_("edit"),className:`p-[8px] rounded-full ${r.content_hover_bg} bg-${r.alpha}`,children:c.jsx(Lg,{className:"w-[22px]"})})]});case"sys-playlist":return N()}},F=f.useMemo(()=>{switch(u){case"":return c.jsx(c.Fragment,{});case"edit":return s?c.jsx(hG,{close:S,playlist:s}):c.jsx(c.Fragment,{});case"delete":if(e.variant==="my-playlist")return c.jsx(qs,{loading:w,label:"Delete playlist ?",theme:r,callback:g,close:S});if(e.variant==="dashboard-playlist")return c.jsx(qs,{loading:v,label:"Delete playlist ?",theme:r,callback:E,close:S})}},[u,w,v]),$={container:"w-full space-y-[12px] md:space-y-0 md:space-x-[12px] flex flex-col md:flex-row",playlistInfoContainer:"flex flex-col gap-[12px] md:justify-between",infoTop:"flex justify-center items-center gap-[8px] md:flex-col md:items-start",countSongText:"text-[14px]] font-semibold opacity-[.6] leading-[1]",ctaContainer:"flex justify-center space-x-[12px] md:justify-start"};return c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:$.container,children:[c.jsx("div",{className:"w-full px-10 md:w-1/4 md:px-0",children:t?c.jsx(ft,{className:"pt-[100%] rounded-[8px]"}):s&&c.jsx(H0,{data:s,active:x,inDetail:!0})}),c.jsxs("div",{className:$.playlistInfoContainer,children:[c.jsx("div",{className:$.infoTop,children:P()}),c.jsx("div",{className:`${$.ctaContainer} `,children:B()})]})]}),c.jsx(Dr,{variant:"animation",ref:h,children:F})]})}const fG=c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"h-[30px] mb-[10px] flex items-center",children:c.jsx(ft,{className:"h-[20px] w-[90px]"})}),Yh]});function G0({variant:t,loading:e}){const{theme:n}=H(),{currentPlaylist:r,playlistSongs:i}=oe(as),s=f.useRef(null),{handleSetSong:a}=Qc({variant:"playlist"}),o=()=>{var h;return(h=s.current)==null?void 0:h.toggle()},l=h=>{a(h,i)},u=f.useMemo(()=>{if(!i.length)return c.jsx(c.Fragment,{});switch(t){case"sys-playlist":return c.jsx(vc,{variant:"sys-playlist",children:c.jsxs("p",{className:"font-[500] opacity-[.5]",children:[i.length," Songs"]})});case"my-playlist":case"dashboard-playlist":return c.jsx(vc,{variant:"my-playlist",children:c.jsxs("p",{className:"font-[500] opacity-[.5]",children:[i.length," Songs"]})})}},[r,i]),d=()=>{switch(t){case"sys-playlist":return c.jsx(Zi,{variant:"sys-playlist",songs:i,handleSetSong:l});case"my-playlist":case"dashboard-playlist":return c.jsxs(c.Fragment,{children:[c.jsx(Zi,{variant:t,songs:i,handleSetSong:l}),c.jsx("div",{className:"flex justify-center mt-[20px]",children:c.jsxs(V,{onClick:()=>{var h;return(h=s.current)==null?void 0:h.toggle()},className:`${n.content_bg} rounded-full`,children:[c.jsx(Xn,{className:"w-7 mr-1"}),c.jsx("span",{className:"font-playwriteCU leading-[2.2]",children:"Add song"})]})})]})}};return e?fG:c.jsxs(c.Fragment,{children:[c.jsxs(Js,{children:[u,d()]}),c.jsx(Dr,{ref:s,variant:"animation",children:c.jsx(FB,{variant:"dashboard",closeModal:o,playlistSongs:i})})]})}function dm(){const t={container:"py-[30px] flex flex-col md:flex-row md:justify-between items-start",icon:"w-6 hover:scale-[1.1] transition linear ",copyRightText:"text-sm"};return c.jsxs("div",{className:`${t.container}`,children:[c.jsxs("p",{className:t.copyRightText,children:["Make with ❤️ by d4t06 ",c.jsx("br",{})," © All rights no reserve ¯\\_(ツ)_/¯"]}),c.jsxs("div",{className:"flex items-center mt-[20px] md:mt-0 space-x-[10px]",children:[c.jsx("a",{href:"mailto:datnh0708@gmail.com",children:c.jsx("svg",{className:t.icon,fill:"currentColor",viewBox:"0 0 32 32",xmlns:"http://www.w3.org/2000/svg",children:c.jsxs("g",{children:[c.jsx("path",{d:"M16.601 14.648v4.105h9.813c-0.162 2.008-0.982 3.798-2.243 5.18l0.006-0.007c-1.825 1.86-4.364 3.012-7.172 3.012-0.142 0-0.283-0.003-0.424-0.009l0.020 0.001c-5.946-0.003-10.765-4.823-10.765-10.77 0-0.051 0-0.102 0.001-0.152l-0 0.008c-0.001-0.043-0.001-0.094-0.001-0.145 0-5.946 4.819-10.767 10.765-10.77h0c0.040-0.001 0.087-0.001 0.135-0.001 2.822 0 5.383 1.121 7.262 2.941l-0.003-0.003 2.888-2.888c-2.568-2.578-6.121-4.174-10.047-4.174-0.082 0-0.164 0.001-0.246 0.002l0.012-0c-0.002 0-0.005 0-0.008 0-8.337 0-15.11 6.699-15.228 15.009l-0 0.011c0.118 8.32 6.891 15.020 15.228 15.020 0.003 0 0.006 0 0.009 0h-0c0.169 0.007 0.367 0.012 0.566 0.012 3.892 0 7.407-1.616 9.91-4.213l0.004-0.004c2.208-2.408 3.561-5.63 3.561-9.169 0-0.15-0.002-0.3-0.007-0.449l0.001 0.022c0.001-0.054 0.001-0.119 0.001-0.183 0-0.844-0.079-1.669-0.231-2.469l0.013 0.082z"})," "]})})}),c.jsx("a",{href:"https://github.com/d4t06",target:"_blank",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t.icon,fill:"currentColor",viewBox:"0 0 496 512",children:c.jsx("path",{d:"M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"})})}),c.jsx("a",{href:"https://www.linkedin.com/in/dat-nguyen-huu-9371a926a",target:"_blank",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t.icon,viewBox:"0 0 448 512",fill:"currentColor",children:c.jsx("path",{d:"M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"})})})]})]})}function cP(){const t=Zt(),e=Ky(),{setErrorToast:n}=sr(),r=f.useRef(!1),[i,s]=f.useState(!0),a=async()=>{if(!e.id)throw new Error("invalid playlist id");const u=await uo({collection:"playlist",id:e.id,msg:">>> api get playlist"});if(u.exists())return u.data()},o=async u=>{if(!u.song_ids.length)return[];const d=o1(jo,"songs"),h=za(d,Ua("id","in",u.song_ids)),m=await v1(h);return m.docs.length?m.docs.map(g=>({...g.data(),song_in:`playlist_${u.id}`,queue_id:Xs(4)})):(n(),[])},l=async()=>{try{if(!e.id)throw new Error("invalid playlist id");s(!0);const u=await a();if(!u)throw new Error("");const d=await o(u);t(oB({playlist:u,songs:d}))}catch(u){console.log({message:u}),n()}finally{s(!1)}};return f.useEffect(()=>(r.current||(r.current=!0,l()),()=>{t(dR())}),[]),{isFetching:i}}function mG(){xR({admin:!0});const{isFetching:t}=cP();return c.jsxs("div",{className:"pb-[80px] pt-10",children:[c.jsx("div",{className:"mb-[30px]",children:c.jsx(um,{variant:"dashboard-playlist"})}),c.jsx(q0,{loading:t,variant:"dashboard-playlist"}),c.jsx("div",{className:"mt-[30px]",children:c.jsx(G0,{loading:t,variant:"dashboard-playlist"})}),c.jsx(dm,{})]})}const pG=f.forwardRef(function({audioEle:t},e){const{theme:n}=H(),{currentSongData:r}=oe(It),{status:i,handlePlayPause:s,pause:a}=tx({audioEle:t}),o=location.hash.includes("edit");f.useImperativeHandle(e,()=>({handlePlayPause:s,handleNext:()=>{},resetForNewSong:()=>{},pause:a}));const l=f.useMemo(()=>{switch(i){case"playing":return c.jsx(Hh,{className:"w-10"});case"error":return c.jsx(Bh,{className:"w-10"});case"paused":return c.jsx(Wh,{className:"w-10"})}},[i]),u={wrapper:`fixed bottom-0 transition-transform w-full h-[70px] border-t border-${n.alpha} z-40  px-4`,blurBg:`absolute inset-0 ${n.bottom_player_bg} bg-opacity-[0.7] backdrop-blur-[15px] z-[-1]`};return c.jsx(c.Fragment,{children:c.jsxs("div",{className:`${u.wrapper} ${o?"translate-y-full":""}`,children:[c.jsx("div",{className:`${u.blurBg}`}),c.jsxs("div",{className:"container max-w-[800px] flex justify-between h-full items-center",children:[c.jsxs("div",{className:"flex flex-grow",children:[c.jsx("div",{className:"w-[44px] h-[44px] flex-shrink-0",children:c.jsx(Nr,{src:r==null?void 0:r.song.image_url,className:"rounded-full "})}),c.jsx("div",{className:"flex-grow  ml-[10px]",children:(r==null?void 0:r.song.song_url)&&c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"h-[30px] relative overflow-hidden",children:c.jsx("div",{className:"absolute left-0 whitespace-nowrap font-playwriteCU leading-[1.5]",children:(r==null?void 0:r.song.name)||"name"})}),c.jsx("p",{className:"opacity-70 line-clamp-1",children:(r==null?void 0:r.song.singer)||"singer"})]})})]}),c.jsx("div",{className:`ml-2 ${!(r!=null&&r.song.name)&&"disable"}`,children:c.jsx("button",{className:"p-[4px]",onClick:s,children:l})})]}),"right"]})})}),gG=()=>{const{currentSongData:t,currentQueueId:e}=oe(It),{audioRef:n,setIsHasAudioEle:r,controlRef:i}=Qt();return f.useEffect(()=>{n.current&&r(!0)},[]),f.useEffect(()=>{var s;(s=i.current)==null||s.pause()},[e]),c.jsxs(c.Fragment,{children:[c.jsx("audio",{ref:n,src:t==null?void 0:t.song.song_url,className:"hidden"}),n.current&&c.jsx(c.Fragment,{children:c.jsx(pG,{ref:i,audioEle:n.current})})]})};function yG(){return c.jsx(MA,{children:c.jsx(gG,{})})}function Fp({children:t}){const{theme:e}=H();return c.jsx(c.Fragment,{children:c.jsxs("div",{className:`${e.container} fixed inset-0  ${e.text_color}`,children:[c.jsx(oG,{}),c.jsx("div",{className:"h-full pt-[60px] overflow-auto no-scrollbar",children:c.jsx("div",{className:"container max-w-[800px] h-full",children:t})}),c.jsx(yG,{}),c.jsx(lP,{admin:!0})]})})}const vG=[{image_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/images%2Fcloud9_5smE_admin_stock?alt=media&token=cd1f3afe-0c29-462f-ad17-b28b95b6e903",name:"NCS",by:"admin",id:"test_RVt4_admin",blurhash_encode:"U9L;1{%200t600xaXNxt0JR*?ExZ01R*~AoL",song_ids:["hope_AI6Q_admin","thecalling_eRwo_admin","lostskydreamsptiifeatsaraskinner_RXI2_admin","cloud9_5smE_admin","diviners_exqv_admin"]}],xG=[{by:"admin",name:"Dancing With Your Ghost",song_in:"admin",singer:"Sasha Sloan",song_file_path:"songs/huudat01234560_dancingwithyourghost-sashasloan-6033576.mp3",image_file_path:"images/dancingwithyourghost_GLVy_admin_stock",id:"dancingwithyourghost_GLVy_admin",image_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/images%2Fdancingwithyourghost_GLVy_admin_stock?alt=media&token=26792777-c331-4d21-b394-a7661e0f0a72",duration:197,song_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/songs%2Fhuudat01234560_dancingwithyourghost-sashasloan-6033576.mp3?alt=media&token=154d79ca-c963-4f32-a21c-b58959b8f2a4",lyric_id:"",blurhash_encode:"UHB{c?S0WBRjtpodWBWB9qofWBWBxYa{oLWV",size:3326,queue_id:"UzCv"},{size:3230,singer:"Savannah, Philly K",song_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/songs%2Fhuudat01234560_diviners-savannahphillyk-4271809.mpga?alt=media&token=0a2bab43-8fe1-42fe-9991-3d798f4bd46e",song_in:"admin",lyric_id:"",duration:207,blurhash_encode:"",id:"diviners_exqv_admin",name:"Diviners",image_url:"",image_file_path:"",song_file_path:"songs/huudat01234560_diviners-savannahphillyk-4271809.mpga",by:"admin",queue_id:"WID-"},{id:"dusktilldawn_tJMx_admin",song_file_path:"songs/huudat01234560_dusktilldawn-zaynsia-5164057.mp3",duration:239,blurhash_encode:"UCHU,]8w%hE300I.4:xb}q.SMxM{9tD*tkxE",size:3749,song_in:"admin",image_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/images%2Fdusktilldawn_tJMx_admin_stock?alt=media&token=93163b40-69d7-49d1-8f3c-7d35ecf80e63",image_file_path:"images/dusktilldawn_tJMx_admin_stock",by:"admin",singer:"Zayn, Sia",lyric_id:"dusktilldawn_tJMx_admin",name:"Dusk Till Dawn",song_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/songs%2Fhuudat01234560_dusktilldawn-zaynsia-5164057.mp3?alt=media&token=0e2d432c-a492-4338-b9be-013310ddfb70",queue_id:"ULdq"},{duration:191,blurhash_encode:"",singer:"Syn Cole",by:"admin",song_in:"admin",lyric_id:"",size:3007,image_file_path:"",id:"gizmo_VMF2_admin",song_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/songs%2Fhuudat01234560_gizmo-syncole-6046197.mpga?alt=media&token=eed274e0-5716-47fc-a020-872a14c2fa6d",song_file_path:"songs/huudat01234560_gizmo-syncole-6046197.mpga",name:"Gizmo",image_url:"",queue_id:"650-"},{image_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/images%2Fgoodtimeowlcitycarlyraejepsen49b6mpga_vxSV_admin_stock?alt=media&token=55478c10-9a5e-4b02-a0e3-d9cf53136f51",id:"goodtimeowlcitycarlyraejepsen49b6mpga_vxSV_admin",singer:"OwlCity, CarlyRaeJepsen",lyric_id:"goodtimeowlcitycarlyraejepsen49b6mpga_vxSV_admin",blurhash_encode:"UID9|+tR%MM{?^-pt7RjyDV@e.WB00IoWBof",name:"GoodTime",duration:208,size:3235,song_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/songs%2Fhuudat01234560_goodtime-owlcity-carlyraejepsen_49b6.mpga?alt=media&token=0fd9fd15-5f09-4e95-a101-32c648827723",by:"admin",song_in:"admin",image_file_path:"images/goodtimeowlcitycarlyraejepsen49b6mpga_vxSV_admin_stock",song_file_path:"songs/huudat01234560_goodtime-owlcity-carlyraejepsen_49b6.mpga",queue_id:"DPkD"},{size:3987,duration:256,song_in:"admin",lyric_id:"heybrother_-8jG_admin",image_file_path:"images/heybrother_-8jG_admin_stock",song_file_path:"songs/huudat01234560_heybrother-avicii-3044424.mpga",by:"admin",id:"heybrother_-8jG_admin",singer:"Avicii",image_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/images%2Fheybrother_-8jG_admin_stock?alt=media&token=bbbc1aa3-7f52-4d60-9773-2f3f7818cd01",song_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/songs%2Fhuudat01234560_heybrother-avicii-3044424.mpga?alt=media&token=dba0759f-6762-47f4-9899-d6494a6fab15",blurhash_encode:"U98#7;X7Ntbb00oyt7oz~qWBoLbG00oLjZof",name:"Hey Brother",queue_id:"ZdjT"},{song_file_path:"songs/huudat01234560_hope-tobu-3117457.mpga",duration:289,id:"hope_AI6Q_admin",singer:"Tobu",size:4506,by:"admin",image_file_path:"images/hope_AI6Q_admin_stock",lyric_id:"",song_in:"admin",image_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/images%2Fhope_AI6Q_admin_stock?alt=media&token=9f282ea4-69c7-42f2-bba3-a232c9e7e194",name:"Hope",song_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/songs%2Fhuudat01234560_hope-tobu-3117457.mpga?alt=media&token=e1bfc470-a344-4505-b177-4ef96991b3fc",blurhash_encode:"UEBiHzyG00sVt:VWaioy00Mz^~WVIXtQnhRj",queue_id:"F7h1"},{size:3664,singer:"Kygo,Selena Gomez",lyric_id:"itaintme_8IYS_admin",by:"admin",blurhash_encode:"U26Qe$KN5i}Y0|IpxH^j0x^P-W0zn7S_OTE2",duration:220,song_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/songs%2Fhuudat01234560_itaintme-kygoselenagomez-5817724.mpga?alt=media&token=4328f6fc-3b04-490b-a37e-00c9ce8718d8",song_in:"admin",image_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/images%2Fitaintme_8IYS_admin_stock?alt=media&token=023ee525-6d9e-44ce-90b7-60b88c08a505",name:"It Ain't Me",id:"itaintme_8IYS_admin",song_file_path:"songs/huudat01234560_itaintme-kygoselenagomez-5817724.mpga",image_file_path:"images/itaintme_8IYS_admin_stock",queue_id:"UGap"},{singer:"Passenger",size:3892,song_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/songs%2Fhuudat01234560_lethergo-passenger-3719556.mpga?alt=media&token=7cbaf060-cc4f-4970-9967-5876943a7ced",lyric_id:"lethergo_QrJg_admin",image_file_path:"images/lethergo_QrJg_admin_stock",song_in:"admin",duration:250,song_file_path:"songs/huudat01234560_lethergo-passenger-3719556.mpga",name:"Let Her Go",id:"lethergo_QrJg_admin",blurhash_encode:"URBND:-;xZRSt:bxS4ja07E7NItPqtn4nQbb",image_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/images%2Flethergo_QrJg_admin_stock?alt=media&token=11c785b1-534f-4314-882e-9599b0dec8e4",by:"admin",queue_id:"1TQ5"},{song_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/songs%2Fhuudat01234560_letmedownslowly-alecbenjamin-6360069.mpga?alt=media&token=966e502f-6f95-4615-a961-08a95f5bab43",song_in:"admin",size:2883,blurhash_encode:"UhK,EXv|-VNG}@V@RPbcNZo#I;WqxCWBN{jY",singer:"Alec Benjamin",by:"admin",image_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/images%2Fletmedownslowly_KFip_admin_stock?alt=media&token=f6c875c3-335b-4195-abea-e8d065c0d50b",duration:170,lyric_id:"letmedownslowly_KFip_admin",song_file_path:"songs/huudat01234560_letmedownslowly-alecbenjamin-6360069.mpga",image_file_path:"images/letmedownslowly_KFip_admin_stock",id:"letmedownslowly_KFip_admin",name:"Let Me Down Slowly",queue_id:"MDjm"},{song_in:"admin",lyric_id:"",size:3600,by:"admin",singer:"Lost Sky, ft. Sara Skinner",image_file_path:"images/lostskydreamsptiifeatsaraskinner_RXI2_admin_stock",name:"Dreams ",image_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/images%2Flostskydreamsptiifeatsaraskinner_RXI2_admin_stock?alt=media&token=0dc0a53a-e457-4bda-b4cd-ac71e1852145",song_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/songs%2Fhuudat01234560_p4fh9nm1y1.mpga?alt=media&token=f7a7ad35-e4d2-4387-8319-2688fabd9282",duration:216,blurhash_encode:"UHD%%%JoF^Jm|wNcE#a#J--BNtxF1ubF,Wwd",song_file_path:"songs/huudat01234560_p4fh9nm1y1.mpga",id:"lostskydreamsptiifeatsaraskinner_RXI2_admin",queue_id:"kqLe"},{song_file_path:"songs/huudat01234560_oggy_cockroaches.mp3",song_in:"admin",size:319,duration:20,by:"admin",image_file_path:"",image_url:"",id:"oggycockroachesmp3_j52d_admin",name:"oggy_cockroaches.mp3",blurhash_encode:"",song_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/songs%2Fhuudat01234560_oggy_cockroaches.mp3?alt=media&token=59636050-21f9-4cc6-a0f6-68ef59a30d48",singer:"...",lyric_id:"",queue_id:"V8UD"},{image_file_path:"images/perfectedsheeran5208784mpga_wOSF_admin_stock",image_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/images%2Fperfectedsheeran5208784mpga_wOSF_admin_stock?alt=media&token=11e8ee8b-5c3e-426c-8301-3ac87451654a",size:4117,id:"perfectedsheeran5208784mpga_wOSF_admin",name:"Perfect",lyric_id:"perfectedsheeran5208784mpga_wOSF_admin",song_file_path:"songs/huudat01234560_perfect-edsheeran-5208784.mpga",blurhash_encode:"UY9,tJRQyZRQn-V[oJWBpKaeROkBbIWBfikB",duration:264,singer:"EdSheeran",by:"admin",song_in:"admin",song_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/songs%2Fhuudat01234560_perfect-edsheeran-5208784.mpga?alt=media&token=3c953332-727a-4846-aace-93a18882de2b",queue_id:"oCHL"},{singer:"One Direction",song_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/songs%2Fhuudat01234560_stealmygirl-onedirection-5434790.mpga?alt=media&token=41b6f6b9-5961-42bd-a7e3-d5764ba4dcae",by:"admin",blurhash_encode:"UOHw}rNaVYae_Nt7R+M|^*RjWBoLofofs:WB",lyric_id:"stealmygirl_nhcW_admin",song_in:"admin",duration:227,image_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/images%2Fstealmygirl_nhcW_admin_stock?alt=media&token=c4a6cc9b-c92c-497b-a76f-a557d1647bc7",name:"Steal My Girl",image_file_path:"images/stealmygirl_nhcW_admin_stock",id:"stealmygirl_nhcW_admin",size:3772,song_file_path:"songs/huudat01234560_stealmygirl-onedirection-5434790.mpga",queue_id:"Ay5N"},{blurhash_encode:"UkE{P7jFNwf6T#WVsTbHxcjZoLjZO=bIWWbH",song_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/songs%2Fhuudat01234560_sugar--3330663.mpga?alt=media&token=c7fe9b02-a189-4721-9ed9-ebd96618f291",singer:"Maroon 5",duration:236,id:"sugar_H5zA_admin",song_file_path:"songs/huudat01234560_sugar--3330663.mpga",lyric_id:"sugar_H5zA_admin",song_in:"admin",size:3681,name:"Sugar",by:"admin",image_file_path:"images/sugar_H5zA_admin_stock",image_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/images%2Fsugar_H5zA_admin_stock?alt=media&token=833833b1-d54d-4c50-8f24-e290de179191",queue_id:"h4V8"},{lyric_id:"takemetoinfinityconsoultrainin_Nkiw_admin",song_file_path:"songs/huudat01234560_takemetoinfinity-consoultrainin-4723303.mpga",size:3248,id:"takemetoinfinityconsoultrainin_Nkiw_admin",song_in:"admin",by:"admin",blurhash_encode:"UBDy@My5yqsE8|OlO9og.ivVm-kpKZWYizaK",image_file_path:"images/takemetoinfinityconsoultrainin_Nkiw_admin_stock",song_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/songs%2Fhuudat01234560_takemetoinfinity-consoultrainin-4723303.mpga?alt=media&token=045f8984-8de7-4baa-9414-23386de5e0f9",name:"Take Me To Infinity",singer:"Consoul Trainin",image_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/images%2Ftakemetoinfinityconsoultrainin_Nkiw_admin_stock?alt=media&token=04ecc734-f3fc-4b0d-b08b-456b29fd4c55",duration:208,queue_id:"HJfa"},{id:"thecalling_eRwo_admin",by:"admin",singer:"TheFatRat, Laura Brehm",duration:234,image_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/images%2Fthecalling_eRwo_admin_stock?alt=media&token=97909f54-8b4a-422a-84e9-4a1724ba0bd8",image_file_path:"images/thecalling_eRwo_admin_stock",song_in:"admin",name:"The Calling",size:3651,blurhash_encode:"UKE3b*WrDiMx00n#t7t7~WWCbbo#OHjFRPRj",lyric_id:"",song_file_path:"songs/huudat01234560_thecalling-thefatratlaurabrehm-4391253.mpga",song_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/songs%2Fhuudat01234560_thecalling-thefatratlaurabrehm-4391253.mpga?alt=media&token=779e3253-e60d-46d3-9a3f-f924752178f4",queue_id:"no2I"},{duration:204,lyric_id:"timber_NNe3_admin",song_in:"admin",image_file_path:"images/timber_NNe3_admin_stock",image_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/images%2Ftimber_NNe3_admin_stock?alt=media&token=dd80433d-dd6c-4cab-999b-7a66ac64d907",song_file_path:"songs/huudat01234560_timber-pitbullfeatkeha-6629607.mpga",name:"Timber",by:"admin",song_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/songs%2Fhuudat01234560_timber-pitbullfeatkeha-6629607.mpga?alt=media&token=09e07118-f611-41d1-8ad1-d97a353dd2a8",blurhash_encode:"ULNTg+XT00D*~WE2xat8D*WBIAM|~XxuIUax",size:3265,singer:"Pitbull feat. Ke",id:"timber_NNe3_admin",queue_id:"98BR"},{id:"waitingforlove_jqak_admin",image_file_path:"images/waitingforlove_jqak_admin_stock",lyric_id:"waitingforlove_jqak_admin",name:"Waiting for Love",blurhash_encode:"U5EyGK0000pM00=}?]9a]:pI?bRO9EMKIT-;",song_file_path:"songs/huudat01234560_waitingforlove-avicii-5008939.mp3",image_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/images%2Fwaitingforlove_jqak_admin_stock?alt=media&token=f6f54aba-645d-40bd-968c-ba4c7b82d010",singer:"Avicii",duration:228,by:"admin",size:3576,song_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/songs%2Fhuudat01234560_waitingforlove-avicii-5008939.mp3?alt=media&token=4135c2ce-f78d-43fe-a97a-4c4705cd62d6",song_in:"admin",queue_id:"tcSp"},{image_file_path:"images/y2matecomlienkhucxuan2012hd720pmp3_uqok_admin_stock",song_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/songs%2Fhuudat01234560_y2mate.com-li%C3%AAnkh%C3%BAcxu%C3%A2n2012hd720p.mp3?alt=media&token=6bade7c7-4be9-4b7c-b5b4-f36bc7e5a2a4",by:"admin",lyric_id:"",singer:"...",size:7829,song_file_path:"songs/huudat01234560_y2mate.com-liênkhúcxuân2012hd720p.mp3",image_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/images%2Fy2matecomlienkhucxuan2012hd720pmp3_uqok_admin_stock?alt=media&token=c7869d1b-cd2a-407a-a2e6-988881f0362a",id:"y2matecomlienkhucxuan2012hd720pmp3_uqok_admin",song_in:"admin",name:"Liên Khúc Xuân 2012",duration:501,blurhash_encode:"USRKy:SK%|R*}@r@MxoeY$kWmnafBUR*oybu",queue_id:"5mfY"},{by:"admin",song_file_path:"songs/huudat01234560_youi-onedirection-8438574.mpga",size:3954,song_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/songs%2Fhuudat01234560_youi-onedirection-8438574.mpga?alt=media&token=707a3005-6630-4f62-a8ed-96cc0895159f",id:"youi_DhYr_admin",blurhash_encode:"UeI;|=M{JPs-?wn%a1WB%hsTs:bHMyt7R*ni",duration:238,image_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/images%2Fyoui_DhYr_admin_stock?alt=media&token=ae005e9b-21d4-4c40-839d-a75fe81f6504",name:"You & I",singer:"One Direction",song_in:"admin",lyric_id:"youi_DhYr_admin",image_file_path:"images/youi_DhYr_admin_stock",queue_id:"IXeV"}],$p=o1(jo,"songs"),jS=o1(jo,"playlist"),K0=async t=>{let e;switch(t.variant){case"user":e=za($p,Ua("by","==",t.email),dE(10));break;case"home":e=za($p,Ua("by","==","admin"),dE(10));break;case"dashboard":e=za($p,Ua("by","==","admin"));break}const n=await v1(e);if(n.docs)return n.docs.map(i=>({...i.data(),song_in:"",queue_id:Xs(4)}))},Q0=async t=>{let e;switch(t.variant){case"admin":e=za(jS,Ua("by","==","admin"));break;case"user":e=za(jS,Ua("by","==",t.email));break}const n=await v1(e);if(n.docs)return n.docs.map(i=>i.data())},wG=async t=>{const e={userSongs:[],userPlaylists:[]},n=await K0({variant:"user",email:t.email});n!=null&&n.length&&(e.userSongs=n);const r=await Q0({variant:"user",email:t.email});return r!=null&&r.length&&(e.userPlaylists=r),e};function ix({variant:t}){const{setSysSongPlaylist:e,setSongs:n,setPlaylists:r,ranGetSong:i}=Jt(),{user:s,loading:a}=ln(),[o,l]=f.useState(!0),u=async()=>{try{if(yc.isDev){await Vg(yc.loadingDuration),e({playlists:vG,songs:xG});return}switch(t){case"home":const d=await K0({variant:"home"}),h=await Q0({variant:"admin"});e({playlists:h||[],songs:d||[]});break;case"user":if(!s)return;if(i.current){await Vg(500);break}i.current=!0,console.log("get");const{userPlaylists:m,userSongs:p}=await wG(s);n(p),r(m);break;case"dashboard":{const g=await K0({variant:"dashboard"}),w=await Q0({variant:"admin"});n(g||[]),r(w||[]);break}}}catch(d){console.log({message:d})}finally{l(!1)}};return f.useEffect(()=>{if(a)return l(!0);u()},[a]),{isFetching:o}}function _G(){const{isOnMobile:t}=H(),{isFetching:e}=ix({variant:"home"});return c.jsxs("div",{className:"pb-[80px]",children:[t&&c.jsx(zq,{}),c.jsxs("div",{className:"mb-[30px]",children:[c.jsx("h3",{className:"text-xl leading-[2.2] font-playwriteCU mb-3",children:"Popular"}),c.jsx(rx,{loading:e,variant:"sys"})]}),c.jsx(iG,{loading:e}),t&&c.jsx("div",{className:"mt-[30px]",children:c.jsx(Uq,{})}),c.jsx(dm,{})]})}function EG({initialLoading:t}){const{songs:e}=Jt(),{tempSongs:n}=Lf(),{handleSetSong:r}=Qc({variant:"songs"}),i=f.useMemo(()=>n.length+e.length,[n,e]),s=a=>{r(a.queue_id,[a])};return c.jsxs(Js,{children:[c.jsx(vc,{variant:"dashboard-songs",children:t?c.jsx(c.Fragment,{children:c.jsx("div",{className:"h-[30px] mb-[10px] flex items-center",children:c.jsx(ft,{className:"h-[20px] w-[90px]"})})}):c.jsxs("p",{className:"font-semibold opacity-[.6]",children:[i," Songs"]})}),c.jsxs("div",{className:"min-h-[50vh]",children:[t&&Yh,!t&&c.jsx(c.Fragment,{children:i?c.jsxs(c.Fragment,{children:[c.jsx(Zi,{variant:"dashboard-songs",tempSongs:n,songs:e,handleSetSong:s}),c.jsx(Zi,{variant:"uploading",songs:n})]}):c.jsx("p",{className:"text-center",children:"¯\\_(ツ)_/¯"})})]})]})}function SG(){const{theme:t}=H(),{isFetching:e}=ix({variant:"dashboard"});return c.jsx(c.Fragment,{children:c.jsx("div",{className:"pt-10 pb-[calc(90px+40px)]",children:c.jsx("div",{className:"mt-[30px]",children:c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"text-xl font-playwriteCU leading-[2.4] mb-3",children:"Playlist"}),c.jsx(rx,{loading:e,variant:"dashboard"}),c.jsxs("div",{className:"mt-[30px] flex justify-between mb-[10px]",children:[c.jsx("div",{className:"text-xl font-playwriteCU leading-[2.4]",children:"Songs"}),c.jsx("div",{className:"flex items-center",children:c.jsxs("label",{className:`${t.content_bg} ${e?"disable":""} rounded-full flex px-[20px] py-[4px] cursor-pointer`,htmlFor:"song_upload",children:[c.jsx(aj,{className:"w-[20px] mr-[5px]"}),"Upload"]})})]}),c.jsx(EG,{initialLoading:e})]})})})})}function kG(){const{currentPlaylist:t}=oe(as),e=f.useMemo(()=>(t==null?void 0:t.by)==="admin",[t]);xR({});const{isFetching:n}=cP(),r=()=>e?c.jsx(q0,{loading:n,variant:"sys-playlist"}):c.jsx(q0,{loading:n,variant:"my-playlist"}),i=()=>e?c.jsx(G0,{loading:n,variant:"sys-playlist"}):c.jsx(G0,{loading:n,variant:"my-playlist"});return c.jsxs("div",{className:"pb-[80px]",children:[c.jsx("div",{className:"mb-[30px]",children:c.jsx(um,{variant:e?"sys-playlist":"my-playlist"})}),r(),c.jsx("div",{className:"mt-[30px]",children:i()}),c.jsx(dm,{})]})}function bG({initialLoading:t}){const{songs:e}=Jt(),{tempSongs:n}=Lf(),{handleSetSong:r}=Qc({variant:"songs"}),i=a=>{r(a,e)},s=f.useMemo(()=>t?0:n.length+e.length,[n,e,t]);return c.jsxs(Js,{children:[c.jsx(vc,{variant:"my-songs",children:t?c.jsx(c.Fragment,{children:c.jsx("div",{className:"h-[30px] mb-[10px] flex items-center",children:c.jsx(ft,{className:"h-[20px] w-[90px]"})})}):c.jsxs("p",{className:"font-[500] opacity-[.5]",children:[s," Songs"]})}),c.jsxs("div",{className:"min-h-[50vh]",children:[t&&Yh,!t&&c.jsx(c.Fragment,{children:!!s&&c.jsxs(c.Fragment,{children:[c.jsx(Zi,{variant:"my-songs",handleSetSong:i,songs:e,tempSongs:n}),c.jsx(Zi,{songs:n,variant:"uploading"})]})})]})]})}function TG(){const{theme:t}=H(),{loading:e,user:n}=ln(),{status:r}=Lf(),i=ir(),{isFetching:s}=ix({variant:"user"});return f.useEffect(()=>{e||n||i(xn.Home)},[e]),c.jsxs("div",{className:"pb-[80px]",children:[c.jsx("div",{className:"mb-[30px]  md:hidden",children:c.jsx(um,{variant:"my-songs"})}),c.jsx("h3",{className:"font-playwriteCU leading-[2.2] mb-3 text-xl",children:"Playlist"}),c.jsx(rx,{loading:s,variant:"my-song"}),c.jsx("div",{className:"pt-[30px]"}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("h3",{className:"font-playwriteCU leading-[2.2] mb-3 text-xl",children:"Songs"}),c.jsxs("label",{className:`${t.content_bg} ${r==="uploading"||s?"disable":""} items-center hover:opacity-60 py-1 rounded-full flex px-4 cursor-pointer`,htmlFor:"song_upload",children:[c.jsx(ob,{className:"w-7 mr-1"}),c.jsx("span",{className:" font-playwriteCU leading-[2.2]",children:"Upload"})]})]}),c.jsx(bG,{initialLoading:s}),c.jsx(dm,{})]})}function IG(){return c.jsx(ZR,{children:c.jsx("div",{className:"fixed left-[10px] top-0 right-[10px] bottom-0 md:relative md:h-full",children:c.jsx(tP,{})})})}function CG(){return c.jsx(ZR,{children:c.jsx(tP,{admin:!0,children:c.jsx("div",{className:"mt-3",children:c.jsx(um,{variant:"dashboard-playlist"})})})})}function AG(){const{theme:t}=H();return c.jsxs("div",{className:`min-h-screen flex flex-col items-center justify-center ${t.container} ${t.text_color}`,children:[c.jsx("h1",{className:`text-[30px] font-bold border p-[10px] ${t.text_color}`,children:"Page Not found"}),c.jsx(Br,{to:"/",className:`${t.content_bg} font-bold  text-[#fff] mt-[20px] rounded-full flex px-[20px] py-[4px] cursor-pointer`,children:"Go home"})," "]})}function RG(){const{theme:t}=H(),e=ir(),n=async()=>{await AT(Us),e("/login")};return c.jsxs("div",{className:`${t.container} flex flex-col justify-center items-center min-h-screen`,children:[c.jsx("h1",{className:`text-[30px] font-bold border p-[10px] ${t.text_color}`,children:"Unauthorized"}),c.jsx(V,{onClick:n,variant:"primary",className:`${t.content_bg} font-bold text-[20px]  text-[#fff] rounded-full mt-[20px]`,children:"Exit"})]})}function PG(){var o,l;const[t]=Df(Us),{logIn:e}=Mf(),{theme:n}=H(),r=ir(),i=Rr(),s=((l=(o=i==null?void 0:i.state)==null?void 0:o.from)==null?void 0:l.pathname)||"/dashboard",a=async()=>{try{await e()}catch(u){console.log(u)}};return f.useEffect(()=>{if(t!=null&&t.email){r(s,{replace:!0});return}console.log("run effect")},[t]),c.jsxs("div",{className:`min-h-screen flex flex-col items-center justify-center ${n.container} ${n.text_color}`,children:[c.jsx(V,{onClick:a,variant:"default",className:`${n.content_bg} font-bold text-[#fff] text-[30px] rounded-full`,children:"Login with google"})," "]})}const xn={Home:"/",Dashboard:"/dashboard",DashboardPlaylist:"/dashboard/playlist/:id",DashboardEdit:"/dashboard/edit/:id",MySongs:"/mysongs",Favorite:"/favorite",Playlist:"/playlist/:id",Edit:"/mysongs/edit/:id"},NG=[{path:xn.Home,component:_G,layout:""},{path:xn.MySongs,component:TG,layout:""},{path:xn.Playlist,component:kG,layout:""},{path:xn.Edit,component:IG,layout:""}],jG=[{path:xn.Dashboard,component:SG,layout:Fp},{path:xn.DashboardPlaylist,component:mG,layout:Fp},{path:xn.DashboardEdit,component:CG,layout:Fp}],OS=({children:t})=>{const{theme:e}=H(),n=f.useRef(null),r={page:`left-0 top-0 right-0 bottom-0 md:relative md:flex md:h-screen md:overflow-hidden ${e.container} ${e.text_color}`,container:"h-full md:w-full px-[10px] md:px-[40px] pt-[60px] md:overflow-auto md:no-scrollbar"};return f.useEffect(()=>{const i=document.querySelector(".my-tag"),s=document.querySelector("body");s.style.backgroundColor=e.container_code,i&&i.setAttribute("content",e.container_code)},[e]),c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:`${r.page}`,children:[c.jsx(Xq,{}),c.jsxs("div",{ref:n,className:r.container,children:[c.jsx(Yq,{contentRef:n}),t]}),c.jsx(qq,{})]}),c.jsx(lP,{})]})},OG="/HD-MP3/assets/loading-b1210647.gif";function DG({allowedRole:t}){const{user:e,loading:n}=ln(),{theme:r}=H();return n?c.jsx("div",{className:`min-h-screen flex flex-col items-center justify-center ${r.container}`,children:c.jsx("img",{className:"w-[150px]",src:OG,alt:""})}):e&&(t!=null&&t.find(i=>e.role===i))||!t.length?c.jsx(rb,{}):c.jsx(b3,{replace:!0,to:"/login"})}function MG(){const{setUser:t}=ln(),[e,n]=Df(Us);return f.useEffect(()=>{if(n)return;(async()=>{try{if(!e||!e.email)return t({type:"set-user",user:null});const s=(await uo({collection:"users",id:e.email,msg:">>> api: get auth info"})).data();Object.assign(s,{email:e.email,display_name:e.displayName,photoURL:e.photoURL,like_song_ids:s.like_song_ids||[],playlist_ids:s.playlist_ids||[],play_history:s.play_history||[]}),t({type:"set-user",user:s})}catch(i){console.log({message:i})}})()},[n,e]),c.jsx(rb,{})}function LG(){return c.jsxs(c.Fragment,{children:[c.jsx(j3,{children:c.jsxs(I3,{children:[c.jsx(mi,{path:"/login",element:c.jsx(PG,{})}),c.jsx(mi,{path:"/unauthorized",element:c.jsx(RG,{})}),c.jsx(mi,{path:"*",element:c.jsx(AG,{})}),c.jsxs(mi,{element:c.jsx(MG,{}),children:[NG.map((t,e)=>{let n;const r=t.component;return t.layout?n=t.layout:n=OS,c.jsx(mi,{path:t.path,element:c.jsx(n,{children:c.jsx(r,{})})},e)}),c.jsx(mi,{element:c.jsx(DG,{allowedRole:["ADMIN"]}),children:jG.map((t,e)=>{let n;const r=t.component;return t.layout?n=t.layout:n=OS,c.jsx(mi,{path:t.path,element:c.jsx(n,{children:c.jsx(r,{})})},e)})})]})]})}),c.jsx(sG,{autoClose:!0})]})}const FG=XU({reducer:{currentPlaylist:lB,playStatus:BB,songQueue:GB}});zp.createRoot(document.getElementById("root")).render(c.jsx(WS.StrictMode,{children:c.jsx(y7,{children:c.jsx(X6,{children:c.jsx(dO,{children:c.jsx(x7,{children:c.jsx(S7,{children:c.jsx(pU,{store:FG,children:c.jsx(LG,{})})})})})})})}));
