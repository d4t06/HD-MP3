function W5(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function dE(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var hE={exports:{}},$f={},fE={exports:{}},Te={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xu=Symbol.for("react.element"),q5=Symbol.for("react.portal"),G5=Symbol.for("react.fragment"),Q5=Symbol.for("react.strict_mode"),K5=Symbol.for("react.profiler"),X5=Symbol.for("react.provider"),Y5=Symbol.for("react.context"),J5=Symbol.for("react.forward_ref"),Z5=Symbol.for("react.suspense"),eN=Symbol.for("react.memo"),tN=Symbol.for("react.lazy"),e_=Symbol.iterator;function nN(t){return t===null||typeof t!="object"?null:(t=e_&&t[e_]||t["@@iterator"],typeof t=="function"?t:null)}var mE={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},pE=Object.assign,gE={};function cl(t,e,n){this.props=t,this.context=e,this.refs=gE,this.updater=n||mE}cl.prototype.isReactComponent={};cl.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};cl.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function xE(){}xE.prototype=cl.prototype;function zx(t,e,n){this.props=t,this.context=e,this.refs=gE,this.updater=n||mE}var Ux=zx.prototype=new xE;Ux.constructor=zx;pE(Ux,cl.prototype);Ux.isPureReactComponent=!0;var t_=Array.isArray,yE=Object.prototype.hasOwnProperty,Vx={current:null},vE={key:!0,ref:!0,__self:!0,__source:!0};function wE(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)yE.call(e,r)&&!vE.hasOwnProperty(r)&&(s[r]=e[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:xu,type:t,key:i,ref:o,props:s,_owner:Vx.current}}function rN(t,e){return{$$typeof:xu,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Hx(t){return typeof t=="object"&&t!==null&&t.$$typeof===xu}function sN(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var n_=/\/+/g;function _p(t,e){return typeof t=="object"&&t!==null&&t.key!=null?sN(""+t.key):e.toString(36)}function Jd(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case xu:case q5:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+_p(o,0):r,t_(s)?(n="",t!=null&&(n=t.replace(n_,"$&/")+"/"),Jd(s,e,n,"",function(u){return u})):s!=null&&(Hx(s)&&(s=rN(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(n_,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",t_(t))for(var l=0;l<t.length;l++){i=t[l];var c=r+_p(i,l);o+=Jd(i,e,n,c,s)}else if(c=nN(t),typeof c=="function")for(t=c.call(t),l=0;!(i=t.next()).done;)i=i.value,c=r+_p(i,l++),o+=Jd(i,e,n,c,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function gd(t,e,n){if(t==null)return t;var r=[],s=0;return Jd(t,r,"","",function(i){return e.call(n,i,s++)}),r}function iN(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var bn={current:null},Zd={transition:null},aN={ReactCurrentDispatcher:bn,ReactCurrentBatchConfig:Zd,ReactCurrentOwner:Vx};Te.Children={map:gd,forEach:function(t,e,n){gd(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return gd(t,function(){e++}),e},toArray:function(t){return gd(t,function(e){return e})||[]},only:function(t){if(!Hx(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Te.Component=cl;Te.Fragment=G5;Te.Profiler=K5;Te.PureComponent=zx;Te.StrictMode=Q5;Te.Suspense=Z5;Te.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=aN;Te.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=pE({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=Vx.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)yE.call(e,c)&&!vE.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:xu,type:t.type,key:s,ref:i,props:r,_owner:o}};Te.createContext=function(t){return t={$$typeof:Y5,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:X5,_context:t},t.Consumer=t};Te.createElement=wE;Te.createFactory=function(t){var e=wE.bind(null,t);return e.type=t,e};Te.createRef=function(){return{current:null}};Te.forwardRef=function(t){return{$$typeof:J5,render:t}};Te.isValidElement=Hx;Te.lazy=function(t){return{$$typeof:tN,_payload:{_status:-1,_result:t},_init:iN}};Te.memo=function(t,e){return{$$typeof:eN,type:t,compare:e===void 0?null:e}};Te.startTransition=function(t){var e=Zd.transition;Zd.transition={};try{t()}finally{Zd.transition=e}};Te.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Te.useCallback=function(t,e){return bn.current.useCallback(t,e)};Te.useContext=function(t){return bn.current.useContext(t)};Te.useDebugValue=function(){};Te.useDeferredValue=function(t){return bn.current.useDeferredValue(t)};Te.useEffect=function(t,e){return bn.current.useEffect(t,e)};Te.useId=function(){return bn.current.useId()};Te.useImperativeHandle=function(t,e,n){return bn.current.useImperativeHandle(t,e,n)};Te.useInsertionEffect=function(t,e){return bn.current.useInsertionEffect(t,e)};Te.useLayoutEffect=function(t,e){return bn.current.useLayoutEffect(t,e)};Te.useMemo=function(t,e){return bn.current.useMemo(t,e)};Te.useReducer=function(t,e,n){return bn.current.useReducer(t,e,n)};Te.useRef=function(t){return bn.current.useRef(t)};Te.useState=function(t){return bn.current.useState(t)};Te.useSyncExternalStore=function(t,e,n){return bn.current.useSyncExternalStore(t,e,n)};Te.useTransition=function(){return bn.current.useTransition()};Te.version="18.2.0";fE.exports=Te;var f=fE.exports;const _E=dE(f),oN=W5({__proto__:null,default:_E},[f]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lN=f,cN=Symbol.for("react.element"),uN=Symbol.for("react.fragment"),dN=Object.prototype.hasOwnProperty,hN=lN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,fN={key:!0,ref:!0,__self:!0,__source:!0};function bE(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)dN.call(e,r)&&!fN.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:cN,type:t,key:i,ref:o,props:s,_owner:hN.current}}$f.Fragment=uN;$f.jsx=bE;$f.jsxs=bE;hE.exports=$f;var a=hE.exports;var Mg={},SE={exports:{}},tr={},EE={exports:{}},kE={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(H,Y){var te=H.length;H.push(Y);e:for(;0<te;){var _e=te-1>>>1,Ie=H[_e];if(0<s(Ie,Y))H[_e]=Y,H[te]=Ie,te=_e;else break e}}function n(H){return H.length===0?null:H[0]}function r(H){if(H.length===0)return null;var Y=H[0],te=H.pop();if(te!==Y){H[0]=te;e:for(var _e=0,Ie=H.length,We=Ie>>>1;_e<We;){var Ir=2*(_e+1)-1,ir=H[Ir],ar=Ir+1,Ln=H[ar];if(0>s(ir,te))ar<Ie&&0>s(Ln,ir)?(H[_e]=Ln,H[ar]=te,_e=ar):(H[_e]=ir,H[Ir]=te,_e=Ir);else if(ar<Ie&&0>s(Ln,te))H[_e]=Ln,H[ar]=te,_e=ar;else break e}}return Y}function s(H,Y){var te=H.sortIndex-Y.sortIndex;return te!==0?te:H.id-Y.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,m=null,p=3,g=!1,y=!1,w=!1,_=typeof setTimeout=="function"?setTimeout:null,E=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(H){for(var Y=n(u);Y!==null;){if(Y.callback===null)r(u);else if(Y.startTime<=H)r(u),Y.sortIndex=Y.expirationTime,e(c,Y);else break;Y=n(u)}}function C(H){if(w=!1,S(H),!y)if(n(c)!==null)y=!0,ye(D);else{var Y=n(u);Y!==null&&Ne(C,Y.startTime-H)}}function D(H,Y){y=!1,w&&(w=!1,E(k),k=-1),g=!0;var te=p;try{for(S(Y),m=n(c);m!==null&&(!(m.expirationTime>Y)||H&&!N());){var _e=m.callback;if(typeof _e=="function"){m.callback=null,p=m.priorityLevel;var Ie=_e(m.expirationTime<=Y);Y=t.unstable_now(),typeof Ie=="function"?m.callback=Ie:m===n(c)&&r(c),S(Y)}else r(c);m=n(c)}if(m!==null)var We=!0;else{var Ir=n(u);Ir!==null&&Ne(C,Ir.startTime-Y),We=!1}return We}finally{m=null,p=te,g=!1}}var F=!1,I=null,k=-1,R=5,j=-1;function N(){return!(t.unstable_now()-j<R)}function P(){if(I!==null){var H=t.unstable_now();j=H;var Y=!0;try{Y=I(!0,H)}finally{Y?A():(F=!1,I=null)}}else F=!1}var A;if(typeof b=="function")A=function(){b(P)};else if(typeof MessageChannel<"u"){var ee=new MessageChannel,me=ee.port2;ee.port1.onmessage=P,A=function(){me.postMessage(null)}}else A=function(){_(P,0)};function ye(H){I=H,F||(F=!0,A())}function Ne(H,Y){k=_(function(){H(t.unstable_now())},Y)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(H){H.callback=null},t.unstable_continueExecution=function(){y||g||(y=!0,ye(D))},t.unstable_forceFrameRate=function(H){0>H||125<H?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<H?Math.floor(1e3/H):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(H){switch(p){case 1:case 2:case 3:var Y=3;break;default:Y=p}var te=p;p=Y;try{return H()}finally{p=te}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(H,Y){switch(H){case 1:case 2:case 3:case 4:case 5:break;default:H=3}var te=p;p=H;try{return Y()}finally{p=te}},t.unstable_scheduleCallback=function(H,Y,te){var _e=t.unstable_now();switch(typeof te=="object"&&te!==null?(te=te.delay,te=typeof te=="number"&&0<te?_e+te:_e):te=_e,H){case 1:var Ie=-1;break;case 2:Ie=250;break;case 5:Ie=1073741823;break;case 4:Ie=1e4;break;default:Ie=5e3}return Ie=te+Ie,H={id:d++,callback:Y,priorityLevel:H,startTime:te,expirationTime:Ie,sortIndex:-1},te>_e?(H.sortIndex=te,e(u,H),n(c)===null&&H===n(u)&&(w?(E(k),k=-1):w=!0,Ne(C,te-_e))):(H.sortIndex=Ie,e(c,H),y||g||(y=!0,ye(D))),H},t.unstable_shouldYield=N,t.unstable_wrapCallback=function(H){var Y=p;return function(){var te=p;p=Y;try{return H.apply(this,arguments)}finally{p=te}}}})(kE);EE.exports=kE;var mN=EE.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var TE=f,Jn=mN;function V(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var IE=new Set,Ac={};function Ka(t,e){Ho(t,e),Ho(t+"Capture",e)}function Ho(t,e){for(Ac[t]=e,t=0;t<e.length;t++)IE.add(e[t])}var Ms=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Og=Object.prototype.hasOwnProperty,pN=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,r_={},s_={};function gN(t){return Og.call(s_,t)?!0:Og.call(r_,t)?!1:pN.test(t)?s_[t]=!0:(r_[t]=!0,!1)}function xN(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function yN(t,e,n,r){if(e===null||typeof e>"u"||xN(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Sn(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var Vt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Vt[t]=new Sn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Vt[e]=new Sn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Vt[t]=new Sn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Vt[t]=new Sn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Vt[t]=new Sn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Vt[t]=new Sn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Vt[t]=new Sn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Vt[t]=new Sn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Vt[t]=new Sn(t,5,!1,t.toLowerCase(),null,!1,!1)});var Wx=/[\-:]([a-z])/g;function qx(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Wx,qx);Vt[e]=new Sn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Wx,qx);Vt[e]=new Sn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Wx,qx);Vt[e]=new Sn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Vt[t]=new Sn(t,1,!1,t.toLowerCase(),null,!1,!1)});Vt.xlinkHref=new Sn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Vt[t]=new Sn(t,1,!1,t.toLowerCase(),null,!0,!0)});function Gx(t,e,n,r){var s=Vt.hasOwnProperty(e)?Vt[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(yN(e,n,s,r)&&(n=null),r||s===null?gN(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Xs=TE.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,xd=Symbol.for("react.element"),wo=Symbol.for("react.portal"),_o=Symbol.for("react.fragment"),Qx=Symbol.for("react.strict_mode"),$g=Symbol.for("react.profiler"),CE=Symbol.for("react.provider"),jE=Symbol.for("react.context"),Kx=Symbol.for("react.forward_ref"),Bg=Symbol.for("react.suspense"),zg=Symbol.for("react.suspense_list"),Xx=Symbol.for("react.memo"),mi=Symbol.for("react.lazy"),RE=Symbol.for("react.offscreen"),i_=Symbol.iterator;function ql(t){return t===null||typeof t!="object"?null:(t=i_&&t[i_]||t["@@iterator"],typeof t=="function"?t:null)}var st=Object.assign,bp;function ac(t){if(bp===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);bp=e&&e[1]||""}return`
`+bp+t}var Sp=!1;function Ep(t,e){if(!t||Sp)return"";Sp=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,l=i.length-1;1<=o&&0<=l&&s[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==i[l]){var c=`
`+s[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=l);break}}}finally{Sp=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?ac(t):""}function vN(t){switch(t.tag){case 5:return ac(t.type);case 16:return ac("Lazy");case 13:return ac("Suspense");case 19:return ac("SuspenseList");case 0:case 2:case 15:return t=Ep(t.type,!1),t;case 11:return t=Ep(t.type.render,!1),t;case 1:return t=Ep(t.type,!0),t;default:return""}}function Ug(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case _o:return"Fragment";case wo:return"Portal";case $g:return"Profiler";case Qx:return"StrictMode";case Bg:return"Suspense";case zg:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case jE:return(t.displayName||"Context")+".Consumer";case CE:return(t._context.displayName||"Context")+".Provider";case Kx:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Xx:return e=t.displayName||null,e!==null?e:Ug(t.type)||"Memo";case mi:e=t._payload,t=t._init;try{return Ug(t(e))}catch{}}return null}function wN(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ug(e);case 8:return e===Qx?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Bi(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function AE(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function _N(t){var e=AE(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function yd(t){t._valueTracker||(t._valueTracker=_N(t))}function NE(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=AE(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Th(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Vg(t,e){var n=e.checked;return st({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function a_(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Bi(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function PE(t,e){e=e.checked,e!=null&&Gx(t,"checked",e,!1)}function Hg(t,e){PE(t,e);var n=Bi(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Wg(t,e.type,n):e.hasOwnProperty("defaultValue")&&Wg(t,e.type,Bi(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function o_(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Wg(t,e,n){(e!=="number"||Th(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var oc=Array.isArray;function Fo(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Bi(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function qg(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(V(91));return st({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function l_(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(V(92));if(oc(n)){if(1<n.length)throw Error(V(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Bi(n)}}function FE(t,e){var n=Bi(e.value),r=Bi(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function c_(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function DE(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Gg(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?DE(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var vd,LE=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(vd=vd||document.createElement("div"),vd.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=vd.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Nc(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var gc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},bN=["Webkit","ms","Moz","O"];Object.keys(gc).forEach(function(t){bN.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),gc[e]=gc[t]})});function ME(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||gc.hasOwnProperty(t)&&gc[t]?(""+e).trim():e+"px"}function OE(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=ME(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var SN=st({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Qg(t,e){if(e){if(SN[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(V(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(V(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(V(61))}if(e.style!=null&&typeof e.style!="object")throw Error(V(62))}}function Kg(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Xg=null;function Yx(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Yg=null,Do=null,Lo=null;function u_(t){if(t=wu(t)){if(typeof Yg!="function")throw Error(V(280));var e=t.stateNode;e&&(e=Hf(e),Yg(t.stateNode,t.type,e))}}function $E(t){Do?Lo?Lo.push(t):Lo=[t]:Do=t}function BE(){if(Do){var t=Do,e=Lo;if(Lo=Do=null,u_(t),e)for(t=0;t<e.length;t++)u_(e[t])}}function zE(t,e){return t(e)}function UE(){}var kp=!1;function VE(t,e,n){if(kp)return t(e,n);kp=!0;try{return zE(t,e,n)}finally{kp=!1,(Do!==null||Lo!==null)&&(UE(),BE())}}function Pc(t,e){var n=t.stateNode;if(n===null)return null;var r=Hf(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(V(231,e,typeof n));return n}var Jg=!1;if(Ms)try{var Gl={};Object.defineProperty(Gl,"passive",{get:function(){Jg=!0}}),window.addEventListener("test",Gl,Gl),window.removeEventListener("test",Gl,Gl)}catch{Jg=!1}function EN(t,e,n,r,s,i,o,l,c){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(d){this.onError(d)}}var xc=!1,Ih=null,Ch=!1,Zg=null,kN={onError:function(t){xc=!0,Ih=t}};function TN(t,e,n,r,s,i,o,l,c){xc=!1,Ih=null,EN.apply(kN,arguments)}function IN(t,e,n,r,s,i,o,l,c){if(TN.apply(this,arguments),xc){if(xc){var u=Ih;xc=!1,Ih=null}else throw Error(V(198));Ch||(Ch=!0,Zg=u)}}function Xa(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function HE(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function d_(t){if(Xa(t)!==t)throw Error(V(188))}function CN(t){var e=t.alternate;if(!e){if(e=Xa(t),e===null)throw Error(V(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return d_(s),t;if(i===r)return d_(s),e;i=i.sibling}throw Error(V(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o)throw Error(V(189))}}if(n.alternate!==r)throw Error(V(190))}if(n.tag!==3)throw Error(V(188));return n.stateNode.current===n?t:e}function WE(t){return t=CN(t),t!==null?qE(t):null}function qE(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=qE(t);if(e!==null)return e;t=t.sibling}return null}var GE=Jn.unstable_scheduleCallback,h_=Jn.unstable_cancelCallback,jN=Jn.unstable_shouldYield,RN=Jn.unstable_requestPaint,mt=Jn.unstable_now,AN=Jn.unstable_getCurrentPriorityLevel,Jx=Jn.unstable_ImmediatePriority,QE=Jn.unstable_UserBlockingPriority,jh=Jn.unstable_NormalPriority,NN=Jn.unstable_LowPriority,KE=Jn.unstable_IdlePriority,Bf=null,ss=null;function PN(t){if(ss&&typeof ss.onCommitFiberRoot=="function")try{ss.onCommitFiberRoot(Bf,t,void 0,(t.current.flags&128)===128)}catch{}}var Mr=Math.clz32?Math.clz32:LN,FN=Math.log,DN=Math.LN2;function LN(t){return t>>>=0,t===0?32:31-(FN(t)/DN|0)|0}var wd=64,_d=4194304;function lc(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Rh(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var l=o&~s;l!==0?r=lc(l):(i&=o,i!==0&&(r=lc(i)))}else o=n&~s,o!==0?r=lc(o):i!==0&&(r=lc(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Mr(e),s=1<<n,r|=t[n],e&=~s;return r}function MN(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ON(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-Mr(i),l=1<<o,c=s[o];c===-1?(!(l&n)||l&r)&&(s[o]=MN(l,e)):c<=e&&(t.expiredLanes|=l),i&=~l}}function e0(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function XE(){var t=wd;return wd<<=1,!(wd&4194240)&&(wd=64),t}function Tp(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function yu(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Mr(e),t[e]=n}function $N(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-Mr(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function Zx(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Mr(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var Me=0;function YE(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var JE,ey,ZE,ek,tk,t0=!1,bd=[],Ii=null,Ci=null,ji=null,Fc=new Map,Dc=new Map,gi=[],BN="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function f_(t,e){switch(t){case"focusin":case"focusout":Ii=null;break;case"dragenter":case"dragleave":Ci=null;break;case"mouseover":case"mouseout":ji=null;break;case"pointerover":case"pointerout":Fc.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Dc.delete(e.pointerId)}}function Ql(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=wu(e),e!==null&&ey(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function zN(t,e,n,r,s){switch(e){case"focusin":return Ii=Ql(Ii,t,e,n,r,s),!0;case"dragenter":return Ci=Ql(Ci,t,e,n,r,s),!0;case"mouseover":return ji=Ql(ji,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return Fc.set(i,Ql(Fc.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Dc.set(i,Ql(Dc.get(i)||null,t,e,n,r,s)),!0}return!1}function nk(t){var e=va(t.target);if(e!==null){var n=Xa(e);if(n!==null){if(e=n.tag,e===13){if(e=HE(n),e!==null){t.blockedOn=e,tk(t.priority,function(){ZE(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function eh(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=n0(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Xg=r,n.target.dispatchEvent(r),Xg=null}else return e=wu(n),e!==null&&ey(e),t.blockedOn=n,!1;e.shift()}return!0}function m_(t,e,n){eh(t)&&n.delete(e)}function UN(){t0=!1,Ii!==null&&eh(Ii)&&(Ii=null),Ci!==null&&eh(Ci)&&(Ci=null),ji!==null&&eh(ji)&&(ji=null),Fc.forEach(m_),Dc.forEach(m_)}function Kl(t,e){t.blockedOn===e&&(t.blockedOn=null,t0||(t0=!0,Jn.unstable_scheduleCallback(Jn.unstable_NormalPriority,UN)))}function Lc(t){function e(s){return Kl(s,t)}if(0<bd.length){Kl(bd[0],t);for(var n=1;n<bd.length;n++){var r=bd[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Ii!==null&&Kl(Ii,t),Ci!==null&&Kl(Ci,t),ji!==null&&Kl(ji,t),Fc.forEach(e),Dc.forEach(e),n=0;n<gi.length;n++)r=gi[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<gi.length&&(n=gi[0],n.blockedOn===null);)nk(n),n.blockedOn===null&&gi.shift()}var Mo=Xs.ReactCurrentBatchConfig,Ah=!0;function VN(t,e,n,r){var s=Me,i=Mo.transition;Mo.transition=null;try{Me=1,ty(t,e,n,r)}finally{Me=s,Mo.transition=i}}function HN(t,e,n,r){var s=Me,i=Mo.transition;Mo.transition=null;try{Me=4,ty(t,e,n,r)}finally{Me=s,Mo.transition=i}}function ty(t,e,n,r){if(Ah){var s=n0(t,e,n,r);if(s===null)Lp(t,e,r,Nh,n),f_(t,r);else if(zN(s,t,e,n,r))r.stopPropagation();else if(f_(t,r),e&4&&-1<BN.indexOf(t)){for(;s!==null;){var i=wu(s);if(i!==null&&JE(i),i=n0(t,e,n,r),i===null&&Lp(t,e,r,Nh,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else Lp(t,e,r,null,n)}}var Nh=null;function n0(t,e,n,r){if(Nh=null,t=Yx(r),t=va(t),t!==null)if(e=Xa(t),e===null)t=null;else if(n=e.tag,n===13){if(t=HE(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Nh=t,null}function rk(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(AN()){case Jx:return 1;case QE:return 4;case jh:case NN:return 16;case KE:return 536870912;default:return 16}default:return 16}}var Si=null,ny=null,th=null;function sk(){if(th)return th;var t,e=ny,n=e.length,r,s="value"in Si?Si.value:Si.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return th=s.slice(t,1<r?1-r:void 0)}function nh(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Sd(){return!0}function p_(){return!1}function nr(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Sd:p_,this.isPropagationStopped=p_,this}return st(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Sd)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Sd)},persist:function(){},isPersistent:Sd}),e}var ul={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ry=nr(ul),vu=st({},ul,{view:0,detail:0}),WN=nr(vu),Ip,Cp,Xl,zf=st({},vu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:sy,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Xl&&(Xl&&t.type==="mousemove"?(Ip=t.screenX-Xl.screenX,Cp=t.screenY-Xl.screenY):Cp=Ip=0,Xl=t),Ip)},movementY:function(t){return"movementY"in t?t.movementY:Cp}}),g_=nr(zf),qN=st({},zf,{dataTransfer:0}),GN=nr(qN),QN=st({},vu,{relatedTarget:0}),jp=nr(QN),KN=st({},ul,{animationName:0,elapsedTime:0,pseudoElement:0}),XN=nr(KN),YN=st({},ul,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),JN=nr(YN),ZN=st({},ul,{data:0}),x_=nr(ZN),eP={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},tP={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},nP={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function rP(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=nP[t])?!!e[t]:!1}function sy(){return rP}var sP=st({},vu,{key:function(t){if(t.key){var e=eP[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=nh(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?tP[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:sy,charCode:function(t){return t.type==="keypress"?nh(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?nh(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),iP=nr(sP),aP=st({},zf,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),y_=nr(aP),oP=st({},vu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:sy}),lP=nr(oP),cP=st({},ul,{propertyName:0,elapsedTime:0,pseudoElement:0}),uP=nr(cP),dP=st({},zf,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),hP=nr(dP),fP=[9,13,27,32],iy=Ms&&"CompositionEvent"in window,yc=null;Ms&&"documentMode"in document&&(yc=document.documentMode);var mP=Ms&&"TextEvent"in window&&!yc,ik=Ms&&(!iy||yc&&8<yc&&11>=yc),v_=String.fromCharCode(32),w_=!1;function ak(t,e){switch(t){case"keyup":return fP.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ok(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var bo=!1;function pP(t,e){switch(t){case"compositionend":return ok(e);case"keypress":return e.which!==32?null:(w_=!0,v_);case"textInput":return t=e.data,t===v_&&w_?null:t;default:return null}}function gP(t,e){if(bo)return t==="compositionend"||!iy&&ak(t,e)?(t=sk(),th=ny=Si=null,bo=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return ik&&e.locale!=="ko"?null:e.data;default:return null}}var xP={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function __(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!xP[t.type]:e==="textarea"}function lk(t,e,n,r){$E(r),e=Ph(e,"onChange"),0<e.length&&(n=new ry("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var vc=null,Mc=null;function yP(t){vk(t,0)}function Uf(t){var e=ko(t);if(NE(e))return t}function vP(t,e){if(t==="change")return e}var ck=!1;if(Ms){var Rp;if(Ms){var Ap="oninput"in document;if(!Ap){var b_=document.createElement("div");b_.setAttribute("oninput","return;"),Ap=typeof b_.oninput=="function"}Rp=Ap}else Rp=!1;ck=Rp&&(!document.documentMode||9<document.documentMode)}function S_(){vc&&(vc.detachEvent("onpropertychange",uk),Mc=vc=null)}function uk(t){if(t.propertyName==="value"&&Uf(Mc)){var e=[];lk(e,Mc,t,Yx(t)),VE(yP,e)}}function wP(t,e,n){t==="focusin"?(S_(),vc=e,Mc=n,vc.attachEvent("onpropertychange",uk)):t==="focusout"&&S_()}function _P(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Uf(Mc)}function bP(t,e){if(t==="click")return Uf(e)}function SP(t,e){if(t==="input"||t==="change")return Uf(e)}function EP(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var zr=typeof Object.is=="function"?Object.is:EP;function Oc(t,e){if(zr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Og.call(e,s)||!zr(t[s],e[s]))return!1}return!0}function E_(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function k_(t,e){var n=E_(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=E_(n)}}function dk(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?dk(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function hk(){for(var t=window,e=Th();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Th(t.document)}return e}function ay(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function kP(t){var e=hk(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&dk(n.ownerDocument.documentElement,n)){if(r!==null&&ay(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=k_(n,i);var o=k_(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var TP=Ms&&"documentMode"in document&&11>=document.documentMode,So=null,r0=null,wc=null,s0=!1;function T_(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;s0||So==null||So!==Th(r)||(r=So,"selectionStart"in r&&ay(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),wc&&Oc(wc,r)||(wc=r,r=Ph(r0,"onSelect"),0<r.length&&(e=new ry("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=So)))}function Ed(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Eo={animationend:Ed("Animation","AnimationEnd"),animationiteration:Ed("Animation","AnimationIteration"),animationstart:Ed("Animation","AnimationStart"),transitionend:Ed("Transition","TransitionEnd")},Np={},fk={};Ms&&(fk=document.createElement("div").style,"AnimationEvent"in window||(delete Eo.animationend.animation,delete Eo.animationiteration.animation,delete Eo.animationstart.animation),"TransitionEvent"in window||delete Eo.transitionend.transition);function Vf(t){if(Np[t])return Np[t];if(!Eo[t])return t;var e=Eo[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in fk)return Np[t]=e[n];return t}var mk=Vf("animationend"),pk=Vf("animationiteration"),gk=Vf("animationstart"),xk=Vf("transitionend"),yk=new Map,I_="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Gi(t,e){yk.set(t,e),Ka(e,[t])}for(var Pp=0;Pp<I_.length;Pp++){var Fp=I_[Pp],IP=Fp.toLowerCase(),CP=Fp[0].toUpperCase()+Fp.slice(1);Gi(IP,"on"+CP)}Gi(mk,"onAnimationEnd");Gi(pk,"onAnimationIteration");Gi(gk,"onAnimationStart");Gi("dblclick","onDoubleClick");Gi("focusin","onFocus");Gi("focusout","onBlur");Gi(xk,"onTransitionEnd");Ho("onMouseEnter",["mouseout","mouseover"]);Ho("onMouseLeave",["mouseout","mouseover"]);Ho("onPointerEnter",["pointerout","pointerover"]);Ho("onPointerLeave",["pointerout","pointerover"]);Ka("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ka("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ka("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ka("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ka("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ka("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var cc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),jP=new Set("cancel close invalid load scroll toggle".split(" ").concat(cc));function C_(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,IN(r,e,void 0,t),t.currentTarget=null}function vk(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var l=r[o],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==i&&s.isPropagationStopped())break e;C_(s,l,u),i=c}else for(o=0;o<r.length;o++){if(l=r[o],c=l.instance,u=l.currentTarget,l=l.listener,c!==i&&s.isPropagationStopped())break e;C_(s,l,u),i=c}}}if(Ch)throw t=Zg,Ch=!1,Zg=null,t}function Ge(t,e){var n=e[c0];n===void 0&&(n=e[c0]=new Set);var r=t+"__bubble";n.has(r)||(wk(e,t,2,!1),n.add(r))}function Dp(t,e,n){var r=0;e&&(r|=4),wk(n,t,r,e)}var kd="_reactListening"+Math.random().toString(36).slice(2);function $c(t){if(!t[kd]){t[kd]=!0,IE.forEach(function(n){n!=="selectionchange"&&(jP.has(n)||Dp(n,!1,t),Dp(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[kd]||(e[kd]=!0,Dp("selectionchange",!1,e))}}function wk(t,e,n,r){switch(rk(e)){case 1:var s=VN;break;case 4:s=HN;break;default:s=ty}n=s.bind(null,e,n,t),s=void 0,!Jg||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function Lp(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;o=o.return}for(;l!==null;){if(o=va(l),o===null)return;if(c=o.tag,c===5||c===6){r=i=o;continue e}l=l.parentNode}}r=r.return}VE(function(){var u=i,d=Yx(n),m=[];e:{var p=yk.get(t);if(p!==void 0){var g=ry,y=t;switch(t){case"keypress":if(nh(n)===0)break e;case"keydown":case"keyup":g=iP;break;case"focusin":y="focus",g=jp;break;case"focusout":y="blur",g=jp;break;case"beforeblur":case"afterblur":g=jp;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=g_;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=GN;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=lP;break;case mk:case pk:case gk:g=XN;break;case xk:g=uP;break;case"scroll":g=WN;break;case"wheel":g=hP;break;case"copy":case"cut":case"paste":g=JN;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=y_}var w=(e&4)!==0,_=!w&&t==="scroll",E=w?p!==null?p+"Capture":null:p;w=[];for(var b=u,S;b!==null;){S=b;var C=S.stateNode;if(S.tag===5&&C!==null&&(S=C,E!==null&&(C=Pc(b,E),C!=null&&w.push(Bc(b,C,S)))),_)break;b=b.return}0<w.length&&(p=new g(p,y,null,n,d),m.push({event:p,listeners:w}))}}if(!(e&7)){e:{if(p=t==="mouseover"||t==="pointerover",g=t==="mouseout"||t==="pointerout",p&&n!==Xg&&(y=n.relatedTarget||n.fromElement)&&(va(y)||y[Os]))break e;if((g||p)&&(p=d.window===d?d:(p=d.ownerDocument)?p.defaultView||p.parentWindow:window,g?(y=n.relatedTarget||n.toElement,g=u,y=y?va(y):null,y!==null&&(_=Xa(y),y!==_||y.tag!==5&&y.tag!==6)&&(y=null)):(g=null,y=u),g!==y)){if(w=g_,C="onMouseLeave",E="onMouseEnter",b="mouse",(t==="pointerout"||t==="pointerover")&&(w=y_,C="onPointerLeave",E="onPointerEnter",b="pointer"),_=g==null?p:ko(g),S=y==null?p:ko(y),p=new w(C,b+"leave",g,n,d),p.target=_,p.relatedTarget=S,C=null,va(d)===u&&(w=new w(E,b+"enter",y,n,d),w.target=S,w.relatedTarget=_,C=w),_=C,g&&y)t:{for(w=g,E=y,b=0,S=w;S;S=ho(S))b++;for(S=0,C=E;C;C=ho(C))S++;for(;0<b-S;)w=ho(w),b--;for(;0<S-b;)E=ho(E),S--;for(;b--;){if(w===E||E!==null&&w===E.alternate)break t;w=ho(w),E=ho(E)}w=null}else w=null;g!==null&&j_(m,p,g,w,!1),y!==null&&_!==null&&j_(m,_,y,w,!0)}}e:{if(p=u?ko(u):window,g=p.nodeName&&p.nodeName.toLowerCase(),g==="select"||g==="input"&&p.type==="file")var D=vP;else if(__(p))if(ck)D=SP;else{D=_P;var F=wP}else(g=p.nodeName)&&g.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(D=bP);if(D&&(D=D(t,u))){lk(m,D,n,d);break e}F&&F(t,p,u),t==="focusout"&&(F=p._wrapperState)&&F.controlled&&p.type==="number"&&Wg(p,"number",p.value)}switch(F=u?ko(u):window,t){case"focusin":(__(F)||F.contentEditable==="true")&&(So=F,r0=u,wc=null);break;case"focusout":wc=r0=So=null;break;case"mousedown":s0=!0;break;case"contextmenu":case"mouseup":case"dragend":s0=!1,T_(m,n,d);break;case"selectionchange":if(TP)break;case"keydown":case"keyup":T_(m,n,d)}var I;if(iy)e:{switch(t){case"compositionstart":var k="onCompositionStart";break e;case"compositionend":k="onCompositionEnd";break e;case"compositionupdate":k="onCompositionUpdate";break e}k=void 0}else bo?ak(t,n)&&(k="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(k="onCompositionStart");k&&(ik&&n.locale!=="ko"&&(bo||k!=="onCompositionStart"?k==="onCompositionEnd"&&bo&&(I=sk()):(Si=d,ny="value"in Si?Si.value:Si.textContent,bo=!0)),F=Ph(u,k),0<F.length&&(k=new x_(k,t,null,n,d),m.push({event:k,listeners:F}),I?k.data=I:(I=ok(n),I!==null&&(k.data=I)))),(I=mP?pP(t,n):gP(t,n))&&(u=Ph(u,"onBeforeInput"),0<u.length&&(d=new x_("onBeforeInput","beforeinput",null,n,d),m.push({event:d,listeners:u}),d.data=I))}vk(m,e)})}function Bc(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Ph(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Pc(t,n),i!=null&&r.unshift(Bc(t,i,s)),i=Pc(t,e),i!=null&&r.push(Bc(t,i,s))),t=t.return}return r}function ho(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function j_(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var l=n,c=l.alternate,u=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&u!==null&&(l=u,s?(c=Pc(n,i),c!=null&&o.unshift(Bc(n,c,l))):s||(c=Pc(n,i),c!=null&&o.push(Bc(n,c,l)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var RP=/\r\n?/g,AP=/\u0000|\uFFFD/g;function R_(t){return(typeof t=="string"?t:""+t).replace(RP,`
`).replace(AP,"")}function Td(t,e,n){if(e=R_(e),R_(t)!==e&&n)throw Error(V(425))}function Fh(){}var i0=null,a0=null;function o0(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var l0=typeof setTimeout=="function"?setTimeout:void 0,NP=typeof clearTimeout=="function"?clearTimeout:void 0,A_=typeof Promise=="function"?Promise:void 0,PP=typeof queueMicrotask=="function"?queueMicrotask:typeof A_<"u"?function(t){return A_.resolve(null).then(t).catch(FP)}:l0;function FP(t){setTimeout(function(){throw t})}function Mp(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),Lc(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Lc(e)}function Ri(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function N_(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var dl=Math.random().toString(36).slice(2),ts="__reactFiber$"+dl,zc="__reactProps$"+dl,Os="__reactContainer$"+dl,c0="__reactEvents$"+dl,DP="__reactListeners$"+dl,LP="__reactHandles$"+dl;function va(t){var e=t[ts];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Os]||n[ts]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=N_(t);t!==null;){if(n=t[ts])return n;t=N_(t)}return e}t=n,n=t.parentNode}return null}function wu(t){return t=t[ts]||t[Os],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function ko(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(V(33))}function Hf(t){return t[zc]||null}var u0=[],To=-1;function Qi(t){return{current:t}}function Ke(t){0>To||(t.current=u0[To],u0[To]=null,To--)}function Ve(t,e){To++,u0[To]=t.current,t.current=e}var zi={},sn=Qi(zi),Rn=Qi(!1),Ra=zi;function Wo(t,e){var n=t.type.contextTypes;if(!n)return zi;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function An(t){return t=t.childContextTypes,t!=null}function Dh(){Ke(Rn),Ke(sn)}function P_(t,e,n){if(sn.current!==zi)throw Error(V(168));Ve(sn,e),Ve(Rn,n)}function _k(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(V(108,wN(t)||"Unknown",s));return st({},n,r)}function Lh(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||zi,Ra=sn.current,Ve(sn,t),Ve(Rn,Rn.current),!0}function F_(t,e,n){var r=t.stateNode;if(!r)throw Error(V(169));n?(t=_k(t,e,Ra),r.__reactInternalMemoizedMergedChildContext=t,Ke(Rn),Ke(sn),Ve(sn,t)):Ke(Rn),Ve(Rn,n)}var ks=null,Wf=!1,Op=!1;function bk(t){ks===null?ks=[t]:ks.push(t)}function MP(t){Wf=!0,bk(t)}function Ki(){if(!Op&&ks!==null){Op=!0;var t=0,e=Me;try{var n=ks;for(Me=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}ks=null,Wf=!1}catch(s){throw ks!==null&&(ks=ks.slice(t+1)),GE(Jx,Ki),s}finally{Me=e,Op=!1}}return null}var Io=[],Co=0,Mh=null,Oh=0,cr=[],ur=0,Aa=null,Is=1,Cs="";function fa(t,e){Io[Co++]=Oh,Io[Co++]=Mh,Mh=t,Oh=e}function Sk(t,e,n){cr[ur++]=Is,cr[ur++]=Cs,cr[ur++]=Aa,Aa=t;var r=Is;t=Cs;var s=32-Mr(r)-1;r&=~(1<<s),n+=1;var i=32-Mr(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,Is=1<<32-Mr(e)+s|n<<s|r,Cs=i+t}else Is=1<<i|n<<s|r,Cs=t}function oy(t){t.return!==null&&(fa(t,1),Sk(t,1,0))}function ly(t){for(;t===Mh;)Mh=Io[--Co],Io[Co]=null,Oh=Io[--Co],Io[Co]=null;for(;t===Aa;)Aa=cr[--ur],cr[ur]=null,Cs=cr[--ur],cr[ur]=null,Is=cr[--ur],cr[ur]=null}var Qn=null,Hn=null,Ze=!1,Pr=null;function Ek(t,e){var n=dr(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function D_(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Qn=t,Hn=Ri(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Qn=t,Hn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Aa!==null?{id:Is,overflow:Cs}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=dr(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Qn=t,Hn=null,!0):!1;default:return!1}}function d0(t){return(t.mode&1)!==0&&(t.flags&128)===0}function h0(t){if(Ze){var e=Hn;if(e){var n=e;if(!D_(t,e)){if(d0(t))throw Error(V(418));e=Ri(n.nextSibling);var r=Qn;e&&D_(t,e)?Ek(r,n):(t.flags=t.flags&-4097|2,Ze=!1,Qn=t)}}else{if(d0(t))throw Error(V(418));t.flags=t.flags&-4097|2,Ze=!1,Qn=t}}}function L_(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Qn=t}function Id(t){if(t!==Qn)return!1;if(!Ze)return L_(t),Ze=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!o0(t.type,t.memoizedProps)),e&&(e=Hn)){if(d0(t))throw kk(),Error(V(418));for(;e;)Ek(t,e),e=Ri(e.nextSibling)}if(L_(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(V(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Hn=Ri(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Hn=null}}else Hn=Qn?Ri(t.stateNode.nextSibling):null;return!0}function kk(){for(var t=Hn;t;)t=Ri(t.nextSibling)}function qo(){Hn=Qn=null,Ze=!1}function cy(t){Pr===null?Pr=[t]:Pr.push(t)}var OP=Xs.ReactCurrentBatchConfig;function Ar(t,e){if(t&&t.defaultProps){e=st({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var $h=Qi(null),Bh=null,jo=null,uy=null;function dy(){uy=jo=Bh=null}function hy(t){var e=$h.current;Ke($h),t._currentValue=e}function f0(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Oo(t,e){Bh=t,uy=jo=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(jn=!0),t.firstContext=null)}function fr(t){var e=t._currentValue;if(uy!==t)if(t={context:t,memoizedValue:e,next:null},jo===null){if(Bh===null)throw Error(V(308));jo=t,Bh.dependencies={lanes:0,firstContext:t}}else jo=jo.next=t;return e}var wa=null;function fy(t){wa===null?wa=[t]:wa.push(t)}function Tk(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,fy(e)):(n.next=s.next,s.next=n),e.interleaved=n,$s(t,r)}function $s(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var pi=!1;function my(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ik(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Fs(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Ai(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Ae&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,$s(t,n)}return s=r.interleaved,s===null?(e.next=e,fy(r)):(e.next=s.next,s.next=e),r.interleaved=e,$s(t,n)}function rh(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Zx(t,n)}}function M_(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function zh(t,e,n,r){var s=t.updateQueue;pi=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,u=c.next;c.next=null,o===null?i=u:o.next=u,o=c;var d=t.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==o&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(i!==null){var m=s.baseState;o=0,d=u=c=null,l=i;do{var p=l.lane,g=l.eventTime;if((r&p)===p){d!==null&&(d=d.next={eventTime:g,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var y=t,w=l;switch(p=e,g=n,w.tag){case 1:if(y=w.payload,typeof y=="function"){m=y.call(g,m,p);break e}m=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=w.payload,p=typeof y=="function"?y.call(g,m,p):y,p==null)break e;m=st({},m,p);break e;case 2:pi=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,p=s.effects,p===null?s.effects=[l]:p.push(l))}else g={eventTime:g,lane:p,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=g,c=m):d=d.next=g,o|=p;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;p=l,l=p.next,p.next=null,s.lastBaseUpdate=p,s.shared.pending=null}}while(1);if(d===null&&(c=m),s.baseState=c,s.firstBaseUpdate=u,s.lastBaseUpdate=d,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);Pa|=o,t.lanes=o,t.memoizedState=m}}function O_(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(V(191,s));s.call(r)}}}var Ck=new TE.Component().refs;function m0(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:st({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var qf={isMounted:function(t){return(t=t._reactInternals)?Xa(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=pn(),s=Pi(t),i=Fs(r,s);i.payload=e,n!=null&&(i.callback=n),e=Ai(t,i,s),e!==null&&(Or(e,t,s,r),rh(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=pn(),s=Pi(t),i=Fs(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=Ai(t,i,s),e!==null&&(Or(e,t,s,r),rh(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=pn(),r=Pi(t),s=Fs(n,r);s.tag=2,e!=null&&(s.callback=e),e=Ai(t,s,r),e!==null&&(Or(e,t,r,n),rh(e,t,r))}};function $_(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!Oc(n,r)||!Oc(s,i):!0}function jk(t,e,n){var r=!1,s=zi,i=e.contextType;return typeof i=="object"&&i!==null?i=fr(i):(s=An(e)?Ra:sn.current,r=e.contextTypes,i=(r=r!=null)?Wo(t,s):zi),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=qf,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function B_(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&qf.enqueueReplaceState(e,e.state,null)}function p0(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs=Ck,my(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=fr(i):(i=An(e)?Ra:sn.current,s.context=Wo(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(m0(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&qf.enqueueReplaceState(s,s.state,null),zh(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function Yl(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(V(309));var r=n.stateNode}if(!r)throw Error(V(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var l=s.refs;l===Ck&&(l=s.refs={}),o===null?delete l[i]:l[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(V(284));if(!n._owner)throw Error(V(290,t))}return t}function Cd(t,e){throw t=Object.prototype.toString.call(e),Error(V(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function z_(t){var e=t._init;return e(t._payload)}function Rk(t){function e(E,b){if(t){var S=E.deletions;S===null?(E.deletions=[b],E.flags|=16):S.push(b)}}function n(E,b){if(!t)return null;for(;b!==null;)e(E,b),b=b.sibling;return null}function r(E,b){for(E=new Map;b!==null;)b.key!==null?E.set(b.key,b):E.set(b.index,b),b=b.sibling;return E}function s(E,b){return E=Fi(E,b),E.index=0,E.sibling=null,E}function i(E,b,S){return E.index=S,t?(S=E.alternate,S!==null?(S=S.index,S<b?(E.flags|=2,b):S):(E.flags|=2,b)):(E.flags|=1048576,b)}function o(E){return t&&E.alternate===null&&(E.flags|=2),E}function l(E,b,S,C){return b===null||b.tag!==6?(b=Wp(S,E.mode,C),b.return=E,b):(b=s(b,S),b.return=E,b)}function c(E,b,S,C){var D=S.type;return D===_o?d(E,b,S.props.children,C,S.key):b!==null&&(b.elementType===D||typeof D=="object"&&D!==null&&D.$$typeof===mi&&z_(D)===b.type)?(C=s(b,S.props),C.ref=Yl(E,b,S),C.return=E,C):(C=ch(S.type,S.key,S.props,null,E.mode,C),C.ref=Yl(E,b,S),C.return=E,C)}function u(E,b,S,C){return b===null||b.tag!==4||b.stateNode.containerInfo!==S.containerInfo||b.stateNode.implementation!==S.implementation?(b=qp(S,E.mode,C),b.return=E,b):(b=s(b,S.children||[]),b.return=E,b)}function d(E,b,S,C,D){return b===null||b.tag!==7?(b=Ta(S,E.mode,C,D),b.return=E,b):(b=s(b,S),b.return=E,b)}function m(E,b,S){if(typeof b=="string"&&b!==""||typeof b=="number")return b=Wp(""+b,E.mode,S),b.return=E,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case xd:return S=ch(b.type,b.key,b.props,null,E.mode,S),S.ref=Yl(E,null,b),S.return=E,S;case wo:return b=qp(b,E.mode,S),b.return=E,b;case mi:var C=b._init;return m(E,C(b._payload),S)}if(oc(b)||ql(b))return b=Ta(b,E.mode,S,null),b.return=E,b;Cd(E,b)}return null}function p(E,b,S,C){var D=b!==null?b.key:null;if(typeof S=="string"&&S!==""||typeof S=="number")return D!==null?null:l(E,b,""+S,C);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case xd:return S.key===D?c(E,b,S,C):null;case wo:return S.key===D?u(E,b,S,C):null;case mi:return D=S._init,p(E,b,D(S._payload),C)}if(oc(S)||ql(S))return D!==null?null:d(E,b,S,C,null);Cd(E,S)}return null}function g(E,b,S,C,D){if(typeof C=="string"&&C!==""||typeof C=="number")return E=E.get(S)||null,l(b,E,""+C,D);if(typeof C=="object"&&C!==null){switch(C.$$typeof){case xd:return E=E.get(C.key===null?S:C.key)||null,c(b,E,C,D);case wo:return E=E.get(C.key===null?S:C.key)||null,u(b,E,C,D);case mi:var F=C._init;return g(E,b,S,F(C._payload),D)}if(oc(C)||ql(C))return E=E.get(S)||null,d(b,E,C,D,null);Cd(b,C)}return null}function y(E,b,S,C){for(var D=null,F=null,I=b,k=b=0,R=null;I!==null&&k<S.length;k++){I.index>k?(R=I,I=null):R=I.sibling;var j=p(E,I,S[k],C);if(j===null){I===null&&(I=R);break}t&&I&&j.alternate===null&&e(E,I),b=i(j,b,k),F===null?D=j:F.sibling=j,F=j,I=R}if(k===S.length)return n(E,I),Ze&&fa(E,k),D;if(I===null){for(;k<S.length;k++)I=m(E,S[k],C),I!==null&&(b=i(I,b,k),F===null?D=I:F.sibling=I,F=I);return Ze&&fa(E,k),D}for(I=r(E,I);k<S.length;k++)R=g(I,E,k,S[k],C),R!==null&&(t&&R.alternate!==null&&I.delete(R.key===null?k:R.key),b=i(R,b,k),F===null?D=R:F.sibling=R,F=R);return t&&I.forEach(function(N){return e(E,N)}),Ze&&fa(E,k),D}function w(E,b,S,C){var D=ql(S);if(typeof D!="function")throw Error(V(150));if(S=D.call(S),S==null)throw Error(V(151));for(var F=D=null,I=b,k=b=0,R=null,j=S.next();I!==null&&!j.done;k++,j=S.next()){I.index>k?(R=I,I=null):R=I.sibling;var N=p(E,I,j.value,C);if(N===null){I===null&&(I=R);break}t&&I&&N.alternate===null&&e(E,I),b=i(N,b,k),F===null?D=N:F.sibling=N,F=N,I=R}if(j.done)return n(E,I),Ze&&fa(E,k),D;if(I===null){for(;!j.done;k++,j=S.next())j=m(E,j.value,C),j!==null&&(b=i(j,b,k),F===null?D=j:F.sibling=j,F=j);return Ze&&fa(E,k),D}for(I=r(E,I);!j.done;k++,j=S.next())j=g(I,E,k,j.value,C),j!==null&&(t&&j.alternate!==null&&I.delete(j.key===null?k:j.key),b=i(j,b,k),F===null?D=j:F.sibling=j,F=j);return t&&I.forEach(function(P){return e(E,P)}),Ze&&fa(E,k),D}function _(E,b,S,C){if(typeof S=="object"&&S!==null&&S.type===_o&&S.key===null&&(S=S.props.children),typeof S=="object"&&S!==null){switch(S.$$typeof){case xd:e:{for(var D=S.key,F=b;F!==null;){if(F.key===D){if(D=S.type,D===_o){if(F.tag===7){n(E,F.sibling),b=s(F,S.props.children),b.return=E,E=b;break e}}else if(F.elementType===D||typeof D=="object"&&D!==null&&D.$$typeof===mi&&z_(D)===F.type){n(E,F.sibling),b=s(F,S.props),b.ref=Yl(E,F,S),b.return=E,E=b;break e}n(E,F);break}else e(E,F);F=F.sibling}S.type===_o?(b=Ta(S.props.children,E.mode,C,S.key),b.return=E,E=b):(C=ch(S.type,S.key,S.props,null,E.mode,C),C.ref=Yl(E,b,S),C.return=E,E=C)}return o(E);case wo:e:{for(F=S.key;b!==null;){if(b.key===F)if(b.tag===4&&b.stateNode.containerInfo===S.containerInfo&&b.stateNode.implementation===S.implementation){n(E,b.sibling),b=s(b,S.children||[]),b.return=E,E=b;break e}else{n(E,b);break}else e(E,b);b=b.sibling}b=qp(S,E.mode,C),b.return=E,E=b}return o(E);case mi:return F=S._init,_(E,b,F(S._payload),C)}if(oc(S))return y(E,b,S,C);if(ql(S))return w(E,b,S,C);Cd(E,S)}return typeof S=="string"&&S!==""||typeof S=="number"?(S=""+S,b!==null&&b.tag===6?(n(E,b.sibling),b=s(b,S),b.return=E,E=b):(n(E,b),b=Wp(S,E.mode,C),b.return=E,E=b),o(E)):n(E,b)}return _}var Go=Rk(!0),Ak=Rk(!1),_u={},is=Qi(_u),Uc=Qi(_u),Vc=Qi(_u);function _a(t){if(t===_u)throw Error(V(174));return t}function py(t,e){switch(Ve(Vc,e),Ve(Uc,t),Ve(is,_u),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Gg(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Gg(e,t)}Ke(is),Ve(is,e)}function Qo(){Ke(is),Ke(Uc),Ke(Vc)}function Nk(t){_a(Vc.current);var e=_a(is.current),n=Gg(e,t.type);e!==n&&(Ve(Uc,t),Ve(is,n))}function gy(t){Uc.current===t&&(Ke(is),Ke(Uc))}var tt=Qi(0);function Uh(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var $p=[];function xy(){for(var t=0;t<$p.length;t++)$p[t]._workInProgressVersionPrimary=null;$p.length=0}var sh=Xs.ReactCurrentDispatcher,Bp=Xs.ReactCurrentBatchConfig,Na=0,rt=null,Et=null,At=null,Vh=!1,_c=!1,Hc=0,$P=0;function Yt(){throw Error(V(321))}function yy(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!zr(t[n],e[n]))return!1;return!0}function vy(t,e,n,r,s,i){if(Na=i,rt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,sh.current=t===null||t.memoizedState===null?VP:HP,t=n(r,s),_c){i=0;do{if(_c=!1,Hc=0,25<=i)throw Error(V(301));i+=1,At=Et=null,e.updateQueue=null,sh.current=WP,t=n(r,s)}while(_c)}if(sh.current=Hh,e=Et!==null&&Et.next!==null,Na=0,At=Et=rt=null,Vh=!1,e)throw Error(V(300));return t}function wy(){var t=Hc!==0;return Hc=0,t}function Zr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return At===null?rt.memoizedState=At=t:At=At.next=t,At}function mr(){if(Et===null){var t=rt.alternate;t=t!==null?t.memoizedState:null}else t=Et.next;var e=At===null?rt.memoizedState:At.next;if(e!==null)At=e,Et=t;else{if(t===null)throw Error(V(310));Et=t,t={memoizedState:Et.memoizedState,baseState:Et.baseState,baseQueue:Et.baseQueue,queue:Et.queue,next:null},At===null?rt.memoizedState=At=t:At=At.next=t}return At}function Wc(t,e){return typeof e=="function"?e(t):e}function zp(t){var e=mr(),n=e.queue;if(n===null)throw Error(V(311));n.lastRenderedReducer=t;var r=Et,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=o=null,c=null,u=i;do{var d=u.lane;if((Na&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var m={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=m,o=r):c=c.next=m,rt.lanes|=d,Pa|=d}u=u.next}while(u!==null&&u!==i);c===null?o=r:c.next=l,zr(r,e.memoizedState)||(jn=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=c,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,rt.lanes|=i,Pa|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Up(t){var e=mr(),n=e.queue;if(n===null)throw Error(V(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);zr(i,e.memoizedState)||(jn=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function Pk(){}function Fk(t,e){var n=rt,r=mr(),s=e(),i=!zr(r.memoizedState,s);if(i&&(r.memoizedState=s,jn=!0),r=r.queue,_y(Mk.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||At!==null&&At.memoizedState.tag&1){if(n.flags|=2048,qc(9,Lk.bind(null,n,r,s,e),void 0,null),Pt===null)throw Error(V(349));Na&30||Dk(n,e,s)}return s}function Dk(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=rt.updateQueue,e===null?(e={lastEffect:null,stores:null},rt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function Lk(t,e,n,r){e.value=n,e.getSnapshot=r,Ok(e)&&$k(t)}function Mk(t,e,n){return n(function(){Ok(e)&&$k(t)})}function Ok(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!zr(t,n)}catch{return!0}}function $k(t){var e=$s(t,1);e!==null&&Or(e,t,1,-1)}function U_(t){var e=Zr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Wc,lastRenderedState:t},e.queue=t,t=t.dispatch=UP.bind(null,rt,t),[e.memoizedState,t]}function qc(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=rt.updateQueue,e===null?(e={lastEffect:null,stores:null},rt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function Bk(){return mr().memoizedState}function ih(t,e,n,r){var s=Zr();rt.flags|=t,s.memoizedState=qc(1|e,n,void 0,r===void 0?null:r)}function Gf(t,e,n,r){var s=mr();r=r===void 0?null:r;var i=void 0;if(Et!==null){var o=Et.memoizedState;if(i=o.destroy,r!==null&&yy(r,o.deps)){s.memoizedState=qc(e,n,i,r);return}}rt.flags|=t,s.memoizedState=qc(1|e,n,i,r)}function V_(t,e){return ih(8390656,8,t,e)}function _y(t,e){return Gf(2048,8,t,e)}function zk(t,e){return Gf(4,2,t,e)}function Uk(t,e){return Gf(4,4,t,e)}function Vk(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Hk(t,e,n){return n=n!=null?n.concat([t]):null,Gf(4,4,Vk.bind(null,e,t),n)}function by(){}function Wk(t,e){var n=mr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&yy(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function qk(t,e){var n=mr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&yy(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Gk(t,e,n){return Na&21?(zr(n,e)||(n=XE(),rt.lanes|=n,Pa|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,jn=!0),t.memoizedState=n)}function BP(t,e){var n=Me;Me=n!==0&&4>n?n:4,t(!0);var r=Bp.transition;Bp.transition={};try{t(!1),e()}finally{Me=n,Bp.transition=r}}function Qk(){return mr().memoizedState}function zP(t,e,n){var r=Pi(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Kk(t))Xk(e,n);else if(n=Tk(t,e,n,r),n!==null){var s=pn();Or(n,t,r,s),Yk(n,e,r)}}function UP(t,e,n){var r=Pi(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Kk(t))Xk(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,l=i(o,n);if(s.hasEagerState=!0,s.eagerState=l,zr(l,o)){var c=e.interleaved;c===null?(s.next=s,fy(e)):(s.next=c.next,c.next=s),e.interleaved=s;return}}catch{}finally{}n=Tk(t,e,s,r),n!==null&&(s=pn(),Or(n,t,r,s),Yk(n,e,r))}}function Kk(t){var e=t.alternate;return t===rt||e!==null&&e===rt}function Xk(t,e){_c=Vh=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function Yk(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Zx(t,n)}}var Hh={readContext:fr,useCallback:Yt,useContext:Yt,useEffect:Yt,useImperativeHandle:Yt,useInsertionEffect:Yt,useLayoutEffect:Yt,useMemo:Yt,useReducer:Yt,useRef:Yt,useState:Yt,useDebugValue:Yt,useDeferredValue:Yt,useTransition:Yt,useMutableSource:Yt,useSyncExternalStore:Yt,useId:Yt,unstable_isNewReconciler:!1},VP={readContext:fr,useCallback:function(t,e){return Zr().memoizedState=[t,e===void 0?null:e],t},useContext:fr,useEffect:V_,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,ih(4194308,4,Vk.bind(null,e,t),n)},useLayoutEffect:function(t,e){return ih(4194308,4,t,e)},useInsertionEffect:function(t,e){return ih(4,2,t,e)},useMemo:function(t,e){var n=Zr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Zr();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=zP.bind(null,rt,t),[r.memoizedState,t]},useRef:function(t){var e=Zr();return t={current:t},e.memoizedState=t},useState:U_,useDebugValue:by,useDeferredValue:function(t){return Zr().memoizedState=t},useTransition:function(){var t=U_(!1),e=t[0];return t=BP.bind(null,t[1]),Zr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=rt,s=Zr();if(Ze){if(n===void 0)throw Error(V(407));n=n()}else{if(n=e(),Pt===null)throw Error(V(349));Na&30||Dk(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,V_(Mk.bind(null,r,i,t),[t]),r.flags|=2048,qc(9,Lk.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=Zr(),e=Pt.identifierPrefix;if(Ze){var n=Cs,r=Is;n=(r&~(1<<32-Mr(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Hc++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=$P++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},HP={readContext:fr,useCallback:Wk,useContext:fr,useEffect:_y,useImperativeHandle:Hk,useInsertionEffect:zk,useLayoutEffect:Uk,useMemo:qk,useReducer:zp,useRef:Bk,useState:function(){return zp(Wc)},useDebugValue:by,useDeferredValue:function(t){var e=mr();return Gk(e,Et.memoizedState,t)},useTransition:function(){var t=zp(Wc)[0],e=mr().memoizedState;return[t,e]},useMutableSource:Pk,useSyncExternalStore:Fk,useId:Qk,unstable_isNewReconciler:!1},WP={readContext:fr,useCallback:Wk,useContext:fr,useEffect:_y,useImperativeHandle:Hk,useInsertionEffect:zk,useLayoutEffect:Uk,useMemo:qk,useReducer:Up,useRef:Bk,useState:function(){return Up(Wc)},useDebugValue:by,useDeferredValue:function(t){var e=mr();return Et===null?e.memoizedState=t:Gk(e,Et.memoizedState,t)},useTransition:function(){var t=Up(Wc)[0],e=mr().memoizedState;return[t,e]},useMutableSource:Pk,useSyncExternalStore:Fk,useId:Qk,unstable_isNewReconciler:!1};function Ko(t,e){try{var n="",r=e;do n+=vN(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function Vp(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function g0(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var qP=typeof WeakMap=="function"?WeakMap:Map;function Jk(t,e,n){n=Fs(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){qh||(qh=!0,T0=r),g0(t,e)},n}function Zk(t,e,n){n=Fs(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){g0(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){g0(t,e),typeof r!="function"&&(Ni===null?Ni=new Set([this]):Ni.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function H_(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new qP;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=a4.bind(null,t,e,n),e.then(t,t))}function W_(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function q_(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Fs(-1,1),e.tag=2,Ai(n,e,1))),n.lanes|=1),t)}var GP=Xs.ReactCurrentOwner,jn=!1;function hn(t,e,n,r){e.child=t===null?Ak(e,null,n,r):Go(e,t.child,n,r)}function G_(t,e,n,r,s){n=n.render;var i=e.ref;return Oo(e,s),r=vy(t,e,n,r,i,s),n=wy(),t!==null&&!jn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Bs(t,e,s)):(Ze&&n&&oy(e),e.flags|=1,hn(t,e,r,s),e.child)}function Q_(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!Ry(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,eT(t,e,i,r,s)):(t=ch(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Oc,n(o,r)&&t.ref===e.ref)return Bs(t,e,s)}return e.flags|=1,t=Fi(i,r),t.ref=e.ref,t.return=e,e.child=t}function eT(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(Oc(i,r)&&t.ref===e.ref)if(jn=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(jn=!0);else return e.lanes=t.lanes,Bs(t,e,s)}return x0(t,e,n,r,s)}function tT(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ve(Ao,Un),Un|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Ve(Ao,Un),Un|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Ve(Ao,Un),Un|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,Ve(Ao,Un),Un|=r;return hn(t,e,s,n),e.child}function nT(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function x0(t,e,n,r,s){var i=An(n)?Ra:sn.current;return i=Wo(e,i),Oo(e,s),n=vy(t,e,n,r,i,s),r=wy(),t!==null&&!jn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Bs(t,e,s)):(Ze&&r&&oy(e),e.flags|=1,hn(t,e,n,s),e.child)}function K_(t,e,n,r,s){if(An(n)){var i=!0;Lh(e)}else i=!1;if(Oo(e,s),e.stateNode===null)ah(t,e),jk(e,n,r),p0(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var c=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=fr(u):(u=An(n)?Ra:sn.current,u=Wo(e,u));var d=n.getDerivedStateFromProps,m=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";m||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||c!==u)&&B_(e,o,r,u),pi=!1;var p=e.memoizedState;o.state=p,zh(e,r,o,s),c=e.memoizedState,l!==r||p!==c||Rn.current||pi?(typeof d=="function"&&(m0(e,n,d,r),c=e.memoizedState),(l=pi||$_(e,n,l,r,p,c,u))?(m||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),o.props=r,o.state=c,o.context=u,r=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,Ik(t,e),l=e.memoizedProps,u=e.type===e.elementType?l:Ar(e.type,l),o.props=u,m=e.pendingProps,p=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=fr(c):(c=An(n)?Ra:sn.current,c=Wo(e,c));var g=n.getDerivedStateFromProps;(d=typeof g=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==m||p!==c)&&B_(e,o,r,c),pi=!1,p=e.memoizedState,o.state=p,zh(e,r,o,s);var y=e.memoizedState;l!==m||p!==y||Rn.current||pi?(typeof g=="function"&&(m0(e,n,g,r),y=e.memoizedState),(u=pi||$_(e,n,u,r,p,y,c)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,y,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,y,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=y),o.props=r,o.state=y,o.context=c,r=u):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),r=!1)}return y0(t,e,n,r,i,s)}function y0(t,e,n,r,s,i){nT(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&F_(e,n,!1),Bs(t,e,i);r=e.stateNode,GP.current=e;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Go(e,t.child,null,i),e.child=Go(e,null,l,i)):hn(t,e,l,i),e.memoizedState=r.state,s&&F_(e,n,!0),e.child}function rT(t){var e=t.stateNode;e.pendingContext?P_(t,e.pendingContext,e.pendingContext!==e.context):e.context&&P_(t,e.context,!1),py(t,e.containerInfo)}function X_(t,e,n,r,s){return qo(),cy(s),e.flags|=256,hn(t,e,n,r),e.child}var v0={dehydrated:null,treeContext:null,retryLane:0};function w0(t){return{baseLanes:t,cachePool:null,transitions:null}}function sT(t,e,n){var r=e.pendingProps,s=tt.current,i=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Ve(tt,s&1),t===null)return h0(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Xf(o,r,0,null),t=Ta(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=w0(n),e.memoizedState=v0,t):Sy(e,o));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return QP(t,e,o,r,l,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,l=s.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=Fi(s,c),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=Fi(l,i):(i=Ta(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?w0(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=v0,r}return i=t.child,t=i.sibling,r=Fi(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Sy(t,e){return e=Xf({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function jd(t,e,n,r){return r!==null&&cy(r),Go(e,t.child,null,n),t=Sy(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function QP(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=Vp(Error(V(422))),jd(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=Xf({mode:"visible",children:r.children},s,0,null),i=Ta(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Go(e,t.child,null,o),e.child.memoizedState=w0(o),e.memoizedState=v0,i);if(!(e.mode&1))return jd(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(V(419)),r=Vp(i,r,void 0),jd(t,e,o,r)}if(l=(o&t.childLanes)!==0,jn||l){if(r=Pt,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,$s(t,s),Or(r,t,s,-1))}return jy(),r=Vp(Error(V(421))),jd(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=o4.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,Hn=Ri(s.nextSibling),Qn=e,Ze=!0,Pr=null,t!==null&&(cr[ur++]=Is,cr[ur++]=Cs,cr[ur++]=Aa,Is=t.id,Cs=t.overflow,Aa=e),e=Sy(e,r.children),e.flags|=4096,e)}function Y_(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),f0(t.return,e,n)}function Hp(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function iT(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(hn(t,e,r.children,n),r=tt.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Y_(t,n,e);else if(t.tag===19)Y_(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Ve(tt,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&Uh(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),Hp(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&Uh(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}Hp(e,!0,n,null,i);break;case"together":Hp(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function ah(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Bs(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Pa|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(V(153));if(e.child!==null){for(t=e.child,n=Fi(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Fi(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function KP(t,e,n){switch(e.tag){case 3:rT(e),qo();break;case 5:Nk(e);break;case 1:An(e.type)&&Lh(e);break;case 4:py(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Ve($h,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Ve(tt,tt.current&1),e.flags|=128,null):n&e.child.childLanes?sT(t,e,n):(Ve(tt,tt.current&1),t=Bs(t,e,n),t!==null?t.sibling:null);Ve(tt,tt.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return iT(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Ve(tt,tt.current),r)break;return null;case 22:case 23:return e.lanes=0,tT(t,e,n)}return Bs(t,e,n)}var aT,_0,oT,lT;aT=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};_0=function(){};oT=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,_a(is.current);var i=null;switch(n){case"input":s=Vg(t,s),r=Vg(t,r),i=[];break;case"select":s=st({},s,{value:void 0}),r=st({},r,{value:void 0}),i=[];break;case"textarea":s=qg(t,s),r=qg(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Fh)}Qg(n,r);var o;n=null;for(u in s)if(!r.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var l=s[u];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Ac.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in r){var c=r[u];if(l=s!=null?s[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(i||(i=[]),i.push(u,n)),n=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Ac.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&Ge("scroll",t),i||l===c||(i=[])):(i=i||[]).push(u,c))}n&&(i=i||[]).push("style",n);var u=i;(e.updateQueue=u)&&(e.flags|=4)}};lT=function(t,e,n,r){n!==r&&(e.flags|=4)};function Jl(t,e){if(!Ze)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Jt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function XP(t,e,n){var r=e.pendingProps;switch(ly(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Jt(e),null;case 1:return An(e.type)&&Dh(),Jt(e),null;case 3:return r=e.stateNode,Qo(),Ke(Rn),Ke(sn),xy(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Id(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Pr!==null&&(j0(Pr),Pr=null))),_0(t,e),Jt(e),null;case 5:gy(e);var s=_a(Vc.current);if(n=e.type,t!==null&&e.stateNode!=null)oT(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(V(166));return Jt(e),null}if(t=_a(is.current),Id(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[ts]=e,r[zc]=i,t=(e.mode&1)!==0,n){case"dialog":Ge("cancel",r),Ge("close",r);break;case"iframe":case"object":case"embed":Ge("load",r);break;case"video":case"audio":for(s=0;s<cc.length;s++)Ge(cc[s],r);break;case"source":Ge("error",r);break;case"img":case"image":case"link":Ge("error",r),Ge("load",r);break;case"details":Ge("toggle",r);break;case"input":a_(r,i),Ge("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Ge("invalid",r);break;case"textarea":l_(r,i),Ge("invalid",r)}Qg(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&Td(r.textContent,l,t),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&Td(r.textContent,l,t),s=["children",""+l]):Ac.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Ge("scroll",r)}switch(n){case"input":yd(r),o_(r,i,!0);break;case"textarea":yd(r),c_(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Fh)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=DE(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[ts]=e,t[zc]=r,aT(t,e,!1,!1),e.stateNode=t;e:{switch(o=Kg(n,r),n){case"dialog":Ge("cancel",t),Ge("close",t),s=r;break;case"iframe":case"object":case"embed":Ge("load",t),s=r;break;case"video":case"audio":for(s=0;s<cc.length;s++)Ge(cc[s],t);s=r;break;case"source":Ge("error",t),s=r;break;case"img":case"image":case"link":Ge("error",t),Ge("load",t),s=r;break;case"details":Ge("toggle",t),s=r;break;case"input":a_(t,r),s=Vg(t,r),Ge("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=st({},r,{value:void 0}),Ge("invalid",t);break;case"textarea":l_(t,r),s=qg(t,r),Ge("invalid",t);break;default:s=r}Qg(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?OE(t,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&LE(t,c)):i==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&Nc(t,c):typeof c=="number"&&Nc(t,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Ac.hasOwnProperty(i)?c!=null&&i==="onScroll"&&Ge("scroll",t):c!=null&&Gx(t,i,c,o))}switch(n){case"input":yd(t),o_(t,r,!1);break;case"textarea":yd(t),c_(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Bi(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?Fo(t,!!r.multiple,i,!1):r.defaultValue!=null&&Fo(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=Fh)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Jt(e),null;case 6:if(t&&e.stateNode!=null)lT(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(V(166));if(n=_a(Vc.current),_a(is.current),Id(e)){if(r=e.stateNode,n=e.memoizedProps,r[ts]=e,(i=r.nodeValue!==n)&&(t=Qn,t!==null))switch(t.tag){case 3:Td(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Td(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[ts]=e,e.stateNode=r}return Jt(e),null;case 13:if(Ke(tt),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Ze&&Hn!==null&&e.mode&1&&!(e.flags&128))kk(),qo(),e.flags|=98560,i=!1;else if(i=Id(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(V(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(V(317));i[ts]=e}else qo(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Jt(e),i=!1}else Pr!==null&&(j0(Pr),Pr=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||tt.current&1?Tt===0&&(Tt=3):jy())),e.updateQueue!==null&&(e.flags|=4),Jt(e),null);case 4:return Qo(),_0(t,e),t===null&&$c(e.stateNode.containerInfo),Jt(e),null;case 10:return hy(e.type._context),Jt(e),null;case 17:return An(e.type)&&Dh(),Jt(e),null;case 19:if(Ke(tt),i=e.memoizedState,i===null)return Jt(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)Jl(i,!1);else{if(Tt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Uh(t),o!==null){for(e.flags|=128,Jl(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Ve(tt,tt.current&1|2),e.child}t=t.sibling}i.tail!==null&&mt()>Xo&&(e.flags|=128,r=!0,Jl(i,!1),e.lanes=4194304)}else{if(!r)if(t=Uh(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Jl(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Ze)return Jt(e),null}else 2*mt()-i.renderingStartTime>Xo&&n!==1073741824&&(e.flags|=128,r=!0,Jl(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=mt(),e.sibling=null,n=tt.current,Ve(tt,r?n&1|2:n&1),e):(Jt(e),null);case 22:case 23:return Cy(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Un&1073741824&&(Jt(e),e.subtreeFlags&6&&(e.flags|=8192)):Jt(e),null;case 24:return null;case 25:return null}throw Error(V(156,e.tag))}function YP(t,e){switch(ly(e),e.tag){case 1:return An(e.type)&&Dh(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Qo(),Ke(Rn),Ke(sn),xy(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return gy(e),null;case 13:if(Ke(tt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(V(340));qo()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ke(tt),null;case 4:return Qo(),null;case 10:return hy(e.type._context),null;case 22:case 23:return Cy(),null;case 24:return null;default:return null}}var Rd=!1,tn=!1,JP=typeof WeakSet=="function"?WeakSet:Set,K=null;function Ro(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){ot(t,e,r)}else n.current=null}function b0(t,e,n){try{n()}catch(r){ot(t,e,r)}}var J_=!1;function ZP(t,e){if(i0=Ah,t=hk(),ay(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,l=-1,c=-1,u=0,d=0,m=t,p=null;t:for(;;){for(var g;m!==n||s!==0&&m.nodeType!==3||(l=o+s),m!==i||r!==0&&m.nodeType!==3||(c=o+r),m.nodeType===3&&(o+=m.nodeValue.length),(g=m.firstChild)!==null;)p=m,m=g;for(;;){if(m===t)break t;if(p===n&&++u===s&&(l=o),p===i&&++d===r&&(c=o),(g=m.nextSibling)!==null)break;m=p,p=m.parentNode}m=g}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(a0={focusedElem:t,selectionRange:n},Ah=!1,K=e;K!==null;)if(e=K,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,K=t;else for(;K!==null;){e=K;try{var y=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var w=y.memoizedProps,_=y.memoizedState,E=e.stateNode,b=E.getSnapshotBeforeUpdate(e.elementType===e.type?w:Ar(e.type,w),_);E.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var S=e.stateNode.containerInfo;S.nodeType===1?S.textContent="":S.nodeType===9&&S.documentElement&&S.removeChild(S.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(V(163))}}catch(C){ot(e,e.return,C)}if(t=e.sibling,t!==null){t.return=e.return,K=t;break}K=e.return}return y=J_,J_=!1,y}function bc(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&b0(e,n,i)}s=s.next}while(s!==r)}}function Qf(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function S0(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function cT(t){var e=t.alternate;e!==null&&(t.alternate=null,cT(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[ts],delete e[zc],delete e[c0],delete e[DP],delete e[LP])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function uT(t){return t.tag===5||t.tag===3||t.tag===4}function Z_(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||uT(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function E0(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Fh));else if(r!==4&&(t=t.child,t!==null))for(E0(t,e,n),t=t.sibling;t!==null;)E0(t,e,n),t=t.sibling}function k0(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(k0(t,e,n),t=t.sibling;t!==null;)k0(t,e,n),t=t.sibling}var Mt=null,Nr=!1;function di(t,e,n){for(n=n.child;n!==null;)dT(t,e,n),n=n.sibling}function dT(t,e,n){if(ss&&typeof ss.onCommitFiberUnmount=="function")try{ss.onCommitFiberUnmount(Bf,n)}catch{}switch(n.tag){case 5:tn||Ro(n,e);case 6:var r=Mt,s=Nr;Mt=null,di(t,e,n),Mt=r,Nr=s,Mt!==null&&(Nr?(t=Mt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Mt.removeChild(n.stateNode));break;case 18:Mt!==null&&(Nr?(t=Mt,n=n.stateNode,t.nodeType===8?Mp(t.parentNode,n):t.nodeType===1&&Mp(t,n),Lc(t)):Mp(Mt,n.stateNode));break;case 4:r=Mt,s=Nr,Mt=n.stateNode.containerInfo,Nr=!0,di(t,e,n),Mt=r,Nr=s;break;case 0:case 11:case 14:case 15:if(!tn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&b0(n,e,o),s=s.next}while(s!==r)}di(t,e,n);break;case 1:if(!tn&&(Ro(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){ot(n,e,l)}di(t,e,n);break;case 21:di(t,e,n);break;case 22:n.mode&1?(tn=(r=tn)||n.memoizedState!==null,di(t,e,n),tn=r):di(t,e,n);break;default:di(t,e,n)}}function eb(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new JP),e.forEach(function(r){var s=l4.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function jr(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:Mt=l.stateNode,Nr=!1;break e;case 3:Mt=l.stateNode.containerInfo,Nr=!0;break e;case 4:Mt=l.stateNode.containerInfo,Nr=!0;break e}l=l.return}if(Mt===null)throw Error(V(160));dT(i,o,s),Mt=null,Nr=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(u){ot(s,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)hT(e,t),e=e.sibling}function hT(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(jr(e,t),Qr(t),r&4){try{bc(3,t,t.return),Qf(3,t)}catch(w){ot(t,t.return,w)}try{bc(5,t,t.return)}catch(w){ot(t,t.return,w)}}break;case 1:jr(e,t),Qr(t),r&512&&n!==null&&Ro(n,n.return);break;case 5:if(jr(e,t),Qr(t),r&512&&n!==null&&Ro(n,n.return),t.flags&32){var s=t.stateNode;try{Nc(s,"")}catch(w){ot(t,t.return,w)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&PE(s,i),Kg(l,o);var u=Kg(l,i);for(o=0;o<c.length;o+=2){var d=c[o],m=c[o+1];d==="style"?OE(s,m):d==="dangerouslySetInnerHTML"?LE(s,m):d==="children"?Nc(s,m):Gx(s,d,m,u)}switch(l){case"input":Hg(s,i);break;case"textarea":FE(s,i);break;case"select":var p=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var g=i.value;g!=null?Fo(s,!!i.multiple,g,!1):p!==!!i.multiple&&(i.defaultValue!=null?Fo(s,!!i.multiple,i.defaultValue,!0):Fo(s,!!i.multiple,i.multiple?[]:"",!1))}s[zc]=i}catch(w){ot(t,t.return,w)}}break;case 6:if(jr(e,t),Qr(t),r&4){if(t.stateNode===null)throw Error(V(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(w){ot(t,t.return,w)}}break;case 3:if(jr(e,t),Qr(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Lc(e.containerInfo)}catch(w){ot(t,t.return,w)}break;case 4:jr(e,t),Qr(t);break;case 13:jr(e,t),Qr(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Ty=mt())),r&4&&eb(t);break;case 22:if(d=n!==null&&n.memoizedState!==null,t.mode&1?(tn=(u=tn)||d,jr(e,t),tn=u):jr(e,t),Qr(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!d&&t.mode&1)for(K=t,d=t.child;d!==null;){for(m=K=d;K!==null;){switch(p=K,g=p.child,p.tag){case 0:case 11:case 14:case 15:bc(4,p,p.return);break;case 1:Ro(p,p.return);var y=p.stateNode;if(typeof y.componentWillUnmount=="function"){r=p,n=p.return;try{e=r,y.props=e.memoizedProps,y.state=e.memoizedState,y.componentWillUnmount()}catch(w){ot(r,n,w)}}break;case 5:Ro(p,p.return);break;case 22:if(p.memoizedState!==null){nb(m);continue}}g!==null?(g.return=p,K=g):nb(m)}d=d.sibling}e:for(d=null,m=t;;){if(m.tag===5){if(d===null){d=m;try{s=m.stateNode,u?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=m.stateNode,c=m.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=ME("display",o))}catch(w){ot(t,t.return,w)}}}else if(m.tag===6){if(d===null)try{m.stateNode.nodeValue=u?"":m.memoizedProps}catch(w){ot(t,t.return,w)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===t)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===t)break e;for(;m.sibling===null;){if(m.return===null||m.return===t)break e;d===m&&(d=null),m=m.return}d===m&&(d=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:jr(e,t),Qr(t),r&4&&eb(t);break;case 21:break;default:jr(e,t),Qr(t)}}function Qr(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(uT(n)){var r=n;break e}n=n.return}throw Error(V(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Nc(s,""),r.flags&=-33);var i=Z_(t);k0(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,l=Z_(t);E0(t,l,o);break;default:throw Error(V(161))}}catch(c){ot(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function e4(t,e,n){K=t,fT(t)}function fT(t,e,n){for(var r=(t.mode&1)!==0;K!==null;){var s=K,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||Rd;if(!o){var l=s.alternate,c=l!==null&&l.memoizedState!==null||tn;l=Rd;var u=tn;if(Rd=o,(tn=c)&&!u)for(K=s;K!==null;)o=K,c=o.child,o.tag===22&&o.memoizedState!==null?rb(s):c!==null?(c.return=o,K=c):rb(s);for(;i!==null;)K=i,fT(i),i=i.sibling;K=s,Rd=l,tn=u}tb(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,K=i):tb(t)}}function tb(t){for(;K!==null;){var e=K;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:tn||Qf(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!tn)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:Ar(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&O_(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}O_(e,o,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var m=d.dehydrated;m!==null&&Lc(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(V(163))}tn||e.flags&512&&S0(e)}catch(p){ot(e,e.return,p)}}if(e===t){K=null;break}if(n=e.sibling,n!==null){n.return=e.return,K=n;break}K=e.return}}function nb(t){for(;K!==null;){var e=K;if(e===t){K=null;break}var n=e.sibling;if(n!==null){n.return=e.return,K=n;break}K=e.return}}function rb(t){for(;K!==null;){var e=K;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Qf(4,e)}catch(c){ot(e,n,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(c){ot(e,s,c)}}var i=e.return;try{S0(e)}catch(c){ot(e,i,c)}break;case 5:var o=e.return;try{S0(e)}catch(c){ot(e,o,c)}}}catch(c){ot(e,e.return,c)}if(e===t){K=null;break}var l=e.sibling;if(l!==null){l.return=e.return,K=l;break}K=e.return}}var t4=Math.ceil,Wh=Xs.ReactCurrentDispatcher,Ey=Xs.ReactCurrentOwner,hr=Xs.ReactCurrentBatchConfig,Ae=0,Pt=null,wt=null,zt=0,Un=0,Ao=Qi(0),Tt=0,Gc=null,Pa=0,Kf=0,ky=0,Sc=null,In=null,Ty=0,Xo=1/0,Ss=null,qh=!1,T0=null,Ni=null,Ad=!1,Ei=null,Gh=0,Ec=0,I0=null,oh=-1,lh=0;function pn(){return Ae&6?mt():oh!==-1?oh:oh=mt()}function Pi(t){return t.mode&1?Ae&2&&zt!==0?zt&-zt:OP.transition!==null?(lh===0&&(lh=XE()),lh):(t=Me,t!==0||(t=window.event,t=t===void 0?16:rk(t.type)),t):1}function Or(t,e,n,r){if(50<Ec)throw Ec=0,I0=null,Error(V(185));yu(t,n,r),(!(Ae&2)||t!==Pt)&&(t===Pt&&(!(Ae&2)&&(Kf|=n),Tt===4&&xi(t,zt)),Nn(t,r),n===1&&Ae===0&&!(e.mode&1)&&(Xo=mt()+500,Wf&&Ki()))}function Nn(t,e){var n=t.callbackNode;ON(t,e);var r=Rh(t,t===Pt?zt:0);if(r===0)n!==null&&h_(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&h_(n),e===1)t.tag===0?MP(sb.bind(null,t)):bk(sb.bind(null,t)),PP(function(){!(Ae&6)&&Ki()}),n=null;else{switch(YE(r)){case 1:n=Jx;break;case 4:n=QE;break;case 16:n=jh;break;case 536870912:n=KE;break;default:n=jh}n=_T(n,mT.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function mT(t,e){if(oh=-1,lh=0,Ae&6)throw Error(V(327));var n=t.callbackNode;if($o()&&t.callbackNode!==n)return null;var r=Rh(t,t===Pt?zt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Qh(t,r);else{e=r;var s=Ae;Ae|=2;var i=gT();(Pt!==t||zt!==e)&&(Ss=null,Xo=mt()+500,ka(t,e));do try{s4();break}catch(l){pT(t,l)}while(1);dy(),Wh.current=i,Ae=s,wt!==null?e=0:(Pt=null,zt=0,e=Tt)}if(e!==0){if(e===2&&(s=e0(t),s!==0&&(r=s,e=C0(t,s))),e===1)throw n=Gc,ka(t,0),xi(t,r),Nn(t,mt()),n;if(e===6)xi(t,r);else{if(s=t.current.alternate,!(r&30)&&!n4(s)&&(e=Qh(t,r),e===2&&(i=e0(t),i!==0&&(r=i,e=C0(t,i))),e===1))throw n=Gc,ka(t,0),xi(t,r),Nn(t,mt()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(V(345));case 2:ma(t,In,Ss);break;case 3:if(xi(t,r),(r&130023424)===r&&(e=Ty+500-mt(),10<e)){if(Rh(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){pn(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=l0(ma.bind(null,t,In,Ss),e);break}ma(t,In,Ss);break;case 4:if(xi(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-Mr(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=mt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*t4(r/1960))-r,10<r){t.timeoutHandle=l0(ma.bind(null,t,In,Ss),r);break}ma(t,In,Ss);break;case 5:ma(t,In,Ss);break;default:throw Error(V(329))}}}return Nn(t,mt()),t.callbackNode===n?mT.bind(null,t):null}function C0(t,e){var n=Sc;return t.current.memoizedState.isDehydrated&&(ka(t,e).flags|=256),t=Qh(t,e),t!==2&&(e=In,In=n,e!==null&&j0(e)),t}function j0(t){In===null?In=t:In.push.apply(In,t)}function n4(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!zr(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function xi(t,e){for(e&=~ky,e&=~Kf,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Mr(e),r=1<<n;t[n]=-1,e&=~r}}function sb(t){if(Ae&6)throw Error(V(327));$o();var e=Rh(t,0);if(!(e&1))return Nn(t,mt()),null;var n=Qh(t,e);if(t.tag!==0&&n===2){var r=e0(t);r!==0&&(e=r,n=C0(t,r))}if(n===1)throw n=Gc,ka(t,0),xi(t,e),Nn(t,mt()),n;if(n===6)throw Error(V(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,ma(t,In,Ss),Nn(t,mt()),null}function Iy(t,e){var n=Ae;Ae|=1;try{return t(e)}finally{Ae=n,Ae===0&&(Xo=mt()+500,Wf&&Ki())}}function Fa(t){Ei!==null&&Ei.tag===0&&!(Ae&6)&&$o();var e=Ae;Ae|=1;var n=hr.transition,r=Me;try{if(hr.transition=null,Me=1,t)return t()}finally{Me=r,hr.transition=n,Ae=e,!(Ae&6)&&Ki()}}function Cy(){Un=Ao.current,Ke(Ao)}function ka(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,NP(n)),wt!==null)for(n=wt.return;n!==null;){var r=n;switch(ly(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Dh();break;case 3:Qo(),Ke(Rn),Ke(sn),xy();break;case 5:gy(r);break;case 4:Qo();break;case 13:Ke(tt);break;case 19:Ke(tt);break;case 10:hy(r.type._context);break;case 22:case 23:Cy()}n=n.return}if(Pt=t,wt=t=Fi(t.current,null),zt=Un=e,Tt=0,Gc=null,ky=Kf=Pa=0,In=Sc=null,wa!==null){for(e=0;e<wa.length;e++)if(n=wa[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}wa=null}return t}function pT(t,e){do{var n=wt;try{if(dy(),sh.current=Hh,Vh){for(var r=rt.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Vh=!1}if(Na=0,At=Et=rt=null,_c=!1,Hc=0,Ey.current=null,n===null||n.return===null){Tt=1,Gc=e,wt=null;break}e:{var i=t,o=n.return,l=n,c=e;if(e=zt,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=l,m=d.tag;if(!(d.mode&1)&&(m===0||m===11||m===15)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var g=W_(o);if(g!==null){g.flags&=-257,q_(g,o,l,i,e),g.mode&1&&H_(i,u,e),e=g,c=u;var y=e.updateQueue;if(y===null){var w=new Set;w.add(c),e.updateQueue=w}else y.add(c);break e}else{if(!(e&1)){H_(i,u,e),jy();break e}c=Error(V(426))}}else if(Ze&&l.mode&1){var _=W_(o);if(_!==null){!(_.flags&65536)&&(_.flags|=256),q_(_,o,l,i,e),cy(Ko(c,l));break e}}i=c=Ko(c,l),Tt!==4&&(Tt=2),Sc===null?Sc=[i]:Sc.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var E=Jk(i,c,e);M_(i,E);break e;case 1:l=c;var b=i.type,S=i.stateNode;if(!(i.flags&128)&&(typeof b.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(Ni===null||!Ni.has(S)))){i.flags|=65536,e&=-e,i.lanes|=e;var C=Zk(i,l,e);M_(i,C);break e}}i=i.return}while(i!==null)}yT(n)}catch(D){e=D,wt===n&&n!==null&&(wt=n=n.return);continue}break}while(1)}function gT(){var t=Wh.current;return Wh.current=Hh,t===null?Hh:t}function jy(){(Tt===0||Tt===3||Tt===2)&&(Tt=4),Pt===null||!(Pa&268435455)&&!(Kf&268435455)||xi(Pt,zt)}function Qh(t,e){var n=Ae;Ae|=2;var r=gT();(Pt!==t||zt!==e)&&(Ss=null,ka(t,e));do try{r4();break}catch(s){pT(t,s)}while(1);if(dy(),Ae=n,Wh.current=r,wt!==null)throw Error(V(261));return Pt=null,zt=0,Tt}function r4(){for(;wt!==null;)xT(wt)}function s4(){for(;wt!==null&&!jN();)xT(wt)}function xT(t){var e=wT(t.alternate,t,Un);t.memoizedProps=t.pendingProps,e===null?yT(t):wt=e,Ey.current=null}function yT(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=YP(n,e),n!==null){n.flags&=32767,wt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Tt=6,wt=null;return}}else if(n=XP(n,e,Un),n!==null){wt=n;return}if(e=e.sibling,e!==null){wt=e;return}wt=e=t}while(e!==null);Tt===0&&(Tt=5)}function ma(t,e,n){var r=Me,s=hr.transition;try{hr.transition=null,Me=1,i4(t,e,n,r)}finally{hr.transition=s,Me=r}return null}function i4(t,e,n,r){do $o();while(Ei!==null);if(Ae&6)throw Error(V(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(V(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if($N(t,i),t===Pt&&(wt=Pt=null,zt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Ad||(Ad=!0,_T(jh,function(){return $o(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=hr.transition,hr.transition=null;var o=Me;Me=1;var l=Ae;Ae|=4,Ey.current=null,ZP(t,n),hT(n,t),kP(a0),Ah=!!i0,a0=i0=null,t.current=n,e4(n),RN(),Ae=l,Me=o,hr.transition=i}else t.current=n;if(Ad&&(Ad=!1,Ei=t,Gh=s),i=t.pendingLanes,i===0&&(Ni=null),PN(n.stateNode),Nn(t,mt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(qh)throw qh=!1,t=T0,T0=null,t;return Gh&1&&t.tag!==0&&$o(),i=t.pendingLanes,i&1?t===I0?Ec++:(Ec=0,I0=t):Ec=0,Ki(),null}function $o(){if(Ei!==null){var t=YE(Gh),e=hr.transition,n=Me;try{if(hr.transition=null,Me=16>t?16:t,Ei===null)var r=!1;else{if(t=Ei,Ei=null,Gh=0,Ae&6)throw Error(V(331));var s=Ae;for(Ae|=4,K=t.current;K!==null;){var i=K,o=i.child;if(K.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(K=u;K!==null;){var d=K;switch(d.tag){case 0:case 11:case 15:bc(8,d,i)}var m=d.child;if(m!==null)m.return=d,K=m;else for(;K!==null;){d=K;var p=d.sibling,g=d.return;if(cT(d),d===u){K=null;break}if(p!==null){p.return=g,K=p;break}K=g}}}var y=i.alternate;if(y!==null){var w=y.child;if(w!==null){y.child=null;do{var _=w.sibling;w.sibling=null,w=_}while(w!==null)}}K=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,K=o;else e:for(;K!==null;){if(i=K,i.flags&2048)switch(i.tag){case 0:case 11:case 15:bc(9,i,i.return)}var E=i.sibling;if(E!==null){E.return=i.return,K=E;break e}K=i.return}}var b=t.current;for(K=b;K!==null;){o=K;var S=o.child;if(o.subtreeFlags&2064&&S!==null)S.return=o,K=S;else e:for(o=b;K!==null;){if(l=K,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Qf(9,l)}}catch(D){ot(l,l.return,D)}if(l===o){K=null;break e}var C=l.sibling;if(C!==null){C.return=l.return,K=C;break e}K=l.return}}if(Ae=s,Ki(),ss&&typeof ss.onPostCommitFiberRoot=="function")try{ss.onPostCommitFiberRoot(Bf,t)}catch{}r=!0}return r}finally{Me=n,hr.transition=e}}return!1}function ib(t,e,n){e=Ko(n,e),e=Jk(t,e,1),t=Ai(t,e,1),e=pn(),t!==null&&(yu(t,1,e),Nn(t,e))}function ot(t,e,n){if(t.tag===3)ib(t,t,n);else for(;e!==null;){if(e.tag===3){ib(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Ni===null||!Ni.has(r))){t=Ko(n,t),t=Zk(e,t,1),e=Ai(e,t,1),t=pn(),e!==null&&(yu(e,1,t),Nn(e,t));break}}e=e.return}}function a4(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=pn(),t.pingedLanes|=t.suspendedLanes&n,Pt===t&&(zt&n)===n&&(Tt===4||Tt===3&&(zt&130023424)===zt&&500>mt()-Ty?ka(t,0):ky|=n),Nn(t,e)}function vT(t,e){e===0&&(t.mode&1?(e=_d,_d<<=1,!(_d&130023424)&&(_d=4194304)):e=1);var n=pn();t=$s(t,e),t!==null&&(yu(t,e,n),Nn(t,n))}function o4(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),vT(t,n)}function l4(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(V(314))}r!==null&&r.delete(e),vT(t,n)}var wT;wT=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Rn.current)jn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return jn=!1,KP(t,e,n);jn=!!(t.flags&131072)}else jn=!1,Ze&&e.flags&1048576&&Sk(e,Oh,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;ah(t,e),t=e.pendingProps;var s=Wo(e,sn.current);Oo(e,n),s=vy(null,e,r,t,s,n);var i=wy();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,An(r)?(i=!0,Lh(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,my(e),s.updater=qf,e.stateNode=s,s._reactInternals=e,p0(e,r,t,n),e=y0(null,e,r,!0,i,n)):(e.tag=0,Ze&&i&&oy(e),hn(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(ah(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=u4(r),t=Ar(r,t),s){case 0:e=x0(null,e,r,t,n);break e;case 1:e=K_(null,e,r,t,n);break e;case 11:e=G_(null,e,r,t,n);break e;case 14:e=Q_(null,e,r,Ar(r.type,t),n);break e}throw Error(V(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Ar(r,s),x0(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Ar(r,s),K_(t,e,r,s,n);case 3:e:{if(rT(e),t===null)throw Error(V(387));r=e.pendingProps,i=e.memoizedState,s=i.element,Ik(t,e),zh(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=Ko(Error(V(423)),e),e=X_(t,e,r,n,s);break e}else if(r!==s){s=Ko(Error(V(424)),e),e=X_(t,e,r,n,s);break e}else for(Hn=Ri(e.stateNode.containerInfo.firstChild),Qn=e,Ze=!0,Pr=null,n=Ak(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(qo(),r===s){e=Bs(t,e,n);break e}hn(t,e,r,n)}e=e.child}return e;case 5:return Nk(e),t===null&&h0(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,o0(r,s)?o=null:i!==null&&o0(r,i)&&(e.flags|=32),nT(t,e),hn(t,e,o,n),e.child;case 6:return t===null&&h0(e),null;case 13:return sT(t,e,n);case 4:return py(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Go(e,null,r,n):hn(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Ar(r,s),G_(t,e,r,s,n);case 7:return hn(t,e,e.pendingProps,n),e.child;case 8:return hn(t,e,e.pendingProps.children,n),e.child;case 12:return hn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,Ve($h,r._currentValue),r._currentValue=o,i!==null)if(zr(i.value,o)){if(i.children===s.children&&!Rn.current){e=Bs(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(i.tag===1){c=Fs(-1,n&-n),c.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}i.lanes|=n,c=i.alternate,c!==null&&(c.lanes|=n),f0(i.return,n,e),l.lanes|=n;break}c=c.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(V(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),f0(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}hn(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Oo(e,n),s=fr(s),r=r(s),e.flags|=1,hn(t,e,r,n),e.child;case 14:return r=e.type,s=Ar(r,e.pendingProps),s=Ar(r.type,s),Q_(t,e,r,s,n);case 15:return eT(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Ar(r,s),ah(t,e),e.tag=1,An(r)?(t=!0,Lh(e)):t=!1,Oo(e,n),jk(e,r,s),p0(e,r,s,n),y0(null,e,r,!0,t,n);case 19:return iT(t,e,n);case 22:return tT(t,e,n)}throw Error(V(156,e.tag))};function _T(t,e){return GE(t,e)}function c4(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function dr(t,e,n,r){return new c4(t,e,n,r)}function Ry(t){return t=t.prototype,!(!t||!t.isReactComponent)}function u4(t){if(typeof t=="function")return Ry(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Kx)return 11;if(t===Xx)return 14}return 2}function Fi(t,e){var n=t.alternate;return n===null?(n=dr(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function ch(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")Ry(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case _o:return Ta(n.children,s,i,e);case Qx:o=8,s|=8;break;case $g:return t=dr(12,n,e,s|2),t.elementType=$g,t.lanes=i,t;case Bg:return t=dr(13,n,e,s),t.elementType=Bg,t.lanes=i,t;case zg:return t=dr(19,n,e,s),t.elementType=zg,t.lanes=i,t;case RE:return Xf(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case CE:o=10;break e;case jE:o=9;break e;case Kx:o=11;break e;case Xx:o=14;break e;case mi:o=16,r=null;break e}throw Error(V(130,t==null?t:typeof t,""))}return e=dr(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function Ta(t,e,n,r){return t=dr(7,t,r,e),t.lanes=n,t}function Xf(t,e,n,r){return t=dr(22,t,r,e),t.elementType=RE,t.lanes=n,t.stateNode={isHidden:!1},t}function Wp(t,e,n){return t=dr(6,t,null,e),t.lanes=n,t}function qp(t,e,n){return e=dr(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function d4(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Tp(0),this.expirationTimes=Tp(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Tp(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Ay(t,e,n,r,s,i,o,l,c){return t=new d4(t,e,n,l,c),e===1?(e=1,i===!0&&(e|=8)):e=0,i=dr(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},my(i),t}function h4(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:wo,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function bT(t){if(!t)return zi;t=t._reactInternals;e:{if(Xa(t)!==t||t.tag!==1)throw Error(V(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(An(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(V(171))}if(t.tag===1){var n=t.type;if(An(n))return _k(t,n,e)}return e}function ST(t,e,n,r,s,i,o,l,c){return t=Ay(n,r,!0,t,s,i,o,l,c),t.context=bT(null),n=t.current,r=pn(),s=Pi(n),i=Fs(r,s),i.callback=e??null,Ai(n,i,s),t.current.lanes=s,yu(t,s,r),Nn(t,r),t}function Yf(t,e,n,r){var s=e.current,i=pn(),o=Pi(s);return n=bT(n),e.context===null?e.context=n:e.pendingContext=n,e=Fs(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Ai(s,e,o),t!==null&&(Or(t,s,o,i),rh(t,s,o)),o}function Kh(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function ab(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Ny(t,e){ab(t,e),(t=t.alternate)&&ab(t,e)}function f4(){return null}var ET=typeof reportError=="function"?reportError:function(t){console.error(t)};function Py(t){this._internalRoot=t}Jf.prototype.render=Py.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(V(409));Yf(t,e,null,null)};Jf.prototype.unmount=Py.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Fa(function(){Yf(null,t,null,null)}),e[Os]=null}};function Jf(t){this._internalRoot=t}Jf.prototype.unstable_scheduleHydration=function(t){if(t){var e=ek();t={blockedOn:null,target:t,priority:e};for(var n=0;n<gi.length&&e!==0&&e<gi[n].priority;n++);gi.splice(n,0,t),n===0&&nk(t)}};function Fy(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Zf(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function ob(){}function m4(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var u=Kh(o);i.call(u)}}var o=ST(e,r,t,0,null,!1,!1,"",ob);return t._reactRootContainer=o,t[Os]=o.current,$c(t.nodeType===8?t.parentNode:t),Fa(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var u=Kh(c);l.call(u)}}var c=Ay(t,0,!1,null,null,!1,!1,"",ob);return t._reactRootContainer=c,t[Os]=c.current,$c(t.nodeType===8?t.parentNode:t),Fa(function(){Yf(e,c,n,r)}),c}function em(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var l=s;s=function(){var c=Kh(o);l.call(c)}}Yf(e,o,t,s)}else o=m4(n,e,t,s,r);return Kh(o)}JE=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=lc(e.pendingLanes);n!==0&&(Zx(e,n|1),Nn(e,mt()),!(Ae&6)&&(Xo=mt()+500,Ki()))}break;case 13:Fa(function(){var r=$s(t,1);if(r!==null){var s=pn();Or(r,t,1,s)}}),Ny(t,1)}};ey=function(t){if(t.tag===13){var e=$s(t,134217728);if(e!==null){var n=pn();Or(e,t,134217728,n)}Ny(t,134217728)}};ZE=function(t){if(t.tag===13){var e=Pi(t),n=$s(t,e);if(n!==null){var r=pn();Or(n,t,e,r)}Ny(t,e)}};ek=function(){return Me};tk=function(t,e){var n=Me;try{return Me=t,e()}finally{Me=n}};Yg=function(t,e,n){switch(e){case"input":if(Hg(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=Hf(r);if(!s)throw Error(V(90));NE(r),Hg(r,s)}}}break;case"textarea":FE(t,n);break;case"select":e=n.value,e!=null&&Fo(t,!!n.multiple,e,!1)}};zE=Iy;UE=Fa;var p4={usingClientEntryPoint:!1,Events:[wu,ko,Hf,$E,BE,Iy]},Zl={findFiberByHostInstance:va,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},g4={bundleType:Zl.bundleType,version:Zl.version,rendererPackageName:Zl.rendererPackageName,rendererConfig:Zl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Xs.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=WE(t),t===null?null:t.stateNode},findFiberByHostInstance:Zl.findFiberByHostInstance||f4,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Nd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Nd.isDisabled&&Nd.supportsFiber)try{Bf=Nd.inject(g4),ss=Nd}catch{}}tr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=p4;tr.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Fy(e))throw Error(V(200));return h4(t,e,null,n)};tr.createRoot=function(t,e){if(!Fy(t))throw Error(V(299));var n=!1,r="",s=ET;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Ay(t,1,!1,null,null,n,!1,r,s),t[Os]=e.current,$c(t.nodeType===8?t.parentNode:t),new Py(e)};tr.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(V(188)):(t=Object.keys(t).join(","),Error(V(268,t)));return t=WE(e),t=t===null?null:t.stateNode,t};tr.flushSync=function(t){return Fa(t)};tr.hydrate=function(t,e,n){if(!Zf(e))throw Error(V(200));return em(null,t,e,!0,n)};tr.hydrateRoot=function(t,e,n){if(!Fy(t))throw Error(V(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=ET;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=ST(e,null,t,1,n??null,s,!1,i,o),t[Os]=e.current,$c(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Jf(e)};tr.render=function(t,e,n){if(!Zf(e))throw Error(V(200));return em(null,t,e,!1,n)};tr.unmountComponentAtNode=function(t){if(!Zf(t))throw Error(V(40));return t._reactRootContainer?(Fa(function(){em(null,null,t,!1,function(){t._reactRootContainer=null,t[Os]=null})}),!0):!1};tr.unstable_batchedUpdates=Iy;tr.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Zf(n))throw Error(V(200));if(t==null||t._reactInternals===void 0)throw Error(V(38));return em(t,e,n,!1,r)};tr.version="18.2.0-next-9e3b772b8-20220608";function kT(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(kT)}catch(t){console.error(t)}}kT(),SE.exports=tr;var Ya=SE.exports,lb=Ya;Mg.createRoot=lb.createRoot,Mg.hydrateRoot=lb.hydrateRoot;/**
 * @remix-run/router v1.7.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Qc(){return Qc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Qc.apply(this,arguments)}var ki;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(ki||(ki={}));const cb="popstate";function x4(t){t===void 0&&(t={});function e(s,i){let{pathname:o="/",search:l="",hash:c=""}=Ja(s.location.hash.substr(1));return R0("",{pathname:o,search:l,hash:c},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(s,i){let o=s.document.querySelector("base"),l="";if(o&&o.getAttribute("href")){let c=s.location.href,u=c.indexOf("#");l=u===-1?c:c.slice(0,u)}return l+"#"+(typeof i=="string"?i:Xh(i))}function r(s,i){tm(s.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(i)+")")}return v4(e,n,r,t)}function gt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function tm(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function y4(){return Math.random().toString(36).substr(2,8)}function ub(t,e){return{usr:t.state,key:t.key,idx:e}}function R0(t,e,n,r){return n===void 0&&(n=null),Qc({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Ja(e):e,{state:n,key:e&&e.key||r||y4()})}function Xh(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Ja(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function v4(t,e,n,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:i=!1}=r,o=s.history,l=ki.Pop,c=null,u=d();u==null&&(u=0,o.replaceState(Qc({},o.state,{idx:u}),""));function d(){return(o.state||{idx:null}).idx}function m(){l=ki.Pop;let _=d(),E=_==null?null:_-u;u=_,c&&c({action:l,location:w.location,delta:E})}function p(_,E){l=ki.Push;let b=R0(w.location,_,E);n&&n(b,_),u=d()+1;let S=ub(b,u),C=w.createHref(b);try{o.pushState(S,"",C)}catch(D){if(D instanceof DOMException&&D.name==="DataCloneError")throw D;s.location.assign(C)}i&&c&&c({action:l,location:w.location,delta:1})}function g(_,E){l=ki.Replace;let b=R0(w.location,_,E);n&&n(b,_),u=d();let S=ub(b,u),C=w.createHref(b);o.replaceState(S,"",C),i&&c&&c({action:l,location:w.location,delta:0})}function y(_){let E=s.location.origin!=="null"?s.location.origin:s.location.href,b=typeof _=="string"?_:Xh(_);return gt(E,"No window.location.(origin|href) available to create URL for href: "+b),new URL(b,E)}let w={get action(){return l},get location(){return t(s,o)},listen(_){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(cb,m),c=_,()=>{s.removeEventListener(cb,m),c=null}},createHref(_){return e(s,_)},createURL:y,encodeLocation(_){let E=y(_);return{pathname:E.pathname,search:E.search,hash:E.hash}},push:p,replace:g,go(_){return o.go(_)}};return w}var db;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(db||(db={}));function w4(t,e,n){n===void 0&&(n="/");let r=typeof e=="string"?Ja(e):e,s=Dy(r.pathname||"/",n);if(s==null)return null;let i=TT(t);_4(i);let o=null;for(let l=0;o==null&&l<i.length;++l)o=R4(i[l],P4(s));return o}function TT(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let s=(i,o,l)=>{let c={relativePath:l===void 0?i.path||"":l,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};c.relativePath.startsWith("/")&&(gt(c.relativePath.startsWith(r),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(r.length));let u=Di([r,c.relativePath]),d=n.concat(c);i.children&&i.children.length>0&&(gt(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),TT(i.children,e,d,u)),!(i.path==null&&!i.index)&&e.push({path:u,score:C4(u,i.index),routesMeta:d})};return t.forEach((i,o)=>{var l;if(i.path===""||!((l=i.path)!=null&&l.includes("?")))s(i,o);else for(let c of IT(i.path))s(i,o,c)}),e}function IT(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let o=IT(r.join("/")),l=[];return l.push(...o.map(c=>c===""?i:[i,c].join("/"))),s&&l.push(...o),l.map(c=>t.startsWith("/")&&c===""?"/":c)}function _4(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:j4(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const b4=/^:\w+$/,S4=3,E4=2,k4=1,T4=10,I4=-2,hb=t=>t==="*";function C4(t,e){let n=t.split("/"),r=n.length;return n.some(hb)&&(r+=I4),e&&(r+=E4),n.filter(s=>!hb(s)).reduce((s,i)=>s+(b4.test(i)?S4:i===""?k4:T4),r)}function j4(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function R4(t,e){let{routesMeta:n}=t,r={},s="/",i=[];for(let o=0;o<n.length;++o){let l=n[o],c=o===n.length-1,u=s==="/"?e:e.slice(s.length)||"/",d=A4({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u);if(!d)return null;Object.assign(r,d.params);let m=l.route;i.push({params:r,pathname:Di([s,d.pathname]),pathnameBase:M4(Di([s,d.pathnameBase])),route:m}),d.pathnameBase!=="/"&&(s=Di([s,d.pathnameBase]))}return i}function A4(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=N4(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:r.reduce((u,d,m)=>{if(d==="*"){let p=l[m]||"";o=i.slice(0,i.length-p.length).replace(/(.)\/+$/,"$1")}return u[d]=F4(l[m]||"",d),u},{}),pathname:i,pathnameBase:o,pattern:t}}function N4(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),tm(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/\/:(\w+)/g,(o,l)=>(r.push(l),"/([^\\/]+)"));return t.endsWith("*")?(r.push("*"),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function P4(t){try{return decodeURI(t)}catch(e){return tm(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function F4(t,e){try{return decodeURIComponent(t)}catch(n){return tm(!1,'The value for the URL param "'+e+'" will not be decoded because'+(' the string "'+t+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+n+").")),t}}function Dy(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function D4(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?Ja(t):t;return{pathname:n?n.startsWith("/")?n:L4(n,e):e,search:O4(r),hash:$4(s)}}function L4(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function Gp(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Ly(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function My(t,e,n,r){r===void 0&&(r=!1);let s;typeof t=="string"?s=Ja(t):(s=Qc({},t),gt(!s.pathname||!s.pathname.includes("?"),Gp("?","pathname","search",s)),gt(!s.pathname||!s.pathname.includes("#"),Gp("#","pathname","hash",s)),gt(!s.search||!s.search.includes("#"),Gp("#","search","hash",s)));let i=t===""||s.pathname==="",o=i?"/":s.pathname,l;if(r||o==null)l=n;else{let m=e.length-1;if(o.startsWith("..")){let p=o.split("/");for(;p[0]==="..";)p.shift(),m-=1;s.pathname=p.join("/")}l=m>=0?e[m]:"/"}let c=D4(s,l),u=o&&o!=="/"&&o.endsWith("/"),d=(i||o===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}const Di=t=>t.join("/").replace(/\/\/+/g,"/"),M4=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),O4=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,$4=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function B4(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const CT=["post","put","patch","delete"];new Set(CT);const z4=["get",...CT];new Set(z4);/**
 * React Router v6.14.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Yh(){return Yh=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Yh.apply(this,arguments)}const Oy=f.createContext(null),U4=f.createContext(null),hl=f.createContext(null),nm=f.createContext(null),ms=f.createContext({outlet:null,matches:[],isDataRoute:!1}),jT=f.createContext(null);function V4(t,e){let{relative:n}=e===void 0?{}:e;fl()||gt(!1);let{basename:r,navigator:s}=f.useContext(hl),{hash:i,pathname:o,search:l}=AT(t,{relative:n}),c=o;return r!=="/"&&(c=o==="/"?r:Di([r,o])),s.createHref({pathname:c,search:l,hash:i})}function fl(){return f.useContext(nm)!=null}function rr(){return fl()||gt(!1),f.useContext(nm).location}function RT(t){f.useContext(hl).static||f.useLayoutEffect(t)}function Gt(){let{isDataRoute:t}=f.useContext(ms);return t?s3():H4()}function H4(){fl()||gt(!1);let t=f.useContext(Oy),{basename:e,navigator:n}=f.useContext(hl),{matches:r}=f.useContext(ms),{pathname:s}=rr(),i=JSON.stringify(Ly(r).map(c=>c.pathnameBase)),o=f.useRef(!1);return RT(()=>{o.current=!0}),f.useCallback(function(c,u){if(u===void 0&&(u={}),!o.current)return;if(typeof c=="number"){n.go(c);return}let d=My(c,JSON.parse(i),s,u.relative==="path");t==null&&e!=="/"&&(d.pathname=d.pathname==="/"?e:Di([e,d.pathname])),(u.replace?n.replace:n.push)(d,u.state,u)},[e,n,i,s,t])}const W4=f.createContext(null);function q4(t){let e=f.useContext(ms).outlet;return e&&f.createElement(W4.Provider,{value:t},e)}function Xi(){let{matches:t}=f.useContext(ms),e=t[t.length-1];return e?e.params:{}}function AT(t,e){let{relative:n}=e===void 0?{}:e,{matches:r}=f.useContext(ms),{pathname:s}=rr(),i=JSON.stringify(Ly(r).map(o=>o.pathnameBase));return f.useMemo(()=>My(t,JSON.parse(i),s,n==="path"),[t,i,s,n])}function G4(t,e){return Q4(t,e)}function Q4(t,e,n){fl()||gt(!1);let{navigator:r}=f.useContext(hl),{matches:s}=f.useContext(ms),i=s[s.length-1],o=i?i.params:{};i&&i.pathname;let l=i?i.pathnameBase:"/";i&&i.route;let c=rr(),u;if(e){var d;let w=typeof e=="string"?Ja(e):e;l==="/"||(d=w.pathname)!=null&&d.startsWith(l)||gt(!1),u=w}else u=c;let m=u.pathname||"/",p=l==="/"?m:m.slice(l.length)||"/",g=w4(t,{pathname:p}),y=Z4(g&&g.map(w=>Object.assign({},w,{params:Object.assign({},o,w.params),pathname:Di([l,r.encodeLocation?r.encodeLocation(w.pathname).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?l:Di([l,r.encodeLocation?r.encodeLocation(w.pathnameBase).pathname:w.pathnameBase])})),s,n);return e&&y?f.createElement(nm.Provider,{value:{location:Yh({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:ki.Pop}},y):y}function K4(){let t=r3(),e=B4(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},i=null;return f.createElement(f.Fragment,null,f.createElement("h2",null,"Unexpected Application Error!"),f.createElement("h3",{style:{fontStyle:"italic"}},e),n?f.createElement("pre",{style:s},n):null,i)}const X4=f.createElement(K4,null);class Y4 extends f.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error||n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error?f.createElement(ms.Provider,{value:this.props.routeContext},f.createElement(jT.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function J4(t){let{routeContext:e,match:n,children:r}=t,s=f.useContext(Oy);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),f.createElement(ms.Provider,{value:e},r)}function Z4(t,e,n){var r;if(e===void 0&&(e=[]),n===void 0&&(n=null),t==null){var s;if((s=n)!=null&&s.errors)t=n.matches;else return null}let i=t,o=(r=n)==null?void 0:r.errors;if(o!=null){let l=i.findIndex(c=>c.route.id&&(o==null?void 0:o[c.route.id]));l>=0||gt(!1),i=i.slice(0,Math.min(i.length,l+1))}return i.reduceRight((l,c,u)=>{let d=c.route.id?o==null?void 0:o[c.route.id]:null,m=null;n&&(m=c.route.errorElement||X4);let p=e.concat(i.slice(0,u+1)),g=()=>{let y;return d?y=m:c.route.Component?y=f.createElement(c.route.Component,null):c.route.element?y=c.route.element:y=l,f.createElement(J4,{match:c,routeContext:{outlet:l,matches:p,isDataRoute:n!=null},children:y})};return n&&(c.route.ErrorBoundary||c.route.errorElement||u===0)?f.createElement(Y4,{location:n.location,revalidation:n.revalidation,component:m,error:d,children:g(),routeContext:{outlet:null,matches:p,isDataRoute:!0}}):g()},null)}var A0;(function(t){t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate"})(A0||(A0={}));var Kc;(function(t){t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId"})(Kc||(Kc={}));function e3(t){let e=f.useContext(Oy);return e||gt(!1),e}function t3(t){let e=f.useContext(U4);return e||gt(!1),e}function n3(t){let e=f.useContext(ms);return e||gt(!1),e}function NT(t){let e=n3(),n=e.matches[e.matches.length-1];return n.route.id||gt(!1),n.route.id}function r3(){var t;let e=f.useContext(jT),n=t3(Kc.UseRouteError),r=NT(Kc.UseRouteError);return e||((t=n.errors)==null?void 0:t[r])}function s3(){let{router:t}=e3(A0.UseNavigateStable),e=NT(Kc.UseNavigateStable),n=f.useRef(!1);return RT(()=>{n.current=!0}),f.useCallback(function(s,i){i===void 0&&(i={}),n.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,Yh({fromRouteId:e},i)))},[t,e])}function PT(t){let{to:e,replace:n,state:r,relative:s}=t;fl()||gt(!1);let{matches:i}=f.useContext(ms),{pathname:o}=rr(),l=Gt(),c=My(e,Ly(i).map(d=>d.pathnameBase),o,s==="path"),u=JSON.stringify(c);return f.useEffect(()=>l(JSON.parse(u),{replace:n,state:r,relative:s}),[l,u,s,n,r]),null}function rm(t){return q4(t.context)}function Jr(t){gt(!1)}function i3(t){let{basename:e="/",children:n=null,location:r,navigationType:s=ki.Pop,navigator:i,static:o=!1}=t;fl()&&gt(!1);let l=e.replace(/^\/*/,"/"),c=f.useMemo(()=>({basename:l,navigator:i,static:o}),[l,i,o]);typeof r=="string"&&(r=Ja(r));let{pathname:u="/",search:d="",hash:m="",state:p=null,key:g="default"}=r,y=f.useMemo(()=>{let w=Dy(u,l);return w==null?null:{location:{pathname:w,search:d,hash:m,state:p,key:g},navigationType:s}},[l,u,d,m,p,g,s]);return y==null?null:f.createElement(hl.Provider,{value:c},f.createElement(nm.Provider,{children:n,value:y}))}function a3(t){let{children:e,location:n}=t;return G4(N0(e),n)}var fb;(function(t){t[t.pending=0]="pending",t[t.success=1]="success",t[t.error=2]="error"})(fb||(fb={}));new Promise(()=>{});function N0(t,e){e===void 0&&(e=[]);let n=[];return f.Children.forEach(t,(r,s)=>{if(!f.isValidElement(r))return;let i=[...e,s];if(r.type===f.Fragment){n.push.apply(n,N0(r.props.children,i));return}r.type!==Jr&&gt(!1),!r.props.index||!r.props.children||gt(!1);let o={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=N0(r.props.children,i)),n.push(o)}),n}/**
 * React Router DOM v6.14.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function P0(){return P0=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},P0.apply(this,arguments)}function o3(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,i;for(i=0;i<r.length;i++)s=r[i],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}function l3(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function c3(t,e){return t.button===0&&(!e||e==="_self")&&!l3(t)}function F0(t){return t===void 0&&(t=""),new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let r=t[n];return e.concat(Array.isArray(r)?r.map(s=>[n,s]):[[n,r]])},[]))}function u3(t,e){let n=F0(t);if(e)for(let r of e.keys())n.has(r)||e.getAll(r).forEach(s=>{n.append(r,s)});return n}const d3=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset"],h3="startTransition",mb=oN[h3];function f3(t){let{basename:e,children:n,future:r,window:s}=t,i=f.useRef();i.current==null&&(i.current=x4({window:s,v5Compat:!0}));let o=i.current,[l,c]=f.useState({action:o.action,location:o.location}),{v7_startTransition:u}=r||{},d=f.useCallback(m=>{u&&mb?mb(()=>c(m)):c(m)},[c,u]);return f.useLayoutEffect(()=>o.listen(d),[o,d]),f.createElement(i3,{basename:e,children:n,location:l.location,navigationType:l.action,navigator:o})}const m3=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",p3=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,we=f.forwardRef(function(e,n){let{onClick:r,relative:s,reloadDocument:i,replace:o,state:l,target:c,to:u,preventScrollReset:d}=e,m=o3(e,d3),{basename:p}=f.useContext(hl),g,y=!1;if(typeof u=="string"&&p3.test(u)&&(g=u,m3))try{let b=new URL(window.location.href),S=u.startsWith("//")?new URL(b.protocol+u):new URL(u),C=Dy(S.pathname,p);S.origin===b.origin&&C!=null?u=C+S.search+S.hash:y=!0}catch{}let w=V4(u,{relative:s}),_=g3(u,{replace:o,state:l,target:c,preventScrollReset:d,relative:s});function E(b){r&&r(b),b.defaultPrevented||_(b)}return f.createElement("a",P0({},m,{href:g||w,onClick:y||i?r:E,ref:n,target:c}))});var pb;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher"})(pb||(pb={}));var gb;(function(t){t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(gb||(gb={}));function g3(t,e){let{target:n,replace:r,state:s,preventScrollReset:i,relative:o}=e===void 0?{}:e,l=Gt(),c=rr(),u=AT(t,{relative:o});return f.useCallback(d=>{if(c3(d,n)){d.preventDefault();let m=r!==void 0?r:Xh(c)===Xh(u);l(t,{replace:m,state:s,preventScrollReset:i,relative:o})}},[c,l,u,r,s,n,t,i,o])}function FT(t){let e=f.useRef(F0(t)),n=f.useRef(!1),r=rr(),s=f.useMemo(()=>u3(r.search,n.current?null:e.current),[r.search]),i=Gt(),o=f.useCallback((l,c)=>{const u=F0(typeof l=="function"?l(s):l);n.current=!0,i("?"+u,c)},[i,s]);return[s,o]}function x3(){const[t,e]=f.useState([]),[n,r]=f.useState(),[s,i]=f.useState([]),[o,l]=f.useState([]),[c,u]=f.useState([]);return{singer:n,setSinger:r,singers:t,setSingers:e,songs:s,setSongs:i,playlists:o,setPlaylists:l,albums:c,setAlbums:u}}const DT=f.createContext(null);function y3({children:t}){return a.jsx(DT.Provider,{value:x3(),children:t})}function Ys(){const t=f.useContext(DT);if(!t)throw new Error("SingerProvider not provided");return t}function xb({children:t}){return a.jsx(y3,{children:t})}function bu(){const t={container:"pt-[30px] pb-[110px] md:mt-auto md:pb-[120px] md:flex md:justify-between md:items-center",icon:"w-6 hover:scale-[1.1] transition linear ",copyRightText:"text-sm"};return a.jsxs("div",{className:`${t.container}`,children:[a.jsxs("p",{className:t.copyRightText,children:["Make with  ",a.jsx("span",{className:"text-red-500",children:"❤"}),"  by d4t06 ",a.jsx("br",{})," © All rights no reserve ¯\\_(ツ)_/¯"]}),a.jsxs("div",{className:"flex items-center mt-[20px] md:mt-0 space-x-[10px]",children:[a.jsx("a",{href:"mailto:datnh0708@gmail.com",children:a.jsx("svg",{className:t.icon,fill:"currentColor",viewBox:"0 0 32 32",xmlns:"http://www.w3.org/2000/svg",children:a.jsxs("g",{children:[a.jsx("path",{d:"M16.601 14.648v4.105h9.813c-0.162 2.008-0.982 3.798-2.243 5.18l0.006-0.007c-1.825 1.86-4.364 3.012-7.172 3.012-0.142 0-0.283-0.003-0.424-0.009l0.020 0.001c-5.946-0.003-10.765-4.823-10.765-10.77 0-0.051 0-0.102 0.001-0.152l-0 0.008c-0.001-0.043-0.001-0.094-0.001-0.145 0-5.946 4.819-10.767 10.765-10.77h0c0.040-0.001 0.087-0.001 0.135-0.001 2.822 0 5.383 1.121 7.262 2.941l-0.003-0.003 2.888-2.888c-2.568-2.578-6.121-4.174-10.047-4.174-0.082 0-0.164 0.001-0.246 0.002l0.012-0c-0.002 0-0.005 0-0.008 0-8.337 0-15.11 6.699-15.228 15.009l-0 0.011c0.118 8.32 6.891 15.020 15.228 15.020 0.003 0 0.006 0 0.009 0h-0c0.169 0.007 0.367 0.012 0.566 0.012 3.892 0 7.407-1.616 9.91-4.213l0.004-0.004c2.208-2.408 3.561-5.63 3.561-9.169 0-0.15-0.002-0.3-0.007-0.449l0.001 0.022c0.001-0.054 0.001-0.119 0.001-0.183 0-0.844-0.079-1.669-0.231-2.469l0.013 0.082z"})," "]})})}),a.jsx("a",{href:"https://github.com/d4t06",target:"_blank",children:a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t.icon,fill:"currentColor",viewBox:"0 0 496 512",children:a.jsx("path",{d:"M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"})})}),a.jsx("a",{href:"https://www.linkedin.com/in/dat-nguyen-huu-9371a926a",target:"_blank",children:a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t.icon,viewBox:"0 0 448 512",fill:"currentColor",children:a.jsx("path",{d:"M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"})})})]})]})}const v3=()=>{const[t,e]=f.useState(null),[n,r]=f.useState(!0),s=f.useRef(!1);return{user:t,setUser:e,loading:n,setLoading:r,updateUserData:o=>{e(l=>l?{...l,...o}:null)},justRegistered:s}},LT=f.createContext(null);function xe(){const t=f.useContext(LT);if(!t)throw new Error("auth context not Provided");return t}function w3({children:t}){return a.jsx(LT.Provider,{value:v3(),children:t})}function _3(){const[t,e]=f.useState({songs:[],playlists:[]}),[n,r]=f.useState([]),[s,i]=f.useState([]),[o,l]=f.useState([]),[c,u]=f.useState([]),d=f.useRef(!0),m=f.useRef(!0),p=f.useRef(!0),g=f.useRef(!0);return{uploadedSongs:n,setUploadedSongs:r,playlists:o,setPlaylists:l,favoriteSongs:s,setFavoriteSongs:i,sysSongPlaylist:t,setSysSongPlaylist:e,shouldFetchUserSongs:d,shouldFetchUserPlaylists:p,shouldFetchFavoriteSongs:m,updateSong:w=>{const _=[...n],E=_.findIndex(b=>b.id===w.id);if(E!==-1){const b={..._[E]};Object.assign(b,w.song),_[E]=b,r(_)}},singers:c,setSingers:u,shouldFetchUserSingers:g}}const MT=f.createContext(null);function b3({children:t}){return a.jsx(MT.Provider,{value:_3(),children:t})}const Pn=()=>{const t=f.useContext(MT);if(!t)throw new Error("SongContext not provided");return t},Jh=[{name:"Red",id:"red",type:"dark",bottom_player_bg:"bg-[#3b1113]",side_bar_bg:"bg-[#391b1c]",content_text:"text-[#ca4954]",content_hover_text:"hover:text-[#ca4954]",content_border:"border-[#ca4954]",content_hover_border:"hover:border-[#ca4954]",content_bg:"bg-[#ca4954] text-[#fff]",modal_bg:"bg-[#4f171c]",content_code:"#ca4954",content_hover_bg:"hover:!bg-[#ca4954] hover:text-[#fff] ",container:"bg-[#2e0f10]",container_code:"#2e0f10",text_color:""},{name:"Black",id:"black",type:"dark",bottom_player_bg:"bg-[#181818]",side_bar_bg:"bg-[#242424]",content_text:"text-[#198585]",content_hover_text:"hover:text-[#198585]",content_border:"border-[#198585]",content_hover_border:"hover:border-[#198585]",content_bg:"bg-[#198585]  text-[#fff]",modal_bg:"bg-[#333]",content_code:"#198585",content_hover_bg:"hover:!bg-[#198585] hover:text-[#fff] ",container:"bg-[#1e1e1e]",container_code:"#1e1e1e",text_color:""},{name:"Deep blue",id:"deep_blue",type:"dark",bottom_player_bg:"bg-[#111f3b]",side_bar_bg:"bg-[#1b2639]",content_text:"text-[#0c9e85]",content_hover_text:"hover:text-[#0c9e85]",content_border:"border-[#0c9e85]",content_hover_border:"hover:border-[#0c9e85]",content_bg:"bg-[#0c9e85]  text-[#fff]",modal_bg:"bg-[#05473c]",content_code:"#0c9e85",content_hover_bg:"hover:!bg-[#0c9e85] hover:text-[#fff] ",container:"bg-[#0f1a2e]",container_code:"#0f1a2e",text_color:""},{name:"White",id:"white",type:"light",bottom_player_bg:"bg-[#fff]",side_bar_bg:"bg-[#f2f2f2]",content_text:"text-[#198585]",content_hover_text:"hover:text-[#198585]",content_border:"border-[#198585]",content_hover_border:"hover:border-[#198585]",content_bg:"bg-[#198585] text-[#fff]",modal_bg:"bg-[#105656]",content_code:"#198585",content_hover_bg:"hover:!bg-[#198585] hover:text-[#fff]",container:"bg-[#fff]",container_code:"#fff",text_color:""},{name:"Light green",id:"green_light",type:"light",bottom_player_bg:"bg-[#c0d8d8]",side_bar_bg:"bg-[#dde5e5]",content_text:"text-[#198585]",content_hover_text:"hover:text-[#198585]",content_border:"border-[#198585]",content_hover_border:"hover:border-[#198585]",content_bg:"bg-[#198585] text-[#fff]",modal_bg:"bg-[#105656]",content_code:"#198585",content_hover_bg:"hover:!bg-[#198585] hover:text-[#fff]",container:"bg-[#ced9d9]",container_code:"#ced9d9",text_color:""},{name:"Brown",id:"gray",type:"light",bottom_player_bg:"bg-[#dedad1]",side_bar_bg:"bg-[#d9d7d4]",content_text:"text-[#644646]",content_hover_text:"hover:text-[#644646]",content_border:"border-[#644646]",content_hover_border:"hover:border-[#644646]",content_bg:"bg-[#644646]  text-[#fff]",modal_bg:"bg-[#3c2a2a]",content_code:"#644646",content_hover_bg:"hover:!bg-[#644646] hover:text-[#fff]",container:"bg-white",container_code:"#fff",text_color:""}],S3={name:"dashboard",id:"dashboard",type:"light",bottom_player_bg:"bg-[#fff]",side_bar_bg:"bg-[#f2f2f2]",content_text:"text-[#5a9e87]",content_hover_text:"hover:text-[#5a9e87]",content_border:"border-[#5a9e87]",content_hover_border:"hover:border-[#5a9e87]",content_bg:"bg-[#5a9e87] text-[#fff]",modal_bg:"bg-[#417161]",content_code:"#5a9e87",content_hover_bg:"hover:!bg-[#5a9e87] hover:text-[#fff]",container:"bg-[#fff]",container_code:"#fff",text_color:""},OT=[{name:"Tet",id:"tet",type:"light",bottom_player_bg:"bg-[#fdf6e3]",side_bar_bg:"bg-[#fdf6e3]",content_text:"text-[#644646]",content_hover_text:"hover:text-[#644646]",content_border:"border-[#644646]",content_hover_border:"hover:border-[#644646]",content_bg:"bg-[#644646]  text-[#fff]",modal_bg:"bg-[#3c2a2a]",content_code:"#644646",content_hover_bg:"hover:!bg-[#644646] hover:text-[#fff]",container:"bg-[#f7f0de]",container_code:"#fdf6e3",text_color:"",image:"tet_theme_image.png"}];function $T(t,e){return function(){return t.apply(e,arguments)}}const{toString:E3}=Object.prototype,{getPrototypeOf:$y}=Object,sm=(t=>e=>{const n=E3.call(e);return t[n]||(t[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),qr=t=>(t=t.toLowerCase(),e=>sm(e)===t),im=t=>e=>typeof e===t,{isArray:ml}=Array,Xc=im("undefined");function k3(t){return t!==null&&!Xc(t)&&t.constructor!==null&&!Xc(t.constructor)&&Kn(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const BT=qr("ArrayBuffer");function T3(t){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&BT(t.buffer),e}const I3=im("string"),Kn=im("function"),zT=im("number"),am=t=>t!==null&&typeof t=="object",C3=t=>t===!0||t===!1,uh=t=>{if(sm(t)!=="object")return!1;const e=$y(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},j3=qr("Date"),R3=qr("File"),A3=qr("Blob"),N3=qr("FileList"),P3=t=>am(t)&&Kn(t.pipe),F3=t=>{let e;return t&&(typeof FormData=="function"&&t instanceof FormData||Kn(t.append)&&((e=sm(t))==="formdata"||e==="object"&&Kn(t.toString)&&t.toString()==="[object FormData]"))},D3=qr("URLSearchParams"),[L3,M3,O3,$3]=["ReadableStream","Request","Response","Headers"].map(qr),B3=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Su(t,e,{allOwnKeys:n=!1}={}){if(t===null||typeof t>"u")return;let r,s;if(typeof t!="object"&&(t=[t]),ml(t))for(r=0,s=t.length;r<s;r++)e.call(null,t[r],r,t);else{const i=n?Object.getOwnPropertyNames(t):Object.keys(t),o=i.length;let l;for(r=0;r<o;r++)l=i[r],e.call(null,t[l],l,t)}}function UT(t,e){e=e.toLowerCase();const n=Object.keys(t);let r=n.length,s;for(;r-- >0;)if(s=n[r],e===s.toLowerCase())return s;return null}const ba=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),VT=t=>!Xc(t)&&t!==ba;function D0(){const{caseless:t}=VT(this)&&this||{},e={},n=(r,s)=>{const i=t&&UT(e,s)||s;uh(e[i])&&uh(r)?e[i]=D0(e[i],r):uh(r)?e[i]=D0({},r):ml(r)?e[i]=r.slice():e[i]=r};for(let r=0,s=arguments.length;r<s;r++)arguments[r]&&Su(arguments[r],n);return e}const z3=(t,e,n,{allOwnKeys:r}={})=>(Su(e,(s,i)=>{n&&Kn(s)?t[i]=$T(s,n):t[i]=s},{allOwnKeys:r}),t),U3=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),V3=(t,e,n,r)=>{t.prototype=Object.create(e.prototype,r),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),n&&Object.assign(t.prototype,n)},H3=(t,e,n,r)=>{let s,i,o;const l={};if(e=e||{},t==null)return e;do{for(s=Object.getOwnPropertyNames(t),i=s.length;i-- >0;)o=s[i],(!r||r(o,t,e))&&!l[o]&&(e[o]=t[o],l[o]=!0);t=n!==!1&&$y(t)}while(t&&(!n||n(t,e))&&t!==Object.prototype);return e},W3=(t,e,n)=>{t=String(t),(n===void 0||n>t.length)&&(n=t.length),n-=e.length;const r=t.indexOf(e,n);return r!==-1&&r===n},q3=t=>{if(!t)return null;if(ml(t))return t;let e=t.length;if(!zT(e))return null;const n=new Array(e);for(;e-- >0;)n[e]=t[e];return n},G3=(t=>e=>t&&e instanceof t)(typeof Uint8Array<"u"&&$y(Uint8Array)),Q3=(t,e)=>{const r=(t&&t[Symbol.iterator]).call(t);let s;for(;(s=r.next())&&!s.done;){const i=s.value;e.call(t,i[0],i[1])}},K3=(t,e)=>{let n;const r=[];for(;(n=t.exec(e))!==null;)r.push(n);return r},X3=qr("HTMLFormElement"),Y3=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,r,s){return r.toUpperCase()+s}),yb=(({hasOwnProperty:t})=>(e,n)=>t.call(e,n))(Object.prototype),J3=qr("RegExp"),HT=(t,e)=>{const n=Object.getOwnPropertyDescriptors(t),r={};Su(n,(s,i)=>{let o;(o=e(s,i,t))!==!1&&(r[i]=o||s)}),Object.defineProperties(t,r)},Z3=t=>{HT(t,(e,n)=>{if(Kn(t)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const r=t[n];if(Kn(r)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},eF=(t,e)=>{const n={},r=s=>{s.forEach(i=>{n[i]=!0})};return ml(t)?r(t):r(String(t).split(e)),n},tF=()=>{},nF=(t,e)=>t!=null&&Number.isFinite(t=+t)?t:e;function rF(t){return!!(t&&Kn(t.append)&&t[Symbol.toStringTag]==="FormData"&&t[Symbol.iterator])}const sF=t=>{const e=new Array(10),n=(r,s)=>{if(am(r)){if(e.indexOf(r)>=0)return;if(!("toJSON"in r)){e[s]=r;const i=ml(r)?[]:{};return Su(r,(o,l)=>{const c=n(o,s+1);!Xc(c)&&(i[l]=c)}),e[s]=void 0,i}}return r};return n(t,0)},iF=qr("AsyncFunction"),aF=t=>t&&(am(t)||Kn(t))&&Kn(t.then)&&Kn(t.catch),WT=((t,e)=>t?setImmediate:e?((n,r)=>(ba.addEventListener("message",({source:s,data:i})=>{s===ba&&i===n&&r.length&&r.shift()()},!1),s=>{r.push(s),ba.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",Kn(ba.postMessage)),oF=typeof queueMicrotask<"u"?queueMicrotask.bind(ba):typeof process<"u"&&process.nextTick||WT,O={isArray:ml,isArrayBuffer:BT,isBuffer:k3,isFormData:F3,isArrayBufferView:T3,isString:I3,isNumber:zT,isBoolean:C3,isObject:am,isPlainObject:uh,isReadableStream:L3,isRequest:M3,isResponse:O3,isHeaders:$3,isUndefined:Xc,isDate:j3,isFile:R3,isBlob:A3,isRegExp:J3,isFunction:Kn,isStream:P3,isURLSearchParams:D3,isTypedArray:G3,isFileList:N3,forEach:Su,merge:D0,extend:z3,trim:B3,stripBOM:U3,inherits:V3,toFlatObject:H3,kindOf:sm,kindOfTest:qr,endsWith:W3,toArray:q3,forEachEntry:Q3,matchAll:K3,isHTMLForm:X3,hasOwnProperty:yb,hasOwnProp:yb,reduceDescriptors:HT,freezeMethods:Z3,toObjectSet:eF,toCamelCase:Y3,noop:tF,toFiniteNumber:nF,findKey:UT,global:ba,isContextDefined:VT,isSpecCompliantForm:rF,toJSONObject:sF,isAsyncFn:iF,isThenable:aF,setImmediate:WT,asap:oF};function pe(t,e,n,r,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",e&&(this.code=e),n&&(this.config=n),r&&(this.request=r),s&&(this.response=s,this.status=s.status?s.status:null)}O.inherits(pe,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:O.toJSONObject(this.config),code:this.code,status:this.status}}});const qT=pe.prototype,GT={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{GT[t]={value:t}});Object.defineProperties(pe,GT);Object.defineProperty(qT,"isAxiosError",{value:!0});pe.from=(t,e,n,r,s,i)=>{const o=Object.create(qT);return O.toFlatObject(t,o,function(c){return c!==Error.prototype},l=>l!=="isAxiosError"),pe.call(o,t.message,e,n,r,s),o.cause=t,o.name=t.name,i&&Object.assign(o,i),o};const lF=null;function L0(t){return O.isPlainObject(t)||O.isArray(t)}function QT(t){return O.endsWith(t,"[]")?t.slice(0,-2):t}function vb(t,e,n){return t?t.concat(e).map(function(s,i){return s=QT(s),!n&&i?"["+s+"]":s}).join(n?".":""):e}function cF(t){return O.isArray(t)&&!t.some(L0)}const uF=O.toFlatObject(O,{},null,function(e){return/^is[A-Z]/.test(e)});function om(t,e,n){if(!O.isObject(t))throw new TypeError("target must be an object");e=e||new FormData,n=O.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(w,_){return!O.isUndefined(_[w])});const r=n.metaTokens,s=n.visitor||d,i=n.dots,o=n.indexes,c=(n.Blob||typeof Blob<"u"&&Blob)&&O.isSpecCompliantForm(e);if(!O.isFunction(s))throw new TypeError("visitor must be a function");function u(y){if(y===null)return"";if(O.isDate(y))return y.toISOString();if(!c&&O.isBlob(y))throw new pe("Blob is not supported. Use a Buffer instead.");return O.isArrayBuffer(y)||O.isTypedArray(y)?c&&typeof Blob=="function"?new Blob([y]):Buffer.from(y):y}function d(y,w,_){let E=y;if(y&&!_&&typeof y=="object"){if(O.endsWith(w,"{}"))w=r?w:w.slice(0,-2),y=JSON.stringify(y);else if(O.isArray(y)&&cF(y)||(O.isFileList(y)||O.endsWith(w,"[]"))&&(E=O.toArray(y)))return w=QT(w),E.forEach(function(S,C){!(O.isUndefined(S)||S===null)&&e.append(o===!0?vb([w],C,i):o===null?w:w+"[]",u(S))}),!1}return L0(y)?!0:(e.append(vb(_,w,i),u(y)),!1)}const m=[],p=Object.assign(uF,{defaultVisitor:d,convertValue:u,isVisitable:L0});function g(y,w){if(!O.isUndefined(y)){if(m.indexOf(y)!==-1)throw Error("Circular reference detected in "+w.join("."));m.push(y),O.forEach(y,function(E,b){(!(O.isUndefined(E)||E===null)&&s.call(e,E,O.isString(b)?b.trim():b,w,p))===!0&&g(E,w?w.concat(b):[b])}),m.pop()}}if(!O.isObject(t))throw new TypeError("data must be an object");return g(t),e}function wb(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(r){return e[r]})}function By(t,e){this._pairs=[],t&&om(t,this,e)}const KT=By.prototype;KT.append=function(e,n){this._pairs.push([e,n])};KT.toString=function(e){const n=e?function(r){return e.call(this,r,wb)}:wb;return this._pairs.map(function(s){return n(s[0])+"="+n(s[1])},"").join("&")};function dF(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function XT(t,e,n){if(!e)return t;const r=n&&n.encode||dF;O.isFunction(n)&&(n={serialize:n});const s=n&&n.serialize;let i;if(s?i=s(e,n):i=O.isURLSearchParams(e)?e.toString():new By(e,n).toString(r),i){const o=t.indexOf("#");o!==-1&&(t=t.slice(0,o)),t+=(t.indexOf("?")===-1?"?":"&")+i}return t}class hF{constructor(){this.handlers=[]}use(e,n,r){return this.handlers.push({fulfilled:e,rejected:n,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){O.forEach(this.handlers,function(r){r!==null&&e(r)})}}const _b=hF,YT={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},fF=typeof URLSearchParams<"u"?URLSearchParams:By,mF=typeof FormData<"u"?FormData:null,pF=typeof Blob<"u"?Blob:null,gF={isBrowser:!0,classes:{URLSearchParams:fF,FormData:mF,Blob:pF},protocols:["http","https","file","blob","url","data"]},zy=typeof window<"u"&&typeof document<"u",M0=typeof navigator=="object"&&navigator||void 0,xF=zy&&(!M0||["ReactNative","NativeScript","NS"].indexOf(M0.product)<0),yF=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),vF=zy&&window.location.href||"http://localhost",wF=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:zy,hasStandardBrowserEnv:xF,hasStandardBrowserWebWorkerEnv:yF,navigator:M0,origin:vF},Symbol.toStringTag,{value:"Module"})),rn={...wF,...gF};function _F(t,e){return om(t,new rn.classes.URLSearchParams,Object.assign({visitor:function(n,r,s,i){return rn.isNode&&O.isBuffer(n)?(this.append(r,n.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)}},e))}function bF(t){return O.matchAll(/\w+|\[(\w*)]/g,t).map(e=>e[0]==="[]"?"":e[1]||e[0])}function SF(t){const e={},n=Object.keys(t);let r;const s=n.length;let i;for(r=0;r<s;r++)i=n[r],e[i]=t[i];return e}function JT(t){function e(n,r,s,i){let o=n[i++];if(o==="__proto__")return!0;const l=Number.isFinite(+o),c=i>=n.length;return o=!o&&O.isArray(s)?s.length:o,c?(O.hasOwnProp(s,o)?s[o]=[s[o],r]:s[o]=r,!l):((!s[o]||!O.isObject(s[o]))&&(s[o]=[]),e(n,r,s[o],i)&&O.isArray(s[o])&&(s[o]=SF(s[o])),!l)}if(O.isFormData(t)&&O.isFunction(t.entries)){const n={};return O.forEachEntry(t,(r,s)=>{e(bF(r),s,n,0)}),n}return null}function EF(t,e,n){if(O.isString(t))try{return(e||JSON.parse)(t),O.trim(t)}catch(r){if(r.name!=="SyntaxError")throw r}return(n||JSON.stringify)(t)}const Uy={transitional:YT,adapter:["xhr","http","fetch"],transformRequest:[function(e,n){const r=n.getContentType()||"",s=r.indexOf("application/json")>-1,i=O.isObject(e);if(i&&O.isHTMLForm(e)&&(e=new FormData(e)),O.isFormData(e))return s?JSON.stringify(JT(e)):e;if(O.isArrayBuffer(e)||O.isBuffer(e)||O.isStream(e)||O.isFile(e)||O.isBlob(e)||O.isReadableStream(e))return e;if(O.isArrayBufferView(e))return e.buffer;if(O.isURLSearchParams(e))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let l;if(i){if(r.indexOf("application/x-www-form-urlencoded")>-1)return _F(e,this.formSerializer).toString();if((l=O.isFileList(e))||r.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return om(l?{"files[]":e}:e,c&&new c,this.formSerializer)}}return i||s?(n.setContentType("application/json",!1),EF(e)):e}],transformResponse:[function(e){const n=this.transitional||Uy.transitional,r=n&&n.forcedJSONParsing,s=this.responseType==="json";if(O.isResponse(e)||O.isReadableStream(e))return e;if(e&&O.isString(e)&&(r&&!this.responseType||s)){const o=!(n&&n.silentJSONParsing)&&s;try{return JSON.parse(e)}catch(l){if(o)throw l.name==="SyntaxError"?pe.from(l,pe.ERR_BAD_RESPONSE,this,null,this.response):l}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:rn.classes.FormData,Blob:rn.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};O.forEach(["delete","get","head","post","put","patch"],t=>{Uy.headers[t]={}});const Vy=Uy,kF=O.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),TF=t=>{const e={};let n,r,s;return t&&t.split(`
`).forEach(function(o){s=o.indexOf(":"),n=o.substring(0,s).trim().toLowerCase(),r=o.substring(s+1).trim(),!(!n||e[n]&&kF[n])&&(n==="set-cookie"?e[n]?e[n].push(r):e[n]=[r]:e[n]=e[n]?e[n]+", "+r:r)}),e},bb=Symbol("internals");function ec(t){return t&&String(t).trim().toLowerCase()}function dh(t){return t===!1||t==null?t:O.isArray(t)?t.map(dh):String(t)}function IF(t){const e=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(t);)e[r[1]]=r[2];return e}const CF=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function Qp(t,e,n,r,s){if(O.isFunction(r))return r.call(this,e,n);if(s&&(e=n),!!O.isString(e)){if(O.isString(r))return e.indexOf(r)!==-1;if(O.isRegExp(r))return r.test(e)}}function jF(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,n,r)=>n.toUpperCase()+r)}function RF(t,e){const n=O.toCamelCase(" "+e);["get","set","has"].forEach(r=>{Object.defineProperty(t,r+n,{value:function(s,i,o){return this[r].call(this,e,s,i,o)},configurable:!0})})}class lm{constructor(e){e&&this.set(e)}set(e,n,r){const s=this;function i(l,c,u){const d=ec(c);if(!d)throw new Error("header name must be a non-empty string");const m=O.findKey(s,d);(!m||s[m]===void 0||u===!0||u===void 0&&s[m]!==!1)&&(s[m||c]=dh(l))}const o=(l,c)=>O.forEach(l,(u,d)=>i(u,d,c));if(O.isPlainObject(e)||e instanceof this.constructor)o(e,n);else if(O.isString(e)&&(e=e.trim())&&!CF(e))o(TF(e),n);else if(O.isHeaders(e))for(const[l,c]of e.entries())i(c,l,r);else e!=null&&i(n,e,r);return this}get(e,n){if(e=ec(e),e){const r=O.findKey(this,e);if(r){const s=this[r];if(!n)return s;if(n===!0)return IF(s);if(O.isFunction(n))return n.call(this,s,r);if(O.isRegExp(n))return n.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,n){if(e=ec(e),e){const r=O.findKey(this,e);return!!(r&&this[r]!==void 0&&(!n||Qp(this,this[r],r,n)))}return!1}delete(e,n){const r=this;let s=!1;function i(o){if(o=ec(o),o){const l=O.findKey(r,o);l&&(!n||Qp(r,r[l],l,n))&&(delete r[l],s=!0)}}return O.isArray(e)?e.forEach(i):i(e),s}clear(e){const n=Object.keys(this);let r=n.length,s=!1;for(;r--;){const i=n[r];(!e||Qp(this,this[i],i,e,!0))&&(delete this[i],s=!0)}return s}normalize(e){const n=this,r={};return O.forEach(this,(s,i)=>{const o=O.findKey(r,i);if(o){n[o]=dh(s),delete n[i];return}const l=e?jF(i):String(i).trim();l!==i&&delete n[i],n[l]=dh(s),r[l]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const n=Object.create(null);return O.forEach(this,(r,s)=>{r!=null&&r!==!1&&(n[s]=e&&O.isArray(r)?r.join(", "):r)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,n])=>e+": "+n).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...n){const r=new this(e);return n.forEach(s=>r.set(s)),r}static accessor(e){const r=(this[bb]=this[bb]={accessors:{}}).accessors,s=this.prototype;function i(o){const l=ec(o);r[l]||(RF(s,o),r[l]=!0)}return O.isArray(e)?e.forEach(i):i(e),this}}lm.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);O.reduceDescriptors(lm.prototype,({value:t},e)=>{let n=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(r){this[n]=r}}});O.freezeMethods(lm);const $r=lm;function Kp(t,e){const n=this||Vy,r=e||n,s=$r.from(r.headers);let i=r.data;return O.forEach(t,function(l){i=l.call(n,i,s.normalize(),e?e.status:void 0)}),s.normalize(),i}function ZT(t){return!!(t&&t.__CANCEL__)}function pl(t,e,n){pe.call(this,t??"canceled",pe.ERR_CANCELED,e,n),this.name="CanceledError"}O.inherits(pl,pe,{__CANCEL__:!0});function eI(t,e,n){const r=n.config.validateStatus;!n.status||!r||r(n.status)?t(n):e(new pe("Request failed with status code "+n.status,[pe.ERR_BAD_REQUEST,pe.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function AF(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}function NF(t,e){t=t||10;const n=new Array(t),r=new Array(t);let s=0,i=0,o;return e=e!==void 0?e:1e3,function(c){const u=Date.now(),d=r[i];o||(o=u),n[s]=c,r[s]=u;let m=i,p=0;for(;m!==s;)p+=n[m++],m=m%t;if(s=(s+1)%t,s===i&&(i=(i+1)%t),u-o<e)return;const g=d&&u-d;return g?Math.round(p*1e3/g):void 0}}function PF(t,e){let n=0,r=1e3/e,s,i;const o=(u,d=Date.now())=>{n=d,s=null,i&&(clearTimeout(i),i=null),t.apply(null,u)};return[(...u)=>{const d=Date.now(),m=d-n;m>=r?o(u,d):(s=u,i||(i=setTimeout(()=>{i=null,o(s)},r-m)))},()=>s&&o(s)]}const Zh=(t,e,n=3)=>{let r=0;const s=NF(50,250);return PF(i=>{const o=i.loaded,l=i.lengthComputable?i.total:void 0,c=o-r,u=s(c),d=o<=l;r=o;const m={loaded:o,total:l,progress:l?o/l:void 0,bytes:c,rate:u||void 0,estimated:u&&l&&d?(l-o)/u:void 0,event:i,lengthComputable:l!=null,[e?"download":"upload"]:!0};t(m)},n)},Sb=(t,e)=>{const n=t!=null;return[r=>e[0]({lengthComputable:n,total:t,loaded:r}),e[1]]},Eb=t=>(...e)=>O.asap(()=>t(...e)),FF=rn.hasStandardBrowserEnv?((t,e)=>n=>(n=new URL(n,rn.origin),t.protocol===n.protocol&&t.host===n.host&&(e||t.port===n.port)))(new URL(rn.origin),rn.navigator&&/(msie|trident)/i.test(rn.navigator.userAgent)):()=>!0,DF=rn.hasStandardBrowserEnv?{write(t,e,n,r,s,i){const o=[t+"="+encodeURIComponent(e)];O.isNumber(n)&&o.push("expires="+new Date(n).toGMTString()),O.isString(r)&&o.push("path="+r),O.isString(s)&&o.push("domain="+s),i===!0&&o.push("secure"),document.cookie=o.join("; ")},read(t){const e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function LF(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function MF(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}function tI(t,e,n){let r=!LF(e);return t&&r||n==!1?MF(t,e):e}const kb=t=>t instanceof $r?{...t}:t;function Da(t,e){e=e||{};const n={};function r(u,d,m,p){return O.isPlainObject(u)&&O.isPlainObject(d)?O.merge.call({caseless:p},u,d):O.isPlainObject(d)?O.merge({},d):O.isArray(d)?d.slice():d}function s(u,d,m,p){if(O.isUndefined(d)){if(!O.isUndefined(u))return r(void 0,u,m,p)}else return r(u,d,m,p)}function i(u,d){if(!O.isUndefined(d))return r(void 0,d)}function o(u,d){if(O.isUndefined(d)){if(!O.isUndefined(u))return r(void 0,u)}else return r(void 0,d)}function l(u,d,m){if(m in e)return r(u,d);if(m in t)return r(void 0,u)}const c={url:i,method:i,data:i,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:l,headers:(u,d,m)=>s(kb(u),kb(d),m,!0)};return O.forEach(Object.keys(Object.assign({},t,e)),function(d){const m=c[d]||s,p=m(t[d],e[d],d);O.isUndefined(p)&&m!==l||(n[d]=p)}),n}const nI=t=>{const e=Da({},t);let{data:n,withXSRFToken:r,xsrfHeaderName:s,xsrfCookieName:i,headers:o,auth:l}=e;e.headers=o=$r.from(o),e.url=XT(tI(e.baseURL,e.url),t.params,t.paramsSerializer),l&&o.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):"")));let c;if(O.isFormData(n)){if(rn.hasStandardBrowserEnv||rn.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((c=o.getContentType())!==!1){const[u,...d]=c?c.split(";").map(m=>m.trim()).filter(Boolean):[];o.setContentType([u||"multipart/form-data",...d].join("; "))}}if(rn.hasStandardBrowserEnv&&(r&&O.isFunction(r)&&(r=r(e)),r||r!==!1&&FF(e.url))){const u=s&&i&&DF.read(i);u&&o.set(s,u)}return e},OF=typeof XMLHttpRequest<"u",$F=OF&&function(t){return new Promise(function(n,r){const s=nI(t);let i=s.data;const o=$r.from(s.headers).normalize();let{responseType:l,onUploadProgress:c,onDownloadProgress:u}=s,d,m,p,g,y;function w(){g&&g(),y&&y(),s.cancelToken&&s.cancelToken.unsubscribe(d),s.signal&&s.signal.removeEventListener("abort",d)}let _=new XMLHttpRequest;_.open(s.method.toUpperCase(),s.url,!0),_.timeout=s.timeout;function E(){if(!_)return;const S=$r.from("getAllResponseHeaders"in _&&_.getAllResponseHeaders()),D={data:!l||l==="text"||l==="json"?_.responseText:_.response,status:_.status,statusText:_.statusText,headers:S,config:t,request:_};eI(function(I){n(I),w()},function(I){r(I),w()},D),_=null}"onloadend"in _?_.onloadend=E:_.onreadystatechange=function(){!_||_.readyState!==4||_.status===0&&!(_.responseURL&&_.responseURL.indexOf("file:")===0)||setTimeout(E)},_.onabort=function(){_&&(r(new pe("Request aborted",pe.ECONNABORTED,t,_)),_=null)},_.onerror=function(){r(new pe("Network Error",pe.ERR_NETWORK,t,_)),_=null},_.ontimeout=function(){let C=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const D=s.transitional||YT;s.timeoutErrorMessage&&(C=s.timeoutErrorMessage),r(new pe(C,D.clarifyTimeoutError?pe.ETIMEDOUT:pe.ECONNABORTED,t,_)),_=null},i===void 0&&o.setContentType(null),"setRequestHeader"in _&&O.forEach(o.toJSON(),function(C,D){_.setRequestHeader(D,C)}),O.isUndefined(s.withCredentials)||(_.withCredentials=!!s.withCredentials),l&&l!=="json"&&(_.responseType=s.responseType),u&&([p,y]=Zh(u,!0),_.addEventListener("progress",p)),c&&_.upload&&([m,g]=Zh(c),_.upload.addEventListener("progress",m),_.upload.addEventListener("loadend",g)),(s.cancelToken||s.signal)&&(d=S=>{_&&(r(!S||S.type?new pl(null,t,_):S),_.abort(),_=null)},s.cancelToken&&s.cancelToken.subscribe(d),s.signal&&(s.signal.aborted?d():s.signal.addEventListener("abort",d)));const b=AF(s.url);if(b&&rn.protocols.indexOf(b)===-1){r(new pe("Unsupported protocol "+b+":",pe.ERR_BAD_REQUEST,t));return}_.send(i||null)})},BF=(t,e)=>{const{length:n}=t=t?t.filter(Boolean):[];if(e||n){let r=new AbortController,s;const i=function(u){if(!s){s=!0,l();const d=u instanceof Error?u:this.reason;r.abort(d instanceof pe?d:new pl(d instanceof Error?d.message:d))}};let o=e&&setTimeout(()=>{o=null,i(new pe(`timeout ${e} of ms exceeded`,pe.ETIMEDOUT))},e);const l=()=>{t&&(o&&clearTimeout(o),o=null,t.forEach(u=>{u.unsubscribe?u.unsubscribe(i):u.removeEventListener("abort",i)}),t=null)};t.forEach(u=>u.addEventListener("abort",i));const{signal:c}=r;return c.unsubscribe=()=>O.asap(l),c}},zF=BF,UF=function*(t,e){let n=t.byteLength;if(!e||n<e){yield t;return}let r=0,s;for(;r<n;)s=r+e,yield t.slice(r,s),r=s},VF=async function*(t,e){for await(const n of HF(t))yield*UF(n,e)},HF=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const e=t.getReader();try{for(;;){const{done:n,value:r}=await e.read();if(n)break;yield r}}finally{await e.cancel()}},Tb=(t,e,n,r)=>{const s=VF(t,e);let i=0,o,l=c=>{o||(o=!0,r&&r(c))};return new ReadableStream({async pull(c){try{const{done:u,value:d}=await s.next();if(u){l(),c.close();return}let m=d.byteLength;if(n){let p=i+=m;n(p)}c.enqueue(new Uint8Array(d))}catch(u){throw l(u),u}},cancel(c){return l(c),s.return()}},{highWaterMark:2})},cm=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",rI=cm&&typeof ReadableStream=="function",WF=cm&&(typeof TextEncoder=="function"?(t=>e=>t.encode(e))(new TextEncoder):async t=>new Uint8Array(await new Response(t).arrayBuffer())),sI=(t,...e)=>{try{return!!t(...e)}catch{return!1}},qF=rI&&sI(()=>{let t=!1;const e=new Request(rn.origin,{body:new ReadableStream,method:"POST",get duplex(){return t=!0,"half"}}).headers.has("Content-Type");return t&&!e}),Ib=64*1024,O0=rI&&sI(()=>O.isReadableStream(new Response("").body)),ef={stream:O0&&(t=>t.body)};cm&&(t=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!ef[e]&&(ef[e]=O.isFunction(t[e])?n=>n[e]():(n,r)=>{throw new pe(`Response type '${e}' is not supported`,pe.ERR_NOT_SUPPORT,r)})})})(new Response);const GF=async t=>{if(t==null)return 0;if(O.isBlob(t))return t.size;if(O.isSpecCompliantForm(t))return(await new Request(rn.origin,{method:"POST",body:t}).arrayBuffer()).byteLength;if(O.isArrayBufferView(t)||O.isArrayBuffer(t))return t.byteLength;if(O.isURLSearchParams(t)&&(t=t+""),O.isString(t))return(await WF(t)).byteLength},QF=async(t,e)=>{const n=O.toFiniteNumber(t.getContentLength());return n??GF(e)},KF=cm&&(async t=>{let{url:e,method:n,data:r,signal:s,cancelToken:i,timeout:o,onDownloadProgress:l,onUploadProgress:c,responseType:u,headers:d,withCredentials:m="same-origin",fetchOptions:p}=nI(t);u=u?(u+"").toLowerCase():"text";let g=zF([s,i&&i.toAbortSignal()],o),y;const w=g&&g.unsubscribe&&(()=>{g.unsubscribe()});let _;try{if(c&&qF&&n!=="get"&&n!=="head"&&(_=await QF(d,r))!==0){let D=new Request(e,{method:"POST",body:r,duplex:"half"}),F;if(O.isFormData(r)&&(F=D.headers.get("content-type"))&&d.setContentType(F),D.body){const[I,k]=Sb(_,Zh(Eb(c)));r=Tb(D.body,Ib,I,k)}}O.isString(m)||(m=m?"include":"omit");const E="credentials"in Request.prototype;y=new Request(e,{...p,signal:g,method:n.toUpperCase(),headers:d.normalize().toJSON(),body:r,duplex:"half",credentials:E?m:void 0});let b=await fetch(y);const S=O0&&(u==="stream"||u==="response");if(O0&&(l||S&&w)){const D={};["status","statusText","headers"].forEach(R=>{D[R]=b[R]});const F=O.toFiniteNumber(b.headers.get("content-length")),[I,k]=l&&Sb(F,Zh(Eb(l),!0))||[];b=new Response(Tb(b.body,Ib,I,()=>{k&&k(),w&&w()}),D)}u=u||"text";let C=await ef[O.findKey(ef,u)||"text"](b,t);return!S&&w&&w(),await new Promise((D,F)=>{eI(D,F,{data:C,headers:$r.from(b.headers),status:b.status,statusText:b.statusText,config:t,request:y})})}catch(E){throw w&&w(),E&&E.name==="TypeError"&&/fetch/i.test(E.message)?Object.assign(new pe("Network Error",pe.ERR_NETWORK,t,y),{cause:E.cause||E}):pe.from(E,E&&E.code,t,y)}}),$0={http:lF,xhr:$F,fetch:KF};O.forEach($0,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch{}Object.defineProperty(t,"adapterName",{value:e})}});const Cb=t=>`- ${t}`,XF=t=>O.isFunction(t)||t===null||t===!1,iI={getAdapter:t=>{t=O.isArray(t)?t:[t];const{length:e}=t;let n,r;const s={};for(let i=0;i<e;i++){n=t[i];let o;if(r=n,!XF(n)&&(r=$0[(o=String(n)).toLowerCase()],r===void 0))throw new pe(`Unknown adapter '${o}'`);if(r)break;s[o||"#"+i]=r}if(!r){const i=Object.entries(s).map(([l,c])=>`adapter ${l} `+(c===!1?"is not supported by the environment":"is not available in the build"));let o=e?i.length>1?`since :
`+i.map(Cb).join(`
`):" "+Cb(i[0]):"as no adapter specified";throw new pe("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return r},adapters:$0};function Xp(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new pl(null,t)}function jb(t){return Xp(t),t.headers=$r.from(t.headers),t.data=Kp.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),iI.getAdapter(t.adapter||Vy.adapter)(t).then(function(r){return Xp(t),r.data=Kp.call(t,t.transformResponse,r),r.headers=$r.from(r.headers),r},function(r){return ZT(r)||(Xp(t),r&&r.response&&(r.response.data=Kp.call(t,t.transformResponse,r.response),r.response.headers=$r.from(r.response.headers))),Promise.reject(r)})}const aI="1.8.1",um={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{um[t]=function(r){return typeof r===t||"a"+(e<1?"n ":" ")+t}});const Rb={};um.transitional=function(e,n,r){function s(i,o){return"[Axios v"+aI+"] Transitional option '"+i+"'"+o+(r?". "+r:"")}return(i,o,l)=>{if(e===!1)throw new pe(s(o," has been removed"+(n?" in "+n:"")),pe.ERR_DEPRECATED);return n&&!Rb[o]&&(Rb[o]=!0,console.warn(s(o," has been deprecated since v"+n+" and will be removed in the near future"))),e?e(i,o,l):!0}};um.spelling=function(e){return(n,r)=>(console.warn(`${r} is likely a misspelling of ${e}`),!0)};function YF(t,e,n){if(typeof t!="object")throw new pe("options must be an object",pe.ERR_BAD_OPTION_VALUE);const r=Object.keys(t);let s=r.length;for(;s-- >0;){const i=r[s],o=e[i];if(o){const l=t[i],c=l===void 0||o(l,i,t);if(c!==!0)throw new pe("option "+i+" must be "+c,pe.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new pe("Unknown option "+i,pe.ERR_BAD_OPTION)}}const hh={assertOptions:YF,validators:um},Kr=hh.validators;class tf{constructor(e){this.defaults=e,this.interceptors={request:new _b,response:new _b}}async request(e,n){try{return await this._request(e,n)}catch(r){if(r instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const i=s.stack?s.stack.replace(/^.+\n/,""):"";try{r.stack?i&&!String(r.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+i):r.stack=i}catch{}}throw r}}_request(e,n){typeof e=="string"?(n=n||{},n.url=e):n=e||{},n=Da(this.defaults,n);const{transitional:r,paramsSerializer:s,headers:i}=n;r!==void 0&&hh.assertOptions(r,{silentJSONParsing:Kr.transitional(Kr.boolean),forcedJSONParsing:Kr.transitional(Kr.boolean),clarifyTimeoutError:Kr.transitional(Kr.boolean)},!1),s!=null&&(O.isFunction(s)?n.paramsSerializer={serialize:s}:hh.assertOptions(s,{encode:Kr.function,serialize:Kr.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),hh.assertOptions(n,{baseUrl:Kr.spelling("baseURL"),withXsrfToken:Kr.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let o=i&&O.merge(i.common,i[n.method]);i&&O.forEach(["delete","get","head","post","put","patch","common"],y=>{delete i[y]}),n.headers=$r.concat(o,i);const l=[];let c=!0;this.interceptors.request.forEach(function(w){typeof w.runWhen=="function"&&w.runWhen(n)===!1||(c=c&&w.synchronous,l.unshift(w.fulfilled,w.rejected))});const u=[];this.interceptors.response.forEach(function(w){u.push(w.fulfilled,w.rejected)});let d,m=0,p;if(!c){const y=[jb.bind(this),void 0];for(y.unshift.apply(y,l),y.push.apply(y,u),p=y.length,d=Promise.resolve(n);m<p;)d=d.then(y[m++],y[m++]);return d}p=l.length;let g=n;for(m=0;m<p;){const y=l[m++],w=l[m++];try{g=y(g)}catch(_){w.call(this,_);break}}try{d=jb.call(this,g)}catch(y){return Promise.reject(y)}for(m=0,p=u.length;m<p;)d=d.then(u[m++],u[m++]);return d}getUri(e){e=Da(this.defaults,e);const n=tI(e.baseURL,e.url,e.allowAbsoluteUrls);return XT(n,e.params,e.paramsSerializer)}}O.forEach(["delete","get","head","options"],function(e){tf.prototype[e]=function(n,r){return this.request(Da(r||{},{method:e,url:n,data:(r||{}).data}))}});O.forEach(["post","put","patch"],function(e){function n(r){return function(i,o,l){return this.request(Da(l||{},{method:e,headers:r?{"Content-Type":"multipart/form-data"}:{},url:i,data:o}))}}tf.prototype[e]=n(),tf.prototype[e+"Form"]=n(!0)});const fh=tf;class Hy{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(i){n=i});const r=this;this.promise.then(s=>{if(!r._listeners)return;let i=r._listeners.length;for(;i-- >0;)r._listeners[i](s);r._listeners=null}),this.promise.then=s=>{let i;const o=new Promise(l=>{r.subscribe(l),i=l}).then(s);return o.cancel=function(){r.unsubscribe(i)},o},e(function(i,o,l){r.reason||(r.reason=new pl(i,o,l),n(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const n=this._listeners.indexOf(e);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const e=new AbortController,n=r=>{e.abort(r)};return this.subscribe(n),e.signal.unsubscribe=()=>this.unsubscribe(n),e.signal}static source(){let e;return{token:new Hy(function(s){e=s}),cancel:e}}}const JF=Hy;function ZF(t){return function(n){return t.apply(null,n)}}function e6(t){return O.isObject(t)&&t.isAxiosError===!0}const B0={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(B0).forEach(([t,e])=>{B0[e]=t});const t6=B0;function oI(t){const e=new fh(t),n=$T(fh.prototype.request,e);return O.extend(n,fh.prototype,e,{allOwnKeys:!0}),O.extend(n,e,null,{allOwnKeys:!0}),n.create=function(s){return oI(Da(t,s))},n}const bt=oI(Vy);bt.Axios=fh;bt.CanceledError=pl;bt.CancelToken=JF;bt.isCancel=ZT;bt.VERSION=aI;bt.toFormData=om;bt.AxiosError=pe;bt.Cancel=bt.CanceledError;bt.all=function(e){return Promise.all(e)};bt.spread=ZF;bt.isAxiosError=e6;bt.mergeConfig=Da;bt.AxiosHeaders=$r;bt.formToJSON=t=>JT(O.isHTMLForm(t)?new FormData(t):t);bt.getAdapter=iI.getAdapter;bt.HttpStatusCode=t6;bt.default=bt;const n6=bt,lI="HD-MP3",cI=n6.create({baseURL:{}.VITE_ENDPOINT||"https://express-zingmp3-awx6.vercel.app"}),mn=()=>JSON.parse(localStorage.getItem(lI)||"{}"),nt=(t,e)=>{const n=mn();return n[t]=e,localStorage.setItem(lI,JSON.stringify(n))},zs=t=>{const e=Math.floor(t/60),n=Math.round(t%60);return`${e}:${n.toString().padStart(2,"0")}`},Us=async t=>new Promise(e=>setTimeout(e,t)),uI=(t,e)=>{t.scrollIntoView({behavior:e||"smooth",block:"center"})},Yc=t=>t?"disable":"",Jc=t=>t?"hidden":"",Li=(t,e)=>t?e:"";let mh=Jh[3];const r6=mn(),Ab=r6.theme;Ab&&[...Jh,...OT].forEach(t=>{t.id===Ab&&(mh=t)});const s6={theme:{...mh,alpha:mh.type==="light"?"[#000]/5":"[#fff]/5",text_color:mh.type==="light"?"text-[#333]":"text-[#fff]"},isOnMobile:window.innerWidth<768,isDev:!1},i6=(t,e)=>{switch(e.type){case 0:{const n=e.payload.theme;return{...t,theme:{...n,alpha:n.type==="dark"?"[#fff]/5":"[#000]/5",text_color:n.type==="light"?"text-[#333]":"text-[#fff]"}}}}},a6=()=>{const[t,e]=f.useReducer(i6,s6),n=f.useCallback(s=>{console.log("set theme"),e({type:0,payload:{theme:s}})},[]);return{state:t,setTheme:n,themeClass:(s,i)=>t.theme.type==="light"?s:i}},dI=f.createContext(null),o6=({children:t})=>a.jsx(dI.Provider,{value:a6(),children:t}),q=()=>{const t=f.useContext(dI);if(!t)throw new Error("ThemeProvider not provided");const{state:e,...n}=t;return{...e,...n}},l6=()=>{const[t,e]=f.useState([]);return{toasts:t,setErrorToast:s=>e(i=>[...i,{variant:"error",id:Date.now()+"",desc:s||"Somethings went wrong"}]),setSuccessToast:s=>e(i=>[...i,{variant:"success",id:Date.now()+"",desc:s||"Successful"}]),setToasts:e}},hI=f.createContext(null);function c6({children:t}){return a.jsx(hI.Provider,{value:l6(),children:t})}const fe=()=>{const t=f.useContext(hI);if(!t)throw new Error("Toast Context not provided");return t},u6=()=>{const[t,e]=f.useState([]),[n,r]=f.useState([]),s=f.useRef(!0);return{ahead:t,behind:n,setAhead:e,setBehind:r,shouldStoreLocation:s}},fI=f.createContext(null),mI=()=>{const t=f.useContext(fI);if(!t)throw new Error("Navigation context not provided");return t};function pI(){const{ahead:t,setAhead:e,setBehind:n,shouldStoreLocation:r}=mI(),s=rr(),i=f.useMemo(()=>s.pathname+s.search,[s]),o=f.useRef(!1);return f.useEffect(()=>{if(!o.current){o.current=!0;return}return()=>{r.current?(t.length&&e([]),n(l=>[...l,i])):r.current=!0}},[s.pathname]),a.jsx(a.Fragment,{})}function gI({children:t}){return a.jsx(fI.Provider,{value:u6(),children:t})}function d6(){const[t,e]=f.useState([]),[n,r]=f.useState(!1);return{uploadingSongs:t,setUploadingSongs:e,isUploading:n,setIsUploading:r,resetUploadContext:()=>{r(!1),e([])}}}const xI=f.createContext(null),h6=({children:t})=>a.jsx(xI.Provider,{value:d6(),children:t}),yI=()=>{const t=f.useContext(xI);if(!t)throw new Error("UploadSongProvider not provided");return t},f6=["Songs","Karaoke","Lyric"],m6=["Playing","Lyric"],tc=mn();function p6(){const[t,e]=f.useState(!1),[n,r]=f.useState(!1),[s,i]=f.useState("Lyric"),[o,l]=f.useState("Lyric"),[c,u]=f.useState(!1),[d,m]=f.useState({lyricSize:tc.lyricSize||"medium",repeat:tc.isRepeat||"no",isShuffle:tc.isShuffle||!1,isCrossFade:tc.isCrossFade||!1,songBackground:tc.songBackground||!0,isEnableBeat:!1}),p=f.useRef(!0),g=f.useRef(0),y=f.useRef(!0),w=f.useRef(""),_=f.useRef(!1),E=f.useRef(null),b=f.useRef(null),S=f.useRef(null);return{audioRef:E,themeCodeRef:w,isOpenFullScreen:t,isOpenSongQueue:n,idle:c,setIdle:u,setIsOpenFullScreen:e,setIsOpenSongQueue:r,activeTab:s,setActiveTab:i,desktopTabs:f6,mobileActiveTab:o,setMobileActiveTab:l,mobileTabs:m6,playerConig:d,updatePlayerConfig:D=>{m(F=>({...F,...D}))},firstTimeSongLoaded:p,timelineEleRef:b,currentTimeEleRef:S,startFadeWhenEnd:g,isPlayingNewSong:y,shouldSyncSongDuration:_}}const vI=f.createContext(null);function g6({children:t}){return a.jsx(vI.Provider,{value:p6(),children:t})}function ct(){const t=f.useContext(vI);if(!t)throw new Error("Player Context not provided");return t}const x6=()=>{const[t,e]=f.useState([]),[n,r]=f.useState(!1),s=f.useRef(!0);return{songLyrics:t,setSongLyrics:e,loading:n,setLoading:r,shouldGetLyric:s}},wI=f.createContext(null);function _I({children:t}){return a.jsx(wI.Provider,{value:x6(),children:t})}const bI=()=>{const t=f.useContext(wI);if(!t)throw new Error("Lyric context not found");return t},y6=()=>{const[t,e]=f.useState(!1),[n,r]=f.useState(!1),[s,i]=f.useState([]);return{isChecked:t,setIsChecked:e,isSelectAll:n,setIsSelectAll:r,setSelectedSongs:i,selectedSongs:s,selectAllSong:u=>{e(!0),r(!0),i(u)},selectSong:u=>{const d=[...s],m=d.findIndex(p=>p.id===u.id);m===-1?d.push(u):d.splice(m,1),e(!!d.length),i(d)},resetSelect:()=>{e(!1),r(!1),i([])}}},SI=f.createContext(null);function ps({children:t}){return a.jsx(SI.Provider,{value:y6(),children:t})}const Eu=()=>{const t=f.useContext(SI);if(!t)throw new Error("SelectSongContext not provided");return t};function EI(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t))for(e=0;e<t.length;e++)t[e]&&(n=EI(t[e]))&&(r&&(r+=" "),r+=n);else for(e in t)t[e]&&(r&&(r+=" "),r+=e);return r}function v6(){for(var t,e,n=0,r="";n<arguments.length;)(t=arguments[n++])&&(e=EI(t))&&(r&&(r+=" "),r+=e);return r}const Nb=t=>typeof t=="boolean"?"".concat(t):t===0?"0":t,Pb=v6,ku=(t,e)=>n=>{var r;if((e==null?void 0:e.variants)==null)return Pb(t,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:s,defaultVariants:i}=e,o=Object.keys(s).map(u=>{const d=n==null?void 0:n[u],m=i==null?void 0:i[u];if(d===null)return null;const p=Nb(d)||Nb(m);return s[u][p]}),l=n&&Object.entries(n).reduce((u,d)=>{let[m,p]=d;return p===void 0||(u[m]=p),u},{}),c=e==null||(r=e.compoundVariants)===null||r===void 0?void 0:r.reduce((u,d)=>{let{class:m,className:p,...g}=d;return Object.entries(g).every(y=>{let[w,_]=y;return Array.isArray(_)?_.includes({...i,...l}[w]):{...i,...l}[w]===_})?[...u,m,p]:u},[]);return Pb(t,o,c,n==null?void 0:n.class,n==null?void 0:n.className)};function w6({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 6h9.75M10.5 6a1.5 1.5 0 11-3 0m3 0a1.5 1.5 0 10-3 0M3.75 6H7.5m3 12h9.75m-9.75 0a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0m-3.75 0H7.5m9-6h3.75m-3.75 0a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0m-9.75 0h9.75"}))}const _6=f.forwardRef(w6),Tu=_6;function b6({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3"}))}const S6=f.forwardRef(b6),dm=S6;function E6({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6a2.25 2.25 0 00-2.25 2.25v13.5A2.25 2.25 0 007.5 21h6a2.25 2.25 0 002.25-2.25V15M12 9l-3 3m0 0l3 3m-3-3h12.75"}))}const k6=f.forwardRef(E6),T6=k6;function I6({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18"}))}const C6=f.forwardRef(I6),kI=C6;function j6({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 12c0-1.232-.046-2.453-.138-3.662a4.006 4.006 0 00-3.7-3.7 48.678 48.678 0 00-7.324 0 4.006 4.006 0 00-3.7 3.7c-.017.22-.032.441-.046.662M19.5 12l3-3m-3 3l-3-3m-12 3c0 1.232.046 2.453.138 3.662a4.006 4.006 0 003.7 3.7 48.656 48.656 0 007.324 0 4.006 4.006 0 003.7-3.7c.017-.22.032-.441.046-.662M4.5 12l3 3m-3-3l-3 3"}))}const R6=f.forwardRef(j6),TI=R6;function A6({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99"}))}const N6=f.forwardRef(A6),He=N6;function P6({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6a2.25 2.25 0 00-2.25 2.25v13.5A2.25 2.25 0 007.5 21h6a2.25 2.25 0 002.25-2.25V15m3 0l3-3m0 0l-3-3m3 3H9"}))}const F6=f.forwardRef(P6),Wy=F6;function D6({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 4.5L21 12m0 0l-7.5 7.5M21 12H3"}))}const L6=f.forwardRef(D6),M6=L6;function O6({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 6H5.25A2.25 2.25 0 003 8.25v10.5A2.25 2.25 0 005.25 21h10.5A2.25 2.25 0 0018 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"}))}const $6=f.forwardRef(O6),B6=$6;function z6({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 18L9 11.25l4.306 4.307a11.95 11.95 0 015.814-5.519l2.74-1.22m0 0l-5.94-2.28m5.94 2.28l-2.28 5.941"}))}const U6=f.forwardRef(z6),II=U6;function V6({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5m-13.5-9L12 3m0 0l4.5 4.5M12 3v13.5"}))}const H6=f.forwardRef(V6),qy=H6;function W6({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 16.811c0 .864-.933 1.405-1.683.977l-7.108-4.062a1.125 1.125 0 010-1.953l7.108-4.062A1.125 1.125 0 0121 8.688v8.123zM11.25 16.811c0 .864-.933 1.405-1.683.977l-7.108-4.062a1.125 1.125 0 010-1.953L9.567 7.71a1.125 1.125 0 011.683.977v8.123z"}))}const q6=f.forwardRef(W6),Gy=q6;function G6({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"}))}const Q6=f.forwardRef(G6),gl=Q6;function K6({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 12.76c0 1.6 1.123 2.994 2.707 3.227 1.068.157 2.148.279 3.238.364.466.037.893.281 1.153.671L12 21l2.652-3.978c.26-.39.687-.634 1.153-.67 1.09-.086 2.17-.208 3.238-.365 1.584-.233 2.707-1.626 2.707-3.228V6.741c0-1.602-1.123-2.995-2.707-3.228A48.394 48.394 0 0012 3c-2.392 0-4.744.175-7.043.513C3.373 3.746 2.25 5.14 2.25 6.741v6.018z"}))}const X6=f.forwardRef(K6),Y6=X6;function J6({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20.25 8.511c.884.284 1.5 1.128 1.5 2.097v4.286c0 1.136-.847 2.1-1.98 2.193-.34.027-.68.052-1.02.072v3.091l-3-3c-1.354 0-2.694-.055-4.02-.163a2.115 2.115 0 01-.825-.242m9.345-8.334a2.126 2.126 0 00-.476-.095 48.64 48.64 0 00-8.048 0c-1.131.094-1.976 1.057-1.976 2.192v4.286c0 .837.46 1.58 1.155 1.951m9.345-8.334V6.637c0-1.621-1.152-3.026-2.76-3.235A48.455 48.455 0 0011.25 3c-2.115 0-4.198.137-6.24.402-1.608.209-2.76 1.614-2.76 3.235v6.226c0 1.621 1.152 3.026 2.76 3.235.577.075 1.157.14 1.74.194V21l4.155-4.155"}))}const Z6=f.forwardRef(J6),Qy=Z6;function eD({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}))}const tD=f.forwardRef(eD),nD=tD;function rD({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 12.75l6 6 9-13.5"}))}const sD=f.forwardRef(rD),Iu=sD;function iD({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 8.25l-7.5 7.5-7.5-7.5"}))}const aD=f.forwardRef(iD),CI=aD;function oD({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5L8.25 12l7.5-7.5"}))}const lD=f.forwardRef(oD),jI=lD;function cD({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 4.5l7.5 7.5-7.5 7.5"}))}const uD=f.forwardRef(cD),ph=uD;function dD({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 15.75l7.5-7.5 7.5 7.5"}))}const hD=f.forwardRef(dD),fD=hD;function mD({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 7.5V6.108c0-1.135.845-2.098 1.976-2.192.373-.03.748-.057 1.123-.08M15.75 18H18a2.25 2.25 0 002.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 00-1.123-.08M15.75 18.75v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5A3.375 3.375 0 006.375 7.5H5.25m11.9-3.664A2.251 2.251 0 0015 2.25h-1.5a2.251 2.251 0 00-2.15 1.586m5.8 0c.065.21.1.433.1.664v.75h-6V4.5c0-.231.035-.454.1-.664M6.75 7.5H4.875c-.621 0-1.125.504-1.125 1.125v12c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V16.5a9 9 0 00-9-9z"}))}const pD=f.forwardRef(mD),gD=pD;function xD({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z"}))}const yD=f.forwardRef(xD),Ky=yD;function vD({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.324.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 011.37.49l1.296 2.247a1.125 1.125 0 01-.26 1.431l-1.003.827c-.293.24-.438.613-.431.992a6.759 6.759 0 010 .255c-.007.378.138.75.43.99l1.005.828c.424.35.534.954.26 1.43l-1.298 2.247a1.125 1.125 0 01-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.57 6.57 0 01-.22.128c-.331.183-.581.495-.644.869l-.213 1.28c-.09.543-.56.941-1.11.941h-2.594c-.55 0-1.02-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 01-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 01-1.369-.49l-1.297-2.247a1.125 1.125 0 01.26-1.431l1.004-.827c.292-.24.437-.613.43-.992a6.932 6.932 0 010-.255c.007-.378-.138-.75-.43-.99l-1.004-.828a1.125 1.125 0 01-.26-1.43l1.297-2.247a1.125 1.125 0 011.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.087.22-.128.332-.183.582-.495.644-.869l.214-1.281z"}),f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}))}const wD=f.forwardRef(vD),Xy=wD;function _D({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 17.25v1.007a3 3 0 01-.879 2.122L7.5 21h9l-.621-.621A3 3 0 0115 18.257V17.25m6-12V15a2.25 2.25 0 01-2.25 2.25H5.25A2.25 2.25 0 013 15V5.25m18 0A2.25 2.25 0 0018.75 3H5.25A2.25 2.25 0 003 5.25m18 0V12a2.25 2.25 0 01-2.25 2.25H5.25A2.25 2.25 0 013 12V5.25"}))}const bD=f.forwardRef(_D),Yy=bD;function SD({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z"}))}const ED=f.forwardRef(SD),Jy=ED;function kD({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m9-.75a9 9 0 11-18 0 9 9 0 0118 0zm-9 3.75h.008v.008H12v-.008z"}))}const TD=f.forwardRef(kD),hm=TD;function ID({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z"}),f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}))}const CD=f.forwardRef(ID),jD=CD;function RD({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.375 19.5h17.25m-17.25 0a1.125 1.125 0 01-1.125-1.125M3.375 19.5h1.5C5.496 19.5 6 18.996 6 18.375m-3.75 0V5.625m0 12.75v-1.5c0-.621.504-1.125 1.125-1.125m18.375 2.625V5.625m0 12.75c0 .621-.504 1.125-1.125 1.125m1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125m0 3.75h-1.5A1.125 1.125 0 0118 18.375M20.625 4.5H3.375m17.25 0c.621 0 1.125.504 1.125 1.125M20.625 4.5h-1.5C18.504 4.5 18 5.004 18 5.625m3.75 0v1.5c0 .621-.504 1.125-1.125 1.125M3.375 4.5c-.621 0-1.125.504-1.125 1.125M3.375 4.5h1.5C5.496 4.5 6 5.004 6 5.625m-3.75 0v1.5c0 .621.504 1.125 1.125 1.125m0 0h1.5m-1.5 0c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125m1.5-3.75C5.496 8.25 6 7.746 6 7.125v-1.5M4.875 8.25C5.496 8.25 6 8.754 6 9.375v1.5m0-5.25v5.25m0-5.25C6 5.004 6.504 4.5 7.125 4.5h9.75c.621 0 1.125.504 1.125 1.125m1.125 2.625h1.5m-1.5 0A1.125 1.125 0 0118 7.125v-1.5m1.125 2.625c-.621 0-1.125.504-1.125 1.125v1.5m2.625-2.625c.621 0 1.125.504 1.125 1.125v1.5c0 .621-.504 1.125-1.125 1.125M18 5.625v5.25M7.125 12h9.75m-9.75 0A1.125 1.125 0 016 10.875M7.125 12C6.504 12 6 12.504 6 13.125m0-2.25C6 11.496 5.496 12 4.875 12M18 10.875c0 .621-.504 1.125-1.125 1.125M18 10.875c0 .621.504 1.125 1.125 1.125m-2.25 0c.621 0 1.125.504 1.125 1.125m-12 5.25v-5.25m0 5.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125m-12 0v-1.5c0-.621-.504-1.125-1.125-1.125M18 18.375v-5.25m0 5.25v-1.5c0-.621.504-1.125 1.125-1.125M18 13.125v1.5c0 .621.504 1.125 1.125 1.125M18 13.125c0-.621.504-1.125 1.125-1.125M6 13.125v1.5c0 .621-.504 1.125-1.125 1.125M6 13.125C6 12.504 5.496 12 4.875 12m-1.5 0h1.5m-1.5 0c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125M19.125 12h1.5m0 0c.621 0 1.125.504 1.125 1.125v1.5c0 .621-.504 1.125-1.125 1.125m-17.25 0h1.5m14.25 0h1.5"}))}const AD=f.forwardRef(RD),ND=AD;function PD({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 8.688c0-.864.933-1.405 1.683-.977l7.108 4.062a1.125 1.125 0 010 1.953l-7.108 4.062A1.125 1.125 0 013 16.81V8.688zM12.75 8.688c0-.864.933-1.405 1.683-.977l7.108 4.062a1.125 1.125 0 010 1.953l-7.108 4.062a1.125 1.125 0 01-1.683-.977V8.688z"}))}const FD=f.forwardRef(PD),Zy=FD;function DD({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12.75 3.03v.568c0 .334.148.65.405.864l1.068.89c.442.369.535 1.01.216 1.49l-.51.766a2.25 2.25 0 01-1.161.886l-.143.048a1.107 1.107 0 00-.57 1.664c.369.555.169 1.307-.427 1.605L9 13.125l.423 1.059a.956.956 0 01-1.652.928l-.679-.906a1.125 1.125 0 00-1.906.172L4.5 15.75l-.612.153M12.75 3.031a9 9 0 00-8.862 12.872M12.75 3.031a9 9 0 016.69 14.036m0 0l-.177-.529A2.25 2.25 0 0017.128 15H16.5l-.324-.324a1.453 1.453 0 00-2.328.377l-.036.073a1.586 1.586 0 01-.982.816l-.99.282c-.55.157-.894.702-.8 1.267l.073.438c.08.474.49.821.97.821.846 0 1.598.542 1.865 1.345l.215.643m5.276-3.67a9.012 9.012 0 01-5.276 3.67m0 0a9 9 0 01-10.275-4.835M15.75 9c0 .896-.393 1.7-1.016 2.25"}))}const LD=f.forwardRef(DD),MD=LD;function OD({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12z"}))}const $D=f.forwardRef(OD),Za=$D;function BD({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 12l8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25"}))}const zD=f.forwardRef(BD),fm=zD;function UD({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z"}))}const VD=f.forwardRef(UD),z0=VD;function HD({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.19 8.688a4.5 4.5 0 011.242 7.244l-4.5 4.5a4.5 4.5 0 01-6.364-6.364l1.757-1.757m13.35-.622l1.757-1.757a4.5 4.5 0 00-6.364-6.364l-4.5 4.5a4.5 4.5 0 001.242 7.244"}))}const WD=f.forwardRef(HD),qD=WD;function GD({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"}))}const QD=f.forwardRef(GD),ev=QD;function KD({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 12h-15"}))}const XD=f.forwardRef(KD),tv=XD;function YD({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 9l10.5-3m0 6.553v3.75a2.25 2.25 0 01-1.632 2.163l-1.32.377a1.803 1.803 0 11-.99-3.467l2.31-.66a2.25 2.25 0 001.632-2.163zm0 0V2.25L9 5.25v10.303m0 0v3.75a2.25 2.25 0 01-1.632 2.163l-1.32.377a1.803 1.803 0 01-.99-3.467l2.31-.66A2.25 2.25 0 009 15.553z"}))}const JD=f.forwardRef(YD),Yi=JD;function ZD({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 7.5h1.5m-1.5 3h1.5m-7.5 3h7.5m-7.5 3h7.5m3-9h3.375c.621 0 1.125.504 1.125 1.125V18a2.25 2.25 0 01-2.25 2.25M16.5 7.5V18a2.25 2.25 0 002.25 2.25M16.5 7.5V4.875c0-.621-.504-1.125-1.125-1.125H4.125C3.504 3.75 3 4.254 3 4.875V18a2.25 2.25 0 002.25 2.25h13.5M6 7.5h3v3H6v-3z"}))}const eL=f.forwardRef(ZD),tL=eL;function nL({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.53 16.122a3 3 0 00-5.78 1.128 2.25 2.25 0 01-2.4 2.245 4.5 4.5 0 008.4-2.245c0-.399-.078-.78-.22-1.128zm0 0a15.998 15.998 0 003.388-1.62m-5.043-.025a15.994 15.994 0 011.622-3.395m3.42 3.42a15.995 15.995 0 004.764-4.648l3.876-5.814a1.151 1.151 0 00-1.597-1.597L14.146 6.32a15.996 15.996 0 00-4.649 4.763m3.42 3.42a6.776 6.776 0 00-3.42-3.42"}))}const rL=f.forwardRef(nL),U0=rL;function sL({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 12L3.269 3.126A59.768 59.768 0 0121.485 12 59.77 59.77 0 013.27 20.876L5.999 12zm0 0h7.5"}))}const iL=f.forwardRef(sL),aL=iL;function oL({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.25 9v6m-4.5 0V9M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}))}const lL=f.forwardRef(oL),nv=lL;function cL({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 5.25v13.5m-7.5-13.5v13.5"}))}const uL=f.forwardRef(cL),mm=uL;function dL({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125"}))}const hL=f.forwardRef(dL),Js=hL;function fL({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 15.75l5.159-5.159a2.25 2.25 0 013.182 0l5.159 5.159m-1.5-1.5l1.409-1.409a2.25 2.25 0 013.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 001.5-1.5V6a1.5 1.5 0 00-1.5-1.5H3.75A1.5 1.5 0 002.25 6v12a1.5 1.5 0 001.5 1.5zm10.5-11.25h.008v.008h-.008V8.25zm.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0z"}))}const mL=f.forwardRef(fL),xl=mL;function pL({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}),f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.91 11.672a.375.375 0 010 .656l-5.603 3.113a.375.375 0 01-.557-.328V8.887c0-.286.307-.466.557-.327l5.603 3.112z"}))}const gL=f.forwardRef(pL),RI=gL;function xL({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 5.653c0-.856.917-1.398 1.667-.986l11.54 6.348a1.125 1.125 0 010 1.971l-11.54 6.347a1.125 1.125 0 01-1.667-.985V5.653z"}))}const yL=f.forwardRef(xL),Zc=yL;function vL({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"}))}const wL=f.forwardRef(vL),br=wL;function _L({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442-.745.361-1.45.999-1.45 1.827v.75M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9 5.25h.008v.008H12v-.008z"}))}const bL=f.forwardRef(_L),AI=bL;function SL({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 12h16.5m-16.5 3.75h16.5M3.75 19.5h16.5M5.625 4.5h12.75a1.875 1.875 0 010 3.75H5.625a1.875 1.875 0 010-3.75z"}))}const EL=f.forwardRef(SL),kL=EL;function TL({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 7.125C2.25 6.504 2.754 6 3.375 6h6c.621 0 1.125.504 1.125 1.125v3.75c0 .621-.504 1.125-1.125 1.125h-6a1.125 1.125 0 01-1.125-1.125v-3.75zM14.25 8.625c0-.621.504-1.125 1.125-1.125h5.25c.621 0 1.125.504 1.125 1.125v8.25c0 .621-.504 1.125-1.125 1.125h-5.25a1.125 1.125 0 01-1.125-1.125v-8.25zM3.75 16.125c0-.621.504-1.125 1.125-1.125h5.25c.621 0 1.125.504 1.125 1.125v2.25c0 .621-.504 1.125-1.125 1.125h-5.25a1.125 1.125 0 01-1.125-1.125v-2.25z"}))}const IL=f.forwardRef(TL),CL=IL;function jL({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7.848 8.25l1.536.887M7.848 8.25a3 3 0 11-5.196-3 3 3 0 015.196 3zm1.536.887a2.165 2.165 0 011.083 1.839c.005.351.054.695.14 1.024M9.384 9.137l2.077 1.199M7.848 15.75l1.536-.887m-1.536.887a3 3 0 11-5.196 3 3 3 0 015.196-3zm1.536-.887a2.165 2.165 0 001.083-1.838c.005-.352.054-.695.14-1.025m-1.223 2.863l2.077-1.199m0-3.328a4.323 4.323 0 012.068-1.379l5.325-1.628a4.5 4.5 0 012.48-.044l.803.215-7.794 4.5m-2.882-1.664A4.331 4.331 0 0010.607 12m3.736 0l7.794 4.5-.802.215a4.5 4.5 0 01-2.48-.043l-5.326-1.629a4.324 4.324 0 01-2.068-1.379M14.343 12l-2.882 1.664"}))}const RL=f.forwardRef(jL),NI=RL;function AL({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.114 5.636a9 9 0 010 12.728M16.463 8.288a5.25 5.25 0 010 7.424M6.75 8.25l4.72-4.72a.75.75 0 011.28.53v15.88a.75.75 0 01-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.01 9.01 0 012.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75z"}))}const NL=f.forwardRef(AL),PL=NL;function FL({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17.25 9.75L19.5 12m0 0l2.25 2.25M19.5 12l2.25-2.25M19.5 12l-2.25 2.25m-10.5-6l4.72-4.72a.75.75 0 011.28.531V19.94a.75.75 0 01-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.506-1.938-1.354A9.01 9.01 0 012.25 12c0-.83.112-1.633.322-2.395C2.806 8.757 3.63 8.25 4.51 8.25H6.75z"}))}const DL=f.forwardRef(FL),LL=DL;function ML({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 7.5A2.25 2.25 0 017.5 5.25h9a2.25 2.25 0 012.25 2.25v9a2.25 2.25 0 01-2.25 2.25h-9a2.25 2.25 0 01-2.25-2.25v-9z"}))}const OL=f.forwardRef(ML),PI=OL;function $L({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"}))}const BL=f.forwardRef($L),Fn=BL;function zL({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z"}))}const UL=f.forwardRef(zL),VL=UL;function HL({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"}))}const WL=f.forwardRef(HL),Zs=WL,qL=ku("inline-flex space-x-1 font-[500] items-center ",{variants:{variant:{default:"",circle:"rounded-full",list:"flex items-center py-[5px] w-full",outline:"border rounded-full",primary:""},color:{primary:"primary",clear:""},size:{primary:"px-4 py-1.5",small:"px-2 py-1",half:"w-1/2",full:"w-full",clear:""},rounded:{full:"rounded-full",md:"rounded-md",clear:""},hover:{default:"hover:brightness-90",scale:"transition-transform hover:scale-[1.05]",clear:""}},defaultVariants:{variant:"default",size:"primary",hover:"default",rounded:"full",color:"clear"}});function GL({className:t,children:e,variant:n,size:r,disabled:s,isLoading:i,rounded:o,color:l,hover:c,onClick:u,...d},m){const{theme:p}=q();return a.jsxs("button",{ref:m,type:"button",onClick:g=>u?u(g):"",...d,className:`${l==="primary"?p.content_bg:""}  ${qL({variant:n,size:r,hover:c,rounded:o,className:t})}`,disabled:i||s,children:[i?a.jsx(He,{className:"w-6 animate-spin"}):null,!i&&e]})}const ie=f.forwardRef(GL);function QL({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{fillRule:"evenodd",d:"M15.312 11.424a5.5 5.5 0 01-9.201 2.466l-.312-.311h2.433a.75.75 0 000-1.5H3.989a.75.75 0 00-.75.75v4.242a.75.75 0 001.5 0v-2.43l.31.31a7 7 0 0011.712-3.138.75.75 0 00-1.449-.39zm1.23-3.723a.75.75 0 00.219-.53V2.929a.75.75 0 00-1.5 0V5.36l-.31-.31A7 7 0 003.239 8.188a.75.75 0 101.448.389A5.5 5.5 0 0113.89 6.11l.311.31h-2.432a.75.75 0 000 1.5h4.243a.75.75 0 00.53-.219z",clipRule:"evenodd"}))}const KL=f.forwardRef(QL),XL=KL;function YL({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{fillRule:"evenodd",d:"M10 17a.75.75 0 01-.75-.75V5.612L5.29 9.77a.75.75 0 01-1.08-1.04l5.25-5.5a.75.75 0 011.08 0l5.25 5.5a.75.75 0 11-1.08 1.04l-3.96-4.158V16.25A.75.75 0 0110 17z",clipRule:"evenodd"}))}const JL=f.forwardRef(YL),ZL=JL;function eM({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{fillRule:"evenodd",d:"M2 4.75A.75.75 0 012.75 4h14.5a.75.75 0 010 1.5H2.75A.75.75 0 012 4.75zM2 10a.75.75 0 01.75-.75h14.5a.75.75 0 010 1.5H2.75A.75.75 0 012 10zm0 5.25a.75.75 0 01.75-.75h14.5a.75.75 0 010 1.5H2.75a.75.75 0 01-.75-.75z",clipRule:"evenodd"}))}const tM=f.forwardRef(eM),nM=tM;function rM({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{fillRule:"evenodd",d:"M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.05-.143z",clipRule:"evenodd"}))}const sM=f.forwardRef(rM),rv=sM;function iM({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{fillRule:"evenodd",d:"M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z",clipRule:"evenodd"}))}const aM=f.forwardRef(iM),oM=aM;function lM({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm.75-13a.75.75 0 00-1.5 0v5c0 .414.336.75.75.75h4a.75.75 0 000-1.5h-3.25V5z",clipRule:"evenodd"}))}const cM=f.forwardRef(lM),uM=cM;function dM({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"}))}const hM=f.forwardRef(dM),FI=hM;function fM({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{d:"M9.653 16.915l-.005-.003-.019-.01a20.759 20.759 0 01-1.162-.682 22.045 22.045 0 01-2.582-1.9C4.045 12.733 2 10.352 2 7.5a4.5 4.5 0 018-2.828A4.5 4.5 0 0118 7.5c0 2.852-2.044 5.233-3.885 6.82a22.049 22.049 0 01-3.744 2.582l-.019.01-.005.003h-.002a.739.739 0 01-.69.001l-.002-.001z"}))}const mM=f.forwardRef(fM),Cu=mM;function pM({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{d:"M5.75 3a.75.75 0 00-.75.75v12.5c0 .414.336.75.75.75h1.5a.75.75 0 00.75-.75V3.75A.75.75 0 007.25 3h-1.5zM12.75 3a.75.75 0 00-.75.75v12.5c0 .414.336.75.75.75h1.5a.75.75 0 00.75-.75V3.75a.75.75 0 00-.75-.75h-1.5z"}))}const gM=f.forwardRef(pM),sv=gM;function xM({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{d:"M5.433 13.917l1.262-3.155A4 4 0 017.58 9.42l6.92-6.918a2.121 2.121 0 013 3l-6.92 6.918c-.383.383-.84.685-1.343.886l-3.154 1.262a.5.5 0 01-.65-.65z"}),f.createElement("path",{d:"M3.5 5.75c0-.69.56-1.25 1.25-1.25H10A.75.75 0 0010 3H4.75A2.75 2.75 0 002 5.75v9.5A2.75 2.75 0 004.75 18h9.5A2.75 2.75 0 0017 15.25V10a.75.75 0 00-1.5 0v5.25c0 .69-.56 1.25-1.25 1.25h-9.5c-.69 0-1.25-.56-1.25-1.25v-9.5z"}))}const yM=f.forwardRef(xM),vM=yM;function wM({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{d:"M6.3 2.841A1.5 1.5 0 004 4.11V15.89a1.5 1.5 0 002.3 1.269l9.344-5.89a1.5 1.5 0 000-2.538L6.3 2.84z"}))}const _M=f.forwardRef(wM),nf=_M;function bM({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{d:"M10.75 4.75a.75.75 0 00-1.5 0v4.5h-4.5a.75.75 0 000 1.5h4.5v4.5a.75.75 0 001.5 0v-4.5h4.5a.75.75 0 000-1.5h-4.5v-4.5z"}))}const SM=f.forwardRef(bM),gs=SM;function EM({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{d:"M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"}))}const kM=f.forwardRef(EM),iv=kM;function jt({close:t,title:e}){return a.jsxs("div",{className:"flex justify-between mb-3",children:[a.jsx("div",{className:"text-xl leading-[2.2] font-playwriteCU",children:e}),a.jsx("button",{onClick:t,children:a.jsx(iv,{className:"w-7"})})]})}function av({close:t}){return a.jsxs("div",{className:"w-[400px] max-w-[calc(90vw-40px)]",children:[a.jsx(jt,{close:t,title:"HD MP3"}),a.jsxs("p",{children:[a.jsx("span",{className:"font-[500]",children:"Technologies: "})," React, Tailwind Css, Google firebase"]})]})}function Yp({onClick:t,theme:e,active:n}){return a.jsx(a.Fragment,{children:a.jsxs("div",{className:"w-[25%] px-2 mt-3 max-[549px]:w-[50%]",children:[a.jsx("div",{onClick:()=>t(e),className:`relative border-l-[20px] ${e.content_border} pt-[100%] rounded-xl ${e.side_bar_bg} ${n?e.content_border:""}`,children:n&&a.jsx("div",{className:"absolute bottom-[10px] right-[10px]",children:a.jsx(nD,{className:`${e.content_text} w-[25px]`})})}),a.jsx("p",{className:"text-base font-[500] mt-1",children:e.name})]})})}function ov({close:t}){const{theme:e,setTheme:n}=q(),r=c=>{nt("theme",c.id),n(c)},s={songItemContainer:`w-full border-b border-${e.alpha} last:border-none`,icon:"w-6 h-6 mr-2 inline",popupWrapper:"w-[900px] max-w-[calc(90vw-40px)]",themeContainer:"overflow-y-auto overflow-x-hidden no-scrollbar h-[calc(70vh-60px)]  pb-[5vh]",themeList:"flex flex-row -mx-2 -mt-3 flex-wrap",linkItem:`py-[10px] border-b border-${e.alpha} last:border-none`},i=Jh.map(c=>{const u=c.id===e.id;if(c.type==="light")return a.jsx(Yp,{active:u,theme:c,onClick:r},c.id)}),o=Jh.map(c=>{const u=c.id===e.id;if(c.type==="dark")return a.jsx(Yp,{active:u,theme:c,onClick:r},c.id)}),l=OT.map(c=>{const u=c.id===e.id;return a.jsx(Yp,{active:u,theme:c,onClick:r},c.id)});return a.jsxs("div",{className:s.popupWrapper,children:[a.jsx(jt,{close:t,title:"Themes"}),a.jsxs("div",{className:s.themeContainer,children:[a.jsx("h2",{className:"text-lg font-semibold mb-[10px] mt-[30px]",children:"Specical"}),a.jsx("div",{className:s.themeList,children:l}),a.jsx("h2",{className:"text-lg font-semibold mb-[10px]",children:"Dark"}),a.jsx("div",{className:s.themeList,children:o}),a.jsx("h2",{className:"text-lg font-semibold mb-[10px] mt-[30px]",children:"Light"}),a.jsx("div",{className:s.themeList,children:i})]})]})}function xs({loading:t,callback:e,label:n,children:r,close:s,desc:i="This action cannot be undone",className:o}){const{theme:l}=q();return a.jsxs("div",{className:`${o||"w-[400px] max-w-[calc(90vw-40px)]"} ${t?"disable":""}`,children:[a.jsx("div",{className:"text-xl font-playwriteCU leading-[2.2] mb-3",children:n||"Wait a minute"}),i&&a.jsx("p",{className:"font-semibold text-lg text-red-400",children:i}),a.jsx("div",{className:"flex space-x-3 mt-5",children:r||a.jsxs(a.Fragment,{children:[a.jsx(ie,{onClick:s,className:"bg-white/10 border border-white/10 rounded-full px-3 py-0.5",variant:"primary",size:"clear",children:"Close"}),a.jsx(ie,{isLoading:t,className:`${l.content_bg} rounded-full px-3`,variant:"primary",size:"clear",onClick:e,children:"Yes, Please"})]})})]})}const TM=[3,5,7,10];function DI({closeModal:t,active:e}){const{theme:n}=q(),r={button:`bg-[#fff]/5 ${n.content_hover_bg} ml-2 mt-2 px-3  py-1 rounded-[99px]`},s=o=>{e(o),t()},i=TM.map(o=>a.jsxs("button",{type:"button",onClick:()=>s(o),className:`${r.button} `,children:[o," songs"]},o));return a.jsxs("div",{className:"w-[300px] max-w-[calc(100vw-40px)]",children:[a.jsx(jt,{close:t,title:"Sleep timer"}),a.jsx("div",{children:a.jsx("div",{className:"flex flex-wrap -mt-2 -ml-2 mb-3",children:i})})]})}function le({className:t}){const{theme:e}=q();return a.jsx("div",{className:`animate-pulse rounded-[4px] ${e.type==="light"?"bg-[#f1f1f1]":"bg-[#808080]"}  ${t}`})}const yl=[...Array(4).keys()].map(t=>a.jsxs("div",{className:"flex items-center p-[10px] border-b-[1px] border-transparent",children:[a.jsx(le,{className:"h-[18px] w-[18px]"}),a.jsx(le,{className:"h-[54px] w-[54px] ml-[10px] rounded-[4px]"}),a.jsxs("div",{className:"ml-[10px]",children:[a.jsx(le,{className:"h-[20px] mb-[5px] w-[150px]"}),a.jsx(le,{className:"h-[12px] mt-[5px] w-[100px]"})]})]},t)),LI=()=>a.jsx("div",{className:"py-3",children:a.jsx(le,{className:"w-full h-[28px]"})}),lv=[...Array(2).keys()].map(t=>a.jsxs("div",{className:"p-2 w-1/2 md:w-1/4",children:[a.jsx(le,{className:"pt-[100%] rounded-lg"}),a.jsx(le,{className:"h-[21px] mt-1.5 w-3/4"}),a.jsx(le,{className:"h-[13px] mt-1 w-3/4"})]},t));var IM=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","#","$","%","*","+",",","-",".",":",";","=","?","@","[","]","^","_","{","|","}","~"],uc=t=>{let e=0;for(let n=0;n<t.length;n++){let r=t[n],s=IM.indexOf(r);e=e*83+s}return e},Jp=t=>{let e=t/255;return e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)},Zp=t=>{let e=Math.max(0,Math.min(1,t));return e<=.0031308?Math.trunc(e*12.92*255+.5):Math.trunc((1.055*Math.pow(e,.4166666666666667)-.055)*255+.5)},CM=t=>t<0?-1:1,eg=(t,e)=>CM(t)*Math.pow(Math.abs(t),e),Fb=class extends Error{constructor(t){super(t),this.name="ValidationError",this.message=t}},jM=t=>{if(!t||t.length<6)throw new Fb("The blurhash string must be at least 6 characters");let e=uc(t[0]),n=Math.floor(e/9)+1,r=e%9+1;if(t.length!==4+2*r*n)throw new Fb(`blurhash length mismatch: length is ${t.length} but it should be ${4+2*r*n}`)},RM=t=>{let e=t>>16,n=t>>8&255,r=t&255;return[Jp(e),Jp(n),Jp(r)]},AM=(t,e)=>{let n=Math.floor(t/361),r=Math.floor(t/19)%19,s=t%19;return[eg((n-9)/9,2)*e,eg((r-9)/9,2)*e,eg((s-9)/9,2)*e]},NM=(t,e,n,r)=>{jM(t),r=r|1;let s=uc(t[0]),i=Math.floor(s/9)+1,o=s%9+1,l=(uc(t[1])+1)/166,c=new Array(o*i);for(let m=0;m<c.length;m++)if(m===0){let p=uc(t.substring(2,6));c[m]=RM(p)}else{let p=uc(t.substring(4+m*2,6+m*2));c[m]=AM(p,l*r)}let u=e*4,d=new Uint8ClampedArray(u*n);for(let m=0;m<n;m++)for(let p=0;p<e;p++){let g=0,y=0,w=0;for(let S=0;S<i;S++)for(let C=0;C<o;C++){let D=Math.cos(Math.PI*p*C/e)*Math.cos(Math.PI*m*S/n),F=c[C+S*o];g+=F[0]*D,y+=F[1]*D,w+=F[2]*D}let _=Zp(g),E=Zp(y),b=Zp(w);d[4*p+0+m*u]=_,d[4*p+1+m*u]=E,d[4*p+2+m*u]=b,d[4*p+3+m*u]=255}return d},PM=NM,FM=Object.defineProperty,DM=Object.defineProperties,LM=Object.getOwnPropertyDescriptors,rf=Object.getOwnPropertySymbols,MI=Object.prototype.hasOwnProperty,OI=Object.prototype.propertyIsEnumerable,Db=(t,e,n)=>e in t?FM(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,V0=(t,e)=>{for(var n in e||(e={}))MI.call(e,n)&&Db(t,n,e[n]);if(rf)for(var n of rf(e))OI.call(e,n)&&Db(t,n,e[n]);return t},H0=(t,e)=>DM(t,LM(e)),$I=(t,e)=>{var n={};for(var r in t)MI.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&rf)for(var r of rf(t))e.indexOf(r)<0&&OI.call(t,r)&&(n[r]=t[r]);return n},BI=class extends f.PureComponent{constructor(){super(...arguments),this.canvas=null,this.handleRef=t=>{this.canvas=t,this.draw()},this.draw=()=>{let{hash:t,height:e,punch:n,width:r}=this.props;if(this.canvas){let s=PM(t,r,e,n),i=this.canvas.getContext("2d"),o=i.createImageData(r,e);o.data.set(s),i.putImageData(o,0,0)}}}componentDidUpdate(){this.draw()}render(){let t=this.props,{hash:e,height:n,width:r}=t,s=$I(t,["hash","height","width"]);return f.createElement("canvas",H0(V0({},s),{height:n,width:r,ref:this.handleRef}))}};BI.defaultProps={height:128,width:128};var MM={position:"absolute",top:0,bottom:0,left:0,right:0,width:"100%",height:"100%"},ju=class extends f.PureComponent{componentDidUpdate(){if(this.props.resolutionX<=0)throw new Error("resolutionX must be larger than zero");if(this.props.resolutionY<=0)throw new Error("resolutionY must be larger than zero")}render(){let t=this.props,{hash:e,height:n,width:r,punch:s,resolutionX:i,resolutionY:o,style:l}=t,c=$I(t,["hash","height","width","punch","resolutionX","resolutionY","style"]);return f.createElement("div",H0(V0({},c),{style:H0(V0({display:"inline-block",height:n,width:r},l),{position:"relative"})}),f.createElement(BI,{hash:e,height:o,width:i,punch:s,style:MM}))}};ju.defaultProps={height:128,width:128,resolutionX:32,resolutionY:32};function Ye({src:t,className:e="",width:n="w-full",blurHashEncode:r,onError:s}){const[i,o]=f.useState(!1),l=f.useRef(null),c=()=>{o(!0),t&&t!=null&&t.includes("blob")&&URL.revokeObjectURL(t)},u=()=>{const m=l.current;m.src="https://placehold.co/400",o(!0)},d=()=>{console.log("image error"),s?(s(),u()):u()};return a.jsxs(a.Fragment,{children:[!i&&a.jsx(a.Fragment,{children:r?a.jsx(ju,{hash:r,height:"100%",width:"100%"}):a.jsx(le,{className:"w-full h-0"})}),a.jsx("img",{onLoad:c,onError:d,className:`${e} ${n} ${i?"":"hidden"}`,src:t||"https://placehold.co/400",ref:l})]})}function Ru({children:t,className:e=""}){return a.jsx("div",{className:`pt-[100%] relative rounded-lg overflow-hidden ${e}`,children:a.jsx("div",{className:"absolute inset-0",children:t})})}const cv="border border-black/10 placeholder:[#888] outline-none py-1.5 px-2",OM=ku("w-full",{variants:{variant:{primary:cv,clear:""},rounded:{xl:"rounded-xl",lg:"rounded-lg",md:"rounded-md"}},defaultVariants:{variant:"primary",rounded:"md"}});function $M({variant:t,className:e="bg-white/10",...n},r){return a.jsx("input",{ref:r,className:` ${OM({variant:t,className:e})}`,...n})}const Ht=f.forwardRef($M),BM=ku("",{variants:{p:{3:"p-3",2:"p-2",1:"p-1",clear:""},rounded:{xl:"rounded-xl",lg:"rounded-lg",md:"rounded-md",sm:"rounded-sm"}},defaultVariants:{p:3,rounded:"xl"}});function ei({children:t,bg:e="primary",theme:n,className:r,p:s,rounded:i}){return a.jsx("div",{className:` ${e==="primary"?n.modal_bg:""} text-white border-[#fff]/5 border-[1px]  ${BM({p:s,rounded:i,className:r})}`,children:t})}function tg({className:t,icon:e,label:n,to:r,arrowIcon:s,children:i}){return r?a.jsxs(we,{className:`w-full flex  justify-between  ${t}`,to:r,children:[a.jsxs("div",{className:"inline-flex items-center ",children:[e,a.jsx("span",{className:"text-lg font-medium",children:n})]}),i,s&&a.jsx("span",{children:s})]}):a.jsx("p",{children:"No onClick"})}const zI="/HD-MP3/assets/simon_empty-95813d48.png";function Xe({children:t,variant:e="default",className:n=""}){const r=()=>{switch(e){case"less":return a.jsx(a.Fragment,{});case"with-home-button":return a.jsxs(a.Fragment,{children:[a.jsx("p",{className:"text-center",children:"No result found, ¯\\_(ツ)_/¯"}),a.jsx("p",{className:"text-center mt-5",children:a.jsx(we,{to:"/",children:a.jsxs(ie,{color:"primary",children:[a.jsx(fm,{className:"w-6"}),a.jsx("span",{children:"Home"})]})})})]});case"default":return a.jsx("p",{className:"text-center",children:"No result found, ¯\\_(ツ)_/¯"})}};return a.jsxs("div",{className:`${n}`,children:[a.jsx("img",{className:"mx-auto",src:zI,alt:""}),r(),t]})}function Wt({children:t}){return a.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2",children:t})}function Se({title:t,className:e=""}){return a.jsx("div",{className:`text-xl font-playwriteCU leading-[2.4] ${e}`,children:t})}function UI({colList:t,children:e,className:n=""}){const r={table:"w-full"};return a.jsxs("table",{className:`${r.table} ${n}`,children:[a.jsx("thead",{children:a.jsx("tr",{children:t.map((s,i)=>a.jsx("th",{children:s},i))})}),a.jsx("tbody",{children:e})]})}const zM=({appendOnPortal:t})=>{const[e,n]=f.useState(!1),[r,s]=f.useState(!1),i=f.useRef(null),o=f.useRef(null);return{refs:{triggerRef:i,contentRef:o},setTriggerRef:m=>{i.current=m},setContentRef:m=>{o.current=m},state:{isMounted:r,isOpen:e},setIsMounted:s,setIsOpen:n,appendOnPortal:t,close:()=>{s(!1)},toggle:()=>{r&&s(!1),e||n(!0)}}},VI=f.createContext(null),Sr=()=>{const t=f.useContext(VI);return t||{}};function pr({children:t,relativeWrap:e=!0,appendOnPortal:n,...r}){return a.jsx(VI.Provider,{value:zM({...r,appendOnPortal:n}),children:n?t:a.jsx("div",{className:"relative",children:t})})}const gr=f.forwardRef(function({children:t,needButton:e,setIsOpenParent:n},r){const{refs:s,setIsMounted:i,setIsOpen:o,close:l,toggle:c,state:{isMounted:u,isOpen:d}}=Sr();return f.useImperativeHandle(r,()=>({close:l})),f.useEffect(()=>{u||(n&&n(!1),setTimeout(()=>{o(!1)},400))},[u]),f.useEffect(()=>(d&&(n&&n(!0),setTimeout(()=>{i(!0)},100)),()=>{d||i(!1)}),[d]),f.useEffect(()=>{if(!d)return;const m=p=>{var g,y;!s.contentRef||!s.triggerRef||(g=s.triggerRef.current)!=null&&g.contains(p.target)||(y=s.contentRef.current)!=null&&y.contains(p.target)||i(!1)};return document.addEventListener("mousedown",m),document.addEventListener("touchstart",m),()=>{document.removeEventListener("mousedown",m),document.removeEventListener("touchstart",m)}},[d]),!e&&f.isValidElement(t)?f.cloneElement(t,{onClick:c,ref:s.triggerRef}):a.jsx("button",{ref:s.triggerRef,onClick:c,children:t})});function xr({children:t,className:e,animationClassName:n,...r}){const{state:{isMounted:s,isOpen:i},refs:o,close:l,appendOnPortal:c,setContentRef:u}=Sr(),d=f.useRef(null),m=()=>{const w=o.triggerRef.current,_=o.contentRef.current,E=d.current;if(!w||!_)return;const b=w.getBoundingClientRect(),S={top:b.top+w.clientHeight,left:b.left-_.clientWidth};if(r.appendTo==="portal"){const{origin:C="top right",position:D,spacer:F=8}=r;switch(D){case"right-bottom":{S.top=b.top+w.clientHeight+F,S.left=b.left;break}}const I=S.top+_.clientHeight>window.innerHeight-90;if(I){let k=S.top-_.clientHeight-w.clientHeight;k-60<0&&(k=60),S.top=k}if(E){let k=C;I&&(k="bottom right"),E.style.transformOrigin=k}}_.style.left=`${S.left}px`,_.style.top=`${S.top}px`},p=l,g={unMountedContent:"opacity-0 scale-[.95]",mountedContent:"opacity-100 scale-[1]"},y=a.jsx("div",{ref:u,className:`popup-content ${c?"fixed z-[99]":"absolute"} ${e||""}`,children:a.jsx("div",{ref:d,className:` transition-[transform,opacity] duration-[.25s] ease-linear ${n||""} ${s?g.mountedContent:g.unMountedContent}`,children:t})});return f.useEffect(()=>{if(c)return i&&(m(),document.addEventListener("wheel",p)),()=>{document.removeEventListener("wheel",p)}},[i]),i?a.jsx(a.Fragment,{children:c?Ya.createPortal(y,document.getElementById("portals")):y}):a.jsx(a.Fragment,{})}function W0(t,e){const[n,r]=f.useState(e),s=f.useRef(!1);return f.useEffect(()=>{const i=mn()[t]||e;r(i)},[]),f.useEffect(()=>{if(!s.current){s.current=!0;return}nt(t,n)},[n]),[n,r]}function UM({audioEle:t,postLocalStorageKey:e}){const[n,r]=W0(`audio_speed_${e}`,1),[s,i]=W0(`audio_volume_${e}`,100);return f.useEffect(()=>{t.volume=s/100,t.playbackRate=n},[s,n]),{speed:n,setSpeed:r,volume:s,setVolume:i}}function HI({className:t="",positions:e="right",bg:n="",...r}){const{theme:s}=q(),{speed:i,volume:o,setVolume:l,setSpeed:c}=UM(r);return a.jsxs(pr,{appendOnPortal:!0,children:[a.jsx(gr,{children:a.jsx(ie,{className:`${s.content_bg} rounded-full ${t}`,children:a.jsx(Xy,{className:"w-6"})})}),a.jsx(xr,{...e==="right"?{position:"right-bottom",origin:"top left"}:{position:"left-bottom",origin:"top right"},appendTo:"portal",children:a.jsx(ei,{bg:"clear",className:`w-[240px] ${n||s.modal_bg} `,theme:s,children:a.jsxs("div",{className:"space-y-[6px]",children:[a.jsxs("div",{className:"flex space-x-1",children:[a.jsxs("div",{className:"w-[110px] flex-shrink-0",children:["Speed ",i,"x"]}),a.jsx("input",{className:"w-full",type:"range",step:.1,min:1,max:1.5,value:i,onChange:u=>c(+u.target.value)})]}),a.jsxs("div",{className:"flex space-x-1",children:[a.jsxs("div",{className:"w-[110px] flex-shrink-0",children:["Volume ",o,"%"]}),a.jsx("input",{className:"w-full",type:"range",step:1,min:1,max:100,value:o,onChange:u=>l(+u.target.value)})]})]})})})]})}function gh({cb:t,active:e,inActiveBg:n="bg-white/10",size:r="default"}){const{theme:s}=q(),i={circle:`${r==="default"?"w-[20px] h-[20px]":"w-[16px] h-[16px]"}  absolute bg-white left-[3px] rounded-[50%] transition-transform top-[50%] translate-y-[-50%]`,active:`${r==="default"?"translate-x-[14px]":"translate-x-[18px]"} `,inActive:"translate-x-[0]"};return a.jsx("div",{onClick:t,className:`relative  cursor-pointer ${r==="default"?"h-[24px]":"h-[20px]"} rounded-[99px] w-[40px] 
         ${e?s.content_bg:n} `,children:a.jsx("div",{className:`${i.circle} ${e?i.active:i.inActive}`})})}function VM({children:t,className:e,persisted:n=!1,wrapped:r=!0,...s},i){const o=s.variant||"default",{theme:l}=q(),[c,u]=f.useState(o==="default"),[d,m]=f.useState(o==="default"),[p,g]=f.useState(n),y=()=>{d&&m(!1),c||u(!0)},w=()=>{u(!0)},_=()=>{m(!1),g(!1)},E=C=>{g(C)},b=C=>{C.preventDefault(),C.stopPropagation(),!p&&(o==="default"&&s.closeModal&&s.closeModal(),o==="animation"&&_())};f.useImperativeHandle(i,()=>({toggle:y,close:_,open:w,setModalPersist:E})),f.useEffect(()=>{o!=="default"&&(d||setTimeout(()=>{u(!1),s.onClose&&s.onClose()},400))},[d]),f.useEffect(()=>{o!=="default"&&c&&setTimeout(()=>{m(!0)},100)},[c]);const S={unMountedContent:"opacity-0 scale-[.95]",mountedContent:"opacity-100 scale-[1]",unMountedLayer:"opacity-0",mountedLayer:"opacity-40"};return a.jsx(a.Fragment,{children:c&&Ya.createPortal(a.jsxs("div",{className:"fixed inset-0 z-[99]",children:[a.jsx("div",{onClick:b,className:`transition-opacity duration-300 absolute bg-black inset-0 z-[90]
                             ${d?S.mountedLayer:S.unMountedLayer}
                        `}),a.jsx("div",{className:`modal-content absolute duration-300 transition-[transform,opacity] z-[99] top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2
                            ${d?S.mountedContent:S.unMountedContent}
                        `,children:r?a.jsx(ei,{className:e||"",theme:l,children:t}):t})]}),document.getElementById("portals"))})}function HM({children:t,className:e="w-[400px]"}){return a.jsx("div",{className:`max-h-[80vh] max-w-[90vw] ${e}`,children:t})}const De=f.forwardRef(VM),uv="data:image/gif;base64,R0lGODlhJAAkAIABAP///////yH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQ4IDc5LjE2NDAzNiwgMjAxOS8wOC8xMy0wMTowNjo1NyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo0NmRjOGMyNC03YmYxLTQxZTMtYjQ2Zi1mY2ZhMDk4MDE1YWYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MTBDRTc0QzlGNDBEMTFFQTk4NDZENjI0QzI1MENFQzgiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MTBDRTc0QzhGNDBEMTFFQTk4NDZENjI0QzI1MENFQzgiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6YzBhNGU4OWYtNjc4Yy00NmMyLTg4NmUtYzIxNGE0NTIwZDRjIiBzdFJlZjpkb2N1bWVudElEPSJhZG9iZTpkb2NpZDpwaG90b3Nob3A6ODRlMDBjYmEtZjhlNy03YzQ4LWE4MTgtNDc3NTI3MGQ1ZTAyIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkECQgAAQAsAAAAACQAJAAAAnKMj5nArQ9jc7HWyax+GOx/dCAojltpWmgqYazqvu0kz1StrHgYp6tO6gWAn59wZKSxkjcTM7MUEk/SY1BpmGqeHhs0W8Vywk3tkPw9iztcBLfNW7Pl9PLcXk/f8Xz9vguWB6h254Y2+Id4aLjH2Kc4UQAAIfkECQgAAQAsAAAAACQAJAAAAnSMj6nL7Q+jnAzYS+XFGW7beV/4fADpmGijrkvrJnA2z1Q9hvhG7lznA+lyBpuMGAieDiYlQulkIpvTKk9KFRatv2RW671uxeHskwv+ptHLsRnbhbLPZHW7vK6r6XF21J33Bngnp2fY98UXuNikSOg3B8dYAAAh+QQJCAABACwAAAAAJAAkAAACfIyPqcvtD6OctNqLKdg8N955C7iJI4mQAKam6NUeMTMHda3cr4EnOugCfnY2Yi8Y4hmXKqHSWYQ2mclodSqllmTY7fOqbSK9VnLXHB6Ludk2Vg1nv+Vo9zT+rc/zK3qf/wNmt8aHV0Z4aHj2l+inFqgXiQjJuKgYRnkJUgAAIfkECQgAAQAsAAAAACQAJAAAAnuMj6nL7Q+jnLTaC7K+T2/eeBkYiiQjAlyKsJh5uJYc0BRtTzgMpbsn8fFqQ4cQGCuWjqok0vA7toZR4fRJxDJHzg+Uur16s+Nt86sFM8VcdDncbZPlZvZ5fq/H82rp3m5XxZe29mfoZnWIF9hH1+gDqKiHOPhWSBlJWQAAIfkECQgAAQAsAAAAACQAJAAAAn6Mj6nL7Q8RmDTaQ+u1eW7efVg4ZqLRARIppqsZpW6pQTIbzPZd57jD6+keQQ/NuAu+esDiEkl0HlUxKerXKFKvsCTvuY0qp2Dw8IzTlslTdNf3VrO5Qiu8Hre78d/5HSpHB5imR5g3Jhi2d7OWaGbIN4j4pwjJ6Lco00gJVgAAIfkECQgAAQAsAAAAACQAJAAAAn2EH6nL7XnQmxRGULO7WHsbfRPHiQ95mRsqqQvbBqUGG29K13eYw3tMqXVAwJFOMcsIf7YeizmsLJE45ZHYtPqoPO2TWzxdZVXpOGneYqPBc7mtJnflsekaCkXry3Z61h/VtzcnyGcYN1jnRnj4dQf2V8g46QiIB0ly+bhWAAAh+QQJCAABACwAAAAAJAAkAAACfYyPqcvtD+MDtMobqt6Y7Q90C8iJCamZJ0qpCNu6Bhwen0S/JZTb+wTTpSK92c9RzBwbyRsx6BvyoEYpkCW0RLVVVDbWBSuxW7EzDPrW0OrzmPs2U+Nrevvnzs/11ib+T8ZWVufXB+g1qHZnyAhX6HhIopg4yAfZKEkpiFYAACH5BAkIAAEALAAAAAAkACQAAAJ7jI+py+0Po5y02ouB3tht3jGfFopjuYwqgK5npCLuJ8XHDEK2gZP3ywMGeqwfzZgb9mTCnRLHPAalz1k06SRefVPsEsmthrXgYnf8PZvFa7J6206z4fBs8w4t08t2at+qF6j2h+YnRxiX9ybIhrg3iOdlqDjH6Fa5qFYAACH5BAkIAAEALAAAAAAkACQAAAJ1jI+py+0Po5y02otzArxr1nmfEnIjWZ5bqh4l0Lqs8WK1HNpzcFs9/9o5fkFhg1gUQZBJWISZlECL0l3ThFMCc1lq10mzXhFT8Db6JYubam7Yffa+teVymz5O6+fyuLm+hgd39ReIxRd0d+inmLjH+GX3+FIAACH5BAUIAAEALAAAAAAkACQAAAJwjI+py+0Po5y0PoCzhVlv12EfGI5NCJgMqi5sm7zwIc9BPeOw3vKqb6oBLyUaqshB3o4diZDpSTaN0FTkWUVgo8sslbtlapXh43hqKJfP4Ko1TY574ehue24XffV0KJuf9xa4tifoZih351f4h9hRAAA7",dv=({data:t,variant:e="link",active:n,link:r})=>{const s=a.jsxs(Ru,{children:[a.jsx(Ye,{className:`hover:scale-[1.05] transition-transform object-cover ${n?"brightness-[90%]":""}`,src:t.image_url,blurHashEncode:t.blurhash_encode}),n&&a.jsx(Wt,{children:a.jsx("img",{src:uv,alt:"",className:"w-[30px]"})})]});return(()=>{switch(e){case"link":return a.jsxs(a.Fragment,{children:[a.jsx(we,{to:`${r||"/playlist/"+t.id}`,className:"",children:s}),a.jsx("p",{className:"text-lg font-[500] leading-[1.3] line-clamp-1 mt-1.5",children:t.name}),a.jsx("p",{className:"text-sm opacity-[.7] leading-[1.3] line-clamp-1",children:t.is_album?t.singers[0].name:t.distributor})]});case"image":return s}})()};function WI({openModal:t,variant:e}){const{theme:n}=q(),r=o=>{t(o)},s={menuItem:"hover:bg-[#fff]/5 rounded-md text-sm font-[500] px-2 py-2 inline-flex items-center cursor-pointer",icon:"w-5 mr-2",divide:"h-[1px]  w-[calc(100%-20px)] my-[4px] mx-auto bg-[#fff]/5"},i=()=>{switch(e){case"client":return a.jsxs(a.Fragment,{children:[a.jsxs("li",{className:`${s.menuItem}`,onClick:()=>r("theme"),children:[a.jsx(U0,{className:s.icon}),"Themes"]}),a.jsx("div",{className:s.divide}),a.jsxs("li",{className:`${s.menuItem}`,onClick:()=>r("info"),children:[a.jsx(z0,{className:s.icon}),"Info"]})]});case"dashboard":return a.jsxs(a.Fragment,{children:[a.jsxs("li",{className:`${s.menuItem}`,onClick:()=>r("theme"),children:[a.jsx(U0,{className:s.icon}),"Themes"]}),a.jsx("div",{className:s.divide}),a.jsxs("li",{className:`${s.menuItem}`,onClick:()=>r("info"),children:[a.jsx(z0,{className:s.icon}),"Info"]})]})}};return a.jsx(a.Fragment,{children:a.jsx(ei,{theme:n,children:a.jsx("ul",{className:"flex flex-col w-[200px]",children:i()})})})}const WM=({data:t,active:e,onClick:n,hasTitle:r,classNames:s="",idleClass:i=""},o)=>{const l={container:"flex flex-col",imageFrame:"group relative transition-[width] duration-[.3s] origin-center rounded-xl overflow-hidden",image:"select-none object-cover object-center rounded w-full",overlay:`absolute  ${e?"":"inset-0 hidden bg-black/40 items-center justify-center"}   group-hover:flex`,playingGifFrame:"absolute h-[30px] w-[30px] bottom-[15px] left-[15px] -z-1",title:"text-2xl text-white mt-3 font-bold text-ellipsis line-clamp-1"};if(t)return a.jsxs("div",{ref:o,"queue-id":t.queue_id,className:`song-thumb ${e?"active":""} ${l.container} ${i}`,children:[a.jsx("div",{className:`${s} flex items-end justify-center flex-shrink-0 w-[350px] h-[350px] min-[1536px]:w-[450px] min-[1536px]:h-[450px] `,children:a.jsxs("div",{className:`border-[4px] rounded-[6px] overflow-hidden border-transparent ${l.imageFrame} ${e?"w-[350px] min-[1536px]:w-[450px]":"w-[280px] min-[1536px]:w-[330px]"}`,children:[a.jsx(Ye,{src:t.image_url,blurHashEncode:t.blurhash_encode}),a.jsx("div",{className:`${l.overlay}`,children:!e&&a.jsx(ie,{onClick:n,variant:"circle",hover:"scale",size:"clear",className:"p-2 hover:bg-[#fff]/10",children:a.jsx(nv,{className:"w-10"})})}),e&&a.jsx("div",{className:l.playingGifFrame,children:a.jsx("img",{src:uv,alt:""})})]})}),r&&a.jsxs("div",{className:"text-center",children:[a.jsx("h2",{className:l.title,children:(t==null?void 0:t.name)||"Some song"}),a.jsx("p",{className:"text-md opacity-50 line-clamp-1",children:t.singers.map((c,u)=>a.jsx("span",{children:c.name},u))})]})]})},ng=f.forwardRef(WM);var qI={exports:{}},GI={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Au=f;function qM(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var GM=typeof Object.is=="function"?Object.is:qM,QM=Au.useSyncExternalStore,KM=Au.useRef,XM=Au.useEffect,YM=Au.useMemo,JM=Au.useDebugValue;GI.useSyncExternalStoreWithSelector=function(t,e,n,r,s){var i=KM(null);if(i.current===null){var o={hasValue:!1,value:null};i.current=o}else o=i.current;i=YM(function(){function c(g){if(!u){if(u=!0,d=g,g=r(g),s!==void 0&&o.hasValue){var y=o.value;if(s(y,g))return m=y}return m=g}if(y=m,GM(d,g))return y;var w=r(g);return s!==void 0&&s(y,w)?(d=g,y):(d=g,m=w)}var u=!1,d,m,p=n===void 0?null:n;return[function(){return c(e())},p===null?void 0:function(){return c(p())}]},[e,n,r,s]);var l=QM(t,i[0],i[1]);return XM(function(){o.hasValue=!0,o.value=l},[l]),JM(l),l};qI.exports=GI;var ZM=qI.exports;function eO(t){t()}function tO(){let t=null,e=null;return{clear(){t=null,e=null},notify(){eO(()=>{let n=t;for(;n;)n.callback(),n=n.next})},get(){const n=[];let r=t;for(;r;)n.push(r),r=r.next;return n},subscribe(n){let r=!0;const s=e={callback:n,next:null,prev:e};return s.prev?s.prev.next=s:t=s,function(){!r||t===null||(r=!1,s.next?s.next.prev=s.prev:e=s.prev,s.prev?s.prev.next=s.next:t=s.next)}}}}var Lb={notify(){},get:()=>[]};function nO(t,e){let n,r=Lb,s=0,i=!1;function o(w){d();const _=r.subscribe(w);let E=!1;return()=>{E||(E=!0,_(),m())}}function l(){r.notify()}function c(){y.onStateChange&&y.onStateChange()}function u(){return i}function d(){s++,n||(n=e?e.addNestedSub(c):t.subscribe(c),r=tO())}function m(){s--,n&&s===0&&(n(),n=void 0,r.clear(),r=Lb)}function p(){i||(i=!0,d())}function g(){i&&(i=!1,m())}const y={addNestedSub:o,notifyNestedSubs:l,handleChangeWrapper:c,isSubscribed:u,trySubscribe:p,tryUnsubscribe:g,getListeners:()=>r};return y}var rO=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",sO=rO(),iO=()=>typeof navigator<"u"&&navigator.product==="ReactNative",aO=iO(),oO=()=>sO||aO?f.useLayoutEffect:f.useEffect,lO=oO(),rg=Symbol.for("react-redux-context"),sg=typeof globalThis<"u"?globalThis:{};function cO(){if(!f.createContext)return{};const t=sg[rg]??(sg[rg]=new Map);let e=t.get(f.createContext);return e||(e=f.createContext(null),t.set(f.createContext,e)),e}var Ui=cO();function uO(t){const{children:e,context:n,serverState:r,store:s}=t,i=f.useMemo(()=>{const c=nO(s);return{store:s,subscription:c,getServerState:r?()=>r:void 0}},[s,r]),o=f.useMemo(()=>s.getState(),[s]);lO(()=>{const{subscription:c}=i;return c.onStateChange=c.notifyNestedSubs,c.trySubscribe(),o!==s.getState()&&c.notifyNestedSubs(),()=>{c.tryUnsubscribe(),c.onStateChange=void 0}},[i,o]);const l=n||Ui;return f.createElement(l.Provider,{value:i},e)}var dO=uO;function hv(t=Ui){return function(){return f.useContext(t)}}var QI=hv();function KI(t=Ui){const e=t===Ui?QI:hv(t),n=()=>{const{store:r}=e();return r};return Object.assign(n,{withTypes:()=>n}),n}var hO=KI();function fO(t=Ui){const e=t===Ui?hO:KI(t),n=()=>e().dispatch;return Object.assign(n,{withTypes:()=>n}),n}var on=fO(),mO=(t,e)=>t===e;function pO(t=Ui){const e=t===Ui?QI:hv(t),n=(r,s={})=>{const{equalityFn:i=mO}=typeof s=="function"?{equalityFn:s}:s,o=e(),{store:l,subscription:c,getServerState:u}=o;f.useRef(!0);const d=f.useCallback({[r.name](p){return r(p)}}[r.name],[r]),m=ZM.useSyncExternalStoreWithSelector(c.addNestedSub,l.getState,u||l.getState,d,i);return f.useDebugValue(m),m};return Object.assign(n,{withTypes:()=>n}),n}var se=pO();function Lt(t){return`Minified Redux error #${t}; visit https://redux.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var gO=(()=>typeof Symbol=="function"&&Symbol.observable||"@@observable")(),Mb=gO,ig=()=>Math.random().toString(36).substring(7).split("").join("."),xO={INIT:`@@redux/INIT${ig()}`,REPLACE:`@@redux/REPLACE${ig()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${ig()}`},sf=xO;function fv(t){if(typeof t!="object"||t===null)return!1;let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e||Object.getPrototypeOf(t)===null}function XI(t,e,n){if(typeof t!="function")throw new Error(Lt(2));if(typeof e=="function"&&typeof n=="function"||typeof n=="function"&&typeof arguments[3]=="function")throw new Error(Lt(0));if(typeof e=="function"&&typeof n>"u"&&(n=e,e=void 0),typeof n<"u"){if(typeof n!="function")throw new Error(Lt(1));return n(XI)(t,e)}let r=t,s=e,i=new Map,o=i,l=0,c=!1;function u(){o===i&&(o=new Map,i.forEach((_,E)=>{o.set(E,_)}))}function d(){if(c)throw new Error(Lt(3));return s}function m(_){if(typeof _!="function")throw new Error(Lt(4));if(c)throw new Error(Lt(5));let E=!0;u();const b=l++;return o.set(b,_),function(){if(E){if(c)throw new Error(Lt(6));E=!1,u(),o.delete(b),i=null}}}function p(_){if(!fv(_))throw new Error(Lt(7));if(typeof _.type>"u")throw new Error(Lt(8));if(typeof _.type!="string")throw new Error(Lt(17));if(c)throw new Error(Lt(9));try{c=!0,s=r(s,_)}finally{c=!1}return(i=o).forEach(b=>{b()}),_}function g(_){if(typeof _!="function")throw new Error(Lt(10));r=_,p({type:sf.REPLACE})}function y(){const _=m;return{subscribe(E){if(typeof E!="object"||E===null)throw new Error(Lt(11));function b(){const C=E;C.next&&C.next(d())}return b(),{unsubscribe:_(b)}},[Mb](){return this}}}return p({type:sf.INIT}),{dispatch:p,subscribe:m,getState:d,replaceReducer:g,[Mb]:y}}function yO(t){Object.keys(t).forEach(e=>{const n=t[e];if(typeof n(void 0,{type:sf.INIT})>"u")throw new Error(Lt(12));if(typeof n(void 0,{type:sf.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(Lt(13))})}function vO(t){const e=Object.keys(t),n={};for(let i=0;i<e.length;i++){const o=e[i];typeof t[o]=="function"&&(n[o]=t[o])}const r=Object.keys(n);let s;try{yO(n)}catch(i){s=i}return function(o={},l){if(s)throw s;let c=!1;const u={};for(let d=0;d<r.length;d++){const m=r[d],p=n[m],g=o[m],y=p(g,l);if(typeof y>"u")throw l&&l.type,new Error(Lt(14));u[m]=y,c=c||y!==g}return c=c||r.length!==Object.keys(o).length,c?u:o}}function af(...t){return t.length===0?e=>e:t.length===1?t[0]:t.reduce((e,n)=>(...r)=>e(n(...r)))}function wO(...t){return e=>(n,r)=>{const s=e(n,r);let i=()=>{throw new Error(Lt(15))};const o={getState:s.getState,dispatch:(c,...u)=>i(c,...u)},l=t.map(c=>c(o));return i=af(...l)(s.dispatch),{...s,dispatch:i}}}function _O(t){return fv(t)&&"type"in t&&typeof t.type=="string"}var YI=Symbol.for("immer-nothing"),Ob=Symbol.for("immer-draftable"),Zn=Symbol.for("immer-state");function Fr(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var Yo=Object.getPrototypeOf;function La(t){return!!t&&!!t[Zn]}function Vs(t){var e;return t?JI(t)||Array.isArray(t)||!!t[Ob]||!!((e=t.constructor)!=null&&e[Ob])||gm(t)||xm(t):!1}var bO=Object.prototype.constructor.toString();function JI(t){if(!t||typeof t!="object")return!1;const e=Yo(t);if(e===null)return!0;const n=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return n===Object?!0:typeof n=="function"&&Function.toString.call(n)===bO}function of(t,e){pm(t)===0?Reflect.ownKeys(t).forEach(n=>{e(n,t[n],t)}):t.forEach((n,r)=>e(r,n,t))}function pm(t){const e=t[Zn];return e?e.type_:Array.isArray(t)?1:gm(t)?2:xm(t)?3:0}function q0(t,e){return pm(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function ZI(t,e,n){const r=pm(t);r===2?t.set(e,n):r===3?t.add(n):t[e]=n}function SO(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}function gm(t){return t instanceof Map}function xm(t){return t instanceof Set}function pa(t){return t.copy_||t.base_}function G0(t,e){if(gm(t))return new Map(t);if(xm(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const n=JI(t);if(e===!0||e==="class_only"&&!n){const r=Object.getOwnPropertyDescriptors(t);delete r[Zn];let s=Reflect.ownKeys(r);for(let i=0;i<s.length;i++){const o=s[i],l=r[o];l.writable===!1&&(l.writable=!0,l.configurable=!0),(l.get||l.set)&&(r[o]={configurable:!0,writable:!0,enumerable:l.enumerable,value:t[o]})}return Object.create(Yo(t),r)}else{const r=Yo(t);if(r!==null&&n)return{...t};const s=Object.create(r);return Object.assign(s,t)}}function mv(t,e=!1){return ym(t)||La(t)||!Vs(t)||(pm(t)>1&&(t.set=t.add=t.clear=t.delete=EO),Object.freeze(t),e&&Object.entries(t).forEach(([n,r])=>mv(r,!0))),t}function EO(){Fr(2)}function ym(t){return Object.isFrozen(t)}var kO={};function Ma(t){const e=kO[t];return e||Fr(0,t),e}var eu;function eC(){return eu}function TO(t,e){return{drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function $b(t,e){e&&(Ma("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function Q0(t){K0(t),t.drafts_.forEach(IO),t.drafts_=null}function K0(t){t===eu&&(eu=t.parent_)}function Bb(t){return eu=TO(eu,t)}function IO(t){const e=t[Zn];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function zb(t,e){e.unfinalizedDrafts_=e.drafts_.length;const n=e.drafts_[0];return t!==void 0&&t!==n?(n[Zn].modified_&&(Q0(e),Fr(4)),Vs(t)&&(t=lf(e,t),e.parent_||cf(e,t)),e.patches_&&Ma("Patches").generateReplacementPatches_(n[Zn].base_,t,e.patches_,e.inversePatches_)):t=lf(e,n,[]),Q0(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==YI?t:void 0}function lf(t,e,n){if(ym(e))return e;const r=e[Zn];if(!r)return of(e,(s,i)=>Ub(t,r,e,s,i,n)),e;if(r.scope_!==t)return e;if(!r.modified_)return cf(t,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const s=r.copy_;let i=s,o=!1;r.type_===3&&(i=new Set(s),s.clear(),o=!0),of(i,(l,c)=>Ub(t,r,s,l,c,n,o)),cf(t,s,!1),n&&t.patches_&&Ma("Patches").generatePatches_(r,n,t.patches_,t.inversePatches_)}return r.copy_}function Ub(t,e,n,r,s,i,o){if(La(s)){const l=i&&e&&e.type_!==3&&!q0(e.assigned_,r)?i.concat(r):void 0,c=lf(t,s,l);if(ZI(n,r,c),La(c))t.canAutoFreeze_=!1;else return}else o&&n.add(s);if(Vs(s)&&!ym(s)){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1)return;lf(t,s),(!e||!e.scope_.parent_)&&typeof r!="symbol"&&Object.prototype.propertyIsEnumerable.call(n,r)&&cf(t,s)}}function cf(t,e,n=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&mv(e,n)}function CO(t,e){const n=Array.isArray(t),r={type_:n?1:0,scope_:e?e.scope_:eC(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let s=r,i=pv;n&&(s=[r],i=tu);const{revoke:o,proxy:l}=Proxy.revocable(s,i);return r.draft_=l,r.revoke_=o,l}var pv={get(t,e){if(e===Zn)return t;const n=pa(t);if(!q0(n,e))return jO(t,n,e);const r=n[e];return t.finalized_||!Vs(r)?r:r===ag(t.base_,e)?(og(t),t.copy_[e]=Y0(r,t)):r},has(t,e){return e in pa(t)},ownKeys(t){return Reflect.ownKeys(pa(t))},set(t,e,n){const r=tC(pa(t),e);if(r!=null&&r.set)return r.set.call(t.draft_,n),!0;if(!t.modified_){const s=ag(pa(t),e),i=s==null?void 0:s[Zn];if(i&&i.base_===n)return t.copy_[e]=n,t.assigned_[e]=!1,!0;if(SO(n,s)&&(n!==void 0||q0(t.base_,e)))return!0;og(t),X0(t)}return t.copy_[e]===n&&(n!==void 0||e in t.copy_)||Number.isNaN(n)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=n,t.assigned_[e]=!0),!0},deleteProperty(t,e){return ag(t.base_,e)!==void 0||e in t.base_?(t.assigned_[e]=!1,og(t),X0(t)):delete t.assigned_[e],t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const n=pa(t),r=Reflect.getOwnPropertyDescriptor(n,e);return r&&{writable:!0,configurable:t.type_!==1||e!=="length",enumerable:r.enumerable,value:n[e]}},defineProperty(){Fr(11)},getPrototypeOf(t){return Yo(t.base_)},setPrototypeOf(){Fr(12)}},tu={};of(pv,(t,e)=>{tu[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});tu.deleteProperty=function(t,e){return tu.set.call(this,t,e,void 0)};tu.set=function(t,e,n){return pv.set.call(this,t[0],e,n,t[0])};function ag(t,e){const n=t[Zn];return(n?pa(n):t)[e]}function jO(t,e,n){var s;const r=tC(e,n);return r?"value"in r?r.value:(s=r.get)==null?void 0:s.call(t.draft_):void 0}function tC(t,e){if(!(e in t))return;let n=Yo(t);for(;n;){const r=Object.getOwnPropertyDescriptor(n,e);if(r)return r;n=Yo(n)}}function X0(t){t.modified_||(t.modified_=!0,t.parent_&&X0(t.parent_))}function og(t){t.copy_||(t.copy_=G0(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var RO=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,n,r)=>{if(typeof e=="function"&&typeof n!="function"){const i=n;n=e;const o=this;return function(c=i,...u){return o.produce(c,d=>n.call(this,d,...u))}}typeof n!="function"&&Fr(6),r!==void 0&&typeof r!="function"&&Fr(7);let s;if(Vs(e)){const i=Bb(this),o=Y0(e,void 0);let l=!0;try{s=n(o),l=!1}finally{l?Q0(i):K0(i)}return $b(i,r),zb(s,i)}else if(!e||typeof e!="object"){if(s=n(e),s===void 0&&(s=e),s===YI&&(s=void 0),this.autoFreeze_&&mv(s,!0),r){const i=[],o=[];Ma("Patches").generateReplacementPatches_(e,s,i,o),r(i,o)}return s}else Fr(1,e)},this.produceWithPatches=(e,n)=>{if(typeof e=="function")return(o,...l)=>this.produceWithPatches(o,c=>e(c,...l));let r,s;return[this.produce(e,n,(o,l)=>{r=o,s=l}),r,s]},typeof(t==null?void 0:t.autoFreeze)=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof(t==null?void 0:t.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy)}createDraft(t){Vs(t)||Fr(8),La(t)&&(t=AO(t));const e=Bb(this),n=Y0(t,void 0);return n[Zn].isManual_=!0,K0(e),n}finishDraft(t,e){const n=t&&t[Zn];(!n||!n.isManual_)&&Fr(9);const{scope_:r}=n;return $b(r,e),zb(void 0,r)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}applyPatches(t,e){let n;for(n=e.length-1;n>=0;n--){const s=e[n];if(s.path.length===0&&s.op==="replace"){t=s.value;break}}n>-1&&(e=e.slice(n+1));const r=Ma("Patches").applyPatches_;return La(t)?r(t,e):this.produce(t,s=>r(s,e))}};function Y0(t,e){const n=gm(t)?Ma("MapSet").proxyMap_(t,e):xm(t)?Ma("MapSet").proxySet_(t,e):CO(t,e);return(e?e.scope_:eC()).drafts_.push(n),n}function AO(t){return La(t)||Fr(10,t),nC(t)}function nC(t){if(!Vs(t)||ym(t))return t;const e=t[Zn];let n;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,n=G0(t,e.scope_.immer_.useStrictShallowCopy_)}else n=G0(t,!0);return of(n,(r,s)=>{ZI(n,r,nC(s))}),e&&(e.finalized_=!1),n}var er=new RO,rC=er.produce;er.produceWithPatches.bind(er);er.setAutoFreeze.bind(er);er.setUseStrictShallowCopy.bind(er);er.applyPatches.bind(er);er.createDraft.bind(er);er.finishDraft.bind(er);function sC(t){return({dispatch:n,getState:r})=>s=>i=>typeof i=="function"?i(n,r,t):s(i)}var NO=sC(),PO=sC,FO=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?af:af.apply(null,arguments)};function Vb(t,e){function n(...r){if(e){let s=e(...r);if(!s)throw new Error(Ds(0));return{type:t,payload:s.payload,..."meta"in s&&{meta:s.meta},..."error"in s&&{error:s.error}}}return{type:t,payload:r[0]}}return n.toString=()=>`${t}`,n.type=t,n.match=r=>_O(r)&&r.type===t,n}var iC=class dc extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,dc.prototype)}static get[Symbol.species](){return dc}concat(...e){return super.concat.apply(this,e)}prepend(...e){return e.length===1&&Array.isArray(e[0])?new dc(...e[0].concat(this)):new dc(...e.concat(this))}};function Hb(t){return Vs(t)?rC(t,()=>{}):t}function Wb(t,e,n){return t.has(e)?t.get(e):t.set(e,n(e)).get(e)}function DO(t){return typeof t=="boolean"}var LO=()=>function(e){const{thunk:n=!0,immutableCheck:r=!0,serializableCheck:s=!0,actionCreatorCheck:i=!0}=e??{};let o=new iC;return n&&(DO(n)?o.push(NO):o.push(PO(n.extraArgument))),o},MO="RTK_autoBatch",qb=t=>e=>{setTimeout(e,t)},OO=(t={type:"raf"})=>e=>(...n)=>{const r=e(...n);let s=!0,i=!1,o=!1;const l=new Set,c=t.type==="tick"?queueMicrotask:t.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:qb(10):t.type==="callback"?t.queueNotification:qb(t.timeout),u=()=>{o=!1,i&&(i=!1,l.forEach(d=>d()))};return Object.assign({},r,{subscribe(d){const m=()=>s&&d(),p=r.subscribe(m);return l.add(d),()=>{p(),l.delete(d)}},dispatch(d){var m;try{return s=!((m=d==null?void 0:d.meta)!=null&&m[MO]),i=!s,i&&(o||(o=!0,c(u))),r.dispatch(d)}finally{s=!0}}})},$O=t=>function(n){const{autoBatch:r=!0}=n??{};let s=new iC(t);return r&&s.push(OO(typeof r=="object"?r:void 0)),s};function BO(t){const e=LO(),{reducer:n=void 0,middleware:r,devTools:s=!0,preloadedState:i=void 0,enhancers:o=void 0}=t||{};let l;if(typeof n=="function")l=n;else if(fv(n))l=vO(n);else throw new Error(Ds(1));let c;typeof r=="function"?c=r(e):c=e();let u=af;s&&(u=FO({trace:!1,...typeof s=="object"&&s}));const d=wO(...c),m=$O(d);let p=typeof o=="function"?o(m):m();const g=u(...p);return XI(l,i,g)}function aC(t){const e={},n=[];let r;const s={addCase(i,o){const l=typeof i=="string"?i:i.type;if(!l)throw new Error(Ds(28));if(l in e)throw new Error(Ds(29));return e[l]=o,s},addMatcher(i,o){return n.push({matcher:i,reducer:o}),s},addDefaultCase(i){return r=i,s}};return t(s),[e,n,r]}function zO(t){return typeof t=="function"}function UO(t,e){let[n,r,s]=aC(e),i;if(zO(t))i=()=>Hb(t());else{const l=Hb(t);i=()=>l}function o(l=i(),c){let u=[n[c.type],...r.filter(({matcher:d})=>d(c)).map(({reducer:d})=>d)];return u.filter(d=>!!d).length===0&&(u=[s]),u.reduce((d,m)=>{if(m)if(La(d)){const g=m(d,c);return g===void 0?d:g}else{if(Vs(d))return rC(d,p=>m(p,c));{const p=m(d,c);if(p===void 0){if(d===null)return d;throw Error("A case reducer on a non-draftable value must not return undefined")}return p}}return d},l)}return o.getInitialState=i,o}var VO=Symbol.for("rtk-slice-createasyncthunk");function HO(t,e){return`${t}/${e}`}function WO({creators:t}={}){var n;const e=(n=t==null?void 0:t.asyncThunk)==null?void 0:n[VO];return function(s){const{name:i,reducerPath:o=i}=s;if(!i)throw new Error(Ds(11));typeof process<"u";const l=(typeof s.reducers=="function"?s.reducers(GO()):s.reducers)||{},c=Object.keys(l),u={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},d={addCase(S,C){const D=typeof S=="string"?S:S.type;if(!D)throw new Error(Ds(12));if(D in u.sliceCaseReducersByType)throw new Error(Ds(13));return u.sliceCaseReducersByType[D]=C,d},addMatcher(S,C){return u.sliceMatchers.push({matcher:S,reducer:C}),d},exposeAction(S,C){return u.actionCreators[S]=C,d},exposeCaseReducer(S,C){return u.sliceCaseReducersByName[S]=C,d}};c.forEach(S=>{const C=l[S],D={reducerName:S,type:HO(i,S),createNotation:typeof s.reducers=="function"};KO(C)?YO(D,C,d,e):QO(D,C,d)});function m(){const[S={},C=[],D=void 0]=typeof s.extraReducers=="function"?aC(s.extraReducers):[s.extraReducers],F={...S,...u.sliceCaseReducersByType};return UO(s.initialState,I=>{for(let k in F)I.addCase(k,F[k]);for(let k of u.sliceMatchers)I.addMatcher(k.matcher,k.reducer);for(let k of C)I.addMatcher(k.matcher,k.reducer);D&&I.addDefaultCase(D)})}const p=S=>S,g=new Map;let y;function w(S,C){return y||(y=m()),y(S,C)}function _(){return y||(y=m()),y.getInitialState()}function E(S,C=!1){function D(I){let k=I[S];return typeof k>"u"&&C&&(k=_()),k}function F(I=p){const k=Wb(g,C,()=>new WeakMap);return Wb(k,I,()=>{const R={};for(const[j,N]of Object.entries(s.selectors??{}))R[j]=qO(N,I,_,C);return R})}return{reducerPath:S,getSelectors:F,get selectors(){return F(D)},selectSlice:D}}const b={name:i,reducer:w,actions:u.actionCreators,caseReducers:u.sliceCaseReducersByName,getInitialState:_,...E(o),injectInto(S,{reducerPath:C,...D}={}){const F=C??o;return S.inject({reducerPath:F,reducer:w},D),{...b,...E(F,!0)}}};return b}}function qO(t,e,n,r){function s(i,...o){let l=e(i);return typeof l>"u"&&r&&(l=n()),t(l,...o)}return s.unwrapped=t,s}var gv=WO();function GO(){function t(e,n){return{_reducerDefinitionType:"asyncThunk",payloadCreator:e,...n}}return t.withTypes=()=>t,{reducer(e){return Object.assign({[e.name](...n){return e(...n)}}[e.name],{_reducerDefinitionType:"reducer"})},preparedReducer(e,n){return{_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:n}},asyncThunk:t}}function QO({type:t,reducerName:e,createNotation:n},r,s){let i,o;if("reducer"in r){if(n&&!XO(r))throw new Error(Ds(17));i=r.reducer,o=r.prepare}else i=r;s.addCase(t,i).exposeCaseReducer(e,i).exposeAction(e,o?Vb(t,o):Vb(t))}function KO(t){return t._reducerDefinitionType==="asyncThunk"}function XO(t){return t._reducerDefinitionType==="reducerWithPrepare"}function YO({type:t,reducerName:e},n,r,s){if(!s)throw new Error(Ds(18));const{payloadCreator:i,fulfilled:o,pending:l,rejected:c,settled:u,options:d}=n,m=s(t,i,d);r.exposeAction(e,m),o&&r.addCase(m.fulfilled,o),l&&r.addCase(m.pending,l),c&&r.addCase(m.rejected,c),u&&r.addMatcher(m.settled,u),r.exposeCaseReducer(e,{fulfilled:o||Pd,pending:l||Pd,rejected:c||Pd,settled:u||Pd})}function Pd(){}function Ds(t){return`Minified Redux Toolkit error #${t}; visit https://redux-toolkit.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}const Gb={queueSongs:mn().queue||[],currentQueueId:null,currentSongData:null,isFetching:!1};function lg(t){for(let e=0;e<t.queueSongs.length;e++){const n=t.queueSongs[e];if(n.queue_id===t.currentQueueId){t.currentSongData={song:n,index:e};return}}t.currentSongData=null}const oC=gv({name:"songQueue",initialState:Gb,reducers:{setQueue(t,e){const n=e.payload.songs;t.queueSongs=n,lg(t),nt("queue",n)},setCurrentQueueId(t,e){const n=e.payload;t.currentQueueId=n,lg(t)},removeSongFromQueue(t,e){const{index:n}=e.payload;t.queueSongs.splice(n,1),nt("queue",t.queueSongs),t.currentSongData&&n<=t.currentSongData.index&&lg(t)},setIsFetchingRecommend(t,e){t.isFetching=e.payload},addSongToQueue:(t,e)=>{const n=e.payload.songs;t.queueSongs.push(...n),nt("queue",t.queueSongs)},resetSongQueue:t=>{nt("queue",[]),Object.assign(t,Gb)}}}),ze=t=>t.songQueue,{addSongToQueue:vm,setCurrentQueueId:ds,removeSongFromQueue:JO,setQueue:ZO,resetSongQueue:e9,setIsFetchingRecommend:Qb}=oC.actions,t9=oC.reducer;function vl({className:t="",playlists:e,loading:n}){const{currentSongData:r}=se(ze),s=()=>e.length?e.map((i,o)=>{const l=r==null?void 0:r.song.queue_id.includes(i.id);return a.jsx("div",{className:"p-2 w-1/2 md:w-1/4",children:a.jsx(dv,{active:l,data:i})},o)}):a.jsx(Xe,{className:"mx-auto"});return a.jsx(a.Fragment,{children:a.jsxs("div",{className:`flex flex-row flex-wrap -mx-[8px] ${t}`,children:[n&&lv,!n&&s()]})})}function ys({setTab:t,render:e,tab:n,tabs:r,className:s=""}){const{theme:i}=q(),o={inActiveTab:` hover:bg-${i.alpha}`,activeTab:`${i.content_bg}`};return a.jsx("div",{className:`bg-${i.alpha} p-1.5 space-x-1 rounded-full ${s}`,children:r.map((l,c)=>a.jsx(ie,{size:"clear",onClick:u=>{t(l),u.target.blur()},className:`py-1 px-4 ${l===n?o.activeTab:o.inActiveTab}`,children:e(l)},c))})}function n9({user:t},e){return e?a.jsx("p",{className:"text-xl mb-4 ml-2",ref:e,children:t.display_name}):a.jsx("p",{className:"text-xl mb-4 ml-2",children:t.display_name})}f.forwardRef(n9);function lC(){const{theme:t}=q(),{playerConig:{isCrossFade:e,isEnableBeat:n,lyricSize:r,songBackground:s},updatePlayerConfig:i,audioRef:o,shouldSyncSongDuration:l}=ct(),{currentSongData:c}=se(ze),u=p=>{i({lyricSize:p}),nt("lyricSize",p)},d=()=>{if(!o.current||!(c!=null&&c.song))return;const p=!n,g=o.current.currentTime;nt("current_time",g),l.current=!0,o.current.src=p?c.song.beat_url:c.song.song_url,i({isEnableBeat:p})},m={disableBtn:"bg-white/10 bg-opacity-20",lyricSizeBtn:`group/text justify-center !hover:brightness-100 font-[600] h-[30px] w-[30px] sm:h-[26px] sm:w-[26px] relative ${t.content_hover_bg}`,itemContainer:"flex justify-between  px-3 py-2 items-center min-h-[30px] hover:bg-[#fff]/5",text:"text-sm"};return a.jsx(a.Fragment,{children:a.jsx("div",{className:"w-[240px] sm:w-[220px]",children:a.jsxs(ei,{p:"clear",className:"text-white py-3",theme:t,children:[a.jsxs("div",{className:`${m.itemContainer}`,children:[a.jsx("p",{className:m.text,children:"Lyric size"}),a.jsxs("div",{className:"flex space-x-[8px]",children:[a.jsx(ie,{onClick:()=>u("small"),variant:"circle",size:"clear",className:`${r==="small"?t.content_bg:m.disableBtn} ${m.lyricSizeBtn}`,children:a.jsx("span",{className:"leading-[1] text-[11px]",children:"A"})}),a.jsx(ie,{onClick:()=>u("medium"),variant:"circle",size:"clear",className:`${r==="medium"?t.content_bg:m.disableBtn} ${m.lyricSizeBtn}`,children:a.jsx("span",{className:"leading-[1] text-[13px]",children:"A"})}),a.jsx(ie,{onClick:()=>u("large"),variant:"circle",size:"clear",className:`${r==="large"?t.content_bg:m.disableBtn} ${m.lyricSizeBtn}`,children:a.jsx("span",{className:"leading-[1] text-[15px]",children:"A"})})]})]}),a.jsxs("div",{className:`${m.itemContainer}`,children:[a.jsx("p",{className:m.text,children:"Song background"}),a.jsx(gh,{size:"thin",active:s,cb:()=>i({songBackground:!s})})]}),(c==null?void 0:c.song.beat_url)&&a.jsxs("div",{className:`${m.itemContainer}`,children:[a.jsx("p",{className:m.text,children:"Song beat"}),a.jsx(gh,{size:"thin",active:n,cb:d})]}),a.jsxs("div",{className:`${m.itemContainer}`,children:[a.jsx("p",{className:m.text,children:"Cross fade"}),a.jsx(gh,{size:"thin",active:e,cb:()=>i({isCrossFade:!e})})]})]})})})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cC=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},r9=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],l=t[n++],c=((s&7)<<18|(i&63)<<12|(o&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},uC={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,l=o?t[s+1]:0,c=s+2<t.length,u=c?t[s+2]:0,d=i>>2,m=(i&3)<<4|l>>4;let p=(l&15)<<2|u>>6,g=u&63;c||(g=64,o||(p=64)),r.push(n[d],n[m],n[p],n[g])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(cC(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):r9(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],l=s<t.length?n[t.charAt(s)]:0;++s;const u=s<t.length?n[t.charAt(s)]:64;++s;const m=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||l==null||u==null||m==null)throw new s9;const p=i<<2|l>>4;if(r.push(p),u!==64){const g=l<<4&240|u>>2;if(r.push(g),m!==64){const y=u<<6&192|m;r.push(y)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class s9 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const i9=function(t){const e=cC(t);return uC.encodeByteArray(e,!0)},uf=function(t){return i9(t).replace(/\./g,"")},dC=function(t){try{return uC.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a9(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o9=()=>a9().__FIREBASE_DEFAULTS__,l9=()=>{if(typeof process>"u"||typeof process.env>"u")return;const t={}.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},c9=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&dC(t[1]);return e&&JSON.parse(e)},wm=()=>{try{return o9()||l9()||c9()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},hC=t=>{var e,n;return(n=(e=wm())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},fC=t=>{const e=hC(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},mC=()=>{var t;return(t=wm())===null||t===void 0?void 0:t.config},pC=t=>{var e;return(e=wm())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u9{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gC(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t),l="";return[uf(JSON.stringify(n)),uf(JSON.stringify(o)),l].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function an(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function d9(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(an())}function h9(){var t;const e=(t=wm())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function f9(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function m9(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function p9(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function g9(){const t=an();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function x9(){return!h9()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function y9(){try{return typeof indexedDB=="object"}catch{return!1}}function v9(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w9="FirebaseError";class vs extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=w9,Object.setPrototypeOf(this,vs.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Nu.prototype.create)}}class Nu{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?_9(i,r):"Error",l=`${this.serviceName}: ${o} (${s}).`;return new vs(s,l,r)}}function _9(t,e){return t.replace(b9,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const b9=/\{\$([^}]+)}/g;function S9(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function df(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(Kb(i)&&Kb(o)){if(!df(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function Kb(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pu(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function E9(t,e){const n=new k9(t,e);return n.subscribe.bind(n)}class k9{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");T9(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=cg),s.error===void 0&&(s.error=cg),s.complete===void 0&&(s.complete=cg);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function T9(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function cg(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function et(t){return t&&t._delegate?t._delegate:t}class Vi{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ga="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I9{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new u9;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(j9(e))try{this.getOrInitializeService({instanceIdentifier:ga})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=ga){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ga){return this.instances.has(e)}getOptions(e=ga){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);r===l&&o.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:C9(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=ga){return this.component?this.component.multipleInstances?e:ga:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function C9(t){return t===ga?void 0:t}function j9(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R9{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new I9(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ce;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Ce||(Ce={}));const A9={debug:Ce.DEBUG,verbose:Ce.VERBOSE,info:Ce.INFO,warn:Ce.WARN,error:Ce.ERROR,silent:Ce.SILENT},N9=Ce.INFO,P9={[Ce.DEBUG]:"log",[Ce.VERBOSE]:"log",[Ce.INFO]:"info",[Ce.WARN]:"warn",[Ce.ERROR]:"error"},F9=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=P9[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class xv{constructor(e){this.name=e,this._logLevel=N9,this._logHandler=F9,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ce))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?A9[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ce.DEBUG,...e),this._logHandler(this,Ce.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ce.VERBOSE,...e),this._logHandler(this,Ce.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ce.INFO,...e),this._logHandler(this,Ce.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ce.WARN,...e),this._logHandler(this,Ce.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ce.ERROR,...e),this._logHandler(this,Ce.ERROR,...e)}}const D9=(t,e)=>e.some(n=>t instanceof n);let Xb,Yb;function L9(){return Xb||(Xb=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function M9(){return Yb||(Yb=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const xC=new WeakMap,J0=new WeakMap,yC=new WeakMap,ug=new WeakMap,yv=new WeakMap;function O9(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(Mi(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&xC.set(n,t)}).catch(()=>{}),yv.set(e,t),e}function $9(t){if(J0.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});J0.set(t,e)}let Z0={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return J0.get(t);if(e==="objectStoreNames")return t.objectStoreNames||yC.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Mi(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function B9(t){Z0=t(Z0)}function z9(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(dg(this),e,...n);return yC.set(r,e.sort?e.sort():[e]),Mi(r)}:M9().includes(t)?function(...e){return t.apply(dg(this),e),Mi(xC.get(this))}:function(...e){return Mi(t.apply(dg(this),e))}}function U9(t){return typeof t=="function"?z9(t):(t instanceof IDBTransaction&&$9(t),D9(t,L9())?new Proxy(t,Z0):t)}function Mi(t){if(t instanceof IDBRequest)return O9(t);if(ug.has(t))return ug.get(t);const e=U9(t);return e!==t&&(ug.set(t,e),yv.set(e,t)),e}const dg=t=>yv.get(t);function V9(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),l=Mi(o);return r&&o.addEventListener("upgradeneeded",c=>{r(Mi(o.result),c.oldVersion,c.newVersion,Mi(o.transaction),c)}),n&&o.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),l.then(c=>{i&&c.addEventListener("close",()=>i()),s&&c.addEventListener("versionchange",u=>s(u.oldVersion,u.newVersion,u))}).catch(()=>{}),l}const H9=["get","getKey","getAll","getAllKeys","count"],W9=["put","add","delete","clear"],hg=new Map;function Jb(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(hg.get(e))return hg.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=W9.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||H9.includes(n)))return;const i=async function(o,...l){const c=this.transaction(o,s?"readwrite":"readonly");let u=c.store;return r&&(u=u.index(l.shift())),(await Promise.all([u[n](...l),s&&c.done]))[0]};return hg.set(e,i),i}B9(t=>({...t,get:(e,n,r)=>Jb(e,n)||t.get(e,n,r),has:(e,n)=>!!Jb(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q9{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(G9(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function G9(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const ex="@firebase/app",Zb="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hs=new xv("@firebase/app"),Q9="@firebase/app-compat",K9="@firebase/analytics-compat",X9="@firebase/analytics",Y9="@firebase/app-check-compat",J9="@firebase/app-check",Z9="@firebase/auth",e$="@firebase/auth-compat",t$="@firebase/database",n$="@firebase/data-connect",r$="@firebase/database-compat",s$="@firebase/functions",i$="@firebase/functions-compat",a$="@firebase/installations",o$="@firebase/installations-compat",l$="@firebase/messaging",c$="@firebase/messaging-compat",u$="@firebase/performance",d$="@firebase/performance-compat",h$="@firebase/remote-config",f$="@firebase/remote-config-compat",m$="@firebase/storage",p$="@firebase/storage-compat",g$="@firebase/firestore",x$="@firebase/vertexai-preview",y$="@firebase/firestore-compat",v$="firebase",w$="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tx="[DEFAULT]",_$={[ex]:"fire-core",[Q9]:"fire-core-compat",[X9]:"fire-analytics",[K9]:"fire-analytics-compat",[J9]:"fire-app-check",[Y9]:"fire-app-check-compat",[Z9]:"fire-auth",[e$]:"fire-auth-compat",[t$]:"fire-rtdb",[n$]:"fire-data-connect",[r$]:"fire-rtdb-compat",[s$]:"fire-fn",[i$]:"fire-fn-compat",[a$]:"fire-iid",[o$]:"fire-iid-compat",[l$]:"fire-fcm",[c$]:"fire-fcm-compat",[u$]:"fire-perf",[d$]:"fire-perf-compat",[h$]:"fire-rc",[f$]:"fire-rc-compat",[m$]:"fire-gcs",[p$]:"fire-gcs-compat",[g$]:"fire-fst",[y$]:"fire-fst-compat",[x$]:"fire-vertex","fire-js":"fire-js",[v$]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hf=new Map,b$=new Map,nx=new Map;function eS(t,e){try{t.container.addComponent(e)}catch(n){Hs.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Oa(t){const e=t.name;if(nx.has(e))return Hs.debug(`There were multiple attempts to register component ${e}.`),!1;nx.set(e,t);for(const n of hf.values())eS(n,t);for(const n of b$.values())eS(n,t);return!0}function _m(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function js(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S$={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Oi=new Nu("app","Firebase",S$);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E${constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Vi("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Oi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eo=w$;function vC(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:tx,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw Oi.create("bad-app-name",{appName:String(s)});if(n||(n=mC()),!n)throw Oi.create("no-options");const i=hf.get(s);if(i){if(df(n,i.options)&&df(r,i.config))return i;throw Oi.create("duplicate-app",{appName:s})}const o=new R9(s);for(const c of nx.values())o.addComponent(c);const l=new E$(n,r,o);return hf.set(s,l),l}function vv(t=tx){const e=hf.get(t);if(!e&&t===tx&&mC())return vC();if(!e)throw Oi.create("no-app",{appName:t});return e}function as(t,e,n){var r;let s=(r=_$[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const l=[`Unable to register library "${s}" with version "${e}":`];i&&l.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Hs.warn(l.join(" "));return}Oa(new Vi(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k$="firebase-heartbeat-database",T$=1,nu="firebase-heartbeat-store";let fg=null;function wC(){return fg||(fg=V9(k$,T$,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(nu)}catch(n){console.warn(n)}}}}).catch(t=>{throw Oi.create("idb-open",{originalErrorMessage:t.message})})),fg}async function I$(t){try{const n=(await wC()).transaction(nu),r=await n.objectStore(nu).get(_C(t));return await n.done,r}catch(e){if(e instanceof vs)Hs.warn(e.message);else{const n=Oi.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Hs.warn(n.message)}}}async function tS(t,e){try{const r=(await wC()).transaction(nu,"readwrite");await r.objectStore(nu).put(e,_C(t)),await r.done}catch(n){if(n instanceof vs)Hs.warn(n.message);else{const r=Oi.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Hs.warn(r.message)}}}function _C(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C$=1024,j$=30*24*60*60*1e3;class R${constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new N$(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=nS();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const l=new Date(o.date).valueOf();return Date.now()-l<=j$}),this._storage.overwrite(this._heartbeatsCache))}catch(r){Hs.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=nS(),{heartbeatsToSend:r,unsentEntries:s}=A$(this._heartbeatsCache.heartbeats),i=uf(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return Hs.warn(n),""}}}function nS(){return new Date().toISOString().substring(0,10)}function A$(t,e=C$){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),rS(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),rS(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class N${constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return y9()?v9().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await I$(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return tS(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return tS(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function rS(t){return uf(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P$(t){Oa(new Vi("platform-logger",e=>new q9(e),"PRIVATE")),Oa(new Vi("heartbeat",e=>new R$(e),"PRIVATE")),as(ex,Zb,t),as(ex,Zb,"esm2017"),as("fire-js","")}P$("");function wv(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function bC(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const F$=bC,SC=new Nu("auth","Firebase",bC());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ff=new xv("@firebase/auth");function D$(t,...e){ff.logLevel<=Ce.WARN&&ff.warn(`Auth (${eo}): ${t}`,...e)}function xh(t,...e){ff.logLevel<=Ce.ERROR&&ff.error(`Auth (${eo}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hs(t,...e){throw bv(t,...e)}function Br(t,...e){return bv(t,...e)}function _v(t,e,n){const r=Object.assign(Object.assign({},F$()),{[e]:n});return new Nu("auth","Firebase",r).create(e,{appName:t.name})}function Ia(t){return _v(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function L$(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&hs(t,"argument-error"),_v(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function bv(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return SC.create(t,...e)}function ae(t,e,...n){if(!t)throw bv(e,...n)}function Rs(t){const e="INTERNAL ASSERTION FAILED: "+t;throw xh(e),new Error(e)}function Ws(t,e){t||Rs(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rx(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function M$(){return sS()==="http:"||sS()==="https:"}function sS(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O$(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(M$()||m9()||"connection"in navigator)?navigator.onLine:!0}function $$(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fu{constructor(e,n){this.shortDelay=e,this.longDelay=n,Ws(n>e,"Short delay should be less than long delay!"),this.isMobile=d9()||p9()}get(){return O$()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sv(t,e){Ws(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EC{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Rs("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Rs("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Rs("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B$={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z$=new Fu(3e4,6e4);function Ev(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function wl(t,e,n,r,s={}){return kC(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const l=Pu(Object.assign({key:t.config.apiKey},o)).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const u=Object.assign({method:e,headers:c},i);return f9()||(u.referrerPolicy="no-referrer"),EC.fetch()(TC(t,t.config.apiHost,n,l),u)})}async function kC(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},B$),e);try{const s=new V$(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw Fd(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const l=i.ok?o.errorMessage:o.error.message,[c,u]=l.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Fd(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw Fd(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw Fd(t,"user-disabled",o);const d=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw _v(t,d,u);hs(t,d)}}catch(s){if(s instanceof vs)throw s;hs(t,"network-request-failed",{message:String(s)})}}async function U$(t,e,n,r,s={}){const i=await wl(t,e,n,r,s);return"mfaPendingCredential"in i&&hs(t,"multi-factor-auth-required",{_serverResponse:i}),i}function TC(t,e,n,r){const s=`${e}${n}?${r}`;return t.config.emulator?Sv(t.config,s):`${t.config.apiScheme}://${s}`}class V${constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Br(this.auth,"network-request-failed")),z$.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Fd(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=Br(t,e,r);return s.customData._tokenResponse=n,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function H$(t,e){return wl(t,"POST","/v1/accounts:delete",e)}async function IC(t,e){return wl(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kc(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function W$(t,e=!1){const n=et(t),r=await n.getIdToken(e),s=kv(r);ae(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:kc(mg(s.auth_time)),issuedAtTime:kc(mg(s.iat)),expirationTime:kc(mg(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function mg(t){return Number(t)*1e3}function kv(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return xh("JWT malformed, contained fewer than 3 sections"),null;try{const s=dC(n);return s?JSON.parse(s):(xh("Failed to decode base64 JWT payload"),null)}catch(s){return xh("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function iS(t){const e=kv(t);return ae(e,"internal-error"),ae(typeof e.exp<"u","internal-error"),ae(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ru(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof vs&&q$(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function q$({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G${constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sx{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=kc(this.lastLoginAt),this.creationTime=kc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mf(t){var e;const n=t.auth,r=await t.getIdToken(),s=await ru(t,IC(n,{idToken:r}));ae(s==null?void 0:s.users.length,n,"internal-error");const i=s.users[0];t._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?CC(i.providerUserInfo):[],l=K$(t.providerData,o),c=t.isAnonymous,u=!(t.email&&i.passwordHash)&&!(l!=null&&l.length),d=c?u:!1,m={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:l,metadata:new sx(i.createdAt,i.lastLoginAt),isAnonymous:d};Object.assign(t,m)}async function Q$(t){const e=et(t);await mf(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function K$(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function CC(t){return t.map(e=>{var{providerId:n}=e,r=wv(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function X$(t,e){const n=await kC(t,{},async()=>{const r=Pu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=TC(t,s,"/v1/token",`key=${i}`),l=await t._getAdditionalHeaders();return l["Content-Type"]="application/x-www-form-urlencoded",EC.fetch()(o,{method:"POST",headers:l,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function Y$(t,e){return wl(t,"POST","/v2/accounts:revokeToken",Ev(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bo{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ae(e.idToken,"internal-error"),ae(typeof e.idToken<"u","internal-error"),ae(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):iS(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){ae(e.length!==0,"internal-error");const n=iS(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(ae(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await X$(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new Bo;return r&&(ae(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(ae(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(ae(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Bo,this.toJSON())}_performRefresh(){return Rs("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hi(t,e){ae(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class As{constructor(e){var{uid:n,auth:r,stsTokenManager:s}=e,i=wv(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new G$(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new sx(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await ru(this,this.stsTokenManager.getToken(this.auth,e));return ae(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return W$(this,e)}reload(){return Q$(this)}_assign(e){this!==e&&(ae(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new As(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){ae(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await mf(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(js(this.auth.app))return Promise.reject(Ia(this.auth));const e=await this.getIdToken();return await ru(this,H$(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,s,i,o,l,c,u,d;const m=(r=n.displayName)!==null&&r!==void 0?r:void 0,p=(s=n.email)!==null&&s!==void 0?s:void 0,g=(i=n.phoneNumber)!==null&&i!==void 0?i:void 0,y=(o=n.photoURL)!==null&&o!==void 0?o:void 0,w=(l=n.tenantId)!==null&&l!==void 0?l:void 0,_=(c=n._redirectEventId)!==null&&c!==void 0?c:void 0,E=(u=n.createdAt)!==null&&u!==void 0?u:void 0,b=(d=n.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:S,emailVerified:C,isAnonymous:D,providerData:F,stsTokenManager:I}=n;ae(S&&I,e,"internal-error");const k=Bo.fromJSON(this.name,I);ae(typeof S=="string",e,"internal-error"),hi(m,e.name),hi(p,e.name),ae(typeof C=="boolean",e,"internal-error"),ae(typeof D=="boolean",e,"internal-error"),hi(g,e.name),hi(y,e.name),hi(w,e.name),hi(_,e.name),hi(E,e.name),hi(b,e.name);const R=new As({uid:S,auth:e,email:p,emailVerified:C,displayName:m,isAnonymous:D,photoURL:y,phoneNumber:g,tenantId:w,stsTokenManager:k,createdAt:E,lastLoginAt:b});return F&&Array.isArray(F)&&(R.providerData=F.map(j=>Object.assign({},j))),_&&(R._redirectEventId=_),R}static async _fromIdTokenResponse(e,n,r=!1){const s=new Bo;s.updateFromServerResponse(n);const i=new As({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await mf(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];ae(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?CC(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),l=new Bo;l.updateFromIdToken(r);const c=new As({uid:s.localId,auth:e,stsTokenManager:l,isAnonymous:o}),u={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new sx(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(c,u),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aS=new Map;function Ns(t){Ws(t instanceof Function,"Expected a class definition");let e=aS.get(t);return e?(Ws(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,aS.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jC{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}jC.type="NONE";const oS=jC;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yh(t,e,n){return`firebase:${t}:${e}:${n}`}class zo{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=yh(this.userKey,s.apiKey,i),this.fullPersistenceKey=yh("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?As._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new zo(Ns(oS),e,r);const s=(await Promise.all(n.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let i=s[0]||Ns(oS);const o=yh(r,e.config.apiKey,e.name);let l=null;for(const u of n)try{const d=await u._get(o);if(d){const m=As._fromJSON(e,d);u!==i&&(l=m),i=u;break}}catch{}const c=s.filter(u=>u._shouldAllowMigration);return!i._shouldAllowMigration||!c.length?new zo(i,e,r):(i=c[0],l&&await i._set(o,l.toJSON()),await Promise.all(n.map(async u=>{if(u!==i)try{await u._remove(o)}catch{}})),new zo(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lS(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(PC(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(RC(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(DC(e))return"Blackberry";if(LC(e))return"Webos";if(AC(e))return"Safari";if((e.includes("chrome/")||NC(e))&&!e.includes("edge/"))return"Chrome";if(FC(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function RC(t=an()){return/firefox\//i.test(t)}function AC(t=an()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function NC(t=an()){return/crios\//i.test(t)}function PC(t=an()){return/iemobile/i.test(t)}function FC(t=an()){return/android/i.test(t)}function DC(t=an()){return/blackberry/i.test(t)}function LC(t=an()){return/webos/i.test(t)}function Tv(t=an()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function J$(t=an()){var e;return Tv(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function Z$(){return g9()&&document.documentMode===10}function MC(t=an()){return Tv(t)||FC(t)||LC(t)||DC(t)||/windows phone/i.test(t)||PC(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OC(t,e=[]){let n;switch(t){case"Browser":n=lS(an());break;case"Worker":n=`${lS(an())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${eo}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e7{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,l)=>{try{const c=e(i);o(c)}catch(c){l(c)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function t7(t,e={}){return wl(t,"GET","/v2/passwordPolicy",Ev(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n7=6;class r7{constructor(e){var n,r,s,i;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:n7,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,s,i,o,l;const c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(n=c.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),c.isValid&&(c.isValid=(r=c.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(s=c.containsLowercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(i=c.containsUppercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(l=c.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),c}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s7{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new cS(this),this.idTokenSubscription=new cS(this),this.beforeStateQueue=new e7(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=SC,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Ns(n)),this._initializationPromise=this.queue(async()=>{var r,s;if(!this._deleted&&(this.persistenceManager=await zo.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await IC(this,{idToken:e}),r=await As._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(js(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let s=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,l=s==null?void 0:s._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===l)&&(c!=null&&c.user)&&(s=c.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return ae(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await mf(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=$$()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(js(this.app))return Promise.reject(Ia(this));const n=e?et(e):null;return n&&ae(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&ae(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return js(this.app)?Promise.reject(Ia(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return js(this.app)?Promise.reject(Ia(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ns(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await t7(this),n=new r7(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Nu("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await Y$(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Ns(e)||this._popupRedirectResolver;ae(n,this,"argument-error"),this.redirectPersistenceManager=await zo.create(this,[Ns(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(ae(l,this,"internal-error"),l.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const c=e.addObserver(n,r,s);return()=>{o=!0,c()}}else{const c=e.addObserver(n);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ae(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=OC(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(n["X-Firebase-AppCheck"]=s),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&D$(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function bm(t){return et(t)}class cS{constructor(e){this.auth=e,this.observer=null,this.addObserver=E9(n=>this.observer=n)}get next(){return ae(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Iv={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function i7(t){Iv=t}function a7(t){return Iv.loadJS(t)}function o7(){return Iv.gapiScript}function l7(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c7(t,e){const n=_m(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(df(i,e??{}))return s;hs(s,"already-initialized")}return n.initialize({options:e})}function u7(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Ns);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function d7(t,e,n){const r=bm(t);ae(r._canInitEmulator,r,"emulator-config-failed"),ae(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!!(n!=null&&n.disableWarnings),i=$C(e),{host:o,port:l}=h7(e),c=l===null?"":`:${l}`;r.config.emulator={url:`${i}//${o}${c}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:l,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),s||f7()}function $C(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function h7(t){const e=$C(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:uS(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:uS(o)}}}function uS(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function f7(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BC{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Rs("not implemented")}_getIdTokenResponse(e){return Rs("not implemented")}_linkToIdToken(e,n){return Rs("not implemented")}_getReauthenticationResolver(e){return Rs("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Uo(t,e){return U$(t,"POST","/v1/accounts:signInWithIdp",Ev(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m7="http://localhost";class $a extends BC{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new $a(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):hs("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=n,i=wv(n,["providerId","signInMethod"]);if(!r||!s)return null;const o=new $a(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return Uo(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Uo(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Uo(e,n)}buildRequest(){const e={requestUri:m7,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Pu(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cv{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Du extends Cv{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yi extends Du{constructor(){super("facebook.com")}static credential(e){return $a._fromParams({providerId:yi.PROVIDER_ID,signInMethod:yi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return yi.credentialFromTaggedObject(e)}static credentialFromError(e){return yi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return yi.credential(e.oauthAccessToken)}catch{return null}}}yi.FACEBOOK_SIGN_IN_METHOD="facebook.com";yi.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ts extends Du{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return $a._fromParams({providerId:Ts.PROVIDER_ID,signInMethod:Ts.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Ts.credentialFromTaggedObject(e)}static credentialFromError(e){return Ts.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Ts.credential(n,r)}catch{return null}}}Ts.GOOGLE_SIGN_IN_METHOD="google.com";Ts.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vi extends Du{constructor(){super("github.com")}static credential(e){return $a._fromParams({providerId:vi.PROVIDER_ID,signInMethod:vi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return vi.credentialFromTaggedObject(e)}static credentialFromError(e){return vi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return vi.credential(e.oauthAccessToken)}catch{return null}}}vi.GITHUB_SIGN_IN_METHOD="github.com";vi.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wi extends Du{constructor(){super("twitter.com")}static credential(e,n){return $a._fromParams({providerId:wi.PROVIDER_ID,signInMethod:wi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return wi.credentialFromTaggedObject(e)}static credentialFromError(e){return wi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return wi.credential(n,r)}catch{return null}}}wi.TWITTER_SIGN_IN_METHOD="twitter.com";wi.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jo{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await As._fromIdTokenResponse(e,r,s),o=dS(r);return new Jo({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=dS(r);return new Jo({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function dS(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pf extends vs{constructor(e,n,r,s){var i;super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,pf.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new pf(e,n,r,s)}}function zC(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?pf._fromErrorAndOperation(t,i,e,r):i})}async function p7(t,e,n=!1){const r=await ru(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Jo._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function g7(t,e,n=!1){const{auth:r}=t;if(js(r.app))return Promise.reject(Ia(r));const s="reauthenticate";try{const i=await ru(t,zC(r,s,e,t),n);ae(i.idToken,r,"internal-error");const o=kv(i.idToken);ae(o,r,"internal-error");const{sub:l}=o;return ae(t.uid===l,r,"user-mismatch"),Jo._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&hs(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function x7(t,e,n=!1){if(js(t.app))return Promise.reject(Ia(t));const r="signIn",s=await zC(t,r,e),i=await Jo._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}function y7(t,e,n,r){return et(t).onIdTokenChanged(e,n,r)}function v7(t,e,n){return et(t).beforeAuthStateChanged(e,n)}function w7(t,e,n,r){return et(t).onAuthStateChanged(e,n,r)}function UC(t){return et(t).signOut()}const gf="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VC{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(gf,"1"),this.storage.removeItem(gf),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _7=1e3,b7=10;class HC extends VC{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=MC(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,l,c)=>{this.notifyListeners(o,c)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);Z$()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,b7):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},_7)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}HC.type="LOCAL";const S7=HC;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WC extends VC{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}WC.type="SESSION";const qC=WC;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E7(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sm{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new Sm(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const l=Array.from(o).map(async u=>u(n.origin,i)),c=await E7(l);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:c})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Sm.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jv(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k7{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((l,c)=>{const u=jv("",20);s.port1.start();const d=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(m){const p=m;if(p.data.eventId===u)switch(p.data.status){case"ack":clearTimeout(d),i=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),l(p.data.response);break;default:clearTimeout(d),clearTimeout(i),c(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function os(){return window}function T7(t){os().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GC(){return typeof os().WorkerGlobalScope<"u"&&typeof os().importScripts=="function"}async function I7(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function C7(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function j7(){return GC()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QC="firebaseLocalStorageDb",R7=1,xf="firebaseLocalStorage",KC="fbase_key";class Lu{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Em(t,e){return t.transaction([xf],e?"readwrite":"readonly").objectStore(xf)}function A7(){const t=indexedDB.deleteDatabase(QC);return new Lu(t).toPromise()}function ix(){const t=indexedDB.open(QC,R7);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(xf,{keyPath:KC})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(xf)?e(r):(r.close(),await A7(),e(await ix()))})})}async function hS(t,e,n){const r=Em(t,!0).put({[KC]:e,value:n});return new Lu(r).toPromise()}async function N7(t,e){const n=Em(t,!1).get(e),r=await new Lu(n).toPromise();return r===void 0?null:r.value}function fS(t,e){const n=Em(t,!0).delete(e);return new Lu(n).toPromise()}const P7=800,F7=3;class XC{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await ix(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>F7)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return GC()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Sm._getInstance(j7()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await I7(),!this.activeServiceWorker)return;this.sender=new k7(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||C7()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await ix();return await hS(e,gf,"1"),await fS(e,gf),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>hS(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>N7(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>fS(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=Em(s,!1).getAll();return new Lu(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),P7)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}XC.type="LOCAL";const D7=XC;new Fu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YC(t,e){return e?Ns(e):(ae(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rv extends BC{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Uo(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Uo(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Uo(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function L7(t){return x7(t.auth,new Rv(t),t.bypassAuthState)}function M7(t){const{auth:e,user:n}=t;return ae(n,e,"internal-error"),g7(n,new Rv(t),t.bypassAuthState)}async function O7(t){const{auth:e,user:n}=t;return ae(n,e,"internal-error"),p7(n,new Rv(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JC{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:l}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(c))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return L7;case"linkViaPopup":case"linkViaRedirect":return O7;case"reauthViaPopup":case"reauthViaRedirect":return M7;default:hs(this.auth,"internal-error")}}resolve(e){Ws(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ws(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $7=new Fu(2e3,1e4);async function B7(t,e,n){if(js(t.app))return Promise.reject(Br(t,"operation-not-supported-in-this-environment"));const r=bm(t);L$(t,e,Cv);const s=YC(r,n);return new Sa(r,"signInViaPopup",e,s).executeNotNull()}class Sa extends JC{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,Sa.currentPopupAction&&Sa.currentPopupAction.cancel(),Sa.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ae(e,this.auth,"internal-error"),e}async onExecution(){Ws(this.filter.length===1,"Popup operations only handle one event");const e=jv();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Br(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Br(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Sa.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Br(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,$7.get())};e()}}Sa.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z7="pendingRedirect",vh=new Map;class U7 extends JC{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=vh.get(this.auth._key());if(!e){try{const r=await V7(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}vh.set(this.auth._key(),e)}return this.bypassAuthState||vh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function V7(t,e){const n=q7(e),r=W7(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function H7(t,e){vh.set(t._key(),e)}function W7(t){return Ns(t._redirectPersistence)}function q7(t){return yh(z7,t.config.apiKey,t.name)}async function G7(t,e,n=!1){if(js(t.app))return Promise.reject(Ia(t));const r=bm(t),s=YC(r,e),o=await new U7(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q7=10*60*1e3;class K7{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!X7(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!ZC(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(Br(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Q7&&this.cachedEventUids.clear(),this.cachedEventUids.has(mS(e))}saveEventToCache(e){this.cachedEventUids.add(mS(e)),this.lastProcessedEventTime=Date.now()}}function mS(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function ZC({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function X7(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return ZC(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Y7(t,e={}){return wl(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J7=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Z7=/^https?/;async function e8(t){if(t.config.emulator)return;const{authorizedDomains:e}=await Y7(t);for(const n of e)try{if(t8(n))return}catch{}hs(t,"unauthorized-domain")}function t8(t){const e=rx(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!Z7.test(n))return!1;if(J7.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n8=new Fu(3e4,6e4);function pS(){const t=os().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function r8(t){return new Promise((e,n)=>{var r,s,i;function o(){pS(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{pS(),n(Br(t,"network-request-failed"))},timeout:n8.get()})}if(!((s=(r=os().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=os().gapi)===null||i===void 0)&&i.load)o();else{const l=l7("iframefcb");return os()[l]=()=>{gapi.load?o():n(Br(t,"network-request-failed"))},a7(`${o7()}?onload=${l}`).catch(c=>n(c))}}).catch(e=>{throw wh=null,e})}let wh=null;function s8(t){return wh=wh||r8(t),wh}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i8=new Fu(5e3,15e3),a8="__/auth/iframe",o8="emulator/auth/iframe",l8={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},c8=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function u8(t){const e=t.config;ae(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Sv(e,o8):`https://${t.config.authDomain}/${a8}`,r={apiKey:e.apiKey,appName:t.name,v:eo},s=c8.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${Pu(r).slice(1)}`}async function d8(t){const e=await s8(t),n=os().gapi;return ae(n,t,"internal-error"),e.open({where:document.body,url:u8(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:l8,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=Br(t,"network-request-failed"),l=os().setTimeout(()=>{i(o)},i8.get());function c(){os().clearTimeout(l),s(r)}r.ping(c).then(c,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h8={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},f8=500,m8=600,p8="_blank",g8="http://localhost";class gS{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function x8(t,e,n,r=f8,s=m8){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const c=Object.assign(Object.assign({},h8),{width:r.toString(),height:s.toString(),top:i,left:o}),u=an().toLowerCase();n&&(l=NC(u)?p8:n),RC(u)&&(e=e||g8,c.scrollbars="yes");const d=Object.entries(c).reduce((p,[g,y])=>`${p}${g}=${y},`,"");if(J$(u)&&l!=="_self")return y8(e||"",l),new gS(null);const m=window.open(e||"",l,d);ae(m,t,"popup-blocked");try{m.focus()}catch{}return new gS(m)}function y8(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v8="__/auth/handler",w8="emulator/auth/handler",_8=encodeURIComponent("fac");async function xS(t,e,n,r,s,i){ae(t.config.authDomain,t,"auth-domain-config-required"),ae(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:eo,eventId:s};if(e instanceof Cv){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",S9(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,m]of Object.entries(i||{}))o[d]=m}if(e instanceof Du){const d=e.getScopes().filter(m=>m!=="");d.length>0&&(o.scopes=d.join(","))}t.tenantId&&(o.tid=t.tenantId);const l=o;for(const d of Object.keys(l))l[d]===void 0&&delete l[d];const c=await t._getAppCheckToken(),u=c?`#${_8}=${encodeURIComponent(c)}`:"";return`${b8(t)}?${Pu(l).slice(1)}${u}`}function b8({config:t}){return t.emulator?Sv(t,w8):`https://${t.authDomain}/${v8}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pg="webStorageSupport";class S8{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=qC,this._completeRedirectFn=G7,this._overrideRedirectResult=H7}async _openPopup(e,n,r,s){var i;Ws((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=await xS(e,n,r,rx(),s);return x8(e,o,jv())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await xS(e,n,r,rx(),s);return T7(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(Ws(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await d8(e),r=new K7(e);return n.register("authEvent",s=>(ae(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(pg,{type:pg},s=>{var i;const o=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[pg];o!==void 0&&n(!!o),hs(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=e8(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return MC()||AC()||Tv()}}const E8=S8;var yS="@firebase/auth",vS="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k8{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){ae(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T8(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function I8(t){Oa(new Vi("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=r.options;ae(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const c={apiKey:o,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:OC(t)},u=new s7(r,s,i,c);return u7(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Oa(new Vi("auth-internal",e=>{const n=bm(e.getProvider("auth").getImmediate());return(r=>new k8(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),as(yS,vS,T8(t)),as(yS,vS,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C8=5*60,j8=pC("authIdTokenMaxAge")||C8;let wS=null;const R8=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>j8)return;const s=n==null?void 0:n.token;wS!==s&&(wS=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function A8(t=vv()){const e=_m(t,"auth");if(e.isInitialized())return e.getImmediate();const n=c7(t,{popupRedirectResolver:E8,persistence:[D7,S7,qC]}),r=pC("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=R8(i.toString());v7(n,o,()=>o(n.currentUser)),y7(n,l=>o(l))}}const s=hC("auth");return s&&d7(n,`http://${s}`),n}function N8(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}i7({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=Br("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",N8().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});I8("Browser");/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function P8(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function l(d){try{u(r.next(d))}catch(m){o(m)}}function c(d){try{u(r.throw(d))}catch(m){o(m)}}function u(d){d.done?i(d.value):s(d.value).then(l,c)}u((r=r.apply(t,e||[])).next())})}function F8(t,e){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,s,i,o;return o={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(u){return function(d){return c([u,d])}}function c(u){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,s&&(i=u[0]&2?s.return:u[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,u[1])).done)return i;switch(s=0,i&&(u=[u[0]&2,i.value]),u[0]){case 0:case 1:i=u;break;case 4:return n.label++,{value:u[1],done:!1};case 5:n.label++,s=u[1],u=[0];continue;case 7:u=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(u[0]===6||u[0]===2)){n=0;continue}if(u[0]===3&&(!i||u[1]>i[0]&&u[1]<i[3])){n.label=u[1];break}if(u[0]===6&&n.label<i[1]){n.label=i[1],i=u;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(u);break}i[2]&&n.ops.pop(),n.trys.pop();continue}u=e.call(t,n)}catch(d){u=[6,d],s=0}finally{r=i=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var No=function(){return No=Object.assign||function(e){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},No.apply(this,arguments)},ej=function(t){return{loading:t==null,value:t}},D8=function(){return function(t,e){switch(e.type){case"error":return No(No({},t),{error:e.error,loading:!1,value:void 0});case"reset":return ej(e.defaultValue);case"value":return No(No({},t),{error:void 0,loading:!1,value:e.value});default:return t}}},L8=function(t){var e=t?t():void 0,n=f.useReducer(D8(),ej(e)),r=n[0],s=n[1],i=f.useCallback(function(){var c=t?t():void 0;s({type:"reset",defaultValue:c})},[t]),o=f.useCallback(function(c){s({type:"error",error:c})},[]),l=f.useCallback(function(c){s({type:"value",value:c})},[]);return f.useMemo(function(){return{error:r.error,loading:r.loading,reset:i,setError:o,setValue:l,value:r.value}},[r.error,r.loading,i,o,l,r.value])},Av=function(t,e){var n=L8(function(){return t.currentUser}),r=n.error,s=n.loading,i=n.setError,o=n.setValue,l=n.value;return f.useEffect(function(){var c=w7(t,function(u){return P8(void 0,void 0,void 0,function(){var d;return F8(this,function(m){switch(m.label){case 0:if(!(e!=null&&e.onUserChanged))return[3,4];m.label=1;case 1:return m.trys.push([1,3,,4]),[4,e.onUserChanged(u)];case 2:return m.sent(),[3,4];case 3:return d=m.sent(),i(d),[3,4];case 4:return o(u),[2]}})})},i);return function(){c()}},[t]),[l,s,r]},M8="firebase",O8="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */as(M8,O8,"app");var _S=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ca,tj;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(I,k){function R(){}R.prototype=k.prototype,I.D=k.prototype,I.prototype=new R,I.prototype.constructor=I,I.C=function(j,N,P){for(var A=Array(arguments.length-2),ee=2;ee<arguments.length;ee++)A[ee-2]=arguments[ee];return k.prototype[N].apply(j,A)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(I,k,R){R||(R=0);var j=Array(16);if(typeof k=="string")for(var N=0;16>N;++N)j[N]=k.charCodeAt(R++)|k.charCodeAt(R++)<<8|k.charCodeAt(R++)<<16|k.charCodeAt(R++)<<24;else for(N=0;16>N;++N)j[N]=k[R++]|k[R++]<<8|k[R++]<<16|k[R++]<<24;k=I.g[0],R=I.g[1],N=I.g[2];var P=I.g[3],A=k+(P^R&(N^P))+j[0]+3614090360&4294967295;k=R+(A<<7&4294967295|A>>>25),A=P+(N^k&(R^N))+j[1]+3905402710&4294967295,P=k+(A<<12&4294967295|A>>>20),A=N+(R^P&(k^R))+j[2]+606105819&4294967295,N=P+(A<<17&4294967295|A>>>15),A=R+(k^N&(P^k))+j[3]+3250441966&4294967295,R=N+(A<<22&4294967295|A>>>10),A=k+(P^R&(N^P))+j[4]+4118548399&4294967295,k=R+(A<<7&4294967295|A>>>25),A=P+(N^k&(R^N))+j[5]+1200080426&4294967295,P=k+(A<<12&4294967295|A>>>20),A=N+(R^P&(k^R))+j[6]+2821735955&4294967295,N=P+(A<<17&4294967295|A>>>15),A=R+(k^N&(P^k))+j[7]+4249261313&4294967295,R=N+(A<<22&4294967295|A>>>10),A=k+(P^R&(N^P))+j[8]+1770035416&4294967295,k=R+(A<<7&4294967295|A>>>25),A=P+(N^k&(R^N))+j[9]+2336552879&4294967295,P=k+(A<<12&4294967295|A>>>20),A=N+(R^P&(k^R))+j[10]+4294925233&4294967295,N=P+(A<<17&4294967295|A>>>15),A=R+(k^N&(P^k))+j[11]+2304563134&4294967295,R=N+(A<<22&4294967295|A>>>10),A=k+(P^R&(N^P))+j[12]+1804603682&4294967295,k=R+(A<<7&4294967295|A>>>25),A=P+(N^k&(R^N))+j[13]+4254626195&4294967295,P=k+(A<<12&4294967295|A>>>20),A=N+(R^P&(k^R))+j[14]+2792965006&4294967295,N=P+(A<<17&4294967295|A>>>15),A=R+(k^N&(P^k))+j[15]+1236535329&4294967295,R=N+(A<<22&4294967295|A>>>10),A=k+(N^P&(R^N))+j[1]+4129170786&4294967295,k=R+(A<<5&4294967295|A>>>27),A=P+(R^N&(k^R))+j[6]+3225465664&4294967295,P=k+(A<<9&4294967295|A>>>23),A=N+(k^R&(P^k))+j[11]+643717713&4294967295,N=P+(A<<14&4294967295|A>>>18),A=R+(P^k&(N^P))+j[0]+3921069994&4294967295,R=N+(A<<20&4294967295|A>>>12),A=k+(N^P&(R^N))+j[5]+3593408605&4294967295,k=R+(A<<5&4294967295|A>>>27),A=P+(R^N&(k^R))+j[10]+38016083&4294967295,P=k+(A<<9&4294967295|A>>>23),A=N+(k^R&(P^k))+j[15]+3634488961&4294967295,N=P+(A<<14&4294967295|A>>>18),A=R+(P^k&(N^P))+j[4]+3889429448&4294967295,R=N+(A<<20&4294967295|A>>>12),A=k+(N^P&(R^N))+j[9]+568446438&4294967295,k=R+(A<<5&4294967295|A>>>27),A=P+(R^N&(k^R))+j[14]+3275163606&4294967295,P=k+(A<<9&4294967295|A>>>23),A=N+(k^R&(P^k))+j[3]+4107603335&4294967295,N=P+(A<<14&4294967295|A>>>18),A=R+(P^k&(N^P))+j[8]+1163531501&4294967295,R=N+(A<<20&4294967295|A>>>12),A=k+(N^P&(R^N))+j[13]+2850285829&4294967295,k=R+(A<<5&4294967295|A>>>27),A=P+(R^N&(k^R))+j[2]+4243563512&4294967295,P=k+(A<<9&4294967295|A>>>23),A=N+(k^R&(P^k))+j[7]+1735328473&4294967295,N=P+(A<<14&4294967295|A>>>18),A=R+(P^k&(N^P))+j[12]+2368359562&4294967295,R=N+(A<<20&4294967295|A>>>12),A=k+(R^N^P)+j[5]+4294588738&4294967295,k=R+(A<<4&4294967295|A>>>28),A=P+(k^R^N)+j[8]+2272392833&4294967295,P=k+(A<<11&4294967295|A>>>21),A=N+(P^k^R)+j[11]+1839030562&4294967295,N=P+(A<<16&4294967295|A>>>16),A=R+(N^P^k)+j[14]+4259657740&4294967295,R=N+(A<<23&4294967295|A>>>9),A=k+(R^N^P)+j[1]+2763975236&4294967295,k=R+(A<<4&4294967295|A>>>28),A=P+(k^R^N)+j[4]+1272893353&4294967295,P=k+(A<<11&4294967295|A>>>21),A=N+(P^k^R)+j[7]+4139469664&4294967295,N=P+(A<<16&4294967295|A>>>16),A=R+(N^P^k)+j[10]+3200236656&4294967295,R=N+(A<<23&4294967295|A>>>9),A=k+(R^N^P)+j[13]+681279174&4294967295,k=R+(A<<4&4294967295|A>>>28),A=P+(k^R^N)+j[0]+3936430074&4294967295,P=k+(A<<11&4294967295|A>>>21),A=N+(P^k^R)+j[3]+3572445317&4294967295,N=P+(A<<16&4294967295|A>>>16),A=R+(N^P^k)+j[6]+76029189&4294967295,R=N+(A<<23&4294967295|A>>>9),A=k+(R^N^P)+j[9]+3654602809&4294967295,k=R+(A<<4&4294967295|A>>>28),A=P+(k^R^N)+j[12]+3873151461&4294967295,P=k+(A<<11&4294967295|A>>>21),A=N+(P^k^R)+j[15]+530742520&4294967295,N=P+(A<<16&4294967295|A>>>16),A=R+(N^P^k)+j[2]+3299628645&4294967295,R=N+(A<<23&4294967295|A>>>9),A=k+(N^(R|~P))+j[0]+4096336452&4294967295,k=R+(A<<6&4294967295|A>>>26),A=P+(R^(k|~N))+j[7]+1126891415&4294967295,P=k+(A<<10&4294967295|A>>>22),A=N+(k^(P|~R))+j[14]+2878612391&4294967295,N=P+(A<<15&4294967295|A>>>17),A=R+(P^(N|~k))+j[5]+4237533241&4294967295,R=N+(A<<21&4294967295|A>>>11),A=k+(N^(R|~P))+j[12]+1700485571&4294967295,k=R+(A<<6&4294967295|A>>>26),A=P+(R^(k|~N))+j[3]+2399980690&4294967295,P=k+(A<<10&4294967295|A>>>22),A=N+(k^(P|~R))+j[10]+4293915773&4294967295,N=P+(A<<15&4294967295|A>>>17),A=R+(P^(N|~k))+j[1]+2240044497&4294967295,R=N+(A<<21&4294967295|A>>>11),A=k+(N^(R|~P))+j[8]+1873313359&4294967295,k=R+(A<<6&4294967295|A>>>26),A=P+(R^(k|~N))+j[15]+4264355552&4294967295,P=k+(A<<10&4294967295|A>>>22),A=N+(k^(P|~R))+j[6]+2734768916&4294967295,N=P+(A<<15&4294967295|A>>>17),A=R+(P^(N|~k))+j[13]+1309151649&4294967295,R=N+(A<<21&4294967295|A>>>11),A=k+(N^(R|~P))+j[4]+4149444226&4294967295,k=R+(A<<6&4294967295|A>>>26),A=P+(R^(k|~N))+j[11]+3174756917&4294967295,P=k+(A<<10&4294967295|A>>>22),A=N+(k^(P|~R))+j[2]+718787259&4294967295,N=P+(A<<15&4294967295|A>>>17),A=R+(P^(N|~k))+j[9]+3951481745&4294967295,I.g[0]=I.g[0]+k&4294967295,I.g[1]=I.g[1]+(N+(A<<21&4294967295|A>>>11))&4294967295,I.g[2]=I.g[2]+N&4294967295,I.g[3]=I.g[3]+P&4294967295}r.prototype.u=function(I,k){k===void 0&&(k=I.length);for(var R=k-this.blockSize,j=this.B,N=this.h,P=0;P<k;){if(N==0)for(;P<=R;)s(this,I,P),P+=this.blockSize;if(typeof I=="string"){for(;P<k;)if(j[N++]=I.charCodeAt(P++),N==this.blockSize){s(this,j),N=0;break}}else for(;P<k;)if(j[N++]=I[P++],N==this.blockSize){s(this,j),N=0;break}}this.h=N,this.o+=k},r.prototype.v=function(){var I=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);I[0]=128;for(var k=1;k<I.length-8;++k)I[k]=0;var R=8*this.o;for(k=I.length-8;k<I.length;++k)I[k]=R&255,R/=256;for(this.u(I),I=Array(16),k=R=0;4>k;++k)for(var j=0;32>j;j+=8)I[R++]=this.g[k]>>>j&255;return I};function i(I,k){var R=l;return Object.prototype.hasOwnProperty.call(R,I)?R[I]:R[I]=k(I)}function o(I,k){this.h=k;for(var R=[],j=!0,N=I.length-1;0<=N;N--){var P=I[N]|0;j&&P==k||(R[N]=P,j=!1)}this.g=R}var l={};function c(I){return-128<=I&&128>I?i(I,function(k){return new o([k|0],0>k?-1:0)}):new o([I|0],0>I?-1:0)}function u(I){if(isNaN(I)||!isFinite(I))return m;if(0>I)return _(u(-I));for(var k=[],R=1,j=0;I>=R;j++)k[j]=I/R|0,R*=4294967296;return new o(k,0)}function d(I,k){if(I.length==0)throw Error("number format error: empty string");if(k=k||10,2>k||36<k)throw Error("radix out of range: "+k);if(I.charAt(0)=="-")return _(d(I.substring(1),k));if(0<=I.indexOf("-"))throw Error('number format error: interior "-" character');for(var R=u(Math.pow(k,8)),j=m,N=0;N<I.length;N+=8){var P=Math.min(8,I.length-N),A=parseInt(I.substring(N,N+P),k);8>P?(P=u(Math.pow(k,P)),j=j.j(P).add(u(A))):(j=j.j(R),j=j.add(u(A)))}return j}var m=c(0),p=c(1),g=c(16777216);t=o.prototype,t.m=function(){if(w(this))return-_(this).m();for(var I=0,k=1,R=0;R<this.g.length;R++){var j=this.i(R);I+=(0<=j?j:4294967296+j)*k,k*=4294967296}return I},t.toString=function(I){if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(y(this))return"0";if(w(this))return"-"+_(this).toString(I);for(var k=u(Math.pow(I,6)),R=this,j="";;){var N=C(R,k).g;R=E(R,N.j(k));var P=((0<R.g.length?R.g[0]:R.h)>>>0).toString(I);if(R=N,y(R))return P+j;for(;6>P.length;)P="0"+P;j=P+j}},t.i=function(I){return 0>I?0:I<this.g.length?this.g[I]:this.h};function y(I){if(I.h!=0)return!1;for(var k=0;k<I.g.length;k++)if(I.g[k]!=0)return!1;return!0}function w(I){return I.h==-1}t.l=function(I){return I=E(this,I),w(I)?-1:y(I)?0:1};function _(I){for(var k=I.g.length,R=[],j=0;j<k;j++)R[j]=~I.g[j];return new o(R,~I.h).add(p)}t.abs=function(){return w(this)?_(this):this},t.add=function(I){for(var k=Math.max(this.g.length,I.g.length),R=[],j=0,N=0;N<=k;N++){var P=j+(this.i(N)&65535)+(I.i(N)&65535),A=(P>>>16)+(this.i(N)>>>16)+(I.i(N)>>>16);j=A>>>16,P&=65535,A&=65535,R[N]=A<<16|P}return new o(R,R[R.length-1]&-2147483648?-1:0)};function E(I,k){return I.add(_(k))}t.j=function(I){if(y(this)||y(I))return m;if(w(this))return w(I)?_(this).j(_(I)):_(_(this).j(I));if(w(I))return _(this.j(_(I)));if(0>this.l(g)&&0>I.l(g))return u(this.m()*I.m());for(var k=this.g.length+I.g.length,R=[],j=0;j<2*k;j++)R[j]=0;for(j=0;j<this.g.length;j++)for(var N=0;N<I.g.length;N++){var P=this.i(j)>>>16,A=this.i(j)&65535,ee=I.i(N)>>>16,me=I.i(N)&65535;R[2*j+2*N]+=A*me,b(R,2*j+2*N),R[2*j+2*N+1]+=P*me,b(R,2*j+2*N+1),R[2*j+2*N+1]+=A*ee,b(R,2*j+2*N+1),R[2*j+2*N+2]+=P*ee,b(R,2*j+2*N+2)}for(j=0;j<k;j++)R[j]=R[2*j+1]<<16|R[2*j];for(j=k;j<2*k;j++)R[j]=0;return new o(R,0)};function b(I,k){for(;(I[k]&65535)!=I[k];)I[k+1]+=I[k]>>>16,I[k]&=65535,k++}function S(I,k){this.g=I,this.h=k}function C(I,k){if(y(k))throw Error("division by zero");if(y(I))return new S(m,m);if(w(I))return k=C(_(I),k),new S(_(k.g),_(k.h));if(w(k))return k=C(I,_(k)),new S(_(k.g),k.h);if(30<I.g.length){if(w(I)||w(k))throw Error("slowDivide_ only works with positive integers.");for(var R=p,j=k;0>=j.l(I);)R=D(R),j=D(j);var N=F(R,1),P=F(j,1);for(j=F(j,2),R=F(R,2);!y(j);){var A=P.add(j);0>=A.l(I)&&(N=N.add(R),P=A),j=F(j,1),R=F(R,1)}return k=E(I,N.j(k)),new S(N,k)}for(N=m;0<=I.l(k);){for(R=Math.max(1,Math.floor(I.m()/k.m())),j=Math.ceil(Math.log(R)/Math.LN2),j=48>=j?1:Math.pow(2,j-48),P=u(R),A=P.j(k);w(A)||0<A.l(I);)R-=j,P=u(R),A=P.j(k);y(P)&&(P=p),N=N.add(P),I=E(I,A)}return new S(N,I)}t.A=function(I){return C(this,I).h},t.and=function(I){for(var k=Math.max(this.g.length,I.g.length),R=[],j=0;j<k;j++)R[j]=this.i(j)&I.i(j);return new o(R,this.h&I.h)},t.or=function(I){for(var k=Math.max(this.g.length,I.g.length),R=[],j=0;j<k;j++)R[j]=this.i(j)|I.i(j);return new o(R,this.h|I.h)},t.xor=function(I){for(var k=Math.max(this.g.length,I.g.length),R=[],j=0;j<k;j++)R[j]=this.i(j)^I.i(j);return new o(R,this.h^I.h)};function D(I){for(var k=I.g.length+1,R=[],j=0;j<k;j++)R[j]=I.i(j)<<1|I.i(j-1)>>>31;return new o(R,I.h)}function F(I,k){var R=k>>5;k%=32;for(var j=I.g.length-R,N=[],P=0;P<j;P++)N[P]=0<k?I.i(P+R)>>>k|I.i(P+R+1)<<32-k:I.i(P+R);return new o(N,I.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,tj=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=d,Ca=o}).apply(typeof _S<"u"?_S:typeof self<"u"?self:typeof window<"u"?window:{});var Dd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var nj,hc,rj,_h,ax,sj,ij,aj;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(h,x,v){return h==Array.prototype||h==Object.prototype||(h[x]=v.value),h};function n(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof Dd=="object"&&Dd];for(var x=0;x<h.length;++x){var v=h[x];if(v&&v.Math==Math)return v}throw Error("Cannot find global object")}var r=n(this);function s(h,x){if(x)e:{var v=r;h=h.split(".");for(var T=0;T<h.length-1;T++){var L=h[T];if(!(L in v))break e;v=v[L]}h=h[h.length-1],T=v[h],x=x(T),x!=T&&x!=null&&e(v,h,{configurable:!0,writable:!0,value:x})}}function i(h,x){h instanceof String&&(h+="");var v=0,T=!1,L={next:function(){if(!T&&v<h.length){var M=v++;return{value:x(M,h[M]),done:!1}}return T=!0,{done:!0,value:void 0}}};return L[Symbol.iterator]=function(){return L},L}s("Array.prototype.values",function(h){return h||function(){return i(this,function(x,v){return v})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function c(h){var x=typeof h;return x=x!="object"?x:h?Array.isArray(h)?"array":x:"null",x=="array"||x=="object"&&typeof h.length=="number"}function u(h){var x=typeof h;return x=="object"&&h!=null||x=="function"}function d(h,x,v){return h.call.apply(h.bind,arguments)}function m(h,x,v){if(!h)throw Error();if(2<arguments.length){var T=Array.prototype.slice.call(arguments,2);return function(){var L=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(L,T),h.apply(x,L)}}return function(){return h.apply(x,arguments)}}function p(h,x,v){return p=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:m,p.apply(null,arguments)}function g(h,x){var v=Array.prototype.slice.call(arguments,1);return function(){var T=v.slice();return T.push.apply(T,arguments),h.apply(this,T)}}function y(h,x){function v(){}v.prototype=x.prototype,h.aa=x.prototype,h.prototype=new v,h.prototype.constructor=h,h.Qb=function(T,L,M){for(var W=Array(arguments.length-2),Be=2;Be<arguments.length;Be++)W[Be-2]=arguments[Be];return x.prototype[L].apply(T,W)}}function w(h){const x=h.length;if(0<x){const v=Array(x);for(let T=0;T<x;T++)v[T]=h[T];return v}return[]}function _(h,x){for(let v=1;v<arguments.length;v++){const T=arguments[v];if(c(T)){const L=h.length||0,M=T.length||0;h.length=L+M;for(let W=0;W<M;W++)h[L+W]=T[W]}else h.push(T)}}class E{constructor(x,v){this.i=x,this.j=v,this.h=0,this.g=null}get(){let x;return 0<this.h?(this.h--,x=this.g,this.g=x.next,x.next=null):x=this.i(),x}}function b(h){return/^[\s\xa0]*$/.test(h)}function S(){var h=l.navigator;return h&&(h=h.userAgent)?h:""}function C(h){return C[" "](h),h}C[" "]=function(){};var D=S().indexOf("Gecko")!=-1&&!(S().toLowerCase().indexOf("webkit")!=-1&&S().indexOf("Edge")==-1)&&!(S().indexOf("Trident")!=-1||S().indexOf("MSIE")!=-1)&&S().indexOf("Edge")==-1;function F(h,x,v){for(const T in h)x.call(v,h[T],T,h)}function I(h,x){for(const v in h)x.call(void 0,h[v],v,h)}function k(h){const x={};for(const v in h)x[v]=h[v];return x}const R="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function j(h,x){let v,T;for(let L=1;L<arguments.length;L++){T=arguments[L];for(v in T)h[v]=T[v];for(let M=0;M<R.length;M++)v=R[M],Object.prototype.hasOwnProperty.call(T,v)&&(h[v]=T[v])}}function N(h){var x=1;h=h.split(":");const v=[];for(;0<x&&h.length;)v.push(h.shift()),x--;return h.length&&v.push(h.join(":")),v}function P(h){l.setTimeout(()=>{throw h},0)}function A(){var h=Y;let x=null;return h.g&&(x=h.g,h.g=h.g.next,h.g||(h.h=null),x.next=null),x}class ee{constructor(){this.h=this.g=null}add(x,v){const T=me.get();T.set(x,v),this.h?this.h.next=T:this.g=T,this.h=T}}var me=new E(()=>new ye,h=>h.reset());class ye{constructor(){this.next=this.g=this.h=null}set(x,v){this.h=x,this.g=v,this.next=null}reset(){this.next=this.g=this.h=null}}let Ne,H=!1,Y=new ee,te=()=>{const h=l.Promise.resolve(void 0);Ne=()=>{h.then(_e)}};var _e=()=>{for(var h;h=A();){try{h.h.call(h.g)}catch(v){P(v)}var x=me;x.j(h),100>x.h&&(x.h++,h.next=x.g,x.g=h)}H=!1};function Ie(){this.s=this.s,this.C=this.C}Ie.prototype.s=!1,Ie.prototype.ma=function(){this.s||(this.s=!0,this.N())},Ie.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function We(h,x){this.type=h,this.g=this.target=x,this.defaultPrevented=!1}We.prototype.h=function(){this.defaultPrevented=!0};var Ir=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var h=!1,x=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const v=()=>{};l.addEventListener("test",v,x),l.removeEventListener("test",v,x)}catch{}return h}();function ir(h,x){if(We.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h){var v=this.type=h.type,T=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;if(this.target=h.target||h.srcElement,this.g=x,x=h.relatedTarget){if(D){e:{try{C(x.nodeName);var L=!0;break e}catch{}L=!1}L||(x=null)}}else v=="mouseover"?x=h.fromElement:v=="mouseout"&&(x=h.toElement);this.relatedTarget=x,T?(this.clientX=T.clientX!==void 0?T.clientX:T.pageX,this.clientY=T.clientY!==void 0?T.clientY:T.pageY,this.screenX=T.screenX||0,this.screenY=T.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=typeof h.pointerType=="string"?h.pointerType:ar[h.pointerType]||"",this.state=h.state,this.i=h,h.defaultPrevented&&ir.aa.h.call(this)}}y(ir,We);var ar={2:"touch",3:"pen",4:"mouse"};ir.prototype.h=function(){ir.aa.h.call(this);var h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var Ln="closure_listenable_"+(1e6*Math.random()|0),Ju=0;function Zu(h,x,v,T,L){this.listener=h,this.proxy=null,this.src=x,this.type=v,this.capture=!!T,this.ha=L,this.key=++Ju,this.da=this.fa=!1}function sa(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function be(h){this.src=h,this.g={},this.h=0}be.prototype.add=function(h,x,v,T,L){var M=h.toString();h=this.g[M],h||(h=this.g[M]=[],this.h++);var W=yt(h,x,T,L);return-1<W?(x=h[W],v||(x.fa=!1)):(x=new Zu(x,this.src,M,!!T,L),x.fa=v,h.push(x)),x};function xt(h,x){var v=x.type;if(v in h.g){var T=h.g[v],L=Array.prototype.indexOf.call(T,x,void 0),M;(M=0<=L)&&Array.prototype.splice.call(T,L,1),M&&(sa(x),h.g[v].length==0&&(delete h.g[v],h.h--))}}function yt(h,x,v,T){for(var L=0;L<h.length;++L){var M=h[L];if(!M.da&&M.listener==x&&M.capture==!!v&&M.ha==T)return L}return-1}var Mn="closure_lm_"+(1e6*Math.random()|0),Tn={};function Nl(h,x,v,T,L){if(T&&T.once)return n1(h,x,v,T,L);if(Array.isArray(x)){for(var M=0;M<x.length;M++)Nl(h,x[M],v,T,L);return null}return v=sp(v),h&&h[Ln]?h.K(x,v,u(T)?!!T.capture:!!T,L):t1(h,x,v,!1,T,L)}function t1(h,x,v,T,L,M){if(!x)throw Error("Invalid event type");var W=u(L)?!!L.capture:!!L,Be=np(h);if(Be||(h[Mn]=Be=new be(h)),v=Be.add(x,v,T,W,M),v.proxy)return v;if(T=x5(),v.proxy=T,T.src=h,T.listener=v,h.addEventListener)Ir||(L=W),L===void 0&&(L=!1),h.addEventListener(x.toString(),T,L);else if(h.attachEvent)h.attachEvent(s1(x.toString()),T);else if(h.addListener&&h.removeListener)h.addListener(T);else throw Error("addEventListener and attachEvent are unavailable.");return v}function x5(){function h(v){return x.call(h.src,h.listener,v)}const x=y5;return h}function n1(h,x,v,T,L){if(Array.isArray(x)){for(var M=0;M<x.length;M++)n1(h,x[M],v,T,L);return null}return v=sp(v),h&&h[Ln]?h.L(x,v,u(T)?!!T.capture:!!T,L):t1(h,x,v,!0,T,L)}function r1(h,x,v,T,L){if(Array.isArray(x))for(var M=0;M<x.length;M++)r1(h,x[M],v,T,L);else T=u(T)?!!T.capture:!!T,v=sp(v),h&&h[Ln]?(h=h.i,x=String(x).toString(),x in h.g&&(M=h.g[x],v=yt(M,v,T,L),-1<v&&(sa(M[v]),Array.prototype.splice.call(M,v,1),M.length==0&&(delete h.g[x],h.h--)))):h&&(h=np(h))&&(x=h.g[x.toString()],h=-1,x&&(h=yt(x,v,T,L)),(v=-1<h?x[h]:null)&&tp(v))}function tp(h){if(typeof h!="number"&&h&&!h.da){var x=h.src;if(x&&x[Ln])xt(x.i,h);else{var v=h.type,T=h.proxy;x.removeEventListener?x.removeEventListener(v,T,h.capture):x.detachEvent?x.detachEvent(s1(v),T):x.addListener&&x.removeListener&&x.removeListener(T),(v=np(x))?(xt(v,h),v.h==0&&(v.src=null,x[Mn]=null)):sa(h)}}}function s1(h){return h in Tn?Tn[h]:Tn[h]="on"+h}function y5(h,x){if(h.da)h=!0;else{x=new ir(x,this);var v=h.listener,T=h.ha||h.src;h.fa&&tp(h),h=v.call(T,x)}return h}function np(h){return h=h[Mn],h instanceof be?h:null}var rp="__closure_events_fn_"+(1e9*Math.random()>>>0);function sp(h){return typeof h=="function"?h:(h[rp]||(h[rp]=function(x){return h.handleEvent(x)}),h[rp])}function Qt(){Ie.call(this),this.i=new be(this),this.M=this,this.F=null}y(Qt,Ie),Qt.prototype[Ln]=!0,Qt.prototype.removeEventListener=function(h,x,v,T){r1(this,h,x,v,T)};function ln(h,x){var v,T=h.F;if(T)for(v=[];T;T=T.F)v.push(T);if(h=h.M,T=x.type||x,typeof x=="string")x=new We(x,h);else if(x instanceof We)x.target=x.target||h;else{var L=x;x=new We(T,h),j(x,L)}if(L=!0,v)for(var M=v.length-1;0<=M;M--){var W=x.g=v[M];L=ed(W,T,!0,x)&&L}if(W=x.g=h,L=ed(W,T,!0,x)&&L,L=ed(W,T,!1,x)&&L,v)for(M=0;M<v.length;M++)W=x.g=v[M],L=ed(W,T,!1,x)&&L}Qt.prototype.N=function(){if(Qt.aa.N.call(this),this.i){var h=this.i,x;for(x in h.g){for(var v=h.g[x],T=0;T<v.length;T++)sa(v[T]);delete h.g[x],h.h--}}this.F=null},Qt.prototype.K=function(h,x,v,T){return this.i.add(String(h),x,!1,v,T)},Qt.prototype.L=function(h,x,v,T){return this.i.add(String(h),x,!0,v,T)};function ed(h,x,v,T){if(x=h.i.g[String(x)],!x)return!0;x=x.concat();for(var L=!0,M=0;M<x.length;++M){var W=x[M];if(W&&!W.da&&W.capture==v){var Be=W.listener,Dt=W.ha||W.src;W.fa&&xt(h.i,W),L=Be.call(Dt,T)!==!1&&L}}return L&&!T.defaultPrevented}function i1(h,x,v){if(typeof h=="function")v&&(h=p(h,v));else if(h&&typeof h.handleEvent=="function")h=p(h.handleEvent,h);else throw Error("Invalid listener argument");return 2147483647<Number(x)?-1:l.setTimeout(h,x||0)}function a1(h){h.g=i1(()=>{h.g=null,h.i&&(h.i=!1,a1(h))},h.l);const x=h.h;h.h=null,h.m.apply(null,x)}class v5 extends Ie{constructor(x,v){super(),this.m=x,this.l=v,this.h=null,this.i=!1,this.g=null}j(x){this.h=arguments,this.g?this.i=!0:a1(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Pl(h){Ie.call(this),this.h=h,this.g={}}y(Pl,Ie);var o1=[];function l1(h){F(h.g,function(x,v){this.g.hasOwnProperty(v)&&tp(x)},h),h.g={}}Pl.prototype.N=function(){Pl.aa.N.call(this),l1(this)},Pl.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ip=l.JSON.stringify,w5=l.JSON.parse,_5=class{stringify(h){return l.JSON.stringify(h,void 0)}parse(h){return l.JSON.parse(h,void 0)}};function ap(){}ap.prototype.h=null;function c1(h){return h.h||(h.h=h.i())}function u1(){}var Fl={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function op(){We.call(this,"d")}y(op,We);function lp(){We.call(this,"c")}y(lp,We);var ia={},d1=null;function td(){return d1=d1||new Qt}ia.La="serverreachability";function h1(h){We.call(this,ia.La,h)}y(h1,We);function Dl(h){const x=td();ln(x,new h1(x))}ia.STAT_EVENT="statevent";function f1(h,x){We.call(this,ia.STAT_EVENT,h),this.stat=x}y(f1,We);function cn(h){const x=td();ln(x,new f1(x,h))}ia.Ma="timingevent";function m1(h,x){We.call(this,ia.Ma,h),this.size=x}y(m1,We);function Ll(h,x){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){h()},x)}function Ml(){this.g=!0}Ml.prototype.xa=function(){this.g=!1};function b5(h,x,v,T,L,M){h.info(function(){if(h.g)if(M)for(var W="",Be=M.split("&"),Dt=0;Dt<Be.length;Dt++){var Pe=Be[Dt].split("=");if(1<Pe.length){var Kt=Pe[0];Pe=Pe[1];var Xt=Kt.split("_");W=2<=Xt.length&&Xt[1]=="type"?W+(Kt+"="+Pe+"&"):W+(Kt+"=redacted&")}}else W=null;else W=M;return"XMLHTTP REQ ("+T+") [attempt "+L+"]: "+x+`
`+v+`
`+W})}function S5(h,x,v,T,L,M,W){h.info(function(){return"XMLHTTP RESP ("+T+") [ attempt "+L+"]: "+x+`
`+v+`
`+M+" "+W})}function oo(h,x,v,T){h.info(function(){return"XMLHTTP TEXT ("+x+"): "+k5(h,v)+(T?" "+T:"")})}function E5(h,x){h.info(function(){return"TIMEOUT: "+x})}Ml.prototype.info=function(){};function k5(h,x){if(!h.g)return x;if(!x)return null;try{var v=JSON.parse(x);if(v){for(h=0;h<v.length;h++)if(Array.isArray(v[h])){var T=v[h];if(!(2>T.length)){var L=T[1];if(Array.isArray(L)&&!(1>L.length)){var M=L[0];if(M!="noop"&&M!="stop"&&M!="close")for(var W=1;W<L.length;W++)L[W]=""}}}}return ip(v)}catch{return x}}var nd={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},p1={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},cp;function rd(){}y(rd,ap),rd.prototype.g=function(){return new XMLHttpRequest},rd.prototype.i=function(){return{}},cp=new rd;function li(h,x,v,T){this.j=h,this.i=x,this.l=v,this.R=T||1,this.U=new Pl(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new g1}function g1(){this.i=null,this.g="",this.h=!1}var x1={},up={};function dp(h,x,v){h.L=1,h.v=od(ws(x)),h.m=v,h.P=!0,y1(h,null)}function y1(h,x){h.F=Date.now(),sd(h),h.A=ws(h.v);var v=h.A,T=h.R;Array.isArray(T)||(T=[String(T)]),N1(v.i,"t",T),h.C=0,v=h.j.J,h.h=new g1,h.g=X1(h.j,v?x:null,!h.m),0<h.O&&(h.M=new v5(p(h.Y,h,h.g),h.O)),x=h.U,v=h.g,T=h.ca;var L="readystatechange";Array.isArray(L)||(L&&(o1[0]=L.toString()),L=o1);for(var M=0;M<L.length;M++){var W=Nl(v,L[M],T||x.handleEvent,!1,x.h||x);if(!W)break;x.g[W.key]=W}x=h.H?k(h.H):{},h.m?(h.u||(h.u="POST"),x["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.A,h.u,h.m,x)):(h.u="GET",h.g.ea(h.A,h.u,null,x)),Dl(),b5(h.i,h.u,h.A,h.l,h.R,h.m)}li.prototype.ca=function(h){h=h.target;const x=this.M;x&&_s(h)==3?x.j():this.Y(h)},li.prototype.Y=function(h){try{if(h==this.g)e:{const Xt=_s(this.g);var x=this.g.Ba();const uo=this.g.Z();if(!(3>Xt)&&(Xt!=3||this.g&&(this.h.h||this.g.oa()||$1(this.g)))){this.J||Xt!=4||x==7||(x==8||0>=uo?Dl(3):Dl(2)),hp(this);var v=this.g.Z();this.X=v;t:if(v1(this)){var T=$1(this.g);h="";var L=T.length,M=_s(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){aa(this),Ol(this);var W="";break t}this.h.i=new l.TextDecoder}for(x=0;x<L;x++)this.h.h=!0,h+=this.h.i.decode(T[x],{stream:!(M&&x==L-1)});T.length=0,this.h.g+=h,this.C=0,W=this.h.g}else W=this.g.oa();if(this.o=v==200,S5(this.i,this.u,this.A,this.l,this.R,Xt,v),this.o){if(this.T&&!this.K){t:{if(this.g){var Be,Dt=this.g;if((Be=Dt.g?Dt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!b(Be)){var Pe=Be;break t}}Pe=null}if(v=Pe)oo(this.i,this.l,v,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,fp(this,v);else{this.o=!1,this.s=3,cn(12),aa(this),Ol(this);break e}}if(this.P){v=!0;let Cr;for(;!this.J&&this.C<W.length;)if(Cr=T5(this,W),Cr==up){Xt==4&&(this.s=4,cn(14),v=!1),oo(this.i,this.l,null,"[Incomplete Response]");break}else if(Cr==x1){this.s=4,cn(15),oo(this.i,this.l,W,"[Invalid Chunk]"),v=!1;break}else oo(this.i,this.l,Cr,null),fp(this,Cr);if(v1(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Xt!=4||W.length!=0||this.h.h||(this.s=1,cn(16),v=!1),this.o=this.o&&v,!v)oo(this.i,this.l,W,"[Invalid Chunked Response]"),aa(this),Ol(this);else if(0<W.length&&!this.W){this.W=!0;var Kt=this.j;Kt.g==this&&Kt.ba&&!Kt.M&&(Kt.j.info("Great, no buffering proxy detected. Bytes received: "+W.length),vp(Kt),Kt.M=!0,cn(11))}}else oo(this.i,this.l,W,null),fp(this,W);Xt==4&&aa(this),this.o&&!this.J&&(Xt==4?q1(this.j,this):(this.o=!1,sd(this)))}else V5(this.g),v==400&&0<W.indexOf("Unknown SID")?(this.s=3,cn(12)):(this.s=0,cn(13)),aa(this),Ol(this)}}}catch{}finally{}};function v1(h){return h.g?h.u=="GET"&&h.L!=2&&h.j.Ca:!1}function T5(h,x){var v=h.C,T=x.indexOf(`
`,v);return T==-1?up:(v=Number(x.substring(v,T)),isNaN(v)?x1:(T+=1,T+v>x.length?up:(x=x.slice(T,T+v),h.C=T+v,x)))}li.prototype.cancel=function(){this.J=!0,aa(this)};function sd(h){h.S=Date.now()+h.I,w1(h,h.I)}function w1(h,x){if(h.B!=null)throw Error("WatchDog timer not null");h.B=Ll(p(h.ba,h),x)}function hp(h){h.B&&(l.clearTimeout(h.B),h.B=null)}li.prototype.ba=function(){this.B=null;const h=Date.now();0<=h-this.S?(E5(this.i,this.A),this.L!=2&&(Dl(),cn(17)),aa(this),this.s=2,Ol(this)):w1(this,this.S-h)};function Ol(h){h.j.G==0||h.J||q1(h.j,h)}function aa(h){hp(h);var x=h.M;x&&typeof x.ma=="function"&&x.ma(),h.M=null,l1(h.U),h.g&&(x=h.g,h.g=null,x.abort(),x.ma())}function fp(h,x){try{var v=h.j;if(v.G!=0&&(v.g==h||mp(v.h,h))){if(!h.K&&mp(v.h,h)&&v.G==3){try{var T=v.Da.g.parse(x)}catch{T=null}if(Array.isArray(T)&&T.length==3){var L=T;if(L[0]==0){e:if(!v.u){if(v.g)if(v.g.F+3e3<h.F)fd(v),dd(v);else break e;yp(v),cn(18)}}else v.za=L[1],0<v.za-v.T&&37500>L[2]&&v.F&&v.v==0&&!v.C&&(v.C=Ll(p(v.Za,v),6e3));if(1>=S1(v.h)&&v.ca){try{v.ca()}catch{}v.ca=void 0}}else la(v,11)}else if((h.K||v.g==h)&&fd(v),!b(x))for(L=v.Da.g.parse(x),x=0;x<L.length;x++){let Pe=L[x];if(v.T=Pe[0],Pe=Pe[1],v.G==2)if(Pe[0]=="c"){v.K=Pe[1],v.ia=Pe[2];const Kt=Pe[3];Kt!=null&&(v.la=Kt,v.j.info("VER="+v.la));const Xt=Pe[4];Xt!=null&&(v.Aa=Xt,v.j.info("SVER="+v.Aa));const uo=Pe[5];uo!=null&&typeof uo=="number"&&0<uo&&(T=1.5*uo,v.L=T,v.j.info("backChannelRequestTimeoutMs_="+T)),T=v;const Cr=h.g;if(Cr){const pd=Cr.g?Cr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(pd){var M=T.h;M.g||pd.indexOf("spdy")==-1&&pd.indexOf("quic")==-1&&pd.indexOf("h2")==-1||(M.j=M.l,M.g=new Set,M.h&&(pp(M,M.h),M.h=null))}if(T.D){const wp=Cr.g?Cr.g.getResponseHeader("X-HTTP-Session-Id"):null;wp&&(T.ya=wp,qe(T.I,T.D,wp))}}v.G=3,v.l&&v.l.ua(),v.ba&&(v.R=Date.now()-h.F,v.j.info("Handshake RTT: "+v.R+"ms")),T=v;var W=h;if(T.qa=K1(T,T.J?T.ia:null,T.W),W.K){E1(T.h,W);var Be=W,Dt=T.L;Dt&&(Be.I=Dt),Be.B&&(hp(Be),sd(Be)),T.g=W}else H1(T);0<v.i.length&&hd(v)}else Pe[0]!="stop"&&Pe[0]!="close"||la(v,7);else v.G==3&&(Pe[0]=="stop"||Pe[0]=="close"?Pe[0]=="stop"?la(v,7):xp(v):Pe[0]!="noop"&&v.l&&v.l.ta(Pe),v.v=0)}}Dl(4)}catch{}}var I5=class{constructor(h,x){this.g=h,this.map=x}};function _1(h){this.l=h||10,l.PerformanceNavigationTiming?(h=l.performance.getEntriesByType("navigation"),h=0<h.length&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function b1(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function S1(h){return h.h?1:h.g?h.g.size:0}function mp(h,x){return h.h?h.h==x:h.g?h.g.has(x):!1}function pp(h,x){h.g?h.g.add(x):h.h=x}function E1(h,x){h.h&&h.h==x?h.h=null:h.g&&h.g.has(x)&&h.g.delete(x)}_1.prototype.cancel=function(){if(this.i=k1(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function k1(h){if(h.h!=null)return h.i.concat(h.h.D);if(h.g!=null&&h.g.size!==0){let x=h.i;for(const v of h.g.values())x=x.concat(v.D);return x}return w(h.i)}function C5(h){if(h.V&&typeof h.V=="function")return h.V();if(typeof Map<"u"&&h instanceof Map||typeof Set<"u"&&h instanceof Set)return Array.from(h.values());if(typeof h=="string")return h.split("");if(c(h)){for(var x=[],v=h.length,T=0;T<v;T++)x.push(h[T]);return x}x=[],v=0;for(T in h)x[v++]=h[T];return x}function j5(h){if(h.na&&typeof h.na=="function")return h.na();if(!h.V||typeof h.V!="function"){if(typeof Map<"u"&&h instanceof Map)return Array.from(h.keys());if(!(typeof Set<"u"&&h instanceof Set)){if(c(h)||typeof h=="string"){var x=[];h=h.length;for(var v=0;v<h;v++)x.push(v);return x}x=[],v=0;for(const T in h)x[v++]=T;return x}}}function T1(h,x){if(h.forEach&&typeof h.forEach=="function")h.forEach(x,void 0);else if(c(h)||typeof h=="string")Array.prototype.forEach.call(h,x,void 0);else for(var v=j5(h),T=C5(h),L=T.length,M=0;M<L;M++)x.call(void 0,T[M],v&&v[M],h)}var I1=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function R5(h,x){if(h){h=h.split("&");for(var v=0;v<h.length;v++){var T=h[v].indexOf("="),L=null;if(0<=T){var M=h[v].substring(0,T);L=h[v].substring(T+1)}else M=h[v];x(M,L?decodeURIComponent(L.replace(/\+/g," ")):"")}}}function oa(h){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,h instanceof oa){this.h=h.h,id(this,h.j),this.o=h.o,this.g=h.g,ad(this,h.s),this.l=h.l;var x=h.i,v=new zl;v.i=x.i,x.g&&(v.g=new Map(x.g),v.h=x.h),C1(this,v),this.m=h.m}else h&&(x=String(h).match(I1))?(this.h=!1,id(this,x[1]||"",!0),this.o=$l(x[2]||""),this.g=$l(x[3]||"",!0),ad(this,x[4]),this.l=$l(x[5]||"",!0),C1(this,x[6]||"",!0),this.m=$l(x[7]||"")):(this.h=!1,this.i=new zl(null,this.h))}oa.prototype.toString=function(){var h=[],x=this.j;x&&h.push(Bl(x,j1,!0),":");var v=this.g;return(v||x=="file")&&(h.push("//"),(x=this.o)&&h.push(Bl(x,j1,!0),"@"),h.push(encodeURIComponent(String(v)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),v=this.s,v!=null&&h.push(":",String(v))),(v=this.l)&&(this.g&&v.charAt(0)!="/"&&h.push("/"),h.push(Bl(v,v.charAt(0)=="/"?P5:N5,!0))),(v=this.i.toString())&&h.push("?",v),(v=this.m)&&h.push("#",Bl(v,D5)),h.join("")};function ws(h){return new oa(h)}function id(h,x,v){h.j=v?$l(x,!0):x,h.j&&(h.j=h.j.replace(/:$/,""))}function ad(h,x){if(x){if(x=Number(x),isNaN(x)||0>x)throw Error("Bad port number "+x);h.s=x}else h.s=null}function C1(h,x,v){x instanceof zl?(h.i=x,L5(h.i,h.h)):(v||(x=Bl(x,F5)),h.i=new zl(x,h.h))}function qe(h,x,v){h.i.set(x,v)}function od(h){return qe(h,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),h}function $l(h,x){return h?x?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function Bl(h,x,v){return typeof h=="string"?(h=encodeURI(h).replace(x,A5),v&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function A5(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var j1=/[#\/\?@]/g,N5=/[#\?:]/g,P5=/[#\?]/g,F5=/[#\?@]/g,D5=/#/g;function zl(h,x){this.h=this.g=null,this.i=h||null,this.j=!!x}function ci(h){h.g||(h.g=new Map,h.h=0,h.i&&R5(h.i,function(x,v){h.add(decodeURIComponent(x.replace(/\+/g," ")),v)}))}t=zl.prototype,t.add=function(h,x){ci(this),this.i=null,h=lo(this,h);var v=this.g.get(h);return v||this.g.set(h,v=[]),v.push(x),this.h+=1,this};function R1(h,x){ci(h),x=lo(h,x),h.g.has(x)&&(h.i=null,h.h-=h.g.get(x).length,h.g.delete(x))}function A1(h,x){return ci(h),x=lo(h,x),h.g.has(x)}t.forEach=function(h,x){ci(this),this.g.forEach(function(v,T){v.forEach(function(L){h.call(x,L,T,this)},this)},this)},t.na=function(){ci(this);const h=Array.from(this.g.values()),x=Array.from(this.g.keys()),v=[];for(let T=0;T<x.length;T++){const L=h[T];for(let M=0;M<L.length;M++)v.push(x[T])}return v},t.V=function(h){ci(this);let x=[];if(typeof h=="string")A1(this,h)&&(x=x.concat(this.g.get(lo(this,h))));else{h=Array.from(this.g.values());for(let v=0;v<h.length;v++)x=x.concat(h[v])}return x},t.set=function(h,x){return ci(this),this.i=null,h=lo(this,h),A1(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[x]),this.h+=1,this},t.get=function(h,x){return h?(h=this.V(h),0<h.length?String(h[0]):x):x};function N1(h,x,v){R1(h,x),0<v.length&&(h.i=null,h.g.set(lo(h,x),w(v)),h.h+=v.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],x=Array.from(this.g.keys());for(var v=0;v<x.length;v++){var T=x[v];const M=encodeURIComponent(String(T)),W=this.V(T);for(T=0;T<W.length;T++){var L=M;W[T]!==""&&(L+="="+encodeURIComponent(String(W[T]))),h.push(L)}}return this.i=h.join("&")};function lo(h,x){return x=String(x),h.j&&(x=x.toLowerCase()),x}function L5(h,x){x&&!h.j&&(ci(h),h.i=null,h.g.forEach(function(v,T){var L=T.toLowerCase();T!=L&&(R1(this,T),N1(this,L,v))},h)),h.j=x}function M5(h,x){const v=new Ml;if(l.Image){const T=new Image;T.onload=g(ui,v,"TestLoadImage: loaded",!0,x,T),T.onerror=g(ui,v,"TestLoadImage: error",!1,x,T),T.onabort=g(ui,v,"TestLoadImage: abort",!1,x,T),T.ontimeout=g(ui,v,"TestLoadImage: timeout",!1,x,T),l.setTimeout(function(){T.ontimeout&&T.ontimeout()},1e4),T.src=h}else x(!1)}function O5(h,x){const v=new Ml,T=new AbortController,L=setTimeout(()=>{T.abort(),ui(v,"TestPingServer: timeout",!1,x)},1e4);fetch(h,{signal:T.signal}).then(M=>{clearTimeout(L),M.ok?ui(v,"TestPingServer: ok",!0,x):ui(v,"TestPingServer: server error",!1,x)}).catch(()=>{clearTimeout(L),ui(v,"TestPingServer: error",!1,x)})}function ui(h,x,v,T,L){try{L&&(L.onload=null,L.onerror=null,L.onabort=null,L.ontimeout=null),T(v)}catch{}}function $5(){this.g=new _5}function B5(h,x,v){const T=v||"";try{T1(h,function(L,M){let W=L;u(L)&&(W=ip(L)),x.push(T+M+"="+encodeURIComponent(W))})}catch(L){throw x.push(T+"type="+encodeURIComponent("_badmap")),L}}function ld(h){this.l=h.Ub||null,this.j=h.eb||!1}y(ld,ap),ld.prototype.g=function(){return new cd(this.l,this.j)},ld.prototype.i=function(h){return function(){return h}}({});function cd(h,x){Qt.call(this),this.D=h,this.o=x,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}y(cd,Qt),t=cd.prototype,t.open=function(h,x){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=h,this.A=x,this.readyState=1,Vl(this)},t.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const x={headers:this.u,method:this.B,credentials:this.m,cache:void 0};h&&(x.body=h),(this.D||l).fetch(new Request(this.A,x)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ul(this)),this.readyState=0},t.Sa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,Vl(this)),this.g&&(this.readyState=3,Vl(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;P1(this)}else h.text().then(this.Ra.bind(this),this.ga.bind(this))};function P1(h){h.j.read().then(h.Pa.bind(h)).catch(h.ga.bind(h))}t.Pa=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var x=h.value?h.value:new Uint8Array(0);(x=this.v.decode(x,{stream:!h.done}))&&(this.response=this.responseText+=x)}h.done?Ul(this):Vl(this),this.readyState==3&&P1(this)}},t.Ra=function(h){this.g&&(this.response=this.responseText=h,Ul(this))},t.Qa=function(h){this.g&&(this.response=h,Ul(this))},t.ga=function(){this.g&&Ul(this)};function Ul(h){h.readyState=4,h.l=null,h.j=null,h.v=null,Vl(h)}t.setRequestHeader=function(h,x){this.u.append(h,x)},t.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],x=this.h.entries();for(var v=x.next();!v.done;)v=v.value,h.push(v[0]+": "+v[1]),v=x.next();return h.join(`\r
`)};function Vl(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(cd.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function F1(h){let x="";return F(h,function(v,T){x+=T,x+=":",x+=v,x+=`\r
`}),x}function gp(h,x,v){e:{for(T in v){var T=!1;break e}T=!0}T||(v=F1(v),typeof h=="string"?v!=null&&encodeURIComponent(String(v)):qe(h,x,v))}function at(h){Qt.call(this),this.headers=new Map,this.o=h||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}y(at,Qt);var z5=/^https?$/i,U5=["POST","PUT"];t=at.prototype,t.Ha=function(h){this.J=h},t.ea=function(h,x,v,T){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);x=x?x.toUpperCase():"GET",this.D=h,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():cp.g(),this.v=this.o?c1(this.o):c1(cp),this.g.onreadystatechange=p(this.Ea,this);try{this.B=!0,this.g.open(x,String(h),!0),this.B=!1}catch(M){D1(this,M);return}if(h=v||"",v=new Map(this.headers),T)if(Object.getPrototypeOf(T)===Object.prototype)for(var L in T)v.set(L,T[L]);else if(typeof T.keys=="function"&&typeof T.get=="function")for(const M of T.keys())v.set(M,T.get(M));else throw Error("Unknown input type for opt_headers: "+String(T));T=Array.from(v.keys()).find(M=>M.toLowerCase()=="content-type"),L=l.FormData&&h instanceof l.FormData,!(0<=Array.prototype.indexOf.call(U5,x,void 0))||T||L||v.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[M,W]of v)this.g.setRequestHeader(M,W);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{O1(this),this.u=!0,this.g.send(h),this.u=!1}catch(M){D1(this,M)}};function D1(h,x){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=x,h.m=5,L1(h),ud(h)}function L1(h){h.A||(h.A=!0,ln(h,"complete"),ln(h,"error"))}t.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=h||7,ln(this,"complete"),ln(this,"abort"),ud(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ud(this,!0)),at.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?M1(this):this.bb())},t.bb=function(){M1(this)};function M1(h){if(h.h&&typeof o<"u"&&(!h.v[1]||_s(h)!=4||h.Z()!=2)){if(h.u&&_s(h)==4)i1(h.Ea,0,h);else if(ln(h,"readystatechange"),_s(h)==4){h.h=!1;try{const W=h.Z();e:switch(W){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var x=!0;break e;default:x=!1}var v;if(!(v=x)){var T;if(T=W===0){var L=String(h.D).match(I1)[1]||null;!L&&l.self&&l.self.location&&(L=l.self.location.protocol.slice(0,-1)),T=!z5.test(L?L.toLowerCase():"")}v=T}if(v)ln(h,"complete"),ln(h,"success");else{h.m=6;try{var M=2<_s(h)?h.g.statusText:""}catch{M=""}h.l=M+" ["+h.Z()+"]",L1(h)}}finally{ud(h)}}}}function ud(h,x){if(h.g){O1(h);const v=h.g,T=h.v[0]?()=>{}:null;h.g=null,h.v=null,x||ln(h,"ready");try{v.onreadystatechange=T}catch{}}}function O1(h){h.I&&(l.clearTimeout(h.I),h.I=null)}t.isActive=function(){return!!this.g};function _s(h){return h.g?h.g.readyState:0}t.Z=function(){try{return 2<_s(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(h){if(this.g){var x=this.g.responseText;return h&&x.indexOf(h)==0&&(x=x.substring(h.length)),w5(x)}};function $1(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.H){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function V5(h){const x={};h=(h.g&&2<=_s(h)&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let T=0;T<h.length;T++){if(b(h[T]))continue;var v=N(h[T]);const L=v[0];if(v=v[1],typeof v!="string")continue;v=v.trim();const M=x[L]||[];x[L]=M,M.push(v)}I(x,function(T){return T.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Hl(h,x,v){return v&&v.internalChannelParams&&v.internalChannelParams[h]||x}function B1(h){this.Aa=0,this.i=[],this.j=new Ml,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Hl("failFast",!1,h),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Hl("baseRetryDelayMs",5e3,h),this.cb=Hl("retryDelaySeedMs",1e4,h),this.Wa=Hl("forwardChannelMaxRetries",2,h),this.wa=Hl("forwardChannelRequestTimeoutMs",2e4,h),this.pa=h&&h.xmlHttpFactory||void 0,this.Xa=h&&h.Tb||void 0,this.Ca=h&&h.useFetchStreams||!1,this.L=void 0,this.J=h&&h.supportsCrossDomainXhr||!1,this.K="",this.h=new _1(h&&h.concurrentRequestLimit),this.Da=new $5,this.P=h&&h.fastHandshake||!1,this.O=h&&h.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=h&&h.Rb||!1,h&&h.xa&&this.j.xa(),h&&h.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&h&&h.detectBufferingProxy||!1,this.ja=void 0,h&&h.longPollingTimeout&&0<h.longPollingTimeout&&(this.ja=h.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=B1.prototype,t.la=8,t.G=1,t.connect=function(h,x,v,T){cn(0),this.W=h,this.H=x||{},v&&T!==void 0&&(this.H.OSID=v,this.H.OAID=T),this.F=this.X,this.I=K1(this,null,this.W),hd(this)};function xp(h){if(z1(h),h.G==3){var x=h.U++,v=ws(h.I);if(qe(v,"SID",h.K),qe(v,"RID",x),qe(v,"TYPE","terminate"),Wl(h,v),x=new li(h,h.j,x),x.L=2,x.v=od(ws(v)),v=!1,l.navigator&&l.navigator.sendBeacon)try{v=l.navigator.sendBeacon(x.v.toString(),"")}catch{}!v&&l.Image&&(new Image().src=x.v,v=!0),v||(x.g=X1(x.j,null),x.g.ea(x.v)),x.F=Date.now(),sd(x)}Q1(h)}function dd(h){h.g&&(vp(h),h.g.cancel(),h.g=null)}function z1(h){dd(h),h.u&&(l.clearTimeout(h.u),h.u=null),fd(h),h.h.cancel(),h.s&&(typeof h.s=="number"&&l.clearTimeout(h.s),h.s=null)}function hd(h){if(!b1(h.h)&&!h.s){h.s=!0;var x=h.Ga;Ne||te(),H||(Ne(),H=!0),Y.add(x,h),h.B=0}}function H5(h,x){return S1(h.h)>=h.h.j-(h.s?1:0)?!1:h.s?(h.i=x.D.concat(h.i),!0):h.G==1||h.G==2||h.B>=(h.Va?0:h.Wa)?!1:(h.s=Ll(p(h.Ga,h,x),G1(h,h.B)),h.B++,!0)}t.Ga=function(h){if(this.s)if(this.s=null,this.G==1){if(!h){this.U=Math.floor(1e5*Math.random()),h=this.U++;const L=new li(this,this.j,h);let M=this.o;if(this.S&&(M?(M=k(M),j(M,this.S)):M=this.S),this.m!==null||this.O||(L.H=M,M=null),this.P)e:{for(var x=0,v=0;v<this.i.length;v++){t:{var T=this.i[v];if("__data__"in T.map&&(T=T.map.__data__,typeof T=="string")){T=T.length;break t}T=void 0}if(T===void 0)break;if(x+=T,4096<x){x=v;break e}if(x===4096||v===this.i.length-1){x=v+1;break e}}x=1e3}else x=1e3;x=V1(this,L,x),v=ws(this.I),qe(v,"RID",h),qe(v,"CVER",22),this.D&&qe(v,"X-HTTP-Session-Id",this.D),Wl(this,v),M&&(this.O?x="headers="+encodeURIComponent(String(F1(M)))+"&"+x:this.m&&gp(v,this.m,M)),pp(this.h,L),this.Ua&&qe(v,"TYPE","init"),this.P?(qe(v,"$req",x),qe(v,"SID","null"),L.T=!0,dp(L,v,null)):dp(L,v,x),this.G=2}}else this.G==3&&(h?U1(this,h):this.i.length==0||b1(this.h)||U1(this))};function U1(h,x){var v;x?v=x.l:v=h.U++;const T=ws(h.I);qe(T,"SID",h.K),qe(T,"RID",v),qe(T,"AID",h.T),Wl(h,T),h.m&&h.o&&gp(T,h.m,h.o),v=new li(h,h.j,v,h.B+1),h.m===null&&(v.H=h.o),x&&(h.i=x.D.concat(h.i)),x=V1(h,v,1e3),v.I=Math.round(.5*h.wa)+Math.round(.5*h.wa*Math.random()),pp(h.h,v),dp(v,T,x)}function Wl(h,x){h.H&&F(h.H,function(v,T){qe(x,T,v)}),h.l&&T1({},function(v,T){qe(x,T,v)})}function V1(h,x,v){v=Math.min(h.i.length,v);var T=h.l?p(h.l.Na,h.l,h):null;e:{var L=h.i;let M=-1;for(;;){const W=["count="+v];M==-1?0<v?(M=L[0].g,W.push("ofs="+M)):M=0:W.push("ofs="+M);let Be=!0;for(let Dt=0;Dt<v;Dt++){let Pe=L[Dt].g;const Kt=L[Dt].map;if(Pe-=M,0>Pe)M=Math.max(0,L[Dt].g-100),Be=!1;else try{B5(Kt,W,"req"+Pe+"_")}catch{T&&T(Kt)}}if(Be){T=W.join("&");break e}}}return h=h.i.splice(0,v),x.D=h,T}function H1(h){if(!h.g&&!h.u){h.Y=1;var x=h.Fa;Ne||te(),H||(Ne(),H=!0),Y.add(x,h),h.v=0}}function yp(h){return h.g||h.u||3<=h.v?!1:(h.Y++,h.u=Ll(p(h.Fa,h),G1(h,h.v)),h.v++,!0)}t.Fa=function(){if(this.u=null,W1(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var h=2*this.R;this.j.info("BP detection timer enabled: "+h),this.A=Ll(p(this.ab,this),h)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,cn(10),dd(this),W1(this))};function vp(h){h.A!=null&&(l.clearTimeout(h.A),h.A=null)}function W1(h){h.g=new li(h,h.j,"rpc",h.Y),h.m===null&&(h.g.H=h.o),h.g.O=0;var x=ws(h.qa);qe(x,"RID","rpc"),qe(x,"SID",h.K),qe(x,"AID",h.T),qe(x,"CI",h.F?"0":"1"),!h.F&&h.ja&&qe(x,"TO",h.ja),qe(x,"TYPE","xmlhttp"),Wl(h,x),h.m&&h.o&&gp(x,h.m,h.o),h.L&&(h.g.I=h.L);var v=h.g;h=h.ia,v.L=1,v.v=od(ws(x)),v.m=null,v.P=!0,y1(v,h)}t.Za=function(){this.C!=null&&(this.C=null,dd(this),yp(this),cn(19))};function fd(h){h.C!=null&&(l.clearTimeout(h.C),h.C=null)}function q1(h,x){var v=null;if(h.g==x){fd(h),vp(h),h.g=null;var T=2}else if(mp(h.h,x))v=x.D,E1(h.h,x),T=1;else return;if(h.G!=0){if(x.o)if(T==1){v=x.m?x.m.length:0,x=Date.now()-x.F;var L=h.B;T=td(),ln(T,new m1(T,v)),hd(h)}else H1(h);else if(L=x.s,L==3||L==0&&0<x.X||!(T==1&&H5(h,x)||T==2&&yp(h)))switch(v&&0<v.length&&(x=h.h,x.i=x.i.concat(v)),L){case 1:la(h,5);break;case 4:la(h,10);break;case 3:la(h,6);break;default:la(h,2)}}}function G1(h,x){let v=h.Ta+Math.floor(Math.random()*h.cb);return h.isActive()||(v*=2),v*x}function la(h,x){if(h.j.info("Error code "+x),x==2){var v=p(h.fb,h),T=h.Xa;const L=!T;T=new oa(T||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||id(T,"https"),od(T),L?M5(T.toString(),v):O5(T.toString(),v)}else cn(2);h.G=0,h.l&&h.l.sa(x),Q1(h),z1(h)}t.fb=function(h){h?(this.j.info("Successfully pinged google.com"),cn(2)):(this.j.info("Failed to ping google.com"),cn(1))};function Q1(h){if(h.G=0,h.ka=[],h.l){const x=k1(h.h);(x.length!=0||h.i.length!=0)&&(_(h.ka,x),_(h.ka,h.i),h.h.i.length=0,w(h.i),h.i.length=0),h.l.ra()}}function K1(h,x,v){var T=v instanceof oa?ws(v):new oa(v);if(T.g!="")x&&(T.g=x+"."+T.g),ad(T,T.s);else{var L=l.location;T=L.protocol,x=x?x+"."+L.hostname:L.hostname,L=+L.port;var M=new oa(null);T&&id(M,T),x&&(M.g=x),L&&ad(M,L),v&&(M.l=v),T=M}return v=h.D,x=h.ya,v&&x&&qe(T,v,x),qe(T,"VER",h.la),Wl(h,T),T}function X1(h,x,v){if(x&&!h.J)throw Error("Can't create secondary domain capable XhrIo object.");return x=h.Ca&&!h.pa?new at(new ld({eb:v})):new at(h.pa),x.Ha(h.J),x}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Y1(){}t=Y1.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function md(){}md.prototype.g=function(h,x){return new On(h,x)};function On(h,x){Qt.call(this),this.g=new B1(x),this.l=h,this.h=x&&x.messageUrlParams||null,h=x&&x.messageHeaders||null,x&&x.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=x&&x.initMessageHeaders||null,x&&x.messageContentType&&(h?h["X-WebChannel-Content-Type"]=x.messageContentType:h={"X-WebChannel-Content-Type":x.messageContentType}),x&&x.va&&(h?h["X-WebChannel-Client-Profile"]=x.va:h={"X-WebChannel-Client-Profile":x.va}),this.g.S=h,(h=x&&x.Sb)&&!b(h)&&(this.g.m=h),this.v=x&&x.supportsCrossDomainXhr||!1,this.u=x&&x.sendRawJson||!1,(x=x&&x.httpSessionIdParam)&&!b(x)&&(this.g.D=x,h=this.h,h!==null&&x in h&&(h=this.h,x in h&&delete h[x])),this.j=new co(this)}y(On,Qt),On.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},On.prototype.close=function(){xp(this.g)},On.prototype.o=function(h){var x=this.g;if(typeof h=="string"){var v={};v.__data__=h,h=v}else this.u&&(v={},v.__data__=ip(h),h=v);x.i.push(new I5(x.Ya++,h)),x.G==3&&hd(x)},On.prototype.N=function(){this.g.l=null,delete this.j,xp(this.g),delete this.g,On.aa.N.call(this)};function J1(h){op.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var x=h.__sm__;if(x){e:{for(const v in x){h=v;break e}h=void 0}(this.i=h)&&(h=this.i,x=x!==null&&h in x?x[h]:void 0),this.data=x}else this.data=h}y(J1,op);function Z1(){lp.call(this),this.status=1}y(Z1,lp);function co(h){this.g=h}y(co,Y1),co.prototype.ua=function(){ln(this.g,"a")},co.prototype.ta=function(h){ln(this.g,new J1(h))},co.prototype.sa=function(h){ln(this.g,new Z1)},co.prototype.ra=function(){ln(this.g,"b")},md.prototype.createWebChannel=md.prototype.g,On.prototype.send=On.prototype.o,On.prototype.open=On.prototype.m,On.prototype.close=On.prototype.close,aj=function(){return new md},ij=function(){return td()},sj=ia,ax={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},nd.NO_ERROR=0,nd.TIMEOUT=8,nd.HTTP_ERROR=6,_h=nd,p1.COMPLETE="complete",rj=p1,u1.EventType=Fl,Fl.OPEN="a",Fl.CLOSE="b",Fl.ERROR="c",Fl.MESSAGE="d",Qt.prototype.listen=Qt.prototype.K,hc=u1,at.prototype.listenOnce=at.prototype.L,at.prototype.getLastError=at.prototype.Ka,at.prototype.getLastErrorCode=at.prototype.Ba,at.prototype.getStatus=at.prototype.Z,at.prototype.getResponseJson=at.prototype.Oa,at.prototype.getResponseText=at.prototype.oa,at.prototype.send=at.prototype.ea,at.prototype.setWithCredentials=at.prototype.Ha,nj=at}).apply(typeof Dd<"u"?Dd:typeof self<"u"?self:typeof window<"u"?window:{});const bS="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class en{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}en.UNAUTHENTICATED=new en(null),en.GOOGLE_CREDENTIALS=new en("google-credentials-uid"),en.FIRST_PARTY=new en("first-party-uid"),en.MOCK_USER=new en("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let _l="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ba=new xv("@firebase/firestore");function nc(){return Ba.logLevel}function X(t,...e){if(Ba.logLevel<=Ce.DEBUG){const n=e.map(Nv);Ba.debug(`Firestore (${_l}): ${t}`,...n)}}function qs(t,...e){if(Ba.logLevel<=Ce.ERROR){const n=e.map(Nv);Ba.error(`Firestore (${_l}): ${t}`,...n)}}function Zo(t,...e){if(Ba.logLevel<=Ce.WARN){const n=e.map(Nv);Ba.warn(`Firestore (${_l}): ${t}`,...n)}}function Nv(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oe(t="Unexpected state"){const e=`FIRESTORE (${_l}) INTERNAL ASSERTION FAILED: `+t;throw qs(e),new Error(e)}function Oe(t,e){t||oe()}function de(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class G extends vs{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ls{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oj{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class $8{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(en.UNAUTHENTICATED))}shutdown(){}}class B8{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class z8{constructor(e){this.t=e,this.currentUser=en.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Oe(this.o===void 0);let r=this.i;const s=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve();let i=new Ls;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Ls,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const c=i;e.enqueueRetryable(async()=>{await c.promise,await s(this.currentUser)})},l=c=>{X("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>l(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?l(c):(X("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Ls)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(X("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Oe(typeof r.accessToken=="string"),new oj(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Oe(e===null||typeof e=="string"),new en(e)}}class U8{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=en.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class V8{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new U8(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(en.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class H8{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class W8{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){Oe(this.o===void 0);const r=i=>{i.error!=null&&X("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.R;return this.R=i.token,X("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{X("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):X("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Oe(typeof n.token=="string"),this.R=n.token,new H8(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q8(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lj{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=q8(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%e.length))}return r}}function Fe(t,e){return t<e?-1:t>e?1:0}function el(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class It{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new G(z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new G(z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new G(z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new G(z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return It.fromMillis(Date.now())}static fromDate(e){return It.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new It(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Fe(this.nanoseconds,e.nanoseconds):Fe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ue{constructor(e){this.timestamp=e}static fromTimestamp(e){return new ue(e)}static min(){return new ue(new It(0,0))}static max(){return new ue(new It(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class su{constructor(e,n,r){n===void 0?n=0:n>e.length&&oe(),r===void 0?r=e.length-n:r>e.length-n&&oe(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return su.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof su?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=e.get(s),o=n.get(s);if(i<o)return-1;if(i>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class Qe extends su{construct(e,n,r){return new Qe(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new G(z.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new Qe(n)}static emptyPath(){return new Qe([])}}const G8=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Bt extends su{construct(e,n,r){return new Bt(e,n,r)}static isValidIdentifier(e){return G8.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Bt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Bt(["__name__"])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new G(z.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const l=e[s];if(l==="\\"){if(s+1===e.length)throw new G(z.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[s+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new G(z.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,s+=2}else l==="`"?(o=!o,s++):l!=="."||o?(r+=l,s++):(i(),s++)}if(i(),o)throw new G(z.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Bt(n)}static emptyPath(){return new Bt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z{constructor(e){this.path=e}static fromPath(e){return new Z(Qe.fromString(e))}static fromName(e){return new Z(Qe.fromString(e).popFirst(5))}static empty(){return new Z(Qe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Qe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Qe.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Z(new Qe(e.slice()))}}function Q8(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=ue.fromTimestamp(r===1e9?new It(n+1,0):new It(n,r));return new Hi(s,Z.empty(),e)}function K8(t){return new Hi(t.readTime,t.key,-1)}class Hi{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Hi(ue.min(),Z.empty(),-1)}static max(){return new Hi(ue.max(),Z.empty(),-1)}}function X8(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=Z.comparator(t.documentKey,e.documentKey),n!==0?n:Fe(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y8="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class J8{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Mu(t){if(t.code!==z.FAILED_PRECONDITION||t.message!==Y8)throw t;X("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&oe(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new U((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof U?n:U.resolve(n)}catch(n){return U.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):U.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):U.reject(n)}static resolve(e){return new U((n,r)=>{n(e)})}static reject(e){return new U((n,r)=>{r(e)})}static waitFor(e){return new U((n,r)=>{let s=0,i=0,o=!1;e.forEach(l=>{++s,l.next(()=>{++i,o&&i===s&&n()},c=>r(c))}),o=!0,i===s&&n()})}static or(e){let n=U.resolve(!1);for(const r of e)n=n.next(s=>s?U.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new U((r,s)=>{const i=e.length,o=new Array(i);let l=0;for(let c=0;c<i;c++){const u=c;n(e[u]).next(d=>{o[u]=d,++l,l===i&&r(o)},d=>s(d))}})}static doWhile(e,n){return new U((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}function Z8(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Ou(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pv{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Pv.oe=-1;function km(t){return t==null}function yf(t){return t===0&&1/t==-1/0}function eB(t){return typeof t=="number"&&Number.isInteger(t)&&!yf(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SS(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function to(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function cj(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class it{constructor(e,n){this.comparator=e,this.root=n||$t.EMPTY}insert(e,n){return new it(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,$t.BLACK,null,null))}remove(e){return new it(this.comparator,this.root.remove(e,this.comparator).copy(null,null,$t.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ld(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ld(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ld(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ld(this.root,e,this.comparator,!0)}}class Ld{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class $t{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??$t.RED,this.left=s??$t.EMPTY,this.right=i??$t.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new $t(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return $t.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return $t.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,$t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,$t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw oe();const e=this.left.check();if(e!==this.right.check())throw oe();return e+(this.isRed()?0:1)}}$t.EMPTY=null,$t.RED=!0,$t.BLACK=!1;$t.EMPTY=new class{constructor(){this.size=0}get key(){throw oe()}get value(){throw oe()}get color(){throw oe()}get left(){throw oe()}get right(){throw oe()}copy(e,n,r,s,i){return this}insert(e,n,r){return new $t(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ut{constructor(e){this.comparator=e,this.data=new it(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new ES(this.data.getIterator())}getIteratorFrom(e){return new ES(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Ut)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Ut(this.comparator);return n.data=e,n}}class ES{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wn{constructor(e){this.fields=e,e.sort(Bt.comparator)}static empty(){return new Wn([])}unionWith(e){let n=new Ut(Bt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Wn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return el(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uj extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new uj("Invalid base64 string: "+i):i}}(e);return new qt(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new qt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Fe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}qt.EMPTY_BYTE_STRING=new qt("");const tB=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Wi(t){if(Oe(!!t),typeof t=="string"){let e=0;const n=tB.exec(t);if(Oe(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ft(t.seconds),nanos:ft(t.nanos)}}function ft(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function za(t){return typeof t=="string"?qt.fromBase64String(t):qt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fv(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function Dv(t){const e=t.mapValue.fields.__previous_value__;return Fv(e)?Dv(e):e}function iu(t){const e=Wi(t.mapValue.fields.__local_write_time__.timestampValue);return new It(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nB{constructor(e,n,r,s,i,o,l,c,u){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=u}}class au{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new au("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof au&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Md={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Ua(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Fv(t)?4:sB(t)?9007199254740991:rB(t)?10:11:oe()}function fs(t,e){if(t===e)return!0;const n=Ua(t);if(n!==Ua(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return iu(t).isEqual(iu(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=Wi(s.timestampValue),l=Wi(i.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return za(s.bytesValue).isEqual(za(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return ft(s.geoPointValue.latitude)===ft(i.geoPointValue.latitude)&&ft(s.geoPointValue.longitude)===ft(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return ft(s.integerValue)===ft(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=ft(s.doubleValue),l=ft(i.doubleValue);return o===l?yf(o)===yf(l):isNaN(o)&&isNaN(l)}return!1}(t,e);case 9:return el(t.arrayValue.values||[],e.arrayValue.values||[],fs);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},l=i.mapValue.fields||{};if(SS(o)!==SS(l))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(l[c]===void 0||!fs(o[c],l[c])))return!1;return!0}(t,e);default:return oe()}}function ou(t,e){return(t.values||[]).find(n=>fs(n,e))!==void 0}function tl(t,e){if(t===e)return 0;const n=Ua(t),r=Ua(e);if(n!==r)return Fe(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Fe(t.booleanValue,e.booleanValue);case 2:return function(i,o){const l=ft(i.integerValue||i.doubleValue),c=ft(o.integerValue||o.doubleValue);return l<c?-1:l>c?1:l===c?0:isNaN(l)?isNaN(c)?0:-1:1}(t,e);case 3:return kS(t.timestampValue,e.timestampValue);case 4:return kS(iu(t),iu(e));case 5:return Fe(t.stringValue,e.stringValue);case 6:return function(i,o){const l=za(i),c=za(o);return l.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const l=i.split("/"),c=o.split("/");for(let u=0;u<l.length&&u<c.length;u++){const d=Fe(l[u],c[u]);if(d!==0)return d}return Fe(l.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const l=Fe(ft(i.latitude),ft(o.latitude));return l!==0?l:Fe(ft(i.longitude),ft(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return TS(t.arrayValue,e.arrayValue);case 10:return function(i,o){var l,c,u,d;const m=i.fields||{},p=o.fields||{},g=(l=m.value)===null||l===void 0?void 0:l.arrayValue,y=(c=p.value)===null||c===void 0?void 0:c.arrayValue,w=Fe(((u=g==null?void 0:g.values)===null||u===void 0?void 0:u.length)||0,((d=y==null?void 0:y.values)===null||d===void 0?void 0:d.length)||0);return w!==0?w:TS(g,y)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===Md.mapValue&&o===Md.mapValue)return 0;if(i===Md.mapValue)return 1;if(o===Md.mapValue)return-1;const l=i.fields||{},c=Object.keys(l),u=o.fields||{},d=Object.keys(u);c.sort(),d.sort();for(let m=0;m<c.length&&m<d.length;++m){const p=Fe(c[m],d[m]);if(p!==0)return p;const g=tl(l[c[m]],u[d[m]]);if(g!==0)return g}return Fe(c.length,d.length)}(t.mapValue,e.mapValue);default:throw oe()}}function kS(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Fe(t,e);const n=Wi(t),r=Wi(e),s=Fe(n.seconds,r.seconds);return s!==0?s:Fe(n.nanos,r.nanos)}function TS(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=tl(n[s],r[s]);if(i)return i}return Fe(n.length,r.length)}function nl(t){return ox(t)}function ox(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Wi(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return za(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return Z.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=ox(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${ox(n.fields[o])}`;return s+"}"}(t.mapValue):oe()}function IS(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function lx(t){return!!t&&"integerValue"in t}function Lv(t){return!!t&&"arrayValue"in t}function CS(t){return!!t&&"nullValue"in t}function jS(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function bh(t){return!!t&&"mapValue"in t}function rB(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function Tc(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return to(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Tc(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Tc(t.arrayValue.values[n]);return e}return Object.assign({},t)}function sB(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cn{constructor(e){this.value=e}static empty(){return new Cn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!bh(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Tc(n)}setAll(e){let n=Bt.emptyPath(),r={},s=[];e.forEach((o,l)=>{if(!n.isImmediateParentOf(l)){const c=this.getFieldsMap(n);this.applyChanges(c,r,s),r={},s=[],n=l.popLast()}o?r[l.lastSegment()]=Tc(o):s.push(l.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());bh(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return fs(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];bh(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){to(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new Cn(Tc(this.value))}}function dj(t){const e=[];return to(t.fields,(n,r)=>{const s=new Bt([n]);if(bh(r)){const i=dj(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new Wn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nn{constructor(e,n,r,s,i,o,l){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=l}static newInvalidDocument(e){return new nn(e,0,ue.min(),ue.min(),ue.min(),Cn.empty(),0)}static newFoundDocument(e,n,r,s){return new nn(e,1,n,ue.min(),r,s,0)}static newNoDocument(e,n){return new nn(e,2,n,ue.min(),ue.min(),Cn.empty(),0)}static newUnknownDocument(e,n){return new nn(e,3,n,ue.min(),ue.min(),Cn.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(ue.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Cn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Cn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ue.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof nn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new nn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vf{constructor(e,n){this.position=e,this.inclusive=n}}function RS(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=Z.comparator(Z.fromName(o.referenceValue),n.key):r=tl(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function AS(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!fs(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lu{constructor(e,n="asc"){this.field=e,this.dir=n}}function iB(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hj{}class _t extends hj{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new oB(e,n,r):n==="array-contains"?new uB(e,r):n==="in"?new dB(e,r):n==="not-in"?new hB(e,r):n==="array-contains-any"?new fB(e,r):new _t(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new lB(e,r):new cB(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(tl(n,this.value)):n!==null&&Ua(this.value)===Ua(n)&&this.matchesComparison(tl(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return oe()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ur extends hj{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new Ur(e,n)}matches(e){return fj(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function fj(t){return t.op==="and"}function mj(t){return aB(t)&&fj(t)}function aB(t){for(const e of t.filters)if(e instanceof Ur)return!1;return!0}function cx(t){if(t instanceof _t)return t.field.canonicalString()+t.op.toString()+nl(t.value);if(mj(t))return t.filters.map(e=>cx(e)).join(",");{const e=t.filters.map(n=>cx(n)).join(",");return`${t.op}(${e})`}}function pj(t,e){return t instanceof _t?function(r,s){return s instanceof _t&&r.op===s.op&&r.field.isEqual(s.field)&&fs(r.value,s.value)}(t,e):t instanceof Ur?function(r,s){return s instanceof Ur&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,l)=>i&&pj(o,s.filters[l]),!0):!1}(t,e):void oe()}function gj(t){return t instanceof _t?function(n){return`${n.field.canonicalString()} ${n.op} ${nl(n.value)}`}(t):t instanceof Ur?function(n){return n.op.toString()+" {"+n.getFilters().map(gj).join(" ,")+"}"}(t):"Filter"}class oB extends _t{constructor(e,n,r){super(e,n,r),this.key=Z.fromName(r.referenceValue)}matches(e){const n=Z.comparator(e.key,this.key);return this.matchesComparison(n)}}class lB extends _t{constructor(e,n){super(e,"in",n),this.keys=xj("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class cB extends _t{constructor(e,n){super(e,"not-in",n),this.keys=xj("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function xj(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>Z.fromName(r.referenceValue))}class uB extends _t{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Lv(n)&&ou(n.arrayValue,this.value)}}class dB extends _t{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&ou(this.value.arrayValue,n)}}class hB extends _t{constructor(e,n){super(e,"not-in",n)}matches(e){if(ou(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!ou(this.value.arrayValue,n)}}class fB extends _t{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Lv(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>ou(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mB{constructor(e,n=null,r=[],s=[],i=null,o=null,l=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=l,this.ue=null}}function NS(t,e=null,n=[],r=[],s=null,i=null,o=null){return new mB(t,e,n,r,s,i,o)}function Mv(t){const e=de(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>cx(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),km(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>nl(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>nl(r)).join(",")),e.ue=n}return e.ue}function Ov(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!iB(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!pj(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!AS(t.startAt,e.startAt)&&AS(t.endAt,e.endAt)}function ux(t){return Z.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bl{constructor(e,n=null,r=[],s=[],i=null,o="F",l=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=l,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function pB(t,e,n,r,s,i,o,l){return new bl(t,e,n,r,s,i,o,l)}function $v(t){return new bl(t)}function PS(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function yj(t){return t.collectionGroup!==null}function Ic(t){const e=de(t);if(e.ce===null){e.ce=[];const n=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new Ut(Bt.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(u=>{u.isInequality()&&(l=l.add(u.field))})}),l})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.ce.push(new lu(i,r))}),n.has(Bt.keyField().canonicalString())||e.ce.push(new lu(Bt.keyField(),r))}return e.ce}function ls(t){const e=de(t);return e.le||(e.le=gB(e,Ic(t))),e.le}function gB(t,e){if(t.limitType==="F")return NS(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new lu(s.field,i)});const n=t.endAt?new vf(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new vf(t.startAt.position,t.startAt.inclusive):null;return NS(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function dx(t,e){const n=t.filters.concat([e]);return new bl(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function wf(t,e,n){return new bl(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Tm(t,e){return Ov(ls(t),ls(e))&&t.limitType===e.limitType}function vj(t){return`${Mv(ls(t))}|lt:${t.limitType}`}function xo(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>gj(s)).join(", ")}]`),km(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>nl(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>nl(s)).join(",")),`Target(${r})`}(ls(t))}; limitType=${t.limitType})`}function Im(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):Z.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of Ic(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,l,c){const u=RS(o,l,c);return o.inclusive?u<=0:u<0}(r.startAt,Ic(r),s)||r.endAt&&!function(o,l,c){const u=RS(o,l,c);return o.inclusive?u>=0:u>0}(r.endAt,Ic(r),s))}(t,e)}function xB(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function wj(t){return(e,n)=>{let r=!1;for(const s of Ic(t)){const i=yB(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function yB(t,e,n){const r=t.field.isKeyField()?Z.comparator(e.key,n.key):function(i,o,l){const c=o.data.field(i),u=l.data.field(i);return c!==null&&u!==null?tl(c,u):oe()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return oe()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sl{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){to(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return cj(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vB=new it(Z.comparator);function Gs(){return vB}const _j=new it(Z.comparator);function fc(...t){let e=_j;for(const n of t)e=e.insert(n.key,n);return e}function bj(t){let e=_j;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Ea(){return Cc()}function Sj(){return Cc()}function Cc(){return new Sl(t=>t.toString(),(t,e)=>t.isEqual(e))}const wB=new it(Z.comparator),_B=new Ut(Z.comparator);function Ee(...t){let e=_B;for(const n of t)e=e.add(n);return e}const bB=new Ut(Fe);function SB(){return bB}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bv(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:yf(e)?"-0":e}}function Ej(t){return{integerValue:""+t}}function kj(t,e){return eB(e)?Ej(e):Bv(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cm{constructor(){this._=void 0}}function EB(t,e,n){return t instanceof cu?function(s,i){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&Fv(i)&&(i=Dv(i)),i&&(o.fields.__previous_value__=i),{mapValue:o}}(n,e):t instanceof uu?Ij(t,e):t instanceof du?Cj(t,e):function(s,i){const o=Tj(s,i),l=FS(o)+FS(s.Pe);return lx(o)&&lx(s.Pe)?Ej(l):Bv(s.serializer,l)}(t,e)}function kB(t,e,n){return t instanceof uu?Ij(t,e):t instanceof du?Cj(t,e):n}function Tj(t,e){return t instanceof hu?function(r){return lx(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class cu extends Cm{}class uu extends Cm{constructor(e){super(),this.elements=e}}function Ij(t,e){const n=jj(e);for(const r of t.elements)n.some(s=>fs(s,r))||n.push(r);return{arrayValue:{values:n}}}class du extends Cm{constructor(e){super(),this.elements=e}}function Cj(t,e){let n=jj(e);for(const r of t.elements)n=n.filter(s=>!fs(s,r));return{arrayValue:{values:n}}}class hu extends Cm{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function FS(t){return ft(t.integerValue||t.doubleValue)}function jj(t){return Lv(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rj{constructor(e,n){this.field=e,this.transform=n}}function TB(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof uu&&s instanceof uu||r instanceof du&&s instanceof du?el(r.elements,s.elements,fs):r instanceof hu&&s instanceof hu?fs(r.Pe,s.Pe):r instanceof cu&&s instanceof cu}(t.transform,e.transform)}class IB{constructor(e,n){this.version=e,this.transformResults=n}}class gn{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new gn}static exists(e){return new gn(void 0,e)}static updateTime(e){return new gn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Sh(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class jm{}function Aj(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Rm(t.key,gn.none()):new $u(t.key,t.data,gn.none());{const n=t.data,r=Cn.empty();let s=new Ut(Bt.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new Ji(t.key,r,new Wn(s.toArray()),gn.none())}}function CB(t,e,n){t instanceof $u?function(s,i,o){const l=s.value.clone(),c=LS(s.fieldTransforms,i,o.transformResults);l.setAll(c),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):t instanceof Ji?function(s,i,o){if(!Sh(s.precondition,i))return void i.convertToUnknownDocument(o.version);const l=LS(s.fieldTransforms,i,o.transformResults),c=i.data;c.setAll(Nj(s)),c.setAll(l),i.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function jc(t,e,n,r){return t instanceof $u?function(i,o,l,c){if(!Sh(i.precondition,o))return l;const u=i.value.clone(),d=MS(i.fieldTransforms,c,o);return u.setAll(d),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(t,e,n,r):t instanceof Ji?function(i,o,l,c){if(!Sh(i.precondition,o))return l;const u=MS(i.fieldTransforms,c,o),d=o.data;return d.setAll(Nj(i)),d.setAll(u),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),l===null?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(m=>m.field))}(t,e,n,r):function(i,o,l){return Sh(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(t,e,n)}function jB(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=Tj(r.transform,s||null);i!=null&&(n===null&&(n=Cn.empty()),n.set(r.field,i))}return n||null}function DS(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&el(r,s,(i,o)=>TB(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class $u extends jm{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Ji extends jm{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Nj(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function LS(t,e,n){const r=new Map;Oe(t.length===n.length);for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,l=e.data.field(i.field);r.set(i.field,kB(o,l,n[s]))}return r}function MS(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,EB(i,o,e))}return r}class Rm extends jm{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class RB extends jm{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AB{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&CB(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=jc(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=jc(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=Sj();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let l=this.applyToLocalView(o,i.mutatedFields);l=n.has(s.key)?null:l;const c=Aj(o,l);c!==null&&r.set(s.key,c),o.isValidDocument()||o.convertToNoDocument(ue.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Ee())}isEqual(e){return this.batchId===e.batchId&&el(this.mutations,e.mutations,(n,r)=>DS(n,r))&&el(this.baseMutations,e.baseMutations,(n,r)=>DS(n,r))}}class zv{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){Oe(e.mutations.length===r.length);let s=function(){return wB}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new zv(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NB{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PB{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var vt,Re;function FB(t){switch(t){default:return oe();case z.CANCELLED:case z.UNKNOWN:case z.DEADLINE_EXCEEDED:case z.RESOURCE_EXHAUSTED:case z.INTERNAL:case z.UNAVAILABLE:case z.UNAUTHENTICATED:return!1;case z.INVALID_ARGUMENT:case z.NOT_FOUND:case z.ALREADY_EXISTS:case z.PERMISSION_DENIED:case z.FAILED_PRECONDITION:case z.ABORTED:case z.OUT_OF_RANGE:case z.UNIMPLEMENTED:case z.DATA_LOSS:return!0}}function Pj(t){if(t===void 0)return qs("GRPC error has no .code"),z.UNKNOWN;switch(t){case vt.OK:return z.OK;case vt.CANCELLED:return z.CANCELLED;case vt.UNKNOWN:return z.UNKNOWN;case vt.DEADLINE_EXCEEDED:return z.DEADLINE_EXCEEDED;case vt.RESOURCE_EXHAUSTED:return z.RESOURCE_EXHAUSTED;case vt.INTERNAL:return z.INTERNAL;case vt.UNAVAILABLE:return z.UNAVAILABLE;case vt.UNAUTHENTICATED:return z.UNAUTHENTICATED;case vt.INVALID_ARGUMENT:return z.INVALID_ARGUMENT;case vt.NOT_FOUND:return z.NOT_FOUND;case vt.ALREADY_EXISTS:return z.ALREADY_EXISTS;case vt.PERMISSION_DENIED:return z.PERMISSION_DENIED;case vt.FAILED_PRECONDITION:return z.FAILED_PRECONDITION;case vt.ABORTED:return z.ABORTED;case vt.OUT_OF_RANGE:return z.OUT_OF_RANGE;case vt.UNIMPLEMENTED:return z.UNIMPLEMENTED;case vt.DATA_LOSS:return z.DATA_LOSS;default:return oe()}}(Re=vt||(vt={}))[Re.OK=0]="OK",Re[Re.CANCELLED=1]="CANCELLED",Re[Re.UNKNOWN=2]="UNKNOWN",Re[Re.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Re[Re.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Re[Re.NOT_FOUND=5]="NOT_FOUND",Re[Re.ALREADY_EXISTS=6]="ALREADY_EXISTS",Re[Re.PERMISSION_DENIED=7]="PERMISSION_DENIED",Re[Re.UNAUTHENTICATED=16]="UNAUTHENTICATED",Re[Re.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Re[Re.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Re[Re.ABORTED=10]="ABORTED",Re[Re.OUT_OF_RANGE=11]="OUT_OF_RANGE",Re[Re.UNIMPLEMENTED=12]="UNIMPLEMENTED",Re[Re.INTERNAL=13]="INTERNAL",Re[Re.UNAVAILABLE=14]="UNAVAILABLE",Re[Re.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DB(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LB=new Ca([4294967295,4294967295],0);function OS(t){const e=DB().encode(t),n=new tj;return n.update(e),new Uint8Array(n.digest())}function $S(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Ca([n,r],0),new Ca([s,i],0)]}class Uv{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new mc(`Invalid padding: ${n}`);if(r<0)throw new mc(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new mc(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new mc(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=Ca.fromNumber(this.Ie)}Ee(e,n,r){let s=e.add(n.multiply(Ca.fromNumber(r)));return s.compare(LB)===1&&(s=new Ca([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=OS(e),[r,s]=$S(n);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);if(!this.de(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new Uv(i,s,n);return r.forEach(l=>o.insert(l)),o}insert(e){if(this.Ie===0)return;const n=OS(e),[r,s]=$S(n);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);this.Ae(o)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class mc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Am{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,Bu.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Am(ue.min(),s,new it(Fe),Gs(),Ee())}}class Bu{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Bu(r,n,Ee(),Ee(),Ee())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eh{constructor(e,n,r,s){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=s}}class Fj{constructor(e,n){this.targetId=e,this.me=n}}class Dj{constructor(e,n,r=qt.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class BS{constructor(){this.fe=0,this.ge=US(),this.pe=qt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Ee(),n=Ee(),r=Ee();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:oe()}}),new Bu(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=US()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Oe(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class MB{constructor(e){this.Le=e,this.Be=new Map,this.ke=Gs(),this.qe=zS(),this.Qe=new it(Fe)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:oe()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,s)=>{this.ze(s)&&n(s)})}He(e){const n=e.targetId,r=e.me.count,s=this.Je(n);if(s){const i=s.target;if(ux(i))if(r===0){const o=new Z(i.path);this.Ue(n,o,nn.newNoDocument(o,ue.min()))}else Oe(r===1);else{const o=this.Ye(n);if(o!==r){const l=this.Ze(e),c=l?this.Xe(l,e,o):1;if(c!==0){this.je(n);const u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,u)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,l;try{o=za(r).toUint8Array()}catch(c){if(c instanceof uj)return Zo("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{l=new Uv(o,s,i)}catch(c){return Zo(c instanceof mc?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return l.Ie===0?null:l}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.Le.tt(),l=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(l)||(this.Ue(n,i,null),s++)}),s}rt(e){const n=new Map;this.Be.forEach((i,o)=>{const l=this.Je(o);if(l){if(i.current&&ux(l.target)){const c=new Z(l.target.path);this.ke.get(c)!==null||this.it(o,c)||this.Ue(o,c,nn.newNoDocument(c,e))}i.be&&(n.set(o,i.ve()),i.Ce())}});let r=Ee();this.qe.forEach((i,o)=>{let l=!0;o.forEachWhile(c=>{const u=this.Je(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(i))}),this.ke.forEach((i,o)=>o.setReadTime(e));const s=new Am(e,n,this.Qe,this.ke,r);return this.ke=Gs(),this.qe=zS(),this.Qe=new it(Fe),s}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,n)?s.Fe(n,1):s.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new BS,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new Ut(Fe),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||X("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new BS),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function zS(){return new it(Z.comparator)}function US(){return new it(Z.comparator)}const OB=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),$B=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),BB=(()=>({and:"AND",or:"OR"}))();class zB{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function hx(t,e){return t.useProto3Json||km(e)?e:{value:e}}function _f(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Lj(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function UB(t,e){return _f(t,e.toTimestamp())}function cs(t){return Oe(!!t),ue.fromTimestamp(function(n){const r=Wi(n);return new It(r.seconds,r.nanos)}(t))}function Vv(t,e){return fx(t,e).canonicalString()}function fx(t,e){const n=function(s){return new Qe(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function Mj(t){const e=Qe.fromString(t);return Oe(Uj(e)),e}function mx(t,e){return Vv(t.databaseId,e.path)}function gg(t,e){const n=Mj(e);if(n.get(1)!==t.databaseId.projectId)throw new G(z.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new G(z.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Z($j(n))}function Oj(t,e){return Vv(t.databaseId,e)}function VB(t){const e=Mj(t);return e.length===4?Qe.emptyPath():$j(e)}function px(t){return new Qe(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function $j(t){return Oe(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function VS(t,e,n){return{name:mx(t,e),fields:n.value.mapValue.fields}}function HB(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:oe()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(u,d){return u.useProto3Json?(Oe(d===void 0||typeof d=="string"),qt.fromBase64String(d||"")):(Oe(d===void 0||d instanceof Buffer||d instanceof Uint8Array),qt.fromUint8Array(d||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(u){const d=u.code===void 0?z.UNKNOWN:Pj(u.code);return new G(d,u.message||"")}(o);n=new Dj(r,s,i,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=gg(t,r.document.name),i=cs(r.document.updateTime),o=r.document.createTime?cs(r.document.createTime):ue.min(),l=new Cn({mapValue:{fields:r.document.fields}}),c=nn.newFoundDocument(s,i,o,l),u=r.targetIds||[],d=r.removedTargetIds||[];n=new Eh(u,d,c.key,c)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=gg(t,r.document),i=r.readTime?cs(r.readTime):ue.min(),o=nn.newNoDocument(s,i),l=r.removedTargetIds||[];n=new Eh([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=gg(t,r.document),i=r.removedTargetIds||[];n=new Eh([],i,s,null)}else{if(!("filter"in e))return oe();{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new PB(s,i),l=r.targetId;n=new Fj(l,o)}}return n}function WB(t,e){let n;if(e instanceof $u)n={update:VS(t,e.key,e.value)};else if(e instanceof Rm)n={delete:mx(t,e.key)};else if(e instanceof Ji)n={update:VS(t,e.key,e.data),updateMask:ez(e.fieldMask)};else{if(!(e instanceof RB))return oe();n={verify:mx(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const l=o.transform;if(l instanceof cu)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof uu)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof du)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof hu)return{fieldPath:o.field.canonicalString(),increment:l.Pe};throw oe()}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:UB(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:oe()}(t,e.precondition)),n}function qB(t,e){return t&&t.length>0?(Oe(e!==void 0),t.map(n=>function(s,i){let o=s.updateTime?cs(s.updateTime):cs(i);return o.isEqual(ue.min())&&(o=cs(i)),new IB(o,s.transformResults||[])}(n,e))):[]}function GB(t,e){return{documents:[Oj(t,e.path)]}}function QB(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=Oj(t,s);const i=function(u){if(u.length!==0)return zj(Ur.create(u,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(u){if(u.length!==0)return u.map(d=>function(p){return{field:yo(p.field),direction:YB(p.dir)}}(d))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const l=hx(t,e.limit);return l!==null&&(n.structuredQuery.limit=l),e.startAt&&(n.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{_t:n,parent:s}}function KB(t){let e=VB(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){Oe(r===1);const d=n.from[0];d.allDescendants?s=d.collectionId:e=e.child(d.collectionId)}let i=[];n.where&&(i=function(m){const p=Bj(m);return p instanceof Ur&&mj(p)?p.getFilters():[p]}(n.where));let o=[];n.orderBy&&(o=function(m){return m.map(p=>function(y){return new lu(vo(y.field),function(_){switch(_){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(y.direction))}(p))}(n.orderBy));let l=null;n.limit&&(l=function(m){let p;return p=typeof m=="object"?m.value:m,km(p)?null:p}(n.limit));let c=null;n.startAt&&(c=function(m){const p=!!m.before,g=m.values||[];return new vf(g,p)}(n.startAt));let u=null;return n.endAt&&(u=function(m){const p=!m.before,g=m.values||[];return new vf(g,p)}(n.endAt)),pB(e,s,o,i,l,"F",c,u)}function XB(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return oe()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function Bj(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=vo(n.unaryFilter.field);return _t.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=vo(n.unaryFilter.field);return _t.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=vo(n.unaryFilter.field);return _t.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=vo(n.unaryFilter.field);return _t.create(o,"!=",{nullValue:"NULL_VALUE"});default:return oe()}}(t):t.fieldFilter!==void 0?function(n){return _t.create(vo(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return oe()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Ur.create(n.compositeFilter.filters.map(r=>Bj(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return oe()}}(n.compositeFilter.op))}(t):oe()}function YB(t){return OB[t]}function JB(t){return $B[t]}function ZB(t){return BB[t]}function yo(t){return{fieldPath:t.canonicalString()}}function vo(t){return Bt.fromServerFormat(t.fieldPath)}function zj(t){return t instanceof _t?function(n){if(n.op==="=="){if(jS(n.value))return{unaryFilter:{field:yo(n.field),op:"IS_NAN"}};if(CS(n.value))return{unaryFilter:{field:yo(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(jS(n.value))return{unaryFilter:{field:yo(n.field),op:"IS_NOT_NAN"}};if(CS(n.value))return{unaryFilter:{field:yo(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:yo(n.field),op:JB(n.op),value:n.value}}}(t):t instanceof Ur?function(n){const r=n.getFilters().map(s=>zj(s));return r.length===1?r[0]:{compositeFilter:{op:ZB(n.op),filters:r}}}(t):oe()}function ez(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function Uj(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ti{constructor(e,n,r,s,i=ue.min(),o=ue.min(),l=qt.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(e){return new Ti(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Ti(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ti(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ti(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tz{constructor(e){this.ct=e}}function nz(t){const e=KB({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?wf(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rz{constructor(){this.un=new sz}addToCollectionParentIndex(e,n){return this.un.add(n),U.resolve()}getCollectionParents(e,n){return U.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return U.resolve()}deleteFieldIndex(e,n){return U.resolve()}deleteAllFieldIndexes(e){return U.resolve()}createTargetIndexes(e,n){return U.resolve()}getDocumentsMatchingTarget(e,n){return U.resolve(null)}getIndexType(e,n){return U.resolve(0)}getFieldIndexes(e,n){return U.resolve([])}getNextCollectionGroupToUpdate(e){return U.resolve(null)}getMinOffset(e,n){return U.resolve(Hi.min())}getMinOffsetFromCollectionGroup(e,n){return U.resolve(Hi.min())}updateCollectionGroup(e,n,r){return U.resolve()}updateIndexEntries(e,n){return U.resolve()}}class sz{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new Ut(Qe.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new Ut(Qe.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rl{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new rl(0)}static kn(){return new rl(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iz{constructor(){this.changes=new Sl(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,nn.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?U.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class az{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oz{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&jc(r.mutation,s,Wn.empty(),It.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Ee()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Ee()){const s=Ea();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=fc();return i.forEach((l,c)=>{o=o.insert(l,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=Ea();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Ee()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,l)=>{n.set(o,l)})})}computeViews(e,n,r,s){let i=Gs();const o=Cc(),l=function(){return Cc()}();return n.forEach((c,u)=>{const d=r.get(u.key);s.has(u.key)&&(d===void 0||d.mutation instanceof Ji)?i=i.insert(u.key,u):d!==void 0?(o.set(u.key,d.mutation.getFieldMask()),jc(d.mutation,u,d.mutation.getFieldMask(),It.now())):o.set(u.key,Wn.empty())}),this.recalculateAndSaveOverlays(e,i).next(c=>(c.forEach((u,d)=>o.set(u,d)),n.forEach((u,d)=>{var m;return l.set(u,new az(d,(m=o.get(u))!==null&&m!==void 0?m:null))}),l))}recalculateAndSaveOverlays(e,n){const r=Cc();let s=new it((o,l)=>o-l),i=Ee();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const l of o)l.keys().forEach(c=>{const u=n.get(c);if(u===null)return;let d=r.get(c)||Wn.empty();d=l.applyToLocalView(u,d),r.set(c,d);const m=(s.get(l.batchId)||Ee()).add(c);s=s.insert(l.batchId,m)})}).next(()=>{const o=[],l=s.getReverseIterator();for(;l.hasNext();){const c=l.getNext(),u=c.key,d=c.value,m=Sj();d.forEach(p=>{if(!i.has(p)){const g=Aj(n.get(p),r.get(p));g!==null&&m.set(p,g),i=i.add(p)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,m))}return U.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(o){return Z.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):yj(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):U.resolve(Ea());let l=-1,c=i;return o.next(u=>U.forEach(u,(d,m)=>(l<m.largestBatchId&&(l=m.largestBatchId),i.get(d)?U.resolve():this.remoteDocumentCache.getEntry(e,d).next(p=>{c=c.insert(d,p)}))).next(()=>this.populateOverlays(e,u,i)).next(()=>this.computeViews(e,c,u,Ee())).next(d=>({batchId:l,changes:bj(d)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new Z(n)).next(r=>{let s=fc();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=fc();return this.indexManager.getCollectionParents(e,i).next(l=>U.forEach(l,c=>{const u=function(m,p){return new bl(p,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)}(n,c.child(i));return this.getDocumentsMatchingCollectionQuery(e,u,r,s).next(d=>{d.forEach((m,p)=>{o=o.insert(m,p)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((c,u)=>{const d=u.getKey();o.get(d)===null&&(o=o.insert(d,nn.newInvalidDocument(d)))});let l=fc();return o.forEach((c,u)=>{const d=i.get(c);d!==void 0&&jc(d.mutation,u,Wn.empty(),It.now()),Im(n,u)&&(l=l.insert(c,u))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lz{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return U.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:cs(s.createTime)}}(n)),U.resolve()}getNamedQuery(e,n){return U.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(s){return{name:s.name,query:nz(s.bundledQuery),readTime:cs(s.readTime)}}(n)),U.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cz{constructor(){this.overlays=new it(Z.comparator),this.Ir=new Map}getOverlay(e,n){return U.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Ea();return U.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.ht(e,n,i)}),U.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.Ir.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(r)),U.resolve()}getOverlaysForCollection(e,n,r){const s=Ea(),i=n.length+1,o=new Z(n.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const c=l.getNext().value,u=c.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===i&&c.largestBatchId>r&&s.set(c.getKey(),c)}return U.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new it((u,d)=>u-d);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>r){let d=i.get(u.largestBatchId);d===null&&(d=Ea(),i=i.insert(u.largestBatchId,d)),d.set(u.getKey(),u)}}const l=Ea(),c=i.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,d)=>l.set(u,d)),!(l.size()>=s)););return U.resolve(l)}ht(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.Ir.get(s.largestBatchId).delete(r.key);this.Ir.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new NB(n,r));let i=this.Ir.get(n);i===void 0&&(i=Ee(),this.Ir.set(n,i)),this.Ir.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uz{constructor(){this.sessionToken=qt.EMPTY_BYTE_STRING}getSessionToken(e){return U.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,U.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hv{constructor(){this.Tr=new Ut(Rt.Er),this.dr=new Ut(Rt.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new Rt(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new Rt(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new Z(new Qe([])),r=new Rt(n,e),s=new Rt(n,e+1),i=[];return this.dr.forEachInRange([r,s],o=>{this.Vr(o),i.push(o.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new Z(new Qe([])),r=new Rt(n,e),s=new Rt(n,e+1);let i=Ee();return this.dr.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new Rt(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Rt{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return Z.comparator(e.key,n.key)||Fe(e.wr,n.wr)}static Ar(e,n){return Fe(e.wr,n.wr)||Z.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dz{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new Ut(Rt.Er)}checkEmpty(e){return U.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new AB(i,n,r,s);this.mutationQueue.push(o);for(const l of s)this.br=this.br.add(new Rt(l.key,i)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return U.resolve(o)}lookupMutationBatch(e,n){return U.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.vr(r),i=s<0?0:s;return U.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return U.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return U.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Rt(n,0),s=new Rt(n,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([r,s],o=>{const l=this.Dr(o.wr);i.push(l)}),U.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Ut(Fe);return n.forEach(s=>{const i=new Rt(s,0),o=new Rt(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,o],l=>{r=r.add(l.wr)})}),U.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;Z.isDocumentKey(i)||(i=i.child(""));const o=new Rt(new Z(i),0);let l=new Ut(Fe);return this.br.forEachWhile(c=>{const u=c.key.path;return!!r.isPrefixOf(u)&&(u.length===s&&(l=l.add(c.wr)),!0)},o),U.resolve(this.Cr(l))}Cr(e){const n=[];return e.forEach(r=>{const s=this.Dr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){Oe(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return U.forEach(n.mutations,s=>{const i=new Rt(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new Rt(n,0),s=this.br.firstAfterOrEqual(r);return U.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,U.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hz{constructor(e){this.Mr=e,this.docs=function(){return new it(Z.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return U.resolve(r?r.document.mutableCopy():nn.newInvalidDocument(n))}getEntries(e,n){let r=Gs();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():nn.newInvalidDocument(s))}),U.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=Gs();const o=n.path,l=new Z(o.child("")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){const{key:u,value:{document:d}}=c.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||X8(K8(d),r)<=0||(s.has(d.key)||Im(n,d))&&(i=i.insert(d.key,d.mutableCopy()))}return U.resolve(i)}getAllFromCollectionGroup(e,n,r,s){oe()}Or(e,n){return U.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new fz(this)}getSize(e){return U.resolve(this.size)}}class fz extends iz{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.cr.addEntry(e,s)):this.cr.removeEntry(r)}),U.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mz{constructor(e){this.persistence=e,this.Nr=new Sl(n=>Mv(n),Ov),this.lastRemoteSnapshotVersion=ue.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Hv,this.targetCount=0,this.kr=rl.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,s)=>n(s)),U.resolve()}getLastRemoteSnapshotVersion(e){return U.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return U.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),U.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),U.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new rl(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,U.resolve()}updateTargetData(e,n){return this.Kn(n),U.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,U.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.Nr.forEach((o,l)=>{l.sequenceNumber<=n&&r.get(l.targetId)===null&&(this.Nr.delete(o),i.push(this.removeMatchingKeysForTargetId(e,l.targetId)),s++)}),U.waitFor(i).next(()=>s)}getTargetCount(e){return U.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return U.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),U.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),U.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),U.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return U.resolve(r)}containsKey(e,n){return U.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pz{constructor(e,n){this.qr={},this.overlays={},this.Qr=new Pv(0),this.Kr=!1,this.Kr=!0,this.$r=new uz,this.referenceDelegate=e(this),this.Ur=new mz(this),this.indexManager=new rz,this.remoteDocumentCache=function(s){return new hz(s)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new tz(n),this.Gr=new lz(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new cz,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new dz(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){X("MemoryPersistence","Starting transaction:",e);const s=new gz(this.Qr.next());return this.referenceDelegate.zr(),r(s).next(i=>this.referenceDelegate.jr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Hr(e,n){return U.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}}class gz extends J8{constructor(e){super(),this.currentSequenceNumber=e}}class Wv{constructor(e){this.persistence=e,this.Jr=new Hv,this.Yr=null}static Zr(e){return new Wv(e)}get Xr(){if(this.Yr)return this.Yr;throw oe()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),U.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),U.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),U.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(s=>this.Xr.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.Xr.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return U.forEach(this.Xr,r=>{const s=Z.fromPath(r);return this.ei(e,s).next(i=>{i||n.removeEntry(s,ue.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return U.or([()=>U.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qv{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=s}static Wi(e,n){let r=Ee(),s=Ee();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new qv(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xz{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yz{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return x9()?8:Z8(an())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.Yi(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.Zi(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new xz;return this.Xi(e,n,o).next(l=>{if(i.result=l,this.zi)return this.es(e,n,o,l.size)})}).next(()=>i.result)}es(e,n,r,s){return r.documentReadCount<this.ji?(nc()<=Ce.DEBUG&&X("QueryEngine","SDK will not create cache indexes for query:",xo(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),U.resolve()):(nc()<=Ce.DEBUG&&X("QueryEngine","Query:",xo(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.Hi*s?(nc()<=Ce.DEBUG&&X("QueryEngine","The SDK decides to create cache indexes for query:",xo(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ls(n))):U.resolve())}Yi(e,n){if(PS(n))return U.resolve(null);let r=ls(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=wf(n,null,"F"),r=ls(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=Ee(...i);return this.Ji.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,r).next(c=>{const u=this.ts(n,l);return this.ns(n,u,o,c.readTime)?this.Yi(e,wf(n,null,"F")):this.rs(e,u,n,c)}))})))}Zi(e,n,r,s){return PS(n)||s.isEqual(ue.min())?U.resolve(null):this.Ji.getDocuments(e,r).next(i=>{const o=this.ts(n,i);return this.ns(n,o,r,s)?U.resolve(null):(nc()<=Ce.DEBUG&&X("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),xo(n)),this.rs(e,o,n,Q8(s,-1)).next(l=>l))})}ts(e,n){let r=new Ut(wj(e));return n.forEach((s,i)=>{Im(e,i)&&(r=r.add(i))}),r}ns(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Xi(e,n,r){return nc()<=Ce.DEBUG&&X("QueryEngine","Using full collection scan to execute query:",xo(n)),this.Ji.getDocumentsMatchingQuery(e,n,Hi.min(),r)}rs(e,n,r,s){return this.Ji.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vz{constructor(e,n,r,s){this.persistence=e,this.ss=n,this.serializer=s,this.os=new it(Fe),this._s=new Sl(i=>Mv(i),Ov),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new oz(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function wz(t,e,n,r){return new vz(t,e,n,r)}async function Vj(t,e){const n=de(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],l=[];let c=Ee();for(const u of s){o.push(u.batchId);for(const d of u.mutations)c=c.add(d.key)}for(const u of i){l.push(u.batchId);for(const d of u.mutations)c=c.add(d.key)}return n.localDocuments.getDocuments(r,c).next(u=>({hs:u,removedBatchIds:o,addedBatchIds:l}))})})}function _z(t,e){const n=de(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.cs.newChangeBuffer({trackRemovals:!0});return function(l,c,u,d){const m=u.batch,p=m.keys();let g=U.resolve();return p.forEach(y=>{g=g.next(()=>d.getEntry(c,y)).next(w=>{const _=u.docVersions.get(y);Oe(_!==null),w.version.compareTo(_)<0&&(m.applyToRemoteDocument(w,u),w.isValidDocument()&&(w.setReadTime(u.commitVersion),d.addEntry(w)))})}),g.next(()=>l.mutationQueue.removeMutationBatch(c,m))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let c=Ee();for(let u=0;u<l.mutationResults.length;++u)l.mutationResults[u].transformResults.length>0&&(c=c.add(l.batch.mutations[u].key));return c}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function Hj(t){const e=de(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function bz(t,e){const n=de(t),r=e.snapshotVersion;let s=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.cs.newChangeBuffer({trackRemovals:!0});s=n.os;const l=[];e.targetChanges.forEach((d,m)=>{const p=s.get(m);if(!p)return;l.push(n.Ur.removeMatchingKeys(i,d.removedDocuments,m).next(()=>n.Ur.addMatchingKeys(i,d.addedDocuments,m)));let g=p.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(m)!==null?g=g.withResumeToken(qt.EMPTY_BYTE_STRING,ue.min()).withLastLimboFreeSnapshotVersion(ue.min()):d.resumeToken.approximateByteSize()>0&&(g=g.withResumeToken(d.resumeToken,r)),s=s.insert(m,g),function(w,_,E){return w.resumeToken.approximateByteSize()===0||_.snapshotVersion.toMicroseconds()-w.snapshotVersion.toMicroseconds()>=3e8?!0:E.addedDocuments.size+E.modifiedDocuments.size+E.removedDocuments.size>0}(p,g,d)&&l.push(n.Ur.updateTargetData(i,g))});let c=Gs(),u=Ee();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(i,d))}),l.push(Sz(i,o,e.documentUpdates).next(d=>{c=d.Ps,u=d.Is})),!r.isEqual(ue.min())){const d=n.Ur.getLastRemoteSnapshotVersion(i).next(m=>n.Ur.setTargetsMetadata(i,i.currentSequenceNumber,r));l.push(d)}return U.waitFor(l).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,c,u)).next(()=>c)}).then(i=>(n.os=s,i))}function Sz(t,e,n){let r=Ee(),s=Ee();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=Gs();return n.forEach((l,c)=>{const u=i.get(l);c.isFoundDocument()!==u.isFoundDocument()&&(s=s.add(l)),c.isNoDocument()&&c.version.isEqual(ue.min())?(e.removeEntry(l,c.readTime),o=o.insert(l,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),o=o.insert(l,c)):X("LocalStore","Ignoring outdated watch update for ",l,". Current version:",u.version," Watch version:",c.version)}),{Ps:o,Is:s}})}function Ez(t,e){const n=de(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function kz(t,e){const n=de(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Ur.getTargetData(r,e).next(i=>i?(s=i,U.resolve(s)):n.Ur.allocateTargetId(r).next(o=>(s=new Ti(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.os.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function gx(t,e,n){const r=de(t),s=r.os.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!Ou(o))throw o;X("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(s.target)}function HS(t,e,n){const r=de(t);let s=ue.min(),i=Ee();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,u,d){const m=de(c),p=m._s.get(d);return p!==void 0?U.resolve(m.os.get(p)):m.Ur.getTargetData(u,d)}(r,o,ls(e)).next(l=>{if(l)return s=l.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,l.targetId).next(c=>{i=c})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,n?s:ue.min(),n?i:Ee())).next(l=>(Tz(r,xB(e),l),{documents:l,Ts:i})))}function Tz(t,e,n){let r=t.us.get(e)||ue.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.us.set(e,r)}class WS{constructor(){this.activeTargetIds=SB()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Iz{constructor(){this.so=new WS,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new WS,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cz{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qS{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){X("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){X("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Od=null;function xg(){return Od===null?Od=function(){return 268435456+Math.round(2147483648*Math.random())}():Od++,"0x"+Od.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jz={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rz{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zt="WebChannelConnection";class Az extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${s}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get Fo(){return!1}Mo(n,r,s,i,o){const l=xg(),c=this.xo(n,r.toUriEncodedString());X("RestConnection",`Sending RPC '${n}' ${l}:`,c,s);const u={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(u,i,o),this.No(n,c,u,s).then(d=>(X("RestConnection",`Received RPC '${n}' ${l}: `,d),d),d=>{throw Zo("RestConnection",`RPC '${n}' ${l} failed with error: `,d,"url: ",c,"request:",s),d})}Lo(n,r,s,i,o,l){return this.Mo(n,r,s,i,o)}Oo(n,r,s){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+_l}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,o)=>n[o]=i),s&&s.headers.forEach((i,o)=>n[o]=i)}xo(n,r){const s=jz[n];return`${this.Do}/v1/${r}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,s){const i=xg();return new Promise((o,l)=>{const c=new nj;c.setWithCredentials(!0),c.listenOnce(rj.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case _h.NO_ERROR:const d=c.getResponseJson();X(Zt,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(d)),o(d);break;case _h.TIMEOUT:X(Zt,`RPC '${e}' ${i} timed out`),l(new G(z.DEADLINE_EXCEEDED,"Request time out"));break;case _h.HTTP_ERROR:const m=c.getStatus();if(X(Zt,`RPC '${e}' ${i} failed with status:`,m,"response text:",c.getResponseText()),m>0){let p=c.getResponseJson();Array.isArray(p)&&(p=p[0]);const g=p==null?void 0:p.error;if(g&&g.status&&g.message){const y=function(_){const E=_.toLowerCase().replace(/_/g,"-");return Object.values(z).indexOf(E)>=0?E:z.UNKNOWN}(g.status);l(new G(y,g.message))}else l(new G(z.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new G(z.UNAVAILABLE,"Connection failed."));break;default:oe()}}finally{X(Zt,`RPC '${e}' ${i} completed.`)}});const u=JSON.stringify(s);X(Zt,`RPC '${e}' ${i} sending request:`,s),c.send(n,"POST",u,r,15)})}Bo(e,n,r){const s=xg(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=aj(),l=ij(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Oo(c.initMessageHeaders,n,r),c.encodeInitMessageHeaders=!0;const d=i.join("");X(Zt,`Creating RPC '${e}' stream ${s}: ${d}`,c);const m=o.createWebChannel(d,c);let p=!1,g=!1;const y=new Rz({Io:_=>{g?X(Zt,`Not sending because RPC '${e}' stream ${s} is closed:`,_):(p||(X(Zt,`Opening RPC '${e}' stream ${s} transport.`),m.open(),p=!0),X(Zt,`RPC '${e}' stream ${s} sending:`,_),m.send(_))},To:()=>m.close()}),w=(_,E,b)=>{_.listen(E,S=>{try{b(S)}catch(C){setTimeout(()=>{throw C},0)}})};return w(m,hc.EventType.OPEN,()=>{g||(X(Zt,`RPC '${e}' stream ${s} transport opened.`),y.yo())}),w(m,hc.EventType.CLOSE,()=>{g||(g=!0,X(Zt,`RPC '${e}' stream ${s} transport closed`),y.So())}),w(m,hc.EventType.ERROR,_=>{g||(g=!0,Zo(Zt,`RPC '${e}' stream ${s} transport errored:`,_),y.So(new G(z.UNAVAILABLE,"The operation could not be completed")))}),w(m,hc.EventType.MESSAGE,_=>{var E;if(!g){const b=_.data[0];Oe(!!b);const S=b,C=S.error||((E=S[0])===null||E===void 0?void 0:E.error);if(C){X(Zt,`RPC '${e}' stream ${s} received error:`,C);const D=C.status;let F=function(R){const j=vt[R];if(j!==void 0)return Pj(j)}(D),I=C.message;F===void 0&&(F=z.INTERNAL,I="Unknown error status: "+D+" with message "+C.message),g=!0,y.So(new G(F,I)),m.close()}else X(Zt,`RPC '${e}' stream ${s} received:`,b),y.bo(b)}}),w(l,sj.STAT_EVENT,_=>{_.stat===ax.PROXY?X(Zt,`RPC '${e}' stream ${s} detected buffering proxy`):_.stat===ax.NOPROXY&&X(Zt,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{y.wo()},0),y}}function yg(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nm(t){return new zB(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wj{constructor(e,n,r=1e3,s=1.5,i=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=s,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),s=Math.max(0,n-r);s>0&&X("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qj{constructor(e,n,r,s,i,o,l,c){this.ui=e,this.Ho=r,this.Jo=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new Wj(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===z.RESOURCE_EXHAUSTED?(qs(n.toString()),qs("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===z.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Yo===n&&this.P_(r,s)},r=>{e(()=>{const s=new G(z.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(s)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{r(()=>this.I_(s))}),this.stream.onMessage(s=>{r(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return X("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(X("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Nz extends qj{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=HB(this.serializer,e),r=function(i){if(!("targetChange"in i))return ue.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?ue.min():o.readTime?cs(o.readTime):ue.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=px(this.serializer),n.addTarget=function(i,o){let l;const c=o.target;if(l=ux(c)?{documents:GB(i,c)}:{query:QB(i,c)._t},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=Lj(i,o.resumeToken);const u=hx(i,o.expectedCount);u!==null&&(l.expectedCount=u)}else if(o.snapshotVersion.compareTo(ue.min())>0){l.readTime=_f(i,o.snapshotVersion.toTimestamp());const u=hx(i,o.expectedCount);u!==null&&(l.expectedCount=u)}return l}(this.serializer,e);const r=XB(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=px(this.serializer),n.removeTarget=e,this.a_(n)}}class Pz extends qj{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return Oe(!!e.streamToken),this.lastStreamToken=e.streamToken,Oe(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Oe(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=qB(e.writeResults,e.commitTime),r=cs(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=px(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>WB(this.serializer,r))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fz extends class{}{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new G(z.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Mo(e,fx(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new G(z.UNKNOWN,i.toString())})}Lo(e,n,r,s,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Lo(e,fx(n,r),s,o,l,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new G(z.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class Dz{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(qs(n),this.D_=!1):X("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lz{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(o=>{r.enqueueAndForget(async()=>{no(this)&&(X("RemoteStore","Restarting streams for network reachability change."),await async function(c){const u=de(c);u.L_.add(4),await zu(u),u.q_.set("Unknown"),u.L_.delete(4),await Pm(u)}(this))})}),this.q_=new Dz(r,s)}}async function Pm(t){if(no(t))for(const e of t.B_)await e(!0)}async function zu(t){for(const e of t.B_)await e(!1)}function Gj(t,e){const n=de(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),Xv(n)?Kv(n):El(n).r_()&&Qv(n,e))}function Gv(t,e){const n=de(t),r=El(n);n.N_.delete(e),r.r_()&&Qj(n,e),n.N_.size===0&&(r.r_()?r.o_():no(n)&&n.q_.set("Unknown"))}function Qv(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ue.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}El(t).A_(e)}function Qj(t,e){t.Q_.xe(e),El(t).R_(e)}function Kv(t){t.Q_=new MB({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),El(t).start(),t.q_.v_()}function Xv(t){return no(t)&&!El(t).n_()&&t.N_.size>0}function no(t){return de(t).L_.size===0}function Kj(t){t.Q_=void 0}async function Mz(t){t.q_.set("Online")}async function Oz(t){t.N_.forEach((e,n)=>{Qv(t,e)})}async function $z(t,e){Kj(t),Xv(t)?(t.q_.M_(e),Kv(t)):t.q_.set("Unknown")}async function Bz(t,e,n){if(t.q_.set("Online"),e instanceof Dj&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const l of i.targetIds)s.N_.has(l)&&(await s.remoteSyncer.rejectListen(l,o),s.N_.delete(l),s.Q_.removeTarget(l))}(t,e)}catch(r){X("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await bf(t,r)}else if(e instanceof Eh?t.Q_.Ke(e):e instanceof Fj?t.Q_.He(e):t.Q_.We(e),!n.isEqual(ue.min()))try{const r=await Hj(t.localStore);n.compareTo(r)>=0&&await function(i,o){const l=i.Q_.rt(o);return l.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){const d=i.N_.get(u);d&&i.N_.set(u,d.withResumeToken(c.resumeToken,o))}}),l.targetMismatches.forEach((c,u)=>{const d=i.N_.get(c);if(!d)return;i.N_.set(c,d.withResumeToken(qt.EMPTY_BYTE_STRING,d.snapshotVersion)),Qj(i,c);const m=new Ti(d.target,c,u,d.sequenceNumber);Qv(i,m)}),i.remoteSyncer.applyRemoteEvent(l)}(t,n)}catch(r){X("RemoteStore","Failed to raise snapshot:",r),await bf(t,r)}}async function bf(t,e,n){if(!Ou(e))throw e;t.L_.add(1),await zu(t),t.q_.set("Offline"),n||(n=()=>Hj(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{X("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await Pm(t)})}function Xj(t,e){return e().catch(n=>bf(t,n,e))}async function Fm(t){const e=de(t),n=qi(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;zz(e);)try{const s=await Ez(e.localStore,r);if(s===null){e.O_.length===0&&n.o_();break}r=s.batchId,Uz(e,s)}catch(s){await bf(e,s)}Yj(e)&&Jj(e)}function zz(t){return no(t)&&t.O_.length<10}function Uz(t,e){t.O_.push(e);const n=qi(t);n.r_()&&n.V_&&n.m_(e.mutations)}function Yj(t){return no(t)&&!qi(t).n_()&&t.O_.length>0}function Jj(t){qi(t).start()}async function Vz(t){qi(t).p_()}async function Hz(t){const e=qi(t);for(const n of t.O_)e.m_(n.mutations)}async function Wz(t,e,n){const r=t.O_.shift(),s=zv.from(r,e,n);await Xj(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await Fm(t)}async function qz(t,e){e&&qi(t).V_&&await async function(r,s){if(function(o){return FB(o)&&o!==z.ABORTED}(s.code)){const i=r.O_.shift();qi(r).s_(),await Xj(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await Fm(r)}}(t,e),Yj(t)&&Jj(t)}async function GS(t,e){const n=de(t);n.asyncQueue.verifyOperationInProgress(),X("RemoteStore","RemoteStore received new credentials");const r=no(n);n.L_.add(3),await zu(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await Pm(n)}async function Gz(t,e){const n=de(t);e?(n.L_.delete(2),await Pm(n)):e||(n.L_.add(2),await zu(n),n.q_.set("Unknown"))}function El(t){return t.K_||(t.K_=function(n,r,s){const i=de(n);return i.w_(),new Nz(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:Mz.bind(null,t),Ro:Oz.bind(null,t),mo:$z.bind(null,t),d_:Bz.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),Xv(t)?Kv(t):t.q_.set("Unknown")):(await t.K_.stop(),Kj(t))})),t.K_}function qi(t){return t.U_||(t.U_=function(n,r,s){const i=de(n);return i.w_(),new Pz(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:Vz.bind(null,t),mo:qz.bind(null,t),f_:Hz.bind(null,t),g_:Wz.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await Fm(t)):(await t.U_.stop(),t.O_.length>0&&(X("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yv{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new Ls,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,l=new Yv(e,n,o,s,i);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new G(z.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Jv(t,e){if(qs("AsyncQueue",`${e}: ${t}`),Ou(t))return new G(z.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vo{constructor(e){this.comparator=e?(n,r)=>e(n,r)||Z.comparator(n.key,r.key):(n,r)=>Z.comparator(n.key,r.key),this.keyedMap=fc(),this.sortedSet=new it(this.comparator)}static emptySet(e){return new Vo(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Vo)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Vo;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QS{constructor(){this.W_=new it(Z.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):oe():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}}class sl{constructor(e,n,r,s,i,o,l,c,u){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(l=>{o.push({type:0,doc:l})}),new sl(e,n,Vo.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Tm(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qz{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class Kz{constructor(){this.queries=KS(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const s=de(n),i=s.queries;s.queries=KS(),i.forEach((o,l)=>{for(const c of l.j_)c.onError(r)})})(this,new G(z.ABORTED,"Firestore shutting down"))}}function KS(){return new Sl(t=>vj(t),Tm)}async function Zj(t,e){const n=de(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.H_()&&e.J_()&&(r=2):(i=new Qz,r=e.J_()?0:1);try{switch(r){case 0:i.z_=await n.onListen(s,!0);break;case 1:i.z_=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const l=Jv(o,`Initialization of query '${xo(e.query)}' failed`);return void e.onError(l)}n.queries.set(s,i),i.j_.push(e),e.Z_(n.onlineState),i.z_&&e.X_(i.z_)&&Zv(n)}async function eR(t,e){const n=de(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const o=i.j_.indexOf(e);o>=0&&(i.j_.splice(o,1),i.j_.length===0?s=e.J_()?0:1:!i.H_()&&e.J_()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function Xz(t,e){const n=de(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const l of o.j_)l.X_(s)&&(r=!0);o.z_=s}}r&&Zv(n)}function Yz(t,e,n){const r=de(t),s=r.queries.get(e);if(s)for(const i of s.j_)i.onError(n);r.queries.delete(e)}function Zv(t){t.Y_.forEach(e=>{e.next()})}var xx,XS;(XS=xx||(xx={})).ea="default",XS.Cache="cache";class tR{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new sl(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=sl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==xx.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nR{constructor(e){this.key=e}}class rR{constructor(e){this.key=e}}class Jz{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Ee(),this.mutatedKeys=Ee(),this.Aa=wj(e),this.Ra=new Vo(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new QS,s=n?n.Ra:this.Ra;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,l=!1;const c=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,u=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((d,m)=>{const p=s.get(d),g=Im(this.query,m)?m:null,y=!!p&&this.mutatedKeys.has(p.key),w=!!g&&(g.hasLocalMutations||this.mutatedKeys.has(g.key)&&g.hasCommittedMutations);let _=!1;p&&g?p.data.isEqual(g.data)?y!==w&&(r.track({type:3,doc:g}),_=!0):this.ga(p,g)||(r.track({type:2,doc:g}),_=!0,(c&&this.Aa(g,c)>0||u&&this.Aa(g,u)<0)&&(l=!0)):!p&&g?(r.track({type:0,doc:g}),_=!0):p&&!g&&(r.track({type:1,doc:p}),_=!0,(c||u)&&(l=!0)),_&&(g?(o=o.add(g),i=w?i.add(d):i.delete(d)):(o=o.delete(d),i=i.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),i=i.delete(d.key),r.track({type:1,doc:d})}return{Ra:o,fa:r,ns:l,mutatedKeys:i}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((d,m)=>function(g,y){const w=_=>{switch(_){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return oe()}};return w(g)-w(y)}(d.type,m.type)||this.Aa(d.doc,m.doc)),this.pa(r),s=s!=null&&s;const l=n&&!s?this.ya():[],c=this.da.size===0&&this.current&&!s?1:0,u=c!==this.Ea;return this.Ea=c,o.length!==0||u?{snapshot:new sl(this.query,e.Ra,i,o,e.mutatedKeys,c===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:l}:{wa:l}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new QS,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Ee(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new rR(r))}),this.da.forEach(r=>{e.has(r)||n.push(new nR(r))}),n}ba(e){this.Ta=e.Ts,this.da=Ee();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return sl.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class Zz{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class eU{constructor(e){this.key=e,this.va=!1}}class tU{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new Sl(l=>vj(l),Tm),this.Ma=new Map,this.xa=new Set,this.Oa=new it(Z.comparator),this.Na=new Map,this.La=new Hv,this.Ba={},this.ka=new Map,this.qa=rl.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function nU(t,e,n=!0){const r=cR(t);let s;const i=r.Fa.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.Da()):s=await sR(r,e,n,!0),s}async function rU(t,e){const n=cR(t);await sR(n,e,!0,!1)}async function sR(t,e,n,r){const s=await kz(t.localStore,ls(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let l;return r&&(l=await sU(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&Gj(t.remoteStore,s),l}async function sU(t,e,n,r,s){t.Ka=(m,p,g)=>async function(w,_,E,b){let S=_.view.ma(E);S.ns&&(S=await HS(w.localStore,_.query,!1).then(({documents:I})=>_.view.ma(I,S)));const C=b&&b.targetChanges.get(_.targetId),D=b&&b.targetMismatches.get(_.targetId)!=null,F=_.view.applyChanges(S,w.isPrimaryClient,C,D);return JS(w,_.targetId,F.wa),F.snapshot}(t,m,p,g);const i=await HS(t.localStore,e,!0),o=new Jz(e,i.Ts),l=o.ma(i.documents),c=Bu.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),u=o.applyChanges(l,t.isPrimaryClient,c);JS(t,n,u.wa);const d=new Zz(e,n,o);return t.Fa.set(e,d),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),u.snapshot}async function iU(t,e,n){const r=de(t),s=r.Fa.get(e),i=r.Ma.get(s.targetId);if(i.length>1)return r.Ma.set(s.targetId,i.filter(o=>!Tm(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await gx(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&Gv(r.remoteStore,s.targetId),yx(r,s.targetId)}).catch(Mu)):(yx(r,s.targetId),await gx(r.localStore,s.targetId,!0))}async function aU(t,e){const n=de(t),r=n.Fa.get(e),s=n.Ma.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Gv(n.remoteStore,r.targetId))}async function oU(t,e,n){const r=mU(t);try{const s=await function(o,l){const c=de(o),u=It.now(),d=l.reduce((g,y)=>g.add(y.key),Ee());let m,p;return c.persistence.runTransaction("Locally write mutations","readwrite",g=>{let y=Gs(),w=Ee();return c.cs.getEntries(g,d).next(_=>{y=_,y.forEach((E,b)=>{b.isValidDocument()||(w=w.add(E))})}).next(()=>c.localDocuments.getOverlayedDocuments(g,y)).next(_=>{m=_;const E=[];for(const b of l){const S=jB(b,m.get(b.key).overlayedDocument);S!=null&&E.push(new Ji(b.key,S,dj(S.value.mapValue),gn.exists(!0)))}return c.mutationQueue.addMutationBatch(g,u,E,l)}).next(_=>{p=_;const E=_.applyToLocalDocumentSet(m,w);return c.documentOverlayCache.saveOverlays(g,_.batchId,E)})}).then(()=>({batchId:p.batchId,changes:bj(m)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,l,c){let u=o.Ba[o.currentUser.toKey()];u||(u=new it(Fe)),u=u.insert(l,c),o.Ba[o.currentUser.toKey()]=u}(r,s.batchId,n),await Uu(r,s.changes),await Fm(r.remoteStore)}catch(s){const i=Jv(s,"Failed to persist write");n.reject(i)}}async function iR(t,e){const n=de(t);try{const r=await bz(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.Na.get(i);o&&(Oe(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.va=!0:s.modifiedDocuments.size>0?Oe(o.va):s.removedDocuments.size>0&&(Oe(o.va),o.va=!1))}),await Uu(n,r,e)}catch(r){await Mu(r)}}function YS(t,e,n){const r=de(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Fa.forEach((i,o)=>{const l=o.view.Z_(e);l.snapshot&&s.push(l.snapshot)}),function(o,l){const c=de(o);c.onlineState=l;let u=!1;c.queries.forEach((d,m)=>{for(const p of m.j_)p.Z_(l)&&(u=!0)}),u&&Zv(c)}(r.eventManager,e),s.length&&r.Ca.d_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function lU(t,e,n){const r=de(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Na.get(e),i=s&&s.key;if(i){let o=new it(Z.comparator);o=o.insert(i,nn.newNoDocument(i,ue.min()));const l=Ee().add(i),c=new Am(ue.min(),new Map,new it(Fe),o,l);await iR(r,c),r.Oa=r.Oa.remove(i),r.Na.delete(e),ew(r)}else await gx(r.localStore,e,!1).then(()=>yx(r,e,n)).catch(Mu)}async function cU(t,e){const n=de(t),r=e.batch.batchId;try{const s=await _z(n.localStore,e);oR(n,r,null),aR(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Uu(n,s)}catch(s){await Mu(s)}}async function uU(t,e,n){const r=de(t);try{const s=await function(o,l){const c=de(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let d;return c.mutationQueue.lookupMutationBatch(u,l).next(m=>(Oe(m!==null),d=m.keys(),c.mutationQueue.removeMutationBatch(u,m))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,d,l)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,d)).next(()=>c.localDocuments.getDocuments(u,d))})}(r.localStore,e);oR(r,e,n),aR(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Uu(r,s)}catch(s){await Mu(s)}}function aR(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function oR(t,e,n){const r=de(t);let s=r.Ba[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Ba[r.currentUser.toKey()]=s}}function yx(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||lR(t,r)})}function lR(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(Gv(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),ew(t))}function JS(t,e,n){for(const r of n)r instanceof nR?(t.La.addReference(r.key,e),dU(t,r)):r instanceof rR?(X("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||lR(t,r.key)):oe()}function dU(t,e){const n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||(X("SyncEngine","New document in limbo: "+n),t.xa.add(r),ew(t))}function ew(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new Z(Qe.fromString(e)),r=t.qa.next();t.Na.set(r,new eU(n)),t.Oa=t.Oa.insert(n,r),Gj(t.remoteStore,new Ti(ls($v(n.path)),r,"TargetPurposeLimboResolution",Pv.oe))}}async function Uu(t,e,n){const r=de(t),s=[],i=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((l,c)=>{o.push(r.Ka(c,e,n).then(u=>{var d;if((u||n)&&r.isPrimaryClient){const m=u?!u.fromCache:(d=n==null?void 0:n.targetChanges.get(c.targetId))===null||d===void 0?void 0:d.current;r.sharedClientState.updateQueryState(c.targetId,m?"current":"not-current")}if(u){s.push(u);const m=qv.Wi(c.targetId,u);i.push(m)}}))}),await Promise.all(o),r.Ca.d_(s),await async function(c,u){const d=de(c);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>U.forEach(u,p=>U.forEach(p.$i,g=>d.persistence.referenceDelegate.addReference(m,p.targetId,g)).next(()=>U.forEach(p.Ui,g=>d.persistence.referenceDelegate.removeReference(m,p.targetId,g)))))}catch(m){if(!Ou(m))throw m;X("LocalStore","Failed to update sequence numbers: "+m)}for(const m of u){const p=m.targetId;if(!m.fromCache){const g=d.os.get(p),y=g.snapshotVersion,w=g.withLastLimboFreeSnapshotVersion(y);d.os=d.os.insert(p,w)}}}(r.localStore,i))}async function hU(t,e){const n=de(t);if(!n.currentUser.isEqual(e)){X("SyncEngine","User change. New user:",e.toKey());const r=await Vj(n.localStore,e);n.currentUser=e,function(i,o){i.ka.forEach(l=>{l.forEach(c=>{c.reject(new G(z.CANCELLED,o))})}),i.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Uu(n,r.hs)}}function fU(t,e){const n=de(t),r=n.Na.get(e);if(r&&r.va)return Ee().add(r.key);{let s=Ee();const i=n.Ma.get(e);if(!i)return s;for(const o of i){const l=n.Fa.get(o);s=s.unionWith(l.view.Va)}return s}}function cR(t){const e=de(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=iR.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=fU.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=lU.bind(null,e),e.Ca.d_=Xz.bind(null,e.eventManager),e.Ca.$a=Yz.bind(null,e.eventManager),e}function mU(t){const e=de(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=cU.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=uU.bind(null,e),e}class Sf{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Nm(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return wz(this.persistence,new yz,e.initialUser,this.serializer)}Ga(e){return new pz(Wv.Zr,this.serializer)}Wa(e){return new Iz}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Sf.provider={build:()=>new Sf};class vx{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>YS(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=hU.bind(null,this.syncEngine),await Gz(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new Kz}()}createDatastore(e){const n=Nm(e.databaseInfo.databaseId),r=function(i){return new Az(i)}(e.databaseInfo);return function(i,o,l,c){return new Fz(i,o,l,c)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,l){return new Lz(r,s,i,o,l)}(this.localStore,this.datastore,e.asyncQueue,n=>YS(this.syncEngine,n,0),function(){return qS.D()?new qS:new Cz}())}createSyncEngine(e,n){return function(s,i,o,l,c,u,d){const m=new tU(s,i,o,l,c,u);return d&&(m.Qa=!0),m}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=de(s);X("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await zu(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}vx.provider={build:()=>new vx};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uR{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):qs("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pU{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=en.UNAUTHENTICATED,this.clientId=lj.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{X("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(X("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ls;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Jv(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function vg(t,e){t.asyncQueue.verifyOperationInProgress(),X("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await Vj(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function ZS(t,e){t.asyncQueue.verifyOperationInProgress();const n=await gU(t);X("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>GS(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>GS(e.remoteStore,s)),t._onlineComponents=e}async function gU(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){X("FirestoreClient","Using user provided OfflineComponentProvider");try{await vg(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===z.FAILED_PRECONDITION||s.code===z.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;Zo("Error using user provided cache. Falling back to memory cache: "+n),await vg(t,new Sf)}}else X("FirestoreClient","Using default OfflineComponentProvider"),await vg(t,new Sf);return t._offlineComponents}async function dR(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(X("FirestoreClient","Using user provided OnlineComponentProvider"),await ZS(t,t._uninitializedComponentsProvider._online)):(X("FirestoreClient","Using default OnlineComponentProvider"),await ZS(t,new vx))),t._onlineComponents}function xU(t){return dR(t).then(e=>e.syncEngine)}async function hR(t){const e=await dR(t),n=e.eventManager;return n.onListen=nU.bind(null,e.syncEngine),n.onUnlisten=iU.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=rU.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=aU.bind(null,e.syncEngine),n}function yU(t,e,n={}){const r=new Ls;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,c,u){const d=new uR({next:p=>{d.Za(),o.enqueueAndForget(()=>eR(i,m));const g=p.docs.has(l);!g&&p.fromCache?u.reject(new G(z.UNAVAILABLE,"Failed to get document because the client is offline.")):g&&p.fromCache&&c&&c.source==="server"?u.reject(new G(z.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(p)},error:p=>u.reject(p)}),m=new tR($v(l.path),d,{includeMetadataChanges:!0,_a:!0});return Zj(i,m)}(await hR(t),t.asyncQueue,e,n,r)),r.promise}function vU(t,e,n={}){const r=new Ls;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,c,u){const d=new uR({next:p=>{d.Za(),o.enqueueAndForget(()=>eR(i,m)),p.fromCache&&c.source==="server"?u.reject(new G(z.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(p)},error:p=>u.reject(p)}),m=new tR(l,d,{includeMetadataChanges:!0,_a:!0});return Zj(i,m)}(await hR(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fR(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e2=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mR(t,e,n){if(!n)throw new G(z.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function wU(t,e,n,r){if(e===!0&&r===!0)throw new G(z.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function t2(t){if(!Z.isDocumentKey(t))throw new G(z.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function n2(t){if(Z.isDocumentKey(t))throw new G(z.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Dm(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":oe()}function yr(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new G(z.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Dm(t);throw new G(z.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function _U(t,e){if(e<=0)throw new G(z.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r2{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new G(z.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new G(z.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}wU("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=fR((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new G(z.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new G(z.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new G(z.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Lm{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new r2({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new G(z.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new G(z.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new r2(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new $8;switch(r.type){case"firstParty":return new V8(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new G(z.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=e2.get(n);r&&(X("ComponentProvider","Removing Datastore"),e2.delete(n),r.terminate())}(this),Promise.resolve()}}function bU(t,e,n,r={}){var s;const i=(t=yr(t,Lm))._getSettings(),o=`${e}:${n}`;if(i.host!=="firestore.googleapis.com"&&i.host!==o&&Zo("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},i),{host:o,ssl:!1})),r.mockUserToken){let l,c;if(typeof r.mockUserToken=="string")l=r.mockUserToken,c=en.MOCK_USER;else{l=gC(r.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new G(z.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new en(u)}t._authCredentials=new B8(new oj(l,c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zi{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Zi(this.firestore,e,this._query)}}class xn{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new $i(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new xn(this.firestore,e,this._key)}}class $i extends Zi{constructor(e,n,r){super(e,n,$v(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new xn(this.firestore,null,new Z(e))}withConverter(e){return new $i(this.firestore,e,this._path)}}function vr(t,e,...n){if(t=et(t),mR("collection","path",e),t instanceof Lm){const r=Qe.fromString(e,...n);return n2(r),new $i(t,null,r)}{if(!(t instanceof xn||t instanceof $i))throw new G(z.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Qe.fromString(e,...n));return n2(r),new $i(t.firestore,null,r)}}function Ct(t,e,...n){if(t=et(t),arguments.length===1&&(e=lj.newId()),mR("doc","path",e),t instanceof Lm){const r=Qe.fromString(e,...n);return t2(r),new xn(t,null,new Z(r))}{if(!(t instanceof xn||t instanceof $i))throw new G(z.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Qe.fromString(e,...n));return t2(r),new xn(t.firestore,t instanceof $i?t.converter:null,new Z(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s2{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new Wj(this,"async_queue_retry"),this.Vu=()=>{const r=yg();r&&X("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=yg();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=yg();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new Ls;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Ou(e))throw e;X("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const s=function(o){let l=o.message||"";return o.stack&&(l=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),l}(r);throw qs("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const s=Yv.createAndSchedule(this,e,n,r,i=>this.yu(i));return this.Tu.push(s),s}fu(){this.Eu&&oe()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}class ea extends Lm{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new s2,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new s2(e),this._firestoreClient=void 0,await e}}}function SU(t,e){const n=typeof t=="object"?t:vv(),r=typeof t=="string"?t:e||"(default)",s=_m(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=fC("firestore");i&&bU(s,...i)}return s}function Mm(t){if(t._terminated)throw new G(z.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||EU(t),t._firestoreClient}function EU(t){var e,n,r;const s=t._freezeSettings(),i=function(l,c,u,d){return new nB(l,c,u,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,fR(d.experimentalLongPollingOptions),d.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((n=s.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new pU(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(l){const c=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(c),_online:c}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class il{constructor(e){this._byteString=e}static fromBase64String(e){try{return new il(qt.fromBase64String(e))}catch(n){throw new G(z.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new il(qt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kl{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new G(z.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Bt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}function ti(){return new kl("__name__")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vu{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tw{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new G(z.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new G(z.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Fe(this._lat,e._lat)||Fe(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nw{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kU=/^__.*__$/;class TU{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Ji(e,this.data,this.fieldMask,n,this.fieldTransforms):new $u(e,this.data,n,this.fieldTransforms)}}class pR{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Ji(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function gR(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw oe()}}class rw{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new rw(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.Ou(e),s}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Ef(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(gR(this.Cu)&&kU.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class IU{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Nm(e)}Qu(e,n,r,s=!1){return new rw({Cu:e,methodName:n,qu:r,path:Bt.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Hu(t){const e=t._freezeSettings(),n=Nm(t._databaseId);return new IU(t._databaseId,!!e.ignoreUndefinedProperties,n)}function sw(t,e,n,r,s,i={}){const o=t.Qu(i.merge||i.mergeFields?2:0,e,n,s);ow("Data must be an object, but it was:",o,r);const l=vR(r,o);let c,u;if(i.merge)c=new Wn(o.fieldMask),u=o.fieldTransforms;else if(i.mergeFields){const d=[];for(const m of i.mergeFields){const p=wx(e,m,n);if(!o.contains(p))throw new G(z.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);_R(d,p)||d.push(p)}c=new Wn(d),u=o.fieldTransforms.filter(m=>c.covers(m.field))}else c=null,u=o.fieldTransforms;return new TU(new Cn(l),c,u)}class Om extends Vu{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Om}}class iw extends Vu{_toFieldTransform(e){return new Rj(e.path,new cu)}isEqual(e){return e instanceof iw}}class aw extends Vu{constructor(e,n){super(e),this.$u=n}_toFieldTransform(e){const n=new hu(e.serializer,kj(e.serializer,this.$u));return new Rj(e.path,n)}isEqual(e){return e instanceof aw&&this.$u===e.$u}}function xR(t,e,n,r){const s=t.Qu(1,e,n);ow("Data must be an object, but it was:",s,r);const i=[],o=Cn.empty();to(r,(c,u)=>{const d=lw(e,c,n);u=et(u);const m=s.Nu(d);if(u instanceof Om)i.push(d);else{const p=Wu(u,m);p!=null&&(i.push(d),o.set(d,p))}});const l=new Wn(i);return new pR(o,l,s.fieldTransforms)}function yR(t,e,n,r,s,i){const o=t.Qu(1,e,n),l=[wx(e,r,n)],c=[s];if(i.length%2!=0)throw new G(z.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<i.length;p+=2)l.push(wx(e,i[p])),c.push(i[p+1]);const u=[],d=Cn.empty();for(let p=l.length-1;p>=0;--p)if(!_R(u,l[p])){const g=l[p];let y=c[p];y=et(y);const w=o.Nu(g);if(y instanceof Om)u.push(g);else{const _=Wu(y,w);_!=null&&(u.push(g),d.set(g,_))}}const m=new Wn(u);return new pR(d,m,o.fieldTransforms)}function CU(t,e,n,r=!1){return Wu(n,t.Qu(r?4:3,e))}function Wu(t,e){if(wR(t=et(t)))return ow("Unsupported field value:",e,t),vR(t,e);if(t instanceof Vu)return function(r,s){if(!gR(s.Cu))throw s.Bu(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const l of r){let c=Wu(l,s.Lu(o));c==null&&(c={nullValue:"NULL_VALUE"}),i.push(c),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=et(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return kj(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=It.fromDate(r);return{timestampValue:_f(s.serializer,i)}}if(r instanceof It){const i=new It(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:_f(s.serializer,i)}}if(r instanceof tw)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof il)return{bytesValue:Lj(s.serializer,r._byteString)};if(r instanceof xn){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Vv(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof nw)return function(o,l){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw l.Bu("VectorValues must only contain numeric values.");return Bv(l.serializer,c)})}}}}}}(r,s);throw s.Bu(`Unsupported field value: ${Dm(r)}`)}(t,e)}function vR(t,e){const n={};return cj(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):to(t,(r,s)=>{const i=Wu(s,e.Mu(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function wR(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof It||t instanceof tw||t instanceof il||t instanceof xn||t instanceof Vu||t instanceof nw)}function ow(t,e,n){if(!wR(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){const r=Dm(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function wx(t,e,n){if((e=et(e))instanceof kl)return e._internalPath;if(typeof e=="string")return lw(t,e);throw Ef("Field path arguments must be of type string or ",t,!1,void 0,n)}const jU=new RegExp("[~\\*/\\[\\]]");function lw(t,e,n){if(e.search(jU)>=0)throw Ef(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new kl(...e.split("."))._internalPath}catch{throw Ef(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Ef(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let l=`Function ${e}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let c="";return(i||o)&&(c+=" (found",i&&(c+=` in field ${r}`),o&&(c+=` in document ${s}`),c+=")"),new G(z.INVALID_ARGUMENT,l+t+c)}function _R(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bR{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new xn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new RU(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field($m("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class RU extends bR{data(){return super.data()}}function $m(t,e){return typeof e=="string"?lw(t,e):e instanceof kl?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AU(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new G(z.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class cw{}class uw extends cw{}function he(t,e,...n){let r=[];e instanceof cw&&r.push(e),r=r.concat(n),function(i){const o=i.filter(c=>c instanceof dw).length,l=i.filter(c=>c instanceof Bm).length;if(o>1||o>0&&l>0)throw new G(z.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class Bm extends uw{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Bm(e,n,r)}_apply(e){const n=this._parse(e);return SR(e._query,n),new Zi(e.firestore,e.converter,dx(e._query,n))}_parse(e){const n=Hu(e.firestore);return function(i,o,l,c,u,d,m){let p;if(u.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new G(z.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){a2(m,d);const g=[];for(const y of m)g.push(i2(c,i,y));p={arrayValue:{values:g}}}else p=i2(c,i,m)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||a2(m,d),p=CU(l,o,m,d==="in"||d==="not-in");return _t.create(u,d,p)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function Q(t,e,n){const r=e,s=$m("where",t);return Bm._create(s,r,n)}class dw extends cw{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new dw(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Ur.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let o=s;const l=i.getFlattenedFilters();for(const c of l)SR(o,c),o=dx(o,c)}(e._query,n),new Zi(e.firestore,e.converter,dx(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class hw extends uw{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new hw(e,n)}_apply(e){const n=function(s,i,o){if(s.startAt!==null)throw new G(z.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new G(z.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new lu(i,o)}(e._query,this._field,this._direction);return new Zi(e.firestore,e.converter,function(s,i){const o=s.explicitOrderBy.concat([i]);return new bl(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,n))}}function Vr(t,e="asc"){const n=e,r=$m("orderBy",t);return hw._create(r,n)}class fw extends uw{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new fw(e,n,r)}_apply(e){return new Zi(e.firestore,e.converter,wf(e._query,this._limit,this._limitType))}}function al(t){return _U("limit",t),fw._create("limit",t,"F")}function i2(t,e,n){if(typeof(n=et(n))=="string"){if(n==="")throw new G(z.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!yj(e)&&n.indexOf("/")!==-1)throw new G(z.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Qe.fromString(n));if(!Z.isDocumentKey(r))throw new G(z.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return IS(t,new Z(r))}if(n instanceof xn)return IS(t,n._key);throw new G(z.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Dm(n)}.`)}function a2(t,e){if(!Array.isArray(t)||t.length===0)throw new G(z.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function SR(t,e){const n=function(s,i){for(const o of s)for(const l of o.getFlattenedFilters())if(i.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new G(z.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new G(z.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class NU{convertValue(e,n="none"){switch(Ua(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ft(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(za(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw oe()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return to(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var n,r,s;const i=(s=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(o=>ft(o.doubleValue));return new nw(i)}convertGeoPoint(e){return new tw(ft(e.latitude),ft(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=Dv(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(iu(e));default:return null}}convertTimestamp(e){const n=Wi(e);return new It(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Qe.fromString(e);Oe(Uj(r));const s=new au(r.get(1),r.get(3)),i=new Z(r.popFirst(5));return s.isEqual(n)||qs(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mw(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pc{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ER extends bR{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new kh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field($m("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class kh extends ER{data(e={}){return super.data(e)}}class PU{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new pc(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new kh(this._firestore,this._userDataWriter,r.key,r,new pc(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new G(z.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(l=>{const c=new kh(s._firestore,s._userDataWriter,l.doc.key,l.doc,new pc(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);return l.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(l=>i||l.type!==3).map(l=>{const c=new kh(s._firestore,s._userDataWriter,l.doc.key,l.doc,new pc(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);let u=-1,d=-1;return l.type!==0&&(u=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),d=o.indexOf(l.doc.key)),{type:FU(l.type),doc:c,oldIndex:u,newIndex:d}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function FU(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return oe()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Va(t){t=yr(t,xn);const e=yr(t.firestore,ea);return yU(Mm(e),t._key).then(n=>$U(e,t,n))}class kR extends NU{constructor(e){super(),this.firestore=e}convertBytes(e){return new il(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new xn(this.firestore,null,n)}}function Er(t){t=yr(t,Zi);const e=yr(t.firestore,ea),n=Mm(e),r=new kR(e);return AU(t._query),vU(n,t._query).then(s=>new PU(e,r,t,s))}function DU(t,e,n){t=yr(t,xn);const r=yr(t.firestore,ea),s=mw(t.converter,e,n);return qu(r,[sw(Hu(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,gn.none())])}function LU(t,e,n,...r){t=yr(t,xn);const s=yr(t.firestore,ea),i=Hu(s);let o;return o=typeof(e=et(e))=="string"||e instanceof kl?yR(i,"updateDoc",t._key,e,n,r):xR(i,"updateDoc",t._key,e),qu(s,[o.toMutation(t._key,gn.exists(!0))])}function MU(t){return qu(yr(t.firestore,ea),[new Rm(t._key,gn.none())])}function OU(t,e){const n=yr(t.firestore,ea),r=Ct(t),s=mw(t.converter,e);return qu(n,[sw(Hu(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,gn.exists(!1))]).then(()=>r)}function qu(t,e){return function(r,s){const i=new Ls;return r.asyncQueue.enqueueAndForget(async()=>oU(await xU(r),s,i)),i.promise}(Mm(t),e)}function $U(t,e,n){const r=n.docs.get(e._key),s=new kR(t);return new ER(t,s,e._key,r,new pc(n.hasPendingWrites,n.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BU{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=Hu(e)}set(e,n,r){this._verifyNotCommitted();const s=wg(e,this._firestore),i=mw(s.converter,n,r),o=sw(this._dataReader,"WriteBatch.set",s._key,i,s.converter!==null,r);return this._mutations.push(o.toMutation(s._key,gn.none())),this}update(e,n,r,...s){this._verifyNotCommitted();const i=wg(e,this._firestore);let o;return o=typeof(n=et(n))=="string"||n instanceof kl?yR(this._dataReader,"WriteBatch.update",i._key,n,r,s):xR(this._dataReader,"WriteBatch.update",i._key,n),this._mutations.push(o.toMutation(i._key,gn.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=wg(e,this._firestore);return this._mutations=this._mutations.concat(new Rm(n._key,gn.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new G(z.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function wg(t,e){if((t=et(t)).firestore!==e)throw new G(z.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}function Qs(){return new iw("serverTimestamp")}function fu(t){return new aw("increment",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ro(t){return Mm(t=yr(t,ea)),new BU(t,e=>qu(t,e))}(function(e,n=!0){(function(s){_l=s})(eo),Oa(new Vi("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),l=new ea(new z8(r.getProvider("auth-internal")),new W8(r.getProvider("app-check-internal")),function(u,d){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new G(z.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new au(u.options.projectId,d)}(o,s),o);return i=Object.assign({useFetchStreams:n},i),l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),as(bS,"4.7.3",e),as(bS,"4.7.3","esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TR="firebasestorage.googleapis.com",IR="storageBucket",zU=2*60*1e3,UU=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dt extends vs{constructor(e,n,r=0){super(_g(e),`Firebase Storage: ${n} (${_g(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,dt.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return _g(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var ut;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(ut||(ut={}));function _g(t){return"storage/"+t}function pw(){const t="An unknown error occurred, please check the error payload for server response.";return new dt(ut.UNKNOWN,t)}function VU(t){return new dt(ut.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function HU(t){return new dt(ut.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function WU(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new dt(ut.UNAUTHENTICATED,t)}function qU(){return new dt(ut.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function GU(t){return new dt(ut.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function QU(){return new dt(ut.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function KU(){return new dt(ut.CANCELED,"User canceled the upload/download.")}function XU(t){return new dt(ut.INVALID_URL,"Invalid URL '"+t+"'.")}function YU(t){return new dt(ut.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function JU(){return new dt(ut.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+IR+"' property when initializing the app?")}function ZU(){return new dt(ut.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function eV(){return new dt(ut.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function tV(t){return new dt(ut.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function _x(t){return new dt(ut.INVALID_ARGUMENT,t)}function CR(){return new dt(ut.APP_DELETED,"The Firebase app was deleted.")}function nV(t){return new dt(ut.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Rc(t,e){return new dt(ut.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function rc(t){throw new dt(ut.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qn{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=qn.makeFromUrl(e,n)}catch{return new qn(e,"")}if(r.path==="")return r;throw YU(e)}static makeFromUrl(e,n){let r=null;const s="([A-Za-z0-9.\\-_]+)";function i(C){C.path.charAt(C.path.length-1)==="/"&&(C.path_=C.path_.slice(0,-1))}const o="(/(.*))?$",l=new RegExp("^gs://"+s+o,"i"),c={bucket:1,path:3};function u(C){C.path_=decodeURIComponent(C.path)}const d="v[A-Za-z0-9_]+",m=n.replace(/[.]/g,"\\."),p="(/([^?#]*).*)?$",g=new RegExp(`^https?://${m}/${d}/b/${s}/o${p}`,"i"),y={bucket:1,path:3},w=n===TR?"(?:storage.googleapis.com|storage.cloud.google.com)":n,_="([^?#]*)",E=new RegExp(`^https?://${w}/${s}/${_}`,"i"),S=[{regex:l,indices:c,postModify:i},{regex:g,indices:y,postModify:u},{regex:E,indices:{bucket:1,path:2},postModify:u}];for(let C=0;C<S.length;C++){const D=S[C],F=D.regex.exec(e);if(F){const I=F[D.indices.bucket];let k=F[D.indices.path];k||(k=""),r=new qn(I,k),D.postModify(r);break}}if(r==null)throw XU(e);return r}}class rV{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sV(t,e,n){let r=1,s=null,i=null,o=!1,l=0;function c(){return l===2}let u=!1;function d(..._){u||(u=!0,e.apply(null,_))}function m(_){s=setTimeout(()=>{s=null,t(g,c())},_)}function p(){i&&clearTimeout(i)}function g(_,...E){if(u){p();return}if(_){p(),d.call(null,_,...E);return}if(c()||o){p(),d.call(null,_,...E);return}r<64&&(r*=2);let S;l===1?(l=2,S=0):S=(r+Math.random())*1e3,m(S)}let y=!1;function w(_){y||(y=!0,p(),!u&&(s!==null?(_||(l=2),clearTimeout(s),m(0)):_||(l=1)))}return m(0),i=setTimeout(()=>{o=!0,w(!0)},n),w}function iV(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aV(t){return t!==void 0}function oV(t){return typeof t=="object"&&!Array.isArray(t)}function gw(t){return typeof t=="string"||t instanceof String}function o2(t){return xw()&&t instanceof Blob}function xw(){return typeof Blob<"u"}function l2(t,e,n,r){if(r<e)throw _x(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw _x(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zm(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function jR(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const s=e(r)+"="+e(t[r]);n=n+s+"&"}return n=n.slice(0,-1),n}var ja;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(ja||(ja={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lV(t,e){const n=t>=500&&t<600,s=[408,429].indexOf(t)!==-1,i=e.indexOf(t)!==-1;return n||s||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cV{constructor(e,n,r,s,i,o,l,c,u,d,m,p=!0){this.url_=e,this.method_=n,this.headers_=r,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=l,this.errorCallback_=c,this.timeout_=u,this.progressCallback_=d,this.connectionFactory_=m,this.retry=p,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((g,y)=>{this.resolve_=g,this.reject_=y,this.start_()})}start_(){const e=(r,s)=>{if(s){r(!1,new $d(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=l=>{const c=l.loaded,u=l.lengthComputable?l.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,u)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const l=i.getErrorCode()===ja.NO_ERROR,c=i.getStatus();if(!l||lV(c,this.additionalRetryCodes_)&&this.retry){const d=i.getErrorCode()===ja.ABORT;r(!1,new $d(!1,null,d));return}const u=this.successCodes_.indexOf(c)!==-1;r(!0,new $d(u,i))})},n=(r,s)=>{const i=this.resolve_,o=this.reject_,l=s.connection;if(s.wasSuccessCode)try{const c=this.callback_(l,l.getResponse());aV(c)?i(c):i()}catch(c){o(c)}else if(l!==null){const c=pw();c.serverResponse=l.getErrorText(),this.errorCallback_?o(this.errorCallback_(l,c)):o(c)}else if(s.canceled){const c=this.appDelete_?CR():KU();o(c)}else{const c=QU();o(c)}};this.canceled_?n(!1,new $d(!1,null,!0)):this.backoffId_=sV(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&iV(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class $d{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function uV(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function dV(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function hV(t,e){e&&(t["X-Firebase-GMPID"]=e)}function fV(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function mV(t,e,n,r,s,i,o=!0){const l=jR(t.urlParams),c=t.url+l,u=Object.assign({},t.headers);return hV(u,e),uV(u,n),dV(u,i),fV(u,r),new cV(c,t.method,u,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pV(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function gV(...t){const e=pV();if(e!==void 0){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(xw())return new Blob(t);throw new dt(ut.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function xV(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yV(t){if(typeof atob>"u")throw tV("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ns={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class bg{constructor(e,n){this.data=e,this.contentType=n||null}}function vV(t,e){switch(t){case ns.RAW:return new bg(RR(e));case ns.BASE64:case ns.BASE64URL:return new bg(AR(t,e));case ns.DATA_URL:return new bg(_V(e),bV(e))}throw pw()}function RR(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const i=r,o=t.charCodeAt(++n);r=65536|(i&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function wV(t){let e;try{e=decodeURIComponent(t)}catch{throw Rc(ns.DATA_URL,"Malformed data URL.")}return RR(e)}function AR(t,e){switch(t){case ns.BASE64:{const s=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(s||i)throw Rc(t,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case ns.BASE64URL:{const s=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(s||i)throw Rc(t,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=yV(e)}catch(s){throw s.message.includes("polyfill")?s:Rc(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}class NR{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw Rc(ns.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=SV(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function _V(t){const e=new NR(t);return e.base64?AR(ns.BASE64,e.rest):wV(e.rest)}function bV(t){return new NR(t).contentType}function SV(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _i{constructor(e,n){let r=0,s="";o2(e)?(this.data_=e,r=e.size,s=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=s}size(){return this.size_}type(){return this.type_}slice(e,n){if(o2(this.data_)){const r=this.data_,s=xV(r,e,n);return s===null?null:new _i(s)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new _i(r,!0)}}static getBlob(...e){if(xw()){const n=e.map(r=>r instanceof _i?r.data_:r);return new _i(gV.apply(null,n))}else{const n=e.map(o=>gw(o)?vV(ns.RAW,o).data:o.data_);let r=0;n.forEach(o=>{r+=o.byteLength});const s=new Uint8Array(r);let i=0;return n.forEach(o=>{for(let l=0;l<o.length;l++)s[i++]=o[l]}),new _i(s,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PR(t){let e;try{e=JSON.parse(t)}catch{return null}return oV(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EV(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function kV(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function FR(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TV(t,e){return e}class un{constructor(e,n,r,s){this.server=e,this.local=n||e,this.writable=!!r,this.xform=s||TV}}let Bd=null;function IV(t){return!gw(t)||t.length<2?t:FR(t)}function DR(){if(Bd)return Bd;const t=[];t.push(new un("bucket")),t.push(new un("generation")),t.push(new un("metageneration")),t.push(new un("name","fullPath",!0));function e(i,o){return IV(o)}const n=new un("name");n.xform=e,t.push(n);function r(i,o){return o!==void 0?Number(o):o}const s=new un("size");return s.xform=r,t.push(s),t.push(new un("timeCreated")),t.push(new un("updated")),t.push(new un("md5Hash",null,!0)),t.push(new un("cacheControl",null,!0)),t.push(new un("contentDisposition",null,!0)),t.push(new un("contentEncoding",null,!0)),t.push(new un("contentLanguage",null,!0)),t.push(new un("contentType",null,!0)),t.push(new un("metadata","customMetadata",!0)),Bd=t,Bd}function CV(t,e){function n(){const r=t.bucket,s=t.fullPath,i=new qn(r,s);return e._makeStorageReference(i)}Object.defineProperty(t,"ref",{get:n})}function jV(t,e,n){const r={};r.type="file";const s=n.length;for(let i=0;i<s;i++){const o=n[i];r[o.local]=o.xform(r,e[o.server])}return CV(r,t),r}function LR(t,e,n){const r=PR(e);return r===null?null:jV(t,r,n)}function RV(t,e,n,r){const s=PR(e);if(s===null||!gw(s.downloadTokens))return null;const i=s.downloadTokens;if(i.length===0)return null;const o=encodeURIComponent;return i.split(",").map(u=>{const d=t.bucket,m=t.fullPath,p="/b/"+o(d)+"/o/"+o(m),g=zm(p,n,r),y=jR({alt:"media",token:u});return g+y})[0]}function AV(t,e){const n={},r=e.length;for(let s=0;s<r;s++){const i=e[s];i.writable&&(n[i.server]=t[i.local])}return JSON.stringify(n)}class yw{constructor(e,n,r,s){this.url=e,this.method=n,this.handler=r,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MR(t){if(!t)throw pw()}function NV(t,e){function n(r,s){const i=LR(t,s,e);return MR(i!==null),i}return n}function PV(t,e){function n(r,s){const i=LR(t,s,e);return MR(i!==null),RV(i,s,t.host,t._protocol)}return n}function OR(t){function e(n,r){let s;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?s=qU():s=WU():n.getStatus()===402?s=HU(t.bucket):n.getStatus()===403?s=GU(t.path):s=r,s.status=n.getStatus(),s.serverResponse=r.serverResponse,s}return e}function $R(t){const e=OR(t);function n(r,s){let i=e(r,s);return r.getStatus()===404&&(i=VU(t.path)),i.serverResponse=s.serverResponse,i}return n}function FV(t,e,n){const r=e.fullServerUrl(),s=zm(r,t.host,t._protocol),i="GET",o=t.maxOperationRetryTime,l=new yw(s,i,PV(t,n),o);return l.errorHandler=$R(e),l}function DV(t,e){const n=e.fullServerUrl(),r=zm(n,t.host,t._protocol),s="DELETE",i=t.maxOperationRetryTime;function o(c,u){}const l=new yw(r,s,o,i);return l.successCodes=[200,204],l.errorHandler=$R(e),l}function LV(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function MV(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=LV(null,e)),r}function OV(t,e,n,r,s){const i=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function l(){let S="";for(let C=0;C<2;C++)S=S+Math.random().toString().slice(2);return S}const c=l();o["Content-Type"]="multipart/related; boundary="+c;const u=MV(e,r,s),d=AV(u,n),m="--"+c+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+d+`\r
--`+c+`\r
Content-Type: `+u.contentType+`\r
\r
`,p=`\r
--`+c+"--",g=_i.getBlob(m,r,p);if(g===null)throw ZU();const y={name:u.fullPath},w=zm(i,t.host,t._protocol),_="POST",E=t.maxUploadRetryTime,b=new yw(w,_,NV(t,n),E);return b.urlParams=y,b.headers=o,b.body=g.uploadData(),b.errorHandler=OR(e),b}class $V{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=ja.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=ja.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=ja.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,s){if(this.sent_)throw rc("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(n,e,!0),s!==void 0)for(const i in s)s.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,s[i].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw rc("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw rc("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw rc("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw rc("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class BV extends $V{initXhr(){this.xhr_.responseType="text"}}function vw(){return new BV}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ha{constructor(e,n){this._service=e,n instanceof qn?this._location=n:this._location=qn.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new Ha(e,n)}get root(){const e=new qn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return FR(this._location.path)}get storage(){return this._service}get parent(){const e=EV(this._location.path);if(e===null)return null;const n=new qn(this._location.bucket,e);return new Ha(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw nV(e)}}function zV(t,e,n){t._throwIfRoot("uploadBytes");const r=OV(t.storage,t._location,DR(),new _i(e,!0),n);return t.storage.makeRequestWithTokens(r,vw).then(s=>({metadata:s,ref:t}))}function UV(t){t._throwIfRoot("getDownloadURL");const e=FV(t.storage,t._location,DR());return t.storage.makeRequestWithTokens(e,vw).then(n=>{if(n===null)throw eV();return n})}function VV(t){t._throwIfRoot("deleteObject");const e=DV(t.storage,t._location);return t.storage.makeRequestWithTokens(e,vw)}function HV(t,e){const n=kV(t._location.path,e),r=new qn(t._location.bucket,n);return new Ha(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WV(t){return/^[A-Za-z]+:\/\//.test(t)}function qV(t,e){return new Ha(t,e)}function BR(t,e){if(t instanceof ww){const n=t;if(n._bucket==null)throw JU();const r=new Ha(n,n._bucket);return e!=null?BR(r,e):r}else return e!==void 0?HV(t,e):t}function GV(t,e){if(e&&WV(e)){if(t instanceof ww)return qV(t,e);throw _x("To use ref(service, url), the first argument must be a Storage instance.")}else return BR(t,e)}function c2(t,e){const n=e==null?void 0:e[IR];return n==null?null:qn.makeFromBucketSpec(n,t)}function QV(t,e,n,r={}){t.host=`${e}:${n}`,t._protocol="http";const{mockUserToken:s}=r;s&&(t._overrideAuthToken=typeof s=="string"?s:gC(s,t.app.options.projectId))}class ww{constructor(e,n,r,s,i){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=s,this._firebaseVersion=i,this._bucket=null,this._host=TR,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=zU,this._maxUploadRetryTime=UU,this._requests=new Set,s!=null?this._bucket=qn.makeFromBucketSpec(s,this._host):this._bucket=c2(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=qn.makeFromBucketSpec(this._url,e):this._bucket=c2(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){l2("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){l2("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Ha(this,e)}_makeRequest(e,n,r,s,i=!0){if(this._deleted)return new rV(CR());{const o=mV(e,this._appId,r,s,n,this._firebaseVersion,i);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,n){const[r,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,s).getPromise()}}const u2="@firebase/storage",d2="0.13.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zR="storage";function UR(t,e,n){return t=et(t),zV(t,e,n)}function VR(t){return t=et(t),UV(t)}function KV(t){return t=et(t),VV(t)}function _w(t,e){return t=et(t),GV(t,e)}function XV(t=vv(),e){t=et(t);const r=_m(t,zR).getImmediate({identifier:e}),s=fC("storage");return s&&YV(r,...s),r}function YV(t,e,n,r={}){QV(t,e,n,r)}function JV(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new ww(n,r,s,e,eo)}function ZV(){Oa(new Vi(zR,JV,"PUBLIC").setMultipleInstances(!0)),as(u2,d2,""),as(u2,d2,"esm2017")}ZV();const bw=vC({apiKey:"AIzaSyDS7lgm2PwJBFrYE6ZHSYJfqcQw2TLC878",appId:"1:938280289868:web:e36c48cfbd55e4a8de96e",projectId:"zingmp3-clone-61799",storageBucket:"zingmp3-clone-61799.appspot.com",authDomain:"zingmp3-clone-61799.firebaseapp.com",messagingSenderId:"938280289868"}),ke=SU(bw),Wa=A8(bw),eH=new Ts,Sw=XV(bw),tH="/HD-MP3/assets/user-default-971f59df.png";function bx({className:t}){const[e]=Av(Wa),n={imageFrame:`${t||"w-[35px] h-[35px]"} flex-shrink-0 rounded-full overflow-hidden ${e!=null&&e.photoURL?"":"flex items-center justify-center bg-[#ccc]"}`};return a.jsx("div",{className:n.imageFrame,children:a.jsx(Ye,{src:(e==null?void 0:e.photoURL)||tH,className:"w-full"})})}function nH({children:t,className:e="px-2 py-1 text-sm font-[500]",position:n="bottom-[calc(100%+8px)]",content:r,isWrapped:s,...i},o){const[l,c]=f.useState(!1),{theme:u}=q(),{setTriggerRef:d,state:m}=Sr(),{onClick:p}=i,g=f.useRef(null),y=()=>{"ontouchstart"in document.documentElement||c(!0)},w=()=>{c(!1)};f.useEffect(()=>{const b=g.current;if(b)return d&&d(b),b.addEventListener("mouseenter",y),b.addEventListener("mouseleave",w),()=>{b.removeEventListener("mouseenter",y),b.removeEventListener("mouseleave",w)}},[]);const _={container:`${u.modal_bg} text-white`},E=a.jsx(a.Fragment,{children:f.isValidElement(t)&&a.jsxs(a.Fragment,{children:[Object.keys(i).length?f.cloneElement(t,{ref:g,onClick:p}):f.cloneElement(t,{ref:g}),!(m!=null&&m.isOpen)&&l&&a.jsx("div",{className:`${_.container} absolute whitespace-nowrap -translate-x-1/2 left-1/2 rounded-md ${n} ${e}`,children:r})]})});if(f.isValidElement(t))return a.jsx(a.Fragment,{children:s?E:a.jsx("div",{className:"relative",children:E})})}const us=f.forwardRef(nH);function Ew(){const{setSuccessToast:t}=fe(),{close:e}=Sr(),n=()=>{navigator.clipboard.writeText(location.href),t("Link copied"),e()};return a.jsxs("button",{onClick:n,children:[a.jsx(qD,{className:"w-5"}),a.jsx("span",{children:"Copy link"})]})}function Sx(t){return a.jsxs("div",{className:"w-1/3 md:w-1/5 px-2",children:[t.variant==="skeleton"&&a.jsxs(a.Fragment,{children:[a.jsx(le,{className:"pt-[100%] rounded-full"}),a.jsx(le,{className:"mt-1 w-full h-[24px]"})]}),t.variant==="singer-item"&&a.jsxs(a.Fragment,{children:[a.jsx(we,{to:`/singer/${t.singer.id}`,children:a.jsx(Ru,{className:"!rounded-full",children:a.jsx(Ye,{src:t.singer.image_url,className:"hover:scale-[1.05] transition-transform"})})}),a.jsx("p",{className:"mt-1 text-center text-lg",children:t.singer.name})]})]})}const Um=(t,e,n="rgba(255,255,255,.15)")=>`linear-gradient(to right, ${t} ${e}%, ${n} ${e}%, ${n}`;function kw({audioEle:t,baseColor:e,color:n,progressLineRef:r,setStatusFromParent:s,statusFromParent:i}){const{theme:o}=q(),[l,c]=f.useState("paused"),[u,d]=f.useState(!1),m=i||l,p=s||c,g=f.useRef(""),y=f.useRef(m),w=()=>{try{t.play(),d(!0)}catch{}},_=()=>{t==null||t.pause(),S()},E=()=>{m==="playing"?_():m==="paused"&&w()},b=()=>{p("playing")},S=()=>{p("paused")},C=j=>{if(!t)return;const N=+(j||t.currentTime/t.duration*100).toFixed(1);r!=null&&r.current&&(r.current.style.background=Um(n||g.current,N,e))},D=()=>{const N=t.currentTime/(t.duration/100);C(+N.toFixed(1))},F=()=>{console.log("error"),p("error")},I=j=>{t.currentTime=j,C(),m!=="playing"&&w()},k=j=>{t.currentTime=t.currentTime+j},R=j=>{t.currentTime=t.currentTime-j};return f.useEffect(()=>{if(t)return t.addEventListener("error",F),t.addEventListener("pause",S),t.addEventListener("playing",b),r!=null&&r.current&&t.addEventListener("timeupdate",D),()=>{t.removeEventListener("error",F),t.removeEventListener("pause",S),t.removeEventListener("playing",b),r!=null&&r.current&&t.removeEventListener("timeupdate",D)}},[t]),f.useEffect(()=>{g.current=o.content_code,m!=="playing"&&C()},[o]),f.useEffect(()=>{y.current=m},[m]),{play:w,pause:_,seek:I,handlePlayPause:E,status:m,forward:k,backward:R,isClickPlay:u,statusRef:y}}const rH=()=>({playStatus:"paused",isLoaded:!0,countDown:0}),HR=gv({name:"playStatus",initialState:()=>rH(),reducers:{setPlayStatus(t,e){Object.assign(t,e.payload)}}}),Dn=t=>t.playStatus,{setPlayStatus:Ot}=HR.actions,sH=HR.reducer;function ni({variant:t}){const e=on(),{currentQueueId:n,queueSongs:r,currentSongData:s}=se(ze),i=f.useMemo(()=>{switch(t){default:return"queue_id"}},[]);return{handleSetSong:(l,c)=>{if(n!==l){e(ds(l)),e(Ot({playStatus:"loading"}));const u=r.map(m=>m[i]);if(!r.length||r.length!==c.length||!!c.find(m=>!u.includes(m[i])))return console.log("set queue"),e(ZO({songs:c})),!0}return!1},currentSongData:s,queueSongs:r,currentQueueId:n}}function WR(t,e){const[n,r]=f.useState(t);return f.useEffect(()=>{if(!t){r("");return}const s=setTimeout(()=>{r(t)},e);return()=>{clearTimeout(s)}},[t]),n}const Tw={isDev:!1,focusDelay:3e3,scrollSongDelay:4e3,loadingDuration:200};function h2(t,e){const n=f.useRef(),[r,s]=f.useState(0),[i,o]=f.useState(0);return f.useEffect(()=>{r&&(n.current=setTimeout(()=>n.current=void 0,e))},[i,Tw]),f.useEffect(()=>{n.current||(t(),o(Math.random()*10))},[r]),()=>s(Math.random()*10)}const iH=!1,wn=vr(ke,"Songs"),wr=vr(ke,"Playlists"),kf=vr(ke,"Singers"),aH=vr(ke,"Users");vr(ke,"Lyrics");const Gu=vr(ke,"Comments"),Iw=async({collectionName:t,id:e,msg:n})=>{await MU(Ct(ke,t,e))},Hr=async({collectionName:t,id:e,msg:n})=>Va(Ct(ke,t,e)),Ks=async({collectionName:t,data:e,msg:n})=>await OU(vr(ke,t),e),kt=async({collectionName:t,id:e,data:n,msg:r})=>await LU(Ct(ke,t,e),n),Cw=async({file:t,folder:e,namePrefix:n,msg:r})=>{const s=n.replace("@gmail.com","")+"_"+t.name.replaceAll(" ","").toLowerCase(),i=_w(Sw,`${e+s}`),o=await UR(i,t);return{fileURL:await VR(o.ref),filePath:o.metadata.fullPath}},oH=async({blob:t,folder:e,msg:n})=>{const r=Date.now()+".jpg",s=_w(Sw,`${e+r}`),i=await UR(s,t);return{fileURL:await VR(i.ref),filePath:i.metadata.fullPath}},Xn=async({filePath:t,msg:e})=>{try{const n=_w(Sw,t);await KV(n)}catch(n){console.log({error:n})}},qR=async t=>{await Xn({filePath:t.song_file_path,msg:">>> api: delete song file"}),t.beat_file_path&&await Xn({filePath:t.beat_file_path,msg:">>> api: delete song's image file"}),t.image_file_path&&await Xn({filePath:t.image_file_path,msg:">>> api: delete song's image file"})},lH="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let Qu=(t=21)=>{let e="",n=crypto.getRandomValues(new Uint8Array(t|=0));for(;t--;)e+=lH[n[t]&63];return e};const Sg={currentPlaylist:null,playlistSongs:[]},GR=gv({name:"currentPlaylist",initialState:Sg,reducers:{setCurrentPlaylist(t,e){const{playlist:n,songs:r}=e.payload;t.currentPlaylist=n,t.playlistSongs=r},updateCurrentPlaylist:(t,e)=>{if(!t.currentPlaylist)return t;Object.assign(t.currentPlaylist,e.payload)},addSongsToPlaylist(t,e){if(!t.currentPlaylist)return t;const n=e.payload.map(r=>({...r,song_in:`playlist_${t.currentPlaylist.id}`,queue_id:Qu(4)}));t.playlistSongs.push(...n)},setPlaylistSong(t,e){t.playlistSongs=e.payload},removeSong(t,e){const{index:n}=e.payload;t.playlistSongs.splice(n,1)},resetCurrentPlaylist:t=>{t.currentPlaylist=Sg.currentPlaylist,t.playlistSongs=Sg.playlistSongs}}}),ta=t=>t.currentPlaylist,{addSongsToPlaylist:WJ,removeSong:qJ,setCurrentPlaylist:cH,updateCurrentPlaylist:uH,resetCurrentPlaylist:dH,setPlaylistSong:GJ}=GR.actions,hH=GR.reducer;function fH(){const t=on(),{setErrorToast:e}=fe(),{user:n,loading:r}=xe(),s=Xi(),[i,o]=f.useState(!0),l=async()=>{if(!s.id)return;const d=await Hr({collectionName:"Playlists",id:s.id,msg:">>> api get playlist"});if(d.exists())return{...d.data(),id:d.id}},c=async d=>{if(!d.song_ids.length)return[];const m=he(wn,Q(ti(),"in",d.song_ids)),p=await Er(m);return p.docs.length?p.docs.map(y=>({id:y.id,...y.data(),queue_id:`${Qu(4)}_${d.id}}`})):[]},u=async()=>{try{if(!s.id)return;o(!0);const d=await l();if(!d||!(n?d.owner_email===n.email&&!d.is_official:!1)&&!d.is_public)return;const p=await c(d);t(cH({playlist:d,songs:p}))}catch(d){console.log({message:d}),e()}finally{o(!1)}};return f.useEffect(()=>{if(!r)return u(),()=>{t(dH())}},[r]),{isFetching:i}}function QR({loadingFromParent:t,setLoadingFromParent:e}){const[n,r]=f.useState(!1),s=t||n,i=e||r;return{getLyric:async l=>{try{i(!0);const c=await Hr({collectionName:"Lyrics",id:l.lyric_id});if(c.exists())return c.data()}catch(c){console.log({message:c})}finally{r(!1)}},_loading:s}}function KR(){const t=on(),{setSuccessToast:e}=fe();return{action:r=>{switch(r.variant){case"add":t(vm({songs:r.songs})),e("Song added to queue");break;case"remove":t(JO({index:r.index}))}}}}const mH=async t=>{const e=Date.now(),n=await cI.post("/api/image/encode",t);let r="";n&&(r=n.data.encode);const s=(Date.now()-e)/1e3;return console.log(">>> api: get blurHash encode finished after",s),{encode:r}},pH=async t=>{const e=new FormData;e.append("file",t);const n=Date.now(),r=await cI.post("/api/image/optimize",e,{responseType:"blob"});let s;r&&(s=r.data);const i=(Date.now()-n)/1e3;return console.log(">>> api: optimize finished after",i),s};async function _n(t,e){const n=await Er(t);return n.docs?n.docs.map(s=>{const i={...s.data(),id:s.id,queue_id:Qu(4)};return e!=null&&e.getQueueId&&(i.queue_id=e.getQueueId(i)),i}):[]}async function Wr(t){const e=await Er(t);return e.docs.length?e.docs.map(r=>({...r.data(),id:r.id})):[]}async function Tf(t){const e=await Er(t);return e.docs.length?e.docs.map(r=>({...r.data(),id:r.id})):[]}async function gH(t){const e=await Er(t);return e.docs.length?e.docs.map(r=>r.data()):[]}const na=async({imageFile:t,blob:e})=>{let n=e;if(t&&(n=await pH(t)),!n)throw new Error("File not found");const r=oH({blob:n,folder:"/images/"}),{encode:s}=await mH(n),{filePath:i,fileURL:o}=await r;return{image_file_path:i,image_url:o,blurhash_encode:s}};function XR(){const{setPlaylists:t}=Pn(),{setErrorToast:e,setSuccessToast:n}=fe(),[r,s]=f.useState(!1);return{isFetching:r,handleAddPlaylist:async(o,l,c)=>{try{if(s(!0),l){const g=await na({imageFile:l});Object.assign(o,g)}const u=await Ks({collectionName:"Playlists",data:o}),d=await Va(u),m={...d.data(),id:d.id},{push:p=!0}=c||{};return p&&t(g=>[m,...g]),n("Playlist created"),m}catch(u){console.log(u),e()}finally{s(!1)}}}}function Vm(){const[t,e]=f.useState(!0),{setErrorToast:n}=fe();return{fetchComment:async({target_id:s,comment_id:i})=>{try{e(!0);let o=he(Gu);s&&(o=he(o,Q("target_id","==",s),Q("comment_id","==",""),Vr("updated_at","desc"))),i&&(o=he(o,Q("comment_id","==",i),Vr("created_at","asc")));const l=await Er(o);if(l.docs.length)return l.docs.map(u=>({...u.data(),id:u.id,replies:[]}))}catch{n()}finally{e(!1)}},isFetching:t}}function YR({children:t}){return QR({}),t}const JR=["Newest","Popular"],xH=()=>JR.reduce((t,e)=>{const n={playlists:[],shouldFetching:!0};return{...t,[e]:n}},{});function yH(){const[t,e]=f.useState(xH),{setErrorToast:n}=fe(),[r,s]=f.useState("Newest"),[i,o]=f.useState(!0),l=async()=>{try{const c={...t[r]};if(o(!0),c.shouldFetching){c.shouldFetching=!1;let u;switch(r){case"Newest":u=he(wr,Q("is_official","==",!0),Q("is_public","==",!0),Vr("updated_at","desc"),al(20));break;case"Popular":u=he(wr,Q("is_official","==",!0),Q("is_public","==",!0),Vr("like","desc"),al(20));break}if(u){const d=await Wr(u);c.playlists=d,e(m=>({...m,[r]:c}))}}else await Us(100)}catch(c){console.log({message:c}),n()}finally{o(!1)}};return f.useEffect(()=>(l(),()=>{o(!0)}),[r]),{isFetching:i,playlistMap:t,getPlaylist:l,tabs:JR,tab:r,setTab:s}}function vH(){const{getPlaylist:t,isFetching:e,playlistMap:n,...r}=yH();return a.jsx(a.Fragment,{children:a.jsxs("div",{children:[a.jsx(Se,{title:"Playlist"}),a.jsx("div",{className:"flex space-x-2 my-2",children:a.jsx(ys,{render:s=>s,...r})}),a.jsx(vl,{loading:e,playlists:n[r.tab].playlists})]})})}const ZR=["Newest","Popular"],wH=()=>ZR.reduce((t,e)=>{const n={songs:[],shouldFetching:!0};return{...t,[e]:n}},{});function _H(){const[t,e]=f.useState(wH),{setErrorToast:n}=fe(),[r,s]=f.useState("Newest"),[i,o]=f.useState(!0),l=async()=>{try{const c={...t[r]};if(o(!0),c.shouldFetching){c.shouldFetching=!1;let u;switch(r){case"Newest":u=he(wn,Q("is_official","==",!0),Vr("updated_at","desc"),al(20));break;case"Popular":u=he(wn,Q("is_official","==",!0),Vr("like","desc"),al(20));break}if(u){const d=await _n(u);c.songs=d,e(m=>({...m,[r]:c}))}}else await Us(100)}catch(c){console.log({message:c}),n()}finally{o(!1)}};return f.useEffect(()=>(l(),()=>{o(!0)}),[r]),{isFetching:i,songMap:t,tabs:ZR,tab:r,setTab:s}}function bH({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{fillRule:"evenodd",d:"M7.72 12.53a.75.75 0 010-1.06l7.5-7.5a.75.75 0 111.06 1.06L9.31 12l6.97 6.97a.75.75 0 11-1.06 1.06l-7.5-7.5z",clipRule:"evenodd"}))}const SH=f.forwardRef(bH),EH=SH;function kH({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{fillRule:"evenodd",d:"M16.28 11.47a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 01-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 011.06-1.06l7.5 7.5z",clipRule:"evenodd"}))}const TH=f.forwardRef(kH),IH=TH;function CH({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{fillRule:"evenodd",d:"M4.5 5.653c0-1.426 1.529-2.33 2.779-1.643l11.54 6.348c1.295.712 1.295 2.573 0 3.285L7.28 19.991c-1.25.687-2.779-.217-2.779-1.643V5.653z",clipRule:"evenodd"}))}const jH=f.forwardRef(CH),RH=jH;function AH({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{fillRule:"evenodd",d:"M12 3.75a.75.75 0 01.75.75v6.75h6.75a.75.75 0 010 1.5h-6.75v6.75a.75.75 0 01-1.5 0v-6.75H4.5a.75.75 0 010-1.5h6.75V4.5a.75.75 0 01.75-.75z",clipRule:"evenodd"}))}const NH=f.forwardRef(AH),PH=NH;function eA({children:t,className:e=""}){const{theme:n}=q();return a.jsx("div",{className:`rounded-md py-2 ${n.modal_bg} text-white ${e}`,children:t})}function Tl({children:t,className:e=""}){const n={container:"hover:[&>*:not(div.absolute)]:bg-white/5 [&>*]:px-3 [&>*]:py-2 [&>*]:w-full [&>*]:space-x-2 [&>*]:text-sm [&>*]:flex [&>*]:items-center"};return a.jsx("div",{className:`${n.container} ${e}`,children:t})}function FH(){const{playlists:t,setPlaylists:e}=Pn(),{setErrorToast:n,setSuccessToast:r}=fe(),[s,i]=f.useState(!1);return{isFetching:s,addToPlaylist:async({song:l,playlist:c})=>{try{i(!0);const u={song_ids:[l.id,...c.song_ids]},d={...c,...u};await kt({collectionName:"Playlists",id:c.id,data:u});const m=[...t],p=m.findIndex(g=>g.id===c.id);p!==-1&&(m[p]=d,e(m)),r("Song added")}catch(u){console.log({message:u}),n()}finally{i(!1)}}}}const Ex=t=>({name:"",image_url:"",song_url:"",beat_url:"",beat_file_path:"",duration:0,like:0,lyric_id:"",image_file_path:"",song_file_path:"",blurhash_encode:"",singer_map:{},genre_map:{},genres:[],singers:[],is_official:!1,size:0,created_at:Qs(),updated_at:Qs(),...t}),kx=t=>({name:"",song_ids:[],image_url:"",singers:[],singer_map:{},genre_map:{},genres:[],is_album:!1,like:0,blurhash_encode:"",is_public:!0,is_official:!1,image_file_path:"",created_at:Qs(),updated_at:Qs(),...t}),f2=({owner_email:t,distributor:e,...n})=>kx({owner_email:t,is_album:!0,is_official:!0,is_public:!0,distributor:e,...n}),If=t=>({name:"",description:"",image_file_path:"",image_url:"",like:0,created_at:Qs(),blurhash_encode:"",...t}),m2=({start:t,end:e,text:n})=>{const r=n.trim().split(" "),s=r.map(()=>[]),i=r.map(()=>0);return{start:t,end:e,tune:{start:t,end:e,grow:i},cut:s,text:n}},p2=({user:t,target_id:e,...n})=>({target_id:e,text:"",like:0,reply:0,comment_id:"",user_email:t.email,user_image_url:t.photo_url,user_name:t.display_name,created_at:Qs(),updated_at:Qs(),...n});function tA(t){const[e,n]=f.useState(),[r,s]=f.useState(),i=f.useRef(null),o=m=>{e&&n({...e,...m})},l=f.useMemo(()=>t.variant==="add"?!0:!t.playlist||!e?!1:e.name!==t.playlist.name||e.like!==t.playlist.like||e.is_public!==t.playlist.is_public,[e]),c=!!r,u=f.useMemo(()=>{const m=!!(e!=null&&e.name)&&l;return t.variant==="add"?m:m||c},[c,l,e]),d=()=>{switch(t.variant){case"add":return kx({distributor:t.user.display_name,owner_email:t.user.email});case"edit":const{id:m,updated_at:p,...g}=t.playlist;return kx(g)}};return f.useEffect(()=>{var m;t.variant==="add"&&((m=i.current)==null||m.focus()),n(d())},[]),f.useEffect(()=>{r&&o({image_url:URL.createObjectURL(r)})},[r]),{playlistData:e,imageFile:r,setImageFile:s,updatePlaylistData:o,setPlaylistData:n,inputRef:i,isValidToSubmit:u,isChanged:l,isChangeImage:c}}function Il({close:t,isLoading:e,submit:n,...r}){const{theme:s}=q(),{imageFile:i,setImageFile:o,playlistData:l,updatePlaylistData:c,isChanged:u,isChangeImage:d,inputRef:m,isValidToSubmit:p}=tA(r),g=async()=>{l&&(!u&&!d||n(l,i))},y=w=>{var _;(_=w.target.files)!=null&&_.length&&o(w.target.files[0])};if(l)return a.jsxs(a.Fragment,{children:[a.jsx(jt,{close:t,title:r.variant==="add"?"Add playlist":"Edit playlist"}),a.jsxs("div",{className:"md:flex md:space-x-3",children:[a.jsxs("div",{className:"space-y-2.5",children:[a.jsx("div",{className:"w-[200px] h-[200px] rounded-lg overflow-hidden",children:a.jsx(Ye,{className:"object-cover object-center h-full",blurHashEncode:l.blurhash_encode,src:l.image_url})}),a.jsx("input",{ref:m,onChange:y,type:"file",multiple:!0,accept:"image/png, image/jpeg",id:"image_upload",className:"hidden"}),a.jsx("div",{className:"space-x-2 flex",children:a.jsx(ie,{className:`${s.content_bg}`,size:"clear",children:a.jsx("label",{htmlFor:"image_upload",className:"px-5 py-1 cursor-pointer ",children:a.jsx(xl,{className:"w-5"})})})})]}),a.jsxs("div",{className:"mt-3 md:mt-0 flex-grow flex flex-col space-y-2.5",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"name",children:"Name"}),a.jsx(Ht,{id:"name",ref:m,type:"text",placeholder:"name...",value:l.name,onChange:w=>c({name:w.target.value})})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{children:"Public"}),a.jsx(gh,{inActiveBg:"bg-black/10",active:l.is_public,cb:()=>c({is_public:!l.is_public})})]})]})]}),a.jsx("p",{className:"text-right mt-5 md:mt-0",children:a.jsx(ie,{isLoading:e,color:"primary",onClick:g,disabled:!p,className:"font-playwriteCU rounded-full",children:"Save"})})]})}function Hm(){const t=on(),{user:e,updateUserData:n}=xe(),{setPlaylists:r,playlists:s}=Pn(),[i,o]=f.useState(!1),{setSuccessToast:l,setErrorToast:c}=fe(),u=Gt();return{isFetching:i,action:async m=>{try{if(!e)throw new Error("user not found");o(!0);const p=ro(ke),g=Ct(ke,"Users",e.email),y=Ct(ke,"Playlists",m.playlist.id);switch(m.variant){case"like":{if(!e)throw Error();const w=[...e.liked_playlist_ids],_=w.findIndex(C=>C===m.playlist.id),E=_===-1;E?w.unshift(m.playlist.id):w.splice(_,1);const b={liked_playlist_ids:w},S={like:fu(E?1:-1)};p.update(g,b),p.update(y,S),await p.commit(),r(E?C=>[m.playlist,...C]:C=>C.filter(D=>D.id!==m.playlist.id)),n(b);break}case"edit":{const{data:w,playlist:_,imageFile:E}=m,b={..._,...w};if(E){const I=await na({imageFile:E});_.image_file_path&&await Xn({filePath:_.image_file_path}),Object.assign(b,I)}await kt({collectionName:"Playlists",data:b,id:_.id,msg:">>> api: update playlist doc"});const S=[...s],C=S.findIndex(I=>I.id===_.id);C!==-1&&(S[C]=b,r(S));const{updated_at:D,...F}=b;t(uH(F)),l("Playlist edited");break}case"delete":{const{playlist:w}=m,_=await Er(he(Gu,Q("target_id","==",w.id))),E={liked_playlist_ids:e.liked_playlist_ids.filter(S=>S!==w.id)};p.delete(y),p.update(g,E),_.empty||(console.log(`Delete ${_.docs.length} comments`),_.forEach(S=>p.delete(S.ref))),await Promise.all([p.commit(),w.image_file_path?Xn({filePath:w.image_file_path}):()=>{}]);const b=s.filter(S=>S.id!==w.id);r(b),n(E),u("/my-music");break}}}catch(p){console.log({message:p}),c()}finally{o(!1)}},user:e}}function jw(){const{user:t}=xe(),{setErrorToast:e}=fe(),{handleAddPlaylist:n,isFetching:r}=XR(),{action:s,isFetching:i}=Hm();return{isFetching:r||i,myMusicAddPlaylist:async(c,u)=>{try{if(!t)return;const d=await n(c,u,{push:!1});d&&await s({variant:"like",playlist:d})}catch(d){console.log({error:d}),e()}}}}function Rw({song:t,closeModal:e}){const{user:n}=xe(),{playlists:r}=Pn(),{theme:s}=q(),{addToPlaylist:i,isFetching:o}=FH(),{myMusicAddPlaylist:l,isFetching:c}=jw(),u=f.useRef(null),d=n?r.filter(g=>g.owner_email===n.email&&!g.is_official):[],m=async g=>{await i({playlist:g,song:t}),e()},p=async(g,y)=>{var w;g.song_ids=[t.id],await l(g,y),(w=u.current)==null||w.close(),e()};if(n)return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"w-[300px] max-h-[80vh] max-w-[calc(90vw-40px)] flex flex-col ",children:[a.jsx(jt,{close:e,title:"Playlists"}),a.jsx("div",{className:`flex-grow flex flex-col overflow-auto space-y-2 ${o?"disable":""}`,children:d.length?d.map((g,y)=>{const w=g.song_ids.includes(t.id);return a.jsxs("button",{disabled:w,onClick:()=>m(g),className:`flex rounded-md p-2 ${s.content_hover_bg} bg-white/10`,children:[a.jsx(Yi,{className:"w-5 mr-2"}),a.jsx("span",{children:g.name})]},y)}):a.jsx(Xe,{variant:"less"})}),a.jsxs(ie,{className:`${s.content_bg} mt-5 rounded-full justify-center`,onClick:()=>{var g;return(g=u.current)==null?void 0:g.open()},children:[a.jsx(br,{className:"w-5"}),a.jsx("span",{children:"Add new playlist"})]})]}),a.jsx(De,{variant:"animation",ref:u,children:a.jsx(Il,{close:()=>{var g;return(g=u.current)==null?void 0:g.close()},submit:p,isLoading:o||c,variant:"add",user:n})})]})}function Aw({modalRef:t,song:e}){const{user:n}=xe();return n?a.jsx(De,{variant:"animation",ref:t,children:a.jsx(Rw,{closeModal:()=>{var r;return(r=t.current)==null?void 0:r.close()},song:e})}):a.jsx(a.Fragment,{})}function Nw({modalRef:t}){const{user:e}=xe(),{close:n}=Sr(),r=()=>{var s;(s=t.current)==null||s.open(),n()};return e?a.jsxs("button",{onClick:r,children:[a.jsx(gs,{className:"w-5"}),a.jsx("span",{children:"Add to playlist"})]}):a.jsx(a.Fragment,{})}function DH({song:t,index:e}){const{action:n}=KR(),{close:r}=Sr(),s=f.useRef(null),i=()=>{n({variant:"remove",index:e}),r()};return a.jsxs(a.Fragment,{children:[a.jsxs(Wm,{song:t,children:[!1,a.jsxs("button",{onClick:i,children:[a.jsx(tv,{className:"w-5"}),a.jsx("span",{children:"Remove"})]}),a.jsx(Nw,{modalRef:s}),a.jsxs("a",{target:"_blank",href:t.song_url,children:[a.jsx(dm,{className:"w-5"}),a.jsx("span",{children:"Download"})]})]}),a.jsx(Aw,{song:t,modalRef:s})]})}function LH({song:t,modalRef:e}){const{user:n}=xe(),{updateSong:r}=Pn(),[s,i]=f.useState({name:t.name,singer:t.singers[0].name,image_url:t.image_url}),[o,l]=f.useState(!1),[c,u]=f.useState(),{setErrorToast:d,setSuccessToast:m}=fe(),p=f.useMemo(()=>t.name!==s.name||t.singers[0].name!==s.singer,[s]),g=!!s.name&&!!s.singer&&p||c;return{isFetching:o,isChanged:p,songData:s,isValidToSubmit:g,handleSubmit:async()=>{var _,E;try{if(!n||!g)return;l(!0),(_=e.current)==null||_.setModalPersist(!0);const{id:b,...S}=t;if(p){if(!s.name||!s.singer)return;S.name=s.name,S.singers=[{...S.singers[0],name:s.singer}]}if(c){const C=await na({imageFile:c});Object.assign(S,C),t.image_file_path&&await Xn({filePath:t.image_file_path})}await kt({collectionName:"Songs",data:S,id:t.id}),r({id:t.id,song:S}),m("Song edited"),(E=e.current)==null||E.close()}catch(b){console.log({message:b}),d()}finally{l(!1)}},imageFile:c,setImageFile:u,handleInput:(_,E)=>{i({...s,[_]:E})}}}function MH({song:t,modalRef:e}){const{theme:n}=q(),r=f.useRef(null),{isValidToSubmit:s,songData:i,setImageFile:o,isFetching:l,handleSubmit:c,handleInput:u}=LH({song:t,modalRef:e}),d=p=>{const g=p.target.files;g!=null&&g.length&&(o(g[0]),u("image_url",URL.createObjectURL(g[0])))},m=p=>{var g;p.stopPropagation(),(g=e.current)==null||g.close()};return a.jsxs("div",{className:`${Yc(l)} w-[500px] max-h-[80vh] max-w-[90vw] text-white flex flex-col`,children:[a.jsx("input",{ref:r,id:"image-input",type:"file",accept:"image/*",onChange:d,className:"hidden"}),a.jsx(jt,{title:"Edit song",close:()=>{var p;return(p=e.current)==null?void 0:p.close()}}),a.jsxs("div",{className:"flex flex-col flex-grow overflow-auto md:overflow-hidden md:flex-row mt-5",children:[a.jsxs("div",{className:"space-y-2.5",children:[a.jsx("div",{className:"w-[200px] rounded-md overflow-hidden h-[200px] md:w-[160px] md:h-[160px] object-cover",children:a.jsx(Ye,{className:"object-cover h-full",src:i.image_url})}),a.jsx("label",{htmlFor:"image-input",className:`inline-block cursor-pointer hover:brightness-90 px-[20px] py-[5px] ${n.content_bg} rounded-full text-[14px]`,children:a.jsx(xl,{className:"w-5"})})]}),a.jsxs("div",{className:"pt-5 md:pt-0 md:pl-5 md:flex-grow space-y-3",children:[a.jsxs("div",{className:"space-y-1.5",children:[a.jsx("label",{htmlFor:"name",className:"",children:"Name"}),a.jsx(Ht,{value:i.name,type:"text",id:"name",onChange:p=>u("name",p.target.value),placeholder:t.name})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx("label",{htmlFor:"singer",className:"",children:"Singer"}),a.jsx(Ht,{value:i.singer,onChange:p=>u("singer",p.target.value),type:"text",id:"singer",placeholder:t.singers[0].name})]})]})]}),a.jsxs("div",{className:"flex mt-5 space-x-2 justify-end",children:[a.jsx(ie,{onClick:m,className:"rounded-full",children:"Close"}),a.jsx(ie,{isLoading:l,onClick:c,disabled:!s,className:`${n.content_bg} rounded-full`,variant:"primary",children:"Save"})]})]})}function Pw(){const{user:t,updateUserData:e}=xe(),{setErrorToast:n,setSuccessToast:r}=fe(),{uploadedSongs:s,setUploadedSongs:i,shouldFetchFavoriteSongs:o}=Pn(),[l,c]=f.useState(!1);return{loading:l,action:async d=>{try{if(c(!0),!t)throw new Error("User not found");const m=ro(ke),p=Ct(ke,"Users",t.email),g=Ct(ke,"Songs",d.song.id);switch(d.variant){case"delete":{const y=s.filter(_=>_.id!==d.song.id),w={liked_song_ids:t.liked_song_ids.filter(_=>_!==d.song.id)};if(m.update(p,w),m.delete(g),d.song.lyric_id){const _=Ct(ke,"Lyrics",d.song.lyric_id);m.delete(_)}await Promise.all([m.commit(),qR(d.song)]),i(y),r(`'${d.song.name}' deleted`);break}case"like":{if(!t)return;const y=[...t.liked_song_ids],w=y.findIndex(S=>S===d.song.id),_=w===-1;_?y.unshift(d.song.id):y.splice(w,1);const E={liked_song_ids:y},b={like:fu(_?1:-1)};m.update(p,E),m.update(g,b),await m.commit(),e(E),o.current=!0;break}}}catch(m){console.log({message:m}),n()}finally{c(!1)}}}}function Fw({song:t}){const{close:e}=Sr(),{action:n}=KR(),r=()=>{n({variant:"add",songs:[t]}),e()};return a.jsxs("button",{onClick:r,children:[a.jsx(br,{className:"w-5"}),a.jsx("span",{children:"Add to queue"})]})}function OH({song:t}){const{close:e}=Sr(),[n,r]=f.useState(""),s=f.useRef(null),i=f.useRef(null),{action:o,loading:l}=Pw(),c=p=>{var g;r(p),(g=s.current)==null||g.open(),e()},u=()=>{var p;(p=s.current)==null||p.close()},d=async()=>{await o({variant:"delete",song:t}),u()},m=()=>{switch(n){case"":return a.jsx(a.Fragment,{});case"delete":return a.jsx(xs,{callback:d,loading:l,close:u,label:`Delete ' ${t.name} ' ?`});case"edit":return a.jsx(MH,{modalRef:s,song:t});case"add-to-playlist":return a.jsx(Rw,{closeModal:u,song:t})}};return a.jsxs(a.Fragment,{children:[a.jsxs(Wm,{song:t,children:[!1,a.jsx(Fw,{song:t}),a.jsx(Nw,{modalRef:i}),a.jsxs("button",{onClick:()=>c("edit"),children:[a.jsx(Tu,{className:"w-5"}),a.jsx("span",{children:"Edit"})]}),a.jsxs(we,{to:`lyric/${t.id}`,children:[a.jsx(Jy,{className:"w-5"}),a.jsx("span",{children:t.lyric_id?"Edit lyric":"Add lyric"})]}),a.jsxs("button",{onClick:()=>c("delete"),children:[a.jsx(Fn,{className:"w-5"}),a.jsx("span",{children:"Delete"})]}),a.jsxs("a",{target:"_blank",href:t.song_url,children:[a.jsx(dm,{className:"w-5"}),a.jsx("span",{children:"Download"})]})]}),a.jsx(De,{variant:"animation",ref:s,children:m()}),a.jsx(Aw,{song:t,modalRef:i})]})}function $H({song:t}){const e=f.useRef(null);return a.jsxs(a.Fragment,{children:[a.jsxs(Wm,{song:t,children:[!1,a.jsx(Fw,{song:t}),a.jsx(Nw,{modalRef:e}),a.jsxs("a",{target:"_blank",href:t.song_url,children:[a.jsx(dm,{className:"w-5"}),a.jsx("span",{children:"Download"})]})]}),a.jsx(Aw,{song:t,modalRef:e})]})}function BH({song:t}){const{isFetching:e}=Hm();return a.jsx(a.Fragment,{children:a.jsxs(Wm,{song:t,children:[!1,a.jsx(Fw,{song:t}),a.jsx("button",{children:e?a.jsx(He,{className:"w-5 animate-spin"}):a.jsxs(a.Fragment,{children:[a.jsx(tv,{className:"w-5"}),a.jsx("span",{children:"Remove"})]})}),a.jsxs("a",{target:"_blank",href:t.song_url,children:[a.jsx(dm,{className:"w-5"}),a.jsx("span",{children:"Download"})]})]})})}function zH({song:t}){return a.jsx("div",{className:"px-2 mb-3",children:a.jsxs("div",{className:"p-3 bg-[#fff]/5 rounded-md flex",children:[a.jsx("div",{className:"w-[50px] h-[50px] rounded overflow-hidden flex-shrink-0",children:a.jsx(Ye,{src:t.image_url,className:"object-cover object-center w-full"})}),a.jsxs("div",{className:"ml-1 text-sm",children:[a.jsx("h5",{className:"line-clamp-1 font-[500]",children:t.name}),a.jsx("p",{className:"opacity-70 line-clamp-1",children:t.singers.map((e,n)=>e.name+(n?", ":""))})]})]})})}function Wm({children:t,song:e}){const{theme:n}=q();return a.jsx(xr,{appendTo:"portal",className:"w-[240px]",children:a.jsxs(ei,{className:"py-2",p:"clear",theme:n,children:[a.jsx(zH,{song:e}),a.jsx(Tl,{children:t}),a.jsxs("p",{className:"text-xs text-center opacity-70 mt-3",children:["By ",e.distributor]})]})})}function g2({song:t,index:e,variant:n}){const{theme:r}=q(),[s,i]=f.useState(!1),o=()=>{switch(n){case"queue-song":return a.jsx(DH,{song:t,index:e});case"own-song":return a.jsx(OH,{song:t});case"own-playlist":return a.jsx(BH,{song:t});default:return a.jsx($H,{song:t})}},l=()=>{switch(n){case"queue-song":case"recent-song":return a.jsx(a.Fragment,{});default:return a.jsx("span",{className:`text-sm font-[500] hidden p-2 group-hover/main:hidden ${s?"hidden":"md:block"}`,children:zs(t.duration)})}},c={button:`hover:bg-${r.alpha} p-2 rounded-full`},u=()=>s?`${r.content_bg}`:"block md:hidden";return a.jsx(a.Fragment,{children:a.jsxs(pr,{appendOnPortal:!0,children:[a.jsx(gr,{setIsOpenParent:i,children:a.jsx(us,{isWrapped:!0,content:"Menu",children:a.jsx("button",{type:"button",className:`block group-hover/main:block ${c.button} ${u()}`,children:a.jsx(gl,{className:"w-5"})})})}),l(),o()]})})}function UH({isLiked:t,song:e,isSongActive:n,songVariant:r,className:s="p-1.5"}){const{theme:i}=q(),{action:o,loading:l}=Pw(),c=()=>{switch(r){case"queue-song":case"recent-song":return"mr-1";default:return""}},u=()=>{if(t)switch(r){case"queue-song":case"recent-song":return"";default:return"!block"}return""},d=()=>{switch(r){case"queue-song":case"recent-song":return n?"text-white":i.content_text;default:return i.content_text}},m={button:`hover:bg-${i.alpha} rounded-full`};return a.jsx("button",{onClick:()=>o({variant:"like",song:e}),className:`${m.button} ${c()} group-hover/main:block md:hidden ${s} ${u()}`,children:l?a.jsx(He,{className:"w-5 animate-spin"}):a.jsx(a.Fragment,{children:t?a.jsx(Cu,{className:`w-5 ${d()}`}):a.jsx(Za,{className:"w-5"})})})}function VH({onClick:t,isChecked:e,isSelected:n}){return a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:t,className:`mr-2 md:mr-3 group-hover/main:block ${e?"block":"md:hidden "}`,children:n?a.jsx(rv,{className:"w-[18px]"}):a.jsx(PI,{className:"w-[18px]"})}),a.jsx("button",{className:`mr-3 hidden group-hover/main:hidden group-hover/main:mr-[0px] md:block ${Li(e,"md:hidden")}`,children:a.jsx(Yi,{className:"w-[18px]"})})]})}function HH({song:t,onClick:e,isHasCheckBox:n,active:r=!0,isLiked:s,index:i,className:o="",imageUrl:l,...c}){const{theme:u,isOnMobile:d}=q(),{isChecked:m,selectedSongs:p,selectSong:g}=Eu(),y=f.useMemo(()=>p?p.indexOf(t)!=-1:!1,[p]),w=()=>{m!==void 0&&g(t)},_={button:`${u.content_hover_bg} p-[8px] rounded-full`,checkboxButton:"mr-3 text-[inherit]",itemContainer:`w-full sm:group/container flex flex-row rounded justify-between p-[10px] border-b border-${u.alpha} last:border-none`,imageFrame:" relative rounded-[4px] overflow-hidden flex-shrink-0",overlay:"absolute flex items-center justify-center inset-0 bg-black/40",ctaWrapper:"flex items-center justify-end flex-shrink-0"},E=f.useMemo(()=>{switch(c.variant){default:return a.jsxs("div",{className:` ${_.overlay} 
               ${r?"":"hidden sm:group-hover/main:flex"}`,children:[a.jsx("img",{src:uv,alt:"",className:`"h-[18px] w-[18px] ${Jc(!r)}`}),a.jsx("button",{onClick:e,className:`${Jc(r)} `,children:a.jsx(RH,{className:"w-[24px] text-white"})})]})}},[r,e]),b=()=>{switch(c.variant){case"queue-song":case"recent-song":return"text-sm";default:return""}},S=()=>{switch(c.variant){case"queue-song":case"recent-song":return"w-10 h-10";default:return"h-[54px] w-[54px]"}},C=()=>{switch(c.variant){case"queue-song":case"recent-song":return"text-xs";default:return"text-sm"}},D=N=>{if(!d)return;const P=N.target;console.log(P.tagName),P.tagName!=="A"&&e()},F=a.jsxs(a.Fragment,{children:[n&&a.jsx(VH,{isChecked:m,isSelected:y,onClick:w}),a.jsxs("div",{className:"flex-grow flex",onClick:D,children:[a.jsxs("div",{className:`${_.imageFrame} ${S()}`,children:[a.jsx(Ye,{src:l||t.image_url,blurHashEncode:t.blurhash_encode}),E]}),a.jsxs("div",{className:"ml-[10px]",children:[a.jsxs("h5",{className:`line-clamp-1 font-medium overflow-hidden ${b()}`,children:[t.name,!1]}),a.jsx("div",{className:`opacity-[.7] line-clamp-1 ${C()}`,children:t.singers.map((N,P)=>N.id?a.jsx(we,{to:`/singer/${N.id}`,className:`${u.content_hover_text}  hover:underline`,children:(P?", ":"")+N.name},P):a.jsxs("span",{children:[" ",(P?", ":"")+N.name]},P))})]})]})]}),I=()=>{switch(c.variant){case"queue-song":case"recent-song":return F;default:return a.jsx("div",{className:"flex flex-grow overflow-hidden",children:F})}},k=()=>{switch(c.variant){case"queue-song":case"recent-song":return a.jsx(g2,{variant:c.variant,song:t,index:i});default:return a.jsx("div",{className:"flex justify-center md:w-[60px]",children:a.jsx(g2,{variant:c.variant,song:t,index:i})})}},R=a.jsxs("div",{className:"flex items-center",children:[s!=null&&a.jsx(UH,{className:"p-2",isSongActive:r,songVariant:c.variant,isLiked:s,song:t}),k()]});return(()=>{switch(c.variant){case"queue-song":case"recent-song":return a.jsxs("div",{className:`${_.itemContainer} group/main ${r?`${u.content_bg} text-white`:`hover:bg-${u.alpha}`}`,children:[I(),R]});default:return a.jsxs("div",{className:`${_.itemContainer} ${o} group/main ${r||y?`bg-${u.alpha}`:`hover:bg-${u.alpha}`}`,children:[I(),R]})}})()}function ri({songs:t,setSong:e,getActive:n,songVariant:r,imageUrl:s,isHasCheckBox:i=!0}){const{user:o}=xe(),{currentSongData:l}=se(ze);return t.length?t.map((c,u)=>{const d=o?c.owner_email===o.email&&c.is_official===!1:!1;return a.jsx(HH,{active:l?n?n(c,l.song):c.id===l.song.id:!1,onClick:()=>e(c),variant:r||(d?"own-song":"system-song"),isHasCheckBox:i,isLiked:o?o.liked_song_ids.includes(c.id):null,song:c,imageUrl:s,index:u},c.queue_id)}):a.jsx(Xe,{variant:"less"})}function WH(){const t=on(),{setSuccessToast:e}=fe(),{selectedSongs:n,resetSelect:r}=Eu(),s=()=>{t(vm({songs:n})),e("songs added to queue"),r()};return a.jsxs("button",{onClick:s,children:[a.jsx(br,{className:"w-5"}),a.jsx("span",{className:"",children:"Add to queue"})]})}function qH({modalRef:t}){const{user:e}=xe(),{selectedSongs:n}=Eu(),{myMusicAddPlaylist:r,isFetching:s}=jw(),i=async(o,l)=>{var c;o.song_ids=n.map(u=>u.id),await r(o,l),(c=t.current)==null||c.close()};return e?a.jsx(De,{variant:"animation",ref:t,children:a.jsx(Il,{close:()=>{var o;return(o=t.current)==null?void 0:o.close()},submit:i,isLoading:s,variant:"add",user:e})}):a.jsx(a.Fragment,{})}function GH({modalRef:t}){const{user:e}=xe(),{close:n}=Sr(),r=()=>{var s;(s=t.current)==null||s.open(),n()};return e?a.jsxs("button",{onClick:r,children:[a.jsx(gs,{className:"w-5"}),a.jsx("span",{children:"Add to playlist"})]}):a.jsx(a.Fragment,{})}function QH(){const t=f.useRef(null);return a.jsxs(a.Fragment,{children:[a.jsx(KH,{children:a.jsx(GH,{modalRef:t})}),a.jsx(qH,{modalRef:t})]})}function KH({children:t}){const{theme:e}=q();return a.jsx(xr,{appendTo:"portal",children:a.jsx(ei,{className:"py-2",p:"clear",theme:e,children:a.jsx(Tl,{children:t})})})}function XH({variant:t}){const e=()=>{switch(t){default:return a.jsx(QH,{})}};return a.jsx(a.Fragment,{children:a.jsxs(pr,{appendOnPortal:!0,children:[a.jsx(gr,{children:a.jsx("button",{className:"!p-1.5",type:"button",children:a.jsx(gl,{className:"w-5"})})}),e()]})})}function qm({children:t,variant:e,selectAll:n}){const{theme:r}=q(),{user:s}=xe(),{isSelectAll:i,isChecked:o,resetSelect:l,selectedSongs:c}=Eu(),u=a.jsxs(a.Fragment,{children:[n&&a.jsx("button",{onClick:n,className:"ml-[10px]",children:i?a.jsx(Iu,{className:"w-[20px]"}):a.jsx(PI,{className:"w-[20px]"})}),a.jsx("p",{className:"font-playwriteCU mr-1",children:c.length}),a.jsxs("div",{className:`flex space-x-2 items-center ${r.type==="light"?"[&>button]:bg-black/5":"[&>button]:bg-white/5"}  [&>button]:inline-flex [&>button]:space-x-1 [&>button]:py-1 [&>button]:px-2 [&>button]:rounded-full hover:[&>button]:brightness-95`,children:[a.jsx(WH,{}),s&&a.jsx(XH,{variant:e})]}),a.jsx("button",{onClick:l,className:"p-1 flex-shrink-0",children:a.jsx(Zs,{className:"w-[20px]"})})]});return a.jsx("div",{className:"flex items-center space-x-2 h-[44px] mb-3",children:o?u:t})}function Dw(){const t=on();return se(ze),{getRecommend:async n=>{try{t(Qb(!0));const r=n.genres.map(l=>Q(`genre_map.${l.id}`,"==",!0),al(20)),s=Q(ti(),"!=",n.id),i=he(wn,...r,s),o=await _n(i);t(vm({songs:o})),t(Qb(!1))}catch{}}}}function YH(){const{isFetching:t,songMap:e,...n}=_H(),{handleSetSong:r}=ni({variant:"songs"}),{getRecommend:s}=Dw(),i=o=>{r(o.queue_id,[o]),s(o)};return a.jsx(a.Fragment,{children:a.jsxs("div",{children:[a.jsx(Se,{title:"Song"}),a.jsx("div",{className:"flex space-x-1 my-2 p-1",children:a.jsx(ys,{render:o=>o,...n})}),a.jsxs(ps,{children:[a.jsx(qm,{variant:"system-song",children:a.jsx("p",{className:"font-[500] opacity-[.5]",children:"Songs"})}),t&&yl,!t&&a.jsx(ri,{songs:e[n.tab].songs,setSong:o=>i(o)})]})]})})}function JH(){const{user:t}=xe(),[e,n]=f.useState([]),[r,s]=f.useState(!0);return{isFetching:r,recentPlaylists:e,getRecentPlaylist:async()=>{try{if(t){if(t.recent_song_ids.length){const o=he(wr,Q(ti(),"in",t.recent_song_ids)),l=await Wr(o);n(l)}}else{const o=mn()["recent-playlists"]||[];n(o)}}catch(o){console.log({message:o})}finally{s(!1)}}}}function ZH(){const{currentSongData:t}=se(ze),e=f.useRef(!1),{isFetching:n,getRecentPlaylist:r,recentPlaylists:s}=JH();f.useEffect(()=>{e.current||(e.current=!0,r())},[]);const i={playlistItem:"w-1/4 p-[8px] max-[800px]:w-1/2"},o=()=>s.map((l,c)=>{const u=t==null?void 0:t.song.queue_id.includes(l.id);return a.jsx("div",{className:i.playlistItem,children:a.jsx(dv,{active:u,data:l})},c)});return n?a.jsx("div",{className:"flex flex-row flex-wrap -mx-[8px] ",children:lv}):s.length?a.jsx(a.Fragment,{children:a.jsxs("div",{children:[a.jsx(Se,{title:"Recent listening"}),a.jsx("div",{className:"flex flex-row flex-wrap -mx-[8px] ",children:o()})]})}):a.jsx(a.Fragment,{})}function Gm(){const{user:t}=xe(),[e,n]=f.useState(!1);return{isFetching:e,action:async s=>{try{switch(n(!0),s){case"login":{await B7(Wa,eH);break}case"logout":{await UC(Wa);break}}n(!1)}catch(i){throw i}finally{n(!1)}},user:t}}function eW(){const{theme:t}=q(),{loading:e,user:n}=xe(),{action:r}=Gm(),s=async()=>{try{await r("login")}catch(o){console.log(o)}finally{}},i={icon:"w-7 mr-2 inline",linkItem:`py-3 border-b text-lg border-${t.alpha} last:border-none`,button:`${t.content_bg} rounded-full`};return a.jsxs("div",{className:"block md:hidden",children:[a.jsx(Se,{title:"Library",className:"mb-1"}),e?[...Array(3).keys()].map(o=>a.jsx(LI,{},o)):a.jsx(a.Fragment,{children:n?a.jsxs(a.Fragment,{children:[a.jsx(tg,{to:"/my-music",className:i.linkItem,icon:a.jsx(Yi,{className:i.icon+t.content_text}),label:"All songs",arrowIcon:a.jsx(ph,{className:"w-6"})}),a.jsx(tg,{to:"/my-music",className:i.linkItem,icon:a.jsx(Za,{className:i.icon+t.content_text}),label:"Favorite",arrowIcon:a.jsx(ph,{className:"w-6"})}),a.jsx(tg,{to:"/my-music",className:i.linkItem,icon:a.jsx(Ky,{className:i.icon+t.content_text}),label:"Recent",arrowIcon:a.jsx(ph,{className:"w-6"})})]}):a.jsxs(ie,{onClick:s,className:`${t.content_bg} rounded-md`,children:[a.jsx(Wy,{className:"w-7"}),a.jsx("span",{className:"font-playwriteCU leading-[2.2]",children:"Login"})]})})]})}function tW(){const{theme:t}=q(),{loading:e,user:n}=xe(),r=f.useRef(null),{action:s}=Gm(),[i,o]=f.useState(""),l=()=>{var p;return(p=r.current)==null?void 0:p.toggle()},c=p=>{var g;o(p),(g=r.current)==null||g.toggle()},u=async()=>{try{await s("logout")}catch(p){console.log("signOut error",{message:p})}finally{l()}},d=f.useMemo(()=>{switch(i){case"theme":return a.jsx(ov,{close:l});case"info":return a.jsx(av,{close:l});case"logout":return a.jsx(xs,{close:l,callback:u,loading:!1,label:"Log out ?"})}},[i]),m={linkItem:`py-3 text-lg w-full border-b border-${t.alpha} space-x-2 last:border-none flex items-center`,icon:"w-7"};return a.jsxs("div",{className:"md:hidden",children:[a.jsx("div",{className:"text-xl font-playwriteCU leading-[2.2] mb-3",children:"Setting"}),n&&a.jsxs("div",{className:`bg-${t.alpha} p-3 rounded-md flex mb-3`,children:[a.jsx(bx,{className:"h-[65px] w-[65px]"}),a.jsxs("div",{className:"ml-3",children:[a.jsx("p",{className:"text-lg font-[500]",children:n.display_name}),a.jsx("p",{className:"opacity-70 font-[500]",children:"Vip member ❤️"})]})]}),e?[...Array(3).keys()].map(p=>a.jsx(LI,{},p)):a.jsxs("div",{className:"",children:[a.jsxs("button",{className:m.linkItem,onClick:()=>c("theme"),children:[a.jsx(U0,{className:m.icon}),a.jsx("span",{children:"Theme"})]}),a.jsxs("button",{className:m.linkItem,onClick:()=>c("info"),children:[a.jsx(z0,{className:m.icon}),a.jsx("span",{children:"Info"})]}),(n==null?void 0:n.role)==="ADMIN"&&a.jsxs(we,{to:"/dashboard",className:m.linkItem,children:[a.jsx(Yy,{className:m.icon}),a.jsx("span",{children:"Dashboard"})]}),n&&a.jsxs("button",{className:m.linkItem,onClick:()=>c("logout"),children:[a.jsx(Wy,{className:m.icon}),a.jsx("span",{children:"Logout"})]})]}),a.jsx(De,{ref:r,variant:"animation",children:d})]})}function nW(){return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"space-y-5",children:[a.jsx(eW,{}),a.jsx(ZH,{}),a.jsx(vH,{}),a.jsx(YH,{}),a.jsx(tW,{})]}),a.jsx(bu,{})]})}function nA(){const{user:t,updateUserData:e}=xe();return{updatePlaylist:async r=>{if(t){if(!t.recent_playlist_ids.find(i=>i===r.id)){const o={recent_playlist_ids:[...t.recent_playlist_ids,r.id]};await kt({collectionName:"Users",data:o,id:t.email}),e(o)}}else{const s=mn()["recent-playlists"]||[];s.find(o=>o.id===r.id)||(s.push(r),nt("recent-playlists",s))}}}}const rW=a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"h-[30px] mb-[10px] flex items-center",children:a.jsx(le,{className:"h-[20px] w-[90px]"})}),yl]});function sW({variant:t,loading:e}){const{playlistSongs:n,currentPlaylist:r}=se(ta),{handleSetSong:s}=ni({variant:"playlist"}),{updatePlaylist:i}=nA(),o=(r==null?void 0:r.is_album)&&!!(r!=null&&r.image_url),l=c=>{if(!r)return;s(c.queue_id,n)&&i(r)};return e?rW:a.jsx(a.Fragment,{children:a.jsxs(ps,{children:[!!n.length&&a.jsx(qm,{variant:t==="others-playlist"?"system-song":"own-playlist",children:a.jsxs("p",{className:"font-[500] opacity-[.5]",children:[n.length," Songs"]})}),a.jsx(ri,{imageUrl:o?r.image_url:"",songs:n,setSong:c=>l(c),songVariant:t==="my-playlist"?"own-playlist":"system-song"})]})})}function si(){const t=on(),{playerConig:{isShuffle:e,repeat:n,isCrossFade:r},updatePlayerConfig:s,firstTimeSongLoaded:i,audioRef:o,timelineEleRef:l,currentTimeEleRef:c,isPlayingNewSong:u,themeCodeRef:d,shouldSyncSongDuration:m}=ct(),{currentSongData:p,queueSongs:g}=se(ze),{playStatus:y}=se(Dn),w=f.useRef(0),_=()=>{l.current&&c.current&&(c.current.innerText="0:00",l.current.style.background="rgba(255, 255, 255, 0.15)")},E=async()=>{try{if(console.log("call play"),m.current){m.current=!1;const N=mn().current_time||0;o.current.currentTime=N}await o.current.play(),u.current&&(r&&(o.current.volume=0),u.current=!1)}catch{}},b=()=>{o.current.pause()},S=()=>{y==="playing"&&b(),y==="paused"&&E()},C=j=>{const N=l.current,P=c.current,A=j||o.current.currentTime;if(o.current.duration&&N){const ee=A/(o.current.duration/100);N.style.background=Um(d.current,+ee.toFixed(1))}P&&(P.innerText=zs(A)||"0:00")};return{toggleRepeat:()=>{let j;switch(n){case"no":j="one";break;case"one":j="all";break;case"all":j="no";break;default:j="no"}nt("repeat",j),s({repeat:j})},toggleShuffle:()=>{const j=!e;s({isShuffle:j}),nt("isShuffle",j)},next:()=>{if(!p)return;let j=p.index+1,N;j<g.length?N=g[j]:(j=0,N=g[0]),t(ds(N.queue_id))},previous:()=>{if(!p)return;let j=p.index-1,N;j>=0?N=g[j]:(N=g[g.length-1],j=g.length-1),t(ds(N.queue_id))},repeat:n,isShuffle:e,updateProgressElement:C,handleSeek:j=>{const N=j.target;if(l.current){const P=N.getBoundingClientRect(),ee=(j.clientX-P.left)/l.current.offsetWidth,me=Math.round(ee*o.current.duration),ye=o.current.currentTime;if(w.current&&Math.abs(ye-w.current)<1&&Math.abs(me-w.current)<1)return;C(me),i.current?nt("current_time",me):o.current.currentTime=me,w.current=me}},handlePlayPause:S,play:E,pause:b,resetForNewSong:_}}function Eg({onClick:t,children:e,text:n}){const{theme:r}=q(),{playlistSongs:s}=se(ta);return a.jsxs(ie,{onClick:t,disabled:!s.length,size:"clear",className:`rounded-full px-5 py-1 ${r.content_bg}`,children:[e,a.jsx("span",{className:"font-playwriteCU leading-[2.2]",children:n})]})}function iW(){const{currentPlaylist:t,playlistSongs:e}=se(ta),{currentSongData:n}=se(ze),{playStatus:r}=se(Dn),{handlePlayPause:s}=si(),{handleSetSong:i}=ni({variant:"playlist"}),{updatePlaylist:o}=nA(),l=()=>{if(!t)return;const c=e[0];i(c.queue_id,e)&&o(t)};if(!t)return a.jsx(a.Fragment,{});if(n!=null&&n.song.queue_id.includes(t.id))switch(r){case"playing":case"waiting":return a.jsx(Eg,{text:"Pause",onClick:s,children:a.jsx(mm,{className:"w-7 mr-1"})});case"loading":case"paused":return a.jsx(Eg,{text:"Continue",onClick:s,children:a.jsx(Zc,{className:"w-7 mr-1"})})}return a.jsx(Eg,{text:"Play",onClick:l,children:a.jsx(Zc,{className:"w-7 mr-1"})})}function aW({isLiked:t,playlist:e,className:n="p-1.5"}){const{theme:r}=q(),{action:s,isFetching:i}=Hm(),o={button:`bg-${r.alpha} hover:brightness-90 rounded-full w-[40px] flex items-center justify-center`};return a.jsx("button",{onClick:()=>s({variant:"like",playlist:e}),className:` ${o.button} ${n}`,children:i?a.jsx(He,{className:"w-5 animate-spin"}):a.jsx(a.Fragment,{children:t?a.jsx(Cu,{className:`w-5 ${r.content_text}`}):a.jsx(Za,{className:"w-5"})})})}function oW(){return a.jsx(a.Fragment,{children:a.jsx(rA,{children:a.jsx(Ew,{})})})}function lW(){const{currentPlaylist:t}=se(ta),{close:e}=Sr(),[n,r]=f.useState(""),s=f.useRef(null),{action:i,isFetching:o}=Hm(),l=m=>{var p;r(m),e(),(p=s.current)==null||p.open()},c=()=>{var m;return(m=s.current)==null?void 0:m.close()},u=async(m,p)=>{t&&(await i({variant:"edit",playlist:t,data:m,imageFile:p}),c())},d=()=>{if(!t)return a.jsx(a.Fragment,{});switch(n){case"":return a.jsx(a.Fragment,{});case"edit":return a.jsx(Il,{isLoading:o,playlist:t,submit:u,variant:"edit",close:c});case"delete":return a.jsx(xs,{loading:o,label:`Delete playist ' ${t.name} ' ?`,callback:()=>i({variant:"delete",playlist:t}),close:c})}};return a.jsxs(a.Fragment,{children:[a.jsxs(rA,{children:[a.jsx(Ew,{}),a.jsxs("button",{onClick:()=>l("edit"),children:[a.jsx(Js,{className:"w-5"}),a.jsx("span",{children:"Edit"})]}),a.jsxs("button",{onClick:()=>l("delete"),children:[a.jsx(Fn,{className:"w-5"}),a.jsx("span",{children:"Delete"})]})]}),a.jsx(De,{variant:"animation",ref:s,children:d()})]})}function rA({children:t}){return a.jsx(xr,{className:"left-[calc(100%)] bottom-full w-[120px]",animationClassName:"origin-top-left",appendTo:"parent",children:a.jsx(eA,{children:a.jsx(Tl,{children:t})})})}function cW({variant:t}){const{theme:e}=q(),[n,r]=f.useState(!1),s=f.useRef(null);return a.jsx(a.Fragment,{children:a.jsxs(pr,{children:[a.jsx(gr,{setIsOpenParent:r,ref:s,children:a.jsx(ie,{size:"clear",className:`rounded-full p-2.5 ${n?e.content_bg:"bg-"+e.alpha} $
            } `,children:a.jsx(Tu,{className:"w-5"})})}),t==="others-playlist"?a.jsx(oW,{}):a.jsx(lW,{})]})})}function _r(t){const e=["","K","M","B"],n=Math.log10(Math.abs(t))/3|0;return n===0?t.toString():(t/Math.pow(10,n*3)).toFixed(1)+e[n]}function uW({children:t,onClose:e},n){const[r,s]=f.useState(!1),[i,o]=f.useState(!1),l=()=>{i&&o(!1),r||s(!0)},c=()=>{s(!0)},u=()=>{o(!1)},d=p=>{p.preventDefault(),p.stopPropagation(),u()};f.useImperativeHandle(n,()=>({toggle:l,close:u,open:c,setModalPersist:()=>{}})),f.useEffect(()=>{i||setTimeout(()=>{s(!1),e&&e()},400)},[i]),f.useEffect(()=>{r&&setTimeout(()=>{o(!0)},100)},[r]);const m={unMountedContent:"translate-y-full ",mountedContent:"translate-y-0",unMountedLayer:"opacity-0",mountedLayer:"opacity-20"};return a.jsx(a.Fragment,{children:r&&Ya.createPortal(a.jsxs("div",{className:"fixed inset-0 z-[99]",children:[a.jsx("div",{onClick:d,className:`transition-opacity duration-300 absolute bg-black inset-0 z-[90]
                             ${i?m.mountedLayer:m.unMountedLayer}
                        `}),a.jsx("div",{className:`modal-content absolute bottom-0 left-0 right-0 duration-300 transition-[transform,opacity] z-[99]
                            ${i?m.mountedContent:m.unMountedContent}
                        `,children:t})]}),document.getElementById("portals"))})}const Tx=f.forwardRef(uW);function dW({target:t}){const[e,n]=f.useState([]),[r,s]=f.useState(!1),[i,o]=f.useState(!0),l=f.useRef(!0);return{target:t,comments:e,isOpenComment:r,setIsOpenComment:s,setComments:n,shouldFetchComment:l,isFetching:i,setIsFetching:o}}const sA=f.createContext(null);function Qm({children:t,target:e}){return a.jsx(sA.Provider,{value:dW({target:e}),children:t})}function Gr(){const t=f.useContext(sA);if(!t)throw new Error("CommentProvider not provided");return t}function iA({children:t}){return a.jsxs("div",{className:"h-[70vh] overflow-hidden text-white rounded-[16px_16px_0_0] relative p-3 flex flex-col",children:[a.jsx("div",{className:"bg-opacity-[0.8] bg-[#1f1f1f] backdrop-blur-[15px] z-[-1] absolute inset-0"}),t]})}function aA(){const{user:t,updateUserData:e}=xe(),{setComments:n,comments:r}=Gr(),[s,i]=f.useState(!1);return{isFetching:s,action:async l=>{try{if(!t)return;switch(i(!0),l.type){case"add":{const c=p2({user:t,target_id:l.target_id,text:l.text}),u=await Ks({collectionName:"Comments",data:c}),d=await Va(u);if(d.exists()){const m={...d.data(),id:u.id,replies:[]};n(p=>[m,...p]),i(!1)}break}case"reply":{const{comment:c,comment_index:u,text:d}=l,m=p2({user:t,target_id:c.target_id,text:d,comment_id:c.id}),p=await Ks({collectionName:"Comments",data:m}),g=await Va(p);if(g.exists()){const y={reply:fu(1)};await kt({collectionName:"Comments",data:y,id:c.id});const w={...g.data(),id:p.id,replies:[]},_=[...r];_[u]={..._[u],replies:[..._[u].replies,w]},n(_),i(!1)}break}case"like":{const c=[...t.liked_comment_ids],u=c.findIndex(g=>g===l.id),d=u===-1;d?c.push(l.id):c.splice(u,1);const m={like:fu(d?1:-1)};await kt({collectionName:"Comments",data:m,id:l.id});const p={liked_comment_ids:c};nt("liked_comment_ids",c),e(p);break}case"delete":{const c=Ct(ke,"Comments",l.comment.id),u=ro(ke);if(u.delete(c),l.comment.reply){console.log(`Delete ${l.comment.reply} replies `);const p=he(Gu,Q("comment_id","==",l.comment.id));(await Er(p)).forEach(y=>{u.delete(y.ref)})}await u.commit();const d=[...t.liked_comment_ids],m=d.findIndex(p=>p===p);m!==-1&&(d.splice(m,1),nt("liked_comment_ids",d)),n(p=>p.filter(g=>g.id!==l.comment.id));break}}}catch(c){console.log({error:c})}finally{i(!1)}}}}function oA(t){const e=t.toDate(),r=new Date().getTime()-e.getTime(),s=Math.floor(r/(1e3*60*60*24));return s?s+(s>1?" days ago":" day ago"):"Today"}function lA({onSubmited:t,...e}){const{user:n}=xe(),{themeClass:r,theme:s}=q(),{target:i}=Gr(),{currentSongData:o}=se(ze),{currentPlaylist:l}=se(ta),{action:c,isFetching:u}=aA(),d=f.useRef(null),m=async()=>{if(!d.current)return;const g=d.current.value;if(!g||!g.trim()||i==="song"&&!o||i==="playlist"&&!l)return;const y=i==="song"?o==null?void 0:o.song.id:l==null?void 0:l.id;if(y){switch(e.variant){case"comment":await c({type:"add",target_id:y,text:g});break;case"reply":await c({type:"reply",text:g,comment:e.comment,comment_index:e.comment_index});break}d.current.value="",t&&t()}},p=e.variant==="comment"?"...":`Reply to ${e.comment.user_name}...`;return a.jsxs("div",{className:"flex w-full",children:[a.jsx("div",{className:"w-[40px] h-[40px] flex-shrink-0",children:a.jsx(Ye,{src:n==null?void 0:n.photo_url,className:"rounded-full"})}),a.jsxs("div",{className:`rounded-lg ml-2 flex-grow  flex items-center ${r("bg-black/10 text-black","bg-white/10")}`,children:[a.jsx(Ht,{className:"bg-transparent border-none",placeholder:p,ref:d}),a.jsx(ie,{onClick:m,className:s.content_text,isLoading:u,children:a.jsx(aL,{className:"w-5"})})]})]})}function hW({comment:t,commentIndex:e}){const{comments:n,setComments:r}=Gr(),[s,i]=f.useState(!1),{fetchComment:o}=Vm(),l=async()=>{try{i(!0);const c=await o({comment_id:t.id});if(c){const u=[...n];u[e]={...u[e],replies:c},r(u)}}catch(c){console.log({error:c})}finally{i(!1)}};return a.jsxs("button",{onClick:l,className:"mt-1 text-[#ccc] flex items-center space-x-1",children:[a.jsxs("span",{children:["View ",t.reply," replies"]}),s?a.jsx(He,{className:"w-5 animate-spin"}):a.jsx(oM,{className:"w-5"})]})}function cA({comment:t,index:e,level:n,variant:r="dark-bg "}){const{themeClass:s}=q(),{user:i}=xe(),{action:o,isFetching:l}=aA(),[c,u]=f.useState(!1),d=f.useRef("like"),m=f.useRef(null),p=i==null?void 0:i.liked_comment_ids.includes(t.id),g=(i==null?void 0:i.email)===t.user_email,y=async()=>{var w;await o({type:"delete",comment:t}),(w=m.current)==null||w.close()};return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:`${n==1?"py-2":"mt-2"} `,children:a.jsxs("div",{className:"flex w-full items-start space-x-1.5",children:[a.jsx("div",{className:`flex-shrink-0 ${n===1?"w-[48px] h-[48px]":"w-[40px] h-[40px]"} rounded-full overflow-hidden`,children:a.jsx(Ye,{src:t.user_image_url})}),a.jsxs("div",{className:"flex-grow text-[13px]",children:[a.jsxs("div",{className:"flex",children:[a.jsxs("div",{className:"flex-grow ml-2",children:[a.jsxs("div",{className:`rounded-md ${r==="theme-bg"?s("text-black","text-white"):"text-white"}`,children:[a.jsx(we,{className:`font-medium line-clamp-1 font-[500] ${r==="theme-bg"?s("text-[#333]","text-[#f1f1f1]"):"text-[#f1f1f1]"}`,to:`/user/${t.user_email}`,children:t.user_name}),a.jsx("div",{className:"mt-1 break-all",children:t.text})]}),a.jsxs("div",{className:"flex space-x-2 mt-1",children:[a.jsx("span",{className:"opacity-[.7]",children:oA(t.created_at)}),i&&a.jsx(a.Fragment,{children:g?a.jsx("button",{onClick:()=>{var w;d.current="delete",(w=m.current)==null||w.open()},children:"Delete"}):n===1&&a.jsx("button",{onClick:()=>u(!0),children:"Reply"})})]}),!!t.reply&&n===1&&!t.replies.length&&a.jsx(hW,{comment:t,commentIndex:e})]}),a.jsxs("div",{className:"flex flex-col items-center",children:[a.jsx("button",{className:"p-1",onClick:()=>{d.current="like",o({type:"like",id:t.id})},children:l&&d.current==="like"?a.jsx(He,{className:"w-6 animate-spin"}):a.jsx(a.Fragment,{children:p?a.jsx(Cu,{className:"w-6 text-red-500"}):a.jsx(Za,{className:"w-6"})})}),a.jsx("span",{children:t.like})]})]}),!!t.replies.length&&t.replies.map((w,_)=>a.jsx(cA,{comment:w,index:e,level:2},_)),c&&a.jsx("div",{className:"mt-2",children:a.jsx(lA,{onSubmited:()=>u(!1),comment_index:e,variant:"reply",comment:t})})]})]})}),a.jsx(De,{variant:"animation",ref:m,children:a.jsx(xs,{label:"Delete comment",close:()=>{var w;return(w=m.current)==null?void 0:w.close},loading:l,callback:y})})]})}function Lw({comments:t,isFetching:e=!1,className:n="",variant:r}){const{user:s}=xe();return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:`flex-grow overflow-auto no-scrollbar ${n}`,children:[e&&a.jsx(Wt,{children:a.jsx(He,{className:"animate-spin w-7"})}),!e&&a.jsx(a.Fragment,{children:t.length?t.map((i,o)=>a.jsx(cA,{variant:r,level:1,index:o,comment:i},i.id)):a.jsx(Wt,{children:"..."})})]}),s&&a.jsx("div",{className:"pt-1.5",children:a.jsx(lA,{variant:"comment"})})]})}function fW(){const{shouldFetchComment:t,setComments:e,isOpenComment:n,setIsFetching:r}=Gr(),{currentPlaylist:s}=se(ta),{fetchComment:i}=Vm(),o=async()=>{try{if(!s)return;const l=await i({target_id:s.id});e(l||[])}catch(l){console.log({error:l})}finally{r(!1)}};f.useEffect(()=>{!n||!s||t.current&&(t.current=!1,o())},[n])}function x2(){const{isFetching:t,comments:e}=Gr();return fW(),t?a.jsx(Wt,{children:a.jsx(He,{className:"w-6 animate-spin"})}):a.jsx(Lw,{comments:e})}function mW(){const{theme:t,isOnMobile:e}=q(),{setIsOpenComment:n}=Gr(),r=f.useRef(null),s=()=>{var o;(o=r.current)==null||o.open(),n(!0)},i={button:`bg-${t.alpha} hover:brightness-90 rounded-full w-[40px] flex items-center justify-center`};return a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>s(),className:i.button,children:a.jsx(Qy,{className:"w-5"})}),!e&&a.jsx(De,{onClose:()=>n(!1),variant:"animation",ref:r,children:a.jsx("div",{className:"hidden md:flex flex-col h-[400px] max-h-[60vh] w-[500px] max-w-[85vw] ",children:a.jsx(x2,{})})}),e&&a.jsx(Tx,{ref:r,onClose:()=>n(!1),children:a.jsx(iA,{children:a.jsx(x2,{})})})]})}const pW=(t,e)=>(e==null?void 0:e.type)==="date"?new Date(t.toDate()).toLocaleDateString("en-GB"):new Date(t.toDate()).toLocaleString();function gW({playlist:t,showSkeleton:e,isLiked:n,variant:r}){const{theme:s}=q(),{currentSongData:i}=se(ze),o=t?i==null?void 0:i.song.queue_id.includes(`${t.id}`):!1,l={container:"flex flex-col md:flex-row lg:flex-col",smallText:"",link:`${s.content_hover_text} hover:underline`},c=()=>t?a.jsxs(a.Fragment,{children:[a.jsx(we,{className:`block hover:underline ${s.content_hover_text} ${l.smallText}`,to:`/singer/${t.singers[0].id}}`,children:t.singers[0].name}),a.jsxs("p",{className:"text-sm",children:[a.jsx("span",{className:"text-red-500",children:"❤ "}),_r(t.like)]})]}):a.jsx(a.Fragment,{}),u=()=>{if(!t)return a.jsx(a.Fragment,{});switch(r){case"my-playlist":return a.jsx(a.Fragment,{children:a.jsx("p",{className:l.smallText,children:t.is_public?"Public":"Private"})});case"others-playlist":return a.jsxs(a.Fragment,{children:[a.jsxs("p",{children:[a.jsx("span",{className:"text-red-500 text-base",children:"❤ "}),_r(t.like)]}),!!t.singers.length&&a.jsx("p",{className:l.smallText,children:t.singers.map((d,m)=>a.jsx(we,{className:`${l.link}`,to:`/singer/${d.id}`,children:(m?", ":"")+d.name},m))}),!t.is_official&&a.jsxs("p",{className:l.smallText,children:["Provided by"," ",a.jsx(we,{className:l.link,to:`/user/${t.owner_email}`,children:t.distributor})]}),a.jsxs("p",{className:l.smallText,children:["Last update:"," ",pW(t.updated_at,{type:"date"})]})]})}};return a.jsx(a.Fragment,{children:a.jsxs("div",{className:l.container,children:[a.jsx("div",{className:"w-full flex-shrink-0 px-10 md:w-1/3 md:px-0 lg:w-full",children:e?a.jsx(le,{className:"pt-[100%] rounded-lg"}):t&&a.jsx(dv,{data:t,active:o,variant:"image"})}),a.jsxs("div",{className:"flex flex-col items-center mt-3 md:items-start md:ml-5 md:mt-0 lg:ml-0 lg:mt-3 lg:items-center",children:[e?a.jsxs("div",{className:"space-y-1 flex flex-col items-center",children:[a.jsx(le,{className:"h-[24px] w-[170px]"}),a.jsx(le,{className:"h-[17px] w-[170px]"}),a.jsx(le,{className:"h-[17px] w-[60px]"}),a.jsx(le,{className:"h-[17px] w-[100px]"})]}):t&&a.jsxs(a.Fragment,{children:[a.jsx("p",{className:"text-xl font-[600] leading-[1.2]",children:t.name}),a.jsx("div",{className:"mt-2.5 text-[#666] text-center md:text-left lg:text-center text-[13px]",children:t.is_album?c():u()})]}),t&&a.jsxs("div",{className:"flex flex-col items-center mt-3 md:flex-row md:mt-auto lg:flex-col lg:mt-3",children:[a.jsx(iW,{}),a.jsxs("div",{className:"flex space-x-3 mt-3 md:ml-3 md:mt-0 lg:mt-3 lg:ml-0",children:[a.jsx(cW,{variant:r}),r!=="my-playlist"&&n!==null&&a.jsx(aW,{isLiked:n,playlist:t}),a.jsx(Qm,{target:"playlist",children:a.jsx(mW,{})})]})]})]})]})})}function uA(){const{behind:t,ahead:e,shouldStoreLocation:n,setBehind:r,setAhead:s}=mI(),i=rr(),o=Gt(),l=f.useMemo(()=>i.pathname+i.search,[i]);return{ahead:e,behind:t,backward:()=>{const m=[...t],p=m.pop();p&&(n.current=!1,s(g=>[...g,l]),r(m),o(p))},forward:()=>{const m=[...e],p=m.pop();p&&(n.current=!1,r(g=>[...g,l]),s(m),o(p))},goHome:()=>{o("/")}}}function Cl({className:t=""}){const{backward:e,behind:n,goHome:r}=uA(),s=()=>{n.length?e():r()};return a.jsx(ie,{onClick:s,className:`p-1.5 md:hidden z-[9] relative ${t}`,color:"primary",size:"clear",children:n.length?a.jsx(jI,{className:"w-6"}):a.jsx(fm,{className:"w-6"})})}function xW(){const{currentPlaylist:t}=se(ta),{user:e}=xe(),n=e&&t?t.owner_email===e.email&&!t.is_official:!1,r=e?t?e.liked_playlist_ids.includes(t.id):!1:null,{isFetching:s}=fH();return!s&&!t?a.jsx(Wt,{children:a.jsx(Xe,{variant:"with-home-button"})}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"mb-5",children:a.jsx(Cl,{})}),a.jsxs("div",{className:"lg:flex lg:-mx-3",children:[a.jsx("div",{className:"w-full lg:w-1/4 lg:px-3",children:a.jsx(gW,{showSkeleton:s,variant:n?"my-playlist":"others-playlist",playlist:t,isLiked:r})}),a.jsx("div",{className:"w-full lg:w-3/4 lg:px-3",children:a.jsx("div",{className:"mt-[30px] lg:mt-0",children:a.jsx(sW,{loading:s,variant:n?"my-playlist":"others-playlist"})})})]}),a.jsx(bu,{})]})}function dA({tab:t}){const{user:e}=xe(),{setUploadedSongs:n,setFavoriteSongs:r,shouldFetchUserSongs:s,shouldFetchFavoriteSongs:i,favoriteSongs:o,uploadedSongs:l}=Pn(),{setErrorToast:c}=fe(),[u,d]=f.useState(!0),m=async()=>{if(e)try{switch(t){case"favorite":{if(i.current){if(i.current=!1,e.liked_song_ids.length){const p=he(wn,Q(ti(),"in",e.liked_song_ids)),g=await _n(p),y=[];e.liked_song_ids.forEach(w=>{const _=g.find(E=>E.id===w);_&&y.push(_)}),r(y)}}else await Us(100);break}case"uploaded":if(s.current){s.current=!1;const p=he(wn,Q("owner_email","==",e.email),Q("is_official","==",!1)),g=await _n(p);n(g)}else await Us(100)}}catch(p){console.log({message:p}),c()}finally{d(!1)}};return f.useEffect(()=>{m()},[]),{isFetching:u,uploadedSongs:l,favoriteSongs:o,user:e}}function yW(){const{handleSetSong:t}=ni({variant:"songs"}),{favoriteSongs:e,user:n,isFetching:r}=dA({tab:"favorite"}),s=i=>{t(i.queue_id,e)};if(n)return a.jsxs(ps,{children:[a.jsx(qm,{variant:"favorite-song",children:r?a.jsx(le,{className:"h-[20px] w-[90px]"}):a.jsxs("p",{className:"font-[500] opacity-[.5]",children:[e.length," Songs"]})}),r&&yl,!r&&a.jsx(a.Fragment,{children:e.length?a.jsx(a.Fragment,{children:a.jsx(ri,{setSong:s,songs:e})}):a.jsx(Xe,{})})]})}function vW({song:t}){return a.jsxs("div",{className:"flex items-center justify-between p-[10px]",children:[a.jsxs("div",{className:"flex-grow flex",children:[a.jsx(Yi,{className:"w-[18px] mr-2.5"}),a.jsx("div",{className:"h-[54px] w-[54px] rounded overflow-hidden",children:a.jsx(Ye,{src:t.image_url})}),a.jsxs("div",{className:"ml-[10px]",children:[a.jsx("h5",{className:"line-clamp-1 font-medium overflow-hidden",children:t.name}),a.jsx("p",{className:"opacity-[.7] leading-[1.2] line-clamp-1 text-sm",children:t.singers[0].name})]})]}),a.jsxs("div",{className:"flex space-x-1",children:[a.jsx(He,{className:"animate-spin w-5"}),a.jsx("p",{className:"text-sm",children:"Uploading..."})]})]})}function wW(){const{theme:t}=q(),{uploadingSongs:e,isUploading:n}=yI(),{handleSetSong:r}=ni({variant:"songs"}),{uploadedSongs:s,isFetching:i,user:o}=dA({tab:"uploaded"}),l=u=>{r(u,s)},c=f.useMemo(()=>i?0:e.length+s.length,[e,s,i]);return o?a.jsxs(ps,{children:[a.jsx(qm,{variant:"uploaded-song",children:i?a.jsx(a.Fragment,{children:a.jsx("div",{className:"h-[30px] mb-[10px] flex items-center",children:a.jsx(le,{className:"h-[20px] w-[90px]"})})}):a.jsxs("div",{className:"flex justify-between items-center w-full",children:[a.jsxs("p",{className:"font-[500] opacity-[.5]",children:[c," Songs"]}),a.jsx("button",{disabled:n,children:a.jsxs("label",{className:`${t.content_bg} items-center space-x-1 hover:opacity-80 py-1 rounded-full flex px-4 cursor-pointer`,htmlFor:"song_upload",children:[a.jsx(qy,{className:"w-5"}),a.jsx("span",{className:"",children:"Upload"})]})})]})}),a.jsxs("div",{className:"",children:[i&&yl,!i&&a.jsx(a.Fragment,{children:c?a.jsxs(a.Fragment,{children:[!!s.length&&a.jsx(ri,{setSong:u=>l(u.queue_id),songs:s,songVariant:"own-song"}),e.map((u,d)=>a.jsx(vW,{song:u},d))]}):a.jsx(Xe,{})})]})]}):a.jsx(a.Fragment,{})}function hA(){const{user:t}=xe(),{setPlaylists:e,shouldFetchUserPlaylists:n,playlists:r}=Pn(),{setErrorToast:s}=fe(),[i,o]=f.useState(!0);return{isFetching:i,playlists:r,user:t,setIsFetching:o,getPlaylist:async()=>{try{if(!t)return;if(o(!0),n.current){n.current=!1;const c=he(wr,Q(ti(),"in",t.liked_playlist_ids)),d=(await Wr(c)).filter(m=>!m.is_official&&m.owner_email===t.email?!0:!!m.is_public);e(d)}else await Us(100)}catch(c){console.log({message:c}),s()}finally{o(!1)}}}}function _W(){const{user:t}=xe(),{myMusicAddPlaylist:e,isFetching:n}=jw(),r=f.useRef(null),s=()=>{var o;return(o=r.current)==null?void 0:o.close()},i=async(o,l)=>{await e(o,l),s()};if(t)return a.jsxs(a.Fragment,{children:[a.jsxs(ie,{onClick:()=>{var o;return(o=r.current)==null?void 0:o.open()},size:"clear",className:"py-1 px-4",color:"primary",children:[a.jsx(gs,{className:"w-6"}),a.jsx("span",{children:"Add new playlist"})]}),a.jsx(De,{ref:r,variant:"animation",children:a.jsx("div",{className:"max-h-[80vh] max-w-[85vw] w-[400px]",children:a.jsx(Il,{close:s,isLoading:n,variant:"add",user:t,submit:i})})})]})}function bW(){const{isFetching:t,playlists:e,getPlaylist:n}=hA();return f.useEffect(()=>{n()},[]),a.jsx(a.Fragment,{children:a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx(Se,{title:"Playlist"}),a.jsx(_W,{})]}),a.jsx(vl,{loading:t,playlists:e})]})})}function SW(){const{user:t}=xe(),{shouldFetchUserSingers:e,setSingers:n,singers:r}=Pn(),{setErrorToast:s}=fe(),[i,o]=f.useState(!0);return{isFetching:i,singers:r,user:t,setIsFetching:o,getSinger:async()=>{try{if(!t)return;if(o(!0),e.current&&t.liked_singer_ids.length){e.current=!1;const c=he(kf,Q(ti(),"in",t.liked_singer_ids)),u=await Tf(c);n(u)}else await Us(100)}catch(c){console.log({message:c}),s()}finally{o(!1)}}}}function EW(){const{isFetching:t,singers:e,getSinger:n}=SW(),r=[...Array(3).keys()].map(s=>a.jsx(Sx,{variant:"skeleton"},s));return f.useEffect(()=>{n()},[]),t?a.jsxs(a.Fragment,{children:[a.jsx(le,{className:"h-[48px] w-[160px]"}),a.jsx("div",{className:"flex flex-row flex-wrap -mx-2 mt-3",children:r})]}):!t&&!e.length?a.jsx(a.Fragment,{}):a.jsx(a.Fragment,{children:a.jsxs("div",{children:[a.jsx(Se,{title:"Singers"}),a.jsx("div",{className:"flex flex-row flex-wrap -mx-2 mt-3",children:e.map((s,i)=>a.jsx(Sx,{variant:"singer-item",singer:s},i))})]})})}function kW(){const[t,e]=f.useState("Favorite");return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"space-y-5",children:[a.jsx(Cl,{}),a.jsx(bW,{}),a.jsx(EW,{}),a.jsxs("div",{children:[a.jsx(Se,{title:"Songs"}),a.jsx("div",{className:"flex space-x-2 my-3",children:a.jsx(ys,{render:n=>n,setTab:e,tab:t,tabs:["Favorite","Uploaded"]})}),t==="Favorite"?a.jsx(yW,{}):a.jsx(wW,{})]})]}),a.jsx(bu,{})]})}const TW=()=>{const[t,e]=f.useState(),[n,r]=f.useState(""),[s,i]=f.useState([]),[o,l]=f.useState([]),[c,u]=f.useState(!1),[d,m]=f.useState(!1),[p,g]=f.useState(!1),[y,w]=f.useState(),_=f.useRef(0),E=f.useMemo(()=>y!==void 0?o[y]:void 0,[y,o]);return{song:t,setSong:e,baseLyric:n,setBaseLyric:r,baseLyricArr:s,setBaseLyricArr:i,lyrics:o,setLyrics:l,updateLyric:(S,C)=>{l(D=>{const F={...D[S],...C};return D[S]=F,[...D]})},isFetching:c,setIsFetching:u,isChanged:d,setIsChanged:m,start:_,selectLyricIndex:y,setSelectLyricIndex:w,currentLyric:E,isPreview:p,setIsPreview:g}},fA=f.createContext(null);function IW({children:t}){return a.jsx(fA.Provider,{value:TW(),children:t})}const En=()=>{const t=f.useContext(fA);if(!t)throw new Error("Edit lyric context not found");return t};function CW({audioEle:t,isClickPlay:e,song:n}){const{start:r,baseLyricArr:s,lyrics:i,setLyrics:o,setIsChanged:l,setIsFetching:c,baseLyric:u}=En(),{setErrorToast:d,setSuccessToast:m}=fe(),p=i.length>=s.length,g=e&&!!s.length&&!p,y=()=>{if(!t||!s.length||p||!n)return;const b=+t.currentTime.toFixed(1);if(r.current===b)return;const S=s[i.length],C=m2({start:r.current,end:b,text:S});if(r.current=b,o(D=>[...D,C]),s.length===i.length+2){const D=s[s.length-1],F=m2({start:r.current,end:n.duration,text:D});o(I=>[...I,F])}l(!0)},w=()=>{if(i.length&&t){const b=i[i.length-1].start;r.current=b,t.currentTime=b,o(S=>S.slice(0,-1)),l(!0)}},_=()=>{if(!n)return;const b={song_id:n.id,base:u,lyrics:JSON.stringify(i)};nt("temp-lyric",b)};return{addLyric:y,removeLyric:w,isEnableAddBtn:g,submit:async()=>{try{if(c(!0),!n)return;const b=ro(ke),S={lyrics:JSON.stringify(i),base:u},C=Ct(ke,"Songs",n.id);if(n.lyric_id){const D=Ct(ke,"Lyrics",n.lyric_id);b.update(D,S)}else{const D=Ct(vr(ke,"Lyrics")),F={lyric_id:D.id,updated_at:Qs()};b.set(D,S),b.update(C,F)}await b.commit(),m("Edit lyric successful"),l(!1),nt("temp-lyric","")}catch(b){console.log({error:b}),d(),_()}finally{c(!1)}}}}function jW({closeModal:t}){const{setErrorToast:e,setSuccessToast:n}=fe(),{song:r,setSong:s}=En(),[i,o]=f.useState(),[l,c]=f.useState(!1);return{songFile:i,song:r,setSongFile:o,isFetching:l,handleSubmit:async()=>{try{if(!i||!r)throw new Error;c(!0);const{filePath:d,fileURL:m}=await Cw({file:i,folder:"/songs/",namePrefix:"beat"}),p={beat_url:m,beat_file_path:d};await kt({collectionName:"Songs",id:r.id,data:p}),r.beat_file_path&&Xn({filePath:r.beat_file_path}),s(()=>({...r,...p})),n("Upload song beat successful"),t()}catch(d){console.log({error:d}),e()}finally{c(!1)}}}}function RW({closeModal:t}){const{theme:e}=q(),{songFile:n,setSongFile:r,isFetching:s,handleSubmit:i,song:o}=jW({closeModal:t}),l=c=>{var u;(u=c.target.files)!=null&&u.length&&r(c.target.files[0])};return a.jsxs("div",{className:"w-[500px] max-w-[80vw] flex flex-col",children:[a.jsx(jt,{title:"Song beat",close:t}),a.jsx("input",{onChange:l,type:"file",multiple:!0,accept:"audio",id:"song_upload",className:"hidden"}),o&&(n||(o==null?void 0:o.beat_url))&&a.jsx("audio",{src:n?URL.createObjectURL(n):o.beat_url,controls:!0}),a.jsx(ie,{size:"clear",children:a.jsx("label",{htmlFor:"song_upload",className:`${e.content_bg} seld-start rounded-full px-5 py-1.5 cursor-pointer mt-2`,children:a.jsx(qy,{className:"w-5"})})}),a.jsx(ie,{disabled:!n,onClick:i,isLoading:s,color:"primary",className:"mt-3 ml-auto font-playwriteCU",children:"Save"})]})}const AW=40;function NW({closeModal:t}){const{theme:e}=q(),{baseLyric:n,setBaseLyric:r,baseLyricArr:s,setIsChanged:i,lyrics:o}=En(),[l,c]=f.useState(n),u=f.useRef(null),d=f.useRef(null),m=()=>{const g=l.split(/\r?\n/).filter(y=>y).filter(y=>y.trim()).join(`\r
`);r(g),i(!0),t()};function p(g){const y=[...s];return y[g]=`<div style="color: transparent; border-radius: 4px; background-color: ${e.content_code}">${y[g]}</div>`,y.join(`\r
`)}return f.useEffect(()=>{if(o.length&&u.current&&d.current){const g=AW*(o.length-1);u.current.scrollTop=g,d.current.style.paddingBottom=g+"px"}},[]),f.useEffect(()=>{const g=()=>{if(u.current&&d.current){const y=u.current.scrollTop;d.current.scrollTop=y}};return u.current&&u.current.addEventListener("scroll",g),()=>{u.current&&u.current.removeEventListener("scroll",g)}},[]),a.jsxs("div",{className:"w-[500px] max-w-[85vw]",children:[a.jsx(jt,{close:t,title:"Edit lyric"}),a.jsxs("div",{className:"relative h-[60vh] overflow-hidden rounded-md bg-white/10 ",children:[a.jsx("div",{ref:d,className:"whitespace-break-spaces text-transparent px-2 py-2 absolute leading-[40px] h-full overflow-auto top-0 left-0 w-full",dangerouslySetInnerHTML:{__html:p(o.length===s.length?o.length-1:o.length)}}),a.jsx("textarea",{style:{resize:"none"},ref:u,className:"absolute bg-transparent top-0 outline-none w-full leading-[40px] py-2 px-3 h-full no-scrollbar",value:l,onChange:g=>c(g.target.value)})]}),a.jsx("p",{className:"ml-auto mt-5",children:a.jsx(ie,{onClick:m,color:"primary",className:"rounded-full",children:"Save"})})]})}function PW({pause:t}){const{theme:e}=q(),{song:n}=En(),[r,s]=f.useState(""),i=f.useRef(null),o=f.useRef(null),l=d=>{var m,p;t(),s(d),(m=i.current)==null||m.open(),(p=o.current)==null||p.close()},c=()=>{var d;return(d=i.current)==null?void 0:d.close()},u=()=>{if(r)switch(r){case"lyric":return a.jsx(NW,{closeModal:c});case"tutorial":return a.jsxs("div",{className:"w-[500px] max-w-[90vw]",children:[a.jsx(jt,{title:"Tutorial",close:c}),a.jsx("div",{className:"h-[500px] max-h-[75vh] overflow-y-auto no-scrollbar",children:a.jsx("img",{className:"w-full border rounded-[16px]",src:"",alt:""})})]});case"song-beat":return n&&a.jsx(RW,{closeModal:c})}};return a.jsxs(a.Fragment,{children:[a.jsxs(pr,{children:[a.jsx(gr,{ref:o,children:a.jsx(ie,{size:"clear",className:`${e.content_bg} h-[36px] w-[36px] justify-center rounded-full mt-2`,children:a.jsx(gl,{className:"w-6"})})}),a.jsx(xr,{className:"top-[calc(100%+8px)] right-0 z-[9]",appendTo:"parent",children:a.jsx(eA,{className:"w-[140px]",children:a.jsxs(Tl,{children:[a.jsxs("button",{onClick:()=>l("lyric"),children:[a.jsx(Js,{className:"w-5"}),a.jsx("span",{children:"Edit lyric"})]}),a.jsxs("button",{onClick:()=>l("tutorial"),children:[a.jsx(AI,{className:"w-5"}),a.jsx("span",{children:"Tutorial"})]}),a.jsxs("button",{onClick:()=>l("song-beat"),children:[a.jsx(Yi,{className:"w-5"}),a.jsx("span",{children:"Song beat"})]}),a.jsxs("button",{onClick:()=>l("song-beat"),children:[a.jsx(B6,{className:"w-5"}),a.jsx("span",{children:"Export"})]})]})})})]}),a.jsx(De,{variant:"animation",ref:i,children:u()})]})}function FW({audioEle:t},e){const{theme:n}=q(),{song:r,lyrics:s,isPreview:i,setIsPreview:o}=En(),l=f.useRef(null),{backward:c,forward:u,handlePlayPause:d,pause:m,seek:p,status:g,isClickPlay:y}=kw({audioEle:t,progressLineRef:l}),{addLyric:w,removeLyric:_,isEnableAddBtn:E,submit:b}=CW({audioEle:t,isClickPlay:y,song:r});f.useImperativeHandle(e,()=>({seek:p,pause:m,submit:b}));const S=()=>{if(!y&&s.length){const F=s[s.length-1].end;t.currentTime=F}d()},C={button:`mt-2 ml-2 space-x-1 ${n.content_bg} rounded-full`,icon:"w-6",arrow:"before:content-[''] before:absolute before:-translate-x-1/2 before:left-[27px]  before:bottom-[calc(100%-1px)] before:z-[-1] before:border-8 before:border-transparent before:border-b-amber-800"},D=()=>{switch(g){case"error":return a.jsx(hm,{className:"w-6"});case"playing":return a.jsx(mm,{className:"w-6"});case"paused":return a.jsx(Zc,{className:"w-6"});case"waiting":return a.jsx(He,{className:"w-6 animate-spin"})}};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-start flex-wrap -mt-2 -ml-2 [&_button]:outline-none",children:[a.jsx(HI,{className:"mt-2 ml-2",audioEle:t,postLocalStorageKey:"edit_lyric"}),a.jsx(ie,{className:C.button,onClick:S,children:D()}),a.jsxs(ie,{disabled:!E||i,onClick:w,className:C.button,children:[a.jsx(br,{className:"w-6"}),a.jsx("span",{children:"Add"})]}),a.jsxs(ie,{disabled:!s.length||i,onClick:_,className:C.button,children:[a.jsx(tv,{className:"w-6"}),a.jsx("span",{children:"Remove"})]}),a.jsxs(ie,{onClick:()=>c(2),className:C.button,children:[a.jsx(Gy,{className:"w-6"}),a.jsx("span",{children:"2s"})]}),a.jsxs(ie,{onClick:()=>u(2),className:C.button,children:[a.jsx("span",{children:"2s"}),a.jsx(Zy,{className:"w-6"})]}),a.jsxs(ie,{onClick:()=>{o(!i),m()},className:C.button,children:[a.jsx(jD,{className:"w-6"}),a.jsx("span",{children:i?"Edit":"Preview"})]}),a.jsx("div",{className:"ml-auto",children:a.jsx(PW,{pause:m})})]}),a.jsx("div",{ref:l,style:{backgroundColor:"rgba(255,255,255,.3)"},className:"h-1 rounded-full mt-3 w-full"})]})}const DW=f.forwardRef(FW);function LW({lyric:t,openModal:e,seek:n,isLast:r,status:s,activeColor:i,isPreview:o},l){const c=()=>{switch(s){case"active":return`${i||"text-[#ffed00]"} active-lyric`;default:return""}};return a.jsx(a.Fragment,{children:a.jsxs("div",{className:"pt-[10px] last:mb-[30vh]",children:[a.jsx("button",{className:"text-[18px] hover:underline",onClick:()=>n(t.start),children:zs(+t.start)}),a.jsxs("p",{ref:l,className:`font-[700] select-none relative ${Li(!o,"pr-6")} ${c()}`,children:[t.text,!o&&a.jsx("button",{onClick:e,className:" absolute mt-1 ml-1",children:a.jsx(vM,{className:"w-5"})})]}),r&&t.end!==t.start&&a.jsx("button",{className:"hover:underline pt-[10px]",onClick:()=>n(t.end),children:zs(+t.end)})]})})}const MW=f.forwardRef(LW);function OW({text:t,className:e="",status:n,activeColor:r},s){const i=()=>{switch(n){case"coming":return"disable";case"active":return`${r||"text-[#ffed00]"} active-lyric`;case"done":return"disable"}};return a.jsx("p",{ref:s,className:`${e} transition-transform duration-[.3s] origin-left select-none font-[700] ${i()}`,children:t})}const mA=f.forwardRef(OW),zd=.3;function pA({audioEle:t,lyrics:e,isActive:n}){const[r,s]=f.useState(0),i=f.useRef("instant"),o=f.useRef(0),l=f.useRef([]),c=f.useRef(0),u=()=>{const m=t.currentTime>o.current?"forward":"backward";o.current=t.currentTime;let p=c.current;switch(m){case"forward":for(;e[p+1]&&e[p+1].start-zd<o.current+zd;)p+=1;break;case"backward":for(;e[p-1]&&e[p-1].end-zd>o.current+zd;)p-=1;break}p!==c.current&&(Math.abs(p-c.current)>5&&(i.current="instant"),c.current=p,s(p),uI(l.current[p],i.current),i.current==="instant"&&(i.current="smooth"))},d=()=>{s(0),c.current=0,o.current=0};return f.useEffect(()=>(n&&u(),()=>{n||d()}),[n]),f.useEffect(()=>{if(!(!n||!e.length))return t.addEventListener("timeupdate",u),()=>{t.removeEventListener("timeupdate",u)}},[e,n]),f.useEffect(()=>()=>{d()},[e]),{currentIndex:r,lyricRefs:l}}function $W(){const{lyrics:t,isPreview:e}=En(),n=f.useRef(null);return f.useEffect(()=>{!n.current||e||uI(n.current,"instant")},[t.length,e]),{activeLyricRef:n}}function BW({controlRef:t,audioEle:e,openEditModal:n}){const{theme:r}=q(),{baseLyricArr:s,lyrics:i,setSelectLyricIndex:o,song:l,isPreview:c}=En(),{activeLyricRef:u}=$W(),{currentIndex:d,lyricRefs:m}=pA({audioEle:e,isActive:c,lyrics:i}),p=y=>{var w;(w=t.current)==null||w.seek(y)},g=y=>{var w;typeof y=="number"&&((w=t.current)==null||w.pause(),o(y),n())};return a.jsx(a.Fragment,{children:a.jsxs("div",{className:`flex-grow  overflow-auto flex  no-scrollbar md:text-lg rounded-xl px-2 pt-3 mt-3 ${r.side_bar_bg} ${Li(c,"justify-center")}`,children:[a.jsx("div",{className:`w-1/2 ${Li(c,"hidden")}`,children:s.length?a.jsx(a.Fragment,{children:s.map((y,w)=>{let _=w===i.length?"active":w<i.length?"done":"coming";return _==="done"&&w===s.length-1&&(_="active"),a.jsx(mA,{ref:_==="active"?u:null,activeColor:r.type==="light"?r.content_text:"",className:"pt-[38px] mr-[24px]",status:_,text:y},w)})}):a.jsx("p",{children:"..."})}),a.jsx("div",{className:`w-1/2 ${Li(c,"text-center")}`,children:!!(i!=null&&i.length)&&l&&i.map((y,w)=>{let _="coming";return c&&(d===w?_="active":w<d&&(_="done")),a.jsx(MW,{ref:E=>m.current[w]=E,openModal:()=>g(w),seek:p,isPreview:c,lyric:y,status:_,activeColor:r.type==="light"?r.content_text:"",isLast:w===i.length-1&&w!==s.length-1},w)})})]})})}function zW({audioRef:t}){const{user:e}=xe(),{baseLyric:n,setSong:r,song:s,setBaseLyricArr:i,setBaseLyric:o,setLyrics:l,isChanged:c,isFetching:u,start:d}=En(),[m,p]=f.useState(!0),g=f.useRef(!1),y=Xi(),w=E=>{if(!E.length)return;const b=E.length-1;if(t.current){const S=E[b].end;d.current=S}},_=async()=>{try{if(!y.id)throw new Error("");const E=await Hr({collectionName:"Songs",id:y.id});if(!E.exists())throw new Error("");const b={...E.data(),id:E.id,queue_id:""};if(b.lyric_id){const S=await Hr({collectionName:"Lyrics",id:b.lyric_id});if(S.exists()){const{base:C,lyrics:D}=S.data(),F=JSON.parse(D);o(C),l(F),w(F)}}r(b)}catch(E){console.log({message:E})}finally{p(!1)}};return f.useEffect(()=>{g.current||(g.current=!0,_())},[e]),f.useEffect(()=>{if(!n)return;const E=n.split(/\r?\n/);i(E)},[n]),f.useEffect(()=>{if(!c)return;const E=b=>{b.preventDefault()};return window.addEventListener("beforeunload",E),()=>{window.removeEventListener("beforeunload",E)}},[c]),{isFetching:m,song:s,isChanged:c,isSubmitting:u}}function gA(t,e){if(e.length===1&&e[0]===0)return[t];const n=[];let r=0;e.sort((s,i)=>s-i);for(const s of e)s>t.length||s<0||(n.push(t.substring(r,s)),r=s);return n.push(t.substring(r)),n}const UW=["Edit","Record"];function VW(){const[t,e]=f.useState(0),[n,r]=f.useState(),[s,i]=f.useState(""),[o,l]=f.useState([[]]),[c,u]=f.useState([]),[d,m]=f.useState(!1),[p,g]=f.useState("Edit"),[y,w]=f.useState("paused"),_=f.useRef(null),E=f.useRef(null),b=f.useRef(null),S=f.useRef(null),C=f.useRef(null),D=f.useRef(null),F=f.useRef(null),I=f.useRef(null),k=f.useRef(),R=f.useRef(!1),j=f.useRef(0),N=f.useRef(0),P=f.useRef(0),A=f.useRef([]),ee=f.useRef([]),me=f.useRef(!0),ye=f.useRef(!1),Ne=f.useMemo(()=>s.split(" ").filter(te=>te.trim()),[s]),H=f.useMemo(()=>Ne.map((te,_e)=>({text:te,positions:o[_e]})),[s,o]),Y=f.useMemo(()=>{const te=[];return H.forEach(_e=>{const Ie=gA(_e.text,_e.positions);te.push(...Ie)}),te.filter(_e=>_e)},[s,o]);return{eleRefs:{endTimeRangeRef:E,overlayRef:_,startTimeRangeRef:b,startRefText:S,endRefText:C,currentWordRef:D,growInputRef:F,tempWordRef:I},tabProps:{tab:p,setTab:g,tabs:UW},eventRefs:{playWhenSpaceRef:me,moveArrowToGrowRef:ye},currentWords:Ne,currentWordsData:H,currentSplitWords:Y,actuallyEndRef:j,playerRef:k,actuallyStartRef:N,tempActuallyStartRef:P,wordsRatioRef:A,mergedGrowListRef:ee,isChangedRef:R,wordIndex:t,setWordIndex:e,growList:c,setGrowList:u,isOpenEditLyricModal:d,SetIsOpenEditLyricModal:m,setStatus:w,status:y,text:s,setText:i,cut:o,setCut:l,localLyricIndex:n,setLoacalLyricIndex:r}}const xA=f.createContext(null);function HW({children:t}){return a.jsx(xA.Provider,{value:VW(),children:t})}const Ft=()=>{const t=f.useContext(xA);if(!t)throw new Error("LyricEditorProvider not found");return t};function yA(t,e){const n=`lyric_${Qu(4)}`,r=document.querySelector("style");if(!r)return n;let s=`@keyframes ${n}{0%{width:0%}`;if(!t.length)return s+="100%{width:100%}}",r.innerText=s,n;let i=t.reduce((u,d)=>u+d,0);const o=[];let l=0,c=0;for(let u=0;u<e.length-1;u++){const d=e[u],m=t[u];c+=d,l+=m,o.push({progress:Math.round(l/i*100),width:c})}for(const u of o)s+=`${u.progress}%{width:${u.width}%}`;return s+="100%{width:100%}}",r.innerText=s,n}function WW({audioEle:t}){const{eleRefs:e,actuallyEndRef:n,actuallyStartRef:r,tempActuallyStartRef:s,wordsRatioRef:i,mergedGrowListRef:o,status:l,setStatus:c}=Ft(),{play:u,pause:d,statusRef:m}=kw({audioEle:t,statusFromParent:l,setStatusFromParent:c}),{overlayRef:p}=e,g=()=>{d(),p.current&&(p.current.style.animation="none")},y=()=>{if(t.currentTime=r.current,!s.current&&p.current){const E=yA(o.current,i.current);p.current.style.animation=`${E} ${((n.current-r.current)/t.playbackRate).toFixed(2)}s linear`}u()},w=()=>{m.current==="paused"?y():g()},_=()=>{if(+t.currentTime.toFixed(1)>=n.current)return g()};return f.useEffect(()=>{if(t)return t.addEventListener("timeupdate",_),()=>{t.removeEventListener("timeupdate",_)}},[]),{handlePlayPause:w,_pause:g,_play:y,status:l}}function qW({audioEle:t}){const{playerRef:e}=Ft(),{_play:n,_pause:r,handlePlayPause:s}=WW({audioEle:t});return f.useEffect(()=>{e.current={handlePlayPause:s,pause:r,play:n}},[]),a.jsx(a.Fragment,{})}function GW({audioEle:t}){const{tabProps:e}=Ft(),{theme:n}=q();return a.jsxs(a.Fragment,{children:[a.jsx(qW,{audioEle:t}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(ys,{className:"bg-white/10",...e,render:r=>r}),a.jsx(HI,{positions:"left",bg:n.content_bg,className:"bg-transparent hover:bg-white/10",audioEle:t,postLocalStorageKey:"edit_lyric_tune"})]})]})}function QW(){const{updateLyric:t,setIsChanged:e,selectLyricIndex:n}=En(),{actuallyEndRef:r,actuallyStartRef:s,growList:i,text:o,cut:l}=Ft();return{updateLyricTune:async()=>{if(typeof n!="number")throw new Error("selectLyricIndex is undefine");const u={tune:{start:s.current,end:r.current,grow:i},cut:l,text:o};t(n,u),e(!0)}}}function KW({closeModal:t}){const{setSelectLyricIndex:e,selectLyricIndex:n,lyrics:r}=En(),{isChangedRef:s,playerRef:i}=Ft(),{updateLyricTune:o}=QW(),l=()=>{o(),t()},c=u=>{var d;if(typeof n=="number")switch(s.current&&(s.current=!1,o()),(d=i.current)==null||d.pause(),u){case"next":if(n===r.length-1)return;e(m=>m+1);break;case"prev":if(n===0)return;e(m=>m-1);break}};return a.jsxs("div",{className:"flex justify-end space-x-2 mt-5 ",children:[a.jsxs(ie,{color:"primary",disabled:n===0,onClick:()=>c("prev"),className:"font-playwriteCU",children:[a.jsx(Gy,{className:"w-6"}),a.jsx("span",{children:"Previous"})]}),a.jsxs(ie,{color:"primary",disabled:n===r.length-1,onClick:()=>c("next"),className:"font-playwriteCU",children:[a.jsx("span",{children:"Next"}),a.jsx(Zy,{className:"w-6"})]}),a.jsx(ie,{disabled:!s.current,color:"primary",onClick:l,className:"font-playwriteCU",children:"Ok"})]})}function XW(){const{isOpenEditLyricModal:t,playerRef:e,eleRefs:{currentWordRef:n},eventRefs:r}=Ft(),s=o=>{var l;if(o.key===" "){if(!r.playWhenSpaceRef.current)return;o.preventDefault(),(l=e.current)==null||l.handlePlayPause()}if(o.key==="ArrowRight"||o.key==="ArrowLeft"){if(!r.moveArrowToGrowRef.current)return;const c=n.current;if(!c)return;switch(o.key){case"ArrowRight":o.preventDefault(),c!=null&&c.nextSibling&&(c==null?void 0:c.nextSibling).click();break;case"ArrowLeft":o.preventDefault(),c!=null&&c.previousSibling&&(c==null?void 0:c.previousSibling).click();break}}},i=o=>{if(!r.moveArrowToGrowRef.current)return;const l=o.target,c=document.querySelectorAll(".word-item");let u=!1;c.forEach(d=>d.contains(l)?u=!0:{}),!u&&(r.moveArrowToGrowRef.current=!1)};f.useEffect(()=>(window.addEventListener("mousedown",i),window.addEventListener("keydown",s),()=>{window.removeEventListener("mousedown",i),window.removeEventListener("keydown",s)}),[t])}const vA=t=>{const e=t.clientWidth,n=[];return t.childNodes.forEach(r=>{n.push(Math.round(r.offsetWidth/e*100))}),n};function Mw(t,e,n){const r=[];if(!n.length)return[];let s=0;return t.forEach((i,o)=>{const l=e[o].length;if(l===0)r.push(n[s]),s++;else if(l>0){const u=n.slice(s,s+l+1).reduce((d,m)=>(s++,+(d+m).toFixed(1)),0);r.push(u)}}),r}function YW(){const{selectLyricIndex:t,currentLyric:e}=En(),{eleRefs:n,actuallyEndRef:r,mergedGrowListRef:s,actuallyStartRef:i,wordsRatioRef:o,setGrowList:l,setCut:c,setText:u,currentWords:d}=Ft(),{tempWordRef:m,endTimeRangeRef:p,startTimeRangeRef:g,startRefText:y,endRefText:w}=n;f.useEffect(()=>{if(!m.current)return;const _=vA(m.current);o.current=_},[d]),f.useEffect(()=>{if(!e)return;const _=e.tune.grow,E=e.text.split(" ").filter(S=>S.trim());u(e.text),c(e.cut);const b=Mw(E,e.cut,_);l(_),s.current=b,w.current&&y.current&&g.current&&p.current&&(i.current=e!=null&&e.tune?e.tune.start:e.start,y.current.innerText=`${e.start} / ${i.current}`,g.current.max=e.end+"",g.current.value=i.current+"",r.current=e!=null&&e.tune?e.tune.end:e.end,w.current.innerText=`${r.current} / ${e.end}`,p.current.max=e.end+"",p.current.value=r.current+"")},[t])}function JW({audioEle:t}){const{playerRef:e,isChangedRef:n,tabProps:{tab:r,setTab:s},setGrowList:i,cut:o,actuallyStartRef:l,mergedGrowListRef:c,currentSplitWords:u,currentWords:d}=Ft(),[m,p]=f.useState(!1),[g,y]=f.useState([]),w=f.useRef(Date.now()),_=f.useRef(!1),E=f.useRef(!1),b=()=>{const P=+((Date.now()-w.current)/1e3).toFixed(1);y(A=>[...A,P])},S=()=>{var P;w.current=Date.now(),_.current||(_.current=!0,(P=e.current)==null||P.play(),p(!0))},C=()=>{_.current&&b()},D=P=>{P.key===" "&&(E.current||(P.preventDefault(),E.current=!0,S()))},F=P=>{P.key===" "&&(P.preventDefault(),C(),E.current=!1)},R={onPointerDown:()=>{S()},onPointerUp:()=>{C()}},j=()=>{var P;(P=e.current)==null||P.pause(),_.current=!1,y([]),p(!1)},N=()=>{n.current=!0,i(g);const P=Mw(d,o,g);c.current=P,s("Edit"),j()};return f.useEffect(()=>{g.length===u.length&&N()},[g]),f.useEffect(()=>{var P;if(r==="Record")return(P=e.current)==null||P.pause(),window.addEventListener("keydown",D),window.addEventListener("keyup",F),t.currentTime=l.current,()=>{var A;(A=e.current)==null||A.pause(),window.removeEventListener("keydown",D),window.removeEventListener("keyup",F)}},[r]),{localGrowList:g,buttonProps:R,clear:j,isRecording:m}}function ZW({audioEle:t}){const{currentSplitWords:e}=Ft(),{buttonProps:n,localGrowList:r,isRecording:s,clear:i}=JW({audioEle:t});return a.jsxs(a.Fragment,{children:[a.jsx(ie,{disabled:!s,size:"clear",className:"p-1.5",onClick:i,color:"primary",children:a.jsx(Zs,{className:"w-6"})}),a.jsxs("div",{className:"flex-grow flex flex-col justify-center",children:[a.jsx("div",{className:"md:text-xl font-[700] text-center",children:e.map((o,l)=>a.jsxs("span",{className:`${l<r.length?"text-[#ffed00]":""} leading-[1]`,children:[o," "]},l))}),a.jsx("p",{className:"mt-5 text-center md:hidden",children:a.jsx(ie,{...n,color:"primary",children:"Record"})})]})]})}function eq(){const{currentLyric:t}=En(),{eleRefs:e,isChangedRef:n,actuallyEndRef:r,actuallyStartRef:s,tempActuallyStartRef:i,setGrowList:o}=Ft(),{startRefText:l,endRefText:c}=e;return{setEndPoint:g=>{if(!t)return;const y=+g.toFixed(1);n.current=!0,r.current=y,c.current&&(c.current.textContent=`${y} / ${t.end}`),i.current&&(r.current=y,s.current=y-1)},setStartPoint:g=>{if(!t)return;const y=+g.toFixed(1);n.current=!0,s.current=y,l.current&&(l.current.textContent=`${t.start} / ${y}`)},endTimeRangeProps:{onFocus:()=>{i.current=s.current,s.current=r.current-1},onBlur:()=>{s.current=i.current,i.current=0}},handleGrowWord:g=>{n.current=!0,o(y=>{const w=[...y];let _=w[g.index];switch(g.variant){case"range":_=g.value;break;case"button":_=+(g.action==="minus"?_-.1:_+.1).toFixed(1)}return _<0&&(_=0),w[g.index]=_,w})}}}function tq(){const{setStartPoint:t,setEndPoint:e,endTimeRangeProps:n,handleGrowWord:r}=eq(),{currentLyric:s}=En(),{wordIndex:i,growList:o,eleRefs:l}=Ft();return s?a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center mt-5 space-x-2",children:[a.jsxs("label",{htmlFor:"start",className:"flex-shrink-0 w-[150px]",children:["Start: ",a.jsx("span",{ref:l.startRefText})]}),a.jsx("input",{ref:l.startTimeRangeRef,type:"range",id:"start",min:s.start,max:s.end,step:.2,className:"w-full",onChange:c=>t(+c.target.value)})]}),a.jsxs("div",{className:"flex items-center mt-3 space-x-2",children:[a.jsxs("label",{htmlFor:"end",className:"flex-shrink-0 w-[150px]",children:["End: ",a.jsx("span",{ref:l.endRefText})]}),a.jsx("input",{id:"end",ref:l.endTimeRangeRef,type:"range",min:s.start,step:.2,className:"w-full",onChange:c=>e(+c.target.value),...n})]}),a.jsxs("div",{className:"flex items-center mt-3",children:[a.jsxs("label",{htmlFor:"grow",className:"flex-shrink-0 w-[150px] mr-2 leading-[1]",children:["Grow: ",o[i]]}),a.jsx("input",{ref:l.growInputRef,type:"range",id:"grow",min:0,max:10,step:.1,className:"w-full",value:o[i]+"",onChange:c=>r({variant:"range",value:+c.target.value,index:i})})]})]}):a.jsx(a.Fragment,{})}function nq(){const{eleRefs:t,eventRefs:e,setText:n,mergedGrowListRef:r,setCut:s,setGrowList:i,text:o}=Ft(),[l,c]=f.useState(!1),u=f.useRef(null),d=()=>{if(!u.current)return;const m=u.current.value.split(/\r?\n/).filter(y=>y).map(y=>y.trim()).join(" ").split(" ").filter(y=>y).join(" ");n(m);const p=m.split(" ").map(()=>0),g=m.split(" ").map(()=>[]);s(g),i(p),r.current=p,c(!1)};return f.useEffect(()=>{l?(e.playWhenSpaceRef.current=!1,e.moveArrowToGrowRef.current=!1,u.current&&(u.current.value=o)):(e.playWhenSpaceRef.current=!0,e.moveArrowToGrowRef.current=!0)},[l]),a.jsxs("div",{className:"mt-3 relative pt-5",children:[a.jsx("div",{className:"absolute top-0 right-0 flex justify-end w space-x-2 hover:[&>button]:bg-black/10 [&>button]:rounded-full [&>button]:p-1",children:l?a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>c(!1),children:a.jsx(Zs,{className:"w-5"})}),a.jsx("button",{onClick:d,children:a.jsx(Iu,{className:"w-5"})})]}):a.jsx("button",{onClick:()=>c(!0),children:a.jsx(Js,{className:"w-5"})})}),a.jsx("div",{className:"flex justify-center",children:l?a.jsx("textarea",{ref:u,className:`${cv} w-full mt-3 bg-white/10`}):a.jsx(a.Fragment,{children:a.jsxs("div",{className:"relative whitespace-nowrap  sm:text-2xl font-[700]",children:[o,a.jsx("div",{ref:t.overlayRef,className:"absolute  top-0 left-0 overflow-hidden text-[#ffed00] whitespace-nowrap w-0",children:o})]})})})]})}function rq({text:t,openModal:e,isShowScissor:n,index:r}){const{theme:s}=q(),{growList:i,setWordIndex:o,wordIndex:l,eventRefs:c,eleRefs:u}=Ft(),d=l===r,m=()=>{var p;r!==-1&&(o(r),c.moveArrowToGrowRef.current=!0,(p=u.growInputRef.current)==null||p.focus())};return a.jsxs("div",{ref:p=>d?u.currentWordRef.current=p:{},style:{flexGrow:i[r]!==0?i[r]:.05},onClick:m,className:`word-item cursor-pointer relative rounded-full flex items-center justify-center border ${s.content_border} ${d?s.content_bg:"bg-"+s.alpha}`,children:[a.jsx("span",{children:t}),n&&d&&a.jsx(ie,{onClick:e,size:"clear",className:"!absolute bottom-0 translate-y-[16px] bg-black/10 p-1.5",children:a.jsx(NI,{className:"w-5"})})]})}function sq({wordData:t,wordIndex:e,closeModal:n}){const{theme:r}=q(),{currentLyric:s,selectLyricIndex:i}=En(),{setCut:o,cut:l}=Ft(),[c,u]=f.useState(t.positions),d=f.useMemo(()=>gA(t.text,c).filter(y=>y),[c]),m=f.useMemo(()=>t.text.split(""),[]),p=y=>{const w=[...c],_=c.findIndex(E=>E===y);_===-1?w.push(y):w.splice(_,1),u(w)},g=()=>{if(!s||i===void 0)return;const y=c.sort((_,E)=>_-E),w=[...l];w[e]=y,o(w),n()};return a.jsxs("div",{className:"w-[500px] max-w-[90vw]",children:[a.jsx(Se,{title:"Split word "}),a.jsx("div",{className:"flex justify-center space-x-5",children:d.map((y,w)=>a.jsx("span",{className:"text-xl md:text-2xl font-[700]",children:y},w))}),a.jsx("div",{className:"mt-3 flex justify-center",children:m.map((y,w)=>{const _=c.includes(w);return a.jsxs("div",{children:[m.length>1&&w?a.jsx("button",{onClick:()=>p(w),className:` p-1 rounded-full ${_?r.content_bg:"hover:bg-black/10"}`,children:a.jsx(NI,{className:"w-5"})}):"",a.jsx("span",{className:"text-[50px] font-[500]",children:y})]},w)})}),a.jsx("p",{className:"mt-5 text-right",children:a.jsx(ie,{onClick:g,color:"primary",className:"font-playwireCU",children:"OK"})})]})}function iq(){const{currentSplitWords:t,currentWordsData:e,currentWords:n}=Ft(),[r,s]=f.useState(),i=f.useRef(null),o=f.useMemo(()=>{const u={},d=e.map(p=>p.positions.length);let m=0;return d.forEach((p,g)=>{p===0?(u[m]=g,m++):p>0&&[...Array(p+1).keys()].forEach(()=>{u[m]=g,m++})}),u},[e]),l=f.useMemo(()=>r!==void 0?e[r]:void 0,[r,e]),c=u=>{var d;s(u),(d=i.current)==null||d.open()};return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"flex h-[44px] mt-5",children:t.map((u,d)=>{const m=o[d],p=n[m];return a.jsx(rq,{isShowScissor:p?p.length>1:!1,index:d,openModal:()=>c(m),text:u},d)})}),a.jsx(De,{variant:"animation",ref:i,children:l&&r!==void 0&&a.jsx(sq,{wordIndex:r,closeModal:()=>{var u;return(u=i.current)==null?void 0:u.close()},wordData:l})})]})}function aq(){const{status:t,playerRef:e}=Ft();return a.jsx(ie,{size:"clear",className:"p-1.5",onClick:()=>{var n;return(n=e.current)==null?void 0:n.handlePlayPause()},color:"primary",children:t==="playing"?a.jsx(mm,{className:"w-6"}):a.jsx(Zc,{className:"w-6"})})}function oq(){const{eventRefs:t,tabProps:{tab:e}}=Ft();f.useEffect(()=>{switch(e){case"Edit":t.playWhenSpaceRef.current=!0,t.moveArrowToGrowRef.current=!0;break;case"Record":t.playWhenSpaceRef.current=!1,t.moveArrowToGrowRef.current=!1;break}},[e])}function lq({closeModal:t}){const{song:e}=En(),{eleRefs:n,currentWords:r,tabProps:s}=Ft();XW(),YW(),oq();const i=f.useRef(null);return a.jsx(a.Fragment,{children:a.jsxs(HM,{className:"w-[800px]",children:[a.jsx(jt,{title:"Edit lyric",close:t}),a.jsx("audio",{src:e==null?void 0:e.song_url,ref:i}),a.jsx("div",{ref:n.tempWordRef,className:"absolute inline-block opacity-0",children:r.map((o,l)=>a.jsxs("span",{children:[o,a.jsx("span",{children:" "})]},l))}),i.current&&a.jsx(GW,{audioEle:i.current}),a.jsxs("div",{className:"mt-5",children:[i.current&&a.jsx("div",{className:`${s.tab==="Record"?"block":"hidden"}`,children:a.jsx(ZW,{audioEle:i.current})}),a.jsxs("div",{className:`${s.tab==="Edit"?"block":"hidden"}`,children:[a.jsx(aq,{}),a.jsx(tq,{}),a.jsx(nq,{}),a.jsx(iq,{})]})]}),a.jsx(KW,{closeModal:t})]})})}function cq(t){return a.jsx(HW,{children:a.jsx(lq,{...t})})}function uq({children:t}){const{theme:e}=q(),[n,r]=f.useState(""),s=f.useRef(null),i=f.useRef(null),o=f.useRef(null),{isFetching:l,song:c,isChanged:u,isSubmitting:d}=zW({audioRef:i}),m=()=>{var y,w;(y=s.current)==null||y.pause(),(w=s.current)==null||w.submit()},p=y=>{var w;r(y),(w=o.current)==null||w.open()},g=()=>{var y;return(y=o.current)==null?void 0:y.close()};return a.jsxs(a.Fragment,{children:[a.jsx("audio",{className:"hidden",ref:i,src:c==null?void 0:c.song_url}),l?a.jsx(Wt,{children:a.jsx(He,{className:"w-6 animate-spin"})}):c&&a.jsxs("div",{className:"flex-grow flex flex-col overflow-hidden",children:[t,a.jsx(Se,{title:` Edit lyric - ${c==null?void 0:c.name}`}),a.jsx("div",{className:"mt-3",children:i.current&&a.jsxs(a.Fragment,{children:[a.jsx(DW,{audioEle:i.current,ref:s}),a.jsx(De,{persisted:!0,variant:"animation",ref:o,children:n==="edit-lyric"&&a.jsx(cq,{closeModal:g})})]})}),i.current&&a.jsx(BW,{controlRef:s,audioEle:i.current,openEditModal:()=>{p("edit-lyric")}}),a.jsx(ie,{className:`${e.content_bg} font-playwriteCU self-end md:self-start rounded-full mt-5 `,variant:"primary",disabled:!u,isLoading:d,onClick:m,children:"Save"})]})]})}function wA(){return a.jsx(IW,{children:a.jsx(uq,{})})}function dq(){return a.jsxs("div",{className:"fixed left-[10px] top-[10px] bottom-[10px] right-[10px] flex flex-col md:right-0 md:top-0 md:left-[unset] md:right-[unset] md:relative md:h-full",children:[a.jsx(Cl,{className:"mb-1 self-start"}),a.jsx(wA,{})]})}const hq=["Song","Playlist","Singers","Users"],fq={songs:[],playlists:[],singers:[],users:[]};function mq(){const[t,e]=f.useState(!1),[n,r]=f.useState("Song"),s=FT(),[i,o]=f.useState(fq),l=u=>{o(d=>({...d,...u}))},c=async()=>{try{const u=s[0].get("q");if(!u)return;switch(n){case"Song":{const d=he(wn,Q("is_official","==",!0),Q("name",">=",u),Q("name","<=",u+"")),m=await _n(d);l({songs:m});break}case"Playlist":{const d=he(wr,Q("is_public","==",!0),Q("name",">=",u),Q("name","<=",u+"")),m=await Wr(d);l({playlists:m});break}case"Singers":{const d=he(kf,Q("name",">=",u),Q("name","<=",u+"")),m=await Tf(d);l({singers:m});break}case"Users":{const d=he(aH,Q("display_name",">=",u),Q("display_name","<=",u+"")),m=await gH(d);console.log(m),l({users:m});break}}}catch(u){console.log({message:u})}finally{e(!1)}};return f.useEffect(()=>(c(),()=>{e(!0)}),[s[0].get("q"),n]),f.useEffect(()=>()=>{r("Song")},[s[0].get("q")]),{isFetching:t,setIsFetching:e,tab:n,setTab:r,getResult:c,result:i,tabs:hq}}function pq(){const{isFetching:t,result:e,tab:n,setTab:r,tabs:s}=mq(),{handleSetSong:i}=ni({variant:"search-bar"}),{getRecommend:o}=Dw(),l=d=>{i(d.queue_id,[d]),o(d)},c=()=>{switch(n){case"Song":return yl;case"Playlist":return a.jsx("div",{className:"flex",children:lv})}},u=()=>{switch(n){case"Song":return e.songs.length?a.jsx(ri,{setSong:l,songs:e.songs}):a.jsx(Xe,{className:"mx-auto"});case"Playlist":return e.playlists.length?a.jsx(vl,{loading:!1,playlists:e.playlists}):a.jsx(Xe,{className:"mx-auto"});case"Singers":return e.singers.length?a.jsx("div",{className:"flex flex-row flex-wrap -mx-2 mt-3",children:e.singers.map((d,m)=>a.jsx(Sx,{variant:"singer-item",singer:d},m))}):a.jsx(Xe,{className:"mx-auto"});case"Users":return e.users.length?a.jsx("div",{children:e.users.map(d=>a.jsxs("div",{className:"flex items-start",children:[a.jsx("div",{className:"w-[46px] h-[46px] rounded-full overflow-hidden",children:a.jsx(Ye,{src:d.photo_url})}),a.jsx(we,{to:`/user/${d.email}`,className:"font-semibold mt-3 md:mt-0 md:ml-3",children:d.display_name})]},d.email))}):a.jsx(Xe,{className:"mx-auto"})}};return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"mb-5",children:a.jsx(Cl,{})}),a.jsxs("div",{className:"flex items-center mt-3",children:[a.jsx("div",{className:"text-2xl font-bold",children:"Result"}),a.jsx("div",{className:`ml-5 ${t?"disable":""}`,children:a.jsx(ys,{tabs:s,render:d=>d,tab:n,setTab:r})})]}),a.jsx(ps,{children:a.jsxs("div",{className:"mt-5",children:[t&&c(),!t&&u()]})})]})}function gq(){const{theme:t}=q();return a.jsxs(Wt,{children:[a.jsx("h1",{className:`text-[30px] font-bold ${t.text_color}`,children:"Page Not found"}),a.jsx("p",{className:"text-center",children:a.jsx(we,{to:"/",className:`${t.content_bg} inline-block mt-5 text-center rounded-full px-5 py-1.5 cursor-pointer`,children:"Go home"})})]})}function xq(){const{theme:t}=q(),e=Gt(),n=async()=>{await UC(Wa),e("/login")};return a.jsxs("div",{className:`${t.container} flex flex-col justify-center items-center min-h-screen`,children:[a.jsx("h1",{className:`text-[30px] font-bold border p-[10px] ${t.text_color}`,children:"Unauthorized"}),a.jsx(ie,{onClick:n,variant:"primary",className:`${t.content_bg} font-bold text-[20px]  text-[#fff] rounded-full mt-[20px]`,children:"Exit"})]})}function yq(){const[t]=Av(Wa),{theme:e}=q(),{action:n}=Gm(),r=Gt(),s=async()=>{try{await n("login")}catch(i){console.log(i)}};return f.useEffect(()=>{if(t){r("/");return}},[]),a.jsxs("div",{className:`min-h-screen flex flex-col items-center justify-center ${e.container} ${e.text_color}`,children:[a.jsx(ie,{onClick:s,variant:"default",className:`${e.content_bg} font-bold text-[#fff] text-[30px] rounded-full`,children:"Login with google"})," "]})}function vq(){const[t,e]=f.useState(),[n,r]=f.useState(!0),[s,i]=f.useState([]),[o,l]=f.useState([]),[c,u]=f.useState([]);return{singer:t,setSinger:e,isFetching:n,setIsFetching:r,songs:s,setSongs:i,playlists:o,albums:c,setAlbums:u,setPlaylists:l}}const _A=f.createContext(null);function wq({children:t}){return a.jsx(_A.Provider,{value:vq(),children:t})}function ii(){const t=f.useContext(_A);if(!t)throw new Error("SingerProvider not provided");return t}let _q="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",bq=(t=21)=>{let e="",n=t|0;for(;n--;)e+=_q[Math.random()*64|0];return e};function Sq(){const{setIsFetching:t,setSinger:e,setAlbums:n,isFetching:r,setSongs:s,singer:i,setPlaylists:o}=ii(),{setErrorToast:l}=fe(),c=Xi(),u=f.useRef(!1),d=async()=>{try{if(!c.id)return;const m=await Hr({collectionName:"Singers",id:c.id});if(!m.exists())return;const p={...m.data(),id:c.id},g=he(wn,Q(`singer_map.${p.id}`,"==",!0)),y=await _n(g,{getQueueId:()=>bq(4)+"_"+p.id}),w=he(wr,Q(`singer_map.${p.id}`,"==",!0)),_=await Wr(w),E=[],b=[];_.forEach(S=>S.is_album?b.push(S):E.push(S)),s(y),e(p),o(E),n(b)}catch(m){console.log({error:m}),l()}finally{t(!1)}};return f.useEffect(()=>{u.current||(u.current=!0,d())},[]),{singer:i,isFetching:r}}function kg({onClick:t,children:e}){const{songs:n}=ii();return a.jsx(ie,{onClick:t,disabled:!n.length,size:"clear",color:"primary",className:"p-3",children:e})}function Eq(){const{songs:t,singer:e}=ii(),{playStatus:n}=se(Dn),{currentSongData:r}=se(ze),{handleSetSong:s}=ni({variant:"playlist"}),{handlePlayPause:i}=si(),o=()=>{const l=t[0];s(l.queue_id,t)};if(e&&r!=null&&r.song.queue_id.includes(e.id))switch(n){case"loading":case"paused":return a.jsx(kg,{onClick:i,children:a.jsx(nf,{className:"w-7"})});default:return a.jsx(kg,{onClick:i,children:a.jsx(sv,{className:"w-7"})})}else return a.jsx(kg,{onClick:o,children:a.jsx(nf,{className:"w-7"})})}function kq(){const{user:t,updateUserData:e}=xe(),{setSingers:n}=Pn(),[r,s]=f.useState(!1);return{likeSinger:async({singer:o})=>{try{if(s(!0),!t)return;const l=ro(ke),c=Ct(ke,"Users",t.email),u=Ct(ke,"Singers",o.id),d=[...t.liked_singer_ids],m=d.findIndex(w=>w===o.id),p=m===-1;p?d.unshift(o.id):d.splice(m,1);const g={liked_singer_ids:d},y={like:fu(p?1:-1)};l.update(c,g),l.update(u,y),await l.commit(),n(p?w=>[o,...w]:w=>w.filter(_=>_.id!==o.id)),e(g)}catch(l){console.log({error:l})}finally{s(!1)}},isFetching:r,user:t}}function Tq(){const{theme:t}=q(),{singer:e}=ii(),{likeSinger:n,isFetching:r,user:s}=kq(),i=f.useMemo(()=>s&&e?s.liked_singer_ids.includes(e.id):!1,[s]);return e?a.jsx("button",{onClick:()=>n({singer:e}),className:`rounded-full p-2  ${i?t.content_bg:"bg-"+t.alpha}`,children:r?a.jsx(He,{className:"w-5 animate-spin"}):a.jsx(a.Fragment,{children:i?a.jsx(Cu,{className:"w-5"}):a.jsx(Za,{className:"w-5"})})}):a.jsx(a.Fragment,{})}function Iq(){const{theme:t}=q(),[e,n]=f.useState(""),r=f.useRef(null),{singer:s}=ii(),i=o=>{var l;n(o),(l=r.current)==null||l.open()};return a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>i("more"),className:"text-sm ml-auto !mt-0",children:"See more"}),a.jsx("div",{className:"!mt-auto",children:a.jsxs("div",{className:"space-x-2 flex items-end",children:[a.jsx(Eq,{}),a.jsx(Tq,{}),a.jsxs(pr,{children:[a.jsx(gr,{children:a.jsx("button",{className:`p-2 bg-${t.alpha} hover:brightness-95 rounded-full`,children:a.jsx(gl,{className:"w-5"})})}),a.jsx(xr,{appendTo:"parent",children:a.jsx(ei,{theme:t,p:"clear",className:"py-2",children:a.jsx(Tl,{className:"w-[140px]",children:a.jsx(Ew,{})})})})]})]})}),e&&a.jsx(De,{ref:r,variant:"animation",children:e==="more"&&s&&a.jsx("div",{className:"w-[400px] max-w-[calc(100vw-40px)]",children:s.description})})]})}function Cq(){const{theme:t}=q(),{isFetching:e,singer:n}=ii();return!e&&!n?a.jsx(a.Fragment,{}):a.jsx(a.Fragment,{children:a.jsxs("div",{className:`md:flex bg-transparent relative z-0 pb-5 md:p-10 ${t.text_color} `,children:[a.jsx("div",{className:"absolute overflow-hidden -left-10 -top-[100px] -right-10 inset-0",children:a.jsxs("div",{className:"relative h-full w-full",children:[a.jsx("div",{className:`absolute z-[-5] inset-0 ${t.type==="light"?"bg-white/50":"bg-black/50"}  `}),a.jsx("img",{src:(n==null?void 0:n.image_url)||zI,className:"blur-[50px] absolute z-[-10] w-full h-full object-center object-cover"})]})}),a.jsx("div",{className:"w-[70%] z-0 relative mx-auto md:w-1/4 md:flex-shrink-0 md:m-unset",children:e?a.jsx(le,{className:"pt-[100%] "}):a.jsx(Ru,{children:a.jsx(Ye,{src:n==null?void 0:n.image_url,blurHashEncode:n==null?void 0:n.blurhash_encode})})}),a.jsx("div",{className:"flex-grow z-0 relative flex flex-col mt-5 space-y-2.5  md:mt-0 md:ml-5",children:e?a.jsxs(a.Fragment,{children:[a.jsx(le,{className:"h-[60px] w-full md:w-[200px]"}),a.jsx(le,{className:"h-[24px] w-[200px]"}),a.jsx(le,{className:"h-[120px] w-full md:w-[100%]"})]}):n&&a.jsxs(a.Fragment,{children:[a.jsx("p",{className:"text-3xl leading-[2] font-playwriteCU",children:n.name}),a.jsxs("p",{children:[a.jsx("span",{className:"text-red-500",children:"❤ "}),_r(n.like)]}),a.jsx("p",{className:"line-clamp-2",children:n.description}),a.jsx(Iq,{})]})})]})})}function jq(){const{handleSetSong:t}=ni({variant:"songs"}),{isFetching:e,songs:n}=ii();return a.jsx(a.Fragment,{children:a.jsxs("div",{children:[a.jsx(Se,{title:"Popular Songs"}),a.jsx(ps,{children:e?yl:a.jsx(ri,{songs:n,setSong:r=>t(r.queue_id,[r])})})]})})}function Rq(){const{isFetching:t,playlists:e}=ii();return a.jsx(a.Fragment,{children:a.jsxs("div",{children:[a.jsx(Se,{title:"Popular Playlists"}),a.jsx(vl,{playlists:e,loading:t})]})})}function Aq(){const{albums:t,isFetching:e}=ii();return a.jsxs(a.Fragment,{children:[a.jsx(Se,{title:"Albums"}),a.jsx(vl,{playlists:t,loading:e})]})}function Nq(){const{isFetching:t,singer:e}=Sq();return!t&&!e?a.jsx(Wt,{children:a.jsx(Xe,{variant:"with-home-button"})}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"space-y-5",children:[a.jsx(Cl,{}),a.jsx(Cq,{}),a.jsx(jq,{}),a.jsx(Aq,{}),a.jsx(Rq,{})]}),a.jsx(bu,{})]})}function Pq(){return a.jsx(wq,{children:a.jsx(Nq,{})})}function Fq(){const[t,e]=f.useState(),[n,r]=f.useState([]),[s,i]=f.useState(!0),{setErrorToast:o}=fe(),l=Xi(),c=f.useRef(!1),u=async()=>{try{if(!l.id)return;const d=await Hr({collectionName:"Users",id:l.id});if(!d.exists())return;const m={...d.data()},p=he(wr,Q("owner_email","==",m.email),Q("is_public","==",!0),Q("is_official","==",!1)),g=await Wr(p),y=[],w=[];g.forEach(_=>_.is_album?w.push(_):y.push(_)),r(y),e(m)}catch(d){console.log({error:d}),o()}finally{i(!1)}};return f.useEffect(()=>{c.current||(c.current=!0,u())},[]),{user:t,playlists:n,isFetching:s}}function Dq(){const{playlists:t,isFetching:e,user:n}=Fq();return!e&&!n?a.jsx(Wt,{children:a.jsx(Xe,{variant:"with-home-button"})}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"mb-5",children:a.jsx(Cl,{})}),a.jsxs("div",{className:"space-y-5",children:[a.jsxs("div",{className:"flex flex-col md:flex-row items-center",children:[e?a.jsx(le,{className:"w-[100px] h-[100px] rounded-full"}):n&&a.jsx("div",{className:"w-[100px] h-[100px] rounded-full overflow-hidden",children:a.jsx(Ye,{src:n.photo_url})}),a.jsx("div",{className:"text-center mt-3 md:mt-0 md:ml-3 md:text-left ",children:e?a.jsxs(a.Fragment,{children:[a.jsx(le,{className:"w-[300px] h-[30px]"}),a.jsx(le,{className:"w-[200px] h-[22px] mt-1"})]}):n&&a.jsxs(a.Fragment,{children:[a.jsx("p",{className:"font-semibold text-2xl",children:n.display_name}),a.jsxs("p",{className:"text-[#666]",children:["Last seen: ",oA(n.last_seen)]})]})})]}),a.jsxs("div",{children:[a.jsx(Se,{title:"Playlists"}),a.jsx(vl,{loading:e,playlists:t})]})]}),a.jsx(bu,{})]})}function Lq(){return a.jsx(a.Fragment,{children:a.jsx("div",{className:"",children:a.jsx("p",{children:"This is dashboard page"})})})}const Mq=["All","Result"];function Oq(){const{uploadedSongs:t,setUploadedSongs:e}=Pn(),[n,r]=f.useState(""),[s,i]=f.useState(!0),[o,l]=f.useState("All"),{setErrorToast:c}=fe(),u=async m=>{try{m.preventDefault(),i(!0);const p=vr(ke,"Songs"),g=he(p,Q("name",">=",n),Q("name","<=",n+""),Q("is_official","==",!0)),y=await _n(g);e(y),l("Result")}catch(p){console.log({message:p}),c()}finally{i(!1)}},d=async()=>{try{i(!0);const m=vr(ke,"Songs"),p=he(m,Q("is_official","==",!0),Vr("updated_at","desc")),g=await _n(p);e(g)}catch(m){console.log({message:m}),c()}finally{i(!1)}};return f.useEffect(()=>{o==="All"&&d()},[o]),{isFetching:s,value:n,setValue:r,handleSubmit:u,uploadedSongs:t,tab:o,setTab:l,tabs:Mq}}const y2=ku("inline-flex relative hover:brightness-95 space-x-1 items-center z-0",{variants:{variant:{primary:"before:content-[''] before:absolute before:z-[-1] before:inset-0 active:translate-y-[2px] active:before:shadow-none",clear:"before:content-none"},color:{primary:"before:border-[#4a826f] text-[#fff] bg-[#5a9e87] before:shadow-[0_2px_0_#4a826f]",second:"before:border-[#ccc] text-[#333] bg-[#f6f6f6] before:shadow-[0_2px_0_#ccc]",clear:""},size:{primary:"px-5 py-1.5",clear:""},fontWeight:{primary:"",clear:""},border:{primary:"before:border-[2px]",thin:"before:border-[1px]",clear:"before:border-b-[2px]"},rounded:{xl:"before:rounded-xl rounded-xl",lg:"before:rounded-lg rounded-lg",md:"before:rounded-md rounded-md"}},defaultVariants:{variant:"primary",color:"primary",size:"primary",fontWeight:"primary",border:"primary",rounded:"lg"}});function $q({onClick:t,loading:e,children:n,border:r,size:s,color:i,fontWeight:o,type:l="button",variant:c,disabled:u,rounded:d,className:m,active:p,href:g},y){const w=u||e,_="before:shadow-none translate-y-[2px]";return a.jsx(a.Fragment,{children:g?a.jsx(we,{to:g,className:`${y2({variant:c,size:s,color:i,fontWeight:o,rounded:d,border:r,className:m})} ${p?_:""}`,children:n}):a.jsx("button",{ref:y,type:l||"button",onClick:t,disabled:w,className:`${y2({variant:c,size:s,color:p?"primary":i,border:r,fontWeight:o,className:m})} ${p?_:""}`,children:e?a.jsx(He,{className:"w-6 animate-spin"}):n})})}const ce=f.forwardRef($q),Bq=ku("border-[2px] p-3 border-b-[6px] rounded-[14px]",{variants:{colors:{primary:"bg-white border-[#e1e1e1]",second:"bg-[#cee9b6] border-[#4a826f]",third:"bg-white border-[#4a826f]",clear:""}},defaultVariants:{colors:"primary"}});function yn({children:t,onClick:e,colors:n,className:r=""}){return a.jsx("div",{onClick:()=>e?e():{},className:`${Bq({colors:n,className:r})} `,children:t})}function Ku({className:t=""}){return a.jsx("div",{className:`flex flex-grow items-center justify-center ${t}`,children:a.jsx(He,{className:"w-6 animate-spin"})})}function ai({children:t}){return a.jsx("div",{className:"bg-white  overflow-hidden p-3 rounded-lg",children:t})}function kr({children:t,className:e="w-[400px]"}){return a.jsx("div",{className:`max-h-[80vh] max-w-[90vw] ${e}`,children:t})}function jl({children:t,className:e=""}){const n=`mt-2 ml-2 flex px-3 py-1.5 text-sm rounded-lg bg-[#fff] border-[2px] border-[#e1e1e1] [&>div]:ml-1.5 [&>div]:pl-1.5 [&>div]:border [&>div]:border-transparent [&>div]:flex [&>div]:space-x-1 [&>div]:border-l-black/10 hover:[&_button]:scale-[1.05] ${e}`;return a.jsx("div",{className:n,children:t})}function zq({children:t,...e},n){return a.jsx(De,{variant:"animation",wrapped:!1,...e,ref:n,children:a.jsx(ai,{children:t})})}const Tr=f.forwardRef(zq);function Rl({handleSubmit:t,setValue:e,value:n,className:r="",inputRef:s}){const i=o=>{o.preventDefault(),n.trim()&&t(o)};return a.jsx(yn,{className:r,children:a.jsxs("form",{onSubmit:i,className:"flex gap-2 justify-between items-center",children:[a.jsxs("div",{className:"relative flex-grow flex items-center text-[#333]",children:[a.jsx(Ht,{type:"text",ref:s,value:n,onChange:o=>e(o.target.value),placeholder:"..."}),n&&a.jsx("button",{type:"button",onClick:()=>{e("")},className:"absolute right-3",children:a.jsx(Zs,{className:"w-6"})})]}),a.jsx(ce,{type:"submit",size:"clear",className:"p-2 flex-shrink-0",children:a.jsx(ev,{className:"w-6"})})]})})}function Uq(){const[t,e]=f.useState(),[n,r]=f.useState(),[s,i]=f.useState([]);return{imageFile:n,setImageFile:r,playlist:t,setPlaylist:e,songs:s,setSongs:i,updatePlaylistData:l=>{t&&e({...t,...l})}}}const bA=f.createContext(null);function Vq({children:t}){return a.jsx(bA.Provider,{value:Uq(),children:t})}const Ow=()=>{const t=f.useContext(bA);if(!t)throw new Error("PlaylistProvider not provided");return t};function Km(){const{user:t}=xe(),{playlist:e,songs:n,setSongs:r,updatePlaylistData:s}=Ow(),[i,o]=f.useState(!1),l=Gt(),{setErrorToast:c,setSuccessToast:u}=fe(),d=async(p,g)=>{const y={};p.forEach(_=>y[_.id]=!0);const w={singers:p,singer_map:y};await kt({collectionName:"Playlists",id:g,data:w}),s(w)};return{isFetching:i,action:async p=>{try{if(!t)throw new Error("User not found");if(!e)throw new Error("playlist not found");switch(o(!0),p.variant){case"delete-playlist":{const g=ro(ke),y=Ct(ke,"Playlists",e.id),w=await Er(he(Gu,Q("target_id","==",e.id)));g.delete(y),w.empty||(console.log(`Delete ${w.docs.length} comments`),w.forEach(_=>g.delete(_.ref))),await Promise.all([g.commit(),e.image_file_path?Xn({filePath:e.image_file_path}):()=>{}]),l("/dashboard/playlist");break}case"add-songs":{const g=[...n,...p.songs],w={song_ids:g.map(_=>_.id)};await kt({collectionName:"Playlists",id:e.id,data:w,msg:">>> api: update playlist doc"}),s(w),r(g),u("Songs added");break}case"edit-playlist":{const g={...e,...p.playlist};if(p.imageFile){const y=await na({imageFile:p.imageFile});e.image_file_path&&await Xn({filePath:e.image_file_path}),Object.assign(g,y)}await kt({collectionName:"Playlists",data:g,id:e.id,msg:">>> api: set playlist doc"}),s(g),u("Playlist edited");break}case"remove-song":{const g=n.filter(w=>w.id!==p.song.id),y={song_ids:g.map(w=>w.id)};await kt({collectionName:"Playlists",id:e.id,data:y,msg:">>> api: update playlist doc"}),r(g),u(`'${p.song.name}' removed`);break}case"update-image":{const g={image_url:p.song.image_url,blurhash_encode:p.song.blurhash_encode,image_file_path:""};e.image_file_path&&await Xn({filePath:e.image_file_path}),await kt({collectionName:"Playlists",data:g,id:e.id,msg:">>> api: set playlist doc"}),s(g),u("Playlist edited;");break}case"remove-singer":{const g=e.singers.filter(y=>y.id!==p.singer.id);d(g,e.id),u("Singer removed");break}case"add-singer":{const g=[...e.singers];if(g.find(w=>w.id===p.singer.id))return;g.push(p.singer),d(g,e.id),u("Singer added");break}}}catch(g){console.log({message:g}),c("")}finally{o(!1)}},playlist:e}}function Hq({song:t}){const{action:e,isFetching:n,playlist:r}=Km(),{close:s}=Sr(),i=f.useRef(null),o={overlay:"absolute flex items-center justify-center inset-0 bg-black/40"},l=()=>{var u;(u=i.current)==null||u.open(),s()},c=async u=>{var d;switch(u.variant){case"remove-song":await e({variant:"remove-song",song:u.song});break;case"update-image":await e({variant:"update-image",song:u.song});break;case"add-singer":await e({variant:"add-singer",singer:u.singer}),(d=i.current)==null||d.close()}s()};return a.jsxs(a.Fragment,{children:[a.jsxs(SA,{song:t,children:[a.jsxs("button",{onClick:()=>c({variant:"remove-song",song:t}),children:[a.jsx(Fn,{className:"w-5"}),a.jsx("span",{children:"Remove"})]}),a.jsxs("button",{onClick:l,children:[a.jsx(br,{className:"w-5"}),a.jsx("span",{children:"Add singer to playlist"})]}),t.image_url&&a.jsxs("button",{className:`${(r==null?void 0:r.image_url)===t.image_url?"disable":""}`,onClick:()=>c({variant:"update-image",song:t}),children:[a.jsx(xl,{className:"w-5"}),a.jsx("span",{children:"Set playlist image"})]}),n&&a.jsx("div",{className:o.overlay,children:a.jsx("div",{className:"h-[25px] w-[25px] border-[2px] border-r-black rounded-[50%] animate-spin"})})]}),a.jsx(Tr,{ref:i,children:a.jsxs(kr,{children:[a.jsx(Se,{title:"Singers"}),a.jsx("div",{className:"space-x-2 mt-3 [&>*]:px-3 [&>*]:py-1 [&>*]:rounded-md  [&>*]:bg-[#f1f1f1] hover:[&>*]:bg-black/10",children:t.singers.map((u,d)=>a.jsx("button",{onClick:()=>c({variant:"add-singer",singer:u}),children:u.name},d))})]})})]})}function Wq(){const{setUploadedSongs:t,uploadedSongs:e}=Pn(),[n,r]=f.useState(!1),{setSuccessToast:s,setErrorToast:i}=fe();return{actions:async l=>{try{r(!0);const c=ro(ke),u=Ct(ke,"Songs",l.song.id),d=await Er(he(Gu,Q("target_id","==",l.song.id)));switch(l.variant){case"delete":{const m=e.filter(p=>p.id!==l.song.id);if(c.delete(u),l.song.lyric_id){const p=Ct(ke,"Lyrics",l.song.lyric_id);c.delete(p)}d.empty||(console.log(`Delete ${d.docs.length} comments`),d.forEach(p=>c.delete(p.ref))),await Promise.all([c.commit(),qR(l.song)]),t(m),s(`'${l.song.name}' deleted`);break}}}catch(c){console.log({message:c}),i()}finally{r(!1)}},isFetching:n}}function qq({song:t}){const{close:e}=Sr(),{actions:n,isFetching:r}=Wq(),[s,i]=f.useState(""),o=f.useRef(null),l=()=>{var m;return(m=o.current)==null?void 0:m.close()},c=m=>{var p;i(m),e(),(p=o.current)==null||p.open()},u=async m=>{switch(m.variant){case"delete":await n({variant:"delete",song:t})}l()},d=()=>{switch(s){case"":return a.jsx(a.Fragment,{});case"edit":case"delete":return a.jsx(xs,{loading:r,label:`Delete '${t.name}' ?`,desc:"This action cannot be undone",callback:()=>u({variant:"delete",song:t}),close:l})}};return a.jsxs(a.Fragment,{children:[a.jsxs(SA,{song:t,children:[a.jsxs(we,{to:`/dashboard/song/${t.id}/edit`,children:[a.jsx(Tu,{className:"w-5"}),a.jsx("span",{children:"Edit"})]}),a.jsxs(we,{to:`/dashboard/lyric/${t.id}`,children:[a.jsx(Jy,{className:"w-5"}),a.jsx("span",{children:"Lyric"})]}),a.jsxs("button",{onClick:()=>c("delete"),children:[a.jsx(Fn,{className:"w-5"}),a.jsx("span",{children:"Delete"})]})]}),a.jsx(De,{ref:o,variant:"animation",children:d()})]})}function Gq({song:t}){return a.jsx("div",{className:"px-2 mb-3",children:a.jsxs("div",{className:"p-3 bg-white/10 rounded-md flex",children:[a.jsx("div",{className:"w-[60px] h-[60px] flex-shrink-0 rounded overflow-hidden",children:a.jsx(Ye,{className:"object-cover h-full",src:t.image_url})}),a.jsxs("div",{className:"ml-2 text-sm",children:[a.jsx("h5",{className:"line-clamp-1 font-[500]",children:t.name}),a.jsx("h5",{className:"line-clamp-1 text-sm opacity-[.7]",children:t.singers.map((e,n)=>(n?", ":"")+e.name)})]})]})})}function SA({song:t,children:e}){const{theme:n}=q();return a.jsx(a.Fragment,{children:a.jsx(xr,{className:"w-[260px]",appendTo:"portal",children:a.jsxs(ei,{p:"clear",className:"py-2",theme:n,children:[a.jsx(Gq,{song:t}),a.jsx(Tl,{className:"hover:[&>*:not(div.absolute)]:bg-black/5",children:e}),a.jsxs("p",{className:"text-sm text-center opacity-70 mt-3",children:["Provided by ",t.distributor]})]})})})}function Qq({song:t,variant:e}){const n=()=>{switch(e){case"songs":return a.jsx(qq,{song:t});case"playlist":return a.jsx(Hq,{song:t})}};return a.jsx(a.Fragment,{children:a.jsxs(pr,{appendOnPortal:!0,children:[a.jsx(gr,{children:a.jsx(ce,{size:"clear",color:"second",className:"p-1",children:a.jsx(gl,{className:"w-5"})})}),n()]})})}function EA({song:t,className:e="",variant:n}){return a.jsxs("tr",{className:e,children:[a.jsx("td",{children:a.jsx(we,{to:`/dashboard/song/${t.id}/edit`,className:"hover:underline",children:t.name})}),a.jsx("td",{children:t.singers.map((r,s)=>a.jsxs(we,{className:"hover:underline",to:`/dashboard/singer/${r.id}`,children:[!!s&&", ",r.name]},s))}),a.jsx("td",{children:_r(t.like)}),a.jsx("td",{children:a.jsx(Qq,{variant:n,song:t})})]})}function kA({value:t,setValue:e,inputRef:n}){return a.jsxs(yn,{className:"flex gap-2 justify-between items-center",children:[a.jsx(Ht,{ref:n,value:t,onChange:r=>e(r.target.value),placeholder:"..."}),a.jsx(ce,{onClick:()=>t?e(""):{},size:"clear",className:"p-2 flex-shrink-0",children:t?a.jsx(Zs,{className:"w-6"}):a.jsx(ev,{className:"w-6"})})]})}function ra({className:t="",children:e,...n}){return a.jsx(yn,{children:a.jsx("div",{className:"rounded-md overflow-hidden",children:a.jsx(UI,{className:`[&_td]:text-sm hover:[&_tr]:bg-black/5 [&_tbody_tr]:border-t [&_tr]:border-black/5 [&_th]:text-sm [&_th]:text-left [&_td]:p-2 [&_th]:p-2 ${t}`,...n,children:e})})})}function Kq(){const{isFetching:t,uploadedSongs:e,tabs:n,setTab:r,tab:s,...i}=Oq();return a.jsxs("div",{className:"pb-[46px]",children:[a.jsx(Se,{title:"Songs"}),a.jsxs("div",{className:"flex justify-between items-start mt-3",children:[a.jsx(Rl,{...i}),a.jsxs(ce,{href:"/dashboard/song/add-song",className:"p-1.5 ml-5",size:"clear",children:[a.jsx(gs,{className:"w-6"}),a.jsx("div",{className:"hidden md:block",children:"Add song"})]})]}),a.jsx("div",{className:`mt-5 w-fit ${s==="All"?"pointer-events-none":""} self-start`,children:a.jsx(ys,{tabs:n,render:o=>o,tab:s,setTab:r})}),a.jsxs("div",{className:"mt-3",children:[t&&a.jsx(le,{className:"h-[200px] rounded-xl"}),!t&&a.jsx(ra,{colList:["Name","Singer","Like"],children:e.length?e.map((o,l)=>a.jsx(EA,{variant:"songs",song:o},l)):a.jsx("tr",{children:a.jsx("td",{colSpan:3,className:"text-center",children:a.jsx(Xe,{})})})})]})]})}function Xq(){const[t,e]=f.useState(),[n,r]=f.useState(),[s,i]=f.useState([]),[o,l]=f.useState([]),[c,u]=f.useState(),[d,m]=f.useState(),[p,g]=f.useState(),y=f.useRef("add");return{imageFile:c,setImageFile:u,songFile:t,setSongFile:e,songData:n,song:d,setSong:m,variant:y,setSongData:r,updateSongData:S=>{n&&r({...n,...S})},singers:s,setSingers:i,setGenres:l,genres:o,selectGenre:S=>{const C=[...o],D=C.findIndex(F=>F.id===S.id);D===-1?C.push(S):C.splice(D,1),l(C)},selectSinger:S=>{const C=[...s],D=C.findIndex(F=>F.id===S.id);D===-1?C.push(S):C.splice(D,1),i(C)},imageBlob:p,setImageBlob:g,resetAddSongContext:S=>{e(void 0),r(S),i([]),l([])}}}const TA=f.createContext(null);function Yq({children:t}){return a.jsx(TA.Provider,{value:Xq(),children:t})}const so=()=>{const t=f.useContext(TA);if(!t)throw new Error("AddSongProvider not provided");return t};function IA(){const{setSongFile:t}=so(),e=f.useRef(null),n=r=>{var s;(s=r.target.files)!=null&&s.length&&t(r.target.files[0])};return a.jsxs(a.Fragment,{children:[a.jsx("input",{ref:e,onChange:n,type:"file",multiple:!0,accept:"audio",id:"song_upload",className:"hidden"}),a.jsx(ce,{className:"",size:"clear",children:a.jsx("label",{htmlFor:"song_upload",className:"inline-flex p-1.5 cursor-pointer",children:a.jsx(qy,{className:"w-6"})})})]})}function Jq(){const[t,e]=f.useState([]),n=f.useRef(!0);return{genres:t,shouldFetchGenre:n,setGenres:e}}const CA=f.createContext(null);function Zq({children:t}){return a.jsx(CA.Provider,{value:Jq(),children:t})}const $w=()=>{const t=f.useContext(CA);if(!t)throw new Error("GenreProvider is not provided");return t};function jA(){const{setGenres:t,genres:e}=$w(),{setErrorToast:n,setSuccessToast:r}=fe(),[s,i]=f.useState(!1);return{isFetching:s,action:async l=>{try{switch(i(!0),l.type){case"add":{if(e.find(m=>m.name===l.name))return await Us(100),n("Genre already exist");const u=await Ks({collectionName:"Genres",data:{name:l.name}}),d={name:l.name,id:u.id};return t(m=>[d,...m]),i(!1),r("Add genre successful"),d}case"edit":{await kt({collectionName:"Genres",data:{name:l.name},id:l.id});const c=[...e],u=c.findIndex(m=>m.id===l.id),d={...e[u]};Object.assign(d,{name:l.name}),c[u]=d,t(c),r("Edit genre successful");break}case"delete":{await Iw({collectionName:"Genres",id:l.id}),t(c=>c.filter(u=>u.id!==l.id)),r("Delete genre successful");break}}}catch{}finally{i(!1)}}}}function RA(){const{genres:t,setGenres:e,shouldFetchGenre:n}=$w(),[r,s]=f.useState(!0);return{api:async()=>{try{if(n.current){n.current=!1;const o=vr(ke,"Genres"),l=he(o);console.log(">>> fetch genres");const c=await Er(l);if(c.docs){const u=c.docs.map(d=>({...d.data(),id:d.id}));e(u)}}else await Us(100)}catch(o){console.log(o)}finally{s(!1)}},isFetching:r,setIsFetching:s,genres:t,shouldFetchGenre:n}}function AA(){const{genres:t}=$w(),[e,n]=f.useState(""),r=WR(e,800),s=f.useMemo(()=>r?t.filter(i=>i.name.includes(r)):t,[r,t]);return{value:e,setValue:n,_genres:s}}function eG({afterSearched:t=()=>{}}){const[e,n]=f.useState(""),[r,s]=f.useState(!1),[i,o]=f.useState(!1),[l,c]=f.useState([]),{setErrorToast:u}=fe();return{value:e,isShowResult:i,setValue:n,result:l,handleSubmit:async m=>{try{m.preventDefault(),m.stopPropagation(),s(!0),o(!0);const p=vr(ke,"Singers"),g=he(p,Q("name",">=",e),Q("name","<=",e+"")),y=await Er(g);if(y.docs){const w=y.docs.map(_=>({..._.data(),id:_.id}));c(w),t()}}catch(p){console.log({message:p}),u()}finally{s(!1)}},isFetching:r}}function tG(){const{setSuccessToast:t,setErrorToast:e}=fe(),[n,r]=f.useState(!1);return{isFetching:n,addSinger:async({data:i})=>{try{r(!0);const o=await Ks({collectionName:"Singers",data:i}),c={...(await Va(o)).data(),id:o.id};return r(!1),t("Add singer successful"),c}catch(o){console.log({error:o}),e()}finally{r(!1)}}}}function nG({closeModal:t,afterSubmit:e,singerName:n}){const[r,s]=f.useState(If({name:n})),{addSinger:i,isFetching:o}=tG(),l=r.name,c=(m,p)=>{s({...r,[m]:p.trim()})},u=async()=>{const m=await i({data:r});m&&e&&e(m),t()},d={inputGroup:"gap-1",input:"p-2 bg-[#f1f1f1] border border-black/20 rounded-lg",label:"text-[#3f3f3f] text-lg"};return a.jsxs(ai,{className:"w-[450px]",children:[a.jsx(jt,{close:t,title:"Add singer"}),a.jsx("div",{className:"space-y-3 overflow-auto",children:a.jsxs("div",{className:d.inputGroup,children:[a.jsx("label",{className:d.label,children:"Customer name:"}),a.jsx(Ht,{value:r.name,onChange:m=>c("name",m.target.value),placeholder:"Enter name...",className:d.input})]})}),a.jsx("div",{className:"text-center mt-5",children:a.jsxs(ce,{disabled:!l,loading:o,onClick:()=>l&&u(),children:[a.jsx(Iu,{className:"w-6"}),a.jsx("p",{className:"text-white",children:"Ok"})]})})]})}function Bw({choose:t,closeModal:e}){const{result:n,isShowResult:r,isFetching:s,...i}=eG({}),o=f.useRef(null),l=()=>{var c;return(c=o.current)==null?void 0:c.close()};return a.jsxs(a.Fragment,{children:[a.jsxs(kr,{children:[a.jsx(jt,{title:"Singers",close:e}),a.jsx(Rl,{...i}),a.jsx("div",{className:"h-[40vh] mt-3 space-y-1.5 overflow-auto",children:r&&(s?a.jsx(Ku,{className:"h-full"}):a.jsx(a.Fragment,{children:n.length?n.map((c,u)=>a.jsx(yn,{onClick:()=>t(c),children:a.jsx("p",{className:"text-lg",children:c.name})},u)):a.jsx(a.Fragment,{children:a.jsx(Xe,{})})}))}),a.jsx("p",{className:"text-center mt-auto",children:a.jsxs(ce,{onClick:()=>{var c;return(c=o.current)==null?void 0:c.open()},children:[a.jsx(gs,{className:"w-6"}),a.jsx("span",{children:"Add new singer"})]})})]}),a.jsx(De,{ref:o,wrapped:!1,variant:"animation",children:a.jsx(nG,{afterSubmit:t,singerName:i.value,closeModal:l})})]})}function rG(){const{singers:t,selectSinger:e}=so(),n=f.useRef(null),r=()=>{var i;return(i=n.current)==null?void 0:i.close()},s=i=>{e(i),r()};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"",children:[a.jsxs("div",{className:"flex space-x-2 items-center",children:[a.jsx(Se,{title:"Singer"}),a.jsx(ce,{onClick:()=>{var i;return(i=n.current)==null?void 0:i.open()},className:"p-1.5",size:"clear",children:a.jsx(gs,{className:"w-6"})})]}),a.jsx(yn,{className:" mt-1",children:a.jsx("div",{className:"flex flex-wrap -ml-2 -mt-2",children:t.length?t.map((i,o)=>a.jsxs(jl,{children:[a.jsx("span",{children:i.name}),a.jsx("div",{className:"flex",children:a.jsx("button",{onClick:()=>e(i),children:a.jsx(Fn,{className:"w-5"})})})]},o)):"..."})})]}),a.jsx(Tr,{ref:n,children:a.jsx(Bw,{closeModal:r,choose:s})})]})}function sG({audioEle:t,variant:e}){const n=f.useRef(null),{status:r,handlePlayPause:s}=kw({audioEle:t,baseColor:"rgba(0,0,0,.10)",color:"#5a9e87",progressLineRef:n}),i=()=>{switch(r){case"error":return a.jsx(hm,{className:"w-6"});case"playing":return a.jsx(mm,{className:"w-6"});case"paused":return a.jsx(Zc,{className:"w-6"});case"waiting":return a.jsx(He,{className:"w-6 animate-spin"})}};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-end justify-between",children:[a.jsx(ce,{className:"p-1.5",size:"clear",onClick:s,children:i()}),e==="add"&&a.jsx(IA,{})]}),a.jsx("div",{style:{backgroundColor:"rgab(0,0,0,.05)"},ref:n,className:"h-1 rounded-full mt-3 w-full"})]})}function zw({closeModal:t,afterSubmit:e,...n}){const[r,s]=f.useState(n.type==="add"?n.genreName||"":n.genre.name),{action:i,isFetching:o}=jA(),{setErrorToast:l}=fe(),c=f.useRef(null),u=!!r,d=async()=>{try{switch(n.type){case"add":const g=await i({type:"add",name:r});g&&e&&e(g);break;case"edit":await i({type:"edit",name:r,id:n.genre.id});break}}catch(g){console.log(g),l()}finally{t()}},m={inputGroup:"gap-1",input:"p-2 bg-[#f1f1f1] border border-black/20 rounded-lg",label:"text-[#3f3f3f] text-lg"};f.useEffect(()=>{var g;(g=c.current)==null||g.focus()},[]);const p=n.type==="edit"?`Edit '${n.genre.name}'`:"Add genre";return a.jsxs(ai,{className:"w-[450px]",children:[a.jsx(jt,{close:t,title:p}),a.jsx("div",{className:"space-y-3 overflow-auto",children:a.jsxs("div",{className:m.inputGroup,children:[a.jsx("label",{className:m.label,children:"Genre name:"}),a.jsx(Ht,{ref:c,value:r,onChange:g=>s(g.target.value),placeholder:"Enter name...",className:m.input})]})}),a.jsx("div",{className:"text-center mt-5",children:a.jsxs(ce,{disabled:!u,loading:o,onClick:()=>u&&d(),children:[a.jsx(Iu,{className:"w-6"}),a.jsx("p",{className:"text-white",children:"Ok"})]})})]})}function iG({closeModal:t,choose:e}){const{_genres:n,...r}=AA(),s=f.useRef(null),i=f.useRef(null),o=()=>{var u;return(u=s.current)==null?void 0:u.close()},{api:l,isFetching:c}=RA();return f.useEffect(()=>{var u;l(),(u=i.current)==null||u.focus()},[]),a.jsxs(a.Fragment,{children:[a.jsxs(kr,{children:[a.jsx(jt,{title:"Genre",close:t}),a.jsx(kA,{inputRef:i,...r}),a.jsx("div",{className:"h-[40vh] mt-3 space-y-1.5 overflow-auto",children:c?a.jsx(Ku,{className:"h-full"}):a.jsx(a.Fragment,{children:n.length?n.map((u,d)=>a.jsx(yn,{onClick:()=>e(u),children:a.jsx("p",{className:"text-lg",children:u.name})},d)):a.jsx(a.Fragment,{children:a.jsx(Xe,{})})})}),a.jsx("p",{className:"text-center mt-auto",children:a.jsxs(ce,{onClick:()=>{var u;return(u=s.current)==null?void 0:u.open()},children:[a.jsx(br,{className:"w-6"}),a.jsx("span",{children:"Add new genre"})]})})]}),a.jsx(De,{ref:s,wrapped:!1,variant:"animation",children:a.jsx(zw,{afterSubmit:e,genreName:r.value,type:"add",closeModal:o})})]})}function aG(){const{genres:t,selectGenre:e}=so(),n=f.useRef(null),r=i=>{e(i),s()},s=()=>{var i;return(i=n.current)==null?void 0:i.close()};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"",children:[a.jsxs("div",{className:"flex space-x-2 items-center",children:[a.jsx(Se,{title:"Genre"}),a.jsx(ce,{onClick:()=>{var i;return(i=n.current)==null?void 0:i.open()},className:"p-1.5",size:"clear",children:a.jsx(gs,{className:"w-6"})})]}),a.jsx(yn,{className:"mt-1",children:a.jsx("div",{className:"flex flex-wrap -ml-2 -mt-2",children:t.length?t.map((i,o)=>a.jsxs(jl,{children:[a.jsx("span",{children:i.name}),a.jsx("div",{children:a.jsx("button",{onClick:()=>e(i),children:a.jsx(Fn,{className:"w-5"})})})]},o)):"..."})})]}),a.jsx(Tr,{ref:n,children:a.jsx(iG,{closeModal:s,choose:r})})]})}const oG="End-Of-Stream";class pt extends Error{constructor(){super(oG)}}class lG{constructor(){this.maxStreamReadSize=1*1024*1024,this.endOfStream=!1,this.peekQueue=[]}async peek(e,n,r){const s=await this.read(e,n,r);return this.peekQueue.push(e.subarray(n,n+s)),s}async read(e,n,r){if(r===0)return 0;let s=this.readFromPeekBuffer(e,n,r);if(s+=await this.readRemainderFromStream(e,n+s,r-s),s===0)throw new pt;return s}readFromPeekBuffer(e,n,r){let s=r,i=0;for(;this.peekQueue.length>0&&s>0;){const o=this.peekQueue.pop();if(!o)throw new Error("peekData should be defined");const l=Math.min(o.length,s);e.set(o.subarray(0,l),n+i),i+=l,s-=l,l<o.length&&this.peekQueue.push(o.subarray(l))}return i}async readRemainderFromStream(e,n,r){let s=r,i=0;for(;s>0&&!this.endOfStream;){const o=Math.min(s,this.maxStreamReadSize),l=await this.readFromStream(e,n+i,o);if(l===0)break;i+=l,s-=l}return i}}class cG extends lG{constructor(e){super(),this.reader=e.getReader({mode:"byob"})}async readFromStream(e,n,r){if(this.endOfStream)throw new pt;const s=await this.reader.read(new Uint8Array(r));return s.done&&(this.endOfStream=s.done),s.value?(e.set(s.value,n),s.value.byteLength):0}}class NA{constructor(e){this.position=0,this.numBuffer=new Uint8Array(8),this.fileInfo=(e==null?void 0:e.fileInfo)??{},this.onClose=e==null?void 0:e.onClose}async readToken(e,n=this.position){const r=new Uint8Array(e.len);if(await this.readBuffer(r,{position:n})<e.len)throw new pt;return e.get(r,0)}async peekToken(e,n=this.position){const r=new Uint8Array(e.len);if(await this.peekBuffer(r,{position:n})<e.len)throw new pt;return e.get(r,0)}async readNumber(e){if(await this.readBuffer(this.numBuffer,{length:e.len})<e.len)throw new pt;return e.get(this.numBuffer,0)}async peekNumber(e){if(await this.peekBuffer(this.numBuffer,{length:e.len})<e.len)throw new pt;return e.get(this.numBuffer,0)}async ignore(e){if(this.fileInfo.size!==void 0){const n=this.fileInfo.size-this.position;if(e>n)return this.position+=n,n}return this.position+=e,e}async close(){var e;await((e=this.onClose)==null?void 0:e.call(this))}normalizeOptions(e,n){if(n&&n.position!==void 0&&n.position<this.position)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");return n?{mayBeLess:n.mayBeLess===!0,offset:n.offset?n.offset:0,length:n.length?n.length:e.length-(n.offset?n.offset:0),position:n.position?n.position:this.position}:{mayBeLess:!1,offset:0,length:e.length,position:this.position}}}const uG=256e3;class dG extends NA{constructor(e,n){super(n),this.streamReader=e}async readBuffer(e,n){const r=this.normalizeOptions(e,n),s=r.position-this.position;if(s>0)return await this.ignore(s),this.readBuffer(e,n);if(s<0)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");if(r.length===0)return 0;const i=await this.streamReader.read(e,r.offset,r.length);if(this.position+=i,(!n||!n.mayBeLess)&&i<r.length)throw new pt;return i}async peekBuffer(e,n){const r=this.normalizeOptions(e,n);let s=0;if(r.position){const i=r.position-this.position;if(i>0){const o=new Uint8Array(r.length+i);return s=await this.peekBuffer(o,{mayBeLess:r.mayBeLess}),e.set(o.subarray(i),r.offset),s-i}if(i<0)throw new Error("Cannot peek from a negative offset in a stream")}if(r.length>0){try{s=await this.streamReader.peek(e,r.offset,r.length)}catch(i){if(n!=null&&n.mayBeLess&&i instanceof pt)return 0;throw i}if(!r.mayBeLess&&s<r.length)throw new pt}return s}async ignore(e){const n=Math.min(uG,e),r=new Uint8Array(n);let s=0;for(;s<e;){const i=e-s,o=await this.readBuffer(r,{length:Math.min(n,i)});if(o<0)return o;s+=o}return s}}class hG extends NA{constructor(e,n){super(n),this.uint8Array=e,this.fileInfo.size=this.fileInfo.size?this.fileInfo.size:e.length}async readBuffer(e,n){if(n!=null&&n.position){if(n.position<this.position)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");this.position=n.position}const r=await this.peekBuffer(e,n);return this.position+=r,r}async peekBuffer(e,n){const r=this.normalizeOptions(e,n),s=Math.min(this.uint8Array.length-r.position,r.length);if(!r.mayBeLess&&s<r.length)throw new pt;return e.set(this.uint8Array.subarray(r.position,r.position+s),r.offset),s}close(){return super.close()}}function PA(t,e){return new dG(new cG(t),e)}function ol(t,e){return new hG(t,e)}/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */var Xm=function(t,e,n,r,s){var i,o,l=s*8-r-1,c=(1<<l)-1,u=c>>1,d=-7,m=n?s-1:0,p=n?-1:1,g=t[e+m];for(m+=p,i=g&(1<<-d)-1,g>>=-d,d+=l;d>0;i=i*256+t[e+m],m+=p,d-=8);for(o=i&(1<<-d)-1,i>>=-d,d+=r;d>0;o=o*256+t[e+m],m+=p,d-=8);if(i===0)i=1-u;else{if(i===c)return o?NaN:(g?-1:1)*(1/0);o=o+Math.pow(2,r),i=i-u}return(g?-1:1)*o*Math.pow(2,i-r)},Ym=function(t,e,n,r,s,i){var o,l,c,u=i*8-s-1,d=(1<<u)-1,m=d>>1,p=s===23?Math.pow(2,-24)-Math.pow(2,-77):0,g=r?0:i-1,y=r?1:-1,w=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(l=isNaN(e)?1:0,o=d):(o=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-o))<1&&(o--,c*=2),o+m>=1?e+=p/c:e+=p*Math.pow(2,1-m),e*c>=2&&(o++,c/=2),o+m>=d?(l=0,o=d):o+m>=1?(l=(e*c-1)*Math.pow(2,s),o=o+m):(l=e*Math.pow(2,m-1)*Math.pow(2,s),o=0));s>=8;t[n+g]=l&255,g+=y,l/=256,s-=8);for(o=o<<s|l,u+=s;u>0;t[n+g]=o&255,g+=y,o/=256,u-=8);t[n+g-y]|=w*128};function ge(t){return new DataView(t.buffer,t.byteOffset)}const ve={len:1,get(t,e){return ge(t).getUint8(e)},put(t,e,n){return ge(t).setUint8(e,n),e+1}},Le={len:2,get(t,e){return ge(t).getUint16(e,!0)},put(t,e,n){return ge(t).setUint16(e,n,!0),e+2}},$e={len:2,get(t,e){return ge(t).getUint16(e)},put(t,e,n){return ge(t).setUint16(e,n),e+2}},Cf={len:3,get(t,e){const n=ge(t);return n.getUint8(e)+(n.getUint16(e+1,!0)<<8)},put(t,e,n){const r=ge(t);return r.setUint8(e,n&255),r.setUint16(e+1,n>>8,!0),e+3}},vn={len:3,get(t,e){const n=ge(t);return(n.getUint16(e)<<8)+n.getUint8(e+2)},put(t,e,n){const r=ge(t);return r.setUint16(e,n>>8),r.setUint8(e+2,n&255),e+3}},J={len:4,get(t,e){return ge(t).getUint32(e,!0)},put(t,e,n){return ge(t).setUint32(e,n,!0),e+4}},re={len:4,get(t,e){return ge(t).getUint32(e)},put(t,e,n){return ge(t).setUint32(e,n),e+4}},mu={len:1,get(t,e){return ge(t).getInt8(e)},put(t,e,n){return ge(t).setInt8(e,n),e+1}},Ps={len:2,get(t,e){return ge(t).getInt16(e)},put(t,e,n){return ge(t).setInt16(e,n),e+2}},fG={len:2,get(t,e){return ge(t).getInt16(e,!0)},put(t,e,n){return ge(t).setInt16(e,n,!0),e+2}},mG={len:3,get(t,e){const n=Cf.get(t,e);return n>8388607?n-16777216:n},put(t,e,n){const r=ge(t);return r.setUint8(e,n&255),r.setUint16(e+1,n>>8,!0),e+3}},Uw={len:3,get(t,e){const n=vn.get(t,e);return n>8388607?n-16777216:n},put(t,e,n){const r=ge(t);return r.setUint16(e,n>>8),r.setUint8(e+2,n&255),e+3}},Yn={len:4,get(t,e){return ge(t).getInt32(e)},put(t,e,n){return ge(t).setInt32(e,n),e+4}},ht={len:4,get(t,e){return ge(t).getInt32(e,!0)},put(t,e,n){return ge(t).setInt32(e,n,!0),e+4}},fn={len:8,get(t,e){return ge(t).getBigUint64(e,!0)},put(t,e,n){return ge(t).setBigUint64(e,n,!0),e+8}},jf={len:8,get(t,e){return ge(t).getBigInt64(e,!0)},put(t,e,n){return ge(t).setBigInt64(e,n,!0),e+8}},Vw={len:8,get(t,e){return ge(t).getBigUint64(e)},put(t,e,n){return ge(t).setBigUint64(e,n),e+8}},FA={len:8,get(t,e){return ge(t).getBigInt64(e)},put(t,e,n){return ge(t).setBigInt64(e,n),e+8}},pG={len:2,get(t,e){return Xm(t,e,!1,10,this.len)},put(t,e,n){return Ym(t,n,e,!1,10,this.len),e+this.len}},gG={len:2,get(t,e){return Xm(t,e,!0,10,this.len)},put(t,e,n){return Ym(t,n,e,!0,10,this.len),e+this.len}},DA={len:4,get(t,e){return ge(t).getFloat32(e)},put(t,e,n){return ge(t).setFloat32(e,n),e+4}},xG={len:4,get(t,e){return ge(t).getFloat32(e,!0)},put(t,e,n){return ge(t).setFloat32(e,n,!0),e+4}},Ix={len:8,get(t,e){return ge(t).getFloat64(e)},put(t,e,n){return ge(t).setFloat64(e,n),e+8}},yG={len:8,get(t,e){return ge(t).getFloat64(e,!0)},put(t,e,n){return ge(t).setFloat64(e,n,!0),e+8}},vG={len:10,get(t,e){return Xm(t,e,!1,63,this.len)},put(t,e,n){return Ym(t,n,e,!1,63,this.len),e+this.len}},wG={len:10,get(t,e){return Xm(t,e,!0,63,this.len)},put(t,e,n){return Ym(t,n,e,!0,63,this.len),e+this.len}};class _G{constructor(e){this.len=e}get(e,n){}}class kn{constructor(e){this.len=e}get(e,n){return e.subarray(n,n+this.len)}}class ne{constructor(e,n){this.len=e,this.encoding=n,this.textDecoder=new TextDecoder(n)}get(e,n){return this.textDecoder.decode(e.subarray(n,n+this.len))}}class bG{constructor(e){this.len=e,this.textDecoder=new TextDecoder("windows-1252")}get(e,n=0){return this.textDecoder.decode(e.subarray(n,n+this.len))}}const SG=Object.freeze(Object.defineProperty({__proto__:null,AnsiStringType:bG,Float16_BE:pG,Float16_LE:gG,Float32_BE:DA,Float32_LE:xG,Float64_BE:Ix,Float64_LE:yG,Float80_BE:vG,Float80_LE:wG,INT16_BE:Ps,INT16_LE:fG,INT24_BE:Uw,INT24_LE:mG,INT32_BE:Yn,INT32_LE:ht,INT64_BE:FA,INT64_LE:jf,INT8:mu,IgnoreType:_G,StringType:ne,UINT16_BE:$e,UINT16_LE:Le,UINT24_BE:vn,UINT24_LE:Cf,UINT32_BE:re,UINT32_LE:J,UINT64_BE:Vw,UINT64_LE:fn,UINT8:ve,Uint8ArrayType:kn},Symbol.toStringTag,{value:"Module"})),EG=Object.prototype.toString,kG="[object Uint8Array]",TG="[object ArrayBuffer]";function LA(t,e,n){return t?t.constructor===e?!0:EG.call(t)===n:!1}function MA(t){return LA(t,Uint8Array,kG)}function IG(t){return LA(t,ArrayBuffer,TG)}function CG(t){return MA(t)||IG(t)}function jG(t){if(!MA(t))throw new TypeError(`Expected \`Uint8Array\`, got \`${typeof t}\``)}function RG(t){if(!CG(t))throw new TypeError(`Expected \`Uint8Array\` or \`ArrayBuffer\`, got \`${typeof t}\``)}const Ud={utf8:new globalThis.TextDecoder("utf8")};function Hw(t,e="utf8"){return RG(t),Ud[e]??(Ud[e]=new globalThis.TextDecoder(e)),Ud[e].decode(t)}function OA(t){if(typeof t!="string")throw new TypeError(`Expected \`string\`, got \`${typeof t}\``)}const AG=new globalThis.TextEncoder;function NG(t){return OA(t),AG.encode(t)}const PG=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Ww(t){jG(t);let e="";for(let n=0;n<t.length;n++)e+=PG[t[n]];return e}const v2={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,a:10,b:11,c:12,d:13,e:14,f:15,A:10,B:11,C:12,D:13,E:14,F:15};function w2(t){if(OA(t),t.length%2!==0)throw new Error("Invalid Hex string length.");const e=t.length/2,n=new Uint8Array(e);for(let r=0;r<e;r++){const s=v2[t[r*2]],i=v2[t[r*2+1]];if(s===void 0||i===void 0)throw new Error(`Invalid Hex character encountered at position ${r*2}`);n[r]=s<<4|i}return n}function _2(t){const{byteLength:e}=t;if(e===6)return t.getUint16(0)*2**32+t.getUint32(2);if(e===5)return t.getUint8(0)*2**32+t.getUint32(1);if(e===4)return t.getUint32(0);if(e===3)return t.getUint8(0)*2**16+t.getUint16(1);if(e===2)return t.getUint16(0);if(e===1)return t.getUint8(0)}function $A(t,e){const n=t.length,r=e.length;if(r===0||r>n)return-1;const s=n-r;for(let i=0;i<=s;i++){let o=!0;for(let l=0;l<r;l++)if(t[i+l]!==e[l]){o=!1;break}if(o)return i}return-1}function FG(t,e){return $A(t,e)!==-1}function DG(t){return[...t].map(e=>e.charCodeAt(0))}function LG(t,e=0){const n=Number.parseInt(new ne(6).get(t,148).replace(/\0.*$/,"").trim(),8);if(Number.isNaN(n))return!1;let r=8*32;for(let s=e;s<e+148;s++)r+=t[s];for(let s=e+156;s<e+512;s++)r+=t[s];return n===r}const MG={get:(t,e)=>t[e+3]&127|t[e+2]<<7|t[e+1]<<14|t[e]<<21,len:4},OG=["jpg","png","apng","gif","webp","flif","xcf","cr2","cr3","orf","arw","dng","nef","rw2","raf","tif","bmp","icns","jxr","psd","indd","zip","tar","rar","gz","bz2","7z","dmg","mp4","mid","mkv","webm","mov","avi","mpg","mp2","mp3","m4a","oga","ogg","ogv","opus","flac","wav","spx","amr","pdf","epub","elf","macho","exe","swf","rtf","wasm","woff","woff2","eot","ttf","otf","ico","flv","ps","xz","sqlite","nes","crx","xpi","cab","deb","ar","rpm","Z","lz","cfb","mxf","mts","blend","bpg","docx","pptx","xlsx","3gp","3g2","j2c","jp2","jpm","jpx","mj2","aif","qcp","odt","ods","odp","xml","mobi","heic","cur","ktx","ape","wv","dcm","ics","glb","pcap","dsf","lnk","alias","voc","ac3","m4v","m4p","m4b","f4v","f4p","f4b","f4a","mie","asf","ogm","ogx","mpc","arrow","shp","aac","mp1","it","s3m","xm","ai","skp","avif","eps","lzh","pgp","asar","stl","chm","3mf","zst","jxl","vcf","jls","pst","dwg","parquet","class","arj","cpio","ace","avro","icc","fbx","vsdx"],$G=["image/jpeg","image/png","image/gif","image/webp","image/flif","image/x-xcf","image/x-canon-cr2","image/x-canon-cr3","image/tiff","image/bmp","image/vnd.ms-photo","image/vnd.adobe.photoshop","application/x-indesign","application/epub+zip","application/x-xpinstall","application/vnd.oasis.opendocument.text","application/vnd.oasis.opendocument.spreadsheet","application/vnd.oasis.opendocument.presentation","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/zip","application/x-tar","application/x-rar-compressed","application/gzip","application/x-bzip2","application/x-7z-compressed","application/x-apple-diskimage","application/x-apache-arrow","video/mp4","audio/midi","video/x-matroska","video/webm","video/quicktime","video/vnd.avi","audio/wav","audio/qcelp","audio/x-ms-asf","video/x-ms-asf","application/vnd.ms-asf","video/mpeg","video/3gpp","audio/mpeg","audio/mp4","audio/opus","video/ogg","audio/ogg","application/ogg","audio/x-flac","audio/ape","audio/wavpack","audio/amr","application/pdf","application/x-elf","application/x-mach-binary","application/x-msdownload","application/x-shockwave-flash","application/rtf","application/wasm","font/woff","font/woff2","application/vnd.ms-fontobject","font/ttf","font/otf","image/x-icon","video/x-flv","application/postscript","application/eps","application/x-xz","application/x-sqlite3","application/x-nintendo-nes-rom","application/x-google-chrome-extension","application/vnd.ms-cab-compressed","application/x-deb","application/x-unix-archive","application/x-rpm","application/x-compress","application/x-lzip","application/x-cfb","application/x-mie","application/mxf","video/mp2t","application/x-blender","image/bpg","image/j2c","image/jp2","image/jpx","image/jpm","image/mj2","audio/aiff","application/xml","application/x-mobipocket-ebook","image/heif","image/heif-sequence","image/heic","image/heic-sequence","image/icns","image/ktx","application/dicom","audio/x-musepack","text/calendar","text/vcard","model/gltf-binary","application/vnd.tcpdump.pcap","audio/x-dsf","application/x.ms.shortcut","application/x.apple.alias","audio/x-voc","audio/vnd.dolby.dd-raw","audio/x-m4a","image/apng","image/x-olympus-orf","image/x-sony-arw","image/x-adobe-dng","image/x-nikon-nef","image/x-panasonic-rw2","image/x-fujifilm-raf","video/x-m4v","video/3gpp2","application/x-esri-shape","audio/aac","audio/x-it","audio/x-s3m","audio/x-xm","video/MP1S","video/MP2P","application/vnd.sketchup.skp","image/avif","application/x-lzh-compressed","application/pgp-encrypted","application/x-asar","model/stl","application/vnd.ms-htmlhelp","model/3mf","image/jxl","application/zstd","image/jls","application/vnd.ms-outlook","image/vnd.dwg","application/x-parquet","application/java-vm","application/x-arj","application/x-cpio","application/x-ace-compressed","application/avro","application/vnd.iccprofile","application/x.autodesk.fbx","application/vnd.visio"],b2=4100;async function BA(t){return new BG().fromBuffer(t)}function Xr(t,e,n){n={offset:0,...n};for(const[r,s]of e.entries())if(n.mask){if(s!==(n.mask[r]&t[r+n.offset]))return!1}else if(s!==t[r+n.offset])return!1;return!0}class BG{constructor(e){this.detectors=e==null?void 0:e.customDetectors,this.fromTokenizer=this.fromTokenizer.bind(this),this.fromBuffer=this.fromBuffer.bind(this),this.parse=this.parse.bind(this)}async fromTokenizer(e){const n=e.position;for(const r of this.detectors||[]){const s=await r(e);if(s)return s;if(n!==e.position)return}return this.parse(e)}async fromBuffer(e){if(!(e instanceof Uint8Array||e instanceof ArrayBuffer))throw new TypeError(`Expected the \`input\` argument to be of type \`Uint8Array\` or \`ArrayBuffer\`, got \`${typeof e}\``);const n=e instanceof Uint8Array?e:new Uint8Array(e);if((n==null?void 0:n.length)>1)return this.fromTokenizer(ol(n))}async fromBlob(e){return this.fromStream(e.stream())}async fromStream(e){const n=await PA(e);try{return await this.fromTokenizer(n)}finally{await n.close()}}async toDetectionStream(e,n){const{sampleSize:r=b2}=n;let s,i;const o=e.getReader({mode:"byob"});try{const{value:u,done:d}=await o.read(new Uint8Array(r));if(i=u,!d&&u)try{s=await this.fromBuffer(u.slice(0,r))}catch(m){if(!(m instanceof pt))throw m;s=void 0}i=u}finally{o.releaseLock()}const l=new TransformStream({async start(u){u.enqueue(i)},transform(u,d){d.enqueue(u)}}),c=e.pipeThrough(l);return c.fileType=s,c}check(e,n){return Xr(this.buffer,e,n)}checkString(e,n){return this.check(DG(e),n)}async parse(e){if(this.buffer=new Uint8Array(b2),e.fileInfo.size===void 0&&(e.fileInfo.size=Number.MAX_SAFE_INTEGER),this.tokenizer=e,await e.peekBuffer(this.buffer,{length:12,mayBeLess:!0}),this.check([66,77]))return{ext:"bmp",mime:"image/bmp"};if(this.check([11,119]))return{ext:"ac3",mime:"audio/vnd.dolby.dd-raw"};if(this.check([120,1]))return{ext:"dmg",mime:"application/x-apple-diskimage"};if(this.check([77,90]))return{ext:"exe",mime:"application/x-msdownload"};if(this.check([37,33]))return await e.peekBuffer(this.buffer,{length:24,mayBeLess:!0}),this.checkString("PS-Adobe-",{offset:2})&&this.checkString(" EPSF-",{offset:14})?{ext:"eps",mime:"application/eps"}:{ext:"ps",mime:"application/postscript"};if(this.check([31,160])||this.check([31,157]))return{ext:"Z",mime:"application/x-compress"};if(this.check([199,113]))return{ext:"cpio",mime:"application/x-cpio"};if(this.check([96,234]))return{ext:"arj",mime:"application/x-arj"};if(this.check([239,187,191]))return this.tokenizer.ignore(3),this.parse(e);if(this.check([71,73,70]))return{ext:"gif",mime:"image/gif"};if(this.check([73,73,188]))return{ext:"jxr",mime:"image/vnd.ms-photo"};if(this.check([31,139,8]))return{ext:"gz",mime:"application/gzip"};if(this.check([66,90,104]))return{ext:"bz2",mime:"application/x-bzip2"};if(this.checkString("ID3")){await e.ignore(6);const n=await e.readToken(MG);return e.position+n>e.fileInfo.size?{ext:"mp3",mime:"audio/mpeg"}:(await e.ignore(n),this.fromTokenizer(e))}if(this.checkString("MP+"))return{ext:"mpc",mime:"audio/x-musepack"};if((this.buffer[0]===67||this.buffer[0]===70)&&this.check([87,83],{offset:1}))return{ext:"swf",mime:"application/x-shockwave-flash"};if(this.check([255,216,255]))return this.check([247],{offset:3})?{ext:"jls",mime:"image/jls"}:{ext:"jpg",mime:"image/jpeg"};if(this.check([79,98,106,1]))return{ext:"avro",mime:"application/avro"};if(this.checkString("FLIF"))return{ext:"flif",mime:"image/flif"};if(this.checkString("8BPS"))return{ext:"psd",mime:"image/vnd.adobe.photoshop"};if(this.checkString("WEBP",{offset:8}))return{ext:"webp",mime:"image/webp"};if(this.checkString("MPCK"))return{ext:"mpc",mime:"audio/x-musepack"};if(this.checkString("FORM"))return{ext:"aif",mime:"audio/aiff"};if(this.checkString("icns",{offset:0}))return{ext:"icns",mime:"image/icns"};if(this.check([80,75,3,4])){try{for(;e.position+30<e.fileInfo.size;){await e.readBuffer(this.buffer,{length:30});const n=new DataView(this.buffer.buffer),r={compressedSize:n.getUint32(18,!0),uncompressedSize:n.getUint32(22,!0),filenameLength:n.getUint16(26,!0),extraFieldLength:n.getUint16(28,!0)};if(r.filename=await e.readToken(new ne(r.filenameLength,"utf-8")),await e.ignore(r.extraFieldLength),r.filename==="META-INF/mozilla.rsa")return{ext:"xpi",mime:"application/x-xpinstall"};if(r.filename.endsWith(".rels")||r.filename.endsWith(".xml"))switch(r.filename.split("/")[0]){case"_rels":break;case"word":return{ext:"docx",mime:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"};case"ppt":return{ext:"pptx",mime:"application/vnd.openxmlformats-officedocument.presentationml.presentation"};case"xl":return{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"};case"visio":return{ext:"vsdx",mime:"application/vnd.visio"};default:break}if(r.filename.startsWith("xl/"))return{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"};if(r.filename.startsWith("3D/")&&r.filename.endsWith(".model"))return{ext:"3mf",mime:"model/3mf"};if(r.filename==="mimetype"&&r.compressedSize===r.uncompressedSize){let s=await e.readToken(new ne(r.compressedSize,"utf-8"));switch(s=s.trim(),s){case"application/epub+zip":return{ext:"epub",mime:"application/epub+zip"};case"application/vnd.oasis.opendocument.text":return{ext:"odt",mime:"application/vnd.oasis.opendocument.text"};case"application/vnd.oasis.opendocument.spreadsheet":return{ext:"ods",mime:"application/vnd.oasis.opendocument.spreadsheet"};case"application/vnd.oasis.opendocument.presentation":return{ext:"odp",mime:"application/vnd.oasis.opendocument.presentation"};default:}}if(r.compressedSize===0){let s=-1;for(;s<0&&e.position<e.fileInfo.size;)await e.peekBuffer(this.buffer,{mayBeLess:!0}),s=$A(this.buffer,new Uint8Array([80,75,3,4])),await e.ignore(s>=0?s:this.buffer.length)}else await e.ignore(r.compressedSize)}}catch(n){if(!(n instanceof pt))throw n}return{ext:"zip",mime:"application/zip"}}if(this.checkString("OggS")){await e.ignore(28);const n=new Uint8Array(8);return await e.readBuffer(n),Xr(n,[79,112,117,115,72,101,97,100])?{ext:"opus",mime:"audio/opus"}:Xr(n,[128,116,104,101,111,114,97])?{ext:"ogv",mime:"video/ogg"}:Xr(n,[1,118,105,100,101,111,0])?{ext:"ogm",mime:"video/ogg"}:Xr(n,[127,70,76,65,67])?{ext:"oga",mime:"audio/ogg"}:Xr(n,[83,112,101,101,120,32,32])?{ext:"spx",mime:"audio/ogg"}:Xr(n,[1,118,111,114,98,105,115])?{ext:"ogg",mime:"audio/ogg"}:{ext:"ogx",mime:"application/ogg"}}if(this.check([80,75])&&(this.buffer[2]===3||this.buffer[2]===5||this.buffer[2]===7)&&(this.buffer[3]===4||this.buffer[3]===6||this.buffer[3]===8))return{ext:"zip",mime:"application/zip"};if(this.checkString("ftyp",{offset:4})&&this.buffer[8]&96){const n=new ne(4,"latin1").get(this.buffer,8).replace("\0"," ").trim();switch(n){case"avif":case"avis":return{ext:"avif",mime:"image/avif"};case"mif1":return{ext:"heic",mime:"image/heif"};case"msf1":return{ext:"heic",mime:"image/heif-sequence"};case"heic":case"heix":return{ext:"heic",mime:"image/heic"};case"hevc":case"hevx":return{ext:"heic",mime:"image/heic-sequence"};case"qt":return{ext:"mov",mime:"video/quicktime"};case"M4V":case"M4VH":case"M4VP":return{ext:"m4v",mime:"video/x-m4v"};case"M4P":return{ext:"m4p",mime:"video/mp4"};case"M4B":return{ext:"m4b",mime:"audio/mp4"};case"M4A":return{ext:"m4a",mime:"audio/x-m4a"};case"F4V":return{ext:"f4v",mime:"video/mp4"};case"F4P":return{ext:"f4p",mime:"video/mp4"};case"F4A":return{ext:"f4a",mime:"audio/mp4"};case"F4B":return{ext:"f4b",mime:"audio/mp4"};case"crx":return{ext:"cr3",mime:"image/x-canon-cr3"};default:return n.startsWith("3g")?n.startsWith("3g2")?{ext:"3g2",mime:"video/3gpp2"}:{ext:"3gp",mime:"video/3gpp"}:{ext:"mp4",mime:"video/mp4"}}}if(this.checkString("MThd"))return{ext:"mid",mime:"audio/midi"};if(this.checkString("wOFF")&&(this.check([0,1,0,0],{offset:4})||this.checkString("OTTO",{offset:4})))return{ext:"woff",mime:"font/woff"};if(this.checkString("wOF2")&&(this.check([0,1,0,0],{offset:4})||this.checkString("OTTO",{offset:4})))return{ext:"woff2",mime:"font/woff2"};if(this.check([212,195,178,161])||this.check([161,178,195,212]))return{ext:"pcap",mime:"application/vnd.tcpdump.pcap"};if(this.checkString("DSD "))return{ext:"dsf",mime:"audio/x-dsf"};if(this.checkString("LZIP"))return{ext:"lz",mime:"application/x-lzip"};if(this.checkString("fLaC"))return{ext:"flac",mime:"audio/x-flac"};if(this.check([66,80,71,251]))return{ext:"bpg",mime:"image/bpg"};if(this.checkString("wvpk"))return{ext:"wv",mime:"audio/wavpack"};if(this.checkString("%PDF")){try{await e.ignore(1350);const n=10*1024*1024,r=new Uint8Array(Math.min(n,e.fileInfo.size));if(await e.readBuffer(r,{mayBeLess:!0}),FG(r,new TextEncoder().encode("AIPrivateData")))return{ext:"ai",mime:"application/postscript"}}catch(n){if(!(n instanceof pt))throw n}return{ext:"pdf",mime:"application/pdf"}}if(this.check([0,97,115,109]))return{ext:"wasm",mime:"application/wasm"};if(this.check([73,73])){const n=await this.readTiffHeader(!1);if(n)return n}if(this.check([77,77])){const n=await this.readTiffHeader(!0);if(n)return n}if(this.checkString("MAC "))return{ext:"ape",mime:"audio/ape"};if(this.check([26,69,223,163])){async function n(){const l=await e.peekNumber(ve);let c=128,u=0;for(;!(l&c)&&c!==0;)++u,c>>=1;const d=new Uint8Array(u+1);return await e.readBuffer(d),d}async function r(){const l=await n(),c=await n();c[0]^=128>>c.length-1;const u=Math.min(6,c.length),d=new DataView(l.buffer),m=new DataView(c.buffer,c.length-u,u);return{id:_2(d),len:_2(m)}}async function s(l){for(;l>0;){const c=await r();if(c.id===17026)return(await e.readToken(new ne(c.len))).replaceAll(/\00.*$/g,"");await e.ignore(c.len),--l}}const i=await r();switch(await s(i.len)){case"webm":return{ext:"webm",mime:"video/webm"};case"matroska":return{ext:"mkv",mime:"video/x-matroska"};default:return}}if(this.check([82,73,70,70])){if(this.check([65,86,73],{offset:8}))return{ext:"avi",mime:"video/vnd.avi"};if(this.check([87,65,86,69],{offset:8}))return{ext:"wav",mime:"audio/wav"};if(this.check([81,76,67,77],{offset:8}))return{ext:"qcp",mime:"audio/qcelp"}}if(this.checkString("SQLi"))return{ext:"sqlite",mime:"application/x-sqlite3"};if(this.check([78,69,83,26]))return{ext:"nes",mime:"application/x-nintendo-nes-rom"};if(this.checkString("Cr24"))return{ext:"crx",mime:"application/x-google-chrome-extension"};if(this.checkString("MSCF")||this.checkString("ISc("))return{ext:"cab",mime:"application/vnd.ms-cab-compressed"};if(this.check([237,171,238,219]))return{ext:"rpm",mime:"application/x-rpm"};if(this.check([197,208,211,198]))return{ext:"eps",mime:"application/eps"};if(this.check([40,181,47,253]))return{ext:"zst",mime:"application/zstd"};if(this.check([127,69,76,70]))return{ext:"elf",mime:"application/x-elf"};if(this.check([33,66,68,78]))return{ext:"pst",mime:"application/vnd.ms-outlook"};if(this.checkString("PAR1"))return{ext:"parquet",mime:"application/x-parquet"};if(this.check([207,250,237,254]))return{ext:"macho",mime:"application/x-mach-binary"};if(this.check([79,84,84,79,0]))return{ext:"otf",mime:"font/otf"};if(this.checkString("#!AMR"))return{ext:"amr",mime:"audio/amr"};if(this.checkString("{\\rtf"))return{ext:"rtf",mime:"application/rtf"};if(this.check([70,76,86,1]))return{ext:"flv",mime:"video/x-flv"};if(this.checkString("IMPM"))return{ext:"it",mime:"audio/x-it"};if(this.checkString("-lh0-",{offset:2})||this.checkString("-lh1-",{offset:2})||this.checkString("-lh2-",{offset:2})||this.checkString("-lh3-",{offset:2})||this.checkString("-lh4-",{offset:2})||this.checkString("-lh5-",{offset:2})||this.checkString("-lh6-",{offset:2})||this.checkString("-lh7-",{offset:2})||this.checkString("-lzs-",{offset:2})||this.checkString("-lz4-",{offset:2})||this.checkString("-lz5-",{offset:2})||this.checkString("-lhd-",{offset:2}))return{ext:"lzh",mime:"application/x-lzh-compressed"};if(this.check([0,0,1,186])){if(this.check([33],{offset:4,mask:[241]}))return{ext:"mpg",mime:"video/MP1S"};if(this.check([68],{offset:4,mask:[196]}))return{ext:"mpg",mime:"video/MP2P"}}if(this.checkString("ITSF"))return{ext:"chm",mime:"application/vnd.ms-htmlhelp"};if(this.check([202,254,186,190]))return{ext:"class",mime:"application/java-vm"};if(this.check([253,55,122,88,90,0]))return{ext:"xz",mime:"application/x-xz"};if(this.checkString("<?xml "))return{ext:"xml",mime:"application/xml"};if(this.check([55,122,188,175,39,28]))return{ext:"7z",mime:"application/x-7z-compressed"};if(this.check([82,97,114,33,26,7])&&(this.buffer[6]===0||this.buffer[6]===1))return{ext:"rar",mime:"application/x-rar-compressed"};if(this.checkString("solid "))return{ext:"stl",mime:"model/stl"};if(this.checkString("AC")){const n=new ne(4,"latin1").get(this.buffer,2);if(n.match("^d*")&&n>=1e3&&n<=1050)return{ext:"dwg",mime:"image/vnd.dwg"}}if(this.checkString("070707"))return{ext:"cpio",mime:"application/x-cpio"};if(this.checkString("BLENDER"))return{ext:"blend",mime:"application/x-blender"};if(this.checkString("!<arch>"))return await e.ignore(8),await e.readToken(new ne(13,"ascii"))==="debian-binary"?{ext:"deb",mime:"application/x-deb"}:{ext:"ar",mime:"application/x-unix-archive"};if(this.checkString("**ACE",{offset:7})&&(await e.peekBuffer(this.buffer,{length:14,mayBeLess:!0}),this.checkString("**",{offset:12})))return{ext:"ace",mime:"application/x-ace-compressed"};if(this.check([137,80,78,71,13,10,26,10])){await e.ignore(8);async function n(){return{length:await e.readToken(Yn),type:await e.readToken(new ne(4,"latin1"))}}do{const r=await n();if(r.length<0)return;switch(r.type){case"IDAT":return{ext:"png",mime:"image/png"};case"acTL":return{ext:"apng",mime:"image/apng"};default:await e.ignore(r.length+4)}}while(e.position+8<e.fileInfo.size);return{ext:"png",mime:"image/png"}}if(this.check([65,82,82,79,87,49,0,0]))return{ext:"arrow",mime:"application/x-apache-arrow"};if(this.check([103,108,84,70,2,0,0,0]))return{ext:"glb",mime:"model/gltf-binary"};if(this.check([102,114,101,101],{offset:4})||this.check([109,100,97,116],{offset:4})||this.check([109,111,111,118],{offset:4})||this.check([119,105,100,101],{offset:4}))return{ext:"mov",mime:"video/quicktime"};if(this.check([73,73,82,79,8,0,0,0,24]))return{ext:"orf",mime:"image/x-olympus-orf"};if(this.checkString("gimp xcf "))return{ext:"xcf",mime:"image/x-xcf"};if(this.check([73,73,85,0,24,0,0,0,136,231,116,216]))return{ext:"rw2",mime:"image/x-panasonic-rw2"};if(this.check([48,38,178,117,142,102,207,17,166,217])){async function n(){const r=new Uint8Array(16);return await e.readBuffer(r),{id:r,size:Number(await e.readToken(fn))}}for(await e.ignore(30);e.position+24<e.fileInfo.size;){const r=await n();let s=r.size-24;if(Xr(r.id,[145,7,220,183,183,169,207,17,142,230,0,192,12,32,83,101])){const i=new Uint8Array(16);if(s-=await e.readBuffer(i),Xr(i,[64,158,105,248,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"audio/x-ms-asf"};if(Xr(i,[192,239,25,188,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"video/x-ms-asf"};break}await e.ignore(s)}return{ext:"asf",mime:"application/vnd.ms-asf"}}if(this.check([171,75,84,88,32,49,49,187,13,10,26,10]))return{ext:"ktx",mime:"image/ktx"};if((this.check([126,16,4])||this.check([126,24,4]))&&this.check([48,77,73,69],{offset:4}))return{ext:"mie",mime:"application/x-mie"};if(this.check([39,10,0,0,0,0,0,0,0,0,0,0],{offset:2}))return{ext:"shp",mime:"application/x-esri-shape"};if(this.check([255,79,255,81]))return{ext:"j2c",mime:"image/j2c"};if(this.check([0,0,0,12,106,80,32,32,13,10,135,10]))switch(await e.ignore(20),await e.readToken(new ne(4,"ascii"))){case"jp2 ":return{ext:"jp2",mime:"image/jp2"};case"jpx ":return{ext:"jpx",mime:"image/jpx"};case"jpm ":return{ext:"jpm",mime:"image/jpm"};case"mjp2":return{ext:"mj2",mime:"image/mj2"};default:return}if(this.check([255,10])||this.check([0,0,0,12,74,88,76,32,13,10,135,10]))return{ext:"jxl",mime:"image/jxl"};if(this.check([254,255]))return this.check([0,60,0,63,0,120,0,109,0,108],{offset:2})?{ext:"xml",mime:"application/xml"}:void 0;if(this.check([0,0,1,186])||this.check([0,0,1,179]))return{ext:"mpg",mime:"video/mpeg"};if(this.check([0,1,0,0,0]))return{ext:"ttf",mime:"font/ttf"};if(this.check([0,0,1,0]))return{ext:"ico",mime:"image/x-icon"};if(this.check([0,0,2,0]))return{ext:"cur",mime:"image/x-icon"};if(this.check([208,207,17,224,161,177,26,225]))return{ext:"cfb",mime:"application/x-cfb"};if(await e.peekBuffer(this.buffer,{length:Math.min(256,e.fileInfo.size),mayBeLess:!0}),this.check([97,99,115,112],{offset:36}))return{ext:"icc",mime:"application/vnd.iccprofile"};if(this.checkString("BEGIN:")){if(this.checkString("VCARD",{offset:6}))return{ext:"vcf",mime:"text/vcard"};if(this.checkString("VCALENDAR",{offset:6}))return{ext:"ics",mime:"text/calendar"}}if(this.checkString("FUJIFILMCCD-RAW"))return{ext:"raf",mime:"image/x-fujifilm-raf"};if(this.checkString("Extended Module:"))return{ext:"xm",mime:"audio/x-xm"};if(this.checkString("Creative Voice File"))return{ext:"voc",mime:"audio/x-voc"};if(this.check([4,0,0,0])&&this.buffer.length>=16){const n=new DataView(this.buffer.buffer).getUint32(12,!0);if(n>12&&this.buffer.length>=n+16)try{const r=new TextDecoder().decode(this.buffer.slice(16,n+16));if(JSON.parse(r).files)return{ext:"asar",mime:"application/x-asar"}}catch{}}if(this.check([6,14,43,52,2,5,1,1,13,1,2,1,1,2]))return{ext:"mxf",mime:"application/mxf"};if(this.checkString("SCRM",{offset:44}))return{ext:"s3m",mime:"audio/x-s3m"};if(this.check([71])&&this.check([71],{offset:188}))return{ext:"mts",mime:"video/mp2t"};if(this.check([71],{offset:4})&&this.check([71],{offset:196}))return{ext:"mts",mime:"video/mp2t"};if(this.check([66,79,79,75,77,79,66,73],{offset:60}))return{ext:"mobi",mime:"application/x-mobipocket-ebook"};if(this.check([68,73,67,77],{offset:128}))return{ext:"dcm",mime:"application/dicom"};if(this.check([76,0,0,0,1,20,2,0,0,0,0,0,192,0,0,0,0,0,0,70]))return{ext:"lnk",mime:"application/x.ms.shortcut"};if(this.check([98,111,111,107,0,0,0,0,109,97,114,107,0,0,0,0]))return{ext:"alias",mime:"application/x.apple.alias"};if(this.checkString("Kaydara FBX Binary  \0"))return{ext:"fbx",mime:"application/x.autodesk.fbx"};if(this.check([76,80],{offset:34})&&(this.check([0,0,1],{offset:8})||this.check([1,0,2],{offset:8})||this.check([2,0,2],{offset:8})))return{ext:"eot",mime:"application/vnd.ms-fontobject"};if(this.check([6,6,237,245,216,29,70,229,189,49,239,231,254,116,183,29]))return{ext:"indd",mime:"application/x-indesign"};if(await e.peekBuffer(this.buffer,{length:Math.min(512,e.fileInfo.size),mayBeLess:!0}),LG(this.buffer))return{ext:"tar",mime:"application/x-tar"};if(this.check([255,254]))return this.check([60,0,63,0,120,0,109,0,108,0],{offset:2})?{ext:"xml",mime:"application/xml"}:this.check([255,14,83,0,107,0,101,0,116,0,99,0,104,0,85,0,112,0,32,0,77,0,111,0,100,0,101,0,108,0],{offset:2})?{ext:"skp",mime:"application/vnd.sketchup.skp"}:void 0;if(this.checkString("-----BEGIN PGP MESSAGE-----"))return{ext:"pgp",mime:"application/pgp-encrypted"};if(this.buffer.length>=2&&this.check([255,224],{offset:0,mask:[255,224]})){if(this.check([16],{offset:1,mask:[22]}))return this.check([8],{offset:1,mask:[8]})?{ext:"aac",mime:"audio/aac"}:{ext:"aac",mime:"audio/aac"};if(this.check([2],{offset:1,mask:[6]}))return{ext:"mp3",mime:"audio/mpeg"};if(this.check([4],{offset:1,mask:[6]}))return{ext:"mp2",mime:"audio/mpeg"};if(this.check([6],{offset:1,mask:[6]}))return{ext:"mp1",mime:"audio/mpeg"}}}async readTiffTag(e){const n=await this.tokenizer.readToken(e?$e:Le);switch(this.tokenizer.ignore(10),n){case 50341:return{ext:"arw",mime:"image/x-sony-arw"};case 50706:return{ext:"dng",mime:"image/x-adobe-dng"}}}async readTiffIFD(e){const n=await this.tokenizer.readToken(e?$e:Le);for(let r=0;r<n;++r){const s=await this.readTiffTag(e);if(s)return s}}async readTiffHeader(e){const n=(e?$e:Le).get(this.buffer,2),r=(e?re:J).get(this.buffer,4);if(n===42){if(r>=6){if(this.checkString("CR",{offset:8}))return{ext:"cr2",mime:"image/x-canon-cr2"};if(r>=8&&(this.check([28,0,254,0],{offset:8})||this.check([31,0,11,0],{offset:8})))return{ext:"nef",mime:"image/x-nikon-nef"}}return await this.tokenizer.ignore(r),await this.readTiffIFD(e)??{ext:"tif",mime:"image/tiff"}}if(n===43)return{ext:"tif",mime:"image/tiff"}}}new Set(OG);new Set($G);var qw={};/*!
 * content-type
 * Copyright(c) 2015 Douglas Christopher Wilson
 * MIT Licensed
 */var S2=/; *([!#$%&'*+.^_`|~0-9A-Za-z-]+) *= *("(?:[\u000b\u0020\u0021\u0023-\u005b\u005d-\u007e\u0080-\u00ff]|\\[\u000b\u0020-\u00ff])*"|[!#$%&'*+.^_`|~0-9A-Za-z-]+) */g,zG=/^[\u000b\u0020-\u007e\u0080-\u00ff]+$/,zA=/^[!#$%&'*+.^_`|~0-9A-Za-z-]+$/,UG=/\\([\u000b\u0020-\u00ff])/g,VG=/([\\"])/g,UA=/^[!#$%&'*+.^_`|~0-9A-Za-z-]+\/[!#$%&'*+.^_`|~0-9A-Za-z-]+$/;qw.format=HG;qw.parse=WG;function HG(t){if(!t||typeof t!="object")throw new TypeError("argument obj is required");var e=t.parameters,n=t.type;if(!n||!UA.test(n))throw new TypeError("invalid type");var r=n;if(e&&typeof e=="object")for(var s,i=Object.keys(e).sort(),o=0;o<i.length;o++){if(s=i[o],!zA.test(s))throw new TypeError("invalid parameter name");r+="; "+s+"="+GG(e[s])}return r}function WG(t){if(!t)throw new TypeError("argument string is required");var e=typeof t=="object"?qG(t):t;if(typeof e!="string")throw new TypeError("argument string is required to be a string");var n=e.indexOf(";"),r=n!==-1?e.slice(0,n).trim():e.trim();if(!UA.test(r))throw new TypeError("invalid media type");var s=new QG(r.toLowerCase());if(n!==-1){var i,o,l;for(S2.lastIndex=n;o=S2.exec(e);){if(o.index!==n)throw new TypeError("invalid parameter format");n+=o[0].length,i=o[1].toLowerCase(),l=o[2],l.charCodeAt(0)===34&&(l=l.slice(1,-1),l.indexOf("\\")!==-1&&(l=l.replace(UG,"$1"))),s.parameters[i]=l}if(n!==e.length)throw new TypeError("invalid parameter format")}return s}function qG(t){var e;if(typeof t.getHeader=="function"?e=t.getHeader("content-type"):typeof t.headers=="object"&&(e=t.headers&&t.headers["content-type"]),typeof e!="string")throw new TypeError("content-type header is missing from object");return e}function GG(t){var e=String(t);if(zA.test(e))return e;if(e.length>0&&!zG.test(e))throw new TypeError("invalid parameter value");return'"'+e.replace(VG,"\\$1")+'"'}function QG(t){this.parameters=Object.create(null),this.type=t}/*!
 * media-typer
 * Copyright(c) 2014-2017 Douglas Christopher Wilson
 * MIT Licensed
 */var KG=/^ *([A-Za-z0-9][A-Za-z0-9!#$&^_-]{0,126})\/([A-Za-z0-9][A-Za-z0-9!#$&^_.+-]{0,126}) *$/,XG=YG;function YG(t){if(!t)throw new TypeError("argument string is required");if(typeof t!="string")throw new TypeError("argument string is required to be a string");var e=KG.exec(t.toLowerCase());if(!e)throw new TypeError("invalid media type");var n=e[1],r=e[2],s,i=r.lastIndexOf("+");return i!==-1&&(s=r.substr(i+1),r=r.substr(0,i)),new JG(n,r,s)}function JG(t,e,n){this.type=t,this.subtype=e,this.suffix=n}var Cx={exports:{}},Tg,E2;function ZG(){if(E2)return Tg;E2=1;var t=1e3,e=t*60,n=e*60,r=n*24,s=r*7,i=r*365.25;Tg=function(d,m){m=m||{};var p=typeof d;if(p==="string"&&d.length>0)return o(d);if(p==="number"&&isFinite(d))return m.long?c(d):l(d);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(d))};function o(d){if(d=String(d),!(d.length>100)){var m=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(d);if(m){var p=parseFloat(m[1]),g=(m[2]||"ms").toLowerCase();switch(g){case"years":case"year":case"yrs":case"yr":case"y":return p*i;case"weeks":case"week":case"w":return p*s;case"days":case"day":case"d":return p*r;case"hours":case"hour":case"hrs":case"hr":case"h":return p*n;case"minutes":case"minute":case"mins":case"min":case"m":return p*e;case"seconds":case"second":case"secs":case"sec":case"s":return p*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return p;default:return}}}}function l(d){var m=Math.abs(d);return m>=r?Math.round(d/r)+"d":m>=n?Math.round(d/n)+"h":m>=e?Math.round(d/e)+"m":m>=t?Math.round(d/t)+"s":d+"ms"}function c(d){var m=Math.abs(d);return m>=r?u(d,m,r,"day"):m>=n?u(d,m,n,"hour"):m>=e?u(d,m,e,"minute"):m>=t?u(d,m,t,"second"):d+" ms"}function u(d,m,p,g){var y=m>=p*1.5;return Math.round(d/p)+" "+g+(y?"s":"")}return Tg}function eQ(t){n.debug=n,n.default=n,n.coerce=c,n.disable=i,n.enable=s,n.enabled=o,n.humanize=ZG(),n.destroy=u,Object.keys(t).forEach(d=>{n[d]=t[d]}),n.names=[],n.skips=[],n.formatters={};function e(d){let m=0;for(let p=0;p<d.length;p++)m=(m<<5)-m+d.charCodeAt(p),m|=0;return n.colors[Math.abs(m)%n.colors.length]}n.selectColor=e;function n(d){let m,p=null,g,y;function w(..._){if(!w.enabled)return;const E=w,b=Number(new Date),S=b-(m||b);E.diff=S,E.prev=m,E.curr=b,m=b,_[0]=n.coerce(_[0]),typeof _[0]!="string"&&_.unshift("%O");let C=0;_[0]=_[0].replace(/%([a-zA-Z%])/g,(F,I)=>{if(F==="%%")return"%";C++;const k=n.formatters[I];if(typeof k=="function"){const R=_[C];F=k.call(E,R),_.splice(C,1),C--}return F}),n.formatArgs.call(E,_),(E.log||n.log).apply(E,_)}return w.namespace=d,w.useColors=n.useColors(),w.color=n.selectColor(d),w.extend=r,w.destroy=n.destroy,Object.defineProperty(w,"enabled",{enumerable:!0,configurable:!1,get:()=>p!==null?p:(g!==n.namespaces&&(g=n.namespaces,y=n.enabled(d)),y),set:_=>{p=_}}),typeof n.init=="function"&&n.init(w),w}function r(d,m){const p=n(this.namespace+(typeof m>"u"?":":m)+d);return p.log=this.log,p}function s(d){n.save(d),n.namespaces=d,n.names=[],n.skips=[];let m;const p=(typeof d=="string"?d:"").split(/[\s,]+/),g=p.length;for(m=0;m<g;m++)p[m]&&(d=p[m].replace(/\*/g,".*?"),d[0]==="-"?n.skips.push(new RegExp("^"+d.slice(1)+"$")):n.names.push(new RegExp("^"+d+"$")))}function i(){const d=[...n.names.map(l),...n.skips.map(l).map(m=>"-"+m)].join(",");return n.enable(""),d}function o(d){if(d[d.length-1]==="*")return!0;let m,p;for(m=0,p=n.skips.length;m<p;m++)if(n.skips[m].test(d))return!1;for(m=0,p=n.names.length;m<p;m++)if(n.names[m].test(d))return!0;return!1}function l(d){return d.toString().substring(2,d.toString().length-2).replace(/\.\*\?$/,"*")}function c(d){return d instanceof Error?d.stack||d.message:d}function u(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return n.enable(n.load()),n}var tQ=eQ;(function(t,e){e.formatArgs=r,e.save=s,e.load=i,e.useColors=n,e.storage=o(),e.destroy=(()=>{let c=!1;return()=>{c||(c=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function n(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function r(c){if(c[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+c[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;const u="color: "+this.color;c.splice(1,0,u,"color: inherit");let d=0,m=0;c[0].replace(/%[a-zA-Z%]/g,p=>{p!=="%%"&&(d++,p==="%c"&&(m=d))}),c.splice(m,0,u)}e.log=console.debug||console.log||(()=>{});function s(c){try{c?e.storage.setItem("debug",c):e.storage.removeItem("debug")}catch{}}function i(){let c;try{c=e.storage.getItem("debug")}catch{}return!c&&typeof process<"u"&&"env"in process&&(c={}.DEBUG),c}function o(){try{return localStorage}catch{}}t.exports=tQ(e);const{formatters:l}=t.exports;l.j=function(c){try{return JSON.stringify(c)}catch(u){return"[UnexpectedJSONParseError]: "+u.message}}})(Cx,Cx.exports);var nQ=Cx.exports;const Ue=dE(nQ);var jx;(function(t){t[t.shot=10]="shot",t[t.scene=20]="scene",t[t.track=30]="track",t[t.part=40]="part",t[t.album=50]="album",t[t.edition=60]="edition",t[t.collection=70]="collection"})(jx||(jx={}));var qa;(function(t){t[t.video=1]="video",t[t.audio=2]="audio",t[t.complex=3]="complex",t[t.logo=4]="logo",t[t.subtitle=17]="subtitle",t[t.button=18]="button",t[t.control=32]="control"})(qa||(qa={}));function lt(t,e,n){return(t[e]&1<<n)!==0}function $n(t,e,n,r){let s=e;if(r==="utf-16le"){for(;t[s]!==0||t[s+1]!==0;){if(s>=n)return n;s+=2}return s}for(;t[s]!==0;){if(s>=n)return n;s++}return s}function VA(t){const e=t.indexOf("\0");return e===-1?t:t.substr(0,e)}function rQ(t){const e=t.length;if(e&1)throw new Error("Buffer length must be even");for(let n=0;n<e;n+=2){const r=t[n];t[n]=t[n+1],t[n+1]=r}return t}function St(t,e){if(t[0]===255&&t[1]===254)return St(t.subarray(2),e);if(e==="utf-16le"&&t[0]===254&&t[1]===255){if(t.length&1)throw new Error("Expected even number of octets for 16-bit unicode string");return St(rQ(t),e)}return new ne(t.length,e).get(t,0)}function bi(t){return t=t.replace(/^\x00+/g,""),t=t.replace(/\x00+$/g,""),t}function je(t,e,n,r){const s=e+~~(n/8),i=n%8;let o=t[s];o&=255>>i;const l=8-i,c=r-l;return c<0?o>>=8-i-r:c>0&&(o<<=c,o|=je(t,e,n+l,c)),o}function Vn(t,e,n){return je(t,e,n,1)===1}function sQ(t){const e=[];for(let n=0,r=t.length;n<r;n++){const s=Number(t.charCodeAt(n)).toString(16);e.push(s.length===1?`0${s}`:s)}return e.join(" ")}function iQ(t){return 10*Math.log10(t)}function aQ(t){return 10**(t/10)}function oQ(t){const e=t.split(" ").map(n=>n.trim().toLowerCase());if(e.length>=1){const n=Number.parseFloat(e[0]);return e.length===2&&e[1]==="db"?{dB:n,ratio:aQ(n)}:{dB:iQ(n),ratio:n}}}var pu;(function(t){t[t.Other=0]="Other",t[t["32x32 pixels 'file icon' (PNG only)"]=1]="32x32 pixels 'file icon' (PNG only)",t[t["Other file icon"]=2]="Other file icon",t[t["Cover (front)"]=3]="Cover (front)",t[t["Cover (back)"]=4]="Cover (back)",t[t["Leaflet page"]=5]="Leaflet page",t[t["Media (e.g. label side of CD)"]=6]="Media (e.g. label side of CD)",t[t["Lead artist/lead performer/soloist"]=7]="Lead artist/lead performer/soloist",t[t["Artist/performer"]=8]="Artist/performer",t[t.Conductor=9]="Conductor",t[t["Band/Orchestra"]=10]="Band/Orchestra",t[t.Composer=11]="Composer",t[t["Lyricist/text writer"]=12]="Lyricist/text writer",t[t["Recording Location"]=13]="Recording Location",t[t["During recording"]=14]="During recording",t[t["During performance"]=15]="During performance",t[t["Movie/video screen capture"]=16]="Movie/video screen capture",t[t["A bright coloured fish"]=17]="A bright coloured fish",t[t.Illustration=18]="Illustration",t[t["Band/artist logotype"]=19]="Band/artist logotype",t[t["Publisher/Studio logotype"]=20]="Publisher/Studio logotype"})(pu||(pu={}));var k2;(function(t){t[t.other=0]="other",t[t.lyrics=1]="lyrics",t[t.text=2]="text",t[t.movement_part=3]="movement_part",t[t.events=4]="events",t[t.chord=5]="chord",t[t.trivia_pop=6]="trivia_pop"})(k2||(k2={}));var T2;(function(t){t[t.notSynchronized0=0]="notSynchronized0",t[t.mpegFrameNumber=1]="mpegFrameNumber",t[t.milliseconds=2]="milliseconds"})(T2||(T2={}));const HA={get:(t,e)=>t[e+3]&127|t[e+2]<<7|t[e+1]<<14|t[e]<<21,len:4},Rx={len:10,get:(t,e)=>({fileIdentifier:new ne(3,"ascii").get(t,e),version:{major:mu.get(t,e+3),revision:mu.get(t,e+4)},flags:{unsynchronisation:lt(t,e+5,7),isExtendedHeader:lt(t,e+5,6),expIndicator:lt(t,e+5,5),footer:lt(t,e+5,4)},size:HA.get(t,e+6)})},I2={len:10,get:(t,e)=>({size:re.get(t,e),extendedFlags:$e.get(t,e+4),sizeOfPadding:re.get(t,e+6),crcDataPresent:lt(t,e+4,31)})},WA={len:1,get:(t,e)=>{switch(t[e]){case 0:return{encoding:"latin1"};case 1:return{encoding:"utf-16le",bom:!0};case 2:return{encoding:"utf-16le",bom:!1};case 3:return{encoding:"utf8",bom:!1};default:return{encoding:"utf8",bom:!1}}}},Ax={len:4,get:(t,e)=>({encoding:WA.get(t,e),language:new ne(3,"latin1").get(t,e+1)})},C2={len:6,get:(t,e)=>{const n=Ax.get(t,e);return{encoding:n.encoding,language:n.language,timeStampFormat:ve.get(t,e+4),contentType:ve.get(t,e+5)}}},Rf={year:{multiple:!1},track:{multiple:!1},disk:{multiple:!1},title:{multiple:!1},artist:{multiple:!1},artists:{multiple:!0,unique:!0},albumartist:{multiple:!1},album:{multiple:!1},date:{multiple:!1},originaldate:{multiple:!1},originalyear:{multiple:!1},releasedate:{multiple:!1},comment:{multiple:!0,unique:!1},genre:{multiple:!0,unique:!0},picture:{multiple:!0,unique:!0},composer:{multiple:!0,unique:!0},lyrics:{multiple:!0,unique:!1},albumsort:{multiple:!1,unique:!0},titlesort:{multiple:!1,unique:!0},work:{multiple:!1,unique:!0},artistsort:{multiple:!1,unique:!0},albumartistsort:{multiple:!1,unique:!0},composersort:{multiple:!1,unique:!0},lyricist:{multiple:!0,unique:!0},writer:{multiple:!0,unique:!0},conductor:{multiple:!0,unique:!0},remixer:{multiple:!0,unique:!0},arranger:{multiple:!0,unique:!0},engineer:{multiple:!0,unique:!0},producer:{multiple:!0,unique:!0},technician:{multiple:!0,unique:!0},djmixer:{multiple:!0,unique:!0},mixer:{multiple:!0,unique:!0},label:{multiple:!0,unique:!0},grouping:{multiple:!1},subtitle:{multiple:!0},discsubtitle:{multiple:!1},totaltracks:{multiple:!1},totaldiscs:{multiple:!1},compilation:{multiple:!1},rating:{multiple:!0},bpm:{multiple:!1},mood:{multiple:!1},media:{multiple:!1},catalognumber:{multiple:!0,unique:!0},tvShow:{multiple:!1},tvShowSort:{multiple:!1},tvSeason:{multiple:!1},tvEpisode:{multiple:!1},tvEpisodeId:{multiple:!1},tvNetwork:{multiple:!1},podcast:{multiple:!1},podcasturl:{multiple:!1},releasestatus:{multiple:!1},releasetype:{multiple:!0},releasecountry:{multiple:!1},script:{multiple:!1},language:{multiple:!1},copyright:{multiple:!1},license:{multiple:!1},encodedby:{multiple:!1},encodersettings:{multiple:!1},gapless:{multiple:!1},barcode:{multiple:!1},isrc:{multiple:!0},asin:{multiple:!1},musicbrainz_recordingid:{multiple:!1},musicbrainz_trackid:{multiple:!1},musicbrainz_albumid:{multiple:!1},musicbrainz_artistid:{multiple:!0},musicbrainz_albumartistid:{multiple:!0},musicbrainz_releasegroupid:{multiple:!1},musicbrainz_workid:{multiple:!1},musicbrainz_trmid:{multiple:!1},musicbrainz_discid:{multiple:!1},acoustid_id:{multiple:!1},acoustid_fingerprint:{multiple:!1},musicip_puid:{multiple:!1},musicip_fingerprint:{multiple:!1},website:{multiple:!1},"performer:instrument":{multiple:!0,unique:!0},averageLevel:{multiple:!1},peakLevel:{multiple:!1},notes:{multiple:!0,unique:!1},key:{multiple:!1},originalalbum:{multiple:!1},originalartist:{multiple:!1},discogs_artist_id:{multiple:!0,unique:!0},discogs_release_id:{multiple:!1},discogs_label_id:{multiple:!1},discogs_master_release_id:{multiple:!1},discogs_votes:{multiple:!1},discogs_rating:{multiple:!1},replaygain_track_peak:{multiple:!1},replaygain_track_gain:{multiple:!1},replaygain_album_peak:{multiple:!1},replaygain_album_gain:{multiple:!1},replaygain_track_minmax:{multiple:!1},replaygain_album_minmax:{multiple:!1},replaygain_undo:{multiple:!1},description:{multiple:!0},longDescription:{multiple:!1},category:{multiple:!0},hdVideo:{multiple:!1},keywords:{multiple:!0},movement:{multiple:!1},movementIndex:{multiple:!1},movementTotal:{multiple:!1},podcastId:{multiple:!1},showMovement:{multiple:!1},stik:{multiple:!1}};function lQ(t){return Rf[t]&&!Rf[t].multiple}function cQ(t){return!Rf[t].multiple||Rf[t].unique||!1}class Gn{static toIntOrNull(e){const n=Number.parseInt(e,10);return Number.isNaN(n)?null:n}static normalizeTrack(e){const n=e.toString().split("/");return{no:Number.parseInt(n[0],10)||null,of:Number.parseInt(n[1],10)||null}}constructor(e,n){this.tagTypes=e,this.tagMap=n}mapGenericTag(e,n){e={id:e.id,value:e.value},this.postMap(e,n);const r=this.getCommonName(e.id);return r?{id:r,value:e.value}:null}getCommonName(e){return this.tagMap[e]}postMap(e,n){}}Gn.maxRatingScore=1;const uQ={title:"title",artist:"artist",album:"album",year:"year",comment:"comment",track:"track",genre:"genre"};class dQ extends Gn{constructor(){super(["ID3v1"],uQ)}}class Xu extends Gn{constructor(e,n){const r={};for(const s of Object.keys(n))r[s.toUpperCase()]=n[s];super(e,r)}getCommonName(e){return this.tagMap[e.toUpperCase()]}}const hQ={TIT2:"title",TPE1:"artist","TXXX:Artists":"artists",TPE2:"albumartist",TALB:"album",TDRV:"date",TORY:"originalyear",TPOS:"disk",TCON:"genre",APIC:"picture",TCOM:"composer",USLT:"lyrics",TSOA:"albumsort",TSOT:"titlesort",TOAL:"originalalbum",TSOP:"artistsort",TSO2:"albumartistsort",TSOC:"composersort",TEXT:"lyricist","TXXX:Writer":"writer",TPE3:"conductor",TPE4:"remixer","IPLS:arranger":"arranger","IPLS:engineer":"engineer","IPLS:producer":"producer","IPLS:DJ-mix":"djmixer","IPLS:mix":"mixer",TPUB:"label",TIT1:"grouping",TIT3:"subtitle",TRCK:"track",TCMP:"compilation",POPM:"rating",TBPM:"bpm",TMED:"media","TXXX:CATALOGNUMBER":"catalognumber","TXXX:MusicBrainz Album Status":"releasestatus","TXXX:MusicBrainz Album Type":"releasetype","TXXX:MusicBrainz Album Release Country":"releasecountry","TXXX:RELEASECOUNTRY":"releasecountry","TXXX:SCRIPT":"script",TLAN:"language",TCOP:"copyright",WCOP:"license",TENC:"encodedby",TSSE:"encodersettings","TXXX:BARCODE":"barcode","TXXX:ISRC":"isrc",TSRC:"isrc","TXXX:ASIN":"asin","TXXX:originalyear":"originalyear","UFID:http://musicbrainz.org":"musicbrainz_recordingid","TXXX:MusicBrainz Release Track Id":"musicbrainz_trackid","TXXX:MusicBrainz Album Id":"musicbrainz_albumid","TXXX:MusicBrainz Artist Id":"musicbrainz_artistid","TXXX:MusicBrainz Album Artist Id":"musicbrainz_albumartistid","TXXX:MusicBrainz Release Group Id":"musicbrainz_releasegroupid","TXXX:MusicBrainz Work Id":"musicbrainz_workid","TXXX:MusicBrainz TRM Id":"musicbrainz_trmid","TXXX:MusicBrainz Disc Id":"musicbrainz_discid","TXXX:ACOUSTID_ID":"acoustid_id","TXXX:Acoustid Id":"acoustid_id","TXXX:Acoustid Fingerprint":"acoustid_fingerprint","TXXX:MusicIP PUID":"musicip_puid","TXXX:MusicMagic Fingerprint":"musicip_fingerprint",WOAR:"website",TDRC:"date",TYER:"year",TDOR:"originaldate","TIPL:arranger":"arranger","TIPL:engineer":"engineer","TIPL:producer":"producer","TIPL:DJ-mix":"djmixer","TIPL:mix":"mixer",TMOO:"mood",SYLT:"lyrics",TSST:"discsubtitle",TKEY:"key",COMM:"comment",TOPE:"originalartist","PRIV:AverageLevel":"averageLevel","PRIV:PeakLevel":"peakLevel","TXXX:DISCOGS_ARTIST_ID":"discogs_artist_id","TXXX:DISCOGS_ARTISTS":"artists","TXXX:DISCOGS_ARTIST_NAME":"artists","TXXX:DISCOGS_ALBUM_ARTISTS":"albumartist","TXXX:DISCOGS_CATALOG":"catalognumber","TXXX:DISCOGS_COUNTRY":"releasecountry","TXXX:DISCOGS_DATE":"originaldate","TXXX:DISCOGS_LABEL":"label","TXXX:DISCOGS_LABEL_ID":"discogs_label_id","TXXX:DISCOGS_MASTER_RELEASE_ID":"discogs_master_release_id","TXXX:DISCOGS_RATING":"discogs_rating","TXXX:DISCOGS_RELEASED":"date","TXXX:DISCOGS_RELEASE_ID":"discogs_release_id","TXXX:DISCOGS_VOTES":"discogs_votes","TXXX:CATALOGID":"catalognumber","TXXX:STYLE":"genre","TXXX:REPLAYGAIN_TRACK_PEAK":"replaygain_track_peak","TXXX:REPLAYGAIN_TRACK_GAIN":"replaygain_track_gain","TXXX:REPLAYGAIN_ALBUM_PEAK":"replaygain_album_peak","TXXX:REPLAYGAIN_ALBUM_GAIN":"replaygain_album_gain","TXXX:MP3GAIN_MINMAX":"replaygain_track_minmax","TXXX:MP3GAIN_ALBUM_MINMAX":"replaygain_album_minmax","TXXX:MP3GAIN_UNDO":"replaygain_undo",MVNM:"movement",MVIN:"movementIndex",PCST:"podcast",TCAT:"category",TDES:"description",TDRL:"releasedate",TGID:"podcastId",TKWD:"keywords",WFED:"podcasturl",GRP1:"grouping"};class Gw extends Xu{static toRating(e){return{source:e.email,rating:e.rating>0?(e.rating-1)/254*Gn.maxRatingScore:void 0}}constructor(){super(["ID3v2.3","ID3v2.4"],hQ)}postMap(e,n){switch(e.id){case"UFID":{const r=e.value;r.owner_identifier==="http://musicbrainz.org"&&(e.id+=`:${r.owner_identifier}`,e.value=St(r.identifier,"latin1"))}break;case"PRIV":{const r=e.value;switch(r.owner_identifier){case"AverageLevel":case"PeakValue":e.id+=`:${r.owner_identifier}`,e.value=r.data.length===4?J.get(r.data,0):null,e.value===null&&n.addWarning("Failed to parse PRIV:PeakValue");break;default:n.addWarning(`Unknown PRIV owner-identifier: ${r.data}`)}}break;case"POPM":e.value=Gw.toRating(e.value);break}}}const fQ={Title:"title",Author:"artist","WM/AlbumArtist":"albumartist","WM/AlbumTitle":"album","WM/Year":"date","WM/OriginalReleaseTime":"originaldate","WM/OriginalReleaseYear":"originalyear",Description:"comment","WM/TrackNumber":"track","WM/PartOfSet":"disk","WM/Genre":"genre","WM/Composer":"composer","WM/Lyrics":"lyrics","WM/AlbumSortOrder":"albumsort","WM/TitleSortOrder":"titlesort","WM/ArtistSortOrder":"artistsort","WM/AlbumArtistSortOrder":"albumartistsort","WM/ComposerSortOrder":"composersort","WM/Writer":"lyricist","WM/Conductor":"conductor","WM/ModifiedBy":"remixer","WM/Engineer":"engineer","WM/Producer":"producer","WM/DJMixer":"djmixer","WM/Mixer":"mixer","WM/Publisher":"label","WM/ContentGroupDescription":"grouping","WM/SubTitle":"subtitle","WM/SetSubTitle":"discsubtitle","WM/IsCompilation":"compilation","WM/SharedUserRating":"rating","WM/BeatsPerMinute":"bpm","WM/Mood":"mood","WM/Media":"media","WM/CatalogNo":"catalognumber","MusicBrainz/Album Status":"releasestatus","MusicBrainz/Album Type":"releasetype","MusicBrainz/Album Release Country":"releasecountry","WM/Script":"script","WM/Language":"language",Copyright:"copyright",LICENSE:"license","WM/EncodedBy":"encodedby","WM/EncodingSettings":"encodersettings","WM/Barcode":"barcode","WM/ISRC":"isrc","MusicBrainz/Track Id":"musicbrainz_recordingid","MusicBrainz/Release Track Id":"musicbrainz_trackid","MusicBrainz/Album Id":"musicbrainz_albumid","MusicBrainz/Artist Id":"musicbrainz_artistid","MusicBrainz/Album Artist Id":"musicbrainz_albumartistid","MusicBrainz/Release Group Id":"musicbrainz_releasegroupid","MusicBrainz/Work Id":"musicbrainz_workid","MusicBrainz/TRM Id":"musicbrainz_trmid","MusicBrainz/Disc Id":"musicbrainz_discid","Acoustid/Id":"acoustid_id","Acoustid/Fingerprint":"acoustid_fingerprint","MusicIP/PUID":"musicip_puid","WM/ARTISTS":"artists","WM/InitialKey":"key",ASIN:"asin","WM/Work":"work","WM/AuthorURL":"website","WM/Picture":"picture"};class Qw extends Gn{static toRating(e){return{rating:Number.parseFloat(e+1)/5}}constructor(){super(["asf"],fQ)}postMap(e){switch(e.id){case"WM/SharedUserRating":{const n=e.id.split(":");e.value=Qw.toRating(e.value),e.id=n[0];break}}}}const mQ={TT2:"title",TP1:"artist",TP2:"albumartist",TAL:"album",TYE:"year",COM:"comment",TRK:"track",TPA:"disk",TCO:"genre",PIC:"picture",TCM:"composer",TOR:"originaldate",TOT:"originalalbum",TXT:"lyricist",TP3:"conductor",TPB:"label",TT1:"grouping",TT3:"subtitle",TLA:"language",TCR:"copyright",WCP:"license",TEN:"encodedby",TSS:"encodersettings",WAR:"website",PCS:"podcast",TCP:"compilation",TDR:"date",TS2:"albumartistsort",TSA:"albumsort",TSC:"composersort",TSP:"artistsort",TST:"titlesort",WFD:"podcasturl",TBP:"bpm"};class pQ extends Xu{constructor(){super(["ID3v2.2"],mQ)}}const gQ={Title:"title",Artist:"artist",Artists:"artists","Album Artist":"albumartist",Album:"album",Year:"date",Originalyear:"originalyear",Originaldate:"originaldate",Releasedate:"releasedate",Comment:"comment",Track:"track",Disc:"disk",DISCNUMBER:"disk",Genre:"genre","Cover Art (Front)":"picture","Cover Art (Back)":"picture",Composer:"composer",Lyrics:"lyrics",ALBUMSORT:"albumsort",TITLESORT:"titlesort",WORK:"work",ARTISTSORT:"artistsort",ALBUMARTISTSORT:"albumartistsort",COMPOSERSORT:"composersort",Lyricist:"lyricist",Writer:"writer",Conductor:"conductor",MixArtist:"remixer",Arranger:"arranger",Engineer:"engineer",Producer:"producer",DJMixer:"djmixer",Mixer:"mixer",Label:"label",Grouping:"grouping",Subtitle:"subtitle",DiscSubtitle:"discsubtitle",Compilation:"compilation",BPM:"bpm",Mood:"mood",Media:"media",CatalogNumber:"catalognumber",MUSICBRAINZ_ALBUMSTATUS:"releasestatus",MUSICBRAINZ_ALBUMTYPE:"releasetype",RELEASECOUNTRY:"releasecountry",Script:"script",Language:"language",Copyright:"copyright",LICENSE:"license",EncodedBy:"encodedby",EncoderSettings:"encodersettings",Barcode:"barcode",ISRC:"isrc",ASIN:"asin",musicbrainz_trackid:"musicbrainz_recordingid",musicbrainz_releasetrackid:"musicbrainz_trackid",MUSICBRAINZ_ALBUMID:"musicbrainz_albumid",MUSICBRAINZ_ARTISTID:"musicbrainz_artistid",MUSICBRAINZ_ALBUMARTISTID:"musicbrainz_albumartistid",MUSICBRAINZ_RELEASEGROUPID:"musicbrainz_releasegroupid",MUSICBRAINZ_WORKID:"musicbrainz_workid",MUSICBRAINZ_TRMID:"musicbrainz_trmid",MUSICBRAINZ_DISCID:"musicbrainz_discid",Acoustid_Id:"acoustid_id",ACOUSTID_FINGERPRINT:"acoustid_fingerprint",MUSICIP_PUID:"musicip_puid",Weblink:"website",REPLAYGAIN_TRACK_GAIN:"replaygain_track_gain",REPLAYGAIN_TRACK_PEAK:"replaygain_track_peak",MP3GAIN_MINMAX:"replaygain_track_minmax",MP3GAIN_UNDO:"replaygain_undo"};class xQ extends Xu{constructor(){super(["APEv2"],gQ)}}const yQ={"©nam":"title","©ART":"artist",aART:"albumartist","----:com.apple.iTunes:Band":"albumartist","©alb":"album","©day":"date","©cmt":"comment","©com":"comment",trkn:"track",disk:"disk","©gen":"genre",covr:"picture","©wrt":"composer","©lyr":"lyrics",soal:"albumsort",sonm:"titlesort",soar:"artistsort",soaa:"albumartistsort",soco:"composersort","----:com.apple.iTunes:LYRICIST":"lyricist","----:com.apple.iTunes:CONDUCTOR":"conductor","----:com.apple.iTunes:REMIXER":"remixer","----:com.apple.iTunes:ENGINEER":"engineer","----:com.apple.iTunes:PRODUCER":"producer","----:com.apple.iTunes:DJMIXER":"djmixer","----:com.apple.iTunes:MIXER":"mixer","----:com.apple.iTunes:LABEL":"label","©grp":"grouping","----:com.apple.iTunes:SUBTITLE":"subtitle","----:com.apple.iTunes:DISCSUBTITLE":"discsubtitle",cpil:"compilation",tmpo:"bpm","----:com.apple.iTunes:MOOD":"mood","----:com.apple.iTunes:MEDIA":"media","----:com.apple.iTunes:CATALOGNUMBER":"catalognumber",tvsh:"tvShow",tvsn:"tvSeason",tves:"tvEpisode",sosn:"tvShowSort",tven:"tvEpisodeId",tvnn:"tvNetwork",pcst:"podcast",purl:"podcasturl","----:com.apple.iTunes:MusicBrainz Album Status":"releasestatus","----:com.apple.iTunes:MusicBrainz Album Type":"releasetype","----:com.apple.iTunes:MusicBrainz Album Release Country":"releasecountry","----:com.apple.iTunes:SCRIPT":"script","----:com.apple.iTunes:LANGUAGE":"language",cprt:"copyright","©cpy":"copyright","----:com.apple.iTunes:LICENSE":"license","©too":"encodedby",pgap:"gapless","----:com.apple.iTunes:BARCODE":"barcode","----:com.apple.iTunes:ISRC":"isrc","----:com.apple.iTunes:ASIN":"asin","----:com.apple.iTunes:NOTES":"comment","----:com.apple.iTunes:MusicBrainz Track Id":"musicbrainz_recordingid","----:com.apple.iTunes:MusicBrainz Release Track Id":"musicbrainz_trackid","----:com.apple.iTunes:MusicBrainz Album Id":"musicbrainz_albumid","----:com.apple.iTunes:MusicBrainz Artist Id":"musicbrainz_artistid","----:com.apple.iTunes:MusicBrainz Album Artist Id":"musicbrainz_albumartistid","----:com.apple.iTunes:MusicBrainz Release Group Id":"musicbrainz_releasegroupid","----:com.apple.iTunes:MusicBrainz Work Id":"musicbrainz_workid","----:com.apple.iTunes:MusicBrainz TRM Id":"musicbrainz_trmid","----:com.apple.iTunes:MusicBrainz Disc Id":"musicbrainz_discid","----:com.apple.iTunes:Acoustid Id":"acoustid_id","----:com.apple.iTunes:Acoustid Fingerprint":"acoustid_fingerprint","----:com.apple.iTunes:MusicIP PUID":"musicip_puid","----:com.apple.iTunes:fingerprint":"musicip_fingerprint","----:com.apple.iTunes:replaygain_track_gain":"replaygain_track_gain","----:com.apple.iTunes:replaygain_track_peak":"replaygain_track_peak","----:com.apple.iTunes:replaygain_album_gain":"replaygain_album_gain","----:com.apple.iTunes:replaygain_album_peak":"replaygain_album_peak","----:com.apple.iTunes:replaygain_track_minmax":"replaygain_track_minmax","----:com.apple.iTunes:replaygain_album_minmax":"replaygain_album_minmax","----:com.apple.iTunes:replaygain_undo":"replaygain_undo",gnre:"genre","----:com.apple.iTunes:ALBUMARTISTSORT":"albumartistsort","----:com.apple.iTunes:ARTISTS":"artists","----:com.apple.iTunes:ORIGINALDATE":"originaldate","----:com.apple.iTunes:ORIGINALYEAR":"originalyear","----:com.apple.iTunes:RELEASEDATE":"releasedate",desc:"description",ldes:"longDescription","©mvn":"movement","©mvi":"movementIndex","©mvc":"movementTotal","©wrk":"work",catg:"category",egid:"podcastId",hdvd:"hdVideo",keyw:"keywords",shwm:"showMovement",stik:"stik",rate:"rating"},vQ="iTunes";class j2 extends Xu{constructor(){super([vQ],yQ)}postMap(e,n){switch(e.id){case"rate":e.value={source:void 0,rating:Number.parseFloat(e.value)/100};break}}}const wQ={TITLE:"title",ARTIST:"artist",ARTISTS:"artists",ALBUMARTIST:"albumartist","ALBUM ARTIST":"albumartist",ALBUM:"album",DATE:"date",ORIGINALDATE:"originaldate",ORIGINALYEAR:"originalyear",RELEASEDATE:"releasedate",COMMENT:"comment",TRACKNUMBER:"track",DISCNUMBER:"disk",GENRE:"genre",METADATA_BLOCK_PICTURE:"picture",COMPOSER:"composer",LYRICS:"lyrics",ALBUMSORT:"albumsort",TITLESORT:"titlesort",WORK:"work",ARTISTSORT:"artistsort",ALBUMARTISTSORT:"albumartistsort",COMPOSERSORT:"composersort",LYRICIST:"lyricist",WRITER:"writer",CONDUCTOR:"conductor",REMIXER:"remixer",ARRANGER:"arranger",ENGINEER:"engineer",PRODUCER:"producer",DJMIXER:"djmixer",MIXER:"mixer",LABEL:"label",GROUPING:"grouping",SUBTITLE:"subtitle",DISCSUBTITLE:"discsubtitle",TRACKTOTAL:"totaltracks",DISCTOTAL:"totaldiscs",COMPILATION:"compilation",RATING:"rating",BPM:"bpm",KEY:"key",MOOD:"mood",MEDIA:"media",CATALOGNUMBER:"catalognumber",RELEASESTATUS:"releasestatus",RELEASETYPE:"releasetype",RELEASECOUNTRY:"releasecountry",SCRIPT:"script",LANGUAGE:"language",COPYRIGHT:"copyright",LICENSE:"license",ENCODEDBY:"encodedby",ENCODERSETTINGS:"encodersettings",BARCODE:"barcode",ISRC:"isrc",ASIN:"asin",MUSICBRAINZ_TRACKID:"musicbrainz_recordingid",MUSICBRAINZ_RELEASETRACKID:"musicbrainz_trackid",MUSICBRAINZ_ALBUMID:"musicbrainz_albumid",MUSICBRAINZ_ARTISTID:"musicbrainz_artistid",MUSICBRAINZ_ALBUMARTISTID:"musicbrainz_albumartistid",MUSICBRAINZ_RELEASEGROUPID:"musicbrainz_releasegroupid",MUSICBRAINZ_WORKID:"musicbrainz_workid",MUSICBRAINZ_TRMID:"musicbrainz_trmid",MUSICBRAINZ_DISCID:"musicbrainz_discid",ACOUSTID_ID:"acoustid_id",ACOUSTID_ID_FINGERPRINT:"acoustid_fingerprint",MUSICIP_PUID:"musicip_puid",WEBSITE:"website",NOTES:"notes",TOTALTRACKS:"totaltracks",TOTALDISCS:"totaldiscs",DISCOGS_ARTIST_ID:"discogs_artist_id",DISCOGS_ARTISTS:"artists",DISCOGS_ARTIST_NAME:"artists",DISCOGS_ALBUM_ARTISTS:"albumartist",DISCOGS_CATALOG:"catalognumber",DISCOGS_COUNTRY:"releasecountry",DISCOGS_DATE:"originaldate",DISCOGS_LABEL:"label",DISCOGS_LABEL_ID:"discogs_label_id",DISCOGS_MASTER_RELEASE_ID:"discogs_master_release_id",DISCOGS_RATING:"discogs_rating",DISCOGS_RELEASED:"date",DISCOGS_RELEASE_ID:"discogs_release_id",DISCOGS_VOTES:"discogs_votes",CATALOGID:"catalognumber",STYLE:"genre",REPLAYGAIN_TRACK_GAIN:"replaygain_track_gain",REPLAYGAIN_TRACK_PEAK:"replaygain_track_peak",REPLAYGAIN_ALBUM_GAIN:"replaygain_album_gain",REPLAYGAIN_ALBUM_PEAK:"replaygain_album_peak",REPLAYGAIN_MINMAX:"replaygain_track_minmax",REPLAYGAIN_ALBUM_MINMAX:"replaygain_album_minmax",REPLAYGAIN_UNDO:"replaygain_undo"};class Af extends Gn{static toRating(e,n,r){return{source:e?e.toLowerCase():void 0,rating:Number.parseFloat(n)/r*Gn.maxRatingScore}}constructor(){super(["vorbis"],wQ)}postMap(e){if(e.id==="RATING")e.value=Af.toRating(void 0,e.value,100);else if(e.id.indexOf("RATING:")===0){const n=e.id.split(":");e.value=Af.toRating(n[1],e.value,1),e.id=n[0]}}}const _Q={IART:"artist",ICRD:"date",INAM:"title",TITL:"title",IPRD:"album",ITRK:"track",IPRT:"track",COMM:"comment",ICMT:"comment",ICNT:"releasecountry",GNRE:"genre",IWRI:"writer",RATE:"rating",YEAR:"year",ISFT:"encodedby",CODE:"encodedby",TURL:"website",IGNR:"genre",IENG:"engineer",ITCH:"technician",IMED:"media",IRPD:"album"};class bQ extends Gn{constructor(){super(["exif"],_Q)}}const SQ={"segment:title":"title","album:ARTIST":"albumartist","album:ARTISTSORT":"albumartistsort","album:TITLE":"album","album:DATE_RECORDED":"originaldate","album:DATE_RELEASED":"releasedate","album:PART_NUMBER":"disk","album:TOTAL_PARTS":"totaltracks","track:ARTIST":"artist","track:ARTISTSORT":"artistsort","track:TITLE":"title","track:PART_NUMBER":"track","track:MUSICBRAINZ_TRACKID":"musicbrainz_recordingid","track:MUSICBRAINZ_ALBUMID":"musicbrainz_albumid","track:MUSICBRAINZ_ARTISTID":"musicbrainz_artistid","track:PUBLISHER":"label","track:GENRE":"genre","track:ENCODER":"encodedby","track:ENCODER_OPTIONS":"encodersettings","edition:TOTAL_PARTS":"totaldiscs",picture:"picture"};class EQ extends Xu{constructor(){super(["matroska"],SQ)}}const kQ={NAME:"title",AUTH:"artist","(c) ":"copyright",ANNO:"comment"};class TQ extends Gn{constructor(){super(["AIFF"],kQ)}}class IQ{constructor(){this.tagMappers={},[new dQ,new pQ,new Gw,new j2,new j2,new Af,new xQ,new Qw,new bQ,new EQ,new TQ].forEach(e=>{this.registerTagMapper(e)})}mapTag(e,n,r){if(this.tagMappers[e])return this.tagMappers[e].mapGenericTag(n,r);throw new Error(`No generic tag mapper defined for tag-format: ${e}`)}registerTagMapper(e){for(const n of e.tagTypes)this.tagMappers[n]=e}}const ca=Ue("music-metadata:collector"),CQ=["matroska","APEv2","vorbis","ID3v2.4","ID3v2.3","ID3v2.2","exif","asf","iTunes","AIFF","ID3v1"];class jQ{constructor(e){this.opts=e,this.format={tagTypes:[],trackInfo:[]},this.native={},this.common={track:{no:null,of:null},disk:{no:null,of:null},movementIndex:{no:null,of:null}},this.quality={warnings:[]},this.commonOrigin={},this.originPriority={},this.tagMapper=new IQ;let n=1;for(const r of CQ)this.originPriority[r]=n++;this.originPriority.artificial=500,this.originPriority.id3v1=600}hasAny(){return Object.keys(this.native).length>0}addStreamInfo(e){ca(`streamInfo: type=${e.type?qa[e.type]:"?"}, codec=${e.codecName}`),this.format.trackInfo.push(e)}setFormat(e,n){var r;ca(`format: ${e} = ${n}`),this.format[e]=n,(r=this.opts)!=null&&r.observer&&this.opts.observer({metadata:this,tag:{type:"format",id:e,value:n}})}async addTag(e,n,r){ca(`tag ${e}.${n} = ${r}`),this.native[e]||(this.format.tagTypes.push(e),this.native[e]=[]),this.native[e].push({id:n,value:r}),await this.toCommon(e,n,r)}addWarning(e){this.quality.warnings.push({message:e})}async postMap(e,n){switch(n.id){case"artist":if(this.commonOrigin.artist===this.originPriority[e])return this.postMap("artificial",{id:"artists",value:n.value});this.common.artists||this.setGenericTag("artificial",{id:"artists",value:n.value});break;case"artists":if((!this.common.artist||this.commonOrigin.artist===this.originPriority.artificial)&&(!this.common.artists||this.common.artists.indexOf(n.value)===-1)){const r=(this.common.artists||[]).concat([n.value]),i={id:"artist",value:RQ(r)};this.setGenericTag("artificial",i)}break;case"picture":return this.postFixPicture(n.value).then(r=>{r!==null&&(n.value=r,this.setGenericTag(e,n))});case"totaltracks":this.common.track.of=Gn.toIntOrNull(n.value);return;case"totaldiscs":this.common.disk.of=Gn.toIntOrNull(n.value);return;case"movementTotal":this.common.movementIndex.of=Gn.toIntOrNull(n.value);return;case"track":case"disk":case"movementIndex":{const r=this.common[n.id].of;this.common[n.id]=Gn.normalizeTrack(n.value),this.common[n.id].of=r??this.common[n.id].of;return}case"bpm":case"year":case"originalyear":n.value=Number.parseInt(n.value,10);break;case"date":{const r=Number.parseInt(n.value.substr(0,4),10);Number.isNaN(r)||(this.common.year=r);break}case"discogs_label_id":case"discogs_release_id":case"discogs_master_release_id":case"discogs_artist_id":case"discogs_votes":n.value=typeof n.value=="string"?Number.parseInt(n.value,10):n.value;break;case"replaygain_track_gain":case"replaygain_track_peak":case"replaygain_album_gain":case"replaygain_album_peak":n.value=oQ(n.value);break;case"replaygain_track_minmax":n.value=n.value.split(",").map(r=>Number.parseInt(r,10));break;case"replaygain_undo":{const r=n.value.split(",").map(s=>Number.parseInt(s,10));n.value={leftChannel:r[0],rightChannel:r[1]};break}case"gapless":case"compilation":case"podcast":case"showMovement":n.value=n.value==="1"||n.value===1;break;case"isrc":{const r=this.common[n.id];if(r&&r.indexOf(n.value)!==-1)return;break}case"comment":typeof n.value=="string"&&(n.value={text:n.value}),n.value.descriptor==="iTunPGAP"&&this.setGenericTag(e,{id:"gapless",value:n.value.text==="1"});break}n.value!==null&&this.setGenericTag(e,n)}toCommonMetadata(){return{format:this.format,native:this.native,quality:this.quality,common:this.common}}async postFixPicture(e){if(e.data&&e.data.length>0){if(!e.format){const n=await BA(Uint8Array.from(e.data));if(n)e.format=n.mime;else return null}switch(e.format=e.format.toLocaleLowerCase(),e.format){case"image/jpg":e.format="image/jpeg"}return e}return this.addWarning("Empty picture tag found"),null}async toCommon(e,n,r){const s={id:n,value:r},i=this.tagMapper.mapTag(e,s,this);i&&await this.postMap(e,i)}setGenericTag(e,n){var i;ca(`common.${n.id} = ${n.value}`);const r=this.commonOrigin[n.id]||1e3,s=this.originPriority[e];if(lQ(n.id))if(s<=r)this.common[n.id]=n.value,this.commonOrigin[n.id]=s;else return ca(`Ignore native tag (singleton): ${e}.${n.id} = ${n.value}`);else if(s===r)!cQ(n.id)||this.common[n.id].indexOf(n.value)===-1?this.common[n.id].push(n.value):ca(`Ignore duplicate value: ${e}.${n.id} = ${n.value}`);else if(s<r)this.common[n.id]=[n.value],this.commonOrigin[n.id]=s;else return ca(`Ignore native tag (list): ${e}.${n.id} = ${n.value}`);(i=this.opts)!=null&&i.observer&&this.opts.observer({metadata:this,tag:{type:"common",id:n.id,value:n.value}})}}function RQ(t){return t.length>2?`${t.slice(0,t.length-1).join(", ")} & ${t[t.length-1]}`:t.join(" & ")}class sr{constructor(){this.metadata=void 0,this.tokenizer=void 0,this.options=void 0}init(e,n,r){return this.metadata=e,this.tokenizer=n,this.options=r,this}}const AQ=/^[\x21-\x7e©][\x20-\x7e\x00()]{3}/,Je={len:4,get:(t,e)=>{const n=Hw(t.slice(e,e+Je.len),"latin1");if(!n.match(AQ))throw new Error(`FourCC contains invalid characters: ${sQ(n)} "${n}"`);return n},put:(t,e,n)=>{const r=NG(n);if(r.length!==4)throw new Error("Invalid length");return t.set(r,e),e+4}};var Po;(function(t){t[t.text_utf8=0]="text_utf8",t[t.binary=1]="binary",t[t.external_info=2]="external_info",t[t.reserved=3]="reserved"})(Po||(Po={}));const R2={len:52,get:(t,e)=>({ID:Je.get(t,e),version:J.get(t,e+4)/1e3,descriptorBytes:J.get(t,e+8),headerBytes:J.get(t,e+12),seekTableBytes:J.get(t,e+16),headerDataBytes:J.get(t,e+20),apeFrameDataBytes:J.get(t,e+24),apeFrameDataBytesHigh:J.get(t,e+28),terminatingDataBytes:J.get(t,e+32),fileMD5:new kn(16).get(t,e+36)})},NQ={len:24,get:(t,e)=>({compressionLevel:Le.get(t,e),formatFlags:Le.get(t,e+2),blocksPerFrame:J.get(t,e+4),finalFrameBlocks:J.get(t,e+8),totalFrames:J.get(t,e+12),bitsPerSample:Le.get(t,e+16),channel:Le.get(t,e+18),sampleRate:J.get(t,e+20)})},or={len:32,get:(t,e)=>({ID:new ne(8,"ascii").get(t,e),version:J.get(t,e+8),size:J.get(t,e+12),fields:J.get(t,e+16),flags:qA(J.get(t,e+20))})},Ig={len:8,get:(t,e)=>({size:J.get(t,e),flags:qA(J.get(t,e+4))})};function qA(t){return{containsHeader:Vd(t,31),containsFooter:Vd(t,30),isHeader:Vd(t,29),readOnly:Vd(t,0),dataType:(t&6)>>1}}function Vd(t,e){return(t&1<<e)!==0}const ua=Ue("music-metadata:parser:APEv2"),A2="APEv2",N2="APETAGEX";class rs extends sr{constructor(){super(...arguments),this.ape={}}static tryParseApeHeader(e,n,r){const s=new rs;return s.init(e,n,r),s.tryParseApeHeader()}static calculateDuration(e){let n=e.totalFrames>1?e.blocksPerFrame*(e.totalFrames-1):0;return n+=e.finalFrameBlocks,n/e.sampleRate}static async findApeFooterOffset(e,n){const r=new Uint8Array(or.len);await e.randomRead(r,0,or.len,n-or.len);const s=or.get(r,0);if(s.ID==="APETAGEX")return s.flags.isHeader?ua(`APE Header found at offset=${n-or.len}`):(ua(`APE Footer found at offset=${n-or.len}`),n-=s.size),{footer:s,offset:n}}static parseTagFooter(e,n,r){const s=or.get(n,n.length-or.len);if(s.ID!==N2)throw new Error("Unexpected APEv2 Footer ID preamble value.");ol(n);const i=new rs;return i.init(e,ol(n),r),i.parseTags(s)}async tryParseApeHeader(){if(this.tokenizer.fileInfo.size&&this.tokenizer.fileInfo.size-this.tokenizer.position<or.len){ua("No APEv2 header found, end-of-file reached");return}const e=await this.tokenizer.peekToken(or);if(e.ID===N2)return await this.tokenizer.ignore(or.len),this.parseTags(e);if(ua(`APEv2 header not found at offset=${this.tokenizer.position}`),this.tokenizer.fileInfo.size){const n=this.tokenizer.fileInfo.size-this.tokenizer.position,r=new Uint8Array(n);return await this.tokenizer.readBuffer(r),rs.parseTagFooter(this.metadata,r,this.options)}}async parse(){const e=await this.tokenizer.readToken(R2);if(e.ID!=="MAC ")throw new Error("Unexpected descriptor ID");this.ape.descriptor=e;const n=e.descriptorBytes-R2.len,r=await(n>0?this.parseDescriptorExpansion(n):this.parseHeader());return await this.tokenizer.ignore(r.forwardBytes),this.tryParseApeHeader()}async parseTags(e){const n=new Uint8Array(256);let r=e.size-or.len;ua(`Parse APE tags at offset=${this.tokenizer.position}, size=${r}`);for(let s=0;s<e.fields;s++){if(r<Ig.len){this.metadata.addWarning(`APEv2 Tag-header: ${e.fields-s} items remaining, but no more tag data to read.`);break}const i=await this.tokenizer.readToken(Ig);r-=Ig.len+i.size,await this.tokenizer.peekBuffer(n,{length:Math.min(n.length,r)});let o=$n(n,0,n.length);const l=await this.tokenizer.readToken(new ne(o,"ascii"));switch(await this.tokenizer.ignore(1),r-=l.length+1,i.flags.dataType){case Po.text_utf8:{const u=(await this.tokenizer.readToken(new ne(i.size,"utf8"))).split(/\x00/g);await Promise.all(u.map(d=>this.metadata.addTag(A2,l,d)));break}case Po.binary:if(this.options.skipCovers)await this.tokenizer.ignore(i.size);else{const c=new Uint8Array(i.size);await this.tokenizer.readBuffer(c),o=$n(c,0,c.length);const u=Hw(c.slice(0,o)),d=c.slice(o+1);await this.metadata.addTag(A2,l,{description:u,data:d})}break;case Po.external_info:ua(`Ignore external info ${l}`),await this.tokenizer.ignore(i.size);break;case Po.reserved:ua(`Ignore external info ${l}`),this.metadata.addWarning(`APEv2 header declares a reserved datatype for "${l}"`),await this.tokenizer.ignore(i.size);break}}}async parseDescriptorExpansion(e){return await this.tokenizer.ignore(e),this.parseHeader()}async parseHeader(){const e=await this.tokenizer.readToken(NQ);if(this.metadata.setFormat("lossless",!0),this.metadata.setFormat("container","Monkey's Audio"),this.metadata.setFormat("bitsPerSample",e.bitsPerSample),this.metadata.setFormat("sampleRate",e.sampleRate),this.metadata.setFormat("numberOfChannels",e.channel),this.metadata.setFormat("duration",rs.calculateDuration(e)),!this.ape.descriptor)throw new Error("Missing APE descriptor");return{forwardBytes:this.ape.descriptor.seekTableBytes+this.ape.descriptor.headerDataBytes+this.ape.descriptor.apeFrameDataBytes+this.ape.descriptor.terminatingDataBytes}}}const Hd=Ue("music-metadata:parser:ID3v1"),Nf=["Blues","Classic Rock","Country","Dance","Disco","Funk","Grunge","Hip-Hop","Jazz","Metal","New Age","Oldies","Other","Pop","R&B","Rap","Reggae","Rock","Techno","Industrial","Alternative","Ska","Death Metal","Pranks","Soundtrack","Euro-Techno","Ambient","Trip-Hop","Vocal","Jazz+Funk","Fusion","Trance","Classical","Instrumental","Acid","House","Game","Sound Clip","Gospel","Noise","Alt. Rock","Bass","Soul","Punk","Space","Meditative","Instrumental Pop","Instrumental Rock","Ethnic","Gothic","Darkwave","Techno-Industrial","Electronic","Pop-Folk","Eurodance","Dream","Southern Rock","Comedy","Cult","Gangsta Rap","Top 40","Christian Rap","Pop/Funk","Jungle","Native American","Cabaret","New Wave","Psychedelic","Rave","Showtunes","Trailer","Lo-Fi","Tribal","Acid Punk","Acid Jazz","Polka","Retro","Musical","Rock & Roll","Hard Rock","Folk","Folk/Rock","National Folk","Swing","Fast-Fusion","Bebob","Latin","Revival","Celtic","Bluegrass","Avantgarde","Gothic Rock","Progressive Rock","Psychedelic Rock","Symphonic Rock","Slow Rock","Big Band","Chorus","Easy Listening","Acoustic","Humour","Speech","Chanson","Opera","Chamber Music","Sonata","Symphony","Booty Bass","Primus","Porn Groove","Satire","Slow Jam","Club","Tango","Samba","Folklore","Ballad","Power Ballad","Rhythmic Soul","Freestyle","Duet","Punk Rock","Drum Solo","A Cappella","Euro-House","Dance Hall","Goa","Drum & Bass","Club-House","Hardcore","Terror","Indie","BritPop","Negerpunk","Polsk Punk","Beat","Christian Gangsta Rap","Heavy Metal","Black Metal","Crossover","Contemporary Christian","Christian Rock","Merengue","Salsa","Thrash Metal","Anime","JPop","Synthpop","Abstract","Art Rock","Baroque","Bhangra","Big Beat","Breakbeat","Chillout","Downtempo","Dub","EBM","Eclectic","Electro","Electroclash","Emo","Experimental","Garage","Global","IDM","Illbient","Industro-Goth","Jam Band","Krautrock","Leftfield","Lounge","Math Rock","New Romantic","Nu-Breakz","Post-Punk","Post-Rock","Psytrance","Shoegaze","Space Rock","Trop Rock","World Music","Neoclassical","Audiobook","Audio Theatre","Neue Deutsche Welle","Podcast","Indie Rock","G-Funk","Dubstep","Garage Rock","Psybient"],Wd={len:128,get:(t,e)=>{const n=new fo(3).get(t,e);return n==="TAG"?{header:n,title:new fo(30).get(t,e+3),artist:new fo(30).get(t,e+33),album:new fo(30).get(t,e+63),year:new fo(4).get(t,e+93),comment:new fo(28).get(t,e+97),zeroByte:ve.get(t,e+127),track:ve.get(t,e+126),genre:ve.get(t,e+127)}:null}};class fo{constructor(e){this.len=e,this.stringType=new ne(e,"latin1")}get(e,n){let r=this.stringType.get(e,n);return r=VA(r),r=r.trim(),r.length>0?r:void 0}}class Kw extends sr{static getGenre(e){if(e<Nf.length)return Nf[e]}async parse(){if(!this.tokenizer.fileInfo.size){Hd("Skip checking for ID3v1 because the file-size is unknown");return}if(this.options.apeHeader){this.tokenizer.ignore(this.options.apeHeader.offset-this.tokenizer.position);const r=new rs;r.init(this.metadata,this.tokenizer,this.options),await r.parseTags(this.options.apeHeader.footer)}const e=this.tokenizer.fileInfo.size-Wd.len;if(this.tokenizer.position>e){Hd("Already consumed the last 128 bytes");return}const n=await this.tokenizer.readToken(Wd,e);if(n){Hd("ID3v1 header found at: pos=%s",this.tokenizer.fileInfo.size-Wd.len);const r=["title","artist","album","comment","track","year"];for(const i of r)n[i]&&n[i]!==""&&await this.addTag(i,n[i]);const s=Kw.getGenre(n.genre);s&&await this.addTag("genre",s)}else Hd("ID3v1 header not found at: pos=%s",this.tokenizer.fileInfo.size-Wd.len)}async addTag(e,n){await this.metadata.addTag("ID3v1",e,n)}}const P2=Ue("music-metadata:id3v2:frame-parser"),Rr="latin1";function PQ(t){const e=[];let n,r="";for(const s of t)if(typeof n=="string")if(s==="("&&n==="")r+="(",n=void 0;else if(s===")"){r!==""&&(e.push(r),r="");const i=F2(n);i&&e.push(i),n=void 0}else n+=s;else s==="("?n="":r+=s;return r&&(e.length===0&&r.match(/^\d*$/)&&(r=F2(r)),r&&e.push(r)),e}function F2(t){if(t==="RX")return"Remix";if(t==="CR")return"Cover";if(t.match(/^\d*$/))return Nf[Number.parseInt(t)]}class Bn{constructor(e,n){this.major=e,this.warningCollector=n}readData(e,n,r){if(e.length===0){this.warningCollector.addWarning(`id3v2.${this.major} header has empty tag type=${n}`);return}const{encoding:s,bom:i}=WA.get(e,0),o=e.length;let l=0,c=[];const u=Bn.getNullTerminatorLength(s);let d;switch(P2(`Parsing tag type=${n}, encoding=${s}, bom=${i}`),n!=="TXXX"&&n[0]==="T"?"T*":n){case"T*":case"GRP1":case"IPLS":case"MVIN":case"MVNM":case"PCS":case"PCST":{let m;try{m=St(e.slice(1),s).replace(/\x00+$/,"")}catch(p){if(p instanceof Error){this.warningCollector.addWarning(`id3v2.${this.major} type=${n} header has invalid string value: ${p.message}`);break}throw p}switch(n){case"TMCL":case"TIPL":case"IPLS":c=Bn.functionList(this.splitValue(n,m));break;case"TRK":case"TRCK":case"TPOS":c=m;break;case"TCOM":case"TEXT":case"TOLY":case"TOPE":case"TPE1":case"TSRC":c=this.splitValue(n,m);break;case"TCO":case"TCON":c=this.splitValue(n,m).map(p=>PQ(p)).reduce((p,g)=>p.concat(g),[]);break;case"PCS":case"PCST":c=this.major>=4?this.splitValue(n,m):[m],c=Array.isArray(c)&&c[0]===""?1:0;break;default:c=this.major>=4?this.splitValue(n,m):[m]}break}case"TXXX":{const m=Bn.readIdentifierAndData(e,l+1,o,s);c={description:m.id,text:this.splitValue(n,St(m.data,s).replace(/\x00+$/,""))};break}case"PIC":case"APIC":if(r){const m={};switch(l+=1,this.major){case 2:m.format=St(e.slice(l,l+3),"latin1"),l+=3;break;case 3:case 4:d=$n(e,l,o,Rr),m.format=St(e.slice(l,d),Rr),l=d+1;break;default:throw new Error(`Warning: unexpected major versionIndex: ${this.major}`)}m.format=Bn.fixPictureMimeType(m.format),m.type=pu[e[l]],l+=1,d=$n(e,l,o,s),m.description=St(e.slice(l,d),s),l=d+u,m.data=e.slice(l,o),c=m}break;case"CNT":case"PCNT":c=re.get(e,0);break;case"SYLT":{const m=C2.get(e,0);l+=C2.len;const p={descriptor:"",language:m.language,contentType:m.contentType,timeStampFormat:m.timeStampFormat,syncText:[]};let g=!1;for(;l<o;){const y=Bn.readNullTerminatedString(e.subarray(l),m.encoding);if(l+=y.len,g){const w=re.get(e,l);l+=re.len,p.syncText.push({text:y.text,timestamp:w})}else p.descriptor=y.text,g=!0}c=p;break}case"ULT":case"USLT":case"COM":case"COMM":{const m=Ax.get(e,l);l+=Ax.len;const p=Bn.readNullTerminatedString(e.subarray(l),m.encoding);l+=p.len;const g=Bn.readNullTerminatedString(e.subarray(l),m.encoding);c={language:m.language,descriptor:p.text,text:g.text};break}case"UFID":{const m=Bn.readIdentifierAndData(e,l,o,Rr);c={owner_identifier:m.id,identifier:m.data};break}case"PRIV":{const m=Bn.readIdentifierAndData(e,l,o,Rr);c={owner_identifier:m.id,data:m.data};break}case"POPM":{d=$n(e,l,o,Rr);const m=St(e.slice(l,d),Rr);l=d+1;const p=o-l;c={email:m,rating:ve.get(e,l),counter:p>=5?re.get(e,l+1):void 0};break}case"GEOB":{d=$n(e,l+1,o,s);const m=St(e.slice(l+1,d),Rr);l=d+1,d=$n(e,l,o-l,s);const p=St(e.slice(l,d),Rr);l=d+1,d=$n(e,l,o-l,s);const g=St(e.slice(l,d),Rr);c={type:m,filename:p,description:g,data:e.slice(l+1,o)};break}case"WCOM":case"WCOP":case"WOAF":case"WOAR":case"WOAS":case"WORS":case"WPAY":case"WPUB":d=$n(e,l+1,o,s),c=St(e.slice(l,d),Rr);break;case"WXXX":{d=$n(e,l+1,o,s);const m=St(e.slice(l+1,d),s);l=d+(s==="utf-16le"?2:1),c={description:m,url:St(e.slice(l,o),Rr)};break}case"WFD":case"WFED":c=St(e.slice(l+1,$n(e,l+1,o,s)),s);break;case"MCDI":{c=e.slice(0,o);break}default:P2(`Warning: unsupported id3v2-tag-type: ${n}`);break}return c}static readNullTerminatedString(e,n){let r=n.bom?2:0;const s=$n(e,r,e.length,n.encoding),i=e.slice(r,s);return n.encoding==="utf-16le"?r=s+2:r=s+1,{text:St(i,n.encoding),len:r}}static fixPictureMimeType(e){switch(e=e.toLocaleLowerCase(),e){case"jpg":return"image/jpeg";case"png":return"image/png"}return e}static functionList(e){const n={};for(let r=0;r+1<e.length;r+=2){const s=e[r+1].split(",");n[e[r]]=n[e[r]]?n[e[r]].concat(s):s}return n}splitValue(e,n){let r;return this.major<4?(r=n.split(/\x00/g),r.length>1?this.warningCollector.addWarning(`ID3v2.${this.major} ${e} uses non standard null-separator.`):r=n.split(/\//g)):r=n.split(/\x00/g),Bn.trimArray(r)}static trimArray(e){return e.map(n=>n.replace(/\x00+$/,"").trim())}static readIdentifierAndData(e,n,r,s){const i=$n(e,n,r,s),o=St(e.slice(n,i),s);return n=i+Bn.getNullTerminatorLength(s),{id:o,data:e.slice(n,r)}}static getNullTerminatorLength(e){return e==="utf-16le"?2:1}}const D2=new TextDecoder("ascii");class Dr{constructor(){this.tokenizer=void 0,this.id3Header=void 0,this.metadata=void 0,this.headerType=void 0,this.options=void 0}static removeUnsyncBytes(e){let n=0,r=0;for(;n<e.length-1;)n!==r&&(e[r]=e[n]),n+=e[n]===255&&e[n+1]===0?2:1,r++;return n<e.length&&(e[r++]=e[n]),e.slice(0,r)}static getFrameHeaderLength(e){switch(e){case 2:return 6;case 3:case 4:return 10;default:throw new Error("header versionIndex is incorrect")}}static readFrameFlags(e){return{status:{tag_alter_preservation:lt(e,0,6),file_alter_preservation:lt(e,0,5),read_only:lt(e,0,4)},format:{grouping_identity:lt(e,1,7),compression:lt(e,1,3),encryption:lt(e,1,2),unsynchronisation:lt(e,1,1),data_length_indicator:lt(e,1,0)}}}static readFrameData(e,n,r,s,i){var l,c;const o=new Bn(r,i);switch(r){case 2:return o.readData(e,n.id,s);case 3:case 4:return(l=n.flags)!=null&&l.format.unsynchronisation&&(e=Dr.removeUnsyncBytes(e)),(c=n.flags)!=null&&c.format.data_length_indicator&&(e=e.slice(4,e.length)),o.readData(e,n.id,s);default:throw new Error(`Unexpected majorVer: ${r}`)}}static makeDescriptionTagName(e,n){return e+(n?`:${n}`:"")}async parse(e,n,r){this.tokenizer=n,this.metadata=e,this.options=r;const s=await this.tokenizer.readToken(Rx);if(s.fileIdentifier!=="ID3")throw new Error("expected ID3-header file-identifier 'ID3' was not found");return this.id3Header=s,this.headerType=`ID3v2.${s.version.major}`,s.flags.isExtendedHeader?this.parseExtendedHeader():this.parseId3Data(s.size)}async parseExtendedHeader(){const e=await this.tokenizer.readToken(I2),n=e.size-I2.len;return n>0?this.parseExtendedHeaderData(n,e.size):this.parseId3Data(this.id3Header.size-e.size)}async parseExtendedHeaderData(e,n){return await this.tokenizer.ignore(e),this.parseId3Data(this.id3Header.size-n)}async parseId3Data(e){const n=await this.tokenizer.readToken(new kn(e));for(const r of this.parseMetadata(n))switch(r.id){case"TXXX":r.value&&await this.handleTag(r,r.value.text,()=>r.value.description);break;default:await(Array.isArray(r.value)?Promise.all(r.value.map(s=>this.addTag(r.id,s))):this.addTag(r.id,r.value))}}async handleTag(e,n,r,s=i=>i){await Promise.all(n.map(i=>this.addTag(Dr.makeDescriptionTagName(e.id,r(i)),s(i))))}async addTag(e,n){await this.metadata.addTag(this.headerType,e,n)}parseMetadata(e){let n=0;const r=[];for(;n!==e.length;){const s=Dr.getFrameHeaderLength(this.id3Header.version.major);if(n+s>e.length){this.metadata.addWarning("Illegal ID3v2 tag length");break}const i=e.slice(n,n+s);n+=s;const o=this.readFrameHeader(i,this.id3Header.version.major),l=e.slice(n,n+o.length);n+=o.length;const c=Dr.readFrameData(l,o,this.id3Header.version.major,!this.options.skipCovers,this.metadata);c&&r.push({id:o.id,value:c})}return r}readFrameHeader(e,n){let r;switch(n){case 2:r={id:D2.decode(e.slice(0,3)),length:vn.get(e,3)},r.id.match(/[A-Z0-9]{3}/g)||this.metadata.addWarning(`Invalid ID3v2.${this.id3Header.version.major} frame-header-ID: ${r.id}`);break;case 3:case 4:r={id:D2.decode(e.slice(0,4)),length:(n===4?HA:re).get(e,4),flags:Dr.readFrameFlags(e.slice(8,10))},r.id.match(/[A-Z0-9]{4}/g)||this.metadata.addWarning(`Invalid ID3v2.${this.id3Header.version.major} frame-header-ID: ${r.id}`);break;default:throw new Error(`Unexpected majorVer: ${n}`)}return r}}const FQ={NONE:"not compressed	PCM	Apple Computer",sowt:"PCM (byte swapped)",fl32:"32-bit floating point IEEE 32-bit float",fl64:"64-bit floating point IEEE 64-bit float	Apple Computer",alaw:"ALaw 2:1	8-bit ITU-T G.711 A-law",ulaw:"µLaw 2:1	8-bit ITU-T G.711 µ-law	Apple Computer",ULAW:"CCITT G.711 u-law 8-bit ITU-T G.711 µ-law",ALAW:"CCITT G.711 A-law 8-bit ITU-T G.711 A-law",FL32:"Float 32	IEEE 32-bit float "};class DQ{constructor(e,n){this.isAifc=n;const r=n?22:18;if(e.chunkSize<r)throw new Error(`COMMON CHUNK size should always be at least ${r}`);this.len=e.chunkSize}get(e,n){const r=$e.get(e,n+8)-16398,s=$e.get(e,n+8+2),i={numChannels:$e.get(e,n),numSampleFrames:re.get(e,n+2),sampleSize:$e.get(e,n+6),sampleRate:r<0?s>>Math.abs(r):s<<r};if(this.isAifc){if(i.compressionType=Je.get(e,n+18),this.len>22){const o=ve.get(e,n+22);if(o>0){const l=(o+1)%2;if(23+o+l===this.len)i.compressionName=new ne(o,"latin1").get(e,n+23);else throw new Error("Illegal pstring length")}else i.compressionName=void 0}}else i.compressionName="PCM";return i}}const Cg={len:8,get:(t,e)=>({chunkID:Je.get(t,e),chunkSize:Number(BigInt(re.get(t,e+4)))})},jg=Ue("music-metadata:parser:aiff");class LQ extends sr{constructor(){super(...arguments),this.isCompressed=null}async parse(){if((await this.tokenizer.readToken(Cg)).chunkID!=="FORM")throw new Error("Invalid Chunk-ID, expected 'FORM'");const n=await this.tokenizer.readToken(Je);switch(n){case"AIFF":this.metadata.setFormat("container",n),this.isCompressed=!1;break;case"AIFC":this.metadata.setFormat("container","AIFF-C"),this.isCompressed=!0;break;default:throw new Error(`Unsupported AIFF type: ${n}`)}this.metadata.setFormat("lossless",!this.isCompressed);try{for(;!this.tokenizer.fileInfo.size||this.tokenizer.fileInfo.size-this.tokenizer.position>=Cg.len;){jg(`Reading AIFF chunk at offset=${this.tokenizer.position}`);const r=await this.tokenizer.readToken(Cg),s=2*Math.round(r.chunkSize/2),i=await this.readData(r);await this.tokenizer.ignore(s-i)}}catch(r){if(r instanceof pt)jg("End-of-stream");else throw r}}async readData(e){switch(e.chunkID){case"COMM":{if(this.isCompressed===null)throw new Error("Failed to parse AIFF.COMM chunk when compression type is unknown");const n=await this.tokenizer.readToken(new DQ(e,this.isCompressed));return this.metadata.setFormat("bitsPerSample",n.sampleSize),this.metadata.setFormat("sampleRate",n.sampleRate),this.metadata.setFormat("numberOfChannels",n.numChannels),this.metadata.setFormat("numberOfSamples",n.numSampleFrames),this.metadata.setFormat("duration",n.numSampleFrames/n.sampleRate),(n.compressionName||n.compressionType)&&this.metadata.setFormat("codec",n.compressionName??FQ[n.compressionType]),e.chunkSize}case"ID3 ":{const n=await this.tokenizer.readToken(new kn(e.chunkSize)),r=ol(n);return await new Dr().parse(this.metadata,r,this.options),e.chunkSize}case"SSND":return this.metadata.format.duration&&this.metadata.setFormat("bitrate",8*e.chunkSize/this.metadata.format.duration),0;case"NAME":case"AUTH":case"(c) ":case"ANNO":return this.readTextChunk(e);default:return jg(`Ignore chunk id=${e.chunkID}, size=${e.chunkSize}`),0}}async readTextChunk(e){const r=(await this.tokenizer.readToken(new ne(e.chunkSize,"ascii"))).split("\0").map(s=>s.trim()).filter(s=>s==null?void 0:s.length);return await Promise.all(r.map(s=>this.metadata.addTag("AIFF",e.chunkID,s))),e.chunkSize}}class ${static fromBin(e,n=0){return new $($.decode(e,n))}static decode(e,n=0){const r=new DataView(e.buffer,n);return`${r.getUint32(0,!0).toString(16)}-${r.getUint16(4,!0).toString(16)}-${r.getUint16(6,!0).toString(16)}-${r.getUint16(8).toString(16)}-${Ww(e.slice(n+10,n+16))}`.toUpperCase()}static decodeMediaType(e){switch(e.str){case $.AudioMedia.str:return"audio";case $.VideoMedia.str:return"video";case $.CommandMedia.str:return"command";case $.Degradable_JPEG_Media.str:return"degradable-jpeg";case $.FileTransferMedia.str:return"file-transfer";case $.BinaryMedia.str:return"binary"}}static encode(e){const n=new Uint8Array(16),r=new DataView(n.buffer);return r.setUint32(0,Number.parseInt(e.slice(0,8),16),!0),r.setUint16(4,Number.parseInt(e.slice(9,13),16),!0),r.setUint16(6,Number.parseInt(e.slice(14,18),16),!0),n.set(w2(e.slice(19,23)),8),n.set(w2(e.slice(24)),10),n}constructor(e){this.str=e}equals(e){return this.str===e.str}toBin(){return $.encode(this.str)}}$.HeaderObject=new $("75B22630-668E-11CF-A6D9-00AA0062CE6C");$.DataObject=new $("75B22636-668E-11CF-A6D9-00AA0062CE6C");$.SimpleIndexObject=new $("33000890-E5B1-11CF-89F4-00A0C90349CB");$.IndexObject=new $("D6E229D3-35DA-11D1-9034-00A0C90349BE");$.MediaObjectIndexObject=new $("FEB103F8-12AD-4C64-840F-2A1D2F7AD48C");$.TimecodeIndexObject=new $("3CB73FD0-0C4A-4803-953D-EDF7B6228F0C");$.FilePropertiesObject=new $("8CABDCA1-A947-11CF-8EE4-00C00C205365");$.StreamPropertiesObject=new $("B7DC0791-A9B7-11CF-8EE6-00C00C205365");$.HeaderExtensionObject=new $("5FBF03B5-A92E-11CF-8EE3-00C00C205365");$.CodecListObject=new $("86D15240-311D-11D0-A3A4-00A0C90348F6");$.ScriptCommandObject=new $("1EFB1A30-0B62-11D0-A39B-00A0C90348F6");$.MarkerObject=new $("F487CD01-A951-11CF-8EE6-00C00C205365");$.BitrateMutualExclusionObject=new $("D6E229DC-35DA-11D1-9034-00A0C90349BE");$.ErrorCorrectionObject=new $("75B22635-668E-11CF-A6D9-00AA0062CE6C");$.ContentDescriptionObject=new $("75B22633-668E-11CF-A6D9-00AA0062CE6C");$.ExtendedContentDescriptionObject=new $("D2D0A440-E307-11D2-97F0-00A0C95EA850");$.ContentBrandingObject=new $("2211B3FA-BD23-11D2-B4B7-00A0C955FC6E");$.StreamBitratePropertiesObject=new $("7BF875CE-468D-11D1-8D82-006097C9A2B2");$.ContentEncryptionObject=new $("2211B3FB-BD23-11D2-B4B7-00A0C955FC6E");$.ExtendedContentEncryptionObject=new $("298AE614-2622-4C17-B935-DAE07EE9289C");$.DigitalSignatureObject=new $("2211B3FC-BD23-11D2-B4B7-00A0C955FC6E");$.PaddingObject=new $("1806D474-CADF-4509-A4BA-9AABCB96AAE8");$.ExtendedStreamPropertiesObject=new $("14E6A5CB-C672-4332-8399-A96952065B5A");$.AdvancedMutualExclusionObject=new $("A08649CF-4775-4670-8A16-6E35357566CD");$.GroupMutualExclusionObject=new $("D1465A40-5A79-4338-B71B-E36B8FD6C249");$.StreamPrioritizationObject=new $("D4FED15B-88D3-454F-81F0-ED5C45999E24");$.BandwidthSharingObject=new $("A69609E6-517B-11D2-B6AF-00C04FD908E9");$.LanguageListObject=new $("7C4346A9-EFE0-4BFC-B229-393EDE415C85");$.MetadataObject=new $("C5F8CBEA-5BAF-4877-8467-AA8C44FA4CCA");$.MetadataLibraryObject=new $("44231C94-9498-49D1-A141-1D134E457054");$.IndexParametersObject=new $("D6E229DF-35DA-11D1-9034-00A0C90349BE");$.MediaObjectIndexParametersObject=new $("6B203BAD-3F11-48E4-ACA8-D7613DE2CFA7");$.TimecodeIndexParametersObject=new $("F55E496D-9797-4B5D-8C8B-604DFE9BFB24");$.CompatibilityObject=new $("26F18B5D-4584-47EC-9F5F-0E651F0452C9");$.AdvancedContentEncryptionObject=new $("43058533-6981-49E6-9B74-AD12CB86D58C");$.AudioMedia=new $("F8699E40-5B4D-11CF-A8FD-00805F5C442B");$.VideoMedia=new $("BC19EFC0-5B4D-11CF-A8FD-00805F5C442B");$.CommandMedia=new $("59DACFC0-59E6-11D0-A3AC-00A0C90348F6");$.JFIF_Media=new $("B61BE100-5B4E-11CF-A8FD-00805F5C442B");$.Degradable_JPEG_Media=new $("35907DE0-E415-11CF-A917-00805F5C442B");$.FileTransferMedia=new $("91BD222C-F21C-497A-8B6D-5AA86BFC0185");$.BinaryMedia=new $("3AFB65E2-47EF-40F2-AC2C-70A90D71D343");$.ASF_Index_Placeholder_Object=new $("D9AADE20-7C17-4F9C-BC28-8555DD98E2A2");function MQ(t){return OQ[t]}function Jm(t){return bi(St(t,"utf-16le"))}const OQ=[Jm,L2,$Q,BQ,zQ,GA,L2];function L2(t){return new Uint8Array(t)}function $Q(t,e=0){return GA(t,e)===1}function BQ(t,e=0){return J.get(t,e)}function zQ(t,e=0){return fn.get(t,e)}function GA(t,e=0){return Le.get(t,e)}var M2;(function(t){t[t.UnicodeString=0]="UnicodeString",t[t.ByteArray=1]="ByteArray",t[t.Bool=2]="Bool",t[t.DWord=3]="DWord",t[t.QWord=4]="QWord",t[t.Word=5]="Word"})(M2||(M2={}));const UQ={len:30,get:(t,e)=>({objectId:$.fromBin(t,e),objectSize:Number(fn.get(t,e+16)),numberOfHeaderObjects:J.get(t,e+24)})},xa={len:24,get:(t,e)=>({objectId:$.fromBin(t,e),objectSize:Number(fn.get(t,e+16))})};class io{constructor(e){this.len=Number(e.objectSize)-xa.len}postProcessTag(e,n,r,s){if(n==="WM/Picture")e.push({id:n,value:Xw.fromBuffer(s)});else{const i=MQ(r);if(!i)throw new Error(`unexpected value headerType: ${r}`);e.push({id:n,value:i(s)})}}}class O2 extends io{get(e,n){return null}}class Nx extends io{get(e,n){return{fileId:$.fromBin(e,n),fileSize:fn.get(e,n+16),creationDate:fn.get(e,n+24),dataPacketsCount:fn.get(e,n+32),playDuration:fn.get(e,n+40),sendDuration:fn.get(e,n+48),preroll:fn.get(e,n+56),flags:{broadcast:lt(e,n+64,24),seekable:lt(e,n+64,25)},minimumDataPacketSize:J.get(e,n+68),maximumDataPacketSize:J.get(e,n+72),maximumBitrate:J.get(e,n+76)}}}Nx.guid=$.FilePropertiesObject;class Px extends io{get(e,n){return{streamType:$.decodeMediaType($.fromBin(e,n)),errorCorrectionType:$.fromBin(e,n+8)}}}Px.guid=$.StreamPropertiesObject;class Fx{constructor(){this.len=22}get(e,n){const r=new DataView(e.buffer,n);return{reserved1:$.fromBin(e,n),reserved2:r.getUint16(16,!0),extensionDataSize:r.getUint16(18,!0)}}}Fx.guid=$.HeaderExtensionObject;const VQ={len:20,get:(t,e)=>({entryCount:new DataView(t.buffer,e).getUint16(16,!0)})};async function $2(t){const e=await t.readNumber(Le);return(await t.readToken(new ne(e*2,"utf-16le"))).replace("\0","")}async function HQ(t){const e=await t.readToken(VQ),n=[];for(let r=0;r<e.entryCount;++r)n.push(await qQ(t));return n}async function WQ(t){const e=await t.readNumber(Le),n=new Uint8Array(e);return await t.readBuffer(n),n}async function qQ(t){const e=await t.readNumber(Le);return{type:{videoCodec:(e&1)===1,audioCodec:(e&2)===2},codecName:await $2(t),description:await $2(t),information:await WQ(t)}}class Ga extends io{get(e,n){const r=[],s=new DataView(e.buffer,n);let i=10;for(let o=0;o<Ga.contentDescTags.length;++o){const l=s.getUint16(o*2,!0);if(l>0){const c=Ga.contentDescTags[o],u=i+l;r.push({id:c,value:Jm(e.slice(n+i,n+u))}),i=u}}return r}}Ga.guid=$.ContentDescriptionObject;Ga.contentDescTags=["Title","Author","Copyright","Description","Rating"];class Dx extends io{get(e,n){const r=[],s=new DataView(e.buffer,n),i=s.getUint16(0,!0);let o=2;for(let l=0;l<i;l+=1){const c=s.getUint16(o,!0);o+=2;const u=Jm(e.slice(n+o,n+o+c));o+=c;const d=s.getUint16(o,!0);o+=2;const m=s.getUint16(o,!0);o+=2;const p=e.slice(n+o,n+o+m);o+=m,this.postProcessTag(r,u,d,p)}return r}}Dx.guid=$.ExtendedContentDescriptionObject;class Lx extends io{get(e,n){const r=new DataView(e.buffer,n);return{startTime:fn.get(e,n),endTime:fn.get(e,n+8),dataBitrate:r.getInt32(12,!0),bufferSize:r.getInt32(16,!0),initialBufferFullness:r.getInt32(20,!0),alternateDataBitrate:r.getInt32(24,!0),alternateBufferSize:r.getInt32(28,!0),alternateInitialBufferFullness:r.getInt32(32,!0),maximumObjectSize:r.getInt32(36,!0),flags:{reliableFlag:lt(e,n+40,0),seekableFlag:lt(e,n+40,1),resendLiveCleanpointsFlag:lt(e,n+40,2)},streamNumber:r.getInt16(42,!0),streamLanguageId:r.getInt16(44,!0),averageTimePerFrame:r.getInt32(52,!0),streamNameCount:r.getInt32(54,!0),payloadExtensionSystems:r.getInt32(56,!0),streamNames:[],streamPropertiesObject:null}}}Lx.guid=$.ExtendedStreamPropertiesObject;class Pf extends io{get(e,n){const r=[],s=new DataView(e.buffer,n),i=s.getUint16(0,!0);let o=2;for(let l=0;l<i;l+=1){o+=4;const c=s.getUint16(o,!0);o+=2;const u=s.getUint16(o,!0);o+=2;const d=s.getUint32(o,!0);o+=4;const m=Jm(e.slice(n+o,n+o+c));o+=c;const p=e.slice(n+o,n+o+d);o+=d,this.postProcessTag(r,m,u,p)}return r}}Pf.guid=$.MetadataObject;class Mx extends Pf{}Mx.guid=$.MetadataLibraryObject;class Xw{static fromBuffer(e){return new Xw(e.length).get(e,0)}constructor(e){this.len=e}get(e,n){const r=new DataView(e.buffer,n),s=r.getUint8(0),i=r.getInt32(1,!0);let o=5;for(;r.getUint16(o)!==0;)o+=2;const l=new ne(o-5,"utf-16le").get(e,5);for(;r.getUint16(o)!==0;)o+=2;const c=new ne(o-5,"utf-16le").get(e,5);return{type:pu[s],format:l,description:c,size:i,data:e.slice(o+4)}}}const qd=Ue("music-metadata:parser:ASF"),GQ="asf";class QQ extends sr{async parse(){const e=await this.tokenizer.readToken(UQ);if(!e.objectId.equals($.HeaderObject))throw new Error(`expected asf header; but was not found; got: ${e.objectId.str}`);try{await this.parseObjectHeader(e.numberOfHeaderObjects)}catch(n){qd("Error while parsing ASF: %s",n)}}async parseObjectHeader(e){let n;do{const r=await this.tokenizer.readToken(xa);switch(qd("header GUID=%s",r.objectId.str),r.objectId.str){case Nx.guid.str:{const s=await this.tokenizer.readToken(new Nx(r));this.metadata.setFormat("duration",Number(s.playDuration/BigInt(1e3))/1e4-Number(s.preroll)/1e3),this.metadata.setFormat("bitrate",s.maximumBitrate);break}case Px.guid.str:{const s=await this.tokenizer.readToken(new Px(r));this.metadata.setFormat("container",`ASF/${s.streamType}`);break}case Fx.guid.str:{const s=await this.tokenizer.readToken(new Fx);await this.parseExtensionObject(s.extensionDataSize);break}case Ga.guid.str:n=await this.tokenizer.readToken(new Ga(r)),await this.addTags(n);break;case Dx.guid.str:n=await this.tokenizer.readToken(new Dx(r)),await this.addTags(n);break;case $.CodecListObject.str:{const s=await HQ(this.tokenizer);s.forEach(o=>{this.metadata.addStreamInfo({type:o.type.videoCodec?qa.video:qa.audio,codecName:o.codecName})});const i=s.filter(o=>o.type.audioCodec).map(o=>o.codecName).join("/");this.metadata.setFormat("codec",i);break}case $.StreamBitratePropertiesObject.str:await this.tokenizer.ignore(r.objectSize-xa.len);break;case $.PaddingObject.str:qd("Padding: %s bytes",r.objectSize-xa.len),await this.tokenizer.ignore(r.objectSize-xa.len);break;default:this.metadata.addWarning(`Ignore ASF-Object-GUID: ${r.objectId.str}`),qd("Ignore ASF-Object-GUID: %s",r.objectId.str),await this.tokenizer.readToken(new O2(r))}}while(--e)}async addTags(e){await Promise.all(e.map(({id:n,value:r})=>this.metadata.addTag(GQ,n,r)))}async parseExtensionObject(e){do{const n=await this.tokenizer.readToken(xa),r=n.objectSize-xa.len;switch(n.objectId.str){case Lx.guid.str:await this.tokenizer.readToken(new Lx(n));break;case Pf.guid.str:{const s=await this.tokenizer.readToken(new Pf(n));await this.addTags(s);break}case Mx.guid.str:{const s=await this.tokenizer.readToken(new Mx(n));await this.addTags(s);break}case $.PaddingObject.str:await this.tokenizer.ignore(r);break;case $.CompatibilityObject.str:this.tokenizer.ignore(r);break;case $.ASF_Index_Placeholder_Object.str:await this.tokenizer.ignore(r);break;default:this.metadata.addWarning(`Ignore ASF-Object-GUID: ${n.objectId.str}`),await this.tokenizer.readToken(new O2(n));break}e-=n.objectSize}while(e>0)}}class gu{static fromBase64(e){return gu.fromBuffer(Uint8Array.from(atob(e),n=>n.charCodeAt(0)))}static fromBuffer(e){return new gu(e.length).get(e,0)}constructor(e){this.len=e}get(e,n){const r=pu[re.get(e,n)];n+=4;const s=re.get(e,n);n+=4;const i=new ne(s,"utf-8").get(e,n);n+=s;const o=re.get(e,n);n+=4;const l=new ne(o,"utf-8").get(e,n);n+=o;const c=re.get(e,n);n+=4;const u=re.get(e,n);n+=4;const d=re.get(e,n);n+=4;const m=re.get(e,n);n+=4;const p=re.get(e,n);n+=4;const g=Uint8Array.from(e.slice(n,n+p));return{type:r,format:i,description:l,width:c,height:u,colour_depth:d,indexed_color:m,data:g}}}const Gd={len:7,get:(t,e)=>({packetType:ve.get(t,e),vorbis:new ne(6,"ascii").get(t,e+1)})},KQ={len:23,get:(t,e)=>({version:J.get(t,e+0),channelMode:ve.get(t,e+4),sampleRate:J.get(t,e+5),bitrateMax:J.get(t,e+9),bitrateNominal:J.get(t,e+13),bitrateMin:J.get(t,e+17)})},Rg=Ue("music-metadata:parser:ID3");class Zm extends sr{constructor(){super(...arguments),this.id3parser=new Dr}static async startsWithID3v2Header(e){return(await e.peekToken(Rx)).fileIdentifier==="ID3"}async parse(){try{await this.parseID3v2()}catch(e){if(e instanceof pt)Rg("End-of-stream");else throw e}}finalize(){}async parseID3v2(){await this.tryReadId3v2Headers(),Rg("End of ID3v2 header, go to MPEG-parser: pos=%s",this.tokenizer.position),await this.postId3v2Parse(),this.options.skipPostHeaders&&this.metadata.hasAny()?this.finalize():(await new Kw().init(this.metadata,this.tokenizer,this.options).parse(),this.finalize())}async tryReadId3v2Headers(){if((await this.tokenizer.peekToken(Rx)).fileIdentifier==="ID3")return Rg("Found ID3v2 header, pos=%s",this.tokenizer.position),await this.id3parser.parse(this.metadata,this.tokenizer,this.options),this.tryReadId3v2Headers()}}class QA{constructor(e,n){this.data=e,this.offset=n}readInt32(){const e=J.get(this.data,this.offset);return this.offset+=4,e}readStringUtf8(){const e=this.readInt32(),n=new TextDecoder("utf-8").decode(this.data.subarray(this.offset,this.offset+e));return this.offset+=e,n}parseUserComment(){const e=this.offset,n=this.readStringUtf8(),r=n.indexOf("=");return{key:n.slice(0,r).toUpperCase(),value:n.slice(r+1),len:this.offset-e}}}const mo=Ue("music-metadata:parser:ogg:vorbis1");class Qa{constructor(e,n){this.metadata=e,this.options=n,this.pageSegments=[]}async parsePage(e,n){if(e.headerType.firstPage)this.parseFirstPage(e,n);else{if(e.headerType.continued){if(this.pageSegments.length===0)throw new Error("Cannot continue on previous page");this.pageSegments.push(n)}if(e.headerType.lastPage||!e.headerType.continued){if(this.pageSegments.length>0){const r=Qa.mergeUint8Arrays(this.pageSegments);await this.parseFullPage(r)}this.pageSegments=e.headerType.lastPage?[]:[n]}}e.headerType.lastPage&&this.calculateDuration(e)}static mergeUint8Arrays(e){const n=e.reduce((s,i)=>s+i.length,0),r=new Uint8Array(n);return e.forEach((s,i,o)=>{const l=o.slice(0,i).reduce((c,u)=>c+u.length,0);r.set(s,l)}),r}async flush(){await this.parseFullPage(Qa.mergeUint8Arrays(this.pageSegments))}async parseUserComment(e,n){const s=new QA(e,n).parseUserComment();return await this.addTag(s.key,s.value),s.len}async addTag(e,n){if(e==="METADATA_BLOCK_PICTURE"&&typeof n=="string"){if(this.options.skipCovers){mo("Ignore picture");return}n=gu.fromBase64(n),mo(`Push picture: id=${e}, format=${n.format}`)}else mo(`Push tag: id=${e}, value=${n}`);await this.metadata.addTag("vorbis",e,n)}calculateDuration(e){this.metadata.format.sampleRate&&e.absoluteGranulePosition>=0&&(this.metadata.setFormat("numberOfSamples",e.absoluteGranulePosition),this.metadata.setFormat("duration",e.absoluteGranulePosition/this.metadata.format.sampleRate))}parseFirstPage(e,n){this.metadata.setFormat("codec","Vorbis I"),mo("Parse first page");const r=Gd.get(n,0);if(r.vorbis!=="vorbis")throw new Error("Metadata does not look like Vorbis");if(r.packetType===1){const s=KQ.get(n,Gd.len);this.metadata.setFormat("sampleRate",s.sampleRate),this.metadata.setFormat("bitrate",s.bitrateNominal),this.metadata.setFormat("numberOfChannels",s.channelMode),mo("sample-rate=%s[hz], bitrate=%s[b/s], channel-mode=%s",s.sampleRate,s.bitrateNominal,s.channelMode)}else throw new Error("First Ogg page should be type 1: the identification header")}async parseFullPage(e){const n=Gd.get(e,0);switch(mo("Parse full page: type=%s, byteLength=%s",n.packetType,e.byteLength),n.packetType){case 3:return this.parseUserCommentList(e,Gd.len)}}async parseUserCommentList(e,n){const r=J.get(e,n);n+=4,n+=r;let s=J.get(e,n);for(n+=4;s-- >0;)n+=await this.parseUserComment(e,n)}}const XQ=Ue("music-metadata:parser:FLAC");var Es;(function(t){t[t.STREAMINFO=0]="STREAMINFO",t[t.PADDING=1]="PADDING",t[t.APPLICATION=2]="APPLICATION",t[t.SEEKTABLE=3]="SEEKTABLE",t[t.VORBIS_COMMENT=4]="VORBIS_COMMENT",t[t.CUESHEET=5]="CUESHEET",t[t.PICTURE=6]="PICTURE"})(Es||(Es={}));class YQ extends Zm{constructor(){super(...arguments),this.padding=0}init(e,n,r){return super.init(e,n,r),this.vorbisParser=new Qa(e,r),this}async postId3v2Parse(){if((await this.tokenizer.readToken(Je)).toString()!=="fLaC")throw new Error("Invalid FLAC preamble");let n;do n=await this.tokenizer.readToken(JQ),await this.parseDataBlock(n);while(!n.lastBlock);if(this.tokenizer.fileInfo.size&&this.metadata.format.duration){const r=this.tokenizer.fileInfo.size-this.tokenizer.position;this.metadata.setFormat("bitrate",8*r/this.metadata.format.duration)}}async parseDataBlock(e){switch(XQ(`blockHeader type=${e.type}, length=${e.length}`),e.type){case Es.STREAMINFO:return this.parseBlockStreamInfo(e.length);case Es.PADDING:this.padding+=e.length;break;case Es.APPLICATION:break;case Es.SEEKTABLE:break;case Es.VORBIS_COMMENT:return this.parseComment(e.length);case Es.CUESHEET:break;case Es.PICTURE:await this.parsePicture(e.length);return;default:this.metadata.addWarning(`Unknown block type: ${e.type}`)}return this.tokenizer.ignore(e.length).then()}async parseBlockStreamInfo(e){if(e!==B2.len)throw new Error("Unexpected block-stream-info length");const n=await this.tokenizer.readToken(B2);this.metadata.setFormat("container","FLAC"),this.metadata.setFormat("codec","FLAC"),this.metadata.setFormat("lossless",!0),this.metadata.setFormat("numberOfChannels",n.channels),this.metadata.setFormat("bitsPerSample",n.bitsPerSample),this.metadata.setFormat("sampleRate",n.sampleRate),n.totalSamples>0&&this.metadata.setFormat("duration",n.totalSamples/n.sampleRate)}async parseComment(e){const n=await this.tokenizer.readToken(new kn(e)),r=new QA(n,0);r.readStringUtf8();const s=r.readInt32(),i=new Array(s);for(let o=0;o<s;o++)i[o]=r.parseUserComment();await Promise.all(i.map(o=>this.vorbisParser.addTag(o.key,o.value)))}async parsePicture(e){if(this.options.skipCovers)return this.tokenizer.ignore(e);const n=await this.tokenizer.readToken(new gu(e));this.vorbisParser.addTag("METADATA_BLOCK_PICTURE",n)}}const JQ={len:4,get:(t,e)=>({lastBlock:lt(t,e,7),type:je(t,e,1,7),length:vn.get(t,e+1)})},B2={len:34,get:(t,e)=>({minimumBlockSize:$e.get(t,e),maximumBlockSize:$e.get(t,e+2)/1e3,minimumFrameSize:vn.get(t,e+4),maximumFrameSize:vn.get(t,e+7),sampleRate:vn.get(t,e+10)>>4,channels:je(t,e+12,4,3)+1,bitsPerSample:je(t,e+12,7,5)+1,totalSamples:je(t,e+13,4,36),fileMD5:new kn(16).get(t,e+18)})},KA=Ue("music-metadata:parser:MP4:atom"),Ff={len:8,get:(t,e)=>{const n=re.get(t,e);if(n<0)throw new Error("Invalid atom header length");return{length:BigInt(n),name:new ne(4,"latin1").get(t,e+4)}},put:(t,e,n)=>(re.put(t,e,Number(n.length)),Je.put(t,e+4,n.name))},ZQ=Vw,z2={len:4,get:(t,e)=>({type:new ne(4,"ascii").get(t,e)})};class XA{constructor(e,n,r){if(this.len=e,e<n)throw new Error(`Atom ${r} expected to be ${n}, but specifies ${e} bytes long.`);e>n&&KA(`Warning: atom ${r} expected to be ${n}, but was actually ${e} bytes long.`)}}const ll={len:4,get:(t,e)=>{const n=re.get(t,e)-2082844800;return new Date(n*1e3)}};class eK extends XA{constructor(e){super(e,24,"mdhd"),this.len=e}get(e,n){return{version:ve.get(e,n+0),flags:vn.get(e,n+1),creationTime:ll.get(e,n+4),modificationTime:ll.get(e,n+8),timeScale:re.get(e,n+12),duration:re.get(e,n+16),language:$e.get(e,n+20),quality:$e.get(e,n+22)}}}class tK extends XA{constructor(e){super(e,100,"mvhd"),this.len=e}get(e,n){return{version:ve.get(e,n),flags:vn.get(e,n+1),creationTime:ll.get(e,n+4),modificationTime:ll.get(e,n+8),timeScale:re.get(e,n+12),duration:re.get(e,n+16),preferredRate:re.get(e,n+20),preferredVolume:$e.get(e,n+24),previewTime:re.get(e,n+72),previewDuration:re.get(e,n+76),posterTime:re.get(e,n+80),selectionTime:re.get(e,n+84),selectionDuration:re.get(e,n+88),currentTime:re.get(e,n+92),nextTrackID:re.get(e,n+96)}}}class nK{constructor(e){this.len=e}get(e,n){return{type:{set:ve.get(e,n+0),type:vn.get(e,n+1)},locale:vn.get(e,n+4),value:new kn(this.len-8).get(e,n+8)}}}class rK{constructor(e){this.len=e}get(e,n){return{version:ve.get(e,n),flags:vn.get(e,n+1),name:new ne(this.len-4,"utf-8").get(e,n+4)}}}class sK{constructor(e){this.len=e}get(e,n){return{version:ve.get(e,n),flags:vn.get(e,n+1),creationTime:ll.get(e,n+4),modificationTime:ll.get(e,n+8),trackId:re.get(e,n+12),duration:re.get(e,n+20),layer:$e.get(e,n+24),alternateGroup:$e.get(e,n+26),volume:$e.get(e,n+28)}}}const U2={len:8,get:(t,e)=>({version:ve.get(t,e),flags:vn.get(t,e+1),numberOfEntries:re.get(t,e+4)})};class iK{constructor(e){this.len=e}get(e,n){return{dataFormat:Je.get(e,n),dataReferenceIndex:$e.get(e,n+10),description:new kn(this.len-12).get(e,n+12)}}}class aK{constructor(e){this.len=e}get(e,n){const r=U2.get(e,n);n+=U2.len;const s=[];for(let i=0;i<r.numberOfEntries;++i){const o=re.get(e,n);n+=re.len,s.push(new iK(o).get(e,n)),n+=o}return{header:r,table:s}}}const V2={len:8,get(t,e){return{version:Ps.get(t,e),revision:Ps.get(t,e+2),vendor:Yn.get(t,e+4)}}},oK={len:12,get(t,e){return{numAudioChannels:Ps.get(t,e+0),sampleSize:Ps.get(t,e+2),compressionId:Ps.get(t,e+4),packetSize:Ps.get(t,e+6),sampleRate:$e.get(t,e+8)+$e.get(t,e+10)/1e4}}};class Yw{constructor(e,n){this.len=e,this.token=n}get(e,n){const r=Yn.get(e,n+4);return{version:mu.get(e,n+0),flags:Uw.get(e,n+1),numberOfEntries:r,entries:YA(e,this.token,n+8,this.len-8,r)}}}const lK={len:8,get(t,e){return{count:Yn.get(t,e+0),duration:Yn.get(t,e+4)}}};class cK extends Yw{constructor(e){super(e,lK),this.len=e}}const uK={len:12,get(t,e){return{firstChunk:Yn.get(t,e),samplesPerChunk:Yn.get(t,e+4),sampleDescriptionId:Yn.get(t,e+8)}}};class dK extends Yw{constructor(e){super(e,uK),this.len=e}}class hK{constructor(e){this.len=e}get(e,n){const r=Yn.get(e,n+8);return{version:mu.get(e,n),flags:Uw.get(e,n+1),sampleSize:Yn.get(e,n+4),numberOfEntries:r,entries:YA(e,Yn,n+12,this.len-12,r)}}}class fK extends Yw{constructor(e){super(e,Yn),this.len=e}}class mK{constructor(e){this.len=e}get(e,n){const r=Ps.get(e,n+0);return new ne(r,"utf-8").get(e,n+2)}}function YA(t,e,n,r,s){if(KA(`remainingLen=${r}, numberOfEntries=${s} * token-len=${e.len}`),r===0)return[];if(r!==s*e.len)throw new Error("mismatch number-of-entries with remaining atom-length");const i=[];for(let o=0;o<s;++o)i.push(e.get(t,n)),n+=e.len;return i}const pK=Ue("music-metadata:parser:MP4:Atom");class Df{static async readAtom(e,n,r,s){const i=e.position,o=await e.readToken(Ff);o.length===BigInt(1)&&(o.length=await e.readToken(ZQ));const c=new Df(o,o.length===BigInt(1),r),u=c.getPayloadLength(s);return pK(`parse atom name=${c.atomPath}, extended=${c.extended}, offset=${i}, len=${c.header.length}`),await c.readData(e,n,u),c}constructor(e,n,r){this.header=e,this.extended=n,this.parent=r,this.children=[],this.atomPath=(this.parent?`${this.parent.atomPath}.`:"")+this.header.name}getHeaderLength(){return this.extended?16:8}getPayloadLength(e){return(this.header.length===BigInt(0)?e:Number(this.header.length))-this.getHeaderLength()}async readAtoms(e,n,r){for(;r>0;){const s=await Df.readAtom(e,n,this,r);this.children.push(s),r-=s.header.length===BigInt(0)?r:Number(s.header.length)}}async readData(e,n,r){switch(this.header.name){case"moov":case"udta":case"trak":case"mdia":case"minf":case"stbl":case"<id>":case"ilst":case"tref":return this.readAtoms(e,n,this.getPayloadLength(r));case"meta":{const i=(await e.peekToken(Ff)).name==="hdlr"?0:4;return await e.ignore(i),this.readAtoms(e,n,this.getPayloadLength(r)-i)}default:return n(this,r)}}}const Yr=Ue("music-metadata:parser:MP4"),gK="iTunes",H2={raw:{lossy:!1,format:"raw"},MAC3:{lossy:!0,format:"MACE 3:1"},MAC6:{lossy:!0,format:"MACE 6:1"},ima4:{lossy:!0,format:"IMA 4:1"},ulaw:{lossy:!0,format:"uLaw 2:1"},alaw:{lossy:!0,format:"uLaw 2:1"},Qclp:{lossy:!0,format:"QUALCOMM PureVoice"},".mp3":{lossy:!0,format:"MPEG-1 layer 3"},alac:{lossy:!1,format:"ALAC"},"ac-3":{lossy:!0,format:"AC-3"},mp4a:{lossy:!0,format:"MPEG-4/AAC"},mp4s:{lossy:!0,format:"MP4S"},c608:{lossy:!0,format:"CEA-608"},c708:{lossy:!0,format:"CEA-708"}};function W2(t,e,n){return n.indexOf(t)===e}class Lf extends sr{constructor(){super(...arguments),this.tracks=[],this.atomParsers={mvhd:async e=>{const n=await this.tokenizer.readToken(new tK(e));this.metadata.setFormat("creationTime",n.creationTime),this.metadata.setFormat("modificationTime",n.modificationTime)},mdhd:async e=>{const n=await this.tokenizer.readToken(new eK(e)),r=this.getTrackDescription();r.creationTime=n.creationTime,r.modificationTime=n.modificationTime,r.timeScale=n.timeScale,r.duration=n.duration},chap:async e=>{const n=this.getTrackDescription(),r=[];for(;e>=re.len;)r.push(await this.tokenizer.readNumber(re)),e-=re.len;n.chapterList=r},tkhd:async e=>{const n=await this.tokenizer.readToken(new sK(e));this.tracks.push(n)},mdat:async e=>{if(this.audioLengthInBytes=e,this.calculateBitRate(),this.options.includeChapters){const n=this.tracks.filter(r=>r.chapterList);if(n.length===1){const r=n[0].chapterList,s=this.tracks.filter(i=>r.indexOf(i.trackId)!==-1);if(s.length===1)return this.parseChapterTrack(s[0],n[0],e)}}await this.tokenizer.ignore(e)},ftyp:async e=>{const n=[];for(;e>0;){const s=await this.tokenizer.readToken(z2);e-=z2.len;const i=s.type.replace(/\W/g,"");i.length>0&&n.push(i)}Yr(`ftyp: ${n.join("/")}`);const r=n.filter(W2).join("/");this.metadata.setFormat("container",r)},stsd:async e=>{const n=await this.tokenizer.readToken(new aK(e)),r=this.getTrackDescription();r.soundSampleDescription=n.table.map(s=>this.parseSoundSampleDescription(s))},stsc:async e=>{const n=await this.tokenizer.readToken(new dK(e));this.getTrackDescription().sampleToChunkTable=n.entries},stts:async e=>{const n=await this.tokenizer.readToken(new cK(e));this.getTrackDescription().timeToSampleTable=n.entries},stsz:async e=>{const n=await this.tokenizer.readToken(new hK(e)),r=this.getTrackDescription();r.sampleSize=n.sampleSize,r.sampleSizeTable=n.entries},stco:async e=>{const n=await this.tokenizer.readToken(new fK(e));this.getTrackDescription().chunkOffsetTable=n.entries},date:async e=>{const n=await this.tokenizer.readToken(new ne(e,"utf-8"));await this.addTag("date",n)}}}static read_BE_Integer(e,n){const r=(n?"INT":"UINT")+e.length*8+(e.length>1?"_BE":""),s=SG[r];if(!s)throw new Error(`Token for integer type not found: "${r}"`);return Number(s.get(e,0))}async parse(){this.tracks=[];let e=this.tokenizer.fileInfo.size||0;for(;!this.tokenizer.fileInfo.size||e>0;){try{if((await this.tokenizer.peekToken(Ff)).name==="\0\0\0\0"){const o=`Error at offset=${this.tokenizer.position}: box.id=0`;Yr(o),this.addWarning(o);break}}catch(i){if(i instanceof Error){const o=`Error at offset=${this.tokenizer.position}: ${i.message}`;Yr(o),this.addWarning(o)}else throw i;break}const s=await Df.readAtom(this.tokenizer,(i,o)=>this.handleAtom(i,o),null,e);e-=s.header.length===BigInt(0)?e:Number(s.header.length)}const n=[];this.tracks.forEach(s=>{const i=[];s.soundSampleDescription.forEach(o=>{const l={},c=H2[o.dataFormat];if(c?(i.push(c.format),l.codecName=c.format):l.codecName=`<${o.dataFormat}>`,o.description){const{description:u}=o;u.sampleRate>0&&(l.type=qa.audio,l.audio={samplingFrequency:u.sampleRate,bitDepth:u.sampleSize,channels:u.numAudioChannels})}this.metadata.addStreamInfo(l)}),i.length>=1&&n.push(i.join("/"))}),n.length>0&&this.metadata.setFormat("codec",n.filter(W2).join("+"));const r=this.tracks.filter(s=>s.soundSampleDescription.length>=1&&s.soundSampleDescription[0].description&&s.soundSampleDescription[0].description.numAudioChannels>0);if(r.length>=1){const s=r[0];if(s.timeScale>0){const l=s.duration/s.timeScale;this.metadata.setFormat("duration",l)}const i=s.soundSampleDescription[0];if(i.description&&(this.metadata.setFormat("sampleRate",i.description.sampleRate),this.metadata.setFormat("bitsPerSample",i.description.sampleSize),this.metadata.setFormat("numberOfChannels",i.description.numAudioChannels),s.timeScale===0&&s.timeToSampleTable.length>0)){const c=s.timeToSampleTable.map(u=>u.count*u.duration).reduce((u,d)=>u+d)/i.description.sampleRate;this.metadata.setFormat("duration",c)}const o=H2[i.dataFormat];o&&this.metadata.setFormat("lossless",!o.lossy),this.calculateBitRate()}}async handleAtom(e,n){if(e.parent)switch(e.parent.header.name){case"ilst":case"<id>":return this.parseMetadataItemData(e)}if(this.atomParsers[e.header.name])return this.atomParsers[e.header.name](n);Yr(`No parser for atom path=${e.atomPath}, payload-len=${n}, ignoring atom`),await this.tokenizer.ignore(n)}getTrackDescription(){return this.tracks[this.tracks.length-1]}calculateBitRate(){this.audioLengthInBytes&&this.metadata.format.duration&&this.metadata.setFormat("bitrate",8*this.audioLengthInBytes/this.metadata.format.duration)}async addTag(e,n){await this.metadata.addTag(gK,e,n)}addWarning(e){Yr(`Warning: ${e}`),this.metadata.addWarning(e)}parseMetadataItemData(e){let n=e.header.name;return e.readAtoms(this.tokenizer,async(r,s)=>{const i=r.getPayloadLength(s);switch(r.header.name){case"data":return this.parseValueAtom(n,r);case"name":case"mean":case"rate":{const o=await this.tokenizer.readToken(new rK(i));n+=`:${o.name}`;break}default:{const o=await this.tokenizer.readToken(new kn(i));this.addWarning(`Unsupported meta-item: ${n}[${r.header.name}] => value=${Ww(o)} ascii=${Hw(o,"ascii")}`)}}},e.getPayloadLength(0))}async parseValueAtom(e,n){const r=await this.tokenizer.readToken(new nK(Number(n.header.length)-Ff.len));if(r.type.set!==0)throw new Error(`Unsupported type-set != 0: ${r.type.set}`);switch(r.type.type){case 0:switch(e){case"trkn":case"disk":{const s=ve.get(r.value,3),i=ve.get(r.value,5);await this.addTag(e,`${s}/${i}`);break}case"gnre":{const s=ve.get(r.value,1),i=Nf[s-1];await this.addTag(e,i);break}case"rate":{const s=new TextDecoder("ascii").decode(r.value);await this.addTag(e,s);break}default:Yr(`unknown proprietary value type for: ${n.atomPath}`)}break;case 1:case 18:await this.addTag(e,new TextDecoder("utf-8").decode(r.value));break;case 13:if(this.options.skipCovers)break;await this.addTag(e,{format:"image/jpeg",data:Uint8Array.from(r.value)});break;case 14:if(this.options.skipCovers)break;await this.addTag(e,{format:"image/png",data:Uint8Array.from(r.value)});break;case 21:await this.addTag(e,Lf.read_BE_Integer(r.value,!0));break;case 22:await this.addTag(e,Lf.read_BE_Integer(r.value,!1));break;case 65:await this.addTag(e,ve.get(r.value,0));break;case 66:await this.addTag(e,$e.get(r.value,0));break;case 67:await this.addTag(e,re.get(r.value,0));break;default:this.addWarning(`atom key=${e}, has unknown well-known-type (data-type): ${r.type.type}`)}}parseSoundSampleDescription(e){const n={dataFormat:e.dataFormat,dataReferenceIndex:e.dataReferenceIndex};let r=0;const s=V2.get(e.description,r);return r+=V2.len,s.version===0||s.version===1?n.description=oK.get(e.description,r):Yr(`Warning: sound-sample-description ${s} not implemented`),n}async parseChapterTrack(e,n,r){if(!e.sampleSize&&e.chunkOffsetTable.length!==e.sampleSizeTable.length)throw new Error("Expected equal chunk-offset-table & sample-size-table length.");const s=[];for(let i=0;i<e.chunkOffsetTable.length&&r>0;++i){const l=e.chunkOffsetTable[i]-this.tokenizer.position,c=e.sampleSize>0?e.sampleSize:e.sampleSizeTable[i];if(r-=l+c,r<0)throw new Error("Chapter chunk exceeding token length");await this.tokenizer.ignore(l);const u=await this.tokenizer.readToken(new mK(c));Yr(`Chapter ${i+1}: ${u}`);const d={title:u,sampleOffset:this.findSampleOffset(n,this.tokenizer.position)};Yr(`Chapter title=${d.title}, offset=${d.sampleOffset}/${this.tracks[0].duration}`),s.push(d)}this.metadata.setFormat("chapters",s),await this.tokenizer.ignore(r)}findSampleOffset(e,n){let r=0;e.timeToSampleTable.forEach(i=>{r+=i.count*i.duration}),Yr(`Total duration=${r}`);let s=0;for(;s<e.chunkOffsetTable.length&&e.chunkOffsetTable[s]<n;)++s;return this.getChunkDuration(s+1,e)}getChunkDuration(e,n){let r=0,s=n.timeToSampleTable[r].count,i=n.timeToSampleTable[r].duration,o=1,l=this.getSamplesPerChunk(o,n.sampleToChunkTable),c=0;for(;o<e;){const u=Math.min(s,l);c+=u*i,s-=u,l-=u,l===0?(++o,l=this.getSamplesPerChunk(o,n.sampleToChunkTable)):(++r,s=n.timeToSampleTable[r].count,i=n.timeToSampleTable[r].duration)}return c}getSamplesPerChunk(e,n){for(let r=0;r<n.length-1;++r)if(e>=n[r].firstChunk&&e<n[r+1].firstChunk)return n[r].samplesPerChunk;return n[n.length-1].samplesPerChunk}}var q2;(function(t){t[t.not_set=0]="not_set",t[t.radio=1]="radio",t[t.audiophile=2]="audiophile"})(q2||(q2={}));var G2;(function(t){t[t.unspecified=0]="unspecified",t[t.engineer=1]="engineer",t[t.user=2]="user",t[t.automatic=3]="automatic",t[t.rms_average=4]="rms_average"})(G2||(G2={}));const Q2={len:2,get:(t,e)=>{const n=je(t,e,0,3),r=je(t,e,6,1),s=je(t,e,7,9)/10;if(n>0)return{type:je(t,e,0,3),origin:je(t,e,3,3),adjustment:r?-s:s}}},xK={len:27,get:(t,e)=>{const n=re.get(t,e+2);return{revision:je(t,e,0,4),vbr_method:je(t,e,4,4),lowpass_filter:100*ve.get(t,e+1),track_peak:n===0?null:n/2**23,track_gain:Q2.get(t,6),album_gain:Q2.get(t,8),music_length:re.get(t,e+20),music_crc:ve.get(t,e+24),header_crc:$e.get(t,e+24)}}},K2=new ne(4,"ascii"),Ag=new ne(6,"ascii"),yK={len:4,get:(t,e)=>({frames:Vn(t,e,31),bytes:Vn(t,e,30),toc:Vn(t,e,29),vbrScale:Vn(t,e,28)})};async function vK(t){const e=await t.readToken(yK),n={numFrames:null,streamSize:null,vbrScale:null};if(e.frames&&(n.numFrames=await t.readToken(re)),e.bytes&&(n.streamSize=await t.readToken(re)),e.toc&&(n.toc=new Uint8Array(100),await t.readBuffer(n.toc)),e.vbrScale&&(n.vbrScale=await t.readToken(re)),await t.peekToken(new ne(4,"ascii"))==="LAME"){await t.ignore(4),n.lame={version:await t.readToken(new ne(5,"ascii"))};const s=n.lame.version.match(/\d+.\d+/g);if(s!==null){const o=s[0].split(".").map(l=>Number.parseInt(l,10));o[0]>=3&&o[1]>=90&&(n.lame.extended=await t.readToken(xK))}}return n}const zn=Ue("music-metadata:parser:mpeg"),X2=1024,Y2={AudioObjectTypes:["AAC Main","AAC LC","AAC SSR","AAC LTP"],SamplingFrequencies:[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350,null,null,-1]},wK=[void 0,["front-center"],["front-left","front-right"],["front-center","front-left","front-right"],["front-center","front-left","front-right","back-center"],["front-center","front-left","front-right","back-left","back-right"],["front-center","front-left","front-right","back-left","back-right","LFE-channel"],["front-center","front-left","front-right","side-left","side-right","back-left","back-right","LFE-channel"]];class Nt{constructor(e,n){this.bitrateIndex=null,this.sampRateFreqIndex=null,this.padding=null,this.privateBit=null,this.channelModeIndex=null,this.modeExtension=null,this.isOriginalMedia=null,this.version=null,this.bitrate=null,this.samplingRate=null,this.frameLength=0,this.versionIndex=je(e,n+1,3,2),this.layer=Nt.LayerDescription[je(e,n+1,5,2)],this.versionIndex>1&&this.layer===0?this.parseAdtsHeader(e,n):this.parseMpegHeader(e,n),this.isProtectedByCRC=!Vn(e,n+1,7)}calcDuration(e){return this.samplingRate==null?null:e*this.calcSamplesPerFrame()/this.samplingRate}calcSamplesPerFrame(){return Nt.samplesInFrameTable[this.version===1?0:1][this.layer]}calculateSideInfoLength(){if(this.layer!==3)return 2;if(this.channelModeIndex===3){if(this.version===1)return 17;if(this.version===2||this.version===2.5)return 9}else{if(this.version===1)return 32;if(this.version===2||this.version===2.5)return 17}return null}calcSlotSize(){return[null,4,1,1][this.layer]}parseMpegHeader(e,n){this.container="MPEG",this.bitrateIndex=je(e,n+2,0,4),this.sampRateFreqIndex=je(e,n+2,4,2),this.padding=Vn(e,n+2,6),this.privateBit=Vn(e,n+2,7),this.channelModeIndex=je(e,n+3,0,2),this.modeExtension=je(e,n+3,2,2),this.isCopyrighted=Vn(e,n+3,4),this.isOriginalMedia=Vn(e,n+3,5),this.emphasis=je(e,n+3,7,2),this.version=Nt.VersionID[this.versionIndex],this.channelMode=Nt.ChannelMode[this.channelModeIndex],this.codec=`MPEG ${this.version} Layer ${this.layer}`;const r=this.calcBitrate();if(!r)throw new Error("Cannot determine bit-rate");if(this.bitrate=r*1e3,this.samplingRate=this.calcSamplingRate(),this.samplingRate==null)throw new Error("Cannot determine sampling-rate")}parseAdtsHeader(e,n){zn("layer=0 => ADTS"),this.version=this.versionIndex===2?4:2,this.container=`ADTS/MPEG-${this.version}`;const r=je(e,n+2,0,2);this.codec="AAC",this.codecProfile=Y2.AudioObjectTypes[r],zn(`MPEG-4 audio-codec=${this.codec}`);const s=je(e,n+2,2,4);this.samplingRate=Y2.SamplingFrequencies[s],zn(`sampling-rate=${this.samplingRate}`);const i=je(e,n+2,7,3);this.mp4ChannelConfig=wK[i],zn(`channel-config=${this.mp4ChannelConfig?this.mp4ChannelConfig.join("+"):"?"}`),this.frameLength=je(e,n+3,6,2)<<11}calcBitrate(){if(this.bitrateIndex===0||this.bitrateIndex===15)return null;if(this.version&&this.bitrateIndex){const e=10*Math.floor(this.version)+this.layer;return Nt.bitrate_index[this.bitrateIndex][e]}return null}calcSamplingRate(){return this.sampRateFreqIndex===3||this.version===null||this.sampRateFreqIndex==null?null:Nt.sampling_rate_freq_index[this.version][this.sampRateFreqIndex]}}Nt.SyncByte1=255;Nt.SyncByte2=224;Nt.VersionID=[2.5,null,2,1];Nt.LayerDescription=[0,3,2,1];Nt.ChannelMode=["stereo","joint_stereo","dual_channel","mono"];Nt.bitrate_index={1:{11:32,12:32,13:32,21:32,22:8,23:8},2:{11:64,12:48,13:40,21:48,22:16,23:16},3:{11:96,12:56,13:48,21:56,22:24,23:24},4:{11:128,12:64,13:56,21:64,22:32,23:32},5:{11:160,12:80,13:64,21:80,22:40,23:40},6:{11:192,12:96,13:80,21:96,22:48,23:48},7:{11:224,12:112,13:96,21:112,22:56,23:56},8:{11:256,12:128,13:112,21:128,22:64,23:64},9:{11:288,12:160,13:128,21:144,22:80,23:80},10:{11:320,12:192,13:160,21:160,22:96,23:96},11:{11:352,12:224,13:192,21:176,22:112,23:112},12:{11:384,12:256,13:224,21:192,22:128,23:128},13:{11:416,12:320,13:256,21:224,22:144,23:144},14:{11:448,12:384,13:320,21:256,22:160,23:160}};Nt.sampling_rate_freq_index={1:{0:44100,1:48e3,2:32e3},2:{0:22050,1:24e3,2:16e3},2.5:{0:11025,1:12e3,2:8e3}};Nt.samplesInFrameTable=[[0,384,1152,1152],[0,384,1152,576]];const J2={len:4,get:(t,e)=>new Nt(t,e)};function _K(t){return`V${Math.floor((100-t)/10)}`}class bK extends Zm{constructor(){super(...arguments),this.frameCount=0,this.syncFrameCount=-1,this.countSkipFrameData=0,this.totalDataLength=0,this.bitrates=[],this.offset=0,this.frame_size=0,this.crc=null,this.calculateEofDuration=!1,this.samplesPerFrame=null,this.buf_frame_header=new Uint8Array(4),this.mpegOffset=null,this.syncPeek={buf:new Uint8Array(X2),len:0}}async postId3v2Parse(){this.metadata.setFormat("lossless",!1);try{let e=!1;for(;!e;)await this.sync(),e=await this.parseCommonMpegHeader()}catch(e){if(e instanceof pt){if(zn("End-of-stream"),this.calculateEofDuration&&this.samplesPerFrame!==null){const n=this.frameCount*this.samplesPerFrame;if(this.metadata.setFormat("numberOfSamples",n),this.metadata.format.sampleRate){const r=n/this.metadata.format.sampleRate;zn(`Calculate duration at EOF: ${r} sec.`,r),this.metadata.setFormat("duration",r)}}}else throw e}}finalize(){const e=this.metadata.format,n=!!this.metadata.native.ID3v1;if(this.mpegOffset!==null){if(e.duration&&this.tokenizer.fileInfo.size){const r=this.tokenizer.fileInfo.size-this.mpegOffset-(n?128:0);e.codecProfile&&e.codecProfile[0]==="V"&&this.metadata.setFormat("bitrate",r*8/e.duration)}else if(this.tokenizer.fileInfo.size&&e.codecProfile==="CBR"){const r=this.tokenizer.fileInfo.size-this.mpegOffset-(n?128:0);if(this.frame_size!==null&&this.samplesPerFrame!==null){const s=Math.round(r/this.frame_size)*this.samplesPerFrame;if(this.metadata.setFormat("numberOfSamples",s),e.sampleRate){const i=s/e.sampleRate;zn("Calculate CBR duration based on file size: %s",i),this.metadata.setFormat("duration",i)}}}}}async sync(){let e=!1;for(;;){let n=0;if(this.syncPeek.len=await this.tokenizer.peekBuffer(this.syncPeek.buf,{length:X2,mayBeLess:!0}),this.syncPeek.len<=163)throw new pt;for(;;){if(e&&(this.syncPeek.buf[n]&224)===224){this.buf_frame_header[0]=Nt.SyncByte1,this.buf_frame_header[1]=this.syncPeek.buf[n],await this.tokenizer.ignore(n),zn(`Sync at offset=${this.tokenizer.position-1}, frameCount=${this.frameCount}`),this.syncFrameCount===this.frameCount&&(zn(`Re-synced MPEG stream, frameCount=${this.frameCount}`),this.frameCount=0,this.frame_size=0),this.syncFrameCount=this.frameCount;return}if(e=!1,n=this.syncPeek.buf.indexOf(Nt.SyncByte1,n),n===-1){if(this.syncPeek.len<this.syncPeek.buf.length)throw new pt;await this.tokenizer.ignore(this.syncPeek.len);break}++n,e=!0}}}async parseCommonMpegHeader(){this.frameCount===0&&(this.mpegOffset=this.tokenizer.position-1),await this.tokenizer.peekBuffer(this.buf_frame_header,{offset:1,length:3});let e;try{e=J2.get(this.buf_frame_header,0)}catch(n){if(await this.tokenizer.ignore(1),n instanceof Error)return this.metadata.addWarning(`Parse error: ${n.message}`),!1;throw n}return await this.tokenizer.ignore(3),this.metadata.setFormat("container",e.container),this.metadata.setFormat("codec",e.codec),this.metadata.setFormat("lossless",!1),this.metadata.setFormat("sampleRate",e.samplingRate),this.frameCount++,e.version!==null&&e.version>=2&&e.layer===0?this.parseAdts(e):this.parseAudioFrameHeader(e)}async parseAudioFrameHeader(e){this.metadata.setFormat("numberOfChannels",e.channelMode==="mono"?1:2),this.metadata.setFormat("bitrate",e.bitrate),this.frameCount<20*1e4&&zn("offset=%s MP%s bitrate=%s sample-rate=%s",this.tokenizer.position-4,e.layer,e.bitrate,e.samplingRate);const n=e.calcSlotSize();if(n===null)throw new Error("invalid slot_size");const r=e.calcSamplesPerFrame();zn(`samples_per_frame=${r}`);const s=r/8;if(e.bitrate!==null&&e.samplingRate!=null){const i=s*e.bitrate/e.samplingRate+(e.padding?n:0);this.frame_size=Math.floor(i)}if(this.audioFrameHeader=e,e.bitrate!==null&&this.bitrates.push(e.bitrate),this.frameCount===1)return this.offset=J2.len,await this.skipSideInformation(),!1;if(this.frameCount===3){if(this.areAllSame(this.bitrates)){if(this.samplesPerFrame=r,this.metadata.setFormat("codecProfile","CBR"),this.tokenizer.fileInfo.size)return!0}else if(this.metadata.format.duration)return!0;if(!this.options.duration)return!0}return this.options.duration&&this.frameCount===4&&(this.samplesPerFrame=r,this.calculateEofDuration=!0),this.offset=4,e.isProtectedByCRC?(await this.parseCrc(),!1):(await this.skipSideInformation(),!1)}async parseAdts(e){const n=new Uint8Array(3);if(await this.tokenizer.readBuffer(n),e.frameLength+=je(n,0,0,11),this.totalDataLength+=e.frameLength,this.samplesPerFrame=1024,e.samplingRate!==null){const r=e.samplingRate/this.samplesPerFrame,i=8*(this.frameCount===0?0:this.totalDataLength/this.frameCount)*r+.5;this.metadata.setFormat("bitrate",i),zn(`frame-count=${this.frameCount}, size=${e.frameLength} bytes, bit-rate=${i}`)}if(await this.tokenizer.ignore(e.frameLength>7?e.frameLength-7:1),this.frameCount===3)if(this.metadata.setFormat("codecProfile",e.codecProfile),e.mp4ChannelConfig&&this.metadata.setFormat("numberOfChannels",e.mp4ChannelConfig.length),this.options.duration)this.calculateEofDuration=!0;else return!0;return!1}async parseCrc(){return this.crc=await this.tokenizer.readNumber(Ps),this.offset+=2,this.skipSideInformation()}async skipSideInformation(){if(this.audioFrameHeader){const e=this.audioFrameHeader.calculateSideInfoLength();if(e!==null){await this.tokenizer.readToken(new kn(e)),this.offset+=e,await this.readXtraInfoHeader();return}}}async readXtraInfoHeader(){const e=await this.tokenizer.readToken(K2);switch(this.offset+=K2.len,e){case"Info":return this.metadata.setFormat("codecProfile","CBR"),this.readXingInfoHeader();case"Xing":{const r=await this.readXingInfoHeader();if(r.vbrScale!==null){const s=_K(r.vbrScale);this.metadata.setFormat("codecProfile",s)}return null}case"Xtra":break;case"LAME":{const r=await this.tokenizer.readToken(Ag);if(this.frame_size!==null&&this.frame_size>=this.offset+Ag.len)return this.offset+=Ag.len,this.metadata.setFormat("tool",`LAME ${r}`),await this.skipFrameData(this.frame_size-this.offset),null;this.metadata.addWarning("Corrupt LAME header");break}}const n=this.frame_size-this.offset;return n<0?this.metadata.addWarning(`Frame ${this.frameCount}corrupt: negative frameDataLeft`):await this.skipFrameData(n),null}async readXingInfoHeader(){const e=this.tokenizer.position,n=await vK(this.tokenizer);if(this.offset+=this.tokenizer.position-e,n.lame&&(this.metadata.setFormat("tool",`LAME ${bi(n.lame.version)}`),n.lame.extended&&(this.metadata.setFormat("trackPeakLevel",n.lame.extended.track_peak),n.lame.extended.track_gain&&this.metadata.setFormat("trackGain",n.lame.extended.track_gain.adjustment),n.lame.extended.album_gain&&this.metadata.setFormat("albumGain",n.lame.extended.album_gain.adjustment),this.metadata.setFormat("duration",n.lame.extended.music_length/1e3))),n.streamSize&&this.audioFrameHeader&&n.numFrames!==null){const s=this.audioFrameHeader.calcDuration(n.numFrames);return this.metadata.setFormat("duration",s),zn("Get duration from Xing header: %s",this.metadata.format.duration),n}const r=this.frame_size-this.offset;return await this.skipFrameData(r),n}async skipFrameData(e){if(e<0)throw new Error("frame-data-left cannot be negative");await this.tokenizer.ignore(e),this.countSkipFrameData+=e}areAllSame(e){const n=e[0];return e.every(r=>r===n)}}const Z2=Ue("music-metadata:parser:musepack:sv8"),SK=new ne(2,"latin1"),eE={len:5,get:(t,e)=>({crc:J.get(t,e),streamVersion:ve.get(t,e+4)})},tE={len:2,get:(t,e)=>({sampleFrequency:[44100,48e3,37800,32e3][je(t,e,0,3)],maxUsedBands:je(t,e,3,5),channelCount:je(t,e+1,0,4)+1,msUsed:Vn(t,e+1,4),audioBlockFrames:je(t,e+1,5,3)})};class EK{constructor(e){this.tokenizer=e}async readPacketHeader(){const e=await this.tokenizer.readToken(SK),n=await this.readVariableSizeField();return{key:e,payloadLength:n.value-2-n.len}}async readStreamHeader(e){const n={};Z2(`Reading SH at offset=${this.tokenizer.position}`);const r=await this.tokenizer.readToken(eE);e-=eE.len,Object.assign(n,r),Z2(`SH.streamVersion = ${r.streamVersion}`);const s=await this.readVariableSizeField();e-=s.len,n.sampleCount=s.value;const i=await this.readVariableSizeField();e-=i.len,n.beginningOfSilence=i.value;const o=await this.tokenizer.readToken(tE);return e-=tE.len,Object.assign(n,o),await this.tokenizer.ignore(e),n}async readVariableSizeField(e=1,n=0){let r=await this.tokenizer.readNumber(ve);return r&128?(r&=127,r+=n,this.readVariableSizeField(e+1,r<<7)):{len:e,value:n+r}}}const kK=Ue("music-metadata:parser:musepack");class TK extends sr{constructor(){super(...arguments),this.audioLength=0}async parse(){if(await this.tokenizer.readToken(Je)!=="MPCK")throw new Error("Invalid Magic number");return this.metadata.setFormat("container","Musepack, SV8"),this.parsePacket()}async parsePacket(){const e=new EK(this.tokenizer);do{const n=await e.readPacketHeader();switch(kK(`packet-header key=${n.key}, payloadLength=${n.payloadLength}`),n.key){case"SH":{const r=await e.readStreamHeader(n.payloadLength);this.metadata.setFormat("numberOfSamples",r.sampleCount),this.metadata.setFormat("sampleRate",r.sampleFrequency),this.metadata.setFormat("duration",r.sampleCount/r.sampleFrequency),this.metadata.setFormat("numberOfChannels",r.channelCount);break}case"AP":this.audioLength+=n.payloadLength,await this.tokenizer.ignore(n.payloadLength);break;case"RG":case"EI":case"SO":case"ST":case"CT":await this.tokenizer.ignore(n.payloadLength);break;case"SE":return this.metadata.format.duration&&this.metadata.setFormat("bitrate",this.audioLength*8/this.metadata.format.duration),rs.tryParseApeHeader(this.metadata,this.tokenizer,this.options);default:throw new Error(`Unexpected header: ${n.key}`)}}while(!0)}}class IK{constructor(e){this.tokenizer=e,this.pos=0,this.dword=null}async read(e){for(;this.dword===null;)this.dword=await this.tokenizer.readToken(J);let n=this.dword;return this.pos+=e,this.pos<32?(n>>>=32-this.pos,n&(1<<e)-1):(this.pos-=32,this.pos===0?(this.dword=null,n&(1<<e)-1):(this.dword=await this.tokenizer.readToken(J),this.pos&&(n<<=this.pos,n|=this.dword>>>32-this.pos),n&(1<<e)-1))}async ignore(e){if(this.pos>0){const s=32-this.pos;this.dword=null,e-=s,this.pos=0}const n=e%32,r=(e-n)/32;return await this.tokenizer.ignore(r*4),this.read(n)}}const CK={len:6*4,get:(t,e)=>{const n={signature:new TextDecoder("latin1").decode(t.subarray(e,e+3)),streamMinorVersion:je(t,e+3,0,4),streamMajorVersion:je(t,e+3,4,4),frameCount:J.get(t,e+4),maxLevel:Le.get(t,e+8),sampleFrequency:[44100,48e3,37800,32e3][je(t,e+10,0,2)],link:je(t,e+10,2,2),profile:je(t,e+10,4,4),maxBand:je(t,e+11,0,6),intensityStereo:Vn(t,e+11,6),midSideStereo:Vn(t,e+11,7),titlePeak:Le.get(t,e+12),titleGain:Le.get(t,e+14),albumPeak:Le.get(t,e+16),albumGain:Le.get(t,e+18),lastFrameLength:J.get(t,e+20)>>>20&2047,trueGapless:Vn(t,e+23,0)};return n.lastFrameLength=n.trueGapless?J.get(t,20)>>>20&2047:0,n}},nE=Ue("music-metadata:parser:musepack");class jK extends sr{constructor(){super(...arguments),this.bitreader=null,this.audioLength=0,this.duration=null}async parse(){const e=await this.tokenizer.readToken(CK);if(e.signature!=="MP+")throw new Error("Unexpected magic number");nE(`stream-version=${e.streamMajorVersion}.${e.streamMinorVersion}`),this.metadata.setFormat("container","Musepack, SV7"),this.metadata.setFormat("sampleRate",e.sampleFrequency);const n=1152*(e.frameCount-1)+e.lastFrameLength;this.metadata.setFormat("numberOfSamples",n),this.duration=n/e.sampleFrequency,this.metadata.setFormat("duration",this.duration),this.bitreader=new IK(this.tokenizer),this.metadata.setFormat("numberOfChannels",e.midSideStereo||e.intensityStereo?2:1);const r=await this.bitreader.read(8);return this.metadata.setFormat("codec",(r/100).toFixed(2)),await this.skipAudioData(e.frameCount),nE(`End of audio stream, switching to APEv2, offset=${this.tokenizer.position}`),rs.tryParseApeHeader(this.metadata,this.tokenizer,this.options)}async skipAudioData(e){for(;e-- >0;){const r=await this.bitreader.read(20);this.audioLength+=20+r,await this.bitreader.ignore(r)}const n=await this.bitreader.read(11);this.audioLength+=n,this.duration!==null&&this.metadata.setFormat("bitrate",this.audioLength/this.duration)}}const rE=Ue("music-metadata:parser:musepack");class RK extends Zm{async postId3v2Parse(){const e=await this.tokenizer.peekToken(new ne(3,"latin1"));let n;switch(e){case"MP+":{rE("Musepack stream-version 7"),n=new jK;break}case"MPC":{rE("Musepack stream-version 8"),n=new TK;break}default:throw new Error("Invalid Musepack signature prefix")}return n.init(this.metadata,this.tokenizer,this.options),n.parse()}}class AK{constructor(e){if(this.len=e,e<19)throw new Error("ID-header-page 0 should be at least 19 bytes long")}get(e,n){return{magicSignature:new ne(8,"ascii").get(e,n+0),version:ve.get(e,n+8),channelCount:ve.get(e,n+9),preSkip:Le.get(e,n+10),inputSampleRate:J.get(e,n+12),outputGain:Le.get(e,n+16),channelMapping:ve.get(e,n+18)}}}class NK extends Qa{constructor(e,n,r){super(e,n),this.tokenizer=r,this.idHeader=null,this.lastPos=-1}parseFirstPage(e,n){if(this.metadata.setFormat("codec","Opus"),this.idHeader=new AK(n.length).get(n,0),this.idHeader.magicSignature!=="OpusHead")throw new Error("Illegal ogg/Opus magic-signature");this.metadata.setFormat("sampleRate",this.idHeader.inputSampleRate),this.metadata.setFormat("numberOfChannels",this.idHeader.channelCount)}async parseFullPage(e){switch(new ne(8,"ascii").get(e,0)){case"OpusTags":await this.parseUserCommentList(e,8),this.lastPos=this.tokenizer.position-e.length;break}}calculateDuration(e){if(this.metadata.format.sampleRate&&e.absoluteGranulePosition>=0){const n=e.absoluteGranulePosition-this.idHeader.preSkip;if(this.metadata.setFormat("numberOfSamples",n),this.metadata.setFormat("duration",n/48e3),this.lastPos!==-1&&this.tokenizer.fileInfo.size&&this.metadata.format.duration){const r=this.tokenizer.fileInfo.size-this.lastPos;this.metadata.setFormat("bitrate",8*r/this.metadata.format.duration)}}}}const PK={len:80,get:(t,e)=>({speex:new ne(8,"ascii").get(t,e+0),version:VA(new ne(20,"ascii").get(t,e+8)),version_id:ht.get(t,e+28),header_size:ht.get(t,e+32),rate:ht.get(t,e+36),mode:ht.get(t,e+40),mode_bitstream_version:ht.get(t,e+44),nb_channels:ht.get(t,e+48),bitrate:ht.get(t,e+52),frame_size:ht.get(t,e+56),vbr:ht.get(t,e+60),frames_per_packet:ht.get(t,e+64),extra_headers:ht.get(t,e+68),reserved1:ht.get(t,e+72),reserved2:ht.get(t,e+76)})},FK=Ue("music-metadata:parser:ogg:speex");class DK extends Qa{constructor(e,n,r){super(e,n),this.tokenizer=r}parseFirstPage(e,n){FK("First Ogg/Speex page");const r=PK.get(n,0);this.metadata.setFormat("codec",`Speex ${r.version}`),this.metadata.setFormat("numberOfChannels",r.nb_channels),this.metadata.setFormat("sampleRate",r.rate),r.bitrate!==-1&&this.metadata.setFormat("bitrate",r.bitrate)}}const LK={len:42,get:(t,e)=>({id:new ne(7,"ascii").get(t,e),vmaj:ve.get(t,e+7),vmin:ve.get(t,e+8),vrev:ve.get(t,e+9),vmbw:$e.get(t,e+10),vmbh:$e.get(t,e+17),nombr:vn.get(t,e+37),nqual:ve.get(t,e+40)})},Ng=Ue("music-metadata:parser:ogg:theora");class MK{constructor(e,n,r){this.metadata=e,this.tokenizer=r}async parsePage(e,n){e.headerType.firstPage&&await this.parseFirstPage(e,n)}async flush(){Ng("flush")}calculateDuration(e){Ng("duration calculation not implemented")}async parseFirstPage(e,n){Ng("First Ogg/Theora page"),this.metadata.setFormat("codec","Theora");const r=LK.get(n,0);this.metadata.setFormat("bitrate",r.nombr)}}const bs=Ue("music-metadata:parser:ogg");class Jw{static sum(e,n,r){const s=new DataView(e.buffer,0);let i=0;for(let o=n;o<n+r;++o)i+=s.getUint8(o);return i}constructor(e){this.len=e.page_segments}get(e,n){return{totalPageSize:Jw.sum(e,n,this.len)}}}class ep extends sr{constructor(){super(...arguments),this.header=null,this.pageNumber=0,this.pageConsumer=null}async parse(){bs("pos=%s, parsePage()",this.tokenizer.position);try{let e;do{if(e=await this.tokenizer.readToken(ep.Header),e.capturePattern!=="OggS")throw new Error("Invalid Ogg capture pattern");this.metadata.setFormat("container","Ogg"),this.header=e,this.pageNumber=e.pageSequenceNo,bs("page#=%s, Ogg.id=%s",e.pageSequenceNo,e.capturePattern);const n=await this.tokenizer.readToken(new Jw(e));bs("totalPageSize=%s",n.totalPageSize);const r=await this.tokenizer.readToken(new kn(n.totalPageSize));if(bs("firstPage=%s, lastPage=%s, continued=%s",e.headerType.firstPage,e.headerType.lastPage,e.headerType.continued),e.headerType.firstPage){const s=new TextDecoder("ascii").decode(r.subarray(0,7));switch(s){case"vorbis":bs("Set page consumer to Ogg/Vorbis"),this.pageConsumer=new Qa(this.metadata,this.options);break;case"OpusHea":bs("Set page consumer to Ogg/Opus"),this.pageConsumer=new NK(this.metadata,this.options,this.tokenizer);break;case"Speex  ":bs("Set page consumer to Ogg/Speex"),this.pageConsumer=new DK(this.metadata,this.options,this.tokenizer);break;case"fishead":case"\0theora":bs("Set page consumer to Ogg/Theora"),this.pageConsumer=new MK(this.metadata,this.options,this.tokenizer);break;default:throw new Error(`gg audio-codec not recognized (id=${s})`)}}await this.pageConsumer.parsePage(e,r)}while(!e.headerType.lastPage)}catch(e){if(e instanceof Error)e instanceof pt?(this.metadata.addWarning("Last OGG-page is not marked with last-page flag"),bs("End-of-stream"),this.metadata.addWarning("Last OGG-page is not marked with last-page flag"),this.header&&this.pageConsumer.calculateDuration(this.header)):e.message.startsWith("FourCC")&&this.pageNumber>0&&(this.metadata.addWarning("Invalid FourCC ID, maybe last OGG-page is not marked with last-page flag"),await this.pageConsumer.flush());else throw e}}}ep.Header={len:27,get:(t,e)=>({capturePattern:Je.get(t,e),version:ve.get(t,e+4),headerType:{continued:lt(t,e+5,0),firstPage:lt(t,e+5,1),lastPage:lt(t,e+5,2)},absoluteGranulePosition:Number(fn.get(t,e+6)),streamSerialNumber:J.get(t,e+14),pageSequenceNo:J.get(t,e+18),pageChecksum:J.get(t,e+22),page_segments:ve.get(t,e+26)})};const sc={len:8,get:(t,e)=>({chunkID:new ne(4,"latin1").get(t,e),chunkSize:J.get(t,e+4)})};class OK{constructor(e){this.tagHeader=e,this.len=e.chunkSize,this.len+=this.len&1}get(e,n){return new ne(this.tagHeader.chunkSize,"ascii").get(e,n)}}var Ox;(function(t){t[t.PCM=1]="PCM",t[t.ADPCM=2]="ADPCM",t[t.IEEE_FLOAT=3]="IEEE_FLOAT",t[t.MPEG_ADTS_AAC=5632]="MPEG_ADTS_AAC",t[t.MPEG_LOAS=5634]="MPEG_LOAS",t[t.RAW_AAC1=255]="RAW_AAC1",t[t.DOLBY_AC3_SPDIF=146]="DOLBY_AC3_SPDIF",t[t.DVM=8192]="DVM",t[t.RAW_SPORT=576]="RAW_SPORT",t[t.ESST_AC3=577]="ESST_AC3",t[t.DRM=9]="DRM",t[t.DTS2=8193]="DTS2",t[t.MPEG=80]="MPEG"})(Ox||(Ox={}));class $K{constructor(e){if(e.chunkSize<16)throw new Error("Invalid chunk size");this.len=e.chunkSize}get(e,n){return{wFormatTag:Le.get(e,n),nChannels:Le.get(e,n+2),nSamplesPerSec:J.get(e,n+4),nAvgBytesPerSec:J.get(e,n+8),nBlockAlign:Le.get(e,n+12),wBitsPerSample:Le.get(e,n+14)}}}class BK{constructor(e){if(e.chunkSize<4)throw new Error("Invalid fact chunk size.");this.len=e.chunkSize}get(e,n){return{dwSampleLength:J.get(e,n)}}}const sE={len:420,get:(t,e)=>({description:bi(new ne(256,"ascii").get(t,e)).trim(),originator:bi(new ne(32,"ascii").get(t,e+256)).trim(),originatorReference:bi(new ne(32,"ascii").get(t,e+288)).trim(),originationDate:bi(new ne(10,"ascii").get(t,e+320)).trim(),originationTime:bi(new ne(8,"ascii").get(t,e+330)).trim(),timeReferenceLow:J.get(t,e+338),timeReferenceHigh:J.get(t,e+342),version:Le.get(t,e+346),umid:new kn(64).get(t,e+348),loudnessValue:Le.get(t,e+412),maxTruePeakLevel:Le.get(t,e+414),maxMomentaryLoudness:Le.get(t,e+416),maxShortTermLoudness:Le.get(t,e+418)})},fi=Ue("music-metadata:parser:RIFF");class zK extends sr{constructor(){super(...arguments),this.blockAlign=0}async parse(){const e=await this.tokenizer.readToken(sc);if(fi(`pos=${this.tokenizer.position}, parse: chunkID=${e.chunkID}`),e.chunkID==="RIFF")return this.parseRiffChunk(e.chunkSize).catch(n=>{if(!(n instanceof pt))throw n})}async parseRiffChunk(e){const n=await this.tokenizer.readToken(Je);switch(this.metadata.setFormat("container",n),n){case"WAVE":return this.readWaveChunk(e-Je.len);default:throw new Error(`Unsupported RIFF format: RIFF/${n}`)}}async readWaveChunk(e){for(;e>=sc.len;){const n=await this.tokenizer.readToken(sc);switch(e-=sc.len+n.chunkSize,n.chunkSize>e&&this.metadata.addWarning("Data chunk size exceeds file size"),this.header=n,fi(`pos=${this.tokenizer.position}, readChunk: chunkID=RIFF/WAVE/${n.chunkID}`),n.chunkID){case"LIST":await this.parseListTag(n);break;case"fact":this.metadata.setFormat("lossless",!1),this.fact=await this.tokenizer.readToken(new BK(n));break;case"fmt ":{const r=await this.tokenizer.readToken(new $K(n));let s=Ox[r.wFormatTag];s||(fi(`WAVE/non-PCM format=${r.wFormatTag}`),s=`non-PCM (${r.wFormatTag})`),this.metadata.setFormat("codec",s),this.metadata.setFormat("bitsPerSample",r.wBitsPerSample),this.metadata.setFormat("sampleRate",r.nSamplesPerSec),this.metadata.setFormat("numberOfChannels",r.nChannels),this.metadata.setFormat("bitrate",r.nBlockAlign*r.nSamplesPerSec*8),this.blockAlign=r.nBlockAlign;break}case"id3 ":case"ID3 ":{const r=await this.tokenizer.readToken(new kn(n.chunkSize)),s=ol(r);await new Dr().parse(this.metadata,s,this.options);break}case"data":{this.metadata.format.lossless!==!1&&this.metadata.setFormat("lossless",!0);let r=n.chunkSize;if(this.tokenizer.fileInfo.size){const i=this.tokenizer.fileInfo.size-this.tokenizer.position;i<r&&(this.metadata.addWarning("data chunk length exceeding file length"),r=i)}const s=this.fact?this.fact.dwSampleLength:r===4294967295?void 0:r/this.blockAlign;s&&(this.metadata.setFormat("numberOfSamples",s),this.metadata.format.sampleRate&&this.metadata.setFormat("duration",s/this.metadata.format.sampleRate)),this.metadata.format.codec==="ADPCM"?this.metadata.setFormat("bitrate",352e3):this.metadata.format.sampleRate&&this.metadata.setFormat("bitrate",this.blockAlign*this.metadata.format.sampleRate*8),await this.tokenizer.ignore(n.chunkSize);break}case"bext":{const r=await this.tokenizer.readToken(sE);Object.keys(r).forEach(i=>{this.metadata.addTag("exif",`bext.${i}`,r[i])});const s=n.chunkSize-sE.len;await this.tokenizer.ignore(s);break}case"\0\0\0\0":fi(`Ignore padding chunk: RIFF/${n.chunkID} of ${n.chunkSize} bytes`),this.metadata.addWarning(`Ignore chunk: RIFF/${n.chunkID}`),await this.tokenizer.ignore(n.chunkSize);break;default:fi(`Ignore chunk: RIFF/${n.chunkID} of ${n.chunkSize} bytes`),this.metadata.addWarning(`Ignore chunk: RIFF/${n.chunkID}`),await this.tokenizer.ignore(n.chunkSize)}this.header.chunkSize%2===1&&(fi("Read odd padding byte"),await this.tokenizer.ignore(1))}}async parseListTag(e){const n=await this.tokenizer.readToken(new ne(4,"latin1"));switch(fi("pos=%s, parseListTag: chunkID=RIFF/WAVE/LIST/%s",this.tokenizer.position,n),n){case"INFO":return this.parseRiffInfoTags(e.chunkSize-4);default:return this.metadata.addWarning(`Ignore chunk: RIFF/WAVE/LIST/${n}`),fi(`Ignoring chunkID=RIFF/WAVE/LIST/${n}`),this.tokenizer.ignore(e.chunkSize-4).then()}}async parseRiffInfoTags(e){for(;e>=8;){const n=await this.tokenizer.readToken(sc),r=new OK(n),s=await this.tokenizer.readToken(r);this.addTag(n.chunkID,bi(s)),e-=8+r.len}if(e!==0)throw new Error(`Illegal remaining size: ${e}`)}addTag(e,n){this.metadata.addTag("exif",e,n)}}const UK=[6e3,8e3,9600,11025,12e3,16e3,22050,24e3,32e3,44100,48e3,64e3,88200,96e3,192e3,-1],Qd={len:32,get:(t,e)=>{const n=J.get(t,e+24),r={BlockID:Je.get(t,e),blockSize:J.get(t,e+4),version:Le.get(t,e+8),totalSamples:J.get(t,e+12),blockIndex:J.get(t,e+16),blockSamples:J.get(t,e+20),flags:{bitsPerSample:(1+Mf(n,0,2))*8,isMono:es(n,2),isHybrid:es(n,3),isJointStereo:es(n,4),crossChannel:es(n,5),hybridNoiseShaping:es(n,6),floatingPoint:es(n,7),samplingRate:UK[Mf(n,23,4)],isDSD:es(n,31)},crc:new kn(4).get(t,e+28)};return r.flags.isDSD&&(r.totalSamples*=8),r}},Pg={len:1,get:(t,e)=>({functionId:Mf(t[e],0,6),isOptional:es(t[e],5),isOddSize:es(t[e],6),largeBlock:es(t[e],7)})};function es(t,e){return Mf(t,e,1)===1}function Mf(t,e,n){return t>>>e&4294967295>>>32-n}const da=Ue("music-metadata:parser:WavPack");class VK extends sr{constructor(){super(...arguments),this.audioDataSize=0}async parse(){return this.audioDataSize=0,await this.parseWavPackBlocks(),rs.tryParseApeHeader(this.metadata,this.tokenizer,this.options)}async parseWavPackBlocks(){do{if(await this.tokenizer.peekToken(Je)!=="wvpk")break;const n=await this.tokenizer.readToken(Qd);if(n.BlockID!=="wvpk")throw new Error("Invalid WavPack Block-ID");da(`WavPack header blockIndex=${n.blockIndex}, len=${Qd.len}`),n.blockIndex===0&&!this.metadata.format.container&&(this.metadata.setFormat("container","WavPack"),this.metadata.setFormat("lossless",!n.flags.isHybrid),this.metadata.setFormat("bitsPerSample",n.flags.bitsPerSample),n.flags.isDSD||(this.metadata.setFormat("sampleRate",n.flags.samplingRate),this.metadata.setFormat("duration",n.totalSamples/n.flags.samplingRate)),this.metadata.setFormat("numberOfChannels",n.flags.isMono?1:2),this.metadata.setFormat("numberOfSamples",n.totalSamples),this.metadata.setFormat("codec",n.flags.isDSD?"DSD":"PCM"));const r=n.blockSize-(Qd.len-8);await(n.blockIndex===0?this.parseMetadataSubBlock(n,r):this.tokenizer.ignore(r)),n.blockSamples>0&&(this.audioDataSize+=n.blockSize)}while(!this.tokenizer.fileInfo.size||this.tokenizer.fileInfo.size-this.tokenizer.position>=Qd.len);this.metadata.format.duration&&this.metadata.setFormat("bitrate",this.audioDataSize*8/this.metadata.format.duration)}async parseMetadataSubBlock(e,n){let r=n;for(;r>Pg.len;){const s=await this.tokenizer.readToken(Pg),i=await this.tokenizer.readNumber(s.largeBlock?Cf:ve),o=new Uint8Array(i*2-(s.isOddSize?1:0));switch(await this.tokenizer.readBuffer(o),da(`Metadata Sub-Blocks functionId=0x${s.functionId.toString(16)}, id.largeBlock=${s.largeBlock},data-size=${o.length}`),s.functionId){case 0:break;case 14:{da("ID_DSD_BLOCK");const l=1<<ve.get(o,0),c=e.flags.samplingRate*l*8;if(!e.flags.isDSD)throw new Error("Only expect DSD block if DSD-flag is set");this.metadata.setFormat("sampleRate",c),this.metadata.setFormat("duration",e.totalSamples/c);break}case 36:da("ID_ALT_TRAILER: trailer for non-wav files");break;case 38:this.metadata.setFormat("audioMD5",o);break;case 47:da(`ID_BLOCK_CHECKSUM: checksum=${Ww(o)}`);break;default:da(`Ignore unsupported meta-sub-block-id functionId=0x${s.functionId.toString(16)}`);break}r-=Pg.len+(s.largeBlock?Cf.len:ve.len)+i*2,da(`remainingLength=${r}`),s.isOddSize&&this.tokenizer.ignore(1)}if(r!==0)throw new Error("metadata-sub-block should fit it remaining length")}}const Kd={len:12,get:(t,e)=>({id:Je.get(t,e),size:fn.get(t,e+4)})},HK={len:16,get:(t,e)=>({fileSize:jf.get(t,e),metadataPointer:jf.get(t,e+8)})};var iE;(function(t){t[t.mono=1]="mono",t[t.stereo=2]="stereo",t[t.channels=3]="channels",t[t.quad=4]="quad",t[t["4 channels"]=5]="4 channels",t[t["5 channels"]=6]="5 channels",t[t["5.1 channels"]=7]="5.1 channels"})(iE||(iE={}));const WK={len:40,get:(t,e)=>({formatVersion:ht.get(t,e),formatID:ht.get(t,e+4),channelType:ht.get(t,e+8),channelNum:ht.get(t,e+12),samplingFrequency:ht.get(t,e+16),bitsPerSample:ht.get(t,e+20),sampleCount:jf.get(t,e+24),blockSizePerChannel:ht.get(t,e+32)})},Fg=Ue("music-metadata:parser:DSF");class qK extends Zm{async postId3v2Parse(){const e=this.tokenizer.position,n=await this.tokenizer.readToken(Kd);if(n.id!=="DSD ")throw new Error("Invalid chunk signature");this.metadata.setFormat("container","DSF"),this.metadata.setFormat("lossless",!0);const r=await this.tokenizer.readToken(HK);if(r.metadataPointer===BigInt(0))Fg("No ID3v2 tag present");else return Fg(`expect ID3v2 at offset=${r.metadataPointer}`),await this.parseChunks(r.fileSize-n.size),await this.tokenizer.ignore(Number(r.metadataPointer)-this.tokenizer.position-e),new Dr().parse(this.metadata,this.tokenizer,this.options)}async parseChunks(e){for(;e>=Kd.len;){const n=await this.tokenizer.readToken(Kd);switch(Fg(`Parsing chunk name=${n.id} size=${n.size}`),n.id){case"fmt ":{const r=await this.tokenizer.readToken(WK);this.metadata.setFormat("numberOfChannels",r.channelNum),this.metadata.setFormat("sampleRate",r.samplingFrequency),this.metadata.setFormat("bitsPerSample",r.bitsPerSample),this.metadata.setFormat("numberOfSamples",r.sampleCount),this.metadata.setFormat("duration",Number(r.sampleCount)/r.samplingFrequency);const s=r.bitsPerSample*r.samplingFrequency*r.channelNum;this.metadata.setFormat("bitrate",s);return}default:this.tokenizer.ignore(Number(n.size)-Kd.len);break}e-=n.size}}}const po={len:12,get:(t,e)=>({chunkID:Je.get(t,e),chunkSize:FA.get(t,e+4)})},dn=Ue("music-metadata:parser:aiff");class GK extends sr{async parse(){const e=await this.tokenizer.readToken(po);if(e.chunkID!=="FRM8")throw new Error("Unexpected chunk-ID");const n=(await this.tokenizer.readToken(Je)).trim();switch(n){case"DSD":return this.metadata.setFormat("container",`DSDIFF/${n}`),this.metadata.setFormat("lossless",!0),this.readFmt8Chunks(e.chunkSize-BigInt(Je.len));default:throw new Error(`Unsupported DSDIFF type: ${n}`)}}async readFmt8Chunks(e){for(;e>=po.len;){const n=await this.tokenizer.readToken(po);dn(`Chunk id=${n.chunkID}`),await this.readData(n),e-=BigInt(po.len)+n.chunkSize}}async readData(e){dn(`Reading data of chunk[ID=${e.chunkID}, size=${e.chunkSize}]`);const n=this.tokenizer.position;switch(e.chunkID.trim()){case"FVER":{const s=await this.tokenizer.readToken(J);dn(`DSDIFF version=${s}`);break}case"PROP":{if(await this.tokenizer.readToken(Je)!=="SND ")throw new Error("Unexpected PROP-chunk ID");await this.handleSoundPropertyChunks(e.chunkSize-BigInt(Je.len));break}case"ID3":{const s=await this.tokenizer.readToken(new kn(Number(e.chunkSize))),i=ol(s);await new Dr().parse(this.metadata,i,this.options);break}case"DSD":this.metadata.format.numberOfChannels&&this.metadata.setFormat("numberOfSamples",Number(e.chunkSize*BigInt(8)/BigInt(this.metadata.format.numberOfChannels))),this.metadata.format.numberOfSamples&&this.metadata.format.sampleRate&&this.metadata.setFormat("duration",this.metadata.format.numberOfSamples/this.metadata.format.sampleRate);break;default:dn(`Ignore chunk[ID=${e.chunkID}, size=${e.chunkSize}]`);break}const r=e.chunkSize-BigInt(this.tokenizer.position-n);r>0&&(dn(`After Parsing chunk, remaining ${r} bytes`),await this.tokenizer.ignore(Number(r)))}async handleSoundPropertyChunks(e){for(dn(`Parsing sound-property-chunks, remainingSize=${e}`);e>0;){const n=await this.tokenizer.readToken(po);dn(`Sound-property-chunk[ID=${n.chunkID}, size=${n.chunkSize}]`);const r=this.tokenizer.position;switch(n.chunkID.trim()){case"FS":{const i=await this.tokenizer.readToken(re);this.metadata.setFormat("sampleRate",i);break}case"CHNL":{const i=await this.tokenizer.readToken($e);this.metadata.setFormat("numberOfChannels",i),await this.handleChannelChunks(n.chunkSize-BigInt($e.len));break}case"CMPR":{const i=(await this.tokenizer.readToken(Je)).trim(),o=await this.tokenizer.readToken(ve),l=await this.tokenizer.readToken(new ne(o,"ascii"));i==="DSD"&&(this.metadata.setFormat("lossless",!0),this.metadata.setFormat("bitsPerSample",1)),this.metadata.setFormat("codec",`${i} (${l})`);break}case"ABSS":{const i=await this.tokenizer.readToken($e),o=await this.tokenizer.readToken(ve),l=await this.tokenizer.readToken(ve),c=await this.tokenizer.readToken(re);dn(`ABSS ${i}:${o}:${l}.${c}`);break}case"LSCO":{const i=await this.tokenizer.readToken($e);dn(`LSCO lsConfig=${i}`);break}default:dn(`Unknown sound-property-chunk[ID=${n.chunkID}, size=${n.chunkSize}]`),await this.tokenizer.ignore(Number(n.chunkSize))}const s=n.chunkSize-BigInt(this.tokenizer.position-r);s>0&&(dn(`After Parsing sound-property-chunk ${n.chunkSize}, remaining ${s} bytes`),await this.tokenizer.ignore(Number(s))),e-=BigInt(po.len)+n.chunkSize,dn(`Parsing sound-property-chunks, remainingSize=${e}`)}if(this.metadata.format.lossless&&this.metadata.format.sampleRate&&this.metadata.format.numberOfChannels&&this.metadata.format.bitsPerSample){const n=this.metadata.format.sampleRate*this.metadata.format.numberOfChannels*this.metadata.format.bitsPerSample;this.metadata.setFormat("bitrate",n)}}async handleChannelChunks(e){dn(`Parsing channel-chunks, remainingSize=${e}`);const n=[];for(;e>=Je.len;){const r=await this.tokenizer.readToken(Je);dn(`Channel[ID=${r}]`),n.push(r),e-=BigInt(Je.len)}return dn(`Channels: ${n.join(", ")}`),n}}var B;(function(t){t[t.string=0]="string",t[t.uint=1]="uint",t[t.uid=2]="uid",t[t.bool=3]="bool",t[t.binary=4]="binary",t[t.float=5]="float"})(B||(B={}));const QK={name:"dtd",container:{440786851:{name:"ebml",container:{17030:{name:"ebmlVersion",value:B.uint},17143:{name:"ebmlReadVersion",value:B.uint},17138:{name:"ebmlMaxIDWidth",value:B.uint},17139:{name:"ebmlMaxSizeWidth",value:B.uint},17026:{name:"docType",value:B.string},17031:{name:"docTypeVersion",value:B.uint},17029:{name:"docTypeReadVersion",value:B.uint}}},408125543:{name:"segment",container:{290298740:{name:"seekHead",container:{19899:{name:"seek",multiple:!0,container:{21419:{name:"id",value:B.binary},21420:{name:"position",value:B.uint}}}}},357149030:{name:"info",container:{29604:{name:"uid",value:B.uid},29572:{name:"filename",value:B.string},3979555:{name:"prevUID",value:B.uid},3965867:{name:"prevFilename",value:B.string},4110627:{name:"nextUID",value:B.uid},4096955:{name:"nextFilename",value:B.string},2807729:{name:"timecodeScale",value:B.uint},17545:{name:"duration",value:B.float},17505:{name:"dateUTC",value:B.uint},31657:{name:"title",value:B.string},19840:{name:"muxingApp",value:B.string},22337:{name:"writingApp",value:B.string}}},524531317:{name:"cluster",multiple:!0,container:{231:{name:"timecode",value:B.uid},22743:{name:"silentTracks ",multiple:!0},167:{name:"position",value:B.uid},171:{name:"prevSize",value:B.uid},160:{name:"blockGroup"},163:{name:"simpleBlock"}}},374648427:{name:"tracks",container:{174:{name:"entries",multiple:!0,container:{215:{name:"trackNumber",value:B.uint},29637:{name:"uid",value:B.uid},131:{name:"trackType",value:B.uint},185:{name:"flagEnabled",value:B.bool},136:{name:"flagDefault",value:B.bool},21930:{name:"flagForced",value:B.bool},156:{name:"flagLacing",value:B.bool},28135:{name:"minCache",value:B.uint},28136:{name:"maxCache",value:B.uint},2352003:{name:"defaultDuration",value:B.uint},2306383:{name:"timecodeScale",value:B.float},21358:{name:"name",value:B.string},2274716:{name:"language",value:B.string},134:{name:"codecID",value:B.string},25506:{name:"codecPrivate",value:B.binary},2459272:{name:"codecName",value:B.string},3839639:{name:"codecSettings",value:B.string},3883072:{name:"codecInfoUrl",value:B.string},2536e3:{name:"codecDownloadUrl",value:B.string},170:{name:"codecDecodeAll",value:B.bool},28587:{name:"trackOverlay",value:B.uint},224:{name:"video",container:{154:{name:"flagInterlaced",value:B.bool},21432:{name:"stereoMode",value:B.uint},176:{name:"pixelWidth",value:B.uint},186:{name:"pixelHeight",value:B.uint},21680:{name:"displayWidth",value:B.uint},21690:{name:"displayHeight",value:B.uint},21683:{name:"aspectRatioType",value:B.uint},3061028:{name:"colourSpace",value:B.uint},3126563:{name:"gammaValue",value:B.float}}},225:{name:"audio",container:{181:{name:"samplingFrequency",value:B.float},30901:{name:"outputSamplingFrequency",value:B.float},159:{name:"channels",value:B.uint},148:{name:"channels",value:B.uint},32123:{name:"channelPositions",value:B.binary},25188:{name:"bitDepth",value:B.uint}}},28032:{name:"contentEncodings",container:{25152:{name:"contentEncoding",container:{20529:{name:"order",value:B.uint},20530:{name:"scope",value:B.bool},20531:{name:"type",value:B.uint},20532:{name:"contentEncoding",container:{16980:{name:"contentCompAlgo",value:B.uint},16981:{name:"contentCompSettings",value:B.binary}}},20533:{name:"contentEncoding",container:{18401:{name:"contentEncAlgo",value:B.uint},18402:{name:"contentEncKeyID",value:B.binary},18403:{name:"contentSignature ",value:B.binary},18404:{name:"ContentSigKeyID  ",value:B.binary},18405:{name:"contentSigAlgo ",value:B.uint},18406:{name:"contentSigHashAlgo ",value:B.uint}}},25188:{name:"bitDepth",value:B.uint}}}}}}}}},475249515:{name:"cues",container:{187:{name:"cuePoint",container:{179:{name:"cueTime",value:B.uid},183:{name:"positions",container:{247:{name:"track",value:B.uint},241:{name:"clusterPosition",value:B.uint},21368:{name:"blockNumber",value:B.uint},234:{name:"codecState",value:B.uint},219:{name:"reference",container:{150:{name:"time",value:B.uint},151:{name:"cluster",value:B.uint},21343:{name:"number",value:B.uint},235:{name:"codecState",value:B.uint}}},240:{name:"relativePosition",value:B.uint}}}}}}},423732329:{name:"attachments",container:{24999:{name:"attachedFiles",multiple:!0,container:{18046:{name:"description",value:B.string},18030:{name:"name",value:B.string},18016:{name:"mimeType",value:B.string},18012:{name:"data",value:B.binary},18094:{name:"uid",value:B.uid}}}}},272869232:{name:"chapters",container:{17849:{name:"editionEntry",container:{182:{name:"chapterAtom",container:{29636:{name:"uid",value:B.uid},145:{name:"timeStart",value:B.uint},146:{name:"timeEnd",value:B.uid},152:{name:"hidden",value:B.bool},17816:{name:"enabled",value:B.uid},143:{name:"track",container:{137:{name:"trackNumber",value:B.uid},128:{name:"display",container:{133:{name:"string",value:B.string},17276:{name:"language ",value:B.string},17278:{name:"country ",value:B.string}}}}}}}}}}},307544935:{name:"tags",container:{29555:{name:"tag",multiple:!0,container:{25536:{name:"target",container:{25541:{name:"tagTrackUID",value:B.uid},25540:{name:"tagChapterUID",value:B.uint},25542:{name:"tagAttachmentUID",value:B.uid},25546:{name:"targetType",value:B.string},26826:{name:"targetTypeValue",value:B.uint},25545:{name:"tagEditionUID",value:B.uid}}},26568:{name:"simpleTags",multiple:!0,container:{17827:{name:"name",value:B.string},17543:{name:"string",value:B.string},17541:{name:"binary",value:B.binary},17530:{name:"language",value:B.string},17531:{name:"languageIETF",value:B.string},17540:{name:"default",value:B.bool}}}}}}}}}}},go=Ue("music-metadata:parser:ebml");var Lr;(function(t){t[t.ReadNext=0]="ReadNext",t[t.IgnoreElement=2]="IgnoreElement",t[t.SkipSiblings=3]="SkipSiblings",t[t.TerminateParsing=4]="TerminateParsing",t[t.SkipElement=5]="SkipElement"})(Lr||(Lr={}));class KK{constructor(e){this.tokenizer=e,this.padding=0,this.parserMap=new Map,this.ebmlMaxIDLength=4,this.ebmlMaxSizeLength=8,this.parserMap.set(B.uint,n=>this.readUint(n)),this.parserMap.set(B.string,n=>this.readString(n)),this.parserMap.set(B.binary,n=>this.readBuffer(n)),this.parserMap.set(B.uid,async n=>this.readBuffer(n)),this.parserMap.set(B.bool,n=>this.readFlag(n)),this.parserMap.set(B.float,n=>this.readFloat(n))}async iterate(e,n,r){return this.parseContainer(JA(e),n,r)}async parseContainer(e,n,r){const s={};for(;this.tokenizer.position<n;){let i;const o=this.tokenizer.position;try{i=await this.readElement()}catch(c){if(c instanceof pt)break;throw c}const l=e.container[i.id];if(l)switch(r.startNext(l)){case Lr.ReadNext:if(i.id,go(`Read element: name=${ya(l)}{id=0x${i.id.toString(16)}, container=${!!l.container}} at position=${o}`),l.container){const u=await this.parseContainer(l,i.len>=0?this.tokenizer.position+i.len:-1,r);l.multiple?(s[l.name]||(s[l.name]=[]),s[l.name].push(u)):s[l.name]=u,await r.elementValue(l,u,o)}else{const u=this.parserMap.get(l.value);if(typeof u=="function"){const d=await u(i);s[l.name]=d,await r.elementValue(l,d,o)}}break;case Lr.SkipElement:go(`Go to next element: name=${ya(l)}, element.id=0x${i.id}, container=${!!l.container} at position=${o}`);break;case Lr.IgnoreElement:go(`Ignore element: name=${ya(l)}, element.id=0x${i.id}, container=${!!l.container} at position=${o}`),await this.tokenizer.ignore(i.len);break;case Lr.SkipSiblings:go(`Ignore remaining container, at: name=${ya(l)}, element.id=0x${i.id}, container=${!!l.container} at position=${o}`),await this.tokenizer.ignore(n-this.tokenizer.position);break;case Lr.TerminateParsing:return go(`Terminate parsing at element: name=${ya(l)}, element.id=0x${i.id}, container=${!!l.container} at position=${o}`),s}else switch(i.id){case 236:this.padding+=i.len,await this.tokenizer.ignore(i.len);break;default:go(`parseEbml: parent=${ya(e)}, unknown child: id=${i.id.toString(16)} at position=${o}`),this.padding+=i.len,await this.tokenizer.ignore(i.len)}}return s}async readVintData(e){const n=await this.tokenizer.peekNumber(ve);let r=128,s=1;for(;!(n&r);){if(s>e)throw new Error("VINT value exceeding maximum size");++s,r>>=1}const i=new Uint8Array(s);return await this.tokenizer.readBuffer(i),i}async readElement(){const e=await this.readVintData(this.ebmlMaxIDLength),n=await this.readVintData(this.ebmlMaxSizeLength);return n[0]^=128>>n.length-1,{id:Dg(e,e.length),len:Dg(n,n.length)}}async readFloat(e){switch(e.len){case 0:return 0;case 4:return this.tokenizer.readNumber(DA);case 8:return this.tokenizer.readNumber(Ix);case 10:return this.tokenizer.readNumber(Ix);default:throw new Error(`Invalid IEEE-754 float length: ${e.len}`)}}async readFlag(e){return await this.readUint(e)===1}async readUint(e){const n=await this.readBuffer(e);return Dg(n,e.len)}async readString(e){return(await this.tokenizer.readToken(new ne(e.len,"utf-8"))).replace(/\x00.*$/g,"")}async readBuffer(e){const n=new Uint8Array(e.len);return await this.tokenizer.readBuffer(n),n}}function Dg(t,e){return Number(XK(t,e))}function XK(t,e){const n=new Uint8Array(8),r=t.subarray(0,e);try{return n.set(r,8-e),Vw.get(n,0)}catch{return BigInt(-1)}}function JA(t){return t.container&&Object.keys(t.container).map(e=>{const n=t.container[e];return n.id=Number.parseInt(e),n}).forEach(e=>{e.parent=t,JA(e)}),t}function ya(t){let e="";return t.parent&&t.parent.name!=="dtd"&&(e+=`${ya(t.parent)}/`),e+t.name}const Xd=Ue("music-metadata:parser:matroska");class YK extends sr{constructor(){super(...arguments),this.seekHeadOffset=0,this.flagUseIndexToSkipClusters=!1}init(e,n,r){return super.init(e,n,r),this.flagUseIndexToSkipClusters=r.mkvUseIndex??!1,this}async parse(){const e=this.tokenizer.fileInfo.size??Number.MAX_SAFE_INTEGER,n=new KK(this.tokenizer);Xd("Initializing DTD end MatroskaIterator"),await n.iterate(QK,e,{startNext:r=>{switch(r.id){case 475249515:return Xd(`Skip element: name=${r.name}, id=0x${r.id.toString(16)}`),Lr.IgnoreElement;case 524531317:if(this.flagUseIndexToSkipClusters&&this.seekHead){const s=this.seekHead.seek.find(i=>i.position+this.seekHeadOffset>this.tokenizer.position);if(s){const i=s.position+this.seekHeadOffset-this.tokenizer.position;return Xd(`Use index to go to next position, ignoring ${i} bytes`),this.tokenizer.ignore(i),Lr.SkipElement}}return Lr.IgnoreElement;default:return Lr.ReadNext}},elementValue:async(r,s,i)=>{switch(Xd(`Received: name=${r.name}, value=${s}`),r.id){case 17026:this.metadata.setFormat("container",`EBML/${s}`);break;case 290298740:this.seekHead=s,this.seekHeadOffset=i;break;case 357149030:{const o=s,l=o.timecodeScale?o.timecodeScale:1e6;if(typeof o.duration=="number"){const c=o.duration*l/1e9;await this.addTag("segment:title",o.title),this.metadata.setFormat("duration",Number(c))}}break;case 374648427:{const o=s;if(o!=null&&o.entries){o.entries.forEach(c=>{const u={codecName:c.codecID.replace("A_","").replace("V_",""),codecSettings:c.codecSettings,flagDefault:c.flagDefault,flagLacing:c.flagLacing,flagEnabled:c.flagEnabled,language:c.language,name:c.name,type:c.trackType,audio:c.audio,video:c.video};this.metadata.addStreamInfo(u)});const l=o.entries.filter(c=>c.trackType===qa.audio).reduce((c,u)=>!c||u.flagDefault&&!c.flagDefault||u.trackNumber<c.trackNumber?u:c,null);l&&(this.metadata.setFormat("codec",l.codecID.replace("A_","")),this.metadata.setFormat("sampleRate",l.audio.samplingFrequency),this.metadata.setFormat("numberOfChannels",l.audio.channels))}}break;case 307544935:{const o=s;await Promise.all(o.tag.map(async l=>{const c=l.target,u=c!=null&&c.targetTypeValue?jx[c.targetTypeValue]:c!=null&&c.targetType?c.targetType:"track";await Promise.all(l.simpleTags.map(async d=>{const m=d.string?d.string:d.binary;await this.addTag(`${u}:${d.name}`,m)}))}))}break;case 423732329:{const o=s;await Promise.all(o.attachedFiles.filter(l=>l.mimeType.startsWith("image/")).map(l=>this.addTag("picture",{data:l.data,format:l.mimeType,description:l.description,name:l.name})))}break}}})}async addTag(e,n){await this.metadata.addTag("matroska",e,n)}}const Of=Ue("music-metadata:parser:factory");function JK(t){const e=qw.parse(t),n=XG(e.type);return{type:n.type,subtype:n.subtype,suffix:n.suffix,parameters:e.parameters}}async function ZK(t,e){const{mimeType:n,path:r,url:s}=t.fileInfo,i=ZA(n)||$x(r)||$x(s);return i||Of(`No parser found for MIME-type / extension: ${n}`),eX(t,i,e)}async function eX(t,e,n){if(!e){Of("Guess parser on content...");const i=new Uint8Array(4100);if(await t.peekBuffer(i,{mayBeLess:!0}),t.fileInfo.path&&(e=$x(t.fileInfo.path)),!e){const o=await BA(i);if(!o)throw new Error("Failed to determine audio format");if(Of(`Guessed file type is mime=${o.mime}, extension=${o.ext}`),e=ZA(o.mime),!e)throw new Error(`Guessed MIME-type not supported: ${o.mime}`)}}const r=await tX(e),s=new jQ(n);return await r.init(s,t,n??{}).parse(),s.toCommonMetadata()}function $x(t){if(!t)return;switch(nX(t).toLocaleLowerCase()||t){case".mp2":case".mp3":case".m2a":case".aac":return"mpeg";case".ape":return"apev2";case".mp4":case".m4a":case".m4b":case".m4pa":case".m4v":case".m4r":case".3gp":return"mp4";case".wma":case".wmv":case".asf":return"asf";case".flac":return"flac";case".ogg":case".ogv":case".oga":case".ogm":case".ogx":case".opus":case".spx":return"ogg";case".aif":case".aiff":case".aifc":return"aiff";case".wav":case".bwf":return"riff";case".wv":case".wvp":return"wavpack";case".mpc":return"musepack";case".dsf":return"dsf";case".dff":return"dsdiff";case".mka":case".mkv":case".mk3d":case".mks":case".webm":return"matroska"}}async function tX(t){switch(t){case"aiff":return new LQ;case"adts":case"mpeg":return new bK;case"apev2":return new rs;case"asf":return new QQ;case"dsf":return new qK;case"dsdiff":return new GK;case"flac":return new YQ;case"mp4":return new Lf;case"musepack":return new RK;case"ogg":return new ep;case"riff":return new zK;case"wavpack":return new VK;case"matroska":return new YK;default:throw new Error(`Unknown parser type: ${t}`)}}function nX(t){const e=t.lastIndexOf(".");return e===-1?"":t.slice(e)}function ZA(t){let e;if(!t)return;try{e=JK(t)}catch{Of(`Invalid HTTP Content-Type header value: ${t}`);return}const n=e.subtype.indexOf("x-")===0?e.subtype.substring(2):e.subtype;switch(e.type){case"audio":switch(n){case"mp3":case"mpeg":return"mpeg";case"aac":case"aacp":return"adts";case"flac":return"flac";case"ape":case"monkeys-audio":return"apev2";case"mp4":case"m4a":return"mp4";case"ogg":case"opus":case"speex":return"ogg";case"ms-wma":case"ms-wmv":case"ms-asf":return"asf";case"aiff":case"aif":case"aifc":return"aiff";case"vnd.wave":case"wav":case"wave":return"riff";case"wavpack":return"wavpack";case"musepack":return"musepack";case"matroska":case"webm":return"matroska";case"dsf":return"dsf"}break;case"video":switch(n){case"ms-asf":case"ms-wmv":return"asf";case"m4v":case"mp4":return"mp4";case"ogg":return"ogg";case"matroska":case"webm":return"matroska"}break;case"application":switch(n){case"vnd.ms-asf":return"asf";case"ogg":return"ogg"}break}}async function rX(t,e={}){const n={mimeType:t.type,size:t.size};return t instanceof File&&(n.path=t.name),sX(t.stream(),n,e)}function sX(t,e,n={}){return iX(PA(t,{fileInfo:typeof e=="string"?{mimeType:e}:e}),n)}function iX(t,e){return ZK(t,e)}const e5=async t=>{var l;if(!t)return;const e=await rX(t);if(!e)return;const{common:{title:n,artist:r,picture:s},format:{duration:i}}=e;return Object.assign({},{name:n||t.name,singer:r||"...",duration:i||0,image:s?(l=s[0])==null?void 0:l.data:null})};function aX(t){const{setErrorToast:e,setSuccessToast:n}=fe(),{songFile:r,imageFile:s,setSong:i,setImageFile:o,updateSongData:l,setSongData:c,resetAddSongContext:u,songData:d,singers:m,song:p,genres:g,setGenres:y,setSingers:w,imageBlob:_,setImageBlob:E,...b}=so(),[S,C]=f.useState(!1),D=f.useRef(null),F=f.useMemo(()=>{if(t.variant==="add")return!0;if(!p||!d)return!1;if(d.name!==p.name||m.length!==p.singers.length||d.like!==p.like||g.length!==p.genres.length)return!0;const me=!m.find(Ne=>p.singers.find(H=>H.id==Ne.id)),ye=!g.find(Ne=>p.genres.find(H=>H.id==Ne.id));return me||ye},[d,p,m,g]),I=!!s,k=f.useMemo(()=>{const ee=!!(d!=null&&d.name)&&!!m.length&&!!g.length&&F;return t.variant==="add"?ee:ee||I},[I,F,m,g,d]),R=()=>{switch(t.variant){case"add":return Ex({owner_email:t.ownerEmail,distributor:t.distributor,is_official:!0});case"edit":const{id:ee,updated_at:me,...ye}=t.song;return w(ye.singers),y(ye.genres),Ex(ye)}},j=()=>{var ee,me;switch(t.variant){case"add":(ee=D.current)==null||ee.close(),setTimeout(()=>u(R()),500);break;case"edit":(me=D.current)==null||me.close()}},N=async()=>{if(!r)return;const ee=await e5(r);if(ee){const me={name:ee.name,duration:Math.floor(ee.duration),size:Math.floor(r.size/1024),image_url:""};if(ee.image){const ye=new Blob([ee.image]);E(ye),me.image_url=URL.createObjectURL(ye)}l(me)}},P=()=>{const ee={},me={};return g.forEach(ye=>ee[ye.id]=!0),m.forEach(ye=>me[ye.id]=!0),{genre_map:ee,singer_map:me}},A=async()=>{var ee,me;try{if(!k||!d)return;const ye={...d};if(C(!0),s||_){const Ne=await na({imageFile:s,blob:_});t.variant==="edit"&&(p!=null&&p.image_file_path)&&Xn({filePath:p.image_file_path,msg:">>> api: Delete image file"}),Object.assign(ye,Ne)}switch(t.variant){case"add":{if(!r)return;const{filePath:Ne,fileURL:H}=await Cw({file:r,folder:"/songs/",msg:">>> api: upload song file",namePrefix:"song"}),Y={singers:m,genres:g,song_url:H,song_file_path:Ne,...P()};Object.assign(ye,Y),await Ks({collectionName:"Songs",data:ye,msg:">>> api: set song doc"}),n(),(ee=D.current)==null||ee.open();break}case"edit":{if(!p)return;if(F){const Ne={singers:m,genres:g,...P()};Object.assign(ye,Ne)}p&&i({...p,...ye}),o(void 0),await kt({collectionName:"Songs",id:p.id,data:ye}),n(),(me=D.current)==null||me.open()}}}catch(ye){console.log(ye),e()}finally{C(!1)}};return f.useEffect(()=>{c(R())},[]),f.useEffect(()=>{r&&N()},[r]),f.useEffect(()=>{s&&l({image_url:URL.createObjectURL(s)})},[s]),{isValidToSubmit:k,handleSubmit:A,isFetching:S,updateSongData:l,songFile:r,songData:d,genres:g,singers:m,modalRef:D,handleCloseModalAfterFinished:j,...b}}function oX({handleCloseModal:t,variant:e}){return a.jsxs(ai,{children:[a.jsx(Se,{title:"Finished"}),a.jsx(Ye,{width:"w-[120px]",className:"mx-auto w-[120px]",src:"https://zalo-api.zadn.vn/api/emoticon/sticker/webpc?eid=46985&size=130"}),a.jsxs("div",{className:"flex justify-center mt-5 space-x-2",children:[a.jsxs(ce,{href:"/dashboard/song",children:[a.jsx(kI,{className:"w-6"}),a.jsx("span",{children:"Songs"})]}),a.jsxs(ce,{onClick:t,children:[a.jsx(br,{className:"w-6"}),a.jsx("span",{children:e==="add"?"Add more":"Ok"})]})]})]})}function lX(){const t=f.useRef(null),{songData:e,updateSongData:n,song:r}=so(),[s,i]=f.useState({name:e==null?void 0:e.name,like:e==null?void 0:e.like}),o=c=>{i(u=>({...u,...c}))},l=()=>{var c;n(s),(c=t.current)==null||c.close()};return a.jsxs(a.Fragment,{children:[a.jsxs(ce,{onClick:()=>{var c;return(c=t.current)==null?void 0:c.open()},className:"p-1.5 justify-center md:px-3",size:"clear",children:[a.jsx(Js,{className:"w-6"}),a.jsx("span",{className:"hidden md:block",children:"Edit"})]}),a.jsx(we,{to:`/dashboard/lyric/${r==null?void 0:r.id}`,children:a.jsxs(ce,{children:[a.jsx(gD,{className:"w-6"}),a.jsx("span",{children:"Lyric"})]})}),a.jsx(Tr,{variant:"animation",wrapped:!1,ref:t,children:a.jsxs(kr,{children:[a.jsx(jt,{title:"Edit song",close:()=>{var c;return(c=t.current)==null?void 0:c.close()}}),a.jsxs("div",{className:"space-y-2.5",children:[a.jsxs("div",{children:[a.jsx("p",{children:"Name:"}),a.jsx(Ht,{className:"bg-black/10",value:s==null?void 0:s.name,onChange:c=>o({name:c.target.value})})]}),a.jsxs("div",{className:"t",children:[a.jsx("p",{children:"Like:"}),a.jsx(Ht,{className:"bg-black/10",value:s==null?void 0:s.like,onChange:c=>isNaN(+c.target.value)?{}:o({like:+c.target.value})})]})]}),a.jsx("p",{className:"mt-6 text-right",children:a.jsx(ce,{onClick:l,children:"Ok"})})]})})]})}function cX(){const{setImageFile:t,songData:e,updateSongData:n,imageBlob:r,setImageBlob:s}=so(),i=f.useRef(null),o=f.useRef(null),l=u=>{var d;(d=u.target.files)!=null&&d.length&&t(u.target.files[0])},c=()=>{e&&(s(void 0),URL.revokeObjectURL(e.image_url),n({image_url:""}))};return a.jsxs(a.Fragment,{children:[a.jsx(ce,{className:"",size:"clear",children:a.jsxs("label",{htmlFor:"image_upload",className:"inline-flex p-1.5 space-x-1 cursor-pointer md:px-3",children:[a.jsx(xl,{className:"w-6"}),a.jsx("span",{className:"hidden md:block",children:"Change image"})]})}),r&&a.jsx(ce,{onClick:c,className:"h-[36px] justify-center w-[36px]",size:"clear",children:a.jsx(Zs,{className:"w-6"})}),(e==null?void 0:e.image_url)&&a.jsxs(ce,{onClick:()=>{var u;return(u=o.current)==null?void 0:u.open()},className:"p-1.5 justify-center md:px-3",size:"clear",children:[a.jsx(AI,{className:"w-6"}),a.jsx("span",{className:"hidden md:block",children:"Image info"})]}),a.jsx("input",{ref:i,onChange:l,type:"file",multiple:!0,accept:"image/png, image/jpeg",id:"image_upload",className:"hidden"}),(e==null?void 0:e.image_url)&&a.jsx(Tr,{variant:"animation",ref:o,wrapped:!1,children:a.jsxs(kr,{children:[a.jsxs("p",{children:["Url: ",e==null?void 0:e.image_url]}),a.jsxs("p",{children:["Hash: ",e==null?void 0:e.blurhash_encode]})]})})]})}function uX({isEdit:t}){return a.jsx(a.Fragment,{children:a.jsxs("div",{className:"-mt-2 -ml-2 flex flex-wrap w-full [&_button]:mt-2 [&_button]:ml-2",children:[a.jsx(cX,{}),t&&a.jsx(lX,{})]})})}function t5(t){const{isFetching:e,handleSubmit:n,updateSongData:r,songData:s,isValidToSubmit:i,songFile:o,modalRef:l,handleCloseModalAfterFinished:c}=aX(t),u=f.useRef(null);return t.variant==="add"&&!o?a.jsx(Wt,{children:a.jsx(IA,{})}):a.jsxs("div",{className:"w-full md:max-w-[800px] md:mx-auto",children:[a.jsx("audio",{ref:u,src:t.variant==="add"?URL.createObjectURL(o):(s==null?void 0:s.song_url)||"",className:"hidden"}),s&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"md:flex md:space-x-5",children:[a.jsxs("div",{className:"flex flex-col items-center md:w-1/3 md:block space-y-2.5",children:[a.jsx("div",{className:"w-[200px] h-[200px] mx-auto bg-black/5 rounded-lg overflow-hidden",children:a.jsx(Ye,{className:"object-cover h-full",blurHashEncode:s.blurhash_encode,src:s.image_url})}),t.variant==="edit"&&a.jsxs("div",{className:"w-full",children:[a.jsx(Se,{title:s.name}),a.jsxs(yn,{className:"[&>*]:text-sm ",children:[a.jsxs("p",{children:["Duration: ",zs(s.duration)]}),a.jsxs("p",{children:["Size: ",s.size," kb"]}),a.jsxs("p",{className:"mt-1 font-[500]",children:[a.jsx("span",{className:"text-red-500 text-xl",children:"❤"})," ",_r(s.like)]})]})]}),a.jsx("div",{className:"w-full",children:a.jsx(uX,{isEdit:t.variant==="edit"})})]}),a.jsxs("div",{className:"mt-5 md:mt-0 space-y-3 flex-grow",children:[u.current&&a.jsx(sG,{variant:t.variant,audioEle:u.current}),t.variant==="add"&&a.jsx(yn,{children:a.jsxs("span",{children:["Duration: ",zs(s.duration)," , Size: ",s.size,"kb"]})}),t.variant==="add"&&a.jsxs("div",{className:"",children:[a.jsx(Se,{title:"Name"}),a.jsx(Ht,{value:s.name,onChange:d=>r({name:d.target.value})})]}),a.jsx(rG,{}),a.jsx(aG,{})]})]}),a.jsx("p",{className:"text-center mt-5",children:a.jsxs(ce,{onClick:n,disabled:!i,loading:e,children:[a.jsx(rv,{className:"w-6"}),a.jsx("span",{children:"Ok"})]})}),a.jsx(De,{persisted:t.variant==="add",ref:l,wrapped:!1,variant:"animation",children:a.jsx(oX,{variant:t.variant,handleCloseModal:c})})]})]})}function dX(){const{user:t}=xe();if(t)return a.jsxs("div",{className:"pb-[46px]",children:[a.jsx(Se,{className:"mb-5",title:"Add Song"}),a.jsx(t5,{distributor:t.display_name,ownerEmail:t.email,variant:"add"})]})}function hX(){const[t,e]=f.useState(!0),[n,r]=f.useState(),s=f.useRef(!1),i=Gt(),{setErrorToast:o}=fe();return{song:n,isFetching:t,getSong:async c=>{try{const u=await Hr({collectionName:"Songs",id:c});if(!u.exists())return i("/dashboard/song");const d={...u.data(),id:u.id,queue_id:""};r(d)}catch(u){console.log(u),o()}finally{e(!1)}},ranEffect:s}}function fX(){const{getSong:t,isFetching:e,song:n,ranEffect:r}=hX(),{variant:s,setSong:i}=so(),o=Xi();return f.useEffect(()=>{if(!r.current){if(s.current="edit",r.current=!0,!o.songId)return;t(o.songId)}},[]),f.useEffect(()=>{n&&i(n)},[n]),e?a.jsx(Wt,{children:a.jsx(Ku,{})}):n?a.jsxs("div",{className:"pb-[46px]",children:[a.jsx(Se,{className:"mb-5",title:"Edit Song"}),a.jsx(t5,{song:n,variant:"edit"})]}):a.jsx(a.Fragment,{})}const mX=["All","Result"];function pX(){const{setPlaylists:t,playlists:e}=Pn(),[n,r]=f.useState(""),[s,i]=f.useState(!0),[o,l]=f.useState("All"),{setErrorToast:c}=fe(),u=async m=>{try{m.preventDefault(),i(!0);const p=he(wr,Q("is_official","==",!0),Q("is_album","==",!1),Q("name",">=",n),Q("name","<=",n+"")),g=await Wr(p);t(g),l("Result")}catch(p){console.log({message:p}),c()}finally{i(!1)}},d=async()=>{try{i(!0);const m=he(wr,Q("is_official","==",!0),Q("is_album","==",!1),Vr("updated_at","desc")),p=await Wr(m);t(p)}catch(m){console.log({message:m}),c()}finally{i(!1)}};return f.useEffect(()=>{o==="All"&&d()},[o]),{isFetching:s,value:n,setValue:r,handleSubmit:u,playlists:e,tab:o,setTab:l,tabs:mX}}function gX(){const{user:t}=xe(),{handleAddPlaylist:e,isFetching:n}=XR(),r=f.useRef(null),s=()=>{var o;return(o=r.current)==null?void 0:o.close()},i=async(o,l)=>{o.is_official=!0,await e(o,l),s()};if(t)return a.jsxs(a.Fragment,{children:[a.jsxs(ce,{onClick:()=>{var o;return(o=r.current)==null?void 0:o.open()},className:"self-start p-1.5 ml-5",size:"clear",children:[a.jsx(gs,{className:"w-6"}),a.jsx("div",{className:"hidden md:block",children:"Add new playlist"})]}),a.jsx(De,{ref:r,variant:"animation",children:a.jsx(kr,{className:"w-[500px]",children:a.jsx(Il,{close:s,isLoading:n,variant:"add",user:t,submit:i})})})]})}function xX(){const{isFetching:t,playlists:e,tab:n,tabs:r,setTab:s,...i}=pX();return a.jsxs("div",{className:"pb-[46px]",children:[a.jsx(Se,{title:"Playlists"}),a.jsxs("div",{className:"flex justify-between mt-3",children:[a.jsx(Rl,{...i}),a.jsx(gX,{})]}),a.jsx("div",{className:`mt-5 w-fit ${n==="All"?"pointer-events-none":""} self-start`,children:a.jsx(ys,{tabs:r,render:o=>o,tab:n,setTab:s})}),a.jsxs("div",{className:"mt-3",children:[t&&a.jsx(le,{className:"h-[200px] rounded-xl"}),!t&&a.jsx(ra,{colList:["Name","Like",""],children:e.length?e.map((o,l)=>a.jsxs("tr",{children:[a.jsx("td",{children:a.jsx(we,{className:"hover:underline",to:`/dashboard/playlist/${o.id}`,children:o.name})}),a.jsx("td",{children:_r(o.like)}),a.jsx("td",{children:"-"})]},l)):a.jsx("tr",{children:a.jsx("td",{colSpan:4,children:a.jsx(Xe,{})})})})]})]})}function yX(){const[t,e]=f.useState([]),[n,r]=f.useState(""),[s,i]=f.useState(!1),{setErrorToast:o}=fe();return{isFetching:s,value:n,songs:t,setValue:r,handleSubmit:async c=>{try{c.preventDefault(),i(!0);const u=he(wn,Q("name",">=",n),Q("name","<=",n+""),Q("is_official","==",!0)),d=await _n(u);e(d)}catch(u){console.log({message:u}),o()}finally{i(!1)}}}}function vX({closeModal:t,submit:e,isLoading:n}){const{theme:r}=q(),{songs:s,isFetching:i,...o}=yX(),{selectedSongs:l,selectSong:c}=Eu(),u=async()=>{l.length&&(e(l),t())},d=f.useMemo(()=>{const p=l.map(g=>g.id);return s.filter(g=>!p.includes(g.id))},[s,l]),m={col:"md:w-1/2 flex-1 flex flex-col px-2 overflow-hidden",box:"rounded-lg bg-black/10 p-2",songItem:"rounded-md w-full p-1 text-left"};return a.jsx(a.Fragment,{children:a.jsxs(kr,{className:"w-[750px] h-[500px] flex flex-col overflow-hidden",children:[a.jsx(jt,{close:t,title:"Add song"}),a.jsxs("div",{className:"flex-grow flex flex-col md:flex-row -mx-2",children:[a.jsxs("div",{className:`${m.col}`,children:[a.jsx(Rl,{...o}),a.jsx("div",{className:`${m.box} flex-grow mt-3`,children:a.jsx("div",{className:"h-full overflow-auto pace-y-2",children:i?a.jsx(Ku,{className:"h-full"}):d.map((p,g)=>a.jsx("button",{onClick:()=>c(p),className:`${m.songItem} bg-black/10 ${r.content_hover_bg}`,children:a.jsx("h5",{className:"",children:p.name})},g))})})]}),a.jsxs("div",{className:`${m.col} mt-3 md:mt-0`,children:[a.jsx("div",{className:"font-[500] mb-3",children:"Selected:"}),a.jsx("div",{className:`${m.box} flex-grow overflow-auto space-y-2 `,children:l.map((p,g)=>a.jsx("button",{onClick:()=>c(p),className:`${m.songItem} ${r.content_bg} hover:bg-black/10 hover:text-black`,children:a.jsx("h5",{className:"",children:p.name})},g))})]})]}),a.jsx("p",{className:"text-right mt-3 flex-shrink-0",children:a.jsxs(ce,{disabled:!l.length,loading:n,onClick:u,children:[a.jsx(Iu,{className:"w-6"}),a.jsx("span",{children:"Add"})]})})]})})}function n5(t){return a.jsx(ps,{children:a.jsx(vX,{...t})})}function Zw({children:t}){return a.jsx("div",{className:"-ml-2 -mt-2 [&_button]:mt-2 [&_button]:ml-2 [&_button]:p-1.5 md:[&_button]:px-3  [&_span]:hidden md:[&_span]:block",children:t})}function wX(){const[t,e]=f.useState(""),n=f.useRef(null),{action:r,playlist:s,isFetching:i}=Km(),o=d=>{var m,p;e(d),t==="add-song-to-playlist"&&((m=n.current)==null||m.setModalPersist(!0)),(p=n.current)==null||p.open()},l=()=>{var d;return(d=n.current)==null?void 0:d.close()},c=async d=>{await r(d),l()},u=()=>{switch(t){case"":return a.jsx(a.Fragment,{});case"edit":return s?a.jsx(a.Fragment,{children:a.jsx(kr,{className:"w-[500px]",children:a.jsx(Il,{submit:(d,m)=>c({variant:"edit-playlist",playlist:d,imageFile:m}),variant:"edit",isLoading:i,playlist:s,close:l})})}):"Playlist is undefined";case"delete":return a.jsx(xs,{loading:i,label:"Delete playlist ?",callback:()=>c({variant:"delete-playlist"}),close:l});case"add-song-to-playlist":return a.jsx(n5,{isLoading:i,submit:d=>c({variant:"add-songs",songs:d}),closeModal:l})}};return a.jsxs(a.Fragment,{children:[a.jsxs(Zw,{children:[a.jsxs(ce,{onClick:()=>o("edit"),size:"clear",children:[a.jsx(Js,{className:"w-5"}),a.jsx("span",{children:"Edit"})]}),a.jsxs(ce,{onClick:()=>o("delete"),size:"clear",children:[a.jsx(Fn,{className:"w-5"}),a.jsx("span",{children:"Delete"})]}),a.jsxs(ce,{onClick:()=>o("add-song-to-playlist"),size:"clear",children:[a.jsx(PH,{className:"w-5"}),a.jsx("span",{children:"Add song"})]})]}),a.jsx(De,{wrapped:!1,variant:"animation",ref:n,children:a.jsx(ai,{className:"w-[unset]",children:u()})})]})}function _X(){const[t,e]=f.useState(!0),{setSongs:n,setPlaylist:r,playlist:s,songs:i}=Ow(),o=f.useRef(!1),l=Xi(),c=Gt(),{setErrorToast:u}=fe(),d=async()=>{try{if(!l.id)return;const m=await Hr({collectionName:"Playlists",id:l.id});if(!m.exists())return c("/dashboard/playlist");const p={...m.data(),id:m.id};if(p.song_ids.length){const g=he(wn,Q(ti(),"in",p.song_ids)),y=await _n(g);n(y)}r(p)}catch(m){console.log(m),u()}finally{e(!1)}};return f.useEffect(()=>{o.current||(o.current=!0,d())},[]),{songs:i,playlist:s,isFetching:t}}function bX({singer:t}){const{action:e}=Km();return a.jsxs(a.Fragment,{children:[a.jsx(we,{className:"hover:underline",to:`/dashboard/singer/${t.id}`,children:t.name}),a.jsx("div",{children:a.jsx("button",{onClick:()=>e({variant:"remove-singer",singer:t}),children:a.jsx(Fn,{className:"w-5"})})})]})}function SX(t){const{playlist:e}=Ow(),{updatePlaylistData:n,playlistData:r,isValidToSubmit:s}=tA(t),{action:i,isFetching:o}=Km(),l=f.useRef(null),c=f.useRef(null),u=async()=>{var d;!r||!s||(await i({variant:"edit-playlist",playlist:r}),(d=l.current)==null||d.close())};if(e)return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsxs("p",{className:"mt-1 font-[500]",children:[a.jsx("span",{className:"text-red-500 text-xl",children:"❤"})," ",_r(e.like)]}),a.jsx("button",{className:"",onClick:()=>{var d;return(d=l.current)==null?void 0:d.open()},children:a.jsx(Js,{className:"w-5"})})]}),a.jsx(Tr,{wrapped:!1,variant:"animation",ref:l,children:a.jsxs(kr,{children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"like",children:"Like"}),a.jsx(Ht,{id:"like",ref:c,type:"number",value:(r==null?void 0:r.like)+"",onChange:d=>n({like:+d.target.value})})]}),a.jsx("p",{className:"text-right mt-5 md:mt-0",children:a.jsx(ce,{loading:o,color:"primary",onClick:u,disabled:!s,className:"font-playwriteCU rounded-full",children:"Save"})})]})})]})}function EX(){const{isFetching:t,songs:e,playlist:n}=_X(),r=f.useMemo(()=>e.reduce((s,i)=>s+i.duration,0),[e]);return t?a.jsx(Wt,{children:a.jsx(Ku,{})}):n?a.jsxs("div",{className:"pb-[46px]",children:[a.jsx(Se,{title:"Edit playlist",className:"mb-3"}),a.jsxs("div",{className:"md:flex md:-mx-3",children:[a.jsxs("div",{className:"space-y-2.5 md:px-3",children:[a.jsx("div",{className:"w-[200px] h-[200px] mx-auto",children:a.jsx(Ru,{children:a.jsx(Ye,{className:"object-cover h-full",blurHashEncode:n.blurhash_encode,src:n.image_url})})}),a.jsxs("div",{children:[a.jsx(Se,{title:n.name}),a.jsxs(yn,{className:"mt-1",children:[a.jsx("p",{children:n.is_public?"Public":"Private"}),a.jsxs("p",{children:[e.length," songs - ",zs(r)]}),a.jsx(SX,{variant:"edit",playlist:n})]})]}),a.jsx(wX,{})]}),a.jsxs("div",{className:"w-full mt-3 md:mt-0 md:w-3/4 md:px-3",children:[a.jsx(Se,{title:"Singers"}),a.jsx(yn,{className:"mt-1",children:n.singers.length?a.jsx("div",{className:"-mt-2 -ml-2 flex ",children:n.singers.map((s,i)=>a.jsx(jl,{children:a.jsx(bX,{singer:s})},i))}):a.jsx(Xe,{})}),a.jsx(Se,{title:"Songs",className:"mt-3"}),a.jsx(yn,{className:"mt-1",children:a.jsx("div",{className:"overflow-hidden",children:a.jsx(UI,{className:"[&_td]:text-sm [&_tbody>tr]:border-t [&_tr]:border-black/10 [&_th]:text-sm [&_th]:text-left [&_td]:p-2 [&_th]:p-2 hover:[&_tr:not(div.absolute)]:bg-black/5",colList:["Name","Singer","Like",""],children:e.length?e.map((s,i)=>a.jsx(EA,{variant:"playlist",song:s},i)):a.jsx("tr",{children:a.jsx("td",{colSpan:3,children:a.jsx(Xe,{})})})})})})]})]})]}):a.jsx(a.Fragment,{})}function kX(t){const{setErrorToast:e,setSuccessToast:n}=fe(),{singer:r,setSinger:s,setSingers:i}=Ys(),[o,l]=f.useState(),[c,u]=f.useState(),[d,m]=f.useState(!1),p=f.useRef(null),g=S=>{o&&l({...o,...S})},y=f.useMemo(()=>t.variant==="add"?!0:!r||!o?!1:o.name!==r.name||o.description!==r.description||o.like!==r.like,[o]),w=!!c,_=f.useMemo(()=>{const S=!!(o!=null&&o.name)&&y;return t.variant==="add"?S:S||w},[w,y,o]),E=async()=>{try{if(!_||!o)return;m(!0);const S={...o};if(c){const C=await na({imageFile:c});Object.assign(S,C)}switch(t.variant){case"add":{const C=await Ks({collectionName:"Singers",data:S}),D={...o,id:C.id};i(F=>[D,...F]),n("Add singer successful");break}case"edit":{if(!r)return;await kt({collectionName:"Singers",id:r.id,data:S}),s({...r,...S}),n("Edit singer successful")}}}catch(S){console.log(S),e()}finally{m(!1),t.closeModal()}},b=()=>{switch(t.variant){case"add":return If({});case"edit":if(!r)throw new Error("");const{id:S,...C}=r;return If(C)}};return f.useEffect(()=>{var S;t.variant==="add"&&((S=p.current)==null||S.focus()),l(b())},[]),f.useEffect(()=>{c&&g({image_url:URL.createObjectURL(c)})},[c]),f.useEffect(()=>{var S;(S=p.current)==null||S.focus()},[]),{singerData:o,imageFile:c,setImageFile:u,updateSingerData:g,setSingerData:l,inputRef:p,handleSubmit:E,isFetching:d,isValidToSubmit:_}}function r5(t){const{theme:e}=q(),{setImageFile:n,singerData:r,handleSubmit:s,isFetching:i,isValidToSubmit:o,updateSingerData:l,inputRef:c}=kX(t),u=d=>{var m;(m=d.target.files)!=null&&m.length&&n(d.target.files[0])};if(r)return a.jsxs(kr,{className:"w-[700px] flex flex-col md:block",children:[a.jsx(jt,{close:t.closeModal,title:t.variant==="add"?"Add singer":"Edit singer"}),a.jsxs("div",{className:"flex-grow overflow-auto md:flex md:flex-[unset] md:overflow-hidden",children:[a.jsxs("div",{className:"space-y-2.5",children:[a.jsx("div",{className:"w-[200px] h-[200px] rounded-lg overflow-hidden",children:a.jsx(Ye,{className:"object-cover object-center h-full",blurHashEncode:r.blurhash_encode,src:r.image_url})}),a.jsx("input",{onChange:u,type:"file",multiple:!0,accept:"image/png, image/jpeg, image/webp",id:"image_upload",className:"hidden"}),a.jsx("div",{className:"space-x-2 flex",children:a.jsx(ce,{className:`${e.content_bg}`,size:"clear",children:a.jsx("label",{htmlFor:"image_upload",className:"px-5 py-1 cursor-pointer ",children:a.jsx(xl,{className:"w-5"})})})})]}),a.jsxs("div",{className:"flex-grow flex flex-col mt-3  space-y-2.5 md:mt-0 md:ml-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{htmlFor:"name",className:"opacity-[.8]",children:"Name:"}),a.jsx(Ht,{ref:c,type:"text",id:"name",placeholder:"",className:"bg-[#f1f1f1]",value:r.name,onChange:d=>l({name:d.target.value})})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{htmlFor:"description",className:"opacity-[.8]",children:"Description:"}),a.jsx("textarea",{placeholder:"...",id:"description",className:`${cv} w-full bg-[#f1f1f1] rounded-md min-h-[100px]`,value:r.description,onChange:d=>l({description:d.target.value})})]}),t.variant==="edit"&&a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{htmlFor:"like",className:"opacity-[.8]",children:"Like:"}),a.jsx(Ht,{id:"like",className:"bg-[#f1f1f1]",type:"number",value:r.like+"",onChange:d=>l({like:+d.target.value})})]})]})]}),a.jsx("p",{className:"text-right mt-3",children:a.jsx(ce,{loading:i,color:"primary",onClick:s,disabled:!o,className:"font-playwriteCU rounded-full",children:"Save"})})]})}function TX(){const t=f.useRef(null),e=()=>{var n;return(n=t.current)==null?void 0:n.close()};return a.jsxs(a.Fragment,{children:[a.jsxs(ce,{onClick:()=>{var n;return(n=t.current)==null?void 0:n.open()},className:"self-start p-1.5 ml-5",size:"clear",children:[a.jsx(gs,{className:"w-6"}),a.jsx("div",{className:"hidden md:block",children:"Add new singer"})]}),a.jsx(De,{wrapped:!1,ref:t,variant:"animation",children:a.jsx(ai,{className:"w-[unset]",children:a.jsx(r5,{closeModal:e,variant:"add"})})})]})}const IX=["All","Result"];function CX(){const{setSingers:t,singers:e}=Ys(),[n,r]=f.useState(""),[s,i]=f.useState(!0),[o,l]=f.useState("All"),{setErrorToast:c}=fe(),u=async m=>{try{m.preventDefault(),i(!0);const p=he(kf,Q("name",">=",n),Q("name","<=",n+"")),g=await Tf(p);t(g),l("Result")}catch(p){console.log({message:p}),c()}finally{i(!1)}},d=async()=>{try{i(!0);const m=he(kf,Vr("created_at","desc")),p=await Tf(m);t(p)}catch(m){console.log({message:m}),c()}finally{i(!1)}};return f.useEffect(()=>{o==="All"&&d()},[o]),{isFetching:s,value:n,setValue:r,handleSubmit:u,singers:e,tab:o,setTab:l,tabs:IX}}function jX(){const{isFetching:t,singers:e,tabs:n,tab:r,setTab:s,...i}=CX();return a.jsxs("div",{className:"pb-[46px]",children:[a.jsx(Se,{title:"Singer"}),a.jsxs("div",{className:"flex justify-between mt-3",children:[a.jsx(Rl,{...i}),a.jsx(TX,{})]}),a.jsx("div",{className:`mt-5 w-fit ${r==="All"?"pointer-events-none":""} self-start`,children:a.jsx(ys,{tabs:n,render:o=>o,tab:r,setTab:s})}),a.jsxs("div",{className:"mt-3",children:[t&&a.jsx(le,{className:"h-[200px] rounded-xl"}),!t&&a.jsx(ra,{colList:["Name","Like"],children:e.length?e.map((o,l)=>a.jsxs("tr",{children:[a.jsx("td",{children:a.jsx(we,{className:"hover:underline",to:`/dashboard/singer/${o.id}`,children:o.name})}),a.jsx("td",{children:_r(o.like)})]},l)):a.jsx("tr",{children:a.jsx("td",{colSpan:2,children:a.jsx(Xe,{})})})})]})]})}function RX({value:t}){const e=f.useRef(null);return a.jsxs(a.Fragment,{children:[a.jsxs(ce,{onClick:()=>{var n;return(n=e.current)==null?void 0:n.open()},className:"p-1.5 ml-5",size:"clear",children:[a.jsx(br,{className:"w-6"}),a.jsx("div",{className:"hidden md:block",children:"Add genre"})]}),a.jsx(De,{ref:e,variant:"animation",wrapped:!1,children:a.jsx(zw,{genreName:t,type:"add",closeModal:()=>{var n;return(n=e.current)==null?void 0:n.close()}})})]})}function AX({genre:t}){const[e,n]=f.useState(""),r=f.useRef(null),{action:s,isFetching:i}=jA(),o=u=>{var d;n(u),(d=r.current)==null||d.open()},l=()=>{var u;return(u=r.current)==null?void 0:u.close()},c=async()=>{await s({type:"delete",id:t.id})};return a.jsxs(a.Fragment,{children:[a.jsxs(jl,{children:[a.jsx("span",{children:t.name}),a.jsxs("div",{children:[a.jsx("button",{className:"",onClick:()=>o("edit"),children:a.jsx(Js,{className:"w-5"})}),a.jsx("button",{onClick:()=>o("delete"),children:a.jsx(Fn,{className:"w-5"})})]})]}),a.jsxs(De,{variant:"animation",ref:r,wrapped:!1,children:[e==="edit"&&a.jsx(zw,{type:"edit",genre:t,closeModal:l}),e==="delete"&&a.jsx(ai,{children:a.jsx(xs,{callback:c,close:l,loading:i,label:`Delete genre '${t.name}'`})})]})]})}function NX(){const{isFetching:t,api:e}=RA(),{_genres:n,...r}=AA();return f.useEffect(()=>{e()},[]),a.jsxs("div",{className:"pb-[46px]",children:[a.jsx(Se,{title:"Genres"}),a.jsxs("div",{className:"flex justify-between items-start mt-3",children:[a.jsx(kA,{...r}),a.jsx(RX,{value:r.value})]}),a.jsxs("div",{className:"mt-3",children:[t&&a.jsx(le,{className:"h-[200px] rounded-xl"}),!t&&a.jsx(a.Fragment,{children:n.length?a.jsx("div",{className:"flex flex-wrap -mt-2 -mx-2",children:n.map(s=>a.jsx(AX,{genre:s},s.id))}):a.jsx(Xe,{})})]})]})}function PX(){return a.jsx(wA,{})}function FX(){const{setErrorToast:t}=fe(),{singer:e,setSinger:n}=Ys(),[r,s]=f.useState(!1),i=Gt();return{isFetching:r,action:async l=>{try{switch(l.variant){case"delete":{if(!e)throw new Error("");s(!0),await Iw({collectionName:"Singers",id:e.id}),e.image_file_path&&await Xn({filePath:e.image_file_path}),s(!1),i("/dashboard/singer");break}}}catch(c){console.log({message:c}),t("")}finally{s(!1)}},singer:e,setSinger:n}}function DX(){const[t,e]=f.useState(""),n=f.useRef(null),{action:r,isFetching:s,singer:i}=FX(),o=c=>{var u;e(c),(u=n.current)==null||u.open()},l=()=>{var c;return(c=n.current)==null?void 0:c.close()};return a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>o("more"),className:"text-sm ml-auto !mt-0",children:"See more"}),a.jsx("div",{className:"mt-3 md:!mt-auto",children:a.jsxs(Zw,{children:[a.jsxs(ce,{onClick:()=>o("edit"),className:"md:px-3",size:"clear",children:[a.jsx(Js,{className:"w-6"}),a.jsx("div",{className:"hidden md:block",children:"Edit singer"})]}),a.jsxs(ce,{onClick:()=>o("delete"),className:"md:px-3",size:"clear",children:[a.jsx(Fn,{className:"w-6"}),a.jsx("div",{className:"hidden md:block",children:"Delete"})]})]})}),a.jsxs(Tr,{ref:n,children:[t==="more"&&i&&a.jsx("div",{className:"w-[400px] max-w-[calc(100vw-40px)]",children:i.description}),t==="edit"&&a.jsx(r5,{closeModal:l,variant:"edit"}),t==="delete"&&i&&a.jsx(xs,{label:`Delete singer '${i.name}'`,loading:s,callback:()=>r({variant:"delete"}),close:l})]})]})}function LX(){const{setSinger:t,setSongs:e,setPlaylists:n,setAlbums:r}=Ys(),{setErrorToast:s}=fe(),{setIsFetching:i}=Yu(),o=Xi(),l=Gt(),c=f.useRef(!1),u=async()=>{try{if(!o.id)return;const d=await Hr({collectionName:"Singers",id:o.id});d.exists()||l("/dashboard/singer");const m={...d.data(),id:o.id},p=he(wn,Q(`singer_map.${m.id}`,"==",!0)),g=await _n(p),y=he(wr,Q(`singer_map.${m.id}`,"==",!0)),w=await Wr(y),_=[],E=[];w.forEach(b=>b.is_album?E.push(b):_.push(b)),t(m),n(_),r(E),e(g)}catch(d){console.log({error:d}),s()}finally{i(!1)}};f.useEffect(()=>{c.current||(c.current=!0,u())},[])}function MX(){const[t,e]=f.useState(!0);return{isFetching:t,setIsFetching:e}}const s5=f.createContext(null);function OX({children:t}){return LX(),t}function $X({children:t}){return a.jsx(s5.Provider,{value:MX(),children:a.jsx(OX,{children:t})})}function Yu(){const t=f.useContext(s5);if(!t)throw new Error;return t}function BX(){const{singer:t}=Ys(),{isFetching:e}=Yu();return!e&&!t?a.jsx(a.Fragment,{}):a.jsx(a.Fragment,{children:a.jsxs("div",{className:"md:flex",children:[a.jsx("div",{className:"w-[260px] h-[260px] mx-auto md:m-unset",children:e?a.jsx(le,{className:"pt-[100%] "}):a.jsx(Ru,{children:a.jsx(Ye,{src:t==null?void 0:t.image_url,blurHashEncode:(t==null?void 0:t.blurhash_encode)||""})})}),a.jsx("div",{className:"flex-grow flex flex-col mt-5 space-y-2.5  md:mt-0 md:ml-5",children:e?a.jsxs(a.Fragment,{children:[a.jsx(le,{className:"h-[60px] w-full md:w-[200px]"}),a.jsx(le,{className:"h-[120px] w-full md:w-[70%]"}),a.jsx(le,{className:"h-[17px] w-[200px]"})]}):t&&a.jsxs(a.Fragment,{children:[a.jsx("p",{className:"text-3xl leading-[2] font-playwriteCU",children:t.name}),a.jsxs("p",{children:[a.jsx("span",{className:"text-red-500 text-xl",children:"❤"})," ",_r(t.like)]}),a.jsx("p",{className:"line-clamp-2",children:t.description}),a.jsx(DX,{})]})})]})})}function zX(){const{songs:t}=Ys(),{isFetching:e}=Yu();return a.jsxs(a.Fragment,{children:[a.jsx(Se,{title:"Songs"}),a.jsx(ps,{children:e?a.jsx(le,{className:"h-[100px]"}):a.jsx(ra,{colList:["Name","Singer"],children:t.length?t.map((n,r)=>a.jsxs("tr",{className:"hover:bg-black/10",children:[a.jsx("td",{children:a.jsx(we,{to:`/dashboard/song/${n.id}/edit`,children:n.name})}),a.jsx("td",{children:n.singers.map((s,i)=>a.jsx(we,{to:`/dashboard/singer/${s.id}`,className:"hover:text-green-500 hover:underline",children:(i?", ":"")+s.name},i))})]},r)):a.jsx("tr",{children:a.jsx("td",{colSpan:2,children:a.jsx(Xe,{})})})})})]})}function UX(){const{playlists:t}=Ys(),{isFetching:e}=Yu();return a.jsxs(a.Fragment,{children:[a.jsx(Se,{title:"Playlists"}),e&&a.jsx(le,{className:"h-[100px]"}),!e&&a.jsx(ra,{colList:["Name",""],children:t.length?t.map((n,r)=>a.jsxs("tr",{className:"hover:bg-black/10",children:[a.jsx("td",{children:a.jsx(we,{to:`/dashboard/playlist/${n.id}`,children:n.name})}),a.jsx("td",{children:"-"})]},r)):a.jsx("tr",{children:a.jsx("td",{colSpan:2,children:a.jsx(Xe,{})})})})]})}function VX(){const[t,e]=f.useState(),[n,r]=f.useState([]),[s,i]=f.useState(),[o,l]=f.useState(),[c,u]=f.useState();return{singer:t,setSinger:e,songs:n,setSongs:r,updateAlbumData:m=>{s&&i({...s,...m})},albumData:s,imageFile:o,setImageFile:l,setAlbumData:i,album:c,setAlbum:u}}const i5=f.createContext(null);function HX({children:t}){return a.jsx(i5.Provider,{value:VX(),children:t})}function Al(){const t=f.useContext(i5);if(!t)throw new Error("AddAlbumProvider not provided");return t}function WX(t){const{imageFile:e,updateAlbumData:n,setSinger:r,albumData:s,setSongs:i,album:o,singer:l,songs:c,setAlbum:u,setImageFile:d,setAlbumData:m}=Al(),{setSuccessToast:p,setErrorToast:g}=fe(),[y,w]=f.useState(!1),_=f.useRef(!1),E=f.useMemo(()=>t.variant==="add"?!0:!o||!s||!l?!1:s.name!==o.name||l.id!==o.singers[0].id||s.like!==o.like||!!c.find(F=>!o.song_ids.includes(F.id)),[s,o,l,c]),b=!!e,S=f.useMemo(()=>{const F=!!E&&!!s&&!!s.name&&!!l&&!!c.length;return t.variant==="add"?F:F||b},[b,E,s,l,c]),C=async()=>{try{if(!s||!l)return;if(w(!0),e){const F=await na({imageFile:e});Object.assign(s,F)}switch(s.singers=[l],s.singer_map={[l.id]:!0},s.song_ids=c.map(F=>F.id),t.variant){case"add":{const F=await Ks({collectionName:"Playlists",data:s}),I=await Va(F),k={...I.data(),id:I.id};t.callback(k),p("Album created");break}case"edit":{if(!o)return;await kt({collectionName:"Playlists",data:s,id:o.id}),u({...o,...s}),p("Album edited");break}}}catch(F){console.log(F),g()}finally{w(!1),d(void 0)}},D=async()=>{switch(t.variant){case"add":m(f2({owner_email:t.user.email,distributor:t.user.email})),r(t.singer);break;case"edit":const{id:F,song_ids:I,singers:k,...R}=t.album;if(I){const j=he(wn,Q(ti(),"in",I)),N=await _n(j);i(N)}u(t.album),r(k[0]),m(f2({...R,song_ids:I,singers:k}));break}};return f.useEffect(()=>{_.current||(_.current=!0,D())},[]),f.useEffect(()=>{e&&n({image_url:URL.createObjectURL(e)})},[e]),{submit:C,isFetching:y,isValidToSubmit:S}}function qX(){const{singer:t,setSinger:e,albumData:n,updateAlbumData:r}=Al(),s=f.useRef(null),i=o=>{var l;e(o),(l=s.current)==null||l.close()};if(n)return a.jsxs(a.Fragment,{children:[a.jsxs(yn,{className:"space-y-2.5",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-lg",htmlFor:"name",children:"Name"}),a.jsx(Ht,{type:"text",placeholder:"name...",id:"name",className:"text-[#333]",value:n.name,onChange:o=>r({name:o.target.value})})]}),a.jsxs("div",{className:"flex items-center space-x-1.5",children:[a.jsx("p",{className:"text-lg",children:"Singer"}),t?a.jsxs(jl,{className:"mt-0",children:[a.jsx("span",{children:t.name}),a.jsx("div",{children:a.jsx("button",{onClick:()=>e(void 0),children:a.jsx(Fn,{className:"w-5"})})})]}):a.jsx(ce,{size:"clear",className:"p-1.5",onClick:()=>{var o;return(o=s.current)==null?void 0:o.open()},children:a.jsx(br,{className:"w-5"})})]})]}),a.jsx(Tr,{ref:s,children:a.jsx(Bw,{choose:i,closeModal:()=>{var o;return(o=s.current)==null?void 0:o.close()}})})]})}function GX(){const{songs:t,setSongs:e}=Al(),n=f.useRef(null),r=i=>{const o=t.map(c=>c.id),l=i.filter(c=>!o.includes(c.id));e([...t,...l])},s=i=>{const o=t.filter(l=>l.id!==i.id);e(o)};return a.jsxs(a.Fragment,{children:[a.jsxs(ra,{colList:["Name","Singer","Like"," "],children:[t.map((i,o)=>a.jsxs("tr",{children:[a.jsx("td",{children:a.jsx("span",{children:i.name})}),a.jsx("td",{children:i.singers.map((l,c)=>a.jsxs("span",{className:"hover:underline",children:[!!c&&", ",l.name]},c))}),a.jsx("td",{children:a.jsx("span",{children:_r(i.like)})}),a.jsx("td",{children:a.jsx(ce,{onClick:()=>s(i),size:"clear",className:"p-1",children:a.jsx(Fn,{className:"w-5"})})})]},o)),a.jsx("tr",{className:"!bg-white border-none",children:a.jsx("td",{colSpan:3,children:a.jsx("p",{className:"text-center",children:a.jsxs(ce,{onClick:()=>{var i;return(i=n.current)==null?void 0:i.open()},children:[a.jsx(br,{className:"w-6"}),a.jsx("span",{children:"Add song"})]})})})})]}),a.jsx(Tr,{wrapped:!1,variant:"animation",ref:n,children:a.jsx(n5,{submit:r,closeModal:()=>{var i;return(i=n.current)==null?void 0:i.close()},isLoading:!1})})]})}function QX(){const{album:t}=Al(),e=f.useRef(null),n=Gt(),r=async()=>{try{if(!t)return;await Promise.all([Iw({collectionName:"Playlists",id:t.id}),t.image_file_path?Xn({filePath:t.image_file_path}):()=>{}]),n("/dashboard/album")}catch{}};return a.jsxs(a.Fragment,{children:[a.jsxs(ce,{size:"clear",onClick:()=>{var s;return(s=e.current)==null?void 0:s.open()},children:[a.jsx(Fn,{className:"w-6"}),a.jsx("span",{children:"Delete"})]}),a.jsx(De,{variant:"animation",ref:e,wrapped:!1,children:a.jsx(ai,{children:a.jsx(xs,{label:`Delete album ' ${t==null?void 0:t.name} '`,close:()=>{var s;return(s=e.current)==null?void 0:s.close()},callback:r,loading:!1})})})]})}function KX({closeModal:t}){const{albumData:e,singer:n,setSinger:r,updateAlbumData:s}=Al();if(!e||!n)throw new Error("albumData or singer is undefined");const[i,o]=f.useState(e),[l,c]=f.useState(n),u=f.useRef(null),d=f.useMemo(()=>i.name!==e.name||i.like!==e.like||l!==n,[i,l]),m=f.useMemo(()=>!!(i!=null&&i.name)&&!!l&&d,[d]),p=w=>{o({...i,...w})},g=w=>{var _;c(w),(_=u.current)==null||_.close()},y=()=>{r(l),s(i),t()};if(i)return a.jsxs(a.Fragment,{children:[a.jsxs(kr,{children:[a.jsx(jt,{close:t,title:"Edit album"}),a.jsx("div",{className:"flex-grow overflow-auto",children:a.jsxs("div",{className:"flex-grow flex flex-col mt-3  space-y-2.5 md:mt-0 md:ml-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{htmlFor:"name",className:"opacity-[.8]",children:"Album name:"}),a.jsx(Ht,{type:"text",id:"name",placeholder:"",className:"bg-[#f1f1f1]",value:i.name,onChange:w=>p({name:w.target.value})})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{htmlFor:"description",className:"opacity-[.8]",children:"Singer:"}),a.jsx("div",{className:"-mt-2 -ml-2",children:a.jsxs(jl,{className:"mt-0 w-fit",children:[a.jsx("span",{children:l.name}),a.jsx("div",{children:a.jsx("button",{onClick:()=>{var w;return(w=u.current)==null?void 0:w.open()},children:a.jsx(He,{className:"w-5"})})})]})})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{htmlFor:"like",className:"opacity-[.8]",children:"Like:"}),a.jsx(Ht,{id:"like",className:"bg-[#f1f1f1]",type:"number",value:i.like+"",onChange:w=>p({like:+w.target.value})})]})]})}),a.jsx("p",{className:"text-right mt-3",children:a.jsx(ce,{color:"primary",onClick:y,disabled:!m,className:"font-playwriteCU rounded-full",children:"Save"})})]}),a.jsx(Tr,{ref:u,children:a.jsx(Bw,{choose:g,closeModal:()=>{var w;return(w=u.current)==null?void 0:w.close()}})})]})}function XX(){const t=f.useRef(null);return a.jsxs(a.Fragment,{children:[a.jsxs(ce,{onClick:()=>{var e;return(e=t.current)==null?void 0:e.open()},children:[a.jsx(Js,{className:"w-6"}),a.jsx("span",{children:"Edit"})]}),a.jsx(Tr,{ref:t,children:a.jsx(KX,{closeModal:()=>{var e;return(e=t.current)==null?void 0:e.close()}})})]})}function YX({className:t="",...e}){const{theme:n}=q(),{albumData:r,singer:s,setImageFile:i}=Al(),{submit:o,isFetching:l,isValidToSubmit:c}=WX(e),u=m=>{var p;(p=m.target.files)!=null&&p.length&&i(m.target.files[0])},d=a.jsxs(Zw,{children:[a.jsx(ce,{className:`${n.content_bg} !p-0`,size:"clear",children:a.jsxs("label",{htmlFor:"image_upload",className:"md:px-3 p-1.5 inline-flex space-x-1 cursor-pointer ",children:[a.jsx(xl,{className:"w-6"}),a.jsx("span",{children:"Change image"})]})}),e.variant==="edit"&&a.jsxs(a.Fragment,{children:[a.jsx(XX,{}),a.jsx(QX,{})]})]});return r?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:`md:flex ${t}`,children:[a.jsxs("div",{className:"space-y-2.5",children:[a.jsx("div",{className:"w-[200px] mx-auto h-[200px] rounded-lg overflow-hidden",children:a.jsx(Ye,{className:"object-cover object-center h-full",blurHashEncode:r.blurhash_encode,src:r.image_url})}),a.jsx("input",{onChange:u,type:"file",multiple:!0,accept:"image/png, image/jpeg",id:"image_upload",className:"hidden"}),e.variant==="add"&&a.jsx("div",{children:d}),e.variant==="edit"&&a.jsx(a.Fragment,{children:a.jsxs("div",{children:[a.jsx(Se,{title:r.name}),a.jsxs(yn,{className:"text-[#333]",children:[a.jsx("p",{className:"text-xl",children:s==null?void 0:s.name}),a.jsxs("p",{children:[r.song_ids.length," songs"]}),a.jsxs("p",{className:"mt-1 font-[500]",children:[a.jsx("span",{className:"text-red-500 text-xl",children:"❤"})," ",_r(r.like)]})]}),a.jsx("div",{className:"mt-3",children:d})]})})]}),a.jsxs("div",{className:"mt-3 md:w-3/4 md:mt-0 md:ml-3 flex-grow flex flex-col space-y-2.5",children:[e.variant==="add"&&a.jsx(qX,{}),a.jsxs("div",{children:[e.variant==="add"&&a.jsx("p",{className:"text-lg mb-1",children:"Songs"}),e.variant==="edit"&&a.jsx(Se,{title:"Songs"}),a.jsx(GX,{})]})]})]}),a.jsx("p",{className:"text-right mt-5",children:a.jsx(ce,{loading:l,color:"primary",onClick:o,disabled:!c,className:"font-playwriteCU rounded-full",children:"Save"})})]}):a.jsx(a.Fragment,{})}function e1(t){return a.jsx(HX,{children:a.jsx(YX,{...t})})}function JX(){const{user:t}=xe(),{singer:e,setAlbums:n}=Ys(),r=f.useRef(null),s=i=>{n(o=>[i,...o])};return a.jsxs(a.Fragment,{children:[a.jsxs(ce,{onClick:()=>{var i;return(i=r.current)==null?void 0:i.open()},className:"px-3 py-1",size:"clear",children:[a.jsx(br,{className:"w-5"}),a.jsx("span",{children:"Add album"})]}),a.jsx(Tr,{ref:r,children:a.jsx(kr,{className:"w-[700px] flex flex-col",children:t&&e&&a.jsxs(a.Fragment,{children:[a.jsx(jt,{title:"Add album",close:()=>{var i;return(i=r.current)==null?void 0:i.close()}}),a.jsx(e1,{className:"flex-grow overflow-auto no-scrollbar md:overflow-hidden",variant:"add",singer:e,callback:s,user:t})]})})})]})}function ZX(){const{albums:t}=Ys(),{isFetching:e}=Yu();return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx(Se,{title:"Albums"}),a.jsx(JX,{})]}),e&&a.jsx(le,{className:"h-[100px]"}),!e&&a.jsx(ra,{colList:["Name",""],children:t.length?t.map((n,r)=>a.jsxs("tr",{className:"hover:bg-black/10",children:[a.jsx("td",{children:a.jsx(we,{to:`/dashboard/album/${n.id}`,children:n.name})}),a.jsx("td",{children:"-"})]},r)):a.jsx("tr",{children:a.jsx("td",{colSpan:2,children:a.jsx(Xe,{})})})})]})}function eY(){return a.jsx(a.Fragment,{children:a.jsxs("div",{className:"pb-[46px] space-y-3",children:[a.jsx(BX,{}),a.jsx(ZX,{}),a.jsx(zX,{}),a.jsx(UX,{})]})})}function tY(){return a.jsx($X,{children:a.jsx(eY,{})})}function nY({setAlbums:t}){const{user:e}=xe(),n=f.useRef(null),r=()=>{var i;return(i=n.current)==null?void 0:i.close()},s=i=>{t(o=>[i,...o]),r()};if(e)return a.jsxs(a.Fragment,{children:[a.jsxs(ce,{onClick:()=>{var i;return(i=n.current)==null?void 0:i.open()},className:"self-start p-1.5 ml-5",size:"clear",children:[a.jsx(gs,{className:"w-6"}),a.jsx("div",{className:"hidden md:block",children:"Add new album"})]}),a.jsx(De,{wrapped:!1,ref:n,variant:"animation",children:a.jsxs(ai,{className:"w-[800px]",children:[a.jsx(Se,{title:"Add album"}),a.jsx(e1,{className:"overflow-auto",variant:"add",user:e,callback:s})]})})]})}const rY=["All","Result"];function sY(){const[t,e]=f.useState([]),[n,r]=f.useState(""),[s,i]=f.useState(!0),[o,l]=f.useState("All"),{setErrorToast:c}=fe(),u=async m=>{try{m.preventDefault(),i(!0);const p=he(wr,Q("is_album","==",!0),Q("name",">=",n),Q("name","<=",n+"")),g=await Wr(p);e(g),l("Result")}catch(p){console.log({message:p}),c()}finally{i(!1)}},d=async()=>{try{i(!0);const m=he(wr,Q("is_album","==",!0),Vr("created_at","desc")),p=await Wr(m);e(p)}catch(m){console.log({message:m}),c()}finally{i(!1)}};return f.useEffect(()=>{o==="All"&&d()},[o]),{isFetching:s,value:n,setValue:r,handleSubmit:u,albums:t,tab:o,setTab:l,tabs:rY,setAlbums:e}}function iY(){const{isFetching:t,albums:e,tab:n,tabs:r,setTab:s,setAlbums:i,...o}=sY();return a.jsxs("div",{className:"pb-[46px]",children:[a.jsx(Se,{title:"Albums"}),a.jsxs("div",{className:"flex justify-between mt-3",children:[a.jsx(Rl,{...o}),a.jsx(nY,{setAlbums:i})]}),a.jsx("div",{className:`mt-5 w-fit ${n==="All"?"pointer-events-none":""} self-start`,children:a.jsx(ys,{tabs:r,render:l=>l,tab:n,setTab:s})}),a.jsxs("div",{className:"mt-3",children:[t&&a.jsx(le,{className:"h-[200px] rounded-xl"}),!t&&a.jsx(ra,{colList:["Name","Singer","Like"],children:e.length?e.map((l,c)=>a.jsxs("tr",{children:[a.jsx("td",{children:a.jsx(we,{className:"hover:underline",to:`/dashboard/album/${l.id}`,children:l.name})}),a.jsx("td",{children:a.jsx(we,{to:`/dashboard/singer/${l.singers[0].id}`,children:l.singers[0].name})}),a.jsx("td",{children:_r(l.like)})]},c)):a.jsx("tr",{children:a.jsx("td",{colSpan:4,children:a.jsx(Xe,{})})})})]})]})}function aE({children:t}){return a.jsx(Yq,{children:t})}function aY({children:t}){return a.jsx(Vq,{children:t})}function oY(){const[t,e]=f.useState(!0),[n,r]=f.useState(),s=f.useRef(!1),i=Xi(),o=Gt(),{setErrorToast:l}=fe(),c=async()=>{try{if(!i.id)return;const u=await Hr({collectionName:"Playlists",id:i.id});if(!u.exists())return o("/dashboard/album");const d={...u.data(),id:u.id};if(!d.is_album)return o(`/dashboard/playlist/${d.id}`);r(d)}catch(u){console.log(u),l()}finally{e(!1)}};return f.useEffect(()=>{s.current||(s.current=!0,c())},[]),{album:n,isFetching:t}}function lY(){const{album:t,isFetching:e}=oY();return e?a.jsx(Wt,{children:a.jsx(He,{className:"w-6 animate-spin"})}):t?a.jsxs("div",{className:"pb-[46px]",children:[a.jsx(Se,{title:"Edit album",className:"mb-3"}),a.jsx(e1,{variant:"edit",album:t})]}):a.jsx(a.Fragment,{})}function cY(){const[t,e]=f.useState([]),[n,r]=f.useState(999),[s,i]=f.useState(!1),o=f.useRef(!0),l=f.useMemo(()=>t[n],[t,n]);return{isOpenComment:s,setIsOpenComment:i,currentSong:l,songs:t,setSongs:e,currentIndex:n,setCurrentIndex:r,firstTimeSongLoaded:o}}const a5=f.createContext(null);function uY({children:t}){return a.jsx(a5.Provider,{value:cY(),children:t})}function oi(){const t=f.useContext(a5);if(!t)throw new Error("SongsContextProvider not provided");return t}function dY(){const{currentSong:t,isOpenComment:e}=oi(),[n,r]=f.useState([]),{fetchComment:s,isFetching:i}=Vm(),o=async()=>{const l=await s({target_id:t.id});l&&r(l)};return f.useEffect(()=>{if(!(!e||!t))return o(),()=>{e&&r([])}},[t,e]),{comments:n,setComments:r,isFetching:i}}function hY(){const{isOpenComment:t,setIsOpenComment:e}=oi(),{themeClass:n}=q(),{comments:r,isFetching:s}=dY(),i=t?"lg:right-0 block":"lg:right-[-100%] hidden lg:block",o={border:`${n("border-black/20","border-white/20")}`};return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:`${t?"fixed":""} lg:hidden bg-black/60 inset-0 z-[90]`}),a.jsx("div",{className:`transition-[right] duration-[.3s] z-[99] bg-[#333] absolute rounded-xl left-1/2 top-1/2 translate-y-[-50%] translate-x-[-50%] lg:left-[unset] lg:top-0 lg:transform-none  lg:bg-transparent lg:h-full lg:min-h-[360px] w-[400px] xl:w-[480px] p-4 top-0 ${i}`,children:a.jsxs("div",{className:`lg:border p-3 lg:h-full w-full rounded-xl flex flex-col ${o.border}`,children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("div",{className:"font-playwriteCU",children:"Comments"}),a.jsx(ie,{onClick:()=>e(!1),className:"p-1.5 hover:bg-black/20",size:"clear",children:a.jsx(Zs,{className:"w-6"})})]}),a.jsx(Lw,{variant:"theme-bg",isFetching:s,comments:r})]})})]})}function fY(){const[t,e]=f.useState("idle"),[n,r]=f.useState(!1),[s,i]=f.useState([]),o=f.useRef(null),l=f.useRef("idle"),c=f.useRef(!0),u=f.useRef(!0);return{status:t,setStatus:e,statusRef:l,controlRef:o,canPlay:n,setCanPlay:r,lyrics:s,setLyrics:i,shouldGetLyric:c,shouldPlayAfterLoaded:u}}const o5=f.createContext(null);function mY({children:t}){return a.jsx(o5.Provider,{value:fY(),children:t})}function ao(){const t=f.useContext(o5);if(!t)throw new Error("PlayerProvider not provided");return t}function pY({audioEle:t,progressLineRef:e}){const{status:n,setStatus:r,statusRef:s}=ao(),i=()=>{try{t.play()}catch{}},o=()=>{t==null||t.pause(),u()},l=()=>{n==="playing"?o():n==="paused"&&i()},c=()=>{r("playing")},u=()=>{r("paused")},d=w=>{if(!t)return;const E=+((w||t.currentTime)/t.duration*100).toFixed(1);e!=null&&e.current&&(e.current.style.background=Um("#fff",E))},m=()=>{d()},p=w=>{t.currentTime=w,d(w),n!=="playing"&&i()},g=w=>{const _=w.target;if(e!=null&&e.current){const E=_.getBoundingClientRect(),S=(w.clientX-E.left)/e.current.offsetWidth,C=Math.round(S*t.duration);p(C)}},y=()=>{r("paused")};return f.useEffect(()=>{if(t)return t.addEventListener("pause",u),t.addEventListener("loadeddata",y),t.addEventListener("playing",c),e!=null&&e.current&&(t.addEventListener("timeupdate",m),e==null||e.current.addEventListener("click",g)),()=>{t.removeEventListener("loadeddata",y),t.removeEventListener("pause",u),t.removeEventListener("playing",c),e!=null&&e.current&&(t.removeEventListener("timeupdate",m),e==null||e.current.removeEventListener("click",g))}},[]),f.useEffect(()=>{s.current=n},[n]),{play:i,pause:o,seek:p,handlePlayPause:l}}function gY({audioEle:t}){const{setStatus:e,shouldPlayAfterLoaded:n,canPlay:r}=ao(),{firstTimeSongLoaded:s,currentSong:i}=oi(),o=()=>{e("loading")},l=()=>{if(s.current){s.current=!1,e("paused");return}n.current&&(n.current=!1,t==null||t.play())},c=()=>{e("error")};f.useEffect(()=>{r&&i&&(t.src=i.song_url)},[r]),f.useEffect(()=>(t.addEventListener("error",c),t.addEventListener("loadstart",o),t.addEventListener("loadedmetadata",l),()=>{t.removeEventListener("error",c),t.removeEventListener("loadstart",o),t.removeEventListener("loadedmetadata",l)}),[])}function xY(){const{setIsOpenComment:t}=oi();return a.jsxs("div",{className:`flex 
			space-x-2
			[&_button]:rounded-full
			[&_button]:p-1.5
			[&_button]:bg-white/10
			[&_div]:flex-col
			[&_div]:flex
			[&_span]:text-center
			[&_span]:font-medium
		 `,children:[a.jsx("div",{children:a.jsx("button",{children:a.jsx(Za,{className:"w-6"})})}),a.jsx("div",{children:a.jsx("button",{onClick:()=>t(!0),children:a.jsx(Y6,{className:"w-6"})})})]})}function yY({audioEle:t}){const{status:e,controlRef:n}=ao(),r=f.useRef(null);gY({audioEle:t});const{pause:s,play:i,handlePlayPause:o}=pY({audioEle:t,progressLineRef:r});f.useImperativeHandle(n,()=>({pause:s,play:i,handlePlayPause:o}));const l=()=>{switch(e){case"playing":return a.jsx(sv,{});case"paused":return a.jsx(nf,{});case"error":return a.jsx(FI,{});case"loading":return a.jsx(He,{className:"animate-spin"});default:return a.jsx(Yi,{})}},c={before:"before:content-[''] before:w-[100%] before:h-3 before:absolute before:bottom-full"};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex",children:[a.jsx("button",{onClick:o,className:"[&_svg]:w-7",children:l()}),a.jsx("div",{className:"flex space-x-2 ml-auto",children:a.jsx(xY,{})})]}),a.jsx("div",{className:"h-2 flex items-center mt-3",children:a.jsx("div",{ref:r,style:{backgroundColor:"rgba(255,255,255,.3)"},className:`relative h-1 rounded-full w-full ${c.before} ${e==="idle"?"hidden":""}`})})]})}const Yd=.3;function vY({audioEle:t,lyrics:e,isActive:n}){const[r,s]=f.useState(0),i=f.useRef(0),o=f.useRef(0),l=()=>{const c=t.currentTime>i.current?"forward":"backward";i.current=t.currentTime;let u=o.current;switch(c){case"forward":for(;e[u+1]&&e[u+1].start-Yd<i.current+Yd;)u+=1;break;case"backward":for(;e[u-1]&&e[u-1].end-Yd>i.current+Yd;)u-=1;break}u!==o.current&&(o.current=u,s(u))};return f.useEffect(()=>{if(!(!n||!e.length))return t.addEventListener("timeupdate",l),()=>{t.removeEventListener("timeupdate",l)}},[e,n]),{currentIndex:r}}function wY(){const{canPlay:t,setLyrics:e,shouldGetLyric:n}=ao(),{currentSong:r}=oi(),s=f.useRef(),{_loading:i,getLyric:o}=QR({}),l=async()=>{if(r){const c=await o(r);c&&e(JSON.parse(c==null?void 0:c.lyrics))}};return f.useEffect(()=>{t&&n.current&&(n.current=!1,s.current=setTimeout(l,500))},[t]),{isFetching:i}}function _Y({audioEle:t}){const{lyrics:e,canPlay:n}=ao(),{isFetching:r}=wY(),s=f.useRef(null),i=f.useRef(null),{currentIndex:o}=vY({audioEle:t,lyrics:e,isActive:n}),l=()=>a.jsxs(a.Fragment,{children:[a.jsx("p",{className:"transition-transform origin-bottom-left duration-[.4s] translate-y-[50px]",ref:s,children:e[o].text},o),e[o+1]&&a.jsx("p",{ref:i,className:"mt-3 transition-transform duration-[.4s] opacity-[.4] translate-y-[-10px]",children:e[o+1].text},o+"asda")]}),c={container:"no-scrollbar [&_p]:w-[70%] [&_p]:select-none [&_p]:font-[700] pt-4	"};return f.useEffect(()=>{setTimeout(()=>{s.current&&Object.assign(s.current.style,{transform:"scale(1.3) translateY(0px)"}),i.current&&Object.assign(i.current.style,{transform:"translateY(0px)"})},10)},[o,e]),a.jsxs("div",{className:`${c.container}`,children:[r&&a.jsx("div",{className:"relative w-full h-full",children:a.jsx(He,{className:"w-7 animate-spin"})}),!r&&a.jsx(a.Fragment,{children:e.length?l():a.jsx("div",{children:"..."})})]})}function bY({index:t,songItemRef:e}){const{currentIndex:n,setCurrentIndex:r}=oi(),{setCanPlay:s,canPlay:i,controlRef:o,statusRef:l}=ao(),[c,u]=f.useState(!1),d=f.useRef(),m=f.useMemo(()=>n===t,[n]),p=g=>{const[y]=g;u(y.isIntersecting)};f.useEffect(()=>{var g,y;m?i?(g=o.current)==null||g.play():s(!0):l.current==="playing"&&((y=o.current)==null||y.pause())},[m]),f.useEffect(()=>{e.current&&new IntersectionObserver(p,{threshold:1}).observe(e.current)},[]),f.useEffect(()=>(d.current=setTimeout(()=>{c&&r(t)},600),()=>{clearTimeout(d.current)}),[c])}function SY({song:t,index:e,songItemRef:n}){const{controlRef:r}=ao(),s=f.useRef(null);return bY({index:e,songItemRef:n}),a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"relative z-0 flex items-center flex-shrink-0 text-white h-full w-full sm:w-auto sm:aspect-[3/5] rounded-xl overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0 z-[-1] overflow-hidden ",children:t.blurhash_encode&&a.jsx(ju,{hash:t.blurhash_encode,height:"100%",width:"100%"})}),a.jsx("div",{className:"absolute top-0 left-0 w-full p-4 z-[99]",children:s.current&&a.jsx(_Y,{audioEle:s.current})}),a.jsx("div",{className:"w-full aspect-[1/1] overflow relative mask-image",children:a.jsx("img",{onClick:()=>{var i;return(i=r.current)==null?void 0:i.handlePlayPause()},className:"w-full object-cover",src:t.image_url})}),a.jsx("div",{className:"absolute z-0 bottom-0 left-0 w-full",children:a.jsxs("div",{className:"relative p-4",children:[a.jsx("div",{className:"absolute inset-0 z-[-1] bg-gradient-to-b to-black/60 from-transparent"}),a.jsx("div",{className:"text-xl font-semibold",children:t.name}),a.jsx("div",{className:"opacity-[.8]",children:t.singers.map((i,o)=>a.jsxs("span",{children:[" ",(o?", ":"")+i.name]},o))}),a.jsx("div",{className:"mt-5",children:s.current&&a.jsx(yY,{audioEle:s.current})})]})})]}),a.jsx("audio",{className:"hidden",ref:s})]})}function EY(t,e){const{isOpenComment:n}=oi(),r=f.useRef(null);return f.useImperativeHandle(e,()=>r.current),a.jsx(a.Fragment,{children:a.jsx("div",{"data-index":t.index,className:"h-full flex-shrink-0 p-4 min-h-[360px] snap-center",ref:r,children:a.jsx("div",{className:`relative h-full w-full ${n?"lg:right-[calc(400px*0.5)] ":""}`,children:a.jsx(mY,{children:a.jsx(SY,{...t,songItemRef:r})})})})})}const oE=f.forwardRef(EY);function kY(){const{setSongs:t}=oi(),{setErrorToast:e}=fe(),[n,r]=f.useState(!0),s=async()=>{try{r(!0);const i=he(wn,Q("is_official","==",!0),Vr("updated_at","desc"),al(20)),o=await _n(i);t(l=>[...l,...o])}catch(i){console.log({message:i}),e()}finally{r(!1)}};return f.useEffect(()=>(s(),()=>{r(!0)}),[]),{isFetching:n,getSong:s}}function TY(){const{setCurrentIndex:t,songs:e}=oi(),{isFetching:n}=kY(),r=f.useRef(null),s=f.useCallback(o=>{r.current&&r.current.disconnect(),r.current=new IntersectionObserver(l=>{l[0].isIntersecting&&console.log("get song ")}),o&&r.current.observe(o)},[]),i=f.useMemo(()=>e.map((o,l)=>e.length===l+1?a.jsx(oE,{index:l,ref:s,song:o},l):a.jsx(oE,{index:l,song:o},l)),[e]);return f.useEffect(()=>{setTimeout(()=>{t(0)},1e3)},[]),a.jsxs("div",{className:"h-full snap-y snap-mandatory overflow-auto no-scrollbar flex flex-col items-center",children:[n&&a.jsx("p",{children:"Loading"}),i]})}function IY(){return a.jsx(uY,{children:a.jsxs("div",{className:"fixed inset-0 sm:relative overflow-hidden flex-grow",children:[a.jsx(TY,{}),a.jsx(Qm,{target:"song",children:a.jsx(hY,{})})]})})}const ha={home:"/",discorver:"/discover",search:"/search",playlist:"/playlist/:id",login:"/login",unauthorized:"/unauthorized",singer:"/singer/:id",user:"/user/:id"},lE={myMusic:"/my-music",songLyric:"/my-music/lyric/:id"},lr={dashboard:"/dashboard",genre:"/dashboard/genre",playlist:"/dashboard/playlist",song:"/dashboard/song",addSong:"/dashboard/song/add-song",editSong:"/dashboard/song/:songId/edit",playlistDetail:"/dashboard/playlist/:id",songLyric:"/dashboard/lyric/:id",singer:"/dashboard/singer",editSinger:"/dashboard/singer/:id",album:"/dashboard/album",editAlbum:"/dashboard/album/:id"},CY=[{path:ha.home,component:IY,layout:""},{path:ha.discorver,component:nW,layout:""},{path:ha.playlist,component:xW,layout:""},{path:ha.search,component:pq,layout:""},{path:ha.unauthorized,component:xq,layout:""},{path:ha.singer,component:Pq,layout:""},{path:ha.user,component:Dq,layout:""}],jY=[{path:lE.myMusic,component:kW,layout:""},{path:lE.songLyric,component:dq,layout:""}],RY=[{path:lr.dashboard,component:Lq,layout:""},{path:lr.playlist,component:xX,layout:""},{path:lr.genre,component:NX,layout:""},{path:lr.singer,component:jX,layout:xb},{path:lr.editSinger,component:tY,layout:xb},{path:lr.playlistDetail,component:EX,layout:aY},{path:lr.album,component:iY,layout:""},{path:lr.editAlbum,component:lY,layout:""},{path:lr.song,component:Kq,layout:""},{path:lr.addSong,component:dX,layout:aE},{path:lr.editSong,component:fX,layout:aE},{path:lr.songLyric,component:PX,layout:""}],l5="/HD-MP3/assets/loading-b1210647.gif";function AY(){const{user:t,loading:e}=xe(),{theme:n}=q();return e?a.jsx("div",{className:`min-h-screen flex flex-col items-center justify-center ${n.container}`,children:a.jsx("img",{className:"w-[150px]",src:l5,alt:""})}):t?a.jsx(rm,{}):a.jsx(PT,{state:{from:"/my-music"},replace:!0,to:"/login"})}function NY(){const[t,e]=f.useState(!0),[n,r]=f.useState(!1),{user:s,loading:i}=xe(),{theme:o}=q();return f.useEffect(()=>{(async()=>{await Us(1e3),r(!0),e(!1)})()},[]),i||t?a.jsx("div",{className:`min-h-screen flex flex-col items-center justify-center ${o.container}`,children:a.jsx("img",{className:"w-[150px]",src:l5,alt:""})}):s&&n?a.jsx(rm,{}):a.jsx(PT,{replace:!0,to:"/unauthorized"})}const c5=[{path:"/dashboard",title:"Dashboard",icon:a.jsx(Yy,{className:"w-5 flex-shrink-0"})},{path:"/dashboard/song",title:"Songs",icon:a.jsx(Yi,{className:"w-5 flex-shrink-0"})},{path:"/dashboard/playlist",title:"Playlists",icon:a.jsx(tL,{className:"w-5 flex-shrink-0"})},{path:"/dashboard/album",title:"Albums",icon:a.jsx(ND,{className:"w-5 flex-shrink-0"})},{path:"/dashboard/singer",title:"Singers",icon:a.jsx(VL,{className:"w-5 flex-shrink-0"})},{path:"/dashboard/genre",title:"Genres",icon:a.jsx(CL,{className:"w-5 flex-shrink-0"})}];function PY(){const{theme:t}=q(),[e,n]=f.useState(!1),r=rr(),s="",i={container:"hidden md:block bg-[#f1f1f1] text-[#333] border-r border-black/10 transition-[width] relative flex-shrink-0",head:"h-[60px] flex items-center justify-center",logoText:"text-[22px] font-[500] whitespace-nowrap tracking-[-1px]",logoImage:"max-w-[50px] p-[4px]",item:"flex whitespace-nowrap space-x-2 items-center justify-center p-2.5 ",itemActive:"text-[#cd1818] bg-[#f1f1f1]",icon:"w-[24px] flex-shrink-0"};return a.jsxs("div",{className:`${i.container} ${e?"w-[150px]":"w-[70px]"}`,children:[a.jsxs("div",{className:"md:mt-[60px]",children:[c5.map((o,l)=>{const c=r.pathname===o.path;return a.jsxs(we,{className:`
              ${c?t.content_bg:"hover:bg-black/10"}
              ${i.item} ${e?"!justify-start":""}
              ${s===o.path?i.itemActive:""}`,to:o.path,children:[o.icon,e&&a.jsx("span",{children:o.title})]},l)}),a.jsxs(we,{to:"/",target:"_blank",className:`${i.item} ${e?"!justify-start":""}
               
               `,children:[a.jsx(fm,{className:i.icon}),e&&a.jsx("span",{children:"Home"})]})]}),a.jsx(ce,{onClick:()=>n(o=>!o),size:"clear",className:"!absolute p-1.5 bottom-5 right-0 translate-x-[50%]",children:e?a.jsx(EH,{className:"w-5 "}):a.jsx(IH,{className:"w-5"})})]})}function u5({className:t=""}){const{behind:e,ahead:n,backward:r,forward:s}=uA();return a.jsxs("div",{className:`"flex space-x-3 [&>button]:p-1 ${t}`,children:[a.jsx("button",{onClick:r,className:`relative ${Yc(!e.length)}`,children:a.jsx(kI,{className:"w-5"})}),a.jsx("button",{onClick:s,className:`relative ${Yc(!n.length)}`,children:a.jsx(M6,{className:"w-5"})})]})}function FY(){const{theme:t}=q(),[e,n]=f.useState(0),[r,s]=f.useState(""),i=f.useRef(null),o=f.useRef(null),l=m=>{var p,g;s(m),(p=o.current)==null||p.close(),(g=i.current)==null||g.open()},c=()=>{var m;return(m=i.current)==null?void 0:m.close()},u=m=>{const p=m.target.scrollTop||0;n(p)},d=()=>{switch(r){case"":return a.jsx(a.Fragment,{});case"theme":return a.jsx(ov,{close:c});case"info":return a.jsx(av,{close:c})}};return f.useEffect(()=>{const m=document.querySelector(".main-container");return m==null||m.addEventListener("scroll",u),()=>{m==null||m.removeEventListener("scroll",u)}},[]),a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:`hidden md:flex px-[40px] z-[99] h-[60px] flex-shrink-0 items-center justify-between ${e?" shadow-lg":""}`,children:[a.jsxs("div",{className:"flex",children:[a.jsxs(we,{to:"/dashboard",className:"text-xl font-[500]",children:["HD",a.jsx("span",{className:`${t.content_text} ml-[4px] uppercase`,children:"Dashboard"})]}),a.jsx(u5,{className:"ml-5"})]}),a.jsx("div",{className:"flex",children:a.jsxs(pr,{children:[a.jsx(gr,{ref:o,children:a.jsx("button",{className:`flex p-2 items-center rounded-full bg-${t.alpha} ${t.content_hover_bg}`,children:a.jsx(Tu,{className:"w-6"})})}),a.jsx(xr,{appendTo:"parent",className:"top-[calc(100%+8px)] right-0",animationClassName:"origin-top-right",children:a.jsx(WI,{openModal:l,variant:"dashboard"})})]})})]}),a.jsx(De,{ref:i,variant:"animation",children:d()})]})}function DY(){const[t,e]=f.useState(!1),n=f.useRef(null),r=s=>{var i;(i=n.current)!=null&&i.contains(s.target)||e(!1)};return f.useEffect(()=>(t&&window.addEventListener("click",r),()=>{window.removeEventListener("click",r)}),[t]),a.jsxs(a.Fragment,{children:[a.jsx(yn,{colors:"third",className:`absolute z-[99] duration-[.25] flex flex-col
        transition-[left,opacity] bottom-[80px] 
        ${t?"left-[10px] opacity-[1] pointer-events-auto":"left-0 opacity-[0] pointer-events-none"}`,children:c5.map((s,i)=>a.jsxs(we,{className:"inline-flex py-1.5 space-x-1",to:s.path,children:[s.icon,a.jsx("span",{children:s.title})]},i))}),a.jsx(ce,{ref:n,size:"clear",onClick:()=>e(!t),className:"!absolute transition-[left] bottom-[10px] left-[10px]  p-1.5",children:a.jsx(gl,{className:"w-6"})})]})}function LY({className:t="",toast:e,onClick:n}){const{theme:r}=q(),[s,i]=f.useState(!1),o={icon:"w-6",container:`transition-[transform,opacity] text-white px-3 py-1 space-x-1 rounded-md flex items-center ${r.modal_bg}`,text:"font-[500] text-sm",open:"opacity-[1] translate-x-0",init:"opacity-0 translate-x-10"},l=()=>{switch(e.variant){case"success":return a.jsx(rv,{className:`${o.icon} text-emerald-500`});case"error":return a.jsx(iv,{className:`${o.icon} text-red-500`})}};return f.useEffect(()=>{setTimeout(()=>{i(!0)},0)},[]),a.jsxs("div",{onClick:()=>n?n(e.id):void 0,className:`${o.container} ${t} ${s?o.open:o.init} `,children:[l(),a.jsx("p",{className:o.text,children:e.desc})]})}const d5=({time:t=6e3,className:e=""})=>{const{setToasts:n,toasts:r}=fe(),[s,i]=f.useState(""),o=l=>{n(c=>c.filter(u=>u.id!=l))};return f.useEffect(()=>{s&&n(l=>l.filter(c=>c.id!=s))},[s]),f.useEffect(()=>{if(!r.length)return;const l=r[r.length-1].id;setTimeout(()=>{i(l)},t)},[r]),a.jsx(a.Fragment,{children:Ya.createPortal(a.jsx("div",{className:`fixed z-[199] ${e}`,children:a.jsx("div",{className:"flex flex-col gap-[10px]",children:!!r.length&&r.map((l,c)=>a.jsx(LY,{onClick:o,toast:l},c))})}),document.getElementById("portals"))})};function MY(){const{setTheme:t,isOnMobile:e,theme:n}=q();return f.useEffect(()=>{t(S3)},[]),a.jsx(a.Fragment,{children:a.jsx(gI,{children:a.jsx(Zq,{children:a.jsxs("div",{className:`${n.container} fixed inset-full flex ${n.text_color}`,children:[e?a.jsx(DY,{}):a.jsx(PY,{}),a.jsxs("div",{className:"flex flex-col flex-grow",children:[a.jsx(FY,{}),a.jsx("div",{className:"main-container flex flex-col flex-grow overflow-auto p-[10px] md:px-[40px] md:pt-0",children:a.jsx(rm,{})})]}),a.jsx(d5,{className:"left-[50%] translate-x-[-50%] top-[10px] md:top-[unset] md:bottom-[60px] md:left-[20px] md:translate-x-0"}),a.jsx(pI,{})]})})})})}const h5="USRKy:SK%|R*}@r@MxoeY$kWmnafBUR*oybu";function OY({variant:t="desktop"}){const{desktopTabs:e,activeTab:n,setActiveTab:r,mobileActiveTab:s,mobileTabs:i,setMobileActiveTab:o,idle:l}=ct(),c=t==="desktop"?n:s,u=t==="desktop"?r:o,d=t==="desktop"?e:i,m={item:"px-3 md:px-8 leading-[30px] font-[600] cursor-pointer  rounded-full",fadeTransition:"opacity-0 transition-opacity duration-[.3s]"};return a.jsx("ul",{className:`inline-flex mx-auto rounded-full space-x-1 bg-white/10 p-1 ${l?m.fadeTransition:""}`,children:d.map((p,g)=>{const y=p===c;return a.jsx("li",{onClick:()=>u(p),className:`${m.item} ${y?"bg-white/20":"hover:bg-white/5"}`,children:p},g)})})}function $Y({themeType:t,children:e}){const{theme:n}=q(),{isOpenComment:r,setIsOpenComment:s}=Gr(),i=t==="dark"?"bg-[#1f1f1f]":n.container,o={mainContainer:`hidden fixed w-[400px] md:flex flex-col bottom-0 right-[0] top-0 z-[99] p-3 pb-5 text-white border-l-[1px] border-${n.alpha} transition-[transform] duration-[.5s] linear delay-100`};return a.jsxs("div",{className:`${n.text_color} ${o.mainContainer} ${r?"translate-x-0---":"translate-x-full"}     `,children:[a.jsx("div",{className:`bg-opacity-[0.8] backdrop-blur-[15px] z-[-1] ${i} absolute inset-0`}),a.jsx("p",{children:a.jsx("button",{className:"p-1.5",onClick:()=>s(!1),children:a.jsx(iv,{className:"w-7"})})}),e]})}function BY(){const{shouldFetchComment:t,setComments:e,isOpenComment:n,setIsFetching:r}=Gr(),{currentSongData:s}=se(ze),{fetchComment:i}=Vm(),o=async()=>{try{if(!(s!=null&&s.song))return;const l=await i({target_id:s.song.id});e(l||[])}catch(l){console.log({error:l})}finally{r(!1)}};f.useEffect(()=>{!n||!(s!=null&&s.song)||t.current&&(t.current=!1,o())},[n]),f.useEffect(()=>()=>{t.current||(t.current=!0)},[s==null?void 0:s.song])}function f5(){const{isFetching:t,comments:e}=Gr();return BY(),t?a.jsx(Wt,{children:a.jsx(He,{className:"w-6 animate-spin"})}):a.jsx(Lw,{comments:e})}function zY({show:t}){const{theme:e}=q(),{setIsOpenComment:n}=Gr(),r={button:`w-[38px] h-[38px] bg-white/10 rounded-[99px] transition-transform ${e.content_hover_bg}`};return a.jsxs(a.Fragment,{children:[t&&a.jsx(us,{position:"top-[calc(100%+8px)]",content:"Comment",children:a.jsx("button",{onClick:()=>n(!0),className:`p-2 ${r.button}`,children:a.jsx(Qy,{})})}),Ya.createPortal(a.jsx($Y,{themeType:"dark",children:a.jsx(f5,{})}),document.getElementById("portals"))]})}function UY(){const{user:t}=xe(),{theme:e}=q(),{activeTab:n,idle:r,setIsOpenFullScreen:s}=ct(),{currentSongData:i}=se(ze),o=Gt(),l=i&&t?i.song.owner_email===t.email&&i.song.is_official===!1:!1,c=()=>{i!=null&&i.song&&(s(!1),setTimeout(()=>{o(`/my-music/lyric/${i==null?void 0:i.song.id}`)},300))},u={button:`w-[38px] h-[38px] bg-white/10 rounded-[99px] transition-transform ${e.content_hover_bg}`,headerWrapper:"relative flex py-[25px] px-[40px] w-full items-center",fadeTransition:"opacity-0 transition-opacity duration-[.3s]"};return a.jsx(a.Fragment,{children:a.jsxs("div",{className:`${u.headerWrapper} ${r?"pointer-events-none":""}`,children:[r&&i&&a.jsx("div",{className:"absolute left-4",children:n!=="Songs"&&a.jsxs(a.Fragment,{children:[a.jsx("p",{className:"font-playwriteCU text-sm",children:i.song.name}),a.jsx("p",{className:"opacity-70 text-sm",children:i.song.singers.map((d,m)=>(m?", ":"")+d.name)})]})}),a.jsx(OY,{}),a.jsxs("div",{className:`absolute flex right-4 space-x-3 ${r&&u.fadeTransition}`,children:[a.jsx(Qm,{target:"song",children:a.jsx(zY,{show:!!(i!=null&&i.song.is_official)})}),l&&n==="Lyric"&&a.jsx(us,{position:"top-[calc(100%+8px)]",content:"Edit lyric",children:a.jsx("button",{onClick:()=>c(),className:`p-2 ${u.button}`,children:a.jsx(Jy,{})})}),a.jsxs(pr,{children:[a.jsx(gr,{children:a.jsx(us,{position:"top-[calc(100%+8px)]",content:"Setting",children:a.jsx("button",{className:`${u.button} p-2`,children:a.jsx(Xy,{})})})}),a.jsx(xr,{appendTo:"parent",className:"top-[calc(100%+8px)] right-0 z-[99]",animationClassName:"origin-top-right",children:a.jsx(lC,{})})]}),a.jsx(us,{position:"top-[calc(100%+8px)]",content:"Close",children:a.jsx("button",{onClick:()=>s(!1),className:`p-2 ${u.button}`,children:a.jsx(CI,{})})})]})]})})}function m5({className:t}){const{playerConig:{lyricSize:e},audioRef:n,isOpenFullScreen:r,activeTab:s}=ct();if(!n.current)throw new Error("audioRef error");const{loading:i,songLyrics:o}=bI(),l=f.useMemo(()=>r&&s==="Lyric",[r,s]),{currentIndex:c,lyricRefs:u}=pA({audioEle:n.current,isActive:l,lyrics:o}),d={small:"text-[16px] sm:text-[26px]",medium:"text-[20px] sm:text-[30px]",large:"text-[26px] sm:text-[46px]"},m=()=>o.map((g,y)=>{let w="coming";return c===y?w="active":y<c&&(w="done"),a.jsx(mA,{ref:_=>u.current[y]=_,status:w,text:g.text,activeColor:"scale-[1.3]",className:"leading-[1.3] mb-3 w-[70%] md:mb-5 last:mb-[50vh]"},y)}),p={container:"no-scrollbar pt-[20px] mask-image overflow-y-auto overflow-x-hidden"};return a.jsxs("div",{className:`${p.container} ${d[e||"medium"]} ${t}`,children:[i&&a.jsx("div",{className:"relative w-full h-full",children:a.jsx(Wt,{children:a.jsx(He,{className:"w-7 animate-spin"})})}),!i&&a.jsx(a.Fragment,{children:o.length?m():a.jsx("div",{className:"relative w-full h-full",children:a.jsx(Wt,{children:a.jsx("h1",{className:"text-[30px] opacity-60",children:"..."})})})})]})}const ic=.3,cE=t=>t%2!==0;function VY(){const{songLyrics:t,loading:e}=bI(),{audioRef:n,isOpenFullScreen:r,activeTab:s}=ct();if(!n.current)throw new Error("useKaraoke !audioRef.current");const{playStatus:i}=se(Dn),[o,l]=f.useState(0),c=f.useRef(null),u=f.useRef(null),d=f.useRef(null),m=f.useRef(null),p=f.useRef(0),g=f.useRef(0),y=f.useRef("paused"),w=f.useRef(!1),_=f.useMemo(()=>r&&s=="Karaoke",[r,s]),E=f.useMemo(()=>{if(t.length){if(o<0)return{odd:"",even:""};const D=cE(o);if(!t[o+1])return{odd:"",even:""};const F=D?[o,o+1]:[o+1,o],I=t[F[0]].text.trim(),k=t[F[1]].text.trim();return{odd:I,even:k}}else return{odd:"",even:""}},[o,t]),b=D=>{D.style.animation="none"},S=(D,F,I,k)=>{var N,P;let R="running";y.current==="paused"&&(R="paused"),I.style.animation=`${D} ${(((N=F==null?void 0:F.tune)==null?void 0:N.end)||F.end)-(((P=F==null?void 0:F.tune)==null?void 0:P.start)||F.start)}s linear ${R} forwards`;const j=+k.toFixed(1);Math.abs(j)>.2&&(I.style.animationDelay=`${j}s`)},C=()=>{if(!t.length)return;const D=n.current.currentTime>=p.current?"forward":"backward";p.current=n.current.currentTime;let F=g.current;switch(D){case"forward":for(;F<t.length&&t[F+1]&&t[F+1].start-ic<p.current+ic;)F+=1;break;case"backward":for(;F>0&&t[F-1]&&t[F-1].end-ic>p.current+ic;)F-=1;break}if(F!==g.current||w.current||y.current==="paused"||y.current==="waiting"){if(w.current=!1,g.current=F,l(F),!c.current||!u.current||!m.current||!d.current)return;const I=t[F],{tune:k,text:R,cut:j}=I,N=p.current+ic-k.start,P=R.split(" "),A=cE(F),ee=vA(A?m.current:d.current),me=Mw(P,j,k.grow),ye=A?[c.current,u.current]:[u.current,c.current],Ne=yA(me,ee);S(Ne,I,ye[0],-N),b(ye[1])}};return f.useEffect(()=>{y.current==="waiting"?setTimeout(()=>{y.current=i},300):y.current=i},[i]),f.useEffect(()=>{_&&(w.current=!0,i==="paused"&&C())},[_]),f.useEffect(()=>{if(!(!t.length||!_))return n.current.addEventListener("timeupdate",C),()=>{n.current.removeEventListener("timeupdate",C)}},[t,_]),f.useEffect(()=>()=>{p.current=0,g.current=-1,l(0)},[t]),{loading:e,currentIndexRef:g,oddOverlay:c,evenOverlay:u,currentIndex:o,textData:E,tempEventText:d,tempOddText:m}}function uE({text:t,overlayRef:e}){const{playStatus:n}=se(Dn),[r,s]=f.useState(t),[i,o]=f.useState(!1),l=f.useRef(!0);f.useEffect(()=>{t&&o(!1)},[t]),f.useEffect(()=>{if(i)return;const u=()=>{s(t),o(!0)};l.current?setTimeout(u,300):(l.current=!0,u())},[i]),f.useEffect(()=>{n==="waiting"&&(l.current=!1),e.current&&(n==="playing"?e.current.style.animationPlayState="running":e.current.style.animationPlayState="paused")},[n]);const c={lyric:"relative duration-300 text-[44px] font-[700] pointer-none whitespace-nowrap"};return a.jsxs("div",{className:`${c.lyric} ${l.current?"transition-opacity":""} ${i?"opacity-[1]":"opacity-0"}`,children:[r||"...",a.jsx("p",{ref:e,className:"absolute whitespace-nowrap w-0 overflow-hidden text-[#ffed00] left-0 top-0 h-full",children:r||"..."})]})}function HY(){const{loading:t,evenOverlay:e,oddOverlay:n,tempEventText:r,tempOddText:s,textData:i}=VY();return t?a.jsx(Wt,{children:a.jsx(He,{className:"w-7 animate-spin"})}):a.jsxs(a.Fragment,{children:[a.jsx("div",{ref:r,className:"inline-flex h-0 opacity-0",children:i.even.split(" ").map((o,l)=>a.jsx("span",{className:"leading-1",children:o},l))}),a.jsx("div",{ref:s,className:"inline-flex h-0 opacity-0",children:i.odd.split(" ").map((o,l)=>a.jsx("span",{className:"k leading-1",children:o},l))}),a.jsx(uE,{overlayRef:e,text:i.even}),a.jsx("div",{className:"mt-8"}),a.jsx(uE,{overlayRef:n,text:i.odd})]})}const p5=()=>{window.dispatchEvent(new Event("mousemove"))};function Bx(t,e,n=!1){const r=window.innerWidth,i=t.getBoundingClientRect().left,o=r-(i+t.offsetWidth),l=Math.abs(Math.ceil(i-o))/2;if(l<5)return!1;n&&(e.onscroll=()=>{},setTimeout(()=>{e.onscroll=p5},900)),n||Math.abs(i)>r||Math.abs(o)>r?e.style.scrollBehavior="auto":e.style.scrollBehavior="smooth";let c=e.scrollLeft;return o>i?setTimeout(()=>{e.scrollLeft=c-l},300):o<i&&setTimeout(()=>{e.scrollLeft=c+l},300),!0}function WY(){const t=on(),{isOpenFullScreen:e,idle:n}=ct(),{currentQueueId:r}=se(ze),{playStatus:s}=se(Dn),i=f.useRef(null),o=f.useRef(null),l=f.useRef("paused"),c=()=>{!(o!=null&&o.current)||!(i!=null&&i.current)||Bx(o.current,i.current,n)},u=p=>{let g=document.querySelector(".song-thumb.centered");if(!g)if(o.current)g=o.current;else return;let y;switch(p){case"ArrowRight":y=g.nextElementSibling;break;case"ArrowLeft":y=g.previousElementSibling;break}y&&i.current&&(g.classList.remove("centered"),y.classList.add("centered"),Bx(y,i.current))},d=()=>{if(!o.current)return;const p=document.querySelector(".song-thumb.centered"),g=p==null?void 0:p.getAttribute("queue-id");g&&t(ds(g))},m=p=>{if(p.key==="ArrowRight"||p.key==="ArrowLeft")return p.preventDefault(),u(p.key);p.key==="Enter"&&(p.preventDefault(),d())};return f.useEffect(()=>{e&&c()},[r,e]),f.useEffect(()=>{if(e)return document.addEventListener("keydown",m),()=>{var p;document.removeEventListener("keydown",m),(p=document.querySelector(".song-thumb.centered"))==null||p.classList.remove("centered")}},[r,e]),f.useEffect(()=>{const p=i==null?void 0:i.current;if(p)return p.onscroll=p5,()=>{p.onscroll=()=>{}}},[]),f.useEffect(()=>{l.current=s},[s]),{activeSongRef:o,containerRef:i}}function qY(){const t=on(),{activeTab:e,isOpenFullScreen:n,idle:r}=ct(),{theme:s}=q(),{currentSongData:i}=se(ze),{queueSongs:o,currentQueueId:l}=se(ze),{activeSongRef:c,containerRef:u}=WY(),d=_=>{l!==_&&t(ds(_))},m=h2(()=>g("next"),200),p=h2(()=>g("previous"),200),g=(_="next")=>{const E=u.current;E.style.scrollBehavior="smooth",_==="next"?E.scrollLeft+=500:_==="previous"&&(E.scrollLeft-=500)},y={songsListTab:" relative h-full no-scrollbar flex items-center flex-row overflow-auto scroll-smooth px-[calc(50%-350px/2)]",absoluteButton:`absolute top-[50%] -translate-y-[50%] p-[8px] bg-white/30 rounded-full ${s.content_hover_bg}`,lyricTabContainer:"px-[40px] min-[1536px]:container  min-[1536px]:px-[200px] h-full flex items-center justify-center flex-row",fadeTransition:"opacity-0 transition-opacity duration-[.3s]"},w=f.useMemo(()=>{if(i!=null&&i.song&&o.length)return o.map((_,E)=>_.queue_id===l?a.jsx(ng,{ref:c,hasTitle:!0,onClick:()=>d(_.queue_id),active:!0,data:_},E):a.jsx(ng,{idleClass:`${r?y.fadeTransition:""}`,hasTitle:!0,active:!1,data:_,onClick:()=>d(_.queue_id)},E))},[i==null?void 0:i.song,o,r]);return a.jsxs(a.Fragment,{children:[a.jsx("div",{ref:u,className:`song-list-container ${y.songsListTab} ${e!=="Songs"?"opacity-0":"opacity-100"}`,children:w}),e==="Songs"&&!r&&a.jsxs(a.Fragment,{children:[a.jsx(ie,{hover:"scale",size:"clear",onClick:()=>p(),className:`${y.absoluteButton} left-[20px]`,children:a.jsx(jI,{className:"w-[30px]"})}),a.jsx(ie,{hover:"scale",size:"clear",onClick:()=>m(),className:`${y.absoluteButton} right-[20px]`,children:a.jsx(ph,{className:"w-[30px]"})})]}),a.jsx(_I,{children:a.jsxs(YR,{isOpenLyricTabs:n&&(e==="Lyric"||e==="Karaoke"),children:[a.jsx("div",{className:`absolute inset-0 z-20 ${e==="Lyric"?"":"hidden"}`,children:a.jsxs("div",{className:y.lyricTabContainer,children:[a.jsx(ng,{active:!0,data:i==null?void 0:i.song}),a.jsx(m5,{className:"w-full ml-[40px] h-full"})]})}),a.jsx("div",{className:`absolute inset-0 z-20 flex flex-col items-center justify-center ${e==="Karaoke"?"":"hidden"}`,children:a.jsx(HY,{})})]})})]})}function GY(){var o,l;const{isOpenFullScreen:t,idle:e,activeTab:n,playerConig:{songBackground:r}}=ct(),{currentSongData:s}=se(ze),i={wrapper:`fixed inset-0 z-50 overflow-hidden text-white bg-zinc-900
    } transition-transform duration-[.7s] linear delay-100`,bg:"absolute inset-0 -z-10 brightness-[70%]",container:"absolute w-full top-0 bottom-[90px] flex flex-col",content:"flex-grow relative overflow-hidden",fadeTransition:"opacity-0 transition-opacity duration-[.3s]"};return a.jsxs("div",{className:`${i.wrapper}  ${t?"translate-y-0":"translate-y-full"}`,children:[a.jsx("div",{className:` ${i.bg}`,children:r&&a.jsx(ju,{radioGroup:"",height:"100%",width:"100%",hash:((o=s==null?void 0:s.song)==null?void 0:o.blurhash_encode)||h5})}),a.jsxs("div",{className:i.container,children:[a.jsx(UY,{}),a.jsx("div",{className:i.content,children:a.jsx(qY,{})}),n!=="Songs"&&a.jsxs("p",{className:`text-center ${e&&i.fadeTransition}`,children:[((l=s==null?void 0:s.song)==null?void 0:l.name)||"...",a.jsxs("span",{className:"opacity-70 text-sm",children:[" - ",s==null?void 0:s.song.singers.map((c,u)=>(u?", ":"")+c.name)]})]})]})]})}function QY(){const{user:t}=xe(),[e,n]=f.useState([]),[r,s]=f.useState(!0);return{isFetching:r,recentSongs:e,getRecentSongs:async()=>{try{if(t&&t.recent_song_ids.length){const o=he(wn,Q(ti(),"in",t.recent_song_ids)),l=await _n(o);n(l)}else{const o=mn()["recent-songs"]||[];n(o)}}catch(o){console.log({message:o})}finally{s(!1)}}}}function KY({setTab:t}){const e=on(),n=f.useRef(!1),{getRecentSongs:r,isFetching:s,recentSongs:i}=QY(),o=[...Array(5).keys()].map(c=>a.jsx(le,{className:"h-[57px] mt-1"},c)),l=c=>{e(vm({songs:[c]})),e(ds(c.queue_id)),t("Queue")};return f.useEffect(()=>{n.current||(n.current=!0,r())},[]),s?o:a.jsx(ri,{isHasCheckBox:!1,songVariant:"recent-song",songs:i,setSong:l})}const XY=["Queue","Recent"];function YY(){const t=on(),{theme:e}=q(),{isOpenSongQueue:n,setIsOpenSongQueue:r}=ct(),{queueSongs:s,currentQueueId:i,isFetching:o}=se(ze),{resetForNewSong:l}=si(),[c,u]=f.useState("Queue"),d=f.useCallback(y=>{y!==i&&t(ds(y))},[i]),m=f.useCallback(()=>{t(e9()),l(),r(!1)},[]),p=[...Array(5).keys()].map(y=>a.jsx(le,{className:"h-[56px] mt-1"},y)),g={mainContainer:`hidden fixed w-[300px] md:flex flex-col bottom-[80px] right-[0] top-[0] z-20 px-3 pt-4 ${e.container} border-l-[1px] border-${e.alpha} transition-[transform] duration-[.5s] linear delay-100`,songListContainer:"flex-grow overflow-y-auto pb-[10px] overflow-x-hidden no-scrollbar mt-3"};return a.jsx(ps,{children:a.jsxs("div",{className:`${e.text_color} ${g.mainContainer} ${n?"translate-x-0---":"translate-x-full"}     `,children:[a.jsx(ys,{className:"w-fit mx-auto text-sm",tab:c,setTab:u,tabs:XY,render:y=>y}),a.jsx("div",{className:g.songListContainer,children:c==="Queue"?a.jsxs(a.Fragment,{children:[a.jsx(ri,{isHasCheckBox:!1,songs:s,setSong:y=>d(y.queue_id),songVariant:"queue-song",getActive:(y,w)=>y.queue_id===w.queue_id}),o&&p,a.jsx("div",{className:"text-center",children:!!s.length&&a.jsxs(ie,{onClick:m,size:"clear",className:`${e.content_bg} rounded-full my-5 px-3 py-1 space-x-1`,children:[a.jsx(Fn,{className:"w-6"}),a.jsx("span",{className:"font-playwriteCU leading-[2.2]",children:"Clear"})]})})]}):a.jsx(KY,{setTab:u})})]})})}const JY=f.memo(YY);function ZY({vinylRef:t}){const{playStatus:e}=se(Dn);f.useEffect(()=>{const n=t.current;n&&(e==="playing"?n.style.animationPlayState="running":n.style.animationPlayState="paused")},[e])}function eJ({textRef:t,textWrapperRef:e,content:n}){const r=f.useRef(),s=f.useRef(),i=f.useRef(!1),o=f.useRef(0),l=f.useRef(0),c=f.useRef(0),u=()=>{t.current&&(t.current.style.transition="none",t.current.style.transform="translateX(0)")},d=()=>{t.current&&(t.current.style.transition=`transform linear ${l.current}s`,t.current.style.transform=`translateX(-${c.current}px)`,s.current=setTimeout(u,l.current*1e3))},m=()=>{!t.current||!e.current||(c.current=t.current.offsetWidth-o.current,l.current=Math.ceil(c.current/35))},p=()=>{!i.current||!t.current||!e.current||(l.current=0,c.current=0,i.current=!1,clearInterval(r.current),clearTimeout(s.current),e.current.classList.remove("mask-image-horizontal"),u())},g=()=>{!t.current||!e.current||!n||!(t.current.offsetWidth>e.current.offsetWidth)||(i.current=!0,e.current.classList.add("mask-image-horizontal"),o.current=t.current.clientWidth,t.current.innerHTML=t.current.innerText+"&nbsp; &nbsp; &nbsp;"+t.current.innerText,m(),setTimeout(d,1e3),r.current=setInterval(d,l.current*1e3+3e3))};f.useEffect(()=>(g(),p),[n])}function tJ({content:t,className:e}){const n=f.useRef(null),r=f.useRef(null);return eJ({textRef:r,textWrapperRef:n,content:t}),a.jsx("div",{ref:n,className:"overflow-hidden relative h-full ",children:a.jsx("div",{ref:r,className:`absolute left-0 whitespace-nowrap ${e}`,children:t||"..."})})}const g5=f.memo(tJ);function nJ({isOpenFullScreen:t,song:e}){const n=f.useRef(null),{theme:r}=q();ZY({vinylRef:n});const s={songInfoChild:"flex flex-row"};return a.jsx("div",{className:`w-1/4  ${Jc(t)}`,children:a.jsxs("div",{className:`${s.songInfoChild} ${Jc(t)}`,children:[a.jsx("div",{ref:n,className:"w-[56px] h-[56px] flex-shrink-0 animate-[spin_8s_linear_infinite]",children:a.jsx(Ye,{src:e==null?void 0:e.image_url,className:"rounded-full h-full object-cover"})}),a.jsxs("div",{className:"ml-2 flex-grow",children:[a.jsx("div",{className:"h-[32px]",children:a.jsx(g5,{className:"leading-[1.5] font-playwriteCU",content:(e==null?void 0:e.name)||"Name"})}),e&&a.jsx("div",{className:"leading-[1.2] text-sm opacity-[.7] line-clamp-1",children:e.singers.map((i,o)=>i.id?a.jsx(we,{to:`/singer/${i.id}`,className:`${r.content_hover_text}  hover:underline`,children:(o?", ":"")+i.name},o):a.jsx("span",{children:(o?", ":"")+i.name},o))})]})]})})}function rJ({audioEle:t,volumeLineRef:e}){const{theme:n}=q(),[r,s]=f.useState(!1),[i,o]=W0("volume",1),l=d=>{const p=d.target.getBoundingClientRect(),g=e.current;if(g){let y=+((d.clientX-p.x)/g.clientWidth).toFixed(2);y>.9?y=1:y<.05?(y=0,s(!0)):s(!1),o(y)}},c=d=>{d.preventDefault();const m=.1;let p=i;d.deltaY>0?p-m>0?p-=m:p=0:p+m<1?p+=m:p=1,o(+p.toFixed(2))},u=()=>s(!r);return f.useEffect(()=>{if(e.current&&t){const d=i*100;e.current.style.background=Um(n.content_code,d),t.volume=i,s(i===0)}},[i,n]),f.useEffect(()=>{t&&(t.muted=r)},[r]),{volume:i,handleSetVolume:l,isMute:r,handleMute:u,handleWheel:c}}function sJ({audioEle:t}){const e=f.useRef(null),{handleMute:n,handleWheel:r,handleSetVolume:s,isMute:i}=rJ({audioEle:t,volumeLineRef:e}),o={before:"before:content-[''] before:w-[100%] before:h-[16px] before:absolute before:top-[50%] before:translate-y-[-50%]",volumeLineBase:"ml-1 w-full relative h-[4px] cursor-pointer rounded-full shadow-[2px_2px_10px_rgba(0,0,0,.15)]"};return a.jsxs("div",{className:"flex flex-grow items-center max-w-[120px] mr-2",children:[a.jsx("button",{onWheel:r,onClick:()=>n(),children:i?a.jsx(LL,{className:"w-6"}):a.jsx(PL,{className:"w-6"})}),a.jsx("div",{onClick:l=>s(l),ref:e,className:`${o.volumeLineBase} ${o.before}`,style:{background:"#e1e1e1"}})]})}function iJ({handlePlayPause:t,playStatus:e}){const n={icon:"w-[50px] sm:w-10"},r=()=>{switch(e){case"playing":return a.jsx(nv,{className:`${n.icon}`});case"error":return a.jsx(hm,{className:`${n.icon}`});case"loading":case"waiting":return a.jsx(He,{className:`${n.icon} animate-spin`});case"paused":return a.jsx(RI,{className:`${n.icon}`})}};return a.jsx(a.Fragment,{children:a.jsx("button",{className:"inline-flex items-center justify-center",onClick:()=>t(),children:r()})})}function aJ(){var _;const{theme:t}=q(),{playerConig:{isShuffle:e,repeat:n},isOpenFullScreen:r,timelineEleRef:s,currentTimeEleRef:i}=ct(),{currentSongData:o,queueSongs:l}=se(ze),{playStatus:c}=se(Dn),{next:u,previous:d,toggleRepeat:m,toggleShuffle:p,handlePlayPause:g,handleSeek:y}=si(),w={button:"p-1 rounded-full md:bg-transparent ",buttonsContainer:"w-full flex justify-center items-center mb-3 sm:mb-0 space-x-3",progressContainer:"flex w-full flex-row items-center ",processLineBase:"h-[6px] sm:h-1 flex-grow relative cursor-pointer rounded-[99px] shadow-[2px_2px_10px_rgba(0,0,0,.15)] ",icon:"w-[44px] sm:w-7",before:"before:content-[''] before:w-[100%] before:h-[24px] before:absolute before:top-[50%] before:translate-y-[-50%]"};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:`${w.buttonsContainer}`,children:[a.jsxs("button",{disabled:l.length<=1,className:`relative ${w.button} ${n!=="no"&&t.content_text}`,onClick:m,children:[a.jsx(TI,{className:w.icon}),a.jsx("span",{className:"absolute font-bold text-[12px] top-1/2 left-1/2 -translate-x-[50%] -translate-y-[50%] ",children:n==="one"?"1":n==="all"?"-":""})]}),a.jsx("button",{disabled:l.length<=1,className:w.button,onClick:d,children:a.jsx(Gy,{className:w.icon})}),a.jsx(iJ,{playStatus:c,handlePlayPause:g}),a.jsx("button",{disabled:l.length<=1,className:`${w.button}`,onClick:u,children:a.jsx(Zy,{className:w.icon})}),a.jsx("button",{disabled:l.length<=1,className:`${w.button} ${e&&t.content_text}`,onClick:p,children:a.jsx(II,{className:w.icon})})]}),a.jsxs("div",{className:`${w.progressContainer} ${r?"mb-0":"mb-5 sm:mb-2"} ${c==="error"||c==="loading"?"disable":""}`,children:[a.jsx("div",{className:"w-[44px] sm:w-9",children:a.jsx("span",{ref:i,className:"text-lg sm:text-sm",children:"0:00"})}),a.jsx("div",{ref:s,style:{background:"rgba(255, 255, 255, 0.3)"},onClick:E=>y(E),className:`${w.processLineBase}  ${w.before}`}),a.jsx("div",{className:"w-[44px] sm:w-9 text-right",children:a.jsx("span",{className:"text-lg sm:text-sm",children:o!=null&&o.song?zs((_=o.song)==null?void 0:_.duration):"0:00"})})]})]})}function oJ(){const{theme:t}=q(),e=f.useRef(null);return f.useEffect(()=>{if(e.current){if(!t.image){e.current.style.backgroundImage="";return}e.current.style.backgroundImage=`url(${t.image})`}},[t]),{containerRef:e}}function lJ(){const{theme:t}=q(),e=on(),{countDown:n}=se(Dn),r=f.useRef(null),s=()=>{var o;n?e(Ot({countDown:0})):(o=r.current)==null||o.open()},i={container:"w-[54px] sm:w-[50px] flex justify-center",button:`rounded-[99px]  hover:bg-${t.alpha} p-[5px]`,itemContainer:"flex justify-between items-center min-h-[30px]",text:"text-base text-[#ccc]"};return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:i.container,children:n?a.jsx(us,{content:"Clear timer",children:a.jsxs("button",{className:"group flex items-center",onClick:s,children:[a.jsx("span",{className:"text-base opacity-70 sm:text-sm group-hover:hidden",children:n.toString().padStart(2,"0")}),a.jsx("span",{className:`hidden group-hover:block ${i.button}`,children:a.jsx(Zs,{className:"w-8 sm:w-6"})})]})}):a.jsx(us,{content:"Sleep timer",children:a.jsx("button",{onClick:s,className:i.button,children:a.jsx(Ky,{className:"w-8 sm:w-6"})})})}),a.jsx(De,{ref:r,variant:"animation",children:a.jsx(DI,{active:o=>e(Ot({countDown:o})),closeModal:()=>{var o;return(o=r.current)==null?void 0:o.close()}})})]})}function cJ(){const{audioRef:t,idle:e}=ct();if(!t.current)throw new Error("BottomPlayer !audioRef.current");const{theme:n}=q(),{isOpenFullScreen:r,isOpenSongQueue:s,setIsOpenFullScreen:i,setIsOpenSongQueue:o}=ct(),{currentQueueId:l,currentSongData:c}=se(ze),{containerRef:u}=oJ(),d=rr(),m=f.useMemo(()=>d.pathname.includes("lyric")||d.pathname==="/",[d]),p=()=>{s&&o(!1),i(!0)},g={wrapper:`bottom-player hidden md:block border-${n.alpha} fixed bottom-0 w-full border-t transition-transform z-50 md:px-3 lg:px-6 h-[90px]`,container:"flex flex-row gap-[10px] h-full items-center",controlWrapper:`flex max-w-[420px] flex-grow ${r?"max-w-[600px] flex-col-reverse pb-[10px]":"flex-col justify-center"}`,right:"w-1/4 flex items-center justify-end",blurBg:`bg-opacity-[0.8] backdrop-blur-[15px] z-[-1] absolute inset-0 ${n.bottom_player_bg}`};return a.jsxs("div",{ref:u,className:`${g.wrapper} ${r?"border-transparent":n.image?n.bottom_player_bg:""} ${m&&"translate-y-[100%] "} `,children:[!n.image&&a.jsx("div",{className:`${g.blurBg} ${r?"opacity-0 transition-opacity delay-[.2s]":""}`}),a.jsxs("div",{className:`${g.container} ${r?"justify-center text-white":"justify-between"} ${e&&"transition-opacity duration-[.3s] opacity-0"}`,children:[a.jsx(nJ,{song:c==null?void 0:c.song,isOpenFullScreen:r}),a.jsx("div",{className:` ${g.controlWrapper} ${Yc(l===null)}`,children:a.jsx(aJ,{})}),a.jsxs("div",{className:`${g.right}  ${r?"hidden":""}`,children:[a.jsx(sJ,{audioEle:t.current}),a.jsxs("div",{className:`flex items-center ${l?"":"disable"}`,children:[a.jsx(us,{content:"Fullscreen mode",children:a.jsx("button",{onClick:p,className:`rounded-[99px]  hover:bg-${n.alpha}  p-[5px]`,children:a.jsx(fD,{className:"w-6"})})}),a.jsx(us,{content:"Queue",children:a.jsx("button",{onClick:()=>o(!s),className:`ml-1 hover:bg-${n.alpha} rounded-md p-[5px]`,children:a.jsx(kL,{className:"w-6"})})}),a.jsx("div",{className:`w-[2px] h-[26px] ml-2 bg-${n.alpha}`}),a.jsx(lJ,{})]})]})]})]})}function uJ({isOpenFullScreen:t}){const e=f.useRef(null);return f.useEffect(()=>{const n=e.current;n&&(t?(n.style.transform="translate(0)",n.style.zIndex="99"):(n.style.transform="translate(0, 100%)",setTimeout(()=>{n.style.zIndex="-10"},500)))},[t]),{wrapperRef:e}}function dJ({imageUrl:t}){const{mobileActiveTab:e,setMobileActiveTab:n}=ct(),r=e==="Playing";return a.jsx("div",{onClick:()=>n(r?"Lyric":"Playing"),className:` ${r?"w-full h-auto px-2 sm:w-[60px] sm:h-[60px] sm:px-0":"w-[60px] h-[60px] p-0 flex-shrink-0"}`,children:a.jsx(Ye,{src:t,className:"w-full rounded-md"})})}function hJ({song:t,onClick:e,active:n}){const r={itemContainer:`border-b 
    last:border-none border-white/10 rounded-md flex p-2 ${n?"bg-white/10":""}`,imageFrame:"w-[54px] h-[54px] relative rounded-md overflow-hidden flex-shrink-0"};return a.jsx(a.Fragment,{children:a.jsxs("div",{onClick:e,className:`${r.itemContainer} `,children:[a.jsx("div",{className:`${r.imageFrame}  `,children:a.jsx(Ye,{blurHashEncode:t.blurhash_encode,src:t.image_url})}),a.jsxs("div",{className:"ml-[10px]",children:[a.jsx("p",{className:"text-lg line-clamp-1 text-sm",children:t.name}),a.jsx("p",{className:"opacity-70 line-clamp-1 text-sm",children:t.singers.map((s,i)=>a.jsxs("span",{children:[" ",(i?", ":"")+s.name]},i))})]})]})})}function fJ({}){const t=on(),{queueSongs:e,isFetching:n,currentQueueId:r}=se(ze),s=[...Array(5).keys()].map(o=>a.jsx(le,{className:"h-[40px] mt-1"},o)),i=()=>a.jsx(a.Fragment,{children:e.map((o,l)=>a.jsx(hJ,{song:o,active:r===o.queue_id,onClick:()=>t(ds(o.queue_id))},l))});return a.jsxs(a.Fragment,{children:[i(),n&&s]})}function mJ(){const t=f.useRef(null),e=on(),{countDown:n}=se(Dn),r=()=>{var s;n?e(Ot({countDown:0})):(s=t.current)==null||s.open()};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("button",{className:Li(!!n,"active"),onClick:r,children:n?a.jsx(uM,{className:"w-6"}):a.jsx(Ky,{className:"w-6"})}),a.jsx("span",{children:n?n.toString().padStart(2,"")+" songs":"Timer"})]}),a.jsx(De,{ref:t,variant:"animation",children:a.jsx(DI,{active:s=>e(Ot({countDown:s})),closeModal:()=>{var s;return(s=t.current)==null?void 0:s.close()}})})]})}function pJ({song:t}){const e=f.useRef(null);return a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("button",{onClick:()=>{var n;return(n=e.current)==null?void 0:n.open()},children:a.jsx(br,{className:"w-6"})}),a.jsx("span",{children:"Add to playlist"})]}),a.jsx(De,{variant:"animation",ref:e,children:a.jsx(Rw,{closeModal:()=>{var n;return(n=e.current)==null?void 0:n.close()},song:t})})]})}function gJ({isLiked:t,song:e}){const{action:n,loading:r}=Pw();return a.jsxs("div",{children:[a.jsx("button",{onClick:()=>n({variant:"like",song:e}),className:`${Li(t,"active")}`,children:r?a.jsx(He,{className:"w-6 animate-spin"}):a.jsx(a.Fragment,{children:t?a.jsx(Cu,{className:"w-6"}):a.jsx(Za,{className:"w-6"})})}),a.jsx("span",{children:t?"Dislike":"Like"})]})}function xJ(){const{user:t}=xe(),{currentSongData:e,queueSongs:n}=se(ze),{toggleRepeat:r,repeat:s}=si(),i={buttonList:"flex flex-shrink-0 overflow-auto space-x-2 [&_div]:flex [&_div]:w-[70px] [&_div]:flex-col [&_div]:items-center [&_div]:space-y-1.5 [&_div]:text-center [&_button]:p-3.5 [&_button]:bg-white/10 [&_button]:rounded-full [&_button.active]:text-[#198585] [&_span]:text-xs"};if(e)return a.jsx(a.Fragment,{children:a.jsxs("div",{className:"h-[70vh] overflow-hidden text-white rounded-[16px_16px_0_0] relative p-3 flex flex-col",children:[a.jsx("div",{className:"bg-opacity-[0.8] backdrop-blur-[15px] z-[-1] bg-[#1f1f1f] absolute inset-0"}),a.jsxs("div",{className:i.buttonList,children:[a.jsxs("div",{children:[a.jsx("button",{disabled:n.length<=1,className:`${Li(s!=="no","active")}`,onClick:r,children:a.jsx(TI,{className:"w-6"})}),a.jsx("span",{className:"break-word",children:s==="one"?"Repeat one":s==="all"?"Repeat all":"Play once"})]}),t&&a.jsxs(a.Fragment,{children:[a.jsx(pJ,{song:e.song}),a.jsx(gJ,{song:e.song,isLiked:!!(t!=null&&t.liked_song_ids.includes(e.song.id))})]}),a.jsx(mJ,{})]}),a.jsx("div",{className:"flex-grow overflow-auto mt-3 border-t border-white/60 pt-3",children:e&&a.jsx(fJ,{currentIndex:e.index})})]})})}function yJ(){const{setIsOpenFullScreen:t}=ct(),{setIsOpenComment:e}=Gr(),n=f.useRef(null),r=f.useRef(null),s=()=>{var i;(i=r.current)==null||i.open(),e(!0)};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex space-x-1 items-center",children:[a.jsx("button",{className:"p-1.5",onClick:s,children:a.jsx(Qy,{className:"w-6"})}),a.jsx("button",{className:"p-1.5",onClick:()=>{var i;return(i=n.current)==null?void 0:i.open()},children:a.jsx(nM,{className:"w-6"})}),a.jsx("button",{onClick:()=>t(!1),className:"p-1.5",children:a.jsx(CI,{className:"w-6"})})]}),a.jsx(Tx,{ref:n,children:a.jsx(xJ,{})}),a.jsx(Tx,{onClose:()=>e(!1),ref:r,children:a.jsx(iA,{children:a.jsx(f5,{})})})]})}function vJ({handlePlayPause:t,playStatus:e}){const n={icon:"w-10"},r=()=>{switch(e){case"playing":return a.jsx(sv,{className:`${n.icon}`});case"error":return a.jsx(FI,{className:`${n.icon}`});case"loading":case"waiting":return a.jsx(XL,{className:`${n.icon} animate-spin`});case"paused":return a.jsx(nf,{className:`${n.icon}`})}};return a.jsx(a.Fragment,{children:a.jsx("button",{className:"inline-flex items-center justify-center",onClick:()=>t(),children:r()})})}function wJ(){var l;const{timelineEleRef:t,currentTimeEleRef:e}=ct(),{playStatus:n}=se(Dn),{currentSongData:r}=se(ze),{handleSeek:s,handlePlayPause:i}=si(),o={buttonsContainer:"w-full flex items-center justify-between space-x-2 mt-2",progressContainer:"flex w-full flex-row items-center ",processLineBase:"h-1 flex-grow relative rounded-[99px] shadow-[2px_2px_10px_rgba(0,0,0,.15)] ",before:"before:content-[''] before:w-[100%] before:h-[24px] before:absolute before:top-[50%] before:translate-y-[-50%]"};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:`${o.progressContainer}  ${n==="error"||n==="loading"?"disable":""}`,children:[a.jsx("div",{className:"w-[44px] sm:w-9",children:a.jsx("span",{ref:e,className:"text-lg sm:text-sm",children:"0:00"})}),a.jsx("div",{ref:t,style:{background:"rgba(255, 255, 255, 0.3)"},onClick:c=>s(c),className:`${o.processLineBase}  ${o.before}`}),a.jsx("div",{className:"w-[44px] sm:w-9 text-right",children:a.jsx("span",{className:"text-lg sm:text-sm",children:r!=null&&r.song?zs((l=r.song)==null?void 0:l.duration):"0:00"})})]}),a.jsxs("div",{className:`${o.buttonsContainer}`,children:[a.jsx(vJ,{playStatus:n,handlePlayPause:i}),a.jsx(Qm,{target:"song",children:a.jsx(yJ,{})})]})]})}function _J(){const{isOpenFullScreen:t,playerConig:{songBackground:e},mobileActiveTab:n}=ct(),{currentSongData:r}=se(ze),s=f.useRef(null),{wrapperRef:i}=uJ({isOpenFullScreen:t}),o={headerWrapper:"flex mb-4",container:"flex-grow flex flex-col relative overflow-hidden",control:"mt-auto",bgImage:"absolute inset-0 z-[-9] brightness-[70%] blur-[4px] translate-3d-0"};return a.jsx(a.Fragment,{children:a.jsxs("div",{ref:i,style:{transform:"translate(0, 100%)",zIndex:"-10"},className:"block md:hidden fixed inset-0 bg-zinc-900 text-white overflow-hidden transition-[transform] duration-[.3s] ease-linear",children:[e&&a.jsx("div",{className:o.bgImage,children:a.jsx(ju,{width:"100%",height:"100%",hash:(r==null?void 0:r.song.blurhash_encode)||h5})}),a.jsx("div",{className:"h-full z-10 p-4 flex flex-col",children:a.jsxs("div",{ref:s,className:o.container,children:[a.jsxs("div",{className:`${n!="Playing"?"flex items-center":"sm:flex"}`,children:[a.jsx(dJ,{imageUrl:r==null?void 0:r.song.image_url}),a.jsxs("div",{className:`ml-2 ${n!="Playing"?"block":"hidden sm:block"}`,children:[a.jsx("p",{className:"font-playwriteCU translate-y-[-6px] leading-[2.4] line-clamp-1",children:r==null?void 0:r.song.name}),a.jsx("div",{className:"opacity-[.7] line-clamp-1 text-sm",children:r==null?void 0:r.song.singers.map((l,c)=>a.jsxs("span",{children:[" ",(c?", ":"")+l.name]},c))})]}),n==="Lyric"&&a.jsxs(pr,{appendOnPortal:!0,children:[a.jsx(gr,{children:a.jsx("button",{className:" p-[6px] rounded-full ml-auto  bg-white/10",children:a.jsx(Xy,{className:"w-6"})})}),a.jsx(xr,{appendTo:"portal",position:"left-bottom",origin:"top right",children:a.jsx(lC,{})})]})]}),a.jsx("div",{className:`mt-2 justify-between items-center ${n!="Playing"?"hidden":"flex sm:hidden"}`,children:a.jsxs("div",{className:"flex-grow",children:[a.jsx("div",{className:"h-[40px]",children:a.jsx(g5,{className:"text-xl leading-[1.5] font-playwriteCU",content:(r==null?void 0:r.song.name)||"..."})}),a.jsx("div",{className:"opacity-[.7] line-clamp-1 text-sm",children:r==null?void 0:r.song.singers.map((l,c)=>l.id?a.jsx(we,{to:`/singer/${l.id}`,children:(c?", ":"")+l.name},c):a.jsxs("span",{children:[" ",(c?", ":"")+l.name]},c))})]})}),a.jsx(_I,{children:a.jsx(YR,{isOpenLyricTabs:t&&n=="Lyric",children:a.jsx(m5,{className:`text-left ${n==="Lyric"?"flex-1 block":"hidden"}`})})}),a.jsx("div",{className:`${o.control}`,children:a.jsx(wJ,{})})]})})]})})}function bJ(){const{theme:t}=q(),{isOpenFullScreen:e,setIsOpenFullScreen:n}=ct(),{playStatus:r}=se(Dn),{currentSongData:s}=se(ze),{handlePlayPause:i}=si(),o=rr(),l=f.useMemo(()=>o.pathname.includes("lyric")||o.pathname==="/",[o]),c=f.useMemo(()=>{switch(r){case"playing":return a.jsx(nv,{className:"w-10"});case"error":return a.jsx(hm,{className:"w-10"});case"loading":case"waiting":return a.jsx(He,{className:"w-10 animate-spin"});case"paused":return a.jsx(RI,{className:"w-10"})}},[r]),u={wrapper:`block md:hidden fixed bottom-0 transition-transform w-full h-[80px] overflow-hidden border-t border-${t.alpha} z-40  px-4`,container:`absolute inset-0 ${t.bottom_player_bg} bg-opacity-[0.7] backdrop-blur-[15px] z-[-1]`,songImageWrapper:"flex flex-row items-center flex-grow h-full",image:"w-[54px] h-[54px] flex-shrink-0",cta:"ml-2 flex-shrink-0"};return a.jsxs("div",{className:`${u.wrapper} ${l?"translate-y-[100%]":""}`,children:[a.jsx("div",{className:`${u.container} ${e?"opacity-0 transition-opacity delay-[.3s]":""}`}),a.jsxs("div",{className:"flex justify-between items-center h-full",children:[a.jsx("div",{onClick:()=>s!=null&&s.song.name?n(!0):{},className:"mobile-current-song flex-grow",children:a.jsxs("div",{className:u.songImageWrapper,children:[a.jsx("div",{className:u.image,children:a.jsx(Ye,{src:s==null?void 0:s.song.image_url,className:"rounded-full"})}),a.jsx("div",{className:"flex-grow ml-2",children:(s==null?void 0:s.song.song_url)&&a.jsxs(a.Fragment,{children:[a.jsx("p",{className:"font-playwriteCU line-clamp-1",children:(s==null?void 0:s.song.name)||"..."}),a.jsx("p",{className:"opacity-70 text-sm line-clamp-1",children:s==null?void 0:s.song.singers.map((d,m)=>(m?", ":"")+d.name)})]})})]})}),a.jsx("div",{className:`${u.cta} ${!(s!=null&&s.song.name)&&"disable"}`,children:a.jsx("button",{className:"p-[4px]",onClick:i,children:c})})]})]})}function SJ(){const t=on(),{audioRef:e,firstTimeSongLoaded:n}=ct(),{playStatus:r,countDown:s}=se(Dn),{handlePlayPause:i}=si(),o=f.useRef(0),l=()=>(console.log("song end"),nt("timer",o.current-1),t(Ot({countDown:o.current-1})));f.useEffect(()=>{const c=mn().timer||0;t(Ot({countDown:c}))},[]),f.useEffect(()=>{if(!(!s||!e.current))return e.current.addEventListener("ended",l),n.current||(nt("timer",s),nt("is_timer",!0),r==="paused"&&i()),()=>{var c;(c=e.current)==null||c.removeEventListener("ended",l)}},[!!s]),f.useEffect(()=>{o.current=s},[s])}function EJ(){const{isOpenFullScreen:t,playerConig:{repeat:e,isShuffle:n,isCrossFade:r,isEnableBeat:s},audioRef:i,firstTimeSongLoaded:o,startFadeWhenEnd:l,isPlayingNewSong:c,timelineEleRef:u,currentTimeEleRef:d,themeCodeRef:m,shouldSyncSongDuration:p}=ct();if(!i.current)throw new Error("Use Control audioRef.current is undefined");const g=on(),{theme:y}=q(),{user:w,updateUserData:_}=xe(),{queueSongs:E,currentSongData:b,currentQueueId:S}=se(ze),{playStatus:C}=se(Dn),{currentPlaylist:D}=se(ta),F=f.useRef(),I=f.useRef(!1),k=f.useRef(!1),R=f.useRef(!1),j=f.useRef("paused"),N=f.useRef([]),P=rr(),{setErrorToast:A}=fe(),{next:ee,updateProgressElement:me,play:ye,pause:Ne}=si(),H=f.useMemo(()=>P.pathname.includes("edit"),[P]),Y=f.useMemo(()=>mn(),[]),te=be=>E[be],_e=()=>{g(Ot({playStatus:"paused"}))},Ie=()=>{C!=="playing"&&(g(Ot({playStatus:"playing"})),R.current=!1)},We=()=>{u.current&&d.current&&(d.current.innerText="0:00",u.current.style.background="rgba(255, 255, 255, 0.15)")},Ir=be=>{const xt=mn().volume||1;if(be<=2){const yt=be/2*xt;i.current.volume=yt}else if(be<l.current){i.current.volume!=xt&&(i.current.volume=xt);return}if(be>=l.current){const yt=(i.current.duration-be)/2*xt;i.current.volume=yt}},ir=()=>{const be=i.current.currentTime;j.current!=="paused"&&g(Ot({playStatus:"playing"})),me(be),r&&Ir(be),be&&Math.round(be)%3===0&&nt("current_time",Math.round(be))},ar=()=>{if(console.log("end"),!F.current)return;const be=mn(),xt=be.volume||1,yt=be.timer;if(e==="one"&&yt&&yt!==1)return ye();if(i.current.volume=xt,k.current=!0,n){let Mn=F.current.index;for(;Mn===F.current.index;)Mn=Math.round(Math.random()*E.length-1);const Tn=te(Mn);return g(ds(Tn.queue_id))}return yt===0&&be.is_timer?(I.current=!0,nt("is_timer",!1)):F.current.index===E.length-1&&(e==="all"||yt>=1?I.current=!1:I.current=!0),E.length===1?We():ee()},Ln=()=>{F.current&&g(Ot({playStatus:"loading"}))},Ju=()=>{if(!F.current)return;const be=i.current.duration;if(l.current=be-3,nt("current_queue_id",F.current.song.queue_id),I.current)return I.current=!1,g(Ot({playStatus:"paused"}));if((H||o.current)&&(g(Ot({playStatus:"paused"})),o.current)){o.current=!1,p.current=!0,me(Y.current_time||0);return}if(F.current)if(w){const xt=F.current.song.id,yt=[...N.current];if(!yt.includes(xt)){console.log("push recent songs");const Tn={recent_song_ids:[...yt,xt]};_(Tn),kt({collectionName:"Users",data:Tn,id:w.email})}}else{const xt=mn()["recent-songs"]||[];xt.find(Mn=>{var Tn;return Mn.id===((Tn=F.current)==null?void 0:Tn.song.id)})||xt.unshift(F.current.song),nt("recent-songs",xt)}ye()},Zu=()=>{g(Ot({playStatus:"waiting"}))},sa=()=>{if(F.current){if(R.current||(R.current=!0,A("Found internet error")),!k.current)return g(Ot({playStatus:"error"}));if(E.length>1){if(F.current.index===E.length-1){g(Ot({playStatus:"error"}));return}ee()}else g(Ot({playStatus:"error"}))}};f.useEffect(()=>{w&&(N.current=w.recent_song_ids)},[w]),f.useEffect(()=>{const be=Y.current_queue_id||null;be&&E.length?g(ds(be)):o.current=!1},[]),f.useEffect(()=>(i.current.addEventListener("error",sa),i.current.addEventListener("pause",_e),i.current.addEventListener("play",Ie),i.current.addEventListener("loadstart",Ln),i.current.addEventListener("loadedmetadata",Ju),i.current.addEventListener("waiting",Zu),()=>{var be,xt,yt,Mn,Tn,Nl;(be=i.current)==null||be.removeEventListener("error",sa),(xt=i.current)==null||xt.removeEventListener("pause",_e),(yt=i.current)==null||yt.removeEventListener("play",Ie),(Mn=i.current)==null||Mn.removeEventListener("loadstart",Ln),(Tn=i.current)==null||Tn.removeEventListener("loadedmetadata",Ju),(Nl=i.current)==null||Nl.addEventListener("waiting",Zu)}),[]),f.useEffect(()=>{if(!b||!S){j.current="paused",Ne();return}return i.current.src=s&&b.song.beat_url?b.song.beat_url:b.song.song_url,F.current=b,()=>{We(),c.current=!0,p.current&&(p.current=!1)}},[b==null?void 0:b.song]),f.useEffect(()=>{if(!b){C==="paused"&&We();return}let be=`${b.song.name}`;C==="paused"&&D&&b.song.queue_id.includes(D.id)&&(be=`${D.name}`),document.title=be,j.current=C},[C]),f.useEffect(()=>(console.log("add end event"),i.current.addEventListener("ended",ar),()=>{var be;return(be=i.current)==null?void 0:be.removeEventListener("ended",ar)}),[e,n,S,E]),f.useEffect(()=>(i.current.addEventListener("timeupdate",ir),()=>{var be;(be=i.current)==null||be.removeEventListener("timeupdate",ir)}),[r]),f.useEffect(()=>{t?m.current="#fff":m.current=y.content_code,me(o.current?Y.current_time:0)},[y,t]),f.useEffect(()=>{H&&C==="playing"&&Ne()},[H])}function kJ(t,e){const{currentSongData:n}=se(ze),{isOpenFullScreen:r,setIdle:s}=ct(),[i,o]=f.useState(0),l=f.useRef(),c=f.useRef(),u=()=>{s(!1),o(Math.random())},d=()=>{clearTimeout(c.current),clearTimeout(l.current)},m=async()=>{if(!r)return;const p=document.querySelector(".song-thumb.active"),g=document.querySelector(".song-list-container");if(p&&g){const y=Bx(p,g,!0);let w=Tw.focusDelay;y||(w=0),l.current=setTimeout(()=>{s(!0)},w)}};if(f.useEffect(()=>{if(!(e||!n)){if(!r){s(!1);return}return setTimeout(()=>{window.addEventListener("mousemove",u),window.dispatchEvent(new Event("mousemove"))},1e3),()=>{window.removeEventListener("mousemove",u),d()}}},[r]),f.useEffect(()=>(c.current=setTimeout(()=>{m()},t),()=>{d()}),[i]),!r)return!1}function TJ({children:t}){const{isOnMobile:e}=q();return EJ(),SJ(),kJ(Tw.focusDelay,e),f.useMemo(()=>t,[])}function IJ(){const{isOnMobile:t}=q(),{audioRef:e}=ct(),[n,r]=f.useState(!1),s=e.current&&a.jsxs(a.Fragment,{children:[a.jsx(GY,{}),a.jsx(JY,{}),a.jsx(cJ,{})]}),i=e.current&&a.jsxs(a.Fragment,{children:[a.jsx(_J,{}),a.jsx(bJ,{})]});return f.useEffect(()=>{r(!0)},[]),a.jsxs(a.Fragment,{children:[a.jsx("audio",{ref:e,className:"hidden"}),e.current&&a.jsx(TJ,{children:t?i:s})]})}function CJ({className:t}){const[e,n]=f.useState(!1),{theme:r}=q(),s=()=>{const o=document.querySelector(".main-container");if(!o)return;const l=o.scrollTop||0;n(l>100)},i=()=>{const o=document.querySelector(".main-container");o==null||o.scroll({behavior:"smooth",top:0})};return f.useEffect(()=>{const o=document.querySelector(".main-container");if(o)return o.addEventListener("scroll",s),()=>{o.removeEventListener("scroll",s)}},[]),a.jsx(ie,{onClick:i,variant:"circle",size:"clear",className:`absolute p-[8px] hover:scale-[1.05] transition-[opacity,transform] 
         ${t||""} 
         w-[36px] 
         ${r.content_hover_bg} h-[36px] bg-${r.alpha} 
      ${e?"opacity-[1]":"opacity-0 translate-y-[20px]"}`,children:a.jsx(ZL,{className:"w-full"})})}function jJ(){const{theme:t}=q(),{user:e,loading:n}=xe(),r=rr(),s=Gt(),i=()=>{s("/dashboard")},o=[...Array(2).keys()].map(u=>a.jsxs("div",{className:"px-3 w-full h-[51px] flex items-center",children:[a.jsx(le,{className:"w-[28px] h-[28px] mr-1 flex-shrink-0"}),a.jsx(le,{className:"w-[100px] h-[30px]"})]},u)),l=u=>u?`${t.content_text} ${t.container} ${t.content_border}`:"border-transparent",c={container:`w-[80px] xl:w-[180px]  relative  flex-shrink-0 border-r-[1px] h-screen ${t.side_bar_bg} border-${t.alpha}`,linkList:`
      ${t.type==="light"?"hover:[&_div]:bg-black/10":"hover:[&_div]:bg-white/10"}
      [&_div]:py-3
      [&_div]:leading-[2.2] 
      [&_div]:font-playwriteCU 
      [&_div]:flex 
      [&_div]:flex-col 
      [&_div]:items-center
      [&_div]:space-y-1 

      xl[&_div]:space-y-0 
      xl:[&_div]:space-x-2 
      xl:[&_div]:px-3
      xl:[&_div]:flex-row 
      xl:[&_div]:items-center
      [&_svg]:w-7
      xl:[&_a]:border-l-[4px]
      [&_a]:w-full
      [&_span]:text-[10px]
      `};return a.jsxs("div",{className:`hidden md:block ${c.container} ${t.text_color}`,children:[a.jsx("div",{className:"px-[10px] h-[60px] flex items-center justify-center",children:a.jsxs(we,{to:"/",className:"text-[24px] font-[500]",children:["HD",a.jsx("span",{className:`${t.content_text} ml-[4px]`,children:"MP3"})]})}),a.jsxs("div",{className:`flex flex-col items-start ${c.linkList}`,children:[n&&o,!n&&a.jsxs(a.Fragment,{children:[a.jsx(we,{className:`
              ${l(r.pathname==="/")}
            `,to:"/",children:a.jsxs("div",{children:[a.jsx(fm,{}),a.jsx("span",{children:"For You"})]})}),a.jsx(we,{className:`
              ${l(r.pathname==="/discover")}
            `,to:"/discover",children:a.jsxs("div",{children:[a.jsx(MD,{}),a.jsx("span",{children:"Discover"})]})}),e&&a.jsxs(a.Fragment,{children:[a.jsx(we,{className:`
                  ${l(r.pathname==="/my-music")}`,to:"/my-music",children:a.jsxs("div",{children:[a.jsx(Yi,{}),a.jsx("span",{children:"My Song"})]})}),e.role==="ADMIN"&&a.jsx(we,{to:"/dashboard",className:"border-transparent",children:a.jsxs("div",{onClick:i,children:[a.jsx(Yy,{}),a.jsx("span",{className:"",children:"Dashboard"})]})})]})]})]}),a.jsx(CJ,{className:"left-[50%] translate-x-[-50%] bottom-[80px] md:bottom-[100px]"})]})}function RJ(){const[t,e]=f.useState(""),[n,r]=f.useState(!1),[s,i]=f.useState(!1),[o,l]=f.useState([]),c=f.useRef(null),u=f.useRef(null),d=f.useRef(null),m=f.useRef(!0),p=FT(),g=WR(t,700),y=new AbortController,w=_=>{const E=document.querySelector(".popup-content"),b=_.target,S=document.querySelectorAll(".modal-content");let C=!1;S.forEach(D=>D.contains(b)?C=!0:{}),!(c.current&&u.current&&(c.current.contains(b)||C||u.current.contains(b)||E!=null&&E.contains(b)))&&i(!1)};return f.useEffect(()=>{if(!g.trim()){r(!1),l([]);return}const _=async()=>{try{r(!0);const E=he(wn,Q("is_official","==",!0),Q("name",">=",t),Q("name","<=",t+"")),b=await _n(E);l(b)}catch(E){console.log(E)}finally{r(!1)}};return m.current?_():m.current=!0,()=>{console.log("abort"),y.abort()}},[g]),f.useEffect(()=>(s&&document.addEventListener("click",w),()=>{document.removeEventListener("click",w)}),[s]),f.useEffect(()=>(e(p[0].get("q")||""),()=>{var _;m.current=!1,(_=d.current)==null||_.blur(),i(!1)}),[p[0].get("q")]),f.useEffect(()=>{p[0].get("q")!==t&&s&&(m.current=!0)},[t,s]),{isFetching:n,searchResult:o,value:t,setValue:e,isFocus:s,setIsFocus:i,formRef:c,searchResultRef:u,inputRef:d}}function AJ({songs:t}){const{handleSetSong:e}=ni({variant:"search-bar"}),{getRecommend:n}=Dw(),r=s=>{e(s.queue_id,[s]),n(s)};return a.jsx(ps,{children:t.length?a.jsx(ri,{isHasCheckBox:!1,setSong:r,songs:t}):a.jsx(Xe,{})})}function NJ(){const t={listWrapper:"[&>*]:px-3 *:text-sm [&>*]:py-2 [&>*]:flex [&>*]:items-center [&>*]:space-x-1 [&>*]:rounded-md "};return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"text-sm font-[500] mb-2",children:"Suggestion keyword"}),a.jsx("div",{className:t.listWrapper,children:a.jsxs(we,{to:"/search?q=nhac-tet",children:[a.jsx(II,{className:"w-5"}),a.jsx("span",{children:"Nhac tet"})]})})]})}function PJ(){const{theme:t}=q(),e=Gt(),{isFetching:n,inputRef:r,formRef:s,searchResultRef:i,value:o,searchResult:l,setIsFocus:c,isFocus:u,setValue:d}=RJ(),m={container:`relative h-[40px] flex px-3 w-[300px] ${t.text_color} shadow-md`,unFocusContainer:`bg-${t.alpha} rounded-[20px]`,focusedContainer:`${t.type==="dark"?t.modal_bg:t.side_bar_bg} rounded-[20px_20px_0_0]`,input:`bg-transparent outline-none  w-full ${t.type==="light"?"placeholder:text-black":"placeholder:text-white"}`,searchResultContainer:`${t.type==="dark"?t.modal_bg:t.side_bar_bg} shadow-md  rounded-[0_0_20px_20px] p-3 position absolute top-full left-0 w-full max-h-[60vh] overflow-hidden flex flex-col`},p=async g=>{g.preventDefault(),e(`/search?q=${o}`),c(!1)};return a.jsx(a.Fragment,{children:a.jsxs("form",{ref:s,onSubmit:p,className:`${m.container} ${u?m.focusedContainer:m.unFocusContainer}`,children:[a.jsx("button",{className:"mr-2",children:a.jsx(ev,{className:"w-6"})}),a.jsx("input",{ref:r,value:o,onFocus:()=>c(!0),onChange:g=>d(g.target.value.trim()),placeholder:"Nhac tet...",className:m.input,type:"text"}),a.jsx("button",{type:"button",onClick:()=>d(""),className:`${o?"opacity-100":"!opacity-0"} ${Yc(!o)}`,children:n?a.jsx(He,{className:"w-5 animate-spin"}):a.jsx(Zs,{className:"w-5"})}),a.jsx("div",{ref:i,className:`${Jc(!u)} ${m.searchResultContainer}`,children:l.length?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"text-sm font-[500] mb-2",children:"Suggestion results"}),a.jsx("div",{className:"overflow-auto no-scrollbar",children:a.jsx(AJ,{songs:l})})]}):a.jsx(NJ,{})})]})})}function FJ({contentRef:t}){const{theme:e}=q(),[n,r]=f.useState(0),[s,i]=Av(Wa),[o,l]=f.useState(""),c=f.useRef(null),u=f.useRef(null),d=f.useRef(null),{action:m}=Gm(),p=S=>{var C,D;l(S),(C=d.current)==null||C.toggle(),(D=c.current)==null||D.close()},g=async()=>{var S;try{await m("logout")}catch(C){console.log("signOut error",{message:C})}finally{(S=d.current)==null||S.toggle()}},y=async()=>{var S;try{(S=u.current)==null||S.close(),await m("login")}catch(C){console.log({message:C})}},w=()=>{var C;const S=((C=t.current)==null?void 0:C.scrollTop)||0;r(S)},_=a.jsx(le,{className:"h-[40px] w-[40px] rounded-full"}),E=f.useMemo(()=>{switch(o){case"":return a.jsx(a.Fragment,{});case"theme":return a.jsx(ov,{close:()=>{var S;return(S=d.current)==null?void 0:S.toggle()}});case"info":return a.jsx(av,{close:()=>{var S;return(S=d.current)==null?void 0:S.toggle()}});case"confirm":return a.jsx(xs,{close:()=>{var S;return(S=d.current)==null?void 0:S.toggle()},callback:g,loading:!1,label:"Sign out ?"})}},[o]);f.useEffect(()=>{var S;return(S=t.current)==null||S.addEventListener("scroll",w),()=>{document.removeEventListener("scroll",w)}},[]);const b={userName:"text-[16px] font-[500] ml-[8px] line-clamp-1",button:"h-[40px] w-[40px] rounded-full",menuItem:"hover:bg-white/5 rounded-[4px] w-full text-sm px-[10px] h-[44px] inline-flex items-center font-[500]",icon:"w-5 mr-1",divide:`h-[1px]  w-[calc(100%-20px)] mb-[10px] mt-[20px] mx-auto bg-${e.alpha}`};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:`hidden md:block h-[60px] fixed top-0 right-0 left-[180px] z-[20]  ${n?"shadow-lg":"bg-transparent"}`,children:[a.jsx("div",{className:` absolute inset-0 ${e.container} bg-opacity-[0.8] backdrop-blur-[15px] inset-0 z-[-1] `}),a.jsxs("div",{className:"px-[40px] items-center flex h-full",children:[a.jsx(u5,{className:"mr-5"}),a.jsx(PJ,{}),a.jsxs("div",{className:"flex space-x-3 ml-auto",children:[a.jsxs(pr,{children:[a.jsx(gr,{ref:c,children:a.jsx(us,{isWrapped:!0,position:"top-[calc(100%+8px)]",content:"Settings",children:a.jsx("button",{className:`flex px-[6px] items-center ${b.button} bg-${e.alpha} ${e.content_hover_bg}`,children:a.jsx(Tu,{className:"w-full"})})})}),a.jsx(xr,{appendTo:"parent",className:"top-[calc(100%+8px)] right-0",animationClassName:"origin-top-right",children:a.jsx(WI,{openModal:p,variant:"client"})})]}),a.jsxs(pr,{children:[a.jsx(gr,{ref:u,className:"flex items-center",children:a.jsx("button",{className:"flex hover:brightness-90",children:i?_:a.jsx(bx,{className:"w-[40px] h-[40px]"})})}),a.jsx(xr,{appendTo:"parent",className:"top-[calc(100%+8px)] right-0",animationClassName:"origin-top-right",children:a.jsx(ei,{theme:e,children:a.jsxs("div",{className:"w-[250px] max-h-[50vh]",children:[s&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center p-[10px] pb-0",children:[a.jsx(bx,{className:"login-trigger w-[46px] h-[46px]"}),a.jsx("div",{className:"ml-[12px]",children:a.jsx("h5",{className:"font-semibold line-clamp-1",children:s==null?void 0:s.displayName})})]}),a.jsx("div",{className:b.divide}),a.jsxs("button",{className:`${b.menuItem}`,onClick:()=>p("confirm"),children:[a.jsx(Wy,{className:b.icon}),"Log out"]})]}),!s&&a.jsxs("button",{className:`${b.menuItem}`,onClick:y,children:[a.jsx(T6,{className:b.icon}),"Log in"]})]})})})]})]})]})]}),a.jsx(De,{variant:"animation",ref:d,children:E})]})}function DJ(){const{user:t,setUser:e}=xe(),{isDev:n}=q(),{uploadedSongs:r,setUploadedSongs:s,shouldFetchFavoriteSongs:i}=Pn(),{setIsUploading:o,isUploading:l,setUploadingSongs:c,resetUploadContext:u}=yI(),[d,m]=f.useState(""),p=f.useRef(null),{setErrorToast:g,setSuccessToast:y}=fe(),w=()=>{const E=p.current;E&&(E.value=""),u()},_=async E=>{try{if(!t)return;const b=[],S=[],C=E.target.files;if(!C.length)return;const D=[],F=[],I=Date.now(),k=P=>r.some(A=>A.size===P.size)||D.some(A=>A.size===P.size);for(let P=0;P<=C.length-1;P++){const A=C[P],ee=await e5(A);if(!ee)continue;const me={name:ee.singer,created_at:""},ye={...If(me),id:""},Ne={name:ee.name,singers:[ye],duration:Math.floor(ee.duration),size:Math.floor(A.size/1024)},H=ee.image?new Blob([ee.image]):null;H&&(S.push(H),Ne.image_url=URL.createObjectURL(H));const Y=Ex({...Ne,owner_email:t.email,distributor:t.display_name});if(k(Y)){console.log(">>>duplicate");continue}D.push(Y),b.push(P)}if(r.length+b.length>5)return m("You have reach the upload limit");if(!D.length)return;c(D),o(!0);for(let P=0;P<b.length;P++){const A=b[P],ee=S[P],me={...D[P]},{filePath:ye,fileURL:Ne}=await Cw({file:C[A],folder:"/songs/",namePrefix:t.email,msg:">>> api: upload song file"});if(ee){const _e=await na({blob:ee});Object.assign(me,_e)}Object.assign(me,{song_file_path:ye,song_url:Ne});const H=await Ks({collectionName:"Songs",data:me,msg:">>> api: set song doc"}),Y=await Va(H);F.push(Y.id);const te={...Y.data(),id:H.id,queue_id:Qu(4)};s(_e=>[..._e,te]),c(_e=>{const Ie=[..._e];return Ie.shift,Ie})}const j={liked_song_ids:[...F,...t.liked_song_ids]};await kt({collectionName:"Users",data:j,id:t.email}),e({...t,...j}),i.current=!0,y(`${D.length} songs uploaded`);const N=Date.now();n&&console.log(">>> upload songs finished after",(N-I)/1e3)}catch(b){console.log({message:b}),g(d)}finally{w()}};return f.useEffect(()=>{if(!l)return;const E=document.querySelector(".temp-song");E&&E.scrollIntoView({behavior:"smooth",block:"center"})},[l]),{handleInputChange:_,inputRef:p}}function LJ(){const{handleInputChange:t,inputRef:e}=DJ(),n={container:"upload portal fixed z-[199] bottom-[120px] right-[30px] max-[549px]:bottom-[unset] max-[540px]:top-[10px] max-[540px]:right-[10px]"};return a.jsx(a.Fragment,{children:Ya.createPortal(a.jsx("div",{className:n.container,children:a.jsx("input",{ref:e,onChange:t,type:"file",multiple:!0,accept:"audio",id:"song_upload",className:"hidden"})}),document.getElementById("portals"))})}function MJ(){const{theme:t}=q(),e=f.useRef(null),n={page:`md:flex md:h-screen  ${t.container} ${t.text_color}`,container:"md:h-full md:w-full md:flex md:flex-col px-[10px] md:px-[40px] pt-[30px] md:pt-[60px] md:overflow-auto"};return f.useEffect(()=>{const r=document.querySelector(".my-tag"),s=document.querySelector("body");s.style.backgroundColor=t.container_code,r&&r.setAttribute("content",t.container_code)},[t]),a.jsx(a.Fragment,{children:a.jsx(g6,{children:a.jsxs(gI,{children:[a.jsxs("div",{className:`${n.page}`,children:[a.jsx(jJ,{}),a.jsxs("div",{ref:e,className:n.container,children:[a.jsx(FJ,{contentRef:e}),a.jsx(rm,{})]}),a.jsx(IJ,{})]}),a.jsx(d5,{className:"left-[50%] translate-x-[-50%] top-[10px] md:top-[unset] md:bottom-[100px] md:left-[20px] md:translate-x-0"}),a.jsx(LJ,{}),a.jsx(pI,{})]})})})}function Lg({children:t}){return t}function OJ(){return a.jsx(a.Fragment,{children:a.jsx(f3,{children:a.jsxs(a3,{children:[a.jsx(Jr,{path:"*",element:a.jsx(gq,{})}),a.jsx(Jr,{path:"/login",element:a.jsx(yq,{})}),a.jsxs(Jr,{element:a.jsx(MJ,{}),children:[CY.map((t,e)=>{const n=t.layout||Lg,r=t.component;return a.jsx(Jr,{path:t.path,element:a.jsx(n,{children:a.jsx(r,{})})},e)}),a.jsx(Jr,{element:a.jsx(AY,{}),children:jY.map((t,e)=>{const n=t.layout||Lg,r=t.component;return a.jsx(Jr,{path:t.path,element:a.jsx(n,{children:a.jsx(r,{})})},e)})})]}),a.jsx(Jr,{element:a.jsx(NY,{}),children:a.jsx(Jr,{element:a.jsx(MY,{}),children:RY.map((t,e)=>{const n=t.layout||Lg,r=t.component;return a.jsx(Jr,{path:t.path,element:a.jsx(n,{children:a.jsx(r,{})})},e)})})})]})})})}const $J=BO({reducer:{currentPlaylist:hH,playStatus:sH,songQueue:t9},middleware:t=>t({serializableCheck:!1})});function BJ(){const{setUser:t,setLoading:e,loading:n,user:r}=xe(),{getPlaylist:s}=hA();return f.useEffect(()=>{(async()=>{Wa.onAuthStateChanged(async o=>{if(o&&o.email){const l=await Hr({collectionName:"Users",id:o.email}),c=l.data(),u={email:o.email,display_name:o.displayName,photo_url:o.photoURL,liked_song_ids:(c==null?void 0:c.liked_song_ids)||[],recent_playlist_ids:(c==null?void 0:c.recent_playlist_ids)||[],recent_song_ids:(c==null?void 0:c.recent_song_ids)||[],liked_singer_ids:(c==null?void 0:c.liked_singer_ids)||[],role:(c==null?void 0:c.role)||"USER",liked_playlist_ids:(c==null?void 0:c.liked_playlist_ids)||[],liked_comment_ids:mn().liked_comment_ids||[],last_seen:""};l.exists()?await Promise.all([s(),kt({collectionName:"Users",id:u.email,data:{last_seen:Qs()}})]):await DU(Ct(ke,"Users",u.email),u),t(u)}else t(null);e(!1)})})()},[]),{user:r,loading:n}}function zJ({children:t}){return BJ(),t}Mg.createRoot(document.getElementById("root")).render(a.jsx(_E.StrictMode,{children:a.jsx(dO,{store:$J,children:a.jsx(w3,{children:a.jsx(o6,{children:a.jsx(b3,{children:a.jsx(c6,{children:a.jsx(h6,{children:a.jsx(zJ,{children:a.jsx(OJ,{})})})})})})})})}));
