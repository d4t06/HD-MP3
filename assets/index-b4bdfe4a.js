function pA(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var nf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Pv(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function gA(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var s=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,s.get?s:{enumerable:!0,get:function(){return t[r]}})}),n}var JE={exports:{}},bp={},ZE={exports:{}},Oe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ud=Symbol.for("react.element"),xA=Symbol.for("react.portal"),yA=Symbol.for("react.fragment"),vA=Symbol.for("react.strict_mode"),wA=Symbol.for("react.profiler"),_A=Symbol.for("react.provider"),bA=Symbol.for("react.context"),SA=Symbol.for("react.forward_ref"),EA=Symbol.for("react.suspense"),jA=Symbol.for("react.memo"),kA=Symbol.for("react.lazy"),V_=Symbol.iterator;function TA(t){return t===null||typeof t!="object"?null:(t=V_&&t[V_]||t["@@iterator"],typeof t=="function"?t:null)}var ej={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},tj=Object.assign,nj={};function Dc(t,e,n){this.props=t,this.context=e,this.refs=nj,this.updater=n||ej}Dc.prototype.isReactComponent={};Dc.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Dc.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function rj(){}rj.prototype=Dc.prototype;function Fv(t,e,n){this.props=t,this.context=e,this.refs=nj,this.updater=n||ej}var Mv=Fv.prototype=new rj;Mv.constructor=Fv;tj(Mv,Dc.prototype);Mv.isPureReactComponent=!0;var U_=Array.isArray,sj=Object.prototype.hasOwnProperty,Dv={current:null},ij={key:!0,ref:!0,__self:!0,__source:!0};function aj(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)sj.call(e,r)&&!ij.hasOwnProperty(r)&&(s[r]=e[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:Ud,type:t,key:i,ref:o,props:s,_owner:Dv.current}}function IA(t,e){return{$$typeof:Ud,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Lv(t){return typeof t=="object"&&t!==null&&t.$$typeof===Ud}function CA(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var H_=/\/+/g;function p0(t,e){return typeof t=="object"&&t!==null&&t.key!=null?CA(""+t.key):e.toString(36)}function Lf(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Ud:case xA:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+p0(o,0):r,U_(s)?(n="",t!=null&&(n=t.replace(H_,"$&/")+"/"),Lf(s,e,n,"",function(u){return u})):s!=null&&(Lv(s)&&(s=IA(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(H_,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",U_(t))for(var l=0;l<t.length;l++){i=t[l];var c=r+p0(i,l);o+=Lf(i,e,n,c,s)}else if(c=TA(t),typeof c=="function")for(t=c.call(t),l=0;!(i=t.next()).done;)i=i.value,c=r+p0(i,l++),o+=Lf(i,e,n,c,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function rf(t,e,n){if(t==null)return t;var r=[],s=0;return Lf(t,r,"","",function(i){return e.call(n,i,s++)}),r}function RA(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var ar={current:null},Of={transition:null},NA={ReactCurrentDispatcher:ar,ReactCurrentBatchConfig:Of,ReactCurrentOwner:Dv};Oe.Children={map:rf,forEach:function(t,e,n){rf(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return rf(t,function(){e++}),e},toArray:function(t){return rf(t,function(e){return e})||[]},only:function(t){if(!Lv(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Oe.Component=Dc;Oe.Fragment=yA;Oe.Profiler=wA;Oe.PureComponent=Fv;Oe.StrictMode=vA;Oe.Suspense=EA;Oe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=NA;Oe.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=tj({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=Dv.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)sj.call(e,c)&&!ij.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:Ud,type:t.type,key:s,ref:i,props:r,_owner:o}};Oe.createContext=function(t){return t={$$typeof:bA,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:_A,_context:t},t.Consumer=t};Oe.createElement=aj;Oe.createFactory=function(t){var e=aj.bind(null,t);return e.type=t,e};Oe.createRef=function(){return{current:null}};Oe.forwardRef=function(t){return{$$typeof:SA,render:t}};Oe.isValidElement=Lv;Oe.lazy=function(t){return{$$typeof:kA,_payload:{_status:-1,_result:t},_init:RA}};Oe.memo=function(t,e){return{$$typeof:jA,type:t,compare:e===void 0?null:e}};Oe.startTransition=function(t){var e=Of.transition;Of.transition={};try{t()}finally{Of.transition=e}};Oe.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Oe.useCallback=function(t,e){return ar.current.useCallback(t,e)};Oe.useContext=function(t){return ar.current.useContext(t)};Oe.useDebugValue=function(){};Oe.useDeferredValue=function(t){return ar.current.useDeferredValue(t)};Oe.useEffect=function(t,e){return ar.current.useEffect(t,e)};Oe.useId=function(){return ar.current.useId()};Oe.useImperativeHandle=function(t,e,n){return ar.current.useImperativeHandle(t,e,n)};Oe.useInsertionEffect=function(t,e){return ar.current.useInsertionEffect(t,e)};Oe.useLayoutEffect=function(t,e){return ar.current.useLayoutEffect(t,e)};Oe.useMemo=function(t,e){return ar.current.useMemo(t,e)};Oe.useReducer=function(t,e,n){return ar.current.useReducer(t,e,n)};Oe.useRef=function(t){return ar.current.useRef(t)};Oe.useState=function(t){return ar.current.useState(t)};Oe.useSyncExternalStore=function(t,e,n){return ar.current.useSyncExternalStore(t,e,n)};Oe.useTransition=function(){return ar.current.useTransition()};Oe.version="18.2.0";ZE.exports=Oe;var h=ZE.exports;const oj=Pv(h),AA=pA({__proto__:null,default:oj},[h]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var PA=h,FA=Symbol.for("react.element"),MA=Symbol.for("react.fragment"),DA=Object.prototype.hasOwnProperty,LA=PA.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,OA={key:!0,ref:!0,__self:!0,__source:!0};function lj(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)DA.call(e,r)&&!OA.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:FA,type:t,key:i,ref:o,props:s,_owner:LA.current}}bp.Fragment=MA;bp.jsx=lj;bp.jsxs=lj;JE.exports=bp;var a=JE.exports;var Rx={},cj={exports:{}},Br={},uj={exports:{}},dj={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(B,K){var X=B.length;B.push(K);e:for(;0<X;){var he=X-1>>>1,pe=B[he];if(0<s(pe,K))B[he]=K,B[X]=pe,X=he;else break e}}function n(B){return B.length===0?null:B[0]}function r(B){if(B.length===0)return null;var K=B[0],X=B.pop();if(X!==K){B[0]=X;e:for(var he=0,pe=B.length,Ie=pe>>>1;he<Ie;){var vt=2*(he+1)-1,ve=B[vt],pn=vt+1,Dt=B[pn];if(0>s(ve,X))pn<pe&&0>s(Dt,ve)?(B[he]=Dt,B[pn]=X,he=pn):(B[he]=ve,B[vt]=X,he=vt);else if(pn<pe&&0>s(Dt,X))B[he]=Dt,B[pn]=X,he=pn;else break e}}return K}function s(B,K){var X=B.sortIndex-K.sortIndex;return X!==0?X:B.id-K.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,f=null,p=3,g=!1,x=!1,w=!1,v=typeof setTimeout=="function"?setTimeout:null,_=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function j(B){for(var K=n(u);K!==null;){if(K.callback===null)r(u);else if(K.startTime<=B)r(u),K.sortIndex=K.expirationTime,e(c,K);else break;K=n(u)}}function T(B){if(w=!1,j(B),!x)if(n(c)!==null)x=!0,He(R);else{var K=n(u);K!==null&&Be(T,K.startTime-B)}}function R(B,K){x=!1,w&&(w=!1,_(E),E=-1),g=!0;var X=p;try{for(j(K),f=n(c);f!==null&&(!(f.expirationTime>K)||B&&!A());){var he=f.callback;if(typeof he=="function"){f.callback=null,p=f.priorityLevel;var pe=he(f.expirationTime<=K);K=t.unstable_now(),typeof pe=="function"?f.callback=pe:f===n(c)&&r(c),j(K)}else r(c);f=n(c)}if(f!==null)var Ie=!0;else{var vt=n(u);vt!==null&&Be(T,vt.startTime-K),Ie=!1}return Ie}finally{f=null,p=X,g=!1}}var M=!1,k=null,E=-1,I=5,C=-1;function A(){return!(t.unstable_now()-C<I)}function D(){if(k!==null){var B=t.unstable_now();C=B;var K=!0;try{K=k(!0,B)}finally{K?P():(M=!1,k=null)}}else M=!1}var P;if(typeof b=="function")P=function(){b(D)};else if(typeof MessageChannel<"u"){var ee=new MessageChannel,_e=ee.port2;ee.port1.onmessage=D,P=function(){_e.postMessage(null)}}else P=function(){v(D,0)};function He(B){k=B,M||(M=!0,P())}function Be(B,K){E=v(function(){B(t.unstable_now())},K)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(B){B.callback=null},t.unstable_continueExecution=function(){x||g||(x=!0,He(R))},t.unstable_forceFrameRate=function(B){0>B||125<B?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<B?Math.floor(1e3/B):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(B){switch(p){case 1:case 2:case 3:var K=3;break;default:K=p}var X=p;p=K;try{return B()}finally{p=X}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(B,K){switch(B){case 1:case 2:case 3:case 4:case 5:break;default:B=3}var X=p;p=B;try{return K()}finally{p=X}},t.unstable_scheduleCallback=function(B,K,X){var he=t.unstable_now();switch(typeof X=="object"&&X!==null?(X=X.delay,X=typeof X=="number"&&0<X?he+X:he):X=he,B){case 1:var pe=-1;break;case 2:pe=250;break;case 5:pe=1073741823;break;case 4:pe=1e4;break;default:pe=5e3}return pe=X+pe,B={id:d++,callback:K,priorityLevel:B,startTime:X,expirationTime:pe,sortIndex:-1},X>he?(B.sortIndex=X,e(u,B),n(c)===null&&B===n(u)&&(w?(_(E),E=-1):w=!0,Be(T,X-he))):(B.sortIndex=pe,e(c,B),x||g||(x=!0,He(R))),B},t.unstable_shouldYield=A,t.unstable_wrapCallback=function(B){var K=p;return function(){var X=p;p=K;try{return B.apply(this,arguments)}finally{p=X}}}})(dj);uj.exports=dj;var $A=uj.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hj=h,Or=$A;function q(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var fj=new Set,rd={};function rl(t,e){uc(t,e),uc(t+"Capture",e)}function uc(t,e){for(rd[t]=e,t=0;t<e.length;t++)fj.add(e[t])}var Mi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Nx=Object.prototype.hasOwnProperty,zA=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,G_={},W_={};function BA(t){return Nx.call(W_,t)?!0:Nx.call(G_,t)?!1:zA.test(t)?W_[t]=!0:(G_[t]=!0,!1)}function VA(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function UA(t,e,n,r){if(e===null||typeof e>"u"||VA(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function or(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var Tn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Tn[t]=new or(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Tn[e]=new or(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Tn[t]=new or(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Tn[t]=new or(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Tn[t]=new or(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Tn[t]=new or(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Tn[t]=new or(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Tn[t]=new or(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Tn[t]=new or(t,5,!1,t.toLowerCase(),null,!1,!1)});var Ov=/[\-:]([a-z])/g;function $v(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Ov,$v);Tn[e]=new or(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Ov,$v);Tn[e]=new or(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Ov,$v);Tn[e]=new or(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Tn[t]=new or(t,1,!1,t.toLowerCase(),null,!1,!1)});Tn.xlinkHref=new or("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Tn[t]=new or(t,1,!1,t.toLowerCase(),null,!0,!0)});function zv(t,e,n,r){var s=Tn.hasOwnProperty(e)?Tn[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(UA(e,n,s,r)&&(n=null),r||s===null?BA(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Gi=hj.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,sf=Symbol.for("react.element"),Ll=Symbol.for("react.portal"),Ol=Symbol.for("react.fragment"),Bv=Symbol.for("react.strict_mode"),Ax=Symbol.for("react.profiler"),mj=Symbol.for("react.provider"),pj=Symbol.for("react.context"),Vv=Symbol.for("react.forward_ref"),Px=Symbol.for("react.suspense"),Fx=Symbol.for("react.suspense_list"),Uv=Symbol.for("react.memo"),fa=Symbol.for("react.lazy"),gj=Symbol.for("react.offscreen"),q_=Symbol.iterator;function bu(t){return t===null||typeof t!="object"?null:(t=q_&&t[q_]||t["@@iterator"],typeof t=="function"?t:null)}var bt=Object.assign,g0;function Pu(t){if(g0===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);g0=e&&e[1]||""}return`
`+g0+t}var x0=!1;function y0(t,e){if(!t||x0)return"";x0=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,l=i.length-1;1<=o&&0<=l&&s[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==i[l]){var c=`
`+s[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=l);break}}}finally{x0=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Pu(t):""}function HA(t){switch(t.tag){case 5:return Pu(t.type);case 16:return Pu("Lazy");case 13:return Pu("Suspense");case 19:return Pu("SuspenseList");case 0:case 2:case 15:return t=y0(t.type,!1),t;case 11:return t=y0(t.type.render,!1),t;case 1:return t=y0(t.type,!0),t;default:return""}}function Mx(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Ol:return"Fragment";case Ll:return"Portal";case Ax:return"Profiler";case Bv:return"StrictMode";case Px:return"Suspense";case Fx:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case pj:return(t.displayName||"Context")+".Consumer";case mj:return(t._context.displayName||"Context")+".Provider";case Vv:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Uv:return e=t.displayName||null,e!==null?e:Mx(t.type)||"Memo";case fa:e=t._payload,t=t._init;try{return Mx(t(e))}catch{}}return null}function GA(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Mx(e);case 8:return e===Bv?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function $a(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function xj(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function WA(t){var e=xj(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function af(t){t._valueTracker||(t._valueTracker=WA(t))}function yj(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=xj(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function dm(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Dx(t,e){var n=e.checked;return bt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function K_(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=$a(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function vj(t,e){e=e.checked,e!=null&&zv(t,"checked",e,!1)}function Lx(t,e){vj(t,e);var n=$a(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Ox(t,e.type,n):e.hasOwnProperty("defaultValue")&&Ox(t,e.type,$a(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Q_(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Ox(t,e,n){(e!=="number"||dm(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Fu=Array.isArray;function Jl(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+$a(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function $x(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(q(91));return bt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function X_(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(q(92));if(Fu(n)){if(1<n.length)throw Error(q(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:$a(n)}}function wj(t,e){var n=$a(e.value),r=$a(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Y_(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function _j(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function zx(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?_j(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var of,bj=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(of=of||document.createElement("div"),of.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=of.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function sd(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Uu={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qA=["Webkit","ms","Moz","O"];Object.keys(Uu).forEach(function(t){qA.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Uu[e]=Uu[t]})});function Sj(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Uu.hasOwnProperty(t)&&Uu[t]?(""+e).trim():e+"px"}function Ej(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=Sj(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var KA=bt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Bx(t,e){if(e){if(KA[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(q(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(q(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(q(61))}if(e.style!=null&&typeof e.style!="object")throw Error(q(62))}}function Vx(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ux=null;function Hv(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Hx=null,Zl=null,ec=null;function J_(t){if(t=Wd(t)){if(typeof Hx!="function")throw Error(q(280));var e=t.stateNode;e&&(e=Tp(e),Hx(t.stateNode,t.type,e))}}function jj(t){Zl?ec?ec.push(t):ec=[t]:Zl=t}function kj(){if(Zl){var t=Zl,e=ec;if(ec=Zl=null,J_(t),e)for(t=0;t<e.length;t++)J_(e[t])}}function Tj(t,e){return t(e)}function Ij(){}var v0=!1;function Cj(t,e,n){if(v0)return t(e,n);v0=!0;try{return Tj(t,e,n)}finally{v0=!1,(Zl!==null||ec!==null)&&(Ij(),kj())}}function id(t,e){var n=t.stateNode;if(n===null)return null;var r=Tp(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(q(231,e,typeof n));return n}var Gx=!1;if(Mi)try{var Su={};Object.defineProperty(Su,"passive",{get:function(){Gx=!0}}),window.addEventListener("test",Su,Su),window.removeEventListener("test",Su,Su)}catch{Gx=!1}function QA(t,e,n,r,s,i,o,l,c){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(d){this.onError(d)}}var Hu=!1,hm=null,fm=!1,Wx=null,XA={onError:function(t){Hu=!0,hm=t}};function YA(t,e,n,r,s,i,o,l,c){Hu=!1,hm=null,QA.apply(XA,arguments)}function JA(t,e,n,r,s,i,o,l,c){if(YA.apply(this,arguments),Hu){if(Hu){var u=hm;Hu=!1,hm=null}else throw Error(q(198));fm||(fm=!0,Wx=u)}}function sl(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Rj(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Z_(t){if(sl(t)!==t)throw Error(q(188))}function ZA(t){var e=t.alternate;if(!e){if(e=sl(t),e===null)throw Error(q(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return Z_(s),t;if(i===r)return Z_(s),e;i=i.sibling}throw Error(q(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o)throw Error(q(189))}}if(n.alternate!==r)throw Error(q(190))}if(n.tag!==3)throw Error(q(188));return n.stateNode.current===n?t:e}function Nj(t){return t=ZA(t),t!==null?Aj(t):null}function Aj(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Aj(t);if(e!==null)return e;t=t.sibling}return null}var Pj=Or.unstable_scheduleCallback,e2=Or.unstable_cancelCallback,e3=Or.unstable_shouldYield,t3=Or.unstable_requestPaint,At=Or.unstable_now,n3=Or.unstable_getCurrentPriorityLevel,Gv=Or.unstable_ImmediatePriority,Fj=Or.unstable_UserBlockingPriority,mm=Or.unstable_NormalPriority,r3=Or.unstable_LowPriority,Mj=Or.unstable_IdlePriority,Sp=null,Js=null;function s3(t){if(Js&&typeof Js.onCommitFiberRoot=="function")try{Js.onCommitFiberRoot(Sp,t,void 0,(t.current.flags&128)===128)}catch{}}var Is=Math.clz32?Math.clz32:o3,i3=Math.log,a3=Math.LN2;function o3(t){return t>>>=0,t===0?32:31-(i3(t)/a3|0)|0}var lf=64,cf=4194304;function Mu(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function pm(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var l=o&~s;l!==0?r=Mu(l):(i&=o,i!==0&&(r=Mu(i)))}else o=n&~s,o!==0?r=Mu(o):i!==0&&(r=Mu(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Is(e),s=1<<n,r|=t[n],e&=~s;return r}function l3(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function c3(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-Is(i),l=1<<o,c=s[o];c===-1?(!(l&n)||l&r)&&(s[o]=l3(l,e)):c<=e&&(t.expiredLanes|=l),i&=~l}}function qx(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Dj(){var t=lf;return lf<<=1,!(lf&4194240)&&(lf=64),t}function w0(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Hd(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Is(e),t[e]=n}function u3(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-Is(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function Wv(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Is(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var Qe=0;function Lj(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Oj,qv,$j,zj,Bj,Kx=!1,uf=[],ja=null,ka=null,Ta=null,ad=new Map,od=new Map,pa=[],d3="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function t2(t,e){switch(t){case"focusin":case"focusout":ja=null;break;case"dragenter":case"dragleave":ka=null;break;case"mouseover":case"mouseout":Ta=null;break;case"pointerover":case"pointerout":ad.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":od.delete(e.pointerId)}}function Eu(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=Wd(e),e!==null&&qv(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function h3(t,e,n,r,s){switch(e){case"focusin":return ja=Eu(ja,t,e,n,r,s),!0;case"dragenter":return ka=Eu(ka,t,e,n,r,s),!0;case"mouseover":return Ta=Eu(Ta,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return ad.set(i,Eu(ad.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,od.set(i,Eu(od.get(i)||null,t,e,n,r,s)),!0}return!1}function Vj(t){var e=Co(t.target);if(e!==null){var n=sl(e);if(n!==null){if(e=n.tag,e===13){if(e=Rj(n),e!==null){t.blockedOn=e,Bj(t.priority,function(){$j(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function $f(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Qx(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Ux=r,n.target.dispatchEvent(r),Ux=null}else return e=Wd(n),e!==null&&qv(e),t.blockedOn=n,!1;e.shift()}return!0}function n2(t,e,n){$f(t)&&n.delete(e)}function f3(){Kx=!1,ja!==null&&$f(ja)&&(ja=null),ka!==null&&$f(ka)&&(ka=null),Ta!==null&&$f(Ta)&&(Ta=null),ad.forEach(n2),od.forEach(n2)}function ju(t,e){t.blockedOn===e&&(t.blockedOn=null,Kx||(Kx=!0,Or.unstable_scheduleCallback(Or.unstable_NormalPriority,f3)))}function ld(t){function e(s){return ju(s,t)}if(0<uf.length){ju(uf[0],t);for(var n=1;n<uf.length;n++){var r=uf[n];r.blockedOn===t&&(r.blockedOn=null)}}for(ja!==null&&ju(ja,t),ka!==null&&ju(ka,t),Ta!==null&&ju(Ta,t),ad.forEach(e),od.forEach(e),n=0;n<pa.length;n++)r=pa[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<pa.length&&(n=pa[0],n.blockedOn===null);)Vj(n),n.blockedOn===null&&pa.shift()}var tc=Gi.ReactCurrentBatchConfig,gm=!0;function m3(t,e,n,r){var s=Qe,i=tc.transition;tc.transition=null;try{Qe=1,Kv(t,e,n,r)}finally{Qe=s,tc.transition=i}}function p3(t,e,n,r){var s=Qe,i=tc.transition;tc.transition=null;try{Qe=4,Kv(t,e,n,r)}finally{Qe=s,tc.transition=i}}function Kv(t,e,n,r){if(gm){var s=Qx(t,e,n,r);if(s===null)R0(t,e,r,xm,n),t2(t,r);else if(h3(s,t,e,n,r))r.stopPropagation();else if(t2(t,r),e&4&&-1<d3.indexOf(t)){for(;s!==null;){var i=Wd(s);if(i!==null&&Oj(i),i=Qx(t,e,n,r),i===null&&R0(t,e,r,xm,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else R0(t,e,r,null,n)}}var xm=null;function Qx(t,e,n,r){if(xm=null,t=Hv(r),t=Co(t),t!==null)if(e=sl(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Rj(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return xm=t,null}function Uj(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(n3()){case Gv:return 1;case Fj:return 4;case mm:case r3:return 16;case Mj:return 536870912;default:return 16}default:return 16}}var _a=null,Qv=null,zf=null;function Hj(){if(zf)return zf;var t,e=Qv,n=e.length,r,s="value"in _a?_a.value:_a.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return zf=s.slice(t,1<r?1-r:void 0)}function Bf(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function df(){return!0}function r2(){return!1}function Vr(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?df:r2,this.isPropagationStopped=r2,this}return bt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=df)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=df)},persist:function(){},isPersistent:df}),e}var Lc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Xv=Vr(Lc),Gd=bt({},Lc,{view:0,detail:0}),g3=Vr(Gd),_0,b0,ku,Ep=bt({},Gd,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Yv,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==ku&&(ku&&t.type==="mousemove"?(_0=t.screenX-ku.screenX,b0=t.screenY-ku.screenY):b0=_0=0,ku=t),_0)},movementY:function(t){return"movementY"in t?t.movementY:b0}}),s2=Vr(Ep),x3=bt({},Ep,{dataTransfer:0}),y3=Vr(x3),v3=bt({},Gd,{relatedTarget:0}),S0=Vr(v3),w3=bt({},Lc,{animationName:0,elapsedTime:0,pseudoElement:0}),_3=Vr(w3),b3=bt({},Lc,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),S3=Vr(b3),E3=bt({},Lc,{data:0}),i2=Vr(E3),j3={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},k3={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},T3={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function I3(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=T3[t])?!!e[t]:!1}function Yv(){return I3}var C3=bt({},Gd,{key:function(t){if(t.key){var e=j3[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Bf(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?k3[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Yv,charCode:function(t){return t.type==="keypress"?Bf(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Bf(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),R3=Vr(C3),N3=bt({},Ep,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),a2=Vr(N3),A3=bt({},Gd,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Yv}),P3=Vr(A3),F3=bt({},Lc,{propertyName:0,elapsedTime:0,pseudoElement:0}),M3=Vr(F3),D3=bt({},Ep,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),L3=Vr(D3),O3=[9,13,27,32],Jv=Mi&&"CompositionEvent"in window,Gu=null;Mi&&"documentMode"in document&&(Gu=document.documentMode);var $3=Mi&&"TextEvent"in window&&!Gu,Gj=Mi&&(!Jv||Gu&&8<Gu&&11>=Gu),o2=String.fromCharCode(32),l2=!1;function Wj(t,e){switch(t){case"keyup":return O3.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function qj(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var $l=!1;function z3(t,e){switch(t){case"compositionend":return qj(e);case"keypress":return e.which!==32?null:(l2=!0,o2);case"textInput":return t=e.data,t===o2&&l2?null:t;default:return null}}function B3(t,e){if($l)return t==="compositionend"||!Jv&&Wj(t,e)?(t=Hj(),zf=Qv=_a=null,$l=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Gj&&e.locale!=="ko"?null:e.data;default:return null}}var V3={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function c2(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!V3[t.type]:e==="textarea"}function Kj(t,e,n,r){jj(r),e=ym(e,"onChange"),0<e.length&&(n=new Xv("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Wu=null,cd=null;function U3(t){ik(t,0)}function jp(t){var e=Vl(t);if(yj(e))return t}function H3(t,e){if(t==="change")return e}var Qj=!1;if(Mi){var E0;if(Mi){var j0="oninput"in document;if(!j0){var u2=document.createElement("div");u2.setAttribute("oninput","return;"),j0=typeof u2.oninput=="function"}E0=j0}else E0=!1;Qj=E0&&(!document.documentMode||9<document.documentMode)}function d2(){Wu&&(Wu.detachEvent("onpropertychange",Xj),cd=Wu=null)}function Xj(t){if(t.propertyName==="value"&&jp(cd)){var e=[];Kj(e,cd,t,Hv(t)),Cj(U3,e)}}function G3(t,e,n){t==="focusin"?(d2(),Wu=e,cd=n,Wu.attachEvent("onpropertychange",Xj)):t==="focusout"&&d2()}function W3(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return jp(cd)}function q3(t,e){if(t==="click")return jp(e)}function K3(t,e){if(t==="input"||t==="change")return jp(e)}function Q3(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var As=typeof Object.is=="function"?Object.is:Q3;function ud(t,e){if(As(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Nx.call(e,s)||!As(t[s],e[s]))return!1}return!0}function h2(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function f2(t,e){var n=h2(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=h2(n)}}function Yj(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Yj(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Jj(){for(var t=window,e=dm();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=dm(t.document)}return e}function Zv(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function X3(t){var e=Jj(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&Yj(n.ownerDocument.documentElement,n)){if(r!==null&&Zv(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=f2(n,i);var o=f2(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Y3=Mi&&"documentMode"in document&&11>=document.documentMode,zl=null,Xx=null,qu=null,Yx=!1;function m2(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Yx||zl==null||zl!==dm(r)||(r=zl,"selectionStart"in r&&Zv(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),qu&&ud(qu,r)||(qu=r,r=ym(Xx,"onSelect"),0<r.length&&(e=new Xv("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=zl)))}function hf(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Bl={animationend:hf("Animation","AnimationEnd"),animationiteration:hf("Animation","AnimationIteration"),animationstart:hf("Animation","AnimationStart"),transitionend:hf("Transition","TransitionEnd")},k0={},Zj={};Mi&&(Zj=document.createElement("div").style,"AnimationEvent"in window||(delete Bl.animationend.animation,delete Bl.animationiteration.animation,delete Bl.animationstart.animation),"TransitionEvent"in window||delete Bl.transitionend.transition);function kp(t){if(k0[t])return k0[t];if(!Bl[t])return t;var e=Bl[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Zj)return k0[t]=e[n];return t}var ek=kp("animationend"),tk=kp("animationiteration"),nk=kp("animationstart"),rk=kp("transitionend"),sk=new Map,p2="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function qa(t,e){sk.set(t,e),rl(e,[t])}for(var T0=0;T0<p2.length;T0++){var I0=p2[T0],J3=I0.toLowerCase(),Z3=I0[0].toUpperCase()+I0.slice(1);qa(J3,"on"+Z3)}qa(ek,"onAnimationEnd");qa(tk,"onAnimationIteration");qa(nk,"onAnimationStart");qa("dblclick","onDoubleClick");qa("focusin","onFocus");qa("focusout","onBlur");qa(rk,"onTransitionEnd");uc("onMouseEnter",["mouseout","mouseover"]);uc("onMouseLeave",["mouseout","mouseover"]);uc("onPointerEnter",["pointerout","pointerover"]);uc("onPointerLeave",["pointerout","pointerover"]);rl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));rl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));rl("onBeforeInput",["compositionend","keypress","textInput","paste"]);rl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));rl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));rl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Du="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),eP=new Set("cancel close invalid load scroll toggle".split(" ").concat(Du));function g2(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,JA(r,e,void 0,t),t.currentTarget=null}function ik(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var l=r[o],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==i&&s.isPropagationStopped())break e;g2(s,l,u),i=c}else for(o=0;o<r.length;o++){if(l=r[o],c=l.instance,u=l.currentTarget,l=l.listener,c!==i&&s.isPropagationStopped())break e;g2(s,l,u),i=c}}}if(fm)throw t=Wx,fm=!1,Wx=null,t}function ut(t,e){var n=e[ny];n===void 0&&(n=e[ny]=new Set);var r=t+"__bubble";n.has(r)||(ak(e,t,2,!1),n.add(r))}function C0(t,e,n){var r=0;e&&(r|=4),ak(n,t,r,e)}var ff="_reactListening"+Math.random().toString(36).slice(2);function dd(t){if(!t[ff]){t[ff]=!0,fj.forEach(function(n){n!=="selectionchange"&&(eP.has(n)||C0(n,!1,t),C0(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[ff]||(e[ff]=!0,C0("selectionchange",!1,e))}}function ak(t,e,n,r){switch(Uj(e)){case 1:var s=m3;break;case 4:s=p3;break;default:s=Kv}n=s.bind(null,e,n,t),s=void 0,!Gx||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function R0(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;o=o.return}for(;l!==null;){if(o=Co(l),o===null)return;if(c=o.tag,c===5||c===6){r=i=o;continue e}l=l.parentNode}}r=r.return}Cj(function(){var u=i,d=Hv(n),f=[];e:{var p=sk.get(t);if(p!==void 0){var g=Xv,x=t;switch(t){case"keypress":if(Bf(n)===0)break e;case"keydown":case"keyup":g=R3;break;case"focusin":x="focus",g=S0;break;case"focusout":x="blur",g=S0;break;case"beforeblur":case"afterblur":g=S0;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=s2;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=y3;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=P3;break;case ek:case tk:case nk:g=_3;break;case rk:g=M3;break;case"scroll":g=g3;break;case"wheel":g=L3;break;case"copy":case"cut":case"paste":g=S3;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=a2}var w=(e&4)!==0,v=!w&&t==="scroll",_=w?p!==null?p+"Capture":null:p;w=[];for(var b=u,j;b!==null;){j=b;var T=j.stateNode;if(j.tag===5&&T!==null&&(j=T,_!==null&&(T=id(b,_),T!=null&&w.push(hd(b,T,j)))),v)break;b=b.return}0<w.length&&(p=new g(p,x,null,n,d),f.push({event:p,listeners:w}))}}if(!(e&7)){e:{if(p=t==="mouseover"||t==="pointerover",g=t==="mouseout"||t==="pointerout",p&&n!==Ux&&(x=n.relatedTarget||n.fromElement)&&(Co(x)||x[Di]))break e;if((g||p)&&(p=d.window===d?d:(p=d.ownerDocument)?p.defaultView||p.parentWindow:window,g?(x=n.relatedTarget||n.toElement,g=u,x=x?Co(x):null,x!==null&&(v=sl(x),x!==v||x.tag!==5&&x.tag!==6)&&(x=null)):(g=null,x=u),g!==x)){if(w=s2,T="onMouseLeave",_="onMouseEnter",b="mouse",(t==="pointerout"||t==="pointerover")&&(w=a2,T="onPointerLeave",_="onPointerEnter",b="pointer"),v=g==null?p:Vl(g),j=x==null?p:Vl(x),p=new w(T,b+"leave",g,n,d),p.target=v,p.relatedTarget=j,T=null,Co(d)===u&&(w=new w(_,b+"enter",x,n,d),w.target=j,w.relatedTarget=v,T=w),v=T,g&&x)t:{for(w=g,_=x,b=0,j=w;j;j=Il(j))b++;for(j=0,T=_;T;T=Il(T))j++;for(;0<b-j;)w=Il(w),b--;for(;0<j-b;)_=Il(_),j--;for(;b--;){if(w===_||_!==null&&w===_.alternate)break t;w=Il(w),_=Il(_)}w=null}else w=null;g!==null&&x2(f,p,g,w,!1),x!==null&&v!==null&&x2(f,v,x,w,!0)}}e:{if(p=u?Vl(u):window,g=p.nodeName&&p.nodeName.toLowerCase(),g==="select"||g==="input"&&p.type==="file")var R=H3;else if(c2(p))if(Qj)R=K3;else{R=W3;var M=G3}else(g=p.nodeName)&&g.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(R=q3);if(R&&(R=R(t,u))){Kj(f,R,n,d);break e}M&&M(t,p,u),t==="focusout"&&(M=p._wrapperState)&&M.controlled&&p.type==="number"&&Ox(p,"number",p.value)}switch(M=u?Vl(u):window,t){case"focusin":(c2(M)||M.contentEditable==="true")&&(zl=M,Xx=u,qu=null);break;case"focusout":qu=Xx=zl=null;break;case"mousedown":Yx=!0;break;case"contextmenu":case"mouseup":case"dragend":Yx=!1,m2(f,n,d);break;case"selectionchange":if(Y3)break;case"keydown":case"keyup":m2(f,n,d)}var k;if(Jv)e:{switch(t){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else $l?Wj(t,n)&&(E="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(E="onCompositionStart");E&&(Gj&&n.locale!=="ko"&&($l||E!=="onCompositionStart"?E==="onCompositionEnd"&&$l&&(k=Hj()):(_a=d,Qv="value"in _a?_a.value:_a.textContent,$l=!0)),M=ym(u,E),0<M.length&&(E=new i2(E,t,null,n,d),f.push({event:E,listeners:M}),k?E.data=k:(k=qj(n),k!==null&&(E.data=k)))),(k=$3?z3(t,n):B3(t,n))&&(u=ym(u,"onBeforeInput"),0<u.length&&(d=new i2("onBeforeInput","beforeinput",null,n,d),f.push({event:d,listeners:u}),d.data=k))}ik(f,e)})}function hd(t,e,n){return{instance:t,listener:e,currentTarget:n}}function ym(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=id(t,n),i!=null&&r.unshift(hd(t,i,s)),i=id(t,e),i!=null&&r.push(hd(t,i,s))),t=t.return}return r}function Il(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function x2(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var l=n,c=l.alternate,u=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&u!==null&&(l=u,s?(c=id(n,i),c!=null&&o.unshift(hd(n,c,l))):s||(c=id(n,i),c!=null&&o.push(hd(n,c,l)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var tP=/\r\n?/g,nP=/\u0000|\uFFFD/g;function y2(t){return(typeof t=="string"?t:""+t).replace(tP,`
`).replace(nP,"")}function mf(t,e,n){if(e=y2(e),y2(t)!==e&&n)throw Error(q(425))}function vm(){}var Jx=null,Zx=null;function ey(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var ty=typeof setTimeout=="function"?setTimeout:void 0,rP=typeof clearTimeout=="function"?clearTimeout:void 0,v2=typeof Promise=="function"?Promise:void 0,sP=typeof queueMicrotask=="function"?queueMicrotask:typeof v2<"u"?function(t){return v2.resolve(null).then(t).catch(iP)}:ty;function iP(t){setTimeout(function(){throw t})}function N0(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),ld(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);ld(e)}function Ia(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function w2(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Oc=Math.random().toString(36).slice(2),Qs="__reactFiber$"+Oc,fd="__reactProps$"+Oc,Di="__reactContainer$"+Oc,ny="__reactEvents$"+Oc,aP="__reactListeners$"+Oc,oP="__reactHandles$"+Oc;function Co(t){var e=t[Qs];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Di]||n[Qs]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=w2(t);t!==null;){if(n=t[Qs])return n;t=w2(t)}return e}t=n,n=t.parentNode}return null}function Wd(t){return t=t[Qs]||t[Di],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Vl(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(q(33))}function Tp(t){return t[fd]||null}var ry=[],Ul=-1;function Ka(t){return{current:t}}function dt(t){0>Ul||(t.current=ry[Ul],ry[Ul]=null,Ul--)}function at(t,e){Ul++,ry[Ul]=t.current,t.current=e}var za={},Hn=Ka(za),xr=Ka(!1),$o=za;function dc(t,e){var n=t.type.contextTypes;if(!n)return za;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function yr(t){return t=t.childContextTypes,t!=null}function wm(){dt(xr),dt(Hn)}function _2(t,e,n){if(Hn.current!==za)throw Error(q(168));at(Hn,e),at(xr,n)}function ok(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(q(108,GA(t)||"Unknown",s));return bt({},n,r)}function _m(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||za,$o=Hn.current,at(Hn,t),at(xr,xr.current),!0}function b2(t,e,n){var r=t.stateNode;if(!r)throw Error(q(169));n?(t=ok(t,e,$o),r.__reactInternalMemoizedMergedChildContext=t,dt(xr),dt(Hn),at(Hn,t)):dt(xr),at(xr,n)}var _i=null,Ip=!1,A0=!1;function lk(t){_i===null?_i=[t]:_i.push(t)}function lP(t){Ip=!0,lk(t)}function Qa(){if(!A0&&_i!==null){A0=!0;var t=0,e=Qe;try{var n=_i;for(Qe=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}_i=null,Ip=!1}catch(s){throw _i!==null&&(_i=_i.slice(t+1)),Pj(Gv,Qa),s}finally{Qe=e,A0=!1}}return null}var Hl=[],Gl=0,bm=null,Sm=0,Yr=[],Jr=0,zo=null,Si=1,Ei="";function So(t,e){Hl[Gl++]=Sm,Hl[Gl++]=bm,bm=t,Sm=e}function ck(t,e,n){Yr[Jr++]=Si,Yr[Jr++]=Ei,Yr[Jr++]=zo,zo=t;var r=Si;t=Ei;var s=32-Is(r)-1;r&=~(1<<s),n+=1;var i=32-Is(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,Si=1<<32-Is(e)+s|n<<s|r,Ei=i+t}else Si=1<<i|n<<s|r,Ei=t}function e1(t){t.return!==null&&(So(t,1),ck(t,1,0))}function t1(t){for(;t===bm;)bm=Hl[--Gl],Hl[Gl]=null,Sm=Hl[--Gl],Hl[Gl]=null;for(;t===zo;)zo=Yr[--Jr],Yr[Jr]=null,Ei=Yr[--Jr],Yr[Jr]=null,Si=Yr[--Jr],Yr[Jr]=null}var Mr=null,Ar=null,mt=!1,Es=null;function uk(t,e){var n=Zr(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function S2(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Mr=t,Ar=Ia(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Mr=t,Ar=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=zo!==null?{id:Si,overflow:Ei}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Zr(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Mr=t,Ar=null,!0):!1;default:return!1}}function sy(t){return(t.mode&1)!==0&&(t.flags&128)===0}function iy(t){if(mt){var e=Ar;if(e){var n=e;if(!S2(t,e)){if(sy(t))throw Error(q(418));e=Ia(n.nextSibling);var r=Mr;e&&S2(t,e)?uk(r,n):(t.flags=t.flags&-4097|2,mt=!1,Mr=t)}}else{if(sy(t))throw Error(q(418));t.flags=t.flags&-4097|2,mt=!1,Mr=t}}}function E2(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Mr=t}function pf(t){if(t!==Mr)return!1;if(!mt)return E2(t),mt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!ey(t.type,t.memoizedProps)),e&&(e=Ar)){if(sy(t))throw dk(),Error(q(418));for(;e;)uk(t,e),e=Ia(e.nextSibling)}if(E2(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(q(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Ar=Ia(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Ar=null}}else Ar=Mr?Ia(t.stateNode.nextSibling):null;return!0}function dk(){for(var t=Ar;t;)t=Ia(t.nextSibling)}function hc(){Ar=Mr=null,mt=!1}function n1(t){Es===null?Es=[t]:Es.push(t)}var cP=Gi.ReactCurrentBatchConfig;function bs(t,e){if(t&&t.defaultProps){e=bt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var Em=Ka(null),jm=null,Wl=null,r1=null;function s1(){r1=Wl=jm=null}function i1(t){var e=Em.current;dt(Em),t._currentValue=e}function ay(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function nc(t,e){jm=t,r1=Wl=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(gr=!0),t.firstContext=null)}function ts(t){var e=t._currentValue;if(r1!==t)if(t={context:t,memoizedValue:e,next:null},Wl===null){if(jm===null)throw Error(q(308));Wl=t,jm.dependencies={lanes:0,firstContext:t}}else Wl=Wl.next=t;return e}var Ro=null;function a1(t){Ro===null?Ro=[t]:Ro.push(t)}function hk(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,a1(e)):(n.next=s.next,s.next=n),e.interleaved=n,Li(t,r)}function Li(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var ma=!1;function o1(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function fk(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Ri(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Ca(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Ue&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,Li(t,n)}return s=r.interleaved,s===null?(e.next=e,a1(r)):(e.next=s.next,s.next=e),r.interleaved=e,Li(t,n)}function Vf(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Wv(t,n)}}function j2(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function km(t,e,n,r){var s=t.updateQueue;ma=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,u=c.next;c.next=null,o===null?i=u:o.next=u,o=c;var d=t.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==o&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(i!==null){var f=s.baseState;o=0,d=u=c=null,l=i;do{var p=l.lane,g=l.eventTime;if((r&p)===p){d!==null&&(d=d.next={eventTime:g,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var x=t,w=l;switch(p=e,g=n,w.tag){case 1:if(x=w.payload,typeof x=="function"){f=x.call(g,f,p);break e}f=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=w.payload,p=typeof x=="function"?x.call(g,f,p):x,p==null)break e;f=bt({},f,p);break e;case 2:ma=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,p=s.effects,p===null?s.effects=[l]:p.push(l))}else g={eventTime:g,lane:p,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=g,c=f):d=d.next=g,o|=p;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;p=l,l=p.next,p.next=null,s.lastBaseUpdate=p,s.shared.pending=null}}while(1);if(d===null&&(c=f),s.baseState=c,s.firstBaseUpdate=u,s.lastBaseUpdate=d,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);Vo|=o,t.lanes=o,t.memoizedState=f}}function k2(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(q(191,s));s.call(r)}}}var mk=new hj.Component().refs;function oy(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:bt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Cp={isMounted:function(t){return(t=t._reactInternals)?sl(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Yn(),s=Na(t),i=Ri(r,s);i.payload=e,n!=null&&(i.callback=n),e=Ca(t,i,s),e!==null&&(Cs(e,t,s,r),Vf(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Yn(),s=Na(t),i=Ri(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=Ca(t,i,s),e!==null&&(Cs(e,t,s,r),Vf(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Yn(),r=Na(t),s=Ri(n,r);s.tag=2,e!=null&&(s.callback=e),e=Ca(t,s,r),e!==null&&(Cs(e,t,r,n),Vf(e,t,r))}};function T2(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!ud(n,r)||!ud(s,i):!0}function pk(t,e,n){var r=!1,s=za,i=e.contextType;return typeof i=="object"&&i!==null?i=ts(i):(s=yr(e)?$o:Hn.current,r=e.contextTypes,i=(r=r!=null)?dc(t,s):za),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Cp,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function I2(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Cp.enqueueReplaceState(e,e.state,null)}function ly(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs=mk,o1(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=ts(i):(i=yr(e)?$o:Hn.current,s.context=dc(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(oy(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Cp.enqueueReplaceState(s,s.state,null),km(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function Tu(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(q(309));var r=n.stateNode}if(!r)throw Error(q(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var l=s.refs;l===mk&&(l=s.refs={}),o===null?delete l[i]:l[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(q(284));if(!n._owner)throw Error(q(290,t))}return t}function gf(t,e){throw t=Object.prototype.toString.call(e),Error(q(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function C2(t){var e=t._init;return e(t._payload)}function gk(t){function e(_,b){if(t){var j=_.deletions;j===null?(_.deletions=[b],_.flags|=16):j.push(b)}}function n(_,b){if(!t)return null;for(;b!==null;)e(_,b),b=b.sibling;return null}function r(_,b){for(_=new Map;b!==null;)b.key!==null?_.set(b.key,b):_.set(b.index,b),b=b.sibling;return _}function s(_,b){return _=Aa(_,b),_.index=0,_.sibling=null,_}function i(_,b,j){return _.index=j,t?(j=_.alternate,j!==null?(j=j.index,j<b?(_.flags|=2,b):j):(_.flags|=2,b)):(_.flags|=1048576,b)}function o(_){return t&&_.alternate===null&&(_.flags|=2),_}function l(_,b,j,T){return b===null||b.tag!==6?(b=$0(j,_.mode,T),b.return=_,b):(b=s(b,j),b.return=_,b)}function c(_,b,j,T){var R=j.type;return R===Ol?d(_,b,j.props.children,T,j.key):b!==null&&(b.elementType===R||typeof R=="object"&&R!==null&&R.$$typeof===fa&&C2(R)===b.type)?(T=s(b,j.props),T.ref=Tu(_,b,j),T.return=_,T):(T=Kf(j.type,j.key,j.props,null,_.mode,T),T.ref=Tu(_,b,j),T.return=_,T)}function u(_,b,j,T){return b===null||b.tag!==4||b.stateNode.containerInfo!==j.containerInfo||b.stateNode.implementation!==j.implementation?(b=z0(j,_.mode,T),b.return=_,b):(b=s(b,j.children||[]),b.return=_,b)}function d(_,b,j,T,R){return b===null||b.tag!==7?(b=Do(j,_.mode,T,R),b.return=_,b):(b=s(b,j),b.return=_,b)}function f(_,b,j){if(typeof b=="string"&&b!==""||typeof b=="number")return b=$0(""+b,_.mode,j),b.return=_,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case sf:return j=Kf(b.type,b.key,b.props,null,_.mode,j),j.ref=Tu(_,null,b),j.return=_,j;case Ll:return b=z0(b,_.mode,j),b.return=_,b;case fa:var T=b._init;return f(_,T(b._payload),j)}if(Fu(b)||bu(b))return b=Do(b,_.mode,j,null),b.return=_,b;gf(_,b)}return null}function p(_,b,j,T){var R=b!==null?b.key:null;if(typeof j=="string"&&j!==""||typeof j=="number")return R!==null?null:l(_,b,""+j,T);if(typeof j=="object"&&j!==null){switch(j.$$typeof){case sf:return j.key===R?c(_,b,j,T):null;case Ll:return j.key===R?u(_,b,j,T):null;case fa:return R=j._init,p(_,b,R(j._payload),T)}if(Fu(j)||bu(j))return R!==null?null:d(_,b,j,T,null);gf(_,j)}return null}function g(_,b,j,T,R){if(typeof T=="string"&&T!==""||typeof T=="number")return _=_.get(j)||null,l(b,_,""+T,R);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case sf:return _=_.get(T.key===null?j:T.key)||null,c(b,_,T,R);case Ll:return _=_.get(T.key===null?j:T.key)||null,u(b,_,T,R);case fa:var M=T._init;return g(_,b,j,M(T._payload),R)}if(Fu(T)||bu(T))return _=_.get(j)||null,d(b,_,T,R,null);gf(b,T)}return null}function x(_,b,j,T){for(var R=null,M=null,k=b,E=b=0,I=null;k!==null&&E<j.length;E++){k.index>E?(I=k,k=null):I=k.sibling;var C=p(_,k,j[E],T);if(C===null){k===null&&(k=I);break}t&&k&&C.alternate===null&&e(_,k),b=i(C,b,E),M===null?R=C:M.sibling=C,M=C,k=I}if(E===j.length)return n(_,k),mt&&So(_,E),R;if(k===null){for(;E<j.length;E++)k=f(_,j[E],T),k!==null&&(b=i(k,b,E),M===null?R=k:M.sibling=k,M=k);return mt&&So(_,E),R}for(k=r(_,k);E<j.length;E++)I=g(k,_,E,j[E],T),I!==null&&(t&&I.alternate!==null&&k.delete(I.key===null?E:I.key),b=i(I,b,E),M===null?R=I:M.sibling=I,M=I);return t&&k.forEach(function(A){return e(_,A)}),mt&&So(_,E),R}function w(_,b,j,T){var R=bu(j);if(typeof R!="function")throw Error(q(150));if(j=R.call(j),j==null)throw Error(q(151));for(var M=R=null,k=b,E=b=0,I=null,C=j.next();k!==null&&!C.done;E++,C=j.next()){k.index>E?(I=k,k=null):I=k.sibling;var A=p(_,k,C.value,T);if(A===null){k===null&&(k=I);break}t&&k&&A.alternate===null&&e(_,k),b=i(A,b,E),M===null?R=A:M.sibling=A,M=A,k=I}if(C.done)return n(_,k),mt&&So(_,E),R;if(k===null){for(;!C.done;E++,C=j.next())C=f(_,C.value,T),C!==null&&(b=i(C,b,E),M===null?R=C:M.sibling=C,M=C);return mt&&So(_,E),R}for(k=r(_,k);!C.done;E++,C=j.next())C=g(k,_,E,C.value,T),C!==null&&(t&&C.alternate!==null&&k.delete(C.key===null?E:C.key),b=i(C,b,E),M===null?R=C:M.sibling=C,M=C);return t&&k.forEach(function(D){return e(_,D)}),mt&&So(_,E),R}function v(_,b,j,T){if(typeof j=="object"&&j!==null&&j.type===Ol&&j.key===null&&(j=j.props.children),typeof j=="object"&&j!==null){switch(j.$$typeof){case sf:e:{for(var R=j.key,M=b;M!==null;){if(M.key===R){if(R=j.type,R===Ol){if(M.tag===7){n(_,M.sibling),b=s(M,j.props.children),b.return=_,_=b;break e}}else if(M.elementType===R||typeof R=="object"&&R!==null&&R.$$typeof===fa&&C2(R)===M.type){n(_,M.sibling),b=s(M,j.props),b.ref=Tu(_,M,j),b.return=_,_=b;break e}n(_,M);break}else e(_,M);M=M.sibling}j.type===Ol?(b=Do(j.props.children,_.mode,T,j.key),b.return=_,_=b):(T=Kf(j.type,j.key,j.props,null,_.mode,T),T.ref=Tu(_,b,j),T.return=_,_=T)}return o(_);case Ll:e:{for(M=j.key;b!==null;){if(b.key===M)if(b.tag===4&&b.stateNode.containerInfo===j.containerInfo&&b.stateNode.implementation===j.implementation){n(_,b.sibling),b=s(b,j.children||[]),b.return=_,_=b;break e}else{n(_,b);break}else e(_,b);b=b.sibling}b=z0(j,_.mode,T),b.return=_,_=b}return o(_);case fa:return M=j._init,v(_,b,M(j._payload),T)}if(Fu(j))return x(_,b,j,T);if(bu(j))return w(_,b,j,T);gf(_,j)}return typeof j=="string"&&j!==""||typeof j=="number"?(j=""+j,b!==null&&b.tag===6?(n(_,b.sibling),b=s(b,j),b.return=_,_=b):(n(_,b),b=$0(j,_.mode,T),b.return=_,_=b),o(_)):n(_,b)}return v}var fc=gk(!0),xk=gk(!1),qd={},Zs=Ka(qd),md=Ka(qd),pd=Ka(qd);function No(t){if(t===qd)throw Error(q(174));return t}function l1(t,e){switch(at(pd,e),at(md,t),at(Zs,qd),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:zx(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=zx(e,t)}dt(Zs),at(Zs,e)}function mc(){dt(Zs),dt(md),dt(pd)}function yk(t){No(pd.current);var e=No(Zs.current),n=zx(e,t.type);e!==n&&(at(md,t),at(Zs,n))}function c1(t){md.current===t&&(dt(Zs),dt(md))}var wt=Ka(0);function Tm(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var P0=[];function u1(){for(var t=0;t<P0.length;t++)P0[t]._workInProgressVersionPrimary=null;P0.length=0}var Uf=Gi.ReactCurrentDispatcher,F0=Gi.ReactCurrentBatchConfig,Bo=0,_t=null,Yt=null,on=null,Im=!1,Ku=!1,gd=0,uP=0;function Mn(){throw Error(q(321))}function d1(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!As(t[n],e[n]))return!1;return!0}function h1(t,e,n,r,s,i){if(Bo=i,_t=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Uf.current=t===null||t.memoizedState===null?mP:pP,t=n(r,s),Ku){i=0;do{if(Ku=!1,gd=0,25<=i)throw Error(q(301));i+=1,on=Yt=null,e.updateQueue=null,Uf.current=gP,t=n(r,s)}while(Ku)}if(Uf.current=Cm,e=Yt!==null&&Yt.next!==null,Bo=0,on=Yt=_t=null,Im=!1,e)throw Error(q(300));return t}function f1(){var t=gd!==0;return gd=0,t}function qs(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return on===null?_t.memoizedState=on=t:on=on.next=t,on}function ns(){if(Yt===null){var t=_t.alternate;t=t!==null?t.memoizedState:null}else t=Yt.next;var e=on===null?_t.memoizedState:on.next;if(e!==null)on=e,Yt=t;else{if(t===null)throw Error(q(310));Yt=t,t={memoizedState:Yt.memoizedState,baseState:Yt.baseState,baseQueue:Yt.baseQueue,queue:Yt.queue,next:null},on===null?_t.memoizedState=on=t:on=on.next=t}return on}function xd(t,e){return typeof e=="function"?e(t):e}function M0(t){var e=ns(),n=e.queue;if(n===null)throw Error(q(311));n.lastRenderedReducer=t;var r=Yt,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=o=null,c=null,u=i;do{var d=u.lane;if((Bo&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var f={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=f,o=r):c=c.next=f,_t.lanes|=d,Vo|=d}u=u.next}while(u!==null&&u!==i);c===null?o=r:c.next=l,As(r,e.memoizedState)||(gr=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=c,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,_t.lanes|=i,Vo|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function D0(t){var e=ns(),n=e.queue;if(n===null)throw Error(q(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);As(i,e.memoizedState)||(gr=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function vk(){}function wk(t,e){var n=_t,r=ns(),s=e(),i=!As(r.memoizedState,s);if(i&&(r.memoizedState=s,gr=!0),r=r.queue,m1(Sk.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||on!==null&&on.memoizedState.tag&1){if(n.flags|=2048,yd(9,bk.bind(null,n,r,s,e),void 0,null),cn===null)throw Error(q(349));Bo&30||_k(n,e,s)}return s}function _k(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=_t.updateQueue,e===null?(e={lastEffect:null,stores:null},_t.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function bk(t,e,n,r){e.value=n,e.getSnapshot=r,Ek(e)&&jk(t)}function Sk(t,e,n){return n(function(){Ek(e)&&jk(t)})}function Ek(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!As(t,n)}catch{return!0}}function jk(t){var e=Li(t,1);e!==null&&Cs(e,t,1,-1)}function R2(t){var e=qs();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:xd,lastRenderedState:t},e.queue=t,t=t.dispatch=fP.bind(null,_t,t),[e.memoizedState,t]}function yd(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=_t.updateQueue,e===null?(e={lastEffect:null,stores:null},_t.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function kk(){return ns().memoizedState}function Hf(t,e,n,r){var s=qs();_t.flags|=t,s.memoizedState=yd(1|e,n,void 0,r===void 0?null:r)}function Rp(t,e,n,r){var s=ns();r=r===void 0?null:r;var i=void 0;if(Yt!==null){var o=Yt.memoizedState;if(i=o.destroy,r!==null&&d1(r,o.deps)){s.memoizedState=yd(e,n,i,r);return}}_t.flags|=t,s.memoizedState=yd(1|e,n,i,r)}function N2(t,e){return Hf(8390656,8,t,e)}function m1(t,e){return Rp(2048,8,t,e)}function Tk(t,e){return Rp(4,2,t,e)}function Ik(t,e){return Rp(4,4,t,e)}function Ck(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Rk(t,e,n){return n=n!=null?n.concat([t]):null,Rp(4,4,Ck.bind(null,e,t),n)}function p1(){}function Nk(t,e){var n=ns();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&d1(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function Ak(t,e){var n=ns();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&d1(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Pk(t,e,n){return Bo&21?(As(n,e)||(n=Dj(),_t.lanes|=n,Vo|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,gr=!0),t.memoizedState=n)}function dP(t,e){var n=Qe;Qe=n!==0&&4>n?n:4,t(!0);var r=F0.transition;F0.transition={};try{t(!1),e()}finally{Qe=n,F0.transition=r}}function Fk(){return ns().memoizedState}function hP(t,e,n){var r=Na(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Mk(t))Dk(e,n);else if(n=hk(t,e,n,r),n!==null){var s=Yn();Cs(n,t,r,s),Lk(n,e,r)}}function fP(t,e,n){var r=Na(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Mk(t))Dk(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,l=i(o,n);if(s.hasEagerState=!0,s.eagerState=l,As(l,o)){var c=e.interleaved;c===null?(s.next=s,a1(e)):(s.next=c.next,c.next=s),e.interleaved=s;return}}catch{}finally{}n=hk(t,e,s,r),n!==null&&(s=Yn(),Cs(n,t,r,s),Lk(n,e,r))}}function Mk(t){var e=t.alternate;return t===_t||e!==null&&e===_t}function Dk(t,e){Ku=Im=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function Lk(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Wv(t,n)}}var Cm={readContext:ts,useCallback:Mn,useContext:Mn,useEffect:Mn,useImperativeHandle:Mn,useInsertionEffect:Mn,useLayoutEffect:Mn,useMemo:Mn,useReducer:Mn,useRef:Mn,useState:Mn,useDebugValue:Mn,useDeferredValue:Mn,useTransition:Mn,useMutableSource:Mn,useSyncExternalStore:Mn,useId:Mn,unstable_isNewReconciler:!1},mP={readContext:ts,useCallback:function(t,e){return qs().memoizedState=[t,e===void 0?null:e],t},useContext:ts,useEffect:N2,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Hf(4194308,4,Ck.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Hf(4194308,4,t,e)},useInsertionEffect:function(t,e){return Hf(4,2,t,e)},useMemo:function(t,e){var n=qs();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=qs();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=hP.bind(null,_t,t),[r.memoizedState,t]},useRef:function(t){var e=qs();return t={current:t},e.memoizedState=t},useState:R2,useDebugValue:p1,useDeferredValue:function(t){return qs().memoizedState=t},useTransition:function(){var t=R2(!1),e=t[0];return t=dP.bind(null,t[1]),qs().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=_t,s=qs();if(mt){if(n===void 0)throw Error(q(407));n=n()}else{if(n=e(),cn===null)throw Error(q(349));Bo&30||_k(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,N2(Sk.bind(null,r,i,t),[t]),r.flags|=2048,yd(9,bk.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=qs(),e=cn.identifierPrefix;if(mt){var n=Ei,r=Si;n=(r&~(1<<32-Is(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=gd++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=uP++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},pP={readContext:ts,useCallback:Nk,useContext:ts,useEffect:m1,useImperativeHandle:Rk,useInsertionEffect:Tk,useLayoutEffect:Ik,useMemo:Ak,useReducer:M0,useRef:kk,useState:function(){return M0(xd)},useDebugValue:p1,useDeferredValue:function(t){var e=ns();return Pk(e,Yt.memoizedState,t)},useTransition:function(){var t=M0(xd)[0],e=ns().memoizedState;return[t,e]},useMutableSource:vk,useSyncExternalStore:wk,useId:Fk,unstable_isNewReconciler:!1},gP={readContext:ts,useCallback:Nk,useContext:ts,useEffect:m1,useImperativeHandle:Rk,useInsertionEffect:Tk,useLayoutEffect:Ik,useMemo:Ak,useReducer:D0,useRef:kk,useState:function(){return D0(xd)},useDebugValue:p1,useDeferredValue:function(t){var e=ns();return Yt===null?e.memoizedState=t:Pk(e,Yt.memoizedState,t)},useTransition:function(){var t=D0(xd)[0],e=ns().memoizedState;return[t,e]},useMutableSource:vk,useSyncExternalStore:wk,useId:Fk,unstable_isNewReconciler:!1};function pc(t,e){try{var n="",r=e;do n+=HA(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function L0(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function cy(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var xP=typeof WeakMap=="function"?WeakMap:Map;function Ok(t,e,n){n=Ri(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Nm||(Nm=!0,vy=r),cy(t,e)},n}function $k(t,e,n){n=Ri(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){cy(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){cy(t,e),typeof r!="function"&&(Ra===null?Ra=new Set([this]):Ra.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function A2(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new xP;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=NP.bind(null,t,e,n),e.then(t,t))}function P2(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function F2(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Ri(-1,1),e.tag=2,Ca(n,e,1))),n.lanes|=1),t)}var yP=Gi.ReactCurrentOwner,gr=!1;function Qn(t,e,n,r){e.child=t===null?xk(e,null,n,r):fc(e,t.child,n,r)}function M2(t,e,n,r,s){n=n.render;var i=e.ref;return nc(e,s),r=h1(t,e,n,r,i,s),n=f1(),t!==null&&!gr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Oi(t,e,s)):(mt&&n&&e1(e),e.flags|=1,Qn(t,e,r,s),e.child)}function D2(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!S1(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,zk(t,e,i,r,s)):(t=Kf(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:ud,n(o,r)&&t.ref===e.ref)return Oi(t,e,s)}return e.flags|=1,t=Aa(i,r),t.ref=e.ref,t.return=e,e.child=t}function zk(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(ud(i,r)&&t.ref===e.ref)if(gr=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(gr=!0);else return e.lanes=t.lanes,Oi(t,e,s)}return uy(t,e,n,r,s)}function Bk(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},at(Kl,Cr),Cr|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,at(Kl,Cr),Cr|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,at(Kl,Cr),Cr|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,at(Kl,Cr),Cr|=r;return Qn(t,e,s,n),e.child}function Vk(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function uy(t,e,n,r,s){var i=yr(n)?$o:Hn.current;return i=dc(e,i),nc(e,s),n=h1(t,e,n,r,i,s),r=f1(),t!==null&&!gr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Oi(t,e,s)):(mt&&r&&e1(e),e.flags|=1,Qn(t,e,n,s),e.child)}function L2(t,e,n,r,s){if(yr(n)){var i=!0;_m(e)}else i=!1;if(nc(e,s),e.stateNode===null)Gf(t,e),pk(e,n,r),ly(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var c=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=ts(u):(u=yr(n)?$o:Hn.current,u=dc(e,u));var d=n.getDerivedStateFromProps,f=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||c!==u)&&I2(e,o,r,u),ma=!1;var p=e.memoizedState;o.state=p,km(e,r,o,s),c=e.memoizedState,l!==r||p!==c||xr.current||ma?(typeof d=="function"&&(oy(e,n,d,r),c=e.memoizedState),(l=ma||T2(e,n,l,r,p,c,u))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),o.props=r,o.state=c,o.context=u,r=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,fk(t,e),l=e.memoizedProps,u=e.type===e.elementType?l:bs(e.type,l),o.props=u,f=e.pendingProps,p=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=ts(c):(c=yr(n)?$o:Hn.current,c=dc(e,c));var g=n.getDerivedStateFromProps;(d=typeof g=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==f||p!==c)&&I2(e,o,r,c),ma=!1,p=e.memoizedState,o.state=p,km(e,r,o,s);var x=e.memoizedState;l!==f||p!==x||xr.current||ma?(typeof g=="function"&&(oy(e,n,g,r),x=e.memoizedState),(u=ma||T2(e,n,u,r,p,x,c)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,x,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,x,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=x),o.props=r,o.state=x,o.context=c,r=u):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),r=!1)}return dy(t,e,n,r,i,s)}function dy(t,e,n,r,s,i){Vk(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&b2(e,n,!1),Oi(t,e,i);r=e.stateNode,yP.current=e;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=fc(e,t.child,null,i),e.child=fc(e,null,l,i)):Qn(t,e,l,i),e.memoizedState=r.state,s&&b2(e,n,!0),e.child}function Uk(t){var e=t.stateNode;e.pendingContext?_2(t,e.pendingContext,e.pendingContext!==e.context):e.context&&_2(t,e.context,!1),l1(t,e.containerInfo)}function O2(t,e,n,r,s){return hc(),n1(s),e.flags|=256,Qn(t,e,n,r),e.child}var hy={dehydrated:null,treeContext:null,retryLane:0};function fy(t){return{baseLanes:t,cachePool:null,transitions:null}}function Hk(t,e,n){var r=e.pendingProps,s=wt.current,i=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),at(wt,s&1),t===null)return iy(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Pp(o,r,0,null),t=Do(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=fy(n),e.memoizedState=hy,t):g1(e,o));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return vP(t,e,o,r,l,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,l=s.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=Aa(s,c),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=Aa(l,i):(i=Do(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?fy(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=hy,r}return i=t.child,t=i.sibling,r=Aa(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function g1(t,e){return e=Pp({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function xf(t,e,n,r){return r!==null&&n1(r),fc(e,t.child,null,n),t=g1(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function vP(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=L0(Error(q(422))),xf(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=Pp({mode:"visible",children:r.children},s,0,null),i=Do(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&fc(e,t.child,null,o),e.child.memoizedState=fy(o),e.memoizedState=hy,i);if(!(e.mode&1))return xf(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(q(419)),r=L0(i,r,void 0),xf(t,e,o,r)}if(l=(o&t.childLanes)!==0,gr||l){if(r=cn,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,Li(t,s),Cs(r,t,s,-1))}return b1(),r=L0(Error(q(421))),xf(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=AP.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,Ar=Ia(s.nextSibling),Mr=e,mt=!0,Es=null,t!==null&&(Yr[Jr++]=Si,Yr[Jr++]=Ei,Yr[Jr++]=zo,Si=t.id,Ei=t.overflow,zo=e),e=g1(e,r.children),e.flags|=4096,e)}function $2(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),ay(t.return,e,n)}function O0(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function Gk(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(Qn(t,e,r.children,n),r=wt.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&$2(t,n,e);else if(t.tag===19)$2(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(at(wt,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&Tm(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),O0(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&Tm(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}O0(e,!0,n,null,i);break;case"together":O0(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Gf(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Oi(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Vo|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(q(153));if(e.child!==null){for(t=e.child,n=Aa(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Aa(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function wP(t,e,n){switch(e.tag){case 3:Uk(e),hc();break;case 5:yk(e);break;case 1:yr(e.type)&&_m(e);break;case 4:l1(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;at(Em,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(at(wt,wt.current&1),e.flags|=128,null):n&e.child.childLanes?Hk(t,e,n):(at(wt,wt.current&1),t=Oi(t,e,n),t!==null?t.sibling:null);at(wt,wt.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return Gk(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),at(wt,wt.current),r)break;return null;case 22:case 23:return e.lanes=0,Bk(t,e,n)}return Oi(t,e,n)}var Wk,my,qk,Kk;Wk=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};my=function(){};qk=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,No(Zs.current);var i=null;switch(n){case"input":s=Dx(t,s),r=Dx(t,r),i=[];break;case"select":s=bt({},s,{value:void 0}),r=bt({},r,{value:void 0}),i=[];break;case"textarea":s=$x(t,s),r=$x(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=vm)}Bx(n,r);var o;n=null;for(u in s)if(!r.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var l=s[u];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(rd.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in r){var c=r[u];if(l=s!=null?s[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(i||(i=[]),i.push(u,n)),n=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(rd.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&ut("scroll",t),i||l===c||(i=[])):(i=i||[]).push(u,c))}n&&(i=i||[]).push("style",n);var u=i;(e.updateQueue=u)&&(e.flags|=4)}};Kk=function(t,e,n,r){n!==r&&(e.flags|=4)};function Iu(t,e){if(!mt)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Dn(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function _P(t,e,n){var r=e.pendingProps;switch(t1(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Dn(e),null;case 1:return yr(e.type)&&wm(),Dn(e),null;case 3:return r=e.stateNode,mc(),dt(xr),dt(Hn),u1(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(pf(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Es!==null&&(by(Es),Es=null))),my(t,e),Dn(e),null;case 5:c1(e);var s=No(pd.current);if(n=e.type,t!==null&&e.stateNode!=null)qk(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(q(166));return Dn(e),null}if(t=No(Zs.current),pf(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[Qs]=e,r[fd]=i,t=(e.mode&1)!==0,n){case"dialog":ut("cancel",r),ut("close",r);break;case"iframe":case"object":case"embed":ut("load",r);break;case"video":case"audio":for(s=0;s<Du.length;s++)ut(Du[s],r);break;case"source":ut("error",r);break;case"img":case"image":case"link":ut("error",r),ut("load",r);break;case"details":ut("toggle",r);break;case"input":K_(r,i),ut("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},ut("invalid",r);break;case"textarea":X_(r,i),ut("invalid",r)}Bx(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&mf(r.textContent,l,t),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&mf(r.textContent,l,t),s=["children",""+l]):rd.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&ut("scroll",r)}switch(n){case"input":af(r),Q_(r,i,!0);break;case"textarea":af(r),Y_(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=vm)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=_j(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Qs]=e,t[fd]=r,Wk(t,e,!1,!1),e.stateNode=t;e:{switch(o=Vx(n,r),n){case"dialog":ut("cancel",t),ut("close",t),s=r;break;case"iframe":case"object":case"embed":ut("load",t),s=r;break;case"video":case"audio":for(s=0;s<Du.length;s++)ut(Du[s],t);s=r;break;case"source":ut("error",t),s=r;break;case"img":case"image":case"link":ut("error",t),ut("load",t),s=r;break;case"details":ut("toggle",t),s=r;break;case"input":K_(t,r),s=Dx(t,r),ut("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=bt({},r,{value:void 0}),ut("invalid",t);break;case"textarea":X_(t,r),s=$x(t,r),ut("invalid",t);break;default:s=r}Bx(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?Ej(t,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&bj(t,c)):i==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&sd(t,c):typeof c=="number"&&sd(t,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(rd.hasOwnProperty(i)?c!=null&&i==="onScroll"&&ut("scroll",t):c!=null&&zv(t,i,c,o))}switch(n){case"input":af(t),Q_(t,r,!1);break;case"textarea":af(t),Y_(t);break;case"option":r.value!=null&&t.setAttribute("value",""+$a(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?Jl(t,!!r.multiple,i,!1):r.defaultValue!=null&&Jl(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=vm)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Dn(e),null;case 6:if(t&&e.stateNode!=null)Kk(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(q(166));if(n=No(pd.current),No(Zs.current),pf(e)){if(r=e.stateNode,n=e.memoizedProps,r[Qs]=e,(i=r.nodeValue!==n)&&(t=Mr,t!==null))switch(t.tag){case 3:mf(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&mf(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Qs]=e,e.stateNode=r}return Dn(e),null;case 13:if(dt(wt),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(mt&&Ar!==null&&e.mode&1&&!(e.flags&128))dk(),hc(),e.flags|=98560,i=!1;else if(i=pf(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(q(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(q(317));i[Qs]=e}else hc(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Dn(e),i=!1}else Es!==null&&(by(Es),Es=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||wt.current&1?Jt===0&&(Jt=3):b1())),e.updateQueue!==null&&(e.flags|=4),Dn(e),null);case 4:return mc(),my(t,e),t===null&&dd(e.stateNode.containerInfo),Dn(e),null;case 10:return i1(e.type._context),Dn(e),null;case 17:return yr(e.type)&&wm(),Dn(e),null;case 19:if(dt(wt),i=e.memoizedState,i===null)return Dn(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)Iu(i,!1);else{if(Jt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Tm(t),o!==null){for(e.flags|=128,Iu(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return at(wt,wt.current&1|2),e.child}t=t.sibling}i.tail!==null&&At()>gc&&(e.flags|=128,r=!0,Iu(i,!1),e.lanes=4194304)}else{if(!r)if(t=Tm(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Iu(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!mt)return Dn(e),null}else 2*At()-i.renderingStartTime>gc&&n!==1073741824&&(e.flags|=128,r=!0,Iu(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=At(),e.sibling=null,n=wt.current,at(wt,r?n&1|2:n&1),e):(Dn(e),null);case 22:case 23:return _1(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Cr&1073741824&&(Dn(e),e.subtreeFlags&6&&(e.flags|=8192)):Dn(e),null;case 24:return null;case 25:return null}throw Error(q(156,e.tag))}function bP(t,e){switch(t1(e),e.tag){case 1:return yr(e.type)&&wm(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return mc(),dt(xr),dt(Hn),u1(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return c1(e),null;case 13:if(dt(wt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(q(340));hc()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return dt(wt),null;case 4:return mc(),null;case 10:return i1(e.type._context),null;case 22:case 23:return _1(),null;case 24:return null;default:return null}}var yf=!1,zn=!1,SP=typeof WeakSet=="function"?WeakSet:Set,te=null;function ql(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Et(t,e,r)}else n.current=null}function py(t,e,n){try{n()}catch(r){Et(t,e,r)}}var z2=!1;function EP(t,e){if(Jx=gm,t=Jj(),Zv(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,l=-1,c=-1,u=0,d=0,f=t,p=null;t:for(;;){for(var g;f!==n||s!==0&&f.nodeType!==3||(l=o+s),f!==i||r!==0&&f.nodeType!==3||(c=o+r),f.nodeType===3&&(o+=f.nodeValue.length),(g=f.firstChild)!==null;)p=f,f=g;for(;;){if(f===t)break t;if(p===n&&++u===s&&(l=o),p===i&&++d===r&&(c=o),(g=f.nextSibling)!==null)break;f=p,p=f.parentNode}f=g}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(Zx={focusedElem:t,selectionRange:n},gm=!1,te=e;te!==null;)if(e=te,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,te=t;else for(;te!==null;){e=te;try{var x=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var w=x.memoizedProps,v=x.memoizedState,_=e.stateNode,b=_.getSnapshotBeforeUpdate(e.elementType===e.type?w:bs(e.type,w),v);_.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var j=e.stateNode.containerInfo;j.nodeType===1?j.textContent="":j.nodeType===9&&j.documentElement&&j.removeChild(j.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(q(163))}}catch(T){Et(e,e.return,T)}if(t=e.sibling,t!==null){t.return=e.return,te=t;break}te=e.return}return x=z2,z2=!1,x}function Qu(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&py(e,n,i)}s=s.next}while(s!==r)}}function Np(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function gy(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function Qk(t){var e=t.alternate;e!==null&&(t.alternate=null,Qk(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Qs],delete e[fd],delete e[ny],delete e[aP],delete e[oP])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Xk(t){return t.tag===5||t.tag===3||t.tag===4}function B2(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Xk(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function xy(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=vm));else if(r!==4&&(t=t.child,t!==null))for(xy(t,e,n),t=t.sibling;t!==null;)xy(t,e,n),t=t.sibling}function yy(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(yy(t,e,n),t=t.sibling;t!==null;)yy(t,e,n),t=t.sibling}var vn=null,Ss=!1;function ua(t,e,n){for(n=n.child;n!==null;)Yk(t,e,n),n=n.sibling}function Yk(t,e,n){if(Js&&typeof Js.onCommitFiberUnmount=="function")try{Js.onCommitFiberUnmount(Sp,n)}catch{}switch(n.tag){case 5:zn||ql(n,e);case 6:var r=vn,s=Ss;vn=null,ua(t,e,n),vn=r,Ss=s,vn!==null&&(Ss?(t=vn,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):vn.removeChild(n.stateNode));break;case 18:vn!==null&&(Ss?(t=vn,n=n.stateNode,t.nodeType===8?N0(t.parentNode,n):t.nodeType===1&&N0(t,n),ld(t)):N0(vn,n.stateNode));break;case 4:r=vn,s=Ss,vn=n.stateNode.containerInfo,Ss=!0,ua(t,e,n),vn=r,Ss=s;break;case 0:case 11:case 14:case 15:if(!zn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&py(n,e,o),s=s.next}while(s!==r)}ua(t,e,n);break;case 1:if(!zn&&(ql(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){Et(n,e,l)}ua(t,e,n);break;case 21:ua(t,e,n);break;case 22:n.mode&1?(zn=(r=zn)||n.memoizedState!==null,ua(t,e,n),zn=r):ua(t,e,n);break;default:ua(t,e,n)}}function V2(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new SP),e.forEach(function(r){var s=PP.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function vs(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:vn=l.stateNode,Ss=!1;break e;case 3:vn=l.stateNode.containerInfo,Ss=!0;break e;case 4:vn=l.stateNode.containerInfo,Ss=!0;break e}l=l.return}if(vn===null)throw Error(q(160));Yk(i,o,s),vn=null,Ss=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(u){Et(s,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Jk(e,t),e=e.sibling}function Jk(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(vs(e,t),Us(t),r&4){try{Qu(3,t,t.return),Np(3,t)}catch(w){Et(t,t.return,w)}try{Qu(5,t,t.return)}catch(w){Et(t,t.return,w)}}break;case 1:vs(e,t),Us(t),r&512&&n!==null&&ql(n,n.return);break;case 5:if(vs(e,t),Us(t),r&512&&n!==null&&ql(n,n.return),t.flags&32){var s=t.stateNode;try{sd(s,"")}catch(w){Et(t,t.return,w)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&vj(s,i),Vx(l,o);var u=Vx(l,i);for(o=0;o<c.length;o+=2){var d=c[o],f=c[o+1];d==="style"?Ej(s,f):d==="dangerouslySetInnerHTML"?bj(s,f):d==="children"?sd(s,f):zv(s,d,f,u)}switch(l){case"input":Lx(s,i);break;case"textarea":wj(s,i);break;case"select":var p=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var g=i.value;g!=null?Jl(s,!!i.multiple,g,!1):p!==!!i.multiple&&(i.defaultValue!=null?Jl(s,!!i.multiple,i.defaultValue,!0):Jl(s,!!i.multiple,i.multiple?[]:"",!1))}s[fd]=i}catch(w){Et(t,t.return,w)}}break;case 6:if(vs(e,t),Us(t),r&4){if(t.stateNode===null)throw Error(q(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(w){Et(t,t.return,w)}}break;case 3:if(vs(e,t),Us(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{ld(e.containerInfo)}catch(w){Et(t,t.return,w)}break;case 4:vs(e,t),Us(t);break;case 13:vs(e,t),Us(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(v1=At())),r&4&&V2(t);break;case 22:if(d=n!==null&&n.memoizedState!==null,t.mode&1?(zn=(u=zn)||d,vs(e,t),zn=u):vs(e,t),Us(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!d&&t.mode&1)for(te=t,d=t.child;d!==null;){for(f=te=d;te!==null;){switch(p=te,g=p.child,p.tag){case 0:case 11:case 14:case 15:Qu(4,p,p.return);break;case 1:ql(p,p.return);var x=p.stateNode;if(typeof x.componentWillUnmount=="function"){r=p,n=p.return;try{e=r,x.props=e.memoizedProps,x.state=e.memoizedState,x.componentWillUnmount()}catch(w){Et(r,n,w)}}break;case 5:ql(p,p.return);break;case 22:if(p.memoizedState!==null){H2(f);continue}}g!==null?(g.return=p,te=g):H2(f)}d=d.sibling}e:for(d=null,f=t;;){if(f.tag===5){if(d===null){d=f;try{s=f.stateNode,u?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=f.stateNode,c=f.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=Sj("display",o))}catch(w){Et(t,t.return,w)}}}else if(f.tag===6){if(d===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(w){Et(t,t.return,w)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:vs(e,t),Us(t),r&4&&V2(t);break;case 21:break;default:vs(e,t),Us(t)}}function Us(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(Xk(n)){var r=n;break e}n=n.return}throw Error(q(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(sd(s,""),r.flags&=-33);var i=B2(t);yy(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,l=B2(t);xy(t,l,o);break;default:throw Error(q(161))}}catch(c){Et(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function jP(t,e,n){te=t,Zk(t)}function Zk(t,e,n){for(var r=(t.mode&1)!==0;te!==null;){var s=te,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||yf;if(!o){var l=s.alternate,c=l!==null&&l.memoizedState!==null||zn;l=yf;var u=zn;if(yf=o,(zn=c)&&!u)for(te=s;te!==null;)o=te,c=o.child,o.tag===22&&o.memoizedState!==null?G2(s):c!==null?(c.return=o,te=c):G2(s);for(;i!==null;)te=i,Zk(i),i=i.sibling;te=s,yf=l,zn=u}U2(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,te=i):U2(t)}}function U2(t){for(;te!==null;){var e=te;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:zn||Np(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!zn)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:bs(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&k2(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}k2(e,o,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var f=d.dehydrated;f!==null&&ld(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(q(163))}zn||e.flags&512&&gy(e)}catch(p){Et(e,e.return,p)}}if(e===t){te=null;break}if(n=e.sibling,n!==null){n.return=e.return,te=n;break}te=e.return}}function H2(t){for(;te!==null;){var e=te;if(e===t){te=null;break}var n=e.sibling;if(n!==null){n.return=e.return,te=n;break}te=e.return}}function G2(t){for(;te!==null;){var e=te;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Np(4,e)}catch(c){Et(e,n,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(c){Et(e,s,c)}}var i=e.return;try{gy(e)}catch(c){Et(e,i,c)}break;case 5:var o=e.return;try{gy(e)}catch(c){Et(e,o,c)}}}catch(c){Et(e,e.return,c)}if(e===t){te=null;break}var l=e.sibling;if(l!==null){l.return=e.return,te=l;break}te=e.return}}var kP=Math.ceil,Rm=Gi.ReactCurrentDispatcher,x1=Gi.ReactCurrentOwner,es=Gi.ReactCurrentBatchConfig,Ue=0,cn=null,$t=null,Sn=0,Cr=0,Kl=Ka(0),Jt=0,vd=null,Vo=0,Ap=0,y1=0,Xu=null,mr=null,v1=0,gc=1/0,vi=null,Nm=!1,vy=null,Ra=null,vf=!1,ba=null,Am=0,Yu=0,wy=null,Wf=-1,qf=0;function Yn(){return Ue&6?At():Wf!==-1?Wf:Wf=At()}function Na(t){return t.mode&1?Ue&2&&Sn!==0?Sn&-Sn:cP.transition!==null?(qf===0&&(qf=Dj()),qf):(t=Qe,t!==0||(t=window.event,t=t===void 0?16:Uj(t.type)),t):1}function Cs(t,e,n,r){if(50<Yu)throw Yu=0,wy=null,Error(q(185));Hd(t,n,r),(!(Ue&2)||t!==cn)&&(t===cn&&(!(Ue&2)&&(Ap|=n),Jt===4&&ga(t,Sn)),vr(t,r),n===1&&Ue===0&&!(e.mode&1)&&(gc=At()+500,Ip&&Qa()))}function vr(t,e){var n=t.callbackNode;c3(t,e);var r=pm(t,t===cn?Sn:0);if(r===0)n!==null&&e2(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&e2(n),e===1)t.tag===0?lP(W2.bind(null,t)):lk(W2.bind(null,t)),sP(function(){!(Ue&6)&&Qa()}),n=null;else{switch(Lj(r)){case 1:n=Gv;break;case 4:n=Fj;break;case 16:n=mm;break;case 536870912:n=Mj;break;default:n=mm}n=oT(n,eT.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function eT(t,e){if(Wf=-1,qf=0,Ue&6)throw Error(q(327));var n=t.callbackNode;if(rc()&&t.callbackNode!==n)return null;var r=pm(t,t===cn?Sn:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Pm(t,r);else{e=r;var s=Ue;Ue|=2;var i=nT();(cn!==t||Sn!==e)&&(vi=null,gc=At()+500,Mo(t,e));do try{CP();break}catch(l){tT(t,l)}while(1);s1(),Rm.current=i,Ue=s,$t!==null?e=0:(cn=null,Sn=0,e=Jt)}if(e!==0){if(e===2&&(s=qx(t),s!==0&&(r=s,e=_y(t,s))),e===1)throw n=vd,Mo(t,0),ga(t,r),vr(t,At()),n;if(e===6)ga(t,r);else{if(s=t.current.alternate,!(r&30)&&!TP(s)&&(e=Pm(t,r),e===2&&(i=qx(t),i!==0&&(r=i,e=_y(t,i))),e===1))throw n=vd,Mo(t,0),ga(t,r),vr(t,At()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(q(345));case 2:Eo(t,mr,vi);break;case 3:if(ga(t,r),(r&130023424)===r&&(e=v1+500-At(),10<e)){if(pm(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){Yn(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=ty(Eo.bind(null,t,mr,vi),e);break}Eo(t,mr,vi);break;case 4:if(ga(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-Is(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=At()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*kP(r/1960))-r,10<r){t.timeoutHandle=ty(Eo.bind(null,t,mr,vi),r);break}Eo(t,mr,vi);break;case 5:Eo(t,mr,vi);break;default:throw Error(q(329))}}}return vr(t,At()),t.callbackNode===n?eT.bind(null,t):null}function _y(t,e){var n=Xu;return t.current.memoizedState.isDehydrated&&(Mo(t,e).flags|=256),t=Pm(t,e),t!==2&&(e=mr,mr=n,e!==null&&by(e)),t}function by(t){mr===null?mr=t:mr.push.apply(mr,t)}function TP(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!As(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ga(t,e){for(e&=~y1,e&=~Ap,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Is(e),r=1<<n;t[n]=-1,e&=~r}}function W2(t){if(Ue&6)throw Error(q(327));rc();var e=pm(t,0);if(!(e&1))return vr(t,At()),null;var n=Pm(t,e);if(t.tag!==0&&n===2){var r=qx(t);r!==0&&(e=r,n=_y(t,r))}if(n===1)throw n=vd,Mo(t,0),ga(t,e),vr(t,At()),n;if(n===6)throw Error(q(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Eo(t,mr,vi),vr(t,At()),null}function w1(t,e){var n=Ue;Ue|=1;try{return t(e)}finally{Ue=n,Ue===0&&(gc=At()+500,Ip&&Qa())}}function Uo(t){ba!==null&&ba.tag===0&&!(Ue&6)&&rc();var e=Ue;Ue|=1;var n=es.transition,r=Qe;try{if(es.transition=null,Qe=1,t)return t()}finally{Qe=r,es.transition=n,Ue=e,!(Ue&6)&&Qa()}}function _1(){Cr=Kl.current,dt(Kl)}function Mo(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,rP(n)),$t!==null)for(n=$t.return;n!==null;){var r=n;switch(t1(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&wm();break;case 3:mc(),dt(xr),dt(Hn),u1();break;case 5:c1(r);break;case 4:mc();break;case 13:dt(wt);break;case 19:dt(wt);break;case 10:i1(r.type._context);break;case 22:case 23:_1()}n=n.return}if(cn=t,$t=t=Aa(t.current,null),Sn=Cr=e,Jt=0,vd=null,y1=Ap=Vo=0,mr=Xu=null,Ro!==null){for(e=0;e<Ro.length;e++)if(n=Ro[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}Ro=null}return t}function tT(t,e){do{var n=$t;try{if(s1(),Uf.current=Cm,Im){for(var r=_t.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Im=!1}if(Bo=0,on=Yt=_t=null,Ku=!1,gd=0,x1.current=null,n===null||n.return===null){Jt=1,vd=e,$t=null;break}e:{var i=t,o=n.return,l=n,c=e;if(e=Sn,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=l,f=d.tag;if(!(d.mode&1)&&(f===0||f===11||f===15)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var g=P2(o);if(g!==null){g.flags&=-257,F2(g,o,l,i,e),g.mode&1&&A2(i,u,e),e=g,c=u;var x=e.updateQueue;if(x===null){var w=new Set;w.add(c),e.updateQueue=w}else x.add(c);break e}else{if(!(e&1)){A2(i,u,e),b1();break e}c=Error(q(426))}}else if(mt&&l.mode&1){var v=P2(o);if(v!==null){!(v.flags&65536)&&(v.flags|=256),F2(v,o,l,i,e),n1(pc(c,l));break e}}i=c=pc(c,l),Jt!==4&&(Jt=2),Xu===null?Xu=[i]:Xu.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var _=Ok(i,c,e);j2(i,_);break e;case 1:l=c;var b=i.type,j=i.stateNode;if(!(i.flags&128)&&(typeof b.getDerivedStateFromError=="function"||j!==null&&typeof j.componentDidCatch=="function"&&(Ra===null||!Ra.has(j)))){i.flags|=65536,e&=-e,i.lanes|=e;var T=$k(i,l,e);j2(i,T);break e}}i=i.return}while(i!==null)}sT(n)}catch(R){e=R,$t===n&&n!==null&&($t=n=n.return);continue}break}while(1)}function nT(){var t=Rm.current;return Rm.current=Cm,t===null?Cm:t}function b1(){(Jt===0||Jt===3||Jt===2)&&(Jt=4),cn===null||!(Vo&268435455)&&!(Ap&268435455)||ga(cn,Sn)}function Pm(t,e){var n=Ue;Ue|=2;var r=nT();(cn!==t||Sn!==e)&&(vi=null,Mo(t,e));do try{IP();break}catch(s){tT(t,s)}while(1);if(s1(),Ue=n,Rm.current=r,$t!==null)throw Error(q(261));return cn=null,Sn=0,Jt}function IP(){for(;$t!==null;)rT($t)}function CP(){for(;$t!==null&&!e3();)rT($t)}function rT(t){var e=aT(t.alternate,t,Cr);t.memoizedProps=t.pendingProps,e===null?sT(t):$t=e,x1.current=null}function sT(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=bP(n,e),n!==null){n.flags&=32767,$t=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Jt=6,$t=null;return}}else if(n=_P(n,e,Cr),n!==null){$t=n;return}if(e=e.sibling,e!==null){$t=e;return}$t=e=t}while(e!==null);Jt===0&&(Jt=5)}function Eo(t,e,n){var r=Qe,s=es.transition;try{es.transition=null,Qe=1,RP(t,e,n,r)}finally{es.transition=s,Qe=r}return null}function RP(t,e,n,r){do rc();while(ba!==null);if(Ue&6)throw Error(q(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(q(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(u3(t,i),t===cn&&($t=cn=null,Sn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||vf||(vf=!0,oT(mm,function(){return rc(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=es.transition,es.transition=null;var o=Qe;Qe=1;var l=Ue;Ue|=4,x1.current=null,EP(t,n),Jk(n,t),X3(Zx),gm=!!Jx,Zx=Jx=null,t.current=n,jP(n),t3(),Ue=l,Qe=o,es.transition=i}else t.current=n;if(vf&&(vf=!1,ba=t,Am=s),i=t.pendingLanes,i===0&&(Ra=null),s3(n.stateNode),vr(t,At()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Nm)throw Nm=!1,t=vy,vy=null,t;return Am&1&&t.tag!==0&&rc(),i=t.pendingLanes,i&1?t===wy?Yu++:(Yu=0,wy=t):Yu=0,Qa(),null}function rc(){if(ba!==null){var t=Lj(Am),e=es.transition,n=Qe;try{if(es.transition=null,Qe=16>t?16:t,ba===null)var r=!1;else{if(t=ba,ba=null,Am=0,Ue&6)throw Error(q(331));var s=Ue;for(Ue|=4,te=t.current;te!==null;){var i=te,o=i.child;if(te.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(te=u;te!==null;){var d=te;switch(d.tag){case 0:case 11:case 15:Qu(8,d,i)}var f=d.child;if(f!==null)f.return=d,te=f;else for(;te!==null;){d=te;var p=d.sibling,g=d.return;if(Qk(d),d===u){te=null;break}if(p!==null){p.return=g,te=p;break}te=g}}}var x=i.alternate;if(x!==null){var w=x.child;if(w!==null){x.child=null;do{var v=w.sibling;w.sibling=null,w=v}while(w!==null)}}te=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,te=o;else e:for(;te!==null;){if(i=te,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Qu(9,i,i.return)}var _=i.sibling;if(_!==null){_.return=i.return,te=_;break e}te=i.return}}var b=t.current;for(te=b;te!==null;){o=te;var j=o.child;if(o.subtreeFlags&2064&&j!==null)j.return=o,te=j;else e:for(o=b;te!==null;){if(l=te,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Np(9,l)}}catch(R){Et(l,l.return,R)}if(l===o){te=null;break e}var T=l.sibling;if(T!==null){T.return=l.return,te=T;break e}te=l.return}}if(Ue=s,Qa(),Js&&typeof Js.onPostCommitFiberRoot=="function")try{Js.onPostCommitFiberRoot(Sp,t)}catch{}r=!0}return r}finally{Qe=n,es.transition=e}}return!1}function q2(t,e,n){e=pc(n,e),e=Ok(t,e,1),t=Ca(t,e,1),e=Yn(),t!==null&&(Hd(t,1,e),vr(t,e))}function Et(t,e,n){if(t.tag===3)q2(t,t,n);else for(;e!==null;){if(e.tag===3){q2(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Ra===null||!Ra.has(r))){t=pc(n,t),t=$k(e,t,1),e=Ca(e,t,1),t=Yn(),e!==null&&(Hd(e,1,t),vr(e,t));break}}e=e.return}}function NP(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Yn(),t.pingedLanes|=t.suspendedLanes&n,cn===t&&(Sn&n)===n&&(Jt===4||Jt===3&&(Sn&130023424)===Sn&&500>At()-v1?Mo(t,0):y1|=n),vr(t,e)}function iT(t,e){e===0&&(t.mode&1?(e=cf,cf<<=1,!(cf&130023424)&&(cf=4194304)):e=1);var n=Yn();t=Li(t,e),t!==null&&(Hd(t,e,n),vr(t,n))}function AP(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),iT(t,n)}function PP(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(q(314))}r!==null&&r.delete(e),iT(t,n)}var aT;aT=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||xr.current)gr=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return gr=!1,wP(t,e,n);gr=!!(t.flags&131072)}else gr=!1,mt&&e.flags&1048576&&ck(e,Sm,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Gf(t,e),t=e.pendingProps;var s=dc(e,Hn.current);nc(e,n),s=h1(null,e,r,t,s,n);var i=f1();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,yr(r)?(i=!0,_m(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,o1(e),s.updater=Cp,e.stateNode=s,s._reactInternals=e,ly(e,r,t,n),e=dy(null,e,r,!0,i,n)):(e.tag=0,mt&&i&&e1(e),Qn(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Gf(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=MP(r),t=bs(r,t),s){case 0:e=uy(null,e,r,t,n);break e;case 1:e=L2(null,e,r,t,n);break e;case 11:e=M2(null,e,r,t,n);break e;case 14:e=D2(null,e,r,bs(r.type,t),n);break e}throw Error(q(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:bs(r,s),uy(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:bs(r,s),L2(t,e,r,s,n);case 3:e:{if(Uk(e),t===null)throw Error(q(387));r=e.pendingProps,i=e.memoizedState,s=i.element,fk(t,e),km(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=pc(Error(q(423)),e),e=O2(t,e,r,n,s);break e}else if(r!==s){s=pc(Error(q(424)),e),e=O2(t,e,r,n,s);break e}else for(Ar=Ia(e.stateNode.containerInfo.firstChild),Mr=e,mt=!0,Es=null,n=xk(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(hc(),r===s){e=Oi(t,e,n);break e}Qn(t,e,r,n)}e=e.child}return e;case 5:return yk(e),t===null&&iy(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,ey(r,s)?o=null:i!==null&&ey(r,i)&&(e.flags|=32),Vk(t,e),Qn(t,e,o,n),e.child;case 6:return t===null&&iy(e),null;case 13:return Hk(t,e,n);case 4:return l1(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=fc(e,null,r,n):Qn(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:bs(r,s),M2(t,e,r,s,n);case 7:return Qn(t,e,e.pendingProps,n),e.child;case 8:return Qn(t,e,e.pendingProps.children,n),e.child;case 12:return Qn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,at(Em,r._currentValue),r._currentValue=o,i!==null)if(As(i.value,o)){if(i.children===s.children&&!xr.current){e=Oi(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(i.tag===1){c=Ri(-1,n&-n),c.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}i.lanes|=n,c=i.alternate,c!==null&&(c.lanes|=n),ay(i.return,n,e),l.lanes|=n;break}c=c.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(q(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),ay(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Qn(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,nc(e,n),s=ts(s),r=r(s),e.flags|=1,Qn(t,e,r,n),e.child;case 14:return r=e.type,s=bs(r,e.pendingProps),s=bs(r.type,s),D2(t,e,r,s,n);case 15:return zk(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:bs(r,s),Gf(t,e),e.tag=1,yr(r)?(t=!0,_m(e)):t=!1,nc(e,n),pk(e,r,s),ly(e,r,s,n),dy(null,e,r,!0,t,n);case 19:return Gk(t,e,n);case 22:return Bk(t,e,n)}throw Error(q(156,e.tag))};function oT(t,e){return Pj(t,e)}function FP(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Zr(t,e,n,r){return new FP(t,e,n,r)}function S1(t){return t=t.prototype,!(!t||!t.isReactComponent)}function MP(t){if(typeof t=="function")return S1(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Vv)return 11;if(t===Uv)return 14}return 2}function Aa(t,e){var n=t.alternate;return n===null?(n=Zr(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Kf(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")S1(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Ol:return Do(n.children,s,i,e);case Bv:o=8,s|=8;break;case Ax:return t=Zr(12,n,e,s|2),t.elementType=Ax,t.lanes=i,t;case Px:return t=Zr(13,n,e,s),t.elementType=Px,t.lanes=i,t;case Fx:return t=Zr(19,n,e,s),t.elementType=Fx,t.lanes=i,t;case gj:return Pp(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case mj:o=10;break e;case pj:o=9;break e;case Vv:o=11;break e;case Uv:o=14;break e;case fa:o=16,r=null;break e}throw Error(q(130,t==null?t:typeof t,""))}return e=Zr(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function Do(t,e,n,r){return t=Zr(7,t,r,e),t.lanes=n,t}function Pp(t,e,n,r){return t=Zr(22,t,r,e),t.elementType=gj,t.lanes=n,t.stateNode={isHidden:!1},t}function $0(t,e,n){return t=Zr(6,t,null,e),t.lanes=n,t}function z0(t,e,n){return e=Zr(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function DP(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=w0(0),this.expirationTimes=w0(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=w0(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function E1(t,e,n,r,s,i,o,l,c){return t=new DP(t,e,n,l,c),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Zr(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},o1(i),t}function LP(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ll,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function lT(t){if(!t)return za;t=t._reactInternals;e:{if(sl(t)!==t||t.tag!==1)throw Error(q(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(yr(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(q(171))}if(t.tag===1){var n=t.type;if(yr(n))return ok(t,n,e)}return e}function cT(t,e,n,r,s,i,o,l,c){return t=E1(n,r,!0,t,s,i,o,l,c),t.context=lT(null),n=t.current,r=Yn(),s=Na(n),i=Ri(r,s),i.callback=e??null,Ca(n,i,s),t.current.lanes=s,Hd(t,s,r),vr(t,r),t}function Fp(t,e,n,r){var s=e.current,i=Yn(),o=Na(s);return n=lT(n),e.context===null?e.context=n:e.pendingContext=n,e=Ri(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Ca(s,e,o),t!==null&&(Cs(t,s,o,i),Vf(t,s,o)),o}function Fm(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function K2(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function j1(t,e){K2(t,e),(t=t.alternate)&&K2(t,e)}function OP(){return null}var uT=typeof reportError=="function"?reportError:function(t){console.error(t)};function k1(t){this._internalRoot=t}Mp.prototype.render=k1.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(q(409));Fp(t,e,null,null)};Mp.prototype.unmount=k1.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Uo(function(){Fp(null,t,null,null)}),e[Di]=null}};function Mp(t){this._internalRoot=t}Mp.prototype.unstable_scheduleHydration=function(t){if(t){var e=zj();t={blockedOn:null,target:t,priority:e};for(var n=0;n<pa.length&&e!==0&&e<pa[n].priority;n++);pa.splice(n,0,t),n===0&&Vj(t)}};function T1(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Dp(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Q2(){}function $P(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var u=Fm(o);i.call(u)}}var o=cT(e,r,t,0,null,!1,!1,"",Q2);return t._reactRootContainer=o,t[Di]=o.current,dd(t.nodeType===8?t.parentNode:t),Uo(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var u=Fm(c);l.call(u)}}var c=E1(t,0,!1,null,null,!1,!1,"",Q2);return t._reactRootContainer=c,t[Di]=c.current,dd(t.nodeType===8?t.parentNode:t),Uo(function(){Fp(e,c,n,r)}),c}function Lp(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var l=s;s=function(){var c=Fm(o);l.call(c)}}Fp(e,o,t,s)}else o=$P(n,e,t,s,r);return Fm(o)}Oj=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Mu(e.pendingLanes);n!==0&&(Wv(e,n|1),vr(e,At()),!(Ue&6)&&(gc=At()+500,Qa()))}break;case 13:Uo(function(){var r=Li(t,1);if(r!==null){var s=Yn();Cs(r,t,1,s)}}),j1(t,1)}};qv=function(t){if(t.tag===13){var e=Li(t,134217728);if(e!==null){var n=Yn();Cs(e,t,134217728,n)}j1(t,134217728)}};$j=function(t){if(t.tag===13){var e=Na(t),n=Li(t,e);if(n!==null){var r=Yn();Cs(n,t,e,r)}j1(t,e)}};zj=function(){return Qe};Bj=function(t,e){var n=Qe;try{return Qe=t,e()}finally{Qe=n}};Hx=function(t,e,n){switch(e){case"input":if(Lx(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=Tp(r);if(!s)throw Error(q(90));yj(r),Lx(r,s)}}}break;case"textarea":wj(t,n);break;case"select":e=n.value,e!=null&&Jl(t,!!n.multiple,e,!1)}};Tj=w1;Ij=Uo;var zP={usingClientEntryPoint:!1,Events:[Wd,Vl,Tp,jj,kj,w1]},Cu={findFiberByHostInstance:Co,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},BP={bundleType:Cu.bundleType,version:Cu.version,rendererPackageName:Cu.rendererPackageName,rendererConfig:Cu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Gi.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Nj(t),t===null?null:t.stateNode},findFiberByHostInstance:Cu.findFiberByHostInstance||OP,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var wf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!wf.isDisabled&&wf.supportsFiber)try{Sp=wf.inject(BP),Js=wf}catch{}}Br.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=zP;Br.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!T1(e))throw Error(q(200));return LP(t,e,null,n)};Br.createRoot=function(t,e){if(!T1(t))throw Error(q(299));var n=!1,r="",s=uT;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=E1(t,1,!1,null,null,n,!1,r,s),t[Di]=e.current,dd(t.nodeType===8?t.parentNode:t),new k1(e)};Br.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(q(188)):(t=Object.keys(t).join(","),Error(q(268,t)));return t=Nj(e),t=t===null?null:t.stateNode,t};Br.flushSync=function(t){return Uo(t)};Br.hydrate=function(t,e,n){if(!Dp(e))throw Error(q(200));return Lp(null,t,e,!0,n)};Br.hydrateRoot=function(t,e,n){if(!T1(t))throw Error(q(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=uT;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=cT(e,null,t,1,n??null,s,!1,i,o),t[Di]=e.current,dd(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Mp(e)};Br.render=function(t,e,n){if(!Dp(e))throw Error(q(200));return Lp(null,t,e,!1,n)};Br.unmountComponentAtNode=function(t){if(!Dp(t))throw Error(q(40));return t._reactRootContainer?(Uo(function(){Lp(null,null,t,!1,function(){t._reactRootContainer=null,t[Di]=null})}),!0):!1};Br.unstable_batchedUpdates=w1;Br.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Dp(n))throw Error(q(200));if(t==null||t._reactInternals===void 0)throw Error(q(38));return Lp(t,e,n,!1,r)};Br.version="18.2.0-next-9e3b772b8-20220608";function dT(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(dT)}catch(t){console.error(t)}}dT(),cj.exports=Br;var il=cj.exports,X2=il;Rx.createRoot=X2.createRoot,Rx.hydrateRoot=X2.hydrateRoot;/**
 * @remix-run/router v1.7.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function wd(){return wd=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},wd.apply(this,arguments)}var Sa;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Sa||(Sa={}));const Y2="popstate";function VP(t){t===void 0&&(t={});function e(s,i){let{pathname:o="/",search:l="",hash:c=""}=al(s.location.hash.substr(1));return Sy("",{pathname:o,search:l,hash:c},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(s,i){let o=s.document.querySelector("base"),l="";if(o&&o.getAttribute("href")){let c=s.location.href,u=c.indexOf("#");l=u===-1?c:c.slice(0,u)}return l+"#"+(typeof i=="string"?i:Mm(i))}function r(s,i){Op(s.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(i)+")")}return HP(e,n,r,t)}function Ft(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Op(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function UP(){return Math.random().toString(36).substr(2,8)}function J2(t,e){return{usr:t.state,key:t.key,idx:e}}function Sy(t,e,n,r){return n===void 0&&(n=null),wd({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?al(e):e,{state:n,key:e&&e.key||r||UP()})}function Mm(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function al(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function HP(t,e,n,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:i=!1}=r,o=s.history,l=Sa.Pop,c=null,u=d();u==null&&(u=0,o.replaceState(wd({},o.state,{idx:u}),""));function d(){return(o.state||{idx:null}).idx}function f(){l=Sa.Pop;let v=d(),_=v==null?null:v-u;u=v,c&&c({action:l,location:w.location,delta:_})}function p(v,_){l=Sa.Push;let b=Sy(w.location,v,_);n&&n(b,v),u=d()+1;let j=J2(b,u),T=w.createHref(b);try{o.pushState(j,"",T)}catch(R){if(R instanceof DOMException&&R.name==="DataCloneError")throw R;s.location.assign(T)}i&&c&&c({action:l,location:w.location,delta:1})}function g(v,_){l=Sa.Replace;let b=Sy(w.location,v,_);n&&n(b,v),u=d();let j=J2(b,u),T=w.createHref(b);o.replaceState(j,"",T),i&&c&&c({action:l,location:w.location,delta:0})}function x(v){let _=s.location.origin!=="null"?s.location.origin:s.location.href,b=typeof v=="string"?v:Mm(v);return Ft(_,"No window.location.(origin|href) available to create URL for href: "+b),new URL(b,_)}let w={get action(){return l},get location(){return t(s,o)},listen(v){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(Y2,f),c=v,()=>{s.removeEventListener(Y2,f),c=null}},createHref(v){return e(s,v)},createURL:x,encodeLocation(v){let _=x(v);return{pathname:_.pathname,search:_.search,hash:_.hash}},push:p,replace:g,go(v){return o.go(v)}};return w}var Z2;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(Z2||(Z2={}));function GP(t,e,n){n===void 0&&(n="/");let r=typeof e=="string"?al(e):e,s=I1(r.pathname||"/",n);if(s==null)return null;let i=hT(t);WP(i);let o=null;for(let l=0;o==null&&l<i.length;++l)o=t4(i[l],s4(s));return o}function hT(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let s=(i,o,l)=>{let c={relativePath:l===void 0?i.path||"":l,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};c.relativePath.startsWith("/")&&(Ft(c.relativePath.startsWith(r),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(r.length));let u=Pa([r,c.relativePath]),d=n.concat(c);i.children&&i.children.length>0&&(Ft(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),hT(i.children,e,d,u)),!(i.path==null&&!i.index)&&e.push({path:u,score:ZP(u,i.index),routesMeta:d})};return t.forEach((i,o)=>{var l;if(i.path===""||!((l=i.path)!=null&&l.includes("?")))s(i,o);else for(let c of fT(i.path))s(i,o,c)}),e}function fT(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let o=fT(r.join("/")),l=[];return l.push(...o.map(c=>c===""?i:[i,c].join("/"))),s&&l.push(...o),l.map(c=>t.startsWith("/")&&c===""?"/":c)}function WP(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:e4(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const qP=/^:\w+$/,KP=3,QP=2,XP=1,YP=10,JP=-2,eb=t=>t==="*";function ZP(t,e){let n=t.split("/"),r=n.length;return n.some(eb)&&(r+=JP),e&&(r+=QP),n.filter(s=>!eb(s)).reduce((s,i)=>s+(qP.test(i)?KP:i===""?XP:YP),r)}function e4(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function t4(t,e){let{routesMeta:n}=t,r={},s="/",i=[];for(let o=0;o<n.length;++o){let l=n[o],c=o===n.length-1,u=s==="/"?e:e.slice(s.length)||"/",d=n4({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u);if(!d)return null;Object.assign(r,d.params);let f=l.route;i.push({params:r,pathname:Pa([s,d.pathname]),pathnameBase:l4(Pa([s,d.pathnameBase])),route:f}),d.pathnameBase!=="/"&&(s=Pa([s,d.pathnameBase]))}return i}function n4(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=r4(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:r.reduce((u,d,f)=>{if(d==="*"){let p=l[f]||"";o=i.slice(0,i.length-p.length).replace(/(.)\/+$/,"$1")}return u[d]=i4(l[f]||"",d),u},{}),pathname:i,pathnameBase:o,pattern:t}}function r4(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),Op(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/\/:(\w+)/g,(o,l)=>(r.push(l),"/([^\\/]+)"));return t.endsWith("*")?(r.push("*"),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function s4(t){try{return decodeURI(t)}catch(e){return Op(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function i4(t,e){try{return decodeURIComponent(t)}catch(n){return Op(!1,'The value for the URL param "'+e+'" will not be decoded because'+(' the string "'+t+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+n+").")),t}}function I1(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function a4(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?al(t):t;return{pathname:n?n.startsWith("/")?n:o4(n,e):e,search:c4(r),hash:u4(s)}}function o4(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function B0(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function C1(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function R1(t,e,n,r){r===void 0&&(r=!1);let s;typeof t=="string"?s=al(t):(s=wd({},t),Ft(!s.pathname||!s.pathname.includes("?"),B0("?","pathname","search",s)),Ft(!s.pathname||!s.pathname.includes("#"),B0("#","pathname","hash",s)),Ft(!s.search||!s.search.includes("#"),B0("#","search","hash",s)));let i=t===""||s.pathname==="",o=i?"/":s.pathname,l;if(r||o==null)l=n;else{let f=e.length-1;if(o.startsWith("..")){let p=o.split("/");for(;p[0]==="..";)p.shift(),f-=1;s.pathname=p.join("/")}l=f>=0?e[f]:"/"}let c=a4(s,l),u=o&&o!=="/"&&o.endsWith("/"),d=(i||o===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}const Pa=t=>t.join("/").replace(/\/\/+/g,"/"),l4=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),c4=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,u4=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function d4(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const mT=["post","put","patch","delete"];new Set(mT);const h4=["get",...mT];new Set(h4);/**
 * React Router v6.14.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Dm(){return Dm=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Dm.apply(this,arguments)}const N1=h.createContext(null),f4=h.createContext(null),$c=h.createContext(null),$p=h.createContext(null),li=h.createContext({outlet:null,matches:[],isDataRoute:!1}),pT=h.createContext(null);function m4(t,e){let{relative:n}=e===void 0?{}:e;zc()||Ft(!1);let{basename:r,navigator:s}=h.useContext($c),{hash:i,pathname:o,search:l}=xT(t,{relative:n}),c=o;return r!=="/"&&(c=o==="/"?r:Pa([r,o])),s.createHref({pathname:c,search:l,hash:i})}function zc(){return h.useContext($p)!=null}function Wn(){return zc()||Ft(!1),h.useContext($p).location}function gT(t){h.useContext($c).static||h.useLayoutEffect(t)}function Gt(){let{isDataRoute:t}=h.useContext(li);return t?C4():p4()}function p4(){zc()||Ft(!1);let t=h.useContext(N1),{basename:e,navigator:n}=h.useContext($c),{matches:r}=h.useContext(li),{pathname:s}=Wn(),i=JSON.stringify(C1(r).map(c=>c.pathnameBase)),o=h.useRef(!1);return gT(()=>{o.current=!0}),h.useCallback(function(c,u){if(u===void 0&&(u={}),!o.current)return;if(typeof c=="number"){n.go(c);return}let d=R1(c,JSON.parse(i),s,u.relative==="path");t==null&&e!=="/"&&(d.pathname=d.pathname==="/"?e:Pa([e,d.pathname])),(u.replace?n.replace:n.push)(d,u.state,u)},[e,n,i,s,t])}const g4=h.createContext(null);function x4(t){let e=h.useContext(li).outlet;return e&&h.createElement(g4.Provider,{value:t},e)}function Wi(){let{matches:t}=h.useContext(li),e=t[t.length-1];return e?e.params:{}}function xT(t,e){let{relative:n}=e===void 0?{}:e,{matches:r}=h.useContext(li),{pathname:s}=Wn(),i=JSON.stringify(C1(r).map(o=>o.pathnameBase));return h.useMemo(()=>R1(t,JSON.parse(i),s,n==="path"),[t,i,s,n])}function y4(t,e){return v4(t,e)}function v4(t,e,n){zc()||Ft(!1);let{navigator:r}=h.useContext($c),{matches:s}=h.useContext(li),i=s[s.length-1],o=i?i.params:{};i&&i.pathname;let l=i?i.pathnameBase:"/";i&&i.route;let c=Wn(),u;if(e){var d;let w=typeof e=="string"?al(e):e;l==="/"||(d=w.pathname)!=null&&d.startsWith(l)||Ft(!1),u=w}else u=c;let f=u.pathname||"/",p=l==="/"?f:f.slice(l.length)||"/",g=GP(t,{pathname:p}),x=E4(g&&g.map(w=>Object.assign({},w,{params:Object.assign({},o,w.params),pathname:Pa([l,r.encodeLocation?r.encodeLocation(w.pathname).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?l:Pa([l,r.encodeLocation?r.encodeLocation(w.pathnameBase).pathname:w.pathnameBase])})),s,n);return e&&x?h.createElement($p.Provider,{value:{location:Dm({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:Sa.Pop}},x):x}function w4(){let t=I4(),e=d4(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},i=null;return h.createElement(h.Fragment,null,h.createElement("h2",null,"Unexpected Application Error!"),h.createElement("h3",{style:{fontStyle:"italic"}},e),n?h.createElement("pre",{style:s},n):null,i)}const _4=h.createElement(w4,null);class b4 extends h.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error||n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error?h.createElement(li.Provider,{value:this.props.routeContext},h.createElement(pT.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function S4(t){let{routeContext:e,match:n,children:r}=t,s=h.useContext(N1);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),h.createElement(li.Provider,{value:e},r)}function E4(t,e,n){var r;if(e===void 0&&(e=[]),n===void 0&&(n=null),t==null){var s;if((s=n)!=null&&s.errors)t=n.matches;else return null}let i=t,o=(r=n)==null?void 0:r.errors;if(o!=null){let l=i.findIndex(c=>c.route.id&&(o==null?void 0:o[c.route.id]));l>=0||Ft(!1),i=i.slice(0,Math.min(i.length,l+1))}return i.reduceRight((l,c,u)=>{let d=c.route.id?o==null?void 0:o[c.route.id]:null,f=null;n&&(f=c.route.errorElement||_4);let p=e.concat(i.slice(0,u+1)),g=()=>{let x;return d?x=f:c.route.Component?x=h.createElement(c.route.Component,null):c.route.element?x=c.route.element:x=l,h.createElement(S4,{match:c,routeContext:{outlet:l,matches:p,isDataRoute:n!=null},children:x})};return n&&(c.route.ErrorBoundary||c.route.errorElement||u===0)?h.createElement(b4,{location:n.location,revalidation:n.revalidation,component:f,error:d,children:g(),routeContext:{outlet:null,matches:p,isDataRoute:!0}}):g()},null)}var Ey;(function(t){t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate"})(Ey||(Ey={}));var _d;(function(t){t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId"})(_d||(_d={}));function j4(t){let e=h.useContext(N1);return e||Ft(!1),e}function k4(t){let e=h.useContext(f4);return e||Ft(!1),e}function T4(t){let e=h.useContext(li);return e||Ft(!1),e}function yT(t){let e=T4(),n=e.matches[e.matches.length-1];return n.route.id||Ft(!1),n.route.id}function I4(){var t;let e=h.useContext(pT),n=k4(_d.UseRouteError),r=yT(_d.UseRouteError);return e||((t=n.errors)==null?void 0:t[r])}function C4(){let{router:t}=j4(Ey.UseNavigateStable),e=yT(_d.UseNavigateStable),n=h.useRef(!1);return gT(()=>{n.current=!0}),h.useCallback(function(s,i){i===void 0&&(i={}),n.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,Dm({fromRouteId:e},i)))},[t,e])}function A1(t){let{to:e,replace:n,state:r,relative:s}=t;zc()||Ft(!1);let{matches:i}=h.useContext(li),{pathname:o}=Wn(),l=Gt(),c=R1(e,C1(i).map(d=>d.pathnameBase),o,s==="path"),u=JSON.stringify(c);return h.useEffect(()=>l(JSON.parse(u),{replace:n,state:r,relative:s}),[l,u,s,n,r]),null}function zp(t){return x4(t.context)}function _s(t){Ft(!1)}function R4(t){let{basename:e="/",children:n=null,location:r,navigationType:s=Sa.Pop,navigator:i,static:o=!1}=t;zc()&&Ft(!1);let l=e.replace(/^\/*/,"/"),c=h.useMemo(()=>({basename:l,navigator:i,static:o}),[l,i,o]);typeof r=="string"&&(r=al(r));let{pathname:u="/",search:d="",hash:f="",state:p=null,key:g="default"}=r,x=h.useMemo(()=>{let w=I1(u,l);return w==null?null:{location:{pathname:w,search:d,hash:f,state:p,key:g},navigationType:s}},[l,u,d,f,p,g,s]);return x==null?null:h.createElement($c.Provider,{value:c},h.createElement($p.Provider,{children:n,value:x}))}function N4(t){let{children:e,location:n}=t;return y4(jy(e),n)}var tb;(function(t){t[t.pending=0]="pending",t[t.success=1]="success",t[t.error=2]="error"})(tb||(tb={}));new Promise(()=>{});function jy(t,e){e===void 0&&(e=[]);let n=[];return h.Children.forEach(t,(r,s)=>{if(!h.isValidElement(r))return;let i=[...e,s];if(r.type===h.Fragment){n.push.apply(n,jy(r.props.children,i));return}r.type!==_s&&Ft(!1),!r.props.index||!r.props.children||Ft(!1);let o={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=jy(r.props.children,i)),n.push(o)}),n}/**
 * React Router DOM v6.14.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ky(){return ky=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ky.apply(this,arguments)}function A4(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,i;for(i=0;i<r.length;i++)s=r[i],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}function P4(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function F4(t,e){return t.button===0&&(!e||e==="_self")&&!P4(t)}function Ty(t){return t===void 0&&(t=""),new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let r=t[n];return e.concat(Array.isArray(r)?r.map(s=>[n,s]):[[n,r]])},[]))}function M4(t,e){let n=Ty(t);if(e)for(let r of e.keys())n.has(r)||e.getAll(r).forEach(s=>{n.append(r,s)});return n}const D4=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset"],L4="startTransition",nb=AA[L4];function O4(t){let{basename:e,children:n,future:r,window:s}=t,i=h.useRef();i.current==null&&(i.current=VP({window:s,v5Compat:!0}));let o=i.current,[l,c]=h.useState({action:o.action,location:o.location}),{v7_startTransition:u}=r||{},d=h.useCallback(f=>{u&&nb?nb(()=>c(f)):c(f)},[c,u]);return h.useLayoutEffect(()=>o.listen(d),[o,d]),h.createElement(R4,{basename:e,children:n,location:l.location,navigationType:l.action,navigator:o})}const $4=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",z4=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,se=h.forwardRef(function(e,n){let{onClick:r,relative:s,reloadDocument:i,replace:o,state:l,target:c,to:u,preventScrollReset:d}=e,f=A4(e,D4),{basename:p}=h.useContext($c),g,x=!1;if(typeof u=="string"&&z4.test(u)&&(g=u,$4))try{let b=new URL(window.location.href),j=u.startsWith("//")?new URL(b.protocol+u):new URL(u),T=I1(j.pathname,p);j.origin===b.origin&&T!=null?u=T+j.search+j.hash:x=!0}catch{}let w=m4(u,{relative:s}),v=B4(u,{replace:o,state:l,target:c,preventScrollReset:d,relative:s});function _(b){r&&r(b),b.defaultPrevented||v(b)}return h.createElement("a",ky({},f,{href:g||w,onClick:x||i?r:_,ref:n,target:c}))});var rb;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher"})(rb||(rb={}));var sb;(function(t){t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(sb||(sb={}));function B4(t,e){let{target:n,replace:r,state:s,preventScrollReset:i,relative:o}=e===void 0?{}:e,l=Gt(),c=Wn(),u=xT(t,{relative:o});return h.useCallback(d=>{if(F4(d,n)){d.preventDefault();let f=r!==void 0?r:Mm(c)===Mm(u);l(t,{replace:f,state:s,preventScrollReset:i,relative:o})}},[c,l,u,r,s,n,t,i,o])}function vT(t){let e=h.useRef(Ty(t)),n=h.useRef(!1),r=Wn(),s=h.useMemo(()=>M4(r.search,n.current?null:e.current),[r.search]),i=Gt(),o=h.useCallback((l,c)=>{const u=Ty(typeof l=="function"?l(s):l);n.current=!0,i("?"+u,c)},[i,s]);return[s,o]}function wT(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t))for(e=0;e<t.length;e++)t[e]&&(n=wT(t[e]))&&(r&&(r+=" "),r+=n);else for(e in t)t[e]&&(r&&(r+=" "),r+=e);return r}function V4(){for(var t,e,n=0,r="";n<arguments.length;)(t=arguments[n++])&&(e=wT(t))&&(r&&(r+=" "),r+=e);return r}const ib=t=>typeof t=="boolean"?"".concat(t):t===0?"0":t,ab=V4,Bc=(t,e)=>n=>{var r;if((e==null?void 0:e.variants)==null)return ab(t,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:s,defaultVariants:i}=e,o=Object.keys(s).map(u=>{const d=n==null?void 0:n[u],f=i==null?void 0:i[u];if(d===null)return null;const p=ib(d)||ib(f);return s[u][p]}),l=n&&Object.entries(n).reduce((u,d)=>{let[f,p]=d;return p===void 0||(u[f]=p),u},{}),c=e==null||(r=e.compoundVariants)===null||r===void 0?void 0:r.reduce((u,d)=>{let{class:f,className:p,...g}=d;return Object.entries(g).every(x=>{let[w,v]=x;return Array.isArray(v)?v.includes({...i,...l}[w]):{...i,...l}[w]===v})?[...u,f,p]:u},[]);return ab(t,o,c,n==null?void 0:n.class,n==null?void 0:n.className)};function U4({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 6h9.75M10.5 6a1.5 1.5 0 11-3 0m3 0a1.5 1.5 0 10-3 0M3.75 6H7.5m3 12h9.75m-9.75 0a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0m-3.75 0H7.5m9-6h3.75m-3.75 0a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0m-9.75 0h9.75"}))}const H4=h.forwardRef(U4),_T=H4;function G4({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3"}))}const W4=h.forwardRef(G4),Kd=W4;function q4({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6a2.25 2.25 0 00-2.25 2.25v13.5A2.25 2.25 0 007.5 21h6a2.25 2.25 0 002.25-2.25V15M12 9l-3 3m0 0l3 3m-3-3h12.75"}))}const K4=h.forwardRef(q4),bT=K4;function Q4({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18"}))}const X4=h.forwardRef(Q4),P1=X4;function Y4({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99"}))}const J4=h.forwardRef(Y4),Me=J4;function Z4({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6a2.25 2.25 0 00-2.25 2.25v13.5A2.25 2.25 0 007.5 21h6a2.25 2.25 0 002.25-2.25V15m3 0l3-3m0 0l-3-3m3 3H9"}))}const e6=h.forwardRef(Z4),ST=e6;function t6({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 4.5L21 12m0 0l-7.5 7.5M21 12H3"}))}const n6=h.forwardRef(t6),ET=n6;function r6({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 6H5.25A2.25 2.25 0 003 8.25v10.5A2.25 2.25 0 005.25 21h10.5A2.25 2.25 0 0018 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"}))}const s6=h.forwardRef(r6),i6=s6;function a6({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 18L9 11.25l4.306 4.307a11.95 11.95 0 015.814-5.519l2.74-1.22m0 0l-5.94-2.28m5.94 2.28l-2.28 5.941"}))}const o6=h.forwardRef(a6),F1=o6;function l6({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 19.5l15-15m0 0H8.25m11.25 0v11.25"}))}const c6=h.forwardRef(l6),jT=c6;function u6({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5m-13.5-9L12 3m0 0l4.5 4.5M12 3v13.5"}))}const d6=h.forwardRef(u6),M1=d6;function h6({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"}))}const f6=h.forwardRef(h6),Qd=f6;function m6({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20.25 8.511c.884.284 1.5 1.128 1.5 2.097v4.286c0 1.136-.847 2.1-1.98 2.193-.34.027-.68.052-1.02.072v3.091l-3-3c-1.354 0-2.694-.055-4.02-.163a2.115 2.115 0 01-.825-.242m9.345-8.334a2.126 2.126 0 00-.476-.095 48.64 48.64 0 00-8.048 0c-1.131.094-1.976 1.057-1.976 2.192v4.286c0 .837.46 1.58 1.155 1.951m9.345-8.334V6.637c0-1.621-1.152-3.026-2.76-3.235A48.455 48.455 0 0011.25 3c-2.115 0-4.198.137-6.24.402-1.608.209-2.76 1.614-2.76 3.235v6.226c0 1.621 1.152 3.026 2.76 3.235.577.075 1.157.14 1.74.194V21l4.155-4.155"}))}const p6=h.forwardRef(m6),D1=p6;function g6({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}))}const x6=h.forwardRef(g6),y6=x6;function v6({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 12.75l6 6 9-13.5"}))}const w6=h.forwardRef(v6),Xa=w6;function _6({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 8.25l-7.5 7.5-7.5-7.5"}))}const b6=h.forwardRef(_6),kT=b6;function S6({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5L8.25 12l7.5-7.5"}))}const E6=h.forwardRef(S6),L1=E6;function j6({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 4.5l7.5 7.5-7.5 7.5"}))}const k6=h.forwardRef(j6),Ju=k6;function T6({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 15.75l7.5-7.5 7.5 7.5"}))}const I6=h.forwardRef(T6),C6=I6;function R6({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 7.5V6.108c0-1.135.845-2.098 1.976-2.192.373-.03.748-.057 1.123-.08M15.75 18H18a2.25 2.25 0 002.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 00-1.123-.08M15.75 18.75v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5A3.375 3.375 0 006.375 7.5H5.25m11.9-3.664A2.251 2.251 0 0015 2.25h-1.5a2.251 2.251 0 00-2.15 1.586m5.8 0c.065.21.1.433.1.664v.75h-6V4.5c0-.231.035-.454.1-.664M6.75 7.5H4.875c-.621 0-1.125.504-1.125 1.125v12c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V16.5a9 9 0 00-9-9z"}))}const N6=h.forwardRef(R6),A6=N6;function P6({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z"}))}const F6=h.forwardRef(P6),TT=F6;function M6({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.324.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 011.37.49l1.296 2.247a1.125 1.125 0 01-.26 1.431l-1.003.827c-.293.24-.438.613-.431.992a6.759 6.759 0 010 .255c-.007.378.138.75.43.99l1.005.828c.424.35.534.954.26 1.43l-1.298 2.247a1.125 1.125 0 01-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.57 6.57 0 01-.22.128c-.331.183-.581.495-.644.869l-.213 1.28c-.09.543-.56.941-1.11.941h-2.594c-.55 0-1.02-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 01-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 01-1.369-.49l-1.297-2.247a1.125 1.125 0 01.26-1.431l1.004-.827c.292-.24.437-.613.43-.992a6.932 6.932 0 010-.255c.007-.378-.138-.75-.43-.99l-1.004-.828a1.125 1.125 0 01-.26-1.43l1.297-2.247a1.125 1.125 0 011.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.087.22-.128.332-.183.582-.495.644-.869l.214-1.281z"}),h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}))}const D6=h.forwardRef(M6),O1=D6;function L6({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 17.25v1.007a3 3 0 01-.879 2.122L7.5 21h9l-.621-.621A3 3 0 0115 18.257V17.25m6-12V15a2.25 2.25 0 01-2.25 2.25H5.25A2.25 2.25 0 013 15V5.25m18 0A2.25 2.25 0 0018.75 3H5.25A2.25 2.25 0 003 5.25m18 0V12a2.25 2.25 0 01-2.25 2.25H5.25A2.25 2.25 0 013 12V5.25"}))}const O6=h.forwardRef(L6),Bp=O6;function $6({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z"}))}const z6=h.forwardRef($6),Vp=z6;function B6({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m9-.75a9 9 0 11-18 0 9 9 0 0118 0zm-9 3.75h.008v.008H12v-.008z"}))}const V6=h.forwardRef(B6),Up=V6;function U6({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z"}),h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}))}const H6=h.forwardRef(U6),G6=H6;function W6({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.375 19.5h17.25m-17.25 0a1.125 1.125 0 01-1.125-1.125M3.375 19.5h1.5C5.496 19.5 6 18.996 6 18.375m-3.75 0V5.625m0 12.75v-1.5c0-.621.504-1.125 1.125-1.125m18.375 2.625V5.625m0 12.75c0 .621-.504 1.125-1.125 1.125m1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125m0 3.75h-1.5A1.125 1.125 0 0118 18.375M20.625 4.5H3.375m17.25 0c.621 0 1.125.504 1.125 1.125M20.625 4.5h-1.5C18.504 4.5 18 5.004 18 5.625m3.75 0v1.5c0 .621-.504 1.125-1.125 1.125M3.375 4.5c-.621 0-1.125.504-1.125 1.125M3.375 4.5h1.5C5.496 4.5 6 5.004 6 5.625m-3.75 0v1.5c0 .621.504 1.125 1.125 1.125m0 0h1.5m-1.5 0c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125m1.5-3.75C5.496 8.25 6 7.746 6 7.125v-1.5M4.875 8.25C5.496 8.25 6 8.754 6 9.375v1.5m0-5.25v5.25m0-5.25C6 5.004 6.504 4.5 7.125 4.5h9.75c.621 0 1.125.504 1.125 1.125m1.125 2.625h1.5m-1.5 0A1.125 1.125 0 0118 7.125v-1.5m1.125 2.625c-.621 0-1.125.504-1.125 1.125v1.5m2.625-2.625c.621 0 1.125.504 1.125 1.125v1.5c0 .621-.504 1.125-1.125 1.125M18 5.625v5.25M7.125 12h9.75m-9.75 0A1.125 1.125 0 016 10.875M7.125 12C6.504 12 6 12.504 6 13.125m0-2.25C6 11.496 5.496 12 4.875 12M18 10.875c0 .621-.504 1.125-1.125 1.125M18 10.875c0 .621.504 1.125 1.125 1.125m-2.25 0c.621 0 1.125.504 1.125 1.125m-12 5.25v-5.25m0 5.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125m-12 0v-1.5c0-.621-.504-1.125-1.125-1.125M18 18.375v-5.25m0 5.25v-1.5c0-.621.504-1.125 1.125-1.125M18 13.125v1.5c0 .621.504 1.125 1.125 1.125M18 13.125c0-.621.504-1.125 1.125-1.125M6 13.125v1.5c0 .621-.504 1.125-1.125 1.125M6 13.125C6 12.504 5.496 12 4.875 12m-1.5 0h1.5m-1.5 0c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125M19.125 12h1.5m0 0c.621 0 1.125.504 1.125 1.125v1.5c0 .621-.504 1.125-1.125 1.125m-17.25 0h1.5m14.25 0h1.5"}))}const q6=h.forwardRef(W6),IT=q6;function K6({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 9.776c.112-.017.227-.026.344-.026h15.812c.117 0 .232.009.344.026m-16.5 0a2.25 2.25 0 00-1.883 2.542l.857 6a2.25 2.25 0 002.227 1.932H19.05a2.25 2.25 0 002.227-1.932l.857-6a2.25 2.25 0 00-1.883-2.542m-16.5 0V6A2.25 2.25 0 016 3.75h3.879a1.5 1.5 0 011.06.44l2.122 2.12a1.5 1.5 0 001.06.44H18A2.25 2.25 0 0120.25 9v.776"}))}const Q6=h.forwardRef(K6),X6=Q6;function Y6({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12.75 3.03v.568c0 .334.148.65.405.864l1.068.89c.442.369.535 1.01.216 1.49l-.51.766a2.25 2.25 0 01-1.161.886l-.143.048a1.107 1.107 0 00-.57 1.664c.369.555.169 1.307-.427 1.605L9 13.125l.423 1.059a.956.956 0 01-1.652.928l-.679-.906a1.125 1.125 0 00-1.906.172L4.5 15.75l-.612.153M12.75 3.031a9 9 0 00-8.862 12.872M12.75 3.031a9 9 0 016.69 14.036m0 0l-.177-.529A2.25 2.25 0 0017.128 15H16.5l-.324-.324a1.453 1.453 0 00-2.328.377l-.036.073a1.586 1.586 0 01-.982.816l-.99.282c-.55.157-.894.702-.8 1.267l.073.438c.08.474.49.821.97.821.846 0 1.598.542 1.865 1.345l.215.643m5.276-3.67a9.012 9.012 0 01-5.276 3.67m0 0a9 9 0 01-10.275-4.835M15.75 9c0 .896-.393 1.7-1.016 2.25"}))}const J6=h.forwardRef(Y6),CT=J6;function Z6({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12z"}))}const eF=h.forwardRef(Z6),Xd=eF;function tF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 12l8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25"}))}const nF=h.forwardRef(tF),Yd=nF;function rF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z"}))}const sF=h.forwardRef(rF),iF=sF;function aF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.19 8.688a4.5 4.5 0 011.242 7.244l-4.5 4.5a4.5 4.5 0 01-6.364-6.364l1.757-1.757m13.35-.622l1.757-1.757a4.5 4.5 0 00-6.364-6.364l-4.5 4.5a4.5 4.5 0 001.242 7.244"}))}const oF=h.forwardRef(aF),lF=oF;function cF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"}))}const uF=h.forwardRef(cF),Jd=uF;function dF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 12h-15"}))}const hF=h.forwardRef(dF),$1=hF;function fF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 9l10.5-3m0 6.553v3.75a2.25 2.25 0 01-1.632 2.163l-1.32.377a1.803 1.803 0 11-.99-3.467l2.31-.66a2.25 2.25 0 001.632-2.163zm0 0V2.25L9 5.25v10.303m0 0v3.75a2.25 2.25 0 01-1.632 2.163l-1.32.377a1.803 1.803 0 01-.99-3.467l2.31-.66A2.25 2.25 0 009 15.553z"}))}const mF=h.forwardRef(fF),qi=mF;function pF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 7.5h1.5m-1.5 3h1.5m-7.5 3h7.5m-7.5 3h7.5m3-9h3.375c.621 0 1.125.504 1.125 1.125V18a2.25 2.25 0 01-2.25 2.25M16.5 7.5V18a2.25 2.25 0 002.25 2.25M16.5 7.5V4.875c0-.621-.504-1.125-1.125-1.125H4.125C3.504 3.75 3 4.254 3 4.875V18a2.25 2.25 0 002.25 2.25h13.5M6 7.5h3v3H6v-3z"}))}const gF=h.forwardRef(pF),xF=gF;function yF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.53 16.122a3 3 0 00-5.78 1.128 2.25 2.25 0 01-2.4 2.245 4.5 4.5 0 008.4-2.245c0-.399-.078-.78-.22-1.128zm0 0a15.998 15.998 0 003.388-1.62m-5.043-.025a15.994 15.994 0 011.622-3.395m3.42 3.42a15.995 15.995 0 004.764-4.648l3.876-5.814a1.151 1.151 0 00-1.597-1.597L14.146 6.32a15.996 15.996 0 00-4.649 4.763m3.42 3.42a6.776 6.776 0 00-3.42-3.42"}))}const vF=h.forwardRef(yF),RT=vF;function wF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.25 9v6m-4.5 0V9M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}))}const _F=h.forwardRef(wF),bF=_F;function SF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 5.25v13.5m-7.5-13.5v13.5"}))}const EF=h.forwardRef(SF),NT=EF;function jF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125"}))}const kF=h.forwardRef(jF),is=kF;function TF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 15.75l5.159-5.159a2.25 2.25 0 013.182 0l5.159 5.159m-1.5-1.5l1.409-1.409a2.25 2.25 0 013.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 001.5-1.5V6a1.5 1.5 0 00-1.5-1.5H3.75A1.5 1.5 0 002.25 6v12a1.5 1.5 0 001.5 1.5zm10.5-11.25h.008v.008h-.008V8.25zm.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0z"}))}const IF=h.forwardRef(TF),Ki=IF;function CF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 5.653c0-.856.917-1.398 1.667-.986l11.54 6.348a1.125 1.125 0 010 1.971l-11.54 6.347a1.125 1.125 0 01-1.667-.985V5.653z"}))}const RF=h.forwardRef(CF),AT=RF;function NF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"}))}const AF=h.forwardRef(NF),Wt=AF;function PF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 12h16.5m-16.5 3.75h16.5M3.75 19.5h16.5M5.625 4.5h12.75a1.875 1.875 0 010 3.75H5.625a1.875 1.875 0 010-3.75z"}))}const FF=h.forwardRef(PF),MF=FF;function DF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 7.125C2.25 6.504 2.754 6 3.375 6h6c.621 0 1.125.504 1.125 1.125v3.75c0 .621-.504 1.125-1.125 1.125h-6a1.125 1.125 0 01-1.125-1.125v-3.75zM14.25 8.625c0-.621.504-1.125 1.125-1.125h5.25c.621 0 1.125.504 1.125 1.125v8.25c0 .621-.504 1.125-1.125 1.125h-5.25a1.125 1.125 0 01-1.125-1.125v-8.25zM3.75 16.125c0-.621.504-1.125 1.125-1.125h5.25c.621 0 1.125.504 1.125 1.125v2.25c0 .621-.504 1.125-1.125 1.125h-5.25a1.125 1.125 0 01-1.125-1.125v-2.25z"}))}const LF=h.forwardRef(DF),OF=LF;function $F({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7.848 8.25l1.536.887M7.848 8.25a3 3 0 11-5.196-3 3 3 0 015.196 3zm1.536.887a2.165 2.165 0 011.083 1.839c.005.351.054.695.14 1.024M9.384 9.137l2.077 1.199M7.848 15.75l1.536-.887m-1.536.887a3 3 0 11-5.196 3 3 3 0 015.196-3zm1.536-.887a2.165 2.165 0 001.083-1.838c.005-.352.054-.695.14-1.025m-1.223 2.863l2.077-1.199m0-3.328a4.323 4.323 0 012.068-1.379l5.325-1.628a4.5 4.5 0 012.48-.044l.803.215-7.794 4.5m-2.882-1.664A4.331 4.331 0 0010.607 12m3.736 0l7.794 4.5-.802.215a4.5 4.5 0 01-2.48-.043l-5.326-1.629a4.324 4.324 0 01-2.068-1.379M14.343 12l-2.882 1.664"}))}const zF=h.forwardRef($F),PT=zF;function BF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.114 5.636a9 9 0 010 12.728M16.463 8.288a5.25 5.25 0 010 7.424M6.75 8.25l4.72-4.72a.75.75 0 011.28.53v15.88a.75.75 0 01-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.01 9.01 0 012.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75z"}))}const VF=h.forwardRef(BF),UF=VF;function HF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17.25 9.75L19.5 12m0 0l2.25 2.25M19.5 12l2.25-2.25M19.5 12l-2.25 2.25m-10.5-6l4.72-4.72a.75.75 0 011.28.531V19.94a.75.75 0 01-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.506-1.938-1.354A9.01 9.01 0 012.25 12c0-.83.112-1.633.322-2.395C2.806 8.757 3.63 8.25 4.51 8.25H6.75z"}))}const GF=h.forwardRef(HF),WF=GF;function qF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 16.875h3.375m0 0h3.375m-3.375 0V13.5m0 3.375v3.375M6 10.5h2.25a2.25 2.25 0 002.25-2.25V6a2.25 2.25 0 00-2.25-2.25H6A2.25 2.25 0 003.75 6v2.25A2.25 2.25 0 006 10.5zm0 9.75h2.25A2.25 2.25 0 0010.5 18v-2.25a2.25 2.25 0 00-2.25-2.25H6a2.25 2.25 0 00-2.25 2.25V18A2.25 2.25 0 006 20.25zm9.75-9.75H18a2.25 2.25 0 002.25-2.25V6A2.25 2.25 0 0018 3.75h-2.25A2.25 2.25 0 0013.5 6v2.25a2.25 2.25 0 002.25 2.25z"}))}const KF=h.forwardRef(qF),Hp=KF;function QF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 7.5A2.25 2.25 0 017.5 5.25h9a2.25 2.25 0 012.25 2.25v9a2.25 2.25 0 01-2.25 2.25h-9a2.25 2.25 0 01-2.25-2.25v-9z"}))}const XF=h.forwardRef(QF),z1=XF;function YF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"}))}const JF=h.forwardRef(YF),xt=JF;function ZF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z"}))}const eM=h.forwardRef(ZF),Iy=eM;function tM({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"}))}const nM=h.forwardRef(tM),ol=nM,rM=Bc("inline-flex space-x-1 font-semibold items-center ",{variants:{variant:{default:"",circle:"rounded-full",list:"flex items-center py-[5px] w-full",outline:"border rounded-full",primary:""},color:{primary:"bg-[--primary-cl] text-white",clear:""},size:{primary:"px-4 py-1.5",small:"px-2 py-1",half:"w-1/2",full:"w-full",clear:""},rounded:{full:"rounded-full",md:"rounded-md",clear:""},hover:{default:"hover:brightness-90",scale:"transition-transform hover:scale-[1.05]",clear:""}},defaultVariants:{variant:"default",size:"primary",hover:"default",rounded:"full",color:"clear"}});function sM({className:t,children:e,variant:n,size:r,disabled:s,isLoading:i,rounded:o,color:l,hover:c,onClick:u,...d},f){return a.jsxs("button",{ref:f,type:"button",onClick:p=>u?u(p):"",...d,className:`${rM({color:l,variant:n,size:r,hover:c,rounded:o,className:t})}`,disabled:i||s,children:[i?a.jsx(Me,{className:"w-6 animate-spin"}):null,!i&&e]})}const ce=h.forwardRef(sM),xc='border w-full placeholder:[#666] rounded-md outline-none py-1.5 px-2 bg-[--a-5-cl] border-[--a-5-cl] "',iM=Bc("w-full",{variants:{variant:{primary:xc,clear:""},rounded:{xl:"rounded-xl",lg:"rounded-lg",md:"rounded-md"}},defaultVariants:{variant:"primary",rounded:"md"}});function aM({variant:t,className:e="",...n},r){return a.jsx("input",{ref:r,className:` ${iM({variant:t,className:e})}`,...n})}const En=h.forwardRef(aM);function FT({closeModal:t,cbWhenSubmit:e,title:n,initValue:r="",loading:s,variant:i="input",children:o}){const[l,c]=h.useState(r||""),u=h.useRef(null),d=h.useRef(!1),f=h.useMemo(()=>l.trim()&&l!==r,[l]),p=g=>{g.preventDefault(),f&&(d.current||(d.current=!0,e(l)))};return h.useEffect(()=>{var g;(g=u.current)==null||g.focus()},[]),a.jsxs(je,{children:[a.jsx(qe,{closeModal:t,title:n}),a.jsxs("form",{action:"",onSubmit:p,children:[i==="input"&&a.jsx("input",{className:xc,ref:u,placeholder:"name...",value:l,onChange:g=>c(g.target.value)}),i==="text-area"&&a.jsx("textarea",{className:xc,value:l,onChange:g=>c(g.target.value)}),o,a.jsx("p",{className:"text-right mt-3",children:a.jsx(ce,{type:"submit",variant:"primary",isLoading:s,color:"primary",className:`rounded-full self-end mt-[15px] ${f?"":"disable"}`,children:"Save"})})]})]})}function MT({closeModal:t}){return a.jsxs(je,{children:[a.jsx(qe,{closeModal:t,title:"HD MP3"}),a.jsxs("p",{children:[a.jsx("span",{className:"font-[500]",children:"Technologies: "})," React, Tailwind Css, Google firebase"]})]})}const Lm=[{name:"White",id:"white",type:"light",border:"border-[#198585]",container:"bg-[#fff]"},{name:"Red",id:"red",type:"dark",border:"border-[#ca4954]",container:"bg-[#2e0f10]"},{name:"Black",id:"black",type:"dark",border:"border-[#198585]",container:"bg-[#1e1e1e]"},{name:"Deep blue",id:"deep_blue",type:"dark",border:"border-[#0c9e85]",container:"bg-[#0f1a2e]"},{name:"Light green",id:"light_green",type:"light",border:"border-[#198585]",container:"bg-[#ced9d9]"},{name:"Brown",id:"brown",type:"light",border:"border-[#644646]",container:"bg-white"}],DT=[{name:"Tet",id:"tet",type:"light",container:"bg-[#644646]",border:"bg-[#f7f0de]",image:"tet_theme_image.png"}],oM=()=>{const[t,e]=h.useState(null),[n,r]=h.useState(!0),[s,i]=h.useState(""),o=h.useRef(!1);return{user:t,setUser:e,loading:n,setLoading:r,updateUserData:c=>{e(u=>u?{...u,...c}:null)},justRegistered:o,spotifyToken:s,setSpotifyToken:i}},LT=h.createContext(null);function ye(){const t=h.useContext(LT);if(!t)throw new Error("auth context not Provided");return t}function lM({children:t}){return a.jsx(LT.Provider,{value:oM(),children:t})}const cM=6;function uM(){const[t,e]=h.useState({songs:[],playlists:[]}),[n,r]=h.useState([]),[s,i]=h.useState([]),[o,l]=h.useState([]),[c,u]=h.useState([]),[d,f]=h.useState([]),[p,g]=h.useState([]),[x,w]=h.useState(!0),v=h.useRef(!0),_=h.useRef(!0),b=h.useRef(!0),j=h.useRef(!0),T=h.useRef(!0),R=h.useRef(),M=h.useRef(!1);return{uploadedSongs:s,setUploadedSongs:i,ownPlaylists:c,setOwnPlaylists:u,favoritePlaylists:d,setFavoritePlaylists:f,favoriteSongs:o,setFavoriteSongs:l,sysSongPlaylist:t,setSysSongPlaylist:e,shouldFetchUserSongs:v,shouldFetchFavoriteSongs:_,shouldFetchOwnPlaylists:b,shouldFetchFavoritePlaylists:j,updateSong:I=>{const C=[...s],A=C.findIndex(D=>D.id===I.id);if(A!==-1){const D={...C[A]};Object.assign(D,I.song),C[A]=D,i(C)}},singers:p,setSingers:g,shouldFetchUserSingers:T,lastDoc:R,hasMore:x,setHasMore:w,checkEntireUser:M,genres:n,setGenres:r,resetPage:()=>{v.current=!0,R.current=void 0,w(!0)},PAGE_SIZE:cM}}const OT=h.createContext(null);function dM({children:t}){return a.jsx(OT.Provider,{value:uM(),children:t})}const yt=()=>{const t=h.useContext(OT);if(!t)throw new Error("SongContext not provided");return t};function $T(t,e){return function(){return t.apply(e,arguments)}}const{toString:hM}=Object.prototype,{getPrototypeOf:B1}=Object,Gp=(t=>e=>{const n=hM.call(e);return t[n]||(t[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),Ds=t=>(t=t.toLowerCase(),e=>Gp(e)===t),Wp=t=>e=>typeof e===t,{isArray:Vc}=Array,bd=Wp("undefined");function fM(t){return t!==null&&!bd(t)&&t.constructor!==null&&!bd(t.constructor)&&Dr(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const zT=Ds("ArrayBuffer");function mM(t){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&zT(t.buffer),e}const pM=Wp("string"),Dr=Wp("function"),BT=Wp("number"),qp=t=>t!==null&&typeof t=="object",gM=t=>t===!0||t===!1,Qf=t=>{if(Gp(t)!=="object")return!1;const e=B1(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},xM=Ds("Date"),yM=Ds("File"),vM=Ds("Blob"),wM=Ds("FileList"),_M=t=>qp(t)&&Dr(t.pipe),bM=t=>{let e;return t&&(typeof FormData=="function"&&t instanceof FormData||Dr(t.append)&&((e=Gp(t))==="formdata"||e==="object"&&Dr(t.toString)&&t.toString()==="[object FormData]"))},SM=Ds("URLSearchParams"),[EM,jM,kM,TM]=["ReadableStream","Request","Response","Headers"].map(Ds),IM=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Zd(t,e,{allOwnKeys:n=!1}={}){if(t===null||typeof t>"u")return;let r,s;if(typeof t!="object"&&(t=[t]),Vc(t))for(r=0,s=t.length;r<s;r++)e.call(null,t[r],r,t);else{const i=n?Object.getOwnPropertyNames(t):Object.keys(t),o=i.length;let l;for(r=0;r<o;r++)l=i[r],e.call(null,t[l],l,t)}}function VT(t,e){e=e.toLowerCase();const n=Object.keys(t);let r=n.length,s;for(;r-- >0;)if(s=n[r],e===s.toLowerCase())return s;return null}const Ao=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),UT=t=>!bd(t)&&t!==Ao;function Cy(){const{caseless:t}=UT(this)&&this||{},e={},n=(r,s)=>{const i=t&&VT(e,s)||s;Qf(e[i])&&Qf(r)?e[i]=Cy(e[i],r):Qf(r)?e[i]=Cy({},r):Vc(r)?e[i]=r.slice():e[i]=r};for(let r=0,s=arguments.length;r<s;r++)arguments[r]&&Zd(arguments[r],n);return e}const CM=(t,e,n,{allOwnKeys:r}={})=>(Zd(e,(s,i)=>{n&&Dr(s)?t[i]=$T(s,n):t[i]=s},{allOwnKeys:r}),t),RM=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),NM=(t,e,n,r)=>{t.prototype=Object.create(e.prototype,r),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),n&&Object.assign(t.prototype,n)},AM=(t,e,n,r)=>{let s,i,o;const l={};if(e=e||{},t==null)return e;do{for(s=Object.getOwnPropertyNames(t),i=s.length;i-- >0;)o=s[i],(!r||r(o,t,e))&&!l[o]&&(e[o]=t[o],l[o]=!0);t=n!==!1&&B1(t)}while(t&&(!n||n(t,e))&&t!==Object.prototype);return e},PM=(t,e,n)=>{t=String(t),(n===void 0||n>t.length)&&(n=t.length),n-=e.length;const r=t.indexOf(e,n);return r!==-1&&r===n},FM=t=>{if(!t)return null;if(Vc(t))return t;let e=t.length;if(!BT(e))return null;const n=new Array(e);for(;e-- >0;)n[e]=t[e];return n},MM=(t=>e=>t&&e instanceof t)(typeof Uint8Array<"u"&&B1(Uint8Array)),DM=(t,e)=>{const r=(t&&t[Symbol.iterator]).call(t);let s;for(;(s=r.next())&&!s.done;){const i=s.value;e.call(t,i[0],i[1])}},LM=(t,e)=>{let n;const r=[];for(;(n=t.exec(e))!==null;)r.push(n);return r},OM=Ds("HTMLFormElement"),$M=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,r,s){return r.toUpperCase()+s}),ob=(({hasOwnProperty:t})=>(e,n)=>t.call(e,n))(Object.prototype),zM=Ds("RegExp"),HT=(t,e)=>{const n=Object.getOwnPropertyDescriptors(t),r={};Zd(n,(s,i)=>{let o;(o=e(s,i,t))!==!1&&(r[i]=o||s)}),Object.defineProperties(t,r)},BM=t=>{HT(t,(e,n)=>{if(Dr(t)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const r=t[n];if(Dr(r)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},VM=(t,e)=>{const n={},r=s=>{s.forEach(i=>{n[i]=!0})};return Vc(t)?r(t):r(String(t).split(e)),n},UM=()=>{},HM=(t,e)=>t!=null&&Number.isFinite(t=+t)?t:e;function GM(t){return!!(t&&Dr(t.append)&&t[Symbol.toStringTag]==="FormData"&&t[Symbol.iterator])}const WM=t=>{const e=new Array(10),n=(r,s)=>{if(qp(r)){if(e.indexOf(r)>=0)return;if(!("toJSON"in r)){e[s]=r;const i=Vc(r)?[]:{};return Zd(r,(o,l)=>{const c=n(o,s+1);!bd(c)&&(i[l]=c)}),e[s]=void 0,i}}return r};return n(t,0)},qM=Ds("AsyncFunction"),KM=t=>t&&(qp(t)||Dr(t))&&Dr(t.then)&&Dr(t.catch),GT=((t,e)=>t?setImmediate:e?((n,r)=>(Ao.addEventListener("message",({source:s,data:i})=>{s===Ao&&i===n&&r.length&&r.shift()()},!1),s=>{r.push(s),Ao.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",Dr(Ao.postMessage)),QM=typeof queueMicrotask<"u"?queueMicrotask.bind(Ao):typeof process<"u"&&process.nextTick||GT,z={isArray:Vc,isArrayBuffer:zT,isBuffer:fM,isFormData:bM,isArrayBufferView:mM,isString:pM,isNumber:BT,isBoolean:gM,isObject:qp,isPlainObject:Qf,isReadableStream:EM,isRequest:jM,isResponse:kM,isHeaders:TM,isUndefined:bd,isDate:xM,isFile:yM,isBlob:vM,isRegExp:zM,isFunction:Dr,isStream:_M,isURLSearchParams:SM,isTypedArray:MM,isFileList:wM,forEach:Zd,merge:Cy,extend:CM,trim:IM,stripBOM:RM,inherits:NM,toFlatObject:AM,kindOf:Gp,kindOfTest:Ds,endsWith:PM,toArray:FM,forEachEntry:DM,matchAll:LM,isHTMLForm:OM,hasOwnProperty:ob,hasOwnProp:ob,reduceDescriptors:HT,freezeMethods:BM,toObjectSet:VM,toCamelCase:$M,noop:UM,toFiniteNumber:HM,findKey:VT,global:Ao,isContextDefined:UT,isSpecCompliantForm:GM,toJSONObject:WM,isAsyncFn:qM,isThenable:KM,setImmediate:GT,asap:QM};function Ne(t,e,n,r,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",e&&(this.code=e),n&&(this.config=n),r&&(this.request=r),s&&(this.response=s,this.status=s.status?s.status:null)}z.inherits(Ne,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:z.toJSONObject(this.config),code:this.code,status:this.status}}});const WT=Ne.prototype,qT={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{qT[t]={value:t}});Object.defineProperties(Ne,qT);Object.defineProperty(WT,"isAxiosError",{value:!0});Ne.from=(t,e,n,r,s,i)=>{const o=Object.create(WT);return z.toFlatObject(t,o,function(c){return c!==Error.prototype},l=>l!=="isAxiosError"),Ne.call(o,t.message,e,n,r,s),o.cause=t,o.name=t.name,i&&Object.assign(o,i),o};const XM=null;function Ry(t){return z.isPlainObject(t)||z.isArray(t)}function KT(t){return z.endsWith(t,"[]")?t.slice(0,-2):t}function lb(t,e,n){return t?t.concat(e).map(function(s,i){return s=KT(s),!n&&i?"["+s+"]":s}).join(n?".":""):e}function YM(t){return z.isArray(t)&&!t.some(Ry)}const JM=z.toFlatObject(z,{},null,function(e){return/^is[A-Z]/.test(e)});function Kp(t,e,n){if(!z.isObject(t))throw new TypeError("target must be an object");e=e||new FormData,n=z.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(w,v){return!z.isUndefined(v[w])});const r=n.metaTokens,s=n.visitor||d,i=n.dots,o=n.indexes,c=(n.Blob||typeof Blob<"u"&&Blob)&&z.isSpecCompliantForm(e);if(!z.isFunction(s))throw new TypeError("visitor must be a function");function u(x){if(x===null)return"";if(z.isDate(x))return x.toISOString();if(!c&&z.isBlob(x))throw new Ne("Blob is not supported. Use a Buffer instead.");return z.isArrayBuffer(x)||z.isTypedArray(x)?c&&typeof Blob=="function"?new Blob([x]):Buffer.from(x):x}function d(x,w,v){let _=x;if(x&&!v&&typeof x=="object"){if(z.endsWith(w,"{}"))w=r?w:w.slice(0,-2),x=JSON.stringify(x);else if(z.isArray(x)&&YM(x)||(z.isFileList(x)||z.endsWith(w,"[]"))&&(_=z.toArray(x)))return w=KT(w),_.forEach(function(j,T){!(z.isUndefined(j)||j===null)&&e.append(o===!0?lb([w],T,i):o===null?w:w+"[]",u(j))}),!1}return Ry(x)?!0:(e.append(lb(v,w,i),u(x)),!1)}const f=[],p=Object.assign(JM,{defaultVisitor:d,convertValue:u,isVisitable:Ry});function g(x,w){if(!z.isUndefined(x)){if(f.indexOf(x)!==-1)throw Error("Circular reference detected in "+w.join("."));f.push(x),z.forEach(x,function(_,b){(!(z.isUndefined(_)||_===null)&&s.call(e,_,z.isString(b)?b.trim():b,w,p))===!0&&g(_,w?w.concat(b):[b])}),f.pop()}}if(!z.isObject(t))throw new TypeError("data must be an object");return g(t),e}function cb(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(r){return e[r]})}function V1(t,e){this._pairs=[],t&&Kp(t,this,e)}const QT=V1.prototype;QT.append=function(e,n){this._pairs.push([e,n])};QT.toString=function(e){const n=e?function(r){return e.call(this,r,cb)}:cb;return this._pairs.map(function(s){return n(s[0])+"="+n(s[1])},"").join("&")};function ZM(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function XT(t,e,n){if(!e)return t;const r=n&&n.encode||ZM;z.isFunction(n)&&(n={serialize:n});const s=n&&n.serialize;let i;if(s?i=s(e,n):i=z.isURLSearchParams(e)?e.toString():new V1(e,n).toString(r),i){const o=t.indexOf("#");o!==-1&&(t=t.slice(0,o)),t+=(t.indexOf("?")===-1?"?":"&")+i}return t}class e8{constructor(){this.handlers=[]}use(e,n,r){return this.handlers.push({fulfilled:e,rejected:n,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){z.forEach(this.handlers,function(r){r!==null&&e(r)})}}const ub=e8,YT={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},t8=typeof URLSearchParams<"u"?URLSearchParams:V1,n8=typeof FormData<"u"?FormData:null,r8=typeof Blob<"u"?Blob:null,s8={isBrowser:!0,classes:{URLSearchParams:t8,FormData:n8,Blob:r8},protocols:["http","https","file","blob","url","data"]},U1=typeof window<"u"&&typeof document<"u",Ny=typeof navigator=="object"&&navigator||void 0,i8=U1&&(!Ny||["ReactNative","NativeScript","NS"].indexOf(Ny.product)<0),a8=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),o8=U1&&window.location.href||"http://localhost",l8=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:U1,hasStandardBrowserEnv:i8,hasStandardBrowserWebWorkerEnv:a8,navigator:Ny,origin:o8},Symbol.toStringTag,{value:"Module"})),Vn={...l8,...s8};function c8(t,e){return Kp(t,new Vn.classes.URLSearchParams,Object.assign({visitor:function(n,r,s,i){return Vn.isNode&&z.isBuffer(n)?(this.append(r,n.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)}},e))}function u8(t){return z.matchAll(/\w+|\[(\w*)]/g,t).map(e=>e[0]==="[]"?"":e[1]||e[0])}function d8(t){const e={},n=Object.keys(t);let r;const s=n.length;let i;for(r=0;r<s;r++)i=n[r],e[i]=t[i];return e}function JT(t){function e(n,r,s,i){let o=n[i++];if(o==="__proto__")return!0;const l=Number.isFinite(+o),c=i>=n.length;return o=!o&&z.isArray(s)?s.length:o,c?(z.hasOwnProp(s,o)?s[o]=[s[o],r]:s[o]=r,!l):((!s[o]||!z.isObject(s[o]))&&(s[o]=[]),e(n,r,s[o],i)&&z.isArray(s[o])&&(s[o]=d8(s[o])),!l)}if(z.isFormData(t)&&z.isFunction(t.entries)){const n={};return z.forEachEntry(t,(r,s)=>{e(u8(r),s,n,0)}),n}return null}function h8(t,e,n){if(z.isString(t))try{return(e||JSON.parse)(t),z.trim(t)}catch(r){if(r.name!=="SyntaxError")throw r}return(n||JSON.stringify)(t)}const H1={transitional:YT,adapter:["xhr","http","fetch"],transformRequest:[function(e,n){const r=n.getContentType()||"",s=r.indexOf("application/json")>-1,i=z.isObject(e);if(i&&z.isHTMLForm(e)&&(e=new FormData(e)),z.isFormData(e))return s?JSON.stringify(JT(e)):e;if(z.isArrayBuffer(e)||z.isBuffer(e)||z.isStream(e)||z.isFile(e)||z.isBlob(e)||z.isReadableStream(e))return e;if(z.isArrayBufferView(e))return e.buffer;if(z.isURLSearchParams(e))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let l;if(i){if(r.indexOf("application/x-www-form-urlencoded")>-1)return c8(e,this.formSerializer).toString();if((l=z.isFileList(e))||r.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return Kp(l?{"files[]":e}:e,c&&new c,this.formSerializer)}}return i||s?(n.setContentType("application/json",!1),h8(e)):e}],transformResponse:[function(e){const n=this.transitional||H1.transitional,r=n&&n.forcedJSONParsing,s=this.responseType==="json";if(z.isResponse(e)||z.isReadableStream(e))return e;if(e&&z.isString(e)&&(r&&!this.responseType||s)){const o=!(n&&n.silentJSONParsing)&&s;try{return JSON.parse(e)}catch(l){if(o)throw l.name==="SyntaxError"?Ne.from(l,Ne.ERR_BAD_RESPONSE,this,null,this.response):l}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Vn.classes.FormData,Blob:Vn.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};z.forEach(["delete","get","head","post","put","patch"],t=>{H1.headers[t]={}});const G1=H1,f8=z.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),m8=t=>{const e={};let n,r,s;return t&&t.split(`
`).forEach(function(o){s=o.indexOf(":"),n=o.substring(0,s).trim().toLowerCase(),r=o.substring(s+1).trim(),!(!n||e[n]&&f8[n])&&(n==="set-cookie"?e[n]?e[n].push(r):e[n]=[r]:e[n]=e[n]?e[n]+", "+r:r)}),e},db=Symbol("internals");function Ru(t){return t&&String(t).trim().toLowerCase()}function Xf(t){return t===!1||t==null?t:z.isArray(t)?t.map(Xf):String(t)}function p8(t){const e=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(t);)e[r[1]]=r[2];return e}const g8=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function V0(t,e,n,r,s){if(z.isFunction(r))return r.call(this,e,n);if(s&&(e=n),!!z.isString(e)){if(z.isString(r))return e.indexOf(r)!==-1;if(z.isRegExp(r))return r.test(e)}}function x8(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,n,r)=>n.toUpperCase()+r)}function y8(t,e){const n=z.toCamelCase(" "+e);["get","set","has"].forEach(r=>{Object.defineProperty(t,r+n,{value:function(s,i,o){return this[r].call(this,e,s,i,o)},configurable:!0})})}class Qp{constructor(e){e&&this.set(e)}set(e,n,r){const s=this;function i(l,c,u){const d=Ru(c);if(!d)throw new Error("header name must be a non-empty string");const f=z.findKey(s,d);(!f||s[f]===void 0||u===!0||u===void 0&&s[f]!==!1)&&(s[f||c]=Xf(l))}const o=(l,c)=>z.forEach(l,(u,d)=>i(u,d,c));if(z.isPlainObject(e)||e instanceof this.constructor)o(e,n);else if(z.isString(e)&&(e=e.trim())&&!g8(e))o(m8(e),n);else if(z.isHeaders(e))for(const[l,c]of e.entries())i(c,l,r);else e!=null&&i(n,e,r);return this}get(e,n){if(e=Ru(e),e){const r=z.findKey(this,e);if(r){const s=this[r];if(!n)return s;if(n===!0)return p8(s);if(z.isFunction(n))return n.call(this,s,r);if(z.isRegExp(n))return n.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,n){if(e=Ru(e),e){const r=z.findKey(this,e);return!!(r&&this[r]!==void 0&&(!n||V0(this,this[r],r,n)))}return!1}delete(e,n){const r=this;let s=!1;function i(o){if(o=Ru(o),o){const l=z.findKey(r,o);l&&(!n||V0(r,r[l],l,n))&&(delete r[l],s=!0)}}return z.isArray(e)?e.forEach(i):i(e),s}clear(e){const n=Object.keys(this);let r=n.length,s=!1;for(;r--;){const i=n[r];(!e||V0(this,this[i],i,e,!0))&&(delete this[i],s=!0)}return s}normalize(e){const n=this,r={};return z.forEach(this,(s,i)=>{const o=z.findKey(r,i);if(o){n[o]=Xf(s),delete n[i];return}const l=e?x8(i):String(i).trim();l!==i&&delete n[i],n[l]=Xf(s),r[l]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const n=Object.create(null);return z.forEach(this,(r,s)=>{r!=null&&r!==!1&&(n[s]=e&&z.isArray(r)?r.join(", "):r)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,n])=>e+": "+n).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...n){const r=new this(e);return n.forEach(s=>r.set(s)),r}static accessor(e){const r=(this[db]=this[db]={accessors:{}}).accessors,s=this.prototype;function i(o){const l=Ru(o);r[l]||(y8(s,o),r[l]=!0)}return z.isArray(e)?e.forEach(i):i(e),this}}Qp.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);z.reduceDescriptors(Qp.prototype,({value:t},e)=>{let n=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(r){this[n]=r}}});z.freezeMethods(Qp);const Rs=Qp;function U0(t,e){const n=this||G1,r=e||n,s=Rs.from(r.headers);let i=r.data;return z.forEach(t,function(l){i=l.call(n,i,s.normalize(),e?e.status:void 0)}),s.normalize(),i}function ZT(t){return!!(t&&t.__CANCEL__)}function Uc(t,e,n){Ne.call(this,t??"canceled",Ne.ERR_CANCELED,e,n),this.name="CanceledError"}z.inherits(Uc,Ne,{__CANCEL__:!0});function eI(t,e,n){const r=n.config.validateStatus;!n.status||!r||r(n.status)?t(n):e(new Ne("Request failed with status code "+n.status,[Ne.ERR_BAD_REQUEST,Ne.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function v8(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}function w8(t,e){t=t||10;const n=new Array(t),r=new Array(t);let s=0,i=0,o;return e=e!==void 0?e:1e3,function(c){const u=Date.now(),d=r[i];o||(o=u),n[s]=c,r[s]=u;let f=i,p=0;for(;f!==s;)p+=n[f++],f=f%t;if(s=(s+1)%t,s===i&&(i=(i+1)%t),u-o<e)return;const g=d&&u-d;return g?Math.round(p*1e3/g):void 0}}function _8(t,e){let n=0,r=1e3/e,s,i;const o=(u,d=Date.now())=>{n=d,s=null,i&&(clearTimeout(i),i=null),t.apply(null,u)};return[(...u)=>{const d=Date.now(),f=d-n;f>=r?o(u,d):(s=u,i||(i=setTimeout(()=>{i=null,o(s)},r-f)))},()=>s&&o(s)]}const Om=(t,e,n=3)=>{let r=0;const s=w8(50,250);return _8(i=>{const o=i.loaded,l=i.lengthComputable?i.total:void 0,c=o-r,u=s(c),d=o<=l;r=o;const f={loaded:o,total:l,progress:l?o/l:void 0,bytes:c,rate:u||void 0,estimated:u&&l&&d?(l-o)/u:void 0,event:i,lengthComputable:l!=null,[e?"download":"upload"]:!0};t(f)},n)},hb=(t,e)=>{const n=t!=null;return[r=>e[0]({lengthComputable:n,total:t,loaded:r}),e[1]]},fb=t=>(...e)=>z.asap(()=>t(...e)),b8=Vn.hasStandardBrowserEnv?((t,e)=>n=>(n=new URL(n,Vn.origin),t.protocol===n.protocol&&t.host===n.host&&(e||t.port===n.port)))(new URL(Vn.origin),Vn.navigator&&/(msie|trident)/i.test(Vn.navigator.userAgent)):()=>!0,S8=Vn.hasStandardBrowserEnv?{write(t,e,n,r,s,i){const o=[t+"="+encodeURIComponent(e)];z.isNumber(n)&&o.push("expires="+new Date(n).toGMTString()),z.isString(r)&&o.push("path="+r),z.isString(s)&&o.push("domain="+s),i===!0&&o.push("secure"),document.cookie=o.join("; ")},read(t){const e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function E8(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function j8(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}function tI(t,e,n){let r=!E8(e);return t&&r||n==!1?j8(t,e):e}const mb=t=>t instanceof Rs?{...t}:t;function Ho(t,e){e=e||{};const n={};function r(u,d,f,p){return z.isPlainObject(u)&&z.isPlainObject(d)?z.merge.call({caseless:p},u,d):z.isPlainObject(d)?z.merge({},d):z.isArray(d)?d.slice():d}function s(u,d,f,p){if(z.isUndefined(d)){if(!z.isUndefined(u))return r(void 0,u,f,p)}else return r(u,d,f,p)}function i(u,d){if(!z.isUndefined(d))return r(void 0,d)}function o(u,d){if(z.isUndefined(d)){if(!z.isUndefined(u))return r(void 0,u)}else return r(void 0,d)}function l(u,d,f){if(f in e)return r(u,d);if(f in t)return r(void 0,u)}const c={url:i,method:i,data:i,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:l,headers:(u,d,f)=>s(mb(u),mb(d),f,!0)};return z.forEach(Object.keys(Object.assign({},t,e)),function(d){const f=c[d]||s,p=f(t[d],e[d],d);z.isUndefined(p)&&f!==l||(n[d]=p)}),n}const nI=t=>{const e=Ho({},t);let{data:n,withXSRFToken:r,xsrfHeaderName:s,xsrfCookieName:i,headers:o,auth:l}=e;e.headers=o=Rs.from(o),e.url=XT(tI(e.baseURL,e.url),t.params,t.paramsSerializer),l&&o.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):"")));let c;if(z.isFormData(n)){if(Vn.hasStandardBrowserEnv||Vn.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((c=o.getContentType())!==!1){const[u,...d]=c?c.split(";").map(f=>f.trim()).filter(Boolean):[];o.setContentType([u||"multipart/form-data",...d].join("; "))}}if(Vn.hasStandardBrowserEnv&&(r&&z.isFunction(r)&&(r=r(e)),r||r!==!1&&b8(e.url))){const u=s&&i&&S8.read(i);u&&o.set(s,u)}return e},k8=typeof XMLHttpRequest<"u",T8=k8&&function(t){return new Promise(function(n,r){const s=nI(t);let i=s.data;const o=Rs.from(s.headers).normalize();let{responseType:l,onUploadProgress:c,onDownloadProgress:u}=s,d,f,p,g,x;function w(){g&&g(),x&&x(),s.cancelToken&&s.cancelToken.unsubscribe(d),s.signal&&s.signal.removeEventListener("abort",d)}let v=new XMLHttpRequest;v.open(s.method.toUpperCase(),s.url,!0),v.timeout=s.timeout;function _(){if(!v)return;const j=Rs.from("getAllResponseHeaders"in v&&v.getAllResponseHeaders()),R={data:!l||l==="text"||l==="json"?v.responseText:v.response,status:v.status,statusText:v.statusText,headers:j,config:t,request:v};eI(function(k){n(k),w()},function(k){r(k),w()},R),v=null}"onloadend"in v?v.onloadend=_:v.onreadystatechange=function(){!v||v.readyState!==4||v.status===0&&!(v.responseURL&&v.responseURL.indexOf("file:")===0)||setTimeout(_)},v.onabort=function(){v&&(r(new Ne("Request aborted",Ne.ECONNABORTED,t,v)),v=null)},v.onerror=function(){r(new Ne("Network Error",Ne.ERR_NETWORK,t,v)),v=null},v.ontimeout=function(){let T=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const R=s.transitional||YT;s.timeoutErrorMessage&&(T=s.timeoutErrorMessage),r(new Ne(T,R.clarifyTimeoutError?Ne.ETIMEDOUT:Ne.ECONNABORTED,t,v)),v=null},i===void 0&&o.setContentType(null),"setRequestHeader"in v&&z.forEach(o.toJSON(),function(T,R){v.setRequestHeader(R,T)}),z.isUndefined(s.withCredentials)||(v.withCredentials=!!s.withCredentials),l&&l!=="json"&&(v.responseType=s.responseType),u&&([p,x]=Om(u,!0),v.addEventListener("progress",p)),c&&v.upload&&([f,g]=Om(c),v.upload.addEventListener("progress",f),v.upload.addEventListener("loadend",g)),(s.cancelToken||s.signal)&&(d=j=>{v&&(r(!j||j.type?new Uc(null,t,v):j),v.abort(),v=null)},s.cancelToken&&s.cancelToken.subscribe(d),s.signal&&(s.signal.aborted?d():s.signal.addEventListener("abort",d)));const b=v8(s.url);if(b&&Vn.protocols.indexOf(b)===-1){r(new Ne("Unsupported protocol "+b+":",Ne.ERR_BAD_REQUEST,t));return}v.send(i||null)})},I8=(t,e)=>{const{length:n}=t=t?t.filter(Boolean):[];if(e||n){let r=new AbortController,s;const i=function(u){if(!s){s=!0,l();const d=u instanceof Error?u:this.reason;r.abort(d instanceof Ne?d:new Uc(d instanceof Error?d.message:d))}};let o=e&&setTimeout(()=>{o=null,i(new Ne(`timeout ${e} of ms exceeded`,Ne.ETIMEDOUT))},e);const l=()=>{t&&(o&&clearTimeout(o),o=null,t.forEach(u=>{u.unsubscribe?u.unsubscribe(i):u.removeEventListener("abort",i)}),t=null)};t.forEach(u=>u.addEventListener("abort",i));const{signal:c}=r;return c.unsubscribe=()=>z.asap(l),c}},C8=I8,R8=function*(t,e){let n=t.byteLength;if(!e||n<e){yield t;return}let r=0,s;for(;r<n;)s=r+e,yield t.slice(r,s),r=s},N8=async function*(t,e){for await(const n of A8(t))yield*R8(n,e)},A8=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const e=t.getReader();try{for(;;){const{done:n,value:r}=await e.read();if(n)break;yield r}}finally{await e.cancel()}},pb=(t,e,n,r)=>{const s=N8(t,e);let i=0,o,l=c=>{o||(o=!0,r&&r(c))};return new ReadableStream({async pull(c){try{const{done:u,value:d}=await s.next();if(u){l(),c.close();return}let f=d.byteLength;if(n){let p=i+=f;n(p)}c.enqueue(new Uint8Array(d))}catch(u){throw l(u),u}},cancel(c){return l(c),s.return()}},{highWaterMark:2})},Xp=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",rI=Xp&&typeof ReadableStream=="function",P8=Xp&&(typeof TextEncoder=="function"?(t=>e=>t.encode(e))(new TextEncoder):async t=>new Uint8Array(await new Response(t).arrayBuffer())),sI=(t,...e)=>{try{return!!t(...e)}catch{return!1}},F8=rI&&sI(()=>{let t=!1;const e=new Request(Vn.origin,{body:new ReadableStream,method:"POST",get duplex(){return t=!0,"half"}}).headers.has("Content-Type");return t&&!e}),gb=64*1024,Ay=rI&&sI(()=>z.isReadableStream(new Response("").body)),$m={stream:Ay&&(t=>t.body)};Xp&&(t=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!$m[e]&&($m[e]=z.isFunction(t[e])?n=>n[e]():(n,r)=>{throw new Ne(`Response type '${e}' is not supported`,Ne.ERR_NOT_SUPPORT,r)})})})(new Response);const M8=async t=>{if(t==null)return 0;if(z.isBlob(t))return t.size;if(z.isSpecCompliantForm(t))return(await new Request(Vn.origin,{method:"POST",body:t}).arrayBuffer()).byteLength;if(z.isArrayBufferView(t)||z.isArrayBuffer(t))return t.byteLength;if(z.isURLSearchParams(t)&&(t=t+""),z.isString(t))return(await P8(t)).byteLength},D8=async(t,e)=>{const n=z.toFiniteNumber(t.getContentLength());return n??M8(e)},L8=Xp&&(async t=>{let{url:e,method:n,data:r,signal:s,cancelToken:i,timeout:o,onDownloadProgress:l,onUploadProgress:c,responseType:u,headers:d,withCredentials:f="same-origin",fetchOptions:p}=nI(t);u=u?(u+"").toLowerCase():"text";let g=C8([s,i&&i.toAbortSignal()],o),x;const w=g&&g.unsubscribe&&(()=>{g.unsubscribe()});let v;try{if(c&&F8&&n!=="get"&&n!=="head"&&(v=await D8(d,r))!==0){let R=new Request(e,{method:"POST",body:r,duplex:"half"}),M;if(z.isFormData(r)&&(M=R.headers.get("content-type"))&&d.setContentType(M),R.body){const[k,E]=hb(v,Om(fb(c)));r=pb(R.body,gb,k,E)}}z.isString(f)||(f=f?"include":"omit");const _="credentials"in Request.prototype;x=new Request(e,{...p,signal:g,method:n.toUpperCase(),headers:d.normalize().toJSON(),body:r,duplex:"half",credentials:_?f:void 0});let b=await fetch(x);const j=Ay&&(u==="stream"||u==="response");if(Ay&&(l||j&&w)){const R={};["status","statusText","headers"].forEach(I=>{R[I]=b[I]});const M=z.toFiniteNumber(b.headers.get("content-length")),[k,E]=l&&hb(M,Om(fb(l),!0))||[];b=new Response(pb(b.body,gb,k,()=>{E&&E(),w&&w()}),R)}u=u||"text";let T=await $m[z.findKey($m,u)||"text"](b,t);return!j&&w&&w(),await new Promise((R,M)=>{eI(R,M,{data:T,headers:Rs.from(b.headers),status:b.status,statusText:b.statusText,config:t,request:x})})}catch(_){throw w&&w(),_&&_.name==="TypeError"&&/fetch/i.test(_.message)?Object.assign(new Ne("Network Error",Ne.ERR_NETWORK,t,x),{cause:_.cause||_}):Ne.from(_,_&&_.code,t,x)}}),Py={http:XM,xhr:T8,fetch:L8};z.forEach(Py,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch{}Object.defineProperty(t,"adapterName",{value:e})}});const xb=t=>`- ${t}`,O8=t=>z.isFunction(t)||t===null||t===!1,iI={getAdapter:t=>{t=z.isArray(t)?t:[t];const{length:e}=t;let n,r;const s={};for(let i=0;i<e;i++){n=t[i];let o;if(r=n,!O8(n)&&(r=Py[(o=String(n)).toLowerCase()],r===void 0))throw new Ne(`Unknown adapter '${o}'`);if(r)break;s[o||"#"+i]=r}if(!r){const i=Object.entries(s).map(([l,c])=>`adapter ${l} `+(c===!1?"is not supported by the environment":"is not available in the build"));let o=e?i.length>1?`since :
`+i.map(xb).join(`
`):" "+xb(i[0]):"as no adapter specified";throw new Ne("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return r},adapters:Py};function H0(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new Uc(null,t)}function yb(t){return H0(t),t.headers=Rs.from(t.headers),t.data=U0.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),iI.getAdapter(t.adapter||G1.adapter)(t).then(function(r){return H0(t),r.data=U0.call(t,t.transformResponse,r),r.headers=Rs.from(r.headers),r},function(r){return ZT(r)||(H0(t),r&&r.response&&(r.response.data=U0.call(t,t.transformResponse,r.response),r.response.headers=Rs.from(r.response.headers))),Promise.reject(r)})}const aI="1.8.1",Yp={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{Yp[t]=function(r){return typeof r===t||"a"+(e<1?"n ":" ")+t}});const vb={};Yp.transitional=function(e,n,r){function s(i,o){return"[Axios v"+aI+"] Transitional option '"+i+"'"+o+(r?". "+r:"")}return(i,o,l)=>{if(e===!1)throw new Ne(s(o," has been removed"+(n?" in "+n:"")),Ne.ERR_DEPRECATED);return n&&!vb[o]&&(vb[o]=!0,console.warn(s(o," has been deprecated since v"+n+" and will be removed in the near future"))),e?e(i,o,l):!0}};Yp.spelling=function(e){return(n,r)=>(console.warn(`${r} is likely a misspelling of ${e}`),!0)};function $8(t,e,n){if(typeof t!="object")throw new Ne("options must be an object",Ne.ERR_BAD_OPTION_VALUE);const r=Object.keys(t);let s=r.length;for(;s-- >0;){const i=r[s],o=e[i];if(o){const l=t[i],c=l===void 0||o(l,i,t);if(c!==!0)throw new Ne("option "+i+" must be "+c,Ne.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new Ne("Unknown option "+i,Ne.ERR_BAD_OPTION)}}const Yf={assertOptions:$8,validators:Yp},Hs=Yf.validators;class zm{constructor(e){this.defaults=e,this.interceptors={request:new ub,response:new ub}}async request(e,n){try{return await this._request(e,n)}catch(r){if(r instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const i=s.stack?s.stack.replace(/^.+\n/,""):"";try{r.stack?i&&!String(r.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+i):r.stack=i}catch{}}throw r}}_request(e,n){typeof e=="string"?(n=n||{},n.url=e):n=e||{},n=Ho(this.defaults,n);const{transitional:r,paramsSerializer:s,headers:i}=n;r!==void 0&&Yf.assertOptions(r,{silentJSONParsing:Hs.transitional(Hs.boolean),forcedJSONParsing:Hs.transitional(Hs.boolean),clarifyTimeoutError:Hs.transitional(Hs.boolean)},!1),s!=null&&(z.isFunction(s)?n.paramsSerializer={serialize:s}:Yf.assertOptions(s,{encode:Hs.function,serialize:Hs.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),Yf.assertOptions(n,{baseUrl:Hs.spelling("baseURL"),withXsrfToken:Hs.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let o=i&&z.merge(i.common,i[n.method]);i&&z.forEach(["delete","get","head","post","put","patch","common"],x=>{delete i[x]}),n.headers=Rs.concat(o,i);const l=[];let c=!0;this.interceptors.request.forEach(function(w){typeof w.runWhen=="function"&&w.runWhen(n)===!1||(c=c&&w.synchronous,l.unshift(w.fulfilled,w.rejected))});const u=[];this.interceptors.response.forEach(function(w){u.push(w.fulfilled,w.rejected)});let d,f=0,p;if(!c){const x=[yb.bind(this),void 0];for(x.unshift.apply(x,l),x.push.apply(x,u),p=x.length,d=Promise.resolve(n);f<p;)d=d.then(x[f++],x[f++]);return d}p=l.length;let g=n;for(f=0;f<p;){const x=l[f++],w=l[f++];try{g=x(g)}catch(v){w.call(this,v);break}}try{d=yb.call(this,g)}catch(x){return Promise.reject(x)}for(f=0,p=u.length;f<p;)d=d.then(u[f++],u[f++]);return d}getUri(e){e=Ho(this.defaults,e);const n=tI(e.baseURL,e.url,e.allowAbsoluteUrls);return XT(n,e.params,e.paramsSerializer)}}z.forEach(["delete","get","head","options"],function(e){zm.prototype[e]=function(n,r){return this.request(Ho(r||{},{method:e,url:n,data:(r||{}).data}))}});z.forEach(["post","put","patch"],function(e){function n(r){return function(i,o,l){return this.request(Ho(l||{},{method:e,headers:r?{"Content-Type":"multipart/form-data"}:{},url:i,data:o}))}}zm.prototype[e]=n(),zm.prototype[e+"Form"]=n(!0)});const Jf=zm;class W1{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(i){n=i});const r=this;this.promise.then(s=>{if(!r._listeners)return;let i=r._listeners.length;for(;i-- >0;)r._listeners[i](s);r._listeners=null}),this.promise.then=s=>{let i;const o=new Promise(l=>{r.subscribe(l),i=l}).then(s);return o.cancel=function(){r.unsubscribe(i)},o},e(function(i,o,l){r.reason||(r.reason=new Uc(i,o,l),n(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const n=this._listeners.indexOf(e);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const e=new AbortController,n=r=>{e.abort(r)};return this.subscribe(n),e.signal.unsubscribe=()=>this.unsubscribe(n),e.signal}static source(){let e;return{token:new W1(function(s){e=s}),cancel:e}}}const z8=W1;function B8(t){return function(n){return t.apply(null,n)}}function V8(t){return z.isObject(t)&&t.isAxiosError===!0}const Fy={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Fy).forEach(([t,e])=>{Fy[e]=t});const U8=Fy;function oI(t){const e=new Jf(t),n=$T(Jf.prototype.request,e);return z.extend(n,Jf.prototype,e,{allOwnKeys:!0}),z.extend(n,e,null,{allOwnKeys:!0}),n.create=function(s){return oI(Ho(t,s))},n}const Ut=oI(G1);Ut.Axios=Jf;Ut.CanceledError=Uc;Ut.CancelToken=z8;Ut.isCancel=ZT;Ut.VERSION=aI;Ut.toFormData=Kp;Ut.AxiosError=Ne;Ut.Cancel=Ut.CanceledError;Ut.all=function(e){return Promise.all(e)};Ut.spread=B8;Ut.isAxiosError=V8;Ut.mergeConfig=Ho;Ut.AxiosHeaders=Rs;Ut.formToJSON=t=>JT(z.isHTMLForm(t)?new FormData(t):t);Ut.getAdapter=iI.getAdapter;Ut.HttpStatusCode=U8;Ut.default=Ut;const lI=Ut;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cI=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},H8=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],l=t[n++],c=((s&7)<<18|(i&63)<<12|(o&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},uI={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,l=o?t[s+1]:0,c=s+2<t.length,u=c?t[s+2]:0,d=i>>2,f=(i&3)<<4|l>>4;let p=(l&15)<<2|u>>6,g=u&63;c||(g=64,o||(p=64)),r.push(n[d],n[f],n[p],n[g])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(cI(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):H8(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],l=s<t.length?n[t.charAt(s)]:0;++s;const u=s<t.length?n[t.charAt(s)]:64;++s;const f=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||l==null||u==null||f==null)throw new G8;const p=i<<2|l>>4;if(r.push(p),u!==64){const g=l<<4&240|u>>2;if(r.push(g),f!==64){const x=u<<6&192|f;r.push(x)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class G8 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const W8=function(t){const e=cI(t);return uI.encodeByteArray(e,!0)},Bm=function(t){return W8(t).replace(/\./g,"")},dI=function(t){try{return uI.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q8(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K8=()=>q8().__FIREBASE_DEFAULTS__,Q8=()=>{if(typeof process>"u"||typeof process.env>"u")return;const t={}.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},X8=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&dI(t[1]);return e&&JSON.parse(e)},Jp=()=>{try{return K8()||Q8()||X8()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},hI=t=>{var e,n;return(n=(e=Jp())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},Y8=t=>{const e=hI(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},fI=()=>{var t;return(t=Jp())===null||t===void 0?void 0:t.config},mI=t=>{var e;return(e=Jp())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J8{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z8(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t),l="";return[Bm(JSON.stringify(n)),Bm(JSON.stringify(o)),l].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function eD(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Gn())}function tD(){var t;const e=(t=Jp())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function nD(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function rD(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function sD(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function iD(){const t=Gn();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function aD(){return!tD()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function oD(){try{return typeof indexedDB=="object"}catch{return!1}}function lD(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cD="FirebaseError";class Qi extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=cD,Object.setPrototypeOf(this,Qi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,eh.prototype.create)}}class eh{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?uD(i,r):"Error",l=`${this.serviceName}: ${o} (${s}).`;return new Qi(s,l,r)}}function uD(t,e){return t.replace(dD,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const dD=/\{\$([^}]+)}/g;function hD(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Vm(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(wb(i)&&wb(o)){if(!Vm(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function wb(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function th(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function fD(t,e){const n=new mD(t,e);return n.subscribe.bind(n)}class mD{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");pD(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=G0),s.error===void 0&&(s.error=G0),s.complete===void 0&&(s.complete=G0);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function pD(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function G0(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ht(t){return t&&t._delegate?t._delegate:t}class Go{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jo="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let gD=class{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new J8;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(yD(e))try{this.getOrInitializeService({instanceIdentifier:jo})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=jo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=jo){return this.instances.has(e)}getOptions(e=jo){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);r===l&&o.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:xD(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=jo){return this.component?this.component.multipleInstances?e:jo:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function xD(t){return t===jo?void 0:t}function yD(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vD{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new gD(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var $e;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})($e||($e={}));const wD={debug:$e.DEBUG,verbose:$e.VERBOSE,info:$e.INFO,warn:$e.WARN,error:$e.ERROR,silent:$e.SILENT},_D=$e.INFO,bD={[$e.DEBUG]:"log",[$e.VERBOSE]:"log",[$e.INFO]:"info",[$e.WARN]:"warn",[$e.ERROR]:"error"},SD=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=bD[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class q1{constructor(e){this.name=e,this._logLevel=_D,this._logHandler=SD,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in $e))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?wD[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,$e.DEBUG,...e),this._logHandler(this,$e.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,$e.VERBOSE,...e),this._logHandler(this,$e.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,$e.INFO,...e),this._logHandler(this,$e.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,$e.WARN,...e),this._logHandler(this,$e.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,$e.ERROR,...e),this._logHandler(this,$e.ERROR,...e)}}const ED=(t,e)=>e.some(n=>t instanceof n);let _b,bb;function jD(){return _b||(_b=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function kD(){return bb||(bb=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const pI=new WeakMap,My=new WeakMap,gI=new WeakMap,W0=new WeakMap,K1=new WeakMap;function TD(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(Fa(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&pI.set(n,t)}).catch(()=>{}),K1.set(e,t),e}function ID(t){if(My.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});My.set(t,e)}let Dy={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return My.get(t);if(e==="objectStoreNames")return t.objectStoreNames||gI.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Fa(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function CD(t){Dy=t(Dy)}function RD(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(q0(this),e,...n);return gI.set(r,e.sort?e.sort():[e]),Fa(r)}:kD().includes(t)?function(...e){return t.apply(q0(this),e),Fa(pI.get(this))}:function(...e){return Fa(t.apply(q0(this),e))}}function ND(t){return typeof t=="function"?RD(t):(t instanceof IDBTransaction&&ID(t),ED(t,jD())?new Proxy(t,Dy):t)}function Fa(t){if(t instanceof IDBRequest)return TD(t);if(W0.has(t))return W0.get(t);const e=ND(t);return e!==t&&(W0.set(t,e),K1.set(e,t)),e}const q0=t=>K1.get(t);function AD(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),l=Fa(o);return r&&o.addEventListener("upgradeneeded",c=>{r(Fa(o.result),c.oldVersion,c.newVersion,Fa(o.transaction),c)}),n&&o.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),l.then(c=>{i&&c.addEventListener("close",()=>i()),s&&c.addEventListener("versionchange",u=>s(u.oldVersion,u.newVersion,u))}).catch(()=>{}),l}const PD=["get","getKey","getAll","getAllKeys","count"],FD=["put","add","delete","clear"],K0=new Map;function Sb(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(K0.get(e))return K0.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=FD.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||PD.includes(n)))return;const i=async function(o,...l){const c=this.transaction(o,s?"readwrite":"readonly");let u=c.store;return r&&(u=u.index(l.shift())),(await Promise.all([u[n](...l),s&&c.done]))[0]};return K0.set(e,i),i}CD(t=>({...t,get:(e,n,r)=>Sb(e,n)||t.get(e,n,r),has:(e,n)=>!!Sb(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MD{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(DD(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function DD(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Ly="@firebase/app",Eb="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $i=new q1("@firebase/app"),LD="@firebase/app-compat",OD="@firebase/analytics-compat",$D="@firebase/analytics",zD="@firebase/app-check-compat",BD="@firebase/app-check",VD="@firebase/auth",UD="@firebase/auth-compat",HD="@firebase/database",GD="@firebase/data-connect",WD="@firebase/database-compat",qD="@firebase/functions",KD="@firebase/functions-compat",QD="@firebase/installations",XD="@firebase/installations-compat",YD="@firebase/messaging",JD="@firebase/messaging-compat",ZD="@firebase/performance",eL="@firebase/performance-compat",tL="@firebase/remote-config",nL="@firebase/remote-config-compat",rL="@firebase/storage",sL="@firebase/storage-compat",iL="@firebase/firestore",aL="@firebase/vertexai-preview",oL="@firebase/firestore-compat",lL="firebase",cL="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oy="[DEFAULT]",uL={[Ly]:"fire-core",[LD]:"fire-core-compat",[$D]:"fire-analytics",[OD]:"fire-analytics-compat",[BD]:"fire-app-check",[zD]:"fire-app-check-compat",[VD]:"fire-auth",[UD]:"fire-auth-compat",[HD]:"fire-rtdb",[GD]:"fire-data-connect",[WD]:"fire-rtdb-compat",[qD]:"fire-fn",[KD]:"fire-fn-compat",[QD]:"fire-iid",[XD]:"fire-iid-compat",[YD]:"fire-fcm",[JD]:"fire-fcm-compat",[ZD]:"fire-perf",[eL]:"fire-perf-compat",[tL]:"fire-rc",[nL]:"fire-rc-compat",[rL]:"fire-gcs",[sL]:"fire-gcs-compat",[iL]:"fire-fst",[oL]:"fire-fst-compat",[aL]:"fire-vertex","fire-js":"fire-js",[lL]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Um=new Map,dL=new Map,$y=new Map;function jb(t,e){try{t.container.addComponent(e)}catch(n){$i.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function yc(t){const e=t.name;if($y.has(e))return $i.debug(`There were multiple attempts to register component ${e}.`),!1;$y.set(e,t);for(const n of Um.values())jb(n,t);for(const n of dL.values())jb(n,t);return!0}function Q1(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function ji(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hL={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ma=new eh("app","Firebase",hL);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fL{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Go("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ma.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hc=cL;function xI(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:Oy,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw Ma.create("bad-app-name",{appName:String(s)});if(n||(n=fI()),!n)throw Ma.create("no-options");const i=Um.get(s);if(i){if(Vm(n,i.options)&&Vm(r,i.config))return i;throw Ma.create("duplicate-app",{appName:s})}const o=new vD(s);for(const c of $y.values())o.addComponent(c);const l=new fL(n,r,o);return Um.set(s,l),l}function yI(t=Oy){const e=Um.get(t);if(!e&&t===Oy&&fI())return xI();if(!e)throw Ma.create("no-app",{appName:t});return e}function Da(t,e,n){var r;let s=(r=uL[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const l=[`Unable to register library "${s}" with version "${e}":`];i&&l.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),$i.warn(l.join(" "));return}yc(new Go(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mL="firebase-heartbeat-database",pL=1,Sd="firebase-heartbeat-store";let Q0=null;function vI(){return Q0||(Q0=AD(mL,pL,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Sd)}catch(n){console.warn(n)}}}}).catch(t=>{throw Ma.create("idb-open",{originalErrorMessage:t.message})})),Q0}async function gL(t){try{const n=(await vI()).transaction(Sd),r=await n.objectStore(Sd).get(wI(t));return await n.done,r}catch(e){if(e instanceof Qi)$i.warn(e.message);else{const n=Ma.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});$i.warn(n.message)}}}async function kb(t,e){try{const r=(await vI()).transaction(Sd,"readwrite");await r.objectStore(Sd).put(e,wI(t)),await r.done}catch(n){if(n instanceof Qi)$i.warn(n.message);else{const r=Ma.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});$i.warn(r.message)}}}function wI(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xL=1024,yL=30*24*60*60*1e3;class vL{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new _L(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Tb();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const l=new Date(o.date).valueOf();return Date.now()-l<=yL}),this._storage.overwrite(this._heartbeatsCache))}catch(r){$i.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Tb(),{heartbeatsToSend:r,unsentEntries:s}=wL(this._heartbeatsCache.heartbeats),i=Bm(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return $i.warn(n),""}}}function Tb(){return new Date().toISOString().substring(0,10)}function wL(t,e=xL){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),Ib(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),Ib(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class _L{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return oD()?lD().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await gL(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return kb(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return kb(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function Ib(t){return Bm(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bL(t){yc(new Go("platform-logger",e=>new MD(e),"PRIVATE")),yc(new Go("heartbeat",e=>new vL(e),"PRIVATE")),Da(Ly,Eb,t),Da(Ly,Eb,"esm2017"),Da("fire-js","")}bL("");var Cb=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Lo,_I;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(k,E){function I(){}I.prototype=E.prototype,k.D=E.prototype,k.prototype=new I,k.prototype.constructor=k,k.C=function(C,A,D){for(var P=Array(arguments.length-2),ee=2;ee<arguments.length;ee++)P[ee-2]=arguments[ee];return E.prototype[A].apply(C,P)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(k,E,I){I||(I=0);var C=Array(16);if(typeof E=="string")for(var A=0;16>A;++A)C[A]=E.charCodeAt(I++)|E.charCodeAt(I++)<<8|E.charCodeAt(I++)<<16|E.charCodeAt(I++)<<24;else for(A=0;16>A;++A)C[A]=E[I++]|E[I++]<<8|E[I++]<<16|E[I++]<<24;E=k.g[0],I=k.g[1],A=k.g[2];var D=k.g[3],P=E+(D^I&(A^D))+C[0]+3614090360&4294967295;E=I+(P<<7&4294967295|P>>>25),P=D+(A^E&(I^A))+C[1]+3905402710&4294967295,D=E+(P<<12&4294967295|P>>>20),P=A+(I^D&(E^I))+C[2]+606105819&4294967295,A=D+(P<<17&4294967295|P>>>15),P=I+(E^A&(D^E))+C[3]+3250441966&4294967295,I=A+(P<<22&4294967295|P>>>10),P=E+(D^I&(A^D))+C[4]+4118548399&4294967295,E=I+(P<<7&4294967295|P>>>25),P=D+(A^E&(I^A))+C[5]+1200080426&4294967295,D=E+(P<<12&4294967295|P>>>20),P=A+(I^D&(E^I))+C[6]+2821735955&4294967295,A=D+(P<<17&4294967295|P>>>15),P=I+(E^A&(D^E))+C[7]+4249261313&4294967295,I=A+(P<<22&4294967295|P>>>10),P=E+(D^I&(A^D))+C[8]+1770035416&4294967295,E=I+(P<<7&4294967295|P>>>25),P=D+(A^E&(I^A))+C[9]+2336552879&4294967295,D=E+(P<<12&4294967295|P>>>20),P=A+(I^D&(E^I))+C[10]+4294925233&4294967295,A=D+(P<<17&4294967295|P>>>15),P=I+(E^A&(D^E))+C[11]+2304563134&4294967295,I=A+(P<<22&4294967295|P>>>10),P=E+(D^I&(A^D))+C[12]+1804603682&4294967295,E=I+(P<<7&4294967295|P>>>25),P=D+(A^E&(I^A))+C[13]+4254626195&4294967295,D=E+(P<<12&4294967295|P>>>20),P=A+(I^D&(E^I))+C[14]+2792965006&4294967295,A=D+(P<<17&4294967295|P>>>15),P=I+(E^A&(D^E))+C[15]+1236535329&4294967295,I=A+(P<<22&4294967295|P>>>10),P=E+(A^D&(I^A))+C[1]+4129170786&4294967295,E=I+(P<<5&4294967295|P>>>27),P=D+(I^A&(E^I))+C[6]+3225465664&4294967295,D=E+(P<<9&4294967295|P>>>23),P=A+(E^I&(D^E))+C[11]+643717713&4294967295,A=D+(P<<14&4294967295|P>>>18),P=I+(D^E&(A^D))+C[0]+3921069994&4294967295,I=A+(P<<20&4294967295|P>>>12),P=E+(A^D&(I^A))+C[5]+3593408605&4294967295,E=I+(P<<5&4294967295|P>>>27),P=D+(I^A&(E^I))+C[10]+38016083&4294967295,D=E+(P<<9&4294967295|P>>>23),P=A+(E^I&(D^E))+C[15]+3634488961&4294967295,A=D+(P<<14&4294967295|P>>>18),P=I+(D^E&(A^D))+C[4]+3889429448&4294967295,I=A+(P<<20&4294967295|P>>>12),P=E+(A^D&(I^A))+C[9]+568446438&4294967295,E=I+(P<<5&4294967295|P>>>27),P=D+(I^A&(E^I))+C[14]+3275163606&4294967295,D=E+(P<<9&4294967295|P>>>23),P=A+(E^I&(D^E))+C[3]+4107603335&4294967295,A=D+(P<<14&4294967295|P>>>18),P=I+(D^E&(A^D))+C[8]+1163531501&4294967295,I=A+(P<<20&4294967295|P>>>12),P=E+(A^D&(I^A))+C[13]+2850285829&4294967295,E=I+(P<<5&4294967295|P>>>27),P=D+(I^A&(E^I))+C[2]+4243563512&4294967295,D=E+(P<<9&4294967295|P>>>23),P=A+(E^I&(D^E))+C[7]+1735328473&4294967295,A=D+(P<<14&4294967295|P>>>18),P=I+(D^E&(A^D))+C[12]+2368359562&4294967295,I=A+(P<<20&4294967295|P>>>12),P=E+(I^A^D)+C[5]+4294588738&4294967295,E=I+(P<<4&4294967295|P>>>28),P=D+(E^I^A)+C[8]+2272392833&4294967295,D=E+(P<<11&4294967295|P>>>21),P=A+(D^E^I)+C[11]+1839030562&4294967295,A=D+(P<<16&4294967295|P>>>16),P=I+(A^D^E)+C[14]+4259657740&4294967295,I=A+(P<<23&4294967295|P>>>9),P=E+(I^A^D)+C[1]+2763975236&4294967295,E=I+(P<<4&4294967295|P>>>28),P=D+(E^I^A)+C[4]+1272893353&4294967295,D=E+(P<<11&4294967295|P>>>21),P=A+(D^E^I)+C[7]+4139469664&4294967295,A=D+(P<<16&4294967295|P>>>16),P=I+(A^D^E)+C[10]+3200236656&4294967295,I=A+(P<<23&4294967295|P>>>9),P=E+(I^A^D)+C[13]+681279174&4294967295,E=I+(P<<4&4294967295|P>>>28),P=D+(E^I^A)+C[0]+3936430074&4294967295,D=E+(P<<11&4294967295|P>>>21),P=A+(D^E^I)+C[3]+3572445317&4294967295,A=D+(P<<16&4294967295|P>>>16),P=I+(A^D^E)+C[6]+76029189&4294967295,I=A+(P<<23&4294967295|P>>>9),P=E+(I^A^D)+C[9]+3654602809&4294967295,E=I+(P<<4&4294967295|P>>>28),P=D+(E^I^A)+C[12]+3873151461&4294967295,D=E+(P<<11&4294967295|P>>>21),P=A+(D^E^I)+C[15]+530742520&4294967295,A=D+(P<<16&4294967295|P>>>16),P=I+(A^D^E)+C[2]+3299628645&4294967295,I=A+(P<<23&4294967295|P>>>9),P=E+(A^(I|~D))+C[0]+4096336452&4294967295,E=I+(P<<6&4294967295|P>>>26),P=D+(I^(E|~A))+C[7]+1126891415&4294967295,D=E+(P<<10&4294967295|P>>>22),P=A+(E^(D|~I))+C[14]+2878612391&4294967295,A=D+(P<<15&4294967295|P>>>17),P=I+(D^(A|~E))+C[5]+4237533241&4294967295,I=A+(P<<21&4294967295|P>>>11),P=E+(A^(I|~D))+C[12]+1700485571&4294967295,E=I+(P<<6&4294967295|P>>>26),P=D+(I^(E|~A))+C[3]+2399980690&4294967295,D=E+(P<<10&4294967295|P>>>22),P=A+(E^(D|~I))+C[10]+4293915773&4294967295,A=D+(P<<15&4294967295|P>>>17),P=I+(D^(A|~E))+C[1]+2240044497&4294967295,I=A+(P<<21&4294967295|P>>>11),P=E+(A^(I|~D))+C[8]+1873313359&4294967295,E=I+(P<<6&4294967295|P>>>26),P=D+(I^(E|~A))+C[15]+4264355552&4294967295,D=E+(P<<10&4294967295|P>>>22),P=A+(E^(D|~I))+C[6]+2734768916&4294967295,A=D+(P<<15&4294967295|P>>>17),P=I+(D^(A|~E))+C[13]+1309151649&4294967295,I=A+(P<<21&4294967295|P>>>11),P=E+(A^(I|~D))+C[4]+4149444226&4294967295,E=I+(P<<6&4294967295|P>>>26),P=D+(I^(E|~A))+C[11]+3174756917&4294967295,D=E+(P<<10&4294967295|P>>>22),P=A+(E^(D|~I))+C[2]+718787259&4294967295,A=D+(P<<15&4294967295|P>>>17),P=I+(D^(A|~E))+C[9]+3951481745&4294967295,k.g[0]=k.g[0]+E&4294967295,k.g[1]=k.g[1]+(A+(P<<21&4294967295|P>>>11))&4294967295,k.g[2]=k.g[2]+A&4294967295,k.g[3]=k.g[3]+D&4294967295}r.prototype.u=function(k,E){E===void 0&&(E=k.length);for(var I=E-this.blockSize,C=this.B,A=this.h,D=0;D<E;){if(A==0)for(;D<=I;)s(this,k,D),D+=this.blockSize;if(typeof k=="string"){for(;D<E;)if(C[A++]=k.charCodeAt(D++),A==this.blockSize){s(this,C),A=0;break}}else for(;D<E;)if(C[A++]=k[D++],A==this.blockSize){s(this,C),A=0;break}}this.h=A,this.o+=E},r.prototype.v=function(){var k=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);k[0]=128;for(var E=1;E<k.length-8;++E)k[E]=0;var I=8*this.o;for(E=k.length-8;E<k.length;++E)k[E]=I&255,I/=256;for(this.u(k),k=Array(16),E=I=0;4>E;++E)for(var C=0;32>C;C+=8)k[I++]=this.g[E]>>>C&255;return k};function i(k,E){var I=l;return Object.prototype.hasOwnProperty.call(I,k)?I[k]:I[k]=E(k)}function o(k,E){this.h=E;for(var I=[],C=!0,A=k.length-1;0<=A;A--){var D=k[A]|0;C&&D==E||(I[A]=D,C=!1)}this.g=I}var l={};function c(k){return-128<=k&&128>k?i(k,function(E){return new o([E|0],0>E?-1:0)}):new o([k|0],0>k?-1:0)}function u(k){if(isNaN(k)||!isFinite(k))return f;if(0>k)return v(u(-k));for(var E=[],I=1,C=0;k>=I;C++)E[C]=k/I|0,I*=4294967296;return new o(E,0)}function d(k,E){if(k.length==0)throw Error("number format error: empty string");if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(k.charAt(0)=="-")return v(d(k.substring(1),E));if(0<=k.indexOf("-"))throw Error('number format error: interior "-" character');for(var I=u(Math.pow(E,8)),C=f,A=0;A<k.length;A+=8){var D=Math.min(8,k.length-A),P=parseInt(k.substring(A,A+D),E);8>D?(D=u(Math.pow(E,D)),C=C.j(D).add(u(P))):(C=C.j(I),C=C.add(u(P)))}return C}var f=c(0),p=c(1),g=c(16777216);t=o.prototype,t.m=function(){if(w(this))return-v(this).m();for(var k=0,E=1,I=0;I<this.g.length;I++){var C=this.i(I);k+=(0<=C?C:4294967296+C)*E,E*=4294967296}return k},t.toString=function(k){if(k=k||10,2>k||36<k)throw Error("radix out of range: "+k);if(x(this))return"0";if(w(this))return"-"+v(this).toString(k);for(var E=u(Math.pow(k,6)),I=this,C="";;){var A=T(I,E).g;I=_(I,A.j(E));var D=((0<I.g.length?I.g[0]:I.h)>>>0).toString(k);if(I=A,x(I))return D+C;for(;6>D.length;)D="0"+D;C=D+C}},t.i=function(k){return 0>k?0:k<this.g.length?this.g[k]:this.h};function x(k){if(k.h!=0)return!1;for(var E=0;E<k.g.length;E++)if(k.g[E]!=0)return!1;return!0}function w(k){return k.h==-1}t.l=function(k){return k=_(this,k),w(k)?-1:x(k)?0:1};function v(k){for(var E=k.g.length,I=[],C=0;C<E;C++)I[C]=~k.g[C];return new o(I,~k.h).add(p)}t.abs=function(){return w(this)?v(this):this},t.add=function(k){for(var E=Math.max(this.g.length,k.g.length),I=[],C=0,A=0;A<=E;A++){var D=C+(this.i(A)&65535)+(k.i(A)&65535),P=(D>>>16)+(this.i(A)>>>16)+(k.i(A)>>>16);C=P>>>16,D&=65535,P&=65535,I[A]=P<<16|D}return new o(I,I[I.length-1]&-2147483648?-1:0)};function _(k,E){return k.add(v(E))}t.j=function(k){if(x(this)||x(k))return f;if(w(this))return w(k)?v(this).j(v(k)):v(v(this).j(k));if(w(k))return v(this.j(v(k)));if(0>this.l(g)&&0>k.l(g))return u(this.m()*k.m());for(var E=this.g.length+k.g.length,I=[],C=0;C<2*E;C++)I[C]=0;for(C=0;C<this.g.length;C++)for(var A=0;A<k.g.length;A++){var D=this.i(C)>>>16,P=this.i(C)&65535,ee=k.i(A)>>>16,_e=k.i(A)&65535;I[2*C+2*A]+=P*_e,b(I,2*C+2*A),I[2*C+2*A+1]+=D*_e,b(I,2*C+2*A+1),I[2*C+2*A+1]+=P*ee,b(I,2*C+2*A+1),I[2*C+2*A+2]+=D*ee,b(I,2*C+2*A+2)}for(C=0;C<E;C++)I[C]=I[2*C+1]<<16|I[2*C];for(C=E;C<2*E;C++)I[C]=0;return new o(I,0)};function b(k,E){for(;(k[E]&65535)!=k[E];)k[E+1]+=k[E]>>>16,k[E]&=65535,E++}function j(k,E){this.g=k,this.h=E}function T(k,E){if(x(E))throw Error("division by zero");if(x(k))return new j(f,f);if(w(k))return E=T(v(k),E),new j(v(E.g),v(E.h));if(w(E))return E=T(k,v(E)),new j(v(E.g),E.h);if(30<k.g.length){if(w(k)||w(E))throw Error("slowDivide_ only works with positive integers.");for(var I=p,C=E;0>=C.l(k);)I=R(I),C=R(C);var A=M(I,1),D=M(C,1);for(C=M(C,2),I=M(I,2);!x(C);){var P=D.add(C);0>=P.l(k)&&(A=A.add(I),D=P),C=M(C,1),I=M(I,1)}return E=_(k,A.j(E)),new j(A,E)}for(A=f;0<=k.l(E);){for(I=Math.max(1,Math.floor(k.m()/E.m())),C=Math.ceil(Math.log(I)/Math.LN2),C=48>=C?1:Math.pow(2,C-48),D=u(I),P=D.j(E);w(P)||0<P.l(k);)I-=C,D=u(I),P=D.j(E);x(D)&&(D=p),A=A.add(D),k=_(k,P)}return new j(A,k)}t.A=function(k){return T(this,k).h},t.and=function(k){for(var E=Math.max(this.g.length,k.g.length),I=[],C=0;C<E;C++)I[C]=this.i(C)&k.i(C);return new o(I,this.h&k.h)},t.or=function(k){for(var E=Math.max(this.g.length,k.g.length),I=[],C=0;C<E;C++)I[C]=this.i(C)|k.i(C);return new o(I,this.h|k.h)},t.xor=function(k){for(var E=Math.max(this.g.length,k.g.length),I=[],C=0;C<E;C++)I[C]=this.i(C)^k.i(C);return new o(I,this.h^k.h)};function R(k){for(var E=k.g.length+1,I=[],C=0;C<E;C++)I[C]=k.i(C)<<1|k.i(C-1)>>>31;return new o(I,k.h)}function M(k,E){var I=E>>5;E%=32;for(var C=k.g.length-I,A=[],D=0;D<C;D++)A[D]=0<E?k.i(D+I)>>>E|k.i(D+I+1)<<32-E:k.i(D+I);return new o(A,k.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,_I=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=d,Lo=o}).apply(typeof Cb<"u"?Cb:typeof self<"u"?self:typeof window<"u"?window:{});var _f=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var bI,Lu,SI,Zf,zy,EI,jI,kI;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(m,y,S){return m==Array.prototype||m==Object.prototype||(m[y]=S.value),m};function n(m){m=[typeof globalThis=="object"&&globalThis,m,typeof window=="object"&&window,typeof self=="object"&&self,typeof _f=="object"&&_f];for(var y=0;y<m.length;++y){var S=m[y];if(S&&S.Math==Math)return S}throw Error("Cannot find global object")}var r=n(this);function s(m,y){if(y)e:{var S=r;m=m.split(".");for(var N=0;N<m.length-1;N++){var O=m[N];if(!(O in S))break e;S=S[O]}m=m[m.length-1],N=S[m],y=y(N),y!=N&&y!=null&&e(S,m,{configurable:!0,writable:!0,value:y})}}function i(m,y){m instanceof String&&(m+="");var S=0,N=!1,O={next:function(){if(!N&&S<m.length){var $=S++;return{value:y($,m[$]),done:!1}}return N=!0,{done:!0,value:void 0}}};return O[Symbol.iterator]=function(){return O},O}s("Array.prototype.values",function(m){return m||function(){return i(this,function(y,S){return S})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function c(m){var y=typeof m;return y=y!="object"?y:m?Array.isArray(m)?"array":y:"null",y=="array"||y=="object"&&typeof m.length=="number"}function u(m){var y=typeof m;return y=="object"&&m!=null||y=="function"}function d(m,y,S){return m.call.apply(m.bind,arguments)}function f(m,y,S){if(!m)throw Error();if(2<arguments.length){var N=Array.prototype.slice.call(arguments,2);return function(){var O=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(O,N),m.apply(y,O)}}return function(){return m.apply(y,arguments)}}function p(m,y,S){return p=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:f,p.apply(null,arguments)}function g(m,y){var S=Array.prototype.slice.call(arguments,1);return function(){var N=S.slice();return N.push.apply(N,arguments),m.apply(this,N)}}function x(m,y){function S(){}S.prototype=y.prototype,m.aa=y.prototype,m.prototype=new S,m.prototype.constructor=m,m.Qb=function(N,O,$){for(var Y=Array(arguments.length-2),nt=2;nt<arguments.length;nt++)Y[nt-2]=arguments[nt];return y.prototype[O].apply(N,Y)}}function w(m){const y=m.length;if(0<y){const S=Array(y);for(let N=0;N<y;N++)S[N]=m[N];return S}return[]}function v(m,y){for(let S=1;S<arguments.length;S++){const N=arguments[S];if(c(N)){const O=m.length||0,$=N.length||0;m.length=O+$;for(let Y=0;Y<$;Y++)m[O+Y]=N[Y]}else m.push(N)}}class _{constructor(y,S){this.i=y,this.j=S,this.h=0,this.g=null}get(){let y;return 0<this.h?(this.h--,y=this.g,this.g=y.next,y.next=null):y=this.i(),y}}function b(m){return/^[\s\xa0]*$/.test(m)}function j(){var m=l.navigator;return m&&(m=m.userAgent)?m:""}function T(m){return T[" "](m),m}T[" "]=function(){};var R=j().indexOf("Gecko")!=-1&&!(j().toLowerCase().indexOf("webkit")!=-1&&j().indexOf("Edge")==-1)&&!(j().indexOf("Trident")!=-1||j().indexOf("MSIE")!=-1)&&j().indexOf("Edge")==-1;function M(m,y,S){for(const N in m)y.call(S,m[N],N,m)}function k(m,y){for(const S in m)y.call(void 0,m[S],S,m)}function E(m){const y={};for(const S in m)y[S]=m[S];return y}const I="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function C(m,y){let S,N;for(let O=1;O<arguments.length;O++){N=arguments[O];for(S in N)m[S]=N[S];for(let $=0;$<I.length;$++)S=I[$],Object.prototype.hasOwnProperty.call(N,S)&&(m[S]=N[S])}}function A(m){var y=1;m=m.split(":");const S=[];for(;0<y&&m.length;)S.push(m.shift()),y--;return m.length&&S.push(m.join(":")),S}function D(m){l.setTimeout(()=>{throw m},0)}function P(){var m=K;let y=null;return m.g&&(y=m.g,m.g=m.g.next,m.g||(m.h=null),y.next=null),y}class ee{constructor(){this.h=this.g=null}add(y,S){const N=_e.get();N.set(y,S),this.h?this.h.next=N:this.g=N,this.h=N}}var _e=new _(()=>new He,m=>m.reset());class He{constructor(){this.next=this.g=this.h=null}set(y,S){this.h=y,this.g=S,this.next=null}reset(){this.next=this.g=this.h=null}}let Be,B=!1,K=new ee,X=()=>{const m=l.Promise.resolve(void 0);Be=()=>{m.then(he)}};var he=()=>{for(var m;m=P();){try{m.h.call(m.g)}catch(S){D(S)}var y=_e;y.j(m),100>y.h&&(y.h++,m.next=y.g,y.g=m)}B=!1};function pe(){this.s=this.s,this.C=this.C}pe.prototype.s=!1,pe.prototype.ma=function(){this.s||(this.s=!0,this.N())},pe.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Ie(m,y){this.type=m,this.g=this.target=y,this.defaultPrevented=!1}Ie.prototype.h=function(){this.defaultPrevented=!0};var vt=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var m=!1,y=Object.defineProperty({},"passive",{get:function(){m=!0}});try{const S=()=>{};l.addEventListener("test",S,y),l.removeEventListener("test",S,y)}catch{}return m}();function ve(m,y){if(Ie.call(this,m?m.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,m){var S=this.type=m.type,N=m.changedTouches&&m.changedTouches.length?m.changedTouches[0]:null;if(this.target=m.target||m.srcElement,this.g=y,y=m.relatedTarget){if(R){e:{try{T(y.nodeName);var O=!0;break e}catch{}O=!1}O||(y=null)}}else S=="mouseover"?y=m.fromElement:S=="mouseout"&&(y=m.toElement);this.relatedTarget=y,N?(this.clientX=N.clientX!==void 0?N.clientX:N.pageX,this.clientY=N.clientY!==void 0?N.clientY:N.pageY,this.screenX=N.screenX||0,this.screenY=N.screenY||0):(this.clientX=m.clientX!==void 0?m.clientX:m.pageX,this.clientY=m.clientY!==void 0?m.clientY:m.pageY,this.screenX=m.screenX||0,this.screenY=m.screenY||0),this.button=m.button,this.key=m.key||"",this.ctrlKey=m.ctrlKey,this.altKey=m.altKey,this.shiftKey=m.shiftKey,this.metaKey=m.metaKey,this.pointerId=m.pointerId||0,this.pointerType=typeof m.pointerType=="string"?m.pointerType:pn[m.pointerType]||"",this.state=m.state,this.i=m,m.defaultPrevented&&ve.aa.h.call(this)}}x(ve,Ie);var pn={2:"touch",3:"pen",4:"mouse"};ve.prototype.h=function(){ve.aa.h.call(this);var m=this.i;m.preventDefault?m.preventDefault():m.returnValue=!1};var Dt="closure_listenable_"+(1e6*Math.random()|0),ge=0;function rn(m,y,S,N,O){this.listener=m,this.proxy=null,this.src=y,this.type=S,this.capture=!!N,this.ha=O,this.key=++ge,this.da=this.fa=!1}function ht(m){m.da=!0,m.listener=null,m.proxy=null,m.src=null,m.ha=null}function dr(m){this.src=m,this.g={},this.h=0}dr.prototype.add=function(m,y,S,N,O){var $=m.toString();m=this.g[$],m||(m=this.g[$]=[],this.h++);var Y=us(m,y,N,O);return-1<Y?(y=m[Y],S||(y.fa=!1)):(y=new rn(y,this.src,$,!!N,O),y.fa=S,m.push(y)),y};function hr(m,y){var S=y.type;if(S in m.g){var N=m.g[S],O=Array.prototype.indexOf.call(N,y,void 0),$;($=0<=O)&&Array.prototype.splice.call(N,O,1),$&&(ht(y),m.g[S].length==0&&(delete m.g[S],m.h--))}}function us(m,y,S,N){for(var O=0;O<m.length;++O){var $=m[O];if(!$.da&&$.listener==y&&$.capture==!!S&&$.ha==N)return O}return-1}var xl="closure_lm_"+(1e6*Math.random()|0),iu={};function kh(m,y,S,N,O){if(N&&N.once)return Ih(m,y,S,N,O);if(Array.isArray(y)){for(var $=0;$<y.length;$++)kh(m,y[$],S,N,O);return null}return S=cu(S),m&&m[Dt]?m.K(y,S,u(N)?!!N.capture:!!N,O):Th(m,y,S,!1,N,O)}function Th(m,y,S,N,O,$){if(!y)throw Error("Invalid event type");var Y=u(O)?!!O.capture:!!O,nt=ou(m);if(nt||(m[xl]=nt=new dr(m)),S=nt.add(y,S,N,Y,$),S.proxy)return S;if(N=Jg(),S.proxy=N,N.src=m,N.listener=S,m.addEventListener)vt||(O=Y),O===void 0&&(O=!1),m.addEventListener(y.toString(),N,O);else if(m.attachEvent)m.attachEvent(Rh(y.toString()),N);else if(m.addListener&&m.removeListener)m.addListener(N);else throw Error("addEventListener and attachEvent are unavailable.");return S}function Jg(){function m(S){return y.call(m.src,m.listener,S)}const y=Zg;return m}function Ih(m,y,S,N,O){if(Array.isArray(y)){for(var $=0;$<y.length;$++)Ih(m,y[$],S,N,O);return null}return S=cu(S),m&&m[Dt]?m.L(y,S,u(N)?!!N.capture:!!N,O):Th(m,y,S,!0,N,O)}function Ch(m,y,S,N,O){if(Array.isArray(y))for(var $=0;$<y.length;$++)Ch(m,y[$],S,N,O);else N=u(N)?!!N.capture:!!N,S=cu(S),m&&m[Dt]?(m=m.i,y=String(y).toString(),y in m.g&&($=m.g[y],S=us($,S,N,O),-1<S&&(ht($[S]),Array.prototype.splice.call($,S,1),$.length==0&&(delete m.g[y],m.h--)))):m&&(m=ou(m))&&(y=m.g[y.toString()],m=-1,y&&(m=us(y,S,N,O)),(S=-1<m?y[m]:null)&&au(S))}function au(m){if(typeof m!="number"&&m&&!m.da){var y=m.src;if(y&&y[Dt])hr(y.i,m);else{var S=m.type,N=m.proxy;y.removeEventListener?y.removeEventListener(S,N,m.capture):y.detachEvent?y.detachEvent(Rh(S),N):y.addListener&&y.removeListener&&y.removeListener(N),(S=ou(y))?(hr(S,m),S.h==0&&(S.src=null,y[xl]=null)):ht(m)}}}function Rh(m){return m in iu?iu[m]:iu[m]="on"+m}function Zg(m,y){if(m.da)m=!0;else{y=new ve(y,this);var S=m.listener,N=m.ha||m.src;m.fa&&au(m),m=S.call(N,y)}return m}function ou(m){return m=m[xl],m instanceof dr?m:null}var lu="__closure_events_fn_"+(1e9*Math.random()>>>0);function cu(m){return typeof m=="function"?m:(m[lu]||(m[lu]=function(y){return m.handleEvent(y)}),m[lu])}function Tt(){pe.call(this),this.i=new dr(this),this.M=this,this.F=null}x(Tt,pe),Tt.prototype[Dt]=!0,Tt.prototype.removeEventListener=function(m,y,S,N){Ch(this,m,y,S,N)};function Kt(m,y){var S,N=m.F;if(N)for(S=[];N;N=N.F)S.push(N);if(m=m.M,N=y.type||y,typeof y=="string")y=new Ie(y,m);else if(y instanceof Ie)y.target=y.target||m;else{var O=y;y=new Ie(N,m),C(y,O)}if(O=!0,S)for(var $=S.length-1;0<=$;$--){var Y=y.g=S[$];O=to(Y,N,!0,y)&&O}if(Y=y.g=m,O=to(Y,N,!0,y)&&O,O=to(Y,N,!1,y)&&O,S)for($=0;$<S.length;$++)Y=y.g=S[$],O=to(Y,N,!1,y)&&O}Tt.prototype.N=function(){if(Tt.aa.N.call(this),this.i){var m=this.i,y;for(y in m.g){for(var S=m.g[y],N=0;N<S.length;N++)ht(S[N]);delete m.g[y],m.h--}}this.F=null},Tt.prototype.K=function(m,y,S,N){return this.i.add(String(m),y,!1,S,N)},Tt.prototype.L=function(m,y,S,N){return this.i.add(String(m),y,!0,S,N)};function to(m,y,S,N){if(y=m.i.g[String(y)],!y)return!0;y=y.concat();for(var O=!0,$=0;$<y.length;++$){var Y=y[$];if(Y&&!Y.da&&Y.capture==S){var nt=Y.listener,xn=Y.ha||Y.src;Y.fa&&hr(m.i,Y),O=nt.call(xn,N)!==!1&&O}}return O&&!N.defaultPrevented}function _r(m,y,S){if(typeof m=="function")S&&(m=p(m,S));else if(m&&typeof m.handleEvent=="function")m=p(m.handleEvent,m);else throw Error("Invalid listener argument");return 2147483647<Number(y)?-1:l.setTimeout(m,y||0)}function uu(m){m.g=_r(()=>{m.g=null,m.i&&(m.i=!1,uu(m))},m.l);const y=m.h;m.h=null,m.m.apply(null,y)}class Nh extends pe{constructor(y,S){super(),this.m=y,this.l=S,this.h=null,this.i=!1,this.g=null}j(y){this.h=arguments,this.g?this.i=!0:uu(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function no(m){pe.call(this),this.h=m,this.g={}}x(no,pe);var du=[];function ro(m){M(m.g,function(y,S){this.g.hasOwnProperty(S)&&au(y)},m),m.g={}}no.prototype.N=function(){no.aa.N.call(this),ro(this)},no.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var yl=l.JSON.stringify,Ah=l.JSON.parse,e0=class{stringify(m){return l.JSON.stringify(m,void 0)}parse(m){return l.JSON.parse(m,void 0)}};function ds(){}ds.prototype.h=null;function hu(m){return m.h||(m.h=m.i())}function Ph(){}var so={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function io(){Ie.call(this,"d")}x(io,Ie);function di(){Ie.call(this,"c")}x(di,Ie);var hs={},vl=null;function sa(){return vl=vl||new Tt}hs.La="serverreachability";function ia(m){Ie.call(this,hs.La,m)}x(ia,Ie);function ao(m){const y=sa();Kt(y,new ia(y))}hs.STAT_EVENT="statevent";function Fh(m,y){Ie.call(this,hs.STAT_EVENT,m),this.stat=y}x(Fh,Ie);function gn(m){const y=sa();Kt(y,new Fh(y,m))}hs.Ma="timingevent";function Mh(m,y){Ie.call(this,hs.Ma,m),this.size=y}x(Mh,Ie);function oo(m,y){if(typeof m!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){m()},y)}function aa(){this.g=!0}aa.prototype.xa=function(){this.g=!1};function fu(m,y,S,N,O,$){m.info(function(){if(m.g)if($)for(var Y="",nt=$.split("&"),xn=0;xn<nt.length;xn++){var Ge=nt[xn].split("=");if(1<Ge.length){var Pn=Ge[0];Ge=Ge[1];var Fn=Pn.split("_");Y=2<=Fn.length&&Fn[1]=="type"?Y+(Pn+"="+Ge+"&"):Y+(Pn+"=redacted&")}}else Y=null;else Y=$;return"XMLHTTP REQ ("+N+") [attempt "+O+"]: "+y+`
`+S+`
`+Y})}function hi(m,y,S,N,O,$,Y){m.info(function(){return"XMLHTTP RESP ("+N+") [ attempt "+O+"]: "+y+`
`+S+`
`+$+" "+Y})}function oa(m,y,S,N){m.info(function(){return"XMLHTTP TEXT ("+y+"): "+n0(m,S)+(N?" "+N:"")})}function t0(m,y){m.info(function(){return"TIMEOUT: "+y})}aa.prototype.info=function(){};function n0(m,y){if(!m.g)return y;if(!y)return null;try{var S=JSON.parse(y);if(S){for(m=0;m<S.length;m++)if(Array.isArray(S[m])){var N=S[m];if(!(2>N.length)){var O=N[1];if(Array.isArray(O)&&!(1>O.length)){var $=O[0];if($!="noop"&&$!="stop"&&$!="close")for(var Y=1;Y<O.length;Y++)O[Y]=""}}}}return yl(S)}catch{return y}}var wl={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Dh={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},br;function _l(){}x(_l,ds),_l.prototype.g=function(){return new XMLHttpRequest},_l.prototype.i=function(){return{}},br=new _l;function Vs(m,y,S,N){this.j=m,this.i=y,this.l=S,this.R=N||1,this.U=new no(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Lh}function Lh(){this.i=null,this.g="",this.h=!1}var Oh={},mu={};function fs(m,y,S){m.L=1,m.v=pi(ms(y)),m.m=S,m.P=!0,$h(m,null)}function $h(m,y){m.F=Date.now(),bl(m),m.A=ms(m.v);var S=m.A,N=m.R;Array.isArray(N)||(N=[String(N)]),po(S.i,"t",N),m.C=0,S=m.j.J,m.h=new Lh,m.g=O_(m.j,S?y:null,!m.m),0<m.O&&(m.M=new Nh(p(m.Y,m,m.g),m.O)),y=m.U,S=m.g,N=m.ca;var O="readystatechange";Array.isArray(O)||(O&&(du[0]=O.toString()),O=du);for(var $=0;$<O.length;$++){var Y=kh(S,O[$],N||y.handleEvent,!1,y.h||y);if(!Y)break;y.g[Y.key]=Y}y=m.H?E(m.H):{},m.m?(m.u||(m.u="POST"),y["Content-Type"]="application/x-www-form-urlencoded",m.g.ea(m.A,m.u,m.m,y)):(m.u="GET",m.g.ea(m.A,m.u,null,y)),ao(),fu(m.i,m.u,m.A,m.l,m.R,m.m)}Vs.prototype.ca=function(m){m=m.target;const y=this.M;y&&Ct(m)==3?y.j():this.Y(m)},Vs.prototype.Y=function(m){try{if(m==this.g)e:{const Fn=Ct(this.g);var y=this.g.Ba();const Tl=this.g.Z();if(!(3>Fn)&&(Fn!=3||this.g&&(this.h.h||this.g.oa()||Qt(this.g)))){this.J||Fn!=4||y==7||(y==8||0>=Tl?ao(3):ao(2)),la(this);var S=this.g.Z();this.X=S;t:if(zh(this)){var N=Qt(this.g);m="";var O=N.length,$=Ct(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){fi(this),lo(this);var Y="";break t}this.h.i=new l.TextDecoder}for(y=0;y<O;y++)this.h.h=!0,m+=this.h.i.decode(N[y],{stream:!($&&y==O-1)});N.length=0,this.h.g+=m,this.C=0,Y=this.h.g}else Y=this.g.oa();if(this.o=S==200,hi(this.i,this.u,this.A,this.l,this.R,Fn,S),this.o){if(this.T&&!this.K){t:{if(this.g){var nt,xn=this.g;if((nt=xn.g?xn.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!b(nt)){var Ge=nt;break t}}Ge=null}if(S=Ge)oa(this.i,this.l,S,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Gr(this,S);else{this.o=!1,this.s=3,gn(12),fi(this),lo(this);break e}}if(this.P){S=!0;let ys;for(;!this.J&&this.C<Y.length;)if(ys=r0(this,Y),ys==mu){Fn==4&&(this.s=4,gn(14),S=!1),oa(this.i,this.l,null,"[Incomplete Response]");break}else if(ys==Oh){this.s=4,gn(15),oa(this.i,this.l,Y,"[Invalid Chunk]"),S=!1;break}else oa(this.i,this.l,ys,null),Gr(this,ys);if(zh(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Fn!=4||Y.length!=0||this.h.h||(this.s=1,gn(16),S=!1),this.o=this.o&&S,!S)oa(this.i,this.l,Y,"[Invalid Chunked Response]"),fi(this),lo(this);else if(0<Y.length&&!this.W){this.W=!0;var Pn=this.j;Pn.g==this&&Pn.ba&&!Pn.M&&(Pn.j.info("Great, no buffering proxy detected. Bytes received: "+Y.length),f0(Pn),Pn.M=!0,gn(11))}}else oa(this.i,this.l,Y,null),Gr(this,Y);Fn==4&&fi(this),this.o&&!this.J&&(Fn==4?F_(this.j,this):(this.o=!1,bl(this)))}else fr(this.g),S==400&&0<Y.indexOf("Unknown SID")?(this.s=3,gn(12)):(this.s=0,gn(13)),fi(this),lo(this)}}}catch{}finally{}};function zh(m){return m.g?m.u=="GET"&&m.L!=2&&m.j.Ca:!1}function r0(m,y){var S=m.C,N=y.indexOf(`
`,S);return N==-1?mu:(S=Number(y.substring(S,N)),isNaN(S)?Oh:(N+=1,N+S>y.length?mu:(y=y.slice(N,N+S),m.C=N+S,y)))}Vs.prototype.cancel=function(){this.J=!0,fi(this)};function bl(m){m.S=Date.now()+m.I,Bh(m,m.I)}function Bh(m,y){if(m.B!=null)throw Error("WatchDog timer not null");m.B=oo(p(m.ba,m),y)}function la(m){m.B&&(l.clearTimeout(m.B),m.B=null)}Vs.prototype.ba=function(){this.B=null;const m=Date.now();0<=m-this.S?(t0(this.i,this.A),this.L!=2&&(ao(),gn(17)),fi(this),this.s=2,lo(this)):Bh(this,this.S-m)};function lo(m){m.j.G==0||m.J||F_(m.j,m)}function fi(m){la(m);var y=m.M;y&&typeof y.ma=="function"&&y.ma(),m.M=null,ro(m.U),m.g&&(y=m.g,m.g=null,y.abort(),y.ma())}function Gr(m,y){try{var S=m.j;if(S.G!=0&&(S.g==m||pu(S.h,m))){if(!m.K&&pu(S.h,m)&&S.G==3){try{var N=S.Da.g.parse(y)}catch{N=null}if(Array.isArray(N)&&N.length==3){var O=N;if(O[0]==0){e:if(!S.u){if(S.g)if(S.g.F+3e3<m.F)Zh(S),qr(S);else break e;h0(S),gn(18)}}else S.za=O[1],0<S.za-S.T&&37500>O[2]&&S.F&&S.v==0&&!S.C&&(S.C=oo(p(S.Za,S),6e3));if(1>=Hh(S.h)&&S.ca){try{S.ca()}catch{}S.ca=void 0}}else vo(S,11)}else if((m.K||S.g==m)&&Zh(S),!b(y))for(O=S.Da.g.parse(y),y=0;y<O.length;y++){let Ge=O[y];if(S.T=Ge[0],Ge=Ge[1],S.G==2)if(Ge[0]=="c"){S.K=Ge[1],S.ia=Ge[2];const Pn=Ge[3];Pn!=null&&(S.la=Pn,S.j.info("VER="+S.la));const Fn=Ge[4];Fn!=null&&(S.Aa=Fn,S.j.info("SVER="+S.Aa));const Tl=Ge[5];Tl!=null&&typeof Tl=="number"&&0<Tl&&(N=1.5*Tl,S.L=N,S.j.info("backChannelRequestTimeoutMs_="+N)),N=S;const ys=m.g;if(ys){const tf=ys.g?ys.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(tf){var $=N.h;$.g||tf.indexOf("spdy")==-1&&tf.indexOf("quic")==-1&&tf.indexOf("h2")==-1||($.j=$.l,$.g=new Set,$.h&&(gu($,$.h),$.h=null))}if(N.D){const m0=ys.g?ys.g.getResponseHeader("X-HTTP-Session-Id"):null;m0&&(N.ya=m0,Je(N.I,N.D,m0))}}S.G=3,S.l&&S.l.ua(),S.ba&&(S.R=Date.now()-m.F,S.j.info("Handshake RTT: "+S.R+"ms")),N=S;var Y=m;if(N.qa=L_(N,N.J?N.ia:null,N.W),Y.K){co(N.h,Y);var nt=Y,xn=N.L;xn&&(nt.I=xn),nt.B&&(la(nt),bl(nt)),N.g=Y}else A_(N);0<S.i.length&&gi(S)}else Ge[0]!="stop"&&Ge[0]!="close"||vo(S,7);else S.G==3&&(Ge[0]=="stop"||Ge[0]=="close"?Ge[0]=="stop"?vo(S,7):Sr(S):Ge[0]!="noop"&&S.l&&S.l.ta(Ge),S.v=0)}}ao(4)}catch{}}var s0=class{constructor(m,y){this.g=m,this.map=y}};function Vh(m){this.l=m||10,l.PerformanceNavigationTiming?(m=l.performance.getEntriesByType("navigation"),m=0<m.length&&(m[0].nextHopProtocol=="hq"||m[0].nextHopProtocol=="h2")):m=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=m?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Uh(m){return m.h?!0:m.g?m.g.size>=m.j:!1}function Hh(m){return m.h?1:m.g?m.g.size:0}function pu(m,y){return m.h?m.h==y:m.g?m.g.has(y):!1}function gu(m,y){m.g?m.g.add(y):m.h=y}function co(m,y){m.h&&m.h==y?m.h=null:m.g&&m.g.has(y)&&m.g.delete(y)}Vh.prototype.cancel=function(){if(this.i=Gh(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const m of this.g.values())m.cancel();this.g.clear()}};function Gh(m){if(m.h!=null)return m.i.concat(m.h.D);if(m.g!=null&&m.g.size!==0){let y=m.i;for(const S of m.g.values())y=y.concat(S.D);return y}return w(m.i)}function uo(m){if(m.V&&typeof m.V=="function")return m.V();if(typeof Map<"u"&&m instanceof Map||typeof Set<"u"&&m instanceof Set)return Array.from(m.values());if(typeof m=="string")return m.split("");if(c(m)){for(var y=[],S=m.length,N=0;N<S;N++)y.push(m[N]);return y}y=[],S=0;for(N in m)y[S++]=m[N];return y}function Wh(m){if(m.na&&typeof m.na=="function")return m.na();if(!m.V||typeof m.V!="function"){if(typeof Map<"u"&&m instanceof Map)return Array.from(m.keys());if(!(typeof Set<"u"&&m instanceof Set)){if(c(m)||typeof m=="string"){var y=[];m=m.length;for(var S=0;S<m;S++)y.push(S);return y}y=[],S=0;for(const N in m)y[S++]=N;return y}}}function xu(m,y){if(m.forEach&&typeof m.forEach=="function")m.forEach(y,void 0);else if(c(m)||typeof m=="string")Array.prototype.forEach.call(m,y,void 0);else for(var S=Wh(m),N=uo(m),O=N.length,$=0;$<O;$++)y.call(void 0,N[$],S&&S[$],m)}var qh=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function i0(m,y){if(m){m=m.split("&");for(var S=0;S<m.length;S++){var N=m[S].indexOf("="),O=null;if(0<=N){var $=m[S].substring(0,N);O=m[S].substring(N+1)}else $=m[S];y($,O?decodeURIComponent(O.replace(/\+/g," ")):"")}}}function mi(m){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,m instanceof mi){this.h=m.h,ho(this,m.j),this.o=m.o,this.g=m.g,Sl(this,m.s),this.l=m.l;var y=m.i,S=new mo;S.i=y.i,y.g&&(S.g=new Map(y.g),S.h=y.h),Kh(this,S),this.m=m.m}else m&&(y=String(m).match(qh))?(this.h=!1,ho(this,y[1]||"",!0),this.o=Wr(y[2]||""),this.g=Wr(y[3]||"",!0),Sl(this,y[4]),this.l=Wr(y[5]||"",!0),Kh(this,y[6]||"",!0),this.m=Wr(y[7]||"")):(this.h=!1,this.i=new mo(null,this.h))}mi.prototype.toString=function(){var m=[],y=this.j;y&&m.push(fo(y,ps,!0),":");var S=this.g;return(S||y=="file")&&(m.push("//"),(y=this.o)&&m.push(fo(y,ps,!0),"@"),m.push(encodeURIComponent(String(S)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),S=this.s,S!=null&&m.push(":",String(S))),(S=this.l)&&(this.g&&S.charAt(0)!="/"&&m.push("/"),m.push(fo(S,S.charAt(0)=="/"?l0:o0,!0))),(S=this.i.toString())&&m.push("?",S),(S=this.m)&&m.push("#",fo(S,u0)),m.join("")};function ms(m){return new mi(m)}function ho(m,y,S){m.j=S?Wr(y,!0):y,m.j&&(m.j=m.j.replace(/:$/,""))}function Sl(m,y){if(y){if(y=Number(y),isNaN(y)||0>y)throw Error("Bad port number "+y);m.s=y}else m.s=null}function Kh(m,y,S){y instanceof mo?(m.i=y,vu(m.i,m.h)):(S||(y=fo(y,c0)),m.i=new mo(y,m.h))}function Je(m,y,S){m.i.set(y,S)}function pi(m){return Je(m,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),m}function Wr(m,y){return m?y?decodeURI(m.replace(/%25/g,"%2525")):decodeURIComponent(m):""}function fo(m,y,S){return typeof m=="string"?(m=encodeURI(m).replace(y,a0),S&&(m=m.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m):null}function a0(m){return m=m.charCodeAt(0),"%"+(m>>4&15).toString(16)+(m&15).toString(16)}var ps=/[#\/\?@]/g,o0=/[#\?:]/g,l0=/[#\?]/g,c0=/[#\?@]/g,u0=/#/g;function mo(m,y){this.h=this.g=null,this.i=m||null,this.j=!!y}function Nn(m){m.g||(m.g=new Map,m.h=0,m.i&&i0(m.i,function(y,S){m.add(decodeURIComponent(y.replace(/\+/g," ")),S)}))}t=mo.prototype,t.add=function(m,y){Nn(this),this.i=null,m=ca(this,m);var S=this.g.get(m);return S||this.g.set(m,S=[]),S.push(y),this.h+=1,this};function yu(m,y){Nn(m),y=ca(m,y),m.g.has(y)&&(m.i=null,m.h-=m.g.get(y).length,m.g.delete(y))}function Qh(m,y){return Nn(m),y=ca(m,y),m.g.has(y)}t.forEach=function(m,y){Nn(this),this.g.forEach(function(S,N){S.forEach(function(O){m.call(y,O,N,this)},this)},this)},t.na=function(){Nn(this);const m=Array.from(this.g.values()),y=Array.from(this.g.keys()),S=[];for(let N=0;N<y.length;N++){const O=m[N];for(let $=0;$<O.length;$++)S.push(y[N])}return S},t.V=function(m){Nn(this);let y=[];if(typeof m=="string")Qh(this,m)&&(y=y.concat(this.g.get(ca(this,m))));else{m=Array.from(this.g.values());for(let S=0;S<m.length;S++)y=y.concat(m[S])}return y},t.set=function(m,y){return Nn(this),this.i=null,m=ca(this,m),Qh(this,m)&&(this.h-=this.g.get(m).length),this.g.set(m,[y]),this.h+=1,this},t.get=function(m,y){return m?(m=this.V(m),0<m.length?String(m[0]):y):y};function po(m,y,S){yu(m,y),0<S.length&&(m.i=null,m.g.set(ca(m,y),w(S)),m.h+=S.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const m=[],y=Array.from(this.g.keys());for(var S=0;S<y.length;S++){var N=y[S];const $=encodeURIComponent(String(N)),Y=this.V(N);for(N=0;N<Y.length;N++){var O=$;Y[N]!==""&&(O+="="+encodeURIComponent(String(Y[N]))),m.push(O)}}return this.i=m.join("&")};function ca(m,y){return y=String(y),m.j&&(y=y.toLowerCase()),y}function vu(m,y){y&&!m.j&&(Nn(m),m.i=null,m.g.forEach(function(S,N){var O=N.toLowerCase();N!=O&&(yu(this,N),po(this,O,S))},m)),m.j=y}function d0(m,y){const S=new aa;if(l.Image){const N=new Image;N.onload=g(gs,S,"TestLoadImage: loaded",!0,y,N),N.onerror=g(gs,S,"TestLoadImage: error",!1,y,N),N.onabort=g(gs,S,"TestLoadImage: abort",!1,y,N),N.ontimeout=g(gs,S,"TestLoadImage: timeout",!1,y,N),l.setTimeout(function(){N.ontimeout&&N.ontimeout()},1e4),N.src=m}else y(!1)}function Xh(m,y){const S=new aa,N=new AbortController,O=setTimeout(()=>{N.abort(),gs(S,"TestPingServer: timeout",!1,y)},1e4);fetch(m,{signal:N.signal}).then($=>{clearTimeout(O),$.ok?gs(S,"TestPingServer: ok",!0,y):gs(S,"TestPingServer: server error",!1,y)}).catch(()=>{clearTimeout(O),gs(S,"TestPingServer: error",!1,y)})}function gs(m,y,S,N,O){try{O&&(O.onload=null,O.onerror=null,O.onabort=null,O.ontimeout=null),N(S)}catch{}}function Yh(){this.g=new e0}function go(m,y,S){const N=S||"";try{xu(m,function(O,$){let Y=O;u(O)&&(Y=yl(O)),y.push(N+$+"="+encodeURIComponent(Y))})}catch(O){throw y.push(N+"type="+encodeURIComponent("_badmap")),O}}function xo(m){this.l=m.Ub||null,this.j=m.eb||!1}x(xo,ds),xo.prototype.g=function(){return new El(this.l,this.j)},xo.prototype.i=function(m){return function(){return m}}({});function El(m,y){Tt.call(this),this.D=m,this.o=y,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}x(El,Tt),t=El.prototype,t.open=function(m,y){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=m,this.A=y,this.readyState=1,F(this)},t.send=function(m){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const y={headers:this.u,method:this.B,credentials:this.m,cache:void 0};m&&(y.body=m),(this.D||l).fetch(new Request(this.A,y)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,yo(this)),this.readyState=0},t.Sa=function(m){if(this.g&&(this.l=m,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=m.headers,this.readyState=2,F(this)),this.g&&(this.readyState=3,F(this),this.g)))if(this.responseType==="arraybuffer")m.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in m){if(this.j=m.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Jh(this)}else m.text().then(this.Ra.bind(this),this.ga.bind(this))};function Jh(m){m.j.read().then(m.Pa.bind(m)).catch(m.ga.bind(m))}t.Pa=function(m){if(this.g){if(this.o&&m.value)this.response.push(m.value);else if(!this.o){var y=m.value?m.value:new Uint8Array(0);(y=this.v.decode(y,{stream:!m.done}))&&(this.response=this.responseText+=y)}m.done?yo(this):F(this),this.readyState==3&&Jh(this)}},t.Ra=function(m){this.g&&(this.response=this.responseText=m,yo(this))},t.Qa=function(m){this.g&&(this.response=m,yo(this))},t.ga=function(){this.g&&yo(this)};function yo(m){m.readyState=4,m.l=null,m.j=null,m.v=null,F(m)}t.setRequestHeader=function(m,y){this.u.append(m,y)},t.getResponseHeader=function(m){return this.h&&this.h.get(m.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const m=[],y=this.h.entries();for(var S=y.next();!S.done;)S=S.value,m.push(S[0]+": "+S[1]),S=y.next();return m.join(`\r
`)};function F(m){m.onreadystatechange&&m.onreadystatechange.call(m)}Object.defineProperty(El.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(m){this.m=m?"include":"same-origin"}});function L(m){let y="";return M(m,function(S,N){y+=N,y+=":",y+=S,y+=`\r
`}),y}function G(m,y,S){e:{for(N in S){var N=!1;break e}N=!0}N||(S=L(S),typeof m=="string"?S!=null&&encodeURIComponent(String(S)):Je(m,y,S))}function Q(m){Tt.call(this),this.headers=new Map,this.o=m||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}x(Q,Tt);var tt=/^https?$/i,Ce=["POST","PUT"];t=Q.prototype,t.Ha=function(m){this.J=m},t.ea=function(m,y,S,N){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+m);y=y?y.toUpperCase():"GET",this.D=m,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():br.g(),this.v=this.o?hu(this.o):hu(br),this.g.onreadystatechange=p(this.Ea,this);try{this.B=!0,this.g.open(y,String(m),!0),this.B=!1}catch($){ct(this,$);return}if(m=S||"",S=new Map(this.headers),N)if(Object.getPrototypeOf(N)===Object.prototype)for(var O in N)S.set(O,N[O]);else if(typeof N.keys=="function"&&typeof N.get=="function")for(const $ of N.keys())S.set($,N.get($));else throw Error("Unknown input type for opt_headers: "+String(N));N=Array.from(S.keys()).find($=>$.toLowerCase()=="content-type"),O=l.FormData&&m instanceof l.FormData,!(0<=Array.prototype.indexOf.call(Ce,y,void 0))||N||O||S.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[$,Y]of S)this.g.setRequestHeader($,Y);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{An(this),this.u=!0,this.g.send(m),this.u=!1}catch($){ct(this,$)}};function ct(m,y){m.h=!1,m.g&&(m.j=!0,m.g.abort(),m.j=!1),m.l=y,m.m=5,It(m),Ze(m)}function It(m){m.A||(m.A=!0,Kt(m,"complete"),Kt(m,"error"))}t.abort=function(m){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=m||7,Kt(this,"complete"),Kt(this,"abort"),Ze(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ze(this,!0)),Q.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Lt(this):this.bb())},t.bb=function(){Lt(this)};function Lt(m){if(m.h&&typeof o<"u"&&(!m.v[1]||Ct(m)!=4||m.Z()!=2)){if(m.u&&Ct(m)==4)_r(m.Ea,0,m);else if(Kt(m,"readystatechange"),Ct(m)==4){m.h=!1;try{const Y=m.Z();e:switch(Y){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var y=!0;break e;default:y=!1}var S;if(!(S=y)){var N;if(N=Y===0){var O=String(m.D).match(qh)[1]||null;!O&&l.self&&l.self.location&&(O=l.self.location.protocol.slice(0,-1)),N=!tt.test(O?O.toLowerCase():"")}S=N}if(S)Kt(m,"complete"),Kt(m,"success");else{m.m=6;try{var $=2<Ct(m)?m.g.statusText:""}catch{$=""}m.l=$+" ["+m.Z()+"]",It(m)}}finally{Ze(m)}}}}function Ze(m,y){if(m.g){An(m);const S=m.g,N=m.v[0]?()=>{}:null;m.g=null,m.v=null,y||Kt(m,"ready");try{S.onreadystatechange=N}catch{}}}function An(m){m.I&&(l.clearTimeout(m.I),m.I=null)}t.isActive=function(){return!!this.g};function Ct(m){return m.g?m.g.readyState:0}t.Z=function(){try{return 2<Ct(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(m){if(this.g){var y=this.g.responseText;return m&&y.indexOf(m)==0&&(y=y.substring(m.length)),Ah(y)}};function Qt(m){try{if(!m.g)return null;if("response"in m.g)return m.g.response;switch(m.H){case"":case"text":return m.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in m.g)return m.g.mozResponseArrayBuffer}return null}catch{return null}}function fr(m){const y={};m=(m.g&&2<=Ct(m)&&m.g.getAllResponseHeaders()||"").split(`\r
`);for(let N=0;N<m.length;N++){if(b(m[N]))continue;var S=A(m[N]);const O=S[0];if(S=S[1],typeof S!="string")continue;S=S.trim();const $=y[O]||[];y[O]=$,$.push(S)}k(y,function(N){return N.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function sn(m,y,S){return S&&S.internalChannelParams&&S.internalChannelParams[m]||y}function xs(m){this.Aa=0,this.i=[],this.j=new aa,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=sn("failFast",!1,m),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=sn("baseRetryDelayMs",5e3,m),this.cb=sn("retryDelaySeedMs",1e4,m),this.Wa=sn("forwardChannelMaxRetries",2,m),this.wa=sn("forwardChannelRequestTimeoutMs",2e4,m),this.pa=m&&m.xmlHttpFactory||void 0,this.Xa=m&&m.Tb||void 0,this.Ca=m&&m.useFetchStreams||!1,this.L=void 0,this.J=m&&m.supportsCrossDomainXhr||!1,this.K="",this.h=new Vh(m&&m.concurrentRequestLimit),this.Da=new Yh,this.P=m&&m.fastHandshake||!1,this.O=m&&m.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=m&&m.Rb||!1,m&&m.xa&&this.j.xa(),m&&m.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&m&&m.detectBufferingProxy||!1,this.ja=void 0,m&&m.longPollingTimeout&&0<m.longPollingTimeout&&(this.ja=m.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=xs.prototype,t.la=8,t.G=1,t.connect=function(m,y,S,N){gn(0),this.W=m,this.H=y||{},S&&N!==void 0&&(this.H.OSID=S,this.H.OAID=N),this.F=this.X,this.I=L_(this,null,this.W),gi(this)};function Sr(m){if(wu(m),m.G==3){var y=m.U++,S=ms(m.I);if(Je(S,"SID",m.K),Je(S,"RID",y),Je(S,"TYPE","terminate"),_u(m,S),y=new Vs(m,m.j,y),y.L=2,y.v=pi(ms(S)),S=!1,l.navigator&&l.navigator.sendBeacon)try{S=l.navigator.sendBeacon(y.v.toString(),"")}catch{}!S&&l.Image&&(new Image().src=y.v,S=!0),S||(y.g=O_(y.j,null),y.g.ea(y.v)),y.F=Date.now(),bl(y)}D_(m)}function qr(m){m.g&&(f0(m),m.g.cancel(),m.g=null)}function wu(m){qr(m),m.u&&(l.clearTimeout(m.u),m.u=null),Zh(m),m.h.cancel(),m.s&&(typeof m.s=="number"&&l.clearTimeout(m.s),m.s=null)}function gi(m){if(!Uh(m.h)&&!m.s){m.s=!0;var y=m.Ga;Be||X(),B||(Be(),B=!0),K.add(y,m),m.B=0}}function jl(m,y){return Hh(m.h)>=m.h.j-(m.s?1:0)?!1:m.s?(m.i=y.D.concat(m.i),!0):m.G==1||m.G==2||m.B>=(m.Va?0:m.Wa)?!1:(m.s=oo(p(m.Ga,m,y),M_(m,m.B)),m.B++,!0)}t.Ga=function(m){if(this.s)if(this.s=null,this.G==1){if(!m){this.U=Math.floor(1e5*Math.random()),m=this.U++;const O=new Vs(this,this.j,m);let $=this.o;if(this.S&&($?($=E($),C($,this.S)):$=this.S),this.m!==null||this.O||(O.H=$,$=null),this.P)e:{for(var y=0,S=0;S<this.i.length;S++){t:{var N=this.i[S];if("__data__"in N.map&&(N=N.map.__data__,typeof N=="string")){N=N.length;break t}N=void 0}if(N===void 0)break;if(y+=N,4096<y){y=S;break e}if(y===4096||S===this.i.length-1){y=S+1;break e}}y=1e3}else y=1e3;y=N_(this,O,y),S=ms(this.I),Je(S,"RID",m),Je(S,"CVER",22),this.D&&Je(S,"X-HTTP-Session-Id",this.D),_u(this,S),$&&(this.O?y="headers="+encodeURIComponent(String(L($)))+"&"+y:this.m&&G(S,this.m,$)),gu(this.h,O),this.Ua&&Je(S,"TYPE","init"),this.P?(Je(S,"$req",y),Je(S,"SID","null"),O.T=!0,fs(O,S,null)):fs(O,S,y),this.G=2}}else this.G==3&&(m?R_(this,m):this.i.length==0||Uh(this.h)||R_(this))};function R_(m,y){var S;y?S=y.l:S=m.U++;const N=ms(m.I);Je(N,"SID",m.K),Je(N,"RID",S),Je(N,"AID",m.T),_u(m,N),m.m&&m.o&&G(N,m.m,m.o),S=new Vs(m,m.j,S,m.B+1),m.m===null&&(S.H=m.o),y&&(m.i=y.D.concat(m.i)),y=N_(m,S,1e3),S.I=Math.round(.5*m.wa)+Math.round(.5*m.wa*Math.random()),gu(m.h,S),fs(S,N,y)}function _u(m,y){m.H&&M(m.H,function(S,N){Je(y,N,S)}),m.l&&xu({},function(S,N){Je(y,N,S)})}function N_(m,y,S){S=Math.min(m.i.length,S);var N=m.l?p(m.l.Na,m.l,m):null;e:{var O=m.i;let $=-1;for(;;){const Y=["count="+S];$==-1?0<S?($=O[0].g,Y.push("ofs="+$)):$=0:Y.push("ofs="+$);let nt=!0;for(let xn=0;xn<S;xn++){let Ge=O[xn].g;const Pn=O[xn].map;if(Ge-=$,0>Ge)$=Math.max(0,O[xn].g-100),nt=!1;else try{go(Pn,Y,"req"+Ge+"_")}catch{N&&N(Pn)}}if(nt){N=Y.join("&");break e}}}return m=m.i.splice(0,S),y.D=m,N}function A_(m){if(!m.g&&!m.u){m.Y=1;var y=m.Fa;Be||X(),B||(Be(),B=!0),K.add(y,m),m.v=0}}function h0(m){return m.g||m.u||3<=m.v?!1:(m.Y++,m.u=oo(p(m.Fa,m),M_(m,m.v)),m.v++,!0)}t.Fa=function(){if(this.u=null,P_(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var m=2*this.R;this.j.info("BP detection timer enabled: "+m),this.A=oo(p(this.ab,this),m)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,gn(10),qr(this),P_(this))};function f0(m){m.A!=null&&(l.clearTimeout(m.A),m.A=null)}function P_(m){m.g=new Vs(m,m.j,"rpc",m.Y),m.m===null&&(m.g.H=m.o),m.g.O=0;var y=ms(m.qa);Je(y,"RID","rpc"),Je(y,"SID",m.K),Je(y,"AID",m.T),Je(y,"CI",m.F?"0":"1"),!m.F&&m.ja&&Je(y,"TO",m.ja),Je(y,"TYPE","xmlhttp"),_u(m,y),m.m&&m.o&&G(y,m.m,m.o),m.L&&(m.g.I=m.L);var S=m.g;m=m.ia,S.L=1,S.v=pi(ms(y)),S.m=null,S.P=!0,$h(S,m)}t.Za=function(){this.C!=null&&(this.C=null,qr(this),h0(this),gn(19))};function Zh(m){m.C!=null&&(l.clearTimeout(m.C),m.C=null)}function F_(m,y){var S=null;if(m.g==y){Zh(m),f0(m),m.g=null;var N=2}else if(pu(m.h,y))S=y.D,co(m.h,y),N=1;else return;if(m.G!=0){if(y.o)if(N==1){S=y.m?y.m.length:0,y=Date.now()-y.F;var O=m.B;N=sa(),Kt(N,new Mh(N,S)),gi(m)}else A_(m);else if(O=y.s,O==3||O==0&&0<y.X||!(N==1&&jl(m,y)||N==2&&h0(m)))switch(S&&0<S.length&&(y=m.h,y.i=y.i.concat(S)),O){case 1:vo(m,5);break;case 4:vo(m,10);break;case 3:vo(m,6);break;default:vo(m,2)}}}function M_(m,y){let S=m.Ta+Math.floor(Math.random()*m.cb);return m.isActive()||(S*=2),S*y}function vo(m,y){if(m.j.info("Error code "+y),y==2){var S=p(m.fb,m),N=m.Xa;const O=!N;N=new mi(N||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||ho(N,"https"),pi(N),O?d0(N.toString(),S):Xh(N.toString(),S)}else gn(2);m.G=0,m.l&&m.l.sa(y),D_(m),wu(m)}t.fb=function(m){m?(this.j.info("Successfully pinged google.com"),gn(2)):(this.j.info("Failed to ping google.com"),gn(1))};function D_(m){if(m.G=0,m.ka=[],m.l){const y=Gh(m.h);(y.length!=0||m.i.length!=0)&&(v(m.ka,y),v(m.ka,m.i),m.h.i.length=0,w(m.i),m.i.length=0),m.l.ra()}}function L_(m,y,S){var N=S instanceof mi?ms(S):new mi(S);if(N.g!="")y&&(N.g=y+"."+N.g),Sl(N,N.s);else{var O=l.location;N=O.protocol,y=y?y+"."+O.hostname:O.hostname,O=+O.port;var $=new mi(null);N&&ho($,N),y&&($.g=y),O&&Sl($,O),S&&($.l=S),N=$}return S=m.D,y=m.ya,S&&y&&Je(N,S,y),Je(N,"VER",m.la),_u(m,N),N}function O_(m,y,S){if(y&&!m.J)throw Error("Can't create secondary domain capable XhrIo object.");return y=m.Ca&&!m.pa?new Q(new xo({eb:S})):new Q(m.pa),y.Ha(m.J),y}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function $_(){}t=$_.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function ef(){}ef.prototype.g=function(m,y){return new Er(m,y)};function Er(m,y){Tt.call(this),this.g=new xs(y),this.l=m,this.h=y&&y.messageUrlParams||null,m=y&&y.messageHeaders||null,y&&y.clientProtocolHeaderRequired&&(m?m["X-Client-Protocol"]="webchannel":m={"X-Client-Protocol":"webchannel"}),this.g.o=m,m=y&&y.initMessageHeaders||null,y&&y.messageContentType&&(m?m["X-WebChannel-Content-Type"]=y.messageContentType:m={"X-WebChannel-Content-Type":y.messageContentType}),y&&y.va&&(m?m["X-WebChannel-Client-Profile"]=y.va:m={"X-WebChannel-Client-Profile":y.va}),this.g.S=m,(m=y&&y.Sb)&&!b(m)&&(this.g.m=m),this.v=y&&y.supportsCrossDomainXhr||!1,this.u=y&&y.sendRawJson||!1,(y=y&&y.httpSessionIdParam)&&!b(y)&&(this.g.D=y,m=this.h,m!==null&&y in m&&(m=this.h,y in m&&delete m[y])),this.j=new kl(this)}x(Er,Tt),Er.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Er.prototype.close=function(){Sr(this.g)},Er.prototype.o=function(m){var y=this.g;if(typeof m=="string"){var S={};S.__data__=m,m=S}else this.u&&(S={},S.__data__=yl(m),m=S);y.i.push(new s0(y.Ya++,m)),y.G==3&&gi(y)},Er.prototype.N=function(){this.g.l=null,delete this.j,Sr(this.g),delete this.g,Er.aa.N.call(this)};function z_(m){io.call(this),m.__headers__&&(this.headers=m.__headers__,this.statusCode=m.__status__,delete m.__headers__,delete m.__status__);var y=m.__sm__;if(y){e:{for(const S in y){m=S;break e}m=void 0}(this.i=m)&&(m=this.i,y=y!==null&&m in y?y[m]:void 0),this.data=y}else this.data=m}x(z_,io);function B_(){di.call(this),this.status=1}x(B_,di);function kl(m){this.g=m}x(kl,$_),kl.prototype.ua=function(){Kt(this.g,"a")},kl.prototype.ta=function(m){Kt(this.g,new z_(m))},kl.prototype.sa=function(m){Kt(this.g,new B_)},kl.prototype.ra=function(){Kt(this.g,"b")},ef.prototype.createWebChannel=ef.prototype.g,Er.prototype.send=Er.prototype.o,Er.prototype.open=Er.prototype.m,Er.prototype.close=Er.prototype.close,kI=function(){return new ef},jI=function(){return sa()},EI=hs,zy={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},wl.NO_ERROR=0,wl.TIMEOUT=8,wl.HTTP_ERROR=6,Zf=wl,Dh.COMPLETE="complete",SI=Dh,Ph.EventType=so,so.OPEN="a",so.CLOSE="b",so.ERROR="c",so.MESSAGE="d",Tt.prototype.listen=Tt.prototype.K,Lu=Ph,Q.prototype.listenOnce=Q.prototype.L,Q.prototype.getLastError=Q.prototype.Ka,Q.prototype.getLastErrorCode=Q.prototype.Ba,Q.prototype.getStatus=Q.prototype.Z,Q.prototype.getResponseJson=Q.prototype.Oa,Q.prototype.getResponseText=Q.prototype.oa,Q.prototype.send=Q.prototype.ea,Q.prototype.setWithCredentials=Q.prototype.Ha,bI=Q}).apply(typeof _f<"u"?_f:typeof self<"u"?self:typeof window<"u"?window:{});const Rb="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $n{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}$n.UNAUTHENTICATED=new $n(null),$n.GOOGLE_CREDENTIALS=new $n("google-credentials-uid"),$n.FIRST_PARTY=new $n("first-party-uid"),$n.MOCK_USER=new $n("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Gc="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wo=new q1("@firebase/firestore");function Nu(){return Wo.logLevel}function re(t,...e){if(Wo.logLevel<=$e.DEBUG){const n=e.map(X1);Wo.debug(`Firestore (${Gc}): ${t}`,...n)}}function zi(t,...e){if(Wo.logLevel<=$e.ERROR){const n=e.map(X1);Wo.error(`Firestore (${Gc}): ${t}`,...n)}}function vc(t,...e){if(Wo.logLevel<=$e.WARN){const n=e.map(X1);Wo.warn(`Firestore (${Gc}): ${t}`,...n)}}function X1(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Se(t="Unexpected state"){const e=`FIRESTORE (${Gc}) INTERNAL ASSERTION FAILED: `+t;throw zi(e),new Error(e)}function Xe(t,e){t||Se()}function Te(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Z extends Qi{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ni{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TI{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class SL{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n($n.UNAUTHENTICATED))}shutdown(){}}class EL{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class jL{constructor(e){this.t=e,this.currentUser=$n.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Xe(this.o===void 0);let r=this.i;const s=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve();let i=new Ni;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Ni,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const c=i;e.enqueueRetryable(async()=>{await c.promise,await s(this.currentUser)})},l=c=>{re("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>l(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?l(c):(re("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Ni)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(re("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Xe(typeof r.accessToken=="string"),new TI(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Xe(e===null||typeof e=="string"),new $n(e)}}class kL{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=$n.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class TL{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new kL(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n($n.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class IL{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class CL{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){Xe(this.o===void 0);const r=i=>{i.error!=null&&re("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.R;return this.R=i.token,re("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{re("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):re("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Xe(typeof n.token=="string"),this.R=n.token,new IL(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RL(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class II{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=RL(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%e.length))}return r}}function We(t,e){return t<e?-1:t>e?1:0}function wc(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bt{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new Z(V.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new Z(V.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new Z(V.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Z(V.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Bt.fromMillis(Date.now())}static fromDate(e){return Bt.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new Bt(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?We(this.nanoseconds,e.nanoseconds):We(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ke{constructor(e){this.timestamp=e}static fromTimestamp(e){return new ke(e)}static min(){return new ke(new Bt(0,0))}static max(){return new ke(new Bt(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ed{constructor(e,n,r){n===void 0?n=0:n>e.length&&Se(),r===void 0?r=e.length-n:r>e.length-n&&Se(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Ed.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Ed?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=e.get(s),o=n.get(s);if(i<o)return-1;if(i>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class it extends Ed{construct(e,n,r){return new it(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new Z(V.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new it(n)}static emptyPath(){return new it([])}}const NL=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class bn extends Ed{construct(e,n,r){return new bn(e,n,r)}static isValidIdentifier(e){return NL.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),bn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new bn(["__name__"])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new Z(V.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const l=e[s];if(l==="\\"){if(s+1===e.length)throw new Z(V.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[s+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new Z(V.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,s+=2}else l==="`"?(o=!o,s++):l!=="."||o?(r+=l,s++):(i(),s++)}if(i(),o)throw new Z(V.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new bn(n)}static emptyPath(){return new bn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ue{constructor(e){this.path=e}static fromPath(e){return new ue(it.fromString(e))}static fromName(e){return new ue(it.fromString(e).popFirst(5))}static empty(){return new ue(it.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&it.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return it.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ue(new it(e.slice()))}}function AL(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=ke.fromTimestamp(r===1e9?new Bt(n+1,0):new Bt(n,r));return new Ba(s,ue.empty(),e)}function PL(t){return new Ba(t.readTime,t.key,-1)}class Ba{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Ba(ke.min(),ue.empty(),-1)}static max(){return new Ba(ke.max(),ue.empty(),-1)}}function FL(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=ue.comparator(t.documentKey,e.documentKey),n!==0?n:We(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ML="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class DL{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nh(t){if(t.code!==V.FAILED_PRECONDITION||t.message!==ML)throw t;re("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Se(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new W((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof W?n:W.resolve(n)}catch(n){return W.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):W.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):W.reject(n)}static resolve(e){return new W((n,r)=>{n(e)})}static reject(e){return new W((n,r)=>{r(e)})}static waitFor(e){return new W((n,r)=>{let s=0,i=0,o=!1;e.forEach(l=>{++s,l.next(()=>{++i,o&&i===s&&n()},c=>r(c))}),o=!0,i===s&&n()})}static or(e){let n=W.resolve(!1);for(const r of e)n=n.next(s=>s?W.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new W((r,s)=>{const i=e.length,o=new Array(i);let l=0;for(let c=0;c<i;c++){const u=c;n(e[u]).next(d=>{o[u]=d,++l,l===i&&r(o)},d=>s(d))}})}static doWhile(e,n){return new W((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}function LL(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function rh(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y1{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Y1.oe=-1;function Zp(t){return t==null}function Hm(t){return t===0&&1/t==-1/0}function OL(t){return typeof t=="number"&&Number.isInteger(t)&&!Hm(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nb(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function ll(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function CI(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class St{constructor(e,n){this.comparator=e,this.root=n||_n.EMPTY}insert(e,n){return new St(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,_n.BLACK,null,null))}remove(e){return new St(this.comparator,this.root.remove(e,this.comparator).copy(null,null,_n.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new bf(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new bf(this.root,e,this.comparator,!1)}getReverseIterator(){return new bf(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new bf(this.root,e,this.comparator,!0)}}class bf{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class _n{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??_n.RED,this.left=s??_n.EMPTY,this.right=i??_n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new _n(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return _n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return _n.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,_n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,_n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Se();const e=this.left.check();if(e!==this.right.check())throw Se();return e+(this.isRed()?0:1)}}_n.EMPTY=null,_n.RED=!0,_n.BLACK=!1;_n.EMPTY=new class{constructor(){this.size=0}get key(){throw Se()}get value(){throw Se()}get color(){throw Se()}get left(){throw Se()}get right(){throw Se()}copy(e,n,r,s,i){return this}insert(e,n,r){return new _n(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jn{constructor(e){this.comparator=e,this.data=new St(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Ab(this.data.getIterator())}getIteratorFrom(e){return new Ab(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof jn)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new jn(this.comparator);return n.data=e,n}}class Ab{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pr{constructor(e){this.fields=e,e.sort(bn.comparator)}static empty(){return new Pr([])}unionWith(e){let n=new jn(bn.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Pr(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return wc(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RI extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class In{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new RI("Invalid base64 string: "+i):i}}(e);return new In(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new In(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return We(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}In.EMPTY_BYTE_STRING=new In("");const $L=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Va(t){if(Xe(!!t),typeof t=="string"){let e=0;const n=$L.exec(t);if(Xe(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Nt(t.seconds),nanos:Nt(t.nanos)}}function Nt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function qo(t){return typeof t=="string"?In.fromBase64String(t):In.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eg(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function J1(t){const e=t.mapValue.fields.__previous_value__;return eg(e)?J1(e):e}function jd(t){const e=Va(t.mapValue.fields.__local_write_time__.timestampValue);return new Bt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zL{constructor(e,n,r,s,i,o,l,c,u){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=u}}class kd{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new kd("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof kd&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sf={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Ko(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?eg(t)?4:VL(t)?9007199254740991:BL(t)?10:11:Se()}function ri(t,e){if(t===e)return!0;const n=Ko(t);if(n!==Ko(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return jd(t).isEqual(jd(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=Va(s.timestampValue),l=Va(i.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return qo(s.bytesValue).isEqual(qo(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return Nt(s.geoPointValue.latitude)===Nt(i.geoPointValue.latitude)&&Nt(s.geoPointValue.longitude)===Nt(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return Nt(s.integerValue)===Nt(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=Nt(s.doubleValue),l=Nt(i.doubleValue);return o===l?Hm(o)===Hm(l):isNaN(o)&&isNaN(l)}return!1}(t,e);case 9:return wc(t.arrayValue.values||[],e.arrayValue.values||[],ri);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},l=i.mapValue.fields||{};if(Nb(o)!==Nb(l))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(l[c]===void 0||!ri(o[c],l[c])))return!1;return!0}(t,e);default:return Se()}}function Td(t,e){return(t.values||[]).find(n=>ri(n,e))!==void 0}function _c(t,e){if(t===e)return 0;const n=Ko(t),r=Ko(e);if(n!==r)return We(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return We(t.booleanValue,e.booleanValue);case 2:return function(i,o){const l=Nt(i.integerValue||i.doubleValue),c=Nt(o.integerValue||o.doubleValue);return l<c?-1:l>c?1:l===c?0:isNaN(l)?isNaN(c)?0:-1:1}(t,e);case 3:return Pb(t.timestampValue,e.timestampValue);case 4:return Pb(jd(t),jd(e));case 5:return We(t.stringValue,e.stringValue);case 6:return function(i,o){const l=qo(i),c=qo(o);return l.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const l=i.split("/"),c=o.split("/");for(let u=0;u<l.length&&u<c.length;u++){const d=We(l[u],c[u]);if(d!==0)return d}return We(l.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const l=We(Nt(i.latitude),Nt(o.latitude));return l!==0?l:We(Nt(i.longitude),Nt(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return Fb(t.arrayValue,e.arrayValue);case 10:return function(i,o){var l,c,u,d;const f=i.fields||{},p=o.fields||{},g=(l=f.value)===null||l===void 0?void 0:l.arrayValue,x=(c=p.value)===null||c===void 0?void 0:c.arrayValue,w=We(((u=g==null?void 0:g.values)===null||u===void 0?void 0:u.length)||0,((d=x==null?void 0:x.values)===null||d===void 0?void 0:d.length)||0);return w!==0?w:Fb(g,x)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===Sf.mapValue&&o===Sf.mapValue)return 0;if(i===Sf.mapValue)return 1;if(o===Sf.mapValue)return-1;const l=i.fields||{},c=Object.keys(l),u=o.fields||{},d=Object.keys(u);c.sort(),d.sort();for(let f=0;f<c.length&&f<d.length;++f){const p=We(c[f],d[f]);if(p!==0)return p;const g=_c(l[c[f]],u[d[f]]);if(g!==0)return g}return We(c.length,d.length)}(t.mapValue,e.mapValue);default:throw Se()}}function Pb(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return We(t,e);const n=Va(t),r=Va(e),s=We(n.seconds,r.seconds);return s!==0?s:We(n.nanos,r.nanos)}function Fb(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=_c(n[s],r[s]);if(i)return i}return We(n.length,r.length)}function bc(t){return By(t)}function By(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Va(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return qo(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return ue.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=By(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${By(n.fields[o])}`;return s+"}"}(t.mapValue):Se()}function Gm(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Vy(t){return!!t&&"integerValue"in t}function Z1(t){return!!t&&"arrayValue"in t}function Mb(t){return!!t&&"nullValue"in t}function Db(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function em(t){return!!t&&"mapValue"in t}function BL(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function Zu(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return ll(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Zu(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Zu(t.arrayValue.values[n]);return e}return Object.assign({},t)}function VL(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pr{constructor(e){this.value=e}static empty(){return new pr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!em(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Zu(n)}setAll(e){let n=bn.emptyPath(),r={},s=[];e.forEach((o,l)=>{if(!n.isImmediateParentOf(l)){const c=this.getFieldsMap(n);this.applyChanges(c,r,s),r={},s=[],n=l.popLast()}o?r[l.lastSegment()]=Zu(o):s.push(l.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());em(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return ri(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];em(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){ll(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new pr(Zu(this.value))}}function NI(t){const e=[];return ll(t.fields,(n,r)=>{const s=new bn([n]);if(em(r)){const i=NI(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new Pr(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bn{constructor(e,n,r,s,i,o,l){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=l}static newInvalidDocument(e){return new Bn(e,0,ke.min(),ke.min(),ke.min(),pr.empty(),0)}static newFoundDocument(e,n,r,s){return new Bn(e,1,n,ke.min(),r,s,0)}static newNoDocument(e,n){return new Bn(e,2,n,ke.min(),ke.min(),pr.empty(),0)}static newUnknownDocument(e,n){return new Bn(e,3,n,ke.min(),ke.min(),pr.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(ke.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=pr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=pr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ke.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Bn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Bn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sc{constructor(e,n){this.position=e,this.inclusive=n}}function Lb(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=ue.comparator(ue.fromName(o.referenceValue),n.key):r=_c(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function Ob(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!ri(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Id{constructor(e,n="asc"){this.field=e,this.dir=n}}function UL(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AI{}class zt extends AI{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new GL(e,n,r):n==="array-contains"?new KL(e,r):n==="in"?new QL(e,r):n==="not-in"?new XL(e,r):n==="array-contains-any"?new YL(e,r):new zt(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new WL(e,r):new qL(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(_c(n,this.value)):n!==null&&Ko(this.value)===Ko(n)&&this.matchesComparison(_c(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Se()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ps extends AI{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new Ps(e,n)}matches(e){return PI(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function PI(t){return t.op==="and"}function FI(t){return HL(t)&&PI(t)}function HL(t){for(const e of t.filters)if(e instanceof Ps)return!1;return!0}function Uy(t){if(t instanceof zt)return t.field.canonicalString()+t.op.toString()+bc(t.value);if(FI(t))return t.filters.map(e=>Uy(e)).join(",");{const e=t.filters.map(n=>Uy(n)).join(",");return`${t.op}(${e})`}}function MI(t,e){return t instanceof zt?function(r,s){return s instanceof zt&&r.op===s.op&&r.field.isEqual(s.field)&&ri(r.value,s.value)}(t,e):t instanceof Ps?function(r,s){return s instanceof Ps&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,l)=>i&&MI(o,s.filters[l]),!0):!1}(t,e):void Se()}function DI(t){return t instanceof zt?function(n){return`${n.field.canonicalString()} ${n.op} ${bc(n.value)}`}(t):t instanceof Ps?function(n){return n.op.toString()+" {"+n.getFilters().map(DI).join(" ,")+"}"}(t):"Filter"}class GL extends zt{constructor(e,n,r){super(e,n,r),this.key=ue.fromName(r.referenceValue)}matches(e){const n=ue.comparator(e.key,this.key);return this.matchesComparison(n)}}class WL extends zt{constructor(e,n){super(e,"in",n),this.keys=LI("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class qL extends zt{constructor(e,n){super(e,"not-in",n),this.keys=LI("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function LI(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>ue.fromName(r.referenceValue))}class KL extends zt{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Z1(n)&&Td(n.arrayValue,this.value)}}class QL extends zt{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Td(this.value.arrayValue,n)}}class XL extends zt{constructor(e,n){super(e,"not-in",n)}matches(e){if(Td(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!Td(this.value.arrayValue,n)}}class YL extends zt{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Z1(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Td(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JL{constructor(e,n=null,r=[],s=[],i=null,o=null,l=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=l,this.ue=null}}function $b(t,e=null,n=[],r=[],s=null,i=null,o=null){return new JL(t,e,n,r,s,i,o)}function ew(t){const e=Te(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Uy(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),Zp(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>bc(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>bc(r)).join(",")),e.ue=n}return e.ue}function tw(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!UL(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!MI(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Ob(t.startAt,e.startAt)&&Ob(t.endAt,e.endAt)}function Hy(t){return ue.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cl{constructor(e,n=null,r=[],s=[],i=null,o="F",l=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=l,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function ZL(t,e,n,r,s,i,o,l){return new cl(t,e,n,r,s,i,o,l)}function nw(t){return new cl(t)}function zb(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function rw(t){return t.collectionGroup!==null}function sc(t){const e=Te(t);if(e.ce===null){e.ce=[];const n=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new jn(bn.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(u=>{u.isInequality()&&(l=l.add(u.field))})}),l})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.ce.push(new Id(i,r))}),n.has(bn.keyField().canonicalString())||e.ce.push(new Id(bn.keyField(),r))}return e.ce}function ei(t){const e=Te(t);return e.le||(e.le=eO(e,sc(t))),e.le}function eO(t,e){if(t.limitType==="F")return $b(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new Id(s.field,i)});const n=t.endAt?new Sc(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Sc(t.startAt.position,t.startAt.inclusive):null;return $b(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Gy(t,e){const n=t.filters.concat([e]);return new cl(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Wm(t,e,n){return new cl(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function tg(t,e){return tw(ei(t),ei(e))&&t.limitType===e.limitType}function OI(t){return`${ew(ei(t))}|lt:${t.limitType}`}function Fl(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>DI(s)).join(", ")}]`),Zp(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>bc(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>bc(s)).join(",")),`Target(${r})`}(ei(t))}; limitType=${t.limitType})`}function ng(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):ue.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of sc(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,l,c){const u=Lb(o,l,c);return o.inclusive?u<=0:u<0}(r.startAt,sc(r),s)||r.endAt&&!function(o,l,c){const u=Lb(o,l,c);return o.inclusive?u>=0:u>0}(r.endAt,sc(r),s))}(t,e)}function tO(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function $I(t){return(e,n)=>{let r=!1;for(const s of sc(t)){const i=nO(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function nO(t,e,n){const r=t.field.isKeyField()?ue.comparator(e.key,n.key):function(i,o,l){const c=o.data.field(i),u=l.data.field(i);return c!==null&&u!==null?_c(c,u):Se()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Se()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wc{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){ll(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return CI(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rO=new St(ue.comparator);function Bi(){return rO}const zI=new St(ue.comparator);function Ou(...t){let e=zI;for(const n of t)e=e.insert(n.key,n);return e}function BI(t){let e=zI;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Po(){return ed()}function VI(){return ed()}function ed(){return new Wc(t=>t.toString(),(t,e)=>t.isEqual(e))}const sO=new St(ue.comparator),iO=new jn(ue.comparator);function Le(...t){let e=iO;for(const n of t)e=e.add(n);return e}const aO=new jn(We);function oO(){return aO}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sw(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Hm(e)?"-0":e}}function UI(t){return{integerValue:""+t}}function HI(t,e){return OL(e)?UI(e):sw(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rg{constructor(){this._=void 0}}function lO(t,e,n){return t instanceof Cd?function(s,i){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&eg(i)&&(i=J1(i)),i&&(o.fields.__previous_value__=i),{mapValue:o}}(n,e):t instanceof Rd?WI(t,e):t instanceof Nd?qI(t,e):function(s,i){const o=GI(s,i),l=Bb(o)+Bb(s.Pe);return Vy(o)&&Vy(s.Pe)?UI(l):sw(s.serializer,l)}(t,e)}function cO(t,e,n){return t instanceof Rd?WI(t,e):t instanceof Nd?qI(t,e):n}function GI(t,e){return t instanceof Ad?function(r){return Vy(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class Cd extends rg{}class Rd extends rg{constructor(e){super(),this.elements=e}}function WI(t,e){const n=KI(e);for(const r of t.elements)n.some(s=>ri(s,r))||n.push(r);return{arrayValue:{values:n}}}class Nd extends rg{constructor(e){super(),this.elements=e}}function qI(t,e){let n=KI(e);for(const r of t.elements)n=n.filter(s=>!ri(s,r));return{arrayValue:{values:n}}}class Ad extends rg{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function Bb(t){return Nt(t.integerValue||t.doubleValue)}function KI(t){return Z1(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QI{constructor(e,n){this.field=e,this.transform=n}}function uO(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof Rd&&s instanceof Rd||r instanceof Nd&&s instanceof Nd?wc(r.elements,s.elements,ri):r instanceof Ad&&s instanceof Ad?ri(r.Pe,s.Pe):r instanceof Cd&&s instanceof Cd}(t.transform,e.transform)}class dO{constructor(e,n){this.version=e,this.transformResults=n}}class Jn{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Jn}static exists(e){return new Jn(void 0,e)}static updateTime(e){return new Jn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function tm(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class sg{}function XI(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new ig(t.key,Jn.none()):new sh(t.key,t.data,Jn.none());{const n=t.data,r=pr.empty();let s=new jn(bn.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new Ya(t.key,r,new Pr(s.toArray()),Jn.none())}}function hO(t,e,n){t instanceof sh?function(s,i,o){const l=s.value.clone(),c=Ub(s.fieldTransforms,i,o.transformResults);l.setAll(c),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):t instanceof Ya?function(s,i,o){if(!tm(s.precondition,i))return void i.convertToUnknownDocument(o.version);const l=Ub(s.fieldTransforms,i,o.transformResults),c=i.data;c.setAll(YI(s)),c.setAll(l),i.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function td(t,e,n,r){return t instanceof sh?function(i,o,l,c){if(!tm(i.precondition,o))return l;const u=i.value.clone(),d=Hb(i.fieldTransforms,c,o);return u.setAll(d),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(t,e,n,r):t instanceof Ya?function(i,o,l,c){if(!tm(i.precondition,o))return l;const u=Hb(i.fieldTransforms,c,o),d=o.data;return d.setAll(YI(i)),d.setAll(u),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),l===null?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(f=>f.field))}(t,e,n,r):function(i,o,l){return tm(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(t,e,n)}function fO(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=GI(r.transform,s||null);i!=null&&(n===null&&(n=pr.empty()),n.set(r.field,i))}return n||null}function Vb(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&wc(r,s,(i,o)=>uO(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class sh extends sg{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Ya extends sg{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function YI(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function Ub(t,e,n){const r=new Map;Xe(t.length===n.length);for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,l=e.data.field(i.field);r.set(i.field,cO(o,l,n[s]))}return r}function Hb(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,lO(i,o,e))}return r}class ig extends sg{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class mO extends sg{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pO{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&hO(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=td(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=td(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=VI();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let l=this.applyToLocalView(o,i.mutatedFields);l=n.has(s.key)?null:l;const c=XI(o,l);c!==null&&r.set(s.key,c),o.isValidDocument()||o.convertToNoDocument(ke.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Le())}isEqual(e){return this.batchId===e.batchId&&wc(this.mutations,e.mutations,(n,r)=>Vb(n,r))&&wc(this.baseMutations,e.baseMutations,(n,r)=>Vb(n,r))}}class iw{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){Xe(e.mutations.length===r.length);let s=function(){return sO}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new iw(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gO{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xO{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ot,Ve;function yO(t){switch(t){default:return Se();case V.CANCELLED:case V.UNKNOWN:case V.DEADLINE_EXCEEDED:case V.RESOURCE_EXHAUSTED:case V.INTERNAL:case V.UNAVAILABLE:case V.UNAUTHENTICATED:return!1;case V.INVALID_ARGUMENT:case V.NOT_FOUND:case V.ALREADY_EXISTS:case V.PERMISSION_DENIED:case V.FAILED_PRECONDITION:case V.ABORTED:case V.OUT_OF_RANGE:case V.UNIMPLEMENTED:case V.DATA_LOSS:return!0}}function JI(t){if(t===void 0)return zi("GRPC error has no .code"),V.UNKNOWN;switch(t){case Ot.OK:return V.OK;case Ot.CANCELLED:return V.CANCELLED;case Ot.UNKNOWN:return V.UNKNOWN;case Ot.DEADLINE_EXCEEDED:return V.DEADLINE_EXCEEDED;case Ot.RESOURCE_EXHAUSTED:return V.RESOURCE_EXHAUSTED;case Ot.INTERNAL:return V.INTERNAL;case Ot.UNAVAILABLE:return V.UNAVAILABLE;case Ot.UNAUTHENTICATED:return V.UNAUTHENTICATED;case Ot.INVALID_ARGUMENT:return V.INVALID_ARGUMENT;case Ot.NOT_FOUND:return V.NOT_FOUND;case Ot.ALREADY_EXISTS:return V.ALREADY_EXISTS;case Ot.PERMISSION_DENIED:return V.PERMISSION_DENIED;case Ot.FAILED_PRECONDITION:return V.FAILED_PRECONDITION;case Ot.ABORTED:return V.ABORTED;case Ot.OUT_OF_RANGE:return V.OUT_OF_RANGE;case Ot.UNIMPLEMENTED:return V.UNIMPLEMENTED;case Ot.DATA_LOSS:return V.DATA_LOSS;default:return Se()}}(Ve=Ot||(Ot={}))[Ve.OK=0]="OK",Ve[Ve.CANCELLED=1]="CANCELLED",Ve[Ve.UNKNOWN=2]="UNKNOWN",Ve[Ve.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ve[Ve.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ve[Ve.NOT_FOUND=5]="NOT_FOUND",Ve[Ve.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ve[Ve.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ve[Ve.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ve[Ve.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ve[Ve.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ve[Ve.ABORTED=10]="ABORTED",Ve[Ve.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ve[Ve.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ve[Ve.INTERNAL=13]="INTERNAL",Ve[Ve.UNAVAILABLE=14]="UNAVAILABLE",Ve[Ve.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vO(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wO=new Lo([4294967295,4294967295],0);function Gb(t){const e=vO().encode(t),n=new _I;return n.update(e),new Uint8Array(n.digest())}function Wb(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Lo([n,r],0),new Lo([s,i],0)]}class aw{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new $u(`Invalid padding: ${n}`);if(r<0)throw new $u(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new $u(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new $u(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=Lo.fromNumber(this.Ie)}Ee(e,n,r){let s=e.add(n.multiply(Lo.fromNumber(r)));return s.compare(wO)===1&&(s=new Lo([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=Gb(e),[r,s]=Wb(n);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);if(!this.de(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new aw(i,s,n);return r.forEach(l=>o.insert(l)),o}insert(e){if(this.Ie===0)return;const n=Gb(e),[r,s]=Wb(n);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);this.Ae(o)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class $u extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ag{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,ih.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new ag(ke.min(),s,new St(We),Bi(),Le())}}class ih{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new ih(r,n,Le(),Le(),Le())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nm{constructor(e,n,r,s){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=s}}class ZI{constructor(e,n){this.targetId=e,this.me=n}}class eC{constructor(e,n,r=In.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class qb{constructor(){this.fe=0,this.ge=Qb(),this.pe=In.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Le(),n=Le(),r=Le();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:Se()}}),new ih(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=Qb()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Xe(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class _O{constructor(e){this.Le=e,this.Be=new Map,this.ke=Bi(),this.qe=Kb(),this.Qe=new St(We)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:Se()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,s)=>{this.ze(s)&&n(s)})}He(e){const n=e.targetId,r=e.me.count,s=this.Je(n);if(s){const i=s.target;if(Hy(i))if(r===0){const o=new ue(i.path);this.Ue(n,o,Bn.newNoDocument(o,ke.min()))}else Xe(r===1);else{const o=this.Ye(n);if(o!==r){const l=this.Ze(e),c=l?this.Xe(l,e,o):1;if(c!==0){this.je(n);const u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,u)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,l;try{o=qo(r).toUint8Array()}catch(c){if(c instanceof RI)return vc("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{l=new aw(o,s,i)}catch(c){return vc(c instanceof $u?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return l.Ie===0?null:l}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.Le.tt(),l=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(l)||(this.Ue(n,i,null),s++)}),s}rt(e){const n=new Map;this.Be.forEach((i,o)=>{const l=this.Je(o);if(l){if(i.current&&Hy(l.target)){const c=new ue(l.target.path);this.ke.get(c)!==null||this.it(o,c)||this.Ue(o,c,Bn.newNoDocument(c,e))}i.be&&(n.set(o,i.ve()),i.Ce())}});let r=Le();this.qe.forEach((i,o)=>{let l=!0;o.forEachWhile(c=>{const u=this.Je(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(i))}),this.ke.forEach((i,o)=>o.setReadTime(e));const s=new ag(e,n,this.Qe,this.ke,r);return this.ke=Bi(),this.qe=Kb(),this.Qe=new St(We),s}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,n)?s.Fe(n,1):s.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new qb,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new jn(We),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||re("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new qb),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function Kb(){return new St(ue.comparator)}function Qb(){return new St(ue.comparator)}const bO=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),SO=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),EO=(()=>({and:"AND",or:"OR"}))();class jO{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Wy(t,e){return t.useProto3Json||Zp(e)?e:{value:e}}function qm(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function tC(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function kO(t,e){return qm(t,e.toTimestamp())}function ti(t){return Xe(!!t),ke.fromTimestamp(function(n){const r=Va(n);return new Bt(r.seconds,r.nanos)}(t))}function ow(t,e){return qy(t,e).canonicalString()}function qy(t,e){const n=function(s){return new it(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function nC(t){const e=it.fromString(t);return Xe(oC(e)),e}function Ky(t,e){return ow(t.databaseId,e.path)}function X0(t,e){const n=nC(e);if(n.get(1)!==t.databaseId.projectId)throw new Z(V.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new Z(V.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new ue(sC(n))}function rC(t,e){return ow(t.databaseId,e)}function TO(t){const e=nC(t);return e.length===4?it.emptyPath():sC(e)}function Qy(t){return new it(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function sC(t){return Xe(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function Xb(t,e,n){return{name:Ky(t,e),fields:n.value.mapValue.fields}}function IO(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:Se()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(u,d){return u.useProto3Json?(Xe(d===void 0||typeof d=="string"),In.fromBase64String(d||"")):(Xe(d===void 0||d instanceof Buffer||d instanceof Uint8Array),In.fromUint8Array(d||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(u){const d=u.code===void 0?V.UNKNOWN:JI(u.code);return new Z(d,u.message||"")}(o);n=new eC(r,s,i,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=X0(t,r.document.name),i=ti(r.document.updateTime),o=r.document.createTime?ti(r.document.createTime):ke.min(),l=new pr({mapValue:{fields:r.document.fields}}),c=Bn.newFoundDocument(s,i,o,l),u=r.targetIds||[],d=r.removedTargetIds||[];n=new nm(u,d,c.key,c)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=X0(t,r.document),i=r.readTime?ti(r.readTime):ke.min(),o=Bn.newNoDocument(s,i),l=r.removedTargetIds||[];n=new nm([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=X0(t,r.document),i=r.removedTargetIds||[];n=new nm([],i,s,null)}else{if(!("filter"in e))return Se();{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new xO(s,i),l=r.targetId;n=new ZI(l,o)}}return n}function CO(t,e){let n;if(e instanceof sh)n={update:Xb(t,e.key,e.value)};else if(e instanceof ig)n={delete:Ky(t,e.key)};else if(e instanceof Ya)n={update:Xb(t,e.key,e.data),updateMask:OO(e.fieldMask)};else{if(!(e instanceof mO))return Se();n={verify:Ky(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const l=o.transform;if(l instanceof Cd)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof Rd)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Nd)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Ad)return{fieldPath:o.field.canonicalString(),increment:l.Pe};throw Se()}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:kO(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:Se()}(t,e.precondition)),n}function RO(t,e){return t&&t.length>0?(Xe(e!==void 0),t.map(n=>function(s,i){let o=s.updateTime?ti(s.updateTime):ti(i);return o.isEqual(ke.min())&&(o=ti(i)),new dO(o,s.transformResults||[])}(n,e))):[]}function NO(t,e){return{documents:[rC(t,e.path)]}}function AO(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=rC(t,s);const i=function(u){if(u.length!==0)return aC(Ps.create(u,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(u){if(u.length!==0)return u.map(d=>function(p){return{field:Ml(p.field),direction:MO(p.dir)}}(d))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const l=Wy(t,e.limit);return l!==null&&(n.structuredQuery.limit=l),e.startAt&&(n.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{_t:n,parent:s}}function PO(t){let e=TO(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){Xe(r===1);const d=n.from[0];d.allDescendants?s=d.collectionId:e=e.child(d.collectionId)}let i=[];n.where&&(i=function(f){const p=iC(f);return p instanceof Ps&&FI(p)?p.getFilters():[p]}(n.where));let o=[];n.orderBy&&(o=function(f){return f.map(p=>function(x){return new Id(Dl(x.field),function(v){switch(v){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(x.direction))}(p))}(n.orderBy));let l=null;n.limit&&(l=function(f){let p;return p=typeof f=="object"?f.value:f,Zp(p)?null:p}(n.limit));let c=null;n.startAt&&(c=function(f){const p=!!f.before,g=f.values||[];return new Sc(g,p)}(n.startAt));let u=null;return n.endAt&&(u=function(f){const p=!f.before,g=f.values||[];return new Sc(g,p)}(n.endAt)),ZL(e,s,o,i,l,"F",c,u)}function FO(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Se()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function iC(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Dl(n.unaryFilter.field);return zt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Dl(n.unaryFilter.field);return zt.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Dl(n.unaryFilter.field);return zt.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Dl(n.unaryFilter.field);return zt.create(o,"!=",{nullValue:"NULL_VALUE"});default:return Se()}}(t):t.fieldFilter!==void 0?function(n){return zt.create(Dl(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Se()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Ps.create(n.compositeFilter.filters.map(r=>iC(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return Se()}}(n.compositeFilter.op))}(t):Se()}function MO(t){return bO[t]}function DO(t){return SO[t]}function LO(t){return EO[t]}function Ml(t){return{fieldPath:t.canonicalString()}}function Dl(t){return bn.fromServerFormat(t.fieldPath)}function aC(t){return t instanceof zt?function(n){if(n.op==="=="){if(Db(n.value))return{unaryFilter:{field:Ml(n.field),op:"IS_NAN"}};if(Mb(n.value))return{unaryFilter:{field:Ml(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(Db(n.value))return{unaryFilter:{field:Ml(n.field),op:"IS_NOT_NAN"}};if(Mb(n.value))return{unaryFilter:{field:Ml(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ml(n.field),op:DO(n.op),value:n.value}}}(t):t instanceof Ps?function(n){const r=n.getFilters().map(s=>aC(s));return r.length===1?r[0]:{compositeFilter:{op:LO(n.op),filters:r}}}(t):Se()}function OO(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function oC(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ea{constructor(e,n,r,s,i=ke.min(),o=ke.min(),l=In.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(e){return new Ea(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Ea(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ea(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ea(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $O{constructor(e){this.ct=e}}function zO(t){const e=PO({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Wm(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BO{constructor(){this.un=new VO}addToCollectionParentIndex(e,n){return this.un.add(n),W.resolve()}getCollectionParents(e,n){return W.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return W.resolve()}deleteFieldIndex(e,n){return W.resolve()}deleteAllFieldIndexes(e){return W.resolve()}createTargetIndexes(e,n){return W.resolve()}getDocumentsMatchingTarget(e,n){return W.resolve(null)}getIndexType(e,n){return W.resolve(0)}getFieldIndexes(e,n){return W.resolve([])}getNextCollectionGroupToUpdate(e){return W.resolve(null)}getMinOffset(e,n){return W.resolve(Ba.min())}getMinOffsetFromCollectionGroup(e,n){return W.resolve(Ba.min())}updateCollectionGroup(e,n,r){return W.resolve()}updateIndexEntries(e,n){return W.resolve()}}class VO{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new jn(it.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new jn(it.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ec{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new Ec(0)}static kn(){return new Ec(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UO{constructor(){this.changes=new Wc(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Bn.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?W.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HO{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GO{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&td(r.mutation,s,Pr.empty(),Bt.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Le()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Le()){const s=Po();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=Ou();return i.forEach((l,c)=>{o=o.insert(l,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=Po();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Le()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,l)=>{n.set(o,l)})})}computeViews(e,n,r,s){let i=Bi();const o=ed(),l=function(){return ed()}();return n.forEach((c,u)=>{const d=r.get(u.key);s.has(u.key)&&(d===void 0||d.mutation instanceof Ya)?i=i.insert(u.key,u):d!==void 0?(o.set(u.key,d.mutation.getFieldMask()),td(d.mutation,u,d.mutation.getFieldMask(),Bt.now())):o.set(u.key,Pr.empty())}),this.recalculateAndSaveOverlays(e,i).next(c=>(c.forEach((u,d)=>o.set(u,d)),n.forEach((u,d)=>{var f;return l.set(u,new HO(d,(f=o.get(u))!==null&&f!==void 0?f:null))}),l))}recalculateAndSaveOverlays(e,n){const r=ed();let s=new St((o,l)=>o-l),i=Le();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const l of o)l.keys().forEach(c=>{const u=n.get(c);if(u===null)return;let d=r.get(c)||Pr.empty();d=l.applyToLocalView(u,d),r.set(c,d);const f=(s.get(l.batchId)||Le()).add(c);s=s.insert(l.batchId,f)})}).next(()=>{const o=[],l=s.getReverseIterator();for(;l.hasNext();){const c=l.getNext(),u=c.key,d=c.value,f=VI();d.forEach(p=>{if(!i.has(p)){const g=XI(n.get(p),r.get(p));g!==null&&f.set(p,g),i=i.add(p)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,f))}return W.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(o){return ue.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):rw(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):W.resolve(Po());let l=-1,c=i;return o.next(u=>W.forEach(u,(d,f)=>(l<f.largestBatchId&&(l=f.largestBatchId),i.get(d)?W.resolve():this.remoteDocumentCache.getEntry(e,d).next(p=>{c=c.insert(d,p)}))).next(()=>this.populateOverlays(e,u,i)).next(()=>this.computeViews(e,c,u,Le())).next(d=>({batchId:l,changes:BI(d)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new ue(n)).next(r=>{let s=Ou();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=Ou();return this.indexManager.getCollectionParents(e,i).next(l=>W.forEach(l,c=>{const u=function(f,p){return new cl(p,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(n,c.child(i));return this.getDocumentsMatchingCollectionQuery(e,u,r,s).next(d=>{d.forEach((f,p)=>{o=o.insert(f,p)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((c,u)=>{const d=u.getKey();o.get(d)===null&&(o=o.insert(d,Bn.newInvalidDocument(d)))});let l=Ou();return o.forEach((c,u)=>{const d=i.get(c);d!==void 0&&td(d.mutation,u,Pr.empty(),Bt.now()),ng(n,u)&&(l=l.insert(c,u))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WO{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return W.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:ti(s.createTime)}}(n)),W.resolve()}getNamedQuery(e,n){return W.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(s){return{name:s.name,query:zO(s.bundledQuery),readTime:ti(s.readTime)}}(n)),W.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qO{constructor(){this.overlays=new St(ue.comparator),this.Ir=new Map}getOverlay(e,n){return W.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Po();return W.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.ht(e,n,i)}),W.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.Ir.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(r)),W.resolve()}getOverlaysForCollection(e,n,r){const s=Po(),i=n.length+1,o=new ue(n.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const c=l.getNext().value,u=c.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===i&&c.largestBatchId>r&&s.set(c.getKey(),c)}return W.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new St((u,d)=>u-d);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>r){let d=i.get(u.largestBatchId);d===null&&(d=Po(),i=i.insert(u.largestBatchId,d)),d.set(u.getKey(),u)}}const l=Po(),c=i.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,d)=>l.set(u,d)),!(l.size()>=s)););return W.resolve(l)}ht(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.Ir.get(s.largestBatchId).delete(r.key);this.Ir.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new gO(n,r));let i=this.Ir.get(n);i===void 0&&(i=Le(),this.Ir.set(n,i)),this.Ir.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KO{constructor(){this.sessionToken=In.EMPTY_BYTE_STRING}getSessionToken(e){return W.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,W.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lw{constructor(){this.Tr=new jn(an.Er),this.dr=new jn(an.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new an(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new an(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new ue(new it([])),r=new an(n,e),s=new an(n,e+1),i=[];return this.dr.forEachInRange([r,s],o=>{this.Vr(o),i.push(o.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new ue(new it([])),r=new an(n,e),s=new an(n,e+1);let i=Le();return this.dr.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new an(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class an{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return ue.comparator(e.key,n.key)||We(e.wr,n.wr)}static Ar(e,n){return We(e.wr,n.wr)||ue.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QO{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new jn(an.Er)}checkEmpty(e){return W.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new pO(i,n,r,s);this.mutationQueue.push(o);for(const l of s)this.br=this.br.add(new an(l.key,i)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return W.resolve(o)}lookupMutationBatch(e,n){return W.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.vr(r),i=s<0?0:s;return W.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return W.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return W.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new an(n,0),s=new an(n,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([r,s],o=>{const l=this.Dr(o.wr);i.push(l)}),W.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new jn(We);return n.forEach(s=>{const i=new an(s,0),o=new an(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,o],l=>{r=r.add(l.wr)})}),W.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;ue.isDocumentKey(i)||(i=i.child(""));const o=new an(new ue(i),0);let l=new jn(We);return this.br.forEachWhile(c=>{const u=c.key.path;return!!r.isPrefixOf(u)&&(u.length===s&&(l=l.add(c.wr)),!0)},o),W.resolve(this.Cr(l))}Cr(e){const n=[];return e.forEach(r=>{const s=this.Dr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){Xe(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return W.forEach(n.mutations,s=>{const i=new an(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new an(n,0),s=this.br.firstAfterOrEqual(r);return W.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,W.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XO{constructor(e){this.Mr=e,this.docs=function(){return new St(ue.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return W.resolve(r?r.document.mutableCopy():Bn.newInvalidDocument(n))}getEntries(e,n){let r=Bi();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Bn.newInvalidDocument(s))}),W.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=Bi();const o=n.path,l=new ue(o.child("")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){const{key:u,value:{document:d}}=c.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||FL(PL(d),r)<=0||(s.has(d.key)||ng(n,d))&&(i=i.insert(d.key,d.mutableCopy()))}return W.resolve(i)}getAllFromCollectionGroup(e,n,r,s){Se()}Or(e,n){return W.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new YO(this)}getSize(e){return W.resolve(this.size)}}class YO extends UO{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.cr.addEntry(e,s)):this.cr.removeEntry(r)}),W.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JO{constructor(e){this.persistence=e,this.Nr=new Wc(n=>ew(n),tw),this.lastRemoteSnapshotVersion=ke.min(),this.highestTargetId=0,this.Lr=0,this.Br=new lw,this.targetCount=0,this.kr=Ec.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,s)=>n(s)),W.resolve()}getLastRemoteSnapshotVersion(e){return W.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return W.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),W.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),W.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new Ec(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,W.resolve()}updateTargetData(e,n){return this.Kn(n),W.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,W.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.Nr.forEach((o,l)=>{l.sequenceNumber<=n&&r.get(l.targetId)===null&&(this.Nr.delete(o),i.push(this.removeMatchingKeysForTargetId(e,l.targetId)),s++)}),W.waitFor(i).next(()=>s)}getTargetCount(e){return W.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return W.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),W.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),W.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),W.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return W.resolve(r)}containsKey(e,n){return W.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZO{constructor(e,n){this.qr={},this.overlays={},this.Qr=new Y1(0),this.Kr=!1,this.Kr=!0,this.$r=new KO,this.referenceDelegate=e(this),this.Ur=new JO(this),this.indexManager=new BO,this.remoteDocumentCache=function(s){return new XO(s)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new $O(n),this.Gr=new WO(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new qO,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new QO(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){re("MemoryPersistence","Starting transaction:",e);const s=new e7(this.Qr.next());return this.referenceDelegate.zr(),r(s).next(i=>this.referenceDelegate.jr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Hr(e,n){return W.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}}class e7 extends DL{constructor(e){super(),this.currentSequenceNumber=e}}class cw{constructor(e){this.persistence=e,this.Jr=new lw,this.Yr=null}static Zr(e){return new cw(e)}get Xr(){if(this.Yr)return this.Yr;throw Se()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),W.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),W.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),W.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(s=>this.Xr.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.Xr.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return W.forEach(this.Xr,r=>{const s=ue.fromPath(r);return this.ei(e,s).next(i=>{i||n.removeEntry(s,ke.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return W.or([()=>W.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uw{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=s}static Wi(e,n){let r=Le(),s=Le();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new uw(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t7{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n7{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return aD()?8:LL(Gn())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.Yi(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.Zi(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new t7;return this.Xi(e,n,o).next(l=>{if(i.result=l,this.zi)return this.es(e,n,o,l.size)})}).next(()=>i.result)}es(e,n,r,s){return r.documentReadCount<this.ji?(Nu()<=$e.DEBUG&&re("QueryEngine","SDK will not create cache indexes for query:",Fl(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),W.resolve()):(Nu()<=$e.DEBUG&&re("QueryEngine","Query:",Fl(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.Hi*s?(Nu()<=$e.DEBUG&&re("QueryEngine","The SDK decides to create cache indexes for query:",Fl(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ei(n))):W.resolve())}Yi(e,n){if(zb(n))return W.resolve(null);let r=ei(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=Wm(n,null,"F"),r=ei(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=Le(...i);return this.Ji.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,r).next(c=>{const u=this.ts(n,l);return this.ns(n,u,o,c.readTime)?this.Yi(e,Wm(n,null,"F")):this.rs(e,u,n,c)}))})))}Zi(e,n,r,s){return zb(n)||s.isEqual(ke.min())?W.resolve(null):this.Ji.getDocuments(e,r).next(i=>{const o=this.ts(n,i);return this.ns(n,o,r,s)?W.resolve(null):(Nu()<=$e.DEBUG&&re("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Fl(n)),this.rs(e,o,n,AL(s,-1)).next(l=>l))})}ts(e,n){let r=new jn($I(e));return n.forEach((s,i)=>{ng(e,i)&&(r=r.add(i))}),r}ns(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Xi(e,n,r){return Nu()<=$e.DEBUG&&re("QueryEngine","Using full collection scan to execute query:",Fl(n)),this.Ji.getDocumentsMatchingQuery(e,n,Ba.min(),r)}rs(e,n,r,s){return this.Ji.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r7{constructor(e,n,r,s){this.persistence=e,this.ss=n,this.serializer=s,this.os=new St(We),this._s=new Wc(i=>ew(i),tw),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new GO(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function s7(t,e,n,r){return new r7(t,e,n,r)}async function lC(t,e){const n=Te(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],l=[];let c=Le();for(const u of s){o.push(u.batchId);for(const d of u.mutations)c=c.add(d.key)}for(const u of i){l.push(u.batchId);for(const d of u.mutations)c=c.add(d.key)}return n.localDocuments.getDocuments(r,c).next(u=>({hs:u,removedBatchIds:o,addedBatchIds:l}))})})}function i7(t,e){const n=Te(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.cs.newChangeBuffer({trackRemovals:!0});return function(l,c,u,d){const f=u.batch,p=f.keys();let g=W.resolve();return p.forEach(x=>{g=g.next(()=>d.getEntry(c,x)).next(w=>{const v=u.docVersions.get(x);Xe(v!==null),w.version.compareTo(v)<0&&(f.applyToRemoteDocument(w,u),w.isValidDocument()&&(w.setReadTime(u.commitVersion),d.addEntry(w)))})}),g.next(()=>l.mutationQueue.removeMutationBatch(c,f))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let c=Le();for(let u=0;u<l.mutationResults.length;++u)l.mutationResults[u].transformResults.length>0&&(c=c.add(l.batch.mutations[u].key));return c}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function cC(t){const e=Te(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function a7(t,e){const n=Te(t),r=e.snapshotVersion;let s=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.cs.newChangeBuffer({trackRemovals:!0});s=n.os;const l=[];e.targetChanges.forEach((d,f)=>{const p=s.get(f);if(!p)return;l.push(n.Ur.removeMatchingKeys(i,d.removedDocuments,f).next(()=>n.Ur.addMatchingKeys(i,d.addedDocuments,f)));let g=p.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(f)!==null?g=g.withResumeToken(In.EMPTY_BYTE_STRING,ke.min()).withLastLimboFreeSnapshotVersion(ke.min()):d.resumeToken.approximateByteSize()>0&&(g=g.withResumeToken(d.resumeToken,r)),s=s.insert(f,g),function(w,v,_){return w.resumeToken.approximateByteSize()===0||v.snapshotVersion.toMicroseconds()-w.snapshotVersion.toMicroseconds()>=3e8?!0:_.addedDocuments.size+_.modifiedDocuments.size+_.removedDocuments.size>0}(p,g,d)&&l.push(n.Ur.updateTargetData(i,g))});let c=Bi(),u=Le();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(i,d))}),l.push(o7(i,o,e.documentUpdates).next(d=>{c=d.Ps,u=d.Is})),!r.isEqual(ke.min())){const d=n.Ur.getLastRemoteSnapshotVersion(i).next(f=>n.Ur.setTargetsMetadata(i,i.currentSequenceNumber,r));l.push(d)}return W.waitFor(l).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,c,u)).next(()=>c)}).then(i=>(n.os=s,i))}function o7(t,e,n){let r=Le(),s=Le();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=Bi();return n.forEach((l,c)=>{const u=i.get(l);c.isFoundDocument()!==u.isFoundDocument()&&(s=s.add(l)),c.isNoDocument()&&c.version.isEqual(ke.min())?(e.removeEntry(l,c.readTime),o=o.insert(l,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),o=o.insert(l,c)):re("LocalStore","Ignoring outdated watch update for ",l,". Current version:",u.version," Watch version:",c.version)}),{Ps:o,Is:s}})}function l7(t,e){const n=Te(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function c7(t,e){const n=Te(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Ur.getTargetData(r,e).next(i=>i?(s=i,W.resolve(s)):n.Ur.allocateTargetId(r).next(o=>(s=new Ea(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.os.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function Xy(t,e,n){const r=Te(t),s=r.os.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!rh(o))throw o;re("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(s.target)}function Yb(t,e,n){const r=Te(t);let s=ke.min(),i=Le();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,u,d){const f=Te(c),p=f._s.get(d);return p!==void 0?W.resolve(f.os.get(p)):f.Ur.getTargetData(u,d)}(r,o,ei(e)).next(l=>{if(l)return s=l.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,l.targetId).next(c=>{i=c})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,n?s:ke.min(),n?i:Le())).next(l=>(u7(r,tO(e),l),{documents:l,Ts:i})))}function u7(t,e,n){let r=t.us.get(e)||ke.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.us.set(e,r)}class Jb{constructor(){this.activeTargetIds=oO()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class d7{constructor(){this.so=new Jb,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Jb,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h7{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zb{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){re("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){re("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ef=null;function Y0(){return Ef===null?Ef=function(){return 268435456+Math.round(2147483648*Math.random())}():Ef++,"0x"+Ef.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f7={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m7{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ln="WebChannelConnection";class p7 extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${s}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get Fo(){return!1}Mo(n,r,s,i,o){const l=Y0(),c=this.xo(n,r.toUriEncodedString());re("RestConnection",`Sending RPC '${n}' ${l}:`,c,s);const u={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(u,i,o),this.No(n,c,u,s).then(d=>(re("RestConnection",`Received RPC '${n}' ${l}: `,d),d),d=>{throw vc("RestConnection",`RPC '${n}' ${l} failed with error: `,d,"url: ",c,"request:",s),d})}Lo(n,r,s,i,o,l){return this.Mo(n,r,s,i,o)}Oo(n,r,s){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Gc}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,o)=>n[o]=i),s&&s.headers.forEach((i,o)=>n[o]=i)}xo(n,r){const s=f7[n];return`${this.Do}/v1/${r}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,s){const i=Y0();return new Promise((o,l)=>{const c=new bI;c.setWithCredentials(!0),c.listenOnce(SI.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Zf.NO_ERROR:const d=c.getResponseJson();re(Ln,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(d)),o(d);break;case Zf.TIMEOUT:re(Ln,`RPC '${e}' ${i} timed out`),l(new Z(V.DEADLINE_EXCEEDED,"Request time out"));break;case Zf.HTTP_ERROR:const f=c.getStatus();if(re(Ln,`RPC '${e}' ${i} failed with status:`,f,"response text:",c.getResponseText()),f>0){let p=c.getResponseJson();Array.isArray(p)&&(p=p[0]);const g=p==null?void 0:p.error;if(g&&g.status&&g.message){const x=function(v){const _=v.toLowerCase().replace(/_/g,"-");return Object.values(V).indexOf(_)>=0?_:V.UNKNOWN}(g.status);l(new Z(x,g.message))}else l(new Z(V.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new Z(V.UNAVAILABLE,"Connection failed."));break;default:Se()}}finally{re(Ln,`RPC '${e}' ${i} completed.`)}});const u=JSON.stringify(s);re(Ln,`RPC '${e}' ${i} sending request:`,s),c.send(n,"POST",u,r,15)})}Bo(e,n,r){const s=Y0(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=kI(),l=jI(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Oo(c.initMessageHeaders,n,r),c.encodeInitMessageHeaders=!0;const d=i.join("");re(Ln,`Creating RPC '${e}' stream ${s}: ${d}`,c);const f=o.createWebChannel(d,c);let p=!1,g=!1;const x=new m7({Io:v=>{g?re(Ln,`Not sending because RPC '${e}' stream ${s} is closed:`,v):(p||(re(Ln,`Opening RPC '${e}' stream ${s} transport.`),f.open(),p=!0),re(Ln,`RPC '${e}' stream ${s} sending:`,v),f.send(v))},To:()=>f.close()}),w=(v,_,b)=>{v.listen(_,j=>{try{b(j)}catch(T){setTimeout(()=>{throw T},0)}})};return w(f,Lu.EventType.OPEN,()=>{g||(re(Ln,`RPC '${e}' stream ${s} transport opened.`),x.yo())}),w(f,Lu.EventType.CLOSE,()=>{g||(g=!0,re(Ln,`RPC '${e}' stream ${s} transport closed`),x.So())}),w(f,Lu.EventType.ERROR,v=>{g||(g=!0,vc(Ln,`RPC '${e}' stream ${s} transport errored:`,v),x.So(new Z(V.UNAVAILABLE,"The operation could not be completed")))}),w(f,Lu.EventType.MESSAGE,v=>{var _;if(!g){const b=v.data[0];Xe(!!b);const j=b,T=j.error||((_=j[0])===null||_===void 0?void 0:_.error);if(T){re(Ln,`RPC '${e}' stream ${s} received error:`,T);const R=T.status;let M=function(I){const C=Ot[I];if(C!==void 0)return JI(C)}(R),k=T.message;M===void 0&&(M=V.INTERNAL,k="Unknown error status: "+R+" with message "+T.message),g=!0,x.So(new Z(M,k)),f.close()}else re(Ln,`RPC '${e}' stream ${s} received:`,b),x.bo(b)}}),w(l,EI.STAT_EVENT,v=>{v.stat===zy.PROXY?re(Ln,`RPC '${e}' stream ${s} detected buffering proxy`):v.stat===zy.NOPROXY&&re(Ln,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{x.wo()},0),x}}function J0(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function og(t){return new jO(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uC{constructor(e,n,r=1e3,s=1.5,i=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=s,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),s=Math.max(0,n-r);s>0&&re("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dC{constructor(e,n,r,s,i,o,l,c){this.ui=e,this.Ho=r,this.Jo=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new uC(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===V.RESOURCE_EXHAUSTED?(zi(n.toString()),zi("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===V.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Yo===n&&this.P_(r,s)},r=>{e(()=>{const s=new Z(V.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(s)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{r(()=>this.I_(s))}),this.stream.onMessage(s=>{r(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return re("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(re("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class g7 extends dC{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=IO(this.serializer,e),r=function(i){if(!("targetChange"in i))return ke.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?ke.min():o.readTime?ti(o.readTime):ke.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=Qy(this.serializer),n.addTarget=function(i,o){let l;const c=o.target;if(l=Hy(c)?{documents:NO(i,c)}:{query:AO(i,c)._t},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=tC(i,o.resumeToken);const u=Wy(i,o.expectedCount);u!==null&&(l.expectedCount=u)}else if(o.snapshotVersion.compareTo(ke.min())>0){l.readTime=qm(i,o.snapshotVersion.toTimestamp());const u=Wy(i,o.expectedCount);u!==null&&(l.expectedCount=u)}return l}(this.serializer,e);const r=FO(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=Qy(this.serializer),n.removeTarget=e,this.a_(n)}}class x7 extends dC{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return Xe(!!e.streamToken),this.lastStreamToken=e.streamToken,Xe(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Xe(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=RO(e.writeResults,e.commitTime),r=ti(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=Qy(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>CO(this.serializer,r))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y7 extends class{}{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new Z(V.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Mo(e,qy(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===V.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Z(V.UNKNOWN,i.toString())})}Lo(e,n,r,s,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Lo(e,qy(n,r),s,o,l,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===V.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Z(V.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class v7{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(zi(n),this.D_=!1):re("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w7{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(o=>{r.enqueueAndForget(async()=>{ul(this)&&(re("RemoteStore","Restarting streams for network reachability change."),await async function(c){const u=Te(c);u.L_.add(4),await ah(u),u.q_.set("Unknown"),u.L_.delete(4),await lg(u)}(this))})}),this.q_=new v7(r,s)}}async function lg(t){if(ul(t))for(const e of t.B_)await e(!0)}async function ah(t){for(const e of t.B_)await e(!1)}function hC(t,e){const n=Te(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),mw(n)?fw(n):qc(n).r_()&&hw(n,e))}function dw(t,e){const n=Te(t),r=qc(n);n.N_.delete(e),r.r_()&&fC(n,e),n.N_.size===0&&(r.r_()?r.o_():ul(n)&&n.q_.set("Unknown"))}function hw(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ke.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}qc(t).A_(e)}function fC(t,e){t.Q_.xe(e),qc(t).R_(e)}function fw(t){t.Q_=new _O({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),qc(t).start(),t.q_.v_()}function mw(t){return ul(t)&&!qc(t).n_()&&t.N_.size>0}function ul(t){return Te(t).L_.size===0}function mC(t){t.Q_=void 0}async function _7(t){t.q_.set("Online")}async function b7(t){t.N_.forEach((e,n)=>{hw(t,e)})}async function S7(t,e){mC(t),mw(t)?(t.q_.M_(e),fw(t)):t.q_.set("Unknown")}async function E7(t,e,n){if(t.q_.set("Online"),e instanceof eC&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const l of i.targetIds)s.N_.has(l)&&(await s.remoteSyncer.rejectListen(l,o),s.N_.delete(l),s.Q_.removeTarget(l))}(t,e)}catch(r){re("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Km(t,r)}else if(e instanceof nm?t.Q_.Ke(e):e instanceof ZI?t.Q_.He(e):t.Q_.We(e),!n.isEqual(ke.min()))try{const r=await cC(t.localStore);n.compareTo(r)>=0&&await function(i,o){const l=i.Q_.rt(o);return l.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){const d=i.N_.get(u);d&&i.N_.set(u,d.withResumeToken(c.resumeToken,o))}}),l.targetMismatches.forEach((c,u)=>{const d=i.N_.get(c);if(!d)return;i.N_.set(c,d.withResumeToken(In.EMPTY_BYTE_STRING,d.snapshotVersion)),fC(i,c);const f=new Ea(d.target,c,u,d.sequenceNumber);hw(i,f)}),i.remoteSyncer.applyRemoteEvent(l)}(t,n)}catch(r){re("RemoteStore","Failed to raise snapshot:",r),await Km(t,r)}}async function Km(t,e,n){if(!rh(e))throw e;t.L_.add(1),await ah(t),t.q_.set("Offline"),n||(n=()=>cC(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{re("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await lg(t)})}function pC(t,e){return e().catch(n=>Km(t,n,e))}async function cg(t){const e=Te(t),n=Ua(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;j7(e);)try{const s=await l7(e.localStore,r);if(s===null){e.O_.length===0&&n.o_();break}r=s.batchId,k7(e,s)}catch(s){await Km(e,s)}gC(e)&&xC(e)}function j7(t){return ul(t)&&t.O_.length<10}function k7(t,e){t.O_.push(e);const n=Ua(t);n.r_()&&n.V_&&n.m_(e.mutations)}function gC(t){return ul(t)&&!Ua(t).n_()&&t.O_.length>0}function xC(t){Ua(t).start()}async function T7(t){Ua(t).p_()}async function I7(t){const e=Ua(t);for(const n of t.O_)e.m_(n.mutations)}async function C7(t,e,n){const r=t.O_.shift(),s=iw.from(r,e,n);await pC(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await cg(t)}async function R7(t,e){e&&Ua(t).V_&&await async function(r,s){if(function(o){return yO(o)&&o!==V.ABORTED}(s.code)){const i=r.O_.shift();Ua(r).s_(),await pC(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await cg(r)}}(t,e),gC(t)&&xC(t)}async function eS(t,e){const n=Te(t);n.asyncQueue.verifyOperationInProgress(),re("RemoteStore","RemoteStore received new credentials");const r=ul(n);n.L_.add(3),await ah(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await lg(n)}async function N7(t,e){const n=Te(t);e?(n.L_.delete(2),await lg(n)):e||(n.L_.add(2),await ah(n),n.q_.set("Unknown"))}function qc(t){return t.K_||(t.K_=function(n,r,s){const i=Te(n);return i.w_(),new g7(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:_7.bind(null,t),Ro:b7.bind(null,t),mo:S7.bind(null,t),d_:E7.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),mw(t)?fw(t):t.q_.set("Unknown")):(await t.K_.stop(),mC(t))})),t.K_}function Ua(t){return t.U_||(t.U_=function(n,r,s){const i=Te(n);return i.w_(),new x7(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:T7.bind(null,t),mo:R7.bind(null,t),f_:I7.bind(null,t),g_:C7.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await cg(t)):(await t.U_.stop(),t.O_.length>0&&(re("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pw{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new Ni,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,l=new pw(e,n,o,s,i);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Z(V.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function gw(t,e){if(zi("AsyncQueue",`${e}: ${t}`),rh(t))return new Z(V.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ic{constructor(e){this.comparator=e?(n,r)=>e(n,r)||ue.comparator(n.key,r.key):(n,r)=>ue.comparator(n.key,r.key),this.keyedMap=Ou(),this.sortedSet=new St(this.comparator)}static emptySet(e){return new ic(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof ic)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new ic;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tS{constructor(){this.W_=new St(ue.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):Se():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}}class jc{constructor(e,n,r,s,i,o,l,c,u){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(l=>{o.push({type:0,doc:l})}),new jc(e,n,ic.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&tg(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A7{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class P7{constructor(){this.queries=nS(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const s=Te(n),i=s.queries;s.queries=nS(),i.forEach((o,l)=>{for(const c of l.j_)c.onError(r)})})(this,new Z(V.ABORTED,"Firestore shutting down"))}}function nS(){return new Wc(t=>OI(t),tg)}async function yC(t,e){const n=Te(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.H_()&&e.J_()&&(r=2):(i=new A7,r=e.J_()?0:1);try{switch(r){case 0:i.z_=await n.onListen(s,!0);break;case 1:i.z_=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const l=gw(o,`Initialization of query '${Fl(e.query)}' failed`);return void e.onError(l)}n.queries.set(s,i),i.j_.push(e),e.Z_(n.onlineState),i.z_&&e.X_(i.z_)&&xw(n)}async function vC(t,e){const n=Te(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const o=i.j_.indexOf(e);o>=0&&(i.j_.splice(o,1),i.j_.length===0?s=e.J_()?0:1:!i.H_()&&e.J_()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function F7(t,e){const n=Te(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const l of o.j_)l.X_(s)&&(r=!0);o.z_=s}}r&&xw(n)}function M7(t,e,n){const r=Te(t),s=r.queries.get(e);if(s)for(const i of s.j_)i.onError(n);r.queries.delete(e)}function xw(t){t.Y_.forEach(e=>{e.next()})}var Yy,rS;(rS=Yy||(Yy={})).ea="default",rS.Cache="cache";class wC{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new jc(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=jc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Yy.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _C{constructor(e){this.key=e}}class bC{constructor(e){this.key=e}}class D7{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Le(),this.mutatedKeys=Le(),this.Aa=$I(e),this.Ra=new ic(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new tS,s=n?n.Ra:this.Ra;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,l=!1;const c=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,u=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((d,f)=>{const p=s.get(d),g=ng(this.query,f)?f:null,x=!!p&&this.mutatedKeys.has(p.key),w=!!g&&(g.hasLocalMutations||this.mutatedKeys.has(g.key)&&g.hasCommittedMutations);let v=!1;p&&g?p.data.isEqual(g.data)?x!==w&&(r.track({type:3,doc:g}),v=!0):this.ga(p,g)||(r.track({type:2,doc:g}),v=!0,(c&&this.Aa(g,c)>0||u&&this.Aa(g,u)<0)&&(l=!0)):!p&&g?(r.track({type:0,doc:g}),v=!0):p&&!g&&(r.track({type:1,doc:p}),v=!0,(c||u)&&(l=!0)),v&&(g?(o=o.add(g),i=w?i.add(d):i.delete(d)):(o=o.delete(d),i=i.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),i=i.delete(d.key),r.track({type:1,doc:d})}return{Ra:o,fa:r,ns:l,mutatedKeys:i}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((d,f)=>function(g,x){const w=v=>{switch(v){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Se()}};return w(g)-w(x)}(d.type,f.type)||this.Aa(d.doc,f.doc)),this.pa(r),s=s!=null&&s;const l=n&&!s?this.ya():[],c=this.da.size===0&&this.current&&!s?1:0,u=c!==this.Ea;return this.Ea=c,o.length!==0||u?{snapshot:new jc(this.query,e.Ra,i,o,e.mutatedKeys,c===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:l}:{wa:l}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new tS,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Le(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new bC(r))}),this.da.forEach(r=>{e.has(r)||n.push(new _C(r))}),n}ba(e){this.Ta=e.Ts,this.da=Le();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return jc.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class L7{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class O7{constructor(e){this.key=e,this.va=!1}}class $7{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new Wc(l=>OI(l),tg),this.Ma=new Map,this.xa=new Set,this.Oa=new St(ue.comparator),this.Na=new Map,this.La=new lw,this.Ba={},this.ka=new Map,this.qa=Ec.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function z7(t,e,n=!0){const r=IC(t);let s;const i=r.Fa.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.Da()):s=await SC(r,e,n,!0),s}async function B7(t,e){const n=IC(t);await SC(n,e,!0,!1)}async function SC(t,e,n,r){const s=await c7(t.localStore,ei(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let l;return r&&(l=await V7(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&hC(t.remoteStore,s),l}async function V7(t,e,n,r,s){t.Ka=(f,p,g)=>async function(w,v,_,b){let j=v.view.ma(_);j.ns&&(j=await Yb(w.localStore,v.query,!1).then(({documents:k})=>v.view.ma(k,j)));const T=b&&b.targetChanges.get(v.targetId),R=b&&b.targetMismatches.get(v.targetId)!=null,M=v.view.applyChanges(j,w.isPrimaryClient,T,R);return iS(w,v.targetId,M.wa),M.snapshot}(t,f,p,g);const i=await Yb(t.localStore,e,!0),o=new D7(e,i.Ts),l=o.ma(i.documents),c=ih.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),u=o.applyChanges(l,t.isPrimaryClient,c);iS(t,n,u.wa);const d=new L7(e,n,o);return t.Fa.set(e,d),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),u.snapshot}async function U7(t,e,n){const r=Te(t),s=r.Fa.get(e),i=r.Ma.get(s.targetId);if(i.length>1)return r.Ma.set(s.targetId,i.filter(o=>!tg(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await Xy(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&dw(r.remoteStore,s.targetId),Jy(r,s.targetId)}).catch(nh)):(Jy(r,s.targetId),await Xy(r.localStore,s.targetId,!0))}async function H7(t,e){const n=Te(t),r=n.Fa.get(e),s=n.Ma.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),dw(n.remoteStore,r.targetId))}async function G7(t,e,n){const r=J7(t);try{const s=await function(o,l){const c=Te(o),u=Bt.now(),d=l.reduce((g,x)=>g.add(x.key),Le());let f,p;return c.persistence.runTransaction("Locally write mutations","readwrite",g=>{let x=Bi(),w=Le();return c.cs.getEntries(g,d).next(v=>{x=v,x.forEach((_,b)=>{b.isValidDocument()||(w=w.add(_))})}).next(()=>c.localDocuments.getOverlayedDocuments(g,x)).next(v=>{f=v;const _=[];for(const b of l){const j=fO(b,f.get(b.key).overlayedDocument);j!=null&&_.push(new Ya(b.key,j,NI(j.value.mapValue),Jn.exists(!0)))}return c.mutationQueue.addMutationBatch(g,u,_,l)}).next(v=>{p=v;const _=v.applyToLocalDocumentSet(f,w);return c.documentOverlayCache.saveOverlays(g,v.batchId,_)})}).then(()=>({batchId:p.batchId,changes:BI(f)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,l,c){let u=o.Ba[o.currentUser.toKey()];u||(u=new St(We)),u=u.insert(l,c),o.Ba[o.currentUser.toKey()]=u}(r,s.batchId,n),await oh(r,s.changes),await cg(r.remoteStore)}catch(s){const i=gw(s,"Failed to persist write");n.reject(i)}}async function EC(t,e){const n=Te(t);try{const r=await a7(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.Na.get(i);o&&(Xe(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.va=!0:s.modifiedDocuments.size>0?Xe(o.va):s.removedDocuments.size>0&&(Xe(o.va),o.va=!1))}),await oh(n,r,e)}catch(r){await nh(r)}}function sS(t,e,n){const r=Te(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Fa.forEach((i,o)=>{const l=o.view.Z_(e);l.snapshot&&s.push(l.snapshot)}),function(o,l){const c=Te(o);c.onlineState=l;let u=!1;c.queries.forEach((d,f)=>{for(const p of f.j_)p.Z_(l)&&(u=!0)}),u&&xw(c)}(r.eventManager,e),s.length&&r.Ca.d_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function W7(t,e,n){const r=Te(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Na.get(e),i=s&&s.key;if(i){let o=new St(ue.comparator);o=o.insert(i,Bn.newNoDocument(i,ke.min()));const l=Le().add(i),c=new ag(ke.min(),new Map,new St(We),o,l);await EC(r,c),r.Oa=r.Oa.remove(i),r.Na.delete(e),yw(r)}else await Xy(r.localStore,e,!1).then(()=>Jy(r,e,n)).catch(nh)}async function q7(t,e){const n=Te(t),r=e.batch.batchId;try{const s=await i7(n.localStore,e);kC(n,r,null),jC(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await oh(n,s)}catch(s){await nh(s)}}async function K7(t,e,n){const r=Te(t);try{const s=await function(o,l){const c=Te(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let d;return c.mutationQueue.lookupMutationBatch(u,l).next(f=>(Xe(f!==null),d=f.keys(),c.mutationQueue.removeMutationBatch(u,f))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,d,l)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,d)).next(()=>c.localDocuments.getDocuments(u,d))})}(r.localStore,e);kC(r,e,n),jC(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await oh(r,s)}catch(s){await nh(s)}}function jC(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function kC(t,e,n){const r=Te(t);let s=r.Ba[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Ba[r.currentUser.toKey()]=s}}function Jy(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||TC(t,r)})}function TC(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(dw(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),yw(t))}function iS(t,e,n){for(const r of n)r instanceof _C?(t.La.addReference(r.key,e),Q7(t,r)):r instanceof bC?(re("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||TC(t,r.key)):Se()}function Q7(t,e){const n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||(re("SyncEngine","New document in limbo: "+n),t.xa.add(r),yw(t))}function yw(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new ue(it.fromString(e)),r=t.qa.next();t.Na.set(r,new O7(n)),t.Oa=t.Oa.insert(n,r),hC(t.remoteStore,new Ea(ei(nw(n.path)),r,"TargetPurposeLimboResolution",Y1.oe))}}async function oh(t,e,n){const r=Te(t),s=[],i=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((l,c)=>{o.push(r.Ka(c,e,n).then(u=>{var d;if((u||n)&&r.isPrimaryClient){const f=u?!u.fromCache:(d=n==null?void 0:n.targetChanges.get(c.targetId))===null||d===void 0?void 0:d.current;r.sharedClientState.updateQueryState(c.targetId,f?"current":"not-current")}if(u){s.push(u);const f=uw.Wi(c.targetId,u);i.push(f)}}))}),await Promise.all(o),r.Ca.d_(s),await async function(c,u){const d=Te(c);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>W.forEach(u,p=>W.forEach(p.$i,g=>d.persistence.referenceDelegate.addReference(f,p.targetId,g)).next(()=>W.forEach(p.Ui,g=>d.persistence.referenceDelegate.removeReference(f,p.targetId,g)))))}catch(f){if(!rh(f))throw f;re("LocalStore","Failed to update sequence numbers: "+f)}for(const f of u){const p=f.targetId;if(!f.fromCache){const g=d.os.get(p),x=g.snapshotVersion,w=g.withLastLimboFreeSnapshotVersion(x);d.os=d.os.insert(p,w)}}}(r.localStore,i))}async function X7(t,e){const n=Te(t);if(!n.currentUser.isEqual(e)){re("SyncEngine","User change. New user:",e.toKey());const r=await lC(n.localStore,e);n.currentUser=e,function(i,o){i.ka.forEach(l=>{l.forEach(c=>{c.reject(new Z(V.CANCELLED,o))})}),i.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await oh(n,r.hs)}}function Y7(t,e){const n=Te(t),r=n.Na.get(e);if(r&&r.va)return Le().add(r.key);{let s=Le();const i=n.Ma.get(e);if(!i)return s;for(const o of i){const l=n.Fa.get(o);s=s.unionWith(l.view.Va)}return s}}function IC(t){const e=Te(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=EC.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Y7.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=W7.bind(null,e),e.Ca.d_=F7.bind(null,e.eventManager),e.Ca.$a=M7.bind(null,e.eventManager),e}function J7(t){const e=Te(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=q7.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=K7.bind(null,e),e}class Qm{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=og(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return s7(this.persistence,new n7,e.initialUser,this.serializer)}Ga(e){return new ZO(cw.Zr,this.serializer)}Wa(e){return new d7}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Qm.provider={build:()=>new Qm};class Zy{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>sS(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=X7.bind(null,this.syncEngine),await N7(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new P7}()}createDatastore(e){const n=og(e.databaseInfo.databaseId),r=function(i){return new p7(i)}(e.databaseInfo);return function(i,o,l,c){return new y7(i,o,l,c)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,l){return new w7(r,s,i,o,l)}(this.localStore,this.datastore,e.asyncQueue,n=>sS(this.syncEngine,n,0),function(){return Zb.D()?new Zb:new h7}())}createSyncEngine(e,n){return function(s,i,o,l,c,u,d){const f=new $7(s,i,o,l,c,u);return d&&(f.Qa=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=Te(s);re("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await ah(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}Zy.provider={build:()=>new Zy};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CC{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):zi("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z7{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=$n.UNAUTHENTICATED,this.clientId=II.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{re("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(re("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ni;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=gw(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Z0(t,e){t.asyncQueue.verifyOperationInProgress(),re("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await lC(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function aS(t,e){t.asyncQueue.verifyOperationInProgress();const n=await e9(t);re("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>eS(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>eS(e.remoteStore,s)),t._onlineComponents=e}async function e9(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){re("FirestoreClient","Using user provided OfflineComponentProvider");try{await Z0(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===V.FAILED_PRECONDITION||s.code===V.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;vc("Error using user provided cache. Falling back to memory cache: "+n),await Z0(t,new Qm)}}else re("FirestoreClient","Using default OfflineComponentProvider"),await Z0(t,new Qm);return t._offlineComponents}async function RC(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(re("FirestoreClient","Using user provided OnlineComponentProvider"),await aS(t,t._uninitializedComponentsProvider._online)):(re("FirestoreClient","Using default OnlineComponentProvider"),await aS(t,new Zy))),t._onlineComponents}function t9(t){return RC(t).then(e=>e.syncEngine)}async function NC(t){const e=await RC(t),n=e.eventManager;return n.onListen=z7.bind(null,e.syncEngine),n.onUnlisten=U7.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=B7.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=H7.bind(null,e.syncEngine),n}function n9(t,e,n={}){const r=new Ni;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,c,u){const d=new CC({next:p=>{d.Za(),o.enqueueAndForget(()=>vC(i,f));const g=p.docs.has(l);!g&&p.fromCache?u.reject(new Z(V.UNAVAILABLE,"Failed to get document because the client is offline.")):g&&p.fromCache&&c&&c.source==="server"?u.reject(new Z(V.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(p)},error:p=>u.reject(p)}),f=new wC(nw(l.path),d,{includeMetadataChanges:!0,_a:!0});return yC(i,f)}(await NC(t),t.asyncQueue,e,n,r)),r.promise}function r9(t,e,n={}){const r=new Ni;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,c,u){const d=new CC({next:p=>{d.Za(),o.enqueueAndForget(()=>vC(i,f)),p.fromCache&&c.source==="server"?u.reject(new Z(V.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(p)},error:p=>u.reject(p)}),f=new wC(l,d,{includeMetadataChanges:!0,_a:!0});return yC(i,f)}(await NC(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AC(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oS=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PC(t,e,n){if(!n)throw new Z(V.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function s9(t,e,n,r){if(e===!0&&r===!0)throw new Z(V.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function lS(t){if(!ue.isDocumentKey(t))throw new Z(V.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function cS(t){if(ue.isDocumentKey(t))throw new Z(V.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function ug(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Se()}function rs(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Z(V.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=ug(t);throw new Z(V.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function i9(t,e){if(e<=0)throw new Z(V.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uS{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new Z(V.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new Z(V.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}s9("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=AC((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new Z(V.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new Z(V.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new Z(V.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class dg{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new uS({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Z(V.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Z(V.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new uS(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new SL;switch(r.type){case"firstParty":return new TL(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new Z(V.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=oS.get(n);r&&(re("ComponentProvider","Removing Datastore"),oS.delete(n),r.terminate())}(this),Promise.resolve()}}function a9(t,e,n,r={}){var s;const i=(t=rs(t,dg))._getSettings(),o=`${e}:${n}`;if(i.host!=="firestore.googleapis.com"&&i.host!==o&&vc("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},i),{host:o,ssl:!1})),r.mockUserToken){let l,c;if(typeof r.mockUserToken=="string")l=r.mockUserToken,c=$n.MOCK_USER;else{l=Z8(r.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new Z(V.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new $n(u)}t._authCredentials=new EL(new TI(l,c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xi{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Xi(this.firestore,e,this._query)}}class Zn{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new La(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Zn(this.firestore,e,this._key)}}class La extends Xi{constructor(e,n,r){super(e,n,nw(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Zn(this.firestore,null,new ue(e))}withConverter(e){return new La(this.firestore,e,this._path)}}function Mt(t,e,...n){if(t=Ht(t),PC("collection","path",e),t instanceof dg){const r=it.fromString(e,...n);return cS(r),new La(t,null,r)}{if(!(t instanceof Zn||t instanceof La))throw new Z(V.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(it.fromString(e,...n));return cS(r),new La(t.firestore,null,r)}}function gt(t,e,...n){if(t=Ht(t),arguments.length===1&&(e=II.newId()),PC("doc","path",e),t instanceof dg){const r=it.fromString(e,...n);return lS(r),new Zn(t,null,new ue(r))}{if(!(t instanceof Zn||t instanceof La))throw new Z(V.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(it.fromString(e,...n));return lS(r),new Zn(t.firestore,t instanceof La?t.converter:null,new ue(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dS{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new uC(this,"async_queue_retry"),this.Vu=()=>{const r=J0();r&&re("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=J0();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=J0();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new Ni;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!rh(e))throw e;re("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const s=function(o){let l=o.message||"";return o.stack&&(l=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),l}(r);throw zi("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const s=pw.createAndSchedule(this,e,n,r,i=>this.yu(i));return this.Tu.push(s),s}fu(){this.Eu&&Se()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}class Ja extends dg{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new dS,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new dS(e),this._firestoreClient=void 0,await e}}}function o9(t,e){const n=typeof t=="object"?t:yI(),r=typeof t=="string"?t:e||"(default)",s=Q1(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=Y8("firestore");i&&a9(s,...i)}return s}function hg(t){if(t._terminated)throw new Z(V.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||l9(t),t._firestoreClient}function l9(t){var e,n,r;const s=t._freezeSettings(),i=function(l,c,u,d){return new zL(l,c,u,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,AC(d.experimentalLongPollingOptions),d.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((n=s.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new Z7(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(l){const c=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(c),_online:c}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kc{constructor(e){this._byteString=e}static fromBase64String(e){try{return new kc(In.fromBase64String(e))}catch(n){throw new Z(V.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new kc(In.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kc{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new Z(V.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new bn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}function ci(){return new Kc("__name__")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lh{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vw{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new Z(V.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new Z(V.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return We(this._lat,e._lat)||We(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ww{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c9=/^__.*__$/;class u9{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Ya(e,this.data,this.fieldMask,n,this.fieldTransforms):new sh(e,this.data,n,this.fieldTransforms)}}class FC{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Ya(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function MC(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Se()}}class _w{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new _w(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.Ou(e),s}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Xm(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(MC(this.Cu)&&c9.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class d9{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||og(e)}Qu(e,n,r,s=!1){return new _w({Cu:e,methodName:n,qu:r,path:bn.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Qc(t){const e=t._freezeSettings(),n=og(t._databaseId);return new d9(t._databaseId,!!e.ignoreUndefinedProperties,n)}function bw(t,e,n,r,s,i={}){const o=t.Qu(i.merge||i.mergeFields?2:0,e,n,s);jw("Data must be an object, but it was:",o,r);const l=$C(r,o);let c,u;if(i.merge)c=new Pr(o.fieldMask),u=o.fieldTransforms;else if(i.mergeFields){const d=[];for(const f of i.mergeFields){const p=ev(e,f,n);if(!o.contains(p))throw new Z(V.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);BC(d,p)||d.push(p)}c=new Pr(d),u=o.fieldTransforms.filter(f=>c.covers(f.field))}else c=null,u=o.fieldTransforms;return new u9(new pr(l),c,u)}class fg extends lh{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof fg}}class Sw extends lh{_toFieldTransform(e){return new QI(e.path,new Cd)}isEqual(e){return e instanceof Sw}}class Ew extends lh{constructor(e,n){super(e),this.$u=n}_toFieldTransform(e){const n=new Ad(e.serializer,HI(e.serializer,this.$u));return new QI(e.path,n)}isEqual(e){return e instanceof Ew&&this.$u===e.$u}}function DC(t,e,n,r){const s=t.Qu(1,e,n);jw("Data must be an object, but it was:",s,r);const i=[],o=pr.empty();ll(r,(c,u)=>{const d=kw(e,c,n);u=Ht(u);const f=s.Nu(d);if(u instanceof fg)i.push(d);else{const p=ch(u,f);p!=null&&(i.push(d),o.set(d,p))}});const l=new Pr(i);return new FC(o,l,s.fieldTransforms)}function LC(t,e,n,r,s,i){const o=t.Qu(1,e,n),l=[ev(e,r,n)],c=[s];if(i.length%2!=0)throw new Z(V.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<i.length;p+=2)l.push(ev(e,i[p])),c.push(i[p+1]);const u=[],d=pr.empty();for(let p=l.length-1;p>=0;--p)if(!BC(u,l[p])){const g=l[p];let x=c[p];x=Ht(x);const w=o.Nu(g);if(x instanceof fg)u.push(g);else{const v=ch(x,w);v!=null&&(u.push(g),d.set(g,v))}}const f=new Pr(u);return new FC(d,f,o.fieldTransforms)}function OC(t,e,n,r=!1){return ch(n,t.Qu(r?4:3,e))}function ch(t,e){if(zC(t=Ht(t)))return jw("Unsupported field value:",e,t),$C(t,e);if(t instanceof lh)return function(r,s){if(!MC(s.Cu))throw s.Bu(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const l of r){let c=ch(l,s.Lu(o));c==null&&(c={nullValue:"NULL_VALUE"}),i.push(c),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=Ht(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return HI(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=Bt.fromDate(r);return{timestampValue:qm(s.serializer,i)}}if(r instanceof Bt){const i=new Bt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:qm(s.serializer,i)}}if(r instanceof vw)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof kc)return{bytesValue:tC(s.serializer,r._byteString)};if(r instanceof Zn){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:ow(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof ww)return function(o,l){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw l.Bu("VectorValues must only contain numeric values.");return sw(l.serializer,c)})}}}}}}(r,s);throw s.Bu(`Unsupported field value: ${ug(r)}`)}(t,e)}function $C(t,e){const n={};return CI(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ll(t,(r,s)=>{const i=ch(s,e.Mu(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function zC(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Bt||t instanceof vw||t instanceof kc||t instanceof Zn||t instanceof lh||t instanceof ww)}function jw(t,e,n){if(!zC(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){const r=ug(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function ev(t,e,n){if((e=Ht(e))instanceof Kc)return e._internalPath;if(typeof e=="string")return kw(t,e);throw Xm("Field path arguments must be of type string or ",t,!1,void 0,n)}const h9=new RegExp("[~\\*/\\[\\]]");function kw(t,e,n){if(e.search(h9)>=0)throw Xm(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Kc(...e.split("."))._internalPath}catch{throw Xm(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Xm(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let l=`Function ${e}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let c="";return(i||o)&&(c+=" (found",i&&(c+=` in field ${r}`),o&&(c+=` in document ${s}`),c+=")"),new Z(V.INVALID_ARGUMENT,l+t+c)}function BC(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tw{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Zn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new f9(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(mg("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class f9 extends Tw{data(){return super.data()}}function mg(t,e){return typeof e=="string"?kw(t,e):e instanceof Kc?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m9(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Z(V.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Iw{}class pg extends Iw{}function Ee(t,e,...n){let r=[];e instanceof Iw&&r.push(e),r=r.concat(n),function(i){const o=i.filter(c=>c instanceof Cw).length,l=i.filter(c=>c instanceof gg).length;if(o>1||o>0&&l>0)throw new Z(V.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class gg extends pg{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new gg(e,n,r)}_apply(e){const n=this._parse(e);return VC(e._query,n),new Xi(e.firestore,e.converter,Gy(e._query,n))}_parse(e){const n=Qc(e.firestore);return function(i,o,l,c,u,d,f){let p;if(u.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new Z(V.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){fS(f,d);const g=[];for(const x of f)g.push(hS(c,i,x));p={arrayValue:{values:g}}}else p=hS(c,i,f)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||fS(f,d),p=OC(l,o,f,d==="in"||d==="not-in");return zt.create(u,d,p)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function ae(t,e,n){const r=e,s=mg("where",t);return gg._create(s,r,n)}class Cw extends Iw{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Cw(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Ps.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let o=s;const l=i.getFlattenedFilters();for(const c of l)VC(o,c),o=Gy(o,c)}(e._query,n),new Xi(e.firestore,e.converter,Gy(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Rw extends pg{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new Rw(e,n)}_apply(e){const n=function(s,i,o){if(s.startAt!==null)throw new Z(V.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new Z(V.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Id(i,o)}(e._query,this._field,this._direction);return new Xi(e.firestore,e.converter,function(s,i){const o=s.explicitOrderBy.concat([i]);return new cl(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,n))}}function dn(t,e="asc"){const n=e,r=mg("orderBy",t);return Rw._create(r,n)}class Nw extends pg{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new Nw(e,n,r)}_apply(e){return new Xi(e.firestore,e.converter,Wm(e._query,this._limit,this._limitType))}}function kn(t){return i9("limit",t),Nw._create("limit",t,"F")}class Aw extends pg{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new Aw(e,n,r)}_apply(e){const n=p9(e,this.type,this._docOrFields,this._inclusive);return new Xi(e.firestore,e.converter,function(s,i){return new cl(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,i,s.endAt)}(e._query,n))}}function xg(...t){return Aw._create("startAfter",t,!1)}function p9(t,e,n,r){if(n[0]=Ht(n[0]),n[0]instanceof Tw)return function(i,o,l,c,u){if(!c)throw new Z(V.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${l}().`);const d=[];for(const f of sc(i))if(f.field.isKeyField())d.push(Gm(o,c.key));else{const p=c.data.field(f.field);if(eg(p))throw new Z(V.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+f.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(p===null){const g=f.field.canonicalString();throw new Z(V.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${g}' (used as the orderBy) does not exist.`)}d.push(p)}return new Sc(d,u)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{const s=Qc(t.firestore);return function(o,l,c,u,d,f){const p=o.explicitOrderBy;if(d.length>p.length)throw new Z(V.INVALID_ARGUMENT,`Too many arguments provided to ${u}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const g=[];for(let x=0;x<d.length;x++){const w=d[x];if(p[x].field.isKeyField()){if(typeof w!="string")throw new Z(V.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${u}(), but got a ${typeof w}`);if(!rw(o)&&w.indexOf("/")!==-1)throw new Z(V.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${u}() must be a plain document ID, but '${w}' contains a slash.`);const v=o.path.child(it.fromString(w));if(!ue.isDocumentKey(v))throw new Z(V.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${u}() must result in a valid document path, but '${v}' is not because it contains an odd number of segments.`);const _=new ue(v);g.push(Gm(l,_))}else{const v=OC(c,u,w);g.push(v)}}return new Sc(g,f)}(t._query,t.firestore._databaseId,s,e,n,r)}}function hS(t,e,n){if(typeof(n=Ht(n))=="string"){if(n==="")throw new Z(V.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!rw(e)&&n.indexOf("/")!==-1)throw new Z(V.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(it.fromString(n));if(!ue.isDocumentKey(r))throw new Z(V.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Gm(t,new ue(r))}if(n instanceof Zn)return Gm(t,n._key);throw new Z(V.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${ug(n)}.`)}function fS(t,e){if(!Array.isArray(t)||t.length===0)throw new Z(V.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function VC(t,e){const n=function(s,i){for(const o of s)for(const l of o.getFlattenedFilters())if(i.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new Z(V.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Z(V.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class g9{convertValue(e,n="none"){switch(Ko(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Nt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(qo(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw Se()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return ll(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var n,r,s;const i=(s=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(o=>Nt(o.doubleValue));return new ww(i)}convertGeoPoint(e){return new vw(Nt(e.latitude),Nt(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=J1(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(jd(e));default:return null}}convertTimestamp(e){const n=Va(e);return new Bt(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=it.fromString(e);Xe(oC(r));const s=new kd(r.get(1),r.get(3)),i=new ue(r.popFirst(5));return s.isEqual(n)||zi(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pw(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zu{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class UC extends Tw{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new rm(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(mg("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class rm extends UC{data(e={}){return super.data(e)}}class x9{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new zu(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new rm(this._firestore,this._userDataWriter,r.key,r,new zu(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new Z(V.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(l=>{const c=new rm(s._firestore,s._userDataWriter,l.doc.key,l.doc,new zu(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);return l.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(l=>i||l.type!==3).map(l=>{const c=new rm(s._firestore,s._userDataWriter,l.doc.key,l.doc,new zu(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);let u=-1,d=-1;return l.type!==0&&(u=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),d=o.indexOf(l.doc.key)),{type:y9(l.type),doc:c,oldIndex:u,newIndex:d}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function y9(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Se()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tc(t){t=rs(t,Zn);const e=rs(t.firestore,Ja);return n9(hg(e),t._key).then(n=>b9(e,t,n))}class HC extends g9{constructor(e){super(),this.firestore=e}convertBytes(e){return new kc(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Zn(this.firestore,null,n)}}function tn(t){t=rs(t,Xi);const e=rs(t.firestore,Ja),n=hg(e),r=new HC(e);return m9(t._query),r9(n,t._query).then(s=>new x9(e,r,t,s))}function tv(t,e,n){t=rs(t,Zn);const r=rs(t.firestore,Ja),s=Pw(t.converter,e,n);return uh(r,[bw(Qc(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,Jn.none())])}function v9(t,e,n,...r){t=rs(t,Zn);const s=rs(t.firestore,Ja),i=Qc(s);let o;return o=typeof(e=Ht(e))=="string"||e instanceof Kc?LC(i,"updateDoc",t._key,e,n,r):DC(i,"updateDoc",t._key,e),uh(s,[o.toMutation(t._key,Jn.exists(!0))])}function w9(t){return uh(rs(t.firestore,Ja),[new ig(t._key,Jn.none())])}function _9(t,e){const n=rs(t.firestore,Ja),r=gt(t),s=Pw(t.converter,e);return uh(n,[bw(Qc(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,Jn.exists(!1))]).then(()=>r)}function uh(t,e){return function(r,s){const i=new Ni;return r.asyncQueue.enqueueAndForget(async()=>G7(await t9(r),s,i)),i.promise}(hg(t),e)}function b9(t,e,n){const r=n.docs.get(e._key),s=new HC(t);return new UC(t,s,e._key,r,new zu(n.hasPendingWrites,n.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S9{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=Qc(e)}set(e,n,r){this._verifyNotCommitted();const s=ex(e,this._firestore),i=Pw(s.converter,n,r),o=bw(this._dataReader,"WriteBatch.set",s._key,i,s.converter!==null,r);return this._mutations.push(o.toMutation(s._key,Jn.none())),this}update(e,n,r,...s){this._verifyNotCommitted();const i=ex(e,this._firestore);let o;return o=typeof(n=Ht(n))=="string"||n instanceof Kc?LC(this._dataReader,"WriteBatch.update",i._key,n,r,s):DC(this._dataReader,"WriteBatch.update",i._key,n),this._mutations.push(o.toMutation(i._key,Jn.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=ex(e,this._firestore);return this._mutations=this._mutations.concat(new ig(n._key,Jn.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Z(V.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function ex(t,e){if((t=Ht(t)).firestore!==e)throw new Z(V.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}function pt(){return new Sw("serverTimestamp")}function Ai(t){return new Ew("increment",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ls(t){return hg(t=rs(t,Ja)),new S9(t,e=>uh(t,e))}(function(e,n=!0){(function(s){Gc=s})(Hc),yc(new Go("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),l=new Ja(new jL(r.getProvider("auth-internal")),new CL(r.getProvider("app-check-internal")),function(u,d){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new Z(V.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new kd(u.options.projectId,d)}(o,s),o);return i=Object.assign({useFetchStreams:n},i),l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),Da(Rb,"4.7.3",e),Da(Rb,"4.7.3","esm2017")})();const GC="HD-MP3",Un=t=>(n=>n.toLocaleLowerCase().replace(/à|á|ạ|ả|ã|â|ầ|ấ|ậ|ẩ|ẫ|ă|ắ|ằ|ẳ|ẵ|ặ/g,"a").replace(/è|é|ẹ|ẻ|ẽ|ê|ề|ế|ệ|ể|ễ/g,"e").replace(/ì|í|ị|ỉ|ĩ/g,"i").replace(/ò|ó|ọ|ỏ|õ|ô|ồ|ố|ộ|ổ|ỗ|ơ|ớ|ờ|ở|ỡ|ợ/g,"o").replace(/ù|ú|ụ|ủ|ũ|ư|ừ|ứ|ự|ử|ữ/g,"u").replace(/ỳ|ý|ý|ỷ|ỹ/g,"y").replace(/đ/g,"d"))(t),Xr=lI.create({baseURL:"https://express-zingmp3-production.up.railway.app/api"}),un=()=>JSON.parse(localStorage.getItem(GC)||"{}"),ot=(t,e)=>{const n=un();return n[t]=e,localStorage.setItem(GC,JSON.stringify(n))},Ic=t=>{const e=Math.floor(t/60),n=Math.round(t%60);return`${e}:${n.toString().padStart(2,"0")}`},ss=async t=>new Promise(e=>setTimeout(e,t)),WC=(t,e)=>{t.scrollIntoView({behavior:e||"smooth",block:"center"})},Pd=t=>t?"disable":"",Ha=t=>t?"hidden":"",Oa=(t,e)=>t?e:"",E9=t=>{const e=new Date,n=new Date(e.getFullYear(),e.getMonth(),e.getDate(),...t);return Bt.fromDate(n)};let sm=Lm[0];const j9=un(),mS=j9.theme;location.hash.includes("dashboard")?sm=sm:mS&&[...Lm,...DT].forEach(t=>{t.id===mS&&(sm=t)});const k9=()=>{const[t,e]=h.useState(sm);return{theme:t,setTheme:e,isOnMobile:window.innerWidth<768}},qC=h.createContext(null),T9=({children:t})=>a.jsx(qC.Provider,{value:k9(),children:t}),as=()=>{const t=h.useContext(qC);if(!t)throw new Error("ThemeProvider not provided");return t},I9=()=>{const[t,e]=h.useState([]);return{toasts:t,setErrorToast:s=>e(i=>[...i,{variant:"error",id:Date.now()+"",desc:s||"Something went wrong"}]),setSuccessToast:s=>e(i=>[...i,{variant:"success",id:Date.now()+"",desc:s||"Successful"}]),setToasts:e}},KC=h.createContext(null);function C9({children:t}){return a.jsx(KC.Provider,{value:I9(),children:t})}const ne=()=>{const t=h.useContext(KC);if(!t)throw new Error("Toast Context not provided");return t};function R9(){const[t,e]=h.useState(),[n,r]=h.useState(),[s,i]=h.useState([]),o=h.useRef(!0),l=h.useMemo(()=>{const u=[];return(t!=null&&t.category_ids?t.category_ids.split("_"):[]).forEach(f=>{const p=s.find(g=>g.id===f);p&&u.push(p)}),u},[t,s]),c=h.useMemo(()=>{const u=[];return(n!=null&&n.category_ids?n.category_ids.split("_"):[]).forEach(f=>{const p=s.find(g=>g.id===f);p&&u.push(p)}),u},[n,s]);return{categoryPage:t,setCategoryPage:e,homePage:n,setHomePage:r,categories:s,setCategories:i,categorySliders:l,homeSliders:c,shouldFetch:o}}const QC=h.createContext(null);function N9({children:t}){return a.jsx(QC.Provider,{value:R9(),children:t})}const qn=()=>{const t=h.useContext(QC);if(!t)throw new Error("PageProvider is not provided");return t},A9=()=>{const[t,e]=h.useState([]),[n,r]=h.useState([]),s=h.useRef(!0);return{ahead:t,behind:n,setAhead:e,setBehind:r,shouldStoreLocation:s}},XC=h.createContext(null),YC=()=>{const t=h.useContext(XC);if(!t)throw new Error("Navigation context not provided");return t};function JC(){const{ahead:t,setAhead:e,setBehind:n,shouldStoreLocation:r}=YC(),s=Wn(),i=h.useMemo(()=>s.pathname+s.search,[s]),o=h.useRef(!1);return h.useEffect(()=>{if(!o.current){o.current=!0;return}return()=>{r.current?(t.length&&e([]),n(l=>[...l,i])):r.current=!0}},[s.pathname]),a.jsx(a.Fragment,{})}function ZC({children:t}){return a.jsx(XC.Provider,{value:A9(),children:t})}function P9(){const[t,e]=h.useState([]),[n,r]=h.useState(!1);return{uploadingSongs:t,setUploadingSongs:e,isUploading:n,setIsUploading:r,resetUploadContext:()=>{r(!1),e([])}}}const eR=h.createContext(null),F9=({children:t})=>a.jsx(eR.Provider,{value:P9(),children:t}),tR=()=>{const t=h.useContext(eR);if(!t)throw new Error("UploadSongProvider not provided");return t},M9=["Songs","Karaoke","Lyric"],D9=["Playing","Lyric"],Cl=un();function L9(){const[t,e]=h.useState(!1),[n,r]=h.useState(!1),[s,i]=h.useState("Lyric"),[o,l]=h.useState("Lyric"),[c,u]=h.useState(!1),[d,f]=h.useState({lyricSize:Cl.lyricSize||"medium",repeat:Cl.isRepeat||"no",isShuffle:Cl.isShuffle||!1,isCrossFade:Cl.isCrossFade||!1,songBackground:Cl.songBackground||!0,songImage:Cl.songImage||!0,isEnableBeat:!1}),p=h.useRef(!0),g=h.useRef(0),x=h.useRef(!0),w=h.useRef(""),v=h.useRef(!1),_=h.useRef("var(--primary-cl)"),b=h.useRef(null),j=h.useRef(null),T=h.useRef(null);return{audioRef:b,themeCodeRef:w,isOpenFullScreen:t,isOpenSongQueue:n,idle:c,setIdle:u,setIsOpenFullScreen:e,setIsOpenSongQueue:r,activeTab:s,setActiveTab:i,desktopTabs:M9,mobileActiveTab:o,setMobileActiveTab:l,mobileTabs:D9,playerConfig:d,updatePlayerConfig:M=>{f(k=>({...k,...M}))},firstTimeSongLoaded:p,timelineEleRef:j,currentTimeEleRef:T,startFadeWhenEnd:g,isPlayingNewSong:x,shouldSyncSongDuration:v,timeLineColorRef:_}}const nR=h.createContext(null);function O9({children:t}){return a.jsx(nR.Provider,{value:L9(),children:t})}function lt(){const t=h.useContext(nR);if(!t)throw new Error("Player Context not provided");return t}const $9=()=>{const[t,e]=h.useState([]),[n,r]=h.useState(!1),s=h.useRef(!0);return{songLyrics:t,setSongLyrics:e,loading:n,setLoading:r,shouldGetLyric:s}},rR=h.createContext(null);function sR({children:t}){return a.jsx(rR.Provider,{value:$9(),children:t})}const Fw=()=>{const t=h.useContext(rR);if(!t)throw new Error("Lyric context not found");return t},z9=()=>{const[t,e]=h.useState(!1),[n,r]=h.useState(!1),[s,i]=h.useState([]);return{isChecked:t,setIsChecked:e,isSelectAll:n,setIsSelectAll:r,setSelectedSongs:i,selectedSongs:s,selectAllSong:u=>{e(!0),r(!0),i(u)},selectSong:u=>{const d=[...s],f=d.findIndex(p=>p.id===u.id);f===-1?d.push(u):d.splice(f,1),e(!!d.length),i(d)},resetSelect:()=>{e(!1),r(!1),i([])}}},iR=h.createContext(null);function Os({children:t}){return a.jsx(iR.Provider,{value:z9(),children:t})}const dl=()=>{const t=h.useContext(iR);if(!t)throw new Error("SelectSongContext not provided");return t};function tx({onClick:t,theme:e,active:n}){return a.jsx(a.Fragment,{children:a.jsxs("div",{className:"w-[25%] px-2 mt-3 max-[549px]:w-[50%]",children:[a.jsx("div",{onClick:()=>t(e),className:`relative popup-shadow border-l-[20px] ${e.container} ${e.border}  pt-[100%] rounded-xl`,children:n&&a.jsx("div",{className:"absolute bottom-[10px] right-[10px]",children:a.jsx(y6,{className:"w-[25px]"})})}),a.jsx("p",{className:"text-base font-[500] mt-1",children:e.name})]})})}function aR({closeModal:t}){const{theme:e,setTheme:n}=as(),r=c=>{ot("theme",c.id),n(c)},s={themeContainer:"overflow-auto flex-grow no-scrollbar space-y-5 pb-[5vh]",themeList:"flex flex-row -mx-2 -mt-3 flex-wrap"},i=Lm.map(c=>{const u=c.id===e.id;if(c.type==="light")return a.jsx(tx,{active:u,theme:c,onClick:r},c.id)}),o=Lm.map(c=>{const u=c.id===e.id;if(c.type==="dark")return a.jsx(tx,{active:u,theme:c,onClick:r},c.id)}),l=DT.map(c=>{const u=c.id===e.id;return a.jsx(tx,{active:u,theme:c,onClick:r},c.id)});return a.jsxs(je,{className:"w-[900px]",children:[a.jsx(qe,{closeModal:t,title:"Themes"}),a.jsxs("div",{className:s.themeContainer,children:[a.jsxs("div",{children:[a.jsx(oe,{variant:"h2",className:"mb-3",title:"Specical"}),a.jsx("div",{className:s.themeList,children:l})]}),a.jsxs("div",{children:[a.jsx(oe,{variant:"h2",className:"mb-3",title:"Dark"}),a.jsx("div",{className:s.themeList,children:o})]}),a.jsxs("div",{children:[a.jsx(oe,{variant:"h2",className:"mb-3",title:"Light"}),a.jsx("div",{className:s.themeList,children:i})]})]})]})}function hn({loading:t,callback:e,label:n,children:r,closeModal:s,desc:i="This action cannot be undone"}){return a.jsxs(je,{className:"w-[450px]",children:[a.jsx(qe,{closeModal:s,title:n||"Wait a minute"}),i&&a.jsx("p",{className:"font-semibold text-lg text-red-400",children:i}),a.jsx("div",{className:"flex space-x-3 mt-5",children:r||a.jsxs(a.Fragment,{children:[a.jsx(ce,{onClick:s,disabled:t,className:"hover:bg-[--a-5-cl] rounded-full px-3 py-1",variant:"primary",size:"clear",children:"Close"}),a.jsx(ce,{isLoading:t,color:"primary",className:"rounded-full px-3",variant:"primary",size:"clear",onClick:e,children:"Yes, Please"})]})})]})}const B9=[3,5,7,10];function oR({closeModal:t,active:e}){const n={list:`flex flex-wrap mt-2 -ml-2 mb-3 [&>button]:bg-[--a-5-cl]
    hover:[&>button]:bg-[--primary-cl]
    hover:[&>button]:text-white
    [&>button]:ml-2
    [&>button]:mt-2
    [&>button]:px-3
    [&>button]:py-1
    [&>button]:font-semibold
    [&>button]:rounded-[99px]`},r=i=>{e(i),t()},s=B9.map(i=>a.jsxs("button",{type:"button",onClick:()=>r(i),children:[i," songs"]},i));return a.jsxs(je,{children:[a.jsx(qe,{closeModal:t,title:"Sleep timer"}),a.jsx("div",{className:n.list,children:s})]})}function V9({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{fillRule:"evenodd",d:"M15.312 11.424a5.5 5.5 0 01-9.201 2.466l-.312-.311h2.433a.75.75 0 000-1.5H3.989a.75.75 0 00-.75.75v4.242a.75.75 0 001.5 0v-2.43l.31.31a7 7 0 0011.712-3.138.75.75 0 00-1.449-.39zm1.23-3.723a.75.75 0 00.219-.53V2.929a.75.75 0 00-1.5 0V5.36l-.31-.31A7 7 0 003.239 8.188a.75.75 0 101.448.389A5.5 5.5 0 0113.89 6.11l.311.31h-2.432a.75.75 0 000 1.5h4.243a.75.75 0 00.53-.219z",clipRule:"evenodd"}))}const U9=h.forwardRef(V9),lR=U9;function H9({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{fillRule:"evenodd",d:"M10 17a.75.75 0 01-.75-.75V5.612L5.29 9.77a.75.75 0 01-1.08-1.04l5.25-5.5a.75.75 0 011.08 0l5.25 5.5a.75.75 0 11-1.08 1.04l-3.96-4.158V16.25A.75.75 0 0110 17z",clipRule:"evenodd"}))}const G9=h.forwardRef(H9),W9=G9;function q9({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{fillRule:"evenodd",d:"M3.43 2.524A41.29 41.29 0 0110 2c2.236 0 4.43.18 6.57.524 1.437.231 2.43 1.49 2.43 2.902v5.148c0 1.413-.993 2.67-2.43 2.902a41.102 41.102 0 01-3.55.414c-.28.02-.521.18-.643.413l-1.712 3.293a.75.75 0 01-1.33 0l-1.713-3.293a.783.783 0 00-.642-.413 41.108 41.108 0 01-3.55-.414C1.993 13.245 1 11.986 1 10.574V5.426c0-1.413.993-2.67 2.43-2.902z",clipRule:"evenodd"}))}const K9=h.forwardRef(q9),Q9=K9;function X9({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{fillRule:"evenodd",d:"M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.05-.143z",clipRule:"evenodd"}))}const Y9=h.forwardRef(X9),dh=Y9;function J9({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{fillRule:"evenodd",d:"M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z",clipRule:"evenodd"}))}const Z9=h.forwardRef(J9),e$=Z9;function t$({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm.75-13a.75.75 0 00-1.5 0v5c0 .414.336.75.75.75h4a.75.75 0 000-1.5h-3.25V5z",clipRule:"evenodd"}))}const n$=h.forwardRef(t$),r$=n$;function s$({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"}))}const i$=h.forwardRef(s$),cR=i$;function a$({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.536-4.464a.75.75 0 10-1.061-1.061 3.5 3.5 0 01-4.95 0 .75.75 0 00-1.06 1.06 5 5 0 007.07 0zM9 8.5c0 .828-.448 1.5-1 1.5s-1-.672-1-1.5S7.448 7 8 7s1 .672 1 1.5zm3 1.5c.552 0 1-.672 1-1.5S12.552 7 12 7s-1 .672-1 1.5.448 1.5 1 1.5z",clipRule:"evenodd"}))}const o$=h.forwardRef(a$),l$=o$;function c$({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{d:"M9.653 16.915l-.005-.003-.019-.01a20.759 20.759 0 01-1.162-.682 22.045 22.045 0 01-2.582-1.9C4.045 12.733 2 10.352 2 7.5a4.5 4.5 0 018-2.828A4.5 4.5 0 0118 7.5c0 2.852-2.044 5.233-3.885 6.82a22.049 22.049 0 01-3.744 2.582l-.019.01-.005.003h-.002a.739.739 0 01-.69.001l-.002-.001z"}))}const u$=h.forwardRef(c$),Xc=u$;function d$({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{fillRule:"evenodd",d:"M9.293 2.293a1 1 0 011.414 0l7 7A1 1 0 0117 11h-1v6a1 1 0 01-1 1h-2a1 1 0 01-1-1v-3a1 1 0 00-1-1H9a1 1 0 00-1 1v3a1 1 0 01-1 1H5a1 1 0 01-1-1v-6H3a1 1 0 01-.707-1.707l7-7z",clipRule:"evenodd"}))}const h$=h.forwardRef(d$),f$=h$;function m$({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{d:"M5.75 3a.75.75 0 00-.75.75v12.5c0 .414.336.75.75.75h1.5a.75.75 0 00.75-.75V3.75A.75.75 0 007.25 3h-1.5zM12.75 3a.75.75 0 00-.75.75v12.5c0 .414.336.75.75.75h1.5a.75.75 0 00.75-.75V3.75a.75.75 0 00-.75-.75h-1.5z"}))}const p$=h.forwardRef(m$),hl=p$;function g$({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{d:"M5.433 13.917l1.262-3.155A4 4 0 017.58 9.42l6.92-6.918a2.121 2.121 0 013 3l-6.92 6.918c-.383.383-.84.685-1.343.886l-3.154 1.262a.5.5 0 01-.65-.65z"}),h.createElement("path",{d:"M3.5 5.75c0-.69.56-1.25 1.25-1.25H10A.75.75 0 0010 3H4.75A2.75 2.75 0 002 5.75v9.5A2.75 2.75 0 004.75 18h9.5A2.75 2.75 0 0017 15.25V10a.75.75 0 00-1.5 0v5.25c0 .69-.56 1.25-1.25 1.25h-9.5c-.69 0-1.25-.56-1.25-1.25v-9.5z"}))}const x$=h.forwardRef(g$),y$=x$;function v$({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{d:"M6.3 2.841A1.5 1.5 0 004 4.11V15.89a1.5 1.5 0 002.3 1.269l9.344-5.89a1.5 1.5 0 000-2.538L6.3 2.84z"}))}const w$=h.forwardRef(v$),si=w$;function _$({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{d:"M10.75 4.75a.75.75 0 00-1.5 0v4.5h-4.5a.75.75 0 000 1.5h4.5v4.5a.75.75 0 001.5 0v-4.5h4.5a.75.75 0 000-1.5h-4.5v-4.5z"}))}const b$=h.forwardRef(_$),Vi=b$;function S$({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{d:"M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"}))}const E$=h.forwardRef(S$),hh=E$,j$=Bc("",{variants:{variant:{h1:"text-2xl font-bold",h2:"text-xl font-semibold",h3:"text-lg font-semibold"}},defaultVariants:{variant:"h1"}});function oe({title:t,variant:e,className:n=""}){return a.jsx("div",{className:`${j$({variant:e,className:n})} `,children:t})}function qe({closeModal:t,title:e}){return a.jsxs("div",{className:"flex justify-between items-center mb-3",children:[a.jsx(oe,{title:e}),a.jsx("button",{onClick:t,children:a.jsx(hh,{className:"w-7"})})]})}const pS=Bc("inline-flex relative hover:brightness-95 space-x-1 items-center z-0",{variants:{variant:{primary:"before:content-[''] before:absolute before:z-[-1] before:inset-0 active:translate-y-[2px] active:before:shadow-none",clear:"before:content-none"},color:{primary:"before:border-[#4a826f] text-[#fff] bg-[--primary-cl] before:shadow-[0_2px_0_#4a826f]",second:"before:border-[#ccc] text-[#333] bg-[#f6f6f6] before:shadow-[0_2px_0_#ccc]",clear:""},size:{primary:"px-5 py-1.5",clear:""},fontWeight:{primary:"font-semibold",clear:""},border:{primary:"before:border-[2px]",thin:"before:border-[1px]",clear:"before:border-b-[2px]"},rounded:{xl:"before:rounded-xl rounded-xl",lg:"before:rounded-lg rounded-lg",md:"before:rounded-md rounded-md"}},defaultVariants:{variant:"primary",color:"primary",size:"primary",fontWeight:"primary",border:"primary",rounded:"lg"}});function k$({onClick:t,loading:e,children:n,border:r,size:s,color:i,fontWeight:o,type:l="button",variant:c,disabled:u,rounded:d,className:f,active:p,href:g},x){const w=u||e,v="before:shadow-none translate-y-[2px]";return a.jsx(a.Fragment,{children:g?a.jsx(se,{to:g,className:`${pS({variant:c,size:s,color:i,fontWeight:o,rounded:d,border:r,className:f})} ${p?v:""}`,children:n}):a.jsx("button",{ref:x,type:l||"button",onClick:t,disabled:w,className:`${pS({variant:c,size:s,color:p?"primary":i,border:r,fontWeight:o,className:f})} ${p?v:""}`,children:e?a.jsx(Me,{className:"w-6 animate-spin"}):n})})}const J=h.forwardRef(k$),T$=Bc("border-2 border-b-[6px] rounded-xl",{variants:{p:{3:"p-3",clear:""}},defaultVariants:{p:"3"}});function Zt({children:t,onClick:e,p:n,className:r=""}){return a.jsx("div",{onClick:()=>e?e():{},className:`${T$({p:n,className:r})} `,children:t})}function Rn({className:t=""}){return a.jsx("div",{className:`flex flex-grow items-center justify-center ${t}`,children:a.jsx(Me,{className:"w-6 animate-spin"})})}function Fs({children:t,margin:e=!0,className:n=""}){const r=`${e?"mt-2 ml-2":""} font-medium flex px-3 py-1.5 text-sm rounded-lg bg-[#fff] border-[2px] border-[#e1e1e1] [&>div]:ml-1.5 [&>div]:pl-1.5 [&>div]:border [&>div]:border-transparent [&>div]:flex [&>div]:space-x-1 [&>div]:border-l-black/10 hover:[&_button]:scale-[1.05] ${n}`;return a.jsx("div",{className:r,children:t})}function I$({children:t,...e},n){return a.jsx(ie,{variant:"animation",...e,ref:n,children:t})}const Mw=h.forwardRef(I$);function Yc({children:t,className:e=""}){return a.jsx("div",{className:`-ml-2 -mt-2 flex flex-wrap [&_button]:mt-2 [&_button]:ml-2 [&_button:not(.except)]:p-1.5 [&_svg]:w-5 [&_svg]:flex-shrink-0 md:[&_button:not(.except)]:px-3 ${e} `,children:t})}var C$="firebase",R$="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Da(C$,R$,"app");function Dw(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function uR(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const N$=uR,dR=new eh("auth","Firebase",uR());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ym=new q1("@firebase/auth");function A$(t,...e){Ym.logLevel<=$e.WARN&&Ym.warn(`Auth (${Hc}): ${t}`,...e)}function im(t,...e){Ym.logLevel<=$e.ERROR&&Ym.error(`Auth (${Hc}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ii(t,...e){throw Ow(t,...e)}function Ns(t,...e){return Ow(t,...e)}function Lw(t,e,n){const r=Object.assign(Object.assign({},N$()),{[e]:n});return new eh("auth","Firebase",r).create(e,{appName:t.name})}function Oo(t){return Lw(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function P$(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&ii(t,"argument-error"),Lw(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Ow(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return dR.create(t,...e)}function be(t,e,...n){if(!t)throw Ow(e,...n)}function ki(t){const e="INTERNAL ASSERTION FAILED: "+t;throw im(e),new Error(e)}function Ui(t,e){t||ki(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nv(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function F$(){return gS()==="http:"||gS()==="https:"}function gS(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M$(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(F$()||rD()||"connection"in navigator)?navigator.onLine:!0}function D$(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fh{constructor(e,n){this.shortDelay=e,this.longDelay=n,Ui(n>e,"Short delay should be less than long delay!"),this.isMobile=eD()||sD()}get(){return M$()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $w(t,e){Ui(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hR{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ki("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ki("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ki("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L$={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O$=new fh(3e4,6e4);function zw(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Jc(t,e,n,r,s={}){return fR(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const l=th(Object.assign({key:t.config.apiKey},o)).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const u=Object.assign({method:e,headers:c},i);return nD()||(u.referrerPolicy="no-referrer"),hR.fetch()(mR(t,t.config.apiHost,n,l),u)})}async function fR(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},L$),e);try{const s=new z$(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw jf(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const l=i.ok?o.errorMessage:o.error.message,[c,u]=l.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw jf(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw jf(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw jf(t,"user-disabled",o);const d=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw Lw(t,d,u);ii(t,d)}}catch(s){if(s instanceof Qi)throw s;ii(t,"network-request-failed",{message:String(s)})}}async function $$(t,e,n,r,s={}){const i=await Jc(t,e,n,r,s);return"mfaPendingCredential"in i&&ii(t,"multi-factor-auth-required",{_serverResponse:i}),i}function mR(t,e,n,r){const s=`${e}${n}?${r}`;return t.config.emulator?$w(t.config,s):`${t.config.apiScheme}://${s}`}class z${constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Ns(this.auth,"network-request-failed")),O$.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function jf(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=Ns(t,e,r);return s.customData._tokenResponse=n,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function B$(t,e){return Jc(t,"POST","/v1/accounts:delete",e)}async function pR(t,e){return Jc(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nd(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function V$(t,e=!1){const n=Ht(t),r=await n.getIdToken(e),s=Bw(r);be(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:nd(nx(s.auth_time)),issuedAtTime:nd(nx(s.iat)),expirationTime:nd(nx(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function nx(t){return Number(t)*1e3}function Bw(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return im("JWT malformed, contained fewer than 3 sections"),null;try{const s=dI(n);return s?JSON.parse(s):(im("Failed to decode base64 JWT payload"),null)}catch(s){return im("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function xS(t){const e=Bw(t);return be(e,"internal-error"),be(typeof e.exp<"u","internal-error"),be(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Fd(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Qi&&U$(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function U$({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H${constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rv{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=nd(this.lastLoginAt),this.creationTime=nd(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Jm(t){var e;const n=t.auth,r=await t.getIdToken(),s=await Fd(t,pR(n,{idToken:r}));be(s==null?void 0:s.users.length,n,"internal-error");const i=s.users[0];t._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?gR(i.providerUserInfo):[],l=W$(t.providerData,o),c=t.isAnonymous,u=!(t.email&&i.passwordHash)&&!(l!=null&&l.length),d=c?u:!1,f={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:l,metadata:new rv(i.createdAt,i.lastLoginAt),isAnonymous:d};Object.assign(t,f)}async function G$(t){const e=Ht(t);await Jm(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function W$(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function gR(t){return t.map(e=>{var{providerId:n}=e,r=Dw(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function q$(t,e){const n=await fR(t,{},async()=>{const r=th({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=mR(t,s,"/v1/token",`key=${i}`),l=await t._getAdditionalHeaders();return l["Content-Type"]="application/x-www-form-urlencoded",hR.fetch()(o,{method:"POST",headers:l,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function K$(t,e){return Jc(t,"POST","/v2/accounts:revokeToken",zw(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ac{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){be(e.idToken,"internal-error"),be(typeof e.idToken<"u","internal-error"),be(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):xS(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){be(e.length!==0,"internal-error");const n=xS(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(be(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await q$(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new ac;return r&&(be(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(be(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(be(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ac,this.toJSON())}_performRefresh(){return ki("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function da(t,e){be(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Ti{constructor(e){var{uid:n,auth:r,stsTokenManager:s}=e,i=Dw(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new H$(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new rv(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await Fd(this,this.stsTokenManager.getToken(this.auth,e));return be(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return V$(this,e)}reload(){return G$(this)}_assign(e){this!==e&&(be(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Ti(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){be(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Jm(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ji(this.auth.app))return Promise.reject(Oo(this.auth));const e=await this.getIdToken();return await Fd(this,B$(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,s,i,o,l,c,u,d;const f=(r=n.displayName)!==null&&r!==void 0?r:void 0,p=(s=n.email)!==null&&s!==void 0?s:void 0,g=(i=n.phoneNumber)!==null&&i!==void 0?i:void 0,x=(o=n.photoURL)!==null&&o!==void 0?o:void 0,w=(l=n.tenantId)!==null&&l!==void 0?l:void 0,v=(c=n._redirectEventId)!==null&&c!==void 0?c:void 0,_=(u=n.createdAt)!==null&&u!==void 0?u:void 0,b=(d=n.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:j,emailVerified:T,isAnonymous:R,providerData:M,stsTokenManager:k}=n;be(j&&k,e,"internal-error");const E=ac.fromJSON(this.name,k);be(typeof j=="string",e,"internal-error"),da(f,e.name),da(p,e.name),be(typeof T=="boolean",e,"internal-error"),be(typeof R=="boolean",e,"internal-error"),da(g,e.name),da(x,e.name),da(w,e.name),da(v,e.name),da(_,e.name),da(b,e.name);const I=new Ti({uid:j,auth:e,email:p,emailVerified:T,displayName:f,isAnonymous:R,photoURL:x,phoneNumber:g,tenantId:w,stsTokenManager:E,createdAt:_,lastLoginAt:b});return M&&Array.isArray(M)&&(I.providerData=M.map(C=>Object.assign({},C))),v&&(I._redirectEventId=v),I}static async _fromIdTokenResponse(e,n,r=!1){const s=new ac;s.updateFromServerResponse(n);const i=new Ti({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await Jm(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];be(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?gR(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),l=new ac;l.updateFromIdToken(r);const c=new Ti({uid:s.localId,auth:e,stsTokenManager:l,isAnonymous:o}),u={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new rv(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(c,u),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yS=new Map;function Ii(t){Ui(t instanceof Function,"Expected a class definition");let e=yS.get(t);return e?(Ui(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,yS.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xR{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}xR.type="NONE";const vS=xR;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function am(t,e,n){return`firebase:${t}:${e}:${n}`}class oc{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=am(this.userKey,s.apiKey,i),this.fullPersistenceKey=am("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Ti._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new oc(Ii(vS),e,r);const s=(await Promise.all(n.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let i=s[0]||Ii(vS);const o=am(r,e.config.apiKey,e.name);let l=null;for(const u of n)try{const d=await u._get(o);if(d){const f=Ti._fromJSON(e,d);u!==i&&(l=f),i=u;break}}catch{}const c=s.filter(u=>u._shouldAllowMigration);return!i._shouldAllowMigration||!c.length?new oc(i,e,r):(i=c[0],l&&await i._set(o,l.toJSON()),await Promise.all(n.map(async u=>{if(u!==i)try{await u._remove(o)}catch{}})),new oc(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wS(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(_R(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(yR(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(SR(e))return"Blackberry";if(ER(e))return"Webos";if(vR(e))return"Safari";if((e.includes("chrome/")||wR(e))&&!e.includes("edge/"))return"Chrome";if(bR(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function yR(t=Gn()){return/firefox\//i.test(t)}function vR(t=Gn()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function wR(t=Gn()){return/crios\//i.test(t)}function _R(t=Gn()){return/iemobile/i.test(t)}function bR(t=Gn()){return/android/i.test(t)}function SR(t=Gn()){return/blackberry/i.test(t)}function ER(t=Gn()){return/webos/i.test(t)}function Vw(t=Gn()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function Q$(t=Gn()){var e;return Vw(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function X$(){return iD()&&document.documentMode===10}function jR(t=Gn()){return Vw(t)||bR(t)||ER(t)||SR(t)||/windows phone/i.test(t)||_R(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kR(t,e=[]){let n;switch(t){case"Browser":n=wS(Gn());break;case"Worker":n=`${wS(Gn())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Hc}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y${constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,l)=>{try{const c=e(i);o(c)}catch(c){l(c)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function J$(t,e={}){return Jc(t,"GET","/v2/passwordPolicy",zw(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z$=6;class ez{constructor(e){var n,r,s,i;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:Z$,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,s,i,o,l;const c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(n=c.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),c.isValid&&(c.isValid=(r=c.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(s=c.containsLowercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(i=c.containsUppercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(l=c.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),c}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tz{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new _S(this),this.idTokenSubscription=new _S(this),this.beforeStateQueue=new Y$(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=dR,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Ii(n)),this._initializationPromise=this.queue(async()=>{var r,s;if(!this._deleted&&(this.persistenceManager=await oc.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await pR(this,{idToken:e}),r=await Ti._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(ji(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let s=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,l=s==null?void 0:s._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===l)&&(c!=null&&c.user)&&(s=c.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return be(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Jm(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=D$()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(ji(this.app))return Promise.reject(Oo(this));const n=e?Ht(e):null;return n&&be(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&be(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return ji(this.app)?Promise.reject(Oo(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return ji(this.app)?Promise.reject(Oo(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ii(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await J$(this),n=new ez(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new eh("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await K$(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Ii(e)||this._popupRedirectResolver;be(n,this,"argument-error"),this.redirectPersistenceManager=await oc.create(this,[Ii(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(be(l,this,"internal-error"),l.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const c=e.addObserver(n,r,s);return()=>{o=!0,c()}}else{const c=e.addObserver(n);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return be(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=kR(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(n["X-Firebase-AppCheck"]=s),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&A$(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function yg(t){return Ht(t)}class _S{constructor(e){this.auth=e,this.observer=null,this.addObserver=fD(n=>this.observer=n)}get next(){return be(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Uw={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function nz(t){Uw=t}function rz(t){return Uw.loadJS(t)}function sz(){return Uw.gapiScript}function iz(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function az(t,e){const n=Q1(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(Vm(i,e??{}))return s;ii(s,"already-initialized")}return n.initialize({options:e})}function oz(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Ii);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function lz(t,e,n){const r=yg(t);be(r._canInitEmulator,r,"emulator-config-failed"),be(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!!(n!=null&&n.disableWarnings),i=TR(e),{host:o,port:l}=cz(e),c=l===null?"":`:${l}`;r.config.emulator={url:`${i}//${o}${c}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:l,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),s||uz()}function TR(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function cz(t){const e=TR(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:bS(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:bS(o)}}}function bS(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function uz(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IR{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return ki("not implemented")}_getIdTokenResponse(e){return ki("not implemented")}_linkToIdToken(e,n){return ki("not implemented")}_getReauthenticationResolver(e){return ki("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lc(t,e){return $$(t,"POST","/v1/accounts:signInWithIdp",zw(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dz="http://localhost";class Qo extends IR{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Qo(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):ii("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=n,i=Dw(n,["providerId","signInMethod"]);if(!r||!s)return null;const o=new Qo(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return lc(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,lc(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,lc(e,n)}buildRequest(){const e={requestUri:dz,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=th(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hw{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mh extends Hw{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xa extends mh{constructor(){super("facebook.com")}static credential(e){return Qo._fromParams({providerId:xa.PROVIDER_ID,signInMethod:xa.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return xa.credentialFromTaggedObject(e)}static credentialFromError(e){return xa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return xa.credential(e.oauthAccessToken)}catch{return null}}}xa.FACEBOOK_SIGN_IN_METHOD="facebook.com";xa.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bi extends mh{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Qo._fromParams({providerId:bi.PROVIDER_ID,signInMethod:bi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return bi.credentialFromTaggedObject(e)}static credentialFromError(e){return bi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return bi.credential(n,r)}catch{return null}}}bi.GOOGLE_SIGN_IN_METHOD="google.com";bi.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ya extends mh{constructor(){super("github.com")}static credential(e){return Qo._fromParams({providerId:ya.PROVIDER_ID,signInMethod:ya.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ya.credentialFromTaggedObject(e)}static credentialFromError(e){return ya.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ya.credential(e.oauthAccessToken)}catch{return null}}}ya.GITHUB_SIGN_IN_METHOD="github.com";ya.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class va extends mh{constructor(){super("twitter.com")}static credential(e,n){return Qo._fromParams({providerId:va.PROVIDER_ID,signInMethod:va.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return va.credentialFromTaggedObject(e)}static credentialFromError(e){return va.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return va.credential(n,r)}catch{return null}}}va.TWITTER_SIGN_IN_METHOD="twitter.com";va.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cc{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await Ti._fromIdTokenResponse(e,r,s),o=SS(r);return new Cc({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=SS(r);return new Cc({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function SS(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zm extends Qi{constructor(e,n,r,s){var i;super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,Zm.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new Zm(e,n,r,s)}}function CR(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Zm._fromErrorAndOperation(t,i,e,r):i})}async function hz(t,e,n=!1){const r=await Fd(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Cc._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fz(t,e,n=!1){const{auth:r}=t;if(ji(r.app))return Promise.reject(Oo(r));const s="reauthenticate";try{const i=await Fd(t,CR(r,s,e,t),n);be(i.idToken,r,"internal-error");const o=Bw(i.idToken);be(o,r,"internal-error");const{sub:l}=o;return be(t.uid===l,r,"user-mismatch"),Cc._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&ii(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mz(t,e,n=!1){if(ji(t.app))return Promise.reject(Oo(t));const r="signIn",s=await CR(t,r,e),i=await Cc._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}function pz(t,e,n,r){return Ht(t).onIdTokenChanged(e,n,r)}function gz(t,e,n){return Ht(t).beforeAuthStateChanged(e,n)}function xz(t,e,n,r){return Ht(t).onAuthStateChanged(e,n,r)}function yz(t){return Ht(t).signOut()}const ep="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RR{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(ep,"1"),this.storage.removeItem(ep),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vz=1e3,wz=10;class NR extends RR{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=jR(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,l,c)=>{this.notifyListeners(o,c)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);X$()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,wz):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},vz)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}NR.type="LOCAL";const _z=NR;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AR extends RR{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}AR.type="SESSION";const PR=AR;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bz(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vg{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new vg(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const l=Array.from(o).map(async u=>u(n.origin,i)),c=await bz(l);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:c})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}vg.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gw(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sz{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((l,c)=>{const u=Gw("",20);s.port1.start();const d=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(f){const p=f;if(p.data.eventId===u)switch(p.data.status){case"ack":clearTimeout(d),i=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),l(p.data.response);break;default:clearTimeout(d),clearTimeout(i),c(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ni(){return window}function Ez(t){ni().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FR(){return typeof ni().WorkerGlobalScope<"u"&&typeof ni().importScripts=="function"}async function jz(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function kz(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function Tz(){return FR()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MR="firebaseLocalStorageDb",Iz=1,tp="firebaseLocalStorage",DR="fbase_key";class ph{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function wg(t,e){return t.transaction([tp],e?"readwrite":"readonly").objectStore(tp)}function Cz(){const t=indexedDB.deleteDatabase(MR);return new ph(t).toPromise()}function sv(){const t=indexedDB.open(MR,Iz);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(tp,{keyPath:DR})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(tp)?e(r):(r.close(),await Cz(),e(await sv()))})})}async function ES(t,e,n){const r=wg(t,!0).put({[DR]:e,value:n});return new ph(r).toPromise()}async function Rz(t,e){const n=wg(t,!1).get(e),r=await new ph(n).toPromise();return r===void 0?null:r.value}function jS(t,e){const n=wg(t,!0).delete(e);return new ph(n).toPromise()}const Nz=800,Az=3;class LR{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await sv(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>Az)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return FR()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=vg._getInstance(Tz()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await jz(),!this.activeServiceWorker)return;this.sender=new Sz(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||kz()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await sv();return await ES(e,ep,"1"),await jS(e,ep),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>ES(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>Rz(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>jS(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=wg(s,!1).getAll();return new ph(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Nz)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}LR.type="LOCAL";const Pz=LR;new fh(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OR(t,e){return e?Ii(e):(be(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ww extends IR{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return lc(e,this._buildIdpRequest())}_linkToIdToken(e,n){return lc(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return lc(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function Fz(t){return mz(t.auth,new Ww(t),t.bypassAuthState)}function Mz(t){const{auth:e,user:n}=t;return be(n,e,"internal-error"),fz(n,new Ww(t),t.bypassAuthState)}async function Dz(t){const{auth:e,user:n}=t;return be(n,e,"internal-error"),hz(n,new Ww(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $R{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:l}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(c))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Fz;case"linkViaPopup":case"linkViaRedirect":return Dz;case"reauthViaPopup":case"reauthViaRedirect":return Mz;default:ii(this.auth,"internal-error")}}resolve(e){Ui(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ui(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lz=new fh(2e3,1e4);async function Oz(t,e,n){if(ji(t.app))return Promise.reject(Ns(t,"operation-not-supported-in-this-environment"));const r=yg(t);P$(t,e,Hw);const s=OR(r,n);return new Fo(r,"signInViaPopup",e,s).executeNotNull()}class Fo extends $R{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,Fo.currentPopupAction&&Fo.currentPopupAction.cancel(),Fo.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return be(e,this.auth,"internal-error"),e}async onExecution(){Ui(this.filter.length===1,"Popup operations only handle one event");const e=Gw();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Ns(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Ns(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Fo.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Ns(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Lz.get())};e()}}Fo.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $z="pendingRedirect",om=new Map;class zz extends $R{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=om.get(this.auth._key());if(!e){try{const r=await Bz(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}om.set(this.auth._key(),e)}return this.bypassAuthState||om.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Bz(t,e){const n=Hz(e),r=Uz(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function Vz(t,e){om.set(t._key(),e)}function Uz(t){return Ii(t._redirectPersistence)}function Hz(t){return am($z,t.config.apiKey,t.name)}async function Gz(t,e,n=!1){if(ji(t.app))return Promise.reject(Oo(t));const r=yg(t),s=OR(r,e),o=await new zz(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wz=10*60*1e3;class qz{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Kz(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!zR(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(Ns(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Wz&&this.cachedEventUids.clear(),this.cachedEventUids.has(kS(e))}saveEventToCache(e){this.cachedEventUids.add(kS(e)),this.lastProcessedEventTime=Date.now()}}function kS(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function zR({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function Kz(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return zR(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Qz(t,e={}){return Jc(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xz=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Yz=/^https?/;async function Jz(t){if(t.config.emulator)return;const{authorizedDomains:e}=await Qz(t);for(const n of e)try{if(Zz(n))return}catch{}ii(t,"unauthorized-domain")}function Zz(t){const e=nv(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!Yz.test(n))return!1;if(Xz.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eB=new fh(3e4,6e4);function TS(){const t=ni().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function tB(t){return new Promise((e,n)=>{var r,s,i;function o(){TS(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{TS(),n(Ns(t,"network-request-failed"))},timeout:eB.get()})}if(!((s=(r=ni().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=ni().gapi)===null||i===void 0)&&i.load)o();else{const l=iz("iframefcb");return ni()[l]=()=>{gapi.load?o():n(Ns(t,"network-request-failed"))},rz(`${sz()}?onload=${l}`).catch(c=>n(c))}}).catch(e=>{throw lm=null,e})}let lm=null;function nB(t){return lm=lm||tB(t),lm}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rB=new fh(5e3,15e3),sB="__/auth/iframe",iB="emulator/auth/iframe",aB={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},oB=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function lB(t){const e=t.config;be(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?$w(e,iB):`https://${t.config.authDomain}/${sB}`,r={apiKey:e.apiKey,appName:t.name,v:Hc},s=oB.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${th(r).slice(1)}`}async function cB(t){const e=await nB(t),n=ni().gapi;return be(n,t,"internal-error"),e.open({where:document.body,url:lB(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:aB,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=Ns(t,"network-request-failed"),l=ni().setTimeout(()=>{i(o)},rB.get());function c(){ni().clearTimeout(l),s(r)}r.ping(c).then(c,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uB={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},dB=500,hB=600,fB="_blank",mB="http://localhost";class IS{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function pB(t,e,n,r=dB,s=hB){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const c=Object.assign(Object.assign({},uB),{width:r.toString(),height:s.toString(),top:i,left:o}),u=Gn().toLowerCase();n&&(l=wR(u)?fB:n),yR(u)&&(e=e||mB,c.scrollbars="yes");const d=Object.entries(c).reduce((p,[g,x])=>`${p}${g}=${x},`,"");if(Q$(u)&&l!=="_self")return gB(e||"",l),new IS(null);const f=window.open(e||"",l,d);be(f,t,"popup-blocked");try{f.focus()}catch{}return new IS(f)}function gB(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xB="__/auth/handler",yB="emulator/auth/handler",vB=encodeURIComponent("fac");async function CS(t,e,n,r,s,i){be(t.config.authDomain,t,"auth-domain-config-required"),be(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Hc,eventId:s};if(e instanceof Hw){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",hD(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,f]of Object.entries(i||{}))o[d]=f}if(e instanceof mh){const d=e.getScopes().filter(f=>f!=="");d.length>0&&(o.scopes=d.join(","))}t.tenantId&&(o.tid=t.tenantId);const l=o;for(const d of Object.keys(l))l[d]===void 0&&delete l[d];const c=await t._getAppCheckToken(),u=c?`#${vB}=${encodeURIComponent(c)}`:"";return`${wB(t)}?${th(l).slice(1)}${u}`}function wB({config:t}){return t.emulator?$w(t,yB):`https://${t.authDomain}/${xB}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rx="webStorageSupport";class _B{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=PR,this._completeRedirectFn=Gz,this._overrideRedirectResult=Vz}async _openPopup(e,n,r,s){var i;Ui((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=await CS(e,n,r,nv(),s);return pB(e,o,Gw())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await CS(e,n,r,nv(),s);return Ez(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(Ui(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await cB(e),r=new qz(e);return n.register("authEvent",s=>(be(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(rx,{type:rx},s=>{var i;const o=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[rx];o!==void 0&&n(!!o),ii(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=Jz(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return jR()||vR()||Vw()}}const bB=_B;var RS="@firebase/auth",NS="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SB{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){be(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EB(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function jB(t){yc(new Go("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=r.options;be(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const c={apiKey:o,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:kR(t)},u=new tz(r,s,i,c);return oz(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),yc(new Go("auth-internal",e=>{const n=yg(e.getProvider("auth").getImmediate());return(r=>new SB(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Da(RS,NS,EB(t)),Da(RS,NS,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kB=5*60,TB=mI("authIdTokenMaxAge")||kB;let AS=null;const IB=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>TB)return;const s=n==null?void 0:n.token;AS!==s&&(AS=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function CB(t=yI()){const e=Q1(t,"auth");if(e.isInitialized())return e.getImmediate();const n=az(t,{popupRedirectResolver:bB,persistence:[Pz,_z,PR]}),r=mI("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=IB(i.toString());gz(n,o,()=>o(n.currentUser)),pz(n,l=>o(l))}}const s=hI("auth");return s&&lz(n,`http://${s}`),n}function RB(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}nz({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=Ns("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",RB().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});jB("Browser");const BR=xI({apiKey:"AIzaSyDS7lgm2PwJBFrYE6ZHSYJfqcQw2TLC878",appId:{}.VITE_APPID||"1:938280289868:web:e36c48cfbd55e4a8de96e",projectId:{}.VITE_PROJECTID||"zingmp3-clone-61799",authDomain:{}.VITE_AUTHDOMAIN||"zingmp3-clone-61799.firebaseapp.com"}),de=o9(BR),Ga=CB(BR),NB=new bi;var Kr={MISSING_UPLOAD_FILE_PARAMETER:{message:"Missing file parameter for upload"},MISSING_UPLOAD_FILENAME_PARAMETER:{message:"Missing fileName parameter for upload"},MISSING_PUBLIC_KEY:{message:"Missing public key for upload"},UPLOAD_ENDPOINT_NETWORK_ERROR:{message:"Request to ImageKit upload endpoint failed due to network error"},MISSING_SIGNATURE:{message:"Missing signature for upload. The SDK expects token, signature and expire for authentication."},MISSING_TOKEN:{message:"Missing token for upload. The SDK expects token, signature and expire for authentication."},MISSING_EXPIRE:{message:"Missing expire for upload. The SDK expects token, signature and expire for authentication."},INVALID_TRANSFORMATION:{message:"Invalid transformation parameter. Please include at least pre, post, or both."},INVALID_PRE_TRANSFORMATION:{message:"Invalid pre transformation parameter."},INVALID_POST_TRANSFORMATION:{message:"Invalid post transformation parameter."}};class jr extends Error{constructor(e,n){super(e),this.$ResponseMetadata=void 0,this.name="ImageKitInvalidRequestError",this.$ResponseMetadata=n}}class PS extends Error{constructor(e,n){super(e),this.reason=void 0,this.name="ImageKitAbortError",this.reason=n}}class AB extends Error{constructor(e){super(e),this.name="ImageKitUploadNetworkError"}}class FS extends Error{constructor(e,n){super(e),this.$ResponseMetadata=void 0,this.name="ImageKitServerError",this.$ResponseMetadata=n}}const PB=t=>t?new Promise((e,n)=>{const{xhr:r}=t||{};delete t.xhr;const s=r||new XMLHttpRequest;if(!t.file)return n(new jr(Kr.MISSING_UPLOAD_FILE_PARAMETER.message));if(!t.fileName)return n(new jr(Kr.MISSING_UPLOAD_FILENAME_PARAMETER.message));if(!t.publicKey||t.publicKey.length===0)return n(new jr(Kr.MISSING_PUBLIC_KEY.message));if(!t.token)return n(new jr(Kr.MISSING_TOKEN.message));if(!t.signature)return n(new jr(Kr.MISSING_SIGNATURE.message));if(!t.expire)return n(new jr(Kr.MISSING_EXPIRE.message));if(t.transformation){if(!(Object.keys(t.transformation).includes("pre")||Object.keys(t.transformation).includes("post")))return n(new jr(Kr.INVALID_TRANSFORMATION.message));if(Object.keys(t.transformation).includes("pre")&&!t.transformation.pre)return n(new jr(Kr.INVALID_PRE_TRANSFORMATION.message));if(Object.keys(t.transformation).includes("post"))if(Array.isArray(t.transformation.post))for(let u of t.transformation.post){if(u.type==="abs"&&!(u.protocol||u.value))return n(new jr(Kr.INVALID_POST_TRANSFORMATION.message));if(u.type==="transformation"&&!u.value)return n(new jr(Kr.INVALID_POST_TRANSFORMATION.message))}else return n(new jr(Kr.INVALID_POST_TRANSFORMATION.message))}var i=new FormData;let o;for(o in t)if(o){if(o==="file"&&typeof t.file!="string")i.set("file",t.file,String(t.fileName));else if(o==="tags"&&Array.isArray(t.tags))i.set("tags",t.tags.join(","));else if(o==="signature")i.set("signature",t.signature);else if(o==="expire")i.set("expire",String(t.expire));else if(o==="token")i.set("token",t.token);else if(o==="responseFields"&&Array.isArray(t.responseFields))i.set("responseFields",t.responseFields.join(","));else if(o==="extensions"&&Array.isArray(t.extensions))i.set("extensions",JSON.stringify(t.extensions));else if(o==="customMetadata"&&typeof t.customMetadata=="object"&&!Array.isArray(t.customMetadata)&&t.customMetadata!==null)i.set("customMetadata",JSON.stringify(t.customMetadata));else if(o==="transformation"&&typeof t.transformation=="object"&&t.transformation!==null)i.set(o,JSON.stringify(t.transformation));else if(o==="checks"&&t.checks)i.set("checks",t.checks);else if(t[o]!==void 0){if(["onProgress","abortSignal"].includes(o))continue;i.set(o,String(t[o]))}}t.onProgress&&(s.upload.onprogress=function(u){t.onProgress&&t.onProgress(u)});function l(){var u;return s.abort(),n(new PS("Upload aborted",(u=t.abortSignal)===null||u===void 0?void 0:u.reason))}if(t.abortSignal){if(t.abortSignal.aborted){var c;return n(new PS("Upload aborted",(c=t.abortSignal)===null||c===void 0?void 0:c.reason))}t.abortSignal.addEventListener("abort",l),s.addEventListener("loadend",()=>{t.abortSignal&&t.abortSignal.removeEventListener("abort",l)})}s.open("POST","https://upload.imagekit.io/api/v1/files/upload"),s.onerror=function(u){return n(new AB(Kr.UPLOAD_ENDPOINT_NETWORK_ERROR.message))},s.onload=function(){if(s.status>=200&&s.status<300)try{var u=JSON.parse(s.responseText),d=FB(u,s);return e(d)}catch(f){return n(f)}else if(s.status>=400&&s.status<500)try{var u=JSON.parse(s.responseText);return n(new jr(u.message??"Invalid request. Please check the parameters.",cm(s)))}catch(f){return n(f)}else try{var u=JSON.parse(s.responseText);return n(new FS(u.message??"Server error occurred while uploading the file. This is rare and usually temporary.",cm(s)))}catch{return n(new FS("Server error occurred while uploading the file. This is rare and usually temporary.",cm(s)))}},s.send(i)}):Promise.reject(new jr("Invalid options provided for upload")),FB=(t,e)=>{let n={...t};const r=cm(e);return Object.defineProperty(n,"$ResponseMetadata",{value:r,enumerable:!1,writable:!1}),n},cm=t=>{const e=MB(t);return{statusCode:t.status,headers:e,requestId:e["x-request-id"]}};function MB(t){const e={},n=t.getAllResponseHeaders();return Object.keys(n).length&&n.trim().split(/[\r\n]+/).map(r=>r.split(/: /)).forEach(r=>{e[r[0].trim().toLowerCase()]=r[1].trim()}),e}h.createContext({});const DB="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let fl=(t=21)=>{let e="",n=crypto.getRandomValues(new Uint8Array(t|=0));for(;t--;)e+=DB[n[t]&63];return e};const VR=async t=>{const e=Date.now(),n=await Xr.post("/image/encode",t);let r="";n&&(r=n.data.data.encode);const s=(Date.now()-e)/1e3;return console.log(">>> api: get blurHash encode finished after",s),{encode:r}},LB=async(t,e)=>{const n=new FormData;n.append("file",t);const r=Date.now(),s=await Xr.post("/image/optimize",n,{responseType:"blob",params:e});let i;s&&(i=s.data);const o=(Date.now()-r)/1e3;return console.log(">>> api: optimize finished after",o),i};async function Cn(t,e){const n=await tn(t);return n.docs?n.docs.map(s=>{const i={...s.data(),id:s.id,queue_id:fl(4)};return e!=null&&e.getQueueId&&(i.queue_id=e.getQueueId(i)),i}):[]}async function wr(t,e){const n=await tn(t);return n.docs.length?n.docs.map(s=>({...s.data(),id:s.id})):[]}async function Md(t){const e=await tn(t);return e.docs.length?e.docs.map(r=>({...r.data(),id:r.id})):[]}const Yi=async({imageFile:t,blob:e,fromUrl:n,...r})=>{let s=e;if(t?s=await LB(t,r):n&&(s=await(await fetch(n)).blob()),!s)throw new Error("File not found");const i=new File([s],"image.jpeg",{type:s.type}),o=gh({file:i,folder:"/images/",msg:"upload image file"}),{encode:l}=await VR(s),{fileId:c,url:u}=await o;return{image_file_id:c||"",image_url:u||"",blurhash_encode:l}};function OB(t,e){let n=[],r=0,s=0;for(;r<t.length&&s<e.length;)t[r].first_letter<=e[s].first_letter?(n.push(t[r]),r++):(n.push(e[s]),s++);for(;r<t.length;)n.push(t[r]),r++;for(;s<e.length;)n.push(e[s]),s++;return n}function $B(t){if(t.length===0)return[];let e=t[0];for(let n=1;n<t.length;n++)e=OB(e,t[n]);return e}const zB=!0,fn=Mt(de,"Songs"),er=Mt(de,"Playlists"),Xo=Mt(de,"Singers");Mt(de,"Users");Mt(de,"Lyrics");const Yo=Mt(de,"Comments");Mt(de,"DailySong");Mt(de,"DailySong");const BB=Mt(de,"Genres");Mt(de,"Trending_Songs");Mt(de,"Categories");const qw=async({collectionName:t,id:e,msg:n})=>{console.log(n??">>> api: delete doc"),await w9(gt(de,t,e))},en=async({collectionName:t,id:e,msg:n})=>(console.log(n??">>> api: get doc"),Tc(gt(de,t,e))),ai=async({collectionName:t,data:e,msg:n})=>(console.log(n??">>> api: add doc"),await _9(Mt(de,t),e)),Re=async({collectionName:t,id:e,data:n,msg:r})=>(console.log(r??">>> api: update doc"),await v9(gt(de,t,e),n)),gh=async({file:t,msg:e,folder:n})=>{var v;console.log(e??">>> api: upload file");const r=Date.now(),s=await((v=Ga.currentUser)==null?void 0:v.getIdToken(!0)),i=await Xr.get("/storage/auth",{headers:{Authorization:`Bearer ${s}`}}),{expire:o,token:l,signature:c,publicKey:u}=i.data.data,d=t.name.split("."),f=d.pop(),p=d.join("_"),{url:g="",fileId:x=""}=await PB({expire:o,token:l,signature:c,publicKey:u,file:t,fileName:Un(p)+"."+f,folder:`/hd-mp3${n}`}),w=(Date.now()-r)/1e3;return console.log(">>> api: upload file finished after",w),{url:g,fileId:x}},Vt=async({fileId:t,msg:e})=>{var n;try{zB&&console.log(e??">>> api: delete file");const r=await((n=Ga.currentUser)==null?void 0:n.getIdToken(!0));if(!r)return;await Xr.delete(`/storage/${t}`,{headers:{Authorization:`Bearer ${r}`}})}catch(r){console.log(r)}},UR=async t=>{try{Vt({fileId:t.song_file_id,msg:">>> api: delete song file"}),t.beat_file_id&&Vt({fileId:t.beat_file_id,msg:">>> api: delete song's image file"}),t.image_file_id&&Vt({fileId:t.image_file_id,msg:">>> api: delete song's image file"})}catch(e){console.log(e)}},HR=t=>{try{const e={total_play:Ai(1),today_play:Ai(1),week_play:Ai(1),last_active:pt()};Re({id:t,collectionName:"Songs",data:e,msg:"Increase song play"})}catch(e){console.log(e)}};function Rr(t,e,n){const r=Un((n==null?void 0:n.trim())||""),s=r.charAt(0).toUpperCase()+r.slice(1);return r.split(" ").length>1?Ee(t,...e,ae("meta","array-contains-any",r.split(" "))):Ee(t,...e,ae("name",">=",s),ae("name","<=",s+""))}const GR=async(t,e)=>{if(!t.length)return[];const n=20,r=[];for(let i=0;i<t.length;i+=n)r.push(t.slice(i,i+n));const s=[];for(const i of r)if(i.length>0){const o=Ee(fn,ae(ci(),"in",i),dn("first_letter")),l=await Cn(o,{msg:"get playlist songs",getQueueId:()=>`${e}_${fl(4)}`});s.push(l)}return s.length===1?s[0]:$B(s)};function VB(){const[t,e]=h.useState(),[n,r]=h.useState([]),[s,i]=h.useState();return{imageFile:s,setImageFile:i,playlist:t,setPlaylist:e,updatePlaylistData:l=>{t&&e({...t,...l})},songs:n,setSongs:r}}const WR=h.createContext(null);function UB({children:t}){return a.jsx(WR.Provider,{value:VB(),children:t})}const _g=()=>{const t=h.useContext(WR);if(!t)throw new Error("PlaylistProvider not provided");return t},HB=6;function GB(){const[t,e]=h.useState([]),[n,r]=h.useState(!0),s=h.useRef(),i=h.useRef(!0);return{playlists:t,setPlaylists:e,shouldGetPlaylists:i,lastDoc:s,hasMore:n,setHasMore:r,PAGE_SIZE:HB}}const qR=h.createContext(null);function WB({children:t}){return a.jsx(qR.Provider,{value:GB(),children:t})}const xh=()=>{const t=h.useContext(qR);if(!t)throw new Error("PlaylistProvider not provided");return t},Kw=(t,e)=>{const{color:n="var(--primary-cl)",baseColor:r="var(--a-10-cl)"}=e||{};return`linear-gradient(to right, ${n} ${t}%, ${r} ${t}%, ${r}`};function bg({audioEle:t,baseColor:e,color:n,setStatusFromParent:r,statusFromParent:s,statusRefFromParent:i}){const[o,l]=h.useState("paused"),[c,u]=h.useState(!1),d=s||o,f=r||l,p=h.useRef(d),g=h.useRef(null),x=h.useRef(null),w=h.useRef(null),v=i||p,_=()=>{try{t.play(),u(!0)}catch{}},b=()=>{t==null||t.pause(),R()},j=()=>{d==="playing"?b():d==="paused"&&_()},T=()=>{f("playing")},R=()=>{f("paused")},M=()=>{f("paused"),w.current&&(w.current.innerText=Ic(t.duration))},k=ee=>{if(!t)return;const _e=+(ee||t.currentTime/t.duration*100).toFixed(1);x.current&&(x.current.innerText=Ic(t.currentTime)),g!=null&&g.current&&(g.current.style.background=Kw(_e,{color:n,baseColor:e}))},E=()=>{const _e=t.currentTime/(t.duration/100);k(+_e.toFixed(1))},I=()=>{console.log("error"),f("error")},C=ee=>{const _e=ee.target;if(g!=null&&g.current){const He=_e.getBoundingClientRect(),B=(ee.clientX-He.left)/g.current.offsetWidth,K=Math.round(B*t.duration);A(K)}},A=ee=>{t.currentTime=ee,k(),d!=="playing"&&_()},D=ee=>{t.currentTime=t.currentTime+ee},P=ee=>{t.currentTime=t.currentTime-ee};return h.useEffect(()=>{if(t)return t.addEventListener("error",I),t.addEventListener("pause",R),t.addEventListener("playing",T),t.addEventListener("loadedmetadata",M),g!=null&&g.current&&(g==null||g.current.addEventListener("click",C),t.addEventListener("timeupdate",E)),()=>{t.removeEventListener("error",I),t.removeEventListener("pause",R),t.removeEventListener("playing",T),t.removeEventListener("loadedmetadata",M),g!=null&&g.current&&(t.removeEventListener("timeupdate",E),g==null||g.current.removeEventListener("click",C))}},[t]),h.useEffect(()=>{v.current=d},[d]),{play:_,pause:b,seek:A,handlePlayPause:j,status:d,forward:D,backward:P,isClickPlay:c,statusRef:p,progressLineRef:g,currentTimeRef:x,durationRef:w}}function np(t,e){const[n,r]=h.useState(e),s=h.useRef(!1);return h.useEffect(()=>{const i=un()[t]||e;r(i)},[]),h.useEffect(()=>{if(!s.current){s.current=!0;return}ot(t,n)},[n]),[n,r]}function yn(t){return`Minified Redux error #${t}; visit https://redux.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var qB=(()=>typeof Symbol=="function"&&Symbol.observable||"@@observable")(),MS=qB,sx=()=>Math.random().toString(36).substring(7).split("").join("."),KB={INIT:`@@redux/INIT${sx()}`,REPLACE:`@@redux/REPLACE${sx()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${sx()}`},rp=KB;function Qw(t){if(typeof t!="object"||t===null)return!1;let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e||Object.getPrototypeOf(t)===null}function KR(t,e,n){if(typeof t!="function")throw new Error(yn(2));if(typeof e=="function"&&typeof n=="function"||typeof n=="function"&&typeof arguments[3]=="function")throw new Error(yn(0));if(typeof e=="function"&&typeof n>"u"&&(n=e,e=void 0),typeof n<"u"){if(typeof n!="function")throw new Error(yn(1));return n(KR)(t,e)}let r=t,s=e,i=new Map,o=i,l=0,c=!1;function u(){o===i&&(o=new Map,i.forEach((v,_)=>{o.set(_,v)}))}function d(){if(c)throw new Error(yn(3));return s}function f(v){if(typeof v!="function")throw new Error(yn(4));if(c)throw new Error(yn(5));let _=!0;u();const b=l++;return o.set(b,v),function(){if(_){if(c)throw new Error(yn(6));_=!1,u(),o.delete(b),i=null}}}function p(v){if(!Qw(v))throw new Error(yn(7));if(typeof v.type>"u")throw new Error(yn(8));if(typeof v.type!="string")throw new Error(yn(17));if(c)throw new Error(yn(9));try{c=!0,s=r(s,v)}finally{c=!1}return(i=o).forEach(b=>{b()}),v}function g(v){if(typeof v!="function")throw new Error(yn(10));r=v,p({type:rp.REPLACE})}function x(){const v=f;return{subscribe(_){if(typeof _!="object"||_===null)throw new Error(yn(11));function b(){const T=_;T.next&&T.next(d())}return b(),{unsubscribe:v(b)}},[MS](){return this}}}return p({type:rp.INIT}),{dispatch:p,subscribe:f,getState:d,replaceReducer:g,[MS]:x}}function QB(t){Object.keys(t).forEach(e=>{const n=t[e];if(typeof n(void 0,{type:rp.INIT})>"u")throw new Error(yn(12));if(typeof n(void 0,{type:rp.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(yn(13))})}function XB(t){const e=Object.keys(t),n={};for(let i=0;i<e.length;i++){const o=e[i];typeof t[o]=="function"&&(n[o]=t[o])}const r=Object.keys(n);let s;try{QB(n)}catch(i){s=i}return function(o={},l){if(s)throw s;let c=!1;const u={};for(let d=0;d<r.length;d++){const f=r[d],p=n[f],g=o[f],x=p(g,l);if(typeof x>"u")throw l&&l.type,new Error(yn(14));u[f]=x,c=c||x!==g}return c=c||r.length!==Object.keys(o).length,c?u:o}}function sp(...t){return t.length===0?e=>e:t.length===1?t[0]:t.reduce((e,n)=>(...r)=>e(n(...r)))}function YB(...t){return e=>(n,r)=>{const s=e(n,r);let i=()=>{throw new Error(yn(15))};const o={getState:s.getState,dispatch:(c,...u)=>i(c,...u)},l=t.map(c=>c(o));return i=sp(...l)(s.dispatch),{...s,dispatch:i}}}function JB(t){return Qw(t)&&"type"in t&&typeof t.type=="string"}var QR=Symbol.for("immer-nothing"),DS=Symbol.for("immer-draftable"),$r=Symbol.for("immer-state");function js(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var Rc=Object.getPrototypeOf;function Jo(t){return!!t&&!!t[$r]}function Hi(t){var e;return t?XR(t)||Array.isArray(t)||!!t[DS]||!!((e=t.constructor)!=null&&e[DS])||Eg(t)||jg(t):!1}var ZB=Object.prototype.constructor.toString();function XR(t){if(!t||typeof t!="object")return!1;const e=Rc(t);if(e===null)return!0;const n=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return n===Object?!0:typeof n=="function"&&Function.toString.call(n)===ZB}function ip(t,e){Sg(t)===0?Reflect.ownKeys(t).forEach(n=>{e(n,t[n],t)}):t.forEach((n,r)=>e(r,n,t))}function Sg(t){const e=t[$r];return e?e.type_:Array.isArray(t)?1:Eg(t)?2:jg(t)?3:0}function iv(t,e){return Sg(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function YR(t,e,n){const r=Sg(t);r===2?t.set(e,n):r===3?t.add(n):t[e]=n}function eV(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}function Eg(t){return t instanceof Map}function jg(t){return t instanceof Set}function ko(t){return t.copy_||t.base_}function av(t,e){if(Eg(t))return new Map(t);if(jg(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const n=XR(t);if(e===!0||e==="class_only"&&!n){const r=Object.getOwnPropertyDescriptors(t);delete r[$r];let s=Reflect.ownKeys(r);for(let i=0;i<s.length;i++){const o=s[i],l=r[o];l.writable===!1&&(l.writable=!0,l.configurable=!0),(l.get||l.set)&&(r[o]={configurable:!0,writable:!0,enumerable:l.enumerable,value:t[o]})}return Object.create(Rc(t),r)}else{const r=Rc(t);if(r!==null&&n)return{...t};const s=Object.create(r);return Object.assign(s,t)}}function Xw(t,e=!1){return kg(t)||Jo(t)||!Hi(t)||(Sg(t)>1&&(t.set=t.add=t.clear=t.delete=tV),Object.freeze(t),e&&Object.entries(t).forEach(([n,r])=>Xw(r,!0))),t}function tV(){js(2)}function kg(t){return Object.isFrozen(t)}var nV={};function Zo(t){const e=nV[t];return e||js(0,t),e}var Dd;function JR(){return Dd}function rV(t,e){return{drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function LS(t,e){e&&(Zo("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function ov(t){lv(t),t.drafts_.forEach(sV),t.drafts_=null}function lv(t){t===Dd&&(Dd=t.parent_)}function OS(t){return Dd=rV(Dd,t)}function sV(t){const e=t[$r];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function $S(t,e){e.unfinalizedDrafts_=e.drafts_.length;const n=e.drafts_[0];return t!==void 0&&t!==n?(n[$r].modified_&&(ov(e),js(4)),Hi(t)&&(t=ap(e,t),e.parent_||op(e,t)),e.patches_&&Zo("Patches").generateReplacementPatches_(n[$r].base_,t,e.patches_,e.inversePatches_)):t=ap(e,n,[]),ov(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==QR?t:void 0}function ap(t,e,n){if(kg(e))return e;const r=e[$r];if(!r)return ip(e,(s,i)=>zS(t,r,e,s,i,n)),e;if(r.scope_!==t)return e;if(!r.modified_)return op(t,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const s=r.copy_;let i=s,o=!1;r.type_===3&&(i=new Set(s),s.clear(),o=!0),ip(i,(l,c)=>zS(t,r,s,l,c,n,o)),op(t,s,!1),n&&t.patches_&&Zo("Patches").generatePatches_(r,n,t.patches_,t.inversePatches_)}return r.copy_}function zS(t,e,n,r,s,i,o){if(Jo(s)){const l=i&&e&&e.type_!==3&&!iv(e.assigned_,r)?i.concat(r):void 0,c=ap(t,s,l);if(YR(n,r,c),Jo(c))t.canAutoFreeze_=!1;else return}else o&&n.add(s);if(Hi(s)&&!kg(s)){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1)return;ap(t,s),(!e||!e.scope_.parent_)&&typeof r!="symbol"&&Object.prototype.propertyIsEnumerable.call(n,r)&&op(t,s)}}function op(t,e,n=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&Xw(e,n)}function iV(t,e){const n=Array.isArray(t),r={type_:n?1:0,scope_:e?e.scope_:JR(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let s=r,i=Yw;n&&(s=[r],i=Ld);const{revoke:o,proxy:l}=Proxy.revocable(s,i);return r.draft_=l,r.revoke_=o,l}var Yw={get(t,e){if(e===$r)return t;const n=ko(t);if(!iv(n,e))return aV(t,n,e);const r=n[e];return t.finalized_||!Hi(r)?r:r===ix(t.base_,e)?(ax(t),t.copy_[e]=uv(r,t)):r},has(t,e){return e in ko(t)},ownKeys(t){return Reflect.ownKeys(ko(t))},set(t,e,n){const r=ZR(ko(t),e);if(r!=null&&r.set)return r.set.call(t.draft_,n),!0;if(!t.modified_){const s=ix(ko(t),e),i=s==null?void 0:s[$r];if(i&&i.base_===n)return t.copy_[e]=n,t.assigned_[e]=!1,!0;if(eV(n,s)&&(n!==void 0||iv(t.base_,e)))return!0;ax(t),cv(t)}return t.copy_[e]===n&&(n!==void 0||e in t.copy_)||Number.isNaN(n)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=n,t.assigned_[e]=!0),!0},deleteProperty(t,e){return ix(t.base_,e)!==void 0||e in t.base_?(t.assigned_[e]=!1,ax(t),cv(t)):delete t.assigned_[e],t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const n=ko(t),r=Reflect.getOwnPropertyDescriptor(n,e);return r&&{writable:!0,configurable:t.type_!==1||e!=="length",enumerable:r.enumerable,value:n[e]}},defineProperty(){js(11)},getPrototypeOf(t){return Rc(t.base_)},setPrototypeOf(){js(12)}},Ld={};ip(Yw,(t,e)=>{Ld[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});Ld.deleteProperty=function(t,e){return Ld.set.call(this,t,e,void 0)};Ld.set=function(t,e,n){return Yw.set.call(this,t[0],e,n,t[0])};function ix(t,e){const n=t[$r];return(n?ko(n):t)[e]}function aV(t,e,n){var s;const r=ZR(e,n);return r?"value"in r?r.value:(s=r.get)==null?void 0:s.call(t.draft_):void 0}function ZR(t,e){if(!(e in t))return;let n=Rc(t);for(;n;){const r=Object.getOwnPropertyDescriptor(n,e);if(r)return r;n=Rc(n)}}function cv(t){t.modified_||(t.modified_=!0,t.parent_&&cv(t.parent_))}function ax(t){t.copy_||(t.copy_=av(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var oV=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,n,r)=>{if(typeof e=="function"&&typeof n!="function"){const i=n;n=e;const o=this;return function(c=i,...u){return o.produce(c,d=>n.call(this,d,...u))}}typeof n!="function"&&js(6),r!==void 0&&typeof r!="function"&&js(7);let s;if(Hi(e)){const i=OS(this),o=uv(e,void 0);let l=!0;try{s=n(o),l=!1}finally{l?ov(i):lv(i)}return LS(i,r),$S(s,i)}else if(!e||typeof e!="object"){if(s=n(e),s===void 0&&(s=e),s===QR&&(s=void 0),this.autoFreeze_&&Xw(s,!0),r){const i=[],o=[];Zo("Patches").generateReplacementPatches_(e,s,i,o),r(i,o)}return s}else js(1,e)},this.produceWithPatches=(e,n)=>{if(typeof e=="function")return(o,...l)=>this.produceWithPatches(o,c=>e(c,...l));let r,s;return[this.produce(e,n,(o,l)=>{r=o,s=l}),r,s]},typeof(t==null?void 0:t.autoFreeze)=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof(t==null?void 0:t.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy)}createDraft(t){Hi(t)||js(8),Jo(t)&&(t=lV(t));const e=OS(this),n=uv(t,void 0);return n[$r].isManual_=!0,lv(e),n}finishDraft(t,e){const n=t&&t[$r];(!n||!n.isManual_)&&js(9);const{scope_:r}=n;return LS(r,e),$S(void 0,r)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}applyPatches(t,e){let n;for(n=e.length-1;n>=0;n--){const s=e[n];if(s.path.length===0&&s.op==="replace"){t=s.value;break}}n>-1&&(e=e.slice(n+1));const r=Zo("Patches").applyPatches_;return Jo(t)?r(t,e):this.produce(t,s=>r(s,e))}};function uv(t,e){const n=Eg(t)?Zo("MapSet").proxyMap_(t,e):jg(t)?Zo("MapSet").proxySet_(t,e):iV(t,e);return(e?e.scope_:JR()).drafts_.push(n),n}function lV(t){return Jo(t)||js(10,t),e5(t)}function e5(t){if(!Hi(t)||kg(t))return t;const e=t[$r];let n;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,n=av(t,e.scope_.immer_.useStrictShallowCopy_)}else n=av(t,!0);return ip(n,(r,s)=>{YR(n,r,e5(s))}),e&&(e.finalized_=!1),n}var zr=new oV,t5=zr.produce;zr.produceWithPatches.bind(zr);zr.setAutoFreeze.bind(zr);zr.setUseStrictShallowCopy.bind(zr);zr.applyPatches.bind(zr);zr.createDraft.bind(zr);zr.finishDraft.bind(zr);function n5(t){return({dispatch:n,getState:r})=>s=>i=>typeof i=="function"?i(n,r,t):s(i)}var cV=n5(),uV=n5,dV=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?sp:sp.apply(null,arguments)};function BS(t,e){function n(...r){if(e){let s=e(...r);if(!s)throw new Error(Pi(0));return{type:t,payload:s.payload,..."meta"in s&&{meta:s.meta},..."error"in s&&{error:s.error}}}return{type:t,payload:r[0]}}return n.toString=()=>`${t}`,n.type=t,n.match=r=>JB(r)&&r.type===t,n}var r5=class Bu extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,Bu.prototype)}static get[Symbol.species](){return Bu}concat(...e){return super.concat.apply(this,e)}prepend(...e){return e.length===1&&Array.isArray(e[0])?new Bu(...e[0].concat(this)):new Bu(...e.concat(this))}};function VS(t){return Hi(t)?t5(t,()=>{}):t}function US(t,e,n){return t.has(e)?t.get(e):t.set(e,n(e)).get(e)}function hV(t){return typeof t=="boolean"}var fV=()=>function(e){const{thunk:n=!0,immutableCheck:r=!0,serializableCheck:s=!0,actionCreatorCheck:i=!0}=e??{};let o=new r5;return n&&(hV(n)?o.push(cV):o.push(uV(n.extraArgument))),o},mV="RTK_autoBatch",HS=t=>e=>{setTimeout(e,t)},pV=(t={type:"raf"})=>e=>(...n)=>{const r=e(...n);let s=!0,i=!1,o=!1;const l=new Set,c=t.type==="tick"?queueMicrotask:t.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:HS(10):t.type==="callback"?t.queueNotification:HS(t.timeout),u=()=>{o=!1,i&&(i=!1,l.forEach(d=>d()))};return Object.assign({},r,{subscribe(d){const f=()=>s&&d(),p=r.subscribe(f);return l.add(d),()=>{p(),l.delete(d)}},dispatch(d){var f;try{return s=!((f=d==null?void 0:d.meta)!=null&&f[mV]),i=!s,i&&(o||(o=!0,c(u))),r.dispatch(d)}finally{s=!0}}})},gV=t=>function(n){const{autoBatch:r=!0}=n??{};let s=new r5(t);return r&&s.push(pV(typeof r=="object"?r:void 0)),s};function xV(t){const e=fV(),{reducer:n=void 0,middleware:r,devTools:s=!0,preloadedState:i=void 0,enhancers:o=void 0}=t||{};let l;if(typeof n=="function")l=n;else if(Qw(n))l=XB(n);else throw new Error(Pi(1));let c;typeof r=="function"?c=r(e):c=e();let u=sp;s&&(u=dV({trace:!1,...typeof s=="object"&&s}));const d=YB(...c),f=gV(d);let p=typeof o=="function"?o(f):f();const g=u(...p);return KR(l,i,g)}function s5(t){const e={},n=[];let r;const s={addCase(i,o){const l=typeof i=="string"?i:i.type;if(!l)throw new Error(Pi(28));if(l in e)throw new Error(Pi(29));return e[l]=o,s},addMatcher(i,o){return n.push({matcher:i,reducer:o}),s},addDefaultCase(i){return r=i,s}};return t(s),[e,n,r]}function yV(t){return typeof t=="function"}function vV(t,e){let[n,r,s]=s5(e),i;if(yV(t))i=()=>VS(t());else{const l=VS(t);i=()=>l}function o(l=i(),c){let u=[n[c.type],...r.filter(({matcher:d})=>d(c)).map(({reducer:d})=>d)];return u.filter(d=>!!d).length===0&&(u=[s]),u.reduce((d,f)=>{if(f)if(Jo(d)){const g=f(d,c);return g===void 0?d:g}else{if(Hi(d))return t5(d,p=>f(p,c));{const p=f(d,c);if(p===void 0){if(d===null)return d;throw Error("A case reducer on a non-draftable value must not return undefined")}return p}}return d},l)}return o.getInitialState=i,o}var wV=Symbol.for("rtk-slice-createasyncthunk");function _V(t,e){return`${t}/${e}`}function bV({creators:t}={}){var n;const e=(n=t==null?void 0:t.asyncThunk)==null?void 0:n[wV];return function(s){const{name:i,reducerPath:o=i}=s;if(!i)throw new Error(Pi(11));typeof process<"u";const l=(typeof s.reducers=="function"?s.reducers(EV()):s.reducers)||{},c=Object.keys(l),u={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},d={addCase(j,T){const R=typeof j=="string"?j:j.type;if(!R)throw new Error(Pi(12));if(R in u.sliceCaseReducersByType)throw new Error(Pi(13));return u.sliceCaseReducersByType[R]=T,d},addMatcher(j,T){return u.sliceMatchers.push({matcher:j,reducer:T}),d},exposeAction(j,T){return u.actionCreators[j]=T,d},exposeCaseReducer(j,T){return u.sliceCaseReducersByName[j]=T,d}};c.forEach(j=>{const T=l[j],R={reducerName:j,type:_V(i,j),createNotation:typeof s.reducers=="function"};kV(T)?IV(R,T,d,e):jV(R,T,d)});function f(){const[j={},T=[],R=void 0]=typeof s.extraReducers=="function"?s5(s.extraReducers):[s.extraReducers],M={...j,...u.sliceCaseReducersByType};return vV(s.initialState,k=>{for(let E in M)k.addCase(E,M[E]);for(let E of u.sliceMatchers)k.addMatcher(E.matcher,E.reducer);for(let E of T)k.addMatcher(E.matcher,E.reducer);R&&k.addDefaultCase(R)})}const p=j=>j,g=new Map;let x;function w(j,T){return x||(x=f()),x(j,T)}function v(){return x||(x=f()),x.getInitialState()}function _(j,T=!1){function R(k){let E=k[j];return typeof E>"u"&&T&&(E=v()),E}function M(k=p){const E=US(g,T,()=>new WeakMap);return US(E,k,()=>{const I={};for(const[C,A]of Object.entries(s.selectors??{}))I[C]=SV(A,k,v,T);return I})}return{reducerPath:j,getSelectors:M,get selectors(){return M(R)},selectSlice:R}}const b={name:i,reducer:w,actions:u.actionCreators,caseReducers:u.sliceCaseReducersByName,getInitialState:v,..._(o),injectInto(j,{reducerPath:T,...R}={}){const M=T??o;return j.inject({reducerPath:M,reducer:w},R),{...b,..._(M,!0)}}};return b}}function SV(t,e,n,r){function s(i,...o){let l=e(i);return typeof l>"u"&&r&&(l=n()),t(l,...o)}return s.unwrapped=t,s}var Jw=bV();function EV(){function t(e,n){return{_reducerDefinitionType:"asyncThunk",payloadCreator:e,...n}}return t.withTypes=()=>t,{reducer(e){return Object.assign({[e.name](...n){return e(...n)}}[e.name],{_reducerDefinitionType:"reducer"})},preparedReducer(e,n){return{_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:n}},asyncThunk:t}}function jV({type:t,reducerName:e,createNotation:n},r,s){let i,o;if("reducer"in r){if(n&&!TV(r))throw new Error(Pi(17));i=r.reducer,o=r.prepare}else i=r;s.addCase(t,i).exposeCaseReducer(e,i).exposeAction(e,o?BS(t,o):BS(t))}function kV(t){return t._reducerDefinitionType==="asyncThunk"}function TV(t){return t._reducerDefinitionType==="reducerWithPrepare"}function IV({type:t,reducerName:e},n,r,s){if(!s)throw new Error(Pi(18));const{payloadCreator:i,fulfilled:o,pending:l,rejected:c,settled:u,options:d}=n,f=s(t,i,d);r.exposeAction(e,f),o&&r.addCase(f.fulfilled,o),l&&r.addCase(f.pending,l),c&&r.addCase(f.rejected,c),u&&r.addMatcher(f.settled,u),r.exposeCaseReducer(e,{fulfilled:o||kf,pending:l||kf,rejected:c||kf,settled:u||kf})}function kf(){}function Pi(t){return`Minified Redux Toolkit error #${t}; visit https://redux-toolkit.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}const CV=()=>({playStatus:"paused",isLoaded:!0,countDown:0}),i5=Jw({name:"playStatus",initialState:()=>CV(),reducers:{setPlayStatus(t,e){Object.assign(t,e.payload)}}}),lr=t=>t.playStatus,{setPlayStatus:wn}=i5.actions,RV=i5.reducer,GS={queueSongs:un().queue||[],currentQueueId:null,currentSongData:null,isFetching:!1};function ox(t){for(let e=0;e<t.queueSongs.length;e++){const n=t.queueSongs[e];if(n.queue_id===t.currentQueueId){t.currentSongData={song:n,index:e};return}}t.currentSongData=null}const a5=Jw({name:"songQueue",initialState:GS,reducers:{setQueue(t,e){const n=e.payload.songs;t.queueSongs=n,ox(t),ot("queue",n)},setCurrentQueueId(t,e){const n=e.payload;t.currentQueueId=n,ox(t)},removeSongFromQueue(t,e){const{index:n}=e.payload;t.queueSongs.splice(n,1),ot("queue",t.queueSongs),t.currentSongData&&n<=t.currentSongData.index&&ox(t)},setIsFetchingRecommend(t,e){t.isFetching=e.payload},addSongToQueue:(t,e)=>{const n=e.payload.songs;t.queueSongs.push(...n),t.isFetching=!1,ot("queue",t.queueSongs)},resetSongQueue:t=>{ot("queue",[]),Object.assign(t,{...GS,queueSongs:[]})}}}),rt=t=>t.songQueue,{addSongToQueue:yh,setCurrentQueueId:oi,removeSongFromQueue:NV,setQueue:AV,resetSongQueue:PV,setIsFetchingRecommend:FV}=a5.actions,MV=a5.reducer;var o5={exports:{}},l5={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vh=h;function DV(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var LV=typeof Object.is=="function"?Object.is:DV,OV=vh.useSyncExternalStore,$V=vh.useRef,zV=vh.useEffect,BV=vh.useMemo,VV=vh.useDebugValue;l5.useSyncExternalStoreWithSelector=function(t,e,n,r,s){var i=$V(null);if(i.current===null){var o={hasValue:!1,value:null};i.current=o}else o=i.current;i=BV(function(){function c(g){if(!u){if(u=!0,d=g,g=r(g),s!==void 0&&o.hasValue){var x=o.value;if(s(x,g))return f=x}return f=g}if(x=f,LV(d,g))return x;var w=r(g);return s!==void 0&&s(x,w)?(d=g,x):(d=g,f=w)}var u=!1,d,f,p=n===void 0?null:n;return[function(){return c(e())},p===null?void 0:function(){return c(p())}]},[e,n,r,s]);var l=OV(t,i[0],i[1]);return zV(function(){o.hasValue=!0,o.value=l},[l]),VV(l),l};o5.exports=l5;var UV=o5.exports;function HV(t){t()}function GV(){let t=null,e=null;return{clear(){t=null,e=null},notify(){HV(()=>{let n=t;for(;n;)n.callback(),n=n.next})},get(){const n=[];let r=t;for(;r;)n.push(r),r=r.next;return n},subscribe(n){let r=!0;const s=e={callback:n,next:null,prev:e};return s.prev?s.prev.next=s:t=s,function(){!r||t===null||(r=!1,s.next?s.next.prev=s.prev:e=s.prev,s.prev?s.prev.next=s.next:t=s.next)}}}}var WS={notify(){},get:()=>[]};function WV(t,e){let n,r=WS,s=0,i=!1;function o(w){d();const v=r.subscribe(w);let _=!1;return()=>{_||(_=!0,v(),f())}}function l(){r.notify()}function c(){x.onStateChange&&x.onStateChange()}function u(){return i}function d(){s++,n||(n=e?e.addNestedSub(c):t.subscribe(c),r=GV())}function f(){s--,n&&s===0&&(n(),n=void 0,r.clear(),r=WS)}function p(){i||(i=!0,d())}function g(){i&&(i=!1,f())}const x={addNestedSub:o,notifyNestedSubs:l,handleChangeWrapper:c,isSubscribed:u,trySubscribe:p,tryUnsubscribe:g,getListeners:()=>r};return x}var qV=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",KV=qV(),QV=()=>typeof navigator<"u"&&navigator.product==="ReactNative",XV=QV(),YV=()=>KV||XV?h.useLayoutEffect:h.useEffect,JV=YV(),lx=Symbol.for("react-redux-context"),cx=typeof globalThis<"u"?globalThis:{};function ZV(){if(!h.createContext)return{};const t=cx[lx]??(cx[lx]=new Map);let e=t.get(h.createContext);return e||(e=h.createContext(null),t.set(h.createContext,e)),e}var Wa=ZV();function eU(t){const{children:e,context:n,serverState:r,store:s}=t,i=h.useMemo(()=>{const c=WV(s);return{store:s,subscription:c,getServerState:r?()=>r:void 0}},[s,r]),o=h.useMemo(()=>s.getState(),[s]);JV(()=>{const{subscription:c}=i;return c.onStateChange=c.notifyNestedSubs,c.trySubscribe(),o!==s.getState()&&c.notifyNestedSubs(),()=>{c.tryUnsubscribe(),c.onStateChange=void 0}},[i,o]);const l=n||Wa;return h.createElement(l.Provider,{value:i},e)}var tU=eU;function Zw(t=Wa){return function(){return h.useContext(t)}}var c5=Zw();function u5(t=Wa){const e=t===Wa?c5:Zw(t),n=()=>{const{store:r}=e();return r};return Object.assign(n,{withTypes:()=>n}),n}var nU=u5();function rU(t=Wa){const e=t===Wa?nU:u5(t),n=()=>e().dispatch;return Object.assign(n,{withTypes:()=>n}),n}var mn=rU(),sU=(t,e)=>t===e;function iU(t=Wa){const e=t===Wa?c5:Zw(t),n=(r,s={})=>{const{equalityFn:i=sU}=typeof s=="function"?{equalityFn:s}:s,o=e(),{store:l,subscription:c,getServerState:u}=o;h.useRef(!0);const d=h.useCallback({[r.name](p){return r(p)}}[r.name],[r]),f=UV.useSyncExternalStoreWithSelector(c.addNestedSub,l.getState,u||l.getState,d,i);return h.useDebugValue(f),f};return Object.assign(n,{withTypes:()=>n}),n}var fe=iU();function os({variant:t}){const e=mn(),{currentQueueId:n,queueSongs:r,currentSongData:s}=fe(rt),i=h.useMemo(()=>{switch(t){default:return"queue_id"}},[]);return{handleSetSong:(l,c)=>{if(n!==l){e(oi(l)),e(wn({playStatus:"loading"}));const u=r.map(f=>f[i]);if(!r.length||r.length!==c.length||!!c.find(f=>!u.includes(f[i])))return console.log("set queue"),e(AV({songs:c})),!0}return!1},currentSongData:s,queueSongs:r,currentQueueId:n}}function d5(t,e){const[n,r]=h.useState(t);return h.useEffect(()=>{if(!t){r("");return}const s=setTimeout(()=>{r(t)},e);return()=>{clearTimeout(s)}},[t]),n}const e_={isDev:!1,focusDelay:3e3,scrollSongDelay:4e3,loadingDuration:200};function qS(t,e){const n=h.useRef(),[r,s]=h.useState(0),[i,o]=h.useState(0);return h.useEffect(()=>{r&&(n.current=setTimeout(()=>n.current=void 0,e))},[i,e_]),h.useEffect(()=>{n.current||(t(),o(Math.random()*10))},[r]),()=>s(Math.random()*10)}const ux={currentPlaylist:null,playlistSongs:[]},h5=Jw({name:"currentPlaylist",initialState:ux,reducers:{setCurrentPlaylist(t,e){const{playlist:n,songs:r}=e.payload;t.currentPlaylist=n,t.playlistSongs=r},updateCurrentPlaylist:(t,e)=>{if(!t.currentPlaylist)return t;Object.assign(t.currentPlaylist,e.payload)},addSongsToPlaylist(t,e){if(!t.currentPlaylist)return t;const n=e.payload.map(r=>({...r,song_in:`playlist_${t.currentPlaylist.id}`,queue_id:fl(4)}));t.playlistSongs.push(...n)},setPlaylistSong(t,e){t.playlistSongs=e.payload},removeSong(t,e){const{index:n}=e.payload;t.playlistSongs.splice(n,1)},resetCurrentPlaylist:t=>{t.currentPlaylist=ux.currentPlaylist,t.playlistSongs=ux.playlistSongs}}}),ui=t=>t.currentPlaylist,{addSongsToPlaylist:YZ,removeSong:JZ,setCurrentPlaylist:aU,updateCurrentPlaylist:oU,resetCurrentPlaylist:lU,setPlaylistSong:cU}=h5.actions,uU=h5.reducer;function dU(){const t=mn(),{setErrorToast:e}=ne(),{user:n,loading:r}=ye(),s=h.useRef(!1),i=Wi(),[o,l]=h.useState(!0),c=async()=>{if(!i.id)return;const d=await en({collectionName:"Playlists",id:i.id,msg:">>> api get playlist"});if(d.exists())return{...d.data(),id:d.id}},u=async()=>{try{if(!i.id)return;l(!0);const d=await c();if(!d||!(n?d.owner_email===n.email&&!d.is_official:!1)&&!d.is_public)return;const p=await GR(d.song_ids,d.id);t(aU({playlist:d,songs:p}))}catch(d){console.log({message:d}),e()}finally{l(!1)}};return h.useEffect(()=>{if(!r)return s.current||(s.current=!0,u()),()=>{t(lU())}},[r]),{isFetching:o}}function f5({setLoadingFromParent:t}){const[e,n]=h.useState(!1),r=t||n;return{getLyric:async i=>{try{if(!i.id)return;r(!0);const o=await en({collectionName:"Lyrics",id:i.lyric_id,msg:"useGetLyric, get lyric"});if(o.exists())return o.data()}catch(o){console.log({message:o})}finally{r(!1)}},loading:e}}function m5(){const t=mn(),{setSuccessToast:e}=ne();return{action:r=>{switch(r.variant){case"add":const s=r.songs.map(i=>({...i,queue_id:fl(4)}));t(yh({songs:s})),e("Song added to queue");break;case"remove":t(NV({index:r.index}))}}}}function Tg(t){const{setOwnPlaylists:e}=yt(),{setErrorToast:n}=ne(),[r,s]=h.useState(!1),i=(t==null?void 0:t.setIsFetching)||s;return{isFetching:r,addPlaylist:async({imageFile:l,...c},u)=>{var d,f;try{if(i(!0),l){c.playlist.image_file_id&&Vt({fileId:c.playlist.image_file_id});const p=await Yi({imageFile:l});Object.assign(c.playlist,p)}switch(c.variant){case"add":const p={...c.playlist,name:c.playlist.name.trim(),meta:Un(c.playlist.name.trim()).split(" ")},g=await ai({collectionName:"Playlists",data:p,msg:">>> Add playlist doc"}),x=await Tc(g),w={...x.data(),id:x.id},{push:v=!0}=u||{};return v&&e(_=>[..._,w]),w;case"edit":{const _={...c.playlist,name:(d=c.playlist.name)==null?void 0:d.trim(),meta:Un(((f=c.playlist.name)==null?void 0:f.trim())||"").split(" "),updated_at:pt()};return await Re({collectionName:"Playlists",data:_,id:c.id,msg:">>> Update playlist doc"}),!0}}}catch(p){console.log(p),n()}finally{i(!1)}}}}function Ig(t){const{setIsFetchingFromParent:e}=t||{},[n,r]=h.useState(!0),{setErrorToast:s}=ne(),i=e||r;return{fetchComment:async({target_id:l,comment_id:c})=>{try{i(!0);const u=l?Ee(Yo,ae("target_id","==",l),ae("comment_id","==",""),dn("created_at","desc")):Ee(Yo,ae("comment_id","==",c),dn("created_at","desc")),d=await tn(u);if(d.docs.length)return d.docs.map(p=>({...p.data(),id:p.id,replies:[]}))}catch(u){console.log(u),s()}finally{i(!1)}},isFetching:n}}function hU({audioEle:t}){const e=Wn(),n=h.useMemo(()=>e.pathname.includes("lyric")||e.pathname==="/",[e]);return h.useEffect(()=>{n&&t.pause()},[e]),{shouldHide:n}}function p5({setCategory:t}){const[e,n]=h.useState(!0),r=h.useRef(!1),{id:s}=Wi(),i=async()=>{try{if(!s)return;n(!0);const o=await en({collectionName:"Categories",id:s});if(o.exists()){const l={...o.data(),id:s};t(l)}}catch(o){console.log(o)}finally{n(!1)}};return h.useEffect(()=>{r.current||(r.current=!0,i())},[]),{isFetching:e}}function g5({setSongs:t,songIds:e}){const[n,r]=h.useState(!1),s=h.useRef(!1),i=async()=>{try{if(!e.length)return;r(!0);const o=Ee(Mt(de,"Songs"),ae(ci(),"in",e)),l=await Cn(o);t(l)}catch(o){console.log(o)}finally{r(!1)}};return h.useEffect(()=>{s.current||(s.current=!0,i())},[]),{isFetching:n}}function t_({setPlaylists:t,playlistIds:e}){const[n,r]=h.useState(!0),s=h.useRef(!1),i=async()=>{try{if(!e.length)return;r(!0);const o=Ee(Mt(de,"Playlists"),ae(ci(),"in",e)),l=await wr(o);t(l)}catch(o){console.log(o)}finally{r(!1)}};return h.useEffect(()=>{s.current||(s.current=!0,i())},[]),{isFetching:n}}function n_(t){const[e,n]=h.useState(),r=(t==null?void 0:t.setImageFileFromParent)||n,s=async i=>{var o,l,c;try{const u=(o=i.clipboardData)==null?void 0:o.files;if(!(u!=null&&u.length))return;r(u[0]),(c=(l=t==null?void 0:t.modalRef)==null?void 0:l.current)==null||c.close()}catch(u){console.log(u)}};return h.useEffect(()=>(window.addEventListener("paste",s),()=>{window.removeEventListener("paste",s)}),[]),{imageFile:e,setImageFile:n}}function Cg(){const{setErrorToast:t,setSuccessToast:e}=ne(),{shouldGetPlaylists:n,lastDoc:r}=xh(),{playlist:s,songs:i,setSongs:o,updatePlaylistData:l}=_g(),[c,u]=h.useState(!1),d=Gt(),{addPlaylist:f,isFetching:p}=Tg(),g=async(w,v)=>{const _={};w.forEach(j=>_[j.id]=!0);const b={singers:w,singer_map:_};await Re({collectionName:"Playlists",id:v,data:b}),l(b)};return{isFetching:c,action:async w=>{try{if(!s)throw new Error("playlist not found");switch(u(!0),w.variant){case"delete-playlist":{const v=Ls(de),_=gt(de,"Playlists",s.id),b=await tn(Ee(Yo,ae("target_id","==",s.id)));v.delete(_),b.empty||(console.log(`Delete ${b.docs.length} comments`),b.forEach(j=>v.delete(j.ref))),await Promise.all([v.commit(),s.image_file_id?Vt({fileId:s.image_file_id}):()=>{}]),n.current=!0,r.current=void 0,e("Delete playlsit sucessful"),d("/dashboard/playlist");break}case"add-songs":{const v=[...i,...w.songs],b={song_ids:v.map(j=>j.id),updated_at:pt()};await Re({collectionName:"Playlists",id:s.id,data:b,msg:">>> api: update playlist doc"}),l(b),o(v),e("Songs added");break}case"edit-playlist":{await f({variant:"edit",id:s.id,playlist:w.playlist,imageFile:w.imageFile});const v={...s,...w.playlist};l(v),n.current=!0,r.current=void 0,e("Playlist edited");break}case"remove-song":{const v=i.filter(b=>b.id!==w.song.id),_={song_ids:v.map(b=>b.id),updated_at:pt()};await Re({collectionName:"Playlists",id:s.id,data:_,msg:">>> api: update playlist doc"}),o(v),e(`'${w.song.name}' removed`);break}case"update-image":{const v={image_url:w.song.image_url,blurhash_encode:w.song.blurhash_encode,image_file_id:""};s.image_file_id&&Vt({fileId:s.image_file_id}),await Re({collectionName:"Playlists",data:v,id:s.id,msg:">>> api: set playlist doc"}),l(v),e("Playlist edited");break}case"remove-singer":{const v=s.singers.filter(_=>_.id!==w.singer.id);g(v,s.id),e("Singer removed");break}case"add-singer":{const v=[...s.singers];if(v.find(b=>b.id===w.singer.id))return;v.push(w.singer),g(v,s.id),e("Singer added");break}}}catch(v){console.log({message:v}),t("")}finally{u(!1)}},playlist:s,addPlaylistFetching:p}}function fU({song:t}){const{action:e,isFetching:n,playlist:r}=Cg(),s=h.useRef(null),i={overlay:"absolute flex items-center justify-center inset-0 bg-black/40"},o=()=>{var c;(c=s.current)==null||c.open()},l=async c=>{var u;switch(c.variant){case"remove-song":await e({variant:"remove-song",song:c.song});break;case"update-image":await e({variant:"update-image",song:c.song});break;case"add-singer":await e({variant:"add-singer",singer:c.singer}),(u=s.current)==null||u.close()}};return a.jsxs(a.Fragment,{children:[a.jsxs(y5,{song:t,children:[a.jsxs("button",{onClick:()=>l({variant:"remove-song",song:t}),children:[a.jsx(xt,{className:"w-5"}),a.jsx("span",{children:"Remove"})]}),a.jsxs("button",{onClick:o,children:[a.jsx(Wt,{className:"w-5"}),a.jsx("span",{children:"Add singer to playlist"})]}),t.image_url&&a.jsxs("button",{className:`${(r==null?void 0:r.image_url)===t.image_url?"disable":""}`,onClick:()=>l({variant:"update-image",song:t}),children:[a.jsx(Ki,{className:"w-5"}),a.jsx("span",{children:"Set playlist image"})]}),n&&a.jsx("div",{className:i.overlay,children:a.jsx("div",{className:"h-[25px] w-[25px] border-[2px] border-r-black rounded-[50%] animate-spin"})})]}),a.jsx(Mw,{ref:s,children:a.jsxs(je,{children:[a.jsx(oe,{title:"Singers"}),a.jsx("div",{className:"space-x-2 mt-3 [&>*]:px-3 [&>*]:py-1 [&>*]:rounded-md  [&>*]:bg-[#f1f1f1] hover:[&>*]:bg-black/10",children:t.singers.map((c,u)=>a.jsx("button",{onClick:()=>l({variant:"add-singer",singer:c}),children:c.name},u))})]})})]})}const mU=a.jsxs("svg",{width:"100%",viewBox:"0 0 15 15",version:"1.1",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",children:[a.jsx("g",{strokeWidth:"0"}),a.jsx("g",{strokeLinecap:"round",strokeLinejoin:"round"}),a.jsx("g",{children:a.jsx("path",{d:`M7.5385,2
	C7.2437,2,7.0502,2.1772,6.9231,2.3846l-5.8462,9.5385C1,12,1,12.1538,1,12.3077C1,12.8462,1.3846,13,1.6923,13h11.6154
	C13.6923,13,14,12.8462,14,12.3077c0-0.1538,0-0.2308-0.0769-0.3846L8.1538,2.3846C8.028,2.1765,7.7882,2,7.5385,2z`})})]}),Rg=a.jsxs("svg",{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",width:"100%",children:[a.jsx("g",{strokeWidth:"0"}),a.jsx("g",{strokeLinecap:"round",strokeLinejoin:"round"}),a.jsx("g",{children:a.jsxs("g",{fill:"currentColor",children:[a.jsx("rect",{width:"4",height:"4",x:"3",y:"10",rx:"2"}),a.jsx("rect",{width:"4",height:"4",x:"10",y:"10",rx:"2"}),a.jsx("rect",{width:"4",height:"4",x:"17",y:"10",rx:"2"})]})})]}),Ng=a.jsxs("svg",{width:"100%",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("g",{strokeWidth:"0"}),a.jsx("g",{strokeLinecap:"round",strokeLinejoin:"round"}),a.jsxs("g",{children:[a.jsx("path",{d:"M19 16V19M19 19V22M19 19H22M19 19H16",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5"}),a.jsx("path",{d:"M20 9V8.82843C20 8.29799 19.7893 7.78929 19.4142 7.41421L15.5858 3.58579C15.2107 3.21071 14.702 3 14.1716 3H14M20 9H16C14.8954 9 14 8.10457 14 7V3M20 9V12M14 3H6C4.89543 3 4 3.89543 4 5V19C4 20.1046 4.89543 21 6 21H12",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5"})]})]}),pU=a.jsx("svg",{width:"100%",fill:"currentColor",viewBox:"0 0 40 40","aria-hidden":"true",children:a.jsx("path",{d:"M20 13.328c-1.14 0-2.203.266-3.172.813a6.699 6.699 0 0 0-2.406 2.171 6.645 6.645 0 0 0-1.094 3.094.545.545 0 0 1-.187.438.641.641 0 0 1-.454.156c-.171 0-.328-.078-.468-.219a.588.588 0 0 1-.172-.531 7.44 7.44 0 0 1 1.547-4.047c.937-1.219 2.094-2.094 3.5-2.64 1.406-.547 2.843-.704 4.312-.422a7.881 7.881 0 0 1 3.922 1.89v-1.39c0-.172.063-.329.188-.454.125-.124.297-.187.515-.187.172 0 .328.063.453.188a.626.626 0 0 1 .188.453v2.765c0 .36-.125.656-.375.89-.25.235-.531.36-.86.392h-2.765a.563.563 0 0 1-.453-.204.727.727 0 0 1-.188-.484h-.062c0-.172.078-.328.218-.453a.699.699 0 0 1 .485-.188h2.078a7.187 7.187 0 0 0-2.188-1.5A6.542 6.542 0 0 0 20 13.33ZM27.313 20c.171 0 .328.078.468.219.14.14.203.312.172.531a7.44 7.44 0 0 1-1.547 4.047c-.937 1.219-2.093 2.094-3.5 2.64-1.406.547-2.843.704-4.312.422a7.881 7.881 0 0 1-3.922-1.89v1.343a.684.684 0 0 1-.188.5.626.626 0 0 1-.453.188h-.062a.626.626 0 0 1-.453-.188.684.684 0 0 1-.188-.5v-2.718c0-.36.125-.672.375-.907.25-.25.531-.359.86-.328h2.765c.188 0 .328.063.453.188a.997.997 0 0 1 .25.453h-.062a.626.626 0 0 1-.188.453.601.601 0 0 1-.453.188H15.25c.922.953 2.016 1.578 3.281 1.859 1.266.297 2.516.203 3.735-.234a6.396 6.396 0 0 0 3.015-2.22 6.903 6.903 0 0 0 1.39-3.452c0-.188.063-.328.188-.438a.641.641 0 0 1 .453-.156Z"})}),gU=a.jsx("svg",{width:"100%",fill:"currentColor",viewBox:"0 0 40 40","aria-hidden":"true",children:a.jsx("path",{d:"M18.14 23.047h3.297v-1.078h-3.296v1.078Zm1.063-.438h1.172v-5.968h-.64l-1.766.906.265 1.015 1.282-.64-.313-.422v5.11Zm7.469-2.015c0-.188.062-.328.187-.438a.641.641 0 0 1 .453-.156c.172 0 .329.078.47.219.14.14.202.312.171.531a7.968 7.968 0 0 1-1.094 3.36 8.293 8.293 0 0 1-2.437 2.562 7.51 7.51 0 0 1-3.297 1.25 8.142 8.142 0 0 1-3.531-.297 7.941 7.941 0 0 1-3.032-1.766 7.578 7.578 0 0 1-2-2.922 7.73 7.73 0 0 1-.53-3.5 7.785 7.785 0 0 1 1.015-3.359 7.488 7.488 0 0 1 2.39-2.61 7.883 7.883 0 0 1 3.282-1.327 7.81 7.81 0 0 1 3.5.203 8.499 8.499 0 0 1 3.11 1.687v-1.39c0-.172.062-.329.187-.454.125-.124.297-.187.515-.187.172 0 .328.063.453.188a.626.626 0 0 1 .188.453v2.765c0 .36-.125.656-.375.89-.25.235-.531.36-.86.392h-2.765a.563.563 0 0 1-.453-.204.727.727 0 0 1-.188-.484h-.062c0-.172.078-.344.218-.484a.65.65 0 0 1 .485-.204h2.078a6.61 6.61 0 0 0-2.516-1.578c-.953-.343-1.953-.453-2.984-.343a6.516 6.516 0 0 0-2.844.984 6.525 6.525 0 0 0-2.11 2.125 6.782 6.782 0 0 0-.968 2.828 6.64 6.64 0 0 0 .375 2.969c.36.953.906 1.797 1.625 2.5a6.455 6.455 0 0 0 2.531 1.547 6.713 6.713 0 0 0 3 .297 6.347 6.347 0 0 0 2.828-1.047 6.589 6.589 0 0 0 2.047-2.157 6.956 6.956 0 0 0 .938-2.843Z"})}),KS=a.jsx("svg",{viewBox:"0 0 40 40",width:"100%",fill:"currentColor",children:a.jsx("path",{d:"m17.281 12.64 6.344 4.688c.438.313.766.719 1.016 1.172.25.469.375.969.375 1.5s-.125 1.047-.375 1.516c-.25.484-.594.843-1.016 1.156l-6.344 4.687a3.31 3.31 0 0 1-1.718.61 3.155 3.155 0 0 1-1.782-.344c-.547-.281-1-.688-1.328-1.219-.344-.547-.453-1.125-.453-1.765v-9.282c0-.64.156-1.218.469-1.765a3.282 3.282 0 0 1 1.312-1.219 3.155 3.155 0 0 1 1.781-.344 3.31 3.31 0 0 1 1.72.61Zm8.735-.609c.53 0 1 .188 1.39.578.39.391.594.86.594 1.407v12c0 .53-.234 1-.61 1.406-.39.375-.843.578-1.374.578a1.947 1.947 0 0 1-1.407-.578c-.406-.406-.609-.875-.609-1.406v-12c0-.547.203-1.016.61-1.407.374-.39.859-.578 1.406-.578Z"})}),xU=a.jsx("svg",{viewBox:"0 0 40 40",width:"100%",fill:"currentColor",children:a.jsx("path",{d:"m25.438 20.86 2.187 2.187c.25.281.375.594.375.953 0 .36-.125.672-.375.953l-2.188 2.188c-.171.218-.39.297-.671.218-.266-.062-.422-.234-.5-.5-.063-.265 0-.5.218-.672l1.547-1.546a6.915 6.915 0 0 1-2.937-.532 7.48 7.48 0 0 1-2.453-1.656.66.66 0 0 1-.188-.422.662.662 0 0 1 .14-.484.75.75 0 0 1 .47-.235c.187-.015.343.016.484.125a6.794 6.794 0 0 0 2.047 1.422 5.6 5.6 0 0 0 2.437.453l-1.547-1.5c-.187-.171-.25-.406-.187-.671a.532.532 0 0 1 .469-.47c.28-.062.5 0 .672.188Zm-1.016-2.626.062-.047 1.547-1.546a6.627 6.627 0 0 0-2.562.593c-.64.282-1.297.72-1.969 1.328-.36.36-.906.954-1.656 1.813l-.063.047c-.703.86-1.281 1.484-1.703 1.875-.703.672-1.422 1.187-2.125 1.547-.89.453-1.86.718-2.89.797h-.376c-.25.03-.437-.047-.578-.266a.617.617 0 0 1-.03-.672.701.701 0 0 1 .562-.39h.265a5.887 5.887 0 0 0 3.14-1.125c.688-.422 1.47-1.157 2.36-2.188-.89-1-1.672-1.719-2.36-2.188a6.138 6.138 0 0 0-3.187-1.125l-.171-.046a.684.684 0 0 1-.5-.188A.626.626 0 0 1 12 16c0-.172.063-.344.188-.484.124-.141.296-.204.5-.204l.328.047c1.343.11 2.578.532 3.671 1.282.782.5 1.657 1.28 2.625 2.343.641-.75 1.204-1.328 1.704-1.75.703-.609 1.422-1.062 2.125-1.343.89-.36 1.859-.532 2.89-.532l-1.547-1.546c-.218-.172-.28-.407-.218-.672.078-.266.234-.422.5-.47.28-.062.5 0 .672.188l2.187 2.188c.14.14.25.312.328.531.063.203.078.453.016.719a1.214 1.214 0 0 1-.344.656l-2.188 2.188a.88.88 0 0 1-.484.187.544.544 0 0 1-.453-.156.713.713 0 0 1-.203-.453.671.671 0 0 1 .125-.485Z"})}),yU=()=>{const[t,e]=h.useState(!1),[n,r]=h.useState(!1),[s,i]=h.useState([]);return{isChecked:t,setIsChecked:e,isSelectAll:n,setIsSelectAll:r,setSelectedPlaylists:i,selectedPlaylists:s,selectAllPlaylist:u=>{e(!0),r(!0),i(u)},selectPlaylist:u=>{const d=[...s],f=d.findIndex(p=>p.id===u.id);f===-1?d.push(u):d.splice(f,1),e(!!d.length),i(d)},resetSelect:()=>{e(!1),r(!1),i([])}}},x5=h.createContext(null);function vU({children:t}){return a.jsx(x5.Provider,{value:yU(),children:t})}const wU=()=>{const t=h.useContext(x5);if(!t)throw new Error("PlaylistSelectProvider not provided");return t},_U=["Newest","Result"];function bU(){const{setErrorToast:t}=ne(),{playlists:e,setPlaylists:n,setHasMore:r,shouldGetPlaylists:s,PAGE_SIZE:i,lastDoc:o}=xh(),[l,c]=h.useState([]),[u,d]=h.useState(""),[f,p]=h.useState(""),[g,x]=h.useState(!1),[w,v]=h.useState("Newest"),_=async()=>{try{x(!0),r(R=>o.current&&!R?(o.current=void 0,!R):R);const j=Ee(er,ae("is_official","==",!0),ae("is_album","==",!1),dn("updated_at","desc"),kn(i)),T=await wr(j);n(T)}catch(j){console.log(j)}finally{x(!1)}},b=async j=>{try{j.preventDefault(),x(!0),v("Result");const T=Rr(er,[ae("is_official","==",!0)],u),R=await wr(T);c(R),p(u)}catch(T){console.log({message:T}),t()}finally{x(!1)}};return h.useEffect(()=>{s.current&&(s.current=!1,_())},[]),{isFetching:g,value:u,playlists:e,result:l,setValue:d,lastSubmit:f,handleSubmit:b,getNewestPlaylists:_,tabs:_U,tab:w,setTab:v}}const dv=t=>({name:"",first_letter:"",meta:[],image_url:"",song_url:"",beat_url:"",beat_file_id:"",duration:0,like:0,comment:0,lyric_id:"",image_file_id:"",song_file_id:"",blurhash_encode:"",singer_map:{},genre_ids:[],genres:[],singers:[],is_official:!1,size:0,today_play:0,week_play:0,last_week_rank:0,rank:0,total_play:0,release_year:new Date().getFullYear(),last_active:pt(),created_at:pt(),updated_at:pt(),...t}),hv=t=>({name:"",meta:[],song_ids:[],image_url:"",singers:[],singer_map:{},is_album:!1,like:0,comment:0,blurhash_encode:"",is_public:!0,is_official:!1,image_file_id:"",created_at:pt(),updated_at:pt(),...t}),SU=({owner_email:t,distributor:e,...n})=>hv({owner_email:t,is_album:!0,is_official:!0,is_public:!0,distributor:e,...n}),fv=t=>({name:"",meta:[],description:"",image_file_id:"",image_url:"",like:0,created_at:pt(),blurhash_encode:"",...t}),QS=({start:t,end:e,text:n})=>{const r=n.trim().split(" "),s=r.map(()=>[]),i=r.map(()=>0);return{start:t,end:e,tune:{start:t,end:e,grow:i},cut:s,text:n}},XS=({user:t,target_id:e,...n})=>({target_id:e,text:"",like:0,reply:0,comment_id:"",user_email:t.email,user_image_url:t.photo_url,user_name:t.display_name,created_at:pt(),updated_at:pt(),...n}),YS=t=>({banner_file_id:"",banner_image_url:"",image_file_id:"",image_url:"",name:"",banner_blurhash_encode:"",blurhash_encode:"",playlist_ids:"",song_ids:"",created_at:pt(),updated_at:pt(),...t}),EU=(t="")=>({name:t,show:!0,target_ids:""});function jU(t){const[e,n]=h.useState(),[r,s]=h.useState(),i=h.useRef(null),o=f=>{e&&n({...e,...f})},l=h.useMemo(()=>t.variant==="add"?!0:!t.playlist||!e?!1:e.name!==t.playlist.name||e.like!==t.playlist.like||e.is_public!==t.playlist.is_public,[e]),c=!!r,u=h.useMemo(()=>{const f=!!(e!=null&&e.name)&&l;return t.variant==="add"?f:f||c},[c,l,e]),d=()=>{switch(t.variant){case"add":return hv({distributor:t.user.display_name,owner_email:t.user.email,name:t.name});case"edit":const{id:f,updated_at:p,...g}=t.playlist;return hv(g)}};return h.useEffect(()=>{var f,p;t.variant==="add"&&((f=i.current)==null||f.focus(),(p=t.modalRef.current)==null||p.setModalPersist(!0)),n(d())},[]),h.useEffect(()=>{var f;(l||c)&&((f=t.modalRef.current)==null||f.setModalPersist(!0))},[e,r]),h.useEffect(()=>{r&&o({image_url:URL.createObjectURL(r)})},[r]),{playlistData:e,imageFile:r,setImageFile:s,updatePlaylistData:o,setPlaylistData:n,inputRef:i,isValidToSubmit:u,isChanged:l,isChangeImage:c}}function Zc({isLoading:t,submit:e,...n}){const{imageFile:r,setImageFile:s,playlistData:i,updatePlaylistData:o,isChanged:l,isChangeImage:c,inputRef:u,isValidToSubmit:d}=jU(n),f=h.useRef(null),p=async()=>{i&&(!l&&!c||e(i,r))};return i?a.jsxs(a.Fragment,{children:[a.jsx(qe,{closeModal:()=>{var g;return(g=n.modalRef.current)==null?void 0:g.close()},title:n.variant==="add"?"Add playlist":"Edit playlist"}),a.jsxs("div",{className:"md:flex md:space-x-3 overflow-auto",children:[a.jsxs("div",{className:"space-y-2.5",children:[a.jsx("div",{className:"w-[200px] h-[200px] rounded-lg overflow-hidden",children:a.jsx(De,{className:"object-cover object-center h-full",blurHashEncode:i.blurhash_encode,src:i.image_url})}),a.jsx("p",{className:"",children:a.jsxs(ce,{onClick:()=>{var g;return(g=f.current)==null?void 0:g.open()},color:"primary",children:[a.jsx(Ki,{className:"w-5"}),a.jsx("span",{children:"Change image"})]})})]}),a.jsxs("div",{className:"mt-3 md:mt-0 flex-grow flex flex-col space-y-2.5",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(kt,{htmlFor:"name",children:"Name"}),a.jsx(En,{id:"name",ref:u,type:"text",placeholder:"name...",value:i.name||"",onChange:g=>o({name:g.target.value})})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(kt,{children:"Public"}),a.jsx(Ql,{inActiveBg:"bg-black/10",active:i.is_public,cb:()=>o({is_public:!i.is_public})})]})]})]}),a.jsx("p",{className:"text-right mt-5 md:mt-0",children:a.jsx(ce,{color:"primary",onClick:p,disabled:!d||t,className:"font-playwriteCU rounded-full",children:"Save"})}),t&&a.jsx(ea,{}),a.jsx(ie,{variant:"animation",ref:f,children:a.jsx(ml,{modalRef:f,setImageFile:s,title:"Playlist image"})})]}):a.jsx(a.Fragment,{})}function kU({closeModal:t,submit:e,isLoading:n,current:r}){const{user:s}=ye(),i=h.useRef(null),{playlists:o,isFetching:l,getNewestPlaylists:c,result:u,lastSubmit:d,tabs:f,setTab:p,tab:g,...x}=bU(),{selectedPlaylists:w,selectPlaylist:v}=wU(),{addPlaylist:_,isFetching:b}=Tg(),j=async()=>{w.length&&(e(w),t())},T=async(E,I)=>{var A;E.is_official=!0;const C=await _({variant:"add",playlist:E,imageFile:I},{push:!1});C&&e([C]),(A=i.current)==null||A.close(),t()},R=h.useMemo(()=>{const E=w.map(I=>I.id);return u.filter(I=>!E.includes(I.id))},[u,w]),M={col:"md:w-1/2 flex-1 flex flex-col px-2 overflow-hidden",box:"rounded-lg bg-black/5 p-2",boxItem:"w-full px-3 py-1.5 text-left hover:bg-[--a-5-cl] rounded-md text-sm"},k=E=>E.length?E.map((I,C)=>{const A=r.includes(I.id);return a.jsx("button",{onClick:()=>!A&&v(I),className:`${M.boxItem} ${A||w.includes(I)?"text-[--primary-cl]":""} `,children:I.name},C)}):a.jsx(Fe,{variant:"less"});return a.jsxs(a.Fragment,{children:[a.jsxs(je,{className:"w-[600px] h-[500px]",children:[a.jsx(qe,{closeModal:t,title:"Add playlists"}),a.jsx(Ji,{className:"w-fit",...x}),a.jsxs("div",{className:"flex-grow flex flex-col md:flex-row -mx-2 overflow-hidden mt-3",children:[a.jsxs("div",{className:`${M.col}`,children:[a.jsx(Ur,{className:"w-fit mb-1",buttonClasses:"[&_button]:px-3 [&_button]:py-1/2",tabs:f,setTab:p,disable:g==="Newest",tab:g,render:E=>E}),a.jsxs("div",{className:`${M.box} relative flex-grow overflow-auto`,children:[l?a.jsx(Rn,{className:"h-full"}):a.jsx(a.Fragment,{children:g==="Result"?k(R):a.jsxs(a.Fragment,{children:[k(o),a.jsx("p",{className:"mt-3 text-center",children:a.jsx(J,{onClick:c,size:"clear",className:"p-1",children:a.jsx(Me,{className:"w-5"})})})]})}),!l&&d&&x.value==d&&!R.length&&a.jsx("p",{className:"mt-3 text-center",children:a.jsxs(J,{onClick:()=>{var E;return(E=i.current)==null?void 0:E.open()},children:[a.jsx(Wt,{className:"w-6"}),a.jsx("span",{children:"Add new playlist"})]})})]})]}),a.jsxs("div",{className:`${M.col} mt-3 md:mt-0`,children:[a.jsx("p",{className:"font-bold mb-1 h-[36px]",children:"Selected"}),a.jsx("div",{className:`${M.box} flex-grow overflow-auto`,children:k(w)})]})]}),a.jsx("p",{className:"text-right mt-3 flex-shrink-0",children:a.jsxs(J,{disabled:!w.length,loading:n,onClick:j,children:[a.jsx(Xa,{className:"w-6"}),a.jsx("span",{children:"Add"})]})}),n&&a.jsx(ea,{})]}),a.jsx(ie,{variant:"animation",ref:i,children:a.jsx(je,{className:"w-[650px]",children:a.jsx(Zc,{modalRef:i,isLoading:b,variant:"add",submit:T,user:s,name:x.value})})})]})}function Ag(t){return a.jsx(vU,{children:a.jsx(kU,{...t})})}function TU(){const{setErrorToast:t,setSuccessToast:e}=ne(),[n,r]=h.useState(!1);return{action:async i=>{try{switch(r(!0),i.variant){case"add-to-playlists":{const{song:o,playlists:l}=i,c=Ls(de),u=async d=>{const f=await en({collectionName:"Playlists",id:d});if(!f.exists())return;const p=f.data();if(p.song_ids.includes(o.id))return;const g={song_ids:[...p.song_ids,o.id]};c.update(f.ref,g)};await Promise.all(l.map(d=>u(d.id))),e("Add song to playlists successful"),c.commit()}}}catch(o){console.log(o),t()}finally{r(!1)}},isFetching:n,setIsFetching:r}}function IU({song:t}){const{action:e,isFetching:n}=TU(),[r,s]=h.useState(""),i=h.useRef(null),o=()=>{var c;return(c=i.current)==null?void 0:c.close()},l=c=>{var u;s(c),(u=i.current)==null||u.open()};return a.jsxs(a.Fragment,{children:[a.jsxs(y5,{song:t,children:[a.jsxs(se,{to:`/dashboard/lyric/${t.id}`,children:[a.jsx(Vp,{className:"w-5"}),a.jsx("span",{children:"Lyric"})]}),a.jsxs("button",{onClick:()=>l("add-to-playlists"),children:[a.jsx("span",{className:"w-5",children:Ng}),a.jsx("span",{children:"Add to playlists"})]})]}),a.jsx(ie,{ref:i,variant:"animation",children:r==="add-to-playlists"&&a.jsx(Ag,{closeModal:o,current:[],isLoading:n,submit:c=>e({variant:"add-to-playlists",playlists:c,song:t})})})]})}function CU({song:t}){return a.jsx("div",{className:"px-2 mb-3",children:a.jsxs("div",{className:"p-2 bg-white/10 rounded-md flex",children:[a.jsx("div",{className:"w-[60px] h-[60px] flex-shrink-0 rounded overflow-hidden",children:a.jsx(De,{className:"object-cover h-full",src:t.image_url})}),a.jsxs("div",{className:"ml-2 text-sm",children:[a.jsx("h5",{className:"line-clamp-1 font-[500]",children:t.name}),a.jsx("h5",{className:"line-clamp-1 text-sm opacity-[.7]",children:t.singers.map((e,n)=>(n?", ":"")+e.name)})]})]})})}function y5({song:t,children:e}){return a.jsx(a.Fragment,{children:a.jsx(sr,{className:"w-[260px]",children:a.jsxs(cr,{children:[a.jsx(CU,{song:t}),a.jsx(ls,{children:e})]})})})}function v5({song:t,variant:e}){const n=()=>{switch(e){case"songs":return a.jsx(IU,{song:t});case"playlist":return a.jsx(fU,{song:t})}};return a.jsx(a.Fragment,{children:a.jsxs(nr,{appendOnPortal:!0,children:[a.jsx(rr,{children:a.jsx(J,{size:"clear",color:"second",className:"p-1",children:a.jsx(Qd,{className:"w-5"})})}),n()]})})}function RU({song:t,className:e="",variant:n,children:r}){var s;return a.jsxs("tr",{className:e,children:[a.jsx("td",{children:a.jsx(se,{to:`/dashboard/song/${t.id}/edit`,className:"hover:underline",children:t.name})}),a.jsx("td",{children:t.singers.map((i,o)=>a.jsxs(se,{className:"hover:underline",to:`/dashboard/singer/${i.id}`,children:[!!o&&", ",i.name]},o))}),a.jsxs("td",{children:[(s=t.main_genre)==null?void 0:s.name,t.genres.map((i,o)=>a.jsxs("span",{children:[", ",i.name]},o))]}),a.jsx("td",{children:a.jsx(v5,{variant:n,song:t})}),r]})}function w5({value:t,setValue:e,inputRef:n}){return a.jsxs(Zt,{className:"flex gap-2 justify-between items-center",children:[a.jsx(En,{ref:n,value:t,onChange:r=>e(r.target.value),placeholder:"..."}),a.jsx(J,{onClick:()=>t?e(""):{},size:"clear",className:"p-2 flex-shrink-0",children:t?a.jsx(ol,{className:"w-6"}):a.jsx(Jd,{className:"w-6"})})]})}function Ji({handleSubmit:t,setValue:e,value:n,className:r="",loading:s,whenClear:i,inputRef:o,frame:l=!0,onFocus:c,formRef:u,place:d}){const f=g=>{g.preventDefault(),n.trim()&&t(g)},p=a.jsxs("form",{ref:u,onSubmit:f,className:"flex gap-2 justify-between items-center",children:[a.jsxs("div",{className:"relative flex-grow flex items-center",children:[a.jsx(En,{type:"text",ref:o,className:"font-semibold pr-10",value:n,onChange:g=>e(g.target.value),onFocus:c,placeholder:d||"..."}),n&&a.jsx("button",{type:"button",onClick:()=>{s||(e(""),i&&i())},className:"absolute right-3",children:s?a.jsx(Me,{className:"w-6 animate-spin"}):a.jsx(ol,{className:"w-6"})})]}),a.jsx(J,{type:"submit",size:"clear",className:"p-2 flex-shrink-0",children:a.jsx(Jd,{className:"w-6"})})]});return l?a.jsx(Zt,{className:r,children:p}):p}function Ms(t){if(!t)return"0";const e=["","K","M","B"],n=Math.log10(Math.abs(t))/3|0;return n===0?t.toString():(t/Math.pow(10,n*3)).toFixed(1)+e[n]}function Pg({init:t,submit:e,loading:n}){const[r,s]=h.useState(0),i=h.useRef(null);return h.useEffect(()=>{s(t)},[]),a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{children:"Likes: "})," ",Ms(t),a.jsx("button",{onClick:()=>{var o;return(o=i.current)==null?void 0:o.open()},children:a.jsx(is,{className:"w-5"})})]}),a.jsx(ie,{variant:"animation",ref:i,children:a.jsxs(je,{children:[a.jsxs("div",{children:[a.jsx(kt,{htmlFor:"like",children:"Like"}),a.jsx(En,{value:r+""||"0",id:"like",onChange:o=>s(+o.target.value||0),type:"number"})]}),a.jsx("p",{className:"text-right mt-5",children:a.jsx(J,{color:"primary",onClick:()=>{e(r,i.current.close)},disabled:n,className:"rounded-full",children:"Save"})}),n&&a.jsx(ea,{})]})})]})}function Fg({closeModal:t,data:e,submit:n,isLoading:r}){const[s,i]=h.useState([]),[o,l]=h.useState(),c=h.useMemo(()=>{const d=[];return s.forEach(f=>{const p=e.find(g=>g.id===f);p&&d.push(p)}),d},[s]),u=d=>{if(o===void 0)l(d);else if(d===o)l(void 0);else{const f=[...s],p=f[o];f[o]=f[d],f[d]=p,i(f),l(void 0)}};return h.useEffect(()=>{i(e.map(d=>d.id))},[]),a.jsx(a.Fragment,{children:a.jsxs(je,{children:[a.jsx(qe,{closeModal:t,title:"Change order"}),a.jsx("div",{className:"flex flex-col flex-grow overflow-auto space-y-2 py-2",children:c.map((d,f)=>a.jsx("button",{onClick:()=>u(f),"data-id":d.id,className:`attribute-item p-1.5 ${o===f?"bg-[--primary-cl] text-white":"hover:bg-[--a-5-cl] bg-[#f1f1f1]"}  border-[2px] border-[#ccc] rounded-md`,children:d.label},f))}),a.jsx("p",{className:"text-right mt-3",children:a.jsx(J,{onClick:()=>n(s),loading:r,children:"Ok"})})]})})}function ml({title:t,modalRef:e,setImageFile:n,children:r}){n_({modalRef:e,setImageFileFromParent:n});const s=h.useRef(null),i=o=>{var l,c;(l=o.target.files)!=null&&l.length&&(n(o.target.files[0]),(c=e.current)==null||c.close())};return a.jsxs(je,{children:[a.jsx("input",{onChange:i,type:"file",value:"",multiple:!0,accept:"image/png, image/jpeg",id:"image_upload",className:"hidden"}),a.jsx("label",{ref:s,htmlFor:"image_upload"}),a.jsx(qe,{title:t||"Choose image",closeModal:()=>{var o;return(o=e.current)==null?void 0:o.close()}}),a.jsx("p",{children:a.jsxs(ce,{onClick:()=>{var o;return(o=s.current)==null?void 0:o.click()},color:"primary",children:[a.jsx(X6,{className:"w-6"}),a.jsx("span",{children:"Choose from computer"})]})}),r]})}function NU({children:t,className:e,persisted:n=!1,...r},s){const i=r.variant||"default",[o,l]=h.useState(i==="default"),[c,u]=h.useState(i==="default"),[d,f]=h.useState(!1),p=()=>{c&&u(!1),o||l(!0)},g=()=>{l(!0)},x=()=>{u(!1),f(!1)},w=()=>{d||(i==="default"?r.closeModal&&r.closeModal():x())},v=j=>{f(j)},_=j=>{j.preventDefault(),j.stopPropagation(),w()};h.useImperativeHandle(s,()=>({toggle:p,close:x,open:g,setModalPersist:v})),h.useEffect(()=>{o&&f(n)},[o]),h.useEffect(()=>{i!=="default"&&(c||setTimeout(()=>{l(!1),r.onClose&&r.onClose()},200))},[c]),h.useEffect(()=>{i!=="default"&&o&&setTimeout(()=>{u(!0)},100)},[o]),h.useEffect(()=>{const j=T=>{T.key==="Escape"&&w()};return o&&window.addEventListener("keyup",j),()=>{window.removeEventListener("keyup",j)}},[o,d]);const b={unMountedContent:"opacity-0 scale-[.95]",mountedContent:"opacity-100 scale-[1]",unMountedLayer:"opacity-0",mountedLayer:"opacity-40"};return a.jsx(a.Fragment,{children:o&&il.createPortal(a.jsxs("div",{className:"fixed inset-0 z-[99]",children:[a.jsx("div",{onClick:_,className:`transition-opacity duration-200 absolute bg-black inset-0 z-[90]
                             ${c?b.mountedLayer:b.unMountedLayer}
                        `}),a.jsx("div",{className:`modal-content absolute duration-200 transition-[transform,opacity] z-[99] top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2
                            ${c?b.mountedContent:b.unMountedContent}
                        `,children:t})]}),document.getElementById("portals"))})}function je({children:t,noStyle:e,disable:n,className:r="w-[400px]"}){return a.jsx("div",{className:`relative text-[--text-cl] transition-[color] overflow-hidden max-h-[80vh] max-w-[90vw] flex flex-col  ${n?"disabled":""} ${e?"":"p-3 md:p-4s rounded-xl"}  ${location.hash.includes("/dashboard")?"bg-white text-black":"bg-[--popup-cl]"} ${r}`,children:t})}const ie=h.forwardRef(NU),AU=({appendOnPortal:t,persist:e})=>{const[n,r]=h.useState(!1),[s,i]=h.useState(!1),o=h.useRef(null),l=h.useRef(null);return{refs:{triggerRef:o,contentRef:l},setTriggerRef:p=>{o.current=p},setContentRef:p=>{l.current=p},state:{isMounted:s,isOpen:n},setIsMounted:i,setIsOpen:r,appendOnPortal:t,persist:e,close:()=>{i(!1)},toggle:()=>{s&&i(!1),n||r(!0)}}},_5=h.createContext(null),eu=()=>{const t=h.useContext(_5);return t||{}};function nr({children:t,appendOnPortal:e,className:n="",...r}){return a.jsx(_5.Provider,{value:AU({...r,appendOnPortal:e}),children:e?t:a.jsx("div",{className:`relative z-[9] ${n}`,children:t})})}function PU(t){const{state:{isOpen:e},refs:n,close:r,appendOnPortal:s}=eu(),i=h.useRef(null),o=()=>{const{origin:c="top right",position:u,spacer:d=8}=t,f=n.triggerRef.current,p=n.contentRef.current,g=i.current;if(!f||!p)return;const x=f.getBoundingClientRect(),w={top:x.top+f.clientHeight,left:x.left-p.clientWidth-d};if(s){switch(w.top=x.top+f.clientHeight+d,u){case"right-bottom":w.left=x.left+d;break}const v=w.top+p.clientHeight>window.innerHeight-90;if(v){let _=w.top-p.clientHeight-f.clientHeight;_-60<0&&(_=60),w.top=_}if(g){let _=c;v&&(_="bottom right"),g.style.transformOrigin=_}}p.style.left=`${w.left}px`,p.style.top=`${w.top}px`},l=r;return h.useEffect(()=>{if(!s)return;if(e)o();else return;const c=document.querySelector(".main-container");if(c)return c.addEventListener("wheel",l),()=>{c&&c.removeEventListener("wheel",l)}},[e]),{animationRef:i}}const rr=h.forwardRef(function({children:t,needButton:e},n){const{refs:r,setIsMounted:s,setIsOpen:i,close:o,toggle:l,state:{isMounted:c,isOpen:u}}=eu();return h.useImperativeHandle(n,()=>({close:o})),h.useEffect(()=>{c||setTimeout(()=>{i(!1)},200)},[c]),h.useEffect(()=>(u&&setTimeout(()=>{s(!0)},100),()=>{u||s(!1)}),[u]),h.useEffect(()=>{if(!u)return;const d=f=>{var p,g;!r.contentRef||!r.triggerRef||(p=r.triggerRef.current)!=null&&p.contains(f.target)||(g=r.contentRef.current)!=null&&g.contains(f.target)||s(!1)};return document.addEventListener("mousedown",d),document.addEventListener("touchstart",d),()=>{document.removeEventListener("mousedown",d),document.removeEventListener("touchstart",d)}},[u]),!e&&h.isValidElement(t)?h.cloneElement(t,{onClick:l,ref:r.triggerRef}):a.jsx("button",{ref:r.triggerRef,onClick:l,children:t})});function sr(t){const{animationRef:e}=PU(t),{state:{isMounted:n,isOpen:r},appendOnPortal:s,setContentRef:i,persist:o}=eu(),l={unMountedContent:"opacity-0 scale-[.95]",mountedContent:"opacity-100 scale-[1]"},c=a.jsx("div",{ref:i,className:`${s?"fixed z-[99]":"absolute"} ${t.className||""}`,children:a.jsx("div",{ref:e,className:` transition-[transform,opacity] duration-[.2s] ease-linear ${t.animationClassName||""} ${n?l.mountedContent:l.unMountedContent}`,children:t.children})});return!r&&!o?a.jsx(a.Fragment,{}):a.jsx(a.Fragment,{children:s?il.createPortal(c,document.getElementById("portals")):c})}function FU({children:t,className:e="",cb:n}){const{close:r}=eu(),s=h.useRef(null);return h.useEffect(()=>{if(!s.current)return;const i=s.current.querySelectorAll("button"),o=()=>{r(),n&&n()};return i.forEach(l=>{l.addEventListener("click",o)}),()=>{i&&i.forEach(l=>{l.removeEventListener("click",o)})}},[]),a.jsx("div",{ref:s,className:`${e}`,children:t})}function ls({children:t,dismiss:e=!0,className:n="",cb:r}){const s={container:"hover:[&>*:not(div.absolute)]:bg-[--a-5-cl] [&>*]:px-3 [&>*]:py-2 [&>*]:w-full [&>*]:space-x-2 [&>*]:text-sm [&>*]:flex [&>*]:items-center [&_svg]:w-6  [&_svg]:flex-shrink-0 [&>*]:items-center [&_span]:font-semibold"};return e?a.jsx(FU,{cb:r,className:`${s.container} ${n}`,children:t}):a.jsx("div",{className:s.container,children:t})}function cr({children:t,className:e="",colorClasses:n="bg-[--popup-cl] text-[--text-cl]"}){return a.jsx("div",{className:`rounded-md py-2 popup-shadow transition-[color] ${n}  ${e}`,children:t})}var MU=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","#","$","%","*","+",",","-",".",":",";","=","?","@","[","]","^","_","{","|","}","~"],Vu=t=>{let e=0;for(let n=0;n<t.length;n++){let r=t[n],s=MU.indexOf(r);e=e*83+s}return e},dx=t=>{let e=t/255;return e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)},hx=t=>{let e=Math.max(0,Math.min(1,t));return e<=.0031308?Math.trunc(e*12.92*255+.5):Math.trunc((1.055*Math.pow(e,.4166666666666667)-.055)*255+.5)},DU=t=>t<0?-1:1,fx=(t,e)=>DU(t)*Math.pow(Math.abs(t),e),JS=class extends Error{constructor(t){super(t),this.name="ValidationError",this.message=t}},LU=t=>{if(!t||t.length<6)throw new JS("The blurhash string must be at least 6 characters");let e=Vu(t[0]),n=Math.floor(e/9)+1,r=e%9+1;if(t.length!==4+2*r*n)throw new JS(`blurhash length mismatch: length is ${t.length} but it should be ${4+2*r*n}`)},OU=t=>{let e=t>>16,n=t>>8&255,r=t&255;return[dx(e),dx(n),dx(r)]},$U=(t,e)=>{let n=Math.floor(t/361),r=Math.floor(t/19)%19,s=t%19;return[fx((n-9)/9,2)*e,fx((r-9)/9,2)*e,fx((s-9)/9,2)*e]},zU=(t,e,n,r)=>{LU(t),r=r|1;let s=Vu(t[0]),i=Math.floor(s/9)+1,o=s%9+1,l=(Vu(t[1])+1)/166,c=new Array(o*i);for(let f=0;f<c.length;f++)if(f===0){let p=Vu(t.substring(2,6));c[f]=OU(p)}else{let p=Vu(t.substring(4+f*2,6+f*2));c[f]=$U(p,l*r)}let u=e*4,d=new Uint8ClampedArray(u*n);for(let f=0;f<n;f++)for(let p=0;p<e;p++){let g=0,x=0,w=0;for(let j=0;j<i;j++)for(let T=0;T<o;T++){let R=Math.cos(Math.PI*p*T/e)*Math.cos(Math.PI*f*j/n),M=c[T+j*o];g+=M[0]*R,x+=M[1]*R,w+=M[2]*R}let v=hx(g),_=hx(x),b=hx(w);d[4*p+0+f*u]=v,d[4*p+1+f*u]=_,d[4*p+2+f*u]=b,d[4*p+3+f*u]=255}return d},BU=zU,VU=Object.defineProperty,UU=Object.defineProperties,HU=Object.getOwnPropertyDescriptors,lp=Object.getOwnPropertySymbols,b5=Object.prototype.hasOwnProperty,S5=Object.prototype.propertyIsEnumerable,ZS=(t,e,n)=>e in t?VU(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,mv=(t,e)=>{for(var n in e||(e={}))b5.call(e,n)&&ZS(t,n,e[n]);if(lp)for(var n of lp(e))S5.call(e,n)&&ZS(t,n,e[n]);return t},pv=(t,e)=>UU(t,HU(e)),E5=(t,e)=>{var n={};for(var r in t)b5.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&lp)for(var r of lp(t))e.indexOf(r)<0&&S5.call(t,r)&&(n[r]=t[r]);return n},j5=class extends h.PureComponent{constructor(){super(...arguments),this.canvas=null,this.handleRef=t=>{this.canvas=t,this.draw()},this.draw=()=>{let{hash:t,height:e,punch:n,width:r}=this.props;if(this.canvas){let s=BU(t,r,e,n),i=this.canvas.getContext("2d"),o=i.createImageData(r,e);o.data.set(s),i.putImageData(o,0,0)}}}componentDidUpdate(){this.draw()}render(){let t=this.props,{hash:e,height:n,width:r}=t,s=E5(t,["hash","height","width"]);return h.createElement("canvas",pv(mv({},s),{height:n,width:r,ref:this.handleRef}))}};j5.defaultProps={height:128,width:128};var GU={position:"absolute",top:0,bottom:0,left:0,right:0,width:"100%",height:"100%"},tu=class extends h.PureComponent{componentDidUpdate(){if(this.props.resolutionX<=0)throw new Error("resolutionX must be larger than zero");if(this.props.resolutionY<=0)throw new Error("resolutionY must be larger than zero")}render(){let t=this.props,{hash:e,height:n,width:r,punch:s,resolutionX:i,resolutionY:o,style:l}=t,c=E5(t,["hash","height","width","punch","resolutionX","resolutionY","style"]);return h.createElement("div",pv(mv({},c),{style:pv(mv({display:"inline-block",height:n,width:r},l),{position:"relative"})}),h.createElement(j5,{hash:e,height:o,width:i,punch:s,style:GU}))}};tu.defaultProps={height:128,width:128,resolutionX:32,resolutionY:32};const r_="USRKy:SK%|R*}@r@MxoeY$kWmnafBUR*oybu",cc={image:"./meo_vo_tri.png",blurhash:"LGRx;gsj^Vo~iFbJpMRP^oj=Ixbd"},Nc={image:"./cho_vo_tri.jpg",blurhash:"LDRf4[-e|,ErI7EUkv$@nK-iEVIb"};function De({src:t,className:e="",width:n="w-full",blurHashEncode:r,onError:s,onLoad:i,fallback:o}){const[l,c]=h.useState(!1),u=h.useRef(null),d=g=>{setTimeout(()=>c(!0),200),t&&(t!=null&&t.includes("blob")&&URL.revokeObjectURL(t),i&&i(g))},f=()=>{const g=u.current;g.src=o||"https://placehold.co/400",c(!0)},p=()=>{console.log("image error"),s?(s(),f()):f()};return a.jsxs(a.Fragment,{children:[!l&&a.jsx(a.Fragment,{children:a.jsx(tu,{hash:r||r_,className:`overflow-hidden ${e}`,height:"100%",width:"100%"})}),a.jsx("img",{onLoad:d,onError:p,className:`${e} ${n} ${l?"":"hidden"}`,src:t||"https://placehold.co/500",ref:u})]})}function mx({className:t,icon:e,label:n,to:r,arrowIcon:s,children:i}){return r?a.jsxs(se,{className:`w-full flex  justify-between  ${t}`,to:r,children:[a.jsxs("div",{className:"inline-flex items-center ",children:[e,a.jsx("span",{className:"text-lg font-medium",children:n})]}),i,s&&a.jsx("span",{children:s})]}):a.jsx("p",{children:"No onClick"})}const s_="/HD-MP3/assets/simon_empty-95813d48.png";function Fe({children:t,variant:e="default",className:n=""}){const r=()=>{switch(e){case"less":return a.jsx(a.Fragment,{});case"with-home-button":return a.jsxs(a.Fragment,{children:[a.jsx("p",{className:"text-center",children:"No result found, ¯\\_(ツ)_/¯"}),a.jsx("p",{className:"text-center mt-5",children:a.jsx(se,{to:"/",children:a.jsxs(ce,{color:"primary",children:[a.jsx(Yd,{className:"w-6"}),a.jsx("span",{children:"Home"})]})})})]});case"default":return a.jsx("p",{className:"text-center",children:"No result found, ¯\\_(ツ)_/¯"})}};return a.jsxs("div",{className:`${n}`,children:[a.jsx("img",{className:"mx-auto",src:s_,alt:""}),r(),t]})}function Ye({children:t}){return a.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2",children:t})}function k5({colList:t,children:e,className:n=""}){const r={table:"w-full"};return a.jsxs("table",{className:`${r.table} ${n}`,children:[a.jsx("thead",{children:a.jsx("tr",{className:"no-hover",children:t.map((s,i)=>a.jsx("th",{children:s},i))})}),a.jsx("tbody",{children:e})]})}function WU({audioEle:t,postLocalStorageKey:e}){const[n,r]=np(`audio_speed_${e}`,1),[s,i]=np(`audio_volume_${e}`,100);return h.useEffect(()=>{t.volume=s/100,t.playbackRate=n},[s,n]),{speed:n,setSpeed:r,volume:s,setVolume:i}}function T5({className:t="",positions:e="right",bg:n="bg-[--primary-cl] text-white",menuColor:r="bg-[--popup-cl]",...s}){const{speed:i,volume:o,setVolume:l,setSpeed:c}=WU(s);return a.jsxs(nr,{appendOnPortal:!0,children:[a.jsx(rr,{children:a.jsx(ce,{className:`rounded-full ${n} ${t}`,children:a.jsx(O1,{className:"w-6"})})}),a.jsx(sr,{...e==="right"?{position:"right-bottom",origin:"top left"}:{position:"left-bottom",origin:"top right"},children:a.jsx(cr,{colorClasses:r,className:"w-[240px] px-2",children:a.jsxs("div",{className:"space-y-[6px]",children:[a.jsxs("div",{className:"flex space-x-1",children:[a.jsxs("div",{className:"w-[110px] flex-shrink-0",children:["Speed ",i,"x"]}),a.jsx("input",{className:"w-full",type:"range",step:.1,min:.6,max:1.5,value:i,onChange:u=>c(+u.target.value)})]}),a.jsxs("div",{className:"flex space-x-1",children:[a.jsxs("div",{className:"w-[110px] flex-shrink-0",children:["Volume ",o,"%"]}),a.jsx("input",{className:"w-full",type:"range",step:1,min:1,max:100,value:o,onChange:u=>l(+u.target.value)})]})]})})})]})}function we({className:t}){return a.jsx("div",{className:`animate-pulse rounded-[4px] bg-[#e0e0e0] dark:bg-[#3a3a3a]  ${t}`})}function Zi({variant:t="system-song",skeNum:e=4,hasCheckBox:n=!0,className:r}){return[...Array(e).keys()].map(s=>a.jsxs("div",{className:`flex items-center px-3 py-2 ${r}`,children:[n&&a.jsx(we,{className:"h-[18px] w-[18px] mr-[10px]"}),a.jsxs("div",{className:"flex",children:[a.jsx(we,{className:`${t==="queue-song"?"h-10 w-10":"h-[54px] w-[54px]"}`}),a.jsxs("div",{className:"ml-[10px]",children:[a.jsx(we,{className:"h-[16px] w-[140px] max-w-full"}),a.jsx(we,{className:"h-[14px] w-[80px] mt-[6px] max-w-1/2"})]})]})]},s))}const qU=()=>a.jsx("div",{className:"py-3",children:a.jsx(we,{className:"w-full h-[28px]"})});[...Array(2).keys()].map(t=>a.jsxs("div",{className:"p-2 w-1/2 md:w-1/4",children:[a.jsx(we,{className:"pt-[100%] rounded-lg"}),a.jsx(we,{className:"h-[21px] mt-1.5 w-3/4"}),a.jsx(we,{className:"h-[13px] mt-1 w-3/4"})]},t));function Ql({cb:t,active:e,inActiveBg:n="bg-[--a-5-cl]",size:r="default"}){const s={circle:`${r==="default"?"w-[20px] h-[20px]":"w-[16px] h-[16px]"}  absolute bg-white left-[3px] rounded-[50%] transition-transform top-[50%] translate-y-[-50%]`,active:`${r==="default"?"translate-x-[14px]":"translate-x-[18px]"} `,inActive:"translate-x-[0]"};return a.jsx("div",{onClick:t,className:`relative  cursor-pointer ${r==="default"?"h-[24px]":"h-[20px]"} rounded-[99px] w-[40px] 
         ${e?"bg-[--primary-cl]":n} `,children:a.jsx("div",{className:`${s.circle} ${e?s.active:s.inActive}`})})}function Ur({setTab:t,render:e,disable:n,tab:r,tabs:s,className:i="",buttonClasses:o="[&_button]:py-1 [&_button]:px-4 "}){const l={inActiveTab:" hover:bg-[--a-5-cl]",activeTab:"bg-[--primary-cl] text-white"};return a.jsx("div",{className:`bg-[--a-5-cl] ${n?"disable":""} p-1.5 space-x-1 rounded-full ${i} ${o}`,children:s.map((c,u)=>a.jsx(ce,{size:"clear",onClick:d=>{t(c),d.target.blur()},className:`${c===r?l.activeTab:l.inActiveTab}`,children:e(c)},u))})}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function KU(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function l(d){try{u(r.next(d))}catch(f){o(f)}}function c(d){try{u(r.throw(d))}catch(f){o(f)}}function u(d){d.done?i(d.value):s(d.value).then(l,c)}u((r=r.apply(t,e||[])).next())})}function QU(t,e){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,s,i,o;return o={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(u){return function(d){return c([u,d])}}function c(u){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,s&&(i=u[0]&2?s.return:u[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,u[1])).done)return i;switch(s=0,i&&(u=[u[0]&2,i.value]),u[0]){case 0:case 1:i=u;break;case 4:return n.label++,{value:u[1],done:!1};case 5:n.label++,s=u[1],u=[0];continue;case 7:u=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(u[0]===6||u[0]===2)){n=0;continue}if(u[0]===3&&(!i||u[1]>i[0]&&u[1]<i[3])){n.label=u[1];break}if(u[0]===6&&n.label<i[1]){n.label=i[1],i=u;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(u);break}i[2]&&n.ops.pop(),n.trys.pop();continue}u=e.call(t,n)}catch(d){u=[6,d],s=0}finally{r=i=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Xl=function(){return Xl=Object.assign||function(e){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Xl.apply(this,arguments)},I5=function(t){return{loading:t==null,value:t}},XU=function(){return function(t,e){switch(e.type){case"error":return Xl(Xl({},t),{error:e.error,loading:!1,value:void 0});case"reset":return I5(e.defaultValue);case"value":return Xl(Xl({},t),{error:void 0,loading:!1,value:e.value});default:return t}}},YU=function(t){var e=t?t():void 0,n=h.useReducer(XU(),I5(e)),r=n[0],s=n[1],i=h.useCallback(function(){var c=t?t():void 0;s({type:"reset",defaultValue:c})},[t]),o=h.useCallback(function(c){s({type:"error",error:c})},[]),l=h.useCallback(function(c){s({type:"value",value:c})},[]);return h.useMemo(function(){return{error:r.error,loading:r.loading,reset:i,setError:o,setValue:l,value:r.value}},[r.error,r.loading,i,o,l,r.value])},i_=function(t,e){var n=YU(function(){return t.currentUser}),r=n.error,s=n.loading,i=n.setError,o=n.setValue,l=n.value;return h.useEffect(function(){var c=xz(t,function(u){return KU(void 0,void 0,void 0,function(){var d;return QU(this,function(f){switch(f.label){case 0:if(!(e!=null&&e.onUserChanged))return[3,4];f.label=1;case 1:return f.trys.push([1,3,,4]),[4,e.onUserChanged(u)];case 2:return f.sent(),[3,4];case 3:return d=f.sent(),i(d),[3,4];case 4:return o(u),[2]}})})},i);return function(){c()}},[t]),[l,s,r]};function gv({className:t}){const[e]=i_(Ga),n={imageFrame:`${t||"w-[35px] h-[35px]"} flex-shrink-0 rounded-full overflow-hidden ${e!=null&&e.photoURL?"":"flex items-center justify-center bg-[#ccc]"}`};return a.jsx("div",{className:n.imageFrame,children:a.jsx(De,{fallback:cc.image,src:(e==null?void 0:e.photoURL)||cc.image,blurHashEncode:e!=null&&e.photoURL?"":cc.blurhash,className:"w-full"})})}function JU({children:t,onClose:e,onOpen:n},r){const[s,i]=h.useState(!1),[o,l]=h.useState(!1),c=()=>{o&&l(!1),s||i(!0)},u=()=>{i(!0)},d=()=>{l(!1)},f=g=>{g.preventDefault(),g.stopPropagation(),d()};h.useImperativeHandle(r,()=>({toggle:c,close:d,open:u,setModalPersist:()=>{}})),h.useEffect(()=>{o||setTimeout(()=>{i(!1),e&&e()},200)},[o]),h.useEffect(()=>{s&&setTimeout(()=>{n&&n(),l(!0)},100)},[s]);const p={unMountedContent:"translate-y-full ",mountedContent:"translate-y-0",unMountedLayer:"opacity-0",mountedLayer:"opacity-20"};return a.jsx(a.Fragment,{children:s&&il.createPortal(a.jsxs("div",{className:"fixed inset-0 z-[99]",children:[a.jsx("div",{onClick:f,className:`transition-opacity duration-200 absolute bg-black inset-0 z-[90]
                             ${o?p.mountedLayer:p.unMountedLayer}
                        `}),a.jsx("div",{className:`modal-content absolute bottom-0 left-0 right-0 duration-200 transition-[transform,opacity] z-[99]
                            ${o?p.mountedContent:p.unMountedContent}
                        `,children:t})]}),document.getElementById("portals"))})}const xv=h.forwardRef(JU),ZU="/HD-MP3/assets/loading-b1210647.gif";function nu({className:t=""}){return a.jsx("img",{src:ZU,className:`w-[200px] mx-auto ${t}`})}function kt({children:t,className:e="",htmlFor:n}){const r=`text-gray-600 dark:text-gray-300 font-bold ${e}`;return n?a.jsx("label",{className:r,htmlFor:n,children:t}):a.jsx("p",{className:r,children:t})}function ea(){return a.jsx("div",{className:"absolute z-[999] left-0 top-0 bottom-0 w-full flex items-center justify-center bg-white/60 dark:bg-white/30",children:a.jsx("div",{className:"w-9 h-9 animate-spin rounded-full border-r-[--primary-cl] border-4"})})}function wh({className:t="h-[6px]",onClick:e,elelRef:n,bg:r="var(--a-5-cl)"}){return a.jsx("div",{onClick:e,ref:n,style:{background:r},className:`rounded-full w-full progress-line ${t}`})}function Za({children:t,className:e="space-y-10"}){return a.jsx("div",{className:"min-h-[calc(100vh-127px-10px)] md:min-h-[unset] md:pt-10 "+e,children:t})}function _h({children:t,className:e=""}){return a.jsx("div",{className:`relative ${e}`,children:a.jsx("div",{className:"absolute inset-0",children:t})})}var C5={},cp={exports:{}};cp.exports;(function(t,e){var n=200,r="__lodash_hash_undefined__",s=1,i=2,o=9007199254740991,l="[object Arguments]",c="[object Array]",u="[object AsyncFunction]",d="[object Boolean]",f="[object Date]",p="[object Error]",g="[object Function]",x="[object GeneratorFunction]",w="[object Map]",v="[object Number]",_="[object Null]",b="[object Object]",j="[object Promise]",T="[object Proxy]",R="[object RegExp]",M="[object Set]",k="[object String]",E="[object Symbol]",I="[object Undefined]",C="[object WeakMap]",A="[object ArrayBuffer]",D="[object DataView]",P="[object Float32Array]",ee="[object Float64Array]",_e="[object Int8Array]",He="[object Int16Array]",Be="[object Int32Array]",B="[object Uint8Array]",K="[object Uint8ClampedArray]",X="[object Uint16Array]",he="[object Uint32Array]",pe=/[\\^$.*+?()[\]{}|]/g,Ie=/^\[object .+?Constructor\]$/,vt=/^(?:0|[1-9]\d*)$/,ve={};ve[P]=ve[ee]=ve[_e]=ve[He]=ve[Be]=ve[B]=ve[K]=ve[X]=ve[he]=!0,ve[l]=ve[c]=ve[A]=ve[d]=ve[D]=ve[f]=ve[p]=ve[g]=ve[w]=ve[v]=ve[b]=ve[R]=ve[M]=ve[k]=ve[C]=!1;var pn=typeof nf=="object"&&nf&&nf.Object===Object&&nf,Dt=typeof self=="object"&&self&&self.Object===Object&&self,ge=pn||Dt||Function("return this")(),rn=e&&!e.nodeType&&e,ht=rn&&!0&&t&&!t.nodeType&&t,dr=ht&&ht.exports===rn,hr=dr&&pn.process,us=function(){try{return hr&&hr.binding&&hr.binding("util")}catch{}}(),xl=us&&us.isTypedArray;function iu(F,L){for(var G=-1,Q=F==null?0:F.length,tt=0,Ce=[];++G<Q;){var ct=F[G];L(ct,G,F)&&(Ce[tt++]=ct)}return Ce}function kh(F,L){for(var G=-1,Q=L.length,tt=F.length;++G<Q;)F[tt+G]=L[G];return F}function Th(F,L){for(var G=-1,Q=F==null?0:F.length;++G<Q;)if(L(F[G],G,F))return!0;return!1}function Jg(F,L){for(var G=-1,Q=Array(F);++G<F;)Q[G]=L(G);return Q}function Ih(F){return function(L){return F(L)}}function Ch(F,L){return F.has(L)}function au(F,L){return F==null?void 0:F[L]}function Rh(F){var L=-1,G=Array(F.size);return F.forEach(function(Q,tt){G[++L]=[tt,Q]}),G}function Zg(F,L){return function(G){return F(L(G))}}function ou(F){var L=-1,G=Array(F.size);return F.forEach(function(Q){G[++L]=Q}),G}var lu=Array.prototype,cu=Function.prototype,Tt=Object.prototype,Kt=ge["__core-js_shared__"],to=cu.toString,_r=Tt.hasOwnProperty,uu=function(){var F=/[^.]+$/.exec(Kt&&Kt.keys&&Kt.keys.IE_PROTO||"");return F?"Symbol(src)_1."+F:""}(),Nh=Tt.toString,no=RegExp("^"+to.call(_r).replace(pe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),du=dr?ge.Buffer:void 0,ro=ge.Symbol,yl=ge.Uint8Array,Ah=Tt.propertyIsEnumerable,e0=lu.splice,ds=ro?ro.toStringTag:void 0,hu=Object.getOwnPropertySymbols,Ph=du?du.isBuffer:void 0,so=Zg(Object.keys,Object),io=Wr(ge,"DataView"),di=Wr(ge,"Map"),hs=Wr(ge,"Promise"),vl=Wr(ge,"Set"),sa=Wr(ge,"WeakMap"),ia=Wr(Object,"create"),ao=Nn(io),Fh=Nn(di),gn=Nn(hs),Mh=Nn(vl),oo=Nn(sa),aa=ro?ro.prototype:void 0,fu=aa?aa.valueOf:void 0;function hi(F){var L=-1,G=F==null?0:F.length;for(this.clear();++L<G;){var Q=F[L];this.set(Q[0],Q[1])}}function oa(){this.__data__=ia?ia(null):{},this.size=0}function t0(F){var L=this.has(F)&&delete this.__data__[F];return this.size-=L?1:0,L}function n0(F){var L=this.__data__;if(ia){var G=L[F];return G===r?void 0:G}return _r.call(L,F)?L[F]:void 0}function wl(F){var L=this.__data__;return ia?L[F]!==void 0:_r.call(L,F)}function Dh(F,L){var G=this.__data__;return this.size+=this.has(F)?0:1,G[F]=ia&&L===void 0?r:L,this}hi.prototype.clear=oa,hi.prototype.delete=t0,hi.prototype.get=n0,hi.prototype.has=wl,hi.prototype.set=Dh;function br(F){var L=-1,G=F==null?0:F.length;for(this.clear();++L<G;){var Q=F[L];this.set(Q[0],Q[1])}}function _l(){this.__data__=[],this.size=0}function Vs(F){var L=this.__data__,G=co(L,F);if(G<0)return!1;var Q=L.length-1;return G==Q?L.pop():e0.call(L,G,1),--this.size,!0}function Lh(F){var L=this.__data__,G=co(L,F);return G<0?void 0:L[G][1]}function Oh(F){return co(this.__data__,F)>-1}function mu(F,L){var G=this.__data__,Q=co(G,F);return Q<0?(++this.size,G.push([F,L])):G[Q][1]=L,this}br.prototype.clear=_l,br.prototype.delete=Vs,br.prototype.get=Lh,br.prototype.has=Oh,br.prototype.set=mu;function fs(F){var L=-1,G=F==null?0:F.length;for(this.clear();++L<G;){var Q=F[L];this.set(Q[0],Q[1])}}function $h(){this.size=0,this.__data__={hash:new hi,map:new(di||br),string:new hi}}function zh(F){var L=pi(this,F).delete(F);return this.size-=L?1:0,L}function r0(F){return pi(this,F).get(F)}function bl(F){return pi(this,F).has(F)}function Bh(F,L){var G=pi(this,F),Q=G.size;return G.set(F,L),this.size+=G.size==Q?0:1,this}fs.prototype.clear=$h,fs.prototype.delete=zh,fs.prototype.get=r0,fs.prototype.has=bl,fs.prototype.set=Bh;function la(F){var L=-1,G=F==null?0:F.length;for(this.__data__=new fs;++L<G;)this.add(F[L])}function lo(F){return this.__data__.set(F,r),this}function fi(F){return this.__data__.has(F)}la.prototype.add=la.prototype.push=lo,la.prototype.has=fi;function Gr(F){var L=this.__data__=new br(F);this.size=L.size}function s0(){this.__data__=new br,this.size=0}function Vh(F){var L=this.__data__,G=L.delete(F);return this.size=L.size,G}function Uh(F){return this.__data__.get(F)}function Hh(F){return this.__data__.has(F)}function pu(F,L){var G=this.__data__;if(G instanceof br){var Q=G.__data__;if(!di||Q.length<n-1)return Q.push([F,L]),this.size=++G.size,this;G=this.__data__=new fs(Q)}return G.set(F,L),this.size=G.size,this}Gr.prototype.clear=s0,Gr.prototype.delete=Vh,Gr.prototype.get=Uh,Gr.prototype.has=Hh,Gr.prototype.set=pu;function gu(F,L){var G=po(F),Q=!G&&Qh(F),tt=!G&&!Q&&vu(F),Ce=!G&&!Q&&!tt&&xo(F),ct=G||Q||tt||Ce,It=ct?Jg(F.length,String):[],Lt=It.length;for(var Ze in F)(L||_r.call(F,Ze))&&!(ct&&(Ze=="length"||tt&&(Ze=="offset"||Ze=="parent")||Ce&&(Ze=="buffer"||Ze=="byteLength"||Ze=="byteOffset")||o0(Ze,Lt)))&&It.push(Ze);return It}function co(F,L){for(var G=F.length;G--;)if(yu(F[G][0],L))return G;return-1}function Gh(F,L,G){var Q=L(F);return po(F)?Q:kh(Q,G(F))}function uo(F){return F==null?F===void 0?I:_:ds&&ds in Object(F)?fo(F):mo(F)}function Wh(F){return go(F)&&uo(F)==l}function xu(F,L,G,Q,tt){return F===L?!0:F==null||L==null||!go(F)&&!go(L)?F!==F&&L!==L:qh(F,L,G,Q,xu,tt)}function qh(F,L,G,Q,tt,Ce){var ct=po(F),It=po(L),Lt=ct?c:ps(F),Ze=It?c:ps(L);Lt=Lt==l?b:Lt,Ze=Ze==l?b:Ze;var An=Lt==b,Ct=Ze==b,Qt=Lt==Ze;if(Qt&&vu(F)){if(!vu(L))return!1;ct=!0,An=!1}if(Qt&&!An)return Ce||(Ce=new Gr),ct||xo(F)?ho(F,L,G,Q,tt,Ce):Sl(F,L,Lt,G,Q,tt,Ce);if(!(G&s)){var fr=An&&_r.call(F,"__wrapped__"),sn=Ct&&_r.call(L,"__wrapped__");if(fr||sn){var xs=fr?F.value():F,Sr=sn?L.value():L;return Ce||(Ce=new Gr),tt(xs,Sr,G,Q,Ce)}}return Qt?(Ce||(Ce=new Gr),Kh(F,L,G,Q,tt,Ce)):!1}function i0(F){if(!Yh(F)||c0(F))return!1;var L=Xh(F)?no:Ie;return L.test(Nn(F))}function mi(F){return go(F)&&gs(F.length)&&!!ve[uo(F)]}function ms(F){if(!u0(F))return so(F);var L=[];for(var G in Object(F))_r.call(F,G)&&G!="constructor"&&L.push(G);return L}function ho(F,L,G,Q,tt,Ce){var ct=G&s,It=F.length,Lt=L.length;if(It!=Lt&&!(ct&&Lt>It))return!1;var Ze=Ce.get(F);if(Ze&&Ce.get(L))return Ze==L;var An=-1,Ct=!0,Qt=G&i?new la:void 0;for(Ce.set(F,L),Ce.set(L,F);++An<It;){var fr=F[An],sn=L[An];if(Q)var xs=ct?Q(sn,fr,An,L,F,Ce):Q(fr,sn,An,F,L,Ce);if(xs!==void 0){if(xs)continue;Ct=!1;break}if(Qt){if(!Th(L,function(Sr,qr){if(!Ch(Qt,qr)&&(fr===Sr||tt(fr,Sr,G,Q,Ce)))return Qt.push(qr)})){Ct=!1;break}}else if(!(fr===sn||tt(fr,sn,G,Q,Ce))){Ct=!1;break}}return Ce.delete(F),Ce.delete(L),Ct}function Sl(F,L,G,Q,tt,Ce,ct){switch(G){case D:if(F.byteLength!=L.byteLength||F.byteOffset!=L.byteOffset)return!1;F=F.buffer,L=L.buffer;case A:return!(F.byteLength!=L.byteLength||!Ce(new yl(F),new yl(L)));case d:case f:case v:return yu(+F,+L);case p:return F.name==L.name&&F.message==L.message;case R:case k:return F==L+"";case w:var It=Rh;case M:var Lt=Q&s;if(It||(It=ou),F.size!=L.size&&!Lt)return!1;var Ze=ct.get(F);if(Ze)return Ze==L;Q|=i,ct.set(F,L);var An=ho(It(F),It(L),Q,tt,Ce,ct);return ct.delete(F),An;case E:if(fu)return fu.call(F)==fu.call(L)}return!1}function Kh(F,L,G,Q,tt,Ce){var ct=G&s,It=Je(F),Lt=It.length,Ze=Je(L),An=Ze.length;if(Lt!=An&&!ct)return!1;for(var Ct=Lt;Ct--;){var Qt=It[Ct];if(!(ct?Qt in L:_r.call(L,Qt)))return!1}var fr=Ce.get(F);if(fr&&Ce.get(L))return fr==L;var sn=!0;Ce.set(F,L),Ce.set(L,F);for(var xs=ct;++Ct<Lt;){Qt=It[Ct];var Sr=F[Qt],qr=L[Qt];if(Q)var wu=ct?Q(qr,Sr,Qt,L,F,Ce):Q(Sr,qr,Qt,F,L,Ce);if(!(wu===void 0?Sr===qr||tt(Sr,qr,G,Q,Ce):wu)){sn=!1;break}xs||(xs=Qt=="constructor")}if(sn&&!xs){var gi=F.constructor,jl=L.constructor;gi!=jl&&"constructor"in F&&"constructor"in L&&!(typeof gi=="function"&&gi instanceof gi&&typeof jl=="function"&&jl instanceof jl)&&(sn=!1)}return Ce.delete(F),Ce.delete(L),sn}function Je(F){return Gh(F,El,a0)}function pi(F,L){var G=F.__data__;return l0(L)?G[typeof L=="string"?"string":"hash"]:G.map}function Wr(F,L){var G=au(F,L);return i0(G)?G:void 0}function fo(F){var L=_r.call(F,ds),G=F[ds];try{F[ds]=void 0;var Q=!0}catch{}var tt=Nh.call(F);return Q&&(L?F[ds]=G:delete F[ds]),tt}var a0=hu?function(F){return F==null?[]:(F=Object(F),iu(hu(F),function(L){return Ah.call(F,L)}))}:Jh,ps=uo;(io&&ps(new io(new ArrayBuffer(1)))!=D||di&&ps(new di)!=w||hs&&ps(hs.resolve())!=j||vl&&ps(new vl)!=M||sa&&ps(new sa)!=C)&&(ps=function(F){var L=uo(F),G=L==b?F.constructor:void 0,Q=G?Nn(G):"";if(Q)switch(Q){case ao:return D;case Fh:return w;case gn:return j;case Mh:return M;case oo:return C}return L});function o0(F,L){return L=L??o,!!L&&(typeof F=="number"||vt.test(F))&&F>-1&&F%1==0&&F<L}function l0(F){var L=typeof F;return L=="string"||L=="number"||L=="symbol"||L=="boolean"?F!=="__proto__":F===null}function c0(F){return!!uu&&uu in F}function u0(F){var L=F&&F.constructor,G=typeof L=="function"&&L.prototype||Tt;return F===G}function mo(F){return Nh.call(F)}function Nn(F){if(F!=null){try{return to.call(F)}catch{}try{return F+""}catch{}}return""}function yu(F,L){return F===L||F!==F&&L!==L}var Qh=Wh(function(){return arguments}())?Wh:function(F){return go(F)&&_r.call(F,"callee")&&!Ah.call(F,"callee")},po=Array.isArray;function ca(F){return F!=null&&gs(F.length)&&!Xh(F)}var vu=Ph||yo;function d0(F,L){return xu(F,L)}function Xh(F){if(!Yh(F))return!1;var L=uo(F);return L==g||L==x||L==u||L==T}function gs(F){return typeof F=="number"&&F>-1&&F%1==0&&F<=o}function Yh(F){var L=typeof F;return F!=null&&(L=="object"||L=="function")}function go(F){return F!=null&&typeof F=="object"}var xo=xl?Ih(xl):mi;function El(F){return ca(F)?gu(F):ms(F)}function Jh(){return[]}function yo(){return!1}t.exports=d0})(cp,cp.exports);var eH=cp.exports,R5={exports:{}},tH="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",nH=tH,rH=nH;function N5(){}function A5(){}A5.resetWarningCache=N5;var sH=function(){function t(r,s,i,o,l,c){if(c!==rH){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}t.isRequired=t;function e(){return t}var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:A5,resetWarningCache:N5};return n.PropTypes=n,n};R5.exports=sH();var iH=R5.exports;/*! Copyright Twitter Inc. and other contributors. Licensed under MIT */var aH=function(){var t={base:"https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/",ext:".png",size:"72x72",className:"emoji",convert:{fromCodePoint:b,toCodePoint:M},onerror:function(){this.parentNode&&this.parentNode.replaceChild(c(this.alt,!1),this)},parse:j,replace:T,test:R},e={"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"},n=/(?:\ud83d\udc68\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c[\udffc-\udfff]|\ud83e\uddd1\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c[\udffb\udffd-\udfff]|\ud83e\uddd1\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c[\udffb\udffc\udffe\udfff]|\ud83e\uddd1\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c[\udffb-\udffd\udfff]|\ud83e\uddd1\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c[\udffb-\udffe]|\ud83d\udc68\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffc-\udfff]|\ud83d\udc68\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffd-\udfff]|\ud83d\udc68\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffc\udffe\udfff]|\ud83d\udc68\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffd\udfff]|\ud83d\udc68\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffe]|\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffc-\udfff]|\ud83d\udc69\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffc-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffd-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb\udffd-\udfff]|\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffc\udffe\udfff]|\ud83d\udc69\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb\udffc\udffe\udfff]|\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffd\udfff]|\ud83d\udc69\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb-\udffd\udfff]|\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffe]|\ud83d\udc69\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb-\udffe]|\ud83e\uddd1\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c[\udffc-\udfff]|\ud83e\uddd1\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c[\udffb\udffd-\udfff]|\ud83e\uddd1\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c[\udffb\udffc\udffe\udfff]|\ud83e\uddd1\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c[\udffb-\udffd\udfff]|\ud83e\uddd1\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c[\udffb-\udffe]|\ud83e\uddd1\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83d\udc68\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68|\ud83d\udc69\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d[\udc68\udc69]|\ud83e\udef1\ud83c\udffb\u200d\ud83e\udef2\ud83c[\udffc-\udfff]|\ud83e\udef1\ud83c\udffc\u200d\ud83e\udef2\ud83c[\udffb\udffd-\udfff]|\ud83e\udef1\ud83c\udffd\u200d\ud83e\udef2\ud83c[\udffb\udffc\udffe\udfff]|\ud83e\udef1\ud83c\udffe\u200d\ud83e\udef2\ud83c[\udffb-\udffd\udfff]|\ud83e\udef1\ud83c\udfff\u200d\ud83e\udef2\ud83c[\udffb-\udffe]|\ud83d\udc68\u200d\u2764\ufe0f\u200d\ud83d\udc68|\ud83d\udc69\u200d\u2764\ufe0f\u200d\ud83d[\udc68\udc69]|\ud83e\uddd1\u200d\ud83e\udd1d\u200d\ud83e\uddd1|\ud83d\udc6b\ud83c[\udffb-\udfff]|\ud83d\udc6c\ud83c[\udffb-\udfff]|\ud83d\udc6d\ud83c[\udffb-\udfff]|\ud83d\udc8f\ud83c[\udffb-\udfff]|\ud83d\udc91\ud83c[\udffb-\udfff]|\ud83e\udd1d\ud83c[\udffb-\udfff]|\ud83d[\udc6b-\udc6d\udc8f\udc91]|\ud83e\udd1d)|(?:\ud83d[\udc68\udc69]|\ud83e\uddd1)(?:\ud83c[\udffb-\udfff])?\u200d(?:\u2695\ufe0f|\u2696\ufe0f|\u2708\ufe0f|\ud83c[\udf3e\udf73\udf7c\udf84\udf93\udfa4\udfa8\udfeb\udfed]|\ud83d[\udcbb\udcbc\udd27\udd2c\ude80\ude92]|\ud83e[\uddaf-\uddb3\uddbc\uddbd])(?:\u200d\u27a1\ufe0f)?|(?:\ud83c[\udfcb\udfcc]|\ud83d[\udd74\udd75]|\u26f9)((?:\ud83c[\udffb-\udfff]|\ufe0f)\u200d[\u2640\u2642]\ufe0f(?:\u200d\u27a1\ufe0f)?)|(?:\ud83c[\udfc3\udfc4\udfca]|\ud83d[\udc6e\udc70\udc71\udc73\udc77\udc81\udc82\udc86\udc87\ude45-\ude47\ude4b\ude4d\ude4e\udea3\udeb4-\udeb6]|\ud83e[\udd26\udd35\udd37-\udd39\udd3d\udd3e\uddb8\uddb9\uddcd-\uddcf\uddd4\uddd6-\udddd])(?:\ud83c[\udffb-\udfff])?\u200d[\u2640\u2642]\ufe0f(?:\u200d\u27a1\ufe0f)?|(?:\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83e\uddd1\u200d\ud83e\uddd1\u200d\ud83e\uddd2\u200d\ud83e\uddd2|\ud83d\udc68\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc68\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d[\udc66\udc67]|\ud83e\uddd1\u200d\ud83e\uddd1\u200d\ud83e\uddd2|\ud83e\uddd1\u200d\ud83e\uddd2\u200d\ud83e\uddd2|\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f|\ud83c\udff3\ufe0f\u200d\ud83c\udf08|\ud83d\ude36\u200d\ud83c\udf2b\ufe0f|\u26d3\ufe0f\u200d\ud83d\udca5|\u2764\ufe0f\u200d\ud83d\udd25|\u2764\ufe0f\u200d\ud83e\ude79|\ud83c\udf44\u200d\ud83d\udfeb|\ud83c\udf4b\u200d\ud83d\udfe9|\ud83c\udff4\u200d\u2620\ufe0f|\ud83d\udc15\u200d\ud83e\uddba|\ud83d\udc26\u200d\ud83d\udd25|\ud83d\udc3b\u200d\u2744\ufe0f|\ud83d\udc41\u200d\ud83d\udde8|\ud83d\udc68\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\ud83d[\udc66\udc67]|\ud83d\udc6f\u200d\u2640\ufe0f|\ud83d\udc6f\u200d\u2642\ufe0f|\ud83d\ude2e\u200d\ud83d\udca8|\ud83d\ude35\u200d\ud83d\udcab|\ud83d\ude42\u200d\u2194\ufe0f|\ud83d\ude42\u200d\u2195\ufe0f|\ud83e\udd3c\u200d\u2640\ufe0f|\ud83e\udd3c\u200d\u2642\ufe0f|\ud83e\uddd1\u200d\ud83e\uddd2|\ud83e\uddde\u200d\u2640\ufe0f|\ud83e\uddde\u200d\u2642\ufe0f|\ud83e\udddf\u200d\u2640\ufe0f|\ud83e\udddf\u200d\u2642\ufe0f|\ud83d\udc08\u200d\u2b1b|\ud83d\udc26\u200d\u2b1b)|[#*0-9]\ufe0f?\u20e3|(?:[©®\u2122\u265f]\ufe0f)|(?:\ud83c[\udc04\udd70\udd71\udd7e\udd7f\ude02\ude1a\ude2f\ude37\udf21\udf24-\udf2c\udf36\udf7d\udf96\udf97\udf99-\udf9b\udf9e\udf9f\udfcd\udfce\udfd4-\udfdf\udff3\udff5\udff7]|\ud83d[\udc3f\udc41\udcfd\udd49\udd4a\udd6f\udd70\udd73\udd76-\udd79\udd87\udd8a-\udd8d\udda5\udda8\uddb1\uddb2\uddbc\uddc2-\uddc4\uddd1-\uddd3\udddc-\uddde\udde1\udde3\udde8\uddef\uddf3\uddfa\udecb\udecd-\udecf\udee0-\udee5\udee9\udef0\udef3]|[\u203c\u2049\u2139\u2194-\u2199\u21a9\u21aa\u231a\u231b\u2328\u23cf\u23ed-\u23ef\u23f1\u23f2\u23f8-\u23fa\u24c2\u25aa\u25ab\u25b6\u25c0\u25fb-\u25fe\u2600-\u2604\u260e\u2611\u2614\u2615\u2618\u2620\u2622\u2623\u2626\u262a\u262e\u262f\u2638-\u263a\u2640\u2642\u2648-\u2653\u2660\u2663\u2665\u2666\u2668\u267b\u267f\u2692-\u2697\u2699\u269b\u269c\u26a0\u26a1\u26a7\u26aa\u26ab\u26b0\u26b1\u26bd\u26be\u26c4\u26c5\u26c8\u26cf\u26d1\u26d3\u26d4\u26e9\u26ea\u26f0-\u26f5\u26f8\u26fa\u26fd\u2702\u2708\u2709\u270f\u2712\u2714\u2716\u271d\u2721\u2733\u2734\u2744\u2747\u2757\u2763\u2764\u27a1\u2934\u2935\u2b05-\u2b07\u2b1b\u2b1c\u2b50\u2b55\u3030\u303d\u3297\u3299])(?:\ufe0f|(?!\ufe0e))|(?:(?:\ud83c[\udfcb\udfcc]|\ud83d[\udd74\udd75\udd90]|\ud83e\udef0|[\u261d\u26f7\u26f9\u270c\u270d])(?:\ufe0f|(?!\ufe0e))|(?:\ud83c\udfc3|\ud83d\udeb6|\ud83e\uddce)(?:\ud83c[\udffb-\udfff])?(?:\u200d\u27a1\ufe0f)?|(?:\ud83c[\udf85\udfc2\udfc4\udfc7\udfca]|\ud83d[\udc42\udc43\udc46-\udc50\udc66-\udc69\udc6e\udc70-\udc78\udc7c\udc81-\udc83\udc85-\udc87\udcaa\udd7a\udd95\udd96\ude45-\ude47\ude4b-\ude4f\udea3\udeb4\udeb5\udec0\udecc]|\ud83e[\udd0c\udd0f\udd18-\udd1c\udd1e\udd1f\udd26\udd30-\udd39\udd3d\udd3e\udd77\uddb5\uddb6\uddb8\uddb9\uddbb\uddcd\uddcf\uddd1-\udddd\udec3-\udec5\udef1-\udef8]|[\u270a\u270b]))(?:\ud83c[\udffb-\udfff])?|(?:\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f|\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc73\udb40\udc63\udb40\udc74\udb40\udc7f|\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc77\udb40\udc6c\udb40\udc73\udb40\udc7f|\ud83c\udde6\ud83c[\udde8-\uddec\uddee\uddf1\uddf2\uddf4\uddf6-\uddfa\uddfc\uddfd\uddff]|\ud83c\udde7\ud83c[\udde6\udde7\udde9-\uddef\uddf1-\uddf4\uddf6-\uddf9\uddfb\uddfc\uddfe\uddff]|\ud83c\udde8\ud83c[\udde6\udde8\udde9\uddeb-\uddee\uddf0-\uddf5\uddf7\uddfa-\uddff]|\ud83c\udde9\ud83c[\uddea\uddec\uddef\uddf0\uddf2\uddf4\uddff]|\ud83c\uddea\ud83c[\udde6\udde8\uddea\uddec\udded\uddf7-\uddfa]|\ud83c\uddeb\ud83c[\uddee-\uddf0\uddf2\uddf4\uddf7]|\ud83c\uddec\ud83c[\udde6\udde7\udde9-\uddee\uddf1-\uddf3\uddf5-\uddfa\uddfc\uddfe]|\ud83c\udded\ud83c[\uddf0\uddf2\uddf3\uddf7\uddf9\uddfa]|\ud83c\uddee\ud83c[\udde8-\uddea\uddf1-\uddf4\uddf6-\uddf9]|\ud83c\uddef\ud83c[\uddea\uddf2\uddf4\uddf5]|\ud83c\uddf0\ud83c[\uddea\uddec-\uddee\uddf2\uddf3\uddf5\uddf7\uddfc\uddfe\uddff]|\ud83c\uddf1\ud83c[\udde6-\udde8\uddee\uddf0\uddf7-\uddfb\uddfe]|\ud83c\uddf2\ud83c[\udde6\udde8-\udded\uddf0-\uddff]|\ud83c\uddf3\ud83c[\udde6\udde8\uddea-\uddec\uddee\uddf1\uddf4\uddf5\uddf7\uddfa\uddff]|\ud83c\uddf4\ud83c\uddf2|\ud83c\uddf5\ud83c[\udde6\uddea-\udded\uddf0-\uddf3\uddf7-\uddf9\uddfc\uddfe]|\ud83c\uddf6\ud83c\udde6|\ud83c\uddf7\ud83c[\uddea\uddf4\uddf8\uddfa\uddfc]|\ud83c\uddf8\ud83c[\udde6-\uddea\uddec-\uddf4\uddf7-\uddf9\uddfb\uddfd-\uddff]|\ud83c\uddf9\ud83c[\udde6\udde8\udde9\uddeb-\udded\uddef-\uddf4\uddf7\uddf9\uddfb\uddfc\uddff]|\ud83c\uddfa\ud83c[\udde6\uddec\uddf2\uddf3\uddf8\uddfe\uddff]|\ud83c\uddfb\ud83c[\udde6\udde8\uddea\uddec\uddee\uddf3\uddfa]|\ud83c\uddfc\ud83c[\uddeb\uddf8]|\ud83c\uddfd\ud83c\uddf0|\ud83c\uddfe\ud83c[\uddea\uddf9]|\ud83c\uddff\ud83c[\udde6\uddf2\uddfc]|\ud83c[\udccf\udd8e\udd91-\udd9a\udde6-\uddff\ude01\ude32-\ude36\ude38-\ude3a\ude50\ude51\udf00-\udf20\udf2d-\udf35\udf37-\udf7c\udf7e-\udf84\udf86-\udf93\udfa0-\udfc1\udfc5\udfc6\udfc8\udfc9\udfcf-\udfd3\udfe0-\udff0\udff4\udff8-\udfff]|\ud83d[\udc00-\udc3e\udc40\udc44\udc45\udc51-\udc65\udc6a\udc6f\udc79-\udc7b\udc7d-\udc80\udc84\udc88-\udc8e\udc90\udc92-\udca9\udcab-\udcfc\udcff-\udd3d\udd4b-\udd4e\udd50-\udd67\udda4\uddfb-\ude44\ude48-\ude4a\ude80-\udea2\udea4-\udeb3\udeb7-\udebf\udec1-\udec5\uded0-\uded2\uded5-\uded7\udedc-\udedf\udeeb\udeec\udef4-\udefc\udfe0-\udfeb\udff0]|\ud83e[\udd0d\udd0e\udd10-\udd17\udd20-\udd25\udd27-\udd2f\udd3a\udd3c\udd3f-\udd45\udd47-\udd76\udd78-\uddb4\uddb7\uddba\uddbc-\uddcc\uddd0\uddde-\uddff\ude70-\ude7c\ude80-\ude88\ude90-\udebd\udebf-\udec2\udece-\udedb\udee0-\udee8]|[\u23e9-\u23ec\u23f0\u23f3\u267e\u26ce\u2705\u2728\u274c\u274e\u2753-\u2755\u2795-\u2797\u27b0\u27bf\ue50a])|\ufe0f/g,r=/\uFE0F/g,s=String.fromCharCode(8205),i=/[&<>'"]/g,o=/^(?:iframe|noframes|noscript|script|select|style|textarea)$/,l=String.fromCharCode;return t;function c(k,E){return document.createTextNode(E?k.replace(r,""):k)}function u(k){return k.replace(i,w)}function d(k,E){return"".concat(E.base,E.size,"/",k,E.ext)}function f(k,E){for(var I=k.childNodes,C=I.length,A,D;C--;)A=I[C],D=A.nodeType,D===3?E.push(A):D===1&&!("ownerSVGElement"in A)&&!o.test(A.nodeName.toLowerCase())&&f(A,E);return E}function p(k){return M(k.indexOf(s)<0?k.replace(r,""):k)}function g(k,E){for(var I=f(k,[]),C=I.length,A,D,P,ee,_e,He,Be,B,K,X,he,pe,Ie;C--;){for(P=!1,ee=document.createDocumentFragment(),_e=I[C],He=_e.nodeValue,B=0;Be=n.exec(He);){if(K=Be.index,K!==B&&ee.appendChild(c(He.slice(B,K),!0)),he=Be[0],pe=p(he),B=K+he.length,Ie=E.callback(pe,E),pe&&Ie){X=new Image,X.onerror=E.onerror,X.setAttribute("draggable","false"),A=E.attributes(he,pe);for(D in A)A.hasOwnProperty(D)&&D.indexOf("on")!==0&&!X.hasAttribute(D)&&X.setAttribute(D,A[D]);X.className=E.className,X.alt=he,X.src=Ie,P=!0,ee.appendChild(X)}X||ee.appendChild(c(he,!1)),X=null}P&&(B<He.length&&ee.appendChild(c(He.slice(B),!0)),_e.parentNode.replaceChild(ee,_e))}return k}function x(k,E){return T(k,function(I){var C=I,A=p(I),D=E.callback(A,E),P,ee;if(A&&D){C="<img ".concat('class="',E.className,'" ','draggable="false" ','alt="',I,'"',' src="',D,'"'),P=E.attributes(I,A);for(ee in P)P.hasOwnProperty(ee)&&ee.indexOf("on")!==0&&C.indexOf(" "+ee+"=")===-1&&(C=C.concat(" ",ee,'="',u(P[ee]),'"'));C=C.concat("/>")}return C})}function w(k){return e[k]}function v(){return null}function _(k){return typeof k=="number"?k+"x"+k:k}function b(k){var E=typeof k=="string"?parseInt(k,16):k;return E<65536?l(E):(E-=65536,l(55296+(E>>10),56320+(E&1023)))}function j(k,E){return(!E||typeof E=="function")&&(E={callback:E}),(typeof k=="string"?x:g)(k,{callback:E.callback||d,attributes:typeof E.attributes=="function"?E.attributes:v,base:typeof E.base=="string"?E.base:t.base,ext:E.ext||t.ext,size:E.folder||_(E.size||t.size),className:E.className||t.className,onerror:E.onerror||t.onerror})}function T(k,E){return String(k).replace(n,E)}function R(k){n.lastIndex=0;var E=n.test(k);return n.lastIndex=0,E}function M(k,E){for(var I=[],C=0,A=0,D=0;D<k.length;)C=k.charCodeAt(D++),A?(I.push((65536+(A-55296<<10)+(C-56320)).toString(16)),A=0):55296<=C&&C<=56319?A=C:I.push(C.toString(16));return I.join(E||"-")}}();const oH=Object.freeze(Object.defineProperty({__proto__:null,default:aH},Symbol.toStringTag,{value:"Module"})),lH=gA(oH);(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var e=i(eH),n=i(h),r=i(iH),s=i(lH);function i(T){return T&&T.__esModule?T:{default:T}}function o(T){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?o=function(M){return typeof M}:o=function(M){return M&&typeof Symbol=="function"&&M.constructor===Symbol&&M!==Symbol.prototype?"symbol":typeof M},o(T)}function l(T){for(var R=1;R<arguments.length;R++){var M=arguments[R]!=null?arguments[R]:{},k=Object.keys(M);typeof Object.getOwnPropertySymbols=="function"&&(k=k.concat(Object.getOwnPropertySymbols(M).filter(function(E){return Object.getOwnPropertyDescriptor(M,E).enumerable}))),k.forEach(function(E){b(T,E,M[E])})}return T}function c(T,R){if(T==null)return{};var M=u(T,R),k,E;if(Object.getOwnPropertySymbols){var I=Object.getOwnPropertySymbols(T);for(E=0;E<I.length;E++)k=I[E],!(R.indexOf(k)>=0)&&Object.prototype.propertyIsEnumerable.call(T,k)&&(M[k]=T[k])}return M}function u(T,R){if(T==null)return{};var M={},k=Object.keys(T),E,I;for(I=0;I<k.length;I++)E=k[I],!(R.indexOf(E)>=0)&&(M[E]=T[E]);return M}function d(T,R){if(!(T instanceof R))throw new TypeError("Cannot call a class as a function")}function f(T,R){for(var M=0;M<R.length;M++){var k=R[M];k.enumerable=k.enumerable||!1,k.configurable=!0,"value"in k&&(k.writable=!0),Object.defineProperty(T,k.key,k)}}function p(T,R,M){return R&&f(T.prototype,R),M&&f(T,M),T}function g(T,R){return R&&(o(R)==="object"||typeof R=="function")?R:x(T)}function x(T){if(T===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return T}function w(T){return w=Object.setPrototypeOf?Object.getPrototypeOf:function(M){return M.__proto__||Object.getPrototypeOf(M)},w(T)}function v(T,R){if(typeof R!="function"&&R!==null)throw new TypeError("Super expression must either be null or a function");T.prototype=Object.create(R&&R.prototype,{constructor:{value:T,writable:!0,configurable:!0}}),R&&_(T,R)}function _(T,R){return _=Object.setPrototypeOf||function(k,E){return k.__proto__=E,k},_(T,R)}function b(T,R,M){return R in T?Object.defineProperty(T,R,{value:M,enumerable:!0,configurable:!0,writable:!0}):T[R]=M,T}var j=function(T){v(R,T);function R(M){var k;return d(this,R),k=g(this,w(R).call(this,M)),M.noWrapper?k.childrenRefs={}:k.rootRef=n.default.createRef(),k}return p(R,[{key:"_parseTwemoji",value:function(){var k=this.props.noWrapper;if(k)for(var E in this.childrenRefs){var I=this.childrenRefs[E].current;s.default.parse(I,this.props.options)}else{var C=this.rootRef.current;s.default.parse(C,this.props.options)}}},{key:"componentDidUpdate",value:function(k){(0,e.default)(this.props,k)||this._parseTwemoji()}},{key:"componentDidMount",value:function(){this._parseTwemoji()}},{key:"render",value:function(){var k=this,E=this.props,I=E.children,C=E.noWrapper,A=E.tag,D=c(E,["children","noWrapper","tag"]);return C?n.default.createElement(n.default.Fragment,null,n.default.Children.map(I,function(P,ee){return typeof P=="string"?(console.warn(`Twemoji can't parse string child when noWrapper is set. Skipping child "`.concat(P,'"')),P):(k.childrenRefs[ee]=k.childrenRefs[ee]||n.default.createRef(),n.default.cloneElement(P,{ref:k.childrenRefs[ee]}))})):(delete D.options,n.default.createElement(A,l({ref:this.rootRef},D),I))}}]),R}(n.default.Component);t.default=j,b(j,"propTypes",{children:r.default.node,noWrapper:r.default.bool,options:r.default.object,tag:r.default.string}),b(j,"defaultProps",{tag:"div"})})(C5);const P5=Pv(C5),cH=Bc("[&_img]:mr-[2px] [&_img]:inline",{variants:{size:{6:"[&_img]:w-6",5:"[&_img]:w-5",4:"[&_img]:w-4",3:"[&_img]:w-3"},align:{bottom:"[&_img]:align-text-bottom",clear:""}},defaultVariants:{size:"5",align:"bottom"}});function Ac({className:t="",size:e,children:n,align:r}){return a.jsx("p",{className:cH({size:e,align:r,className:t}),children:a.jsx(P5,{tag:"span",children:n})})}const a_="data:image/gif;base64,R0lGODlhJAAkAIABAP///////yH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQ4IDc5LjE2NDAzNiwgMjAxOS8wOC8xMy0wMTowNjo1NyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo0NmRjOGMyNC03YmYxLTQxZTMtYjQ2Zi1mY2ZhMDk4MDE1YWYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MTBDRTc0QzlGNDBEMTFFQTk4NDZENjI0QzI1MENFQzgiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MTBDRTc0QzhGNDBEMTFFQTk4NDZENjI0QzI1MENFQzgiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6YzBhNGU4OWYtNjc4Yy00NmMyLTg4NmUtYzIxNGE0NTIwZDRjIiBzdFJlZjpkb2N1bWVudElEPSJhZG9iZTpkb2NpZDpwaG90b3Nob3A6ODRlMDBjYmEtZjhlNy03YzQ4LWE4MTgtNDc3NTI3MGQ1ZTAyIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkECQgAAQAsAAAAACQAJAAAAnKMj5nArQ9jc7HWyax+GOx/dCAojltpWmgqYazqvu0kz1StrHgYp6tO6gWAn59wZKSxkjcTM7MUEk/SY1BpmGqeHhs0W8Vywk3tkPw9iztcBLfNW7Pl9PLcXk/f8Xz9vguWB6h254Y2+Id4aLjH2Kc4UQAAIfkECQgAAQAsAAAAACQAJAAAAnSMj6nL7Q+jnAzYS+XFGW7beV/4fADpmGijrkvrJnA2z1Q9hvhG7lznA+lyBpuMGAieDiYlQulkIpvTKk9KFRatv2RW671uxeHskwv+ptHLsRnbhbLPZHW7vK6r6XF21J33Bngnp2fY98UXuNikSOg3B8dYAAAh+QQJCAABACwAAAAAJAAkAAACfIyPqcvtD6OctNqLKdg8N955C7iJI4mQAKam6NUeMTMHda3cr4EnOugCfnY2Yi8Y4hmXKqHSWYQ2mclodSqllmTY7fOqbSK9VnLXHB6Ludk2Vg1nv+Vo9zT+rc/zK3qf/wNmt8aHV0Z4aHj2l+inFqgXiQjJuKgYRnkJUgAAIfkECQgAAQAsAAAAACQAJAAAAnuMj6nL7Q+jnLTaC7K+T2/eeBkYiiQjAlyKsJh5uJYc0BRtTzgMpbsn8fFqQ4cQGCuWjqok0vA7toZR4fRJxDJHzg+Uur16s+Nt86sFM8VcdDncbZPlZvZ5fq/H82rp3m5XxZe29mfoZnWIF9hH1+gDqKiHOPhWSBlJWQAAIfkECQgAAQAsAAAAACQAJAAAAn6Mj6nL7Q8RmDTaQ+u1eW7efVg4ZqLRARIppqsZpW6pQTIbzPZd57jD6+keQQ/NuAu+esDiEkl0HlUxKerXKFKvsCTvuY0qp2Dw8IzTlslTdNf3VrO5Qiu8Hre78d/5HSpHB5imR5g3Jhi2d7OWaGbIN4j4pwjJ6Lco00gJVgAAIfkECQgAAQAsAAAAACQAJAAAAn2EH6nL7XnQmxRGULO7WHsbfRPHiQ95mRsqqQvbBqUGG29K13eYw3tMqXVAwJFOMcsIf7YeizmsLJE45ZHYtPqoPO2TWzxdZVXpOGneYqPBc7mtJnflsekaCkXry3Z61h/VtzcnyGcYN1jnRnj4dQf2V8g46QiIB0ly+bhWAAAh+QQJCAABACwAAAAAJAAkAAACfYyPqcvtD+MDtMobqt6Y7Q90C8iJCamZJ0qpCNu6Bhwen0S/JZTb+wTTpSK92c9RzBwbyRsx6BvyoEYpkCW0RLVVVDbWBSuxW7EzDPrW0OrzmPs2U+Nrevvnzs/11ib+T8ZWVufXB+g1qHZnyAhX6HhIopg4yAfZKEkpiFYAACH5BAkIAAEALAAAAAAkACQAAAJ7jI+py+0Po5y02ouB3tht3jGfFopjuYwqgK5npCLuJ8XHDEK2gZP3ywMGeqwfzZgb9mTCnRLHPAalz1k06SRefVPsEsmthrXgYnf8PZvFa7J6206z4fBs8w4t08t2at+qF6j2h+YnRxiX9ybIhrg3iOdlqDjH6Fa5qFYAACH5BAkIAAEALAAAAAAkACQAAAJ1jI+py+0Po5y02otzArxr1nmfEnIjWZ5bqh4l0Lqs8WK1HNpzcFs9/9o5fkFhg1gUQZBJWISZlECL0l3ThFMCc1lq10mzXhFT8Db6JYubam7Yffa+teVymz5O6+fyuLm+hgd39ReIxRd0d+inmLjH+GX3+FIAACH5BAUIAAEALAAAAAAkACQAAAJwjI+py+0Po5y0PoCzhVlv12EfGI5NCJgMqi5sm7zwIc9BPeOw3vKqb6oBLyUaqshB3o4diZDpSTaN0FTkWUVgo8sslbtlapXh43hqKJfP4Ko1TY574ehue24XffV0KJuf9xa4tifoZih351f4h9hRAAA7",Od=t=>{const e=(t.variant==="image"||t.variant==="link")&&a.jsxs(_h,{className:"pt-[100%] rounded-lg overflow-hidden",children:[a.jsx(De,{className:`hover:scale-[1.05] duration-[.3s] transition-transform object-cover ${t.active?"brightness-[90%]":""}`,src:t.data.image_url,blurHashEncode:t.data.blurhash_encode}),t.active&&a.jsx(Ye,{children:a.jsx("img",{src:a_,alt:"",className:"w-[30px]"})})]});return(()=>{switch(t.variant){case"skeleton":return a.jsxs("div",{className:"p-3 w-1/2 sm:w-1/3 md:w-1/4",children:[a.jsx(we,{className:"pt-[100%] rounded-lg"}),a.jsx(we,{className:"h-[21px] mt-1.5 w-3/4"}),a.jsx(we,{className:"h-[13px] mt-1 w-3/4"})]});case"link":return a.jsxs("div",{className:"p-3 w-1/2 sm:w-1/3 md:w-1/4",children:[a.jsx(se,{onClick:()=>t.onClick&&t.onClick(),to:`${t.link||"/playlist/"+t.data.id}`,children:e}),a.jsx("p",{className:"font-semibold leading-[1.3] line-clamp-1 mt-1.5",children:t.data.name}),a.jsx("p",{className:"text-sm item-info leading-[1.3] line-clamp-1",children:t.data.is_album?t.data.singers[0].name:t.data.distributor})]});case"image":return e}})()};function uH({openModal:t}){const e=n=>{t(n)};return a.jsx(a.Fragment,{children:a.jsx(cr,{className:"w-[200px] px-2",children:a.jsxs(ls,{className:"[&>button]:rounded-md",children:[a.jsxs("button",{className:"",onClick:()=>e("theme"),children:[a.jsx(RT,{}),a.jsx("span",{children:"Themes"})]}),a.jsxs("button",{onClick:()=>e("info"),children:[a.jsx(iF,{}),a.jsx("span",{children:"Info"})]})]})})})}const dH=({data:t,active:e,onClick:n,hasTitle:r,classNames:s="",idleClass:i=""},o)=>{const l={container:"flex flex-col",imageFrame:"group relative transition-[width] duration-[.3s] origin-center rounded-xl overflow-hidden",image:"select-none object-cover object-center rounded w-full",overlay:`absolute  ${e?"":"inset-0 hidden bg-black/40 items-center justify-center"}   group-hover:flex`,playingGifFrame:"absolute h-[30px] w-[30px] bottom-[15px] left-[15px] -z-1"};if(t)return a.jsxs("div",{ref:o,"queue-id":t.queue_id,className:`song-thumb ${e?"active":""} ${l.container} ${i}`,children:[a.jsx("div",{className:`${s} flex items-end justify-center flex-shrink-0 w-[350px] h-[350px] min-[1536px]:w-[450px] min-[1536px]:h-[450px] `,children:a.jsxs("div",{className:`border-[4px] rounded-[6px] overflow-hidden border-transparent ${l.imageFrame} ${e?"w-[350px] min-[1536px]:w-[450px]":"w-[280px] min-[1536px]:w-[330px]"}`,children:[a.jsx(De,{fallback:Nc.image,src:t.image_url||Nc.image,blurHashEncode:t.blurhash_encode}),a.jsx("div",{className:`${l.overlay}`,children:!e&&a.jsx(ce,{onClick:n,variant:"circle",hover:"scale",size:"clear",className:"p-2 hover:bg-[#fff]/10",children:a.jsx(bF,{className:"w-10"})})}),e&&a.jsx("div",{className:l.playingGifFrame,children:a.jsx("img",{src:a_,alt:""})})]})}),r&&a.jsxs("div",{className:"text-center font-bold",children:[a.jsx("p",{className:"text-ellipsis line-clamp-1 text-lg",children:(t==null?void 0:t.name)||"Some song"}),a.jsx("p",{className:"opacity-70 line-clamp-1 text-sm",children:t.singers.map((c,u)=>a.jsxs("span",{children:[!!u&&", ",c.name]},u))})]})]})},px=h.forwardRef(dH);function ru({className:t="",playlists:e,loading:n,skeNumber:r=2,whenEmpty:s,onClick:i}){const{currentSongData:o}=fe(rt),l=()=>e.length?e.map((c,u)=>{const d=o==null?void 0:o.song.queue_id.includes(c.id);return a.jsx(Od,{variant:"link",active:d,data:c,onClick:()=>i&&i(c)},u)}):s||a.jsx(Fe,{variant:"less",className:"mx-auto"});return a.jsx(a.Fragment,{children:a.jsxs("div",{className:`${!n&&!e.length?"":"flex flex-row flex-wrap -mx-3"} ${t}`,children:[n&&[...Array(r).keys()].map(c=>a.jsx(Od,{variant:"skeleton"},c)),!n&&l()]})})}function F5(){const{playerConfig:{isCrossFade:t,songImage:e,isEnableBeat:n,lyricSize:r,songBackground:s},updatePlayerConfig:i,audioRef:o,shouldSyncSongDuration:l}=lt(),{currentSongData:c}=fe(rt),u=g=>{i({lyricSize:g}),ot("lyricSize",g)},d=()=>{if(!o.current||!(c!=null&&c.song))return;const g=!n,x=o.current.currentTime;ot("current_time",x),l.current=!0,o.current.src=g?c.song.beat_url:c.song.song_url,i({isEnableBeat:g})},f=g=>g===r?"bg-[--primary-cl]":"bg-[--a-5-cl]",p={disableBtn:"bg-white/10 bg-opacity-20",lyricSizeBtn:"justify-center rounded-full hover:bg-[--a-10-cl]  font-[600] h-[30px] w-[30px] sm:h-[26px] sm:w-[26px] relative",itemContainer:"justify-between min-h-[30px]",text:"text-sm"};return a.jsx(a.Fragment,{children:a.jsx(cr,{colorClasses:"bg-[#333] text-white",className:"w-[240px] sm:w-[290px]",children:a.jsxs(ls,{dismiss:!1,children:[a.jsxs("div",{className:`${p.itemContainer}`,children:[a.jsx("p",{className:p.text,children:"Lyric size"}),a.jsxs("div",{className:"flex space-x-[8px]",children:[a.jsx("button",{onClick:()=>u("small"),className:`${f("small")} ${p.lyricSizeBtn}`,children:a.jsx("span",{className:"leading-[1] text-[11px]",children:"A"})}),a.jsx("button",{onClick:()=>u("medium"),className:`${f("medium")} ${p.lyricSizeBtn}`,children:a.jsx("span",{className:"leading-[1] text-[13px]",children:"A"})}),a.jsx("button",{onClick:()=>u("large"),className:`${f("large")} ${p.lyricSizeBtn}`,children:a.jsx("span",{className:"leading-[1] text-[15px]",children:"A"})})]})]}),a.jsxs("div",{className:`${p.itemContainer}`,children:[a.jsx("p",{className:p.text,children:"Background"}),a.jsx(Ql,{size:"thin",active:s,cb:()=>i({songBackground:!s})})]}),a.jsxs("div",{className:`${p.itemContainer}`,children:[a.jsx("p",{className:p.text,children:"Song image"}),a.jsx(Ql,{size:"thin",active:e,cb:()=>i({songImage:!e})})]}),(c==null?void 0:c.song.beat_url)&&a.jsxs("div",{className:`${p.itemContainer}`,children:[a.jsx("p",{className:p.text,children:"Instrumental"}),a.jsx(Ql,{size:"thin",active:n,cb:d})]}),a.jsxs("div",{className:`${p.itemContainer}`,children:[a.jsx("p",{className:p.text,children:"Cross fade"}),a.jsx(Ql,{size:"thin",active:t,cb:()=>i({isCrossFade:!t})})]})]})})})}function hH({children:t,className:e="px-2 py-1 text-sm font-[500]",position:n="bottom-[calc(100%+8px)]",content:r,colorClasses:s="bg-[--popup-cl] text-[--text-cl]",isWrapped:i,...o},l){const[c,u]=h.useState(!1),{setTriggerRef:d,state:f}=eu(),{onClick:p}=o,g=h.useRef(null),x=()=>{"ontouchstart"in document.documentElement||u(!0)},w=()=>{u(!1)};h.useEffect(()=>{const b=g.current;if(b)return d&&d(b),b.addEventListener("mouseenter",x),b.addEventListener("mouseleave",w),()=>{b.removeEventListener("mouseenter",x),b.removeEventListener("mouseleave",w)}},[]);const v={container:"popup-shadow font-bold text-sm absolute whitespace-nowrap -translate-x-1/2 left-1/2 rounded-md z-[999]"},_=a.jsx(a.Fragment,{children:h.isValidElement(t)&&a.jsxs(a.Fragment,{children:[Object.keys(o).length?h.cloneElement(t,{ref:g,onClick:p}):h.cloneElement(t,{ref:g}),!(f!=null&&f.isOpen)&&c&&a.jsx("div",{className:`${v.container} ${s} ${n} ${e}`,children:r})]})});if(h.isValidElement(t))return a.jsx(a.Fragment,{children:i?_:a.jsx("div",{className:"relative",children:_})})}const Fi=h.forwardRef(hH);function o_(){const{setSuccessToast:t}=ne(),e=()=>{navigator.clipboard.writeText(location.href),t("Link copied")};return a.jsxs("button",{onClick:e,children:[a.jsx(lF,{}),a.jsx("span",{children:"Copy link"})]})}function eE(t){return a.jsxs("div",{className:"p-3",children:[t.variant==="skeleton"&&a.jsxs(a.Fragment,{children:[a.jsx(we,{className:"pt-[100%] rounded-full"}),a.jsx(we,{className:"mt-1 w-full h-[24px]"})]}),t.variant==="singer-item"&&a.jsxs(a.Fragment,{children:[a.jsx(se,{onClick:t.onClick,to:`/singer/${t.singer.id}`,children:a.jsx("div",{className:"aspect-[1/1] rounded-full overflow-hidden",children:a.jsx(De,{blurHashEncode:t.singer.blurhash_encode,src:t.singer.image_url,className:"hover:scale-[1.05] transition-transform"})})}),a.jsx("p",{className:"mt-1 text-center font-bold",children:t.singer.name})]})]})}function M5({isOpenLyricTabs:t,children:e}){const{currentSongData:n}=fe(rt),{playStatus:r}=fe(lr),{setLoading:s,shouldGetLyric:i,setSongLyrics:o}=Fw(),l=h.useRef(),{getLyric:c}=f5({setLoadingFromParent:s}),u=async f=>{if(f.lyric_id){const p=await c(f);p&&o(JSON.parse(p==null?void 0:p.lyrics))}else await ss(300),s(!1)},d=()=>{clearTimeout(l.current),i.current=!0,s(!0),o([])};return h.useEffect(()=>{if(t&&(n!=null&&n.song)&&i.current){if(i.current=!1,r==="error"){s(!1);return}l.current=setTimeout(()=>u(n.song),500)}},[t,n==null?void 0:n.song.id,r]),h.useEffect(()=>()=>{d()},[n==null?void 0:n.song.id]),e}function ta(){const t={container:"pt-[30px] pb-[calc(127px+30px)] md:mt-auto md:pb-[120px]",copyRightText:"text-xs font-semibold text-center md:text-right"};return a.jsx("div",{className:`${t.container}`,children:a.jsxs(Ac,{size:"4",className:t.copyRightText,children:["Make with ❤️ by"," ",a.jsx("a",{className:"underline",href:"https://dat-nguyen.vercel.app",target:"_blank",children:"Nguyen Huu Dat"})," ",a.jsx("br",{})," © 2025"]})})}function D5({category_ids:t}){const[e,n]=h.useState([]),[r,s]=h.useState(!0),i=h.useRef(!1),o=async()=>{try{if(!t.length)return;s(!0);const l=Ee(Mt(de,"Categories"),ae(ci(),"in",t)),c=await tn(l);if(!c.empty){const u=c.docs.map(d=>({...d.data(),id:d.id}));n(u)}}catch(l){console.log(l)}finally{s(!1)}};return h.useEffect(()=>{i.current||(i.current=!0,o())},[]),{categories:e,isFetching:r}}function fH({autoPlay:t,images:e}){const[n,r]=h.useState(0);h.useEffect(()=>{if(!t||e.length<=1)return;const l=setInterval(()=>{r(c=>c===e.length-1?0:c+1)},5e3);return()=>clearInterval(l)},[t,5e3,e.length]),h.useEffect(()=>{const l=c=>{c.key==="ArrowLeft"?s():c.key==="ArrowRight"&&i()};return window.addEventListener("keydown",l),()=>window.removeEventListener("keydown",l)},[]);const s=()=>{r(l=>l===0?e.length-1:l-1)},i=()=>{r(l=>l===e.length-1?0:l+1)};return{next:i,previous:s,goToSlide:l=>{r(l)},currentIndex:n,setCurrentIndex:r}}function mH({images:t,autoPlay:e=!1}){const{next:n,previous:r,currentIndex:s}=fH({images:t,autoPlay:e});return!t||t.length===0?a.jsx(De,{className:""}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"flex transition-transform duration-500 ease-in-out h-full",style:{transform:`translateX(-${s*100}%)`},children:t.map((i,o)=>a.jsx(se,{to:i.link||"",className:"w-full h-full flex-shrink-0",children:a.jsx(De,{src:i.imageUrl,blurHashEncode:i.hash,className:"h-full object-cover"})},o))}),t.length>1&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"absolute left-4 top-1/2 transform -translate-y-1/2",children:a.jsx("button",{className:"p-1.5 rounded-full bg-black/50",onClick:r,"aria-label":"Previous image",children:a.jsx(L1,{className:"w-6 text-white"})})}),a.jsx("div",{className:"absolute right-4 top-1/2 transform -translate-y-1/2",children:a.jsx("button",{className:"p-1.5 rounded-full bg-black/50",onClick:n,"aria-label":"Next image",children:a.jsx(Ju,{className:"w-6 text-white"})})})]})]})}function L5({categoryIds:t}){const{isFetching:e,categories:n}=D5({category_ids:t}),r=h.useMemo(()=>{const s=[];return t.forEach(i=>{const o=n.find(l=>l.id===i);o&&s.push(o)}),s},[n]);return e?a.jsx(we,{className:"pt-[25%] rounded-lg"}):n.length?a.jsx(_h,{className:"pt-[25%] overflow-hidden rounded-lg",children:a.jsx(mH,{className:"h-full",images:r.map(s=>({imageUrl:s.banner_image_url,link:`/category/${s.id}`,hash:s.banner_blurhash_encode}))})}):a.jsx(a.Fragment,{})}function l_({playlistIds:t,title:e}){const[n,r]=h.useState([]),{isFetching:s}=t_({setPlaylists:r,playlistIds:t});return s?a.jsx("div",{className:"flex flex-row flex-wrap -mx-3",children:[...Array(4).keys()].map(i=>a.jsx(Od,{variant:"skeleton"},i))}):n.length?a.jsx(a.Fragment,{children:a.jsxs("div",{children:[e&&a.jsx(oe,{variant:"h2",title:e}),a.jsx(ru,{loading:s,playlists:n})]})}):a.jsx(a.Fragment,{})}function O5(){const{setCategoryPage:t,setHomePage:e,shouldFetch:n}=qn(),[r,s]=h.useState(!0),i=h.useRef(!1),o=async()=>{try{s(!0);const l={category_ids:"",category_sections:[],playlist_sections:[],updated_at:""},[c,u]=await Promise.all([en({collectionName:"Page_Config",id:"category",msg:"Get category config"}),en({collectionName:"Page_Config",id:"home",msg:"Get home config"})]);t(c.exists()?c.data():l),e(u.exists()?u.data():l)}catch(l){console.log(l)}finally{s(!1)}};return h.useEffect(()=>{i.current||(i.current=!0,n.current?(n.current=!1,o()):setTimeout(()=>s(!1),100))},[]),{isFetching:r}}function pH(){const{user:t}=ye(),e={icon:"w-7 mr-2 inline",linkItem:"py-3 border-b text-lg border-[--a-5-cl] last:border-none"};return a.jsxs("div",{className:"block md:hidden",children:[a.jsx(oe,{title:"Library",className:"mb-1"}),a.jsx(mx,{to:"/trending",className:e.linkItem,icon:a.jsx(F1,{className:e.icon}),label:"Trending",arrowIcon:a.jsx(Ju,{className:"w-6"})}),a.jsx(mx,{to:"/category",className:e.linkItem,icon:a.jsx(Hp,{className:e.icon}),label:"Category",arrowIcon:a.jsx(Ju,{className:"w-6"})}),t&&a.jsx(a.Fragment,{children:a.jsx(mx,{to:"/my-music",className:e.linkItem,icon:a.jsx(qi,{className:e.icon}),label:"My Song",arrowIcon:a.jsx(Ju,{className:"w-6"})})})]})}function Mg(){const{user:t}=ye(),[e,n]=h.useState(!1);return{isFetching:e,action:async s=>{try{switch(n(!0),s){case"login":{await Oz(Ga,NB);break}case"logout":{await yz(Ga);break}}n(!1)}catch(i){throw i}finally{n(!1)}},user:t}}function gH(){const{loading:t,user:e}=ye(),n=h.useRef(null),{action:r}=Mg(),[s,i]=h.useState(""),o=()=>{var f;return(f=n.current)==null?void 0:f.toggle()},l=f=>{var p;i(f),(p=n.current)==null||p.toggle()},c=async()=>{try{await r("logout")}catch(f){console.log("signOut error",{message:f})}finally{o()}},u=h.useMemo(()=>{switch(s){case"theme":return a.jsx(aR,{closeModal:o});case"info":return a.jsx(MT,{closeModal:o});case"logout":return a.jsx(hn,{closeModal:o,callback:c,loading:!1,label:"Log out ?"})}},[s]),d={linkItem:"py-3 text-lg w-full border-b border-[--a-5-cl] space-x-2 last:border-none flex items-center",icon:"w-7"};return a.jsxs("div",{className:"md:hidden",children:[a.jsx("div",{className:"text-xl font-playwriteCU leading-[2.2] mb-3",children:"Setting"}),e&&a.jsxs("div",{className:"bg-[--a-5-cl] p-3 rounded-md flex mb-3",children:[a.jsx(gv,{className:"h-[65px] w-[65px]"}),a.jsxs("div",{className:"ml-3",children:[a.jsx("p",{className:"text-lg font-[500]",children:e.display_name}),a.jsx("p",{className:"opacity-70 font-[500]",children:"Vip member ❤️"})]})]}),t?[...Array(3).keys()].map(f=>a.jsx(qU,{},f)):a.jsxs("div",{className:"",children:[a.jsxs("button",{className:d.linkItem,onClick:()=>l("theme"),children:[a.jsx(RT,{className:d.icon}),a.jsx("span",{children:"Theme"})]}),(e==null?void 0:e.role)==="ADMIN"&&a.jsxs(se,{to:"/dashboard",className:d.linkItem,children:[a.jsx(Bp,{className:d.icon}),a.jsx("span",{children:"Dashboard"})]}),e?a.jsxs("button",{className:d.linkItem,onClick:()=>l("logout"),children:[a.jsx(ST,{className:d.icon}),a.jsx("span",{children:"Logout"})]}):a.jsxs("button",{className:d.linkItem,onClick:()=>r("login"),children:[a.jsx(bT,{className:d.icon}),a.jsx("span",{children:"Sign in"})]})]}),a.jsx(ie,{ref:n,variant:"animation",children:u})]})}function xH(){const{homePage:t}=qn(),{isFetching:e}=O5(),n=()=>e?a.jsxs(a.Fragment,{children:[a.jsx(we,{className:"pt-[25%] w-full rounded-lg"}),a.jsx("div",{className:"flex flex-row flex-wrap -mx-3",children:[...Array(4).keys()].map(r=>a.jsx(Od,{variant:"skeleton"},r))})]}):t?a.jsxs(a.Fragment,{children:[a.jsx(L5,{categoryIds:t!=null&&t.category_ids?t==null?void 0:t.category_ids.split("_"):[]}),a.jsx(pH,{}),t==null?void 0:t.playlist_sections.map((r,s)=>a.jsx(l_,{playlistIds:r.target_ids?r.target_ids.split("_"):[]},s)),a.jsx(gH,{})]}):a.jsx(Fe,{});return a.jsxs(a.Fragment,{children:[a.jsx(Za,{children:n()}),a.jsx(ta,{})]})}function yH(){const t=mn(),{setSuccessToast:e}=ne(),{selectedSongs:n,resetSelect:r}=dl(),s=()=>{t(yh({songs:n})),e(`${n.length>1?"Songs":"Song"} added to queue`),r()};return a.jsxs("button",{onClick:s,children:[a.jsx(Wt,{className:"w-5"}),a.jsx("span",{className:"",children:"Add to queue"})]})}function vH(){const{user:t}=ye(),{shouldFetchOwnPlaylists:e,setOwnPlaylists:n}=yt(),{setErrorToast:r,setSuccessToast:s}=ne(),[i,o]=h.useState(!1),l=async()=>{try{if(!t)return;const u=Ee(er,ae("owner_email","==",t.email),ae("is_official","==",!1)),d=await wr(u,"useGetMyMusicPlaylist, get user own playlists");n(d)}catch(u){console.log(u)}},c=async({songs:u,playlist:d})=>{try{o(!0);const f=[...d.song_ids];if(u.forEach(x=>{f.includes(x.id)||f.push(x.id)}),f.length===d.song_ids.length){await ss(100),s("Song added to playlist");return}const g={song_ids:f};await Re({collectionName:"Playlists",id:d.id,data:g}),e.current=!0,s("Song added to playlist")}catch(f){console.log({message:f}),r()}finally{o(!1)}};return h.useEffect(()=>{e.current&&(e.current=!1,l())},[]),{isFetching:i,addToPlaylist:c}}function $5(){const{user:t,updateUserData:e}=ye(),{ownPlaylists:n,setOwnPlaylists:r,favoritePlaylists:s,setFavoritePlaylists:i}=yt(),{setErrorToast:o,setSuccessToast:l}=ne(),{addPlaylist:c,isFetching:u}=Tg();return{isFetching:u,myMusicAddPlaylist:async(f,p)=>{try{if(!t)return;const g=await c({variant:"add",playlist:f,imageFile:p},{push:!1});if(g){const x=[...n,g],w=[...s,g],v={liked_playlist_ids:w.map(_=>_.id)};Re({collectionName:"Users",data:v,id:t.email}),e(v),r(x),i(w),l("New playlist created")}}catch(g){console.log({error:g}),o()}}}}function Dg({songs:t,closeModal:e}){const{user:n}=ye(),{ownPlaylists:r}=yt(),{addToPlaylist:s,isFetching:i}=vH(),{myMusicAddPlaylist:o,isFetching:l}=$5(),c=h.useRef(null),u=async f=>{await s({playlist:f,songs:t}),e()},d=async(f,p)=>{var g;f.song_ids=t.map(x=>x.id),await o(f,p),(g=c.current)==null||g.close(),e()};if(n)return a.jsxs(a.Fragment,{children:[a.jsxs(je,{children:[a.jsx(qe,{closeModal:e,title:"Playlists"}),a.jsx("div",{className:"flex-grow flex flex-col overflow-auto space-y-2",children:r.length?r.map((f,p)=>a.jsxs("button",{onClick:()=>u(f),className:"flex rounded-md p-2 hover:bg-[--a-5-cl]",children:[a.jsx(qi,{className:"w-5 mr-2"}),a.jsx("span",{children:f.name})]},p)):a.jsx(Fe,{variant:"less"})}),a.jsx("p",{className:"text-center",children:a.jsxs(ce,{color:"primary",className:"mt-5 rounded-full justify-center",onClick:()=>{var f;return(f=c.current)==null?void 0:f.open()},children:[a.jsx(Wt,{className:"w-5"}),a.jsx("span",{children:"Add new playlist"})]})}),i&&a.jsx(ea,{})]}),a.jsx(ie,{variant:"animation",ref:c,children:a.jsx(je,{className:"w-[600px]",children:a.jsx(Zc,{modalRef:c,submit:d,isLoading:i||l,variant:"add",user:n})})})]})}function wH(){const{selectedSongs:t,resetSelect:e}=dl(),n=h.useRef(null);return a.jsxs(a.Fragment,{children:[a.jsxs("button",{onClick:()=>{var r;return(r=n.current)==null?void 0:r.open()},children:[a.jsx("p",{className:"w-5",children:Ng}),a.jsx("span",{children:"Add to playlist"})]}),a.jsx(ie,{variant:"animation",ref:n,children:a.jsx(Dg,{closeModal:()=>{var r;(r=n.current)==null||r.close(),e()},songs:t})})]})}function Lg({children:t,selectAll:e}){const{user:n}=ye(),{isSelectAll:r,isChecked:s,resetSelect:i,selectedSongs:o}=dl(),l=a.jsxs(a.Fragment,{children:[e&&a.jsx("button",{onClick:e,className:"ml-[10px]",children:r?a.jsx(Xa,{className:"w-[20px]"}):a.jsx(z1,{className:"w-[20px]"})}),a.jsx("span",{className:"font-semibold opacity-[.5]",children:o.length}),a.jsxs("div",{className:"flex space-x-2 items-center [&>button]:bg-[--a-5-cl]  [&>button]:inline-flex [&>button]:space-x-1.5 [&_span]:text-sm [&_span]:font-medium [&>button]:py-1 [&>button]:px-3 [&>button]:rounded-full",children:[a.jsx(yH,{}),n&&a.jsx(wH,{})]}),a.jsx("button",{onClick:i,className:"flex-shrink-0",children:a.jsx(hh,{className:"w-5"})})]});return a.jsx("div",{className:"flex items-center space-x-2 h-[44px]",children:s?l:t})}function _H({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{fillRule:"evenodd",d:"M7.72 12.53a.75.75 0 010-1.06l7.5-7.5a.75.75 0 111.06 1.06L9.31 12l6.97 6.97a.75.75 0 11-1.06 1.06l-7.5-7.5z",clipRule:"evenodd"}))}const bH=h.forwardRef(_H),SH=bH;function EH({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{fillRule:"evenodd",d:"M16.28 11.47a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 01-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 011.06-1.06l7.5 7.5z",clipRule:"evenodd"}))}const jH=h.forwardRef(EH),kH=jH;function TH({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{fillRule:"evenodd",d:"M4.5 5.653c0-1.426 1.529-2.33 2.779-1.643l11.54 6.348c1.295.712 1.295 2.573 0 3.285L7.28 19.991c-1.25.687-2.779-.217-2.779-1.643V5.653z",clipRule:"evenodd"}))}const IH=h.forwardRef(TH),CH=IH;function RH({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{fillRule:"evenodd",d:"M12 3.75a.75.75 0 01.75.75v6.75h6.75a.75.75 0 010 1.5h-6.75v6.75a.75.75 0 01-1.5 0v-6.75H4.5a.75.75 0 010-1.5h6.75V4.5a.75.75 0 01.75-.75z",clipRule:"evenodd"}))}const NH=h.forwardRef(RH),AH=NH;function c_({modalRef:t,song:e}){const{user:n}=ye();return n?a.jsx(ie,{variant:"animation",ref:t,children:a.jsx(Dg,{closeModal:()=>{var r;return(r=t.current)==null?void 0:r.close()},songs:[e]})}):a.jsx(a.Fragment,{})}function u_({modalRef:t}){const{user:e}=ye();return e?a.jsxs("button",{onClick:()=>{var n;return(n=t.current)==null?void 0:n.open()},children:[a.jsx("p",{className:"",children:Ng}),a.jsx("span",{children:"Add to playlist"})]}):a.jsx(a.Fragment,{})}function PH({song:t,index:e}){const{action:n}=m5(),r=h.useRef(null),s=()=>{n({variant:"remove",index:e})};return a.jsxs(a.Fragment,{children:[a.jsxs(zg,{song:t,children:[!1,a.jsxs("button",{onClick:s,children:[a.jsx($1,{className:"w-5"}),a.jsx("span",{children:"Remove"})]}),a.jsx(u_,{modalRef:r}),a.jsxs("a",{target:"_blank",href:t.song_url,children:[a.jsx(Kd,{className:"w-5"}),a.jsx("span",{children:"Download"})]})]}),a.jsx(c_,{song:t,modalRef:r})]})}function FH({song:t,modalRef:e}){const{user:n}=ye(),{updateSong:r,shouldFetchFavoriteSongs:s}=yt(),[i,o]=h.useState({name:t.name,singer:t.singers[0].name,image_url:t.image_url}),[l,c]=h.useState(!1),[u,d]=h.useState(),{setErrorToast:f,setSuccessToast:p}=ne(),g=h.useMemo(()=>t.name!==i.name||t.singers[0].name!==i.singer,[i]),x=!!i.name&&!!i.singer&&g||u,w=(_,b)=>{o({...i,[_]:b})},v=async()=>{var _,b;try{if(!n||!x)return;c(!0),(_=e.current)==null||_.setModalPersist(!0);const{id:j,...T}=t;if(g){if(!i.name||!i.singer)return;T.name=i.name,T.singers=[{...T.singers[0],name:i.singer}]}if(u){t.image_file_id&&Vt({fileId:t.image_file_id});const M=await Yi({imageFile:u});Object.assign(T,M)}await Re({collectionName:"Songs",data:T,id:t.id}),n.liked_song_ids.includes(t.id)&&(s.current=!0),r({id:t.id,song:T}),p("Song edited"),(b=e.current)==null||b.close()}catch(j){console.log({message:j}),f()}finally{c(!1)}};return h.useEffect(()=>{var _;g&&((_=e.current)==null||_.setModalPersist(!0))},[i]),{isFetching:l,isChanged:g,songData:i,isValidToSubmit:x,handleSubmit:v,imageFile:u,setImageFile:d,handleInput:w}}function MH({song:t,modalRef:e}){const n=h.useRef(null),{isValidToSubmit:r,songData:s,setImageFile:i,isFetching:o,handleSubmit:l,handleInput:c}=FH({song:t,modalRef:e}),u=f=>{i(f),c("image_url",URL.createObjectURL(f))},d=f=>{var p;f.stopPropagation(),(p=e.current)==null||p.close()};return a.jsxs(a.Fragment,{children:[a.jsxs(je,{className:"w-[500px]",children:[a.jsx(qe,{title:"Edit song",closeModal:()=>{var f;return(f=e.current)==null?void 0:f.close()}}),a.jsxs("div",{className:"flex flex-col flex-grow overflow-auto md:overflow-hidden md:flex-row mt-5",children:[a.jsxs("div",{className:"space-y-2.5",children:[a.jsx("div",{className:"w-[200px] rounded-md overflow-hidden h-[200px] md:w-[160px] md:h-[160px] object-cover",children:a.jsx(De,{className:"object-cover h-full",src:s.image_url})}),a.jsx(ce,{onClick:()=>{var f;return(f=n.current)==null?void 0:f.open()},color:"primary",children:a.jsx(Ki,{className:"w-5"})})]}),a.jsxs("div",{className:"pt-5 md:pt-0 md:pl-5 md:flex-grow space-y-3",children:[a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(kt,{htmlFor:"name",children:"Name"}),a.jsx(En,{value:s.name,type:"text",id:"name",onChange:f=>c("name",f.target.value),placeholder:t.name})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(kt,{htmlFor:"singer",children:"Singer"}),a.jsx(En,{value:s.singer,onChange:f=>c("singer",f.target.value),type:"text",id:"singer",placeholder:t.singers[0].name})]})]})]}),a.jsxs("div",{className:"flex mt-5 space-x-2 justify-end",children:[a.jsx(ce,{onClick:d,className:"rounded-full",children:"Close"}),a.jsx(ce,{isLoading:o,onClick:l,disabled:!r,className:" rounded-full",variant:"primary",color:"primary",children:"Save"})]}),o&&a.jsx(ea,{})]}),a.jsx(ie,{variant:"animation",ref:n,children:a.jsx(ml,{setImageFile:u,modalRef:n,title:"Song image"})})]})}function Og({tab:t}){const{user:e}=ye(),{favoriteSongs:n,setUploadedSongs:r,setFavoriteSongs:s,shouldFetchUserSongs:i,shouldFetchFavoriteSongs:o}=yt(),{setErrorToast:l}=ne(),[c,u]=h.useState(!0);return{isFetching:c,getSongs:async()=>{if(e)try{switch(t){case"favorite":{if(o.current){if(o.current=!1,e.liked_song_ids.length){const p=[];for(let x=0;x<e.liked_song_ids.length;x+=20)p.push(e.liked_song_ids.slice(x,x+20));const g=[];for(const x of p)if(x.length>0){const w=Ee(fn,ae(ci(),"in",x)),v=await Cn(w,{msg:"get user favorite songs"});g.push(...v)}return s(g),g}}else return await ss(100),n;break}case"uploaded":if(i.current){i.current=!1;const f=Ee(fn,ae("owner_email","==",e.email),ae("is_official","==",!1)),p=await Cn(f,{msg:"get user uploaded songs"});r(p)}else await ss(100)}}catch(f){console.log({message:f}),l()}finally{u(!1)}}}}function $g(){const{user:t,updateUserData:e}=ye(),{setErrorToast:n,setSuccessToast:r}=ne(),{uploadedSongs:s,setUploadedSongs:i,setFavoriteSongs:o}=yt(),[l,c]=h.useState(!1),{getSongs:u}=Og({tab:"favorite"});return{loading:l,action:async f=>{try{if(c(!0),!t)throw new Error("User not found");const p=Ls(de),g=gt(de,"Users",t.email),x=gt(de,"Songs",f.song.id),w=await u(),v=w.findIndex(b=>b.id===f.song.id),_=v!==-1;switch(f.variant){case"delete":{const b=s.filter(j=>j.id!==f.song.id);if(p.delete(x),f.song.lyric_id){const j=gt(de,"Lyrics",f.song.lyric_id);p.delete(j)}if(_){w.splice(v,1);const j={liked_song_ids:w.map(T=>T.id)};p.update(g,j),o(w),e(j)}await Promise.all([p.commit(),UR(f.song)]),i(b),r(`'${f.song.name}' deleted`);break}case"like":{if(!t)return;_?w.splice(v,1):w.unshift(f.song);const b={liked_song_ids:w.map(T=>T.id)},j={like:Ai(_?-1:1)};p.update(g,b),p.update(x,j),await p.commit(),o(w),e(b);break}}}catch(p){console.log({message:p}),n()}finally{c(!1)}}}}function d_({song:t}){const{action:e}=m5(),n=()=>{e({variant:"add",songs:[t]})};return a.jsxs("button",{onClick:n,children:[a.jsx(Wt,{}),a.jsx("span",{children:"Add to queue"})]})}function DH({song:t}){const[e,n]=h.useState(""),r=h.useRef(null),s=h.useRef(null),{action:i,loading:o}=$g(),l=f=>{var p;n(f),(p=r.current)==null||p.open()},c=()=>{var f;(f=r.current)==null||f.close()},u=async()=>{await i({variant:"delete",song:t}),c()},d=()=>{switch(e){case"":return a.jsx(a.Fragment,{});case"delete":return a.jsx(hn,{callback:u,loading:o,closeModal:c,label:`Delete ' ${t.name} ' ?`});case"edit":return a.jsx(MH,{modalRef:r,song:t});case"add-to-playlist":return a.jsx(Dg,{closeModal:c,songs:[t]})}};return a.jsxs(a.Fragment,{children:[a.jsxs(zg,{song:t,children:[!1,a.jsx(d_,{song:t}),a.jsx(u_,{modalRef:s}),a.jsxs("button",{onClick:()=>l("edit"),children:[a.jsx(_T,{}),a.jsx("span",{children:"Edit"})]}),a.jsxs(se,{to:`lyric/${t.id}`,children:[a.jsx(Vp,{}),a.jsx("span",{children:t.lyric_id?"Edit lyric":"Add lyric"})]}),a.jsxs("button",{onClick:()=>l("delete"),children:[a.jsx(xt,{}),a.jsx("span",{children:"Delete"})]}),a.jsxs("a",{target:"_blank",href:t.song_url,children:[a.jsx(Kd,{}),a.jsx("span",{children:"Download"})]})]}),a.jsx(ie,{variant:"animation",ref:r,children:d()}),a.jsx(c_,{song:t,modalRef:s})]})}function LH({song:t}){const e=h.useRef(null);return a.jsxs(a.Fragment,{children:[a.jsxs(zg,{song:t,children:[!1,a.jsx(d_,{song:t}),a.jsx(u_,{modalRef:e}),a.jsxs("a",{target:"_blank",href:t.song_url,children:[a.jsx(Kd,{}),a.jsx("span",{children:"Download"})]})]}),a.jsx(c_,{song:t,modalRef:e})]})}function OH(){const t=mn(),{playlistSongs:e,currentPlaylist:n}=fe(ui),{shouldFetchOwnPlaylists:r}=yt(),{setErrorToast:s,setSuccessToast:i}=ne(),[o,l]=h.useState(!1);return{isFetching:o,removeSongFromPlaylist:async({song:u})=>{try{if(!n)return;l(!0);const d=e.filter(p=>p.id!==u.id),f={song_ids:d.map(p=>p.id)};await Re({collectionName:"Playlists",id:n.id,data:f}),r.current=!0,t(cU(d)),i(`${u.name} removed`)}catch(d){console.log({message:d}),s()}finally{l(!1)}}}}function $H({song:t}){const{removeSongFromPlaylist:e}=OH();return a.jsxs("button",{onClick:()=>e({song:t}),children:[a.jsx($1,{}),a.jsx("span",{children:"Remove"})]})}function zH({song:t}){return a.jsx(a.Fragment,{children:a.jsxs(zg,{song:t,children:[!1,a.jsx(d_,{song:t}),a.jsx($H,{song:t}),a.jsxs("a",{target:"_blank",href:t.song_url,children:[a.jsx(Kd,{className:"w-5"}),a.jsx("span",{children:"Download"})]})]})})}function BH({song:t}){return a.jsx("div",{className:"px-2 mb-3",children:a.jsxs("div",{className:"p-2 bg-white/10 rounded-md flex",children:[a.jsx("div",{className:"w-[50px] h-[50px] rounded overflow-hidden flex-shrink-0",children:a.jsx(De,{fallback:Nc.image,src:t.image_url,blurHashEncode:t.blurhash_encode,className:"object-cover object-center w-full"})}),a.jsxs("div",{className:"ml-2 text-sm",children:[a.jsx("h5",{className:"line-clamp-1 font-semibold",children:t.name}),a.jsx("p",{className:"item-info line-clamp-1",children:t.singers.map((e,n)=>e.name+(n?", ":""))})]})]})})}function zg({children:t,song:e}){return a.jsx(sr,{className:"w-[240px]",children:a.jsxs(cr,{children:[a.jsx(BH,{song:e}),a.jsx(ls,{children:t})]})})}function tE({song:t,index:e,variant:n}){const[r,s]=h.useState(!1),i=()=>{switch(n){case"queue-song":return a.jsx(PH,{song:t,index:e});case"own-song":return a.jsx(DH,{song:t});case"own-playlist":return a.jsx(zH,{song:t});default:return a.jsx(LH,{song:t})}},o=()=>{switch(n){case"queue-song":case"recent-song":return a.jsx(a.Fragment,{});default:return a.jsx("span",{className:`text-sm font-[500] hidden p-2 group-hover/main:hidden ${r?"hidden":"md:block"}`,children:Ic(t.duration)})}},l={button:"hover:bg-[--a-5-cl] p-2 rounded-full"},c=()=>r?"bg-[--primary-cl]":"block md:hidden";return a.jsx(a.Fragment,{children:a.jsxs(nr,{appendOnPortal:!0,children:[a.jsx(rr,{children:a.jsx("button",{type:"button",className:`block group-hover/main:block ${l.button} ${c()}`,children:a.jsx("span",{className:"w-5 block",children:Rg})})}),o(),i()]})})}function VH({isLiked:t,song:e,isSongActive:n,songVariant:r,className:s="p-1.5"}){const{action:i,loading:o}=$g(),l=()=>{switch(r){case"queue-song":case"recent-song":return"mr-1";default:return""}},c=()=>{if(t)switch(r){case"queue-song":case"recent-song":return"";default:return"!block"}return""},u=()=>{switch(r){case"queue-song":case"recent-song":return n?"text-white":"text-[--primary-cl]";default:return"text-[--primary-cl]"}},d={button:"hover:bg-[--a-5-cl] rounded-full"};return a.jsx("button",{onClick:()=>i({variant:"like",song:e}),className:`${d.button} ${l()} group-hover/main:block md:hidden ${s} ${c()}`,children:o?a.jsx(Me,{className:"w-5 animate-spin"}):a.jsx(a.Fragment,{children:t?a.jsx(Xc,{className:`w-5 ${u()}`}):a.jsx(Xd,{className:"w-5"})})})}function UH({song:t}){const e=h.useMemo(()=>t.last_week_rank-t.rank,[]),n=()=>!t.last_week_rank||!e?"-":a.jsxs(a.Fragment,{children:[a.jsx("span",{className:`w-3 ${e>0?"text-[#1dc186]":"text-[#e35050] rotate-180"}`,children:mU}),a.jsx("span",{className:"font-bold text-sm",children:Math.abs(e)})]});return a.jsx("div",{className:"flex flex-col w-4 justify-center items-center mr-4 flex-shrink-0",children:n()})}function HH({song:t}){const{selectSong:e,selectedSongs:n,isChecked:r}=dl(),s=h.useMemo(()=>n?n.indexOf(t)!=-1:!1,[n]),i=()=>{r!==void 0&&e(t)};return a.jsxs(a.Fragment,{children:[a.jsx("input",{readOnly:!0,checked:s,className:"hidden",type:"checkbox"}),a.jsx("button",{onClick:i,className:`mr-2 md:mr-3 group-hover/main:block ${r?"block":"md:hidden "}`,children:s?a.jsx(dh,{className:"w-5"}):a.jsx(z1,{className:"w-5"})}),a.jsx("button",{className:`mr-3 hidden group-hover/main:hidden md:block ${Oa(r,"md:hidden")}`,children:a.jsx(qi,{className:"w-5"})})]})}function nE({rank:t,className:e=""}){return a.jsx("div",{className:`song-index font-bold w-[50px] leading-[54px] flex-shrink-0 text-center text-[32px] ${t<=3?"is-top-"+t:""} ${e}`,children:t})}function z5({song:t,onClick:e,isHasCheckBox:n,active:r=!0,isLiked:s,index:i,className:o="",imageUrl:l,...c}){const{isOnMobile:u}=as(),d={itemContainer:"w-full sm:group/container flex flex-row rounded-md justify-between py-2 px-3 last:border-none",imageFrame:" relative rounded overflow-hidden flex-shrink-0",overlay:"absolute flex items-center justify-center inset-0 bg-black/40"},f=h.useMemo(()=>{switch(c.variant){default:return a.jsxs("div",{className:` ${d.overlay} 
               ${r?"":"hidden sm:group-hover/main:flex"}`,children:[a.jsx("img",{src:a_,alt:"",className:`"h-[18px] w-[18px] ${Ha(!r)}`}),a.jsx("button",{type:"button",onClick:e,className:` ${Ha(r)} `,children:a.jsx(CH,{className:" w-[24px] text-white"})})]})}},[r,e]),p=()=>{switch(c.variant){case"queue-song":case"recent-song":return"text-xs";default:return"text-sm"}},g=()=>{switch(c.variant){case"queue-song":case"recent-song":return"w-10 h-10";default:return"h-[54px] w-[54px]"}},x=()=>{switch(c.variant){case"queue-song":case"recent-song":return"text-xs";default:return"text-sm"}},w=R=>{!u||R.target.tagName==="A"||e()},v=a.jsxs(a.Fragment,{children:[n&&a.jsx(HH,{song:t}),a.jsxs("div",{className:"flex-grow flex",onClick:w,children:[a.jsxs("div",{className:`${d.imageFrame} ${g()}`,children:[a.jsx(De,{src:l||t.image_url,blurHashEncode:t.blurhash_encode}),f]}),a.jsxs("div",{className:"ml-[10px]",children:[a.jsxs("h5",{className:`line-clamp-1 font-semibold overflow-hidden ${p()}`,children:[t.name,!1]}),a.jsx("div",{className:`${c.variant==="queue-song"&&r?"":"item-info"} font-medium line-clamp-1 ${x()}`,children:t.singers.map((R,M)=>R.id?a.jsx(se,{to:`/singer/${R.id}`,className:`${c.variant==="queue-song"?"":"hover:text-[--primary-cl]"} hover:underline`,children:(M?", ":"")+R.name},M):a.jsxs("span",{children:[" ",(M?", ":"")+R.name]},M))})]})]})]}),_=()=>{switch(c.variant){case"queue-song":case"recent-song":return v;case"trending":return a.jsxs(a.Fragment,{children:[a.jsx(nE,{className:"mr-3",rank:i+1}),v]});case"table":return a.jsxs(a.Fragment,{children:[a.jsx(nE,{rank:i+1}),a.jsx(UH,{song:t}),v]});default:return a.jsx("div",{className:"flex flex-grow items-center",children:v})}},b=()=>{switch(c.variant){case"queue-song":case"recent-song":return a.jsx(tE,{variant:c.variant,song:t,index:i});default:return a.jsx("div",{className:"flex justify-center md:w-[60px]",children:a.jsx(tE,{variant:c.variant,song:t,index:i})})}},j=a.jsxs("div",{className:"flex items-center",children:[s!=null&&a.jsx(VH,{className:"p-2",isSongActive:r,songVariant:c.variant,isLiked:s,song:t}),b()]});return(()=>{switch(c.variant){case"queue-song":return a.jsxs("div",{className:`${d.itemContainer} group/main ${r?"bg-[--primary-cl] text-white":"hover:bg-[--a-5-cl]"}`,children:[_(),j]});default:return a.jsxs("div",{...c.attributes?c.attributes(t):{},className:`${d.itemContainer} ${o} has-[:checked]:bg-[--a-5-cl] group/main ${r?"bg-[--a-5-cl]":"hover:bg-[--a-5-cl]"}`,children:[_(),j]})}})()}function $s({songs:t,setSong:e,getActive:n,songVariant:r,imageUrl:s,isHasCheckBox:i=!0,whenEmpty:o,attributes:l}){const{user:c}=ye(),{currentSongData:u}=fe(rt);return t.length?t.map((f,p)=>{const g=c?f.owner_email===c.email&&f.is_official===!1:!1;return a.jsx(z5,{attributes:l,active:u?n?n(f,u.song):f.id===u.song.id:!1,onClick:()=>e(f),variant:r||(g?"own-song":"system-song"),isLiked:c?c.liked_song_ids.includes(f.id):null,song:f,imageUrl:s,index:p,isHasCheckBox:i},f.queue_id)}):o||a.jsx(Fe,{variant:"less"})}function B5(){const{user:t,updateUserData:e}=ye();return{pushRecentPlaylist:async r=>{try{if(t){if(!t.recent_playlist_ids.find(i=>i===r.id)){const o={recent_playlist_ids:[r.id,...t.recent_playlist_ids].slice(0,4)};await Re({collectionName:"Users",data:o,id:t.email}),e(o)}}else{const s=un()["recent-playlists"]||[];s.find(o=>o.id===r.id)||(s.unshift(r),ot("recent-playlists",s.slice(0,4)))}}catch(s){console.log({error:s})}}}}function GH(){const{currentPlaylist:t,playlistSongs:e}=fe(ui),n=r=>{if(/^[a-zA-Z0-9]$/.test(r.key)){const i=document.querySelector(`div[data-first_letter=${typeof r.key=="number"?r.key:"'"+r.key+"'"}]`);i&&i.scrollIntoView({block:"center",behavior:"instant"})}};h.useEffect(()=>{if(!(!e.length||!t))return window.addEventListener("keypress",n),()=>{window.removeEventListener("keypress",n)}},[e,t])}const WH=a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"h-[30px] mb-[10px] flex items-center",children:a.jsx(we,{className:"h-[20px] w-[90px]"})}),a.jsx(Zi,{})]});function qH({variant:t,loading:e}){const{playlistSongs:n,currentPlaylist:r}=fe(ui),{handleSetSong:s}=os({variant:"playlist"}),{pushRecentPlaylist:i}=B5();GH();const o=(r==null?void 0:r.is_album)&&!!(r!=null&&r.image_url),l=c=>{if(!r)return;s(c.queue_id,n)&&i(r)};return e?WH:a.jsx(a.Fragment,{children:a.jsxs(Os,{children:[!!n.length&&a.jsx(Lg,{variant:t==="others-playlist"?"system-song":"own-playlist",children:a.jsxs("p",{className:"font-[500] opacity-[.5]",children:[n.length," Songs"]})}),a.jsx($s,{imageUrl:o?r.image_url:"",attributes:c=>({"data-first_letter":c.name.charAt(0).toLowerCase()}),songs:n,setSong:c=>l(c),songVariant:t==="my-playlist"?"own-playlist":"system-song"})]})})}function na(){const t=mn(),{playerConfig:{isShuffle:e,repeat:n,isCrossFade:r},updatePlayerConfig:s,firstTimeSongLoaded:i,audioRef:o,timelineEleRef:l,currentTimeEleRef:c,isPlayingNewSong:u,shouldSyncSongDuration:d,timeLineColorRef:f}=lt(),{currentSongData:p,queueSongs:g}=fe(rt),{playStatus:x}=fe(lr),w=h.useRef(0),v=()=>{l.current&&c.current&&(c.current.innerText="0:00",l.current.style.background="var-(--a-5-cl)")},_=async()=>{try{if(d.current){d.current=!1;const A=un().current_time||0;o.current.currentTime=A}await o.current.play(),u.current&&(r&&(o.current.volume=0),u.current=!1)}catch{}},b=()=>{o.current.pause()},j=()=>{console.log(x),x==="playing"&&b(),x==="paused"&&_()},T=C=>{const A=l.current,D=c.current,P=C||o.current.currentTime;if(o.current.duration&&A){const ee=P/(o.current.duration/100);A.style.background=Kw(+ee.toFixed(1),{color:f.current})}D&&(D.innerText=Ic(P)||"0:00")};return{toggleRepeat:()=>{let C;switch(n){case"no":C="all";break;case"one":C="no";break;case"all":C="one";break;default:C="no"}ot("repeat",C),s({repeat:C})},toggleShuffle:()=>{const C=!e;s({isShuffle:C}),ot("isShuffle",C)},next:()=>{if(!p)return;let C=p.index+1,A;C<g.length?A=g[C]:(C=0,A=g[0]),t(oi(A.queue_id))},previous:()=>{if(!p)return;let C=p.index-1,A;C>=0?A=g[C]:(A=g[g.length-1],C=g.length-1),t(oi(A.queue_id))},repeat:n,isShuffle:e,updateProgressElement:T,handleSeek:C=>{const A=C.target;if(l.current){const D=A.getBoundingClientRect(),ee=(C.clientX-D.left)/l.current.offsetWidth,_e=Math.round(ee*o.current.duration),He=o.current.currentTime;if(w.current&&Math.abs(He-w.current)<1&&Math.abs(_e-w.current)<1)return;T(_e),i.current?ot("current_time",_e):o.current.currentTime=_e,w.current=_e}},handlePlayPause:j,play:_,pause:b,resetForNewSong:v}}function gx({onClick:t,children:e,text:n}){const{playlistSongs:r}=fe(ui);return a.jsxs(ce,{onClick:t,disabled:!r.length,size:"clear",color:"primary",className:"rounded-full px-5 py-1",children:[e,a.jsx("span",{className:"font-playwriteCU leading-[2.2]",children:n})]})}function KH(){const{currentPlaylist:t,playlistSongs:e}=fe(ui),{currentSongData:n}=fe(rt),{playStatus:r}=fe(lr),{handlePlayPause:s}=na(),{handleSetSong:i}=os({variant:"playlist"}),{pushRecentPlaylist:o}=B5(),l=()=>{if(!t)return;const c=e[0];i(c.queue_id,e)&&o(t)};if(!t)return a.jsx(a.Fragment,{});if(n!=null&&n.song.queue_id.includes(t.id))switch(r){case"playing":case"waiting":return a.jsx(gx,{text:"Pause",onClick:s,children:a.jsx(hl,{className:"w-7 mr-1"})});case"loading":case"paused":return a.jsx(gx,{text:"Continue",onClick:s,children:a.jsx(si,{className:"w-7 mr-1"})})}return a.jsx(gx,{text:"Play",onClick:l,children:a.jsx(si,{className:"w-7 mr-1"})})}function V5(){const t=mn(),{user:e,updateUserData:n}=ye(),{setFavoritePlaylists:r,ownPlaylists:s,favoritePlaylists:i,setOwnPlaylists:o,shouldFetchFavoritePlaylists:l,shouldFetchOwnPlaylists:c}=yt(),[u,d]=h.useState(!1),{setSuccessToast:f,setErrorToast:p}=ne(),g=Gt();return{isFetching:u,action:async w=>{try{if(!e)throw new Error("user not found");d(!0);const v=Ls(de),_=gt(de,"Users",e.email),b=gt(de,"Playlists",w.playlist.id),j=e.liked_playlist_ids.includes(w.playlist.id);switch(w.variant){case"like":{if(!e)throw Error();const T=[...e.liked_playlist_ids],R=T.findIndex(I=>I===w.playlist.id),M=R===-1;M?T.unshift(w.playlist.id):T.splice(R,1);const k={liked_playlist_ids:T},E={like:Ai(M?1:-1)};v.update(_,k),v.update(b,E),await v.commit(),r(M?I=>[w.playlist,...I]:I=>I.filter(C=>C.id!==w.playlist.id)),f(M?"Liked":"Disliked"),n(k);break}case"edit":{const{data:T,playlist:R,imageFile:M}=w,k={...R,...T};if(M){R.image_file_id&&Vt({fileId:R.image_file_id});const C=await Yi({imageFile:M});Object.assign(k,C)}await Re({collectionName:"Playlists",data:k,id:R.id,msg:">>> api: update playlist doc"}),c.current=!0,j&&(l.current=!0);const{updated_at:E,...I}=k;t(oU(I)),f("Playlist edited");break}case"delete":{const{playlist:T}=w;T.image_file_id&&Vt({fileId:T.image_file_id});const R=await tn(Ee(Yo,ae("target_id","==",T.id))),M={liked_playlist_ids:e.liked_playlist_ids.filter(E=>E!==T.id)};v.delete(b),v.update(_,M),R.empty||(console.log(`Delete ${R.docs.length} comments`),R.forEach(E=>v.delete(E.ref))),await v.commit();const k=s.filter(E=>E.id!==T.id);if(o(k),j){const E=i.filter(I=>I.id!==T.id);r(E)}f(`Playlist '${T.name}' deleted`),n(M),g("/my-music");break}}}catch(v){console.log({message:v}),p()}finally{d(!1)}},user:e}}function QH({isLiked:t,playlist:e,className:n=""}){const{action:r,isFetching:s}=V5();return a.jsx(ce,{size:"clear",onClick:()=>r({variant:"like",playlist:e}),className:`${n}`,children:s?a.jsx(Me,{className:"w-5 animate-spin"}):a.jsx(a.Fragment,{children:t?a.jsx(Xc,{className:"w-5 text-[--primary-cl]"}):a.jsx(Xd,{className:"w-5"})})})}function U5(){const t=mn(),{playlistSongs:e}=fe(ui),{setSuccessToast:n}=ne();return a.jsxs("button",{onClick:()=>{t(yh({songs:e})),n("Song added to queue")},children:[a.jsx(Wt,{}),a.jsx("span",{children:"Add to queue"})]})}function XH(){return a.jsx(a.Fragment,{children:a.jsxs(H5,{children:[a.jsx(o_,{}),a.jsx(U5,{})]})})}function YH(){const{currentPlaylist:t}=fe(ui),[e,n]=h.useState(""),r=h.useRef(null),{action:s,isFetching:i}=V5(),o=d=>{var f;n(d),(f=r.current)==null||f.open()},l=()=>{var d;return(d=r.current)==null?void 0:d.close()},c=async(d,f)=>{t&&(await s({variant:"edit",playlist:t,data:d,imageFile:f}),l())},u=()=>{if(!t)return a.jsx(a.Fragment,{});switch(e){case"":return a.jsx(a.Fragment,{});case"edit":return a.jsx(je,{className:"w-[600px]",children:a.jsx(Zc,{isLoading:i,playlist:t,submit:c,variant:"edit",modalRef:r})});case"delete":return a.jsx(hn,{loading:i,label:`Delete playlist ' ${t.name} ' ?`,callback:()=>s({variant:"delete",playlist:t}),closeModal:l})}};return a.jsxs(a.Fragment,{children:[a.jsxs(H5,{children:[a.jsx(o_,{}),a.jsx(U5,{}),a.jsxs("button",{onClick:()=>o("edit"),children:[a.jsx(is,{}),a.jsx("span",{children:"Edit"})]}),a.jsxs("button",{onClick:()=>o("delete"),children:[a.jsx(xt,{}),a.jsx("span",{children:"Delete"})]})]}),a.jsx(ie,{variant:"animation",ref:r,children:u()})]})}function H5({children:t}){return a.jsx(sr,{className:"left-[calc(100%)] bottom-full w-[160px]",animationClassName:"origin-top-left",children:a.jsx(cr,{children:a.jsx(ls,{children:t})})})}function JH({variant:t}){return a.jsx(a.Fragment,{children:a.jsxs(nr,{children:[a.jsx(rr,{children:a.jsx(ce,{size:"clear",children:a.jsx("p",{className:"w-5",children:Rg})})}),t==="others-playlist"?a.jsx(XH,{}):a.jsx(YH,{})]})})}function ZH({target:t}){const[e,n]=h.useState([]),[r,s]=h.useState(!1),[i,o]=h.useState(!0),l=h.useRef(!0);return{target:t,comments:e,isOpenComment:r,setIsOpenComment:s,setComments:n,shouldFetchComment:l,isFetching:i,setIsFetching:o}}const G5=h.createContext(null);function Bg({children:t,target:e}){return a.jsx(G5.Provider,{value:ZH({target:e}),children:t})}function ir(){const t=h.useContext(G5);if(!t)throw new Error("CommentProvider not provided");return t}function W5({children:t}){return a.jsxs("div",{className:"h-[70vh] overflow-hidden text-white rounded-[16px_16px_0_0] relative p-3 flex flex-col",children:[a.jsx("div",{className:"bg-opacity-[0.8] bg-[#1f1f1f] backdrop-blur-[15px] z-[-1] absolute inset-0"}),t]})}const eG="https://flasktoxic-check-production.up.railway.app/predict";function q5(){const{setErrorToast:t}=ne(),{user:e,updateUserData:n}=ye(),{setComments:r,comments:s,target:i}=ir(),[o,l]=h.useState(!1),c=h.useRef(null),u=async p=>(await Xr.post(eG,{comment:p})).data.predicted_label==="toxic",d=(p,g)=>{const x={comment:Ai(g||1)};Re({collectionName:i==="song"?"Songs":"Playlists",data:x,id:p})};return{isFetching:o,action:async p=>{var g;try{if(!e)return;switch(l(!0),p.type){case"add":{if(await u(p.text)){(g=c.current)==null||g.open();return}const w=XS({user:e,target_id:p.target_id,text:p.text});d(p.target_id);const v=await ai({collectionName:"Comments",data:w}),_=await Tc(v);if(_.exists()){const b={..._.data(),id:v.id,replies:[]};r(j=>[b,...j]),l(!1)}break}case"reply":{const{comment:x,comment_index:w,text:v}=p;if(await u(p.text))return;const b=XS({user:e,target_id:x.target_id,text:v,comment_id:x.id});d(p.comment.target_id);const j=await ai({collectionName:"Comments",data:b}),T=await Tc(j);if(T.exists()){const R={reply:Ai(1)};await Re({collectionName:"Comments",data:R,id:x.id});const M={...T.data(),id:j.id,replies:[]},k=[...s];k[w]={...k[w],replies:[...k[w].replies,M]},r(k),l(!1)}break}case"like":{const x=[...e.liked_comment_ids],w=x.findIndex(j=>j===p.id),v=w===-1;v?x.push(p.id):x.splice(w,1);const _={like:Ai(v?1:-1)};await Re({collectionName:"Comments",data:_,id:p.id});const b={liked_comment_ids:x};ot("liked_comment_ids",x),n(b);break}case"delete":{const x=gt(de,"Comments",p.comment.id),w=Ls(de);if(w.delete(x),p.comment.reply){console.log(`Delete ${p.comment.reply} replies `);const b=Ee(Yo,ae("comment_id","==",p.comment.id));(await tn(b)).forEach(T=>{w.delete(T.ref)})}d(p.comment.target_id,-1),await w.commit();const v=[...e.liked_comment_ids],_=v.findIndex(b=>b===b);_!==-1&&(v.splice(_,1),ot("liked_comment_ids",v)),r(b=>b.filter(j=>j.id!==p.comment.id));break}}}catch(x){console.log({error:x}),t()}finally{l(!1)}},modalRef:c}}function K5(t){const e=t.toDate(),r=new Date().getTime()-e.getTime(),s=Math.floor(r/(1e3*60*60*24));return s>0?s+(s>1?" days ago":" day ago"):"Today"}const tG=["👍","❤️","😂","😮","😢","😡","😀","😊","😁","😂","🤣","😍","🤩","🥳","😎","😇","🤔","🤫","🤐","😐","😑","😒","🙄","😬","🤥","😌","👋","🙏","👏","🙌","👌","💯","🔥","✨","🎉","🚀","👍","👎","💪","💖"];function nG(){const[t,e]=h.useState(""),n=h.useRef(null),r=s=>{const i=n.current;if(i){const o=i.selectionStart,l=i.selectionEnd;e(t.substring(0,o)+s+t.substring(l)),setTimeout(()=>{i.focus(),i.selectionStart=i.selectionEnd=o+s.length},0)}};return h.useEffect(()=>{n.current&&(n.current.style.height="auto",n.current.scrollHeight>n.current.offsetHeight&&(n.current.style.height=n.current.scrollHeight+"px"))},[t]),{EMOJIS:tG,addEmoji:r,textareaRef:n,value:t,setValue:e}}function Vg({onSubmited:t,bg:e="bg-[--a-10-cl]",...n}){const{user:r}=ye(),{action:s,isFetching:i,modalRef:o}=q5(),{EMOJIS:l,textareaRef:c,addEmoji:u,value:d,setValue:f}=nG(),p=async()=>{if(!(!d||!d.trim())){switch(n.variant){case"comment":await s({type:"add",target_id:n.targetId,text:d});break;case"reply":await s({type:"reply",text:d,comment:n.comment,comment_index:n.commentIndex});break}f(""),t&&t()}},g=n.variant==="comment"?"...":`Reply to ${n.comment.user_name}...`;return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex w-full",children:[a.jsx("div",{className:"w-[40px] h-[40px] flex-shrink-0",children:a.jsx(De,{fallback:cc.image,src:r==null?void 0:r.photo_url,blurHashEncode:r!=null&&r.photo_url?"":cc.blurhash,className:"rounded-full"})}),a.jsxs("div",{className:`rounded-lg ml-2 flex-grow  p-1.5 flex items-end ${Pd(i)} ${e}`,children:[a.jsx("textarea",{ref:c,placeholder:g,value:d,onChange:x=>f(x.target.value),rows:1,className:`${xc} no-scrollbar resize-none max-h-[30vh] w-full !bg-transparent border-none`}),a.jsxs(nr,{appendOnPortal:!0,children:[a.jsx(rr,{children:a.jsx("button",{className:"hover p-1.5 hover:bg-[--a-5-cl] rounded-full",children:a.jsx(l$,{className:"w-6"})})}),a.jsx(sr,{children:a.jsx(cr,{className:"w-[270px]",children:a.jsx("div",{className:"p-1.5 grid grid-cols-5 justify-items-center max-h-60 overflow-y-auto pr-2 [&_button]:p-1  [&_button]:rounded-md  [&_img]:w-7  hover:[&_button]:bg-gray-200",children:l.map((x,w)=>a.jsx("button",{onClick:()=>u(x),children:a.jsx(P5,{options:{className:"twemoji"},children:x})},w))})})})]}),a.jsx("button",{onClick:p,className:"p-1.5 hover:bg-white/10 rounded-full",children:i?a.jsx(lR,{className:"w-6 animate-spin"}):a.jsx(si,{className:"w-6"})})]})]}),a.jsx(ie,{variant:"animation",ref:o,children:a.jsxs(je,{children:[a.jsx(De,{className:"mx-auto",width:"w-[130px]",src:s_}),a.jsx(oe,{variant:"h2",className:"text-center",title:"Your commment is not allow"}),a.jsx("p",{className:"mt-5 text-right",children:a.jsx(ce,{onClick:()=>{var x;return(x=o.current)==null?void 0:x.close()},color:"primary",children:"Ok"})})]})})]})}function rG({comment:t,commentIndex:e}){const{comments:n,setComments:r}=ir(),[s,i]=h.useState(!1),{fetchComment:o}=Ig(),l=async()=>{try{i(!0);const c=await o({comment_id:t.id});if(c){const u=[...n];u[e]={...u[e],replies:c},r(u)}}catch(c){console.log({error:c})}finally{i(!1)}};return a.jsxs("button",{onClick:l,className:"mt-1 text-[#ccc] flex items-center space-x-1",children:[a.jsxs("span",{children:["View ",t.reply," replies"]}),s?a.jsx(Me,{className:"w-5 animate-spin"}):a.jsx(e$,{className:"w-5"})]})}function Q5({comment:t,index:e,level:n,variant:r="dark-bg"}){const{setIsOpenFullScreen:s,isOpenFullScreen:i}=lt(),{user:o}=ye(),{action:l,isFetching:c}=q5(),[u,d]=h.useState(!1),f=h.useRef("like"),p=h.useRef(null),g=o==null?void 0:o.liked_comment_ids.includes(t.id),x=(o==null?void 0:o.email)===t.user_email,w=()=>{i&&s(!1)},v=async()=>{var _;await l({type:"delete",comment:t}),(_=p.current)==null||_.close()};return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:`${n==1?"py-3":"mt-2"} `,children:a.jsxs("div",{className:"flex w-full items-start space-x-1.5",children:[a.jsx("div",{className:`flex-shrink-0 ${n===1?"w-[40px] h-[40px]":"w-[36px] h-[36px]"} rounded-full overflow-hidden`,children:a.jsx(De,{fallback:t.user_email===(o==null?void 0:o.email)?cc.image:Nc.image,src:t.user_image_url})}),a.jsxs("div",{className:"flex-grow text-[13px]",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsxs("div",{className:"mx-2",children:[a.jsxs("div",{className:`${r==="theme-bg"?"text-black dark:text-white":"text-white"}`,children:[a.jsx(se,{onClick:w,className:`font-semibold inline-block hover:underline line-clamp-1 ${r==="theme-bg"?"text-[#333] dark:text-[#f1f1f1]":"text-[#f1f1f1]"}`,to:`/user/${t.user_email}`,children:t.user_name}),a.jsx(Ac,{className:"text-base break-all whitespace-break-spaces ",children:t.text})]}),a.jsxs("div",{className:"flex space-x-2 mt-1",children:[a.jsx("span",{className:"opacity-[.7]",children:K5(t.created_at)}),o&&a.jsx(a.Fragment,{children:x?a.jsx("button",{onClick:()=>{var _;f.current="delete",(_=p.current)==null||_.open()},children:"Delete"}):n===1&&a.jsx("button",{onClick:()=>d(!0),children:"Reply"})})]}),!!t.reply&&n===1&&!t.replies.length&&a.jsx(rG,{comment:t,commentIndex:e})]}),a.jsxs("div",{className:"flex flex-col items-center ml-auto flex-shrink-0",children:[o?a.jsx("button",{className:"p-1",onClick:()=>{f.current="like",l({type:"like",id:t.id})},children:c&&f.current==="like"?a.jsx(Me,{className:"w-6 animate-spin"}):a.jsx(a.Fragment,{children:g?a.jsx(Xc,{className:"w-6 text-red-500"}):a.jsx(Xd,{className:"w-6"})})}):a.jsx(Ac,{children:"❤️"}),a.jsx("span",{className:"font-semibold",children:t.like})]})]}),!!t.replies.length&&t.replies.map((_,b)=>a.jsx(Q5,{comment:_,index:e,level:2},b)),u&&a.jsx("div",{className:"mt-2",children:a.jsx(Vg,{onSubmited:()=>d(!1),commentIndex:e,variant:"reply",comment:t})})]})]})}),a.jsx(ie,{variant:"animation",ref:p,children:a.jsx(hn,{label:"Delete comment",closeModal:()=>{var _;return(_=p.current)==null?void 0:_.close()},loading:c,callback:v})})]})}function h_({comments:t,isFetching:e=!1,className:n="",variant:r}){return a.jsx(a.Fragment,{children:a.jsxs("div",{className:`flex-grow relative overflow-auto no-scrollbar ${n}`,children:[e&&a.jsx(Ye,{children:a.jsx(Me,{className:"animate-spin w-7"})}),!e&&a.jsx(a.Fragment,{children:t.length?t.map((s,i)=>a.jsx(Q5,{variant:r,level:1,index:i,comment:s},s.id)):a.jsx("p",{className:"text-center",children:"..."})})]})})}function sG(){const{shouldFetchComment:t,setComments:e,isOpenComment:n,setIsFetching:r}=ir(),{currentPlaylist:s}=fe(ui),{fetchComment:i}=Ig({setIsFetchingFromParent:r}),o=async()=>{if(!s)return;const l=await i({target_id:s.id});e(l||[])};h.useEffect(()=>{!n||!s||t.current&&(t.current=!1,o())},[n])}function rE({targetId:t,variant:e}){const{user:n}=ye(),{isFetching:r,comments:s}=ir();return sG(),r?a.jsx(Ye,{children:a.jsx(Me,{className:"w-6 animate-spin"})}):a.jsxs(a.Fragment,{children:[a.jsx(h_,{variant:e,comments:s}),n&&a.jsx(Vg,{variant:"comment",targetId:t})]})}function iG({playlist:t}){const{isOnMobile:e}=as(),{setIsOpenComment:n}=ir(),r=h.useRef(null),s=()=>{var i;(i=r.current)==null||i.open(),n(!0)};return a.jsxs(a.Fragment,{children:[a.jsx(ce,{size:"clear",onClick:()=>s(),children:a.jsx(D1,{className:"w-5"})}),!e&&a.jsx(ie,{onClose:()=>n(!1),variant:"animation",ref:r,children:a.jsx(je,{className:"h-[400px] w-[500px]",children:a.jsx(rE,{variant:"theme-bg",targetId:t.id})})}),e&&a.jsx(xv,{ref:r,onClose:()=>n(!1),children:a.jsx(W5,{children:a.jsx(rE,{variant:"dark-bg",targetId:t.id})})})]})}const Pc=(t,e)=>!(t!=null&&t.seconds)||!(t!=null&&t.seconds)?"":(e==null?void 0:e.type)==="date"?new Date(t==null?void 0:t.toDate()).toLocaleDateString("en-GB"):new Date(t==null?void 0:t.toDate()).toLocaleString();function aG({playlist:t,showSkeleton:e,isLiked:n,variant:r}){const{currentSongData:s}=fe(rt),i=t?s==null?void 0:s.song.queue_id.includes(`${t.id}`):!1,o={container:"flex flex-col md:flex-row lg:flex-col",smallText:"",link:"hover:text-[--primary-cl] hover:underline"},l=()=>t?a.jsxs(a.Fragment,{children:[a.jsx(se,{className:`block hover:underline hover:text-[--primary-cl] ${o.smallText}`,to:`/singer/${t.singers[0].id}`,children:t.singers[0].name}),a.jsxs(Ac,{className:"font-bold text-lg",children:["❤️",Ms(t.like)]})]}):a.jsx(a.Fragment,{}),c=()=>{if(!t)return a.jsx(a.Fragment,{});switch(r){case"my-playlist":return a.jsx(a.Fragment,{children:a.jsx("p",{className:o.smallText,children:t.is_public?"Public":"Private"})});case"others-playlist":return a.jsxs(a.Fragment,{children:[a.jsxs(Ac,{className:"font-bold text-lg",children:["❤️ ",Ms(t.like)]}),!!t.singers.length&&a.jsx("p",{className:o.smallText,children:t.singers.map((u,d)=>a.jsx(se,{className:`${o.link}`,to:`/singer/${u.id}`,children:(d?", ":"")+u.name},d))}),!t.is_official&&a.jsxs("p",{className:o.smallText,children:["Provided by"," ",a.jsx(se,{className:o.link,to:`/user/${t.owner_email}`,children:t.distributor})]}),a.jsxs("p",{className:o.smallText,children:["Last update:"," ",Pc(t.updated_at,{type:"date"})]})]})}};return a.jsx(a.Fragment,{children:a.jsxs("div",{className:o.container,children:[a.jsx("div",{className:"w-[250px] md:w-[200px] mx-auto md:m-0 lg:w-full",children:e?a.jsx(we,{className:"pt-[100%] rounded-lg"}):t&&a.jsx(Od,{data:t,active:i,variant:"image"})}),a.jsxs("div",{className:"flex flex-col items-center mt-3 md:items-start md:ml-5 md:mt-0 lg:ml-0 lg:mt-3 lg:items-center",children:[e?a.jsxs("div",{className:"space-y-1 flex flex-col items-center",children:[a.jsx(we,{className:"h-[24px] w-[170px]"}),a.jsx(we,{className:"h-[17px] w-[170px]"}),a.jsx(we,{className:"h-[17px] w-[60px]"}),a.jsx(we,{className:"h-[17px] w-[100px]"})]}):t&&a.jsxs(a.Fragment,{children:[a.jsx(oe,{className:"text-center",variant:"h2",title:t.name}),a.jsx("div",{className:"mt-2.5 text-center md:text-left lg:text-center text-sm item-info",children:t.is_album?l():c()})]}),t&&a.jsxs("div",{className:"flex flex-col items-center mt-3 md:flex-row md:mt-auto lg:flex-col lg:mt-3",children:[a.jsx(KH,{}),a.jsxs("div",{className:"flex space-x-3 mt-3 md:ml-3 md:mt-0 lg:mt-3 lg:ml-0 hover:[&_button]:bg-[--a-5-cl] [&_button]:p-2",children:[a.jsx(JH,{variant:r}),n!==null&&a.jsx(QH,{isLiked:n,playlist:t}),a.jsx(Bg,{target:"playlist",children:a.jsx(iG,{playlist:t})})]})]})]})]})})}function oG(){const{currentPlaylist:t}=fe(ui),{user:e}=ye(),n=e&&t?t.owner_email===e.email&&!t.is_official:!1,r=e?t?e.liked_playlist_ids.includes(t.id):!1:null,{isFetching:s}=dU();return!s&&!t?a.jsx(Ye,{children:a.jsx(Fe,{variant:"with-home-button"})}):a.jsxs(a.Fragment,{children:[a.jsx(Za,{children:a.jsxs("div",{className:"lg:flex lg:-mx-3",children:[a.jsx("div",{className:"w-full lg:w-1/4 lg:px-3",children:a.jsx(aG,{showSkeleton:s,variant:n?"my-playlist":"others-playlist",playlist:t,isLiked:r})}),a.jsx("div",{className:"w-full lg:w-3/4 lg:px-3",children:a.jsx("div",{className:"mt-[30px] lg:mt-0",children:a.jsx(qH,{loading:s,variant:n?"my-playlist":"others-playlist"})})})]})}),a.jsx(ta,{})]})}function X5(){const{user:t}=ye(),{shouldFetchUserSingers:e,setSingers:n,singers:r}=yt(),{setErrorToast:s}=ne(),[i,o]=h.useState(!0);return{isFetching:i,singers:r,user:t,setIsFetching:o,getSinger:async()=>{try{if(!t)return;if(o(!0),e.current&&t.liked_singer_ids.length){e.current=!1;const c=Ee(Xo,ae(ci(),"in",t.liked_singer_ids)),u=await Md(c);return n(u),u}else return await ss(100),r}catch(c){console.log({message:c}),s()}finally{o(!1)}}}}function yv({singers:t,whenEmpty:e,loading:n=!1,skeNumber:r=4,className:s="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 ",onClick:i}){const o=[...Array(r).keys()].map(l=>a.jsx(eE,{variant:"skeleton"},l));return a.jsxs("div",{className:!n&&!t.length?"":`-mt-3 -mx-3 ${s}`,children:[n&&o,!n&&a.jsx(a.Fragment,{children:t.length?t.map((l,c)=>a.jsx(eE,{onClick:()=>i&&i(l),variant:"singer-item",singer:l},c)):e||a.jsx(Fe,{className:"mx-auto",variant:"less"})})]})}function lG(){const{isFetching:t,singers:e,getSinger:n}=X5();return h.useEffect(()=>{n()},[]),t?a.jsxs(a.Fragment,{children:[a.jsx(we,{className:"h-[48px] w-[160px]"}),a.jsx(yv,{loading:t,singers:[]})]}):!t&&!e.length?a.jsx(a.Fragment,{}):a.jsx(a.Fragment,{children:a.jsxs("div",{children:[a.jsx(oe,{className:"mb-5",title:"Singers"}),a.jsx(yv,{singers:e})]})})}function cG(){const{checkEntireUser:t}=yt(),[e,n]=h.useState(!t.current),{getSinger:r}=X5(),{getSongs:s}=Og({tab:"favorite"}),i=async()=>{try{await Promise.all([r(),s()])}catch(o){console.log(o)}finally{n(!1)}};return h.useEffect(()=>{t.current||(t.current=!0,i())},[]),{isFetching:e}}const uG=["Favorite","Own"];function dG(){const{user:t}=ye(),{setOwnPlaylists:e,shouldFetchOwnPlaylists:n,setFavoritePlaylists:r,shouldFetchFavoritePlaylists:s}=yt(),[i,o]=h.useState(""),{setErrorToast:l}=ne(),[c,u]=h.useState(!0),d=h.useRef(!1),f=async p=>{try{if(!t)return;const g=p||i;switch(u(!0),g){case"Favorite":{if(s.current){if(s.current=!1,!t.liked_playlist_ids.length)return;const x=Ee(er,ae(ci(),"in",t.liked_playlist_ids)),v=(await wr(x,"useGetMyMusicPlaylist, get user favorite playlists")).filter(_=>!_.is_official&&_.owner_email===t.email?!0:!!_.is_public);r(v)}else await ss(100);break}case"Own":{if(n.current){n.current=!1;const x=Ee(er,ae("owner_email","==",t.email),ae("is_official","==",!1)),w=await wr(x,"useGetMyMusicPlaylist, get user own playlists");e(w)}else await ss(100);break}}}catch(g){console.log({message:g}),l()}finally{u(!1)}};return h.useEffect(()=>{const p=async()=>{const g=un().last_playlist_tab;await f(g),o(g||"Favorite")};d.current||(d.current=!0,p())}),h.useEffect(()=>{i&&f()},[i]),{isFetching:c,getPlaylist:f,setIsFetching:u,tab:i,setTab:o,tabs:uG}}function hG(){const{user:t}=ye(),{myMusicAddPlaylist:e,isFetching:n}=$5(),r=h.useRef(null),s=()=>{var o;return(o=r.current)==null?void 0:o.close()},i=async(o,l)=>{await e(o,l),s()};if(t)return a.jsxs(a.Fragment,{children:[a.jsxs(ce,{onClick:()=>{var o;return(o=r.current)==null?void 0:o.open()},size:"clear",className:"py-1 px-4",color:"primary",children:[a.jsx(Vi,{className:"w-6"}),a.jsx("span",{children:"Add new playlist"})]}),a.jsx(ie,{ref:r,variant:"animation",children:a.jsx(je,{className:"w-[600px]",children:a.jsx(Zc,{modalRef:r,isLoading:n,variant:"add",user:t,submit:i})})})]})}function fG(){const{ownPlaylists:t,favoritePlaylists:e}=yt(),{isFetching:n,setIsFetching:r,setTab:s,tab:i,tabs:o}=dG();return a.jsx(a.Fragment,{children:a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between items-center mb-2",children:[a.jsx(oe,{title:"Playlist"}),a.jsx(hG,{})]}),a.jsx("div",{className:"flex space-x-2 my-3",children:a.jsx(Ur,{render:l=>l,setTab:l=>{r(!0),s(l),ot("last_playlist_tab",l)},tab:i,tabs:o})}),a.jsx(ru,{loading:n,skeNumber:4,playlists:i==="Favorite"?e:t})]})})}function mG(){const{favoriteSongs:t}=yt(),{user:e}=ye(),{handleSetSong:n}=os({variant:"songs"}),{getSongs:r,isFetching:s}=Og({tab:"favorite"}),i=h.useMemo(()=>{if(!(e!=null&&e.liked_song_ids.length))return[];const l=[];return e.liked_song_ids.forEach(c=>{const u=t.find(d=>d.id===c);u&&l.push(u)}),l},[t,e==null?void 0:e.liked_song_ids]),o=l=>{n(l.queue_id,t)};if(h.useEffect(()=>{r()},[]),!!e)return a.jsxs(Os,{children:[a.jsx(Lg,{variant:"favorite-song",children:s?a.jsx(we,{className:"h-[20px] w-[90px]"}):a.jsxs("p",{className:"font-[500] opacity-[.5]",children:[i.length," Songs"]})}),s&&a.jsx(Zi,{}),!s&&a.jsx($s,{setSong:o,songs:t})]})}function pG({song:t}){return a.jsxs("div",{className:"flex items-center justify-between p-[10px]",children:[a.jsxs("div",{className:"flex-grow flex",children:[a.jsx(qi,{className:"w-[18px] mr-2.5"}),a.jsx("div",{className:"h-[54px] w-[54px] rounded overflow-hidden",children:a.jsx(De,{src:t.image_url})}),a.jsxs("div",{className:"ml-[10px]",children:[a.jsx("h5",{className:"line-clamp-1 font-medium overflow-hidden",children:t.name}),a.jsx("p",{className:"opacity-[.7] leading-[1.2] line-clamp-1 text-sm",children:t.singers[0].name})]})]}),a.jsxs("div",{className:"flex space-x-1",children:[a.jsx(Me,{className:"animate-spin w-5"}),a.jsx("p",{className:"text-sm",children:"Uploading..."})]})]})}function gG(){const{uploadedSongs:t}=yt(),{user:e}=ye(),n=h.useRef(null),{uploadingSongs:r,isUploading:s}=tR(),{handleSetSong:i}=os({variant:"songs"}),{isFetching:o,getSongs:l}=Og({tab:"uploaded"}),c=d=>{i(d,t)},u=h.useMemo(()=>o?0:r.length+t.length,[r,t,o]);return h.useEffect(()=>{l()},[]),e?a.jsxs(Os,{children:[a.jsx("label",{htmlFor:"song_upload",className:"hidden",ref:n}),a.jsx(Lg,{variant:"uploaded-song",children:o?a.jsx(a.Fragment,{children:a.jsx("div",{className:"h-[30px] mb-[10px] flex items-center",children:a.jsx(we,{className:"h-[20px] w-[90px]"})})}):a.jsxs("div",{className:"flex justify-between items-center w-full",children:[a.jsxs("p",{className:"font-[500] opacity-[.5]",children:[u," Songs"]}),a.jsxs(ce,{onClick:()=>{var d;return(d=n.current)==null?void 0:d.click()},color:"primary",disabled:s,children:[a.jsx(M1,{className:"w-5"}),a.jsx("span",{className:"",children:"Upload"})]})]})}),a.jsxs("div",{className:"",children:[o&&a.jsx(Zi,{}),!o&&a.jsx(a.Fragment,{children:u?a.jsxs(a.Fragment,{children:[!!t.length&&a.jsx($s,{setSong:d=>c(d.queue_id),songs:t,songVariant:"own-song"}),r.map((d,f)=>a.jsx(pG,{song:d},f))]}):a.jsx(Fe,{variant:"less"})})]})]}):a.jsx(a.Fragment,{})}const xG=["Favorite","Uploaded"];function yG(){const[t,e]=np("last-song-tab","Favorite");return a.jsx(a.Fragment,{children:a.jsxs("div",{children:[a.jsx(oe,{title:"Songs"}),a.jsx("div",{className:"flex space-x-2 my-3",children:a.jsx(Ur,{render:n=>n,setTab:e,tab:t,tabs:xG})}),t==="Favorite"?a.jsx(mG,{}):a.jsx(gG,{})]})})}function vG(){return a.jsxs(a.Fragment,{children:[a.jsxs(Za,{children:[a.jsx(fG,{}),a.jsx(lG,{}),a.jsx(yG,{})]}),a.jsx(ta,{})]})}function wG(){const{isFetching:t}=cG();return t?a.jsx(Ye,{children:a.jsx(nu,{})}):a.jsx(vG,{})}function Y5(){const{behind:t,ahead:e,shouldStoreLocation:n,setBehind:r,setAhead:s}=YC(),i=Wn(),o=Gt(),l=h.useMemo(()=>i.pathname+i.search,[i]);return{ahead:e,behind:t,backward:()=>{const f=[...t],p=f.pop();p&&(n.current=!1,s(g=>[...g,l]),r(f),o(p))},forward:()=>{const f=[...e],p=f.pop();p&&(n.current=!1,r(g=>[...g,l]),s(f),o(p))},goHome:()=>{o("/")}}}function _G({className:t=""}){const{backward:e,behind:n,goHome:r}=Y5(),s=()=>{n.length?e():r()};return a.jsx(ce,{onClick:s,className:`p-1.5 md:hidden z-[9] relative ${t}`,color:"primary",size:"clear",children:n.length?a.jsx(L1,{className:"w-6"}):a.jsx(Yd,{className:"w-6"})})}const bG=()=>{const[t,e]=h.useState(),[n,r]=h.useState(""),[s,i]=h.useState([]),[o,l]=h.useState([]),[c,u]=h.useState(!1),[d,f]=h.useState(!1),[p,g]=h.useState("edit"),[x,w]=h.useState(),v=h.useRef(0),_=h.useMemo(()=>x!==void 0?o[x]:void 0,[x,o]);return{song:t,setSong:e,baseLyric:n,setBaseLyric:r,baseLyricArr:s,setBaseLyricArr:i,lyrics:o,setLyrics:l,updateLyric:(j,T)=>{l(R=>{const M={...R[j],...T};return R[j]=M,[...R]})},isFetching:c,setIsFetching:u,isChanged:d,setIsChanged:f,start:v,selectLyricIndex:x,setSelectLyricIndex:w,currentLyric:_,viewMode:p,setViewMode:g}},J5=h.createContext(null);function SG({children:t}){return a.jsx(J5.Provider,{value:bG(),children:t})}const qt=()=>{const t=h.useContext(J5);if(!t)throw new Error("Edit lyric context not found");return t};function EG({audioEle:t,isClickPlay:e}){const{user:n}=ye(),{shouldFetchUserSongs:r,shouldFetchFavoriteSongs:s,lastDoc:i}=yt(),{start:o,baseLyricArr:l,lyrics:c,setLyrics:u,setIsChanged:d,song:f,setIsFetching:p,baseLyric:g}=qt(),{setErrorToast:x,setSuccessToast:w}=ne(),v=c.length>=l.length,_=e&&!!l.length&&!v;return{addLyric:()=>{if(!t||!l.length||!f||v)return;const R=+t.currentTime.toFixed(1);if(o.current===R)return;const M=l[c.length].trim(),k=QS({start:o.current,end:R,text:M});if(o.current=R,u(E=>[...E,k]),l.length===c.length+2){const E=l[l.length-1],I=QS({start:o.current,end:f.duration,text:E});u(C=>[...C,I])}d(!0)},removeLyric:()=>{if(c.length&&t){const R=c[c.length-1].start;o.current=R,t.currentTime=R,u(M=>M.slice(0,-1)),d(!0)}},isEnableAddBtn:_,submit:async()=>{try{if(p(!0),!f)return;const R=Ls(de),M={lyrics:JSON.stringify(c),base:g},k=gt(de,"Songs",f.id);if(f.lyric_id){const I=gt(de,"Lyrics",f.lyric_id);R.update(I,M)}else{const I=gt(Mt(de,"Lyrics")),C={lyric_id:I.id,updated_at:pt()};R.set(I,M),R.update(k,C)}await R.commit(),r.current=!0,i.current=void 0,(n==null?void 0:n.liked_song_ids.includes(f.id))&&(s.current=!0),w("Edit lyric successful"),d(!1)}catch(R){console.log({error:R}),x()}finally{p(!1)}}}}function jG({closeModal:t}){const{setErrorToast:e,setSuccessToast:n}=ne(),{song:r,setSong:s}=qt(),[i,o]=h.useState(),[l,c]=h.useState(!1);return{songFile:i,song:r,setSongFile:o,isFetching:l,handleSubmit:async()=>{try{if(!i||!r)throw new Error;c(!0);const{fileId:d,url:f}=await gh({file:i,folder:"/songs/"}),p={beat_url:f,beat_file_id:d};await Re({collectionName:"Songs",id:r.id,data:p}),r.beat_file_id&&Vt({fileId:r.beat_file_id}),s(()=>({...r,...p})),n("Upload song beat successful"),t()}catch(d){console.log({error:d}),e()}finally{c(!1)}}}}function kG({closeModal:t}){const e=h.useRef(null),{songFile:n,setSongFile:r,isFetching:s,handleSubmit:i,song:o}=jG({closeModal:t}),l=c=>{var u;(u=c.target.files)!=null&&u.length&&r(c.target.files[0])};return a.jsxs(je,{className:"w-[500px]",children:[a.jsx(qe,{title:"Song beat",closeModal:t}),a.jsx("label",{ref:e,className:"hidden",htmlFor:"song_upload"}),a.jsx("input",{onChange:l,type:"file",multiple:!0,accept:"audio",id:"song_upload",className:"hidden"}),o&&(n||(o==null?void 0:o.beat_url))&&a.jsx("audio",{src:n?URL.createObjectURL(n):o.beat_url,controls:!0}),a.jsx("p",{className:"mt-3",children:a.jsx(ce,{onClick:()=>{var c;return(c=e.current)==null?void 0:c.click()},color:"primary",children:a.jsx(M1,{className:"w-5"})})}),a.jsx(ce,{disabled:!n,onClick:i,isLoading:s,color:"primary",className:"mt-3 ml-auto font-playwriteCU",children:"Save"})]})}const TG=40;function Z5({modalRef:t}){const{baseLyric:e,setBaseLyric:n,baseLyricArr:r,setIsChanged:s,lyrics:i}=qt(),[o,l]=h.useState(e),c=h.useRef(null),u=h.useRef(null),d=()=>{var g;const p=o.split(/\r?\n/).filter(x=>x).filter(x=>x.trim()).join(`\r
`);n(p),s(!0),(g=t.current)==null||g.close()};function f(p){const g=[...r];return g[p]=`<div style="color: transparent; border-radius: 4px; background-color: var(--a-10-cl);">${g[p]}</div>`,g.join(`\r
`)}return h.useEffect(()=>{var p;if(i.length&&c.current&&u.current){const g=TG*(i.length-1);c.current.scrollTop=g,u.current.style.paddingBottom=g+"px"}(p=t.current)==null||p.setModalPersist(!0)},[]),h.useEffect(()=>{const p=()=>{if(c.current&&u.current){const g=c.current.scrollTop;u.current.scrollTop=g}};return c.current&&c.current.addEventListener("scroll",p),()=>{c.current&&c.current.removeEventListener("scroll",p)}},[]),a.jsxs(je,{className:"w-[500px]",children:[a.jsx(qe,{closeModal:()=>{var p;return(p=t.current)==null?void 0:p.close()},title:"Edit lyric"}),a.jsxs("div",{className:`relative h-[60vh] overflow-hidden rounded-md ${location.hash.includes("/dashboard")?"bg-black/10":"bg-white/10"} `,children:[e&&a.jsx("div",{ref:u,className:"whitespace-break-spaces text-transparent px-3 py-2 absolute leading-[40px] h-full overflow-auto top-0 left-0 w-full",dangerouslySetInnerHTML:{__html:f(i.length===r.length?i.length+1:i.length)}}),a.jsx("textarea",{style:{resize:"none"},ref:c,className:"absolute bg-transparent top-0 outline-none w-full leading-[40px] py-2 px-3 h-full",value:o,onChange:p=>l(p.target.value)})]}),a.jsx("p",{className:"ml-auto mt-5",children:a.jsx(ce,{onClick:d,color:"primary",className:"rounded-full",children:"Save"})})]})}function sE(t){const[e,n,r]=t.split(":"),[s,i]=r.split(","),o=Math.round(+i.slice(0,3)/100);return+n*60+ +s+ +("0."+o)}function IG(t){const e=t.split(`
`),n=[];let r={start:0,end:0,text:"",cut:[],tune:{start:0,end:0,grow:[]}};for(let s=0;s<e.length;s++){const i=e[s].trim();if(!i){if(!r.text)continue;const o=r.text.trim(),l=o.split(" "),c=l.map(()=>[]),u=l.map(()=>0),d={text:o,tune:{start:r.start,end:r.end,grow:u},cut:c};Object.assign(r,d),n.push({...r}),r.text=""}if(isNaN(+i))if(i.includes("-->")){const[o,l]=i.split("-->").map(d=>d.trim()),c=sE(o),u=sE(l);if(isNaN(c)||isNaN(u))throw new Error(`Error at '${s}'`);Object.assign(r,{start:c,end:u})}else r.text+=i.trim()+" "}return n}function CG(){const{setErrorToast:t}=ne(),{setLyrics:e,setIsChanged:n,setViewMode:r}=qt();return{handleInputChange:i=>{if(!i.target.files)return;const o=i.target.files[0],l=["json","srt"],c=o.name.split(".")[o.name.split(".").length-1],u=new FileReader;u.onload=d=>{var f,p;try{if(!((f=d.target)!=null&&f.result)||typeof d.target.result!="string")return;if(c==="json"){const g=JSON.parse(((p=d.target)==null?void 0:p.result)||"[]");e(g)}else{const g=IG(d.target.result);e(g)}n(!0),r("import")}catch(g){console.log(g),t(g.message||"")}finally{i.target.value=""}},l.includes(c)?u.readAsText(o):(t("File not supported"),i.target.value="")}}}function RG(){const{lyrics:t,song:e}=qt(),n=(s,i)=>{if(!e)return;const o=new Blob([s],{type:"application/json"}),l=URL.createObjectURL(o),c=document.createElement("a");c.href=l,c.download=`${Un(e.name)}.${i}`,c.click(),URL.revokeObjectURL(l)};return{exportLyric:({type:s})=>{switch(s){case"json":n(JSON.stringify(t,null,2),"json");break;case"srt":{let i="";const o=l=>{const c=Math.floor(l/60),u=Math.floor(l%60),d=`${c.toString().padStart(2,"0")}:${u.toString().padStart(2,"0")}`,[f,p="0"]=l.toString().split(".");return`00:${d},${+p*100}`};t.forEach((l,c)=>{i+=`${c+1}
${o(l.start)} --> ${o(l.end)}
${l.text}

`}),n(i,"srt");break}}}}}function eN({closeModal:t}){const{lyrics:e,setLyrics:n,setIsChanged:r,song:s}=qt(),{setErrorToast:i}=ne(),o=h.useRef(null),[l,c]=h.useState(!1),u=d=>{var g;if(d.preventDefault(),!s)return;const f=+(((g=o.current)==null?void 0:g.value)||"");if(!f)return;const p=+un()["edit_current-lyric-index"];if(!isNaN(p)){const x=[...e],w=_=>{const b={start:+(x[_].start+f).toFixed(1),end:+(x[_].end+f).toFixed(1)};x[_]={...x[_],...b,tune:{...x[_].tune,...b}}};if(f<0&&e[p].start+f<(p>0?e[p-1].start:0)){i("Invalid number");return}let v=p;for(;v<e.length&&(w(v),!l);v++);p>0&&(x[p-1].end=x[p].start,x[p-1].tune.end=x[p].start),x[e.length-1].end=s.duration,x[e.length-1].tune.end=s.duration,n(x),r(!0),t()}};return h.useEffect(()=>{var d;(d=o.current)==null||d.focus()},[]),a.jsxs(je,{children:[a.jsx(qe,{title:"Sync lyric",closeModal:t}),a.jsxs("form",{action:"",onSubmit:u,children:[a.jsx(En,{step:.2,ref:o,type:"number"}),a.jsxs("div",{className:"flex items-center mt-3",children:[a.jsx("input",{checked:l,onChange:()=>c(d=>!d),type:"checkbox",id:"for-this-line",className:""}),a.jsx(kt,{htmlFor:"for-this-line",className:"ml-2",children:"For this line only"})]}),a.jsx("p",{className:"mt-5 text-right",children:a.jsx(J,{type:"submit",children:"Save"})})]})]})}function NG({pause:t}){const{song:e,lyrics:n}=qt(),[r,s]=h.useState(""),i=h.useRef(null),{handleInputChange:o}=CG(),{exportLyric:l}=RG(),c=f=>{var p;s(f),(p=i.current)==null||p.open()},u=()=>{var f;return(f=i.current)==null?void 0:f.close()},d=()=>{if(r)switch(r){case"lyric":return a.jsx(Z5,{modalRef:i});case"song-beat":return e&&a.jsx(kG,{closeModal:u});case"export":return a.jsxs(je,{children:[a.jsx(qe,{title:"Export",closeModal:u}),a.jsxs("div",{className:"flex ",children:[a.jsx(ce,{color:"primary",onClick:()=>l({type:"json"}),children:"JSON"}),a.jsx(ce,{color:"primary",onClick:()=>l({type:"srt"}),className:"ml-2",children:"SRT"})]})]});case"sync":return a.jsx(eN,{closeModal:u})}};return a.jsxs(a.Fragment,{children:[a.jsx("input",{id:"import_lyric",onChange:o,type:"file",className:"hidden"}),a.jsxs(nr,{appendOnPortal:!0,children:[a.jsx(rr,{children:a.jsx(ce,{size:"clear",color:"primary",className:"h-[36px] w-[36px] justify-center rounded-full mt-2",children:a.jsx(Qd,{className:"w-6"})})}),a.jsx(sr,{origin:"top right",children:a.jsx(cr,{className:"w-[220px]",children:a.jsxs(ls,{cb:t,children:[a.jsxs("button",{onClick:()=>c("lyric"),children:[a.jsx(is,{}),a.jsx("span",{children:"Edit lyric"})]}),!(e!=null&&e.is_official)&&a.jsxs("button",{onClick:()=>c("search"),children:[a.jsx(Jd,{}),a.jsx("span",{children:"Search lyric"})]}),a.jsxs("button",{onClick:()=>c("song-beat"),children:[a.jsx(qi,{}),a.jsx("span",{children:"Song beat"})]}),a.jsx("button",{className:"!p-0",children:a.jsxs("label",{className:"flex w-full px-3 py-2 cursor-pointer items-center space-x-2",htmlFor:"import_lyric",children:[a.jsx(Kd,{}),a.jsx("span",{children:"Import (JSON or SRT)"})]})}),a.jsxs("button",{disabled:!n.length,onClick:()=>c("export"),children:[a.jsx(i6,{}),a.jsx("span",{children:"Export"})]})]})})})]}),a.jsx(ie,{variant:"animation",ref:i,children:d()})]})}function AG({audioEle:t},e){const{lyrics:n,viewMode:r,baseLyric:s,setViewMode:i}=qt(),[o,l]=h.useState(""),c=h.useRef(null),u=E=>{var I;l(E),(I=c.current)==null||I.open(),x()},{handlePlayPause:d,currentTimeRef:f,durationRef:p,progressLineRef:g,pause:x,seek:w,status:v,isClickPlay:_}=bg({audioEle:t}),{addLyric:b,removeLyric:j,isEnableAddBtn:T,submit:R}=EG({audioEle:t,isClickPlay:_});h.useImperativeHandle(e,()=>({seek:w,pause:x,submit:R}));const M=()=>{if(!_&&n.length){const E=n[n.length-1].end;t.currentTime=E}d()},k=()=>{switch(v){case"error":return a.jsx(Up,{className:"w-6"});case"playing":return a.jsx(NT,{className:"w-6"});case"paused":return a.jsx(AT,{className:"w-6"});case"waiting":return a.jsx(Me,{className:"w-6 animate-spin"})}};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-start flex-wrap -mt-2 -ml-2 [&_svg]:w-6 [&_button]:outline-none [&_button]:ml-2 [&_button]:mt-2",children:[a.jsx(T5,{className:"mt-2 ml-2",audioEle:t,postLocalStorageKey:"edit_lyric"}),a.jsx(ce,{color:"primary",onClick:M,children:k()}),r==="edit"&&!!s&&a.jsxs(a.Fragment,{children:[a.jsxs(ce,{disabled:!T,onClick:b,color:"primary",children:[a.jsx(Wt,{}),a.jsx("span",{children:"Add"})]}),a.jsxs(ce,{disabled:!n.length,onClick:j,color:"primary",children:[a.jsx($1,{}),a.jsx("span",{children:"Remove"})]})]}),r==="edit"&&!!s&&a.jsx(ce,{onClick:()=>u("lyric"),color:"primary",children:a.jsx("span",{children:"Lyric"})}),r!=="import"&&a.jsxs(ce,{disabled:!n.length,onClick:()=>{i(r==="edit"?"preview":"edit"),x()},color:"primary",children:[a.jsx(G6,{}),a.jsx("span",{children:r==="preview"?"Preview":"Edit"})]}),r==="import"||r==="preview"&&a.jsx(a.Fragment,{children:a.jsxs(ce,{color:"primary",onClick:()=>{u("sync")},children:[a.jsx(Me,{}),a.jsx("span",{children:"Sync lyric"})]})}),a.jsx("div",{className:"ml-auto",children:a.jsx(NG,{pause:x})})]}),a.jsxs("div",{className:"flex items-center mt-3",children:[a.jsx("div",{className:"text-sm w-[50px]",ref:f,children:"00:00"}),a.jsx("div",{ref:g,style:{backgroundColor:"var(--a-5-cl)"},className:"h-1 rounded-full w-full progress-line"}),a.jsx("div",{className:"text-sm w-[50px] text-right",ref:p,children:"00:00"})]}),a.jsxs(ie,{variant:"animation",ref:c,children:[o==="sync"&&a.jsx(eN,{closeModal:()=>{var E;return(E=c.current)==null?void 0:E.close()}}),o==="lyric"&&a.jsx(Z5,{modalRef:c})]})]})}const PG=h.forwardRef(AG);function FG({lyric:t,openModal:e,seek:n,isLast:r,status:s,viewMode:i,removeLyric:o},l){const c=()=>{switch(s){case"active":return"text-[--primary-cl] dark:text-[#ffed00] active-lyric";default:return""}};return a.jsx(a.Fragment,{children:a.jsxs("div",{className:"pt-3 last:mb-[30vh]",children:[a.jsxs("div",{className:`flex ${i!=="edit"?"justify-center":""}  space-x-1.5 mb-1`,children:[a.jsx("button",{className:"hover:underline item-info",onClick:()=>n(t.start),children:Xs(+t.start)}),a.jsx("button",{onClick:e,className:"",children:a.jsx(y$,{className:"w-5"})}),i==="import"&&a.jsx(a.Fragment,{children:a.jsx("button",{onClick:o,className:"",children:a.jsx(xt,{className:"w-5"})})})]}),a.jsx("p",{ref:l,className:`font-[700] select-none relative ${c()}`,children:t.text}),r&&t.end!==t.start&&a.jsx("button",{className:"hover:underline pt-[10px]",onClick:()=>n(t.end),children:Xs(+t.end)})]})})}const MG=h.forwardRef(FG);function DG({text:t,className:e="",status:n,activeColor:r},s){const i=()=>{switch(n){case"coming":return"";case"active":return`${r||"text-[#ffed00]"} active-lyric`;case"done":return""}};return a.jsx("p",{ref:s,className:`${e} ${i()}`,children:t})}const tN=h.forwardRef(DG),LG=.3;function nN({audioEle:t,lyrics:e,isActive:n,noReset:r=!1,bounded:s}){const[i,o]=h.useState(0),l=h.useRef("instant"),c=h.useRef(0),u=h.useRef([]),d=h.useRef(0),f=()=>{if(u.current[0]===null)return;const g=t.currentTime>c.current?"forward":"backward";c.current=t.currentTime;let x=d.current;const w=s||LG;switch(g){case"forward":for(;e[x+1]&&e[x+1].start-w<c.current+w;)x+=1;break;case"backward":for(;e[x-1]&&e[x-1].end-w>c.current+w;)x-=1;break}x!==d.current&&(Math.abs(x-d.current)>5&&(l.current="instant"),d.current=x,o(x),u.current[x]&&WC(u.current[x],l.current),l.current==="instant"&&(l.current="smooth"))},p=()=>{o(0),d.current=0,c.current=0};return h.useEffect(()=>(n&&f(),()=>{n||p()}),[n]),h.useEffect(()=>{if(!(!n||!e.length))return t.addEventListener("timeupdate",f),()=>{t.removeEventListener("timeupdate",f)}},[e,n]),h.useEffect(()=>()=>{r||p()},[e]),{currentIndex:i,lyricRefs:u}}function OG(){const{viewMode:t,lyrics:e,baseLyricArr:n}=qt(),r=h.useRef(null),s=h.useRef("instant");return h.useEffect(()=>{!r.current||t==="preview"||(WC(r.current,s.current),s.current="instant",s.current==="instant"&&(s.current="smooth"))},[e.length,t,n.length]),h.useEffect(()=>()=>{s.current="instant"},[t]),{activeLyricRef:r}}function $G({controlRef:t,audioEle:e,openEditModal:n}){const{baseLyricArr:r,lyrics:s,setLyrics:i,setSelectLyricIndex:o,song:l,viewMode:c}=qt(),{currentIndex:u,lyricRefs:d}=nN({audioEle:e,isActive:c!=="edit",lyrics:s,noReset:!0,bounded:0}),{activeLyricRef:f}=OG(),p=w=>{var v;(v=t.current)==null||v.seek(w)},g=w=>{var v;typeof w=="number"&&((v=t.current)==null||v.pause(),o(w),n())},x=w=>{if(!l)return;const v=[...s],_=w===s.length-1;w===0?v[1].start=0:_||(v[w-1].end=v[w+1].start),v.splice(w,1),v[v.length-1].end=l.duration,i(v)};return h.useEffect(()=>{ot("edit_current-lyric-index",u)},[u]),a.jsx(a.Fragment,{children:a.jsxs("div",{className:`flex-grow overflow-auto flex font-[Inter,system-ui] no-scrollbar rounded-xl px-2 pt-3 mt-3 bg-[--popup-cl] popup-shadow ${Oa(c!=="edit","justify-center")}`,children:[!!r.length&&a.jsx("div",{className:`w-1/2 ${Oa(c!=="edit","hidden")}`,children:a.jsx(a.Fragment,{children:r.map((w,v)=>{let _=v===s.length?"active":v<s.length?"done":"coming";return _==="done"&&v===r.length-1&&(_="active"),a.jsx(tN,{ref:_==="active"?f:null,className:"pt-10",activeColor:"text-[--primary-cl]",status:_,text:w},v)})})}),a.jsx("div",{className:`w-1/2 ${Oa(c!=="edit","text-center")}`,children:!!(s!=null&&s.length)&&l&&s.map((w,v)=>{let _="coming";return c!=="edit"&&(u===v?_="active":v<u&&(_="done")),a.jsx(MG,{ref:b=>d.current[v]=b,openModal:()=>g(v),seek:p,removeLyric:()=>x(v),viewMode:c,lyric:w,status:_,activeColor:"text-[#ffed00]",isLast:v===s.length-1&&v!==r.length-1},v)})})]})})}const zG=location.hash.includes("/dashboard");function BG({audioRef:t}){const{user:e}=ye(),{baseLyric:n,setSong:r,song:s,setBaseLyricArr:i,setBaseLyric:o,setLyrics:l,isChanged:c,isFetching:u,start:d}=qt(),[f,p]=h.useState(!0),g=h.useRef(!1),x=Wi(),w=Gt(),v=b=>{if(!b.length)return;const j=b.length-1;if(t.current){const T=b[j].end;d.current=T,t.current.currentTime=T}},_=async()=>{try{if(!x.id||!e)throw new Error("");const b=await en({collectionName:"Songs",id:x.id});if(!b.exists())throw new Error("");const j={...b.data(),id:b.id,queue_id:""};if(zG){if(!j.is_official){w("/dashboard/song");return}}else if(j.is_official||j.owner_email!==e.email)return;if(j.lyric_id){const T=await en({collectionName:"Lyrics",id:j.lyric_id});if(T.exists()){const{base:R,lyrics:M}=T.data(),k=JSON.parse(M);o(R),l(k),v(k)}}r(j)}catch(b){console.log({message:b})}finally{p(!1)}};return h.useEffect(()=>{g.current||(g.current=!0,s?p(!1):_())},[]),h.useEffect(()=>{if(!n)return;const b=n.split(/\r?\n/);i(b)},[n]),h.useEffect(()=>{if(!c)return;const b=j=>{j.preventDefault()};return window.addEventListener("beforeunload",b),()=>{window.removeEventListener("beforeunload",b)}},[c]),{isFetching:f,song:s,isChanged:c,isSubmitting:u}}function rN(t,e){if(e.length===1&&e[0]===0)return[t];const n=[];let r=0;e.sort((s,i)=>s-i);for(const s of e)s>t.length||s<0||(n.push(t.substring(r,s)),r=s);return n.push(t.substring(r)),n}const VG=["Edit","Record"];function UG(){const[t,e]=h.useState(0),[n,r]=h.useState(),[s,i]=h.useState(""),[o,l]=h.useState([[]]),[c,u]=h.useState([]),[d,f]=h.useState(!1),[p,g]=h.useState("Edit"),[x,w]=h.useState("paused"),v=h.useRef(null),_=h.useRef(null),b=h.useRef(null),j=h.useRef(null),T=h.useRef(null),R=h.useRef(null),M=h.useRef(null),k=h.useRef(null),E=h.useRef(),I=h.useRef(!1),C=h.useRef(0),A=h.useRef(0),D=h.useRef(0),P=h.useRef([]),ee=h.useRef([]),_e=h.useRef(!0),He=h.useRef(!1),Be=h.useMemo(()=>s.split(" ").filter(X=>X.trim()),[s]),B=h.useMemo(()=>Be.map((X,he)=>({text:X,positions:o[he]})),[s,o]),K=h.useMemo(()=>{const X=[];return B.forEach(he=>{const pe=rN(he.text,he.positions);X.push(...pe)}),X.filter(he=>he)},[s,o]);return{eleRefs:{endTimeRangeRef:_,overlayRef:v,startTimeRangeRef:b,startRefText:j,endRefText:T,currentWordRef:R,growInputRef:M,tempWordRef:k},tabProps:{tab:p,setTab:g,tabs:VG},eventRefs:{playWhenSpaceRef:_e,moveArrowToGrowRef:He},currentWords:Be,currentWordsData:B,currentSplitWords:K,actuallyEndRef:C,playerRef:E,actuallyStartRef:A,tempActuallyStartRef:D,wordsRatioRef:P,mergedGrowListRef:ee,isChangedRef:I,wordIndex:t,setWordIndex:e,growList:c,setGrowList:u,isOpenEditLyricModal:d,SetIsOpenEditLyricModal:f,setStatus:w,status:x,text:s,setText:i,cut:o,setCut:l,localLyricIndex:n,setLoacalLyricIndex:r}}const sN=h.createContext(null);function HG({children:t}){return a.jsx(sN.Provider,{value:UG(),children:t})}const nn=()=>{const t=h.useContext(sN);if(!t)throw new Error("LyricEditorProvider not found");return t};function iN(t,e){const n=`lyric_${fl(4)}`,r=document.querySelector("style.keyframe");if(!r)return n;let s=`@keyframes ${n}{0%{width:0%}`;if(t.findIndex(d=>!d)!==-1)return s+="100%{width:100%}}",r.innerText=s,n;let o=t.reduce((d,f)=>d+f,0);const l=[];let c=0,u=0;for(let d=0;d<e.length-1;d++){const f=e[d],p=t[d];u+=f,c+=p,l.push({progress:Math.round(c/o*100),width:u})}for(const d of l)s+=`${d.progress}%{width:${d.width}%}`;return s+="100%{width:100%}}",r.innerText=s,n}function GG({audioEle:t}){const{eleRefs:e,actuallyEndRef:n,actuallyStartRef:r,tempActuallyStartRef:s,wordsRatioRef:i,mergedGrowListRef:o,status:l,setStatus:c}=nn(),{play:u,pause:d,statusRef:f}=bg({audioEle:t,statusFromParent:l,setStatusFromParent:c}),{overlayRef:p}=e,g=()=>{d(),p.current&&(p.current.style.animation="none")},x=()=>{if(t.currentTime=r.current,!s.current&&p.current){const _=iN(o.current,i.current);p.current.style.animation=`${_} ${((n.current-r.current)/t.playbackRate).toFixed(2)}s linear`}u()},w=()=>{f.current==="paused"?x():g()},v=()=>{if(+t.currentTime.toFixed(1)>=n.current)return g()};return h.useEffect(()=>{if(t)return t.addEventListener("timeupdate",v),()=>{t.removeEventListener("timeupdate",v)}},[]),{handlePlayPause:w,_pause:g,_play:x,status:l}}function WG({audioEle:t}){const{playerRef:e}=nn(),{_play:n,_pause:r,handlePlayPause:s}=GG({audioEle:t});return h.useEffect(()=>{e.current={handlePlayPause:s,pause:r,play:n}},[]),a.jsx(a.Fragment,{})}function qG(){const{status:t,playerRef:e}=nn();return a.jsx(ce,{size:"clear",className:"p-1.5",onClick:()=>{var n;return(n=e.current)==null?void 0:n.handlePlayPause()},color:"primary",children:t==="playing"?a.jsx(hl,{className:"w-6"}):a.jsx(si,{className:"w-6"})})}function KG(){const{currentWords:t}=nn(),{currentLyric:e,lyrics:n,setLyrics:r,selectLyricIndex:s}=qt(),i=h.useRef(null),o=l=>{var x;if(!e||s===void 0)return;const c=[...n],u=[...t],d=JSON.parse(JSON.stringify(e)),f=+(d.start+(d.end-d.start)/2).toFixed(1),p={text:u.splice(0,l).join(" "),cut:d.cut.splice(0,l),tune:{start:d.start,grow:d.tune.grow.splice(0,l),end:f},start:d.start,end:f},g={text:u.join(" "),cut:d.cut,tune:{start:f,grow:d.tune.grow,end:d.end},start:f,end:d.end};c[s]=p,c.splice(s+1,0,g),r(c),(x=i.current)==null||x.close()};return a.jsxs(a.Fragment,{children:[a.jsx(ce,{onClick:()=>{var l;return(l=i.current)==null?void 0:l.open()},size:"clear",className:"p-1.5",color:"primary",children:a.jsxs("svg",{viewBox:"0 0 15 15",fill:"none",className:"w-6",xmlns:"http://www.w3.org/2000/svg",stroke:"currentColor",strokeWidth:"1",children:[a.jsx("g",{strokeWidth:"0"}),a.jsx("g",{strokeLinecap:"round",strokeLinejoin:"round"}),a.jsx("g",{children:a.jsx("path",{d:"M1.5 11V6.5C1.5 5.39543 2.39543 4.5 3.5 4.5C4.60457 4.5 5.5 5.39543 5.5 6.5V11M1.5 8.5H5.5M12 7.5H9.5M12 7.5C12.8284 7.5 13.5 6.82843 13.5 6C13.5 5.17157 12.8284 4.5 12 4.5H9.5V7.5M12 7.5C12.8284 7.5 13.5 8.17157 13.5 9C13.5 9.82843 12.8284 10.5 12 10.5H9.5V7.5M7.5 1V14",stroke:"currentColor"})})]})}),a.jsx(ie,{variant:"animation",ref:i,children:a.jsxs(je,{children:[a.jsx(qe,{title:"Split lyric",closeModal:()=>{var l;return(l=i.current)==null?void 0:l.close()}}),a.jsx(kt,{children:"Choose where to start the next lyric"}),a.jsx("div",{className:"flex flex-wrap mt-5",children:t.map((l,c)=>a.jsx("button",{onClick:()=>o(c),className:"bg-[--a-5-cl] p-1.5 rounded-full",children:l},c))})]})})]})}function QG({audioEle:t}){const{tabProps:e}=nn();return a.jsxs(a.Fragment,{children:[a.jsx(WG,{audioEle:t}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(Ur,{...e,render:n=>n}),a.jsxs("div",{className:"flex space-x-2",children:[a.jsx(qG,{}),a.jsx(KG,{}),a.jsx(T5,{positions:"left",audioEle:t,postLocalStorageKey:"edit_lyric_tune"})]})]})]})}function XG(){const{updateLyric:t,setIsChanged:e,selectLyricIndex:n}=qt(),{actuallyEndRef:r,actuallyStartRef:s,growList:i,text:o,cut:l}=nn();return{updateLyricTune:async()=>{if(typeof n!="number")throw new Error("selectLyricIndex is undefine");const u={tune:{start:s.current,end:r.current,grow:i},cut:l,text:o};t(n,u),e(!0)}}}function YG({closeModal:t}){const{setSelectLyricIndex:e,selectLyricIndex:n,lyrics:r}=qt(),{isChangedRef:s,playerRef:i}=nn(),{updateLyricTune:o}=XG(),l=()=>{o(),t()},c=u=>{var d;if(typeof n=="number")switch(s.current&&(s.current=!1,o()),(d=i.current)==null||d.pause(),u){case"next":if(n===r.length-1)return;e(f=>f+1);break;case"prev":if(n===0)return;e(f=>f-1);break}};return a.jsxs("div",{className:"flex justify-end space-x-2 mt-5 ",children:[a.jsxs(ce,{color:"primary",disabled:n===0,onClick:()=>c("prev"),children:[a.jsx(P1,{className:"w-6"}),a.jsx("span",{className:"hidden md:block",children:"Previous"})]}),a.jsxs(ce,{color:"primary",disabled:n===r.length-1,onClick:()=>c("next"),children:[a.jsx("span",{className:"hidden md:block",children:"Next"}),a.jsx(ET,{className:"w-6"})]}),a.jsxs(ce,{disabled:!s.current,color:"primary",onClick:l,children:[a.jsx(Xa,{className:"w-6"}),a.jsx("span",{children:"Ok"})]})]})}function JG(){const{isOpenEditLyricModal:t,playerRef:e,eleRefs:{currentWordRef:n},eventRefs:r}=nn(),s=o=>{var l;if(o.key===" "){if(!r.playWhenSpaceRef.current)return;o.preventDefault(),console.log("handle play pause"),(l=e.current)==null||l.handlePlayPause()}if(o.key==="ArrowRight"||o.key==="ArrowLeft"){if(!r.moveArrowToGrowRef.current)return;const c=n.current;if(!c)return;switch(o.key){case"ArrowRight":o.preventDefault(),c!=null&&c.nextSibling&&(c==null?void 0:c.nextSibling).click();break;case"ArrowLeft":o.preventDefault(),c!=null&&c.previousSibling&&(c==null?void 0:c.previousSibling).click();break}}},i=o=>{if(!r.moveArrowToGrowRef.current)return;const l=o.target,c=document.querySelectorAll(".word-item");let u=!1;c.forEach(d=>d.contains(l)?u=!0:{}),!u&&(r.moveArrowToGrowRef.current=!1)};h.useEffect(()=>(window.addEventListener("mousedown",i),window.addEventListener("keydown",s),()=>{window.removeEventListener("mousedown",i),window.removeEventListener("keydown",s)}),[t])}const aN=t=>{const e=t.clientWidth,n=[];return t.childNodes.forEach(r=>{n.push(Math.round(r.offsetWidth/e*100))}),n};function f_(t,e,n){const r=[];if(!n.length)return[];let s=0;return t.forEach((i,o)=>{const l=e[o].length;if(l===0)r.push(n[s]),s++;else if(l>0){const u=n.slice(s,s+l+1).reduce((d,f)=>(s++,+(d+f).toFixed(1)),0);r.push(u)}}),r}function ZG(){const{selectLyricIndex:t,currentLyric:e,lyrics:n}=qt(),{eleRefs:r,actuallyEndRef:s,mergedGrowListRef:i,actuallyStartRef:o,wordsRatioRef:l,setGrowList:c,setCut:u,setText:d,currentWords:f}=nn(),{tempWordRef:p,endTimeRangeRef:g,startTimeRangeRef:x,startRefText:w,endRefText:v}=r;h.useEffect(()=>{if(!p.current)return;const _=aN(p.current);l.current=_},[f]),h.useEffect(()=>{if(!e)return;const _=e.tune.grow,b=e.text.split(" ").filter(T=>T.trim());d(e.text),u(e.cut);const j=f_(b,e.cut,_);c(_),i.current=j,v.current&&w.current&&x.current&&g.current&&(o.current=e!=null&&e.tune?e.tune.start:e.start,w.current.innerText=`${Xs(e.start)} / ${Xs(o.current)}`,x.current.max=e.end+"",x.current.value=o.current+"",s.current=e!=null&&e.tune?e.tune.end:e.end,v.current.innerText=`${Xs(s.current)} / ${Xs(e.end)}`,g.current.max=e.end+"",g.current.value=s.current+"")},[t,n.length])}function eW({audioEle:t}){const{playerRef:e,isChangedRef:n,tabProps:{tab:r,setTab:s},setGrowList:i,cut:o,actuallyStartRef:l,mergedGrowListRef:c,currentSplitWords:u,currentWords:d}=nn(),[f,p]=h.useState(!1),[g,x]=h.useState([]),w=h.useRef(Date.now()),v=h.useRef(!1),_=h.useRef(!1),b=()=>{const D=+(t.currentTime-w.current).toFixed(2);x(P=>[...P,D])},j=()=>{var D;w.current=t.currentTime,v.current||(v.current=!0,(D=e.current)==null||D.play(),p(!0))},T=()=>{v.current&&b()},R=D=>{D.key===" "&&(_.current||(D.preventDefault(),_.current=!0,j()))},M=D=>{D.key===" "&&(D.preventDefault(),T(),_.current=!1)},I={onPointerDown:()=>{j()},onPointerUp:()=>{T()}},C=()=>{var D;(D=e.current)==null||D.pause(),v.current=!1,x([]),p(!1)},A=()=>{n.current=!0,i(g);const D=f_(d,o,g);c.current=D,s("Edit"),C()};return h.useEffect(()=>{g.length===u.length&&A()},[g]),h.useEffect(()=>{var D;if(r==="Record")return(D=e.current)==null||D.pause(),window.addEventListener("keydown",R),window.addEventListener("keyup",M),t.currentTime=l.current,()=>{var P;(P=e.current)==null||P.pause(),window.removeEventListener("keydown",R),window.removeEventListener("keyup",M)}},[r]),{localGrowList:g,buttonProps:I,clear:C,isRecording:f}}function tW({audioEle:t}){const{currentSplitWords:e}=nn(),{buttonProps:n,localGrowList:r,isRecording:s,clear:i}=eW({audioEle:t});return a.jsxs(a.Fragment,{children:[a.jsx(ce,{disabled:!s,size:"clear",className:"p-1.5",onClick:i,color:"primary",children:a.jsx(ol,{className:"w-6"})}),a.jsxs("div",{className:"flex-grow flex flex-col justify-center",children:[a.jsx("div",{className:"md:text-xl font-[700] text-center",children:e.map((o,l)=>a.jsxs("span",{className:`${l<r.length?"text-[--primary-cl]":""} leading-[1]`,children:[o," "]},l))}),a.jsx("p",{className:"mt-5 text-center md:hidden",children:a.jsx(ce,{...n,color:"primary",children:"Record"})})]})]})}function nW(){const{currentLyric:t}=qt(),{eleRefs:e,isChangedRef:n,actuallyEndRef:r,actuallyStartRef:s,tempActuallyStartRef:i,setGrowList:o}=nn(),{startRefText:l,endRefText:c}=e;return{setEndPoint:g=>{if(!t)return;const x=+g.toFixed(1);n.current=!0,r.current=x,c.current&&(c.current.textContent=`${Xs(x)} / ${Xs(t.end)}`),i.current&&(r.current=x,s.current=x-1)},setStartPoint:g=>{if(!t)return;const x=+g.toFixed(1);n.current=!0,s.current=x,l.current&&(l.current.textContent=`${Xs(t.start)} / ${Xs(x)}`)},endTimeRangeProps:{onFocus:()=>{i.current=s.current,s.current=r.current-1},onBlur:()=>{s.current=i.current,i.current=0}},handleGrowWord:g=>{n.current=!0,o(x=>{const w=[...x];let v=w[g.index];switch(g.variant){case"range":v=g.value;break;case"button":v=+(g.action==="minus"?v-.1:v+.1).toFixed(1)}return v<0&&(v=0),w[g.index]=v,w})}}}function rW(){const{setStartPoint:t,setEndPoint:e,endTimeRangeProps:n,handleGrowWord:r}=nW(),{currentLyric:s}=qt(),{wordIndex:i,growList:o,eleRefs:l}=nn();return s?a.jsxs("div",{className:"[&>div]:flex [&>div]:space-x-2 space-y-3 [&_label]:w-[160px] [&_label]:flex-shrink-0",children:[a.jsxs("div",{children:[a.jsxs(kt,{htmlFor:"start",children:["Start: ",a.jsx("span",{ref:l.startRefText})]}),a.jsx("input",{ref:l.startTimeRangeRef,type:"range",id:"start",min:s.start,max:s.end,step:.2,className:"w-full",onChange:c=>t(+c.target.value)})]}),a.jsxs("div",{children:[a.jsxs(kt,{htmlFor:"end",children:["End: ",a.jsx("span",{ref:l.endRefText})]}),a.jsx("input",{id:"end",ref:l.endTimeRangeRef,type:"range",min:s.start,step:.2,className:"w-full",onChange:c=>e(+c.target.value),...n})]}),a.jsxs("div",{children:[a.jsxs(kt,{htmlFor:"grow",children:["Grow: ",o[i]]}),a.jsx("input",{ref:l.growInputRef,type:"range",id:"grow",min:0,max:10,step:.1,className:"w-full",value:o[i]+"",onChange:c=>r({variant:"range",value:+c.target.value,index:i})})]})]}):a.jsx(a.Fragment,{})}function sW(){const{eleRefs:t,eventRefs:e,setText:n,mergedGrowListRef:r,setCut:s,setGrowList:i,text:o,isChangedRef:l}=nn(),{currentLyric:c}=qt(),[u,d]=h.useState(!1),f=h.useRef(null),p=()=>{if(!f.current)return;const g=f.current.value.split(/\r?\n/).filter(v=>v).map(v=>v.trim()).join(" ").split(" ").filter(v=>v).join(" ");n(g);const x=g.split(" ").map(()=>0),w=g.split(" ").map(()=>[]);s(w),i(x),r.current=x,d(!1),l.current=!0};return h.useEffect(()=>{u?(e.playWhenSpaceRef.current=!1,e.moveArrowToGrowRef.current=!1,f.current&&(f.current.value=o,f.current.focus())):(e.playWhenSpaceRef.current=!0,e.moveArrowToGrowRef.current=!0)},[u]),h.useEffect(()=>{u&&d(!1)},[c]),a.jsxs("div",{className:"mt-3 relative pt-5 font-[Inter,system-ui]",children:[a.jsx("div",{className:"absolute top-0 right-0 flex justify-end w space-x-2 hover:[&>button]:bg-black/10 [&>button]:rounded-full [&>button]:p-1",children:u?a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>d(!1),children:a.jsx(ol,{className:"w-5"})}),a.jsx("button",{onClick:p,children:a.jsx(Xa,{className:"w-5"})})]}):a.jsx("button",{onClick:()=>d(!0),children:a.jsx(is,{className:"w-5"})})}),a.jsx("div",{className:"flex justify-center",children:u?a.jsx("textarea",{ref:f,rows:1,className:`${xc} w-full mt-3 bg-[--a-5-cl]`}):a.jsx(a.Fragment,{children:a.jsxs("div",{className:"relative whitespace-nowrap  sm:text-2xl font-[700]",children:[o,a.jsx("div",{ref:t.overlayRef,className:"absolute  top-0 left-0 overflow-hidden text-[--primary-cl] whitespace-nowrap w-0",children:o})]})})})]})}function iW({text:t,openModal:e,isShowScissor:n,index:r}){const{growList:s,setWordIndex:i,wordIndex:o,eventRefs:l,eleRefs:c}=nn(),u=o===r,d=()=>{var f;r!==-1&&(i(r),l.moveArrowToGrowRef.current=!0,(f=c.growInputRef.current)==null||f.focus())};return a.jsxs("div",{ref:f=>u?c.currentWordRef.current=f:{},style:{flexGrow:s[r]!==0?s[r]:.05},onClick:d,className:`word-item cursor-pointer relative rounded-full flex items-center justify-center 
      ${u?"bg-[--primary-cl] text-white":"bg-[--a-5-cl]"}`,children:[a.jsx("span",{children:t}),n&&u&&a.jsx(ce,{onClick:e,size:"clear",className:"!absolute bottom-0 translate-y-[16px] bg-[--popup-cl] text-[--text-cl] popup-shadow p-1.5",children:a.jsx(PT,{className:"w-5"})})]})}function aW({wordData:t,wordIndex:e,closeModal:n}){const{currentLyric:r,selectLyricIndex:s}=qt(),{setCut:i,cut:o}=nn(),[l,c]=h.useState(t.positions),u=h.useMemo(()=>rN(t.text,l).filter(g=>g),[l]),d=h.useMemo(()=>t.text.split(""),[]),f=g=>{const x=[...l],w=l.findIndex(v=>v===g);w===-1?x.push(g):x.splice(w,1),c(x)},p=()=>{if(!r||s===void 0)return;const g=l.sort((w,v)=>w-v),x=[...o];x[e]=g,i(x),n()};return a.jsxs(je,{className:"w-[500px]",children:[a.jsx(oe,{title:"Split word "}),a.jsx("div",{className:"flex justify-center space-x-5",children:u.map((g,x)=>a.jsx("span",{className:"text-xl md:text-2xl font-[700]",children:g},x))}),a.jsx("div",{className:"mt-3 flex justify-center",children:d.map((g,x)=>{const w=l.includes(x);return a.jsxs("div",{children:[d.length>1&&x?a.jsx("button",{onClick:()=>f(x),className:` p-1 rounded-full ${w?"bg-[--primary-cl] text-white":"hover:bg-black/10"}`,children:a.jsx(PT,{className:"w-5"})}):"",a.jsx("span",{className:"text-[50px] font-[500]",children:g})]},x)})}),a.jsx("p",{className:"mt-5 text-right",children:a.jsx(ce,{onClick:p,color:"primary",className:"font-playwireCU",children:"OK"})})]})}function oW(){const{currentSplitWords:t,currentWordsData:e,currentWords:n}=nn(),[r,s]=h.useState(),i=h.useRef(null),o=h.useMemo(()=>{const u={},d=e.map(p=>p.positions.length);let f=0;return d.forEach((p,g)=>{p===0?(u[f]=g,f++):p>0&&[...Array(p+1).keys()].forEach(()=>{u[f]=g,f++})}),u},[e]),l=h.useMemo(()=>r!==void 0?e[r]:void 0,[r,e]),c=u=>{var d;s(u),(d=i.current)==null||d.open()};return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"flex justify-center h-[36px] mt-5",children:t.map((u,d)=>{const f=o[d],p=n[f];return a.jsx(iW,{isShowScissor:p?p.length>1:!1,index:d,openModal:()=>c(f),text:u},d)})}),a.jsx(ie,{variant:"animation",ref:i,children:l&&r!==void 0&&a.jsx(aW,{wordIndex:r,closeModal:()=>{var u;return(u=i.current)==null?void 0:u.close()},wordData:l})})]})}function lW(){const{eventRefs:t,tabProps:{tab:e}}=nn();h.useEffect(()=>{switch(e){case"Edit":t.playWhenSpaceRef.current=!0,t.moveArrowToGrowRef.current=!0;break;case"Record":t.playWhenSpaceRef.current=!1,t.moveArrowToGrowRef.current=!1;break}},[e])}function cW({closeModal:t}){const{song:e}=qt(),{eleRefs:n,currentWords:r,tabProps:s}=nn();JG(),ZG(),lW();const i=h.useRef(null);return a.jsx(a.Fragment,{children:a.jsxs(je,{className:"w-[800px] overflow-auto",children:[a.jsx(qe,{title:"Edit lyric",closeModal:t}),a.jsx("audio",{src:e==null?void 0:e.song_url,ref:i}),a.jsx("div",{ref:n.tempWordRef,className:"absolute inline-block opacity-0",children:r.map((o,l)=>a.jsx("span",{children:o},l))}),i.current&&a.jsx(QG,{audioEle:i.current}),a.jsxs("div",{className:"mt-5",children:[i.current&&a.jsx("div",{className:`${s.tab==="Record"?"block":"hidden"}`,children:a.jsx(tW,{audioEle:i.current})}),a.jsxs("div",{className:`${s.tab==="Edit"?"block":"hidden"}`,children:[a.jsx(rW,{}),a.jsx(sW,{}),a.jsx(oW,{})]})]}),a.jsx(YG,{closeModal:t})]})})}function uW(t){return a.jsx(HG,{children:a.jsx(cW,{...t})})}const Xs=t=>{const e=Math.floor(t/60),n=Math.floor(t%60),[r,s="0"]=t.toString().split(".");return`${e}:${n.toString().padStart(2,"0")},${s.slice(0,1)}`};function dW({children:t}){const[e,n]=h.useState(""),r=h.useRef(null),s=h.useRef(null),i=h.useRef(null),{isFetching:o,isChanged:l,song:c,isSubmitting:u}=BG({audioRef:s}),d=()=>{var g,x;(g=r.current)==null||g.pause(),(x=r.current)==null||x.submit()},f=g=>{var x;n(g),(x=i.current)==null||x.open()},p=()=>{var g;return(g=i.current)==null?void 0:g.close()};return a.jsxs(a.Fragment,{children:[a.jsx("audio",{className:"hidden",ref:s,src:c==null?void 0:c.song_url}),o?a.jsx(Ye,{children:a.jsx(Me,{className:"w-6 animate-spin"})}):c?a.jsxs(a.Fragment,{children:[t,a.jsx(oe,{className:"line-clamp-1 flex-shrink-0",title:`Edit lyric - ${c.name}`}),a.jsx("div",{className:"mt-3",children:s.current&&a.jsxs(a.Fragment,{children:[a.jsx(PG,{audioEle:s.current,ref:r}),a.jsx(ie,{persisted:!0,variant:"animation",ref:i,children:e==="edit-lyric"&&a.jsx(uW,{closeModal:p})})]})}),s.current&&a.jsx($G,{controlRef:r,audioEle:s.current,openEditModal:()=>{f("edit-lyric")}}),a.jsx("p",{className:"mt-5 text-right",children:a.jsx(ce,{className:"rounded-full ",color:"primary",disabled:!l,isLoading:u,onClick:d,children:"Save"})})]}):a.jsx(Ye,{children:a.jsx(Fe,{})})]})}function oN(t){return a.jsx(SG,{children:a.jsx(dW,{...t})})}function hW(){return h.useEffect(()=>{document.title="Dmusic"},[]),a.jsxs("div",{className:"fixed left-[10px] top-[10px] bottom-[10px] right-[10px] flex flex-col md:right-0 md:top-0 md:left-[unset] md:right-[unset] md:relative md:h-full md:pb-4",children:[a.jsx(_G,{className:"mb-1 self-start"}),a.jsx(oN,{})]})}const fW=["All","Song","Playlist","Singer"],mW={songs:[],playlists:[],singers:[]};function pW(){const[t,e]=h.useState(!1),[n,r]=h.useState("All"),s=vT(),i=h.useMemo(()=>{var x;return(x=s[0].get("q"))==null?void 0:x.trim()},[s]),[o,l]=h.useState(mW),c=h.useRef(!0),u=h.useRef(!0),d=h.useRef(!0),f=h.useRef(!0),p=x=>{l(w=>({...w,...x}))},g=async()=>{try{if(!i)return;switch(e(!0),await ss(500),n){case"All":{if(!c.current)return;c.current=!1;const[x,w,v]=await Promise.all([Cn(Rr(fn,[ae("is_official","==",!0),kn(6)],i)),wr(Rr(er,[kn(3)],i)),Md(Rr(Xo,[kn(3)],i))]);p({playlists:w,songs:x,singers:v});break}case"Song":{if(!u.current)return;u.current=!1;const x=Rr(fn,[ae("is_official","==",!0)],i),w=await Cn(x);p({songs:w});break}case"Playlist":{if(!d.current)return;d.current=!1;const x=Rr(er,[ae("is_public","==",!0)],i),w=await wr(x);p({playlists:w});break}case"Singer":{if(!f.current)return;f.current=!1;const x=Rr(Xo,[],i),w=await Md(x);p({singers:w});break}}}catch(x){console.log({message:x})}finally{e(!1)}};return h.useEffect(()=>{g()},[s[0].get("q"),n]),h.useEffect(()=>()=>{r("All"),c.current=!0,u.current=!0,d.current=!0,f.current=!0},[s[0].get("q")]),{isFetching:t,setIsFetching:e,tab:n,setTab:r,getResult:g,result:o,tabs:fW,key:i}}function gW(){const[t,e]=h.useState(""),[n,r]=h.useState(!1),[s,i]=h.useState(!1),[o,l]=h.useState([]),[c,u]=h.useState([]),[d,f]=h.useState([]),p=h.useRef(null),g=h.useRef(null),x=h.useRef(null),w=h.useRef(!0),v=h.useRef(!0),_=vT(),b=d5(t,700),j=new AbortController,T=M=>{const k=document.querySelector(".search-result"),E=document.querySelector(".popup-content"),I=M.target,C=document.querySelectorAll(".modal-content");let A=!1;C.forEach(D=>D.contains(I)?A=!0:{}),!(p.current&&g.current&&(p.current.contains(I)||A||g.current.contains(I)||k!=null&&k.contains(I)||E!=null&&E.contains(I)))&&i(!1)},R=async()=>{try{const M=Ee(Mt(de,"Trending_Keywords"),dn("today_count","desc"),kn(5)),k=await tn(M);if(k.empty)return;const E=k.docs.map(I=>I.id);u(E)}catch{console.log("error")}};return h.useEffect(()=>{v.current&&(v.current=!1,R())},[]),h.useEffect(()=>{if(!b.trim()){r(!1),l([]);return}const M=async()=>{try{r(!0);const k=Rr(fn,[ae("is_official","==",!0)],t),E=await Cn(k);l(E)}catch(k){console.log(k)}finally{r(!1)}};return w.current?M():w.current=!0,()=>{console.log("abort"),j.abort()}},[b]),h.useEffect(()=>(s&&document.addEventListener("click",T),()=>{document.removeEventListener("click",T)}),[s]),h.useEffect(()=>(e(_[0].get("q")||""),()=>{var M;w.current=!1,(M=x.current)==null||M.blur(),i(!1)}),[_[0].get("q")]),h.useEffect(()=>{_[0].get("q")!==t&&s&&(w.current=!0)},[t,s]),h.useEffect(()=>{f(un()["recent-search"]||[])},[s]),{isFetching:n,searchResult:o,value:t,setValue:e,isFocus:s,setIsFocus:i,formRef:p,searchResultRef:g,inputRef:x,recentSearchs:d,setRecentSearchs:f,trendingKeywords:c}}async function xW(t){var s,i;if(!((s=t.main_genre)!=null&&s.id)||!t.genre_ids||!t.release_year)return[];const e=Ee(fn,ae("main_genre.id","==",(i=t.main_genre)==null?void 0:i.id),ae("genre_ids","array-contains-any",t.genre_ids),ae("release_year",">=",t.release_year-1),ae("release_year","<=",t.release_year+1));return(await Cn(e,{msg:"Get relative songs"})).filter(o=>o.id!==t.id)}function Ug(){const t=mn();return{getRelatigeSongs:async n=>{try{t(FV(!0));const r=await xW(n);t(yh({songs:r}))}catch(r){console.log(r)}}}}function um(t){const e=un()["recent-search"]||[];e.find(r=>r.item.id===t.item.id)||e.unshift(t),ot("recent-search",e.slice(0,5))}function yW({songs:t}){const{handleSetSong:e}=os({variant:"search-bar"}),{getRelatigeSongs:n}=Ug(),r=s=>{e(s.queue_id,[s]),um({variant:"song",item:s}),n(s)};return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"text-sm font-bold mb-2",children:"Suggestion results"}),a.jsx("div",{className:"overflow-auto no-scrollbar",children:a.jsx(Os,{children:t.length?a.jsx($s,{isHasCheckBox:!1,setSong:r,songs:t}):a.jsx(Fe,{})})})]})}const vW={itemContainer:"w-full hover:bg-[--a-5-cl] items-start sm:group/container flex flex-row rounded-md py-2 px-3 last:border-none"};function wW({item:t}){return a.jsxs(se,{to:`/${t.variant}/${t.item.id}`,className:`${vW.itemContainer}`,children:[a.jsx("div",{className:"w-[54px] h-[54px]",children:a.jsx(De,{src:t.item.image_url,blurHashEncode:t.item.blurhash_encode,className:`${t.variant==="singer"?"rounded-full":"rounded"}`})}),a.jsxs("div",{className:"ml-[10px]",children:[a.jsx("h5",{className:"line-clamp-1 font-medium overflow-hidden text-sm",children:t.item.name}),a.jsx("p",{className:"item-info line-clamp-1 text-sm",children:t.variant.charAt(0).toLocaleUpperCase()+t.variant.slice(1)})]})]})}function _W({item:t}){const{user:e}=ye(),{currentSongData:n}=fe(rt),{handleSetSong:r}=os({variant:"search-bar"}),{getRelatigeSongs:s}=Ug(),i=l=>{r(l.queue_id,[l]),s(l)},o=()=>{switch(t.variant){case"song":return a.jsx(z5,{isHasCheckBox:!1,isLiked:(e==null?void 0:e.liked_song_ids.includes(t.item.id))||null,variant:"system-song",index:0,active:t.item.id===(n==null?void 0:n.song.id),onClick:()=>i(t.item),song:t.item});default:return a.jsx(wW,{item:t})}};return a.jsx(Os,{children:o()})}function bW({words:t,recentSearchs:e,clear:n}){const r={listWrapper:"[&>*]:px-3 *:text-sm [&>*]:py-2 [&>*]:flex [&>*]:items-center [&>*]:space-x-1 [&>*]:rounded-md "};return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"text-sm font-bold mb-2 ml-3",children:"Suggestion keyword"}),a.jsx("div",{className:`${r.listWrapper} hover:[&>*]:bg-[--a-5-cl]`,children:t.map((s,i)=>a.jsxs(se,{to:`/search?q=${s}`,children:[a.jsx(F1,{className:"w-5"}),a.jsx("span",{className:"text-sm",children:s})]},i))}),!!e.length&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex justify-between my-2 text-sm",children:[a.jsx("span",{className:"font-bold",children:"Recent search"}),a.jsx(ce,{onClick:n,className:"text-[--primary-cl]",size:"clear",children:"Clear"})]}),e.map((s,i)=>a.jsx(_W,{item:s},i))]})]})}function lN(){const t=Gt(),{isFetching:e,inputRef:n,formRef:r,searchResultRef:s,value:i,searchResult:o,setIsFocus:l,isFocus:c,setValue:u,trendingKeywords:d,recentSearchs:f,setRecentSearchs:p}=gW(),g={container:"relative z-[9] h-[40px] flex px-3 w-full md:w-[300px] shadow-md",unFocusContainer:"bg-[--a-5-cl] rounded-[20px]",focusedContainer:"bg-[--popup-cl] rounded-[20px_20px_0_0]",input:"bg-transparent font-semibold outline-none placeholder:text-[#757575] w-full",searchResultContainer:"overflow-auto bg-[--popup-cl] shadow-md  rounded-[0_0_20px_20px] p-3 position absolute top-full left-0 w-full max-h-[60vh] flex flex-col"},x=async v=>{v.preventDefault(),i.trim()&&(ai({collectionName:"Search_Logs",data:{keyword:Un(i)},msg:"Add search log"}),t(`/search?q=${i}`),l(!1))},w=()=>{p([]),ot("recent-search",[])};return a.jsx(a.Fragment,{children:a.jsxs("form",{ref:r,onSubmit:x,className:`${g.container} ${c?g.focusedContainer:g.unFocusContainer}`,children:[a.jsx("button",{className:"mr-2 text-[#757575]",children:a.jsx(Jd,{className:"w-6"})}),a.jsx("input",{ref:n,value:i,onFocus:()=>l(!0),onChange:v=>u(v.target.value),placeholder:"Search song, singer...",className:g.input,type:"text"}),a.jsx("button",{type:"button",onClick:()=>u(""),className:`${i?"opacity-100":"!opacity-0"} ${Pd(!i)}`,children:e?a.jsx(Me,{className:"w-5 animate-spin"}):a.jsx(ol,{className:"w-5"})}),a.jsx("div",{ref:s,className:`search-result ${Ha(!c)} ${g.searchResultContainer}`,children:o.length?a.jsx(a.Fragment,{children:a.jsx(yW,{songs:o})}):a.jsx(bW,{recentSearchs:f,words:d,clear:w})})]})})}function SW(){const{isOnMobile:t}=as(),{isFetching:e,key:n,setIsFetching:r,result:s,tab:i,setTab:o,tabs:l}=pW(),{handleSetSong:c}=os({variant:"search-bar"}),{getRelatigeSongs:u}=Ug(),d=x=>{c(x.queue_id,[x]),u(x),um({variant:"song",item:x})},f=!s.playlists.length&&!s.singers.length&&!s.songs.length,p=x=>i==="All"||i===x?"":"hidden",g=x=>i!=="All"||i==="All"&&!x?"hidden":"mb-3";return a.jsxs(a.Fragment,{children:[a.jsxs(Za,{className:"space-y-8",children:[t&&a.jsx(lN,{}),a.jsxs("div",{className:"md:flex items-center",children:[a.jsx(oe,{title:"Result",className:"mt-1 md:mt-0"}),a.jsx(Ur,{className:"w-fit [&_button]:text-sm mt-3 md:[&_button]:text-base md:mt-0 md:ml-4",tabs:l,render:x=>x,tab:i,disable:f||!n,setTab:x=>{o(x),r(!0)}})]}),a.jsx(Os,{children:a.jsxs("div",{className:"space-y-5",children:[a.jsxs("div",{className:p("Song"),children:[a.jsx(oe,{variant:"h3",className:g(!!s.songs.length),title:"Songs"}),e&&a.jsx(Zi,{}),!e&&a.jsx(a.Fragment,{children:s.songs.length?a.jsx($s,{setSong:d,songs:s.songs}):i==="Song"&&a.jsx(Fe,{variant:"less",className:"mx-auto"})})]}),a.jsxs("div",{className:p("Playlist"),children:[a.jsx(oe,{variant:"h3",className:g(!!s.playlists.length),title:"Playlist"}),a.jsx(ru,{whenEmpty:i!=="Playlist"?a.jsx(a.Fragment,{}):void 0,loading:e,playlists:s.playlists,onClick:x=>um({variant:"playlist",item:x})})]}),a.jsxs("div",{className:p("Singer"),children:[a.jsx(oe,{variant:"h3",className:g(!!s.singers.length),title:"Singers"}),a.jsx(yv,{singers:s.singers,loading:e,skeNumber:2,onClick:x=>um({variant:"singer",item:x}),whenEmpty:i==="All"?a.jsx(a.Fragment,{}):void 0})]})]})}),f&&n&&a.jsx(Fe,{})]}),a.jsx(ta,{})]})}function EW(){return a.jsx(Ye,{children:a.jsx(Fe,{variant:"with-home-button"})})}function jW(){return a.jsxs("div",{className:"bg-[--layout-cl] text-[--text-cl] flex flex-col justify-center items-center min-h-screen",children:[a.jsx(oe,{title:"Unauthorized"}),a.jsx(se,{to:"/",children:a.jsxs(ce,{variant:"primary",color:"primary",className:"mt-10",children:[a.jsx(f$,{className:"w-6"}),a.jsx("span",{children:"Go home"})]})})]})}function kW(){const[t]=i_(Ga),{action:e}=Mg(),n=Gt(),r=async()=>{try{await e("login")}catch(s){console.log(s)}};return h.useEffect(()=>{if(t){n("/");return}},[]),a.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-[--layout-cl]",children:[a.jsx(ce,{onClick:r,variant:"default",className:"bg-[--primary-cl] font-bold text-[#fff] text-[30px] rounded-full",children:"Login with google"})," "]})}function TW(){const[t,e]=h.useState(),[n,r]=h.useState(!0),[s,i]=h.useState([]),[o,l]=h.useState([]),[c,u]=h.useState([]);return{singer:t,setSinger:e,isFetching:n,setIsFetching:r,songs:s,setSongs:i,playlists:o,albums:c,setAlbums:u,setPlaylists:l}}const cN=h.createContext(null);function IW({children:t}){return a.jsx(cN.Provider,{value:TW(),children:t})}function ra(){const t=h.useContext(cN);if(!t)throw new Error("SingerProvider not provided");return t}let CW="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",RW=(t=21)=>{let e="",n=t|0;for(;n--;)e+=CW[Math.random()*64|0];return e};function NW(){const{setIsFetching:t,setSinger:e,setAlbums:n,isFetching:r,setSongs:s,singer:i,setPlaylists:o}=ra(),{setErrorToast:l}=ne(),c=Wi(),u=h.useRef(!1),d=async()=>{try{if(!c.id)return;const f=await en({collectionName:"Singers",id:c.id});if(!f.exists())return;const p={...f.data(),id:c.id},g=Ee(fn,ae(`singer_map.${p.id}`,"==",!0)),x=await Cn(g,{getQueueId:()=>RW(4)+"_"+p.id}),w=Ee(er,ae(`singer_map.${p.id}`,"==",!0)),v=await wr(w),_=[],b=[];v.forEach(j=>j.is_album?b.push(j):_.push(j)),s(x),e(p),o(_),n(b)}catch(f){console.log({error:f}),l()}finally{t(!1)}};return h.useEffect(()=>{u.current||(u.current=!0,d())},[]),h.useEffect(()=>{i&&(document.title=i.name)},[i]),{singer:i,isFetching:r}}function xx({onClick:t,children:e}){const{songs:n}=ra();return a.jsx(ce,{onClick:t,disabled:!n.length,size:"clear",color:"primary",className:"p-3",children:e})}function AW(){const{songs:t,singer:e}=ra(),{playStatus:n}=fe(lr),{currentSongData:r}=fe(rt),{handleSetSong:s}=os({variant:"playlist"}),{handlePlayPause:i}=na(),o=()=>{const l=t[0];s(l.queue_id,t)};if(e&&r!=null&&r.song.queue_id.includes(e.id))switch(n){case"loading":case"paused":return a.jsx(xx,{onClick:i,children:a.jsx(si,{className:"w-7"})});default:return a.jsx(xx,{onClick:i,children:a.jsx(hl,{className:"w-7"})})}else return a.jsx(xx,{onClick:o,children:a.jsx(si,{className:"w-7"})})}function PW(){const{user:t,updateUserData:e}=ye(),{setSingers:n}=yt(),{setSuccessToast:r}=ne(),[s,i]=h.useState(!1);return{likeSinger:async({singer:l})=>{try{if(i(!0),!t)return;const c=Ls(de),u=gt(de,"Users",t.email),d=gt(de,"Singers",l.id),f=[...t.liked_singer_ids],p=f.findIndex(v=>v===l.id),g=p===-1;g?f.unshift(l.id):f.splice(p,1);const x={liked_singer_ids:f},w={like:Ai(g?1:-1)};c.update(u,x),c.update(d,w),await c.commit(),g?(r("Liked"),n(v=>[l,...v])):(n(v=>v.filter(_=>_.id!==l.id)),r("Disliked")),e(x)}catch(c){console.log({error:c})}finally{i(!1)}},isFetching:s,user:t}}function FW(){const{singer:t}=ra(),{likeSinger:e,isFetching:n,user:r}=PW(),s=h.useMemo(()=>r&&t?r.liked_singer_ids.includes(t.id):!1,[r]);return t?a.jsx("button",{onClick:()=>e({singer:t}),className:`${s?"text-[--primary-cl]":""}`,children:n?a.jsx(Me,{className:"animate-spin"}):a.jsx(a.Fragment,{children:s?a.jsx(Xc,{}):a.jsx(Xd,{})})}):a.jsx(a.Fragment,{})}function MW(){const{singer:t}=ra(),{user:e}=ye(),[n,r]=h.useState(""),s=h.useRef(null),i=o=>{var l;r(o),(l=s.current)==null||l.open()};return a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>i("more"),className:"text-sm ml-auto !mt-0",children:"See more"}),a.jsx("div",{className:"!mt-auto",children:a.jsxs("div",{className:"flex items-end",children:[a.jsx(AW,{}),a.jsxs("div",{className:"flex space-x-2 ml-3 [&_button]:p-2 [&_svg]:w-6 hover:[&_button]:bg-[--a-5-cl] [&_button]:rounded-full",children:[e&&a.jsx(FW,{}),a.jsxs(nr,{appendOnPortal:!0,children:[a.jsx(rr,{children:a.jsx("button",{children:Rg})}),a.jsx(sr,{position:"right-bottom",origin:"top left",children:a.jsx(cr,{className:"w-[140px]",children:a.jsx(ls,{children:a.jsx(o_,{})})})})]})]})]})}),n&&a.jsx(ie,{ref:s,variant:"animation",children:n==="more"&&t&&a.jsx(je,{children:t.description})})]})}function DW(){const{isFetching:t,singer:e}=ra();return!t&&!e?a.jsx(a.Fragment,{}):a.jsx(a.Fragment,{children:a.jsxs("div",{className:"md:flex bg-transparent relative z-0 pb-5 md:p-10 items-start",children:[a.jsx("div",{className:"absolute overflow-hidden -left-10 -top-[100px] -right-10 inset-0",children:a.jsxs("div",{className:"relative h-full w-full",children:[a.jsx("div",{className:"absolute z-[-5] inset-0 bg-white/70 dark:bg-black/60  "}),a.jsx("img",{src:(e==null?void 0:e.image_url)||s_,className:"blur-[50px] absolute z-[-10] w-full h-full object-center object-cover"})]})}),a.jsx("div",{className:"w-[70%] aspect-[1/1] rounded-full overflow-hidden z-0 relative mx-auto md:w-1/4 md:flex-shrink-0 md:m-unset",children:t?a.jsx(we,{className:"pt-[100%] "}):a.jsx(De,{src:e==null?void 0:e.image_url,blurHashEncode:e==null?void 0:e.blurhash_encode,className:"object-cover h-full"})}),a.jsx("div",{className:"flex-grow z-0 relative flex flex-col mt-5 space-y-2.5  md:mt-0 md:ml-5",children:t?a.jsxs(a.Fragment,{children:[a.jsx(we,{className:"h-[36px] w-full md:w-[200px]"}),a.jsx(we,{className:"h-[48px] w-full md:w-[100%]"})]}):e&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-3xl font-bold",children:e.name}),a.jsxs("span",{className:"ml-4",children:["❤️ ",Ms(e.like)]})]}),a.jsx("p",{className:"line-clamp-2",children:e.description}),a.jsx(MW,{})]})})]})})}function LW(){const{handleSetSong:t}=os({variant:"songs"}),{isFetching:e,songs:n}=ra();return a.jsx(a.Fragment,{children:a.jsxs("div",{children:[a.jsx(oe,{variant:"h2",className:`mb-3 ${Ha(!n.length)}`,title:"Popular Songs"}),a.jsx(Os,{children:e?a.jsx(Zi,{}):a.jsx($s,{whenEmpty:a.jsx(a.Fragment,{}),songs:n,setSong:r=>t(r.queue_id,[r])})})]})})}function OW(){const{isFetching:t,playlists:e}=ra();return a.jsx(a.Fragment,{children:a.jsxs("div",{children:[a.jsx(oe,{variant:"h2",title:"Popular Playlists",className:Ha(!e.length)}),a.jsx(ru,{whenEmpty:a.jsx(a.Fragment,{}),playlists:e,loading:t})]})})}function $W(){const{albums:t,isFetching:e}=ra();return a.jsxs("div",{children:[a.jsx(oe,{variant:"h2",title:"Albums",className:Ha(!t.length)}),a.jsx(ru,{whenEmpty:a.jsx(a.Fragment,{}),playlists:t,loading:e})]})}function zW(){const{isFetching:t,singer:e}=NW();return!t&&!e?a.jsx(Ye,{children:a.jsx(Fe,{variant:"with-home-button"})}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"space-y-5",children:[a.jsx(DW,{}),a.jsx(LW,{}),a.jsx($W,{}),a.jsx(OW,{})]}),a.jsx(ta,{})]})}function BW(){return a.jsx(IW,{children:a.jsx(zW,{})})}function VW(){const[t,e]=h.useState(),[n,r]=h.useState([]),[s,i]=h.useState(!0),{setErrorToast:o}=ne(),l=Wi(),c=h.useRef(!1),u=async()=>{try{if(!l.id)return;const d=await en({collectionName:"Users",id:l.id});if(!d.exists())return;const f={...d.data()},p=Ee(er,ae("owner_email","==",f.email),ae("is_public","==",!0),ae("is_official","==",!1)),g=await wr(p),x=[],w=[];g.forEach(v=>v.is_album?w.push(v):x.push(v)),r(x),e(f)}catch(d){console.log({error:d}),o()}finally{i(!1)}};return h.useEffect(()=>{c.current||(c.current=!0,u())},[]),{user:t,playlists:n,isFetching:s}}function UW(){const{playlists:t,isFetching:e,user:n}=VW();return!e&&!n?a.jsx(Ye,{children:a.jsx(Fe,{variant:"with-home-button"})}):a.jsxs(a.Fragment,{children:[a.jsxs(Za,{children:[a.jsxs("div",{className:"flex flex-col md:flex-row items-center md:items-start",children:[e?a.jsx(we,{className:"w-3/5 md:w-[200px] aspect-[1/1] rounded-full"}):n&&a.jsx("div",{className:"w-3/5 md:w-[200px] aspect-[1/1] rounded-full overflow-hidden",children:a.jsx(De,{fallback:Nc.image,blurHashEncode:n.photo_url?"":Nc.blurhash,src:n.photo_url})}),a.jsx("div",{className:"text-center mt-3 md:mt-0 md:ml-3 md:text-left ",children:e?a.jsxs(a.Fragment,{children:[a.jsx(we,{className:"w-[300px] h-[30px]"}),a.jsx(we,{className:"w-[200px] h-[22px] mt-1"})]}):n&&a.jsxs(a.Fragment,{children:[a.jsx(oe,{title:n.display_name}),a.jsxs("p",{className:"item-info",children:["Last seen: ",K5(n.last_seen)]})]})})]}),a.jsxs("div",{children:[a.jsx(oe,{title:"Playlists"}),a.jsx(ru,{loading:e,playlists:t})]})]}),a.jsx(ta,{})]})}function HW({category:t}){return a.jsx(se,{to:`/category/${t.id}`,className:"group relative rounded-lg overflow-hidden",children:a.jsxs(_h,{className:"pt-[60%]",children:[a.jsx(De,{className:"h-full group-hover:scale-[1.1] transition-transform duration-[.3s] object-cover",src:t.image_url,blurHashEncode:t.blurhash_encode}),a.jsx("div",{className:"absolute z-[0] inset-0 bg-black/20",children:a.jsx(Ye,{children:a.jsx("p",{className:"text-xl font-bold text-white whitespace-nowrap",children:t.name})})})]})})}function GW({title:t,category_ids:e}){const{isFetching:n,categories:r}=D5({category_ids:e}),s=[...Array(3).keys()].map(i=>a.jsx(we,{className:"pt-[60%]"},i));return a.jsx(a.Fragment,{children:a.jsxs("div",{children:[a.jsx(oe,{variant:"h2",title:t}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-3 md:grid-cols-4 gap-4 mt-3",children:n?s:r.map((i,o)=>a.jsx(HW,{category:i},o))})]})})}function WW(){const{categoryPage:t}=qn(),{isFetching:e}=O5(),n=()=>e?a.jsxs(a.Fragment,{children:[a.jsx(we,{className:"pt-[25%] rounded-lg"}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-3 md:grid-cols-4   gap-4 mt-3",children:[...Array(3).keys()].map(r=>a.jsx(we,{className:"pt-[60%] rounded-lg"},r))})]}):a.jsxs(a.Fragment,{children:[a.jsx(L5,{categoryIds:t!=null&&t.category_ids?t==null?void 0:t.category_ids.split("_"):[]}),t==null?void 0:t.category_sections.map((r,s)=>a.jsx(GW,{title:r.name,category_ids:r.target_ids?r.target_ids.split("_"):[]},s)),t==null?void 0:t.playlist_sections.map((r,s)=>a.jsx(l_,{title:r.name,playlistIds:r.target_ids?r.target_ids.split("_"):[]},s))]});return a.jsxs(a.Fragment,{children:[a.jsx(Za,{children:n()}),a.jsx(ta,{})]})}function qW(){const{setErrorToast:t}=ne(),{genres:e,setGenres:n}=yt(),[r,s]=h.useState(),[i,o]=h.useState(),[l,c]=h.useState(""),[u,d]=h.useState(""),[f,p]=h.useState(!0),g=h.useRef(""),x=h.useMemo(()=>e.length?e.map(R=>R.name):[],[e]),w=R=>{var M;return((M=e.find(k=>Un(R)===Un(k.name)))==null?void 0:M.id)||""},v=h.useMemo(()=>w(l),[e,l]),_=()=>x.reduce((R,M)=>{const k={songs:[],shouldFetching:!0};return{...R,[w(M)]:k}},{}),b=h.useRef(!1),j=async()=>{try{const R=Ee(BB,ae("is_main","==",!0)),M=await tn(R);if(M.empty)return;const k=M.docs.map(E=>({...E.data(),id:E.id}));n(k),c(k[0].name)}catch{console.log("Error when get genres")}},T=async()=>{try{if(!u||!l||!v)return;p(!0);let R=r?{...r}:void 0,M=i?{...i}:void 0;if(g.current!==u){g.current=u,R=_();const E=await en({collectionName:"Trending_Songs",id:u,msg:"Get trending data"});E.exists()?M=E.data().trending_songs:M=void 0}if(!M||!R)return;const k=R[v];if(k.shouldFetching){k.shouldFetching=!1;const E=M[v];if(!E||!E.length){k.songs=[],Object.assign(R,{[v]:k}),s(R);return}const I=E.map(P=>P.song_id),C=Ee(fn,ae(ci(),"in",I)),A=await Cn(C),D=[];E.forEach(P=>{const ee=A.find(_e=>_e.id===P.song_id);ee&&(ee.rank=P.rank,ee.last_week_rank=P.last_week_rank,D.push(ee))}),k.songs=D,Object.assign(R,{[v]:k}),s(R),o(M)}else await ss(100)}catch(R){console.log({message:R}),t()}finally{p(!1)}};return h.useEffect(()=>{b.current||(b.current=!0,e.length?c(x[0]):j())},[]),h.useEffect(()=>{!u||!l||T()},[u,l]),h.useEffect(()=>{e.length&&s(_())},[u,e]),{isFetching:f,songMapByGenre:r,tabs:x,KEY:v,tab:l,setTab:c,setWeek:d}}function KW(t){const e=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate()));e.setUTCDate(e.getUTCDate()+4-(e.getUTCDay()||7));const n=new Date(Date.UTC(e.getUTCFullYear(),0,1));return{currentWeek:Math.ceil(((e.getTime()-n.getTime())/864e5+1)/7),year:e.getUTCFullYear()}}function QW({submit:t}){const[e,n]=h.useState([]),[r,s]=h.useState(0),i=h.useMemo(()=>e[r],[r]);return h.useEffect(()=>{const o=[],{currentWeek:l,year:c}=KW(new Date);for(let u=1;u<=l-1;u++)o.push({label:`Week ${u}, ${c}`,value:`${c}-W${u}`});n(o),s(o.length-1),t(o[o.length-1].value)},[]),{weekOptions:e,currentWeekData:i,setCurrentIndex:s,currentIndex:r}}function XW({weekOptions:t,submit:e,currentIndex:n}){const{state:{isOpen:r}}=eu(),s=h.useRef(null);return h.useEffect(()=>{r&&s.current&&s.current.scrollIntoView({behavior:"instant",block:"center"})},[r]),a.jsx(a.Fragment,{children:t.map((i,o)=>{const l=n===o;return a.jsx("button",{ref:l?s:void 0,className:`${l?"text-[--primary-cl] font-bold bg-[--a-5-cl]":""}`,onClick:()=>e(o),children:i.label},o)})})}function YW(t){const{weekOptions:e,currentIndex:n,currentWeekData:r,setCurrentIndex:s}=QW(t);return a.jsxs(nr,{appendOnPortal:!0,children:[a.jsx(rr,{children:a.jsx("button",{className:"py-2 text-sm font-semibold px-4 rounded-full bg-[--a-5-cl]",children:r==null?void 0:r.label})}),a.jsx(sr,{position:"right-bottom",origin:"top left",children:a.jsx(cr,{children:a.jsx(ls,{className:"w-[160px] h-[30vh] overflow-auto",children:a.jsx(XW,{weekOptions:e,currentIndex:n,submit:i=>{s(i),t.submit(e[i].value)}})})})})]})}function JW(){var o;const{isFetching:t,songMapByGenre:e,setWeek:n,KEY:r,...s}=qW(),{handleSetSong:i}=os({variant:"songs"});return a.jsxs("div",{children:[a.jsx(oe,{title:"Week Table",className:"mb-3"}),a.jsxs("div",{className:"mb-5 space-y-3",children:[a.jsx(Ur,{className:"w-fit",render:l=>l,...s}),a.jsx(YW,{submit:l=>n(l)})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-x-4 mt-3",children:[t&&a.jsx(Zi,{className:"ml-[82px]",hasCheckBox:!1}),!t&&a.jsx(a.Fragment,{children:e&&((o=e[r])!=null&&o.songs.length)?a.jsx($s,{songVariant:"table",isHasCheckBox:!1,songs:e[r].songs,setSong:l=>i(l.queue_id,e[r].songs)}):a.jsx(Fe,{})})]})]})}function uN({amount:t}){const[e,n]=h.useState([]),{setErrorToast:r}=ne(),[s,i]=h.useState(!0),o=h.useRef(!1),l=async()=>{try{i(!0);const c=E9([0,0,0,0]),u=Ee(fn,ae("last_active",">=",c),dn("today_play","desc"),kn(t)),d=await Cn(u);n(d)}catch(c){console.log({message:c}),r()}finally{i(!1)}};return h.useEffect(()=>{o.current||(o.current=!0,l())},[]),{isFetching:s,songs:e}}function ZW(t){const{isFetching:e,songs:n}=uN(t),{handleSetSong:r}=os({variant:"songs"}),{getRelatigeSongs:s}=Ug(),i=o=>{r(o.queue_id,n),s(o)};return a.jsx(a.Fragment,{children:a.jsxs("div",{children:[a.jsx(Ac,{size:"6",className:"text-2xl font-bold mb-3",children:"Trending 🔥"}),e&&a.jsx(Zi,{hasCheckBox:!1,className:"ml-[62px]"}),!e&&a.jsx($s,{songVariant:"trending",isHasCheckBox:!1,songs:n,setSong:o=>i(o)}),a.jsx("div",{className:"text-center mt-5 border-none",children:a.jsx(se,{to:"/trending",children:a.jsx(ce,{color:"primary",children:"See more"})})})]})})}function eq(){return a.jsxs(a.Fragment,{children:[a.jsxs(Za,{children:[a.jsx(ZW,{amount:10}),a.jsx(JW,{})]}),a.jsx(ta,{})]})}function tq({songIds:t}){const[e,n]=h.useState([]),{handleSetSong:r}=os({variant:"songs"}),{isFetching:s}=g5({setSongs:n,songIds:t});return s?a.jsx(Zi,{}):e.length?a.jsx(Os,{children:a.jsxs("div",{className:"mt-5",children:[a.jsx(Lg,{variant:"system-song",children:a.jsx(oe,{variant:"h2",title:"Hot songs"})}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-4 mt-3",children:a.jsx($s,{songs:e,setSong:i=>r(i.queue_id,e)})})]})}):a.jsx(a.Fragment,{})}function nq(){const[t,e]=h.useState(),{isFetching:n}=p5({setCategory:e}),[r,s]=h.useMemo(()=>[t!=null&&t.song_ids?t.song_ids.split("_"):[],t!=null&&t.playlist_ids?t.playlist_ids.split("_"):[]],[t]);return n?a.jsx(Ye,{children:a.jsx(nu,{})}):t?a.jsxs(a.Fragment,{children:[a.jsxs(Za,{children:[a.jsxs("div",{children:[a.jsx(oe,{title:t.name}),a.jsx("div",{className:"relative rounded-lg overflow-hidden aspect-[16/4] mt-5",children:a.jsx(De,{src:t.banner_image_url,blurHashEncode:t.banner_blurhash_encode,className:"object-cover h-full"})})]}),a.jsx(tq,{songIds:r}),a.jsx(l_,{playlistIds:s})]}),a.jsx(ta,{})]}):a.jsx(Ye,{children:a.jsx(Fe,{variant:"with-home-button"})})}function rq(){const{setErrorToast:t}=ne(),[e,n]=h.useState(!1),[r,s]=h.useState([]),i=h.useRef(!0),o=async()=>{try{n(!0);const l=Ee(Mt(de,"Trending_Keywords"),dn("today_count","desc"),kn(5)),c=await tn(l);if(c.empty)return;const u=c.docs.map(d=>d.id);s(u)}catch{console.log("error"),t("")}finally{n(!1)}};return h.useEffect(()=>{console.log(i.current),i.current&&(i.current=!1,o())},[]),{trendingKeywords:r,isFetching:e}}function sq(){const{trendingKeywords:t,isFetching:e}=rq();return a.jsxs(a.Fragment,{children:[a.jsx("h1",{className:"text-xl font-bold text-[#333]",children:"Trending search now"}),e&&a.jsx(Rn,{}),!e&&a.jsx(Zt,{children:a.jsx("div",{className:"flex flex-wrap -ml-2",children:t.map((n,r)=>a.jsx(Fs,{children:a.jsxs("span",{children:[n," 🔥🔥🔥"]})},r))})})]})}function zs({className:t="",children:e,...n}){return a.jsx(Zt,{className:"overflow-x-auto w-full",children:a.jsx("div",{className:"rounded-md overflow-hidden",children:a.jsx(k5,{className:`[&_td]:text-sm hover:[&_tr:not(.no-hover)]:bg-black/5 [&_tbody_tr:not(.no-hover)]:border-t [&_tr]:border-black/5 [&_th]:text-sm [&_th]:text-left [&_td]:p-2 [&_th]:p-2 [&_th]:font-bold  ${t}`,...n,children:e})})})}function iq(){const{songs:t,isFetching:e}=uN({amount:5});return a.jsxs(a.Fragment,{children:[a.jsx("h1",{className:"text-xl font-bold text-[#333]",children:"Trending song now"}),e&&a.jsx(Ye,{children:a.jsx(Rn,{})}),!e&&a.jsx(zs,{colList:["Name","Singers","Today plays"],children:t.length?t.map((n,r)=>a.jsxs("tr",{children:[a.jsx("td",{children:a.jsx(se,{to:`/dashboard/song/${n.id}/edit`,className:"hover:underline",children:n.name})}),a.jsx("td",{children:n.singers.map((s,i)=>a.jsxs(se,{className:"hover:underline",to:`/dashboard/singer/${s.id}`,children:[!!i&&", ",s.name]},i))}),a.jsx("td",{children:n.today_play})]},r)):a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"text-center",children:a.jsx(Fe,{})})})})]})}function aq(){return a.jsx(a.Fragment,{children:a.jsxs("div",{className:"space-y-5",children:[a.jsx(iq,{}),a.jsx(sq,{})]})})}const Tf=6,oq=["All","Result"];function lq(){const{setUploadedSongs:t,lastDoc:e,shouldFetchUserSongs:n,setHasMore:r}=yt(),{setErrorToast:s}=ne(),[i,o]=h.useState(""),[l,c]=h.useState(!0),[u,d]=h.useState("All"),[f,p]=h.useState([]),g=async w=>{try{if(w.preventDefault(),l)return;c(!0);const v=Rr(fn,[ae("is_official","==",!0)],i),_=await Cn(v);p(_),d("Result")}catch(v){console.log({message:v}),s()}finally{c(!1)}},x=async()=>{try{c(!0);const w=Mt(de,"Songs"),v=e.current?Ee(w,ae("is_official","==",!0),dn("updated_at","desc"),xg(e.current),kn(Tf)):Ee(w,ae("is_official","==",!0),dn("updated_at","desc"),kn(Tf)),_=await tn(v),b=_.docs.map(j=>({...j.data(),id:j.id,queue_id:""}));e.current?t(j=>[...j,...b]):t(b),b.length<Tf?r(!1):e.current=_.docs[Tf-1]}catch(w){console.log({message:w}),s()}finally{c(!1)}};return h.useEffect(()=>{n.current?(n.current=!1,x()):c(!1)},[]),{isFetching:l,value:i,setValue:o,handleSubmit:g,tab:u,setTab:d,tabs:oq,getSong:x,searchResult:f}}function cq(){const{hasMore:t,uploadedSongs:e}=yt(),{isFetching:n,getSong:r,searchResult:s,tabs:i,setTab:o,tab:l,...c}=lq(),u=h.useMemo(()=>l==="All"?e:s,[l,e,s]);return a.jsxs(a.Fragment,{children:[a.jsx(oe,{title:"Songs"}),a.jsxs("div",{className:"flex justify-between items-start mt-3",children:[a.jsx(Ji,{loading:l==="Result"&&n,...c}),a.jsxs(J,{href:"/dashboard/song/add-song",className:"p-1.5 ml-5",size:"clear",children:[a.jsx(Vi,{className:"w-6"}),a.jsx("div",{className:"hidden md:block",children:"Add song"})]})]}),a.jsx("div",{className:"mt-5 w-fit self-start",children:a.jsx(Ur,{disable:l==="All",tabs:i,render:d=>d,tab:l,setTab:o})}),a.jsx("div",{className:"mt-3",children:a.jsx(zs,{colList:["Name","Singers","Genre",""],children:u.length?a.jsxs(a.Fragment,{children:[u.map((d,f)=>a.jsx(RU,{variant:"songs",song:d},f)),l==="All"&&n&&a.jsx("tr",{className:"no-hover border-none",children:a.jsx("td",{colSpan:9,children:a.jsx(Me,{className:"animate-spin w-7 mx-auto"})})}),l==="All"&&a.jsx("tr",{className:"no-hover",children:a.jsx("td",{colSpan:9,className:"text-center hover:bg-none",children:a.jsx(J,{disabled:!t,onClick:r,children:"Get more"})})})]}):a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"text-center",children:a.jsx(Fe,{})})})})})]})}function uq(){const[t,e]=h.useState(),[n,r]=h.useState(),[s,i]=h.useState([]),[o,l]=h.useState(),[c,u]=h.useState([]),[d,f]=h.useState(),[p,g]=h.useState(),[x,w]=h.useState(),[v,_]=h.useState([]),[b,j]=h.useState(""),T=h.useRef("add"),R=h.useRef(null);return{imageFile:d,setImageFile:f,songFile:t,setSongFile:e,songData:n,song:p,setSong:g,variant:T,setSongData:r,updateSongData:A=>{n&&r({...n,...A})},singers:s,setSingers:i,setGenres:u,genres:c,selectGenre:A=>{const D=[...c],P=D.findIndex(ee=>ee.id===A.id);P===-1?D.push(A):D.splice(P,1),u(D)},selectSinger:A=>{const D=[...s],P=D.findIndex(ee=>ee.id===A.id);P===-1?D.push(A):D.splice(P,1),i(D)},imageBlob:x,setImageBlob:w,resetAddSongContext:()=>{e(void 0),i([]),u([])},audioRef:R,mainGenre:o,setMainGenre:l,playlists:v,setPlaylists:_,removePlaylist:A=>{const D=[...v];D.splice(A,1),_(D)},imageUrl:b,setImageUrl:j}}const dN=h.createContext(null);function dq({children:t}){return a.jsx(dN.Provider,{value:uq(),children:t})}const cs=()=>{const t=h.useContext(dN);if(!t)throw new Error("AddSongProvider not provided");return t};function hN({afterSearched:t=()=>{},setIsFetchingParent:e}){const{setErrorToast:n}=ne(),[r,s]=h.useState(""),[i,o]=h.useState(!1),[l,c]=h.useState(!1),[u,d]=h.useState([]),f=e||o;return{value:r,isShowResult:l,setValue:s,result:u,handleSubmit:async g=>{try{if(g.preventDefault(),g.stopPropagation(),i)return;f(!0),c(!0);const x=Rr(Xo,[],r),w=await Md(x);console.log(w),d(w),t()}catch(x){console.log({message:x}),n()}finally{f(!1)}},isFetching:i}}const hq=6;function fq(){const[t,e]=h.useState([]),[n,r]=h.useState(),[s,i]=h.useState([]),[o,l]=h.useState([]),[c,u]=h.useState([]),[d,f]=h.useState(!0),p=h.useRef(),g=h.useRef(!0);return{singer:n,setSinger:r,singers:t,setSingers:e,songs:s,setSongs:i,playlists:o,setPlaylists:l,albums:c,setAlbums:u,hasMore:d,setHasMore:f,lastDoc:p,shouldGetSingers:g,PAGE_SIZE:hq}}const fN=h.createContext(null);function mq({children:t}){return a.jsx(fN.Provider,{value:fq(),children:t})}function Bs(){const t=h.useContext(fN);if(!t)throw new Error("SingerProvider not provided");return t}const pq=["Newest","Result"];function gq(){const{singers:t,PAGE_SIZE:e,setSingers:n,setHasMore:r,lastDoc:s,shouldGetSingers:i}=Bs(),[o,l]=h.useState(!1),[c,u]=h.useState("Newest"),{isFetching:d,...f}=hN({setIsFetchingParent:l,afterSearched:()=>{u("Result")}}),p=async()=>{try{l(!0),r(w=>s.current&&!w?(s.current=void 0,!w):w);const g=Ee(Xo,dn("created_at","desc"),kn(e)),x=await Md(g);n(x)}catch(g){console.log(g)}finally{l(!1)}};return h.useEffect(()=>{i.current&&(i.current=!1,p())},[]),{...f,isFetching:o,singers:t,getNewestSingers:p,tabs:pq,tab:c,setTab:u}}function mN(t){const{setErrorToast:e,setSuccessToast:n}=ne(),{singer:r,setSinger:s,setSingers:i,shouldGetSingers:o,lastDoc:l}=Bs(),[c,u]=h.useState(),[d,f]=h.useState(),[p,g]=h.useState(!1),x=h.useRef(null),w=R=>{c&&u({...c,...R})},v=h.useMemo(()=>t.variant==="add"?!0:!r||!c?!1:c.name!==r.name||c.description!==r.description||c.like!==r.like,[c]),_=!!d,b=h.useMemo(()=>{const R=!!(c!=null&&c.name)&&v;return t.variant==="add"?R:R||_},[_,v,c]),j=async()=>{var R;try{if(!b||!c)return;g(!0);const M={...c,name:c.name.trim(),meta:Un(c.name.trim()).split(" ")};if(d){c.image_file_id&&Vt({fileId:c.image_file_id});const k=await Yi({imageFile:d});Object.assign(M,k)}switch(t.variant){case"add":{const k=await ai({collectionName:"Singers",data:M}),E={...c,id:k.id};i(I=>[E,...I]),t.afterSubmit&&(Object.assign(E,{created_at:""}),t.afterSubmit(E)),n("Add singer successful");break}case"edit":{if(!r)return;await Re({collectionName:"Singers",id:r.id,data:M}),s({...r,...M}),o.current=!0,l.current=void 0,n("Edit singer successful")}}}catch(M){console.log(M),e()}finally{g(!1),(R=t.modalRef.current)==null||R.close()}},T=()=>{switch(t.variant){case"add":return fv({name:t.name});case"edit":if(!r)throw new Error("");const{id:R,...M}=r;return fv(M)}};return h.useEffect(()=>{var R,M;t.variant==="add"&&((R=x.current)==null||R.focus(),(M=t.modalRef.current)==null||M.setModalPersist(!0)),u(T())},[]),h.useEffect(()=>{var R;t.variant==="edit"&&(v||_)&&((R=t.modalRef.current)==null||R.setModalPersist(!0))},[v,_]),h.useEffect(()=>{d&&w({image_url:URL.createObjectURL(d)})},[d]),h.useEffect(()=>{var R;(R=x.current)==null||R.focus()},[]),{singerData:c,imageFile:d,setImageFile:f,updateSingerData:w,setSingerData:u,inputRef:x,handleSubmit:j,isFetching:p,isValidToSubmit:b}}function xq({modalRef:t,afterSubmit:e,singerName:n}){const{handleSubmit:r,isFetching:s,isValidToSubmit:i,singerData:o,updateSingerData:l}=mN({variant:"add",modalRef:t,afterSubmit:e,name:n}),c=(u,d)=>{l({...o,[u]:d})};return a.jsxs(je,{className:"w-[450px]",children:[a.jsx(qe,{closeModal:()=>{var u;return(u=t.current)==null?void 0:u.close()},title:"Add singer"}),a.jsx("div",{className:"space-y-3 overflow-auto",children:a.jsxs("div",{className:"space-y-1",children:[a.jsx(kt,{htmlFor:"name",children:"Singer name"}),a.jsx(En,{id:"name",value:(o==null?void 0:o.name)||"",onChange:u=>c("name",u.target.value),placeholder:"name..."})]})}),a.jsx("div",{className:"text-center mt-5",children:a.jsxs(J,{disabled:!i,loading:s,onClick:()=>i&&r(),children:[a.jsx(Xa,{className:"w-6"}),a.jsx("p",{className:"text-white",children:"Ok"})]})})]})}function pN({choose:t,closeModal:e}){const{result:n,isShowResult:r,isFetching:s,setTab:i,getNewestSingers:o,tab:l,singers:c,tabs:u,...d}=gq(),f=h.useRef(null),p=g=>g.map((x,w)=>a.jsx("button",{onClick:()=>t(x),className:"rounded-md w-full p-1 text-sm font-semibold text-left hover:bg-[--a-5-cl]",children:x.name},w));return a.jsxs(a.Fragment,{children:[a.jsxs(je,{children:[a.jsx(qe,{title:"Singers",closeModal:e}),a.jsx(Ji,{...d}),a.jsx(Ur,{className:"w-fit mt-3",buttonClasses:"[&_button]:px-3 [&_button]:py-1/2",tabs:u,setTab:i,tab:l,render:g=>g}),a.jsx("div",{className:"h-[40vh] mt-2 space-y-1.5 overflow-auto bg-[--a-5-cl] p-2 rounded-md",children:s?a.jsx(Rn,{className:"h-full"}):a.jsxs(a.Fragment,{children:[l==="Newest"&&a.jsxs(a.Fragment,{children:[c.length?p(c):a.jsx(Fe,{variant:"less"}),a.jsx("p",{className:"text-center mt-3",children:a.jsx(J,{onClick:o,children:a.jsx(Me,{className:"w-5"})})})]}),l==="Result"&&r&&a.jsxs(a.Fragment,{children:[n.length?p(n):a.jsx(Fe,{variant:"less"}),d.value&&a.jsx("p",{className:"text-center mt-auto mt-5",children:a.jsxs(J,{onClick:()=>{var g;return(g=f.current)==null?void 0:g.open()},children:[a.jsx(Vi,{className:"w-6"}),a.jsx("span",{children:"Add new singer"})]})})]})]})})]}),a.jsx(ie,{ref:f,variant:"animation",children:a.jsx(xq,{afterSubmit:t,singerName:d.value,modalRef:f})})]})}function yq(){const{singers:t,selectSinger:e}=cs(),n=h.useRef(null),r=()=>{var i;return(i=n.current)==null?void 0:i.close()},s=i=>{e(i),r()};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("div",{children:"Singer"}),a.jsxs("div",{className:"-ml-2 flex flex-wrap",children:[t.map((i,o)=>a.jsxs(Fs,{children:[a.jsx("span",{children:i.name}),a.jsx("div",{className:"flex",children:a.jsx("button",{onClick:()=>e(i),children:a.jsx(xt,{className:"w-5"})})})]},o)),a.jsx(J,{onClick:()=>{var i;return(i=n.current)==null?void 0:i.open()},className:"mt-2 ml-2 h-[38px] w-[38px] justify-center",size:"clear",children:a.jsx(Vi,{className:"w-5"})})]})]}),a.jsx(Mw,{ref:n,children:a.jsx(pN,{closeModal:r,choose:s})})]})}function vq({audioEle:t}){const{status:e,handlePlayPause:n,progressLineRef:r,currentTimeRef:s,durationRef:i}=bg({audioEle:t}),o=()=>{switch(e){case"error":return a.jsx(Up,{className:"w-6"});case"playing":return a.jsx(NT,{className:"w-6"});case"paused":return a.jsx(AT,{className:"w-6"});case"waiting":return a.jsx(Me,{className:"w-6 animate-spin"})}};return a.jsx(a.Fragment,{children:a.jsxs("div",{className:"flex items-end justify-between",children:[a.jsx(J,{className:"p-1.5",size:"clear",onClick:n,children:o()}),a.jsxs("div",{className:"flex flex-grow items-center ml-4",children:[a.jsx("div",{className:"text-sm w-[50px]",ref:s,children:"00:00"}),a.jsx(wh,{elelRef:r,className:"h-1"}),a.jsx("div",{className:"text-sm w-[50px] text-right",ref:i,children:"00:00"})]})]})})}function wq(){const[t,e]=h.useState([]),{mains:n,subs:r}=h.useMemo(()=>{const i=[],o=[];return t.forEach(l=>{l.is_main?i.push(l):o.push(l)}),{mains:i,subs:o}},[t]),s=h.useRef(!0);return{genres:t,mains:n,subs:r,shouldFetchGenre:s,setGenres:e}}const gN=h.createContext(null);function _q({children:t}){return a.jsx(gN.Provider,{value:wq(),children:t})}const Hg=()=>{const t=h.useContext(gN);if(!t)throw new Error("GenreProvider is not provided");return t};function xN(){const{setGenres:t,genres:e}=Hg(),{setErrorToast:n,setSuccessToast:r}=ne(),[s,i]=h.useState(!1);return{isFetching:s,action:async l=>{try{switch(i(!0),l.type){case"add":{if(e.find(f=>f.name===l.genre.name))return await ss(100),n("Genre already exist");const u=await ai({collectionName:"Genres",data:l.genre}),d={...l.genre,id:u.id};return t(f=>[d,...f]),i(!1),r("Add genre successful"),d}case"edit":{await Re({collectionName:"Genres",data:l.genre,id:l.id});const c=[...e],u=c.findIndex(f=>f.id===l.id),d={...e[u]};Object.assign(d,l.genre),c[u]=d,t(c),r("Edit genre successful");break}case"delete":{await qw({collectionName:"Genres",id:l.id}),t(c=>c.filter(u=>u.id!==l.id)),r("Delete genre successful");break}}}catch{}finally{i(!1)}}}}function Gg({closeModal:t,afterSubmit:e,...n}){const[r,s]=h.useState(n.type==="add"?n.genreName||"":n.genre.name),[i,o]=h.useState(n.type==="add"?n.isMain||!1:n.genre.is_main),{action:l,isFetching:c}=xN(),{setErrorToast:u}=ne(),d=h.useRef(null),f=!!r,p=async()=>{try{if(!r.trim())return;const w={is_main:i,name:r};switch(n.type){case"add":const v=await l({type:"add",genre:w});v&&e&&e(v);break;case"edit":await l({type:"edit",genre:w,id:n.genre.id});break}}catch(w){console.log(w),u()}finally{t()}},g={inputGroup:"space-y-1"};h.useEffect(()=>{var w;(w=d.current)==null||w.focus()},[]);const x=n.type==="edit"?`Edit '${n.genre.name}'`:"Add genre";return a.jsxs(je,{className:"w-[450px]",children:[a.jsx(qe,{closeModal:t,title:x}),a.jsxs("div",{className:"space-y-3 overflow-auto mt-5",children:[a.jsxs("div",{className:g.inputGroup,children:[a.jsx(kt,{children:"Name"}),a.jsx(En,{ref:d,value:r,onChange:w=>s(w.target.value),placeholder:"name..."})]}),a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx(kt,{children:"Main"}),a.jsx(Ql,{inActiveBg:"bg-black/10",active:i,cb:()=>o(!i)})]})]}),a.jsx("div",{className:"text-right mt-10",children:a.jsxs(J,{disabled:!f,loading:c,onClick:()=>f&&p(),children:[a.jsx(Xa,{className:"w-6"}),a.jsx("p",{className:"text-white",children:"Ok"})]})}),c&&a.jsx(ea,{})]})}function Wg(){const{setGenres:t,shouldFetchGenre:e}=Hg(),[n,r]=h.useState(!0);return{api:async()=>{try{if(e.current){e.current=!1;const i=Mt(de,"Genres"),o=Ee(i);console.log(">>> fetch genres");const l=await tn(o);if(l.docs){const c=l.docs.map(u=>({...u.data(),id:u.id}));t(c)}}else await ss(100)}catch(i){console.log(i)}finally{r(!1)}},isFetching:n}}function yN(){const{genres:t,subs:e,mains:n}=Hg(),[r,s]=h.useState(""),i=d5(r,800),o=h.useMemo(()=>i?t.filter(l=>Un(l.name).includes(Un(i))):[],[i,t]);return{value:r,setValue:s,_genres:o,mains:n,subs:e}}function bq({closeModal:t,choose:e}){const{subs:n,...r}=yN(),s=h.useRef(null),i=h.useRef(null),o=()=>{var u;return(u=s.current)==null?void 0:u.close()},{api:l,isFetching:c}=Wg();return h.useEffect(()=>{var u;l(),(u=i.current)==null||u.focus()},[]),a.jsxs(a.Fragment,{children:[a.jsxs(je,{children:[a.jsx(qe,{title:"Genre",closeModal:t}),a.jsx(w5,{inputRef:i,...r}),a.jsx("div",{className:"h-[40vh] mt-3 space-y-1.5 overflow-auto",children:c?a.jsx(Rn,{className:"h-full"}):a.jsx(a.Fragment,{children:n.length?n.map((u,d)=>a.jsx("button",{className:"w-full text-left",onClick:()=>e(u),children:a.jsx(Zt,{children:a.jsx("p",{className:"text-lg",children:u.name})})},d)):a.jsx(a.Fragment,{children:a.jsx(Fe,{})})})}),a.jsx("p",{className:"text-center mt-auto",children:a.jsxs(J,{onClick:()=>{var u;return(u=s.current)==null?void 0:u.open()},children:[a.jsx(Wt,{className:"w-6"}),a.jsx("span",{children:"Add new genre"})]})})]}),a.jsx(ie,{ref:s,variant:"animation",children:a.jsx(Gg,{afterSubmit:e,genreName:r.value,type:"add",closeModal:o})})]})}function Sq({closeModal:t,choose:e}){const{mains:n}=Hg(),r=h.useRef(null),s=()=>{var l;return(l=r.current)==null?void 0:l.close()},{api:i,isFetching:o}=Wg();return h.useEffect(()=>{i()},[]),a.jsxs(a.Fragment,{children:[a.jsxs(je,{children:[a.jsx(qe,{title:"Genre",closeModal:t}),a.jsx("div",{className:"h-[40vh] mt-3 space-y-1.5 overflow-auto",children:o?a.jsx(Rn,{className:"h-full"}):a.jsx(a.Fragment,{children:n.length?n.map((l,c)=>a.jsx("button",{onClick:()=>{e(l),t()},className:"w-full text-left",children:a.jsx(Zt,{children:a.jsx("p",{className:"text-lg",children:l.name})})},c)):a.jsx(a.Fragment,{children:a.jsx(Fe,{})})})}),a.jsx("p",{className:"text-center mt-auto",children:a.jsxs(J,{onClick:()=>{var l;return(l=r.current)==null?void 0:l.open()},children:[a.jsx(Wt,{className:"w-6"}),a.jsx("span",{children:"Add new genre"})]})})]}),a.jsx(ie,{ref:r,variant:"animation",children:a.jsx(Gg,{afterSubmit:e,type:"add",isMain:!0,closeModal:s})})]})}function Eq(){const{genres:t,songData:e,updateSongData:n,selectGenre:r}=cs(),[s,i]=h.useState(""),o=h.useRef(null),l=d=>{var f;i(d),(f=o.current)==null||f.open()},c=d=>{r(d),u()},u=()=>{var d;return(d=o.current)==null?void 0:d.close()};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex w-full",children:[a.jsxs("div",{className:"w-1/2",children:[a.jsx("div",{children:"Main genre"}),a.jsxs("div",{className:"-ml-2 flex flex-wrap",children:[(e==null?void 0:e.main_genre)&&a.jsxs(Fs,{className:"w-fit",children:[a.jsx("span",{children:e.main_genre.name}),a.jsx("div",{children:a.jsx("button",{onClick:()=>n({main_genre:void 0}),children:a.jsx(xt,{className:"w-5"})})})]}),!(e!=null&&e.main_genre)&&a.jsx(J,{onClick:()=>l("main"),className:"mt-2 ml-2 h-[38px] w-[38px] justify-center",size:"clear",children:a.jsx(Vi,{className:"w-5"})})]})]}),a.jsxs("div",{className:"flex-grow",children:[a.jsx("div",{children:"Sub genres"}),a.jsxs("div",{className:"flex flex-wrap -ml-2",children:[t.map((d,f)=>a.jsxs(Fs,{children:[a.jsx("span",{children:d.name}),a.jsx("div",{children:a.jsx("button",{onClick:()=>r(d),children:a.jsx(xt,{className:"w-5"})})})]},f)),a.jsx(J,{onClick:()=>l("sub"),className:"mt-2 ml-2 h-[38px] w-[38px] justify-center",size:"clear",children:a.jsx(Vi,{className:"w-5"})})]})]})]}),a.jsxs(Mw,{ref:o,children:[s==="sub"&&a.jsx(bq,{closeModal:u,choose:c}),s==="main"&&a.jsx(Sq,{closeModal:u,choose:d=>n({main_genre:d})})]})]})}const jq="End-Of-Stream";class Pt extends Error{constructor(){super(jq)}}class kq{constructor(){this.maxStreamReadSize=1*1024*1024,this.endOfStream=!1,this.peekQueue=[]}async peek(e,n,r){const s=await this.read(e,n,r);return this.peekQueue.push(e.subarray(n,n+s)),s}async read(e,n,r){if(r===0)return 0;let s=this.readFromPeekBuffer(e,n,r);if(s+=await this.readRemainderFromStream(e,n+s,r-s),s===0)throw new Pt;return s}readFromPeekBuffer(e,n,r){let s=r,i=0;for(;this.peekQueue.length>0&&s>0;){const o=this.peekQueue.pop();if(!o)throw new Error("peekData should be defined");const l=Math.min(o.length,s);e.set(o.subarray(0,l),n+i),i+=l,s-=l,l<o.length&&this.peekQueue.push(o.subarray(l))}return i}async readRemainderFromStream(e,n,r){let s=r,i=0;for(;s>0&&!this.endOfStream;){const o=Math.min(s,this.maxStreamReadSize),l=await this.readFromStream(e,n+i,o);if(l===0)break;i+=l,s-=l}return i}}class Tq extends kq{constructor(e){super(),this.reader=e.getReader({mode:"byob"})}async readFromStream(e,n,r){if(this.endOfStream)throw new Pt;const s=await this.reader.read(new Uint8Array(r));return s.done&&(this.endOfStream=s.done),s.value?(e.set(s.value,n),s.value.byteLength):0}}class vN{constructor(e){this.position=0,this.numBuffer=new Uint8Array(8),this.fileInfo=(e==null?void 0:e.fileInfo)??{},this.onClose=e==null?void 0:e.onClose}async readToken(e,n=this.position){const r=new Uint8Array(e.len);if(await this.readBuffer(r,{position:n})<e.len)throw new Pt;return e.get(r,0)}async peekToken(e,n=this.position){const r=new Uint8Array(e.len);if(await this.peekBuffer(r,{position:n})<e.len)throw new Pt;return e.get(r,0)}async readNumber(e){if(await this.readBuffer(this.numBuffer,{length:e.len})<e.len)throw new Pt;return e.get(this.numBuffer,0)}async peekNumber(e){if(await this.peekBuffer(this.numBuffer,{length:e.len})<e.len)throw new Pt;return e.get(this.numBuffer,0)}async ignore(e){if(this.fileInfo.size!==void 0){const n=this.fileInfo.size-this.position;if(e>n)return this.position+=n,n}return this.position+=e,e}async close(){var e;await((e=this.onClose)==null?void 0:e.call(this))}normalizeOptions(e,n){if(n&&n.position!==void 0&&n.position<this.position)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");return n?{mayBeLess:n.mayBeLess===!0,offset:n.offset?n.offset:0,length:n.length?n.length:e.length-(n.offset?n.offset:0),position:n.position?n.position:this.position}:{mayBeLess:!1,offset:0,length:e.length,position:this.position}}}const Iq=256e3;class Cq extends vN{constructor(e,n){super(n),this.streamReader=e}async readBuffer(e,n){const r=this.normalizeOptions(e,n),s=r.position-this.position;if(s>0)return await this.ignore(s),this.readBuffer(e,n);if(s<0)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");if(r.length===0)return 0;const i=await this.streamReader.read(e,r.offset,r.length);if(this.position+=i,(!n||!n.mayBeLess)&&i<r.length)throw new Pt;return i}async peekBuffer(e,n){const r=this.normalizeOptions(e,n);let s=0;if(r.position){const i=r.position-this.position;if(i>0){const o=new Uint8Array(r.length+i);return s=await this.peekBuffer(o,{mayBeLess:r.mayBeLess}),e.set(o.subarray(i),r.offset),s-i}if(i<0)throw new Error("Cannot peek from a negative offset in a stream")}if(r.length>0){try{s=await this.streamReader.peek(e,r.offset,r.length)}catch(i){if(n!=null&&n.mayBeLess&&i instanceof Pt)return 0;throw i}if(!r.mayBeLess&&s<r.length)throw new Pt}return s}async ignore(e){const n=Math.min(Iq,e),r=new Uint8Array(n);let s=0;for(;s<e;){const i=e-s,o=await this.readBuffer(r,{length:Math.min(n,i)});if(o<0)return o;s+=o}return s}}class Rq extends vN{constructor(e,n){super(n),this.uint8Array=e,this.fileInfo.size=this.fileInfo.size?this.fileInfo.size:e.length}async readBuffer(e,n){if(n!=null&&n.position){if(n.position<this.position)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");this.position=n.position}const r=await this.peekBuffer(e,n);return this.position+=r,r}async peekBuffer(e,n){const r=this.normalizeOptions(e,n),s=Math.min(this.uint8Array.length-r.position,r.length);if(!r.mayBeLess&&s<r.length)throw new Pt;return e.set(this.uint8Array.subarray(r.position,r.position+s),r.offset),s}close(){return super.close()}}function wN(t,e){return new Cq(new Tq(t),e)}function Fc(t,e){return new Rq(t,e)}/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */var qg=function(t,e,n,r,s){var i,o,l=s*8-r-1,c=(1<<l)-1,u=c>>1,d=-7,f=n?s-1:0,p=n?-1:1,g=t[e+f];for(f+=p,i=g&(1<<-d)-1,g>>=-d,d+=l;d>0;i=i*256+t[e+f],f+=p,d-=8);for(o=i&(1<<-d)-1,i>>=-d,d+=r;d>0;o=o*256+t[e+f],f+=p,d-=8);if(i===0)i=1-u;else{if(i===c)return o?NaN:(g?-1:1)*(1/0);o=o+Math.pow(2,r),i=i-u}return(g?-1:1)*o*Math.pow(2,i-r)},Kg=function(t,e,n,r,s,i){var o,l,c,u=i*8-s-1,d=(1<<u)-1,f=d>>1,p=s===23?Math.pow(2,-24)-Math.pow(2,-77):0,g=r?0:i-1,x=r?1:-1,w=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(l=isNaN(e)?1:0,o=d):(o=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-o))<1&&(o--,c*=2),o+f>=1?e+=p/c:e+=p*Math.pow(2,1-f),e*c>=2&&(o++,c/=2),o+f>=d?(l=0,o=d):o+f>=1?(l=(e*c-1)*Math.pow(2,s),o=o+f):(l=e*Math.pow(2,f-1)*Math.pow(2,s),o=0));s>=8;t[n+g]=l&255,g+=x,l/=256,s-=8);for(o=o<<s|l,u+=s;u>0;t[n+g]=o&255,g+=x,o/=256,u-=8);t[n+g-x]|=w*128};function Ae(t){return new DataView(t.buffer,t.byteOffset)}const Pe={len:1,get(t,e){return Ae(t).getUint8(e)},put(t,e,n){return Ae(t).setUint8(e,n),e+1}},Ke={len:2,get(t,e){return Ae(t).getUint16(e,!0)},put(t,e,n){return Ae(t).setUint16(e,n,!0),e+2}},et={len:2,get(t,e){return Ae(t).getUint16(e)},put(t,e,n){return Ae(t).setUint16(e,n),e+2}},up={len:3,get(t,e){const n=Ae(t);return n.getUint8(e)+(n.getUint16(e+1,!0)<<8)},put(t,e,n){const r=Ae(t);return r.setUint8(e,n&255),r.setUint16(e+1,n>>8,!0),e+3}},tr={len:3,get(t,e){const n=Ae(t);return(n.getUint16(e)<<8)+n.getUint8(e+2)},put(t,e,n){const r=Ae(t);return r.setUint16(e,n>>8),r.setUint8(e+2,n&255),e+3}},le={len:4,get(t,e){return Ae(t).getUint32(e,!0)},put(t,e,n){return Ae(t).setUint32(e,n,!0),e+4}},xe={len:4,get(t,e){return Ae(t).getUint32(e)},put(t,e,n){return Ae(t).setUint32(e,n),e+4}},$d={len:1,get(t,e){return Ae(t).getInt8(e)},put(t,e,n){return Ae(t).setInt8(e,n),e+1}},Ci={len:2,get(t,e){return Ae(t).getInt16(e)},put(t,e,n){return Ae(t).setInt16(e,n),e+2}},Nq={len:2,get(t,e){return Ae(t).getInt16(e,!0)},put(t,e,n){return Ae(t).setInt16(e,n,!0),e+2}},Aq={len:3,get(t,e){const n=up.get(t,e);return n>8388607?n-16777216:n},put(t,e,n){const r=Ae(t);return r.setUint8(e,n&255),r.setUint16(e+1,n>>8,!0),e+3}},m_={len:3,get(t,e){const n=tr.get(t,e);return n>8388607?n-16777216:n},put(t,e,n){const r=Ae(t);return r.setUint16(e,n>>8),r.setUint8(e+2,n&255),e+3}},Lr={len:4,get(t,e){return Ae(t).getInt32(e)},put(t,e,n){return Ae(t).setInt32(e,n),e+4}},Rt={len:4,get(t,e){return Ae(t).getInt32(e,!0)},put(t,e,n){return Ae(t).setInt32(e,n,!0),e+4}},Xn={len:8,get(t,e){return Ae(t).getBigUint64(e,!0)},put(t,e,n){return Ae(t).setBigUint64(e,n,!0),e+8}},dp={len:8,get(t,e){return Ae(t).getBigInt64(e,!0)},put(t,e,n){return Ae(t).setBigInt64(e,n,!0),e+8}},p_={len:8,get(t,e){return Ae(t).getBigUint64(e)},put(t,e,n){return Ae(t).setBigUint64(e,n),e+8}},_N={len:8,get(t,e){return Ae(t).getBigInt64(e)},put(t,e,n){return Ae(t).setBigInt64(e,n),e+8}},Pq={len:2,get(t,e){return qg(t,e,!1,10,this.len)},put(t,e,n){return Kg(t,n,e,!1,10,this.len),e+this.len}},Fq={len:2,get(t,e){return qg(t,e,!0,10,this.len)},put(t,e,n){return Kg(t,n,e,!0,10,this.len),e+this.len}},bN={len:4,get(t,e){return Ae(t).getFloat32(e)},put(t,e,n){return Ae(t).setFloat32(e,n),e+4}},Mq={len:4,get(t,e){return Ae(t).getFloat32(e,!0)},put(t,e,n){return Ae(t).setFloat32(e,n,!0),e+4}},vv={len:8,get(t,e){return Ae(t).getFloat64(e)},put(t,e,n){return Ae(t).setFloat64(e,n),e+8}},Dq={len:8,get(t,e){return Ae(t).getFloat64(e,!0)},put(t,e,n){return Ae(t).setFloat64(e,n,!0),e+8}},Lq={len:10,get(t,e){return qg(t,e,!1,63,this.len)},put(t,e,n){return Kg(t,n,e,!1,63,this.len),e+this.len}},Oq={len:10,get(t,e){return qg(t,e,!0,63,this.len)},put(t,e,n){return Kg(t,n,e,!0,63,this.len),e+this.len}};class $q{constructor(e){this.len=e}get(e,n){}}class ur{constructor(e){this.len=e}get(e,n){return e.subarray(n,n+this.len)}}class me{constructor(e,n){this.len=e,this.encoding=n,this.textDecoder=new TextDecoder(n)}get(e,n){return this.textDecoder.decode(e.subarray(n,n+this.len))}}class zq{constructor(e){this.len=e,this.textDecoder=new TextDecoder("windows-1252")}get(e,n=0){return this.textDecoder.decode(e.subarray(n,n+this.len))}}const Bq=Object.freeze(Object.defineProperty({__proto__:null,AnsiStringType:zq,Float16_BE:Pq,Float16_LE:Fq,Float32_BE:bN,Float32_LE:Mq,Float64_BE:vv,Float64_LE:Dq,Float80_BE:Lq,Float80_LE:Oq,INT16_BE:Ci,INT16_LE:Nq,INT24_BE:m_,INT24_LE:Aq,INT32_BE:Lr,INT32_LE:Rt,INT64_BE:_N,INT64_LE:dp,INT8:$d,IgnoreType:$q,StringType:me,UINT16_BE:et,UINT16_LE:Ke,UINT24_BE:tr,UINT24_LE:up,UINT32_BE:xe,UINT32_LE:le,UINT64_BE:p_,UINT64_LE:Xn,UINT8:Pe,Uint8ArrayType:ur},Symbol.toStringTag,{value:"Module"})),Vq=Object.prototype.toString,Uq="[object Uint8Array]",Hq="[object ArrayBuffer]";function SN(t,e,n){return t?t.constructor===e?!0:Vq.call(t)===n:!1}function EN(t){return SN(t,Uint8Array,Uq)}function Gq(t){return SN(t,ArrayBuffer,Hq)}function Wq(t){return EN(t)||Gq(t)}function qq(t){if(!EN(t))throw new TypeError(`Expected \`Uint8Array\`, got \`${typeof t}\``)}function Kq(t){if(!Wq(t))throw new TypeError(`Expected \`Uint8Array\` or \`ArrayBuffer\`, got \`${typeof t}\``)}const If={utf8:new globalThis.TextDecoder("utf8")};function g_(t,e="utf8"){return Kq(t),If[e]??(If[e]=new globalThis.TextDecoder(e)),If[e].decode(t)}function jN(t){if(typeof t!="string")throw new TypeError(`Expected \`string\`, got \`${typeof t}\``)}const Qq=new globalThis.TextEncoder;function Xq(t){return jN(t),Qq.encode(t)}const Yq=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function x_(t){qq(t);let e="";for(let n=0;n<t.length;n++)e+=Yq[t[n]];return e}const iE={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,a:10,b:11,c:12,d:13,e:14,f:15,A:10,B:11,C:12,D:13,E:14,F:15};function aE(t){if(jN(t),t.length%2!==0)throw new Error("Invalid Hex string length.");const e=t.length/2,n=new Uint8Array(e);for(let r=0;r<e;r++){const s=iE[t[r*2]],i=iE[t[r*2+1]];if(s===void 0||i===void 0)throw new Error(`Invalid Hex character encountered at position ${r*2}`);n[r]=s<<4|i}return n}function oE(t){const{byteLength:e}=t;if(e===6)return t.getUint16(0)*2**32+t.getUint32(2);if(e===5)return t.getUint8(0)*2**32+t.getUint32(1);if(e===4)return t.getUint32(0);if(e===3)return t.getUint8(0)*2**16+t.getUint16(1);if(e===2)return t.getUint16(0);if(e===1)return t.getUint8(0)}function kN(t,e){const n=t.length,r=e.length;if(r===0||r>n)return-1;const s=n-r;for(let i=0;i<=s;i++){let o=!0;for(let l=0;l<r;l++)if(t[i+l]!==e[l]){o=!1;break}if(o)return i}return-1}function Jq(t,e){return kN(t,e)!==-1}function Zq(t){return[...t].map(e=>e.charCodeAt(0))}function eK(t,e=0){const n=Number.parseInt(new me(6).get(t,148).replace(/\0.*$/,"").trim(),8);if(Number.isNaN(n))return!1;let r=8*32;for(let s=e;s<e+148;s++)r+=t[s];for(let s=e+156;s<e+512;s++)r+=t[s];return n===r}const tK={get:(t,e)=>t[e+3]&127|t[e+2]<<7|t[e+1]<<14|t[e]<<21,len:4},nK=["jpg","png","apng","gif","webp","flif","xcf","cr2","cr3","orf","arw","dng","nef","rw2","raf","tif","bmp","icns","jxr","psd","indd","zip","tar","rar","gz","bz2","7z","dmg","mp4","mid","mkv","webm","mov","avi","mpg","mp2","mp3","m4a","oga","ogg","ogv","opus","flac","wav","spx","amr","pdf","epub","elf","macho","exe","swf","rtf","wasm","woff","woff2","eot","ttf","otf","ico","flv","ps","xz","sqlite","nes","crx","xpi","cab","deb","ar","rpm","Z","lz","cfb","mxf","mts","blend","bpg","docx","pptx","xlsx","3gp","3g2","j2c","jp2","jpm","jpx","mj2","aif","qcp","odt","ods","odp","xml","mobi","heic","cur","ktx","ape","wv","dcm","ics","glb","pcap","dsf","lnk","alias","voc","ac3","m4v","m4p","m4b","f4v","f4p","f4b","f4a","mie","asf","ogm","ogx","mpc","arrow","shp","aac","mp1","it","s3m","xm","ai","skp","avif","eps","lzh","pgp","asar","stl","chm","3mf","zst","jxl","vcf","jls","pst","dwg","parquet","class","arj","cpio","ace","avro","icc","fbx","vsdx"],rK=["image/jpeg","image/png","image/gif","image/webp","image/flif","image/x-xcf","image/x-canon-cr2","image/x-canon-cr3","image/tiff","image/bmp","image/vnd.ms-photo","image/vnd.adobe.photoshop","application/x-indesign","application/epub+zip","application/x-xpinstall","application/vnd.oasis.opendocument.text","application/vnd.oasis.opendocument.spreadsheet","application/vnd.oasis.opendocument.presentation","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/zip","application/x-tar","application/x-rar-compressed","application/gzip","application/x-bzip2","application/x-7z-compressed","application/x-apple-diskimage","application/x-apache-arrow","video/mp4","audio/midi","video/x-matroska","video/webm","video/quicktime","video/vnd.avi","audio/wav","audio/qcelp","audio/x-ms-asf","video/x-ms-asf","application/vnd.ms-asf","video/mpeg","video/3gpp","audio/mpeg","audio/mp4","audio/opus","video/ogg","audio/ogg","application/ogg","audio/x-flac","audio/ape","audio/wavpack","audio/amr","application/pdf","application/x-elf","application/x-mach-binary","application/x-msdownload","application/x-shockwave-flash","application/rtf","application/wasm","font/woff","font/woff2","application/vnd.ms-fontobject","font/ttf","font/otf","image/x-icon","video/x-flv","application/postscript","application/eps","application/x-xz","application/x-sqlite3","application/x-nintendo-nes-rom","application/x-google-chrome-extension","application/vnd.ms-cab-compressed","application/x-deb","application/x-unix-archive","application/x-rpm","application/x-compress","application/x-lzip","application/x-cfb","application/x-mie","application/mxf","video/mp2t","application/x-blender","image/bpg","image/j2c","image/jp2","image/jpx","image/jpm","image/mj2","audio/aiff","application/xml","application/x-mobipocket-ebook","image/heif","image/heif-sequence","image/heic","image/heic-sequence","image/icns","image/ktx","application/dicom","audio/x-musepack","text/calendar","text/vcard","model/gltf-binary","application/vnd.tcpdump.pcap","audio/x-dsf","application/x.ms.shortcut","application/x.apple.alias","audio/x-voc","audio/vnd.dolby.dd-raw","audio/x-m4a","image/apng","image/x-olympus-orf","image/x-sony-arw","image/x-adobe-dng","image/x-nikon-nef","image/x-panasonic-rw2","image/x-fujifilm-raf","video/x-m4v","video/3gpp2","application/x-esri-shape","audio/aac","audio/x-it","audio/x-s3m","audio/x-xm","video/MP1S","video/MP2P","application/vnd.sketchup.skp","image/avif","application/x-lzh-compressed","application/pgp-encrypted","application/x-asar","model/stl","application/vnd.ms-htmlhelp","model/3mf","image/jxl","application/zstd","image/jls","application/vnd.ms-outlook","image/vnd.dwg","application/x-parquet","application/java-vm","application/x-arj","application/x-cpio","application/x-ace-compressed","application/avro","application/vnd.iccprofile","application/x.autodesk.fbx","application/vnd.visio"],lE=4100;async function TN(t){return new sK().fromBuffer(t)}function Gs(t,e,n){n={offset:0,...n};for(const[r,s]of e.entries())if(n.mask){if(s!==(n.mask[r]&t[r+n.offset]))return!1}else if(s!==t[r+n.offset])return!1;return!0}class sK{constructor(e){this.detectors=e==null?void 0:e.customDetectors,this.fromTokenizer=this.fromTokenizer.bind(this),this.fromBuffer=this.fromBuffer.bind(this),this.parse=this.parse.bind(this)}async fromTokenizer(e){const n=e.position;for(const r of this.detectors||[]){const s=await r(e);if(s)return s;if(n!==e.position)return}return this.parse(e)}async fromBuffer(e){if(!(e instanceof Uint8Array||e instanceof ArrayBuffer))throw new TypeError(`Expected the \`input\` argument to be of type \`Uint8Array\` or \`ArrayBuffer\`, got \`${typeof e}\``);const n=e instanceof Uint8Array?e:new Uint8Array(e);if((n==null?void 0:n.length)>1)return this.fromTokenizer(Fc(n))}async fromBlob(e){return this.fromStream(e.stream())}async fromStream(e){const n=await wN(e);try{return await this.fromTokenizer(n)}finally{await n.close()}}async toDetectionStream(e,n){const{sampleSize:r=lE}=n;let s,i;const o=e.getReader({mode:"byob"});try{const{value:u,done:d}=await o.read(new Uint8Array(r));if(i=u,!d&&u)try{s=await this.fromBuffer(u.slice(0,r))}catch(f){if(!(f instanceof Pt))throw f;s=void 0}i=u}finally{o.releaseLock()}const l=new TransformStream({async start(u){u.enqueue(i)},transform(u,d){d.enqueue(u)}}),c=e.pipeThrough(l);return c.fileType=s,c}check(e,n){return Gs(this.buffer,e,n)}checkString(e,n){return this.check(Zq(e),n)}async parse(e){if(this.buffer=new Uint8Array(lE),e.fileInfo.size===void 0&&(e.fileInfo.size=Number.MAX_SAFE_INTEGER),this.tokenizer=e,await e.peekBuffer(this.buffer,{length:12,mayBeLess:!0}),this.check([66,77]))return{ext:"bmp",mime:"image/bmp"};if(this.check([11,119]))return{ext:"ac3",mime:"audio/vnd.dolby.dd-raw"};if(this.check([120,1]))return{ext:"dmg",mime:"application/x-apple-diskimage"};if(this.check([77,90]))return{ext:"exe",mime:"application/x-msdownload"};if(this.check([37,33]))return await e.peekBuffer(this.buffer,{length:24,mayBeLess:!0}),this.checkString("PS-Adobe-",{offset:2})&&this.checkString(" EPSF-",{offset:14})?{ext:"eps",mime:"application/eps"}:{ext:"ps",mime:"application/postscript"};if(this.check([31,160])||this.check([31,157]))return{ext:"Z",mime:"application/x-compress"};if(this.check([199,113]))return{ext:"cpio",mime:"application/x-cpio"};if(this.check([96,234]))return{ext:"arj",mime:"application/x-arj"};if(this.check([239,187,191]))return this.tokenizer.ignore(3),this.parse(e);if(this.check([71,73,70]))return{ext:"gif",mime:"image/gif"};if(this.check([73,73,188]))return{ext:"jxr",mime:"image/vnd.ms-photo"};if(this.check([31,139,8]))return{ext:"gz",mime:"application/gzip"};if(this.check([66,90,104]))return{ext:"bz2",mime:"application/x-bzip2"};if(this.checkString("ID3")){await e.ignore(6);const n=await e.readToken(tK);return e.position+n>e.fileInfo.size?{ext:"mp3",mime:"audio/mpeg"}:(await e.ignore(n),this.fromTokenizer(e))}if(this.checkString("MP+"))return{ext:"mpc",mime:"audio/x-musepack"};if((this.buffer[0]===67||this.buffer[0]===70)&&this.check([87,83],{offset:1}))return{ext:"swf",mime:"application/x-shockwave-flash"};if(this.check([255,216,255]))return this.check([247],{offset:3})?{ext:"jls",mime:"image/jls"}:{ext:"jpg",mime:"image/jpeg"};if(this.check([79,98,106,1]))return{ext:"avro",mime:"application/avro"};if(this.checkString("FLIF"))return{ext:"flif",mime:"image/flif"};if(this.checkString("8BPS"))return{ext:"psd",mime:"image/vnd.adobe.photoshop"};if(this.checkString("WEBP",{offset:8}))return{ext:"webp",mime:"image/webp"};if(this.checkString("MPCK"))return{ext:"mpc",mime:"audio/x-musepack"};if(this.checkString("FORM"))return{ext:"aif",mime:"audio/aiff"};if(this.checkString("icns",{offset:0}))return{ext:"icns",mime:"image/icns"};if(this.check([80,75,3,4])){try{for(;e.position+30<e.fileInfo.size;){await e.readBuffer(this.buffer,{length:30});const n=new DataView(this.buffer.buffer),r={compressedSize:n.getUint32(18,!0),uncompressedSize:n.getUint32(22,!0),filenameLength:n.getUint16(26,!0),extraFieldLength:n.getUint16(28,!0)};if(r.filename=await e.readToken(new me(r.filenameLength,"utf-8")),await e.ignore(r.extraFieldLength),r.filename==="META-INF/mozilla.rsa")return{ext:"xpi",mime:"application/x-xpinstall"};if(r.filename.endsWith(".rels")||r.filename.endsWith(".xml"))switch(r.filename.split("/")[0]){case"_rels":break;case"word":return{ext:"docx",mime:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"};case"ppt":return{ext:"pptx",mime:"application/vnd.openxmlformats-officedocument.presentationml.presentation"};case"xl":return{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"};case"visio":return{ext:"vsdx",mime:"application/vnd.visio"};default:break}if(r.filename.startsWith("xl/"))return{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"};if(r.filename.startsWith("3D/")&&r.filename.endsWith(".model"))return{ext:"3mf",mime:"model/3mf"};if(r.filename==="mimetype"&&r.compressedSize===r.uncompressedSize){let s=await e.readToken(new me(r.compressedSize,"utf-8"));switch(s=s.trim(),s){case"application/epub+zip":return{ext:"epub",mime:"application/epub+zip"};case"application/vnd.oasis.opendocument.text":return{ext:"odt",mime:"application/vnd.oasis.opendocument.text"};case"application/vnd.oasis.opendocument.spreadsheet":return{ext:"ods",mime:"application/vnd.oasis.opendocument.spreadsheet"};case"application/vnd.oasis.opendocument.presentation":return{ext:"odp",mime:"application/vnd.oasis.opendocument.presentation"};default:}}if(r.compressedSize===0){let s=-1;for(;s<0&&e.position<e.fileInfo.size;)await e.peekBuffer(this.buffer,{mayBeLess:!0}),s=kN(this.buffer,new Uint8Array([80,75,3,4])),await e.ignore(s>=0?s:this.buffer.length)}else await e.ignore(r.compressedSize)}}catch(n){if(!(n instanceof Pt))throw n}return{ext:"zip",mime:"application/zip"}}if(this.checkString("OggS")){await e.ignore(28);const n=new Uint8Array(8);return await e.readBuffer(n),Gs(n,[79,112,117,115,72,101,97,100])?{ext:"opus",mime:"audio/opus"}:Gs(n,[128,116,104,101,111,114,97])?{ext:"ogv",mime:"video/ogg"}:Gs(n,[1,118,105,100,101,111,0])?{ext:"ogm",mime:"video/ogg"}:Gs(n,[127,70,76,65,67])?{ext:"oga",mime:"audio/ogg"}:Gs(n,[83,112,101,101,120,32,32])?{ext:"spx",mime:"audio/ogg"}:Gs(n,[1,118,111,114,98,105,115])?{ext:"ogg",mime:"audio/ogg"}:{ext:"ogx",mime:"application/ogg"}}if(this.check([80,75])&&(this.buffer[2]===3||this.buffer[2]===5||this.buffer[2]===7)&&(this.buffer[3]===4||this.buffer[3]===6||this.buffer[3]===8))return{ext:"zip",mime:"application/zip"};if(this.checkString("ftyp",{offset:4})&&this.buffer[8]&96){const n=new me(4,"latin1").get(this.buffer,8).replace("\0"," ").trim();switch(n){case"avif":case"avis":return{ext:"avif",mime:"image/avif"};case"mif1":return{ext:"heic",mime:"image/heif"};case"msf1":return{ext:"heic",mime:"image/heif-sequence"};case"heic":case"heix":return{ext:"heic",mime:"image/heic"};case"hevc":case"hevx":return{ext:"heic",mime:"image/heic-sequence"};case"qt":return{ext:"mov",mime:"video/quicktime"};case"M4V":case"M4VH":case"M4VP":return{ext:"m4v",mime:"video/x-m4v"};case"M4P":return{ext:"m4p",mime:"video/mp4"};case"M4B":return{ext:"m4b",mime:"audio/mp4"};case"M4A":return{ext:"m4a",mime:"audio/x-m4a"};case"F4V":return{ext:"f4v",mime:"video/mp4"};case"F4P":return{ext:"f4p",mime:"video/mp4"};case"F4A":return{ext:"f4a",mime:"audio/mp4"};case"F4B":return{ext:"f4b",mime:"audio/mp4"};case"crx":return{ext:"cr3",mime:"image/x-canon-cr3"};default:return n.startsWith("3g")?n.startsWith("3g2")?{ext:"3g2",mime:"video/3gpp2"}:{ext:"3gp",mime:"video/3gpp"}:{ext:"mp4",mime:"video/mp4"}}}if(this.checkString("MThd"))return{ext:"mid",mime:"audio/midi"};if(this.checkString("wOFF")&&(this.check([0,1,0,0],{offset:4})||this.checkString("OTTO",{offset:4})))return{ext:"woff",mime:"font/woff"};if(this.checkString("wOF2")&&(this.check([0,1,0,0],{offset:4})||this.checkString("OTTO",{offset:4})))return{ext:"woff2",mime:"font/woff2"};if(this.check([212,195,178,161])||this.check([161,178,195,212]))return{ext:"pcap",mime:"application/vnd.tcpdump.pcap"};if(this.checkString("DSD "))return{ext:"dsf",mime:"audio/x-dsf"};if(this.checkString("LZIP"))return{ext:"lz",mime:"application/x-lzip"};if(this.checkString("fLaC"))return{ext:"flac",mime:"audio/x-flac"};if(this.check([66,80,71,251]))return{ext:"bpg",mime:"image/bpg"};if(this.checkString("wvpk"))return{ext:"wv",mime:"audio/wavpack"};if(this.checkString("%PDF")){try{await e.ignore(1350);const n=10*1024*1024,r=new Uint8Array(Math.min(n,e.fileInfo.size));if(await e.readBuffer(r,{mayBeLess:!0}),Jq(r,new TextEncoder().encode("AIPrivateData")))return{ext:"ai",mime:"application/postscript"}}catch(n){if(!(n instanceof Pt))throw n}return{ext:"pdf",mime:"application/pdf"}}if(this.check([0,97,115,109]))return{ext:"wasm",mime:"application/wasm"};if(this.check([73,73])){const n=await this.readTiffHeader(!1);if(n)return n}if(this.check([77,77])){const n=await this.readTiffHeader(!0);if(n)return n}if(this.checkString("MAC "))return{ext:"ape",mime:"audio/ape"};if(this.check([26,69,223,163])){async function n(){const l=await e.peekNumber(Pe);let c=128,u=0;for(;!(l&c)&&c!==0;)++u,c>>=1;const d=new Uint8Array(u+1);return await e.readBuffer(d),d}async function r(){const l=await n(),c=await n();c[0]^=128>>c.length-1;const u=Math.min(6,c.length),d=new DataView(l.buffer),f=new DataView(c.buffer,c.length-u,u);return{id:oE(d),len:oE(f)}}async function s(l){for(;l>0;){const c=await r();if(c.id===17026)return(await e.readToken(new me(c.len))).replaceAll(/\00.*$/g,"");await e.ignore(c.len),--l}}const i=await r();switch(await s(i.len)){case"webm":return{ext:"webm",mime:"video/webm"};case"matroska":return{ext:"mkv",mime:"video/x-matroska"};default:return}}if(this.check([82,73,70,70])){if(this.check([65,86,73],{offset:8}))return{ext:"avi",mime:"video/vnd.avi"};if(this.check([87,65,86,69],{offset:8}))return{ext:"wav",mime:"audio/wav"};if(this.check([81,76,67,77],{offset:8}))return{ext:"qcp",mime:"audio/qcelp"}}if(this.checkString("SQLi"))return{ext:"sqlite",mime:"application/x-sqlite3"};if(this.check([78,69,83,26]))return{ext:"nes",mime:"application/x-nintendo-nes-rom"};if(this.checkString("Cr24"))return{ext:"crx",mime:"application/x-google-chrome-extension"};if(this.checkString("MSCF")||this.checkString("ISc("))return{ext:"cab",mime:"application/vnd.ms-cab-compressed"};if(this.check([237,171,238,219]))return{ext:"rpm",mime:"application/x-rpm"};if(this.check([197,208,211,198]))return{ext:"eps",mime:"application/eps"};if(this.check([40,181,47,253]))return{ext:"zst",mime:"application/zstd"};if(this.check([127,69,76,70]))return{ext:"elf",mime:"application/x-elf"};if(this.check([33,66,68,78]))return{ext:"pst",mime:"application/vnd.ms-outlook"};if(this.checkString("PAR1"))return{ext:"parquet",mime:"application/x-parquet"};if(this.check([207,250,237,254]))return{ext:"macho",mime:"application/x-mach-binary"};if(this.check([79,84,84,79,0]))return{ext:"otf",mime:"font/otf"};if(this.checkString("#!AMR"))return{ext:"amr",mime:"audio/amr"};if(this.checkString("{\\rtf"))return{ext:"rtf",mime:"application/rtf"};if(this.check([70,76,86,1]))return{ext:"flv",mime:"video/x-flv"};if(this.checkString("IMPM"))return{ext:"it",mime:"audio/x-it"};if(this.checkString("-lh0-",{offset:2})||this.checkString("-lh1-",{offset:2})||this.checkString("-lh2-",{offset:2})||this.checkString("-lh3-",{offset:2})||this.checkString("-lh4-",{offset:2})||this.checkString("-lh5-",{offset:2})||this.checkString("-lh6-",{offset:2})||this.checkString("-lh7-",{offset:2})||this.checkString("-lzs-",{offset:2})||this.checkString("-lz4-",{offset:2})||this.checkString("-lz5-",{offset:2})||this.checkString("-lhd-",{offset:2}))return{ext:"lzh",mime:"application/x-lzh-compressed"};if(this.check([0,0,1,186])){if(this.check([33],{offset:4,mask:[241]}))return{ext:"mpg",mime:"video/MP1S"};if(this.check([68],{offset:4,mask:[196]}))return{ext:"mpg",mime:"video/MP2P"}}if(this.checkString("ITSF"))return{ext:"chm",mime:"application/vnd.ms-htmlhelp"};if(this.check([202,254,186,190]))return{ext:"class",mime:"application/java-vm"};if(this.check([253,55,122,88,90,0]))return{ext:"xz",mime:"application/x-xz"};if(this.checkString("<?xml "))return{ext:"xml",mime:"application/xml"};if(this.check([55,122,188,175,39,28]))return{ext:"7z",mime:"application/x-7z-compressed"};if(this.check([82,97,114,33,26,7])&&(this.buffer[6]===0||this.buffer[6]===1))return{ext:"rar",mime:"application/x-rar-compressed"};if(this.checkString("solid "))return{ext:"stl",mime:"model/stl"};if(this.checkString("AC")){const n=new me(4,"latin1").get(this.buffer,2);if(n.match("^d*")&&n>=1e3&&n<=1050)return{ext:"dwg",mime:"image/vnd.dwg"}}if(this.checkString("070707"))return{ext:"cpio",mime:"application/x-cpio"};if(this.checkString("BLENDER"))return{ext:"blend",mime:"application/x-blender"};if(this.checkString("!<arch>"))return await e.ignore(8),await e.readToken(new me(13,"ascii"))==="debian-binary"?{ext:"deb",mime:"application/x-deb"}:{ext:"ar",mime:"application/x-unix-archive"};if(this.checkString("**ACE",{offset:7})&&(await e.peekBuffer(this.buffer,{length:14,mayBeLess:!0}),this.checkString("**",{offset:12})))return{ext:"ace",mime:"application/x-ace-compressed"};if(this.check([137,80,78,71,13,10,26,10])){await e.ignore(8);async function n(){return{length:await e.readToken(Lr),type:await e.readToken(new me(4,"latin1"))}}do{const r=await n();if(r.length<0)return;switch(r.type){case"IDAT":return{ext:"png",mime:"image/png"};case"acTL":return{ext:"apng",mime:"image/apng"};default:await e.ignore(r.length+4)}}while(e.position+8<e.fileInfo.size);return{ext:"png",mime:"image/png"}}if(this.check([65,82,82,79,87,49,0,0]))return{ext:"arrow",mime:"application/x-apache-arrow"};if(this.check([103,108,84,70,2,0,0,0]))return{ext:"glb",mime:"model/gltf-binary"};if(this.check([102,114,101,101],{offset:4})||this.check([109,100,97,116],{offset:4})||this.check([109,111,111,118],{offset:4})||this.check([119,105,100,101],{offset:4}))return{ext:"mov",mime:"video/quicktime"};if(this.check([73,73,82,79,8,0,0,0,24]))return{ext:"orf",mime:"image/x-olympus-orf"};if(this.checkString("gimp xcf "))return{ext:"xcf",mime:"image/x-xcf"};if(this.check([73,73,85,0,24,0,0,0,136,231,116,216]))return{ext:"rw2",mime:"image/x-panasonic-rw2"};if(this.check([48,38,178,117,142,102,207,17,166,217])){async function n(){const r=new Uint8Array(16);return await e.readBuffer(r),{id:r,size:Number(await e.readToken(Xn))}}for(await e.ignore(30);e.position+24<e.fileInfo.size;){const r=await n();let s=r.size-24;if(Gs(r.id,[145,7,220,183,183,169,207,17,142,230,0,192,12,32,83,101])){const i=new Uint8Array(16);if(s-=await e.readBuffer(i),Gs(i,[64,158,105,248,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"audio/x-ms-asf"};if(Gs(i,[192,239,25,188,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"video/x-ms-asf"};break}await e.ignore(s)}return{ext:"asf",mime:"application/vnd.ms-asf"}}if(this.check([171,75,84,88,32,49,49,187,13,10,26,10]))return{ext:"ktx",mime:"image/ktx"};if((this.check([126,16,4])||this.check([126,24,4]))&&this.check([48,77,73,69],{offset:4}))return{ext:"mie",mime:"application/x-mie"};if(this.check([39,10,0,0,0,0,0,0,0,0,0,0],{offset:2}))return{ext:"shp",mime:"application/x-esri-shape"};if(this.check([255,79,255,81]))return{ext:"j2c",mime:"image/j2c"};if(this.check([0,0,0,12,106,80,32,32,13,10,135,10]))switch(await e.ignore(20),await e.readToken(new me(4,"ascii"))){case"jp2 ":return{ext:"jp2",mime:"image/jp2"};case"jpx ":return{ext:"jpx",mime:"image/jpx"};case"jpm ":return{ext:"jpm",mime:"image/jpm"};case"mjp2":return{ext:"mj2",mime:"image/mj2"};default:return}if(this.check([255,10])||this.check([0,0,0,12,74,88,76,32,13,10,135,10]))return{ext:"jxl",mime:"image/jxl"};if(this.check([254,255]))return this.check([0,60,0,63,0,120,0,109,0,108],{offset:2})?{ext:"xml",mime:"application/xml"}:void 0;if(this.check([0,0,1,186])||this.check([0,0,1,179]))return{ext:"mpg",mime:"video/mpeg"};if(this.check([0,1,0,0,0]))return{ext:"ttf",mime:"font/ttf"};if(this.check([0,0,1,0]))return{ext:"ico",mime:"image/x-icon"};if(this.check([0,0,2,0]))return{ext:"cur",mime:"image/x-icon"};if(this.check([208,207,17,224,161,177,26,225]))return{ext:"cfb",mime:"application/x-cfb"};if(await e.peekBuffer(this.buffer,{length:Math.min(256,e.fileInfo.size),mayBeLess:!0}),this.check([97,99,115,112],{offset:36}))return{ext:"icc",mime:"application/vnd.iccprofile"};if(this.checkString("BEGIN:")){if(this.checkString("VCARD",{offset:6}))return{ext:"vcf",mime:"text/vcard"};if(this.checkString("VCALENDAR",{offset:6}))return{ext:"ics",mime:"text/calendar"}}if(this.checkString("FUJIFILMCCD-RAW"))return{ext:"raf",mime:"image/x-fujifilm-raf"};if(this.checkString("Extended Module:"))return{ext:"xm",mime:"audio/x-xm"};if(this.checkString("Creative Voice File"))return{ext:"voc",mime:"audio/x-voc"};if(this.check([4,0,0,0])&&this.buffer.length>=16){const n=new DataView(this.buffer.buffer).getUint32(12,!0);if(n>12&&this.buffer.length>=n+16)try{const r=new TextDecoder().decode(this.buffer.slice(16,n+16));if(JSON.parse(r).files)return{ext:"asar",mime:"application/x-asar"}}catch{}}if(this.check([6,14,43,52,2,5,1,1,13,1,2,1,1,2]))return{ext:"mxf",mime:"application/mxf"};if(this.checkString("SCRM",{offset:44}))return{ext:"s3m",mime:"audio/x-s3m"};if(this.check([71])&&this.check([71],{offset:188}))return{ext:"mts",mime:"video/mp2t"};if(this.check([71],{offset:4})&&this.check([71],{offset:196}))return{ext:"mts",mime:"video/mp2t"};if(this.check([66,79,79,75,77,79,66,73],{offset:60}))return{ext:"mobi",mime:"application/x-mobipocket-ebook"};if(this.check([68,73,67,77],{offset:128}))return{ext:"dcm",mime:"application/dicom"};if(this.check([76,0,0,0,1,20,2,0,0,0,0,0,192,0,0,0,0,0,0,70]))return{ext:"lnk",mime:"application/x.ms.shortcut"};if(this.check([98,111,111,107,0,0,0,0,109,97,114,107,0,0,0,0]))return{ext:"alias",mime:"application/x.apple.alias"};if(this.checkString("Kaydara FBX Binary  \0"))return{ext:"fbx",mime:"application/x.autodesk.fbx"};if(this.check([76,80],{offset:34})&&(this.check([0,0,1],{offset:8})||this.check([1,0,2],{offset:8})||this.check([2,0,2],{offset:8})))return{ext:"eot",mime:"application/vnd.ms-fontobject"};if(this.check([6,6,237,245,216,29,70,229,189,49,239,231,254,116,183,29]))return{ext:"indd",mime:"application/x-indesign"};if(await e.peekBuffer(this.buffer,{length:Math.min(512,e.fileInfo.size),mayBeLess:!0}),eK(this.buffer))return{ext:"tar",mime:"application/x-tar"};if(this.check([255,254]))return this.check([60,0,63,0,120,0,109,0,108,0],{offset:2})?{ext:"xml",mime:"application/xml"}:this.check([255,14,83,0,107,0,101,0,116,0,99,0,104,0,85,0,112,0,32,0,77,0,111,0,100,0,101,0,108,0],{offset:2})?{ext:"skp",mime:"application/vnd.sketchup.skp"}:void 0;if(this.checkString("-----BEGIN PGP MESSAGE-----"))return{ext:"pgp",mime:"application/pgp-encrypted"};if(this.buffer.length>=2&&this.check([255,224],{offset:0,mask:[255,224]})){if(this.check([16],{offset:1,mask:[22]}))return this.check([8],{offset:1,mask:[8]})?{ext:"aac",mime:"audio/aac"}:{ext:"aac",mime:"audio/aac"};if(this.check([2],{offset:1,mask:[6]}))return{ext:"mp3",mime:"audio/mpeg"};if(this.check([4],{offset:1,mask:[6]}))return{ext:"mp2",mime:"audio/mpeg"};if(this.check([6],{offset:1,mask:[6]}))return{ext:"mp1",mime:"audio/mpeg"}}}async readTiffTag(e){const n=await this.tokenizer.readToken(e?et:Ke);switch(this.tokenizer.ignore(10),n){case 50341:return{ext:"arw",mime:"image/x-sony-arw"};case 50706:return{ext:"dng",mime:"image/x-adobe-dng"}}}async readTiffIFD(e){const n=await this.tokenizer.readToken(e?et:Ke);for(let r=0;r<n;++r){const s=await this.readTiffTag(e);if(s)return s}}async readTiffHeader(e){const n=(e?et:Ke).get(this.buffer,2),r=(e?xe:le).get(this.buffer,4);if(n===42){if(r>=6){if(this.checkString("CR",{offset:8}))return{ext:"cr2",mime:"image/x-canon-cr2"};if(r>=8&&(this.check([28,0,254,0],{offset:8})||this.check([31,0,11,0],{offset:8})))return{ext:"nef",mime:"image/x-nikon-nef"}}return await this.tokenizer.ignore(r),await this.readTiffIFD(e)??{ext:"tif",mime:"image/tiff"}}if(n===43)return{ext:"tif",mime:"image/tiff"}}}new Set(nK);new Set(rK);var y_={};/*!
 * content-type
 * Copyright(c) 2015 Douglas Christopher Wilson
 * MIT Licensed
 */var cE=/; *([!#$%&'*+.^_`|~0-9A-Za-z-]+) *= *("(?:[\u000b\u0020\u0021\u0023-\u005b\u005d-\u007e\u0080-\u00ff]|\\[\u000b\u0020-\u00ff])*"|[!#$%&'*+.^_`|~0-9A-Za-z-]+) */g,iK=/^[\u000b\u0020-\u007e\u0080-\u00ff]+$/,IN=/^[!#$%&'*+.^_`|~0-9A-Za-z-]+$/,aK=/\\([\u000b\u0020-\u00ff])/g,oK=/([\\"])/g,CN=/^[!#$%&'*+.^_`|~0-9A-Za-z-]+\/[!#$%&'*+.^_`|~0-9A-Za-z-]+$/;y_.format=lK;y_.parse=cK;function lK(t){if(!t||typeof t!="object")throw new TypeError("argument obj is required");var e=t.parameters,n=t.type;if(!n||!CN.test(n))throw new TypeError("invalid type");var r=n;if(e&&typeof e=="object")for(var s,i=Object.keys(e).sort(),o=0;o<i.length;o++){if(s=i[o],!IN.test(s))throw new TypeError("invalid parameter name");r+="; "+s+"="+dK(e[s])}return r}function cK(t){if(!t)throw new TypeError("argument string is required");var e=typeof t=="object"?uK(t):t;if(typeof e!="string")throw new TypeError("argument string is required to be a string");var n=e.indexOf(";"),r=n!==-1?e.slice(0,n).trim():e.trim();if(!CN.test(r))throw new TypeError("invalid media type");var s=new hK(r.toLowerCase());if(n!==-1){var i,o,l;for(cE.lastIndex=n;o=cE.exec(e);){if(o.index!==n)throw new TypeError("invalid parameter format");n+=o[0].length,i=o[1].toLowerCase(),l=o[2],l.charCodeAt(0)===34&&(l=l.slice(1,-1),l.indexOf("\\")!==-1&&(l=l.replace(aK,"$1"))),s.parameters[i]=l}if(n!==e.length)throw new TypeError("invalid parameter format")}return s}function uK(t){var e;if(typeof t.getHeader=="function"?e=t.getHeader("content-type"):typeof t.headers=="object"&&(e=t.headers&&t.headers["content-type"]),typeof e!="string")throw new TypeError("content-type header is missing from object");return e}function dK(t){var e=String(t);if(IN.test(e))return e;if(e.length>0&&!iK.test(e))throw new TypeError("invalid parameter value");return'"'+e.replace(oK,"\\$1")+'"'}function hK(t){this.parameters=Object.create(null),this.type=t}/*!
 * media-typer
 * Copyright(c) 2014-2017 Douglas Christopher Wilson
 * MIT Licensed
 */var fK=/^ *([A-Za-z0-9][A-Za-z0-9!#$&^_-]{0,126})\/([A-Za-z0-9][A-Za-z0-9!#$&^_.+-]{0,126}) *$/,mK=pK;function pK(t){if(!t)throw new TypeError("argument string is required");if(typeof t!="string")throw new TypeError("argument string is required to be a string");var e=fK.exec(t.toLowerCase());if(!e)throw new TypeError("invalid media type");var n=e[1],r=e[2],s,i=r.lastIndexOf("+");return i!==-1&&(s=r.substr(i+1),r=r.substr(0,i)),new gK(n,r,s)}function gK(t,e,n){this.type=t,this.subtype=e,this.suffix=n}var wv={exports:{}},yx,uE;function xK(){if(uE)return yx;uE=1;var t=1e3,e=t*60,n=e*60,r=n*24,s=r*7,i=r*365.25;yx=function(d,f){f=f||{};var p=typeof d;if(p==="string"&&d.length>0)return o(d);if(p==="number"&&isFinite(d))return f.long?c(d):l(d);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(d))};function o(d){if(d=String(d),!(d.length>100)){var f=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(d);if(f){var p=parseFloat(f[1]),g=(f[2]||"ms").toLowerCase();switch(g){case"years":case"year":case"yrs":case"yr":case"y":return p*i;case"weeks":case"week":case"w":return p*s;case"days":case"day":case"d":return p*r;case"hours":case"hour":case"hrs":case"hr":case"h":return p*n;case"minutes":case"minute":case"mins":case"min":case"m":return p*e;case"seconds":case"second":case"secs":case"sec":case"s":return p*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return p;default:return}}}}function l(d){var f=Math.abs(d);return f>=r?Math.round(d/r)+"d":f>=n?Math.round(d/n)+"h":f>=e?Math.round(d/e)+"m":f>=t?Math.round(d/t)+"s":d+"ms"}function c(d){var f=Math.abs(d);return f>=r?u(d,f,r,"day"):f>=n?u(d,f,n,"hour"):f>=e?u(d,f,e,"minute"):f>=t?u(d,f,t,"second"):d+" ms"}function u(d,f,p,g){var x=f>=p*1.5;return Math.round(d/p)+" "+g+(x?"s":"")}return yx}function yK(t){n.debug=n,n.default=n,n.coerce=c,n.disable=i,n.enable=s,n.enabled=o,n.humanize=xK(),n.destroy=u,Object.keys(t).forEach(d=>{n[d]=t[d]}),n.names=[],n.skips=[],n.formatters={};function e(d){let f=0;for(let p=0;p<d.length;p++)f=(f<<5)-f+d.charCodeAt(p),f|=0;return n.colors[Math.abs(f)%n.colors.length]}n.selectColor=e;function n(d){let f,p=null,g,x;function w(...v){if(!w.enabled)return;const _=w,b=Number(new Date),j=b-(f||b);_.diff=j,_.prev=f,_.curr=b,f=b,v[0]=n.coerce(v[0]),typeof v[0]!="string"&&v.unshift("%O");let T=0;v[0]=v[0].replace(/%([a-zA-Z%])/g,(M,k)=>{if(M==="%%")return"%";T++;const E=n.formatters[k];if(typeof E=="function"){const I=v[T];M=E.call(_,I),v.splice(T,1),T--}return M}),n.formatArgs.call(_,v),(_.log||n.log).apply(_,v)}return w.namespace=d,w.useColors=n.useColors(),w.color=n.selectColor(d),w.extend=r,w.destroy=n.destroy,Object.defineProperty(w,"enabled",{enumerable:!0,configurable:!1,get:()=>p!==null?p:(g!==n.namespaces&&(g=n.namespaces,x=n.enabled(d)),x),set:v=>{p=v}}),typeof n.init=="function"&&n.init(w),w}function r(d,f){const p=n(this.namespace+(typeof f>"u"?":":f)+d);return p.log=this.log,p}function s(d){n.save(d),n.namespaces=d,n.names=[],n.skips=[];let f;const p=(typeof d=="string"?d:"").split(/[\s,]+/),g=p.length;for(f=0;f<g;f++)p[f]&&(d=p[f].replace(/\*/g,".*?"),d[0]==="-"?n.skips.push(new RegExp("^"+d.slice(1)+"$")):n.names.push(new RegExp("^"+d+"$")))}function i(){const d=[...n.names.map(l),...n.skips.map(l).map(f=>"-"+f)].join(",");return n.enable(""),d}function o(d){if(d[d.length-1]==="*")return!0;let f,p;for(f=0,p=n.skips.length;f<p;f++)if(n.skips[f].test(d))return!1;for(f=0,p=n.names.length;f<p;f++)if(n.names[f].test(d))return!0;return!1}function l(d){return d.toString().substring(2,d.toString().length-2).replace(/\.\*\?$/,"*")}function c(d){return d instanceof Error?d.stack||d.message:d}function u(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return n.enable(n.load()),n}var vK=yK;(function(t,e){e.formatArgs=r,e.save=s,e.load=i,e.useColors=n,e.storage=o(),e.destroy=(()=>{let c=!1;return()=>{c||(c=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function n(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function r(c){if(c[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+c[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;const u="color: "+this.color;c.splice(1,0,u,"color: inherit");let d=0,f=0;c[0].replace(/%[a-zA-Z%]/g,p=>{p!=="%%"&&(d++,p==="%c"&&(f=d))}),c.splice(f,0,u)}e.log=console.debug||console.log||(()=>{});function s(c){try{c?e.storage.setItem("debug",c):e.storage.removeItem("debug")}catch{}}function i(){let c;try{c=e.storage.getItem("debug")}catch{}return!c&&typeof process<"u"&&"env"in process&&(c={}.DEBUG),c}function o(){try{return localStorage}catch{}}t.exports=vK(e);const{formatters:l}=t.exports;l.j=function(c){try{return JSON.stringify(c)}catch(u){return"[UnexpectedJSONParseError]: "+u.message}}})(wv,wv.exports);var wK=wv.exports;const st=Pv(wK);var _v;(function(t){t[t.shot=10]="shot",t[t.scene=20]="scene",t[t.track=30]="track",t[t.part=40]="part",t[t.album=50]="album",t[t.edition=60]="edition",t[t.collection=70]="collection"})(_v||(_v={}));var el;(function(t){t[t.video=1]="video",t[t.audio=2]="audio",t[t.complex=3]="complex",t[t.logo=4]="logo",t[t.subtitle=17]="subtitle",t[t.button=18]="button",t[t.control=32]="control"})(el||(el={}));function jt(t,e,n){return(t[e]&1<<n)!==0}function kr(t,e,n,r){let s=e;if(r==="utf-16le"){for(;t[s]!==0||t[s+1]!==0;){if(s>=n)return n;s+=2}return s}for(;t[s]!==0;){if(s>=n)return n;s++}return s}function RN(t){const e=t.indexOf("\0");return e===-1?t:t.substr(0,e)}function _K(t){const e=t.length;if(e&1)throw new Error("Buffer length must be even");for(let n=0;n<e;n+=2){const r=t[n];t[n]=t[n+1],t[n+1]=r}return t}function Xt(t,e){if(t[0]===255&&t[1]===254)return Xt(t.subarray(2),e);if(e==="utf-16le"&&t[0]===254&&t[1]===255){if(t.length&1)throw new Error("Expected even number of octets for 16-bit unicode string");return Xt(_K(t),e)}return new me(t.length,e).get(t,0)}function wa(t){return t=t.replace(/^\x00+/g,""),t=t.replace(/\x00+$/g,""),t}function ze(t,e,n,r){const s=e+~~(n/8),i=n%8;let o=t[s];o&=255>>i;const l=8-i,c=r-l;return c<0?o>>=8-i-r:c>0&&(o<<=c,o|=ze(t,e,n+l,c)),o}function Nr(t,e,n){return ze(t,e,n,1)===1}function bK(t){const e=[];for(let n=0,r=t.length;n<r;n++){const s=Number(t.charCodeAt(n)).toString(16);e.push(s.length===1?`0${s}`:s)}return e.join(" ")}function SK(t){return 10*Math.log10(t)}function EK(t){return 10**(t/10)}function jK(t){const e=t.split(" ").map(n=>n.trim().toLowerCase());if(e.length>=1){const n=Number.parseFloat(e[0]);return e.length===2&&e[1]==="db"?{dB:n,ratio:EK(n)}:{dB:SK(n),ratio:n}}}var zd;(function(t){t[t.Other=0]="Other",t[t["32x32 pixels 'file icon' (PNG only)"]=1]="32x32 pixels 'file icon' (PNG only)",t[t["Other file icon"]=2]="Other file icon",t[t["Cover (front)"]=3]="Cover (front)",t[t["Cover (back)"]=4]="Cover (back)",t[t["Leaflet page"]=5]="Leaflet page",t[t["Media (e.g. label side of CD)"]=6]="Media (e.g. label side of CD)",t[t["Lead artist/lead performer/soloist"]=7]="Lead artist/lead performer/soloist",t[t["Artist/performer"]=8]="Artist/performer",t[t.Conductor=9]="Conductor",t[t["Band/Orchestra"]=10]="Band/Orchestra",t[t.Composer=11]="Composer",t[t["Lyricist/text writer"]=12]="Lyricist/text writer",t[t["Recording Location"]=13]="Recording Location",t[t["During recording"]=14]="During recording",t[t["During performance"]=15]="During performance",t[t["Movie/video screen capture"]=16]="Movie/video screen capture",t[t["A bright coloured fish"]=17]="A bright coloured fish",t[t.Illustration=18]="Illustration",t[t["Band/artist logotype"]=19]="Band/artist logotype",t[t["Publisher/Studio logotype"]=20]="Publisher/Studio logotype"})(zd||(zd={}));var dE;(function(t){t[t.other=0]="other",t[t.lyrics=1]="lyrics",t[t.text=2]="text",t[t.movement_part=3]="movement_part",t[t.events=4]="events",t[t.chord=5]="chord",t[t.trivia_pop=6]="trivia_pop"})(dE||(dE={}));var hE;(function(t){t[t.notSynchronized0=0]="notSynchronized0",t[t.mpegFrameNumber=1]="mpegFrameNumber",t[t.milliseconds=2]="milliseconds"})(hE||(hE={}));const NN={get:(t,e)=>t[e+3]&127|t[e+2]<<7|t[e+1]<<14|t[e]<<21,len:4},bv={len:10,get:(t,e)=>({fileIdentifier:new me(3,"ascii").get(t,e),version:{major:$d.get(t,e+3),revision:$d.get(t,e+4)},flags:{unsynchronisation:jt(t,e+5,7),isExtendedHeader:jt(t,e+5,6),expIndicator:jt(t,e+5,5),footer:jt(t,e+5,4)},size:NN.get(t,e+6)})},fE={len:10,get:(t,e)=>({size:xe.get(t,e),extendedFlags:et.get(t,e+4),sizeOfPadding:xe.get(t,e+6),crcDataPresent:jt(t,e+4,31)})},AN={len:1,get:(t,e)=>{switch(t[e]){case 0:return{encoding:"latin1"};case 1:return{encoding:"utf-16le",bom:!0};case 2:return{encoding:"utf-16le",bom:!1};case 3:return{encoding:"utf8",bom:!1};default:return{encoding:"utf8",bom:!1}}}},Sv={len:4,get:(t,e)=>({encoding:AN.get(t,e),language:new me(3,"latin1").get(t,e+1)})},mE={len:6,get:(t,e)=>{const n=Sv.get(t,e);return{encoding:n.encoding,language:n.language,timeStampFormat:Pe.get(t,e+4),contentType:Pe.get(t,e+5)}}},hp={year:{multiple:!1},track:{multiple:!1},disk:{multiple:!1},title:{multiple:!1},artist:{multiple:!1},artists:{multiple:!0,unique:!0},albumartist:{multiple:!1},album:{multiple:!1},date:{multiple:!1},originaldate:{multiple:!1},originalyear:{multiple:!1},releasedate:{multiple:!1},comment:{multiple:!0,unique:!1},genre:{multiple:!0,unique:!0},picture:{multiple:!0,unique:!0},composer:{multiple:!0,unique:!0},lyrics:{multiple:!0,unique:!1},albumsort:{multiple:!1,unique:!0},titlesort:{multiple:!1,unique:!0},work:{multiple:!1,unique:!0},artistsort:{multiple:!1,unique:!0},albumartistsort:{multiple:!1,unique:!0},composersort:{multiple:!1,unique:!0},lyricist:{multiple:!0,unique:!0},writer:{multiple:!0,unique:!0},conductor:{multiple:!0,unique:!0},remixer:{multiple:!0,unique:!0},arranger:{multiple:!0,unique:!0},engineer:{multiple:!0,unique:!0},producer:{multiple:!0,unique:!0},technician:{multiple:!0,unique:!0},djmixer:{multiple:!0,unique:!0},mixer:{multiple:!0,unique:!0},label:{multiple:!0,unique:!0},grouping:{multiple:!1},subtitle:{multiple:!0},discsubtitle:{multiple:!1},totaltracks:{multiple:!1},totaldiscs:{multiple:!1},compilation:{multiple:!1},rating:{multiple:!0},bpm:{multiple:!1},mood:{multiple:!1},media:{multiple:!1},catalognumber:{multiple:!0,unique:!0},tvShow:{multiple:!1},tvShowSort:{multiple:!1},tvSeason:{multiple:!1},tvEpisode:{multiple:!1},tvEpisodeId:{multiple:!1},tvNetwork:{multiple:!1},podcast:{multiple:!1},podcasturl:{multiple:!1},releasestatus:{multiple:!1},releasetype:{multiple:!0},releasecountry:{multiple:!1},script:{multiple:!1},language:{multiple:!1},copyright:{multiple:!1},license:{multiple:!1},encodedby:{multiple:!1},encodersettings:{multiple:!1},gapless:{multiple:!1},barcode:{multiple:!1},isrc:{multiple:!0},asin:{multiple:!1},musicbrainz_recordingid:{multiple:!1},musicbrainz_trackid:{multiple:!1},musicbrainz_albumid:{multiple:!1},musicbrainz_artistid:{multiple:!0},musicbrainz_albumartistid:{multiple:!0},musicbrainz_releasegroupid:{multiple:!1},musicbrainz_workid:{multiple:!1},musicbrainz_trmid:{multiple:!1},musicbrainz_discid:{multiple:!1},acoustid_id:{multiple:!1},acoustid_fingerprint:{multiple:!1},musicip_puid:{multiple:!1},musicip_fingerprint:{multiple:!1},website:{multiple:!1},"performer:instrument":{multiple:!0,unique:!0},averageLevel:{multiple:!1},peakLevel:{multiple:!1},notes:{multiple:!0,unique:!1},key:{multiple:!1},originalalbum:{multiple:!1},originalartist:{multiple:!1},discogs_artist_id:{multiple:!0,unique:!0},discogs_release_id:{multiple:!1},discogs_label_id:{multiple:!1},discogs_master_release_id:{multiple:!1},discogs_votes:{multiple:!1},discogs_rating:{multiple:!1},replaygain_track_peak:{multiple:!1},replaygain_track_gain:{multiple:!1},replaygain_album_peak:{multiple:!1},replaygain_album_gain:{multiple:!1},replaygain_track_minmax:{multiple:!1},replaygain_album_minmax:{multiple:!1},replaygain_undo:{multiple:!1},description:{multiple:!0},longDescription:{multiple:!1},category:{multiple:!0},hdVideo:{multiple:!1},keywords:{multiple:!0},movement:{multiple:!1},movementIndex:{multiple:!1},movementTotal:{multiple:!1},podcastId:{multiple:!1},showMovement:{multiple:!1},stik:{multiple:!1}};function kK(t){return hp[t]&&!hp[t].multiple}function TK(t){return!hp[t].multiple||hp[t].unique||!1}class Fr{static toIntOrNull(e){const n=Number.parseInt(e,10);return Number.isNaN(n)?null:n}static normalizeTrack(e){const n=e.toString().split("/");return{no:Number.parseInt(n[0],10)||null,of:Number.parseInt(n[1],10)||null}}constructor(e,n){this.tagTypes=e,this.tagMap=n}mapGenericTag(e,n){e={id:e.id,value:e.value},this.postMap(e,n);const r=this.getCommonName(e.id);return r?{id:r,value:e.value}:null}getCommonName(e){return this.tagMap[e]}postMap(e,n){}}Fr.maxRatingScore=1;const IK={title:"title",artist:"artist",album:"album",year:"year",comment:"comment",track:"track",genre:"genre"};class CK extends Fr{constructor(){super(["ID3v1"],IK)}}class bh extends Fr{constructor(e,n){const r={};for(const s of Object.keys(n))r[s.toUpperCase()]=n[s];super(e,r)}getCommonName(e){return this.tagMap[e.toUpperCase()]}}const RK={TIT2:"title",TPE1:"artist","TXXX:Artists":"artists",TPE2:"albumartist",TALB:"album",TDRV:"date",TORY:"originalyear",TPOS:"disk",TCON:"genre",APIC:"picture",TCOM:"composer",USLT:"lyrics",TSOA:"albumsort",TSOT:"titlesort",TOAL:"originalalbum",TSOP:"artistsort",TSO2:"albumartistsort",TSOC:"composersort",TEXT:"lyricist","TXXX:Writer":"writer",TPE3:"conductor",TPE4:"remixer","IPLS:arranger":"arranger","IPLS:engineer":"engineer","IPLS:producer":"producer","IPLS:DJ-mix":"djmixer","IPLS:mix":"mixer",TPUB:"label",TIT1:"grouping",TIT3:"subtitle",TRCK:"track",TCMP:"compilation",POPM:"rating",TBPM:"bpm",TMED:"media","TXXX:CATALOGNUMBER":"catalognumber","TXXX:MusicBrainz Album Status":"releasestatus","TXXX:MusicBrainz Album Type":"releasetype","TXXX:MusicBrainz Album Release Country":"releasecountry","TXXX:RELEASECOUNTRY":"releasecountry","TXXX:SCRIPT":"script",TLAN:"language",TCOP:"copyright",WCOP:"license",TENC:"encodedby",TSSE:"encodersettings","TXXX:BARCODE":"barcode","TXXX:ISRC":"isrc",TSRC:"isrc","TXXX:ASIN":"asin","TXXX:originalyear":"originalyear","UFID:http://musicbrainz.org":"musicbrainz_recordingid","TXXX:MusicBrainz Release Track Id":"musicbrainz_trackid","TXXX:MusicBrainz Album Id":"musicbrainz_albumid","TXXX:MusicBrainz Artist Id":"musicbrainz_artistid","TXXX:MusicBrainz Album Artist Id":"musicbrainz_albumartistid","TXXX:MusicBrainz Release Group Id":"musicbrainz_releasegroupid","TXXX:MusicBrainz Work Id":"musicbrainz_workid","TXXX:MusicBrainz TRM Id":"musicbrainz_trmid","TXXX:MusicBrainz Disc Id":"musicbrainz_discid","TXXX:ACOUSTID_ID":"acoustid_id","TXXX:Acoustid Id":"acoustid_id","TXXX:Acoustid Fingerprint":"acoustid_fingerprint","TXXX:MusicIP PUID":"musicip_puid","TXXX:MusicMagic Fingerprint":"musicip_fingerprint",WOAR:"website",TDRC:"date",TYER:"year",TDOR:"originaldate","TIPL:arranger":"arranger","TIPL:engineer":"engineer","TIPL:producer":"producer","TIPL:DJ-mix":"djmixer","TIPL:mix":"mixer",TMOO:"mood",SYLT:"lyrics",TSST:"discsubtitle",TKEY:"key",COMM:"comment",TOPE:"originalartist","PRIV:AverageLevel":"averageLevel","PRIV:PeakLevel":"peakLevel","TXXX:DISCOGS_ARTIST_ID":"discogs_artist_id","TXXX:DISCOGS_ARTISTS":"artists","TXXX:DISCOGS_ARTIST_NAME":"artists","TXXX:DISCOGS_ALBUM_ARTISTS":"albumartist","TXXX:DISCOGS_CATALOG":"catalognumber","TXXX:DISCOGS_COUNTRY":"releasecountry","TXXX:DISCOGS_DATE":"originaldate","TXXX:DISCOGS_LABEL":"label","TXXX:DISCOGS_LABEL_ID":"discogs_label_id","TXXX:DISCOGS_MASTER_RELEASE_ID":"discogs_master_release_id","TXXX:DISCOGS_RATING":"discogs_rating","TXXX:DISCOGS_RELEASED":"date","TXXX:DISCOGS_RELEASE_ID":"discogs_release_id","TXXX:DISCOGS_VOTES":"discogs_votes","TXXX:CATALOGID":"catalognumber","TXXX:STYLE":"genre","TXXX:REPLAYGAIN_TRACK_PEAK":"replaygain_track_peak","TXXX:REPLAYGAIN_TRACK_GAIN":"replaygain_track_gain","TXXX:REPLAYGAIN_ALBUM_PEAK":"replaygain_album_peak","TXXX:REPLAYGAIN_ALBUM_GAIN":"replaygain_album_gain","TXXX:MP3GAIN_MINMAX":"replaygain_track_minmax","TXXX:MP3GAIN_ALBUM_MINMAX":"replaygain_album_minmax","TXXX:MP3GAIN_UNDO":"replaygain_undo",MVNM:"movement",MVIN:"movementIndex",PCST:"podcast",TCAT:"category",TDES:"description",TDRL:"releasedate",TGID:"podcastId",TKWD:"keywords",WFED:"podcasturl",GRP1:"grouping"};class v_ extends bh{static toRating(e){return{source:e.email,rating:e.rating>0?(e.rating-1)/254*Fr.maxRatingScore:void 0}}constructor(){super(["ID3v2.3","ID3v2.4"],RK)}postMap(e,n){switch(e.id){case"UFID":{const r=e.value;r.owner_identifier==="http://musicbrainz.org"&&(e.id+=`:${r.owner_identifier}`,e.value=Xt(r.identifier,"latin1"))}break;case"PRIV":{const r=e.value;switch(r.owner_identifier){case"AverageLevel":case"PeakValue":e.id+=`:${r.owner_identifier}`,e.value=r.data.length===4?le.get(r.data,0):null,e.value===null&&n.addWarning("Failed to parse PRIV:PeakValue");break;default:n.addWarning(`Unknown PRIV owner-identifier: ${r.data}`)}}break;case"POPM":e.value=v_.toRating(e.value);break}}}const NK={Title:"title",Author:"artist","WM/AlbumArtist":"albumartist","WM/AlbumTitle":"album","WM/Year":"date","WM/OriginalReleaseTime":"originaldate","WM/OriginalReleaseYear":"originalyear",Description:"comment","WM/TrackNumber":"track","WM/PartOfSet":"disk","WM/Genre":"genre","WM/Composer":"composer","WM/Lyrics":"lyrics","WM/AlbumSortOrder":"albumsort","WM/TitleSortOrder":"titlesort","WM/ArtistSortOrder":"artistsort","WM/AlbumArtistSortOrder":"albumartistsort","WM/ComposerSortOrder":"composersort","WM/Writer":"lyricist","WM/Conductor":"conductor","WM/ModifiedBy":"remixer","WM/Engineer":"engineer","WM/Producer":"producer","WM/DJMixer":"djmixer","WM/Mixer":"mixer","WM/Publisher":"label","WM/ContentGroupDescription":"grouping","WM/SubTitle":"subtitle","WM/SetSubTitle":"discsubtitle","WM/IsCompilation":"compilation","WM/SharedUserRating":"rating","WM/BeatsPerMinute":"bpm","WM/Mood":"mood","WM/Media":"media","WM/CatalogNo":"catalognumber","MusicBrainz/Album Status":"releasestatus","MusicBrainz/Album Type":"releasetype","MusicBrainz/Album Release Country":"releasecountry","WM/Script":"script","WM/Language":"language",Copyright:"copyright",LICENSE:"license","WM/EncodedBy":"encodedby","WM/EncodingSettings":"encodersettings","WM/Barcode":"barcode","WM/ISRC":"isrc","MusicBrainz/Track Id":"musicbrainz_recordingid","MusicBrainz/Release Track Id":"musicbrainz_trackid","MusicBrainz/Album Id":"musicbrainz_albumid","MusicBrainz/Artist Id":"musicbrainz_artistid","MusicBrainz/Album Artist Id":"musicbrainz_albumartistid","MusicBrainz/Release Group Id":"musicbrainz_releasegroupid","MusicBrainz/Work Id":"musicbrainz_workid","MusicBrainz/TRM Id":"musicbrainz_trmid","MusicBrainz/Disc Id":"musicbrainz_discid","Acoustid/Id":"acoustid_id","Acoustid/Fingerprint":"acoustid_fingerprint","MusicIP/PUID":"musicip_puid","WM/ARTISTS":"artists","WM/InitialKey":"key",ASIN:"asin","WM/Work":"work","WM/AuthorURL":"website","WM/Picture":"picture"};class w_ extends Fr{static toRating(e){return{rating:Number.parseFloat(e+1)/5}}constructor(){super(["asf"],NK)}postMap(e){switch(e.id){case"WM/SharedUserRating":{const n=e.id.split(":");e.value=w_.toRating(e.value),e.id=n[0];break}}}}const AK={TT2:"title",TP1:"artist",TP2:"albumartist",TAL:"album",TYE:"year",COM:"comment",TRK:"track",TPA:"disk",TCO:"genre",PIC:"picture",TCM:"composer",TOR:"originaldate",TOT:"originalalbum",TXT:"lyricist",TP3:"conductor",TPB:"label",TT1:"grouping",TT3:"subtitle",TLA:"language",TCR:"copyright",WCP:"license",TEN:"encodedby",TSS:"encodersettings",WAR:"website",PCS:"podcast",TCP:"compilation",TDR:"date",TS2:"albumartistsort",TSA:"albumsort",TSC:"composersort",TSP:"artistsort",TST:"titlesort",WFD:"podcasturl",TBP:"bpm"};class PK extends bh{constructor(){super(["ID3v2.2"],AK)}}const FK={Title:"title",Artist:"artist",Artists:"artists","Album Artist":"albumartist",Album:"album",Year:"date",Originalyear:"originalyear",Originaldate:"originaldate",Releasedate:"releasedate",Comment:"comment",Track:"track",Disc:"disk",DISCNUMBER:"disk",Genre:"genre","Cover Art (Front)":"picture","Cover Art (Back)":"picture",Composer:"composer",Lyrics:"lyrics",ALBUMSORT:"albumsort",TITLESORT:"titlesort",WORK:"work",ARTISTSORT:"artistsort",ALBUMARTISTSORT:"albumartistsort",COMPOSERSORT:"composersort",Lyricist:"lyricist",Writer:"writer",Conductor:"conductor",MixArtist:"remixer",Arranger:"arranger",Engineer:"engineer",Producer:"producer",DJMixer:"djmixer",Mixer:"mixer",Label:"label",Grouping:"grouping",Subtitle:"subtitle",DiscSubtitle:"discsubtitle",Compilation:"compilation",BPM:"bpm",Mood:"mood",Media:"media",CatalogNumber:"catalognumber",MUSICBRAINZ_ALBUMSTATUS:"releasestatus",MUSICBRAINZ_ALBUMTYPE:"releasetype",RELEASECOUNTRY:"releasecountry",Script:"script",Language:"language",Copyright:"copyright",LICENSE:"license",EncodedBy:"encodedby",EncoderSettings:"encodersettings",Barcode:"barcode",ISRC:"isrc",ASIN:"asin",musicbrainz_trackid:"musicbrainz_recordingid",musicbrainz_releasetrackid:"musicbrainz_trackid",MUSICBRAINZ_ALBUMID:"musicbrainz_albumid",MUSICBRAINZ_ARTISTID:"musicbrainz_artistid",MUSICBRAINZ_ALBUMARTISTID:"musicbrainz_albumartistid",MUSICBRAINZ_RELEASEGROUPID:"musicbrainz_releasegroupid",MUSICBRAINZ_WORKID:"musicbrainz_workid",MUSICBRAINZ_TRMID:"musicbrainz_trmid",MUSICBRAINZ_DISCID:"musicbrainz_discid",Acoustid_Id:"acoustid_id",ACOUSTID_FINGERPRINT:"acoustid_fingerprint",MUSICIP_PUID:"musicip_puid",Weblink:"website",REPLAYGAIN_TRACK_GAIN:"replaygain_track_gain",REPLAYGAIN_TRACK_PEAK:"replaygain_track_peak",MP3GAIN_MINMAX:"replaygain_track_minmax",MP3GAIN_UNDO:"replaygain_undo"};class MK extends bh{constructor(){super(["APEv2"],FK)}}const DK={"©nam":"title","©ART":"artist",aART:"albumartist","----:com.apple.iTunes:Band":"albumartist","©alb":"album","©day":"date","©cmt":"comment","©com":"comment",trkn:"track",disk:"disk","©gen":"genre",covr:"picture","©wrt":"composer","©lyr":"lyrics",soal:"albumsort",sonm:"titlesort",soar:"artistsort",soaa:"albumartistsort",soco:"composersort","----:com.apple.iTunes:LYRICIST":"lyricist","----:com.apple.iTunes:CONDUCTOR":"conductor","----:com.apple.iTunes:REMIXER":"remixer","----:com.apple.iTunes:ENGINEER":"engineer","----:com.apple.iTunes:PRODUCER":"producer","----:com.apple.iTunes:DJMIXER":"djmixer","----:com.apple.iTunes:MIXER":"mixer","----:com.apple.iTunes:LABEL":"label","©grp":"grouping","----:com.apple.iTunes:SUBTITLE":"subtitle","----:com.apple.iTunes:DISCSUBTITLE":"discsubtitle",cpil:"compilation",tmpo:"bpm","----:com.apple.iTunes:MOOD":"mood","----:com.apple.iTunes:MEDIA":"media","----:com.apple.iTunes:CATALOGNUMBER":"catalognumber",tvsh:"tvShow",tvsn:"tvSeason",tves:"tvEpisode",sosn:"tvShowSort",tven:"tvEpisodeId",tvnn:"tvNetwork",pcst:"podcast",purl:"podcasturl","----:com.apple.iTunes:MusicBrainz Album Status":"releasestatus","----:com.apple.iTunes:MusicBrainz Album Type":"releasetype","----:com.apple.iTunes:MusicBrainz Album Release Country":"releasecountry","----:com.apple.iTunes:SCRIPT":"script","----:com.apple.iTunes:LANGUAGE":"language",cprt:"copyright","©cpy":"copyright","----:com.apple.iTunes:LICENSE":"license","©too":"encodedby",pgap:"gapless","----:com.apple.iTunes:BARCODE":"barcode","----:com.apple.iTunes:ISRC":"isrc","----:com.apple.iTunes:ASIN":"asin","----:com.apple.iTunes:NOTES":"comment","----:com.apple.iTunes:MusicBrainz Track Id":"musicbrainz_recordingid","----:com.apple.iTunes:MusicBrainz Release Track Id":"musicbrainz_trackid","----:com.apple.iTunes:MusicBrainz Album Id":"musicbrainz_albumid","----:com.apple.iTunes:MusicBrainz Artist Id":"musicbrainz_artistid","----:com.apple.iTunes:MusicBrainz Album Artist Id":"musicbrainz_albumartistid","----:com.apple.iTunes:MusicBrainz Release Group Id":"musicbrainz_releasegroupid","----:com.apple.iTunes:MusicBrainz Work Id":"musicbrainz_workid","----:com.apple.iTunes:MusicBrainz TRM Id":"musicbrainz_trmid","----:com.apple.iTunes:MusicBrainz Disc Id":"musicbrainz_discid","----:com.apple.iTunes:Acoustid Id":"acoustid_id","----:com.apple.iTunes:Acoustid Fingerprint":"acoustid_fingerprint","----:com.apple.iTunes:MusicIP PUID":"musicip_puid","----:com.apple.iTunes:fingerprint":"musicip_fingerprint","----:com.apple.iTunes:replaygain_track_gain":"replaygain_track_gain","----:com.apple.iTunes:replaygain_track_peak":"replaygain_track_peak","----:com.apple.iTunes:replaygain_album_gain":"replaygain_album_gain","----:com.apple.iTunes:replaygain_album_peak":"replaygain_album_peak","----:com.apple.iTunes:replaygain_track_minmax":"replaygain_track_minmax","----:com.apple.iTunes:replaygain_album_minmax":"replaygain_album_minmax","----:com.apple.iTunes:replaygain_undo":"replaygain_undo",gnre:"genre","----:com.apple.iTunes:ALBUMARTISTSORT":"albumartistsort","----:com.apple.iTunes:ARTISTS":"artists","----:com.apple.iTunes:ORIGINALDATE":"originaldate","----:com.apple.iTunes:ORIGINALYEAR":"originalyear","----:com.apple.iTunes:RELEASEDATE":"releasedate",desc:"description",ldes:"longDescription","©mvn":"movement","©mvi":"movementIndex","©mvc":"movementTotal","©wrk":"work",catg:"category",egid:"podcastId",hdvd:"hdVideo",keyw:"keywords",shwm:"showMovement",stik:"stik",rate:"rating"},LK="iTunes";class pE extends bh{constructor(){super([LK],DK)}postMap(e,n){switch(e.id){case"rate":e.value={source:void 0,rating:Number.parseFloat(e.value)/100};break}}}const OK={TITLE:"title",ARTIST:"artist",ARTISTS:"artists",ALBUMARTIST:"albumartist","ALBUM ARTIST":"albumartist",ALBUM:"album",DATE:"date",ORIGINALDATE:"originaldate",ORIGINALYEAR:"originalyear",RELEASEDATE:"releasedate",COMMENT:"comment",TRACKNUMBER:"track",DISCNUMBER:"disk",GENRE:"genre",METADATA_BLOCK_PICTURE:"picture",COMPOSER:"composer",LYRICS:"lyrics",ALBUMSORT:"albumsort",TITLESORT:"titlesort",WORK:"work",ARTISTSORT:"artistsort",ALBUMARTISTSORT:"albumartistsort",COMPOSERSORT:"composersort",LYRICIST:"lyricist",WRITER:"writer",CONDUCTOR:"conductor",REMIXER:"remixer",ARRANGER:"arranger",ENGINEER:"engineer",PRODUCER:"producer",DJMIXER:"djmixer",MIXER:"mixer",LABEL:"label",GROUPING:"grouping",SUBTITLE:"subtitle",DISCSUBTITLE:"discsubtitle",TRACKTOTAL:"totaltracks",DISCTOTAL:"totaldiscs",COMPILATION:"compilation",RATING:"rating",BPM:"bpm",KEY:"key",MOOD:"mood",MEDIA:"media",CATALOGNUMBER:"catalognumber",RELEASESTATUS:"releasestatus",RELEASETYPE:"releasetype",RELEASECOUNTRY:"releasecountry",SCRIPT:"script",LANGUAGE:"language",COPYRIGHT:"copyright",LICENSE:"license",ENCODEDBY:"encodedby",ENCODERSETTINGS:"encodersettings",BARCODE:"barcode",ISRC:"isrc",ASIN:"asin",MUSICBRAINZ_TRACKID:"musicbrainz_recordingid",MUSICBRAINZ_RELEASETRACKID:"musicbrainz_trackid",MUSICBRAINZ_ALBUMID:"musicbrainz_albumid",MUSICBRAINZ_ARTISTID:"musicbrainz_artistid",MUSICBRAINZ_ALBUMARTISTID:"musicbrainz_albumartistid",MUSICBRAINZ_RELEASEGROUPID:"musicbrainz_releasegroupid",MUSICBRAINZ_WORKID:"musicbrainz_workid",MUSICBRAINZ_TRMID:"musicbrainz_trmid",MUSICBRAINZ_DISCID:"musicbrainz_discid",ACOUSTID_ID:"acoustid_id",ACOUSTID_ID_FINGERPRINT:"acoustid_fingerprint",MUSICIP_PUID:"musicip_puid",WEBSITE:"website",NOTES:"notes",TOTALTRACKS:"totaltracks",TOTALDISCS:"totaldiscs",DISCOGS_ARTIST_ID:"discogs_artist_id",DISCOGS_ARTISTS:"artists",DISCOGS_ARTIST_NAME:"artists",DISCOGS_ALBUM_ARTISTS:"albumartist",DISCOGS_CATALOG:"catalognumber",DISCOGS_COUNTRY:"releasecountry",DISCOGS_DATE:"originaldate",DISCOGS_LABEL:"label",DISCOGS_LABEL_ID:"discogs_label_id",DISCOGS_MASTER_RELEASE_ID:"discogs_master_release_id",DISCOGS_RATING:"discogs_rating",DISCOGS_RELEASED:"date",DISCOGS_RELEASE_ID:"discogs_release_id",DISCOGS_VOTES:"discogs_votes",CATALOGID:"catalognumber",STYLE:"genre",REPLAYGAIN_TRACK_GAIN:"replaygain_track_gain",REPLAYGAIN_TRACK_PEAK:"replaygain_track_peak",REPLAYGAIN_ALBUM_GAIN:"replaygain_album_gain",REPLAYGAIN_ALBUM_PEAK:"replaygain_album_peak",REPLAYGAIN_MINMAX:"replaygain_track_minmax",REPLAYGAIN_ALBUM_MINMAX:"replaygain_album_minmax",REPLAYGAIN_UNDO:"replaygain_undo"};class fp extends Fr{static toRating(e,n,r){return{source:e?e.toLowerCase():void 0,rating:Number.parseFloat(n)/r*Fr.maxRatingScore}}constructor(){super(["vorbis"],OK)}postMap(e){if(e.id==="RATING")e.value=fp.toRating(void 0,e.value,100);else if(e.id.indexOf("RATING:")===0){const n=e.id.split(":");e.value=fp.toRating(n[1],e.value,1),e.id=n[0]}}}const $K={IART:"artist",ICRD:"date",INAM:"title",TITL:"title",IPRD:"album",ITRK:"track",IPRT:"track",COMM:"comment",ICMT:"comment",ICNT:"releasecountry",GNRE:"genre",IWRI:"writer",RATE:"rating",YEAR:"year",ISFT:"encodedby",CODE:"encodedby",TURL:"website",IGNR:"genre",IENG:"engineer",ITCH:"technician",IMED:"media",IRPD:"album"};class zK extends Fr{constructor(){super(["exif"],$K)}}const BK={"segment:title":"title","album:ARTIST":"albumartist","album:ARTISTSORT":"albumartistsort","album:TITLE":"album","album:DATE_RECORDED":"originaldate","album:DATE_RELEASED":"releasedate","album:PART_NUMBER":"disk","album:TOTAL_PARTS":"totaltracks","track:ARTIST":"artist","track:ARTISTSORT":"artistsort","track:TITLE":"title","track:PART_NUMBER":"track","track:MUSICBRAINZ_TRACKID":"musicbrainz_recordingid","track:MUSICBRAINZ_ALBUMID":"musicbrainz_albumid","track:MUSICBRAINZ_ARTISTID":"musicbrainz_artistid","track:PUBLISHER":"label","track:GENRE":"genre","track:ENCODER":"encodedby","track:ENCODER_OPTIONS":"encodersettings","edition:TOTAL_PARTS":"totaldiscs",picture:"picture"};class VK extends bh{constructor(){super(["matroska"],BK)}}const UK={NAME:"title",AUTH:"artist","(c) ":"copyright",ANNO:"comment"};class HK extends Fr{constructor(){super(["AIFF"],UK)}}class GK{constructor(){this.tagMappers={},[new CK,new PK,new v_,new pE,new pE,new fp,new MK,new w_,new zK,new VK,new HK].forEach(e=>{this.registerTagMapper(e)})}mapTag(e,n,r){if(this.tagMappers[e])return this.tagMappers[e].mapGenericTag(n,r);throw new Error(`No generic tag mapper defined for tag-format: ${e}`)}registerTagMapper(e){for(const n of e.tagTypes)this.tagMappers[n]=e}}const wo=st("music-metadata:collector"),WK=["matroska","APEv2","vorbis","ID3v2.4","ID3v2.3","ID3v2.2","exif","asf","iTunes","AIFF","ID3v1"];class qK{constructor(e){this.opts=e,this.format={tagTypes:[],trackInfo:[]},this.native={},this.common={track:{no:null,of:null},disk:{no:null,of:null},movementIndex:{no:null,of:null}},this.quality={warnings:[]},this.commonOrigin={},this.originPriority={},this.tagMapper=new GK;let n=1;for(const r of WK)this.originPriority[r]=n++;this.originPriority.artificial=500,this.originPriority.id3v1=600}hasAny(){return Object.keys(this.native).length>0}addStreamInfo(e){wo(`streamInfo: type=${e.type?el[e.type]:"?"}, codec=${e.codecName}`),this.format.trackInfo.push(e)}setFormat(e,n){var r;wo(`format: ${e} = ${n}`),this.format[e]=n,(r=this.opts)!=null&&r.observer&&this.opts.observer({metadata:this,tag:{type:"format",id:e,value:n}})}async addTag(e,n,r){wo(`tag ${e}.${n} = ${r}`),this.native[e]||(this.format.tagTypes.push(e),this.native[e]=[]),this.native[e].push({id:n,value:r}),await this.toCommon(e,n,r)}addWarning(e){this.quality.warnings.push({message:e})}async postMap(e,n){switch(n.id){case"artist":if(this.commonOrigin.artist===this.originPriority[e])return this.postMap("artificial",{id:"artists",value:n.value});this.common.artists||this.setGenericTag("artificial",{id:"artists",value:n.value});break;case"artists":if((!this.common.artist||this.commonOrigin.artist===this.originPriority.artificial)&&(!this.common.artists||this.common.artists.indexOf(n.value)===-1)){const r=(this.common.artists||[]).concat([n.value]),i={id:"artist",value:KK(r)};this.setGenericTag("artificial",i)}break;case"picture":return this.postFixPicture(n.value).then(r=>{r!==null&&(n.value=r,this.setGenericTag(e,n))});case"totaltracks":this.common.track.of=Fr.toIntOrNull(n.value);return;case"totaldiscs":this.common.disk.of=Fr.toIntOrNull(n.value);return;case"movementTotal":this.common.movementIndex.of=Fr.toIntOrNull(n.value);return;case"track":case"disk":case"movementIndex":{const r=this.common[n.id].of;this.common[n.id]=Fr.normalizeTrack(n.value),this.common[n.id].of=r??this.common[n.id].of;return}case"bpm":case"year":case"originalyear":n.value=Number.parseInt(n.value,10);break;case"date":{const r=Number.parseInt(n.value.substr(0,4),10);Number.isNaN(r)||(this.common.year=r);break}case"discogs_label_id":case"discogs_release_id":case"discogs_master_release_id":case"discogs_artist_id":case"discogs_votes":n.value=typeof n.value=="string"?Number.parseInt(n.value,10):n.value;break;case"replaygain_track_gain":case"replaygain_track_peak":case"replaygain_album_gain":case"replaygain_album_peak":n.value=jK(n.value);break;case"replaygain_track_minmax":n.value=n.value.split(",").map(r=>Number.parseInt(r,10));break;case"replaygain_undo":{const r=n.value.split(",").map(s=>Number.parseInt(s,10));n.value={leftChannel:r[0],rightChannel:r[1]};break}case"gapless":case"compilation":case"podcast":case"showMovement":n.value=n.value==="1"||n.value===1;break;case"isrc":{const r=this.common[n.id];if(r&&r.indexOf(n.value)!==-1)return;break}case"comment":typeof n.value=="string"&&(n.value={text:n.value}),n.value.descriptor==="iTunPGAP"&&this.setGenericTag(e,{id:"gapless",value:n.value.text==="1"});break}n.value!==null&&this.setGenericTag(e,n)}toCommonMetadata(){return{format:this.format,native:this.native,quality:this.quality,common:this.common}}async postFixPicture(e){if(e.data&&e.data.length>0){if(!e.format){const n=await TN(Uint8Array.from(e.data));if(n)e.format=n.mime;else return null}switch(e.format=e.format.toLocaleLowerCase(),e.format){case"image/jpg":e.format="image/jpeg"}return e}return this.addWarning("Empty picture tag found"),null}async toCommon(e,n,r){const s={id:n,value:r},i=this.tagMapper.mapTag(e,s,this);i&&await this.postMap(e,i)}setGenericTag(e,n){var i;wo(`common.${n.id} = ${n.value}`);const r=this.commonOrigin[n.id]||1e3,s=this.originPriority[e];if(kK(n.id))if(s<=r)this.common[n.id]=n.value,this.commonOrigin[n.id]=s;else return wo(`Ignore native tag (singleton): ${e}.${n.id} = ${n.value}`);else if(s===r)!TK(n.id)||this.common[n.id].indexOf(n.value)===-1?this.common[n.id].push(n.value):wo(`Ignore duplicate value: ${e}.${n.id} = ${n.value}`);else if(s<r)this.common[n.id]=[n.value],this.commonOrigin[n.id]=s;else return wo(`Ignore native tag (list): ${e}.${n.id} = ${n.value}`);(i=this.opts)!=null&&i.observer&&this.opts.observer({metadata:this,tag:{type:"common",id:n.id,value:n.value}})}}function KK(t){return t.length>2?`${t.slice(0,t.length-1).join(", ")} & ${t[t.length-1]}`:t.join(" & ")}class Hr{constructor(){this.metadata=void 0,this.tokenizer=void 0,this.options=void 0}init(e,n,r){return this.metadata=e,this.tokenizer=n,this.options=r,this}}const QK=/^[\x21-\x7e©][\x20-\x7e\x00()]{3}/,ft={len:4,get:(t,e)=>{const n=g_(t.slice(e,e+ft.len),"latin1");if(!n.match(QK))throw new Error(`FourCC contains invalid characters: ${bK(n)} "${n}"`);return n},put:(t,e,n)=>{const r=Xq(n);if(r.length!==4)throw new Error("Invalid length");return t.set(r,e),e+4}};var Yl;(function(t){t[t.text_utf8=0]="text_utf8",t[t.binary=1]="binary",t[t.external_info=2]="external_info",t[t.reserved=3]="reserved"})(Yl||(Yl={}));const gE={len:52,get:(t,e)=>({ID:ft.get(t,e),version:le.get(t,e+4)/1e3,descriptorBytes:le.get(t,e+8),headerBytes:le.get(t,e+12),seekTableBytes:le.get(t,e+16),headerDataBytes:le.get(t,e+20),apeFrameDataBytes:le.get(t,e+24),apeFrameDataBytesHigh:le.get(t,e+28),terminatingDataBytes:le.get(t,e+32),fileMD5:new ur(16).get(t,e+36)})},XK={len:24,get:(t,e)=>({compressionLevel:Ke.get(t,e),formatFlags:Ke.get(t,e+2),blocksPerFrame:le.get(t,e+4),finalFrameBlocks:le.get(t,e+8),totalFrames:le.get(t,e+12),bitsPerSample:Ke.get(t,e+16),channel:Ke.get(t,e+18),sampleRate:le.get(t,e+20)})},Qr={len:32,get:(t,e)=>({ID:new me(8,"ascii").get(t,e),version:le.get(t,e+8),size:le.get(t,e+12),fields:le.get(t,e+16),flags:PN(le.get(t,e+20))})},vx={len:8,get:(t,e)=>({size:le.get(t,e),flags:PN(le.get(t,e+4))})};function PN(t){return{containsHeader:Cf(t,31),containsFooter:Cf(t,30),isHeader:Cf(t,29),readOnly:Cf(t,0),dataType:(t&6)>>1}}function Cf(t,e){return(t&1<<e)!==0}const _o=st("music-metadata:parser:APEv2"),xE="APEv2",yE="APETAGEX";class Ys extends Hr{constructor(){super(...arguments),this.ape={}}static tryParseApeHeader(e,n,r){const s=new Ys;return s.init(e,n,r),s.tryParseApeHeader()}static calculateDuration(e){let n=e.totalFrames>1?e.blocksPerFrame*(e.totalFrames-1):0;return n+=e.finalFrameBlocks,n/e.sampleRate}static async findApeFooterOffset(e,n){const r=new Uint8Array(Qr.len);await e.randomRead(r,0,Qr.len,n-Qr.len);const s=Qr.get(r,0);if(s.ID==="APETAGEX")return s.flags.isHeader?_o(`APE Header found at offset=${n-Qr.len}`):(_o(`APE Footer found at offset=${n-Qr.len}`),n-=s.size),{footer:s,offset:n}}static parseTagFooter(e,n,r){const s=Qr.get(n,n.length-Qr.len);if(s.ID!==yE)throw new Error("Unexpected APEv2 Footer ID preamble value.");Fc(n);const i=new Ys;return i.init(e,Fc(n),r),i.parseTags(s)}async tryParseApeHeader(){if(this.tokenizer.fileInfo.size&&this.tokenizer.fileInfo.size-this.tokenizer.position<Qr.len){_o("No APEv2 header found, end-of-file reached");return}const e=await this.tokenizer.peekToken(Qr);if(e.ID===yE)return await this.tokenizer.ignore(Qr.len),this.parseTags(e);if(_o(`APEv2 header not found at offset=${this.tokenizer.position}`),this.tokenizer.fileInfo.size){const n=this.tokenizer.fileInfo.size-this.tokenizer.position,r=new Uint8Array(n);return await this.tokenizer.readBuffer(r),Ys.parseTagFooter(this.metadata,r,this.options)}}async parse(){const e=await this.tokenizer.readToken(gE);if(e.ID!=="MAC ")throw new Error("Unexpected descriptor ID");this.ape.descriptor=e;const n=e.descriptorBytes-gE.len,r=await(n>0?this.parseDescriptorExpansion(n):this.parseHeader());return await this.tokenizer.ignore(r.forwardBytes),this.tryParseApeHeader()}async parseTags(e){const n=new Uint8Array(256);let r=e.size-Qr.len;_o(`Parse APE tags at offset=${this.tokenizer.position}, size=${r}`);for(let s=0;s<e.fields;s++){if(r<vx.len){this.metadata.addWarning(`APEv2 Tag-header: ${e.fields-s} items remaining, but no more tag data to read.`);break}const i=await this.tokenizer.readToken(vx);r-=vx.len+i.size,await this.tokenizer.peekBuffer(n,{length:Math.min(n.length,r)});let o=kr(n,0,n.length);const l=await this.tokenizer.readToken(new me(o,"ascii"));switch(await this.tokenizer.ignore(1),r-=l.length+1,i.flags.dataType){case Yl.text_utf8:{const u=(await this.tokenizer.readToken(new me(i.size,"utf8"))).split(/\x00/g);await Promise.all(u.map(d=>this.metadata.addTag(xE,l,d)));break}case Yl.binary:if(this.options.skipCovers)await this.tokenizer.ignore(i.size);else{const c=new Uint8Array(i.size);await this.tokenizer.readBuffer(c),o=kr(c,0,c.length);const u=g_(c.slice(0,o)),d=c.slice(o+1);await this.metadata.addTag(xE,l,{description:u,data:d})}break;case Yl.external_info:_o(`Ignore external info ${l}`),await this.tokenizer.ignore(i.size);break;case Yl.reserved:_o(`Ignore external info ${l}`),this.metadata.addWarning(`APEv2 header declares a reserved datatype for "${l}"`),await this.tokenizer.ignore(i.size);break}}}async parseDescriptorExpansion(e){return await this.tokenizer.ignore(e),this.parseHeader()}async parseHeader(){const e=await this.tokenizer.readToken(XK);if(this.metadata.setFormat("lossless",!0),this.metadata.setFormat("container","Monkey's Audio"),this.metadata.setFormat("bitsPerSample",e.bitsPerSample),this.metadata.setFormat("sampleRate",e.sampleRate),this.metadata.setFormat("numberOfChannels",e.channel),this.metadata.setFormat("duration",Ys.calculateDuration(e)),!this.ape.descriptor)throw new Error("Missing APE descriptor");return{forwardBytes:this.ape.descriptor.seekTableBytes+this.ape.descriptor.headerDataBytes+this.ape.descriptor.apeFrameDataBytes+this.ape.descriptor.terminatingDataBytes}}}const Rf=st("music-metadata:parser:ID3v1"),mp=["Blues","Classic Rock","Country","Dance","Disco","Funk","Grunge","Hip-Hop","Jazz","Metal","New Age","Oldies","Other","Pop","R&B","Rap","Reggae","Rock","Techno","Industrial","Alternative","Ska","Death Metal","Pranks","Soundtrack","Euro-Techno","Ambient","Trip-Hop","Vocal","Jazz+Funk","Fusion","Trance","Classical","Instrumental","Acid","House","Game","Sound Clip","Gospel","Noise","Alt. Rock","Bass","Soul","Punk","Space","Meditative","Instrumental Pop","Instrumental Rock","Ethnic","Gothic","Darkwave","Techno-Industrial","Electronic","Pop-Folk","Eurodance","Dream","Southern Rock","Comedy","Cult","Gangsta Rap","Top 40","Christian Rap","Pop/Funk","Jungle","Native American","Cabaret","New Wave","Psychedelic","Rave","Showtunes","Trailer","Lo-Fi","Tribal","Acid Punk","Acid Jazz","Polka","Retro","Musical","Rock & Roll","Hard Rock","Folk","Folk/Rock","National Folk","Swing","Fast-Fusion","Bebob","Latin","Revival","Celtic","Bluegrass","Avantgarde","Gothic Rock","Progressive Rock","Psychedelic Rock","Symphonic Rock","Slow Rock","Big Band","Chorus","Easy Listening","Acoustic","Humour","Speech","Chanson","Opera","Chamber Music","Sonata","Symphony","Booty Bass","Primus","Porn Groove","Satire","Slow Jam","Club","Tango","Samba","Folklore","Ballad","Power Ballad","Rhythmic Soul","Freestyle","Duet","Punk Rock","Drum Solo","A Cappella","Euro-House","Dance Hall","Goa","Drum & Bass","Club-House","Hardcore","Terror","Indie","BritPop","Negerpunk","Polsk Punk","Beat","Christian Gangsta Rap","Heavy Metal","Black Metal","Crossover","Contemporary Christian","Christian Rock","Merengue","Salsa","Thrash Metal","Anime","JPop","Synthpop","Abstract","Art Rock","Baroque","Bhangra","Big Beat","Breakbeat","Chillout","Downtempo","Dub","EBM","Eclectic","Electro","Electroclash","Emo","Experimental","Garage","Global","IDM","Illbient","Industro-Goth","Jam Band","Krautrock","Leftfield","Lounge","Math Rock","New Romantic","Nu-Breakz","Post-Punk","Post-Rock","Psytrance","Shoegaze","Space Rock","Trop Rock","World Music","Neoclassical","Audiobook","Audio Theatre","Neue Deutsche Welle","Podcast","Indie Rock","G-Funk","Dubstep","Garage Rock","Psybient"],Nf={len:128,get:(t,e)=>{const n=new Rl(3).get(t,e);return n==="TAG"?{header:n,title:new Rl(30).get(t,e+3),artist:new Rl(30).get(t,e+33),album:new Rl(30).get(t,e+63),year:new Rl(4).get(t,e+93),comment:new Rl(28).get(t,e+97),zeroByte:Pe.get(t,e+127),track:Pe.get(t,e+126),genre:Pe.get(t,e+127)}:null}};class Rl{constructor(e){this.len=e,this.stringType=new me(e,"latin1")}get(e,n){let r=this.stringType.get(e,n);return r=RN(r),r=r.trim(),r.length>0?r:void 0}}class __ extends Hr{static getGenre(e){if(e<mp.length)return mp[e]}async parse(){if(!this.tokenizer.fileInfo.size){Rf("Skip checking for ID3v1 because the file-size is unknown");return}if(this.options.apeHeader){this.tokenizer.ignore(this.options.apeHeader.offset-this.tokenizer.position);const r=new Ys;r.init(this.metadata,this.tokenizer,this.options),await r.parseTags(this.options.apeHeader.footer)}const e=this.tokenizer.fileInfo.size-Nf.len;if(this.tokenizer.position>e){Rf("Already consumed the last 128 bytes");return}const n=await this.tokenizer.readToken(Nf,e);if(n){Rf("ID3v1 header found at: pos=%s",this.tokenizer.fileInfo.size-Nf.len);const r=["title","artist","album","comment","track","year"];for(const i of r)n[i]&&n[i]!==""&&await this.addTag(i,n[i]);const s=__.getGenre(n.genre);s&&await this.addTag("genre",s)}else Rf("ID3v1 header not found at: pos=%s",this.tokenizer.fileInfo.size-Nf.len)}async addTag(e,n){await this.metadata.addTag("ID3v1",e,n)}}const vE=st("music-metadata:id3v2:frame-parser"),ws="latin1";function YK(t){const e=[];let n,r="";for(const s of t)if(typeof n=="string")if(s==="("&&n==="")r+="(",n=void 0;else if(s===")"){r!==""&&(e.push(r),r="");const i=wE(n);i&&e.push(i),n=void 0}else n+=s;else s==="("?n="":r+=s;return r&&(e.length===0&&r.match(/^\d*$/)&&(r=wE(r)),r&&e.push(r)),e}function wE(t){if(t==="RX")return"Remix";if(t==="CR")return"Cover";if(t.match(/^\d*$/))return mp[Number.parseInt(t)]}class Tr{constructor(e,n){this.major=e,this.warningCollector=n}readData(e,n,r){if(e.length===0){this.warningCollector.addWarning(`id3v2.${this.major} header has empty tag type=${n}`);return}const{encoding:s,bom:i}=AN.get(e,0),o=e.length;let l=0,c=[];const u=Tr.getNullTerminatorLength(s);let d;switch(vE(`Parsing tag type=${n}, encoding=${s}, bom=${i}`),n!=="TXXX"&&n[0]==="T"?"T*":n){case"T*":case"GRP1":case"IPLS":case"MVIN":case"MVNM":case"PCS":case"PCST":{let f;try{f=Xt(e.slice(1),s).replace(/\x00+$/,"")}catch(p){if(p instanceof Error){this.warningCollector.addWarning(`id3v2.${this.major} type=${n} header has invalid string value: ${p.message}`);break}throw p}switch(n){case"TMCL":case"TIPL":case"IPLS":c=Tr.functionList(this.splitValue(n,f));break;case"TRK":case"TRCK":case"TPOS":c=f;break;case"TCOM":case"TEXT":case"TOLY":case"TOPE":case"TPE1":case"TSRC":c=this.splitValue(n,f);break;case"TCO":case"TCON":c=this.splitValue(n,f).map(p=>YK(p)).reduce((p,g)=>p.concat(g),[]);break;case"PCS":case"PCST":c=this.major>=4?this.splitValue(n,f):[f],c=Array.isArray(c)&&c[0]===""?1:0;break;default:c=this.major>=4?this.splitValue(n,f):[f]}break}case"TXXX":{const f=Tr.readIdentifierAndData(e,l+1,o,s);c={description:f.id,text:this.splitValue(n,Xt(f.data,s).replace(/\x00+$/,""))};break}case"PIC":case"APIC":if(r){const f={};switch(l+=1,this.major){case 2:f.format=Xt(e.slice(l,l+3),"latin1"),l+=3;break;case 3:case 4:d=kr(e,l,o,ws),f.format=Xt(e.slice(l,d),ws),l=d+1;break;default:throw new Error(`Warning: unexpected major versionIndex: ${this.major}`)}f.format=Tr.fixPictureMimeType(f.format),f.type=zd[e[l]],l+=1,d=kr(e,l,o,s),f.description=Xt(e.slice(l,d),s),l=d+u,f.data=e.slice(l,o),c=f}break;case"CNT":case"PCNT":c=xe.get(e,0);break;case"SYLT":{const f=mE.get(e,0);l+=mE.len;const p={descriptor:"",language:f.language,contentType:f.contentType,timeStampFormat:f.timeStampFormat,syncText:[]};let g=!1;for(;l<o;){const x=Tr.readNullTerminatedString(e.subarray(l),f.encoding);if(l+=x.len,g){const w=xe.get(e,l);l+=xe.len,p.syncText.push({text:x.text,timestamp:w})}else p.descriptor=x.text,g=!0}c=p;break}case"ULT":case"USLT":case"COM":case"COMM":{const f=Sv.get(e,l);l+=Sv.len;const p=Tr.readNullTerminatedString(e.subarray(l),f.encoding);l+=p.len;const g=Tr.readNullTerminatedString(e.subarray(l),f.encoding);c={language:f.language,descriptor:p.text,text:g.text};break}case"UFID":{const f=Tr.readIdentifierAndData(e,l,o,ws);c={owner_identifier:f.id,identifier:f.data};break}case"PRIV":{const f=Tr.readIdentifierAndData(e,l,o,ws);c={owner_identifier:f.id,data:f.data};break}case"POPM":{d=kr(e,l,o,ws);const f=Xt(e.slice(l,d),ws);l=d+1;const p=o-l;c={email:f,rating:Pe.get(e,l),counter:p>=5?xe.get(e,l+1):void 0};break}case"GEOB":{d=kr(e,l+1,o,s);const f=Xt(e.slice(l+1,d),ws);l=d+1,d=kr(e,l,o-l,s);const p=Xt(e.slice(l,d),ws);l=d+1,d=kr(e,l,o-l,s);const g=Xt(e.slice(l,d),ws);c={type:f,filename:p,description:g,data:e.slice(l+1,o)};break}case"WCOM":case"WCOP":case"WOAF":case"WOAR":case"WOAS":case"WORS":case"WPAY":case"WPUB":d=kr(e,l+1,o,s),c=Xt(e.slice(l,d),ws);break;case"WXXX":{d=kr(e,l+1,o,s);const f=Xt(e.slice(l+1,d),s);l=d+(s==="utf-16le"?2:1),c={description:f,url:Xt(e.slice(l,o),ws)};break}case"WFD":case"WFED":c=Xt(e.slice(l+1,kr(e,l+1,o,s)),s);break;case"MCDI":{c=e.slice(0,o);break}default:vE(`Warning: unsupported id3v2-tag-type: ${n}`);break}return c}static readNullTerminatedString(e,n){let r=n.bom?2:0;const s=kr(e,r,e.length,n.encoding),i=e.slice(r,s);return n.encoding==="utf-16le"?r=s+2:r=s+1,{text:Xt(i,n.encoding),len:r}}static fixPictureMimeType(e){switch(e=e.toLocaleLowerCase(),e){case"jpg":return"image/jpeg";case"png":return"image/png"}return e}static functionList(e){const n={};for(let r=0;r+1<e.length;r+=2){const s=e[r+1].split(",");n[e[r]]=n[e[r]]?n[e[r]].concat(s):s}return n}splitValue(e,n){let r;return this.major<4?(r=n.split(/\x00/g),r.length>1?this.warningCollector.addWarning(`ID3v2.${this.major} ${e} uses non standard null-separator.`):r=n.split(/\//g)):r=n.split(/\x00/g),Tr.trimArray(r)}static trimArray(e){return e.map(n=>n.replace(/\x00+$/,"").trim())}static readIdentifierAndData(e,n,r,s){const i=kr(e,n,r,s),o=Xt(e.slice(n,i),s);return n=i+Tr.getNullTerminatorLength(s),{id:o,data:e.slice(n,r)}}static getNullTerminatorLength(e){return e==="utf-16le"?2:1}}const _E=new TextDecoder("ascii");class ks{constructor(){this.tokenizer=void 0,this.id3Header=void 0,this.metadata=void 0,this.headerType=void 0,this.options=void 0}static removeUnsyncBytes(e){let n=0,r=0;for(;n<e.length-1;)n!==r&&(e[r]=e[n]),n+=e[n]===255&&e[n+1]===0?2:1,r++;return n<e.length&&(e[r++]=e[n]),e.slice(0,r)}static getFrameHeaderLength(e){switch(e){case 2:return 6;case 3:case 4:return 10;default:throw new Error("header versionIndex is incorrect")}}static readFrameFlags(e){return{status:{tag_alter_preservation:jt(e,0,6),file_alter_preservation:jt(e,0,5),read_only:jt(e,0,4)},format:{grouping_identity:jt(e,1,7),compression:jt(e,1,3),encryption:jt(e,1,2),unsynchronisation:jt(e,1,1),data_length_indicator:jt(e,1,0)}}}static readFrameData(e,n,r,s,i){var l,c;const o=new Tr(r,i);switch(r){case 2:return o.readData(e,n.id,s);case 3:case 4:return(l=n.flags)!=null&&l.format.unsynchronisation&&(e=ks.removeUnsyncBytes(e)),(c=n.flags)!=null&&c.format.data_length_indicator&&(e=e.slice(4,e.length)),o.readData(e,n.id,s);default:throw new Error(`Unexpected majorVer: ${r}`)}}static makeDescriptionTagName(e,n){return e+(n?`:${n}`:"")}async parse(e,n,r){this.tokenizer=n,this.metadata=e,this.options=r;const s=await this.tokenizer.readToken(bv);if(s.fileIdentifier!=="ID3")throw new Error("expected ID3-header file-identifier 'ID3' was not found");return this.id3Header=s,this.headerType=`ID3v2.${s.version.major}`,s.flags.isExtendedHeader?this.parseExtendedHeader():this.parseId3Data(s.size)}async parseExtendedHeader(){const e=await this.tokenizer.readToken(fE),n=e.size-fE.len;return n>0?this.parseExtendedHeaderData(n,e.size):this.parseId3Data(this.id3Header.size-e.size)}async parseExtendedHeaderData(e,n){return await this.tokenizer.ignore(e),this.parseId3Data(this.id3Header.size-n)}async parseId3Data(e){const n=await this.tokenizer.readToken(new ur(e));for(const r of this.parseMetadata(n))switch(r.id){case"TXXX":r.value&&await this.handleTag(r,r.value.text,()=>r.value.description);break;default:await(Array.isArray(r.value)?Promise.all(r.value.map(s=>this.addTag(r.id,s))):this.addTag(r.id,r.value))}}async handleTag(e,n,r,s=i=>i){await Promise.all(n.map(i=>this.addTag(ks.makeDescriptionTagName(e.id,r(i)),s(i))))}async addTag(e,n){await this.metadata.addTag(this.headerType,e,n)}parseMetadata(e){let n=0;const r=[];for(;n!==e.length;){const s=ks.getFrameHeaderLength(this.id3Header.version.major);if(n+s>e.length){this.metadata.addWarning("Illegal ID3v2 tag length");break}const i=e.slice(n,n+s);n+=s;const o=this.readFrameHeader(i,this.id3Header.version.major),l=e.slice(n,n+o.length);n+=o.length;const c=ks.readFrameData(l,o,this.id3Header.version.major,!this.options.skipCovers,this.metadata);c&&r.push({id:o.id,value:c})}return r}readFrameHeader(e,n){let r;switch(n){case 2:r={id:_E.decode(e.slice(0,3)),length:tr.get(e,3)},r.id.match(/[A-Z0-9]{3}/g)||this.metadata.addWarning(`Invalid ID3v2.${this.id3Header.version.major} frame-header-ID: ${r.id}`);break;case 3:case 4:r={id:_E.decode(e.slice(0,4)),length:(n===4?NN:xe).get(e,4),flags:ks.readFrameFlags(e.slice(8,10))},r.id.match(/[A-Z0-9]{4}/g)||this.metadata.addWarning(`Invalid ID3v2.${this.id3Header.version.major} frame-header-ID: ${r.id}`);break;default:throw new Error(`Unexpected majorVer: ${n}`)}return r}}const JK={NONE:"not compressed	PCM	Apple Computer",sowt:"PCM (byte swapped)",fl32:"32-bit floating point IEEE 32-bit float",fl64:"64-bit floating point IEEE 64-bit float	Apple Computer",alaw:"ALaw 2:1	8-bit ITU-T G.711 A-law",ulaw:"µLaw 2:1	8-bit ITU-T G.711 µ-law	Apple Computer",ULAW:"CCITT G.711 u-law 8-bit ITU-T G.711 µ-law",ALAW:"CCITT G.711 A-law 8-bit ITU-T G.711 A-law",FL32:"Float 32	IEEE 32-bit float "};class ZK{constructor(e,n){this.isAifc=n;const r=n?22:18;if(e.chunkSize<r)throw new Error(`COMMON CHUNK size should always be at least ${r}`);this.len=e.chunkSize}get(e,n){const r=et.get(e,n+8)-16398,s=et.get(e,n+8+2),i={numChannels:et.get(e,n),numSampleFrames:xe.get(e,n+2),sampleSize:et.get(e,n+6),sampleRate:r<0?s>>Math.abs(r):s<<r};if(this.isAifc){if(i.compressionType=ft.get(e,n+18),this.len>22){const o=Pe.get(e,n+22);if(o>0){const l=(o+1)%2;if(23+o+l===this.len)i.compressionName=new me(o,"latin1").get(e,n+23);else throw new Error("Illegal pstring length")}else i.compressionName=void 0}}else i.compressionName="PCM";return i}}const wx={len:8,get:(t,e)=>({chunkID:ft.get(t,e),chunkSize:Number(BigInt(xe.get(t,e+4)))})},_x=st("music-metadata:parser:aiff");class eQ extends Hr{constructor(){super(...arguments),this.isCompressed=null}async parse(){if((await this.tokenizer.readToken(wx)).chunkID!=="FORM")throw new Error("Invalid Chunk-ID, expected 'FORM'");const n=await this.tokenizer.readToken(ft);switch(n){case"AIFF":this.metadata.setFormat("container",n),this.isCompressed=!1;break;case"AIFC":this.metadata.setFormat("container","AIFF-C"),this.isCompressed=!0;break;default:throw new Error(`Unsupported AIFF type: ${n}`)}this.metadata.setFormat("lossless",!this.isCompressed);try{for(;!this.tokenizer.fileInfo.size||this.tokenizer.fileInfo.size-this.tokenizer.position>=wx.len;){_x(`Reading AIFF chunk at offset=${this.tokenizer.position}`);const r=await this.tokenizer.readToken(wx),s=2*Math.round(r.chunkSize/2),i=await this.readData(r);await this.tokenizer.ignore(s-i)}}catch(r){if(r instanceof Pt)_x("End-of-stream");else throw r}}async readData(e){switch(e.chunkID){case"COMM":{if(this.isCompressed===null)throw new Error("Failed to parse AIFF.COMM chunk when compression type is unknown");const n=await this.tokenizer.readToken(new ZK(e,this.isCompressed));return this.metadata.setFormat("bitsPerSample",n.sampleSize),this.metadata.setFormat("sampleRate",n.sampleRate),this.metadata.setFormat("numberOfChannels",n.numChannels),this.metadata.setFormat("numberOfSamples",n.numSampleFrames),this.metadata.setFormat("duration",n.numSampleFrames/n.sampleRate),(n.compressionName||n.compressionType)&&this.metadata.setFormat("codec",n.compressionName??JK[n.compressionType]),e.chunkSize}case"ID3 ":{const n=await this.tokenizer.readToken(new ur(e.chunkSize)),r=Fc(n);return await new ks().parse(this.metadata,r,this.options),e.chunkSize}case"SSND":return this.metadata.format.duration&&this.metadata.setFormat("bitrate",8*e.chunkSize/this.metadata.format.duration),0;case"NAME":case"AUTH":case"(c) ":case"ANNO":return this.readTextChunk(e);default:return _x(`Ignore chunk id=${e.chunkID}, size=${e.chunkSize}`),0}}async readTextChunk(e){const r=(await this.tokenizer.readToken(new me(e.chunkSize,"ascii"))).split("\0").map(s=>s.trim()).filter(s=>s==null?void 0:s.length);return await Promise.all(r.map(s=>this.metadata.addTag("AIFF",e.chunkID,s))),e.chunkSize}}class U{static fromBin(e,n=0){return new U(U.decode(e,n))}static decode(e,n=0){const r=new DataView(e.buffer,n);return`${r.getUint32(0,!0).toString(16)}-${r.getUint16(4,!0).toString(16)}-${r.getUint16(6,!0).toString(16)}-${r.getUint16(8).toString(16)}-${x_(e.slice(n+10,n+16))}`.toUpperCase()}static decodeMediaType(e){switch(e.str){case U.AudioMedia.str:return"audio";case U.VideoMedia.str:return"video";case U.CommandMedia.str:return"command";case U.Degradable_JPEG_Media.str:return"degradable-jpeg";case U.FileTransferMedia.str:return"file-transfer";case U.BinaryMedia.str:return"binary"}}static encode(e){const n=new Uint8Array(16),r=new DataView(n.buffer);return r.setUint32(0,Number.parseInt(e.slice(0,8),16),!0),r.setUint16(4,Number.parseInt(e.slice(9,13),16),!0),r.setUint16(6,Number.parseInt(e.slice(14,18),16),!0),n.set(aE(e.slice(19,23)),8),n.set(aE(e.slice(24)),10),n}constructor(e){this.str=e}equals(e){return this.str===e.str}toBin(){return U.encode(this.str)}}U.HeaderObject=new U("75B22630-668E-11CF-A6D9-00AA0062CE6C");U.DataObject=new U("75B22636-668E-11CF-A6D9-00AA0062CE6C");U.SimpleIndexObject=new U("33000890-E5B1-11CF-89F4-00A0C90349CB");U.IndexObject=new U("D6E229D3-35DA-11D1-9034-00A0C90349BE");U.MediaObjectIndexObject=new U("FEB103F8-12AD-4C64-840F-2A1D2F7AD48C");U.TimecodeIndexObject=new U("3CB73FD0-0C4A-4803-953D-EDF7B6228F0C");U.FilePropertiesObject=new U("8CABDCA1-A947-11CF-8EE4-00C00C205365");U.StreamPropertiesObject=new U("B7DC0791-A9B7-11CF-8EE6-00C00C205365");U.HeaderExtensionObject=new U("5FBF03B5-A92E-11CF-8EE3-00C00C205365");U.CodecListObject=new U("86D15240-311D-11D0-A3A4-00A0C90348F6");U.ScriptCommandObject=new U("1EFB1A30-0B62-11D0-A39B-00A0C90348F6");U.MarkerObject=new U("F487CD01-A951-11CF-8EE6-00C00C205365");U.BitrateMutualExclusionObject=new U("D6E229DC-35DA-11D1-9034-00A0C90349BE");U.ErrorCorrectionObject=new U("75B22635-668E-11CF-A6D9-00AA0062CE6C");U.ContentDescriptionObject=new U("75B22633-668E-11CF-A6D9-00AA0062CE6C");U.ExtendedContentDescriptionObject=new U("D2D0A440-E307-11D2-97F0-00A0C95EA850");U.ContentBrandingObject=new U("2211B3FA-BD23-11D2-B4B7-00A0C955FC6E");U.StreamBitratePropertiesObject=new U("7BF875CE-468D-11D1-8D82-006097C9A2B2");U.ContentEncryptionObject=new U("2211B3FB-BD23-11D2-B4B7-00A0C955FC6E");U.ExtendedContentEncryptionObject=new U("298AE614-2622-4C17-B935-DAE07EE9289C");U.DigitalSignatureObject=new U("2211B3FC-BD23-11D2-B4B7-00A0C955FC6E");U.PaddingObject=new U("1806D474-CADF-4509-A4BA-9AABCB96AAE8");U.ExtendedStreamPropertiesObject=new U("14E6A5CB-C672-4332-8399-A96952065B5A");U.AdvancedMutualExclusionObject=new U("A08649CF-4775-4670-8A16-6E35357566CD");U.GroupMutualExclusionObject=new U("D1465A40-5A79-4338-B71B-E36B8FD6C249");U.StreamPrioritizationObject=new U("D4FED15B-88D3-454F-81F0-ED5C45999E24");U.BandwidthSharingObject=new U("A69609E6-517B-11D2-B6AF-00C04FD908E9");U.LanguageListObject=new U("7C4346A9-EFE0-4BFC-B229-393EDE415C85");U.MetadataObject=new U("C5F8CBEA-5BAF-4877-8467-AA8C44FA4CCA");U.MetadataLibraryObject=new U("44231C94-9498-49D1-A141-1D134E457054");U.IndexParametersObject=new U("D6E229DF-35DA-11D1-9034-00A0C90349BE");U.MediaObjectIndexParametersObject=new U("6B203BAD-3F11-48E4-ACA8-D7613DE2CFA7");U.TimecodeIndexParametersObject=new U("F55E496D-9797-4B5D-8C8B-604DFE9BFB24");U.CompatibilityObject=new U("26F18B5D-4584-47EC-9F5F-0E651F0452C9");U.AdvancedContentEncryptionObject=new U("43058533-6981-49E6-9B74-AD12CB86D58C");U.AudioMedia=new U("F8699E40-5B4D-11CF-A8FD-00805F5C442B");U.VideoMedia=new U("BC19EFC0-5B4D-11CF-A8FD-00805F5C442B");U.CommandMedia=new U("59DACFC0-59E6-11D0-A3AC-00A0C90348F6");U.JFIF_Media=new U("B61BE100-5B4E-11CF-A8FD-00805F5C442B");U.Degradable_JPEG_Media=new U("35907DE0-E415-11CF-A917-00805F5C442B");U.FileTransferMedia=new U("91BD222C-F21C-497A-8B6D-5AA86BFC0185");U.BinaryMedia=new U("3AFB65E2-47EF-40F2-AC2C-70A90D71D343");U.ASF_Index_Placeholder_Object=new U("D9AADE20-7C17-4F9C-BC28-8555DD98E2A2");function tQ(t){return nQ[t]}function Qg(t){return wa(Xt(t,"utf-16le"))}const nQ=[Qg,bE,rQ,sQ,iQ,FN,bE];function bE(t){return new Uint8Array(t)}function rQ(t,e=0){return FN(t,e)===1}function sQ(t,e=0){return le.get(t,e)}function iQ(t,e=0){return Xn.get(t,e)}function FN(t,e=0){return Ke.get(t,e)}var SE;(function(t){t[t.UnicodeString=0]="UnicodeString",t[t.ByteArray=1]="ByteArray",t[t.Bool=2]="Bool",t[t.DWord=3]="DWord",t[t.QWord=4]="QWord",t[t.Word=5]="Word"})(SE||(SE={}));const aQ={len:30,get:(t,e)=>({objectId:U.fromBin(t,e),objectSize:Number(Xn.get(t,e+16)),numberOfHeaderObjects:le.get(t,e+24)})},To={len:24,get:(t,e)=>({objectId:U.fromBin(t,e),objectSize:Number(Xn.get(t,e+16))})};class pl{constructor(e){this.len=Number(e.objectSize)-To.len}postProcessTag(e,n,r,s){if(n==="WM/Picture")e.push({id:n,value:b_.fromBuffer(s)});else{const i=tQ(r);if(!i)throw new Error(`unexpected value headerType: ${r}`);e.push({id:n,value:i(s)})}}}class EE extends pl{get(e,n){return null}}class Ev extends pl{get(e,n){return{fileId:U.fromBin(e,n),fileSize:Xn.get(e,n+16),creationDate:Xn.get(e,n+24),dataPacketsCount:Xn.get(e,n+32),playDuration:Xn.get(e,n+40),sendDuration:Xn.get(e,n+48),preroll:Xn.get(e,n+56),flags:{broadcast:jt(e,n+64,24),seekable:jt(e,n+64,25)},minimumDataPacketSize:le.get(e,n+68),maximumDataPacketSize:le.get(e,n+72),maximumBitrate:le.get(e,n+76)}}}Ev.guid=U.FilePropertiesObject;class jv extends pl{get(e,n){return{streamType:U.decodeMediaType(U.fromBin(e,n)),errorCorrectionType:U.fromBin(e,n+8)}}}jv.guid=U.StreamPropertiesObject;class kv{constructor(){this.len=22}get(e,n){const r=new DataView(e.buffer,n);return{reserved1:U.fromBin(e,n),reserved2:r.getUint16(16,!0),extensionDataSize:r.getUint16(18,!0)}}}kv.guid=U.HeaderExtensionObject;const oQ={len:20,get:(t,e)=>({entryCount:new DataView(t.buffer,e).getUint16(16,!0)})};async function jE(t){const e=await t.readNumber(Ke);return(await t.readToken(new me(e*2,"utf-16le"))).replace("\0","")}async function lQ(t){const e=await t.readToken(oQ),n=[];for(let r=0;r<e.entryCount;++r)n.push(await uQ(t));return n}async function cQ(t){const e=await t.readNumber(Ke),n=new Uint8Array(e);return await t.readBuffer(n),n}async function uQ(t){const e=await t.readNumber(Ke);return{type:{videoCodec:(e&1)===1,audioCodec:(e&2)===2},codecName:await jE(t),description:await jE(t),information:await cQ(t)}}class tl extends pl{get(e,n){const r=[],s=new DataView(e.buffer,n);let i=10;for(let o=0;o<tl.contentDescTags.length;++o){const l=s.getUint16(o*2,!0);if(l>0){const c=tl.contentDescTags[o],u=i+l;r.push({id:c,value:Qg(e.slice(n+i,n+u))}),i=u}}return r}}tl.guid=U.ContentDescriptionObject;tl.contentDescTags=["Title","Author","Copyright","Description","Rating"];class Tv extends pl{get(e,n){const r=[],s=new DataView(e.buffer,n),i=s.getUint16(0,!0);let o=2;for(let l=0;l<i;l+=1){const c=s.getUint16(o,!0);o+=2;const u=Qg(e.slice(n+o,n+o+c));o+=c;const d=s.getUint16(o,!0);o+=2;const f=s.getUint16(o,!0);o+=2;const p=e.slice(n+o,n+o+f);o+=f,this.postProcessTag(r,u,d,p)}return r}}Tv.guid=U.ExtendedContentDescriptionObject;class Iv extends pl{get(e,n){const r=new DataView(e.buffer,n);return{startTime:Xn.get(e,n),endTime:Xn.get(e,n+8),dataBitrate:r.getInt32(12,!0),bufferSize:r.getInt32(16,!0),initialBufferFullness:r.getInt32(20,!0),alternateDataBitrate:r.getInt32(24,!0),alternateBufferSize:r.getInt32(28,!0),alternateInitialBufferFullness:r.getInt32(32,!0),maximumObjectSize:r.getInt32(36,!0),flags:{reliableFlag:jt(e,n+40,0),seekableFlag:jt(e,n+40,1),resendLiveCleanpointsFlag:jt(e,n+40,2)},streamNumber:r.getInt16(42,!0),streamLanguageId:r.getInt16(44,!0),averageTimePerFrame:r.getInt32(52,!0),streamNameCount:r.getInt32(54,!0),payloadExtensionSystems:r.getInt32(56,!0),streamNames:[],streamPropertiesObject:null}}}Iv.guid=U.ExtendedStreamPropertiesObject;class pp extends pl{get(e,n){const r=[],s=new DataView(e.buffer,n),i=s.getUint16(0,!0);let o=2;for(let l=0;l<i;l+=1){o+=4;const c=s.getUint16(o,!0);o+=2;const u=s.getUint16(o,!0);o+=2;const d=s.getUint32(o,!0);o+=4;const f=Qg(e.slice(n+o,n+o+c));o+=c;const p=e.slice(n+o,n+o+d);o+=d,this.postProcessTag(r,f,u,p)}return r}}pp.guid=U.MetadataObject;class Cv extends pp{}Cv.guid=U.MetadataLibraryObject;class b_{static fromBuffer(e){return new b_(e.length).get(e,0)}constructor(e){this.len=e}get(e,n){const r=new DataView(e.buffer,n),s=r.getUint8(0),i=r.getInt32(1,!0);let o=5;for(;r.getUint16(o)!==0;)o+=2;const l=new me(o-5,"utf-16le").get(e,5);for(;r.getUint16(o)!==0;)o+=2;const c=new me(o-5,"utf-16le").get(e,5);return{type:zd[s],format:l,description:c,size:i,data:e.slice(o+4)}}}const Af=st("music-metadata:parser:ASF"),dQ="asf";class hQ extends Hr{async parse(){const e=await this.tokenizer.readToken(aQ);if(!e.objectId.equals(U.HeaderObject))throw new Error(`expected asf header; but was not found; got: ${e.objectId.str}`);try{await this.parseObjectHeader(e.numberOfHeaderObjects)}catch(n){Af("Error while parsing ASF: %s",n)}}async parseObjectHeader(e){let n;do{const r=await this.tokenizer.readToken(To);switch(Af("header GUID=%s",r.objectId.str),r.objectId.str){case Ev.guid.str:{const s=await this.tokenizer.readToken(new Ev(r));this.metadata.setFormat("duration",Number(s.playDuration/BigInt(1e3))/1e4-Number(s.preroll)/1e3),this.metadata.setFormat("bitrate",s.maximumBitrate);break}case jv.guid.str:{const s=await this.tokenizer.readToken(new jv(r));this.metadata.setFormat("container",`ASF/${s.streamType}`);break}case kv.guid.str:{const s=await this.tokenizer.readToken(new kv);await this.parseExtensionObject(s.extensionDataSize);break}case tl.guid.str:n=await this.tokenizer.readToken(new tl(r)),await this.addTags(n);break;case Tv.guid.str:n=await this.tokenizer.readToken(new Tv(r)),await this.addTags(n);break;case U.CodecListObject.str:{const s=await lQ(this.tokenizer);s.forEach(o=>{this.metadata.addStreamInfo({type:o.type.videoCodec?el.video:el.audio,codecName:o.codecName})});const i=s.filter(o=>o.type.audioCodec).map(o=>o.codecName).join("/");this.metadata.setFormat("codec",i);break}case U.StreamBitratePropertiesObject.str:await this.tokenizer.ignore(r.objectSize-To.len);break;case U.PaddingObject.str:Af("Padding: %s bytes",r.objectSize-To.len),await this.tokenizer.ignore(r.objectSize-To.len);break;default:this.metadata.addWarning(`Ignore ASF-Object-GUID: ${r.objectId.str}`),Af("Ignore ASF-Object-GUID: %s",r.objectId.str),await this.tokenizer.readToken(new EE(r))}}while(--e)}async addTags(e){await Promise.all(e.map(({id:n,value:r})=>this.metadata.addTag(dQ,n,r)))}async parseExtensionObject(e){do{const n=await this.tokenizer.readToken(To),r=n.objectSize-To.len;switch(n.objectId.str){case Iv.guid.str:await this.tokenizer.readToken(new Iv(n));break;case pp.guid.str:{const s=await this.tokenizer.readToken(new pp(n));await this.addTags(s);break}case Cv.guid.str:{const s=await this.tokenizer.readToken(new Cv(n));await this.addTags(s);break}case U.PaddingObject.str:await this.tokenizer.ignore(r);break;case U.CompatibilityObject.str:this.tokenizer.ignore(r);break;case U.ASF_Index_Placeholder_Object.str:await this.tokenizer.ignore(r);break;default:this.metadata.addWarning(`Ignore ASF-Object-GUID: ${n.objectId.str}`),await this.tokenizer.readToken(new EE(n));break}e-=n.objectSize}while(e>0)}}class Bd{static fromBase64(e){return Bd.fromBuffer(Uint8Array.from(atob(e),n=>n.charCodeAt(0)))}static fromBuffer(e){return new Bd(e.length).get(e,0)}constructor(e){this.len=e}get(e,n){const r=zd[xe.get(e,n)];n+=4;const s=xe.get(e,n);n+=4;const i=new me(s,"utf-8").get(e,n);n+=s;const o=xe.get(e,n);n+=4;const l=new me(o,"utf-8").get(e,n);n+=o;const c=xe.get(e,n);n+=4;const u=xe.get(e,n);n+=4;const d=xe.get(e,n);n+=4;const f=xe.get(e,n);n+=4;const p=xe.get(e,n);n+=4;const g=Uint8Array.from(e.slice(n,n+p));return{type:r,format:i,description:l,width:c,height:u,colour_depth:d,indexed_color:f,data:g}}}const Pf={len:7,get:(t,e)=>({packetType:Pe.get(t,e),vorbis:new me(6,"ascii").get(t,e+1)})},fQ={len:23,get:(t,e)=>({version:le.get(t,e+0),channelMode:Pe.get(t,e+4),sampleRate:le.get(t,e+5),bitrateMax:le.get(t,e+9),bitrateNominal:le.get(t,e+13),bitrateMin:le.get(t,e+17)})},bx=st("music-metadata:parser:ID3");class Xg extends Hr{constructor(){super(...arguments),this.id3parser=new ks}static async startsWithID3v2Header(e){return(await e.peekToken(bv)).fileIdentifier==="ID3"}async parse(){try{await this.parseID3v2()}catch(e){if(e instanceof Pt)bx("End-of-stream");else throw e}}finalize(){}async parseID3v2(){await this.tryReadId3v2Headers(),bx("End of ID3v2 header, go to MPEG-parser: pos=%s",this.tokenizer.position),await this.postId3v2Parse(),this.options.skipPostHeaders&&this.metadata.hasAny()?this.finalize():(await new __().init(this.metadata,this.tokenizer,this.options).parse(),this.finalize())}async tryReadId3v2Headers(){if((await this.tokenizer.peekToken(bv)).fileIdentifier==="ID3")return bx("Found ID3v2 header, pos=%s",this.tokenizer.position),await this.id3parser.parse(this.metadata,this.tokenizer,this.options),this.tryReadId3v2Headers()}}class MN{constructor(e,n){this.data=e,this.offset=n}readInt32(){const e=le.get(this.data,this.offset);return this.offset+=4,e}readStringUtf8(){const e=this.readInt32(),n=new TextDecoder("utf-8").decode(this.data.subarray(this.offset,this.offset+e));return this.offset+=e,n}parseUserComment(){const e=this.offset,n=this.readStringUtf8(),r=n.indexOf("=");return{key:n.slice(0,r).toUpperCase(),value:n.slice(r+1),len:this.offset-e}}}const Nl=st("music-metadata:parser:ogg:vorbis1");class nl{constructor(e,n){this.metadata=e,this.options=n,this.pageSegments=[]}async parsePage(e,n){if(e.headerType.firstPage)this.parseFirstPage(e,n);else{if(e.headerType.continued){if(this.pageSegments.length===0)throw new Error("Cannot continue on previous page");this.pageSegments.push(n)}if(e.headerType.lastPage||!e.headerType.continued){if(this.pageSegments.length>0){const r=nl.mergeUint8Arrays(this.pageSegments);await this.parseFullPage(r)}this.pageSegments=e.headerType.lastPage?[]:[n]}}e.headerType.lastPage&&this.calculateDuration(e)}static mergeUint8Arrays(e){const n=e.reduce((s,i)=>s+i.length,0),r=new Uint8Array(n);return e.forEach((s,i,o)=>{const l=o.slice(0,i).reduce((c,u)=>c+u.length,0);r.set(s,l)}),r}async flush(){await this.parseFullPage(nl.mergeUint8Arrays(this.pageSegments))}async parseUserComment(e,n){const s=new MN(e,n).parseUserComment();return await this.addTag(s.key,s.value),s.len}async addTag(e,n){if(e==="METADATA_BLOCK_PICTURE"&&typeof n=="string"){if(this.options.skipCovers){Nl("Ignore picture");return}n=Bd.fromBase64(n),Nl(`Push picture: id=${e}, format=${n.format}`)}else Nl(`Push tag: id=${e}, value=${n}`);await this.metadata.addTag("vorbis",e,n)}calculateDuration(e){this.metadata.format.sampleRate&&e.absoluteGranulePosition>=0&&(this.metadata.setFormat("numberOfSamples",e.absoluteGranulePosition),this.metadata.setFormat("duration",e.absoluteGranulePosition/this.metadata.format.sampleRate))}parseFirstPage(e,n){this.metadata.setFormat("codec","Vorbis I"),Nl("Parse first page");const r=Pf.get(n,0);if(r.vorbis!=="vorbis")throw new Error("Metadata does not look like Vorbis");if(r.packetType===1){const s=fQ.get(n,Pf.len);this.metadata.setFormat("sampleRate",s.sampleRate),this.metadata.setFormat("bitrate",s.bitrateNominal),this.metadata.setFormat("numberOfChannels",s.channelMode),Nl("sample-rate=%s[hz], bitrate=%s[b/s], channel-mode=%s",s.sampleRate,s.bitrateNominal,s.channelMode)}else throw new Error("First Ogg page should be type 1: the identification header")}async parseFullPage(e){const n=Pf.get(e,0);switch(Nl("Parse full page: type=%s, byteLength=%s",n.packetType,e.byteLength),n.packetType){case 3:return this.parseUserCommentList(e,Pf.len)}}async parseUserCommentList(e,n){const r=le.get(e,n);n+=4,n+=r;let s=le.get(e,n);for(n+=4;s-- >0;)n+=await this.parseUserComment(e,n)}}const mQ=st("music-metadata:parser:FLAC");var wi;(function(t){t[t.STREAMINFO=0]="STREAMINFO",t[t.PADDING=1]="PADDING",t[t.APPLICATION=2]="APPLICATION",t[t.SEEKTABLE=3]="SEEKTABLE",t[t.VORBIS_COMMENT=4]="VORBIS_COMMENT",t[t.CUESHEET=5]="CUESHEET",t[t.PICTURE=6]="PICTURE"})(wi||(wi={}));class pQ extends Xg{constructor(){super(...arguments),this.padding=0}init(e,n,r){return super.init(e,n,r),this.vorbisParser=new nl(e,r),this}async postId3v2Parse(){if((await this.tokenizer.readToken(ft)).toString()!=="fLaC")throw new Error("Invalid FLAC preamble");let n;do n=await this.tokenizer.readToken(gQ),await this.parseDataBlock(n);while(!n.lastBlock);if(this.tokenizer.fileInfo.size&&this.metadata.format.duration){const r=this.tokenizer.fileInfo.size-this.tokenizer.position;this.metadata.setFormat("bitrate",8*r/this.metadata.format.duration)}}async parseDataBlock(e){switch(mQ(`blockHeader type=${e.type}, length=${e.length}`),e.type){case wi.STREAMINFO:return this.parseBlockStreamInfo(e.length);case wi.PADDING:this.padding+=e.length;break;case wi.APPLICATION:break;case wi.SEEKTABLE:break;case wi.VORBIS_COMMENT:return this.parseComment(e.length);case wi.CUESHEET:break;case wi.PICTURE:await this.parsePicture(e.length);return;default:this.metadata.addWarning(`Unknown block type: ${e.type}`)}return this.tokenizer.ignore(e.length).then()}async parseBlockStreamInfo(e){if(e!==kE.len)throw new Error("Unexpected block-stream-info length");const n=await this.tokenizer.readToken(kE);this.metadata.setFormat("container","FLAC"),this.metadata.setFormat("codec","FLAC"),this.metadata.setFormat("lossless",!0),this.metadata.setFormat("numberOfChannels",n.channels),this.metadata.setFormat("bitsPerSample",n.bitsPerSample),this.metadata.setFormat("sampleRate",n.sampleRate),n.totalSamples>0&&this.metadata.setFormat("duration",n.totalSamples/n.sampleRate)}async parseComment(e){const n=await this.tokenizer.readToken(new ur(e)),r=new MN(n,0);r.readStringUtf8();const s=r.readInt32(),i=new Array(s);for(let o=0;o<s;o++)i[o]=r.parseUserComment();await Promise.all(i.map(o=>this.vorbisParser.addTag(o.key,o.value)))}async parsePicture(e){if(this.options.skipCovers)return this.tokenizer.ignore(e);const n=await this.tokenizer.readToken(new Bd(e));this.vorbisParser.addTag("METADATA_BLOCK_PICTURE",n)}}const gQ={len:4,get:(t,e)=>({lastBlock:jt(t,e,7),type:ze(t,e,1,7),length:tr.get(t,e+1)})},kE={len:34,get:(t,e)=>({minimumBlockSize:et.get(t,e),maximumBlockSize:et.get(t,e+2)/1e3,minimumFrameSize:tr.get(t,e+4),maximumFrameSize:tr.get(t,e+7),sampleRate:tr.get(t,e+10)>>4,channels:ze(t,e+12,4,3)+1,bitsPerSample:ze(t,e+12,7,5)+1,totalSamples:ze(t,e+13,4,36),fileMD5:new ur(16).get(t,e+18)})},DN=st("music-metadata:parser:MP4:atom"),gp={len:8,get:(t,e)=>{const n=xe.get(t,e);if(n<0)throw new Error("Invalid atom header length");return{length:BigInt(n),name:new me(4,"latin1").get(t,e+4)}},put:(t,e,n)=>(xe.put(t,e,Number(n.length)),ft.put(t,e+4,n.name))},xQ=p_,TE={len:4,get:(t,e)=>({type:new me(4,"ascii").get(t,e)})};class LN{constructor(e,n,r){if(this.len=e,e<n)throw new Error(`Atom ${r} expected to be ${n}, but specifies ${e} bytes long.`);e>n&&DN(`Warning: atom ${r} expected to be ${n}, but was actually ${e} bytes long.`)}}const Mc={len:4,get:(t,e)=>{const n=xe.get(t,e)-2082844800;return new Date(n*1e3)}};class yQ extends LN{constructor(e){super(e,24,"mdhd"),this.len=e}get(e,n){return{version:Pe.get(e,n+0),flags:tr.get(e,n+1),creationTime:Mc.get(e,n+4),modificationTime:Mc.get(e,n+8),timeScale:xe.get(e,n+12),duration:xe.get(e,n+16),language:et.get(e,n+20),quality:et.get(e,n+22)}}}class vQ extends LN{constructor(e){super(e,100,"mvhd"),this.len=e}get(e,n){return{version:Pe.get(e,n),flags:tr.get(e,n+1),creationTime:Mc.get(e,n+4),modificationTime:Mc.get(e,n+8),timeScale:xe.get(e,n+12),duration:xe.get(e,n+16),preferredRate:xe.get(e,n+20),preferredVolume:et.get(e,n+24),previewTime:xe.get(e,n+72),previewDuration:xe.get(e,n+76),posterTime:xe.get(e,n+80),selectionTime:xe.get(e,n+84),selectionDuration:xe.get(e,n+88),currentTime:xe.get(e,n+92),nextTrackID:xe.get(e,n+96)}}}class wQ{constructor(e){this.len=e}get(e,n){return{type:{set:Pe.get(e,n+0),type:tr.get(e,n+1)},locale:tr.get(e,n+4),value:new ur(this.len-8).get(e,n+8)}}}class _Q{constructor(e){this.len=e}get(e,n){return{version:Pe.get(e,n),flags:tr.get(e,n+1),name:new me(this.len-4,"utf-8").get(e,n+4)}}}class bQ{constructor(e){this.len=e}get(e,n){return{version:Pe.get(e,n),flags:tr.get(e,n+1),creationTime:Mc.get(e,n+4),modificationTime:Mc.get(e,n+8),trackId:xe.get(e,n+12),duration:xe.get(e,n+20),layer:et.get(e,n+24),alternateGroup:et.get(e,n+26),volume:et.get(e,n+28)}}}const IE={len:8,get:(t,e)=>({version:Pe.get(t,e),flags:tr.get(t,e+1),numberOfEntries:xe.get(t,e+4)})};class SQ{constructor(e){this.len=e}get(e,n){return{dataFormat:ft.get(e,n),dataReferenceIndex:et.get(e,n+10),description:new ur(this.len-12).get(e,n+12)}}}class EQ{constructor(e){this.len=e}get(e,n){const r=IE.get(e,n);n+=IE.len;const s=[];for(let i=0;i<r.numberOfEntries;++i){const o=xe.get(e,n);n+=xe.len,s.push(new SQ(o).get(e,n)),n+=o}return{header:r,table:s}}}const CE={len:8,get(t,e){return{version:Ci.get(t,e),revision:Ci.get(t,e+2),vendor:Lr.get(t,e+4)}}},jQ={len:12,get(t,e){return{numAudioChannels:Ci.get(t,e+0),sampleSize:Ci.get(t,e+2),compressionId:Ci.get(t,e+4),packetSize:Ci.get(t,e+6),sampleRate:et.get(t,e+8)+et.get(t,e+10)/1e4}}};class S_{constructor(e,n){this.len=e,this.token=n}get(e,n){const r=Lr.get(e,n+4);return{version:$d.get(e,n+0),flags:m_.get(e,n+1),numberOfEntries:r,entries:ON(e,this.token,n+8,this.len-8,r)}}}const kQ={len:8,get(t,e){return{count:Lr.get(t,e+0),duration:Lr.get(t,e+4)}}};class TQ extends S_{constructor(e){super(e,kQ),this.len=e}}const IQ={len:12,get(t,e){return{firstChunk:Lr.get(t,e),samplesPerChunk:Lr.get(t,e+4),sampleDescriptionId:Lr.get(t,e+8)}}};class CQ extends S_{constructor(e){super(e,IQ),this.len=e}}class RQ{constructor(e){this.len=e}get(e,n){const r=Lr.get(e,n+8);return{version:$d.get(e,n),flags:m_.get(e,n+1),sampleSize:Lr.get(e,n+4),numberOfEntries:r,entries:ON(e,Lr,n+12,this.len-12,r)}}}class NQ extends S_{constructor(e){super(e,Lr),this.len=e}}class AQ{constructor(e){this.len=e}get(e,n){const r=Ci.get(e,n+0);return new me(r,"utf-8").get(e,n+2)}}function ON(t,e,n,r,s){if(DN(`remainingLen=${r}, numberOfEntries=${s} * token-len=${e.len}`),r===0)return[];if(r!==s*e.len)throw new Error("mismatch number-of-entries with remaining atom-length");const i=[];for(let o=0;o<s;++o)i.push(e.get(t,n)),n+=e.len;return i}const PQ=st("music-metadata:parser:MP4:Atom");class xp{static async readAtom(e,n,r,s){const i=e.position,o=await e.readToken(gp);o.length===BigInt(1)&&(o.length=await e.readToken(xQ));const c=new xp(o,o.length===BigInt(1),r),u=c.getPayloadLength(s);return PQ(`parse atom name=${c.atomPath}, extended=${c.extended}, offset=${i}, len=${c.header.length}`),await c.readData(e,n,u),c}constructor(e,n,r){this.header=e,this.extended=n,this.parent=r,this.children=[],this.atomPath=(this.parent?`${this.parent.atomPath}.`:"")+this.header.name}getHeaderLength(){return this.extended?16:8}getPayloadLength(e){return(this.header.length===BigInt(0)?e:Number(this.header.length))-this.getHeaderLength()}async readAtoms(e,n,r){for(;r>0;){const s=await xp.readAtom(e,n,this,r);this.children.push(s),r-=s.header.length===BigInt(0)?r:Number(s.header.length)}}async readData(e,n,r){switch(this.header.name){case"moov":case"udta":case"trak":case"mdia":case"minf":case"stbl":case"<id>":case"ilst":case"tref":return this.readAtoms(e,n,this.getPayloadLength(r));case"meta":{const i=(await e.peekToken(gp)).name==="hdlr"?0:4;return await e.ignore(i),this.readAtoms(e,n,this.getPayloadLength(r)-i)}default:return n(this,r)}}}const Ws=st("music-metadata:parser:MP4"),FQ="iTunes",RE={raw:{lossy:!1,format:"raw"},MAC3:{lossy:!0,format:"MACE 3:1"},MAC6:{lossy:!0,format:"MACE 6:1"},ima4:{lossy:!0,format:"IMA 4:1"},ulaw:{lossy:!0,format:"uLaw 2:1"},alaw:{lossy:!0,format:"uLaw 2:1"},Qclp:{lossy:!0,format:"QUALCOMM PureVoice"},".mp3":{lossy:!0,format:"MPEG-1 layer 3"},alac:{lossy:!1,format:"ALAC"},"ac-3":{lossy:!0,format:"AC-3"},mp4a:{lossy:!0,format:"MPEG-4/AAC"},mp4s:{lossy:!0,format:"MP4S"},c608:{lossy:!0,format:"CEA-608"},c708:{lossy:!0,format:"CEA-708"}};function NE(t,e,n){return n.indexOf(t)===e}class yp extends Hr{constructor(){super(...arguments),this.tracks=[],this.atomParsers={mvhd:async e=>{const n=await this.tokenizer.readToken(new vQ(e));this.metadata.setFormat("creationTime",n.creationTime),this.metadata.setFormat("modificationTime",n.modificationTime)},mdhd:async e=>{const n=await this.tokenizer.readToken(new yQ(e)),r=this.getTrackDescription();r.creationTime=n.creationTime,r.modificationTime=n.modificationTime,r.timeScale=n.timeScale,r.duration=n.duration},chap:async e=>{const n=this.getTrackDescription(),r=[];for(;e>=xe.len;)r.push(await this.tokenizer.readNumber(xe)),e-=xe.len;n.chapterList=r},tkhd:async e=>{const n=await this.tokenizer.readToken(new bQ(e));this.tracks.push(n)},mdat:async e=>{if(this.audioLengthInBytes=e,this.calculateBitRate(),this.options.includeChapters){const n=this.tracks.filter(r=>r.chapterList);if(n.length===1){const r=n[0].chapterList,s=this.tracks.filter(i=>r.indexOf(i.trackId)!==-1);if(s.length===1)return this.parseChapterTrack(s[0],n[0],e)}}await this.tokenizer.ignore(e)},ftyp:async e=>{const n=[];for(;e>0;){const s=await this.tokenizer.readToken(TE);e-=TE.len;const i=s.type.replace(/\W/g,"");i.length>0&&n.push(i)}Ws(`ftyp: ${n.join("/")}`);const r=n.filter(NE).join("/");this.metadata.setFormat("container",r)},stsd:async e=>{const n=await this.tokenizer.readToken(new EQ(e)),r=this.getTrackDescription();r.soundSampleDescription=n.table.map(s=>this.parseSoundSampleDescription(s))},stsc:async e=>{const n=await this.tokenizer.readToken(new CQ(e));this.getTrackDescription().sampleToChunkTable=n.entries},stts:async e=>{const n=await this.tokenizer.readToken(new TQ(e));this.getTrackDescription().timeToSampleTable=n.entries},stsz:async e=>{const n=await this.tokenizer.readToken(new RQ(e)),r=this.getTrackDescription();r.sampleSize=n.sampleSize,r.sampleSizeTable=n.entries},stco:async e=>{const n=await this.tokenizer.readToken(new NQ(e));this.getTrackDescription().chunkOffsetTable=n.entries},date:async e=>{const n=await this.tokenizer.readToken(new me(e,"utf-8"));await this.addTag("date",n)}}}static read_BE_Integer(e,n){const r=(n?"INT":"UINT")+e.length*8+(e.length>1?"_BE":""),s=Bq[r];if(!s)throw new Error(`Token for integer type not found: "${r}"`);return Number(s.get(e,0))}async parse(){this.tracks=[];let e=this.tokenizer.fileInfo.size||0;for(;!this.tokenizer.fileInfo.size||e>0;){try{if((await this.tokenizer.peekToken(gp)).name==="\0\0\0\0"){const o=`Error at offset=${this.tokenizer.position}: box.id=0`;Ws(o),this.addWarning(o);break}}catch(i){if(i instanceof Error){const o=`Error at offset=${this.tokenizer.position}: ${i.message}`;Ws(o),this.addWarning(o)}else throw i;break}const s=await xp.readAtom(this.tokenizer,(i,o)=>this.handleAtom(i,o),null,e);e-=s.header.length===BigInt(0)?e:Number(s.header.length)}const n=[];this.tracks.forEach(s=>{const i=[];s.soundSampleDescription.forEach(o=>{const l={},c=RE[o.dataFormat];if(c?(i.push(c.format),l.codecName=c.format):l.codecName=`<${o.dataFormat}>`,o.description){const{description:u}=o;u.sampleRate>0&&(l.type=el.audio,l.audio={samplingFrequency:u.sampleRate,bitDepth:u.sampleSize,channels:u.numAudioChannels})}this.metadata.addStreamInfo(l)}),i.length>=1&&n.push(i.join("/"))}),n.length>0&&this.metadata.setFormat("codec",n.filter(NE).join("+"));const r=this.tracks.filter(s=>s.soundSampleDescription.length>=1&&s.soundSampleDescription[0].description&&s.soundSampleDescription[0].description.numAudioChannels>0);if(r.length>=1){const s=r[0];if(s.timeScale>0){const l=s.duration/s.timeScale;this.metadata.setFormat("duration",l)}const i=s.soundSampleDescription[0];if(i.description&&(this.metadata.setFormat("sampleRate",i.description.sampleRate),this.metadata.setFormat("bitsPerSample",i.description.sampleSize),this.metadata.setFormat("numberOfChannels",i.description.numAudioChannels),s.timeScale===0&&s.timeToSampleTable.length>0)){const c=s.timeToSampleTable.map(u=>u.count*u.duration).reduce((u,d)=>u+d)/i.description.sampleRate;this.metadata.setFormat("duration",c)}const o=RE[i.dataFormat];o&&this.metadata.setFormat("lossless",!o.lossy),this.calculateBitRate()}}async handleAtom(e,n){if(e.parent)switch(e.parent.header.name){case"ilst":case"<id>":return this.parseMetadataItemData(e)}if(this.atomParsers[e.header.name])return this.atomParsers[e.header.name](n);Ws(`No parser for atom path=${e.atomPath}, payload-len=${n}, ignoring atom`),await this.tokenizer.ignore(n)}getTrackDescription(){return this.tracks[this.tracks.length-1]}calculateBitRate(){this.audioLengthInBytes&&this.metadata.format.duration&&this.metadata.setFormat("bitrate",8*this.audioLengthInBytes/this.metadata.format.duration)}async addTag(e,n){await this.metadata.addTag(FQ,e,n)}addWarning(e){Ws(`Warning: ${e}`),this.metadata.addWarning(e)}parseMetadataItemData(e){let n=e.header.name;return e.readAtoms(this.tokenizer,async(r,s)=>{const i=r.getPayloadLength(s);switch(r.header.name){case"data":return this.parseValueAtom(n,r);case"name":case"mean":case"rate":{const o=await this.tokenizer.readToken(new _Q(i));n+=`:${o.name}`;break}default:{const o=await this.tokenizer.readToken(new ur(i));this.addWarning(`Unsupported meta-item: ${n}[${r.header.name}] => value=${x_(o)} ascii=${g_(o,"ascii")}`)}}},e.getPayloadLength(0))}async parseValueAtom(e,n){const r=await this.tokenizer.readToken(new wQ(Number(n.header.length)-gp.len));if(r.type.set!==0)throw new Error(`Unsupported type-set != 0: ${r.type.set}`);switch(r.type.type){case 0:switch(e){case"trkn":case"disk":{const s=Pe.get(r.value,3),i=Pe.get(r.value,5);await this.addTag(e,`${s}/${i}`);break}case"gnre":{const s=Pe.get(r.value,1),i=mp[s-1];await this.addTag(e,i);break}case"rate":{const s=new TextDecoder("ascii").decode(r.value);await this.addTag(e,s);break}default:Ws(`unknown proprietary value type for: ${n.atomPath}`)}break;case 1:case 18:await this.addTag(e,new TextDecoder("utf-8").decode(r.value));break;case 13:if(this.options.skipCovers)break;await this.addTag(e,{format:"image/jpeg",data:Uint8Array.from(r.value)});break;case 14:if(this.options.skipCovers)break;await this.addTag(e,{format:"image/png",data:Uint8Array.from(r.value)});break;case 21:await this.addTag(e,yp.read_BE_Integer(r.value,!0));break;case 22:await this.addTag(e,yp.read_BE_Integer(r.value,!1));break;case 65:await this.addTag(e,Pe.get(r.value,0));break;case 66:await this.addTag(e,et.get(r.value,0));break;case 67:await this.addTag(e,xe.get(r.value,0));break;default:this.addWarning(`atom key=${e}, has unknown well-known-type (data-type): ${r.type.type}`)}}parseSoundSampleDescription(e){const n={dataFormat:e.dataFormat,dataReferenceIndex:e.dataReferenceIndex};let r=0;const s=CE.get(e.description,r);return r+=CE.len,s.version===0||s.version===1?n.description=jQ.get(e.description,r):Ws(`Warning: sound-sample-description ${s} not implemented`),n}async parseChapterTrack(e,n,r){if(!e.sampleSize&&e.chunkOffsetTable.length!==e.sampleSizeTable.length)throw new Error("Expected equal chunk-offset-table & sample-size-table length.");const s=[];for(let i=0;i<e.chunkOffsetTable.length&&r>0;++i){const l=e.chunkOffsetTable[i]-this.tokenizer.position,c=e.sampleSize>0?e.sampleSize:e.sampleSizeTable[i];if(r-=l+c,r<0)throw new Error("Chapter chunk exceeding token length");await this.tokenizer.ignore(l);const u=await this.tokenizer.readToken(new AQ(c));Ws(`Chapter ${i+1}: ${u}`);const d={title:u,sampleOffset:this.findSampleOffset(n,this.tokenizer.position)};Ws(`Chapter title=${d.title}, offset=${d.sampleOffset}/${this.tracks[0].duration}`),s.push(d)}this.metadata.setFormat("chapters",s),await this.tokenizer.ignore(r)}findSampleOffset(e,n){let r=0;e.timeToSampleTable.forEach(i=>{r+=i.count*i.duration}),Ws(`Total duration=${r}`);let s=0;for(;s<e.chunkOffsetTable.length&&e.chunkOffsetTable[s]<n;)++s;return this.getChunkDuration(s+1,e)}getChunkDuration(e,n){let r=0,s=n.timeToSampleTable[r].count,i=n.timeToSampleTable[r].duration,o=1,l=this.getSamplesPerChunk(o,n.sampleToChunkTable),c=0;for(;o<e;){const u=Math.min(s,l);c+=u*i,s-=u,l-=u,l===0?(++o,l=this.getSamplesPerChunk(o,n.sampleToChunkTable)):(++r,s=n.timeToSampleTable[r].count,i=n.timeToSampleTable[r].duration)}return c}getSamplesPerChunk(e,n){for(let r=0;r<n.length-1;++r)if(e>=n[r].firstChunk&&e<n[r+1].firstChunk)return n[r].samplesPerChunk;return n[n.length-1].samplesPerChunk}}var AE;(function(t){t[t.not_set=0]="not_set",t[t.radio=1]="radio",t[t.audiophile=2]="audiophile"})(AE||(AE={}));var PE;(function(t){t[t.unspecified=0]="unspecified",t[t.engineer=1]="engineer",t[t.user=2]="user",t[t.automatic=3]="automatic",t[t.rms_average=4]="rms_average"})(PE||(PE={}));const FE={len:2,get:(t,e)=>{const n=ze(t,e,0,3),r=ze(t,e,6,1),s=ze(t,e,7,9)/10;if(n>0)return{type:ze(t,e,0,3),origin:ze(t,e,3,3),adjustment:r?-s:s}}},MQ={len:27,get:(t,e)=>{const n=xe.get(t,e+2);return{revision:ze(t,e,0,4),vbr_method:ze(t,e,4,4),lowpass_filter:100*Pe.get(t,e+1),track_peak:n===0?null:n/2**23,track_gain:FE.get(t,6),album_gain:FE.get(t,8),music_length:xe.get(t,e+20),music_crc:Pe.get(t,e+24),header_crc:et.get(t,e+24)}}},ME=new me(4,"ascii"),Sx=new me(6,"ascii"),DQ={len:4,get:(t,e)=>({frames:Nr(t,e,31),bytes:Nr(t,e,30),toc:Nr(t,e,29),vbrScale:Nr(t,e,28)})};async function LQ(t){const e=await t.readToken(DQ),n={numFrames:null,streamSize:null,vbrScale:null};if(e.frames&&(n.numFrames=await t.readToken(xe)),e.bytes&&(n.streamSize=await t.readToken(xe)),e.toc&&(n.toc=new Uint8Array(100),await t.readBuffer(n.toc)),e.vbrScale&&(n.vbrScale=await t.readToken(xe)),await t.peekToken(new me(4,"ascii"))==="LAME"){await t.ignore(4),n.lame={version:await t.readToken(new me(5,"ascii"))};const s=n.lame.version.match(/\d+.\d+/g);if(s!==null){const o=s[0].split(".").map(l=>Number.parseInt(l,10));o[0]>=3&&o[1]>=90&&(n.lame.extended=await t.readToken(MQ))}}return n}const Ir=st("music-metadata:parser:mpeg"),DE=1024,LE={AudioObjectTypes:["AAC Main","AAC LC","AAC SSR","AAC LTP"],SamplingFrequencies:[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350,null,null,-1]},OQ=[void 0,["front-center"],["front-left","front-right"],["front-center","front-left","front-right"],["front-center","front-left","front-right","back-center"],["front-center","front-left","front-right","back-left","back-right"],["front-center","front-left","front-right","back-left","back-right","LFE-channel"],["front-center","front-left","front-right","side-left","side-right","back-left","back-right","LFE-channel"]];class ln{constructor(e,n){this.bitrateIndex=null,this.sampRateFreqIndex=null,this.padding=null,this.privateBit=null,this.channelModeIndex=null,this.modeExtension=null,this.isOriginalMedia=null,this.version=null,this.bitrate=null,this.samplingRate=null,this.frameLength=0,this.versionIndex=ze(e,n+1,3,2),this.layer=ln.LayerDescription[ze(e,n+1,5,2)],this.versionIndex>1&&this.layer===0?this.parseAdtsHeader(e,n):this.parseMpegHeader(e,n),this.isProtectedByCRC=!Nr(e,n+1,7)}calcDuration(e){return this.samplingRate==null?null:e*this.calcSamplesPerFrame()/this.samplingRate}calcSamplesPerFrame(){return ln.samplesInFrameTable[this.version===1?0:1][this.layer]}calculateSideInfoLength(){if(this.layer!==3)return 2;if(this.channelModeIndex===3){if(this.version===1)return 17;if(this.version===2||this.version===2.5)return 9}else{if(this.version===1)return 32;if(this.version===2||this.version===2.5)return 17}return null}calcSlotSize(){return[null,4,1,1][this.layer]}parseMpegHeader(e,n){this.container="MPEG",this.bitrateIndex=ze(e,n+2,0,4),this.sampRateFreqIndex=ze(e,n+2,4,2),this.padding=Nr(e,n+2,6),this.privateBit=Nr(e,n+2,7),this.channelModeIndex=ze(e,n+3,0,2),this.modeExtension=ze(e,n+3,2,2),this.isCopyrighted=Nr(e,n+3,4),this.isOriginalMedia=Nr(e,n+3,5),this.emphasis=ze(e,n+3,7,2),this.version=ln.VersionID[this.versionIndex],this.channelMode=ln.ChannelMode[this.channelModeIndex],this.codec=`MPEG ${this.version} Layer ${this.layer}`;const r=this.calcBitrate();if(!r)throw new Error("Cannot determine bit-rate");if(this.bitrate=r*1e3,this.samplingRate=this.calcSamplingRate(),this.samplingRate==null)throw new Error("Cannot determine sampling-rate")}parseAdtsHeader(e,n){Ir("layer=0 => ADTS"),this.version=this.versionIndex===2?4:2,this.container=`ADTS/MPEG-${this.version}`;const r=ze(e,n+2,0,2);this.codec="AAC",this.codecProfile=LE.AudioObjectTypes[r],Ir(`MPEG-4 audio-codec=${this.codec}`);const s=ze(e,n+2,2,4);this.samplingRate=LE.SamplingFrequencies[s],Ir(`sampling-rate=${this.samplingRate}`);const i=ze(e,n+2,7,3);this.mp4ChannelConfig=OQ[i],Ir(`channel-config=${this.mp4ChannelConfig?this.mp4ChannelConfig.join("+"):"?"}`),this.frameLength=ze(e,n+3,6,2)<<11}calcBitrate(){if(this.bitrateIndex===0||this.bitrateIndex===15)return null;if(this.version&&this.bitrateIndex){const e=10*Math.floor(this.version)+this.layer;return ln.bitrate_index[this.bitrateIndex][e]}return null}calcSamplingRate(){return this.sampRateFreqIndex===3||this.version===null||this.sampRateFreqIndex==null?null:ln.sampling_rate_freq_index[this.version][this.sampRateFreqIndex]}}ln.SyncByte1=255;ln.SyncByte2=224;ln.VersionID=[2.5,null,2,1];ln.LayerDescription=[0,3,2,1];ln.ChannelMode=["stereo","joint_stereo","dual_channel","mono"];ln.bitrate_index={1:{11:32,12:32,13:32,21:32,22:8,23:8},2:{11:64,12:48,13:40,21:48,22:16,23:16},3:{11:96,12:56,13:48,21:56,22:24,23:24},4:{11:128,12:64,13:56,21:64,22:32,23:32},5:{11:160,12:80,13:64,21:80,22:40,23:40},6:{11:192,12:96,13:80,21:96,22:48,23:48},7:{11:224,12:112,13:96,21:112,22:56,23:56},8:{11:256,12:128,13:112,21:128,22:64,23:64},9:{11:288,12:160,13:128,21:144,22:80,23:80},10:{11:320,12:192,13:160,21:160,22:96,23:96},11:{11:352,12:224,13:192,21:176,22:112,23:112},12:{11:384,12:256,13:224,21:192,22:128,23:128},13:{11:416,12:320,13:256,21:224,22:144,23:144},14:{11:448,12:384,13:320,21:256,22:160,23:160}};ln.sampling_rate_freq_index={1:{0:44100,1:48e3,2:32e3},2:{0:22050,1:24e3,2:16e3},2.5:{0:11025,1:12e3,2:8e3}};ln.samplesInFrameTable=[[0,384,1152,1152],[0,384,1152,576]];const OE={len:4,get:(t,e)=>new ln(t,e)};function $Q(t){return`V${Math.floor((100-t)/10)}`}class zQ extends Xg{constructor(){super(...arguments),this.frameCount=0,this.syncFrameCount=-1,this.countSkipFrameData=0,this.totalDataLength=0,this.bitrates=[],this.offset=0,this.frame_size=0,this.crc=null,this.calculateEofDuration=!1,this.samplesPerFrame=null,this.buf_frame_header=new Uint8Array(4),this.mpegOffset=null,this.syncPeek={buf:new Uint8Array(DE),len:0}}async postId3v2Parse(){this.metadata.setFormat("lossless",!1);try{let e=!1;for(;!e;)await this.sync(),e=await this.parseCommonMpegHeader()}catch(e){if(e instanceof Pt){if(Ir("End-of-stream"),this.calculateEofDuration&&this.samplesPerFrame!==null){const n=this.frameCount*this.samplesPerFrame;if(this.metadata.setFormat("numberOfSamples",n),this.metadata.format.sampleRate){const r=n/this.metadata.format.sampleRate;Ir(`Calculate duration at EOF: ${r} sec.`,r),this.metadata.setFormat("duration",r)}}}else throw e}}finalize(){const e=this.metadata.format,n=!!this.metadata.native.ID3v1;if(this.mpegOffset!==null){if(e.duration&&this.tokenizer.fileInfo.size){const r=this.tokenizer.fileInfo.size-this.mpegOffset-(n?128:0);e.codecProfile&&e.codecProfile[0]==="V"&&this.metadata.setFormat("bitrate",r*8/e.duration)}else if(this.tokenizer.fileInfo.size&&e.codecProfile==="CBR"){const r=this.tokenizer.fileInfo.size-this.mpegOffset-(n?128:0);if(this.frame_size!==null&&this.samplesPerFrame!==null){const s=Math.round(r/this.frame_size)*this.samplesPerFrame;if(this.metadata.setFormat("numberOfSamples",s),e.sampleRate){const i=s/e.sampleRate;Ir("Calculate CBR duration based on file size: %s",i),this.metadata.setFormat("duration",i)}}}}}async sync(){let e=!1;for(;;){let n=0;if(this.syncPeek.len=await this.tokenizer.peekBuffer(this.syncPeek.buf,{length:DE,mayBeLess:!0}),this.syncPeek.len<=163)throw new Pt;for(;;){if(e&&(this.syncPeek.buf[n]&224)===224){this.buf_frame_header[0]=ln.SyncByte1,this.buf_frame_header[1]=this.syncPeek.buf[n],await this.tokenizer.ignore(n),Ir(`Sync at offset=${this.tokenizer.position-1}, frameCount=${this.frameCount}`),this.syncFrameCount===this.frameCount&&(Ir(`Re-synced MPEG stream, frameCount=${this.frameCount}`),this.frameCount=0,this.frame_size=0),this.syncFrameCount=this.frameCount;return}if(e=!1,n=this.syncPeek.buf.indexOf(ln.SyncByte1,n),n===-1){if(this.syncPeek.len<this.syncPeek.buf.length)throw new Pt;await this.tokenizer.ignore(this.syncPeek.len);break}++n,e=!0}}}async parseCommonMpegHeader(){this.frameCount===0&&(this.mpegOffset=this.tokenizer.position-1),await this.tokenizer.peekBuffer(this.buf_frame_header,{offset:1,length:3});let e;try{e=OE.get(this.buf_frame_header,0)}catch(n){if(await this.tokenizer.ignore(1),n instanceof Error)return this.metadata.addWarning(`Parse error: ${n.message}`),!1;throw n}return await this.tokenizer.ignore(3),this.metadata.setFormat("container",e.container),this.metadata.setFormat("codec",e.codec),this.metadata.setFormat("lossless",!1),this.metadata.setFormat("sampleRate",e.samplingRate),this.frameCount++,e.version!==null&&e.version>=2&&e.layer===0?this.parseAdts(e):this.parseAudioFrameHeader(e)}async parseAudioFrameHeader(e){this.metadata.setFormat("numberOfChannels",e.channelMode==="mono"?1:2),this.metadata.setFormat("bitrate",e.bitrate),this.frameCount<20*1e4&&Ir("offset=%s MP%s bitrate=%s sample-rate=%s",this.tokenizer.position-4,e.layer,e.bitrate,e.samplingRate);const n=e.calcSlotSize();if(n===null)throw new Error("invalid slot_size");const r=e.calcSamplesPerFrame();Ir(`samples_per_frame=${r}`);const s=r/8;if(e.bitrate!==null&&e.samplingRate!=null){const i=s*e.bitrate/e.samplingRate+(e.padding?n:0);this.frame_size=Math.floor(i)}if(this.audioFrameHeader=e,e.bitrate!==null&&this.bitrates.push(e.bitrate),this.frameCount===1)return this.offset=OE.len,await this.skipSideInformation(),!1;if(this.frameCount===3){if(this.areAllSame(this.bitrates)){if(this.samplesPerFrame=r,this.metadata.setFormat("codecProfile","CBR"),this.tokenizer.fileInfo.size)return!0}else if(this.metadata.format.duration)return!0;if(!this.options.duration)return!0}return this.options.duration&&this.frameCount===4&&(this.samplesPerFrame=r,this.calculateEofDuration=!0),this.offset=4,e.isProtectedByCRC?(await this.parseCrc(),!1):(await this.skipSideInformation(),!1)}async parseAdts(e){const n=new Uint8Array(3);if(await this.tokenizer.readBuffer(n),e.frameLength+=ze(n,0,0,11),this.totalDataLength+=e.frameLength,this.samplesPerFrame=1024,e.samplingRate!==null){const r=e.samplingRate/this.samplesPerFrame,i=8*(this.frameCount===0?0:this.totalDataLength/this.frameCount)*r+.5;this.metadata.setFormat("bitrate",i),Ir(`frame-count=${this.frameCount}, size=${e.frameLength} bytes, bit-rate=${i}`)}if(await this.tokenizer.ignore(e.frameLength>7?e.frameLength-7:1),this.frameCount===3)if(this.metadata.setFormat("codecProfile",e.codecProfile),e.mp4ChannelConfig&&this.metadata.setFormat("numberOfChannels",e.mp4ChannelConfig.length),this.options.duration)this.calculateEofDuration=!0;else return!0;return!1}async parseCrc(){return this.crc=await this.tokenizer.readNumber(Ci),this.offset+=2,this.skipSideInformation()}async skipSideInformation(){if(this.audioFrameHeader){const e=this.audioFrameHeader.calculateSideInfoLength();if(e!==null){await this.tokenizer.readToken(new ur(e)),this.offset+=e,await this.readXtraInfoHeader();return}}}async readXtraInfoHeader(){const e=await this.tokenizer.readToken(ME);switch(this.offset+=ME.len,e){case"Info":return this.metadata.setFormat("codecProfile","CBR"),this.readXingInfoHeader();case"Xing":{const r=await this.readXingInfoHeader();if(r.vbrScale!==null){const s=$Q(r.vbrScale);this.metadata.setFormat("codecProfile",s)}return null}case"Xtra":break;case"LAME":{const r=await this.tokenizer.readToken(Sx);if(this.frame_size!==null&&this.frame_size>=this.offset+Sx.len)return this.offset+=Sx.len,this.metadata.setFormat("tool",`LAME ${r}`),await this.skipFrameData(this.frame_size-this.offset),null;this.metadata.addWarning("Corrupt LAME header");break}}const n=this.frame_size-this.offset;return n<0?this.metadata.addWarning(`Frame ${this.frameCount}corrupt: negative frameDataLeft`):await this.skipFrameData(n),null}async readXingInfoHeader(){const e=this.tokenizer.position,n=await LQ(this.tokenizer);if(this.offset+=this.tokenizer.position-e,n.lame&&(this.metadata.setFormat("tool",`LAME ${wa(n.lame.version)}`),n.lame.extended&&(this.metadata.setFormat("trackPeakLevel",n.lame.extended.track_peak),n.lame.extended.track_gain&&this.metadata.setFormat("trackGain",n.lame.extended.track_gain.adjustment),n.lame.extended.album_gain&&this.metadata.setFormat("albumGain",n.lame.extended.album_gain.adjustment),this.metadata.setFormat("duration",n.lame.extended.music_length/1e3))),n.streamSize&&this.audioFrameHeader&&n.numFrames!==null){const s=this.audioFrameHeader.calcDuration(n.numFrames);return this.metadata.setFormat("duration",s),Ir("Get duration from Xing header: %s",this.metadata.format.duration),n}const r=this.frame_size-this.offset;return await this.skipFrameData(r),n}async skipFrameData(e){if(e<0)throw new Error("frame-data-left cannot be negative");await this.tokenizer.ignore(e),this.countSkipFrameData+=e}areAllSame(e){const n=e[0];return e.every(r=>r===n)}}const $E=st("music-metadata:parser:musepack:sv8"),BQ=new me(2,"latin1"),zE={len:5,get:(t,e)=>({crc:le.get(t,e),streamVersion:Pe.get(t,e+4)})},BE={len:2,get:(t,e)=>({sampleFrequency:[44100,48e3,37800,32e3][ze(t,e,0,3)],maxUsedBands:ze(t,e,3,5),channelCount:ze(t,e+1,0,4)+1,msUsed:Nr(t,e+1,4),audioBlockFrames:ze(t,e+1,5,3)})};class VQ{constructor(e){this.tokenizer=e}async readPacketHeader(){const e=await this.tokenizer.readToken(BQ),n=await this.readVariableSizeField();return{key:e,payloadLength:n.value-2-n.len}}async readStreamHeader(e){const n={};$E(`Reading SH at offset=${this.tokenizer.position}`);const r=await this.tokenizer.readToken(zE);e-=zE.len,Object.assign(n,r),$E(`SH.streamVersion = ${r.streamVersion}`);const s=await this.readVariableSizeField();e-=s.len,n.sampleCount=s.value;const i=await this.readVariableSizeField();e-=i.len,n.beginningOfSilence=i.value;const o=await this.tokenizer.readToken(BE);return e-=BE.len,Object.assign(n,o),await this.tokenizer.ignore(e),n}async readVariableSizeField(e=1,n=0){let r=await this.tokenizer.readNumber(Pe);return r&128?(r&=127,r+=n,this.readVariableSizeField(e+1,r<<7)):{len:e,value:n+r}}}const UQ=st("music-metadata:parser:musepack");class HQ extends Hr{constructor(){super(...arguments),this.audioLength=0}async parse(){if(await this.tokenizer.readToken(ft)!=="MPCK")throw new Error("Invalid Magic number");return this.metadata.setFormat("container","Musepack, SV8"),this.parsePacket()}async parsePacket(){const e=new VQ(this.tokenizer);do{const n=await e.readPacketHeader();switch(UQ(`packet-header key=${n.key}, payloadLength=${n.payloadLength}`),n.key){case"SH":{const r=await e.readStreamHeader(n.payloadLength);this.metadata.setFormat("numberOfSamples",r.sampleCount),this.metadata.setFormat("sampleRate",r.sampleFrequency),this.metadata.setFormat("duration",r.sampleCount/r.sampleFrequency),this.metadata.setFormat("numberOfChannels",r.channelCount);break}case"AP":this.audioLength+=n.payloadLength,await this.tokenizer.ignore(n.payloadLength);break;case"RG":case"EI":case"SO":case"ST":case"CT":await this.tokenizer.ignore(n.payloadLength);break;case"SE":return this.metadata.format.duration&&this.metadata.setFormat("bitrate",this.audioLength*8/this.metadata.format.duration),Ys.tryParseApeHeader(this.metadata,this.tokenizer,this.options);default:throw new Error(`Unexpected header: ${n.key}`)}}while(!0)}}class GQ{constructor(e){this.tokenizer=e,this.pos=0,this.dword=null}async read(e){for(;this.dword===null;)this.dword=await this.tokenizer.readToken(le);let n=this.dword;return this.pos+=e,this.pos<32?(n>>>=32-this.pos,n&(1<<e)-1):(this.pos-=32,this.pos===0?(this.dword=null,n&(1<<e)-1):(this.dword=await this.tokenizer.readToken(le),this.pos&&(n<<=this.pos,n|=this.dword>>>32-this.pos),n&(1<<e)-1))}async ignore(e){if(this.pos>0){const s=32-this.pos;this.dword=null,e-=s,this.pos=0}const n=e%32,r=(e-n)/32;return await this.tokenizer.ignore(r*4),this.read(n)}}const WQ={len:6*4,get:(t,e)=>{const n={signature:new TextDecoder("latin1").decode(t.subarray(e,e+3)),streamMinorVersion:ze(t,e+3,0,4),streamMajorVersion:ze(t,e+3,4,4),frameCount:le.get(t,e+4),maxLevel:Ke.get(t,e+8),sampleFrequency:[44100,48e3,37800,32e3][ze(t,e+10,0,2)],link:ze(t,e+10,2,2),profile:ze(t,e+10,4,4),maxBand:ze(t,e+11,0,6),intensityStereo:Nr(t,e+11,6),midSideStereo:Nr(t,e+11,7),titlePeak:Ke.get(t,e+12),titleGain:Ke.get(t,e+14),albumPeak:Ke.get(t,e+16),albumGain:Ke.get(t,e+18),lastFrameLength:le.get(t,e+20)>>>20&2047,trueGapless:Nr(t,e+23,0)};return n.lastFrameLength=n.trueGapless?le.get(t,20)>>>20&2047:0,n}},VE=st("music-metadata:parser:musepack");class qQ extends Hr{constructor(){super(...arguments),this.bitreader=null,this.audioLength=0,this.duration=null}async parse(){const e=await this.tokenizer.readToken(WQ);if(e.signature!=="MP+")throw new Error("Unexpected magic number");VE(`stream-version=${e.streamMajorVersion}.${e.streamMinorVersion}`),this.metadata.setFormat("container","Musepack, SV7"),this.metadata.setFormat("sampleRate",e.sampleFrequency);const n=1152*(e.frameCount-1)+e.lastFrameLength;this.metadata.setFormat("numberOfSamples",n),this.duration=n/e.sampleFrequency,this.metadata.setFormat("duration",this.duration),this.bitreader=new GQ(this.tokenizer),this.metadata.setFormat("numberOfChannels",e.midSideStereo||e.intensityStereo?2:1);const r=await this.bitreader.read(8);return this.metadata.setFormat("codec",(r/100).toFixed(2)),await this.skipAudioData(e.frameCount),VE(`End of audio stream, switching to APEv2, offset=${this.tokenizer.position}`),Ys.tryParseApeHeader(this.metadata,this.tokenizer,this.options)}async skipAudioData(e){for(;e-- >0;){const r=await this.bitreader.read(20);this.audioLength+=20+r,await this.bitreader.ignore(r)}const n=await this.bitreader.read(11);this.audioLength+=n,this.duration!==null&&this.metadata.setFormat("bitrate",this.audioLength/this.duration)}}const UE=st("music-metadata:parser:musepack");class KQ extends Xg{async postId3v2Parse(){const e=await this.tokenizer.peekToken(new me(3,"latin1"));let n;switch(e){case"MP+":{UE("Musepack stream-version 7"),n=new qQ;break}case"MPC":{UE("Musepack stream-version 8"),n=new HQ;break}default:throw new Error("Invalid Musepack signature prefix")}return n.init(this.metadata,this.tokenizer,this.options),n.parse()}}class QQ{constructor(e){if(this.len=e,e<19)throw new Error("ID-header-page 0 should be at least 19 bytes long")}get(e,n){return{magicSignature:new me(8,"ascii").get(e,n+0),version:Pe.get(e,n+8),channelCount:Pe.get(e,n+9),preSkip:Ke.get(e,n+10),inputSampleRate:le.get(e,n+12),outputGain:Ke.get(e,n+16),channelMapping:Pe.get(e,n+18)}}}class XQ extends nl{constructor(e,n,r){super(e,n),this.tokenizer=r,this.idHeader=null,this.lastPos=-1}parseFirstPage(e,n){if(this.metadata.setFormat("codec","Opus"),this.idHeader=new QQ(n.length).get(n,0),this.idHeader.magicSignature!=="OpusHead")throw new Error("Illegal ogg/Opus magic-signature");this.metadata.setFormat("sampleRate",this.idHeader.inputSampleRate),this.metadata.setFormat("numberOfChannels",this.idHeader.channelCount)}async parseFullPage(e){switch(new me(8,"ascii").get(e,0)){case"OpusTags":await this.parseUserCommentList(e,8),this.lastPos=this.tokenizer.position-e.length;break}}calculateDuration(e){if(this.metadata.format.sampleRate&&e.absoluteGranulePosition>=0){const n=e.absoluteGranulePosition-this.idHeader.preSkip;if(this.metadata.setFormat("numberOfSamples",n),this.metadata.setFormat("duration",n/48e3),this.lastPos!==-1&&this.tokenizer.fileInfo.size&&this.metadata.format.duration){const r=this.tokenizer.fileInfo.size-this.lastPos;this.metadata.setFormat("bitrate",8*r/this.metadata.format.duration)}}}}const YQ={len:80,get:(t,e)=>({speex:new me(8,"ascii").get(t,e+0),version:RN(new me(20,"ascii").get(t,e+8)),version_id:Rt.get(t,e+28),header_size:Rt.get(t,e+32),rate:Rt.get(t,e+36),mode:Rt.get(t,e+40),mode_bitstream_version:Rt.get(t,e+44),nb_channels:Rt.get(t,e+48),bitrate:Rt.get(t,e+52),frame_size:Rt.get(t,e+56),vbr:Rt.get(t,e+60),frames_per_packet:Rt.get(t,e+64),extra_headers:Rt.get(t,e+68),reserved1:Rt.get(t,e+72),reserved2:Rt.get(t,e+76)})},JQ=st("music-metadata:parser:ogg:speex");class ZQ extends nl{constructor(e,n,r){super(e,n),this.tokenizer=r}parseFirstPage(e,n){JQ("First Ogg/Speex page");const r=YQ.get(n,0);this.metadata.setFormat("codec",`Speex ${r.version}`),this.metadata.setFormat("numberOfChannels",r.nb_channels),this.metadata.setFormat("sampleRate",r.rate),r.bitrate!==-1&&this.metadata.setFormat("bitrate",r.bitrate)}}const eX={len:42,get:(t,e)=>({id:new me(7,"ascii").get(t,e),vmaj:Pe.get(t,e+7),vmin:Pe.get(t,e+8),vrev:Pe.get(t,e+9),vmbw:et.get(t,e+10),vmbh:et.get(t,e+17),nombr:tr.get(t,e+37),nqual:Pe.get(t,e+40)})},Ex=st("music-metadata:parser:ogg:theora");class tX{constructor(e,n,r){this.metadata=e,this.tokenizer=r}async parsePage(e,n){e.headerType.firstPage&&await this.parseFirstPage(e,n)}async flush(){Ex("flush")}calculateDuration(e){Ex("duration calculation not implemented")}async parseFirstPage(e,n){Ex("First Ogg/Theora page"),this.metadata.setFormat("codec","Theora");const r=eX.get(n,0);this.metadata.setFormat("bitrate",r.nombr)}}const xi=st("music-metadata:parser:ogg");class E_{static sum(e,n,r){const s=new DataView(e.buffer,0);let i=0;for(let o=n;o<n+r;++o)i+=s.getUint8(o);return i}constructor(e){this.len=e.page_segments}get(e,n){return{totalPageSize:E_.sum(e,n,this.len)}}}class Yg extends Hr{constructor(){super(...arguments),this.header=null,this.pageNumber=0,this.pageConsumer=null}async parse(){xi("pos=%s, parsePage()",this.tokenizer.position);try{let e;do{if(e=await this.tokenizer.readToken(Yg.Header),e.capturePattern!=="OggS")throw new Error("Invalid Ogg capture pattern");this.metadata.setFormat("container","Ogg"),this.header=e,this.pageNumber=e.pageSequenceNo,xi("page#=%s, Ogg.id=%s",e.pageSequenceNo,e.capturePattern);const n=await this.tokenizer.readToken(new E_(e));xi("totalPageSize=%s",n.totalPageSize);const r=await this.tokenizer.readToken(new ur(n.totalPageSize));if(xi("firstPage=%s, lastPage=%s, continued=%s",e.headerType.firstPage,e.headerType.lastPage,e.headerType.continued),e.headerType.firstPage){const s=new TextDecoder("ascii").decode(r.subarray(0,7));switch(s){case"vorbis":xi("Set page consumer to Ogg/Vorbis"),this.pageConsumer=new nl(this.metadata,this.options);break;case"OpusHea":xi("Set page consumer to Ogg/Opus"),this.pageConsumer=new XQ(this.metadata,this.options,this.tokenizer);break;case"Speex  ":xi("Set page consumer to Ogg/Speex"),this.pageConsumer=new ZQ(this.metadata,this.options,this.tokenizer);break;case"fishead":case"\0theora":xi("Set page consumer to Ogg/Theora"),this.pageConsumer=new tX(this.metadata,this.options,this.tokenizer);break;default:throw new Error(`gg audio-codec not recognized (id=${s})`)}}await this.pageConsumer.parsePage(e,r)}while(!e.headerType.lastPage)}catch(e){if(e instanceof Error)e instanceof Pt?(this.metadata.addWarning("Last OGG-page is not marked with last-page flag"),xi("End-of-stream"),this.metadata.addWarning("Last OGG-page is not marked with last-page flag"),this.header&&this.pageConsumer.calculateDuration(this.header)):e.message.startsWith("FourCC")&&this.pageNumber>0&&(this.metadata.addWarning("Invalid FourCC ID, maybe last OGG-page is not marked with last-page flag"),await this.pageConsumer.flush());else throw e}}}Yg.Header={len:27,get:(t,e)=>({capturePattern:ft.get(t,e),version:Pe.get(t,e+4),headerType:{continued:jt(t,e+5,0),firstPage:jt(t,e+5,1),lastPage:jt(t,e+5,2)},absoluteGranulePosition:Number(Xn.get(t,e+6)),streamSerialNumber:le.get(t,e+14),pageSequenceNo:le.get(t,e+18),pageChecksum:le.get(t,e+22),page_segments:Pe.get(t,e+26)})};const Au={len:8,get:(t,e)=>({chunkID:new me(4,"latin1").get(t,e),chunkSize:le.get(t,e+4)})};class nX{constructor(e){this.tagHeader=e,this.len=e.chunkSize,this.len+=this.len&1}get(e,n){return new me(this.tagHeader.chunkSize,"ascii").get(e,n)}}var Rv;(function(t){t[t.PCM=1]="PCM",t[t.ADPCM=2]="ADPCM",t[t.IEEE_FLOAT=3]="IEEE_FLOAT",t[t.MPEG_ADTS_AAC=5632]="MPEG_ADTS_AAC",t[t.MPEG_LOAS=5634]="MPEG_LOAS",t[t.RAW_AAC1=255]="RAW_AAC1",t[t.DOLBY_AC3_SPDIF=146]="DOLBY_AC3_SPDIF",t[t.DVM=8192]="DVM",t[t.RAW_SPORT=576]="RAW_SPORT",t[t.ESST_AC3=577]="ESST_AC3",t[t.DRM=9]="DRM",t[t.DTS2=8193]="DTS2",t[t.MPEG=80]="MPEG"})(Rv||(Rv={}));class rX{constructor(e){if(e.chunkSize<16)throw new Error("Invalid chunk size");this.len=e.chunkSize}get(e,n){return{wFormatTag:Ke.get(e,n),nChannels:Ke.get(e,n+2),nSamplesPerSec:le.get(e,n+4),nAvgBytesPerSec:le.get(e,n+8),nBlockAlign:Ke.get(e,n+12),wBitsPerSample:Ke.get(e,n+14)}}}class sX{constructor(e){if(e.chunkSize<4)throw new Error("Invalid fact chunk size.");this.len=e.chunkSize}get(e,n){return{dwSampleLength:le.get(e,n)}}}const HE={len:420,get:(t,e)=>({description:wa(new me(256,"ascii").get(t,e)).trim(),originator:wa(new me(32,"ascii").get(t,e+256)).trim(),originatorReference:wa(new me(32,"ascii").get(t,e+288)).trim(),originationDate:wa(new me(10,"ascii").get(t,e+320)).trim(),originationTime:wa(new me(8,"ascii").get(t,e+330)).trim(),timeReferenceLow:le.get(t,e+338),timeReferenceHigh:le.get(t,e+342),version:Ke.get(t,e+346),umid:new ur(64).get(t,e+348),loudnessValue:Ke.get(t,e+412),maxTruePeakLevel:Ke.get(t,e+414),maxMomentaryLoudness:Ke.get(t,e+416),maxShortTermLoudness:Ke.get(t,e+418)})},ha=st("music-metadata:parser:RIFF");class iX extends Hr{constructor(){super(...arguments),this.blockAlign=0}async parse(){const e=await this.tokenizer.readToken(Au);if(ha(`pos=${this.tokenizer.position}, parse: chunkID=${e.chunkID}`),e.chunkID==="RIFF")return this.parseRiffChunk(e.chunkSize).catch(n=>{if(!(n instanceof Pt))throw n})}async parseRiffChunk(e){const n=await this.tokenizer.readToken(ft);switch(this.metadata.setFormat("container",n),n){case"WAVE":return this.readWaveChunk(e-ft.len);default:throw new Error(`Unsupported RIFF format: RIFF/${n}`)}}async readWaveChunk(e){for(;e>=Au.len;){const n=await this.tokenizer.readToken(Au);switch(e-=Au.len+n.chunkSize,n.chunkSize>e&&this.metadata.addWarning("Data chunk size exceeds file size"),this.header=n,ha(`pos=${this.tokenizer.position}, readChunk: chunkID=RIFF/WAVE/${n.chunkID}`),n.chunkID){case"LIST":await this.parseListTag(n);break;case"fact":this.metadata.setFormat("lossless",!1),this.fact=await this.tokenizer.readToken(new sX(n));break;case"fmt ":{const r=await this.tokenizer.readToken(new rX(n));let s=Rv[r.wFormatTag];s||(ha(`WAVE/non-PCM format=${r.wFormatTag}`),s=`non-PCM (${r.wFormatTag})`),this.metadata.setFormat("codec",s),this.metadata.setFormat("bitsPerSample",r.wBitsPerSample),this.metadata.setFormat("sampleRate",r.nSamplesPerSec),this.metadata.setFormat("numberOfChannels",r.nChannels),this.metadata.setFormat("bitrate",r.nBlockAlign*r.nSamplesPerSec*8),this.blockAlign=r.nBlockAlign;break}case"id3 ":case"ID3 ":{const r=await this.tokenizer.readToken(new ur(n.chunkSize)),s=Fc(r);await new ks().parse(this.metadata,s,this.options);break}case"data":{this.metadata.format.lossless!==!1&&this.metadata.setFormat("lossless",!0);let r=n.chunkSize;if(this.tokenizer.fileInfo.size){const i=this.tokenizer.fileInfo.size-this.tokenizer.position;i<r&&(this.metadata.addWarning("data chunk length exceeding file length"),r=i)}const s=this.fact?this.fact.dwSampleLength:r===4294967295?void 0:r/this.blockAlign;s&&(this.metadata.setFormat("numberOfSamples",s),this.metadata.format.sampleRate&&this.metadata.setFormat("duration",s/this.metadata.format.sampleRate)),this.metadata.format.codec==="ADPCM"?this.metadata.setFormat("bitrate",352e3):this.metadata.format.sampleRate&&this.metadata.setFormat("bitrate",this.blockAlign*this.metadata.format.sampleRate*8),await this.tokenizer.ignore(n.chunkSize);break}case"bext":{const r=await this.tokenizer.readToken(HE);Object.keys(r).forEach(i=>{this.metadata.addTag("exif",`bext.${i}`,r[i])});const s=n.chunkSize-HE.len;await this.tokenizer.ignore(s);break}case"\0\0\0\0":ha(`Ignore padding chunk: RIFF/${n.chunkID} of ${n.chunkSize} bytes`),this.metadata.addWarning(`Ignore chunk: RIFF/${n.chunkID}`),await this.tokenizer.ignore(n.chunkSize);break;default:ha(`Ignore chunk: RIFF/${n.chunkID} of ${n.chunkSize} bytes`),this.metadata.addWarning(`Ignore chunk: RIFF/${n.chunkID}`),await this.tokenizer.ignore(n.chunkSize)}this.header.chunkSize%2===1&&(ha("Read odd padding byte"),await this.tokenizer.ignore(1))}}async parseListTag(e){const n=await this.tokenizer.readToken(new me(4,"latin1"));switch(ha("pos=%s, parseListTag: chunkID=RIFF/WAVE/LIST/%s",this.tokenizer.position,n),n){case"INFO":return this.parseRiffInfoTags(e.chunkSize-4);default:return this.metadata.addWarning(`Ignore chunk: RIFF/WAVE/LIST/${n}`),ha(`Ignoring chunkID=RIFF/WAVE/LIST/${n}`),this.tokenizer.ignore(e.chunkSize-4).then()}}async parseRiffInfoTags(e){for(;e>=8;){const n=await this.tokenizer.readToken(Au),r=new nX(n),s=await this.tokenizer.readToken(r);this.addTag(n.chunkID,wa(s)),e-=8+r.len}if(e!==0)throw new Error(`Illegal remaining size: ${e}`)}addTag(e,n){this.metadata.addTag("exif",e,n)}}const aX=[6e3,8e3,9600,11025,12e3,16e3,22050,24e3,32e3,44100,48e3,64e3,88200,96e3,192e3,-1],Ff={len:32,get:(t,e)=>{const n=le.get(t,e+24),r={BlockID:ft.get(t,e),blockSize:le.get(t,e+4),version:Ke.get(t,e+8),totalSamples:le.get(t,e+12),blockIndex:le.get(t,e+16),blockSamples:le.get(t,e+20),flags:{bitsPerSample:(1+vp(n,0,2))*8,isMono:Ks(n,2),isHybrid:Ks(n,3),isJointStereo:Ks(n,4),crossChannel:Ks(n,5),hybridNoiseShaping:Ks(n,6),floatingPoint:Ks(n,7),samplingRate:aX[vp(n,23,4)],isDSD:Ks(n,31)},crc:new ur(4).get(t,e+28)};return r.flags.isDSD&&(r.totalSamples*=8),r}},jx={len:1,get:(t,e)=>({functionId:vp(t[e],0,6),isOptional:Ks(t[e],5),isOddSize:Ks(t[e],6),largeBlock:Ks(t[e],7)})};function Ks(t,e){return vp(t,e,1)===1}function vp(t,e,n){return t>>>e&4294967295>>>32-n}const bo=st("music-metadata:parser:WavPack");class oX extends Hr{constructor(){super(...arguments),this.audioDataSize=0}async parse(){return this.audioDataSize=0,await this.parseWavPackBlocks(),Ys.tryParseApeHeader(this.metadata,this.tokenizer,this.options)}async parseWavPackBlocks(){do{if(await this.tokenizer.peekToken(ft)!=="wvpk")break;const n=await this.tokenizer.readToken(Ff);if(n.BlockID!=="wvpk")throw new Error("Invalid WavPack Block-ID");bo(`WavPack header blockIndex=${n.blockIndex}, len=${Ff.len}`),n.blockIndex===0&&!this.metadata.format.container&&(this.metadata.setFormat("container","WavPack"),this.metadata.setFormat("lossless",!n.flags.isHybrid),this.metadata.setFormat("bitsPerSample",n.flags.bitsPerSample),n.flags.isDSD||(this.metadata.setFormat("sampleRate",n.flags.samplingRate),this.metadata.setFormat("duration",n.totalSamples/n.flags.samplingRate)),this.metadata.setFormat("numberOfChannels",n.flags.isMono?1:2),this.metadata.setFormat("numberOfSamples",n.totalSamples),this.metadata.setFormat("codec",n.flags.isDSD?"DSD":"PCM"));const r=n.blockSize-(Ff.len-8);await(n.blockIndex===0?this.parseMetadataSubBlock(n,r):this.tokenizer.ignore(r)),n.blockSamples>0&&(this.audioDataSize+=n.blockSize)}while(!this.tokenizer.fileInfo.size||this.tokenizer.fileInfo.size-this.tokenizer.position>=Ff.len);this.metadata.format.duration&&this.metadata.setFormat("bitrate",this.audioDataSize*8/this.metadata.format.duration)}async parseMetadataSubBlock(e,n){let r=n;for(;r>jx.len;){const s=await this.tokenizer.readToken(jx),i=await this.tokenizer.readNumber(s.largeBlock?up:Pe),o=new Uint8Array(i*2-(s.isOddSize?1:0));switch(await this.tokenizer.readBuffer(o),bo(`Metadata Sub-Blocks functionId=0x${s.functionId.toString(16)}, id.largeBlock=${s.largeBlock},data-size=${o.length}`),s.functionId){case 0:break;case 14:{bo("ID_DSD_BLOCK");const l=1<<Pe.get(o,0),c=e.flags.samplingRate*l*8;if(!e.flags.isDSD)throw new Error("Only expect DSD block if DSD-flag is set");this.metadata.setFormat("sampleRate",c),this.metadata.setFormat("duration",e.totalSamples/c);break}case 36:bo("ID_ALT_TRAILER: trailer for non-wav files");break;case 38:this.metadata.setFormat("audioMD5",o);break;case 47:bo(`ID_BLOCK_CHECKSUM: checksum=${x_(o)}`);break;default:bo(`Ignore unsupported meta-sub-block-id functionId=0x${s.functionId.toString(16)}`);break}r-=jx.len+(s.largeBlock?up.len:Pe.len)+i*2,bo(`remainingLength=${r}`),s.isOddSize&&this.tokenizer.ignore(1)}if(r!==0)throw new Error("metadata-sub-block should fit it remaining length")}}const Mf={len:12,get:(t,e)=>({id:ft.get(t,e),size:Xn.get(t,e+4)})},lX={len:16,get:(t,e)=>({fileSize:dp.get(t,e),metadataPointer:dp.get(t,e+8)})};var GE;(function(t){t[t.mono=1]="mono",t[t.stereo=2]="stereo",t[t.channels=3]="channels",t[t.quad=4]="quad",t[t["4 channels"]=5]="4 channels",t[t["5 channels"]=6]="5 channels",t[t["5.1 channels"]=7]="5.1 channels"})(GE||(GE={}));const cX={len:40,get:(t,e)=>({formatVersion:Rt.get(t,e),formatID:Rt.get(t,e+4),channelType:Rt.get(t,e+8),channelNum:Rt.get(t,e+12),samplingFrequency:Rt.get(t,e+16),bitsPerSample:Rt.get(t,e+20),sampleCount:dp.get(t,e+24),blockSizePerChannel:Rt.get(t,e+32)})},kx=st("music-metadata:parser:DSF");class uX extends Xg{async postId3v2Parse(){const e=this.tokenizer.position,n=await this.tokenizer.readToken(Mf);if(n.id!=="DSD ")throw new Error("Invalid chunk signature");this.metadata.setFormat("container","DSF"),this.metadata.setFormat("lossless",!0);const r=await this.tokenizer.readToken(lX);if(r.metadataPointer===BigInt(0))kx("No ID3v2 tag present");else return kx(`expect ID3v2 at offset=${r.metadataPointer}`),await this.parseChunks(r.fileSize-n.size),await this.tokenizer.ignore(Number(r.metadataPointer)-this.tokenizer.position-e),new ks().parse(this.metadata,this.tokenizer,this.options)}async parseChunks(e){for(;e>=Mf.len;){const n=await this.tokenizer.readToken(Mf);switch(kx(`Parsing chunk name=${n.id} size=${n.size}`),n.id){case"fmt ":{const r=await this.tokenizer.readToken(cX);this.metadata.setFormat("numberOfChannels",r.channelNum),this.metadata.setFormat("sampleRate",r.samplingFrequency),this.metadata.setFormat("bitsPerSample",r.bitsPerSample),this.metadata.setFormat("numberOfSamples",r.sampleCount),this.metadata.setFormat("duration",Number(r.sampleCount)/r.samplingFrequency);const s=r.bitsPerSample*r.samplingFrequency*r.channelNum;this.metadata.setFormat("bitrate",s);return}default:this.tokenizer.ignore(Number(n.size)-Mf.len);break}e-=n.size}}}const Al={len:12,get:(t,e)=>({chunkID:ft.get(t,e),chunkSize:_N.get(t,e+4)})},Kn=st("music-metadata:parser:aiff");class dX extends Hr{async parse(){const e=await this.tokenizer.readToken(Al);if(e.chunkID!=="FRM8")throw new Error("Unexpected chunk-ID");const n=(await this.tokenizer.readToken(ft)).trim();switch(n){case"DSD":return this.metadata.setFormat("container",`DSDIFF/${n}`),this.metadata.setFormat("lossless",!0),this.readFmt8Chunks(e.chunkSize-BigInt(ft.len));default:throw new Error(`Unsupported DSDIFF type: ${n}`)}}async readFmt8Chunks(e){for(;e>=Al.len;){const n=await this.tokenizer.readToken(Al);Kn(`Chunk id=${n.chunkID}`),await this.readData(n),e-=BigInt(Al.len)+n.chunkSize}}async readData(e){Kn(`Reading data of chunk[ID=${e.chunkID}, size=${e.chunkSize}]`);const n=this.tokenizer.position;switch(e.chunkID.trim()){case"FVER":{const s=await this.tokenizer.readToken(le);Kn(`DSDIFF version=${s}`);break}case"PROP":{if(await this.tokenizer.readToken(ft)!=="SND ")throw new Error("Unexpected PROP-chunk ID");await this.handleSoundPropertyChunks(e.chunkSize-BigInt(ft.len));break}case"ID3":{const s=await this.tokenizer.readToken(new ur(Number(e.chunkSize))),i=Fc(s);await new ks().parse(this.metadata,i,this.options);break}case"DSD":this.metadata.format.numberOfChannels&&this.metadata.setFormat("numberOfSamples",Number(e.chunkSize*BigInt(8)/BigInt(this.metadata.format.numberOfChannels))),this.metadata.format.numberOfSamples&&this.metadata.format.sampleRate&&this.metadata.setFormat("duration",this.metadata.format.numberOfSamples/this.metadata.format.sampleRate);break;default:Kn(`Ignore chunk[ID=${e.chunkID}, size=${e.chunkSize}]`);break}const r=e.chunkSize-BigInt(this.tokenizer.position-n);r>0&&(Kn(`After Parsing chunk, remaining ${r} bytes`),await this.tokenizer.ignore(Number(r)))}async handleSoundPropertyChunks(e){for(Kn(`Parsing sound-property-chunks, remainingSize=${e}`);e>0;){const n=await this.tokenizer.readToken(Al);Kn(`Sound-property-chunk[ID=${n.chunkID}, size=${n.chunkSize}]`);const r=this.tokenizer.position;switch(n.chunkID.trim()){case"FS":{const i=await this.tokenizer.readToken(xe);this.metadata.setFormat("sampleRate",i);break}case"CHNL":{const i=await this.tokenizer.readToken(et);this.metadata.setFormat("numberOfChannels",i),await this.handleChannelChunks(n.chunkSize-BigInt(et.len));break}case"CMPR":{const i=(await this.tokenizer.readToken(ft)).trim(),o=await this.tokenizer.readToken(Pe),l=await this.tokenizer.readToken(new me(o,"ascii"));i==="DSD"&&(this.metadata.setFormat("lossless",!0),this.metadata.setFormat("bitsPerSample",1)),this.metadata.setFormat("codec",`${i} (${l})`);break}case"ABSS":{const i=await this.tokenizer.readToken(et),o=await this.tokenizer.readToken(Pe),l=await this.tokenizer.readToken(Pe),c=await this.tokenizer.readToken(xe);Kn(`ABSS ${i}:${o}:${l}.${c}`);break}case"LSCO":{const i=await this.tokenizer.readToken(et);Kn(`LSCO lsConfig=${i}`);break}default:Kn(`Unknown sound-property-chunk[ID=${n.chunkID}, size=${n.chunkSize}]`),await this.tokenizer.ignore(Number(n.chunkSize))}const s=n.chunkSize-BigInt(this.tokenizer.position-r);s>0&&(Kn(`After Parsing sound-property-chunk ${n.chunkSize}, remaining ${s} bytes`),await this.tokenizer.ignore(Number(s))),e-=BigInt(Al.len)+n.chunkSize,Kn(`Parsing sound-property-chunks, remainingSize=${e}`)}if(this.metadata.format.lossless&&this.metadata.format.sampleRate&&this.metadata.format.numberOfChannels&&this.metadata.format.bitsPerSample){const n=this.metadata.format.sampleRate*this.metadata.format.numberOfChannels*this.metadata.format.bitsPerSample;this.metadata.setFormat("bitrate",n)}}async handleChannelChunks(e){Kn(`Parsing channel-chunks, remainingSize=${e}`);const n=[];for(;e>=ft.len;){const r=await this.tokenizer.readToken(ft);Kn(`Channel[ID=${r}]`),n.push(r),e-=BigInt(ft.len)}return Kn(`Channels: ${n.join(", ")}`),n}}var H;(function(t){t[t.string=0]="string",t[t.uint=1]="uint",t[t.uid=2]="uid",t[t.bool=3]="bool",t[t.binary=4]="binary",t[t.float=5]="float"})(H||(H={}));const hX={name:"dtd",container:{440786851:{name:"ebml",container:{17030:{name:"ebmlVersion",value:H.uint},17143:{name:"ebmlReadVersion",value:H.uint},17138:{name:"ebmlMaxIDWidth",value:H.uint},17139:{name:"ebmlMaxSizeWidth",value:H.uint},17026:{name:"docType",value:H.string},17031:{name:"docTypeVersion",value:H.uint},17029:{name:"docTypeReadVersion",value:H.uint}}},408125543:{name:"segment",container:{290298740:{name:"seekHead",container:{19899:{name:"seek",multiple:!0,container:{21419:{name:"id",value:H.binary},21420:{name:"position",value:H.uint}}}}},357149030:{name:"info",container:{29604:{name:"uid",value:H.uid},29572:{name:"filename",value:H.string},3979555:{name:"prevUID",value:H.uid},3965867:{name:"prevFilename",value:H.string},4110627:{name:"nextUID",value:H.uid},4096955:{name:"nextFilename",value:H.string},2807729:{name:"timecodeScale",value:H.uint},17545:{name:"duration",value:H.float},17505:{name:"dateUTC",value:H.uint},31657:{name:"title",value:H.string},19840:{name:"muxingApp",value:H.string},22337:{name:"writingApp",value:H.string}}},524531317:{name:"cluster",multiple:!0,container:{231:{name:"timecode",value:H.uid},22743:{name:"silentTracks ",multiple:!0},167:{name:"position",value:H.uid},171:{name:"prevSize",value:H.uid},160:{name:"blockGroup"},163:{name:"simpleBlock"}}},374648427:{name:"tracks",container:{174:{name:"entries",multiple:!0,container:{215:{name:"trackNumber",value:H.uint},29637:{name:"uid",value:H.uid},131:{name:"trackType",value:H.uint},185:{name:"flagEnabled",value:H.bool},136:{name:"flagDefault",value:H.bool},21930:{name:"flagForced",value:H.bool},156:{name:"flagLacing",value:H.bool},28135:{name:"minCache",value:H.uint},28136:{name:"maxCache",value:H.uint},2352003:{name:"defaultDuration",value:H.uint},2306383:{name:"timecodeScale",value:H.float},21358:{name:"name",value:H.string},2274716:{name:"language",value:H.string},134:{name:"codecID",value:H.string},25506:{name:"codecPrivate",value:H.binary},2459272:{name:"codecName",value:H.string},3839639:{name:"codecSettings",value:H.string},3883072:{name:"codecInfoUrl",value:H.string},2536e3:{name:"codecDownloadUrl",value:H.string},170:{name:"codecDecodeAll",value:H.bool},28587:{name:"trackOverlay",value:H.uint},224:{name:"video",container:{154:{name:"flagInterlaced",value:H.bool},21432:{name:"stereoMode",value:H.uint},176:{name:"pixelWidth",value:H.uint},186:{name:"pixelHeight",value:H.uint},21680:{name:"displayWidth",value:H.uint},21690:{name:"displayHeight",value:H.uint},21683:{name:"aspectRatioType",value:H.uint},3061028:{name:"colourSpace",value:H.uint},3126563:{name:"gammaValue",value:H.float}}},225:{name:"audio",container:{181:{name:"samplingFrequency",value:H.float},30901:{name:"outputSamplingFrequency",value:H.float},159:{name:"channels",value:H.uint},148:{name:"channels",value:H.uint},32123:{name:"channelPositions",value:H.binary},25188:{name:"bitDepth",value:H.uint}}},28032:{name:"contentEncodings",container:{25152:{name:"contentEncoding",container:{20529:{name:"order",value:H.uint},20530:{name:"scope",value:H.bool},20531:{name:"type",value:H.uint},20532:{name:"contentEncoding",container:{16980:{name:"contentCompAlgo",value:H.uint},16981:{name:"contentCompSettings",value:H.binary}}},20533:{name:"contentEncoding",container:{18401:{name:"contentEncAlgo",value:H.uint},18402:{name:"contentEncKeyID",value:H.binary},18403:{name:"contentSignature ",value:H.binary},18404:{name:"ContentSigKeyID  ",value:H.binary},18405:{name:"contentSigAlgo ",value:H.uint},18406:{name:"contentSigHashAlgo ",value:H.uint}}},25188:{name:"bitDepth",value:H.uint}}}}}}}}},475249515:{name:"cues",container:{187:{name:"cuePoint",container:{179:{name:"cueTime",value:H.uid},183:{name:"positions",container:{247:{name:"track",value:H.uint},241:{name:"clusterPosition",value:H.uint},21368:{name:"blockNumber",value:H.uint},234:{name:"codecState",value:H.uint},219:{name:"reference",container:{150:{name:"time",value:H.uint},151:{name:"cluster",value:H.uint},21343:{name:"number",value:H.uint},235:{name:"codecState",value:H.uint}}},240:{name:"relativePosition",value:H.uint}}}}}}},423732329:{name:"attachments",container:{24999:{name:"attachedFiles",multiple:!0,container:{18046:{name:"description",value:H.string},18030:{name:"name",value:H.string},18016:{name:"mimeType",value:H.string},18012:{name:"data",value:H.binary},18094:{name:"uid",value:H.uid}}}}},272869232:{name:"chapters",container:{17849:{name:"editionEntry",container:{182:{name:"chapterAtom",container:{29636:{name:"uid",value:H.uid},145:{name:"timeStart",value:H.uint},146:{name:"timeEnd",value:H.uid},152:{name:"hidden",value:H.bool},17816:{name:"enabled",value:H.uid},143:{name:"track",container:{137:{name:"trackNumber",value:H.uid},128:{name:"display",container:{133:{name:"string",value:H.string},17276:{name:"language ",value:H.string},17278:{name:"country ",value:H.string}}}}}}}}}}},307544935:{name:"tags",container:{29555:{name:"tag",multiple:!0,container:{25536:{name:"target",container:{25541:{name:"tagTrackUID",value:H.uid},25540:{name:"tagChapterUID",value:H.uint},25542:{name:"tagAttachmentUID",value:H.uid},25546:{name:"targetType",value:H.string},26826:{name:"targetTypeValue",value:H.uint},25545:{name:"tagEditionUID",value:H.uid}}},26568:{name:"simpleTags",multiple:!0,container:{17827:{name:"name",value:H.string},17543:{name:"string",value:H.string},17541:{name:"binary",value:H.binary},17530:{name:"language",value:H.string},17531:{name:"languageIETF",value:H.string},17540:{name:"default",value:H.bool}}}}}}}}}}},Pl=st("music-metadata:parser:ebml");var Ts;(function(t){t[t.ReadNext=0]="ReadNext",t[t.IgnoreElement=2]="IgnoreElement",t[t.SkipSiblings=3]="SkipSiblings",t[t.TerminateParsing=4]="TerminateParsing",t[t.SkipElement=5]="SkipElement"})(Ts||(Ts={}));class fX{constructor(e){this.tokenizer=e,this.padding=0,this.parserMap=new Map,this.ebmlMaxIDLength=4,this.ebmlMaxSizeLength=8,this.parserMap.set(H.uint,n=>this.readUint(n)),this.parserMap.set(H.string,n=>this.readString(n)),this.parserMap.set(H.binary,n=>this.readBuffer(n)),this.parserMap.set(H.uid,async n=>this.readBuffer(n)),this.parserMap.set(H.bool,n=>this.readFlag(n)),this.parserMap.set(H.float,n=>this.readFloat(n))}async iterate(e,n,r){return this.parseContainer($N(e),n,r)}async parseContainer(e,n,r){const s={};for(;this.tokenizer.position<n;){let i;const o=this.tokenizer.position;try{i=await this.readElement()}catch(c){if(c instanceof Pt)break;throw c}const l=e.container[i.id];if(l)switch(r.startNext(l)){case Ts.ReadNext:if(i.id,Pl(`Read element: name=${Io(l)}{id=0x${i.id.toString(16)}, container=${!!l.container}} at position=${o}`),l.container){const u=await this.parseContainer(l,i.len>=0?this.tokenizer.position+i.len:-1,r);l.multiple?(s[l.name]||(s[l.name]=[]),s[l.name].push(u)):s[l.name]=u,await r.elementValue(l,u,o)}else{const u=this.parserMap.get(l.value);if(typeof u=="function"){const d=await u(i);s[l.name]=d,await r.elementValue(l,d,o)}}break;case Ts.SkipElement:Pl(`Go to next element: name=${Io(l)}, element.id=0x${i.id}, container=${!!l.container} at position=${o}`);break;case Ts.IgnoreElement:Pl(`Ignore element: name=${Io(l)}, element.id=0x${i.id}, container=${!!l.container} at position=${o}`),await this.tokenizer.ignore(i.len);break;case Ts.SkipSiblings:Pl(`Ignore remaining container, at: name=${Io(l)}, element.id=0x${i.id}, container=${!!l.container} at position=${o}`),await this.tokenizer.ignore(n-this.tokenizer.position);break;case Ts.TerminateParsing:return Pl(`Terminate parsing at element: name=${Io(l)}, element.id=0x${i.id}, container=${!!l.container} at position=${o}`),s}else switch(i.id){case 236:this.padding+=i.len,await this.tokenizer.ignore(i.len);break;default:Pl(`parseEbml: parent=${Io(e)}, unknown child: id=${i.id.toString(16)} at position=${o}`),this.padding+=i.len,await this.tokenizer.ignore(i.len)}}return s}async readVintData(e){const n=await this.tokenizer.peekNumber(Pe);let r=128,s=1;for(;!(n&r);){if(s>e)throw new Error("VINT value exceeding maximum size");++s,r>>=1}const i=new Uint8Array(s);return await this.tokenizer.readBuffer(i),i}async readElement(){const e=await this.readVintData(this.ebmlMaxIDLength),n=await this.readVintData(this.ebmlMaxSizeLength);return n[0]^=128>>n.length-1,{id:Tx(e,e.length),len:Tx(n,n.length)}}async readFloat(e){switch(e.len){case 0:return 0;case 4:return this.tokenizer.readNumber(bN);case 8:return this.tokenizer.readNumber(vv);case 10:return this.tokenizer.readNumber(vv);default:throw new Error(`Invalid IEEE-754 float length: ${e.len}`)}}async readFlag(e){return await this.readUint(e)===1}async readUint(e){const n=await this.readBuffer(e);return Tx(n,e.len)}async readString(e){return(await this.tokenizer.readToken(new me(e.len,"utf-8"))).replace(/\x00.*$/g,"")}async readBuffer(e){const n=new Uint8Array(e.len);return await this.tokenizer.readBuffer(n),n}}function Tx(t,e){return Number(mX(t,e))}function mX(t,e){const n=new Uint8Array(8),r=t.subarray(0,e);try{return n.set(r,8-e),p_.get(n,0)}catch{return BigInt(-1)}}function $N(t){return t.container&&Object.keys(t.container).map(e=>{const n=t.container[e];return n.id=Number.parseInt(e),n}).forEach(e=>{e.parent=t,$N(e)}),t}function Io(t){let e="";return t.parent&&t.parent.name!=="dtd"&&(e+=`${Io(t.parent)}/`),e+t.name}const Df=st("music-metadata:parser:matroska");class pX extends Hr{constructor(){super(...arguments),this.seekHeadOffset=0,this.flagUseIndexToSkipClusters=!1}init(e,n,r){return super.init(e,n,r),this.flagUseIndexToSkipClusters=r.mkvUseIndex??!1,this}async parse(){const e=this.tokenizer.fileInfo.size??Number.MAX_SAFE_INTEGER,n=new fX(this.tokenizer);Df("Initializing DTD end MatroskaIterator"),await n.iterate(hX,e,{startNext:r=>{switch(r.id){case 475249515:return Df(`Skip element: name=${r.name}, id=0x${r.id.toString(16)}`),Ts.IgnoreElement;case 524531317:if(this.flagUseIndexToSkipClusters&&this.seekHead){const s=this.seekHead.seek.find(i=>i.position+this.seekHeadOffset>this.tokenizer.position);if(s){const i=s.position+this.seekHeadOffset-this.tokenizer.position;return Df(`Use index to go to next position, ignoring ${i} bytes`),this.tokenizer.ignore(i),Ts.SkipElement}}return Ts.IgnoreElement;default:return Ts.ReadNext}},elementValue:async(r,s,i)=>{switch(Df(`Received: name=${r.name}, value=${s}`),r.id){case 17026:this.metadata.setFormat("container",`EBML/${s}`);break;case 290298740:this.seekHead=s,this.seekHeadOffset=i;break;case 357149030:{const o=s,l=o.timecodeScale?o.timecodeScale:1e6;if(typeof o.duration=="number"){const c=o.duration*l/1e9;await this.addTag("segment:title",o.title),this.metadata.setFormat("duration",Number(c))}}break;case 374648427:{const o=s;if(o!=null&&o.entries){o.entries.forEach(c=>{const u={codecName:c.codecID.replace("A_","").replace("V_",""),codecSettings:c.codecSettings,flagDefault:c.flagDefault,flagLacing:c.flagLacing,flagEnabled:c.flagEnabled,language:c.language,name:c.name,type:c.trackType,audio:c.audio,video:c.video};this.metadata.addStreamInfo(u)});const l=o.entries.filter(c=>c.trackType===el.audio).reduce((c,u)=>!c||u.flagDefault&&!c.flagDefault||u.trackNumber<c.trackNumber?u:c,null);l&&(this.metadata.setFormat("codec",l.codecID.replace("A_","")),this.metadata.setFormat("sampleRate",l.audio.samplingFrequency),this.metadata.setFormat("numberOfChannels",l.audio.channels))}}break;case 307544935:{const o=s;await Promise.all(o.tag.map(async l=>{const c=l.target,u=c!=null&&c.targetTypeValue?_v[c.targetTypeValue]:c!=null&&c.targetType?c.targetType:"track";await Promise.all(l.simpleTags.map(async d=>{const f=d.string?d.string:d.binary;await this.addTag(`${u}:${d.name}`,f)}))}))}break;case 423732329:{const o=s;await Promise.all(o.attachedFiles.filter(l=>l.mimeType.startsWith("image/")).map(l=>this.addTag("picture",{data:l.data,format:l.mimeType,description:l.description,name:l.name})))}break}}})}async addTag(e,n){await this.metadata.addTag("matroska",e,n)}}const wp=st("music-metadata:parser:factory");function gX(t){const e=y_.parse(t),n=mK(e.type);return{type:n.type,subtype:n.subtype,suffix:n.suffix,parameters:e.parameters}}async function xX(t,e){const{mimeType:n,path:r,url:s}=t.fileInfo,i=zN(n)||Nv(r)||Nv(s);return i||wp(`No parser found for MIME-type / extension: ${n}`),yX(t,i,e)}async function yX(t,e,n){if(!e){wp("Guess parser on content...");const i=new Uint8Array(4100);if(await t.peekBuffer(i,{mayBeLess:!0}),t.fileInfo.path&&(e=Nv(t.fileInfo.path)),!e){const o=await TN(i);if(!o)throw new Error("Failed to determine audio format");if(wp(`Guessed file type is mime=${o.mime}, extension=${o.ext}`),e=zN(o.mime),!e)throw new Error(`Guessed MIME-type not supported: ${o.mime}`)}}const r=await vX(e),s=new qK(n);return await r.init(s,t,n??{}).parse(),s.toCommonMetadata()}function Nv(t){if(!t)return;switch(wX(t).toLocaleLowerCase()||t){case".mp2":case".mp3":case".m2a":case".aac":return"mpeg";case".ape":return"apev2";case".mp4":case".m4a":case".m4b":case".m4pa":case".m4v":case".m4r":case".3gp":return"mp4";case".wma":case".wmv":case".asf":return"asf";case".flac":return"flac";case".ogg":case".ogv":case".oga":case".ogm":case".ogx":case".opus":case".spx":return"ogg";case".aif":case".aiff":case".aifc":return"aiff";case".wav":case".bwf":return"riff";case".wv":case".wvp":return"wavpack";case".mpc":return"musepack";case".dsf":return"dsf";case".dff":return"dsdiff";case".mka":case".mkv":case".mk3d":case".mks":case".webm":return"matroska"}}async function vX(t){switch(t){case"aiff":return new eQ;case"adts":case"mpeg":return new zQ;case"apev2":return new Ys;case"asf":return new hQ;case"dsf":return new uX;case"dsdiff":return new dX;case"flac":return new pQ;case"mp4":return new yp;case"musepack":return new KQ;case"ogg":return new Yg;case"riff":return new iX;case"wavpack":return new oX;case"matroska":return new pX;default:throw new Error(`Unknown parser type: ${t}`)}}function wX(t){const e=t.lastIndexOf(".");return e===-1?"":t.slice(e)}function zN(t){let e;if(!t)return;try{e=gX(t)}catch{wp(`Invalid HTTP Content-Type header value: ${t}`);return}const n=e.subtype.indexOf("x-")===0?e.subtype.substring(2):e.subtype;switch(e.type){case"audio":switch(n){case"mp3":case"mpeg":return"mpeg";case"aac":case"aacp":return"adts";case"flac":return"flac";case"ape":case"monkeys-audio":return"apev2";case"mp4":case"m4a":return"mp4";case"ogg":case"opus":case"speex":return"ogg";case"ms-wma":case"ms-wmv":case"ms-asf":return"asf";case"aiff":case"aif":case"aifc":return"aiff";case"vnd.wave":case"wav":case"wave":return"riff";case"wavpack":return"wavpack";case"musepack":return"musepack";case"matroska":case"webm":return"matroska";case"dsf":return"dsf"}break;case"video":switch(n){case"ms-asf":case"ms-wmv":return"asf";case"m4v":case"mp4":return"mp4";case"ogg":return"ogg";case"matroska":case"webm":return"matroska"}break;case"application":switch(n){case"vnd.ms-asf":return"asf";case"ogg":return"ogg"}break}}async function _X(t,e={}){const n={mimeType:t.type,size:t.size};return t instanceof File&&(n.path=t.name),bX(t.stream(),n,e)}function bX(t,e,n={}){return SX(wN(t,{fileInfo:typeof e=="string"?{mimeType:e}:e}),n)}function SX(t,e){return xX(t,e)}const BN=async t=>{var l;if(!t)return;const e=await _X(t);if(!e)return;const{common:{title:n,artist:r,picture:s},format:{duration:i}}=e;return Object.assign({},{name:n||t.name,singer:r||"...",duration:i||0,image:s?(l=s[0])==null?void 0:l.data:null})};function EX(t){const{resetPage:e}=yt(),{setErrorToast:n,setSuccessToast:r}=ne(),{songFile:s,imageFile:i,setImageFile:o,updateSongData:l,setSongData:c,songData:u,singers:d,song:f,genres:p,setGenres:g,setSingers:x,imageBlob:w,setImageBlob:v,audioRef:_,setSongFile:b,playlists:j,imageUrl:T,setImageUrl:R,setSong:M}=cs(),[k,E]=h.useState(!1),I=h.useRef(null),C=h.useMemo(()=>{var Ie,vt;if(t.variant==="add")return!0;if(!f||!u)return!1;if(u.name!==f.name||d.length!==f.singers.length||d.length!==f.singers.length||u.like!==f.like||p.length!==f.genres.length||u.release_year!==f.release_year||u.blurhash_encode!==f.blurhash_encode||((Ie=u.main_genre)==null?void 0:Ie.id)!==((vt=f.main_genre)==null?void 0:vt.id))return!0;const K=f.singers.map(ve=>ve.id),X=f.genres.map(ve=>ve.id),he=d.find(ve=>!K.includes(ve.id)),pe=p.find(ve=>!X.includes(ve.id));return!!he||!!pe},[u,f,d,p]),A=h.useMemo(()=>{const B=!!(u!=null&&u.name)&&!!d.length&&!!p.length&&!!u.release_year&&!!u.main_genre&&C;return t.variant==="add"?B:B&&(C||!!i||!!T)},[i,T,C,d,p,u]);console.log(C);const D=()=>{switch(t.variant){case"add":return dv({owner_email:t.ownerEmail,distributor:t.distributor,is_official:!0});case"edit":_.current&&(_.current.src=t.song.song_url);const{id:B,updated_at:K,...X}=t.song;return x(X.singers),g(X.genres),dv(X)}},P=()=>{var B,K;switch(t.variant){case"add":(B=I.current)==null||B.close(),setTimeout(()=>{b(void 0),o(void 0),v(void 0),R(""),x([]),g([]),c(D())},500);break;case"edit":(K=I.current)==null||K.close()}},ee=async()=>{if(!s)return;const B=await BN(s);if(B){const K={name:B.name+" "+B.singer,duration:Math.floor(B.duration),size:Math.floor(s.size/1024),image_url:""};if(B.image){const X=new Blob([B.image]);v(X),K.image_url=URL.createObjectURL(X)}l(K)}},_e=()=>{if(!u)return[];const B=[];return B.push(...Un(u.name).split(" ")),d.forEach(K=>B.push(...Un(K.name).split(" "))),B},He=()=>{const B={};d.forEach(X=>B[X.id]=!0);const K=p.map(X=>X.id);return{singer_map:B,genre_ids:K}},Be=async()=>{var B;try{if(!A||!u||!_.current)return;_.current.pause();const K={...u};E(!0);let X;switch((i||w||T)&&(f!=null&&f.image_file_id&&Vt({fileId:f.image_file_id,msg:">>> api: Delete image file"}),X=Yi({imageFile:i,blob:w,fromUrl:w?"":T})),t.variant){case"add":{if(!s)return;const he=gh({file:s,folder:"/songs/",msg:"upload song file"}),[pe,{fileId:Ie,url:vt}]=await Promise.all([X,he]),ve={singers:d,genres:p,song_url:vt,song_file_id:Ie,first_letter:Un(K.name.charAt(0)),...He(),meta:_e()};if(Object.assign(K,ve),pe){const Dt={image_url:pe.image_url,image_file_id:pe.image_file_id,blurhash_encode:pe.blurhash_encode};Object.assign(K,Dt)}const pn=await ai({collectionName:"Songs",data:K,msg:">>> api: set song doc"});if(j.length){const Dt=Ls(de),ge=async rn=>{const ht=await en({collectionName:"Playlists",id:rn});if(!ht.exists())return;const dr={song_ids:[...ht.data().song_ids,pn.id]};Dt.update(ht.ref,dr)};await Promise.all(j.map(rn=>ge(rn.id))),Dt.commit()}r(),(B=I.current)==null||B.open();break}case"edit":{if(!f)return;if(C){const he={singers:d,genres:p,first_letter:Un(K.name.charAt(0)),...He(),meta:_e()};Object.assign(K,he)}if(X){const{blurhash_encode:he,image_file_id:pe,image_url:Ie}=await X;Object.assign(K,{image_url:Ie,image_file_id:pe,blurhash_encode:he})}o(void 0),v(void 0),R(""),await Re({collectionName:"Songs",id:f.id,data:K}),l(K),M({...f,...K}),r("Song updated")}}e()}catch(K){console.log(K),n()}finally{E(!1)}};return h.useEffect(()=>{c(D())},[]),h.useEffect(()=>{!s||!_.current||(_.current.src=URL.createObjectURL(s),ee())},[s]),h.useEffect(()=>{!u||!_.current||(_.current.src=u.song_url)},[u==null?void 0:u.song_url]),h.useEffect(()=>{i&&l({image_url:URL.createObjectURL(i)})},[i]),h.useEffect(()=>{T&&l({image_url:T})},[T]),h.useEffect(()=>{if(!C)return;const B=K=>{K.preventDefault()};return window.addEventListener("beforeunload",B),()=>{window.removeEventListener("beforeunload",B)}},[C]),{isValidToSubmit:A,handleSubmit:Be,isFetching:k,updateSongData:l,handleCloseModalAfterFinished:P,modalRef:I,isChanged:C}}function jX({handleCloseModal:t,variant:e}){return a.jsxs(je,{children:[a.jsx(qe,{closeModal:t,title:"Successful"}),a.jsx(De,{width:"w-[120px]",className:"mx-auto w-[120px]",src:"https://zalo-api.zadn.vn/api/emoticon/sticker/webpc?eid=46985&size=130"}),a.jsxs("div",{className:"flex justify-center mt-5 space-x-2",children:[a.jsxs(J,{href:"/dashboard/song",children:[a.jsx(P1,{className:"w-6"}),a.jsx("span",{children:"Songs"})]}),a.jsxs(J,{onClick:t,children:[a.jsx(Xa,{className:"w-6"}),a.jsx("span",{children:e==="add"?"Add more":"Ok"})]})]})]})}function kX({closeModal:t}){const{songData:e,updateSongData:n}=cs(),[r,s]=h.useState(!1),[i,o]=h.useState({name:"",release_year:0,blurhash_encode:""}),l=d=>{o(f=>({...f,...d}))},c=()=>{!i.name||!i.release_year||(n(i),t())},u=async()=>{if(e!=null&&e.image_url)try{s(!0);const d=await fetch(e.image_url);if(!d.ok)throw new Error(`HTTP error! status: ${d.status}`);const f=await d.blob(),p=await VR(f);l({blurhash_encode:p.encode})}catch(d){console.log(d)}finally{s(!1)}};return h.useEffect(()=>{e&&o({name:e.name,release_year:e.release_year,blurhash_encode:e.blurhash_encode})},[e]),a.jsxs(je,{className:"w-[500px]",children:[a.jsx(qe,{title:"Edit song",closeModal:t}),a.jsxs("div",{className:"md:flex overflow-auto",children:[a.jsxs("div",{className:"flex-shrink-0 flex md:block md:w-[160px] [&>div]:p-2",children:[a.jsx("div",{className:"w-full",children:a.jsx(De,{className:"rounded-md",src:e==null?void 0:e.image_url})}),i.blurhash_encode&&a.jsx("div",{className:"w-full",children:a.jsx(_h,{className:"pt-[100%]",children:a.jsx(tu,{hash:i.blurhash_encode,className:"overflow-hidden rounded-md",height:"100%",width:"100%"})})})]}),a.jsxs("div",{className:"space-y-3 mt-5 md:mt-0 w-full",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx(kt,{children:"Name"}),a.jsx(En,{value:i==null?void 0:i.name,onChange:d=>l({name:d.target.value})})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx(kt,{children:"Release year"}),a.jsx(En,{type:"number",value:i.release_year+""||"0",onChange:d=>l({release_year:+d.target.value||0})})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx(kt,{children:"Blurhash"}),a.jsx(En,{type:"text",readOnly:!0,value:i.blurhash_encode}),a.jsxs(J,{disabled:r,onClick:u,className:"p-1.5 text-sm",size:"clear",children:[a.jsx(Me,{className:"w-5"}),a.jsx("span",{children:"Update"})]})]})]})]}),a.jsx("p",{className:"mt-6 text-right",children:a.jsx(J,{onClick:c,children:"Ok"})})]})}function TX({closeModal:t}){const{setErrorToast:e,setSuccessToast:n}=ne(),{song:r,updateSongData:s}=cs(),[i,o]=h.useState(),[l,c]=h.useState(!1);return{songFile:i,isFetching:l,submit:async()=>{try{if(!i||!r)return;c(!0),Vt({fileId:r.song_file_id});const{url:d,fileId:f}=await gh({file:i,folder:"/songs/"}),p={song_url:d,song_file_path:f};await Re({collectionName:"Songs",data:p,id:r.id}),s(p),n("Change song file successful"),t()}catch(d){console.log(d),e()}finally{c(!1)}},setSongFile:o}}function IX({closeModal:t}){const{songFile:e,setSongFile:n,isFetching:r,submit:s}=TX({closeModal:t}),i=h.useMemo(()=>e?URL.createObjectURL(e):"",[e]),o=l=>{var c;(c=l.target.files)!=null&&c.length&&n(l.target.files[0])};return a.jsx(a.Fragment,{children:a.jsxs(je,{children:[a.jsx(qe,{title:"Change song file",closeModal:t}),!e&&a.jsx("input",{accept:"audio",type:"file",onChange:o}),e&&a.jsx("audio",{src:i,controls:!0}),a.jsx("p",{className:"text-right",children:a.jsx(J,{loading:r,className:"mt-5",onClick:s,children:"Save"})})]})})}function CX(){const{shouldFetchUserSongs:t,lastDoc:e}=yt(),{setSuccessToast:n,setErrorToast:r}=ne(),[s,i]=h.useState(!1),o=Gt();return{actions:async c=>{try{i(!0);const u=Ls(de),d=gt(de,"Songs",c.song.id),f=await tn(Ee(Yo,ae("target_id","==",c.song.id)));switch(c.variant){case"delete":{if(u.delete(d),c.song.lyric_id){const p=gt(de,"Lyrics",c.song.lyric_id);u.delete(p)}f.empty||(console.log(`Delete ${f.docs.length} comments`),f.forEach(p=>u.delete(p.ref))),await Promise.all([u.commit(),UR(c.song)]),t.current=!0,e.current=void 0,n(`'${c.song.name}' deleted`),o("/dashboard/song");break}}}catch(u){console.log({message:u}),r()}finally{i(!1)}},isFetching:s}}function RX({isValidToSubmit:t}){const{song:e}=cs(),n=Gt(),{actions:r,isFetching:s}=CX(),[i,o]=h.useState(""),l=h.useRef(null),c=f=>{var p;o(f),(p=l.current)==null||p.open()},u=()=>{var f;return(f=l.current)==null?void 0:f.close()},d=()=>{e&&(t?c("navigate"):n(`/dashboard/lyric/${e.id}`))};return a.jsxs(a.Fragment,{children:[a.jsxs(J,{onClick:()=>c("edit"),size:"clear",children:[a.jsx(is,{}),a.jsx("span",{children:"Edit"})]}),a.jsxs(J,{onClick:d,size:"clear",children:[a.jsx(A6,{}),a.jsx("span",{children:"Lyric"})]}),a.jsxs(J,{onClick:()=>c("change-file"),size:"clear",children:[a.jsx(qi,{}),a.jsx("span",{children:"Change song file"})]}),a.jsxs(J,{onClick:()=>c("delete"),size:"clear",children:[a.jsx(xt,{}),a.jsx("span",{children:"Delete"})]}),a.jsxs(ie,{variant:"animation",ref:l,children:[i==="edit"&&a.jsx(kX,{closeModal:u}),i==="change-file"&&a.jsx(IX,{closeModal:u}),i==="delete"&&e&&a.jsx(hn,{loading:s,label:`Delete '${e.name}' ?`,desc:"This action cannot be undone",callback:()=>r({variant:"delete",song:e}),closeModal:u}),i==="navigate"&&e&&a.jsx(hn,{loading:s,label:"Dischard change ?",desc:"This action cannot be undone",callback:()=>n(`/dashboard/lyric/${e.id}`),closeModal:u})]})]})}function NX(){const[t,e]=h.useState([]),[n,r]=h.useState(""),[s,i]=h.useState(!1),[o,l]=h.useState(!1),{setErrorToast:c}=ne();return{isFetching:s,value:n,setValue:r,handleSubmit:async d=>{var f;try{if(d.preventDefault(),!n.trim()||s)return;i(!0);const p=await lI.get(`https://www.googleapis.com/customsearch/v1?q=${n}&cx=a473bfb57f63b40ef&key=${{}.VITE_GOOGLE_APIKEY}&searchType=image`);(f=p.data)!=null&&f.items&&(e(p.data.items),l(!0))}catch(p){console.log({message:p}),c()}finally{i(!1)}},items:t,showResult:o}}function AX({setUrl:t,...e}){const{isFetching:n,showResult:r,items:s,...i}=NX();return a.jsxs(ml,{...e,children:[a.jsx(Ji,{className:"mt-5 mb-3",...i}),n&&a.jsx(Rn,{}),!n&&r&&a.jsx(a.Fragment,{children:s.length?a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 overflow-auto",children:s.map((o,l)=>a.jsx("button",{onClick:()=>{var c;t&&t(o.link),(c=e.modalRef.current)==null||c.close()},className:"p-1",children:a.jsxs(_h,{className:"pt-[100%] rounded-md overflow-hidden",children:[a.jsx("img",{src:o.link,alt:"",className:"w-full h-full object-conver"}),a.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-[20%] bg-gradient-to-t from-black/80 to-transparent"}),a.jsxs("span",{className:"text-sm font-bold absolute bottom-0 left-1 text-white",children:[o.image.width," x ",o.image.height]})]})},l))}):a.jsx(Fe,{})})]})}function PX(){const{setImageFile:t,songData:e,setImageUrl:n,updateSongData:r,imageBlob:s,setImageBlob:i}=cs(),o=h.useRef(null);n_({setImageFileFromParent:t,modalRef:o});const l=()=>{e&&(i(void 0),URL.revokeObjectURL(e.image_url),r({image_url:""}))},c=d=>{e&&(i(void 0),URL.revokeObjectURL(e.image_url),t(d))},u=d=>{t(void 0),i(void 0),n(d)};return a.jsxs(a.Fragment,{children:[a.jsxs(J,{onClick:()=>{var d;return(d=o.current)==null?void 0:d.open()},children:[a.jsx(Ki,{}),a.jsx("span",{children:"Change image"})]}),s&&a.jsxs(J,{onClick:l,size:"clear",children:[a.jsx(ol,{}),a.jsx("span",{children:"Discard image"})]}),a.jsx(ie,{variant:"animation",ref:o,children:a.jsx(AX,{modalRef:o,setImageFile:c,title:"Song image",setUrl:u})})]})}function VN({title:t}){const{setSongFile:e}=cs(),n=h.useRef(null),r=s=>{var i,o,l;(o=(i=s.target)==null?void 0:i.files)!=null&&o.length&&e((l=s.target)==null?void 0:l.files[0])};return a.jsxs(a.Fragment,{children:[a.jsx("label",{ref:n,htmlFor:"song_upload",className:"hidden",children:a.jsx(M1,{className:"w-6"})}),a.jsx("input",{onChange:r,type:"file",multiple:!0,accept:"audio",id:"song_upload",className:"hidden"}),a.jsxs(J,{onClick:()=>{var s;return(s=n.current)==null?void 0:s.click()},children:[a.jsx(Vp,{}),a.jsx("span",{children:t})]})]})}function FX({isEdit:t,isValidToSubmit:e}){return a.jsx(a.Fragment,{children:a.jsxs(Yc,{className:"[&_span]:text-sm",children:[a.jsx(PX,{}),t&&a.jsx(RX,{isValidToSubmit:e}),!t&&a.jsx(VN,{title:"Change song file"})]})})}function Vd({children:t,className:e="space-y-1"}){return a.jsx(Zt,{className:"text-sm  [&_span]:font-semibold [&_span]:text-[#666] [&_span]:mr-1 "+e,children:t})}function MX(){const{songData:t,updateSongData:e,variant:n}=cs();return a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("div",{children:"Name"}),n.current==="edit"?a.jsx(oe,{variant:"h1",title:(t==null?void 0:t.name)||""}):a.jsx(En,{className:"mt-2",placeholder:"...",value:(t==null?void 0:t.name)||"",onChange:r=>e({name:r.target.value})})]}),a.jsxs("div",{children:[a.jsx("div",{children:"Release year"}),n.current==="edit"?a.jsx(oe,{variant:"h2",title:(t==null?void 0:t.release_year)+""}):a.jsx(En,{className:"mt-2 md:w-[50%]",placeholder:"...",type:"number",step:1,value:(t==null?void 0:t.release_year)+"",onChange:r=>isNaN(+r.target.value)?{}:e({release_year:+r.target.value})})]})]})}function DX(){const{playlists:t,setPlaylists:e,removePlaylist:n}=cs(),r=h.useRef(null),s=i=>{e(o=>[...o,...i])};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("div",{children:"Playlist"}),a.jsxs("div",{className:"-ml-2 flex flex-wrap",children:[t.map((i,o)=>a.jsxs(Fs,{children:[a.jsx("span",{children:i.name}),a.jsx("div",{className:"flex",children:a.jsx("button",{onClick:()=>n(o),children:a.jsx(xt,{className:"w-5"})})})]},o)),a.jsx(J,{onClick:()=>{var i;return(i=r.current)==null?void 0:i.open()},className:"mt-2 ml-2 h-[38px] w-[38px] justify-center",size:"clear",children:a.jsx(Wt,{className:"w-5"})})]})]}),a.jsx(ie,{variant:"animation",ref:r,children:a.jsx(Ag,{closeModal:()=>{var i;return(i=r.current)==null?void 0:i.close},current:t.map(i=>i.id),submit:i=>{var o;s(i),(o=r.current)==null||o.close()},isLoading:!1})})]})}function UN(t){const{songFile:e,songData:n,song:r,audioRef:s}=cs(),i=h.useRef(null),{isFetching:o,handleSubmit:l,isValidToSubmit:c,modalRef:u,handleCloseModalAfterFinished:d,updateSongData:f}=EX(t),{api:p,isFetching:g}=Wg(),x=h.useMemo(()=>r?r.updated_at:"",[r]),w=v=>{const _=v.target;i.current&&(i.current.innerText=`${_.naturalWidth} x ${_.naturalHeight}`)};return h.useEffect(()=>{p()}),a.jsxs(a.Fragment,{children:[g?a.jsx(Ye,{children:a.jsx(Rn,{})}):a.jsx(a.Fragment,{children:!e&&t.variant==="add"&&a.jsx(Ye,{children:a.jsx(Yc,{children:a.jsx(VN,{title:"Upload song file"})})})}),a.jsxs("div",{className:`w-full md:max-w-[800px] md:mx-auto ${t.variant==="add"&&(e?"":"hidden")}`,children:[a.jsx("audio",{ref:s,className:"hidden"}),a.jsxs("div",{className:`relative mt-5 md:flex md:space-x-5 ${Oa(o,"disable")}`,children:[a.jsxs("div",{className:"flex flex-col items-center md:w-1/3 md:block space-y-3",children:[a.jsx("div",{className:"max-w-[200px] w-full aspect-[1/1]  rounded-lg overflow-hidden",children:a.jsx(De,{className:"object-cover h-full",blurHashEncode:n==null?void 0:n.blurhash_encode,src:n==null?void 0:n.image_url,onLoad:w})}),a.jsxs("div",{className:"flex md:block mt-5",children:[a.jsxs(Vd,{children:[t.variant==="add"&&a.jsx(a.Fragment,{children:a.jsxs("p",{children:[a.jsx("span",{children:"Image:"}),(n==null?void 0:n.image_url)&&a.jsx("span",{ref:i,className:"!text-[--text-cl]"})]})}),t.variant==="edit"&&a.jsxs(a.Fragment,{children:[a.jsxs("p",{children:[a.jsx("span",{children:"Total plays:"}),n==null?void 0:n.today_play]}),a.jsxs("p",{children:[a.jsx("span",{children:"Week plays:"}),n==null?void 0:n.week_play]}),a.jsxs("p",{children:[a.jsx("span",{children:"Today plays:"}),n==null?void 0:n.today_play]}),a.jsxs("p",{children:[a.jsx("span",{children:"Ranking:"}),n==null?void 0:n.last_week_rank]}),a.jsx(Pg,{init:(r==null?void 0:r.like)||0,loading:!1,submit:(v,_)=>{f({like:v}),_()}}),a.jsxs("p",{children:[a.jsx("span",{children:"Comments:"}),Ms((n==null?void 0:n.comment)||0)]}),a.jsxs("p",{children:[a.jsx("span",{children:"Last listen:"}),Pc(n==null?void 0:n.last_active)]}),a.jsxs("p",{children:[a.jsx("span",{children:"Image:"}),a.jsx("span",{ref:i,className:"!text-[--text-cl]"})]}),a.jsxs("p",{children:[a.jsx("span",{children:"Last update:"}),Pc(x)]})]})]}),a.jsx("div",{className:"ml-3 md:ml-0 md:mt-3",children:a.jsx(FX,{isValidToSubmit:c,isEdit:t.variant==="edit"})})]})]}),a.jsxs("div",{className:"mt-5 md:mt-0 space-y-5 flex-grow",children:[a.jsx(Zt,{children:s.current&&a.jsx(vq,{audioEle:s.current})}),a.jsxs("div",{children:[a.jsx(oe,{variant:"h2",className:"mb-3",title:"Info"}),a.jsxs(Zt,{className:"space-y-5",children:[a.jsx(MX,{}),t.variant==="add"&&a.jsx(DX,{}),a.jsx(yq,{}),a.jsx(Eq,{})]})]})]})]}),a.jsx("p",{className:"text-center mt-5",children:a.jsxs(J,{onClick:l,disabled:!c,loading:o,children:[a.jsx(dh,{className:"w-6"}),a.jsx("span",{children:"Save"})]})})]}),a.jsx(ie,{persisted:t.variant==="add",ref:u,variant:"animation",children:a.jsx(jX,{variant:t.variant,handleCloseModal:d})})]})}function LX(){const{user:t}=ye();if(t)return a.jsxs(a.Fragment,{children:[a.jsx(oe,{className:"mb-5",title:"Add Song"}),a.jsx(UN,{distributor:t.display_name,ownerEmail:t.email,variant:"add"})]})}function OX(){const[t,e]=h.useState(!0),[n,r]=h.useState(),s=h.useRef(!1),i=Gt(),{setErrorToast:o}=ne();return{song:n,isFetching:t,getSong:async c=>{try{const u=await en({collectionName:"Songs",id:c,msg:"useGetSong, Get song doc"});if(!u.exists())return i("/dashboard/song");const d={...u.data(),id:u.id,queue_id:""};if(!d.is_official)return i("/dashboard/song");r(d)}catch(u){console.log(u),o()}finally{e(!1)}},ranEffect:s}}function $X(){const{getSong:t,isFetching:e,song:n,ranEffect:r}=OX(),{variant:s,setSong:i}=cs(),o=Wi();return h.useEffect(()=>{if(!r.current){if(s.current="edit",r.current=!0,!o.songId)return;t(o.songId)}},[]),h.useEffect(()=>{n&&i(n)},[n]),e?a.jsx(Ye,{children:a.jsx(Rn,{})}):n?a.jsxs(a.Fragment,{children:[a.jsx(oe,{className:"mb-5",title:"Song Detail"}),a.jsx(UN,{song:n,variant:"edit"})]}):a.jsx(Ye,{children:a.jsx(Fe,{})})}const zX=["All","Result"];function BX(){const{setPlaylists:t,lastDoc:e,PAGE_SIZE:n,setHasMore:r,shouldGetPlaylists:s}=xh(),[i,o]=h.useState(""),[l,c]=h.useState(!0),[u,d]=h.useState("All"),[f,p]=h.useState([]),{setErrorToast:g}=ne(),x=async v=>{try{if(v.preventDefault(),l)return;c(!0);const _=Rr(er,[ae("is_official","==",!0)],i),b=await wr(_);p(b),d("Result")}catch(_){console.log({message:_}),g()}finally{c(!1)}},w=async()=>{try{c(!0);const v=e.current?Ee(er,ae("is_official","==",!0),ae("is_album","==",!1),dn("updated_at","desc"),xg(e.current),kn(n)):Ee(er,ae("is_official","==",!0),ae("is_album","==",!1),dn("updated_at","desc"),kn(n)),_=await tn(v),b=_.docs.map(j=>({...j.data(),id:j.id}));e.current?t(j=>[...j,...b]):t(b),b.length<n?r(!1):e.current=_.docs[n-1]}catch(v){console.log({message:v}),g()}finally{c(!1)}};return h.useEffect(()=>{s.current?(s.current=!1,w()):c(!1)},[u]),{isFetching:l,value:i,setValue:o,handleSubmit:x,getPlaylists:w,tab:u,searchResult:f,setTab:d,tabs:zX}}function VX(){const{user:t}=ye(),{setPlaylists:e}=xh(),{addPlaylist:n,isFetching:r}=Tg(),s=h.useRef(null),i=()=>{var l;return(l=s.current)==null?void 0:l.close()},o=async(l,c)=>{l.is_official=!0;const u=await n({variant:"add",playlist:l,imageFile:c},{push:!1});u&&e(d=>[u,...d]),i()};if(t)return a.jsxs(a.Fragment,{children:[a.jsxs(J,{onClick:()=>{var l;return(l=s.current)==null?void 0:l.open()},className:"self-start p-1.5 ml-5",size:"clear",color:"primary",children:[a.jsx(Vi,{className:"w-6"}),a.jsx("div",{className:"hidden md:block",children:"Add new playlist"})]}),a.jsx(ie,{ref:s,variant:"animation",children:a.jsx(je,{className:"w-[600px]",children:a.jsx(Zc,{modalRef:s,isLoading:r,variant:"add",user:t,submit:o})})})]})}function UX(){const{playlists:t,hasMore:e}=xh(),{isFetching:n,getPlaylists:r,searchResult:s,tab:i,tabs:o,setTab:l,...c}=BX(),u=h.useMemo(()=>i==="All"?t:s,[i,t,s]);return a.jsxs(a.Fragment,{children:[a.jsx(oe,{title:"Playlists"}),a.jsxs("div",{className:"flex justify-between mt-3",children:[a.jsx(Ji,{loading:i==="Result"&&n,...c}),a.jsx(VX,{})]}),a.jsx("div",{className:"mt-5 w-fit self-start",children:a.jsx(Ur,{disable:i==="All",tabs:o,render:d=>d,tab:i,setTab:l})}),a.jsx("div",{className:"mt-3",children:a.jsx(zs,{colList:["Name","Like",""],children:u.length?a.jsxs(a.Fragment,{children:[u.map((d,f)=>a.jsxs("tr",{children:[a.jsx("td",{children:a.jsx(se,{className:"hover:underline",to:`/dashboard/playlist/${d.id}`,children:d.name})}),a.jsx("td",{children:Ms(d.like)}),a.jsx("td",{children:"-"})]},f)),i==="All"&&n&&a.jsx("tr",{className:"no-hover border-none",children:a.jsx("td",{colSpan:9,children:a.jsx(Me,{className:"animate-spin w-7 mx-auto"})})}),i==="All"&&a.jsx("tr",{className:"no-hover",children:a.jsx("td",{colSpan:9,className:"text-center hover:bg-none",children:a.jsx(J,{disabled:!e,onClick:r,children:"Get more"})})})]}):a.jsx("tr",{children:a.jsx("td",{colSpan:4,children:a.jsx(Fe,{})})})})})]})}const HX=["Newest","Result"];function GX(){const{uploadedSongs:t,setUploadedSongs:e,shouldFetchUserSongs:n,lastDoc:r,PAGE_SIZE:s,setHasMore:i}=yt(),[o,l]=h.useState("Newest"),[c,u]=h.useState([]),[d,f]=h.useState(""),[p,g]=h.useState(!1),{setErrorToast:x}=ne(),w=async()=>{try{g(!0),i(j=>r.current&&!j?(r.current=void 0,!j):j);const _=Ee(fn,ae("is_official","==",!0),dn("updated_at","desc"),kn(s)),b=await Cn(_);e(b)}catch(_){console.log(_)}finally{g(!1)}},v=async _=>{try{_.preventDefault(),g(!0),l("Result");const b=Rr(fn,[ae("is_official","==",!0)],d),j=await Cn(b);u(j)}catch(b){console.log({message:b}),x()}finally{g(!1)}};return h.useEffect(()=>{n.current&&(n.current=!1,w())},[]),{isFetching:p,value:d,getNewestSongs:w,result:c,uploadedSongs:t,setValue:f,handleSubmit:v,tabs:HX,tab:o,setTab:l}}function WX({closeModal:t,submit:e,isLoading:n,current:r}){const{uploadedSongs:s,result:i,getNewestSongs:o,isFetching:l,setTab:c,tabs:u,tab:d,...f}=GX(),{selectedSongs:p,selectSong:g}=dl(),x=async()=>{p.length&&(e(p),t())},w={col:"md:w-1/2 flex-1 flex flex-col px-2 overflow-hidden",box:"rounded-lg bg-[--a-5-cl] p-2",songItem:"rounded-md w-full p-1 text-sm font-semibold text-left hover:bg-[--a-5-cl]"},v=_=>_.length?_.map((b,j)=>{const T=r.includes(b.id);return a.jsx("button",{onClick:()=>g(b),className:`${w.songItem} ${T||p.find(R=>R.id===b.id)?"text-[--primary-cl]":""} `,children:b.name},j)}):a.jsx(Fe,{variant:"less"});return a.jsx(a.Fragment,{children:a.jsxs(je,{className:"w-[600px] min-h-[400px]",children:[a.jsx(qe,{closeModal:t,title:"Add songs"}),a.jsx(Ji,{className:"w-fit",...f}),a.jsxs("div",{className:"flex-grow flex flex-col md:flex-row -mx-2 overflow-hidden mt-3",children:[a.jsxs("div",{className:`${w.col}`,children:[a.jsx(Ur,{className:"w-fit mb-1",buttonClasses:"[&_button]:px-3 [&_button]:py-1/2",tabs:u,setTab:c,disable:d==="Newest",tab:d,render:_=>_}),a.jsx("div",{className:`${w.box} flex-grow overflow-auto`,children:l?a.jsx(Rn,{className:"h-full"}):a.jsx(a.Fragment,{children:d==="Result"?v(i):a.jsxs(a.Fragment,{children:[v(s),a.jsx("p",{className:"text-center mt-3",children:a.jsx(J,{onClick:o,size:"clear",className:"p-1",children:a.jsx(Me,{className:"w-5"})})})]})})})]}),a.jsxs("div",{className:`${w.col} mt-3 md:mt-0`,children:[a.jsx(kt,{className:"mb-1 md:h-[36px]",children:"Selected"}),a.jsx("div",{className:`${w.box} flex-grow overflow-auto`,children:v(p)})]})]}),a.jsx("p",{className:"text-right mt-3 flex-shrink-0",children:a.jsxs(J,{disabled:!p.length,loading:n,onClick:x,children:[a.jsx(Xa,{className:"w-6"}),a.jsx("span",{children:"Add"})]})}),n&&a.jsx(ea,{})]})})}function j_(t){return a.jsx(Os,{children:a.jsx(WX,{...t})})}function qX(){const{songs:t}=_g(),[e,n]=h.useState(""),r=h.useRef(null),{action:s,playlist:i,isFetching:o}=Cg(),l=f=>{var p,g;n(f),e==="add-song-to-playlist"&&((p=r.current)==null||p.setModalPersist(!0)),(g=r.current)==null||g.open()},c=()=>{var f;return(f=r.current)==null?void 0:f.close()},u=async f=>{await s(f),c()},d=()=>{switch(e){case"":return a.jsx(a.Fragment,{});case"edit":return i?a.jsx(a.Fragment,{children:a.jsx(je,{className:"w-[600px]",children:a.jsx(Zc,{submit:(f,p)=>u({variant:"edit-playlist",playlist:f,imageFile:p}),variant:"edit",isLoading:o,playlist:i,modalRef:r})})}):"Playlist is undefined";case"delete":return a.jsx(hn,{loading:o,label:"Delete playlist ?",callback:()=>u({variant:"delete-playlist"}),closeModal:c});case"add-song-to-playlist":return a.jsx(j_,{isLoading:o,submit:f=>u({variant:"add-songs",songs:f}),closeModal:c,current:t.map(f=>f.id)})}};return a.jsxs(a.Fragment,{children:[a.jsxs(Yc,{children:[a.jsxs(J,{onClick:()=>l("edit"),size:"clear",children:[a.jsx(is,{}),a.jsx("span",{children:"Edit"})]}),a.jsxs(J,{onClick:()=>l("delete"),size:"clear",children:[a.jsx(xt,{}),a.jsx("span",{children:"Delete"})]}),a.jsxs(J,{onClick:()=>l("add-song-to-playlist"),size:"clear",children:[a.jsx(AH,{}),a.jsx("span",{children:"Add song"})]})]}),a.jsx(ie,{variant:"animation",ref:r,children:d()})]})}function KX(){const[t,e]=h.useState(!0),{setSongs:n,setPlaylist:r}=_g(),s=h.useRef(!1),i=Wi(),o=Gt(),{setErrorToast:l}=ne(),c=async()=>{try{if(!i.id)return;const u=await en({collectionName:"Playlists",id:i.id,msg:"useGetPlaylist, get playlist doc"});if(!u.exists())return o("/dashboard/playlist");const d={...u.data(),id:u.id};if(!d.is_official)return o("/dashboard/playlist");const f=await GR(d.song_ids,d.id);n(f),r(d)}catch(u){console.log(u),l()}finally{e(!1)}};return h.useEffect(()=>{s.current||(s.current=!0,c())},[]),{isFetching:t}}function QX({singer:t}){const{action:e}=Cg();return a.jsxs(a.Fragment,{children:[a.jsx(se,{className:"hover:underline",to:`/dashboard/singer/${t.id}`,children:t.name}),a.jsx("div",{children:a.jsx("button",{onClick:()=>e({variant:"remove-singer",singer:t}),children:a.jsx(xt,{className:"w-5"})})})]})}function XX(){const{playlist:t,songs:e}=_g(),{isFetching:n}=KX(),{action:r,isFetching:s}=Cg(),i=async(l,c)=>{await r({variant:"edit-playlist",playlist:{like:l,updated_at:pt()}}),c()},o=h.useMemo(()=>t==null?void 0:t.updated_at,[t==null?void 0:t.id]);return n?a.jsx(Ye,{children:a.jsx(Rn,{})}):t?a.jsxs(a.Fragment,{children:[a.jsx(oe,{title:"Edit playlist",className:"mb-8"}),a.jsxs("div",{className:"md:flex md:-mx-3",children:[a.jsxs("div",{className:"space-y-3 md:px-3",children:[a.jsx("div",{className:"w-[200px] h-[200px] mx-auto rounded-md overflow-hidden",children:a.jsx(De,{className:"object-cover h-full",blurHashEncode:t.blurhash_encode,src:t.image_url})}),a.jsx(oe,{variant:"h2",title:t.name}),a.jsxs(Vd,{children:[a.jsxs("p",{children:[a.jsx("span",{children:"Public:"}),t.is_public?"Public":"Private"]}),a.jsxs("p",{children:[a.jsx("span",{children:"Songs:"}),e.length," songs"]}),a.jsxs("p",{children:[a.jsx("span",{children:"Comments:"}),Ms(t.comment)]}),a.jsx(Pg,{init:t.like,loading:s,submit:i}),a.jsxs("p",{children:[a.jsx("span",{children:"Last update:"}),o?Pc(o):""]})]}),a.jsx(qX,{})]}),a.jsxs("div",{className:"w-full mt-3 md:mt-0 md:w-3/4 md:px-3",children:[a.jsx(oe,{variant:"h3",title:"Singers"}),a.jsx(Zt,{className:"mt-1",children:t.singers.length?a.jsx("div",{className:"-mt-2 -ml-2 flex ",children:t.singers.map((l,c)=>a.jsx(Fs,{children:a.jsx(QX,{singer:l})},c))}):a.jsx(Fe,{})}),a.jsx(oe,{title:"Songs",variant:"h3",className:"mt-3"}),a.jsx(Zt,{className:"mt-1",children:a.jsx("div",{className:"overflow-hidden",children:a.jsx(k5,{className:"[&_td]:text-sm [&_tbody>tr]:border-t [&_tr]:border-black/10 [&_th]:text-sm [&_th]:text-left [&_td]:p-2 [&_th]:p-2 hover:[&_tr:not(div.absolute)]:bg-black/5",colList:["Name","Singer","Genre",""],children:e.length?e.map((l,c)=>{var u;return a.jsxs("tr",{children:[a.jsx("td",{children:a.jsx(se,{to:`/dashboard/song/${l.id}/edit`,className:"hover:underline",children:l.name})}),a.jsx("td",{children:l.singers.map((d,f)=>a.jsxs(se,{className:"hover:underline",to:`/dashboard/singer/${d.id}`,children:[!!f&&", ",d.name]},f))}),a.jsx("td",{children:(u=l.main_genre)==null?void 0:u.name}),a.jsx("td",{children:a.jsx(v5,{variant:"playlist",song:l})})]},c)}):a.jsx("tr",{children:a.jsx("td",{colSpan:4,children:a.jsx(Fe,{})})})})})})]})]})]}):a.jsx(a.Fragment,{})}function YX(){return a.jsx(UB,{children:a.jsx(XX,{})})}function HN(t){const{setImageFile:e,singerData:n,handleSubmit:r,isFetching:s,isValidToSubmit:i,updateSingerData:o,inputRef:l}=mN(t),c=h.useRef(null);if(n)return a.jsxs(a.Fragment,{children:[a.jsxs(je,{className:"w-[700px]",children:[a.jsx(qe,{closeModal:()=>{var u;return(u=t.modalRef.current)==null?void 0:u.close()},title:t.variant==="add"?"Add singer":"Edit singer"}),a.jsxs("div",{className:"flex-grow overflow-auto md:flex md:flex-[unset]",children:[a.jsxs("div",{className:"space-y-2.5",children:[a.jsx("div",{className:"w-[200px] h-[200px] rounded-lg border overflow-hidden",children:a.jsx(De,{className:"object-cover object-center h-full",blurHashEncode:n.blurhash_encode,src:n.image_url})}),a.jsxs(J,{onClick:()=>{var u;return(u=c.current)==null?void 0:u.open()},children:[a.jsx(Ki,{className:"w-5"}),a.jsx("span",{children:"Change image"})]})]}),a.jsxs("div",{className:"flex-grow flex flex-col mt-3  space-y-3 md:mt-0 md:ml-5",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx(kt,{htmlFor:"name",children:"Name"}),a.jsx(En,{ref:l,type:"text",id:"name",placeholder:"",value:n.name,onChange:u=>o({name:u.target.value})})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx(kt,{htmlFor:"description",children:"Description"}),a.jsx("textarea",{placeholder:"...",id:"description",className:`${xc} rounded-md min-h-[100px]`,value:n.description,onChange:u=>o({description:u.target.value})})]})]})]}),a.jsx("p",{className:"text-right mt-3",children:a.jsx(J,{loading:s,color:"primary",onClick:r,disabled:!i,className:"font-playwriteCU rounded-full",children:"Save"})})]}),a.jsx(ie,{variant:"animation",ref:c,children:a.jsx(ml,{modalRef:c,title:"Album image",setImageFile:e})})]})}function JX(){const t=h.useRef(null);return a.jsxs(a.Fragment,{children:[a.jsxs(J,{onClick:()=>{var e;return(e=t.current)==null?void 0:e.open()},className:"self-start p-1.5 ml-5",size:"clear",children:[a.jsx(Vi,{className:"w-6"}),a.jsx("div",{className:"hidden md:block",children:"Add new singer"})]}),a.jsx(ie,{ref:t,variant:"animation",children:a.jsx(HN,{modalRef:t,variant:"add"})})]})}const ZX=["All","Result"];function eY(){const{setSingers:t,PAGE_SIZE:e,singers:n,setHasMore:r,shouldGetSingers:s,lastDoc:i}=Bs(),[o,l]=h.useState(!0),[c,u]=h.useState("All"),{handleSubmit:d,result:f,value:p,setValue:g}=hN({afterSearched:()=>{u("Result")},setIsFetchingParent:l}),{setErrorToast:x}=ne(),w=async()=>{try{l(!0);const v=i.current?Ee(Xo,dn("created_at","desc"),xg(i.current),kn(e)):Ee(Xo,dn("created_at","desc"),kn(e)),_=await tn(v),b=_.docs.map(j=>({...j.data(),id:j.id}));i.current?t(j=>[...j,...b]):t(b),b.length<e?r(!1):i.current=_.docs[e-1]}catch(v){console.log({message:v}),x()}finally{l(!1)}};return h.useEffect(()=>{s.current?(s.current=!1,w()):l(!1)},[]),{isFetching:o,value:p,setValue:g,handleSubmit:d,singers:n,tab:c,getSingers:w,setTab:u,result:f,tabs:ZX}}function tY(){const{hasMore:t,singers:e}=Bs(),{isFetching:n,result:r,getSingers:s,tabs:i,tab:o,setTab:l,...c}=eY(),u=h.useMemo(()=>o==="All"?e:r,[o,e,r]);return a.jsxs(a.Fragment,{children:[a.jsx(oe,{title:"Singers"}),a.jsxs("div",{className:"flex justify-between mt-3",children:[a.jsx(Ji,{loading:o==="Result"&&n,...c}),a.jsx(JX,{})]}),a.jsx("div",{className:"mt-5 w-fit self-start",children:a.jsx(Ur,{disable:o==="All",tabs:i,render:d=>d,tab:o,setTab:l})}),a.jsx("div",{className:"mt-3",children:a.jsx(zs,{colList:["Name","Like"],children:u.length?a.jsxs(a.Fragment,{children:[u.map((d,f)=>a.jsxs("tr",{children:[a.jsx("td",{children:a.jsx(se,{className:"hover:underline",to:`/dashboard/singer/${d.id}`,children:d.name})}),a.jsx("td",{children:Ms(d.like)})]},f)),n&&a.jsx("tr",{className:"no-hover border-none",children:a.jsx("td",{colSpan:9,children:a.jsx(Me,{className:"animate-spin w-7 mx-auto"})})}),o==="All"&&a.jsx("tr",{className:"no-hover",children:a.jsx("td",{colSpan:9,className:"text-center hover:bg-none",children:a.jsx(J,{disabled:!t,onClick:s,children:"Get more"})})})]}):a.jsx("tr",{children:a.jsx("td",{colSpan:2,children:a.jsx(Fe,{})})})})})]})}function nY({value:t}){const e=h.useRef(null);return a.jsxs(a.Fragment,{children:[a.jsxs(J,{onClick:()=>{var n;return(n=e.current)==null?void 0:n.open()},className:"p-1.5 ml-5",size:"clear",children:[a.jsx(Wt,{className:"w-6"}),a.jsx("div",{className:"hidden md:block",children:"Add genre"})]}),a.jsx(ie,{ref:e,variant:"animation",children:a.jsx(Gg,{genreName:t,type:"add",closeModal:()=>{var n;return(n=e.current)==null?void 0:n.close()}})})]})}function Ix({genre:t}){const[e,n]=h.useState(""),r=h.useRef(null),{action:s,isFetching:i}=xN(),o=u=>{var d;n(u),(d=r.current)==null||d.open()},l=()=>{var u;return(u=r.current)==null?void 0:u.close()},c=async()=>{await s({type:"delete",id:t.id})};return a.jsxs(a.Fragment,{children:[a.jsxs(Fs,{children:[a.jsx("span",{children:t.name}),a.jsxs("div",{children:[a.jsx("button",{className:"",onClick:()=>o("edit"),children:a.jsx(is,{className:"w-5"})}),a.jsx("button",{onClick:()=>o("delete"),children:a.jsx(xt,{className:"w-5"})})]})]}),a.jsxs(ie,{variant:"animation",ref:r,children:[e==="edit"&&a.jsx(Gg,{type:"edit",genre:t,closeModal:l}),e==="delete"&&a.jsx(hn,{callback:c,closeModal:l,loading:i,label:`Delete genre '${t.name}'`})]})]})}function rY(){const{isFetching:t,api:e}=Wg(),{_genres:n,mains:r,subs:s,...i}=yN();return h.useEffect(()=>{e()},[]),a.jsxs(a.Fragment,{children:[a.jsx(oe,{title:"Genres"}),a.jsxs("div",{className:"flex justify-between items-start mt-3",children:[a.jsx(w5,{...i}),a.jsx(nY,{value:i.value})]}),a.jsxs("div",{className:"mt-5 space-y-5",children:[t&&a.jsx(we,{className:"h-[200px] rounded-xl"}),!t&&a.jsx(a.Fragment,{children:n.length?a.jsx("div",{className:"flex flex-wrap -mt-2 -mx-2",children:n.map(o=>a.jsx(Ix,{genre:o},o.id))}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx(oe,{variant:"h3",className:"mb-1",title:"Main genres"}),a.jsx(Zt,{className:"mt-1",children:r.length?a.jsx("div",{className:"flex flex-wrap -mt-2  -mx-2",children:r.map(o=>a.jsx(Ix,{genre:o},o.id))}):a.jsx(Fe,{})})]}),a.jsxs("div",{children:[a.jsx(oe,{variant:"h3",className:"mb-1",title:"Sub genres"}),a.jsx(Zt,{className:"mt-1",children:s.length?a.jsx("div",{className:"flex flex-wrap -mt-2 -mx-2",children:s.map(o=>a.jsx(Ix,{genre:o},o.id))}):a.jsx(Fe,{})})]})]})})]})]})}function WE(){return a.jsx(oN,{})}function sY(){const{setErrorToast:t}=ne(),{singer:e,setSinger:n,shouldGetSingers:r,lastDoc:s}=Bs(),[i,o]=h.useState(!1),l=Gt();return{isFetching:i,action:async u=>{try{switch(u.variant){case"delete":{if(!e)throw new Error("");o(!0),await qw({collectionName:"Singers",id:e.id}),e.image_file_id&&Vt({fileId:e.image_file_id}),o(!1),r.current=!0,s.current=void 0,l("/dashboard/singer");break}}}catch(d){console.log({message:d}),t("")}finally{o(!1)}},singer:e,setSinger:n}}function iY(){const[t,e]=h.useState(""),n=h.useRef(null),{action:r,isFetching:s,singer:i}=sY(),o=c=>{var u;e(c),(u=n.current)==null||u.open()},l=()=>{var c;return(c=n.current)==null?void 0:c.close()};return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"mt-3",children:a.jsxs(Yc,{children:[a.jsxs(J,{onClick:()=>o("edit"),className:"md:px-3",size:"clear",children:[a.jsx(is,{className:"w-6"}),a.jsx("span",{children:"Edit singer"})]}),a.jsxs(J,{onClick:()=>o("delete"),className:"md:px-3",size:"clear",children:[a.jsx(xt,{className:"w-6"}),a.jsx("span",{children:"Delete"})]})]})}),a.jsxs(ie,{variant:"animation",ref:n,children:[t==="more"&&i&&a.jsx(je,{children:i.description}),t==="edit"&&a.jsx(HN,{modalRef:n,variant:"edit"}),t==="delete"&&i&&a.jsx(hn,{label:`Delete singer '${i.name}'`,loading:s,callback:()=>r({variant:"delete"}),closeModal:l})]})]})}function aY(){const{setSinger:t,setSongs:e,setPlaylists:n,setAlbums:r}=Bs(),{setErrorToast:s}=ne(),{setIsFetching:i}=Sh(),o=Wi(),l=Gt(),c=h.useRef(!1),u=async()=>{try{if(!o.id)return;const d=await en({collectionName:"Singers",id:o.id});d.exists()||l("/dashboard/singer");const f={...d.data(),id:o.id},p=Ee(fn,ae(`singer_map.${f.id}`,"==",!0)),g=await Cn(p),x=Ee(er,ae(`singer_map.${f.id}`,"==",!0)),w=await wr(x),v=[],_=[];w.forEach(b=>b.is_album?_.push(b):v.push(b)),t(f),n(v),r(_),e(g)}catch(d){console.log({error:d}),s()}finally{i(!1)}};h.useEffect(()=>{c.current||(c.current=!0,u())},[])}function oY(){const[t,e]=h.useState(!0);return{isFetching:t,setIsFetching:e}}const GN=h.createContext(null);function lY({children:t}){return aY(),t}function cY({children:t}){return a.jsx(GN.Provider,{value:oY(),children:a.jsx(lY,{children:t})})}function Sh(){const t=h.useContext(GN);if(!t)throw new Error;return t}function uY(){const{singer:t,setSinger:e}=Bs(),{isFetching:n}=Sh(),r=async(s,i)=>{t&&(await Re({collectionName:"Singers",id:t.id,data:{like:s}}),e({...t,like:s}),i())};return!n&&!t?a.jsx(a.Fragment,{}):a.jsx(a.Fragment,{children:a.jsxs("div",{className:"md:flex",children:[a.jsx("div",{className:"flex-shrink-0 w-[260px] h-[260px] rounded-md overflow-hidden mx-auto md:m-unset",children:n?a.jsx(we,{className:"pt-[100%] "}):a.jsx(De,{className:"object-cover",src:t==null?void 0:t.image_url,blurHashEncode:(t==null?void 0:t.blurhash_encode)||""})}),a.jsx("div",{className:"flex-grow flex flex-col mt-5 space-y-2.5  md:mt-0 md:ml-5",children:n?a.jsxs(a.Fragment,{children:[a.jsx(we,{className:"h-[60px] w-full md:w-[200px]"}),a.jsx(we,{className:"h-[120px] w-full md:w-[70%]"}),a.jsx(we,{className:"h-[17px] w-[200px]"})]}):t&&a.jsxs(a.Fragment,{children:[a.jsxs(Vd,{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("span",{children:"Name"}),a.jsx(oe,{variant:"h1",title:t.name})]}),a.jsx(Pg,{init:t.like,loading:!1,submit:r}),a.jsxs("p",{children:[a.jsx("span",{children:"Description"})," ",a.jsx("br",{}),t.description]})]}),a.jsx(iY,{})]})})]})})}function dY(){const{songs:t}=Bs(),{isFetching:e}=Sh();return a.jsxs(a.Fragment,{children:[a.jsx(oe,{variant:"h2",title:"Songs"}),a.jsx(Os,{children:e?a.jsx(we,{className:"h-[100px]"}):a.jsx(zs,{colList:["Name","Singers","Genres"],children:t.length?t.map((n,r)=>a.jsxs("tr",{className:"hover:bg-black/10",children:[a.jsx("td",{children:a.jsx(se,{to:`/dashboard/song/${n.id}/edit`,children:n.name})}),a.jsx("td",{children:n.singers.map((s,i)=>a.jsx(se,{to:`/dashboard/singer/${s.id}`,className:"hover:text-green-500 hover:underline",children:(i?", ":"")+s.name},i))}),a.jsx("td",{children:n.genres.map((s,i)=>a.jsxs("span",{children:[!!i&&", ",s.name]},i))})]},r)):a.jsx("tr",{children:a.jsx("td",{colSpan:4,children:a.jsx(Fe,{})})})})})]})}function hY(){const{playlists:t}=Bs(),{isFetching:e}=Sh();return a.jsxs(a.Fragment,{children:[a.jsx(oe,{variant:"h2",title:"Playlists"}),e&&a.jsx(we,{className:"h-[100px]"}),!e&&a.jsx(zs,{colList:["Name",""],children:t.length?t.map((n,r)=>a.jsxs("tr",{className:"hover:bg-black/10",children:[a.jsx("td",{children:a.jsx(se,{to:`/dashboard/playlist/${n.id}`,children:n.name})}),a.jsx("td",{children:"-"})]},r)):a.jsx("tr",{children:a.jsx("td",{colSpan:2,children:a.jsx(Fe,{})})})})]})}function fY(){const[t,e]=h.useState(),[n,r]=h.useState(),[s,i]=h.useState();return{singer:t,setSinger:e,updateAlbumData:l=>{n&&r({...n,...l})},albumData:n,imageFile:s,setImageFile:i,setAlbumData:r}}const WN=h.createContext(null);function mY({children:t}){return a.jsx(WN.Provider,{value:fY(),children:t})}function k_(){const t=h.useContext(WN);if(!t)throw new Error("AddAlbumProvider not provided");return t}function pY(t){const{imageFile:e,updateAlbumData:n,setSinger:r,albumData:s,singer:i,setImageFile:o,setAlbumData:l}=k_(),{setSuccessToast:c,setErrorToast:u}=ne(),[d,f]=h.useState(!1),p=h.useRef(!1),g=h.useMemo(()=>t.variant==="add"?!0:!t.album||!s?!1:s.name!==t.album.name||(i==null?void 0:i.id)!==t.album.singers[0].id||s.like!==t.album.like,[s,i]),x=!!e,w=h.useMemo(()=>{const b=!!g&&!!s&&!!s.name&&!!i;return t.variant==="add"?b:b||x},[x,g,s,i]),v=async()=>{var b;try{if(!s||!i)return;if(f(!0),e){s.image_file_id&&Vt({fileId:s.image_file_id});const j=await Yi({imageFile:e});Object.assign(s,j)}switch(s.singers=[i],s.singer_map={[i.id]:!0},s.name=s.name.trim(),s.meta=Un(s.name).split(" "),t.variant){case"add":{const j=await ai({collectionName:"Playlists",data:s}),T=await Tc(j),R={...T.data(),id:T.id};t.afterSubmit(R),c("Album created");break}case"edit":{if(!t.album)return;await Re({collectionName:"Playlists",data:{...s,updated_at:pt()},id:t.album.id}),t.afterSubmit(s),c("Album edited");break}}(b=t.modalRef.current)==null||b.close()}catch(j){console.log(j),u()}finally{f(!1),o(void 0)}},_=async()=>{switch(t.variant){case"add":l(SU({owner_email:t.user.email,distributor:t.user.email})),r(t.singer);break;case"edit":const{id:b,...j}=t.album;r(j.singers[0]),l(j);break}};return h.useEffect(()=>{var b;p.current||(p.current=!0,_(),t.variant==="add"&&((b=t.modalRef.current)==null||b.setModalPersist(!0)))},[]),h.useEffect(()=>{var b;(g||e)&&((b=t.modalRef.current)==null||b.setModalPersist(!0))},[s,i,e]),h.useEffect(()=>{e&&n({image_url:URL.createObjectURL(e)})},[e]),{submit:v,isFetching:d,isValidToSubmit:w}}function gY({singerFromParent:t}){const{singer:e,setSinger:n,albumData:r}=k_(),s=h.useRef(null),i=o=>{var l;n(o),(l=s.current)==null||l.close()};if(r)return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center space-x-1.5",children:[a.jsx(kt,{children:"Singer"}),e?a.jsxs(Fs,{className:"!mt-0",children:[a.jsx("span",{children:e.name}),!t&&a.jsx("div",{children:a.jsx("button",{onClick:()=>n(void 0),children:a.jsx(xt,{className:"w-5"})})})]}):a.jsx(J,{size:"clear",className:"p-1.5",onClick:()=>{var o;return(o=s.current)==null?void 0:o.open()},children:a.jsx(Wt,{className:"w-5"})})]}),a.jsx(ie,{variant:"animation",ref:s,children:a.jsx(pN,{choose:i,closeModal:()=>{var o;return(o=s.current)==null?void 0:o.close()}})})]})}function xY({className:t="",...e}){const{albumData:n,setImageFile:r,updateAlbumData:s}=k_(),{submit:i,isFetching:o,isValidToSubmit:l}=pY(e),c=h.useRef(null),u=a.jsxs(J,{size:"clear",className:"py-1.5 px-3",onClick:i,loading:o,disabled:!l||o,children:[a.jsx(dh,{className:"w-6"}),a.jsx("span",{children:"Save"})]});return n?a.jsxs(a.Fragment,{children:[a.jsx(qe,{closeModal:()=>{var d;return(d=e.modalRef.current)==null?void 0:d.close()},title:e.variant==="add"?"Add album":"Edit albm"}),a.jsxs("div",{className:`md:flex ${t} overflow-auto`,children:[a.jsxs("div",{className:"space-y-3",children:[a.jsx(Zt,{p:"clear",className:"w-[200px] mx-auto h-[200px] rounded-lg overflow-hidden",children:a.jsx(De,{className:"object-cover object-center h-full",blurHashEncode:n.blurhash_encode,src:n.image_url})}),a.jsxs(J,{onClick:()=>{var d;return(d=c.current)==null?void 0:d.open()},children:[a.jsx(Ki,{className:"w-6"}),a.jsx("span",{children:"Change image"})]})]}),a.jsx("div",{className:"md:w-3/4 mt-5 md:mt-0 md:ml-5 flex-grow flex flex-col space-y-5",children:a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx(kt,{htmlFor:"name",children:"Name"}),a.jsx(En,{type:"text",placeholder:"name...",id:"name",className:"text-[#333]",value:n.name,onChange:d=>s({name:d.target.value})})]}),a.jsx(gY,{singerFromParent:e.variant==="add"?e.singer:void 0})]})})]}),a.jsx("p",{className:"text-right mt-3",children:u}),o&&a.jsx(ea,{}),a.jsx(ie,{variant:"animation",ref:c,children:a.jsx(ml,{modalRef:c,title:"Album image",setImageFile:r})})]}):a.jsx(a.Fragment,{})}function T_(t){return a.jsx(mY,{children:a.jsx(xY,{...t})})}function yY(){const{user:t}=ye(),{singer:e,setAlbums:n}=Bs(),r=h.useRef(null),s=i=>{n(o=>[i,...o])};return a.jsxs(a.Fragment,{children:[a.jsxs(J,{onClick:()=>{var i;return(i=r.current)==null?void 0:i.open()},className:"px-3 py-1",size:"clear",children:[a.jsx(Wt,{className:"w-5"}),a.jsx("span",{children:"Add album"})]}),t&&e&&a.jsx(ie,{variant:"animation",ref:r,children:a.jsx(je,{className:"w-[700px]",children:a.jsx(T_,{className:"flex-grow overflow-auto no-scrollbar md:overflow-hidden",variant:"add",modalRef:r,singer:e,afterSubmit:s,user:t})})})]})}function vY(){const{albums:t}=Bs(),{isFetching:e}=Sh();return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx(oe,{variant:"h2",title:"Albums"}),a.jsx(yY,{})]}),e&&a.jsx(we,{className:"h-[100px]"}),!e&&a.jsx(zs,{colList:["Name",""],children:t.length?t.map((n,r)=>a.jsxs("tr",{className:"hover:bg-black/10",children:[a.jsx("td",{children:a.jsx(se,{to:`/dashboard/album/${n.id}`,children:n.name})}),a.jsx("td",{children:"-"})]},r)):a.jsx("tr",{children:a.jsx("td",{colSpan:2,children:a.jsx(Fe,{})})})})]})}function wY(){return a.jsx(a.Fragment,{children:a.jsxs("div",{className:"space-y-5",children:[a.jsx(uY,{}),a.jsx(vY,{}),a.jsx(dY,{}),a.jsx(hY,{})]})})}function _Y(){return a.jsx(cY,{children:a.jsx(wY,{})})}function bY({setAlbums:t}){const{user:e}=ye(),n=h.useRef(null),r=()=>{var i;return(i=n.current)==null?void 0:i.close()},s=i=>{t(o=>[i,...o]),r()};if(e)return a.jsxs(a.Fragment,{children:[a.jsxs(J,{onClick:()=>{var i;return(i=n.current)==null?void 0:i.open()},className:"self-start p-1.5 ml-5",size:"clear",children:[a.jsx(Vi,{className:"w-6"}),a.jsx("div",{className:"hidden md:block",children:"Add new album"})]}),a.jsx(ie,{ref:n,variant:"animation",persisted:!0,children:a.jsx(je,{className:"w-[600px]",children:a.jsx(T_,{className:"overflow-auto",variant:"add",user:e,modalRef:n,afterSubmit:s})})})]})}const SY=["All","Result"];function EY(){const[t,e]=h.useState([]),[n,r]=h.useState(""),[s,i]=h.useState(!0),[o,l]=h.useState("All"),{setErrorToast:c}=ne(),u=async f=>{try{if(f.preventDefault(),s)return;i(!0);const p=Rr(er,[ae("is_album","==",!0)],n),g=await wr(p);e(g),l("Result")}catch(p){console.log({message:p}),c()}finally{i(!1)}},d=async()=>{try{i(!0);const f=Ee(er,ae("is_album","==",!0),dn("created_at","desc")),p=await wr(f);e(p)}catch(f){console.log({message:f}),c()}finally{i(!1)}};return h.useEffect(()=>{o==="All"&&d()},[o]),{isFetching:s,value:n,setValue:r,handleSubmit:u,albums:t,tab:o,setTab:l,tabs:SY,setAlbums:e}}function jY(){const{isFetching:t,albums:e,tab:n,tabs:r,setTab:s,setAlbums:i,...o}=EY();return a.jsxs(a.Fragment,{children:[a.jsx(oe,{title:"Albums"}),a.jsxs("div",{className:"flex justify-between mt-3",children:[a.jsx(Ji,{loading:n==="Result"&&t,...o}),a.jsx(bY,{setAlbums:i})]}),a.jsx("div",{className:"mt-5 w-fit  self-start",children:a.jsx(Ur,{disable:n==="All",tabs:r,render:l=>l,tab:n,setTab:s})}),a.jsxs("div",{className:"mt-3",children:[t&&a.jsx(we,{className:"h-[200px] rounded-xl"}),!t&&a.jsx(zs,{colList:["Name","Singer","Like"],children:e.length?e.map((l,c)=>a.jsxs("tr",{children:[a.jsx("td",{children:a.jsx(se,{className:"hover:underline",to:`/dashboard/album/${l.id}`,children:l.name})}),a.jsx("td",{children:a.jsx(se,{to:`/dashboard/singer/${l.singers[0].id}`,children:l.singers[0].name})}),a.jsx("td",{children:Ms(l.like)})]},c)):a.jsx("tr",{children:a.jsx("td",{colSpan:4,children:a.jsx(Fe,{})})})})]})]})}function qN(){const{setErrorToast:t}=ne(),{setCategoryPage:e,shouldFetch:n,setHomePage:r,setCategories:s}=qn(),[i,o]=h.useState(!0),l=h.useRef(!1),c=async()=>{try{if(o(!0),n.current)n.current=!1;else{await ss(100);return}const u={category_ids:"",category_sections:[],playlist_sections:[],updated_at:pt()};let d={...u},f={...u},p=[];const g=gt(de,"Page_Config","category"),x=gt(de,"Page_Config","home"),[w,v]=await Promise.all([en({collectionName:"Page_Config",id:"category",msg:"Get category config"}),en({collectionName:"Page_Config",id:"home",msg:"Get home config"})]),_=await tn(Ee(Mt(de,"Categories")));w.exists()?d=w.data():await tv(g,d),v.exists()?f=v.data():await tv(x,f),_.empty||(p=_.docs.map(b=>({...b.data(),id:b.id}))),s(p),e(d),r(f)}catch(u){console.log(u),t()}finally{o(!1)}};return h.useEffect(()=>{l.current||(l.current=!1,c())},[]),{isFetching:i}}function kY({closeModal:t,choose:e}){const{categories:n}=qn();return a.jsx(a.Fragment,{children:a.jsxs(je,{children:[a.jsx(qe,{title:"Category",closeModal:t}),a.jsx("div",{className:"h-[40vh] mt-3 space-y-1.5 overflow-auto",children:n.length?n.map((r,s)=>a.jsx(Zt,{onClick:()=>e(r),children:a.jsx("p",{className:"text-lg",children:r.name})},s)):a.jsx(Fe,{})})]})})}function KN(t){const e=location.hash.includes("homepage")?"home":"category",{categoryPage:n,homePage:r,setCategoryPage:s,setHomePage:i,categorySliders:o,homeSliders:l}=qn(),{setErrorToast:c,setSuccessToast:u}=ne(),[d,f]=h.useState(!1),p=e==="home"?r:n,g=e==="home"?i:s,x=e==="home"?l:o,w=async _=>{if(!p)return;const b={...p};b.category_ids=_.map(j=>j.id).join("_"),await Re({collectionName:"Page_Config",data:b,id:e}),g(b)};return{isFetching:d,action:async _=>{var b;try{if(!p)return;switch(console.log(e),f(!0),_.variant){case"add-category":{const j=[...x,..._.categories];w(j),u("Add category successful");break}case"remove-category":{const j=x.filter(T=>T.id!==_.id);w(j),u("Remove category successful");break}case"arrange":{const j={...p};j.category_ids=_.order.join("_"),await Re({collectionName:"Page_Config",data:j,id:e}),g(j);break}}(b=t==null?void 0:t.modalRef.current)==null||b.close()}catch(j){console.log(j),c()}finally{f(!1)}}}}function TY({orderedCategories:t}){const[e,n]=h.useState(""),r=h.useRef(null),{action:s,isFetching:i}=KN({modalRef:r}),o=c=>{var u;n(c),(u=r.current)==null||u.open()},l=()=>{var c;return(c=r.current)==null?void 0:c.close()};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex space-x-2 justify-center mt-3",children:[a.jsxs(J,{onClick:()=>o("add"),children:[a.jsx(Wt,{className:"w-6"}),a.jsx("span",{children:"Add"})]}),a.jsxs(J,{onClick:()=>o("arrange"),disabled:t.length<2,children:[a.jsx(Me,{className:"w-6"}),a.jsx("span",{children:"Arrange"})]})]}),a.jsxs(ie,{variant:"animation",ref:r,children:[e==="add"&&a.jsx(kY,{choose:c=>s({variant:"add-category",categories:[c]}),closeModal:l}),e==="arrange"&&a.jsx(Fg,{closeModal:l,isLoading:i,data:t.map(c=>({id:c.id,label:c.name})),submit:c=>s({variant:"arrange",order:c})})]})]})}function IY({category:t}){const[e,n]=h.useState(""),r=h.useRef(null),{action:s,isFetching:i}=KN({modalRef:r}),o=c=>{var u;n(c),(u=r.current)==null||u.open()},l=()=>{var c;return(c=r.current)==null?void 0:c.close()};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("div",{className:"aspect-[16/4]",children:a.jsx(De,{src:t.banner_image_url,blurHashEncode:t.banner_blurhash_encode,className:"rounded-md h-full object-cover"})}),a.jsxs(Fs,{margin:!1,className:"w-fit mx-auto mt-2",children:[a.jsx(se,{to:`/dashboard/category/${t.id}`,className:"hover:underline",children:t.name}),a.jsx("div",{children:a.jsx("button",{onClick:()=>o("delete"),children:a.jsx(xt,{className:"w-5"})})})]})]}),a.jsx(ie,{variant:"animation",ref:r,children:e==="delete"&&a.jsx(hn,{callback:()=>s({variant:"remove-category",id:t.id}),closeModal:l,loading:i,label:`Remove category '${t.name}'`})})]})}function QN(){const{categorySliders:t,homeSliders:e}=qn(),r=(location.hash.includes("homepage")?"home":"category")==="home"?e:t;return a.jsxs(a.Fragment,{children:[a.jsx(oe,{title:"Slider",variant:"h2",className:"mb-3"}),a.jsxs(Zt,{children:[a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:r.length?r.map((s,i)=>a.jsx(IY,{category:s},i)):""}),a.jsx("div",{className:"mt-3",children:a.jsx(TY,{orderedCategories:r})})]})]})}function I_(t){const{categoryPage:e,homePage:n,setHomePage:r,setCategoryPage:s,setCategories:i}=qn(),{setErrorToast:o,setSuccessToast:l}=ne(),[c,u]=h.useState(!1),d=location.hash.includes("homepage")?"home":"category",f=d==="home"?n:e,p=d==="home"?r:s;return{isFetching:c,action:async x=>{var w;try{if(!f)return;switch(u(!0),x.type){case"add-section":{const v={...f};switch(x.variant){case"category":v.category_sections.push(x.section);break;case"playlist":v.playlist_sections.push(x.section);break}await Re({collectionName:"Page_Config",data:v,id:d}),u(!1),p(v),l("Add section successful");break}case"edit-section":{const{index:v,section:_}=x,b={...f};switch(x.variant){case"category":Object.assign(b.category_sections[v],_);break;case"playlist":Object.assign(b.playlist_sections[v],_);break}await Re({collectionName:"Page_Config",data:b,id:d}),u(!1),p(b),l("Update section successful");break}case"delete":{const v=Ls(de),_={...f};switch(x.variant){case"category":const b=_.category_sections[x.index].target_ids;b&&b.split("_").forEach(j=>v.delete(gt(de,"Categories",j))),_.category_sections.splice(x.index,1);break;case"playlist":_.playlist_sections.splice(x.index,1);break}v.update(gt(de,"Page_Config",d),_),await v.commit(),l("Delete section successful");break}case"add-category":{const{category:v,sectionIndex:_}=x,b={...f},j={...b.category_sections[_]};j.target_ids=j.target_ids?j.target_ids+`_${v.id}`:v.id,Object.assign(b.category_sections[_],j),await Re({collectionName:"Page_Config",data:b,id:d}),i(T=>[...T,v]),p(b),l("Add new category successful")}}(w=t==null?void 0:t.modalRef.current)==null||w.close()}catch(v){console.log(v),o()}finally{u(!1)}}}}function XN(){const t=location.hash.includes("homepage")?"home":"category",[e,n]=h.useState(""),r=h.useRef(null),{action:s,isFetching:i}=I_({modalRef:r}),o=l=>{var c;n(l),(c=r.current)==null||c.open()};return a.jsxs(a.Fragment,{children:[a.jsxs(nr,{children:[a.jsx(rr,{children:a.jsxs(J,{size:"clear",className:"p-1.5",children:[a.jsx(Wt,{className:"w-6"}),a.jsx("span",{children:"Add new section"})]})}),a.jsx(sr,{className:"top-[calc(100%+8px)]",children:a.jsx(cr,{className:"w-[140px]",children:a.jsxs(ls,{children:[t==="category"&&a.jsxs("button",{onClick:()=>o("category"),children:[a.jsx(Hp,{}),a.jsx("span",{children:"Category"})]}),a.jsxs("button",{onClick:()=>o("playlist"),children:[a.jsx(IT,{}),a.jsx("span",{children:"Playlist"})]})]})})})]}),a.jsx(ie,{variant:"animation",ref:r,children:e&&a.jsx(FT,{loading:i,cbWhenSubmit:l=>s({type:"add-section",variant:e,section:EU(l)}),closeModal:()=>{var l;return(l=r.current)==null?void 0:l.close()},title:e==="category"?"Add category section":"Add playlist section"})})]})}function CY(){const[t,e]=h.useState([]);return{playlists:t,setPlaylists:e}}const YN=h.createContext(null);function RY({children:t}){return a.jsx(YN.Provider,{value:CY(),children:t})}const JN=()=>{const t=h.useContext(YN);if(!t)throw new Error("PlaylistSectionProvider is not provided");return t};function ZN(t){const{categoryPage:e,setCategoryPage:n,homePage:r,setHomePage:s}=qn(),{setErrorToast:i,setSuccessToast:o}=ne(),{playlists:l,setPlaylists:c}=JN(),[u,d]=h.useState(!1),f=location.hash.includes("homepage")?"home":"category",p=f==="home"?r:e,g=f==="home"?s:n,x=async(v,_)=>{if(!p)return;const b={...p},j={target_ids:v.map(T=>T.id).join("_")};Object.assign(b.playlist_sections[_],j),await Re({collectionName:"Page_Config",data:b,id:f}),c(v),g(b)};return{isFetching:u,action:async v=>{var _;try{if(!p)return;switch(d(!0),v.variant){case"add-playlist":{const b=[...l,...v.playlists];x(b,v.sectionIndex),o("Add playlist successful");break}case"remove-playlist":{const b=l.filter(j=>j.id!==v.id);x(b,v.sectionIndex),o("Remove playlist successful");break}case"arrange-playlist":{const b={...p};Object.assign(b.playlist_sections[v.sectionIndex],v.section),await Re({collectionName:"Page_Config",data:b,id:f}),g(b);break}}(_=t==null?void 0:t.modalRef.current)==null||_.close()}catch(b){console.log(b),i()}finally{d(!1)}}}}function NY({playlist:t,sectionIndex:e}){const[n,r]=h.useState(""),s=h.useRef(null),{action:i,isFetching:o}=ZN({modalRef:s}),l=u=>{var d;r(u),(d=s.current)==null||d.open()},c=()=>{var u;return(u=s.current)==null?void 0:u.close()};return a.jsxs(a.Fragment,{children:[a.jsxs(Fs,{children:[a.jsx(se,{to:`/dashboard/playlist/${t.id}`,className:"hover:underline",children:t.name}),a.jsx("div",{children:a.jsx("button",{onClick:()=>l("delete"),children:a.jsx(xt,{className:"w-5"})})})]}),a.jsx(ie,{variant:"animation",ref:s,children:n==="delete"&&a.jsx(hn,{callback:()=>i({variant:"remove-playlist",id:t.id,sectionIndex:e}),closeModal:c,loading:o,label:`Remove playlist '${t.name}'`})})]})}function AY({sectionIndex:t,orderedPlaylists:e}){const[n,r]=h.useState(""),s=h.useRef(null),{action:i,isFetching:o}=ZN({modalRef:s}),l=c=>{var u;r(c),(u=s.current)==null||u.open()};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex space-x-2 justify-center mt-3",children:[a.jsxs(J,{onClick:()=>l("add"),children:[a.jsx(Wt,{className:"w-6"}),a.jsx("span",{children:"Add playlist "})]}),a.jsxs(J,{onClick:()=>l("arrange"),disabled:e.length<2,children:[a.jsx(Me,{className:"w-6"}),a.jsx("span",{children:"Arrange"})]})]}),a.jsxs(ie,{variant:"animation",ref:s,children:[n==="add"&&a.jsx(Ag,{current:e.map(c=>c.id),closeModal:()=>{var c;return(c=s.current)==null?void 0:c.close()},isLoading:o,submit:c=>i({variant:"add-playlist",playlists:c,sectionIndex:t})}),n==="arrange"&&a.jsx(Fg,{closeModal:()=>{var c;return(c=s.current)==null?void 0:c.close()},isLoading:o,data:e.map(c=>({id:c.id,label:c.name})),submit:c=>i({variant:"arrange-playlist",section:{target_ids:c.join("_")},sectionIndex:t})})]})]})}function eA({name:t,index:e,variant:n,section:r}){const[s,i]=h.useState(""),o=h.useRef(null),{action:l,isFetching:c}=I_({modalRef:o}),u=f=>{var p;i(f),(p=o.current)==null||p.open()},d=()=>{var f;return(f=o.current)==null?void 0:f.close()};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex space-x-2 ml-4",children:[a.jsx(J,{onClick:()=>u("edit"),className:"p-1",size:"clear",children:a.jsx(is,{className:"w-6"})}),a.jsx(J,{onClick:()=>u("delete"),className:"p-1",size:"clear",children:a.jsx(xt,{className:"w-6"})})]}),a.jsxs(ie,{variant:"animation",ref:o,children:[s==="edit"&&a.jsx(FT,{initValue:t,loading:c,cbWhenSubmit:f=>l({type:"edit-section",section:{name:f},index:e,variant:n}),closeModal:d,title:n==="category"?"Edit category section":"Edit playlist section"}),s==="delete"&&a.jsx(hn,{callback:()=>l({type:"delete",index:e,variant:n}),closeModal:d,loading:c,label:`Delete section '${r.name}'`})]})]})}function PY({section:t,index:e}){const{categoryPage:n}=qn(),{playlists:r,setPlaylists:s}=JN(),i=h.useMemo(()=>{const l=[];return(t.target_ids?t.target_ids.split("_"):[]).forEach(u=>{const d=r.find(f=>f.id===u);d&&l.push(d)}),l},[n,r]),{isFetching:o}=t_({setPlaylists:s,playlistIds:t.target_ids?t.target_ids.split("_"):[]});return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx(oe,{variant:"h2",title:t.name}),a.jsx(eA,{section:t,index:e,name:t.name,variant:"playlist"})]}),a.jsxs(Zt,{children:[o&&a.jsx(Rn,{}),!o&&a.jsxs(a.Fragment,{children:[!!i.length&&a.jsx("div",{className:"flex flex-wrap -mt-2 -mx-2",children:i.map((l,c)=>a.jsx(NY,{playlist:l,sectionIndex:e},c))}),a.jsx(AY,{sectionIndex:e,orderedPlaylists:i})]})]})]})}function tA(t){return a.jsx(RY,{children:a.jsx(PY,{...t})})}function FY(){const{homePage:t}=qn(),{isFetching:e}=qN();return e?a.jsx(Ye,{children:a.jsx(Rn,{})}):a.jsx(a.Fragment,{children:a.jsxs("div",{className:"space-y-5",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx(oe,{title:"Home Page"}),a.jsx(XN,{})]}),a.jsx(QN,{}),t==null?void 0:t.playlist_sections.map((n,r)=>a.jsx(tA,{section:n,index:r},r))]})})}function MY(t){const[e,n]=h.useState(),[r,s]=h.useState(),i=h.useRef(null),o=f=>{e&&n({...e,...f})},l=h.useMemo(()=>t.variant==="add"?!0:!t.category||!e?!1:e.name!==t.category.name,[e]),c=!!r,u=h.useMemo(()=>{const f=!!(e!=null&&e.name)&&l;return t.variant==="add"?f:f||c},[c,l,e]),d=()=>{switch(t.variant){case"add":return YS({});case"edit":const{id:f,updated_at:p,...g}=t.category;return YS(g)}};return h.useEffect(()=>{var f;t.variant==="add"&&((f=i.current)==null||f.focus()),n(d())},[]),h.useEffect(()=>{r&&o({image_url:URL.createObjectURL(r)})},[r]),h.useEffect(()=>{var f,p,g,x;l?(p=(f=t==null?void 0:t.modalRef)==null?void 0:f.current)==null||p.setModalPersist(!0):(x=(g=t==null?void 0:t.modalRef)==null?void 0:g.current)==null||x.setModalPersist(!1)},[l]),{categoryData:e,imageFile:r,setImageFile:s,updateData:o,setCategoryData:n,inputRef:i,isValidToSubmit:u,isChanged:l,isChangeImage:c}}function C_({isLoading:t,submit:e,...n}){const{imageFile:r,setImageFile:s,categoryData:i,updateData:o,isChanged:l,isChangeImage:c,inputRef:u,isValidToSubmit:d}=MY(n),f=h.useRef(null),p=async()=>{i&&(!l&&!c||e(i,r))};if(i)return a.jsxs(a.Fragment,{children:[a.jsxs(je,{className:"w-[500px]",children:[a.jsx(qe,{closeModal:()=>{var g,x;return(x=(g=n.modalRef)==null?void 0:g.current)==null?void 0:x.close()},title:n.variant==="add"?"Add category":"Edit category"}),a.jsxs("div",{className:"md:flex md:space-x-3",children:[a.jsxs("div",{className:"space-y-2.5",children:[a.jsx("div",{className:"w-[200px] aspect-[5/3] rounded-lg overflow-hidden",children:a.jsx(De,{className:"object-cover object-center h-full",blurHashEncode:i.blurhash_encode,src:i.image_url})}),a.jsxs(J,{onClick:()=>{var g;return(g=f.current)==null?void 0:g.open()},children:[a.jsx(Ki,{className:"w-6"}),a.jsx("span",{children:"Change image"})]})]}),a.jsx("div",{className:"mt-3 md:mt-0 flex-grow flex flex-col space-y-2.5",children:a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(kt,{htmlFor:"name",children:"Name"}),a.jsx(En,{id:"name",ref:u,type:"text",placeholder:"name...",value:i.name,onChange:g=>o({name:g.target.value})})]})})]}),a.jsx("p",{className:"text-right mt-5 md:mt-0",children:a.jsx(J,{loading:t,onClick:p,disabled:!d,children:"Save"})}),t&&a.jsx(ea,{})]}),a.jsx(ie,{variant:"animation",ref:f,children:a.jsx(ml,{modalRef:f,setImageFile:s,title:"Category iamge"})})]})}function nA(t){const{setErrorToast:e}=ne(),[n,r]=h.useState(!1),s=(t==null?void 0:t.setIsFetching)||r;return{addCategory:async({imageFile:o,...l})=>{try{if(s(!0),o){l.category.image_file_id&&Vt({fileId:l.category.image_file_id});const c=await Yi({imageFile:o,width:870,height:490});Object.assign(l.category,c)}switch(l.variant){case"add":const c=await ai({collectionName:"Categories",data:l.category});return{...l.category,id:c.id};case"edit":return await Re({collectionName:"Categories",data:l.category,id:l.id}),!0}}catch(c){console.log(c),e()}finally{r(!1)}},isFetching:n}}function DY({sectionIndex:t,orderedCategories:e}){const n=h.useRef(null),{action:r,isFetching:s}=I_({modalRef:n}),{isFetching:i,addCategory:o}=nA(),[l,c]=h.useState(""),u=f=>{var p;c(f),(p=n.current)==null||p.open()},d=async(f,p)=>{var x;const g=await o({variant:"add",category:f,imageFile:p});g&&r({type:"add-category",category:g,sectionIndex:t}),(x=n.current)==null||x.close()};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex space-x-2 justify-center mt-3",children:[a.jsxs(J,{onClick:()=>u("add"),children:[a.jsx(Wt,{className:"w-6"}),a.jsx("span",{children:"Add new category"})]}),a.jsxs(J,{onClick:()=>u("arrange"),disabled:e.length<2,children:[a.jsx(Me,{className:"w-6"}),a.jsx("span",{children:"Arrange"})]})]}),a.jsxs(ie,{variant:"animation",ref:n,children:[l==="add"&&a.jsx(C_,{modalRef:n,isLoading:s||i,variant:"add",submit:d}),l==="arrange"&&a.jsx(Fg,{closeModal:()=>{var f;return(f=n.current)==null?void 0:f.close()},data:e.map(f=>({id:f.id,label:f.name})),isLoading:s,submit:f=>r({variant:"category",type:"edit-section",section:{target_ids:f.join("_")},index:t})})]})]})}function LY(t){const{categories:e,setCategories:n}=qn(),{setErrorToast:r,setSuccessToast:s}=ne(),[i,o]=h.useState(!1);return{isFetching:i,action:async c=>{var u;try{switch(o(!0),c.type){case"edit":{await Re({collectionName:"Categories",data:c.category,id:c.id});const d=[...e],f=d.findIndex(g=>g.id===c.id),p={...e[f]};Object.assign(p,c.category),d[f]=p,n(d),s("Edit category successful");break}case"delete":break}(u=t==null?void 0:t.modalRef.current)==null||u.close()}catch(d){console.log(d),r()}finally{o(!1)}}}}function OY({category:t}){const[e,n]=h.useState(""),r=h.useRef(null),{action:s,isFetching:i}=LY({modalRef:r}),o=l=>{var c;n(l),(c=r.current)==null||c.open()};return a.jsxs(a.Fragment,{children:[a.jsxs(Fs,{children:[a.jsx(se,{to:`/dashboard/category/${t.id}`,className:"hover:underline",children:t.name}),a.jsx("div",{children:a.jsx("button",{className:"",onClick:()=>o("edit"),children:a.jsx(is,{className:"w-5"})})})]}),a.jsx(ie,{variant:"animation",ref:r,children:e==="edit"&&a.jsx(C_,{variant:"edit",category:t,modalRef:r,isLoading:i,submit:l=>s({type:"edit",category:l,id:t.id})})})]})}function $Y({section:t,index:e}){const{categoryPage:n,categories:r}=qn(),s=h.useMemo(()=>{const i=[];return(t.target_ids?t.target_ids.split("_"):[]).forEach(l=>{const c=r.find(u=>u.id===l);c&&i.push(c)}),i},[n,r]);return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx("h1",{children:t.name}),a.jsx(eA,{section:t,index:e,name:t.name,variant:"category"})]}),a.jsxs(Zt,{children:[a.jsx("div",{className:"flex flex-wrap -mt-2 -mx-2",children:s.map((i,o)=>a.jsx(OY,{category:i},o))}),a.jsx(DY,{orderedCategories:s,sectionIndex:e})]})]})}function zY(){const{categoryPage:t}=qn(),{isFetching:e}=qN();return e?a.jsx(Ye,{children:a.jsx(Rn,{})}):t?a.jsx(a.Fragment,{children:a.jsxs("div",{className:"space-y-5 [&_h1]:text-lg [&_h1]:font-bold [&_h1]:text-[#333] ",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(oe,{title:"Category"}),a.jsx(XN,{})]}),a.jsx(QN,{}),t.category_sections.map((n,r)=>a.jsx($Y,{section:n,index:r},r)),t.playlist_sections.map((n,r)=>a.jsx(tA,{section:n,index:r},r))]})}):a.jsx(a.Fragment,{})}function BY(){return a.jsx(a.Fragment,{children:a.jsx(zY,{})})}function VY(){const[t,e]=h.useState(),[n,r]=h.useState([]),[s,i]=h.useState([]),o=h.useMemo(()=>t!=null&&t.playlist_ids?t.playlist_ids.split("_"):[],[t]),l=h.useMemo(()=>{const c=[];return o.forEach(u=>{const d=n.find(f=>f.id===u);d&&c.push(d)}),c},[o,n]);return{category:t,setCategory:e,playlists:n,setPlaylists:r,songs:s,setSongs:i,orderedPlaylists:l,playlistIds:o}}const rA=h.createContext(null);function UY({children:t}){return a.jsx(rA.Provider,{value:VY(),children:t})}const gl=()=>{const t=h.useContext(rA);if(!t)throw new Error("CategoryProvider is not provided");return t};function HY({closeModal:t}){const{category:e,setCategory:n}=gl(),{setErrorToast:r,setSuccessToast:s}=ne(),[i,o]=h.useState(),[l,c]=h.useState(!1),u=async()=>{try{if(!i||!e)throw new Error;c(!0);const{image_url:f,image_file_id:p,blurhash_encode:g}=await Yi({imageFile:i,height:400,width:1600}),x={banner_image_url:f,banner_file_id:p,banner_blurhash_encode:g};await Re({collectionName:"Categories",id:e.id,data:x}),e.banner_file_id&&Vt({fileId:e.banner_file_id}),n(()=>({...e,...x})),s("Update banner successful"),t()}catch(f){console.log({error:f}),r()}finally{c(!1)}},d=h.useMemo(()=>i&&URL.createObjectURL(i)||(e==null?void 0:e.banner_image_url)||"",[i]);return{category:e,imageUrl:d,imageFile:i,setImageFile:o,isFetching:l,handleSubmit:u}}function GY({closeModal:t}){const{imageUrl:e,setImageFile:n,handleSubmit:r,isFetching:s}=HY({closeModal:t});n_({setImageFileFromParent:n});const i=h.useRef(null);return a.jsxs(a.Fragment,{children:[a.jsxs(je,{className:"w-[500px]",children:[a.jsx(qe,{closeModal:t,title:"Category banner"}),a.jsxs("div",{className:"overflow-auto",children:[a.jsx("div",{className:"aspect-[16/4]",children:a.jsx(De,{className:"h-full object-cover rounded-lg",src:e})}),a.jsx("p",{className:"mt-3",children:a.jsx(J,{className:"p-1",size:"clear",onClick:()=>{var o;return(o=i.current)==null?void 0:o.open()},children:a.jsx(Ki,{className:"w-6"})})}),a.jsx("p",{className:"text-right mt-5",children:a.jsx(J,{loading:s,onClick:r,children:"Ok"})})]})]}),a.jsx(ie,{variant:"animation",ref:i,children:a.jsx(ml,{modalRef:i,setImageFile:n,title:"Category banner"})})]})}function Eh(t){const{songs:e,setSongs:n,playlists:r,setPlaylists:s,orderedPlaylists:i,category:o,setCategory:l}=gl(),{categories:c,setCategories:u}=qn(),{setErrorToast:d,setSuccessToast:f}=ne(),[p,g]=h.useState(!1),x=Gt();return{isFetching:p,action:async v=>{var _;try{if(!o)return;switch(g(!0),v.variant){case"add-songs":{const b={...o},j=[...e,...v.songs],R={song_ids:j.map(M=>M.id).join("_"),updated_at:pt()};await Re({collectionName:"Categories",data:R,id:o.id}),Object.assign(b,R),l(b),n(j),f("Add song successful");break}case"add-playlists":{const b={...o},j=[...r,...v.playlists],R={playlist_ids:j.map(M=>M.id).join("_"),updated_at:pt()};await Re({collectionName:"Categories",data:R,id:o.id}),Object.assign(b,R),l(b),s(j),f("Add playlist successful");break}case"arrange-playlist":{const b={...o},j={...v.category,updated_at:pt()};await Re({collectionName:"Categories",data:j,id:o.id}),Object.assign(b,v.category),l(b),f("Category updated");break}case"remove-song":{const b={...o},j=[...e];j.splice(v.index,1);const R={song_ids:j.map(M=>M.id).join("_"),updated_at:pt()};await Re({collectionName:"Categories",data:R,id:o.id}),Object.assign(b,R),l(b),n(j),f("Category updated");break}case"remove-playlist":{const b={...o},j=[...i];j.splice(v.index,1);const R={playlist_ids:j.map(M=>M.id).join("_"),updated_at:pt()};await Re({collectionName:"Categories",data:R,id:o.id}),Object.assign(b,R),l(b),s(j),f("Category updated");break}case"delete":{if(!o)return;o.banner_file_id&&Vt({fileId:o.banner_file_id}),o.image_file_id&&Vt({fileId:o.image_file_id}),await qw({collectionName:"Categories",id:o.id});const b=c.filter(j=>j.id!==o.id);u(b),f("Category deleted"),x("/dashboard/category");break}}(_=t==null?void 0:t.modalRef.current)==null||_.close()}catch(b){console.log(b),d()}finally{g(!1)}}}}function WY(){const{categories:t,setCategories:e}=qn(),{setSuccessToast:n}=ne(),{category:r,setCategory:s}=gl(),[i,o]=h.useState(""),{addCategory:l,isFetching:c}=nA(),{action:u,isFetching:d}=Eh(),f=v=>{var _;o(v),(_=g.current)==null||_.open()},p=()=>{var v;return(v=g.current)==null?void 0:v.close()},g=h.useRef(null),x=async(v,_)=>{if(!r)return;if(await l({variant:"edit",category:v,id:r.id,imageFile:_})){const j=[...t],T={...r};Object.assign(T,v);const R=j.findIndex(M=>M.id===r.id);R!==-1&&(Object.assign(j[R],v),e(j)),s(T),n("Category updated"),p()}},w=()=>{switch(i){case"":return a.jsx(a.Fragment,{});case"banner":return a.jsx(GY,{closeModal:p});case"edit":return r?a.jsx(a.Fragment,{children:a.jsx(C_,{submit:x,variant:"edit",isLoading:c,category:r,modalRef:g})}):"Playlist is undefined";case"delete":return a.jsx(hn,{loading:d,label:"Delete playlist ?",callback:()=>u({variant:"delete"}),closeModal:p})}};return a.jsxs(a.Fragment,{children:[a.jsx("div",{children:a.jsxs(Yc,{className:"!-mt-4",children:[a.jsxs(J,{onClick:()=>f("edit"),size:"clear",children:[a.jsx(is,{}),a.jsx("span",{children:"Edit"})]}),a.jsxs(J,{onClick:()=>f("banner"),size:"clear",children:[a.jsx(Ki,{}),a.jsx("span",{children:"Banner"})]}),a.jsxs(J,{onClick:()=>f("delete"),size:"clear",children:[a.jsx(xt,{}),a.jsx("span",{children:"Delete"})]})]})}),a.jsx(ie,{variant:"animation",ref:g,children:w()})]})}function qY(){const{orderedPlaylists:t}=gl(),[e,n]=h.useState(""),r=h.useRef(null),{action:s,isFetching:i}=Eh({modalRef:r}),o=l=>{var c;n(l),(c=r.current)==null||c.open()};return a.jsxs(a.Fragment,{children:[a.jsxs(nr,{children:[a.jsx(rr,{children:a.jsxs(J,{size:"clear",className:"p-1",children:[a.jsx(Qd,{className:"w-6"}),a.jsx("span",{className:"hidden md:block",children:"Menu"})]})}),a.jsx(sr,{className:"top-[calc(100%+8px)] right-0",children:a.jsx(cr,{className:"w-[160px]",children:a.jsxs(ls,{children:[a.jsxs("button",{onClick:()=>o("add"),children:[a.jsx(Wt,{}),a.jsx("span",{children:"Add playlist"})]}),a.jsxs("button",{disabled:t.length<2,onClick:()=>o("arrange"),children:[a.jsx(Me,{}),a.jsx("span",{children:"Arrange"})]})]})})})]}),a.jsxs(ie,{variant:"animation",ref:r,children:[e==="add"&&a.jsx(Ag,{current:t.map(l=>l.id),closeModal:()=>{var l;return(l=r.current)==null?void 0:l.close()},isLoading:i,submit:l=>s({variant:"add-playlists",playlists:l})}),e==="arrange"&&a.jsx(Fg,{closeModal:()=>{var l;return(l=r.current)==null?void 0:l.close()},isLoading:i,data:t.map(l=>({id:l.id,label:l.name})),submit:l=>s({variant:"arrange-playlist",category:{playlist_ids:l.join("_")}})})]})]})}function KY(){const{setPlaylists:t,orderedPlaylists:e,playlistIds:n}=gl(),{isFetching:r}=t_({setPlaylists:t,playlistIds:n}),s=h.useRef(null),{action:i,isFetching:o}=Eh();return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h1",{className:"text-lg font-bold text-[#333]",children:"Playlists"}),a.jsx(qY,{})]}),r&&a.jsx(Rn,{}),!r&&a.jsx(zs,{colList:["Name","Like",""],children:e.length?e.map((l,c)=>a.jsxs("tr",{children:[a.jsx("td",{children:a.jsx(se,{className:"hover:underline",to:`/dashboard/playlist/${l.id}`,children:l.name})}),a.jsx("td",{children:Ms(l.like)}),a.jsxs("td",{className:"text-right",children:[a.jsx(J,{onClick:()=>{var u;return(u=s.current)==null?void 0:u.open()},size:"clear",className:"p-1",children:a.jsx(xt,{className:"w-5"})}),a.jsx(ie,{variant:"animation",ref:s,children:a.jsx(hn,{callback:()=>i({variant:"remove-playlist",playlist:l,index:c}),closeModal:()=>{var u;return(u=s.current)==null?void 0:u.close()},loading:o,label:`Remove playlist '${l.name}'`})})]})]},c)):a.jsx("tr",{children:a.jsx("td",{colSpan:4,children:a.jsx(Fe,{})})})})]})}function QY({songs:t}){const[e,n]=h.useState(""),r=h.useRef(null),{action:s,isFetching:i}=Eh({modalRef:r}),o=l=>{var c;n(l),(c=r.current)==null||c.open()};return a.jsxs(a.Fragment,{children:[a.jsxs(nr,{children:[a.jsx(rr,{children:a.jsxs(J,{size:"clear",className:"p-1",children:[a.jsx(Qd,{className:"w-6"}),a.jsx("span",{className:"hidden md:block",children:"Menu"})]})}),a.jsx(sr,{className:"top-[calc(100%+8px)] right-0",children:a.jsx(cr,{className:"w-[140px]",children:a.jsx(ls,{children:a.jsxs("button",{onClick:()=>o("add"),children:[a.jsx(Wt,{}),a.jsx("span",{children:"Add songs"})]})})})})]}),a.jsx(ie,{variant:"animation",ref:r,children:e==="add"&&a.jsx(j_,{closeModal:()=>{var l;return(l=r.current)==null?void 0:l.close()},isLoading:i,submit:l=>s({variant:"add-songs",songs:l}),current:t.map(l=>l.id)})})]})}function XY(){const{setSongs:t,category:e,songs:n}=gl(),r=h.useRef(null),{action:s,isFetching:i}=Eh(),o=h.useMemo(()=>e!=null&&e.song_ids?e.song_ids.split("_"):[],[e]),{isFetching:l}=g5({setSongs:t,songIds:o});return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h1",{className:"text-lg font-bold text-[#333]",children:"Songs"}),a.jsx(QY,{songs:n})]}),l&&a.jsx(Rn,{}),!l&&a.jsx(zs,{colList:["Name","Singers",""],children:n.length?n.map((c,u)=>a.jsxs("tr",{children:[a.jsx("td",{children:a.jsx(se,{to:`/dashboard/song/${c.id}/edit`,className:"hover:underline",children:c.name})}),a.jsx("td",{children:c.singers.map((d,f)=>a.jsxs(se,{className:"hover:underline",to:`/dashboard/singer/${d.id}`,children:[!!f&&", ",d.name]},f))}),a.jsxs("td",{className:"text-right",children:[a.jsx(J,{onClick:()=>{var d;return(d=r.current)==null?void 0:d.open()},size:"clear",className:"p-1",children:a.jsx(xt,{className:"w-5"})}),a.jsx(ie,{variant:"animation",ref:r,children:a.jsx(hn,{callback:()=>s({variant:"remove-song",song:c,index:u}),closeModal:()=>{var d;return(d=r.current)==null?void 0:d.close()},loading:i,label:`Remove song '${c.name}'`})})]})]},u)):a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"text-center",children:a.jsx(Fe,{})})})})]})}function YY(){const{category:t,setCategory:e}=gl(),{isFetching:n}=p5({setCategory:e}),r=h.useMemo(()=>t==null?void 0:t.updated_at,[t==null?void 0:t.id]);return n?a.jsx(nu,{}):t?a.jsxs(a.Fragment,{children:[a.jsx(oe,{title:"Category Detail"}),a.jsxs("div",{className:"md:flex md:-mx-3 mt-5",children:[a.jsxs("div",{className:"md:px-3 md:w-2/3",children:[a.jsx("div",{className:"aspect-[16/4] mt-5 md:mt-0",children:a.jsx(De,{className:"h-full object-cover rounded-lg",src:t.banner_image_url})}),a.jsx("div",{className:"w-[260px] aspect-[5/3] mt-3",children:a.jsx(De,{className:"object-cover h-full rounded-lg",blurHashEncode:t.blurhash_encode,src:t.image_url})}),a.jsxs("div",{className:"mt-5 space-y-3",children:[a.jsx("div",{className:"text-2xl font-bold text-[#333]",children:t.name}),a.jsx(WY,{}),a.jsxs("p",{className:"text-sm",children:["Last updated: ",Pc(r)]})]})]}),a.jsxs("div",{className:"w-full mt-3 md:mt-0 md:px-3 space-y-3",children:[a.jsx(XY,{}),a.jsx(KY,{})]})]})]}):a.jsx(A1,{to:"/dashoboard/category"})}function JY(){return a.jsx(UY,{children:a.jsx(YY,{})})}function qE({children:t}){return a.jsx(dq,{children:t})}function ZY(){const[t,e]=h.useState(),[n,r]=h.useState([]),[s,i]=h.useState();return{imageFile:s,setImageFile:i,album:t,setAlbum:e,updateAlbumData:l=>{t&&e({...t,...l})},songs:n,setSongs:r}}const sA=h.createContext(null);function eJ({children:t}){return a.jsx(sA.Provider,{value:ZY(),children:t})}const jh=()=>{const t=h.useContext(sA);if(!t)throw new Error("AlbumProvider not provided");return t};function tJ(){const{setAlbum:t,setSongs:e}=jh(),[n,r]=h.useState(!0),s=h.useRef(!1),i=Wi(),o=Gt(),{setErrorToast:l}=ne(),c=async()=>{try{if(!i.id)return;const u=await en({collectionName:"Playlists",id:i.id});if(!u.exists())return o("/dashboard/album");const d={...u.data(),id:u.id};if(!d.is_album)return o(`/dashboard/playlist/${d.id}`);if(d.song_ids.length){const f=Ee(fn,ae(ci(),"in",d.song_ids)),p=await Cn(f);e(p)}t(d)}catch(u){console.log(u),l()}finally{r(!1)}};return h.useEffect(()=>{s.current||(s.current=!0,c())},[]),{isFetching:n}}function iA(){const{resetSelect:t}=dl(),{setErrorToast:e,setSuccessToast:n}=ne(),{album:r,songs:s,setSongs:i,updateAlbumData:o}=jh(),[l,c]=h.useState(!1),u=Gt();return{isFetching:l,action:async f=>{try{if(!r)throw new Error("album not found");switch(c(!0),f.variant){case"delete":{const p=Ls(de),g=gt(de,"Playlists",r.id),x=await tn(Ee(Yo,ae("target_id","==",r.id)));p.delete(g),x.empty||(console.log(`Delete ${x.docs.length} comments`),x.forEach(w=>p.delete(w.ref))),await Promise.all([p.commit(),r.image_file_id?Vt({fileId:r.image_file_id}):()=>{}]),n("Delete album sucessful"),u("/dashboard/album");break}case"add-songs":{const p=[...s,...f.songs],x={song_ids:p.map(w=>w.id)};await Re({collectionName:"Playlists",id:r.id,data:x,msg:">>> api: update album doc"}),o(x),i(p),n("Songs added");break}case"remove-songs":{const p=f.songs.map(w=>w.id),g=s.filter(w=>!p.includes(w.id)),x={song_ids:g.map(w=>w.id)};await Re({collectionName:"Playlists",id:r.id,data:x,msg:">>> api: update album doc"}),i(g),n(`${f.songs.length} ${f.songs.length>1?"songs":"song"}  removed`),t();break}}}catch(p){console.log({message:p}),e("")}finally{c(!1)}}}}function nJ(){const{album:t,songs:e,updateAlbumData:n}=jh(),[r,s]=h.useState(""),i=h.useRef(null),{isFetching:o,action:l}=iA(),c=p=>{var g;s(p),(g=i.current)==null||g.open()},u=()=>{var p;(p=i.current)==null||p.close()},d=async p=>{await l(p),u()},f=()=>{switch(r){case"":return a.jsx(a.Fragment,{});case"edit":return t?a.jsx(a.Fragment,{children:a.jsx(je,{className:"w-[600px]",children:a.jsx(T_,{modalRef:i,variant:"edit",afterSubmit:p=>{n(p)},album:t})})}):"Playlist is undefined";case"delete":return a.jsx(hn,{loading:o,label:"Delete album ?",callback:()=>d({variant:"delete"}),closeModal:u});case"add-songs":return a.jsx(j_,{isLoading:o,submit:p=>d({variant:"add-songs",songs:p}),closeModal:u,current:e.map(p=>p.id)})}};return a.jsxs(a.Fragment,{children:[a.jsx("div",{children:a.jsxs(Yc,{children:[a.jsxs(J,{onClick:()=>c("edit"),size:"clear",children:[a.jsx(is,{}),a.jsx("span",{children:"Edit"})]}),a.jsxs(J,{onClick:()=>c("delete"),size:"clear",children:[a.jsx(xt,{}),a.jsx("span",{children:"Delete"})]}),a.jsxs(J,{onClick:()=>c("add-songs"),size:"clear",children:[a.jsx(Wt,{}),a.jsx("span",{children:"Add song"})]})]})}),a.jsx(ie,{ref:i,variant:"animation",children:f()})]})}function rJ(){const{songs:t}=jh(),{selectedSongs:e,selectSong:n}=dl(),{action:r,isFetching:s}=iA(),i=h.useRef(null),o=async()=>{var l;await r({variant:"remove-songs",songs:e}),(l=i.current)==null||l.close()};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between items-center mb-3",children:[a.jsx(oe,{title:"Songs",variant:"h2"}),!!e.length&&a.jsx(J,{onClick:()=>{var l;return(l=i.current)==null?void 0:l.open()},className:"p-1",size:"clear",children:a.jsx(xt,{className:"w-5"})})]}),a.jsx(zs,{colList:["Name","Singer","Genre",""],children:t.length?t.map((l,c)=>{var d;const u=e.find(f=>f.id===l.id);return a.jsxs("tr",{className:u?"bg-[--a-5-cl]":"",children:[a.jsx("td",{children:a.jsx(se,{to:`/dashboard/song/${l.id}/edit`,className:"hover:underline",children:l.name})}),a.jsx("td",{children:l.singers.map((f,p)=>a.jsxs(se,{className:"hover:underline",to:`/dashboard/singer/${f.id}`,children:[!!p&&", ",f.name]},p))}),a.jsx("td",{children:(d=l.main_genre)==null?void 0:d.name}),a.jsx("td",{children:a.jsx("button",{onClick:()=>n(l),children:u?a.jsx(dh,{className:"w-5"}):a.jsx(z1,{className:"w-5"})})})]},c)}):a.jsx("tr",{children:a.jsx("td",{colSpan:4,children:a.jsx(Fe,{variant:"less"})})})})]}),a.jsx(ie,{variant:"animation",ref:i,children:a.jsx(hn,{callback:o,closeModal:()=>{var l;return(l=i.current)==null?void 0:l.close()},loading:s,label:"Remove selected songs ?"})})]})}function sJ(){const{album:t,songs:e}=jh(),{isFetching:n}=tJ(),r=h.useMemo(()=>t==null?void 0:t.updated_at,[t==null?void 0:t.id]);return n?a.jsx(Ye,{children:a.jsx(Me,{className:"w-6 animate-spin"})}):t?a.jsxs(a.Fragment,{children:[a.jsx(oe,{title:"Edit album",className:"mb-3"}),a.jsxs("div",{className:"md:flex md:-mx-3",children:[a.jsxs("div",{className:"space-y-5 md:px-3",children:[a.jsx("div",{className:"w-[200px] h-[200px] mx-auto rounded-md overflow-hidden",children:a.jsx(De,{className:"object-cover h-full rounded-lg",blurHashEncode:t.blurhash_encode,src:t.image_url})}),a.jsxs(Vd,{className:"space-y-2",children:[a.jsxs("p",{children:[a.jsx("span",{children:"Public:"}),t.is_public?"Public":"Private"]}),a.jsxs("p",{children:[a.jsx("span",{children:"Song:"}),e.length]}),a.jsxs("p",{children:[a.jsx("span",{children:"Comments:"}),Ms(t.comment)]}),a.jsx(Pg,{init:t.like,loading:!1,submit:()=>{}}),a.jsxs("p",{children:[a.jsx("span",{children:"Last update:"}),r?Pc(r):""]})]}),a.jsx(nJ,{})]}),a.jsxs("div",{className:"w-full mt-3 md:mt-0 md:w-3/4 md:px-3 space-y-5",children:[a.jsxs("div",{children:[a.jsx(oe,{title:"Info",variant:"h2",className:"mb-3"}),a.jsxs(Vd,{children:[a.jsxs("div",{children:[a.jsx("span",{children:"Name:"}),a.jsx(oe,{variant:"h1",title:t.name})]}),a.jsxs("div",{children:[a.jsx("span",{children:"Singer:"}),a.jsx(oe,{variant:"h2",title:t.singers[0].name})]})]})]}),a.jsx(rJ,{})]})]})]}):a.jsx(a.Fragment,{})}function iJ(){return a.jsx(eJ,{children:a.jsx(Os,{children:a.jsx(sJ,{})})})}function aJ(){const[t,e]=h.useState([]),[n,r]=h.useState(999),[s,i]=h.useState(!1),o=h.useRef(!0);return{currentSong:h.useMemo(()=>t[n],[t,n]),songs:t,isPlaying:s,setIsPlaying:i,setSongs:e,currentIndex:n,setCurrentIndex:r,firstTimeSongLoaded:o}}const aA=h.createContext(null);function oJ({children:t}){return a.jsx(aA.Provider,{value:aJ(),children:t})}function eo(){const t=h.useContext(aA);if(!t)throw new Error("SongsContextProvider not provided");return t}function lJ(){const{currentSong:t}=eo(),{setComments:e,isOpenComment:n,setIsFetching:r,shouldFetchComment:s}=ir(),{fetchComment:i}=Ig({setIsFetchingFromParent:r}),o=async()=>{const l=await i({target_id:t.id});l&&e(l)};h.useEffect(()=>{!n||!t||s.current&&(s.current=!1,o())},[t,n]),h.useEffect(()=>()=>{s.current=!0,e([])},[t])}function cJ(){const{user:t}=ye(),{currentSong:e}=eo(),{isOpenComment:n,setIsOpenComment:r}=ir();lJ();const{comments:s,isFetching:i}=ir(),o=n?"semi-lg:right-0 block":"semi-lg:right-[-100%] hidden semi-lg:block",l={border:"border-black/20 dark:border-white/20"};return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:`${n?"fixed":""} semi-lg:hidden bg-black/60 inset-0 z-[90]`}),a.jsx("div",{className:`transition-[right] max-h-[80vh] sm:max-h-[unset] max-w-[90vw] duration-[.3s] z-[99] semi-lg:z-[0] absolute rounded-xl  left-1/2 top-1/2 translate-y-[-50%] translate-x-[-50%] semi-lg:left-[unset] semi-lg:top-0 semi-lg:transform-none semi-lg:h-full semi-lg:min-h-[360px] w-[400px] xl:w-[480px] semi-lg:p-4 top-0 ${o}`,children:a.jsxs("div",{className:`semi-lg:border text-white h-[400px] bg-[#333] p-5 semi-lg:p-3 semi-lg:h-full w-full rounded-xl flex flex-col ${l.border}`,children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(oe,{variant:"h2",title:"Comments"}),a.jsx(ce,{onClick:()=>r(!1),className:"p-1.5 hover:bg-black/20",size:"clear",children:a.jsx(hh,{className:"w-8"})})]}),a.jsx(h_,{variant:"dark-bg",isFetching:i,comments:s,className:"pr-2"}),t&&e&&a.jsx(Vg,{bg:"bg-white/10",variant:"comment",targetId:e.id})]})})]})}function uJ(){const[t,e]=h.useState("idle"),[n,r]=h.useState(!1),[s,i]=h.useState([]),o=h.useRef(null),l=h.useRef("idle"),c=h.useRef(!0),u=h.useRef(!0);return{status:t,setStatus:e,statusRef:l,controlRef:o,canPlay:n,setCanPlay:r,lyrics:s,setLyrics:i,shouldGetLyric:c,shouldPlayAfterLoaded:u}}const oA=h.createContext(null);function dJ({children:t}){return a.jsx(oA.Provider,{value:uJ(),children:t})}function su(){const t=h.useContext(oA);if(!t)throw new Error("PlayerProvider not provided");return t}function hJ({audioEle:t}){const{setStatus:e,shouldPlayAfterLoaded:n,canPlay:r}=su(),{firstTimeSongLoaded:s,currentSong:i}=eo(),o=()=>{e("loading")},l=async()=>{if(s.current){s.current=!1,e("paused");return}n.current&&(n.current=!1,await(t==null?void 0:t.play()))},c=()=>{e("error")};h.useEffect(()=>{r&&i&&(t.src=i.song_url)},[r]),h.useEffect(()=>(t.addEventListener("error",c),t.addEventListener("loadstart",o),t.addEventListener("loadedmetadata",l),()=>{t.removeEventListener("error",c),t.removeEventListener("loadstart",o),t.removeEventListener("loadedmetadata",l)}),[])}function fJ({isLiked:t,song:e}){const{action:n,loading:r}=$g();return a.jsx("button",{className:" ",onClick:()=>n({variant:"like",song:e}),children:r?a.jsx(Me,{className:" animate-spin"}):a.jsx(Xc,{className:t?"text-[--primary-cl]":""})})}function mJ({song:t}){const{setIsOpenComment:e}=ir(),{user:n}=ye();return a.jsxs("div",{className:`flex 
			space-x-2
			[&_button]:rounded-full
			[&_button]:p-2
			[&_svg]:w-6
			hover:[&_button]:bg-white/10
			[&_div]:flex-col
			[&_div]:flex
			[&_span]:text-center
			[&_span]:font-medium
		 `,children:[n&&a.jsx("div",{children:a.jsx(fJ,{isLiked:n.liked_song_ids.includes(t.id),song:t})}),a.jsx("div",{children:a.jsx("button",{onClick:()=>e(!0),children:a.jsx(Q9,{})})})]})}function pJ({audioEle:t,song:e}){const{status:n,controlRef:r,setStatus:s,statusRef:i}=su();hJ({audioEle:t});const{pause:o,play:l,handlePlayPause:c,progressLineRef:u}=bg({audioEle:t,setStatusFromParent:s,statusFromParent:n,statusRefFromParent:i,baseColor:"rgba(255,255,255,0.1)",color:"#fff"});h.useImperativeHandle(r,()=>({pause:o,play:l,handlePlayPause:c}));const d=()=>{switch(n){case"playing":return a.jsx(hl,{});case"paused":return a.jsx(si,{});case"error":return a.jsx(cR,{});case"loading":return a.jsx(Me,{className:"animate-spin"});default:return a.jsx(qi,{})}};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex",children:[a.jsx("button",{onClick:c,className:"[&_svg]:w-7",children:d()}),a.jsx("div",{className:"flex space-x-2 ml-auto",children:a.jsx(mJ,{song:e})})]}),a.jsx("div",{className:"h-2 flex items-center mt-3",children:a.jsx(wh,{bg:"rgba(255,255,255,0.1)",elelRef:u,className:`h-1 ${n==="idle"?"hidden":""}`})})]})}const gJ=.3;function xJ({audioEle:t,lyrics:e,isActive:n,bounded:r}){const[s,i]=h.useState(0),o=h.useRef(0),l=h.useRef(0),c=()=>{const u=t.currentTime>o.current?"forward":"backward";o.current=t.currentTime;let d=l.current;const f=r||gJ;switch(u){case"forward":for(;e[d+1]&&e[d+1].start-f<o.current+f;)d+=1;break;case"backward":for(;e[d-1]&&e[d-1].end-f>o.current+f;)d-=1;break}d!==l.current&&(l.current=d,i(d))};return h.useEffect(()=>{if(!(!n||!e.length))return t.addEventListener("timeupdate",c),()=>{t.removeEventListener("timeupdate",c)}},[e,n]),{currentIndex:s}}function yJ(){const{canPlay:t,setLyrics:e,shouldGetLyric:n}=su(),{currentSong:r}=eo(),s=h.useRef(),{loading:i,getLyric:o}=f5({}),l=async()=>{if(r&&r.lyric_id){const c=await o(r);c&&e(JSON.parse(c==null?void 0:c.lyrics))}};return h.useEffect(()=>{t&&n.current&&(n.current=!1,s.current=setTimeout(l,500))},[t]),{isFetching:i}}function vJ({audioEle:t}){const{lyrics:e,canPlay:n}=su(),{isFetching:r}=yJ(),s=h.useRef(null),i=h.useRef(null),o=h.useRef(40),{currentIndex:l}=xJ({audioEle:t,lyrics:e,isActive:n,bounded:0}),c=h.useMemo(()=>e[l]?a.jsxs(a.Fragment,{children:[a.jsx("p",{style:{transform:`translateY(calc(${o.current}px)`},className:"transition-transform origin-bottom-left duration-[.4s]",ref:s,children:e[l].text},l+"1"),e[l+1]&&a.jsx("p",{ref:i,className:"mt-3 transition-[transform,opacity] text-[#e1e1e1] duration-[.4s] opacity-0 translate-y-[-10px]",children:e[l+1].text},l+"11")]}):a.jsx(a.Fragment,{}),[l,e]),u={container:"no-scrollbar leading-[1.2] [&_p]:w-[80%] [&_p]:select-none [&_p]:font-bold pt-3"};return h.useEffect(()=>{setTimeout(()=>{s.current&&(Object.assign(s.current.style,{transform:"scale(1.3) translateY(0px)"}),o.current=+(s.current.offsetHeight*1.3).toFixed(1)),i.current&&Object.assign(i.current.style,{transform:"translateY(0px)",opacity:"1"})},30)},[l,e]),a.jsxs("div",{className:`${u.container}`,children:[r&&a.jsx("div",{className:"relative w-full h-full",children:a.jsx(Me,{className:"w-7 animate-spin"})}),!r&&a.jsx(a.Fragment,{children:e.length?c:a.jsx("div",{children:"..."})})]})}function wJ({index:t,songItemRef:e}){const{currentIndex:n,setCurrentIndex:r}=eo(),{setCanPlay:s,canPlay:i,controlRef:o,statusRef:l}=su(),[c,u]=h.useState(!1),d=h.useRef(),f=h.useMemo(()=>n===t,[n]),p=g=>{const[x]=g;u(x.isIntersecting)};h.useEffect(()=>{var g,x;f?i?(g=o.current)==null||g.play():s(!0):i&&l.current==="playing"&&((x=o.current)==null||x.pause())},[f]),h.useEffect(()=>{e.current&&new IntersectionObserver(p,{threshold:1}).observe(e.current)},[]),h.useEffect(()=>(d.current=setTimeout(()=>{c&&r(t)},600),()=>{clearTimeout(d.current)}),[c])}function _J({song:t,index:e,songItemRef:n}){const{controlRef:r}=su(),s=h.useRef(null);return wJ({index:e,songItemRef:n}),a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"relative z-0 flex items-center flex-shrink-0 text-white h-full w-full sm:w-auto sm:aspect-[3/5] rounded-xl overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0 z-[-1] overflow-hidden ",children:t.blurhash_encode&&a.jsx(tu,{hash:t.blurhash_encode,height:"100%",width:"100%"})}),a.jsx("div",{className:"absolute top-0 left-0 w-full z-[99]",children:a.jsxs("div",{className:"relative p-4",children:[s.current&&a.jsx(vJ,{audioEle:s.current}),a.jsx("div",{className:"absolute inset-0 z-[-1] bg-gradient-to-b from-black/20 to-transparent"})]})}),a.jsx("div",{className:"w-full aspect [1/1] overflow relative mask-image",children:a.jsx("img",{onClick:()=>{var i;return(i=r.current)==null?void 0:i.handlePlayPause()},className:"w-full object-cover",src:t.image_url})}),a.jsx("div",{className:"absolute z-0 bottom-0 left-0 w-full",children:a.jsxs("div",{className:"relative p-4",children:[a.jsx("div",{className:"absolute inset-0 z-[-1] bg-gradient-to-b to-black/60 from-transparent"}),a.jsx("div",{className:"font-bold",children:t.name}),a.jsx("div",{className:"font-semibold opacity-[.8] text-sm",children:t.singers.map((i,o)=>a.jsxs("span",{children:[" ",(o?", ":"")+i.name]},o))}),a.jsx("div",{className:"mt-2",children:s.current&&a.jsx(pJ,{song:t,audioEle:s.current})})]})})]}),a.jsx("audio",{className:"hidden",ref:s})]})}function bJ(t,e){const{isOpenComment:n}=ir(),r=h.useRef(null);return h.useImperativeHandle(e,()=>r.current),a.jsx(a.Fragment,{children:a.jsx("div",{className:"h-full flex-shrink-0 p-4 min-h-[360px] snap-center",children:a.jsx("div",{"data-index":t.index,className:`relative h-full w-full transition-[right] duration-[.3s]  ${n?"semi-lg:right-[calc(400px*0.5)] ":"right-0"}`,ref:r,children:a.jsx(dJ,{children:a.jsx(_J,{...t,songItemRef:r})})})})})}const KE=h.forwardRef(bJ);function SJ(){const{setSongs:t}=eo(),{setErrorToast:e}=ne(),[n,r]=h.useState(!0),s=h.useRef(!1),i=h.useRef(),o=h.useRef(null),l=h.useCallback(u=>{o.current&&o.current.disconnect(),o.current=new IntersectionObserver(d=>{d[0].isIntersecting&&c()},{threshold:1}),u&&o.current.observe(u)},[]),c=async()=>{try{r(!0);const u=i.current?Ee(fn,ae("is_official","==",!0),dn("updated_at","desc"),xg(i.current),kn(3)):Ee(fn,ae("is_official","==",!0),dn("updated_at","desc"),kn(3)),d=await tn(u);if(d.docs){i.current=d.docs[d.docs.length-1];const f=d.docs.map(p=>({...p.data(),id:p.id,queue_id:fl(4)}));t(p=>[...p,...f])}}catch(u){console.log({message:u}),e()}finally{r(!1)}};return h.useEffect(()=>{s.current||(s.current=!0,c())},[]),{isFetching:n,getSong:c,lastElementRef:l}}function lA(){const{user:t,updateUserData:e}=ye();return{pushRecentSong:async r=>{if(r.is_official)if(t){const s=[...t.recent_song_ids];if(!s.includes(r.id)){s.unshift(r.id);const o={recent_song_ids:s.slice(0,10)};e(o),Re({collectionName:"Users",data:o,id:t.email})}}else{const s=un()["recent-songs"]||[];s.find(o=>o.id===r.id)||s.unshift(r),ot("recent-songs",s)}}}}function EJ(){const{currentSong:t}=eo(),{pushRecentSong:e}=lA(),n=h.useRef();h.useEffect(()=>{if(t)return n.current=setTimeout(()=>{HR(t.id),e(t)},5e3),()=>{clearTimeout(n.current)}},[t])}function jJ(){const{setCurrentIndex:t,songs:e}=eo(),{isFetching:n,lastElementRef:r}=SJ();EJ();const s=h.useMemo(()=>e.map((i,o)=>e.length===o+1?a.jsx(KE,{index:o,ref:r,song:i},o):a.jsx(KE,{index:o,song:i},o)),[e]);return h.useEffect(()=>{setTimeout(()=>{t(0)},1e3)},[]),a.jsxs("div",{style:{overflowAnchor:"none"},className:"h-full snap-y snap-mandatory overflow-auto no-scrollbar flex flex-col md:items-center",children:[n&&a.jsx(Ye,{children:a.jsx(nu,{})}),s]})}function kJ(){const t=h.useRef(!1);return h.useEffect(()=>{t.current||(t.current=!0,window.history.scrollRestoration="manual",document.title="Dmusic")},[]),a.jsx(oJ,{children:a.jsx(Bg,{target:"song",children:a.jsxs("div",{className:"fixed bg-[--layout-cl] md:bg-transparent top-0 left-0 right-0 bottom-[47px] md:inset-0 sm:relative overflow-hidden flex-grow",children:[a.jsx(jJ,{}),a.jsx(cJ,{})]})})})}const yi={home:"/",discorver:"/discover",catogory:"/category",search:"/search",playlist:"/playlist/:id",login:"/login",unauthorized:"/unauthorized",singer:"/singer/:id",user:"/user/:id",trending:"/trending",catogoryDetail:"/category/:id"},QE={myMusic:"/my-music",songLyric:"/my-music/lyric/:id"},On={dashboard:"/dashboard",genre:"/dashboard/genre",playlist:"/dashboard/playlist",song:"/dashboard/song",addSong:"/dashboard/song/add-song",editSong:"/dashboard/song/:songId/edit",playlistDetail:"/dashboard/playlist/:id",songLyric:"/dashboard/lyric/:id",singer:"/dashboard/singer",editSinger:"/dashboard/singer/:id",album:"/dashboard/album",editAlbum:"/dashboard/album/:id",homepage:"/dashboard/homepage",category:"/dashboard/category",categoryDetail:"/dashboard/category/:id"},TJ=[{path:yi.home,component:kJ,layout:""},{path:yi.discorver,component:xH,layout:""},{path:yi.playlist,component:oG,layout:""},{path:yi.search,component:SW,layout:""},{path:yi.singer,component:BW,layout:""},{path:yi.user,component:UW,layout:""},{path:yi.catogory,component:WW,layout:""},{path:yi.trending,component:eq,layout:""},{path:yi.catogoryDetail,component:nq,layout:""}],IJ=[{path:QE.myMusic,component:wG,layout:""},{path:QE.songLyric,component:hW,layout:""}],CJ=[{path:On.dashboard,component:aq,layout:""},{path:On.playlist,component:UX,layout:""},{path:On.genre,component:rY,layout:""},{path:On.singer,component:tY,layout:""},{path:On.editSinger,component:_Y,layout:""},{path:On.playlistDetail,component:YX,layout:""},{path:On.album,component:jY,layout:""},{path:On.editAlbum,component:iJ,layout:""},{path:On.song,component:cq,layout:""},{path:On.addSong,component:LX,layout:qE},{path:On.editSong,component:$X,layout:qE},{path:On.songLyric,component:WE,layout:""},{path:On.songLyric,component:WE,layout:""},{path:On.homepage,component:FY,layout:""},{path:On.category,component:BY,layout:""},{path:On.categoryDetail,component:JY,layout:""}];function RJ(){const{user:t,loading:e}=ye();return e?a.jsx(Ye,{children:a.jsx(nu,{})}):t?a.jsx(zp,{}):a.jsx(A1,{state:{from:"/my-music"},replace:!0,to:"/login"})}function NJ(){const{user:t,loading:e}=ye();return e?a.jsx(Ye,{children:a.jsx(nu,{})}):t&&t.role==="ADMIN"?a.jsx(zp,{}):a.jsx(A1,{replace:!0,to:"/unauthorized"})}const cA=[{path:"/dashboard/homepage",title:"Home Page",icon:a.jsx(Yd,{})},{path:"/dashboard/category",title:"Category",icon:a.jsx(Hp,{})},{path:"/dashboard/song",title:"Songs",icon:a.jsx(qi,{})},{path:"/dashboard/playlist",title:"Playlists",icon:a.jsx(xF,{})},{path:"/dashboard/album",title:"Albums",icon:a.jsx(IT,{})},{path:"/dashboard/singer",title:"Singers",icon:a.jsx(Iy,{})},{path:"/dashboard/genre",title:"Genres",icon:a.jsx(OF,{})}];function AJ(){const[t,e]=h.useState(!1);Wn();const n={container:"hidden md:block bg-[#f1f1f1] text-[#333] border-r border-black/10 transition-[width] relative flex-shrink-0",head:"h-[60px] flex items-center justify-center",logoText:"text-[22px] font-[500] whitespace-nowrap tracking-[-1px]",logoImage:"max-w-[50px] p-[4px]",item:"hover:bg-[--a-5-cl] flex whitespace-nowrap space-x-2 items-center justify-center p-2.5 text-sm",icon:"w-[24px] flex-shrink-0"};return a.jsxs("div",{className:`${n.container} ${t?"w-[150px]":"w-[70px]"}`,children:[a.jsx("div",{className:"h-[60px] flex items-center justify-center",children:a.jsx("div",{className:"w-10 flex items-center justify-center  bg-white rounded-full",children:a.jsx("span",{className:"font-bold text-[--primary-cl] leading-[40px] translate-y-[1px]",children:":D"})})}),a.jsxs("div",{className:"[&_svg]:w-5 [&_svg]:flex-shrink-0",children:[a.jsxs(se,{className:`
              ${n.item} ${t?"!justify-start":""}
              ${location.hash==="#/dashboard"?"text-[--primary-cl]":""}`,to:"/dashboard",children:[a.jsx(Bp,{}),t&&a.jsx("span",{children:"Dashboard"})]}),cA.map((r,s)=>a.jsxs(se,{className:`
              ${n.item} ${t?"!justify-start":""}
              ${location.hash.includes(r.path)?"text-[--primary-cl]":""}`,to:r.path,children:[r.icon,t&&a.jsx("span",{children:r.title})]},s)),a.jsxs(se,{to:"/",target:"_blank",className:`${n.item} ${t?"!justify-start":""}
               ${location.pathname==="/dashboard"?"text-[--primary-cl]":""}
               `,children:[a.jsx(jT,{className:n.icon}),t&&a.jsx("span",{children:"Home"})]})]}),a.jsx(J,{onClick:()=>e(r=>!r),size:"clear",className:"!absolute p-1.5 bottom-5 right-0 translate-x-[50%]",children:t?a.jsx(SH,{className:"w-5 "}):a.jsx(kH,{className:"w-5"})})]})}function uA({className:t=""}){const{behind:e,ahead:n,backward:r,forward:s}=Y5();return a.jsxs("div",{className:`"flex space-x-3 [&>button]:p-1 ${t}`,children:[a.jsx("button",{onClick:r,className:`relative ${Pd(!e.length)}`,children:a.jsx(P1,{className:"w-5"})}),a.jsx("button",{onClick:s,className:`relative ${Pd(!n.length)}`,children:a.jsx(ET,{className:"w-5"})})]})}const PJ=()=>{const{spotifyToken:t,setSpotifyToken:e}=ye();return h.useEffect(()=>{const n=Xr.interceptors.request.use(s=>(s.headers.Authorization||(s.headers.Authorization=`Bearer ${t||"invalid token"}`),s),s=>Promise.reject(s)),r=Xr.interceptors.response.use(s=>s,async s=>{var o;const i=s==null?void 0:s.config;if(((o=s==null?void 0:s.response)==null?void 0:o.status)===401&&!(i!=null&&i.sent)){i.sent=!0;const l=await Xr.get("/spotify/token");if(l.data){const c=l.data.data.access_token;e(c),i.headers.Authorization=`Bearer ${c}`}return Xr(i)}return Promise.reject(s)});return()=>{Xr.interceptors.request.eject(n),Xr.interceptors.response.eject(r)}},[t]),Xr};function FJ(){const{setErrorToast:t}=ne(),[e,n]=h.useState([]),[r,s]=h.useState(""),[i,o]=h.useState(!1),[l,c]=h.useState(!1),[u,d]=h.useState(!1),f=h.useRef(null),p=PJ(),g=async w=>{var v,_;try{if(w.preventDefault(),!r.trim()||i)return;o(!0);const b=await p.get(`https://api.spotify.com/v1/search?q=${r}&limit=3&type=track`);(_=(v=b.data)==null?void 0:v.tracks)!=null&&_.items&&(console.log(b.data.tracks.items),n(b.data.tracks.items),c(!0))}catch(b){console.log({message:b}),t()}finally{o(!1)}},x=w=>{const v=document.querySelector(".search-result"),_=w.target;!f.current||v!=null&&v.contains(_)||f.current.contains(_)||d(!1)};return h.useEffect(()=>(u&&document.addEventListener("click",x),()=>{document.removeEventListener("click",x)}),[u]),{isFetching:i,value:r,setValue:s,handleSubmit:g,items:e,showResult:l,isFocus:u,setIsFocus:d,handleClickOutside:x,formRef:f,setShowResult:c}}function MJ(){const{isFetching:t,isFocus:e,setIsFocus:n,setShowResult:r,items:s,formRef:i,showResult:o,...l}=FJ();return a.jsx(a.Fragment,{children:a.jsxs("div",{className:"relative",children:[a.jsx(Ji,{frame:!1,formRef:i,whenClear:()=>r(!1),className:"mb-3",onFocus:()=>n(!0),place:"Search on spotify...",...l}),a.jsxs(cr,{className:`${e?"":"hidden"} search-result absolute px-2 top-[calc(100%+8px)] right-0 w-[120%] popup-shadow`,children:[!t&&!o&&a.jsx("span",{children:"Search on spotify..."}),t&&a.jsx(Rn,{}),!t&&o&&a.jsx(a.Fragment,{children:s.length?a.jsx("div",{className:"overflow-auto",children:s.map((c,u)=>a.jsxs("div",{className:"p-1 flex result-item",children:[a.jsx("div",{className:"w-16 h-16 flex-shrink-0 rounded-md overflow-hidden",children:a.jsx("img",{src:c.album.images[0].url,alt:"",className:"w-full h-full object-conver"})}),a.jsxs("div",{className:"ml-2 font-bold text-left",children:[a.jsx("p",{className:"",children:c.name}),a.jsx("p",{className:"text-sm item-info",children:c.artists.map((d,f)=>a.jsx("span",{children:(f?", ":"")+d.name},f))}),a.jsx("p",{className:"item-info text-sm",children:c.album.release_date})]})]},u))}):a.jsx(Fe,{})})]})]})})}function DJ(){const[t,e]=h.useState(0),n=r=>{const s=r.target.scrollTop||0;e(s)};return h.useEffect(()=>{const r=document.querySelector(".main-container");return r==null||r.addEventListener("scroll",n),()=>{r==null||r.removeEventListener("scroll",n)}},[]),a.jsx(a.Fragment,{children:a.jsxs("div",{className:`hidden md:flex px-[40px] z-[99] h-[60px] flex-shrink-0 items-center justify-between ${t?" shadow-lg":""}`,children:[a.jsxs("div",{className:"flex",children:[a.jsx(se,{to:"/dashboard",className:"text-xl font-bold text-[--primary-cl]",children:"Dashboard"}),a.jsx(uA,{className:"ml-5"})]}),a.jsx(MJ,{})]})})}function LJ(){const[t,e]=h.useState(!1),n=h.useRef(null),r=s=>{var i;(i=n.current)!=null&&i.contains(s.target)||e(!1)};return h.useEffect(()=>(t&&window.addEventListener("click",r),()=>{window.removeEventListener("click",r)}),[t]),a.jsxs(a.Fragment,{children:[a.jsxs(Zt,{className:`[&_svg]:w-6 [&_span]:font-semibold text-sm absolute z-[99] duration-[.25] flex flex-col
        transition-[left,opacity] bg-[--popup-cl] bottom-[60px] 
        ${t?"left-[10px] opacity-[1] pointer-events-auto":"left-0 opacity-[0] pointer-events-none"}`,children:[a.jsxs(se,{className:"inline-flex items-center py-1.5 space-x-2",to:"/dashboard",children:[a.jsx(Bp,{}),a.jsx("span",{children:"Dashboard"})]}),cA.map((s,i)=>a.jsxs(se,{className:"inline-flex items-center py-1.5 space-x-2",to:s.path,children:[s.icon,a.jsx("span",{children:s.title})]},i)),a.jsxs(se,{className:"inline-flex items-center py-1.5 space-x-2",target:"_blank",to:"/",children:[a.jsx(jT,{}),a.jsx("span",{children:"Go to app"})]})]}),a.jsx(J,{ref:n,size:"clear",onClick:()=>e(!t),className:"!absolute transition-[left] z-[99] bottom-[10px] left-[10px]  p-1.5",children:a.jsx(Qd,{className:"w-6"})})]})}function OJ({className:t="",toast:e,onClick:n}){const[r,s]=h.useState(!1),i={icon:"w-6",container:"transition-[transform,opacity] popup-shadow px-3 py-2 space-x-2 rounded-md flex items-center bg-[--popup-cl] text-[--text-cl] w-full",text:"font-semibold text-sm",open:"opacity-[1] translate-x-0",init:"opacity-0 translate-x-10"},o=()=>{switch(e.variant){case"success":return a.jsx(dh,{className:`${i.icon} text-emerald-500`});case"error":return a.jsx(hh,{className:`${i.icon} text-red-500`})}};return h.useEffect(()=>{setTimeout(()=>{s(!0)},0)},[]),a.jsxs("div",{onClick:()=>n?n(e.id):void 0,className:`whitespace-nowrap ${i.container} ${t} ${r?i.open:i.init} `,children:[o(),a.jsx("p",{className:i.text,children:e.desc})]})}const dA=({time:t=6e3,className:e=""})=>{const{setToasts:n,toasts:r}=ne(),[s,i]=h.useState(""),o=l=>{n(c=>c.filter(u=>u.id!=l))};return h.useEffect(()=>{s&&n(l=>l.filter(c=>c.id!=s))},[s]),h.useEffect(()=>{if(!r.length)return;const l=r[r.length-1].id;setTimeout(()=>{i(l)},t)},[r]),a.jsx(a.Fragment,{children:il.createPortal(a.jsx("div",{className:`fixed z-[199] ${e}`,children:a.jsx("div",{className:"flex flex-col gap-[10px]",children:!!r.length&&r.map((l,c)=>a.jsx(OJ,{onClick:o,toast:l},c))})}),document.getElementById("portals"))})};function $J({children:t}){return Wn().pathname.includes("lyric")?t:a.jsx("div",{className:"pb-[46px]",children:t})}function zJ(){const{isOnMobile:t}=as(),e=h.useRef(!1);return h.useEffect(()=>{if(!e.current){e.current=!0;const n=document.querySelector("body");n&&(n.setAttribute("data-theme","white"),n.classList.remove("dark")),document.title="Dashboard"}},[]),a.jsx(a.Fragment,{children:a.jsx(ZC,{children:a.jsx(mq,{children:a.jsx(WB,{children:a.jsx(_q,{children:a.jsxs("div",{className:"bg-[--layout-cl] text-[--text-cl] fixed inset-full flex ",children:[t?a.jsx(LJ,{}):a.jsx(AJ,{}),a.jsxs("div",{className:"flex flex-col flex-grow",children:[a.jsx(DJ,{}),a.jsx("div",{className:"main-container flex flex-col flex-grow overflow-auto p-[10px] md:px-[40px] md:pt-0",children:a.jsx($J,{children:a.jsx(zp,{})})})]}),a.jsx(dA,{className:"left-[50%] translate-x-[-50%] top-[10px] md:top-[unset] md:bottom-[60px] md:left-[20px] md:translate-x-0"}),a.jsx(JC,{})]})})})})})})}function BJ({variant:t="desktop"}){const{desktopTabs:e,activeTab:n,setActiveTab:r,mobileActiveTab:s,mobileTabs:i,setMobileActiveTab:o,idle:l}=lt(),c=t==="desktop"?n:s,u=t==="desktop"?r:o,d=t==="desktop"?e:i,f={item:"px-3 md:px-8 leading-[30px] font-bold cursor-pointer  rounded-full",fadeTransition:"opacity-0 transition-opacity duration-[.3s]"};return a.jsx("ul",{className:`inline-flex mx-auto rounded-full space-x-1 bg-white/10 p-1 ${l?f.fadeTransition:""}`,children:d.map((p,g)=>{const x=p===c;return a.jsx("li",{onClick:()=>u(p),className:`${f.item} ${x?"bg-white/20":"hover:bg-white/5"}`,children:p},g)})})}function VJ({children:t}){const{isOpenComment:e,setIsOpenComment:n}=ir(),r={mainContainer:"hidden fixed w-[400px] md:flex flex-col bottom-0 right-[0] top-0 z-[99] p-3 pb-5 text-white border-l-[1px] border-[--a-5-cl] transition-[transform] duration-[.5s] linear delay-100"};return a.jsxs("div",{className:`text-white ${r.mainContainer} ${e?"translate-x-0":"translate-x-full"}     `,children:[a.jsx("div",{className:"bg-opacity-[0.8] backdrop-blur-[15px] z-[-1] bg-[#333] absolute inset-0"}),a.jsx("p",{children:a.jsx("button",{className:"p-1.5",onClick:()=>n(!1),children:a.jsx(hh,{className:"w-7"})})}),t]})}function UJ(){const{shouldFetchComment:t,setComments:e,isOpenComment:n,setIsFetching:r}=ir(),{currentSongData:s}=fe(rt),{fetchComment:i}=Ig(),o=async()=>{try{if(!(s!=null&&s.song))return;const l=await i({target_id:s.song.id});e(l||[])}catch(l){console.log({error:l})}finally{r(!1)}};h.useEffect(()=>{!n||!(s!=null&&s.song)||t.current&&(t.current=!1,o())},[n]),h.useEffect(()=>()=>{t.current||(t.current=!0)},[s==null?void 0:s.song])}function hA(){const{isFetching:t,comments:e}=ir();return UJ(),t?a.jsx(Ye,{children:a.jsx(Me,{className:"w-6 animate-spin"})}):a.jsx(h_,{comments:e})}function HJ({song:t}){const{setIsOpenComment:e,isOpenComment:n}=ir(),{isOpenFullScreen:r}=lt(),{user:s}=ye();return h.useEffect(()=>{!r&&n&&e(!1)},[r]),a.jsxs(a.Fragment,{children:[a.jsx(Fi,{colorClasses:"bg-[#333] text-white",position:"top-[calc(100%+8px)]",content:"Comment",children:a.jsx("button",{onClick:()=>e(!0),className:"btn",children:a.jsx(D1,{})})}),il.createPortal(a.jsxs(VJ,{children:[a.jsx(hA,{}),s&&a.jsx(Vg,{variant:"comment",targetId:t.id})]}),document.getElementById("portals"))]})}function GJ(){const{user:t}=ye(),{activeTab:e,idle:n,setIsOpenFullScreen:r}=lt(),{currentSongData:s}=fe(rt),i=Gt(),o=s&&t?s.song.owner_email===t.email&&s.song.is_official===!1:!1,l=()=>{s!=null&&s.song&&(r(!1),setTimeout(()=>{i(`/my-music/lyric/${s==null?void 0:s.song.id}`)},300))},c={button:"btn",rightCta:"absolute flex right-4 space-x-3 [&_button.btn]:h-[38px] [&_button.btn]:w-[38px] hover:[&_button.btn]:bg-white/5 [&_button.btn]:p-2 [&_button.btn]:rounded-full",headerWrapper:"relative z-[90] flex py-[25px] px-[40px] w-full items-center",fadeTransition:"opacity-0 transition-opacity duration-[.3s]"};return a.jsx(a.Fragment,{children:a.jsxs("div",{className:`${c.headerWrapper} ${n?"pointer-events-none":""}`,children:[n&&s&&a.jsx("div",{className:"absolute left-4 text-sm font-bold",children:e!=="Songs"&&a.jsxs(a.Fragment,{children:[a.jsx("p",{children:s.song.name}),a.jsx("p",{className:"opacity-70",children:s.song.singers.map((u,d)=>(d?", ":"")+u.name)})]})}),a.jsx(BJ,{}),a.jsxs("div",{className:`absolute flex right-4 space-x-3 ${n&&c.fadeTransition} ${c.rightCta}`,children:[a.jsx(Bg,{target:"song",children:(s==null?void 0:s.song)&&a.jsx(HJ,{song:s.song})}),o&&e==="Lyric"&&a.jsx(Fi,{colorClasses:"bg-[#333] text-white",position:"top-[calc(100%+8px)]",content:"Edit lyric",children:a.jsx("button",{onClick:()=>l(),className:` ${c.button}`,children:a.jsx(Vp,{})})}),a.jsxs(nr,{children:[a.jsx(rr,{children:a.jsx(Fi,{colorClasses:"bg-[#333] text-white",isWrapped:!0,position:"top-[calc(100%+8px)]",content:"Setting",children:a.jsx("button",{className:`${c.button} `,children:a.jsx(O1,{})})})}),a.jsx(sr,{className:"top-[calc(100%+8px)] right-0",animationClassName:"origin-top-right",children:a.jsx(F5,{})})]}),a.jsx(Fi,{colorClasses:"bg-[#333] text-white",position:"top-[calc(100%+8px)]",content:"Close",children:a.jsx("button",{onClick:()=>r(!1),className:`p-2 ${c.button}`,children:a.jsx(kT,{})})})]})]})})}function fA({className:t}){const{playerConfig:{lyricSize:e},audioRef:n,isOpenFullScreen:r,activeTab:s}=lt();if(!n.current)throw new Error("audioRef error");const{loading:i,songLyrics:o}=Fw(),l=h.useMemo(()=>r&&s==="Lyric",[r,s]),{currentIndex:c,lyricRefs:u}=nN({audioEle:n.current,isActive:l,lyrics:o,bounded:0}),d={small:"text-[16px] sm:text-[26px]",medium:"text-[20px] sm:text-[30px]",large:"text-[26px] sm:text-[46px]"},f=()=>o.map((g,x)=>{let w="coming";return c===x?w="active":x<c&&(w="done"),a.jsx(tN,{ref:v=>u.current[x]=v,status:w,text:g.text,activeColor:"text-[#fff]"},x)}),p={container:"no-scrollbar pt-10 mask-image overflow-y-auto overflow-x-hidden font-['Inter',system-ui] [&_p:not(.active-lyric)]:opacity-40 [&_p]:mb-5 [&_p:last-child]:mb-[50vh]"};return a.jsxs("div",{className:`${p.container} ${d[e||"medium"]} ${t}`,children:[i&&a.jsx("div",{className:"relative w-full h-full",children:a.jsx(Ye,{children:a.jsx(Me,{className:"w-7 animate-spin"})})}),!i&&a.jsx(a.Fragment,{children:o.length?f():a.jsx("div",{className:"relative w-full h-full",children:a.jsx(Ye,{children:a.jsx("h1",{className:"text-[30px] opacity-60",children:"..."})})})})]})}const WJ=.3,XE=t=>t%2!==0;function qJ(t){const{songLyrics:e,loading:n}=Fw(),{audioRef:r,isOpenFullScreen:s,activeTab:i}=lt();if(!r.current)throw new Error("useKaraoke !audioRef.current");const{playStatus:o}=fe(lr),[l,c]=h.useState(0),u=h.useRef(null),d=h.useRef(null),f=h.useRef(null),p=h.useRef(null),g=h.useRef(0),x=h.useRef(0),w=h.useRef("paused"),v=h.useRef(!1),_=h.useMemo(()=>s&&i=="Karaoke",[s,i]),b=h.useMemo(()=>{if(e.length){if(l<0)return{odd:"",even:""};const M=XE(l);if(!e[l+1])return{odd:"",even:""};const k=M?[l,l+1]:[l+1,l],E=e[k[0]].text.trim(),I=e[k[1]].text.trim();return{odd:E,even:I}}else return{odd:"",even:""}},[l,e]),j=M=>{M.style.animation="none"},T=(M,k,E,I)=>{var D,P;let C="running";w.current==="paused"&&(C="paused"),E.style.animation=`${M} ${(((D=k==null?void 0:k.tune)==null?void 0:D.end)||k.end)-(((P=k==null?void 0:k.tune)==null?void 0:P.start)||k.start)}s linear ${C} forwards`;const A=+I.toFixed(1);Math.abs(A)>.2&&(E.style.animationDelay=`${A}s`)},R=()=>{if(!e.length)return;const M=r.current.currentTime>=g.current?"forward":"backward";g.current=r.current.currentTime;let k=x.current;const E=(t==null?void 0:t.bounded)||WJ;switch(M){case"forward":for(;k<e.length&&e[k+1]&&e[k+1].start-E<g.current+E;)k+=1;break;case"backward":for(;k>0&&e[k-1]&&e[k-1].end-E>g.current+E;)k-=1;break}if(k!==x.current||v.current||w.current==="paused"||w.current==="waiting"){if(v.current=!1,x.current=k,c(k),!u.current||!d.current||!p.current||!f.current)return;const I=e[k],{tune:C,text:A,cut:D}=I,P=g.current+E-C.start,ee=A.split(" "),_e=XE(k),He=aN(_e?p.current:f.current),Be=f_(ee,D,C.grow),B=_e?[u.current,d.current]:[d.current,u.current],K=iN(Be,He);T(K,I,B[0],-P),j(B[1])}};return h.useEffect(()=>{w.current==="waiting"?setTimeout(()=>{w.current=o},300):w.current=o},[o]),h.useEffect(()=>{_&&(v.current=!0,o==="paused"&&R())},[_]),h.useEffect(()=>{if(!(!e.length||!_))return r.current.addEventListener("timeupdate",R),()=>{r.current.removeEventListener("timeupdate",R)}},[e,_]),h.useEffect(()=>()=>{g.current=0,x.current=-1,c(0)},[e]),{loading:n,currentIndexRef:x,oddOverlay:u,evenOverlay:d,currentIndex:l,textData:b,tempEventText:f,tempOddText:p}}function YE({text:t,overlayRef:e}){const{playStatus:n}=fe(lr),[r,s]=h.useState(t),[i,o]=h.useState(!1),l=h.useRef(!0);h.useEffect(()=>{t&&o(!1)},[t]),h.useEffect(()=>{if(i)return;const u=()=>{s(t),o(!0)};l.current?setTimeout(u,300):(l.current=!0,u())},[i]),h.useEffect(()=>{n==="waiting"&&(l.current=!1),e.current&&(n==="playing"?e.current.style.animationPlayState="running":e.current.style.animationPlayState="paused")},[n]);const c={lyric:"relative duration-300 text-[44px] font-[700] pointer-none whitespace-nowrap"};return a.jsxs("div",{className:`${c.lyric} ${l.current?"transition-opacity":""} ${i?"opacity-[1]":"opacity-0"}`,children:[r||"...",a.jsx("p",{ref:e,className:"absolute whitespace-nowrap w-0 overflow-hidden text-[#ffed00] left-0 top-0 h-full",children:r||"..."})]})}function KJ(){const{loading:t,evenOverlay:e,oddOverlay:n,tempEventText:r,tempOddText:s,textData:i}=qJ({bounded:0});return t?a.jsx(Ye,{children:a.jsx(Me,{className:"w-7 animate-spin"})}):a.jsxs(a.Fragment,{children:[a.jsx("div",{ref:r,className:"inline-flex h-0 opacity-0",children:i.even.split(" ").map((o,l)=>a.jsx("span",{className:"leading-1",children:o},l))}),a.jsx("div",{ref:s,className:"inline-flex h-0 opacity-0",children:i.odd.split(" ").map((o,l)=>a.jsx("span",{className:"k leading-1",children:o},l))}),a.jsx(YE,{overlayRef:e,text:i.even}),a.jsx("div",{className:"mt-8"}),a.jsx(YE,{overlayRef:n,text:i.odd})]})}const mA=()=>{window.dispatchEvent(new Event("mousemove"))};function Av(t,e,n=!1){const r=window.innerWidth,i=t.getBoundingClientRect().left,o=r-(i+t.offsetWidth),l=Math.abs(Math.ceil(i-o))/2;if(l<5)return!1;n&&(e.onscroll=()=>{},setTimeout(()=>{e.onscroll=mA},900)),n||Math.abs(i)>r||Math.abs(o)>r?e.style.scrollBehavior="auto":e.style.scrollBehavior="smooth";let c=e.scrollLeft;return o>i?setTimeout(()=>{e.scrollLeft=c-l},300):o<i&&setTimeout(()=>{e.scrollLeft=c+l},300),!0}function QJ(){const t=mn(),{isOpenFullScreen:e,idle:n}=lt(),{currentQueueId:r}=fe(rt),{playStatus:s}=fe(lr),i=h.useRef(null),o=h.useRef(null),l=h.useRef("paused"),c=()=>{!(o!=null&&o.current)||!(i!=null&&i.current)||Av(o.current,i.current,n)},u=p=>{let g=document.querySelector(".song-thumb.centered");if(!g)if(o.current)g=o.current;else return;let x;switch(p){case"ArrowRight":x=g.nextElementSibling;break;case"ArrowLeft":x=g.previousElementSibling;break}x&&i.current&&(g.classList.remove("centered"),x.classList.add("centered"),Av(x,i.current))},d=()=>{if(!o.current)return;const p=document.querySelector(".song-thumb.centered"),g=p==null?void 0:p.getAttribute("queue-id");g&&t(oi(g))},f=p=>{if(p.key==="ArrowRight"||p.key==="ArrowLeft")return p.preventDefault(),u(p.key);p.key==="Enter"&&d()};return h.useEffect(()=>{e&&c()},[r,e]),h.useEffect(()=>{if(e)return document.addEventListener("keydown",f),()=>{var p;document.removeEventListener("keydown",f),(p=document.querySelector(".song-thumb.centered"))==null||p.classList.remove("centered")}},[r,e]),h.useEffect(()=>{const p=i==null?void 0:i.current;if(p)return p.onscroll=mA,()=>{p.onscroll=()=>{}}},[]),h.useEffect(()=>{l.current=s},[s]),{activeSongRef:o,containerRef:i}}function XJ(){const t=mn(),{activeTab:e,isOpenFullScreen:n,playerConfig:r,idle:s}=lt(),{currentSongData:i}=fe(rt),{queueSongs:o,currentQueueId:l}=fe(rt),{activeSongRef:c,containerRef:u}=QJ(),d=v=>{l!==v&&t(oi(v))},f=qS(()=>g("next"),200),p=qS(()=>g("previous"),200),g=(v="next")=>{const _=u.current;_.style.scrollBehavior="smooth",v==="next"?_.scrollLeft+=500:v==="previous"&&(_.scrollLeft-=500)},x={songsListTab:" relative h-full no-scrollbar flex items-center flex-row overflow-auto scroll-smooth px-[calc(50%-350px/2)]",absoluteButton:"absolute top-[50%] -translate-y-[50%] p-[8px] bg-white/5 rounded-full",lyricTabContainer:"px-[40px] min-[1536px]:container  min-[1536px]:px-[200px] h-full flex items-center justify-center flex-row",fadeTransition:"opacity-0 transition-opacity duration-[.3s]"},w=h.useMemo(()=>{if(i!=null&&i.song&&o.length)return o.map((v,_)=>v.queue_id===l?a.jsx(px,{ref:c,hasTitle:!0,onClick:()=>d(v.queue_id),active:!0,data:v},_):a.jsx(px,{idleClass:`${s?x.fadeTransition:""}`,hasTitle:!0,active:!1,data:v,onClick:()=>d(v.queue_id)},_))},[i==null?void 0:i.song,o,s]);return a.jsxs(a.Fragment,{children:[a.jsx("div",{ref:u,className:`song-list-container ${x.songsListTab} ${e!=="Songs"?"opacity-0":"opacity-100"}`,children:w}),e==="Songs"&&!s&&a.jsxs(a.Fragment,{children:[a.jsx(ce,{hover:"scale",size:"clear",onClick:()=>p(),className:`${x.absoluteButton} left-[20px]`,children:a.jsx(L1,{className:"w-6"})}),a.jsx(ce,{hover:"scale",size:"clear",onClick:()=>f(),className:`${x.absoluteButton} right-[20px]`,children:a.jsx(Ju,{className:"w-6"})})]}),a.jsx(sR,{children:a.jsxs(M5,{isOpenLyricTabs:n&&(e==="Lyric"||e==="Karaoke"),children:[a.jsx("div",{className:`absolute inset-0 z-20 ${e==="Lyric"?"":"hidden"}`,children:a.jsxs("div",{className:x.lyricTabContainer,children:[a.jsx(px,{classNames:r.songImage?"":"hidden",active:!0,data:i==null?void 0:i.song}),a.jsx(fA,{className:`w-full ml-[40px] h-full ${r.songImage,""}`})]})}),a.jsx("div",{className:`absolute font-[Inter,system-ui] inset-0 z-20 flex flex-col items-center justify-center ${e==="Karaoke"?"":"hidden"}`,children:a.jsx(KJ,{})})]})})]})}function YJ(){var o,l;const{isOpenFullScreen:t,idle:e,activeTab:n,playerConfig:{songBackground:r}}=lt(),{currentSongData:s}=fe(rt),i={wrapper:"fixed inset-0 z-50 overflow-hidden text-white bg-zinc-900 transition-transform duration-[.7s] linear delay-100",bg:"absolute inset-0 -z-10 brightness-[10%]",container:"absolute w-full top-0 bottom-[90px] flex flex-col",content:"flex-grow relative overflow-hidden",fadeTransition:"opacity-0 transition-opacity duration-[.3s]"};return a.jsxs("div",{className:`${i.wrapper}  ${t?"translate-y-0":"translate-y-full"}`,children:[r&&a.jsx("div",{className:"absolute left-0 top-0 h-full w-full  brightness-[80%] ",children:a.jsx(tu,{radioGroup:"",height:"100%",width:"100%",hash:((o=s==null?void 0:s.song)==null?void 0:o.blurhash_encode)||r_})}),a.jsxs("div",{className:i.container,children:[a.jsx(GJ,{}),a.jsx("div",{className:i.content,children:a.jsx(XJ,{})}),n!=="Songs"&&a.jsxs("p",{className:`text-center text-sm font-bold ${e&&i.fadeTransition}`,children:[((l=s==null?void 0:s.song)==null?void 0:l.name)||"...",a.jsxs("span",{className:"opacity-70",children:[" - ",s==null?void 0:s.song.singers.map((c,u)=>(u?", ":"")+c.name)]})]})]})]})}function JJ(){const{user:t,updateUserData:e}=ye(),[n,r]=h.useState([]),[s,i]=h.useState(!0);return{isFetching:s,recentSongs:n,getRecentSongs:async()=>{try{if(t){if(t.recent_song_ids.length){const c=Ee(fn,ae(ci(),"in",t.recent_song_ids)),u=await Cn(c),d=[];t.recent_song_ids.forEach(f=>{const p=u.find(g=>g.id===f);p&&d.push(p)}),r(d)}}else{const c=un()["recent-songs"]||[];r(c)}}catch(c){console.log({message:c})}finally{i(!1)}},clearRecentSongs:async()=>{if(t){const c={recent_song_ids:[]};Re({collectionName:"Users",data:c,id:t.email}),e(c)}else ot("recent-songs",[]);r([])}}}function ZJ({setTab:t}){const e=mn(),n=h.useRef(!1),{getRecentSongs:r,isFetching:s,recentSongs:i,clearRecentSongs:o}=JJ(),l=c=>{e(yh({songs:[c]})),e(oi(c.queue_id)),t("Queue")};return h.useEffect(()=>{n.current||(n.current=!0,r())},[]),s?a.jsx(Zi,{variant:"queue-song",hasCheckBox:!1}):a.jsxs(a.Fragment,{children:[a.jsx($s,{isHasCheckBox:!1,songVariant:"recent-song",songs:i,setSong:l}),a.jsx("div",{className:"text-center my-3",children:!!i.length&&a.jsxs(ce,{onClick:o,color:"primary",children:[a.jsx(xt,{className:"w-6"}),a.jsx("span",{className:"",children:"Clear"})]})})]})}function eZ(){const{setIsOpenSongQueue:t}=lt(),e=Wn();h.useEffect(()=>{e.pathname==="/"&&t(!1)},[e])}const tZ=["Queue","Recent"];function nZ(){const t=mn(),{isOpenSongQueue:e,setIsOpenSongQueue:n}=lt(),{queueSongs:r,currentQueueId:s,isFetching:i}=fe(rt),{resetForNewSong:o}=na();eZ();const[l,c]=h.useState("Queue"),u=h.useCallback(g=>{g!==s&&t(oi(g))},[s]),d=h.useCallback(()=>{t(PV()),o(),n(!1)},[]),f=[...Array(5).keys()].map(g=>a.jsx(we,{className:"h-[56px] mt-1 rounded-md"},g)),p={mainContainer:"hidden fixed w-[300px] md:flex flex-col bottom-[80px] right-[0] top-[0] z-20 px-3 pt-4 bg-[--layout-cl] border-l-[1px] border-[--a-5-cl] transition-[transform] duration-[.5s] linear delay-100",songListContainer:"flex-grow overflow-y-auto pb-[10px] overflow-x-hidden no-scrollbar mt-3"};return a.jsxs("div",{className:`${p.mainContainer} ${e?"translate-x-0---":"translate-x-full"}     `,children:[a.jsx(Ur,{className:"w-fit mx-auto text-sm",tab:l,setTab:c,tabs:tZ,render:g=>g}),a.jsx("div",{className:p.songListContainer,children:l==="Queue"?a.jsxs(a.Fragment,{children:[a.jsx($s,{isHasCheckBox:!1,songs:r,setSong:g=>u(g.queue_id),songVariant:"queue-song",getActive:(g,x)=>g.queue_id===x.queue_id}),i&&f,a.jsx("div",{className:"text-center my-3",children:!!r.length&&a.jsxs(ce,{onClick:d,color:"primary",children:[a.jsx(xt,{className:"w-6"}),a.jsx("span",{className:"",children:"Clear"})]})})]}):a.jsx(ZJ,{setTab:c})})]})}const rZ=h.memo(nZ);function sZ({vinylRef:t}){const{playStatus:e}=fe(lr);h.useEffect(()=>{const n=t.current;n&&(e==="playing"?n.style.animationPlayState="running":n.style.animationPlayState="paused")},[e])}function iZ({textRef:t,textWrapperRef:e,content:n}){const r=h.useRef(),s=h.useRef(),i=h.useRef(!1),o=h.useRef(0),l=h.useRef(0),c=h.useRef(0),u=()=>{t.current&&(t.current.style.transition="none",t.current.style.transform="translateX(0)")},d=()=>{t.current&&(t.current.style.transition=`transform linear ${l.current}s`,t.current.style.transform=`translateX(-${c.current}px)`,s.current=setTimeout(u,l.current*1e3))},f=()=>{!t.current||!e.current||(c.current=t.current.offsetWidth-o.current,l.current=Math.ceil(c.current/35))},p=()=>{!i.current||!t.current||!e.current||(l.current=0,c.current=0,i.current=!1,clearInterval(r.current),clearTimeout(s.current),e.current.classList.remove("mask-image-horizontal"),u())},g=()=>{!t.current||!e.current||!n||!(t.current.offsetWidth>e.current.offsetWidth)||(i.current=!0,e.current.classList.add("mask-image-horizontal"),o.current=t.current.clientWidth,t.current.innerHTML=t.current.innerText+"&nbsp; &nbsp; &nbsp;"+t.current.innerText,f(),setTimeout(d,1e3),r.current=setInterval(d,l.current*1e3+3e3))};h.useEffect(()=>(g(),p),[n])}function aZ({content:t,className:e}){const n=h.useRef(null),r=h.useRef(null);return iZ({textRef:r,textWrapperRef:n,content:t}),a.jsx("div",{ref:n,className:"overflow-hidden relative h-full ",children:a.jsx("div",{ref:r,className:`absolute left-0 whitespace-nowrap ${e}`,children:t||"..."})})}const _p=h.memo(aZ);function oZ({isOpenFullScreen:t,song:e}){const n=h.useRef(null);sZ({vinylRef:n});const r={songInfoChild:"flex items-center"};return a.jsx("div",{className:`w-1/4 ${Ha(t)}`,children:a.jsxs("div",{className:`${r.songInfoChild} ${Ha(t)}`,children:[a.jsx("div",{ref:n,className:"w-[56px] h-[56px] flex-shrink-0 animate-[spin_8s_linear_infinite]",children:a.jsx(De,{src:e==null?void 0:e.image_url,blurHashEncode:e==null?void 0:e.blurhash_encode,className:"rounded-full h-full object-cover"})}),a.jsxs("div",{className:"ml-2 font-bold flex-grow",children:[a.jsx("div",{className:"h-6",children:a.jsx(_p,{className:"",content:(e==null?void 0:e.name)||"Name"})}),e&&a.jsx("div",{className:"leading-[1.2] text-sm opacity-70 line-clamp-1",children:e.singers.map((s,i)=>s.id?a.jsx(se,{to:`/singer/${s.id}`,className:"hover:text-[--primary-cl] hover:underline",children:(i?", ":"")+s.name},i):a.jsx("span",{children:(i?", ":"")+s.name},i))})]})]})})}function lZ({audioEle:t,volumeLineRef:e}){const{theme:n}=as(),[r,s]=h.useState(!1),[i,o]=np("volume",1),l=d=>{const p=d.target.getBoundingClientRect(),g=e.current;if(g){let x=+((d.clientX-p.x)/g.clientWidth).toFixed(2);x>.9?x=1:x<.05?(x=0,s(!0)):s(!1),o(x)}},c=d=>{d.preventDefault();const f=.1;let p=i;d.deltaY>0?p-f>0?p-=f:p=0:p+f<1?p+=f:p=1,o(+p.toFixed(2))},u=()=>s(!r);return h.useEffect(()=>{if(e.current&&t){const d=i*100;e.current.style.background=Kw(d),t.volume=i,s(i===0)}},[i,n]),h.useEffect(()=>{t&&(t.muted=r)},[r]),{volume:i,handleSetVolume:l,isMute:r,handleMute:u,handleWheel:c}}function cZ({audioEle:t}){const e=h.useRef(null),{handleMute:n,handleWheel:r,handleSetVolume:s,isMute:i}=lZ({audioEle:t,volumeLineRef:e});return a.jsxs("div",{className:"flex flex-grow items-center max-w-[100px] mr-2",children:[a.jsx("button",{onWheel:r,onClick:()=>n(),children:i?a.jsx(WF,{className:"w-6"}):a.jsx(UF,{className:"w-6"})}),a.jsx(wh,{className:"h-1 ml-1",onClick:s,elelRef:e})]})}function uZ({handlePlayPause:t,playStatus:e}){const n=()=>{switch(e){case"playing":return a.jsx(hl,{});case"error":return a.jsx(Up,{});case"loading":case"waiting":return a.jsx(Me,{className:"animate-spin"});case"paused":return a.jsx(si,{})}};return a.jsx(a.Fragment,{children:a.jsx("button",{className:"rounded-full  inline-flex items-center w-10 h-10 p-1 justify-center [&_svg]:w-full",onClick:()=>t(),children:n()})})}function dZ(){var w;const{playerConfig:{isShuffle:t,repeat:e},isOpenFullScreen:n,timelineEleRef:r,currentTimeEleRef:s}=lt(),{currentSongData:i,queueSongs:o}=fe(rt),{playStatus:l}=fe(lr),{next:c,previous:u,toggleRepeat:d,toggleShuffle:f,handlePlayPause:p,handleSeek:g}=na(),x={button:"",buttonsContainer:"w-full flex justify-center items-center mb-3 sm:mb-0 space-x-3 [&_button]:w-10 [&_button]:h-10",progressContainer:"flex w-full flex-row items-center ",icon:"w-full",before:"before:content-[''] before:w-[100%] before:h-[24px] before:absolute before:top-[50%] before:translate-y-[-50%]"};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:`${x.buttonsContainer}`,children:[a.jsx("button",{disabled:o.length<=1,className:`relative ${x.button} ${e!=="no"&&"text-[--primary-cl]"}`,onClick:d,children:e==="one"?gU:pU}),a.jsx("button",{disabled:o.length<=1,className:`${x.button} rotate-180`,onClick:u,children:KS}),a.jsx(uZ,{playStatus:l,handlePlayPause:p}),a.jsx("button",{disabled:o.length<=1,className:`${x.button}`,onClick:c,children:KS}),a.jsx("button",{disabled:o.length<=1,className:`${x.button} ${t&&"text-[--primary-cl]"}`,onClick:f,children:xU})]}),a.jsxs("div",{className:`${x.progressContainer} ${n?"mb-0":"mb-5 sm:mb-2"} ${l==="error"||l==="loading"?"disable":""}`,children:[a.jsx("div",{className:"w-[44px] flex-shrink-0 sm:w-9 font-bold",children:a.jsx("span",{ref:s,className:"text-lg sm:text-sm",children:"0:00"})}),a.jsx(wh,{className:"h-[6px] sm:h-1",onClick:g,elelRef:r}),a.jsx("div",{className:"w-[44px] flex-shrink-0 sm:w-9 text-right font-bold",children:a.jsx("span",{className:"text-lg sm:text-sm",children:i!=null&&i.song?Ic((w=i.song)==null?void 0:w.duration):"0:00"})})]})]})}function hZ(){const{theme:t}=as(),e=h.useRef(null);return h.useEffect(()=>{if(e.current){if(!t.image){e.current.style.backgroundImage="";return}e.current.style.backgroundImage=`url(${t.image})`}},[t]),{containerRef:e}}function fZ(){const t=mn(),{countDown:e}=fe(lr),n=h.useRef(null),r=()=>{var i;e?t(wn({countDown:0})):(i=n.current)==null||i.open()},s={container:"w-[54px] sm:w-[50px] flex justify-center",button:"rounded-[99px] p-[5px] hover:bg-[--a-5-cl]",itemContainer:"flex justify-between items-center min-h-[30px]",text:"text-base text-[#ccc]"};return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:s.container,children:e?a.jsx(Fi,{content:"Clear timer",children:a.jsxs("button",{className:"group flex items-center",onClick:r,children:[a.jsx("span",{className:"text-base opacity-70 sm:text-sm group-hover:hidden",children:e.toString().padStart(2,"0")}),a.jsx("span",{className:`hidden group-hover:block ${s.button}`,children:a.jsx(ol,{className:"w-8 sm:w-6"})})]})}):a.jsx(Fi,{content:"Sleep timer",children:a.jsx("button",{onClick:r,className:s.button,children:a.jsx(TT,{className:"w-8 sm:w-6"})})})}),a.jsx(ie,{ref:n,variant:"animation",children:a.jsx(oR,{active:i=>t(wn({countDown:i})),closeModal:()=>{var i;return(i=n.current)==null?void 0:i.close()}})})]})}function mZ(){const{audioRef:t,idle:e}=lt();if(!t.current)throw new Error("BottomPlayer !audioRef.current");const{theme:n}=as(),{isOpenFullScreen:r,isOpenSongQueue:s,setIsOpenFullScreen:i,setIsOpenSongQueue:o}=lt(),{currentQueueId:l,currentSongData:c}=fe(rt),{containerRef:u}=hZ(),{shouldHide:d}=hU({audioEle:t.current}),f=()=>{s&&o(!1),i(!0)},p={wrapper:"bottom-player hidden md:block border-[--a-5-cl] fixed bottom-0 w-full border-t transition-transform z-50 md:px-3 lg:px-6 h-[90px]",container:"flex flex-row gap-[10px] h-full items-center",controlWrapper:`flex max-w-[420px] flex-grow ${r?"max-w-[600px] flex-col-reverse pb-[10px]":"flex-col justify-center"}`,right:"w-1/4 flex items-center justify-end",blurBg:"bg-opacity-[0.8] backdrop-blur-[15px] z-[-1] absolute inset-0 bg-[--player-cl]"};return a.jsxs("div",{ref:u,className:`${p.wrapper} ${r?"border-transparent":n.image?"bg-[--a-player-cl]":""} ${d&&"translate-y-[100%] "} `,children:[!n.image&&a.jsx("div",{className:`${p.blurBg} ${r?"opacity-0 transition-opacity delay-[.2s]":""}`}),a.jsxs("div",{className:`${p.container} ${r?"justify-center text-white":"justify-between"} ${e&&"transition-opacity duration-[.3s] opacity-0"}`,children:[a.jsx(oZ,{song:c==null?void 0:c.song,isOpenFullScreen:r}),a.jsx("div",{className:` ${p.controlWrapper} ${Pd(l===null)}`,children:a.jsx(dZ,{})}),a.jsxs("div",{className:`${p.right}  ${r?"hidden":""}`,children:[a.jsx(cZ,{audioEle:t.current}),a.jsxs("div",{className:`flex items-center ${l?"":"disable"}`,children:[a.jsx(Fi,{content:"Lyrics",children:a.jsx("button",{onClick:f,className:"rounded-[99px]  hover:bg-[--a-5-cl]  p-[5px]",children:a.jsx(C6,{className:"w-6"})})}),a.jsx(Fi,{content:"Queue",children:a.jsx("button",{onClick:()=>o(!s),className:"ml-1 hover:bg-[--a-5-cl] rounded-md p-[5px]",children:a.jsx(MF,{className:"w-6"})})}),a.jsx("div",{className:"w-[2px] h-[26px] ml-2 bg-[--a-5-cl]"}),a.jsx(fZ,{})]})]})]})]})}function pZ({isOpenFullScreen:t}){const e=h.useRef(null);return h.useEffect(()=>{const n=e.current;n&&(t?(n.style.transform="translate(0)",n.style.zIndex="99"):(n.style.transform="translate(0, 100%)",setTimeout(()=>{n.style.zIndex="-10"},500)))},[t]),{wrapperRef:e}}function gZ({imageUrl:t}){const{mobileActiveTab:e,setMobileActiveTab:n}=lt(),r=e==="Playing";return a.jsx("div",{onClick:()=>n(r?"Lyric":"Playing"),className:` ${r?"w-full h-auto px-2 sm:w-[60px] sm:h-[60px] sm:px-0":"w-[60px] h-[60px] p-0 flex-shrink-0"}`,children:a.jsx(De,{src:t,className:"w-full rounded-md"})})}function xZ({song:t,onClick:e,active:n}){const r={itemContainer:`queue-item ${n?"active":""} border-b 
    last:border-none font-semibold border-white/5 rounded-md flex p-2 ${n?"bg-white/10":""}`,imageFrame:"w-[54px] h-[54px] relative rounded-md overflow-hidden flex-shrink-0"};return a.jsx(a.Fragment,{children:a.jsxs("div",{onClick:e,className:`${r.itemContainer} `,children:[a.jsx("div",{className:`${r.imageFrame}  `,children:a.jsx(De,{blurHashEncode:t.blurhash_encode,src:t.image_url})}),a.jsxs("div",{className:"ml-[10px] font-bold",children:[a.jsx("p",{className:"line-clamp-1",children:t.name}),a.jsx("p",{className:"text-gray-300 line-clamp-1 text-sm",children:t.singers.map((s,i)=>a.jsxs("span",{children:[" ",(i?", ":"")+s.name]},i))})]})]})})}function yZ({}){const t=mn(),{queueSongs:e,isFetching:n,currentQueueId:r}=fe(rt),s=[...Array(5).keys()].map(o=>a.jsx(we,{className:"h-[40px] mt-1"},o)),i=()=>a.jsx(a.Fragment,{children:e.map((o,l)=>a.jsx(xZ,{song:o,active:r===o.queue_id,onClick:()=>t(oi(o.queue_id))},l))});return a.jsxs(a.Fragment,{children:[i(),n&&s]})}function vZ(){const t=h.useRef(null),e=mn(),{countDown:n}=fe(lr),r=()=>{var s;n?e(wn({countDown:0})):(s=t.current)==null||s.open()};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("button",{className:Oa(!!n,"active"),onClick:r,children:n?a.jsx(r$,{className:"w-6"}):a.jsx(TT,{className:"w-6"})}),a.jsx("span",{children:n?n.toString().padStart(2,"")+" songs":"Timer"})]}),a.jsx(ie,{ref:t,variant:"animation",children:a.jsx(oR,{active:s=>e(wn({countDown:s})),closeModal:()=>{var s;return(s=t.current)==null?void 0:s.close()}})})]})}function wZ({song:t}){const e=h.useRef(null);return a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("button",{onClick:()=>{var n;return(n=e.current)==null?void 0:n.open()},children:a.jsx("p",{className:"w-6",children:Ng})}),a.jsx("span",{children:"Add to playlist"})]}),a.jsx(ie,{variant:"animation",ref:e,children:a.jsx(Dg,{closeModal:()=>{var n;return(n=e.current)==null?void 0:n.close()},songs:[t]})})]})}function _Z({isLiked:t,song:e}){const{action:n,loading:r}=$g();return a.jsxs("div",{children:[a.jsx("button",{onClick:()=>n({variant:"like",song:e}),className:`${Oa(t,"active")}`,children:r?a.jsx(Me,{className:"w-6 animate-spin"}):a.jsx(a.Fragment,{children:t?a.jsx(Xc,{className:"w-6"}):a.jsx(Xd,{className:"w-6"})})}),a.jsx("span",{children:t?"Dislike":"Like"})]})}function bZ(){const{user:t}=ye(),{currentSongData:e,queueSongs:n}=fe(rt),{toggleRepeat:r,repeat:s}=na(),i={buttonList:"flex flex-shrink-0 overflow-auto space-x-2 [&_div]:flex [&_div]:w-[70px] [&_div]:flex-col [&_div]:items-center [&_div]:space-y-1.5 [&_div]:text-center [&_button]:p-3.5 [&_button]:bg-white/10 [&_button]:rounded-full [&_button.active]:text-[--primary-cl] [&_span]:text-xs font-semibold"};if(e)return a.jsx(a.Fragment,{children:a.jsxs("div",{className:"h-[70vh] overflow-hidden text-white rounded-[16px_16px_0_0] relative p-3 flex flex-col",children:[a.jsx("div",{className:"bg-opacity-[0.8] backdrop-blur-[15px] z-[-1] bg-[#1f1f1f] absolute inset-0"}),a.jsxs("div",{className:i.buttonList,children:[a.jsxs("div",{children:[a.jsx("button",{disabled:n.length<=1,className:`${Oa(s!=="no","active")}`,onClick:r,children:a.jsx(Me,{className:"w-6"})}),a.jsx("span",{className:"break-word",children:s==="one"?"Repeat one":s==="all"?"Repeat all":"Play once"})]}),t&&a.jsxs(a.Fragment,{children:[a.jsx(wZ,{song:e.song}),a.jsx(_Z,{song:e.song,isLiked:!!(t!=null&&t.liked_song_ids.includes(e.song.id))})]}),a.jsx(vZ,{})]}),a.jsx("div",{className:"flex-grow overflow-auto mt-3 border-t border-white/60 pt-3",children:e&&a.jsx(yZ,{currentIndex:e.index})})]})})}function SZ(){const{setIsOpenFullScreen:t}=lt(),{setIsOpenComment:e}=ir(),n=h.useRef(null),r=h.useRef(null),s=()=>{var o;(o=r.current)==null||o.open(),e(!0)},i=()=>{const o=document.querySelector(".queue-item.active");o&&o.scrollIntoView()};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex space-x-1 items-center",children:[a.jsx("button",{className:"p-1.5",onClick:s,children:a.jsx(D1,{className:"w-6"})}),a.jsx("button",{className:"p-1.5",onClick:()=>{var o;return(o=n.current)==null?void 0:o.open()},children:a.jsx("p",{className:"w-6",children:Rg})}),a.jsx("button",{onClick:()=>t(!1),className:"p-1.5",children:a.jsx(kT,{className:"w-6"})})]}),a.jsx(xv,{onOpen:i,ref:n,children:a.jsx(bZ,{})}),a.jsx(xv,{onClose:()=>e(!1),ref:r,children:a.jsx(W5,{children:a.jsx(hA,{})})})]})}function EZ({handlePlayPause:t,playStatus:e}){const n={icon:"w-10"},r=()=>{switch(e){case"playing":return a.jsx(hl,{className:`${n.icon}`});case"error":return a.jsx(cR,{className:`${n.icon}`});case"loading":case"waiting":return a.jsx(lR,{className:`${n.icon} animate-spin`});case"paused":return a.jsx(si,{className:`${n.icon}`})}};return a.jsx(a.Fragment,{children:a.jsx("button",{className:"inline-flex items-center justify-center",onClick:()=>t(),children:r()})})}function jZ(){var l;const{timelineEleRef:t,currentTimeEleRef:e}=lt(),{playStatus:n}=fe(lr),{currentSongData:r}=fe(rt),{handleSeek:s,handlePlayPause:i}=na(),o={buttonsContainer:"w-full flex items-center justify-between space-x-2 mt-2",progressContainer:"flex w-full flex-row items-center "};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:`${o.progressContainer}  ${n==="error"||n==="loading"?"disable":""}`,children:[a.jsx("div",{className:"w-[44px] flex-shrink-0 sm:w-9",children:a.jsx("span",{ref:e,className:"text-lg sm:text-sm",children:"0:00"})}),a.jsx(wh,{onClick:s,elelRef:t,className:"h-1.5"}),a.jsx("div",{className:"w-[44px] flex-shrink-0 sm:w-9 text-right",children:a.jsx("span",{className:"text-lg sm:text-sm",children:r!=null&&r.song?Ic((l=r.song)==null?void 0:l.duration):"0:00"})})]}),a.jsxs("div",{className:`${o.buttonsContainer}`,children:[a.jsx(EZ,{playStatus:n,handlePlayPause:i}),a.jsx(Bg,{target:"song",children:a.jsx(SZ,{})})]})]})}function kZ(){const{isOpenFullScreen:t,playerConfig:{songBackground:e},mobileActiveTab:n}=lt(),{currentSongData:r}=fe(rt),s=h.useRef(null),{wrapperRef:i}=pZ({isOpenFullScreen:t}),o={headerWrapper:"flex mb-4",container:"flex-grow flex flex-col relative overflow-hidden",control:"mt-auto",bgImage:"absolute inset-0 z-[-9] brightness-[70%] blur-[4px] translate-3d-0"};return a.jsx(a.Fragment,{children:a.jsxs("div",{ref:i,style:{transform:"translate(0, 100%)",zIndex:"-10"},className:"block md:hidden fixed inset-0 bg-zinc-900 text-white overflow-hidden transition-[transform] duration-[.3s] ease-linear",children:[e&&a.jsx("div",{className:o.bgImage,children:a.jsx(tu,{width:"100%",height:"100%",hash:(r==null?void 0:r.song.blurhash_encode)||r_})}),a.jsx("div",{className:"h-full z-10 p-4 flex flex-col",children:a.jsxs("div",{ref:s,className:o.container,children:[a.jsxs("div",{className:`${n!="Playing"?"flex items-center":"sm:flex"}`,children:[a.jsx(gZ,{imageUrl:r==null?void 0:r.song.image_url}),a.jsxs("div",{className:`ml-2 font-bold h-full ${n!="Playing"?"block":"hidden sm:block"}`,children:[a.jsx("p",{className:"line-clamp-1",children:r==null?void 0:r.song.name}),a.jsx("p",{className:"opacity-70 line-clamp-1",children:r==null?void 0:r.song.singers.map((l,c)=>a.jsxs("span",{children:[" ",(c?", ":"")+l.name]},c))})]}),n==="Lyric"&&a.jsxs(nr,{appendOnPortal:!0,children:[a.jsx(rr,{children:a.jsx("button",{className:" p-[6px] rounded-full ml-auto  bg-white/10",children:a.jsx(O1,{className:"w-6"})})}),a.jsx(sr,{position:"left-bottom",origin:"top right",children:a.jsx(F5,{})})]})]}),a.jsx("div",{className:`mt-4 justify-between items-center ${n!="Playing"?"hidden":"flex sm:hidden"}`,children:a.jsxs("div",{className:"flex-grow font-bold",children:[a.jsx("div",{className:"h-7",children:a.jsx(_p,{className:"text-xl",content:(r==null?void 0:r.song.name)||"..."})}),a.jsx("div",{className:"opacity-[.7] text-lg line-clamp-1",children:r==null?void 0:r.song.singers.map((l,c)=>l.id?a.jsx(se,{to:`/singer/${l.id}`,children:(c?", ":"")+l.name},c):a.jsxs("span",{children:[" ",(c?", ":"")+l.name]},c))})]})}),a.jsx(sR,{children:a.jsx(M5,{isOpenLyricTabs:t&&n=="Lyric",children:a.jsx(fA,{className:`text-left ${n==="Lyric"?"flex-1 block":"hidden"}`})})}),a.jsx("div",{className:`${o.control}`,children:a.jsx(jZ,{})})]})})]})})}function TZ({audioEle:t}){const e=Wn(),n=h.useMemo(()=>e.pathname==="/",[e]),r=h.useMemo(()=>e.pathname.includes("lyric"),[e]);return h.useEffect(()=>{(n||r)&&t.pause()},[e]),{shouldHidePlayer:n,location:e,shouldHideAll:r}}function IZ({ActiveClass:t}){const{user:e}=ye(),{action:n}=Mg(),r=Gt(),s=h.useRef(null),i=async()=>{try{await n("login"),r("/my-music")}catch(o){console.log(o)}};return e?a.jsx(se,{className:`
                  ${t}
                `,to:"/my-music",children:a.jsxs("div",{children:[a.jsx(Iy,{}),a.jsx("span",{children:"My song"})]})}):a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>{var o;return(o=s.current)==null?void 0:o.open()},className:`
                  ${t}
                `,children:a.jsxs("div",{children:[a.jsx(Iy,{}),a.jsx("span",{children:"Login"})]})}),a.jsx(ie,{ref:s,variant:"animation",children:a.jsxs(je,{children:[a.jsx(qe,{closeModal:()=>{var o;return(o=s.current)==null?void 0:o.close()},title:"Login"}),a.jsx("div",{className:"text-center my-5",children:a.jsx(ce,{onClick:i,color:"primary",children:"Login with Google"})})]})})]})}function CZ(){const{isOpenFullScreen:t,setIsOpenFullScreen:e,audioRef:n}=lt();if(!n.current)return a.jsx(a.Fragment,{});const{playStatus:r}=fe(lr),{currentSongData:s}=fe(rt),{handlePlayPause:i}=na(),{shouldHideAll:o,shouldHidePlayer:l,location:c}=TZ({audioEle:n.current}),u=h.useMemo(()=>{switch(r){case"playing":return a.jsx(hl,{className:""});case"error":return a.jsx(Up,{className:""});case"loading":case"waiting":return a.jsx(Me,{className:" animate-spin"});case"paused":return a.jsx(si,{className:""})}},[r]),d=p=>p?"text-[--primary-cl]":"",f={wrapper:`block  ${l?"bg-[--layout-cl]":"bg-transparent"}  md:hidden fixed bottom-0 w-full transition-transform overflow-hidden border-t border-[--a-5-cl] z-[9]`,container:"absolute inset-0 bg-[--player-cl] bg-opacity-[0.7] backdrop-blur-[15px] z-[-1]",songImageWrapper:"flex flex-row items-center flex-grow h-full",image:"w-[54px] h-[54px] flex-shrink-0",cta:"ml-2 flex-shrink-0"};return a.jsxs("div",{className:`${f.wrapper} ${o?"translate-y-[100%]":""}`,children:[a.jsx("div",{className:`${f.container} ${t?"opacity-0 transition-opacity delay-[.3s]":""}`}),a.jsxs("div",{className:`flex justify-between items-center px-4 py-3 ${l?"hidden":""}`,children:[a.jsx("div",{onClick:()=>s!=null&&s.song.name?e(!0):{},className:"mobile-current-song flex-grow",children:a.jsxs("div",{className:f.songImageWrapper,children:[a.jsx("div",{className:f.image,children:a.jsx(De,{src:s==null?void 0:s.song.image_url,className:"rounded-full"})}),a.jsx("div",{className:"flex-grow ml-2",children:(s==null?void 0:s.song.song_url)&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"h-6",children:a.jsx(_p,{className:"font-semibold",content:(s==null?void 0:s.song.name)||"..."})}),a.jsx("div",{className:"h-6",children:a.jsx(_p,{className:"item-info",content:(s==null?void 0:s.song.singers.map((p,g)=>(g?", ":"")+p.name).join(""))||"..."})})]})})]})}),a.jsx("div",{className:`${f.cta} ${!(s!=null&&s.song.name)&&"disable"}`,children:a.jsx("button",{className:"p-1.5 [&_svg]:w-9",onClick:i,children:u})})]}),a.jsxs("div",{className:`flex items-center py-1 justify-evenly [&_div]:flex 
      [&_div]:flex-col 
      [&_div]:items-center
      [&_svg]:w-6
      [&_span]:text-xs
      [&_span]:font-semibold
      ${l?"":"border-t border-[--a-5-cl]"}
      `,children:[a.jsx(se,{className:`
              ${d(c.pathname==="/")}
            `,to:"/",children:a.jsxs("div",{children:[a.jsx(Yd,{}),a.jsx("span",{children:"For You"})]})}),a.jsx(se,{className:`
              ${d(c.pathname==="/discover")}
            `,to:"/discover",children:a.jsxs("div",{children:[a.jsx(CT,{}),a.jsx("span",{children:"Discover"})]})}),a.jsx(se,{className:`
              ${d(c.pathname==="/search")}
            `,to:"/search",children:a.jsxs("div",{children:[a.jsx(Jd,{}),a.jsx("span",{children:"Search"})]})}),a.jsx(IZ,{ActiveClass:d(c.pathname==="/my-music")})]})]})}function RZ(){const t=mn(),{audioRef:e,firstTimeSongLoaded:n}=lt(),{playStatus:r,countDown:s}=fe(lr),{handlePlayPause:i}=na(),o=h.useRef(0),l=()=>(console.log("song end"),ot("timer",o.current-1),t(wn({countDown:o.current-1})));h.useEffect(()=>{const c=un().timer||0;t(wn({countDown:c}))},[]),h.useEffect(()=>{if(!(!s||!e.current))return e.current.addEventListener("ended",l),n.current||(ot("timer",s),ot("is_timer",!0),r==="paused"&&i()),()=>{var c;(c=e.current)==null||c.removeEventListener("ended",l)}},[!!s]),h.useEffect(()=>{o.current=s},[s])}function NZ(){const{playerConfig:{repeat:t,isShuffle:e,isCrossFade:n,isEnableBeat:r},audioRef:s,firstTimeSongLoaded:i,startFadeWhenEnd:o,isPlayingNewSong:l,timelineEleRef:c,currentTimeEleRef:u,shouldSyncSongDuration:d,isOpenFullScreen:f,timeLineColorRef:p}=lt(),{setErrorToast:g}=ne(),{isOnMobile:x}=as();if(!s.current)throw new Error("Use Control audioRef.current is undefined");const w=mn(),{queueSongs:v,currentSongData:_,currentQueueId:b}=fe(rt),{playStatus:j}=fe(lr),{currentPlaylist:T}=fe(ui),R=h.useRef(),M=h.useRef(!1),k=h.useRef(!1),E=h.useRef(!1),I=h.useRef("paused"),C=Wn(),{next:A,updateProgressElement:D,play:P,pause:ee}=na(),_e=h.useMemo(()=>C.pathname.includes("edit"),[C]),He=h.useMemo(()=>un(),[]),Be=ge=>v[ge],B=()=>{w(wn({playStatus:"paused"}))},K=()=>{j!=="playing"&&(w(wn({playStatus:"playing"})),E.current=!1)},X=()=>{c.current&&u.current&&(u.current.innerText="0:00",c.current.style.background="var-(--a-10-cl)")},he=ge=>{const rn=un().volume||1;if(ge<=2){const ht=ge/2*rn;s.current.volume=ht}else if(ge<o.current){s.current.volume!=rn&&(s.current.volume=rn);return}if(ge>=o.current){const ht=(s.current.duration-ge)/2*rn;s.current.volume=ht}},pe=()=>{const ge=s.current.currentTime;I.current!=="paused"&&w(wn({playStatus:"playing"})),D(ge),n&&he(ge),ge&&Math.round(ge)%3===0&&ot("current_time",Math.round(ge))},Ie=()=>{if(!R.current)return;const ge=un(),rn=ge.volume||1,ht=ge.timer;if(t==="one")return ht?ht!==1?P():ee():P();s.current.volume=rn,k.current=!0;const dr=R.current.index===v.length-1;if(ht===0&&ge.is_timer?(M.current=!0,ot("is_timer",!1)):dr&&(t==="all"||ht>=1?M.current=!1:M.current=!0),e){let hr=R.current.index;for(;hr===R.current.index;)hr=Math.round(Math.random()*v.length-1);const us=Be(hr);return w(oi(us.queue_id))}return v.length===1?X():A()},vt=()=>{R.current&&w(wn({playStatus:"loading"}))},ve=()=>{if(!R.current)return;const ge=s.current.duration;if(o.current=ge-3,ot("current_queue_id",R.current.song.queue_id),M.current)return M.current=!1,w(wn({playStatus:"paused"}));if((_e||i.current)&&(w(wn({playStatus:"paused"})),i.current)){i.current=!1,d.current=!0,D(He.current_time||0);return}P()},pn=()=>{w(wn({playStatus:"waiting"}))},Dt=()=>{if(R.current){if(E.current||(E.current=!0,g("Found internet error")),!k.current)return w(wn({playStatus:"error"}));if(v.length>1){if(R.current.index===v.length-1){w(wn({playStatus:"error"}));return}A()}else w(wn({playStatus:"error"}))}};h.useEffect(()=>{const ge=He.current_queue_id||null;ge&&v.length?w(oi(ge)):i.current=!1},[]),h.useEffect(()=>(s.current.addEventListener("error",Dt),s.current.addEventListener("pause",B),s.current.addEventListener("play",K),s.current.addEventListener("loadstart",vt),s.current.addEventListener("loadedmetadata",ve),s.current.addEventListener("waiting",pn),()=>{var ge,rn,ht,dr,hr,us;(ge=s.current)==null||ge.removeEventListener("error",Dt),(rn=s.current)==null||rn.removeEventListener("pause",B),(ht=s.current)==null||ht.removeEventListener("play",K),(dr=s.current)==null||dr.removeEventListener("loadstart",vt),(hr=s.current)==null||hr.removeEventListener("loadedmetadata",ve),(us=s.current)==null||us.addEventListener("waiting",pn)}),[]),h.useEffect(()=>{if(!_||!b){I.current="paused",ee();return}return s.current.src=r&&_.song.beat_url?_.song.beat_url:_.song.song_url,R.current=_,()=>{X(),l.current=!0,d.current&&(d.current=!1)}},[_==null?void 0:_.song]),h.useEffect(()=>{if(!_){j==="paused"&&X();return}let ge=`${_.song.name}`;j==="paused"&&T&&_.song.queue_id.includes(T.id)&&(ge=`${T.name}`),document.title=ge,I.current=j},[j]),h.useEffect(()=>(s.current.addEventListener("ended",Ie),()=>{var ge;return(ge=s.current)==null?void 0:ge.removeEventListener("ended",Ie)}),[t,e,b,v]),h.useEffect(()=>(s.current.addEventListener("timeupdate",pe),()=>{var ge;(ge=s.current)==null||ge.removeEventListener("timeupdate",pe)}),[n]),h.useEffect(()=>{_e&&j==="playing"&&ee()},[_e]),h.useEffect(()=>{if(x){p.current="#fff";return}if(!s.current)return;f?p.current="#fff":p.current="var(--primary-cl)";const ge=s.current.currentTime;I.current==="paused"&&D(ge)},[f])}function AZ(t,e){const{currentSongData:n}=fe(rt),{isOpenFullScreen:r,setIdle:s}=lt(),[i,o]=h.useState(0),l=h.useRef(),c=h.useRef(),u=()=>{s(!1),o(Math.random())},d=()=>{clearTimeout(c.current),clearTimeout(l.current)},f=async()=>{if(!r)return;const p=document.querySelector(".song-thumb.active"),g=document.querySelector(".song-list-container");if(p&&g){const x=Av(p,g,!0);let w=e_.focusDelay;x||(w=0),l.current=setTimeout(()=>{s(!0)},w)}};if(h.useEffect(()=>{if(!(e||!n)){if(!r){s(!1);return}return setTimeout(()=>{window.addEventListener("mousemove",u),window.dispatchEvent(new Event("mousemove"))},1e3),()=>{window.removeEventListener("mousemove",u),d()}}},[r]),h.useEffect(()=>(c.current=setTimeout(()=>{f()},t),()=>{d()}),[i]),!r)return!1}function PZ({audioEle:t}){const{currentSongData:e,currentQueueId:n}=fe(rt),{pushRecentSong:r}=lA(),s=h.useRef(""),i=async()=>{if(!n||!(e!=null&&e.song))return;const o=e.song.id;e.song.is_official&&s.current!==n&&(s.current=n,HR(o),r(e.song))};h.useEffect(()=>(t.addEventListener("playing",i),()=>{t.removeEventListener("playing",i)}),[n])}function FZ({children:t,audioEle:e}){const{isOnMobile:n}=as();return NZ(),RZ(),AZ(e_.focusDelay,n),PZ({audioEle:e}),h.useMemo(()=>t,[])}function MZ(){const{isOnMobile:t}=as(),{audioRef:e}=lt(),[n,r]=h.useState(!1),s=e.current&&a.jsxs(a.Fragment,{children:[a.jsx(YJ,{}),a.jsx(rZ,{}),a.jsx(mZ,{})]}),i=e.current&&a.jsxs(a.Fragment,{children:[a.jsx(kZ,{}),a.jsx(CZ,{})]});return h.useEffect(()=>{r(!0)},[]),a.jsxs(a.Fragment,{children:[a.jsx("audio",{ref:e,className:"hidden"}),e.current&&a.jsx(FZ,{audioEle:e.current,children:t?i:s})]})}function DZ({className:t}){const[e,n]=h.useState(!1),r=()=>{const i=document.querySelector(".main-container");if(!i)return;const o=i.scrollTop||0;n(o>100)},s=()=>{const i=document.querySelector(".main-container");i==null||i.scroll({behavior:"smooth",top:0})};return h.useEffect(()=>{const i=document.querySelector(".main-container");if(i)return i.addEventListener("scroll",r),()=>{i.removeEventListener("scroll",r)}},[]),a.jsx(ce,{onClick:s,size:"clear",className:`absolute p-2 transition-[transform,opacity] 
         ${t||""} 
         w-[36px] 
         hover:bg-[--a-5-cl]  
      ${e?"opacity-[1]":"opacity-0 translate-y-[20px]"}`,children:a.jsx(W9,{className:"w-6"})})}function LZ(){const{user:t,loading:e}=ye(),n=Wn(),r=[...Array(4).keys()].map(o=>a.jsxs("div",{className:"h-[55px] lg:h-[55px] w-full ske",children:[a.jsx(we,{className:"w-6 h-6 flex-shrink-0"}),a.jsx(we,{className:"w-[60px] h-[22px] md:h-[14px] md:mt-[2px] lg:h-[16px] lg:w-[70px]"})]},o)),s=o=>o?"text-[--primary-cl]":"",i={container:"w-[80px] lg:w-[160px] relative flex-shrink-0 h-screen bg-[--sidebar-collapse-cl] lg:bg-[--sidebar-cl] ",linkList:`
      hover:[&_div:not(.ske)]:bg-[--a-5-cl]
      [&_div]:py-1.5
      [&_div]:leading-[2.2] 
      [&_div]:flex 
      [&_div]:flex-col 
      [&_div]:items-center
      [&_span]:text-xs
      [&_span]:mt-[2px]
      [&_span]:font-semibold

      lg:[&_div]:py-2
      lg:[&_div]:pl-4
      lg:[&_span]:mt-0
      lg:[&_div]:space-x-2 
      lg:[&_div]:px-3
      lg:[&_div]:flex-row 
      lg:[&_div]:items-center
      [&_svg]:w-6
      [&_a]:w-full
      lg:[&_span]:text-[14px]
      lg:[&_span]:inline-block
      `};return a.jsxs("div",{className:`${i.container}`,children:[a.jsx("div",{className:"px-[10px] h-[80px] flex items-center justify-center",children:a.jsx(se,{to:"/",className:"bg-white dark:bg-[--layout-cl] w-12 flex h-12 rounded-full justify-center items-center",children:a.jsx("span",{className:"text-[--primary-cl] text-xl font-bold translate-y-[1px]",children:":D"})})}),a.jsxs("div",{className:`flex flex-col items-start ${i.linkList}`,children:[e&&r,!e&&a.jsxs(a.Fragment,{children:[a.jsx(se,{className:`
              ${s(n.pathname==="/")}
            `,to:"/",children:a.jsxs("div",{children:[a.jsx(Yd,{}),a.jsx("span",{children:"For You"})]})}),a.jsx(se,{className:`
              ${s(n.pathname.includes("/discover"))}
            `,to:"/discover",children:a.jsxs("div",{children:[a.jsx(CT,{}),a.jsx("span",{children:"Discover"})]})}),a.jsx(se,{className:`
              ${s(n.pathname.includes("/category"))}
            `,to:"/category",children:a.jsxs("div",{children:[a.jsx(Hp,{}),a.jsx("span",{children:"Category"})]})}),a.jsx(se,{className:`
              ${s(n.pathname.includes("/trending"))}
            `,to:"/trending",children:a.jsxs("div",{children:[a.jsx(F1,{}),a.jsx("span",{children:"Trending"})]})}),t&&a.jsxs(a.Fragment,{children:[a.jsx(se,{className:`
                  ${s(n.pathname.includes("/my-music"))}`,to:"/my-music",children:a.jsxs("div",{children:[a.jsx(qi,{}),a.jsx("span",{children:"My Song"})]})}),t.role==="ADMIN"&&a.jsx(se,{to:"/dashboard",target:"_blank",className:"border-transparent",children:a.jsxs("div",{children:[a.jsx(Bp,{}),a.jsx("span",{className:"",children:"Dashboard"})]})})]})]})]}),a.jsx(DZ,{className:"left-[50%] translate-x-[-50%] bottom-[80px] md:bottom-[100px]"})]})}function OZ({contentRef:t}){const[e,n]=h.useState(0),[r,s]=i_(Ga),[i,o]=h.useState(""),l=h.useRef(null),c=h.useRef(null),u=h.useRef(null),{action:d}=Mg(),f=Wn(),p=T=>{var R,M;o(T),(R=u.current)==null||R.toggle(),(M=l.current)==null||M.close()},g=()=>{var T;return(T=u.current)==null?void 0:T.close()},x=async()=>{var T;try{await d("logout")}catch(R){console.log("signOut error",{message:R})}finally{(T=u.current)==null||T.toggle()}},w=async()=>{var T;try{(T=c.current)==null||T.close(),await d("login")}catch(R){console.log({message:R})}},v=()=>{var R;const T=((R=t.current)==null?void 0:R.scrollTop)||0;n(T)},_=a.jsx(we,{className:"h-[40px] w-[40px] rounded-full"}),b=h.useMemo(()=>{switch(i){case"":return a.jsx(a.Fragment,{});case"theme":return a.jsx(aR,{closeModal:g});case"info":return a.jsx(MT,{closeModal:g});case"confirm":return a.jsx(hn,{closeModal:g,callback:x,loading:!1,label:"Sign out ?"})}},[i]);h.useEffect(()=>{var T;return(T=t.current)==null||T.addEventListener("scroll",v),()=>{document.removeEventListener("scroll",v)}},[]),h.useEffect(()=>{t.current&&t.current.scrollTo(0,0)},[f]);const j={userName:"text-[16px] font-[500] ml-[8px] line-clamp-1",button:"h-[40px] w-[40px] rounded-full hover:bg-[--a-5-cl]",icon:"w-5 mr-1",divide:"h-[1px]  w-[calc(100%-20px)] mb-[10px] mt-[20px] mx-auto bg-[--a-5-cl]"};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:`h-[60px] fixed top-0 right-0  left-[80px] lg:left-[160px] z-[20] bg-transparent  ${e?"shadow-lg":""}`,children:[a.jsx("div",{className:`${e?"":"hidden "} absolute inset-0 bg-[--player-cl] bg-opacity-[0.8] backdrop-blur-[15px] z-[-1] `}),a.jsxs("div",{className:"px-[40px] items-center flex h-full",children:[a.jsx(uA,{className:"mr-5"}),a.jsx(lN,{}),a.jsxs("div",{className:"flex space-x-3 ml-auto",children:[a.jsxs(nr,{children:[a.jsx(rr,{ref:l,children:a.jsx(Fi,{isWrapped:!0,position:"top-[calc(100%+8px)]",content:"Settings",children:a.jsx("button",{className:`flex px-[6px] items-center ${j.button} `,children:a.jsx(_T,{className:"w-full"})})})}),a.jsx(sr,{className:"top-[calc(100%+8px)] right-0",animationClassName:"origin-top-right",children:a.jsx(uH,{openModal:p,variant:"client"})})]}),a.jsxs(nr,{children:[a.jsx(rr,{ref:c,className:"flex items-center",children:a.jsx("button",{className:"flex hover:brightness-90",children:s?_:a.jsx(gv,{className:"w-[40px] h-[40px]"})})}),a.jsx(sr,{className:"top-[calc(100%+8px)] right-0",animationClassName:"origin-top-right",children:a.jsxs(cr,{className:"w-[250px] px-3",children:[r&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center p-[10px] pb-0",children:[a.jsx(gv,{className:"login-trigger w-[46px] h-[46px]"}),a.jsx("div",{className:"ml-[12px]",children:a.jsx("h5",{className:"font-semibold line-clamp-1",children:r==null?void 0:r.displayName})})]}),a.jsx("div",{className:j.divide})]}),a.jsxs(ls,{className:"[&_button]:rounded-md",children:[r&&a.jsxs("button",{onClick:()=>p("confirm"),children:[a.jsx(ST,{className:j.icon}),"Log out"]}),!r&&a.jsxs("button",{onClick:w,children:[a.jsx(bT,{className:j.icon}),"Log in"]})]})]})})]})]})]})]}),a.jsx(ie,{variant:"animation",ref:u,children:b})]})}function $Z(){const{setErrorToast:t,setSuccessToast:e}=ne(),{user:n,setUser:r}=ye(),{uploadedSongs:s,setUploadedSongs:i,shouldFetchFavoriteSongs:o}=yt(),{setIsUploading:l,isUploading:c,setUploadingSongs:u,resetUploadContext:d}=tR(),[f,p]=h.useState(""),g=h.useRef(null),x=()=>{const v=g.current;v&&(v.value=""),d()},w=async v=>{try{if(!n)return;const _=[],b=[],j=v.target.files;if(!j.length)return;const T=[],R=[],M=Date.now(),k=A=>s.some(D=>D.size===A.size)||T.some(D=>D.size===A.size);for(let A=0;A<=j.length-1;A++){const D=j[A],P=await BN(D);if(!P)continue;const ee={name:P.singer,created_at:""},_e={...fv(ee),id:""},He={name:P.name,singers:[_e],duration:Math.floor(P.duration),size:Math.floor(D.size/1024)},Be=P.image?new Blob([P.image]):null;Be&&(b.push(Be),He.image_url=URL.createObjectURL(Be));const B=dv({...He,owner_email:n.email,distributor:n.display_name});if(k(B)){console.log(">>>duplicate");continue}T.push(B),_.push(A)}if(s.length+_.length>20)throw p("You have reach the upload limit"),new Error("Limit");if(!T.length)return;u(T),l(!0);for(let A=0;A<_.length;A++){const D=_[A],P=b[A];let ee;const _e={...T[A]},He=gh({file:j[D],folder:"/songs/",msg:"upload song file"});P&&(ee=Yi({blob:P}));const[Be,{fileId:B,url:K}]=await Promise.all([ee,He]);if(Object.assign(_e,{song_file_id:B,song_url:K}),Be){const Ie={image_url:Be.image_url,image_file_id:Be.image_file_id,blurhash_encode:Be.blurhash_encode};Object.assign(_e,Ie)}const X=await ai({collectionName:"Songs",data:_e,msg:">>> api: set song doc"}),he=await Tc(X);R.push(he.id);const pe={...he.data(),id:X.id,queue_id:fl(4)};i(Ie=>[...Ie,pe]),u(Ie=>{const vt=[...Ie];return vt.shift(),vt})}const I={liked_song_ids:[...R,...n.liked_song_ids]};await Re({collectionName:"Users",data:I,id:n.email}),r({...n,...I}),o.current=!0,e(`${T.length} songs uploaded`);const C=Date.now()}catch(_){console.log({message:_}),t(f)}finally{x()}};return h.useEffect(()=>{if(!c)return;const v=document.querySelector(".temp-song");v&&v.scrollIntoView({behavior:"smooth",block:"center"})},[c]),{handleInputChange:w,inputRef:g}}function zZ(){const{handleInputChange:t,inputRef:e}=$Z(),n={container:"upload portal fixed z-[199] bottom-[120px] right-[30px] max-[549px]:bottom-[unset] max-[540px]:top-[10px] max-[540px]:right-[10px]"};return a.jsx(a.Fragment,{children:il.createPortal(a.jsx("div",{className:n.container,children:a.jsx("input",{ref:e,onChange:t,type:"file",multiple:!0,accept:"audio",id:"song_upload",className:"hidden"})}),document.getElementById("portals"))})}function BZ({children:t}){const{theme:e,isOnMobile:n}=as(),{isOpenFullScreen:r}=lt(),s=h.useRef(null),i={page:"md:flex md:h-screen bg-[--layout-cl] text-[--text-cl] transition-[color]",container:"main-container pt-5 overflow-x-hidden md:pt-0 md:h-full md:w-full md:flex md:flex-col px-[10px] md:px-[40px] md:pt-[60px] md:overflow-auto "};return h.useEffect(()=>{const o=document.querySelector(".my-tag"),l=document.querySelector("body");l&&(l.setAttribute("data-theme",e.id),e.type==="dark"?l.classList.add("dark"):l.classList.remove("dark"),r?l.classList.add("full-screen"):l.classList.remove("full-screen"),n&&(l.style.backgroundColor="var(--layout-cl)")),o&&o.setAttribute("content",e.container)},[e]),h.useEffect(()=>{const o=document.querySelector("body");o&&(r?o.classList.add("full-screen"):o.classList.remove("full-screen"))},[r]),a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:`${i.page}`,children:[!n&&a.jsx(LZ,{}),a.jsxs("div",{ref:s,className:`${i.container}`,children:[!n&&a.jsx(OZ,{contentRef:s}),t]}),a.jsx(MZ,{})]}),a.jsx(dA,{className:"left-[50%] translate-x-[-50%] top-[10px] md:top-[unset] md:bottom-[100px] md:left-[20px] md:translate-x-0"}),a.jsx(zZ,{}),!n&&a.jsx(JC,{})]})}function VZ(){return a.jsx(O9,{children:a.jsx(ZC,{children:a.jsx(BZ,{children:a.jsx(zp,{})})})})}function Cx({children:t}){return t}function UZ(){return a.jsx(a.Fragment,{children:a.jsx(O4,{children:a.jsxs(N4,{children:[a.jsx(_s,{path:"*",element:a.jsx(EW,{})}),a.jsx(_s,{path:"/unauthorized",element:a.jsx(jW,{})}),a.jsx(_s,{path:"/login",element:a.jsx(kW,{})}),a.jsxs(_s,{element:a.jsx(VZ,{}),children:[TJ.map((t,e)=>{const n=t.layout||Cx,r=t.component;return a.jsx(_s,{path:t.path,element:a.jsx(n,{children:a.jsx(r,{})})},e)}),a.jsx(_s,{element:a.jsx(RJ,{}),children:IJ.map((t,e)=>{const n=t.layout||Cx,r=t.component;return a.jsx(_s,{path:t.path,element:a.jsx(n,{children:a.jsx(r,{})})},e)})})]}),a.jsx(_s,{element:a.jsx(NJ,{}),children:a.jsx(_s,{element:a.jsx(zJ,{}),children:CJ.map((t,e)=>{const n=t.layout||Cx,r=t.component;return a.jsx(_s,{path:t.path,element:a.jsx(n,{children:a.jsx(r,{})})},e)})})})]})})})}const HZ=xV({reducer:{currentPlaylist:uU,playStatus:RV,songQueue:MV},middleware:t=>t({serializableCheck:!1})});function GZ(){const{setUser:t,setLoading:e,loading:n,user:r}=ye(),s=h.useRef(!1),i=async()=>{Ga.onAuthStateChanged(async o=>{if(o&&o.email){const l=await en({collectionName:"Users",id:o.email,msg:"usePersistAuth, get user"}),c=l.data(),u={email:o.email,display_name:o.displayName,photo_url:o.photoURL,liked_song_ids:(c==null?void 0:c.liked_song_ids)||[],recent_playlist_ids:(c==null?void 0:c.recent_playlist_ids)||[],recent_song_ids:(c==null?void 0:c.recent_song_ids)||[],liked_singer_ids:(c==null?void 0:c.liked_singer_ids)||[],role:(c==null?void 0:c.role)||"USER",liked_playlist_ids:(c==null?void 0:c.liked_playlist_ids)||[],liked_comment_ids:un().liked_comment_ids||[],last_seen:""};l.exists()?Re({collectionName:"Users",id:u.email,data:{last_seen:pt()},msg:"usePersistAuth, update user doc"}):await tv(gt(de,"Users",u.email),u),t(u)}else t(null);e(!1)})};return h.useEffect(()=>{s.current||(s.current=!0,i())},[]),{user:r,loading:n}}function WZ({children:t}){return GZ(),t}Rx.createRoot(document.getElementById("root")).render(a.jsx(oj.StrictMode,{children:a.jsx(tU,{store:HZ,children:a.jsx(lM,{children:a.jsx(T9,{children:a.jsx(dM,{children:a.jsx(C9,{children:a.jsx(F9,{children:a.jsx(N9,{children:a.jsx(WZ,{children:a.jsx(UZ,{})})})})})})})})})}));
