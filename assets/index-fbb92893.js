function FN(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function s2(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var i2={exports:{}},Nf={},a2={exports:{}},ke={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fu=Symbol.for("react.element"),DN=Symbol.for("react.portal"),LN=Symbol.for("react.fragment"),MN=Symbol.for("react.strict_mode"),ON=Symbol.for("react.profiler"),$N=Symbol.for("react.provider"),BN=Symbol.for("react.context"),zN=Symbol.for("react.forward_ref"),UN=Symbol.for("react.suspense"),VN=Symbol.for("react.memo"),HN=Symbol.for("react.lazy"),Q1=Symbol.iterator;function WN(t){return t===null||typeof t!="object"?null:(t=Q1&&t[Q1]||t["@@iterator"],typeof t=="function"?t:null)}var o2={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},l2=Object.assign,c2={};function rl(t,e,n){this.props=t,this.context=e,this.refs=c2,this.updater=n||o2}rl.prototype.isReactComponent={};rl.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};rl.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function u2(){}u2.prototype=rl.prototype;function Dx(t,e,n){this.props=t,this.context=e,this.refs=c2,this.updater=n||o2}var Lx=Dx.prototype=new u2;Lx.constructor=Dx;l2(Lx,rl.prototype);Lx.isPureReactComponent=!0;var K1=Array.isArray,d2=Object.prototype.hasOwnProperty,Mx={current:null},h2={key:!0,ref:!0,__self:!0,__source:!0};function f2(t,e,n){var r,s={},i=null,a=null;if(e!=null)for(r in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(i=""+e.key),e)d2.call(e,r)&&!h2.hasOwnProperty(r)&&(s[r]=e[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:fu,type:t,key:i,ref:a,props:s,_owner:Mx.current}}function qN(t,e){return{$$typeof:fu,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Ox(t){return typeof t=="object"&&t!==null&&t.$$typeof===fu}function GN(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var X1=/\/+/g;function mp(t,e){return typeof t=="object"&&t!==null&&t.key!=null?GN(""+t.key):e.toString(36)}function qd(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case fu:case DN:a=!0}}if(a)return a=t,s=s(a),t=r===""?"."+mp(a,0):r,K1(s)?(n="",t!=null&&(n=t.replace(X1,"$&/")+"/"),qd(s,e,n,"",function(u){return u})):s!=null&&(Ox(s)&&(s=qN(s,n+(!s.key||a&&a.key===s.key?"":(""+s.key).replace(X1,"$&/")+"/")+t)),e.push(s)),1;if(a=0,r=r===""?".":r+":",K1(t))for(var l=0;l<t.length;l++){i=t[l];var c=r+mp(i,l);a+=qd(i,e,n,c,s)}else if(c=WN(t),typeof c=="function")for(t=c.call(t),l=0;!(i=t.next()).done;)i=i.value,c=r+mp(i,l++),a+=qd(i,e,n,c,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function dd(t,e,n){if(t==null)return t;var r=[],s=0;return qd(t,r,"","",function(i){return e.call(n,i,s++)}),r}function QN(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var wn={current:null},Gd={transition:null},KN={ReactCurrentDispatcher:wn,ReactCurrentBatchConfig:Gd,ReactCurrentOwner:Mx};ke.Children={map:dd,forEach:function(t,e,n){dd(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return dd(t,function(){e++}),e},toArray:function(t){return dd(t,function(e){return e})||[]},only:function(t){if(!Ox(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ke.Component=rl;ke.Fragment=LN;ke.Profiler=ON;ke.PureComponent=Dx;ke.StrictMode=MN;ke.Suspense=UN;ke.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=KN;ke.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=l2({},t.props),s=t.key,i=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,a=Mx.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)d2.call(e,c)&&!h2.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:fu,type:t.type,key:s,ref:i,props:r,_owner:a}};ke.createContext=function(t){return t={$$typeof:BN,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:$N,_context:t},t.Consumer=t};ke.createElement=f2;ke.createFactory=function(t){var e=f2.bind(null,t);return e.type=t,e};ke.createRef=function(){return{current:null}};ke.forwardRef=function(t){return{$$typeof:zN,render:t}};ke.isValidElement=Ox;ke.lazy=function(t){return{$$typeof:HN,_payload:{_status:-1,_result:t},_init:QN}};ke.memo=function(t,e){return{$$typeof:VN,type:t,compare:e===void 0?null:e}};ke.startTransition=function(t){var e=Gd.transition;Gd.transition={};try{t()}finally{Gd.transition=e}};ke.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};ke.useCallback=function(t,e){return wn.current.useCallback(t,e)};ke.useContext=function(t){return wn.current.useContext(t)};ke.useDebugValue=function(){};ke.useDeferredValue=function(t){return wn.current.useDeferredValue(t)};ke.useEffect=function(t,e){return wn.current.useEffect(t,e)};ke.useId=function(){return wn.current.useId()};ke.useImperativeHandle=function(t,e,n){return wn.current.useImperativeHandle(t,e,n)};ke.useInsertionEffect=function(t,e){return wn.current.useInsertionEffect(t,e)};ke.useLayoutEffect=function(t,e){return wn.current.useLayoutEffect(t,e)};ke.useMemo=function(t,e){return wn.current.useMemo(t,e)};ke.useReducer=function(t,e,n){return wn.current.useReducer(t,e,n)};ke.useRef=function(t){return wn.current.useRef(t)};ke.useState=function(t){return wn.current.useState(t)};ke.useSyncExternalStore=function(t,e,n){return wn.current.useSyncExternalStore(t,e,n)};ke.useTransition=function(){return wn.current.useTransition()};ke.version="18.2.0";a2.exports=ke;var m=a2.exports;const m2=s2(m),XN=FN({__proto__:null,default:m2},[m]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var YN=m,JN=Symbol.for("react.element"),ZN=Symbol.for("react.fragment"),e5=Object.prototype.hasOwnProperty,t5=YN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,n5={key:!0,ref:!0,__self:!0,__source:!0};function p2(t,e,n){var r,s={},i=null,a=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(a=e.ref);for(r in e)e5.call(e,r)&&!n5.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:JN,type:t,key:i,ref:a,props:s,_owner:t5.current}}Nf.Fragment=ZN;Nf.jsx=p2;Nf.jsxs=p2;i2.exports=Nf;var o=i2.exports;var Rg={},g2={exports:{}},tr={},x2={exports:{}},y2={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(H,Y){var te=H.length;H.push(Y);e:for(;0<te;){var ye=te-1>>>1,Te=H[ye];if(0<s(Te,Y))H[ye]=Y,H[te]=Te,te=ye;else break e}}function n(H){return H.length===0?null:H[0]}function r(H){if(H.length===0)return null;var Y=H[0],te=H.pop();if(te!==Y){H[0]=te;e:for(var ye=0,Te=H.length,He=Te>>>1;ye<He;){var Tr=2*(ye+1)-1,ir=H[Tr],ar=Tr+1,Mn=H[ar];if(0>s(ir,te))ar<Te&&0>s(Mn,ir)?(H[ye]=Mn,H[ar]=te,ye=ar):(H[ye]=ir,H[Tr]=te,ye=Tr);else if(ar<Te&&0>s(Mn,te))H[ye]=Mn,H[ar]=te,ye=ar;else break e}}return Y}function s(H,Y){var te=H.sortIndex-Y.sortIndex;return te!==0?te:H.id-Y.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var c=[],u=[],d=1,f=null,p=3,g=!1,v=!1,_=!1,b=typeof setTimeout=="function"?setTimeout:null,E=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(H){for(var Y=n(u);Y!==null;){if(Y.callback===null)r(u);else if(Y.startTime<=H)r(u),Y.sortIndex=Y.expirationTime,e(c,Y);else break;Y=n(u)}}function I(H){if(_=!1,S(H),!v)if(n(c)!==null)v=!0,Se(F);else{var Y=n(u);Y!==null&&Ue(I,Y.startTime-H)}}function F(H,Y){v=!1,_&&(_=!1,E(k),k=-1),g=!0;var te=p;try{for(S(Y),f=n(c);f!==null&&(!(f.expirationTime>Y)||H&&!N());){var ye=f.callback;if(typeof ye=="function"){f.callback=null,p=f.priorityLevel;var Te=ye(f.expirationTime<=Y);Y=t.unstable_now(),typeof Te=="function"?f.callback=Te:f===n(c)&&r(c),S(Y)}else r(c);f=n(c)}if(f!==null)var He=!0;else{var Tr=n(u);Tr!==null&&Ue(I,Tr.startTime-Y),He=!1}return He}finally{f=null,p=te,g=!1}}var D=!1,C=null,k=-1,R=5,j=-1;function N(){return!(t.unstable_now()-j<R)}function P(){if(C!==null){var H=t.unstable_now();j=H;var Y=!0;try{Y=C(!0,H)}finally{Y?A():(D=!1,C=null)}}else D=!1}var A;if(typeof w=="function")A=function(){w(P)};else if(typeof MessageChannel<"u"){var ee=new MessageChannel,xe=ee.port2;ee.port1.onmessage=P,A=function(){xe.postMessage(null)}}else A=function(){b(P,0)};function Se(H){C=H,D||(D=!0,A())}function Ue(H,Y){k=b(function(){H(t.unstable_now())},Y)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(H){H.callback=null},t.unstable_continueExecution=function(){v||g||(v=!0,Se(F))},t.unstable_forceFrameRate=function(H){0>H||125<H?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<H?Math.floor(1e3/H):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(H){switch(p){case 1:case 2:case 3:var Y=3;break;default:Y=p}var te=p;p=Y;try{return H()}finally{p=te}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(H,Y){switch(H){case 1:case 2:case 3:case 4:case 5:break;default:H=3}var te=p;p=H;try{return Y()}finally{p=te}},t.unstable_scheduleCallback=function(H,Y,te){var ye=t.unstable_now();switch(typeof te=="object"&&te!==null?(te=te.delay,te=typeof te=="number"&&0<te?ye+te:ye):te=ye,H){case 1:var Te=-1;break;case 2:Te=250;break;case 5:Te=1073741823;break;case 4:Te=1e4;break;default:Te=5e3}return Te=te+Te,H={id:d++,callback:Y,priorityLevel:H,startTime:te,expirationTime:Te,sortIndex:-1},te>ye?(H.sortIndex=te,e(u,H),n(c)===null&&H===n(u)&&(_?(E(k),k=-1):_=!0,Ue(I,te-ye))):(H.sortIndex=Te,e(c,H),v||g||(v=!0,Se(F))),H},t.unstable_shouldYield=N,t.unstable_wrapCallback=function(H){var Y=p;return function(){var te=p;p=Y;try{return H.apply(this,arguments)}finally{p=te}}}})(y2);x2.exports=y2;var r5=x2.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var v2=m,Jn=r5;function V(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var w2=new Set,Tc={};function Wa(t,e){$o(t,e),$o(t+"Capture",e)}function $o(t,e){for(Tc[t]=e,t=0;t<e.length;t++)w2.add(e[t])}var Ls=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ag=Object.prototype.hasOwnProperty,s5=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Y1={},J1={};function i5(t){return Ag.call(J1,t)?!0:Ag.call(Y1,t)?!1:s5.test(t)?J1[t]=!0:(Y1[t]=!0,!1)}function a5(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function o5(t,e,n,r){if(e===null||typeof e>"u"||a5(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function _n(t,e,n,r,s,i,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=a}var Vt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Vt[t]=new _n(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Vt[e]=new _n(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Vt[t]=new _n(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Vt[t]=new _n(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Vt[t]=new _n(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Vt[t]=new _n(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Vt[t]=new _n(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Vt[t]=new _n(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Vt[t]=new _n(t,5,!1,t.toLowerCase(),null,!1,!1)});var $x=/[\-:]([a-z])/g;function Bx(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace($x,Bx);Vt[e]=new _n(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace($x,Bx);Vt[e]=new _n(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace($x,Bx);Vt[e]=new _n(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Vt[t]=new _n(t,1,!1,t.toLowerCase(),null,!1,!1)});Vt.xlinkHref=new _n("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Vt[t]=new _n(t,1,!1,t.toLowerCase(),null,!0,!0)});function zx(t,e,n,r){var s=Vt.hasOwnProperty(e)?Vt[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(o5(e,n,s,r)&&(n=null),r||s===null?i5(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Ks=v2.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,hd=Symbol.for("react.element"),po=Symbol.for("react.portal"),go=Symbol.for("react.fragment"),Ux=Symbol.for("react.strict_mode"),Ng=Symbol.for("react.profiler"),_2=Symbol.for("react.provider"),b2=Symbol.for("react.context"),Vx=Symbol.for("react.forward_ref"),Pg=Symbol.for("react.suspense"),Fg=Symbol.for("react.suspense_list"),Hx=Symbol.for("react.memo"),di=Symbol.for("react.lazy"),S2=Symbol.for("react.offscreen"),Z1=Symbol.iterator;function zl(t){return t===null||typeof t!="object"?null:(t=Z1&&t[Z1]||t["@@iterator"],typeof t=="function"?t:null)}var st=Object.assign,pp;function tc(t){if(pp===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);pp=e&&e[1]||""}return`
`+pp+t}var gp=!1;function xp(t,e){if(!t||gp)return"";gp=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),i=r.stack.split(`
`),a=s.length-1,l=i.length-1;1<=a&&0<=l&&s[a]!==i[l];)l--;for(;1<=a&&0<=l;a--,l--)if(s[a]!==i[l]){if(a!==1||l!==1)do if(a--,l--,0>l||s[a]!==i[l]){var c=`
`+s[a].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=a&&0<=l);break}}}finally{gp=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?tc(t):""}function l5(t){switch(t.tag){case 5:return tc(t.type);case 16:return tc("Lazy");case 13:return tc("Suspense");case 19:return tc("SuspenseList");case 0:case 2:case 15:return t=xp(t.type,!1),t;case 11:return t=xp(t.type.render,!1),t;case 1:return t=xp(t.type,!0),t;default:return""}}function Dg(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case go:return"Fragment";case po:return"Portal";case Ng:return"Profiler";case Ux:return"StrictMode";case Pg:return"Suspense";case Fg:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case b2:return(t.displayName||"Context")+".Consumer";case _2:return(t._context.displayName||"Context")+".Provider";case Vx:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Hx:return e=t.displayName||null,e!==null?e:Dg(t.type)||"Memo";case di:e=t._payload,t=t._init;try{return Dg(t(e))}catch{}}return null}function c5(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Dg(e);case 8:return e===Ux?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Li(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function E2(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function u5(t){var e=E2(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(a){r=""+a,i.call(this,a)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function fd(t){t._valueTracker||(t._valueTracker=u5(t))}function k2(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=E2(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function wh(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Lg(t,e){var n=e.checked;return st({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function e_(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Li(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function T2(t,e){e=e.checked,e!=null&&zx(t,"checked",e,!1)}function Mg(t,e){T2(t,e);var n=Li(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Og(t,e.type,n):e.hasOwnProperty("defaultValue")&&Og(t,e.type,Li(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function t_(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Og(t,e,n){(e!=="number"||wh(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var nc=Array.isArray;function jo(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Li(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function $g(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(V(91));return st({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function n_(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(V(92));if(nc(n)){if(1<n.length)throw Error(V(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Li(n)}}function I2(t,e){var n=Li(e.value),r=Li(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function r_(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function C2(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Bg(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?C2(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var md,j2=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(md=md||document.createElement("div"),md.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=md.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Ic(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var dc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},d5=["Webkit","ms","Moz","O"];Object.keys(dc).forEach(function(t){d5.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),dc[e]=dc[t]})});function R2(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||dc.hasOwnProperty(t)&&dc[t]?(""+e).trim():e+"px"}function A2(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=R2(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var h5=st({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function zg(t,e){if(e){if(h5[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(V(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(V(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(V(61))}if(e.style!=null&&typeof e.style!="object")throw Error(V(62))}}function Ug(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Vg=null;function Wx(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Hg=null,Ro=null,Ao=null;function s_(t){if(t=gu(t)){if(typeof Hg!="function")throw Error(V(280));var e=t.stateNode;e&&(e=Mf(e),Hg(t.stateNode,t.type,e))}}function N2(t){Ro?Ao?Ao.push(t):Ao=[t]:Ro=t}function P2(){if(Ro){var t=Ro,e=Ao;if(Ao=Ro=null,s_(t),e)for(t=0;t<e.length;t++)s_(e[t])}}function F2(t,e){return t(e)}function D2(){}var yp=!1;function L2(t,e,n){if(yp)return t(e,n);yp=!0;try{return F2(t,e,n)}finally{yp=!1,(Ro!==null||Ao!==null)&&(D2(),P2())}}function Cc(t,e){var n=t.stateNode;if(n===null)return null;var r=Mf(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(V(231,e,typeof n));return n}var Wg=!1;if(Ls)try{var Ul={};Object.defineProperty(Ul,"passive",{get:function(){Wg=!0}}),window.addEventListener("test",Ul,Ul),window.removeEventListener("test",Ul,Ul)}catch{Wg=!1}function f5(t,e,n,r,s,i,a,l,c){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(d){this.onError(d)}}var hc=!1,_h=null,bh=!1,qg=null,m5={onError:function(t){hc=!0,_h=t}};function p5(t,e,n,r,s,i,a,l,c){hc=!1,_h=null,f5.apply(m5,arguments)}function g5(t,e,n,r,s,i,a,l,c){if(p5.apply(this,arguments),hc){if(hc){var u=_h;hc=!1,_h=null}else throw Error(V(198));bh||(bh=!0,qg=u)}}function qa(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function M2(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function i_(t){if(qa(t)!==t)throw Error(V(188))}function x5(t){var e=t.alternate;if(!e){if(e=qa(t),e===null)throw Error(V(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return i_(s),t;if(i===r)return i_(s),e;i=i.sibling}throw Error(V(188))}if(n.return!==r.return)n=s,r=i;else{for(var a=!1,l=s.child;l;){if(l===n){a=!0,n=s,r=i;break}if(l===r){a=!0,r=s,n=i;break}l=l.sibling}if(!a){for(l=i.child;l;){if(l===n){a=!0,n=i,r=s;break}if(l===r){a=!0,r=i,n=s;break}l=l.sibling}if(!a)throw Error(V(189))}}if(n.alternate!==r)throw Error(V(190))}if(n.tag!==3)throw Error(V(188));return n.stateNode.current===n?t:e}function O2(t){return t=x5(t),t!==null?$2(t):null}function $2(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=$2(t);if(e!==null)return e;t=t.sibling}return null}var B2=Jn.unstable_scheduleCallback,a_=Jn.unstable_cancelCallback,y5=Jn.unstable_shouldYield,v5=Jn.unstable_requestPaint,mt=Jn.unstable_now,w5=Jn.unstable_getCurrentPriorityLevel,qx=Jn.unstable_ImmediatePriority,z2=Jn.unstable_UserBlockingPriority,Sh=Jn.unstable_NormalPriority,_5=Jn.unstable_LowPriority,U2=Jn.unstable_IdlePriority,Pf=null,ns=null;function b5(t){if(ns&&typeof ns.onCommitFiberRoot=="function")try{ns.onCommitFiberRoot(Pf,t,void 0,(t.current.flags&128)===128)}catch{}}var Lr=Math.clz32?Math.clz32:k5,S5=Math.log,E5=Math.LN2;function k5(t){return t>>>=0,t===0?32:31-(S5(t)/E5|0)|0}var pd=64,gd=4194304;function rc(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Eh(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,a=n&268435455;if(a!==0){var l=a&~s;l!==0?r=rc(l):(i&=a,i!==0&&(r=rc(i)))}else a=n&~s,a!==0?r=rc(a):i!==0&&(r=rc(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Lr(e),s=1<<n,r|=t[n],e&=~s;return r}function T5(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function I5(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var a=31-Lr(i),l=1<<a,c=s[a];c===-1?(!(l&n)||l&r)&&(s[a]=T5(l,e)):c<=e&&(t.expiredLanes|=l),i&=~l}}function Gg(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function V2(){var t=pd;return pd<<=1,!(pd&4194240)&&(pd=64),t}function vp(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function mu(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Lr(e),t[e]=n}function C5(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-Lr(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function Gx(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Lr(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var Le=0;function H2(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var W2,Qx,q2,G2,Q2,Qg=!1,xd=[],Ei=null,ki=null,Ti=null,jc=new Map,Rc=new Map,fi=[],j5="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function o_(t,e){switch(t){case"focusin":case"focusout":Ei=null;break;case"dragenter":case"dragleave":ki=null;break;case"mouseover":case"mouseout":Ti=null;break;case"pointerover":case"pointerout":jc.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Rc.delete(e.pointerId)}}function Vl(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=gu(e),e!==null&&Qx(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function R5(t,e,n,r,s){switch(e){case"focusin":return Ei=Vl(Ei,t,e,n,r,s),!0;case"dragenter":return ki=Vl(ki,t,e,n,r,s),!0;case"mouseover":return Ti=Vl(Ti,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return jc.set(i,Vl(jc.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Rc.set(i,Vl(Rc.get(i)||null,t,e,n,r,s)),!0}return!1}function K2(t){var e=pa(t.target);if(e!==null){var n=qa(e);if(n!==null){if(e=n.tag,e===13){if(e=M2(n),e!==null){t.blockedOn=e,Q2(t.priority,function(){q2(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Qd(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Kg(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Vg=r,n.target.dispatchEvent(r),Vg=null}else return e=gu(n),e!==null&&Qx(e),t.blockedOn=n,!1;e.shift()}return!0}function l_(t,e,n){Qd(t)&&n.delete(e)}function A5(){Qg=!1,Ei!==null&&Qd(Ei)&&(Ei=null),ki!==null&&Qd(ki)&&(ki=null),Ti!==null&&Qd(Ti)&&(Ti=null),jc.forEach(l_),Rc.forEach(l_)}function Hl(t,e){t.blockedOn===e&&(t.blockedOn=null,Qg||(Qg=!0,Jn.unstable_scheduleCallback(Jn.unstable_NormalPriority,A5)))}function Ac(t){function e(s){return Hl(s,t)}if(0<xd.length){Hl(xd[0],t);for(var n=1;n<xd.length;n++){var r=xd[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Ei!==null&&Hl(Ei,t),ki!==null&&Hl(ki,t),Ti!==null&&Hl(Ti,t),jc.forEach(e),Rc.forEach(e),n=0;n<fi.length;n++)r=fi[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<fi.length&&(n=fi[0],n.blockedOn===null);)K2(n),n.blockedOn===null&&fi.shift()}var No=Ks.ReactCurrentBatchConfig,kh=!0;function N5(t,e,n,r){var s=Le,i=No.transition;No.transition=null;try{Le=1,Kx(t,e,n,r)}finally{Le=s,No.transition=i}}function P5(t,e,n,r){var s=Le,i=No.transition;No.transition=null;try{Le=4,Kx(t,e,n,r)}finally{Le=s,No.transition=i}}function Kx(t,e,n,r){if(kh){var s=Kg(t,e,n,r);if(s===null)jp(t,e,r,Th,n),o_(t,r);else if(R5(s,t,e,n,r))r.stopPropagation();else if(o_(t,r),e&4&&-1<j5.indexOf(t)){for(;s!==null;){var i=gu(s);if(i!==null&&W2(i),i=Kg(t,e,n,r),i===null&&jp(t,e,r,Th,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else jp(t,e,r,null,n)}}var Th=null;function Kg(t,e,n,r){if(Th=null,t=Wx(r),t=pa(t),t!==null)if(e=qa(t),e===null)t=null;else if(n=e.tag,n===13){if(t=M2(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Th=t,null}function X2(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(w5()){case qx:return 1;case z2:return 4;case Sh:case _5:return 16;case U2:return 536870912;default:return 16}default:return 16}}var wi=null,Xx=null,Kd=null;function Y2(){if(Kd)return Kd;var t,e=Xx,n=e.length,r,s="value"in wi?wi.value:wi.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var a=n-t;for(r=1;r<=a&&e[n-r]===s[i-r];r++);return Kd=s.slice(t,1<r?1-r:void 0)}function Xd(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function yd(){return!0}function c_(){return!1}function nr(t){function e(n,r,s,i,a){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?yd:c_,this.isPropagationStopped=c_,this}return st(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=yd)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=yd)},persist:function(){},isPersistent:yd}),e}var sl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Yx=nr(sl),pu=st({},sl,{view:0,detail:0}),F5=nr(pu),wp,_p,Wl,Ff=st({},pu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Jx,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Wl&&(Wl&&t.type==="mousemove"?(wp=t.screenX-Wl.screenX,_p=t.screenY-Wl.screenY):_p=wp=0,Wl=t),wp)},movementY:function(t){return"movementY"in t?t.movementY:_p}}),u_=nr(Ff),D5=st({},Ff,{dataTransfer:0}),L5=nr(D5),M5=st({},pu,{relatedTarget:0}),bp=nr(M5),O5=st({},sl,{animationName:0,elapsedTime:0,pseudoElement:0}),$5=nr(O5),B5=st({},sl,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),z5=nr(B5),U5=st({},sl,{data:0}),d_=nr(U5),V5={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},H5={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},W5={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function q5(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=W5[t])?!!e[t]:!1}function Jx(){return q5}var G5=st({},pu,{key:function(t){if(t.key){var e=V5[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Xd(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?H5[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Jx,charCode:function(t){return t.type==="keypress"?Xd(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Xd(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),Q5=nr(G5),K5=st({},Ff,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),h_=nr(K5),X5=st({},pu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Jx}),Y5=nr(X5),J5=st({},sl,{propertyName:0,elapsedTime:0,pseudoElement:0}),Z5=nr(J5),eP=st({},Ff,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),tP=nr(eP),nP=[9,13,27,32],Zx=Ls&&"CompositionEvent"in window,fc=null;Ls&&"documentMode"in document&&(fc=document.documentMode);var rP=Ls&&"TextEvent"in window&&!fc,J2=Ls&&(!Zx||fc&&8<fc&&11>=fc),f_=String.fromCharCode(32),m_=!1;function Z2(t,e){switch(t){case"keyup":return nP.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ek(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var xo=!1;function sP(t,e){switch(t){case"compositionend":return ek(e);case"keypress":return e.which!==32?null:(m_=!0,f_);case"textInput":return t=e.data,t===f_&&m_?null:t;default:return null}}function iP(t,e){if(xo)return t==="compositionend"||!Zx&&Z2(t,e)?(t=Y2(),Kd=Xx=wi=null,xo=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return J2&&e.locale!=="ko"?null:e.data;default:return null}}var aP={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function p_(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!aP[t.type]:e==="textarea"}function tk(t,e,n,r){N2(r),e=Ih(e,"onChange"),0<e.length&&(n=new Yx("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var mc=null,Nc=null;function oP(t){hk(t,0)}function Df(t){var e=wo(t);if(k2(e))return t}function lP(t,e){if(t==="change")return e}var nk=!1;if(Ls){var Sp;if(Ls){var Ep="oninput"in document;if(!Ep){var g_=document.createElement("div");g_.setAttribute("oninput","return;"),Ep=typeof g_.oninput=="function"}Sp=Ep}else Sp=!1;nk=Sp&&(!document.documentMode||9<document.documentMode)}function x_(){mc&&(mc.detachEvent("onpropertychange",rk),Nc=mc=null)}function rk(t){if(t.propertyName==="value"&&Df(Nc)){var e=[];tk(e,Nc,t,Wx(t)),L2(oP,e)}}function cP(t,e,n){t==="focusin"?(x_(),mc=e,Nc=n,mc.attachEvent("onpropertychange",rk)):t==="focusout"&&x_()}function uP(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Df(Nc)}function dP(t,e){if(t==="click")return Df(e)}function hP(t,e){if(t==="input"||t==="change")return Df(e)}function fP(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Br=typeof Object.is=="function"?Object.is:fP;function Pc(t,e){if(Br(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Ag.call(e,s)||!Br(t[s],e[s]))return!1}return!0}function y_(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function v_(t,e){var n=y_(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=y_(n)}}function sk(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?sk(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function ik(){for(var t=window,e=wh();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=wh(t.document)}return e}function ey(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function mP(t){var e=ik(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&sk(n.ownerDocument.documentElement,n)){if(r!==null&&ey(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=v_(n,i);var a=v_(n,r);s&&a&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var pP=Ls&&"documentMode"in document&&11>=document.documentMode,yo=null,Xg=null,pc=null,Yg=!1;function w_(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Yg||yo==null||yo!==wh(r)||(r=yo,"selectionStart"in r&&ey(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),pc&&Pc(pc,r)||(pc=r,r=Ih(Xg,"onSelect"),0<r.length&&(e=new Yx("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=yo)))}function vd(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var vo={animationend:vd("Animation","AnimationEnd"),animationiteration:vd("Animation","AnimationIteration"),animationstart:vd("Animation","AnimationStart"),transitionend:vd("Transition","TransitionEnd")},kp={},ak={};Ls&&(ak=document.createElement("div").style,"AnimationEvent"in window||(delete vo.animationend.animation,delete vo.animationiteration.animation,delete vo.animationstart.animation),"TransitionEvent"in window||delete vo.transitionend.transition);function Lf(t){if(kp[t])return kp[t];if(!vo[t])return t;var e=vo[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in ak)return kp[t]=e[n];return t}var ok=Lf("animationend"),lk=Lf("animationiteration"),ck=Lf("animationstart"),uk=Lf("transitionend"),dk=new Map,__="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Vi(t,e){dk.set(t,e),Wa(e,[t])}for(var Tp=0;Tp<__.length;Tp++){var Ip=__[Tp],gP=Ip.toLowerCase(),xP=Ip[0].toUpperCase()+Ip.slice(1);Vi(gP,"on"+xP)}Vi(ok,"onAnimationEnd");Vi(lk,"onAnimationIteration");Vi(ck,"onAnimationStart");Vi("dblclick","onDoubleClick");Vi("focusin","onFocus");Vi("focusout","onBlur");Vi(uk,"onTransitionEnd");$o("onMouseEnter",["mouseout","mouseover"]);$o("onMouseLeave",["mouseout","mouseover"]);$o("onPointerEnter",["pointerout","pointerover"]);$o("onPointerLeave",["pointerout","pointerover"]);Wa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Wa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Wa("onBeforeInput",["compositionend","keypress","textInput","paste"]);Wa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Wa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Wa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var sc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),yP=new Set("cancel close invalid load scroll toggle".split(" ").concat(sc));function b_(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,g5(r,e,void 0,t),t.currentTarget=null}function hk(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var a=r.length-1;0<=a;a--){var l=r[a],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==i&&s.isPropagationStopped())break e;b_(s,l,u),i=c}else for(a=0;a<r.length;a++){if(l=r[a],c=l.instance,u=l.currentTarget,l=l.listener,c!==i&&s.isPropagationStopped())break e;b_(s,l,u),i=c}}}if(bh)throw t=qg,bh=!1,qg=null,t}function qe(t,e){var n=e[n0];n===void 0&&(n=e[n0]=new Set);var r=t+"__bubble";n.has(r)||(fk(e,t,2,!1),n.add(r))}function Cp(t,e,n){var r=0;e&&(r|=4),fk(n,t,r,e)}var wd="_reactListening"+Math.random().toString(36).slice(2);function Fc(t){if(!t[wd]){t[wd]=!0,w2.forEach(function(n){n!=="selectionchange"&&(yP.has(n)||Cp(n,!1,t),Cp(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[wd]||(e[wd]=!0,Cp("selectionchange",!1,e))}}function fk(t,e,n,r){switch(X2(e)){case 1:var s=N5;break;case 4:s=P5;break;default:s=Kx}n=s.bind(null,e,n,t),s=void 0,!Wg||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function jp(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(a===4)for(a=r.return;a!==null;){var c=a.tag;if((c===3||c===4)&&(c=a.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;a=a.return}for(;l!==null;){if(a=pa(l),a===null)return;if(c=a.tag,c===5||c===6){r=i=a;continue e}l=l.parentNode}}r=r.return}L2(function(){var u=i,d=Wx(n),f=[];e:{var p=dk.get(t);if(p!==void 0){var g=Yx,v=t;switch(t){case"keypress":if(Xd(n)===0)break e;case"keydown":case"keyup":g=Q5;break;case"focusin":v="focus",g=bp;break;case"focusout":v="blur",g=bp;break;case"beforeblur":case"afterblur":g=bp;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=u_;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=L5;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=Y5;break;case ok:case lk:case ck:g=$5;break;case uk:g=Z5;break;case"scroll":g=F5;break;case"wheel":g=tP;break;case"copy":case"cut":case"paste":g=z5;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=h_}var _=(e&4)!==0,b=!_&&t==="scroll",E=_?p!==null?p+"Capture":null:p;_=[];for(var w=u,S;w!==null;){S=w;var I=S.stateNode;if(S.tag===5&&I!==null&&(S=I,E!==null&&(I=Cc(w,E),I!=null&&_.push(Dc(w,I,S)))),b)break;w=w.return}0<_.length&&(p=new g(p,v,null,n,d),f.push({event:p,listeners:_}))}}if(!(e&7)){e:{if(p=t==="mouseover"||t==="pointerover",g=t==="mouseout"||t==="pointerout",p&&n!==Vg&&(v=n.relatedTarget||n.fromElement)&&(pa(v)||v[Ms]))break e;if((g||p)&&(p=d.window===d?d:(p=d.ownerDocument)?p.defaultView||p.parentWindow:window,g?(v=n.relatedTarget||n.toElement,g=u,v=v?pa(v):null,v!==null&&(b=qa(v),v!==b||v.tag!==5&&v.tag!==6)&&(v=null)):(g=null,v=u),g!==v)){if(_=u_,I="onMouseLeave",E="onMouseEnter",w="mouse",(t==="pointerout"||t==="pointerover")&&(_=h_,I="onPointerLeave",E="onPointerEnter",w="pointer"),b=g==null?p:wo(g),S=v==null?p:wo(v),p=new _(I,w+"leave",g,n,d),p.target=b,p.relatedTarget=S,I=null,pa(d)===u&&(_=new _(E,w+"enter",v,n,d),_.target=S,_.relatedTarget=b,I=_),b=I,g&&v)t:{for(_=g,E=v,w=0,S=_;S;S=io(S))w++;for(S=0,I=E;I;I=io(I))S++;for(;0<w-S;)_=io(_),w--;for(;0<S-w;)E=io(E),S--;for(;w--;){if(_===E||E!==null&&_===E.alternate)break t;_=io(_),E=io(E)}_=null}else _=null;g!==null&&S_(f,p,g,_,!1),v!==null&&b!==null&&S_(f,b,v,_,!0)}}e:{if(p=u?wo(u):window,g=p.nodeName&&p.nodeName.toLowerCase(),g==="select"||g==="input"&&p.type==="file")var F=lP;else if(p_(p))if(nk)F=hP;else{F=uP;var D=cP}else(g=p.nodeName)&&g.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(F=dP);if(F&&(F=F(t,u))){tk(f,F,n,d);break e}D&&D(t,p,u),t==="focusout"&&(D=p._wrapperState)&&D.controlled&&p.type==="number"&&Og(p,"number",p.value)}switch(D=u?wo(u):window,t){case"focusin":(p_(D)||D.contentEditable==="true")&&(yo=D,Xg=u,pc=null);break;case"focusout":pc=Xg=yo=null;break;case"mousedown":Yg=!0;break;case"contextmenu":case"mouseup":case"dragend":Yg=!1,w_(f,n,d);break;case"selectionchange":if(pP)break;case"keydown":case"keyup":w_(f,n,d)}var C;if(Zx)e:{switch(t){case"compositionstart":var k="onCompositionStart";break e;case"compositionend":k="onCompositionEnd";break e;case"compositionupdate":k="onCompositionUpdate";break e}k=void 0}else xo?Z2(t,n)&&(k="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(k="onCompositionStart");k&&(J2&&n.locale!=="ko"&&(xo||k!=="onCompositionStart"?k==="onCompositionEnd"&&xo&&(C=Y2()):(wi=d,Xx="value"in wi?wi.value:wi.textContent,xo=!0)),D=Ih(u,k),0<D.length&&(k=new d_(k,t,null,n,d),f.push({event:k,listeners:D}),C?k.data=C:(C=ek(n),C!==null&&(k.data=C)))),(C=rP?sP(t,n):iP(t,n))&&(u=Ih(u,"onBeforeInput"),0<u.length&&(d=new d_("onBeforeInput","beforeinput",null,n,d),f.push({event:d,listeners:u}),d.data=C))}hk(f,e)})}function Dc(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Ih(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Cc(t,n),i!=null&&r.unshift(Dc(t,i,s)),i=Cc(t,e),i!=null&&r.push(Dc(t,i,s))),t=t.return}return r}function io(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function S_(t,e,n,r,s){for(var i=e._reactName,a=[];n!==null&&n!==r;){var l=n,c=l.alternate,u=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&u!==null&&(l=u,s?(c=Cc(n,i),c!=null&&a.unshift(Dc(n,c,l))):s||(c=Cc(n,i),c!=null&&a.push(Dc(n,c,l)))),n=n.return}a.length!==0&&t.push({event:e,listeners:a})}var vP=/\r\n?/g,wP=/\u0000|\uFFFD/g;function E_(t){return(typeof t=="string"?t:""+t).replace(vP,`
`).replace(wP,"")}function _d(t,e,n){if(e=E_(e),E_(t)!==e&&n)throw Error(V(425))}function Ch(){}var Jg=null,Zg=null;function e0(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var t0=typeof setTimeout=="function"?setTimeout:void 0,_P=typeof clearTimeout=="function"?clearTimeout:void 0,k_=typeof Promise=="function"?Promise:void 0,bP=typeof queueMicrotask=="function"?queueMicrotask:typeof k_<"u"?function(t){return k_.resolve(null).then(t).catch(SP)}:t0;function SP(t){setTimeout(function(){throw t})}function Rp(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),Ac(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Ac(e)}function Ii(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function T_(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var il=Math.random().toString(36).slice(2),Zr="__reactFiber$"+il,Lc="__reactProps$"+il,Ms="__reactContainer$"+il,n0="__reactEvents$"+il,EP="__reactListeners$"+il,kP="__reactHandles$"+il;function pa(t){var e=t[Zr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Ms]||n[Zr]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=T_(t);t!==null;){if(n=t[Zr])return n;t=T_(t)}return e}t=n,n=t.parentNode}return null}function gu(t){return t=t[Zr]||t[Ms],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function wo(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(V(33))}function Mf(t){return t[Lc]||null}var r0=[],_o=-1;function Hi(t){return{current:t}}function Qe(t){0>_o||(t.current=r0[_o],r0[_o]=null,_o--)}function Ve(t,e){_o++,r0[_o]=t.current,t.current=e}var Mi={},sn=Hi(Mi),Cn=Hi(!1),Ta=Mi;function Bo(t,e){var n=t.type.contextTypes;if(!n)return Mi;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function jn(t){return t=t.childContextTypes,t!=null}function jh(){Qe(Cn),Qe(sn)}function I_(t,e,n){if(sn.current!==Mi)throw Error(V(168));Ve(sn,e),Ve(Cn,n)}function mk(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(V(108,c5(t)||"Unknown",s));return st({},n,r)}function Rh(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Mi,Ta=sn.current,Ve(sn,t),Ve(Cn,Cn.current),!0}function C_(t,e,n){var r=t.stateNode;if(!r)throw Error(V(169));n?(t=mk(t,e,Ta),r.__reactInternalMemoizedMergedChildContext=t,Qe(Cn),Qe(sn),Ve(sn,t)):Qe(Cn),Ve(Cn,n)}var Es=null,Of=!1,Ap=!1;function pk(t){Es===null?Es=[t]:Es.push(t)}function TP(t){Of=!0,pk(t)}function Wi(){if(!Ap&&Es!==null){Ap=!0;var t=0,e=Le;try{var n=Es;for(Le=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Es=null,Of=!1}catch(s){throw Es!==null&&(Es=Es.slice(t+1)),B2(qx,Wi),s}finally{Le=e,Ap=!1}}return null}var bo=[],So=0,Ah=null,Nh=0,cr=[],ur=0,Ia=null,Ts=1,Is="";function ca(t,e){bo[So++]=Nh,bo[So++]=Ah,Ah=t,Nh=e}function gk(t,e,n){cr[ur++]=Ts,cr[ur++]=Is,cr[ur++]=Ia,Ia=t;var r=Ts;t=Is;var s=32-Lr(r)-1;r&=~(1<<s),n+=1;var i=32-Lr(e)+s;if(30<i){var a=s-s%5;i=(r&(1<<a)-1).toString(32),r>>=a,s-=a,Ts=1<<32-Lr(e)+s|n<<s|r,Is=i+t}else Ts=1<<i|n<<s|r,Is=t}function ty(t){t.return!==null&&(ca(t,1),gk(t,1,0))}function ny(t){for(;t===Ah;)Ah=bo[--So],bo[So]=null,Nh=bo[--So],bo[So]=null;for(;t===Ia;)Ia=cr[--ur],cr[ur]=null,Is=cr[--ur],cr[ur]=null,Ts=cr[--ur],cr[ur]=null}var Kn=null,Wn=null,Je=!1,Nr=null;function xk(t,e){var n=dr(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function j_(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Kn=t,Wn=Ii(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Kn=t,Wn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Ia!==null?{id:Ts,overflow:Is}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=dr(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Kn=t,Wn=null,!0):!1;default:return!1}}function s0(t){return(t.mode&1)!==0&&(t.flags&128)===0}function i0(t){if(Je){var e=Wn;if(e){var n=e;if(!j_(t,e)){if(s0(t))throw Error(V(418));e=Ii(n.nextSibling);var r=Kn;e&&j_(t,e)?xk(r,n):(t.flags=t.flags&-4097|2,Je=!1,Kn=t)}}else{if(s0(t))throw Error(V(418));t.flags=t.flags&-4097|2,Je=!1,Kn=t}}}function R_(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Kn=t}function bd(t){if(t!==Kn)return!1;if(!Je)return R_(t),Je=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!e0(t.type,t.memoizedProps)),e&&(e=Wn)){if(s0(t))throw yk(),Error(V(418));for(;e;)xk(t,e),e=Ii(e.nextSibling)}if(R_(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(V(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Wn=Ii(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Wn=null}}else Wn=Kn?Ii(t.stateNode.nextSibling):null;return!0}function yk(){for(var t=Wn;t;)t=Ii(t.nextSibling)}function zo(){Wn=Kn=null,Je=!1}function ry(t){Nr===null?Nr=[t]:Nr.push(t)}var IP=Ks.ReactCurrentBatchConfig;function Rr(t,e){if(t&&t.defaultProps){e=st({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var Ph=Hi(null),Fh=null,Eo=null,sy=null;function iy(){sy=Eo=Fh=null}function ay(t){var e=Ph.current;Qe(Ph),t._currentValue=e}function a0(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Po(t,e){Fh=t,sy=Eo=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(In=!0),t.firstContext=null)}function fr(t){var e=t._currentValue;if(sy!==t)if(t={context:t,memoizedValue:e,next:null},Eo===null){if(Fh===null)throw Error(V(308));Eo=t,Fh.dependencies={lanes:0,firstContext:t}}else Eo=Eo.next=t;return e}var ga=null;function oy(t){ga===null?ga=[t]:ga.push(t)}function vk(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,oy(e)):(n.next=s.next,s.next=n),e.interleaved=n,Os(t,r)}function Os(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var hi=!1;function ly(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function wk(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Ps(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Ci(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Re&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,Os(t,n)}return s=r.interleaved,s===null?(e.next=e,oy(r)):(e.next=s.next,s.next=e),r.interleaved=e,Os(t,n)}function Yd(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Gx(t,n)}}function A_(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=a:i=i.next=a,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Dh(t,e,n,r){var s=t.updateQueue;hi=!1;var i=s.firstBaseUpdate,a=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,u=c.next;c.next=null,a===null?i=u:a.next=u,a=c;var d=t.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==a&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(i!==null){var f=s.baseState;a=0,d=u=c=null,l=i;do{var p=l.lane,g=l.eventTime;if((r&p)===p){d!==null&&(d=d.next={eventTime:g,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var v=t,_=l;switch(p=e,g=n,_.tag){case 1:if(v=_.payload,typeof v=="function"){f=v.call(g,f,p);break e}f=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=_.payload,p=typeof v=="function"?v.call(g,f,p):v,p==null)break e;f=st({},f,p);break e;case 2:hi=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,p=s.effects,p===null?s.effects=[l]:p.push(l))}else g={eventTime:g,lane:p,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=g,c=f):d=d.next=g,a|=p;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;p=l,l=p.next,p.next=null,s.lastBaseUpdate=p,s.shared.pending=null}}while(1);if(d===null&&(c=f),s.baseState=c,s.firstBaseUpdate=u,s.lastBaseUpdate=d,e=s.shared.interleaved,e!==null){s=e;do a|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);ja|=a,t.lanes=a,t.memoizedState=f}}function N_(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(V(191,s));s.call(r)}}}var _k=new v2.Component().refs;function o0(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:st({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var $f={isMounted:function(t){return(t=t._reactInternals)?qa(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=pn(),s=Ri(t),i=Ps(r,s);i.payload=e,n!=null&&(i.callback=n),e=Ci(t,i,s),e!==null&&(Mr(e,t,s,r),Yd(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=pn(),s=Ri(t),i=Ps(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=Ci(t,i,s),e!==null&&(Mr(e,t,s,r),Yd(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=pn(),r=Ri(t),s=Ps(n,r);s.tag=2,e!=null&&(s.callback=e),e=Ci(t,s,r),e!==null&&(Mr(e,t,r,n),Yd(e,t,r))}};function P_(t,e,n,r,s,i,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,a):e.prototype&&e.prototype.isPureReactComponent?!Pc(n,r)||!Pc(s,i):!0}function bk(t,e,n){var r=!1,s=Mi,i=e.contextType;return typeof i=="object"&&i!==null?i=fr(i):(s=jn(e)?Ta:sn.current,r=e.contextTypes,i=(r=r!=null)?Bo(t,s):Mi),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=$f,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function F_(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&$f.enqueueReplaceState(e,e.state,null)}function l0(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs=_k,ly(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=fr(i):(i=jn(e)?Ta:sn.current,s.context=Bo(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(o0(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&$f.enqueueReplaceState(s,s.state,null),Dh(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function ql(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(V(309));var r=n.stateNode}if(!r)throw Error(V(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(a){var l=s.refs;l===_k&&(l=s.refs={}),a===null?delete l[i]:l[i]=a},e._stringRef=i,e)}if(typeof t!="string")throw Error(V(284));if(!n._owner)throw Error(V(290,t))}return t}function Sd(t,e){throw t=Object.prototype.toString.call(e),Error(V(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function D_(t){var e=t._init;return e(t._payload)}function Sk(t){function e(E,w){if(t){var S=E.deletions;S===null?(E.deletions=[w],E.flags|=16):S.push(w)}}function n(E,w){if(!t)return null;for(;w!==null;)e(E,w),w=w.sibling;return null}function r(E,w){for(E=new Map;w!==null;)w.key!==null?E.set(w.key,w):E.set(w.index,w),w=w.sibling;return E}function s(E,w){return E=Ai(E,w),E.index=0,E.sibling=null,E}function i(E,w,S){return E.index=S,t?(S=E.alternate,S!==null?(S=S.index,S<w?(E.flags|=2,w):S):(E.flags|=2,w)):(E.flags|=1048576,w)}function a(E){return t&&E.alternate===null&&(E.flags|=2),E}function l(E,w,S,I){return w===null||w.tag!==6?(w=Op(S,E.mode,I),w.return=E,w):(w=s(w,S),w.return=E,w)}function c(E,w,S,I){var F=S.type;return F===go?d(E,w,S.props.children,I,S.key):w!==null&&(w.elementType===F||typeof F=="object"&&F!==null&&F.$$typeof===di&&D_(F)===w.type)?(I=s(w,S.props),I.ref=ql(E,w,S),I.return=E,I):(I=rh(S.type,S.key,S.props,null,E.mode,I),I.ref=ql(E,w,S),I.return=E,I)}function u(E,w,S,I){return w===null||w.tag!==4||w.stateNode.containerInfo!==S.containerInfo||w.stateNode.implementation!==S.implementation?(w=$p(S,E.mode,I),w.return=E,w):(w=s(w,S.children||[]),w.return=E,w)}function d(E,w,S,I,F){return w===null||w.tag!==7?(w=ba(S,E.mode,I,F),w.return=E,w):(w=s(w,S),w.return=E,w)}function f(E,w,S){if(typeof w=="string"&&w!==""||typeof w=="number")return w=Op(""+w,E.mode,S),w.return=E,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case hd:return S=rh(w.type,w.key,w.props,null,E.mode,S),S.ref=ql(E,null,w),S.return=E,S;case po:return w=$p(w,E.mode,S),w.return=E,w;case di:var I=w._init;return f(E,I(w._payload),S)}if(nc(w)||zl(w))return w=ba(w,E.mode,S,null),w.return=E,w;Sd(E,w)}return null}function p(E,w,S,I){var F=w!==null?w.key:null;if(typeof S=="string"&&S!==""||typeof S=="number")return F!==null?null:l(E,w,""+S,I);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case hd:return S.key===F?c(E,w,S,I):null;case po:return S.key===F?u(E,w,S,I):null;case di:return F=S._init,p(E,w,F(S._payload),I)}if(nc(S)||zl(S))return F!==null?null:d(E,w,S,I,null);Sd(E,S)}return null}function g(E,w,S,I,F){if(typeof I=="string"&&I!==""||typeof I=="number")return E=E.get(S)||null,l(w,E,""+I,F);if(typeof I=="object"&&I!==null){switch(I.$$typeof){case hd:return E=E.get(I.key===null?S:I.key)||null,c(w,E,I,F);case po:return E=E.get(I.key===null?S:I.key)||null,u(w,E,I,F);case di:var D=I._init;return g(E,w,S,D(I._payload),F)}if(nc(I)||zl(I))return E=E.get(S)||null,d(w,E,I,F,null);Sd(w,I)}return null}function v(E,w,S,I){for(var F=null,D=null,C=w,k=w=0,R=null;C!==null&&k<S.length;k++){C.index>k?(R=C,C=null):R=C.sibling;var j=p(E,C,S[k],I);if(j===null){C===null&&(C=R);break}t&&C&&j.alternate===null&&e(E,C),w=i(j,w,k),D===null?F=j:D.sibling=j,D=j,C=R}if(k===S.length)return n(E,C),Je&&ca(E,k),F;if(C===null){for(;k<S.length;k++)C=f(E,S[k],I),C!==null&&(w=i(C,w,k),D===null?F=C:D.sibling=C,D=C);return Je&&ca(E,k),F}for(C=r(E,C);k<S.length;k++)R=g(C,E,k,S[k],I),R!==null&&(t&&R.alternate!==null&&C.delete(R.key===null?k:R.key),w=i(R,w,k),D===null?F=R:D.sibling=R,D=R);return t&&C.forEach(function(N){return e(E,N)}),Je&&ca(E,k),F}function _(E,w,S,I){var F=zl(S);if(typeof F!="function")throw Error(V(150));if(S=F.call(S),S==null)throw Error(V(151));for(var D=F=null,C=w,k=w=0,R=null,j=S.next();C!==null&&!j.done;k++,j=S.next()){C.index>k?(R=C,C=null):R=C.sibling;var N=p(E,C,j.value,I);if(N===null){C===null&&(C=R);break}t&&C&&N.alternate===null&&e(E,C),w=i(N,w,k),D===null?F=N:D.sibling=N,D=N,C=R}if(j.done)return n(E,C),Je&&ca(E,k),F;if(C===null){for(;!j.done;k++,j=S.next())j=f(E,j.value,I),j!==null&&(w=i(j,w,k),D===null?F=j:D.sibling=j,D=j);return Je&&ca(E,k),F}for(C=r(E,C);!j.done;k++,j=S.next())j=g(C,E,k,j.value,I),j!==null&&(t&&j.alternate!==null&&C.delete(j.key===null?k:j.key),w=i(j,w,k),D===null?F=j:D.sibling=j,D=j);return t&&C.forEach(function(P){return e(E,P)}),Je&&ca(E,k),F}function b(E,w,S,I){if(typeof S=="object"&&S!==null&&S.type===go&&S.key===null&&(S=S.props.children),typeof S=="object"&&S!==null){switch(S.$$typeof){case hd:e:{for(var F=S.key,D=w;D!==null;){if(D.key===F){if(F=S.type,F===go){if(D.tag===7){n(E,D.sibling),w=s(D,S.props.children),w.return=E,E=w;break e}}else if(D.elementType===F||typeof F=="object"&&F!==null&&F.$$typeof===di&&D_(F)===D.type){n(E,D.sibling),w=s(D,S.props),w.ref=ql(E,D,S),w.return=E,E=w;break e}n(E,D);break}else e(E,D);D=D.sibling}S.type===go?(w=ba(S.props.children,E.mode,I,S.key),w.return=E,E=w):(I=rh(S.type,S.key,S.props,null,E.mode,I),I.ref=ql(E,w,S),I.return=E,E=I)}return a(E);case po:e:{for(D=S.key;w!==null;){if(w.key===D)if(w.tag===4&&w.stateNode.containerInfo===S.containerInfo&&w.stateNode.implementation===S.implementation){n(E,w.sibling),w=s(w,S.children||[]),w.return=E,E=w;break e}else{n(E,w);break}else e(E,w);w=w.sibling}w=$p(S,E.mode,I),w.return=E,E=w}return a(E);case di:return D=S._init,b(E,w,D(S._payload),I)}if(nc(S))return v(E,w,S,I);if(zl(S))return _(E,w,S,I);Sd(E,S)}return typeof S=="string"&&S!==""||typeof S=="number"?(S=""+S,w!==null&&w.tag===6?(n(E,w.sibling),w=s(w,S),w.return=E,E=w):(n(E,w),w=Op(S,E.mode,I),w.return=E,E=w),a(E)):n(E,w)}return b}var Uo=Sk(!0),Ek=Sk(!1),xu={},rs=Hi(xu),Mc=Hi(xu),Oc=Hi(xu);function xa(t){if(t===xu)throw Error(V(174));return t}function cy(t,e){switch(Ve(Oc,e),Ve(Mc,t),Ve(rs,xu),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Bg(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Bg(e,t)}Qe(rs),Ve(rs,e)}function Vo(){Qe(rs),Qe(Mc),Qe(Oc)}function kk(t){xa(Oc.current);var e=xa(rs.current),n=Bg(e,t.type);e!==n&&(Ve(Mc,t),Ve(rs,n))}function uy(t){Mc.current===t&&(Qe(rs),Qe(Mc))}var nt=Hi(0);function Lh(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Np=[];function dy(){for(var t=0;t<Np.length;t++)Np[t]._workInProgressVersionPrimary=null;Np.length=0}var Jd=Ks.ReactCurrentDispatcher,Pp=Ks.ReactCurrentBatchConfig,Ca=0,rt=null,Et=null,Rt=null,Mh=!1,gc=!1,$c=0,CP=0;function Xt(){throw Error(V(321))}function hy(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Br(t[n],e[n]))return!1;return!0}function fy(t,e,n,r,s,i){if(Ca=i,rt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Jd.current=t===null||t.memoizedState===null?NP:PP,t=n(r,s),gc){i=0;do{if(gc=!1,$c=0,25<=i)throw Error(V(301));i+=1,Rt=Et=null,e.updateQueue=null,Jd.current=FP,t=n(r,s)}while(gc)}if(Jd.current=Oh,e=Et!==null&&Et.next!==null,Ca=0,Rt=Et=rt=null,Mh=!1,e)throw Error(V(300));return t}function my(){var t=$c!==0;return $c=0,t}function Yr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Rt===null?rt.memoizedState=Rt=t:Rt=Rt.next=t,Rt}function mr(){if(Et===null){var t=rt.alternate;t=t!==null?t.memoizedState:null}else t=Et.next;var e=Rt===null?rt.memoizedState:Rt.next;if(e!==null)Rt=e,Et=t;else{if(t===null)throw Error(V(310));Et=t,t={memoizedState:Et.memoizedState,baseState:Et.baseState,baseQueue:Et.baseQueue,queue:Et.queue,next:null},Rt===null?rt.memoizedState=Rt=t:Rt=Rt.next=t}return Rt}function Bc(t,e){return typeof e=="function"?e(t):e}function Fp(t){var e=mr(),n=e.queue;if(n===null)throw Error(V(311));n.lastRenderedReducer=t;var r=Et,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var a=s.next;s.next=i.next,i.next=a}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=a=null,c=null,u=i;do{var d=u.lane;if((Ca&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var f={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=f,a=r):c=c.next=f,rt.lanes|=d,ja|=d}u=u.next}while(u!==null&&u!==i);c===null?a=r:c.next=l,Br(r,e.memoizedState)||(In=!0),e.memoizedState=r,e.baseState=a,e.baseQueue=c,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,rt.lanes|=i,ja|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Dp(t){var e=mr(),n=e.queue;if(n===null)throw Error(V(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var a=s=s.next;do i=t(i,a.action),a=a.next;while(a!==s);Br(i,e.memoizedState)||(In=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function Tk(){}function Ik(t,e){var n=rt,r=mr(),s=e(),i=!Br(r.memoizedState,s);if(i&&(r.memoizedState=s,In=!0),r=r.queue,py(Rk.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||Rt!==null&&Rt.memoizedState.tag&1){if(n.flags|=2048,zc(9,jk.bind(null,n,r,s,e),void 0,null),Nt===null)throw Error(V(349));Ca&30||Ck(n,e,s)}return s}function Ck(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=rt.updateQueue,e===null?(e={lastEffect:null,stores:null},rt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function jk(t,e,n,r){e.value=n,e.getSnapshot=r,Ak(e)&&Nk(t)}function Rk(t,e,n){return n(function(){Ak(e)&&Nk(t)})}function Ak(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Br(t,n)}catch{return!0}}function Nk(t){var e=Os(t,1);e!==null&&Mr(e,t,1,-1)}function L_(t){var e=Yr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Bc,lastRenderedState:t},e.queue=t,t=t.dispatch=AP.bind(null,rt,t),[e.memoizedState,t]}function zc(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=rt.updateQueue,e===null?(e={lastEffect:null,stores:null},rt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function Pk(){return mr().memoizedState}function Zd(t,e,n,r){var s=Yr();rt.flags|=t,s.memoizedState=zc(1|e,n,void 0,r===void 0?null:r)}function Bf(t,e,n,r){var s=mr();r=r===void 0?null:r;var i=void 0;if(Et!==null){var a=Et.memoizedState;if(i=a.destroy,r!==null&&hy(r,a.deps)){s.memoizedState=zc(e,n,i,r);return}}rt.flags|=t,s.memoizedState=zc(1|e,n,i,r)}function M_(t,e){return Zd(8390656,8,t,e)}function py(t,e){return Bf(2048,8,t,e)}function Fk(t,e){return Bf(4,2,t,e)}function Dk(t,e){return Bf(4,4,t,e)}function Lk(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Mk(t,e,n){return n=n!=null?n.concat([t]):null,Bf(4,4,Lk.bind(null,e,t),n)}function gy(){}function Ok(t,e){var n=mr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&hy(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function $k(t,e){var n=mr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&hy(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Bk(t,e,n){return Ca&21?(Br(n,e)||(n=V2(),rt.lanes|=n,ja|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,In=!0),t.memoizedState=n)}function jP(t,e){var n=Le;Le=n!==0&&4>n?n:4,t(!0);var r=Pp.transition;Pp.transition={};try{t(!1),e()}finally{Le=n,Pp.transition=r}}function zk(){return mr().memoizedState}function RP(t,e,n){var r=Ri(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Uk(t))Vk(e,n);else if(n=vk(t,e,n,r),n!==null){var s=pn();Mr(n,t,r,s),Hk(n,e,r)}}function AP(t,e,n){var r=Ri(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Uk(t))Vk(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var a=e.lastRenderedState,l=i(a,n);if(s.hasEagerState=!0,s.eagerState=l,Br(l,a)){var c=e.interleaved;c===null?(s.next=s,oy(e)):(s.next=c.next,c.next=s),e.interleaved=s;return}}catch{}finally{}n=vk(t,e,s,r),n!==null&&(s=pn(),Mr(n,t,r,s),Hk(n,e,r))}}function Uk(t){var e=t.alternate;return t===rt||e!==null&&e===rt}function Vk(t,e){gc=Mh=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function Hk(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Gx(t,n)}}var Oh={readContext:fr,useCallback:Xt,useContext:Xt,useEffect:Xt,useImperativeHandle:Xt,useInsertionEffect:Xt,useLayoutEffect:Xt,useMemo:Xt,useReducer:Xt,useRef:Xt,useState:Xt,useDebugValue:Xt,useDeferredValue:Xt,useTransition:Xt,useMutableSource:Xt,useSyncExternalStore:Xt,useId:Xt,unstable_isNewReconciler:!1},NP={readContext:fr,useCallback:function(t,e){return Yr().memoizedState=[t,e===void 0?null:e],t},useContext:fr,useEffect:M_,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Zd(4194308,4,Lk.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Zd(4194308,4,t,e)},useInsertionEffect:function(t,e){return Zd(4,2,t,e)},useMemo:function(t,e){var n=Yr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Yr();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=RP.bind(null,rt,t),[r.memoizedState,t]},useRef:function(t){var e=Yr();return t={current:t},e.memoizedState=t},useState:L_,useDebugValue:gy,useDeferredValue:function(t){return Yr().memoizedState=t},useTransition:function(){var t=L_(!1),e=t[0];return t=jP.bind(null,t[1]),Yr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=rt,s=Yr();if(Je){if(n===void 0)throw Error(V(407));n=n()}else{if(n=e(),Nt===null)throw Error(V(349));Ca&30||Ck(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,M_(Rk.bind(null,r,i,t),[t]),r.flags|=2048,zc(9,jk.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=Yr(),e=Nt.identifierPrefix;if(Je){var n=Is,r=Ts;n=(r&~(1<<32-Lr(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=$c++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=CP++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},PP={readContext:fr,useCallback:Ok,useContext:fr,useEffect:py,useImperativeHandle:Mk,useInsertionEffect:Fk,useLayoutEffect:Dk,useMemo:$k,useReducer:Fp,useRef:Pk,useState:function(){return Fp(Bc)},useDebugValue:gy,useDeferredValue:function(t){var e=mr();return Bk(e,Et.memoizedState,t)},useTransition:function(){var t=Fp(Bc)[0],e=mr().memoizedState;return[t,e]},useMutableSource:Tk,useSyncExternalStore:Ik,useId:zk,unstable_isNewReconciler:!1},FP={readContext:fr,useCallback:Ok,useContext:fr,useEffect:py,useImperativeHandle:Mk,useInsertionEffect:Fk,useLayoutEffect:Dk,useMemo:$k,useReducer:Dp,useRef:Pk,useState:function(){return Dp(Bc)},useDebugValue:gy,useDeferredValue:function(t){var e=mr();return Et===null?e.memoizedState=t:Bk(e,Et.memoizedState,t)},useTransition:function(){var t=Dp(Bc)[0],e=mr().memoizedState;return[t,e]},useMutableSource:Tk,useSyncExternalStore:Ik,useId:zk,unstable_isNewReconciler:!1};function Ho(t,e){try{var n="",r=e;do n+=l5(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function Lp(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function c0(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var DP=typeof WeakMap=="function"?WeakMap:Map;function Wk(t,e,n){n=Ps(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Bh||(Bh=!0,v0=r),c0(t,e)},n}function qk(t,e,n){n=Ps(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){c0(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){c0(t,e),typeof r!="function"&&(ji===null?ji=new Set([this]):ji.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),n}function O_(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new DP;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=KP.bind(null,t,e,n),e.then(t,t))}function $_(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function B_(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Ps(-1,1),e.tag=2,Ci(n,e,1))),n.lanes|=1),t)}var LP=Ks.ReactCurrentOwner,In=!1;function fn(t,e,n,r){e.child=t===null?Ek(e,null,n,r):Uo(e,t.child,n,r)}function z_(t,e,n,r,s){n=n.render;var i=e.ref;return Po(e,s),r=fy(t,e,n,r,i,s),n=my(),t!==null&&!In?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,$s(t,e,s)):(Je&&n&&ty(e),e.flags|=1,fn(t,e,r,s),e.child)}function U_(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!Ey(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,Gk(t,e,i,r,s)):(t=rh(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var a=i.memoizedProps;if(n=n.compare,n=n!==null?n:Pc,n(a,r)&&t.ref===e.ref)return $s(t,e,s)}return e.flags|=1,t=Ai(i,r),t.ref=e.ref,t.return=e,e.child=t}function Gk(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(Pc(i,r)&&t.ref===e.ref)if(In=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(In=!0);else return e.lanes=t.lanes,$s(t,e,s)}return u0(t,e,n,r,s)}function Qk(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ve(To,Vn),Vn|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Ve(To,Vn),Vn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Ve(To,Vn),Vn|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,Ve(To,Vn),Vn|=r;return fn(t,e,s,n),e.child}function Kk(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function u0(t,e,n,r,s){var i=jn(n)?Ta:sn.current;return i=Bo(e,i),Po(e,s),n=fy(t,e,n,r,i,s),r=my(),t!==null&&!In?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,$s(t,e,s)):(Je&&r&&ty(e),e.flags|=1,fn(t,e,n,s),e.child)}function V_(t,e,n,r,s){if(jn(n)){var i=!0;Rh(e)}else i=!1;if(Po(e,s),e.stateNode===null)eh(t,e),bk(e,n,r),l0(e,n,r,s),r=!0;else if(t===null){var a=e.stateNode,l=e.memoizedProps;a.props=l;var c=a.context,u=n.contextType;typeof u=="object"&&u!==null?u=fr(u):(u=jn(n)?Ta:sn.current,u=Bo(e,u));var d=n.getDerivedStateFromProps,f=typeof d=="function"||typeof a.getSnapshotBeforeUpdate=="function";f||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==r||c!==u)&&F_(e,a,r,u),hi=!1;var p=e.memoizedState;a.state=p,Dh(e,r,a,s),c=e.memoizedState,l!==r||p!==c||Cn.current||hi?(typeof d=="function"&&(o0(e,n,d,r),c=e.memoizedState),(l=hi||P_(e,n,l,r,p,c,u))?(f||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),a.props=r,a.state=c,a.context=u,r=l):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{a=e.stateNode,wk(t,e),l=e.memoizedProps,u=e.type===e.elementType?l:Rr(e.type,l),a.props=u,f=e.pendingProps,p=a.context,c=n.contextType,typeof c=="object"&&c!==null?c=fr(c):(c=jn(n)?Ta:sn.current,c=Bo(e,c));var g=n.getDerivedStateFromProps;(d=typeof g=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==f||p!==c)&&F_(e,a,r,c),hi=!1,p=e.memoizedState,a.state=p,Dh(e,r,a,s);var v=e.memoizedState;l!==f||p!==v||Cn.current||hi?(typeof g=="function"&&(o0(e,n,g,r),v=e.memoizedState),(u=hi||P_(e,n,u,r,p,v,c)||!1)?(d||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,v,c),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,v,c)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||l===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=v),a.props=r,a.state=v,a.context=c,r=u):(typeof a.componentDidUpdate!="function"||l===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),r=!1)}return d0(t,e,n,r,i,s)}function d0(t,e,n,r,s,i){Kk(t,e);var a=(e.flags&128)!==0;if(!r&&!a)return s&&C_(e,n,!1),$s(t,e,i);r=e.stateNode,LP.current=e;var l=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&a?(e.child=Uo(e,t.child,null,i),e.child=Uo(e,null,l,i)):fn(t,e,l,i),e.memoizedState=r.state,s&&C_(e,n,!0),e.child}function Xk(t){var e=t.stateNode;e.pendingContext?I_(t,e.pendingContext,e.pendingContext!==e.context):e.context&&I_(t,e.context,!1),cy(t,e.containerInfo)}function H_(t,e,n,r,s){return zo(),ry(s),e.flags|=256,fn(t,e,n,r),e.child}var h0={dehydrated:null,treeContext:null,retryLane:0};function f0(t){return{baseLanes:t,cachePool:null,transitions:null}}function Yk(t,e,n){var r=e.pendingProps,s=nt.current,i=!1,a=(e.flags&128)!==0,l;if((l=a)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Ve(nt,s&1),t===null)return i0(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=r.children,t=r.fallback,i?(r=e.mode,i=e.child,a={mode:"hidden",children:a},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=Vf(a,r,0,null),t=ba(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=f0(n),e.memoizedState=h0,t):xy(e,a));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return MP(t,e,a,r,l,s,n);if(i){i=r.fallback,a=e.mode,s=t.child,l=s.sibling;var c={mode:"hidden",children:r.children};return!(a&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=Ai(s,c),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=Ai(l,i):(i=ba(i,a,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,a=t.child.memoizedState,a=a===null?f0(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=t.childLanes&~n,e.memoizedState=h0,r}return i=t.child,t=i.sibling,r=Ai(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function xy(t,e){return e=Vf({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Ed(t,e,n,r){return r!==null&&ry(r),Uo(e,t.child,null,n),t=xy(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function MP(t,e,n,r,s,i,a){if(n)return e.flags&256?(e.flags&=-257,r=Lp(Error(V(422))),Ed(t,e,a,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=Vf({mode:"visible",children:r.children},s,0,null),i=ba(i,s,a,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Uo(e,t.child,null,a),e.child.memoizedState=f0(a),e.memoizedState=h0,i);if(!(e.mode&1))return Ed(t,e,a,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(V(419)),r=Lp(i,r,void 0),Ed(t,e,a,r)}if(l=(a&t.childLanes)!==0,In||l){if(r=Nt,r!==null){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|a)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,Os(t,s),Mr(r,t,s,-1))}return Sy(),r=Lp(Error(V(421))),Ed(t,e,a,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=XP.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,Wn=Ii(s.nextSibling),Kn=e,Je=!0,Nr=null,t!==null&&(cr[ur++]=Ts,cr[ur++]=Is,cr[ur++]=Ia,Ts=t.id,Is=t.overflow,Ia=e),e=xy(e,r.children),e.flags|=4096,e)}function W_(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),a0(t.return,e,n)}function Mp(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function Jk(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(fn(t,e,r.children,n),r=nt.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&W_(t,n,e);else if(t.tag===19)W_(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Ve(nt,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&Lh(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),Mp(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&Lh(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}Mp(e,!0,n,null,i);break;case"together":Mp(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function eh(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function $s(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),ja|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(V(153));if(e.child!==null){for(t=e.child,n=Ai(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Ai(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function OP(t,e,n){switch(e.tag){case 3:Xk(e),zo();break;case 5:kk(e);break;case 1:jn(e.type)&&Rh(e);break;case 4:cy(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Ve(Ph,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Ve(nt,nt.current&1),e.flags|=128,null):n&e.child.childLanes?Yk(t,e,n):(Ve(nt,nt.current&1),t=$s(t,e,n),t!==null?t.sibling:null);Ve(nt,nt.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return Jk(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Ve(nt,nt.current),r)break;return null;case 22:case 23:return e.lanes=0,Qk(t,e,n)}return $s(t,e,n)}var Zk,m0,eT,tT;Zk=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};m0=function(){};eT=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,xa(rs.current);var i=null;switch(n){case"input":s=Lg(t,s),r=Lg(t,r),i=[];break;case"select":s=st({},s,{value:void 0}),r=st({},r,{value:void 0}),i=[];break;case"textarea":s=$g(t,s),r=$g(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Ch)}zg(n,r);var a;n=null;for(u in s)if(!r.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var l=s[u];for(a in l)l.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Tc.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in r){var c=r[u];if(l=s!=null?s[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(a in l)!l.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in c)c.hasOwnProperty(a)&&l[a]!==c[a]&&(n||(n={}),n[a]=c[a])}else n||(i||(i=[]),i.push(u,n)),n=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Tc.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&qe("scroll",t),i||l===c||(i=[])):(i=i||[]).push(u,c))}n&&(i=i||[]).push("style",n);var u=i;(e.updateQueue=u)&&(e.flags|=4)}};tT=function(t,e,n,r){n!==r&&(e.flags|=4)};function Gl(t,e){if(!Je)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Yt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function $P(t,e,n){var r=e.pendingProps;switch(ny(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Yt(e),null;case 1:return jn(e.type)&&jh(),Yt(e),null;case 3:return r=e.stateNode,Vo(),Qe(Cn),Qe(sn),dy(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(bd(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Nr!==null&&(b0(Nr),Nr=null))),m0(t,e),Yt(e),null;case 5:uy(e);var s=xa(Oc.current);if(n=e.type,t!==null&&e.stateNode!=null)eT(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(V(166));return Yt(e),null}if(t=xa(rs.current),bd(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[Zr]=e,r[Lc]=i,t=(e.mode&1)!==0,n){case"dialog":qe("cancel",r),qe("close",r);break;case"iframe":case"object":case"embed":qe("load",r);break;case"video":case"audio":for(s=0;s<sc.length;s++)qe(sc[s],r);break;case"source":qe("error",r);break;case"img":case"image":case"link":qe("error",r),qe("load",r);break;case"details":qe("toggle",r);break;case"input":e_(r,i),qe("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},qe("invalid",r);break;case"textarea":n_(r,i),qe("invalid",r)}zg(n,i),s=null;for(var a in i)if(i.hasOwnProperty(a)){var l=i[a];a==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&_d(r.textContent,l,t),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&_d(r.textContent,l,t),s=["children",""+l]):Tc.hasOwnProperty(a)&&l!=null&&a==="onScroll"&&qe("scroll",r)}switch(n){case"input":fd(r),t_(r,i,!0);break;case"textarea":fd(r),r_(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Ch)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{a=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=C2(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=a.createElement(n,{is:r.is}):(t=a.createElement(n),n==="select"&&(a=t,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):t=a.createElementNS(t,n),t[Zr]=e,t[Lc]=r,Zk(t,e,!1,!1),e.stateNode=t;e:{switch(a=Ug(n,r),n){case"dialog":qe("cancel",t),qe("close",t),s=r;break;case"iframe":case"object":case"embed":qe("load",t),s=r;break;case"video":case"audio":for(s=0;s<sc.length;s++)qe(sc[s],t);s=r;break;case"source":qe("error",t),s=r;break;case"img":case"image":case"link":qe("error",t),qe("load",t),s=r;break;case"details":qe("toggle",t),s=r;break;case"input":e_(t,r),s=Lg(t,r),qe("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=st({},r,{value:void 0}),qe("invalid",t);break;case"textarea":n_(t,r),s=$g(t,r),qe("invalid",t);break;default:s=r}zg(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?A2(t,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&j2(t,c)):i==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&Ic(t,c):typeof c=="number"&&Ic(t,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Tc.hasOwnProperty(i)?c!=null&&i==="onScroll"&&qe("scroll",t):c!=null&&zx(t,i,c,a))}switch(n){case"input":fd(t),t_(t,r,!1);break;case"textarea":fd(t),r_(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Li(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?jo(t,!!r.multiple,i,!1):r.defaultValue!=null&&jo(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=Ch)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Yt(e),null;case 6:if(t&&e.stateNode!=null)tT(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(V(166));if(n=xa(Oc.current),xa(rs.current),bd(e)){if(r=e.stateNode,n=e.memoizedProps,r[Zr]=e,(i=r.nodeValue!==n)&&(t=Kn,t!==null))switch(t.tag){case 3:_d(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&_d(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Zr]=e,e.stateNode=r}return Yt(e),null;case 13:if(Qe(nt),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Je&&Wn!==null&&e.mode&1&&!(e.flags&128))yk(),zo(),e.flags|=98560,i=!1;else if(i=bd(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(V(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(V(317));i[Zr]=e}else zo(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Yt(e),i=!1}else Nr!==null&&(b0(Nr),Nr=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||nt.current&1?Tt===0&&(Tt=3):Sy())),e.updateQueue!==null&&(e.flags|=4),Yt(e),null);case 4:return Vo(),m0(t,e),t===null&&Fc(e.stateNode.containerInfo),Yt(e),null;case 10:return ay(e.type._context),Yt(e),null;case 17:return jn(e.type)&&jh(),Yt(e),null;case 19:if(Qe(nt),i=e.memoizedState,i===null)return Yt(e),null;if(r=(e.flags&128)!==0,a=i.rendering,a===null)if(r)Gl(i,!1);else{if(Tt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=Lh(t),a!==null){for(e.flags|=128,Gl(i,!1),r=a.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,t=a.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Ve(nt,nt.current&1|2),e.child}t=t.sibling}i.tail!==null&&mt()>Wo&&(e.flags|=128,r=!0,Gl(i,!1),e.lanes=4194304)}else{if(!r)if(t=Lh(a),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Gl(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!Je)return Yt(e),null}else 2*mt()-i.renderingStartTime>Wo&&n!==1073741824&&(e.flags|=128,r=!0,Gl(i,!1),e.lanes=4194304);i.isBackwards?(a.sibling=e.child,e.child=a):(n=i.last,n!==null?n.sibling=a:e.child=a,i.last=a)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=mt(),e.sibling=null,n=nt.current,Ve(nt,r?n&1|2:n&1),e):(Yt(e),null);case 22:case 23:return by(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Vn&1073741824&&(Yt(e),e.subtreeFlags&6&&(e.flags|=8192)):Yt(e),null;case 24:return null;case 25:return null}throw Error(V(156,e.tag))}function BP(t,e){switch(ny(e),e.tag){case 1:return jn(e.type)&&jh(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Vo(),Qe(Cn),Qe(sn),dy(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return uy(e),null;case 13:if(Qe(nt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(V(340));zo()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Qe(nt),null;case 4:return Vo(),null;case 10:return ay(e.type._context),null;case 22:case 23:return by(),null;case 24:return null;default:return null}}var kd=!1,en=!1,zP=typeof WeakSet=="function"?WeakSet:Set,Q=null;function ko(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){lt(t,e,r)}else n.current=null}function p0(t,e,n){try{n()}catch(r){lt(t,e,r)}}var q_=!1;function UP(t,e){if(Jg=kh,t=ik(),ey(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var a=0,l=-1,c=-1,u=0,d=0,f=t,p=null;t:for(;;){for(var g;f!==n||s!==0&&f.nodeType!==3||(l=a+s),f!==i||r!==0&&f.nodeType!==3||(c=a+r),f.nodeType===3&&(a+=f.nodeValue.length),(g=f.firstChild)!==null;)p=f,f=g;for(;;){if(f===t)break t;if(p===n&&++u===s&&(l=a),p===i&&++d===r&&(c=a),(g=f.nextSibling)!==null)break;f=p,p=f.parentNode}f=g}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(Zg={focusedElem:t,selectionRange:n},kh=!1,Q=e;Q!==null;)if(e=Q,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Q=t;else for(;Q!==null;){e=Q;try{var v=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var _=v.memoizedProps,b=v.memoizedState,E=e.stateNode,w=E.getSnapshotBeforeUpdate(e.elementType===e.type?_:Rr(e.type,_),b);E.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var S=e.stateNode.containerInfo;S.nodeType===1?S.textContent="":S.nodeType===9&&S.documentElement&&S.removeChild(S.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(V(163))}}catch(I){lt(e,e.return,I)}if(t=e.sibling,t!==null){t.return=e.return,Q=t;break}Q=e.return}return v=q_,q_=!1,v}function xc(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&p0(e,n,i)}s=s.next}while(s!==r)}}function zf(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function g0(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function nT(t){var e=t.alternate;e!==null&&(t.alternate=null,nT(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Zr],delete e[Lc],delete e[n0],delete e[EP],delete e[kP])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function rT(t){return t.tag===5||t.tag===3||t.tag===4}function G_(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||rT(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function x0(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Ch));else if(r!==4&&(t=t.child,t!==null))for(x0(t,e,n),t=t.sibling;t!==null;)x0(t,e,n),t=t.sibling}function y0(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(y0(t,e,n),t=t.sibling;t!==null;)y0(t,e,n),t=t.sibling}var Lt=null,Ar=!1;function li(t,e,n){for(n=n.child;n!==null;)sT(t,e,n),n=n.sibling}function sT(t,e,n){if(ns&&typeof ns.onCommitFiberUnmount=="function")try{ns.onCommitFiberUnmount(Pf,n)}catch{}switch(n.tag){case 5:en||ko(n,e);case 6:var r=Lt,s=Ar;Lt=null,li(t,e,n),Lt=r,Ar=s,Lt!==null&&(Ar?(t=Lt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Lt.removeChild(n.stateNode));break;case 18:Lt!==null&&(Ar?(t=Lt,n=n.stateNode,t.nodeType===8?Rp(t.parentNode,n):t.nodeType===1&&Rp(t,n),Ac(t)):Rp(Lt,n.stateNode));break;case 4:r=Lt,s=Ar,Lt=n.stateNode.containerInfo,Ar=!0,li(t,e,n),Lt=r,Ar=s;break;case 0:case 11:case 14:case 15:if(!en&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&p0(n,e,a),s=s.next}while(s!==r)}li(t,e,n);break;case 1:if(!en&&(ko(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){lt(n,e,l)}li(t,e,n);break;case 21:li(t,e,n);break;case 22:n.mode&1?(en=(r=en)||n.memoizedState!==null,li(t,e,n),en=r):li(t,e,n);break;default:li(t,e,n)}}function Q_(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new zP),e.forEach(function(r){var s=YP.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Cr(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,a=e,l=a;e:for(;l!==null;){switch(l.tag){case 5:Lt=l.stateNode,Ar=!1;break e;case 3:Lt=l.stateNode.containerInfo,Ar=!0;break e;case 4:Lt=l.stateNode.containerInfo,Ar=!0;break e}l=l.return}if(Lt===null)throw Error(V(160));sT(i,a,s),Lt=null,Ar=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(u){lt(s,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)iT(e,t),e=e.sibling}function iT(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Cr(e,t),qr(t),r&4){try{xc(3,t,t.return),zf(3,t)}catch(_){lt(t,t.return,_)}try{xc(5,t,t.return)}catch(_){lt(t,t.return,_)}}break;case 1:Cr(e,t),qr(t),r&512&&n!==null&&ko(n,n.return);break;case 5:if(Cr(e,t),qr(t),r&512&&n!==null&&ko(n,n.return),t.flags&32){var s=t.stateNode;try{Ic(s,"")}catch(_){lt(t,t.return,_)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,a=n!==null?n.memoizedProps:i,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&T2(s,i),Ug(l,a);var u=Ug(l,i);for(a=0;a<c.length;a+=2){var d=c[a],f=c[a+1];d==="style"?A2(s,f):d==="dangerouslySetInnerHTML"?j2(s,f):d==="children"?Ic(s,f):zx(s,d,f,u)}switch(l){case"input":Mg(s,i);break;case"textarea":I2(s,i);break;case"select":var p=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var g=i.value;g!=null?jo(s,!!i.multiple,g,!1):p!==!!i.multiple&&(i.defaultValue!=null?jo(s,!!i.multiple,i.defaultValue,!0):jo(s,!!i.multiple,i.multiple?[]:"",!1))}s[Lc]=i}catch(_){lt(t,t.return,_)}}break;case 6:if(Cr(e,t),qr(t),r&4){if(t.stateNode===null)throw Error(V(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(_){lt(t,t.return,_)}}break;case 3:if(Cr(e,t),qr(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Ac(e.containerInfo)}catch(_){lt(t,t.return,_)}break;case 4:Cr(e,t),qr(t);break;case 13:Cr(e,t),qr(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(wy=mt())),r&4&&Q_(t);break;case 22:if(d=n!==null&&n.memoizedState!==null,t.mode&1?(en=(u=en)||d,Cr(e,t),en=u):Cr(e,t),qr(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!d&&t.mode&1)for(Q=t,d=t.child;d!==null;){for(f=Q=d;Q!==null;){switch(p=Q,g=p.child,p.tag){case 0:case 11:case 14:case 15:xc(4,p,p.return);break;case 1:ko(p,p.return);var v=p.stateNode;if(typeof v.componentWillUnmount=="function"){r=p,n=p.return;try{e=r,v.props=e.memoizedProps,v.state=e.memoizedState,v.componentWillUnmount()}catch(_){lt(r,n,_)}}break;case 5:ko(p,p.return);break;case 22:if(p.memoizedState!==null){X_(f);continue}}g!==null?(g.return=p,Q=g):X_(f)}d=d.sibling}e:for(d=null,f=t;;){if(f.tag===5){if(d===null){d=f;try{s=f.stateNode,u?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=f.stateNode,c=f.memoizedProps.style,a=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=R2("display",a))}catch(_){lt(t,t.return,_)}}}else if(f.tag===6){if(d===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(_){lt(t,t.return,_)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Cr(e,t),qr(t),r&4&&Q_(t);break;case 21:break;default:Cr(e,t),qr(t)}}function qr(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(rT(n)){var r=n;break e}n=n.return}throw Error(V(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Ic(s,""),r.flags&=-33);var i=G_(t);y0(t,i,s);break;case 3:case 4:var a=r.stateNode.containerInfo,l=G_(t);x0(t,l,a);break;default:throw Error(V(161))}}catch(c){lt(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function VP(t,e,n){Q=t,aT(t)}function aT(t,e,n){for(var r=(t.mode&1)!==0;Q!==null;){var s=Q,i=s.child;if(s.tag===22&&r){var a=s.memoizedState!==null||kd;if(!a){var l=s.alternate,c=l!==null&&l.memoizedState!==null||en;l=kd;var u=en;if(kd=a,(en=c)&&!u)for(Q=s;Q!==null;)a=Q,c=a.child,a.tag===22&&a.memoizedState!==null?Y_(s):c!==null?(c.return=a,Q=c):Y_(s);for(;i!==null;)Q=i,aT(i),i=i.sibling;Q=s,kd=l,en=u}K_(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,Q=i):K_(t)}}function K_(t){for(;Q!==null;){var e=Q;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:en||zf(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!en)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:Rr(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&N_(e,i,r);break;case 3:var a=e.updateQueue;if(a!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}N_(e,a,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var f=d.dehydrated;f!==null&&Ac(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(V(163))}en||e.flags&512&&g0(e)}catch(p){lt(e,e.return,p)}}if(e===t){Q=null;break}if(n=e.sibling,n!==null){n.return=e.return,Q=n;break}Q=e.return}}function X_(t){for(;Q!==null;){var e=Q;if(e===t){Q=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Q=n;break}Q=e.return}}function Y_(t){for(;Q!==null;){var e=Q;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{zf(4,e)}catch(c){lt(e,n,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(c){lt(e,s,c)}}var i=e.return;try{g0(e)}catch(c){lt(e,i,c)}break;case 5:var a=e.return;try{g0(e)}catch(c){lt(e,a,c)}}}catch(c){lt(e,e.return,c)}if(e===t){Q=null;break}var l=e.sibling;if(l!==null){l.return=e.return,Q=l;break}Q=e.return}}var HP=Math.ceil,$h=Ks.ReactCurrentDispatcher,yy=Ks.ReactCurrentOwner,hr=Ks.ReactCurrentBatchConfig,Re=0,Nt=null,wt=null,Bt=0,Vn=0,To=Hi(0),Tt=0,Uc=null,ja=0,Uf=0,vy=0,yc=null,kn=null,wy=0,Wo=1/0,bs=null,Bh=!1,v0=null,ji=null,Td=!1,_i=null,zh=0,vc=0,w0=null,th=-1,nh=0;function pn(){return Re&6?mt():th!==-1?th:th=mt()}function Ri(t){return t.mode&1?Re&2&&Bt!==0?Bt&-Bt:IP.transition!==null?(nh===0&&(nh=V2()),nh):(t=Le,t!==0||(t=window.event,t=t===void 0?16:X2(t.type)),t):1}function Mr(t,e,n,r){if(50<vc)throw vc=0,w0=null,Error(V(185));mu(t,n,r),(!(Re&2)||t!==Nt)&&(t===Nt&&(!(Re&2)&&(Uf|=n),Tt===4&&mi(t,Bt)),Rn(t,r),n===1&&Re===0&&!(e.mode&1)&&(Wo=mt()+500,Of&&Wi()))}function Rn(t,e){var n=t.callbackNode;I5(t,e);var r=Eh(t,t===Nt?Bt:0);if(r===0)n!==null&&a_(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&a_(n),e===1)t.tag===0?TP(J_.bind(null,t)):pk(J_.bind(null,t)),bP(function(){!(Re&6)&&Wi()}),n=null;else{switch(H2(r)){case 1:n=qx;break;case 4:n=z2;break;case 16:n=Sh;break;case 536870912:n=U2;break;default:n=Sh}n=mT(n,oT.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function oT(t,e){if(th=-1,nh=0,Re&6)throw Error(V(327));var n=t.callbackNode;if(Fo()&&t.callbackNode!==n)return null;var r=Eh(t,t===Nt?Bt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Uh(t,r);else{e=r;var s=Re;Re|=2;var i=cT();(Nt!==t||Bt!==e)&&(bs=null,Wo=mt()+500,_a(t,e));do try{GP();break}catch(l){lT(t,l)}while(1);iy(),$h.current=i,Re=s,wt!==null?e=0:(Nt=null,Bt=0,e=Tt)}if(e!==0){if(e===2&&(s=Gg(t),s!==0&&(r=s,e=_0(t,s))),e===1)throw n=Uc,_a(t,0),mi(t,r),Rn(t,mt()),n;if(e===6)mi(t,r);else{if(s=t.current.alternate,!(r&30)&&!WP(s)&&(e=Uh(t,r),e===2&&(i=Gg(t),i!==0&&(r=i,e=_0(t,i))),e===1))throw n=Uc,_a(t,0),mi(t,r),Rn(t,mt()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(V(345));case 2:ua(t,kn,bs);break;case 3:if(mi(t,r),(r&130023424)===r&&(e=wy+500-mt(),10<e)){if(Eh(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){pn(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=t0(ua.bind(null,t,kn,bs),e);break}ua(t,kn,bs);break;case 4:if(mi(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var a=31-Lr(r);i=1<<a,a=e[a],a>s&&(s=a),r&=~i}if(r=s,r=mt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*HP(r/1960))-r,10<r){t.timeoutHandle=t0(ua.bind(null,t,kn,bs),r);break}ua(t,kn,bs);break;case 5:ua(t,kn,bs);break;default:throw Error(V(329))}}}return Rn(t,mt()),t.callbackNode===n?oT.bind(null,t):null}function _0(t,e){var n=yc;return t.current.memoizedState.isDehydrated&&(_a(t,e).flags|=256),t=Uh(t,e),t!==2&&(e=kn,kn=n,e!==null&&b0(e)),t}function b0(t){kn===null?kn=t:kn.push.apply(kn,t)}function WP(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!Br(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function mi(t,e){for(e&=~vy,e&=~Uf,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Lr(e),r=1<<n;t[n]=-1,e&=~r}}function J_(t){if(Re&6)throw Error(V(327));Fo();var e=Eh(t,0);if(!(e&1))return Rn(t,mt()),null;var n=Uh(t,e);if(t.tag!==0&&n===2){var r=Gg(t);r!==0&&(e=r,n=_0(t,r))}if(n===1)throw n=Uc,_a(t,0),mi(t,e),Rn(t,mt()),n;if(n===6)throw Error(V(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,ua(t,kn,bs),Rn(t,mt()),null}function _y(t,e){var n=Re;Re|=1;try{return t(e)}finally{Re=n,Re===0&&(Wo=mt()+500,Of&&Wi())}}function Ra(t){_i!==null&&_i.tag===0&&!(Re&6)&&Fo();var e=Re;Re|=1;var n=hr.transition,r=Le;try{if(hr.transition=null,Le=1,t)return t()}finally{Le=r,hr.transition=n,Re=e,!(Re&6)&&Wi()}}function by(){Vn=To.current,Qe(To)}function _a(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,_P(n)),wt!==null)for(n=wt.return;n!==null;){var r=n;switch(ny(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&jh();break;case 3:Vo(),Qe(Cn),Qe(sn),dy();break;case 5:uy(r);break;case 4:Vo();break;case 13:Qe(nt);break;case 19:Qe(nt);break;case 10:ay(r.type._context);break;case 22:case 23:by()}n=n.return}if(Nt=t,wt=t=Ai(t.current,null),Bt=Vn=e,Tt=0,Uc=null,vy=Uf=ja=0,kn=yc=null,ga!==null){for(e=0;e<ga.length;e++)if(n=ga[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var a=i.next;i.next=s,r.next=a}n.pending=r}ga=null}return t}function lT(t,e){do{var n=wt;try{if(iy(),Jd.current=Oh,Mh){for(var r=rt.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Mh=!1}if(Ca=0,Rt=Et=rt=null,gc=!1,$c=0,yy.current=null,n===null||n.return===null){Tt=1,Uc=e,wt=null;break}e:{var i=t,a=n.return,l=n,c=e;if(e=Bt,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=l,f=d.tag;if(!(d.mode&1)&&(f===0||f===11||f===15)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var g=$_(a);if(g!==null){g.flags&=-257,B_(g,a,l,i,e),g.mode&1&&O_(i,u,e),e=g,c=u;var v=e.updateQueue;if(v===null){var _=new Set;_.add(c),e.updateQueue=_}else v.add(c);break e}else{if(!(e&1)){O_(i,u,e),Sy();break e}c=Error(V(426))}}else if(Je&&l.mode&1){var b=$_(a);if(b!==null){!(b.flags&65536)&&(b.flags|=256),B_(b,a,l,i,e),ry(Ho(c,l));break e}}i=c=Ho(c,l),Tt!==4&&(Tt=2),yc===null?yc=[i]:yc.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var E=Wk(i,c,e);A_(i,E);break e;case 1:l=c;var w=i.type,S=i.stateNode;if(!(i.flags&128)&&(typeof w.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(ji===null||!ji.has(S)))){i.flags|=65536,e&=-e,i.lanes|=e;var I=qk(i,l,e);A_(i,I);break e}}i=i.return}while(i!==null)}dT(n)}catch(F){e=F,wt===n&&n!==null&&(wt=n=n.return);continue}break}while(1)}function cT(){var t=$h.current;return $h.current=Oh,t===null?Oh:t}function Sy(){(Tt===0||Tt===3||Tt===2)&&(Tt=4),Nt===null||!(ja&268435455)&&!(Uf&268435455)||mi(Nt,Bt)}function Uh(t,e){var n=Re;Re|=2;var r=cT();(Nt!==t||Bt!==e)&&(bs=null,_a(t,e));do try{qP();break}catch(s){lT(t,s)}while(1);if(iy(),Re=n,$h.current=r,wt!==null)throw Error(V(261));return Nt=null,Bt=0,Tt}function qP(){for(;wt!==null;)uT(wt)}function GP(){for(;wt!==null&&!y5();)uT(wt)}function uT(t){var e=fT(t.alternate,t,Vn);t.memoizedProps=t.pendingProps,e===null?dT(t):wt=e,yy.current=null}function dT(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=BP(n,e),n!==null){n.flags&=32767,wt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Tt=6,wt=null;return}}else if(n=$P(n,e,Vn),n!==null){wt=n;return}if(e=e.sibling,e!==null){wt=e;return}wt=e=t}while(e!==null);Tt===0&&(Tt=5)}function ua(t,e,n){var r=Le,s=hr.transition;try{hr.transition=null,Le=1,QP(t,e,n,r)}finally{hr.transition=s,Le=r}return null}function QP(t,e,n,r){do Fo();while(_i!==null);if(Re&6)throw Error(V(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(V(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(C5(t,i),t===Nt&&(wt=Nt=null,Bt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Td||(Td=!0,mT(Sh,function(){return Fo(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=hr.transition,hr.transition=null;var a=Le;Le=1;var l=Re;Re|=4,yy.current=null,UP(t,n),iT(n,t),mP(Zg),kh=!!Jg,Zg=Jg=null,t.current=n,VP(n),v5(),Re=l,Le=a,hr.transition=i}else t.current=n;if(Td&&(Td=!1,_i=t,zh=s),i=t.pendingLanes,i===0&&(ji=null),b5(n.stateNode),Rn(t,mt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Bh)throw Bh=!1,t=v0,v0=null,t;return zh&1&&t.tag!==0&&Fo(),i=t.pendingLanes,i&1?t===w0?vc++:(vc=0,w0=t):vc=0,Wi(),null}function Fo(){if(_i!==null){var t=H2(zh),e=hr.transition,n=Le;try{if(hr.transition=null,Le=16>t?16:t,_i===null)var r=!1;else{if(t=_i,_i=null,zh=0,Re&6)throw Error(V(331));var s=Re;for(Re|=4,Q=t.current;Q!==null;){var i=Q,a=i.child;if(Q.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(Q=u;Q!==null;){var d=Q;switch(d.tag){case 0:case 11:case 15:xc(8,d,i)}var f=d.child;if(f!==null)f.return=d,Q=f;else for(;Q!==null;){d=Q;var p=d.sibling,g=d.return;if(nT(d),d===u){Q=null;break}if(p!==null){p.return=g,Q=p;break}Q=g}}}var v=i.alternate;if(v!==null){var _=v.child;if(_!==null){v.child=null;do{var b=_.sibling;_.sibling=null,_=b}while(_!==null)}}Q=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,Q=a;else e:for(;Q!==null;){if(i=Q,i.flags&2048)switch(i.tag){case 0:case 11:case 15:xc(9,i,i.return)}var E=i.sibling;if(E!==null){E.return=i.return,Q=E;break e}Q=i.return}}var w=t.current;for(Q=w;Q!==null;){a=Q;var S=a.child;if(a.subtreeFlags&2064&&S!==null)S.return=a,Q=S;else e:for(a=w;Q!==null;){if(l=Q,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:zf(9,l)}}catch(F){lt(l,l.return,F)}if(l===a){Q=null;break e}var I=l.sibling;if(I!==null){I.return=l.return,Q=I;break e}Q=l.return}}if(Re=s,Wi(),ns&&typeof ns.onPostCommitFiberRoot=="function")try{ns.onPostCommitFiberRoot(Pf,t)}catch{}r=!0}return r}finally{Le=n,hr.transition=e}}return!1}function Z_(t,e,n){e=Ho(n,e),e=Wk(t,e,1),t=Ci(t,e,1),e=pn(),t!==null&&(mu(t,1,e),Rn(t,e))}function lt(t,e,n){if(t.tag===3)Z_(t,t,n);else for(;e!==null;){if(e.tag===3){Z_(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(ji===null||!ji.has(r))){t=Ho(n,t),t=qk(e,t,1),e=Ci(e,t,1),t=pn(),e!==null&&(mu(e,1,t),Rn(e,t));break}}e=e.return}}function KP(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=pn(),t.pingedLanes|=t.suspendedLanes&n,Nt===t&&(Bt&n)===n&&(Tt===4||Tt===3&&(Bt&130023424)===Bt&&500>mt()-wy?_a(t,0):vy|=n),Rn(t,e)}function hT(t,e){e===0&&(t.mode&1?(e=gd,gd<<=1,!(gd&130023424)&&(gd=4194304)):e=1);var n=pn();t=Os(t,e),t!==null&&(mu(t,e,n),Rn(t,n))}function XP(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),hT(t,n)}function YP(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(V(314))}r!==null&&r.delete(e),hT(t,n)}var fT;fT=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Cn.current)In=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return In=!1,OP(t,e,n);In=!!(t.flags&131072)}else In=!1,Je&&e.flags&1048576&&gk(e,Nh,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;eh(t,e),t=e.pendingProps;var s=Bo(e,sn.current);Po(e,n),s=fy(null,e,r,t,s,n);var i=my();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,jn(r)?(i=!0,Rh(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,ly(e),s.updater=$f,e.stateNode=s,s._reactInternals=e,l0(e,r,t,n),e=d0(null,e,r,!0,i,n)):(e.tag=0,Je&&i&&ty(e),fn(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(eh(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=ZP(r),t=Rr(r,t),s){case 0:e=u0(null,e,r,t,n);break e;case 1:e=V_(null,e,r,t,n);break e;case 11:e=z_(null,e,r,t,n);break e;case 14:e=U_(null,e,r,Rr(r.type,t),n);break e}throw Error(V(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Rr(r,s),u0(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Rr(r,s),V_(t,e,r,s,n);case 3:e:{if(Xk(e),t===null)throw Error(V(387));r=e.pendingProps,i=e.memoizedState,s=i.element,wk(t,e),Dh(e,r,null,n);var a=e.memoizedState;if(r=a.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=Ho(Error(V(423)),e),e=H_(t,e,r,n,s);break e}else if(r!==s){s=Ho(Error(V(424)),e),e=H_(t,e,r,n,s);break e}else for(Wn=Ii(e.stateNode.containerInfo.firstChild),Kn=e,Je=!0,Nr=null,n=Ek(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(zo(),r===s){e=$s(t,e,n);break e}fn(t,e,r,n)}e=e.child}return e;case 5:return kk(e),t===null&&i0(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,a=s.children,e0(r,s)?a=null:i!==null&&e0(r,i)&&(e.flags|=32),Kk(t,e),fn(t,e,a,n),e.child;case 6:return t===null&&i0(e),null;case 13:return Yk(t,e,n);case 4:return cy(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Uo(e,null,r,n):fn(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Rr(r,s),z_(t,e,r,s,n);case 7:return fn(t,e,e.pendingProps,n),e.child;case 8:return fn(t,e,e.pendingProps.children,n),e.child;case 12:return fn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,a=s.value,Ve(Ph,r._currentValue),r._currentValue=a,i!==null)if(Br(i.value,a)){if(i.children===s.children&&!Cn.current){e=$s(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){a=i.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(i.tag===1){c=Ps(-1,n&-n),c.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}i.lanes|=n,c=i.alternate,c!==null&&(c.lanes|=n),a0(i.return,n,e),l.lanes|=n;break}c=c.next}}else if(i.tag===10)a=i.type===e.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error(V(341));a.lanes|=n,l=a.alternate,l!==null&&(l.lanes|=n),a0(a,n,e),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===e){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}fn(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Po(e,n),s=fr(s),r=r(s),e.flags|=1,fn(t,e,r,n),e.child;case 14:return r=e.type,s=Rr(r,e.pendingProps),s=Rr(r.type,s),U_(t,e,r,s,n);case 15:return Gk(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Rr(r,s),eh(t,e),e.tag=1,jn(r)?(t=!0,Rh(e)):t=!1,Po(e,n),bk(e,r,s),l0(e,r,s,n),d0(null,e,r,!0,t,n);case 19:return Jk(t,e,n);case 22:return Qk(t,e,n)}throw Error(V(156,e.tag))};function mT(t,e){return B2(t,e)}function JP(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function dr(t,e,n,r){return new JP(t,e,n,r)}function Ey(t){return t=t.prototype,!(!t||!t.isReactComponent)}function ZP(t){if(typeof t=="function")return Ey(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Vx)return 11;if(t===Hx)return 14}return 2}function Ai(t,e){var n=t.alternate;return n===null?(n=dr(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function rh(t,e,n,r,s,i){var a=2;if(r=t,typeof t=="function")Ey(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case go:return ba(n.children,s,i,e);case Ux:a=8,s|=8;break;case Ng:return t=dr(12,n,e,s|2),t.elementType=Ng,t.lanes=i,t;case Pg:return t=dr(13,n,e,s),t.elementType=Pg,t.lanes=i,t;case Fg:return t=dr(19,n,e,s),t.elementType=Fg,t.lanes=i,t;case S2:return Vf(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case _2:a=10;break e;case b2:a=9;break e;case Vx:a=11;break e;case Hx:a=14;break e;case di:a=16,r=null;break e}throw Error(V(130,t==null?t:typeof t,""))}return e=dr(a,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function ba(t,e,n,r){return t=dr(7,t,r,e),t.lanes=n,t}function Vf(t,e,n,r){return t=dr(22,t,r,e),t.elementType=S2,t.lanes=n,t.stateNode={isHidden:!1},t}function Op(t,e,n){return t=dr(6,t,null,e),t.lanes=n,t}function $p(t,e,n){return e=dr(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function e4(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=vp(0),this.expirationTimes=vp(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=vp(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function ky(t,e,n,r,s,i,a,l,c){return t=new e4(t,e,n,l,c),e===1?(e=1,i===!0&&(e|=8)):e=0,i=dr(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},ly(i),t}function t4(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:po,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function pT(t){if(!t)return Mi;t=t._reactInternals;e:{if(qa(t)!==t||t.tag!==1)throw Error(V(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(jn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(V(171))}if(t.tag===1){var n=t.type;if(jn(n))return mk(t,n,e)}return e}function gT(t,e,n,r,s,i,a,l,c){return t=ky(n,r,!0,t,s,i,a,l,c),t.context=pT(null),n=t.current,r=pn(),s=Ri(n),i=Ps(r,s),i.callback=e??null,Ci(n,i,s),t.current.lanes=s,mu(t,s,r),Rn(t,r),t}function Hf(t,e,n,r){var s=e.current,i=pn(),a=Ri(s);return n=pT(n),e.context===null?e.context=n:e.pendingContext=n,e=Ps(i,a),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Ci(s,e,a),t!==null&&(Mr(t,s,a,i),Yd(t,s,a)),a}function Vh(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function eb(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Ty(t,e){eb(t,e),(t=t.alternate)&&eb(t,e)}function n4(){return null}var xT=typeof reportError=="function"?reportError:function(t){console.error(t)};function Iy(t){this._internalRoot=t}Wf.prototype.render=Iy.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(V(409));Hf(t,e,null,null)};Wf.prototype.unmount=Iy.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Ra(function(){Hf(null,t,null,null)}),e[Ms]=null}};function Wf(t){this._internalRoot=t}Wf.prototype.unstable_scheduleHydration=function(t){if(t){var e=G2();t={blockedOn:null,target:t,priority:e};for(var n=0;n<fi.length&&e!==0&&e<fi[n].priority;n++);fi.splice(n,0,t),n===0&&K2(t)}};function Cy(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function qf(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function tb(){}function r4(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var u=Vh(a);i.call(u)}}var a=gT(e,r,t,0,null,!1,!1,"",tb);return t._reactRootContainer=a,t[Ms]=a.current,Fc(t.nodeType===8?t.parentNode:t),Ra(),a}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var u=Vh(c);l.call(u)}}var c=ky(t,0,!1,null,null,!1,!1,"",tb);return t._reactRootContainer=c,t[Ms]=c.current,Fc(t.nodeType===8?t.parentNode:t),Ra(function(){Hf(e,c,n,r)}),c}function Gf(t,e,n,r,s){var i=n._reactRootContainer;if(i){var a=i;if(typeof s=="function"){var l=s;s=function(){var c=Vh(a);l.call(c)}}Hf(e,a,t,s)}else a=r4(n,e,t,s,r);return Vh(a)}W2=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=rc(e.pendingLanes);n!==0&&(Gx(e,n|1),Rn(e,mt()),!(Re&6)&&(Wo=mt()+500,Wi()))}break;case 13:Ra(function(){var r=Os(t,1);if(r!==null){var s=pn();Mr(r,t,1,s)}}),Ty(t,1)}};Qx=function(t){if(t.tag===13){var e=Os(t,134217728);if(e!==null){var n=pn();Mr(e,t,134217728,n)}Ty(t,134217728)}};q2=function(t){if(t.tag===13){var e=Ri(t),n=Os(t,e);if(n!==null){var r=pn();Mr(n,t,e,r)}Ty(t,e)}};G2=function(){return Le};Q2=function(t,e){var n=Le;try{return Le=t,e()}finally{Le=n}};Hg=function(t,e,n){switch(e){case"input":if(Mg(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=Mf(r);if(!s)throw Error(V(90));k2(r),Mg(r,s)}}}break;case"textarea":I2(t,n);break;case"select":e=n.value,e!=null&&jo(t,!!n.multiple,e,!1)}};F2=_y;D2=Ra;var s4={usingClientEntryPoint:!1,Events:[gu,wo,Mf,N2,P2,_y]},Ql={findFiberByHostInstance:pa,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},i4={bundleType:Ql.bundleType,version:Ql.version,rendererPackageName:Ql.rendererPackageName,rendererConfig:Ql.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ks.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=O2(t),t===null?null:t.stateNode},findFiberByHostInstance:Ql.findFiberByHostInstance||n4,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Id=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Id.isDisabled&&Id.supportsFiber)try{Pf=Id.inject(i4),ns=Id}catch{}}tr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=s4;tr.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Cy(e))throw Error(V(200));return t4(t,e,null,n)};tr.createRoot=function(t,e){if(!Cy(t))throw Error(V(299));var n=!1,r="",s=xT;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=ky(t,1,!1,null,null,n,!1,r,s),t[Ms]=e.current,Fc(t.nodeType===8?t.parentNode:t),new Iy(e)};tr.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(V(188)):(t=Object.keys(t).join(","),Error(V(268,t)));return t=O2(e),t=t===null?null:t.stateNode,t};tr.flushSync=function(t){return Ra(t)};tr.hydrate=function(t,e,n){if(!qf(e))throw Error(V(200));return Gf(null,t,e,!0,n)};tr.hydrateRoot=function(t,e,n){if(!Cy(t))throw Error(V(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",a=xT;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),e=gT(e,null,t,1,n??null,s,!1,i,a),t[Ms]=e.current,Fc(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Wf(e)};tr.render=function(t,e,n){if(!qf(e))throw Error(V(200));return Gf(null,t,e,!1,n)};tr.unmountComponentAtNode=function(t){if(!qf(t))throw Error(V(40));return t._reactRootContainer?(Ra(function(){Gf(null,null,t,!1,function(){t._reactRootContainer=null,t[Ms]=null})}),!0):!1};tr.unstable_batchedUpdates=_y;tr.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!qf(n))throw Error(V(200));if(t==null||t._reactInternals===void 0)throw Error(V(38));return Gf(t,e,n,!1,r)};tr.version="18.2.0-next-9e3b772b8-20220608";function yT(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(yT)}catch(t){console.error(t)}}yT(),g2.exports=tr;var Ga=g2.exports,nb=Ga;Rg.createRoot=nb.createRoot,Rg.hydrateRoot=nb.hydrateRoot;/**
 * @remix-run/router v1.7.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Vc(){return Vc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Vc.apply(this,arguments)}var bi;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(bi||(bi={}));const rb="popstate";function a4(t){t===void 0&&(t={});function e(s,i){let{pathname:a="/",search:l="",hash:c=""}=Qa(s.location.hash.substr(1));return S0("",{pathname:a,search:l,hash:c},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(s,i){let a=s.document.querySelector("base"),l="";if(a&&a.getAttribute("href")){let c=s.location.href,u=c.indexOf("#");l=u===-1?c:c.slice(0,u)}return l+"#"+(typeof i=="string"?i:Hh(i))}function r(s,i){Qf(s.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(i)+")")}return l4(e,n,r,t)}function gt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Qf(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function o4(){return Math.random().toString(36).substr(2,8)}function sb(t,e){return{usr:t.state,key:t.key,idx:e}}function S0(t,e,n,r){return n===void 0&&(n=null),Vc({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Qa(e):e,{state:n,key:e&&e.key||r||o4()})}function Hh(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Qa(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function l4(t,e,n,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:i=!1}=r,a=s.history,l=bi.Pop,c=null,u=d();u==null&&(u=0,a.replaceState(Vc({},a.state,{idx:u}),""));function d(){return(a.state||{idx:null}).idx}function f(){l=bi.Pop;let b=d(),E=b==null?null:b-u;u=b,c&&c({action:l,location:_.location,delta:E})}function p(b,E){l=bi.Push;let w=S0(_.location,b,E);n&&n(w,b),u=d()+1;let S=sb(w,u),I=_.createHref(w);try{a.pushState(S,"",I)}catch(F){if(F instanceof DOMException&&F.name==="DataCloneError")throw F;s.location.assign(I)}i&&c&&c({action:l,location:_.location,delta:1})}function g(b,E){l=bi.Replace;let w=S0(_.location,b,E);n&&n(w,b),u=d();let S=sb(w,u),I=_.createHref(w);a.replaceState(S,"",I),i&&c&&c({action:l,location:_.location,delta:0})}function v(b){let E=s.location.origin!=="null"?s.location.origin:s.location.href,w=typeof b=="string"?b:Hh(b);return gt(E,"No window.location.(origin|href) available to create URL for href: "+w),new URL(w,E)}let _={get action(){return l},get location(){return t(s,a)},listen(b){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(rb,f),c=b,()=>{s.removeEventListener(rb,f),c=null}},createHref(b){return e(s,b)},createURL:v,encodeLocation(b){let E=v(b);return{pathname:E.pathname,search:E.search,hash:E.hash}},push:p,replace:g,go(b){return a.go(b)}};return _}var ib;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(ib||(ib={}));function c4(t,e,n){n===void 0&&(n="/");let r=typeof e=="string"?Qa(e):e,s=jy(r.pathname||"/",n);if(s==null)return null;let i=vT(t);u4(i);let a=null;for(let l=0;a==null&&l<i.length;++l)a=v4(i[l],b4(s));return a}function vT(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let s=(i,a,l)=>{let c={relativePath:l===void 0?i.path||"":l,caseSensitive:i.caseSensitive===!0,childrenIndex:a,route:i};c.relativePath.startsWith("/")&&(gt(c.relativePath.startsWith(r),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(r.length));let u=Ni([r,c.relativePath]),d=n.concat(c);i.children&&i.children.length>0&&(gt(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),vT(i.children,e,d,u)),!(i.path==null&&!i.index)&&e.push({path:u,score:x4(u,i.index),routesMeta:d})};return t.forEach((i,a)=>{var l;if(i.path===""||!((l=i.path)!=null&&l.includes("?")))s(i,a);else for(let c of wT(i.path))s(i,a,c)}),e}function wT(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let a=wT(r.join("/")),l=[];return l.push(...a.map(c=>c===""?i:[i,c].join("/"))),s&&l.push(...a),l.map(c=>t.startsWith("/")&&c===""?"/":c)}function u4(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:y4(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const d4=/^:\w+$/,h4=3,f4=2,m4=1,p4=10,g4=-2,ab=t=>t==="*";function x4(t,e){let n=t.split("/"),r=n.length;return n.some(ab)&&(r+=g4),e&&(r+=f4),n.filter(s=>!ab(s)).reduce((s,i)=>s+(d4.test(i)?h4:i===""?m4:p4),r)}function y4(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function v4(t,e){let{routesMeta:n}=t,r={},s="/",i=[];for(let a=0;a<n.length;++a){let l=n[a],c=a===n.length-1,u=s==="/"?e:e.slice(s.length)||"/",d=w4({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u);if(!d)return null;Object.assign(r,d.params);let f=l.route;i.push({params:r,pathname:Ni([s,d.pathname]),pathnameBase:T4(Ni([s,d.pathnameBase])),route:f}),d.pathnameBase!=="/"&&(s=Ni([s,d.pathnameBase]))}return i}function w4(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=_4(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let i=s[0],a=i.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:r.reduce((u,d,f)=>{if(d==="*"){let p=l[f]||"";a=i.slice(0,i.length-p.length).replace(/(.)\/+$/,"$1")}return u[d]=S4(l[f]||"",d),u},{}),pathname:i,pathnameBase:a,pattern:t}}function _4(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),Qf(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/\/:(\w+)/g,(a,l)=>(r.push(l),"/([^\\/]+)"));return t.endsWith("*")?(r.push("*"),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function b4(t){try{return decodeURI(t)}catch(e){return Qf(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function S4(t,e){try{return decodeURIComponent(t)}catch(n){return Qf(!1,'The value for the URL param "'+e+'" will not be decoded because'+(' the string "'+t+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+n+").")),t}}function jy(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function E4(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?Qa(t):t;return{pathname:n?n.startsWith("/")?n:k4(n,e):e,search:I4(r),hash:C4(s)}}function k4(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function Bp(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Ry(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function Ay(t,e,n,r){r===void 0&&(r=!1);let s;typeof t=="string"?s=Qa(t):(s=Vc({},t),gt(!s.pathname||!s.pathname.includes("?"),Bp("?","pathname","search",s)),gt(!s.pathname||!s.pathname.includes("#"),Bp("#","pathname","hash",s)),gt(!s.search||!s.search.includes("#"),Bp("#","search","hash",s)));let i=t===""||s.pathname==="",a=i?"/":s.pathname,l;if(r||a==null)l=n;else{let f=e.length-1;if(a.startsWith("..")){let p=a.split("/");for(;p[0]==="..";)p.shift(),f-=1;s.pathname=p.join("/")}l=f>=0?e[f]:"/"}let c=E4(s,l),u=a&&a!=="/"&&a.endsWith("/"),d=(i||a===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}const Ni=t=>t.join("/").replace(/\/\/+/g,"/"),T4=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),I4=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,C4=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function j4(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const _T=["post","put","patch","delete"];new Set(_T);const R4=["get",..._T];new Set(R4);/**
 * React Router v6.14.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Wh(){return Wh=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Wh.apply(this,arguments)}const Ny=m.createContext(null),A4=m.createContext(null),al=m.createContext(null),Kf=m.createContext(null),fs=m.createContext({outlet:null,matches:[],isDataRoute:!1}),bT=m.createContext(null);function N4(t,e){let{relative:n}=e===void 0?{}:e;ol()||gt(!1);let{basename:r,navigator:s}=m.useContext(al),{hash:i,pathname:a,search:l}=ET(t,{relative:n}),c=a;return r!=="/"&&(c=a==="/"?r:Ni([r,a])),s.createHref({pathname:c,search:l,hash:i})}function ol(){return m.useContext(Kf)!=null}function rr(){return ol()||gt(!1),m.useContext(Kf).location}function ST(t){m.useContext(al).static||m.useLayoutEffect(t)}function qt(){let{isDataRoute:t}=m.useContext(fs);return t?G4():P4()}function P4(){ol()||gt(!1);let t=m.useContext(Ny),{basename:e,navigator:n}=m.useContext(al),{matches:r}=m.useContext(fs),{pathname:s}=rr(),i=JSON.stringify(Ry(r).map(c=>c.pathnameBase)),a=m.useRef(!1);return ST(()=>{a.current=!0}),m.useCallback(function(c,u){if(u===void 0&&(u={}),!a.current)return;if(typeof c=="number"){n.go(c);return}let d=Ay(c,JSON.parse(i),s,u.relative==="path");t==null&&e!=="/"&&(d.pathname=d.pathname==="/"?e:Ni([e,d.pathname])),(u.replace?n.replace:n.push)(d,u.state,u)},[e,n,i,s,t])}const F4=m.createContext(null);function D4(t){let e=m.useContext(fs).outlet;return e&&m.createElement(F4.Provider,{value:t},e)}function qi(){let{matches:t}=m.useContext(fs),e=t[t.length-1];return e?e.params:{}}function ET(t,e){let{relative:n}=e===void 0?{}:e,{matches:r}=m.useContext(fs),{pathname:s}=rr(),i=JSON.stringify(Ry(r).map(a=>a.pathnameBase));return m.useMemo(()=>Ay(t,JSON.parse(i),s,n==="path"),[t,i,s,n])}function L4(t,e){return M4(t,e)}function M4(t,e,n){ol()||gt(!1);let{navigator:r}=m.useContext(al),{matches:s}=m.useContext(fs),i=s[s.length-1],a=i?i.params:{};i&&i.pathname;let l=i?i.pathnameBase:"/";i&&i.route;let c=rr(),u;if(e){var d;let _=typeof e=="string"?Qa(e):e;l==="/"||(d=_.pathname)!=null&&d.startsWith(l)||gt(!1),u=_}else u=c;let f=u.pathname||"/",p=l==="/"?f:f.slice(l.length)||"/",g=c4(t,{pathname:p}),v=U4(g&&g.map(_=>Object.assign({},_,{params:Object.assign({},a,_.params),pathname:Ni([l,r.encodeLocation?r.encodeLocation(_.pathname).pathname:_.pathname]),pathnameBase:_.pathnameBase==="/"?l:Ni([l,r.encodeLocation?r.encodeLocation(_.pathnameBase).pathname:_.pathnameBase])})),s,n);return e&&v?m.createElement(Kf.Provider,{value:{location:Wh({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:bi.Pop}},v):v}function O4(){let t=q4(),e=j4(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},i=null;return m.createElement(m.Fragment,null,m.createElement("h2",null,"Unexpected Application Error!"),m.createElement("h3",{style:{fontStyle:"italic"}},e),n?m.createElement("pre",{style:s},n):null,i)}const $4=m.createElement(O4,null);class B4 extends m.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error||n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error?m.createElement(fs.Provider,{value:this.props.routeContext},m.createElement(bT.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function z4(t){let{routeContext:e,match:n,children:r}=t,s=m.useContext(Ny);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),m.createElement(fs.Provider,{value:e},r)}function U4(t,e,n){var r;if(e===void 0&&(e=[]),n===void 0&&(n=null),t==null){var s;if((s=n)!=null&&s.errors)t=n.matches;else return null}let i=t,a=(r=n)==null?void 0:r.errors;if(a!=null){let l=i.findIndex(c=>c.route.id&&(a==null?void 0:a[c.route.id]));l>=0||gt(!1),i=i.slice(0,Math.min(i.length,l+1))}return i.reduceRight((l,c,u)=>{let d=c.route.id?a==null?void 0:a[c.route.id]:null,f=null;n&&(f=c.route.errorElement||$4);let p=e.concat(i.slice(0,u+1)),g=()=>{let v;return d?v=f:c.route.Component?v=m.createElement(c.route.Component,null):c.route.element?v=c.route.element:v=l,m.createElement(z4,{match:c,routeContext:{outlet:l,matches:p,isDataRoute:n!=null},children:v})};return n&&(c.route.ErrorBoundary||c.route.errorElement||u===0)?m.createElement(B4,{location:n.location,revalidation:n.revalidation,component:f,error:d,children:g(),routeContext:{outlet:null,matches:p,isDataRoute:!0}}):g()},null)}var E0;(function(t){t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate"})(E0||(E0={}));var Hc;(function(t){t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId"})(Hc||(Hc={}));function V4(t){let e=m.useContext(Ny);return e||gt(!1),e}function H4(t){let e=m.useContext(A4);return e||gt(!1),e}function W4(t){let e=m.useContext(fs);return e||gt(!1),e}function kT(t){let e=W4(),n=e.matches[e.matches.length-1];return n.route.id||gt(!1),n.route.id}function q4(){var t;let e=m.useContext(bT),n=H4(Hc.UseRouteError),r=kT(Hc.UseRouteError);return e||((t=n.errors)==null?void 0:t[r])}function G4(){let{router:t}=V4(E0.UseNavigateStable),e=kT(Hc.UseNavigateStable),n=m.useRef(!1);return ST(()=>{n.current=!0}),m.useCallback(function(s,i){i===void 0&&(i={}),n.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,Wh({fromRouteId:e},i)))},[t,e])}function TT(t){let{to:e,replace:n,state:r,relative:s}=t;ol()||gt(!1);let{matches:i}=m.useContext(fs),{pathname:a}=rr(),l=qt(),c=Ay(e,Ry(i).map(d=>d.pathnameBase),a,s==="path"),u=JSON.stringify(c);return m.useEffect(()=>l(JSON.parse(u),{replace:n,state:r,relative:s}),[l,u,s,n,r]),null}function Xf(t){return D4(t.context)}function Xr(t){gt(!1)}function Q4(t){let{basename:e="/",children:n=null,location:r,navigationType:s=bi.Pop,navigator:i,static:a=!1}=t;ol()&&gt(!1);let l=e.replace(/^\/*/,"/"),c=m.useMemo(()=>({basename:l,navigator:i,static:a}),[l,i,a]);typeof r=="string"&&(r=Qa(r));let{pathname:u="/",search:d="",hash:f="",state:p=null,key:g="default"}=r,v=m.useMemo(()=>{let _=jy(u,l);return _==null?null:{location:{pathname:_,search:d,hash:f,state:p,key:g},navigationType:s}},[l,u,d,f,p,g,s]);return v==null?null:m.createElement(al.Provider,{value:c},m.createElement(Kf.Provider,{children:n,value:v}))}function K4(t){let{children:e,location:n}=t;return L4(k0(e),n)}var ob;(function(t){t[t.pending=0]="pending",t[t.success=1]="success",t[t.error=2]="error"})(ob||(ob={}));new Promise(()=>{});function k0(t,e){e===void 0&&(e=[]);let n=[];return m.Children.forEach(t,(r,s)=>{if(!m.isValidElement(r))return;let i=[...e,s];if(r.type===m.Fragment){n.push.apply(n,k0(r.props.children,i));return}r.type!==Xr&&gt(!1),!r.props.index||!r.props.children||gt(!1);let a={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(a.children=k0(r.props.children,i)),n.push(a)}),n}/**
 * React Router DOM v6.14.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function T0(){return T0=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},T0.apply(this,arguments)}function X4(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,i;for(i=0;i<r.length;i++)s=r[i],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}function Y4(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function J4(t,e){return t.button===0&&(!e||e==="_self")&&!Y4(t)}function I0(t){return t===void 0&&(t=""),new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let r=t[n];return e.concat(Array.isArray(r)?r.map(s=>[n,s]):[[n,r]])},[]))}function Z4(t,e){let n=I0(t);if(e)for(let r of e.keys())n.has(r)||e.getAll(r).forEach(s=>{n.append(r,s)});return n}const e3=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset"],t3="startTransition",lb=XN[t3];function n3(t){let{basename:e,children:n,future:r,window:s}=t,i=m.useRef();i.current==null&&(i.current=a4({window:s,v5Compat:!0}));let a=i.current,[l,c]=m.useState({action:a.action,location:a.location}),{v7_startTransition:u}=r||{},d=m.useCallback(f=>{u&&lb?lb(()=>c(f)):c(f)},[c,u]);return m.useLayoutEffect(()=>a.listen(d),[a,d]),m.createElement(Q4,{basename:e,children:n,location:l.location,navigationType:l.action,navigator:a})}const r3=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",s3=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,we=m.forwardRef(function(e,n){let{onClick:r,relative:s,reloadDocument:i,replace:a,state:l,target:c,to:u,preventScrollReset:d}=e,f=X4(e,e3),{basename:p}=m.useContext(al),g,v=!1;if(typeof u=="string"&&s3.test(u)&&(g=u,r3))try{let w=new URL(window.location.href),S=u.startsWith("//")?new URL(w.protocol+u):new URL(u),I=jy(S.pathname,p);S.origin===w.origin&&I!=null?u=I+S.search+S.hash:v=!0}catch{}let _=N4(u,{relative:s}),b=i3(u,{replace:a,state:l,target:c,preventScrollReset:d,relative:s});function E(w){r&&r(w),w.defaultPrevented||b(w)}return m.createElement("a",T0({},f,{href:g||_,onClick:v||i?r:E,ref:n,target:c}))});var cb;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher"})(cb||(cb={}));var ub;(function(t){t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(ub||(ub={}));function i3(t,e){let{target:n,replace:r,state:s,preventScrollReset:i,relative:a}=e===void 0?{}:e,l=qt(),c=rr(),u=ET(t,{relative:a});return m.useCallback(d=>{if(J4(d,n)){d.preventDefault();let f=r!==void 0?r:Hh(c)===Hh(u);l(t,{replace:f,state:s,preventScrollReset:i,relative:a})}},[c,l,u,r,s,n,t,i,a])}function IT(t){let e=m.useRef(I0(t)),n=m.useRef(!1),r=rr(),s=m.useMemo(()=>Z4(r.search,n.current?null:e.current),[r.search]),i=qt(),a=m.useCallback((l,c)=>{const u=I0(typeof l=="function"?l(s):l);n.current=!0,i("?"+u,c)},[i,s]);return[s,a]}function a3(){const[t,e]=m.useState([]),[n,r]=m.useState(),[s,i]=m.useState([]),[a,l]=m.useState([]),[c,u]=m.useState([]);return{singer:n,setSinger:r,singers:t,setSingers:e,songs:s,setSongs:i,playlists:a,setPlaylists:l,albums:c,setAlbums:u}}const CT=m.createContext(null);function o3({children:t}){return o.jsx(CT.Provider,{value:a3(),children:t})}function Xs(){const t=m.useContext(CT);if(!t)throw new Error("SingerProvider not provided");return t}function db({children:t}){return o.jsx(o3,{children:t})}function Yf(){const t={container:"pt-[30px] pb-[110px] md:mt-auto md:pb-[120px] md:flex md:justify-between md:items-center",icon:"w-6 hover:scale-[1.1] transition linear ",copyRightText:"text-sm"};return o.jsxs("div",{className:`${t.container}`,children:[o.jsxs("p",{className:t.copyRightText,children:["Make with  ",o.jsx("span",{className:"text-red-500",children:""}),"  by d4t06 ",o.jsx("br",{}),"  All rights no reserve \\_()_/"]}),o.jsxs("div",{className:"flex items-center mt-[20px] md:mt-0 space-x-[10px]",children:[o.jsx("a",{href:"mailto:datnh0708@gmail.com",children:o.jsx("svg",{className:t.icon,fill:"currentColor",viewBox:"0 0 32 32",xmlns:"http://www.w3.org/2000/svg",children:o.jsxs("g",{children:[o.jsx("path",{d:"M16.601 14.648v4.105h9.813c-0.162 2.008-0.982 3.798-2.243 5.18l0.006-0.007c-1.825 1.86-4.364 3.012-7.172 3.012-0.142 0-0.283-0.003-0.424-0.009l0.020 0.001c-5.946-0.003-10.765-4.823-10.765-10.77 0-0.051 0-0.102 0.001-0.152l-0 0.008c-0.001-0.043-0.001-0.094-0.001-0.145 0-5.946 4.819-10.767 10.765-10.77h0c0.040-0.001 0.087-0.001 0.135-0.001 2.822 0 5.383 1.121 7.262 2.941l-0.003-0.003 2.888-2.888c-2.568-2.578-6.121-4.174-10.047-4.174-0.082 0-0.164 0.001-0.246 0.002l0.012-0c-0.002 0-0.005 0-0.008 0-8.337 0-15.11 6.699-15.228 15.009l-0 0.011c0.118 8.32 6.891 15.020 15.228 15.020 0.003 0 0.006 0 0.009 0h-0c0.169 0.007 0.367 0.012 0.566 0.012 3.892 0 7.407-1.616 9.91-4.213l0.004-0.004c2.208-2.408 3.561-5.63 3.561-9.169 0-0.15-0.002-0.3-0.007-0.449l0.001 0.022c0.001-0.054 0.001-0.119 0.001-0.183 0-0.844-0.079-1.669-0.231-2.469l0.013 0.082z"})," "]})})}),o.jsx("a",{href:"https://github.com/d4t06",target:"_blank",children:o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t.icon,fill:"currentColor",viewBox:"0 0 496 512",children:o.jsx("path",{d:"M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"})})}),o.jsx("a",{href:"https://www.linkedin.com/in/dat-nguyen-huu-9371a926a",target:"_blank",children:o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t.icon,viewBox:"0 0 448 512",fill:"currentColor",children:o.jsx("path",{d:"M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"})})})]})]})}const l3=()=>{const[t,e]=m.useState(null),[n,r]=m.useState(!0),s=m.useRef(!1);return{user:t,setUser:e,loading:n,setLoading:r,updateUserData:a=>{e(l=>l?{...l,...a}:null)},justRegistered:s}},jT=m.createContext(null);function he(){const t=m.useContext(jT);if(!t)throw new Error("auth context not Provided");return t}function c3({children:t}){return o.jsx(jT.Provider,{value:l3(),children:t})}function u3(){const[t,e]=m.useState({songs:[],playlists:[]}),[n,r]=m.useState([]),[s,i]=m.useState([]),[a,l]=m.useState([]),[c,u]=m.useState([]),d=m.useRef(!0),f=m.useRef(!0),p=m.useRef(!0),g=m.useRef(!0);return{uploadedSongs:n,setUploadedSongs:r,playlists:a,setPlaylists:l,favoriteSongs:s,setFavoriteSongs:i,sysSongPlaylist:t,setSysSongPlaylist:e,shouldFetchUserSongs:d,shouldFetchUserPlaylists:p,shouldFetchFavoriteSongs:f,updateSong:_=>{const b=[...n],E=b.findIndex(w=>w.id===_.id);if(E!==-1){const w={...b[E]};Object.assign(w,_.song),b[E]=w,r(b)}},singers:c,setSingers:u,shouldFetchUserSingers:g}}const RT=m.createContext(null);function d3({children:t}){return o.jsx(RT.Provider,{value:u3(),children:t})}const Fn=()=>{const t=m.useContext(RT);if(!t)throw new Error("SongContext not provided");return t},qh=[{name:"Red",id:"red",type:"dark",bottom_player_bg:"bg-[#3b1113]",side_bar_bg:"bg-[#391b1c]",content_text:"text-[#ca4954]",content_hover_text:"hover:text-[#ca4954]",content_border:"border-[#ca4954]",content_hover_border:"hover:border-[#ca4954]",content_bg:"bg-[#ca4954] text-[#fff]",modal_bg:"bg-[#4f171c]",content_code:"#ca4954",content_hover_bg:"hover:!bg-[#ca4954] hover:text-[#fff] ",container:"bg-[#2e0f10]",container_code:"#2e0f10",text_color:""},{name:"Black",id:"black",type:"dark",bottom_player_bg:"bg-[#181818]",side_bar_bg:"bg-[#242424]",content_text:"text-[#198585]",content_hover_text:"hover:text-[#198585]",content_border:"border-[#198585]",content_hover_border:"hover:border-[#198585]",content_bg:"bg-[#198585]  text-[#fff]",modal_bg:"bg-[#333]",content_code:"#198585",content_hover_bg:"hover:!bg-[#198585] hover:text-[#fff] ",container:"bg-[#1e1e1e]",container_code:"#1e1e1e",text_color:""},{name:"Deep blue",id:"deep_blue",type:"dark",bottom_player_bg:"bg-[#111f3b]",side_bar_bg:"bg-[#1b2639]",content_text:"text-[#0c9e85]",content_hover_text:"hover:text-[#0c9e85]",content_border:"border-[#0c9e85]",content_hover_border:"hover:border-[#0c9e85]",content_bg:"bg-[#0c9e85]  text-[#fff]",modal_bg:"bg-[#05473c]",content_code:"#0c9e85",content_hover_bg:"hover:!bg-[#0c9e85] hover:text-[#fff] ",container:"bg-[#0f1a2e]",container_code:"#0f1a2e",text_color:""},{name:"White",id:"white",type:"light",bottom_player_bg:"bg-[#fff]",side_bar_bg:"bg-[#f2f2f2]",content_text:"text-[#198585]",content_hover_text:"hover:text-[#198585]",content_border:"border-[#198585]",content_hover_border:"hover:border-[#198585]",content_bg:"bg-[#198585] text-[#fff]",modal_bg:"bg-[#105656]",content_code:"#198585",content_hover_bg:"hover:!bg-[#198585] hover:text-[#fff]",container:"bg-[#fff]",container_code:"#fff",text_color:""},{name:"Light green",id:"green_light",type:"light",bottom_player_bg:"bg-[#c0d8d8]",side_bar_bg:"bg-[#dde5e5]",content_text:"text-[#198585]",content_hover_text:"hover:text-[#198585]",content_border:"border-[#198585]",content_hover_border:"hover:border-[#198585]",content_bg:"bg-[#198585] text-[#fff]",modal_bg:"bg-[#105656]",content_code:"#198585",content_hover_bg:"hover:!bg-[#198585] hover:text-[#fff]",container:"bg-[#ced9d9]",container_code:"#ced9d9",text_color:""},{name:"Brown",id:"gray",type:"light",bottom_player_bg:"bg-[#dedad1]",side_bar_bg:"bg-[#d9d7d4]",content_text:"text-[#644646]",content_hover_text:"hover:text-[#644646]",content_border:"border-[#644646]",content_hover_border:"hover:border-[#644646]",content_bg:"bg-[#644646]  text-[#fff]",modal_bg:"bg-[#3c2a2a]",content_code:"#644646",content_hover_bg:"hover:!bg-[#644646] hover:text-[#fff]",container:"bg-white",container_code:"#fff",text_color:""}],h3={name:"dashboard",id:"dashboard",type:"light",bottom_player_bg:"bg-[#fff]",side_bar_bg:"bg-[#f2f2f2]",content_text:"text-[#5a9e87]",content_hover_text:"hover:text-[#5a9e87]",content_border:"border-[#5a9e87]",content_hover_border:"hover:border-[#5a9e87]",content_bg:"bg-[#5a9e87] text-[#fff]",modal_bg:"bg-[#417161]",content_code:"#5a9e87",content_hover_bg:"hover:!bg-[#5a9e87] hover:text-[#fff]",container:"bg-[#fff]",container_code:"#fff",text_color:""},AT=[{name:"Tet",id:"tet",type:"light",bottom_player_bg:"bg-[#fdf6e3]",side_bar_bg:"bg-[#fdf6e3]",content_text:"text-[#644646]",content_hover_text:"hover:text-[#644646]",content_border:"border-[#644646]",content_hover_border:"hover:border-[#644646]",content_bg:"bg-[#644646]  text-[#fff]",modal_bg:"bg-[#3c2a2a]",content_code:"#644646",content_hover_bg:"hover:!bg-[#644646] hover:text-[#fff]",container:"bg-[#f7f0de]",container_code:"#fdf6e3",text_color:"",image:"tet_theme_image.png"}];function NT(t,e){return function(){return t.apply(e,arguments)}}const{toString:f3}=Object.prototype,{getPrototypeOf:Py}=Object,Jf=(t=>e=>{const n=f3.call(e);return t[n]||(t[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),Hr=t=>(t=t.toLowerCase(),e=>Jf(e)===t),Zf=t=>e=>typeof e===t,{isArray:ll}=Array,Wc=Zf("undefined");function m3(t){return t!==null&&!Wc(t)&&t.constructor!==null&&!Wc(t.constructor)&&Xn(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const PT=Hr("ArrayBuffer");function p3(t){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&PT(t.buffer),e}const g3=Zf("string"),Xn=Zf("function"),FT=Zf("number"),em=t=>t!==null&&typeof t=="object",x3=t=>t===!0||t===!1,sh=t=>{if(Jf(t)!=="object")return!1;const e=Py(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},y3=Hr("Date"),v3=Hr("File"),w3=Hr("Blob"),_3=Hr("FileList"),b3=t=>em(t)&&Xn(t.pipe),S3=t=>{let e;return t&&(typeof FormData=="function"&&t instanceof FormData||Xn(t.append)&&((e=Jf(t))==="formdata"||e==="object"&&Xn(t.toString)&&t.toString()==="[object FormData]"))},E3=Hr("URLSearchParams"),[k3,T3,I3,C3]=["ReadableStream","Request","Response","Headers"].map(Hr),j3=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function yu(t,e,{allOwnKeys:n=!1}={}){if(t===null||typeof t>"u")return;let r,s;if(typeof t!="object"&&(t=[t]),ll(t))for(r=0,s=t.length;r<s;r++)e.call(null,t[r],r,t);else{const i=n?Object.getOwnPropertyNames(t):Object.keys(t),a=i.length;let l;for(r=0;r<a;r++)l=i[r],e.call(null,t[l],l,t)}}function DT(t,e){e=e.toLowerCase();const n=Object.keys(t);let r=n.length,s;for(;r-- >0;)if(s=n[r],e===s.toLowerCase())return s;return null}const ya=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),LT=t=>!Wc(t)&&t!==ya;function C0(){const{caseless:t}=LT(this)&&this||{},e={},n=(r,s)=>{const i=t&&DT(e,s)||s;sh(e[i])&&sh(r)?e[i]=C0(e[i],r):sh(r)?e[i]=C0({},r):ll(r)?e[i]=r.slice():e[i]=r};for(let r=0,s=arguments.length;r<s;r++)arguments[r]&&yu(arguments[r],n);return e}const R3=(t,e,n,{allOwnKeys:r}={})=>(yu(e,(s,i)=>{n&&Xn(s)?t[i]=NT(s,n):t[i]=s},{allOwnKeys:r}),t),A3=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),N3=(t,e,n,r)=>{t.prototype=Object.create(e.prototype,r),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),n&&Object.assign(t.prototype,n)},P3=(t,e,n,r)=>{let s,i,a;const l={};if(e=e||{},t==null)return e;do{for(s=Object.getOwnPropertyNames(t),i=s.length;i-- >0;)a=s[i],(!r||r(a,t,e))&&!l[a]&&(e[a]=t[a],l[a]=!0);t=n!==!1&&Py(t)}while(t&&(!n||n(t,e))&&t!==Object.prototype);return e},F3=(t,e,n)=>{t=String(t),(n===void 0||n>t.length)&&(n=t.length),n-=e.length;const r=t.indexOf(e,n);return r!==-1&&r===n},D3=t=>{if(!t)return null;if(ll(t))return t;let e=t.length;if(!FT(e))return null;const n=new Array(e);for(;e-- >0;)n[e]=t[e];return n},L3=(t=>e=>t&&e instanceof t)(typeof Uint8Array<"u"&&Py(Uint8Array)),M3=(t,e)=>{const r=(t&&t[Symbol.iterator]).call(t);let s;for(;(s=r.next())&&!s.done;){const i=s.value;e.call(t,i[0],i[1])}},O3=(t,e)=>{let n;const r=[];for(;(n=t.exec(e))!==null;)r.push(n);return r},$3=Hr("HTMLFormElement"),B3=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,r,s){return r.toUpperCase()+s}),hb=(({hasOwnProperty:t})=>(e,n)=>t.call(e,n))(Object.prototype),z3=Hr("RegExp"),MT=(t,e)=>{const n=Object.getOwnPropertyDescriptors(t),r={};yu(n,(s,i)=>{let a;(a=e(s,i,t))!==!1&&(r[i]=a||s)}),Object.defineProperties(t,r)},U3=t=>{MT(t,(e,n)=>{if(Xn(t)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const r=t[n];if(Xn(r)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},V3=(t,e)=>{const n={},r=s=>{s.forEach(i=>{n[i]=!0})};return ll(t)?r(t):r(String(t).split(e)),n},H3=()=>{},W3=(t,e)=>t!=null&&Number.isFinite(t=+t)?t:e;function q3(t){return!!(t&&Xn(t.append)&&t[Symbol.toStringTag]==="FormData"&&t[Symbol.iterator])}const G3=t=>{const e=new Array(10),n=(r,s)=>{if(em(r)){if(e.indexOf(r)>=0)return;if(!("toJSON"in r)){e[s]=r;const i=ll(r)?[]:{};return yu(r,(a,l)=>{const c=n(a,s+1);!Wc(c)&&(i[l]=c)}),e[s]=void 0,i}}return r};return n(t,0)},Q3=Hr("AsyncFunction"),K3=t=>t&&(em(t)||Xn(t))&&Xn(t.then)&&Xn(t.catch),OT=((t,e)=>t?setImmediate:e?((n,r)=>(ya.addEventListener("message",({source:s,data:i})=>{s===ya&&i===n&&r.length&&r.shift()()},!1),s=>{r.push(s),ya.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",Xn(ya.postMessage)),X3=typeof queueMicrotask<"u"?queueMicrotask.bind(ya):typeof process<"u"&&process.nextTick||OT,O={isArray:ll,isArrayBuffer:PT,isBuffer:m3,isFormData:S3,isArrayBufferView:p3,isString:g3,isNumber:FT,isBoolean:x3,isObject:em,isPlainObject:sh,isReadableStream:k3,isRequest:T3,isResponse:I3,isHeaders:C3,isUndefined:Wc,isDate:y3,isFile:v3,isBlob:w3,isRegExp:z3,isFunction:Xn,isStream:b3,isURLSearchParams:E3,isTypedArray:L3,isFileList:_3,forEach:yu,merge:C0,extend:R3,trim:j3,stripBOM:A3,inherits:N3,toFlatObject:P3,kindOf:Jf,kindOfTest:Hr,endsWith:F3,toArray:D3,forEachEntry:M3,matchAll:O3,isHTMLForm:$3,hasOwnProperty:hb,hasOwnProp:hb,reduceDescriptors:MT,freezeMethods:U3,toObjectSet:V3,toCamelCase:B3,noop:H3,toFiniteNumber:W3,findKey:DT,global:ya,isContextDefined:LT,isSpecCompliantForm:q3,toJSONObject:G3,isAsyncFn:Q3,isThenable:K3,setImmediate:OT,asap:X3};function fe(t,e,n,r,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",e&&(this.code=e),n&&(this.config=n),r&&(this.request=r),s&&(this.response=s,this.status=s.status?s.status:null)}O.inherits(fe,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:O.toJSONObject(this.config),code:this.code,status:this.status}}});const $T=fe.prototype,BT={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{BT[t]={value:t}});Object.defineProperties(fe,BT);Object.defineProperty($T,"isAxiosError",{value:!0});fe.from=(t,e,n,r,s,i)=>{const a=Object.create($T);return O.toFlatObject(t,a,function(c){return c!==Error.prototype},l=>l!=="isAxiosError"),fe.call(a,t.message,e,n,r,s),a.cause=t,a.name=t.name,i&&Object.assign(a,i),a};const Y3=null;function j0(t){return O.isPlainObject(t)||O.isArray(t)}function zT(t){return O.endsWith(t,"[]")?t.slice(0,-2):t}function fb(t,e,n){return t?t.concat(e).map(function(s,i){return s=zT(s),!n&&i?"["+s+"]":s}).join(n?".":""):e}function J3(t){return O.isArray(t)&&!t.some(j0)}const Z3=O.toFlatObject(O,{},null,function(e){return/^is[A-Z]/.test(e)});function tm(t,e,n){if(!O.isObject(t))throw new TypeError("target must be an object");e=e||new FormData,n=O.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(_,b){return!O.isUndefined(b[_])});const r=n.metaTokens,s=n.visitor||d,i=n.dots,a=n.indexes,c=(n.Blob||typeof Blob<"u"&&Blob)&&O.isSpecCompliantForm(e);if(!O.isFunction(s))throw new TypeError("visitor must be a function");function u(v){if(v===null)return"";if(O.isDate(v))return v.toISOString();if(!c&&O.isBlob(v))throw new fe("Blob is not supported. Use a Buffer instead.");return O.isArrayBuffer(v)||O.isTypedArray(v)?c&&typeof Blob=="function"?new Blob([v]):Buffer.from(v):v}function d(v,_,b){let E=v;if(v&&!b&&typeof v=="object"){if(O.endsWith(_,"{}"))_=r?_:_.slice(0,-2),v=JSON.stringify(v);else if(O.isArray(v)&&J3(v)||(O.isFileList(v)||O.endsWith(_,"[]"))&&(E=O.toArray(v)))return _=zT(_),E.forEach(function(S,I){!(O.isUndefined(S)||S===null)&&e.append(a===!0?fb([_],I,i):a===null?_:_+"[]",u(S))}),!1}return j0(v)?!0:(e.append(fb(b,_,i),u(v)),!1)}const f=[],p=Object.assign(Z3,{defaultVisitor:d,convertValue:u,isVisitable:j0});function g(v,_){if(!O.isUndefined(v)){if(f.indexOf(v)!==-1)throw Error("Circular reference detected in "+_.join("."));f.push(v),O.forEach(v,function(E,w){(!(O.isUndefined(E)||E===null)&&s.call(e,E,O.isString(w)?w.trim():w,_,p))===!0&&g(E,_?_.concat(w):[w])}),f.pop()}}if(!O.isObject(t))throw new TypeError("data must be an object");return g(t),e}function mb(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(r){return e[r]})}function Fy(t,e){this._pairs=[],t&&tm(t,this,e)}const UT=Fy.prototype;UT.append=function(e,n){this._pairs.push([e,n])};UT.toString=function(e){const n=e?function(r){return e.call(this,r,mb)}:mb;return this._pairs.map(function(s){return n(s[0])+"="+n(s[1])},"").join("&")};function eF(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function VT(t,e,n){if(!e)return t;const r=n&&n.encode||eF;O.isFunction(n)&&(n={serialize:n});const s=n&&n.serialize;let i;if(s?i=s(e,n):i=O.isURLSearchParams(e)?e.toString():new Fy(e,n).toString(r),i){const a=t.indexOf("#");a!==-1&&(t=t.slice(0,a)),t+=(t.indexOf("?")===-1?"?":"&")+i}return t}class tF{constructor(){this.handlers=[]}use(e,n,r){return this.handlers.push({fulfilled:e,rejected:n,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){O.forEach(this.handlers,function(r){r!==null&&e(r)})}}const pb=tF,HT={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},nF=typeof URLSearchParams<"u"?URLSearchParams:Fy,rF=typeof FormData<"u"?FormData:null,sF=typeof Blob<"u"?Blob:null,iF={isBrowser:!0,classes:{URLSearchParams:nF,FormData:rF,Blob:sF},protocols:["http","https","file","blob","url","data"]},Dy=typeof window<"u"&&typeof document<"u",R0=typeof navigator=="object"&&navigator||void 0,aF=Dy&&(!R0||["ReactNative","NativeScript","NS"].indexOf(R0.product)<0),oF=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),lF=Dy&&window.location.href||"http://localhost",cF=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Dy,hasStandardBrowserEnv:aF,hasStandardBrowserWebWorkerEnv:oF,navigator:R0,origin:lF},Symbol.toStringTag,{value:"Module"})),nn={...cF,...iF};function uF(t,e){return tm(t,new nn.classes.URLSearchParams,Object.assign({visitor:function(n,r,s,i){return nn.isNode&&O.isBuffer(n)?(this.append(r,n.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)}},e))}function dF(t){return O.matchAll(/\w+|\[(\w*)]/g,t).map(e=>e[0]==="[]"?"":e[1]||e[0])}function hF(t){const e={},n=Object.keys(t);let r;const s=n.length;let i;for(r=0;r<s;r++)i=n[r],e[i]=t[i];return e}function WT(t){function e(n,r,s,i){let a=n[i++];if(a==="__proto__")return!0;const l=Number.isFinite(+a),c=i>=n.length;return a=!a&&O.isArray(s)?s.length:a,c?(O.hasOwnProp(s,a)?s[a]=[s[a],r]:s[a]=r,!l):((!s[a]||!O.isObject(s[a]))&&(s[a]=[]),e(n,r,s[a],i)&&O.isArray(s[a])&&(s[a]=hF(s[a])),!l)}if(O.isFormData(t)&&O.isFunction(t.entries)){const n={};return O.forEachEntry(t,(r,s)=>{e(dF(r),s,n,0)}),n}return null}function fF(t,e,n){if(O.isString(t))try{return(e||JSON.parse)(t),O.trim(t)}catch(r){if(r.name!=="SyntaxError")throw r}return(n||JSON.stringify)(t)}const Ly={transitional:HT,adapter:["xhr","http","fetch"],transformRequest:[function(e,n){const r=n.getContentType()||"",s=r.indexOf("application/json")>-1,i=O.isObject(e);if(i&&O.isHTMLForm(e)&&(e=new FormData(e)),O.isFormData(e))return s?JSON.stringify(WT(e)):e;if(O.isArrayBuffer(e)||O.isBuffer(e)||O.isStream(e)||O.isFile(e)||O.isBlob(e)||O.isReadableStream(e))return e;if(O.isArrayBufferView(e))return e.buffer;if(O.isURLSearchParams(e))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let l;if(i){if(r.indexOf("application/x-www-form-urlencoded")>-1)return uF(e,this.formSerializer).toString();if((l=O.isFileList(e))||r.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return tm(l?{"files[]":e}:e,c&&new c,this.formSerializer)}}return i||s?(n.setContentType("application/json",!1),fF(e)):e}],transformResponse:[function(e){const n=this.transitional||Ly.transitional,r=n&&n.forcedJSONParsing,s=this.responseType==="json";if(O.isResponse(e)||O.isReadableStream(e))return e;if(e&&O.isString(e)&&(r&&!this.responseType||s)){const a=!(n&&n.silentJSONParsing)&&s;try{return JSON.parse(e)}catch(l){if(a)throw l.name==="SyntaxError"?fe.from(l,fe.ERR_BAD_RESPONSE,this,null,this.response):l}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:nn.classes.FormData,Blob:nn.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};O.forEach(["delete","get","head","post","put","patch"],t=>{Ly.headers[t]={}});const My=Ly,mF=O.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),pF=t=>{const e={};let n,r,s;return t&&t.split(`
`).forEach(function(a){s=a.indexOf(":"),n=a.substring(0,s).trim().toLowerCase(),r=a.substring(s+1).trim(),!(!n||e[n]&&mF[n])&&(n==="set-cookie"?e[n]?e[n].push(r):e[n]=[r]:e[n]=e[n]?e[n]+", "+r:r)}),e},gb=Symbol("internals");function Kl(t){return t&&String(t).trim().toLowerCase()}function ih(t){return t===!1||t==null?t:O.isArray(t)?t.map(ih):String(t)}function gF(t){const e=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(t);)e[r[1]]=r[2];return e}const xF=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function zp(t,e,n,r,s){if(O.isFunction(r))return r.call(this,e,n);if(s&&(e=n),!!O.isString(e)){if(O.isString(r))return e.indexOf(r)!==-1;if(O.isRegExp(r))return r.test(e)}}function yF(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,n,r)=>n.toUpperCase()+r)}function vF(t,e){const n=O.toCamelCase(" "+e);["get","set","has"].forEach(r=>{Object.defineProperty(t,r+n,{value:function(s,i,a){return this[r].call(this,e,s,i,a)},configurable:!0})})}class nm{constructor(e){e&&this.set(e)}set(e,n,r){const s=this;function i(l,c,u){const d=Kl(c);if(!d)throw new Error("header name must be a non-empty string");const f=O.findKey(s,d);(!f||s[f]===void 0||u===!0||u===void 0&&s[f]!==!1)&&(s[f||c]=ih(l))}const a=(l,c)=>O.forEach(l,(u,d)=>i(u,d,c));if(O.isPlainObject(e)||e instanceof this.constructor)a(e,n);else if(O.isString(e)&&(e=e.trim())&&!xF(e))a(pF(e),n);else if(O.isHeaders(e))for(const[l,c]of e.entries())i(c,l,r);else e!=null&&i(n,e,r);return this}get(e,n){if(e=Kl(e),e){const r=O.findKey(this,e);if(r){const s=this[r];if(!n)return s;if(n===!0)return gF(s);if(O.isFunction(n))return n.call(this,s,r);if(O.isRegExp(n))return n.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,n){if(e=Kl(e),e){const r=O.findKey(this,e);return!!(r&&this[r]!==void 0&&(!n||zp(this,this[r],r,n)))}return!1}delete(e,n){const r=this;let s=!1;function i(a){if(a=Kl(a),a){const l=O.findKey(r,a);l&&(!n||zp(r,r[l],l,n))&&(delete r[l],s=!0)}}return O.isArray(e)?e.forEach(i):i(e),s}clear(e){const n=Object.keys(this);let r=n.length,s=!1;for(;r--;){const i=n[r];(!e||zp(this,this[i],i,e,!0))&&(delete this[i],s=!0)}return s}normalize(e){const n=this,r={};return O.forEach(this,(s,i)=>{const a=O.findKey(r,i);if(a){n[a]=ih(s),delete n[i];return}const l=e?yF(i):String(i).trim();l!==i&&delete n[i],n[l]=ih(s),r[l]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const n=Object.create(null);return O.forEach(this,(r,s)=>{r!=null&&r!==!1&&(n[s]=e&&O.isArray(r)?r.join(", "):r)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,n])=>e+": "+n).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...n){const r=new this(e);return n.forEach(s=>r.set(s)),r}static accessor(e){const r=(this[gb]=this[gb]={accessors:{}}).accessors,s=this.prototype;function i(a){const l=Kl(a);r[l]||(vF(s,a),r[l]=!0)}return O.isArray(e)?e.forEach(i):i(e),this}}nm.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);O.reduceDescriptors(nm.prototype,({value:t},e)=>{let n=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(r){this[n]=r}}});O.freezeMethods(nm);const Or=nm;function Up(t,e){const n=this||My,r=e||n,s=Or.from(r.headers);let i=r.data;return O.forEach(t,function(l){i=l.call(n,i,s.normalize(),e?e.status:void 0)}),s.normalize(),i}function qT(t){return!!(t&&t.__CANCEL__)}function cl(t,e,n){fe.call(this,t??"canceled",fe.ERR_CANCELED,e,n),this.name="CanceledError"}O.inherits(cl,fe,{__CANCEL__:!0});function GT(t,e,n){const r=n.config.validateStatus;!n.status||!r||r(n.status)?t(n):e(new fe("Request failed with status code "+n.status,[fe.ERR_BAD_REQUEST,fe.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function wF(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}function _F(t,e){t=t||10;const n=new Array(t),r=new Array(t);let s=0,i=0,a;return e=e!==void 0?e:1e3,function(c){const u=Date.now(),d=r[i];a||(a=u),n[s]=c,r[s]=u;let f=i,p=0;for(;f!==s;)p+=n[f++],f=f%t;if(s=(s+1)%t,s===i&&(i=(i+1)%t),u-a<e)return;const g=d&&u-d;return g?Math.round(p*1e3/g):void 0}}function bF(t,e){let n=0,r=1e3/e,s,i;const a=(u,d=Date.now())=>{n=d,s=null,i&&(clearTimeout(i),i=null),t.apply(null,u)};return[(...u)=>{const d=Date.now(),f=d-n;f>=r?a(u,d):(s=u,i||(i=setTimeout(()=>{i=null,a(s)},r-f)))},()=>s&&a(s)]}const Gh=(t,e,n=3)=>{let r=0;const s=_F(50,250);return bF(i=>{const a=i.loaded,l=i.lengthComputable?i.total:void 0,c=a-r,u=s(c),d=a<=l;r=a;const f={loaded:a,total:l,progress:l?a/l:void 0,bytes:c,rate:u||void 0,estimated:u&&l&&d?(l-a)/u:void 0,event:i,lengthComputable:l!=null,[e?"download":"upload"]:!0};t(f)},n)},xb=(t,e)=>{const n=t!=null;return[r=>e[0]({lengthComputable:n,total:t,loaded:r}),e[1]]},yb=t=>(...e)=>O.asap(()=>t(...e)),SF=nn.hasStandardBrowserEnv?((t,e)=>n=>(n=new URL(n,nn.origin),t.protocol===n.protocol&&t.host===n.host&&(e||t.port===n.port)))(new URL(nn.origin),nn.navigator&&/(msie|trident)/i.test(nn.navigator.userAgent)):()=>!0,EF=nn.hasStandardBrowserEnv?{write(t,e,n,r,s,i){const a=[t+"="+encodeURIComponent(e)];O.isNumber(n)&&a.push("expires="+new Date(n).toGMTString()),O.isString(r)&&a.push("path="+r),O.isString(s)&&a.push("domain="+s),i===!0&&a.push("secure"),document.cookie=a.join("; ")},read(t){const e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function kF(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function TF(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}function QT(t,e,n){let r=!kF(e);return t&&r||n==!1?TF(t,e):e}const vb=t=>t instanceof Or?{...t}:t;function Aa(t,e){e=e||{};const n={};function r(u,d,f,p){return O.isPlainObject(u)&&O.isPlainObject(d)?O.merge.call({caseless:p},u,d):O.isPlainObject(d)?O.merge({},d):O.isArray(d)?d.slice():d}function s(u,d,f,p){if(O.isUndefined(d)){if(!O.isUndefined(u))return r(void 0,u,f,p)}else return r(u,d,f,p)}function i(u,d){if(!O.isUndefined(d))return r(void 0,d)}function a(u,d){if(O.isUndefined(d)){if(!O.isUndefined(u))return r(void 0,u)}else return r(void 0,d)}function l(u,d,f){if(f in e)return r(u,d);if(f in t)return r(void 0,u)}const c={url:i,method:i,data:i,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,withXSRFToken:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:l,headers:(u,d,f)=>s(vb(u),vb(d),f,!0)};return O.forEach(Object.keys(Object.assign({},t,e)),function(d){const f=c[d]||s,p=f(t[d],e[d],d);O.isUndefined(p)&&f!==l||(n[d]=p)}),n}const KT=t=>{const e=Aa({},t);let{data:n,withXSRFToken:r,xsrfHeaderName:s,xsrfCookieName:i,headers:a,auth:l}=e;e.headers=a=Or.from(a),e.url=VT(QT(e.baseURL,e.url),t.params,t.paramsSerializer),l&&a.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):"")));let c;if(O.isFormData(n)){if(nn.hasStandardBrowserEnv||nn.hasStandardBrowserWebWorkerEnv)a.setContentType(void 0);else if((c=a.getContentType())!==!1){const[u,...d]=c?c.split(";").map(f=>f.trim()).filter(Boolean):[];a.setContentType([u||"multipart/form-data",...d].join("; "))}}if(nn.hasStandardBrowserEnv&&(r&&O.isFunction(r)&&(r=r(e)),r||r!==!1&&SF(e.url))){const u=s&&i&&EF.read(i);u&&a.set(s,u)}return e},IF=typeof XMLHttpRequest<"u",CF=IF&&function(t){return new Promise(function(n,r){const s=KT(t);let i=s.data;const a=Or.from(s.headers).normalize();let{responseType:l,onUploadProgress:c,onDownloadProgress:u}=s,d,f,p,g,v;function _(){g&&g(),v&&v(),s.cancelToken&&s.cancelToken.unsubscribe(d),s.signal&&s.signal.removeEventListener("abort",d)}let b=new XMLHttpRequest;b.open(s.method.toUpperCase(),s.url,!0),b.timeout=s.timeout;function E(){if(!b)return;const S=Or.from("getAllResponseHeaders"in b&&b.getAllResponseHeaders()),F={data:!l||l==="text"||l==="json"?b.responseText:b.response,status:b.status,statusText:b.statusText,headers:S,config:t,request:b};GT(function(C){n(C),_()},function(C){r(C),_()},F),b=null}"onloadend"in b?b.onloadend=E:b.onreadystatechange=function(){!b||b.readyState!==4||b.status===0&&!(b.responseURL&&b.responseURL.indexOf("file:")===0)||setTimeout(E)},b.onabort=function(){b&&(r(new fe("Request aborted",fe.ECONNABORTED,t,b)),b=null)},b.onerror=function(){r(new fe("Network Error",fe.ERR_NETWORK,t,b)),b=null},b.ontimeout=function(){let I=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const F=s.transitional||HT;s.timeoutErrorMessage&&(I=s.timeoutErrorMessage),r(new fe(I,F.clarifyTimeoutError?fe.ETIMEDOUT:fe.ECONNABORTED,t,b)),b=null},i===void 0&&a.setContentType(null),"setRequestHeader"in b&&O.forEach(a.toJSON(),function(I,F){b.setRequestHeader(F,I)}),O.isUndefined(s.withCredentials)||(b.withCredentials=!!s.withCredentials),l&&l!=="json"&&(b.responseType=s.responseType),u&&([p,v]=Gh(u,!0),b.addEventListener("progress",p)),c&&b.upload&&([f,g]=Gh(c),b.upload.addEventListener("progress",f),b.upload.addEventListener("loadend",g)),(s.cancelToken||s.signal)&&(d=S=>{b&&(r(!S||S.type?new cl(null,t,b):S),b.abort(),b=null)},s.cancelToken&&s.cancelToken.subscribe(d),s.signal&&(s.signal.aborted?d():s.signal.addEventListener("abort",d)));const w=wF(s.url);if(w&&nn.protocols.indexOf(w)===-1){r(new fe("Unsupported protocol "+w+":",fe.ERR_BAD_REQUEST,t));return}b.send(i||null)})},jF=(t,e)=>{const{length:n}=t=t?t.filter(Boolean):[];if(e||n){let r=new AbortController,s;const i=function(u){if(!s){s=!0,l();const d=u instanceof Error?u:this.reason;r.abort(d instanceof fe?d:new cl(d instanceof Error?d.message:d))}};let a=e&&setTimeout(()=>{a=null,i(new fe(`timeout ${e} of ms exceeded`,fe.ETIMEDOUT))},e);const l=()=>{t&&(a&&clearTimeout(a),a=null,t.forEach(u=>{u.unsubscribe?u.unsubscribe(i):u.removeEventListener("abort",i)}),t=null)};t.forEach(u=>u.addEventListener("abort",i));const{signal:c}=r;return c.unsubscribe=()=>O.asap(l),c}},RF=jF,AF=function*(t,e){let n=t.byteLength;if(!e||n<e){yield t;return}let r=0,s;for(;r<n;)s=r+e,yield t.slice(r,s),r=s},NF=async function*(t,e){for await(const n of PF(t))yield*AF(n,e)},PF=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const e=t.getReader();try{for(;;){const{done:n,value:r}=await e.read();if(n)break;yield r}}finally{await e.cancel()}},wb=(t,e,n,r)=>{const s=NF(t,e);let i=0,a,l=c=>{a||(a=!0,r&&r(c))};return new ReadableStream({async pull(c){try{const{done:u,value:d}=await s.next();if(u){l(),c.close();return}let f=d.byteLength;if(n){let p=i+=f;n(p)}c.enqueue(new Uint8Array(d))}catch(u){throw l(u),u}},cancel(c){return l(c),s.return()}},{highWaterMark:2})},rm=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",XT=rm&&typeof ReadableStream=="function",FF=rm&&(typeof TextEncoder=="function"?(t=>e=>t.encode(e))(new TextEncoder):async t=>new Uint8Array(await new Response(t).arrayBuffer())),YT=(t,...e)=>{try{return!!t(...e)}catch{return!1}},DF=XT&&YT(()=>{let t=!1;const e=new Request(nn.origin,{body:new ReadableStream,method:"POST",get duplex(){return t=!0,"half"}}).headers.has("Content-Type");return t&&!e}),_b=64*1024,A0=XT&&YT(()=>O.isReadableStream(new Response("").body)),Qh={stream:A0&&(t=>t.body)};rm&&(t=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!Qh[e]&&(Qh[e]=O.isFunction(t[e])?n=>n[e]():(n,r)=>{throw new fe(`Response type '${e}' is not supported`,fe.ERR_NOT_SUPPORT,r)})})})(new Response);const LF=async t=>{if(t==null)return 0;if(O.isBlob(t))return t.size;if(O.isSpecCompliantForm(t))return(await new Request(nn.origin,{method:"POST",body:t}).arrayBuffer()).byteLength;if(O.isArrayBufferView(t)||O.isArrayBuffer(t))return t.byteLength;if(O.isURLSearchParams(t)&&(t=t+""),O.isString(t))return(await FF(t)).byteLength},MF=async(t,e)=>{const n=O.toFiniteNumber(t.getContentLength());return n??LF(e)},OF=rm&&(async t=>{let{url:e,method:n,data:r,signal:s,cancelToken:i,timeout:a,onDownloadProgress:l,onUploadProgress:c,responseType:u,headers:d,withCredentials:f="same-origin",fetchOptions:p}=KT(t);u=u?(u+"").toLowerCase():"text";let g=RF([s,i&&i.toAbortSignal()],a),v;const _=g&&g.unsubscribe&&(()=>{g.unsubscribe()});let b;try{if(c&&DF&&n!=="get"&&n!=="head"&&(b=await MF(d,r))!==0){let F=new Request(e,{method:"POST",body:r,duplex:"half"}),D;if(O.isFormData(r)&&(D=F.headers.get("content-type"))&&d.setContentType(D),F.body){const[C,k]=xb(b,Gh(yb(c)));r=wb(F.body,_b,C,k)}}O.isString(f)||(f=f?"include":"omit");const E="credentials"in Request.prototype;v=new Request(e,{...p,signal:g,method:n.toUpperCase(),headers:d.normalize().toJSON(),body:r,duplex:"half",credentials:E?f:void 0});let w=await fetch(v);const S=A0&&(u==="stream"||u==="response");if(A0&&(l||S&&_)){const F={};["status","statusText","headers"].forEach(R=>{F[R]=w[R]});const D=O.toFiniteNumber(w.headers.get("content-length")),[C,k]=l&&xb(D,Gh(yb(l),!0))||[];w=new Response(wb(w.body,_b,C,()=>{k&&k(),_&&_()}),F)}u=u||"text";let I=await Qh[O.findKey(Qh,u)||"text"](w,t);return!S&&_&&_(),await new Promise((F,D)=>{GT(F,D,{data:I,headers:Or.from(w.headers),status:w.status,statusText:w.statusText,config:t,request:v})})}catch(E){throw _&&_(),E&&E.name==="TypeError"&&/fetch/i.test(E.message)?Object.assign(new fe("Network Error",fe.ERR_NETWORK,t,v),{cause:E.cause||E}):fe.from(E,E&&E.code,t,v)}}),N0={http:Y3,xhr:CF,fetch:OF};O.forEach(N0,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch{}Object.defineProperty(t,"adapterName",{value:e})}});const bb=t=>`- ${t}`,$F=t=>O.isFunction(t)||t===null||t===!1,JT={getAdapter:t=>{t=O.isArray(t)?t:[t];const{length:e}=t;let n,r;const s={};for(let i=0;i<e;i++){n=t[i];let a;if(r=n,!$F(n)&&(r=N0[(a=String(n)).toLowerCase()],r===void 0))throw new fe(`Unknown adapter '${a}'`);if(r)break;s[a||"#"+i]=r}if(!r){const i=Object.entries(s).map(([l,c])=>`adapter ${l} `+(c===!1?"is not supported by the environment":"is not available in the build"));let a=e?i.length>1?`since :
`+i.map(bb).join(`
`):" "+bb(i[0]):"as no adapter specified";throw new fe("There is no suitable adapter to dispatch the request "+a,"ERR_NOT_SUPPORT")}return r},adapters:N0};function Vp(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new cl(null,t)}function Sb(t){return Vp(t),t.headers=Or.from(t.headers),t.data=Up.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),JT.getAdapter(t.adapter||My.adapter)(t).then(function(r){return Vp(t),r.data=Up.call(t,t.transformResponse,r),r.headers=Or.from(r.headers),r},function(r){return qT(r)||(Vp(t),r&&r.response&&(r.response.data=Up.call(t,t.transformResponse,r.response),r.response.headers=Or.from(r.response.headers))),Promise.reject(r)})}const ZT="1.8.1",sm={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{sm[t]=function(r){return typeof r===t||"a"+(e<1?"n ":" ")+t}});const Eb={};sm.transitional=function(e,n,r){function s(i,a){return"[Axios v"+ZT+"] Transitional option '"+i+"'"+a+(r?". "+r:"")}return(i,a,l)=>{if(e===!1)throw new fe(s(a," has been removed"+(n?" in "+n:"")),fe.ERR_DEPRECATED);return n&&!Eb[a]&&(Eb[a]=!0,console.warn(s(a," has been deprecated since v"+n+" and will be removed in the near future"))),e?e(i,a,l):!0}};sm.spelling=function(e){return(n,r)=>(console.warn(`${r} is likely a misspelling of ${e}`),!0)};function BF(t,e,n){if(typeof t!="object")throw new fe("options must be an object",fe.ERR_BAD_OPTION_VALUE);const r=Object.keys(t);let s=r.length;for(;s-- >0;){const i=r[s],a=e[i];if(a){const l=t[i],c=l===void 0||a(l,i,t);if(c!==!0)throw new fe("option "+i+" must be "+c,fe.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new fe("Unknown option "+i,fe.ERR_BAD_OPTION)}}const ah={assertOptions:BF,validators:sm},Gr=ah.validators;class Kh{constructor(e){this.defaults=e,this.interceptors={request:new pb,response:new pb}}async request(e,n){try{return await this._request(e,n)}catch(r){if(r instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const i=s.stack?s.stack.replace(/^.+\n/,""):"";try{r.stack?i&&!String(r.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+i):r.stack=i}catch{}}throw r}}_request(e,n){typeof e=="string"?(n=n||{},n.url=e):n=e||{},n=Aa(this.defaults,n);const{transitional:r,paramsSerializer:s,headers:i}=n;r!==void 0&&ah.assertOptions(r,{silentJSONParsing:Gr.transitional(Gr.boolean),forcedJSONParsing:Gr.transitional(Gr.boolean),clarifyTimeoutError:Gr.transitional(Gr.boolean)},!1),s!=null&&(O.isFunction(s)?n.paramsSerializer={serialize:s}:ah.assertOptions(s,{encode:Gr.function,serialize:Gr.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),ah.assertOptions(n,{baseUrl:Gr.spelling("baseURL"),withXsrfToken:Gr.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let a=i&&O.merge(i.common,i[n.method]);i&&O.forEach(["delete","get","head","post","put","patch","common"],v=>{delete i[v]}),n.headers=Or.concat(a,i);const l=[];let c=!0;this.interceptors.request.forEach(function(_){typeof _.runWhen=="function"&&_.runWhen(n)===!1||(c=c&&_.synchronous,l.unshift(_.fulfilled,_.rejected))});const u=[];this.interceptors.response.forEach(function(_){u.push(_.fulfilled,_.rejected)});let d,f=0,p;if(!c){const v=[Sb.bind(this),void 0];for(v.unshift.apply(v,l),v.push.apply(v,u),p=v.length,d=Promise.resolve(n);f<p;)d=d.then(v[f++],v[f++]);return d}p=l.length;let g=n;for(f=0;f<p;){const v=l[f++],_=l[f++];try{g=v(g)}catch(b){_.call(this,b);break}}try{d=Sb.call(this,g)}catch(v){return Promise.reject(v)}for(f=0,p=u.length;f<p;)d=d.then(u[f++],u[f++]);return d}getUri(e){e=Aa(this.defaults,e);const n=QT(e.baseURL,e.url,e.allowAbsoluteUrls);return VT(n,e.params,e.paramsSerializer)}}O.forEach(["delete","get","head","options"],function(e){Kh.prototype[e]=function(n,r){return this.request(Aa(r||{},{method:e,url:n,data:(r||{}).data}))}});O.forEach(["post","put","patch"],function(e){function n(r){return function(i,a,l){return this.request(Aa(l||{},{method:e,headers:r?{"Content-Type":"multipart/form-data"}:{},url:i,data:a}))}}Kh.prototype[e]=n(),Kh.prototype[e+"Form"]=n(!0)});const oh=Kh;class Oy{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(i){n=i});const r=this;this.promise.then(s=>{if(!r._listeners)return;let i=r._listeners.length;for(;i-- >0;)r._listeners[i](s);r._listeners=null}),this.promise.then=s=>{let i;const a=new Promise(l=>{r.subscribe(l),i=l}).then(s);return a.cancel=function(){r.unsubscribe(i)},a},e(function(i,a,l){r.reason||(r.reason=new cl(i,a,l),n(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const n=this._listeners.indexOf(e);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const e=new AbortController,n=r=>{e.abort(r)};return this.subscribe(n),e.signal.unsubscribe=()=>this.unsubscribe(n),e.signal}static source(){let e;return{token:new Oy(function(s){e=s}),cancel:e}}}const zF=Oy;function UF(t){return function(n){return t.apply(null,n)}}function VF(t){return O.isObject(t)&&t.isAxiosError===!0}const P0={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(P0).forEach(([t,e])=>{P0[e]=t});const HF=P0;function eI(t){const e=new oh(t),n=NT(oh.prototype.request,e);return O.extend(n,oh.prototype,e,{allOwnKeys:!0}),O.extend(n,e,null,{allOwnKeys:!0}),n.create=function(s){return eI(Aa(t,s))},n}const bt=eI(My);bt.Axios=oh;bt.CanceledError=cl;bt.CancelToken=zF;bt.isCancel=qT;bt.VERSION=ZT;bt.toFormData=tm;bt.AxiosError=fe;bt.Cancel=bt.CanceledError;bt.all=function(e){return Promise.all(e)};bt.spread=UF;bt.isAxiosError=VF;bt.mergeConfig=Aa;bt.AxiosHeaders=Or;bt.formToJSON=t=>WT(O.isHTMLForm(t)?new FormData(t):t);bt.getAdapter=JT.getAdapter;bt.HttpStatusCode=HF;bt.default=bt;const WF=bt,tI="HD-MP3",nI=WF.create({baseURL:{}.VITE_ENDPOINT||"https://express-zingmp3-awx6.vercel.app"}),rn=()=>JSON.parse(localStorage.getItem(tI)||"{}"),Ze=(t,e)=>{const n=rn();return n[t]=e,localStorage.setItem(tI,JSON.stringify(n))},Bs=t=>{const e=Math.floor(t/60),n=Math.round(t%60);return`${e}:${n.toString().padStart(2,"0")}`},zs=async t=>new Promise(e=>setTimeout(e,t)),rI=(t,e)=>{t.scrollIntoView({behavior:e||"smooth",block:"center"})},qc=t=>t?"disable":"",Gc=t=>t?"hidden":"",im=(t,e)=>t?e:"";let lh=qh[3];const qF=rn(),kb=qF.theme;kb&&[...qh,...AT].forEach(t=>{t.id===kb&&(lh=t)});const GF={theme:{...lh,alpha:lh.type==="light"?"[#000]/5":"[#fff]/5",text_color:lh.type==="light"?"text-[#333]":"text-[#fff]"},isOnMobile:window.innerWidth<768,isDev:!1},QF=(t,e)=>{switch(e.type){case 0:{const n=e.payload.theme;return{...t,theme:{...n,alpha:n.type==="dark"?"[#fff]/5":"[#000]/5",text_color:n.type==="light"?"text-[#333]":"text-[#fff]"}}}}},KF=()=>{const[t,e]=m.useReducer(QF,GF),n=m.useCallback(r=>{console.log("set theme"),e({type:0,payload:{theme:r}})},[]);return{state:t,setTheme:n}},sI=m.createContext(null),XF=({children:t})=>o.jsx(sI.Provider,{value:KF(),children:t}),q=()=>{const t=m.useContext(sI);if(!t)throw new Error("ThemeProvider not provided");const{state:e,...n}=t;return{...e,...n}},YF=()=>{const[t,e]=m.useState([]);return{toasts:t,setErrorToast:s=>e(i=>[...i,{variant:"error",id:Date.now()+"",desc:s||"Somethings went wrong"}]),setSuccessToast:s=>e(i=>[...i,{variant:"success",id:Date.now()+"",desc:s||"Successful"}]),setToasts:e}},iI=m.createContext(null);function JF({children:t}){return o.jsx(iI.Provider,{value:YF(),children:t})}const ge=()=>{const t=m.useContext(iI);if(!t)throw new Error("Toast Context not provided");return t},ZF=()=>{const[t,e]=m.useState([]),[n,r]=m.useState([]),s=m.useRef(!0);return{ahead:t,behind:n,setAhead:e,setBehind:r,shouldStoreLocation:s}},aI=m.createContext(null),oI=()=>{const t=m.useContext(aI);if(!t)throw new Error("Navigation context not provided");return t};function lI(){const{ahead:t,setAhead:e,setBehind:n,shouldStoreLocation:r}=oI(),s=rr(),i=m.useMemo(()=>s.pathname+s.search,[s]),a=m.useRef(!1);return m.useEffect(()=>{if(!a.current){a.current=!0;return}return()=>{r.current?(t.length&&e([]),n(l=>[...l,i])):r.current=!0}},[s.pathname]),o.jsx(o.Fragment,{})}function cI({children:t}){return o.jsx(aI.Provider,{value:ZF(),children:t})}function eD(){const[t,e]=m.useState([]),[n,r]=m.useState(!1);return{uploadingSongs:t,setUploadingSongs:e,isUploading:n,setIsUploading:r,resetUploadContext:()=>{r(!1),e([])}}}const uI=m.createContext(null),tD=({children:t})=>o.jsx(uI.Provider,{value:eD(),children:t}),dI=()=>{const t=m.useContext(uI);if(!t)throw new Error("UploadSongProvider not provided");return t},nD=["Songs","Karaoke","Lyric"],rD=["Playing","Lyric"],Xl=rn();function sD(){const[t,e]=m.useState(!1),[n,r]=m.useState(!1),[s,i]=m.useState("Lyric"),[a,l]=m.useState("Lyric"),[c,u]=m.useState(!1),[d,f]=m.useState({lyricSize:Xl.lyricSize||"medium",repeat:Xl.isRepeat||"no",isShuffle:Xl.isShuffle||!1,isCrossFade:Xl.isCrossFade||!1,songBackground:Xl.songBackground||!0,isEnableBeat:!1}),p=m.useRef(!0),g=m.useRef(0),v=m.useRef(!0),_=m.useRef(""),b=m.useRef(!1),E=m.useRef(null),w=m.useRef(null),S=m.useRef(null);return{audioRef:E,themeCodeRef:_,isOpenFullScreen:t,isOpenSongQueue:n,idle:c,setIdle:u,setIsOpenFullScreen:e,setIsOpenSongQueue:r,activeTab:s,setActiveTab:i,desktopTabs:nD,mobileActiveTab:a,setMobileActiveTab:l,mobileTabs:rD,playerConig:d,updatePlayerConfig:F=>{f(D=>({...D,...F}))},firstTimeSongLoaded:p,timelineEleRef:w,currentTimeEleRef:S,startFadeWhenEnd:g,isPlayingNewSong:v,shouldSyncSongDuration:b}}const hI=m.createContext(null);function iD({children:t}){return o.jsx(hI.Provider,{value:sD(),children:t})}function et(){const t=m.useContext(hI);if(!t)throw new Error("Player Context not provided");return t}const aD=()=>{const[t,e]=m.useState([]),[n,r]=m.useState(!1),s=m.useRef(!1);return{songLyrics:t,setSongLyrics:e,loading:n,setLoading:r,ranGetLyric:s}},fI=m.createContext(null);function mI({children:t}){return o.jsx(fI.Provider,{value:aD(),children:t})}const oD=()=>{const t=m.useContext(fI);if(!t)throw new Error("Lyric context not found");return t},lD=()=>{const[t,e]=m.useState(!1),[n,r]=m.useState(!1),[s,i]=m.useState([]);return{isChecked:t,setIsChecked:e,isSelectAll:n,setIsSelectAll:r,setSelectedSongs:i,selectedSongs:s,selectAllSong:u=>{e(!0),r(!0),i(u)},selectSong:u=>{const d=[...s],f=d.findIndex(p=>p.id===u.id);f===-1?d.push(u):d.splice(f,1),e(!!d.length),i(d)},resetSelect:()=>{e(!1),r(!1),i([])}}},pI=m.createContext(null);function ms({children:t}){return o.jsx(pI.Provider,{value:lD(),children:t})}const vu=()=>{const t=m.useContext(pI);if(!t)throw new Error("SelectSongContext not provided");return t};function gI(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t))for(e=0;e<t.length;e++)t[e]&&(n=gI(t[e]))&&(r&&(r+=" "),r+=n);else for(e in t)t[e]&&(r&&(r+=" "),r+=e);return r}function cD(){for(var t,e,n=0,r="";n<arguments.length;)(t=arguments[n++])&&(e=gI(t))&&(r&&(r+=" "),r+=e);return r}const Tb=t=>typeof t=="boolean"?"".concat(t):t===0?"0":t,Ib=cD,wu=(t,e)=>n=>{var r;if((e==null?void 0:e.variants)==null)return Ib(t,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:s,defaultVariants:i}=e,a=Object.keys(s).map(u=>{const d=n==null?void 0:n[u],f=i==null?void 0:i[u];if(d===null)return null;const p=Tb(d)||Tb(f);return s[u][p]}),l=n&&Object.entries(n).reduce((u,d)=>{let[f,p]=d;return p===void 0||(u[f]=p),u},{}),c=e==null||(r=e.compoundVariants)===null||r===void 0?void 0:r.reduce((u,d)=>{let{class:f,className:p,...g}=d;return Object.entries(g).every(v=>{let[_,b]=v;return Array.isArray(b)?b.includes({...i,...l}[_]):{...i,...l}[_]===b})?[...u,f,p]:u},[]);return Ib(t,a,c,n==null?void 0:n.class,n==null?void 0:n.className)};function uD({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 6h9.75M10.5 6a1.5 1.5 0 11-3 0m3 0a1.5 1.5 0 10-3 0M3.75 6H7.5m3 12h9.75m-9.75 0a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0m-3.75 0H7.5m9-6h3.75m-3.75 0a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0m-9.75 0h9.75"}))}const dD=m.forwardRef(uD),_u=dD;function hD({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3"}))}const fD=m.forwardRef(hD),am=fD;function mD({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6a2.25 2.25 0 00-2.25 2.25v13.5A2.25 2.25 0 007.5 21h6a2.25 2.25 0 002.25-2.25V15M12 9l-3 3m0 0l3 3m-3-3h12.75"}))}const pD=m.forwardRef(mD),gD=pD;function xD({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18"}))}const yD=m.forwardRef(xD),xI=yD;function vD({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 12c0-1.232-.046-2.453-.138-3.662a4.006 4.006 0 00-3.7-3.7 48.678 48.678 0 00-7.324 0 4.006 4.006 0 00-3.7 3.7c-.017.22-.032.441-.046.662M19.5 12l3-3m-3 3l-3-3m-12 3c0 1.232.046 2.453.138 3.662a4.006 4.006 0 003.7 3.7 48.656 48.656 0 007.324 0 4.006 4.006 0 003.7-3.7c.017-.22.032-.441.046-.662M4.5 12l3 3m-3-3l-3 3"}))}const wD=m.forwardRef(vD),yI=wD;function _D({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99"}))}const bD=m.forwardRef(_D),at=bD;function SD({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6a2.25 2.25 0 00-2.25 2.25v13.5A2.25 2.25 0 007.5 21h6a2.25 2.25 0 002.25-2.25V15m3 0l3-3m0 0l-3-3m3 3H9"}))}const ED=m.forwardRef(SD),$y=ED;function kD({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 4.5L21 12m0 0l-7.5 7.5M21 12H3"}))}const TD=m.forwardRef(kD),ID=TD;function CD({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 18L9 11.25l4.306 4.307a11.95 11.95 0 015.814-5.519l2.74-1.22m0 0l-5.94-2.28m5.94 2.28l-2.28 5.941"}))}const jD=m.forwardRef(CD),vI=jD;function RD({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5m-13.5-9L12 3m0 0l4.5 4.5M12 3v13.5"}))}const AD=m.forwardRef(RD),By=AD;function ND({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 16.811c0 .864-.933 1.405-1.683.977l-7.108-4.062a1.125 1.125 0 010-1.953l7.108-4.062A1.125 1.125 0 0121 8.688v8.123zM11.25 16.811c0 .864-.933 1.405-1.683.977l-7.108-4.062a1.125 1.125 0 010-1.953L9.567 7.71a1.125 1.125 0 011.683.977v8.123z"}))}const PD=m.forwardRef(ND),zy=PD;function FD({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"}))}const DD=m.forwardRef(FD),ul=DD;function LD({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20.25 8.511c.884.284 1.5 1.128 1.5 2.097v4.286c0 1.136-.847 2.1-1.98 2.193-.34.027-.68.052-1.02.072v3.091l-3-3c-1.354 0-2.694-.055-4.02-.163a2.115 2.115 0 01-.825-.242m9.345-8.334a2.126 2.126 0 00-.476-.095 48.64 48.64 0 00-8.048 0c-1.131.094-1.976 1.057-1.976 2.192v4.286c0 .837.46 1.58 1.155 1.951m9.345-8.334V6.637c0-1.621-1.152-3.026-2.76-3.235A48.455 48.455 0 0011.25 3c-2.115 0-4.198.137-6.24.402-1.608.209-2.76 1.614-2.76 3.235v6.226c0 1.621 1.152 3.026 2.76 3.235.577.075 1.157.14 1.74.194V21l4.155-4.155"}))}const MD=m.forwardRef(LD),Uy=MD;function OD({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}))}const $D=m.forwardRef(OD),BD=$D;function zD({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 12.75l6 6 9-13.5"}))}const UD=m.forwardRef(zD),bu=UD;function VD({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 8.25l-7.5 7.5-7.5-7.5"}))}const HD=m.forwardRef(VD),wI=HD;function WD({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5L8.25 12l7.5-7.5"}))}const qD=m.forwardRef(WD),_I=qD;function GD({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 4.5l7.5 7.5-7.5 7.5"}))}const QD=m.forwardRef(GD),ch=QD;function KD({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 15.75l7.5-7.5 7.5 7.5"}))}const XD=m.forwardRef(KD),YD=XD;function JD({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z"}))}const ZD=m.forwardRef(JD),Vy=ZD;function eL({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.324.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 011.37.49l1.296 2.247a1.125 1.125 0 01-.26 1.431l-1.003.827c-.293.24-.438.613-.431.992a6.759 6.759 0 010 .255c-.007.378.138.75.43.99l1.005.828c.424.35.534.954.26 1.43l-1.298 2.247a1.125 1.125 0 01-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.57 6.57 0 01-.22.128c-.331.183-.581.495-.644.869l-.213 1.28c-.09.543-.56.941-1.11.941h-2.594c-.55 0-1.02-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 01-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 01-1.369-.49l-1.297-2.247a1.125 1.125 0 01.26-1.431l1.004-.827c.292-.24.437-.613.43-.992a6.932 6.932 0 010-.255c.007-.378-.138-.75-.43-.99l-1.004-.828a1.125 1.125 0 01-.26-1.43l1.297-2.247a1.125 1.125 0 011.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.087.22-.128.332-.183.582-.495.644-.869l.214-1.281z"}),m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}))}const tL=m.forwardRef(eL),Hy=tL;function nL({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 17.25v1.007a3 3 0 01-.879 2.122L7.5 21h9l-.621-.621A3 3 0 0115 18.257V17.25m6-12V15a2.25 2.25 0 01-2.25 2.25H5.25A2.25 2.25 0 013 15V5.25m18 0A2.25 2.25 0 0018.75 3H5.25A2.25 2.25 0 003 5.25m18 0V12a2.25 2.25 0 01-2.25 2.25H5.25A2.25 2.25 0 013 12V5.25"}))}const rL=m.forwardRef(nL),Wy=rL;function sL({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z"}))}const iL=m.forwardRef(sL),qy=iL;function aL({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m9-.75a9 9 0 11-18 0 9 9 0 0118 0zm-9 3.75h.008v.008H12v-.008z"}))}const oL=m.forwardRef(aL),om=oL;function lL({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.375 19.5h17.25m-17.25 0a1.125 1.125 0 01-1.125-1.125M3.375 19.5h1.5C5.496 19.5 6 18.996 6 18.375m-3.75 0V5.625m0 12.75v-1.5c0-.621.504-1.125 1.125-1.125m18.375 2.625V5.625m0 12.75c0 .621-.504 1.125-1.125 1.125m1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125m0 3.75h-1.5A1.125 1.125 0 0118 18.375M20.625 4.5H3.375m17.25 0c.621 0 1.125.504 1.125 1.125M20.625 4.5h-1.5C18.504 4.5 18 5.004 18 5.625m3.75 0v1.5c0 .621-.504 1.125-1.125 1.125M3.375 4.5c-.621 0-1.125.504-1.125 1.125M3.375 4.5h1.5C5.496 4.5 6 5.004 6 5.625m-3.75 0v1.5c0 .621.504 1.125 1.125 1.125m0 0h1.5m-1.5 0c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125m1.5-3.75C5.496 8.25 6 7.746 6 7.125v-1.5M4.875 8.25C5.496 8.25 6 8.754 6 9.375v1.5m0-5.25v5.25m0-5.25C6 5.004 6.504 4.5 7.125 4.5h9.75c.621 0 1.125.504 1.125 1.125m1.125 2.625h1.5m-1.5 0A1.125 1.125 0 0118 7.125v-1.5m1.125 2.625c-.621 0-1.125.504-1.125 1.125v1.5m2.625-2.625c.621 0 1.125.504 1.125 1.125v1.5c0 .621-.504 1.125-1.125 1.125M18 5.625v5.25M7.125 12h9.75m-9.75 0A1.125 1.125 0 016 10.875M7.125 12C6.504 12 6 12.504 6 13.125m0-2.25C6 11.496 5.496 12 4.875 12M18 10.875c0 .621-.504 1.125-1.125 1.125M18 10.875c0 .621.504 1.125 1.125 1.125m-2.25 0c.621 0 1.125.504 1.125 1.125m-12 5.25v-5.25m0 5.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125m-12 0v-1.5c0-.621-.504-1.125-1.125-1.125M18 18.375v-5.25m0 5.25v-1.5c0-.621.504-1.125 1.125-1.125M18 13.125v1.5c0 .621.504 1.125 1.125 1.125M18 13.125c0-.621.504-1.125 1.125-1.125M6 13.125v1.5c0 .621-.504 1.125-1.125 1.125M6 13.125C6 12.504 5.496 12 4.875 12m-1.5 0h1.5m-1.5 0c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125M19.125 12h1.5m0 0c.621 0 1.125.504 1.125 1.125v1.5c0 .621-.504 1.125-1.125 1.125m-17.25 0h1.5m14.25 0h1.5"}))}const cL=m.forwardRef(lL),uL=cL;function dL({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 8.688c0-.864.933-1.405 1.683-.977l7.108 4.062a1.125 1.125 0 010 1.953l-7.108 4.062A1.125 1.125 0 013 16.81V8.688zM12.75 8.688c0-.864.933-1.405 1.683-.977l7.108 4.062a1.125 1.125 0 010 1.953l-7.108 4.062a1.125 1.125 0 01-1.683-.977V8.688z"}))}const hL=m.forwardRef(dL),Gy=hL;function fL({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12z"}))}const mL=m.forwardRef(fL),dl=mL;function pL({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 12l8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25"}))}const gL=m.forwardRef(pL),lm=gL;function xL({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z"}))}const yL=m.forwardRef(xL),F0=yL;function vL({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.19 8.688a4.5 4.5 0 011.242 7.244l-4.5 4.5a4.5 4.5 0 01-6.364-6.364l1.757-1.757m13.35-.622l1.757-1.757a4.5 4.5 0 00-6.364-6.364l-4.5 4.5a4.5 4.5 0 001.242 7.244"}))}const wL=m.forwardRef(vL),_L=wL;function bL({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"}))}const SL=m.forwardRef(bL),Qy=SL;function EL({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 12h-15"}))}const kL=m.forwardRef(EL),Ky=kL;function TL({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 9l10.5-3m0 6.553v3.75a2.25 2.25 0 01-1.632 2.163l-1.32.377a1.803 1.803 0 11-.99-3.467l2.31-.66a2.25 2.25 0 001.632-2.163zm0 0V2.25L9 5.25v10.303m0 0v3.75a2.25 2.25 0 01-1.632 2.163l-1.32.377a1.803 1.803 0 01-.99-3.467l2.31-.66A2.25 2.25 0 009 15.553z"}))}const IL=m.forwardRef(TL),Ka=IL;function CL({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 7.5h1.5m-1.5 3h1.5m-7.5 3h7.5m-7.5 3h7.5m3-9h3.375c.621 0 1.125.504 1.125 1.125V18a2.25 2.25 0 01-2.25 2.25M16.5 7.5V18a2.25 2.25 0 002.25 2.25M16.5 7.5V4.875c0-.621-.504-1.125-1.125-1.125H4.125C3.504 3.75 3 4.254 3 4.875V18a2.25 2.25 0 002.25 2.25h13.5M6 7.5h3v3H6v-3z"}))}const jL=m.forwardRef(CL),RL=jL;function AL({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.53 16.122a3 3 0 00-5.78 1.128 2.25 2.25 0 01-2.4 2.245 4.5 4.5 0 008.4-2.245c0-.399-.078-.78-.22-1.128zm0 0a15.998 15.998 0 003.388-1.62m-5.043-.025a15.994 15.994 0 011.622-3.395m3.42 3.42a15.995 15.995 0 004.764-4.648l3.876-5.814a1.151 1.151 0 00-1.597-1.597L14.146 6.32a15.996 15.996 0 00-4.649 4.763m3.42 3.42a6.776 6.776 0 00-3.42-3.42"}))}const NL=m.forwardRef(AL),D0=NL;function PL({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 12L3.269 3.126A59.768 59.768 0 0121.485 12 59.77 59.77 0 013.27 20.876L5.999 12zm0 0h7.5"}))}const FL=m.forwardRef(PL),DL=FL;function LL({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.25 9v6m-4.5 0V9M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}))}const ML=m.forwardRef(LL),Xy=ML;function OL({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 5.25v13.5m-7.5-13.5v13.5"}))}const $L=m.forwardRef(OL),cm=$L;function BL({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125"}))}const zL=m.forwardRef(BL),Ys=zL;function UL({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 15.75l5.159-5.159a2.25 2.25 0 013.182 0l5.159 5.159m-1.5-1.5l1.409-1.409a2.25 2.25 0 013.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 001.5-1.5V6a1.5 1.5 0 00-1.5-1.5H3.75A1.5 1.5 0 002.25 6v12a1.5 1.5 0 001.5 1.5zm10.5-11.25h.008v.008h-.008V8.25zm.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0z"}))}const VL=m.forwardRef(UL),hl=VL;function HL({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}),m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.91 11.672a.375.375 0 010 .656l-5.603 3.113a.375.375 0 01-.557-.328V8.887c0-.286.307-.466.557-.327l5.603 3.112z"}))}const WL=m.forwardRef(HL),bI=WL;function qL({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 5.653c0-.856.917-1.398 1.667-.986l11.54 6.348a1.125 1.125 0 010 1.971l-11.54 6.347a1.125 1.125 0 01-1.667-.985V5.653z"}))}const GL=m.forwardRef(qL),Qc=GL;function QL({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"}))}const KL=m.forwardRef(QL),br=KL;function XL({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442-.745.361-1.45.999-1.45 1.827v.75M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9 5.25h.008v.008H12v-.008z"}))}const YL=m.forwardRef(XL),SI=YL;function JL({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 12h16.5m-16.5 3.75h16.5M3.75 19.5h16.5M5.625 4.5h12.75a1.875 1.875 0 010 3.75H5.625a1.875 1.875 0 010-3.75z"}))}const ZL=m.forwardRef(JL),eM=ZL;function tM({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 7.125C2.25 6.504 2.754 6 3.375 6h6c.621 0 1.125.504 1.125 1.125v3.75c0 .621-.504 1.125-1.125 1.125h-6a1.125 1.125 0 01-1.125-1.125v-3.75zM14.25 8.625c0-.621.504-1.125 1.125-1.125h5.25c.621 0 1.125.504 1.125 1.125v8.25c0 .621-.504 1.125-1.125 1.125h-5.25a1.125 1.125 0 01-1.125-1.125v-8.25zM3.75 16.125c0-.621.504-1.125 1.125-1.125h5.25c.621 0 1.125.504 1.125 1.125v2.25c0 .621-.504 1.125-1.125 1.125h-5.25a1.125 1.125 0 01-1.125-1.125v-2.25z"}))}const nM=m.forwardRef(tM),rM=nM;function sM({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7.848 8.25l1.536.887M7.848 8.25a3 3 0 11-5.196-3 3 3 0 015.196 3zm1.536.887a2.165 2.165 0 011.083 1.839c.005.351.054.695.14 1.024M9.384 9.137l2.077 1.199M7.848 15.75l1.536-.887m-1.536.887a3 3 0 11-5.196 3 3 3 0 015.196-3zm1.536-.887a2.165 2.165 0 001.083-1.838c.005-.352.054-.695.14-1.025m-1.223 2.863l2.077-1.199m0-3.328a4.323 4.323 0 012.068-1.379l5.325-1.628a4.5 4.5 0 012.48-.044l.803.215-7.794 4.5m-2.882-1.664A4.331 4.331 0 0010.607 12m3.736 0l7.794 4.5-.802.215a4.5 4.5 0 01-2.48-.043l-5.326-1.629a4.324 4.324 0 01-2.068-1.379M14.343 12l-2.882 1.664"}))}const iM=m.forwardRef(sM),EI=iM;function aM({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.114 5.636a9 9 0 010 12.728M16.463 8.288a5.25 5.25 0 010 7.424M6.75 8.25l4.72-4.72a.75.75 0 011.28.53v15.88a.75.75 0 01-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.01 9.01 0 012.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75z"}))}const oM=m.forwardRef(aM),lM=oM;function cM({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17.25 9.75L19.5 12m0 0l2.25 2.25M19.5 12l2.25-2.25M19.5 12l-2.25 2.25m-10.5-6l4.72-4.72a.75.75 0 011.28.531V19.94a.75.75 0 01-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.506-1.938-1.354A9.01 9.01 0 012.25 12c0-.83.112-1.633.322-2.395C2.806 8.757 3.63 8.25 4.51 8.25H6.75z"}))}const uM=m.forwardRef(cM),dM=uM;function hM({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 7.5A2.25 2.25 0 017.5 5.25h9a2.25 2.25 0 012.25 2.25v9a2.25 2.25 0 01-2.25 2.25h-9a2.25 2.25 0 01-2.25-2.25v-9z"}))}const fM=m.forwardRef(hM),kI=fM;function mM({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"}))}const pM=m.forwardRef(mM),Dn=pM;function gM({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z"}))}const xM=m.forwardRef(gM),yM=xM;function vM({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"}))}const wM=m.forwardRef(vM),Gi=wM,_M=wu("inline-flex space-x-1 font-[500] items-center ",{variants:{variant:{default:"",circle:"rounded-full",list:"flex items-center py-[5px] w-full",outline:"border rounded-full",primary:""},color:{primary:"primary",clear:""},size:{primary:"px-4 py-1.5",small:"px-2 py-1",half:"w-1/2",full:"w-full",clear:""},rounded:{full:"rounded-full",md:"rounded-md",clear:""},hover:{default:"hover:brightness-90",scale:"transition-transform hover:scale-[1.05]",clear:""}},defaultVariants:{variant:"default",size:"primary",hover:"default",rounded:"full",color:"clear"}});function bM({className:t,children:e,variant:n,size:r,disabled:s,isLoading:i,rounded:a,color:l,hover:c,onClick:u,...d},f){const{theme:p}=q();return o.jsxs("button",{ref:f,type:"button",onClick:g=>u?u(g):"",...d,className:`${l==="primary"?p.content_bg:""}  ${_M({variant:n,size:r,hover:c,rounded:a,className:t})}`,disabled:i||s,children:[i?o.jsx(at,{className:"w-6 animate-spin"}):null,!i&&e]})}const oe=m.forwardRef(bM);function SM({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{fillRule:"evenodd",d:"M15.312 11.424a5.5 5.5 0 01-9.201 2.466l-.312-.311h2.433a.75.75 0 000-1.5H3.989a.75.75 0 00-.75.75v4.242a.75.75 0 001.5 0v-2.43l.31.31a7 7 0 0011.712-3.138.75.75 0 00-1.449-.39zm1.23-3.723a.75.75 0 00.219-.53V2.929a.75.75 0 00-1.5 0V5.36l-.31-.31A7 7 0 003.239 8.188a.75.75 0 101.448.389A5.5 5.5 0 0113.89 6.11l.311.31h-2.432a.75.75 0 000 1.5h4.243a.75.75 0 00.53-.219z",clipRule:"evenodd"}))}const EM=m.forwardRef(SM),kM=EM;function TM({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{fillRule:"evenodd",d:"M10 17a.75.75 0 01-.75-.75V5.612L5.29 9.77a.75.75 0 01-1.08-1.04l5.25-5.5a.75.75 0 011.08 0l5.25 5.5a.75.75 0 11-1.08 1.04l-3.96-4.158V16.25A.75.75 0 0110 17z",clipRule:"evenodd"}))}const IM=m.forwardRef(TM),CM=IM;function jM({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{fillRule:"evenodd",d:"M2 4.75A.75.75 0 012.75 4h14.5a.75.75 0 010 1.5H2.75A.75.75 0 012 4.75zM2 10a.75.75 0 01.75-.75h14.5a.75.75 0 010 1.5H2.75A.75.75 0 012 10zm0 5.25a.75.75 0 01.75-.75h14.5a.75.75 0 010 1.5H2.75a.75.75 0 01-.75-.75z",clipRule:"evenodd"}))}const RM=m.forwardRef(jM),AM=RM;function NM({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{fillRule:"evenodd",d:"M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.05-.143z",clipRule:"evenodd"}))}const PM=m.forwardRef(NM),Yy=PM;function FM({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{fillRule:"evenodd",d:"M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z",clipRule:"evenodd"}))}const DM=m.forwardRef(FM),LM=DM;function MM({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm.75-13a.75.75 0 00-1.5 0v5c0 .414.336.75.75.75h4a.75.75 0 000-1.5h-3.25V5z",clipRule:"evenodd"}))}const OM=m.forwardRef(MM),$M=OM;function BM({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"}))}const zM=m.forwardRef(BM),UM=zM;function VM({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{d:"M9.653 16.915l-.005-.003-.019-.01a20.759 20.759 0 01-1.162-.682 22.045 22.045 0 01-2.582-1.9C4.045 12.733 2 10.352 2 7.5a4.5 4.5 0 018-2.828A4.5 4.5 0 0118 7.5c0 2.852-2.044 5.233-3.885 6.82a22.049 22.049 0 01-3.744 2.582l-.019.01-.005.003h-.002a.739.739 0 01-.69.001l-.002-.001z"}))}const HM=m.forwardRef(VM),Su=HM;function WM({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{d:"M5.75 3a.75.75 0 00-.75.75v12.5c0 .414.336.75.75.75h1.5a.75.75 0 00.75-.75V3.75A.75.75 0 007.25 3h-1.5zM12.75 3a.75.75 0 00-.75.75v12.5c0 .414.336.75.75.75h1.5a.75.75 0 00.75-.75V3.75a.75.75 0 00-.75-.75h-1.5z"}))}const qM=m.forwardRef(WM),TI=qM;function GM({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{d:"M5.433 13.917l1.262-3.155A4 4 0 017.58 9.42l6.92-6.918a2.121 2.121 0 013 3l-6.92 6.918c-.383.383-.84.685-1.343.886l-3.154 1.262a.5.5 0 01-.65-.65z"}),m.createElement("path",{d:"M3.5 5.75c0-.69.56-1.25 1.25-1.25H10A.75.75 0 0010 3H4.75A2.75 2.75 0 002 5.75v9.5A2.75 2.75 0 004.75 18h9.5A2.75 2.75 0 0017 15.25V10a.75.75 0 00-1.5 0v5.25c0 .69-.56 1.25-1.25 1.25h-9.5c-.69 0-1.25-.56-1.25-1.25v-9.5z"}))}const QM=m.forwardRef(GM),KM=QM;function XM({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{d:"M6.3 2.841A1.5 1.5 0 004 4.11V15.89a1.5 1.5 0 002.3 1.269l9.344-5.89a1.5 1.5 0 000-2.538L6.3 2.84z"}))}const YM=m.forwardRef(XM),L0=YM;function JM({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{d:"M10.75 4.75a.75.75 0 00-1.5 0v4.5h-4.5a.75.75 0 000 1.5h4.5v4.5a.75.75 0 001.5 0v-4.5h4.5a.75.75 0 000-1.5h-4.5v-4.5z"}))}const ZM=m.forwardRef(JM),ps=ZM;function eO({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{d:"M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"}))}const tO=m.forwardRef(eO),Jy=tO;function Ct({close:t,title:e}){return o.jsxs("div",{className:"flex justify-between mb-3",children:[o.jsx("div",{className:"text-xl leading-[2.2] font-playwriteCU",children:e}),o.jsx("button",{onClick:t,children:o.jsx(Jy,{className:"w-7"})})]})}function Zy({close:t}){return o.jsxs("div",{className:"w-[400px] max-w-[calc(90vw-40px)]",children:[o.jsx(Ct,{close:t,title:"HD MP3"}),o.jsxs("p",{children:[o.jsx("span",{className:"font-[500]",children:"Technologies: "})," React, Tailwind Css, Google firebase"]})]})}function Hp({onClick:t,theme:e,active:n}){return o.jsx(o.Fragment,{children:o.jsxs("div",{className:"w-[25%] px-2 mt-3 max-[549px]:w-[50%]",children:[o.jsx("div",{onClick:()=>t(e),className:`relative border-l-[20px] ${e.content_border} pt-[100%] rounded-xl ${e.side_bar_bg} ${n?e.content_border:""}`,children:n&&o.jsx("div",{className:"absolute bottom-[10px] right-[10px]",children:o.jsx(BD,{className:`${e.content_text} w-[25px]`})})}),o.jsx("p",{className:"text-base font-[500] mt-1",children:e.name})]})})}function ev({close:t}){const{theme:e,setTheme:n}=q(),r=c=>{Ze("theme",c.id),n(c)},s={songItemContainer:`w-full border-b border-${e.alpha} last:border-none`,icon:"w-6 h-6 mr-2 inline",popupWrapper:"w-[900px] max-w-[calc(90vw-40px)]",themeContainer:"overflow-y-auto overflow-x-hidden no-scrollbar h-[calc(70vh-60px)]  pb-[5vh]",themeList:"flex flex-row -mx-2 -mt-3 flex-wrap",linkItem:`py-[10px] border-b border-${e.alpha} last:border-none`},i=qh.map(c=>{const u=c.id===e.id;if(c.type==="light")return o.jsx(Hp,{active:u,theme:c,onClick:r},c.id)}),a=qh.map(c=>{const u=c.id===e.id;if(c.type==="dark")return o.jsx(Hp,{active:u,theme:c,onClick:r},c.id)}),l=AT.map(c=>{const u=c.id===e.id;return o.jsx(Hp,{active:u,theme:c,onClick:r},c.id)});return o.jsxs("div",{className:s.popupWrapper,children:[o.jsx(Ct,{close:t,title:"Themes"}),o.jsxs("div",{className:s.themeContainer,children:[o.jsx("h2",{className:"text-lg font-semibold mb-[10px] mt-[30px]",children:"Specical"}),o.jsx("div",{className:s.themeList,children:l}),o.jsx("h2",{className:"text-lg font-semibold mb-[10px]",children:"Dark"}),o.jsx("div",{className:s.themeList,children:a}),o.jsx("h2",{className:"text-lg font-semibold mb-[10px] mt-[30px]",children:"Light"}),o.jsx("div",{className:s.themeList,children:i})]})]})}function gs({loading:t,callback:e,label:n,children:r,close:s,desc:i="This action cannot be undone",className:a}){const{theme:l}=q();return o.jsxs("div",{className:`${a||"w-[400px] max-w-[calc(90vw-40px)]"} ${t?"disable":""}`,children:[o.jsx("div",{className:"text-xl font-playwriteCU leading-[2.2] mb-3",children:n||"Wait a minute"}),i&&o.jsx("p",{className:"font-semibold text-lg text-red-400",children:i}),o.jsx("div",{className:"flex space-x-3 mt-5",children:r||o.jsxs(o.Fragment,{children:[o.jsx(oe,{onClick:s,className:"bg-white/10 border border-white/10 rounded-full px-3 py-0.5",variant:"primary",size:"clear",children:"Close"}),o.jsx(oe,{isLoading:t,className:`${l.content_bg} rounded-full px-3`,variant:"primary",size:"clear",onClick:e,children:"Yes, Please"})]})})]})}const nO=[3,5,7,10];function II({closeModal:t,active:e}){const{theme:n}=q(),r={button:`bg-[#fff]/5 ${n.content_hover_bg} ml-2 mt-2 px-3  py-1 rounded-[99px]`},s=a=>{e(a),t()},i=nO.map(a=>o.jsxs("button",{type:"button",onClick:()=>s(a),className:`${r.button} `,children:[a," songs"]},a));return o.jsxs("div",{className:"w-[300px] max-w-[calc(100vw-40px)]",children:[o.jsx(Ct,{close:t,title:"Sleep timer"}),o.jsx("div",{children:o.jsx("div",{className:"flex flex-wrap -mt-2 -ml-2 mb-3",children:i})})]})}function le({className:t}){const{theme:e}=q();return o.jsx("div",{className:`animate-pulse rounded-[4px] ${e.type==="light"?"bg-[#f1f1f1]":"bg-[#808080]"}  ${t}`})}const fl=[...Array(4).keys()].map(t=>o.jsxs("div",{className:"flex items-center p-[10px] border-b-[1px] border-transparent",children:[o.jsx(le,{className:"h-[18px] w-[18px]"}),o.jsx(le,{className:"h-[54px] w-[54px] ml-[10px] rounded-[4px]"}),o.jsxs("div",{className:"ml-[10px]",children:[o.jsx(le,{className:"h-[20px] mb-[5px] w-[150px]"}),o.jsx(le,{className:"h-[12px] mt-[5px] w-[100px]"})]})]},t)),CI=()=>o.jsx("div",{className:"py-3",children:o.jsx(le,{className:"w-full h-[28px]"})}),tv=[...Array(2).keys()].map(t=>o.jsxs("div",{className:"p-2 w-1/2 md:w-1/4",children:[o.jsx(le,{className:"pt-[100%] rounded-lg"}),o.jsx(le,{className:"h-[21px] mt-1.5 w-3/4"}),o.jsx(le,{className:"h-[13px] mt-1 w-3/4"})]},t));var rO=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","#","$","%","*","+",",","-",".",":",";","=","?","@","[","]","^","_","{","|","}","~"],ic=t=>{let e=0;for(let n=0;n<t.length;n++){let r=t[n],s=rO.indexOf(r);e=e*83+s}return e},Wp=t=>{let e=t/255;return e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)},qp=t=>{let e=Math.max(0,Math.min(1,t));return e<=.0031308?Math.trunc(e*12.92*255+.5):Math.trunc((1.055*Math.pow(e,.4166666666666667)-.055)*255+.5)},sO=t=>t<0?-1:1,Gp=(t,e)=>sO(t)*Math.pow(Math.abs(t),e),Cb=class extends Error{constructor(t){super(t),this.name="ValidationError",this.message=t}},iO=t=>{if(!t||t.length<6)throw new Cb("The blurhash string must be at least 6 characters");let e=ic(t[0]),n=Math.floor(e/9)+1,r=e%9+1;if(t.length!==4+2*r*n)throw new Cb(`blurhash length mismatch: length is ${t.length} but it should be ${4+2*r*n}`)},aO=t=>{let e=t>>16,n=t>>8&255,r=t&255;return[Wp(e),Wp(n),Wp(r)]},oO=(t,e)=>{let n=Math.floor(t/361),r=Math.floor(t/19)%19,s=t%19;return[Gp((n-9)/9,2)*e,Gp((r-9)/9,2)*e,Gp((s-9)/9,2)*e]},lO=(t,e,n,r)=>{iO(t),r=r|1;let s=ic(t[0]),i=Math.floor(s/9)+1,a=s%9+1,l=(ic(t[1])+1)/166,c=new Array(a*i);for(let f=0;f<c.length;f++)if(f===0){let p=ic(t.substring(2,6));c[f]=aO(p)}else{let p=ic(t.substring(4+f*2,6+f*2));c[f]=oO(p,l*r)}let u=e*4,d=new Uint8ClampedArray(u*n);for(let f=0;f<n;f++)for(let p=0;p<e;p++){let g=0,v=0,_=0;for(let S=0;S<i;S++)for(let I=0;I<a;I++){let F=Math.cos(Math.PI*p*I/e)*Math.cos(Math.PI*f*S/n),D=c[I+S*a];g+=D[0]*F,v+=D[1]*F,_+=D[2]*F}let b=qp(g),E=qp(v),w=qp(_);d[4*p+0+f*u]=b,d[4*p+1+f*u]=E,d[4*p+2+f*u]=w,d[4*p+3+f*u]=255}return d},cO=lO,uO=Object.defineProperty,dO=Object.defineProperties,hO=Object.getOwnPropertyDescriptors,Xh=Object.getOwnPropertySymbols,jI=Object.prototype.hasOwnProperty,RI=Object.prototype.propertyIsEnumerable,jb=(t,e,n)=>e in t?uO(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,M0=(t,e)=>{for(var n in e||(e={}))jI.call(e,n)&&jb(t,n,e[n]);if(Xh)for(var n of Xh(e))RI.call(e,n)&&jb(t,n,e[n]);return t},O0=(t,e)=>dO(t,hO(e)),AI=(t,e)=>{var n={};for(var r in t)jI.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&Xh)for(var r of Xh(t))e.indexOf(r)<0&&RI.call(t,r)&&(n[r]=t[r]);return n},NI=class extends m.PureComponent{constructor(){super(...arguments),this.canvas=null,this.handleRef=t=>{this.canvas=t,this.draw()},this.draw=()=>{let{hash:t,height:e,punch:n,width:r}=this.props;if(this.canvas){let s=cO(t,r,e,n),i=this.canvas.getContext("2d"),a=i.createImageData(r,e);a.data.set(s),i.putImageData(a,0,0)}}}componentDidUpdate(){this.draw()}render(){let t=this.props,{hash:e,height:n,width:r}=t,s=AI(t,["hash","height","width"]);return m.createElement("canvas",O0(M0({},s),{height:n,width:r,ref:this.handleRef}))}};NI.defaultProps={height:128,width:128};var fO={position:"absolute",top:0,bottom:0,left:0,right:0,width:"100%",height:"100%"},um=class extends m.PureComponent{componentDidUpdate(){if(this.props.resolutionX<=0)throw new Error("resolutionX must be larger than zero");if(this.props.resolutionY<=0)throw new Error("resolutionY must be larger than zero")}render(){let t=this.props,{hash:e,height:n,width:r,punch:s,resolutionX:i,resolutionY:a,style:l}=t,c=AI(t,["hash","height","width","punch","resolutionX","resolutionY","style"]);return m.createElement("div",O0(M0({},c),{style:O0(M0({display:"inline-block",height:n,width:r},l),{position:"relative"})}),m.createElement(NI,{hash:e,height:a,width:i,punch:s,style:fO}))}};um.defaultProps={height:128,width:128,resolutionX:32,resolutionY:32};function Xe({src:t,className:e="",width:n="w-full",blurHashEncode:r,onError:s}){const[i,a]=m.useState(!1),l=m.useRef(null),c=()=>{a(!0),t&&t!=null&&t.includes("blob")&&URL.revokeObjectURL(t)},u=()=>{const f=l.current;f.src="https://placehold.co/400",a(!0)},d=()=>{console.log("image error"),s?(s(),u()):u()};return o.jsxs(o.Fragment,{children:[!i&&o.jsx(o.Fragment,{children:r?o.jsx(um,{hash:r,height:"100%",width:"100%"}):o.jsx(le,{className:"w-full h-0"})}),o.jsx("img",{onLoad:c,onError:d,className:`${e} ${n} ${i?"":"hidden"}`,src:t||"https://placehold.co/400",ref:l})]})}function Eu({children:t,className:e=""}){return o.jsx("div",{className:`pt-[100%] relative rounded-lg overflow-hidden ${e}`,children:o.jsx("div",{className:"absolute inset-0",children:t})})}const nv="border border-black/10 placeholder:[#888] outline-none py-1.5 px-2",mO=wu("w-full",{variants:{variant:{primary:nv,clear:""},rounded:{xl:"rounded-xl",lg:"rounded-lg",md:"rounded-md"}},defaultVariants:{variant:"primary",rounded:"md"}});function pO({variant:t,className:e="bg-white/10",...n},r){return o.jsx("input",{ref:r,className:` ${mO({variant:t,className:e})}`,...n})}const Ht=m.forwardRef(pO),gO=wu("",{variants:{p:{3:"p-3",2:"p-2",1:"p-1",clear:""},rounded:{xl:"rounded-xl",lg:"rounded-lg",md:"rounded-md",sm:"rounded-sm"}},defaultVariants:{p:3,rounded:"xl"}});function Js({children:t,bg:e="primary",theme:n,className:r,p:s,rounded:i}){return o.jsx("div",{className:` ${e==="primary"?n.modal_bg:""} text-white border-[#fff]/5 border-[1px]  ${gO({p:s,rounded:i,className:r})}`,children:t})}function Qp({className:t,icon:e,label:n,to:r,arrowIcon:s,children:i}){return r?o.jsxs(we,{className:`w-full flex  justify-between  ${t}`,to:r,children:[o.jsxs("div",{className:"inline-flex items-center ",children:[e,o.jsx("span",{className:"text-lg font-medium",children:n})]}),i,s&&o.jsx("span",{children:s})]}):o.jsx("p",{children:"No onClick"})}const PI="/HD-MP3/assets/simon_empty-95813d48.png";function Ke({children:t,variant:e="default",className:n=""}){const r=()=>{switch(e){case"less":return o.jsx(o.Fragment,{});case"with-home-button":return o.jsxs(o.Fragment,{children:[o.jsx("p",{className:"text-center",children:"No result found, \\_()_/"}),o.jsx("p",{className:"text-center mt-5",children:o.jsx(we,{to:"/",children:o.jsxs(oe,{color:"primary",children:[o.jsx(lm,{className:"w-6"}),o.jsx("span",{children:"Home"})]})})})]});case"default":return o.jsx("p",{className:"text-center",children:"No result found, \\_()_/"})}};return o.jsxs("div",{className:`${n}`,children:[o.jsx("img",{className:"mx-auto",src:PI,alt:""}),r(),t]})}function an({children:t}){return o.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2",children:t})}function be({title:t,className:e=""}){return o.jsx("div",{className:`text-xl font-playwriteCU leading-[2.4] ${e}`,children:t})}function FI({colList:t,children:e,className:n=""}){const r={table:"w-full"};return o.jsxs("table",{className:`${r.table} ${n}`,children:[o.jsx("thead",{children:o.jsx("tr",{children:t.map((s,i)=>o.jsx("th",{children:s},i))})}),o.jsx("tbody",{children:e})]})}const xO=({appendOnPortal:t})=>{const[e,n]=m.useState(!1),[r,s]=m.useState(!1),i=m.useRef(null),a=m.useRef(null);return{refs:{triggerRef:i,contentRef:a},setTriggerRef:f=>{i.current=f},setContentRef:f=>{a.current=f},state:{isMounted:r,isOpen:e},setIsMounted:s,setIsOpen:n,appendOnPortal:t,close:()=>{s(!1)},toggle:()=>{r&&s(!1),e||n(!0)}}},DI=m.createContext(null),Sr=()=>{const t=m.useContext(DI);return t||{}};function pr({children:t,relativeWrap:e=!0,appendOnPortal:n,...r}){return o.jsx(DI.Provider,{value:xO({...r,appendOnPortal:n}),children:n?t:o.jsx("div",{className:"relative",children:t})})}const gr=m.forwardRef(function({children:t,needButton:e,setIsOpenParent:n},r){const{refs:s,setIsMounted:i,setIsOpen:a,close:l,toggle:c,state:{isMounted:u,isOpen:d}}=Sr();return m.useImperativeHandle(r,()=>({close:l})),m.useEffect(()=>{u||(n&&n(!1),setTimeout(()=>{a(!1)},400))},[u]),m.useEffect(()=>(d&&(n&&n(!0),setTimeout(()=>{i(!0)},100)),()=>{d||i(!1)}),[d]),m.useEffect(()=>{if(!d)return;const f=p=>{var g,v;!s.contentRef||!s.triggerRef||(g=s.triggerRef.current)!=null&&g.contains(p.target)||(v=s.contentRef.current)!=null&&v.contains(p.target)||i(!1)};return document.addEventListener("mousedown",f),document.addEventListener("touchstart",f),()=>{document.removeEventListener("mousedown",f),document.removeEventListener("touchstart",f)}},[d]),!e&&m.isValidElement(t)?m.cloneElement(t,{onClick:c,ref:s.triggerRef}):o.jsx("button",{ref:s.triggerRef,onClick:c,children:t})});function xr({children:t,className:e,animationClassName:n,...r}){const{state:{isMounted:s,isOpen:i},refs:a,close:l,appendOnPortal:c,setContentRef:u}=Sr(),d=m.useRef(null),f=()=>{const _=a.triggerRef.current,b=a.contentRef.current,E=d.current;if(!_||!b)return;const w=_.getBoundingClientRect(),S={top:w.top+_.clientHeight,left:w.left-b.clientWidth};if(r.appendTo==="portal"){const{origin:I="top right",position:F,spacer:D=8}=r;switch(F){case"right-bottom":{S.top=w.top+_.clientHeight+D,S.left=w.left;break}}const C=S.top+b.clientHeight>window.innerHeight-90;if(C){let k=S.top-b.clientHeight-_.clientHeight;k-60<0&&(k=60),S.top=k}if(E){let k=I;C&&(k="bottom right"),E.style.transformOrigin=k}}b.style.left=`${S.left}px`,b.style.top=`${S.top}px`},p=l,g={unMountedContent:"opacity-0 scale-[.95]",mountedContent:"opacity-100 scale-[1]"},v=o.jsx("div",{ref:u,className:`popup-content ${c?"fixed z-[99]":"absolute"} ${e||""}`,children:o.jsx("div",{ref:d,className:` transition-[transform,opacity] duration-[.25s] ease-linear ${n||""} ${s?g.mountedContent:g.unMountedContent}`,children:t})});return m.useEffect(()=>{if(c)return i&&(f(),document.addEventListener("wheel",p)),()=>{document.removeEventListener("wheel",p)}},[i]),i?o.jsx(o.Fragment,{children:c?Ga.createPortal(v,document.getElementById("portals")):v}):o.jsx(o.Fragment,{})}function $0(t,e){const[n,r]=m.useState(e),s=m.useRef(!1);return m.useEffect(()=>{const i=rn()[t]||e;r(i)},[]),m.useEffect(()=>{if(!s.current){s.current=!0;return}Ze(t,n)},[n]),[n,r]}function yO({audioEle:t,postLocalStorageKey:e}){const[n,r]=$0(`audio_speed_${e}`,1),[s,i]=$0(`audio_volume_${e}`,100);return m.useEffect(()=>{t.volume=s/100,t.playbackRate=n},[s,n]),{speed:n,setSpeed:r,volume:s,setVolume:i}}function LI({className:t="",positions:e="right",bg:n="",...r}){const{theme:s}=q(),{speed:i,volume:a,setVolume:l,setSpeed:c}=yO(r);return o.jsxs(pr,{children:[o.jsx(gr,{children:o.jsx(oe,{className:`${s.content_bg} rounded-full ${t}`,children:o.jsx(Hy,{className:"w-6"})})}),o.jsx(xr,{className:`top-[calc(100%+8px)] ${e==="right"?"left-0":"right-0"} z-[9]`,appendTo:"parent",children:o.jsx(Js,{bg:"clear",className:`w-[240px] ${n||s.modal_bg} `,theme:s,children:o.jsxs("div",{className:"space-y-[6px]",children:[o.jsxs("div",{className:"flex space-x-1",children:[o.jsxs("div",{className:"w-[110px] flex-shrink-0",children:["Speed ",i,"x"]}),o.jsx("input",{className:"w-full",type:"range",step:.1,min:1,max:1.5,value:i,onChange:u=>c(+u.target.value)})]}),o.jsxs("div",{className:"flex space-x-1",children:[o.jsxs("div",{className:"w-[110px] flex-shrink-0",children:["Volume ",a,"%"]}),o.jsx("input",{className:"w-full",type:"range",step:1,min:1,max:100,value:a,onChange:u=>l(+u.target.value)})]})]})})})]})}function uh({cb:t,active:e,inActiveBg:n="bg-white/10",size:r="default"}){const{theme:s}=q(),i={circle:`${r==="default"?"w-[20px] h-[20px]":"w-[16px] h-[16px]"}  absolute bg-white left-[3px] rounded-[50%] transition-transform top-[50%] translate-y-[-50%]`,active:`${r==="default"?"translate-x-[14px]":"translate-x-[18px]"} `,inActive:"translate-x-[0]"};return o.jsx("div",{onClick:t,className:`relative  cursor-pointer ${r==="default"?"h-[24px]":"h-[20px]"} rounded-[99px] w-[40px] 
         ${e?s.content_bg:n} `,children:o.jsx("div",{className:`${i.circle} ${e?i.active:i.inActive}`})})}function vO({children:t,className:e,persisted:n=!1,wrapped:r=!0,...s},i){const a=s.variant||"default",{theme:l}=q(),[c,u]=m.useState(a==="default"),[d,f]=m.useState(a==="default"),[p,g]=m.useState(n),v=()=>{d&&f(!1),c||u(!0)},_=()=>{u(!0)},b=()=>{f(!1),g(!1)},E=I=>{g(I)},w=I=>{I.preventDefault(),I.stopPropagation(),!p&&(a==="default"&&s.closeModal&&s.closeModal(),a==="animation"&&b())};m.useImperativeHandle(i,()=>({toggle:v,close:b,open:_,setModalPersist:E})),m.useEffect(()=>{a!=="default"&&(d||setTimeout(()=>{u(!1),s.onClose&&s.onClose()},400))},[d]),m.useEffect(()=>{a!=="default"&&c&&setTimeout(()=>{f(!0)},100)},[c]);const S={unMountedContent:"opacity-0 scale-[.95]",mountedContent:"opacity-100 scale-[1]",unMountedLayer:"opacity-0",mountedLayer:"opacity-40"};return o.jsx(o.Fragment,{children:c&&Ga.createPortal(o.jsxs("div",{className:"fixed inset-0 z-[99]",children:[o.jsx("div",{onClick:w,className:`transition-opacity duration-300 absolute bg-black inset-0 z-[90]
                             ${d?S.mountedLayer:S.unMountedLayer}
                        `}),o.jsx("div",{className:`modal-content absolute duration-300 transition-[transform,opacity] z-[99] top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2
                            ${d?S.mountedContent:S.unMountedContent}
                        `,children:r?o.jsx(Js,{className:e||"",theme:l,children:t}):t})]}),document.getElementById("portals"))})}const Fe=m.forwardRef(vO),rv="data:image/gif;base64,R0lGODlhJAAkAIABAP///////yH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQ4IDc5LjE2NDAzNiwgMjAxOS8wOC8xMy0wMTowNjo1NyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo0NmRjOGMyNC03YmYxLTQxZTMtYjQ2Zi1mY2ZhMDk4MDE1YWYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MTBDRTc0QzlGNDBEMTFFQTk4NDZENjI0QzI1MENFQzgiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MTBDRTc0QzhGNDBEMTFFQTk4NDZENjI0QzI1MENFQzgiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6YzBhNGU4OWYtNjc4Yy00NmMyLTg4NmUtYzIxNGE0NTIwZDRjIiBzdFJlZjpkb2N1bWVudElEPSJhZG9iZTpkb2NpZDpwaG90b3Nob3A6ODRlMDBjYmEtZjhlNy03YzQ4LWE4MTgtNDc3NTI3MGQ1ZTAyIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkECQgAAQAsAAAAACQAJAAAAnKMj5nArQ9jc7HWyax+GOx/dCAojltpWmgqYazqvu0kz1StrHgYp6tO6gWAn59wZKSxkjcTM7MUEk/SY1BpmGqeHhs0W8Vywk3tkPw9iztcBLfNW7Pl9PLcXk/f8Xz9vguWB6h254Y2+Id4aLjH2Kc4UQAAIfkECQgAAQAsAAAAACQAJAAAAnSMj6nL7Q+jnAzYS+XFGW7beV/4fADpmGijrkvrJnA2z1Q9hvhG7lznA+lyBpuMGAieDiYlQulkIpvTKk9KFRatv2RW671uxeHskwv+ptHLsRnbhbLPZHW7vK6r6XF21J33Bngnp2fY98UXuNikSOg3B8dYAAAh+QQJCAABACwAAAAAJAAkAAACfIyPqcvtD6OctNqLKdg8N955C7iJI4mQAKam6NUeMTMHda3cr4EnOugCfnY2Yi8Y4hmXKqHSWYQ2mclodSqllmTY7fOqbSK9VnLXHB6Ludk2Vg1nv+Vo9zT+rc/zK3qf/wNmt8aHV0Z4aHj2l+inFqgXiQjJuKgYRnkJUgAAIfkECQgAAQAsAAAAACQAJAAAAnuMj6nL7Q+jnLTaC7K+T2/eeBkYiiQjAlyKsJh5uJYc0BRtTzgMpbsn8fFqQ4cQGCuWjqok0vA7toZR4fRJxDJHzg+Uur16s+Nt86sFM8VcdDncbZPlZvZ5fq/H82rp3m5XxZe29mfoZnWIF9hH1+gDqKiHOPhWSBlJWQAAIfkECQgAAQAsAAAAACQAJAAAAn6Mj6nL7Q8RmDTaQ+u1eW7efVg4ZqLRARIppqsZpW6pQTIbzPZd57jD6+keQQ/NuAu+esDiEkl0HlUxKerXKFKvsCTvuY0qp2Dw8IzTlslTdNf3VrO5Qiu8Hre78d/5HSpHB5imR5g3Jhi2d7OWaGbIN4j4pwjJ6Lco00gJVgAAIfkECQgAAQAsAAAAACQAJAAAAn2EH6nL7XnQmxRGULO7WHsbfRPHiQ95mRsqqQvbBqUGG29K13eYw3tMqXVAwJFOMcsIf7YeizmsLJE45ZHYtPqoPO2TWzxdZVXpOGneYqPBc7mtJnflsekaCkXry3Z61h/VtzcnyGcYN1jnRnj4dQf2V8g46QiIB0ly+bhWAAAh+QQJCAABACwAAAAAJAAkAAACfYyPqcvtD+MDtMobqt6Y7Q90C8iJCamZJ0qpCNu6Bhwen0S/JZTb+wTTpSK92c9RzBwbyRsx6BvyoEYpkCW0RLVVVDbWBSuxW7EzDPrW0OrzmPs2U+Nrevvnzs/11ib+T8ZWVufXB+g1qHZnyAhX6HhIopg4yAfZKEkpiFYAACH5BAkIAAEALAAAAAAkACQAAAJ7jI+py+0Po5y02ouB3tht3jGfFopjuYwqgK5npCLuJ8XHDEK2gZP3ywMGeqwfzZgb9mTCnRLHPAalz1k06SRefVPsEsmthrXgYnf8PZvFa7J6206z4fBs8w4t08t2at+qF6j2h+YnRxiX9ybIhrg3iOdlqDjH6Fa5qFYAACH5BAkIAAEALAAAAAAkACQAAAJ1jI+py+0Po5y02otzArxr1nmfEnIjWZ5bqh4l0Lqs8WK1HNpzcFs9/9o5fkFhg1gUQZBJWISZlECL0l3ThFMCc1lq10mzXhFT8Db6JYubam7Yffa+teVymz5O6+fyuLm+hgd39ReIxRd0d+inmLjH+GX3+FIAACH5BAUIAAEALAAAAAAkACQAAAJwjI+py+0Po5y0PoCzhVlv12EfGI5NCJgMqi5sm7zwIc9BPeOw3vKqb6oBLyUaqshB3o4diZDpSTaN0FTkWUVgo8sslbtlapXh43hqKJfP4Ko1TY574ehue24XffV0KJuf9xa4tifoZih351f4h9hRAAA7",sv=({data:t,variant:e="link",active:n,link:r})=>{const s=o.jsxs(Eu,{children:[o.jsx(Xe,{className:`hover:scale-[1.05] transition-transform object-cover ${n?"brightness-[90%]":""}`,src:t.image_url,blurHashEncode:t.blurhash_encode}),n&&o.jsx(an,{children:o.jsx("img",{src:rv,alt:"",className:"w-[30px]"})})]});return(()=>{switch(e){case"link":return o.jsxs(o.Fragment,{children:[o.jsx(we,{to:`${r||"/playlist/"+t.id}`,className:"",children:s}),o.jsx("p",{className:"text-lg font-[500] leading-[1.3] line-clamp-1 mt-1.5",children:t.name}),o.jsx("p",{className:"text-sm opacity-[.7] leading-[1.3] line-clamp-1",children:t.is_album?t.singers[0].name:t.distributor})]});case"image":return s}})()};function MI({openModal:t,variant:e}){const{theme:n}=q(),r=a=>{t(a)},s={menuItem:"hover:bg-[#fff]/5 rounded-md text-sm font-[500] px-2 py-2 inline-flex items-center cursor-pointer",icon:"w-5 mr-2",divide:"h-[1px]  w-[calc(100%-20px)] my-[4px] mx-auto bg-[#fff]/5"},i=()=>{switch(e){case"client":return o.jsxs(o.Fragment,{children:[o.jsxs("li",{className:`${s.menuItem}`,onClick:()=>r("theme"),children:[o.jsx(D0,{className:s.icon}),"Themes"]}),o.jsx("div",{className:s.divide}),o.jsxs("li",{className:`${s.menuItem}`,onClick:()=>r("info"),children:[o.jsx(F0,{className:s.icon}),"Info"]})]});case"dashboard":return o.jsxs(o.Fragment,{children:[o.jsxs("li",{className:`${s.menuItem}`,onClick:()=>r("theme"),children:[o.jsx(D0,{className:s.icon}),"Themes"]}),o.jsx("div",{className:s.divide}),o.jsxs("li",{className:`${s.menuItem}`,onClick:()=>r("info"),children:[o.jsx(F0,{className:s.icon}),"Info"]})]})}};return o.jsx(o.Fragment,{children:o.jsx(Js,{theme:n,children:o.jsx("ul",{className:"flex flex-col w-[200px]",children:i()})})})}const wO=({data:t,active:e,onClick:n,hasTitle:r,classNames:s="",idleClass:i=""},a)=>{const l={container:"flex flex-col",imageFrame:"group relative transition-[width] duration-[.3s] origin-center rounded-xl overflow-hidden",image:"select-none object-cover object-center rounded w-full",overlay:`absolute  ${e?"":"inset-0 hidden bg-black/40 items-center justify-center"}   group-hover:flex`,playingGifFrame:"absolute h-[30px] w-[30px] bottom-[15px] left-[15px] -z-1",title:"text-2xl text-white mt-3 font-bold text-ellipsis line-clamp-1"};if(t)return o.jsxs("div",{ref:a,"queue-id":t.queue_id,className:`song-thumb ${e?"active":""} ${l.container} ${i}`,children:[o.jsx("div",{className:`${s} flex items-end justify-center flex-shrink-0 w-[350px] h-[350px] min-[1536px]:w-[450px] min-[1536px]:h-[450px] `,children:o.jsxs("div",{className:`border-[4px] rounded-[6px] overflow-hidden border-transparent ${l.imageFrame} ${e?"w-[350px] min-[1536px]:w-[450px]":"w-[280px] min-[1536px]:w-[330px]"}`,children:[o.jsx(Xe,{src:t.image_url,blurHashEncode:t.blurhash_encode}),o.jsx("div",{className:`${l.overlay}`,children:!e&&o.jsx(oe,{onClick:n,variant:"circle",hover:"scale",size:"clear",className:"p-2 hover:bg-[#fff]/10",children:o.jsx(Xy,{className:"w-10"})})}),e&&o.jsx("div",{className:l.playingGifFrame,children:o.jsx("img",{src:rv,alt:""})})]})}),r&&o.jsxs("div",{className:"text-center",children:[o.jsx("h2",{className:l.title,children:(t==null?void 0:t.name)||"Some song"}),o.jsx("p",{className:"text-md opacity-50 line-clamp-1",children:t.singers.map((c,u)=>o.jsx("span",{children:c.name},u))})]})]})},Kp=m.forwardRef(wO);var OI={exports:{}},$I={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ku=m;function _O(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var bO=typeof Object.is=="function"?Object.is:_O,SO=ku.useSyncExternalStore,EO=ku.useRef,kO=ku.useEffect,TO=ku.useMemo,IO=ku.useDebugValue;$I.useSyncExternalStoreWithSelector=function(t,e,n,r,s){var i=EO(null);if(i.current===null){var a={hasValue:!1,value:null};i.current=a}else a=i.current;i=TO(function(){function c(g){if(!u){if(u=!0,d=g,g=r(g),s!==void 0&&a.hasValue){var v=a.value;if(s(v,g))return f=v}return f=g}if(v=f,bO(d,g))return v;var _=r(g);return s!==void 0&&s(v,_)?(d=g,v):(d=g,f=_)}var u=!1,d,f,p=n===void 0?null:n;return[function(){return c(e())},p===null?void 0:function(){return c(p())}]},[e,n,r,s]);var l=SO(t,i[0],i[1]);return kO(function(){a.hasValue=!0,a.value=l},[l]),IO(l),l};OI.exports=$I;var CO=OI.exports;function jO(t){t()}function RO(){let t=null,e=null;return{clear(){t=null,e=null},notify(){jO(()=>{let n=t;for(;n;)n.callback(),n=n.next})},get(){const n=[];let r=t;for(;r;)n.push(r),r=r.next;return n},subscribe(n){let r=!0;const s=e={callback:n,next:null,prev:e};return s.prev?s.prev.next=s:t=s,function(){!r||t===null||(r=!1,s.next?s.next.prev=s.prev:e=s.prev,s.prev?s.prev.next=s.next:t=s.next)}}}}var Rb={notify(){},get:()=>[]};function AO(t,e){let n,r=Rb,s=0,i=!1;function a(_){d();const b=r.subscribe(_);let E=!1;return()=>{E||(E=!0,b(),f())}}function l(){r.notify()}function c(){v.onStateChange&&v.onStateChange()}function u(){return i}function d(){s++,n||(n=e?e.addNestedSub(c):t.subscribe(c),r=RO())}function f(){s--,n&&s===0&&(n(),n=void 0,r.clear(),r=Rb)}function p(){i||(i=!0,d())}function g(){i&&(i=!1,f())}const v={addNestedSub:a,notifyNestedSubs:l,handleChangeWrapper:c,isSubscribed:u,trySubscribe:p,tryUnsubscribe:g,getListeners:()=>r};return v}var NO=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",PO=NO(),FO=()=>typeof navigator<"u"&&navigator.product==="ReactNative",DO=FO(),LO=()=>PO||DO?m.useLayoutEffect:m.useEffect,MO=LO(),Xp=Symbol.for("react-redux-context"),Yp=typeof globalThis<"u"?globalThis:{};function OO(){if(!m.createContext)return{};const t=Yp[Xp]??(Yp[Xp]=new Map);let e=t.get(m.createContext);return e||(e=m.createContext(null),t.set(m.createContext,e)),e}var Oi=OO();function $O(t){const{children:e,context:n,serverState:r,store:s}=t,i=m.useMemo(()=>{const c=AO(s);return{store:s,subscription:c,getServerState:r?()=>r:void 0}},[s,r]),a=m.useMemo(()=>s.getState(),[s]);MO(()=>{const{subscription:c}=i;return c.onStateChange=c.notifyNestedSubs,c.trySubscribe(),a!==s.getState()&&c.notifyNestedSubs(),()=>{c.tryUnsubscribe(),c.onStateChange=void 0}},[i,a]);const l=n||Oi;return m.createElement(l.Provider,{value:i},e)}var BO=$O;function iv(t=Oi){return function(){return m.useContext(t)}}var BI=iv();function zI(t=Oi){const e=t===Oi?BI:iv(t),n=()=>{const{store:r}=e();return r};return Object.assign(n,{withTypes:()=>n}),n}var zO=zI();function UO(t=Oi){const e=t===Oi?zO:zI(t),n=()=>e().dispatch;return Object.assign(n,{withTypes:()=>n}),n}var ln=UO(),VO=(t,e)=>t===e;function HO(t=Oi){const e=t===Oi?BI:iv(t),n=(r,s={})=>{const{equalityFn:i=VO}=typeof s=="function"?{equalityFn:s}:s,a=e(),{store:l,subscription:c,getServerState:u}=a;m.useRef(!0);const d=m.useCallback({[r.name](p){return r(p)}}[r.name],[r]),f=CO.useSyncExternalStoreWithSelector(c.addNestedSub,l.getState,u||l.getState,d,i);return m.useDebugValue(f),f};return Object.assign(n,{withTypes:()=>n}),n}var se=HO();function Dt(t){return`Minified Redux error #${t}; visit https://redux.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var WO=(()=>typeof Symbol=="function"&&Symbol.observable||"@@observable")(),Ab=WO,Jp=()=>Math.random().toString(36).substring(7).split("").join("."),qO={INIT:`@@redux/INIT${Jp()}`,REPLACE:`@@redux/REPLACE${Jp()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${Jp()}`},Yh=qO;function av(t){if(typeof t!="object"||t===null)return!1;let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e||Object.getPrototypeOf(t)===null}function UI(t,e,n){if(typeof t!="function")throw new Error(Dt(2));if(typeof e=="function"&&typeof n=="function"||typeof n=="function"&&typeof arguments[3]=="function")throw new Error(Dt(0));if(typeof e=="function"&&typeof n>"u"&&(n=e,e=void 0),typeof n<"u"){if(typeof n!="function")throw new Error(Dt(1));return n(UI)(t,e)}let r=t,s=e,i=new Map,a=i,l=0,c=!1;function u(){a===i&&(a=new Map,i.forEach((b,E)=>{a.set(E,b)}))}function d(){if(c)throw new Error(Dt(3));return s}function f(b){if(typeof b!="function")throw new Error(Dt(4));if(c)throw new Error(Dt(5));let E=!0;u();const w=l++;return a.set(w,b),function(){if(E){if(c)throw new Error(Dt(6));E=!1,u(),a.delete(w),i=null}}}function p(b){if(!av(b))throw new Error(Dt(7));if(typeof b.type>"u")throw new Error(Dt(8));if(typeof b.type!="string")throw new Error(Dt(17));if(c)throw new Error(Dt(9));try{c=!0,s=r(s,b)}finally{c=!1}return(i=a).forEach(w=>{w()}),b}function g(b){if(typeof b!="function")throw new Error(Dt(10));r=b,p({type:Yh.REPLACE})}function v(){const b=f;return{subscribe(E){if(typeof E!="object"||E===null)throw new Error(Dt(11));function w(){const I=E;I.next&&I.next(d())}return w(),{unsubscribe:b(w)}},[Ab](){return this}}}return p({type:Yh.INIT}),{dispatch:p,subscribe:f,getState:d,replaceReducer:g,[Ab]:v}}function GO(t){Object.keys(t).forEach(e=>{const n=t[e];if(typeof n(void 0,{type:Yh.INIT})>"u")throw new Error(Dt(12));if(typeof n(void 0,{type:Yh.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(Dt(13))})}function QO(t){const e=Object.keys(t),n={};for(let i=0;i<e.length;i++){const a=e[i];typeof t[a]=="function"&&(n[a]=t[a])}const r=Object.keys(n);let s;try{GO(n)}catch(i){s=i}return function(a={},l){if(s)throw s;let c=!1;const u={};for(let d=0;d<r.length;d++){const f=r[d],p=n[f],g=a[f],v=p(g,l);if(typeof v>"u")throw l&&l.type,new Error(Dt(14));u[f]=v,c=c||v!==g}return c=c||r.length!==Object.keys(a).length,c?u:a}}function Jh(...t){return t.length===0?e=>e:t.length===1?t[0]:t.reduce((e,n)=>(...r)=>e(n(...r)))}function KO(...t){return e=>(n,r)=>{const s=e(n,r);let i=()=>{throw new Error(Dt(15))};const a={getState:s.getState,dispatch:(c,...u)=>i(c,...u)},l=t.map(c=>c(a));return i=Jh(...l)(s.dispatch),{...s,dispatch:i}}}function XO(t){return av(t)&&"type"in t&&typeof t.type=="string"}var VI=Symbol.for("immer-nothing"),Nb=Symbol.for("immer-draftable"),Zn=Symbol.for("immer-state");function Pr(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var qo=Object.getPrototypeOf;function Na(t){return!!t&&!!t[Zn]}function Us(t){var e;return t?HI(t)||Array.isArray(t)||!!t[Nb]||!!((e=t.constructor)!=null&&e[Nb])||hm(t)||fm(t):!1}var YO=Object.prototype.constructor.toString();function HI(t){if(!t||typeof t!="object")return!1;const e=qo(t);if(e===null)return!0;const n=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return n===Object?!0:typeof n=="function"&&Function.toString.call(n)===YO}function Zh(t,e){dm(t)===0?Reflect.ownKeys(t).forEach(n=>{e(n,t[n],t)}):t.forEach((n,r)=>e(r,n,t))}function dm(t){const e=t[Zn];return e?e.type_:Array.isArray(t)?1:hm(t)?2:fm(t)?3:0}function B0(t,e){return dm(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function WI(t,e,n){const r=dm(t);r===2?t.set(e,n):r===3?t.add(n):t[e]=n}function JO(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}function hm(t){return t instanceof Map}function fm(t){return t instanceof Set}function da(t){return t.copy_||t.base_}function z0(t,e){if(hm(t))return new Map(t);if(fm(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const n=HI(t);if(e===!0||e==="class_only"&&!n){const r=Object.getOwnPropertyDescriptors(t);delete r[Zn];let s=Reflect.ownKeys(r);for(let i=0;i<s.length;i++){const a=s[i],l=r[a];l.writable===!1&&(l.writable=!0,l.configurable=!0),(l.get||l.set)&&(r[a]={configurable:!0,writable:!0,enumerable:l.enumerable,value:t[a]})}return Object.create(qo(t),r)}else{const r=qo(t);if(r!==null&&n)return{...t};const s=Object.create(r);return Object.assign(s,t)}}function ov(t,e=!1){return mm(t)||Na(t)||!Us(t)||(dm(t)>1&&(t.set=t.add=t.clear=t.delete=ZO),Object.freeze(t),e&&Object.entries(t).forEach(([n,r])=>ov(r,!0))),t}function ZO(){Pr(2)}function mm(t){return Object.isFrozen(t)}var e6={};function Pa(t){const e=e6[t];return e||Pr(0,t),e}var Kc;function qI(){return Kc}function t6(t,e){return{drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Pb(t,e){e&&(Pa("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function U0(t){V0(t),t.drafts_.forEach(n6),t.drafts_=null}function V0(t){t===Kc&&(Kc=t.parent_)}function Fb(t){return Kc=t6(Kc,t)}function n6(t){const e=t[Zn];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function Db(t,e){e.unfinalizedDrafts_=e.drafts_.length;const n=e.drafts_[0];return t!==void 0&&t!==n?(n[Zn].modified_&&(U0(e),Pr(4)),Us(t)&&(t=ef(e,t),e.parent_||tf(e,t)),e.patches_&&Pa("Patches").generateReplacementPatches_(n[Zn].base_,t,e.patches_,e.inversePatches_)):t=ef(e,n,[]),U0(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==VI?t:void 0}function ef(t,e,n){if(mm(e))return e;const r=e[Zn];if(!r)return Zh(e,(s,i)=>Lb(t,r,e,s,i,n)),e;if(r.scope_!==t)return e;if(!r.modified_)return tf(t,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const s=r.copy_;let i=s,a=!1;r.type_===3&&(i=new Set(s),s.clear(),a=!0),Zh(i,(l,c)=>Lb(t,r,s,l,c,n,a)),tf(t,s,!1),n&&t.patches_&&Pa("Patches").generatePatches_(r,n,t.patches_,t.inversePatches_)}return r.copy_}function Lb(t,e,n,r,s,i,a){if(Na(s)){const l=i&&e&&e.type_!==3&&!B0(e.assigned_,r)?i.concat(r):void 0,c=ef(t,s,l);if(WI(n,r,c),Na(c))t.canAutoFreeze_=!1;else return}else a&&n.add(s);if(Us(s)&&!mm(s)){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1)return;ef(t,s),(!e||!e.scope_.parent_)&&typeof r!="symbol"&&Object.prototype.propertyIsEnumerable.call(n,r)&&tf(t,s)}}function tf(t,e,n=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&ov(e,n)}function r6(t,e){const n=Array.isArray(t),r={type_:n?1:0,scope_:e?e.scope_:qI(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let s=r,i=lv;n&&(s=[r],i=Xc);const{revoke:a,proxy:l}=Proxy.revocable(s,i);return r.draft_=l,r.revoke_=a,l}var lv={get(t,e){if(e===Zn)return t;const n=da(t);if(!B0(n,e))return s6(t,n,e);const r=n[e];return t.finalized_||!Us(r)?r:r===Zp(t.base_,e)?(eg(t),t.copy_[e]=W0(r,t)):r},has(t,e){return e in da(t)},ownKeys(t){return Reflect.ownKeys(da(t))},set(t,e,n){const r=GI(da(t),e);if(r!=null&&r.set)return r.set.call(t.draft_,n),!0;if(!t.modified_){const s=Zp(da(t),e),i=s==null?void 0:s[Zn];if(i&&i.base_===n)return t.copy_[e]=n,t.assigned_[e]=!1,!0;if(JO(n,s)&&(n!==void 0||B0(t.base_,e)))return!0;eg(t),H0(t)}return t.copy_[e]===n&&(n!==void 0||e in t.copy_)||Number.isNaN(n)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=n,t.assigned_[e]=!0),!0},deleteProperty(t,e){return Zp(t.base_,e)!==void 0||e in t.base_?(t.assigned_[e]=!1,eg(t),H0(t)):delete t.assigned_[e],t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const n=da(t),r=Reflect.getOwnPropertyDescriptor(n,e);return r&&{writable:!0,configurable:t.type_!==1||e!=="length",enumerable:r.enumerable,value:n[e]}},defineProperty(){Pr(11)},getPrototypeOf(t){return qo(t.base_)},setPrototypeOf(){Pr(12)}},Xc={};Zh(lv,(t,e)=>{Xc[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});Xc.deleteProperty=function(t,e){return Xc.set.call(this,t,e,void 0)};Xc.set=function(t,e,n){return lv.set.call(this,t[0],e,n,t[0])};function Zp(t,e){const n=t[Zn];return(n?da(n):t)[e]}function s6(t,e,n){var s;const r=GI(e,n);return r?"value"in r?r.value:(s=r.get)==null?void 0:s.call(t.draft_):void 0}function GI(t,e){if(!(e in t))return;let n=qo(t);for(;n;){const r=Object.getOwnPropertyDescriptor(n,e);if(r)return r;n=qo(n)}}function H0(t){t.modified_||(t.modified_=!0,t.parent_&&H0(t.parent_))}function eg(t){t.copy_||(t.copy_=z0(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var i6=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,n,r)=>{if(typeof e=="function"&&typeof n!="function"){const i=n;n=e;const a=this;return function(c=i,...u){return a.produce(c,d=>n.call(this,d,...u))}}typeof n!="function"&&Pr(6),r!==void 0&&typeof r!="function"&&Pr(7);let s;if(Us(e)){const i=Fb(this),a=W0(e,void 0);let l=!0;try{s=n(a),l=!1}finally{l?U0(i):V0(i)}return Pb(i,r),Db(s,i)}else if(!e||typeof e!="object"){if(s=n(e),s===void 0&&(s=e),s===VI&&(s=void 0),this.autoFreeze_&&ov(s,!0),r){const i=[],a=[];Pa("Patches").generateReplacementPatches_(e,s,i,a),r(i,a)}return s}else Pr(1,e)},this.produceWithPatches=(e,n)=>{if(typeof e=="function")return(a,...l)=>this.produceWithPatches(a,c=>e(c,...l));let r,s;return[this.produce(e,n,(a,l)=>{r=a,s=l}),r,s]},typeof(t==null?void 0:t.autoFreeze)=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof(t==null?void 0:t.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy)}createDraft(t){Us(t)||Pr(8),Na(t)&&(t=a6(t));const e=Fb(this),n=W0(t,void 0);return n[Zn].isManual_=!0,V0(e),n}finishDraft(t,e){const n=t&&t[Zn];(!n||!n.isManual_)&&Pr(9);const{scope_:r}=n;return Pb(r,e),Db(void 0,r)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}applyPatches(t,e){let n;for(n=e.length-1;n>=0;n--){const s=e[n];if(s.path.length===0&&s.op==="replace"){t=s.value;break}}n>-1&&(e=e.slice(n+1));const r=Pa("Patches").applyPatches_;return Na(t)?r(t,e):this.produce(t,s=>r(s,e))}};function W0(t,e){const n=hm(t)?Pa("MapSet").proxyMap_(t,e):fm(t)?Pa("MapSet").proxySet_(t,e):r6(t,e);return(e?e.scope_:qI()).drafts_.push(n),n}function a6(t){return Na(t)||Pr(10,t),QI(t)}function QI(t){if(!Us(t)||mm(t))return t;const e=t[Zn];let n;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,n=z0(t,e.scope_.immer_.useStrictShallowCopy_)}else n=z0(t,!0);return Zh(n,(r,s)=>{WI(n,r,QI(s))}),e&&(e.finalized_=!1),n}var er=new i6,KI=er.produce;er.produceWithPatches.bind(er);er.setAutoFreeze.bind(er);er.setUseStrictShallowCopy.bind(er);er.applyPatches.bind(er);er.createDraft.bind(er);er.finishDraft.bind(er);function XI(t){return({dispatch:n,getState:r})=>s=>i=>typeof i=="function"?i(n,r,t):s(i)}var o6=XI(),l6=XI,c6=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?Jh:Jh.apply(null,arguments)};function Mb(t,e){function n(...r){if(e){let s=e(...r);if(!s)throw new Error(Fs(0));return{type:t,payload:s.payload,..."meta"in s&&{meta:s.meta},..."error"in s&&{error:s.error}}}return{type:t,payload:r[0]}}return n.toString=()=>`${t}`,n.type=t,n.match=r=>XO(r)&&r.type===t,n}var YI=class ac extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,ac.prototype)}static get[Symbol.species](){return ac}concat(...e){return super.concat.apply(this,e)}prepend(...e){return e.length===1&&Array.isArray(e[0])?new ac(...e[0].concat(this)):new ac(...e.concat(this))}};function Ob(t){return Us(t)?KI(t,()=>{}):t}function $b(t,e,n){return t.has(e)?t.get(e):t.set(e,n(e)).get(e)}function u6(t){return typeof t=="boolean"}var d6=()=>function(e){const{thunk:n=!0,immutableCheck:r=!0,serializableCheck:s=!0,actionCreatorCheck:i=!0}=e??{};let a=new YI;return n&&(u6(n)?a.push(o6):a.push(l6(n.extraArgument))),a},h6="RTK_autoBatch",Bb=t=>e=>{setTimeout(e,t)},f6=(t={type:"raf"})=>e=>(...n)=>{const r=e(...n);let s=!0,i=!1,a=!1;const l=new Set,c=t.type==="tick"?queueMicrotask:t.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:Bb(10):t.type==="callback"?t.queueNotification:Bb(t.timeout),u=()=>{a=!1,i&&(i=!1,l.forEach(d=>d()))};return Object.assign({},r,{subscribe(d){const f=()=>s&&d(),p=r.subscribe(f);return l.add(d),()=>{p(),l.delete(d)}},dispatch(d){var f;try{return s=!((f=d==null?void 0:d.meta)!=null&&f[h6]),i=!s,i&&(a||(a=!0,c(u))),r.dispatch(d)}finally{s=!0}}})},m6=t=>function(n){const{autoBatch:r=!0}=n??{};let s=new YI(t);return r&&s.push(f6(typeof r=="object"?r:void 0)),s};function p6(t){const e=d6(),{reducer:n=void 0,middleware:r,devTools:s=!0,preloadedState:i=void 0,enhancers:a=void 0}=t||{};let l;if(typeof n=="function")l=n;else if(av(n))l=QO(n);else throw new Error(Fs(1));let c;typeof r=="function"?c=r(e):c=e();let u=Jh;s&&(u=c6({trace:!1,...typeof s=="object"&&s}));const d=KO(...c),f=m6(d);let p=typeof a=="function"?a(f):f();const g=u(...p);return UI(l,i,g)}function JI(t){const e={},n=[];let r;const s={addCase(i,a){const l=typeof i=="string"?i:i.type;if(!l)throw new Error(Fs(28));if(l in e)throw new Error(Fs(29));return e[l]=a,s},addMatcher(i,a){return n.push({matcher:i,reducer:a}),s},addDefaultCase(i){return r=i,s}};return t(s),[e,n,r]}function g6(t){return typeof t=="function"}function x6(t,e){let[n,r,s]=JI(e),i;if(g6(t))i=()=>Ob(t());else{const l=Ob(t);i=()=>l}function a(l=i(),c){let u=[n[c.type],...r.filter(({matcher:d})=>d(c)).map(({reducer:d})=>d)];return u.filter(d=>!!d).length===0&&(u=[s]),u.reduce((d,f)=>{if(f)if(Na(d)){const g=f(d,c);return g===void 0?d:g}else{if(Us(d))return KI(d,p=>f(p,c));{const p=f(d,c);if(p===void 0){if(d===null)return d;throw Error("A case reducer on a non-draftable value must not return undefined")}return p}}return d},l)}return a.getInitialState=i,a}var y6=Symbol.for("rtk-slice-createasyncthunk");function v6(t,e){return`${t}/${e}`}function w6({creators:t}={}){var n;const e=(n=t==null?void 0:t.asyncThunk)==null?void 0:n[y6];return function(s){const{name:i,reducerPath:a=i}=s;if(!i)throw new Error(Fs(11));typeof process<"u";const l=(typeof s.reducers=="function"?s.reducers(b6()):s.reducers)||{},c=Object.keys(l),u={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},d={addCase(S,I){const F=typeof S=="string"?S:S.type;if(!F)throw new Error(Fs(12));if(F in u.sliceCaseReducersByType)throw new Error(Fs(13));return u.sliceCaseReducersByType[F]=I,d},addMatcher(S,I){return u.sliceMatchers.push({matcher:S,reducer:I}),d},exposeAction(S,I){return u.actionCreators[S]=I,d},exposeCaseReducer(S,I){return u.sliceCaseReducersByName[S]=I,d}};c.forEach(S=>{const I=l[S],F={reducerName:S,type:v6(i,S),createNotation:typeof s.reducers=="function"};E6(I)?T6(F,I,d,e):S6(F,I,d)});function f(){const[S={},I=[],F=void 0]=typeof s.extraReducers=="function"?JI(s.extraReducers):[s.extraReducers],D={...S,...u.sliceCaseReducersByType};return x6(s.initialState,C=>{for(let k in D)C.addCase(k,D[k]);for(let k of u.sliceMatchers)C.addMatcher(k.matcher,k.reducer);for(let k of I)C.addMatcher(k.matcher,k.reducer);F&&C.addDefaultCase(F)})}const p=S=>S,g=new Map;let v;function _(S,I){return v||(v=f()),v(S,I)}function b(){return v||(v=f()),v.getInitialState()}function E(S,I=!1){function F(C){let k=C[S];return typeof k>"u"&&I&&(k=b()),k}function D(C=p){const k=$b(g,I,()=>new WeakMap);return $b(k,C,()=>{const R={};for(const[j,N]of Object.entries(s.selectors??{}))R[j]=_6(N,C,b,I);return R})}return{reducerPath:S,getSelectors:D,get selectors(){return D(F)},selectSlice:F}}const w={name:i,reducer:_,actions:u.actionCreators,caseReducers:u.sliceCaseReducersByName,getInitialState:b,...E(a),injectInto(S,{reducerPath:I,...F}={}){const D=I??a;return S.inject({reducerPath:D,reducer:_},F),{...w,...E(D,!0)}}};return w}}function _6(t,e,n,r){function s(i,...a){let l=e(i);return typeof l>"u"&&r&&(l=n()),t(l,...a)}return s.unwrapped=t,s}var cv=w6();function b6(){function t(e,n){return{_reducerDefinitionType:"asyncThunk",payloadCreator:e,...n}}return t.withTypes=()=>t,{reducer(e){return Object.assign({[e.name](...n){return e(...n)}}[e.name],{_reducerDefinitionType:"reducer"})},preparedReducer(e,n){return{_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:n}},asyncThunk:t}}function S6({type:t,reducerName:e,createNotation:n},r,s){let i,a;if("reducer"in r){if(n&&!k6(r))throw new Error(Fs(17));i=r.reducer,a=r.prepare}else i=r;s.addCase(t,i).exposeCaseReducer(e,i).exposeAction(e,a?Mb(t,a):Mb(t))}function E6(t){return t._reducerDefinitionType==="asyncThunk"}function k6(t){return t._reducerDefinitionType==="reducerWithPrepare"}function T6({type:t,reducerName:e},n,r,s){if(!s)throw new Error(Fs(18));const{payloadCreator:i,fulfilled:a,pending:l,rejected:c,settled:u,options:d}=n,f=s(t,i,d);r.exposeAction(e,f),a&&r.addCase(f.fulfilled,a),l&&r.addCase(f.pending,l),c&&r.addCase(f.rejected,c),u&&r.addMatcher(f.settled,u),r.exposeCaseReducer(e,{fulfilled:a||Cd,pending:l||Cd,rejected:c||Cd,settled:u||Cd})}function Cd(){}function Fs(t){return`Minified Redux Toolkit error #${t}; visit https://redux-toolkit.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}const zb={queueSongs:rn().queue||[],currentQueueId:null,currentSongData:null,isFetching:!1};function tg(t){for(let e=0;e<t.queueSongs.length;e++){const n=t.queueSongs[e];if(n.queue_id===t.currentQueueId){t.currentSongData={song:n,index:e};return}}t.currentSongData=null}const ZI=cv({name:"songQueue",initialState:zb,reducers:{setQueue(t,e){const n=e.payload.songs;t.queueSongs=n,tg(t),Ze("queue",n)},setCurrentQueueId(t,e){const n=e.payload;t.currentQueueId=n,tg(t)},removeSongFromQueue(t,e){const{index:n}=e.payload;t.queueSongs.splice(n,1),Ze("queue",t.queueSongs),t.currentSongData&&n<=t.currentSongData.index&&tg(t)},setIsFetchingRecommend(t,e){t.isFetching=e.payload},addSongToQueue:(t,e)=>{const n=e.payload.songs;t.queueSongs.push(...n),Ze("queue",t.queueSongs)},resetSongQueue:t=>{Ze("queue",[]),Object.assign(t,zb)}}}),$e=t=>t.songQueue,{addSongToQueue:pm,setCurrentQueueId:cs,removeSongFromQueue:I6,setQueue:C6,resetSongQueue:j6,setIsFetchingRecommend:Ub}=ZI.actions,R6=ZI.reducer;function ml({className:t="",playlists:e,loading:n}){const{currentSongData:r}=se($e),s=()=>e.length?e.map((i,a)=>{const l=r==null?void 0:r.song.queue_id.includes(i.id);return o.jsx("div",{className:"p-2 w-1/2 md:w-1/4",children:o.jsx(sv,{active:l,data:i})},a)}):o.jsx(Ke,{className:"mx-auto"});return o.jsx(o.Fragment,{children:o.jsxs("div",{className:`flex flex-row flex-wrap -mx-[8px] ${t}`,children:[n&&tv,!n&&s()]})})}function xs({setTab:t,render:e,tab:n,tabs:r,className:s=""}){const{theme:i}=q(),a={inActiveTab:` hover:bg-${i.alpha}`,activeTab:`${i.content_bg}`};return o.jsx("div",{className:`bg-${i.alpha} p-1.5 space-x-1 rounded-full ${s}`,children:r.map((l,c)=>o.jsx(oe,{size:"clear",onClick:u=>{t(l),u.target.blur()},className:`py-1 px-4 ${l===n?a.activeTab:a.inActiveTab}`,children:e(l)},c))})}function A6({user:t},e){return e?o.jsx("p",{className:"text-xl mb-4 ml-2",ref:e,children:t.display_name}):o.jsx("p",{className:"text-xl mb-4 ml-2",children:t.display_name})}m.forwardRef(A6);function eC(){const{theme:t}=q(),{playerConig:{isCrossFade:e,isEnableBeat:n,lyricSize:r,songBackground:s},updatePlayerConfig:i,audioRef:a,shouldSyncSongDuration:l}=et(),{currentSongData:c}=se($e),u=p=>{i({lyricSize:p}),Ze("lyricSize",p)},d=()=>{if(!a.current||!(c!=null&&c.song))return;const p=!n,g=a.current.currentTime;Ze("current_time",g),l.current=!0,a.current.src=p?c.song.beat_url:c.song.song_url,i({isEnableBeat:p})},f={disableBtn:"bg-white/10 bg-opacity-20",lyricSizeBtn:`group/text justify-center !hover:brightness-100 font-[600] h-[30px] w-[30px] sm:h-[26px] sm:w-[26px] relative ${t.content_hover_bg}`,itemContainer:"flex justify-between  px-3 py-2 items-center min-h-[30px] hover:bg-[#fff]/5",text:"text-sm"};return o.jsx(o.Fragment,{children:o.jsx("div",{className:"w-[240px] sm:w-[220px]",children:o.jsxs(Js,{p:"clear",className:"text-white py-3",theme:t,children:[o.jsxs("div",{className:`${f.itemContainer}`,children:[o.jsx("p",{className:f.text,children:"Lyric size"}),o.jsxs("div",{className:"flex space-x-[8px]",children:[o.jsx(oe,{onClick:()=>u("small"),variant:"circle",size:"clear",className:`${r==="small"?t.content_bg:f.disableBtn} ${f.lyricSizeBtn}`,children:o.jsx("span",{className:"leading-[1] text-[11px]",children:"A"})}),o.jsx(oe,{onClick:()=>u("medium"),variant:"circle",size:"clear",className:`${r==="medium"?t.content_bg:f.disableBtn} ${f.lyricSizeBtn}`,children:o.jsx("span",{className:"leading-[1] text-[13px]",children:"A"})}),o.jsx(oe,{onClick:()=>u("large"),variant:"circle",size:"clear",className:`${r==="large"?t.content_bg:f.disableBtn} ${f.lyricSizeBtn}`,children:o.jsx("span",{className:"leading-[1] text-[15px]",children:"A"})})]})]}),o.jsxs("div",{className:`${f.itemContainer}`,children:[o.jsx("p",{className:f.text,children:"Song background"}),o.jsx(uh,{size:"thin",active:s,cb:()=>i({songBackground:!s})})]}),(c==null?void 0:c.song.beat_url)&&o.jsxs("div",{className:`${f.itemContainer}`,children:[o.jsx("p",{className:f.text,children:"Song beat"}),o.jsx(uh,{size:"thin",active:n,cb:d})]}),o.jsxs("div",{className:`${f.itemContainer}`,children:[o.jsx("p",{className:f.text,children:"Cross fade"}),o.jsx(uh,{size:"thin",active:e,cb:()=>i({isCrossFade:!e})})]})]})})})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tC=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},N6=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],a=t[n++],l=t[n++],c=((s&7)<<18|(i&63)<<12|(a&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const i=t[n++],a=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|a&63)}}return e.join("")},nC={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],a=s+1<t.length,l=a?t[s+1]:0,c=s+2<t.length,u=c?t[s+2]:0,d=i>>2,f=(i&3)<<4|l>>4;let p=(l&15)<<2|u>>6,g=u&63;c||(g=64,a||(p=64)),r.push(n[d],n[f],n[p],n[g])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(tC(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):N6(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],l=s<t.length?n[t.charAt(s)]:0;++s;const u=s<t.length?n[t.charAt(s)]:64;++s;const f=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||l==null||u==null||f==null)throw new P6;const p=i<<2|l>>4;if(r.push(p),u!==64){const g=l<<4&240|u>>2;if(r.push(g),f!==64){const v=u<<6&192|f;r.push(v)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class P6 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const F6=function(t){const e=tC(t);return nC.encodeByteArray(e,!0)},nf=function(t){return F6(t).replace(/\./g,"")},rC=function(t){try{return nC.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D6(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L6=()=>D6().__FIREBASE_DEFAULTS__,M6=()=>{if(typeof process>"u"||typeof process.env>"u")return;const t={}.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},O6=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&rC(t[1]);return e&&JSON.parse(e)},gm=()=>{try{return L6()||M6()||O6()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},sC=t=>{var e,n;return(n=(e=gm())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},iC=t=>{const e=sC(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},aC=()=>{var t;return(t=gm())===null||t===void 0?void 0:t.config},oC=t=>{var e;return(e=gm())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $6{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lC(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t),l="";return[nf(JSON.stringify(n)),nf(JSON.stringify(a)),l].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function on(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function B6(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(on())}function z6(){var t;const e=(t=gm())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function U6(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function V6(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function H6(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function W6(){const t=on();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function q6(){return!z6()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function G6(){try{return typeof indexedDB=="object"}catch{return!1}}function Q6(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K6="FirebaseError";class ys extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=K6,Object.setPrototypeOf(this,ys.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Tu.prototype.create)}}class Tu{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],a=i?X6(i,r):"Error",l=`${this.serviceName}: ${a} (${s}).`;return new ys(s,l,r)}}function X6(t,e){return t.replace(Y6,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const Y6=/\{\$([^}]+)}/g;function J6(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function rf(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],a=e[s];if(Vb(i)&&Vb(a)){if(!rf(i,a))return!1}else if(i!==a)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function Vb(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Iu(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Z6(t,e){const n=new e9(t,e);return n.subscribe.bind(n)}class e9{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");t9(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=ng),s.error===void 0&&(s.error=ng),s.complete===void 0&&(s.complete=ng);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function t9(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function ng(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tt(t){return t&&t._delegate?t._delegate:t}class $i{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ha="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n9{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new $6;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(s9(e))try{this.getOrInitializeService({instanceIdentifier:ha})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=ha){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ha){return this.instances.has(e)}getOptions(e=ha){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,a]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);r===l&&a.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const a=this.instances.get(s);return a&&e(a,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:r9(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=ha){return this.component?this.component.multipleInstances?e:ha:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function r9(t){return t===ha?void 0:t}function s9(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i9{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new n9(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ie;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Ie||(Ie={}));const a9={debug:Ie.DEBUG,verbose:Ie.VERBOSE,info:Ie.INFO,warn:Ie.WARN,error:Ie.ERROR,silent:Ie.SILENT},o9=Ie.INFO,l9={[Ie.DEBUG]:"log",[Ie.VERBOSE]:"log",[Ie.INFO]:"info",[Ie.WARN]:"warn",[Ie.ERROR]:"error"},c9=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=l9[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class uv{constructor(e){this.name=e,this._logLevel=o9,this._logHandler=c9,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ie))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?a9[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ie.DEBUG,...e),this._logHandler(this,Ie.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ie.VERBOSE,...e),this._logHandler(this,Ie.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ie.INFO,...e),this._logHandler(this,Ie.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ie.WARN,...e),this._logHandler(this,Ie.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ie.ERROR,...e),this._logHandler(this,Ie.ERROR,...e)}}const u9=(t,e)=>e.some(n=>t instanceof n);let Hb,Wb;function d9(){return Hb||(Hb=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function h9(){return Wb||(Wb=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const cC=new WeakMap,q0=new WeakMap,uC=new WeakMap,rg=new WeakMap,dv=new WeakMap;function f9(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",a)},i=()=>{n(Pi(t.result)),s()},a=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",a)});return e.then(n=>{n instanceof IDBCursor&&cC.set(n,t)}).catch(()=>{}),dv.set(e,t),e}function m9(t){if(q0.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",a),t.removeEventListener("abort",a)},i=()=>{n(),s()},a=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",a),t.addEventListener("abort",a)});q0.set(t,e)}let G0={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return q0.get(t);if(e==="objectStoreNames")return t.objectStoreNames||uC.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Pi(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function p9(t){G0=t(G0)}function g9(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(sg(this),e,...n);return uC.set(r,e.sort?e.sort():[e]),Pi(r)}:h9().includes(t)?function(...e){return t.apply(sg(this),e),Pi(cC.get(this))}:function(...e){return Pi(t.apply(sg(this),e))}}function x9(t){return typeof t=="function"?g9(t):(t instanceof IDBTransaction&&m9(t),u9(t,d9())?new Proxy(t,G0):t)}function Pi(t){if(t instanceof IDBRequest)return f9(t);if(rg.has(t))return rg.get(t);const e=x9(t);return e!==t&&(rg.set(t,e),dv.set(e,t)),e}const sg=t=>dv.get(t);function y9(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const a=indexedDB.open(t,e),l=Pi(a);return r&&a.addEventListener("upgradeneeded",c=>{r(Pi(a.result),c.oldVersion,c.newVersion,Pi(a.transaction),c)}),n&&a.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),l.then(c=>{i&&c.addEventListener("close",()=>i()),s&&c.addEventListener("versionchange",u=>s(u.oldVersion,u.newVersion,u))}).catch(()=>{}),l}const v9=["get","getKey","getAll","getAllKeys","count"],w9=["put","add","delete","clear"],ig=new Map;function qb(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(ig.get(e))return ig.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=w9.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||v9.includes(n)))return;const i=async function(a,...l){const c=this.transaction(a,s?"readwrite":"readonly");let u=c.store;return r&&(u=u.index(l.shift())),(await Promise.all([u[n](...l),s&&c.done]))[0]};return ig.set(e,i),i}p9(t=>({...t,get:(e,n,r)=>qb(e,n)||t.get(e,n,r),has:(e,n)=>!!qb(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _9{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(b9(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function b9(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Q0="@firebase/app",Gb="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vs=new uv("@firebase/app"),S9="@firebase/app-compat",E9="@firebase/analytics-compat",k9="@firebase/analytics",T9="@firebase/app-check-compat",I9="@firebase/app-check",C9="@firebase/auth",j9="@firebase/auth-compat",R9="@firebase/database",A9="@firebase/data-connect",N9="@firebase/database-compat",P9="@firebase/functions",F9="@firebase/functions-compat",D9="@firebase/installations",L9="@firebase/installations-compat",M9="@firebase/messaging",O9="@firebase/messaging-compat",$9="@firebase/performance",B9="@firebase/performance-compat",z9="@firebase/remote-config",U9="@firebase/remote-config-compat",V9="@firebase/storage",H9="@firebase/storage-compat",W9="@firebase/firestore",q9="@firebase/vertexai-preview",G9="@firebase/firestore-compat",Q9="firebase",K9="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K0="[DEFAULT]",X9={[Q0]:"fire-core",[S9]:"fire-core-compat",[k9]:"fire-analytics",[E9]:"fire-analytics-compat",[I9]:"fire-app-check",[T9]:"fire-app-check-compat",[C9]:"fire-auth",[j9]:"fire-auth-compat",[R9]:"fire-rtdb",[A9]:"fire-data-connect",[N9]:"fire-rtdb-compat",[P9]:"fire-fn",[F9]:"fire-fn-compat",[D9]:"fire-iid",[L9]:"fire-iid-compat",[M9]:"fire-fcm",[O9]:"fire-fcm-compat",[$9]:"fire-perf",[B9]:"fire-perf-compat",[z9]:"fire-rc",[U9]:"fire-rc-compat",[V9]:"fire-gcs",[H9]:"fire-gcs-compat",[W9]:"fire-fst",[G9]:"fire-fst-compat",[q9]:"fire-vertex","fire-js":"fire-js",[Q9]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sf=new Map,Y9=new Map,X0=new Map;function Qb(t,e){try{t.container.addComponent(e)}catch(n){Vs.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Fa(t){const e=t.name;if(X0.has(e))return Vs.debug(`There were multiple attempts to register component ${e}.`),!1;X0.set(e,t);for(const n of sf.values())Qb(n,t);for(const n of Y9.values())Qb(n,t);return!0}function xm(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Cs(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J9={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Fi=new Tu("app","Firebase",J9);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z9{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new $i("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Fi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xa=K9;function dC(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:K0,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw Fi.create("bad-app-name",{appName:String(s)});if(n||(n=aC()),!n)throw Fi.create("no-options");const i=sf.get(s);if(i){if(rf(n,i.options)&&rf(r,i.config))return i;throw Fi.create("duplicate-app",{appName:s})}const a=new i9(s);for(const c of X0.values())a.addComponent(c);const l=new Z9(n,r,a);return sf.set(s,l),l}function hv(t=K0){const e=sf.get(t);if(!e&&t===K0&&aC())return dC();if(!e)throw Fi.create("no-app",{appName:t});return e}function ss(t,e,n){var r;let s=(r=X9[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),a=e.match(/\s|\//);if(i||a){const l=[`Unable to register library "${s}" with version "${e}":`];i&&l.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&a&&l.push("and"),a&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Vs.warn(l.join(" "));return}Fa(new $i(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e$="firebase-heartbeat-database",t$=1,Yc="firebase-heartbeat-store";let ag=null;function hC(){return ag||(ag=y9(e$,t$,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Yc)}catch(n){console.warn(n)}}}}).catch(t=>{throw Fi.create("idb-open",{originalErrorMessage:t.message})})),ag}async function n$(t){try{const n=(await hC()).transaction(Yc),r=await n.objectStore(Yc).get(fC(t));return await n.done,r}catch(e){if(e instanceof ys)Vs.warn(e.message);else{const n=Fi.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Vs.warn(n.message)}}}async function Kb(t,e){try{const r=(await hC()).transaction(Yc,"readwrite");await r.objectStore(Yc).put(e,fC(t)),await r.done}catch(n){if(n instanceof ys)Vs.warn(n.message);else{const r=Fi.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Vs.warn(r.message)}}}function fC(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r$=1024,s$=30*24*60*60*1e3;class i${constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new o$(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Xb();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(a=>a.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const l=new Date(a.date).valueOf();return Date.now()-l<=s$}),this._storage.overwrite(this._heartbeatsCache))}catch(r){Vs.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Xb(),{heartbeatsToSend:r,unsentEntries:s}=a$(this._heartbeatsCache.heartbeats),i=nf(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return Vs.warn(n),""}}}function Xb(){return new Date().toISOString().substring(0,10)}function a$(t,e=r$){const n=[];let r=t.slice();for(const s of t){const i=n.find(a=>a.agent===s.agent);if(i){if(i.dates.push(s.date),Yb(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),Yb(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class o${constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return G6()?Q6().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await n$(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Kb(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Kb(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function Yb(t){return nf(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l$(t){Fa(new $i("platform-logger",e=>new _9(e),"PRIVATE")),Fa(new $i("heartbeat",e=>new i$(e),"PRIVATE")),ss(Q0,Gb,t),ss(Q0,Gb,"esm2017"),ss("fire-js","")}l$("");function fv(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function mC(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const c$=mC,pC=new Tu("auth","Firebase",mC());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const af=new uv("@firebase/auth");function u$(t,...e){af.logLevel<=Ie.WARN&&af.warn(`Auth (${Xa}): ${t}`,...e)}function dh(t,...e){af.logLevel<=Ie.ERROR&&af.error(`Auth (${Xa}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function us(t,...e){throw pv(t,...e)}function $r(t,...e){return pv(t,...e)}function mv(t,e,n){const r=Object.assign(Object.assign({},c$()),{[e]:n});return new Tu("auth","Firebase",r).create(e,{appName:t.name})}function Sa(t){return mv(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function d$(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&us(t,"argument-error"),mv(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function pv(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return pC.create(t,...e)}function ie(t,e,...n){if(!t)throw pv(e,...n)}function js(t){const e="INTERNAL ASSERTION FAILED: "+t;throw dh(e),new Error(e)}function Hs(t,e){t||js(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y0(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function h$(){return Jb()==="http:"||Jb()==="https:"}function Jb(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f$(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(h$()||V6()||"connection"in navigator)?navigator.onLine:!0}function m$(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cu{constructor(e,n){this.shortDelay=e,this.longDelay=n,Hs(n>e,"Short delay should be less than long delay!"),this.isMobile=B6()||H6()}get(){return f$()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gv(t,e){Hs(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gC{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;js("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;js("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;js("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p$={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g$=new Cu(3e4,6e4);function xv(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function pl(t,e,n,r,s={}){return xC(t,s,async()=>{let i={},a={};r&&(e==="GET"?a=r:i={body:JSON.stringify(r)});const l=Iu(Object.assign({key:t.config.apiKey},a)).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const u=Object.assign({method:e,headers:c},i);return U6()||(u.referrerPolicy="no-referrer"),gC.fetch()(yC(t,t.config.apiHost,n,l),u)})}async function xC(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},p$),e);try{const s=new y$(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const a=await i.json();if("needConfirmation"in a)throw jd(t,"account-exists-with-different-credential",a);if(i.ok&&!("errorMessage"in a))return a;{const l=i.ok?a.errorMessage:a.error.message,[c,u]=l.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw jd(t,"credential-already-in-use",a);if(c==="EMAIL_EXISTS")throw jd(t,"email-already-in-use",a);if(c==="USER_DISABLED")throw jd(t,"user-disabled",a);const d=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw mv(t,d,u);us(t,d)}}catch(s){if(s instanceof ys)throw s;us(t,"network-request-failed",{message:String(s)})}}async function x$(t,e,n,r,s={}){const i=await pl(t,e,n,r,s);return"mfaPendingCredential"in i&&us(t,"multi-factor-auth-required",{_serverResponse:i}),i}function yC(t,e,n,r){const s=`${e}${n}?${r}`;return t.config.emulator?gv(t.config,s):`${t.config.apiScheme}://${s}`}class y${constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r($r(this.auth,"network-request-failed")),g$.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function jd(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=$r(t,e,r);return s.customData._tokenResponse=n,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function v$(t,e){return pl(t,"POST","/v1/accounts:delete",e)}async function vC(t,e){return pl(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wc(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function w$(t,e=!1){const n=tt(t),r=await n.getIdToken(e),s=yv(r);ie(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,a=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:wc(og(s.auth_time)),issuedAtTime:wc(og(s.iat)),expirationTime:wc(og(s.exp)),signInProvider:a||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function og(t){return Number(t)*1e3}function yv(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return dh("JWT malformed, contained fewer than 3 sections"),null;try{const s=rC(n);return s?JSON.parse(s):(dh("Failed to decode base64 JWT payload"),null)}catch(s){return dh("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function Zb(t){const e=yv(t);return ie(e,"internal-error"),ie(typeof e.exp<"u","internal-error"),ie(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Jc(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof ys&&_$(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function _$({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b${constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J0{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=wc(this.lastLoginAt),this.creationTime=wc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function of(t){var e;const n=t.auth,r=await t.getIdToken(),s=await Jc(t,vC(n,{idToken:r}));ie(s==null?void 0:s.users.length,n,"internal-error");const i=s.users[0];t._notifyReloadListener(i);const a=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?wC(i.providerUserInfo):[],l=E$(t.providerData,a),c=t.isAnonymous,u=!(t.email&&i.passwordHash)&&!(l!=null&&l.length),d=c?u:!1,f={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:l,metadata:new J0(i.createdAt,i.lastLoginAt),isAnonymous:d};Object.assign(t,f)}async function S$(t){const e=tt(t);await of(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function E$(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function wC(t){return t.map(e=>{var{providerId:n}=e,r=fv(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function k$(t,e){const n=await xC(t,{},async()=>{const r=Iu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,a=yC(t,s,"/v1/token",`key=${i}`),l=await t._getAdditionalHeaders();return l["Content-Type"]="application/x-www-form-urlencoded",gC.fetch()(a,{method:"POST",headers:l,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function T$(t,e){return pl(t,"POST","/v2/accounts:revokeToken",xv(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Do{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ie(e.idToken,"internal-error"),ie(typeof e.idToken<"u","internal-error"),ie(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Zb(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){ie(e.length!==0,"internal-error");const n=Zb(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(ie(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await k$(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,a=new Do;return r&&(ie(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),s&&(ie(typeof s=="string","internal-error",{appName:e}),a.accessToken=s),i&&(ie(typeof i=="number","internal-error",{appName:e}),a.expirationTime=i),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Do,this.toJSON())}_performRefresh(){return js("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ci(t,e){ie(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Rs{constructor(e){var{uid:n,auth:r,stsTokenManager:s}=e,i=fv(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new b$(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new J0(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await Jc(this,this.stsTokenManager.getToken(this.auth,e));return ie(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return w$(this,e)}reload(){return S$(this)}_assign(e){this!==e&&(ie(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Rs(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){ie(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await of(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Cs(this.auth.app))return Promise.reject(Sa(this.auth));const e=await this.getIdToken();return await Jc(this,v$(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,s,i,a,l,c,u,d;const f=(r=n.displayName)!==null&&r!==void 0?r:void 0,p=(s=n.email)!==null&&s!==void 0?s:void 0,g=(i=n.phoneNumber)!==null&&i!==void 0?i:void 0,v=(a=n.photoURL)!==null&&a!==void 0?a:void 0,_=(l=n.tenantId)!==null&&l!==void 0?l:void 0,b=(c=n._redirectEventId)!==null&&c!==void 0?c:void 0,E=(u=n.createdAt)!==null&&u!==void 0?u:void 0,w=(d=n.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:S,emailVerified:I,isAnonymous:F,providerData:D,stsTokenManager:C}=n;ie(S&&C,e,"internal-error");const k=Do.fromJSON(this.name,C);ie(typeof S=="string",e,"internal-error"),ci(f,e.name),ci(p,e.name),ie(typeof I=="boolean",e,"internal-error"),ie(typeof F=="boolean",e,"internal-error"),ci(g,e.name),ci(v,e.name),ci(_,e.name),ci(b,e.name),ci(E,e.name),ci(w,e.name);const R=new Rs({uid:S,auth:e,email:p,emailVerified:I,displayName:f,isAnonymous:F,photoURL:v,phoneNumber:g,tenantId:_,stsTokenManager:k,createdAt:E,lastLoginAt:w});return D&&Array.isArray(D)&&(R.providerData=D.map(j=>Object.assign({},j))),b&&(R._redirectEventId=b),R}static async _fromIdTokenResponse(e,n,r=!1){const s=new Do;s.updateFromServerResponse(n);const i=new Rs({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await of(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];ie(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?wC(s.providerUserInfo):[],a=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),l=new Do;l.updateFromIdToken(r);const c=new Rs({uid:s.localId,auth:e,stsTokenManager:l,isAnonymous:a}),u={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new J0(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(c,u),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eS=new Map;function As(t){Hs(t instanceof Function,"Expected a class definition");let e=eS.get(t);return e?(Hs(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,eS.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _C{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}_C.type="NONE";const tS=_C;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hh(t,e,n){return`firebase:${t}:${e}:${n}`}class Lo{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=hh(this.userKey,s.apiKey,i),this.fullPersistenceKey=hh("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Rs._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new Lo(As(tS),e,r);const s=(await Promise.all(n.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let i=s[0]||As(tS);const a=hh(r,e.config.apiKey,e.name);let l=null;for(const u of n)try{const d=await u._get(a);if(d){const f=Rs._fromJSON(e,d);u!==i&&(l=f),i=u;break}}catch{}const c=s.filter(u=>u._shouldAllowMigration);return!i._shouldAllowMigration||!c.length?new Lo(i,e,r):(i=c[0],l&&await i._set(a,l.toJSON()),await Promise.all(n.map(async u=>{if(u!==i)try{await u._remove(a)}catch{}})),new Lo(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nS(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(kC(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(bC(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(IC(e))return"Blackberry";if(CC(e))return"Webos";if(SC(e))return"Safari";if((e.includes("chrome/")||EC(e))&&!e.includes("edge/"))return"Chrome";if(TC(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function bC(t=on()){return/firefox\//i.test(t)}function SC(t=on()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function EC(t=on()){return/crios\//i.test(t)}function kC(t=on()){return/iemobile/i.test(t)}function TC(t=on()){return/android/i.test(t)}function IC(t=on()){return/blackberry/i.test(t)}function CC(t=on()){return/webos/i.test(t)}function vv(t=on()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function I$(t=on()){var e;return vv(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function C$(){return W6()&&document.documentMode===10}function jC(t=on()){return vv(t)||TC(t)||CC(t)||IC(t)||/windows phone/i.test(t)||kC(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RC(t,e=[]){let n;switch(t){case"Browser":n=nS(on());break;case"Worker":n=`${nS(on())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Xa}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j${constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((a,l)=>{try{const c=e(i);a(c)}catch(c){l(c)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function R$(t,e={}){return pl(t,"GET","/v2/passwordPolicy",xv(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A$=6;class N${constructor(e){var n,r,s,i;const a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=a.minPasswordLength)!==null&&n!==void 0?n:A$,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,s,i,a,l;const c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(n=c.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),c.isValid&&(c.isValid=(r=c.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(s=c.containsLowercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(i=c.containsUppercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(a=c.containsNumericCharacter)!==null&&a!==void 0?a:!0),c.isValid&&(c.isValid=(l=c.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),c}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P${constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new rS(this),this.idTokenSubscription=new rS(this),this.beforeStateQueue=new j$(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=pC,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=As(n)),this._initializationPromise=this.queue(async()=>{var r,s;if(!this._deleted&&(this.persistenceManager=await Lo.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await vC(this,{idToken:e}),r=await Rs._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(Cs(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(l,l))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let s=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,l=s==null?void 0:s._redirectEventId,c=await this.tryRedirectSignIn(e);(!a||a===l)&&(c!=null&&c.user)&&(s=c.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(a){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return ie(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await of(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=m$()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Cs(this.app))return Promise.reject(Sa(this));const n=e?tt(e):null;return n&&ie(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&ie(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Cs(this.app)?Promise.reject(Sa(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Cs(this.app)?Promise.reject(Sa(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(As(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await R$(this),n=new N$(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Tu("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await T$(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&As(e)||this._popupRedirectResolver;ie(n,this,"argument-error"),this.redirectPersistenceManager=await Lo.create(this,[As(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let a=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(ie(l,this,"internal-error"),l.then(()=>{a||i(this.currentUser)}),typeof n=="function"){const c=e.addObserver(n,r,s);return()=>{a=!0,c()}}else{const c=e.addObserver(n);return()=>{a=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ie(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=RC(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(n["X-Firebase-AppCheck"]=s),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&u$(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function ym(t){return tt(t)}class rS{constructor(e){this.auth=e,this.observer=null,this.addObserver=Z6(n=>this.observer=n)}get next(){return ie(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wv={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function F$(t){wv=t}function D$(t){return wv.loadJS(t)}function L$(){return wv.gapiScript}function M$(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O$(t,e){const n=xm(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(rf(i,e??{}))return s;us(s,"already-initialized")}return n.initialize({options:e})}function $$(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(As);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function B$(t,e,n){const r=ym(t);ie(r._canInitEmulator,r,"emulator-config-failed"),ie(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!!(n!=null&&n.disableWarnings),i=AC(e),{host:a,port:l}=z$(e),c=l===null?"":`:${l}`;r.config.emulator={url:`${i}//${a}${c}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:a,port:l,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),s||U$()}function AC(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function z$(t){const e=AC(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:sS(r.substr(i.length+1))}}else{const[i,a]=r.split(":");return{host:i,port:sS(a)}}}function sS(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function U$(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NC{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return js("not implemented")}_getIdTokenResponse(e){return js("not implemented")}_linkToIdToken(e,n){return js("not implemented")}_getReauthenticationResolver(e){return js("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Mo(t,e){return x$(t,"POST","/v1/accounts:signInWithIdp",xv(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V$="http://localhost";class Da extends NC{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Da(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):us("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=n,i=fv(n,["providerId","signInMethod"]);if(!r||!s)return null;const a=new Da(r,s);return a.idToken=i.idToken||void 0,a.accessToken=i.accessToken||void 0,a.secret=i.secret,a.nonce=i.nonce,a.pendingToken=i.pendingToken||null,a}_getIdTokenResponse(e){const n=this.buildRequest();return Mo(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Mo(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Mo(e,n)}buildRequest(){const e={requestUri:V$,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Iu(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _v{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ju extends _v{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pi extends ju{constructor(){super("facebook.com")}static credential(e){return Da._fromParams({providerId:pi.PROVIDER_ID,signInMethod:pi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return pi.credentialFromTaggedObject(e)}static credentialFromError(e){return pi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return pi.credential(e.oauthAccessToken)}catch{return null}}}pi.FACEBOOK_SIGN_IN_METHOD="facebook.com";pi.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ks extends ju{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Da._fromParams({providerId:ks.PROVIDER_ID,signInMethod:ks.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return ks.credentialFromTaggedObject(e)}static credentialFromError(e){return ks.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return ks.credential(n,r)}catch{return null}}}ks.GOOGLE_SIGN_IN_METHOD="google.com";ks.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gi extends ju{constructor(){super("github.com")}static credential(e){return Da._fromParams({providerId:gi.PROVIDER_ID,signInMethod:gi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return gi.credentialFromTaggedObject(e)}static credentialFromError(e){return gi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return gi.credential(e.oauthAccessToken)}catch{return null}}}gi.GITHUB_SIGN_IN_METHOD="github.com";gi.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xi extends ju{constructor(){super("twitter.com")}static credential(e,n){return Da._fromParams({providerId:xi.PROVIDER_ID,signInMethod:xi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return xi.credentialFromTaggedObject(e)}static credentialFromError(e){return xi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return xi.credential(n,r)}catch{return null}}}xi.TWITTER_SIGN_IN_METHOD="twitter.com";xi.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Go{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await Rs._fromIdTokenResponse(e,r,s),a=iS(r);return new Go({user:i,providerId:a,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=iS(r);return new Go({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function iS(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lf extends ys{constructor(e,n,r,s){var i;super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,lf.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new lf(e,n,r,s)}}function PC(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?lf._fromErrorAndOperation(t,i,e,r):i})}async function H$(t,e,n=!1){const r=await Jc(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Go._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function W$(t,e,n=!1){const{auth:r}=t;if(Cs(r.app))return Promise.reject(Sa(r));const s="reauthenticate";try{const i=await Jc(t,PC(r,s,e,t),n);ie(i.idToken,r,"internal-error");const a=yv(i.idToken);ie(a,r,"internal-error");const{sub:l}=a;return ie(t.uid===l,r,"user-mismatch"),Go._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&us(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function q$(t,e,n=!1){if(Cs(t.app))return Promise.reject(Sa(t));const r="signIn",s=await PC(t,r,e),i=await Go._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}function G$(t,e,n,r){return tt(t).onIdTokenChanged(e,n,r)}function Q$(t,e,n){return tt(t).beforeAuthStateChanged(e,n)}function K$(t,e,n,r){return tt(t).onAuthStateChanged(e,n,r)}function FC(t){return tt(t).signOut()}const cf="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DC{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(cf,"1"),this.storage.removeItem(cf),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X$=1e3,Y$=10;class LC extends DC{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=jC(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((a,l,c)=>{this.notifyListeners(a,c)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const a=this.storage.getItem(r);!n&&this.localCache[r]===a||this.notifyListeners(r,a)},i=this.storage.getItem(r);C$()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,Y$):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},X$)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}LC.type="LOCAL";const J$=LC;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MC extends DC{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}MC.type="SESSION";const OC=MC;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z$(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vm{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new vm(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,a=this.handlersMap[s];if(!(a!=null&&a.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const l=Array.from(a).map(async u=>u(n.origin,i)),c=await Z$(l);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:c})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}vm.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bv(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eB{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,a;return new Promise((l,c)=>{const u=bv("",20);s.port1.start();const d=setTimeout(()=>{c(new Error("unsupported_event"))},r);a={messageChannel:s,onMessage(f){const p=f;if(p.data.eventId===u)switch(p.data.status){case"ack":clearTimeout(d),i=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),l(p.data.response);break;default:clearTimeout(d),clearTimeout(i),c(new Error("invalid_response"));break}}},this.handlers.add(a),s.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:u,data:n},[s.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function is(){return window}function tB(t){is().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $C(){return typeof is().WorkerGlobalScope<"u"&&typeof is().importScripts=="function"}async function nB(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function rB(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function sB(){return $C()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BC="firebaseLocalStorageDb",iB=1,uf="firebaseLocalStorage",zC="fbase_key";class Ru{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function wm(t,e){return t.transaction([uf],e?"readwrite":"readonly").objectStore(uf)}function aB(){const t=indexedDB.deleteDatabase(BC);return new Ru(t).toPromise()}function Z0(){const t=indexedDB.open(BC,iB);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(uf,{keyPath:zC})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(uf)?e(r):(r.close(),await aB(),e(await Z0()))})})}async function aS(t,e,n){const r=wm(t,!0).put({[zC]:e,value:n});return new Ru(r).toPromise()}async function oB(t,e){const n=wm(t,!1).get(e),r=await new Ru(n).toPromise();return r===void 0?null:r.value}function oS(t,e){const n=wm(t,!0).delete(e);return new Ru(n).toPromise()}const lB=800,cB=3;class UC{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Z0(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>cB)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return $C()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=vm._getInstance(sB()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await nB(),!this.activeServiceWorker)return;this.sender=new eB(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||rB()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Z0();return await aS(e,cf,"1"),await oS(e,cf),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>aS(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>oB(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>oS(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=wm(s,!1).getAll();return new Ru(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),lB)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}UC.type="LOCAL";const uB=UC;new Cu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VC(t,e){return e?As(e):(ie(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sv extends NC{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Mo(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Mo(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Mo(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function dB(t){return q$(t.auth,new Sv(t),t.bypassAuthState)}function hB(t){const{auth:e,user:n}=t;return ie(n,e,"internal-error"),W$(n,new Sv(t),t.bypassAuthState)}async function fB(t){const{auth:e,user:n}=t;return ie(n,e,"internal-error"),H$(n,new Sv(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HC{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:a,type:l}=e;if(a){this.reject(a);return}const c={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(c))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return dB;case"linkViaPopup":case"linkViaRedirect":return fB;case"reauthViaPopup":case"reauthViaRedirect":return hB;default:us(this.auth,"internal-error")}}resolve(e){Hs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Hs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mB=new Cu(2e3,1e4);async function pB(t,e,n){if(Cs(t.app))return Promise.reject($r(t,"operation-not-supported-in-this-environment"));const r=ym(t);d$(t,e,_v);const s=VC(r,n);return new va(r,"signInViaPopup",e,s).executeNotNull()}class va extends HC{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,va.currentPopupAction&&va.currentPopupAction.cancel(),va.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ie(e,this.auth,"internal-error"),e}async onExecution(){Hs(this.filter.length===1,"Popup operations only handle one event");const e=bv();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject($r(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject($r(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,va.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject($r(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,mB.get())};e()}}va.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gB="pendingRedirect",fh=new Map;class xB extends HC{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=fh.get(this.auth._key());if(!e){try{const r=await yB(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}fh.set(this.auth._key(),e)}return this.bypassAuthState||fh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function yB(t,e){const n=_B(e),r=wB(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function vB(t,e){fh.set(t._key(),e)}function wB(t){return As(t._redirectPersistence)}function _B(t){return hh(gB,t.config.apiKey,t.name)}async function bB(t,e,n=!1){if(Cs(t.app))return Promise.reject(Sa(t));const r=ym(t),s=VC(r,e),a=await new xB(r,s,n).execute();return a&&!n&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SB=10*60*1e3;class EB{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!kB(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!WC(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError($r(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=SB&&this.cachedEventUids.clear(),this.cachedEventUids.has(lS(e))}saveEventToCache(e){this.cachedEventUids.add(lS(e)),this.lastProcessedEventTime=Date.now()}}function lS(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function WC({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function kB(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return WC(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function TB(t,e={}){return pl(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IB=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,CB=/^https?/;async function jB(t){if(t.config.emulator)return;const{authorizedDomains:e}=await TB(t);for(const n of e)try{if(RB(n))return}catch{}us(t,"unauthorized-domain")}function RB(t){const e=Y0(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&a.hostname===r}if(!CB.test(n))return!1;if(IB.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AB=new Cu(3e4,6e4);function cS(){const t=is().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function NB(t){return new Promise((e,n)=>{var r,s,i;function a(){cS(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{cS(),n($r(t,"network-request-failed"))},timeout:AB.get()})}if(!((s=(r=is().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=is().gapi)===null||i===void 0)&&i.load)a();else{const l=M$("iframefcb");return is()[l]=()=>{gapi.load?a():n($r(t,"network-request-failed"))},D$(`${L$()}?onload=${l}`).catch(c=>n(c))}}).catch(e=>{throw mh=null,e})}let mh=null;function PB(t){return mh=mh||NB(t),mh}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FB=new Cu(5e3,15e3),DB="__/auth/iframe",LB="emulator/auth/iframe",MB={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},OB=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function $B(t){const e=t.config;ie(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?gv(e,LB):`https://${t.config.authDomain}/${DB}`,r={apiKey:e.apiKey,appName:t.name,v:Xa},s=OB.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${Iu(r).slice(1)}`}async function BB(t){const e=await PB(t),n=is().gapi;return ie(n,t,"internal-error"),e.open({where:document.body,url:$B(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:MB,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const a=$r(t,"network-request-failed"),l=is().setTimeout(()=>{i(a)},FB.get());function c(){is().clearTimeout(l),s(r)}r.ping(c).then(c,()=>{i(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zB={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},UB=500,VB=600,HB="_blank",WB="http://localhost";class uS{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function qB(t,e,n,r=UB,s=VB){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const c=Object.assign(Object.assign({},zB),{width:r.toString(),height:s.toString(),top:i,left:a}),u=on().toLowerCase();n&&(l=EC(u)?HB:n),bC(u)&&(e=e||WB,c.scrollbars="yes");const d=Object.entries(c).reduce((p,[g,v])=>`${p}${g}=${v},`,"");if(I$(u)&&l!=="_self")return GB(e||"",l),new uS(null);const f=window.open(e||"",l,d);ie(f,t,"popup-blocked");try{f.focus()}catch{}return new uS(f)}function GB(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QB="__/auth/handler",KB="emulator/auth/handler",XB=encodeURIComponent("fac");async function dS(t,e,n,r,s,i){ie(t.config.authDomain,t,"auth-domain-config-required"),ie(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Xa,eventId:s};if(e instanceof _v){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",J6(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,f]of Object.entries(i||{}))a[d]=f}if(e instanceof ju){const d=e.getScopes().filter(f=>f!=="");d.length>0&&(a.scopes=d.join(","))}t.tenantId&&(a.tid=t.tenantId);const l=a;for(const d of Object.keys(l))l[d]===void 0&&delete l[d];const c=await t._getAppCheckToken(),u=c?`#${XB}=${encodeURIComponent(c)}`:"";return`${YB(t)}?${Iu(l).slice(1)}${u}`}function YB({config:t}){return t.emulator?gv(t,KB):`https://${t.authDomain}/${QB}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lg="webStorageSupport";class JB{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=OC,this._completeRedirectFn=bB,this._overrideRedirectResult=vB}async _openPopup(e,n,r,s){var i;Hs((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const a=await dS(e,n,r,Y0(),s);return qB(e,a,bv())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await dS(e,n,r,Y0(),s);return tB(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(Hs(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await BB(e),r=new EB(e);return n.register("authEvent",s=>(ie(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(lg,{type:lg},s=>{var i;const a=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[lg];a!==void 0&&n(!!a),us(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=jB(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return jC()||SC()||vv()}}const ZB=JB;var hS="@firebase/auth",fS="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e7{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){ie(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t7(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function n7(t){Fa(new $i("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:a,authDomain:l}=r.options;ie(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const c={apiKey:a,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:RC(t)},u=new P$(r,s,i,c);return $$(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Fa(new $i("auth-internal",e=>{const n=ym(e.getProvider("auth").getImmediate());return(r=>new e7(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),ss(hS,fS,t7(t)),ss(hS,fS,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r7=5*60,s7=oC("authIdTokenMaxAge")||r7;let mS=null;const i7=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>s7)return;const s=n==null?void 0:n.token;mS!==s&&(mS=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function a7(t=hv()){const e=xm(t,"auth");if(e.isInitialized())return e.getImmediate();const n=O$(t,{popupRedirectResolver:ZB,persistence:[uB,J$,OC]}),r=oC("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const a=i7(i.toString());Q$(n,a,()=>a(n.currentUser)),G$(n,l=>a(l))}}const s=sC("auth");return s&&B$(n,`http://${s}`),n}function o7(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}F$({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=$r("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",o7().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});n7("Browser");/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function l7(t,e,n,r){function s(i){return i instanceof n?i:new n(function(a){a(i)})}return new(n||(n=Promise))(function(i,a){function l(d){try{u(r.next(d))}catch(f){a(f)}}function c(d){try{u(r.throw(d))}catch(f){a(f)}}function u(d){d.done?i(d.value):s(d.value).then(l,c)}u((r=r.apply(t,e||[])).next())})}function c7(t,e){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,s,i,a;return a={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function l(u){return function(d){return c([u,d])}}function c(u){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,s&&(i=u[0]&2?s.return:u[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,u[1])).done)return i;switch(s=0,i&&(u=[u[0]&2,i.value]),u[0]){case 0:case 1:i=u;break;case 4:return n.label++,{value:u[1],done:!1};case 5:n.label++,s=u[1],u=[0];continue;case 7:u=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(u[0]===6||u[0]===2)){n=0;continue}if(u[0]===3&&(!i||u[1]>i[0]&&u[1]<i[3])){n.label=u[1];break}if(u[0]===6&&n.label<i[1]){n.label=i[1],i=u;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(u);break}i[2]&&n.ops.pop(),n.trys.pop();continue}u=e.call(t,n)}catch(d){u=[6,d],s=0}finally{r=i=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Io=function(){return Io=Object.assign||function(e){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Io.apply(this,arguments)},qC=function(t){return{loading:t==null,value:t}},u7=function(){return function(t,e){switch(e.type){case"error":return Io(Io({},t),{error:e.error,loading:!1,value:void 0});case"reset":return qC(e.defaultValue);case"value":return Io(Io({},t),{error:void 0,loading:!1,value:e.value});default:return t}}},d7=function(t){var e=t?t():void 0,n=m.useReducer(u7(),qC(e)),r=n[0],s=n[1],i=m.useCallback(function(){var c=t?t():void 0;s({type:"reset",defaultValue:c})},[t]),a=m.useCallback(function(c){s({type:"error",error:c})},[]),l=m.useCallback(function(c){s({type:"value",value:c})},[]);return m.useMemo(function(){return{error:r.error,loading:r.loading,reset:i,setError:a,setValue:l,value:r.value}},[r.error,r.loading,i,a,l,r.value])},Ev=function(t,e){var n=d7(function(){return t.currentUser}),r=n.error,s=n.loading,i=n.setError,a=n.setValue,l=n.value;return m.useEffect(function(){var c=K$(t,function(u){return l7(void 0,void 0,void 0,function(){var d;return c7(this,function(f){switch(f.label){case 0:if(!(e!=null&&e.onUserChanged))return[3,4];f.label=1;case 1:return f.trys.push([1,3,,4]),[4,e.onUserChanged(u)];case 2:return f.sent(),[3,4];case 3:return d=f.sent(),i(d),[3,4];case 4:return a(u),[2]}})})},i);return function(){c()}},[t]),[l,s,r]},h7="firebase",f7="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ss(h7,f7,"app");var pS=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ea,GC;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(C,k){function R(){}R.prototype=k.prototype,C.D=k.prototype,C.prototype=new R,C.prototype.constructor=C,C.C=function(j,N,P){for(var A=Array(arguments.length-2),ee=2;ee<arguments.length;ee++)A[ee-2]=arguments[ee];return k.prototype[N].apply(j,A)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(C,k,R){R||(R=0);var j=Array(16);if(typeof k=="string")for(var N=0;16>N;++N)j[N]=k.charCodeAt(R++)|k.charCodeAt(R++)<<8|k.charCodeAt(R++)<<16|k.charCodeAt(R++)<<24;else for(N=0;16>N;++N)j[N]=k[R++]|k[R++]<<8|k[R++]<<16|k[R++]<<24;k=C.g[0],R=C.g[1],N=C.g[2];var P=C.g[3],A=k+(P^R&(N^P))+j[0]+3614090360&4294967295;k=R+(A<<7&4294967295|A>>>25),A=P+(N^k&(R^N))+j[1]+3905402710&4294967295,P=k+(A<<12&4294967295|A>>>20),A=N+(R^P&(k^R))+j[2]+606105819&4294967295,N=P+(A<<17&4294967295|A>>>15),A=R+(k^N&(P^k))+j[3]+3250441966&4294967295,R=N+(A<<22&4294967295|A>>>10),A=k+(P^R&(N^P))+j[4]+4118548399&4294967295,k=R+(A<<7&4294967295|A>>>25),A=P+(N^k&(R^N))+j[5]+1200080426&4294967295,P=k+(A<<12&4294967295|A>>>20),A=N+(R^P&(k^R))+j[6]+2821735955&4294967295,N=P+(A<<17&4294967295|A>>>15),A=R+(k^N&(P^k))+j[7]+4249261313&4294967295,R=N+(A<<22&4294967295|A>>>10),A=k+(P^R&(N^P))+j[8]+1770035416&4294967295,k=R+(A<<7&4294967295|A>>>25),A=P+(N^k&(R^N))+j[9]+2336552879&4294967295,P=k+(A<<12&4294967295|A>>>20),A=N+(R^P&(k^R))+j[10]+4294925233&4294967295,N=P+(A<<17&4294967295|A>>>15),A=R+(k^N&(P^k))+j[11]+2304563134&4294967295,R=N+(A<<22&4294967295|A>>>10),A=k+(P^R&(N^P))+j[12]+1804603682&4294967295,k=R+(A<<7&4294967295|A>>>25),A=P+(N^k&(R^N))+j[13]+4254626195&4294967295,P=k+(A<<12&4294967295|A>>>20),A=N+(R^P&(k^R))+j[14]+2792965006&4294967295,N=P+(A<<17&4294967295|A>>>15),A=R+(k^N&(P^k))+j[15]+1236535329&4294967295,R=N+(A<<22&4294967295|A>>>10),A=k+(N^P&(R^N))+j[1]+4129170786&4294967295,k=R+(A<<5&4294967295|A>>>27),A=P+(R^N&(k^R))+j[6]+3225465664&4294967295,P=k+(A<<9&4294967295|A>>>23),A=N+(k^R&(P^k))+j[11]+643717713&4294967295,N=P+(A<<14&4294967295|A>>>18),A=R+(P^k&(N^P))+j[0]+3921069994&4294967295,R=N+(A<<20&4294967295|A>>>12),A=k+(N^P&(R^N))+j[5]+3593408605&4294967295,k=R+(A<<5&4294967295|A>>>27),A=P+(R^N&(k^R))+j[10]+38016083&4294967295,P=k+(A<<9&4294967295|A>>>23),A=N+(k^R&(P^k))+j[15]+3634488961&4294967295,N=P+(A<<14&4294967295|A>>>18),A=R+(P^k&(N^P))+j[4]+3889429448&4294967295,R=N+(A<<20&4294967295|A>>>12),A=k+(N^P&(R^N))+j[9]+568446438&4294967295,k=R+(A<<5&4294967295|A>>>27),A=P+(R^N&(k^R))+j[14]+3275163606&4294967295,P=k+(A<<9&4294967295|A>>>23),A=N+(k^R&(P^k))+j[3]+4107603335&4294967295,N=P+(A<<14&4294967295|A>>>18),A=R+(P^k&(N^P))+j[8]+1163531501&4294967295,R=N+(A<<20&4294967295|A>>>12),A=k+(N^P&(R^N))+j[13]+2850285829&4294967295,k=R+(A<<5&4294967295|A>>>27),A=P+(R^N&(k^R))+j[2]+4243563512&4294967295,P=k+(A<<9&4294967295|A>>>23),A=N+(k^R&(P^k))+j[7]+1735328473&4294967295,N=P+(A<<14&4294967295|A>>>18),A=R+(P^k&(N^P))+j[12]+2368359562&4294967295,R=N+(A<<20&4294967295|A>>>12),A=k+(R^N^P)+j[5]+4294588738&4294967295,k=R+(A<<4&4294967295|A>>>28),A=P+(k^R^N)+j[8]+2272392833&4294967295,P=k+(A<<11&4294967295|A>>>21),A=N+(P^k^R)+j[11]+1839030562&4294967295,N=P+(A<<16&4294967295|A>>>16),A=R+(N^P^k)+j[14]+4259657740&4294967295,R=N+(A<<23&4294967295|A>>>9),A=k+(R^N^P)+j[1]+2763975236&4294967295,k=R+(A<<4&4294967295|A>>>28),A=P+(k^R^N)+j[4]+1272893353&4294967295,P=k+(A<<11&4294967295|A>>>21),A=N+(P^k^R)+j[7]+4139469664&4294967295,N=P+(A<<16&4294967295|A>>>16),A=R+(N^P^k)+j[10]+3200236656&4294967295,R=N+(A<<23&4294967295|A>>>9),A=k+(R^N^P)+j[13]+681279174&4294967295,k=R+(A<<4&4294967295|A>>>28),A=P+(k^R^N)+j[0]+3936430074&4294967295,P=k+(A<<11&4294967295|A>>>21),A=N+(P^k^R)+j[3]+3572445317&4294967295,N=P+(A<<16&4294967295|A>>>16),A=R+(N^P^k)+j[6]+76029189&4294967295,R=N+(A<<23&4294967295|A>>>9),A=k+(R^N^P)+j[9]+3654602809&4294967295,k=R+(A<<4&4294967295|A>>>28),A=P+(k^R^N)+j[12]+3873151461&4294967295,P=k+(A<<11&4294967295|A>>>21),A=N+(P^k^R)+j[15]+530742520&4294967295,N=P+(A<<16&4294967295|A>>>16),A=R+(N^P^k)+j[2]+3299628645&4294967295,R=N+(A<<23&4294967295|A>>>9),A=k+(N^(R|~P))+j[0]+4096336452&4294967295,k=R+(A<<6&4294967295|A>>>26),A=P+(R^(k|~N))+j[7]+1126891415&4294967295,P=k+(A<<10&4294967295|A>>>22),A=N+(k^(P|~R))+j[14]+2878612391&4294967295,N=P+(A<<15&4294967295|A>>>17),A=R+(P^(N|~k))+j[5]+4237533241&4294967295,R=N+(A<<21&4294967295|A>>>11),A=k+(N^(R|~P))+j[12]+1700485571&4294967295,k=R+(A<<6&4294967295|A>>>26),A=P+(R^(k|~N))+j[3]+2399980690&4294967295,P=k+(A<<10&4294967295|A>>>22),A=N+(k^(P|~R))+j[10]+4293915773&4294967295,N=P+(A<<15&4294967295|A>>>17),A=R+(P^(N|~k))+j[1]+2240044497&4294967295,R=N+(A<<21&4294967295|A>>>11),A=k+(N^(R|~P))+j[8]+1873313359&4294967295,k=R+(A<<6&4294967295|A>>>26),A=P+(R^(k|~N))+j[15]+4264355552&4294967295,P=k+(A<<10&4294967295|A>>>22),A=N+(k^(P|~R))+j[6]+2734768916&4294967295,N=P+(A<<15&4294967295|A>>>17),A=R+(P^(N|~k))+j[13]+1309151649&4294967295,R=N+(A<<21&4294967295|A>>>11),A=k+(N^(R|~P))+j[4]+4149444226&4294967295,k=R+(A<<6&4294967295|A>>>26),A=P+(R^(k|~N))+j[11]+3174756917&4294967295,P=k+(A<<10&4294967295|A>>>22),A=N+(k^(P|~R))+j[2]+718787259&4294967295,N=P+(A<<15&4294967295|A>>>17),A=R+(P^(N|~k))+j[9]+3951481745&4294967295,C.g[0]=C.g[0]+k&4294967295,C.g[1]=C.g[1]+(N+(A<<21&4294967295|A>>>11))&4294967295,C.g[2]=C.g[2]+N&4294967295,C.g[3]=C.g[3]+P&4294967295}r.prototype.u=function(C,k){k===void 0&&(k=C.length);for(var R=k-this.blockSize,j=this.B,N=this.h,P=0;P<k;){if(N==0)for(;P<=R;)s(this,C,P),P+=this.blockSize;if(typeof C=="string"){for(;P<k;)if(j[N++]=C.charCodeAt(P++),N==this.blockSize){s(this,j),N=0;break}}else for(;P<k;)if(j[N++]=C[P++],N==this.blockSize){s(this,j),N=0;break}}this.h=N,this.o+=k},r.prototype.v=function(){var C=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);C[0]=128;for(var k=1;k<C.length-8;++k)C[k]=0;var R=8*this.o;for(k=C.length-8;k<C.length;++k)C[k]=R&255,R/=256;for(this.u(C),C=Array(16),k=R=0;4>k;++k)for(var j=0;32>j;j+=8)C[R++]=this.g[k]>>>j&255;return C};function i(C,k){var R=l;return Object.prototype.hasOwnProperty.call(R,C)?R[C]:R[C]=k(C)}function a(C,k){this.h=k;for(var R=[],j=!0,N=C.length-1;0<=N;N--){var P=C[N]|0;j&&P==k||(R[N]=P,j=!1)}this.g=R}var l={};function c(C){return-128<=C&&128>C?i(C,function(k){return new a([k|0],0>k?-1:0)}):new a([C|0],0>C?-1:0)}function u(C){if(isNaN(C)||!isFinite(C))return f;if(0>C)return b(u(-C));for(var k=[],R=1,j=0;C>=R;j++)k[j]=C/R|0,R*=4294967296;return new a(k,0)}function d(C,k){if(C.length==0)throw Error("number format error: empty string");if(k=k||10,2>k||36<k)throw Error("radix out of range: "+k);if(C.charAt(0)=="-")return b(d(C.substring(1),k));if(0<=C.indexOf("-"))throw Error('number format error: interior "-" character');for(var R=u(Math.pow(k,8)),j=f,N=0;N<C.length;N+=8){var P=Math.min(8,C.length-N),A=parseInt(C.substring(N,N+P),k);8>P?(P=u(Math.pow(k,P)),j=j.j(P).add(u(A))):(j=j.j(R),j=j.add(u(A)))}return j}var f=c(0),p=c(1),g=c(16777216);t=a.prototype,t.m=function(){if(_(this))return-b(this).m();for(var C=0,k=1,R=0;R<this.g.length;R++){var j=this.i(R);C+=(0<=j?j:4294967296+j)*k,k*=4294967296}return C},t.toString=function(C){if(C=C||10,2>C||36<C)throw Error("radix out of range: "+C);if(v(this))return"0";if(_(this))return"-"+b(this).toString(C);for(var k=u(Math.pow(C,6)),R=this,j="";;){var N=I(R,k).g;R=E(R,N.j(k));var P=((0<R.g.length?R.g[0]:R.h)>>>0).toString(C);if(R=N,v(R))return P+j;for(;6>P.length;)P="0"+P;j=P+j}},t.i=function(C){return 0>C?0:C<this.g.length?this.g[C]:this.h};function v(C){if(C.h!=0)return!1;for(var k=0;k<C.g.length;k++)if(C.g[k]!=0)return!1;return!0}function _(C){return C.h==-1}t.l=function(C){return C=E(this,C),_(C)?-1:v(C)?0:1};function b(C){for(var k=C.g.length,R=[],j=0;j<k;j++)R[j]=~C.g[j];return new a(R,~C.h).add(p)}t.abs=function(){return _(this)?b(this):this},t.add=function(C){for(var k=Math.max(this.g.length,C.g.length),R=[],j=0,N=0;N<=k;N++){var P=j+(this.i(N)&65535)+(C.i(N)&65535),A=(P>>>16)+(this.i(N)>>>16)+(C.i(N)>>>16);j=A>>>16,P&=65535,A&=65535,R[N]=A<<16|P}return new a(R,R[R.length-1]&-2147483648?-1:0)};function E(C,k){return C.add(b(k))}t.j=function(C){if(v(this)||v(C))return f;if(_(this))return _(C)?b(this).j(b(C)):b(b(this).j(C));if(_(C))return b(this.j(b(C)));if(0>this.l(g)&&0>C.l(g))return u(this.m()*C.m());for(var k=this.g.length+C.g.length,R=[],j=0;j<2*k;j++)R[j]=0;for(j=0;j<this.g.length;j++)for(var N=0;N<C.g.length;N++){var P=this.i(j)>>>16,A=this.i(j)&65535,ee=C.i(N)>>>16,xe=C.i(N)&65535;R[2*j+2*N]+=A*xe,w(R,2*j+2*N),R[2*j+2*N+1]+=P*xe,w(R,2*j+2*N+1),R[2*j+2*N+1]+=A*ee,w(R,2*j+2*N+1),R[2*j+2*N+2]+=P*ee,w(R,2*j+2*N+2)}for(j=0;j<k;j++)R[j]=R[2*j+1]<<16|R[2*j];for(j=k;j<2*k;j++)R[j]=0;return new a(R,0)};function w(C,k){for(;(C[k]&65535)!=C[k];)C[k+1]+=C[k]>>>16,C[k]&=65535,k++}function S(C,k){this.g=C,this.h=k}function I(C,k){if(v(k))throw Error("division by zero");if(v(C))return new S(f,f);if(_(C))return k=I(b(C),k),new S(b(k.g),b(k.h));if(_(k))return k=I(C,b(k)),new S(b(k.g),k.h);if(30<C.g.length){if(_(C)||_(k))throw Error("slowDivide_ only works with positive integers.");for(var R=p,j=k;0>=j.l(C);)R=F(R),j=F(j);var N=D(R,1),P=D(j,1);for(j=D(j,2),R=D(R,2);!v(j);){var A=P.add(j);0>=A.l(C)&&(N=N.add(R),P=A),j=D(j,1),R=D(R,1)}return k=E(C,N.j(k)),new S(N,k)}for(N=f;0<=C.l(k);){for(R=Math.max(1,Math.floor(C.m()/k.m())),j=Math.ceil(Math.log(R)/Math.LN2),j=48>=j?1:Math.pow(2,j-48),P=u(R),A=P.j(k);_(A)||0<A.l(C);)R-=j,P=u(R),A=P.j(k);v(P)&&(P=p),N=N.add(P),C=E(C,A)}return new S(N,C)}t.A=function(C){return I(this,C).h},t.and=function(C){for(var k=Math.max(this.g.length,C.g.length),R=[],j=0;j<k;j++)R[j]=this.i(j)&C.i(j);return new a(R,this.h&C.h)},t.or=function(C){for(var k=Math.max(this.g.length,C.g.length),R=[],j=0;j<k;j++)R[j]=this.i(j)|C.i(j);return new a(R,this.h|C.h)},t.xor=function(C){for(var k=Math.max(this.g.length,C.g.length),R=[],j=0;j<k;j++)R[j]=this.i(j)^C.i(j);return new a(R,this.h^C.h)};function F(C){for(var k=C.g.length+1,R=[],j=0;j<k;j++)R[j]=C.i(j)<<1|C.i(j-1)>>>31;return new a(R,C.h)}function D(C,k){var R=k>>5;k%=32;for(var j=C.g.length-R,N=[],P=0;P<j;P++)N[P]=0<k?C.i(P+R)>>>k|C.i(P+R+1)<<32-k:C.i(P+R);return new a(N,C.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,GC=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=u,a.fromString=d,Ea=a}).apply(typeof pS<"u"?pS:typeof self<"u"?self:typeof window<"u"?window:{});var Rd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var QC,oc,KC,ph,ex,XC,YC,JC;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(h,x,y){return h==Array.prototype||h==Object.prototype||(h[x]=y.value),h};function n(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof Rd=="object"&&Rd];for(var x=0;x<h.length;++x){var y=h[x];if(y&&y.Math==Math)return y}throw Error("Cannot find global object")}var r=n(this);function s(h,x){if(x)e:{var y=r;h=h.split(".");for(var T=0;T<h.length-1;T++){var L=h[T];if(!(L in y))break e;y=y[L]}h=h[h.length-1],T=y[h],x=x(T),x!=T&&x!=null&&e(y,h,{configurable:!0,writable:!0,value:x})}}function i(h,x){h instanceof String&&(h+="");var y=0,T=!1,L={next:function(){if(!T&&y<h.length){var M=y++;return{value:x(M,h[M]),done:!1}}return T=!0,{done:!0,value:void 0}}};return L[Symbol.iterator]=function(){return L},L}s("Array.prototype.values",function(h){return h||function(){return i(this,function(x,y){return y})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},l=this||self;function c(h){var x=typeof h;return x=x!="object"?x:h?Array.isArray(h)?"array":x:"null",x=="array"||x=="object"&&typeof h.length=="number"}function u(h){var x=typeof h;return x=="object"&&h!=null||x=="function"}function d(h,x,y){return h.call.apply(h.bind,arguments)}function f(h,x,y){if(!h)throw Error();if(2<arguments.length){var T=Array.prototype.slice.call(arguments,2);return function(){var L=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(L,T),h.apply(x,L)}}return function(){return h.apply(x,arguments)}}function p(h,x,y){return p=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:f,p.apply(null,arguments)}function g(h,x){var y=Array.prototype.slice.call(arguments,1);return function(){var T=y.slice();return T.push.apply(T,arguments),h.apply(this,T)}}function v(h,x){function y(){}y.prototype=x.prototype,h.aa=x.prototype,h.prototype=new y,h.prototype.constructor=h,h.Qb=function(T,L,M){for(var W=Array(arguments.length-2),Be=2;Be<arguments.length;Be++)W[Be-2]=arguments[Be];return x.prototype[L].apply(T,W)}}function _(h){const x=h.length;if(0<x){const y=Array(x);for(let T=0;T<x;T++)y[T]=h[T];return y}return[]}function b(h,x){for(let y=1;y<arguments.length;y++){const T=arguments[y];if(c(T)){const L=h.length||0,M=T.length||0;h.length=L+M;for(let W=0;W<M;W++)h[L+W]=T[W]}else h.push(T)}}class E{constructor(x,y){this.i=x,this.j=y,this.h=0,this.g=null}get(){let x;return 0<this.h?(this.h--,x=this.g,this.g=x.next,x.next=null):x=this.i(),x}}function w(h){return/^[\s\xa0]*$/.test(h)}function S(){var h=l.navigator;return h&&(h=h.userAgent)?h:""}function I(h){return I[" "](h),h}I[" "]=function(){};var F=S().indexOf("Gecko")!=-1&&!(S().toLowerCase().indexOf("webkit")!=-1&&S().indexOf("Edge")==-1)&&!(S().indexOf("Trident")!=-1||S().indexOf("MSIE")!=-1)&&S().indexOf("Edge")==-1;function D(h,x,y){for(const T in h)x.call(y,h[T],T,h)}function C(h,x){for(const y in h)x.call(void 0,h[y],y,h)}function k(h){const x={};for(const y in h)x[y]=h[y];return x}const R="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function j(h,x){let y,T;for(let L=1;L<arguments.length;L++){T=arguments[L];for(y in T)h[y]=T[y];for(let M=0;M<R.length;M++)y=R[M],Object.prototype.hasOwnProperty.call(T,y)&&(h[y]=T[y])}}function N(h){var x=1;h=h.split(":");const y=[];for(;0<x&&h.length;)y.push(h.shift()),x--;return h.length&&y.push(h.join(":")),y}function P(h){l.setTimeout(()=>{throw h},0)}function A(){var h=Y;let x=null;return h.g&&(x=h.g,h.g=h.g.next,h.g||(h.h=null),x.next=null),x}class ee{constructor(){this.h=this.g=null}add(x,y){const T=xe.get();T.set(x,y),this.h?this.h.next=T:this.g=T,this.h=T}}var xe=new E(()=>new Se,h=>h.reset());class Se{constructor(){this.next=this.g=this.h=null}set(x,y){this.h=x,this.g=y,this.next=null}reset(){this.next=this.g=this.h=null}}let Ue,H=!1,Y=new ee,te=()=>{const h=l.Promise.resolve(void 0);Ue=()=>{h.then(ye)}};var ye=()=>{for(var h;h=A();){try{h.h.call(h.g)}catch(y){P(y)}var x=xe;x.j(h),100>x.h&&(x.h++,h.next=x.g,x.g=h)}H=!1};function Te(){this.s=this.s,this.C=this.C}Te.prototype.s=!1,Te.prototype.ma=function(){this.s||(this.s=!0,this.N())},Te.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function He(h,x){this.type=h,this.g=this.target=x,this.defaultPrevented=!1}He.prototype.h=function(){this.defaultPrevented=!0};var Tr=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var h=!1,x=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const y=()=>{};l.addEventListener("test",y,x),l.removeEventListener("test",y,x)}catch{}return h}();function ir(h,x){if(He.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h){var y=this.type=h.type,T=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;if(this.target=h.target||h.srcElement,this.g=x,x=h.relatedTarget){if(F){e:{try{I(x.nodeName);var L=!0;break e}catch{}L=!1}L||(x=null)}}else y=="mouseover"?x=h.fromElement:y=="mouseout"&&(x=h.toElement);this.relatedTarget=x,T?(this.clientX=T.clientX!==void 0?T.clientX:T.pageX,this.clientY=T.clientY!==void 0?T.clientY:T.pageY,this.screenX=T.screenX||0,this.screenY=T.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=typeof h.pointerType=="string"?h.pointerType:ar[h.pointerType]||"",this.state=h.state,this.i=h,h.defaultPrevented&&ir.aa.h.call(this)}}v(ir,He);var ar={2:"touch",3:"pen",4:"mouse"};ir.prototype.h=function(){ir.aa.h.call(this);var h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var Mn="closure_listenable_"+(1e6*Math.random()|0),Gu=0;function Qu(h,x,y,T,L){this.listener=h,this.proxy=null,this.src=x,this.type=y,this.capture=!!T,this.ha=L,this.key=++Gu,this.da=this.fa=!1}function ta(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function ve(h){this.src=h,this.g={},this.h=0}ve.prototype.add=function(h,x,y,T,L){var M=h.toString();h=this.g[M],h||(h=this.g[M]=[],this.h++);var W=yt(h,x,T,L);return-1<W?(x=h[W],y||(x.fa=!1)):(x=new Qu(x,this.src,M,!!T,L),x.fa=y,h.push(x)),x};function xt(h,x){var y=x.type;if(y in h.g){var T=h.g[y],L=Array.prototype.indexOf.call(T,x,void 0),M;(M=0<=L)&&Array.prototype.splice.call(T,L,1),M&&(ta(x),h.g[y].length==0&&(delete h.g[y],h.h--))}}function yt(h,x,y,T){for(var L=0;L<h.length;++L){var M=h[L];if(!M.da&&M.listener==x&&M.capture==!!y&&M.ha==T)return L}return-1}var On="closure_lm_"+(1e6*Math.random()|0),En={};function Il(h,x,y,T,L){if(T&&T.once)return Xw(h,x,y,T,L);if(Array.isArray(x)){for(var M=0;M<x.length;M++)Il(h,x[M],y,T,L);return null}return y=Ym(y),h&&h[Mn]?h.K(x,y,u(T)?!!T.capture:!!T,L):Kw(h,x,y,!1,T,L)}function Kw(h,x,y,T,L,M){if(!x)throw Error("Invalid event type");var W=u(L)?!!L.capture:!!L,Be=Km(h);if(Be||(h[On]=Be=new ve(h)),y=Be.add(x,y,T,W,M),y.proxy)return y;if(T=aN(),y.proxy=T,T.src=h,T.listener=y,h.addEventListener)Tr||(L=W),L===void 0&&(L=!1),h.addEventListener(x.toString(),T,L);else if(h.attachEvent)h.attachEvent(Jw(x.toString()),T);else if(h.addListener&&h.removeListener)h.addListener(T);else throw Error("addEventListener and attachEvent are unavailable.");return y}function aN(){function h(y){return x.call(h.src,h.listener,y)}const x=oN;return h}function Xw(h,x,y,T,L){if(Array.isArray(x)){for(var M=0;M<x.length;M++)Xw(h,x[M],y,T,L);return null}return y=Ym(y),h&&h[Mn]?h.L(x,y,u(T)?!!T.capture:!!T,L):Kw(h,x,y,!0,T,L)}function Yw(h,x,y,T,L){if(Array.isArray(x))for(var M=0;M<x.length;M++)Yw(h,x[M],y,T,L);else T=u(T)?!!T.capture:!!T,y=Ym(y),h&&h[Mn]?(h=h.i,x=String(x).toString(),x in h.g&&(M=h.g[x],y=yt(M,y,T,L),-1<y&&(ta(M[y]),Array.prototype.splice.call(M,y,1),M.length==0&&(delete h.g[x],h.h--)))):h&&(h=Km(h))&&(x=h.g[x.toString()],h=-1,x&&(h=yt(x,y,T,L)),(y=-1<h?x[h]:null)&&Qm(y))}function Qm(h){if(typeof h!="number"&&h&&!h.da){var x=h.src;if(x&&x[Mn])xt(x.i,h);else{var y=h.type,T=h.proxy;x.removeEventListener?x.removeEventListener(y,T,h.capture):x.detachEvent?x.detachEvent(Jw(y),T):x.addListener&&x.removeListener&&x.removeListener(T),(y=Km(x))?(xt(y,h),y.h==0&&(y.src=null,x[On]=null)):ta(h)}}}function Jw(h){return h in En?En[h]:En[h]="on"+h}function oN(h,x){if(h.da)h=!0;else{x=new ir(x,this);var y=h.listener,T=h.ha||h.src;h.fa&&Qm(h),h=y.call(T,x)}return h}function Km(h){return h=h[On],h instanceof ve?h:null}var Xm="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ym(h){return typeof h=="function"?h:(h[Xm]||(h[Xm]=function(x){return h.handleEvent(x)}),h[Xm])}function Gt(){Te.call(this),this.i=new ve(this),this.M=this,this.F=null}v(Gt,Te),Gt.prototype[Mn]=!0,Gt.prototype.removeEventListener=function(h,x,y,T){Yw(this,h,x,y,T)};function cn(h,x){var y,T=h.F;if(T)for(y=[];T;T=T.F)y.push(T);if(h=h.M,T=x.type||x,typeof x=="string")x=new He(x,h);else if(x instanceof He)x.target=x.target||h;else{var L=x;x=new He(T,h),j(x,L)}if(L=!0,y)for(var M=y.length-1;0<=M;M--){var W=x.g=y[M];L=Ku(W,T,!0,x)&&L}if(W=x.g=h,L=Ku(W,T,!0,x)&&L,L=Ku(W,T,!1,x)&&L,y)for(M=0;M<y.length;M++)W=x.g=y[M],L=Ku(W,T,!1,x)&&L}Gt.prototype.N=function(){if(Gt.aa.N.call(this),this.i){var h=this.i,x;for(x in h.g){for(var y=h.g[x],T=0;T<y.length;T++)ta(y[T]);delete h.g[x],h.h--}}this.F=null},Gt.prototype.K=function(h,x,y,T){return this.i.add(String(h),x,!1,y,T)},Gt.prototype.L=function(h,x,y,T){return this.i.add(String(h),x,!0,y,T)};function Ku(h,x,y,T){if(x=h.i.g[String(x)],!x)return!0;x=x.concat();for(var L=!0,M=0;M<x.length;++M){var W=x[M];if(W&&!W.da&&W.capture==y){var Be=W.listener,Ft=W.ha||W.src;W.fa&&xt(h.i,W),L=Be.call(Ft,T)!==!1&&L}}return L&&!T.defaultPrevented}function Zw(h,x,y){if(typeof h=="function")y&&(h=p(h,y));else if(h&&typeof h.handleEvent=="function")h=p(h.handleEvent,h);else throw Error("Invalid listener argument");return 2147483647<Number(x)?-1:l.setTimeout(h,x||0)}function e1(h){h.g=Zw(()=>{h.g=null,h.i&&(h.i=!1,e1(h))},h.l);const x=h.h;h.h=null,h.m.apply(null,x)}class lN extends Te{constructor(x,y){super(),this.m=x,this.l=y,this.h=null,this.i=!1,this.g=null}j(x){this.h=arguments,this.g?this.i=!0:e1(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Cl(h){Te.call(this),this.h=h,this.g={}}v(Cl,Te);var t1=[];function n1(h){D(h.g,function(x,y){this.g.hasOwnProperty(y)&&Qm(x)},h),h.g={}}Cl.prototype.N=function(){Cl.aa.N.call(this),n1(this)},Cl.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Jm=l.JSON.stringify,cN=l.JSON.parse,uN=class{stringify(h){return l.JSON.stringify(h,void 0)}parse(h){return l.JSON.parse(h,void 0)}};function Zm(){}Zm.prototype.h=null;function r1(h){return h.h||(h.h=h.i())}function s1(){}var jl={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ep(){He.call(this,"d")}v(ep,He);function tp(){He.call(this,"c")}v(tp,He);var na={},i1=null;function Xu(){return i1=i1||new Gt}na.La="serverreachability";function a1(h){He.call(this,na.La,h)}v(a1,He);function Rl(h){const x=Xu();cn(x,new a1(x))}na.STAT_EVENT="statevent";function o1(h,x){He.call(this,na.STAT_EVENT,h),this.stat=x}v(o1,He);function un(h){const x=Xu();cn(x,new o1(x,h))}na.Ma="timingevent";function l1(h,x){He.call(this,na.Ma,h),this.size=x}v(l1,He);function Al(h,x){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){h()},x)}function Nl(){this.g=!0}Nl.prototype.xa=function(){this.g=!1};function dN(h,x,y,T,L,M){h.info(function(){if(h.g)if(M)for(var W="",Be=M.split("&"),Ft=0;Ft<Be.length;Ft++){var Ae=Be[Ft].split("=");if(1<Ae.length){var Qt=Ae[0];Ae=Ae[1];var Kt=Qt.split("_");W=2<=Kt.length&&Kt[1]=="type"?W+(Qt+"="+Ae+"&"):W+(Qt+"=redacted&")}}else W=null;else W=M;return"XMLHTTP REQ ("+T+") [attempt "+L+"]: "+x+`
`+y+`
`+W})}function hN(h,x,y,T,L,M,W){h.info(function(){return"XMLHTTP RESP ("+T+") [ attempt "+L+"]: "+x+`
`+y+`
`+M+" "+W})}function to(h,x,y,T){h.info(function(){return"XMLHTTP TEXT ("+x+"): "+mN(h,y)+(T?" "+T:"")})}function fN(h,x){h.info(function(){return"TIMEOUT: "+x})}Nl.prototype.info=function(){};function mN(h,x){if(!h.g)return x;if(!x)return null;try{var y=JSON.parse(x);if(y){for(h=0;h<y.length;h++)if(Array.isArray(y[h])){var T=y[h];if(!(2>T.length)){var L=T[1];if(Array.isArray(L)&&!(1>L.length)){var M=L[0];if(M!="noop"&&M!="stop"&&M!="close")for(var W=1;W<L.length;W++)L[W]=""}}}}return Jm(y)}catch{return x}}var Yu={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},c1={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},np;function Ju(){}v(Ju,Zm),Ju.prototype.g=function(){return new XMLHttpRequest},Ju.prototype.i=function(){return{}},np=new Ju;function ii(h,x,y,T){this.j=h,this.i=x,this.l=y,this.R=T||1,this.U=new Cl(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new u1}function u1(){this.i=null,this.g="",this.h=!1}var d1={},rp={};function sp(h,x,y){h.L=1,h.v=nd(vs(x)),h.m=y,h.P=!0,h1(h,null)}function h1(h,x){h.F=Date.now(),Zu(h),h.A=vs(h.v);var y=h.A,T=h.R;Array.isArray(T)||(T=[String(T)]),T1(y.i,"t",T),h.C=0,y=h.j.J,h.h=new u1,h.g=H1(h.j,y?x:null,!h.m),0<h.O&&(h.M=new lN(p(h.Y,h,h.g),h.O)),x=h.U,y=h.g,T=h.ca;var L="readystatechange";Array.isArray(L)||(L&&(t1[0]=L.toString()),L=t1);for(var M=0;M<L.length;M++){var W=Il(y,L[M],T||x.handleEvent,!1,x.h||x);if(!W)break;x.g[W.key]=W}x=h.H?k(h.H):{},h.m?(h.u||(h.u="POST"),x["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.A,h.u,h.m,x)):(h.u="GET",h.g.ea(h.A,h.u,null,x)),Rl(),dN(h.i,h.u,h.A,h.l,h.R,h.m)}ii.prototype.ca=function(h){h=h.target;const x=this.M;x&&ws(h)==3?x.j():this.Y(h)},ii.prototype.Y=function(h){try{if(h==this.g)e:{const Kt=ws(this.g);var x=this.g.Ba();const so=this.g.Z();if(!(3>Kt)&&(Kt!=3||this.g&&(this.h.h||this.g.oa()||P1(this.g)))){this.J||Kt!=4||x==7||(x==8||0>=so?Rl(3):Rl(2)),ip(this);var y=this.g.Z();this.X=y;t:if(f1(this)){var T=P1(this.g);h="";var L=T.length,M=ws(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){ra(this),Pl(this);var W="";break t}this.h.i=new l.TextDecoder}for(x=0;x<L;x++)this.h.h=!0,h+=this.h.i.decode(T[x],{stream:!(M&&x==L-1)});T.length=0,this.h.g+=h,this.C=0,W=this.h.g}else W=this.g.oa();if(this.o=y==200,hN(this.i,this.u,this.A,this.l,this.R,Kt,y),this.o){if(this.T&&!this.K){t:{if(this.g){var Be,Ft=this.g;if((Be=Ft.g?Ft.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!w(Be)){var Ae=Be;break t}}Ae=null}if(y=Ae)to(this.i,this.l,y,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,ap(this,y);else{this.o=!1,this.s=3,un(12),ra(this),Pl(this);break e}}if(this.P){y=!0;let Ir;for(;!this.J&&this.C<W.length;)if(Ir=pN(this,W),Ir==rp){Kt==4&&(this.s=4,un(14),y=!1),to(this.i,this.l,null,"[Incomplete Response]");break}else if(Ir==d1){this.s=4,un(15),to(this.i,this.l,W,"[Invalid Chunk]"),y=!1;break}else to(this.i,this.l,Ir,null),ap(this,Ir);if(f1(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Kt!=4||W.length!=0||this.h.h||(this.s=1,un(16),y=!1),this.o=this.o&&y,!y)to(this.i,this.l,W,"[Invalid Chunked Response]"),ra(this),Pl(this);else if(0<W.length&&!this.W){this.W=!0;var Qt=this.j;Qt.g==this&&Qt.ba&&!Qt.M&&(Qt.j.info("Great, no buffering proxy detected. Bytes received: "+W.length),hp(Qt),Qt.M=!0,un(11))}}else to(this.i,this.l,W,null),ap(this,W);Kt==4&&ra(this),this.o&&!this.J&&(Kt==4?B1(this.j,this):(this.o=!1,Zu(this)))}else NN(this.g),y==400&&0<W.indexOf("Unknown SID")?(this.s=3,un(12)):(this.s=0,un(13)),ra(this),Pl(this)}}}catch{}finally{}};function f1(h){return h.g?h.u=="GET"&&h.L!=2&&h.j.Ca:!1}function pN(h,x){var y=h.C,T=x.indexOf(`
`,y);return T==-1?rp:(y=Number(x.substring(y,T)),isNaN(y)?d1:(T+=1,T+y>x.length?rp:(x=x.slice(T,T+y),h.C=T+y,x)))}ii.prototype.cancel=function(){this.J=!0,ra(this)};function Zu(h){h.S=Date.now()+h.I,m1(h,h.I)}function m1(h,x){if(h.B!=null)throw Error("WatchDog timer not null");h.B=Al(p(h.ba,h),x)}function ip(h){h.B&&(l.clearTimeout(h.B),h.B=null)}ii.prototype.ba=function(){this.B=null;const h=Date.now();0<=h-this.S?(fN(this.i,this.A),this.L!=2&&(Rl(),un(17)),ra(this),this.s=2,Pl(this)):m1(this,this.S-h)};function Pl(h){h.j.G==0||h.J||B1(h.j,h)}function ra(h){ip(h);var x=h.M;x&&typeof x.ma=="function"&&x.ma(),h.M=null,n1(h.U),h.g&&(x=h.g,h.g=null,x.abort(),x.ma())}function ap(h,x){try{var y=h.j;if(y.G!=0&&(y.g==h||op(y.h,h))){if(!h.K&&op(y.h,h)&&y.G==3){try{var T=y.Da.g.parse(x)}catch{T=null}if(Array.isArray(T)&&T.length==3){var L=T;if(L[0]==0){e:if(!y.u){if(y.g)if(y.g.F+3e3<h.F)ld(y),ad(y);else break e;dp(y),un(18)}}else y.za=L[1],0<y.za-y.T&&37500>L[2]&&y.F&&y.v==0&&!y.C&&(y.C=Al(p(y.Za,y),6e3));if(1>=x1(y.h)&&y.ca){try{y.ca()}catch{}y.ca=void 0}}else ia(y,11)}else if((h.K||y.g==h)&&ld(y),!w(x))for(L=y.Da.g.parse(x),x=0;x<L.length;x++){let Ae=L[x];if(y.T=Ae[0],Ae=Ae[1],y.G==2)if(Ae[0]=="c"){y.K=Ae[1],y.ia=Ae[2];const Qt=Ae[3];Qt!=null&&(y.la=Qt,y.j.info("VER="+y.la));const Kt=Ae[4];Kt!=null&&(y.Aa=Kt,y.j.info("SVER="+y.Aa));const so=Ae[5];so!=null&&typeof so=="number"&&0<so&&(T=1.5*so,y.L=T,y.j.info("backChannelRequestTimeoutMs_="+T)),T=y;const Ir=h.g;if(Ir){const ud=Ir.g?Ir.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ud){var M=T.h;M.g||ud.indexOf("spdy")==-1&&ud.indexOf("quic")==-1&&ud.indexOf("h2")==-1||(M.j=M.l,M.g=new Set,M.h&&(lp(M,M.h),M.h=null))}if(T.D){const fp=Ir.g?Ir.g.getResponseHeader("X-HTTP-Session-Id"):null;fp&&(T.ya=fp,We(T.I,T.D,fp))}}y.G=3,y.l&&y.l.ua(),y.ba&&(y.R=Date.now()-h.F,y.j.info("Handshake RTT: "+y.R+"ms")),T=y;var W=h;if(T.qa=V1(T,T.J?T.ia:null,T.W),W.K){y1(T.h,W);var Be=W,Ft=T.L;Ft&&(Be.I=Ft),Be.B&&(ip(Be),Zu(Be)),T.g=W}else O1(T);0<y.i.length&&od(y)}else Ae[0]!="stop"&&Ae[0]!="close"||ia(y,7);else y.G==3&&(Ae[0]=="stop"||Ae[0]=="close"?Ae[0]=="stop"?ia(y,7):up(y):Ae[0]!="noop"&&y.l&&y.l.ta(Ae),y.v=0)}}Rl(4)}catch{}}var gN=class{constructor(h,x){this.g=h,this.map=x}};function p1(h){this.l=h||10,l.PerformanceNavigationTiming?(h=l.performance.getEntriesByType("navigation"),h=0<h.length&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function g1(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function x1(h){return h.h?1:h.g?h.g.size:0}function op(h,x){return h.h?h.h==x:h.g?h.g.has(x):!1}function lp(h,x){h.g?h.g.add(x):h.h=x}function y1(h,x){h.h&&h.h==x?h.h=null:h.g&&h.g.has(x)&&h.g.delete(x)}p1.prototype.cancel=function(){if(this.i=v1(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function v1(h){if(h.h!=null)return h.i.concat(h.h.D);if(h.g!=null&&h.g.size!==0){let x=h.i;for(const y of h.g.values())x=x.concat(y.D);return x}return _(h.i)}function xN(h){if(h.V&&typeof h.V=="function")return h.V();if(typeof Map<"u"&&h instanceof Map||typeof Set<"u"&&h instanceof Set)return Array.from(h.values());if(typeof h=="string")return h.split("");if(c(h)){for(var x=[],y=h.length,T=0;T<y;T++)x.push(h[T]);return x}x=[],y=0;for(T in h)x[y++]=h[T];return x}function yN(h){if(h.na&&typeof h.na=="function")return h.na();if(!h.V||typeof h.V!="function"){if(typeof Map<"u"&&h instanceof Map)return Array.from(h.keys());if(!(typeof Set<"u"&&h instanceof Set)){if(c(h)||typeof h=="string"){var x=[];h=h.length;for(var y=0;y<h;y++)x.push(y);return x}x=[],y=0;for(const T in h)x[y++]=T;return x}}}function w1(h,x){if(h.forEach&&typeof h.forEach=="function")h.forEach(x,void 0);else if(c(h)||typeof h=="string")Array.prototype.forEach.call(h,x,void 0);else for(var y=yN(h),T=xN(h),L=T.length,M=0;M<L;M++)x.call(void 0,T[M],y&&y[M],h)}var _1=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function vN(h,x){if(h){h=h.split("&");for(var y=0;y<h.length;y++){var T=h[y].indexOf("="),L=null;if(0<=T){var M=h[y].substring(0,T);L=h[y].substring(T+1)}else M=h[y];x(M,L?decodeURIComponent(L.replace(/\+/g," ")):"")}}}function sa(h){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,h instanceof sa){this.h=h.h,ed(this,h.j),this.o=h.o,this.g=h.g,td(this,h.s),this.l=h.l;var x=h.i,y=new Ll;y.i=x.i,x.g&&(y.g=new Map(x.g),y.h=x.h),b1(this,y),this.m=h.m}else h&&(x=String(h).match(_1))?(this.h=!1,ed(this,x[1]||"",!0),this.o=Fl(x[2]||""),this.g=Fl(x[3]||"",!0),td(this,x[4]),this.l=Fl(x[5]||"",!0),b1(this,x[6]||"",!0),this.m=Fl(x[7]||"")):(this.h=!1,this.i=new Ll(null,this.h))}sa.prototype.toString=function(){var h=[],x=this.j;x&&h.push(Dl(x,S1,!0),":");var y=this.g;return(y||x=="file")&&(h.push("//"),(x=this.o)&&h.push(Dl(x,S1,!0),"@"),h.push(encodeURIComponent(String(y)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),y=this.s,y!=null&&h.push(":",String(y))),(y=this.l)&&(this.g&&y.charAt(0)!="/"&&h.push("/"),h.push(Dl(y,y.charAt(0)=="/"?bN:_N,!0))),(y=this.i.toString())&&h.push("?",y),(y=this.m)&&h.push("#",Dl(y,EN)),h.join("")};function vs(h){return new sa(h)}function ed(h,x,y){h.j=y?Fl(x,!0):x,h.j&&(h.j=h.j.replace(/:$/,""))}function td(h,x){if(x){if(x=Number(x),isNaN(x)||0>x)throw Error("Bad port number "+x);h.s=x}else h.s=null}function b1(h,x,y){x instanceof Ll?(h.i=x,kN(h.i,h.h)):(y||(x=Dl(x,SN)),h.i=new Ll(x,h.h))}function We(h,x,y){h.i.set(x,y)}function nd(h){return We(h,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),h}function Fl(h,x){return h?x?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function Dl(h,x,y){return typeof h=="string"?(h=encodeURI(h).replace(x,wN),y&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function wN(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var S1=/[#\/\?@]/g,_N=/[#\?:]/g,bN=/[#\?]/g,SN=/[#\?@]/g,EN=/#/g;function Ll(h,x){this.h=this.g=null,this.i=h||null,this.j=!!x}function ai(h){h.g||(h.g=new Map,h.h=0,h.i&&vN(h.i,function(x,y){h.add(decodeURIComponent(x.replace(/\+/g," ")),y)}))}t=Ll.prototype,t.add=function(h,x){ai(this),this.i=null,h=no(this,h);var y=this.g.get(h);return y||this.g.set(h,y=[]),y.push(x),this.h+=1,this};function E1(h,x){ai(h),x=no(h,x),h.g.has(x)&&(h.i=null,h.h-=h.g.get(x).length,h.g.delete(x))}function k1(h,x){return ai(h),x=no(h,x),h.g.has(x)}t.forEach=function(h,x){ai(this),this.g.forEach(function(y,T){y.forEach(function(L){h.call(x,L,T,this)},this)},this)},t.na=function(){ai(this);const h=Array.from(this.g.values()),x=Array.from(this.g.keys()),y=[];for(let T=0;T<x.length;T++){const L=h[T];for(let M=0;M<L.length;M++)y.push(x[T])}return y},t.V=function(h){ai(this);let x=[];if(typeof h=="string")k1(this,h)&&(x=x.concat(this.g.get(no(this,h))));else{h=Array.from(this.g.values());for(let y=0;y<h.length;y++)x=x.concat(h[y])}return x},t.set=function(h,x){return ai(this),this.i=null,h=no(this,h),k1(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[x]),this.h+=1,this},t.get=function(h,x){return h?(h=this.V(h),0<h.length?String(h[0]):x):x};function T1(h,x,y){E1(h,x),0<y.length&&(h.i=null,h.g.set(no(h,x),_(y)),h.h+=y.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],x=Array.from(this.g.keys());for(var y=0;y<x.length;y++){var T=x[y];const M=encodeURIComponent(String(T)),W=this.V(T);for(T=0;T<W.length;T++){var L=M;W[T]!==""&&(L+="="+encodeURIComponent(String(W[T]))),h.push(L)}}return this.i=h.join("&")};function no(h,x){return x=String(x),h.j&&(x=x.toLowerCase()),x}function kN(h,x){x&&!h.j&&(ai(h),h.i=null,h.g.forEach(function(y,T){var L=T.toLowerCase();T!=L&&(E1(this,T),T1(this,L,y))},h)),h.j=x}function TN(h,x){const y=new Nl;if(l.Image){const T=new Image;T.onload=g(oi,y,"TestLoadImage: loaded",!0,x,T),T.onerror=g(oi,y,"TestLoadImage: error",!1,x,T),T.onabort=g(oi,y,"TestLoadImage: abort",!1,x,T),T.ontimeout=g(oi,y,"TestLoadImage: timeout",!1,x,T),l.setTimeout(function(){T.ontimeout&&T.ontimeout()},1e4),T.src=h}else x(!1)}function IN(h,x){const y=new Nl,T=new AbortController,L=setTimeout(()=>{T.abort(),oi(y,"TestPingServer: timeout",!1,x)},1e4);fetch(h,{signal:T.signal}).then(M=>{clearTimeout(L),M.ok?oi(y,"TestPingServer: ok",!0,x):oi(y,"TestPingServer: server error",!1,x)}).catch(()=>{clearTimeout(L),oi(y,"TestPingServer: error",!1,x)})}function oi(h,x,y,T,L){try{L&&(L.onload=null,L.onerror=null,L.onabort=null,L.ontimeout=null),T(y)}catch{}}function CN(){this.g=new uN}function jN(h,x,y){const T=y||"";try{w1(h,function(L,M){let W=L;u(L)&&(W=Jm(L)),x.push(T+M+"="+encodeURIComponent(W))})}catch(L){throw x.push(T+"type="+encodeURIComponent("_badmap")),L}}function rd(h){this.l=h.Ub||null,this.j=h.eb||!1}v(rd,Zm),rd.prototype.g=function(){return new sd(this.l,this.j)},rd.prototype.i=function(h){return function(){return h}}({});function sd(h,x){Gt.call(this),this.D=h,this.o=x,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}v(sd,Gt),t=sd.prototype,t.open=function(h,x){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=h,this.A=x,this.readyState=1,Ol(this)},t.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const x={headers:this.u,method:this.B,credentials:this.m,cache:void 0};h&&(x.body=h),(this.D||l).fetch(new Request(this.A,x)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ml(this)),this.readyState=0},t.Sa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,Ol(this)),this.g&&(this.readyState=3,Ol(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;I1(this)}else h.text().then(this.Ra.bind(this),this.ga.bind(this))};function I1(h){h.j.read().then(h.Pa.bind(h)).catch(h.ga.bind(h))}t.Pa=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var x=h.value?h.value:new Uint8Array(0);(x=this.v.decode(x,{stream:!h.done}))&&(this.response=this.responseText+=x)}h.done?Ml(this):Ol(this),this.readyState==3&&I1(this)}},t.Ra=function(h){this.g&&(this.response=this.responseText=h,Ml(this))},t.Qa=function(h){this.g&&(this.response=h,Ml(this))},t.ga=function(){this.g&&Ml(this)};function Ml(h){h.readyState=4,h.l=null,h.j=null,h.v=null,Ol(h)}t.setRequestHeader=function(h,x){this.u.append(h,x)},t.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],x=this.h.entries();for(var y=x.next();!y.done;)y=y.value,h.push(y[0]+": "+y[1]),y=x.next();return h.join(`\r
`)};function Ol(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(sd.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function C1(h){let x="";return D(h,function(y,T){x+=T,x+=":",x+=y,x+=`\r
`}),x}function cp(h,x,y){e:{for(T in y){var T=!1;break e}T=!0}T||(y=C1(y),typeof h=="string"?y!=null&&encodeURIComponent(String(y)):We(h,x,y))}function ot(h){Gt.call(this),this.headers=new Map,this.o=h||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}v(ot,Gt);var RN=/^https?$/i,AN=["POST","PUT"];t=ot.prototype,t.Ha=function(h){this.J=h},t.ea=function(h,x,y,T){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);x=x?x.toUpperCase():"GET",this.D=h,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():np.g(),this.v=this.o?r1(this.o):r1(np),this.g.onreadystatechange=p(this.Ea,this);try{this.B=!0,this.g.open(x,String(h),!0),this.B=!1}catch(M){j1(this,M);return}if(h=y||"",y=new Map(this.headers),T)if(Object.getPrototypeOf(T)===Object.prototype)for(var L in T)y.set(L,T[L]);else if(typeof T.keys=="function"&&typeof T.get=="function")for(const M of T.keys())y.set(M,T.get(M));else throw Error("Unknown input type for opt_headers: "+String(T));T=Array.from(y.keys()).find(M=>M.toLowerCase()=="content-type"),L=l.FormData&&h instanceof l.FormData,!(0<=Array.prototype.indexOf.call(AN,x,void 0))||T||L||y.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[M,W]of y)this.g.setRequestHeader(M,W);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{N1(this),this.u=!0,this.g.send(h),this.u=!1}catch(M){j1(this,M)}};function j1(h,x){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=x,h.m=5,R1(h),id(h)}function R1(h){h.A||(h.A=!0,cn(h,"complete"),cn(h,"error"))}t.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=h||7,cn(this,"complete"),cn(this,"abort"),id(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),id(this,!0)),ot.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?A1(this):this.bb())},t.bb=function(){A1(this)};function A1(h){if(h.h&&typeof a<"u"&&(!h.v[1]||ws(h)!=4||h.Z()!=2)){if(h.u&&ws(h)==4)Zw(h.Ea,0,h);else if(cn(h,"readystatechange"),ws(h)==4){h.h=!1;try{const W=h.Z();e:switch(W){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var x=!0;break e;default:x=!1}var y;if(!(y=x)){var T;if(T=W===0){var L=String(h.D).match(_1)[1]||null;!L&&l.self&&l.self.location&&(L=l.self.location.protocol.slice(0,-1)),T=!RN.test(L?L.toLowerCase():"")}y=T}if(y)cn(h,"complete"),cn(h,"success");else{h.m=6;try{var M=2<ws(h)?h.g.statusText:""}catch{M=""}h.l=M+" ["+h.Z()+"]",R1(h)}}finally{id(h)}}}}function id(h,x){if(h.g){N1(h);const y=h.g,T=h.v[0]?()=>{}:null;h.g=null,h.v=null,x||cn(h,"ready");try{y.onreadystatechange=T}catch{}}}function N1(h){h.I&&(l.clearTimeout(h.I),h.I=null)}t.isActive=function(){return!!this.g};function ws(h){return h.g?h.g.readyState:0}t.Z=function(){try{return 2<ws(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(h){if(this.g){var x=this.g.responseText;return h&&x.indexOf(h)==0&&(x=x.substring(h.length)),cN(x)}};function P1(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.H){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function NN(h){const x={};h=(h.g&&2<=ws(h)&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let T=0;T<h.length;T++){if(w(h[T]))continue;var y=N(h[T]);const L=y[0];if(y=y[1],typeof y!="string")continue;y=y.trim();const M=x[L]||[];x[L]=M,M.push(y)}C(x,function(T){return T.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function $l(h,x,y){return y&&y.internalChannelParams&&y.internalChannelParams[h]||x}function F1(h){this.Aa=0,this.i=[],this.j=new Nl,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=$l("failFast",!1,h),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=$l("baseRetryDelayMs",5e3,h),this.cb=$l("retryDelaySeedMs",1e4,h),this.Wa=$l("forwardChannelMaxRetries",2,h),this.wa=$l("forwardChannelRequestTimeoutMs",2e4,h),this.pa=h&&h.xmlHttpFactory||void 0,this.Xa=h&&h.Tb||void 0,this.Ca=h&&h.useFetchStreams||!1,this.L=void 0,this.J=h&&h.supportsCrossDomainXhr||!1,this.K="",this.h=new p1(h&&h.concurrentRequestLimit),this.Da=new CN,this.P=h&&h.fastHandshake||!1,this.O=h&&h.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=h&&h.Rb||!1,h&&h.xa&&this.j.xa(),h&&h.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&h&&h.detectBufferingProxy||!1,this.ja=void 0,h&&h.longPollingTimeout&&0<h.longPollingTimeout&&(this.ja=h.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=F1.prototype,t.la=8,t.G=1,t.connect=function(h,x,y,T){un(0),this.W=h,this.H=x||{},y&&T!==void 0&&(this.H.OSID=y,this.H.OAID=T),this.F=this.X,this.I=V1(this,null,this.W),od(this)};function up(h){if(D1(h),h.G==3){var x=h.U++,y=vs(h.I);if(We(y,"SID",h.K),We(y,"RID",x),We(y,"TYPE","terminate"),Bl(h,y),x=new ii(h,h.j,x),x.L=2,x.v=nd(vs(y)),y=!1,l.navigator&&l.navigator.sendBeacon)try{y=l.navigator.sendBeacon(x.v.toString(),"")}catch{}!y&&l.Image&&(new Image().src=x.v,y=!0),y||(x.g=H1(x.j,null),x.g.ea(x.v)),x.F=Date.now(),Zu(x)}U1(h)}function ad(h){h.g&&(hp(h),h.g.cancel(),h.g=null)}function D1(h){ad(h),h.u&&(l.clearTimeout(h.u),h.u=null),ld(h),h.h.cancel(),h.s&&(typeof h.s=="number"&&l.clearTimeout(h.s),h.s=null)}function od(h){if(!g1(h.h)&&!h.s){h.s=!0;var x=h.Ga;Ue||te(),H||(Ue(),H=!0),Y.add(x,h),h.B=0}}function PN(h,x){return x1(h.h)>=h.h.j-(h.s?1:0)?!1:h.s?(h.i=x.D.concat(h.i),!0):h.G==1||h.G==2||h.B>=(h.Va?0:h.Wa)?!1:(h.s=Al(p(h.Ga,h,x),z1(h,h.B)),h.B++,!0)}t.Ga=function(h){if(this.s)if(this.s=null,this.G==1){if(!h){this.U=Math.floor(1e5*Math.random()),h=this.U++;const L=new ii(this,this.j,h);let M=this.o;if(this.S&&(M?(M=k(M),j(M,this.S)):M=this.S),this.m!==null||this.O||(L.H=M,M=null),this.P)e:{for(var x=0,y=0;y<this.i.length;y++){t:{var T=this.i[y];if("__data__"in T.map&&(T=T.map.__data__,typeof T=="string")){T=T.length;break t}T=void 0}if(T===void 0)break;if(x+=T,4096<x){x=y;break e}if(x===4096||y===this.i.length-1){x=y+1;break e}}x=1e3}else x=1e3;x=M1(this,L,x),y=vs(this.I),We(y,"RID",h),We(y,"CVER",22),this.D&&We(y,"X-HTTP-Session-Id",this.D),Bl(this,y),M&&(this.O?x="headers="+encodeURIComponent(String(C1(M)))+"&"+x:this.m&&cp(y,this.m,M)),lp(this.h,L),this.Ua&&We(y,"TYPE","init"),this.P?(We(y,"$req",x),We(y,"SID","null"),L.T=!0,sp(L,y,null)):sp(L,y,x),this.G=2}}else this.G==3&&(h?L1(this,h):this.i.length==0||g1(this.h)||L1(this))};function L1(h,x){var y;x?y=x.l:y=h.U++;const T=vs(h.I);We(T,"SID",h.K),We(T,"RID",y),We(T,"AID",h.T),Bl(h,T),h.m&&h.o&&cp(T,h.m,h.o),y=new ii(h,h.j,y,h.B+1),h.m===null&&(y.H=h.o),x&&(h.i=x.D.concat(h.i)),x=M1(h,y,1e3),y.I=Math.round(.5*h.wa)+Math.round(.5*h.wa*Math.random()),lp(h.h,y),sp(y,T,x)}function Bl(h,x){h.H&&D(h.H,function(y,T){We(x,T,y)}),h.l&&w1({},function(y,T){We(x,T,y)})}function M1(h,x,y){y=Math.min(h.i.length,y);var T=h.l?p(h.l.Na,h.l,h):null;e:{var L=h.i;let M=-1;for(;;){const W=["count="+y];M==-1?0<y?(M=L[0].g,W.push("ofs="+M)):M=0:W.push("ofs="+M);let Be=!0;for(let Ft=0;Ft<y;Ft++){let Ae=L[Ft].g;const Qt=L[Ft].map;if(Ae-=M,0>Ae)M=Math.max(0,L[Ft].g-100),Be=!1;else try{jN(Qt,W,"req"+Ae+"_")}catch{T&&T(Qt)}}if(Be){T=W.join("&");break e}}}return h=h.i.splice(0,y),x.D=h,T}function O1(h){if(!h.g&&!h.u){h.Y=1;var x=h.Fa;Ue||te(),H||(Ue(),H=!0),Y.add(x,h),h.v=0}}function dp(h){return h.g||h.u||3<=h.v?!1:(h.Y++,h.u=Al(p(h.Fa,h),z1(h,h.v)),h.v++,!0)}t.Fa=function(){if(this.u=null,$1(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var h=2*this.R;this.j.info("BP detection timer enabled: "+h),this.A=Al(p(this.ab,this),h)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,un(10),ad(this),$1(this))};function hp(h){h.A!=null&&(l.clearTimeout(h.A),h.A=null)}function $1(h){h.g=new ii(h,h.j,"rpc",h.Y),h.m===null&&(h.g.H=h.o),h.g.O=0;var x=vs(h.qa);We(x,"RID","rpc"),We(x,"SID",h.K),We(x,"AID",h.T),We(x,"CI",h.F?"0":"1"),!h.F&&h.ja&&We(x,"TO",h.ja),We(x,"TYPE","xmlhttp"),Bl(h,x),h.m&&h.o&&cp(x,h.m,h.o),h.L&&(h.g.I=h.L);var y=h.g;h=h.ia,y.L=1,y.v=nd(vs(x)),y.m=null,y.P=!0,h1(y,h)}t.Za=function(){this.C!=null&&(this.C=null,ad(this),dp(this),un(19))};function ld(h){h.C!=null&&(l.clearTimeout(h.C),h.C=null)}function B1(h,x){var y=null;if(h.g==x){ld(h),hp(h),h.g=null;var T=2}else if(op(h.h,x))y=x.D,y1(h.h,x),T=1;else return;if(h.G!=0){if(x.o)if(T==1){y=x.m?x.m.length:0,x=Date.now()-x.F;var L=h.B;T=Xu(),cn(T,new l1(T,y)),od(h)}else O1(h);else if(L=x.s,L==3||L==0&&0<x.X||!(T==1&&PN(h,x)||T==2&&dp(h)))switch(y&&0<y.length&&(x=h.h,x.i=x.i.concat(y)),L){case 1:ia(h,5);break;case 4:ia(h,10);break;case 3:ia(h,6);break;default:ia(h,2)}}}function z1(h,x){let y=h.Ta+Math.floor(Math.random()*h.cb);return h.isActive()||(y*=2),y*x}function ia(h,x){if(h.j.info("Error code "+x),x==2){var y=p(h.fb,h),T=h.Xa;const L=!T;T=new sa(T||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||ed(T,"https"),nd(T),L?TN(T.toString(),y):IN(T.toString(),y)}else un(2);h.G=0,h.l&&h.l.sa(x),U1(h),D1(h)}t.fb=function(h){h?(this.j.info("Successfully pinged google.com"),un(2)):(this.j.info("Failed to ping google.com"),un(1))};function U1(h){if(h.G=0,h.ka=[],h.l){const x=v1(h.h);(x.length!=0||h.i.length!=0)&&(b(h.ka,x),b(h.ka,h.i),h.h.i.length=0,_(h.i),h.i.length=0),h.l.ra()}}function V1(h,x,y){var T=y instanceof sa?vs(y):new sa(y);if(T.g!="")x&&(T.g=x+"."+T.g),td(T,T.s);else{var L=l.location;T=L.protocol,x=x?x+"."+L.hostname:L.hostname,L=+L.port;var M=new sa(null);T&&ed(M,T),x&&(M.g=x),L&&td(M,L),y&&(M.l=y),T=M}return y=h.D,x=h.ya,y&&x&&We(T,y,x),We(T,"VER",h.la),Bl(h,T),T}function H1(h,x,y){if(x&&!h.J)throw Error("Can't create secondary domain capable XhrIo object.");return x=h.Ca&&!h.pa?new ot(new rd({eb:y})):new ot(h.pa),x.Ha(h.J),x}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function W1(){}t=W1.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function cd(){}cd.prototype.g=function(h,x){return new $n(h,x)};function $n(h,x){Gt.call(this),this.g=new F1(x),this.l=h,this.h=x&&x.messageUrlParams||null,h=x&&x.messageHeaders||null,x&&x.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=x&&x.initMessageHeaders||null,x&&x.messageContentType&&(h?h["X-WebChannel-Content-Type"]=x.messageContentType:h={"X-WebChannel-Content-Type":x.messageContentType}),x&&x.va&&(h?h["X-WebChannel-Client-Profile"]=x.va:h={"X-WebChannel-Client-Profile":x.va}),this.g.S=h,(h=x&&x.Sb)&&!w(h)&&(this.g.m=h),this.v=x&&x.supportsCrossDomainXhr||!1,this.u=x&&x.sendRawJson||!1,(x=x&&x.httpSessionIdParam)&&!w(x)&&(this.g.D=x,h=this.h,h!==null&&x in h&&(h=this.h,x in h&&delete h[x])),this.j=new ro(this)}v($n,Gt),$n.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},$n.prototype.close=function(){up(this.g)},$n.prototype.o=function(h){var x=this.g;if(typeof h=="string"){var y={};y.__data__=h,h=y}else this.u&&(y={},y.__data__=Jm(h),h=y);x.i.push(new gN(x.Ya++,h)),x.G==3&&od(x)},$n.prototype.N=function(){this.g.l=null,delete this.j,up(this.g),delete this.g,$n.aa.N.call(this)};function q1(h){ep.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var x=h.__sm__;if(x){e:{for(const y in x){h=y;break e}h=void 0}(this.i=h)&&(h=this.i,x=x!==null&&h in x?x[h]:void 0),this.data=x}else this.data=h}v(q1,ep);function G1(){tp.call(this),this.status=1}v(G1,tp);function ro(h){this.g=h}v(ro,W1),ro.prototype.ua=function(){cn(this.g,"a")},ro.prototype.ta=function(h){cn(this.g,new q1(h))},ro.prototype.sa=function(h){cn(this.g,new G1)},ro.prototype.ra=function(){cn(this.g,"b")},cd.prototype.createWebChannel=cd.prototype.g,$n.prototype.send=$n.prototype.o,$n.prototype.open=$n.prototype.m,$n.prototype.close=$n.prototype.close,JC=function(){return new cd},YC=function(){return Xu()},XC=na,ex={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Yu.NO_ERROR=0,Yu.TIMEOUT=8,Yu.HTTP_ERROR=6,ph=Yu,c1.COMPLETE="complete",KC=c1,s1.EventType=jl,jl.OPEN="a",jl.CLOSE="b",jl.ERROR="c",jl.MESSAGE="d",Gt.prototype.listen=Gt.prototype.K,oc=s1,ot.prototype.listenOnce=ot.prototype.L,ot.prototype.getLastError=ot.prototype.Ka,ot.prototype.getLastErrorCode=ot.prototype.Ba,ot.prototype.getStatus=ot.prototype.Z,ot.prototype.getResponseJson=ot.prototype.Oa,ot.prototype.getResponseText=ot.prototype.oa,ot.prototype.send=ot.prototype.ea,ot.prototype.setWithCredentials=ot.prototype.Ha,QC=ot}).apply(typeof Rd<"u"?Rd:typeof self<"u"?self:typeof window<"u"?window:{});const gS="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Zt.UNAUTHENTICATED=new Zt(null),Zt.GOOGLE_CREDENTIALS=new Zt("google-credentials-uid"),Zt.FIRST_PARTY=new Zt("first-party-uid"),Zt.MOCK_USER=new Zt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let gl="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const La=new uv("@firebase/firestore");function Yl(){return La.logLevel}function K(t,...e){if(La.logLevel<=Ie.DEBUG){const n=e.map(kv);La.debug(`Firestore (${gl}): ${t}`,...n)}}function Ws(t,...e){if(La.logLevel<=Ie.ERROR){const n=e.map(kv);La.error(`Firestore (${gl}): ${t}`,...n)}}function Qo(t,...e){if(La.logLevel<=Ie.WARN){const n=e.map(kv);La.warn(`Firestore (${gl}): ${t}`,...n)}}function kv(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ae(t="Unexpected state"){const e=`FIRESTORE (${gl}) INTERNAL ASSERTION FAILED: `+t;throw Ws(e),new Error(e)}function Me(t,e){t||ae()}function de(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class G extends ys{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ds{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZC{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class m7{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Zt.UNAUTHENTICATED))}shutdown(){}}class p7{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class g7{constructor(e){this.t=e,this.currentUser=Zt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Me(this.o===void 0);let r=this.i;const s=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve();let i=new Ds;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Ds,e.enqueueRetryable(()=>s(this.currentUser))};const a=()=>{const c=i;e.enqueueRetryable(async()=>{await c.promise,await s(this.currentUser)})},l=c=>{K("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(c=>l(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?l(c):(K("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Ds)}},0),a()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(K("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Me(typeof r.accessToken=="string"),new ZC(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Me(e===null||typeof e=="string"),new Zt(e)}}class x7{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=Zt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class y7{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new x7(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(Zt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class v7{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class w7{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){Me(this.o===void 0);const r=i=>{i.error!=null&&K("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const a=i.token!==this.R;return this.R=i.token,K("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{K("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):K("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Me(typeof n.token=="string"),this.R=n.token,new v7(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _7(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ej{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=_7(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%e.length))}return r}}function Ne(t,e){return t<e?-1:t>e?1:0}function Ko(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class It{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new G(z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new G(z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new G(z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new G(z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return It.fromMillis(Date.now())}static fromDate(e){return It.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new It(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Ne(this.nanoseconds,e.nanoseconds):Ne(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ce{constructor(e){this.timestamp=e}static fromTimestamp(e){return new ce(e)}static min(){return new ce(new It(0,0))}static max(){return new ce(new It(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zc{constructor(e,n,r){n===void 0?n=0:n>e.length&&ae(),r===void 0?r=e.length-n:r>e.length-n&&ae(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Zc.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Zc?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=e.get(s),a=n.get(s);if(i<a)return-1;if(i>a)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class Ge extends Zc{construct(e,n,r){return new Ge(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new G(z.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new Ge(n)}static emptyPath(){return new Ge([])}}const b7=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class $t extends Zc{construct(e,n,r){return new $t(e,n,r)}static isValidIdentifier(e){return b7.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),$t.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new $t(["__name__"])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new G(z.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let a=!1;for(;s<e.length;){const l=e[s];if(l==="\\"){if(s+1===e.length)throw new G(z.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[s+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new G(z.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,s+=2}else l==="`"?(a=!a,s++):l!=="."||a?(r+=l,s++):(i(),s++)}if(i(),a)throw new G(z.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new $t(n)}static emptyPath(){return new $t([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z{constructor(e){this.path=e}static fromPath(e){return new Z(Ge.fromString(e))}static fromName(e){return new Z(Ge.fromString(e).popFirst(5))}static empty(){return new Z(Ge.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ge.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Ge.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Z(new Ge(e.slice()))}}function S7(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=ce.fromTimestamp(r===1e9?new It(n+1,0):new It(n,r));return new Bi(s,Z.empty(),e)}function E7(t){return new Bi(t.readTime,t.key,-1)}class Bi{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Bi(ce.min(),Z.empty(),-1)}static max(){return new Bi(ce.max(),Z.empty(),-1)}}function k7(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=Z.comparator(t.documentKey,e.documentKey),n!==0?n:Ne(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T7="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class I7{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Au(t){if(t.code!==z.FAILED_PRECONDITION||t.message!==T7)throw t;K("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&ae(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new U((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof U?n:U.resolve(n)}catch(n){return U.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):U.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):U.reject(n)}static resolve(e){return new U((n,r)=>{n(e)})}static reject(e){return new U((n,r)=>{r(e)})}static waitFor(e){return new U((n,r)=>{let s=0,i=0,a=!1;e.forEach(l=>{++s,l.next(()=>{++i,a&&i===s&&n()},c=>r(c))}),a=!0,i===s&&n()})}static or(e){let n=U.resolve(!1);for(const r of e)n=n.next(s=>s?U.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new U((r,s)=>{const i=e.length,a=new Array(i);let l=0;for(let c=0;c<i;c++){const u=c;n(e[u]).next(d=>{a[u]=d,++l,l===i&&r(a)},d=>s(d))}})}static doWhile(e,n){return new U((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}function C7(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Nu(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tv{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Tv.oe=-1;function _m(t){return t==null}function df(t){return t===0&&1/t==-1/0}function j7(t){return typeof t=="number"&&Number.isInteger(t)&&!df(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xS(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Ya(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function tj(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class it{constructor(e,n){this.comparator=e,this.root=n||Ot.EMPTY}insert(e,n){return new it(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Ot.BLACK,null,null))}remove(e){return new it(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ot.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ad(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ad(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ad(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ad(this.root,e,this.comparator,!0)}}class Ad{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ot{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??Ot.RED,this.left=s??Ot.EMPTY,this.right=i??Ot.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new Ot(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Ot.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return Ot.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ot.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ot.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw ae();const e=this.left.check();if(e!==this.right.check())throw ae();return e+(this.isRed()?0:1)}}Ot.EMPTY=null,Ot.RED=!0,Ot.BLACK=!1;Ot.EMPTY=new class{constructor(){this.size=0}get key(){throw ae()}get value(){throw ae()}get color(){throw ae()}get left(){throw ae()}get right(){throw ae()}copy(e,n,r,s,i){return this}insert(e,n,r){return new Ot(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zt{constructor(e){this.comparator=e,this.data=new it(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new yS(this.data.getIterator())}getIteratorFrom(e){return new yS(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof zt)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new zt(this.comparator);return n.data=e,n}}class yS{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qn{constructor(e){this.fields=e,e.sort($t.comparator)}static empty(){return new qn([])}unionWith(e){let n=new zt($t.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new qn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Ko(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nj extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new nj("Invalid base64 string: "+i):i}}(e);return new Wt(n)}static fromUint8Array(e){const n=function(s){let i="";for(let a=0;a<s.length;++a)i+=String.fromCharCode(s[a]);return i}(e);return new Wt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ne(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Wt.EMPTY_BYTE_STRING=new Wt("");const R7=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function zi(t){if(Me(!!t),typeof t=="string"){let e=0;const n=R7.exec(t);if(Me(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ft(t.seconds),nanos:ft(t.nanos)}}function ft(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Ma(t){return typeof t=="string"?Wt.fromBase64String(t):Wt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Iv(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function Cv(t){const e=t.mapValue.fields.__previous_value__;return Iv(e)?Cv(e):e}function eu(t){const e=zi(t.mapValue.fields.__local_write_time__.timestampValue);return new It(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A7{constructor(e,n,r,s,i,a,l,c,u){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=a,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=u}}class tu{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new tu("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof tu&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nd={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Oa(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Iv(t)?4:P7(t)?9007199254740991:N7(t)?10:11:ae()}function ds(t,e){if(t===e)return!0;const n=Oa(t);if(n!==Oa(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return eu(t).isEqual(eu(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const a=zi(s.timestampValue),l=zi(i.timestampValue);return a.seconds===l.seconds&&a.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return Ma(s.bytesValue).isEqual(Ma(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return ft(s.geoPointValue.latitude)===ft(i.geoPointValue.latitude)&&ft(s.geoPointValue.longitude)===ft(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return ft(s.integerValue)===ft(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const a=ft(s.doubleValue),l=ft(i.doubleValue);return a===l?df(a)===df(l):isNaN(a)&&isNaN(l)}return!1}(t,e);case 9:return Ko(t.arrayValue.values||[],e.arrayValue.values||[],ds);case 10:case 11:return function(s,i){const a=s.mapValue.fields||{},l=i.mapValue.fields||{};if(xS(a)!==xS(l))return!1;for(const c in a)if(a.hasOwnProperty(c)&&(l[c]===void 0||!ds(a[c],l[c])))return!1;return!0}(t,e);default:return ae()}}function nu(t,e){return(t.values||[]).find(n=>ds(n,e))!==void 0}function Xo(t,e){if(t===e)return 0;const n=Oa(t),r=Oa(e);if(n!==r)return Ne(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Ne(t.booleanValue,e.booleanValue);case 2:return function(i,a){const l=ft(i.integerValue||i.doubleValue),c=ft(a.integerValue||a.doubleValue);return l<c?-1:l>c?1:l===c?0:isNaN(l)?isNaN(c)?0:-1:1}(t,e);case 3:return vS(t.timestampValue,e.timestampValue);case 4:return vS(eu(t),eu(e));case 5:return Ne(t.stringValue,e.stringValue);case 6:return function(i,a){const l=Ma(i),c=Ma(a);return l.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(i,a){const l=i.split("/"),c=a.split("/");for(let u=0;u<l.length&&u<c.length;u++){const d=Ne(l[u],c[u]);if(d!==0)return d}return Ne(l.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,a){const l=Ne(ft(i.latitude),ft(a.latitude));return l!==0?l:Ne(ft(i.longitude),ft(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return wS(t.arrayValue,e.arrayValue);case 10:return function(i,a){var l,c,u,d;const f=i.fields||{},p=a.fields||{},g=(l=f.value)===null||l===void 0?void 0:l.arrayValue,v=(c=p.value)===null||c===void 0?void 0:c.arrayValue,_=Ne(((u=g==null?void 0:g.values)===null||u===void 0?void 0:u.length)||0,((d=v==null?void 0:v.values)===null||d===void 0?void 0:d.length)||0);return _!==0?_:wS(g,v)}(t.mapValue,e.mapValue);case 11:return function(i,a){if(i===Nd.mapValue&&a===Nd.mapValue)return 0;if(i===Nd.mapValue)return 1;if(a===Nd.mapValue)return-1;const l=i.fields||{},c=Object.keys(l),u=a.fields||{},d=Object.keys(u);c.sort(),d.sort();for(let f=0;f<c.length&&f<d.length;++f){const p=Ne(c[f],d[f]);if(p!==0)return p;const g=Xo(l[c[f]],u[d[f]]);if(g!==0)return g}return Ne(c.length,d.length)}(t.mapValue,e.mapValue);default:throw ae()}}function vS(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Ne(t,e);const n=zi(t),r=zi(e),s=Ne(n.seconds,r.seconds);return s!==0?s:Ne(n.nanos,r.nanos)}function wS(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=Xo(n[s],r[s]);if(i)return i}return Ne(n.length,r.length)}function Yo(t){return tx(t)}function tx(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=zi(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Ma(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return Z.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=tx(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const a of r)i?i=!1:s+=",",s+=`${a}:${tx(n.fields[a])}`;return s+"}"}(t.mapValue):ae()}function _S(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function nx(t){return!!t&&"integerValue"in t}function jv(t){return!!t&&"arrayValue"in t}function bS(t){return!!t&&"nullValue"in t}function SS(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function gh(t){return!!t&&"mapValue"in t}function N7(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function _c(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Ya(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=_c(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=_c(t.arrayValue.values[n]);return e}return Object.assign({},t)}function P7(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tn{constructor(e){this.value=e}static empty(){return new Tn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!gh(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=_c(n)}setAll(e){let n=$t.emptyPath(),r={},s=[];e.forEach((a,l)=>{if(!n.isImmediateParentOf(l)){const c=this.getFieldsMap(n);this.applyChanges(c,r,s),r={},s=[],n=l.popLast()}a?r[l.lastSegment()]=_c(a):s.push(l.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());gh(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return ds(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];gh(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){Ya(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new Tn(_c(this.value))}}function rj(t){const e=[];return Ya(t.fields,(n,r)=>{const s=new $t([n]);if(gh(r)){const i=rj(r.mapValue).fields;if(i.length===0)e.push(s);else for(const a of i)e.push(s.child(a))}else e.push(s)}),new qn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tn{constructor(e,n,r,s,i,a,l){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=a,this.documentState=l}static newInvalidDocument(e){return new tn(e,0,ce.min(),ce.min(),ce.min(),Tn.empty(),0)}static newFoundDocument(e,n,r,s){return new tn(e,1,n,ce.min(),r,s,0)}static newNoDocument(e,n){return new tn(e,2,n,ce.min(),ce.min(),Tn.empty(),0)}static newUnknownDocument(e,n){return new tn(e,3,n,ce.min(),ce.min(),Tn.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(ce.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Tn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Tn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ce.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof tn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new tn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hf{constructor(e,n){this.position=e,this.inclusive=n}}function ES(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],a=t.position[s];if(i.field.isKeyField()?r=Z.comparator(Z.fromName(a.referenceValue),n.key):r=Xo(a,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function kS(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!ds(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ru{constructor(e,n="asc"){this.field=e,this.dir=n}}function F7(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sj{}class _t extends sj{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new L7(e,n,r):n==="array-contains"?new $7(e,r):n==="in"?new B7(e,r):n==="not-in"?new z7(e,r):n==="array-contains-any"?new U7(e,r):new _t(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new M7(e,r):new O7(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(Xo(n,this.value)):n!==null&&Oa(this.value)===Oa(n)&&this.matchesComparison(Xo(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ae()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class zr extends sj{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new zr(e,n)}matches(e){return ij(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function ij(t){return t.op==="and"}function aj(t){return D7(t)&&ij(t)}function D7(t){for(const e of t.filters)if(e instanceof zr)return!1;return!0}function rx(t){if(t instanceof _t)return t.field.canonicalString()+t.op.toString()+Yo(t.value);if(aj(t))return t.filters.map(e=>rx(e)).join(",");{const e=t.filters.map(n=>rx(n)).join(",");return`${t.op}(${e})`}}function oj(t,e){return t instanceof _t?function(r,s){return s instanceof _t&&r.op===s.op&&r.field.isEqual(s.field)&&ds(r.value,s.value)}(t,e):t instanceof zr?function(r,s){return s instanceof zr&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,a,l)=>i&&oj(a,s.filters[l]),!0):!1}(t,e):void ae()}function lj(t){return t instanceof _t?function(n){return`${n.field.canonicalString()} ${n.op} ${Yo(n.value)}`}(t):t instanceof zr?function(n){return n.op.toString()+" {"+n.getFilters().map(lj).join(" ,")+"}"}(t):"Filter"}class L7 extends _t{constructor(e,n,r){super(e,n,r),this.key=Z.fromName(r.referenceValue)}matches(e){const n=Z.comparator(e.key,this.key);return this.matchesComparison(n)}}class M7 extends _t{constructor(e,n){super(e,"in",n),this.keys=cj("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class O7 extends _t{constructor(e,n){super(e,"not-in",n),this.keys=cj("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function cj(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>Z.fromName(r.referenceValue))}class $7 extends _t{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return jv(n)&&nu(n.arrayValue,this.value)}}class B7 extends _t{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&nu(this.value.arrayValue,n)}}class z7 extends _t{constructor(e,n){super(e,"not-in",n)}matches(e){if(nu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!nu(this.value.arrayValue,n)}}class U7 extends _t{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!jv(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>nu(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V7{constructor(e,n=null,r=[],s=[],i=null,a=null,l=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=a,this.endAt=l,this.ue=null}}function TS(t,e=null,n=[],r=[],s=null,i=null,a=null){return new V7(t,e,n,r,s,i,a)}function Rv(t){const e=de(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>rx(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),_m(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Yo(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Yo(r)).join(",")),e.ue=n}return e.ue}function Av(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!F7(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!oj(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!kS(t.startAt,e.startAt)&&kS(t.endAt,e.endAt)}function sx(t){return Z.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xl{constructor(e,n=null,r=[],s=[],i=null,a="F",l=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=a,this.startAt=l,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function H7(t,e,n,r,s,i,a,l){return new xl(t,e,n,r,s,i,a,l)}function Nv(t){return new xl(t)}function IS(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function uj(t){return t.collectionGroup!==null}function bc(t){const e=de(t);if(e.ce===null){e.ce=[];const n=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let l=new zt($t.comparator);return a.filters.forEach(c=>{c.getFlattenedFilters().forEach(u=>{u.isInequality()&&(l=l.add(u.field))})}),l})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.ce.push(new ru(i,r))}),n.has($t.keyField().canonicalString())||e.ce.push(new ru($t.keyField(),r))}return e.ce}function as(t){const e=de(t);return e.le||(e.le=W7(e,bc(t))),e.le}function W7(t,e){if(t.limitType==="F")return TS(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new ru(s.field,i)});const n=t.endAt?new hf(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new hf(t.startAt.position,t.startAt.inclusive):null;return TS(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function ix(t,e){const n=t.filters.concat([e]);return new xl(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function ff(t,e,n){return new xl(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function bm(t,e){return Av(as(t),as(e))&&t.limitType===e.limitType}function dj(t){return`${Rv(as(t))}|lt:${t.limitType}`}function ho(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>lj(s)).join(", ")}]`),_m(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>Yo(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>Yo(s)).join(",")),`Target(${r})`}(as(t))}; limitType=${t.limitType})`}function Sm(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):Z.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of bc(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(a,l,c){const u=ES(a,l,c);return a.inclusive?u<=0:u<0}(r.startAt,bc(r),s)||r.endAt&&!function(a,l,c){const u=ES(a,l,c);return a.inclusive?u>=0:u>0}(r.endAt,bc(r),s))}(t,e)}function q7(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function hj(t){return(e,n)=>{let r=!1;for(const s of bc(t)){const i=G7(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function G7(t,e,n){const r=t.field.isKeyField()?Z.comparator(e.key,n.key):function(i,a,l){const c=a.data.field(i),u=l.data.field(i);return c!==null&&u!==null?Xo(c,u):ae()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return ae()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yl{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Ya(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return tj(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q7=new it(Z.comparator);function qs(){return Q7}const fj=new it(Z.comparator);function lc(...t){let e=fj;for(const n of t)e=e.insert(n.key,n);return e}function mj(t){let e=fj;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function wa(){return Sc()}function pj(){return Sc()}function Sc(){return new yl(t=>t.toString(),(t,e)=>t.isEqual(e))}const K7=new it(Z.comparator),X7=new zt(Z.comparator);function Ee(...t){let e=X7;for(const n of t)e=e.add(n);return e}const Y7=new zt(Ne);function J7(){return Y7}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pv(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:df(e)?"-0":e}}function gj(t){return{integerValue:""+t}}function xj(t,e){return j7(e)?gj(e):Pv(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Em{constructor(){this._=void 0}}function Z7(t,e,n){return t instanceof su?function(s,i){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&Iv(i)&&(i=Cv(i)),i&&(a.fields.__previous_value__=i),{mapValue:a}}(n,e):t instanceof iu?vj(t,e):t instanceof au?wj(t,e):function(s,i){const a=yj(s,i),l=CS(a)+CS(s.Pe);return nx(a)&&nx(s.Pe)?gj(l):Pv(s.serializer,l)}(t,e)}function e8(t,e,n){return t instanceof iu?vj(t,e):t instanceof au?wj(t,e):n}function yj(t,e){return t instanceof ou?function(r){return nx(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class su extends Em{}class iu extends Em{constructor(e){super(),this.elements=e}}function vj(t,e){const n=_j(e);for(const r of t.elements)n.some(s=>ds(s,r))||n.push(r);return{arrayValue:{values:n}}}class au extends Em{constructor(e){super(),this.elements=e}}function wj(t,e){let n=_j(e);for(const r of t.elements)n=n.filter(s=>!ds(s,r));return{arrayValue:{values:n}}}class ou extends Em{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function CS(t){return ft(t.integerValue||t.doubleValue)}function _j(t){return jv(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bj{constructor(e,n){this.field=e,this.transform=n}}function t8(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof iu&&s instanceof iu||r instanceof au&&s instanceof au?Ko(r.elements,s.elements,ds):r instanceof ou&&s instanceof ou?ds(r.Pe,s.Pe):r instanceof su&&s instanceof su}(t.transform,e.transform)}class n8{constructor(e,n){this.version=e,this.transformResults=n}}class gn{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new gn}static exists(e){return new gn(void 0,e)}static updateTime(e){return new gn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function xh(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class km{}function Sj(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Tm(t.key,gn.none()):new Pu(t.key,t.data,gn.none());{const n=t.data,r=Tn.empty();let s=new zt($t.comparator);for(let i of e.fields)if(!s.has(i)){let a=n.field(i);a===null&&i.length>1&&(i=i.popLast(),a=n.field(i)),a===null?r.delete(i):r.set(i,a),s=s.add(i)}return new Qi(t.key,r,new qn(s.toArray()),gn.none())}}function r8(t,e,n){t instanceof Pu?function(s,i,a){const l=s.value.clone(),c=RS(s.fieldTransforms,i,a.transformResults);l.setAll(c),i.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(t,e,n):t instanceof Qi?function(s,i,a){if(!xh(s.precondition,i))return void i.convertToUnknownDocument(a.version);const l=RS(s.fieldTransforms,i,a.transformResults),c=i.data;c.setAll(Ej(s)),c.setAll(l),i.convertToFoundDocument(a.version,c).setHasCommittedMutations()}(t,e,n):function(s,i,a){i.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,n)}function Ec(t,e,n,r){return t instanceof Pu?function(i,a,l,c){if(!xh(i.precondition,a))return l;const u=i.value.clone(),d=AS(i.fieldTransforms,c,a);return u.setAll(d),a.convertToFoundDocument(a.version,u).setHasLocalMutations(),null}(t,e,n,r):t instanceof Qi?function(i,a,l,c){if(!xh(i.precondition,a))return l;const u=AS(i.fieldTransforms,c,a),d=a.data;return d.setAll(Ej(i)),d.setAll(u),a.convertToFoundDocument(a.version,d).setHasLocalMutations(),l===null?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(f=>f.field))}(t,e,n,r):function(i,a,l){return xh(i.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):l}(t,e,n)}function s8(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=yj(r.transform,s||null);i!=null&&(n===null&&(n=Tn.empty()),n.set(r.field,i))}return n||null}function jS(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Ko(r,s,(i,a)=>t8(i,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Pu extends km{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Qi extends km{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Ej(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function RS(t,e,n){const r=new Map;Me(t.length===n.length);for(let s=0;s<n.length;s++){const i=t[s],a=i.transform,l=e.data.field(i.field);r.set(i.field,e8(a,l,n[s]))}return r}function AS(t,e,n){const r=new Map;for(const s of t){const i=s.transform,a=n.data.field(s.field);r.set(s.field,Z7(i,a,e))}return r}class Tm extends km{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class i8 extends km{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a8{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&r8(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Ec(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Ec(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=pj();return this.mutations.forEach(s=>{const i=e.get(s.key),a=i.overlayedDocument;let l=this.applyToLocalView(a,i.mutatedFields);l=n.has(s.key)?null:l;const c=Sj(a,l);c!==null&&r.set(s.key,c),a.isValidDocument()||a.convertToNoDocument(ce.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Ee())}isEqual(e){return this.batchId===e.batchId&&Ko(this.mutations,e.mutations,(n,r)=>jS(n,r))&&Ko(this.baseMutations,e.baseMutations,(n,r)=>jS(n,r))}}class Fv{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){Me(e.mutations.length===r.length);let s=function(){return K7}();const i=e.mutations;for(let a=0;a<i.length;a++)s=s.insert(i[a].key,r[a].version);return new Fv(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o8{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l8{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var vt,je;function c8(t){switch(t){default:return ae();case z.CANCELLED:case z.UNKNOWN:case z.DEADLINE_EXCEEDED:case z.RESOURCE_EXHAUSTED:case z.INTERNAL:case z.UNAVAILABLE:case z.UNAUTHENTICATED:return!1;case z.INVALID_ARGUMENT:case z.NOT_FOUND:case z.ALREADY_EXISTS:case z.PERMISSION_DENIED:case z.FAILED_PRECONDITION:case z.ABORTED:case z.OUT_OF_RANGE:case z.UNIMPLEMENTED:case z.DATA_LOSS:return!0}}function kj(t){if(t===void 0)return Ws("GRPC error has no .code"),z.UNKNOWN;switch(t){case vt.OK:return z.OK;case vt.CANCELLED:return z.CANCELLED;case vt.UNKNOWN:return z.UNKNOWN;case vt.DEADLINE_EXCEEDED:return z.DEADLINE_EXCEEDED;case vt.RESOURCE_EXHAUSTED:return z.RESOURCE_EXHAUSTED;case vt.INTERNAL:return z.INTERNAL;case vt.UNAVAILABLE:return z.UNAVAILABLE;case vt.UNAUTHENTICATED:return z.UNAUTHENTICATED;case vt.INVALID_ARGUMENT:return z.INVALID_ARGUMENT;case vt.NOT_FOUND:return z.NOT_FOUND;case vt.ALREADY_EXISTS:return z.ALREADY_EXISTS;case vt.PERMISSION_DENIED:return z.PERMISSION_DENIED;case vt.FAILED_PRECONDITION:return z.FAILED_PRECONDITION;case vt.ABORTED:return z.ABORTED;case vt.OUT_OF_RANGE:return z.OUT_OF_RANGE;case vt.UNIMPLEMENTED:return z.UNIMPLEMENTED;case vt.DATA_LOSS:return z.DATA_LOSS;default:return ae()}}(je=vt||(vt={}))[je.OK=0]="OK",je[je.CANCELLED=1]="CANCELLED",je[je.UNKNOWN=2]="UNKNOWN",je[je.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",je[je.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",je[je.NOT_FOUND=5]="NOT_FOUND",je[je.ALREADY_EXISTS=6]="ALREADY_EXISTS",je[je.PERMISSION_DENIED=7]="PERMISSION_DENIED",je[je.UNAUTHENTICATED=16]="UNAUTHENTICATED",je[je.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",je[je.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",je[je.ABORTED=10]="ABORTED",je[je.OUT_OF_RANGE=11]="OUT_OF_RANGE",je[je.UNIMPLEMENTED=12]="UNIMPLEMENTED",je[je.INTERNAL=13]="INTERNAL",je[je.UNAVAILABLE=14]="UNAVAILABLE",je[je.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u8(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d8=new Ea([4294967295,4294967295],0);function NS(t){const e=u8().encode(t),n=new GC;return n.update(e),new Uint8Array(n.digest())}function PS(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Ea([n,r],0),new Ea([s,i],0)]}class Dv{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new cc(`Invalid padding: ${n}`);if(r<0)throw new cc(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new cc(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new cc(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=Ea.fromNumber(this.Ie)}Ee(e,n,r){let s=e.add(n.multiply(Ea.fromNumber(r)));return s.compare(d8)===1&&(s=new Ea([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=NS(e),[r,s]=PS(n);for(let i=0;i<this.hashCount;i++){const a=this.Ee(r,s,i);if(!this.de(a))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),a=new Dv(i,s,n);return r.forEach(l=>a.insert(l)),a}insert(e){if(this.Ie===0)return;const n=NS(e),[r,s]=PS(n);for(let i=0;i<this.hashCount;i++){const a=this.Ee(r,s,i);this.Ae(a)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class cc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Im{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,Fu.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Im(ce.min(),s,new it(Ne),qs(),Ee())}}class Fu{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Fu(r,n,Ee(),Ee(),Ee())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yh{constructor(e,n,r,s){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=s}}class Tj{constructor(e,n){this.targetId=e,this.me=n}}class Ij{constructor(e,n,r=Wt.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class FS{constructor(){this.fe=0,this.ge=LS(),this.pe=Wt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Ee(),n=Ee(),r=Ee();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:ae()}}),new Fu(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=LS()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Me(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class h8{constructor(e){this.Le=e,this.Be=new Map,this.ke=qs(),this.qe=DS(),this.Qe=new it(Ne)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:ae()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,s)=>{this.ze(s)&&n(s)})}He(e){const n=e.targetId,r=e.me.count,s=this.Je(n);if(s){const i=s.target;if(sx(i))if(r===0){const a=new Z(i.path);this.Ue(n,a,tn.newNoDocument(a,ce.min()))}else Me(r===1);else{const a=this.Ye(n);if(a!==r){const l=this.Ze(e),c=l?this.Xe(l,e,a):1;if(c!==0){this.je(n);const u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,u)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let a,l;try{a=Ma(r).toUint8Array()}catch(c){if(c instanceof nj)return Qo("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{l=new Dv(a,s,i)}catch(c){return Qo(c instanceof cc?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return l.Ie===0?null:l}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const a=this.Le.tt(),l=`projects/${a.projectId}/databases/${a.database}/documents/${i.path.canonicalString()}`;e.mightContain(l)||(this.Ue(n,i,null),s++)}),s}rt(e){const n=new Map;this.Be.forEach((i,a)=>{const l=this.Je(a);if(l){if(i.current&&sx(l.target)){const c=new Z(l.target.path);this.ke.get(c)!==null||this.it(a,c)||this.Ue(a,c,tn.newNoDocument(c,e))}i.be&&(n.set(a,i.ve()),i.Ce())}});let r=Ee();this.qe.forEach((i,a)=>{let l=!0;a.forEachWhile(c=>{const u=this.Je(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(i))}),this.ke.forEach((i,a)=>a.setReadTime(e));const s=new Im(e,n,this.Qe,this.ke,r);return this.ke=qs(),this.qe=DS(),this.Qe=new it(Ne),s}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,n)?s.Fe(n,1):s.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new FS,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new zt(Ne),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||K("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new FS),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function DS(){return new it(Z.comparator)}function LS(){return new it(Z.comparator)}const f8=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),m8=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),p8=(()=>({and:"AND",or:"OR"}))();class g8{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function ax(t,e){return t.useProto3Json||_m(e)?e:{value:e}}function mf(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Cj(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function x8(t,e){return mf(t,e.toTimestamp())}function os(t){return Me(!!t),ce.fromTimestamp(function(n){const r=zi(n);return new It(r.seconds,r.nanos)}(t))}function Lv(t,e){return ox(t,e).canonicalString()}function ox(t,e){const n=function(s){return new Ge(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function jj(t){const e=Ge.fromString(t);return Me(Fj(e)),e}function lx(t,e){return Lv(t.databaseId,e.path)}function cg(t,e){const n=jj(e);if(n.get(1)!==t.databaseId.projectId)throw new G(z.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new G(z.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Z(Aj(n))}function Rj(t,e){return Lv(t.databaseId,e)}function y8(t){const e=jj(t);return e.length===4?Ge.emptyPath():Aj(e)}function cx(t){return new Ge(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Aj(t){return Me(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function MS(t,e,n){return{name:lx(t,e),fields:n.value.mapValue.fields}}function v8(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:ae()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(u,d){return u.useProto3Json?(Me(d===void 0||typeof d=="string"),Wt.fromBase64String(d||"")):(Me(d===void 0||d instanceof Buffer||d instanceof Uint8Array),Wt.fromUint8Array(d||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,l=a&&function(u){const d=u.code===void 0?z.UNKNOWN:kj(u.code);return new G(d,u.message||"")}(a);n=new Ij(r,s,i,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=cg(t,r.document.name),i=os(r.document.updateTime),a=r.document.createTime?os(r.document.createTime):ce.min(),l=new Tn({mapValue:{fields:r.document.fields}}),c=tn.newFoundDocument(s,i,a,l),u=r.targetIds||[],d=r.removedTargetIds||[];n=new yh(u,d,c.key,c)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=cg(t,r.document),i=r.readTime?os(r.readTime):ce.min(),a=tn.newNoDocument(s,i),l=r.removedTargetIds||[];n=new yh([],l,a.key,a)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=cg(t,r.document),i=r.removedTargetIds||[];n=new yh([],i,s,null)}else{if(!("filter"in e))return ae();{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,a=new l8(s,i),l=r.targetId;n=new Tj(l,a)}}return n}function w8(t,e){let n;if(e instanceof Pu)n={update:MS(t,e.key,e.value)};else if(e instanceof Tm)n={delete:lx(t,e.key)};else if(e instanceof Qi)n={update:MS(t,e.key,e.data),updateMask:j8(e.fieldMask)};else{if(!(e instanceof i8))return ae();n={verify:lx(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,a){const l=a.transform;if(l instanceof su)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof iu)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof au)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof ou)return{fieldPath:a.field.canonicalString(),increment:l.Pe};throw ae()}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:x8(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:ae()}(t,e.precondition)),n}function _8(t,e){return t&&t.length>0?(Me(e!==void 0),t.map(n=>function(s,i){let a=s.updateTime?os(s.updateTime):os(i);return a.isEqual(ce.min())&&(a=os(i)),new n8(a,s.transformResults||[])}(n,e))):[]}function b8(t,e){return{documents:[Rj(t,e.path)]}}function S8(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=Rj(t,s);const i=function(u){if(u.length!==0)return Pj(zr.create(u,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const a=function(u){if(u.length!==0)return u.map(d=>function(p){return{field:fo(p.field),direction:T8(p.dir)}}(d))}(e.orderBy);a&&(n.structuredQuery.orderBy=a);const l=ax(t,e.limit);return l!==null&&(n.structuredQuery.limit=l),e.startAt&&(n.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{_t:n,parent:s}}function E8(t){let e=y8(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){Me(r===1);const d=n.from[0];d.allDescendants?s=d.collectionId:e=e.child(d.collectionId)}let i=[];n.where&&(i=function(f){const p=Nj(f);return p instanceof zr&&aj(p)?p.getFilters():[p]}(n.where));let a=[];n.orderBy&&(a=function(f){return f.map(p=>function(v){return new ru(mo(v.field),function(b){switch(b){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(v.direction))}(p))}(n.orderBy));let l=null;n.limit&&(l=function(f){let p;return p=typeof f=="object"?f.value:f,_m(p)?null:p}(n.limit));let c=null;n.startAt&&(c=function(f){const p=!!f.before,g=f.values||[];return new hf(g,p)}(n.startAt));let u=null;return n.endAt&&(u=function(f){const p=!f.before,g=f.values||[];return new hf(g,p)}(n.endAt)),H7(e,s,a,i,l,"F",c,u)}function k8(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ae()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function Nj(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=mo(n.unaryFilter.field);return _t.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=mo(n.unaryFilter.field);return _t.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=mo(n.unaryFilter.field);return _t.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=mo(n.unaryFilter.field);return _t.create(a,"!=",{nullValue:"NULL_VALUE"});default:return ae()}}(t):t.fieldFilter!==void 0?function(n){return _t.create(mo(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ae()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return zr.create(n.compositeFilter.filters.map(r=>Nj(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return ae()}}(n.compositeFilter.op))}(t):ae()}function T8(t){return f8[t]}function I8(t){return m8[t]}function C8(t){return p8[t]}function fo(t){return{fieldPath:t.canonicalString()}}function mo(t){return $t.fromServerFormat(t.fieldPath)}function Pj(t){return t instanceof _t?function(n){if(n.op==="=="){if(SS(n.value))return{unaryFilter:{field:fo(n.field),op:"IS_NAN"}};if(bS(n.value))return{unaryFilter:{field:fo(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(SS(n.value))return{unaryFilter:{field:fo(n.field),op:"IS_NOT_NAN"}};if(bS(n.value))return{unaryFilter:{field:fo(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:fo(n.field),op:I8(n.op),value:n.value}}}(t):t instanceof zr?function(n){const r=n.getFilters().map(s=>Pj(s));return r.length===1?r[0]:{compositeFilter:{op:C8(n.op),filters:r}}}(t):ae()}function j8(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function Fj(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Si{constructor(e,n,r,s,i=ce.min(),a=ce.min(),l=Wt.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(e){return new Si(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Si(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Si(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Si(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R8{constructor(e){this.ct=e}}function A8(t){const e=E8({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?ff(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N8{constructor(){this.un=new P8}addToCollectionParentIndex(e,n){return this.un.add(n),U.resolve()}getCollectionParents(e,n){return U.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return U.resolve()}deleteFieldIndex(e,n){return U.resolve()}deleteAllFieldIndexes(e){return U.resolve()}createTargetIndexes(e,n){return U.resolve()}getDocumentsMatchingTarget(e,n){return U.resolve(null)}getIndexType(e,n){return U.resolve(0)}getFieldIndexes(e,n){return U.resolve([])}getNextCollectionGroupToUpdate(e){return U.resolve(null)}getMinOffset(e,n){return U.resolve(Bi.min())}getMinOffsetFromCollectionGroup(e,n){return U.resolve(Bi.min())}updateCollectionGroup(e,n,r){return U.resolve()}updateIndexEntries(e,n){return U.resolve()}}class P8{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new zt(Ge.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new zt(Ge.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jo{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new Jo(0)}static kn(){return new Jo(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F8{constructor(){this.changes=new yl(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,tn.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?U.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D8{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L8{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&Ec(r.mutation,s,qn.empty(),It.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Ee()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Ee()){const s=wa();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let a=lc();return i.forEach((l,c)=>{a=a.insert(l,c.overlayedDocument)}),a}))}getOverlayedDocuments(e,n){const r=wa();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Ee()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((a,l)=>{n.set(a,l)})})}computeViews(e,n,r,s){let i=qs();const a=Sc(),l=function(){return Sc()}();return n.forEach((c,u)=>{const d=r.get(u.key);s.has(u.key)&&(d===void 0||d.mutation instanceof Qi)?i=i.insert(u.key,u):d!==void 0?(a.set(u.key,d.mutation.getFieldMask()),Ec(d.mutation,u,d.mutation.getFieldMask(),It.now())):a.set(u.key,qn.empty())}),this.recalculateAndSaveOverlays(e,i).next(c=>(c.forEach((u,d)=>a.set(u,d)),n.forEach((u,d)=>{var f;return l.set(u,new D8(d,(f=a.get(u))!==null&&f!==void 0?f:null))}),l))}recalculateAndSaveOverlays(e,n){const r=Sc();let s=new it((a,l)=>a-l),i=Ee();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(a=>{for(const l of a)l.keys().forEach(c=>{const u=n.get(c);if(u===null)return;let d=r.get(c)||qn.empty();d=l.applyToLocalView(u,d),r.set(c,d);const f=(s.get(l.batchId)||Ee()).add(c);s=s.insert(l.batchId,f)})}).next(()=>{const a=[],l=s.getReverseIterator();for(;l.hasNext();){const c=l.getNext(),u=c.key,d=c.value,f=pj();d.forEach(p=>{if(!i.has(p)){const g=Sj(n.get(p),r.get(p));g!==null&&f.set(p,g),i=i.add(p)}}),a.push(this.documentOverlayCache.saveOverlays(e,u,f))}return U.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(a){return Z.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):uj(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const a=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):U.resolve(wa());let l=-1,c=i;return a.next(u=>U.forEach(u,(d,f)=>(l<f.largestBatchId&&(l=f.largestBatchId),i.get(d)?U.resolve():this.remoteDocumentCache.getEntry(e,d).next(p=>{c=c.insert(d,p)}))).next(()=>this.populateOverlays(e,u,i)).next(()=>this.computeViews(e,c,u,Ee())).next(d=>({batchId:l,changes:mj(d)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new Z(n)).next(r=>{let s=lc();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let a=lc();return this.indexManager.getCollectionParents(e,i).next(l=>U.forEach(l,c=>{const u=function(f,p){return new xl(p,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(n,c.child(i));return this.getDocumentsMatchingCollectionQuery(e,u,r,s).next(d=>{d.forEach((f,p)=>{a=a.insert(f,p)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(a=>(i=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(a=>{i.forEach((c,u)=>{const d=u.getKey();a.get(d)===null&&(a=a.insert(d,tn.newInvalidDocument(d)))});let l=lc();return a.forEach((c,u)=>{const d=i.get(c);d!==void 0&&Ec(d.mutation,u,qn.empty(),It.now()),Sm(n,u)&&(l=l.insert(c,u))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M8{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return U.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:os(s.createTime)}}(n)),U.resolve()}getNamedQuery(e,n){return U.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(s){return{name:s.name,query:A8(s.bundledQuery),readTime:os(s.readTime)}}(n)),U.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O8{constructor(){this.overlays=new it(Z.comparator),this.Ir=new Map}getOverlay(e,n){return U.resolve(this.overlays.get(n))}getOverlays(e,n){const r=wa();return U.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.ht(e,n,i)}),U.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.Ir.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(r)),U.resolve()}getOverlaysForCollection(e,n,r){const s=wa(),i=n.length+1,a=new Z(n.child("")),l=this.overlays.getIteratorFrom(a);for(;l.hasNext();){const c=l.getNext().value,u=c.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===i&&c.largestBatchId>r&&s.set(c.getKey(),c)}return U.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new it((u,d)=>u-d);const a=this.overlays.getIterator();for(;a.hasNext();){const u=a.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>r){let d=i.get(u.largestBatchId);d===null&&(d=wa(),i=i.insert(u.largestBatchId,d)),d.set(u.getKey(),u)}}const l=wa(),c=i.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,d)=>l.set(u,d)),!(l.size()>=s)););return U.resolve(l)}ht(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const a=this.Ir.get(s.largestBatchId).delete(r.key);this.Ir.set(s.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new o8(n,r));let i=this.Ir.get(n);i===void 0&&(i=Ee(),this.Ir.set(n,i)),this.Ir.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $8{constructor(){this.sessionToken=Wt.EMPTY_BYTE_STRING}getSessionToken(e){return U.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,U.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mv{constructor(){this.Tr=new zt(jt.Er),this.dr=new zt(jt.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new jt(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new jt(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new Z(new Ge([])),r=new jt(n,e),s=new jt(n,e+1),i=[];return this.dr.forEachInRange([r,s],a=>{this.Vr(a),i.push(a.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new Z(new Ge([])),r=new jt(n,e),s=new jt(n,e+1);let i=Ee();return this.dr.forEachInRange([r,s],a=>{i=i.add(a.key)}),i}containsKey(e){const n=new jt(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class jt{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return Z.comparator(e.key,n.key)||Ne(e.wr,n.wr)}static Ar(e,n){return Ne(e.wr,n.wr)||Z.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B8{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new zt(jt.Er)}checkEmpty(e){return U.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new a8(i,n,r,s);this.mutationQueue.push(a);for(const l of s)this.br=this.br.add(new jt(l.key,i)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return U.resolve(a)}lookupMutationBatch(e,n){return U.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.vr(r),i=s<0?0:s;return U.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return U.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return U.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new jt(n,0),s=new jt(n,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([r,s],a=>{const l=this.Dr(a.wr);i.push(l)}),U.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new zt(Ne);return n.forEach(s=>{const i=new jt(s,0),a=new jt(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,a],l=>{r=r.add(l.wr)})}),U.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;Z.isDocumentKey(i)||(i=i.child(""));const a=new jt(new Z(i),0);let l=new zt(Ne);return this.br.forEachWhile(c=>{const u=c.key.path;return!!r.isPrefixOf(u)&&(u.length===s&&(l=l.add(c.wr)),!0)},a),U.resolve(this.Cr(l))}Cr(e){const n=[];return e.forEach(r=>{const s=this.Dr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){Me(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return U.forEach(n.mutations,s=>{const i=new jt(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new jt(n,0),s=this.br.firstAfterOrEqual(r);return U.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,U.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z8{constructor(e){this.Mr=e,this.docs=function(){return new it(Z.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,a=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return U.resolve(r?r.document.mutableCopy():tn.newInvalidDocument(n))}getEntries(e,n){let r=qs();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():tn.newInvalidDocument(s))}),U.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=qs();const a=n.path,l=new Z(a.child("")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){const{key:u,value:{document:d}}=c.getNext();if(!a.isPrefixOf(u.path))break;u.path.length>a.length+1||k7(E7(d),r)<=0||(s.has(d.key)||Sm(n,d))&&(i=i.insert(d.key,d.mutableCopy()))}return U.resolve(i)}getAllFromCollectionGroup(e,n,r,s){ae()}Or(e,n){return U.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new U8(this)}getSize(e){return U.resolve(this.size)}}class U8 extends F8{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.cr.addEntry(e,s)):this.cr.removeEntry(r)}),U.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V8{constructor(e){this.persistence=e,this.Nr=new yl(n=>Rv(n),Av),this.lastRemoteSnapshotVersion=ce.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Mv,this.targetCount=0,this.kr=Jo.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,s)=>n(s)),U.resolve()}getLastRemoteSnapshotVersion(e){return U.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return U.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),U.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),U.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new Jo(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,U.resolve()}updateTargetData(e,n){return this.Kn(n),U.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,U.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.Nr.forEach((a,l)=>{l.sequenceNumber<=n&&r.get(l.targetId)===null&&(this.Nr.delete(a),i.push(this.removeMatchingKeysForTargetId(e,l.targetId)),s++)}),U.waitFor(i).next(()=>s)}getTargetCount(e){return U.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return U.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),U.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(a=>{i.push(s.markPotentiallyOrphaned(e,a))}),U.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),U.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return U.resolve(r)}containsKey(e,n){return U.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H8{constructor(e,n){this.qr={},this.overlays={},this.Qr=new Tv(0),this.Kr=!1,this.Kr=!0,this.$r=new $8,this.referenceDelegate=e(this),this.Ur=new V8(this),this.indexManager=new N8,this.remoteDocumentCache=function(s){return new z8(s)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new R8(n),this.Gr=new M8(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new O8,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new B8(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){K("MemoryPersistence","Starting transaction:",e);const s=new W8(this.Qr.next());return this.referenceDelegate.zr(),r(s).next(i=>this.referenceDelegate.jr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Hr(e,n){return U.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}}class W8 extends I7{constructor(e){super(),this.currentSequenceNumber=e}}class Ov{constructor(e){this.persistence=e,this.Jr=new Mv,this.Yr=null}static Zr(e){return new Ov(e)}get Xr(){if(this.Yr)return this.Yr;throw ae()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),U.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),U.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),U.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(s=>this.Xr.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.Xr.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return U.forEach(this.Xr,r=>{const s=Z.fromPath(r);return this.ei(e,s).next(i=>{i||n.removeEntry(s,ce.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return U.or([()=>U.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $v{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=s}static Wi(e,n){let r=Ee(),s=Ee();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new $v(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q8{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G8{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return q6()?8:C7(on())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.Yi(e,n).next(a=>{i.result=a}).next(()=>{if(!i.result)return this.Zi(e,n,s,r).next(a=>{i.result=a})}).next(()=>{if(i.result)return;const a=new q8;return this.Xi(e,n,a).next(l=>{if(i.result=l,this.zi)return this.es(e,n,a,l.size)})}).next(()=>i.result)}es(e,n,r,s){return r.documentReadCount<this.ji?(Yl()<=Ie.DEBUG&&K("QueryEngine","SDK will not create cache indexes for query:",ho(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),U.resolve()):(Yl()<=Ie.DEBUG&&K("QueryEngine","Query:",ho(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.Hi*s?(Yl()<=Ie.DEBUG&&K("QueryEngine","The SDK decides to create cache indexes for query:",ho(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,as(n))):U.resolve())}Yi(e,n){if(IS(n))return U.resolve(null);let r=as(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=ff(n,null,"F"),r=as(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const a=Ee(...i);return this.Ji.getDocuments(e,a).next(l=>this.indexManager.getMinOffset(e,r).next(c=>{const u=this.ts(n,l);return this.ns(n,u,a,c.readTime)?this.Yi(e,ff(n,null,"F")):this.rs(e,u,n,c)}))})))}Zi(e,n,r,s){return IS(n)||s.isEqual(ce.min())?U.resolve(null):this.Ji.getDocuments(e,r).next(i=>{const a=this.ts(n,i);return this.ns(n,a,r,s)?U.resolve(null):(Yl()<=Ie.DEBUG&&K("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),ho(n)),this.rs(e,a,n,S7(s,-1)).next(l=>l))})}ts(e,n){let r=new zt(hj(e));return n.forEach((s,i)=>{Sm(e,i)&&(r=r.add(i))}),r}ns(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Xi(e,n,r){return Yl()<=Ie.DEBUG&&K("QueryEngine","Using full collection scan to execute query:",ho(n)),this.Ji.getDocumentsMatchingQuery(e,n,Bi.min(),r)}rs(e,n,r,s){return this.Ji.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(a=>{i=i.insert(a.key,a)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q8{constructor(e,n,r,s){this.persistence=e,this.ss=n,this.serializer=s,this.os=new it(Ne),this._s=new yl(i=>Rv(i),Av),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new L8(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function K8(t,e,n,r){return new Q8(t,e,n,r)}async function Dj(t,e){const n=de(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const a=[],l=[];let c=Ee();for(const u of s){a.push(u.batchId);for(const d of u.mutations)c=c.add(d.key)}for(const u of i){l.push(u.batchId);for(const d of u.mutations)c=c.add(d.key)}return n.localDocuments.getDocuments(r,c).next(u=>({hs:u,removedBatchIds:a,addedBatchIds:l}))})})}function X8(t,e){const n=de(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.cs.newChangeBuffer({trackRemovals:!0});return function(l,c,u,d){const f=u.batch,p=f.keys();let g=U.resolve();return p.forEach(v=>{g=g.next(()=>d.getEntry(c,v)).next(_=>{const b=u.docVersions.get(v);Me(b!==null),_.version.compareTo(b)<0&&(f.applyToRemoteDocument(_,u),_.isValidDocument()&&(_.setReadTime(u.commitVersion),d.addEntry(_)))})}),g.next(()=>l.mutationQueue.removeMutationBatch(c,f))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let c=Ee();for(let u=0;u<l.mutationResults.length;++u)l.mutationResults[u].transformResults.length>0&&(c=c.add(l.batch.mutations[u].key));return c}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function Lj(t){const e=de(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function Y8(t,e){const n=de(t),r=e.snapshotVersion;let s=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const a=n.cs.newChangeBuffer({trackRemovals:!0});s=n.os;const l=[];e.targetChanges.forEach((d,f)=>{const p=s.get(f);if(!p)return;l.push(n.Ur.removeMatchingKeys(i,d.removedDocuments,f).next(()=>n.Ur.addMatchingKeys(i,d.addedDocuments,f)));let g=p.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(f)!==null?g=g.withResumeToken(Wt.EMPTY_BYTE_STRING,ce.min()).withLastLimboFreeSnapshotVersion(ce.min()):d.resumeToken.approximateByteSize()>0&&(g=g.withResumeToken(d.resumeToken,r)),s=s.insert(f,g),function(_,b,E){return _.resumeToken.approximateByteSize()===0||b.snapshotVersion.toMicroseconds()-_.snapshotVersion.toMicroseconds()>=3e8?!0:E.addedDocuments.size+E.modifiedDocuments.size+E.removedDocuments.size>0}(p,g,d)&&l.push(n.Ur.updateTargetData(i,g))});let c=qs(),u=Ee();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(i,d))}),l.push(J8(i,a,e.documentUpdates).next(d=>{c=d.Ps,u=d.Is})),!r.isEqual(ce.min())){const d=n.Ur.getLastRemoteSnapshotVersion(i).next(f=>n.Ur.setTargetsMetadata(i,i.currentSequenceNumber,r));l.push(d)}return U.waitFor(l).next(()=>a.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,c,u)).next(()=>c)}).then(i=>(n.os=s,i))}function J8(t,e,n){let r=Ee(),s=Ee();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let a=qs();return n.forEach((l,c)=>{const u=i.get(l);c.isFoundDocument()!==u.isFoundDocument()&&(s=s.add(l)),c.isNoDocument()&&c.version.isEqual(ce.min())?(e.removeEntry(l,c.readTime),a=a.insert(l,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),a=a.insert(l,c)):K("LocalStore","Ignoring outdated watch update for ",l,". Current version:",u.version," Watch version:",c.version)}),{Ps:a,Is:s}})}function Z8(t,e){const n=de(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function ez(t,e){const n=de(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Ur.getTargetData(r,e).next(i=>i?(s=i,U.resolve(s)):n.Ur.allocateTargetId(r).next(a=>(s=new Si(e,a,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.os.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function ux(t,e,n){const r=de(t),s=r.os.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,a=>r.persistence.referenceDelegate.removeTarget(a,s))}catch(a){if(!Nu(a))throw a;K("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}r.os=r.os.remove(e),r._s.delete(s.target)}function OS(t,e,n){const r=de(t);let s=ce.min(),i=Ee();return r.persistence.runTransaction("Execute query","readwrite",a=>function(c,u,d){const f=de(c),p=f._s.get(d);return p!==void 0?U.resolve(f.os.get(p)):f.Ur.getTargetData(u,d)}(r,a,as(e)).next(l=>{if(l)return s=l.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(a,l.targetId).next(c=>{i=c})}).next(()=>r.ss.getDocumentsMatchingQuery(a,e,n?s:ce.min(),n?i:Ee())).next(l=>(tz(r,q7(e),l),{documents:l,Ts:i})))}function tz(t,e,n){let r=t.us.get(e)||ce.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.us.set(e,r)}class $S{constructor(){this.activeTargetIds=J7()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class nz{constructor(){this.so=new $S,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new $S,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rz{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BS{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){K("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){K("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Pd=null;function ug(){return Pd===null?Pd=function(){return 268435456+Math.round(2147483648*Math.random())}():Pd++,"0x"+Pd.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sz={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iz{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jt="WebChannelConnection";class az extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${s}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get Fo(){return!1}Mo(n,r,s,i,a){const l=ug(),c=this.xo(n,r.toUriEncodedString());K("RestConnection",`Sending RPC '${n}' ${l}:`,c,s);const u={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(u,i,a),this.No(n,c,u,s).then(d=>(K("RestConnection",`Received RPC '${n}' ${l}: `,d),d),d=>{throw Qo("RestConnection",`RPC '${n}' ${l} failed with error: `,d,"url: ",c,"request:",s),d})}Lo(n,r,s,i,a,l){return this.Mo(n,r,s,i,a)}Oo(n,r,s){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+gl}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,a)=>n[a]=i),s&&s.headers.forEach((i,a)=>n[a]=i)}xo(n,r){const s=sz[n];return`${this.Do}/v1/${r}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,s){const i=ug();return new Promise((a,l)=>{const c=new QC;c.setWithCredentials(!0),c.listenOnce(KC.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case ph.NO_ERROR:const d=c.getResponseJson();K(Jt,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(d)),a(d);break;case ph.TIMEOUT:K(Jt,`RPC '${e}' ${i} timed out`),l(new G(z.DEADLINE_EXCEEDED,"Request time out"));break;case ph.HTTP_ERROR:const f=c.getStatus();if(K(Jt,`RPC '${e}' ${i} failed with status:`,f,"response text:",c.getResponseText()),f>0){let p=c.getResponseJson();Array.isArray(p)&&(p=p[0]);const g=p==null?void 0:p.error;if(g&&g.status&&g.message){const v=function(b){const E=b.toLowerCase().replace(/_/g,"-");return Object.values(z).indexOf(E)>=0?E:z.UNKNOWN}(g.status);l(new G(v,g.message))}else l(new G(z.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new G(z.UNAVAILABLE,"Connection failed."));break;default:ae()}}finally{K(Jt,`RPC '${e}' ${i} completed.`)}});const u=JSON.stringify(s);K(Jt,`RPC '${e}' ${i} sending request:`,s),c.send(n,"POST",u,r,15)})}Bo(e,n,r){const s=ug(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=JC(),l=YC(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Oo(c.initMessageHeaders,n,r),c.encodeInitMessageHeaders=!0;const d=i.join("");K(Jt,`Creating RPC '${e}' stream ${s}: ${d}`,c);const f=a.createWebChannel(d,c);let p=!1,g=!1;const v=new iz({Io:b=>{g?K(Jt,`Not sending because RPC '${e}' stream ${s} is closed:`,b):(p||(K(Jt,`Opening RPC '${e}' stream ${s} transport.`),f.open(),p=!0),K(Jt,`RPC '${e}' stream ${s} sending:`,b),f.send(b))},To:()=>f.close()}),_=(b,E,w)=>{b.listen(E,S=>{try{w(S)}catch(I){setTimeout(()=>{throw I},0)}})};return _(f,oc.EventType.OPEN,()=>{g||(K(Jt,`RPC '${e}' stream ${s} transport opened.`),v.yo())}),_(f,oc.EventType.CLOSE,()=>{g||(g=!0,K(Jt,`RPC '${e}' stream ${s} transport closed`),v.So())}),_(f,oc.EventType.ERROR,b=>{g||(g=!0,Qo(Jt,`RPC '${e}' stream ${s} transport errored:`,b),v.So(new G(z.UNAVAILABLE,"The operation could not be completed")))}),_(f,oc.EventType.MESSAGE,b=>{var E;if(!g){const w=b.data[0];Me(!!w);const S=w,I=S.error||((E=S[0])===null||E===void 0?void 0:E.error);if(I){K(Jt,`RPC '${e}' stream ${s} received error:`,I);const F=I.status;let D=function(R){const j=vt[R];if(j!==void 0)return kj(j)}(F),C=I.message;D===void 0&&(D=z.INTERNAL,C="Unknown error status: "+F+" with message "+I.message),g=!0,v.So(new G(D,C)),f.close()}else K(Jt,`RPC '${e}' stream ${s} received:`,w),v.bo(w)}}),_(l,XC.STAT_EVENT,b=>{b.stat===ex.PROXY?K(Jt,`RPC '${e}' stream ${s} detected buffering proxy`):b.stat===ex.NOPROXY&&K(Jt,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{v.wo()},0),v}}function dg(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cm(t){return new g8(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mj{constructor(e,n,r=1e3,s=1.5,i=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=s,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),s=Math.max(0,n-r);s>0&&K("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oj{constructor(e,n,r,s,i,a,l,c){this.ui=e,this.Ho=r,this.Jo=s,this.connection=i,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new Mj(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===z.RESOURCE_EXHAUSTED?(Ws(n.toString()),Ws("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===z.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Yo===n&&this.P_(r,s)},r=>{e(()=>{const s=new G(z.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(s)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{r(()=>this.I_(s))}),this.stream.onMessage(s=>{r(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return K("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(K("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class oz extends Oj{constructor(e,n,r,s,i,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,a),this.serializer=i}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=v8(this.serializer,e),r=function(i){if(!("targetChange"in i))return ce.min();const a=i.targetChange;return a.targetIds&&a.targetIds.length?ce.min():a.readTime?os(a.readTime):ce.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=cx(this.serializer),n.addTarget=function(i,a){let l;const c=a.target;if(l=sx(c)?{documents:b8(i,c)}:{query:S8(i,c)._t},l.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){l.resumeToken=Cj(i,a.resumeToken);const u=ax(i,a.expectedCount);u!==null&&(l.expectedCount=u)}else if(a.snapshotVersion.compareTo(ce.min())>0){l.readTime=mf(i,a.snapshotVersion.toTimestamp());const u=ax(i,a.expectedCount);u!==null&&(l.expectedCount=u)}return l}(this.serializer,e);const r=k8(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=cx(this.serializer),n.removeTarget=e,this.a_(n)}}class lz extends Oj{constructor(e,n,r,s,i,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,a),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return Me(!!e.streamToken),this.lastStreamToken=e.streamToken,Me(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Me(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=_8(e.writeResults,e.commitTime),r=os(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=cx(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>w8(this.serializer,r))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cz extends class{}{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new G(z.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,a])=>this.connection.Mo(e,ox(n,r),s,i,a)).catch(i=>{throw i.name==="FirebaseError"?(i.code===z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new G(z.UNKNOWN,i.toString())})}Lo(e,n,r,s,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,l])=>this.connection.Lo(e,ox(n,r),s,a,l,i)).catch(a=>{throw a.name==="FirebaseError"?(a.code===z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new G(z.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class uz{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Ws(n),this.D_=!1):K("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dz{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(a=>{r.enqueueAndForget(async()=>{Ja(this)&&(K("RemoteStore","Restarting streams for network reachability change."),await async function(c){const u=de(c);u.L_.add(4),await Du(u),u.q_.set("Unknown"),u.L_.delete(4),await jm(u)}(this))})}),this.q_=new uz(r,s)}}async function jm(t){if(Ja(t))for(const e of t.B_)await e(!0)}async function Du(t){for(const e of t.B_)await e(!1)}function $j(t,e){const n=de(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),Vv(n)?Uv(n):vl(n).r_()&&zv(n,e))}function Bv(t,e){const n=de(t),r=vl(n);n.N_.delete(e),r.r_()&&Bj(n,e),n.N_.size===0&&(r.r_()?r.o_():Ja(n)&&n.q_.set("Unknown"))}function zv(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ce.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}vl(t).A_(e)}function Bj(t,e){t.Q_.xe(e),vl(t).R_(e)}function Uv(t){t.Q_=new h8({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),vl(t).start(),t.q_.v_()}function Vv(t){return Ja(t)&&!vl(t).n_()&&t.N_.size>0}function Ja(t){return de(t).L_.size===0}function zj(t){t.Q_=void 0}async function hz(t){t.q_.set("Online")}async function fz(t){t.N_.forEach((e,n)=>{zv(t,e)})}async function mz(t,e){zj(t),Vv(t)?(t.q_.M_(e),Uv(t)):t.q_.set("Unknown")}async function pz(t,e,n){if(t.q_.set("Online"),e instanceof Ij&&e.state===2&&e.cause)try{await async function(s,i){const a=i.cause;for(const l of i.targetIds)s.N_.has(l)&&(await s.remoteSyncer.rejectListen(l,a),s.N_.delete(l),s.Q_.removeTarget(l))}(t,e)}catch(r){K("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await pf(t,r)}else if(e instanceof yh?t.Q_.Ke(e):e instanceof Tj?t.Q_.He(e):t.Q_.We(e),!n.isEqual(ce.min()))try{const r=await Lj(t.localStore);n.compareTo(r)>=0&&await function(i,a){const l=i.Q_.rt(a);return l.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){const d=i.N_.get(u);d&&i.N_.set(u,d.withResumeToken(c.resumeToken,a))}}),l.targetMismatches.forEach((c,u)=>{const d=i.N_.get(c);if(!d)return;i.N_.set(c,d.withResumeToken(Wt.EMPTY_BYTE_STRING,d.snapshotVersion)),Bj(i,c);const f=new Si(d.target,c,u,d.sequenceNumber);zv(i,f)}),i.remoteSyncer.applyRemoteEvent(l)}(t,n)}catch(r){K("RemoteStore","Failed to raise snapshot:",r),await pf(t,r)}}async function pf(t,e,n){if(!Nu(e))throw e;t.L_.add(1),await Du(t),t.q_.set("Offline"),n||(n=()=>Lj(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{K("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await jm(t)})}function Uj(t,e){return e().catch(n=>pf(t,n,e))}async function Rm(t){const e=de(t),n=Ui(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;gz(e);)try{const s=await Z8(e.localStore,r);if(s===null){e.O_.length===0&&n.o_();break}r=s.batchId,xz(e,s)}catch(s){await pf(e,s)}Vj(e)&&Hj(e)}function gz(t){return Ja(t)&&t.O_.length<10}function xz(t,e){t.O_.push(e);const n=Ui(t);n.r_()&&n.V_&&n.m_(e.mutations)}function Vj(t){return Ja(t)&&!Ui(t).n_()&&t.O_.length>0}function Hj(t){Ui(t).start()}async function yz(t){Ui(t).p_()}async function vz(t){const e=Ui(t);for(const n of t.O_)e.m_(n.mutations)}async function wz(t,e,n){const r=t.O_.shift(),s=Fv.from(r,e,n);await Uj(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await Rm(t)}async function _z(t,e){e&&Ui(t).V_&&await async function(r,s){if(function(a){return c8(a)&&a!==z.ABORTED}(s.code)){const i=r.O_.shift();Ui(r).s_(),await Uj(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await Rm(r)}}(t,e),Vj(t)&&Hj(t)}async function zS(t,e){const n=de(t);n.asyncQueue.verifyOperationInProgress(),K("RemoteStore","RemoteStore received new credentials");const r=Ja(n);n.L_.add(3),await Du(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await jm(n)}async function bz(t,e){const n=de(t);e?(n.L_.delete(2),await jm(n)):e||(n.L_.add(2),await Du(n),n.q_.set("Unknown"))}function vl(t){return t.K_||(t.K_=function(n,r,s){const i=de(n);return i.w_(),new oz(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:hz.bind(null,t),Ro:fz.bind(null,t),mo:mz.bind(null,t),d_:pz.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),Vv(t)?Uv(t):t.q_.set("Unknown")):(await t.K_.stop(),zj(t))})),t.K_}function Ui(t){return t.U_||(t.U_=function(n,r,s){const i=de(n);return i.w_(),new lz(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:yz.bind(null,t),mo:_z.bind(null,t),f_:vz.bind(null,t),g_:wz.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await Rm(t)):(await t.U_.stop(),t.O_.length>0&&(K("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hv{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new Ds,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const a=Date.now()+r,l=new Hv(e,n,a,s,i);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new G(z.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Wv(t,e){if(Ws("AsyncQueue",`${e}: ${t}`),Nu(t))return new G(z.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oo{constructor(e){this.comparator=e?(n,r)=>e(n,r)||Z.comparator(n.key,r.key):(n,r)=>Z.comparator(n.key,r.key),this.keyedMap=lc(),this.sortedSet=new it(this.comparator)}static emptySet(e){return new Oo(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Oo)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Oo;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class US{constructor(){this.W_=new it(Z.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):ae():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}}class Zo{constructor(e,n,r,s,i,a,l,c,u){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=a,this.syncStateChanged=l,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,n,r,s,i){const a=[];return n.forEach(l=>{a.push({type:0,doc:l})}),new Zo(e,n,Oo.emptySet(n),a,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&bm(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sz{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class Ez{constructor(){this.queries=VS(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const s=de(n),i=s.queries;s.queries=VS(),i.forEach((a,l)=>{for(const c of l.j_)c.onError(r)})})(this,new G(z.ABORTED,"Firestore shutting down"))}}function VS(){return new yl(t=>dj(t),bm)}async function Wj(t,e){const n=de(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.H_()&&e.J_()&&(r=2):(i=new Sz,r=e.J_()?0:1);try{switch(r){case 0:i.z_=await n.onListen(s,!0);break;case 1:i.z_=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(a){const l=Wv(a,`Initialization of query '${ho(e.query)}' failed`);return void e.onError(l)}n.queries.set(s,i),i.j_.push(e),e.Z_(n.onlineState),i.z_&&e.X_(i.z_)&&qv(n)}async function qj(t,e){const n=de(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const a=i.j_.indexOf(e);a>=0&&(i.j_.splice(a,1),i.j_.length===0?s=e.J_()?0:1:!i.H_()&&e.J_()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function kz(t,e){const n=de(t);let r=!1;for(const s of e){const i=s.query,a=n.queries.get(i);if(a){for(const l of a.j_)l.X_(s)&&(r=!0);a.z_=s}}r&&qv(n)}function Tz(t,e,n){const r=de(t),s=r.queries.get(e);if(s)for(const i of s.j_)i.onError(n);r.queries.delete(e)}function qv(t){t.Y_.forEach(e=>{e.next()})}var dx,HS;(HS=dx||(dx={})).ea="default",HS.Cache="cache";class Gj{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Zo(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=Zo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==dx.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qj{constructor(e){this.key=e}}class Kj{constructor(e){this.key=e}}class Iz{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Ee(),this.mutatedKeys=Ee(),this.Aa=hj(e),this.Ra=new Oo(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new US,s=n?n.Ra:this.Ra;let i=n?n.mutatedKeys:this.mutatedKeys,a=s,l=!1;const c=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,u=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((d,f)=>{const p=s.get(d),g=Sm(this.query,f)?f:null,v=!!p&&this.mutatedKeys.has(p.key),_=!!g&&(g.hasLocalMutations||this.mutatedKeys.has(g.key)&&g.hasCommittedMutations);let b=!1;p&&g?p.data.isEqual(g.data)?v!==_&&(r.track({type:3,doc:g}),b=!0):this.ga(p,g)||(r.track({type:2,doc:g}),b=!0,(c&&this.Aa(g,c)>0||u&&this.Aa(g,u)<0)&&(l=!0)):!p&&g?(r.track({type:0,doc:g}),b=!0):p&&!g&&(r.track({type:1,doc:p}),b=!0,(c||u)&&(l=!0)),b&&(g?(a=a.add(g),i=_?i.add(d):i.delete(d)):(a=a.delete(d),i=i.delete(d)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const d=this.query.limitType==="F"?a.last():a.first();a=a.delete(d.key),i=i.delete(d.key),r.track({type:1,doc:d})}return{Ra:a,fa:r,ns:l,mutatedKeys:i}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const a=e.fa.G_();a.sort((d,f)=>function(g,v){const _=b=>{switch(b){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ae()}};return _(g)-_(v)}(d.type,f.type)||this.Aa(d.doc,f.doc)),this.pa(r),s=s!=null&&s;const l=n&&!s?this.ya():[],c=this.da.size===0&&this.current&&!s?1:0,u=c!==this.Ea;return this.Ea=c,a.length!==0||u?{snapshot:new Zo(this.query,e.Ra,i,a,e.mutatedKeys,c===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:l}:{wa:l}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new US,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Ee(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new Kj(r))}),this.da.forEach(r=>{e.has(r)||n.push(new Qj(r))}),n}ba(e){this.Ta=e.Ts,this.da=Ee();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return Zo.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class Cz{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class jz{constructor(e){this.key=e,this.va=!1}}class Rz{constructor(e,n,r,s,i,a){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new yl(l=>dj(l),bm),this.Ma=new Map,this.xa=new Set,this.Oa=new it(Z.comparator),this.Na=new Map,this.La=new Mv,this.Ba={},this.ka=new Map,this.qa=Jo.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function Az(t,e,n=!0){const r=tR(t);let s;const i=r.Fa.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.Da()):s=await Xj(r,e,n,!0),s}async function Nz(t,e){const n=tR(t);await Xj(n,e,!0,!1)}async function Xj(t,e,n,r){const s=await ez(t.localStore,as(e)),i=s.targetId,a=t.sharedClientState.addLocalQueryTarget(i,n);let l;return r&&(l=await Pz(t,e,i,a==="current",s.resumeToken)),t.isPrimaryClient&&n&&$j(t.remoteStore,s),l}async function Pz(t,e,n,r,s){t.Ka=(f,p,g)=>async function(_,b,E,w){let S=b.view.ma(E);S.ns&&(S=await OS(_.localStore,b.query,!1).then(({documents:C})=>b.view.ma(C,S)));const I=w&&w.targetChanges.get(b.targetId),F=w&&w.targetMismatches.get(b.targetId)!=null,D=b.view.applyChanges(S,_.isPrimaryClient,I,F);return qS(_,b.targetId,D.wa),D.snapshot}(t,f,p,g);const i=await OS(t.localStore,e,!0),a=new Iz(e,i.Ts),l=a.ma(i.documents),c=Fu.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),u=a.applyChanges(l,t.isPrimaryClient,c);qS(t,n,u.wa);const d=new Cz(e,n,a);return t.Fa.set(e,d),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),u.snapshot}async function Fz(t,e,n){const r=de(t),s=r.Fa.get(e),i=r.Ma.get(s.targetId);if(i.length>1)return r.Ma.set(s.targetId,i.filter(a=>!bm(a,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await ux(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&Bv(r.remoteStore,s.targetId),hx(r,s.targetId)}).catch(Au)):(hx(r,s.targetId),await ux(r.localStore,s.targetId,!0))}async function Dz(t,e){const n=de(t),r=n.Fa.get(e),s=n.Ma.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Bv(n.remoteStore,r.targetId))}async function Lz(t,e,n){const r=Vz(t);try{const s=await function(a,l){const c=de(a),u=It.now(),d=l.reduce((g,v)=>g.add(v.key),Ee());let f,p;return c.persistence.runTransaction("Locally write mutations","readwrite",g=>{let v=qs(),_=Ee();return c.cs.getEntries(g,d).next(b=>{v=b,v.forEach((E,w)=>{w.isValidDocument()||(_=_.add(E))})}).next(()=>c.localDocuments.getOverlayedDocuments(g,v)).next(b=>{f=b;const E=[];for(const w of l){const S=s8(w,f.get(w.key).overlayedDocument);S!=null&&E.push(new Qi(w.key,S,rj(S.value.mapValue),gn.exists(!0)))}return c.mutationQueue.addMutationBatch(g,u,E,l)}).next(b=>{p=b;const E=b.applyToLocalDocumentSet(f,_);return c.documentOverlayCache.saveOverlays(g,b.batchId,E)})}).then(()=>({batchId:p.batchId,changes:mj(f)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(a,l,c){let u=a.Ba[a.currentUser.toKey()];u||(u=new it(Ne)),u=u.insert(l,c),a.Ba[a.currentUser.toKey()]=u}(r,s.batchId,n),await Lu(r,s.changes),await Rm(r.remoteStore)}catch(s){const i=Wv(s,"Failed to persist write");n.reject(i)}}async function Yj(t,e){const n=de(t);try{const r=await Y8(n.localStore,e);e.targetChanges.forEach((s,i)=>{const a=n.Na.get(i);a&&(Me(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?a.va=!0:s.modifiedDocuments.size>0?Me(a.va):s.removedDocuments.size>0&&(Me(a.va),a.va=!1))}),await Lu(n,r,e)}catch(r){await Au(r)}}function WS(t,e,n){const r=de(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Fa.forEach((i,a)=>{const l=a.view.Z_(e);l.snapshot&&s.push(l.snapshot)}),function(a,l){const c=de(a);c.onlineState=l;let u=!1;c.queries.forEach((d,f)=>{for(const p of f.j_)p.Z_(l)&&(u=!0)}),u&&qv(c)}(r.eventManager,e),s.length&&r.Ca.d_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function Mz(t,e,n){const r=de(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Na.get(e),i=s&&s.key;if(i){let a=new it(Z.comparator);a=a.insert(i,tn.newNoDocument(i,ce.min()));const l=Ee().add(i),c=new Im(ce.min(),new Map,new it(Ne),a,l);await Yj(r,c),r.Oa=r.Oa.remove(i),r.Na.delete(e),Gv(r)}else await ux(r.localStore,e,!1).then(()=>hx(r,e,n)).catch(Au)}async function Oz(t,e){const n=de(t),r=e.batch.batchId;try{const s=await X8(n.localStore,e);Zj(n,r,null),Jj(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Lu(n,s)}catch(s){await Au(s)}}async function $z(t,e,n){const r=de(t);try{const s=await function(a,l){const c=de(a);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let d;return c.mutationQueue.lookupMutationBatch(u,l).next(f=>(Me(f!==null),d=f.keys(),c.mutationQueue.removeMutationBatch(u,f))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,d,l)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,d)).next(()=>c.localDocuments.getDocuments(u,d))})}(r.localStore,e);Zj(r,e,n),Jj(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Lu(r,s)}catch(s){await Au(s)}}function Jj(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function Zj(t,e,n){const r=de(t);let s=r.Ba[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Ba[r.currentUser.toKey()]=s}}function hx(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||eR(t,r)})}function eR(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(Bv(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),Gv(t))}function qS(t,e,n){for(const r of n)r instanceof Qj?(t.La.addReference(r.key,e),Bz(t,r)):r instanceof Kj?(K("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||eR(t,r.key)):ae()}function Bz(t,e){const n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||(K("SyncEngine","New document in limbo: "+n),t.xa.add(r),Gv(t))}function Gv(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new Z(Ge.fromString(e)),r=t.qa.next();t.Na.set(r,new jz(n)),t.Oa=t.Oa.insert(n,r),$j(t.remoteStore,new Si(as(Nv(n.path)),r,"TargetPurposeLimboResolution",Tv.oe))}}async function Lu(t,e,n){const r=de(t),s=[],i=[],a=[];r.Fa.isEmpty()||(r.Fa.forEach((l,c)=>{a.push(r.Ka(c,e,n).then(u=>{var d;if((u||n)&&r.isPrimaryClient){const f=u?!u.fromCache:(d=n==null?void 0:n.targetChanges.get(c.targetId))===null||d===void 0?void 0:d.current;r.sharedClientState.updateQueryState(c.targetId,f?"current":"not-current")}if(u){s.push(u);const f=$v.Wi(c.targetId,u);i.push(f)}}))}),await Promise.all(a),r.Ca.d_(s),await async function(c,u){const d=de(c);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>U.forEach(u,p=>U.forEach(p.$i,g=>d.persistence.referenceDelegate.addReference(f,p.targetId,g)).next(()=>U.forEach(p.Ui,g=>d.persistence.referenceDelegate.removeReference(f,p.targetId,g)))))}catch(f){if(!Nu(f))throw f;K("LocalStore","Failed to update sequence numbers: "+f)}for(const f of u){const p=f.targetId;if(!f.fromCache){const g=d.os.get(p),v=g.snapshotVersion,_=g.withLastLimboFreeSnapshotVersion(v);d.os=d.os.insert(p,_)}}}(r.localStore,i))}async function zz(t,e){const n=de(t);if(!n.currentUser.isEqual(e)){K("SyncEngine","User change. New user:",e.toKey());const r=await Dj(n.localStore,e);n.currentUser=e,function(i,a){i.ka.forEach(l=>{l.forEach(c=>{c.reject(new G(z.CANCELLED,a))})}),i.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Lu(n,r.hs)}}function Uz(t,e){const n=de(t),r=n.Na.get(e);if(r&&r.va)return Ee().add(r.key);{let s=Ee();const i=n.Ma.get(e);if(!i)return s;for(const a of i){const l=n.Fa.get(a);s=s.unionWith(l.view.Va)}return s}}function tR(t){const e=de(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Yj.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Uz.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Mz.bind(null,e),e.Ca.d_=kz.bind(null,e.eventManager),e.Ca.$a=Tz.bind(null,e.eventManager),e}function Vz(t){const e=de(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Oz.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=$z.bind(null,e),e}class gf{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Cm(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return K8(this.persistence,new G8,e.initialUser,this.serializer)}Ga(e){return new H8(Ov.Zr,this.serializer)}Wa(e){return new nz}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}gf.provider={build:()=>new gf};class fx{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>WS(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=zz.bind(null,this.syncEngine),await bz(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new Ez}()}createDatastore(e){const n=Cm(e.databaseInfo.databaseId),r=function(i){return new az(i)}(e.databaseInfo);return function(i,a,l,c){return new cz(i,a,l,c)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,a,l){return new dz(r,s,i,a,l)}(this.localStore,this.datastore,e.asyncQueue,n=>WS(this.syncEngine,n,0),function(){return BS.D()?new BS:new rz}())}createSyncEngine(e,n){return function(s,i,a,l,c,u,d){const f=new Rz(s,i,a,l,c,u);return d&&(f.Qa=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=de(s);K("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await Du(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}fx.provider={build:()=>new fx};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nR{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Ws("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hz{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=Zt.UNAUTHENTICATED,this.clientId=ej.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async a=>{K("FirestoreClient","Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(r,a=>(K("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ds;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Wv(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function hg(t,e){t.asyncQueue.verifyOperationInProgress(),K("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await Dj(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function GS(t,e){t.asyncQueue.verifyOperationInProgress();const n=await Wz(t);K("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>zS(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>zS(e.remoteStore,s)),t._onlineComponents=e}async function Wz(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){K("FirestoreClient","Using user provided OfflineComponentProvider");try{await hg(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===z.FAILED_PRECONDITION||s.code===z.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;Qo("Error using user provided cache. Falling back to memory cache: "+n),await hg(t,new gf)}}else K("FirestoreClient","Using default OfflineComponentProvider"),await hg(t,new gf);return t._offlineComponents}async function rR(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(K("FirestoreClient","Using user provided OnlineComponentProvider"),await GS(t,t._uninitializedComponentsProvider._online)):(K("FirestoreClient","Using default OnlineComponentProvider"),await GS(t,new fx))),t._onlineComponents}function qz(t){return rR(t).then(e=>e.syncEngine)}async function sR(t){const e=await rR(t),n=e.eventManager;return n.onListen=Az.bind(null,e.syncEngine),n.onUnlisten=Fz.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=Nz.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=Dz.bind(null,e.syncEngine),n}function Gz(t,e,n={}){const r=new Ds;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,l,c,u){const d=new nR({next:p=>{d.Za(),a.enqueueAndForget(()=>qj(i,f));const g=p.docs.has(l);!g&&p.fromCache?u.reject(new G(z.UNAVAILABLE,"Failed to get document because the client is offline.")):g&&p.fromCache&&c&&c.source==="server"?u.reject(new G(z.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(p)},error:p=>u.reject(p)}),f=new Gj(Nv(l.path),d,{includeMetadataChanges:!0,_a:!0});return Wj(i,f)}(await sR(t),t.asyncQueue,e,n,r)),r.promise}function Qz(t,e,n={}){const r=new Ds;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,l,c,u){const d=new nR({next:p=>{d.Za(),a.enqueueAndForget(()=>qj(i,f)),p.fromCache&&c.source==="server"?u.reject(new G(z.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(p)},error:p=>u.reject(p)}),f=new Gj(l,d,{includeMetadataChanges:!0,_a:!0});return Wj(i,f)}(await sR(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iR(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QS=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aR(t,e,n){if(!n)throw new G(z.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function Kz(t,e,n,r){if(e===!0&&r===!0)throw new G(z.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function KS(t){if(!Z.isDocumentKey(t))throw new G(z.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function XS(t){if(Z.isDocumentKey(t))throw new G(z.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Am(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ae()}function yr(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new G(z.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Am(t);throw new G(z.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function Xz(t,e){if(e<=0)throw new G(z.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YS{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new G(z.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new G(z.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Kz("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=iR((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new G(z.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new G(z.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new G(z.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Nm{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new YS({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new G(z.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new G(z.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new YS(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new m7;switch(r.type){case"firstParty":return new y7(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new G(z.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=QS.get(n);r&&(K("ComponentProvider","Removing Datastore"),QS.delete(n),r.terminate())}(this),Promise.resolve()}}function Yz(t,e,n,r={}){var s;const i=(t=yr(t,Nm))._getSettings(),a=`${e}:${n}`;if(i.host!=="firestore.googleapis.com"&&i.host!==a&&Qo("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},i),{host:a,ssl:!1})),r.mockUserToken){let l,c;if(typeof r.mockUserToken=="string")l=r.mockUserToken,c=Zt.MOCK_USER;else{l=lC(r.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new G(z.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Zt(u)}t._authCredentials=new p7(new ZC(l,c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ki{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Ki(this.firestore,e,this._query)}}class xn{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Di(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new xn(this.firestore,e,this._key)}}class Di extends Ki{constructor(e,n,r){super(e,n,Nv(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new xn(this.firestore,null,new Z(e))}withConverter(e){return new Di(this.firestore,e,this._path)}}function vr(t,e,...n){if(t=tt(t),aR("collection","path",e),t instanceof Nm){const r=Ge.fromString(e,...n);return XS(r),new Di(t,null,r)}{if(!(t instanceof xn||t instanceof Di))throw new G(z.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ge.fromString(e,...n));return XS(r),new Di(t.firestore,null,r)}}function Ut(t,e,...n){if(t=tt(t),arguments.length===1&&(e=ej.newId()),aR("doc","path",e),t instanceof Nm){const r=Ge.fromString(e,...n);return KS(r),new xn(t,null,new Z(r))}{if(!(t instanceof xn||t instanceof Di))throw new G(z.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ge.fromString(e,...n));return KS(r),new xn(t.firestore,t instanceof Di?t.converter:null,new Z(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JS{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new Mj(this,"async_queue_retry"),this.Vu=()=>{const r=dg();r&&K("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=dg();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=dg();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new Ds;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Nu(e))throw e;K("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const s=function(a){let l=a.message||"";return a.stack&&(l=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),l}(r);throw Ws("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const s=Hv.createAndSchedule(this,e,n,r,i=>this.yu(i));return this.Tu.push(s),s}fu(){this.Eu&&ae()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}class Xi extends Nm{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new JS,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new JS(e),this._firestoreClient=void 0,await e}}}function Jz(t,e){const n=typeof t=="object"?t:hv(),r=typeof t=="string"?t:e||"(default)",s=xm(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=iC("firestore");i&&Yz(s,...i)}return s}function Pm(t){if(t._terminated)throw new G(z.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||Zz(t),t._firestoreClient}function Zz(t){var e,n,r;const s=t._freezeSettings(),i=function(l,c,u,d){return new A7(l,c,u,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,iR(d.experimentalLongPollingOptions),d.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((n=s.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new Hz(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(l){const c=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(c),_online:c}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class el{constructor(e){this._byteString=e}static fromBase64String(e){try{return new el(Wt.fromBase64String(e))}catch(n){throw new G(z.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new el(Wt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wl{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new G(z.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new $t(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}function Zs(){return new wl("__name__")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mu{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qv{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new G(z.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new G(z.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Ne(this._lat,e._lat)||Ne(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kv{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eU=/^__.*__$/;class tU{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Qi(e,this.data,this.fieldMask,n,this.fieldTransforms):new Pu(e,this.data,n,this.fieldTransforms)}}class oR{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Qi(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function lR(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ae()}}class Xv{constructor(e,n,r,s,i,a){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new Xv(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.Ou(e),s}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return xf(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(lR(this.Cu)&&eU.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class nU{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Cm(e)}Qu(e,n,r,s=!1){return new Xv({Cu:e,methodName:n,qu:r,path:$t.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Ou(t){const e=t._freezeSettings(),n=Cm(t._databaseId);return new nU(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Yv(t,e,n,r,s,i={}){const a=t.Qu(i.merge||i.mergeFields?2:0,e,n,s);ew("Data must be an object, but it was:",a,r);const l=dR(r,a);let c,u;if(i.merge)c=new qn(a.fieldMask),u=a.fieldTransforms;else if(i.mergeFields){const d=[];for(const f of i.mergeFields){const p=mx(e,f,n);if(!a.contains(p))throw new G(z.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);fR(d,p)||d.push(p)}c=new qn(d),u=a.fieldTransforms.filter(f=>c.covers(f.field))}else c=null,u=a.fieldTransforms;return new tU(new Tn(l),c,u)}class Fm extends Mu{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Fm}}class Jv extends Mu{_toFieldTransform(e){return new bj(e.path,new su)}isEqual(e){return e instanceof Jv}}class Zv extends Mu{constructor(e,n){super(e),this.$u=n}_toFieldTransform(e){const n=new ou(e.serializer,xj(e.serializer,this.$u));return new bj(e.path,n)}isEqual(e){return e instanceof Zv&&this.$u===e.$u}}function cR(t,e,n,r){const s=t.Qu(1,e,n);ew("Data must be an object, but it was:",s,r);const i=[],a=Tn.empty();Ya(r,(c,u)=>{const d=tw(e,c,n);u=tt(u);const f=s.Nu(d);if(u instanceof Fm)i.push(d);else{const p=$u(u,f);p!=null&&(i.push(d),a.set(d,p))}});const l=new qn(i);return new oR(a,l,s.fieldTransforms)}function uR(t,e,n,r,s,i){const a=t.Qu(1,e,n),l=[mx(e,r,n)],c=[s];if(i.length%2!=0)throw new G(z.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<i.length;p+=2)l.push(mx(e,i[p])),c.push(i[p+1]);const u=[],d=Tn.empty();for(let p=l.length-1;p>=0;--p)if(!fR(u,l[p])){const g=l[p];let v=c[p];v=tt(v);const _=a.Nu(g);if(v instanceof Fm)u.push(g);else{const b=$u(v,_);b!=null&&(u.push(g),d.set(g,b))}}const f=new qn(u);return new oR(d,f,a.fieldTransforms)}function rU(t,e,n,r=!1){return $u(n,t.Qu(r?4:3,e))}function $u(t,e){if(hR(t=tt(t)))return ew("Unsupported field value:",e,t),dR(t,e);if(t instanceof Mu)return function(r,s){if(!lR(s.Cu))throw s.Bu(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,s){const i=[];let a=0;for(const l of r){let c=$u(l,s.Lu(a));c==null&&(c={nullValue:"NULL_VALUE"}),i.push(c),a++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=tt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return xj(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=It.fromDate(r);return{timestampValue:mf(s.serializer,i)}}if(r instanceof It){const i=new It(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:mf(s.serializer,i)}}if(r instanceof Qv)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof el)return{bytesValue:Cj(s.serializer,r._byteString)};if(r instanceof xn){const i=s.databaseId,a=r.firestore._databaseId;if(!a.isEqual(i))throw s.Bu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Lv(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof Kv)return function(a,l){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(c=>{if(typeof c!="number")throw l.Bu("VectorValues must only contain numeric values.");return Pv(l.serializer,c)})}}}}}}(r,s);throw s.Bu(`Unsupported field value: ${Am(r)}`)}(t,e)}function dR(t,e){const n={};return tj(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ya(t,(r,s)=>{const i=$u(s,e.Mu(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function hR(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof It||t instanceof Qv||t instanceof el||t instanceof xn||t instanceof Mu||t instanceof Kv)}function ew(t,e,n){if(!hR(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){const r=Am(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function mx(t,e,n){if((e=tt(e))instanceof wl)return e._internalPath;if(typeof e=="string")return tw(t,e);throw xf("Field path arguments must be of type string or ",t,!1,void 0,n)}const sU=new RegExp("[~\\*/\\[\\]]");function tw(t,e,n){if(e.search(sU)>=0)throw xf(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new wl(...e.split("."))._internalPath}catch{throw xf(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function xf(t,e,n,r,s){const i=r&&!r.isEmpty(),a=s!==void 0;let l=`Function ${e}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let c="";return(i||a)&&(c+=" (found",i&&(c+=` in field ${r}`),a&&(c+=` in document ${s}`),c+=")"),new G(z.INVALID_ARGUMENT,l+t+c)}function fR(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mR{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new xn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new iU(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Dm("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class iU extends mR{data(){return super.data()}}function Dm(t,e){return typeof e=="string"?tw(t,e):e instanceof wl?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aU(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new G(z.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class nw{}class rw extends nw{}function _e(t,e,...n){let r=[];e instanceof nw&&r.push(e),r=r.concat(n),function(i){const a=i.filter(c=>c instanceof sw).length,l=i.filter(c=>c instanceof Lm).length;if(a>1||a>0&&l>0)throw new G(z.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class Lm extends rw{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Lm(e,n,r)}_apply(e){const n=this._parse(e);return pR(e._query,n),new Ki(e.firestore,e.converter,ix(e._query,n))}_parse(e){const n=Ou(e.firestore);return function(i,a,l,c,u,d,f){let p;if(u.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new G(z.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){eE(f,d);const g=[];for(const v of f)g.push(ZS(c,i,v));p={arrayValue:{values:g}}}else p=ZS(c,i,f)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||eE(f,d),p=rU(l,a,f,d==="in"||d==="not-in");return _t.create(u,d,p)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function X(t,e,n){const r=e,s=Dm("where",t);return Lm._create(s,r,n)}class sw extends nw{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new sw(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:zr.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let a=s;const l=i.getFlattenedFilters();for(const c of l)pR(a,c),a=ix(a,c)}(e._query,n),new Ki(e.firestore,e.converter,ix(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class iw extends rw{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new iw(e,n)}_apply(e){const n=function(s,i,a){if(s.startAt!==null)throw new G(z.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new G(z.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new ru(i,a)}(e._query,this._field,this._direction);return new Ki(e.firestore,e.converter,function(s,i){const a=s.explicitOrderBy.concat([i]);return new xl(s.path,s.collectionGroup,a,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,n))}}function hs(t,e="asc"){const n=e,r=Dm("orderBy",t);return iw._create(r,n)}class aw extends rw{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new aw(e,n,r)}_apply(e){return new Ki(e.firestore,e.converter,ff(e._query,this._limit,this._limitType))}}function lu(t){return Xz("limit",t),aw._create("limit",t,"F")}function ZS(t,e,n){if(typeof(n=tt(n))=="string"){if(n==="")throw new G(z.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!uj(e)&&n.indexOf("/")!==-1)throw new G(z.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Ge.fromString(n));if(!Z.isDocumentKey(r))throw new G(z.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return _S(t,new Z(r))}if(n instanceof xn)return _S(t,n._key);throw new G(z.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Am(n)}.`)}function eE(t,e){if(!Array.isArray(t)||t.length===0)throw new G(z.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function pR(t,e){const n=function(s,i){for(const a of s)for(const l of a.getFlattenedFilters())if(i.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new G(z.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new G(z.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class oU{convertValue(e,n="none"){switch(Oa(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ft(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Ma(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw ae()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Ya(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var n,r,s;const i=(s=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(a=>ft(a.doubleValue));return new Kv(i)}convertGeoPoint(e){return new Qv(ft(e.latitude),ft(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=Cv(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(eu(e));default:return null}}convertTimestamp(e){const n=zi(e);return new It(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Ge.fromString(e);Me(Fj(r));const s=new tu(r.get(1),r.get(3)),i=new Z(r.popFirst(5));return s.isEqual(n)||Ws(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ow(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uc{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class gR extends mR{constructor(e,n,r,s,i,a){super(e,n,r,s,a),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new vh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Dm("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class vh extends gR{data(e={}){return super.data(e)}}class lU{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new uc(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new vh(this._firestore,this._userDataWriter,r.key,r,new uc(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new G(z.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let a=0;return s._snapshot.docChanges.map(l=>{const c=new vh(s._firestore,s._userDataWriter,l.doc.key,l.doc,new uc(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);return l.doc,{type:"added",doc:c,oldIndex:-1,newIndex:a++}})}{let a=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(l=>i||l.type!==3).map(l=>{const c=new vh(s._firestore,s._userDataWriter,l.doc.key,l.doc,new uc(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);let u=-1,d=-1;return l.type!==0&&(u=a.indexOf(l.doc.key),a=a.delete(l.doc.key)),l.type!==1&&(a=a.add(l.doc),d=a.indexOf(l.doc.key)),{type:cU(l.type),doc:c,oldIndex:u,newIndex:d}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function cU(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ae()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $a(t){t=yr(t,xn);const e=yr(t.firestore,Xi);return Gz(Pm(e),t._key).then(n=>mU(e,t,n))}class xR extends oU{constructor(e){super(),this.firestore=e}convertBytes(e){return new el(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new xn(this.firestore,null,n)}}function Yi(t){t=yr(t,Ki);const e=yr(t.firestore,Xi),n=Pm(e),r=new xR(e);return aU(t._query),Qz(n,t._query).then(s=>new lU(e,r,t,s))}function uU(t,e,n){t=yr(t,xn);const r=yr(t.firestore,Xi),s=ow(t.converter,e,n);return Bu(r,[Yv(Ou(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,gn.none())])}function dU(t,e,n,...r){t=yr(t,xn);const s=yr(t.firestore,Xi),i=Ou(s);let a;return a=typeof(e=tt(e))=="string"||e instanceof wl?uR(i,"updateDoc",t._key,e,n,r):cR(i,"updateDoc",t._key,e),Bu(s,[a.toMutation(t._key,gn.exists(!0))])}function hU(t){return Bu(yr(t.firestore,Xi),[new Tm(t._key,gn.none())])}function fU(t,e){const n=yr(t.firestore,Xi),r=Ut(t),s=ow(t.converter,e);return Bu(n,[Yv(Ou(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,gn.exists(!1))]).then(()=>r)}function Bu(t,e){return function(r,s){const i=new Ds;return r.asyncQueue.enqueueAndForget(async()=>Lz(await qz(r),s,i)),i.promise}(Pm(t),e)}function mU(t,e,n){const r=n.docs.get(e._key),s=new xR(t);return new gR(t,s,e._key,r,new uc(n.hasPendingWrites,n.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pU{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=Ou(e)}set(e,n,r){this._verifyNotCommitted();const s=fg(e,this._firestore),i=ow(s.converter,n,r),a=Yv(this._dataReader,"WriteBatch.set",s._key,i,s.converter!==null,r);return this._mutations.push(a.toMutation(s._key,gn.none())),this}update(e,n,r,...s){this._verifyNotCommitted();const i=fg(e,this._firestore);let a;return a=typeof(n=tt(n))=="string"||n instanceof wl?uR(this._dataReader,"WriteBatch.update",i._key,n,r,s):cR(this._dataReader,"WriteBatch.update",i._key,n),this._mutations.push(a.toMutation(i._key,gn.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=fg(e,this._firestore);return this._mutations=this._mutations.concat(new Tm(n._key,gn.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new G(z.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function fg(t,e){if((t=tt(t)).firestore!==e)throw new G(z.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}function Gs(){return new Jv("serverTimestamp")}function cu(t){return new Zv("increment",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zu(t){return Pm(t=yr(t,Xi)),new pU(t,e=>Bu(t,e))}(function(e,n=!0){(function(s){gl=s})(Xa),Fa(new $i("firestore",(r,{instanceIdentifier:s,options:i})=>{const a=r.getProvider("app").getImmediate(),l=new Xi(new g7(r.getProvider("auth-internal")),new w7(r.getProvider("app-check-internal")),function(u,d){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new G(z.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new tu(u.options.projectId,d)}(a,s),a);return i=Object.assign({useFetchStreams:n},i),l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),ss(gS,"4.7.3",e),ss(gS,"4.7.3","esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yR="firebasestorage.googleapis.com",vR="storageBucket",gU=2*60*1e3,xU=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dt extends ys{constructor(e,n,r=0){super(mg(e),`Firebase Storage: ${n} (${mg(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,dt.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return mg(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var ut;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(ut||(ut={}));function mg(t){return"storage/"+t}function lw(){const t="An unknown error occurred, please check the error payload for server response.";return new dt(ut.UNKNOWN,t)}function yU(t){return new dt(ut.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function vU(t){return new dt(ut.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function wU(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new dt(ut.UNAUTHENTICATED,t)}function _U(){return new dt(ut.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function bU(t){return new dt(ut.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function SU(){return new dt(ut.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function EU(){return new dt(ut.CANCELED,"User canceled the upload/download.")}function kU(t){return new dt(ut.INVALID_URL,"Invalid URL '"+t+"'.")}function TU(t){return new dt(ut.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function IU(){return new dt(ut.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+vR+"' property when initializing the app?")}function CU(){return new dt(ut.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function jU(){return new dt(ut.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function RU(t){return new dt(ut.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function px(t){return new dt(ut.INVALID_ARGUMENT,t)}function wR(){return new dt(ut.APP_DELETED,"The Firebase app was deleted.")}function AU(t){return new dt(ut.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function kc(t,e){return new dt(ut.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function Jl(t){throw new dt(ut.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gn{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=Gn.makeFromUrl(e,n)}catch{return new Gn(e,"")}if(r.path==="")return r;throw TU(e)}static makeFromUrl(e,n){let r=null;const s="([A-Za-z0-9.\\-_]+)";function i(I){I.path.charAt(I.path.length-1)==="/"&&(I.path_=I.path_.slice(0,-1))}const a="(/(.*))?$",l=new RegExp("^gs://"+s+a,"i"),c={bucket:1,path:3};function u(I){I.path_=decodeURIComponent(I.path)}const d="v[A-Za-z0-9_]+",f=n.replace(/[.]/g,"\\."),p="(/([^?#]*).*)?$",g=new RegExp(`^https?://${f}/${d}/b/${s}/o${p}`,"i"),v={bucket:1,path:3},_=n===yR?"(?:storage.googleapis.com|storage.cloud.google.com)":n,b="([^?#]*)",E=new RegExp(`^https?://${_}/${s}/${b}`,"i"),S=[{regex:l,indices:c,postModify:i},{regex:g,indices:v,postModify:u},{regex:E,indices:{bucket:1,path:2},postModify:u}];for(let I=0;I<S.length;I++){const F=S[I],D=F.regex.exec(e);if(D){const C=D[F.indices.bucket];let k=D[F.indices.path];k||(k=""),r=new Gn(C,k),F.postModify(r);break}}if(r==null)throw kU(e);return r}}class NU{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PU(t,e,n){let r=1,s=null,i=null,a=!1,l=0;function c(){return l===2}let u=!1;function d(...b){u||(u=!0,e.apply(null,b))}function f(b){s=setTimeout(()=>{s=null,t(g,c())},b)}function p(){i&&clearTimeout(i)}function g(b,...E){if(u){p();return}if(b){p(),d.call(null,b,...E);return}if(c()||a){p(),d.call(null,b,...E);return}r<64&&(r*=2);let S;l===1?(l=2,S=0):S=(r+Math.random())*1e3,f(S)}let v=!1;function _(b){v||(v=!0,p(),!u&&(s!==null?(b||(l=2),clearTimeout(s),f(0)):b||(l=1)))}return f(0),i=setTimeout(()=>{a=!0,_(!0)},n),_}function FU(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DU(t){return t!==void 0}function LU(t){return typeof t=="object"&&!Array.isArray(t)}function cw(t){return typeof t=="string"||t instanceof String}function tE(t){return uw()&&t instanceof Blob}function uw(){return typeof Blob<"u"}function nE(t,e,n,r){if(r<e)throw px(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw px(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mm(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function _R(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const s=e(r)+"="+e(t[r]);n=n+s+"&"}return n=n.slice(0,-1),n}var ka;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(ka||(ka={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MU(t,e){const n=t>=500&&t<600,s=[408,429].indexOf(t)!==-1,i=e.indexOf(t)!==-1;return n||s||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OU{constructor(e,n,r,s,i,a,l,c,u,d,f,p=!0){this.url_=e,this.method_=n,this.headers_=r,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=a,this.callback_=l,this.errorCallback_=c,this.timeout_=u,this.progressCallback_=d,this.connectionFactory_=f,this.retry=p,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((g,v)=>{this.resolve_=g,this.reject_=v,this.start_()})}start_(){const e=(r,s)=>{if(s){r(!1,new Fd(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const a=l=>{const c=l.loaded,u=l.lengthComputable?l.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,u)};this.progressCallback_!==null&&i.addUploadProgressListener(a),i.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(a),this.pendingConnection_=null;const l=i.getErrorCode()===ka.NO_ERROR,c=i.getStatus();if(!l||MU(c,this.additionalRetryCodes_)&&this.retry){const d=i.getErrorCode()===ka.ABORT;r(!1,new Fd(!1,null,d));return}const u=this.successCodes_.indexOf(c)!==-1;r(!0,new Fd(u,i))})},n=(r,s)=>{const i=this.resolve_,a=this.reject_,l=s.connection;if(s.wasSuccessCode)try{const c=this.callback_(l,l.getResponse());DU(c)?i(c):i()}catch(c){a(c)}else if(l!==null){const c=lw();c.serverResponse=l.getErrorText(),this.errorCallback_?a(this.errorCallback_(l,c)):a(c)}else if(s.canceled){const c=this.appDelete_?wR():EU();a(c)}else{const c=SU();a(c)}};this.canceled_?n(!1,new Fd(!1,null,!0)):this.backoffId_=PU(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&FU(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Fd{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function $U(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function BU(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function zU(t,e){e&&(t["X-Firebase-GMPID"]=e)}function UU(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function VU(t,e,n,r,s,i,a=!0){const l=_R(t.urlParams),c=t.url+l,u=Object.assign({},t.headers);return zU(u,e),$U(u,n),BU(u,i),UU(u,r),new OU(c,t.method,u,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HU(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function WU(...t){const e=HU();if(e!==void 0){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(uw())return new Blob(t);throw new dt(ut.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function qU(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GU(t){if(typeof atob>"u")throw RU("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const es={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class pg{constructor(e,n){this.data=e,this.contentType=n||null}}function QU(t,e){switch(t){case es.RAW:return new pg(bR(e));case es.BASE64:case es.BASE64URL:return new pg(SR(t,e));case es.DATA_URL:return new pg(XU(e),YU(e))}throw lw()}function bR(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const i=r,a=t.charCodeAt(++n);r=65536|(i&1023)<<10|a&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function KU(t){let e;try{e=decodeURIComponent(t)}catch{throw kc(es.DATA_URL,"Malformed data URL.")}return bR(e)}function SR(t,e){switch(t){case es.BASE64:{const s=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(s||i)throw kc(t,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case es.BASE64URL:{const s=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(s||i)throw kc(t,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=GU(e)}catch(s){throw s.message.includes("polyfill")?s:kc(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}class ER{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw kc(es.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=JU(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function XU(t){const e=new ER(t);return e.base64?SR(es.BASE64,e.rest):KU(e.rest)}function YU(t){return new ER(t).contentType}function JU(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yi{constructor(e,n){let r=0,s="";tE(e)?(this.data_=e,r=e.size,s=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=s}size(){return this.size_}type(){return this.type_}slice(e,n){if(tE(this.data_)){const r=this.data_,s=qU(r,e,n);return s===null?null:new yi(s)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new yi(r,!0)}}static getBlob(...e){if(uw()){const n=e.map(r=>r instanceof yi?r.data_:r);return new yi(WU.apply(null,n))}else{const n=e.map(a=>cw(a)?QU(es.RAW,a).data:a.data_);let r=0;n.forEach(a=>{r+=a.byteLength});const s=new Uint8Array(r);let i=0;return n.forEach(a=>{for(let l=0;l<a.length;l++)s[i++]=a[l]}),new yi(s,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kR(t){let e;try{e=JSON.parse(t)}catch{return null}return LU(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZU(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function eV(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function TR(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tV(t,e){return e}class dn{constructor(e,n,r,s){this.server=e,this.local=n||e,this.writable=!!r,this.xform=s||tV}}let Dd=null;function nV(t){return!cw(t)||t.length<2?t:TR(t)}function IR(){if(Dd)return Dd;const t=[];t.push(new dn("bucket")),t.push(new dn("generation")),t.push(new dn("metageneration")),t.push(new dn("name","fullPath",!0));function e(i,a){return nV(a)}const n=new dn("name");n.xform=e,t.push(n);function r(i,a){return a!==void 0?Number(a):a}const s=new dn("size");return s.xform=r,t.push(s),t.push(new dn("timeCreated")),t.push(new dn("updated")),t.push(new dn("md5Hash",null,!0)),t.push(new dn("cacheControl",null,!0)),t.push(new dn("contentDisposition",null,!0)),t.push(new dn("contentEncoding",null,!0)),t.push(new dn("contentLanguage",null,!0)),t.push(new dn("contentType",null,!0)),t.push(new dn("metadata","customMetadata",!0)),Dd=t,Dd}function rV(t,e){function n(){const r=t.bucket,s=t.fullPath,i=new Gn(r,s);return e._makeStorageReference(i)}Object.defineProperty(t,"ref",{get:n})}function sV(t,e,n){const r={};r.type="file";const s=n.length;for(let i=0;i<s;i++){const a=n[i];r[a.local]=a.xform(r,e[a.server])}return rV(r,t),r}function CR(t,e,n){const r=kR(e);return r===null?null:sV(t,r,n)}function iV(t,e,n,r){const s=kR(e);if(s===null||!cw(s.downloadTokens))return null;const i=s.downloadTokens;if(i.length===0)return null;const a=encodeURIComponent;return i.split(",").map(u=>{const d=t.bucket,f=t.fullPath,p="/b/"+a(d)+"/o/"+a(f),g=Mm(p,n,r),v=_R({alt:"media",token:u});return g+v})[0]}function aV(t,e){const n={},r=e.length;for(let s=0;s<r;s++){const i=e[s];i.writable&&(n[i.server]=t[i.local])}return JSON.stringify(n)}class dw{constructor(e,n,r,s){this.url=e,this.method=n,this.handler=r,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jR(t){if(!t)throw lw()}function oV(t,e){function n(r,s){const i=CR(t,s,e);return jR(i!==null),i}return n}function lV(t,e){function n(r,s){const i=CR(t,s,e);return jR(i!==null),iV(i,s,t.host,t._protocol)}return n}function RR(t){function e(n,r){let s;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?s=_U():s=wU():n.getStatus()===402?s=vU(t.bucket):n.getStatus()===403?s=bU(t.path):s=r,s.status=n.getStatus(),s.serverResponse=r.serverResponse,s}return e}function AR(t){const e=RR(t);function n(r,s){let i=e(r,s);return r.getStatus()===404&&(i=yU(t.path)),i.serverResponse=s.serverResponse,i}return n}function cV(t,e,n){const r=e.fullServerUrl(),s=Mm(r,t.host,t._protocol),i="GET",a=t.maxOperationRetryTime,l=new dw(s,i,lV(t,n),a);return l.errorHandler=AR(e),l}function uV(t,e){const n=e.fullServerUrl(),r=Mm(n,t.host,t._protocol),s="DELETE",i=t.maxOperationRetryTime;function a(c,u){}const l=new dw(r,s,a,i);return l.successCodes=[200,204],l.errorHandler=AR(e),l}function dV(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function hV(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=dV(null,e)),r}function fV(t,e,n,r,s){const i=e.bucketOnlyServerUrl(),a={"X-Goog-Upload-Protocol":"multipart"};function l(){let S="";for(let I=0;I<2;I++)S=S+Math.random().toString().slice(2);return S}const c=l();a["Content-Type"]="multipart/related; boundary="+c;const u=hV(e,r,s),d=aV(u,n),f="--"+c+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+d+`\r
--`+c+`\r
Content-Type: `+u.contentType+`\r
\r
`,p=`\r
--`+c+"--",g=yi.getBlob(f,r,p);if(g===null)throw CU();const v={name:u.fullPath},_=Mm(i,t.host,t._protocol),b="POST",E=t.maxUploadRetryTime,w=new dw(_,b,oV(t,n),E);return w.urlParams=v,w.headers=a,w.body=g.uploadData(),w.errorHandler=RR(e),w}class mV{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=ka.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=ka.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=ka.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,s){if(this.sent_)throw Jl("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(n,e,!0),s!==void 0)for(const i in s)s.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,s[i].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Jl("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Jl("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Jl("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Jl("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class pV extends mV{initXhr(){this.xhr_.responseType="text"}}function hw(){return new pV}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ba{constructor(e,n){this._service=e,n instanceof Gn?this._location=n:this._location=Gn.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new Ba(e,n)}get root(){const e=new Gn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return TR(this._location.path)}get storage(){return this._service}get parent(){const e=ZU(this._location.path);if(e===null)return null;const n=new Gn(this._location.bucket,e);return new Ba(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw AU(e)}}function gV(t,e,n){t._throwIfRoot("uploadBytes");const r=fV(t.storage,t._location,IR(),new yi(e,!0),n);return t.storage.makeRequestWithTokens(r,hw).then(s=>({metadata:s,ref:t}))}function xV(t){t._throwIfRoot("getDownloadURL");const e=cV(t.storage,t._location,IR());return t.storage.makeRequestWithTokens(e,hw).then(n=>{if(n===null)throw jU();return n})}function yV(t){t._throwIfRoot("deleteObject");const e=uV(t.storage,t._location);return t.storage.makeRequestWithTokens(e,hw)}function vV(t,e){const n=eV(t._location.path,e),r=new Gn(t._location.bucket,n);return new Ba(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wV(t){return/^[A-Za-z]+:\/\//.test(t)}function _V(t,e){return new Ba(t,e)}function NR(t,e){if(t instanceof fw){const n=t;if(n._bucket==null)throw IU();const r=new Ba(n,n._bucket);return e!=null?NR(r,e):r}else return e!==void 0?vV(t,e):t}function bV(t,e){if(e&&wV(e)){if(t instanceof fw)return _V(t,e);throw px("To use ref(service, url), the first argument must be a Storage instance.")}else return NR(t,e)}function rE(t,e){const n=e==null?void 0:e[vR];return n==null?null:Gn.makeFromBucketSpec(n,t)}function SV(t,e,n,r={}){t.host=`${e}:${n}`,t._protocol="http";const{mockUserToken:s}=r;s&&(t._overrideAuthToken=typeof s=="string"?s:lC(s,t.app.options.projectId))}class fw{constructor(e,n,r,s,i){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=s,this._firebaseVersion=i,this._bucket=null,this._host=yR,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=gU,this._maxUploadRetryTime=xU,this._requests=new Set,s!=null?this._bucket=Gn.makeFromBucketSpec(s,this._host):this._bucket=rE(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Gn.makeFromBucketSpec(this._url,e):this._bucket=rE(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){nE("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){nE("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Ba(this,e)}_makeRequest(e,n,r,s,i=!0){if(this._deleted)return new NU(wR());{const a=VU(e,this._appId,r,s,n,this._firebaseVersion,i);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}async makeRequestWithTokens(e,n){const[r,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,s).getPromise()}}const sE="@firebase/storage",iE="0.13.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PR="storage";function FR(t,e,n){return t=tt(t),gV(t,e,n)}function DR(t){return t=tt(t),xV(t)}function EV(t){return t=tt(t),yV(t)}function mw(t,e){return t=tt(t),bV(t,e)}function kV(t=hv(),e){t=tt(t);const r=xm(t,PR).getImmediate({identifier:e}),s=iC("storage");return s&&TV(r,...s),r}function TV(t,e,n,r={}){SV(t,e,n,r)}function IV(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new fw(n,r,s,e,Xa)}function CV(){Fa(new $i(PR,IV,"PUBLIC").setMultipleInstances(!0)),ss(sE,iE,""),ss(sE,iE,"esm2017")}CV();const pw=dC({apiKey:"AIzaSyDS7lgm2PwJBFrYE6ZHSYJfqcQw2TLC878",appId:"1:938280289868:web:e36c48cfbd55e4a8de96e",projectId:"zingmp3-clone-61799",storageBucket:"zingmp3-clone-61799.appspot.com",authDomain:"zingmp3-clone-61799.firebaseapp.com",messagingSenderId:"938280289868"}),Pe=Jz(pw),za=a7(pw),jV=new ks,gw=kV(pw),RV="/HD-MP3/assets/user-default-971f59df.png";function gx({className:t}){const[e]=Ev(za),n={imageFrame:`${t||"w-[35px] h-[35px]"} flex-shrink-0 rounded-full overflow-hidden ${e!=null&&e.photoURL?"":"flex items-center justify-center bg-[#ccc]"}`};return o.jsx("div",{className:n.imageFrame,children:o.jsx(Xe,{src:(e==null?void 0:e.photoURL)||RV,className:"w-full"})})}function AV({children:t,className:e="px-2 py-1 text-sm font-[500]",position:n="bottom-[calc(100%+8px)]",content:r,isWrapped:s,...i},a){const[l,c]=m.useState(!1),{theme:u}=q(),{setTriggerRef:d,state:f}=Sr(),{onClick:p}=i,g=m.useRef(null),v=()=>{"ontouchstart"in document.documentElement||c(!0)},_=()=>{c(!1)};m.useEffect(()=>{const w=g.current;if(w)return d&&d(w),w.addEventListener("mouseenter",v),w.addEventListener("mouseleave",_),()=>{w.removeEventListener("mouseenter",v),w.removeEventListener("mouseleave",_)}},[]);const b={container:`${u.modal_bg} text-white`},E=o.jsx(o.Fragment,{children:m.isValidElement(t)&&o.jsxs(o.Fragment,{children:[Object.keys(i).length?m.cloneElement(t,{ref:g,onClick:p}):m.cloneElement(t,{ref:g}),!(f!=null&&f.isOpen)&&l&&o.jsx("div",{className:`${b.container} absolute whitespace-nowrap -translate-x-1/2 left-1/2 rounded-md ${n} ${e}`,children:r})]})});if(m.isValidElement(t))return o.jsx(o.Fragment,{children:s?E:o.jsx("div",{className:"relative",children:E})})}const ls=m.forwardRef(AV);function xw(){const{setSuccessToast:t}=ge(),{close:e}=Sr(),n=()=>{navigator.clipboard.writeText(location.href),t("Link copied"),e()};return o.jsxs("button",{onClick:n,children:[o.jsx(_L,{className:"w-5"}),o.jsx("span",{children:"Copy link"})]})}function xx(t){return o.jsxs("div",{className:"w-1/3 md:w-1/5 px-2",children:[t.variant==="skeleton"&&o.jsxs(o.Fragment,{children:[o.jsx(le,{className:"pt-[100%] rounded-full"}),o.jsx(le,{className:"mt-1 w-full h-[24px]"})]}),t.variant==="singer-item"&&o.jsxs(o.Fragment,{children:[o.jsx(we,{to:`/singer/${t.singer.id}`,children:o.jsx(Eu,{className:"!rounded-full",children:o.jsx(Xe,{src:t.singer.image_url,className:"hover:scale-[1.05] transition-transform"})})}),o.jsx("p",{className:"mt-1 text-center text-lg",children:t.singer.name})]})]})}const NV="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let Uu=(t=21)=>{let e="",n=crypto.getRandomValues(new Uint8Array(t|=0));for(;t--;)e+=NV[n[t]&63];return e};const PV=!1,Nn=vr(Pe,"Songs"),wr=vr(Pe,"Playlists"),yf=vr(Pe,"Singers"),FV=vr(Pe,"Users");vr(Pe,"Lyrics");const DV=vr(Pe,"Comments"),Vu=async({collectionName:t,id:e,msg:n})=>{await hU(Ut(Pe,t,e))},Ur=async({collectionName:t,id:e,msg:n})=>$a(Ut(Pe,t,e)),Qs=async({collectionName:t,data:e,msg:n})=>await fU(vr(Pe,t),e),kt=async({collectionName:t,id:e,data:n,msg:r})=>await dU(Ut(Pe,t,e),n),yw=async({file:t,folder:e,namePrefix:n,msg:r})=>{const s=n.replace("@gmail.com","")+"_"+t.name.replaceAll(" ","").toLowerCase(),i=mw(gw,`${e+s}`),a=await FR(i,t);return{fileURL:await DR(a.ref),filePath:a.metadata.fullPath}},LV=async({blob:t,folder:e,msg:n})=>{const r=Date.now()+".jpg",s=mw(gw,`${e+r}`),i=await FR(s,t);return{fileURL:await DR(i.ref),filePath:i.metadata.fullPath}},An=async({filePath:t,msg:e})=>{try{const n=mw(gw,t);await EV(n)}catch(n){console.log({error:n})}},LR=async t=>{await An({filePath:t.song_file_path,msg:">>> api: delete song file"}),t.beat_file_path&&await An({filePath:t.beat_file_path,msg:">>> api: delete song's image file"}),t.image_file_path&&await An({filePath:t.image_file_path,msg:">>> api: delete song's image file"})},MV=async t=>{const e=Date.now(),n=await nI.post("/api/image/encode",t);let r="";n&&(r=n.data.encode);const s=(Date.now()-e)/1e3;return console.log(">>> api: get blurHash encode finished after",s),{encode:r}},OV=async t=>{const e=new FormData;e.append("file",t);const n=Date.now(),r=await nI.post("/api/image/optimize",e,{responseType:"blob"});let s;r&&(s=r.data);const i=(Date.now()-n)/1e3;return console.log(">>> api: optimize finished after",i),s};async function Pn(t,e){const n=await Yi(t);return n.docs?n.docs.map(s=>{const i={...s.data(),id:s.id,queue_id:Uu(4)};return e!=null&&e.getQueueId&&(i.queue_id=e.getQueueId(i)),i}):[]}async function Vr(t){const e=await Yi(t);return e.docs.length?e.docs.map(r=>({...r.data(),id:r.id})):[]}async function vf(t){const e=await Yi(t);return e.docs.length?e.docs.map(r=>({...r.data(),id:r.id})):[]}async function $V(t){const e=await Yi(t);return e.docs.length?e.docs.map(r=>r.data()):[]}const Ji=async({imageFile:t,blob:e})=>{let n=e;if(t&&(n=await OV(t)),!n)throw new Error("File not found");const r=LV({blob:n,folder:"/images/"}),{encode:s}=await MV(n),{filePath:i,fileURL:a}=await r;return{image_file_path:i,image_url:a,blurhash_encode:s}},MR=["Newest","Popular"],BV=()=>MR.reduce((t,e)=>{const n={playlists:[],shouldFetching:!0};return{...t,[e]:n}},{});function zV(){const[t,e]=m.useState(BV),{setErrorToast:n}=ge(),[r,s]=m.useState("Newest"),[i,a]=m.useState(!0),l=async()=>{try{const c={...t[r]};if(a(!0),c.shouldFetching){c.shouldFetching=!1;let u;switch(r){case"Newest":u=_e(wr,X("is_official","==",!0),X("is_public","==",!0),hs("updated_at","desc"),lu(20));break;case"Popular":u=_e(wr,X("is_official","==",!0),X("is_public","==",!0),hs("like","desc"),lu(20));break}if(u){const d=await Vr(u);c.playlists=d,e(f=>({...f,[r]:c}))}}else await zs(100)}catch(c){console.log({message:c}),n()}finally{a(!1)}};return m.useEffect(()=>(l(),()=>{a(!0)}),[r]),{isFetching:i,playlistMap:t,getPlaylist:l,tabs:MR,tab:r,setTab:s}}function UV(){const{getPlaylist:t,isFetching:e,playlistMap:n,...r}=zV();return o.jsx(o.Fragment,{children:o.jsxs("div",{children:[o.jsx(be,{title:"Playlist"}),o.jsx("div",{className:"flex space-x-2 my-2",children:o.jsx(xs,{render:s=>s,...r})}),o.jsx(ml,{loading:e,playlists:n[r.tab].playlists})]})})}const OR=["Newest","Popular"],VV=()=>OR.reduce((t,e)=>{const n={songs:[],shouldFetching:!0};return{...t,[e]:n}},{});function HV(){const[t,e]=m.useState(VV),{setErrorToast:n}=ge(),[r,s]=m.useState("Newest"),[i,a]=m.useState(!0),l=async()=>{try{const c={...t[r]};if(a(!0),c.shouldFetching){c.shouldFetching=!1;let u;switch(r){case"Newest":u=_e(Nn,X("is_official","==",!0),hs("updated_at","desc"),lu(20));break;case"Popular":u=_e(Nn,X("is_official","==",!0),hs("like","desc"),lu(20));break}if(u){const d=await Pn(u);c.songs=d,e(f=>({...f,[r]:c}))}}else await zs(100)}catch(c){console.log({message:c}),n()}finally{a(!1)}};return m.useEffect(()=>(l(),()=>{a(!0)}),[r]),{isFetching:i,songMap:t,tabs:OR,tab:r,setTab:s}}function WV({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{fillRule:"evenodd",d:"M7.72 12.53a.75.75 0 010-1.06l7.5-7.5a.75.75 0 111.06 1.06L9.31 12l6.97 6.97a.75.75 0 11-1.06 1.06l-7.5-7.5z",clipRule:"evenodd"}))}const qV=m.forwardRef(WV),GV=qV;function QV({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{fillRule:"evenodd",d:"M16.28 11.47a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 01-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 011.06-1.06l7.5 7.5z",clipRule:"evenodd"}))}const KV=m.forwardRef(QV),XV=KV;function YV({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{fillRule:"evenodd",d:"M4.5 5.653c0-1.426 1.529-2.33 2.779-1.643l11.54 6.348c1.295.712 1.295 2.573 0 3.285L7.28 19.991c-1.25.687-2.779-.217-2.779-1.643V5.653z",clipRule:"evenodd"}))}const JV=m.forwardRef(YV),ZV=JV;function eH({title:t,titleId:e,...n},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?m.createElement("title",{id:e},t):null,m.createElement("path",{fillRule:"evenodd",d:"M12 3.75a.75.75 0 01.75.75v6.75h6.75a.75.75 0 010 1.5h-6.75v6.75a.75.75 0 01-1.5 0v-6.75H4.5a.75.75 0 010-1.5h6.75V4.5a.75.75 0 01.75-.75z",clipRule:"evenodd"}))}const tH=m.forwardRef(eH),nH=tH;function $R({children:t,className:e=""}){const{theme:n}=q();return o.jsx("div",{className:`rounded-md py-2 ${n.modal_bg} text-white ${e}`,children:t})}function _l({children:t,className:e=""}){const n={container:"hover:[&>*:not(div.absolute)]:bg-white/5 [&>*]:px-3 [&>*]:py-2 [&>*]:w-full [&>*]:space-x-2 [&>*]:text-sm [&>*]:flex [&>*]:items-center"};return o.jsx("div",{className:`${n.container} ${e}`,children:t})}const vw=(t,e,n="rgba(255,255,255,.15)")=>`linear-gradient(to right, ${t} ${e}%, ${n} ${e}%, ${n}`;function ww({audioEle:t,baseColor:e,color:n,progressLineRef:r,setStatusFromParent:s,statusFromParent:i}){const{theme:a}=q(),[l,c]=m.useState("paused"),[u,d]=m.useState(!1),f=i||l,p=s||c,g=m.useRef(""),v=m.useRef(f),_=()=>{try{t.play(),d(!0)}catch{}},b=()=>{t==null||t.pause(),S()},E=()=>{f==="playing"?b():f==="paused"&&_()},w=()=>{p("playing")},S=()=>{p("paused")},I=j=>{if(!t)return;const N=+(j||t.currentTime/t.duration*100).toFixed(1);r!=null&&r.current&&(r.current.style.background=vw(n||g.current,N,e))},F=()=>{const N=t.currentTime/(t.duration/100);I(+N.toFixed(1))},D=()=>{console.log("error"),p("error")},C=j=>{t.currentTime=j,I(),f!=="playing"&&_()},k=j=>{t.currentTime=t.currentTime+j},R=j=>{t.currentTime=t.currentTime-j};return m.useEffect(()=>{if(t)return t.addEventListener("error",D),t.addEventListener("pause",S),t.addEventListener("playing",w),r!=null&&r.current&&t.addEventListener("timeupdate",F),()=>{t.removeEventListener("error",D),t.removeEventListener("pause",S),t.removeEventListener("playing",w),r!=null&&r.current&&t.removeEventListener("timeupdate",F)}},[t]),m.useEffect(()=>{g.current=a.content_code,f!=="playing"&&I()},[a]),m.useEffect(()=>{v.current=f},[f]),{play:_,pause:b,seek:C,handlePlayPause:E,status:f,forward:k,backward:R,isClickPlay:u,statusRef:v}}const rH=()=>({playStatus:"paused",isLoaded:!0,countDown:0}),BR=cv({name:"playStatus",initialState:()=>rH(),reducers:{setPlayStatus(t,e){Object.assign(t,e.payload)}}}),Ln=t=>t.playStatus,{setPlayStatus:Mt}=BR.actions,sH=BR.reducer;function ei({variant:t}){const e=ln(),{currentQueueId:n,queueSongs:r,currentSongData:s}=se($e),i=m.useMemo(()=>{switch(t){default:return"queue_id"}},[]);return{handleSetSong:(l,c)=>{if(n!==l){e(cs(l)),e(Mt({playStatus:"loading"}));const u=r.map(f=>f[i]);if(!r.length||r.length!==c.length||!!c.find(f=>!u.includes(f[i])))return console.log("set queue"),e(C6({songs:c})),!0}return!1},currentSongData:s,queueSongs:r,currentQueueId:n}}function zR(t,e){const[n,r]=m.useState(t);return m.useEffect(()=>{if(!t){r("");return}const s=setTimeout(()=>{r(t)},e);return()=>{clearTimeout(s)}},[t]),n}const _w={isDev:!1,focusDelay:3e3,scrollSongDelay:4e3,loadingDuration:200};function aE(t,e){const n=m.useRef(),[r,s]=m.useState(0),[i,a]=m.useState(0);return m.useEffect(()=>{r&&(n.current=setTimeout(()=>n.current=void 0,e))},[i,_w]),m.useEffect(()=>{n.current||(t(),a(Math.random()*10))},[r]),()=>s(Math.random()*10)}const gg={currentPlaylist:null,playlistSongs:[]},UR=cv({name:"currentPlaylist",initialState:gg,reducers:{setCurrentPlaylist(t,e){const{playlist:n,songs:r}=e.payload;t.currentPlaylist=n,t.playlistSongs=r},updateCurrentPlaylist:(t,e)=>{if(!t.currentPlaylist)return t;Object.assign(t.currentPlaylist,e.payload)},addSongsToPlaylist(t,e){if(!t.currentPlaylist)return t;const n=e.payload.map(r=>({...r,song_in:`playlist_${t.currentPlaylist.id}`,queue_id:Uu(4)}));t.playlistSongs.push(...n)},setPlaylistSong(t,e){t.playlistSongs=e.payload},removeSong(t,e){const{index:n}=e.payload;t.playlistSongs.splice(n,1)},resetCurrentPlaylist:t=>{t.currentPlaylist=gg.currentPlaylist,t.playlistSongs=gg.playlistSongs}}}),Zi=t=>t.currentPlaylist,{addSongsToPlaylist:tJ,removeSong:nJ,setCurrentPlaylist:iH,updateCurrentPlaylist:aH,resetCurrentPlaylist:oH,setPlaylistSong:rJ}=UR.actions,lH=UR.reducer;function cH(){const t=ln(),{setErrorToast:e}=ge(),{user:n,loading:r}=he(),s=qi(),[i,a]=m.useState(!0),l=async()=>{if(!s.id)return;const d=await Ur({collectionName:"Playlists",id:s.id,msg:">>> api get playlist"});if(d.exists())return{...d.data(),id:d.id}},c=async d=>{if(!d.song_ids.length)return[];const f=_e(Nn,X(Zs(),"in",d.song_ids)),p=await Yi(f);return p.docs.length?p.docs.map(v=>({id:v.id,...v.data(),queue_id:`${Uu(4)}_${d.id}}`})):[]},u=async()=>{try{if(!s.id)return;a(!0);const d=await l();if(!d||!(n?d.owner_email===n.email&&!d.is_official:!1)&&!d.is_public)return;const p=await c(d);t(iH({playlist:d,songs:p}))}catch(d){console.log({message:d}),e()}finally{a(!1)}};return m.useEffect(()=>{if(!r)return u(),()=>{t(oH())}},[r]),{isFetching:i}}function VR({active:t}){const{audioRef:e}=et();if(!e.current)throw new Error("useSongLyric !audioRef.current");const{playStatus:n}=se(Ln),{currentSongData:r}=se($e),{setLoading:s,setSongLyrics:i,songLyrics:a,loading:l,ranGetLyric:c}=oD(),u=m.useRef(),d=async()=>{try{if(!r||!r.song.lyric_id)return s(!1);s(!0);const p=await Ur({collectionName:"Lyrics",id:r.song.lyric_id});if(p.exists()){const g=p.data();typeof g.lyrics=="string"?i(JSON.parse(g.lyrics||"[]")):i(g.lyrics)}}catch(p){console.log({message:p})}finally{s(!1)}},f=()=>{clearTimeout(u.current),s(!0),i([]),c.current=!1};return m.useEffect(()=>{a.length||t&&(c.current||(c.current=!0,u.current=setTimeout(()=>{d()},500)))},[t]),m.useEffect(()=>{if(n==="error"){s(!1);return}return()=>{f()}},[r,n==="error"]),{songLyrics:a,loading:l,playStatus:n}}function HR(){const t=ln(),{setSuccessToast:e}=ge();return{action:r=>{switch(r.variant){case"add":t(pm({songs:r.songs})),e("Song added to queue");break;case"remove":t(I6({index:r.index}))}}}}function WR(){const{setPlaylists:t}=Fn(),{setErrorToast:e,setSuccessToast:n}=ge(),[r,s]=m.useState(!1);return{isFetching:r,handleAddPlaylist:async(a,l,c)=>{try{if(s(!0),l){const g=await Ji({imageFile:l});Object.assign(a,g)}const u=await Qs({collectionName:"Playlists",data:a}),d=await $a(u),f={...d.data(),id:d.id},{push:p=!0}=c||{};return p&&t(g=>[f,...g]),n("Playlist created"),f}catch(u){console.log(u),e()}finally{s(!1)}}}}function uH(){const{playlists:t,setPlaylists:e}=Fn(),{setErrorToast:n,setSuccessToast:r}=ge(),[s,i]=m.useState(!1);return{isFetching:s,addToPlaylist:async({song:l,playlist:c})=>{try{i(!0);const u={song_ids:[l.id,...c.song_ids]},d={...c,...u};await kt({collectionName:"Playlists",id:c.id,data:u});const f=[...t],p=f.findIndex(g=>g.id===c.id);p!==-1&&(f[p]=d,e(f)),r("Song added")}catch(u){console.log({message:u}),n()}finally{i(!1)}}}}const yx=t=>({name:"",image_url:"",song_url:"",beat_url:"",beat_file_path:"",duration:0,like:0,lyric_id:"",image_file_path:"",song_file_path:"",blurhash_encode:"",singer_map:{},genre_map:{},genres:[],singers:[],is_official:!1,size:0,created_at:Gs(),updated_at:Gs(),...t}),vx=t=>({name:"",song_ids:[],image_url:"",singers:[],singer_map:{},genre_map:{},genres:[],is_album:!1,like:0,blurhash_encode:"",is_public:!0,is_official:!1,image_file_path:"",created_at:Gs(),updated_at:Gs(),...t}),oE=({owner_email:t,distributor:e,...n})=>vx({owner_email:t,is_album:!0,is_official:!0,is_public:!0,distributor:e,...n}),wf=t=>({name:"",description:"",image_file_path:"",image_url:"",like:0,created_at:Gs(),blurhash_encode:"",...t}),lE=({start:t,end:e,text:n})=>{const r=n.trim().split(" "),s=r.map(()=>[]),i=r.map(()=>0);return{start:t,end:e,tune:{start:t,end:e,grow:i},cut:s,text:n}},cE=({user:t,target_id:e,...n})=>({target_id:e,text:"",like:0,reply:0,comment_id:"",user_email:t.email,user_image_url:t.photo_url,user_name:t.display_name,created_at:Gs(),updated_at:Gs(),...n});function qR(t){const[e,n]=m.useState(),[r,s]=m.useState(),i=m.useRef(null),a=f=>{e&&n({...e,...f})},l=m.useMemo(()=>t.variant==="add"?!0:!t.playlist||!e?!1:e.name!==t.playlist.name||e.like!==t.playlist.like||e.is_public!==t.playlist.is_public,[e]),c=!!r,u=m.useMemo(()=>{const f=!!(e!=null&&e.name)&&l;return t.variant==="add"?f:f||c},[c,l,e]),d=()=>{switch(t.variant){case"add":return vx({distributor:t.user.display_name,owner_email:t.user.email});case"edit":const{id:f,updated_at:p,...g}=t.playlist;return vx(g)}};return m.useEffect(()=>{var f;t.variant==="add"&&((f=i.current)==null||f.focus()),n(d())},[]),m.useEffect(()=>{r&&a({image_url:URL.createObjectURL(r)})},[r]),{playlistData:e,imageFile:r,setImageFile:s,updatePlaylistData:a,setPlaylistData:n,inputRef:i,isValidToSubmit:u,isChanged:l,isChangeImage:c}}function bl({close:t,isLoading:e,submit:n,...r}){const{theme:s}=q(),{imageFile:i,setImageFile:a,playlistData:l,updatePlaylistData:c,isChanged:u,isChangeImage:d,inputRef:f,isValidToSubmit:p}=qR(r),g=async()=>{l&&(!u&&!d||n(l,i))},v=_=>{var b;(b=_.target.files)!=null&&b.length&&a(_.target.files[0])};if(l)return o.jsxs(o.Fragment,{children:[o.jsx(Ct,{close:t,title:r.variant==="add"?"Add playlist":"Edit playlist"}),o.jsxs("div",{className:"md:flex md:space-x-3",children:[o.jsxs("div",{className:"space-y-2.5",children:[o.jsx("div",{className:"w-[200px] h-[200px] rounded-lg overflow-hidden",children:o.jsx(Xe,{className:"object-cover object-center h-full",blurHashEncode:l.blurhash_encode,src:l.image_url})}),o.jsx("input",{ref:f,onChange:v,type:"file",multiple:!0,accept:"image/png, image/jpeg",id:"image_upload",className:"hidden"}),o.jsx("div",{className:"space-x-2 flex",children:o.jsx(oe,{className:`${s.content_bg}`,size:"clear",children:o.jsx("label",{htmlFor:"image_upload",className:"px-5 py-1 cursor-pointer ",children:o.jsx(hl,{className:"w-5"})})})})]}),o.jsxs("div",{className:"mt-3 md:mt-0 flex-grow flex flex-col space-y-2.5",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"name",children:"Name"}),o.jsx(Ht,{id:"name",ref:f,type:"text",placeholder:"name...",value:l.name,onChange:_=>c({name:_.target.value})})]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{children:"Public"}),o.jsx(uh,{inActiveBg:"bg-black/10",active:l.is_public,cb:()=>c({is_public:!l.is_public})})]})]})]}),o.jsx("p",{className:"text-right mt-5 md:mt-0",children:o.jsx(oe,{isLoading:e,color:"primary",onClick:g,disabled:!p,className:"font-playwriteCU rounded-full",children:"Save"})})]})}function Om(){const t=ln(),{user:e,updateUserData:n}=he(),{setPlaylists:r,playlists:s}=Fn(),[i,a]=m.useState(!1),{setSuccessToast:l,setErrorToast:c}=ge(),u=qt();return{isFetching:i,action:async f=>{try{if(!e)throw new Error("user not found");a(!0);const p=zu(Pe),g=Ut(Pe,"Users",e.email),v=Ut(Pe,"Playlists",f.playlist.id);switch(f.variant){case"like":{if(!e)throw Error();const _=[...e.liked_playlist_ids],b=_.findIndex(I=>I===f.playlist.id),E=b===-1;E?_.unshift(f.playlist.id):_.splice(b,1);const w={liked_playlist_ids:_},S={like:cu(E?1:-1)};p.update(g,w),p.update(v,S),await p.commit(),r(E?I=>[f.playlist,...I]:I=>I.filter(F=>F.id!==f.playlist.id)),n(w);break}case"edit":{const{data:_,playlist:b,imageFile:E}=f,w={...b,..._};if(E){const C=await Ji({imageFile:E});b.image_file_path&&await An({filePath:b.image_file_path}),Object.assign(w,C)}await kt({collectionName:"Playlists",data:w,id:b.id,msg:">>> api: update playlist doc"});const S=[...s],I=S.findIndex(C=>C.id===b.id);I!==-1&&(S[I]=w,r(S));const{updated_at:F,...D}=w;t(aH(D)),l("Playlist edited");break}case"delete":{const{playlist:_}=f;_.image_file_path&&await An({filePath:_.image_file_path});const b={liked_playlist_ids:e.liked_playlist_ids.filter(w=>w!==_.id)};p.delete(v),p.update(g,b),await Promise.all([p.commit(),_.image_file_path?An({filePath:_.image_file_path}):()=>{}]);const E=s.filter(w=>w.id!==_.id);r(E),n(b),u("/my-music");break}}}catch(p){console.log({message:p}),c()}finally{a(!1)}},user:e}}function bw(){const{user:t}=he(),{setErrorToast:e}=ge(),{handleAddPlaylist:n,isFetching:r}=WR(),{action:s,isFetching:i}=Om();return{isFetching:r||i,myMusicAddPlaylist:async(c,u)=>{try{if(!t)return;const d=await n(c,u,{push:!1});d&&await s({variant:"like",playlist:d})}catch(d){console.log({error:d}),e()}}}}function Sw({song:t,closeModal:e}){const{user:n}=he(),{playlists:r}=Fn(),{theme:s}=q(),{addToPlaylist:i,isFetching:a}=uH(),{myMusicAddPlaylist:l,isFetching:c}=bw(),u=m.useRef(null),d=n?r.filter(g=>g.owner_email===n.email&&!g.is_official):[],f=async g=>{await i({playlist:g,song:t}),e()},p=async(g,v)=>{var _;g.song_ids=[t.id],await l(g,v),(_=u.current)==null||_.close(),e()};if(n)return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"w-[300px] max-h-[80vh] max-w-[calc(90vw-40px)] flex flex-col ",children:[o.jsx(Ct,{close:e,title:"Playlists"}),o.jsx("div",{className:`flex-grow flex flex-col overflow-auto space-y-2 ${a?"disable":""}`,children:d.length?d.map((g,v)=>{const _=g.song_ids.includes(t.id);return o.jsxs("button",{disabled:_,onClick:()=>f(g),className:`flex rounded-md p-2 ${s.content_hover_bg} bg-white/10`,children:[o.jsx(Ka,{className:"w-5 mr-2"}),o.jsx("span",{children:g.name})]},v)}):o.jsx(Ke,{variant:"less"})}),o.jsxs(oe,{className:`${s.content_bg} mt-5 rounded-full justify-center`,onClick:()=>{var g;return(g=u.current)==null?void 0:g.open()},children:[o.jsx(br,{className:"w-5"}),o.jsx("span",{children:"Add new playlist"})]})]}),o.jsx(Fe,{variant:"animation",ref:u,children:o.jsx(bl,{close:()=>{var g;return(g=u.current)==null?void 0:g.close()},submit:p,isLoading:a||c,variant:"add",user:n})})]})}function Ew({modalRef:t,song:e}){const{user:n}=he();return n?o.jsx(Fe,{variant:"animation",ref:t,children:o.jsx(Sw,{closeModal:()=>{var r;return(r=t.current)==null?void 0:r.close()},song:e})}):o.jsx(o.Fragment,{})}function kw({modalRef:t}){const{user:e}=he(),{close:n}=Sr(),r=()=>{var s;(s=t.current)==null||s.open(),n()};return e?o.jsxs("button",{onClick:r,children:[o.jsx(ps,{className:"w-5"}),o.jsx("span",{children:"Add to playlist"})]}):o.jsx(o.Fragment,{})}function dH({song:t,index:e}){const{action:n}=HR(),{close:r}=Sr(),s=m.useRef(null),i=()=>{n({variant:"remove",index:e}),r()};return o.jsxs(o.Fragment,{children:[o.jsxs($m,{song:t,children:[!1,o.jsxs("button",{onClick:i,children:[o.jsx(Ky,{className:"w-5"}),o.jsx("span",{children:"Remove"})]}),o.jsx(kw,{modalRef:s}),o.jsxs("a",{target:"_blank",href:t.song_url,children:[o.jsx(am,{className:"w-5"}),o.jsx("span",{children:"Download"})]})]}),o.jsx(Ew,{song:t,modalRef:s})]})}function hH({song:t,modalRef:e}){const{user:n}=he(),{updateSong:r}=Fn(),[s,i]=m.useState({name:t.name,singer:t.singers[0].name,image_url:t.image_url}),[a,l]=m.useState(!1),[c,u]=m.useState(),{setErrorToast:d,setSuccessToast:f}=ge(),p=m.useMemo(()=>t.name!==s.name||t.singers[0].name!==s.singer,[s]),g=!!s.name&&!!s.singer&&p||c;return{isFetching:a,isChanged:p,songData:s,isValidToSubmit:g,handleSubmit:async()=>{var b,E;try{if(!n||!g)return;l(!0),(b=e.current)==null||b.setModalPersist(!0);const{id:w,...S}=t;if(p){if(!s.name||!s.singer)return;S.name=s.name,S.singers=[{...S.singers[0],name:s.singer}]}if(c){const I=await Ji({imageFile:c});Object.assign(S,I),t.image_file_path&&await An({filePath:t.image_file_path})}await kt({collectionName:"Songs",data:S,id:t.id}),r({id:t.id,song:S}),f("Song edited"),(E=e.current)==null||E.close()}catch(w){console.log({message:w}),d()}finally{l(!1)}},imageFile:c,setImageFile:u,handleInput:(b,E)=>{i({...s,[b]:E})}}}function fH({song:t,modalRef:e}){const{theme:n}=q(),r=m.useRef(null),{isValidToSubmit:s,songData:i,setImageFile:a,isFetching:l,handleSubmit:c,handleInput:u}=hH({song:t,modalRef:e}),d=p=>{const g=p.target.files;g!=null&&g.length&&(a(g[0]),u("image_url",URL.createObjectURL(g[0])))},f=p=>{var g;p.stopPropagation(),(g=e.current)==null||g.close()};return o.jsxs("div",{className:`${qc(l)} w-[500px] max-h-[80vh] max-w-[90vw] text-white flex flex-col`,children:[o.jsx("input",{ref:r,id:"image-input",type:"file",accept:"image/*",onChange:d,className:"hidden"}),o.jsx(Ct,{title:"Edit song",close:()=>{var p;return(p=e.current)==null?void 0:p.close()}}),o.jsxs("div",{className:"flex flex-col flex-grow overflow-auto md:overflow-hidden md:flex-row mt-5",children:[o.jsxs("div",{className:"space-y-2.5",children:[o.jsx("div",{className:"w-[200px] rounded-md overflow-hidden h-[200px] md:w-[160px] md:h-[160px] object-cover",children:o.jsx(Xe,{className:"object-cover h-full",src:i.image_url})}),o.jsx("label",{htmlFor:"image-input",className:`inline-block cursor-pointer hover:brightness-90 px-[20px] py-[5px] ${n.content_bg} rounded-full text-[14px]`,children:o.jsx(hl,{className:"w-5"})})]}),o.jsxs("div",{className:"pt-5 md:pt-0 md:pl-5 md:flex-grow space-y-3",children:[o.jsxs("div",{className:"space-y-1.5",children:[o.jsx("label",{htmlFor:"name",className:"",children:"Name"}),o.jsx(Ht,{value:i.name,type:"text",id:"name",onChange:p=>u("name",p.target.value),placeholder:t.name})]}),o.jsxs("div",{className:"space-y-1.5",children:[o.jsx("label",{htmlFor:"singer",className:"",children:"Singer"}),o.jsx(Ht,{value:i.singer,onChange:p=>u("singer",p.target.value),type:"text",id:"singer",placeholder:t.singers[0].name})]})]})]}),o.jsxs("div",{className:"flex mt-5 space-x-2 justify-end",children:[o.jsx(oe,{onClick:f,className:"rounded-full",children:"Close"}),o.jsx(oe,{isLoading:l,onClick:c,disabled:!s,className:`${n.content_bg} rounded-full`,variant:"primary",children:"Save"})]})]})}function Tw(){const{user:t,updateUserData:e}=he(),{setErrorToast:n,setSuccessToast:r}=ge(),{uploadedSongs:s,setUploadedSongs:i,shouldFetchFavoriteSongs:a}=Fn(),[l,c]=m.useState(!1);return{loading:l,action:async d=>{try{if(c(!0),!t)throw new Error("User not found");const f=zu(Pe),p=Ut(Pe,"Users",t.email),g=Ut(Pe,"Songs",d.song.id);switch(d.variant){case"delete":{const v=s.filter(b=>b.id!==d.song.id),_={liked_song_ids:t.liked_song_ids.filter(b=>b!==d.song.id)};if(f.update(p,_),f.delete(g),d.song.lyric_id){const b=Ut(Pe,"Lyrics",d.song.lyric_id);f.delete(b)}await Promise.all([f.commit(),LR(d.song)]),i(v),r(`'${d.song.name}' deleted`);break}case"like":{if(!t)return;const v=[...t.liked_song_ids],_=v.findIndex(S=>S===d.song.id),b=_===-1;b?v.unshift(d.song.id):v.splice(_,1);const E={liked_song_ids:v},w={like:cu(b?1:-1)};f.update(p,E),f.update(g,w),await f.commit(),e(E),a.current=!0;break}}}catch(f){console.log({message:f}),n()}finally{c(!1)}}}}function Iw({song:t}){const{close:e}=Sr(),{action:n}=HR(),r=()=>{n({variant:"add",songs:[t]}),e()};return o.jsxs("button",{onClick:r,children:[o.jsx(br,{className:"w-5"}),o.jsx("span",{children:"Add to queue"})]})}function mH({song:t}){const{close:e}=Sr(),[n,r]=m.useState(""),s=m.useRef(null),i=m.useRef(null),{action:a,loading:l}=Tw(),c=p=>{var g;r(p),(g=s.current)==null||g.open(),e()},u=()=>{var p;(p=s.current)==null||p.close()},d=async()=>{await a({variant:"delete",song:t}),u()},f=()=>{switch(n){case"":return o.jsx(o.Fragment,{});case"delete":return o.jsx(gs,{callback:d,loading:l,close:u,label:`Delete ' ${t.name} ' ?`});case"edit":return o.jsx(fH,{modalRef:s,song:t});case"add-to-playlist":return o.jsx(Sw,{closeModal:u,song:t})}};return o.jsxs(o.Fragment,{children:[o.jsxs($m,{song:t,children:[!1,o.jsx(Iw,{song:t}),o.jsx(kw,{modalRef:i}),o.jsxs("button",{onClick:()=>c("edit"),children:[o.jsx(_u,{className:"w-5"}),o.jsx("span",{children:"Edit"})]}),o.jsxs(we,{to:`lyric/${t.id}`,children:[o.jsx(qy,{className:"w-5"}),o.jsx("span",{children:t.lyric_id?"Edit lyric":"Add lyric"})]}),o.jsxs("button",{onClick:()=>c("delete"),children:[o.jsx(Dn,{className:"w-5"}),o.jsx("span",{children:"Delete"})]}),o.jsxs("a",{target:"_blank",href:t.song_url,children:[o.jsx(am,{className:"w-5"}),o.jsx("span",{children:"Download"})]})]}),o.jsx(Fe,{variant:"animation",ref:s,children:f()}),o.jsx(Ew,{song:t,modalRef:i})]})}function pH({song:t}){const e=m.useRef(null);return o.jsxs(o.Fragment,{children:[o.jsxs($m,{song:t,children:[!1,o.jsx(Iw,{song:t}),o.jsx(kw,{modalRef:e}),o.jsxs("a",{target:"_blank",href:t.song_url,children:[o.jsx(am,{className:"w-5"}),o.jsx("span",{children:"Download"})]})]}),o.jsx(Ew,{song:t,modalRef:e})]})}function gH({song:t}){const{isFetching:e}=Om();return o.jsx(o.Fragment,{children:o.jsxs($m,{song:t,children:[!1,o.jsx(Iw,{song:t}),o.jsx("button",{children:e?o.jsx(at,{className:"w-5 animate-spin"}):o.jsxs(o.Fragment,{children:[o.jsx(Ky,{className:"w-5"}),o.jsx("span",{children:"Remove"})]})}),o.jsxs("a",{target:"_blank",href:t.song_url,children:[o.jsx(am,{className:"w-5"}),o.jsx("span",{children:"Download"})]})]})})}function xH({song:t}){return o.jsx("div",{className:"px-2 mb-3",children:o.jsxs("div",{className:"p-3 bg-[#fff]/5 rounded-md flex",children:[o.jsx("div",{className:"w-[50px] h-[50px] rounded overflow-hidden flex-shrink-0",children:o.jsx(Xe,{src:t.image_url,className:"object-cover object-center w-full"})}),o.jsxs("div",{className:"ml-1 text-sm",children:[o.jsx("h5",{className:"line-clamp-1 font-[500]",children:t.name}),o.jsx("p",{className:"opacity-70 line-clamp-1",children:t.singers.map((e,n)=>e.name+(n?", ":""))})]})]})})}function $m({children:t,song:e}){const{theme:n}=q();return o.jsx(xr,{appendTo:"portal",className:"w-[240px]",children:o.jsxs(Js,{className:"py-2",p:"clear",theme:n,children:[o.jsx(xH,{song:e}),o.jsx(_l,{children:t}),o.jsxs("p",{className:"text-xs text-center opacity-70 mt-3",children:["By ",e.distributor]})]})})}function uE({song:t,index:e,variant:n}){const{theme:r}=q(),[s,i]=m.useState(!1),a=()=>{switch(n){case"queue-song":return o.jsx(dH,{song:t,index:e});case"own-song":return o.jsx(mH,{song:t});case"own-playlist":return o.jsx(gH,{song:t});default:return o.jsx(pH,{song:t})}},l=()=>{switch(n){case"queue-song":case"recent-song":return o.jsx(o.Fragment,{});default:return o.jsx("span",{className:`text-sm font-[500] hidden p-2 group-hover/main:hidden ${s?"hidden":"md:block"}`,children:Bs(t.duration)})}},c={button:`hover:bg-${r.alpha} p-2 rounded-full`},u=()=>s?`${r.content_bg}`:"block md:hidden";return o.jsx(o.Fragment,{children:o.jsxs(pr,{appendOnPortal:!0,children:[o.jsx(gr,{setIsOpenParent:i,children:o.jsx(ls,{isWrapped:!0,content:"Menu",children:o.jsx("button",{type:"button",className:`block group-hover/main:block ${c.button} ${u()}`,children:o.jsx(ul,{className:"w-5"})})})}),l(),a()]})})}function yH({isLiked:t,song:e,isSongActive:n,songVariant:r,className:s="p-1.5"}){const{theme:i}=q(),{action:a,loading:l}=Tw(),c=()=>{switch(r){case"queue-song":case"recent-song":return"mr-1";default:return""}},u=()=>{if(t)switch(r){case"queue-song":case"recent-song":return"";default:return"!block"}return""},d=()=>{switch(r){case"queue-song":case"recent-song":return n?"text-white":i.content_text;default:return i.content_text}},f={button:`hover:bg-${i.alpha} rounded-full`};return o.jsx("button",{onClick:()=>a({variant:"like",song:e}),className:`${f.button} ${c()} group-hover/main:block md:hidden ${s} ${u()}`,children:l?o.jsx(at,{className:"w-5 animate-spin"}):o.jsx(o.Fragment,{children:t?o.jsx(Su,{className:`w-5 ${d()}`}):o.jsx(dl,{className:"w-5"})})})}function vH({onClick:t,isChecked:e,isSelected:n}){return o.jsxs(o.Fragment,{children:[o.jsx("button",{onClick:t,className:`mr-2 md:mr-3 group-hover/main:block ${e?"block":"md:hidden "}`,children:n?o.jsx(Yy,{className:"w-[18px]"}):o.jsx(kI,{className:"w-[18px]"})}),o.jsx("button",{className:`mr-3 hidden group-hover/main:hidden group-hover/main:mr-[0px] md:block ${im(e,"md:hidden")}`,children:o.jsx(Ka,{className:"w-[18px]"})})]})}function wH({song:t,onClick:e,isHasCheckBox:n,active:r=!0,isLiked:s,index:i,className:a="",imageUrl:l,...c}){const{theme:u,isOnMobile:d}=q(),{isChecked:f,selectedSongs:p,selectSong:g}=vu(),v=m.useMemo(()=>p?p.indexOf(t)!=-1:!1,[p]),_=()=>{f!==void 0&&g(t)},b={button:`${u.content_hover_bg} p-[8px] rounded-full`,checkboxButton:"mr-3 text-[inherit]",itemContainer:`w-full sm:group/container flex flex-row rounded justify-between p-[10px] border-b border-${u.alpha} last:border-none`,imageFrame:" relative rounded-[4px] overflow-hidden flex-shrink-0",overlay:"absolute flex items-center justify-center inset-0 bg-black/40",ctaWrapper:"flex items-center justify-end flex-shrink-0"},E=m.useMemo(()=>{switch(c.variant){default:return o.jsxs("div",{className:` ${b.overlay} 
               ${r?"":"hidden sm:group-hover/main:flex"}`,children:[o.jsx("img",{src:rv,alt:"",className:`"h-[18px] w-[18px] ${Gc(!r)}`}),o.jsx("button",{onClick:e,className:`${Gc(r)} `,children:o.jsx(ZV,{className:"w-[24px] text-white"})})]})}},[r,e]),w=()=>{switch(c.variant){case"queue-song":case"recent-song":return"text-sm";default:return""}},S=()=>{switch(c.variant){case"queue-song":case"recent-song":return"w-10 h-10";default:return"h-[54px] w-[54px]"}},I=()=>{switch(c.variant){case"queue-song":case"recent-song":return"text-xs";default:return"text-sm"}},F=N=>{if(!d)return;const P=N.target;console.log(P.tagName),P.tagName!=="A"&&e()},D=o.jsxs(o.Fragment,{children:[n&&o.jsx(vH,{isChecked:f,isSelected:v,onClick:_}),o.jsxs("div",{className:"flex-grow flex",onClick:F,children:[o.jsxs("div",{className:`${b.imageFrame} ${S()}`,children:[o.jsx(Xe,{src:l||t.image_url,blurHashEncode:t.blurhash_encode}),E]}),o.jsxs("div",{className:"ml-[10px]",children:[o.jsxs("h5",{className:`line-clamp-1 font-medium overflow-hidden ${w()}`,children:[t.name,!1]}),o.jsx("div",{className:`opacity-[.7] line-clamp-1 ${I()}`,children:t.singers.map((N,P)=>N.id?o.jsx(we,{to:`/singer/${N.id}`,className:`${u.content_hover_text}  hover:underline`,children:(P?", ":"")+N.name},P):o.jsxs("span",{children:[" ",(P?", ":"")+N.name]},P))})]})]})]}),C=()=>{switch(c.variant){case"queue-song":case"recent-song":return D;default:return o.jsx("div",{className:"flex flex-grow overflow-hidden",children:D})}},k=()=>{switch(c.variant){case"queue-song":case"recent-song":return o.jsx(uE,{variant:c.variant,song:t,index:i});default:return o.jsx("div",{className:"flex justify-center md:w-[60px]",children:o.jsx(uE,{variant:c.variant,song:t,index:i})})}},R=o.jsxs("div",{className:"flex items-center",children:[s!=null&&o.jsx(yH,{className:"p-2",isSongActive:r,songVariant:c.variant,isLiked:s,song:t}),k()]});return(()=>{switch(c.variant){case"queue-song":case"recent-song":return o.jsxs("div",{className:`${b.itemContainer} group/main ${r?`${u.content_bg} text-white`:`hover:bg-${u.alpha}`}`,children:[C(),R]});default:return o.jsxs("div",{className:`${b.itemContainer} ${a} group/main ${r||v?`bg-${u.alpha}`:`hover:bg-${u.alpha}`}`,children:[C(),R]})}})()}function ti({songs:t,setSong:e,getActive:n,songVariant:r,imageUrl:s,isHasCheckBox:i=!0}){const{user:a}=he(),{currentSongData:l}=se($e);return t.length?t.map((c,u)=>{const d=a?c.owner_email===a.email&&c.is_official===!1:!1;return o.jsx(wH,{active:l?n?n(c,l.song):c.id===l.song.id:!1,onClick:()=>e(c),variant:r||(d?"own-song":"system-song"),isHasCheckBox:i,isLiked:a?a.liked_song_ids.includes(c.id):null,song:c,imageUrl:s,index:u},c.queue_id)}):o.jsx(Ke,{variant:"less"})}function _H(){const t=ln(),{setSuccessToast:e}=ge(),{selectedSongs:n,resetSelect:r}=vu(),s=()=>{t(pm({songs:n})),e("songs added to queue"),r()};return o.jsxs("button",{onClick:s,children:[o.jsx(br,{className:"w-5"}),o.jsx("span",{className:"",children:"Add to queue"})]})}function bH({modalRef:t}){const{user:e}=he(),{selectedSongs:n}=vu(),{myMusicAddPlaylist:r,isFetching:s}=bw(),i=async(a,l)=>{var c;a.song_ids=n.map(u=>u.id),await r(a,l),(c=t.current)==null||c.close()};return e?o.jsx(Fe,{variant:"animation",ref:t,children:o.jsx(bl,{close:()=>{var a;return(a=t.current)==null?void 0:a.close()},submit:i,isLoading:s,variant:"add",user:e})}):o.jsx(o.Fragment,{})}function SH({modalRef:t}){const{user:e}=he(),{close:n}=Sr(),r=()=>{var s;(s=t.current)==null||s.open(),n()};return e?o.jsxs("button",{onClick:r,children:[o.jsx(ps,{className:"w-5"}),o.jsx("span",{children:"Add to playlist"})]}):o.jsx(o.Fragment,{})}function EH(){const t=m.useRef(null);return o.jsxs(o.Fragment,{children:[o.jsx(kH,{children:o.jsx(SH,{modalRef:t})}),o.jsx(bH,{modalRef:t})]})}function kH({children:t}){const{theme:e}=q();return o.jsx(xr,{appendTo:"portal",children:o.jsx(Js,{className:"py-2",p:"clear",theme:e,children:o.jsx(_l,{children:t})})})}function TH({variant:t}){const e=()=>{switch(t){default:return o.jsx(EH,{})}};return o.jsx(o.Fragment,{children:o.jsxs(pr,{appendOnPortal:!0,children:[o.jsx(gr,{children:o.jsx("button",{className:"!p-1.5",type:"button",children:o.jsx(ul,{className:"w-5"})})}),e()]})})}function Bm({children:t,variant:e,selectAll:n}){const{theme:r}=q(),{user:s}=he(),{isSelectAll:i,isChecked:a,resetSelect:l,selectedSongs:c}=vu(),u=o.jsxs(o.Fragment,{children:[n&&o.jsx("button",{onClick:n,className:"ml-[10px]",children:i?o.jsx(bu,{className:"w-[20px]"}):o.jsx(kI,{className:"w-[20px]"})}),o.jsx("p",{className:"font-playwriteCU mr-1",children:c.length}),o.jsxs("div",{className:`flex space-x-2 items-center ${r.type==="light"?"[&>button]:bg-black/5":"[&>button]:bg-white/5"}  [&>button]:inline-flex [&>button]:space-x-1 [&>button]:py-1 [&>button]:px-2 [&>button]:rounded-full hover:[&>button]:brightness-95`,children:[o.jsx(_H,{}),s&&o.jsx(TH,{variant:e})]}),o.jsx("button",{onClick:l,className:"p-1 flex-shrink-0",children:o.jsx(Gi,{className:"w-[20px]"})})]});return o.jsx("div",{className:"flex items-center space-x-2 h-[44px] mb-3",children:a?u:t})}function Cw(){const t=ln();return se($e),{getRecommend:async n=>{try{console.log("getRecommend"),t(Ub(!0));const r=n.genres.map(l=>X(`genre_map.${l.id}`,"==",!0),lu(20)),s=X(Zs(),"!=",n.id),i=_e(Nn,...r,s),a=await Pn(i);t(pm({songs:a})),t(Ub(!1))}catch{}}}}function IH(){const{isFetching:t,songMap:e,...n}=HV(),{handleSetSong:r}=ei({variant:"songs"}),{getRecommend:s}=Cw(),i=a=>{r(a.queue_id,[a]),s(a)};return o.jsx(o.Fragment,{children:o.jsxs("div",{children:[o.jsx(be,{title:"Song"}),o.jsx("div",{className:"flex space-x-1 my-2 p-1",children:o.jsx(xs,{render:a=>a,...n})}),o.jsxs(ms,{children:[o.jsx(Bm,{variant:"system-song",children:o.jsx("p",{className:"font-[500] opacity-[.5]",children:"Songs"})}),t&&fl,!t&&o.jsx(ti,{songs:e[n.tab].songs,setSong:a=>i(a)})]})]})})}function CH(){const{user:t}=he(),[e,n]=m.useState([]),[r,s]=m.useState(!0);return{isFetching:r,recentPlaylists:e,getRecentPlaylist:async()=>{try{if(t){if(t.recent_song_ids.length){const a=_e(wr,X(Zs(),"in",t.recent_song_ids)),l=await Vr(a);n(l)}}else{const a=rn()["recent-playlists"]||[];n(a)}}catch(a){console.log({message:a})}finally{s(!1)}}}}function jH(){const{currentSongData:t}=se($e),e=m.useRef(!1),{isFetching:n,getRecentPlaylist:r,recentPlaylists:s}=CH();m.useEffect(()=>{e.current||(e.current=!0,r())},[]);const i={playlistItem:"w-1/4 p-[8px] max-[800px]:w-1/2"},a=()=>s.map((l,c)=>{const u=t==null?void 0:t.song.queue_id.includes(l.id);return o.jsx("div",{className:i.playlistItem,children:o.jsx(sv,{active:u,data:l})},c)});return n?o.jsx("div",{className:"flex flex-row flex-wrap -mx-[8px] ",children:tv}):s.length?o.jsx(o.Fragment,{children:o.jsxs("div",{children:[o.jsx(be,{title:"Recent listening"}),o.jsx("div",{className:"flex flex-row flex-wrap -mx-[8px] ",children:a()})]})}):o.jsx(o.Fragment,{})}function zm(){const{user:t}=he(),[e,n]=m.useState(!1);return{isFetching:e,action:async s=>{try{switch(n(!0),s){case"login":{await pB(za,jV);break}case"logout":{await FC(za);break}}n(!1)}catch(i){throw i}finally{n(!1)}},user:t}}function RH(){const{theme:t}=q(),{loading:e,user:n}=he(),{action:r}=zm(),s=async()=>{try{await r("login")}catch(a){console.log(a)}finally{}},i={icon:"w-7 mr-2 inline",linkItem:`py-3 border-b text-lg border-${t.alpha} last:border-none`,button:`${t.content_bg} rounded-full`};return o.jsxs("div",{className:"block md:hidden",children:[o.jsx(be,{title:"Library",className:"mb-1"}),e?[...Array(3).keys()].map(a=>o.jsx(CI,{},a)):o.jsx(o.Fragment,{children:n?o.jsxs(o.Fragment,{children:[o.jsx(Qp,{to:"/my-music",className:i.linkItem,icon:o.jsx(Ka,{className:i.icon+t.content_text}),label:"All songs",arrowIcon:o.jsx(ch,{className:"w-6"})}),o.jsx(Qp,{to:"/my-music",className:i.linkItem,icon:o.jsx(dl,{className:i.icon+t.content_text}),label:"Favorite",arrowIcon:o.jsx(ch,{className:"w-6"})}),o.jsx(Qp,{to:"/my-music",className:i.linkItem,icon:o.jsx(Vy,{className:i.icon+t.content_text}),label:"Recent",arrowIcon:o.jsx(ch,{className:"w-6"})})]}):o.jsxs(oe,{onClick:s,className:`${t.content_bg} rounded-md`,children:[o.jsx($y,{className:"w-7"}),o.jsx("span",{className:"font-playwriteCU leading-[2.2]",children:"Login"})]})})]})}function AH(){const{theme:t}=q(),{loading:e,user:n}=he(),r=m.useRef(null),{action:s}=zm(),[i,a]=m.useState(""),l=()=>{var p;return(p=r.current)==null?void 0:p.toggle()},c=p=>{var g;a(p),(g=r.current)==null||g.toggle()},u=async()=>{try{await s("logout")}catch(p){console.log("signOut error",{message:p})}finally{l()}},d=m.useMemo(()=>{switch(i){case"theme":return o.jsx(ev,{close:l});case"info":return o.jsx(Zy,{close:l});case"logout":return o.jsx(gs,{close:l,callback:u,loading:!1,label:"Log out ?"})}},[i]),f={linkItem:`py-3 text-lg w-full border-b border-${t.alpha} space-x-2 last:border-none flex items-center`,icon:"w-7"};return o.jsxs("div",{className:"md:hidden",children:[o.jsx("div",{className:"text-xl font-playwriteCU leading-[2.2] mb-3",children:"Setting"}),n&&o.jsxs("div",{className:`bg-${t.alpha} p-3 rounded-md flex mb-3`,children:[o.jsx(gx,{className:"h-[65px] w-[65px]"}),o.jsxs("div",{className:"ml-3",children:[o.jsx("p",{className:"text-lg font-[500]",children:n.display_name}),o.jsx("p",{className:"opacity-70 font-[500]",children:"Vip member "})]})]}),e?[...Array(3).keys()].map(p=>o.jsx(CI,{},p)):o.jsxs("div",{className:"",children:[o.jsxs("button",{className:f.linkItem,onClick:()=>c("theme"),children:[o.jsx(D0,{className:f.icon}),o.jsx("span",{children:"Theme"})]}),o.jsxs("button",{className:f.linkItem,onClick:()=>c("info"),children:[o.jsx(F0,{className:f.icon}),o.jsx("span",{children:"Info"})]}),(n==null?void 0:n.role)==="ADMIN"&&o.jsxs(we,{to:"/dashboard",className:f.linkItem,children:[o.jsx(Wy,{className:f.icon}),o.jsx("span",{children:"Dashboard"})]}),n&&o.jsxs("button",{className:f.linkItem,onClick:()=>c("logout"),children:[o.jsx($y,{className:f.icon}),o.jsx("span",{children:"Logout"})]})]}),o.jsx(Fe,{ref:r,variant:"animation",children:d})]})}function NH(){return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"space-y-5",children:[o.jsx(RH,{}),o.jsx(jH,{}),o.jsx(UV,{}),o.jsx(IH,{}),o.jsx(AH,{})]}),o.jsx(Yf,{})]})}function GR(){const{user:t,updateUserData:e}=he();return{updatePlaylist:async r=>{if(t){if(!t.recent_playlist_ids.find(i=>i===r.id)){const a={recent_playlist_ids:[...t.recent_playlist_ids,r.id]};await kt({collectionName:"Users",data:a,id:t.email}),e(a)}}else{const s=rn()["recent-playlists"]||[];s.find(a=>a.id===r.id)||(s.push(r),Ze("recent-playlists",s))}}}}const PH=o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"h-[30px] mb-[10px] flex items-center",children:o.jsx(le,{className:"h-[20px] w-[90px]"})}),fl]});function FH({variant:t,loading:e}){const{playlistSongs:n,currentPlaylist:r}=se(Zi),{handleSetSong:s}=ei({variant:"playlist"}),{updatePlaylist:i}=GR(),a=(r==null?void 0:r.is_album)&&!!(r!=null&&r.image_url),l=c=>{if(!r)return;s(c.queue_id,n)&&i(r)};return e?PH:o.jsx(o.Fragment,{children:o.jsxs(ms,{children:[!!n.length&&o.jsx(Bm,{variant:t==="others-playlist"?"system-song":"own-playlist",children:o.jsxs("p",{className:"font-[500] opacity-[.5]",children:[n.length," Songs"]})}),o.jsx(ti,{imageUrl:a?r.image_url:"",songs:n,setSong:c=>l(c),songVariant:t==="my-playlist"?"own-playlist":"system-song"})]})})}function ni(){const t=ln(),{playerConig:{isShuffle:e,repeat:n,isCrossFade:r},updatePlayerConfig:s,firstTimeSongLoaded:i,audioRef:a,timelineEleRef:l,currentTimeEleRef:c,isPlayingNewSong:u,themeCodeRef:d,shouldSyncSongDuration:f}=et(),{currentSongData:p,queueSongs:g}=se($e),{playStatus:v}=se(Ln),_=m.useRef(0),b=()=>{l.current&&c.current&&(c.current.innerText="0:00",l.current.style.background="rgba(255, 255, 255, 0.15)")},E=async()=>{try{if(console.log("call play"),f.current){f.current=!1;const N=rn().current_time||0;a.current.currentTime=N}await a.current.play(),u.current&&(r&&(a.current.volume=0),u.current=!1)}catch{}},w=()=>{a.current.pause()},S=()=>{v==="playing"&&w(),v==="paused"&&E()},I=j=>{const N=l.current,P=c.current,A=j||a.current.currentTime;if(a.current.duration&&N){const ee=A/(a.current.duration/100);N.style.background=vw(d.current,+ee.toFixed(1))}P&&(P.innerText=Bs(A)||"0:00")};return{toggleRepeat:()=>{let j;switch(n){case"no":j="one";break;case"one":j="all";break;case"all":j="no";break;default:j="no"}Ze("repeat",j),s({repeat:j})},toggleShuffle:()=>{const j=!e;s({isShuffle:j}),Ze("isShuffle",j)},next:()=>{if(!p)return;let j=p.index+1,N;j<g.length?N=g[j]:(j=0,N=g[0]),t(cs(N.queue_id))},previous:()=>{if(!p)return;let j=p.index-1,N;j>=0?N=g[j]:(N=g[g.length-1],j=g.length-1),t(cs(N.queue_id))},repeat:n,isShuffle:e,updateProgressElement:I,handleSeek:j=>{const N=j.target;if(l.current){const P=N.getBoundingClientRect(),ee=(j.clientX-P.left)/l.current.offsetWidth,xe=Math.round(ee*a.current.duration),Se=a.current.currentTime;if(_.current&&Math.abs(Se-_.current)<1&&Math.abs(xe-_.current)<1)return;I(xe),i.current?Ze("current_time",xe):a.current.currentTime=xe,_.current=xe}},handlePlayPause:S,play:E,pause:w,resetForNewSong:b}}function xg({onClick:t,children:e,text:n}){const{theme:r}=q(),{playlistSongs:s}=se(Zi);return o.jsxs(oe,{onClick:t,disabled:!s.length,size:"clear",className:`rounded-full px-5 py-1 ${r.content_bg}`,children:[e,o.jsx("span",{className:"font-playwriteCU leading-[2.2]",children:n})]})}function DH(){const{currentPlaylist:t,playlistSongs:e}=se(Zi),{currentSongData:n}=se($e),{playStatus:r}=se(Ln),{handlePlayPause:s}=ni(),{handleSetSong:i}=ei({variant:"playlist"}),{updatePlaylist:a}=GR(),l=()=>{if(!t)return;const c=e[0];i(c.queue_id,e)&&a(t)};if(!t)return o.jsx(o.Fragment,{});if(n!=null&&n.song.queue_id.includes(t.id))switch(r){case"playing":case"waiting":return o.jsx(xg,{text:"Pause",onClick:s,children:o.jsx(cm,{className:"w-7 mr-1"})});case"loading":case"paused":return o.jsx(xg,{text:"Continue",onClick:s,children:o.jsx(Qc,{className:"w-7 mr-1"})})}return o.jsx(xg,{text:"Play",onClick:l,children:o.jsx(Qc,{className:"w-7 mr-1"})})}function LH({isLiked:t,playlist:e,className:n="p-1.5"}){const{theme:r}=q(),{action:s,isFetching:i}=Om(),a={button:`bg-${r.alpha} hover:brightness-90 rounded-full w-[40px] flex items-center justify-center`};return o.jsx("button",{onClick:()=>s({variant:"like",playlist:e}),className:` ${a.button} ${n}`,children:i?o.jsx(at,{className:"w-5 animate-spin"}):o.jsx(o.Fragment,{children:t?o.jsx(Su,{className:`w-5 ${r.content_text}`}):o.jsx(dl,{className:"w-5"})})})}function MH(){return o.jsx(o.Fragment,{children:o.jsx(QR,{children:o.jsx(xw,{})})})}function OH(){const{currentPlaylist:t}=se(Zi),{close:e}=Sr(),[n,r]=m.useState(""),s=m.useRef(null),{action:i,isFetching:a}=Om(),l=f=>{var p;r(f),e(),(p=s.current)==null||p.open()},c=()=>{var f;return(f=s.current)==null?void 0:f.close()},u=async(f,p)=>{t&&(await i({variant:"edit",playlist:t,data:f,imageFile:p}),c())},d=()=>{if(!t)return o.jsx(o.Fragment,{});switch(n){case"":return o.jsx(o.Fragment,{});case"edit":return o.jsx(bl,{isLoading:a,playlist:t,submit:u,variant:"edit",close:c});case"delete":return o.jsx(gs,{loading:a,label:`Delete playist ' ${t.name} ' ?`,callback:()=>i({variant:"delete",playlist:t}),close:c})}};return o.jsxs(o.Fragment,{children:[o.jsxs(QR,{children:[o.jsx(xw,{}),o.jsxs("button",{onClick:()=>l("edit"),children:[o.jsx(Ys,{className:"w-5"}),o.jsx("span",{children:"Edit"})]}),o.jsxs("button",{onClick:()=>l("delete"),children:[o.jsx(Dn,{className:"w-5"}),o.jsx("span",{children:"Delete"})]})]}),o.jsx(Fe,{variant:"animation",ref:s,children:d()})]})}function QR({children:t}){return o.jsx(xr,{className:"left-[calc(100%)] bottom-full w-[120px]",animationClassName:"origin-top-left",appendTo:"parent",children:o.jsx($R,{children:o.jsx(_l,{children:t})})})}function $H({variant:t}){const{theme:e}=q(),[n,r]=m.useState(!1),s=m.useRef(null);return o.jsx(o.Fragment,{children:o.jsxs(pr,{children:[o.jsx(gr,{setIsOpenParent:r,ref:s,children:o.jsx(oe,{size:"clear",className:`rounded-full p-2.5 ${n?e.content_bg:"bg-"+e.alpha} $
            } `,children:o.jsx(_u,{className:"w-5"})})}),t==="others-playlist"?o.jsx(MH,{}):o.jsx(OH,{})]})})}function _r(t){const e=["","K","M","B"],n=Math.log10(Math.abs(t))/3|0;return n===0?t.toString():(t/Math.pow(10,n*3)).toFixed(1)+e[n]}function BH({children:t,onClose:e},n){const[r,s]=m.useState(!1),[i,a]=m.useState(!1),l=()=>{i&&a(!1),r||s(!0)},c=()=>{s(!0)},u=()=>{a(!1)},d=p=>{p.preventDefault(),p.stopPropagation(),u()};m.useImperativeHandle(n,()=>({toggle:l,close:u,open:c,setModalPersist:()=>{}})),m.useEffect(()=>{i||setTimeout(()=>{s(!1),e&&e()},400)},[i]),m.useEffect(()=>{r&&setTimeout(()=>{a(!0)},100)},[r]);const f={unMountedContent:"translate-y-full ",mountedContent:"translate-y-0",unMountedLayer:"opacity-0",mountedLayer:"opacity-20"};return o.jsx(o.Fragment,{children:r&&Ga.createPortal(o.jsxs("div",{className:"fixed inset-0 z-[99]",children:[o.jsx("div",{onClick:d,className:`transition-opacity duration-300 absolute bg-black inset-0 z-[90]
                             ${i?f.mountedLayer:f.unMountedLayer}
                        `}),o.jsx("div",{className:`modal-content absolute bottom-0 left-0 right-0 duration-300 transition-[transform,opacity] z-[99]
                            ${i?f.mountedContent:f.unMountedContent}
                        `,children:t})]}),document.getElementById("portals"))})}const wx=m.forwardRef(BH);function zH({target:t}){const[e,n]=m.useState([]),[r,s]=m.useState(!1),[i,a]=m.useState(!0),l=m.useRef(!0);return{target:t,comments:e,isOpenComment:r,setIsOpenComment:s,setComments:n,shouldFetchComment:l,isFetching:i,setIsFetching:a}}const KR=m.createContext(null);function jw({children:t,target:e}){return o.jsx(KR.Provider,{value:zH({target:e}),children:t})}function Wr(){const t=m.useContext(KR);if(!t)throw new Error("CommnetProvider not provided");return t}function XR({children:t}){return o.jsxs("div",{className:"h-[70vh] overflow-hidden text-white rounded-[16px_16px_0_0] relative p-3 flex flex-col",children:[o.jsx("div",{className:"bg-opacity-[0.8] bg-[#1f1f1f] backdrop-blur-[15px] z-[-1] absolute inset-0"}),t]})}function YR(){const{user:t,updateUserData:e}=he(),{setComments:n,comments:r}=Wr(),[s,i]=m.useState(!1);return{isFetching:s,action:async l=>{try{if(!t)return;switch(i(!0),l.type){case"add":{const c=cE({user:t,target_id:l.target_id,text:l.text}),u=await Qs({collectionName:"Comments",data:c}),d=await $a(u);if(d.exists()){const f={...d.data(),id:u.id,replies:[]};n(p=>[f,...p]),i(!1)}break}case"reply":{const{comment:c,comment_index:u,text:d}=l,f=cE({user:t,target_id:c.target_id,text:d,comment_id:c.id}),p=await Qs({collectionName:"Comments",data:f}),g=await $a(p);if(g.exists()){const v={reply:cu(1)};await kt({collectionName:"Comments",data:v,id:c.id});const _={...g.data(),id:p.id,replies:[]},b=[...r];b[u]={...b[u],replies:[...b[u].replies,_]},n(b),i(!1)}break}case"like":{const c=[...t.liked_comment_ids],u=c.findIndex(g=>g===l.id),d=u===-1;d?c.push(l.id):c.splice(u,1);const f={like:cu(d?1:-1)};await kt({collectionName:"Comments",data:f,id:l.id});const p={liked_comment_ids:c};Ze("liked_comment_ids",c),e(p);break}case"delete":{await Vu({collectionName:"Comments",id:l.id});const c=[...t.liked_comment_ids],u=c.findIndex(d=>d===d);u!==-1&&(c.splice(u,1),Ze("liked_comment_ids",c)),n(d=>d.filter(f=>f.id!==l.id));break}}}catch(c){console.log({error:c})}finally{i(!1)}}}}function JR(t){const e=t.toDate(),r=new Date().getTime()-e.getTime(),s=Math.floor(r/(1e3*60*60*24));return s?s+(s>1?" days ago":" day ago"):"Today"}function ZR({onSubmited:t,...e}){const{user:n}=he(),{target:r}=Wr(),{currentSongData:s}=se($e),{currentPlaylist:i}=se(Zi),{action:a,isFetching:l}=YR(),c=m.useRef(null),u=async()=>{if(!c.current)return;const f=c.current.value;if(!f||!f.trim()||r==="song"&&!s||r==="playlist"&&!i)return;const p=r==="song"?s==null?void 0:s.song.id:i==null?void 0:i.id;if(p){switch(e.variant){case"comment":await a({type:"add",target_id:p,text:f});break;case"reply":await a({type:"reply",text:f,comment:e.comment,comment_index:e.comment_index});break}c.current.value="",t&&t()}},d=e.variant==="comment"?"...":`Reply to ${e.comment.user_name}...`;return o.jsxs("div",{className:"flex w-full",children:[o.jsx("div",{className:"w-[40px] h-[40px] flex-shrink-0",children:o.jsx(Xe,{src:n==null?void 0:n.photo_url,className:"rounded-full"})}),o.jsxs("div",{className:"rounded-lg ml-2 flex-grow bg-[#333] flex items-center",children:[o.jsx(Ht,{className:"bg-transparent border-none",placeholder:d,ref:c}),o.jsx(oe,{onClick:u,className:"",isLoading:l,children:o.jsx(DL,{className:"w-5"})})]})]})}function Rw(){return m.useState(!0),{fetchComment:async({target_id:e,comment_id:n})=>{let r=_e(DV);e&&(r=_e(r,X("target_id","==",e),X("comment_id","==",""),hs("updated_at","desc"))),n&&(r=_e(r,X("comment_id","==",n),hs("created_at","asc")));const s=await Yi(r);if(s.docs.length)return s.docs.map(a=>({...a.data(),id:a.id,replies:[]}))}}}function UH({comment:t,commentIndex:e}){const{comments:n,setComments:r}=Wr(),[s,i]=m.useState(!1),{fetchComment:a}=Rw(),l=async()=>{try{i(!0);const c=await a({comment_id:t.id});if(c){const u=[...n];u[e]={...u[e],replies:c},r(u)}}catch(c){console.log({error:c})}finally{i(!1)}};return o.jsxs("button",{onClick:l,className:"mt-1 text-[#ccc] flex items-center space-x-1",children:[o.jsxs("span",{children:["View ",t.reply," replies"]}),s?o.jsx(at,{className:"w-5 animate-spin"}):o.jsx(LM,{className:"w-5"})]})}function eA({comment:t,index:e,level:n}){const{user:r}=he(),{action:s,isFetching:i}=YR(),[a,l]=m.useState(!1),c=m.useRef("like"),u=m.useRef(null),d=r==null?void 0:r.liked_comment_ids.includes(t.id),f=(r==null?void 0:r.email)===t.user_email,p=async()=>{var g;await s({type:"delete",id:t.id,index:e}),(g=u.current)==null||g.close()};return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:`${n==1?"py-2":"mt-2"} `,children:o.jsxs("div",{className:"flex w-full items-start space-x-1.5",children:[o.jsx("div",{className:`flex-shrink-0 ${n===1?"w-[48px] h-[48px]":"w-[40px] h-[40px]"} rounded-full overflow-hidden`,children:o.jsx(Xe,{src:t.user_image_url})}),o.jsxs("div",{className:"flex-grow text-[13px]",children:[o.jsxs("div",{className:"flex",children:[o.jsxs("div",{className:"flex-grow",children:[o.jsxs("div",{className:"p-2 rounded-md bg-[#333]",children:[o.jsx(we,{className:"text-[#ccc] line-clamp-1 font-[500]",to:`/user/${t.user_email}`,children:t.user_name}),o.jsx("div",{className:"mt-1 break-all text-white",children:t.text})]}),o.jsxs("div",{className:"flex space-x-2 mt-1",children:[o.jsx("span",{className:"text-[#ccc]",children:JR(t.created_at)}),r&&o.jsx(o.Fragment,{children:f?o.jsx("button",{onClick:()=>{var g;c.current="delete",(g=u.current)==null||g.open()},children:"Delete"}):n===1&&o.jsx("button",{onClick:()=>l(!0),children:"Reply"})})]}),!!t.reply&&n===1&&!t.replies.length&&o.jsx(UH,{comment:t,commentIndex:e})]}),o.jsxs("div",{className:"flex flex-col items-center",children:[o.jsx("button",{className:"p-1",onClick:()=>{c.current="like",s({type:"like",id:t.id})},children:i&&c.current==="like"?o.jsx(at,{className:"w-6 animate-spin"}):o.jsx(o.Fragment,{children:d?o.jsx(Su,{className:"w-6 text-red-500"}):o.jsx(dl,{className:"w-6"})})}),o.jsx("span",{children:t.like})]})]}),!!t.replies.length&&t.replies.map((g,v)=>o.jsx(eA,{comment:g,index:e,level:2},v)),a&&o.jsx("div",{className:"mt-2",children:o.jsx(ZR,{onSubmited:()=>l(!1),comment_index:e,variant:"reply",comment:t})})]})]})}),o.jsx(Fe,{variant:"animation",ref:u,children:o.jsx(gs,{label:"Delete comment",close:()=>{var g;return(g=u.current)==null?void 0:g.close},loading:i,callback:p})})]})}function tA({comments:t}){const{user:e}=he();return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"flex-grow overflow-auto no-scrollbar",children:t.length?t.map((n,r)=>o.jsx(eA,{level:1,index:r,comment:n},n.id)):o.jsx(an,{children:"..."})}),e&&o.jsx("div",{className:"pt-1.5",children:o.jsx(ZR,{variant:"comment"})})]})}function VH(){const{shouldFetchComment:t,setComments:e,isOpenComment:n,setIsFetching:r}=Wr(),{currentPlaylist:s}=se(Zi),{fetchComment:i}=Rw(),a=async()=>{try{if(!s)return;const l=await i({target_id:s.id});e(l||[])}catch(l){console.log({error:l})}finally{r(!1)}};m.useEffect(()=>{!n||!s||t.current&&(t.current=!1,a())},[n])}function dE(){const{isFetching:t,comments:e}=Wr();return VH(),t?o.jsx(an,{children:o.jsx(at,{className:"w-6 animate-spin"})}):o.jsx(tA,{comments:e})}function HH(){const{theme:t,isOnMobile:e}=q(),{setIsOpenComment:n}=Wr(),r=m.useRef(null),s=()=>{var a;(a=r.current)==null||a.open(),n(!0)},i={button:`bg-${t.alpha} hover:brightness-90 rounded-full w-[40px] flex items-center justify-center`};return o.jsxs(o.Fragment,{children:[o.jsx("button",{onClick:()=>s(),className:i.button,children:o.jsx(Uy,{className:"w-5"})}),!e&&o.jsx(Fe,{onClose:()=>n(!1),variant:"animation",ref:r,children:o.jsx("div",{className:"hidden md:flex flex-col h-[400px] max-h-[60vh] w-[500px] max-w-[85vw] ",children:o.jsx(dE,{})})}),e&&o.jsx(wx,{ref:r,onClose:()=>n(!1),children:o.jsx(XR,{children:o.jsx(dE,{})})})]})}const WH=(t,e)=>(e==null?void 0:e.type)==="date"?new Date(t.toDate()).toLocaleDateString("en-GB"):new Date(t.toDate()).toLocaleString();function qH({playlist:t,showSkeleton:e,isLiked:n,variant:r}){const{theme:s}=q(),{currentSongData:i}=se($e),a=t?i==null?void 0:i.song.queue_id.includes(`${t.id}`):!1,l={container:"flex flex-col md:flex-row lg:flex-col",smallText:"",link:`${s.content_hover_text} hover:underline`},c=()=>t?o.jsxs(o.Fragment,{children:[o.jsx(we,{className:`block hover:underline ${s.content_hover_text} ${l.smallText}`,to:`/singer/${t.singers[0].id}}`,children:t.singers[0].name}),o.jsxs("p",{className:"text-sm",children:[o.jsx("span",{className:"text-red-500",children:" "}),_r(t.like)]})]}):o.jsx(o.Fragment,{}),u=()=>{if(!t)return o.jsx(o.Fragment,{});switch(r){case"my-playlist":return o.jsx(o.Fragment,{children:o.jsx("p",{className:l.smallText,children:t.is_public?"Public":"Private"})});case"others-playlist":return o.jsxs(o.Fragment,{children:[o.jsxs("p",{children:[o.jsx("span",{className:"text-red-500 text-base",children:" "}),_r(t.like)]}),!!t.singers.length&&o.jsx("p",{className:l.smallText,children:t.singers.map((d,f)=>o.jsx(we,{className:`${l.link}`,to:`/singer/${d.id}`,children:(f?", ":"")+d.name},f))}),!t.is_official&&o.jsxs("p",{className:l.smallText,children:["Provided by"," ",o.jsx(we,{className:l.link,to:`/user/${t.owner_email}`,children:t.distributor})]}),o.jsxs("p",{className:l.smallText,children:["Last update:"," ",WH(t.updated_at,{type:"date"})]})]})}};return o.jsx(o.Fragment,{children:o.jsxs("div",{className:l.container,children:[o.jsx("div",{className:"w-full flex-shrink-0 px-10 md:w-1/3 md:px-0 lg:w-full",children:e?o.jsx(le,{className:"pt-[100%] rounded-lg"}):t&&o.jsx(sv,{data:t,active:a,variant:"image"})}),o.jsxs("div",{className:"flex flex-col items-center mt-3 md:items-start md:ml-5 md:mt-0 lg:ml-0 lg:mt-3 lg:items-center",children:[e?o.jsxs("div",{className:"space-y-1 flex flex-col items-center",children:[o.jsx(le,{className:"h-[24px] w-[170px]"}),o.jsx(le,{className:"h-[17px] w-[170px]"}),o.jsx(le,{className:"h-[17px] w-[60px]"}),o.jsx(le,{className:"h-[17px] w-[100px]"})]}):t&&o.jsxs(o.Fragment,{children:[o.jsx("p",{className:"text-xl font-[600] leading-[1.2]",children:t.name}),o.jsx("div",{className:"mt-2.5 text-[#666] text-center md:text-left lg:text-center text-[13px]",children:t.is_album?c():u()})]}),t&&o.jsxs("div",{className:"flex flex-col items-center mt-3 md:flex-row md:mt-auto lg:flex-col lg:mt-3",children:[o.jsx(DH,{}),o.jsxs("div",{className:"flex space-x-3 mt-3 md:ml-3 md:mt-0 lg:mt-3 lg:ml-0",children:[o.jsx($H,{variant:r}),r!=="my-playlist"&&n!==null&&o.jsx(LH,{isLiked:n,playlist:t}),o.jsx(jw,{target:"playlist",children:o.jsx(HH,{})})]})]})]})]})})}function nA(){const{behind:t,ahead:e,shouldStoreLocation:n,setBehind:r,setAhead:s}=oI(),i=rr(),a=qt(),l=m.useMemo(()=>i.pathname+i.search,[i]);return{ahead:e,behind:t,backward:()=>{const f=[...t],p=f.pop();p&&(n.current=!1,s(g=>[...g,l]),r(f),a(p))},forward:()=>{const f=[...e],p=f.pop();p&&(n.current=!1,r(g=>[...g,l]),s(f),a(p))},goHome:()=>{a("/")}}}function Sl({className:t=""}){const{backward:e,behind:n,goHome:r}=nA(),s=()=>{n.length?e():r()};return o.jsx(oe,{onClick:s,className:`p-1.5 md:hidden z-[9] relative ${t}`,color:"primary",size:"clear",children:n.length?o.jsx(_I,{className:"w-6"}):o.jsx(lm,{className:"w-6"})})}function GH(){const{currentPlaylist:t}=se(Zi),{user:e}=he(),n=e&&t?t.owner_email===e.email&&!t.is_official:!1,r=e?t?e.liked_playlist_ids.includes(t.id):!1:null,{isFetching:s}=cH();return!s&&!t?o.jsx(an,{children:o.jsx(Ke,{variant:"with-home-button"})}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"mb-5",children:o.jsx(Sl,{})}),o.jsxs("div",{className:"lg:flex lg:-mx-3",children:[o.jsx("div",{className:"w-full lg:w-1/4 lg:px-3",children:o.jsx(qH,{showSkeleton:s,variant:n?"my-playlist":"others-playlist",playlist:t,isLiked:r})}),o.jsx("div",{className:"w-full lg:w-3/4 lg:px-3",children:o.jsx("div",{className:"mt-[30px] lg:mt-0",children:o.jsx(FH,{loading:s,variant:n?"my-playlist":"others-playlist"})})})]}),o.jsx(Yf,{})]})}function rA({tab:t}){const{user:e}=he(),{setUploadedSongs:n,setFavoriteSongs:r,shouldFetchUserSongs:s,shouldFetchFavoriteSongs:i,favoriteSongs:a,uploadedSongs:l}=Fn(),{setErrorToast:c}=ge(),[u,d]=m.useState(!0),f=async()=>{if(e)try{switch(t){case"favorite":{if(i.current){if(i.current=!1,e.liked_song_ids.length){const p=_e(Nn,X(Zs(),"in",e.liked_song_ids)),g=await Pn(p),v=[];e.liked_song_ids.forEach(_=>{const b=g.find(E=>E.id===_);b&&v.push(b)}),r(v)}}else await zs(100);break}case"uploaded":if(s.current){s.current=!1;const p=_e(Nn,X("owner_email","==",e.email),X("is_official","==",!1)),g=await Pn(p);n(g)}else await zs(100)}}catch(p){console.log({message:p}),c()}finally{d(!1)}};return m.useEffect(()=>{f()},[]),{isFetching:u,uploadedSongs:l,favoriteSongs:a,user:e}}function QH(){const{handleSetSong:t}=ei({variant:"songs"}),{favoriteSongs:e,user:n,isFetching:r}=rA({tab:"favorite"}),s=i=>{t(i.queue_id,e)};if(n)return o.jsxs(ms,{children:[o.jsx(Bm,{variant:"favorite-song",children:r?o.jsx(le,{className:"h-[20px] w-[90px]"}):o.jsxs("p",{className:"font-[500] opacity-[.5]",children:[e.length," Songs"]})}),r&&fl,!r&&o.jsx(o.Fragment,{children:e.length?o.jsx(o.Fragment,{children:o.jsx(ti,{setSong:s,songs:e})}):o.jsx(Ke,{})})]})}function KH({song:t}){return o.jsxs("div",{className:"flex items-center justify-between p-[10px]",children:[o.jsxs("div",{className:"flex-grow flex",children:[o.jsx(Ka,{className:"w-[18px] mr-2.5"}),o.jsx("div",{className:"h-[54px] w-[54px] rounded overflow-hidden",children:o.jsx(Xe,{src:t.image_url})}),o.jsxs("div",{className:"ml-[10px]",children:[o.jsx("h5",{className:"line-clamp-1 font-medium overflow-hidden",children:t.name}),o.jsx("p",{className:"opacity-[.7] leading-[1.2] line-clamp-1 text-sm",children:t.singers[0].name})]})]}),o.jsxs("div",{className:"flex space-x-1",children:[o.jsx(at,{className:"animate-spin w-5"}),o.jsx("p",{className:"text-sm",children:"Uploading..."})]})]})}function XH(){const{theme:t}=q(),{uploadingSongs:e,isUploading:n}=dI(),{handleSetSong:r}=ei({variant:"songs"}),{uploadedSongs:s,isFetching:i,user:a}=rA({tab:"uploaded"}),l=u=>{r(u,s)},c=m.useMemo(()=>i?0:e.length+s.length,[e,s,i]);return a?o.jsxs(ms,{children:[o.jsx(Bm,{variant:"uploaded-song",children:i?o.jsx(o.Fragment,{children:o.jsx("div",{className:"h-[30px] mb-[10px] flex items-center",children:o.jsx(le,{className:"h-[20px] w-[90px]"})})}):o.jsxs("div",{className:"flex justify-between items-center w-full",children:[o.jsxs("p",{className:"font-[500] opacity-[.5]",children:[c," Songs"]}),o.jsx("button",{disabled:n,children:o.jsxs("label",{className:`${t.content_bg} items-center space-x-1 hover:opacity-80 py-1 rounded-full flex px-4 cursor-pointer`,htmlFor:"song_upload",children:[o.jsx(By,{className:"w-5"}),o.jsx("span",{className:"",children:"Upload"})]})})]})}),o.jsxs("div",{className:"",children:[i&&fl,!i&&o.jsx(o.Fragment,{children:c?o.jsxs(o.Fragment,{children:[!!s.length&&o.jsx(ti,{setSong:u=>l(u.queue_id),songs:s,songVariant:"own-song"}),e.map((u,d)=>o.jsx(KH,{song:u},d))]}):o.jsx(Ke,{})})]})]}):o.jsx(o.Fragment,{})}function sA(){const{user:t}=he(),{setPlaylists:e,shouldFetchUserPlaylists:n,playlists:r}=Fn(),{setErrorToast:s}=ge(),[i,a]=m.useState(!0);return{isFetching:i,playlists:r,user:t,setIsFetching:a,getPlaylist:async()=>{try{if(!t)return;if(a(!0),n.current){n.current=!1;const c=_e(wr,X(Zs(),"in",t.liked_playlist_ids)),d=(await Vr(c)).filter(f=>!f.is_official&&f.owner_email===t.email?!0:!!f.is_public);e(d)}else await zs(100)}catch(c){console.log({message:c}),s()}finally{a(!1)}}}}function YH(){const{user:t}=he(),{myMusicAddPlaylist:e,isFetching:n}=bw(),r=m.useRef(null),s=()=>{var a;return(a=r.current)==null?void 0:a.close()},i=async(a,l)=>{await e(a,l),s()};if(t)return o.jsxs(o.Fragment,{children:[o.jsxs(oe,{onClick:()=>{var a;return(a=r.current)==null?void 0:a.open()},size:"clear",className:"py-1 px-4",color:"primary",children:[o.jsx(ps,{className:"w-6"}),o.jsx("span",{children:"Add new playlist"})]}),o.jsx(Fe,{ref:r,variant:"animation",children:o.jsx("div",{className:"max-h-[80vh] max-w-[85vw] w-[400px]",children:o.jsx(bl,{close:s,isLoading:n,variant:"add",user:t,submit:i})})})]})}function JH(){const{isFetching:t,playlists:e,getPlaylist:n}=sA();return m.useEffect(()=>{n()},[]),o.jsx(o.Fragment,{children:o.jsxs("div",{children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx(be,{title:"Playlist"}),o.jsx(YH,{})]}),o.jsx(ml,{loading:t,playlists:e})]})})}function ZH(){const{user:t}=he(),{shouldFetchUserSingers:e,setSingers:n,singers:r}=Fn(),{setErrorToast:s}=ge(),[i,a]=m.useState(!0);return{isFetching:i,singers:r,user:t,setIsFetching:a,getSinger:async()=>{try{if(!t)return;if(a(!0),e.current&&t.liked_singer_ids.length){e.current=!1;const c=_e(yf,X(Zs(),"in",t.liked_singer_ids)),u=await vf(c);n(u)}else await zs(100)}catch(c){console.log({message:c}),s()}finally{a(!1)}}}}function eW(){const{isFetching:t,singers:e,getSinger:n}=ZH(),r=[...Array(3).keys()].map(s=>o.jsx(xx,{variant:"skeleton"},s));return m.useEffect(()=>{n()},[]),t?o.jsxs(o.Fragment,{children:[o.jsx(le,{className:"h-[48px] w-[160px]"}),o.jsx("div",{className:"flex flex-row flex-wrap -mx-2 mt-3",children:r})]}):!t&&!e.length?o.jsx(o.Fragment,{}):o.jsx(o.Fragment,{children:o.jsxs("div",{children:[o.jsx(be,{title:"Singers"}),o.jsx("div",{className:"flex flex-row flex-wrap -mx-2 mt-3",children:e.map((s,i)=>o.jsx(xx,{variant:"singer-item",singer:s},i))})]})})}function tW(){const[t,e]=m.useState("Favorite");return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"space-y-5",children:[o.jsx(Sl,{}),o.jsx(JH,{}),o.jsx(eW,{}),o.jsxs("div",{children:[o.jsx(be,{title:"Songs"}),o.jsx("div",{className:"flex space-x-2 my-3",children:o.jsx(xs,{render:n=>n,setTab:e,tab:t,tabs:["Favorite","Uploaded"]})}),t==="Favorite"?o.jsx(QH,{}):o.jsx(XH,{})]})]}),o.jsx(Yf,{})]})}const nW=()=>{const[t,e]=m.useState(),[n,r]=m.useState(""),[s,i]=m.useState([]),[a,l]=m.useState([]),[c,u]=m.useState(!1),[d,f]=m.useState(!1),[p,g]=m.useState(),v=m.useRef(0),_=m.useMemo(()=>p!==void 0?a[p]:void 0,[p,a]);return{song:t,setSong:e,baseLyric:n,setBaseLyric:r,baseLyricArr:s,setBaseLyricArr:i,lyrics:a,setLyrics:l,updateLyric:(E,w)=>{l(S=>{const I={...S[E],...w};return S[E]=I,[...S]})},isFetching:c,setIsFetching:u,isChanged:d,setIsChanged:f,start:v,selectLyricIndex:p,setSelectLyricIndex:g,currentLyric:_}},iA=m.createContext(null);function rW({children:t}){return o.jsx(iA.Provider,{value:nW(),children:t})}const bn=()=>{const t=m.useContext(iA);if(!t)throw new Error("Edit lyric context not found");return t};function sW({audioEle:t,isClickPlay:e,song:n}){const{start:r,baseLyricArr:s,lyrics:i,setLyrics:a,setIsChanged:l,setIsFetching:c,baseLyric:u}=bn(),{setErrorToast:d,setSuccessToast:f}=ge(),p=i.length>=s.length,g=e&&!!s.length&&!p,v=()=>{if(!t||!s.length||p||!n)return;const w=+t.currentTime.toFixed(1);if(r.current===w)return;const S=s[i.length],I=lE({start:r.current,end:w,text:S});if(r.current=w,a(F=>[...F,I]),s.length===i.length+2){const F=s[s.length-1],D=lE({start:r.current,end:n.duration,text:F});a(C=>[...C,D])}l(!0)},_=()=>{if(i.length&&t){const w=i[i.length-1].start;r.current=w,t.currentTime=w,a(S=>S.slice(0,-1)),l(!0)}},b=()=>{if(!n)return;const w={song_id:n.id,base:u,lyrics:JSON.stringify(i)};Ze("temp-lyric",w)};return{addLyric:v,removeLyric:_,isEnableAddBtn:g,submit:async()=>{try{if(c(!0),!n)return;const w=zu(Pe),S={lyrics:JSON.stringify(i),base:u},I=Ut(Pe,"Songs",n.id);if(n.lyric_id){const F=Ut(Pe,"Lyrics",n.lyric_id);w.update(F,S)}else{const F=Ut(vr(Pe,"Lyrics")),D={lyric_id:F.id,updated_at:Gs()};w.set(F,S),w.update(I,D)}await w.commit(),f("Edit lyric successful"),l(!1),Ze("temp-lyric","")}catch(w){console.log({error:w}),d(),b()}finally{c(!1)}}}}function iW({closeModal:t}){const{setErrorToast:e,setSuccessToast:n}=ge(),{song:r,setSong:s}=bn(),[i,a]=m.useState(),[l,c]=m.useState(!1);return{songFile:i,song:r,setSongFile:a,isFetching:l,handleSubmit:async()=>{try{if(!i||!r)throw new Error;c(!0);const{filePath:d,fileURL:f}=await yw({file:i,folder:"/songs/",namePrefix:"beat"}),p={beat_url:f,beat_file_path:d};await kt({collectionName:"Songs",id:r.id,data:p}),r.beat_file_path&&An({filePath:r.beat_file_path}),s(()=>({...r,...p})),n("Upload song beat successful"),t()}catch(d){console.log({error:d}),e()}finally{c(!1)}}}}function aW({closeModal:t}){const{theme:e}=q(),{songFile:n,setSongFile:r,isFetching:s,handleSubmit:i,song:a}=iW({closeModal:t}),l=c=>{var u;(u=c.target.files)!=null&&u.length&&r(c.target.files[0])};return o.jsxs("div",{className:"w-[500px] max-w-[80vw] flex flex-col",children:[o.jsx(Ct,{title:"Song beat",close:t}),o.jsx("input",{onChange:l,type:"file",multiple:!0,accept:"audio",id:"song_upload",className:"hidden"}),a&&(n||(a==null?void 0:a.beat_url))&&o.jsx("audio",{src:n?URL.createObjectURL(n):a.beat_url,controls:!0}),o.jsx(oe,{size:"clear",children:o.jsx("label",{htmlFor:"song_upload",className:`${e.content_bg} seld-start rounded-full px-5 py-1.5 cursor-pointer mt-2`,children:o.jsx(By,{className:"w-5"})})}),o.jsx(oe,{disabled:!n,onClick:i,isLoading:s,color:"primary",className:"mt-3 ml-auto font-playwriteCU",children:"Save"})]})}const oW=40;function lW({closeModal:t}){const{theme:e}=q(),{baseLyric:n,setBaseLyric:r,baseLyricArr:s,setIsChanged:i,lyrics:a}=bn(),[l,c]=m.useState(n),u=m.useRef(null),d=m.useRef(null),f=()=>{const g=l.split(/\r?\n/).filter(v=>v).filter(v=>v.trim()).join(`\r
`);r(g),i(!0),t()};function p(g){const v=[...s];return v[g]=`<div style="color: transparent; border-radius: 4px; background-color: ${e.content_code}">${v[g]}</div>`,v.join(`\r
`)}return m.useEffect(()=>{if(a.length&&u.current&&d.current){const g=oW*(a.length-1);u.current.scrollTop=g,d.current.style.paddingBottom=g+"px"}},[]),m.useEffect(()=>{const g=()=>{if(u.current&&d.current){const v=u.current.scrollTop;d.current.scrollTop=v}};return u.current&&u.current.addEventListener("scroll",g),()=>{u.current&&u.current.removeEventListener("scroll",g)}},[]),o.jsxs("div",{className:"w-[500px] max-w-[85vw]",children:[o.jsx(Ct,{close:t,title:"Edit lyric"}),o.jsxs("div",{className:"relative h-[60vh] overflow-hidden rounded-md bg-white/10 ",children:[o.jsx("div",{ref:d,className:"whitespace-break-spaces text-transparent px-2 py-2 absolute leading-[40px] h-full overflow-auto top-0 left-0 w-full",dangerouslySetInnerHTML:{__html:p(a.length===s.length?a.length-1:a.length)}}),o.jsx("textarea",{style:{resize:"none"},ref:u,className:"absolute bg-transparent top-0 outline-none w-full leading-[40px] py-2 px-3 h-full no-scrollbar",value:l,onChange:g=>c(g.target.value)})]}),o.jsx("p",{className:"ml-auto mt-5",children:o.jsx(oe,{onClick:f,color:"primary",className:"rounded-full",children:"Save"})})]})}function cW(){const{theme:t}=q(),{song:e}=bn(),[n,r]=m.useState(""),s=m.useRef(null),i=m.useRef(null),a=u=>{var d,f;r(u),(d=s.current)==null||d.open(),(f=i.current)==null||f.close()},l=()=>{var u;return(u=s.current)==null?void 0:u.close()},c=()=>{if(n)switch(n){case"lyric":return o.jsx(lW,{closeModal:l});case"tutorial":return o.jsxs("div",{className:"w-[500px] max-w-[90vw]",children:[o.jsx(Ct,{title:"Tutorial",close:l}),o.jsx("div",{className:"h-[500px] max-h-[75vh] overflow-y-auto no-scrollbar",children:o.jsx("img",{className:"w-full border rounded-[16px]",src:"",alt:""})})]});case"song-beat":return e&&o.jsx(aW,{closeModal:l})}};return o.jsxs(o.Fragment,{children:[o.jsxs(pr,{children:[o.jsx(gr,{ref:i,children:o.jsx(oe,{size:"clear",className:`${t.content_bg} h-[36px] w-[36px] justify-center rounded-full mt-2`,children:o.jsx(ul,{className:"w-6"})})}),o.jsx(xr,{className:"top-[calc(100%+8px)] right-0 z-[9]",appendTo:"parent",children:o.jsx($R,{className:"w-[140px]",children:o.jsxs(_l,{children:[o.jsxs("button",{onClick:()=>a("lyric"),children:[o.jsx(Ys,{className:"w-5"}),o.jsx("span",{children:"Edit lyric"})]}),o.jsxs("button",{onClick:()=>a("tutorial"),children:[o.jsx(SI,{className:"w-5"}),o.jsx("span",{children:"Tutorial"})]}),o.jsxs("button",{onClick:()=>a("song-beat"),children:[o.jsx(Ka,{className:"w-5"}),o.jsx("span",{children:"Song beat"})]})]})})})]}),o.jsx(Fe,{variant:"animation",ref:s,children:c()})]})}function uW({audioEle:t},e){const{theme:n}=q(),{song:r,lyrics:s}=bn(),i=m.useRef(null),{backward:a,forward:l,handlePlayPause:c,pause:u,seek:d,status:f,isClickPlay:p}=ww({audioEle:t,progressLineRef:i}),{addLyric:g,removeLyric:v,isEnableAddBtn:_,submit:b}=sW({audioEle:t,isClickPlay:p,song:r});m.useImperativeHandle(e,()=>({seek:d,pause:u,submit:b}));const E=()=>{if(!p&&s.length){const I=s[s.length-1].end;t.currentTime=I}c()},w={button:`mt-2 ml-2 space-x-1 ${n.content_bg} rounded-full`,icon:"w-6",arrow:"before:content-[''] before:absolute before:-translate-x-1/2 before:left-[27px]  before:bottom-[calc(100%-1px)] before:z-[-1] before:border-8 before:border-transparent before:border-b-amber-800"},S=()=>{switch(f){case"error":return o.jsx(om,{className:"w-6"});case"playing":return o.jsx(cm,{className:"w-6"});case"paused":return o.jsx(Qc,{className:"w-6"});case"waiting":return o.jsx(at,{className:"w-6 animate-spin"})}};return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex items-start flex-wrap -mt-2 -ml-2",children:[o.jsx(LI,{className:"mt-2 ml-2",audioEle:t,postLocalStorageKey:"edit_lyric"}),o.jsx(oe,{className:w.button,onClick:E,children:S()}),o.jsxs(oe,{disabled:!_,onClick:g,className:w.button,children:[o.jsx(br,{className:"w-6"}),o.jsx("span",{children:"Add"})]}),o.jsxs(oe,{disabled:!s.length,onClick:v,className:w.button,children:[o.jsx(Ky,{className:"w-6"}),o.jsx("span",{children:"Remove"})]}),o.jsxs(oe,{onClick:()=>a(2),className:w.button,children:[o.jsx(zy,{className:"w-6"}),o.jsx("span",{children:"2s"})]}),o.jsxs(oe,{onClick:()=>l(2),className:w.button,children:[o.jsx("span",{children:"2s"}),o.jsx(Gy,{className:"w-6"})]}),o.jsx("div",{className:"ml-auto",children:o.jsx(cW,{})})]}),o.jsx("div",{ref:i,style:{backgroundColor:"rgba(255,255,255,.3)"},className:"h-1 rounded-full mt-3 w-full"})]})}const dW=m.forwardRef(uW);function hW({lyric:t,openModal:e,seek:n,theme:r,isLast:s}){return o.jsx(o.Fragment,{children:o.jsxs("div",{className:"pt-[10px] last:mb-[30vh]",children:[o.jsx("button",{className:`text-[18px] ${r.content_hover_text}`,onClick:()=>n(t.start),children:Bs(+t.start)}),o.jsxs("p",{className:"font-[700] select-none flex items-center",children:[t.text,o.jsx("button",{onClick:e,className:"ml-1",children:o.jsx(KM,{className:"w-5"})})]}),s&&t.end!==t.start&&o.jsx("button",{className:`${r.content_hover_text} pt-[10px]`,onClick:()=>n(t.end),children:Bs(+t.end)})]})})}function fW({text:t,className:e="",status:n,activeColor:r},s){const i=()=>{switch(n){case"coming":return"disable";case"active":return`${r||"text-[#ffed00]"} active-lyric`;case"done":return"disable"}};return m.useEffect(()=>{n==="active"&&scroll()},[n]),o.jsx("p",{ref:s,className:`${e} transition-transform duration-[.3s] origin-left select-none font-[700] ${i()}`,children:t})}const aA=m.forwardRef(fW);function mW(){const{lyrics:t}=bn(),e=m.useRef(null);return m.useEffect(()=>{e.current&&rI(e.current)},[t.length]),{activeLyricRef:e}}function pW({controlRef:t,modalRef:e}){const{theme:n}=q(),{baseLyricArr:r,lyrics:s,setSelectLyricIndex:i,song:a}=bn(),{activeLyricRef:l}=mW(),c=d=>{var f;(f=t.current)==null||f.seek(d)},u=d=>{var f;typeof d=="number"&&(i(d),(f=e.current)==null||f.open())};return o.jsx(o.Fragment,{children:o.jsxs("div",{className:`flex-grow  overflow-auto flex  no-scrollbar md:text-lg rounded-xl px-2 pt-3 mt-3 ${n.side_bar_bg}`,children:[o.jsx("div",{className:"w-1/2",children:r.length?o.jsx(o.Fragment,{children:r.map((d,f)=>{let p=f===s.length?"active":f<s.length?"done":"coming";return p==="done"&&f===r.length-1&&(p="active"),o.jsx(aA,{ref:p==="active"?l:null,activeColor:n.type==="light"?n.content_text:"",className:"pt-[38px] mr-[24px]",status:p,text:d},f)})}):o.jsx("p",{children:"..."})}),o.jsx("div",{className:"w-1/2 ",children:!!(s!=null&&s.length)&&a&&s.map((d,f)=>o.jsx(hW,{openModal:()=>u(f),seek:c,lyric:d,isLast:f===s.length-1&&f!==r.length-1,theme:n},f))})]})})}function gW({audioRef:t}){const{user:e}=he(),{baseLyric:n,setSong:r,song:s,setBaseLyricArr:i,setBaseLyric:a,setLyrics:l,isChanged:c,lyrics:u,setIsChanged:d,isFetching:f,start:p}=bn(),[g,v]=m.useState(!0),_=m.useRef(!1),b=qi(),E=I=>{if(!I.length)return;const F=I.length-1;if(t.current){const D=I[F].end;p.current=D}},w=()=>{if(!s)return;const I={song_id:s.id,base:n,lyrics:JSON.stringify(u)};Ze("temp-lyric",I)},S=async()=>{try{if(!b.id)throw new Error("");const I=await Ur({collectionName:"Songs",id:b.id});if(!I.exists())throw new Error("");const F={...I.data(),id:I.id,queue_id:""};if(F.lyric_id){const D=await Ur({collectionName:"Lyrics",id:F.lyric_id});if(D.exists()){const{base:C,lyrics:k}=D.data(),R=JSON.parse(k);a(C),l(R),E(R)}}r(F)}catch(I){console.log({message:I})}finally{v(!1)}};return m.useEffect(()=>{_.current||(_.current=!0,S())},[e]),m.useEffect(()=>{(()=>{if(!s)return;const{base:F,lyrics:D,song_id:C}=rn()["temp-lyric"]||{};if(C===s.id){const k=JSON.parse(D);a(F),l(k),E(k),d(!0)}})()},[s]),m.useEffect(()=>{if(!n)return;const I=n.split(/\r?\n/);i(I)},[n]),m.useEffect(()=>{if(!c)return;const I=F=>{F.preventDefault(),w()};return window.addEventListener("beforeunload",I),()=>{window.removeEventListener("beforeunload",I)}},[c,n,u]),{isFetching:g,song:s,isChanged:c,isSubmitting:f}}function oA(t,e){if(e.length===1&&e[0]===0)return[t];const n=[];let r=0;e.sort((s,i)=>s-i);for(const s of e)s>t.length||s<0||(n.push(t.substring(r,s)),r=s);return n.push(t.substring(r)),n}const xW=["Edit","Record"];function yW(){const[t,e]=m.useState(0),[n,r]=m.useState(),[s,i]=m.useState(""),[a,l]=m.useState([[]]),[c,u]=m.useState([]),[d,f]=m.useState(!1),[p,g]=m.useState("Edit"),[v,_]=m.useState("paused"),b=m.useRef(null),E=m.useRef(null),w=m.useRef(null),S=m.useRef(null),I=m.useRef(null),F=m.useRef(null),D=m.useRef(null),C=m.useRef(null),k=m.useRef(),R=m.useRef(!1),j=m.useRef(0),N=m.useRef(0),P=m.useRef(0),A=m.useRef([]),ee=m.useRef([]),xe=m.useRef(!0),Se=m.useRef(!1),Ue=m.useMemo(()=>s.split(" ").filter(te=>te.trim()),[s]),H=m.useMemo(()=>Ue.map((te,ye)=>({text:te,positions:a[ye]})),[s,a]),Y=m.useMemo(()=>{const te=[];return H.forEach(ye=>{const Te=oA(ye.text,ye.positions);te.push(...Te)}),te.filter(ye=>ye)},[s,a]);return{eleRefs:{endTimeRangeRef:E,overlayRef:b,startTimeRangeRef:w,startRefText:S,endRefText:I,currentWordRef:F,growInputRef:D,tempWordRef:C},tabProps:{tab:p,setTab:g,tabs:xW},eventRefs:{playWhenSpaceRef:xe,moveArrowToGrowRef:Se},currentWords:Ue,currentWordsData:H,currentSplitWords:Y,actuallyEndRef:j,playerRef:k,actuallyStartRef:N,tempActuallyStartRef:P,wordsRatioRef:A,mergedGrowListRef:ee,isChangedRef:R,wordIndex:t,setWordIndex:e,growList:c,setGrowList:u,isOpenEditLyricModal:d,SetIsOpenEditLyricModal:f,setStatus:_,status:v,text:s,setText:i,cut:a,setCut:l,localLyricIndex:n,setLoacalLyricIndex:r}}const lA=m.createContext(null);function vW({children:t}){return o.jsx(lA.Provider,{value:yW(),children:t})}const Pt=()=>{const t=m.useContext(lA);if(!t)throw new Error("LyricEditorProvider not found");return t};function cA(t,e){const n=`lyric_${Uu(4)}`,r=document.querySelector("style");if(!r)return n;let s=`@keyframes ${n}{0%{width:0%}`;if(!t.length)return s+="100%{width:100%}}",r.innerText=s,n;let i=t.reduce((u,d)=>u+d,0);const a=[];let l=0,c=0;for(let u=0;u<e.length-1;u++){const d=e[u],f=t[u];c+=d,l+=f,a.push({progress:Math.round(l/i*100),width:c})}for(const u of a)s+=`${u.progress}%{width:${u.width}%}`;return s+="100%{width:100%}}",r.innerText=s,n}function wW({audioEle:t}){const{eleRefs:e,actuallyEndRef:n,actuallyStartRef:r,tempActuallyStartRef:s,wordsRatioRef:i,mergedGrowListRef:a,status:l,setStatus:c}=Pt(),{play:u,pause:d,statusRef:f}=ww({audioEle:t,statusFromParent:l,setStatusFromParent:c}),{overlayRef:p}=e,g=()=>{d(),p.current&&(p.current.style.animation="none")},v=()=>{if(t.currentTime=r.current,!s.current&&p.current){const E=cA(a.current,i.current);p.current.style.animation=`${E} ${((n.current-r.current)/t.playbackRate).toFixed(2)}s linear`}u()},_=()=>{f.current==="paused"?v():g()},b=()=>{if(+t.currentTime.toFixed(1)>=n.current)return g()};return m.useEffect(()=>{if(t)return t.addEventListener("timeupdate",b),()=>{t.removeEventListener("timeupdate",b)}},[]),{handlePlayPause:_,_pause:g,_play:v,status:l}}function _W({audioEle:t}){const{playerRef:e}=Pt(),{_play:n,_pause:r,handlePlayPause:s}=wW({audioEle:t});return m.useEffect(()=>{e.current={handlePlayPause:s,pause:r,play:n}},[]),o.jsx(o.Fragment,{})}function bW({audioEle:t}){const{tabProps:e}=Pt(),{theme:n}=q();return o.jsxs(o.Fragment,{children:[o.jsx(_W,{audioEle:t}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx(xs,{className:"bg-white/10",...e,render:r=>r}),o.jsx(LI,{positions:"left",bg:n.content_bg,className:"bg-transparent hover:bg-white/10",audioEle:t,postLocalStorageKey:"edit_lyric_tune"})]})]})}function SW(){const{updateLyric:t,setIsChanged:e,selectLyricIndex:n}=bn(),{actuallyEndRef:r,actuallyStartRef:s,growList:i,text:a,cut:l}=Pt();return{updateLyricTune:async()=>{if(typeof n!="number")throw new Error("selectLyricIndex is undefine");const u={tune:{start:s.current,end:r.current,grow:i},cut:l,text:a};t(n,u),e(!0)}}}function EW({closeModal:t}){const{setSelectLyricIndex:e,selectLyricIndex:n,lyrics:r}=bn(),{isChangedRef:s,playerRef:i}=Pt(),{updateLyricTune:a}=SW(),l=()=>{a(),t()},c=u=>{var d;if(typeof n=="number")switch(s.current&&(s.current=!1,a()),(d=i.current)==null||d.pause(),u){case"next":if(n===r.length-1)return;e(f=>f+1);break;case"prev":if(n===0)return;e(f=>f-1);break}};return o.jsxs("div",{className:"flex justify-end space-x-2 mt-5 ",children:[o.jsxs(oe,{color:"primary",disabled:n===0,onClick:()=>c("prev"),className:"font-playwriteCU",children:[o.jsx(zy,{className:"w-6"}),o.jsx("span",{children:"Previous"})]}),o.jsxs(oe,{color:"primary",disabled:n===r.length-1,onClick:()=>c("next"),className:"font-playwriteCU",children:[o.jsx("span",{children:"Next"}),o.jsx(Gy,{className:"w-6"})]}),o.jsx(oe,{disabled:!s.current,color:"primary",onClick:l,className:"font-playwriteCU",children:"Ok"})]})}function kW(){const{isOpenEditLyricModal:t,playerRef:e,eleRefs:{currentWordRef:n},eventRefs:r}=Pt(),s=a=>{var l;if(a.key===" "){if(!r.playWhenSpaceRef.current)return;a.preventDefault(),(l=e.current)==null||l.handlePlayPause()}if(a.key==="ArrowRight"||a.key==="ArrowLeft"){if(!r.moveArrowToGrowRef.current)return;const c=n.current;if(!c)return;switch(a.key){case"ArrowRight":a.preventDefault(),c!=null&&c.nextSibling&&(c==null?void 0:c.nextSibling).click();break;case"ArrowLeft":a.preventDefault(),c!=null&&c.previousSibling&&(c==null?void 0:c.previousSibling).click();break}}},i=a=>{if(!r.moveArrowToGrowRef.current)return;const l=a.target,c=document.querySelectorAll(".word-item");let u=!1;c.forEach(d=>d.contains(l)?u=!0:{}),!u&&(r.moveArrowToGrowRef.current=!1)};m.useEffect(()=>(window.addEventListener("mousedown",i),window.addEventListener("keydown",s),()=>{window.removeEventListener("mousedown",i),window.removeEventListener("keydown",s)}),[t])}const uA=t=>{const e=t.clientWidth,n=[];return t.childNodes.forEach(r=>{n.push(Math.round(r.offsetWidth/e*100))}),n};function Aw(t,e,n){const r=[];if(!n.length)return[];let s=0;return t.forEach((i,a)=>{const l=e[a].length;if(l===0)r.push(n[s]),s++;else if(l>0){const u=n.slice(s,s+l+1).reduce((d,f)=>(s++,+(d+f).toFixed(1)),0);r.push(u)}}),r}function TW(){const{selectLyricIndex:t,currentLyric:e}=bn(),{eleRefs:n,actuallyEndRef:r,mergedGrowListRef:s,actuallyStartRef:i,wordsRatioRef:a,setGrowList:l,setCut:c,setText:u,currentWords:d}=Pt(),{tempWordRef:f,endTimeRangeRef:p,startTimeRangeRef:g,startRefText:v,endRefText:_}=n;m.useEffect(()=>{if(!f.current)return;const b=uA(f.current);a.current=b},[d]),m.useEffect(()=>{if(!e)return;const b=e.tune.grow,E=e.text.split(" ").filter(S=>S.trim());u(e.text),c(e.cut);const w=Aw(E,e.cut,b);l(b),s.current=w,_.current&&v.current&&g.current&&p.current&&(i.current=e!=null&&e.tune?e.tune.start:e.start,v.current.innerText=`${e.start} / ${i.current}`,g.current.max=e.end+"",g.current.value=i.current+"",r.current=e!=null&&e.tune?e.tune.end:e.end,_.current.innerText=`${r.current} / ${e.end}`,p.current.max=e.end+"",p.current.value=r.current+"")},[t])}function IW({audioEle:t}){const{playerRef:e,isChangedRef:n,tabProps:{tab:r,setTab:s},setGrowList:i,cut:a,actuallyStartRef:l,mergedGrowListRef:c,currentSplitWords:u,currentWords:d}=Pt(),[f,p]=m.useState(!1),[g,v]=m.useState([]),_=m.useRef(Date.now()),b=m.useRef(!1),E=m.useRef(!1),w=()=>{const P=+((Date.now()-_.current)/1e3).toFixed(1);v(A=>[...A,P])},S=()=>{var P;_.current=Date.now(),b.current||(b.current=!0,(P=e.current)==null||P.play(),p(!0))},I=()=>{b.current&&w()},F=P=>{P.key===" "&&(E.current||(P.preventDefault(),E.current=!0,S()))},D=P=>{P.key===" "&&(P.preventDefault(),I(),E.current=!1)},R={onPointerDown:()=>{S()},onPointerUp:()=>{I()}},j=()=>{var P;(P=e.current)==null||P.pause(),b.current=!1,v([]),p(!1)},N=()=>{n.current=!0,i(g);const P=Aw(d,a,g);c.current=P,s("Edit"),j()};return m.useEffect(()=>{g.length===u.length&&N()},[g]),m.useEffect(()=>{var P;if(r==="Record")return(P=e.current)==null||P.pause(),window.addEventListener("keydown",F),window.addEventListener("keyup",D),t.currentTime=l.current,()=>{var A;(A=e.current)==null||A.pause(),window.removeEventListener("keydown",F),window.removeEventListener("keyup",D)}},[r]),{localGrowList:g,buttonProps:R,clear:j,isRecording:f}}function CW({audioEle:t}){const{currentSplitWords:e}=Pt(),{buttonProps:n,localGrowList:r,isRecording:s,clear:i}=IW({audioEle:t});return o.jsxs(o.Fragment,{children:[o.jsx(oe,{disabled:!s,size:"clear",className:"p-1.5",onClick:i,color:"primary",children:o.jsx(Gi,{className:"w-6"})}),o.jsxs("div",{className:"h-[240px] flex flex-col justify-center",children:[o.jsx("div",{className:"md:text-xl font-[700]",children:e.map((a,l)=>o.jsxs("span",{className:`${l<r.length?"text-[#ffed00]":""} leading-[1]`,children:[a," "]},l))}),o.jsx("p",{className:"mt-5 text-center md:hidden",children:o.jsx(oe,{...n,color:"primary",children:"Record"})})]})]})}function jW(){const{currentLyric:t}=bn(),{eleRefs:e,isChangedRef:n,actuallyEndRef:r,actuallyStartRef:s,tempActuallyStartRef:i,setGrowList:a}=Pt(),{startRefText:l,endRefText:c}=e;return{setEndPoint:g=>{if(!t)return;const v=+g.toFixed(1);n.current=!0,r.current=v,c.current&&(c.current.textContent=`${v} / ${t.end}`),i.current&&(r.current=v,s.current=v-1)},setStartPoint:g=>{if(!t)return;const v=+g.toFixed(1);n.current=!0,s.current=v,l.current&&(l.current.textContent=`${t.start} / ${v}`)},endTimeRangeProps:{onFocus:()=>{i.current=s.current,s.current=r.current-1},onBlur:()=>{s.current=i.current,i.current=0}},handleGrowWord:g=>{n.current=!0,a(v=>{const _=[...v];let b=_[g.index];switch(g.variant){case"range":b=g.value;break;case"button":b=+(g.action==="minus"?b-.1:b+.1).toFixed(1)}return b<0&&(b=0),_[g.index]=b,_})}}}function RW(){const{setStartPoint:t,setEndPoint:e,endTimeRangeProps:n,handleGrowWord:r}=jW(),{currentLyric:s}=bn(),{wordIndex:i,growList:a,eleRefs:l}=Pt();return s?o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center mt-5 space-x-2",children:[o.jsxs("label",{htmlFor:"start",className:"flex-shrink-0 w-[150px]",children:["Start:",o.jsx("span",{ref:l.startRefText})]}),o.jsx("input",{ref:l.startTimeRangeRef,type:"range",id:"start",min:s.start,max:s.end,step:.2,className:"w-full",onChange:c=>t(+c.target.value)})]}),o.jsxs("div",{className:"flex items-center mt-3 space-x-2",children:[o.jsxs("label",{htmlFor:"end",className:"flex-shrink-0 w-[150px]",children:["End:",o.jsx("span",{ref:l.endRefText})]}),o.jsx("input",{id:"end",ref:l.endTimeRangeRef,type:"range",min:s.start,step:.2,className:"w-full",onChange:c=>e(+c.target.value),...n})]}),o.jsxs("div",{className:"flex items-center mt-3",children:[o.jsxs("label",{htmlFor:"grow",className:"flex-shrink-0 w-[150px] mr-2 leading-[1]",children:["Grow: ",a[i]]}),o.jsx("input",{ref:l.growInputRef,type:"range",id:"grow",min:0,max:10,step:.1,className:"w-full",value:a[i]+"",onChange:c=>r({variant:"range",value:+c.target.value,index:i})})]})]}):o.jsx(o.Fragment,{})}function AW(){const{eleRefs:t,eventRefs:e,setText:n,mergedGrowListRef:r,setCut:s,setGrowList:i,text:a}=Pt(),[l,c]=m.useState(!1),u=m.useRef(null),d=()=>{if(!u.current)return;const f=u.current.value.split(/\r?\n/).filter(v=>v).map(v=>v.trim()).join(" ").split(" ").filter(v=>v).join(" ");n(f);const p=f.split(" ").map(()=>0),g=f.split(" ").map(()=>[]);s(g),i(p),r.current=p,c(!1)};return m.useEffect(()=>{l?(e.playWhenSpaceRef.current=!1,e.moveArrowToGrowRef.current=!1,u.current&&(u.current.value=a)):(e.playWhenSpaceRef.current=!0,e.moveArrowToGrowRef.current=!0)},[l]),o.jsxs("div",{className:"mt-3 relative pt-5",children:[o.jsx("div",{className:"absolute top-0 right-0 flex justify-end w space-x-2 hover:[&>button]:bg-black/10 [&>button]:rounded-full [&>button]:p-1",children:l?o.jsxs(o.Fragment,{children:[o.jsx("button",{onClick:()=>c(!1),children:o.jsx(Gi,{className:"w-5"})}),o.jsx("button",{onClick:d,children:o.jsx(bu,{className:"w-5"})})]}):o.jsx("button",{onClick:()=>c(!0),children:o.jsx(Ys,{className:"w-5"})})}),o.jsx("div",{className:"flex justify-center",children:l?o.jsx("textarea",{ref:u,className:`${nv} w-full mt-3 bg-white/10`}):o.jsx(o.Fragment,{children:o.jsxs("div",{className:"relative whitespace-nowrap  sm:text-2xl font-[700]",children:[a,o.jsx("div",{ref:t.overlayRef,className:"absolute  top-0 left-0 overflow-hidden text-[#ffed00] whitespace-nowrap w-0",children:a})]})})})]})}function NW({text:t,openModal:e,isShowScissor:n,index:r}){const{theme:s}=q(),{growList:i,setWordIndex:a,wordIndex:l,eventRefs:c,eleRefs:u}=Pt(),d=l===r,f=()=>{var p;r!==-1&&(a(r),c.moveArrowToGrowRef.current=!0,(p=u.growInputRef.current)==null||p.focus())};return o.jsxs("div",{ref:p=>d?u.currentWordRef.current=p:{},style:{flexGrow:i[r]!==0?i[r]:.05},onClick:f,className:`word-item cursor-pointer relative rounded-full flex items-center justify-center border ${s.content_border} ${d?s.content_bg:"bg-"+s.alpha}`,children:[o.jsx("span",{children:t}),n&&d&&o.jsx(oe,{onClick:e,size:"clear",className:"!absolute bottom-0 translate-y-[16px] bg-black/10 p-1.5",children:o.jsx(EI,{className:"w-5"})})]})}function PW({wordData:t,wordIndex:e,closeModal:n}){const{theme:r}=q(),{currentLyric:s,selectLyricIndex:i}=bn(),{setCut:a,cut:l}=Pt(),[c,u]=m.useState(t.positions),d=m.useMemo(()=>oA(t.text,c).filter(v=>v),[c]),f=m.useMemo(()=>t.text.split(""),[]),p=v=>{const _=[...c],b=c.findIndex(E=>E===v);b===-1?_.push(v):_.splice(b,1),u(_)},g=()=>{if(!s||i===void 0)return;const v=c.sort((b,E)=>b-E),_=[...l];_[e]=v,a(_),n()};return o.jsxs("div",{className:"w-[500px] max-w-[90vw]",children:[o.jsx(be,{title:"Split word "}),o.jsx("div",{className:"flex justify-center space-x-5",children:d.map((v,_)=>o.jsx("span",{className:"text-xl md:text-2xl font-[700]",children:v},_))}),o.jsx("div",{className:"mt-3 flex justify-center",children:f.map((v,_)=>{const b=c.includes(_);return o.jsxs("div",{children:[f.length>1&&_?o.jsx("button",{onClick:()=>p(_),className:` p-1 rounded-full ${b?r.content_bg:"hover:bg-black/10"}`,children:o.jsx(EI,{className:"w-5"})}):"",o.jsx("span",{className:"text-[50px] font-[500]",children:v})]},_)})}),o.jsx("p",{className:"mt-5 text-right",children:o.jsx(oe,{onClick:g,color:"primary",className:"font-playwireCU",children:"OK"})})]})}function FW(){const{currentSplitWords:t,currentWordsData:e,currentWords:n}=Pt(),[r,s]=m.useState(),i=m.useRef(null),a=m.useMemo(()=>{const u={},d=e.map(p=>p.positions.length);let f=0;return d.forEach((p,g)=>{p===0?(u[f]=g,f++):p>0&&[...Array(p+1).keys()].forEach(()=>{u[f]=g,f++})}),u},[e]),l=m.useMemo(()=>r!==void 0?e[r]:void 0,[r,e]),c=u=>{var d;s(u),(d=i.current)==null||d.open()};return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"flex h-[44px] mt-5",children:t.map((u,d)=>{const f=a[d],p=n[f];return o.jsx(NW,{isShowScissor:p?p.length>1:!1,index:d,openModal:()=>c(f),text:u},d)})}),o.jsx(Fe,{variant:"animation",ref:i,children:l&&r!==void 0&&o.jsx(PW,{wordIndex:r,closeModal:()=>{var u;return(u=i.current)==null?void 0:u.close()},wordData:l})})]})}function DW(){const{status:t,playerRef:e}=Pt();return o.jsx(oe,{size:"clear",className:"p-1.5",onClick:()=>{var n;return(n=e.current)==null?void 0:n.handlePlayPause()},color:"primary",children:t==="playing"?o.jsx(cm,{className:"w-6"}):o.jsx(Qc,{className:"w-6"})})}function LW(){const{eventRefs:t,tabProps:{tab:e}}=Pt();m.useEffect(()=>{switch(e){case"Edit":t.playWhenSpaceRef.current=!0,t.moveArrowToGrowRef.current=!0;break;case"Record":t.playWhenSpaceRef.current=!1,t.moveArrowToGrowRef.current=!1;break}},[e])}function MW({closeModal:t}){const{song:e}=bn(),{eleRefs:n,currentWords:r,tabProps:s}=Pt();kW(),TW(),LW();const i=m.useRef(null);return o.jsx(o.Fragment,{children:o.jsxs("div",{className:"max-w-[90vw] w-[600px] relative",children:[o.jsx(Ct,{title:"Edit lyric",close:t}),o.jsx("audio",{src:e==null?void 0:e.song_url,ref:i}),o.jsx("div",{ref:n.tempWordRef,className:"absolute inline-block opacity-0",children:r.map((a,l)=>o.jsxs("span",{children:[a,o.jsx("span",{children:""})]},l))}),i.current&&o.jsx(bW,{audioEle:i.current}),o.jsxs("div",{className:"mt-5",children:[i.current&&o.jsx("div",{className:`${s.tab==="Record"?"block":"hidden"}`,children:o.jsx(CW,{audioEle:i.current})}),o.jsxs("div",{className:`${s.tab==="Edit"?"block":"hidden"}`,children:[o.jsx(DW,{}),o.jsx(RW,{}),o.jsx(AW,{}),o.jsx(FW,{})]})]}),o.jsx(EW,{closeModal:t})]})})}function OW(t){return o.jsx(vW,{children:o.jsx(MW,{...t})})}function $W({children:t}){const{theme:e}=q(),n=m.useRef(null),r=m.useRef(null),s=m.useRef(null),{isFetching:i,song:a,isChanged:l,isSubmitting:c}=gW({audioRef:r}),u=()=>{var d,f;(d=n.current)==null||d.pause(),(f=n.current)==null||f.submit()};return o.jsxs(o.Fragment,{children:[o.jsx("audio",{className:"hidden",ref:r,src:a==null?void 0:a.song_url}),i?o.jsx(an,{children:o.jsx(at,{className:"w-6 animate-spin"})}):a&&o.jsxs("div",{className:"flex-grow flex flex-col overflow-hidden",children:[t,o.jsx(be,{title:` Edit lyric - ${a==null?void 0:a.name}`}),o.jsx("div",{className:"mt-3",children:r.current&&o.jsxs(o.Fragment,{children:[o.jsx(dW,{audioEle:r.current,ref:n}),o.jsx(Fe,{persisted:!0,variant:"animation",ref:s,children:o.jsx(OW,{closeModal:()=>{var d;return(d=s.current)==null?void 0:d.close()}})})]})}),o.jsx(pW,{modalRef:s,controlRef:n}),o.jsx(oe,{className:`${e.content_bg} font-playwriteCU self-end md:self-start rounded-full mt-5 `,variant:"primary",disabled:!l,isLoading:c,onClick:u,children:"Save"})]})]})}function dA(){return o.jsx(rW,{children:o.jsx($W,{})})}function BW(){return o.jsxs("div",{className:"fixed left-[10px] top-[10px] bottom-[10px] right-[10px] flex flex-col md:right-0 md:top-0 md:left-[unset] md:right-[unset] md:relative md:h-full",children:[o.jsx(Sl,{className:"mb-1 self-start"}),o.jsx(dA,{})]})}const zW=["Song","Playlist","Singers","Users"],UW={songs:[],playlists:[],singers:[],users:[]};function VW(){const[t,e]=m.useState(!1),[n,r]=m.useState("Song"),s=IT(),[i,a]=m.useState(UW),l=u=>{a(d=>({...d,...u}))},c=async()=>{try{const u=s[0].get("q");if(!u)return;switch(n){case"Song":{const d=_e(Nn,X("is_official","==",!0),X("name",">=",u),X("name","<=",u+"")),f=await Pn(d);l({songs:f});break}case"Playlist":{const d=_e(wr,X("is_public","==",!0),X("name",">=",u),X("name","<=",u+"")),f=await Vr(d);l({playlists:f});break}case"Singers":{const d=_e(yf,X("name",">=",u),X("name","<=",u+"")),f=await vf(d);l({singers:f});break}case"Users":{const d=_e(FV,X("display_name",">=",u),X("display_name","<=",u+"")),f=await $V(d);console.log(f),l({users:f});break}}}catch(u){console.log({message:u})}finally{e(!1)}};return m.useEffect(()=>(c(),()=>{e(!0)}),[s[0].get("q"),n]),m.useEffect(()=>()=>{r("Song")},[s[0].get("q")]),{isFetching:t,setIsFetching:e,tab:n,setTab:r,getResult:c,result:i,tabs:zW}}function HW(){const{isFetching:t,result:e,tab:n,setTab:r,tabs:s}=VW(),{handleSetSong:i}=ei({variant:"search-bar"}),{getRecommend:a}=Cw(),l=d=>{i(d.queue_id,[d]),a(d)},c=()=>{switch(n){case"Song":return fl;case"Playlist":return o.jsx("div",{className:"flex",children:tv})}},u=()=>{switch(n){case"Song":return e.songs.length?o.jsx(ti,{setSong:l,songs:e.songs}):o.jsx(Ke,{className:"mx-auto"});case"Playlist":return e.playlists.length?o.jsx(ml,{loading:!1,playlists:e.playlists}):o.jsx(Ke,{className:"mx-auto"});case"Singers":return e.singers.length?o.jsx("div",{className:"flex flex-row flex-wrap -mx-2 mt-3",children:e.singers.map((d,f)=>o.jsx(xx,{variant:"singer-item",singer:d},f))}):o.jsx(Ke,{className:"mx-auto"});case"Users":return e.users.length?o.jsx("div",{children:e.users.map(d=>o.jsxs("div",{className:"flex items-start",children:[o.jsx("div",{className:"w-[46px] h-[46px] rounded-full overflow-hidden",children:o.jsx(Xe,{src:d.photo_url})}),o.jsx(we,{to:`/user/${d.email}`,className:"font-semibold mt-3 md:mt-0 md:ml-3",children:d.display_name})]},d.email))}):o.jsx(Ke,{className:"mx-auto"})}};return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"mb-5",children:o.jsx(Sl,{})}),o.jsxs("div",{className:"flex items-center mt-3",children:[o.jsx("div",{className:"text-2xl font-bold",children:"Result"}),o.jsx("div",{className:`ml-5 ${t?"disable":""}`,children:o.jsx(xs,{tabs:s,render:d=>d,tab:n,setTab:r})})]}),o.jsx(ms,{children:o.jsxs("div",{className:"mt-5",children:[t&&c(),!t&&u()]})})]})}function WW(){const{theme:t}=q();return o.jsxs(an,{children:[o.jsx("h1",{className:`text-[30px] font-bold ${t.text_color}`,children:"Page Not found"}),o.jsx("p",{className:"text-center",children:o.jsx(we,{to:"/",className:`${t.content_bg} inline-block mt-5 text-center rounded-full px-5 py-1.5 cursor-pointer`,children:"Go home"})})]})}function qW(){const{theme:t}=q(),e=qt(),n=async()=>{await FC(za),e("/login")};return o.jsxs("div",{className:`${t.container} flex flex-col justify-center items-center min-h-screen`,children:[o.jsx("h1",{className:`text-[30px] font-bold border p-[10px] ${t.text_color}`,children:"Unauthorized"}),o.jsx(oe,{onClick:n,variant:"primary",className:`${t.content_bg} font-bold text-[20px]  text-[#fff] rounded-full mt-[20px]`,children:"Exit"})]})}function GW(){const[t]=Ev(za),{theme:e}=q(),{action:n}=zm(),r=qt(),s=async()=>{try{await n("login")}catch(i){console.log(i)}};return m.useEffect(()=>{if(t){r("/");return}},[]),o.jsxs("div",{className:`min-h-screen flex flex-col items-center justify-center ${e.container} ${e.text_color}`,children:[o.jsx(oe,{onClick:s,variant:"default",className:`${e.content_bg} font-bold text-[#fff] text-[30px] rounded-full`,children:"Login with google"})," "]})}function QW(){const[t,e]=m.useState(),[n,r]=m.useState(!0),[s,i]=m.useState([]),[a,l]=m.useState([]),[c,u]=m.useState([]);return{singer:t,setSinger:e,isFetching:n,setIsFetching:r,songs:s,setSongs:i,playlists:a,albums:c,setAlbums:u,setPlaylists:l}}const hA=m.createContext(null);function KW({children:t}){return o.jsx(hA.Provider,{value:QW(),children:t})}function ri(){const t=m.useContext(hA);if(!t)throw new Error("SingerProvider not provided");return t}let XW="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",YW=(t=21)=>{let e="",n=t|0;for(;n--;)e+=XW[Math.random()*64|0];return e};function JW(){const{setIsFetching:t,setSinger:e,setAlbums:n,isFetching:r,setSongs:s,singer:i,setPlaylists:a}=ri(),{setErrorToast:l}=ge(),c=qi(),u=m.useRef(!1),d=async()=>{try{if(!c.id)return;const f=await Ur({collectionName:"Singers",id:c.id});if(!f.exists())return;const p={...f.data(),id:c.id},g=_e(Nn,X(`singer_map.${p.id}`,"==",!0)),v=await Pn(g,{getQueueId:()=>YW(4)+"_"+p.id}),_=_e(wr,X(`singer_map.${p.id}`,"==",!0)),b=await Vr(_),E=[],w=[];b.forEach(S=>S.is_album?w.push(S):E.push(S)),s(v),e(p),a(E),n(w)}catch(f){console.log({error:f}),l()}finally{t(!1)}};return m.useEffect(()=>{u.current||(u.current=!0,d())},[]),{singer:i,isFetching:r}}function yg({onClick:t,children:e}){const{songs:n}=ri();return o.jsx(oe,{onClick:t,disabled:!n.length,size:"clear",color:"primary",className:"p-3",children:e})}function ZW(){const{songs:t,singer:e}=ri(),{playStatus:n}=se(Ln),{currentSongData:r}=se($e),{handleSetSong:s}=ei({variant:"playlist"}),{handlePlayPause:i}=ni(),a=()=>{const l=t[0];s(l.queue_id,t)};if(e&&r!=null&&r.song.queue_id.includes(e.id))switch(n){case"loading":case"paused":return o.jsx(yg,{onClick:i,children:o.jsx(L0,{className:"w-7"})});default:return o.jsx(yg,{onClick:i,children:o.jsx(TI,{className:"w-7"})})}else return o.jsx(yg,{onClick:a,children:o.jsx(L0,{className:"w-7"})})}function eq(){const{user:t,updateUserData:e}=he(),{setSingers:n}=Fn(),[r,s]=m.useState(!1);return{likeSinger:async({singer:a})=>{try{if(s(!0),!t)return;const l=zu(Pe),c=Ut(Pe,"Users",t.email),u=Ut(Pe,"Singers",a.id),d=[...t.liked_singer_ids],f=d.findIndex(_=>_===a.id),p=f===-1;p?d.unshift(a.id):d.splice(f,1);const g={liked_singer_ids:d},v={like:cu(p?1:-1)};l.update(c,g),l.update(u,v),await l.commit(),n(p?_=>[a,..._]:_=>_.filter(b=>b.id!==a.id)),e(g)}catch(l){console.log({error:l})}finally{s(!1)}},isFetching:r,user:t}}function tq(){const{theme:t}=q(),{singer:e}=ri(),{likeSinger:n,isFetching:r,user:s}=eq(),i=m.useMemo(()=>s&&e?s.liked_singer_ids.includes(e.id):!1,[s]);return e?o.jsx("button",{onClick:()=>n({singer:e}),className:`rounded-full p-2  ${i?t.content_bg:"bg-"+t.alpha}`,children:r?o.jsx(at,{className:"w-5 animate-spin"}):o.jsx(o.Fragment,{children:i?o.jsx(Su,{className:"w-5"}):o.jsx(dl,{className:"w-5"})})}):o.jsx(o.Fragment,{})}function nq(){const{theme:t}=q(),[e,n]=m.useState(""),r=m.useRef(null),{singer:s}=ri(),i=a=>{var l;n(a),(l=r.current)==null||l.open()};return o.jsxs(o.Fragment,{children:[o.jsx("button",{onClick:()=>i("more"),className:"text-sm ml-auto !mt-0",children:"See more"}),o.jsx("div",{className:"!mt-auto",children:o.jsxs("div",{className:"space-x-2 flex items-end",children:[o.jsx(ZW,{}),o.jsx(tq,{}),o.jsxs(pr,{children:[o.jsx(gr,{children:o.jsx("button",{className:`p-2 bg-${t.alpha} hover:brightness-95 rounded-full`,children:o.jsx(ul,{className:"w-5"})})}),o.jsx(xr,{appendTo:"parent",children:o.jsx(Js,{theme:t,p:"clear",className:"py-2",children:o.jsx(_l,{className:"w-[140px]",children:o.jsx(xw,{})})})})]})]})}),e&&o.jsx(Fe,{ref:r,variant:"animation",children:e==="more"&&s&&o.jsx("div",{className:"w-[400px] max-w-[calc(100vw-40px)]",children:s.description})})]})}function rq(){const{theme:t}=q(),{isFetching:e,singer:n}=ri();return!e&&!n?o.jsx(o.Fragment,{}):o.jsx(o.Fragment,{children:o.jsxs("div",{className:`md:flex bg-transparent relative z-0 pb-5 md:p-10 ${t.text_color} `,children:[o.jsx("div",{className:"absolute overflow-hidden -left-10 -top-[100px] -right-10 inset-0",children:o.jsxs("div",{className:"relative h-full w-full",children:[o.jsx("div",{className:`absolute z-[-5] inset-0 ${t.type==="light"?"bg-white/50":"bg-black/50"}  `}),o.jsx("img",{src:(n==null?void 0:n.image_url)||PI,className:"blur-[50px] absolute z-[-10] w-full h-full object-center object-cover"})]})}),o.jsx("div",{className:"w-[70%] z-0 relative mx-auto md:w-1/4 md:flex-shrink-0 md:m-unset",children:e?o.jsx(le,{className:"pt-[100%] "}):o.jsx(Eu,{children:o.jsx(Xe,{src:n==null?void 0:n.image_url,blurHashEncode:n==null?void 0:n.blurhash_encode})})}),o.jsx("div",{className:"flex-grow z-0 relative flex flex-col mt-5 space-y-2.5  md:mt-0 md:ml-5",children:e?o.jsxs(o.Fragment,{children:[o.jsx(le,{className:"h-[60px] w-full md:w-[200px]"}),o.jsx(le,{className:"h-[24px] w-[200px]"}),o.jsx(le,{className:"h-[120px] w-full md:w-[100%]"})]}):n&&o.jsxs(o.Fragment,{children:[o.jsx("p",{className:"text-3xl leading-[2] font-playwriteCU",children:n.name}),o.jsxs("p",{children:[o.jsx("span",{className:"text-red-500",children:" "}),_r(n.like)]}),o.jsx("p",{className:"line-clamp-2",children:n.description}),o.jsx(nq,{})]})})]})})}function sq(){const{handleSetSong:t}=ei({variant:"songs"}),{isFetching:e,songs:n}=ri();return o.jsx(o.Fragment,{children:o.jsxs("div",{children:[o.jsx(be,{title:"Popular Songs"}),o.jsx(ms,{children:e?fl:o.jsx(ti,{songs:n,setSong:r=>t(r.queue_id,[r])})})]})})}function iq(){const{isFetching:t,playlists:e}=ri();return o.jsx(o.Fragment,{children:o.jsxs("div",{children:[o.jsx(be,{title:"Popular Playlists"}),o.jsx(ml,{playlists:e,loading:t})]})})}function aq(){const{albums:t,isFetching:e}=ri();return o.jsxs(o.Fragment,{children:[o.jsx(be,{title:"Albums"}),o.jsx(ml,{playlists:t,loading:e})]})}function oq(){const{isFetching:t,singer:e}=JW();return!t&&!e?o.jsx(an,{children:o.jsx(Ke,{variant:"with-home-button"})}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"space-y-5",children:[o.jsx(Sl,{}),o.jsx(rq,{}),o.jsx(sq,{}),o.jsx(aq,{}),o.jsx(iq,{})]}),o.jsx(Yf,{})]})}function lq(){return o.jsx(KW,{children:o.jsx(oq,{})})}function cq(){const[t,e]=m.useState(),[n,r]=m.useState([]),[s,i]=m.useState(!0),{setErrorToast:a}=ge(),l=qi(),c=m.useRef(!1),u=async()=>{try{if(!l.id)return;const d=await Ur({collectionName:"Users",id:l.id});if(!d.exists())return;const f={...d.data()},p=_e(wr,X("owner_email","==",f.email),X("is_official","==",!1)),g=await Vr(p),v=[],_=[];g.forEach(b=>b.is_album?_.push(b):v.push(b)),r(v),e(f)}catch(d){console.log({error:d}),a()}finally{i(!1)}};return m.useEffect(()=>{c.current||(c.current=!0,u())},[]),{user:t,playlists:n,isFetching:s}}function uq(){const{playlists:t,isFetching:e,user:n}=cq();return!e&&!n?o.jsx(an,{children:o.jsx(Ke,{variant:"with-home-button"})}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"mb-5",children:o.jsx(Sl,{})}),o.jsxs("div",{className:"space-y-5",children:[o.jsxs("div",{className:"flex flex-col md:flex-row items-center",children:[e?o.jsx(le,{className:"w-[100px] h-[100px] rounded-full"}):n&&o.jsx("div",{className:"w-[100px] h-[100px] rounded-full overflow-hidden",children:o.jsx(Xe,{src:n.photo_url})}),o.jsx("div",{className:"text-center mt-3 md:mt-0 md:ml-3 md:text-left ",children:e?o.jsxs(o.Fragment,{children:[o.jsx(le,{className:"w-[300px] h-[30px]"}),o.jsx(le,{className:"w-[200px] h-[22px] mt-1"})]}):n&&o.jsxs(o.Fragment,{children:[o.jsx("p",{className:"font-semibold text-2xl",children:n.display_name}),o.jsxs("p",{className:"text-[#666]",children:["Last seen: ",JR(n.last_seen)]})]})})]}),o.jsxs("div",{children:[o.jsx(be,{title:"Playlists"}),o.jsx(ml,{loading:e,playlists:t})]})]})]})}function dq(){return o.jsx(o.Fragment,{children:o.jsx("div",{className:"",children:o.jsx("p",{children:"This is dashboard page"})})})}const hq=["All","Result"];function fq(){const{uploadedSongs:t,setUploadedSongs:e}=Fn(),[n,r]=m.useState(""),[s,i]=m.useState(!0),[a,l]=m.useState("All"),{setErrorToast:c}=ge(),u=async f=>{try{f.preventDefault(),i(!0);const p=vr(Pe,"Songs"),g=_e(p,X("name",">=",n),X("name","<=",n+""),X("is_official","==",!0)),v=await Pn(g);e(v),l("Result")}catch(p){console.log({message:p}),c()}finally{i(!1)}},d=async()=>{try{i(!0);const f=vr(Pe,"Songs"),p=_e(f,X("is_official","==",!0),hs("updated_at","desc")),g=await Pn(p);e(g)}catch(f){console.log({message:f}),c()}finally{i(!1)}};return m.useEffect(()=>{a==="All"&&d()},[a]),{isFetching:s,value:n,setValue:r,handleSubmit:u,uploadedSongs:t,tab:a,setTab:l,tabs:hq}}const hE=wu("inline-flex relative hover:brightness-95 space-x-1 items-center z-0",{variants:{variant:{primary:"before:content-[''] before:absolute before:z-[-1] before:inset-0 active:translate-y-[2px] active:before:shadow-none",clear:"before:content-none"},color:{primary:"before:border-[#4a826f] text-[#fff] bg-[#5a9e87] before:shadow-[0_2px_0_#4a826f]",second:"before:border-[#ccc] text-[#333] bg-[#f6f6f6] before:shadow-[0_2px_0_#ccc]",clear:""},size:{primary:"px-5 py-1.5",clear:""},fontWeight:{primary:"",clear:""},border:{primary:"before:border-[2px]",thin:"before:border-[1px]",clear:"before:border-b-[2px]"},rounded:{xl:"before:rounded-xl rounded-xl",lg:"before:rounded-lg rounded-lg",md:"before:rounded-md rounded-md"}},defaultVariants:{variant:"primary",color:"primary",size:"primary",fontWeight:"primary",border:"primary",rounded:"lg"}});function mq({onClick:t,loading:e,children:n,border:r,size:s,color:i,fontWeight:a,type:l="button",variant:c,disabled:u,rounded:d,className:f,active:p,href:g},v){const _=u||e,b="before:shadow-none translate-y-[2px]";return o.jsx(o.Fragment,{children:g?o.jsx(we,{to:g,className:`${hE({variant:c,size:s,color:i,fontWeight:a,rounded:d,border:r,className:f})} ${p?b:""}`,children:n}):o.jsx("button",{ref:v,type:l||"button",onClick:t,disabled:_,className:`${hE({variant:c,size:s,color:p?"primary":i,border:r,fontWeight:a,className:f})} ${p?b:""}`,children:e?o.jsx(at,{className:"w-6 animate-spin"}):n})})}const ue=m.forwardRef(mq),pq=wu("border-[2px] p-3 border-b-[6px] rounded-[14px]",{variants:{colors:{primary:"bg-white border-[#e1e1e1]",second:"bg-[#cee9b6] border-[#4a826f]",third:"bg-white border-[#4a826f]",clear:""}},defaultVariants:{colors:"primary"}});function yn({children:t,onClick:e,colors:n,className:r=""}){return o.jsx("div",{onClick:()=>e?e():{},className:`${pq({colors:n,className:r})} `,children:t})}function Hu({className:t=""}){return o.jsx("div",{className:`flex flex-grow items-center justify-center ${t}`,children:o.jsx(at,{className:"w-6 animate-spin"})})}function si({children:t}){return o.jsx("div",{className:"bg-white  overflow-hidden p-3 rounded-lg",children:t})}function Er({children:t,className:e="w-[400px]"}){return o.jsx("div",{className:`max-h-[80vh] max-w-[90vw] ${e}`,children:t})}function El({children:t,className:e=""}){const n=`mt-2 ml-2 flex px-3 py-1.5 text-sm rounded-lg bg-[#fff] border-[2px] border-[#e1e1e1] [&>div]:ml-1.5 [&>div]:pl-1.5 [&>div]:border [&>div]:border-transparent [&>div]:flex [&>div]:space-x-1 [&>div]:border-l-black/10 hover:[&_button]:scale-[1.05] ${e}`;return o.jsx("div",{className:n,children:t})}function gq({children:t,...e},n){return o.jsx(Fe,{variant:"animation",wrapped:!1,...e,ref:n,children:o.jsx(si,{children:t})})}const kr=m.forwardRef(gq);function kl({handleSubmit:t,setValue:e,value:n,className:r="",inputRef:s}){const i=a=>{a.preventDefault(),n.trim()&&t(a)};return o.jsx(yn,{className:r,children:o.jsxs("form",{onSubmit:i,className:"flex gap-2 justify-between items-center",children:[o.jsxs("div",{className:"relative flex-grow flex items-center text-[#333]",children:[o.jsx(Ht,{type:"text",ref:s,value:n,onChange:a=>e(a.target.value),placeholder:"..."}),n&&o.jsx("button",{type:"button",onClick:()=>{e("")},className:"absolute right-3",children:o.jsx(Gi,{className:"w-6"})})]}),o.jsx(ue,{type:"submit",size:"clear",className:"p-2 flex-shrink-0",children:o.jsx(Qy,{className:"w-6"})})]})})}function xq(){const[t,e]=m.useState(),[n,r]=m.useState(),[s,i]=m.useState([]);return{imageFile:n,setImageFile:r,playlist:t,setPlaylist:e,songs:s,setSongs:i,updatePlaylistData:l=>{t&&e({...t,...l})}}}const fA=m.createContext(null);function yq({children:t}){return o.jsx(fA.Provider,{value:xq(),children:t})}const Nw=()=>{const t=m.useContext(fA);if(!t)throw new Error("PlaylistProvider not provided");return t};function Um(){const{user:t}=he(),{playlist:e,songs:n,setSongs:r,updatePlaylistData:s}=Nw(),[i,a]=m.useState(!1),l=qt(),{setErrorToast:c,setSuccessToast:u}=ge(),d=async(p,g)=>{const v={};p.forEach(b=>v[b.id]=!0);const _={singers:p,singer_map:v};await kt({collectionName:"Playlists",id:g,data:_}),s(_)};return{isFetching:i,action:async p=>{try{if(!t)throw new Error("User not found");if(!e)throw new Error("playlist not found");switch(a(!0),p.variant){case"delete-playlist":{await Promise.all([Vu({collectionName:"Playlists",id:e.id}),e.image_file_path?An({filePath:e.image_file_path}):()=>{}]),l("/dashboard/playlist");break}case"add-songs":{const g=[...n,...p.songs],_={song_ids:g.map(b=>b.id)};await kt({collectionName:"Playlists",id:e.id,data:_,msg:">>> api: update playlist doc"}),s(_),r(g),u("Songs added");break}case"edit-playlist":{const g={...e,...p.playlist};if(p.imageFile){const v=await Ji({imageFile:p.imageFile});e.image_file_path&&await An({filePath:e.image_file_path}),Object.assign(g,v)}await kt({collectionName:"Playlists",data:g,id:e.id,msg:">>> api: set playlist doc"}),s(g),u("Playlist edited");break}case"remove-song":{const g=n.filter(_=>_.id!==p.song.id),v={song_ids:g.map(_=>_.id)};await kt({collectionName:"Playlists",id:e.id,data:v,msg:">>> api: update playlist doc"}),r(g),u(`'${p.song.name}' removed`);break}case"update-image":{const g={image_url:p.song.image_url,blurhash_encode:p.song.blurhash_encode,image_file_path:""};e.image_file_path&&await An({filePath:e.image_file_path}),await kt({collectionName:"Playlists",data:g,id:e.id,msg:">>> api: set playlist doc"}),s(g),u("Playlist edited;");break}case"remove-singer":{const g=e.singers.filter(v=>v.id!==p.singer.id);d(g,e.id),u("Singer removed");break}case"add-singer":{const g=[...e.singers];if(g.find(_=>_.id===p.singer.id))return;g.push(p.singer),d(g,e.id),u("Singer added");break}}}catch(g){console.log({message:g}),c("")}finally{a(!1)}},playlist:e}}function vq({song:t}){const{action:e,isFetching:n,playlist:r}=Um(),{close:s}=Sr(),i=m.useRef(null),a={overlay:"absolute flex items-center justify-center inset-0 bg-black/40"},l=()=>{var u;(u=i.current)==null||u.open(),s()},c=async u=>{var d;switch(u.variant){case"remove-song":await e({variant:"remove-song",song:u.song});break;case"update-image":await e({variant:"update-image",song:u.song});break;case"add-singer":await e({variant:"add-singer",singer:u.singer}),(d=i.current)==null||d.close()}s()};return o.jsxs(o.Fragment,{children:[o.jsxs(mA,{song:t,children:[o.jsxs("button",{onClick:()=>c({variant:"remove-song",song:t}),children:[o.jsx(Dn,{className:"w-5"}),o.jsx("span",{children:"Remove"})]}),o.jsxs("button",{onClick:l,children:[o.jsx(br,{className:"w-5"}),o.jsx("span",{children:"Add singer to playlist"})]}),t.image_url&&o.jsxs("button",{className:`${(r==null?void 0:r.image_url)===t.image_url?"disable":""}`,onClick:()=>c({variant:"update-image",song:t}),children:[o.jsx(hl,{className:"w-5"}),o.jsx("span",{children:"Set playlist image"})]}),n&&o.jsx("div",{className:a.overlay,children:o.jsx("div",{className:"h-[25px] w-[25px] border-[2px] border-r-black rounded-[50%] animate-spin"})})]}),o.jsx(kr,{ref:i,children:o.jsxs(Er,{children:[o.jsx(be,{title:"Singers"}),o.jsx("div",{className:"space-x-2 mt-3 [&>*]:px-3 [&>*]:py-1 [&>*]:rounded-md  [&>*]:bg-[#f1f1f1] hover:[&>*]:bg-black/10",children:t.singers.map((u,d)=>o.jsx("button",{onClick:()=>c({variant:"add-singer",singer:u}),children:u.name},d))})]})})]})}function wq(){const{setUploadedSongs:t,uploadedSongs:e}=Fn(),[n,r]=m.useState(!1),{setSuccessToast:s,setErrorToast:i}=ge();return{actions:async l=>{try{r(!0);const c=zu(Pe),u=Ut(Pe,"Songs",l.song.id);switch(l.variant){case"delete":{const d=e.filter(f=>f.id!==l.song.id);if(c.delete(u),l.song.lyric_id){const f=Ut(Pe,"Lyrics",l.song.lyric_id);c.delete(f)}await Promise.all([c.commit(),LR(l.song)]),t(d),s(`'${l.song.name}' deleted`);break}}}catch(c){console.log({message:c}),i()}finally{r(!1)}},isFetching:n}}function _q({song:t}){const{close:e}=Sr(),{actions:n,isFetching:r}=wq(),[s,i]=m.useState(""),a=m.useRef(null),l=()=>{var f;return(f=a.current)==null?void 0:f.close()},c=f=>{var p;i(f),e(),(p=a.current)==null||p.open()},u=async f=>{switch(f.variant){case"delete":await n({variant:"delete",song:t})}l()},d=()=>{switch(s){case"":return o.jsx(o.Fragment,{});case"edit":case"delete":return o.jsx(gs,{loading:r,label:`Delete '${t.name}' ?`,desc:"This action cannot be undone",callback:()=>u({variant:"delete",song:t}),close:l})}};return o.jsxs(o.Fragment,{children:[o.jsxs(mA,{song:t,children:[o.jsxs(we,{to:`/dashboard/song/${t.id}/edit`,children:[o.jsx(_u,{className:"w-5"}),o.jsx("span",{children:"Edit"})]}),o.jsxs(we,{to:`/dashboard/lyric/${t.id}`,children:[o.jsx(qy,{className:"w-5"}),o.jsx("span",{children:"Lyric"})]}),o.jsxs("button",{onClick:()=>c("delete"),children:[o.jsx(Dn,{className:"w-5"}),o.jsx("span",{children:"Delete"})]})]}),o.jsx(Fe,{ref:a,variant:"animation",children:d()})]})}function bq({song:t}){return o.jsx("div",{className:"px-2 mb-3",children:o.jsxs("div",{className:"p-3 bg-white/10 rounded-md flex",children:[o.jsx("div",{className:"w-[60px] h-[60px] flex-shrink-0 rounded overflow-hidden",children:o.jsx(Xe,{className:"object-cover h-full",src:t.image_url})}),o.jsxs("div",{className:"ml-2 text-sm",children:[o.jsx("h5",{className:"line-clamp-1 font-[500]",children:t.name}),o.jsx("h5",{className:"line-clamp-1 text-sm opacity-[.7]",children:t.singers.map((e,n)=>(n?", ":"")+e.name)})]})]})})}function mA({song:t,children:e}){const{theme:n}=q();return o.jsx(o.Fragment,{children:o.jsx(xr,{className:"w-[260px]",appendTo:"portal",children:o.jsxs(Js,{p:"clear",className:"py-2",theme:n,children:[o.jsx(bq,{song:t}),o.jsx(_l,{className:"hover:[&>*:not(div.absolute)]:bg-black/5",children:e}),o.jsxs("p",{className:"text-sm text-center opacity-70 mt-3",children:["Provided by ",t.distributor]})]})})})}function Sq({song:t,variant:e}){const n=()=>{switch(e){case"songs":return o.jsx(_q,{song:t});case"playlist":return o.jsx(vq,{song:t})}};return o.jsx(o.Fragment,{children:o.jsxs(pr,{appendOnPortal:!0,children:[o.jsx(gr,{children:o.jsx(ue,{size:"clear",color:"second",className:"p-1",children:o.jsx(ul,{className:"w-5"})})}),n()]})})}function pA({song:t,className:e="",variant:n}){return o.jsxs("tr",{className:e,children:[o.jsx("td",{children:o.jsx(we,{to:`/dashboard/song/${t.id}/edit`,className:"hover:underline",children:t.name})}),o.jsx("td",{children:t.singers.map((r,s)=>o.jsxs(we,{className:"hover:underline",to:`/dashboard/singer/${r.id}`,children:[!!s&&", ",r.name]},s))}),o.jsx("td",{children:_r(t.like)}),o.jsx("td",{children:o.jsx(Sq,{variant:n,song:t})})]})}function gA({value:t,setValue:e,inputRef:n}){return o.jsxs(yn,{className:"flex gap-2 justify-between items-center",children:[o.jsx(Ht,{ref:n,value:t,onChange:r=>e(r.target.value),placeholder:"..."}),o.jsx(ue,{onClick:()=>t?e(""):{},size:"clear",className:"p-2 flex-shrink-0",children:t?o.jsx(Gi,{className:"w-6"}):o.jsx(Qy,{className:"w-6"})})]})}function ea({className:t="",children:e,...n}){return o.jsx(yn,{children:o.jsx("div",{className:"rounded-md overflow-hidden",children:o.jsx(FI,{className:`[&_td]:text-sm hover:[&_tr]:bg-black/5 [&_tbody_tr]:border-t [&_tr]:border-black/5 [&_th]:text-sm [&_th]:text-left [&_td]:p-2 [&_th]:p-2 ${t}`,...n,children:e})})})}function Eq(){const{isFetching:t,uploadedSongs:e,tabs:n,setTab:r,tab:s,...i}=fq();return o.jsxs("div",{className:"pb-[46px]",children:[o.jsx(be,{title:"Songs"}),o.jsxs("div",{className:"flex justify-between items-start mt-3",children:[o.jsx(kl,{...i}),o.jsxs(ue,{href:"/dashboard/song/add-song",className:"p-1.5 ml-5",size:"clear",children:[o.jsx(ps,{className:"w-6"}),o.jsx("div",{className:"hidden md:block",children:"Add song"})]})]}),o.jsx("div",{className:`mt-5 w-fit ${s==="All"?"pointer-events-none":""} self-start`,children:o.jsx(xs,{tabs:n,render:a=>a,tab:s,setTab:r})}),o.jsxs("div",{className:"mt-3",children:[t&&o.jsx(le,{className:"h-[200px] rounded-xl"}),!t&&o.jsx(ea,{colList:["Name","Singer","Like"],children:e.length?e.map((a,l)=>o.jsx(pA,{variant:"songs",song:a},l)):o.jsx("tr",{children:o.jsx("td",{colSpan:3,className:"text-center",children:o.jsx(Ke,{})})})})]})]})}function kq(){const[t,e]=m.useState(),[n,r]=m.useState(),[s,i]=m.useState([]),[a,l]=m.useState([]),[c,u]=m.useState(),[d,f]=m.useState(),[p,g]=m.useState(),v=m.useRef("add");return{imageFile:c,setImageFile:u,songFile:t,setSongFile:e,songData:n,song:d,setSong:f,variant:v,setSongData:r,updateSongData:S=>{n&&r({...n,...S})},singers:s,setSingers:i,setGenres:l,genres:a,selectGenre:S=>{const I=[...a],F=I.findIndex(D=>D.id===S.id);F===-1?I.push(S):I.splice(F,1),l(I)},selectSinger:S=>{const I=[...s],F=I.findIndex(D=>D.id===S.id);F===-1?I.push(S):I.splice(F,1),i(I)},imageBlob:p,setImageBlob:g,resetAddSongContext:S=>{e(void 0),r(S),i([]),l([])}}}const xA=m.createContext(null);function Tq({children:t}){return o.jsx(xA.Provider,{value:kq(),children:t})}const Za=()=>{const t=m.useContext(xA);if(!t)throw new Error("AddSongProvider not provided");return t};function yA(){const{setSongFile:t}=Za(),e=m.useRef(null),n=r=>{var s;(s=r.target.files)!=null&&s.length&&t(r.target.files[0])};return o.jsxs(o.Fragment,{children:[o.jsx("input",{ref:e,onChange:n,type:"file",multiple:!0,accept:"audio",id:"song_upload",className:"hidden"}),o.jsx(ue,{className:"",size:"clear",children:o.jsx("label",{htmlFor:"song_upload",className:"inline-flex p-1.5 cursor-pointer",children:o.jsx(By,{className:"w-6"})})})]})}function Iq(){const[t,e]=m.useState([]),n=m.useRef(!0);return{genres:t,shouldFetchGenre:n,setGenres:e}}const vA=m.createContext(null);function Cq({children:t}){return o.jsx(vA.Provider,{value:Iq(),children:t})}const Pw=()=>{const t=m.useContext(vA);if(!t)throw new Error("GenreProvider is not provided");return t};function wA(){const{setGenres:t,genres:e}=Pw(),{setErrorToast:n,setSuccessToast:r}=ge(),[s,i]=m.useState(!1);return{isFetching:s,action:async l=>{try{switch(i(!0),l.type){case"add":{if(e.find(f=>f.name===l.name))return await zs(100),n("Genre already exist");const u=await Qs({collectionName:"Genres",data:{name:l.name}}),d={name:l.name,id:u.id};return t(f=>[d,...f]),i(!1),r("Add genre successful"),d}case"edit":{await kt({collectionName:"Genres",data:{name:l.name},id:l.id});const c=[...e],u=c.findIndex(f=>f.id===l.id),d={...e[u]};Object.assign(d,{name:l.name}),c[u]=d,t(c),r("Edit genre successful");break}case"delete":{await Vu({collectionName:"Genres",id:l.id}),t(c=>c.filter(u=>u.id!==l.id)),r("Delete genre successful");break}}}catch{}finally{i(!1)}}}}function _A(){const{genres:t,setGenres:e,shouldFetchGenre:n}=Pw(),[r,s]=m.useState(!0);return{api:async()=>{try{if(n.current){n.current=!1;const a=vr(Pe,"Genres"),l=_e(a);console.log(">>> fetch genres");const c=await Yi(l);if(c.docs){const u=c.docs.map(d=>({...d.data(),id:d.id}));e(u)}}else await zs(100)}catch(a){console.log(a)}finally{s(!1)}},isFetching:r,setIsFetching:s,genres:t,shouldFetchGenre:n}}function bA(){const{genres:t}=Pw(),[e,n]=m.useState(""),r=zR(e,800),s=m.useMemo(()=>r?t.filter(i=>i.name.includes(r)):t,[r,t]);return{value:e,setValue:n,_genres:s}}function jq({afterSearched:t=()=>{}}){const[e,n]=m.useState(""),[r,s]=m.useState(!1),[i,a]=m.useState(!1),[l,c]=m.useState([]),{setErrorToast:u}=ge();return{value:e,isShowResult:i,setValue:n,result:l,handleSubmit:async f=>{try{f.preventDefault(),f.stopPropagation(),s(!0),a(!0);const p=vr(Pe,"Singers"),g=_e(p,X("name",">=",e),X("name","<=",e+"")),v=await Yi(g);if(v.docs){const _=v.docs.map(b=>({...b.data(),id:b.id}));c(_),t()}}catch(p){console.log({message:p}),u()}finally{s(!1)}},isFetching:r}}function Rq(){const{setSuccessToast:t,setErrorToast:e}=ge(),[n,r]=m.useState(!1);return{isFetching:n,addSinger:async({data:i})=>{try{r(!0);const a=await Qs({collectionName:"Singers",data:i}),c={...(await $a(a)).data(),id:a.id};return r(!1),t("Add singer successful"),c}catch(a){console.log({error:a}),e()}finally{r(!1)}}}}function Aq({closeModal:t,afterSubmit:e,singerName:n}){const[r,s]=m.useState(wf({name:n})),{addSinger:i,isFetching:a}=Rq(),l=r.name,c=(f,p)=>{s({...r,[f]:p.trim()})},u=async()=>{const f=await i({data:r});f&&e&&e(f),t()},d={inputGroup:"gap-1",input:"p-2 bg-[#f1f1f1] border border-black/20 rounded-lg",label:"text-[#3f3f3f] text-lg"};return o.jsxs(si,{className:"w-[450px]",children:[o.jsx(Ct,{close:t,title:"Add singer"}),o.jsx("div",{className:"space-y-3 overflow-auto",children:o.jsxs("div",{className:d.inputGroup,children:[o.jsx("label",{className:d.label,children:"Customer name:"}),o.jsx(Ht,{value:r.name,onChange:f=>c("name",f.target.value),placeholder:"Enter name...",className:d.input})]})}),o.jsx("div",{className:"text-center mt-5",children:o.jsxs(ue,{disabled:!l,loading:a,onClick:()=>l&&u(),children:[o.jsx(bu,{className:"w-6"}),o.jsx("p",{className:"text-white",children:"Ok"})]})})]})}function Fw({choose:t,closeModal:e}){const{result:n,isShowResult:r,isFetching:s,...i}=jq({}),a=m.useRef(null),l=()=>{var c;return(c=a.current)==null?void 0:c.close()};return o.jsxs(o.Fragment,{children:[o.jsxs(Er,{children:[o.jsx(Ct,{title:"Singers",close:e}),o.jsx(kl,{...i}),o.jsx("div",{className:"h-[40vh] mt-3 space-y-1.5 overflow-auto",children:r&&(s?o.jsx(Hu,{className:"h-full"}):o.jsx(o.Fragment,{children:n.length?n.map((c,u)=>o.jsx(yn,{onClick:()=>t(c),children:o.jsx("p",{className:"text-lg",children:c.name})},u)):o.jsx(o.Fragment,{children:o.jsx(Ke,{})})}))}),o.jsx("p",{className:"text-center mt-auto",children:o.jsxs(ue,{onClick:()=>{var c;return(c=a.current)==null?void 0:c.open()},children:[o.jsx(ps,{className:"w-6"}),o.jsx("span",{children:"Add new singer"})]})})]}),o.jsx(Fe,{ref:a,wrapped:!1,variant:"animation",children:o.jsx(Aq,{afterSubmit:t,singerName:i.value,closeModal:l})})]})}function Nq(){const{singers:t,selectSinger:e}=Za(),n=m.useRef(null),r=()=>{var i;return(i=n.current)==null?void 0:i.close()},s=i=>{e(i),r()};return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"",children:[o.jsxs("div",{className:"flex space-x-2 items-center",children:[o.jsx(be,{title:"Singer"}),o.jsx(ue,{onClick:()=>{var i;return(i=n.current)==null?void 0:i.open()},className:"p-1.5",size:"clear",children:o.jsx(ps,{className:"w-6"})})]}),o.jsx(yn,{className:" mt-1",children:o.jsx("div",{className:"flex flex-wrap -ml-2 -mt-2",children:t.length?t.map((i,a)=>o.jsxs(El,{children:[o.jsx("span",{children:i.name}),o.jsx("div",{className:"flex",children:o.jsx("button",{onClick:()=>e(i),children:o.jsx(Dn,{className:"w-5"})})})]},a)):"..."})})]}),o.jsx(kr,{ref:n,children:o.jsx(Fw,{closeModal:r,choose:s})})]})}function Pq({audioEle:t,variant:e}){const n=m.useRef(null),{status:r,handlePlayPause:s}=ww({audioEle:t,baseColor:"rgba(0,0,0,.10)",color:"#5a9e87",progressLineRef:n}),i=()=>{switch(r){case"error":return o.jsx(om,{className:"w-6"});case"playing":return o.jsx(cm,{className:"w-6"});case"paused":return o.jsx(Qc,{className:"w-6"});case"waiting":return o.jsx(at,{className:"w-6 animate-spin"})}};return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex items-end justify-between",children:[o.jsx(ue,{className:"p-1.5",size:"clear",onClick:s,children:i()}),e==="add"&&o.jsx(yA,{})]}),o.jsx("div",{style:{backgroundColor:"rgab(0,0,0,.05)"},ref:n,className:"h-1 rounded-full mt-3 w-full"})]})}function Dw({closeModal:t,afterSubmit:e,...n}){const[r,s]=m.useState(n.type==="add"?n.genreName||"":n.genre.name),{action:i,isFetching:a}=wA(),{setErrorToast:l}=ge(),c=m.useRef(null),u=!!r,d=async()=>{try{switch(n.type){case"add":const g=await i({type:"add",name:r});g&&e&&e(g);break;case"edit":await i({type:"edit",name:r,id:n.genre.id});break}}catch(g){console.log(g),l()}finally{t()}},f={inputGroup:"gap-1",input:"p-2 bg-[#f1f1f1] border border-black/20 rounded-lg",label:"text-[#3f3f3f] text-lg"};m.useEffect(()=>{var g;(g=c.current)==null||g.focus()},[]);const p=n.type==="edit"?`Edit '${n.genre.name}'`:"Add genre";return o.jsxs(si,{className:"w-[450px]",children:[o.jsx(Ct,{close:t,title:p}),o.jsx("div",{className:"space-y-3 overflow-auto",children:o.jsxs("div",{className:f.inputGroup,children:[o.jsx("label",{className:f.label,children:"Genre name:"}),o.jsx(Ht,{ref:c,value:r,onChange:g=>s(g.target.value),placeholder:"Enter name...",className:f.input})]})}),o.jsx("div",{className:"text-center mt-5",children:o.jsxs(ue,{disabled:!u,loading:a,onClick:()=>u&&d(),children:[o.jsx(bu,{className:"w-6"}),o.jsx("p",{className:"text-white",children:"Ok"})]})})]})}function Fq({closeModal:t,choose:e}){const{_genres:n,...r}=bA(),s=m.useRef(null),i=m.useRef(null),a=()=>{var u;return(u=s.current)==null?void 0:u.close()},{api:l,isFetching:c}=_A();return m.useEffect(()=>{var u;l(),(u=i.current)==null||u.focus()},[]),o.jsxs(o.Fragment,{children:[o.jsxs(Er,{children:[o.jsx(Ct,{title:"Genre",close:t}),o.jsx(gA,{inputRef:i,...r}),o.jsx("div",{className:"h-[40vh] mt-3 space-y-1.5 overflow-auto",children:c?o.jsx(Hu,{className:"h-full"}):o.jsx(o.Fragment,{children:n.length?n.map((u,d)=>o.jsx(yn,{onClick:()=>e(u),children:o.jsx("p",{className:"text-lg",children:u.name})},d)):o.jsx(o.Fragment,{children:o.jsx(Ke,{})})})}),o.jsx("p",{className:"text-center mt-auto",children:o.jsxs(ue,{onClick:()=>{var u;return(u=s.current)==null?void 0:u.open()},children:[o.jsx(br,{className:"w-6"}),o.jsx("span",{children:"Add new genre"})]})})]}),o.jsx(Fe,{ref:s,wrapped:!1,variant:"animation",children:o.jsx(Dw,{afterSubmit:e,genreName:r.value,type:"add",closeModal:a})})]})}function Dq(){const{genres:t,selectGenre:e}=Za(),n=m.useRef(null),r=i=>{e(i),s()},s=()=>{var i;return(i=n.current)==null?void 0:i.close()};return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"",children:[o.jsxs("div",{className:"flex space-x-2 items-center",children:[o.jsx(be,{title:"Genre"}),o.jsx(ue,{onClick:()=>{var i;return(i=n.current)==null?void 0:i.open()},className:"p-1.5",size:"clear",children:o.jsx(ps,{className:"w-6"})})]}),o.jsx(yn,{className:"mt-1",children:o.jsx("div",{className:"flex flex-wrap -ml-2 -mt-2",children:t.length?t.map((i,a)=>o.jsxs(El,{children:[o.jsx("span",{children:i.name}),o.jsx("div",{children:o.jsx("button",{onClick:()=>e(i),children:o.jsx(Dn,{className:"w-5"})})})]},a)):"..."})})]}),o.jsx(kr,{ref:n,children:o.jsx(Fq,{closeModal:s,choose:r})})]})}const Lq="End-Of-Stream";class pt extends Error{constructor(){super(Lq)}}class Mq{constructor(){this.maxStreamReadSize=1*1024*1024,this.endOfStream=!1,this.peekQueue=[]}async peek(e,n,r){const s=await this.read(e,n,r);return this.peekQueue.push(e.subarray(n,n+s)),s}async read(e,n,r){if(r===0)return 0;let s=this.readFromPeekBuffer(e,n,r);if(s+=await this.readRemainderFromStream(e,n+s,r-s),s===0)throw new pt;return s}readFromPeekBuffer(e,n,r){let s=r,i=0;for(;this.peekQueue.length>0&&s>0;){const a=this.peekQueue.pop();if(!a)throw new Error("peekData should be defined");const l=Math.min(a.length,s);e.set(a.subarray(0,l),n+i),i+=l,s-=l,l<a.length&&this.peekQueue.push(a.subarray(l))}return i}async readRemainderFromStream(e,n,r){let s=r,i=0;for(;s>0&&!this.endOfStream;){const a=Math.min(s,this.maxStreamReadSize),l=await this.readFromStream(e,n+i,a);if(l===0)break;i+=l,s-=l}return i}}class Oq extends Mq{constructor(e){super(),this.reader=e.getReader({mode:"byob"})}async readFromStream(e,n,r){if(this.endOfStream)throw new pt;const s=await this.reader.read(new Uint8Array(r));return s.done&&(this.endOfStream=s.done),s.value?(e.set(s.value,n),s.value.byteLength):0}}class SA{constructor(e){this.position=0,this.numBuffer=new Uint8Array(8),this.fileInfo=(e==null?void 0:e.fileInfo)??{},this.onClose=e==null?void 0:e.onClose}async readToken(e,n=this.position){const r=new Uint8Array(e.len);if(await this.readBuffer(r,{position:n})<e.len)throw new pt;return e.get(r,0)}async peekToken(e,n=this.position){const r=new Uint8Array(e.len);if(await this.peekBuffer(r,{position:n})<e.len)throw new pt;return e.get(r,0)}async readNumber(e){if(await this.readBuffer(this.numBuffer,{length:e.len})<e.len)throw new pt;return e.get(this.numBuffer,0)}async peekNumber(e){if(await this.peekBuffer(this.numBuffer,{length:e.len})<e.len)throw new pt;return e.get(this.numBuffer,0)}async ignore(e){if(this.fileInfo.size!==void 0){const n=this.fileInfo.size-this.position;if(e>n)return this.position+=n,n}return this.position+=e,e}async close(){var e;await((e=this.onClose)==null?void 0:e.call(this))}normalizeOptions(e,n){if(n&&n.position!==void 0&&n.position<this.position)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");return n?{mayBeLess:n.mayBeLess===!0,offset:n.offset?n.offset:0,length:n.length?n.length:e.length-(n.offset?n.offset:0),position:n.position?n.position:this.position}:{mayBeLess:!1,offset:0,length:e.length,position:this.position}}}const $q=256e3;class Bq extends SA{constructor(e,n){super(n),this.streamReader=e}async readBuffer(e,n){const r=this.normalizeOptions(e,n),s=r.position-this.position;if(s>0)return await this.ignore(s),this.readBuffer(e,n);if(s<0)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");if(r.length===0)return 0;const i=await this.streamReader.read(e,r.offset,r.length);if(this.position+=i,(!n||!n.mayBeLess)&&i<r.length)throw new pt;return i}async peekBuffer(e,n){const r=this.normalizeOptions(e,n);let s=0;if(r.position){const i=r.position-this.position;if(i>0){const a=new Uint8Array(r.length+i);return s=await this.peekBuffer(a,{mayBeLess:r.mayBeLess}),e.set(a.subarray(i),r.offset),s-i}if(i<0)throw new Error("Cannot peek from a negative offset in a stream")}if(r.length>0){try{s=await this.streamReader.peek(e,r.offset,r.length)}catch(i){if(n!=null&&n.mayBeLess&&i instanceof pt)return 0;throw i}if(!r.mayBeLess&&s<r.length)throw new pt}return s}async ignore(e){const n=Math.min($q,e),r=new Uint8Array(n);let s=0;for(;s<e;){const i=e-s,a=await this.readBuffer(r,{length:Math.min(n,i)});if(a<0)return a;s+=a}return s}}class zq extends SA{constructor(e,n){super(n),this.uint8Array=e,this.fileInfo.size=this.fileInfo.size?this.fileInfo.size:e.length}async readBuffer(e,n){if(n!=null&&n.position){if(n.position<this.position)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");this.position=n.position}const r=await this.peekBuffer(e,n);return this.position+=r,r}async peekBuffer(e,n){const r=this.normalizeOptions(e,n),s=Math.min(this.uint8Array.length-r.position,r.length);if(!r.mayBeLess&&s<r.length)throw new pt;return e.set(this.uint8Array.subarray(r.position,r.position+s),r.offset),s}close(){return super.close()}}function EA(t,e){return new Bq(new Oq(t),e)}function tl(t,e){return new zq(t,e)}/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */var Vm=function(t,e,n,r,s){var i,a,l=s*8-r-1,c=(1<<l)-1,u=c>>1,d=-7,f=n?s-1:0,p=n?-1:1,g=t[e+f];for(f+=p,i=g&(1<<-d)-1,g>>=-d,d+=l;d>0;i=i*256+t[e+f],f+=p,d-=8);for(a=i&(1<<-d)-1,i>>=-d,d+=r;d>0;a=a*256+t[e+f],f+=p,d-=8);if(i===0)i=1-u;else{if(i===c)return a?NaN:(g?-1:1)*(1/0);a=a+Math.pow(2,r),i=i-u}return(g?-1:1)*a*Math.pow(2,i-r)},Hm=function(t,e,n,r,s,i){var a,l,c,u=i*8-s-1,d=(1<<u)-1,f=d>>1,p=s===23?Math.pow(2,-24)-Math.pow(2,-77):0,g=r?0:i-1,v=r?1:-1,_=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(l=isNaN(e)?1:0,a=d):(a=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-a))<1&&(a--,c*=2),a+f>=1?e+=p/c:e+=p*Math.pow(2,1-f),e*c>=2&&(a++,c/=2),a+f>=d?(l=0,a=d):a+f>=1?(l=(e*c-1)*Math.pow(2,s),a=a+f):(l=e*Math.pow(2,f-1)*Math.pow(2,s),a=0));s>=8;t[n+g]=l&255,g+=v,l/=256,s-=8);for(a=a<<s|l,u+=s;u>0;t[n+g]=a&255,g+=v,a/=256,u-=8);t[n+g-v]|=_*128};function me(t){return new DataView(t.buffer,t.byteOffset)}const pe={len:1,get(t,e){return me(t).getUint8(e)},put(t,e,n){return me(t).setUint8(e,n),e+1}},De={len:2,get(t,e){return me(t).getUint16(e,!0)},put(t,e,n){return me(t).setUint16(e,n,!0),e+2}},Oe={len:2,get(t,e){return me(t).getUint16(e)},put(t,e,n){return me(t).setUint16(e,n),e+2}},_f={len:3,get(t,e){const n=me(t);return n.getUint8(e)+(n.getUint16(e+1,!0)<<8)},put(t,e,n){const r=me(t);return r.setUint8(e,n&255),r.setUint16(e+1,n>>8,!0),e+3}},vn={len:3,get(t,e){const n=me(t);return(n.getUint16(e)<<8)+n.getUint8(e+2)},put(t,e,n){const r=me(t);return r.setUint16(e,n>>8),r.setUint8(e+2,n&255),e+3}},J={len:4,get(t,e){return me(t).getUint32(e,!0)},put(t,e,n){return me(t).setUint32(e,n,!0),e+4}},re={len:4,get(t,e){return me(t).getUint32(e)},put(t,e,n){return me(t).setUint32(e,n),e+4}},uu={len:1,get(t,e){return me(t).getInt8(e)},put(t,e,n){return me(t).setInt8(e,n),e+1}},Ns={len:2,get(t,e){return me(t).getInt16(e)},put(t,e,n){return me(t).setInt16(e,n),e+2}},Uq={len:2,get(t,e){return me(t).getInt16(e,!0)},put(t,e,n){return me(t).setInt16(e,n,!0),e+2}},Vq={len:3,get(t,e){const n=_f.get(t,e);return n>8388607?n-16777216:n},put(t,e,n){const r=me(t);return r.setUint8(e,n&255),r.setUint16(e+1,n>>8,!0),e+3}},Lw={len:3,get(t,e){const n=vn.get(t,e);return n>8388607?n-16777216:n},put(t,e,n){const r=me(t);return r.setUint16(e,n>>8),r.setUint8(e+2,n&255),e+3}},Yn={len:4,get(t,e){return me(t).getInt32(e)},put(t,e,n){return me(t).setInt32(e,n),e+4}},ht={len:4,get(t,e){return me(t).getInt32(e,!0)},put(t,e,n){return me(t).setInt32(e,n,!0),e+4}},mn={len:8,get(t,e){return me(t).getBigUint64(e,!0)},put(t,e,n){return me(t).setBigUint64(e,n,!0),e+8}},bf={len:8,get(t,e){return me(t).getBigInt64(e,!0)},put(t,e,n){return me(t).setBigInt64(e,n,!0),e+8}},Mw={len:8,get(t,e){return me(t).getBigUint64(e)},put(t,e,n){return me(t).setBigUint64(e,n),e+8}},kA={len:8,get(t,e){return me(t).getBigInt64(e)},put(t,e,n){return me(t).setBigInt64(e,n),e+8}},Hq={len:2,get(t,e){return Vm(t,e,!1,10,this.len)},put(t,e,n){return Hm(t,n,e,!1,10,this.len),e+this.len}},Wq={len:2,get(t,e){return Vm(t,e,!0,10,this.len)},put(t,e,n){return Hm(t,n,e,!0,10,this.len),e+this.len}},TA={len:4,get(t,e){return me(t).getFloat32(e)},put(t,e,n){return me(t).setFloat32(e,n),e+4}},qq={len:4,get(t,e){return me(t).getFloat32(e,!0)},put(t,e,n){return me(t).setFloat32(e,n,!0),e+4}},_x={len:8,get(t,e){return me(t).getFloat64(e)},put(t,e,n){return me(t).setFloat64(e,n),e+8}},Gq={len:8,get(t,e){return me(t).getFloat64(e,!0)},put(t,e,n){return me(t).setFloat64(e,n,!0),e+8}},Qq={len:10,get(t,e){return Vm(t,e,!1,63,this.len)},put(t,e,n){return Hm(t,n,e,!1,63,this.len),e+this.len}},Kq={len:10,get(t,e){return Vm(t,e,!0,63,this.len)},put(t,e,n){return Hm(t,n,e,!0,63,this.len),e+this.len}};class Xq{constructor(e){this.len=e}get(e,n){}}class Sn{constructor(e){this.len=e}get(e,n){return e.subarray(n,n+this.len)}}class ne{constructor(e,n){this.len=e,this.encoding=n,this.textDecoder=new TextDecoder(n)}get(e,n){return this.textDecoder.decode(e.subarray(n,n+this.len))}}class Yq{constructor(e){this.len=e,this.textDecoder=new TextDecoder("windows-1252")}get(e,n=0){return this.textDecoder.decode(e.subarray(n,n+this.len))}}const Jq=Object.freeze(Object.defineProperty({__proto__:null,AnsiStringType:Yq,Float16_BE:Hq,Float16_LE:Wq,Float32_BE:TA,Float32_LE:qq,Float64_BE:_x,Float64_LE:Gq,Float80_BE:Qq,Float80_LE:Kq,INT16_BE:Ns,INT16_LE:Uq,INT24_BE:Lw,INT24_LE:Vq,INT32_BE:Yn,INT32_LE:ht,INT64_BE:kA,INT64_LE:bf,INT8:uu,IgnoreType:Xq,StringType:ne,UINT16_BE:Oe,UINT16_LE:De,UINT24_BE:vn,UINT24_LE:_f,UINT32_BE:re,UINT32_LE:J,UINT64_BE:Mw,UINT64_LE:mn,UINT8:pe,Uint8ArrayType:Sn},Symbol.toStringTag,{value:"Module"})),Zq=Object.prototype.toString,eG="[object Uint8Array]",tG="[object ArrayBuffer]";function IA(t,e,n){return t?t.constructor===e?!0:Zq.call(t)===n:!1}function CA(t){return IA(t,Uint8Array,eG)}function nG(t){return IA(t,ArrayBuffer,tG)}function rG(t){return CA(t)||nG(t)}function sG(t){if(!CA(t))throw new TypeError(`Expected \`Uint8Array\`, got \`${typeof t}\``)}function iG(t){if(!rG(t))throw new TypeError(`Expected \`Uint8Array\` or \`ArrayBuffer\`, got \`${typeof t}\``)}const Ld={utf8:new globalThis.TextDecoder("utf8")};function Ow(t,e="utf8"){return iG(t),Ld[e]??(Ld[e]=new globalThis.TextDecoder(e)),Ld[e].decode(t)}function jA(t){if(typeof t!="string")throw new TypeError(`Expected \`string\`, got \`${typeof t}\``)}const aG=new globalThis.TextEncoder;function oG(t){return jA(t),aG.encode(t)}const lG=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function $w(t){sG(t);let e="";for(let n=0;n<t.length;n++)e+=lG[t[n]];return e}const fE={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,a:10,b:11,c:12,d:13,e:14,f:15,A:10,B:11,C:12,D:13,E:14,F:15};function mE(t){if(jA(t),t.length%2!==0)throw new Error("Invalid Hex string length.");const e=t.length/2,n=new Uint8Array(e);for(let r=0;r<e;r++){const s=fE[t[r*2]],i=fE[t[r*2+1]];if(s===void 0||i===void 0)throw new Error(`Invalid Hex character encountered at position ${r*2}`);n[r]=s<<4|i}return n}function pE(t){const{byteLength:e}=t;if(e===6)return t.getUint16(0)*2**32+t.getUint32(2);if(e===5)return t.getUint8(0)*2**32+t.getUint32(1);if(e===4)return t.getUint32(0);if(e===3)return t.getUint8(0)*2**16+t.getUint16(1);if(e===2)return t.getUint16(0);if(e===1)return t.getUint8(0)}function RA(t,e){const n=t.length,r=e.length;if(r===0||r>n)return-1;const s=n-r;for(let i=0;i<=s;i++){let a=!0;for(let l=0;l<r;l++)if(t[i+l]!==e[l]){a=!1;break}if(a)return i}return-1}function cG(t,e){return RA(t,e)!==-1}function uG(t){return[...t].map(e=>e.charCodeAt(0))}function dG(t,e=0){const n=Number.parseInt(new ne(6).get(t,148).replace(/\0.*$/,"").trim(),8);if(Number.isNaN(n))return!1;let r=8*32;for(let s=e;s<e+148;s++)r+=t[s];for(let s=e+156;s<e+512;s++)r+=t[s];return n===r}const hG={get:(t,e)=>t[e+3]&127|t[e+2]<<7|t[e+1]<<14|t[e]<<21,len:4},fG=["jpg","png","apng","gif","webp","flif","xcf","cr2","cr3","orf","arw","dng","nef","rw2","raf","tif","bmp","icns","jxr","psd","indd","zip","tar","rar","gz","bz2","7z","dmg","mp4","mid","mkv","webm","mov","avi","mpg","mp2","mp3","m4a","oga","ogg","ogv","opus","flac","wav","spx","amr","pdf","epub","elf","macho","exe","swf","rtf","wasm","woff","woff2","eot","ttf","otf","ico","flv","ps","xz","sqlite","nes","crx","xpi","cab","deb","ar","rpm","Z","lz","cfb","mxf","mts","blend","bpg","docx","pptx","xlsx","3gp","3g2","j2c","jp2","jpm","jpx","mj2","aif","qcp","odt","ods","odp","xml","mobi","heic","cur","ktx","ape","wv","dcm","ics","glb","pcap","dsf","lnk","alias","voc","ac3","m4v","m4p","m4b","f4v","f4p","f4b","f4a","mie","asf","ogm","ogx","mpc","arrow","shp","aac","mp1","it","s3m","xm","ai","skp","avif","eps","lzh","pgp","asar","stl","chm","3mf","zst","jxl","vcf","jls","pst","dwg","parquet","class","arj","cpio","ace","avro","icc","fbx","vsdx"],mG=["image/jpeg","image/png","image/gif","image/webp","image/flif","image/x-xcf","image/x-canon-cr2","image/x-canon-cr3","image/tiff","image/bmp","image/vnd.ms-photo","image/vnd.adobe.photoshop","application/x-indesign","application/epub+zip","application/x-xpinstall","application/vnd.oasis.opendocument.text","application/vnd.oasis.opendocument.spreadsheet","application/vnd.oasis.opendocument.presentation","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/zip","application/x-tar","application/x-rar-compressed","application/gzip","application/x-bzip2","application/x-7z-compressed","application/x-apple-diskimage","application/x-apache-arrow","video/mp4","audio/midi","video/x-matroska","video/webm","video/quicktime","video/vnd.avi","audio/wav","audio/qcelp","audio/x-ms-asf","video/x-ms-asf","application/vnd.ms-asf","video/mpeg","video/3gpp","audio/mpeg","audio/mp4","audio/opus","video/ogg","audio/ogg","application/ogg","audio/x-flac","audio/ape","audio/wavpack","audio/amr","application/pdf","application/x-elf","application/x-mach-binary","application/x-msdownload","application/x-shockwave-flash","application/rtf","application/wasm","font/woff","font/woff2","application/vnd.ms-fontobject","font/ttf","font/otf","image/x-icon","video/x-flv","application/postscript","application/eps","application/x-xz","application/x-sqlite3","application/x-nintendo-nes-rom","application/x-google-chrome-extension","application/vnd.ms-cab-compressed","application/x-deb","application/x-unix-archive","application/x-rpm","application/x-compress","application/x-lzip","application/x-cfb","application/x-mie","application/mxf","video/mp2t","application/x-blender","image/bpg","image/j2c","image/jp2","image/jpx","image/jpm","image/mj2","audio/aiff","application/xml","application/x-mobipocket-ebook","image/heif","image/heif-sequence","image/heic","image/heic-sequence","image/icns","image/ktx","application/dicom","audio/x-musepack","text/calendar","text/vcard","model/gltf-binary","application/vnd.tcpdump.pcap","audio/x-dsf","application/x.ms.shortcut","application/x.apple.alias","audio/x-voc","audio/vnd.dolby.dd-raw","audio/x-m4a","image/apng","image/x-olympus-orf","image/x-sony-arw","image/x-adobe-dng","image/x-nikon-nef","image/x-panasonic-rw2","image/x-fujifilm-raf","video/x-m4v","video/3gpp2","application/x-esri-shape","audio/aac","audio/x-it","audio/x-s3m","audio/x-xm","video/MP1S","video/MP2P","application/vnd.sketchup.skp","image/avif","application/x-lzh-compressed","application/pgp-encrypted","application/x-asar","model/stl","application/vnd.ms-htmlhelp","model/3mf","image/jxl","application/zstd","image/jls","application/vnd.ms-outlook","image/vnd.dwg","application/x-parquet","application/java-vm","application/x-arj","application/x-cpio","application/x-ace-compressed","application/avro","application/vnd.iccprofile","application/x.autodesk.fbx","application/vnd.visio"],gE=4100;async function AA(t){return new pG().fromBuffer(t)}function Qr(t,e,n){n={offset:0,...n};for(const[r,s]of e.entries())if(n.mask){if(s!==(n.mask[r]&t[r+n.offset]))return!1}else if(s!==t[r+n.offset])return!1;return!0}class pG{constructor(e){this.detectors=e==null?void 0:e.customDetectors,this.fromTokenizer=this.fromTokenizer.bind(this),this.fromBuffer=this.fromBuffer.bind(this),this.parse=this.parse.bind(this)}async fromTokenizer(e){const n=e.position;for(const r of this.detectors||[]){const s=await r(e);if(s)return s;if(n!==e.position)return}return this.parse(e)}async fromBuffer(e){if(!(e instanceof Uint8Array||e instanceof ArrayBuffer))throw new TypeError(`Expected the \`input\` argument to be of type \`Uint8Array\` or \`ArrayBuffer\`, got \`${typeof e}\``);const n=e instanceof Uint8Array?e:new Uint8Array(e);if((n==null?void 0:n.length)>1)return this.fromTokenizer(tl(n))}async fromBlob(e){return this.fromStream(e.stream())}async fromStream(e){const n=await EA(e);try{return await this.fromTokenizer(n)}finally{await n.close()}}async toDetectionStream(e,n){const{sampleSize:r=gE}=n;let s,i;const a=e.getReader({mode:"byob"});try{const{value:u,done:d}=await a.read(new Uint8Array(r));if(i=u,!d&&u)try{s=await this.fromBuffer(u.slice(0,r))}catch(f){if(!(f instanceof pt))throw f;s=void 0}i=u}finally{a.releaseLock()}const l=new TransformStream({async start(u){u.enqueue(i)},transform(u,d){d.enqueue(u)}}),c=e.pipeThrough(l);return c.fileType=s,c}check(e,n){return Qr(this.buffer,e,n)}checkString(e,n){return this.check(uG(e),n)}async parse(e){if(this.buffer=new Uint8Array(gE),e.fileInfo.size===void 0&&(e.fileInfo.size=Number.MAX_SAFE_INTEGER),this.tokenizer=e,await e.peekBuffer(this.buffer,{length:12,mayBeLess:!0}),this.check([66,77]))return{ext:"bmp",mime:"image/bmp"};if(this.check([11,119]))return{ext:"ac3",mime:"audio/vnd.dolby.dd-raw"};if(this.check([120,1]))return{ext:"dmg",mime:"application/x-apple-diskimage"};if(this.check([77,90]))return{ext:"exe",mime:"application/x-msdownload"};if(this.check([37,33]))return await e.peekBuffer(this.buffer,{length:24,mayBeLess:!0}),this.checkString("PS-Adobe-",{offset:2})&&this.checkString(" EPSF-",{offset:14})?{ext:"eps",mime:"application/eps"}:{ext:"ps",mime:"application/postscript"};if(this.check([31,160])||this.check([31,157]))return{ext:"Z",mime:"application/x-compress"};if(this.check([199,113]))return{ext:"cpio",mime:"application/x-cpio"};if(this.check([96,234]))return{ext:"arj",mime:"application/x-arj"};if(this.check([239,187,191]))return this.tokenizer.ignore(3),this.parse(e);if(this.check([71,73,70]))return{ext:"gif",mime:"image/gif"};if(this.check([73,73,188]))return{ext:"jxr",mime:"image/vnd.ms-photo"};if(this.check([31,139,8]))return{ext:"gz",mime:"application/gzip"};if(this.check([66,90,104]))return{ext:"bz2",mime:"application/x-bzip2"};if(this.checkString("ID3")){await e.ignore(6);const n=await e.readToken(hG);return e.position+n>e.fileInfo.size?{ext:"mp3",mime:"audio/mpeg"}:(await e.ignore(n),this.fromTokenizer(e))}if(this.checkString("MP+"))return{ext:"mpc",mime:"audio/x-musepack"};if((this.buffer[0]===67||this.buffer[0]===70)&&this.check([87,83],{offset:1}))return{ext:"swf",mime:"application/x-shockwave-flash"};if(this.check([255,216,255]))return this.check([247],{offset:3})?{ext:"jls",mime:"image/jls"}:{ext:"jpg",mime:"image/jpeg"};if(this.check([79,98,106,1]))return{ext:"avro",mime:"application/avro"};if(this.checkString("FLIF"))return{ext:"flif",mime:"image/flif"};if(this.checkString("8BPS"))return{ext:"psd",mime:"image/vnd.adobe.photoshop"};if(this.checkString("WEBP",{offset:8}))return{ext:"webp",mime:"image/webp"};if(this.checkString("MPCK"))return{ext:"mpc",mime:"audio/x-musepack"};if(this.checkString("FORM"))return{ext:"aif",mime:"audio/aiff"};if(this.checkString("icns",{offset:0}))return{ext:"icns",mime:"image/icns"};if(this.check([80,75,3,4])){try{for(;e.position+30<e.fileInfo.size;){await e.readBuffer(this.buffer,{length:30});const n=new DataView(this.buffer.buffer),r={compressedSize:n.getUint32(18,!0),uncompressedSize:n.getUint32(22,!0),filenameLength:n.getUint16(26,!0),extraFieldLength:n.getUint16(28,!0)};if(r.filename=await e.readToken(new ne(r.filenameLength,"utf-8")),await e.ignore(r.extraFieldLength),r.filename==="META-INF/mozilla.rsa")return{ext:"xpi",mime:"application/x-xpinstall"};if(r.filename.endsWith(".rels")||r.filename.endsWith(".xml"))switch(r.filename.split("/")[0]){case"_rels":break;case"word":return{ext:"docx",mime:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"};case"ppt":return{ext:"pptx",mime:"application/vnd.openxmlformats-officedocument.presentationml.presentation"};case"xl":return{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"};case"visio":return{ext:"vsdx",mime:"application/vnd.visio"};default:break}if(r.filename.startsWith("xl/"))return{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"};if(r.filename.startsWith("3D/")&&r.filename.endsWith(".model"))return{ext:"3mf",mime:"model/3mf"};if(r.filename==="mimetype"&&r.compressedSize===r.uncompressedSize){let s=await e.readToken(new ne(r.compressedSize,"utf-8"));switch(s=s.trim(),s){case"application/epub+zip":return{ext:"epub",mime:"application/epub+zip"};case"application/vnd.oasis.opendocument.text":return{ext:"odt",mime:"application/vnd.oasis.opendocument.text"};case"application/vnd.oasis.opendocument.spreadsheet":return{ext:"ods",mime:"application/vnd.oasis.opendocument.spreadsheet"};case"application/vnd.oasis.opendocument.presentation":return{ext:"odp",mime:"application/vnd.oasis.opendocument.presentation"};default:}}if(r.compressedSize===0){let s=-1;for(;s<0&&e.position<e.fileInfo.size;)await e.peekBuffer(this.buffer,{mayBeLess:!0}),s=RA(this.buffer,new Uint8Array([80,75,3,4])),await e.ignore(s>=0?s:this.buffer.length)}else await e.ignore(r.compressedSize)}}catch(n){if(!(n instanceof pt))throw n}return{ext:"zip",mime:"application/zip"}}if(this.checkString("OggS")){await e.ignore(28);const n=new Uint8Array(8);return await e.readBuffer(n),Qr(n,[79,112,117,115,72,101,97,100])?{ext:"opus",mime:"audio/opus"}:Qr(n,[128,116,104,101,111,114,97])?{ext:"ogv",mime:"video/ogg"}:Qr(n,[1,118,105,100,101,111,0])?{ext:"ogm",mime:"video/ogg"}:Qr(n,[127,70,76,65,67])?{ext:"oga",mime:"audio/ogg"}:Qr(n,[83,112,101,101,120,32,32])?{ext:"spx",mime:"audio/ogg"}:Qr(n,[1,118,111,114,98,105,115])?{ext:"ogg",mime:"audio/ogg"}:{ext:"ogx",mime:"application/ogg"}}if(this.check([80,75])&&(this.buffer[2]===3||this.buffer[2]===5||this.buffer[2]===7)&&(this.buffer[3]===4||this.buffer[3]===6||this.buffer[3]===8))return{ext:"zip",mime:"application/zip"};if(this.checkString("ftyp",{offset:4})&&this.buffer[8]&96){const n=new ne(4,"latin1").get(this.buffer,8).replace("\0"," ").trim();switch(n){case"avif":case"avis":return{ext:"avif",mime:"image/avif"};case"mif1":return{ext:"heic",mime:"image/heif"};case"msf1":return{ext:"heic",mime:"image/heif-sequence"};case"heic":case"heix":return{ext:"heic",mime:"image/heic"};case"hevc":case"hevx":return{ext:"heic",mime:"image/heic-sequence"};case"qt":return{ext:"mov",mime:"video/quicktime"};case"M4V":case"M4VH":case"M4VP":return{ext:"m4v",mime:"video/x-m4v"};case"M4P":return{ext:"m4p",mime:"video/mp4"};case"M4B":return{ext:"m4b",mime:"audio/mp4"};case"M4A":return{ext:"m4a",mime:"audio/x-m4a"};case"F4V":return{ext:"f4v",mime:"video/mp4"};case"F4P":return{ext:"f4p",mime:"video/mp4"};case"F4A":return{ext:"f4a",mime:"audio/mp4"};case"F4B":return{ext:"f4b",mime:"audio/mp4"};case"crx":return{ext:"cr3",mime:"image/x-canon-cr3"};default:return n.startsWith("3g")?n.startsWith("3g2")?{ext:"3g2",mime:"video/3gpp2"}:{ext:"3gp",mime:"video/3gpp"}:{ext:"mp4",mime:"video/mp4"}}}if(this.checkString("MThd"))return{ext:"mid",mime:"audio/midi"};if(this.checkString("wOFF")&&(this.check([0,1,0,0],{offset:4})||this.checkString("OTTO",{offset:4})))return{ext:"woff",mime:"font/woff"};if(this.checkString("wOF2")&&(this.check([0,1,0,0],{offset:4})||this.checkString("OTTO",{offset:4})))return{ext:"woff2",mime:"font/woff2"};if(this.check([212,195,178,161])||this.check([161,178,195,212]))return{ext:"pcap",mime:"application/vnd.tcpdump.pcap"};if(this.checkString("DSD "))return{ext:"dsf",mime:"audio/x-dsf"};if(this.checkString("LZIP"))return{ext:"lz",mime:"application/x-lzip"};if(this.checkString("fLaC"))return{ext:"flac",mime:"audio/x-flac"};if(this.check([66,80,71,251]))return{ext:"bpg",mime:"image/bpg"};if(this.checkString("wvpk"))return{ext:"wv",mime:"audio/wavpack"};if(this.checkString("%PDF")){try{await e.ignore(1350);const n=10*1024*1024,r=new Uint8Array(Math.min(n,e.fileInfo.size));if(await e.readBuffer(r,{mayBeLess:!0}),cG(r,new TextEncoder().encode("AIPrivateData")))return{ext:"ai",mime:"application/postscript"}}catch(n){if(!(n instanceof pt))throw n}return{ext:"pdf",mime:"application/pdf"}}if(this.check([0,97,115,109]))return{ext:"wasm",mime:"application/wasm"};if(this.check([73,73])){const n=await this.readTiffHeader(!1);if(n)return n}if(this.check([77,77])){const n=await this.readTiffHeader(!0);if(n)return n}if(this.checkString("MAC "))return{ext:"ape",mime:"audio/ape"};if(this.check([26,69,223,163])){async function n(){const l=await e.peekNumber(pe);let c=128,u=0;for(;!(l&c)&&c!==0;)++u,c>>=1;const d=new Uint8Array(u+1);return await e.readBuffer(d),d}async function r(){const l=await n(),c=await n();c[0]^=128>>c.length-1;const u=Math.min(6,c.length),d=new DataView(l.buffer),f=new DataView(c.buffer,c.length-u,u);return{id:pE(d),len:pE(f)}}async function s(l){for(;l>0;){const c=await r();if(c.id===17026)return(await e.readToken(new ne(c.len))).replaceAll(/\00.*$/g,"");await e.ignore(c.len),--l}}const i=await r();switch(await s(i.len)){case"webm":return{ext:"webm",mime:"video/webm"};case"matroska":return{ext:"mkv",mime:"video/x-matroska"};default:return}}if(this.check([82,73,70,70])){if(this.check([65,86,73],{offset:8}))return{ext:"avi",mime:"video/vnd.avi"};if(this.check([87,65,86,69],{offset:8}))return{ext:"wav",mime:"audio/wav"};if(this.check([81,76,67,77],{offset:8}))return{ext:"qcp",mime:"audio/qcelp"}}if(this.checkString("SQLi"))return{ext:"sqlite",mime:"application/x-sqlite3"};if(this.check([78,69,83,26]))return{ext:"nes",mime:"application/x-nintendo-nes-rom"};if(this.checkString("Cr24"))return{ext:"crx",mime:"application/x-google-chrome-extension"};if(this.checkString("MSCF")||this.checkString("ISc("))return{ext:"cab",mime:"application/vnd.ms-cab-compressed"};if(this.check([237,171,238,219]))return{ext:"rpm",mime:"application/x-rpm"};if(this.check([197,208,211,198]))return{ext:"eps",mime:"application/eps"};if(this.check([40,181,47,253]))return{ext:"zst",mime:"application/zstd"};if(this.check([127,69,76,70]))return{ext:"elf",mime:"application/x-elf"};if(this.check([33,66,68,78]))return{ext:"pst",mime:"application/vnd.ms-outlook"};if(this.checkString("PAR1"))return{ext:"parquet",mime:"application/x-parquet"};if(this.check([207,250,237,254]))return{ext:"macho",mime:"application/x-mach-binary"};if(this.check([79,84,84,79,0]))return{ext:"otf",mime:"font/otf"};if(this.checkString("#!AMR"))return{ext:"amr",mime:"audio/amr"};if(this.checkString("{\\rtf"))return{ext:"rtf",mime:"application/rtf"};if(this.check([70,76,86,1]))return{ext:"flv",mime:"video/x-flv"};if(this.checkString("IMPM"))return{ext:"it",mime:"audio/x-it"};if(this.checkString("-lh0-",{offset:2})||this.checkString("-lh1-",{offset:2})||this.checkString("-lh2-",{offset:2})||this.checkString("-lh3-",{offset:2})||this.checkString("-lh4-",{offset:2})||this.checkString("-lh5-",{offset:2})||this.checkString("-lh6-",{offset:2})||this.checkString("-lh7-",{offset:2})||this.checkString("-lzs-",{offset:2})||this.checkString("-lz4-",{offset:2})||this.checkString("-lz5-",{offset:2})||this.checkString("-lhd-",{offset:2}))return{ext:"lzh",mime:"application/x-lzh-compressed"};if(this.check([0,0,1,186])){if(this.check([33],{offset:4,mask:[241]}))return{ext:"mpg",mime:"video/MP1S"};if(this.check([68],{offset:4,mask:[196]}))return{ext:"mpg",mime:"video/MP2P"}}if(this.checkString("ITSF"))return{ext:"chm",mime:"application/vnd.ms-htmlhelp"};if(this.check([202,254,186,190]))return{ext:"class",mime:"application/java-vm"};if(this.check([253,55,122,88,90,0]))return{ext:"xz",mime:"application/x-xz"};if(this.checkString("<?xml "))return{ext:"xml",mime:"application/xml"};if(this.check([55,122,188,175,39,28]))return{ext:"7z",mime:"application/x-7z-compressed"};if(this.check([82,97,114,33,26,7])&&(this.buffer[6]===0||this.buffer[6]===1))return{ext:"rar",mime:"application/x-rar-compressed"};if(this.checkString("solid "))return{ext:"stl",mime:"model/stl"};if(this.checkString("AC")){const n=new ne(4,"latin1").get(this.buffer,2);if(n.match("^d*")&&n>=1e3&&n<=1050)return{ext:"dwg",mime:"image/vnd.dwg"}}if(this.checkString("070707"))return{ext:"cpio",mime:"application/x-cpio"};if(this.checkString("BLENDER"))return{ext:"blend",mime:"application/x-blender"};if(this.checkString("!<arch>"))return await e.ignore(8),await e.readToken(new ne(13,"ascii"))==="debian-binary"?{ext:"deb",mime:"application/x-deb"}:{ext:"ar",mime:"application/x-unix-archive"};if(this.checkString("**ACE",{offset:7})&&(await e.peekBuffer(this.buffer,{length:14,mayBeLess:!0}),this.checkString("**",{offset:12})))return{ext:"ace",mime:"application/x-ace-compressed"};if(this.check([137,80,78,71,13,10,26,10])){await e.ignore(8);async function n(){return{length:await e.readToken(Yn),type:await e.readToken(new ne(4,"latin1"))}}do{const r=await n();if(r.length<0)return;switch(r.type){case"IDAT":return{ext:"png",mime:"image/png"};case"acTL":return{ext:"apng",mime:"image/apng"};default:await e.ignore(r.length+4)}}while(e.position+8<e.fileInfo.size);return{ext:"png",mime:"image/png"}}if(this.check([65,82,82,79,87,49,0,0]))return{ext:"arrow",mime:"application/x-apache-arrow"};if(this.check([103,108,84,70,2,0,0,0]))return{ext:"glb",mime:"model/gltf-binary"};if(this.check([102,114,101,101],{offset:4})||this.check([109,100,97,116],{offset:4})||this.check([109,111,111,118],{offset:4})||this.check([119,105,100,101],{offset:4}))return{ext:"mov",mime:"video/quicktime"};if(this.check([73,73,82,79,8,0,0,0,24]))return{ext:"orf",mime:"image/x-olympus-orf"};if(this.checkString("gimp xcf "))return{ext:"xcf",mime:"image/x-xcf"};if(this.check([73,73,85,0,24,0,0,0,136,231,116,216]))return{ext:"rw2",mime:"image/x-panasonic-rw2"};if(this.check([48,38,178,117,142,102,207,17,166,217])){async function n(){const r=new Uint8Array(16);return await e.readBuffer(r),{id:r,size:Number(await e.readToken(mn))}}for(await e.ignore(30);e.position+24<e.fileInfo.size;){const r=await n();let s=r.size-24;if(Qr(r.id,[145,7,220,183,183,169,207,17,142,230,0,192,12,32,83,101])){const i=new Uint8Array(16);if(s-=await e.readBuffer(i),Qr(i,[64,158,105,248,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"audio/x-ms-asf"};if(Qr(i,[192,239,25,188,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"video/x-ms-asf"};break}await e.ignore(s)}return{ext:"asf",mime:"application/vnd.ms-asf"}}if(this.check([171,75,84,88,32,49,49,187,13,10,26,10]))return{ext:"ktx",mime:"image/ktx"};if((this.check([126,16,4])||this.check([126,24,4]))&&this.check([48,77,73,69],{offset:4}))return{ext:"mie",mime:"application/x-mie"};if(this.check([39,10,0,0,0,0,0,0,0,0,0,0],{offset:2}))return{ext:"shp",mime:"application/x-esri-shape"};if(this.check([255,79,255,81]))return{ext:"j2c",mime:"image/j2c"};if(this.check([0,0,0,12,106,80,32,32,13,10,135,10]))switch(await e.ignore(20),await e.readToken(new ne(4,"ascii"))){case"jp2 ":return{ext:"jp2",mime:"image/jp2"};case"jpx ":return{ext:"jpx",mime:"image/jpx"};case"jpm ":return{ext:"jpm",mime:"image/jpm"};case"mjp2":return{ext:"mj2",mime:"image/mj2"};default:return}if(this.check([255,10])||this.check([0,0,0,12,74,88,76,32,13,10,135,10]))return{ext:"jxl",mime:"image/jxl"};if(this.check([254,255]))return this.check([0,60,0,63,0,120,0,109,0,108],{offset:2})?{ext:"xml",mime:"application/xml"}:void 0;if(this.check([0,0,1,186])||this.check([0,0,1,179]))return{ext:"mpg",mime:"video/mpeg"};if(this.check([0,1,0,0,0]))return{ext:"ttf",mime:"font/ttf"};if(this.check([0,0,1,0]))return{ext:"ico",mime:"image/x-icon"};if(this.check([0,0,2,0]))return{ext:"cur",mime:"image/x-icon"};if(this.check([208,207,17,224,161,177,26,225]))return{ext:"cfb",mime:"application/x-cfb"};if(await e.peekBuffer(this.buffer,{length:Math.min(256,e.fileInfo.size),mayBeLess:!0}),this.check([97,99,115,112],{offset:36}))return{ext:"icc",mime:"application/vnd.iccprofile"};if(this.checkString("BEGIN:")){if(this.checkString("VCARD",{offset:6}))return{ext:"vcf",mime:"text/vcard"};if(this.checkString("VCALENDAR",{offset:6}))return{ext:"ics",mime:"text/calendar"}}if(this.checkString("FUJIFILMCCD-RAW"))return{ext:"raf",mime:"image/x-fujifilm-raf"};if(this.checkString("Extended Module:"))return{ext:"xm",mime:"audio/x-xm"};if(this.checkString("Creative Voice File"))return{ext:"voc",mime:"audio/x-voc"};if(this.check([4,0,0,0])&&this.buffer.length>=16){const n=new DataView(this.buffer.buffer).getUint32(12,!0);if(n>12&&this.buffer.length>=n+16)try{const r=new TextDecoder().decode(this.buffer.slice(16,n+16));if(JSON.parse(r).files)return{ext:"asar",mime:"application/x-asar"}}catch{}}if(this.check([6,14,43,52,2,5,1,1,13,1,2,1,1,2]))return{ext:"mxf",mime:"application/mxf"};if(this.checkString("SCRM",{offset:44}))return{ext:"s3m",mime:"audio/x-s3m"};if(this.check([71])&&this.check([71],{offset:188}))return{ext:"mts",mime:"video/mp2t"};if(this.check([71],{offset:4})&&this.check([71],{offset:196}))return{ext:"mts",mime:"video/mp2t"};if(this.check([66,79,79,75,77,79,66,73],{offset:60}))return{ext:"mobi",mime:"application/x-mobipocket-ebook"};if(this.check([68,73,67,77],{offset:128}))return{ext:"dcm",mime:"application/dicom"};if(this.check([76,0,0,0,1,20,2,0,0,0,0,0,192,0,0,0,0,0,0,70]))return{ext:"lnk",mime:"application/x.ms.shortcut"};if(this.check([98,111,111,107,0,0,0,0,109,97,114,107,0,0,0,0]))return{ext:"alias",mime:"application/x.apple.alias"};if(this.checkString("Kaydara FBX Binary  \0"))return{ext:"fbx",mime:"application/x.autodesk.fbx"};if(this.check([76,80],{offset:34})&&(this.check([0,0,1],{offset:8})||this.check([1,0,2],{offset:8})||this.check([2,0,2],{offset:8})))return{ext:"eot",mime:"application/vnd.ms-fontobject"};if(this.check([6,6,237,245,216,29,70,229,189,49,239,231,254,116,183,29]))return{ext:"indd",mime:"application/x-indesign"};if(await e.peekBuffer(this.buffer,{length:Math.min(512,e.fileInfo.size),mayBeLess:!0}),dG(this.buffer))return{ext:"tar",mime:"application/x-tar"};if(this.check([255,254]))return this.check([60,0,63,0,120,0,109,0,108,0],{offset:2})?{ext:"xml",mime:"application/xml"}:this.check([255,14,83,0,107,0,101,0,116,0,99,0,104,0,85,0,112,0,32,0,77,0,111,0,100,0,101,0,108,0],{offset:2})?{ext:"skp",mime:"application/vnd.sketchup.skp"}:void 0;if(this.checkString("-----BEGIN PGP MESSAGE-----"))return{ext:"pgp",mime:"application/pgp-encrypted"};if(this.buffer.length>=2&&this.check([255,224],{offset:0,mask:[255,224]})){if(this.check([16],{offset:1,mask:[22]}))return this.check([8],{offset:1,mask:[8]})?{ext:"aac",mime:"audio/aac"}:{ext:"aac",mime:"audio/aac"};if(this.check([2],{offset:1,mask:[6]}))return{ext:"mp3",mime:"audio/mpeg"};if(this.check([4],{offset:1,mask:[6]}))return{ext:"mp2",mime:"audio/mpeg"};if(this.check([6],{offset:1,mask:[6]}))return{ext:"mp1",mime:"audio/mpeg"}}}async readTiffTag(e){const n=await this.tokenizer.readToken(e?Oe:De);switch(this.tokenizer.ignore(10),n){case 50341:return{ext:"arw",mime:"image/x-sony-arw"};case 50706:return{ext:"dng",mime:"image/x-adobe-dng"}}}async readTiffIFD(e){const n=await this.tokenizer.readToken(e?Oe:De);for(let r=0;r<n;++r){const s=await this.readTiffTag(e);if(s)return s}}async readTiffHeader(e){const n=(e?Oe:De).get(this.buffer,2),r=(e?re:J).get(this.buffer,4);if(n===42){if(r>=6){if(this.checkString("CR",{offset:8}))return{ext:"cr2",mime:"image/x-canon-cr2"};if(r>=8&&(this.check([28,0,254,0],{offset:8})||this.check([31,0,11,0],{offset:8})))return{ext:"nef",mime:"image/x-nikon-nef"}}return await this.tokenizer.ignore(r),await this.readTiffIFD(e)??{ext:"tif",mime:"image/tiff"}}if(n===43)return{ext:"tif",mime:"image/tiff"}}}new Set(fG);new Set(mG);var Bw={};/*!
 * content-type
 * Copyright(c) 2015 Douglas Christopher Wilson
 * MIT Licensed
 */var xE=/; *([!#$%&'*+.^_`|~0-9A-Za-z-]+) *= *("(?:[\u000b\u0020\u0021\u0023-\u005b\u005d-\u007e\u0080-\u00ff]|\\[\u000b\u0020-\u00ff])*"|[!#$%&'*+.^_`|~0-9A-Za-z-]+) */g,gG=/^[\u000b\u0020-\u007e\u0080-\u00ff]+$/,NA=/^[!#$%&'*+.^_`|~0-9A-Za-z-]+$/,xG=/\\([\u000b\u0020-\u00ff])/g,yG=/([\\"])/g,PA=/^[!#$%&'*+.^_`|~0-9A-Za-z-]+\/[!#$%&'*+.^_`|~0-9A-Za-z-]+$/;Bw.format=vG;Bw.parse=wG;function vG(t){if(!t||typeof t!="object")throw new TypeError("argument obj is required");var e=t.parameters,n=t.type;if(!n||!PA.test(n))throw new TypeError("invalid type");var r=n;if(e&&typeof e=="object")for(var s,i=Object.keys(e).sort(),a=0;a<i.length;a++){if(s=i[a],!NA.test(s))throw new TypeError("invalid parameter name");r+="; "+s+"="+bG(e[s])}return r}function wG(t){if(!t)throw new TypeError("argument string is required");var e=typeof t=="object"?_G(t):t;if(typeof e!="string")throw new TypeError("argument string is required to be a string");var n=e.indexOf(";"),r=n!==-1?e.slice(0,n).trim():e.trim();if(!PA.test(r))throw new TypeError("invalid media type");var s=new SG(r.toLowerCase());if(n!==-1){var i,a,l;for(xE.lastIndex=n;a=xE.exec(e);){if(a.index!==n)throw new TypeError("invalid parameter format");n+=a[0].length,i=a[1].toLowerCase(),l=a[2],l.charCodeAt(0)===34&&(l=l.slice(1,-1),l.indexOf("\\")!==-1&&(l=l.replace(xG,"$1"))),s.parameters[i]=l}if(n!==e.length)throw new TypeError("invalid parameter format")}return s}function _G(t){var e;if(typeof t.getHeader=="function"?e=t.getHeader("content-type"):typeof t.headers=="object"&&(e=t.headers&&t.headers["content-type"]),typeof e!="string")throw new TypeError("content-type header is missing from object");return e}function bG(t){var e=String(t);if(NA.test(e))return e;if(e.length>0&&!gG.test(e))throw new TypeError("invalid parameter value");return'"'+e.replace(yG,"\\$1")+'"'}function SG(t){this.parameters=Object.create(null),this.type=t}/*!
 * media-typer
 * Copyright(c) 2014-2017 Douglas Christopher Wilson
 * MIT Licensed
 */var EG=/^ *([A-Za-z0-9][A-Za-z0-9!#$&^_-]{0,126})\/([A-Za-z0-9][A-Za-z0-9!#$&^_.+-]{0,126}) *$/,kG=TG;function TG(t){if(!t)throw new TypeError("argument string is required");if(typeof t!="string")throw new TypeError("argument string is required to be a string");var e=EG.exec(t.toLowerCase());if(!e)throw new TypeError("invalid media type");var n=e[1],r=e[2],s,i=r.lastIndexOf("+");return i!==-1&&(s=r.substr(i+1),r=r.substr(0,i)),new IG(n,r,s)}function IG(t,e,n){this.type=t,this.subtype=e,this.suffix=n}var bx={exports:{}},vg,yE;function CG(){if(yE)return vg;yE=1;var t=1e3,e=t*60,n=e*60,r=n*24,s=r*7,i=r*365.25;vg=function(d,f){f=f||{};var p=typeof d;if(p==="string"&&d.length>0)return a(d);if(p==="number"&&isFinite(d))return f.long?c(d):l(d);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(d))};function a(d){if(d=String(d),!(d.length>100)){var f=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(d);if(f){var p=parseFloat(f[1]),g=(f[2]||"ms").toLowerCase();switch(g){case"years":case"year":case"yrs":case"yr":case"y":return p*i;case"weeks":case"week":case"w":return p*s;case"days":case"day":case"d":return p*r;case"hours":case"hour":case"hrs":case"hr":case"h":return p*n;case"minutes":case"minute":case"mins":case"min":case"m":return p*e;case"seconds":case"second":case"secs":case"sec":case"s":return p*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return p;default:return}}}}function l(d){var f=Math.abs(d);return f>=r?Math.round(d/r)+"d":f>=n?Math.round(d/n)+"h":f>=e?Math.round(d/e)+"m":f>=t?Math.round(d/t)+"s":d+"ms"}function c(d){var f=Math.abs(d);return f>=r?u(d,f,r,"day"):f>=n?u(d,f,n,"hour"):f>=e?u(d,f,e,"minute"):f>=t?u(d,f,t,"second"):d+" ms"}function u(d,f,p,g){var v=f>=p*1.5;return Math.round(d/p)+" "+g+(v?"s":"")}return vg}function jG(t){n.debug=n,n.default=n,n.coerce=c,n.disable=i,n.enable=s,n.enabled=a,n.humanize=CG(),n.destroy=u,Object.keys(t).forEach(d=>{n[d]=t[d]}),n.names=[],n.skips=[],n.formatters={};function e(d){let f=0;for(let p=0;p<d.length;p++)f=(f<<5)-f+d.charCodeAt(p),f|=0;return n.colors[Math.abs(f)%n.colors.length]}n.selectColor=e;function n(d){let f,p=null,g,v;function _(...b){if(!_.enabled)return;const E=_,w=Number(new Date),S=w-(f||w);E.diff=S,E.prev=f,E.curr=w,f=w,b[0]=n.coerce(b[0]),typeof b[0]!="string"&&b.unshift("%O");let I=0;b[0]=b[0].replace(/%([a-zA-Z%])/g,(D,C)=>{if(D==="%%")return"%";I++;const k=n.formatters[C];if(typeof k=="function"){const R=b[I];D=k.call(E,R),b.splice(I,1),I--}return D}),n.formatArgs.call(E,b),(E.log||n.log).apply(E,b)}return _.namespace=d,_.useColors=n.useColors(),_.color=n.selectColor(d),_.extend=r,_.destroy=n.destroy,Object.defineProperty(_,"enabled",{enumerable:!0,configurable:!1,get:()=>p!==null?p:(g!==n.namespaces&&(g=n.namespaces,v=n.enabled(d)),v),set:b=>{p=b}}),typeof n.init=="function"&&n.init(_),_}function r(d,f){const p=n(this.namespace+(typeof f>"u"?":":f)+d);return p.log=this.log,p}function s(d){n.save(d),n.namespaces=d,n.names=[],n.skips=[];let f;const p=(typeof d=="string"?d:"").split(/[\s,]+/),g=p.length;for(f=0;f<g;f++)p[f]&&(d=p[f].replace(/\*/g,".*?"),d[0]==="-"?n.skips.push(new RegExp("^"+d.slice(1)+"$")):n.names.push(new RegExp("^"+d+"$")))}function i(){const d=[...n.names.map(l),...n.skips.map(l).map(f=>"-"+f)].join(",");return n.enable(""),d}function a(d){if(d[d.length-1]==="*")return!0;let f,p;for(f=0,p=n.skips.length;f<p;f++)if(n.skips[f].test(d))return!1;for(f=0,p=n.names.length;f<p;f++)if(n.names[f].test(d))return!0;return!1}function l(d){return d.toString().substring(2,d.toString().length-2).replace(/\.\*\?$/,"*")}function c(d){return d instanceof Error?d.stack||d.message:d}function u(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return n.enable(n.load()),n}var RG=jG;(function(t,e){e.formatArgs=r,e.save=s,e.load=i,e.useColors=n,e.storage=a(),e.destroy=(()=>{let c=!1;return()=>{c||(c=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function n(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function r(c){if(c[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+c[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;const u="color: "+this.color;c.splice(1,0,u,"color: inherit");let d=0,f=0;c[0].replace(/%[a-zA-Z%]/g,p=>{p!=="%%"&&(d++,p==="%c"&&(f=d))}),c.splice(f,0,u)}e.log=console.debug||console.log||(()=>{});function s(c){try{c?e.storage.setItem("debug",c):e.storage.removeItem("debug")}catch{}}function i(){let c;try{c=e.storage.getItem("debug")}catch{}return!c&&typeof process<"u"&&"env"in process&&(c={}.DEBUG),c}function a(){try{return localStorage}catch{}}t.exports=RG(e);const{formatters:l}=t.exports;l.j=function(c){try{return JSON.stringify(c)}catch(u){return"[UnexpectedJSONParseError]: "+u.message}}})(bx,bx.exports);var AG=bx.exports;const ze=s2(AG);var Sx;(function(t){t[t.shot=10]="shot",t[t.scene=20]="scene",t[t.track=30]="track",t[t.part=40]="part",t[t.album=50]="album",t[t.edition=60]="edition",t[t.collection=70]="collection"})(Sx||(Sx={}));var Ua;(function(t){t[t.video=1]="video",t[t.audio=2]="audio",t[t.complex=3]="complex",t[t.logo=4]="logo",t[t.subtitle=17]="subtitle",t[t.button=18]="button",t[t.control=32]="control"})(Ua||(Ua={}));function ct(t,e,n){return(t[e]&1<<n)!==0}function Bn(t,e,n,r){let s=e;if(r==="utf-16le"){for(;t[s]!==0||t[s+1]!==0;){if(s>=n)return n;s+=2}return s}for(;t[s]!==0;){if(s>=n)return n;s++}return s}function FA(t){const e=t.indexOf("\0");return e===-1?t:t.substr(0,e)}function NG(t){const e=t.length;if(e&1)throw new Error("Buffer length must be even");for(let n=0;n<e;n+=2){const r=t[n];t[n]=t[n+1],t[n+1]=r}return t}function St(t,e){if(t[0]===255&&t[1]===254)return St(t.subarray(2),e);if(e==="utf-16le"&&t[0]===254&&t[1]===255){if(t.length&1)throw new Error("Expected even number of octets for 16-bit unicode string");return St(NG(t),e)}return new ne(t.length,e).get(t,0)}function vi(t){return t=t.replace(/^\x00+/g,""),t=t.replace(/\x00+$/g,""),t}function Ce(t,e,n,r){const s=e+~~(n/8),i=n%8;let a=t[s];a&=255>>i;const l=8-i,c=r-l;return c<0?a>>=8-i-r:c>0&&(a<<=c,a|=Ce(t,e,n+l,c)),a}function Hn(t,e,n){return Ce(t,e,n,1)===1}function PG(t){const e=[];for(let n=0,r=t.length;n<r;n++){const s=Number(t.charCodeAt(n)).toString(16);e.push(s.length===1?`0${s}`:s)}return e.join(" ")}function FG(t){return 10*Math.log10(t)}function DG(t){return 10**(t/10)}function LG(t){const e=t.split(" ").map(n=>n.trim().toLowerCase());if(e.length>=1){const n=Number.parseFloat(e[0]);return e.length===2&&e[1]==="db"?{dB:n,ratio:DG(n)}:{dB:FG(n),ratio:n}}}var du;(function(t){t[t.Other=0]="Other",t[t["32x32 pixels 'file icon' (PNG only)"]=1]="32x32 pixels 'file icon' (PNG only)",t[t["Other file icon"]=2]="Other file icon",t[t["Cover (front)"]=3]="Cover (front)",t[t["Cover (back)"]=4]="Cover (back)",t[t["Leaflet page"]=5]="Leaflet page",t[t["Media (e.g. label side of CD)"]=6]="Media (e.g. label side of CD)",t[t["Lead artist/lead performer/soloist"]=7]="Lead artist/lead performer/soloist",t[t["Artist/performer"]=8]="Artist/performer",t[t.Conductor=9]="Conductor",t[t["Band/Orchestra"]=10]="Band/Orchestra",t[t.Composer=11]="Composer",t[t["Lyricist/text writer"]=12]="Lyricist/text writer",t[t["Recording Location"]=13]="Recording Location",t[t["During recording"]=14]="During recording",t[t["During performance"]=15]="During performance",t[t["Movie/video screen capture"]=16]="Movie/video screen capture",t[t["A bright coloured fish"]=17]="A bright coloured fish",t[t.Illustration=18]="Illustration",t[t["Band/artist logotype"]=19]="Band/artist logotype",t[t["Publisher/Studio logotype"]=20]="Publisher/Studio logotype"})(du||(du={}));var vE;(function(t){t[t.other=0]="other",t[t.lyrics=1]="lyrics",t[t.text=2]="text",t[t.movement_part=3]="movement_part",t[t.events=4]="events",t[t.chord=5]="chord",t[t.trivia_pop=6]="trivia_pop"})(vE||(vE={}));var wE;(function(t){t[t.notSynchronized0=0]="notSynchronized0",t[t.mpegFrameNumber=1]="mpegFrameNumber",t[t.milliseconds=2]="milliseconds"})(wE||(wE={}));const DA={get:(t,e)=>t[e+3]&127|t[e+2]<<7|t[e+1]<<14|t[e]<<21,len:4},Ex={len:10,get:(t,e)=>({fileIdentifier:new ne(3,"ascii").get(t,e),version:{major:uu.get(t,e+3),revision:uu.get(t,e+4)},flags:{unsynchronisation:ct(t,e+5,7),isExtendedHeader:ct(t,e+5,6),expIndicator:ct(t,e+5,5),footer:ct(t,e+5,4)},size:DA.get(t,e+6)})},_E={len:10,get:(t,e)=>({size:re.get(t,e),extendedFlags:Oe.get(t,e+4),sizeOfPadding:re.get(t,e+6),crcDataPresent:ct(t,e+4,31)})},LA={len:1,get:(t,e)=>{switch(t[e]){case 0:return{encoding:"latin1"};case 1:return{encoding:"utf-16le",bom:!0};case 2:return{encoding:"utf-16le",bom:!1};case 3:return{encoding:"utf8",bom:!1};default:return{encoding:"utf8",bom:!1}}}},kx={len:4,get:(t,e)=>({encoding:LA.get(t,e),language:new ne(3,"latin1").get(t,e+1)})},bE={len:6,get:(t,e)=>{const n=kx.get(t,e);return{encoding:n.encoding,language:n.language,timeStampFormat:pe.get(t,e+4),contentType:pe.get(t,e+5)}}},Sf={year:{multiple:!1},track:{multiple:!1},disk:{multiple:!1},title:{multiple:!1},artist:{multiple:!1},artists:{multiple:!0,unique:!0},albumartist:{multiple:!1},album:{multiple:!1},date:{multiple:!1},originaldate:{multiple:!1},originalyear:{multiple:!1},releasedate:{multiple:!1},comment:{multiple:!0,unique:!1},genre:{multiple:!0,unique:!0},picture:{multiple:!0,unique:!0},composer:{multiple:!0,unique:!0},lyrics:{multiple:!0,unique:!1},albumsort:{multiple:!1,unique:!0},titlesort:{multiple:!1,unique:!0},work:{multiple:!1,unique:!0},artistsort:{multiple:!1,unique:!0},albumartistsort:{multiple:!1,unique:!0},composersort:{multiple:!1,unique:!0},lyricist:{multiple:!0,unique:!0},writer:{multiple:!0,unique:!0},conductor:{multiple:!0,unique:!0},remixer:{multiple:!0,unique:!0},arranger:{multiple:!0,unique:!0},engineer:{multiple:!0,unique:!0},producer:{multiple:!0,unique:!0},technician:{multiple:!0,unique:!0},djmixer:{multiple:!0,unique:!0},mixer:{multiple:!0,unique:!0},label:{multiple:!0,unique:!0},grouping:{multiple:!1},subtitle:{multiple:!0},discsubtitle:{multiple:!1},totaltracks:{multiple:!1},totaldiscs:{multiple:!1},compilation:{multiple:!1},rating:{multiple:!0},bpm:{multiple:!1},mood:{multiple:!1},media:{multiple:!1},catalognumber:{multiple:!0,unique:!0},tvShow:{multiple:!1},tvShowSort:{multiple:!1},tvSeason:{multiple:!1},tvEpisode:{multiple:!1},tvEpisodeId:{multiple:!1},tvNetwork:{multiple:!1},podcast:{multiple:!1},podcasturl:{multiple:!1},releasestatus:{multiple:!1},releasetype:{multiple:!0},releasecountry:{multiple:!1},script:{multiple:!1},language:{multiple:!1},copyright:{multiple:!1},license:{multiple:!1},encodedby:{multiple:!1},encodersettings:{multiple:!1},gapless:{multiple:!1},barcode:{multiple:!1},isrc:{multiple:!0},asin:{multiple:!1},musicbrainz_recordingid:{multiple:!1},musicbrainz_trackid:{multiple:!1},musicbrainz_albumid:{multiple:!1},musicbrainz_artistid:{multiple:!0},musicbrainz_albumartistid:{multiple:!0},musicbrainz_releasegroupid:{multiple:!1},musicbrainz_workid:{multiple:!1},musicbrainz_trmid:{multiple:!1},musicbrainz_discid:{multiple:!1},acoustid_id:{multiple:!1},acoustid_fingerprint:{multiple:!1},musicip_puid:{multiple:!1},musicip_fingerprint:{multiple:!1},website:{multiple:!1},"performer:instrument":{multiple:!0,unique:!0},averageLevel:{multiple:!1},peakLevel:{multiple:!1},notes:{multiple:!0,unique:!1},key:{multiple:!1},originalalbum:{multiple:!1},originalartist:{multiple:!1},discogs_artist_id:{multiple:!0,unique:!0},discogs_release_id:{multiple:!1},discogs_label_id:{multiple:!1},discogs_master_release_id:{multiple:!1},discogs_votes:{multiple:!1},discogs_rating:{multiple:!1},replaygain_track_peak:{multiple:!1},replaygain_track_gain:{multiple:!1},replaygain_album_peak:{multiple:!1},replaygain_album_gain:{multiple:!1},replaygain_track_minmax:{multiple:!1},replaygain_album_minmax:{multiple:!1},replaygain_undo:{multiple:!1},description:{multiple:!0},longDescription:{multiple:!1},category:{multiple:!0},hdVideo:{multiple:!1},keywords:{multiple:!0},movement:{multiple:!1},movementIndex:{multiple:!1},movementTotal:{multiple:!1},podcastId:{multiple:!1},showMovement:{multiple:!1},stik:{multiple:!1}};function MG(t){return Sf[t]&&!Sf[t].multiple}function OG(t){return!Sf[t].multiple||Sf[t].unique||!1}class Qn{static toIntOrNull(e){const n=Number.parseInt(e,10);return Number.isNaN(n)?null:n}static normalizeTrack(e){const n=e.toString().split("/");return{no:Number.parseInt(n[0],10)||null,of:Number.parseInt(n[1],10)||null}}constructor(e,n){this.tagTypes=e,this.tagMap=n}mapGenericTag(e,n){e={id:e.id,value:e.value},this.postMap(e,n);const r=this.getCommonName(e.id);return r?{id:r,value:e.value}:null}getCommonName(e){return this.tagMap[e]}postMap(e,n){}}Qn.maxRatingScore=1;const $G={title:"title",artist:"artist",album:"album",year:"year",comment:"comment",track:"track",genre:"genre"};class BG extends Qn{constructor(){super(["ID3v1"],$G)}}class Wu extends Qn{constructor(e,n){const r={};for(const s of Object.keys(n))r[s.toUpperCase()]=n[s];super(e,r)}getCommonName(e){return this.tagMap[e.toUpperCase()]}}const zG={TIT2:"title",TPE1:"artist","TXXX:Artists":"artists",TPE2:"albumartist",TALB:"album",TDRV:"date",TORY:"originalyear",TPOS:"disk",TCON:"genre",APIC:"picture",TCOM:"composer",USLT:"lyrics",TSOA:"albumsort",TSOT:"titlesort",TOAL:"originalalbum",TSOP:"artistsort",TSO2:"albumartistsort",TSOC:"composersort",TEXT:"lyricist","TXXX:Writer":"writer",TPE3:"conductor",TPE4:"remixer","IPLS:arranger":"arranger","IPLS:engineer":"engineer","IPLS:producer":"producer","IPLS:DJ-mix":"djmixer","IPLS:mix":"mixer",TPUB:"label",TIT1:"grouping",TIT3:"subtitle",TRCK:"track",TCMP:"compilation",POPM:"rating",TBPM:"bpm",TMED:"media","TXXX:CATALOGNUMBER":"catalognumber","TXXX:MusicBrainz Album Status":"releasestatus","TXXX:MusicBrainz Album Type":"releasetype","TXXX:MusicBrainz Album Release Country":"releasecountry","TXXX:RELEASECOUNTRY":"releasecountry","TXXX:SCRIPT":"script",TLAN:"language",TCOP:"copyright",WCOP:"license",TENC:"encodedby",TSSE:"encodersettings","TXXX:BARCODE":"barcode","TXXX:ISRC":"isrc",TSRC:"isrc","TXXX:ASIN":"asin","TXXX:originalyear":"originalyear","UFID:http://musicbrainz.org":"musicbrainz_recordingid","TXXX:MusicBrainz Release Track Id":"musicbrainz_trackid","TXXX:MusicBrainz Album Id":"musicbrainz_albumid","TXXX:MusicBrainz Artist Id":"musicbrainz_artistid","TXXX:MusicBrainz Album Artist Id":"musicbrainz_albumartistid","TXXX:MusicBrainz Release Group Id":"musicbrainz_releasegroupid","TXXX:MusicBrainz Work Id":"musicbrainz_workid","TXXX:MusicBrainz TRM Id":"musicbrainz_trmid","TXXX:MusicBrainz Disc Id":"musicbrainz_discid","TXXX:ACOUSTID_ID":"acoustid_id","TXXX:Acoustid Id":"acoustid_id","TXXX:Acoustid Fingerprint":"acoustid_fingerprint","TXXX:MusicIP PUID":"musicip_puid","TXXX:MusicMagic Fingerprint":"musicip_fingerprint",WOAR:"website",TDRC:"date",TYER:"year",TDOR:"originaldate","TIPL:arranger":"arranger","TIPL:engineer":"engineer","TIPL:producer":"producer","TIPL:DJ-mix":"djmixer","TIPL:mix":"mixer",TMOO:"mood",SYLT:"lyrics",TSST:"discsubtitle",TKEY:"key",COMM:"comment",TOPE:"originalartist","PRIV:AverageLevel":"averageLevel","PRIV:PeakLevel":"peakLevel","TXXX:DISCOGS_ARTIST_ID":"discogs_artist_id","TXXX:DISCOGS_ARTISTS":"artists","TXXX:DISCOGS_ARTIST_NAME":"artists","TXXX:DISCOGS_ALBUM_ARTISTS":"albumartist","TXXX:DISCOGS_CATALOG":"catalognumber","TXXX:DISCOGS_COUNTRY":"releasecountry","TXXX:DISCOGS_DATE":"originaldate","TXXX:DISCOGS_LABEL":"label","TXXX:DISCOGS_LABEL_ID":"discogs_label_id","TXXX:DISCOGS_MASTER_RELEASE_ID":"discogs_master_release_id","TXXX:DISCOGS_RATING":"discogs_rating","TXXX:DISCOGS_RELEASED":"date","TXXX:DISCOGS_RELEASE_ID":"discogs_release_id","TXXX:DISCOGS_VOTES":"discogs_votes","TXXX:CATALOGID":"catalognumber","TXXX:STYLE":"genre","TXXX:REPLAYGAIN_TRACK_PEAK":"replaygain_track_peak","TXXX:REPLAYGAIN_TRACK_GAIN":"replaygain_track_gain","TXXX:REPLAYGAIN_ALBUM_PEAK":"replaygain_album_peak","TXXX:REPLAYGAIN_ALBUM_GAIN":"replaygain_album_gain","TXXX:MP3GAIN_MINMAX":"replaygain_track_minmax","TXXX:MP3GAIN_ALBUM_MINMAX":"replaygain_album_minmax","TXXX:MP3GAIN_UNDO":"replaygain_undo",MVNM:"movement",MVIN:"movementIndex",PCST:"podcast",TCAT:"category",TDES:"description",TDRL:"releasedate",TGID:"podcastId",TKWD:"keywords",WFED:"podcasturl",GRP1:"grouping"};class zw extends Wu{static toRating(e){return{source:e.email,rating:e.rating>0?(e.rating-1)/254*Qn.maxRatingScore:void 0}}constructor(){super(["ID3v2.3","ID3v2.4"],zG)}postMap(e,n){switch(e.id){case"UFID":{const r=e.value;r.owner_identifier==="http://musicbrainz.org"&&(e.id+=`:${r.owner_identifier}`,e.value=St(r.identifier,"latin1"))}break;case"PRIV":{const r=e.value;switch(r.owner_identifier){case"AverageLevel":case"PeakValue":e.id+=`:${r.owner_identifier}`,e.value=r.data.length===4?J.get(r.data,0):null,e.value===null&&n.addWarning("Failed to parse PRIV:PeakValue");break;default:n.addWarning(`Unknown PRIV owner-identifier: ${r.data}`)}}break;case"POPM":e.value=zw.toRating(e.value);break}}}const UG={Title:"title",Author:"artist","WM/AlbumArtist":"albumartist","WM/AlbumTitle":"album","WM/Year":"date","WM/OriginalReleaseTime":"originaldate","WM/OriginalReleaseYear":"originalyear",Description:"comment","WM/TrackNumber":"track","WM/PartOfSet":"disk","WM/Genre":"genre","WM/Composer":"composer","WM/Lyrics":"lyrics","WM/AlbumSortOrder":"albumsort","WM/TitleSortOrder":"titlesort","WM/ArtistSortOrder":"artistsort","WM/AlbumArtistSortOrder":"albumartistsort","WM/ComposerSortOrder":"composersort","WM/Writer":"lyricist","WM/Conductor":"conductor","WM/ModifiedBy":"remixer","WM/Engineer":"engineer","WM/Producer":"producer","WM/DJMixer":"djmixer","WM/Mixer":"mixer","WM/Publisher":"label","WM/ContentGroupDescription":"grouping","WM/SubTitle":"subtitle","WM/SetSubTitle":"discsubtitle","WM/IsCompilation":"compilation","WM/SharedUserRating":"rating","WM/BeatsPerMinute":"bpm","WM/Mood":"mood","WM/Media":"media","WM/CatalogNo":"catalognumber","MusicBrainz/Album Status":"releasestatus","MusicBrainz/Album Type":"releasetype","MusicBrainz/Album Release Country":"releasecountry","WM/Script":"script","WM/Language":"language",Copyright:"copyright",LICENSE:"license","WM/EncodedBy":"encodedby","WM/EncodingSettings":"encodersettings","WM/Barcode":"barcode","WM/ISRC":"isrc","MusicBrainz/Track Id":"musicbrainz_recordingid","MusicBrainz/Release Track Id":"musicbrainz_trackid","MusicBrainz/Album Id":"musicbrainz_albumid","MusicBrainz/Artist Id":"musicbrainz_artistid","MusicBrainz/Album Artist Id":"musicbrainz_albumartistid","MusicBrainz/Release Group Id":"musicbrainz_releasegroupid","MusicBrainz/Work Id":"musicbrainz_workid","MusicBrainz/TRM Id":"musicbrainz_trmid","MusicBrainz/Disc Id":"musicbrainz_discid","Acoustid/Id":"acoustid_id","Acoustid/Fingerprint":"acoustid_fingerprint","MusicIP/PUID":"musicip_puid","WM/ARTISTS":"artists","WM/InitialKey":"key",ASIN:"asin","WM/Work":"work","WM/AuthorURL":"website","WM/Picture":"picture"};class Uw extends Qn{static toRating(e){return{rating:Number.parseFloat(e+1)/5}}constructor(){super(["asf"],UG)}postMap(e){switch(e.id){case"WM/SharedUserRating":{const n=e.id.split(":");e.value=Uw.toRating(e.value),e.id=n[0];break}}}}const VG={TT2:"title",TP1:"artist",TP2:"albumartist",TAL:"album",TYE:"year",COM:"comment",TRK:"track",TPA:"disk",TCO:"genre",PIC:"picture",TCM:"composer",TOR:"originaldate",TOT:"originalalbum",TXT:"lyricist",TP3:"conductor",TPB:"label",TT1:"grouping",TT3:"subtitle",TLA:"language",TCR:"copyright",WCP:"license",TEN:"encodedby",TSS:"encodersettings",WAR:"website",PCS:"podcast",TCP:"compilation",TDR:"date",TS2:"albumartistsort",TSA:"albumsort",TSC:"composersort",TSP:"artistsort",TST:"titlesort",WFD:"podcasturl",TBP:"bpm"};class HG extends Wu{constructor(){super(["ID3v2.2"],VG)}}const WG={Title:"title",Artist:"artist",Artists:"artists","Album Artist":"albumartist",Album:"album",Year:"date",Originalyear:"originalyear",Originaldate:"originaldate",Releasedate:"releasedate",Comment:"comment",Track:"track",Disc:"disk",DISCNUMBER:"disk",Genre:"genre","Cover Art (Front)":"picture","Cover Art (Back)":"picture",Composer:"composer",Lyrics:"lyrics",ALBUMSORT:"albumsort",TITLESORT:"titlesort",WORK:"work",ARTISTSORT:"artistsort",ALBUMARTISTSORT:"albumartistsort",COMPOSERSORT:"composersort",Lyricist:"lyricist",Writer:"writer",Conductor:"conductor",MixArtist:"remixer",Arranger:"arranger",Engineer:"engineer",Producer:"producer",DJMixer:"djmixer",Mixer:"mixer",Label:"label",Grouping:"grouping",Subtitle:"subtitle",DiscSubtitle:"discsubtitle",Compilation:"compilation",BPM:"bpm",Mood:"mood",Media:"media",CatalogNumber:"catalognumber",MUSICBRAINZ_ALBUMSTATUS:"releasestatus",MUSICBRAINZ_ALBUMTYPE:"releasetype",RELEASECOUNTRY:"releasecountry",Script:"script",Language:"language",Copyright:"copyright",LICENSE:"license",EncodedBy:"encodedby",EncoderSettings:"encodersettings",Barcode:"barcode",ISRC:"isrc",ASIN:"asin",musicbrainz_trackid:"musicbrainz_recordingid",musicbrainz_releasetrackid:"musicbrainz_trackid",MUSICBRAINZ_ALBUMID:"musicbrainz_albumid",MUSICBRAINZ_ARTISTID:"musicbrainz_artistid",MUSICBRAINZ_ALBUMARTISTID:"musicbrainz_albumartistid",MUSICBRAINZ_RELEASEGROUPID:"musicbrainz_releasegroupid",MUSICBRAINZ_WORKID:"musicbrainz_workid",MUSICBRAINZ_TRMID:"musicbrainz_trmid",MUSICBRAINZ_DISCID:"musicbrainz_discid",Acoustid_Id:"acoustid_id",ACOUSTID_FINGERPRINT:"acoustid_fingerprint",MUSICIP_PUID:"musicip_puid",Weblink:"website",REPLAYGAIN_TRACK_GAIN:"replaygain_track_gain",REPLAYGAIN_TRACK_PEAK:"replaygain_track_peak",MP3GAIN_MINMAX:"replaygain_track_minmax",MP3GAIN_UNDO:"replaygain_undo"};class qG extends Wu{constructor(){super(["APEv2"],WG)}}const GG={"nam":"title","ART":"artist",aART:"albumartist","----:com.apple.iTunes:Band":"albumartist","alb":"album","day":"date","cmt":"comment","com":"comment",trkn:"track",disk:"disk","gen":"genre",covr:"picture","wrt":"composer","lyr":"lyrics",soal:"albumsort",sonm:"titlesort",soar:"artistsort",soaa:"albumartistsort",soco:"composersort","----:com.apple.iTunes:LYRICIST":"lyricist","----:com.apple.iTunes:CONDUCTOR":"conductor","----:com.apple.iTunes:REMIXER":"remixer","----:com.apple.iTunes:ENGINEER":"engineer","----:com.apple.iTunes:PRODUCER":"producer","----:com.apple.iTunes:DJMIXER":"djmixer","----:com.apple.iTunes:MIXER":"mixer","----:com.apple.iTunes:LABEL":"label","grp":"grouping","----:com.apple.iTunes:SUBTITLE":"subtitle","----:com.apple.iTunes:DISCSUBTITLE":"discsubtitle",cpil:"compilation",tmpo:"bpm","----:com.apple.iTunes:MOOD":"mood","----:com.apple.iTunes:MEDIA":"media","----:com.apple.iTunes:CATALOGNUMBER":"catalognumber",tvsh:"tvShow",tvsn:"tvSeason",tves:"tvEpisode",sosn:"tvShowSort",tven:"tvEpisodeId",tvnn:"tvNetwork",pcst:"podcast",purl:"podcasturl","----:com.apple.iTunes:MusicBrainz Album Status":"releasestatus","----:com.apple.iTunes:MusicBrainz Album Type":"releasetype","----:com.apple.iTunes:MusicBrainz Album Release Country":"releasecountry","----:com.apple.iTunes:SCRIPT":"script","----:com.apple.iTunes:LANGUAGE":"language",cprt:"copyright","cpy":"copyright","----:com.apple.iTunes:LICENSE":"license","too":"encodedby",pgap:"gapless","----:com.apple.iTunes:BARCODE":"barcode","----:com.apple.iTunes:ISRC":"isrc","----:com.apple.iTunes:ASIN":"asin","----:com.apple.iTunes:NOTES":"comment","----:com.apple.iTunes:MusicBrainz Track Id":"musicbrainz_recordingid","----:com.apple.iTunes:MusicBrainz Release Track Id":"musicbrainz_trackid","----:com.apple.iTunes:MusicBrainz Album Id":"musicbrainz_albumid","----:com.apple.iTunes:MusicBrainz Artist Id":"musicbrainz_artistid","----:com.apple.iTunes:MusicBrainz Album Artist Id":"musicbrainz_albumartistid","----:com.apple.iTunes:MusicBrainz Release Group Id":"musicbrainz_releasegroupid","----:com.apple.iTunes:MusicBrainz Work Id":"musicbrainz_workid","----:com.apple.iTunes:MusicBrainz TRM Id":"musicbrainz_trmid","----:com.apple.iTunes:MusicBrainz Disc Id":"musicbrainz_discid","----:com.apple.iTunes:Acoustid Id":"acoustid_id","----:com.apple.iTunes:Acoustid Fingerprint":"acoustid_fingerprint","----:com.apple.iTunes:MusicIP PUID":"musicip_puid","----:com.apple.iTunes:fingerprint":"musicip_fingerprint","----:com.apple.iTunes:replaygain_track_gain":"replaygain_track_gain","----:com.apple.iTunes:replaygain_track_peak":"replaygain_track_peak","----:com.apple.iTunes:replaygain_album_gain":"replaygain_album_gain","----:com.apple.iTunes:replaygain_album_peak":"replaygain_album_peak","----:com.apple.iTunes:replaygain_track_minmax":"replaygain_track_minmax","----:com.apple.iTunes:replaygain_album_minmax":"replaygain_album_minmax","----:com.apple.iTunes:replaygain_undo":"replaygain_undo",gnre:"genre","----:com.apple.iTunes:ALBUMARTISTSORT":"albumartistsort","----:com.apple.iTunes:ARTISTS":"artists","----:com.apple.iTunes:ORIGINALDATE":"originaldate","----:com.apple.iTunes:ORIGINALYEAR":"originalyear","----:com.apple.iTunes:RELEASEDATE":"releasedate",desc:"description",ldes:"longDescription","mvn":"movement","mvi":"movementIndex","mvc":"movementTotal","wrk":"work",catg:"category",egid:"podcastId",hdvd:"hdVideo",keyw:"keywords",shwm:"showMovement",stik:"stik",rate:"rating"},QG="iTunes";class SE extends Wu{constructor(){super([QG],GG)}postMap(e,n){switch(e.id){case"rate":e.value={source:void 0,rating:Number.parseFloat(e.value)/100};break}}}const KG={TITLE:"title",ARTIST:"artist",ARTISTS:"artists",ALBUMARTIST:"albumartist","ALBUM ARTIST":"albumartist",ALBUM:"album",DATE:"date",ORIGINALDATE:"originaldate",ORIGINALYEAR:"originalyear",RELEASEDATE:"releasedate",COMMENT:"comment",TRACKNUMBER:"track",DISCNUMBER:"disk",GENRE:"genre",METADATA_BLOCK_PICTURE:"picture",COMPOSER:"composer",LYRICS:"lyrics",ALBUMSORT:"albumsort",TITLESORT:"titlesort",WORK:"work",ARTISTSORT:"artistsort",ALBUMARTISTSORT:"albumartistsort",COMPOSERSORT:"composersort",LYRICIST:"lyricist",WRITER:"writer",CONDUCTOR:"conductor",REMIXER:"remixer",ARRANGER:"arranger",ENGINEER:"engineer",PRODUCER:"producer",DJMIXER:"djmixer",MIXER:"mixer",LABEL:"label",GROUPING:"grouping",SUBTITLE:"subtitle",DISCSUBTITLE:"discsubtitle",TRACKTOTAL:"totaltracks",DISCTOTAL:"totaldiscs",COMPILATION:"compilation",RATING:"rating",BPM:"bpm",KEY:"key",MOOD:"mood",MEDIA:"media",CATALOGNUMBER:"catalognumber",RELEASESTATUS:"releasestatus",RELEASETYPE:"releasetype",RELEASECOUNTRY:"releasecountry",SCRIPT:"script",LANGUAGE:"language",COPYRIGHT:"copyright",LICENSE:"license",ENCODEDBY:"encodedby",ENCODERSETTINGS:"encodersettings",BARCODE:"barcode",ISRC:"isrc",ASIN:"asin",MUSICBRAINZ_TRACKID:"musicbrainz_recordingid",MUSICBRAINZ_RELEASETRACKID:"musicbrainz_trackid",MUSICBRAINZ_ALBUMID:"musicbrainz_albumid",MUSICBRAINZ_ARTISTID:"musicbrainz_artistid",MUSICBRAINZ_ALBUMARTISTID:"musicbrainz_albumartistid",MUSICBRAINZ_RELEASEGROUPID:"musicbrainz_releasegroupid",MUSICBRAINZ_WORKID:"musicbrainz_workid",MUSICBRAINZ_TRMID:"musicbrainz_trmid",MUSICBRAINZ_DISCID:"musicbrainz_discid",ACOUSTID_ID:"acoustid_id",ACOUSTID_ID_FINGERPRINT:"acoustid_fingerprint",MUSICIP_PUID:"musicip_puid",WEBSITE:"website",NOTES:"notes",TOTALTRACKS:"totaltracks",TOTALDISCS:"totaldiscs",DISCOGS_ARTIST_ID:"discogs_artist_id",DISCOGS_ARTISTS:"artists",DISCOGS_ARTIST_NAME:"artists",DISCOGS_ALBUM_ARTISTS:"albumartist",DISCOGS_CATALOG:"catalognumber",DISCOGS_COUNTRY:"releasecountry",DISCOGS_DATE:"originaldate",DISCOGS_LABEL:"label",DISCOGS_LABEL_ID:"discogs_label_id",DISCOGS_MASTER_RELEASE_ID:"discogs_master_release_id",DISCOGS_RATING:"discogs_rating",DISCOGS_RELEASED:"date",DISCOGS_RELEASE_ID:"discogs_release_id",DISCOGS_VOTES:"discogs_votes",CATALOGID:"catalognumber",STYLE:"genre",REPLAYGAIN_TRACK_GAIN:"replaygain_track_gain",REPLAYGAIN_TRACK_PEAK:"replaygain_track_peak",REPLAYGAIN_ALBUM_GAIN:"replaygain_album_gain",REPLAYGAIN_ALBUM_PEAK:"replaygain_album_peak",REPLAYGAIN_MINMAX:"replaygain_track_minmax",REPLAYGAIN_ALBUM_MINMAX:"replaygain_album_minmax",REPLAYGAIN_UNDO:"replaygain_undo"};class Ef extends Qn{static toRating(e,n,r){return{source:e?e.toLowerCase():void 0,rating:Number.parseFloat(n)/r*Qn.maxRatingScore}}constructor(){super(["vorbis"],KG)}postMap(e){if(e.id==="RATING")e.value=Ef.toRating(void 0,e.value,100);else if(e.id.indexOf("RATING:")===0){const n=e.id.split(":");e.value=Ef.toRating(n[1],e.value,1),e.id=n[0]}}}const XG={IART:"artist",ICRD:"date",INAM:"title",TITL:"title",IPRD:"album",ITRK:"track",IPRT:"track",COMM:"comment",ICMT:"comment",ICNT:"releasecountry",GNRE:"genre",IWRI:"writer",RATE:"rating",YEAR:"year",ISFT:"encodedby",CODE:"encodedby",TURL:"website",IGNR:"genre",IENG:"engineer",ITCH:"technician",IMED:"media",IRPD:"album"};class YG extends Qn{constructor(){super(["exif"],XG)}}const JG={"segment:title":"title","album:ARTIST":"albumartist","album:ARTISTSORT":"albumartistsort","album:TITLE":"album","album:DATE_RECORDED":"originaldate","album:DATE_RELEASED":"releasedate","album:PART_NUMBER":"disk","album:TOTAL_PARTS":"totaltracks","track:ARTIST":"artist","track:ARTISTSORT":"artistsort","track:TITLE":"title","track:PART_NUMBER":"track","track:MUSICBRAINZ_TRACKID":"musicbrainz_recordingid","track:MUSICBRAINZ_ALBUMID":"musicbrainz_albumid","track:MUSICBRAINZ_ARTISTID":"musicbrainz_artistid","track:PUBLISHER":"label","track:GENRE":"genre","track:ENCODER":"encodedby","track:ENCODER_OPTIONS":"encodersettings","edition:TOTAL_PARTS":"totaldiscs",picture:"picture"};class ZG extends Wu{constructor(){super(["matroska"],JG)}}const eQ={NAME:"title",AUTH:"artist","(c) ":"copyright",ANNO:"comment"};class tQ extends Qn{constructor(){super(["AIFF"],eQ)}}class nQ{constructor(){this.tagMappers={},[new BG,new HG,new zw,new SE,new SE,new Ef,new qG,new Uw,new YG,new ZG,new tQ].forEach(e=>{this.registerTagMapper(e)})}mapTag(e,n,r){if(this.tagMappers[e])return this.tagMappers[e].mapGenericTag(n,r);throw new Error(`No generic tag mapper defined for tag-format: ${e}`)}registerTagMapper(e){for(const n of e.tagTypes)this.tagMappers[n]=e}}const aa=ze("music-metadata:collector"),rQ=["matroska","APEv2","vorbis","ID3v2.4","ID3v2.3","ID3v2.2","exif","asf","iTunes","AIFF","ID3v1"];class sQ{constructor(e){this.opts=e,this.format={tagTypes:[],trackInfo:[]},this.native={},this.common={track:{no:null,of:null},disk:{no:null,of:null},movementIndex:{no:null,of:null}},this.quality={warnings:[]},this.commonOrigin={},this.originPriority={},this.tagMapper=new nQ;let n=1;for(const r of rQ)this.originPriority[r]=n++;this.originPriority.artificial=500,this.originPriority.id3v1=600}hasAny(){return Object.keys(this.native).length>0}addStreamInfo(e){aa(`streamInfo: type=${e.type?Ua[e.type]:"?"}, codec=${e.codecName}`),this.format.trackInfo.push(e)}setFormat(e,n){var r;aa(`format: ${e} = ${n}`),this.format[e]=n,(r=this.opts)!=null&&r.observer&&this.opts.observer({metadata:this,tag:{type:"format",id:e,value:n}})}async addTag(e,n,r){aa(`tag ${e}.${n} = ${r}`),this.native[e]||(this.format.tagTypes.push(e),this.native[e]=[]),this.native[e].push({id:n,value:r}),await this.toCommon(e,n,r)}addWarning(e){this.quality.warnings.push({message:e})}async postMap(e,n){switch(n.id){case"artist":if(this.commonOrigin.artist===this.originPriority[e])return this.postMap("artificial",{id:"artists",value:n.value});this.common.artists||this.setGenericTag("artificial",{id:"artists",value:n.value});break;case"artists":if((!this.common.artist||this.commonOrigin.artist===this.originPriority.artificial)&&(!this.common.artists||this.common.artists.indexOf(n.value)===-1)){const r=(this.common.artists||[]).concat([n.value]),i={id:"artist",value:iQ(r)};this.setGenericTag("artificial",i)}break;case"picture":return this.postFixPicture(n.value).then(r=>{r!==null&&(n.value=r,this.setGenericTag(e,n))});case"totaltracks":this.common.track.of=Qn.toIntOrNull(n.value);return;case"totaldiscs":this.common.disk.of=Qn.toIntOrNull(n.value);return;case"movementTotal":this.common.movementIndex.of=Qn.toIntOrNull(n.value);return;case"track":case"disk":case"movementIndex":{const r=this.common[n.id].of;this.common[n.id]=Qn.normalizeTrack(n.value),this.common[n.id].of=r??this.common[n.id].of;return}case"bpm":case"year":case"originalyear":n.value=Number.parseInt(n.value,10);break;case"date":{const r=Number.parseInt(n.value.substr(0,4),10);Number.isNaN(r)||(this.common.year=r);break}case"discogs_label_id":case"discogs_release_id":case"discogs_master_release_id":case"discogs_artist_id":case"discogs_votes":n.value=typeof n.value=="string"?Number.parseInt(n.value,10):n.value;break;case"replaygain_track_gain":case"replaygain_track_peak":case"replaygain_album_gain":case"replaygain_album_peak":n.value=LG(n.value);break;case"replaygain_track_minmax":n.value=n.value.split(",").map(r=>Number.parseInt(r,10));break;case"replaygain_undo":{const r=n.value.split(",").map(s=>Number.parseInt(s,10));n.value={leftChannel:r[0],rightChannel:r[1]};break}case"gapless":case"compilation":case"podcast":case"showMovement":n.value=n.value==="1"||n.value===1;break;case"isrc":{const r=this.common[n.id];if(r&&r.indexOf(n.value)!==-1)return;break}case"comment":typeof n.value=="string"&&(n.value={text:n.value}),n.value.descriptor==="iTunPGAP"&&this.setGenericTag(e,{id:"gapless",value:n.value.text==="1"});break}n.value!==null&&this.setGenericTag(e,n)}toCommonMetadata(){return{format:this.format,native:this.native,quality:this.quality,common:this.common}}async postFixPicture(e){if(e.data&&e.data.length>0){if(!e.format){const n=await AA(Uint8Array.from(e.data));if(n)e.format=n.mime;else return null}switch(e.format=e.format.toLocaleLowerCase(),e.format){case"image/jpg":e.format="image/jpeg"}return e}return this.addWarning("Empty picture tag found"),null}async toCommon(e,n,r){const s={id:n,value:r},i=this.tagMapper.mapTag(e,s,this);i&&await this.postMap(e,i)}setGenericTag(e,n){var i;aa(`common.${n.id} = ${n.value}`);const r=this.commonOrigin[n.id]||1e3,s=this.originPriority[e];if(MG(n.id))if(s<=r)this.common[n.id]=n.value,this.commonOrigin[n.id]=s;else return aa(`Ignore native tag (singleton): ${e}.${n.id} = ${n.value}`);else if(s===r)!OG(n.id)||this.common[n.id].indexOf(n.value)===-1?this.common[n.id].push(n.value):aa(`Ignore duplicate value: ${e}.${n.id} = ${n.value}`);else if(s<r)this.common[n.id]=[n.value],this.commonOrigin[n.id]=s;else return aa(`Ignore native tag (list): ${e}.${n.id} = ${n.value}`);(i=this.opts)!=null&&i.observer&&this.opts.observer({metadata:this,tag:{type:"common",id:n.id,value:n.value}})}}function iQ(t){return t.length>2?`${t.slice(0,t.length-1).join(", ")} & ${t[t.length-1]}`:t.join(" & ")}class sr{constructor(){this.metadata=void 0,this.tokenizer=void 0,this.options=void 0}init(e,n,r){return this.metadata=e,this.tokenizer=n,this.options=r,this}}const aQ=/^[\x21-\x7e][\x20-\x7e\x00()]{3}/,Ye={len:4,get:(t,e)=>{const n=Ow(t.slice(e,e+Ye.len),"latin1");if(!n.match(aQ))throw new Error(`FourCC contains invalid characters: ${PG(n)} "${n}"`);return n},put:(t,e,n)=>{const r=oG(n);if(r.length!==4)throw new Error("Invalid length");return t.set(r,e),e+4}};var Co;(function(t){t[t.text_utf8=0]="text_utf8",t[t.binary=1]="binary",t[t.external_info=2]="external_info",t[t.reserved=3]="reserved"})(Co||(Co={}));const EE={len:52,get:(t,e)=>({ID:Ye.get(t,e),version:J.get(t,e+4)/1e3,descriptorBytes:J.get(t,e+8),headerBytes:J.get(t,e+12),seekTableBytes:J.get(t,e+16),headerDataBytes:J.get(t,e+20),apeFrameDataBytes:J.get(t,e+24),apeFrameDataBytesHigh:J.get(t,e+28),terminatingDataBytes:J.get(t,e+32),fileMD5:new Sn(16).get(t,e+36)})},oQ={len:24,get:(t,e)=>({compressionLevel:De.get(t,e),formatFlags:De.get(t,e+2),blocksPerFrame:J.get(t,e+4),finalFrameBlocks:J.get(t,e+8),totalFrames:J.get(t,e+12),bitsPerSample:De.get(t,e+16),channel:De.get(t,e+18),sampleRate:J.get(t,e+20)})},or={len:32,get:(t,e)=>({ID:new ne(8,"ascii").get(t,e),version:J.get(t,e+8),size:J.get(t,e+12),fields:J.get(t,e+16),flags:MA(J.get(t,e+20))})},wg={len:8,get:(t,e)=>({size:J.get(t,e),flags:MA(J.get(t,e+4))})};function MA(t){return{containsHeader:Md(t,31),containsFooter:Md(t,30),isHeader:Md(t,29),readOnly:Md(t,0),dataType:(t&6)>>1}}function Md(t,e){return(t&1<<e)!==0}const oa=ze("music-metadata:parser:APEv2"),kE="APEv2",TE="APETAGEX";class ts extends sr{constructor(){super(...arguments),this.ape={}}static tryParseApeHeader(e,n,r){const s=new ts;return s.init(e,n,r),s.tryParseApeHeader()}static calculateDuration(e){let n=e.totalFrames>1?e.blocksPerFrame*(e.totalFrames-1):0;return n+=e.finalFrameBlocks,n/e.sampleRate}static async findApeFooterOffset(e,n){const r=new Uint8Array(or.len);await e.randomRead(r,0,or.len,n-or.len);const s=or.get(r,0);if(s.ID==="APETAGEX")return s.flags.isHeader?oa(`APE Header found at offset=${n-or.len}`):(oa(`APE Footer found at offset=${n-or.len}`),n-=s.size),{footer:s,offset:n}}static parseTagFooter(e,n,r){const s=or.get(n,n.length-or.len);if(s.ID!==TE)throw new Error("Unexpected APEv2 Footer ID preamble value.");tl(n);const i=new ts;return i.init(e,tl(n),r),i.parseTags(s)}async tryParseApeHeader(){if(this.tokenizer.fileInfo.size&&this.tokenizer.fileInfo.size-this.tokenizer.position<or.len){oa("No APEv2 header found, end-of-file reached");return}const e=await this.tokenizer.peekToken(or);if(e.ID===TE)return await this.tokenizer.ignore(or.len),this.parseTags(e);if(oa(`APEv2 header not found at offset=${this.tokenizer.position}`),this.tokenizer.fileInfo.size){const n=this.tokenizer.fileInfo.size-this.tokenizer.position,r=new Uint8Array(n);return await this.tokenizer.readBuffer(r),ts.parseTagFooter(this.metadata,r,this.options)}}async parse(){const e=await this.tokenizer.readToken(EE);if(e.ID!=="MAC ")throw new Error("Unexpected descriptor ID");this.ape.descriptor=e;const n=e.descriptorBytes-EE.len,r=await(n>0?this.parseDescriptorExpansion(n):this.parseHeader());return await this.tokenizer.ignore(r.forwardBytes),this.tryParseApeHeader()}async parseTags(e){const n=new Uint8Array(256);let r=e.size-or.len;oa(`Parse APE tags at offset=${this.tokenizer.position}, size=${r}`);for(let s=0;s<e.fields;s++){if(r<wg.len){this.metadata.addWarning(`APEv2 Tag-header: ${e.fields-s} items remaining, but no more tag data to read.`);break}const i=await this.tokenizer.readToken(wg);r-=wg.len+i.size,await this.tokenizer.peekBuffer(n,{length:Math.min(n.length,r)});let a=Bn(n,0,n.length);const l=await this.tokenizer.readToken(new ne(a,"ascii"));switch(await this.tokenizer.ignore(1),r-=l.length+1,i.flags.dataType){case Co.text_utf8:{const u=(await this.tokenizer.readToken(new ne(i.size,"utf8"))).split(/\x00/g);await Promise.all(u.map(d=>this.metadata.addTag(kE,l,d)));break}case Co.binary:if(this.options.skipCovers)await this.tokenizer.ignore(i.size);else{const c=new Uint8Array(i.size);await this.tokenizer.readBuffer(c),a=Bn(c,0,c.length);const u=Ow(c.slice(0,a)),d=c.slice(a+1);await this.metadata.addTag(kE,l,{description:u,data:d})}break;case Co.external_info:oa(`Ignore external info ${l}`),await this.tokenizer.ignore(i.size);break;case Co.reserved:oa(`Ignore external info ${l}`),this.metadata.addWarning(`APEv2 header declares a reserved datatype for "${l}"`),await this.tokenizer.ignore(i.size);break}}}async parseDescriptorExpansion(e){return await this.tokenizer.ignore(e),this.parseHeader()}async parseHeader(){const e=await this.tokenizer.readToken(oQ);if(this.metadata.setFormat("lossless",!0),this.metadata.setFormat("container","Monkey's Audio"),this.metadata.setFormat("bitsPerSample",e.bitsPerSample),this.metadata.setFormat("sampleRate",e.sampleRate),this.metadata.setFormat("numberOfChannels",e.channel),this.metadata.setFormat("duration",ts.calculateDuration(e)),!this.ape.descriptor)throw new Error("Missing APE descriptor");return{forwardBytes:this.ape.descriptor.seekTableBytes+this.ape.descriptor.headerDataBytes+this.ape.descriptor.apeFrameDataBytes+this.ape.descriptor.terminatingDataBytes}}}const Od=ze("music-metadata:parser:ID3v1"),kf=["Blues","Classic Rock","Country","Dance","Disco","Funk","Grunge","Hip-Hop","Jazz","Metal","New Age","Oldies","Other","Pop","R&B","Rap","Reggae","Rock","Techno","Industrial","Alternative","Ska","Death Metal","Pranks","Soundtrack","Euro-Techno","Ambient","Trip-Hop","Vocal","Jazz+Funk","Fusion","Trance","Classical","Instrumental","Acid","House","Game","Sound Clip","Gospel","Noise","Alt. Rock","Bass","Soul","Punk","Space","Meditative","Instrumental Pop","Instrumental Rock","Ethnic","Gothic","Darkwave","Techno-Industrial","Electronic","Pop-Folk","Eurodance","Dream","Southern Rock","Comedy","Cult","Gangsta Rap","Top 40","Christian Rap","Pop/Funk","Jungle","Native American","Cabaret","New Wave","Psychedelic","Rave","Showtunes","Trailer","Lo-Fi","Tribal","Acid Punk","Acid Jazz","Polka","Retro","Musical","Rock & Roll","Hard Rock","Folk","Folk/Rock","National Folk","Swing","Fast-Fusion","Bebob","Latin","Revival","Celtic","Bluegrass","Avantgarde","Gothic Rock","Progressive Rock","Psychedelic Rock","Symphonic Rock","Slow Rock","Big Band","Chorus","Easy Listening","Acoustic","Humour","Speech","Chanson","Opera","Chamber Music","Sonata","Symphony","Booty Bass","Primus","Porn Groove","Satire","Slow Jam","Club","Tango","Samba","Folklore","Ballad","Power Ballad","Rhythmic Soul","Freestyle","Duet","Punk Rock","Drum Solo","A Cappella","Euro-House","Dance Hall","Goa","Drum & Bass","Club-House","Hardcore","Terror","Indie","BritPop","Negerpunk","Polsk Punk","Beat","Christian Gangsta Rap","Heavy Metal","Black Metal","Crossover","Contemporary Christian","Christian Rock","Merengue","Salsa","Thrash Metal","Anime","JPop","Synthpop","Abstract","Art Rock","Baroque","Bhangra","Big Beat","Breakbeat","Chillout","Downtempo","Dub","EBM","Eclectic","Electro","Electroclash","Emo","Experimental","Garage","Global","IDM","Illbient","Industro-Goth","Jam Band","Krautrock","Leftfield","Lounge","Math Rock","New Romantic","Nu-Breakz","Post-Punk","Post-Rock","Psytrance","Shoegaze","Space Rock","Trop Rock","World Music","Neoclassical","Audiobook","Audio Theatre","Neue Deutsche Welle","Podcast","Indie Rock","G-Funk","Dubstep","Garage Rock","Psybient"],$d={len:128,get:(t,e)=>{const n=new ao(3).get(t,e);return n==="TAG"?{header:n,title:new ao(30).get(t,e+3),artist:new ao(30).get(t,e+33),album:new ao(30).get(t,e+63),year:new ao(4).get(t,e+93),comment:new ao(28).get(t,e+97),zeroByte:pe.get(t,e+127),track:pe.get(t,e+126),genre:pe.get(t,e+127)}:null}};class ao{constructor(e){this.len=e,this.stringType=new ne(e,"latin1")}get(e,n){let r=this.stringType.get(e,n);return r=FA(r),r=r.trim(),r.length>0?r:void 0}}class Vw extends sr{static getGenre(e){if(e<kf.length)return kf[e]}async parse(){if(!this.tokenizer.fileInfo.size){Od("Skip checking for ID3v1 because the file-size is unknown");return}if(this.options.apeHeader){this.tokenizer.ignore(this.options.apeHeader.offset-this.tokenizer.position);const r=new ts;r.init(this.metadata,this.tokenizer,this.options),await r.parseTags(this.options.apeHeader.footer)}const e=this.tokenizer.fileInfo.size-$d.len;if(this.tokenizer.position>e){Od("Already consumed the last 128 bytes");return}const n=await this.tokenizer.readToken($d,e);if(n){Od("ID3v1 header found at: pos=%s",this.tokenizer.fileInfo.size-$d.len);const r=["title","artist","album","comment","track","year"];for(const i of r)n[i]&&n[i]!==""&&await this.addTag(i,n[i]);const s=Vw.getGenre(n.genre);s&&await this.addTag("genre",s)}else Od("ID3v1 header not found at: pos=%s",this.tokenizer.fileInfo.size-$d.len)}async addTag(e,n){await this.metadata.addTag("ID3v1",e,n)}}const IE=ze("music-metadata:id3v2:frame-parser"),jr="latin1";function lQ(t){const e=[];let n,r="";for(const s of t)if(typeof n=="string")if(s==="("&&n==="")r+="(",n=void 0;else if(s===")"){r!==""&&(e.push(r),r="");const i=CE(n);i&&e.push(i),n=void 0}else n+=s;else s==="("?n="":r+=s;return r&&(e.length===0&&r.match(/^\d*$/)&&(r=CE(r)),r&&e.push(r)),e}function CE(t){if(t==="RX")return"Remix";if(t==="CR")return"Cover";if(t.match(/^\d*$/))return kf[Number.parseInt(t)]}class zn{constructor(e,n){this.major=e,this.warningCollector=n}readData(e,n,r){if(e.length===0){this.warningCollector.addWarning(`id3v2.${this.major} header has empty tag type=${n}`);return}const{encoding:s,bom:i}=LA.get(e,0),a=e.length;let l=0,c=[];const u=zn.getNullTerminatorLength(s);let d;switch(IE(`Parsing tag type=${n}, encoding=${s}, bom=${i}`),n!=="TXXX"&&n[0]==="T"?"T*":n){case"T*":case"GRP1":case"IPLS":case"MVIN":case"MVNM":case"PCS":case"PCST":{let f;try{f=St(e.slice(1),s).replace(/\x00+$/,"")}catch(p){if(p instanceof Error){this.warningCollector.addWarning(`id3v2.${this.major} type=${n} header has invalid string value: ${p.message}`);break}throw p}switch(n){case"TMCL":case"TIPL":case"IPLS":c=zn.functionList(this.splitValue(n,f));break;case"TRK":case"TRCK":case"TPOS":c=f;break;case"TCOM":case"TEXT":case"TOLY":case"TOPE":case"TPE1":case"TSRC":c=this.splitValue(n,f);break;case"TCO":case"TCON":c=this.splitValue(n,f).map(p=>lQ(p)).reduce((p,g)=>p.concat(g),[]);break;case"PCS":case"PCST":c=this.major>=4?this.splitValue(n,f):[f],c=Array.isArray(c)&&c[0]===""?1:0;break;default:c=this.major>=4?this.splitValue(n,f):[f]}break}case"TXXX":{const f=zn.readIdentifierAndData(e,l+1,a,s);c={description:f.id,text:this.splitValue(n,St(f.data,s).replace(/\x00+$/,""))};break}case"PIC":case"APIC":if(r){const f={};switch(l+=1,this.major){case 2:f.format=St(e.slice(l,l+3),"latin1"),l+=3;break;case 3:case 4:d=Bn(e,l,a,jr),f.format=St(e.slice(l,d),jr),l=d+1;break;default:throw new Error(`Warning: unexpected major versionIndex: ${this.major}`)}f.format=zn.fixPictureMimeType(f.format),f.type=du[e[l]],l+=1,d=Bn(e,l,a,s),f.description=St(e.slice(l,d),s),l=d+u,f.data=e.slice(l,a),c=f}break;case"CNT":case"PCNT":c=re.get(e,0);break;case"SYLT":{const f=bE.get(e,0);l+=bE.len;const p={descriptor:"",language:f.language,contentType:f.contentType,timeStampFormat:f.timeStampFormat,syncText:[]};let g=!1;for(;l<a;){const v=zn.readNullTerminatedString(e.subarray(l),f.encoding);if(l+=v.len,g){const _=re.get(e,l);l+=re.len,p.syncText.push({text:v.text,timestamp:_})}else p.descriptor=v.text,g=!0}c=p;break}case"ULT":case"USLT":case"COM":case"COMM":{const f=kx.get(e,l);l+=kx.len;const p=zn.readNullTerminatedString(e.subarray(l),f.encoding);l+=p.len;const g=zn.readNullTerminatedString(e.subarray(l),f.encoding);c={language:f.language,descriptor:p.text,text:g.text};break}case"UFID":{const f=zn.readIdentifierAndData(e,l,a,jr);c={owner_identifier:f.id,identifier:f.data};break}case"PRIV":{const f=zn.readIdentifierAndData(e,l,a,jr);c={owner_identifier:f.id,data:f.data};break}case"POPM":{d=Bn(e,l,a,jr);const f=St(e.slice(l,d),jr);l=d+1;const p=a-l;c={email:f,rating:pe.get(e,l),counter:p>=5?re.get(e,l+1):void 0};break}case"GEOB":{d=Bn(e,l+1,a,s);const f=St(e.slice(l+1,d),jr);l=d+1,d=Bn(e,l,a-l,s);const p=St(e.slice(l,d),jr);l=d+1,d=Bn(e,l,a-l,s);const g=St(e.slice(l,d),jr);c={type:f,filename:p,description:g,data:e.slice(l+1,a)};break}case"WCOM":case"WCOP":case"WOAF":case"WOAR":case"WOAS":case"WORS":case"WPAY":case"WPUB":d=Bn(e,l+1,a,s),c=St(e.slice(l,d),jr);break;case"WXXX":{d=Bn(e,l+1,a,s);const f=St(e.slice(l+1,d),s);l=d+(s==="utf-16le"?2:1),c={description:f,url:St(e.slice(l,a),jr)};break}case"WFD":case"WFED":c=St(e.slice(l+1,Bn(e,l+1,a,s)),s);break;case"MCDI":{c=e.slice(0,a);break}default:IE(`Warning: unsupported id3v2-tag-type: ${n}`);break}return c}static readNullTerminatedString(e,n){let r=n.bom?2:0;const s=Bn(e,r,e.length,n.encoding),i=e.slice(r,s);return n.encoding==="utf-16le"?r=s+2:r=s+1,{text:St(i,n.encoding),len:r}}static fixPictureMimeType(e){switch(e=e.toLocaleLowerCase(),e){case"jpg":return"image/jpeg";case"png":return"image/png"}return e}static functionList(e){const n={};for(let r=0;r+1<e.length;r+=2){const s=e[r+1].split(",");n[e[r]]=n[e[r]]?n[e[r]].concat(s):s}return n}splitValue(e,n){let r;return this.major<4?(r=n.split(/\x00/g),r.length>1?this.warningCollector.addWarning(`ID3v2.${this.major} ${e} uses non standard null-separator.`):r=n.split(/\//g)):r=n.split(/\x00/g),zn.trimArray(r)}static trimArray(e){return e.map(n=>n.replace(/\x00+$/,"").trim())}static readIdentifierAndData(e,n,r,s){const i=Bn(e,n,r,s),a=St(e.slice(n,i),s);return n=i+zn.getNullTerminatorLength(s),{id:a,data:e.slice(n,r)}}static getNullTerminatorLength(e){return e==="utf-16le"?2:1}}const jE=new TextDecoder("ascii");class Fr{constructor(){this.tokenizer=void 0,this.id3Header=void 0,this.metadata=void 0,this.headerType=void 0,this.options=void 0}static removeUnsyncBytes(e){let n=0,r=0;for(;n<e.length-1;)n!==r&&(e[r]=e[n]),n+=e[n]===255&&e[n+1]===0?2:1,r++;return n<e.length&&(e[r++]=e[n]),e.slice(0,r)}static getFrameHeaderLength(e){switch(e){case 2:return 6;case 3:case 4:return 10;default:throw new Error("header versionIndex is incorrect")}}static readFrameFlags(e){return{status:{tag_alter_preservation:ct(e,0,6),file_alter_preservation:ct(e,0,5),read_only:ct(e,0,4)},format:{grouping_identity:ct(e,1,7),compression:ct(e,1,3),encryption:ct(e,1,2),unsynchronisation:ct(e,1,1),data_length_indicator:ct(e,1,0)}}}static readFrameData(e,n,r,s,i){var l,c;const a=new zn(r,i);switch(r){case 2:return a.readData(e,n.id,s);case 3:case 4:return(l=n.flags)!=null&&l.format.unsynchronisation&&(e=Fr.removeUnsyncBytes(e)),(c=n.flags)!=null&&c.format.data_length_indicator&&(e=e.slice(4,e.length)),a.readData(e,n.id,s);default:throw new Error(`Unexpected majorVer: ${r}`)}}static makeDescriptionTagName(e,n){return e+(n?`:${n}`:"")}async parse(e,n,r){this.tokenizer=n,this.metadata=e,this.options=r;const s=await this.tokenizer.readToken(Ex);if(s.fileIdentifier!=="ID3")throw new Error("expected ID3-header file-identifier 'ID3' was not found");return this.id3Header=s,this.headerType=`ID3v2.${s.version.major}`,s.flags.isExtendedHeader?this.parseExtendedHeader():this.parseId3Data(s.size)}async parseExtendedHeader(){const e=await this.tokenizer.readToken(_E),n=e.size-_E.len;return n>0?this.parseExtendedHeaderData(n,e.size):this.parseId3Data(this.id3Header.size-e.size)}async parseExtendedHeaderData(e,n){return await this.tokenizer.ignore(e),this.parseId3Data(this.id3Header.size-n)}async parseId3Data(e){const n=await this.tokenizer.readToken(new Sn(e));for(const r of this.parseMetadata(n))switch(r.id){case"TXXX":r.value&&await this.handleTag(r,r.value.text,()=>r.value.description);break;default:await(Array.isArray(r.value)?Promise.all(r.value.map(s=>this.addTag(r.id,s))):this.addTag(r.id,r.value))}}async handleTag(e,n,r,s=i=>i){await Promise.all(n.map(i=>this.addTag(Fr.makeDescriptionTagName(e.id,r(i)),s(i))))}async addTag(e,n){await this.metadata.addTag(this.headerType,e,n)}parseMetadata(e){let n=0;const r=[];for(;n!==e.length;){const s=Fr.getFrameHeaderLength(this.id3Header.version.major);if(n+s>e.length){this.metadata.addWarning("Illegal ID3v2 tag length");break}const i=e.slice(n,n+s);n+=s;const a=this.readFrameHeader(i,this.id3Header.version.major),l=e.slice(n,n+a.length);n+=a.length;const c=Fr.readFrameData(l,a,this.id3Header.version.major,!this.options.skipCovers,this.metadata);c&&r.push({id:a.id,value:c})}return r}readFrameHeader(e,n){let r;switch(n){case 2:r={id:jE.decode(e.slice(0,3)),length:vn.get(e,3)},r.id.match(/[A-Z0-9]{3}/g)||this.metadata.addWarning(`Invalid ID3v2.${this.id3Header.version.major} frame-header-ID: ${r.id}`);break;case 3:case 4:r={id:jE.decode(e.slice(0,4)),length:(n===4?DA:re).get(e,4),flags:Fr.readFrameFlags(e.slice(8,10))},r.id.match(/[A-Z0-9]{4}/g)||this.metadata.addWarning(`Invalid ID3v2.${this.id3Header.version.major} frame-header-ID: ${r.id}`);break;default:throw new Error(`Unexpected majorVer: ${n}`)}return r}}const cQ={NONE:"not compressed	PCM	Apple Computer",sowt:"PCM (byte swapped)",fl32:"32-bit floating point IEEE 32-bit float",fl64:"64-bit floating point IEEE 64-bit float	Apple Computer",alaw:"ALaw 2:1	8-bit ITU-T G.711 A-law",ulaw:"Law 2:1	8-bit ITU-T G.711 -law	Apple Computer",ULAW:"CCITT G.711 u-law 8-bit ITU-T G.711 -law",ALAW:"CCITT G.711 A-law 8-bit ITU-T G.711 A-law",FL32:"Float 32	IEEE 32-bit float "};class uQ{constructor(e,n){this.isAifc=n;const r=n?22:18;if(e.chunkSize<r)throw new Error(`COMMON CHUNK size should always be at least ${r}`);this.len=e.chunkSize}get(e,n){const r=Oe.get(e,n+8)-16398,s=Oe.get(e,n+8+2),i={numChannels:Oe.get(e,n),numSampleFrames:re.get(e,n+2),sampleSize:Oe.get(e,n+6),sampleRate:r<0?s>>Math.abs(r):s<<r};if(this.isAifc){if(i.compressionType=Ye.get(e,n+18),this.len>22){const a=pe.get(e,n+22);if(a>0){const l=(a+1)%2;if(23+a+l===this.len)i.compressionName=new ne(a,"latin1").get(e,n+23);else throw new Error("Illegal pstring length")}else i.compressionName=void 0}}else i.compressionName="PCM";return i}}const _g={len:8,get:(t,e)=>({chunkID:Ye.get(t,e),chunkSize:Number(BigInt(re.get(t,e+4)))})},bg=ze("music-metadata:parser:aiff");class dQ extends sr{constructor(){super(...arguments),this.isCompressed=null}async parse(){if((await this.tokenizer.readToken(_g)).chunkID!=="FORM")throw new Error("Invalid Chunk-ID, expected 'FORM'");const n=await this.tokenizer.readToken(Ye);switch(n){case"AIFF":this.metadata.setFormat("container",n),this.isCompressed=!1;break;case"AIFC":this.metadata.setFormat("container","AIFF-C"),this.isCompressed=!0;break;default:throw new Error(`Unsupported AIFF type: ${n}`)}this.metadata.setFormat("lossless",!this.isCompressed);try{for(;!this.tokenizer.fileInfo.size||this.tokenizer.fileInfo.size-this.tokenizer.position>=_g.len;){bg(`Reading AIFF chunk at offset=${this.tokenizer.position}`);const r=await this.tokenizer.readToken(_g),s=2*Math.round(r.chunkSize/2),i=await this.readData(r);await this.tokenizer.ignore(s-i)}}catch(r){if(r instanceof pt)bg("End-of-stream");else throw r}}async readData(e){switch(e.chunkID){case"COMM":{if(this.isCompressed===null)throw new Error("Failed to parse AIFF.COMM chunk when compression type is unknown");const n=await this.tokenizer.readToken(new uQ(e,this.isCompressed));return this.metadata.setFormat("bitsPerSample",n.sampleSize),this.metadata.setFormat("sampleRate",n.sampleRate),this.metadata.setFormat("numberOfChannels",n.numChannels),this.metadata.setFormat("numberOfSamples",n.numSampleFrames),this.metadata.setFormat("duration",n.numSampleFrames/n.sampleRate),(n.compressionName||n.compressionType)&&this.metadata.setFormat("codec",n.compressionName??cQ[n.compressionType]),e.chunkSize}case"ID3 ":{const n=await this.tokenizer.readToken(new Sn(e.chunkSize)),r=tl(n);return await new Fr().parse(this.metadata,r,this.options),e.chunkSize}case"SSND":return this.metadata.format.duration&&this.metadata.setFormat("bitrate",8*e.chunkSize/this.metadata.format.duration),0;case"NAME":case"AUTH":case"(c) ":case"ANNO":return this.readTextChunk(e);default:return bg(`Ignore chunk id=${e.chunkID}, size=${e.chunkSize}`),0}}async readTextChunk(e){const r=(await this.tokenizer.readToken(new ne(e.chunkSize,"ascii"))).split("\0").map(s=>s.trim()).filter(s=>s==null?void 0:s.length);return await Promise.all(r.map(s=>this.metadata.addTag("AIFF",e.chunkID,s))),e.chunkSize}}class ${static fromBin(e,n=0){return new $($.decode(e,n))}static decode(e,n=0){const r=new DataView(e.buffer,n);return`${r.getUint32(0,!0).toString(16)}-${r.getUint16(4,!0).toString(16)}-${r.getUint16(6,!0).toString(16)}-${r.getUint16(8).toString(16)}-${$w(e.slice(n+10,n+16))}`.toUpperCase()}static decodeMediaType(e){switch(e.str){case $.AudioMedia.str:return"audio";case $.VideoMedia.str:return"video";case $.CommandMedia.str:return"command";case $.Degradable_JPEG_Media.str:return"degradable-jpeg";case $.FileTransferMedia.str:return"file-transfer";case $.BinaryMedia.str:return"binary"}}static encode(e){const n=new Uint8Array(16),r=new DataView(n.buffer);return r.setUint32(0,Number.parseInt(e.slice(0,8),16),!0),r.setUint16(4,Number.parseInt(e.slice(9,13),16),!0),r.setUint16(6,Number.parseInt(e.slice(14,18),16),!0),n.set(mE(e.slice(19,23)),8),n.set(mE(e.slice(24)),10),n}constructor(e){this.str=e}equals(e){return this.str===e.str}toBin(){return $.encode(this.str)}}$.HeaderObject=new $("75B22630-668E-11CF-A6D9-00AA0062CE6C");$.DataObject=new $("75B22636-668E-11CF-A6D9-00AA0062CE6C");$.SimpleIndexObject=new $("33000890-E5B1-11CF-89F4-00A0C90349CB");$.IndexObject=new $("D6E229D3-35DA-11D1-9034-00A0C90349BE");$.MediaObjectIndexObject=new $("FEB103F8-12AD-4C64-840F-2A1D2F7AD48C");$.TimecodeIndexObject=new $("3CB73FD0-0C4A-4803-953D-EDF7B6228F0C");$.FilePropertiesObject=new $("8CABDCA1-A947-11CF-8EE4-00C00C205365");$.StreamPropertiesObject=new $("B7DC0791-A9B7-11CF-8EE6-00C00C205365");$.HeaderExtensionObject=new $("5FBF03B5-A92E-11CF-8EE3-00C00C205365");$.CodecListObject=new $("86D15240-311D-11D0-A3A4-00A0C90348F6");$.ScriptCommandObject=new $("1EFB1A30-0B62-11D0-A39B-00A0C90348F6");$.MarkerObject=new $("F487CD01-A951-11CF-8EE6-00C00C205365");$.BitrateMutualExclusionObject=new $("D6E229DC-35DA-11D1-9034-00A0C90349BE");$.ErrorCorrectionObject=new $("75B22635-668E-11CF-A6D9-00AA0062CE6C");$.ContentDescriptionObject=new $("75B22633-668E-11CF-A6D9-00AA0062CE6C");$.ExtendedContentDescriptionObject=new $("D2D0A440-E307-11D2-97F0-00A0C95EA850");$.ContentBrandingObject=new $("2211B3FA-BD23-11D2-B4B7-00A0C955FC6E");$.StreamBitratePropertiesObject=new $("7BF875CE-468D-11D1-8D82-006097C9A2B2");$.ContentEncryptionObject=new $("2211B3FB-BD23-11D2-B4B7-00A0C955FC6E");$.ExtendedContentEncryptionObject=new $("298AE614-2622-4C17-B935-DAE07EE9289C");$.DigitalSignatureObject=new $("2211B3FC-BD23-11D2-B4B7-00A0C955FC6E");$.PaddingObject=new $("1806D474-CADF-4509-A4BA-9AABCB96AAE8");$.ExtendedStreamPropertiesObject=new $("14E6A5CB-C672-4332-8399-A96952065B5A");$.AdvancedMutualExclusionObject=new $("A08649CF-4775-4670-8A16-6E35357566CD");$.GroupMutualExclusionObject=new $("D1465A40-5A79-4338-B71B-E36B8FD6C249");$.StreamPrioritizationObject=new $("D4FED15B-88D3-454F-81F0-ED5C45999E24");$.BandwidthSharingObject=new $("A69609E6-517B-11D2-B6AF-00C04FD908E9");$.LanguageListObject=new $("7C4346A9-EFE0-4BFC-B229-393EDE415C85");$.MetadataObject=new $("C5F8CBEA-5BAF-4877-8467-AA8C44FA4CCA");$.MetadataLibraryObject=new $("44231C94-9498-49D1-A141-1D134E457054");$.IndexParametersObject=new $("D6E229DF-35DA-11D1-9034-00A0C90349BE");$.MediaObjectIndexParametersObject=new $("6B203BAD-3F11-48E4-ACA8-D7613DE2CFA7");$.TimecodeIndexParametersObject=new $("F55E496D-9797-4B5D-8C8B-604DFE9BFB24");$.CompatibilityObject=new $("26F18B5D-4584-47EC-9F5F-0E651F0452C9");$.AdvancedContentEncryptionObject=new $("43058533-6981-49E6-9B74-AD12CB86D58C");$.AudioMedia=new $("F8699E40-5B4D-11CF-A8FD-00805F5C442B");$.VideoMedia=new $("BC19EFC0-5B4D-11CF-A8FD-00805F5C442B");$.CommandMedia=new $("59DACFC0-59E6-11D0-A3AC-00A0C90348F6");$.JFIF_Media=new $("B61BE100-5B4E-11CF-A8FD-00805F5C442B");$.Degradable_JPEG_Media=new $("35907DE0-E415-11CF-A917-00805F5C442B");$.FileTransferMedia=new $("91BD222C-F21C-497A-8B6D-5AA86BFC0185");$.BinaryMedia=new $("3AFB65E2-47EF-40F2-AC2C-70A90D71D343");$.ASF_Index_Placeholder_Object=new $("D9AADE20-7C17-4F9C-BC28-8555DD98E2A2");function hQ(t){return fQ[t]}function Wm(t){return vi(St(t,"utf-16le"))}const fQ=[Wm,RE,mQ,pQ,gQ,OA,RE];function RE(t){return new Uint8Array(t)}function mQ(t,e=0){return OA(t,e)===1}function pQ(t,e=0){return J.get(t,e)}function gQ(t,e=0){return mn.get(t,e)}function OA(t,e=0){return De.get(t,e)}var AE;(function(t){t[t.UnicodeString=0]="UnicodeString",t[t.ByteArray=1]="ByteArray",t[t.Bool=2]="Bool",t[t.DWord=3]="DWord",t[t.QWord=4]="QWord",t[t.Word=5]="Word"})(AE||(AE={}));const xQ={len:30,get:(t,e)=>({objectId:$.fromBin(t,e),objectSize:Number(mn.get(t,e+16)),numberOfHeaderObjects:J.get(t,e+24)})},fa={len:24,get:(t,e)=>({objectId:$.fromBin(t,e),objectSize:Number(mn.get(t,e+16))})};class eo{constructor(e){this.len=Number(e.objectSize)-fa.len}postProcessTag(e,n,r,s){if(n==="WM/Picture")e.push({id:n,value:Hw.fromBuffer(s)});else{const i=hQ(r);if(!i)throw new Error(`unexpected value headerType: ${r}`);e.push({id:n,value:i(s)})}}}class NE extends eo{get(e,n){return null}}class Tx extends eo{get(e,n){return{fileId:$.fromBin(e,n),fileSize:mn.get(e,n+16),creationDate:mn.get(e,n+24),dataPacketsCount:mn.get(e,n+32),playDuration:mn.get(e,n+40),sendDuration:mn.get(e,n+48),preroll:mn.get(e,n+56),flags:{broadcast:ct(e,n+64,24),seekable:ct(e,n+64,25)},minimumDataPacketSize:J.get(e,n+68),maximumDataPacketSize:J.get(e,n+72),maximumBitrate:J.get(e,n+76)}}}Tx.guid=$.FilePropertiesObject;class Ix extends eo{get(e,n){return{streamType:$.decodeMediaType($.fromBin(e,n)),errorCorrectionType:$.fromBin(e,n+8)}}}Ix.guid=$.StreamPropertiesObject;class Cx{constructor(){this.len=22}get(e,n){const r=new DataView(e.buffer,n);return{reserved1:$.fromBin(e,n),reserved2:r.getUint16(16,!0),extensionDataSize:r.getUint16(18,!0)}}}Cx.guid=$.HeaderExtensionObject;const yQ={len:20,get:(t,e)=>({entryCount:new DataView(t.buffer,e).getUint16(16,!0)})};async function PE(t){const e=await t.readNumber(De);return(await t.readToken(new ne(e*2,"utf-16le"))).replace("\0","")}async function vQ(t){const e=await t.readToken(yQ),n=[];for(let r=0;r<e.entryCount;++r)n.push(await _Q(t));return n}async function wQ(t){const e=await t.readNumber(De),n=new Uint8Array(e);return await t.readBuffer(n),n}async function _Q(t){const e=await t.readNumber(De);return{type:{videoCodec:(e&1)===1,audioCodec:(e&2)===2},codecName:await PE(t),description:await PE(t),information:await wQ(t)}}class Va extends eo{get(e,n){const r=[],s=new DataView(e.buffer,n);let i=10;for(let a=0;a<Va.contentDescTags.length;++a){const l=s.getUint16(a*2,!0);if(l>0){const c=Va.contentDescTags[a],u=i+l;r.push({id:c,value:Wm(e.slice(n+i,n+u))}),i=u}}return r}}Va.guid=$.ContentDescriptionObject;Va.contentDescTags=["Title","Author","Copyright","Description","Rating"];class jx extends eo{get(e,n){const r=[],s=new DataView(e.buffer,n),i=s.getUint16(0,!0);let a=2;for(let l=0;l<i;l+=1){const c=s.getUint16(a,!0);a+=2;const u=Wm(e.slice(n+a,n+a+c));a+=c;const d=s.getUint16(a,!0);a+=2;const f=s.getUint16(a,!0);a+=2;const p=e.slice(n+a,n+a+f);a+=f,this.postProcessTag(r,u,d,p)}return r}}jx.guid=$.ExtendedContentDescriptionObject;class Rx extends eo{get(e,n){const r=new DataView(e.buffer,n);return{startTime:mn.get(e,n),endTime:mn.get(e,n+8),dataBitrate:r.getInt32(12,!0),bufferSize:r.getInt32(16,!0),initialBufferFullness:r.getInt32(20,!0),alternateDataBitrate:r.getInt32(24,!0),alternateBufferSize:r.getInt32(28,!0),alternateInitialBufferFullness:r.getInt32(32,!0),maximumObjectSize:r.getInt32(36,!0),flags:{reliableFlag:ct(e,n+40,0),seekableFlag:ct(e,n+40,1),resendLiveCleanpointsFlag:ct(e,n+40,2)},streamNumber:r.getInt16(42,!0),streamLanguageId:r.getInt16(44,!0),averageTimePerFrame:r.getInt32(52,!0),streamNameCount:r.getInt32(54,!0),payloadExtensionSystems:r.getInt32(56,!0),streamNames:[],streamPropertiesObject:null}}}Rx.guid=$.ExtendedStreamPropertiesObject;class Tf extends eo{get(e,n){const r=[],s=new DataView(e.buffer,n),i=s.getUint16(0,!0);let a=2;for(let l=0;l<i;l+=1){a+=4;const c=s.getUint16(a,!0);a+=2;const u=s.getUint16(a,!0);a+=2;const d=s.getUint32(a,!0);a+=4;const f=Wm(e.slice(n+a,n+a+c));a+=c;const p=e.slice(n+a,n+a+d);a+=d,this.postProcessTag(r,f,u,p)}return r}}Tf.guid=$.MetadataObject;class Ax extends Tf{}Ax.guid=$.MetadataLibraryObject;class Hw{static fromBuffer(e){return new Hw(e.length).get(e,0)}constructor(e){this.len=e}get(e,n){const r=new DataView(e.buffer,n),s=r.getUint8(0),i=r.getInt32(1,!0);let a=5;for(;r.getUint16(a)!==0;)a+=2;const l=new ne(a-5,"utf-16le").get(e,5);for(;r.getUint16(a)!==0;)a+=2;const c=new ne(a-5,"utf-16le").get(e,5);return{type:du[s],format:l,description:c,size:i,data:e.slice(a+4)}}}const Bd=ze("music-metadata:parser:ASF"),bQ="asf";class SQ extends sr{async parse(){const e=await this.tokenizer.readToken(xQ);if(!e.objectId.equals($.HeaderObject))throw new Error(`expected asf header; but was not found; got: ${e.objectId.str}`);try{await this.parseObjectHeader(e.numberOfHeaderObjects)}catch(n){Bd("Error while parsing ASF: %s",n)}}async parseObjectHeader(e){let n;do{const r=await this.tokenizer.readToken(fa);switch(Bd("header GUID=%s",r.objectId.str),r.objectId.str){case Tx.guid.str:{const s=await this.tokenizer.readToken(new Tx(r));this.metadata.setFormat("duration",Number(s.playDuration/BigInt(1e3))/1e4-Number(s.preroll)/1e3),this.metadata.setFormat("bitrate",s.maximumBitrate);break}case Ix.guid.str:{const s=await this.tokenizer.readToken(new Ix(r));this.metadata.setFormat("container",`ASF/${s.streamType}`);break}case Cx.guid.str:{const s=await this.tokenizer.readToken(new Cx);await this.parseExtensionObject(s.extensionDataSize);break}case Va.guid.str:n=await this.tokenizer.readToken(new Va(r)),await this.addTags(n);break;case jx.guid.str:n=await this.tokenizer.readToken(new jx(r)),await this.addTags(n);break;case $.CodecListObject.str:{const s=await vQ(this.tokenizer);s.forEach(a=>{this.metadata.addStreamInfo({type:a.type.videoCodec?Ua.video:Ua.audio,codecName:a.codecName})});const i=s.filter(a=>a.type.audioCodec).map(a=>a.codecName).join("/");this.metadata.setFormat("codec",i);break}case $.StreamBitratePropertiesObject.str:await this.tokenizer.ignore(r.objectSize-fa.len);break;case $.PaddingObject.str:Bd("Padding: %s bytes",r.objectSize-fa.len),await this.tokenizer.ignore(r.objectSize-fa.len);break;default:this.metadata.addWarning(`Ignore ASF-Object-GUID: ${r.objectId.str}`),Bd("Ignore ASF-Object-GUID: %s",r.objectId.str),await this.tokenizer.readToken(new NE(r))}}while(--e)}async addTags(e){await Promise.all(e.map(({id:n,value:r})=>this.metadata.addTag(bQ,n,r)))}async parseExtensionObject(e){do{const n=await this.tokenizer.readToken(fa),r=n.objectSize-fa.len;switch(n.objectId.str){case Rx.guid.str:await this.tokenizer.readToken(new Rx(n));break;case Tf.guid.str:{const s=await this.tokenizer.readToken(new Tf(n));await this.addTags(s);break}case Ax.guid.str:{const s=await this.tokenizer.readToken(new Ax(n));await this.addTags(s);break}case $.PaddingObject.str:await this.tokenizer.ignore(r);break;case $.CompatibilityObject.str:this.tokenizer.ignore(r);break;case $.ASF_Index_Placeholder_Object.str:await this.tokenizer.ignore(r);break;default:this.metadata.addWarning(`Ignore ASF-Object-GUID: ${n.objectId.str}`),await this.tokenizer.readToken(new NE(n));break}e-=n.objectSize}while(e>0)}}class hu{static fromBase64(e){return hu.fromBuffer(Uint8Array.from(atob(e),n=>n.charCodeAt(0)))}static fromBuffer(e){return new hu(e.length).get(e,0)}constructor(e){this.len=e}get(e,n){const r=du[re.get(e,n)];n+=4;const s=re.get(e,n);n+=4;const i=new ne(s,"utf-8").get(e,n);n+=s;const a=re.get(e,n);n+=4;const l=new ne(a,"utf-8").get(e,n);n+=a;const c=re.get(e,n);n+=4;const u=re.get(e,n);n+=4;const d=re.get(e,n);n+=4;const f=re.get(e,n);n+=4;const p=re.get(e,n);n+=4;const g=Uint8Array.from(e.slice(n,n+p));return{type:r,format:i,description:l,width:c,height:u,colour_depth:d,indexed_color:f,data:g}}}const zd={len:7,get:(t,e)=>({packetType:pe.get(t,e),vorbis:new ne(6,"ascii").get(t,e+1)})},EQ={len:23,get:(t,e)=>({version:J.get(t,e+0),channelMode:pe.get(t,e+4),sampleRate:J.get(t,e+5),bitrateMax:J.get(t,e+9),bitrateNominal:J.get(t,e+13),bitrateMin:J.get(t,e+17)})},Sg=ze("music-metadata:parser:ID3");class qm extends sr{constructor(){super(...arguments),this.id3parser=new Fr}static async startsWithID3v2Header(e){return(await e.peekToken(Ex)).fileIdentifier==="ID3"}async parse(){try{await this.parseID3v2()}catch(e){if(e instanceof pt)Sg("End-of-stream");else throw e}}finalize(){}async parseID3v2(){await this.tryReadId3v2Headers(),Sg("End of ID3v2 header, go to MPEG-parser: pos=%s",this.tokenizer.position),await this.postId3v2Parse(),this.options.skipPostHeaders&&this.metadata.hasAny()?this.finalize():(await new Vw().init(this.metadata,this.tokenizer,this.options).parse(),this.finalize())}async tryReadId3v2Headers(){if((await this.tokenizer.peekToken(Ex)).fileIdentifier==="ID3")return Sg("Found ID3v2 header, pos=%s",this.tokenizer.position),await this.id3parser.parse(this.metadata,this.tokenizer,this.options),this.tryReadId3v2Headers()}}class $A{constructor(e,n){this.data=e,this.offset=n}readInt32(){const e=J.get(this.data,this.offset);return this.offset+=4,e}readStringUtf8(){const e=this.readInt32(),n=new TextDecoder("utf-8").decode(this.data.subarray(this.offset,this.offset+e));return this.offset+=e,n}parseUserComment(){const e=this.offset,n=this.readStringUtf8(),r=n.indexOf("=");return{key:n.slice(0,r).toUpperCase(),value:n.slice(r+1),len:this.offset-e}}}const oo=ze("music-metadata:parser:ogg:vorbis1");class Ha{constructor(e,n){this.metadata=e,this.options=n,this.pageSegments=[]}async parsePage(e,n){if(e.headerType.firstPage)this.parseFirstPage(e,n);else{if(e.headerType.continued){if(this.pageSegments.length===0)throw new Error("Cannot continue on previous page");this.pageSegments.push(n)}if(e.headerType.lastPage||!e.headerType.continued){if(this.pageSegments.length>0){const r=Ha.mergeUint8Arrays(this.pageSegments);await this.parseFullPage(r)}this.pageSegments=e.headerType.lastPage?[]:[n]}}e.headerType.lastPage&&this.calculateDuration(e)}static mergeUint8Arrays(e){const n=e.reduce((s,i)=>s+i.length,0),r=new Uint8Array(n);return e.forEach((s,i,a)=>{const l=a.slice(0,i).reduce((c,u)=>c+u.length,0);r.set(s,l)}),r}async flush(){await this.parseFullPage(Ha.mergeUint8Arrays(this.pageSegments))}async parseUserComment(e,n){const s=new $A(e,n).parseUserComment();return await this.addTag(s.key,s.value),s.len}async addTag(e,n){if(e==="METADATA_BLOCK_PICTURE"&&typeof n=="string"){if(this.options.skipCovers){oo("Ignore picture");return}n=hu.fromBase64(n),oo(`Push picture: id=${e}, format=${n.format}`)}else oo(`Push tag: id=${e}, value=${n}`);await this.metadata.addTag("vorbis",e,n)}calculateDuration(e){this.metadata.format.sampleRate&&e.absoluteGranulePosition>=0&&(this.metadata.setFormat("numberOfSamples",e.absoluteGranulePosition),this.metadata.setFormat("duration",e.absoluteGranulePosition/this.metadata.format.sampleRate))}parseFirstPage(e,n){this.metadata.setFormat("codec","Vorbis I"),oo("Parse first page");const r=zd.get(n,0);if(r.vorbis!=="vorbis")throw new Error("Metadata does not look like Vorbis");if(r.packetType===1){const s=EQ.get(n,zd.len);this.metadata.setFormat("sampleRate",s.sampleRate),this.metadata.setFormat("bitrate",s.bitrateNominal),this.metadata.setFormat("numberOfChannels",s.channelMode),oo("sample-rate=%s[hz], bitrate=%s[b/s], channel-mode=%s",s.sampleRate,s.bitrateNominal,s.channelMode)}else throw new Error("First Ogg page should be type 1: the identification header")}async parseFullPage(e){const n=zd.get(e,0);switch(oo("Parse full page: type=%s, byteLength=%s",n.packetType,e.byteLength),n.packetType){case 3:return this.parseUserCommentList(e,zd.len)}}async parseUserCommentList(e,n){const r=J.get(e,n);n+=4,n+=r;let s=J.get(e,n);for(n+=4;s-- >0;)n+=await this.parseUserComment(e,n)}}const kQ=ze("music-metadata:parser:FLAC");var Ss;(function(t){t[t.STREAMINFO=0]="STREAMINFO",t[t.PADDING=1]="PADDING",t[t.APPLICATION=2]="APPLICATION",t[t.SEEKTABLE=3]="SEEKTABLE",t[t.VORBIS_COMMENT=4]="VORBIS_COMMENT",t[t.CUESHEET=5]="CUESHEET",t[t.PICTURE=6]="PICTURE"})(Ss||(Ss={}));class TQ extends qm{constructor(){super(...arguments),this.padding=0}init(e,n,r){return super.init(e,n,r),this.vorbisParser=new Ha(e,r),this}async postId3v2Parse(){if((await this.tokenizer.readToken(Ye)).toString()!=="fLaC")throw new Error("Invalid FLAC preamble");let n;do n=await this.tokenizer.readToken(IQ),await this.parseDataBlock(n);while(!n.lastBlock);if(this.tokenizer.fileInfo.size&&this.metadata.format.duration){const r=this.tokenizer.fileInfo.size-this.tokenizer.position;this.metadata.setFormat("bitrate",8*r/this.metadata.format.duration)}}async parseDataBlock(e){switch(kQ(`blockHeader type=${e.type}, length=${e.length}`),e.type){case Ss.STREAMINFO:return this.parseBlockStreamInfo(e.length);case Ss.PADDING:this.padding+=e.length;break;case Ss.APPLICATION:break;case Ss.SEEKTABLE:break;case Ss.VORBIS_COMMENT:return this.parseComment(e.length);case Ss.CUESHEET:break;case Ss.PICTURE:await this.parsePicture(e.length);return;default:this.metadata.addWarning(`Unknown block type: ${e.type}`)}return this.tokenizer.ignore(e.length).then()}async parseBlockStreamInfo(e){if(e!==FE.len)throw new Error("Unexpected block-stream-info length");const n=await this.tokenizer.readToken(FE);this.metadata.setFormat("container","FLAC"),this.metadata.setFormat("codec","FLAC"),this.metadata.setFormat("lossless",!0),this.metadata.setFormat("numberOfChannels",n.channels),this.metadata.setFormat("bitsPerSample",n.bitsPerSample),this.metadata.setFormat("sampleRate",n.sampleRate),n.totalSamples>0&&this.metadata.setFormat("duration",n.totalSamples/n.sampleRate)}async parseComment(e){const n=await this.tokenizer.readToken(new Sn(e)),r=new $A(n,0);r.readStringUtf8();const s=r.readInt32(),i=new Array(s);for(let a=0;a<s;a++)i[a]=r.parseUserComment();await Promise.all(i.map(a=>this.vorbisParser.addTag(a.key,a.value)))}async parsePicture(e){if(this.options.skipCovers)return this.tokenizer.ignore(e);const n=await this.tokenizer.readToken(new hu(e));this.vorbisParser.addTag("METADATA_BLOCK_PICTURE",n)}}const IQ={len:4,get:(t,e)=>({lastBlock:ct(t,e,7),type:Ce(t,e,1,7),length:vn.get(t,e+1)})},FE={len:34,get:(t,e)=>({minimumBlockSize:Oe.get(t,e),maximumBlockSize:Oe.get(t,e+2)/1e3,minimumFrameSize:vn.get(t,e+4),maximumFrameSize:vn.get(t,e+7),sampleRate:vn.get(t,e+10)>>4,channels:Ce(t,e+12,4,3)+1,bitsPerSample:Ce(t,e+12,7,5)+1,totalSamples:Ce(t,e+13,4,36),fileMD5:new Sn(16).get(t,e+18)})},BA=ze("music-metadata:parser:MP4:atom"),If={len:8,get:(t,e)=>{const n=re.get(t,e);if(n<0)throw new Error("Invalid atom header length");return{length:BigInt(n),name:new ne(4,"latin1").get(t,e+4)}},put:(t,e,n)=>(re.put(t,e,Number(n.length)),Ye.put(t,e+4,n.name))},CQ=Mw,DE={len:4,get:(t,e)=>({type:new ne(4,"ascii").get(t,e)})};class zA{constructor(e,n,r){if(this.len=e,e<n)throw new Error(`Atom ${r} expected to be ${n}, but specifies ${e} bytes long.`);e>n&&BA(`Warning: atom ${r} expected to be ${n}, but was actually ${e} bytes long.`)}}const nl={len:4,get:(t,e)=>{const n=re.get(t,e)-2082844800;return new Date(n*1e3)}};class jQ extends zA{constructor(e){super(e,24,"mdhd"),this.len=e}get(e,n){return{version:pe.get(e,n+0),flags:vn.get(e,n+1),creationTime:nl.get(e,n+4),modificationTime:nl.get(e,n+8),timeScale:re.get(e,n+12),duration:re.get(e,n+16),language:Oe.get(e,n+20),quality:Oe.get(e,n+22)}}}class RQ extends zA{constructor(e){super(e,100,"mvhd"),this.len=e}get(e,n){return{version:pe.get(e,n),flags:vn.get(e,n+1),creationTime:nl.get(e,n+4),modificationTime:nl.get(e,n+8),timeScale:re.get(e,n+12),duration:re.get(e,n+16),preferredRate:re.get(e,n+20),preferredVolume:Oe.get(e,n+24),previewTime:re.get(e,n+72),previewDuration:re.get(e,n+76),posterTime:re.get(e,n+80),selectionTime:re.get(e,n+84),selectionDuration:re.get(e,n+88),currentTime:re.get(e,n+92),nextTrackID:re.get(e,n+96)}}}class AQ{constructor(e){this.len=e}get(e,n){return{type:{set:pe.get(e,n+0),type:vn.get(e,n+1)},locale:vn.get(e,n+4),value:new Sn(this.len-8).get(e,n+8)}}}class NQ{constructor(e){this.len=e}get(e,n){return{version:pe.get(e,n),flags:vn.get(e,n+1),name:new ne(this.len-4,"utf-8").get(e,n+4)}}}class PQ{constructor(e){this.len=e}get(e,n){return{version:pe.get(e,n),flags:vn.get(e,n+1),creationTime:nl.get(e,n+4),modificationTime:nl.get(e,n+8),trackId:re.get(e,n+12),duration:re.get(e,n+20),layer:Oe.get(e,n+24),alternateGroup:Oe.get(e,n+26),volume:Oe.get(e,n+28)}}}const LE={len:8,get:(t,e)=>({version:pe.get(t,e),flags:vn.get(t,e+1),numberOfEntries:re.get(t,e+4)})};class FQ{constructor(e){this.len=e}get(e,n){return{dataFormat:Ye.get(e,n),dataReferenceIndex:Oe.get(e,n+10),description:new Sn(this.len-12).get(e,n+12)}}}class DQ{constructor(e){this.len=e}get(e,n){const r=LE.get(e,n);n+=LE.len;const s=[];for(let i=0;i<r.numberOfEntries;++i){const a=re.get(e,n);n+=re.len,s.push(new FQ(a).get(e,n)),n+=a}return{header:r,table:s}}}const ME={len:8,get(t,e){return{version:Ns.get(t,e),revision:Ns.get(t,e+2),vendor:Yn.get(t,e+4)}}},LQ={len:12,get(t,e){return{numAudioChannels:Ns.get(t,e+0),sampleSize:Ns.get(t,e+2),compressionId:Ns.get(t,e+4),packetSize:Ns.get(t,e+6),sampleRate:Oe.get(t,e+8)+Oe.get(t,e+10)/1e4}}};class Ww{constructor(e,n){this.len=e,this.token=n}get(e,n){const r=Yn.get(e,n+4);return{version:uu.get(e,n+0),flags:Lw.get(e,n+1),numberOfEntries:r,entries:UA(e,this.token,n+8,this.len-8,r)}}}const MQ={len:8,get(t,e){return{count:Yn.get(t,e+0),duration:Yn.get(t,e+4)}}};class OQ extends Ww{constructor(e){super(e,MQ),this.len=e}}const $Q={len:12,get(t,e){return{firstChunk:Yn.get(t,e),samplesPerChunk:Yn.get(t,e+4),sampleDescriptionId:Yn.get(t,e+8)}}};class BQ extends Ww{constructor(e){super(e,$Q),this.len=e}}class zQ{constructor(e){this.len=e}get(e,n){const r=Yn.get(e,n+8);return{version:uu.get(e,n),flags:Lw.get(e,n+1),sampleSize:Yn.get(e,n+4),numberOfEntries:r,entries:UA(e,Yn,n+12,this.len-12,r)}}}class UQ extends Ww{constructor(e){super(e,Yn),this.len=e}}class VQ{constructor(e){this.len=e}get(e,n){const r=Ns.get(e,n+0);return new ne(r,"utf-8").get(e,n+2)}}function UA(t,e,n,r,s){if(BA(`remainingLen=${r}, numberOfEntries=${s} * token-len=${e.len}`),r===0)return[];if(r!==s*e.len)throw new Error("mismatch number-of-entries with remaining atom-length");const i=[];for(let a=0;a<s;++a)i.push(e.get(t,n)),n+=e.len;return i}const HQ=ze("music-metadata:parser:MP4:Atom");class Cf{static async readAtom(e,n,r,s){const i=e.position,a=await e.readToken(If);a.length===BigInt(1)&&(a.length=await e.readToken(CQ));const c=new Cf(a,a.length===BigInt(1),r),u=c.getPayloadLength(s);return HQ(`parse atom name=${c.atomPath}, extended=${c.extended}, offset=${i}, len=${c.header.length}`),await c.readData(e,n,u),c}constructor(e,n,r){this.header=e,this.extended=n,this.parent=r,this.children=[],this.atomPath=(this.parent?`${this.parent.atomPath}.`:"")+this.header.name}getHeaderLength(){return this.extended?16:8}getPayloadLength(e){return(this.header.length===BigInt(0)?e:Number(this.header.length))-this.getHeaderLength()}async readAtoms(e,n,r){for(;r>0;){const s=await Cf.readAtom(e,n,this,r);this.children.push(s),r-=s.header.length===BigInt(0)?r:Number(s.header.length)}}async readData(e,n,r){switch(this.header.name){case"moov":case"udta":case"trak":case"mdia":case"minf":case"stbl":case"<id>":case"ilst":case"tref":return this.readAtoms(e,n,this.getPayloadLength(r));case"meta":{const i=(await e.peekToken(If)).name==="hdlr"?0:4;return await e.ignore(i),this.readAtoms(e,n,this.getPayloadLength(r)-i)}default:return n(this,r)}}}const Kr=ze("music-metadata:parser:MP4"),WQ="iTunes",OE={raw:{lossy:!1,format:"raw"},MAC3:{lossy:!0,format:"MACE 3:1"},MAC6:{lossy:!0,format:"MACE 6:1"},ima4:{lossy:!0,format:"IMA 4:1"},ulaw:{lossy:!0,format:"uLaw 2:1"},alaw:{lossy:!0,format:"uLaw 2:1"},Qclp:{lossy:!0,format:"QUALCOMM PureVoice"},".mp3":{lossy:!0,format:"MPEG-1 layer 3"},alac:{lossy:!1,format:"ALAC"},"ac-3":{lossy:!0,format:"AC-3"},mp4a:{lossy:!0,format:"MPEG-4/AAC"},mp4s:{lossy:!0,format:"MP4S"},c608:{lossy:!0,format:"CEA-608"},c708:{lossy:!0,format:"CEA-708"}};function $E(t,e,n){return n.indexOf(t)===e}class jf extends sr{constructor(){super(...arguments),this.tracks=[],this.atomParsers={mvhd:async e=>{const n=await this.tokenizer.readToken(new RQ(e));this.metadata.setFormat("creationTime",n.creationTime),this.metadata.setFormat("modificationTime",n.modificationTime)},mdhd:async e=>{const n=await this.tokenizer.readToken(new jQ(e)),r=this.getTrackDescription();r.creationTime=n.creationTime,r.modificationTime=n.modificationTime,r.timeScale=n.timeScale,r.duration=n.duration},chap:async e=>{const n=this.getTrackDescription(),r=[];for(;e>=re.len;)r.push(await this.tokenizer.readNumber(re)),e-=re.len;n.chapterList=r},tkhd:async e=>{const n=await this.tokenizer.readToken(new PQ(e));this.tracks.push(n)},mdat:async e=>{if(this.audioLengthInBytes=e,this.calculateBitRate(),this.options.includeChapters){const n=this.tracks.filter(r=>r.chapterList);if(n.length===1){const r=n[0].chapterList,s=this.tracks.filter(i=>r.indexOf(i.trackId)!==-1);if(s.length===1)return this.parseChapterTrack(s[0],n[0],e)}}await this.tokenizer.ignore(e)},ftyp:async e=>{const n=[];for(;e>0;){const s=await this.tokenizer.readToken(DE);e-=DE.len;const i=s.type.replace(/\W/g,"");i.length>0&&n.push(i)}Kr(`ftyp: ${n.join("/")}`);const r=n.filter($E).join("/");this.metadata.setFormat("container",r)},stsd:async e=>{const n=await this.tokenizer.readToken(new DQ(e)),r=this.getTrackDescription();r.soundSampleDescription=n.table.map(s=>this.parseSoundSampleDescription(s))},stsc:async e=>{const n=await this.tokenizer.readToken(new BQ(e));this.getTrackDescription().sampleToChunkTable=n.entries},stts:async e=>{const n=await this.tokenizer.readToken(new OQ(e));this.getTrackDescription().timeToSampleTable=n.entries},stsz:async e=>{const n=await this.tokenizer.readToken(new zQ(e)),r=this.getTrackDescription();r.sampleSize=n.sampleSize,r.sampleSizeTable=n.entries},stco:async e=>{const n=await this.tokenizer.readToken(new UQ(e));this.getTrackDescription().chunkOffsetTable=n.entries},date:async e=>{const n=await this.tokenizer.readToken(new ne(e,"utf-8"));await this.addTag("date",n)}}}static read_BE_Integer(e,n){const r=(n?"INT":"UINT")+e.length*8+(e.length>1?"_BE":""),s=Jq[r];if(!s)throw new Error(`Token for integer type not found: "${r}"`);return Number(s.get(e,0))}async parse(){this.tracks=[];let e=this.tokenizer.fileInfo.size||0;for(;!this.tokenizer.fileInfo.size||e>0;){try{if((await this.tokenizer.peekToken(If)).name==="\0\0\0\0"){const a=`Error at offset=${this.tokenizer.position}: box.id=0`;Kr(a),this.addWarning(a);break}}catch(i){if(i instanceof Error){const a=`Error at offset=${this.tokenizer.position}: ${i.message}`;Kr(a),this.addWarning(a)}else throw i;break}const s=await Cf.readAtom(this.tokenizer,(i,a)=>this.handleAtom(i,a),null,e);e-=s.header.length===BigInt(0)?e:Number(s.header.length)}const n=[];this.tracks.forEach(s=>{const i=[];s.soundSampleDescription.forEach(a=>{const l={},c=OE[a.dataFormat];if(c?(i.push(c.format),l.codecName=c.format):l.codecName=`<${a.dataFormat}>`,a.description){const{description:u}=a;u.sampleRate>0&&(l.type=Ua.audio,l.audio={samplingFrequency:u.sampleRate,bitDepth:u.sampleSize,channels:u.numAudioChannels})}this.metadata.addStreamInfo(l)}),i.length>=1&&n.push(i.join("/"))}),n.length>0&&this.metadata.setFormat("codec",n.filter($E).join("+"));const r=this.tracks.filter(s=>s.soundSampleDescription.length>=1&&s.soundSampleDescription[0].description&&s.soundSampleDescription[0].description.numAudioChannels>0);if(r.length>=1){const s=r[0];if(s.timeScale>0){const l=s.duration/s.timeScale;this.metadata.setFormat("duration",l)}const i=s.soundSampleDescription[0];if(i.description&&(this.metadata.setFormat("sampleRate",i.description.sampleRate),this.metadata.setFormat("bitsPerSample",i.description.sampleSize),this.metadata.setFormat("numberOfChannels",i.description.numAudioChannels),s.timeScale===0&&s.timeToSampleTable.length>0)){const c=s.timeToSampleTable.map(u=>u.count*u.duration).reduce((u,d)=>u+d)/i.description.sampleRate;this.metadata.setFormat("duration",c)}const a=OE[i.dataFormat];a&&this.metadata.setFormat("lossless",!a.lossy),this.calculateBitRate()}}async handleAtom(e,n){if(e.parent)switch(e.parent.header.name){case"ilst":case"<id>":return this.parseMetadataItemData(e)}if(this.atomParsers[e.header.name])return this.atomParsers[e.header.name](n);Kr(`No parser for atom path=${e.atomPath}, payload-len=${n}, ignoring atom`),await this.tokenizer.ignore(n)}getTrackDescription(){return this.tracks[this.tracks.length-1]}calculateBitRate(){this.audioLengthInBytes&&this.metadata.format.duration&&this.metadata.setFormat("bitrate",8*this.audioLengthInBytes/this.metadata.format.duration)}async addTag(e,n){await this.metadata.addTag(WQ,e,n)}addWarning(e){Kr(`Warning: ${e}`),this.metadata.addWarning(e)}parseMetadataItemData(e){let n=e.header.name;return e.readAtoms(this.tokenizer,async(r,s)=>{const i=r.getPayloadLength(s);switch(r.header.name){case"data":return this.parseValueAtom(n,r);case"name":case"mean":case"rate":{const a=await this.tokenizer.readToken(new NQ(i));n+=`:${a.name}`;break}default:{const a=await this.tokenizer.readToken(new Sn(i));this.addWarning(`Unsupported meta-item: ${n}[${r.header.name}] => value=${$w(a)} ascii=${Ow(a,"ascii")}`)}}},e.getPayloadLength(0))}async parseValueAtom(e,n){const r=await this.tokenizer.readToken(new AQ(Number(n.header.length)-If.len));if(r.type.set!==0)throw new Error(`Unsupported type-set != 0: ${r.type.set}`);switch(r.type.type){case 0:switch(e){case"trkn":case"disk":{const s=pe.get(r.value,3),i=pe.get(r.value,5);await this.addTag(e,`${s}/${i}`);break}case"gnre":{const s=pe.get(r.value,1),i=kf[s-1];await this.addTag(e,i);break}case"rate":{const s=new TextDecoder("ascii").decode(r.value);await this.addTag(e,s);break}default:Kr(`unknown proprietary value type for: ${n.atomPath}`)}break;case 1:case 18:await this.addTag(e,new TextDecoder("utf-8").decode(r.value));break;case 13:if(this.options.skipCovers)break;await this.addTag(e,{format:"image/jpeg",data:Uint8Array.from(r.value)});break;case 14:if(this.options.skipCovers)break;await this.addTag(e,{format:"image/png",data:Uint8Array.from(r.value)});break;case 21:await this.addTag(e,jf.read_BE_Integer(r.value,!0));break;case 22:await this.addTag(e,jf.read_BE_Integer(r.value,!1));break;case 65:await this.addTag(e,pe.get(r.value,0));break;case 66:await this.addTag(e,Oe.get(r.value,0));break;case 67:await this.addTag(e,re.get(r.value,0));break;default:this.addWarning(`atom key=${e}, has unknown well-known-type (data-type): ${r.type.type}`)}}parseSoundSampleDescription(e){const n={dataFormat:e.dataFormat,dataReferenceIndex:e.dataReferenceIndex};let r=0;const s=ME.get(e.description,r);return r+=ME.len,s.version===0||s.version===1?n.description=LQ.get(e.description,r):Kr(`Warning: sound-sample-description ${s} not implemented`),n}async parseChapterTrack(e,n,r){if(!e.sampleSize&&e.chunkOffsetTable.length!==e.sampleSizeTable.length)throw new Error("Expected equal chunk-offset-table & sample-size-table length.");const s=[];for(let i=0;i<e.chunkOffsetTable.length&&r>0;++i){const l=e.chunkOffsetTable[i]-this.tokenizer.position,c=e.sampleSize>0?e.sampleSize:e.sampleSizeTable[i];if(r-=l+c,r<0)throw new Error("Chapter chunk exceeding token length");await this.tokenizer.ignore(l);const u=await this.tokenizer.readToken(new VQ(c));Kr(`Chapter ${i+1}: ${u}`);const d={title:u,sampleOffset:this.findSampleOffset(n,this.tokenizer.position)};Kr(`Chapter title=${d.title}, offset=${d.sampleOffset}/${this.tracks[0].duration}`),s.push(d)}this.metadata.setFormat("chapters",s),await this.tokenizer.ignore(r)}findSampleOffset(e,n){let r=0;e.timeToSampleTable.forEach(i=>{r+=i.count*i.duration}),Kr(`Total duration=${r}`);let s=0;for(;s<e.chunkOffsetTable.length&&e.chunkOffsetTable[s]<n;)++s;return this.getChunkDuration(s+1,e)}getChunkDuration(e,n){let r=0,s=n.timeToSampleTable[r].count,i=n.timeToSampleTable[r].duration,a=1,l=this.getSamplesPerChunk(a,n.sampleToChunkTable),c=0;for(;a<e;){const u=Math.min(s,l);c+=u*i,s-=u,l-=u,l===0?(++a,l=this.getSamplesPerChunk(a,n.sampleToChunkTable)):(++r,s=n.timeToSampleTable[r].count,i=n.timeToSampleTable[r].duration)}return c}getSamplesPerChunk(e,n){for(let r=0;r<n.length-1;++r)if(e>=n[r].firstChunk&&e<n[r+1].firstChunk)return n[r].samplesPerChunk;return n[n.length-1].samplesPerChunk}}var BE;(function(t){t[t.not_set=0]="not_set",t[t.radio=1]="radio",t[t.audiophile=2]="audiophile"})(BE||(BE={}));var zE;(function(t){t[t.unspecified=0]="unspecified",t[t.engineer=1]="engineer",t[t.user=2]="user",t[t.automatic=3]="automatic",t[t.rms_average=4]="rms_average"})(zE||(zE={}));const UE={len:2,get:(t,e)=>{const n=Ce(t,e,0,3),r=Ce(t,e,6,1),s=Ce(t,e,7,9)/10;if(n>0)return{type:Ce(t,e,0,3),origin:Ce(t,e,3,3),adjustment:r?-s:s}}},qQ={len:27,get:(t,e)=>{const n=re.get(t,e+2);return{revision:Ce(t,e,0,4),vbr_method:Ce(t,e,4,4),lowpass_filter:100*pe.get(t,e+1),track_peak:n===0?null:n/2**23,track_gain:UE.get(t,6),album_gain:UE.get(t,8),music_length:re.get(t,e+20),music_crc:pe.get(t,e+24),header_crc:Oe.get(t,e+24)}}},VE=new ne(4,"ascii"),Eg=new ne(6,"ascii"),GQ={len:4,get:(t,e)=>({frames:Hn(t,e,31),bytes:Hn(t,e,30),toc:Hn(t,e,29),vbrScale:Hn(t,e,28)})};async function QQ(t){const e=await t.readToken(GQ),n={numFrames:null,streamSize:null,vbrScale:null};if(e.frames&&(n.numFrames=await t.readToken(re)),e.bytes&&(n.streamSize=await t.readToken(re)),e.toc&&(n.toc=new Uint8Array(100),await t.readBuffer(n.toc)),e.vbrScale&&(n.vbrScale=await t.readToken(re)),await t.peekToken(new ne(4,"ascii"))==="LAME"){await t.ignore(4),n.lame={version:await t.readToken(new ne(5,"ascii"))};const s=n.lame.version.match(/\d+.\d+/g);if(s!==null){const a=s[0].split(".").map(l=>Number.parseInt(l,10));a[0]>=3&&a[1]>=90&&(n.lame.extended=await t.readToken(qQ))}}return n}const Un=ze("music-metadata:parser:mpeg"),HE=1024,WE={AudioObjectTypes:["AAC Main","AAC LC","AAC SSR","AAC LTP"],SamplingFrequencies:[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350,null,null,-1]},KQ=[void 0,["front-center"],["front-left","front-right"],["front-center","front-left","front-right"],["front-center","front-left","front-right","back-center"],["front-center","front-left","front-right","back-left","back-right"],["front-center","front-left","front-right","back-left","back-right","LFE-channel"],["front-center","front-left","front-right","side-left","side-right","back-left","back-right","LFE-channel"]];class At{constructor(e,n){this.bitrateIndex=null,this.sampRateFreqIndex=null,this.padding=null,this.privateBit=null,this.channelModeIndex=null,this.modeExtension=null,this.isOriginalMedia=null,this.version=null,this.bitrate=null,this.samplingRate=null,this.frameLength=0,this.versionIndex=Ce(e,n+1,3,2),this.layer=At.LayerDescription[Ce(e,n+1,5,2)],this.versionIndex>1&&this.layer===0?this.parseAdtsHeader(e,n):this.parseMpegHeader(e,n),this.isProtectedByCRC=!Hn(e,n+1,7)}calcDuration(e){return this.samplingRate==null?null:e*this.calcSamplesPerFrame()/this.samplingRate}calcSamplesPerFrame(){return At.samplesInFrameTable[this.version===1?0:1][this.layer]}calculateSideInfoLength(){if(this.layer!==3)return 2;if(this.channelModeIndex===3){if(this.version===1)return 17;if(this.version===2||this.version===2.5)return 9}else{if(this.version===1)return 32;if(this.version===2||this.version===2.5)return 17}return null}calcSlotSize(){return[null,4,1,1][this.layer]}parseMpegHeader(e,n){this.container="MPEG",this.bitrateIndex=Ce(e,n+2,0,4),this.sampRateFreqIndex=Ce(e,n+2,4,2),this.padding=Hn(e,n+2,6),this.privateBit=Hn(e,n+2,7),this.channelModeIndex=Ce(e,n+3,0,2),this.modeExtension=Ce(e,n+3,2,2),this.isCopyrighted=Hn(e,n+3,4),this.isOriginalMedia=Hn(e,n+3,5),this.emphasis=Ce(e,n+3,7,2),this.version=At.VersionID[this.versionIndex],this.channelMode=At.ChannelMode[this.channelModeIndex],this.codec=`MPEG ${this.version} Layer ${this.layer}`;const r=this.calcBitrate();if(!r)throw new Error("Cannot determine bit-rate");if(this.bitrate=r*1e3,this.samplingRate=this.calcSamplingRate(),this.samplingRate==null)throw new Error("Cannot determine sampling-rate")}parseAdtsHeader(e,n){Un("layer=0 => ADTS"),this.version=this.versionIndex===2?4:2,this.container=`ADTS/MPEG-${this.version}`;const r=Ce(e,n+2,0,2);this.codec="AAC",this.codecProfile=WE.AudioObjectTypes[r],Un(`MPEG-4 audio-codec=${this.codec}`);const s=Ce(e,n+2,2,4);this.samplingRate=WE.SamplingFrequencies[s],Un(`sampling-rate=${this.samplingRate}`);const i=Ce(e,n+2,7,3);this.mp4ChannelConfig=KQ[i],Un(`channel-config=${this.mp4ChannelConfig?this.mp4ChannelConfig.join("+"):"?"}`),this.frameLength=Ce(e,n+3,6,2)<<11}calcBitrate(){if(this.bitrateIndex===0||this.bitrateIndex===15)return null;if(this.version&&this.bitrateIndex){const e=10*Math.floor(this.version)+this.layer;return At.bitrate_index[this.bitrateIndex][e]}return null}calcSamplingRate(){return this.sampRateFreqIndex===3||this.version===null||this.sampRateFreqIndex==null?null:At.sampling_rate_freq_index[this.version][this.sampRateFreqIndex]}}At.SyncByte1=255;At.SyncByte2=224;At.VersionID=[2.5,null,2,1];At.LayerDescription=[0,3,2,1];At.ChannelMode=["stereo","joint_stereo","dual_channel","mono"];At.bitrate_index={1:{11:32,12:32,13:32,21:32,22:8,23:8},2:{11:64,12:48,13:40,21:48,22:16,23:16},3:{11:96,12:56,13:48,21:56,22:24,23:24},4:{11:128,12:64,13:56,21:64,22:32,23:32},5:{11:160,12:80,13:64,21:80,22:40,23:40},6:{11:192,12:96,13:80,21:96,22:48,23:48},7:{11:224,12:112,13:96,21:112,22:56,23:56},8:{11:256,12:128,13:112,21:128,22:64,23:64},9:{11:288,12:160,13:128,21:144,22:80,23:80},10:{11:320,12:192,13:160,21:160,22:96,23:96},11:{11:352,12:224,13:192,21:176,22:112,23:112},12:{11:384,12:256,13:224,21:192,22:128,23:128},13:{11:416,12:320,13:256,21:224,22:144,23:144},14:{11:448,12:384,13:320,21:256,22:160,23:160}};At.sampling_rate_freq_index={1:{0:44100,1:48e3,2:32e3},2:{0:22050,1:24e3,2:16e3},2.5:{0:11025,1:12e3,2:8e3}};At.samplesInFrameTable=[[0,384,1152,1152],[0,384,1152,576]];const qE={len:4,get:(t,e)=>new At(t,e)};function XQ(t){return`V${Math.floor((100-t)/10)}`}class YQ extends qm{constructor(){super(...arguments),this.frameCount=0,this.syncFrameCount=-1,this.countSkipFrameData=0,this.totalDataLength=0,this.bitrates=[],this.offset=0,this.frame_size=0,this.crc=null,this.calculateEofDuration=!1,this.samplesPerFrame=null,this.buf_frame_header=new Uint8Array(4),this.mpegOffset=null,this.syncPeek={buf:new Uint8Array(HE),len:0}}async postId3v2Parse(){this.metadata.setFormat("lossless",!1);try{let e=!1;for(;!e;)await this.sync(),e=await this.parseCommonMpegHeader()}catch(e){if(e instanceof pt){if(Un("End-of-stream"),this.calculateEofDuration&&this.samplesPerFrame!==null){const n=this.frameCount*this.samplesPerFrame;if(this.metadata.setFormat("numberOfSamples",n),this.metadata.format.sampleRate){const r=n/this.metadata.format.sampleRate;Un(`Calculate duration at EOF: ${r} sec.`,r),this.metadata.setFormat("duration",r)}}}else throw e}}finalize(){const e=this.metadata.format,n=!!this.metadata.native.ID3v1;if(this.mpegOffset!==null){if(e.duration&&this.tokenizer.fileInfo.size){const r=this.tokenizer.fileInfo.size-this.mpegOffset-(n?128:0);e.codecProfile&&e.codecProfile[0]==="V"&&this.metadata.setFormat("bitrate",r*8/e.duration)}else if(this.tokenizer.fileInfo.size&&e.codecProfile==="CBR"){const r=this.tokenizer.fileInfo.size-this.mpegOffset-(n?128:0);if(this.frame_size!==null&&this.samplesPerFrame!==null){const s=Math.round(r/this.frame_size)*this.samplesPerFrame;if(this.metadata.setFormat("numberOfSamples",s),e.sampleRate){const i=s/e.sampleRate;Un("Calculate CBR duration based on file size: %s",i),this.metadata.setFormat("duration",i)}}}}}async sync(){let e=!1;for(;;){let n=0;if(this.syncPeek.len=await this.tokenizer.peekBuffer(this.syncPeek.buf,{length:HE,mayBeLess:!0}),this.syncPeek.len<=163)throw new pt;for(;;){if(e&&(this.syncPeek.buf[n]&224)===224){this.buf_frame_header[0]=At.SyncByte1,this.buf_frame_header[1]=this.syncPeek.buf[n],await this.tokenizer.ignore(n),Un(`Sync at offset=${this.tokenizer.position-1}, frameCount=${this.frameCount}`),this.syncFrameCount===this.frameCount&&(Un(`Re-synced MPEG stream, frameCount=${this.frameCount}`),this.frameCount=0,this.frame_size=0),this.syncFrameCount=this.frameCount;return}if(e=!1,n=this.syncPeek.buf.indexOf(At.SyncByte1,n),n===-1){if(this.syncPeek.len<this.syncPeek.buf.length)throw new pt;await this.tokenizer.ignore(this.syncPeek.len);break}++n,e=!0}}}async parseCommonMpegHeader(){this.frameCount===0&&(this.mpegOffset=this.tokenizer.position-1),await this.tokenizer.peekBuffer(this.buf_frame_header,{offset:1,length:3});let e;try{e=qE.get(this.buf_frame_header,0)}catch(n){if(await this.tokenizer.ignore(1),n instanceof Error)return this.metadata.addWarning(`Parse error: ${n.message}`),!1;throw n}return await this.tokenizer.ignore(3),this.metadata.setFormat("container",e.container),this.metadata.setFormat("codec",e.codec),this.metadata.setFormat("lossless",!1),this.metadata.setFormat("sampleRate",e.samplingRate),this.frameCount++,e.version!==null&&e.version>=2&&e.layer===0?this.parseAdts(e):this.parseAudioFrameHeader(e)}async parseAudioFrameHeader(e){this.metadata.setFormat("numberOfChannels",e.channelMode==="mono"?1:2),this.metadata.setFormat("bitrate",e.bitrate),this.frameCount<20*1e4&&Un("offset=%s MP%s bitrate=%s sample-rate=%s",this.tokenizer.position-4,e.layer,e.bitrate,e.samplingRate);const n=e.calcSlotSize();if(n===null)throw new Error("invalid slot_size");const r=e.calcSamplesPerFrame();Un(`samples_per_frame=${r}`);const s=r/8;if(e.bitrate!==null&&e.samplingRate!=null){const i=s*e.bitrate/e.samplingRate+(e.padding?n:0);this.frame_size=Math.floor(i)}if(this.audioFrameHeader=e,e.bitrate!==null&&this.bitrates.push(e.bitrate),this.frameCount===1)return this.offset=qE.len,await this.skipSideInformation(),!1;if(this.frameCount===3){if(this.areAllSame(this.bitrates)){if(this.samplesPerFrame=r,this.metadata.setFormat("codecProfile","CBR"),this.tokenizer.fileInfo.size)return!0}else if(this.metadata.format.duration)return!0;if(!this.options.duration)return!0}return this.options.duration&&this.frameCount===4&&(this.samplesPerFrame=r,this.calculateEofDuration=!0),this.offset=4,e.isProtectedByCRC?(await this.parseCrc(),!1):(await this.skipSideInformation(),!1)}async parseAdts(e){const n=new Uint8Array(3);if(await this.tokenizer.readBuffer(n),e.frameLength+=Ce(n,0,0,11),this.totalDataLength+=e.frameLength,this.samplesPerFrame=1024,e.samplingRate!==null){const r=e.samplingRate/this.samplesPerFrame,i=8*(this.frameCount===0?0:this.totalDataLength/this.frameCount)*r+.5;this.metadata.setFormat("bitrate",i),Un(`frame-count=${this.frameCount}, size=${e.frameLength} bytes, bit-rate=${i}`)}if(await this.tokenizer.ignore(e.frameLength>7?e.frameLength-7:1),this.frameCount===3)if(this.metadata.setFormat("codecProfile",e.codecProfile),e.mp4ChannelConfig&&this.metadata.setFormat("numberOfChannels",e.mp4ChannelConfig.length),this.options.duration)this.calculateEofDuration=!0;else return!0;return!1}async parseCrc(){return this.crc=await this.tokenizer.readNumber(Ns),this.offset+=2,this.skipSideInformation()}async skipSideInformation(){if(this.audioFrameHeader){const e=this.audioFrameHeader.calculateSideInfoLength();if(e!==null){await this.tokenizer.readToken(new Sn(e)),this.offset+=e,await this.readXtraInfoHeader();return}}}async readXtraInfoHeader(){const e=await this.tokenizer.readToken(VE);switch(this.offset+=VE.len,e){case"Info":return this.metadata.setFormat("codecProfile","CBR"),this.readXingInfoHeader();case"Xing":{const r=await this.readXingInfoHeader();if(r.vbrScale!==null){const s=XQ(r.vbrScale);this.metadata.setFormat("codecProfile",s)}return null}case"Xtra":break;case"LAME":{const r=await this.tokenizer.readToken(Eg);if(this.frame_size!==null&&this.frame_size>=this.offset+Eg.len)return this.offset+=Eg.len,this.metadata.setFormat("tool",`LAME ${r}`),await this.skipFrameData(this.frame_size-this.offset),null;this.metadata.addWarning("Corrupt LAME header");break}}const n=this.frame_size-this.offset;return n<0?this.metadata.addWarning(`Frame ${this.frameCount}corrupt: negative frameDataLeft`):await this.skipFrameData(n),null}async readXingInfoHeader(){const e=this.tokenizer.position,n=await QQ(this.tokenizer);if(this.offset+=this.tokenizer.position-e,n.lame&&(this.metadata.setFormat("tool",`LAME ${vi(n.lame.version)}`),n.lame.extended&&(this.metadata.setFormat("trackPeakLevel",n.lame.extended.track_peak),n.lame.extended.track_gain&&this.metadata.setFormat("trackGain",n.lame.extended.track_gain.adjustment),n.lame.extended.album_gain&&this.metadata.setFormat("albumGain",n.lame.extended.album_gain.adjustment),this.metadata.setFormat("duration",n.lame.extended.music_length/1e3))),n.streamSize&&this.audioFrameHeader&&n.numFrames!==null){const s=this.audioFrameHeader.calcDuration(n.numFrames);return this.metadata.setFormat("duration",s),Un("Get duration from Xing header: %s",this.metadata.format.duration),n}const r=this.frame_size-this.offset;return await this.skipFrameData(r),n}async skipFrameData(e){if(e<0)throw new Error("frame-data-left cannot be negative");await this.tokenizer.ignore(e),this.countSkipFrameData+=e}areAllSame(e){const n=e[0];return e.every(r=>r===n)}}const GE=ze("music-metadata:parser:musepack:sv8"),JQ=new ne(2,"latin1"),QE={len:5,get:(t,e)=>({crc:J.get(t,e),streamVersion:pe.get(t,e+4)})},KE={len:2,get:(t,e)=>({sampleFrequency:[44100,48e3,37800,32e3][Ce(t,e,0,3)],maxUsedBands:Ce(t,e,3,5),channelCount:Ce(t,e+1,0,4)+1,msUsed:Hn(t,e+1,4),audioBlockFrames:Ce(t,e+1,5,3)})};class ZQ{constructor(e){this.tokenizer=e}async readPacketHeader(){const e=await this.tokenizer.readToken(JQ),n=await this.readVariableSizeField();return{key:e,payloadLength:n.value-2-n.len}}async readStreamHeader(e){const n={};GE(`Reading SH at offset=${this.tokenizer.position}`);const r=await this.tokenizer.readToken(QE);e-=QE.len,Object.assign(n,r),GE(`SH.streamVersion = ${r.streamVersion}`);const s=await this.readVariableSizeField();e-=s.len,n.sampleCount=s.value;const i=await this.readVariableSizeField();e-=i.len,n.beginningOfSilence=i.value;const a=await this.tokenizer.readToken(KE);return e-=KE.len,Object.assign(n,a),await this.tokenizer.ignore(e),n}async readVariableSizeField(e=1,n=0){let r=await this.tokenizer.readNumber(pe);return r&128?(r&=127,r+=n,this.readVariableSizeField(e+1,r<<7)):{len:e,value:n+r}}}const eK=ze("music-metadata:parser:musepack");class tK extends sr{constructor(){super(...arguments),this.audioLength=0}async parse(){if(await this.tokenizer.readToken(Ye)!=="MPCK")throw new Error("Invalid Magic number");return this.metadata.setFormat("container","Musepack, SV8"),this.parsePacket()}async parsePacket(){const e=new ZQ(this.tokenizer);do{const n=await e.readPacketHeader();switch(eK(`packet-header key=${n.key}, payloadLength=${n.payloadLength}`),n.key){case"SH":{const r=await e.readStreamHeader(n.payloadLength);this.metadata.setFormat("numberOfSamples",r.sampleCount),this.metadata.setFormat("sampleRate",r.sampleFrequency),this.metadata.setFormat("duration",r.sampleCount/r.sampleFrequency),this.metadata.setFormat("numberOfChannels",r.channelCount);break}case"AP":this.audioLength+=n.payloadLength,await this.tokenizer.ignore(n.payloadLength);break;case"RG":case"EI":case"SO":case"ST":case"CT":await this.tokenizer.ignore(n.payloadLength);break;case"SE":return this.metadata.format.duration&&this.metadata.setFormat("bitrate",this.audioLength*8/this.metadata.format.duration),ts.tryParseApeHeader(this.metadata,this.tokenizer,this.options);default:throw new Error(`Unexpected header: ${n.key}`)}}while(!0)}}class nK{constructor(e){this.tokenizer=e,this.pos=0,this.dword=null}async read(e){for(;this.dword===null;)this.dword=await this.tokenizer.readToken(J);let n=this.dword;return this.pos+=e,this.pos<32?(n>>>=32-this.pos,n&(1<<e)-1):(this.pos-=32,this.pos===0?(this.dword=null,n&(1<<e)-1):(this.dword=await this.tokenizer.readToken(J),this.pos&&(n<<=this.pos,n|=this.dword>>>32-this.pos),n&(1<<e)-1))}async ignore(e){if(this.pos>0){const s=32-this.pos;this.dword=null,e-=s,this.pos=0}const n=e%32,r=(e-n)/32;return await this.tokenizer.ignore(r*4),this.read(n)}}const rK={len:6*4,get:(t,e)=>{const n={signature:new TextDecoder("latin1").decode(t.subarray(e,e+3)),streamMinorVersion:Ce(t,e+3,0,4),streamMajorVersion:Ce(t,e+3,4,4),frameCount:J.get(t,e+4),maxLevel:De.get(t,e+8),sampleFrequency:[44100,48e3,37800,32e3][Ce(t,e+10,0,2)],link:Ce(t,e+10,2,2),profile:Ce(t,e+10,4,4),maxBand:Ce(t,e+11,0,6),intensityStereo:Hn(t,e+11,6),midSideStereo:Hn(t,e+11,7),titlePeak:De.get(t,e+12),titleGain:De.get(t,e+14),albumPeak:De.get(t,e+16),albumGain:De.get(t,e+18),lastFrameLength:J.get(t,e+20)>>>20&2047,trueGapless:Hn(t,e+23,0)};return n.lastFrameLength=n.trueGapless?J.get(t,20)>>>20&2047:0,n}},XE=ze("music-metadata:parser:musepack");class sK extends sr{constructor(){super(...arguments),this.bitreader=null,this.audioLength=0,this.duration=null}async parse(){const e=await this.tokenizer.readToken(rK);if(e.signature!=="MP+")throw new Error("Unexpected magic number");XE(`stream-version=${e.streamMajorVersion}.${e.streamMinorVersion}`),this.metadata.setFormat("container","Musepack, SV7"),this.metadata.setFormat("sampleRate",e.sampleFrequency);const n=1152*(e.frameCount-1)+e.lastFrameLength;this.metadata.setFormat("numberOfSamples",n),this.duration=n/e.sampleFrequency,this.metadata.setFormat("duration",this.duration),this.bitreader=new nK(this.tokenizer),this.metadata.setFormat("numberOfChannels",e.midSideStereo||e.intensityStereo?2:1);const r=await this.bitreader.read(8);return this.metadata.setFormat("codec",(r/100).toFixed(2)),await this.skipAudioData(e.frameCount),XE(`End of audio stream, switching to APEv2, offset=${this.tokenizer.position}`),ts.tryParseApeHeader(this.metadata,this.tokenizer,this.options)}async skipAudioData(e){for(;e-- >0;){const r=await this.bitreader.read(20);this.audioLength+=20+r,await this.bitreader.ignore(r)}const n=await this.bitreader.read(11);this.audioLength+=n,this.duration!==null&&this.metadata.setFormat("bitrate",this.audioLength/this.duration)}}const YE=ze("music-metadata:parser:musepack");class iK extends qm{async postId3v2Parse(){const e=await this.tokenizer.peekToken(new ne(3,"latin1"));let n;switch(e){case"MP+":{YE("Musepack stream-version 7"),n=new sK;break}case"MPC":{YE("Musepack stream-version 8"),n=new tK;break}default:throw new Error("Invalid Musepack signature prefix")}return n.init(this.metadata,this.tokenizer,this.options),n.parse()}}class aK{constructor(e){if(this.len=e,e<19)throw new Error("ID-header-page 0 should be at least 19 bytes long")}get(e,n){return{magicSignature:new ne(8,"ascii").get(e,n+0),version:pe.get(e,n+8),channelCount:pe.get(e,n+9),preSkip:De.get(e,n+10),inputSampleRate:J.get(e,n+12),outputGain:De.get(e,n+16),channelMapping:pe.get(e,n+18)}}}class oK extends Ha{constructor(e,n,r){super(e,n),this.tokenizer=r,this.idHeader=null,this.lastPos=-1}parseFirstPage(e,n){if(this.metadata.setFormat("codec","Opus"),this.idHeader=new aK(n.length).get(n,0),this.idHeader.magicSignature!=="OpusHead")throw new Error("Illegal ogg/Opus magic-signature");this.metadata.setFormat("sampleRate",this.idHeader.inputSampleRate),this.metadata.setFormat("numberOfChannels",this.idHeader.channelCount)}async parseFullPage(e){switch(new ne(8,"ascii").get(e,0)){case"OpusTags":await this.parseUserCommentList(e,8),this.lastPos=this.tokenizer.position-e.length;break}}calculateDuration(e){if(this.metadata.format.sampleRate&&e.absoluteGranulePosition>=0){const n=e.absoluteGranulePosition-this.idHeader.preSkip;if(this.metadata.setFormat("numberOfSamples",n),this.metadata.setFormat("duration",n/48e3),this.lastPos!==-1&&this.tokenizer.fileInfo.size&&this.metadata.format.duration){const r=this.tokenizer.fileInfo.size-this.lastPos;this.metadata.setFormat("bitrate",8*r/this.metadata.format.duration)}}}}const lK={len:80,get:(t,e)=>({speex:new ne(8,"ascii").get(t,e+0),version:FA(new ne(20,"ascii").get(t,e+8)),version_id:ht.get(t,e+28),header_size:ht.get(t,e+32),rate:ht.get(t,e+36),mode:ht.get(t,e+40),mode_bitstream_version:ht.get(t,e+44),nb_channels:ht.get(t,e+48),bitrate:ht.get(t,e+52),frame_size:ht.get(t,e+56),vbr:ht.get(t,e+60),frames_per_packet:ht.get(t,e+64),extra_headers:ht.get(t,e+68),reserved1:ht.get(t,e+72),reserved2:ht.get(t,e+76)})},cK=ze("music-metadata:parser:ogg:speex");class uK extends Ha{constructor(e,n,r){super(e,n),this.tokenizer=r}parseFirstPage(e,n){cK("First Ogg/Speex page");const r=lK.get(n,0);this.metadata.setFormat("codec",`Speex ${r.version}`),this.metadata.setFormat("numberOfChannels",r.nb_channels),this.metadata.setFormat("sampleRate",r.rate),r.bitrate!==-1&&this.metadata.setFormat("bitrate",r.bitrate)}}const dK={len:42,get:(t,e)=>({id:new ne(7,"ascii").get(t,e),vmaj:pe.get(t,e+7),vmin:pe.get(t,e+8),vrev:pe.get(t,e+9),vmbw:Oe.get(t,e+10),vmbh:Oe.get(t,e+17),nombr:vn.get(t,e+37),nqual:pe.get(t,e+40)})},kg=ze("music-metadata:parser:ogg:theora");class hK{constructor(e,n,r){this.metadata=e,this.tokenizer=r}async parsePage(e,n){e.headerType.firstPage&&await this.parseFirstPage(e,n)}async flush(){kg("flush")}calculateDuration(e){kg("duration calculation not implemented")}async parseFirstPage(e,n){kg("First Ogg/Theora page"),this.metadata.setFormat("codec","Theora");const r=dK.get(n,0);this.metadata.setFormat("bitrate",r.nombr)}}const _s=ze("music-metadata:parser:ogg");class qw{static sum(e,n,r){const s=new DataView(e.buffer,0);let i=0;for(let a=n;a<n+r;++a)i+=s.getUint8(a);return i}constructor(e){this.len=e.page_segments}get(e,n){return{totalPageSize:qw.sum(e,n,this.len)}}}class Gm extends sr{constructor(){super(...arguments),this.header=null,this.pageNumber=0,this.pageConsumer=null}async parse(){_s("pos=%s, parsePage()",this.tokenizer.position);try{let e;do{if(e=await this.tokenizer.readToken(Gm.Header),e.capturePattern!=="OggS")throw new Error("Invalid Ogg capture pattern");this.metadata.setFormat("container","Ogg"),this.header=e,this.pageNumber=e.pageSequenceNo,_s("page#=%s, Ogg.id=%s",e.pageSequenceNo,e.capturePattern);const n=await this.tokenizer.readToken(new qw(e));_s("totalPageSize=%s",n.totalPageSize);const r=await this.tokenizer.readToken(new Sn(n.totalPageSize));if(_s("firstPage=%s, lastPage=%s, continued=%s",e.headerType.firstPage,e.headerType.lastPage,e.headerType.continued),e.headerType.firstPage){const s=new TextDecoder("ascii").decode(r.subarray(0,7));switch(s){case"vorbis":_s("Set page consumer to Ogg/Vorbis"),this.pageConsumer=new Ha(this.metadata,this.options);break;case"OpusHea":_s("Set page consumer to Ogg/Opus"),this.pageConsumer=new oK(this.metadata,this.options,this.tokenizer);break;case"Speex  ":_s("Set page consumer to Ogg/Speex"),this.pageConsumer=new uK(this.metadata,this.options,this.tokenizer);break;case"fishead":case"\0theora":_s("Set page consumer to Ogg/Theora"),this.pageConsumer=new hK(this.metadata,this.options,this.tokenizer);break;default:throw new Error(`gg audio-codec not recognized (id=${s})`)}}await this.pageConsumer.parsePage(e,r)}while(!e.headerType.lastPage)}catch(e){if(e instanceof Error)e instanceof pt?(this.metadata.addWarning("Last OGG-page is not marked with last-page flag"),_s("End-of-stream"),this.metadata.addWarning("Last OGG-page is not marked with last-page flag"),this.header&&this.pageConsumer.calculateDuration(this.header)):e.message.startsWith("FourCC")&&this.pageNumber>0&&(this.metadata.addWarning("Invalid FourCC ID, maybe last OGG-page is not marked with last-page flag"),await this.pageConsumer.flush());else throw e}}}Gm.Header={len:27,get:(t,e)=>({capturePattern:Ye.get(t,e),version:pe.get(t,e+4),headerType:{continued:ct(t,e+5,0),firstPage:ct(t,e+5,1),lastPage:ct(t,e+5,2)},absoluteGranulePosition:Number(mn.get(t,e+6)),streamSerialNumber:J.get(t,e+14),pageSequenceNo:J.get(t,e+18),pageChecksum:J.get(t,e+22),page_segments:pe.get(t,e+26)})};const Zl={len:8,get:(t,e)=>({chunkID:new ne(4,"latin1").get(t,e),chunkSize:J.get(t,e+4)})};class fK{constructor(e){this.tagHeader=e,this.len=e.chunkSize,this.len+=this.len&1}get(e,n){return new ne(this.tagHeader.chunkSize,"ascii").get(e,n)}}var Nx;(function(t){t[t.PCM=1]="PCM",t[t.ADPCM=2]="ADPCM",t[t.IEEE_FLOAT=3]="IEEE_FLOAT",t[t.MPEG_ADTS_AAC=5632]="MPEG_ADTS_AAC",t[t.MPEG_LOAS=5634]="MPEG_LOAS",t[t.RAW_AAC1=255]="RAW_AAC1",t[t.DOLBY_AC3_SPDIF=146]="DOLBY_AC3_SPDIF",t[t.DVM=8192]="DVM",t[t.RAW_SPORT=576]="RAW_SPORT",t[t.ESST_AC3=577]="ESST_AC3",t[t.DRM=9]="DRM",t[t.DTS2=8193]="DTS2",t[t.MPEG=80]="MPEG"})(Nx||(Nx={}));class mK{constructor(e){if(e.chunkSize<16)throw new Error("Invalid chunk size");this.len=e.chunkSize}get(e,n){return{wFormatTag:De.get(e,n),nChannels:De.get(e,n+2),nSamplesPerSec:J.get(e,n+4),nAvgBytesPerSec:J.get(e,n+8),nBlockAlign:De.get(e,n+12),wBitsPerSample:De.get(e,n+14)}}}class pK{constructor(e){if(e.chunkSize<4)throw new Error("Invalid fact chunk size.");this.len=e.chunkSize}get(e,n){return{dwSampleLength:J.get(e,n)}}}const JE={len:420,get:(t,e)=>({description:vi(new ne(256,"ascii").get(t,e)).trim(),originator:vi(new ne(32,"ascii").get(t,e+256)).trim(),originatorReference:vi(new ne(32,"ascii").get(t,e+288)).trim(),originationDate:vi(new ne(10,"ascii").get(t,e+320)).trim(),originationTime:vi(new ne(8,"ascii").get(t,e+330)).trim(),timeReferenceLow:J.get(t,e+338),timeReferenceHigh:J.get(t,e+342),version:De.get(t,e+346),umid:new Sn(64).get(t,e+348),loudnessValue:De.get(t,e+412),maxTruePeakLevel:De.get(t,e+414),maxMomentaryLoudness:De.get(t,e+416),maxShortTermLoudness:De.get(t,e+418)})},ui=ze("music-metadata:parser:RIFF");class gK extends sr{constructor(){super(...arguments),this.blockAlign=0}async parse(){const e=await this.tokenizer.readToken(Zl);if(ui(`pos=${this.tokenizer.position}, parse: chunkID=${e.chunkID}`),e.chunkID==="RIFF")return this.parseRiffChunk(e.chunkSize).catch(n=>{if(!(n instanceof pt))throw n})}async parseRiffChunk(e){const n=await this.tokenizer.readToken(Ye);switch(this.metadata.setFormat("container",n),n){case"WAVE":return this.readWaveChunk(e-Ye.len);default:throw new Error(`Unsupported RIFF format: RIFF/${n}`)}}async readWaveChunk(e){for(;e>=Zl.len;){const n=await this.tokenizer.readToken(Zl);switch(e-=Zl.len+n.chunkSize,n.chunkSize>e&&this.metadata.addWarning("Data chunk size exceeds file size"),this.header=n,ui(`pos=${this.tokenizer.position}, readChunk: chunkID=RIFF/WAVE/${n.chunkID}`),n.chunkID){case"LIST":await this.parseListTag(n);break;case"fact":this.metadata.setFormat("lossless",!1),this.fact=await this.tokenizer.readToken(new pK(n));break;case"fmt ":{const r=await this.tokenizer.readToken(new mK(n));let s=Nx[r.wFormatTag];s||(ui(`WAVE/non-PCM format=${r.wFormatTag}`),s=`non-PCM (${r.wFormatTag})`),this.metadata.setFormat("codec",s),this.metadata.setFormat("bitsPerSample",r.wBitsPerSample),this.metadata.setFormat("sampleRate",r.nSamplesPerSec),this.metadata.setFormat("numberOfChannels",r.nChannels),this.metadata.setFormat("bitrate",r.nBlockAlign*r.nSamplesPerSec*8),this.blockAlign=r.nBlockAlign;break}case"id3 ":case"ID3 ":{const r=await this.tokenizer.readToken(new Sn(n.chunkSize)),s=tl(r);await new Fr().parse(this.metadata,s,this.options);break}case"data":{this.metadata.format.lossless!==!1&&this.metadata.setFormat("lossless",!0);let r=n.chunkSize;if(this.tokenizer.fileInfo.size){const i=this.tokenizer.fileInfo.size-this.tokenizer.position;i<r&&(this.metadata.addWarning("data chunk length exceeding file length"),r=i)}const s=this.fact?this.fact.dwSampleLength:r===4294967295?void 0:r/this.blockAlign;s&&(this.metadata.setFormat("numberOfSamples",s),this.metadata.format.sampleRate&&this.metadata.setFormat("duration",s/this.metadata.format.sampleRate)),this.metadata.format.codec==="ADPCM"?this.metadata.setFormat("bitrate",352e3):this.metadata.format.sampleRate&&this.metadata.setFormat("bitrate",this.blockAlign*this.metadata.format.sampleRate*8),await this.tokenizer.ignore(n.chunkSize);break}case"bext":{const r=await this.tokenizer.readToken(JE);Object.keys(r).forEach(i=>{this.metadata.addTag("exif",`bext.${i}`,r[i])});const s=n.chunkSize-JE.len;await this.tokenizer.ignore(s);break}case"\0\0\0\0":ui(`Ignore padding chunk: RIFF/${n.chunkID} of ${n.chunkSize} bytes`),this.metadata.addWarning(`Ignore chunk: RIFF/${n.chunkID}`),await this.tokenizer.ignore(n.chunkSize);break;default:ui(`Ignore chunk: RIFF/${n.chunkID} of ${n.chunkSize} bytes`),this.metadata.addWarning(`Ignore chunk: RIFF/${n.chunkID}`),await this.tokenizer.ignore(n.chunkSize)}this.header.chunkSize%2===1&&(ui("Read odd padding byte"),await this.tokenizer.ignore(1))}}async parseListTag(e){const n=await this.tokenizer.readToken(new ne(4,"latin1"));switch(ui("pos=%s, parseListTag: chunkID=RIFF/WAVE/LIST/%s",this.tokenizer.position,n),n){case"INFO":return this.parseRiffInfoTags(e.chunkSize-4);default:return this.metadata.addWarning(`Ignore chunk: RIFF/WAVE/LIST/${n}`),ui(`Ignoring chunkID=RIFF/WAVE/LIST/${n}`),this.tokenizer.ignore(e.chunkSize-4).then()}}async parseRiffInfoTags(e){for(;e>=8;){const n=await this.tokenizer.readToken(Zl),r=new fK(n),s=await this.tokenizer.readToken(r);this.addTag(n.chunkID,vi(s)),e-=8+r.len}if(e!==0)throw new Error(`Illegal remaining size: ${e}`)}addTag(e,n){this.metadata.addTag("exif",e,n)}}const xK=[6e3,8e3,9600,11025,12e3,16e3,22050,24e3,32e3,44100,48e3,64e3,88200,96e3,192e3,-1],Ud={len:32,get:(t,e)=>{const n=J.get(t,e+24),r={BlockID:Ye.get(t,e),blockSize:J.get(t,e+4),version:De.get(t,e+8),totalSamples:J.get(t,e+12),blockIndex:J.get(t,e+16),blockSamples:J.get(t,e+20),flags:{bitsPerSample:(1+Rf(n,0,2))*8,isMono:Jr(n,2),isHybrid:Jr(n,3),isJointStereo:Jr(n,4),crossChannel:Jr(n,5),hybridNoiseShaping:Jr(n,6),floatingPoint:Jr(n,7),samplingRate:xK[Rf(n,23,4)],isDSD:Jr(n,31)},crc:new Sn(4).get(t,e+28)};return r.flags.isDSD&&(r.totalSamples*=8),r}},Tg={len:1,get:(t,e)=>({functionId:Rf(t[e],0,6),isOptional:Jr(t[e],5),isOddSize:Jr(t[e],6),largeBlock:Jr(t[e],7)})};function Jr(t,e){return Rf(t,e,1)===1}function Rf(t,e,n){return t>>>e&4294967295>>>32-n}const la=ze("music-metadata:parser:WavPack");class yK extends sr{constructor(){super(...arguments),this.audioDataSize=0}async parse(){return this.audioDataSize=0,await this.parseWavPackBlocks(),ts.tryParseApeHeader(this.metadata,this.tokenizer,this.options)}async parseWavPackBlocks(){do{if(await this.tokenizer.peekToken(Ye)!=="wvpk")break;const n=await this.tokenizer.readToken(Ud);if(n.BlockID!=="wvpk")throw new Error("Invalid WavPack Block-ID");la(`WavPack header blockIndex=${n.blockIndex}, len=${Ud.len}`),n.blockIndex===0&&!this.metadata.format.container&&(this.metadata.setFormat("container","WavPack"),this.metadata.setFormat("lossless",!n.flags.isHybrid),this.metadata.setFormat("bitsPerSample",n.flags.bitsPerSample),n.flags.isDSD||(this.metadata.setFormat("sampleRate",n.flags.samplingRate),this.metadata.setFormat("duration",n.totalSamples/n.flags.samplingRate)),this.metadata.setFormat("numberOfChannels",n.flags.isMono?1:2),this.metadata.setFormat("numberOfSamples",n.totalSamples),this.metadata.setFormat("codec",n.flags.isDSD?"DSD":"PCM"));const r=n.blockSize-(Ud.len-8);await(n.blockIndex===0?this.parseMetadataSubBlock(n,r):this.tokenizer.ignore(r)),n.blockSamples>0&&(this.audioDataSize+=n.blockSize)}while(!this.tokenizer.fileInfo.size||this.tokenizer.fileInfo.size-this.tokenizer.position>=Ud.len);this.metadata.format.duration&&this.metadata.setFormat("bitrate",this.audioDataSize*8/this.metadata.format.duration)}async parseMetadataSubBlock(e,n){let r=n;for(;r>Tg.len;){const s=await this.tokenizer.readToken(Tg),i=await this.tokenizer.readNumber(s.largeBlock?_f:pe),a=new Uint8Array(i*2-(s.isOddSize?1:0));switch(await this.tokenizer.readBuffer(a),la(`Metadata Sub-Blocks functionId=0x${s.functionId.toString(16)}, id.largeBlock=${s.largeBlock},data-size=${a.length}`),s.functionId){case 0:break;case 14:{la("ID_DSD_BLOCK");const l=1<<pe.get(a,0),c=e.flags.samplingRate*l*8;if(!e.flags.isDSD)throw new Error("Only expect DSD block if DSD-flag is set");this.metadata.setFormat("sampleRate",c),this.metadata.setFormat("duration",e.totalSamples/c);break}case 36:la("ID_ALT_TRAILER: trailer for non-wav files");break;case 38:this.metadata.setFormat("audioMD5",a);break;case 47:la(`ID_BLOCK_CHECKSUM: checksum=${$w(a)}`);break;default:la(`Ignore unsupported meta-sub-block-id functionId=0x${s.functionId.toString(16)}`);break}r-=Tg.len+(s.largeBlock?_f.len:pe.len)+i*2,la(`remainingLength=${r}`),s.isOddSize&&this.tokenizer.ignore(1)}if(r!==0)throw new Error("metadata-sub-block should fit it remaining length")}}const Vd={len:12,get:(t,e)=>({id:Ye.get(t,e),size:mn.get(t,e+4)})},vK={len:16,get:(t,e)=>({fileSize:bf.get(t,e),metadataPointer:bf.get(t,e+8)})};var ZE;(function(t){t[t.mono=1]="mono",t[t.stereo=2]="stereo",t[t.channels=3]="channels",t[t.quad=4]="quad",t[t["4 channels"]=5]="4 channels",t[t["5 channels"]=6]="5 channels",t[t["5.1 channels"]=7]="5.1 channels"})(ZE||(ZE={}));const wK={len:40,get:(t,e)=>({formatVersion:ht.get(t,e),formatID:ht.get(t,e+4),channelType:ht.get(t,e+8),channelNum:ht.get(t,e+12),samplingFrequency:ht.get(t,e+16),bitsPerSample:ht.get(t,e+20),sampleCount:bf.get(t,e+24),blockSizePerChannel:ht.get(t,e+32)})},Ig=ze("music-metadata:parser:DSF");class _K extends qm{async postId3v2Parse(){const e=this.tokenizer.position,n=await this.tokenizer.readToken(Vd);if(n.id!=="DSD ")throw new Error("Invalid chunk signature");this.metadata.setFormat("container","DSF"),this.metadata.setFormat("lossless",!0);const r=await this.tokenizer.readToken(vK);if(r.metadataPointer===BigInt(0))Ig("No ID3v2 tag present");else return Ig(`expect ID3v2 at offset=${r.metadataPointer}`),await this.parseChunks(r.fileSize-n.size),await this.tokenizer.ignore(Number(r.metadataPointer)-this.tokenizer.position-e),new Fr().parse(this.metadata,this.tokenizer,this.options)}async parseChunks(e){for(;e>=Vd.len;){const n=await this.tokenizer.readToken(Vd);switch(Ig(`Parsing chunk name=${n.id} size=${n.size}`),n.id){case"fmt ":{const r=await this.tokenizer.readToken(wK);this.metadata.setFormat("numberOfChannels",r.channelNum),this.metadata.setFormat("sampleRate",r.samplingFrequency),this.metadata.setFormat("bitsPerSample",r.bitsPerSample),this.metadata.setFormat("numberOfSamples",r.sampleCount),this.metadata.setFormat("duration",Number(r.sampleCount)/r.samplingFrequency);const s=r.bitsPerSample*r.samplingFrequency*r.channelNum;this.metadata.setFormat("bitrate",s);return}default:this.tokenizer.ignore(Number(n.size)-Vd.len);break}e-=n.size}}}const lo={len:12,get:(t,e)=>({chunkID:Ye.get(t,e),chunkSize:kA.get(t,e+4)})},hn=ze("music-metadata:parser:aiff");class bK extends sr{async parse(){const e=await this.tokenizer.readToken(lo);if(e.chunkID!=="FRM8")throw new Error("Unexpected chunk-ID");const n=(await this.tokenizer.readToken(Ye)).trim();switch(n){case"DSD":return this.metadata.setFormat("container",`DSDIFF/${n}`),this.metadata.setFormat("lossless",!0),this.readFmt8Chunks(e.chunkSize-BigInt(Ye.len));default:throw new Error(`Unsupported DSDIFF type: ${n}`)}}async readFmt8Chunks(e){for(;e>=lo.len;){const n=await this.tokenizer.readToken(lo);hn(`Chunk id=${n.chunkID}`),await this.readData(n),e-=BigInt(lo.len)+n.chunkSize}}async readData(e){hn(`Reading data of chunk[ID=${e.chunkID}, size=${e.chunkSize}]`);const n=this.tokenizer.position;switch(e.chunkID.trim()){case"FVER":{const s=await this.tokenizer.readToken(J);hn(`DSDIFF version=${s}`);break}case"PROP":{if(await this.tokenizer.readToken(Ye)!=="SND ")throw new Error("Unexpected PROP-chunk ID");await this.handleSoundPropertyChunks(e.chunkSize-BigInt(Ye.len));break}case"ID3":{const s=await this.tokenizer.readToken(new Sn(Number(e.chunkSize))),i=tl(s);await new Fr().parse(this.metadata,i,this.options);break}case"DSD":this.metadata.format.numberOfChannels&&this.metadata.setFormat("numberOfSamples",Number(e.chunkSize*BigInt(8)/BigInt(this.metadata.format.numberOfChannels))),this.metadata.format.numberOfSamples&&this.metadata.format.sampleRate&&this.metadata.setFormat("duration",this.metadata.format.numberOfSamples/this.metadata.format.sampleRate);break;default:hn(`Ignore chunk[ID=${e.chunkID}, size=${e.chunkSize}]`);break}const r=e.chunkSize-BigInt(this.tokenizer.position-n);r>0&&(hn(`After Parsing chunk, remaining ${r} bytes`),await this.tokenizer.ignore(Number(r)))}async handleSoundPropertyChunks(e){for(hn(`Parsing sound-property-chunks, remainingSize=${e}`);e>0;){const n=await this.tokenizer.readToken(lo);hn(`Sound-property-chunk[ID=${n.chunkID}, size=${n.chunkSize}]`);const r=this.tokenizer.position;switch(n.chunkID.trim()){case"FS":{const i=await this.tokenizer.readToken(re);this.metadata.setFormat("sampleRate",i);break}case"CHNL":{const i=await this.tokenizer.readToken(Oe);this.metadata.setFormat("numberOfChannels",i),await this.handleChannelChunks(n.chunkSize-BigInt(Oe.len));break}case"CMPR":{const i=(await this.tokenizer.readToken(Ye)).trim(),a=await this.tokenizer.readToken(pe),l=await this.tokenizer.readToken(new ne(a,"ascii"));i==="DSD"&&(this.metadata.setFormat("lossless",!0),this.metadata.setFormat("bitsPerSample",1)),this.metadata.setFormat("codec",`${i} (${l})`);break}case"ABSS":{const i=await this.tokenizer.readToken(Oe),a=await this.tokenizer.readToken(pe),l=await this.tokenizer.readToken(pe),c=await this.tokenizer.readToken(re);hn(`ABSS ${i}:${a}:${l}.${c}`);break}case"LSCO":{const i=await this.tokenizer.readToken(Oe);hn(`LSCO lsConfig=${i}`);break}default:hn(`Unknown sound-property-chunk[ID=${n.chunkID}, size=${n.chunkSize}]`),await this.tokenizer.ignore(Number(n.chunkSize))}const s=n.chunkSize-BigInt(this.tokenizer.position-r);s>0&&(hn(`After Parsing sound-property-chunk ${n.chunkSize}, remaining ${s} bytes`),await this.tokenizer.ignore(Number(s))),e-=BigInt(lo.len)+n.chunkSize,hn(`Parsing sound-property-chunks, remainingSize=${e}`)}if(this.metadata.format.lossless&&this.metadata.format.sampleRate&&this.metadata.format.numberOfChannels&&this.metadata.format.bitsPerSample){const n=this.metadata.format.sampleRate*this.metadata.format.numberOfChannels*this.metadata.format.bitsPerSample;this.metadata.setFormat("bitrate",n)}}async handleChannelChunks(e){hn(`Parsing channel-chunks, remainingSize=${e}`);const n=[];for(;e>=Ye.len;){const r=await this.tokenizer.readToken(Ye);hn(`Channel[ID=${r}]`),n.push(r),e-=BigInt(Ye.len)}return hn(`Channels: ${n.join(", ")}`),n}}var B;(function(t){t[t.string=0]="string",t[t.uint=1]="uint",t[t.uid=2]="uid",t[t.bool=3]="bool",t[t.binary=4]="binary",t[t.float=5]="float"})(B||(B={}));const SK={name:"dtd",container:{440786851:{name:"ebml",container:{17030:{name:"ebmlVersion",value:B.uint},17143:{name:"ebmlReadVersion",value:B.uint},17138:{name:"ebmlMaxIDWidth",value:B.uint},17139:{name:"ebmlMaxSizeWidth",value:B.uint},17026:{name:"docType",value:B.string},17031:{name:"docTypeVersion",value:B.uint},17029:{name:"docTypeReadVersion",value:B.uint}}},408125543:{name:"segment",container:{290298740:{name:"seekHead",container:{19899:{name:"seek",multiple:!0,container:{21419:{name:"id",value:B.binary},21420:{name:"position",value:B.uint}}}}},357149030:{name:"info",container:{29604:{name:"uid",value:B.uid},29572:{name:"filename",value:B.string},3979555:{name:"prevUID",value:B.uid},3965867:{name:"prevFilename",value:B.string},4110627:{name:"nextUID",value:B.uid},4096955:{name:"nextFilename",value:B.string},2807729:{name:"timecodeScale",value:B.uint},17545:{name:"duration",value:B.float},17505:{name:"dateUTC",value:B.uint},31657:{name:"title",value:B.string},19840:{name:"muxingApp",value:B.string},22337:{name:"writingApp",value:B.string}}},524531317:{name:"cluster",multiple:!0,container:{231:{name:"timecode",value:B.uid},22743:{name:"silentTracks ",multiple:!0},167:{name:"position",value:B.uid},171:{name:"prevSize",value:B.uid},160:{name:"blockGroup"},163:{name:"simpleBlock"}}},374648427:{name:"tracks",container:{174:{name:"entries",multiple:!0,container:{215:{name:"trackNumber",value:B.uint},29637:{name:"uid",value:B.uid},131:{name:"trackType",value:B.uint},185:{name:"flagEnabled",value:B.bool},136:{name:"flagDefault",value:B.bool},21930:{name:"flagForced",value:B.bool},156:{name:"flagLacing",value:B.bool},28135:{name:"minCache",value:B.uint},28136:{name:"maxCache",value:B.uint},2352003:{name:"defaultDuration",value:B.uint},2306383:{name:"timecodeScale",value:B.float},21358:{name:"name",value:B.string},2274716:{name:"language",value:B.string},134:{name:"codecID",value:B.string},25506:{name:"codecPrivate",value:B.binary},2459272:{name:"codecName",value:B.string},3839639:{name:"codecSettings",value:B.string},3883072:{name:"codecInfoUrl",value:B.string},2536e3:{name:"codecDownloadUrl",value:B.string},170:{name:"codecDecodeAll",value:B.bool},28587:{name:"trackOverlay",value:B.uint},224:{name:"video",container:{154:{name:"flagInterlaced",value:B.bool},21432:{name:"stereoMode",value:B.uint},176:{name:"pixelWidth",value:B.uint},186:{name:"pixelHeight",value:B.uint},21680:{name:"displayWidth",value:B.uint},21690:{name:"displayHeight",value:B.uint},21683:{name:"aspectRatioType",value:B.uint},3061028:{name:"colourSpace",value:B.uint},3126563:{name:"gammaValue",value:B.float}}},225:{name:"audio",container:{181:{name:"samplingFrequency",value:B.float},30901:{name:"outputSamplingFrequency",value:B.float},159:{name:"channels",value:B.uint},148:{name:"channels",value:B.uint},32123:{name:"channelPositions",value:B.binary},25188:{name:"bitDepth",value:B.uint}}},28032:{name:"contentEncodings",container:{25152:{name:"contentEncoding",container:{20529:{name:"order",value:B.uint},20530:{name:"scope",value:B.bool},20531:{name:"type",value:B.uint},20532:{name:"contentEncoding",container:{16980:{name:"contentCompAlgo",value:B.uint},16981:{name:"contentCompSettings",value:B.binary}}},20533:{name:"contentEncoding",container:{18401:{name:"contentEncAlgo",value:B.uint},18402:{name:"contentEncKeyID",value:B.binary},18403:{name:"contentSignature ",value:B.binary},18404:{name:"ContentSigKeyID  ",value:B.binary},18405:{name:"contentSigAlgo ",value:B.uint},18406:{name:"contentSigHashAlgo ",value:B.uint}}},25188:{name:"bitDepth",value:B.uint}}}}}}}}},475249515:{name:"cues",container:{187:{name:"cuePoint",container:{179:{name:"cueTime",value:B.uid},183:{name:"positions",container:{247:{name:"track",value:B.uint},241:{name:"clusterPosition",value:B.uint},21368:{name:"blockNumber",value:B.uint},234:{name:"codecState",value:B.uint},219:{name:"reference",container:{150:{name:"time",value:B.uint},151:{name:"cluster",value:B.uint},21343:{name:"number",value:B.uint},235:{name:"codecState",value:B.uint}}},240:{name:"relativePosition",value:B.uint}}}}}}},423732329:{name:"attachments",container:{24999:{name:"attachedFiles",multiple:!0,container:{18046:{name:"description",value:B.string},18030:{name:"name",value:B.string},18016:{name:"mimeType",value:B.string},18012:{name:"data",value:B.binary},18094:{name:"uid",value:B.uid}}}}},272869232:{name:"chapters",container:{17849:{name:"editionEntry",container:{182:{name:"chapterAtom",container:{29636:{name:"uid",value:B.uid},145:{name:"timeStart",value:B.uint},146:{name:"timeEnd",value:B.uid},152:{name:"hidden",value:B.bool},17816:{name:"enabled",value:B.uid},143:{name:"track",container:{137:{name:"trackNumber",value:B.uid},128:{name:"display",container:{133:{name:"string",value:B.string},17276:{name:"language ",value:B.string},17278:{name:"country ",value:B.string}}}}}}}}}}},307544935:{name:"tags",container:{29555:{name:"tag",multiple:!0,container:{25536:{name:"target",container:{25541:{name:"tagTrackUID",value:B.uid},25540:{name:"tagChapterUID",value:B.uint},25542:{name:"tagAttachmentUID",value:B.uid},25546:{name:"targetType",value:B.string},26826:{name:"targetTypeValue",value:B.uint},25545:{name:"tagEditionUID",value:B.uid}}},26568:{name:"simpleTags",multiple:!0,container:{17827:{name:"name",value:B.string},17543:{name:"string",value:B.string},17541:{name:"binary",value:B.binary},17530:{name:"language",value:B.string},17531:{name:"languageIETF",value:B.string},17540:{name:"default",value:B.bool}}}}}}}}}}},co=ze("music-metadata:parser:ebml");var Dr;(function(t){t[t.ReadNext=0]="ReadNext",t[t.IgnoreElement=2]="IgnoreElement",t[t.SkipSiblings=3]="SkipSiblings",t[t.TerminateParsing=4]="TerminateParsing",t[t.SkipElement=5]="SkipElement"})(Dr||(Dr={}));class EK{constructor(e){this.tokenizer=e,this.padding=0,this.parserMap=new Map,this.ebmlMaxIDLength=4,this.ebmlMaxSizeLength=8,this.parserMap.set(B.uint,n=>this.readUint(n)),this.parserMap.set(B.string,n=>this.readString(n)),this.parserMap.set(B.binary,n=>this.readBuffer(n)),this.parserMap.set(B.uid,async n=>this.readBuffer(n)),this.parserMap.set(B.bool,n=>this.readFlag(n)),this.parserMap.set(B.float,n=>this.readFloat(n))}async iterate(e,n,r){return this.parseContainer(VA(e),n,r)}async parseContainer(e,n,r){const s={};for(;this.tokenizer.position<n;){let i;const a=this.tokenizer.position;try{i=await this.readElement()}catch(c){if(c instanceof pt)break;throw c}const l=e.container[i.id];if(l)switch(r.startNext(l)){case Dr.ReadNext:if(i.id,co(`Read element: name=${ma(l)}{id=0x${i.id.toString(16)}, container=${!!l.container}} at position=${a}`),l.container){const u=await this.parseContainer(l,i.len>=0?this.tokenizer.position+i.len:-1,r);l.multiple?(s[l.name]||(s[l.name]=[]),s[l.name].push(u)):s[l.name]=u,await r.elementValue(l,u,a)}else{const u=this.parserMap.get(l.value);if(typeof u=="function"){const d=await u(i);s[l.name]=d,await r.elementValue(l,d,a)}}break;case Dr.SkipElement:co(`Go to next element: name=${ma(l)}, element.id=0x${i.id}, container=${!!l.container} at position=${a}`);break;case Dr.IgnoreElement:co(`Ignore element: name=${ma(l)}, element.id=0x${i.id}, container=${!!l.container} at position=${a}`),await this.tokenizer.ignore(i.len);break;case Dr.SkipSiblings:co(`Ignore remaining container, at: name=${ma(l)}, element.id=0x${i.id}, container=${!!l.container} at position=${a}`),await this.tokenizer.ignore(n-this.tokenizer.position);break;case Dr.TerminateParsing:return co(`Terminate parsing at element: name=${ma(l)}, element.id=0x${i.id}, container=${!!l.container} at position=${a}`),s}else switch(i.id){case 236:this.padding+=i.len,await this.tokenizer.ignore(i.len);break;default:co(`parseEbml: parent=${ma(e)}, unknown child: id=${i.id.toString(16)} at position=${a}`),this.padding+=i.len,await this.tokenizer.ignore(i.len)}}return s}async readVintData(e){const n=await this.tokenizer.peekNumber(pe);let r=128,s=1;for(;!(n&r);){if(s>e)throw new Error("VINT value exceeding maximum size");++s,r>>=1}const i=new Uint8Array(s);return await this.tokenizer.readBuffer(i),i}async readElement(){const e=await this.readVintData(this.ebmlMaxIDLength),n=await this.readVintData(this.ebmlMaxSizeLength);return n[0]^=128>>n.length-1,{id:Cg(e,e.length),len:Cg(n,n.length)}}async readFloat(e){switch(e.len){case 0:return 0;case 4:return this.tokenizer.readNumber(TA);case 8:return this.tokenizer.readNumber(_x);case 10:return this.tokenizer.readNumber(_x);default:throw new Error(`Invalid IEEE-754 float length: ${e.len}`)}}async readFlag(e){return await this.readUint(e)===1}async readUint(e){const n=await this.readBuffer(e);return Cg(n,e.len)}async readString(e){return(await this.tokenizer.readToken(new ne(e.len,"utf-8"))).replace(/\x00.*$/g,"")}async readBuffer(e){const n=new Uint8Array(e.len);return await this.tokenizer.readBuffer(n),n}}function Cg(t,e){return Number(kK(t,e))}function kK(t,e){const n=new Uint8Array(8),r=t.subarray(0,e);try{return n.set(r,8-e),Mw.get(n,0)}catch{return BigInt(-1)}}function VA(t){return t.container&&Object.keys(t.container).map(e=>{const n=t.container[e];return n.id=Number.parseInt(e),n}).forEach(e=>{e.parent=t,VA(e)}),t}function ma(t){let e="";return t.parent&&t.parent.name!=="dtd"&&(e+=`${ma(t.parent)}/`),e+t.name}const Hd=ze("music-metadata:parser:matroska");class TK extends sr{constructor(){super(...arguments),this.seekHeadOffset=0,this.flagUseIndexToSkipClusters=!1}init(e,n,r){return super.init(e,n,r),this.flagUseIndexToSkipClusters=r.mkvUseIndex??!1,this}async parse(){const e=this.tokenizer.fileInfo.size??Number.MAX_SAFE_INTEGER,n=new EK(this.tokenizer);Hd("Initializing DTD end MatroskaIterator"),await n.iterate(SK,e,{startNext:r=>{switch(r.id){case 475249515:return Hd(`Skip element: name=${r.name}, id=0x${r.id.toString(16)}`),Dr.IgnoreElement;case 524531317:if(this.flagUseIndexToSkipClusters&&this.seekHead){const s=this.seekHead.seek.find(i=>i.position+this.seekHeadOffset>this.tokenizer.position);if(s){const i=s.position+this.seekHeadOffset-this.tokenizer.position;return Hd(`Use index to go to next position, ignoring ${i} bytes`),this.tokenizer.ignore(i),Dr.SkipElement}}return Dr.IgnoreElement;default:return Dr.ReadNext}},elementValue:async(r,s,i)=>{switch(Hd(`Received: name=${r.name}, value=${s}`),r.id){case 17026:this.metadata.setFormat("container",`EBML/${s}`);break;case 290298740:this.seekHead=s,this.seekHeadOffset=i;break;case 357149030:{const a=s,l=a.timecodeScale?a.timecodeScale:1e6;if(typeof a.duration=="number"){const c=a.duration*l/1e9;await this.addTag("segment:title",a.title),this.metadata.setFormat("duration",Number(c))}}break;case 374648427:{const a=s;if(a!=null&&a.entries){a.entries.forEach(c=>{const u={codecName:c.codecID.replace("A_","").replace("V_",""),codecSettings:c.codecSettings,flagDefault:c.flagDefault,flagLacing:c.flagLacing,flagEnabled:c.flagEnabled,language:c.language,name:c.name,type:c.trackType,audio:c.audio,video:c.video};this.metadata.addStreamInfo(u)});const l=a.entries.filter(c=>c.trackType===Ua.audio).reduce((c,u)=>!c||u.flagDefault&&!c.flagDefault||u.trackNumber<c.trackNumber?u:c,null);l&&(this.metadata.setFormat("codec",l.codecID.replace("A_","")),this.metadata.setFormat("sampleRate",l.audio.samplingFrequency),this.metadata.setFormat("numberOfChannels",l.audio.channels))}}break;case 307544935:{const a=s;await Promise.all(a.tag.map(async l=>{const c=l.target,u=c!=null&&c.targetTypeValue?Sx[c.targetTypeValue]:c!=null&&c.targetType?c.targetType:"track";await Promise.all(l.simpleTags.map(async d=>{const f=d.string?d.string:d.binary;await this.addTag(`${u}:${d.name}`,f)}))}))}break;case 423732329:{const a=s;await Promise.all(a.attachedFiles.filter(l=>l.mimeType.startsWith("image/")).map(l=>this.addTag("picture",{data:l.data,format:l.mimeType,description:l.description,name:l.name})))}break}}})}async addTag(e,n){await this.metadata.addTag("matroska",e,n)}}const Af=ze("music-metadata:parser:factory");function IK(t){const e=Bw.parse(t),n=kG(e.type);return{type:n.type,subtype:n.subtype,suffix:n.suffix,parameters:e.parameters}}async function CK(t,e){const{mimeType:n,path:r,url:s}=t.fileInfo,i=HA(n)||Px(r)||Px(s);return i||Af(`No parser found for MIME-type / extension: ${n}`),jK(t,i,e)}async function jK(t,e,n){if(!e){Af("Guess parser on content...");const i=new Uint8Array(4100);if(await t.peekBuffer(i,{mayBeLess:!0}),t.fileInfo.path&&(e=Px(t.fileInfo.path)),!e){const a=await AA(i);if(!a)throw new Error("Failed to determine audio format");if(Af(`Guessed file type is mime=${a.mime}, extension=${a.ext}`),e=HA(a.mime),!e)throw new Error(`Guessed MIME-type not supported: ${a.mime}`)}}const r=await RK(e),s=new sQ(n);return await r.init(s,t,n??{}).parse(),s.toCommonMetadata()}function Px(t){if(!t)return;switch(AK(t).toLocaleLowerCase()||t){case".mp2":case".mp3":case".m2a":case".aac":return"mpeg";case".ape":return"apev2";case".mp4":case".m4a":case".m4b":case".m4pa":case".m4v":case".m4r":case".3gp":return"mp4";case".wma":case".wmv":case".asf":return"asf";case".flac":return"flac";case".ogg":case".ogv":case".oga":case".ogm":case".ogx":case".opus":case".spx":return"ogg";case".aif":case".aiff":case".aifc":return"aiff";case".wav":case".bwf":return"riff";case".wv":case".wvp":return"wavpack";case".mpc":return"musepack";case".dsf":return"dsf";case".dff":return"dsdiff";case".mka":case".mkv":case".mk3d":case".mks":case".webm":return"matroska"}}async function RK(t){switch(t){case"aiff":return new dQ;case"adts":case"mpeg":return new YQ;case"apev2":return new ts;case"asf":return new SQ;case"dsf":return new _K;case"dsdiff":return new bK;case"flac":return new TQ;case"mp4":return new jf;case"musepack":return new iK;case"ogg":return new Gm;case"riff":return new gK;case"wavpack":return new yK;case"matroska":return new TK;default:throw new Error(`Unknown parser type: ${t}`)}}function AK(t){const e=t.lastIndexOf(".");return e===-1?"":t.slice(e)}function HA(t){let e;if(!t)return;try{e=IK(t)}catch{Af(`Invalid HTTP Content-Type header value: ${t}`);return}const n=e.subtype.indexOf("x-")===0?e.subtype.substring(2):e.subtype;switch(e.type){case"audio":switch(n){case"mp3":case"mpeg":return"mpeg";case"aac":case"aacp":return"adts";case"flac":return"flac";case"ape":case"monkeys-audio":return"apev2";case"mp4":case"m4a":return"mp4";case"ogg":case"opus":case"speex":return"ogg";case"ms-wma":case"ms-wmv":case"ms-asf":return"asf";case"aiff":case"aif":case"aifc":return"aiff";case"vnd.wave":case"wav":case"wave":return"riff";case"wavpack":return"wavpack";case"musepack":return"musepack";case"matroska":case"webm":return"matroska";case"dsf":return"dsf"}break;case"video":switch(n){case"ms-asf":case"ms-wmv":return"asf";case"m4v":case"mp4":return"mp4";case"ogg":return"ogg";case"matroska":case"webm":return"matroska"}break;case"application":switch(n){case"vnd.ms-asf":return"asf";case"ogg":return"ogg"}break}}async function NK(t,e={}){const n={mimeType:t.type,size:t.size};return t instanceof File&&(n.path=t.name),PK(t.stream(),n,e)}function PK(t,e,n={}){return FK(EA(t,{fileInfo:typeof e=="string"?{mimeType:e}:e}),n)}function FK(t,e){return CK(t,e)}const WA=async t=>{var l;if(!t)return;const e=await NK(t);if(!e)return;const{common:{title:n,artist:r,picture:s},format:{duration:i}}=e;return Object.assign({},{name:n||t.name,singer:r||"...",duration:i||0,image:s?(l=s[0])==null?void 0:l.data:[]})};function DK(t){const{setErrorToast:e,setSuccessToast:n}=ge(),{songFile:r,imageFile:s,setSong:i,setImageFile:a,updateSongData:l,setSongData:c,resetAddSongContext:u,songData:d,singers:f,song:p,genres:g,setGenres:v,setSingers:_,imageBlob:b,setImageBlob:E,...w}=Za(),[S,I]=m.useState(!1),F=m.useRef(null),D=m.useMemo(()=>t.variant==="add"?!0:!p||!d?!1:d.name!==p.name||f.length!==p.singers.length||d.like!==p.like||g.length!==p.genres.length,[d,p,f,g]),C=!!s,k=m.useMemo(()=>{const ee=!!(d!=null&&d.name)&&!!f.length&&!!g.length&&D;return t.variant==="add"?ee:ee||C},[C,D,f,g,d]),R=()=>{switch(t.variant){case"add":return yx({owner_email:t.ownerEmail,distributor:t.distributor,is_official:!0});case"edit":const{id:ee,updated_at:xe,...Se}=t.song;return _(Se.singers),v(Se.genres),yx(Se)}},j=()=>{var ee,xe;switch(t.variant){case"add":(ee=F.current)==null||ee.close(),setTimeout(()=>u(R()),500);break;case"edit":(xe=F.current)==null||xe.close()}},N=async()=>{if(!r)return;const ee=await WA(r);if(ee){const xe={name:ee.name,duration:Math.floor(ee.duration),size:Math.floor(r.size/1024),image_url:""};if(ee.image){const Se=new Blob([ee.image]);E(Se),xe.image_url=URL.createObjectURL(Se)}l(xe)}},P=()=>{const ee={},xe={};return g.forEach(Se=>ee[Se.id]=!0),f.forEach(Se=>xe[Se.id]=!0),{genre_map:ee,singer_map:xe}},A=async()=>{var ee,xe;try{if(!k||!d)return;const Se={...d};if(I(!0),s||b){const Ue=await Ji({imageFile:s,blob:b});t.variant==="edit"&&(p!=null&&p.image_file_path)&&An({filePath:p.image_file_path,msg:">>> api: Delete image file"}),Object.assign(Se,Ue)}switch(t.variant){case"add":{if(!r)return;const{filePath:Ue,fileURL:H}=await yw({file:r,folder:"/songs/",msg:">>> api: upload song file",namePrefix:"song"}),Y={singers:f,genres:g,song_url:H,song_file_path:Ue,...P()};Object.assign(Se,Y),await Qs({collectionName:"Songs",data:Se,msg:">>> api: set song doc"}),n(),(ee=F.current)==null||ee.open();break}case"edit":{if(!p)return;if(D){const Ue={singers:f,genres:g,...P()};Object.assign(Se,Ue)}p&&i({...p,...Se}),a(void 0),await kt({collectionName:"Songs",id:p.id,data:Se}),n(),(xe=F.current)==null||xe.open()}}}catch(Se){console.log(Se),e()}finally{I(!1)}};return m.useEffect(()=>{c(R())},[]),m.useEffect(()=>{r&&N()},[r]),m.useEffect(()=>{s&&l({image_url:URL.createObjectURL(s)})},[s]),{isValidToSubmit:k,handleSubmit:A,isFetching:S,updateSongData:l,songFile:r,songData:d,genres:g,singers:f,modalRef:F,handleCloseModalAfterFinished:j,...w}}function LK({handleCloseModal:t,variant:e}){return o.jsxs(si,{children:[o.jsx(be,{title:"Finished"}),o.jsx(Xe,{width:"w-[120px]",className:"mx-auto w-[120px]",src:"https://zalo-api.zadn.vn/api/emoticon/sticker/webpc?eid=46985&size=130"}),o.jsxs("div",{className:"flex justify-center mt-5 space-x-2",children:[o.jsxs(ue,{href:"/dashboard/song",children:[o.jsx(xI,{className:"w-6"}),o.jsx("span",{children:"Songs"})]}),o.jsxs(ue,{onClick:t,children:[o.jsx(br,{className:"w-6"}),o.jsx("span",{children:e==="add"?"Add more":"Ok"})]})]})]})}function MK(){const{setImageFile:t,songData:e,updateSongData:n,imageBlob:r,setImageBlob:s}=Za(),i=m.useRef(null),a=m.useRef(null),l=u=>{var d;(d=u.target.files)!=null&&d.length&&t(u.target.files[0])},c=()=>{e&&(s(void 0),URL.revokeObjectURL(e.image_url),n({image_url:""}))};return o.jsxs(o.Fragment,{children:[o.jsx(ue,{className:"",size:"clear",children:o.jsxs("label",{htmlFor:"image_upload",className:"inline-flex p-1.5 space-x-1 cursor-pointer md:px-3",children:[o.jsx(hl,{className:"w-6"}),o.jsx("span",{className:"hidden md:block",children:"Change image"})]})}),r&&o.jsx(ue,{onClick:c,className:"h-[36px] justify-center w-[36px]",size:"clear",children:o.jsx(Gi,{className:"w-6"})}),(e==null?void 0:e.image_url)&&o.jsxs(ue,{onClick:()=>{var u;return(u=a.current)==null?void 0:u.open()},className:"p-1.5 justify-center md:px-3",size:"clear",children:[o.jsx(SI,{className:"w-6"}),o.jsx("span",{className:"hidden md:block",children:"Image info"})]}),o.jsx("input",{ref:i,onChange:l,type:"file",multiple:!0,accept:"image/png, image/jpeg",id:"image_upload",className:"hidden"}),(e==null?void 0:e.image_url)&&o.jsx(kr,{variant:"animation",ref:a,wrapped:!1,children:o.jsxs(Er,{children:[o.jsxs("p",{children:["Url: ",e==null?void 0:e.image_url]}),o.jsxs("p",{children:["Hash: ",e==null?void 0:e.blurhash_encode]})]})})]})}function OK(){const t=m.useRef(null),{songData:e,updateSongData:n}=Za(),[r,s]=m.useState({name:e==null?void 0:e.name,like:e==null?void 0:e.like}),i=l=>{s(c=>({...c,...l}))},a=()=>{var l;n(r),(l=t.current)==null||l.close()};return o.jsxs(o.Fragment,{children:[o.jsxs(ue,{onClick:()=>{var l;return(l=t.current)==null?void 0:l.open()},className:"p-1.5 justify-center md:px-3",size:"clear",children:[o.jsx(Ys,{className:"w-6"}),o.jsx("span",{className:"hidden md:block",children:"Edit"})]}),o.jsx(kr,{variant:"animation",wrapped:!1,ref:t,children:o.jsxs(Er,{children:[o.jsx(Ct,{title:"Edit song",close:()=>{var l;return(l=t.current)==null?void 0:l.close()}}),o.jsxs("div",{className:"space-y-2.5",children:[o.jsxs("div",{children:[o.jsx("p",{children:"Name:"}),o.jsx(Ht,{className:"bg-black/10",value:r==null?void 0:r.name,onChange:l=>i({name:l.target.value})})]}),o.jsxs("div",{className:"t",children:[o.jsx("p",{children:"Like:"}),o.jsx(Ht,{className:"bg-black/10",value:r==null?void 0:r.like,onChange:l=>isNaN(+l.target.value)?{}:i({like:+l.target.value})})]})]}),o.jsx("p",{className:"mt-6 text-right",children:o.jsx(ue,{onClick:a,children:"Ok"})})]})})]})}function qA(t){const{isFetching:e,handleSubmit:n,updateSongData:r,songData:s,isValidToSubmit:i,songFile:a,modalRef:l,handleCloseModalAfterFinished:c}=DK(t),u=m.useRef(null);return t.variant==="add"&&!a?o.jsx(an,{children:o.jsx(yA,{})}):o.jsxs("div",{className:"w-full md:max-w-[800px] md:mx-auto",children:[o.jsx("audio",{ref:u,src:t.variant==="add"?URL.createObjectURL(a):(s==null?void 0:s.song_url)||"",className:"hidden"}),s&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"md:flex md:space-x-5",children:[o.jsxs("div",{className:"flex flex-col items-center md:w-1/3 md:block space-y-2.5",children:[o.jsx("div",{className:"w-[200px] h-[200px] mx-auto bg-black/5 rounded-lg overflow-hidden",children:o.jsx(Xe,{className:"object-cover h-full",blurHashEncode:s.blurhash_encode,src:s.image_url})}),t.variant==="edit"&&o.jsxs("div",{className:"w-full",children:[o.jsx(be,{title:s.name}),o.jsxs(yn,{className:"[&>*]:text-sm ",children:[o.jsxs("p",{children:["Duration: ",Bs(s.duration)]}),o.jsxs("p",{children:["Size: ",s.size," kb"]}),o.jsxs("p",{className:"mt-1 font-[500]",children:[o.jsx("span",{className:"text-red-500 text-xl",children:""})," ",_r(s.like)]})]})]}),o.jsx("div",{className:"w-full",children:o.jsxs("div",{className:"-mt-2 -ml-2 flex flex-wrap w-full [&_button]:mt-2 [&_button]:ml-2",children:[o.jsx(MK,{}),t.variant==="edit"&&o.jsx(OK,{})]})})]}),o.jsxs("div",{className:"mt-5 md:mt-0 space-y-3 flex-grow",children:[u.current&&o.jsx(Pq,{variant:t.variant,audioEle:u.current}),t.variant==="add"&&o.jsx(yn,{children:o.jsxs("span",{children:["Duration: ",Bs(s.duration)," , Size: ",s.size,"kb"]})}),t.variant==="add"&&o.jsxs("div",{className:"",children:[o.jsx(be,{title:"Name"}),o.jsx(Ht,{value:s.name,onChange:d=>r({name:d.target.value})})]}),o.jsx(Nq,{}),o.jsx(Dq,{})]})]}),o.jsx("p",{className:"text-center mt-5",children:o.jsxs(ue,{onClick:n,disabled:!i,loading:e,children:[o.jsx(Yy,{className:"w-6"}),o.jsx("span",{children:"Ok"})]})}),o.jsx(Fe,{persisted:t.variant==="add",ref:l,wrapped:!1,variant:"animation",children:o.jsx(LK,{variant:t.variant,handleCloseModal:c})})]})]})}function $K(){const{user:t}=he();if(t)return o.jsxs("div",{className:"pb-[46px]",children:[o.jsx(be,{className:"mb-5",title:"Add Song"}),o.jsx(qA,{distributor:t.display_name,ownerEmail:t.email,variant:"add"})]})}function BK(){const[t,e]=m.useState(!0),[n,r]=m.useState(),s=m.useRef(!1),i=qt(),{setErrorToast:a}=ge();return{song:n,isFetching:t,getSong:async c=>{try{const u=await Ur({collectionName:"Songs",id:c});if(!u.exists())return i("/dashboard/song");const d={...u.data(),id:u.id,queue_id:""};r(d)}catch(u){console.log(u),a()}finally{e(!1)}},ranEffect:s}}function zK(){const{getSong:t,isFetching:e,song:n,ranEffect:r}=BK(),{variant:s,setSong:i}=Za(),a=qi();return m.useEffect(()=>{if(!r.current){if(s.current="edit",r.current=!0,!a.songId)return;t(a.songId)}},[]),m.useEffect(()=>{n&&i(n)},[n]),e?o.jsx(an,{children:o.jsx(Hu,{})}):n?o.jsxs("div",{className:"pb-[46px]",children:[o.jsx(be,{className:"mb-5",title:"Edit Song"}),o.jsx(qA,{song:n,variant:"edit"})]}):o.jsx(o.Fragment,{})}const UK=["All","Result"];function VK(){const{setPlaylists:t,playlists:e}=Fn(),[n,r]=m.useState(""),[s,i]=m.useState(!0),[a,l]=m.useState("All"),{setErrorToast:c}=ge(),u=async f=>{try{f.preventDefault(),i(!0);const p=_e(wr,X("is_official","==",!0),X("is_album","==",!1),X("name",">=",n),X("name","<=",n+"")),g=await Vr(p);t(g),l("Result")}catch(p){console.log({message:p}),c()}finally{i(!1)}},d=async()=>{try{i(!0);const f=_e(wr,X("is_official","==",!0),X("is_album","==",!1),hs("updated_at","desc")),p=await Vr(f);t(p)}catch(f){console.log({message:f}),c()}finally{i(!1)}};return m.useEffect(()=>{a==="All"&&d()},[a]),{isFetching:s,value:n,setValue:r,handleSubmit:u,playlists:e,tab:a,setTab:l,tabs:UK}}function HK(){const{user:t}=he(),{handleAddPlaylist:e,isFetching:n}=WR(),r=m.useRef(null),s=()=>{var a;return(a=r.current)==null?void 0:a.close()},i=async(a,l)=>{a.is_official=!0,await e(a,l),s()};if(t)return o.jsxs(o.Fragment,{children:[o.jsxs(ue,{onClick:()=>{var a;return(a=r.current)==null?void 0:a.open()},className:"self-start p-1.5 ml-5",size:"clear",children:[o.jsx(ps,{className:"w-6"}),o.jsx("div",{className:"hidden md:block",children:"Add new playlist"})]}),o.jsx(Fe,{ref:r,variant:"animation",children:o.jsx(Er,{className:"w-[500px]",children:o.jsx(bl,{close:s,isLoading:n,variant:"add",user:t,submit:i})})})]})}function WK(){const{isFetching:t,playlists:e,tab:n,tabs:r,setTab:s,...i}=VK();return o.jsxs("div",{className:"pb-[46px]",children:[o.jsx(be,{title:"Playlists"}),o.jsxs("div",{className:"flex justify-between mt-3",children:[o.jsx(kl,{...i}),o.jsx(HK,{})]}),o.jsx("div",{className:`mt-5 w-fit ${n==="All"?"pointer-events-none":""} self-start`,children:o.jsx(xs,{tabs:r,render:a=>a,tab:n,setTab:s})}),o.jsxs("div",{className:"mt-3",children:[t&&o.jsx(le,{className:"h-[200px] rounded-xl"}),!t&&o.jsx(ea,{colList:["Name","Like",""],children:e.length?e.map((a,l)=>o.jsxs("tr",{children:[o.jsx("td",{children:o.jsx(we,{className:"hover:underline",to:`/dashboard/playlist/${a.id}`,children:a.name})}),o.jsx("td",{children:_r(a.like)}),o.jsx("td",{children:"-"})]},l)):o.jsx("tr",{children:o.jsx("td",{colSpan:4,children:o.jsx(Ke,{})})})})]})]})}function qK(){const[t,e]=m.useState([]),[n,r]=m.useState(""),[s,i]=m.useState(!1),{setErrorToast:a}=ge();return{isFetching:s,value:n,songs:t,setValue:r,handleSubmit:async c=>{try{c.preventDefault(),i(!0);const u=_e(Nn,X("name",">=",n),X("name","<=",n+""),X("is_official","==",!0)),d=await Pn(u);e(d)}catch(u){console.log({message:u}),a()}finally{i(!1)}}}}function GK({closeModal:t,submit:e,isLoading:n}){const{theme:r}=q(),{songs:s,isFetching:i,...a}=qK(),{selectedSongs:l,selectSong:c}=vu(),u=async()=>{l.length&&(e(l),t())},d=m.useMemo(()=>{const p=l.map(g=>g.id);return s.filter(g=>!p.includes(g.id))},[s,l]),f={col:"md:w-1/2 flex-1 flex flex-col px-2 overflow-hidden",box:"rounded-lg bg-black/10 p-2",songItem:"rounded-md w-full p-1 text-left"};return o.jsx(o.Fragment,{children:o.jsxs(Er,{className:"w-[750px] h-[500px] flex flex-col overflow-hidden",children:[o.jsx(Ct,{close:t,title:"Add song"}),o.jsxs("div",{className:"flex-grow flex flex-col md:flex-row -mx-2",children:[o.jsxs("div",{className:`${f.col}`,children:[o.jsx(kl,{...a}),o.jsx("div",{className:`${f.box} flex-grow mt-3`,children:o.jsx("div",{className:"h-full overflow-auto pace-y-2",children:i?o.jsx(Hu,{className:"h-full"}):d.map((p,g)=>o.jsx("button",{onClick:()=>c(p),className:`${f.songItem} bg-black/10 ${r.content_hover_bg}`,children:o.jsx("h5",{className:"",children:p.name})},g))})})]}),o.jsxs("div",{className:`${f.col} mt-3 md:mt-0`,children:[o.jsx("div",{className:"font-[500] mb-3",children:"Selected:"}),o.jsx("div",{className:`${f.box} flex-grow overflow-auto space-y-2 `,children:l.map((p,g)=>o.jsx("button",{onClick:()=>c(p),className:`${f.songItem} ${r.content_bg} hover:bg-black/10 hover:text-black`,children:o.jsx("h5",{className:"",children:p.name})},g))})]})]}),o.jsx("p",{className:"text-right mt-3 flex-shrink-0",children:o.jsxs(ue,{disabled:!l.length,loading:n,onClick:u,children:[o.jsx(bu,{className:"w-6"}),o.jsx("span",{children:"Add"})]})})]})})}function GA(t){return o.jsx(ms,{children:o.jsx(GK,{...t})})}function Gw({children:t}){return o.jsx("div",{className:"-ml-2 -mt-2 [&_button]:mt-2 [&_button]:ml-2 [&_button]:p-1.5 md:[&_button]:px-3  [&_span]:hidden md:[&_span]:block",children:t})}function QK(){const[t,e]=m.useState(""),n=m.useRef(null),{action:r,playlist:s,isFetching:i}=Um(),a=d=>{var f,p;e(d),t==="add-song-to-playlist"&&((f=n.current)==null||f.setModalPersist(!0)),(p=n.current)==null||p.open()},l=()=>{var d;return(d=n.current)==null?void 0:d.close()},c=async d=>{await r(d),l()},u=()=>{switch(t){case"":return o.jsx(o.Fragment,{});case"edit":return s?o.jsx(o.Fragment,{children:o.jsx(Er,{className:"w-[500px]",children:o.jsx(bl,{submit:(d,f)=>c({variant:"edit-playlist",playlist:d,imageFile:f}),variant:"edit",isLoading:i,playlist:s,close:l})})}):"Playlist is undefined";case"delete":return o.jsx(gs,{loading:i,label:"Delete playlist ?",callback:()=>c({variant:"delete-playlist"}),close:l});case"add-song-to-playlist":return o.jsx(GA,{isLoading:i,submit:d=>c({variant:"add-songs",songs:d}),closeModal:l})}};return o.jsxs(o.Fragment,{children:[o.jsxs(Gw,{children:[o.jsxs(ue,{onClick:()=>a("edit"),size:"clear",children:[o.jsx(Ys,{className:"w-5"}),o.jsx("span",{children:"Edit"})]}),o.jsxs(ue,{onClick:()=>a("delete"),size:"clear",children:[o.jsx(Dn,{className:"w-5"}),o.jsx("span",{children:"Delete"})]}),o.jsxs(ue,{onClick:()=>a("add-song-to-playlist"),size:"clear",children:[o.jsx(nH,{className:"w-5"}),o.jsx("span",{children:"Add song"})]})]}),o.jsx(Fe,{wrapped:!1,variant:"animation",ref:n,children:o.jsx(si,{className:"w-[unset]",children:u()})})]})}function KK(){const[t,e]=m.useState(!0),{setSongs:n,setPlaylist:r,playlist:s,songs:i}=Nw(),a=m.useRef(!1),l=qi(),c=qt(),{setErrorToast:u}=ge(),d=async()=>{try{if(!l.id)return;const f=await Ur({collectionName:"Playlists",id:l.id});if(!f.exists())return c("/dashboard/playlist");const p={...f.data(),id:f.id};if(p.song_ids.length){const g=_e(Nn,X(Zs(),"in",p.song_ids)),v=await Pn(g);n(v)}r(p)}catch(f){console.log(f),u()}finally{e(!1)}};return m.useEffect(()=>{a.current||(a.current=!0,d())},[]),{songs:i,playlist:s,isFetching:t}}function XK({singer:t}){const{action:e}=Um();return o.jsxs(o.Fragment,{children:[o.jsx(we,{className:"hover:underline",to:`/dashboard/singer/${t.id}`,children:t.name}),o.jsx("div",{children:o.jsx("button",{onClick:()=>e({variant:"remove-singer",singer:t}),children:o.jsx(Dn,{className:"w-5"})})})]})}function YK(t){const{playlist:e}=Nw(),{updatePlaylistData:n,playlistData:r,isValidToSubmit:s}=qR(t),{action:i,isFetching:a}=Um(),l=m.useRef(null),c=m.useRef(null),u=async()=>{var d;!r||!s||(await i({variant:"edit-playlist",playlist:r}),(d=l.current)==null||d.close())};if(e)return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsxs("p",{className:"mt-1 font-[500]",children:[o.jsx("span",{className:"text-red-500 text-xl",children:""})," ",_r(e.like)]}),o.jsx("button",{className:"",onClick:()=>{var d;return(d=l.current)==null?void 0:d.open()},children:o.jsx(Ys,{className:"w-5"})})]}),o.jsx(kr,{wrapped:!1,variant:"animation",ref:l,children:o.jsxs(Er,{children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"like",children:"Like"}),o.jsx(Ht,{id:"like",ref:c,type:"number",value:(r==null?void 0:r.like)+"",onChange:d=>n({like:+d.target.value})})]}),o.jsx("p",{className:"text-right mt-5 md:mt-0",children:o.jsx(ue,{loading:a,color:"primary",onClick:u,disabled:!s,className:"font-playwriteCU rounded-full",children:"Save"})})]})})]})}function JK(){const{isFetching:t,songs:e,playlist:n}=KK(),r=m.useMemo(()=>e.reduce((s,i)=>s+i.duration,0),[e]);return t?o.jsx(an,{children:o.jsx(Hu,{})}):n?o.jsxs("div",{className:"pb-[46px]",children:[o.jsx(be,{title:"Edit playlist",className:"mb-3"}),o.jsxs("div",{className:"md:flex md:-mx-3",children:[o.jsxs("div",{className:"space-y-2.5 md:px-3",children:[o.jsx("div",{className:"w-[200px] h-[200px] mx-auto",children:o.jsx(Eu,{children:o.jsx(Xe,{className:"object-cover h-full",blurHashEncode:n.blurhash_encode,src:n.image_url})})}),o.jsxs("div",{children:[o.jsx(be,{title:n.name}),o.jsxs(yn,{className:"mt-1",children:[o.jsx("p",{children:n.is_public?"Public":"Private"}),o.jsxs("p",{children:[e.length," songs - ",Bs(r)]}),o.jsx(YK,{variant:"edit",playlist:n})]})]}),o.jsx(QK,{})]}),o.jsxs("div",{className:"w-full mt-3 md:mt-0 md:w-3/4 md:px-3",children:[o.jsx(be,{title:"Singers"}),o.jsx(yn,{className:"mt-1",children:n.singers.length?o.jsx("div",{className:"-mt-2 -ml-2 flex ",children:n.singers.map((s,i)=>o.jsx(El,{children:o.jsx(XK,{singer:s})},i))}):o.jsx(Ke,{})}),o.jsx(be,{title:"Songs",className:"mt-3"}),o.jsx(yn,{className:"mt-1",children:o.jsx("div",{className:"overflow-hidden",children:o.jsx(FI,{className:"[&_td]:text-sm [&_tbody>tr]:border-t [&_tr]:border-black/10 [&_th]:text-sm [&_th]:text-left [&_td]:p-2 [&_th]:p-2 hover:[&_tr:not(div.absolute)]:bg-black/5",colList:["Name","Singer","Like",""],children:e.length?e.map((s,i)=>o.jsx(pA,{variant:"playlist",song:s},i)):o.jsx("tr",{children:o.jsx("td",{colSpan:3,children:o.jsx(Ke,{})})})})})})]})]})]}):o.jsx(o.Fragment,{})}function ZK(t){const{setErrorToast:e,setSuccessToast:n}=ge(),{singer:r,setSinger:s,setSingers:i}=Xs(),[a,l]=m.useState(),[c,u]=m.useState(),[d,f]=m.useState(!1),p=m.useRef(null),g=S=>{a&&l({...a,...S})},v=m.useMemo(()=>t.variant==="add"?!0:!r||!a?!1:a.name!==r.name||a.description!==r.description||a.like!==r.like,[a]),_=!!c,b=m.useMemo(()=>{const S=!!(a!=null&&a.name)&&v;return t.variant==="add"?S:S||_},[_,v,a]),E=async()=>{try{if(!b||!a)return;f(!0);const S={...a};if(c){const I=await Ji({imageFile:c});Object.assign(S,I)}switch(t.variant){case"add":{const I=await Qs({collectionName:"Singers",data:S}),F={...a,id:I.id};i(D=>[F,...D]),n("Add singer successful");break}case"edit":{if(!r)return;await kt({collectionName:"Singers",id:r.id,data:S}),s({...r,...S}),n("Edit singer successful")}}}catch(S){console.log(S),e()}finally{f(!1),t.closeModal()}},w=()=>{switch(t.variant){case"add":return wf({});case"edit":if(!r)throw new Error("");const{id:S,...I}=r;return wf(I)}};return m.useEffect(()=>{var S;t.variant==="add"&&((S=p.current)==null||S.focus()),l(w())},[]),m.useEffect(()=>{c&&g({image_url:URL.createObjectURL(c)})},[c]),m.useEffect(()=>{var S;(S=p.current)==null||S.focus()},[]),{singerData:a,imageFile:c,setImageFile:u,updateSingerData:g,setSingerData:l,inputRef:p,handleSubmit:E,isFetching:d,isValidToSubmit:b}}function QA(t){const{theme:e}=q(),{setImageFile:n,singerData:r,handleSubmit:s,isFetching:i,isValidToSubmit:a,updateSingerData:l,inputRef:c}=ZK(t),u=d=>{var f;(f=d.target.files)!=null&&f.length&&n(d.target.files[0])};if(r)return o.jsxs(Er,{className:"w-[700px] flex flex-col md:block",children:[o.jsx(Ct,{close:t.closeModal,title:t.variant==="add"?"Add singer":"Edit singer"}),o.jsxs("div",{className:"flex-grow overflow-auto md:flex md:flex-[unset] md:overflow-hidden",children:[o.jsxs("div",{className:"space-y-2.5",children:[o.jsx("div",{className:"w-[200px] h-[200px] rounded-lg overflow-hidden",children:o.jsx(Xe,{className:"object-cover object-center h-full",blurHashEncode:r.blurhash_encode,src:r.image_url})}),o.jsx("input",{onChange:u,type:"file",multiple:!0,accept:"image/png, image/jpeg, image/webp",id:"image_upload",className:"hidden"}),o.jsx("div",{className:"space-x-2 flex",children:o.jsx(ue,{className:`${e.content_bg}`,size:"clear",children:o.jsx("label",{htmlFor:"image_upload",className:"px-5 py-1 cursor-pointer ",children:o.jsx(hl,{className:"w-5"})})})})]}),o.jsxs("div",{className:"flex-grow flex flex-col mt-3  space-y-2.5 md:mt-0 md:ml-3",children:[o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{htmlFor:"name",className:"opacity-[.8]",children:"Name:"}),o.jsx(Ht,{ref:c,type:"text",id:"name",placeholder:"",className:"bg-[#f1f1f1]",value:r.name,onChange:d=>l({name:d.target.value})})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{htmlFor:"description",className:"opacity-[.8]",children:"Description:"}),o.jsx("textarea",{placeholder:"...",id:"description",className:`${nv} w-full bg-[#f1f1f1] rounded-md min-h-[100px]`,value:r.description,onChange:d=>l({description:d.target.value})})]}),t.variant==="edit"&&o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{htmlFor:"like",className:"opacity-[.8]",children:"Like:"}),o.jsx(Ht,{id:"like",className:"bg-[#f1f1f1]",type:"number",value:r.like+"",onChange:d=>l({like:+d.target.value})})]})]})]}),o.jsx("p",{className:"text-right mt-3",children:o.jsx(ue,{loading:i,color:"primary",onClick:s,disabled:!a,className:"font-playwriteCU rounded-full",children:"Save"})})]})}function eX(){const t=m.useRef(null),e=()=>{var n;return(n=t.current)==null?void 0:n.close()};return o.jsxs(o.Fragment,{children:[o.jsxs(ue,{onClick:()=>{var n;return(n=t.current)==null?void 0:n.open()},className:"self-start p-1.5 ml-5",size:"clear",children:[o.jsx(ps,{className:"w-6"}),o.jsx("div",{className:"hidden md:block",children:"Add new singer"})]}),o.jsx(Fe,{wrapped:!1,ref:t,variant:"animation",children:o.jsx(si,{className:"w-[unset]",children:o.jsx(QA,{closeModal:e,variant:"add"})})})]})}const tX=["All","Result"];function nX(){const{setSingers:t,singers:e}=Xs(),[n,r]=m.useState(""),[s,i]=m.useState(!0),[a,l]=m.useState("All"),{setErrorToast:c}=ge(),u=async f=>{try{f.preventDefault(),i(!0);const p=_e(yf,X("name",">=",n),X("name","<=",n+"")),g=await vf(p);t(g),l("Result")}catch(p){console.log({message:p}),c()}finally{i(!1)}},d=async()=>{try{i(!0);const f=_e(yf,hs("created_at","desc")),p=await vf(f);t(p)}catch(f){console.log({message:f}),c()}finally{i(!1)}};return m.useEffect(()=>{a==="All"&&d()},[a]),{isFetching:s,value:n,setValue:r,handleSubmit:u,singers:e,tab:a,setTab:l,tabs:tX}}function rX(){const{isFetching:t,singers:e,tabs:n,tab:r,setTab:s,...i}=nX();return o.jsxs("div",{className:"pb-[46px]",children:[o.jsx(be,{title:"Singer"}),o.jsxs("div",{className:"flex justify-between mt-3",children:[o.jsx(kl,{...i}),o.jsx(eX,{})]}),o.jsx("div",{className:`mt-5 w-fit ${r==="All"?"pointer-events-none":""} self-start`,children:o.jsx(xs,{tabs:n,render:a=>a,tab:r,setTab:s})}),o.jsxs("div",{className:"mt-3",children:[t&&o.jsx(le,{className:"h-[200px] rounded-xl"}),!t&&o.jsx(ea,{colList:["Name","Like"],children:e.length?e.map((a,l)=>o.jsxs("tr",{children:[o.jsx("td",{children:o.jsx(we,{className:"hover:underline",to:`/dashboard/singer/${a.id}`,children:a.name})}),o.jsx("td",{children:_r(a.like)})]},l)):o.jsx("tr",{children:o.jsx("td",{colSpan:2,children:o.jsx(Ke,{})})})})]})]})}function sX({value:t}){const e=m.useRef(null);return o.jsxs(o.Fragment,{children:[o.jsxs(ue,{onClick:()=>{var n;return(n=e.current)==null?void 0:n.open()},className:"p-1.5 ml-5",size:"clear",children:[o.jsx(br,{className:"w-6"}),o.jsx("div",{className:"hidden md:block",children:"Add genre"})]}),o.jsx(Fe,{ref:e,variant:"animation",wrapped:!1,children:o.jsx(Dw,{genreName:t,type:"add",closeModal:()=>{var n;return(n=e.current)==null?void 0:n.close()}})})]})}function iX({genre:t}){const[e,n]=m.useState(""),r=m.useRef(null),{action:s,isFetching:i}=wA(),a=u=>{var d;n(u),(d=r.current)==null||d.open()},l=()=>{var u;return(u=r.current)==null?void 0:u.close()},c=async()=>{await s({type:"delete",id:t.id})};return o.jsxs(o.Fragment,{children:[o.jsxs(El,{children:[o.jsx("span",{children:t.name}),o.jsxs("div",{children:[o.jsx("button",{className:"",onClick:()=>a("edit"),children:o.jsx(Ys,{className:"w-5"})}),o.jsx("button",{onClick:()=>a("delete"),children:o.jsx(Dn,{className:"w-5"})})]})]}),o.jsxs(Fe,{variant:"animation",ref:r,wrapped:!1,children:[e==="edit"&&o.jsx(Dw,{type:"edit",genre:t,closeModal:l}),e==="delete"&&o.jsx(si,{children:o.jsx(gs,{callback:c,close:l,loading:i,label:`Delete genre '${t.name}'`})})]})]})}function aX(){const{isFetching:t,api:e}=_A(),{_genres:n,...r}=bA();return m.useEffect(()=>{e()},[]),o.jsxs("div",{className:"pb-[46px]",children:[o.jsx(be,{title:"Genres"}),o.jsxs("div",{className:"flex justify-between items-start mt-3",children:[o.jsx(gA,{...r}),o.jsx(sX,{value:r.value})]}),o.jsxs("div",{className:"mt-3",children:[t&&o.jsx(le,{className:"h-[200px] rounded-xl"}),!t&&o.jsx(o.Fragment,{children:n.length?o.jsx("div",{className:"flex flex-wrap -mt-2 -mx-2",children:n.map(s=>o.jsx(iX,{genre:s},s.id))}):o.jsx(Ke,{})})]})]})}function oX(){return o.jsx(dA,{})}function lX(){const{setErrorToast:t}=ge(),{singer:e,setSinger:n}=Xs(),[r,s]=m.useState(!1),i=qt();return{isFetching:r,action:async l=>{try{switch(l.variant){case"delete":{if(!e)throw new Error("");s(!0),await Vu({collectionName:"Singers",id:e.id}),e.image_file_path&&await An({filePath:e.image_file_path}),s(!1),i("/dashboard/singer");break}}}catch(c){console.log({message:c}),t("")}finally{s(!1)}},singer:e,setSinger:n}}function cX(){const[t,e]=m.useState(""),n=m.useRef(null),{action:r,isFetching:s,singer:i}=lX(),a=c=>{var u;e(c),(u=n.current)==null||u.open()},l=()=>{var c;return(c=n.current)==null?void 0:c.close()};return o.jsxs(o.Fragment,{children:[o.jsx("button",{onClick:()=>a("more"),className:"text-sm ml-auto !mt-0",children:"See more"}),o.jsx("div",{className:"mt-3 md:!mt-auto",children:o.jsxs(Gw,{children:[o.jsxs(ue,{onClick:()=>a("edit"),className:"md:px-3",size:"clear",children:[o.jsx(Ys,{className:"w-6"}),o.jsx("div",{className:"hidden md:block",children:"Edit singer"})]}),o.jsxs(ue,{onClick:()=>a("delete"),className:"md:px-3",size:"clear",children:[o.jsx(Dn,{className:"w-6"}),o.jsx("div",{className:"hidden md:block",children:"Delete"})]})]})}),o.jsxs(kr,{ref:n,children:[t==="more"&&i&&o.jsx("div",{className:"w-[400px] max-w-[calc(100vw-40px)]",children:i.description}),t==="edit"&&o.jsx(QA,{closeModal:l,variant:"edit"}),t==="delete"&&i&&o.jsx(gs,{label:`Delete singer '${i.name}'`,loading:s,callback:()=>r({variant:"delete"}),close:l})]})]})}function uX(){const{setSinger:t,setSongs:e,setPlaylists:n,setAlbums:r}=Xs(),{setErrorToast:s}=ge(),{setIsFetching:i}=qu(),a=qi(),l=qt(),c=m.useRef(!1),u=async()=>{try{if(!a.id)return;const d=await Ur({collectionName:"Singers",id:a.id});d.exists()||l("/dashboard/singer");const f={...d.data(),id:a.id},p=_e(Nn,X(`singer_map.${f.id}`,"==",!0)),g=await Pn(p),v=_e(wr,X(`singer_map.${f.id}`,"==",!0)),_=await Vr(v),b=[],E=[];_.forEach(w=>w.is_album?E.push(w):b.push(w)),t(f),n(b),r(E),e(g)}catch(d){console.log({error:d}),s()}finally{i(!1)}};m.useEffect(()=>{c.current||(c.current=!0,u())},[])}function dX(){const[t,e]=m.useState(!0);return{isFetching:t,setIsFetching:e}}const KA=m.createContext(null);function hX({children:t}){return uX(),t}function fX({children:t}){return o.jsx(KA.Provider,{value:dX(),children:o.jsx(hX,{children:t})})}function qu(){const t=m.useContext(KA);if(!t)throw new Error;return t}function mX(){const{singer:t}=Xs(),{isFetching:e}=qu();return!e&&!t?o.jsx(o.Fragment,{}):o.jsx(o.Fragment,{children:o.jsxs("div",{className:"md:flex",children:[o.jsx("div",{className:"w-[260px] h-[260px] mx-auto md:m-unset",children:e?o.jsx(le,{className:"pt-[100%] "}):o.jsx(Eu,{children:o.jsx(Xe,{src:t==null?void 0:t.image_url,blurHashEncode:(t==null?void 0:t.blurhash_encode)||""})})}),o.jsx("div",{className:"flex-grow flex flex-col mt-5 space-y-2.5  md:mt-0 md:ml-5",children:e?o.jsxs(o.Fragment,{children:[o.jsx(le,{className:"h-[60px] w-full md:w-[200px]"}),o.jsx(le,{className:"h-[120px] w-full md:w-[70%]"}),o.jsx(le,{className:"h-[17px] w-[200px]"})]}):t&&o.jsxs(o.Fragment,{children:[o.jsx("p",{className:"text-3xl leading-[2] font-playwriteCU",children:t.name}),o.jsxs("p",{children:[o.jsx("span",{className:"text-red-500 text-xl",children:""})," ",_r(t.like)]}),o.jsx("p",{className:"line-clamp-2",children:t.description}),o.jsx(cX,{})]})})]})})}function pX(){const{songs:t}=Xs(),{isFetching:e}=qu();return o.jsxs(o.Fragment,{children:[o.jsx(be,{title:"Songs"}),o.jsx(ms,{children:e?o.jsx(le,{className:"h-[100px]"}):o.jsx(ea,{colList:["Name","Singer"],children:t.length?t.map((n,r)=>o.jsxs("tr",{className:"hover:bg-black/10",children:[o.jsx("td",{children:o.jsx(we,{to:`/dashboard/song/${n.id}/edit`,children:n.name})}),o.jsx("td",{children:n.singers.map((s,i)=>o.jsx(we,{to:`/dashboard/singer/${s.id}`,className:"hover:text-green-500 hover:underline",children:(i?", ":"")+s.name},i))})]},r)):o.jsx("tr",{children:o.jsx("td",{colSpan:2,children:o.jsx(Ke,{})})})})})]})}function gX(){const{playlists:t}=Xs(),{isFetching:e}=qu();return o.jsxs(o.Fragment,{children:[o.jsx(be,{title:"Playlists"}),e&&o.jsx(le,{className:"h-[100px]"}),!e&&o.jsx(ea,{colList:["Name",""],children:t.length?t.map((n,r)=>o.jsxs("tr",{className:"hover:bg-black/10",children:[o.jsx("td",{children:o.jsx(we,{to:`/dashboard/playlist/${n.id}`,children:n.name})}),o.jsx("td",{children:"-"})]},r)):o.jsx("tr",{children:o.jsx("td",{colSpan:2,children:o.jsx(Ke,{})})})})]})}function xX(){const[t,e]=m.useState(),[n,r]=m.useState([]),[s,i]=m.useState(),[a,l]=m.useState(),[c,u]=m.useState();return{singer:t,setSinger:e,songs:n,setSongs:r,updateAlbumData:f=>{s&&i({...s,...f})},albumData:s,imageFile:a,setImageFile:l,setAlbumData:i,album:c,setAlbum:u}}const XA=m.createContext(null);function yX({children:t}){return o.jsx(XA.Provider,{value:xX(),children:t})}function Tl(){const t=m.useContext(XA);if(!t)throw new Error("AddAlbumProvider not provided");return t}function vX(t){const{imageFile:e,updateAlbumData:n,setSinger:r,albumData:s,setSongs:i,album:a,singer:l,songs:c,setAlbum:u,setImageFile:d,setAlbumData:f}=Tl(),{setSuccessToast:p,setErrorToast:g}=ge(),[v,_]=m.useState(!1),b=m.useRef(!1),E=m.useMemo(()=>t.variant==="add"?!0:!a||!s||!l?!1:s.name!==a.name||l.id!==a.singers[0].id||s.like!==a.like||!!c.find(D=>!a.song_ids.includes(D.id)),[s,a,l,c]),w=!!e,S=m.useMemo(()=>{const D=!!E&&!!s&&!!s.name&&!!l&&!!c.length;return t.variant==="add"?D:D||w},[w,E,s,l,c]),I=async()=>{try{if(!s||!l)return;if(_(!0),e){const D=await Ji({imageFile:e});Object.assign(s,D)}switch(s.singers=[l],s.singer_map={[l.id]:!0},s.song_ids=c.map(D=>D.id),t.variant){case"add":{const D=await Qs({collectionName:"Playlists",data:s}),C=await $a(D),k={...C.data(),id:C.id};t.callback(k),p("Album created");break}case"edit":{if(!a)return;await kt({collectionName:"Playlists",data:s,id:a.id}),u({...a,...s}),p("Album edited");break}}}catch(D){console.log(D),g()}finally{_(!1),d(void 0)}},F=async()=>{switch(t.variant){case"add":f(oE({owner_email:t.user.email,distributor:t.user.email})),r(t.singer);break;case"edit":const{id:D,song_ids:C,singers:k,...R}=t.album;if(C){const j=_e(Nn,X(Zs(),"in",C)),N=await Pn(j);i(N)}u(t.album),r(k[0]),f(oE({...R,song_ids:C,singers:k}));break}};return m.useEffect(()=>{b.current||(b.current=!0,F())},[]),m.useEffect(()=>{e&&n({image_url:URL.createObjectURL(e)})},[e]),{submit:I,isFetching:v,isValidToSubmit:S}}function wX(){const{singer:t,setSinger:e,albumData:n,updateAlbumData:r}=Tl(),s=m.useRef(null),i=a=>{var l;e(a),(l=s.current)==null||l.close()};if(n)return o.jsxs(o.Fragment,{children:[o.jsxs(yn,{className:"space-y-2.5",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-lg",htmlFor:"name",children:"Name"}),o.jsx(Ht,{type:"text",placeholder:"name...",id:"name",className:"text-[#333]",value:n.name,onChange:a=>r({name:a.target.value})})]}),o.jsxs("div",{className:"flex items-center space-x-1.5",children:[o.jsx("p",{className:"text-lg",children:"Singer"}),t?o.jsxs(El,{className:"mt-0",children:[o.jsx("span",{children:t.name}),o.jsx("div",{children:o.jsx("button",{onClick:()=>e(void 0),children:o.jsx(Dn,{className:"w-5"})})})]}):o.jsx(ue,{size:"clear",className:"p-1.5",onClick:()=>{var a;return(a=s.current)==null?void 0:a.open()},children:o.jsx(br,{className:"w-5"})})]})]}),o.jsx(kr,{ref:s,children:o.jsx(Fw,{choose:i,closeModal:()=>{var a;return(a=s.current)==null?void 0:a.close()}})})]})}function _X(){const{songs:t,setSongs:e}=Tl(),n=m.useRef(null),r=i=>{const a=t.map(c=>c.id),l=i.filter(c=>!a.includes(c.id));e([...t,...l])},s=i=>{const a=t.filter(l=>l.id!==i.id);e(a)};return o.jsxs(o.Fragment,{children:[o.jsxs(ea,{colList:["Name","Singer","Like"," "],children:[t.map((i,a)=>o.jsxs("tr",{children:[o.jsx("td",{children:o.jsx("span",{children:i.name})}),o.jsx("td",{children:i.singers.map((l,c)=>o.jsxs("span",{className:"hover:underline",children:[!!c&&", ",l.name]},c))}),o.jsx("td",{children:o.jsx("span",{children:_r(i.like)})}),o.jsx("td",{children:o.jsx(ue,{onClick:()=>s(i),size:"clear",className:"p-1",children:o.jsx(Dn,{className:"w-5"})})})]},a)),o.jsx("tr",{className:"!bg-white border-none",children:o.jsx("td",{colSpan:3,children:o.jsx("p",{className:"text-center",children:o.jsxs(ue,{onClick:()=>{var i;return(i=n.current)==null?void 0:i.open()},children:[o.jsx(br,{className:"w-6"}),o.jsx("span",{children:"Add song"})]})})})})]}),o.jsx(kr,{wrapped:!1,variant:"animation",ref:n,children:o.jsx(GA,{submit:r,closeModal:()=>{var i;return(i=n.current)==null?void 0:i.close()},isLoading:!1})})]})}function bX(){const{album:t}=Tl(),e=m.useRef(null),n=qt(),r=async()=>{try{if(!t)return;await Promise.all([Vu({collectionName:"Playlists",id:t.id}),t.image_file_path?An({filePath:t.image_file_path}):()=>{}]),n("/dashboard/album")}catch{}};return o.jsxs(o.Fragment,{children:[o.jsxs(ue,{size:"clear",onClick:()=>{var s;return(s=e.current)==null?void 0:s.open()},children:[o.jsx(Dn,{className:"w-6"}),o.jsx("span",{children:"Delete"})]}),o.jsx(Fe,{variant:"animation",ref:e,wrapped:!1,children:o.jsx(si,{children:o.jsx(gs,{label:`Delete album ' ${t==null?void 0:t.name} '`,close:()=>{var s;return(s=e.current)==null?void 0:s.close()},callback:r,loading:!1})})})]})}function SX({closeModal:t}){const{albumData:e,singer:n,setSinger:r,updateAlbumData:s}=Tl();if(!e||!n)throw new Error("albumData or singer is undefined");const[i,a]=m.useState(e),[l,c]=m.useState(n),u=m.useRef(null),d=m.useMemo(()=>i.name!==e.name||i.like!==e.like||l!==n,[i,l]),f=m.useMemo(()=>!!(i!=null&&i.name)&&!!l&&d,[d]),p=_=>{a({...i,..._})},g=_=>{var b;c(_),(b=u.current)==null||b.close()},v=()=>{r(l),s(i),t()};if(i)return o.jsxs(o.Fragment,{children:[o.jsxs(Er,{children:[o.jsx(Ct,{close:t,title:"Edit album"}),o.jsx("div",{className:"flex-grow overflow-auto",children:o.jsxs("div",{className:"flex-grow flex flex-col mt-3  space-y-2.5 md:mt-0 md:ml-3",children:[o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{htmlFor:"name",className:"opacity-[.8]",children:"Album name:"}),o.jsx(Ht,{type:"text",id:"name",placeholder:"",className:"bg-[#f1f1f1]",value:i.name,onChange:_=>p({name:_.target.value})})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{htmlFor:"description",className:"opacity-[.8]",children:"Singer:"}),o.jsx("div",{className:"-mt-2 -ml-2",children:o.jsxs(El,{className:"mt-0 w-fit",children:[o.jsx("span",{children:l.name}),o.jsx("div",{children:o.jsx("button",{onClick:()=>{var _;return(_=u.current)==null?void 0:_.open()},children:o.jsx(at,{className:"w-5"})})})]})})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{htmlFor:"like",className:"opacity-[.8]",children:"Like:"}),o.jsx(Ht,{id:"like",className:"bg-[#f1f1f1]",type:"number",value:i.like+"",onChange:_=>p({like:+_.target.value})})]})]})}),o.jsx("p",{className:"text-right mt-3",children:o.jsx(ue,{color:"primary",onClick:v,disabled:!f,className:"font-playwriteCU rounded-full",children:"Save"})})]}),o.jsx(kr,{ref:u,children:o.jsx(Fw,{choose:g,closeModal:()=>{var _;return(_=u.current)==null?void 0:_.close()}})})]})}function EX(){const t=m.useRef(null);return o.jsxs(o.Fragment,{children:[o.jsxs(ue,{onClick:()=>{var e;return(e=t.current)==null?void 0:e.open()},children:[o.jsx(Ys,{className:"w-6"}),o.jsx("span",{children:"Edit"})]}),o.jsx(kr,{ref:t,children:o.jsx(SX,{closeModal:()=>{var e;return(e=t.current)==null?void 0:e.close()}})})]})}function kX({className:t="",...e}){const{theme:n}=q(),{albumData:r,singer:s,setImageFile:i}=Tl(),{submit:a,isFetching:l,isValidToSubmit:c}=vX(e),u=f=>{var p;(p=f.target.files)!=null&&p.length&&i(f.target.files[0])},d=o.jsxs(Gw,{children:[o.jsx(ue,{className:`${n.content_bg} !p-0`,size:"clear",children:o.jsxs("label",{htmlFor:"image_upload",className:"md:px-3 p-1.5 inline-flex space-x-1 cursor-pointer ",children:[o.jsx(hl,{className:"w-6"}),o.jsx("span",{children:"Change image"})]})}),e.variant==="edit"&&o.jsxs(o.Fragment,{children:[o.jsx(EX,{}),o.jsx(bX,{})]})]});return r?o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:`md:flex ${t}`,children:[o.jsxs("div",{className:"space-y-2.5",children:[o.jsx("div",{className:"w-[200px] mx-auto h-[200px] rounded-lg overflow-hidden",children:o.jsx(Xe,{className:"object-cover object-center h-full",blurHashEncode:r.blurhash_encode,src:r.image_url})}),o.jsx("input",{onChange:u,type:"file",multiple:!0,accept:"image/png, image/jpeg",id:"image_upload",className:"hidden"}),e.variant==="add"&&o.jsx("div",{children:d}),e.variant==="edit"&&o.jsx(o.Fragment,{children:o.jsxs("div",{children:[o.jsx(be,{title:r.name}),o.jsxs(yn,{className:"text-[#333]",children:[o.jsx("p",{className:"text-xl",children:s==null?void 0:s.name}),o.jsxs("p",{children:[r.song_ids.length," songs"]}),o.jsxs("p",{className:"mt-1 font-[500]",children:[o.jsx("span",{className:"text-red-500 text-xl",children:""})," ",_r(r.like)]})]}),o.jsx("div",{className:"mt-3",children:d})]})})]}),o.jsxs("div",{className:"mt-3 md:w-3/4 md:mt-0 md:ml-3 flex-grow flex flex-col space-y-2.5",children:[e.variant==="add"&&o.jsx(wX,{}),o.jsxs("div",{children:[e.variant==="add"&&o.jsx("p",{className:"text-lg mb-1",children:"Songs"}),e.variant==="edit"&&o.jsx(be,{title:"Songs"}),o.jsx(_X,{})]})]})]}),o.jsx("p",{className:"text-right mt-5",children:o.jsx(ue,{loading:l,color:"primary",onClick:a,disabled:!c,className:"font-playwriteCU rounded-full",children:"Save"})})]}):o.jsx(o.Fragment,{})}function Qw(t){return o.jsx(yX,{children:o.jsx(kX,{...t})})}function TX(){const{user:t}=he(),{singer:e,setAlbums:n}=Xs(),r=m.useRef(null),s=i=>{n(a=>[i,...a])};return o.jsxs(o.Fragment,{children:[o.jsxs(ue,{onClick:()=>{var i;return(i=r.current)==null?void 0:i.open()},className:"px-3 py-1",size:"clear",children:[o.jsx(br,{className:"w-5"}),o.jsx("span",{children:"Add album"})]}),o.jsx(kr,{ref:r,children:o.jsx(Er,{className:"w-[700px] flex flex-col",children:t&&e&&o.jsxs(o.Fragment,{children:[o.jsx(Ct,{title:"Add album",close:()=>{var i;return(i=r.current)==null?void 0:i.close()}}),o.jsx(Qw,{className:"flex-grow overflow-auto no-scrollbar md:overflow-hidden",variant:"add",singer:e,callback:s,user:t})]})})})]})}function IX(){const{albums:t}=Xs(),{isFetching:e}=qu();return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx(be,{title:"Albums"}),o.jsx(TX,{})]}),e&&o.jsx(le,{className:"h-[100px]"}),!e&&o.jsx(ea,{colList:["Name",""],children:t.length?t.map((n,r)=>o.jsxs("tr",{className:"hover:bg-black/10",children:[o.jsx("td",{children:o.jsx(we,{to:`/dashboard/album/${n.id}`,children:n.name})}),o.jsx("td",{children:"-"})]},r)):o.jsx("tr",{children:o.jsx("td",{colSpan:2,children:o.jsx(Ke,{})})})})]})}function CX(){return o.jsx(o.Fragment,{children:o.jsxs("div",{className:"pb-[46px] space-y-3",children:[o.jsx(mX,{}),o.jsx(IX,{}),o.jsx(pX,{}),o.jsx(gX,{})]})})}function jX(){return o.jsx(fX,{children:o.jsx(CX,{})})}function RX({setAlbums:t}){const{user:e}=he(),n=m.useRef(null),r=()=>{var i;return(i=n.current)==null?void 0:i.close()},s=i=>{t(a=>[i,...a]),r()};if(e)return o.jsxs(o.Fragment,{children:[o.jsxs(ue,{onClick:()=>{var i;return(i=n.current)==null?void 0:i.open()},className:"self-start p-1.5 ml-5",size:"clear",children:[o.jsx(ps,{className:"w-6"}),o.jsx("div",{className:"hidden md:block",children:"Add new album"})]}),o.jsx(Fe,{wrapped:!1,ref:n,variant:"animation",children:o.jsxs(si,{className:"w-[800px]",children:[o.jsx(be,{title:"Add album"}),o.jsx(Qw,{className:"overflow-auto",variant:"add",user:e,callback:s})]})})]})}const AX=["All","Result"];function NX(){const[t,e]=m.useState([]),[n,r]=m.useState(""),[s,i]=m.useState(!0),[a,l]=m.useState("All"),{setErrorToast:c}=ge(),u=async f=>{try{f.preventDefault(),i(!0);const p=_e(wr,X("is_album","==",!0),X("name",">=",n),X("name","<=",n+"")),g=await Vr(p);e(g),l("Result")}catch(p){console.log({message:p}),c()}finally{i(!1)}},d=async()=>{try{i(!0);const f=_e(wr,X("is_album","==",!0),hs("created_at","desc")),p=await Vr(f);e(p)}catch(f){console.log({message:f}),c()}finally{i(!1)}};return m.useEffect(()=>{a==="All"&&d()},[a]),{isFetching:s,value:n,setValue:r,handleSubmit:u,albums:t,tab:a,setTab:l,tabs:AX,setAlbums:e}}function PX(){const{isFetching:t,albums:e,tab:n,tabs:r,setTab:s,setAlbums:i,...a}=NX();return o.jsxs("div",{className:"pb-[46px]",children:[o.jsx(be,{title:"Albums"}),o.jsxs("div",{className:"flex justify-between mt-3",children:[o.jsx(kl,{...a}),o.jsx(RX,{setAlbums:i})]}),o.jsx("div",{className:`mt-5 w-fit ${n==="All"?"pointer-events-none":""} self-start`,children:o.jsx(xs,{tabs:r,render:l=>l,tab:n,setTab:s})}),o.jsxs("div",{className:"mt-3",children:[t&&o.jsx(le,{className:"h-[200px] rounded-xl"}),!t&&o.jsx(ea,{colList:["Name","Singer","Like"],children:e.length?e.map((l,c)=>o.jsxs("tr",{children:[o.jsx("td",{children:o.jsx(we,{className:"hover:underline",to:`/dashboard/album/${l.id}`,children:l.name})}),o.jsx("td",{children:o.jsx(we,{to:`/dashboard/singer/${l.singers[0].id}`,children:l.singers[0].name})}),o.jsx("td",{children:_r(l.like)})]},c)):o.jsx("tr",{children:o.jsx("td",{colSpan:4,children:o.jsx(Ke,{})})})})]})]})}function e2({children:t}){return o.jsx(Tq,{children:t})}function FX({children:t}){return o.jsx(yq,{children:t})}function DX(){const[t,e]=m.useState(!0),[n,r]=m.useState(),s=m.useRef(!1),i=qi(),a=qt(),{setErrorToast:l}=ge(),c=async()=>{try{if(!i.id)return;const u=await Ur({collectionName:"Playlists",id:i.id});if(!u.exists())return a("/dashboard/album");const d={...u.data(),id:u.id};if(!d.is_album)return a(`/dashboard/playlist/${d.id}`);r(d)}catch(u){console.log(u),l()}finally{e(!1)}};return m.useEffect(()=>{s.current||(s.current=!0,c())},[]),{album:n,isFetching:t}}function LX(){const{album:t,isFetching:e}=DX();return e?o.jsx(an,{children:o.jsx(at,{className:"w-6 animate-spin"})}):t?o.jsxs("div",{className:"pb-[46px]",children:[o.jsx(be,{title:"Edit album",className:"mb-3"}),o.jsx(Qw,{variant:"edit",album:t})]}):o.jsx(o.Fragment,{})}const uo={home:"/",search:"/search",playlist:"/playlist/:id",login:"/login",unauthorized:"/unauthorized",singer:"/singer/:id",user:"/user/:id"},t2={myMusic:"/my-music",songLyric:"/my-music/lyric/:id"},lr={dashboard:"/dashboard",genre:"/dashboard/genre",playlist:"/dashboard/playlist",song:"/dashboard/song",addSong:"/dashboard/song/add-song",editSong:"/dashboard/song/:songId/edit",playlistDetail:"/dashboard/playlist/:id",songLyric:"/dashboard/lyric/:id",singer:"/dashboard/singer",editSinger:"/dashboard/singer/:id",album:"/dashboard/album",editAlbum:"/dashboard/album/:id"},MX=[{path:uo.home,component:NH,layout:""},{path:uo.playlist,component:GH,layout:""},{path:uo.search,component:HW,layout:""},{path:uo.unauthorized,component:qW,layout:""},{path:uo.singer,component:lq,layout:""},{path:uo.user,component:uq,layout:""}],OX=[{path:t2.myMusic,component:tW,layout:""},{path:t2.songLyric,component:BW,layout:""}],$X=[{path:lr.dashboard,component:dq,layout:""},{path:lr.playlist,component:WK,layout:""},{path:lr.genre,component:aX,layout:""},{path:lr.singer,component:rX,layout:db},{path:lr.editSinger,component:jX,layout:db},{path:lr.playlistDetail,component:JK,layout:FX},{path:lr.album,component:PX,layout:""},{path:lr.editAlbum,component:LX,layout:""},{path:lr.song,component:Eq,layout:""},{path:lr.addSong,component:$K,layout:e2},{path:lr.editSong,component:zK,layout:e2},{path:lr.songLyric,component:oX,layout:""}],YA="/HD-MP3/assets/loading-b1210647.gif";function BX(){const{user:t,loading:e}=he(),{theme:n}=q();return e?o.jsx("div",{className:`min-h-screen flex flex-col items-center justify-center ${n.container}`,children:o.jsx("img",{className:"w-[150px]",src:YA,alt:""})}):t?o.jsx(Xf,{}):o.jsx(TT,{state:{from:"/my-music"},replace:!0,to:"/login"})}function zX(){const[t,e]=m.useState(!0),[n,r]=m.useState(!1),{user:s,loading:i}=he(),{theme:a}=q();return m.useEffect(()=>{(async()=>{await zs(1e3),r(!0),e(!1)})()},[]),i||t?o.jsx("div",{className:`min-h-screen flex flex-col items-center justify-center ${a.container}`,children:o.jsx("img",{className:"w-[150px]",src:YA,alt:""})}):s&&n?o.jsx(Xf,{}):o.jsx(TT,{replace:!0,to:"/unauthorized"})}const JA=[{path:"/dashboard",title:"Dashboard",icon:o.jsx(Wy,{className:"w-5 flex-shrink-0"})},{path:"/dashboard/song",title:"Songs",icon:o.jsx(Ka,{className:"w-5 flex-shrink-0"})},{path:"/dashboard/playlist",title:"Playlists",icon:o.jsx(RL,{className:"w-5 flex-shrink-0"})},{path:"/dashboard/album",title:"Albums",icon:o.jsx(uL,{className:"w-5 flex-shrink-0"})},{path:"/dashboard/singer",title:"Singers",icon:o.jsx(yM,{className:"w-5 flex-shrink-0"})},{path:"/dashboard/genre",title:"Genres",icon:o.jsx(rM,{className:"w-5 flex-shrink-0"})}];function UX(){const{theme:t}=q(),[e,n]=m.useState(!1),r=rr(),s="",i={container:"hidden md:block bg-[#f1f1f1] text-[#333] border-r border-black/10 transition-[width] relative flex-shrink-0",head:"h-[60px] flex items-center justify-center",logoText:"text-[22px] font-[500] whitespace-nowrap tracking-[-1px]",logoImage:"max-w-[50px] p-[4px]",item:"flex whitespace-nowrap space-x-2 items-center justify-center p-2.5 ",itemActive:"text-[#cd1818] bg-[#f1f1f1]",icon:"w-[24px] flex-shrink-0"};return o.jsxs("div",{className:`${i.container} ${e?"w-[150px]":"w-[70px]"}`,children:[o.jsxs("div",{className:"md:mt-[60px]",children:[JA.map((a,l)=>{const c=r.pathname===a.path;return o.jsxs(we,{className:`
              ${c?t.content_bg:"hover:bg-black/10"}
              ${i.item} ${e?"!justify-start":""}
              ${s===a.path?i.itemActive:""}`,to:a.path,children:[a.icon,e&&o.jsx("span",{children:a.title})]},l)}),o.jsxs(we,{to:"/",target:"_blank",className:`${i.item} ${e?"!justify-start":""}
               
               `,children:[o.jsx(lm,{className:i.icon}),e&&o.jsx("span",{children:"Home"})]})]}),o.jsx(ue,{onClick:()=>n(a=>!a),size:"clear",className:"!absolute p-1.5 bottom-5 right-0 translate-x-[50%]",children:e?o.jsx(GV,{className:"w-5 "}):o.jsx(XV,{className:"w-5"})})]})}function ZA({className:t=""}){const{behind:e,ahead:n,backward:r,forward:s}=nA();return o.jsxs("div",{className:`"flex space-x-3 [&>button]:p-1 ${t}`,children:[o.jsx("button",{onClick:r,className:`relative ${qc(!e.length)}`,children:o.jsx(xI,{className:"w-5"})}),o.jsx("button",{onClick:s,className:`relative ${qc(!n.length)}`,children:o.jsx(ID,{className:"w-5"})})]})}function VX(){const{theme:t}=q(),[e,n]=m.useState(0),[r,s]=m.useState(""),i=m.useRef(null),a=m.useRef(null),l=f=>{var p,g;s(f),(p=a.current)==null||p.close(),(g=i.current)==null||g.open()},c=()=>{var f;return(f=i.current)==null?void 0:f.close()},u=f=>{const p=f.target.scrollTop||0;n(p)},d=()=>{switch(r){case"":return o.jsx(o.Fragment,{});case"theme":return o.jsx(ev,{close:c});case"info":return o.jsx(Zy,{close:c})}};return m.useEffect(()=>{const f=document.querySelector(".main-container");return f==null||f.addEventListener("scroll",u),()=>{f==null||f.removeEventListener("scroll",u)}},[]),o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:`hidden md:flex px-[40px] z-[99] h-[60px] flex-shrink-0 items-center justify-between ${e?" shadow-lg":""}`,children:[o.jsxs("div",{className:"flex",children:[o.jsxs(we,{to:"/dashboard",className:"text-xl font-[500]",children:["HD",o.jsx("span",{className:`${t.content_text} ml-[4px] uppercase`,children:"Dashboard"})]}),o.jsx(ZA,{className:"ml-5"})]}),o.jsx("div",{className:"flex",children:o.jsxs(pr,{children:[o.jsx(gr,{ref:a,children:o.jsx("button",{className:`flex p-2 items-center rounded-full bg-${t.alpha} ${t.content_hover_bg}`,children:o.jsx(_u,{className:"w-6"})})}),o.jsx(xr,{appendTo:"parent",className:"top-[calc(100%+8px)] right-0",animationClassName:"origin-top-right",children:o.jsx(MI,{openModal:l,variant:"dashboard"})})]})})]}),o.jsx(Fe,{ref:i,variant:"animation",children:d()})]})}function HX(){const[t,e]=m.useState(!1),n=m.useRef(null),r=s=>{var i;(i=n.current)!=null&&i.contains(s.target)||e(!1)};return m.useEffect(()=>(t&&window.addEventListener("click",r),()=>{window.removeEventListener("click",r)}),[t]),o.jsxs(o.Fragment,{children:[o.jsx(yn,{colors:"third",className:`absolute z-[99] duration-[.25] flex flex-col
        transition-[left,opacity] bottom-[80px] 
        ${t?"left-[10px] opacity-[1] pointer-events-auto":"left-0 opacity-[0] pointer-events-none"}`,children:JA.map((s,i)=>o.jsxs(we,{className:"inline-flex py-1.5 space-x-1",to:s.path,children:[s.icon,o.jsx("span",{children:s.title})]},i))}),o.jsx(ue,{ref:n,size:"clear",onClick:()=>e(!t),className:"!absolute transition-[left] bottom-[10px] left-[10px]  p-1.5",children:o.jsx(ul,{className:"w-6"})})]})}function WX({className:t="",toast:e,onClick:n}){const{theme:r}=q(),[s,i]=m.useState(!1),a={icon:"w-6",container:`transition-[transform,opacity] text-white px-3 py-1 space-x-1 rounded-md flex items-center ${r.modal_bg}`,text:"font-[500] text-sm",open:"opacity-[1] translate-x-0",init:"opacity-0 translate-x-10"},l=()=>{switch(e.variant){case"success":return o.jsx(Yy,{className:`${a.icon} text-emerald-500`});case"error":return o.jsx(Jy,{className:`${a.icon} text-red-500`})}};return m.useEffect(()=>{setTimeout(()=>{i(!0)},0)},[]),o.jsxs("div",{onClick:()=>n?n(e.id):void 0,className:`${a.container} ${t} ${s?a.open:a.init} `,children:[l(),o.jsx("p",{className:a.text,children:e.desc})]})}const eN=({time:t=6e3,className:e=""})=>{const{setToasts:n,toasts:r}=ge(),[s,i]=m.useState(""),a=l=>{n(c=>c.filter(u=>u.id!=l))};return m.useEffect(()=>{s&&n(l=>l.filter(c=>c.id!=s))},[s]),m.useEffect(()=>{if(!r.length)return;const l=r[r.length-1].id;setTimeout(()=>{i(l)},t)},[r]),o.jsx(o.Fragment,{children:Ga.createPortal(o.jsx("div",{className:`fixed z-[199] ${e}`,children:o.jsx("div",{className:"flex flex-col gap-[10px]",children:!!r.length&&r.map((l,c)=>o.jsx(WX,{onClick:a,toast:l},c))})}),document.getElementById("portals"))})};function qX(){const{setTheme:t,isOnMobile:e,theme:n}=q();return m.useEffect(()=>{t(h3)},[]),o.jsx(o.Fragment,{children:o.jsx(cI,{children:o.jsx(Cq,{children:o.jsxs("div",{className:`${n.container} fixed inset-full flex ${n.text_color}`,children:[e?o.jsx(HX,{}):o.jsx(UX,{}),o.jsxs("div",{className:"flex flex-col flex-grow",children:[o.jsx(VX,{}),o.jsx("div",{className:"main-container flex flex-col flex-grow overflow-auto p-[10px] md:px-[40px] md:pt-0",children:o.jsx(Xf,{})})]}),o.jsx(eN,{className:"left-[50%] translate-x-[-50%] top-[10px] md:top-[unset] md:bottom-[60px] md:left-[20px] md:translate-x-0"}),o.jsx(lI,{})]})})})})}const tN="USRKy:SK%|R*}@r@MxoeY$kWmnafBUR*oybu";function GX({variant:t="desktop"}){const{desktopTabs:e,activeTab:n,setActiveTab:r,mobileActiveTab:s,mobileTabs:i,setMobileActiveTab:a,idle:l}=et(),c=t==="desktop"?n:s,u=t==="desktop"?r:a,d=t==="desktop"?e:i,f={item:"px-3 md:px-8 leading-[30px] font-[600] cursor-pointer  rounded-full",fadeTransition:"opacity-0 transition-opacity duration-[.3s]"};return o.jsx("ul",{className:`inline-flex mx-auto rounded-full space-x-1 bg-white/10 p-1 ${l?f.fadeTransition:""}`,children:d.map((p,g)=>{const v=p===c;return o.jsx("li",{onClick:()=>u(p),className:`${f.item} ${v?"bg-white/20":"hover:bg-white/5"}`,children:p},g)})})}function QX({themeType:t,children:e}){const{theme:n}=q(),{isOpenComment:r,setIsOpenComment:s}=Wr(),i=t==="dark"?"bg-[#1f1f1f]":n.container,a={mainContainer:`hidden fixed w-[400px] md:flex flex-col bottom-0 right-[0] top-0 z-[99] p-3 pb-5 text-white border-l-[1px] border-${n.alpha} transition-[transform] duration-[.5s] linear delay-100`};return o.jsxs("div",{className:`${n.text_color} ${a.mainContainer} ${r?"translate-x-0---":"translate-x-full"}     `,children:[o.jsx("div",{className:`bg-opacity-[0.8] backdrop-blur-[15px] z-[-1] ${i} absolute inset-0`}),o.jsx("p",{children:o.jsx("button",{className:"p-1.5",onClick:()=>s(!1),children:o.jsx(Jy,{className:"w-7"})})}),e]})}function KX(){const{shouldFetchComment:t,setComments:e,isOpenComment:n,setIsFetching:r}=Wr(),{currentSongData:s}=se($e),{fetchComment:i}=Rw(),a=async()=>{try{if(!(s!=null&&s.song))return;const l=await i({target_id:s.song.id});e(l||[])}catch(l){console.log({error:l})}finally{r(!1)}};m.useEffect(()=>{!n||!(s!=null&&s.song)||t.current&&(t.current=!1,a())},[n]),m.useEffect(()=>()=>{t.current||(t.current=!0)},[s==null?void 0:s.song])}function nN(){const{isFetching:t,comments:e}=Wr();return KX(),t?o.jsx(an,{children:o.jsx(at,{className:"w-6 animate-spin"})}):o.jsx(tA,{comments:e})}function XX(){const{theme:t}=q(),{setIsOpenComment:e}=Wr(),n={button:`w-[38px] h-[38px] bg-white/10 rounded-[99px] transition-transform ${t.content_hover_bg}`};return o.jsxs(o.Fragment,{children:[o.jsx(ls,{position:"top-[calc(100%+8px)]",content:"Comment",children:o.jsx("button",{onClick:()=>e(!0),className:`p-2 ${n.button}`,children:o.jsx(Uy,{})})}),Ga.createPortal(o.jsx(QX,{themeType:"dark",children:o.jsx(nN,{})}),document.getElementById("portals"))]})}function YX(){const{user:t}=he(),{theme:e}=q(),{activeTab:n,idle:r,setIsOpenFullScreen:s}=et(),{currentSongData:i}=se($e),a=qt(),l=i&&t?i.song.owner_email===t.email&&i.song.is_official===!1:!1,c=()=>{i!=null&&i.song&&(s(!1),setTimeout(()=>{a(`/my-music/lyric/${i==null?void 0:i.song.id}`)},300))},u={button:`w-[38px] h-[38px] bg-white/10 rounded-[99px] transition-transform ${e.content_hover_bg}`,headerWrapper:"relative flex py-[25px] px-[40px] w-full items-center",fadeTransition:"opacity-0 transition-opacity duration-[.3s]"};return o.jsx(o.Fragment,{children:o.jsxs("div",{className:`${u.headerWrapper} ${r?"pointer-events-none":""}`,children:[r&&i&&o.jsx("div",{className:"absolute left-4",children:n!=="Songs"&&o.jsxs(o.Fragment,{children:[o.jsx("p",{className:"font-playwriteCU text-sm",children:i.song.name}),o.jsx("p",{className:"opacity-70 text-sm",children:i.song.singers.map((d,f)=>(f?", ":"")+d.name)})]})}),o.jsx(GX,{}),o.jsxs("div",{className:`absolute flex right-4 space-x-3 ${r&&u.fadeTransition}`,children:[o.jsx(jw,{target:"song",children:o.jsx(XX,{})}),l&&n==="Lyric"&&o.jsx(ls,{position:"top-[calc(100%+8px)]",content:"Edit lyric",children:o.jsx("button",{onClick:()=>c(),className:`p-2 ${u.button}`,children:o.jsx(qy,{})})}),o.jsxs(pr,{children:[o.jsx(gr,{children:o.jsx(ls,{position:"top-[calc(100%+8px)]",content:"Setting",children:o.jsx("button",{className:`${u.button} p-2`,children:o.jsx(Hy,{})})})}),o.jsx(xr,{appendTo:"parent",className:"top-[calc(100%+8px)] right-0 z-[99]",animationClassName:"origin-top-right",children:o.jsx(eC,{})})]}),o.jsx(ls,{position:"top-[calc(100%+8px)]",content:"Close",children:o.jsx("button",{onClick:()=>s(!1),className:`p-2 ${u.button}`,children:o.jsx(wI,{})})})]})]})})}const Wd=.3;function JX({active:t}){const{audioRef:e}=et();if(!e.current)throw new Error("useSongLyric !audioRef.current");const[n,r]=m.useState(0),s=m.useRef("instant"),i=m.useRef(null),a=m.useRef(0),l=m.useRef([]),c=m.useRef(0),{loading:u,songLyrics:d}=VR({active:t}),f=()=>{const p=e.current.currentTime>a.current?"forward":"backward";a.current=e.current.currentTime;let g=c.current;switch(p){case"forward":for(;d[g+1]&&d[g+1].start-Wd<a.current+Wd;)g+=1;break;case"backward":for(;d[g-1]&&d[g-1].end-Wd>a.current+Wd;)g-=1;break}g!==c.current&&(Math.abs(g-c.current)>5&&(s.current="instant"),c.current=g,r(g),rI(l.current[g],s.current),s.current==="instant"&&(s.current="smooth"))};return m.useEffect(()=>{f()},[t]),m.useEffect(()=>{if(!(!t||!d.length))return e.current.addEventListener("timeupdate",f),()=>{e.current.removeEventListener("timeupdate",f)}},[t,d]),m.useEffect(()=>()=>{r(0),c.current=0},[d]),{songLyrics:d,loading:u,currentIndex:n,containerRef:i,lyricRefs:l,scrollBehavior:s}}function rN({className:t,active:e}){const{playerConig:{lyricSize:n}}=et(),{loading:r,songLyrics:s,currentIndex:i,containerRef:a,lyricRefs:l}=JX({active:e}),c={small:"text-[16px] sm:text-[26px]",medium:"text-[20px] sm:text-[30px]",large:"text-[26px] sm:text-[46px]"},u=()=>s.map((f,p)=>{let g="coming";return i===p?g="active":p<i&&(g="done"),o.jsx(aA,{ref:v=>l.current[p]=v,status:g,text:f.text,activeColor:"scale-[1.3]",className:"leading-[1.3] mb-3 w-[70%] md:mb-5 last:mb-[50vh]"},p)}),d={container:"no-scrollbar pt-[20px] mask-image overflow-y-auto overflow-x-hidden"};return o.jsxs("div",{ref:a,className:`${d.container} ${c[n||"medium"]} ${t}`,children:[r&&o.jsx("div",{className:"relative w-full h-full",children:o.jsx(an,{children:o.jsx(at,{className:"w-7 animate-spin"})})}),!r&&o.jsx(o.Fragment,{children:s.length?u():o.jsx("div",{className:"relative w-full h-full",children:o.jsx(an,{children:o.jsx("h1",{className:"text-[30px] opacity-60",children:"..."})})})})]})}const ec=.3,n2=t=>t%2!==0;function ZX({active:t}){const{audioRef:e}=et();if(!e.current)throw new Error("useKaraoke !audioRef.current");const[n,r]=m.useState(0),s=m.useRef(null),i=m.useRef(null),a=m.useRef(null),l=m.useRef(null),c=m.useRef(0),u=m.useRef(0),d=m.useRef("paused"),f=m.useRef(!1),{songLyrics:p,loading:g,playStatus:v}=VR({active:t}),_=m.useMemo(()=>{if(p.length){if(n<0)return{odd:"",even:""};const S=n2(n);if(!p[n+1])return{odd:"",even:""};const I=S?[n,n+1]:[n+1,n],F=p[I[0]].text.trim(),D=p[I[1]].text.trim();return{odd:F,even:D}}else return{odd:"",even:""}},[n,p]),b=S=>{S.style.animation="none"},E=(S,I,F,D)=>{var R,j;let C="running";d.current==="paused"&&(C="paused"),F.style.animation=`${S} ${(((R=I==null?void 0:I.tune)==null?void 0:R.end)||I.end)-(((j=I==null?void 0:I.tune)==null?void 0:j.start)||I.start)}s linear ${C} forwards`;const k=+D.toFixed(1);Math.abs(k)>.2&&(F.style.animationDelay=`${k}s`)},w=()=>{if(!p.length)return;const S=e.current.currentTime>=c.current?"forward":"backward";c.current=e.current.currentTime;let I=u.current;switch(S){case"forward":for(;I<p.length&&p[I+1]&&p[I+1].start-ec<c.current+ec;)I+=1;break;case"backward":for(;I>0&&p[I-1]&&p[I-1].end-ec>c.current+ec;)I-=1;break}if(I!==u.current||f.current||d.current==="paused"||d.current==="waiting"){if(f.current=!1,u.current=I,r(I),!s.current||!i.current||!l.current||!a.current)return;const F=p[I],{tune:D,text:C,cut:k}=F,R=c.current+ec-D.start,j=C.split(" "),N=n2(I),P=uA(N?l.current:a.current),A=Aw(j,k,D.grow),ee=N?[s.current,i.current]:[i.current,s.current],xe=cA(A,P);E(xe,F,ee[0],-R),b(ee[1])}};return m.useEffect(()=>{d.current==="waiting"?setTimeout(()=>{d.current=v},300):d.current=v},[v]),m.useEffect(()=>{t&&(f.current=!0,v==="paused"&&w())},[t]),m.useEffect(()=>{if(!(!p.length||!t))return e.current.addEventListener("timeupdate",w),()=>{e.current.removeEventListener("timeupdate",w)}},[p,t]),m.useEffect(()=>()=>{c.current=0,u.current=-1,r(0)},[p]),{loading:g,currentIndexRef:u,oddOverlay:s,evenOverlay:i,currentIndex:n,textData:_,tempEventText:a,tempOddText:l}}function r2({text:t,overlayRef:e}){const{playStatus:n}=se(Ln),[r,s]=m.useState(t),[i,a]=m.useState(!1),l=m.useRef(!0);m.useEffect(()=>{t&&a(!1)},[t]),m.useEffect(()=>{if(i)return;const u=()=>{s(t),a(!0)};l.current?setTimeout(u,300):(l.current=!0,u())},[i]),m.useEffect(()=>{n==="waiting"&&(l.current=!1),e.current&&(n==="playing"?e.current.style.animationPlayState="running":e.current.style.animationPlayState="paused")},[n]);const c={lyric:"relative duration-300 text-[44px] font-[700] pointer-none whitespace-nowrap"};return o.jsxs("div",{className:`${c.lyric} ${l.current?"transition-opacity":""} ${i?"opacity-[1]":"opacity-0"}`,children:[r||"...",o.jsx("p",{ref:e,className:"absolute whitespace-nowrap w-0 overflow-hidden text-[#ffed00] left-0 top-0 h-full",children:r||"..."})]})}function eY({active:t}){const{loading:e,evenOverlay:n,oddOverlay:r,tempEventText:s,tempOddText:i,textData:a}=ZX({active:t});return e?o.jsx(an,{children:o.jsx(at,{className:"w-7 animate-spin"})}):o.jsxs(o.Fragment,{children:[o.jsx("div",{ref:s,className:"inline-flex h-0 opacity-0",children:a.even.split(" ").map((l,c)=>o.jsx("span",{className:"leading-1",children:l},c))}),o.jsx("div",{ref:i,className:"inline-flex h-0 opacity-0",children:a.odd.split(" ").map((l,c)=>o.jsx("span",{className:"k leading-1",children:l},c))}),o.jsx(r2,{overlayRef:n,text:a.even}),o.jsx("div",{className:"mt-8"}),o.jsx(r2,{overlayRef:r,text:a.odd})]})}const sN=()=>{window.dispatchEvent(new Event("mousemove"))};function Fx(t,e,n=!1){const r=window.innerWidth,i=t.getBoundingClientRect().left,a=r-(i+t.offsetWidth),l=Math.abs(Math.ceil(i-a))/2;if(l<5)return!1;n&&(e.onscroll=()=>{},setTimeout(()=>{e.onscroll=sN},900)),n||Math.abs(i)>r||Math.abs(a)>r?e.style.scrollBehavior="auto":e.style.scrollBehavior="smooth";let c=e.scrollLeft;return a>i?setTimeout(()=>{e.scrollLeft=c-l},300):a<i&&setTimeout(()=>{e.scrollLeft=c+l},300),!0}function tY(){const t=ln(),{isOpenFullScreen:e,idle:n}=et(),{currentQueueId:r}=se($e),{playStatus:s}=se(Ln),i=m.useRef(null),a=m.useRef(null),l=m.useRef("paused"),c=()=>{!(a!=null&&a.current)||!(i!=null&&i.current)||Fx(a.current,i.current,n)},u=p=>{let g=document.querySelector(".song-thumb.centered");if(!g)if(a.current)g=a.current;else return;let v;switch(p){case"ArrowRight":v=g.nextElementSibling;break;case"ArrowLeft":v=g.previousElementSibling;break}v&&i.current&&(g.classList.remove("centered"),v.classList.add("centered"),Fx(v,i.current))},d=()=>{if(!a.current)return;const p=document.querySelector(".song-thumb.centered"),g=p==null?void 0:p.getAttribute("queue-id");g&&t(cs(g))},f=p=>{if(p.key==="ArrowRight"||p.key==="ArrowLeft")return p.preventDefault(),u(p.key);p.key==="Enter"&&(p.preventDefault(),d())};return m.useEffect(()=>{e&&c()},[r,e]),m.useEffect(()=>{if(e)return document.addEventListener("keydown",f),()=>{var p;document.removeEventListener("keydown",f),(p=document.querySelector(".song-thumb.centered"))==null||p.classList.remove("centered")}},[r,e]),m.useEffect(()=>{const p=i==null?void 0:i.current;if(p)return p.onscroll=sN,()=>{p.onscroll=()=>{}}},[]),m.useEffect(()=>{l.current=s},[s]),{activeSongRef:a,containerRef:i}}function nY(){const t=ln(),{activeTab:e,isOpenFullScreen:n,idle:r}=et(),{theme:s}=q(),{currentSongData:i}=se($e),{queueSongs:a,currentQueueId:l}=se($e),{activeSongRef:c,containerRef:u}=tY(),d=b=>{l!==b&&t(cs(b))},f=aE(()=>g("next"),200),p=aE(()=>g("previous"),200),g=(b="next")=>{const E=u.current;E.style.scrollBehavior="smooth",b==="next"?E.scrollLeft+=500:b==="previous"&&(E.scrollLeft-=500)},v={songsListTab:" relative h-full no-scrollbar flex items-center flex-row overflow-auto scroll-smooth px-[calc(50%-350px/2)]",absoluteButton:`absolute top-[50%] -translate-y-[50%] p-[8px] bg-white/30 rounded-full ${s.content_hover_bg}`,lyricTabContainer:"px-[40px] min-[1536px]:container  min-[1536px]:px-[200px] h-full flex items-center justify-center flex-row",fadeTransition:"opacity-0 transition-opacity duration-[.3s]"},_=m.useMemo(()=>{if(i!=null&&i.song&&a.length)return a.map((b,E)=>b.queue_id===l?o.jsx(Kp,{ref:c,hasTitle:!0,onClick:()=>d(b.queue_id),active:!0,data:b},E):o.jsx(Kp,{idleClass:`${r?v.fadeTransition:""}`,hasTitle:!0,active:!1,data:b,onClick:()=>d(b.queue_id)},E))},[i==null?void 0:i.song,a,r]);return o.jsxs(o.Fragment,{children:[o.jsx("div",{ref:u,className:`song-list-container ${v.songsListTab} ${e!=="Songs"?"opacity-0":"opacity-100"}`,children:_}),e==="Songs"&&!r&&o.jsxs(o.Fragment,{children:[o.jsx(oe,{hover:"scale",size:"clear",onClick:()=>p(),className:`${v.absoluteButton} left-[20px]`,children:o.jsx(_I,{className:"w-[30px]"})}),o.jsx(oe,{hover:"scale",size:"clear",onClick:()=>f(),className:`${v.absoluteButton} right-[20px]`,children:o.jsx(ch,{className:"w-[30px]"})})]}),o.jsxs(mI,{children:[o.jsx("div",{className:`absolute inset-0 z-20 ${e==="Lyric"?"":"hidden"}`,children:o.jsxs("div",{className:v.lyricTabContainer,children:[o.jsx(Kp,{active:!0,data:i==null?void 0:i.song}),o.jsx(rN,{className:"w-full ml-[40px] h-full",active:n&&e==="Lyric"})]})}),o.jsx("div",{className:`absolute inset-0 z-20 flex flex-col items-center justify-center ${e==="Karaoke"?"":"hidden"}`,children:o.jsx(eY,{active:n&&e==="Karaoke"})})]})]})}function rY(){var a,l;const{isOpenFullScreen:t,idle:e,activeTab:n,playerConig:{songBackground:r}}=et(),{currentSongData:s}=se($e),i={wrapper:`fixed inset-0 z-50 overflow-hidden text-white bg-zinc-900
    } transition-transform duration-[.7s] linear delay-100`,bg:"absolute inset-0 -z-10 brightness-[70%]",container:"absolute w-full top-0 bottom-[90px] flex flex-col",content:"flex-grow relative overflow-hidden",fadeTransition:"opacity-0 transition-opacity duration-[.3s]"};return o.jsxs("div",{className:`${i.wrapper}  ${t?"translate-y-0":"translate-y-full"}`,children:[o.jsx("div",{className:` ${i.bg}`,children:r&&o.jsx(um,{radioGroup:"",height:"100%",width:"100%",hash:((a=s==null?void 0:s.song)==null?void 0:a.blurhash_encode)||tN})}),o.jsxs("div",{className:i.container,children:[o.jsx(YX,{}),o.jsx("div",{className:i.content,children:o.jsx(nY,{})}),n!=="Songs"&&o.jsxs("p",{className:`text-center ${e&&i.fadeTransition}`,children:[((l=s==null?void 0:s.song)==null?void 0:l.name)||"...",o.jsxs("span",{className:"opacity-70 text-sm",children:[" - ",s==null?void 0:s.song.singers.map((c,u)=>(u?", ":"")+c.name)]})]})]})]})}function sY(){const{user:t}=he(),[e,n]=m.useState([]),[r,s]=m.useState(!0);return{isFetching:r,recentSongs:e,getRecentSongs:async()=>{try{if(t&&t.recent_song_ids.length){const a=_e(Nn,X(Zs(),"in",t.recent_song_ids)),l=await Pn(a);n(l)}else{const a=rn()["recent-songs"]||[];n(a)}}catch(a){console.log({message:a})}finally{s(!1)}}}}function iY({setTab:t}){const e=ln(),n=m.useRef(!1),{getRecentSongs:r,isFetching:s,recentSongs:i}=sY(),a=[...Array(5).keys()].map(c=>o.jsx(le,{className:"h-[57px] mt-1"},c)),l=c=>{e(pm({songs:[c]})),e(cs(c.queue_id)),t("Queue")};return m.useEffect(()=>{n.current||(n.current=!0,r())},[]),s?a:o.jsx(ti,{isHasCheckBox:!1,songVariant:"recent-song",songs:i,setSong:l})}const aY=["Queue","Recent"];function oY(){const t=ln(),{theme:e}=q(),{isOpenSongQueue:n,setIsOpenSongQueue:r}=et(),{queueSongs:s,currentQueueId:i,isFetching:a}=se($e),{resetForNewSong:l}=ni(),[c,u]=m.useState("Queue"),d=m.useCallback(v=>{v!==i&&t(cs(v))},[i]),f=m.useCallback(()=>{t(j6()),l(),r(!1)},[]),p=[...Array(5).keys()].map(v=>o.jsx(le,{className:"h-[56px] mt-1"},v)),g={mainContainer:`hidden fixed w-[300px] md:flex flex-col bottom-[80px] right-[0] top-[0] z-20 px-3 pt-4 ${e.container} border-l-[1px] border-${e.alpha} transition-[transform] duration-[.5s] linear delay-100`,songListContainer:"flex-grow overflow-y-auto pb-[10px] overflow-x-hidden no-scrollbar mt-3"};return o.jsx(ms,{children:o.jsxs("div",{className:`${e.text_color} ${g.mainContainer} ${n?"translate-x-0---":"translate-x-full"}     `,children:[o.jsx(xs,{className:"w-fit mx-auto text-sm",tab:c,setTab:u,tabs:aY,render:v=>v}),o.jsx("div",{className:g.songListContainer,children:c==="Queue"?o.jsxs(o.Fragment,{children:[o.jsx(ti,{isHasCheckBox:!1,songs:s,setSong:v=>d(v.queue_id),songVariant:"queue-song",getActive:(v,_)=>v.queue_id===_.queue_id}),a&&p,o.jsx("div",{className:"text-center",children:!!s.length&&o.jsxs(oe,{onClick:f,size:"clear",className:`${e.content_bg} rounded-full my-5 px-3 py-1 space-x-1`,children:[o.jsx(Dn,{className:"w-6"}),o.jsx("span",{className:"font-playwriteCU leading-[2.2]",children:"Clear"})]})})]}):o.jsx(iY,{setTab:u})})]})})}const lY=m.memo(oY);function cY({vinylRef:t}){const{playStatus:e}=se(Ln);m.useEffect(()=>{const n=t.current;n&&(e==="playing"?n.style.animationPlayState="running":n.style.animationPlayState="paused")},[e])}function uY({textRef:t,textWrapperRef:e,content:n}){const r=m.useRef(),s=m.useRef(),i=m.useRef(!1),a=m.useRef(0),l=m.useRef(0),c=m.useRef(0),u=()=>{t.current&&(t.current.style.transition="none",t.current.style.transform="translateX(0)")},d=()=>{t.current&&(t.current.style.transition=`transform linear ${l.current}s`,t.current.style.transform=`translateX(-${c.current}px)`,s.current=setTimeout(u,l.current*1e3))},f=()=>{!t.current||!e.current||(c.current=t.current.offsetWidth-a.current,l.current=Math.ceil(c.current/35))},p=()=>{!i.current||!t.current||!e.current||(l.current=0,c.current=0,i.current=!1,clearInterval(r.current),clearTimeout(s.current),e.current.classList.remove("mask-image-horizontal"),u())},g=()=>{!t.current||!e.current||!n||!(t.current.offsetWidth>e.current.offsetWidth)||(i.current=!0,e.current.classList.add("mask-image-horizontal"),a.current=t.current.clientWidth,t.current.innerHTML=t.current.innerText+"&nbsp; &nbsp; &nbsp;"+t.current.innerText,f(),setTimeout(d,1e3),r.current=setInterval(d,l.current*1e3+3e3))};m.useEffect(()=>(g(),p),[n])}function dY({content:t,className:e}){const n=m.useRef(null),r=m.useRef(null);return uY({textRef:r,textWrapperRef:n,content:t}),o.jsx("div",{ref:n,className:"overflow-hidden relative h-full ",children:o.jsx("div",{ref:r,className:`absolute left-0 whitespace-nowrap ${e}`,children:t||"..."})})}const iN=m.memo(dY);function hY({isOpenFullScreen:t,song:e}){const n=m.useRef(null),{theme:r}=q();cY({vinylRef:n});const s={songInfoChild:"flex flex-row"};return o.jsx("div",{className:`w-1/4  ${Gc(t)}`,children:o.jsxs("div",{className:`${s.songInfoChild} ${Gc(t)}`,children:[o.jsx("div",{ref:n,className:"w-[56px] h-[56px] flex-shrink-0 animate-[spin_8s_linear_infinite]",children:o.jsx(Xe,{src:e==null?void 0:e.image_url,className:"rounded-full h-full object-cover"})}),o.jsxs("div",{className:"ml-2 flex-grow",children:[o.jsx("div",{className:"h-[32px]",children:o.jsx(iN,{className:"leading-[1.5] font-playwriteCU",content:(e==null?void 0:e.name)||"Name"})}),e&&o.jsx("div",{className:"leading-[1.2] text-sm opacity-[.7] line-clamp-1",children:e.singers.map((i,a)=>i.id?o.jsx(we,{to:`/singer/${i.id}`,className:`${r.content_hover_text}  hover:underline`,children:(a?", ":"")+i.name},a):o.jsx("span",{children:(a?", ":"")+i.name}))})]})]})})}function fY({audioEle:t,volumeLineRef:e}){const{theme:n}=q(),[r,s]=m.useState(!1),[i,a]=$0("volume",1),l=d=>{const p=d.target.getBoundingClientRect(),g=e.current;if(g){let v=+((d.clientX-p.x)/g.clientWidth).toFixed(2);v>.9?v=1:v<.05?(v=0,s(!0)):s(!1),a(v)}},c=d=>{d.preventDefault();const f=.1;let p=i;d.deltaY>0?p-f>0?p-=f:p=0:p+f<1?p+=f:p=1,a(+p.toFixed(2))},u=()=>s(!r);return m.useEffect(()=>{if(e.current&&t){const d=i*100;e.current.style.background=vw(n.content_code,d),t.volume=i,s(i===0)}},[i,n]),m.useEffect(()=>{t&&(t.muted=r)},[r]),{volume:i,handleSetVolume:l,isMute:r,handleMute:u,handleWheel:c}}function mY({audioEle:t}){const e=m.useRef(null),{handleMute:n,handleWheel:r,handleSetVolume:s,isMute:i}=fY({audioEle:t,volumeLineRef:e}),a={before:"before:content-[''] before:w-[100%] before:h-[16px] before:absolute before:top-[50%] before:translate-y-[-50%]",volumeLineBase:"ml-1 w-full relative h-[4px] cursor-pointer rounded-full shadow-[2px_2px_10px_rgba(0,0,0,.15)]"};return o.jsxs("div",{className:"flex flex-grow items-center max-w-[120px] mr-2",children:[o.jsx("button",{onWheel:r,onClick:()=>n(),children:i?o.jsx(dM,{className:"w-6"}):o.jsx(lM,{className:"w-6"})}),o.jsx("div",{onClick:l=>s(l),ref:e,className:`${a.volumeLineBase} ${a.before}`,style:{background:"#e1e1e1"}})]})}function pY({handlePlayPause:t,playStatus:e}){const n={icon:"w-[50px] sm:w-10"},r=()=>{switch(e){case"playing":return o.jsx(Xy,{className:`${n.icon}`});case"error":return o.jsx(om,{className:`${n.icon}`});case"loading":case"waiting":return o.jsx(at,{className:`${n.icon} animate-spin`});case"paused":return o.jsx(bI,{className:`${n.icon}`})}};return o.jsx(o.Fragment,{children:o.jsx("button",{className:"inline-flex items-center justify-center",onClick:()=>t(),children:r()})})}function gY(){var b;const{theme:t}=q(),{playerConig:{isShuffle:e,repeat:n},isOpenFullScreen:r,timelineEleRef:s,currentTimeEleRef:i}=et(),{currentSongData:a,queueSongs:l}=se($e),{playStatus:c}=se(Ln),{next:u,previous:d,toggleRepeat:f,toggleShuffle:p,handlePlayPause:g,handleSeek:v}=ni(),_={button:"p-1 rounded-full md:bg-transparent ",buttonsContainer:"w-full flex justify-center items-center mb-3 sm:mb-0 space-x-3",progressContainer:"flex w-full flex-row items-center ",processLineBase:"h-[6px] sm:h-1 flex-grow relative cursor-pointer rounded-[99px] shadow-[2px_2px_10px_rgba(0,0,0,.15)] ",icon:"w-[44px] sm:w-7",before:"before:content-[''] before:w-[100%] before:h-[24px] before:absolute before:top-[50%] before:translate-y-[-50%]"};return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:`${_.buttonsContainer}`,children:[o.jsxs("button",{disabled:l.length<=1,className:`relative ${_.button} ${n!=="no"&&t.content_text}`,onClick:f,children:[o.jsx(yI,{className:_.icon}),o.jsx("span",{className:"absolute font-bold text-[12px] top-1/2 left-1/2 -translate-x-[50%] -translate-y-[50%] ",children:n==="one"?"1":n==="all"?"-":""})]}),o.jsx("button",{disabled:l.length<=1,className:_.button,onClick:d,children:o.jsx(zy,{className:_.icon})}),o.jsx(pY,{playStatus:c,handlePlayPause:g}),o.jsx("button",{disabled:l.length<=1,className:`${_.button}`,onClick:u,children:o.jsx(Gy,{className:_.icon})}),o.jsx("button",{disabled:l.length<=1,className:`${_.button} ${e&&t.content_text}`,onClick:p,children:o.jsx(vI,{className:_.icon})})]}),o.jsxs("div",{className:`${_.progressContainer} ${r?"mb-0":"mb-5 sm:mb-2"} ${c==="error"||c==="loading"?"disable":""}`,children:[o.jsx("div",{className:"w-[44px] sm:w-9",children:o.jsx("span",{ref:i,className:"text-lg sm:text-sm",children:"0:00"})}),o.jsx("div",{ref:s,style:{background:"rgba(255, 255, 255, 0.3)"},onClick:E=>v(E),className:`${_.processLineBase}  ${_.before}`}),o.jsx("div",{className:"w-[44px] sm:w-9 text-right",children:o.jsx("span",{className:"text-lg sm:text-sm",children:a!=null&&a.song?Bs((b=a.song)==null?void 0:b.duration):"0:00"})})]})]})}function xY(){const{theme:t}=q(),e=m.useRef(null);return m.useEffect(()=>{if(e.current){if(!t.image){e.current.style.backgroundImage="";return}e.current.style.backgroundImage=`url(${t.image})`}},[t]),{containerRef:e}}function yY(){const{theme:t}=q(),e=ln(),{countDown:n}=se(Ln),r=m.useRef(null),s=()=>{var a;n?e(Mt({countDown:0})):(a=r.current)==null||a.open()},i={container:"w-[54px] sm:w-[50px] flex justify-center",button:`rounded-[99px]  hover:bg-${t.alpha} p-[5px]`,itemContainer:"flex justify-between items-center min-h-[30px]",text:"text-base text-[#ccc]"};return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:i.container,children:n?o.jsx(ls,{content:"Clear timer",children:o.jsxs("button",{className:"group flex items-center",onClick:s,children:[o.jsx("span",{className:"text-base opacity-70 sm:text-sm group-hover:hidden",children:n.toString().padStart(2,"0")}),o.jsx("span",{className:`hidden group-hover:block ${i.button}`,children:o.jsx(Gi,{className:"w-8 sm:w-6"})})]})}):o.jsx(ls,{content:"Sleep timer",children:o.jsx("button",{onClick:s,className:i.button,children:o.jsx(Vy,{className:"w-8 sm:w-6"})})})}),o.jsx(Fe,{ref:r,variant:"animation",children:o.jsx(II,{active:a=>e(Mt({countDown:a})),closeModal:()=>{var a;return(a=r.current)==null?void 0:a.close()}})})]})}function vY(){const{audioRef:t,idle:e}=et();if(!t.current)throw new Error("BottomPlayer !audioRef.current");const{theme:n}=q(),{isOpenFullScreen:r,isOpenSongQueue:s,setIsOpenFullScreen:i,setIsOpenSongQueue:a}=et(),{currentQueueId:l,currentSongData:c}=se($e),{containerRef:u}=xY(),d=rr(),f=m.useMemo(()=>d.pathname.includes("lyric"),[d]),p=()=>{s&&a(!1),i(!0)},g={wrapper:`hidden md:block border-${n.alpha} fixed bottom-0 w-full border-t transition-transform z-50 md:px-3 lg:px-6 h-[90px]`,container:"flex flex-row gap-[10px] h-full items-center",controlWrapper:`flex max-w-[420px] flex-grow ${r?"max-w-[600px] flex-col-reverse pb-[10px]":"flex-col justify-center"}`,right:"w-1/4 flex items-center justify-end",blurBg:`bg-opacity-[0.8] backdrop-blur-[15px] z-[-1] absolute inset-0 ${n.bottom_player_bg}`};return o.jsxs("div",{ref:u,className:`${g.wrapper} ${r?"border-transparent":n.image?n.bottom_player_bg:""} ${f&&"translate-y-[100%] "} `,children:[!n.image&&o.jsx("div",{className:`${g.blurBg} ${r?"opacity-0 transition-opacity delay-[.2s]":""}`}),o.jsxs("div",{className:`${g.container} ${r?"justify-center text-white":"justify-between"} ${e&&"transition-opacity duration-[.3s] opacity-0"}`,children:[o.jsx(hY,{song:c==null?void 0:c.song,isOpenFullScreen:r}),o.jsx("div",{className:` ${g.controlWrapper} ${qc(l===null)}`,children:o.jsx(gY,{})}),o.jsxs("div",{className:`${g.right}  ${r?"hidden":""}`,children:[o.jsx(mY,{audioEle:t.current}),o.jsxs("div",{className:`flex items-center ${l?"":"disable"}`,children:[o.jsx(ls,{content:"Fullscreen mode",children:o.jsx("button",{onClick:p,className:`rounded-[99px]  hover:bg-${n.alpha}  p-[5px]`,children:o.jsx(YD,{className:"w-6"})})}),o.jsx(ls,{content:"Queue",children:o.jsx("button",{onClick:()=>a(!s),className:`ml-1 hover:bg-${n.alpha} rounded-md p-[5px]`,children:o.jsx(eM,{className:"w-6"})})}),o.jsx("div",{className:`w-[2px] h-[26px] ml-2 bg-${n.alpha}`}),o.jsx(yY,{})]})]})]})]})}function wY({isOpenFullScreen:t}){const e=m.useRef(null);return m.useEffect(()=>{const n=e.current;n&&(t?(n.style.transform="translate(0)",n.style.zIndex="99"):(n.style.transform="translate(0, 100%)",setTimeout(()=>{n.style.zIndex="-10"},500)))},[t]),{wrapperRef:e}}function _Y({imageUrl:t}){const{mobileActiveTab:e,setMobileActiveTab:n}=et(),r=e==="Playing";return o.jsx("div",{onClick:()=>n(r?"Lyric":"Playing"),className:` ${r?"w-full h-auto px-2 sm:w-[60px] sm:h-[60px] sm:px-0":"w-[60px] h-[60px] p-0 flex-shrink-0"}`,children:o.jsx(Xe,{src:t,className:"w-full rounded-md"})})}function bY({song:t,onClick:e,active:n}){const r={itemContainer:`border-b 
    last:border-none border-white/10 rounded-md flex p-2 ${n?"bg-white/10":""}`,imageFrame:"w-[54px] h-[54px] relative rounded-md overflow-hidden flex-shrink-0"};return o.jsx(o.Fragment,{children:o.jsxs("div",{onClick:e,className:`${r.itemContainer} `,children:[o.jsx("div",{className:`${r.imageFrame}  `,children:o.jsx(Xe,{blurHashEncode:t.blurhash_encode,src:t.image_url})}),o.jsxs("div",{className:"ml-[10px]",children:[o.jsx("p",{className:"text-lg line-clamp-1 text-sm",children:t.name}),o.jsx("p",{className:"opacity-70 line-clamp-1 text-sm",children:t.singers.map((s,i)=>o.jsxs("span",{children:[" ",(i?", ":"")+s.name]},i))})]})]})})}function SY({}){const t=ln(),{queueSongs:e,isFetching:n,currentQueueId:r}=se($e),s=[...Array(5).keys()].map(a=>o.jsx(le,{className:"h-[40px] mt-1"},a)),i=()=>o.jsx(o.Fragment,{children:e.map((a,l)=>o.jsx(bY,{song:a,active:r===a.queue_id,onClick:()=>t(cs(a.queue_id))},l))});return o.jsxs(o.Fragment,{children:[i(),n&&s]})}function EY(){const t=m.useRef(null),e=ln(),{countDown:n}=se(Ln),r=()=>{var s;n?e(Mt({countDown:0})):(s=t.current)==null||s.open()};return o.jsxs(o.Fragment,{children:[o.jsxs("div",{children:[o.jsx("button",{className:im(!!n,"active"),onClick:r,children:n?o.jsx($M,{className:"w-6"}):o.jsx(Vy,{className:"w-6"})}),o.jsx("span",{children:n?n.toString().padStart(2,"")+" songs":"Timer"})]}),o.jsx(Fe,{ref:t,variant:"animation",children:o.jsx(II,{active:s=>e(Mt({countDown:s})),closeModal:()=>{var s;return(s=t.current)==null?void 0:s.close()}})})]})}function kY({song:t}){const e=m.useRef(null);return o.jsxs(o.Fragment,{children:[o.jsxs("div",{children:[o.jsx("button",{onClick:()=>{var n;return(n=e.current)==null?void 0:n.open()},children:o.jsx(br,{className:"w-6"})}),o.jsx("span",{children:"Add to playlist"})]}),o.jsx(Fe,{variant:"animation",ref:e,children:o.jsx(Sw,{closeModal:()=>{var n;return(n=e.current)==null?void 0:n.close()},song:t})})]})}function TY({isLiked:t,song:e}){const{action:n,loading:r}=Tw();return o.jsxs("div",{children:[o.jsx("button",{onClick:()=>n({variant:"like",song:e}),className:`${im(t,"active")}`,children:r?o.jsx(at,{className:"w-6 animate-spin"}):o.jsx(o.Fragment,{children:t?o.jsx(Su,{className:"w-6"}):o.jsx(dl,{className:"w-6"})})}),o.jsx("span",{children:t?"Dislike":"Like"})]})}function IY(){const{user:t}=he(),{currentSongData:e,queueSongs:n}=se($e),{toggleRepeat:r,repeat:s}=ni(),i={buttonList:"flex flex-shrink-0 overflow-auto space-x-2 [&_div]:flex [&_div]:w-[70px] [&_div]:flex-col [&_div]:items-center [&_div]:space-y-1.5 [&_div]:text-center [&_button]:p-3.5 [&_button]:bg-white/10 [&_button]:rounded-full [&_button.active]:text-[#198585] [&_span]:text-xs"};if(e)return o.jsx(o.Fragment,{children:o.jsxs("div",{className:"h-[70vh] overflow-hidden text-white rounded-[16px_16px_0_0] relative p-3 flex flex-col",children:[o.jsx("div",{className:"bg-opacity-[0.8] backdrop-blur-[15px] z-[-1] bg-[#1f1f1f] absolute inset-0"}),o.jsxs("div",{className:i.buttonList,children:[o.jsxs("div",{children:[o.jsx("button",{disabled:n.length<=1,className:`${im(s!=="no","active")}`,onClick:r,children:o.jsx(yI,{className:"w-6"})}),o.jsx("span",{className:"break-word",children:s==="one"?"Repeat one":s==="all"?"Repeat all":"Play once"})]}),t&&o.jsxs(o.Fragment,{children:[o.jsx(kY,{song:e.song}),o.jsx(TY,{song:e.song,isLiked:!!(t!=null&&t.liked_song_ids.includes(e.song.id))})]}),o.jsx(EY,{})]}),o.jsx("div",{className:"flex-grow overflow-auto mt-3 border-t border-white/60 pt-3",children:e&&o.jsx(SY,{currentIndex:e.index})})]})})}function CY(){const{setIsOpenFullScreen:t}=et(),{setIsOpenComment:e}=Wr(),n=m.useRef(null),r=m.useRef(null),s=()=>{var i;(i=r.current)==null||i.open(),e(!0)};return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex space-x-1 items-center",children:[o.jsx("button",{className:"p-1.5",onClick:s,children:o.jsx(Uy,{className:"w-6"})}),o.jsx("button",{className:"p-1.5",onClick:()=>{var i;return(i=n.current)==null?void 0:i.open()},children:o.jsx(AM,{className:"w-6"})}),o.jsx("button",{onClick:()=>t(!1),className:"p-1.5",children:o.jsx(wI,{className:"w-6"})})]}),o.jsx(wx,{ref:n,children:o.jsx(IY,{})}),o.jsx(wx,{onClose:()=>e(!1),ref:r,children:o.jsx(XR,{children:o.jsx(nN,{})})})]})}function jY({handlePlayPause:t,playStatus:e}){const n={icon:"w-10"},r=()=>{switch(e){case"playing":return o.jsx(TI,{className:`${n.icon}`});case"error":return o.jsx(UM,{className:`${n.icon}`});case"loading":case"waiting":return o.jsx(kM,{className:`${n.icon} animate-spin`});case"paused":return o.jsx(L0,{className:`${n.icon}`})}};return o.jsx(o.Fragment,{children:o.jsx("button",{className:"inline-flex items-center justify-center",onClick:()=>t(),children:r()})})}function RY(){var l;const{timelineEleRef:t,currentTimeEleRef:e}=et(),{playStatus:n}=se(Ln),{currentSongData:r}=se($e),{handleSeek:s,handlePlayPause:i}=ni(),a={buttonsContainer:"w-full flex items-center justify-between space-x-2 mt-2",progressContainer:"flex w-full flex-row items-center ",processLineBase:"h-1 flex-grow relative rounded-[99px] shadow-[2px_2px_10px_rgba(0,0,0,.15)] ",before:"before:content-[''] before:w-[100%] before:h-[24px] before:absolute before:top-[50%] before:translate-y-[-50%]"};return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:`${a.progressContainer}  ${n==="error"||n==="loading"?"disable":""}`,children:[o.jsx("div",{className:"w-[44px] sm:w-9",children:o.jsx("span",{ref:e,className:"text-lg sm:text-sm",children:"0:00"})}),o.jsx("div",{ref:t,style:{background:"rgba(255, 255, 255, 0.3)"},onClick:c=>s(c),className:`${a.processLineBase}  ${a.before}`}),o.jsx("div",{className:"w-[44px] sm:w-9 text-right",children:o.jsx("span",{className:"text-lg sm:text-sm",children:r!=null&&r.song?Bs((l=r.song)==null?void 0:l.duration):"0:00"})})]}),o.jsxs("div",{className:`${a.buttonsContainer}`,children:[o.jsx(jY,{playStatus:n,handlePlayPause:i}),o.jsx(jw,{target:"song",children:o.jsx(CY,{})})]})]})}function AY(){const{isOpenFullScreen:t,playerConig:{songBackground:e},mobileActiveTab:n}=et(),{currentSongData:r}=se($e),s=m.useRef(null),{wrapperRef:i}=wY({isOpenFullScreen:t}),a={headerWrapper:"flex mb-4",container:"flex-grow flex flex-col relative overflow-hidden",control:"mt-auto",bgImage:"absolute inset-0 z-[-9] brightness-[70%] blur-[4px] translate-3d-0"};return console.log("render"),o.jsx(o.Fragment,{children:o.jsxs("div",{ref:i,style:{transform:"translate(0, 100%)",zIndex:"-10"},className:"block md:hidden fixed inset-0 bg-zinc-900 text-white overflow-hidden transition-[transform] duration-[.3s] ease-linear",children:[e&&o.jsx("div",{className:a.bgImage,children:o.jsx(um,{width:"100%",height:"100%",hash:(r==null?void 0:r.song.blurhash_encode)||tN})}),o.jsx("div",{className:"h-full z-10 p-4 flex flex-col",children:o.jsxs("div",{ref:s,className:a.container,children:[o.jsxs("div",{className:`${n!="Playing"?"flex items-center":"sm:flex"}`,children:[o.jsx(_Y,{imageUrl:r==null?void 0:r.song.image_url}),o.jsxs("div",{className:`ml-2 ${n!="Playing"?"block":"hidden sm:block"}`,children:[o.jsx("p",{className:"font-playwriteCU translate-y-[-6px] leading-[2.4] line-clamp-1",children:r==null?void 0:r.song.name}),o.jsx("div",{className:"opacity-[.7] line-clamp-1 text-sm",children:r==null?void 0:r.song.singers.map((l,c)=>o.jsxs("span",{children:[" ",(c?", ":"")+l.name]},c))})]}),n==="Lyric"&&o.jsxs(pr,{appendOnPortal:!0,children:[o.jsx(gr,{children:o.jsx("button",{className:" p-[6px] rounded-full ml-auto  bg-white/10",children:o.jsx(Hy,{className:"w-6"})})}),o.jsx(xr,{appendTo:"portal",position:"left-bottom",origin:"top right",children:o.jsx(eC,{})})]})]}),o.jsx("div",{className:`mt-2 justify-between items-center ${n!="Playing"?"hidden":"flex sm:hidden"}`,children:o.jsxs("div",{className:"flex-grow",children:[o.jsx("div",{className:"h-[40px]",children:o.jsx(iN,{className:"text-xl leading-[1.5] font-playwriteCU",content:(r==null?void 0:r.song.name)||"..."})}),o.jsx("div",{className:"opacity-[.7] line-clamp-1 text-sm",children:r==null?void 0:r.song.singers.map((l,c)=>l.id?o.jsx(we,{to:`/singer/${l.id}`,children:(c?", ":"")+l.name},c):o.jsxs("span",{children:[" ",(c?", ":"")+l.name]},c))})]})}),o.jsx(mI,{children:o.jsx(rN,{active:t&&n==="Lyric",className:`text-left ${n==="Lyric"?"flex-1 block":"hidden"}`})}),o.jsx("div",{className:`${a.control}`,children:o.jsx(RY,{})})]})})]})})}function NY(){const{theme:t}=q(),{isOpenFullScreen:e,setIsOpenFullScreen:n}=et(),{playStatus:r}=se(Ln),{currentSongData:s}=se($e),{handlePlayPause:i}=ni(),a=rr(),l=m.useMemo(()=>a.pathname.includes("lyric"),[a]),c=m.useMemo(()=>{switch(r){case"playing":return o.jsx(Xy,{className:"w-10"});case"error":return o.jsx(om,{className:"w-10"});case"loading":case"waiting":return o.jsx(at,{className:"w-10 animate-spin"});case"paused":return o.jsx(bI,{className:"w-10"})}},[r]),u={wrapper:`block md:hidden fixed bottom-0 transition-transform w-full h-[80px] overflow-hidden border-t border-${t.alpha} z-40  px-4`,container:`absolute inset-0 ${t.bottom_player_bg} bg-opacity-[0.7] backdrop-blur-[15px] z-[-1]`,songImageWrapper:"flex flex-row items-center flex-grow h-full",image:"w-[54px] h-[54px] flex-shrink-0",cta:"ml-2 flex-shrink-0"};return o.jsxs("div",{className:`${u.wrapper} ${l?"translate-y-[100%]":""}`,children:[o.jsx("div",{className:`${u.container} ${e?"opacity-0 transition-opacity delay-[.3s]":""}`}),o.jsxs("div",{className:"flex justify-between items-center h-full",children:[o.jsx("div",{onClick:()=>s!=null&&s.song.name?n(!0):{},className:"mobile-current-song flex-grow",children:o.jsxs("div",{className:u.songImageWrapper,children:[o.jsx("div",{className:u.image,children:o.jsx(Xe,{src:s==null?void 0:s.song.image_url,className:"rounded-full"})}),o.jsx("div",{className:"flex-grow ml-2",children:(s==null?void 0:s.song.song_url)&&o.jsxs(o.Fragment,{children:[o.jsx("p",{className:"font-playwriteCU line-clamp-1",children:(s==null?void 0:s.song.name)||"..."}),o.jsx("p",{className:"opacity-70 text-sm line-clamp-1",children:s==null?void 0:s.song.singers.map((d,f)=>(f?", ":"")+d.name)})]})})]})}),o.jsx("div",{className:`${u.cta} ${!(s!=null&&s.song.name)&&"disable"}`,children:o.jsx("button",{className:"p-[4px]",onClick:i,children:c})})]})]})}function PY(){const t=ln(),{audioRef:e,firstTimeSongLoaded:n}=et(),{playStatus:r,countDown:s}=se(Ln),{handlePlayPause:i}=ni(),a=m.useRef(0),l=()=>(console.log("song end"),Ze("timer",a.current-1),t(Mt({countDown:a.current-1})));m.useEffect(()=>{const c=rn().timer||0;t(Mt({countDown:c}))},[]),m.useEffect(()=>{if(!(!s||!e.current))return e.current.addEventListener("ended",l),n.current||(Ze("timer",s),Ze("is_timer",!0),r==="paused"&&i()),()=>{var c;(c=e.current)==null||c.removeEventListener("ended",l)}},[!!s]),m.useEffect(()=>{a.current=s},[s])}function FY(){const{isOpenFullScreen:t,playerConig:{repeat:e,isShuffle:n,isCrossFade:r,isEnableBeat:s},audioRef:i,firstTimeSongLoaded:a,startFadeWhenEnd:l,isPlayingNewSong:c,timelineEleRef:u,currentTimeEleRef:d,themeCodeRef:f,shouldSyncSongDuration:p}=et();if(!i.current)throw new Error("Use Control audioRef.current is undefined");const g=ln(),{theme:v}=q(),{user:_,updateUserData:b}=he(),{queueSongs:E,currentSongData:w,currentQueueId:S}=se($e),{playStatus:I}=se(Ln),{currentPlaylist:F}=se(Zi),D=m.useRef(),C=m.useRef(!1),k=m.useRef(!1),R=m.useRef(!1),j=m.useRef("paused"),N=m.useRef([]),P=rr(),{setErrorToast:A}=ge(),{next:ee,updateProgressElement:xe,play:Se,pause:Ue}=ni(),H=m.useMemo(()=>P.pathname.includes("edit"),[P]),Y=m.useMemo(()=>rn(),[]),te=ve=>E[ve],ye=()=>{g(Mt({playStatus:"paused"}))},Te=()=>{I!=="playing"&&(g(Mt({playStatus:"playing"})),R.current=!1)},He=()=>{u.current&&d.current&&(d.current.innerText="0:00",u.current.style.background="rgba(255, 255, 255, 0.15)")},Tr=ve=>{const xt=rn().volume||1;if(ve<=2){const yt=ve/2*xt;i.current.volume=yt}else if(ve<l.current){i.current.volume!=xt&&(i.current.volume=xt);return}if(ve>=l.current){const yt=(i.current.duration-ve)/2*xt;i.current.volume=yt}},ir=()=>{const ve=i.current.currentTime;j.current!=="paused"&&g(Mt({playStatus:"playing"})),xe(ve),r&&Tr(ve),ve&&Math.round(ve)%3===0&&Ze("current_time",Math.round(ve))},ar=()=>{if(console.log("end"),!D.current)return;const ve=rn(),xt=ve.volume||1,yt=ve.timer;if(e==="one"&&yt&&yt!==1)return Se();if(i.current.volume=xt,k.current=!0,n){let On=D.current.index;for(;On===D.current.index;)On=Math.round(Math.random()*E.length-1);const En=te(On);return g(cs(En.queue_id))}return yt===0&&ve.is_timer?(C.current=!0,Ze("is_timer",!1)):D.current.index===E.length-1&&(e==="all"||yt>=1?C.current=!1:C.current=!0),E.length===1?He():ee()},Mn=()=>{D.current&&g(Mt({playStatus:"loading"}))},Gu=()=>{if(!D.current)return;const ve=i.current.duration;if(l.current=ve-3,Ze("current_queue_id",D.current.song.queue_id),C.current)return C.current=!1,g(Mt({playStatus:"paused"}));if((H||a.current)&&(g(Mt({playStatus:"paused"})),a.current)){a.current=!1,p.current=!0,xe(Y.current_time||0);return}if(D.current)if(_){const xt=D.current.song.id,yt=[...N.current];if(!yt.includes(xt)){console.log("push recent songs");const En={recent_song_ids:[...yt,xt]};b(En),kt({collectionName:"Users",data:En,id:_.email})}}else{const xt=rn()["recent-songs"]||[];xt.find(On=>{var En;return On.id===((En=D.current)==null?void 0:En.song.id)})||xt.unshift(D.current.song),Ze("recent-songs",xt)}Se()},Qu=()=>{g(Mt({playStatus:"waiting"}))},ta=()=>{if(D.current){if(R.current||(R.current=!0,A("Found internet error")),!k.current)return g(Mt({playStatus:"error"}));if(E.length>1){if(D.current.index===E.length-1){g(Mt({playStatus:"error"}));return}ee()}else g(Mt({playStatus:"error"}))}};m.useEffect(()=>{_&&(N.current=_.recent_song_ids)},[_]),m.useEffect(()=>{const ve=Y.current_queue_id||null;ve&&E.length?g(cs(ve)):a.current=!1},[]),m.useEffect(()=>(i.current.addEventListener("error",ta),i.current.addEventListener("pause",ye),i.current.addEventListener("play",Te),i.current.addEventListener("loadstart",Mn),i.current.addEventListener("loadedmetadata",Gu),i.current.addEventListener("waiting",Qu),()=>{var ve,xt,yt,On,En,Il;(ve=i.current)==null||ve.removeEventListener("error",ta),(xt=i.current)==null||xt.removeEventListener("pause",ye),(yt=i.current)==null||yt.removeEventListener("play",Te),(On=i.current)==null||On.removeEventListener("loadstart",Mn),(En=i.current)==null||En.removeEventListener("loadedmetadata",Gu),(Il=i.current)==null||Il.addEventListener("waiting",Qu)}),[]),m.useEffect(()=>{if(!w||!S){j.current="paused",Ue();return}return i.current.src=s&&w.song.beat_url?w.song.beat_url:w.song.song_url,D.current=w,()=>{He(),c.current=!0,p.current&&(p.current=!1)}},[w==null?void 0:w.song]),m.useEffect(()=>{if(!w){I==="paused"&&He();return}let ve=`${w.song.name}`;I==="paused"&&F&&w.song.queue_id.includes(F.id)&&(ve=`${F.name}`),document.title=ve,j.current=I},[I]),m.useEffect(()=>(console.log("add end event"),i.current.addEventListener("ended",ar),()=>{var ve;return(ve=i.current)==null?void 0:ve.removeEventListener("ended",ar)}),[e,n,S,E]),m.useEffect(()=>(i.current.addEventListener("timeupdate",ir),()=>{var ve;(ve=i.current)==null||ve.removeEventListener("timeupdate",ir)}),[r]),m.useEffect(()=>{t?f.current="#fff":f.current=v.content_code,xe(a.current?Y.current_time:0)},[v,t]),m.useEffect(()=>{H&&I==="playing"&&Ue()},[H])}function DY(t,e){const{currentSongData:n}=se($e),{isOpenFullScreen:r,setIdle:s}=et(),[i,a]=m.useState(0),l=m.useRef(),c=m.useRef(),u=()=>{s(!1),a(Math.random())},d=()=>{clearTimeout(c.current),clearTimeout(l.current)},f=async()=>{if(!r)return;const p=document.querySelector(".song-thumb.active"),g=document.querySelector(".song-list-container");if(p&&g){const v=Fx(p,g,!0);let _=_w.focusDelay;v||(_=0),l.current=setTimeout(()=>{s(!0)},_)}};if(m.useEffect(()=>{if(!(e||!n)){if(!r){s(!1);return}return setTimeout(()=>{window.addEventListener("mousemove",u),window.dispatchEvent(new Event("mousemove"))},1e3),()=>{window.removeEventListener("mousemove",u),d()}}},[r]),m.useEffect(()=>(c.current=setTimeout(()=>{f()},t),()=>{d()}),[i]),!r)return!1}function LY({children:t}){const{isOnMobile:e}=q();return FY(),PY(),DY(_w.focusDelay,e),m.useMemo(()=>t,[])}function MY(){const{isOnMobile:t}=q(),{audioRef:e}=et();he();const n=e.current&&o.jsxs(o.Fragment,{children:[o.jsx(rY,{}),o.jsx(lY,{}),o.jsx(vY,{})]}),r=e.current&&o.jsxs(o.Fragment,{children:[o.jsx(AY,{}),o.jsx(NY,{})]});return o.jsxs(o.Fragment,{children:[o.jsx("audio",{ref:e,className:"hidden"}),e.current&&o.jsx(LY,{children:t?r:n})]})}function OY({className:t}){const[e,n]=m.useState(!1),{theme:r}=q(),s=()=>{const a=document.querySelector(".main-container");if(!a)return;const l=a.scrollTop||0;n(l>100)},i=()=>{const a=document.querySelector(".main-container");a==null||a.scroll({behavior:"smooth",top:0})};return m.useEffect(()=>{const a=document.querySelector(".main-container");if(a)return a.addEventListener("scroll",s),()=>{a.removeEventListener("scroll",s)}},[]),o.jsx(oe,{onClick:i,variant:"circle",size:"clear",className:`absolute p-[8px] hover:scale-[1.05] transition-[opacity,transform] 
         ${t||""} 
         w-[36px] 
         ${r.content_hover_bg} h-[36px] bg-${r.alpha} 
      ${e?"opacity-[1]":"opacity-0 translate-y-[20px]"}`,children:o.jsx(CM,{className:"w-full"})})}function $Y(){const{theme:t}=q(),{user:e,loading:n}=he(),r=rr(),s=qt(),i=()=>{s("/dashboard")},a=[...Array(2).keys()].map(c=>o.jsxs("div",{className:"px-3 w-full h-[51px] flex items-center",children:[o.jsx(le,{className:"w-[28px] h-[28px] mr-1 flex-shrink-0"}),o.jsx(le,{className:"w-[100px] h-[30px]"})]},c)),l={container:`w-[180px] relative  flex-shrink-0 border-r-[1px] h-screen ${t.side_bar_bg} border-${t.alpha}`,navItem:`  px-3 py-2 leading-[2.2] font-playwriteCU flex items-center ${t.content_hover_text}`,icon:"w-7 mr-2",link:"w-full border-l-[4px]",activeLink:`${t.content_text} ${t.container} ${t.content_border}  `};return o.jsxs("div",{className:`hidden md:block ${l.container} ${t.text_color}`,children:[o.jsx("div",{className:"px-[10px] h-[60px] flex items-center justify-center",children:o.jsxs(we,{to:"/",className:"text-[24px] font-[500]",children:["HD",o.jsx("span",{className:`${t.content_text} ml-[4px]`,children:"MP3"})]})}),o.jsxs("div",{className:"flex flex-col items-start",children:[n&&a,!n&&o.jsxs(o.Fragment,{children:[o.jsx(we,{className:`${l.link} ${r.pathname==="/"?l.activeLink:"border-transparent"}`,to:"/",children:o.jsxs("div",{className:l.navItem,children:[o.jsx(lm,{className:l.icon}),o.jsx("span",{children:"Discover"})]})}),e&&o.jsxs(o.Fragment,{children:[o.jsx(we,{className:`${l.link}  ${r.pathname.includes("my-music")?l.activeLink:"border-transparent"}`,to:"/my-music",children:o.jsxs("div",{className:l.navItem,children:[o.jsx(Ka,{className:l.icon}),o.jsx("span",{children:"My Song"})]})}),e.role==="ADMIN"&&o.jsx(we,{to:"/dashboard",className:`${l.link} border-transparent`,children:o.jsxs("div",{onClick:i,className:` ${l.navItem}`,children:[o.jsx(Wy,{className:l.icon}),o.jsx("span",{className:"",children:"Dashboard"})]})})]})]})]}),o.jsx(OY,{className:"left-[50%] translate-x-[-50%] bottom-[80px] md:bottom-[100px]"})]})}function BY(){const[t,e]=m.useState(""),[n,r]=m.useState(!1),[s,i]=m.useState(!1),[a,l]=m.useState([]),c=m.useRef(null),u=m.useRef(null),d=m.useRef(null),f=m.useRef(!0),p=IT(),g=zR(t,700),v=new AbortController,_=b=>{const E=document.querySelector(".popup-content"),w=b.target,S=document.querySelectorAll(".modal-content");let I=!1;S.forEach(F=>F.contains(w)?I=!0:{}),!(c.current&&u.current&&(c.current.contains(w)||I||u.current.contains(w)||E!=null&&E.contains(w)))&&i(!1)};return m.useEffect(()=>{if(!g.trim()){r(!1),l([]);return}const b=async()=>{try{r(!0);const E=_e(Nn,X("is_official","==",!0),X("name",">=",t),X("name","<=",t+"")),w=await Pn(E);l(w)}catch(E){console.log(E)}finally{r(!1)}};return f.current?b():f.current=!0,()=>{console.log("abort"),v.abort()}},[g]),m.useEffect(()=>(s&&document.addEventListener("click",_),()=>{document.removeEventListener("click",_)}),[s]),m.useEffect(()=>(e(p[0].get("q")||""),()=>{var b;f.current=!1,(b=d.current)==null||b.blur(),i(!1)}),[p[0].get("q")]),m.useEffect(()=>{p[0].get("q")!==t&&s&&(f.current=!0)},[t,s]),{isFetching:n,searchResult:a,value:t,setValue:e,isFocus:s,setIsFocus:i,formRef:c,searchResultRef:u,inputRef:d}}function zY({songs:t}){const{handleSetSong:e}=ei({variant:"search-bar"}),{getRecommend:n}=Cw(),r=s=>{e(s.queue_id,[s]),n(s)};return o.jsx(ms,{children:t.length?o.jsx(ti,{isHasCheckBox:!1,setSong:r,songs:t}):o.jsx(Ke,{})})}function UY(){const t={listWrapper:"[&>*]:px-3 *:text-sm [&>*]:py-2 [&>*]:flex [&>*]:items-center [&>*]:space-x-1 [&>*]:rounded-md "};return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"text-sm font-[500] mb-2",children:"Suggestion keyword"}),o.jsx("div",{className:t.listWrapper,children:o.jsxs(we,{to:"/search?q=nhac-tet",children:[o.jsx(vI,{className:"w-5"}),o.jsx("span",{children:"Nhac tet"})]})})]})}function VY(){const{theme:t}=q(),e=qt(),{isFetching:n,inputRef:r,formRef:s,searchResultRef:i,value:a,searchResult:l,setIsFocus:c,isFocus:u,setValue:d}=BY(),f={container:`relative h-[40px] flex px-3 w-[300px] ${t.text_color} shadow-md`,unFocusContainer:`bg-${t.alpha} rounded-[20px]`,focusedContainer:`${t.type==="dark"?t.modal_bg:t.side_bar_bg} rounded-[20px_20px_0_0]`,input:`bg-transparent outline-none  w-full ${t.type==="light"?"placeholder:text-black":"placeholder:text-white"}`,searchResultContainer:`${t.type==="dark"?t.modal_bg:t.side_bar_bg} shadow-md  rounded-[0_0_20px_20px] p-3 position absolute top-full left-0 w-full max-h-[60vh] overflow-hidden flex flex-col`},p=async g=>{g.preventDefault(),e(`/search?q=${a}`),c(!1)};return o.jsx(o.Fragment,{children:o.jsxs("form",{ref:s,onSubmit:p,className:`${f.container} ${u?f.focusedContainer:f.unFocusContainer}`,children:[o.jsx("button",{className:"mr-2",children:o.jsx(Qy,{className:"w-6"})}),o.jsx("input",{ref:r,value:a,onFocus:()=>c(!0),onChange:g=>d(g.target.value.trim()),placeholder:"Nhac tet...",className:f.input,type:"text"}),o.jsx("button",{type:"button",onClick:()=>d(""),className:`${a?"opacity-100":"!opacity-0"} ${qc(!a)}`,children:n?o.jsx(at,{className:"w-5 animate-spin"}):o.jsx(Gi,{className:"w-5"})}),o.jsx("div",{ref:i,className:`${Gc(!u)} ${f.searchResultContainer}`,children:l.length?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"text-sm font-[500] mb-2",children:"Suggestion results"}),o.jsx("div",{className:"overflow-auto no-scrollbar",children:o.jsx(zY,{songs:l})})]}):o.jsx(UY,{})})]})})}function HY({contentRef:t}){const{theme:e}=q(),[n,r]=m.useState(0),[s,i]=Ev(za),[a,l]=m.useState(""),c=m.useRef(null),u=m.useRef(null),d=m.useRef(null),{action:f}=zm(),p=S=>{var I,F;l(S),(I=d.current)==null||I.toggle(),(F=c.current)==null||F.close()},g=async()=>{var S;try{await f("logout")}catch(I){console.log("signOut error",{message:I})}finally{(S=d.current)==null||S.toggle()}},v=async()=>{var S;try{(S=u.current)==null||S.close(),await f("login")}catch(I){console.log({message:I})}},_=()=>{var I;const S=((I=t.current)==null?void 0:I.scrollTop)||0;r(S)},b=o.jsx(le,{className:"h-[40px] w-[40px] rounded-full"}),E=m.useMemo(()=>{switch(a){case"":return o.jsx(o.Fragment,{});case"theme":return o.jsx(ev,{close:()=>{var S;return(S=d.current)==null?void 0:S.toggle()}});case"info":return o.jsx(Zy,{close:()=>{var S;return(S=d.current)==null?void 0:S.toggle()}});case"confirm":return o.jsx(gs,{close:()=>{var S;return(S=d.current)==null?void 0:S.toggle()},callback:g,loading:!1,label:"Sign out ?"})}},[a]);m.useEffect(()=>{var S;return(S=t.current)==null||S.addEventListener("scroll",_),()=>{document.removeEventListener("scroll",_)}},[]);const w={userName:"text-[16px] font-[500] ml-[8px] line-clamp-1",button:"h-[40px] w-[40px] rounded-full",menuItem:"hover:bg-white/5 rounded-[4px] w-full text-sm px-[10px] h-[44px] inline-flex items-center font-[500]",icon:"w-5 mr-1",divide:`h-[1px]  w-[calc(100%-20px)] mb-[10px] mt-[20px] mx-auto bg-${e.alpha}`};return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:`hidden md:block h-[60px] fixed top-0 right-0 left-[180px] z-[20]  ${n?"shadow-lg":"bg-transparent"}`,children:[o.jsx("div",{className:`${n?"":"hidden "} absolute inset-0 ${e.container} bg-opacity-[0.9] backdrop-blur-[15px] z-[-1] `}),o.jsxs("div",{className:"px-[40px] items-center flex h-full",children:[o.jsx(ZA,{className:"mr-5"}),o.jsx(VY,{}),o.jsxs("div",{className:"flex space-x-3 ml-auto",children:[o.jsxs(pr,{children:[o.jsx(gr,{ref:c,children:o.jsx(ls,{isWrapped:!0,position:"top-[calc(100%+8px)]",content:"Settings",children:o.jsx("button",{className:`flex px-[6px] items-center ${w.button} bg-${e.alpha} ${e.content_hover_bg}`,children:o.jsx(_u,{className:"w-full"})})})}),o.jsx(xr,{appendTo:"parent",className:"top-[calc(100%+8px)] right-0",animationClassName:"origin-top-right",children:o.jsx(MI,{openModal:p,variant:"client"})})]}),o.jsxs(pr,{children:[o.jsx(gr,{ref:u,className:"flex items-center",children:o.jsx("button",{className:"flex hover:brightness-90",children:i?b:o.jsx(gx,{className:"w-[40px] h-[40px]"})})}),o.jsx(xr,{appendTo:"parent",className:"top-[calc(100%+8px)] right-0",animationClassName:"origin-top-right",children:o.jsx(Js,{theme:e,children:o.jsxs("div",{className:"w-[250px] max-h-[50vh]",children:[s&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex items-center p-[10px] pb-0",children:[o.jsx(gx,{className:"login-trigger w-[46px] h-[46px]"}),o.jsx("div",{className:"ml-[12px]",children:o.jsx("h5",{className:"font-semibold line-clamp-1",children:s==null?void 0:s.displayName})})]}),o.jsx("div",{className:w.divide}),o.jsxs("button",{className:`${w.menuItem}`,onClick:()=>p("confirm"),children:[o.jsx($y,{className:w.icon}),"Log out"]})]}),!s&&o.jsxs("button",{className:`${w.menuItem}`,onClick:v,children:[o.jsx(gD,{className:w.icon}),"Log in"]})]})})})]})]})]})]}),o.jsx(Fe,{variant:"animation",ref:d,children:E})]})}function WY(){const{user:t,setUser:e}=he(),{isDev:n}=q(),{uploadedSongs:r,setUploadedSongs:s,shouldFetchFavoriteSongs:i}=Fn(),{setIsUploading:a,isUploading:l,setUploadingSongs:c,resetUploadContext:u}=dI(),[d,f]=m.useState(""),p=m.useRef(null),{setErrorToast:g,setSuccessToast:v}=ge(),_=()=>{const E=p.current;E&&(E.value=""),u()},b=async E=>{try{if(!t)return;const w=[],S=[],I=E.target.files;if(!I.length)return;const F=[],D=[],C=Date.now(),k=P=>r.some(A=>A.size===P.size)||F.some(A=>A.size===P.size);for(let P=0;P<=I.length-1;P++){const A=I[P],ee=await WA(A);if(!ee)continue;const xe={name:ee.singer,created_at:""},Se={...wf(xe),id:""},Ue={name:ee.name,singers:[Se],duration:Math.floor(ee.duration),size:Math.floor(A.size/1024)},H=ee.image?new Blob([ee.image]):null;H&&(S.push(H),Ue.image_url=URL.createObjectURL(H));const Y=yx({...Ue,owner_email:t.email,distributor:t.display_name});if(k(Y)){console.log(">>>duplicate");continue}F.push(Y),w.push(P)}if(r.length+w.length>5)return f("You have reach the upload limit");if(!F.length)return;c(F),a(!0);for(let P=0;P<w.length;P++){const A=w[P],ee=S[P],xe={...F[P]},{filePath:Se,fileURL:Ue}=await yw({file:I[A],folder:"/songs/",namePrefix:t.email,msg:">>> api: upload song file"});if(ee){const ye=await Ji({blob:ee});Object.assign(xe,ye)}Object.assign(xe,{song_file_path:Se,song_url:Ue});const H=await Qs({collectionName:"Songs",data:xe,msg:">>> api: set song doc"}),Y=await $a(H);D.push(Y.id);const te={...Y.data(),id:H.id,queue_id:Uu(4)};s(ye=>[...ye,te]),c(ye=>{const Te=[...ye];return Te.shift,Te})}const j={liked_song_ids:[...D,...t.liked_song_ids]};await kt({collectionName:"Users",data:j,id:t.email}),e({...t,...j}),i.current=!0,v(`${F.length} songs uploaded`);const N=Date.now();n&&console.log(">>> upload songs finished after",(N-C)/1e3)}catch(w){console.log({message:w}),g(d)}finally{_()}};return m.useEffect(()=>{if(!l)return;const E=document.querySelector(".temp-song");E&&E.scrollIntoView({behavior:"smooth",block:"center"})},[l]),{handleInputChange:b,inputRef:p}}function qY(){const{handleInputChange:t,inputRef:e}=WY(),n={container:"upload portal fixed z-[199] bottom-[120px] right-[30px] max-[549px]:bottom-[unset] max-[540px]:top-[10px] max-[540px]:right-[10px]"};return o.jsx(o.Fragment,{children:Ga.createPortal(o.jsx("div",{className:n.container,children:o.jsx("input",{ref:e,onChange:t,type:"file",multiple:!0,accept:"audio",id:"song_upload",className:"hidden"})}),document.getElementById("portals"))})}function GY(){const{theme:t}=q(),e=m.useRef(null),n={page:`md:flex md:h-screen  ${t.container} ${t.text_color}`,container:"md:h-full md:w-full md:flex md:flex-col px-[10px] md:px-[40px] pt-[30px] md:pt-[60px] md:overflow-auto"};return m.useEffect(()=>{const r=document.querySelector(".my-tag"),s=document.querySelector("body");s.style.backgroundColor=t.container_code,r&&r.setAttribute("content",t.container_code)},[t]),o.jsx(o.Fragment,{children:o.jsx(iD,{children:o.jsxs(cI,{children:[o.jsxs("div",{className:`${n.page}`,children:[o.jsx($Y,{}),o.jsxs("div",{ref:e,className:n.container,children:[o.jsx(HY,{contentRef:e}),o.jsx(Xf,{})]}),o.jsx(MY,{})]}),o.jsx(eN,{className:"left-[50%] translate-x-[-50%] top-[10px] md:top-[unset] md:bottom-[100px] md:left-[20px] md:translate-x-0"}),o.jsx(qY,{}),o.jsx(lI,{})]})})})}function jg({children:t}){return t}function QY(){return o.jsx(o.Fragment,{children:o.jsx(n3,{children:o.jsxs(K4,{children:[o.jsx(Xr,{path:"*",element:o.jsx(WW,{})}),o.jsx(Xr,{path:"/login",element:o.jsx(GW,{})}),o.jsxs(Xr,{element:o.jsx(GY,{}),children:[MX.map((t,e)=>{const n=t.layout||jg,r=t.component;return o.jsx(Xr,{path:t.path,element:o.jsx(n,{children:o.jsx(r,{})})},e)}),o.jsx(Xr,{element:o.jsx(BX,{}),children:OX.map((t,e)=>{const n=t.layout||jg,r=t.component;return o.jsx(Xr,{path:t.path,element:o.jsx(n,{children:o.jsx(r,{})})},e)})})]}),o.jsx(Xr,{element:o.jsx(zX,{}),children:o.jsx(Xr,{element:o.jsx(qX,{}),children:$X.map((t,e)=>{const n=t.layout||jg,r=t.component;return o.jsx(Xr,{path:t.path,element:o.jsx(n,{children:o.jsx(r,{})})},e)})})})]})})})}const KY=p6({reducer:{currentPlaylist:lH,playStatus:sH,songQueue:R6},middleware:t=>t({serializableCheck:!1})});function XY(){const{setUser:t,setLoading:e,loading:n,user:r}=he(),{getPlaylist:s}=sA();return m.useEffect(()=>{(async()=>{za.onAuthStateChanged(async a=>{if(a&&a.email){const l=await Ur({collectionName:"Users",id:a.email}),c=l.data(),u={email:a.email,display_name:a.displayName,photo_url:a.photoURL,liked_song_ids:(c==null?void 0:c.liked_song_ids)||[],recent_playlist_ids:(c==null?void 0:c.recent_playlist_ids)||[],recent_song_ids:(c==null?void 0:c.recent_song_ids)||[],liked_singer_ids:(c==null?void 0:c.liked_singer_ids)||[],role:(c==null?void 0:c.role)||"USER",liked_playlist_ids:(c==null?void 0:c.liked_playlist_ids)||[],liked_comment_ids:rn().liked_comment_ids||[],last_seen:""};l.exists()?await Promise.all([s(),kt({collectionName:"Users",id:u.email,data:{last_seen:Gs()}})]):await uU(Ut(Pe,"Users",u.email),u),t(u)}else t(null);e(!1)})})()},[]),{user:r,loading:n}}function YY({children:t}){return XY(),t}Rg.createRoot(document.getElementById("root")).render(o.jsx(m2.StrictMode,{children:o.jsx(BO,{store:KY,children:o.jsx(c3,{children:o.jsx(XF,{children:o.jsx(d3,{children:o.jsx(JF,{children:o.jsx(tD,{children:o.jsx(YY,{children:o.jsx(QY,{})})})})})})})})}));
