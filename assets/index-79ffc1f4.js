function r5(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function f2(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var m2={exports:{}},Kf={},p2={exports:{}},Ne={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ku=Symbol.for("react.element"),s5=Symbol.for("react.portal"),i5=Symbol.for("react.fragment"),a5=Symbol.for("react.strict_mode"),o5=Symbol.for("react.profiler"),l5=Symbol.for("react.provider"),c5=Symbol.for("react.context"),u5=Symbol.for("react.forward_ref"),d5=Symbol.for("react.suspense"),h5=Symbol.for("react.memo"),f5=Symbol.for("react.lazy"),s_=Symbol.iterator;function m5(t){return t===null||typeof t!="object"?null:(t=s_&&t[s_]||t["@@iterator"],typeof t=="function"?t:null)}var g2={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},x2=Object.assign,y2={};function Tl(t,e,n){this.props=t,this.context=e,this.refs=y2,this.updater=n||g2}Tl.prototype.isReactComponent={};Tl.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Tl.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function v2(){}v2.prototype=Tl.prototype;function oy(t,e,n){this.props=t,this.context=e,this.refs=y2,this.updater=n||g2}var ly=oy.prototype=new v2;ly.constructor=oy;x2(ly,Tl.prototype);ly.isPureReactComponent=!0;var i_=Array.isArray,w2=Object.prototype.hasOwnProperty,cy={current:null},_2={key:!0,ref:!0,__self:!0,__source:!0};function S2(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)w2.call(e,r)&&!_2.hasOwnProperty(r)&&(s[r]=e[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:ku,type:t,key:i,ref:o,props:s,_owner:cy.current}}function p5(t,e){return{$$typeof:ku,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function uy(t){return typeof t=="object"&&t!==null&&t.$$typeof===ku}function g5(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var a_=/\/+/g;function Vp(t,e){return typeof t=="object"&&t!==null&&t.key!=null?g5(""+t.key):e.toString(36)}function lh(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case ku:case s5:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+Vp(o,0):r,i_(s)?(n="",t!=null&&(n=t.replace(a_,"$&/")+"/"),lh(s,e,n,"",function(u){return u})):s!=null&&(uy(s)&&(s=p5(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(a_,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",i_(t))for(var l=0;l<t.length;l++){i=t[l];var c=r+Vp(i,l);o+=lh(i,e,n,c,s)}else if(c=m5(t),typeof c=="function")for(t=c.call(t),l=0;!(i=t.next()).done;)i=i.value,c=r+Vp(i,l++),o+=lh(i,e,n,c,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Td(t,e,n){if(t==null)return t;var r=[],s=0;return lh(t,r,"","",function(i){return e.call(n,i,s++)}),r}function x5(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var $n={current:null},ch={transition:null},y5={ReactCurrentDispatcher:$n,ReactCurrentBatchConfig:ch,ReactCurrentOwner:cy};Ne.Children={map:Td,forEach:function(t,e,n){Td(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Td(t,function(){e++}),e},toArray:function(t){return Td(t,function(e){return e})||[]},only:function(t){if(!uy(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Ne.Component=Tl;Ne.Fragment=i5;Ne.Profiler=o5;Ne.PureComponent=oy;Ne.StrictMode=a5;Ne.Suspense=d5;Ne.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=y5;Ne.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=x2({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=cy.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)w2.call(e,c)&&!_2.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:ku,type:t.type,key:s,ref:i,props:r,_owner:o}};Ne.createContext=function(t){return t={$$typeof:c5,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:l5,_context:t},t.Consumer=t};Ne.createElement=S2;Ne.createFactory=function(t){var e=S2.bind(null,t);return e.type=t,e};Ne.createRef=function(){return{current:null}};Ne.forwardRef=function(t){return{$$typeof:u5,render:t}};Ne.isValidElement=uy;Ne.lazy=function(t){return{$$typeof:f5,_payload:{_status:-1,_result:t},_init:x5}};Ne.memo=function(t,e){return{$$typeof:h5,type:t,compare:e===void 0?null:e}};Ne.startTransition=function(t){var e=ch.transition;ch.transition={};try{t()}finally{ch.transition=e}};Ne.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Ne.useCallback=function(t,e){return $n.current.useCallback(t,e)};Ne.useContext=function(t){return $n.current.useContext(t)};Ne.useDebugValue=function(){};Ne.useDeferredValue=function(t){return $n.current.useDeferredValue(t)};Ne.useEffect=function(t,e){return $n.current.useEffect(t,e)};Ne.useId=function(){return $n.current.useId()};Ne.useImperativeHandle=function(t,e,n){return $n.current.useImperativeHandle(t,e,n)};Ne.useInsertionEffect=function(t,e){return $n.current.useInsertionEffect(t,e)};Ne.useLayoutEffect=function(t,e){return $n.current.useLayoutEffect(t,e)};Ne.useMemo=function(t,e){return $n.current.useMemo(t,e)};Ne.useReducer=function(t,e,n){return $n.current.useReducer(t,e,n)};Ne.useRef=function(t){return $n.current.useRef(t)};Ne.useState=function(t){return $n.current.useState(t)};Ne.useSyncExternalStore=function(t,e,n){return $n.current.useSyncExternalStore(t,e,n)};Ne.useTransition=function(){return $n.current.useTransition()};Ne.version="18.2.0";p2.exports=Ne;var h=p2.exports;const b2=f2(h),v5=r5({__proto__:null,default:b2},[h]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var w5=h,_5=Symbol.for("react.element"),S5=Symbol.for("react.fragment"),b5=Object.prototype.hasOwnProperty,E5=w5.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,k5={key:!0,ref:!0,__self:!0,__source:!0};function E2(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)b5.call(e,r)&&!k5.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:_5,type:t,key:i,ref:o,props:s,_owner:E5.current}}Kf.Fragment=S5;Kf.jsx=E2;Kf.jsxs=E2;m2.exports=Kf;var a=m2.exports;var n0={},k2={exports:{}},vr={},j2={exports:{}},T2={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(V,J){var Z=V.length;V.push(J);e:for(;0<Z;){var je=Z-1>>>1,Te=V[je];if(0<s(Te,J))V[je]=J,V[Z]=Te,Z=je;else break e}}function n(V){return V.length===0?null:V[0]}function r(V){if(V.length===0)return null;var J=V[0],Z=V.pop();if(Z!==J){V[0]=Z;e:for(var je=0,Te=V.length,et=Te>>>1;je<et;){var Er=2*(je+1)-1,kr=V[Er],jr=Er+1,ye=V[jr];if(0>s(kr,Z))jr<Te&&0>s(ye,kr)?(V[je]=ye,V[jr]=Z,je=jr):(V[je]=kr,V[Er]=Z,je=Er);else if(jr<Te&&0>s(ye,Z))V[je]=ye,V[jr]=Z,je=jr;else break e}}return J}function s(V,J){var Z=V.sortIndex-J.sortIndex;return Z!==0?Z:V.id-J.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,m=null,p=3,g=!1,x=!1,w=!1,v=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function E(V){for(var J=n(u);J!==null;){if(J.callback===null)r(u);else if(J.startTime<=V)r(u),J.sortIndex=J.expirationTime,e(c,J);else break;J=n(u)}}function I(V){if(w=!1,E(V),!x)if(n(c)!==null)x=!0,de(P);else{var J=n(u);J!==null&&he(I,J.startTime-V)}}function P(V,J){x=!1,w&&(w=!1,S(k),k=-1),g=!0;var Z=p;try{for(E(J),m=n(c);m!==null&&(!(m.expirationTime>J)||V&&!N());){var je=m.callback;if(typeof je=="function"){m.callback=null,p=m.priorityLevel;var Te=je(m.expirationTime<=J);J=t.unstable_now(),typeof Te=="function"?m.callback=Te:m===n(c)&&r(c),E(J)}else r(c);m=n(c)}if(m!==null)var et=!0;else{var Er=n(u);Er!==null&&he(I,Er.startTime-J),et=!1}return et}finally{m=null,p=Z,g=!1}}var F=!1,j=null,k=-1,C=5,R=-1;function N(){return!(t.unstable_now()-R<C)}function M(){if(j!==null){var V=t.unstable_now();R=V;var J=!0;try{J=j(!0,V)}finally{J?A():(F=!1,j=null)}}else F=!1}var A;if(typeof _=="function")A=function(){_(M)};else if(typeof MessageChannel<"u"){var fe=new MessageChannel,Le=fe.port2;fe.port1.onmessage=M,A=function(){Le.postMessage(null)}}else A=function(){v(M,0)};function de(V){j=V,F||(F=!0,A())}function he(V,J){k=v(function(){V(t.unstable_now())},J)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(V){V.callback=null},t.unstable_continueExecution=function(){x||g||(x=!0,de(P))},t.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<V?Math.floor(1e3/V):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(V){switch(p){case 1:case 2:case 3:var J=3;break;default:J=p}var Z=p;p=J;try{return V()}finally{p=Z}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(V,J){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var Z=p;p=V;try{return J()}finally{p=Z}},t.unstable_scheduleCallback=function(V,J,Z){var je=t.unstable_now();switch(typeof Z=="object"&&Z!==null?(Z=Z.delay,Z=typeof Z=="number"&&0<Z?je+Z:je):Z=je,V){case 1:var Te=-1;break;case 2:Te=250;break;case 5:Te=1073741823;break;case 4:Te=1e4;break;default:Te=5e3}return Te=Z+Te,V={id:d++,callback:J,priorityLevel:V,startTime:Z,expirationTime:Te,sortIndex:-1},Z>je?(V.sortIndex=Z,e(u,V),n(c)===null&&V===n(u)&&(w?(S(k),k=-1):w=!0,he(I,Z-je))):(V.sortIndex=Te,e(c,V),x||g||(x=!0,de(P))),V},t.unstable_shouldYield=N,t.unstable_wrapCallback=function(V){var J=p;return function(){var Z=p;p=J;try{return V.apply(this,arguments)}finally{p=Z}}}})(T2);j2.exports=T2;var j5=j2.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var I2=h,gr=j5;function H(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var C2=new Set,Bc={};function no(t,e){sl(t,e),sl(t+"Capture",e)}function sl(t,e){for(Bc[t]=e,t=0;t<e.length;t++)C2.add(e[t])}var Js=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),r0=Object.prototype.hasOwnProperty,T5=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,o_={},l_={};function I5(t){return r0.call(l_,t)?!0:r0.call(o_,t)?!1:T5.test(t)?l_[t]=!0:(o_[t]=!0,!1)}function C5(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function R5(t,e,n,r){if(e===null||typeof e>"u"||C5(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function zn(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var sn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){sn[t]=new zn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];sn[e]=new zn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){sn[t]=new zn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){sn[t]=new zn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){sn[t]=new zn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){sn[t]=new zn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){sn[t]=new zn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){sn[t]=new zn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){sn[t]=new zn(t,5,!1,t.toLowerCase(),null,!1,!1)});var dy=/[\-:]([a-z])/g;function hy(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(dy,hy);sn[e]=new zn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(dy,hy);sn[e]=new zn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(dy,hy);sn[e]=new zn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){sn[t]=new zn(t,1,!1,t.toLowerCase(),null,!1,!1)});sn.xlinkHref=new zn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){sn[t]=new zn(t,1,!1,t.toLowerCase(),null,!0,!0)});function fy(t,e,n,r){var s=sn.hasOwnProperty(e)?sn[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(R5(e,n,s,r)&&(n=null),r||s===null?I5(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var li=I2.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Id=Symbol.for("react.element"),Ao=Symbol.for("react.portal"),Po=Symbol.for("react.fragment"),my=Symbol.for("react.strict_mode"),s0=Symbol.for("react.profiler"),R2=Symbol.for("react.provider"),N2=Symbol.for("react.context"),py=Symbol.for("react.forward_ref"),i0=Symbol.for("react.suspense"),a0=Symbol.for("react.suspense_list"),gy=Symbol.for("react.memo"),Ei=Symbol.for("react.lazy"),A2=Symbol.for("react.offscreen"),c_=Symbol.iterator;function ac(t){return t===null||typeof t!="object"?null:(t=c_&&t[c_]||t["@@iterator"],typeof t=="function"?t:null)}var lt=Object.assign,Up;function yc(t){if(Up===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Up=e&&e[1]||""}return`
`+Up+t}var Hp=!1;function Gp(t,e){if(!t||Hp)return"";Hp=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,l=i.length-1;1<=o&&0<=l&&s[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==i[l]){var c=`
`+s[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=l);break}}}finally{Hp=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?yc(t):""}function N5(t){switch(t.tag){case 5:return yc(t.type);case 16:return yc("Lazy");case 13:return yc("Suspense");case 19:return yc("SuspenseList");case 0:case 2:case 15:return t=Gp(t.type,!1),t;case 11:return t=Gp(t.type.render,!1),t;case 1:return t=Gp(t.type,!0),t;default:return""}}function o0(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Po:return"Fragment";case Ao:return"Portal";case s0:return"Profiler";case my:return"StrictMode";case i0:return"Suspense";case a0:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case N2:return(t.displayName||"Context")+".Consumer";case R2:return(t._context.displayName||"Context")+".Provider";case py:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case gy:return e=t.displayName||null,e!==null?e:o0(t.type)||"Memo";case Ei:e=t._payload,t=t._init;try{return o0(t(e))}catch{}}return null}function A5(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return o0(e);case 8:return e===my?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Qi(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function P2(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function P5(t){var e=P2(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Cd(t){t._valueTracker||(t._valueTracker=P5(t))}function F2(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=P2(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Mh(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function l0(t,e){var n=e.checked;return lt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function u_(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Qi(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function M2(t,e){e=e.checked,e!=null&&fy(t,"checked",e,!1)}function c0(t,e){M2(t,e);var n=Qi(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?u0(t,e.type,n):e.hasOwnProperty("defaultValue")&&u0(t,e.type,Qi(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function d_(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function u0(t,e,n){(e!=="number"||Mh(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var vc=Array.isArray;function qo(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Qi(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function d0(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(H(91));return lt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function h_(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(H(92));if(vc(n)){if(1<n.length)throw Error(H(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Qi(n)}}function D2(t,e){var n=Qi(e.value),r=Qi(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function f_(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function L2(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function h0(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?L2(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Rd,O2=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Rd=Rd||document.createElement("div"),Rd.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Rd.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Vc(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Ic={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},F5=["Webkit","ms","Moz","O"];Object.keys(Ic).forEach(function(t){F5.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Ic[e]=Ic[t]})});function $2(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Ic.hasOwnProperty(t)&&Ic[t]?(""+e).trim():e+"px"}function z2(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=$2(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var M5=lt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function f0(t,e){if(e){if(M5[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(H(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(H(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(H(61))}if(e.style!=null&&typeof e.style!="object")throw Error(H(62))}}function m0(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var p0=null;function xy(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var g0=null,Ko=null,Qo=null;function m_(t){if(t=Iu(t)){if(typeof g0!="function")throw Error(H(280));var e=t.stateNode;e&&(e=Zf(e),g0(t.stateNode,t.type,e))}}function B2(t){Ko?Qo?Qo.push(t):Qo=[t]:Ko=t}function V2(){if(Ko){var t=Ko,e=Qo;if(Qo=Ko=null,m_(t),e)for(t=0;t<e.length;t++)m_(e[t])}}function U2(t,e){return t(e)}function H2(){}var Wp=!1;function G2(t,e,n){if(Wp)return t(e,n);Wp=!0;try{return U2(t,e,n)}finally{Wp=!1,(Ko!==null||Qo!==null)&&(H2(),V2())}}function Uc(t,e){var n=t.stateNode;if(n===null)return null;var r=Zf(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(H(231,e,typeof n));return n}var x0=!1;if(Js)try{var oc={};Object.defineProperty(oc,"passive",{get:function(){x0=!0}}),window.addEventListener("test",oc,oc),window.removeEventListener("test",oc,oc)}catch{x0=!1}function D5(t,e,n,r,s,i,o,l,c){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(d){this.onError(d)}}var Cc=!1,Dh=null,Lh=!1,y0=null,L5={onError:function(t){Cc=!0,Dh=t}};function O5(t,e,n,r,s,i,o,l,c){Cc=!1,Dh=null,D5.apply(L5,arguments)}function $5(t,e,n,r,s,i,o,l,c){if(O5.apply(this,arguments),Cc){if(Cc){var u=Dh;Cc=!1,Dh=null}else throw Error(H(198));Lh||(Lh=!0,y0=u)}}function ro(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function W2(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function p_(t){if(ro(t)!==t)throw Error(H(188))}function z5(t){var e=t.alternate;if(!e){if(e=ro(t),e===null)throw Error(H(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return p_(s),t;if(i===r)return p_(s),e;i=i.sibling}throw Error(H(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o)throw Error(H(189))}}if(n.alternate!==r)throw Error(H(190))}if(n.tag!==3)throw Error(H(188));return n.stateNode.current===n?t:e}function q2(t){return t=z5(t),t!==null?K2(t):null}function K2(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=K2(t);if(e!==null)return e;t=t.sibling}return null}var Q2=gr.unstable_scheduleCallback,g_=gr.unstable_cancelCallback,B5=gr.unstable_shouldYield,V5=gr.unstable_requestPaint,yt=gr.unstable_now,U5=gr.unstable_getCurrentPriorityLevel,yy=gr.unstable_ImmediatePriority,X2=gr.unstable_UserBlockingPriority,Oh=gr.unstable_NormalPriority,H5=gr.unstable_LowPriority,Y2=gr.unstable_IdlePriority,Qf=null,ys=null;function G5(t){if(ys&&typeof ys.onCommitFiberRoot=="function")try{ys.onCommitFiberRoot(Qf,t,void 0,(t.current.flags&128)===128)}catch{}}var Xr=Math.clz32?Math.clz32:K5,W5=Math.log,q5=Math.LN2;function K5(t){return t>>>=0,t===0?32:31-(W5(t)/q5|0)|0}var Nd=64,Ad=4194304;function wc(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function $h(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var l=o&~s;l!==0?r=wc(l):(i&=o,i!==0&&(r=wc(i)))}else o=n&~s,o!==0?r=wc(o):i!==0&&(r=wc(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Xr(e),s=1<<n,r|=t[n],e&=~s;return r}function Q5(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function X5(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-Xr(i),l=1<<o,c=s[o];c===-1?(!(l&n)||l&r)&&(s[o]=Q5(l,e)):c<=e&&(t.expiredLanes|=l),i&=~l}}function v0(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function J2(){var t=Nd;return Nd<<=1,!(Nd&4194240)&&(Nd=64),t}function qp(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function ju(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Xr(e),t[e]=n}function Y5(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-Xr(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function vy(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Xr(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var Ue=0;function Z2(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var ek,wy,tk,nk,rk,w0=!1,Pd=[],Di=null,Li=null,Oi=null,Hc=new Map,Gc=new Map,ji=[],J5="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function x_(t,e){switch(t){case"focusin":case"focusout":Di=null;break;case"dragenter":case"dragleave":Li=null;break;case"mouseover":case"mouseout":Oi=null;break;case"pointerover":case"pointerout":Hc.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Gc.delete(e.pointerId)}}function lc(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=Iu(e),e!==null&&wy(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function Z5(t,e,n,r,s){switch(e){case"focusin":return Di=lc(Di,t,e,n,r,s),!0;case"dragenter":return Li=lc(Li,t,e,n,r,s),!0;case"mouseover":return Oi=lc(Oi,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return Hc.set(i,lc(Hc.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Gc.set(i,lc(Gc.get(i)||null,t,e,n,r,s)),!0}return!1}function sk(t){var e=Ta(t.target);if(e!==null){var n=ro(e);if(n!==null){if(e=n.tag,e===13){if(e=W2(n),e!==null){t.blockedOn=e,rk(t.priority,function(){tk(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function uh(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=_0(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);p0=r,n.target.dispatchEvent(r),p0=null}else return e=Iu(n),e!==null&&wy(e),t.blockedOn=n,!1;e.shift()}return!0}function y_(t,e,n){uh(t)&&n.delete(e)}function eP(){w0=!1,Di!==null&&uh(Di)&&(Di=null),Li!==null&&uh(Li)&&(Li=null),Oi!==null&&uh(Oi)&&(Oi=null),Hc.forEach(y_),Gc.forEach(y_)}function cc(t,e){t.blockedOn===e&&(t.blockedOn=null,w0||(w0=!0,gr.unstable_scheduleCallback(gr.unstable_NormalPriority,eP)))}function Wc(t){function e(s){return cc(s,t)}if(0<Pd.length){cc(Pd[0],t);for(var n=1;n<Pd.length;n++){var r=Pd[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Di!==null&&cc(Di,t),Li!==null&&cc(Li,t),Oi!==null&&cc(Oi,t),Hc.forEach(e),Gc.forEach(e),n=0;n<ji.length;n++)r=ji[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<ji.length&&(n=ji[0],n.blockedOn===null);)sk(n),n.blockedOn===null&&ji.shift()}var Xo=li.ReactCurrentBatchConfig,zh=!0;function tP(t,e,n,r){var s=Ue,i=Xo.transition;Xo.transition=null;try{Ue=1,_y(t,e,n,r)}finally{Ue=s,Xo.transition=i}}function nP(t,e,n,r){var s=Ue,i=Xo.transition;Xo.transition=null;try{Ue=4,_y(t,e,n,r)}finally{Ue=s,Xo.transition=i}}function _y(t,e,n,r){if(zh){var s=_0(t,e,n,r);if(s===null)rg(t,e,r,Bh,n),x_(t,r);else if(Z5(s,t,e,n,r))r.stopPropagation();else if(x_(t,r),e&4&&-1<J5.indexOf(t)){for(;s!==null;){var i=Iu(s);if(i!==null&&ek(i),i=_0(t,e,n,r),i===null&&rg(t,e,r,Bh,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else rg(t,e,r,null,n)}}var Bh=null;function _0(t,e,n,r){if(Bh=null,t=xy(r),t=Ta(t),t!==null)if(e=ro(t),e===null)t=null;else if(n=e.tag,n===13){if(t=W2(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Bh=t,null}function ik(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(U5()){case yy:return 1;case X2:return 4;case Oh:case H5:return 16;case Y2:return 536870912;default:return 16}default:return 16}}var Ai=null,Sy=null,dh=null;function ak(){if(dh)return dh;var t,e=Sy,n=e.length,r,s="value"in Ai?Ai.value:Ai.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return dh=s.slice(t,1<r?1-r:void 0)}function hh(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Fd(){return!0}function v_(){return!1}function wr(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Fd:v_,this.isPropagationStopped=v_,this}return lt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Fd)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Fd)},persist:function(){},isPersistent:Fd}),e}var Il={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},by=wr(Il),Tu=lt({},Il,{view:0,detail:0}),rP=wr(Tu),Kp,Qp,uc,Xf=lt({},Tu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ey,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==uc&&(uc&&t.type==="mousemove"?(Kp=t.screenX-uc.screenX,Qp=t.screenY-uc.screenY):Qp=Kp=0,uc=t),Kp)},movementY:function(t){return"movementY"in t?t.movementY:Qp}}),w_=wr(Xf),sP=lt({},Xf,{dataTransfer:0}),iP=wr(sP),aP=lt({},Tu,{relatedTarget:0}),Xp=wr(aP),oP=lt({},Il,{animationName:0,elapsedTime:0,pseudoElement:0}),lP=wr(oP),cP=lt({},Il,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),uP=wr(cP),dP=lt({},Il,{data:0}),__=wr(dP),hP={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},fP={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},mP={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function pP(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=mP[t])?!!e[t]:!1}function Ey(){return pP}var gP=lt({},Tu,{key:function(t){if(t.key){var e=hP[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=hh(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?fP[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ey,charCode:function(t){return t.type==="keypress"?hh(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?hh(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),xP=wr(gP),yP=lt({},Xf,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),S_=wr(yP),vP=lt({},Tu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ey}),wP=wr(vP),_P=lt({},Il,{propertyName:0,elapsedTime:0,pseudoElement:0}),SP=wr(_P),bP=lt({},Xf,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),EP=wr(bP),kP=[9,13,27,32],ky=Js&&"CompositionEvent"in window,Rc=null;Js&&"documentMode"in document&&(Rc=document.documentMode);var jP=Js&&"TextEvent"in window&&!Rc,ok=Js&&(!ky||Rc&&8<Rc&&11>=Rc),b_=String.fromCharCode(32),E_=!1;function lk(t,e){switch(t){case"keyup":return kP.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ck(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Fo=!1;function TP(t,e){switch(t){case"compositionend":return ck(e);case"keypress":return e.which!==32?null:(E_=!0,b_);case"textInput":return t=e.data,t===b_&&E_?null:t;default:return null}}function IP(t,e){if(Fo)return t==="compositionend"||!ky&&lk(t,e)?(t=ak(),dh=Sy=Ai=null,Fo=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return ok&&e.locale!=="ko"?null:e.data;default:return null}}var CP={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function k_(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!CP[t.type]:e==="textarea"}function uk(t,e,n,r){B2(r),e=Vh(e,"onChange"),0<e.length&&(n=new by("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Nc=null,qc=null;function RP(t){_k(t,0)}function Yf(t){var e=Lo(t);if(F2(e))return t}function NP(t,e){if(t==="change")return e}var dk=!1;if(Js){var Yp;if(Js){var Jp="oninput"in document;if(!Jp){var j_=document.createElement("div");j_.setAttribute("oninput","return;"),Jp=typeof j_.oninput=="function"}Yp=Jp}else Yp=!1;dk=Yp&&(!document.documentMode||9<document.documentMode)}function T_(){Nc&&(Nc.detachEvent("onpropertychange",hk),qc=Nc=null)}function hk(t){if(t.propertyName==="value"&&Yf(qc)){var e=[];uk(e,qc,t,xy(t)),G2(RP,e)}}function AP(t,e,n){t==="focusin"?(T_(),Nc=e,qc=n,Nc.attachEvent("onpropertychange",hk)):t==="focusout"&&T_()}function PP(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Yf(qc)}function FP(t,e){if(t==="click")return Yf(e)}function MP(t,e){if(t==="input"||t==="change")return Yf(e)}function DP(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var es=typeof Object.is=="function"?Object.is:DP;function Kc(t,e){if(es(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!r0.call(e,s)||!es(t[s],e[s]))return!1}return!0}function I_(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function C_(t,e){var n=I_(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=I_(n)}}function fk(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?fk(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function mk(){for(var t=window,e=Mh();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Mh(t.document)}return e}function jy(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function LP(t){var e=mk(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&fk(n.ownerDocument.documentElement,n)){if(r!==null&&jy(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=C_(n,i);var o=C_(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var OP=Js&&"documentMode"in document&&11>=document.documentMode,Mo=null,S0=null,Ac=null,b0=!1;function R_(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;b0||Mo==null||Mo!==Mh(r)||(r=Mo,"selectionStart"in r&&jy(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Ac&&Kc(Ac,r)||(Ac=r,r=Vh(S0,"onSelect"),0<r.length&&(e=new by("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Mo)))}function Md(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Do={animationend:Md("Animation","AnimationEnd"),animationiteration:Md("Animation","AnimationIteration"),animationstart:Md("Animation","AnimationStart"),transitionend:Md("Transition","TransitionEnd")},Zp={},pk={};Js&&(pk=document.createElement("div").style,"AnimationEvent"in window||(delete Do.animationend.animation,delete Do.animationiteration.animation,delete Do.animationstart.animation),"TransitionEvent"in window||delete Do.transitionend.transition);function Jf(t){if(Zp[t])return Zp[t];if(!Do[t])return t;var e=Do[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in pk)return Zp[t]=e[n];return t}var gk=Jf("animationend"),xk=Jf("animationiteration"),yk=Jf("animationstart"),vk=Jf("transitionend"),wk=new Map,N_="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ra(t,e){wk.set(t,e),no(e,[t])}for(var eg=0;eg<N_.length;eg++){var tg=N_[eg],$P=tg.toLowerCase(),zP=tg[0].toUpperCase()+tg.slice(1);ra($P,"on"+zP)}ra(gk,"onAnimationEnd");ra(xk,"onAnimationIteration");ra(yk,"onAnimationStart");ra("dblclick","onDoubleClick");ra("focusin","onFocus");ra("focusout","onBlur");ra(vk,"onTransitionEnd");sl("onMouseEnter",["mouseout","mouseover"]);sl("onMouseLeave",["mouseout","mouseover"]);sl("onPointerEnter",["pointerout","pointerover"]);sl("onPointerLeave",["pointerout","pointerover"]);no("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));no("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));no("onBeforeInput",["compositionend","keypress","textInput","paste"]);no("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));no("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));no("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var _c="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),BP=new Set("cancel close invalid load scroll toggle".split(" ").concat(_c));function A_(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,$5(r,e,void 0,t),t.currentTarget=null}function _k(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var l=r[o],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==i&&s.isPropagationStopped())break e;A_(s,l,u),i=c}else for(o=0;o<r.length;o++){if(l=r[o],c=l.instance,u=l.currentTarget,l=l.listener,c!==i&&s.isPropagationStopped())break e;A_(s,l,u),i=c}}}if(Lh)throw t=y0,Lh=!1,y0=null,t}function Je(t,e){var n=e[I0];n===void 0&&(n=e[I0]=new Set);var r=t+"__bubble";n.has(r)||(Sk(e,t,2,!1),n.add(r))}function ng(t,e,n){var r=0;e&&(r|=4),Sk(n,t,r,e)}var Dd="_reactListening"+Math.random().toString(36).slice(2);function Qc(t){if(!t[Dd]){t[Dd]=!0,C2.forEach(function(n){n!=="selectionchange"&&(BP.has(n)||ng(n,!1,t),ng(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Dd]||(e[Dd]=!0,ng("selectionchange",!1,e))}}function Sk(t,e,n,r){switch(ik(e)){case 1:var s=tP;break;case 4:s=nP;break;default:s=_y}n=s.bind(null,e,n,t),s=void 0,!x0||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function rg(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;o=o.return}for(;l!==null;){if(o=Ta(l),o===null)return;if(c=o.tag,c===5||c===6){r=i=o;continue e}l=l.parentNode}}r=r.return}G2(function(){var u=i,d=xy(n),m=[];e:{var p=wk.get(t);if(p!==void 0){var g=by,x=t;switch(t){case"keypress":if(hh(n)===0)break e;case"keydown":case"keyup":g=xP;break;case"focusin":x="focus",g=Xp;break;case"focusout":x="blur",g=Xp;break;case"beforeblur":case"afterblur":g=Xp;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=w_;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=iP;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=wP;break;case gk:case xk:case yk:g=lP;break;case vk:g=SP;break;case"scroll":g=rP;break;case"wheel":g=EP;break;case"copy":case"cut":case"paste":g=uP;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=S_}var w=(e&4)!==0,v=!w&&t==="scroll",S=w?p!==null?p+"Capture":null:p;w=[];for(var _=u,E;_!==null;){E=_;var I=E.stateNode;if(E.tag===5&&I!==null&&(E=I,S!==null&&(I=Uc(_,S),I!=null&&w.push(Xc(_,I,E)))),v)break;_=_.return}0<w.length&&(p=new g(p,x,null,n,d),m.push({event:p,listeners:w}))}}if(!(e&7)){e:{if(p=t==="mouseover"||t==="pointerover",g=t==="mouseout"||t==="pointerout",p&&n!==p0&&(x=n.relatedTarget||n.fromElement)&&(Ta(x)||x[Zs]))break e;if((g||p)&&(p=d.window===d?d:(p=d.ownerDocument)?p.defaultView||p.parentWindow:window,g?(x=n.relatedTarget||n.toElement,g=u,x=x?Ta(x):null,x!==null&&(v=ro(x),x!==v||x.tag!==5&&x.tag!==6)&&(x=null)):(g=null,x=u),g!==x)){if(w=w_,I="onMouseLeave",S="onMouseEnter",_="mouse",(t==="pointerout"||t==="pointerover")&&(w=S_,I="onPointerLeave",S="onPointerEnter",_="pointer"),v=g==null?p:Lo(g),E=x==null?p:Lo(x),p=new w(I,_+"leave",g,n,d),p.target=v,p.relatedTarget=E,I=null,Ta(d)===u&&(w=new w(S,_+"enter",x,n,d),w.target=E,w.relatedTarget=v,I=w),v=I,g&&x)t:{for(w=g,S=x,_=0,E=w;E;E=bo(E))_++;for(E=0,I=S;I;I=bo(I))E++;for(;0<_-E;)w=bo(w),_--;for(;0<E-_;)S=bo(S),E--;for(;_--;){if(w===S||S!==null&&w===S.alternate)break t;w=bo(w),S=bo(S)}w=null}else w=null;g!==null&&P_(m,p,g,w,!1),x!==null&&v!==null&&P_(m,v,x,w,!0)}}e:{if(p=u?Lo(u):window,g=p.nodeName&&p.nodeName.toLowerCase(),g==="select"||g==="input"&&p.type==="file")var P=NP;else if(k_(p))if(dk)P=MP;else{P=PP;var F=AP}else(g=p.nodeName)&&g.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(P=FP);if(P&&(P=P(t,u))){uk(m,P,n,d);break e}F&&F(t,p,u),t==="focusout"&&(F=p._wrapperState)&&F.controlled&&p.type==="number"&&u0(p,"number",p.value)}switch(F=u?Lo(u):window,t){case"focusin":(k_(F)||F.contentEditable==="true")&&(Mo=F,S0=u,Ac=null);break;case"focusout":Ac=S0=Mo=null;break;case"mousedown":b0=!0;break;case"contextmenu":case"mouseup":case"dragend":b0=!1,R_(m,n,d);break;case"selectionchange":if(OP)break;case"keydown":case"keyup":R_(m,n,d)}var j;if(ky)e:{switch(t){case"compositionstart":var k="onCompositionStart";break e;case"compositionend":k="onCompositionEnd";break e;case"compositionupdate":k="onCompositionUpdate";break e}k=void 0}else Fo?lk(t,n)&&(k="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(k="onCompositionStart");k&&(ok&&n.locale!=="ko"&&(Fo||k!=="onCompositionStart"?k==="onCompositionEnd"&&Fo&&(j=ak()):(Ai=d,Sy="value"in Ai?Ai.value:Ai.textContent,Fo=!0)),F=Vh(u,k),0<F.length&&(k=new __(k,t,null,n,d),m.push({event:k,listeners:F}),j?k.data=j:(j=ck(n),j!==null&&(k.data=j)))),(j=jP?TP(t,n):IP(t,n))&&(u=Vh(u,"onBeforeInput"),0<u.length&&(d=new __("onBeforeInput","beforeinput",null,n,d),m.push({event:d,listeners:u}),d.data=j))}_k(m,e)})}function Xc(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Vh(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Uc(t,n),i!=null&&r.unshift(Xc(t,i,s)),i=Uc(t,e),i!=null&&r.push(Xc(t,i,s))),t=t.return}return r}function bo(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function P_(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var l=n,c=l.alternate,u=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&u!==null&&(l=u,s?(c=Uc(n,i),c!=null&&o.unshift(Xc(n,c,l))):s||(c=Uc(n,i),c!=null&&o.push(Xc(n,c,l)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var VP=/\r\n?/g,UP=/\u0000|\uFFFD/g;function F_(t){return(typeof t=="string"?t:""+t).replace(VP,`
`).replace(UP,"")}function Ld(t,e,n){if(e=F_(e),F_(t)!==e&&n)throw Error(H(425))}function Uh(){}var E0=null,k0=null;function j0(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var T0=typeof setTimeout=="function"?setTimeout:void 0,HP=typeof clearTimeout=="function"?clearTimeout:void 0,M_=typeof Promise=="function"?Promise:void 0,GP=typeof queueMicrotask=="function"?queueMicrotask:typeof M_<"u"?function(t){return M_.resolve(null).then(t).catch(WP)}:T0;function WP(t){setTimeout(function(){throw t})}function sg(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),Wc(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Wc(e)}function $i(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function D_(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Cl=Math.random().toString(36).slice(2),gs="__reactFiber$"+Cl,Yc="__reactProps$"+Cl,Zs="__reactContainer$"+Cl,I0="__reactEvents$"+Cl,qP="__reactListeners$"+Cl,KP="__reactHandles$"+Cl;function Ta(t){var e=t[gs];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Zs]||n[gs]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=D_(t);t!==null;){if(n=t[gs])return n;t=D_(t)}return e}t=n,n=t.parentNode}return null}function Iu(t){return t=t[gs]||t[Zs],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Lo(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(H(33))}function Zf(t){return t[Yc]||null}var C0=[],Oo=-1;function sa(t){return{current:t}}function Ze(t){0>Oo||(t.current=C0[Oo],C0[Oo]=null,Oo--)}function Xe(t,e){Oo++,C0[Oo]=t.current,t.current=e}var Xi={},wn=sa(Xi),Qn=sa(!1),La=Xi;function il(t,e){var n=t.type.contextTypes;if(!n)return Xi;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Xn(t){return t=t.childContextTypes,t!=null}function Hh(){Ze(Qn),Ze(wn)}function L_(t,e,n){if(wn.current!==Xi)throw Error(H(168));Xe(wn,e),Xe(Qn,n)}function bk(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(H(108,A5(t)||"Unknown",s));return lt({},n,r)}function Gh(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Xi,La=wn.current,Xe(wn,t),Xe(Qn,Qn.current),!0}function O_(t,e,n){var r=t.stateNode;if(!r)throw Error(H(169));n?(t=bk(t,e,La),r.__reactInternalMemoizedMergedChildContext=t,Ze(Qn),Ze(wn),Xe(wn,t)):Ze(Qn),Xe(Qn,n)}var Ls=null,em=!1,ig=!1;function Ek(t){Ls===null?Ls=[t]:Ls.push(t)}function QP(t){em=!0,Ek(t)}function ia(){if(!ig&&Ls!==null){ig=!0;var t=0,e=Ue;try{var n=Ls;for(Ue=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Ls=null,em=!1}catch(s){throw Ls!==null&&(Ls=Ls.slice(t+1)),Q2(yy,ia),s}finally{Ue=e,ig=!1}}return null}var $o=[],zo=0,Wh=null,qh=0,Cr=[],Rr=0,Oa=null,$s=1,zs="";function _a(t,e){$o[zo++]=qh,$o[zo++]=Wh,Wh=t,qh=e}function kk(t,e,n){Cr[Rr++]=$s,Cr[Rr++]=zs,Cr[Rr++]=Oa,Oa=t;var r=$s;t=zs;var s=32-Xr(r)-1;r&=~(1<<s),n+=1;var i=32-Xr(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,$s=1<<32-Xr(e)+s|n<<s|r,zs=i+t}else $s=1<<i|n<<s|r,zs=t}function Ty(t){t.return!==null&&(_a(t,1),kk(t,1,0))}function Iy(t){for(;t===Wh;)Wh=$o[--zo],$o[zo]=null,qh=$o[--zo],$o[zo]=null;for(;t===Oa;)Oa=Cr[--Rr],Cr[Rr]=null,zs=Cr[--Rr],Cr[Rr]=null,$s=Cr[--Rr],Cr[Rr]=null}var fr=null,ur=null,nt=!1,Wr=null;function jk(t,e){var n=Nr(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function $_(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,fr=t,ur=$i(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,fr=t,ur=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Oa!==null?{id:$s,overflow:zs}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Nr(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,fr=t,ur=null,!0):!1;default:return!1}}function R0(t){return(t.mode&1)!==0&&(t.flags&128)===0}function N0(t){if(nt){var e=ur;if(e){var n=e;if(!$_(t,e)){if(R0(t))throw Error(H(418));e=$i(n.nextSibling);var r=fr;e&&$_(t,e)?jk(r,n):(t.flags=t.flags&-4097|2,nt=!1,fr=t)}}else{if(R0(t))throw Error(H(418));t.flags=t.flags&-4097|2,nt=!1,fr=t}}}function z_(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;fr=t}function Od(t){if(t!==fr)return!1;if(!nt)return z_(t),nt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!j0(t.type,t.memoizedProps)),e&&(e=ur)){if(R0(t))throw Tk(),Error(H(418));for(;e;)jk(t,e),e=$i(e.nextSibling)}if(z_(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(H(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){ur=$i(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}ur=null}}else ur=fr?$i(t.stateNode.nextSibling):null;return!0}function Tk(){for(var t=ur;t;)t=$i(t.nextSibling)}function al(){ur=fr=null,nt=!1}function Cy(t){Wr===null?Wr=[t]:Wr.push(t)}var XP=li.ReactCurrentBatchConfig;function Hr(t,e){if(t&&t.defaultProps){e=lt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var Kh=sa(null),Qh=null,Bo=null,Ry=null;function Ny(){Ry=Bo=Qh=null}function Ay(t){var e=Kh.current;Ze(Kh),t._currentValue=e}function A0(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Yo(t,e){Qh=t,Ry=Bo=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Kn=!0),t.firstContext=null)}function Pr(t){var e=t._currentValue;if(Ry!==t)if(t={context:t,memoizedValue:e,next:null},Bo===null){if(Qh===null)throw Error(H(308));Bo=t,Qh.dependencies={lanes:0,firstContext:t}}else Bo=Bo.next=t;return e}var Ia=null;function Py(t){Ia===null?Ia=[t]:Ia.push(t)}function Ik(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,Py(e)):(n.next=s.next,s.next=n),e.interleaved=n,ei(t,r)}function ei(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var ki=!1;function Fy(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ck(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Ws(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function zi(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,De&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,ei(t,n)}return s=r.interleaved,s===null?(e.next=e,Py(r)):(e.next=s.next,s.next=e),r.interleaved=e,ei(t,n)}function fh(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,vy(t,n)}}function B_(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Xh(t,e,n,r){var s=t.updateQueue;ki=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,u=c.next;c.next=null,o===null?i=u:o.next=u,o=c;var d=t.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==o&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(i!==null){var m=s.baseState;o=0,d=u=c=null,l=i;do{var p=l.lane,g=l.eventTime;if((r&p)===p){d!==null&&(d=d.next={eventTime:g,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var x=t,w=l;switch(p=e,g=n,w.tag){case 1:if(x=w.payload,typeof x=="function"){m=x.call(g,m,p);break e}m=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=w.payload,p=typeof x=="function"?x.call(g,m,p):x,p==null)break e;m=lt({},m,p);break e;case 2:ki=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,p=s.effects,p===null?s.effects=[l]:p.push(l))}else g={eventTime:g,lane:p,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=g,c=m):d=d.next=g,o|=p;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;p=l,l=p.next,p.next=null,s.lastBaseUpdate=p,s.shared.pending=null}}while(1);if(d===null&&(c=m),s.baseState=c,s.firstBaseUpdate=u,s.lastBaseUpdate=d,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);za|=o,t.lanes=o,t.memoizedState=m}}function V_(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(H(191,s));s.call(r)}}}var Rk=new I2.Component().refs;function P0(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:lt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var tm={isMounted:function(t){return(t=t._reactInternals)?ro(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Rn(),s=Vi(t),i=Ws(r,s);i.payload=e,n!=null&&(i.callback=n),e=zi(t,i,s),e!==null&&(Yr(e,t,s,r),fh(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Rn(),s=Vi(t),i=Ws(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=zi(t,i,s),e!==null&&(Yr(e,t,s,r),fh(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Rn(),r=Vi(t),s=Ws(n,r);s.tag=2,e!=null&&(s.callback=e),e=zi(t,s,r),e!==null&&(Yr(e,t,r,n),fh(e,t,r))}};function U_(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!Kc(n,r)||!Kc(s,i):!0}function Nk(t,e,n){var r=!1,s=Xi,i=e.contextType;return typeof i=="object"&&i!==null?i=Pr(i):(s=Xn(e)?La:wn.current,r=e.contextTypes,i=(r=r!=null)?il(t,s):Xi),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=tm,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function H_(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&tm.enqueueReplaceState(e,e.state,null)}function F0(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs=Rk,Fy(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=Pr(i):(i=Xn(e)?La:wn.current,s.context=il(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(P0(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&tm.enqueueReplaceState(s,s.state,null),Xh(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function dc(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(H(309));var r=n.stateNode}if(!r)throw Error(H(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var l=s.refs;l===Rk&&(l=s.refs={}),o===null?delete l[i]:l[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(H(284));if(!n._owner)throw Error(H(290,t))}return t}function $d(t,e){throw t=Object.prototype.toString.call(e),Error(H(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function G_(t){var e=t._init;return e(t._payload)}function Ak(t){function e(S,_){if(t){var E=S.deletions;E===null?(S.deletions=[_],S.flags|=16):E.push(_)}}function n(S,_){if(!t)return null;for(;_!==null;)e(S,_),_=_.sibling;return null}function r(S,_){for(S=new Map;_!==null;)_.key!==null?S.set(_.key,_):S.set(_.index,_),_=_.sibling;return S}function s(S,_){return S=Ui(S,_),S.index=0,S.sibling=null,S}function i(S,_,E){return S.index=E,t?(E=S.alternate,E!==null?(E=E.index,E<_?(S.flags|=2,_):E):(S.flags|=2,_)):(S.flags|=1048576,_)}function o(S){return t&&S.alternate===null&&(S.flags|=2),S}function l(S,_,E,I){return _===null||_.tag!==6?(_=hg(E,S.mode,I),_.return=S,_):(_=s(_,E),_.return=S,_)}function c(S,_,E,I){var P=E.type;return P===Po?d(S,_,E.props.children,I,E.key):_!==null&&(_.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===Ei&&G_(P)===_.type)?(I=s(_,E.props),I.ref=dc(S,_,E),I.return=S,I):(I=vh(E.type,E.key,E.props,null,S.mode,I),I.ref=dc(S,_,E),I.return=S,I)}function u(S,_,E,I){return _===null||_.tag!==4||_.stateNode.containerInfo!==E.containerInfo||_.stateNode.implementation!==E.implementation?(_=fg(E,S.mode,I),_.return=S,_):(_=s(_,E.children||[]),_.return=S,_)}function d(S,_,E,I,P){return _===null||_.tag!==7?(_=Fa(E,S.mode,I,P),_.return=S,_):(_=s(_,E),_.return=S,_)}function m(S,_,E){if(typeof _=="string"&&_!==""||typeof _=="number")return _=hg(""+_,S.mode,E),_.return=S,_;if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Id:return E=vh(_.type,_.key,_.props,null,S.mode,E),E.ref=dc(S,null,_),E.return=S,E;case Ao:return _=fg(_,S.mode,E),_.return=S,_;case Ei:var I=_._init;return m(S,I(_._payload),E)}if(vc(_)||ac(_))return _=Fa(_,S.mode,E,null),_.return=S,_;$d(S,_)}return null}function p(S,_,E,I){var P=_!==null?_.key:null;if(typeof E=="string"&&E!==""||typeof E=="number")return P!==null?null:l(S,_,""+E,I);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case Id:return E.key===P?c(S,_,E,I):null;case Ao:return E.key===P?u(S,_,E,I):null;case Ei:return P=E._init,p(S,_,P(E._payload),I)}if(vc(E)||ac(E))return P!==null?null:d(S,_,E,I,null);$d(S,E)}return null}function g(S,_,E,I,P){if(typeof I=="string"&&I!==""||typeof I=="number")return S=S.get(E)||null,l(_,S,""+I,P);if(typeof I=="object"&&I!==null){switch(I.$$typeof){case Id:return S=S.get(I.key===null?E:I.key)||null,c(_,S,I,P);case Ao:return S=S.get(I.key===null?E:I.key)||null,u(_,S,I,P);case Ei:var F=I._init;return g(S,_,E,F(I._payload),P)}if(vc(I)||ac(I))return S=S.get(E)||null,d(_,S,I,P,null);$d(_,I)}return null}function x(S,_,E,I){for(var P=null,F=null,j=_,k=_=0,C=null;j!==null&&k<E.length;k++){j.index>k?(C=j,j=null):C=j.sibling;var R=p(S,j,E[k],I);if(R===null){j===null&&(j=C);break}t&&j&&R.alternate===null&&e(S,j),_=i(R,_,k),F===null?P=R:F.sibling=R,F=R,j=C}if(k===E.length)return n(S,j),nt&&_a(S,k),P;if(j===null){for(;k<E.length;k++)j=m(S,E[k],I),j!==null&&(_=i(j,_,k),F===null?P=j:F.sibling=j,F=j);return nt&&_a(S,k),P}for(j=r(S,j);k<E.length;k++)C=g(j,S,k,E[k],I),C!==null&&(t&&C.alternate!==null&&j.delete(C.key===null?k:C.key),_=i(C,_,k),F===null?P=C:F.sibling=C,F=C);return t&&j.forEach(function(N){return e(S,N)}),nt&&_a(S,k),P}function w(S,_,E,I){var P=ac(E);if(typeof P!="function")throw Error(H(150));if(E=P.call(E),E==null)throw Error(H(151));for(var F=P=null,j=_,k=_=0,C=null,R=E.next();j!==null&&!R.done;k++,R=E.next()){j.index>k?(C=j,j=null):C=j.sibling;var N=p(S,j,R.value,I);if(N===null){j===null&&(j=C);break}t&&j&&N.alternate===null&&e(S,j),_=i(N,_,k),F===null?P=N:F.sibling=N,F=N,j=C}if(R.done)return n(S,j),nt&&_a(S,k),P;if(j===null){for(;!R.done;k++,R=E.next())R=m(S,R.value,I),R!==null&&(_=i(R,_,k),F===null?P=R:F.sibling=R,F=R);return nt&&_a(S,k),P}for(j=r(S,j);!R.done;k++,R=E.next())R=g(j,S,k,R.value,I),R!==null&&(t&&R.alternate!==null&&j.delete(R.key===null?k:R.key),_=i(R,_,k),F===null?P=R:F.sibling=R,F=R);return t&&j.forEach(function(M){return e(S,M)}),nt&&_a(S,k),P}function v(S,_,E,I){if(typeof E=="object"&&E!==null&&E.type===Po&&E.key===null&&(E=E.props.children),typeof E=="object"&&E!==null){switch(E.$$typeof){case Id:e:{for(var P=E.key,F=_;F!==null;){if(F.key===P){if(P=E.type,P===Po){if(F.tag===7){n(S,F.sibling),_=s(F,E.props.children),_.return=S,S=_;break e}}else if(F.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===Ei&&G_(P)===F.type){n(S,F.sibling),_=s(F,E.props),_.ref=dc(S,F,E),_.return=S,S=_;break e}n(S,F);break}else e(S,F);F=F.sibling}E.type===Po?(_=Fa(E.props.children,S.mode,I,E.key),_.return=S,S=_):(I=vh(E.type,E.key,E.props,null,S.mode,I),I.ref=dc(S,_,E),I.return=S,S=I)}return o(S);case Ao:e:{for(F=E.key;_!==null;){if(_.key===F)if(_.tag===4&&_.stateNode.containerInfo===E.containerInfo&&_.stateNode.implementation===E.implementation){n(S,_.sibling),_=s(_,E.children||[]),_.return=S,S=_;break e}else{n(S,_);break}else e(S,_);_=_.sibling}_=fg(E,S.mode,I),_.return=S,S=_}return o(S);case Ei:return F=E._init,v(S,_,F(E._payload),I)}if(vc(E))return x(S,_,E,I);if(ac(E))return w(S,_,E,I);$d(S,E)}return typeof E=="string"&&E!==""||typeof E=="number"?(E=""+E,_!==null&&_.tag===6?(n(S,_.sibling),_=s(_,E),_.return=S,S=_):(n(S,_),_=hg(E,S.mode,I),_.return=S,S=_),o(S)):n(S,_)}return v}var ol=Ak(!0),Pk=Ak(!1),Cu={},vs=sa(Cu),Jc=sa(Cu),Zc=sa(Cu);function Ca(t){if(t===Cu)throw Error(H(174));return t}function My(t,e){switch(Xe(Zc,e),Xe(Jc,t),Xe(vs,Cu),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:h0(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=h0(e,t)}Ze(vs),Xe(vs,e)}function ll(){Ze(vs),Ze(Jc),Ze(Zc)}function Fk(t){Ca(Zc.current);var e=Ca(vs.current),n=h0(e,t.type);e!==n&&(Xe(Jc,t),Xe(vs,n))}function Dy(t){Jc.current===t&&(Ze(vs),Ze(Jc))}var at=sa(0);function Yh(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var ag=[];function Ly(){for(var t=0;t<ag.length;t++)ag[t]._workInProgressVersionPrimary=null;ag.length=0}var mh=li.ReactCurrentDispatcher,og=li.ReactCurrentBatchConfig,$a=0,ot=null,Pt=null,Vt=null,Jh=!1,Pc=!1,eu=0,YP=0;function dn(){throw Error(H(321))}function Oy(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!es(t[n],e[n]))return!1;return!0}function $y(t,e,n,r,s,i){if($a=i,ot=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,mh.current=t===null||t.memoizedState===null?t3:n3,t=n(r,s),Pc){i=0;do{if(Pc=!1,eu=0,25<=i)throw Error(H(301));i+=1,Vt=Pt=null,e.updateQueue=null,mh.current=r3,t=n(r,s)}while(Pc)}if(mh.current=Zh,e=Pt!==null&&Pt.next!==null,$a=0,Vt=Pt=ot=null,Jh=!1,e)throw Error(H(300));return t}function zy(){var t=eu!==0;return eu=0,t}function ms(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Vt===null?ot.memoizedState=Vt=t:Vt=Vt.next=t,Vt}function Fr(){if(Pt===null){var t=ot.alternate;t=t!==null?t.memoizedState:null}else t=Pt.next;var e=Vt===null?ot.memoizedState:Vt.next;if(e!==null)Vt=e,Pt=t;else{if(t===null)throw Error(H(310));Pt=t,t={memoizedState:Pt.memoizedState,baseState:Pt.baseState,baseQueue:Pt.baseQueue,queue:Pt.queue,next:null},Vt===null?ot.memoizedState=Vt=t:Vt=Vt.next=t}return Vt}function tu(t,e){return typeof e=="function"?e(t):e}function lg(t){var e=Fr(),n=e.queue;if(n===null)throw Error(H(311));n.lastRenderedReducer=t;var r=Pt,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=o=null,c=null,u=i;do{var d=u.lane;if(($a&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var m={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=m,o=r):c=c.next=m,ot.lanes|=d,za|=d}u=u.next}while(u!==null&&u!==i);c===null?o=r:c.next=l,es(r,e.memoizedState)||(Kn=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=c,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,ot.lanes|=i,za|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function cg(t){var e=Fr(),n=e.queue;if(n===null)throw Error(H(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);es(i,e.memoizedState)||(Kn=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function Mk(){}function Dk(t,e){var n=ot,r=Fr(),s=e(),i=!es(r.memoizedState,s);if(i&&(r.memoizedState=s,Kn=!0),r=r.queue,By($k.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||Vt!==null&&Vt.memoizedState.tag&1){if(n.flags|=2048,nu(9,Ok.bind(null,n,r,s,e),void 0,null),Ht===null)throw Error(H(349));$a&30||Lk(n,e,s)}return s}function Lk(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=ot.updateQueue,e===null?(e={lastEffect:null,stores:null},ot.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function Ok(t,e,n,r){e.value=n,e.getSnapshot=r,zk(e)&&Bk(t)}function $k(t,e,n){return n(function(){zk(e)&&Bk(t)})}function zk(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!es(t,n)}catch{return!0}}function Bk(t){var e=ei(t,1);e!==null&&Yr(e,t,1,-1)}function W_(t){var e=ms();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:tu,lastRenderedState:t},e.queue=t,t=t.dispatch=e3.bind(null,ot,t),[e.memoizedState,t]}function nu(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=ot.updateQueue,e===null?(e={lastEffect:null,stores:null},ot.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function Vk(){return Fr().memoizedState}function ph(t,e,n,r){var s=ms();ot.flags|=t,s.memoizedState=nu(1|e,n,void 0,r===void 0?null:r)}function nm(t,e,n,r){var s=Fr();r=r===void 0?null:r;var i=void 0;if(Pt!==null){var o=Pt.memoizedState;if(i=o.destroy,r!==null&&Oy(r,o.deps)){s.memoizedState=nu(e,n,i,r);return}}ot.flags|=t,s.memoizedState=nu(1|e,n,i,r)}function q_(t,e){return ph(8390656,8,t,e)}function By(t,e){return nm(2048,8,t,e)}function Uk(t,e){return nm(4,2,t,e)}function Hk(t,e){return nm(4,4,t,e)}function Gk(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Wk(t,e,n){return n=n!=null?n.concat([t]):null,nm(4,4,Gk.bind(null,e,t),n)}function Vy(){}function qk(t,e){var n=Fr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Oy(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function Kk(t,e){var n=Fr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Oy(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Qk(t,e,n){return $a&21?(es(n,e)||(n=J2(),ot.lanes|=n,za|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Kn=!0),t.memoizedState=n)}function JP(t,e){var n=Ue;Ue=n!==0&&4>n?n:4,t(!0);var r=og.transition;og.transition={};try{t(!1),e()}finally{Ue=n,og.transition=r}}function Xk(){return Fr().memoizedState}function ZP(t,e,n){var r=Vi(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Yk(t))Jk(e,n);else if(n=Ik(t,e,n,r),n!==null){var s=Rn();Yr(n,t,r,s),Zk(n,e,r)}}function e3(t,e,n){var r=Vi(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Yk(t))Jk(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,l=i(o,n);if(s.hasEagerState=!0,s.eagerState=l,es(l,o)){var c=e.interleaved;c===null?(s.next=s,Py(e)):(s.next=c.next,c.next=s),e.interleaved=s;return}}catch{}finally{}n=Ik(t,e,s,r),n!==null&&(s=Rn(),Yr(n,t,r,s),Zk(n,e,r))}}function Yk(t){var e=t.alternate;return t===ot||e!==null&&e===ot}function Jk(t,e){Pc=Jh=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function Zk(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,vy(t,n)}}var Zh={readContext:Pr,useCallback:dn,useContext:dn,useEffect:dn,useImperativeHandle:dn,useInsertionEffect:dn,useLayoutEffect:dn,useMemo:dn,useReducer:dn,useRef:dn,useState:dn,useDebugValue:dn,useDeferredValue:dn,useTransition:dn,useMutableSource:dn,useSyncExternalStore:dn,useId:dn,unstable_isNewReconciler:!1},t3={readContext:Pr,useCallback:function(t,e){return ms().memoizedState=[t,e===void 0?null:e],t},useContext:Pr,useEffect:q_,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,ph(4194308,4,Gk.bind(null,e,t),n)},useLayoutEffect:function(t,e){return ph(4194308,4,t,e)},useInsertionEffect:function(t,e){return ph(4,2,t,e)},useMemo:function(t,e){var n=ms();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=ms();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=ZP.bind(null,ot,t),[r.memoizedState,t]},useRef:function(t){var e=ms();return t={current:t},e.memoizedState=t},useState:W_,useDebugValue:Vy,useDeferredValue:function(t){return ms().memoizedState=t},useTransition:function(){var t=W_(!1),e=t[0];return t=JP.bind(null,t[1]),ms().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=ot,s=ms();if(nt){if(n===void 0)throw Error(H(407));n=n()}else{if(n=e(),Ht===null)throw Error(H(349));$a&30||Lk(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,q_($k.bind(null,r,i,t),[t]),r.flags|=2048,nu(9,Ok.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=ms(),e=Ht.identifierPrefix;if(nt){var n=zs,r=$s;n=(r&~(1<<32-Xr(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=eu++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=YP++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},n3={readContext:Pr,useCallback:qk,useContext:Pr,useEffect:By,useImperativeHandle:Wk,useInsertionEffect:Uk,useLayoutEffect:Hk,useMemo:Kk,useReducer:lg,useRef:Vk,useState:function(){return lg(tu)},useDebugValue:Vy,useDeferredValue:function(t){var e=Fr();return Qk(e,Pt.memoizedState,t)},useTransition:function(){var t=lg(tu)[0],e=Fr().memoizedState;return[t,e]},useMutableSource:Mk,useSyncExternalStore:Dk,useId:Xk,unstable_isNewReconciler:!1},r3={readContext:Pr,useCallback:qk,useContext:Pr,useEffect:By,useImperativeHandle:Wk,useInsertionEffect:Uk,useLayoutEffect:Hk,useMemo:Kk,useReducer:cg,useRef:Vk,useState:function(){return cg(tu)},useDebugValue:Vy,useDeferredValue:function(t){var e=Fr();return Pt===null?e.memoizedState=t:Qk(e,Pt.memoizedState,t)},useTransition:function(){var t=cg(tu)[0],e=Fr().memoizedState;return[t,e]},useMutableSource:Mk,useSyncExternalStore:Dk,useId:Xk,unstable_isNewReconciler:!1};function cl(t,e){try{var n="",r=e;do n+=N5(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function ug(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function M0(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var s3=typeof WeakMap=="function"?WeakMap:Map;function ej(t,e,n){n=Ws(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){tf||(tf=!0,G0=r),M0(t,e)},n}function tj(t,e,n){n=Ws(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){M0(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){M0(t,e),typeof r!="function"&&(Bi===null?Bi=new Set([this]):Bi.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function K_(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new s3;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=y3.bind(null,t,e,n),e.then(t,t))}function Q_(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function X_(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Ws(-1,1),e.tag=2,zi(n,e,1))),n.lanes|=1),t)}var i3=li.ReactCurrentOwner,Kn=!1;function In(t,e,n,r){e.child=t===null?Pk(e,null,n,r):ol(e,t.child,n,r)}function Y_(t,e,n,r,s){n=n.render;var i=e.ref;return Yo(e,s),r=$y(t,e,n,r,i,s),n=zy(),t!==null&&!Kn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,ti(t,e,s)):(nt&&n&&Ty(e),e.flags|=1,In(t,e,r,s),e.child)}function J_(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!Xy(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,nj(t,e,i,r,s)):(t=vh(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Kc,n(o,r)&&t.ref===e.ref)return ti(t,e,s)}return e.flags|=1,t=Ui(i,r),t.ref=e.ref,t.return=e,e.child=t}function nj(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(Kc(i,r)&&t.ref===e.ref)if(Kn=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(Kn=!0);else return e.lanes=t.lanes,ti(t,e,s)}return D0(t,e,n,r,s)}function rj(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Xe(Uo,or),or|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Xe(Uo,or),or|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Xe(Uo,or),or|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,Xe(Uo,or),or|=r;return In(t,e,s,n),e.child}function sj(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function D0(t,e,n,r,s){var i=Xn(n)?La:wn.current;return i=il(e,i),Yo(e,s),n=$y(t,e,n,r,i,s),r=zy(),t!==null&&!Kn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,ti(t,e,s)):(nt&&r&&Ty(e),e.flags|=1,In(t,e,n,s),e.child)}function Z_(t,e,n,r,s){if(Xn(n)){var i=!0;Gh(e)}else i=!1;if(Yo(e,s),e.stateNode===null)gh(t,e),Nk(e,n,r),F0(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var c=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=Pr(u):(u=Xn(n)?La:wn.current,u=il(e,u));var d=n.getDerivedStateFromProps,m=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";m||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||c!==u)&&H_(e,o,r,u),ki=!1;var p=e.memoizedState;o.state=p,Xh(e,r,o,s),c=e.memoizedState,l!==r||p!==c||Qn.current||ki?(typeof d=="function"&&(P0(e,n,d,r),c=e.memoizedState),(l=ki||U_(e,n,l,r,p,c,u))?(m||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),o.props=r,o.state=c,o.context=u,r=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,Ck(t,e),l=e.memoizedProps,u=e.type===e.elementType?l:Hr(e.type,l),o.props=u,m=e.pendingProps,p=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=Pr(c):(c=Xn(n)?La:wn.current,c=il(e,c));var g=n.getDerivedStateFromProps;(d=typeof g=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==m||p!==c)&&H_(e,o,r,c),ki=!1,p=e.memoizedState,o.state=p,Xh(e,r,o,s);var x=e.memoizedState;l!==m||p!==x||Qn.current||ki?(typeof g=="function"&&(P0(e,n,g,r),x=e.memoizedState),(u=ki||U_(e,n,u,r,p,x,c)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,x,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,x,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=x),o.props=r,o.state=x,o.context=c,r=u):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),r=!1)}return L0(t,e,n,r,i,s)}function L0(t,e,n,r,s,i){sj(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&O_(e,n,!1),ti(t,e,i);r=e.stateNode,i3.current=e;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=ol(e,t.child,null,i),e.child=ol(e,null,l,i)):In(t,e,l,i),e.memoizedState=r.state,s&&O_(e,n,!0),e.child}function ij(t){var e=t.stateNode;e.pendingContext?L_(t,e.pendingContext,e.pendingContext!==e.context):e.context&&L_(t,e.context,!1),My(t,e.containerInfo)}function eS(t,e,n,r,s){return al(),Cy(s),e.flags|=256,In(t,e,n,r),e.child}var O0={dehydrated:null,treeContext:null,retryLane:0};function $0(t){return{baseLanes:t,cachePool:null,transitions:null}}function aj(t,e,n){var r=e.pendingProps,s=at.current,i=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Xe(at,s&1),t===null)return N0(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=im(o,r,0,null),t=Fa(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=$0(n),e.memoizedState=O0,t):Uy(e,o));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return a3(t,e,o,r,l,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,l=s.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=Ui(s,c),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=Ui(l,i):(i=Fa(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?$0(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=O0,r}return i=t.child,t=i.sibling,r=Ui(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Uy(t,e){return e=im({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function zd(t,e,n,r){return r!==null&&Cy(r),ol(e,t.child,null,n),t=Uy(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function a3(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=ug(Error(H(422))),zd(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=im({mode:"visible",children:r.children},s,0,null),i=Fa(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&ol(e,t.child,null,o),e.child.memoizedState=$0(o),e.memoizedState=O0,i);if(!(e.mode&1))return zd(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(H(419)),r=ug(i,r,void 0),zd(t,e,o,r)}if(l=(o&t.childLanes)!==0,Kn||l){if(r=Ht,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,ei(t,s),Yr(r,t,s,-1))}return Qy(),r=ug(Error(H(421))),zd(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=v3.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,ur=$i(s.nextSibling),fr=e,nt=!0,Wr=null,t!==null&&(Cr[Rr++]=$s,Cr[Rr++]=zs,Cr[Rr++]=Oa,$s=t.id,zs=t.overflow,Oa=e),e=Uy(e,r.children),e.flags|=4096,e)}function tS(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),A0(t.return,e,n)}function dg(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function oj(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(In(t,e,r.children,n),r=at.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&tS(t,n,e);else if(t.tag===19)tS(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Xe(at,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&Yh(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),dg(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&Yh(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}dg(e,!0,n,null,i);break;case"together":dg(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function gh(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function ti(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),za|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(H(153));if(e.child!==null){for(t=e.child,n=Ui(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Ui(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function o3(t,e,n){switch(e.tag){case 3:ij(e),al();break;case 5:Fk(e);break;case 1:Xn(e.type)&&Gh(e);break;case 4:My(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Xe(Kh,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Xe(at,at.current&1),e.flags|=128,null):n&e.child.childLanes?aj(t,e,n):(Xe(at,at.current&1),t=ti(t,e,n),t!==null?t.sibling:null);Xe(at,at.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return oj(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Xe(at,at.current),r)break;return null;case 22:case 23:return e.lanes=0,rj(t,e,n)}return ti(t,e,n)}var lj,z0,cj,uj;lj=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};z0=function(){};cj=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,Ca(vs.current);var i=null;switch(n){case"input":s=l0(t,s),r=l0(t,r),i=[];break;case"select":s=lt({},s,{value:void 0}),r=lt({},r,{value:void 0}),i=[];break;case"textarea":s=d0(t,s),r=d0(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Uh)}f0(n,r);var o;n=null;for(u in s)if(!r.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var l=s[u];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Bc.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in r){var c=r[u];if(l=s!=null?s[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(i||(i=[]),i.push(u,n)),n=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Bc.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&Je("scroll",t),i||l===c||(i=[])):(i=i||[]).push(u,c))}n&&(i=i||[]).push("style",n);var u=i;(e.updateQueue=u)&&(e.flags|=4)}};uj=function(t,e,n,r){n!==r&&(e.flags|=4)};function hc(t,e){if(!nt)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function hn(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function l3(t,e,n){var r=e.pendingProps;switch(Iy(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return hn(e),null;case 1:return Xn(e.type)&&Hh(),hn(e),null;case 3:return r=e.stateNode,ll(),Ze(Qn),Ze(wn),Ly(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Od(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Wr!==null&&(K0(Wr),Wr=null))),z0(t,e),hn(e),null;case 5:Dy(e);var s=Ca(Zc.current);if(n=e.type,t!==null&&e.stateNode!=null)cj(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(H(166));return hn(e),null}if(t=Ca(vs.current),Od(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[gs]=e,r[Yc]=i,t=(e.mode&1)!==0,n){case"dialog":Je("cancel",r),Je("close",r);break;case"iframe":case"object":case"embed":Je("load",r);break;case"video":case"audio":for(s=0;s<_c.length;s++)Je(_c[s],r);break;case"source":Je("error",r);break;case"img":case"image":case"link":Je("error",r),Je("load",r);break;case"details":Je("toggle",r);break;case"input":u_(r,i),Je("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Je("invalid",r);break;case"textarea":h_(r,i),Je("invalid",r)}f0(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&Ld(r.textContent,l,t),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&Ld(r.textContent,l,t),s=["children",""+l]):Bc.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Je("scroll",r)}switch(n){case"input":Cd(r),d_(r,i,!0);break;case"textarea":Cd(r),f_(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Uh)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=L2(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[gs]=e,t[Yc]=r,lj(t,e,!1,!1),e.stateNode=t;e:{switch(o=m0(n,r),n){case"dialog":Je("cancel",t),Je("close",t),s=r;break;case"iframe":case"object":case"embed":Je("load",t),s=r;break;case"video":case"audio":for(s=0;s<_c.length;s++)Je(_c[s],t);s=r;break;case"source":Je("error",t),s=r;break;case"img":case"image":case"link":Je("error",t),Je("load",t),s=r;break;case"details":Je("toggle",t),s=r;break;case"input":u_(t,r),s=l0(t,r),Je("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=lt({},r,{value:void 0}),Je("invalid",t);break;case"textarea":h_(t,r),s=d0(t,r),Je("invalid",t);break;default:s=r}f0(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?z2(t,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&O2(t,c)):i==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&Vc(t,c):typeof c=="number"&&Vc(t,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Bc.hasOwnProperty(i)?c!=null&&i==="onScroll"&&Je("scroll",t):c!=null&&fy(t,i,c,o))}switch(n){case"input":Cd(t),d_(t,r,!1);break;case"textarea":Cd(t),f_(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Qi(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?qo(t,!!r.multiple,i,!1):r.defaultValue!=null&&qo(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=Uh)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return hn(e),null;case 6:if(t&&e.stateNode!=null)uj(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(H(166));if(n=Ca(Zc.current),Ca(vs.current),Od(e)){if(r=e.stateNode,n=e.memoizedProps,r[gs]=e,(i=r.nodeValue!==n)&&(t=fr,t!==null))switch(t.tag){case 3:Ld(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Ld(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[gs]=e,e.stateNode=r}return hn(e),null;case 13:if(Ze(at),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(nt&&ur!==null&&e.mode&1&&!(e.flags&128))Tk(),al(),e.flags|=98560,i=!1;else if(i=Od(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(H(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(H(317));i[gs]=e}else al(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;hn(e),i=!1}else Wr!==null&&(K0(Wr),Wr=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||at.current&1?Ft===0&&(Ft=3):Qy())),e.updateQueue!==null&&(e.flags|=4),hn(e),null);case 4:return ll(),z0(t,e),t===null&&Qc(e.stateNode.containerInfo),hn(e),null;case 10:return Ay(e.type._context),hn(e),null;case 17:return Xn(e.type)&&Hh(),hn(e),null;case 19:if(Ze(at),i=e.memoizedState,i===null)return hn(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)hc(i,!1);else{if(Ft!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Yh(t),o!==null){for(e.flags|=128,hc(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Xe(at,at.current&1|2),e.child}t=t.sibling}i.tail!==null&&yt()>ul&&(e.flags|=128,r=!0,hc(i,!1),e.lanes=4194304)}else{if(!r)if(t=Yh(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),hc(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!nt)return hn(e),null}else 2*yt()-i.renderingStartTime>ul&&n!==1073741824&&(e.flags|=128,r=!0,hc(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=yt(),e.sibling=null,n=at.current,Xe(at,r?n&1|2:n&1),e):(hn(e),null);case 22:case 23:return Ky(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?or&1073741824&&(hn(e),e.subtreeFlags&6&&(e.flags|=8192)):hn(e),null;case 24:return null;case 25:return null}throw Error(H(156,e.tag))}function c3(t,e){switch(Iy(e),e.tag){case 1:return Xn(e.type)&&Hh(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return ll(),Ze(Qn),Ze(wn),Ly(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Dy(e),null;case 13:if(Ze(at),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(H(340));al()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ze(at),null;case 4:return ll(),null;case 10:return Ay(e.type._context),null;case 22:case 23:return Ky(),null;case 24:return null;default:return null}}var Bd=!1,gn=!1,u3=typeof WeakSet=="function"?WeakSet:Set,K=null;function Vo(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){ht(t,e,r)}else n.current=null}function B0(t,e,n){try{n()}catch(r){ht(t,e,r)}}var nS=!1;function d3(t,e){if(E0=zh,t=mk(),jy(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,l=-1,c=-1,u=0,d=0,m=t,p=null;t:for(;;){for(var g;m!==n||s!==0&&m.nodeType!==3||(l=o+s),m!==i||r!==0&&m.nodeType!==3||(c=o+r),m.nodeType===3&&(o+=m.nodeValue.length),(g=m.firstChild)!==null;)p=m,m=g;for(;;){if(m===t)break t;if(p===n&&++u===s&&(l=o),p===i&&++d===r&&(c=o),(g=m.nextSibling)!==null)break;m=p,p=m.parentNode}m=g}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(k0={focusedElem:t,selectionRange:n},zh=!1,K=e;K!==null;)if(e=K,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,K=t;else for(;K!==null;){e=K;try{var x=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var w=x.memoizedProps,v=x.memoizedState,S=e.stateNode,_=S.getSnapshotBeforeUpdate(e.elementType===e.type?w:Hr(e.type,w),v);S.__reactInternalSnapshotBeforeUpdate=_}break;case 3:var E=e.stateNode.containerInfo;E.nodeType===1?E.textContent="":E.nodeType===9&&E.documentElement&&E.removeChild(E.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(H(163))}}catch(I){ht(e,e.return,I)}if(t=e.sibling,t!==null){t.return=e.return,K=t;break}K=e.return}return x=nS,nS=!1,x}function Fc(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&B0(e,n,i)}s=s.next}while(s!==r)}}function rm(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function V0(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function dj(t){var e=t.alternate;e!==null&&(t.alternate=null,dj(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[gs],delete e[Yc],delete e[I0],delete e[qP],delete e[KP])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function hj(t){return t.tag===5||t.tag===3||t.tag===4}function rS(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||hj(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function U0(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Uh));else if(r!==4&&(t=t.child,t!==null))for(U0(t,e,n),t=t.sibling;t!==null;)U0(t,e,n),t=t.sibling}function H0(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(H0(t,e,n),t=t.sibling;t!==null;)H0(t,e,n),t=t.sibling}var Jt=null,Gr=!1;function _i(t,e,n){for(n=n.child;n!==null;)fj(t,e,n),n=n.sibling}function fj(t,e,n){if(ys&&typeof ys.onCommitFiberUnmount=="function")try{ys.onCommitFiberUnmount(Qf,n)}catch{}switch(n.tag){case 5:gn||Vo(n,e);case 6:var r=Jt,s=Gr;Jt=null,_i(t,e,n),Jt=r,Gr=s,Jt!==null&&(Gr?(t=Jt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Jt.removeChild(n.stateNode));break;case 18:Jt!==null&&(Gr?(t=Jt,n=n.stateNode,t.nodeType===8?sg(t.parentNode,n):t.nodeType===1&&sg(t,n),Wc(t)):sg(Jt,n.stateNode));break;case 4:r=Jt,s=Gr,Jt=n.stateNode.containerInfo,Gr=!0,_i(t,e,n),Jt=r,Gr=s;break;case 0:case 11:case 14:case 15:if(!gn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&B0(n,e,o),s=s.next}while(s!==r)}_i(t,e,n);break;case 1:if(!gn&&(Vo(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){ht(n,e,l)}_i(t,e,n);break;case 21:_i(t,e,n);break;case 22:n.mode&1?(gn=(r=gn)||n.memoizedState!==null,_i(t,e,n),gn=r):_i(t,e,n);break;default:_i(t,e,n)}}function sS(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new u3),e.forEach(function(r){var s=w3.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Vr(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:Jt=l.stateNode,Gr=!1;break e;case 3:Jt=l.stateNode.containerInfo,Gr=!0;break e;case 4:Jt=l.stateNode.containerInfo,Gr=!0;break e}l=l.return}if(Jt===null)throw Error(H(160));fj(i,o,s),Jt=null,Gr=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(u){ht(s,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)mj(e,t),e=e.sibling}function mj(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Vr(e,t),ls(t),r&4){try{Fc(3,t,t.return),rm(3,t)}catch(w){ht(t,t.return,w)}try{Fc(5,t,t.return)}catch(w){ht(t,t.return,w)}}break;case 1:Vr(e,t),ls(t),r&512&&n!==null&&Vo(n,n.return);break;case 5:if(Vr(e,t),ls(t),r&512&&n!==null&&Vo(n,n.return),t.flags&32){var s=t.stateNode;try{Vc(s,"")}catch(w){ht(t,t.return,w)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&M2(s,i),m0(l,o);var u=m0(l,i);for(o=0;o<c.length;o+=2){var d=c[o],m=c[o+1];d==="style"?z2(s,m):d==="dangerouslySetInnerHTML"?O2(s,m):d==="children"?Vc(s,m):fy(s,d,m,u)}switch(l){case"input":c0(s,i);break;case"textarea":D2(s,i);break;case"select":var p=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var g=i.value;g!=null?qo(s,!!i.multiple,g,!1):p!==!!i.multiple&&(i.defaultValue!=null?qo(s,!!i.multiple,i.defaultValue,!0):qo(s,!!i.multiple,i.multiple?[]:"",!1))}s[Yc]=i}catch(w){ht(t,t.return,w)}}break;case 6:if(Vr(e,t),ls(t),r&4){if(t.stateNode===null)throw Error(H(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(w){ht(t,t.return,w)}}break;case 3:if(Vr(e,t),ls(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Wc(e.containerInfo)}catch(w){ht(t,t.return,w)}break;case 4:Vr(e,t),ls(t);break;case 13:Vr(e,t),ls(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Wy=yt())),r&4&&sS(t);break;case 22:if(d=n!==null&&n.memoizedState!==null,t.mode&1?(gn=(u=gn)||d,Vr(e,t),gn=u):Vr(e,t),ls(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!d&&t.mode&1)for(K=t,d=t.child;d!==null;){for(m=K=d;K!==null;){switch(p=K,g=p.child,p.tag){case 0:case 11:case 14:case 15:Fc(4,p,p.return);break;case 1:Vo(p,p.return);var x=p.stateNode;if(typeof x.componentWillUnmount=="function"){r=p,n=p.return;try{e=r,x.props=e.memoizedProps,x.state=e.memoizedState,x.componentWillUnmount()}catch(w){ht(r,n,w)}}break;case 5:Vo(p,p.return);break;case 22:if(p.memoizedState!==null){aS(m);continue}}g!==null?(g.return=p,K=g):aS(m)}d=d.sibling}e:for(d=null,m=t;;){if(m.tag===5){if(d===null){d=m;try{s=m.stateNode,u?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=m.stateNode,c=m.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=$2("display",o))}catch(w){ht(t,t.return,w)}}}else if(m.tag===6){if(d===null)try{m.stateNode.nodeValue=u?"":m.memoizedProps}catch(w){ht(t,t.return,w)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===t)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===t)break e;for(;m.sibling===null;){if(m.return===null||m.return===t)break e;d===m&&(d=null),m=m.return}d===m&&(d=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:Vr(e,t),ls(t),r&4&&sS(t);break;case 21:break;default:Vr(e,t),ls(t)}}function ls(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(hj(n)){var r=n;break e}n=n.return}throw Error(H(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Vc(s,""),r.flags&=-33);var i=rS(t);H0(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,l=rS(t);U0(t,l,o);break;default:throw Error(H(161))}}catch(c){ht(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function h3(t,e,n){K=t,pj(t)}function pj(t,e,n){for(var r=(t.mode&1)!==0;K!==null;){var s=K,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||Bd;if(!o){var l=s.alternate,c=l!==null&&l.memoizedState!==null||gn;l=Bd;var u=gn;if(Bd=o,(gn=c)&&!u)for(K=s;K!==null;)o=K,c=o.child,o.tag===22&&o.memoizedState!==null?oS(s):c!==null?(c.return=o,K=c):oS(s);for(;i!==null;)K=i,pj(i),i=i.sibling;K=s,Bd=l,gn=u}iS(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,K=i):iS(t)}}function iS(t){for(;K!==null;){var e=K;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:gn||rm(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!gn)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:Hr(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&V_(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}V_(e,o,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var m=d.dehydrated;m!==null&&Wc(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(H(163))}gn||e.flags&512&&V0(e)}catch(p){ht(e,e.return,p)}}if(e===t){K=null;break}if(n=e.sibling,n!==null){n.return=e.return,K=n;break}K=e.return}}function aS(t){for(;K!==null;){var e=K;if(e===t){K=null;break}var n=e.sibling;if(n!==null){n.return=e.return,K=n;break}K=e.return}}function oS(t){for(;K!==null;){var e=K;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{rm(4,e)}catch(c){ht(e,n,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(c){ht(e,s,c)}}var i=e.return;try{V0(e)}catch(c){ht(e,i,c)}break;case 5:var o=e.return;try{V0(e)}catch(c){ht(e,o,c)}}}catch(c){ht(e,e.return,c)}if(e===t){K=null;break}var l=e.sibling;if(l!==null){l.return=e.return,K=l;break}K=e.return}}var f3=Math.ceil,ef=li.ReactCurrentDispatcher,Hy=li.ReactCurrentOwner,Ar=li.ReactCurrentBatchConfig,De=0,Ht=null,kt=null,nn=0,or=0,Uo=sa(0),Ft=0,ru=null,za=0,sm=0,Gy=0,Mc=null,Wn=null,Wy=0,ul=1/0,Ms=null,tf=!1,G0=null,Bi=null,Vd=!1,Pi=null,nf=0,Dc=0,W0=null,xh=-1,yh=0;function Rn(){return De&6?yt():xh!==-1?xh:xh=yt()}function Vi(t){return t.mode&1?De&2&&nn!==0?nn&-nn:XP.transition!==null?(yh===0&&(yh=J2()),yh):(t=Ue,t!==0||(t=window.event,t=t===void 0?16:ik(t.type)),t):1}function Yr(t,e,n,r){if(50<Dc)throw Dc=0,W0=null,Error(H(185));ju(t,n,r),(!(De&2)||t!==Ht)&&(t===Ht&&(!(De&2)&&(sm|=n),Ft===4&&Ti(t,nn)),Yn(t,r),n===1&&De===0&&!(e.mode&1)&&(ul=yt()+500,em&&ia()))}function Yn(t,e){var n=t.callbackNode;X5(t,e);var r=$h(t,t===Ht?nn:0);if(r===0)n!==null&&g_(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&g_(n),e===1)t.tag===0?QP(lS.bind(null,t)):Ek(lS.bind(null,t)),GP(function(){!(De&6)&&ia()}),n=null;else{switch(Z2(r)){case 1:n=yy;break;case 4:n=X2;break;case 16:n=Oh;break;case 536870912:n=Y2;break;default:n=Oh}n=bj(n,gj.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function gj(t,e){if(xh=-1,yh=0,De&6)throw Error(H(327));var n=t.callbackNode;if(Jo()&&t.callbackNode!==n)return null;var r=$h(t,t===Ht?nn:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=rf(t,r);else{e=r;var s=De;De|=2;var i=yj();(Ht!==t||nn!==e)&&(Ms=null,ul=yt()+500,Pa(t,e));do try{g3();break}catch(l){xj(t,l)}while(1);Ny(),ef.current=i,De=s,kt!==null?e=0:(Ht=null,nn=0,e=Ft)}if(e!==0){if(e===2&&(s=v0(t),s!==0&&(r=s,e=q0(t,s))),e===1)throw n=ru,Pa(t,0),Ti(t,r),Yn(t,yt()),n;if(e===6)Ti(t,r);else{if(s=t.current.alternate,!(r&30)&&!m3(s)&&(e=rf(t,r),e===2&&(i=v0(t),i!==0&&(r=i,e=q0(t,i))),e===1))throw n=ru,Pa(t,0),Ti(t,r),Yn(t,yt()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(H(345));case 2:Sa(t,Wn,Ms);break;case 3:if(Ti(t,r),(r&130023424)===r&&(e=Wy+500-yt(),10<e)){if($h(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){Rn(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=T0(Sa.bind(null,t,Wn,Ms),e);break}Sa(t,Wn,Ms);break;case 4:if(Ti(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-Xr(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=yt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*f3(r/1960))-r,10<r){t.timeoutHandle=T0(Sa.bind(null,t,Wn,Ms),r);break}Sa(t,Wn,Ms);break;case 5:Sa(t,Wn,Ms);break;default:throw Error(H(329))}}}return Yn(t,yt()),t.callbackNode===n?gj.bind(null,t):null}function q0(t,e){var n=Mc;return t.current.memoizedState.isDehydrated&&(Pa(t,e).flags|=256),t=rf(t,e),t!==2&&(e=Wn,Wn=n,e!==null&&K0(e)),t}function K0(t){Wn===null?Wn=t:Wn.push.apply(Wn,t)}function m3(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!es(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Ti(t,e){for(e&=~Gy,e&=~sm,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Xr(e),r=1<<n;t[n]=-1,e&=~r}}function lS(t){if(De&6)throw Error(H(327));Jo();var e=$h(t,0);if(!(e&1))return Yn(t,yt()),null;var n=rf(t,e);if(t.tag!==0&&n===2){var r=v0(t);r!==0&&(e=r,n=q0(t,r))}if(n===1)throw n=ru,Pa(t,0),Ti(t,e),Yn(t,yt()),n;if(n===6)throw Error(H(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Sa(t,Wn,Ms),Yn(t,yt()),null}function qy(t,e){var n=De;De|=1;try{return t(e)}finally{De=n,De===0&&(ul=yt()+500,em&&ia())}}function Ba(t){Pi!==null&&Pi.tag===0&&!(De&6)&&Jo();var e=De;De|=1;var n=Ar.transition,r=Ue;try{if(Ar.transition=null,Ue=1,t)return t()}finally{Ue=r,Ar.transition=n,De=e,!(De&6)&&ia()}}function Ky(){or=Uo.current,Ze(Uo)}function Pa(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,HP(n)),kt!==null)for(n=kt.return;n!==null;){var r=n;switch(Iy(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Hh();break;case 3:ll(),Ze(Qn),Ze(wn),Ly();break;case 5:Dy(r);break;case 4:ll();break;case 13:Ze(at);break;case 19:Ze(at);break;case 10:Ay(r.type._context);break;case 22:case 23:Ky()}n=n.return}if(Ht=t,kt=t=Ui(t.current,null),nn=or=e,Ft=0,ru=null,Gy=sm=za=0,Wn=Mc=null,Ia!==null){for(e=0;e<Ia.length;e++)if(n=Ia[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}Ia=null}return t}function xj(t,e){do{var n=kt;try{if(Ny(),mh.current=Zh,Jh){for(var r=ot.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Jh=!1}if($a=0,Vt=Pt=ot=null,Pc=!1,eu=0,Hy.current=null,n===null||n.return===null){Ft=1,ru=e,kt=null;break}e:{var i=t,o=n.return,l=n,c=e;if(e=nn,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=l,m=d.tag;if(!(d.mode&1)&&(m===0||m===11||m===15)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var g=Q_(o);if(g!==null){g.flags&=-257,X_(g,o,l,i,e),g.mode&1&&K_(i,u,e),e=g,c=u;var x=e.updateQueue;if(x===null){var w=new Set;w.add(c),e.updateQueue=w}else x.add(c);break e}else{if(!(e&1)){K_(i,u,e),Qy();break e}c=Error(H(426))}}else if(nt&&l.mode&1){var v=Q_(o);if(v!==null){!(v.flags&65536)&&(v.flags|=256),X_(v,o,l,i,e),Cy(cl(c,l));break e}}i=c=cl(c,l),Ft!==4&&(Ft=2),Mc===null?Mc=[i]:Mc.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var S=ej(i,c,e);B_(i,S);break e;case 1:l=c;var _=i.type,E=i.stateNode;if(!(i.flags&128)&&(typeof _.getDerivedStateFromError=="function"||E!==null&&typeof E.componentDidCatch=="function"&&(Bi===null||!Bi.has(E)))){i.flags|=65536,e&=-e,i.lanes|=e;var I=tj(i,l,e);B_(i,I);break e}}i=i.return}while(i!==null)}wj(n)}catch(P){e=P,kt===n&&n!==null&&(kt=n=n.return);continue}break}while(1)}function yj(){var t=ef.current;return ef.current=Zh,t===null?Zh:t}function Qy(){(Ft===0||Ft===3||Ft===2)&&(Ft=4),Ht===null||!(za&268435455)&&!(sm&268435455)||Ti(Ht,nn)}function rf(t,e){var n=De;De|=2;var r=yj();(Ht!==t||nn!==e)&&(Ms=null,Pa(t,e));do try{p3();break}catch(s){xj(t,s)}while(1);if(Ny(),De=n,ef.current=r,kt!==null)throw Error(H(261));return Ht=null,nn=0,Ft}function p3(){for(;kt!==null;)vj(kt)}function g3(){for(;kt!==null&&!B5();)vj(kt)}function vj(t){var e=Sj(t.alternate,t,or);t.memoizedProps=t.pendingProps,e===null?wj(t):kt=e,Hy.current=null}function wj(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=c3(n,e),n!==null){n.flags&=32767,kt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Ft=6,kt=null;return}}else if(n=l3(n,e,or),n!==null){kt=n;return}if(e=e.sibling,e!==null){kt=e;return}kt=e=t}while(e!==null);Ft===0&&(Ft=5)}function Sa(t,e,n){var r=Ue,s=Ar.transition;try{Ar.transition=null,Ue=1,x3(t,e,n,r)}finally{Ar.transition=s,Ue=r}return null}function x3(t,e,n,r){do Jo();while(Pi!==null);if(De&6)throw Error(H(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(H(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(Y5(t,i),t===Ht&&(kt=Ht=null,nn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Vd||(Vd=!0,bj(Oh,function(){return Jo(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=Ar.transition,Ar.transition=null;var o=Ue;Ue=1;var l=De;De|=4,Hy.current=null,d3(t,n),mj(n,t),LP(k0),zh=!!E0,k0=E0=null,t.current=n,h3(n),V5(),De=l,Ue=o,Ar.transition=i}else t.current=n;if(Vd&&(Vd=!1,Pi=t,nf=s),i=t.pendingLanes,i===0&&(Bi=null),G5(n.stateNode),Yn(t,yt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(tf)throw tf=!1,t=G0,G0=null,t;return nf&1&&t.tag!==0&&Jo(),i=t.pendingLanes,i&1?t===W0?Dc++:(Dc=0,W0=t):Dc=0,ia(),null}function Jo(){if(Pi!==null){var t=Z2(nf),e=Ar.transition,n=Ue;try{if(Ar.transition=null,Ue=16>t?16:t,Pi===null)var r=!1;else{if(t=Pi,Pi=null,nf=0,De&6)throw Error(H(331));var s=De;for(De|=4,K=t.current;K!==null;){var i=K,o=i.child;if(K.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(K=u;K!==null;){var d=K;switch(d.tag){case 0:case 11:case 15:Fc(8,d,i)}var m=d.child;if(m!==null)m.return=d,K=m;else for(;K!==null;){d=K;var p=d.sibling,g=d.return;if(dj(d),d===u){K=null;break}if(p!==null){p.return=g,K=p;break}K=g}}}var x=i.alternate;if(x!==null){var w=x.child;if(w!==null){x.child=null;do{var v=w.sibling;w.sibling=null,w=v}while(w!==null)}}K=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,K=o;else e:for(;K!==null;){if(i=K,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Fc(9,i,i.return)}var S=i.sibling;if(S!==null){S.return=i.return,K=S;break e}K=i.return}}var _=t.current;for(K=_;K!==null;){o=K;var E=o.child;if(o.subtreeFlags&2064&&E!==null)E.return=o,K=E;else e:for(o=_;K!==null;){if(l=K,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:rm(9,l)}}catch(P){ht(l,l.return,P)}if(l===o){K=null;break e}var I=l.sibling;if(I!==null){I.return=l.return,K=I;break e}K=l.return}}if(De=s,ia(),ys&&typeof ys.onPostCommitFiberRoot=="function")try{ys.onPostCommitFiberRoot(Qf,t)}catch{}r=!0}return r}finally{Ue=n,Ar.transition=e}}return!1}function cS(t,e,n){e=cl(n,e),e=ej(t,e,1),t=zi(t,e,1),e=Rn(),t!==null&&(ju(t,1,e),Yn(t,e))}function ht(t,e,n){if(t.tag===3)cS(t,t,n);else for(;e!==null;){if(e.tag===3){cS(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Bi===null||!Bi.has(r))){t=cl(n,t),t=tj(e,t,1),e=zi(e,t,1),t=Rn(),e!==null&&(ju(e,1,t),Yn(e,t));break}}e=e.return}}function y3(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Rn(),t.pingedLanes|=t.suspendedLanes&n,Ht===t&&(nn&n)===n&&(Ft===4||Ft===3&&(nn&130023424)===nn&&500>yt()-Wy?Pa(t,0):Gy|=n),Yn(t,e)}function _j(t,e){e===0&&(t.mode&1?(e=Ad,Ad<<=1,!(Ad&130023424)&&(Ad=4194304)):e=1);var n=Rn();t=ei(t,e),t!==null&&(ju(t,e,n),Yn(t,n))}function v3(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),_j(t,n)}function w3(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(H(314))}r!==null&&r.delete(e),_j(t,n)}var Sj;Sj=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Qn.current)Kn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Kn=!1,o3(t,e,n);Kn=!!(t.flags&131072)}else Kn=!1,nt&&e.flags&1048576&&kk(e,qh,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;gh(t,e),t=e.pendingProps;var s=il(e,wn.current);Yo(e,n),s=$y(null,e,r,t,s,n);var i=zy();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Xn(r)?(i=!0,Gh(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Fy(e),s.updater=tm,e.stateNode=s,s._reactInternals=e,F0(e,r,t,n),e=L0(null,e,r,!0,i,n)):(e.tag=0,nt&&i&&Ty(e),In(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(gh(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=S3(r),t=Hr(r,t),s){case 0:e=D0(null,e,r,t,n);break e;case 1:e=Z_(null,e,r,t,n);break e;case 11:e=Y_(null,e,r,t,n);break e;case 14:e=J_(null,e,r,Hr(r.type,t),n);break e}throw Error(H(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Hr(r,s),D0(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Hr(r,s),Z_(t,e,r,s,n);case 3:e:{if(ij(e),t===null)throw Error(H(387));r=e.pendingProps,i=e.memoizedState,s=i.element,Ck(t,e),Xh(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=cl(Error(H(423)),e),e=eS(t,e,r,n,s);break e}else if(r!==s){s=cl(Error(H(424)),e),e=eS(t,e,r,n,s);break e}else for(ur=$i(e.stateNode.containerInfo.firstChild),fr=e,nt=!0,Wr=null,n=Pk(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(al(),r===s){e=ti(t,e,n);break e}In(t,e,r,n)}e=e.child}return e;case 5:return Fk(e),t===null&&N0(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,j0(r,s)?o=null:i!==null&&j0(r,i)&&(e.flags|=32),sj(t,e),In(t,e,o,n),e.child;case 6:return t===null&&N0(e),null;case 13:return aj(t,e,n);case 4:return My(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=ol(e,null,r,n):In(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Hr(r,s),Y_(t,e,r,s,n);case 7:return In(t,e,e.pendingProps,n),e.child;case 8:return In(t,e,e.pendingProps.children,n),e.child;case 12:return In(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,Xe(Kh,r._currentValue),r._currentValue=o,i!==null)if(es(i.value,o)){if(i.children===s.children&&!Qn.current){e=ti(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(i.tag===1){c=Ws(-1,n&-n),c.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}i.lanes|=n,c=i.alternate,c!==null&&(c.lanes|=n),A0(i.return,n,e),l.lanes|=n;break}c=c.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(H(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),A0(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}In(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Yo(e,n),s=Pr(s),r=r(s),e.flags|=1,In(t,e,r,n),e.child;case 14:return r=e.type,s=Hr(r,e.pendingProps),s=Hr(r.type,s),J_(t,e,r,s,n);case 15:return nj(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Hr(r,s),gh(t,e),e.tag=1,Xn(r)?(t=!0,Gh(e)):t=!1,Yo(e,n),Nk(e,r,s),F0(e,r,s,n),L0(null,e,r,!0,t,n);case 19:return oj(t,e,n);case 22:return rj(t,e,n)}throw Error(H(156,e.tag))};function bj(t,e){return Q2(t,e)}function _3(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Nr(t,e,n,r){return new _3(t,e,n,r)}function Xy(t){return t=t.prototype,!(!t||!t.isReactComponent)}function S3(t){if(typeof t=="function")return Xy(t)?1:0;if(t!=null){if(t=t.$$typeof,t===py)return 11;if(t===gy)return 14}return 2}function Ui(t,e){var n=t.alternate;return n===null?(n=Nr(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function vh(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")Xy(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Po:return Fa(n.children,s,i,e);case my:o=8,s|=8;break;case s0:return t=Nr(12,n,e,s|2),t.elementType=s0,t.lanes=i,t;case i0:return t=Nr(13,n,e,s),t.elementType=i0,t.lanes=i,t;case a0:return t=Nr(19,n,e,s),t.elementType=a0,t.lanes=i,t;case A2:return im(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case R2:o=10;break e;case N2:o=9;break e;case py:o=11;break e;case gy:o=14;break e;case Ei:o=16,r=null;break e}throw Error(H(130,t==null?t:typeof t,""))}return e=Nr(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function Fa(t,e,n,r){return t=Nr(7,t,r,e),t.lanes=n,t}function im(t,e,n,r){return t=Nr(22,t,r,e),t.elementType=A2,t.lanes=n,t.stateNode={isHidden:!1},t}function hg(t,e,n){return t=Nr(6,t,null,e),t.lanes=n,t}function fg(t,e,n){return e=Nr(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function b3(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=qp(0),this.expirationTimes=qp(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=qp(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Yy(t,e,n,r,s,i,o,l,c){return t=new b3(t,e,n,l,c),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Nr(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Fy(i),t}function E3(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ao,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function Ej(t){if(!t)return Xi;t=t._reactInternals;e:{if(ro(t)!==t||t.tag!==1)throw Error(H(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Xn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(H(171))}if(t.tag===1){var n=t.type;if(Xn(n))return bk(t,n,e)}return e}function kj(t,e,n,r,s,i,o,l,c){return t=Yy(n,r,!0,t,s,i,o,l,c),t.context=Ej(null),n=t.current,r=Rn(),s=Vi(n),i=Ws(r,s),i.callback=e??null,zi(n,i,s),t.current.lanes=s,ju(t,s,r),Yn(t,r),t}function am(t,e,n,r){var s=e.current,i=Rn(),o=Vi(s);return n=Ej(n),e.context===null?e.context=n:e.pendingContext=n,e=Ws(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=zi(s,e,o),t!==null&&(Yr(t,s,o,i),fh(t,s,o)),o}function sf(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function uS(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Jy(t,e){uS(t,e),(t=t.alternate)&&uS(t,e)}function k3(){return null}var jj=typeof reportError=="function"?reportError:function(t){console.error(t)};function Zy(t){this._internalRoot=t}om.prototype.render=Zy.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(H(409));am(t,e,null,null)};om.prototype.unmount=Zy.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Ba(function(){am(null,t,null,null)}),e[Zs]=null}};function om(t){this._internalRoot=t}om.prototype.unstable_scheduleHydration=function(t){if(t){var e=nk();t={blockedOn:null,target:t,priority:e};for(var n=0;n<ji.length&&e!==0&&e<ji[n].priority;n++);ji.splice(n,0,t),n===0&&sk(t)}};function ev(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function lm(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function dS(){}function j3(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var u=sf(o);i.call(u)}}var o=kj(e,r,t,0,null,!1,!1,"",dS);return t._reactRootContainer=o,t[Zs]=o.current,Qc(t.nodeType===8?t.parentNode:t),Ba(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var u=sf(c);l.call(u)}}var c=Yy(t,0,!1,null,null,!1,!1,"",dS);return t._reactRootContainer=c,t[Zs]=c.current,Qc(t.nodeType===8?t.parentNode:t),Ba(function(){am(e,c,n,r)}),c}function cm(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var l=s;s=function(){var c=sf(o);l.call(c)}}am(e,o,t,s)}else o=j3(n,e,t,s,r);return sf(o)}ek=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=wc(e.pendingLanes);n!==0&&(vy(e,n|1),Yn(e,yt()),!(De&6)&&(ul=yt()+500,ia()))}break;case 13:Ba(function(){var r=ei(t,1);if(r!==null){var s=Rn();Yr(r,t,1,s)}}),Jy(t,1)}};wy=function(t){if(t.tag===13){var e=ei(t,134217728);if(e!==null){var n=Rn();Yr(e,t,134217728,n)}Jy(t,134217728)}};tk=function(t){if(t.tag===13){var e=Vi(t),n=ei(t,e);if(n!==null){var r=Rn();Yr(n,t,e,r)}Jy(t,e)}};nk=function(){return Ue};rk=function(t,e){var n=Ue;try{return Ue=t,e()}finally{Ue=n}};g0=function(t,e,n){switch(e){case"input":if(c0(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=Zf(r);if(!s)throw Error(H(90));F2(r),c0(r,s)}}}break;case"textarea":D2(t,n);break;case"select":e=n.value,e!=null&&qo(t,!!n.multiple,e,!1)}};U2=qy;H2=Ba;var T3={usingClientEntryPoint:!1,Events:[Iu,Lo,Zf,B2,V2,qy]},fc={findFiberByHostInstance:Ta,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},I3={bundleType:fc.bundleType,version:fc.version,rendererPackageName:fc.rendererPackageName,rendererConfig:fc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:li.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=q2(t),t===null?null:t.stateNode},findFiberByHostInstance:fc.findFiberByHostInstance||k3,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ud=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ud.isDisabled&&Ud.supportsFiber)try{Qf=Ud.inject(I3),ys=Ud}catch{}}vr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=T3;vr.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ev(e))throw Error(H(200));return E3(t,e,null,n)};vr.createRoot=function(t,e){if(!ev(t))throw Error(H(299));var n=!1,r="",s=jj;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Yy(t,1,!1,null,null,n,!1,r,s),t[Zs]=e.current,Qc(t.nodeType===8?t.parentNode:t),new Zy(e)};vr.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(H(188)):(t=Object.keys(t).join(","),Error(H(268,t)));return t=q2(e),t=t===null?null:t.stateNode,t};vr.flushSync=function(t){return Ba(t)};vr.hydrate=function(t,e,n){if(!lm(e))throw Error(H(200));return cm(null,t,e,!0,n)};vr.hydrateRoot=function(t,e,n){if(!ev(t))throw Error(H(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=jj;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=kj(e,null,t,1,n??null,s,!1,i,o),t[Zs]=e.current,Qc(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new om(e)};vr.render=function(t,e,n){if(!lm(e))throw Error(H(200));return cm(null,t,e,!1,n)};vr.unmountComponentAtNode=function(t){if(!lm(t))throw Error(H(40));return t._reactRootContainer?(Ba(function(){cm(null,null,t,!1,function(){t._reactRootContainer=null,t[Zs]=null})}),!0):!1};vr.unstable_batchedUpdates=qy;vr.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!lm(n))throw Error(H(200));if(t==null||t._reactInternals===void 0)throw Error(H(38));return cm(t,e,n,!1,r)};vr.version="18.2.0-next-9e3b772b8-20220608";function Tj(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Tj)}catch(t){console.error(t)}}Tj(),k2.exports=vr;var so=k2.exports,hS=so;n0.createRoot=hS.createRoot,n0.hydrateRoot=hS.hydrateRoot;/**
 * @remix-run/router v1.7.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function su(){return su=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},su.apply(this,arguments)}var Fi;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Fi||(Fi={}));const fS="popstate";function C3(t){t===void 0&&(t={});function e(s,i){let{pathname:o="/",search:l="",hash:c=""}=io(s.location.hash.substr(1));return Q0("",{pathname:o,search:l,hash:c},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(s,i){let o=s.document.querySelector("base"),l="";if(o&&o.getAttribute("href")){let c=s.location.href,u=c.indexOf("#");l=u===-1?c:c.slice(0,u)}return l+"#"+(typeof i=="string"?i:af(i))}function r(s,i){um(s.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(i)+")")}return N3(e,n,r,t)}function wt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function um(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function R3(){return Math.random().toString(36).substr(2,8)}function mS(t,e){return{usr:t.state,key:t.key,idx:e}}function Q0(t,e,n,r){return n===void 0&&(n=null),su({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?io(e):e,{state:n,key:e&&e.key||r||R3()})}function af(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function io(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function N3(t,e,n,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:i=!1}=r,o=s.history,l=Fi.Pop,c=null,u=d();u==null&&(u=0,o.replaceState(su({},o.state,{idx:u}),""));function d(){return(o.state||{idx:null}).idx}function m(){l=Fi.Pop;let v=d(),S=v==null?null:v-u;u=v,c&&c({action:l,location:w.location,delta:S})}function p(v,S){l=Fi.Push;let _=Q0(w.location,v,S);n&&n(_,v),u=d()+1;let E=mS(_,u),I=w.createHref(_);try{o.pushState(E,"",I)}catch(P){if(P instanceof DOMException&&P.name==="DataCloneError")throw P;s.location.assign(I)}i&&c&&c({action:l,location:w.location,delta:1})}function g(v,S){l=Fi.Replace;let _=Q0(w.location,v,S);n&&n(_,v),u=d();let E=mS(_,u),I=w.createHref(_);o.replaceState(E,"",I),i&&c&&c({action:l,location:w.location,delta:0})}function x(v){let S=s.location.origin!=="null"?s.location.origin:s.location.href,_=typeof v=="string"?v:af(v);return wt(S,"No window.location.(origin|href) available to create URL for href: "+_),new URL(_,S)}let w={get action(){return l},get location(){return t(s,o)},listen(v){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(fS,m),c=v,()=>{s.removeEventListener(fS,m),c=null}},createHref(v){return e(s,v)},createURL:x,encodeLocation(v){let S=x(v);return{pathname:S.pathname,search:S.search,hash:S.hash}},push:p,replace:g,go(v){return o.go(v)}};return w}var pS;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(pS||(pS={}));function A3(t,e,n){n===void 0&&(n="/");let r=typeof e=="string"?io(e):e,s=tv(r.pathname||"/",n);if(s==null)return null;let i=Ij(t);P3(i);let o=null;for(let l=0;o==null&&l<i.length;++l)o=V3(i[l],G3(s));return o}function Ij(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let s=(i,o,l)=>{let c={relativePath:l===void 0?i.path||"":l,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};c.relativePath.startsWith("/")&&(wt(c.relativePath.startsWith(r),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(r.length));let u=Hi([r,c.relativePath]),d=n.concat(c);i.children&&i.children.length>0&&(wt(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),Ij(i.children,e,d,u)),!(i.path==null&&!i.index)&&e.push({path:u,score:z3(u,i.index),routesMeta:d})};return t.forEach((i,o)=>{var l;if(i.path===""||!((l=i.path)!=null&&l.includes("?")))s(i,o);else for(let c of Cj(i.path))s(i,o,c)}),e}function Cj(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let o=Cj(r.join("/")),l=[];return l.push(...o.map(c=>c===""?i:[i,c].join("/"))),s&&l.push(...o),l.map(c=>t.startsWith("/")&&c===""?"/":c)}function P3(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:B3(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const F3=/^:\w+$/,M3=3,D3=2,L3=1,O3=10,$3=-2,gS=t=>t==="*";function z3(t,e){let n=t.split("/"),r=n.length;return n.some(gS)&&(r+=$3),e&&(r+=D3),n.filter(s=>!gS(s)).reduce((s,i)=>s+(F3.test(i)?M3:i===""?L3:O3),r)}function B3(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function V3(t,e){let{routesMeta:n}=t,r={},s="/",i=[];for(let o=0;o<n.length;++o){let l=n[o],c=o===n.length-1,u=s==="/"?e:e.slice(s.length)||"/",d=U3({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u);if(!d)return null;Object.assign(r,d.params);let m=l.route;i.push({params:r,pathname:Hi([s,d.pathname]),pathnameBase:Q3(Hi([s,d.pathnameBase])),route:m}),d.pathnameBase!=="/"&&(s=Hi([s,d.pathnameBase]))}return i}function U3(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=H3(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:r.reduce((u,d,m)=>{if(d==="*"){let p=l[m]||"";o=i.slice(0,i.length-p.length).replace(/(.)\/+$/,"$1")}return u[d]=W3(l[m]||"",d),u},{}),pathname:i,pathnameBase:o,pattern:t}}function H3(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),um(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/\/:(\w+)/g,(o,l)=>(r.push(l),"/([^\\/]+)"));return t.endsWith("*")?(r.push("*"),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function G3(t){try{return decodeURI(t)}catch(e){return um(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function W3(t,e){try{return decodeURIComponent(t)}catch(n){return um(!1,'The value for the URL param "'+e+'" will not be decoded because'+(' the string "'+t+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+n+").")),t}}function tv(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function q3(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?io(t):t;return{pathname:n?n.startsWith("/")?n:K3(n,e):e,search:X3(r),hash:Y3(s)}}function K3(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function mg(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function nv(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function rv(t,e,n,r){r===void 0&&(r=!1);let s;typeof t=="string"?s=io(t):(s=su({},t),wt(!s.pathname||!s.pathname.includes("?"),mg("?","pathname","search",s)),wt(!s.pathname||!s.pathname.includes("#"),mg("#","pathname","hash",s)),wt(!s.search||!s.search.includes("#"),mg("#","search","hash",s)));let i=t===""||s.pathname==="",o=i?"/":s.pathname,l;if(r||o==null)l=n;else{let m=e.length-1;if(o.startsWith("..")){let p=o.split("/");for(;p[0]==="..";)p.shift(),m-=1;s.pathname=p.join("/")}l=m>=0?e[m]:"/"}let c=q3(s,l),u=o&&o!=="/"&&o.endsWith("/"),d=(i||o===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}const Hi=t=>t.join("/").replace(/\/\/+/g,"/"),Q3=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),X3=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,Y3=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function J3(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const Rj=["post","put","patch","delete"];new Set(Rj);const Z3=["get",...Rj];new Set(Z3);/**
 * React Router v6.14.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function of(){return of=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},of.apply(this,arguments)}const sv=h.createContext(null),e4=h.createContext(null),Rl=h.createContext(null),dm=h.createContext(null),Cs=h.createContext({outlet:null,matches:[],isDataRoute:!1}),Nj=h.createContext(null);function t4(t,e){let{relative:n}=e===void 0?{}:e;Nl()||wt(!1);let{basename:r,navigator:s}=h.useContext(Rl),{hash:i,pathname:o,search:l}=Pj(t,{relative:n}),c=o;return r!=="/"&&(c=o==="/"?r:Hi([r,o])),s.createHref({pathname:c,search:l,hash:i})}function Nl(){return h.useContext(dm)!=null}function Zn(){return Nl()||wt(!1),h.useContext(dm).location}function Aj(t){h.useContext(Rl).static||h.useLayoutEffect(t)}function Nt(){let{isDataRoute:t}=h.useContext(Cs);return t?g4():n4()}function n4(){Nl()||wt(!1);let t=h.useContext(sv),{basename:e,navigator:n}=h.useContext(Rl),{matches:r}=h.useContext(Cs),{pathname:s}=Zn(),i=JSON.stringify(nv(r).map(c=>c.pathnameBase)),o=h.useRef(!1);return Aj(()=>{o.current=!0}),h.useCallback(function(c,u){if(u===void 0&&(u={}),!o.current)return;if(typeof c=="number"){n.go(c);return}let d=rv(c,JSON.parse(i),s,u.relative==="path");t==null&&e!=="/"&&(d.pathname=d.pathname==="/"?e:Hi([e,d.pathname])),(u.replace?n.replace:n.push)(d,u.state,u)},[e,n,i,s,t])}const r4=h.createContext(null);function s4(t){let e=h.useContext(Cs).outlet;return e&&h.createElement(r4.Provider,{value:t},e)}function ci(){let{matches:t}=h.useContext(Cs),e=t[t.length-1];return e?e.params:{}}function Pj(t,e){let{relative:n}=e===void 0?{}:e,{matches:r}=h.useContext(Cs),{pathname:s}=Zn(),i=JSON.stringify(nv(r).map(o=>o.pathnameBase));return h.useMemo(()=>rv(t,JSON.parse(i),s,n==="path"),[t,i,s,n])}function i4(t,e){return a4(t,e)}function a4(t,e,n){Nl()||wt(!1);let{navigator:r}=h.useContext(Rl),{matches:s}=h.useContext(Cs),i=s[s.length-1],o=i?i.params:{};i&&i.pathname;let l=i?i.pathnameBase:"/";i&&i.route;let c=Zn(),u;if(e){var d;let w=typeof e=="string"?io(e):e;l==="/"||(d=w.pathname)!=null&&d.startsWith(l)||wt(!1),u=w}else u=c;let m=u.pathname||"/",p=l==="/"?m:m.slice(l.length)||"/",g=A3(t,{pathname:p}),x=d4(g&&g.map(w=>Object.assign({},w,{params:Object.assign({},o,w.params),pathname:Hi([l,r.encodeLocation?r.encodeLocation(w.pathname).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?l:Hi([l,r.encodeLocation?r.encodeLocation(w.pathnameBase).pathname:w.pathnameBase])})),s,n);return e&&x?h.createElement(dm.Provider,{value:{location:of({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:Fi.Pop}},x):x}function o4(){let t=p4(),e=J3(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},i=null;return h.createElement(h.Fragment,null,h.createElement("h2",null,"Unexpected Application Error!"),h.createElement("h3",{style:{fontStyle:"italic"}},e),n?h.createElement("pre",{style:s},n):null,i)}const l4=h.createElement(o4,null);class c4 extends h.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error||n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error?h.createElement(Cs.Provider,{value:this.props.routeContext},h.createElement(Nj.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function u4(t){let{routeContext:e,match:n,children:r}=t,s=h.useContext(sv);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),h.createElement(Cs.Provider,{value:e},r)}function d4(t,e,n){var r;if(e===void 0&&(e=[]),n===void 0&&(n=null),t==null){var s;if((s=n)!=null&&s.errors)t=n.matches;else return null}let i=t,o=(r=n)==null?void 0:r.errors;if(o!=null){let l=i.findIndex(c=>c.route.id&&(o==null?void 0:o[c.route.id]));l>=0||wt(!1),i=i.slice(0,Math.min(i.length,l+1))}return i.reduceRight((l,c,u)=>{let d=c.route.id?o==null?void 0:o[c.route.id]:null,m=null;n&&(m=c.route.errorElement||l4);let p=e.concat(i.slice(0,u+1)),g=()=>{let x;return d?x=m:c.route.Component?x=h.createElement(c.route.Component,null):c.route.element?x=c.route.element:x=l,h.createElement(u4,{match:c,routeContext:{outlet:l,matches:p,isDataRoute:n!=null},children:x})};return n&&(c.route.ErrorBoundary||c.route.errorElement||u===0)?h.createElement(c4,{location:n.location,revalidation:n.revalidation,component:m,error:d,children:g(),routeContext:{outlet:null,matches:p,isDataRoute:!0}}):g()},null)}var X0;(function(t){t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate"})(X0||(X0={}));var iu;(function(t){t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId"})(iu||(iu={}));function h4(t){let e=h.useContext(sv);return e||wt(!1),e}function f4(t){let e=h.useContext(e4);return e||wt(!1),e}function m4(t){let e=h.useContext(Cs);return e||wt(!1),e}function Fj(t){let e=m4(),n=e.matches[e.matches.length-1];return n.route.id||wt(!1),n.route.id}function p4(){var t;let e=h.useContext(Nj),n=f4(iu.UseRouteError),r=Fj(iu.UseRouteError);return e||((t=n.errors)==null?void 0:t[r])}function g4(){let{router:t}=h4(X0.UseNavigateStable),e=Fj(iu.UseNavigateStable),n=h.useRef(!1);return Aj(()=>{n.current=!0}),h.useCallback(function(s,i){i===void 0&&(i={}),n.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,of({fromRouteId:e},i)))},[t,e])}function Mj(t){let{to:e,replace:n,state:r,relative:s}=t;Nl()||wt(!1);let{matches:i}=h.useContext(Cs),{pathname:o}=Zn(),l=Nt(),c=rv(e,nv(i).map(d=>d.pathnameBase),o,s==="path"),u=JSON.stringify(c);return h.useEffect(()=>l(JSON.parse(u),{replace:n,state:r,relative:s}),[l,u,s,n,r]),null}function hm(t){return s4(t.context)}function fs(t){wt(!1)}function x4(t){let{basename:e="/",children:n=null,location:r,navigationType:s=Fi.Pop,navigator:i,static:o=!1}=t;Nl()&&wt(!1);let l=e.replace(/^\/*/,"/"),c=h.useMemo(()=>({basename:l,navigator:i,static:o}),[l,i,o]);typeof r=="string"&&(r=io(r));let{pathname:u="/",search:d="",hash:m="",state:p=null,key:g="default"}=r,x=h.useMemo(()=>{let w=tv(u,l);return w==null?null:{location:{pathname:w,search:d,hash:m,state:p,key:g},navigationType:s}},[l,u,d,m,p,g,s]);return x==null?null:h.createElement(Rl.Provider,{value:c},h.createElement(dm.Provider,{children:n,value:x}))}function y4(t){let{children:e,location:n}=t;return i4(Y0(e),n)}var xS;(function(t){t[t.pending=0]="pending",t[t.success=1]="success",t[t.error=2]="error"})(xS||(xS={}));new Promise(()=>{});function Y0(t,e){e===void 0&&(e=[]);let n=[];return h.Children.forEach(t,(r,s)=>{if(!h.isValidElement(r))return;let i=[...e,s];if(r.type===h.Fragment){n.push.apply(n,Y0(r.props.children,i));return}r.type!==fs&&wt(!1),!r.props.index||!r.props.children||wt(!1);let o={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=Y0(r.props.children,i)),n.push(o)}),n}/**
 * React Router DOM v6.14.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function J0(){return J0=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},J0.apply(this,arguments)}function v4(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,i;for(i=0;i<r.length;i++)s=r[i],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}function w4(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function _4(t,e){return t.button===0&&(!e||e==="_self")&&!w4(t)}function Z0(t){return t===void 0&&(t=""),new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let r=t[n];return e.concat(Array.isArray(r)?r.map(s=>[n,s]):[[n,r]])},[]))}function S4(t,e){let n=Z0(t);if(e)for(let r of e.keys())n.has(r)||e.getAll(r).forEach(s=>{n.append(r,s)});return n}const b4=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset"],E4="startTransition",yS=v5[E4];function k4(t){let{basename:e,children:n,future:r,window:s}=t,i=h.useRef();i.current==null&&(i.current=C3({window:s,v5Compat:!0}));let o=i.current,[l,c]=h.useState({action:o.action,location:o.location}),{v7_startTransition:u}=r||{},d=h.useCallback(m=>{u&&yS?yS(()=>c(m)):c(m)},[c,u]);return h.useLayoutEffect(()=>o.listen(d),[o,d]),h.createElement(x4,{basename:e,children:n,location:l.location,navigationType:l.action,navigator:o})}const j4=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",T4=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,X=h.forwardRef(function(e,n){let{onClick:r,relative:s,reloadDocument:i,replace:o,state:l,target:c,to:u,preventScrollReset:d}=e,m=v4(e,b4),{basename:p}=h.useContext(Rl),g,x=!1;if(typeof u=="string"&&T4.test(u)&&(g=u,j4))try{let _=new URL(window.location.href),E=u.startsWith("//")?new URL(_.protocol+u):new URL(u),I=tv(E.pathname,p);E.origin===_.origin&&I!=null?u=I+E.search+E.hash:x=!0}catch{}let w=t4(u,{relative:s}),v=I4(u,{replace:o,state:l,target:c,preventScrollReset:d,relative:s});function S(_){r&&r(_),_.defaultPrevented||v(_)}return h.createElement("a",J0({},m,{href:g||w,onClick:x||i?r:S,ref:n,target:c}))});var vS;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher"})(vS||(vS={}));var wS;(function(t){t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(wS||(wS={}));function I4(t,e){let{target:n,replace:r,state:s,preventScrollReset:i,relative:o}=e===void 0?{}:e,l=Nt(),c=Zn(),u=Pj(t,{relative:o});return h.useCallback(d=>{if(_4(d,n)){d.preventDefault();let m=r!==void 0?r:af(c)===af(u);l(t,{replace:m,state:s,preventScrollReset:i,relative:o})}},[c,l,u,r,s,n,t,i,o])}function Dj(t){let e=h.useRef(Z0(t)),n=h.useRef(!1),r=Zn(),s=h.useMemo(()=>S4(r.search,n.current?null:e.current),[r.search]),i=Nt(),o=h.useCallback((l,c)=>{const u=Z0(typeof l=="function"?l(s):l);n.current=!0,i("?"+u,c)},[i,s]);return[s,o]}function ui(){const t={container:"pt-[30px] pb-[calc(127px+30px)] md:mt-auto md:pb-[120px] md:flex md:justify-between md:items-center",icon:"w-6 hover:scale-[1.1] transition linear ",copyRightText:"text-sm font-medium"};return a.jsxs("div",{className:`${t.container}`,children:[a.jsxs("p",{className:t.copyRightText,children:["Make with  ",a.jsx("span",{children:"❤️ "}),"by d4t06 ",a.jsx("br",{})," © All rights no reserve ¯\\_(ツ)_/¯"]}),a.jsxs("div",{className:"flex items-center mt-5 md:mt-0 space-x-[10px] h-[30px]",children:[a.jsx("a",{href:"mailto:datnh0708@gmail.com",children:a.jsx("svg",{className:t.icon,fill:"currentColor",viewBox:"0 0 32 32",xmlns:"http://www.w3.org/2000/svg",children:a.jsxs("g",{children:[a.jsx("path",{d:"M16.601 14.648v4.105h9.813c-0.162 2.008-0.982 3.798-2.243 5.18l0.006-0.007c-1.825 1.86-4.364 3.012-7.172 3.012-0.142 0-0.283-0.003-0.424-0.009l0.020 0.001c-5.946-0.003-10.765-4.823-10.765-10.77 0-0.051 0-0.102 0.001-0.152l-0 0.008c-0.001-0.043-0.001-0.094-0.001-0.145 0-5.946 4.819-10.767 10.765-10.77h0c0.040-0.001 0.087-0.001 0.135-0.001 2.822 0 5.383 1.121 7.262 2.941l-0.003-0.003 2.888-2.888c-2.568-2.578-6.121-4.174-10.047-4.174-0.082 0-0.164 0.001-0.246 0.002l0.012-0c-0.002 0-0.005 0-0.008 0-8.337 0-15.11 6.699-15.228 15.009l-0 0.011c0.118 8.32 6.891 15.020 15.228 15.020 0.003 0 0.006 0 0.009 0h-0c0.169 0.007 0.367 0.012 0.566 0.012 3.892 0 7.407-1.616 9.91-4.213l0.004-0.004c2.208-2.408 3.561-5.63 3.561-9.169 0-0.15-0.002-0.3-0.007-0.449l0.001 0.022c0.001-0.054 0.001-0.119 0.001-0.183 0-0.844-0.079-1.669-0.231-2.469l0.013 0.082z"})," "]})})}),a.jsx("a",{href:"https://github.com/d4t06",target:"_blank",children:a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t.icon,fill:"currentColor",viewBox:"0 0 496 512",children:a.jsx("path",{d:"M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"})})}),a.jsx("a",{href:"https://www.linkedin.com/in/dat-nguyen-huu-9371a926a",target:"_blank",children:a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t.icon,viewBox:"0 0 448 512",fill:"currentColor",children:a.jsx("path",{d:"M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"})})})]})]})}function Lj(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t))for(e=0;e<t.length;e++)t[e]&&(n=Lj(t[e]))&&(r&&(r+=" "),r+=n);else for(e in t)t[e]&&(r&&(r+=" "),r+=e);return r}function C4(){for(var t,e,n=0,r="";n<arguments.length;)(t=arguments[n++])&&(e=Lj(t))&&(r&&(r+=" "),r+=e);return r}const _S=t=>typeof t=="boolean"?"".concat(t):t===0?"0":t,SS=C4,Ru=(t,e)=>n=>{var r;if((e==null?void 0:e.variants)==null)return SS(t,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:s,defaultVariants:i}=e,o=Object.keys(s).map(u=>{const d=n==null?void 0:n[u],m=i==null?void 0:i[u];if(d===null)return null;const p=_S(d)||_S(m);return s[u][p]}),l=n&&Object.entries(n).reduce((u,d)=>{let[m,p]=d;return p===void 0||(u[m]=p),u},{}),c=e==null||(r=e.compoundVariants)===null||r===void 0?void 0:r.reduce((u,d)=>{let{class:m,className:p,...g}=d;return Object.entries(g).every(x=>{let[w,v]=x;return Array.isArray(v)?v.includes({...i,...l}[w]):{...i,...l}[w]===v})?[...u,m,p]:u},[]);return SS(t,o,c,n==null?void 0:n.class,n==null?void 0:n.className)};function R4({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 6h9.75M10.5 6a1.5 1.5 0 11-3 0m3 0a1.5 1.5 0 10-3 0M3.75 6H7.5m3 12h9.75m-9.75 0a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0m-3.75 0H7.5m9-6h3.75m-3.75 0a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0m-9.75 0h9.75"}))}const N4=h.forwardRef(R4),iv=N4;function A4({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3"}))}const P4=h.forwardRef(A4),Nu=P4;function F4({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6a2.25 2.25 0 00-2.25 2.25v13.5A2.25 2.25 0 007.5 21h6a2.25 2.25 0 002.25-2.25V15M12 9l-3 3m0 0l3 3m-3-3h12.75"}))}const M4=h.forwardRef(F4),D4=M4;function L4({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18"}))}const O4=h.forwardRef(L4),av=O4;function $4({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 12c0-1.232-.046-2.453-.138-3.662a4.006 4.006 0 00-3.7-3.7 48.678 48.678 0 00-7.324 0 4.006 4.006 0 00-3.7 3.7c-.017.22-.032.441-.046.662M19.5 12l3-3m-3 3l-3-3m-12 3c0 1.232.046 2.453.138 3.662a4.006 4.006 0 003.7 3.7 48.656 48.656 0 007.324 0 4.006 4.006 0 003.7-3.7c.017-.22.032-.441.046-.662M4.5 12l3 3m-3-3l-3 3"}))}const z4=h.forwardRef($4),Oj=z4;function B4({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99"}))}const V4=h.forwardRef(B4),Ae=V4;function U4({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6a2.25 2.25 0 00-2.25 2.25v13.5A2.25 2.25 0 007.5 21h6a2.25 2.25 0 002.25-2.25V15m3 0l3-3m0 0l-3-3m3 3H9"}))}const H4=h.forwardRef(U4),ov=H4;function G4({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 4.5L21 12m0 0l-7.5 7.5M21 12H3"}))}const W4=h.forwardRef(G4),$j=W4;function q4({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 6H5.25A2.25 2.25 0 003 8.25v10.5A2.25 2.25 0 005.25 21h10.5A2.25 2.25 0 0018 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"}))}const K4=h.forwardRef(q4),Q4=K4;function X4({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 18L9 11.25l4.306 4.307a11.95 11.95 0 015.814-5.519l2.74-1.22m0 0l-5.94-2.28m5.94 2.28l-2.28 5.941"}))}const Y4=h.forwardRef(X4),fm=Y4;function J4({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 19.5l15-15m0 0H8.25m11.25 0v11.25"}))}const Z4=h.forwardRef(J4),zj=Z4;function eF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5m-13.5-9L12 3m0 0l4.5 4.5M12 3v13.5"}))}const tF=h.forwardRef(eF),lv=tF;function nF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 16.811c0 .864-.933 1.405-1.683.977l-7.108-4.062a1.125 1.125 0 010-1.953l7.108-4.062A1.125 1.125 0 0121 8.688v8.123zM11.25 16.811c0 .864-.933 1.405-1.683.977l-7.108-4.062a1.125 1.125 0 010-1.953L9.567 7.71a1.125 1.125 0 011.683.977v8.123z"}))}const rF=h.forwardRef(nF),Bj=rF;function sF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"}))}const iF=h.forwardRef(sF),ao=iF;function aF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20.25 8.511c.884.284 1.5 1.128 1.5 2.097v4.286c0 1.136-.847 2.1-1.98 2.193-.34.027-.68.052-1.02.072v3.091l-3-3c-1.354 0-2.694-.055-4.02-.163a2.115 2.115 0 01-.825-.242m9.345-8.334a2.126 2.126 0 00-.476-.095 48.64 48.64 0 00-8.048 0c-1.131.094-1.976 1.057-1.976 2.192v4.286c0 .837.46 1.58 1.155 1.951m9.345-8.334V6.637c0-1.621-1.152-3.026-2.76-3.235A48.455 48.455 0 0011.25 3c-2.115 0-4.198.137-6.24.402-1.608.209-2.76 1.614-2.76 3.235v6.226c0 1.621 1.152 3.026 2.76 3.235.577.075 1.157.14 1.74.194V21l4.155-4.155"}))}const oF=h.forwardRef(aF),cv=oF;function lF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}))}const cF=h.forwardRef(lF),uF=cF;function dF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 12.75l6 6 9-13.5"}))}const hF=h.forwardRef(dF),aa=hF;function fF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 8.25l-7.5 7.5-7.5-7.5"}))}const mF=h.forwardRef(fF),Vj=mF;function pF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5L8.25 12l7.5-7.5"}))}const gF=h.forwardRef(pF),uv=gF;function xF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 4.5l7.5 7.5-7.5 7.5"}))}const yF=h.forwardRef(xF),lf=yF;function vF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 15.75l7.5-7.5 7.5 7.5"}))}const wF=h.forwardRef(vF),_F=wF;function SF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 7.5V6.108c0-1.135.845-2.098 1.976-2.192.373-.03.748-.057 1.123-.08M15.75 18H18a2.25 2.25 0 002.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 00-1.123-.08M15.75 18.75v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5A3.375 3.375 0 006.375 7.5H5.25m11.9-3.664A2.251 2.251 0 0015 2.25h-1.5a2.251 2.251 0 00-2.15 1.586m5.8 0c.065.21.1.433.1.664v.75h-6V4.5c0-.231.035-.454.1-.664M6.75 7.5H4.875c-.621 0-1.125.504-1.125 1.125v12c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V16.5a9 9 0 00-9-9z"}))}const bF=h.forwardRef(SF),EF=bF;function kF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z"}))}const jF=h.forwardRef(kF),Uj=jF;function TF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.324.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 011.37.49l1.296 2.247a1.125 1.125 0 01-.26 1.431l-1.003.827c-.293.24-.438.613-.431.992a6.759 6.759 0 010 .255c-.007.378.138.75.43.99l1.005.828c.424.35.534.954.26 1.43l-1.298 2.247a1.125 1.125 0 01-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.57 6.57 0 01-.22.128c-.331.183-.581.495-.644.869l-.213 1.28c-.09.543-.56.941-1.11.941h-2.594c-.55 0-1.02-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 01-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 01-1.369-.49l-1.297-2.247a1.125 1.125 0 01.26-1.431l1.004-.827c.292-.24.437-.613.43-.992a6.932 6.932 0 010-.255c.007-.378-.138-.75-.43-.99l-1.004-.828a1.125 1.125 0 01-.26-1.43l1.297-2.247a1.125 1.125 0 011.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.087.22-.128.332-.183.582-.495.644-.869l.214-1.281z"}),h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}))}const IF=h.forwardRef(TF),dv=IF;function CF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 17.25v1.007a3 3 0 01-.879 2.122L7.5 21h9l-.621-.621A3 3 0 0115 18.257V17.25m6-12V15a2.25 2.25 0 01-2.25 2.25H5.25A2.25 2.25 0 013 15V5.25m18 0A2.25 2.25 0 0018.75 3H5.25A2.25 2.25 0 003 5.25m18 0V12a2.25 2.25 0 01-2.25 2.25H5.25A2.25 2.25 0 013 12V5.25"}))}const RF=h.forwardRef(CF),mm=RF;function NF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z"}))}const AF=h.forwardRef(NF),pm=AF;function PF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m9-.75a9 9 0 11-18 0 9 9 0 0118 0zm-9 3.75h.008v.008H12v-.008z"}))}const FF=h.forwardRef(PF),gm=FF;function MF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z"}),h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}))}const DF=h.forwardRef(MF),LF=DF;function OF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.375 19.5h17.25m-17.25 0a1.125 1.125 0 01-1.125-1.125M3.375 19.5h1.5C5.496 19.5 6 18.996 6 18.375m-3.75 0V5.625m0 12.75v-1.5c0-.621.504-1.125 1.125-1.125m18.375 2.625V5.625m0 12.75c0 .621-.504 1.125-1.125 1.125m1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125m0 3.75h-1.5A1.125 1.125 0 0118 18.375M20.625 4.5H3.375m17.25 0c.621 0 1.125.504 1.125 1.125M20.625 4.5h-1.5C18.504 4.5 18 5.004 18 5.625m3.75 0v1.5c0 .621-.504 1.125-1.125 1.125M3.375 4.5c-.621 0-1.125.504-1.125 1.125M3.375 4.5h1.5C5.496 4.5 6 5.004 6 5.625m-3.75 0v1.5c0 .621.504 1.125 1.125 1.125m0 0h1.5m-1.5 0c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125m1.5-3.75C5.496 8.25 6 7.746 6 7.125v-1.5M4.875 8.25C5.496 8.25 6 8.754 6 9.375v1.5m0-5.25v5.25m0-5.25C6 5.004 6.504 4.5 7.125 4.5h9.75c.621 0 1.125.504 1.125 1.125m1.125 2.625h1.5m-1.5 0A1.125 1.125 0 0118 7.125v-1.5m1.125 2.625c-.621 0-1.125.504-1.125 1.125v1.5m2.625-2.625c.621 0 1.125.504 1.125 1.125v1.5c0 .621-.504 1.125-1.125 1.125M18 5.625v5.25M7.125 12h9.75m-9.75 0A1.125 1.125 0 016 10.875M7.125 12C6.504 12 6 12.504 6 13.125m0-2.25C6 11.496 5.496 12 4.875 12M18 10.875c0 .621-.504 1.125-1.125 1.125M18 10.875c0 .621.504 1.125 1.125 1.125m-2.25 0c.621 0 1.125.504 1.125 1.125m-12 5.25v-5.25m0 5.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125m-12 0v-1.5c0-.621-.504-1.125-1.125-1.125M18 18.375v-5.25m0 5.25v-1.5c0-.621.504-1.125 1.125-1.125M18 13.125v1.5c0 .621.504 1.125 1.125 1.125M18 13.125c0-.621.504-1.125 1.125-1.125M6 13.125v1.5c0 .621-.504 1.125-1.125 1.125M6 13.125C6 12.504 5.496 12 4.875 12m-1.5 0h1.5m-1.5 0c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125M19.125 12h1.5m0 0c.621 0 1.125.504 1.125 1.125v1.5c0 .621-.504 1.125-1.125 1.125m-17.25 0h1.5m14.25 0h1.5"}))}const $F=h.forwardRef(OF),Hj=$F;function zF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 8.688c0-.864.933-1.405 1.683-.977l7.108 4.062a1.125 1.125 0 010 1.953l-7.108 4.062A1.125 1.125 0 013 16.81V8.688zM12.75 8.688c0-.864.933-1.405 1.683-.977l7.108 4.062a1.125 1.125 0 010 1.953l-7.108 4.062a1.125 1.125 0 01-1.683-.977V8.688z"}))}const BF=h.forwardRef(zF),Gj=BF;function VF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12.75 3.03v.568c0 .334.148.65.405.864l1.068.89c.442.369.535 1.01.216 1.49l-.51.766a2.25 2.25 0 01-1.161.886l-.143.048a1.107 1.107 0 00-.57 1.664c.369.555.169 1.307-.427 1.605L9 13.125l.423 1.059a.956.956 0 01-1.652.928l-.679-.906a1.125 1.125 0 00-1.906.172L4.5 15.75l-.612.153M12.75 3.031a9 9 0 00-8.862 12.872M12.75 3.031a9 9 0 016.69 14.036m0 0l-.177-.529A2.25 2.25 0 0017.128 15H16.5l-.324-.324a1.453 1.453 0 00-2.328.377l-.036.073a1.586 1.586 0 01-.982.816l-.99.282c-.55.157-.894.702-.8 1.267l.073.438c.08.474.49.821.97.821.846 0 1.598.542 1.865 1.345l.215.643m5.276-3.67a9.012 9.012 0 01-5.276 3.67m0 0a9 9 0 01-10.275-4.835M15.75 9c0 .896-.393 1.7-1.016 2.25"}))}const UF=h.forwardRef(VF),Wj=UF;function HF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12z"}))}const GF=h.forwardRef(HF),Au=GF;function WF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 12l8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25"}))}const qF=h.forwardRef(WF),Pu=qF;function KF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z"}))}const QF=h.forwardRef(KF),qj=QF;function XF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.19 8.688a4.5 4.5 0 011.242 7.244l-4.5 4.5a4.5 4.5 0 01-6.364-6.364l1.757-1.757m13.35-.622l1.757-1.757a4.5 4.5 0 00-6.364-6.364l-4.5 4.5a4.5 4.5 0 001.242 7.244"}))}const YF=h.forwardRef(XF),JF=YF;function ZF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"}))}const eM=h.forwardRef(ZF),Fu=eM;function tM({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 12h-15"}))}const nM=h.forwardRef(tM),hv=nM;function rM({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 9l10.5-3m0 6.553v3.75a2.25 2.25 0 01-1.632 2.163l-1.32.377a1.803 1.803 0 11-.99-3.467l2.31-.66a2.25 2.25 0 001.632-2.163zm0 0V2.25L9 5.25v10.303m0 0v3.75a2.25 2.25 0 01-1.632 2.163l-1.32.377a1.803 1.803 0 01-.99-3.467l2.31-.66A2.25 2.25 0 009 15.553z"}))}const sM=h.forwardRef(rM),oa=sM;function iM({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 7.5h1.5m-1.5 3h1.5m-7.5 3h7.5m-7.5 3h7.5m3-9h3.375c.621 0 1.125.504 1.125 1.125V18a2.25 2.25 0 01-2.25 2.25M16.5 7.5V18a2.25 2.25 0 002.25 2.25M16.5 7.5V4.875c0-.621-.504-1.125-1.125-1.125H4.125C3.504 3.75 3 4.254 3 4.875V18a2.25 2.25 0 002.25 2.25h13.5M6 7.5h3v3H6v-3z"}))}const aM=h.forwardRef(iM),oM=aM;function lM({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.53 16.122a3 3 0 00-5.78 1.128 2.25 2.25 0 01-2.4 2.245 4.5 4.5 0 008.4-2.245c0-.399-.078-.78-.22-1.128zm0 0a15.998 15.998 0 003.388-1.62m-5.043-.025a15.994 15.994 0 011.622-3.395m3.42 3.42a15.995 15.995 0 004.764-4.648l3.876-5.814a1.151 1.151 0 00-1.597-1.597L14.146 6.32a15.996 15.996 0 00-4.649 4.763m3.42 3.42a6.776 6.776 0 00-3.42-3.42"}))}const cM=h.forwardRef(lM),Kj=cM;function uM({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.25 9v6m-4.5 0V9M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}))}const dM=h.forwardRef(uM),Qj=dM;function hM({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 5.25v13.5m-7.5-13.5v13.5"}))}const fM=h.forwardRef(hM),fv=fM;function mM({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125"}))}const pM=h.forwardRef(mM),Dr=pM;function gM({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 15.75l5.159-5.159a2.25 2.25 0 013.182 0l5.159 5.159m-1.5-1.5l1.409-1.409a2.25 2.25 0 013.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 001.5-1.5V6a1.5 1.5 0 00-1.5-1.5H3.75A1.5 1.5 0 002.25 6v12a1.5 1.5 0 001.5 1.5zm10.5-11.25h.008v.008h-.008V8.25zm.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0z"}))}const xM=h.forwardRef(gM),di=xM;function yM({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}),h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.91 11.672a.375.375 0 010 .656l-5.603 3.113a.375.375 0 01-.557-.328V8.887c0-.286.307-.466.557-.327l5.603 3.112z"}))}const vM=h.forwardRef(yM),wM=vM;function _M({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 5.653c0-.856.917-1.398 1.667-.986l11.54 6.348a1.125 1.125 0 010 1.971l-11.54 6.347a1.125 1.125 0 01-1.667-.985V5.653z"}))}const SM=h.forwardRef(_M),cf=SM;function bM({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"}))}const EM=h.forwardRef(bM),zt=EM;function kM({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 12h16.5m-16.5 3.75h16.5M3.75 19.5h16.5M5.625 4.5h12.75a1.875 1.875 0 010 3.75H5.625a1.875 1.875 0 010-3.75z"}))}const jM=h.forwardRef(kM),TM=jM;function IM({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 7.125C2.25 6.504 2.754 6 3.375 6h6c.621 0 1.125.504 1.125 1.125v3.75c0 .621-.504 1.125-1.125 1.125h-6a1.125 1.125 0 01-1.125-1.125v-3.75zM14.25 8.625c0-.621.504-1.125 1.125-1.125h5.25c.621 0 1.125.504 1.125 1.125v8.25c0 .621-.504 1.125-1.125 1.125h-5.25a1.125 1.125 0 01-1.125-1.125v-8.25zM3.75 16.125c0-.621.504-1.125 1.125-1.125h5.25c.621 0 1.125.504 1.125 1.125v2.25c0 .621-.504 1.125-1.125 1.125h-5.25a1.125 1.125 0 01-1.125-1.125v-2.25z"}))}const CM=h.forwardRef(IM),RM=CM;function NM({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7.848 8.25l1.536.887M7.848 8.25a3 3 0 11-5.196-3 3 3 0 015.196 3zm1.536.887a2.165 2.165 0 011.083 1.839c.005.351.054.695.14 1.024M9.384 9.137l2.077 1.199M7.848 15.75l1.536-.887m-1.536.887a3 3 0 11-5.196 3 3 3 0 015.196-3zm1.536-.887a2.165 2.165 0 001.083-1.838c.005-.352.054-.695.14-1.025m-1.223 2.863l2.077-1.199m0-3.328a4.323 4.323 0 012.068-1.379l5.325-1.628a4.5 4.5 0 012.48-.044l.803.215-7.794 4.5m-2.882-1.664A4.331 4.331 0 0010.607 12m3.736 0l7.794 4.5-.802.215a4.5 4.5 0 01-2.48-.043l-5.326-1.629a4.324 4.324 0 01-2.068-1.379M14.343 12l-2.882 1.664"}))}const AM=h.forwardRef(NM),Xj=AM;function PM({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.114 5.636a9 9 0 010 12.728M16.463 8.288a5.25 5.25 0 010 7.424M6.75 8.25l4.72-4.72a.75.75 0 011.28.53v15.88a.75.75 0 01-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.01 9.01 0 012.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75z"}))}const FM=h.forwardRef(PM),MM=FM;function DM({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17.25 9.75L19.5 12m0 0l2.25 2.25M19.5 12l2.25-2.25M19.5 12l-2.25 2.25m-10.5-6l4.72-4.72a.75.75 0 011.28.531V19.94a.75.75 0 01-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.506-1.938-1.354A9.01 9.01 0 012.25 12c0-.83.112-1.633.322-2.395C2.806 8.757 3.63 8.25 4.51 8.25H6.75z"}))}const LM=h.forwardRef(DM),OM=LM;function $M({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 16.875h3.375m0 0h3.375m-3.375 0V13.5m0 3.375v3.375M6 10.5h2.25a2.25 2.25 0 002.25-2.25V6a2.25 2.25 0 00-2.25-2.25H6A2.25 2.25 0 003.75 6v2.25A2.25 2.25 0 006 10.5zm0 9.75h2.25A2.25 2.25 0 0010.5 18v-2.25a2.25 2.25 0 00-2.25-2.25H6a2.25 2.25 0 00-2.25 2.25V18A2.25 2.25 0 006 20.25zm9.75-9.75H18a2.25 2.25 0 002.25-2.25V6A2.25 2.25 0 0018 3.75h-2.25A2.25 2.25 0 0013.5 6v2.25a2.25 2.25 0 002.25 2.25z"}))}const zM=h.forwardRef($M),xm=zM;function BM({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 7.5A2.25 2.25 0 017.5 5.25h9a2.25 2.25 0 012.25 2.25v9a2.25 2.25 0 01-2.25 2.25h-9a2.25 2.25 0 01-2.25-2.25v-9z"}))}const VM=h.forwardRef(BM),mv=VM;function UM({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"}))}const HM=h.forwardRef(UM),pt=HM;function GM({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z"}))}const WM=h.forwardRef(GM),ex=WM;function qM({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"}))}const KM=h.forwardRef(qM),oo=KM,QM=Ru("inline-flex space-x-1 font-semibold items-center ",{variants:{variant:{default:"",circle:"rounded-full",list:"flex items-center py-[5px] w-full",outline:"border rounded-full",primary:""},color:{primary:"bg-[--primary-cl] text-white",clear:""},size:{primary:"px-4 py-1.5",small:"px-2 py-1",half:"w-1/2",full:"w-full",clear:""},rounded:{full:"rounded-full",md:"rounded-md",clear:""},hover:{default:"hover:brightness-90",scale:"transition-transform hover:scale-[1.05]",clear:""}},defaultVariants:{variant:"default",size:"primary",hover:"default",rounded:"full",color:"clear"}});function XM({className:t,children:e,variant:n,size:r,disabled:s,isLoading:i,rounded:o,color:l,hover:c,onClick:u,...d},m){return a.jsxs("button",{ref:m,type:"button",onClick:p=>u?u(p):"",...d,className:`${QM({color:l,variant:n,size:r,hover:c,rounded:o,className:t})}`,disabled:i||s,children:[i?a.jsx(Ae,{className:"w-6 animate-spin"}):null,!i&&e]})}const se=h.forwardRef(XM),dl='border w-full placeholder:[#666] rounded-md outline-none py-1.5 px-2 bg-[--a-5-cl] border-[--a-5-cl] "',YM=Ru("w-full",{variants:{variant:{primary:dl,clear:""},rounded:{xl:"rounded-xl",lg:"rounded-lg",md:"rounded-md"}},defaultVariants:{variant:"primary",rounded:"md"}});function JM({variant:t,className:e="",...n},r){return a.jsx("input",{ref:r,className:` ${YM({variant:t,className:e})}`,...n})}const _n=h.forwardRef(JM);function Yj({closeModal:t,cbWhenSubmit:e,title:n,initValue:r="",loading:s,variant:i="input",children:o}){const[l,c]=h.useState(r||""),u=h.useRef(null),d=h.useRef(!1),m=h.useMemo(()=>l.trim()&&l!==r,[l]),p=g=>{g.preventDefault(),m&&(d.current||(d.current=!0,e(l)))};return h.useEffect(()=>{var g;(g=u.current)==null||g.focus()},[]),a.jsxs(_e,{children:[a.jsx(Be,{closeModal:t,title:n}),a.jsxs("form",{action:"",onSubmit:p,children:[i==="input"&&a.jsx("input",{className:dl,ref:u,placeholder:"name...",value:l,onChange:g=>c(g.target.value)}),i==="text-area"&&a.jsx("textarea",{className:dl,value:l,onChange:g=>c(g.target.value)}),o,a.jsx("p",{className:"text-right mt-3",children:a.jsx(se,{type:"submit",variant:"primary",isLoading:s,color:"primary",className:`rounded-full self-end mt-[15px] ${m?"":"disable"}`,children:"Save"})})]})]})}function Jj({closeModal:t}){return a.jsxs(_e,{children:[a.jsx(Be,{closeModal:t,title:"HD MP3"}),a.jsxs("p",{children:[a.jsx("span",{className:"font-[500]",children:"Technologies: "})," React, Tailwind Css, Google firebase"]})]})}const uf=[{name:"White",id:"white",type:"light",border:"border-[#198585]",container:"bg-[#fff]"},{name:"Red",id:"red",type:"dark",border:"border-[#ca4954]",container:"bg-[#2e0f10]"},{name:"Black",id:"black",type:"dark",border:"border-[#198585]",container:"bg-[#1e1e1e]"},{name:"Deep blue",id:"deep_blue",type:"dark",border:"border-[#0c9e85]",container:"bg-[#0f1a2e]"},{name:"Light green",id:"light_green",type:"light",border:"border-[#198585]",container:"bg-[#ced9d9]"},{name:"Brown",id:"brown",type:"light",border:"border-[#644646]",container:"bg-white"}],Zj=[{name:"Tet",id:"tet",type:"light",container:"bg-[#644646]",border:"bg-[#f7f0de]",image:"tet_theme_image.png"}],ZM=()=>{const[t,e]=h.useState(null),[n,r]=h.useState(!0),s=h.useRef(!1);return{user:t,setUser:e,loading:n,setLoading:r,updateUserData:o=>{e(l=>l?{...l,...o}:null)},justRegistered:s}},eT=h.createContext(null);function xe(){const t=h.useContext(eT);if(!t)throw new Error("auth context not Provided");return t}function eD({children:t}){return a.jsx(eT.Provider,{value:ZM(),children:t})}const tD=6;function nD(){const[t,e]=h.useState({songs:[],playlists:[]}),[n,r]=h.useState([]),[s,i]=h.useState([]),[o,l]=h.useState([]),[c,u]=h.useState([]),[d,m]=h.useState([]),[p,g]=h.useState([]),[x,w]=h.useState(!0),v=h.useRef(!0),S=h.useRef(!0),_=h.useRef(!0),E=h.useRef(!0),I=h.useRef(!0),P=h.useRef(),F=h.useRef(!1);return{uploadedSongs:s,setUploadedSongs:i,ownPlaylists:c,setOwnPlaylists:u,favoritePlaylists:d,setFavoritePlaylists:m,favoriteSongs:o,setFavoriteSongs:l,sysSongPlaylist:t,setSysSongPlaylist:e,shouldFetchUserSongs:v,shouldFetchFavoriteSongs:S,shouldFetchOwnPlaylists:_,shouldFetchFavoritePlaylists:E,updateSong:C=>{const R=[...s],N=R.findIndex(M=>M.id===C.id);if(N!==-1){const M={...R[N]};Object.assign(M,C.song),R[N]=M,i(R)}},singers:p,setSingers:g,shouldFetchUserSingers:I,lastDoc:P,hasMore:x,setHasMore:w,checkEntireUser:F,genres:n,setGenres:r,resetPage:()=>{v.current=!0,P.current=void 0,w(!0)},PAGE_SIZE:tD}}const tT=h.createContext(null);function rD({children:t}){return a.jsx(tT.Provider,{value:nD(),children:t})}const it=()=>{const t=h.useContext(tT);if(!t)throw new Error("SongContext not provided");return t};function nT(t,e){return function(){return t.apply(e,arguments)}}const{toString:sD}=Object.prototype,{getPrototypeOf:pv}=Object,ym=(t=>e=>{const n=sD.call(e);return t[n]||(t[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),rs=t=>(t=t.toLowerCase(),e=>ym(e)===t),vm=t=>e=>typeof e===t,{isArray:Al}=Array,au=vm("undefined");function iD(t){return t!==null&&!au(t)&&t.constructor!==null&&!au(t.constructor)&&mr(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const rT=rs("ArrayBuffer");function aD(t){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&rT(t.buffer),e}const oD=vm("string"),mr=vm("function"),sT=vm("number"),wm=t=>t!==null&&typeof t=="object",lD=t=>t===!0||t===!1,wh=t=>{if(ym(t)!=="object")return!1;const e=pv(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},cD=rs("Date"),uD=rs("File"),dD=rs("Blob"),hD=rs("FileList"),fD=t=>wm(t)&&mr(t.pipe),mD=t=>{let e;return t&&(typeof FormData=="function"&&t instanceof FormData||mr(t.append)&&((e=ym(t))==="formdata"||e==="object"&&mr(t.toString)&&t.toString()==="[object FormData]"))},pD=rs("URLSearchParams"),[gD,xD,yD,vD]=["ReadableStream","Request","Response","Headers"].map(rs),wD=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Mu(t,e,{allOwnKeys:n=!1}={}){if(t===null||typeof t>"u")return;let r,s;if(typeof t!="object"&&(t=[t]),Al(t))for(r=0,s=t.length;r<s;r++)e.call(null,t[r],r,t);else{const i=n?Object.getOwnPropertyNames(t):Object.keys(t),o=i.length;let l;for(r=0;r<o;r++)l=i[r],e.call(null,t[l],l,t)}}function iT(t,e){e=e.toLowerCase();const n=Object.keys(t);let r=n.length,s;for(;r-- >0;)if(s=n[r],e===s.toLowerCase())return s;return null}const Ra=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),aT=t=>!au(t)&&t!==Ra;function tx(){const{caseless:t}=aT(this)&&this||{},e={},n=(r,s)=>{const i=t&&iT(e,s)||s;wh(e[i])&&wh(r)?e[i]=tx(e[i],r):wh(r)?e[i]=tx({},r):Al(r)?e[i]=r.slice():e[i]=r};for(let r=0,s=arguments.length;r<s;r++)arguments[r]&&Mu(arguments[r],n);return e}const _D=(t,e,n,{allOwnKeys:r}={})=>(Mu(e,(s,i)=>{n&&mr(s)?t[i]=nT(s,n):t[i]=s},{allOwnKeys:r}),t),SD=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),bD=(t,e,n,r)=>{t.prototype=Object.create(e.prototype,r),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),n&&Object.assign(t.prototype,n)},ED=(t,e,n,r)=>{let s,i,o;const l={};if(e=e||{},t==null)return e;do{for(s=Object.getOwnPropertyNames(t),i=s.length;i-- >0;)o=s[i],(!r||r(o,t,e))&&!l[o]&&(e[o]=t[o],l[o]=!0);t=n!==!1&&pv(t)}while(t&&(!n||n(t,e))&&t!==Object.prototype);return e},kD=(t,e,n)=>{t=String(t),(n===void 0||n>t.length)&&(n=t.length),n-=e.length;const r=t.indexOf(e,n);return r!==-1&&r===n},jD=t=>{if(!t)return null;if(Al(t))return t;let e=t.length;if(!sT(e))return null;const n=new Array(e);for(;e-- >0;)n[e]=t[e];return n},TD=(t=>e=>t&&e instanceof t)(typeof Uint8Array<"u"&&pv(Uint8Array)),ID=(t,e)=>{const r=(t&&t[Symbol.iterator]).call(t);let s;for(;(s=r.next())&&!s.done;){const i=s.value;e.call(t,i[0],i[1])}},CD=(t,e)=>{let n;const r=[];for(;(n=t.exec(e))!==null;)r.push(n);return r},RD=rs("HTMLFormElement"),ND=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,r,s){return r.toUpperCase()+s}),bS=(({hasOwnProperty:t})=>(e,n)=>t.call(e,n))(Object.prototype),AD=rs("RegExp"),oT=(t,e)=>{const n=Object.getOwnPropertyDescriptors(t),r={};Mu(n,(s,i)=>{let o;(o=e(s,i,t))!==!1&&(r[i]=o||s)}),Object.defineProperties(t,r)},PD=t=>{oT(t,(e,n)=>{if(mr(t)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const r=t[n];if(mr(r)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},FD=(t,e)=>{const n={},r=s=>{s.forEach(i=>{n[i]=!0})};return Al(t)?r(t):r(String(t).split(e)),n},MD=()=>{},DD=(t,e)=>t!=null&&Number.isFinite(t=+t)?t:e;function LD(t){return!!(t&&mr(t.append)&&t[Symbol.toStringTag]==="FormData"&&t[Symbol.iterator])}const OD=t=>{const e=new Array(10),n=(r,s)=>{if(wm(r)){if(e.indexOf(r)>=0)return;if(!("toJSON"in r)){e[s]=r;const i=Al(r)?[]:{};return Mu(r,(o,l)=>{const c=n(o,s+1);!au(c)&&(i[l]=c)}),e[s]=void 0,i}}return r};return n(t,0)},$D=rs("AsyncFunction"),zD=t=>t&&(wm(t)||mr(t))&&mr(t.then)&&mr(t.catch),lT=((t,e)=>t?setImmediate:e?((n,r)=>(Ra.addEventListener("message",({source:s,data:i})=>{s===Ra&&i===n&&r.length&&r.shift()()},!1),s=>{r.push(s),Ra.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",mr(Ra.postMessage)),BD=typeof queueMicrotask<"u"?queueMicrotask.bind(Ra):typeof process<"u"&&process.nextTick||lT,O={isArray:Al,isArrayBuffer:rT,isBuffer:iD,isFormData:mD,isArrayBufferView:aD,isString:oD,isNumber:sT,isBoolean:lD,isObject:wm,isPlainObject:wh,isReadableStream:gD,isRequest:xD,isResponse:yD,isHeaders:vD,isUndefined:au,isDate:cD,isFile:uD,isBlob:dD,isRegExp:AD,isFunction:mr,isStream:fD,isURLSearchParams:pD,isTypedArray:TD,isFileList:hD,forEach:Mu,merge:tx,extend:_D,trim:wD,stripBOM:SD,inherits:bD,toFlatObject:ED,kindOf:ym,kindOfTest:rs,endsWith:kD,toArray:jD,forEachEntry:ID,matchAll:CD,isHTMLForm:RD,hasOwnProperty:bS,hasOwnProp:bS,reduceDescriptors:oT,freezeMethods:PD,toObjectSet:FD,toCamelCase:ND,noop:MD,toFiniteNumber:DD,findKey:iT,global:Ra,isContextDefined:aT,isSpecCompliantForm:LD,toJSONObject:OD,isAsyncFn:$D,isThenable:zD,setImmediate:lT,asap:BD};function be(t,e,n,r,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",e&&(this.code=e),n&&(this.config=n),r&&(this.request=r),s&&(this.response=s,this.status=s.status?s.status:null)}O.inherits(be,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:O.toJSONObject(this.config),code:this.code,status:this.status}}});const cT=be.prototype,uT={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{uT[t]={value:t}});Object.defineProperties(be,uT);Object.defineProperty(cT,"isAxiosError",{value:!0});be.from=(t,e,n,r,s,i)=>{const o=Object.create(cT);return O.toFlatObject(t,o,function(c){return c!==Error.prototype},l=>l!=="isAxiosError"),be.call(o,t.message,e,n,r,s),o.cause=t,o.name=t.name,i&&Object.assign(o,i),o};const VD=null;function nx(t){return O.isPlainObject(t)||O.isArray(t)}function dT(t){return O.endsWith(t,"[]")?t.slice(0,-2):t}function ES(t,e,n){return t?t.concat(e).map(function(s,i){return s=dT(s),!n&&i?"["+s+"]":s}).join(n?".":""):e}function UD(t){return O.isArray(t)&&!t.some(nx)}const HD=O.toFlatObject(O,{},null,function(e){return/^is[A-Z]/.test(e)});function _m(t,e,n){if(!O.isObject(t))throw new TypeError("target must be an object");e=e||new FormData,n=O.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(w,v){return!O.isUndefined(v[w])});const r=n.metaTokens,s=n.visitor||d,i=n.dots,o=n.indexes,c=(n.Blob||typeof Blob<"u"&&Blob)&&O.isSpecCompliantForm(e);if(!O.isFunction(s))throw new TypeError("visitor must be a function");function u(x){if(x===null)return"";if(O.isDate(x))return x.toISOString();if(!c&&O.isBlob(x))throw new be("Blob is not supported. Use a Buffer instead.");return O.isArrayBuffer(x)||O.isTypedArray(x)?c&&typeof Blob=="function"?new Blob([x]):Buffer.from(x):x}function d(x,w,v){let S=x;if(x&&!v&&typeof x=="object"){if(O.endsWith(w,"{}"))w=r?w:w.slice(0,-2),x=JSON.stringify(x);else if(O.isArray(x)&&UD(x)||(O.isFileList(x)||O.endsWith(w,"[]"))&&(S=O.toArray(x)))return w=dT(w),S.forEach(function(E,I){!(O.isUndefined(E)||E===null)&&e.append(o===!0?ES([w],I,i):o===null?w:w+"[]",u(E))}),!1}return nx(x)?!0:(e.append(ES(v,w,i),u(x)),!1)}const m=[],p=Object.assign(HD,{defaultVisitor:d,convertValue:u,isVisitable:nx});function g(x,w){if(!O.isUndefined(x)){if(m.indexOf(x)!==-1)throw Error("Circular reference detected in "+w.join("."));m.push(x),O.forEach(x,function(S,_){(!(O.isUndefined(S)||S===null)&&s.call(e,S,O.isString(_)?_.trim():_,w,p))===!0&&g(S,w?w.concat(_):[_])}),m.pop()}}if(!O.isObject(t))throw new TypeError("data must be an object");return g(t),e}function kS(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(r){return e[r]})}function gv(t,e){this._pairs=[],t&&_m(t,this,e)}const hT=gv.prototype;hT.append=function(e,n){this._pairs.push([e,n])};hT.toString=function(e){const n=e?function(r){return e.call(this,r,kS)}:kS;return this._pairs.map(function(s){return n(s[0])+"="+n(s[1])},"").join("&")};function GD(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function fT(t,e,n){if(!e)return t;const r=n&&n.encode||GD;O.isFunction(n)&&(n={serialize:n});const s=n&&n.serialize;let i;if(s?i=s(e,n):i=O.isURLSearchParams(e)?e.toString():new gv(e,n).toString(r),i){const o=t.indexOf("#");o!==-1&&(t=t.slice(0,o)),t+=(t.indexOf("?")===-1?"?":"&")+i}return t}class WD{constructor(){this.handlers=[]}use(e,n,r){return this.handlers.push({fulfilled:e,rejected:n,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){O.forEach(this.handlers,function(r){r!==null&&e(r)})}}const jS=WD,mT={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},qD=typeof URLSearchParams<"u"?URLSearchParams:gv,KD=typeof FormData<"u"?FormData:null,QD=typeof Blob<"u"?Blob:null,XD={isBrowser:!0,classes:{URLSearchParams:qD,FormData:KD,Blob:QD},protocols:["http","https","file","blob","url","data"]},xv=typeof window<"u"&&typeof document<"u",rx=typeof navigator=="object"&&navigator||void 0,YD=xv&&(!rx||["ReactNative","NativeScript","NS"].indexOf(rx.product)<0),JD=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),ZD=xv&&window.location.href||"http://localhost",eL=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:xv,hasStandardBrowserEnv:YD,hasStandardBrowserWebWorkerEnv:JD,navigator:rx,origin:ZD},Symbol.toStringTag,{value:"Module"})),yn={...eL,...XD};function tL(t,e){return _m(t,new yn.classes.URLSearchParams,Object.assign({visitor:function(n,r,s,i){return yn.isNode&&O.isBuffer(n)?(this.append(r,n.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)}},e))}function nL(t){return O.matchAll(/\w+|\[(\w*)]/g,t).map(e=>e[0]==="[]"?"":e[1]||e[0])}function rL(t){const e={},n=Object.keys(t);let r;const s=n.length;let i;for(r=0;r<s;r++)i=n[r],e[i]=t[i];return e}function pT(t){function e(n,r,s,i){let o=n[i++];if(o==="__proto__")return!0;const l=Number.isFinite(+o),c=i>=n.length;return o=!o&&O.isArray(s)?s.length:o,c?(O.hasOwnProp(s,o)?s[o]=[s[o],r]:s[o]=r,!l):((!s[o]||!O.isObject(s[o]))&&(s[o]=[]),e(n,r,s[o],i)&&O.isArray(s[o])&&(s[o]=rL(s[o])),!l)}if(O.isFormData(t)&&O.isFunction(t.entries)){const n={};return O.forEachEntry(t,(r,s)=>{e(nL(r),s,n,0)}),n}return null}function sL(t,e,n){if(O.isString(t))try{return(e||JSON.parse)(t),O.trim(t)}catch(r){if(r.name!=="SyntaxError")throw r}return(n||JSON.stringify)(t)}const yv={transitional:mT,adapter:["xhr","http","fetch"],transformRequest:[function(e,n){const r=n.getContentType()||"",s=r.indexOf("application/json")>-1,i=O.isObject(e);if(i&&O.isHTMLForm(e)&&(e=new FormData(e)),O.isFormData(e))return s?JSON.stringify(pT(e)):e;if(O.isArrayBuffer(e)||O.isBuffer(e)||O.isStream(e)||O.isFile(e)||O.isBlob(e)||O.isReadableStream(e))return e;if(O.isArrayBufferView(e))return e.buffer;if(O.isURLSearchParams(e))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let l;if(i){if(r.indexOf("application/x-www-form-urlencoded")>-1)return tL(e,this.formSerializer).toString();if((l=O.isFileList(e))||r.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return _m(l?{"files[]":e}:e,c&&new c,this.formSerializer)}}return i||s?(n.setContentType("application/json",!1),sL(e)):e}],transformResponse:[function(e){const n=this.transitional||yv.transitional,r=n&&n.forcedJSONParsing,s=this.responseType==="json";if(O.isResponse(e)||O.isReadableStream(e))return e;if(e&&O.isString(e)&&(r&&!this.responseType||s)){const o=!(n&&n.silentJSONParsing)&&s;try{return JSON.parse(e)}catch(l){if(o)throw l.name==="SyntaxError"?be.from(l,be.ERR_BAD_RESPONSE,this,null,this.response):l}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:yn.classes.FormData,Blob:yn.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};O.forEach(["delete","get","head","post","put","patch"],t=>{yv.headers[t]={}});const vv=yv,iL=O.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),aL=t=>{const e={};let n,r,s;return t&&t.split(`
`).forEach(function(o){s=o.indexOf(":"),n=o.substring(0,s).trim().toLowerCase(),r=o.substring(s+1).trim(),!(!n||e[n]&&iL[n])&&(n==="set-cookie"?e[n]?e[n].push(r):e[n]=[r]:e[n]=e[n]?e[n]+", "+r:r)}),e},TS=Symbol("internals");function mc(t){return t&&String(t).trim().toLowerCase()}function _h(t){return t===!1||t==null?t:O.isArray(t)?t.map(_h):String(t)}function oL(t){const e=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(t);)e[r[1]]=r[2];return e}const lL=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function pg(t,e,n,r,s){if(O.isFunction(r))return r.call(this,e,n);if(s&&(e=n),!!O.isString(e)){if(O.isString(r))return e.indexOf(r)!==-1;if(O.isRegExp(r))return r.test(e)}}function cL(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,n,r)=>n.toUpperCase()+r)}function uL(t,e){const n=O.toCamelCase(" "+e);["get","set","has"].forEach(r=>{Object.defineProperty(t,r+n,{value:function(s,i,o){return this[r].call(this,e,s,i,o)},configurable:!0})})}class Sm{constructor(e){e&&this.set(e)}set(e,n,r){const s=this;function i(l,c,u){const d=mc(c);if(!d)throw new Error("header name must be a non-empty string");const m=O.findKey(s,d);(!m||s[m]===void 0||u===!0||u===void 0&&s[m]!==!1)&&(s[m||c]=_h(l))}const o=(l,c)=>O.forEach(l,(u,d)=>i(u,d,c));if(O.isPlainObject(e)||e instanceof this.constructor)o(e,n);else if(O.isString(e)&&(e=e.trim())&&!lL(e))o(aL(e),n);else if(O.isHeaders(e))for(const[l,c]of e.entries())i(c,l,r);else e!=null&&i(n,e,r);return this}get(e,n){if(e=mc(e),e){const r=O.findKey(this,e);if(r){const s=this[r];if(!n)return s;if(n===!0)return oL(s);if(O.isFunction(n))return n.call(this,s,r);if(O.isRegExp(n))return n.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,n){if(e=mc(e),e){const r=O.findKey(this,e);return!!(r&&this[r]!==void 0&&(!n||pg(this,this[r],r,n)))}return!1}delete(e,n){const r=this;let s=!1;function i(o){if(o=mc(o),o){const l=O.findKey(r,o);l&&(!n||pg(r,r[l],l,n))&&(delete r[l],s=!0)}}return O.isArray(e)?e.forEach(i):i(e),s}clear(e){const n=Object.keys(this);let r=n.length,s=!1;for(;r--;){const i=n[r];(!e||pg(this,this[i],i,e,!0))&&(delete this[i],s=!0)}return s}normalize(e){const n=this,r={};return O.forEach(this,(s,i)=>{const o=O.findKey(r,i);if(o){n[o]=_h(s),delete n[i];return}const l=e?cL(i):String(i).trim();l!==i&&delete n[i],n[l]=_h(s),r[l]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const n=Object.create(null);return O.forEach(this,(r,s)=>{r!=null&&r!==!1&&(n[s]=e&&O.isArray(r)?r.join(", "):r)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,n])=>e+": "+n).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...n){const r=new this(e);return n.forEach(s=>r.set(s)),r}static accessor(e){const r=(this[TS]=this[TS]={accessors:{}}).accessors,s=this.prototype;function i(o){const l=mc(o);r[l]||(uL(s,o),r[l]=!0)}return O.isArray(e)?e.forEach(i):i(e),this}}Sm.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);O.reduceDescriptors(Sm.prototype,({value:t},e)=>{let n=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(r){this[n]=r}}});O.freezeMethods(Sm);const Jr=Sm;function gg(t,e){const n=this||vv,r=e||n,s=Jr.from(r.headers);let i=r.data;return O.forEach(t,function(l){i=l.call(n,i,s.normalize(),e?e.status:void 0)}),s.normalize(),i}function gT(t){return!!(t&&t.__CANCEL__)}function Pl(t,e,n){be.call(this,t??"canceled",be.ERR_CANCELED,e,n),this.name="CanceledError"}O.inherits(Pl,be,{__CANCEL__:!0});function xT(t,e,n){const r=n.config.validateStatus;!n.status||!r||r(n.status)?t(n):e(new be("Request failed with status code "+n.status,[be.ERR_BAD_REQUEST,be.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function dL(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}function hL(t,e){t=t||10;const n=new Array(t),r=new Array(t);let s=0,i=0,o;return e=e!==void 0?e:1e3,function(c){const u=Date.now(),d=r[i];o||(o=u),n[s]=c,r[s]=u;let m=i,p=0;for(;m!==s;)p+=n[m++],m=m%t;if(s=(s+1)%t,s===i&&(i=(i+1)%t),u-o<e)return;const g=d&&u-d;return g?Math.round(p*1e3/g):void 0}}function fL(t,e){let n=0,r=1e3/e,s,i;const o=(u,d=Date.now())=>{n=d,s=null,i&&(clearTimeout(i),i=null),t.apply(null,u)};return[(...u)=>{const d=Date.now(),m=d-n;m>=r?o(u,d):(s=u,i||(i=setTimeout(()=>{i=null,o(s)},r-m)))},()=>s&&o(s)]}const df=(t,e,n=3)=>{let r=0;const s=hL(50,250);return fL(i=>{const o=i.loaded,l=i.lengthComputable?i.total:void 0,c=o-r,u=s(c),d=o<=l;r=o;const m={loaded:o,total:l,progress:l?o/l:void 0,bytes:c,rate:u||void 0,estimated:u&&l&&d?(l-o)/u:void 0,event:i,lengthComputable:l!=null,[e?"download":"upload"]:!0};t(m)},n)},IS=(t,e)=>{const n=t!=null;return[r=>e[0]({lengthComputable:n,total:t,loaded:r}),e[1]]},CS=t=>(...e)=>O.asap(()=>t(...e)),mL=yn.hasStandardBrowserEnv?((t,e)=>n=>(n=new URL(n,yn.origin),t.protocol===n.protocol&&t.host===n.host&&(e||t.port===n.port)))(new URL(yn.origin),yn.navigator&&/(msie|trident)/i.test(yn.navigator.userAgent)):()=>!0,pL=yn.hasStandardBrowserEnv?{write(t,e,n,r,s,i){const o=[t+"="+encodeURIComponent(e)];O.isNumber(n)&&o.push("expires="+new Date(n).toGMTString()),O.isString(r)&&o.push("path="+r),O.isString(s)&&o.push("domain="+s),i===!0&&o.push("secure"),document.cookie=o.join("; ")},read(t){const e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function gL(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function xL(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}function yT(t,e,n){let r=!gL(e);return t&&r||n==!1?xL(t,e):e}const RS=t=>t instanceof Jr?{...t}:t;function Va(t,e){e=e||{};const n={};function r(u,d,m,p){return O.isPlainObject(u)&&O.isPlainObject(d)?O.merge.call({caseless:p},u,d):O.isPlainObject(d)?O.merge({},d):O.isArray(d)?d.slice():d}function s(u,d,m,p){if(O.isUndefined(d)){if(!O.isUndefined(u))return r(void 0,u,m,p)}else return r(u,d,m,p)}function i(u,d){if(!O.isUndefined(d))return r(void 0,d)}function o(u,d){if(O.isUndefined(d)){if(!O.isUndefined(u))return r(void 0,u)}else return r(void 0,d)}function l(u,d,m){if(m in e)return r(u,d);if(m in t)return r(void 0,u)}const c={url:i,method:i,data:i,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:l,headers:(u,d,m)=>s(RS(u),RS(d),m,!0)};return O.forEach(Object.keys(Object.assign({},t,e)),function(d){const m=c[d]||s,p=m(t[d],e[d],d);O.isUndefined(p)&&m!==l||(n[d]=p)}),n}const vT=t=>{const e=Va({},t);let{data:n,withXSRFToken:r,xsrfHeaderName:s,xsrfCookieName:i,headers:o,auth:l}=e;e.headers=o=Jr.from(o),e.url=fT(yT(e.baseURL,e.url),t.params,t.paramsSerializer),l&&o.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):"")));let c;if(O.isFormData(n)){if(yn.hasStandardBrowserEnv||yn.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((c=o.getContentType())!==!1){const[u,...d]=c?c.split(";").map(m=>m.trim()).filter(Boolean):[];o.setContentType([u||"multipart/form-data",...d].join("; "))}}if(yn.hasStandardBrowserEnv&&(r&&O.isFunction(r)&&(r=r(e)),r||r!==!1&&mL(e.url))){const u=s&&i&&pL.read(i);u&&o.set(s,u)}return e},yL=typeof XMLHttpRequest<"u",vL=yL&&function(t){return new Promise(function(n,r){const s=vT(t);let i=s.data;const o=Jr.from(s.headers).normalize();let{responseType:l,onUploadProgress:c,onDownloadProgress:u}=s,d,m,p,g,x;function w(){g&&g(),x&&x(),s.cancelToken&&s.cancelToken.unsubscribe(d),s.signal&&s.signal.removeEventListener("abort",d)}let v=new XMLHttpRequest;v.open(s.method.toUpperCase(),s.url,!0),v.timeout=s.timeout;function S(){if(!v)return;const E=Jr.from("getAllResponseHeaders"in v&&v.getAllResponseHeaders()),P={data:!l||l==="text"||l==="json"?v.responseText:v.response,status:v.status,statusText:v.statusText,headers:E,config:t,request:v};xT(function(j){n(j),w()},function(j){r(j),w()},P),v=null}"onloadend"in v?v.onloadend=S:v.onreadystatechange=function(){!v||v.readyState!==4||v.status===0&&!(v.responseURL&&v.responseURL.indexOf("file:")===0)||setTimeout(S)},v.onabort=function(){v&&(r(new be("Request aborted",be.ECONNABORTED,t,v)),v=null)},v.onerror=function(){r(new be("Network Error",be.ERR_NETWORK,t,v)),v=null},v.ontimeout=function(){let I=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const P=s.transitional||mT;s.timeoutErrorMessage&&(I=s.timeoutErrorMessage),r(new be(I,P.clarifyTimeoutError?be.ETIMEDOUT:be.ECONNABORTED,t,v)),v=null},i===void 0&&o.setContentType(null),"setRequestHeader"in v&&O.forEach(o.toJSON(),function(I,P){v.setRequestHeader(P,I)}),O.isUndefined(s.withCredentials)||(v.withCredentials=!!s.withCredentials),l&&l!=="json"&&(v.responseType=s.responseType),u&&([p,x]=df(u,!0),v.addEventListener("progress",p)),c&&v.upload&&([m,g]=df(c),v.upload.addEventListener("progress",m),v.upload.addEventListener("loadend",g)),(s.cancelToken||s.signal)&&(d=E=>{v&&(r(!E||E.type?new Pl(null,t,v):E),v.abort(),v=null)},s.cancelToken&&s.cancelToken.subscribe(d),s.signal&&(s.signal.aborted?d():s.signal.addEventListener("abort",d)));const _=dL(s.url);if(_&&yn.protocols.indexOf(_)===-1){r(new be("Unsupported protocol "+_+":",be.ERR_BAD_REQUEST,t));return}v.send(i||null)})},wL=(t,e)=>{const{length:n}=t=t?t.filter(Boolean):[];if(e||n){let r=new AbortController,s;const i=function(u){if(!s){s=!0,l();const d=u instanceof Error?u:this.reason;r.abort(d instanceof be?d:new Pl(d instanceof Error?d.message:d))}};let o=e&&setTimeout(()=>{o=null,i(new be(`timeout ${e} of ms exceeded`,be.ETIMEDOUT))},e);const l=()=>{t&&(o&&clearTimeout(o),o=null,t.forEach(u=>{u.unsubscribe?u.unsubscribe(i):u.removeEventListener("abort",i)}),t=null)};t.forEach(u=>u.addEventListener("abort",i));const{signal:c}=r;return c.unsubscribe=()=>O.asap(l),c}},_L=wL,SL=function*(t,e){let n=t.byteLength;if(!e||n<e){yield t;return}let r=0,s;for(;r<n;)s=r+e,yield t.slice(r,s),r=s},bL=async function*(t,e){for await(const n of EL(t))yield*SL(n,e)},EL=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const e=t.getReader();try{for(;;){const{done:n,value:r}=await e.read();if(n)break;yield r}}finally{await e.cancel()}},NS=(t,e,n,r)=>{const s=bL(t,e);let i=0,o,l=c=>{o||(o=!0,r&&r(c))};return new ReadableStream({async pull(c){try{const{done:u,value:d}=await s.next();if(u){l(),c.close();return}let m=d.byteLength;if(n){let p=i+=m;n(p)}c.enqueue(new Uint8Array(d))}catch(u){throw l(u),u}},cancel(c){return l(c),s.return()}},{highWaterMark:2})},bm=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",wT=bm&&typeof ReadableStream=="function",kL=bm&&(typeof TextEncoder=="function"?(t=>e=>t.encode(e))(new TextEncoder):async t=>new Uint8Array(await new Response(t).arrayBuffer())),_T=(t,...e)=>{try{return!!t(...e)}catch{return!1}},jL=wT&&_T(()=>{let t=!1;const e=new Request(yn.origin,{body:new ReadableStream,method:"POST",get duplex(){return t=!0,"half"}}).headers.has("Content-Type");return t&&!e}),AS=64*1024,sx=wT&&_T(()=>O.isReadableStream(new Response("").body)),hf={stream:sx&&(t=>t.body)};bm&&(t=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!hf[e]&&(hf[e]=O.isFunction(t[e])?n=>n[e]():(n,r)=>{throw new be(`Response type '${e}' is not supported`,be.ERR_NOT_SUPPORT,r)})})})(new Response);const TL=async t=>{if(t==null)return 0;if(O.isBlob(t))return t.size;if(O.isSpecCompliantForm(t))return(await new Request(yn.origin,{method:"POST",body:t}).arrayBuffer()).byteLength;if(O.isArrayBufferView(t)||O.isArrayBuffer(t))return t.byteLength;if(O.isURLSearchParams(t)&&(t=t+""),O.isString(t))return(await kL(t)).byteLength},IL=async(t,e)=>{const n=O.toFiniteNumber(t.getContentLength());return n??TL(e)},CL=bm&&(async t=>{let{url:e,method:n,data:r,signal:s,cancelToken:i,timeout:o,onDownloadProgress:l,onUploadProgress:c,responseType:u,headers:d,withCredentials:m="same-origin",fetchOptions:p}=vT(t);u=u?(u+"").toLowerCase():"text";let g=_L([s,i&&i.toAbortSignal()],o),x;const w=g&&g.unsubscribe&&(()=>{g.unsubscribe()});let v;try{if(c&&jL&&n!=="get"&&n!=="head"&&(v=await IL(d,r))!==0){let P=new Request(e,{method:"POST",body:r,duplex:"half"}),F;if(O.isFormData(r)&&(F=P.headers.get("content-type"))&&d.setContentType(F),P.body){const[j,k]=IS(v,df(CS(c)));r=NS(P.body,AS,j,k)}}O.isString(m)||(m=m?"include":"omit");const S="credentials"in Request.prototype;x=new Request(e,{...p,signal:g,method:n.toUpperCase(),headers:d.normalize().toJSON(),body:r,duplex:"half",credentials:S?m:void 0});let _=await fetch(x);const E=sx&&(u==="stream"||u==="response");if(sx&&(l||E&&w)){const P={};["status","statusText","headers"].forEach(C=>{P[C]=_[C]});const F=O.toFiniteNumber(_.headers.get("content-length")),[j,k]=l&&IS(F,df(CS(l),!0))||[];_=new Response(NS(_.body,AS,j,()=>{k&&k(),w&&w()}),P)}u=u||"text";let I=await hf[O.findKey(hf,u)||"text"](_,t);return!E&&w&&w(),await new Promise((P,F)=>{xT(P,F,{data:I,headers:Jr.from(_.headers),status:_.status,statusText:_.statusText,config:t,request:x})})}catch(S){throw w&&w(),S&&S.name==="TypeError"&&/fetch/i.test(S.message)?Object.assign(new be("Network Error",be.ERR_NETWORK,t,x),{cause:S.cause||S}):be.from(S,S&&S.code,t,x)}}),ix={http:VD,xhr:vL,fetch:CL};O.forEach(ix,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch{}Object.defineProperty(t,"adapterName",{value:e})}});const PS=t=>`- ${t}`,RL=t=>O.isFunction(t)||t===null||t===!1,ST={getAdapter:t=>{t=O.isArray(t)?t:[t];const{length:e}=t;let n,r;const s={};for(let i=0;i<e;i++){n=t[i];let o;if(r=n,!RL(n)&&(r=ix[(o=String(n)).toLowerCase()],r===void 0))throw new be(`Unknown adapter '${o}'`);if(r)break;s[o||"#"+i]=r}if(!r){const i=Object.entries(s).map(([l,c])=>`adapter ${l} `+(c===!1?"is not supported by the environment":"is not available in the build"));let o=e?i.length>1?`since :
`+i.map(PS).join(`
`):" "+PS(i[0]):"as no adapter specified";throw new be("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return r},adapters:ix};function xg(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new Pl(null,t)}function FS(t){return xg(t),t.headers=Jr.from(t.headers),t.data=gg.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),ST.getAdapter(t.adapter||vv.adapter)(t).then(function(r){return xg(t),r.data=gg.call(t,t.transformResponse,r),r.headers=Jr.from(r.headers),r},function(r){return gT(r)||(xg(t),r&&r.response&&(r.response.data=gg.call(t,t.transformResponse,r.response),r.response.headers=Jr.from(r.response.headers))),Promise.reject(r)})}const bT="1.8.1",Em={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{Em[t]=function(r){return typeof r===t||"a"+(e<1?"n ":" ")+t}});const MS={};Em.transitional=function(e,n,r){function s(i,o){return"[Axios v"+bT+"] Transitional option '"+i+"'"+o+(r?". "+r:"")}return(i,o,l)=>{if(e===!1)throw new be(s(o," has been removed"+(n?" in "+n:"")),be.ERR_DEPRECATED);return n&&!MS[o]&&(MS[o]=!0,console.warn(s(o," has been deprecated since v"+n+" and will be removed in the near future"))),e?e(i,o,l):!0}};Em.spelling=function(e){return(n,r)=>(console.warn(`${r} is likely a misspelling of ${e}`),!0)};function NL(t,e,n){if(typeof t!="object")throw new be("options must be an object",be.ERR_BAD_OPTION_VALUE);const r=Object.keys(t);let s=r.length;for(;s-- >0;){const i=r[s],o=e[i];if(o){const l=t[i],c=l===void 0||o(l,i,t);if(c!==!0)throw new be("option "+i+" must be "+c,be.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new be("Unknown option "+i,be.ERR_BAD_OPTION)}}const Sh={assertOptions:NL,validators:Em},cs=Sh.validators;class ff{constructor(e){this.defaults=e,this.interceptors={request:new jS,response:new jS}}async request(e,n){try{return await this._request(e,n)}catch(r){if(r instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const i=s.stack?s.stack.replace(/^.+\n/,""):"";try{r.stack?i&&!String(r.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+i):r.stack=i}catch{}}throw r}}_request(e,n){typeof e=="string"?(n=n||{},n.url=e):n=e||{},n=Va(this.defaults,n);const{transitional:r,paramsSerializer:s,headers:i}=n;r!==void 0&&Sh.assertOptions(r,{silentJSONParsing:cs.transitional(cs.boolean),forcedJSONParsing:cs.transitional(cs.boolean),clarifyTimeoutError:cs.transitional(cs.boolean)},!1),s!=null&&(O.isFunction(s)?n.paramsSerializer={serialize:s}:Sh.assertOptions(s,{encode:cs.function,serialize:cs.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),Sh.assertOptions(n,{baseUrl:cs.spelling("baseURL"),withXsrfToken:cs.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let o=i&&O.merge(i.common,i[n.method]);i&&O.forEach(["delete","get","head","post","put","patch","common"],x=>{delete i[x]}),n.headers=Jr.concat(o,i);const l=[];let c=!0;this.interceptors.request.forEach(function(w){typeof w.runWhen=="function"&&w.runWhen(n)===!1||(c=c&&w.synchronous,l.unshift(w.fulfilled,w.rejected))});const u=[];this.interceptors.response.forEach(function(w){u.push(w.fulfilled,w.rejected)});let d,m=0,p;if(!c){const x=[FS.bind(this),void 0];for(x.unshift.apply(x,l),x.push.apply(x,u),p=x.length,d=Promise.resolve(n);m<p;)d=d.then(x[m++],x[m++]);return d}p=l.length;let g=n;for(m=0;m<p;){const x=l[m++],w=l[m++];try{g=x(g)}catch(v){w.call(this,v);break}}try{d=FS.call(this,g)}catch(x){return Promise.reject(x)}for(m=0,p=u.length;m<p;)d=d.then(u[m++],u[m++]);return d}getUri(e){e=Va(this.defaults,e);const n=yT(e.baseURL,e.url,e.allowAbsoluteUrls);return fT(n,e.params,e.paramsSerializer)}}O.forEach(["delete","get","head","options"],function(e){ff.prototype[e]=function(n,r){return this.request(Va(r||{},{method:e,url:n,data:(r||{}).data}))}});O.forEach(["post","put","patch"],function(e){function n(r){return function(i,o,l){return this.request(Va(l||{},{method:e,headers:r?{"Content-Type":"multipart/form-data"}:{},url:i,data:o}))}}ff.prototype[e]=n(),ff.prototype[e+"Form"]=n(!0)});const bh=ff;class wv{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(i){n=i});const r=this;this.promise.then(s=>{if(!r._listeners)return;let i=r._listeners.length;for(;i-- >0;)r._listeners[i](s);r._listeners=null}),this.promise.then=s=>{let i;const o=new Promise(l=>{r.subscribe(l),i=l}).then(s);return o.cancel=function(){r.unsubscribe(i)},o},e(function(i,o,l){r.reason||(r.reason=new Pl(i,o,l),n(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const n=this._listeners.indexOf(e);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const e=new AbortController,n=r=>{e.abort(r)};return this.subscribe(n),e.signal.unsubscribe=()=>this.unsubscribe(n),e.signal}static source(){let e;return{token:new wv(function(s){e=s}),cancel:e}}}const AL=wv;function PL(t){return function(n){return t.apply(null,n)}}function FL(t){return O.isObject(t)&&t.isAxiosError===!0}const ax={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(ax).forEach(([t,e])=>{ax[e]=t});const ML=ax;function ET(t){const e=new bh(t),n=nT(bh.prototype.request,e);return O.extend(n,bh.prototype,e,{allOwnKeys:!0}),O.extend(n,e,null,{allOwnKeys:!0}),n.create=function(s){return ET(Va(t,s))},n}const Ct=ET(vv);Ct.Axios=bh;Ct.CanceledError=Pl;Ct.CancelToken=AL;Ct.isCancel=gT;Ct.VERSION=bT;Ct.toFormData=_m;Ct.AxiosError=be;Ct.Cancel=Ct.CanceledError;Ct.all=function(e){return Promise.all(e)};Ct.spread=PL;Ct.isAxiosError=FL;Ct.mergeConfig=Va;Ct.AxiosHeaders=Jr;Ct.formToJSON=t=>pT(O.isHTMLForm(t)?new FormData(t):t);Ct.getAdapter=ST.getAdapter;Ct.HttpStatusCode=ML;Ct.default=Ct;const DL=Ct;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kT=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},LL=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],l=t[n++],c=((s&7)<<18|(i&63)<<12|(o&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},jT={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,l=o?t[s+1]:0,c=s+2<t.length,u=c?t[s+2]:0,d=i>>2,m=(i&3)<<4|l>>4;let p=(l&15)<<2|u>>6,g=u&63;c||(g=64,o||(p=64)),r.push(n[d],n[m],n[p],n[g])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(kT(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):LL(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],l=s<t.length?n[t.charAt(s)]:0;++s;const u=s<t.length?n[t.charAt(s)]:64;++s;const m=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||l==null||u==null||m==null)throw new OL;const p=i<<2|l>>4;if(r.push(p),u!==64){const g=l<<4&240|u>>2;if(r.push(g),m!==64){const x=u<<6&192|m;r.push(x)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class OL extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const $L=function(t){const e=kT(t);return jT.encodeByteArray(e,!0)},mf=function(t){return $L(t).replace(/\./g,"")},TT=function(t){try{return jT.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zL(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BL=()=>zL().__FIREBASE_DEFAULTS__,VL=()=>{if(typeof process>"u"||typeof process.env>"u")return;const t={}.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},UL=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&TT(t[1]);return e&&JSON.parse(e)},km=()=>{try{return BL()||VL()||UL()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},IT=t=>{var e,n;return(n=(e=km())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},HL=t=>{const e=IT(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},CT=()=>{var t;return(t=km())===null||t===void 0?void 0:t.config},RT=t=>{var e;return(e=km())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GL{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WL(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t),l="";return[mf(JSON.stringify(n)),mf(JSON.stringify(o)),l].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function qL(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Sn())}function KL(){var t;const e=(t=km())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function QL(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function XL(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function YL(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function JL(){const t=Sn();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function ZL(){return!KL()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function e6(){try{return typeof indexedDB=="object"}catch{return!1}}function t6(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n6="FirebaseError";class hi extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=n6,Object.setPrototypeOf(this,hi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Du.prototype.create)}}class Du{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?r6(i,r):"Error",l=`${this.serviceName}: ${o} (${s}).`;return new hi(s,l,r)}}function r6(t,e){return t.replace(s6,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const s6=/\{\$([^}]+)}/g;function i6(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function pf(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(DS(i)&&DS(o)){if(!pf(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function DS(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lu(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function a6(t,e){const n=new o6(t,e);return n.subscribe.bind(n)}class o6{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");l6(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=yg),s.error===void 0&&(s.error=yg),s.complete===void 0&&(s.complete=yg);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function l6(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function yg(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rt(t){return t&&t._delegate?t._delegate:t}class Ua{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ba="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let c6=class{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new GL;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(d6(e))try{this.getOrInitializeService({instanceIdentifier:ba})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=ba){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ba){return this.instances.has(e)}getOptions(e=ba){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);r===l&&o.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:u6(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=ba){return this.component?this.component.multipleInstances?e:ba:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function u6(t){return t===ba?void 0:t}function d6(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h6{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new c6(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Pe;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Pe||(Pe={}));const f6={debug:Pe.DEBUG,verbose:Pe.VERBOSE,info:Pe.INFO,warn:Pe.WARN,error:Pe.ERROR,silent:Pe.SILENT},m6=Pe.INFO,p6={[Pe.DEBUG]:"log",[Pe.VERBOSE]:"log",[Pe.INFO]:"info",[Pe.WARN]:"warn",[Pe.ERROR]:"error"},g6=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=p6[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class _v{constructor(e){this.name=e,this._logLevel=m6,this._logHandler=g6,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Pe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?f6[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Pe.DEBUG,...e),this._logHandler(this,Pe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Pe.VERBOSE,...e),this._logHandler(this,Pe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Pe.INFO,...e),this._logHandler(this,Pe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Pe.WARN,...e),this._logHandler(this,Pe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Pe.ERROR,...e),this._logHandler(this,Pe.ERROR,...e)}}const x6=(t,e)=>e.some(n=>t instanceof n);let LS,OS;function y6(){return LS||(LS=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function v6(){return OS||(OS=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const NT=new WeakMap,ox=new WeakMap,AT=new WeakMap,vg=new WeakMap,Sv=new WeakMap;function w6(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(Gi(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&NT.set(n,t)}).catch(()=>{}),Sv.set(e,t),e}function _6(t){if(ox.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});ox.set(t,e)}let lx={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return ox.get(t);if(e==="objectStoreNames")return t.objectStoreNames||AT.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Gi(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function S6(t){lx=t(lx)}function b6(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(wg(this),e,...n);return AT.set(r,e.sort?e.sort():[e]),Gi(r)}:v6().includes(t)?function(...e){return t.apply(wg(this),e),Gi(NT.get(this))}:function(...e){return Gi(t.apply(wg(this),e))}}function E6(t){return typeof t=="function"?b6(t):(t instanceof IDBTransaction&&_6(t),x6(t,y6())?new Proxy(t,lx):t)}function Gi(t){if(t instanceof IDBRequest)return w6(t);if(vg.has(t))return vg.get(t);const e=E6(t);return e!==t&&(vg.set(t,e),Sv.set(e,t)),e}const wg=t=>Sv.get(t);function k6(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),l=Gi(o);return r&&o.addEventListener("upgradeneeded",c=>{r(Gi(o.result),c.oldVersion,c.newVersion,Gi(o.transaction),c)}),n&&o.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),l.then(c=>{i&&c.addEventListener("close",()=>i()),s&&c.addEventListener("versionchange",u=>s(u.oldVersion,u.newVersion,u))}).catch(()=>{}),l}const j6=["get","getKey","getAll","getAllKeys","count"],T6=["put","add","delete","clear"],_g=new Map;function $S(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(_g.get(e))return _g.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=T6.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||j6.includes(n)))return;const i=async function(o,...l){const c=this.transaction(o,s?"readwrite":"readonly");let u=c.store;return r&&(u=u.index(l.shift())),(await Promise.all([u[n](...l),s&&c.done]))[0]};return _g.set(e,i),i}S6(t=>({...t,get:(e,n,r)=>$S(e,n)||t.get(e,n,r),has:(e,n)=>!!$S(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I6{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(C6(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function C6(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const cx="@firebase/app",zS="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ni=new _v("@firebase/app"),R6="@firebase/app-compat",N6="@firebase/analytics-compat",A6="@firebase/analytics",P6="@firebase/app-check-compat",F6="@firebase/app-check",M6="@firebase/auth",D6="@firebase/auth-compat",L6="@firebase/database",O6="@firebase/data-connect",$6="@firebase/database-compat",z6="@firebase/functions",B6="@firebase/functions-compat",V6="@firebase/installations",U6="@firebase/installations-compat",H6="@firebase/messaging",G6="@firebase/messaging-compat",W6="@firebase/performance",q6="@firebase/performance-compat",K6="@firebase/remote-config",Q6="@firebase/remote-config-compat",X6="@firebase/storage",Y6="@firebase/storage-compat",J6="@firebase/firestore",Z6="@firebase/vertexai-preview",eO="@firebase/firestore-compat",tO="firebase",nO="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ux="[DEFAULT]",rO={[cx]:"fire-core",[R6]:"fire-core-compat",[A6]:"fire-analytics",[N6]:"fire-analytics-compat",[F6]:"fire-app-check",[P6]:"fire-app-check-compat",[M6]:"fire-auth",[D6]:"fire-auth-compat",[L6]:"fire-rtdb",[O6]:"fire-data-connect",[$6]:"fire-rtdb-compat",[z6]:"fire-fn",[B6]:"fire-fn-compat",[V6]:"fire-iid",[U6]:"fire-iid-compat",[H6]:"fire-fcm",[G6]:"fire-fcm-compat",[W6]:"fire-perf",[q6]:"fire-perf-compat",[K6]:"fire-rc",[Q6]:"fire-rc-compat",[X6]:"fire-gcs",[Y6]:"fire-gcs-compat",[J6]:"fire-fst",[eO]:"fire-fst-compat",[Z6]:"fire-vertex","fire-js":"fire-js",[tO]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gf=new Map,sO=new Map,dx=new Map;function BS(t,e){try{t.container.addComponent(e)}catch(n){ni.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function hl(t){const e=t.name;if(dx.has(e))return ni.debug(`There were multiple attempts to register component ${e}.`),!1;dx.set(e,t);for(const n of gf.values())BS(n,t);for(const n of sO.values())BS(n,t);return!0}function bv(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Bs(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iO={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Wi=new Du("app","Firebase",iO);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aO{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Ua("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Wi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fl=nO;function PT(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:ux,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw Wi.create("bad-app-name",{appName:String(s)});if(n||(n=CT()),!n)throw Wi.create("no-options");const i=gf.get(s);if(i){if(pf(n,i.options)&&pf(r,i.config))return i;throw Wi.create("duplicate-app",{appName:s})}const o=new h6(s);for(const c of dx.values())o.addComponent(c);const l=new aO(n,r,o);return gf.set(s,l),l}function FT(t=ux){const e=gf.get(t);if(!e&&t===ux&&CT())return PT();if(!e)throw Wi.create("no-app",{appName:t});return e}function qi(t,e,n){var r;let s=(r=rO[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const l=[`Unable to register library "${s}" with version "${e}":`];i&&l.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ni.warn(l.join(" "));return}hl(new Ua(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oO="firebase-heartbeat-database",lO=1,ou="firebase-heartbeat-store";let Sg=null;function MT(){return Sg||(Sg=k6(oO,lO,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(ou)}catch(n){console.warn(n)}}}}).catch(t=>{throw Wi.create("idb-open",{originalErrorMessage:t.message})})),Sg}async function cO(t){try{const n=(await MT()).transaction(ou),r=await n.objectStore(ou).get(DT(t));return await n.done,r}catch(e){if(e instanceof hi)ni.warn(e.message);else{const n=Wi.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});ni.warn(n.message)}}}async function VS(t,e){try{const r=(await MT()).transaction(ou,"readwrite");await r.objectStore(ou).put(e,DT(t)),await r.done}catch(n){if(n instanceof hi)ni.warn(n.message);else{const r=Wi.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});ni.warn(r.message)}}}function DT(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uO=1024,dO=30*24*60*60*1e3;class hO{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new mO(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=US();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const l=new Date(o.date).valueOf();return Date.now()-l<=dO}),this._storage.overwrite(this._heartbeatsCache))}catch(r){ni.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=US(),{heartbeatsToSend:r,unsentEntries:s}=fO(this._heartbeatsCache.heartbeats),i=mf(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return ni.warn(n),""}}}function US(){return new Date().toISOString().substring(0,10)}function fO(t,e=uO){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),HS(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),HS(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class mO{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return e6()?t6().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await cO(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return VS(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return VS(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function HS(t){return mf(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pO(t){hl(new Ua("platform-logger",e=>new I6(e),"PRIVATE")),hl(new Ua("heartbeat",e=>new hO(e),"PRIVATE")),qi(cx,zS,t),qi(cx,zS,"esm2017"),qi("fire-js","")}pO("");var GS=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ma,LT;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(j,k){function C(){}C.prototype=k.prototype,j.D=k.prototype,j.prototype=new C,j.prototype.constructor=j,j.C=function(R,N,M){for(var A=Array(arguments.length-2),fe=2;fe<arguments.length;fe++)A[fe-2]=arguments[fe];return k.prototype[N].apply(R,A)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(j,k,C){C||(C=0);var R=Array(16);if(typeof k=="string")for(var N=0;16>N;++N)R[N]=k.charCodeAt(C++)|k.charCodeAt(C++)<<8|k.charCodeAt(C++)<<16|k.charCodeAt(C++)<<24;else for(N=0;16>N;++N)R[N]=k[C++]|k[C++]<<8|k[C++]<<16|k[C++]<<24;k=j.g[0],C=j.g[1],N=j.g[2];var M=j.g[3],A=k+(M^C&(N^M))+R[0]+3614090360&4294967295;k=C+(A<<7&4294967295|A>>>25),A=M+(N^k&(C^N))+R[1]+3905402710&4294967295,M=k+(A<<12&4294967295|A>>>20),A=N+(C^M&(k^C))+R[2]+606105819&4294967295,N=M+(A<<17&4294967295|A>>>15),A=C+(k^N&(M^k))+R[3]+3250441966&4294967295,C=N+(A<<22&4294967295|A>>>10),A=k+(M^C&(N^M))+R[4]+4118548399&4294967295,k=C+(A<<7&4294967295|A>>>25),A=M+(N^k&(C^N))+R[5]+1200080426&4294967295,M=k+(A<<12&4294967295|A>>>20),A=N+(C^M&(k^C))+R[6]+2821735955&4294967295,N=M+(A<<17&4294967295|A>>>15),A=C+(k^N&(M^k))+R[7]+4249261313&4294967295,C=N+(A<<22&4294967295|A>>>10),A=k+(M^C&(N^M))+R[8]+1770035416&4294967295,k=C+(A<<7&4294967295|A>>>25),A=M+(N^k&(C^N))+R[9]+2336552879&4294967295,M=k+(A<<12&4294967295|A>>>20),A=N+(C^M&(k^C))+R[10]+4294925233&4294967295,N=M+(A<<17&4294967295|A>>>15),A=C+(k^N&(M^k))+R[11]+2304563134&4294967295,C=N+(A<<22&4294967295|A>>>10),A=k+(M^C&(N^M))+R[12]+1804603682&4294967295,k=C+(A<<7&4294967295|A>>>25),A=M+(N^k&(C^N))+R[13]+4254626195&4294967295,M=k+(A<<12&4294967295|A>>>20),A=N+(C^M&(k^C))+R[14]+2792965006&4294967295,N=M+(A<<17&4294967295|A>>>15),A=C+(k^N&(M^k))+R[15]+1236535329&4294967295,C=N+(A<<22&4294967295|A>>>10),A=k+(N^M&(C^N))+R[1]+4129170786&4294967295,k=C+(A<<5&4294967295|A>>>27),A=M+(C^N&(k^C))+R[6]+3225465664&4294967295,M=k+(A<<9&4294967295|A>>>23),A=N+(k^C&(M^k))+R[11]+643717713&4294967295,N=M+(A<<14&4294967295|A>>>18),A=C+(M^k&(N^M))+R[0]+3921069994&4294967295,C=N+(A<<20&4294967295|A>>>12),A=k+(N^M&(C^N))+R[5]+3593408605&4294967295,k=C+(A<<5&4294967295|A>>>27),A=M+(C^N&(k^C))+R[10]+38016083&4294967295,M=k+(A<<9&4294967295|A>>>23),A=N+(k^C&(M^k))+R[15]+3634488961&4294967295,N=M+(A<<14&4294967295|A>>>18),A=C+(M^k&(N^M))+R[4]+3889429448&4294967295,C=N+(A<<20&4294967295|A>>>12),A=k+(N^M&(C^N))+R[9]+568446438&4294967295,k=C+(A<<5&4294967295|A>>>27),A=M+(C^N&(k^C))+R[14]+3275163606&4294967295,M=k+(A<<9&4294967295|A>>>23),A=N+(k^C&(M^k))+R[3]+4107603335&4294967295,N=M+(A<<14&4294967295|A>>>18),A=C+(M^k&(N^M))+R[8]+1163531501&4294967295,C=N+(A<<20&4294967295|A>>>12),A=k+(N^M&(C^N))+R[13]+2850285829&4294967295,k=C+(A<<5&4294967295|A>>>27),A=M+(C^N&(k^C))+R[2]+4243563512&4294967295,M=k+(A<<9&4294967295|A>>>23),A=N+(k^C&(M^k))+R[7]+1735328473&4294967295,N=M+(A<<14&4294967295|A>>>18),A=C+(M^k&(N^M))+R[12]+2368359562&4294967295,C=N+(A<<20&4294967295|A>>>12),A=k+(C^N^M)+R[5]+4294588738&4294967295,k=C+(A<<4&4294967295|A>>>28),A=M+(k^C^N)+R[8]+2272392833&4294967295,M=k+(A<<11&4294967295|A>>>21),A=N+(M^k^C)+R[11]+1839030562&4294967295,N=M+(A<<16&4294967295|A>>>16),A=C+(N^M^k)+R[14]+4259657740&4294967295,C=N+(A<<23&4294967295|A>>>9),A=k+(C^N^M)+R[1]+2763975236&4294967295,k=C+(A<<4&4294967295|A>>>28),A=M+(k^C^N)+R[4]+1272893353&4294967295,M=k+(A<<11&4294967295|A>>>21),A=N+(M^k^C)+R[7]+4139469664&4294967295,N=M+(A<<16&4294967295|A>>>16),A=C+(N^M^k)+R[10]+3200236656&4294967295,C=N+(A<<23&4294967295|A>>>9),A=k+(C^N^M)+R[13]+681279174&4294967295,k=C+(A<<4&4294967295|A>>>28),A=M+(k^C^N)+R[0]+3936430074&4294967295,M=k+(A<<11&4294967295|A>>>21),A=N+(M^k^C)+R[3]+3572445317&4294967295,N=M+(A<<16&4294967295|A>>>16),A=C+(N^M^k)+R[6]+76029189&4294967295,C=N+(A<<23&4294967295|A>>>9),A=k+(C^N^M)+R[9]+3654602809&4294967295,k=C+(A<<4&4294967295|A>>>28),A=M+(k^C^N)+R[12]+3873151461&4294967295,M=k+(A<<11&4294967295|A>>>21),A=N+(M^k^C)+R[15]+530742520&4294967295,N=M+(A<<16&4294967295|A>>>16),A=C+(N^M^k)+R[2]+3299628645&4294967295,C=N+(A<<23&4294967295|A>>>9),A=k+(N^(C|~M))+R[0]+4096336452&4294967295,k=C+(A<<6&4294967295|A>>>26),A=M+(C^(k|~N))+R[7]+1126891415&4294967295,M=k+(A<<10&4294967295|A>>>22),A=N+(k^(M|~C))+R[14]+2878612391&4294967295,N=M+(A<<15&4294967295|A>>>17),A=C+(M^(N|~k))+R[5]+4237533241&4294967295,C=N+(A<<21&4294967295|A>>>11),A=k+(N^(C|~M))+R[12]+1700485571&4294967295,k=C+(A<<6&4294967295|A>>>26),A=M+(C^(k|~N))+R[3]+2399980690&4294967295,M=k+(A<<10&4294967295|A>>>22),A=N+(k^(M|~C))+R[10]+4293915773&4294967295,N=M+(A<<15&4294967295|A>>>17),A=C+(M^(N|~k))+R[1]+2240044497&4294967295,C=N+(A<<21&4294967295|A>>>11),A=k+(N^(C|~M))+R[8]+1873313359&4294967295,k=C+(A<<6&4294967295|A>>>26),A=M+(C^(k|~N))+R[15]+4264355552&4294967295,M=k+(A<<10&4294967295|A>>>22),A=N+(k^(M|~C))+R[6]+2734768916&4294967295,N=M+(A<<15&4294967295|A>>>17),A=C+(M^(N|~k))+R[13]+1309151649&4294967295,C=N+(A<<21&4294967295|A>>>11),A=k+(N^(C|~M))+R[4]+4149444226&4294967295,k=C+(A<<6&4294967295|A>>>26),A=M+(C^(k|~N))+R[11]+3174756917&4294967295,M=k+(A<<10&4294967295|A>>>22),A=N+(k^(M|~C))+R[2]+718787259&4294967295,N=M+(A<<15&4294967295|A>>>17),A=C+(M^(N|~k))+R[9]+3951481745&4294967295,j.g[0]=j.g[0]+k&4294967295,j.g[1]=j.g[1]+(N+(A<<21&4294967295|A>>>11))&4294967295,j.g[2]=j.g[2]+N&4294967295,j.g[3]=j.g[3]+M&4294967295}r.prototype.u=function(j,k){k===void 0&&(k=j.length);for(var C=k-this.blockSize,R=this.B,N=this.h,M=0;M<k;){if(N==0)for(;M<=C;)s(this,j,M),M+=this.blockSize;if(typeof j=="string"){for(;M<k;)if(R[N++]=j.charCodeAt(M++),N==this.blockSize){s(this,R),N=0;break}}else for(;M<k;)if(R[N++]=j[M++],N==this.blockSize){s(this,R),N=0;break}}this.h=N,this.o+=k},r.prototype.v=function(){var j=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);j[0]=128;for(var k=1;k<j.length-8;++k)j[k]=0;var C=8*this.o;for(k=j.length-8;k<j.length;++k)j[k]=C&255,C/=256;for(this.u(j),j=Array(16),k=C=0;4>k;++k)for(var R=0;32>R;R+=8)j[C++]=this.g[k]>>>R&255;return j};function i(j,k){var C=l;return Object.prototype.hasOwnProperty.call(C,j)?C[j]:C[j]=k(j)}function o(j,k){this.h=k;for(var C=[],R=!0,N=j.length-1;0<=N;N--){var M=j[N]|0;R&&M==k||(C[N]=M,R=!1)}this.g=C}var l={};function c(j){return-128<=j&&128>j?i(j,function(k){return new o([k|0],0>k?-1:0)}):new o([j|0],0>j?-1:0)}function u(j){if(isNaN(j)||!isFinite(j))return m;if(0>j)return v(u(-j));for(var k=[],C=1,R=0;j>=C;R++)k[R]=j/C|0,C*=4294967296;return new o(k,0)}function d(j,k){if(j.length==0)throw Error("number format error: empty string");if(k=k||10,2>k||36<k)throw Error("radix out of range: "+k);if(j.charAt(0)=="-")return v(d(j.substring(1),k));if(0<=j.indexOf("-"))throw Error('number format error: interior "-" character');for(var C=u(Math.pow(k,8)),R=m,N=0;N<j.length;N+=8){var M=Math.min(8,j.length-N),A=parseInt(j.substring(N,N+M),k);8>M?(M=u(Math.pow(k,M)),R=R.j(M).add(u(A))):(R=R.j(C),R=R.add(u(A)))}return R}var m=c(0),p=c(1),g=c(16777216);t=o.prototype,t.m=function(){if(w(this))return-v(this).m();for(var j=0,k=1,C=0;C<this.g.length;C++){var R=this.i(C);j+=(0<=R?R:4294967296+R)*k,k*=4294967296}return j},t.toString=function(j){if(j=j||10,2>j||36<j)throw Error("radix out of range: "+j);if(x(this))return"0";if(w(this))return"-"+v(this).toString(j);for(var k=u(Math.pow(j,6)),C=this,R="";;){var N=I(C,k).g;C=S(C,N.j(k));var M=((0<C.g.length?C.g[0]:C.h)>>>0).toString(j);if(C=N,x(C))return M+R;for(;6>M.length;)M="0"+M;R=M+R}},t.i=function(j){return 0>j?0:j<this.g.length?this.g[j]:this.h};function x(j){if(j.h!=0)return!1;for(var k=0;k<j.g.length;k++)if(j.g[k]!=0)return!1;return!0}function w(j){return j.h==-1}t.l=function(j){return j=S(this,j),w(j)?-1:x(j)?0:1};function v(j){for(var k=j.g.length,C=[],R=0;R<k;R++)C[R]=~j.g[R];return new o(C,~j.h).add(p)}t.abs=function(){return w(this)?v(this):this},t.add=function(j){for(var k=Math.max(this.g.length,j.g.length),C=[],R=0,N=0;N<=k;N++){var M=R+(this.i(N)&65535)+(j.i(N)&65535),A=(M>>>16)+(this.i(N)>>>16)+(j.i(N)>>>16);R=A>>>16,M&=65535,A&=65535,C[N]=A<<16|M}return new o(C,C[C.length-1]&-2147483648?-1:0)};function S(j,k){return j.add(v(k))}t.j=function(j){if(x(this)||x(j))return m;if(w(this))return w(j)?v(this).j(v(j)):v(v(this).j(j));if(w(j))return v(this.j(v(j)));if(0>this.l(g)&&0>j.l(g))return u(this.m()*j.m());for(var k=this.g.length+j.g.length,C=[],R=0;R<2*k;R++)C[R]=0;for(R=0;R<this.g.length;R++)for(var N=0;N<j.g.length;N++){var M=this.i(R)>>>16,A=this.i(R)&65535,fe=j.i(N)>>>16,Le=j.i(N)&65535;C[2*R+2*N]+=A*Le,_(C,2*R+2*N),C[2*R+2*N+1]+=M*Le,_(C,2*R+2*N+1),C[2*R+2*N+1]+=A*fe,_(C,2*R+2*N+1),C[2*R+2*N+2]+=M*fe,_(C,2*R+2*N+2)}for(R=0;R<k;R++)C[R]=C[2*R+1]<<16|C[2*R];for(R=k;R<2*k;R++)C[R]=0;return new o(C,0)};function _(j,k){for(;(j[k]&65535)!=j[k];)j[k+1]+=j[k]>>>16,j[k]&=65535,k++}function E(j,k){this.g=j,this.h=k}function I(j,k){if(x(k))throw Error("division by zero");if(x(j))return new E(m,m);if(w(j))return k=I(v(j),k),new E(v(k.g),v(k.h));if(w(k))return k=I(j,v(k)),new E(v(k.g),k.h);if(30<j.g.length){if(w(j)||w(k))throw Error("slowDivide_ only works with positive integers.");for(var C=p,R=k;0>=R.l(j);)C=P(C),R=P(R);var N=F(C,1),M=F(R,1);for(R=F(R,2),C=F(C,2);!x(R);){var A=M.add(R);0>=A.l(j)&&(N=N.add(C),M=A),R=F(R,1),C=F(C,1)}return k=S(j,N.j(k)),new E(N,k)}for(N=m;0<=j.l(k);){for(C=Math.max(1,Math.floor(j.m()/k.m())),R=Math.ceil(Math.log(C)/Math.LN2),R=48>=R?1:Math.pow(2,R-48),M=u(C),A=M.j(k);w(A)||0<A.l(j);)C-=R,M=u(C),A=M.j(k);x(M)&&(M=p),N=N.add(M),j=S(j,A)}return new E(N,j)}t.A=function(j){return I(this,j).h},t.and=function(j){for(var k=Math.max(this.g.length,j.g.length),C=[],R=0;R<k;R++)C[R]=this.i(R)&j.i(R);return new o(C,this.h&j.h)},t.or=function(j){for(var k=Math.max(this.g.length,j.g.length),C=[],R=0;R<k;R++)C[R]=this.i(R)|j.i(R);return new o(C,this.h|j.h)},t.xor=function(j){for(var k=Math.max(this.g.length,j.g.length),C=[],R=0;R<k;R++)C[R]=this.i(R)^j.i(R);return new o(C,this.h^j.h)};function P(j){for(var k=j.g.length+1,C=[],R=0;R<k;R++)C[R]=j.i(R)<<1|j.i(R-1)>>>31;return new o(C,j.h)}function F(j,k){var C=k>>5;k%=32;for(var R=j.g.length-C,N=[],M=0;M<R;M++)N[M]=0<k?j.i(M+C)>>>k|j.i(M+C+1)<<32-k:j.i(M+C);return new o(N,j.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,LT=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=d,Ma=o}).apply(typeof GS<"u"?GS:typeof self<"u"?self:typeof window<"u"?window:{});var Hd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var OT,Sc,$T,Eh,hx,zT,BT,VT;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(f,y,b){return f==Array.prototype||f==Object.prototype||(f[y]=b.value),f};function n(f){f=[typeof globalThis=="object"&&globalThis,f,typeof window=="object"&&window,typeof self=="object"&&self,typeof Hd=="object"&&Hd];for(var y=0;y<f.length;++y){var b=f[y];if(b&&b.Math==Math)return b}throw Error("Cannot find global object")}var r=n(this);function s(f,y){if(y)e:{var b=r;f=f.split(".");for(var T=0;T<f.length-1;T++){var D=f[T];if(!(D in b))break e;b=b[D]}f=f[f.length-1],T=b[f],y=y(T),y!=T&&y!=null&&e(b,f,{configurable:!0,writable:!0,value:y})}}function i(f,y){f instanceof String&&(f+="");var b=0,T=!1,D={next:function(){if(!T&&b<f.length){var L=b++;return{value:y(L,f[L]),done:!1}}return T=!0,{done:!0,value:void 0}}};return D[Symbol.iterator]=function(){return D},D}s("Array.prototype.values",function(f){return f||function(){return i(this,function(y,b){return b})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function c(f){var y=typeof f;return y=y!="object"?y:f?Array.isArray(f)?"array":y:"null",y=="array"||y=="object"&&typeof f.length=="number"}function u(f){var y=typeof f;return y=="object"&&f!=null||y=="function"}function d(f,y,b){return f.call.apply(f.bind,arguments)}function m(f,y,b){if(!f)throw Error();if(2<arguments.length){var T=Array.prototype.slice.call(arguments,2);return function(){var D=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(D,T),f.apply(y,D)}}return function(){return f.apply(y,arguments)}}function p(f,y,b){return p=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:m,p.apply(null,arguments)}function g(f,y){var b=Array.prototype.slice.call(arguments,1);return function(){var T=b.slice();return T.push.apply(T,arguments),f.apply(this,T)}}function x(f,y){function b(){}b.prototype=y.prototype,f.aa=y.prototype,f.prototype=new b,f.prototype.constructor=f,f.Qb=function(T,D,L){for(var G=Array(arguments.length-2),qe=2;qe<arguments.length;qe++)G[qe-2]=arguments[qe];return y.prototype[D].apply(T,G)}}function w(f){const y=f.length;if(0<y){const b=Array(y);for(let T=0;T<y;T++)b[T]=f[T];return b}return[]}function v(f,y){for(let b=1;b<arguments.length;b++){const T=arguments[b];if(c(T)){const D=f.length||0,L=T.length||0;f.length=D+L;for(let G=0;G<L;G++)f[D+G]=T[G]}else f.push(T)}}class S{constructor(y,b){this.i=y,this.j=b,this.h=0,this.g=null}get(){let y;return 0<this.h?(this.h--,y=this.g,this.g=y.next,y.next=null):y=this.i(),y}}function _(f){return/^[\s\xa0]*$/.test(f)}function E(){var f=l.navigator;return f&&(f=f.userAgent)?f:""}function I(f){return I[" "](f),f}I[" "]=function(){};var P=E().indexOf("Gecko")!=-1&&!(E().toLowerCase().indexOf("webkit")!=-1&&E().indexOf("Edge")==-1)&&!(E().indexOf("Trident")!=-1||E().indexOf("MSIE")!=-1)&&E().indexOf("Edge")==-1;function F(f,y,b){for(const T in f)y.call(b,f[T],T,f)}function j(f,y){for(const b in f)y.call(void 0,f[b],b,f)}function k(f){const y={};for(const b in f)y[b]=f[b];return y}const C="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function R(f,y){let b,T;for(let D=1;D<arguments.length;D++){T=arguments[D];for(b in T)f[b]=T[b];for(let L=0;L<C.length;L++)b=C[L],Object.prototype.hasOwnProperty.call(T,b)&&(f[b]=T[b])}}function N(f){var y=1;f=f.split(":");const b=[];for(;0<y&&f.length;)b.push(f.shift()),y--;return f.length&&b.push(f.join(":")),b}function M(f){l.setTimeout(()=>{throw f},0)}function A(){var f=J;let y=null;return f.g&&(y=f.g,f.g=f.g.next,f.g||(f.h=null),y.next=null),y}class fe{constructor(){this.h=this.g=null}add(y,b){const T=Le.get();T.set(y,b),this.h?this.h.next=T:this.g=T,this.h=T}}var Le=new S(()=>new de,f=>f.reset());class de{constructor(){this.next=this.g=this.h=null}set(y,b){this.h=y,this.g=b,this.next=null}reset(){this.next=this.g=this.h=null}}let he,V=!1,J=new fe,Z=()=>{const f=l.Promise.resolve(void 0);he=()=>{f.then(je)}};var je=()=>{for(var f;f=A();){try{f.h.call(f.g)}catch(b){M(b)}var y=Le;y.j(f),100>y.h&&(y.h++,f.next=y.g,y.g=f)}V=!1};function Te(){this.s=this.s,this.C=this.C}Te.prototype.s=!1,Te.prototype.ma=function(){this.s||(this.s=!0,this.N())},Te.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function et(f,y){this.type=f,this.g=this.target=y,this.defaultPrevented=!1}et.prototype.h=function(){this.defaultPrevented=!0};var Er=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var f=!1,y=Object.defineProperty({},"passive",{get:function(){f=!0}});try{const b=()=>{};l.addEventListener("test",b,y),l.removeEventListener("test",b,y)}catch{}return f}();function kr(f,y){if(et.call(this,f?f.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,f){var b=this.type=f.type,T=f.changedTouches&&f.changedTouches.length?f.changedTouches[0]:null;if(this.target=f.target||f.srcElement,this.g=y,y=f.relatedTarget){if(P){e:{try{I(y.nodeName);var D=!0;break e}catch{}D=!1}D||(y=null)}}else b=="mouseover"?y=f.fromElement:b=="mouseout"&&(y=f.toElement);this.relatedTarget=y,T?(this.clientX=T.clientX!==void 0?T.clientX:T.pageX,this.clientY=T.clientY!==void 0?T.clientY:T.pageY,this.screenX=T.screenX||0,this.screenY=T.screenY||0):(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0),this.button=f.button,this.key=f.key||"",this.ctrlKey=f.ctrlKey,this.altKey=f.altKey,this.shiftKey=f.shiftKey,this.metaKey=f.metaKey,this.pointerId=f.pointerId||0,this.pointerType=typeof f.pointerType=="string"?f.pointerType:jr[f.pointerType]||"",this.state=f.state,this.i=f,f.defaultPrevented&&kr.aa.h.call(this)}}x(kr,et);var jr={2:"touch",3:"pen",4:"mouse"};kr.prototype.h=function(){kr.aa.h.call(this);var f=this.i;f.preventDefault?f.preventDefault():f.returnValue=!1};var ye="closure_listenable_"+(1e6*Math.random()|0),$r=0;function Gn(f,y,b,T,D){this.listener=f,this.proxy=null,this.src=y,this.type=b,this.capture=!!T,this.ha=D,this.key=++$r,this.da=this.fa=!1}function zr(f){f.da=!0,f.listener=null,f.proxy=null,f.src=null,f.ha=null}function Ns(f){this.src=f,this.g={},this.h=0}Ns.prototype.add=function(f,y,b,T,D){var L=f.toString();f=this.g[L],f||(f=this.g[L]=[],this.h++);var G=vp(f,y,T,D);return-1<G?(y=f[G],b||(y.fa=!1)):(y=new Gn(y,this.src,L,!!T,D),y.fa=b,f.push(y)),y};function yo(f,y){var b=y.type;if(b in f.g){var T=f.g[b],D=Array.prototype.indexOf.call(T,y,void 0),L;(L=0<=D)&&Array.prototype.splice.call(T,D,1),L&&(zr(y),f.g[b].length==0&&(delete f.g[b],f.h--))}}function vp(f,y,b,T){for(var D=0;D<f.length;++D){var L=f[D];if(!L.da&&L.listener==y&&L.capture==!!b&&L.ha==T)return D}return-1}var wp="closure_lm_"+(1e6*Math.random()|0),_p={};function s1(f,y,b,T,D){if(T&&T.once)return a1(f,y,b,T,D);if(Array.isArray(y)){for(var L=0;L<y.length;L++)s1(f,y[L],b,T,D);return null}return b=kp(b),f&&f[ye]?f.K(y,b,u(T)?!!T.capture:!!T,D):i1(f,y,b,!1,T,D)}function i1(f,y,b,T,D,L){if(!y)throw Error("Invalid event type");var G=u(D)?!!D.capture:!!D,qe=bp(f);if(qe||(f[wp]=qe=new Ns(f)),b=qe.add(y,b,T,G,L),b.proxy)return b;if(T=CA(),b.proxy=T,T.src=f,T.listener=b,f.addEventListener)Er||(D=G),D===void 0&&(D=!1),f.addEventListener(y.toString(),T,D);else if(f.attachEvent)f.attachEvent(l1(y.toString()),T);else if(f.addListener&&f.removeListener)f.addListener(T);else throw Error("addEventListener and attachEvent are unavailable.");return b}function CA(){function f(b){return y.call(f.src,f.listener,b)}const y=RA;return f}function a1(f,y,b,T,D){if(Array.isArray(y)){for(var L=0;L<y.length;L++)a1(f,y[L],b,T,D);return null}return b=kp(b),f&&f[ye]?f.L(y,b,u(T)?!!T.capture:!!T,D):i1(f,y,b,!0,T,D)}function o1(f,y,b,T,D){if(Array.isArray(y))for(var L=0;L<y.length;L++)o1(f,y[L],b,T,D);else T=u(T)?!!T.capture:!!T,b=kp(b),f&&f[ye]?(f=f.i,y=String(y).toString(),y in f.g&&(L=f.g[y],b=vp(L,b,T,D),-1<b&&(zr(L[b]),Array.prototype.splice.call(L,b,1),L.length==0&&(delete f.g[y],f.h--)))):f&&(f=bp(f))&&(y=f.g[y.toString()],f=-1,y&&(f=vp(y,b,T,D)),(b=-1<f?y[f]:null)&&Sp(b))}function Sp(f){if(typeof f!="number"&&f&&!f.da){var y=f.src;if(y&&y[ye])yo(y.i,f);else{var b=f.type,T=f.proxy;y.removeEventListener?y.removeEventListener(b,T,f.capture):y.detachEvent?y.detachEvent(l1(b),T):y.addListener&&y.removeListener&&y.removeListener(T),(b=bp(y))?(yo(b,f),b.h==0&&(b.src=null,y[wp]=null)):zr(f)}}}function l1(f){return f in _p?_p[f]:_p[f]="on"+f}function RA(f,y){if(f.da)f=!0;else{y=new kr(y,this);var b=f.listener,T=f.ha||f.src;f.fa&&Sp(f),f=b.call(T,y)}return f}function bp(f){return f=f[wp],f instanceof Ns?f:null}var Ep="__closure_events_fn_"+(1e9*Math.random()>>>0);function kp(f){return typeof f=="function"?f:(f[Ep]||(f[Ep]=function(y){return f.handleEvent(y)}),f[Ep])}function ln(){Te.call(this),this.i=new Ns(this),this.M=this,this.F=null}x(ln,Te),ln.prototype[ye]=!0,ln.prototype.removeEventListener=function(f,y,b,T){o1(this,f,y,b,T)};function kn(f,y){var b,T=f.F;if(T)for(b=[];T;T=T.F)b.push(T);if(f=f.M,T=y.type||y,typeof y=="string")y=new et(y,f);else if(y instanceof et)y.target=y.target||f;else{var D=y;y=new et(T,f),R(y,D)}if(D=!0,b)for(var L=b.length-1;0<=L;L--){var G=y.g=b[L];D=dd(G,T,!0,y)&&D}if(G=y.g=f,D=dd(G,T,!0,y)&&D,D=dd(G,T,!1,y)&&D,b)for(L=0;L<b.length;L++)G=y.g=b[L],D=dd(G,T,!1,y)&&D}ln.prototype.N=function(){if(ln.aa.N.call(this),this.i){var f=this.i,y;for(y in f.g){for(var b=f.g[y],T=0;T<b.length;T++)zr(b[T]);delete f.g[y],f.h--}}this.F=null},ln.prototype.K=function(f,y,b,T){return this.i.add(String(f),y,!1,b,T)},ln.prototype.L=function(f,y,b,T){return this.i.add(String(f),y,!0,b,T)};function dd(f,y,b,T){if(y=f.i.g[String(y)],!y)return!0;y=y.concat();for(var D=!0,L=0;L<y.length;++L){var G=y[L];if(G&&!G.da&&G.capture==b){var qe=G.listener,Xt=G.ha||G.src;G.fa&&yo(f.i,G),D=qe.call(Xt,T)!==!1&&D}}return D&&!T.defaultPrevented}function c1(f,y,b){if(typeof f=="function")b&&(f=p(f,b));else if(f&&typeof f.handleEvent=="function")f=p(f.handleEvent,f);else throw Error("Invalid listener argument");return 2147483647<Number(y)?-1:l.setTimeout(f,y||0)}function u1(f){f.g=c1(()=>{f.g=null,f.i&&(f.i=!1,u1(f))},f.l);const y=f.h;f.h=null,f.m.apply(null,y)}class NA extends Te{constructor(y,b){super(),this.m=y,this.l=b,this.h=null,this.i=!1,this.g=null}j(y){this.h=arguments,this.g?this.i=!0:u1(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ql(f){Te.call(this),this.h=f,this.g={}}x(ql,Te);var d1=[];function h1(f){F(f.g,function(y,b){this.g.hasOwnProperty(b)&&Sp(y)},f),f.g={}}ql.prototype.N=function(){ql.aa.N.call(this),h1(this)},ql.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var jp=l.JSON.stringify,AA=l.JSON.parse,PA=class{stringify(f){return l.JSON.stringify(f,void 0)}parse(f){return l.JSON.parse(f,void 0)}};function Tp(){}Tp.prototype.h=null;function f1(f){return f.h||(f.h=f.i())}function m1(){}var Kl={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ip(){et.call(this,"d")}x(Ip,et);function Cp(){et.call(this,"c")}x(Cp,et);var ma={},p1=null;function hd(){return p1=p1||new ln}ma.La="serverreachability";function g1(f){et.call(this,ma.La,f)}x(g1,et);function Ql(f){const y=hd();kn(y,new g1(y))}ma.STAT_EVENT="statevent";function x1(f,y){et.call(this,ma.STAT_EVENT,f),this.stat=y}x(x1,et);function jn(f){const y=hd();kn(y,new x1(y,f))}ma.Ma="timingevent";function y1(f,y){et.call(this,ma.Ma,f),this.size=y}x(y1,et);function Xl(f,y){if(typeof f!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){f()},y)}function Yl(){this.g=!0}Yl.prototype.xa=function(){this.g=!1};function FA(f,y,b,T,D,L){f.info(function(){if(f.g)if(L)for(var G="",qe=L.split("&"),Xt=0;Xt<qe.length;Xt++){var Oe=qe[Xt].split("=");if(1<Oe.length){var cn=Oe[0];Oe=Oe[1];var un=cn.split("_");G=2<=un.length&&un[1]=="type"?G+(cn+"="+Oe+"&"):G+(cn+"=redacted&")}}else G=null;else G=L;return"XMLHTTP REQ ("+T+") [attempt "+D+"]: "+y+`
`+b+`
`+G})}function MA(f,y,b,T,D,L,G){f.info(function(){return"XMLHTTP RESP ("+T+") [ attempt "+D+"]: "+y+`
`+b+`
`+L+" "+G})}function vo(f,y,b,T){f.info(function(){return"XMLHTTP TEXT ("+y+"): "+LA(f,b)+(T?" "+T:"")})}function DA(f,y){f.info(function(){return"TIMEOUT: "+y})}Yl.prototype.info=function(){};function LA(f,y){if(!f.g)return y;if(!y)return null;try{var b=JSON.parse(y);if(b){for(f=0;f<b.length;f++)if(Array.isArray(b[f])){var T=b[f];if(!(2>T.length)){var D=T[1];if(Array.isArray(D)&&!(1>D.length)){var L=D[0];if(L!="noop"&&L!="stop"&&L!="close")for(var G=1;G<D.length;G++)D[G]=""}}}}return jp(b)}catch{return y}}var fd={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},v1={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Rp;function md(){}x(md,Tp),md.prototype.g=function(){return new XMLHttpRequest},md.prototype.i=function(){return{}},Rp=new md;function yi(f,y,b,T){this.j=f,this.i=y,this.l=b,this.R=T||1,this.U=new ql(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new w1}function w1(){this.i=null,this.g="",this.h=!1}var _1={},Np={};function Ap(f,y,b){f.L=1,f.v=yd(As(y)),f.m=b,f.P=!0,S1(f,null)}function S1(f,y){f.F=Date.now(),pd(f),f.A=As(f.v);var b=f.A,T=f.R;Array.isArray(T)||(T=[String(T)]),D1(b.i,"t",T),f.C=0,b=f.j.J,f.h=new w1,f.g=e_(f.j,b?y:null,!f.m),0<f.O&&(f.M=new NA(p(f.Y,f,f.g),f.O)),y=f.U,b=f.g,T=f.ca;var D="readystatechange";Array.isArray(D)||(D&&(d1[0]=D.toString()),D=d1);for(var L=0;L<D.length;L++){var G=s1(b,D[L],T||y.handleEvent,!1,y.h||y);if(!G)break;y.g[G.key]=G}y=f.H?k(f.H):{},f.m?(f.u||(f.u="POST"),y["Content-Type"]="application/x-www-form-urlencoded",f.g.ea(f.A,f.u,f.m,y)):(f.u="GET",f.g.ea(f.A,f.u,null,y)),Ql(),FA(f.i,f.u,f.A,f.l,f.R,f.m)}yi.prototype.ca=function(f){f=f.target;const y=this.M;y&&Ps(f)==3?y.j():this.Y(f)},yi.prototype.Y=function(f){try{if(f==this.g)e:{const un=Ps(this.g);var y=this.g.Ba();const So=this.g.Z();if(!(3>un)&&(un!=3||this.g&&(this.h.h||this.g.oa()||U1(this.g)))){this.J||un!=4||y==7||(y==8||0>=So?Ql(3):Ql(2)),Pp(this);var b=this.g.Z();this.X=b;t:if(b1(this)){var T=U1(this.g);f="";var D=T.length,L=Ps(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){pa(this),Jl(this);var G="";break t}this.h.i=new l.TextDecoder}for(y=0;y<D;y++)this.h.h=!0,f+=this.h.i.decode(T[y],{stream:!(L&&y==D-1)});T.length=0,this.h.g+=f,this.C=0,G=this.h.g}else G=this.g.oa();if(this.o=b==200,MA(this.i,this.u,this.A,this.l,this.R,un,b),this.o){if(this.T&&!this.K){t:{if(this.g){var qe,Xt=this.g;if((qe=Xt.g?Xt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!_(qe)){var Oe=qe;break t}}Oe=null}if(b=Oe)vo(this.i,this.l,b,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Fp(this,b);else{this.o=!1,this.s=3,jn(12),pa(this),Jl(this);break e}}if(this.P){b=!0;let Br;for(;!this.J&&this.C<G.length;)if(Br=OA(this,G),Br==Np){un==4&&(this.s=4,jn(14),b=!1),vo(this.i,this.l,null,"[Incomplete Response]");break}else if(Br==_1){this.s=4,jn(15),vo(this.i,this.l,G,"[Invalid Chunk]"),b=!1;break}else vo(this.i,this.l,Br,null),Fp(this,Br);if(b1(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),un!=4||G.length!=0||this.h.h||(this.s=1,jn(16),b=!1),this.o=this.o&&b,!b)vo(this.i,this.l,G,"[Invalid Chunked Response]"),pa(this),Jl(this);else if(0<G.length&&!this.W){this.W=!0;var cn=this.j;cn.g==this&&cn.ba&&!cn.M&&(cn.j.info("Great, no buffering proxy detected. Bytes received: "+G.length),zp(cn),cn.M=!0,jn(11))}}else vo(this.i,this.l,G,null),Fp(this,G);un==4&&pa(this),this.o&&!this.J&&(un==4?X1(this.j,this):(this.o=!1,pd(this)))}else t5(this.g),b==400&&0<G.indexOf("Unknown SID")?(this.s=3,jn(12)):(this.s=0,jn(13)),pa(this),Jl(this)}}}catch{}finally{}};function b1(f){return f.g?f.u=="GET"&&f.L!=2&&f.j.Ca:!1}function OA(f,y){var b=f.C,T=y.indexOf(`
`,b);return T==-1?Np:(b=Number(y.substring(b,T)),isNaN(b)?_1:(T+=1,T+b>y.length?Np:(y=y.slice(T,T+b),f.C=T+b,y)))}yi.prototype.cancel=function(){this.J=!0,pa(this)};function pd(f){f.S=Date.now()+f.I,E1(f,f.I)}function E1(f,y){if(f.B!=null)throw Error("WatchDog timer not null");f.B=Xl(p(f.ba,f),y)}function Pp(f){f.B&&(l.clearTimeout(f.B),f.B=null)}yi.prototype.ba=function(){this.B=null;const f=Date.now();0<=f-this.S?(DA(this.i,this.A),this.L!=2&&(Ql(),jn(17)),pa(this),this.s=2,Jl(this)):E1(this,this.S-f)};function Jl(f){f.j.G==0||f.J||X1(f.j,f)}function pa(f){Pp(f);var y=f.M;y&&typeof y.ma=="function"&&y.ma(),f.M=null,h1(f.U),f.g&&(y=f.g,f.g=null,y.abort(),y.ma())}function Fp(f,y){try{var b=f.j;if(b.G!=0&&(b.g==f||Mp(b.h,f))){if(!f.K&&Mp(b.h,f)&&b.G==3){try{var T=b.Da.g.parse(y)}catch{T=null}if(Array.isArray(T)&&T.length==3){var D=T;if(D[0]==0){e:if(!b.u){if(b.g)if(b.g.F+3e3<f.F)Ed(b),Sd(b);else break e;$p(b),jn(18)}}else b.za=D[1],0<b.za-b.T&&37500>D[2]&&b.F&&b.v==0&&!b.C&&(b.C=Xl(p(b.Za,b),6e3));if(1>=T1(b.h)&&b.ca){try{b.ca()}catch{}b.ca=void 0}}else xa(b,11)}else if((f.K||b.g==f)&&Ed(b),!_(y))for(D=b.Da.g.parse(y),y=0;y<D.length;y++){let Oe=D[y];if(b.T=Oe[0],Oe=Oe[1],b.G==2)if(Oe[0]=="c"){b.K=Oe[1],b.ia=Oe[2];const cn=Oe[3];cn!=null&&(b.la=cn,b.j.info("VER="+b.la));const un=Oe[4];un!=null&&(b.Aa=un,b.j.info("SVER="+b.Aa));const So=Oe[5];So!=null&&typeof So=="number"&&0<So&&(T=1.5*So,b.L=T,b.j.info("backChannelRequestTimeoutMs_="+T)),T=b;const Br=f.g;if(Br){const jd=Br.g?Br.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(jd){var L=T.h;L.g||jd.indexOf("spdy")==-1&&jd.indexOf("quic")==-1&&jd.indexOf("h2")==-1||(L.j=L.l,L.g=new Set,L.h&&(Dp(L,L.h),L.h=null))}if(T.D){const Bp=Br.g?Br.g.getResponseHeader("X-HTTP-Session-Id"):null;Bp&&(T.ya=Bp,Ye(T.I,T.D,Bp))}}b.G=3,b.l&&b.l.ua(),b.ba&&(b.R=Date.now()-f.F,b.j.info("Handshake RTT: "+b.R+"ms")),T=b;var G=f;if(T.qa=Z1(T,T.J?T.ia:null,T.W),G.K){I1(T.h,G);var qe=G,Xt=T.L;Xt&&(qe.I=Xt),qe.B&&(Pp(qe),pd(qe)),T.g=G}else K1(T);0<b.i.length&&bd(b)}else Oe[0]!="stop"&&Oe[0]!="close"||xa(b,7);else b.G==3&&(Oe[0]=="stop"||Oe[0]=="close"?Oe[0]=="stop"?xa(b,7):Op(b):Oe[0]!="noop"&&b.l&&b.l.ta(Oe),b.v=0)}}Ql(4)}catch{}}var $A=class{constructor(f,y){this.g=f,this.map=y}};function k1(f){this.l=f||10,l.PerformanceNavigationTiming?(f=l.performance.getEntriesByType("navigation"),f=0<f.length&&(f[0].nextHopProtocol=="hq"||f[0].nextHopProtocol=="h2")):f=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=f?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function j1(f){return f.h?!0:f.g?f.g.size>=f.j:!1}function T1(f){return f.h?1:f.g?f.g.size:0}function Mp(f,y){return f.h?f.h==y:f.g?f.g.has(y):!1}function Dp(f,y){f.g?f.g.add(y):f.h=y}function I1(f,y){f.h&&f.h==y?f.h=null:f.g&&f.g.has(y)&&f.g.delete(y)}k1.prototype.cancel=function(){if(this.i=C1(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const f of this.g.values())f.cancel();this.g.clear()}};function C1(f){if(f.h!=null)return f.i.concat(f.h.D);if(f.g!=null&&f.g.size!==0){let y=f.i;for(const b of f.g.values())y=y.concat(b.D);return y}return w(f.i)}function zA(f){if(f.V&&typeof f.V=="function")return f.V();if(typeof Map<"u"&&f instanceof Map||typeof Set<"u"&&f instanceof Set)return Array.from(f.values());if(typeof f=="string")return f.split("");if(c(f)){for(var y=[],b=f.length,T=0;T<b;T++)y.push(f[T]);return y}y=[],b=0;for(T in f)y[b++]=f[T];return y}function BA(f){if(f.na&&typeof f.na=="function")return f.na();if(!f.V||typeof f.V!="function"){if(typeof Map<"u"&&f instanceof Map)return Array.from(f.keys());if(!(typeof Set<"u"&&f instanceof Set)){if(c(f)||typeof f=="string"){var y=[];f=f.length;for(var b=0;b<f;b++)y.push(b);return y}y=[],b=0;for(const T in f)y[b++]=T;return y}}}function R1(f,y){if(f.forEach&&typeof f.forEach=="function")f.forEach(y,void 0);else if(c(f)||typeof f=="string")Array.prototype.forEach.call(f,y,void 0);else for(var b=BA(f),T=zA(f),D=T.length,L=0;L<D;L++)y.call(void 0,T[L],b&&b[L],f)}var N1=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function VA(f,y){if(f){f=f.split("&");for(var b=0;b<f.length;b++){var T=f[b].indexOf("="),D=null;if(0<=T){var L=f[b].substring(0,T);D=f[b].substring(T+1)}else L=f[b];y(L,D?decodeURIComponent(D.replace(/\+/g," ")):"")}}}function ga(f){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,f instanceof ga){this.h=f.h,gd(this,f.j),this.o=f.o,this.g=f.g,xd(this,f.s),this.l=f.l;var y=f.i,b=new tc;b.i=y.i,y.g&&(b.g=new Map(y.g),b.h=y.h),A1(this,b),this.m=f.m}else f&&(y=String(f).match(N1))?(this.h=!1,gd(this,y[1]||"",!0),this.o=Zl(y[2]||""),this.g=Zl(y[3]||"",!0),xd(this,y[4]),this.l=Zl(y[5]||"",!0),A1(this,y[6]||"",!0),this.m=Zl(y[7]||"")):(this.h=!1,this.i=new tc(null,this.h))}ga.prototype.toString=function(){var f=[],y=this.j;y&&f.push(ec(y,P1,!0),":");var b=this.g;return(b||y=="file")&&(f.push("//"),(y=this.o)&&f.push(ec(y,P1,!0),"@"),f.push(encodeURIComponent(String(b)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),b=this.s,b!=null&&f.push(":",String(b))),(b=this.l)&&(this.g&&b.charAt(0)!="/"&&f.push("/"),f.push(ec(b,b.charAt(0)=="/"?GA:HA,!0))),(b=this.i.toString())&&f.push("?",b),(b=this.m)&&f.push("#",ec(b,qA)),f.join("")};function As(f){return new ga(f)}function gd(f,y,b){f.j=b?Zl(y,!0):y,f.j&&(f.j=f.j.replace(/:$/,""))}function xd(f,y){if(y){if(y=Number(y),isNaN(y)||0>y)throw Error("Bad port number "+y);f.s=y}else f.s=null}function A1(f,y,b){y instanceof tc?(f.i=y,KA(f.i,f.h)):(b||(y=ec(y,WA)),f.i=new tc(y,f.h))}function Ye(f,y,b){f.i.set(y,b)}function yd(f){return Ye(f,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),f}function Zl(f,y){return f?y?decodeURI(f.replace(/%25/g,"%2525")):decodeURIComponent(f):""}function ec(f,y,b){return typeof f=="string"?(f=encodeURI(f).replace(y,UA),b&&(f=f.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f):null}function UA(f){return f=f.charCodeAt(0),"%"+(f>>4&15).toString(16)+(f&15).toString(16)}var P1=/[#\/\?@]/g,HA=/[#\?:]/g,GA=/[#\?]/g,WA=/[#\?@]/g,qA=/#/g;function tc(f,y){this.h=this.g=null,this.i=f||null,this.j=!!y}function vi(f){f.g||(f.g=new Map,f.h=0,f.i&&VA(f.i,function(y,b){f.add(decodeURIComponent(y.replace(/\+/g," ")),b)}))}t=tc.prototype,t.add=function(f,y){vi(this),this.i=null,f=wo(this,f);var b=this.g.get(f);return b||this.g.set(f,b=[]),b.push(y),this.h+=1,this};function F1(f,y){vi(f),y=wo(f,y),f.g.has(y)&&(f.i=null,f.h-=f.g.get(y).length,f.g.delete(y))}function M1(f,y){return vi(f),y=wo(f,y),f.g.has(y)}t.forEach=function(f,y){vi(this),this.g.forEach(function(b,T){b.forEach(function(D){f.call(y,D,T,this)},this)},this)},t.na=function(){vi(this);const f=Array.from(this.g.values()),y=Array.from(this.g.keys()),b=[];for(let T=0;T<y.length;T++){const D=f[T];for(let L=0;L<D.length;L++)b.push(y[T])}return b},t.V=function(f){vi(this);let y=[];if(typeof f=="string")M1(this,f)&&(y=y.concat(this.g.get(wo(this,f))));else{f=Array.from(this.g.values());for(let b=0;b<f.length;b++)y=y.concat(f[b])}return y},t.set=function(f,y){return vi(this),this.i=null,f=wo(this,f),M1(this,f)&&(this.h-=this.g.get(f).length),this.g.set(f,[y]),this.h+=1,this},t.get=function(f,y){return f?(f=this.V(f),0<f.length?String(f[0]):y):y};function D1(f,y,b){F1(f,y),0<b.length&&(f.i=null,f.g.set(wo(f,y),w(b)),f.h+=b.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const f=[],y=Array.from(this.g.keys());for(var b=0;b<y.length;b++){var T=y[b];const L=encodeURIComponent(String(T)),G=this.V(T);for(T=0;T<G.length;T++){var D=L;G[T]!==""&&(D+="="+encodeURIComponent(String(G[T]))),f.push(D)}}return this.i=f.join("&")};function wo(f,y){return y=String(y),f.j&&(y=y.toLowerCase()),y}function KA(f,y){y&&!f.j&&(vi(f),f.i=null,f.g.forEach(function(b,T){var D=T.toLowerCase();T!=D&&(F1(this,T),D1(this,D,b))},f)),f.j=y}function QA(f,y){const b=new Yl;if(l.Image){const T=new Image;T.onload=g(wi,b,"TestLoadImage: loaded",!0,y,T),T.onerror=g(wi,b,"TestLoadImage: error",!1,y,T),T.onabort=g(wi,b,"TestLoadImage: abort",!1,y,T),T.ontimeout=g(wi,b,"TestLoadImage: timeout",!1,y,T),l.setTimeout(function(){T.ontimeout&&T.ontimeout()},1e4),T.src=f}else y(!1)}function XA(f,y){const b=new Yl,T=new AbortController,D=setTimeout(()=>{T.abort(),wi(b,"TestPingServer: timeout",!1,y)},1e4);fetch(f,{signal:T.signal}).then(L=>{clearTimeout(D),L.ok?wi(b,"TestPingServer: ok",!0,y):wi(b,"TestPingServer: server error",!1,y)}).catch(()=>{clearTimeout(D),wi(b,"TestPingServer: error",!1,y)})}function wi(f,y,b,T,D){try{D&&(D.onload=null,D.onerror=null,D.onabort=null,D.ontimeout=null),T(b)}catch{}}function YA(){this.g=new PA}function JA(f,y,b){const T=b||"";try{R1(f,function(D,L){let G=D;u(D)&&(G=jp(D)),y.push(T+L+"="+encodeURIComponent(G))})}catch(D){throw y.push(T+"type="+encodeURIComponent("_badmap")),D}}function vd(f){this.l=f.Ub||null,this.j=f.eb||!1}x(vd,Tp),vd.prototype.g=function(){return new wd(this.l,this.j)},vd.prototype.i=function(f){return function(){return f}}({});function wd(f,y){ln.call(this),this.D=f,this.o=y,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}x(wd,ln),t=wd.prototype,t.open=function(f,y){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=f,this.A=y,this.readyState=1,rc(this)},t.send=function(f){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const y={headers:this.u,method:this.B,credentials:this.m,cache:void 0};f&&(y.body=f),(this.D||l).fetch(new Request(this.A,y)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,nc(this)),this.readyState=0},t.Sa=function(f){if(this.g&&(this.l=f,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=f.headers,this.readyState=2,rc(this)),this.g&&(this.readyState=3,rc(this),this.g)))if(this.responseType==="arraybuffer")f.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in f){if(this.j=f.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;L1(this)}else f.text().then(this.Ra.bind(this),this.ga.bind(this))};function L1(f){f.j.read().then(f.Pa.bind(f)).catch(f.ga.bind(f))}t.Pa=function(f){if(this.g){if(this.o&&f.value)this.response.push(f.value);else if(!this.o){var y=f.value?f.value:new Uint8Array(0);(y=this.v.decode(y,{stream:!f.done}))&&(this.response=this.responseText+=y)}f.done?nc(this):rc(this),this.readyState==3&&L1(this)}},t.Ra=function(f){this.g&&(this.response=this.responseText=f,nc(this))},t.Qa=function(f){this.g&&(this.response=f,nc(this))},t.ga=function(){this.g&&nc(this)};function nc(f){f.readyState=4,f.l=null,f.j=null,f.v=null,rc(f)}t.setRequestHeader=function(f,y){this.u.append(f,y)},t.getResponseHeader=function(f){return this.h&&this.h.get(f.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const f=[],y=this.h.entries();for(var b=y.next();!b.done;)b=b.value,f.push(b[0]+": "+b[1]),b=y.next();return f.join(`\r
`)};function rc(f){f.onreadystatechange&&f.onreadystatechange.call(f)}Object.defineProperty(wd.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(f){this.m=f?"include":"same-origin"}});function O1(f){let y="";return F(f,function(b,T){y+=T,y+=":",y+=b,y+=`\r
`}),y}function Lp(f,y,b){e:{for(T in b){var T=!1;break e}T=!0}T||(b=O1(b),typeof f=="string"?b!=null&&encodeURIComponent(String(b)):Ye(f,y,b))}function dt(f){ln.call(this),this.headers=new Map,this.o=f||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}x(dt,ln);var ZA=/^https?$/i,e5=["POST","PUT"];t=dt.prototype,t.Ha=function(f){this.J=f},t.ea=function(f,y,b,T){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+f);y=y?y.toUpperCase():"GET",this.D=f,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Rp.g(),this.v=this.o?f1(this.o):f1(Rp),this.g.onreadystatechange=p(this.Ea,this);try{this.B=!0,this.g.open(y,String(f),!0),this.B=!1}catch(L){$1(this,L);return}if(f=b||"",b=new Map(this.headers),T)if(Object.getPrototypeOf(T)===Object.prototype)for(var D in T)b.set(D,T[D]);else if(typeof T.keys=="function"&&typeof T.get=="function")for(const L of T.keys())b.set(L,T.get(L));else throw Error("Unknown input type for opt_headers: "+String(T));T=Array.from(b.keys()).find(L=>L.toLowerCase()=="content-type"),D=l.FormData&&f instanceof l.FormData,!(0<=Array.prototype.indexOf.call(e5,y,void 0))||T||D||b.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[L,G]of b)this.g.setRequestHeader(L,G);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{V1(this),this.u=!0,this.g.send(f),this.u=!1}catch(L){$1(this,L)}};function $1(f,y){f.h=!1,f.g&&(f.j=!0,f.g.abort(),f.j=!1),f.l=y,f.m=5,z1(f),_d(f)}function z1(f){f.A||(f.A=!0,kn(f,"complete"),kn(f,"error"))}t.abort=function(f){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=f||7,kn(this,"complete"),kn(this,"abort"),_d(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),_d(this,!0)),dt.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?B1(this):this.bb())},t.bb=function(){B1(this)};function B1(f){if(f.h&&typeof o<"u"&&(!f.v[1]||Ps(f)!=4||f.Z()!=2)){if(f.u&&Ps(f)==4)c1(f.Ea,0,f);else if(kn(f,"readystatechange"),Ps(f)==4){f.h=!1;try{const G=f.Z();e:switch(G){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var y=!0;break e;default:y=!1}var b;if(!(b=y)){var T;if(T=G===0){var D=String(f.D).match(N1)[1]||null;!D&&l.self&&l.self.location&&(D=l.self.location.protocol.slice(0,-1)),T=!ZA.test(D?D.toLowerCase():"")}b=T}if(b)kn(f,"complete"),kn(f,"success");else{f.m=6;try{var L=2<Ps(f)?f.g.statusText:""}catch{L=""}f.l=L+" ["+f.Z()+"]",z1(f)}}finally{_d(f)}}}}function _d(f,y){if(f.g){V1(f);const b=f.g,T=f.v[0]?()=>{}:null;f.g=null,f.v=null,y||kn(f,"ready");try{b.onreadystatechange=T}catch{}}}function V1(f){f.I&&(l.clearTimeout(f.I),f.I=null)}t.isActive=function(){return!!this.g};function Ps(f){return f.g?f.g.readyState:0}t.Z=function(){try{return 2<Ps(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(f){if(this.g){var y=this.g.responseText;return f&&y.indexOf(f)==0&&(y=y.substring(f.length)),AA(y)}};function U1(f){try{if(!f.g)return null;if("response"in f.g)return f.g.response;switch(f.H){case"":case"text":return f.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in f.g)return f.g.mozResponseArrayBuffer}return null}catch{return null}}function t5(f){const y={};f=(f.g&&2<=Ps(f)&&f.g.getAllResponseHeaders()||"").split(`\r
`);for(let T=0;T<f.length;T++){if(_(f[T]))continue;var b=N(f[T]);const D=b[0];if(b=b[1],typeof b!="string")continue;b=b.trim();const L=y[D]||[];y[D]=L,L.push(b)}j(y,function(T){return T.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function sc(f,y,b){return b&&b.internalChannelParams&&b.internalChannelParams[f]||y}function H1(f){this.Aa=0,this.i=[],this.j=new Yl,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=sc("failFast",!1,f),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=sc("baseRetryDelayMs",5e3,f),this.cb=sc("retryDelaySeedMs",1e4,f),this.Wa=sc("forwardChannelMaxRetries",2,f),this.wa=sc("forwardChannelRequestTimeoutMs",2e4,f),this.pa=f&&f.xmlHttpFactory||void 0,this.Xa=f&&f.Tb||void 0,this.Ca=f&&f.useFetchStreams||!1,this.L=void 0,this.J=f&&f.supportsCrossDomainXhr||!1,this.K="",this.h=new k1(f&&f.concurrentRequestLimit),this.Da=new YA,this.P=f&&f.fastHandshake||!1,this.O=f&&f.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=f&&f.Rb||!1,f&&f.xa&&this.j.xa(),f&&f.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&f&&f.detectBufferingProxy||!1,this.ja=void 0,f&&f.longPollingTimeout&&0<f.longPollingTimeout&&(this.ja=f.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=H1.prototype,t.la=8,t.G=1,t.connect=function(f,y,b,T){jn(0),this.W=f,this.H=y||{},b&&T!==void 0&&(this.H.OSID=b,this.H.OAID=T),this.F=this.X,this.I=Z1(this,null,this.W),bd(this)};function Op(f){if(G1(f),f.G==3){var y=f.U++,b=As(f.I);if(Ye(b,"SID",f.K),Ye(b,"RID",y),Ye(b,"TYPE","terminate"),ic(f,b),y=new yi(f,f.j,y),y.L=2,y.v=yd(As(b)),b=!1,l.navigator&&l.navigator.sendBeacon)try{b=l.navigator.sendBeacon(y.v.toString(),"")}catch{}!b&&l.Image&&(new Image().src=y.v,b=!0),b||(y.g=e_(y.j,null),y.g.ea(y.v)),y.F=Date.now(),pd(y)}J1(f)}function Sd(f){f.g&&(zp(f),f.g.cancel(),f.g=null)}function G1(f){Sd(f),f.u&&(l.clearTimeout(f.u),f.u=null),Ed(f),f.h.cancel(),f.s&&(typeof f.s=="number"&&l.clearTimeout(f.s),f.s=null)}function bd(f){if(!j1(f.h)&&!f.s){f.s=!0;var y=f.Ga;he||Z(),V||(he(),V=!0),J.add(y,f),f.B=0}}function n5(f,y){return T1(f.h)>=f.h.j-(f.s?1:0)?!1:f.s?(f.i=y.D.concat(f.i),!0):f.G==1||f.G==2||f.B>=(f.Va?0:f.Wa)?!1:(f.s=Xl(p(f.Ga,f,y),Y1(f,f.B)),f.B++,!0)}t.Ga=function(f){if(this.s)if(this.s=null,this.G==1){if(!f){this.U=Math.floor(1e5*Math.random()),f=this.U++;const D=new yi(this,this.j,f);let L=this.o;if(this.S&&(L?(L=k(L),R(L,this.S)):L=this.S),this.m!==null||this.O||(D.H=L,L=null),this.P)e:{for(var y=0,b=0;b<this.i.length;b++){t:{var T=this.i[b];if("__data__"in T.map&&(T=T.map.__data__,typeof T=="string")){T=T.length;break t}T=void 0}if(T===void 0)break;if(y+=T,4096<y){y=b;break e}if(y===4096||b===this.i.length-1){y=b+1;break e}}y=1e3}else y=1e3;y=q1(this,D,y),b=As(this.I),Ye(b,"RID",f),Ye(b,"CVER",22),this.D&&Ye(b,"X-HTTP-Session-Id",this.D),ic(this,b),L&&(this.O?y="headers="+encodeURIComponent(String(O1(L)))+"&"+y:this.m&&Lp(b,this.m,L)),Dp(this.h,D),this.Ua&&Ye(b,"TYPE","init"),this.P?(Ye(b,"$req",y),Ye(b,"SID","null"),D.T=!0,Ap(D,b,null)):Ap(D,b,y),this.G=2}}else this.G==3&&(f?W1(this,f):this.i.length==0||j1(this.h)||W1(this))};function W1(f,y){var b;y?b=y.l:b=f.U++;const T=As(f.I);Ye(T,"SID",f.K),Ye(T,"RID",b),Ye(T,"AID",f.T),ic(f,T),f.m&&f.o&&Lp(T,f.m,f.o),b=new yi(f,f.j,b,f.B+1),f.m===null&&(b.H=f.o),y&&(f.i=y.D.concat(f.i)),y=q1(f,b,1e3),b.I=Math.round(.5*f.wa)+Math.round(.5*f.wa*Math.random()),Dp(f.h,b),Ap(b,T,y)}function ic(f,y){f.H&&F(f.H,function(b,T){Ye(y,T,b)}),f.l&&R1({},function(b,T){Ye(y,T,b)})}function q1(f,y,b){b=Math.min(f.i.length,b);var T=f.l?p(f.l.Na,f.l,f):null;e:{var D=f.i;let L=-1;for(;;){const G=["count="+b];L==-1?0<b?(L=D[0].g,G.push("ofs="+L)):L=0:G.push("ofs="+L);let qe=!0;for(let Xt=0;Xt<b;Xt++){let Oe=D[Xt].g;const cn=D[Xt].map;if(Oe-=L,0>Oe)L=Math.max(0,D[Xt].g-100),qe=!1;else try{JA(cn,G,"req"+Oe+"_")}catch{T&&T(cn)}}if(qe){T=G.join("&");break e}}}return f=f.i.splice(0,b),y.D=f,T}function K1(f){if(!f.g&&!f.u){f.Y=1;var y=f.Fa;he||Z(),V||(he(),V=!0),J.add(y,f),f.v=0}}function $p(f){return f.g||f.u||3<=f.v?!1:(f.Y++,f.u=Xl(p(f.Fa,f),Y1(f,f.v)),f.v++,!0)}t.Fa=function(){if(this.u=null,Q1(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var f=2*this.R;this.j.info("BP detection timer enabled: "+f),this.A=Xl(p(this.ab,this),f)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,jn(10),Sd(this),Q1(this))};function zp(f){f.A!=null&&(l.clearTimeout(f.A),f.A=null)}function Q1(f){f.g=new yi(f,f.j,"rpc",f.Y),f.m===null&&(f.g.H=f.o),f.g.O=0;var y=As(f.qa);Ye(y,"RID","rpc"),Ye(y,"SID",f.K),Ye(y,"AID",f.T),Ye(y,"CI",f.F?"0":"1"),!f.F&&f.ja&&Ye(y,"TO",f.ja),Ye(y,"TYPE","xmlhttp"),ic(f,y),f.m&&f.o&&Lp(y,f.m,f.o),f.L&&(f.g.I=f.L);var b=f.g;f=f.ia,b.L=1,b.v=yd(As(y)),b.m=null,b.P=!0,S1(b,f)}t.Za=function(){this.C!=null&&(this.C=null,Sd(this),$p(this),jn(19))};function Ed(f){f.C!=null&&(l.clearTimeout(f.C),f.C=null)}function X1(f,y){var b=null;if(f.g==y){Ed(f),zp(f),f.g=null;var T=2}else if(Mp(f.h,y))b=y.D,I1(f.h,y),T=1;else return;if(f.G!=0){if(y.o)if(T==1){b=y.m?y.m.length:0,y=Date.now()-y.F;var D=f.B;T=hd(),kn(T,new y1(T,b)),bd(f)}else K1(f);else if(D=y.s,D==3||D==0&&0<y.X||!(T==1&&n5(f,y)||T==2&&$p(f)))switch(b&&0<b.length&&(y=f.h,y.i=y.i.concat(b)),D){case 1:xa(f,5);break;case 4:xa(f,10);break;case 3:xa(f,6);break;default:xa(f,2)}}}function Y1(f,y){let b=f.Ta+Math.floor(Math.random()*f.cb);return f.isActive()||(b*=2),b*y}function xa(f,y){if(f.j.info("Error code "+y),y==2){var b=p(f.fb,f),T=f.Xa;const D=!T;T=new ga(T||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||gd(T,"https"),yd(T),D?QA(T.toString(),b):XA(T.toString(),b)}else jn(2);f.G=0,f.l&&f.l.sa(y),J1(f),G1(f)}t.fb=function(f){f?(this.j.info("Successfully pinged google.com"),jn(2)):(this.j.info("Failed to ping google.com"),jn(1))};function J1(f){if(f.G=0,f.ka=[],f.l){const y=C1(f.h);(y.length!=0||f.i.length!=0)&&(v(f.ka,y),v(f.ka,f.i),f.h.i.length=0,w(f.i),f.i.length=0),f.l.ra()}}function Z1(f,y,b){var T=b instanceof ga?As(b):new ga(b);if(T.g!="")y&&(T.g=y+"."+T.g),xd(T,T.s);else{var D=l.location;T=D.protocol,y=y?y+"."+D.hostname:D.hostname,D=+D.port;var L=new ga(null);T&&gd(L,T),y&&(L.g=y),D&&xd(L,D),b&&(L.l=b),T=L}return b=f.D,y=f.ya,b&&y&&Ye(T,b,y),Ye(T,"VER",f.la),ic(f,T),T}function e_(f,y,b){if(y&&!f.J)throw Error("Can't create secondary domain capable XhrIo object.");return y=f.Ca&&!f.pa?new dt(new vd({eb:b})):new dt(f.pa),y.Ha(f.J),y}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function t_(){}t=t_.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function kd(){}kd.prototype.g=function(f,y){return new nr(f,y)};function nr(f,y){ln.call(this),this.g=new H1(y),this.l=f,this.h=y&&y.messageUrlParams||null,f=y&&y.messageHeaders||null,y&&y.clientProtocolHeaderRequired&&(f?f["X-Client-Protocol"]="webchannel":f={"X-Client-Protocol":"webchannel"}),this.g.o=f,f=y&&y.initMessageHeaders||null,y&&y.messageContentType&&(f?f["X-WebChannel-Content-Type"]=y.messageContentType:f={"X-WebChannel-Content-Type":y.messageContentType}),y&&y.va&&(f?f["X-WebChannel-Client-Profile"]=y.va:f={"X-WebChannel-Client-Profile":y.va}),this.g.S=f,(f=y&&y.Sb)&&!_(f)&&(this.g.m=f),this.v=y&&y.supportsCrossDomainXhr||!1,this.u=y&&y.sendRawJson||!1,(y=y&&y.httpSessionIdParam)&&!_(y)&&(this.g.D=y,f=this.h,f!==null&&y in f&&(f=this.h,y in f&&delete f[y])),this.j=new _o(this)}x(nr,ln),nr.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},nr.prototype.close=function(){Op(this.g)},nr.prototype.o=function(f){var y=this.g;if(typeof f=="string"){var b={};b.__data__=f,f=b}else this.u&&(b={},b.__data__=jp(f),f=b);y.i.push(new $A(y.Ya++,f)),y.G==3&&bd(y)},nr.prototype.N=function(){this.g.l=null,delete this.j,Op(this.g),delete this.g,nr.aa.N.call(this)};function n_(f){Ip.call(this),f.__headers__&&(this.headers=f.__headers__,this.statusCode=f.__status__,delete f.__headers__,delete f.__status__);var y=f.__sm__;if(y){e:{for(const b in y){f=b;break e}f=void 0}(this.i=f)&&(f=this.i,y=y!==null&&f in y?y[f]:void 0),this.data=y}else this.data=f}x(n_,Ip);function r_(){Cp.call(this),this.status=1}x(r_,Cp);function _o(f){this.g=f}x(_o,t_),_o.prototype.ua=function(){kn(this.g,"a")},_o.prototype.ta=function(f){kn(this.g,new n_(f))},_o.prototype.sa=function(f){kn(this.g,new r_)},_o.prototype.ra=function(){kn(this.g,"b")},kd.prototype.createWebChannel=kd.prototype.g,nr.prototype.send=nr.prototype.o,nr.prototype.open=nr.prototype.m,nr.prototype.close=nr.prototype.close,VT=function(){return new kd},BT=function(){return hd()},zT=ma,hx={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},fd.NO_ERROR=0,fd.TIMEOUT=8,fd.HTTP_ERROR=6,Eh=fd,v1.COMPLETE="complete",$T=v1,m1.EventType=Kl,Kl.OPEN="a",Kl.CLOSE="b",Kl.ERROR="c",Kl.MESSAGE="d",ln.prototype.listen=ln.prototype.K,Sc=m1,dt.prototype.listenOnce=dt.prototype.L,dt.prototype.getLastError=dt.prototype.Ka,dt.prototype.getLastErrorCode=dt.prototype.Ba,dt.prototype.getStatus=dt.prototype.Z,dt.prototype.getResponseJson=dt.prototype.Oa,dt.prototype.getResponseText=dt.prototype.oa,dt.prototype.send=dt.prototype.ea,dt.prototype.setWithCredentials=dt.prototype.Ha,OT=dt}).apply(typeof Hd<"u"?Hd:typeof self<"u"?self:typeof window<"u"?window:{});const WS="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}pn.UNAUTHENTICATED=new pn(null),pn.GOOGLE_CREDENTIALS=new pn("google-credentials-uid"),pn.FIRST_PARTY=new pn("first-party-uid"),pn.MOCK_USER=new pn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ml="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ha=new _v("@firebase/firestore");function pc(){return Ha.logLevel}function Y(t,...e){if(Ha.logLevel<=Pe.DEBUG){const n=e.map(Ev);Ha.debug(`Firestore (${Ml}): ${t}`,...n)}}function ri(t,...e){if(Ha.logLevel<=Pe.ERROR){const n=e.map(Ev);Ha.error(`Firestore (${Ml}): ${t}`,...n)}}function fl(t,...e){if(Ha.logLevel<=Pe.WARN){const n=e.map(Ev);Ha.warn(`Firestore (${Ml}): ${t}`,...n)}}function Ev(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pe(t="Unexpected state"){const e=`FIRESTORE (${Ml}) INTERNAL ASSERTION FAILED: `+t;throw ri(e),new Error(e)}function He(t,e){t||pe()}function we(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class W extends hi{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qs{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UT{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class gO{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(pn.UNAUTHENTICATED))}shutdown(){}}class xO{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class yO{constructor(e){this.t=e,this.currentUser=pn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){He(this.o===void 0);let r=this.i;const s=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve();let i=new qs;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new qs,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const c=i;e.enqueueRetryable(async()=>{await c.promise,await s(this.currentUser)})},l=c=>{Y("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>l(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?l(c):(Y("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new qs)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(Y("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(He(typeof r.accessToken=="string"),new UT(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return He(e===null||typeof e=="string"),new pn(e)}}class vO{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=pn.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class wO{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new vO(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(pn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class _O{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class SO{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){He(this.o===void 0);const r=i=>{i.error!=null&&Y("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.R;return this.R=i.token,Y("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{Y("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):Y("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(He(typeof n.token=="string"),this.R=n.token,new _O(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bO(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HT{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=bO(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%e.length))}return r}}function $e(t,e){return t<e?-1:t>e?1:0}function ml(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tt{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new W($.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new W($.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new W($.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new W($.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Tt.fromMillis(Date.now())}static fromDate(e){return Tt.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new Tt(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?$e(this.nanoseconds,e.nanoseconds):$e(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ve{constructor(e){this.timestamp=e}static fromTimestamp(e){return new ve(e)}static min(){return new ve(new Tt(0,0))}static max(){return new ve(new Tt(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lu{constructor(e,n,r){n===void 0?n=0:n>e.length&&pe(),r===void 0?r=e.length-n:r>e.length-n&&pe(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return lu.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof lu?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=e.get(s),o=n.get(s);if(i<o)return-1;if(i>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class Qe extends lu{construct(e,n,r){return new Qe(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new W($.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new Qe(n)}static emptyPath(){return new Qe([])}}const EO=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class tn extends lu{construct(e,n,r){return new tn(e,n,r)}static isValidIdentifier(e){return EO.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),tn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new tn(["__name__"])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new W($.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const l=e[s];if(l==="\\"){if(s+1===e.length)throw new W($.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[s+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new W($.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,s+=2}else l==="`"?(o=!o,s++):l!=="."||o?(r+=l,s++):(i(),s++)}if(i(),o)throw new W($.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new tn(n)}static emptyPath(){return new tn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class re{constructor(e){this.path=e}static fromPath(e){return new re(Qe.fromString(e))}static fromName(e){return new re(Qe.fromString(e).popFirst(5))}static empty(){return new re(Qe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Qe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Qe.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new re(new Qe(e.slice()))}}function kO(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=ve.fromTimestamp(r===1e9?new Tt(n+1,0):new Tt(n,r));return new Yi(s,re.empty(),e)}function jO(t){return new Yi(t.readTime,t.key,-1)}class Yi{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Yi(ve.min(),re.empty(),-1)}static max(){return new Yi(ve.max(),re.empty(),-1)}}function TO(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=re.comparator(t.documentKey,e.documentKey),n!==0?n:$e(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IO="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class CO{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ou(t){if(t.code!==$.FAILED_PRECONDITION||t.message!==IO)throw t;Y("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&pe(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new U((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof U?n:U.resolve(n)}catch(n){return U.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):U.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):U.reject(n)}static resolve(e){return new U((n,r)=>{n(e)})}static reject(e){return new U((n,r)=>{r(e)})}static waitFor(e){return new U((n,r)=>{let s=0,i=0,o=!1;e.forEach(l=>{++s,l.next(()=>{++i,o&&i===s&&n()},c=>r(c))}),o=!0,i===s&&n()})}static or(e){let n=U.resolve(!1);for(const r of e)n=n.next(s=>s?U.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new U((r,s)=>{const i=e.length,o=new Array(i);let l=0;for(let c=0;c<i;c++){const u=c;n(e[u]).next(d=>{o[u]=d,++l,l===i&&r(o)},d=>s(d))}})}static doWhile(e,n){return new U((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}function RO(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function $u(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kv{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}kv.oe=-1;function jm(t){return t==null}function xf(t){return t===0&&1/t==-1/0}function NO(t){return typeof t=="number"&&Number.isInteger(t)&&!xf(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qS(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function lo(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function GT(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ct{constructor(e,n){this.comparator=e,this.root=n||en.EMPTY}insert(e,n){return new ct(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,en.BLACK,null,null))}remove(e){return new ct(this.comparator,this.root.remove(e,this.comparator).copy(null,null,en.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Gd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Gd(this.root,e,this.comparator,!1)}getReverseIterator(){return new Gd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Gd(this.root,e,this.comparator,!0)}}class Gd{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class en{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??en.RED,this.left=s??en.EMPTY,this.right=i??en.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new en(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return en.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return en.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,en.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,en.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw pe();const e=this.left.check();if(e!==this.right.check())throw pe();return e+(this.isRed()?0:1)}}en.EMPTY=null,en.RED=!0,en.BLACK=!1;en.EMPTY=new class{constructor(){this.size=0}get key(){throw pe()}get value(){throw pe()}get color(){throw pe()}get left(){throw pe()}get right(){throw pe()}copy(e,n,r,s,i){return this}insert(e,n,r){return new en(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rn{constructor(e){this.comparator=e,this.data=new ct(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new KS(this.data.getIterator())}getIteratorFrom(e){return new KS(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof rn)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new rn(this.comparator);return n.data=e,n}}class KS{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dr{constructor(e){this.fields=e,e.sort(tn.comparator)}static empty(){return new dr([])}unionWith(e){let n=new rn(tn.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new dr(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return ml(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WT extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class an{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new WT("Invalid base64 string: "+i):i}}(e);return new an(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new an(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return $e(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}an.EMPTY_BYTE_STRING=new an("");const AO=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ji(t){if(He(!!t),typeof t=="string"){let e=0;const n=AO.exec(t);if(He(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:xt(t.seconds),nanos:xt(t.nanos)}}function xt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Ga(t){return typeof t=="string"?an.fromBase64String(t):an.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tm(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function jv(t){const e=t.mapValue.fields.__previous_value__;return Tm(e)?jv(e):e}function cu(t){const e=Ji(t.mapValue.fields.__local_write_time__.timestampValue);return new Tt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PO{constructor(e,n,r,s,i,o,l,c,u){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=u}}class uu{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new uu("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof uu&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wd={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Wa(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Tm(t)?4:MO(t)?9007199254740991:FO(t)?10:11:pe()}function bs(t,e){if(t===e)return!0;const n=Wa(t);if(n!==Wa(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return cu(t).isEqual(cu(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=Ji(s.timestampValue),l=Ji(i.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return Ga(s.bytesValue).isEqual(Ga(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return xt(s.geoPointValue.latitude)===xt(i.geoPointValue.latitude)&&xt(s.geoPointValue.longitude)===xt(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return xt(s.integerValue)===xt(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=xt(s.doubleValue),l=xt(i.doubleValue);return o===l?xf(o)===xf(l):isNaN(o)&&isNaN(l)}return!1}(t,e);case 9:return ml(t.arrayValue.values||[],e.arrayValue.values||[],bs);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},l=i.mapValue.fields||{};if(qS(o)!==qS(l))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(l[c]===void 0||!bs(o[c],l[c])))return!1;return!0}(t,e);default:return pe()}}function du(t,e){return(t.values||[]).find(n=>bs(n,e))!==void 0}function pl(t,e){if(t===e)return 0;const n=Wa(t),r=Wa(e);if(n!==r)return $e(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return $e(t.booleanValue,e.booleanValue);case 2:return function(i,o){const l=xt(i.integerValue||i.doubleValue),c=xt(o.integerValue||o.doubleValue);return l<c?-1:l>c?1:l===c?0:isNaN(l)?isNaN(c)?0:-1:1}(t,e);case 3:return QS(t.timestampValue,e.timestampValue);case 4:return QS(cu(t),cu(e));case 5:return $e(t.stringValue,e.stringValue);case 6:return function(i,o){const l=Ga(i),c=Ga(o);return l.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const l=i.split("/"),c=o.split("/");for(let u=0;u<l.length&&u<c.length;u++){const d=$e(l[u],c[u]);if(d!==0)return d}return $e(l.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const l=$e(xt(i.latitude),xt(o.latitude));return l!==0?l:$e(xt(i.longitude),xt(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return XS(t.arrayValue,e.arrayValue);case 10:return function(i,o){var l,c,u,d;const m=i.fields||{},p=o.fields||{},g=(l=m.value)===null||l===void 0?void 0:l.arrayValue,x=(c=p.value)===null||c===void 0?void 0:c.arrayValue,w=$e(((u=g==null?void 0:g.values)===null||u===void 0?void 0:u.length)||0,((d=x==null?void 0:x.values)===null||d===void 0?void 0:d.length)||0);return w!==0?w:XS(g,x)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===Wd.mapValue&&o===Wd.mapValue)return 0;if(i===Wd.mapValue)return 1;if(o===Wd.mapValue)return-1;const l=i.fields||{},c=Object.keys(l),u=o.fields||{},d=Object.keys(u);c.sort(),d.sort();for(let m=0;m<c.length&&m<d.length;++m){const p=$e(c[m],d[m]);if(p!==0)return p;const g=pl(l[c[m]],u[d[m]]);if(g!==0)return g}return $e(c.length,d.length)}(t.mapValue,e.mapValue);default:throw pe()}}function QS(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return $e(t,e);const n=Ji(t),r=Ji(e),s=$e(n.seconds,r.seconds);return s!==0?s:$e(n.nanos,r.nanos)}function XS(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=pl(n[s],r[s]);if(i)return i}return $e(n.length,r.length)}function gl(t){return fx(t)}function fx(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Ji(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Ga(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return re.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=fx(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${fx(n.fields[o])}`;return s+"}"}(t.mapValue):pe()}function yf(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function mx(t){return!!t&&"integerValue"in t}function Tv(t){return!!t&&"arrayValue"in t}function YS(t){return!!t&&"nullValue"in t}function JS(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function kh(t){return!!t&&"mapValue"in t}function FO(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function Lc(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return lo(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Lc(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Lc(t.arrayValue.values[n]);return e}return Object.assign({},t)}function MO(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qn{constructor(e){this.value=e}static empty(){return new qn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!kh(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Lc(n)}setAll(e){let n=tn.emptyPath(),r={},s=[];e.forEach((o,l)=>{if(!n.isImmediateParentOf(l)){const c=this.getFieldsMap(n);this.applyChanges(c,r,s),r={},s=[],n=l.popLast()}o?r[l.lastSegment()]=Lc(o):s.push(l.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());kh(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return bs(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];kh(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){lo(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new qn(Lc(this.value))}}function qT(t){const e=[];return lo(t.fields,(n,r)=>{const s=new tn([n]);if(kh(r)){const i=qT(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new dr(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xn{constructor(e,n,r,s,i,o,l){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=l}static newInvalidDocument(e){return new xn(e,0,ve.min(),ve.min(),ve.min(),qn.empty(),0)}static newFoundDocument(e,n,r,s){return new xn(e,1,n,ve.min(),r,s,0)}static newNoDocument(e,n){return new xn(e,2,n,ve.min(),ve.min(),qn.empty(),0)}static newUnknownDocument(e,n){return new xn(e,3,n,ve.min(),ve.min(),qn.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(ve.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=qn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=qn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ve.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof xn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new xn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xl{constructor(e,n){this.position=e,this.inclusive=n}}function ZS(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=re.comparator(re.fromName(o.referenceValue),n.key):r=pl(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function eb(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!bs(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hu{constructor(e,n="asc"){this.field=e,this.dir=n}}function DO(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KT{}class jt extends KT{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new OO(e,n,r):n==="array-contains"?new BO(e,r):n==="in"?new VO(e,r):n==="not-in"?new UO(e,r):n==="array-contains-any"?new HO(e,r):new jt(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new $O(e,r):new zO(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(pl(n,this.value)):n!==null&&Wa(this.value)===Wa(n)&&this.matchesComparison(pl(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return pe()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ts extends KT{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new ts(e,n)}matches(e){return QT(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function QT(t){return t.op==="and"}function XT(t){return LO(t)&&QT(t)}function LO(t){for(const e of t.filters)if(e instanceof ts)return!1;return!0}function px(t){if(t instanceof jt)return t.field.canonicalString()+t.op.toString()+gl(t.value);if(XT(t))return t.filters.map(e=>px(e)).join(",");{const e=t.filters.map(n=>px(n)).join(",");return`${t.op}(${e})`}}function YT(t,e){return t instanceof jt?function(r,s){return s instanceof jt&&r.op===s.op&&r.field.isEqual(s.field)&&bs(r.value,s.value)}(t,e):t instanceof ts?function(r,s){return s instanceof ts&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,l)=>i&&YT(o,s.filters[l]),!0):!1}(t,e):void pe()}function JT(t){return t instanceof jt?function(n){return`${n.field.canonicalString()} ${n.op} ${gl(n.value)}`}(t):t instanceof ts?function(n){return n.op.toString()+" {"+n.getFilters().map(JT).join(" ,")+"}"}(t):"Filter"}class OO extends jt{constructor(e,n,r){super(e,n,r),this.key=re.fromName(r.referenceValue)}matches(e){const n=re.comparator(e.key,this.key);return this.matchesComparison(n)}}class $O extends jt{constructor(e,n){super(e,"in",n),this.keys=ZT("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class zO extends jt{constructor(e,n){super(e,"not-in",n),this.keys=ZT("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function ZT(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>re.fromName(r.referenceValue))}class BO extends jt{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Tv(n)&&du(n.arrayValue,this.value)}}class VO extends jt{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&du(this.value.arrayValue,n)}}class UO extends jt{constructor(e,n){super(e,"not-in",n)}matches(e){if(du(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!du(this.value.arrayValue,n)}}class HO extends jt{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Tv(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>du(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GO{constructor(e,n=null,r=[],s=[],i=null,o=null,l=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=l,this.ue=null}}function tb(t,e=null,n=[],r=[],s=null,i=null,o=null){return new GO(t,e,n,r,s,i,o)}function Iv(t){const e=we(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>px(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),jm(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>gl(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>gl(r)).join(",")),e.ue=n}return e.ue}function Cv(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!DO(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!YT(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!eb(t.startAt,e.startAt)&&eb(t.endAt,e.endAt)}function gx(t){return re.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class co{constructor(e,n=null,r=[],s=[],i=null,o="F",l=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=l,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function WO(t,e,n,r,s,i,o,l){return new co(t,e,n,r,s,i,o,l)}function Rv(t){return new co(t)}function nb(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function Nv(t){return t.collectionGroup!==null}function Zo(t){const e=we(t);if(e.ce===null){e.ce=[];const n=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new rn(tn.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(u=>{u.isInequality()&&(l=l.add(u.field))})}),l})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.ce.push(new hu(i,r))}),n.has(tn.keyField().canonicalString())||e.ce.push(new hu(tn.keyField(),r))}return e.ce}function ws(t){const e=we(t);return e.le||(e.le=qO(e,Zo(t))),e.le}function qO(t,e){if(t.limitType==="F")return tb(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new hu(s.field,i)});const n=t.endAt?new xl(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new xl(t.startAt.position,t.startAt.inclusive):null;return tb(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function xx(t,e){const n=t.filters.concat([e]);return new co(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function vf(t,e,n){return new co(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Im(t,e){return Cv(ws(t),ws(e))&&t.limitType===e.limitType}function eI(t){return`${Iv(ws(t))}|lt:${t.limitType}`}function Co(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>JT(s)).join(", ")}]`),jm(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>gl(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>gl(s)).join(",")),`Target(${r})`}(ws(t))}; limitType=${t.limitType})`}function Cm(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):re.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of Zo(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,l,c){const u=ZS(o,l,c);return o.inclusive?u<=0:u<0}(r.startAt,Zo(r),s)||r.endAt&&!function(o,l,c){const u=ZS(o,l,c);return o.inclusive?u>=0:u>0}(r.endAt,Zo(r),s))}(t,e)}function KO(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function tI(t){return(e,n)=>{let r=!1;for(const s of Zo(t)){const i=QO(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function QO(t,e,n){const r=t.field.isKeyField()?re.comparator(e.key,n.key):function(i,o,l){const c=o.data.field(i),u=l.data.field(i);return c!==null&&u!==null?pl(c,u):pe()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return pe()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dl{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){lo(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return GT(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XO=new ct(re.comparator);function si(){return XO}const nI=new ct(re.comparator);function bc(...t){let e=nI;for(const n of t)e=e.insert(n.key,n);return e}function rI(t){let e=nI;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Na(){return Oc()}function sI(){return Oc()}function Oc(){return new Dl(t=>t.toString(),(t,e)=>t.isEqual(e))}const YO=new ct(re.comparator),JO=new rn(re.comparator);function Ie(...t){let e=JO;for(const n of t)e=e.add(n);return e}const ZO=new rn($e);function e9(){return ZO}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Av(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:xf(e)?"-0":e}}function iI(t){return{integerValue:""+t}}function aI(t,e){return NO(e)?iI(e):Av(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rm{constructor(){this._=void 0}}function t9(t,e,n){return t instanceof fu?function(s,i){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&Tm(i)&&(i=jv(i)),i&&(o.fields.__previous_value__=i),{mapValue:o}}(n,e):t instanceof mu?lI(t,e):t instanceof pu?cI(t,e):function(s,i){const o=oI(s,i),l=rb(o)+rb(s.Pe);return mx(o)&&mx(s.Pe)?iI(l):Av(s.serializer,l)}(t,e)}function n9(t,e,n){return t instanceof mu?lI(t,e):t instanceof pu?cI(t,e):n}function oI(t,e){return t instanceof gu?function(r){return mx(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class fu extends Rm{}class mu extends Rm{constructor(e){super(),this.elements=e}}function lI(t,e){const n=uI(e);for(const r of t.elements)n.some(s=>bs(s,r))||n.push(r);return{arrayValue:{values:n}}}class pu extends Rm{constructor(e){super(),this.elements=e}}function cI(t,e){let n=uI(e);for(const r of t.elements)n=n.filter(s=>!bs(s,r));return{arrayValue:{values:n}}}class gu extends Rm{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function rb(t){return xt(t.integerValue||t.doubleValue)}function uI(t){return Tv(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dI{constructor(e,n){this.field=e,this.transform=n}}function r9(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof mu&&s instanceof mu||r instanceof pu&&s instanceof pu?ml(r.elements,s.elements,bs):r instanceof gu&&s instanceof gu?bs(r.Pe,s.Pe):r instanceof fu&&s instanceof fu}(t.transform,e.transform)}class s9{constructor(e,n){this.version=e,this.transformResults=n}}class Nn{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Nn}static exists(e){return new Nn(void 0,e)}static updateTime(e){return new Nn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function jh(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Nm{}function hI(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Am(t.key,Nn.none()):new zu(t.key,t.data,Nn.none());{const n=t.data,r=qn.empty();let s=new rn(tn.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new la(t.key,r,new dr(s.toArray()),Nn.none())}}function i9(t,e,n){t instanceof zu?function(s,i,o){const l=s.value.clone(),c=ib(s.fieldTransforms,i,o.transformResults);l.setAll(c),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):t instanceof la?function(s,i,o){if(!jh(s.precondition,i))return void i.convertToUnknownDocument(o.version);const l=ib(s.fieldTransforms,i,o.transformResults),c=i.data;c.setAll(fI(s)),c.setAll(l),i.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function $c(t,e,n,r){return t instanceof zu?function(i,o,l,c){if(!jh(i.precondition,o))return l;const u=i.value.clone(),d=ab(i.fieldTransforms,c,o);return u.setAll(d),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(t,e,n,r):t instanceof la?function(i,o,l,c){if(!jh(i.precondition,o))return l;const u=ab(i.fieldTransforms,c,o),d=o.data;return d.setAll(fI(i)),d.setAll(u),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),l===null?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(m=>m.field))}(t,e,n,r):function(i,o,l){return jh(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(t,e,n)}function a9(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=oI(r.transform,s||null);i!=null&&(n===null&&(n=qn.empty()),n.set(r.field,i))}return n||null}function sb(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&ml(r,s,(i,o)=>r9(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class zu extends Nm{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class la extends Nm{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function fI(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function ib(t,e,n){const r=new Map;He(t.length===n.length);for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,l=e.data.field(i.field);r.set(i.field,n9(o,l,n[s]))}return r}function ab(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,t9(i,o,e))}return r}class Am extends Nm{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class o9 extends Nm{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l9{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&i9(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=$c(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=$c(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=sI();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let l=this.applyToLocalView(o,i.mutatedFields);l=n.has(s.key)?null:l;const c=hI(o,l);c!==null&&r.set(s.key,c),o.isValidDocument()||o.convertToNoDocument(ve.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Ie())}isEqual(e){return this.batchId===e.batchId&&ml(this.mutations,e.mutations,(n,r)=>sb(n,r))&&ml(this.baseMutations,e.baseMutations,(n,r)=>sb(n,r))}}class Pv{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){He(e.mutations.length===r.length);let s=function(){return YO}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new Pv(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c9{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u9{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Et,Me;function d9(t){switch(t){default:return pe();case $.CANCELLED:case $.UNKNOWN:case $.DEADLINE_EXCEEDED:case $.RESOURCE_EXHAUSTED:case $.INTERNAL:case $.UNAVAILABLE:case $.UNAUTHENTICATED:return!1;case $.INVALID_ARGUMENT:case $.NOT_FOUND:case $.ALREADY_EXISTS:case $.PERMISSION_DENIED:case $.FAILED_PRECONDITION:case $.ABORTED:case $.OUT_OF_RANGE:case $.UNIMPLEMENTED:case $.DATA_LOSS:return!0}}function mI(t){if(t===void 0)return ri("GRPC error has no .code"),$.UNKNOWN;switch(t){case Et.OK:return $.OK;case Et.CANCELLED:return $.CANCELLED;case Et.UNKNOWN:return $.UNKNOWN;case Et.DEADLINE_EXCEEDED:return $.DEADLINE_EXCEEDED;case Et.RESOURCE_EXHAUSTED:return $.RESOURCE_EXHAUSTED;case Et.INTERNAL:return $.INTERNAL;case Et.UNAVAILABLE:return $.UNAVAILABLE;case Et.UNAUTHENTICATED:return $.UNAUTHENTICATED;case Et.INVALID_ARGUMENT:return $.INVALID_ARGUMENT;case Et.NOT_FOUND:return $.NOT_FOUND;case Et.ALREADY_EXISTS:return $.ALREADY_EXISTS;case Et.PERMISSION_DENIED:return $.PERMISSION_DENIED;case Et.FAILED_PRECONDITION:return $.FAILED_PRECONDITION;case Et.ABORTED:return $.ABORTED;case Et.OUT_OF_RANGE:return $.OUT_OF_RANGE;case Et.UNIMPLEMENTED:return $.UNIMPLEMENTED;case Et.DATA_LOSS:return $.DATA_LOSS;default:return pe()}}(Me=Et||(Et={}))[Me.OK=0]="OK",Me[Me.CANCELLED=1]="CANCELLED",Me[Me.UNKNOWN=2]="UNKNOWN",Me[Me.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Me[Me.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Me[Me.NOT_FOUND=5]="NOT_FOUND",Me[Me.ALREADY_EXISTS=6]="ALREADY_EXISTS",Me[Me.PERMISSION_DENIED=7]="PERMISSION_DENIED",Me[Me.UNAUTHENTICATED=16]="UNAUTHENTICATED",Me[Me.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Me[Me.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Me[Me.ABORTED=10]="ABORTED",Me[Me.OUT_OF_RANGE=11]="OUT_OF_RANGE",Me[Me.UNIMPLEMENTED=12]="UNIMPLEMENTED",Me[Me.INTERNAL=13]="INTERNAL",Me[Me.UNAVAILABLE=14]="UNAVAILABLE",Me[Me.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h9(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f9=new Ma([4294967295,4294967295],0);function ob(t){const e=h9().encode(t),n=new LT;return n.update(e),new Uint8Array(n.digest())}function lb(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Ma([n,r],0),new Ma([s,i],0)]}class Fv{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Ec(`Invalid padding: ${n}`);if(r<0)throw new Ec(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Ec(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Ec(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=Ma.fromNumber(this.Ie)}Ee(e,n,r){let s=e.add(n.multiply(Ma.fromNumber(r)));return s.compare(f9)===1&&(s=new Ma([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=ob(e),[r,s]=lb(n);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);if(!this.de(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new Fv(i,s,n);return r.forEach(l=>o.insert(l)),o}insert(e){if(this.Ie===0)return;const n=ob(e),[r,s]=lb(n);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);this.Ae(o)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Ec extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pm{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,Bu.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Pm(ve.min(),s,new ct($e),si(),Ie())}}class Bu{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Bu(r,n,Ie(),Ie(),Ie())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Th{constructor(e,n,r,s){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=s}}class pI{constructor(e,n){this.targetId=e,this.me=n}}class gI{constructor(e,n,r=an.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class cb{constructor(){this.fe=0,this.ge=db(),this.pe=an.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Ie(),n=Ie(),r=Ie();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:pe()}}),new Bu(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=db()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,He(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class m9{constructor(e){this.Le=e,this.Be=new Map,this.ke=si(),this.qe=ub(),this.Qe=new ct($e)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:pe()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,s)=>{this.ze(s)&&n(s)})}He(e){const n=e.targetId,r=e.me.count,s=this.Je(n);if(s){const i=s.target;if(gx(i))if(r===0){const o=new re(i.path);this.Ue(n,o,xn.newNoDocument(o,ve.min()))}else He(r===1);else{const o=this.Ye(n);if(o!==r){const l=this.Ze(e),c=l?this.Xe(l,e,o):1;if(c!==0){this.je(n);const u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,u)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,l;try{o=Ga(r).toUint8Array()}catch(c){if(c instanceof WT)return fl("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{l=new Fv(o,s,i)}catch(c){return fl(c instanceof Ec?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return l.Ie===0?null:l}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.Le.tt(),l=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(l)||(this.Ue(n,i,null),s++)}),s}rt(e){const n=new Map;this.Be.forEach((i,o)=>{const l=this.Je(o);if(l){if(i.current&&gx(l.target)){const c=new re(l.target.path);this.ke.get(c)!==null||this.it(o,c)||this.Ue(o,c,xn.newNoDocument(c,e))}i.be&&(n.set(o,i.ve()),i.Ce())}});let r=Ie();this.qe.forEach((i,o)=>{let l=!0;o.forEachWhile(c=>{const u=this.Je(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(i))}),this.ke.forEach((i,o)=>o.setReadTime(e));const s=new Pm(e,n,this.Qe,this.ke,r);return this.ke=si(),this.qe=ub(),this.Qe=new ct($e),s}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,n)?s.Fe(n,1):s.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new cb,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new rn($e),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||Y("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new cb),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function ub(){return new ct(re.comparator)}function db(){return new ct(re.comparator)}const p9=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),g9=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),x9=(()=>({and:"AND",or:"OR"}))();class y9{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function yx(t,e){return t.useProto3Json||jm(e)?e:{value:e}}function wf(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function xI(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function v9(t,e){return wf(t,e.toTimestamp())}function _s(t){return He(!!t),ve.fromTimestamp(function(n){const r=Ji(n);return new Tt(r.seconds,r.nanos)}(t))}function Mv(t,e){return vx(t,e).canonicalString()}function vx(t,e){const n=function(s){return new Qe(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function yI(t){const e=Qe.fromString(t);return He(bI(e)),e}function wx(t,e){return Mv(t.databaseId,e.path)}function bg(t,e){const n=yI(e);if(n.get(1)!==t.databaseId.projectId)throw new W($.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new W($.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new re(wI(n))}function vI(t,e){return Mv(t.databaseId,e)}function w9(t){const e=yI(t);return e.length===4?Qe.emptyPath():wI(e)}function _x(t){return new Qe(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function wI(t){return He(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function hb(t,e,n){return{name:wx(t,e),fields:n.value.mapValue.fields}}function _9(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:pe()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(u,d){return u.useProto3Json?(He(d===void 0||typeof d=="string"),an.fromBase64String(d||"")):(He(d===void 0||d instanceof Buffer||d instanceof Uint8Array),an.fromUint8Array(d||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(u){const d=u.code===void 0?$.UNKNOWN:mI(u.code);return new W(d,u.message||"")}(o);n=new gI(r,s,i,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=bg(t,r.document.name),i=_s(r.document.updateTime),o=r.document.createTime?_s(r.document.createTime):ve.min(),l=new qn({mapValue:{fields:r.document.fields}}),c=xn.newFoundDocument(s,i,o,l),u=r.targetIds||[],d=r.removedTargetIds||[];n=new Th(u,d,c.key,c)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=bg(t,r.document),i=r.readTime?_s(r.readTime):ve.min(),o=xn.newNoDocument(s,i),l=r.removedTargetIds||[];n=new Th([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=bg(t,r.document),i=r.removedTargetIds||[];n=new Th([],i,s,null)}else{if(!("filter"in e))return pe();{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new u9(s,i),l=r.targetId;n=new pI(l,o)}}return n}function S9(t,e){let n;if(e instanceof zu)n={update:hb(t,e.key,e.value)};else if(e instanceof Am)n={delete:wx(t,e.key)};else if(e instanceof la)n={update:hb(t,e.key,e.data),updateMask:N9(e.fieldMask)};else{if(!(e instanceof o9))return pe();n={verify:wx(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const l=o.transform;if(l instanceof fu)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof mu)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof pu)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof gu)return{fieldPath:o.field.canonicalString(),increment:l.Pe};throw pe()}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:v9(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:pe()}(t,e.precondition)),n}function b9(t,e){return t&&t.length>0?(He(e!==void 0),t.map(n=>function(s,i){let o=s.updateTime?_s(s.updateTime):_s(i);return o.isEqual(ve.min())&&(o=_s(i)),new s9(o,s.transformResults||[])}(n,e))):[]}function E9(t,e){return{documents:[vI(t,e.path)]}}function k9(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=vI(t,s);const i=function(u){if(u.length!==0)return SI(ts.create(u,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(u){if(u.length!==0)return u.map(d=>function(p){return{field:Ro(p.field),direction:I9(p.dir)}}(d))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const l=yx(t,e.limit);return l!==null&&(n.structuredQuery.limit=l),e.startAt&&(n.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{_t:n,parent:s}}function j9(t){let e=w9(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){He(r===1);const d=n.from[0];d.allDescendants?s=d.collectionId:e=e.child(d.collectionId)}let i=[];n.where&&(i=function(m){const p=_I(m);return p instanceof ts&&XT(p)?p.getFilters():[p]}(n.where));let o=[];n.orderBy&&(o=function(m){return m.map(p=>function(x){return new hu(No(x.field),function(v){switch(v){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(x.direction))}(p))}(n.orderBy));let l=null;n.limit&&(l=function(m){let p;return p=typeof m=="object"?m.value:m,jm(p)?null:p}(n.limit));let c=null;n.startAt&&(c=function(m){const p=!!m.before,g=m.values||[];return new xl(g,p)}(n.startAt));let u=null;return n.endAt&&(u=function(m){const p=!m.before,g=m.values||[];return new xl(g,p)}(n.endAt)),WO(e,s,o,i,l,"F",c,u)}function T9(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return pe()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function _I(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=No(n.unaryFilter.field);return jt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=No(n.unaryFilter.field);return jt.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=No(n.unaryFilter.field);return jt.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=No(n.unaryFilter.field);return jt.create(o,"!=",{nullValue:"NULL_VALUE"});default:return pe()}}(t):t.fieldFilter!==void 0?function(n){return jt.create(No(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return pe()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return ts.create(n.compositeFilter.filters.map(r=>_I(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return pe()}}(n.compositeFilter.op))}(t):pe()}function I9(t){return p9[t]}function C9(t){return g9[t]}function R9(t){return x9[t]}function Ro(t){return{fieldPath:t.canonicalString()}}function No(t){return tn.fromServerFormat(t.fieldPath)}function SI(t){return t instanceof jt?function(n){if(n.op==="=="){if(JS(n.value))return{unaryFilter:{field:Ro(n.field),op:"IS_NAN"}};if(YS(n.value))return{unaryFilter:{field:Ro(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(JS(n.value))return{unaryFilter:{field:Ro(n.field),op:"IS_NOT_NAN"}};if(YS(n.value))return{unaryFilter:{field:Ro(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ro(n.field),op:C9(n.op),value:n.value}}}(t):t instanceof ts?function(n){const r=n.getFilters().map(s=>SI(s));return r.length===1?r[0]:{compositeFilter:{op:R9(n.op),filters:r}}}(t):pe()}function N9(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function bI(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mi{constructor(e,n,r,s,i=ve.min(),o=ve.min(),l=an.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(e){return new Mi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Mi(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Mi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Mi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A9{constructor(e){this.ct=e}}function P9(t){const e=j9({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?vf(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F9{constructor(){this.un=new M9}addToCollectionParentIndex(e,n){return this.un.add(n),U.resolve()}getCollectionParents(e,n){return U.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return U.resolve()}deleteFieldIndex(e,n){return U.resolve()}deleteAllFieldIndexes(e){return U.resolve()}createTargetIndexes(e,n){return U.resolve()}getDocumentsMatchingTarget(e,n){return U.resolve(null)}getIndexType(e,n){return U.resolve(0)}getFieldIndexes(e,n){return U.resolve([])}getNextCollectionGroupToUpdate(e){return U.resolve(null)}getMinOffset(e,n){return U.resolve(Yi.min())}getMinOffsetFromCollectionGroup(e,n){return U.resolve(Yi.min())}updateCollectionGroup(e,n,r){return U.resolve()}updateIndexEntries(e,n){return U.resolve()}}class M9{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new rn(Qe.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new rn(Qe.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yl{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new yl(0)}static kn(){return new yl(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D9{constructor(){this.changes=new Dl(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,xn.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?U.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L9{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O9{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&$c(r.mutation,s,dr.empty(),Tt.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Ie()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Ie()){const s=Na();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=bc();return i.forEach((l,c)=>{o=o.insert(l,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=Na();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Ie()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,l)=>{n.set(o,l)})})}computeViews(e,n,r,s){let i=si();const o=Oc(),l=function(){return Oc()}();return n.forEach((c,u)=>{const d=r.get(u.key);s.has(u.key)&&(d===void 0||d.mutation instanceof la)?i=i.insert(u.key,u):d!==void 0?(o.set(u.key,d.mutation.getFieldMask()),$c(d.mutation,u,d.mutation.getFieldMask(),Tt.now())):o.set(u.key,dr.empty())}),this.recalculateAndSaveOverlays(e,i).next(c=>(c.forEach((u,d)=>o.set(u,d)),n.forEach((u,d)=>{var m;return l.set(u,new L9(d,(m=o.get(u))!==null&&m!==void 0?m:null))}),l))}recalculateAndSaveOverlays(e,n){const r=Oc();let s=new ct((o,l)=>o-l),i=Ie();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const l of o)l.keys().forEach(c=>{const u=n.get(c);if(u===null)return;let d=r.get(c)||dr.empty();d=l.applyToLocalView(u,d),r.set(c,d);const m=(s.get(l.batchId)||Ie()).add(c);s=s.insert(l.batchId,m)})}).next(()=>{const o=[],l=s.getReverseIterator();for(;l.hasNext();){const c=l.getNext(),u=c.key,d=c.value,m=sI();d.forEach(p=>{if(!i.has(p)){const g=hI(n.get(p),r.get(p));g!==null&&m.set(p,g),i=i.add(p)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,m))}return U.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(o){return re.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):Nv(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):U.resolve(Na());let l=-1,c=i;return o.next(u=>U.forEach(u,(d,m)=>(l<m.largestBatchId&&(l=m.largestBatchId),i.get(d)?U.resolve():this.remoteDocumentCache.getEntry(e,d).next(p=>{c=c.insert(d,p)}))).next(()=>this.populateOverlays(e,u,i)).next(()=>this.computeViews(e,c,u,Ie())).next(d=>({batchId:l,changes:rI(d)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new re(n)).next(r=>{let s=bc();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=bc();return this.indexManager.getCollectionParents(e,i).next(l=>U.forEach(l,c=>{const u=function(m,p){return new co(p,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)}(n,c.child(i));return this.getDocumentsMatchingCollectionQuery(e,u,r,s).next(d=>{d.forEach((m,p)=>{o=o.insert(m,p)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((c,u)=>{const d=u.getKey();o.get(d)===null&&(o=o.insert(d,xn.newInvalidDocument(d)))});let l=bc();return o.forEach((c,u)=>{const d=i.get(c);d!==void 0&&$c(d.mutation,u,dr.empty(),Tt.now()),Cm(n,u)&&(l=l.insert(c,u))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $9{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return U.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:_s(s.createTime)}}(n)),U.resolve()}getNamedQuery(e,n){return U.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(s){return{name:s.name,query:P9(s.bundledQuery),readTime:_s(s.readTime)}}(n)),U.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z9{constructor(){this.overlays=new ct(re.comparator),this.Ir=new Map}getOverlay(e,n){return U.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Na();return U.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.ht(e,n,i)}),U.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.Ir.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(r)),U.resolve()}getOverlaysForCollection(e,n,r){const s=Na(),i=n.length+1,o=new re(n.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const c=l.getNext().value,u=c.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===i&&c.largestBatchId>r&&s.set(c.getKey(),c)}return U.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new ct((u,d)=>u-d);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>r){let d=i.get(u.largestBatchId);d===null&&(d=Na(),i=i.insert(u.largestBatchId,d)),d.set(u.getKey(),u)}}const l=Na(),c=i.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,d)=>l.set(u,d)),!(l.size()>=s)););return U.resolve(l)}ht(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.Ir.get(s.largestBatchId).delete(r.key);this.Ir.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new c9(n,r));let i=this.Ir.get(n);i===void 0&&(i=Ie(),this.Ir.set(n,i)),this.Ir.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B9{constructor(){this.sessionToken=an.EMPTY_BYTE_STRING}getSessionToken(e){return U.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,U.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dv{constructor(){this.Tr=new rn(Bt.Er),this.dr=new rn(Bt.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new Bt(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new Bt(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new re(new Qe([])),r=new Bt(n,e),s=new Bt(n,e+1),i=[];return this.dr.forEachInRange([r,s],o=>{this.Vr(o),i.push(o.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new re(new Qe([])),r=new Bt(n,e),s=new Bt(n,e+1);let i=Ie();return this.dr.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new Bt(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Bt{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return re.comparator(e.key,n.key)||$e(e.wr,n.wr)}static Ar(e,n){return $e(e.wr,n.wr)||re.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V9{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new rn(Bt.Er)}checkEmpty(e){return U.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new l9(i,n,r,s);this.mutationQueue.push(o);for(const l of s)this.br=this.br.add(new Bt(l.key,i)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return U.resolve(o)}lookupMutationBatch(e,n){return U.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.vr(r),i=s<0?0:s;return U.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return U.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return U.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Bt(n,0),s=new Bt(n,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([r,s],o=>{const l=this.Dr(o.wr);i.push(l)}),U.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new rn($e);return n.forEach(s=>{const i=new Bt(s,0),o=new Bt(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,o],l=>{r=r.add(l.wr)})}),U.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;re.isDocumentKey(i)||(i=i.child(""));const o=new Bt(new re(i),0);let l=new rn($e);return this.br.forEachWhile(c=>{const u=c.key.path;return!!r.isPrefixOf(u)&&(u.length===s&&(l=l.add(c.wr)),!0)},o),U.resolve(this.Cr(l))}Cr(e){const n=[];return e.forEach(r=>{const s=this.Dr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){He(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return U.forEach(n.mutations,s=>{const i=new Bt(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new Bt(n,0),s=this.br.firstAfterOrEqual(r);return U.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,U.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U9{constructor(e){this.Mr=e,this.docs=function(){return new ct(re.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return U.resolve(r?r.document.mutableCopy():xn.newInvalidDocument(n))}getEntries(e,n){let r=si();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():xn.newInvalidDocument(s))}),U.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=si();const o=n.path,l=new re(o.child("")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){const{key:u,value:{document:d}}=c.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||TO(jO(d),r)<=0||(s.has(d.key)||Cm(n,d))&&(i=i.insert(d.key,d.mutableCopy()))}return U.resolve(i)}getAllFromCollectionGroup(e,n,r,s){pe()}Or(e,n){return U.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new H9(this)}getSize(e){return U.resolve(this.size)}}class H9 extends D9{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.cr.addEntry(e,s)):this.cr.removeEntry(r)}),U.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G9{constructor(e){this.persistence=e,this.Nr=new Dl(n=>Iv(n),Cv),this.lastRemoteSnapshotVersion=ve.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Dv,this.targetCount=0,this.kr=yl.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,s)=>n(s)),U.resolve()}getLastRemoteSnapshotVersion(e){return U.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return U.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),U.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),U.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new yl(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,U.resolve()}updateTargetData(e,n){return this.Kn(n),U.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,U.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.Nr.forEach((o,l)=>{l.sequenceNumber<=n&&r.get(l.targetId)===null&&(this.Nr.delete(o),i.push(this.removeMatchingKeysForTargetId(e,l.targetId)),s++)}),U.waitFor(i).next(()=>s)}getTargetCount(e){return U.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return U.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),U.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),U.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),U.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return U.resolve(r)}containsKey(e,n){return U.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W9{constructor(e,n){this.qr={},this.overlays={},this.Qr=new kv(0),this.Kr=!1,this.Kr=!0,this.$r=new B9,this.referenceDelegate=e(this),this.Ur=new G9(this),this.indexManager=new F9,this.remoteDocumentCache=function(s){return new U9(s)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new A9(n),this.Gr=new $9(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new z9,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new V9(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){Y("MemoryPersistence","Starting transaction:",e);const s=new q9(this.Qr.next());return this.referenceDelegate.zr(),r(s).next(i=>this.referenceDelegate.jr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Hr(e,n){return U.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}}class q9 extends CO{constructor(e){super(),this.currentSequenceNumber=e}}class Lv{constructor(e){this.persistence=e,this.Jr=new Dv,this.Yr=null}static Zr(e){return new Lv(e)}get Xr(){if(this.Yr)return this.Yr;throw pe()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),U.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),U.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),U.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(s=>this.Xr.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.Xr.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return U.forEach(this.Xr,r=>{const s=re.fromPath(r);return this.ei(e,s).next(i=>{i||n.removeEntry(s,ve.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return U.or([()=>U.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ov{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=s}static Wi(e,n){let r=Ie(),s=Ie();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Ov(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K9{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q9{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return ZL()?8:RO(Sn())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.Yi(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.Zi(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new K9;return this.Xi(e,n,o).next(l=>{if(i.result=l,this.zi)return this.es(e,n,o,l.size)})}).next(()=>i.result)}es(e,n,r,s){return r.documentReadCount<this.ji?(pc()<=Pe.DEBUG&&Y("QueryEngine","SDK will not create cache indexes for query:",Co(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),U.resolve()):(pc()<=Pe.DEBUG&&Y("QueryEngine","Query:",Co(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.Hi*s?(pc()<=Pe.DEBUG&&Y("QueryEngine","The SDK decides to create cache indexes for query:",Co(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ws(n))):U.resolve())}Yi(e,n){if(nb(n))return U.resolve(null);let r=ws(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=vf(n,null,"F"),r=ws(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=Ie(...i);return this.Ji.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,r).next(c=>{const u=this.ts(n,l);return this.ns(n,u,o,c.readTime)?this.Yi(e,vf(n,null,"F")):this.rs(e,u,n,c)}))})))}Zi(e,n,r,s){return nb(n)||s.isEqual(ve.min())?U.resolve(null):this.Ji.getDocuments(e,r).next(i=>{const o=this.ts(n,i);return this.ns(n,o,r,s)?U.resolve(null):(pc()<=Pe.DEBUG&&Y("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Co(n)),this.rs(e,o,n,kO(s,-1)).next(l=>l))})}ts(e,n){let r=new rn(tI(e));return n.forEach((s,i)=>{Cm(e,i)&&(r=r.add(i))}),r}ns(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Xi(e,n,r){return pc()<=Pe.DEBUG&&Y("QueryEngine","Using full collection scan to execute query:",Co(n)),this.Ji.getDocumentsMatchingQuery(e,n,Yi.min(),r)}rs(e,n,r,s){return this.Ji.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X9{constructor(e,n,r,s){this.persistence=e,this.ss=n,this.serializer=s,this.os=new ct($e),this._s=new Dl(i=>Iv(i),Cv),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new O9(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function Y9(t,e,n,r){return new X9(t,e,n,r)}async function EI(t,e){const n=we(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],l=[];let c=Ie();for(const u of s){o.push(u.batchId);for(const d of u.mutations)c=c.add(d.key)}for(const u of i){l.push(u.batchId);for(const d of u.mutations)c=c.add(d.key)}return n.localDocuments.getDocuments(r,c).next(u=>({hs:u,removedBatchIds:o,addedBatchIds:l}))})})}function J9(t,e){const n=we(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.cs.newChangeBuffer({trackRemovals:!0});return function(l,c,u,d){const m=u.batch,p=m.keys();let g=U.resolve();return p.forEach(x=>{g=g.next(()=>d.getEntry(c,x)).next(w=>{const v=u.docVersions.get(x);He(v!==null),w.version.compareTo(v)<0&&(m.applyToRemoteDocument(w,u),w.isValidDocument()&&(w.setReadTime(u.commitVersion),d.addEntry(w)))})}),g.next(()=>l.mutationQueue.removeMutationBatch(c,m))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let c=Ie();for(let u=0;u<l.mutationResults.length;++u)l.mutationResults[u].transformResults.length>0&&(c=c.add(l.batch.mutations[u].key));return c}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function kI(t){const e=we(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function Z9(t,e){const n=we(t),r=e.snapshotVersion;let s=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.cs.newChangeBuffer({trackRemovals:!0});s=n.os;const l=[];e.targetChanges.forEach((d,m)=>{const p=s.get(m);if(!p)return;l.push(n.Ur.removeMatchingKeys(i,d.removedDocuments,m).next(()=>n.Ur.addMatchingKeys(i,d.addedDocuments,m)));let g=p.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(m)!==null?g=g.withResumeToken(an.EMPTY_BYTE_STRING,ve.min()).withLastLimboFreeSnapshotVersion(ve.min()):d.resumeToken.approximateByteSize()>0&&(g=g.withResumeToken(d.resumeToken,r)),s=s.insert(m,g),function(w,v,S){return w.resumeToken.approximateByteSize()===0||v.snapshotVersion.toMicroseconds()-w.snapshotVersion.toMicroseconds()>=3e8?!0:S.addedDocuments.size+S.modifiedDocuments.size+S.removedDocuments.size>0}(p,g,d)&&l.push(n.Ur.updateTargetData(i,g))});let c=si(),u=Ie();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(i,d))}),l.push(e7(i,o,e.documentUpdates).next(d=>{c=d.Ps,u=d.Is})),!r.isEqual(ve.min())){const d=n.Ur.getLastRemoteSnapshotVersion(i).next(m=>n.Ur.setTargetsMetadata(i,i.currentSequenceNumber,r));l.push(d)}return U.waitFor(l).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,c,u)).next(()=>c)}).then(i=>(n.os=s,i))}function e7(t,e,n){let r=Ie(),s=Ie();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=si();return n.forEach((l,c)=>{const u=i.get(l);c.isFoundDocument()!==u.isFoundDocument()&&(s=s.add(l)),c.isNoDocument()&&c.version.isEqual(ve.min())?(e.removeEntry(l,c.readTime),o=o.insert(l,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),o=o.insert(l,c)):Y("LocalStore","Ignoring outdated watch update for ",l,". Current version:",u.version," Watch version:",c.version)}),{Ps:o,Is:s}})}function t7(t,e){const n=we(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function n7(t,e){const n=we(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Ur.getTargetData(r,e).next(i=>i?(s=i,U.resolve(s)):n.Ur.allocateTargetId(r).next(o=>(s=new Mi(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.os.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function Sx(t,e,n){const r=we(t),s=r.os.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!$u(o))throw o;Y("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(s.target)}function fb(t,e,n){const r=we(t);let s=ve.min(),i=Ie();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,u,d){const m=we(c),p=m._s.get(d);return p!==void 0?U.resolve(m.os.get(p)):m.Ur.getTargetData(u,d)}(r,o,ws(e)).next(l=>{if(l)return s=l.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,l.targetId).next(c=>{i=c})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,n?s:ve.min(),n?i:Ie())).next(l=>(r7(r,KO(e),l),{documents:l,Ts:i})))}function r7(t,e,n){let r=t.us.get(e)||ve.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.us.set(e,r)}class mb{constructor(){this.activeTargetIds=e9()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class s7{constructor(){this.so=new mb,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new mb,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i7{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pb{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){Y("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){Y("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let qd=null;function Eg(){return qd===null?qd=function(){return 268435456+Math.round(2147483648*Math.random())}():qd++,"0x"+qd.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a7={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o7{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fn="WebChannelConnection";class l7 extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${s}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get Fo(){return!1}Mo(n,r,s,i,o){const l=Eg(),c=this.xo(n,r.toUriEncodedString());Y("RestConnection",`Sending RPC '${n}' ${l}:`,c,s);const u={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(u,i,o),this.No(n,c,u,s).then(d=>(Y("RestConnection",`Received RPC '${n}' ${l}: `,d),d),d=>{throw fl("RestConnection",`RPC '${n}' ${l} failed with error: `,d,"url: ",c,"request:",s),d})}Lo(n,r,s,i,o,l){return this.Mo(n,r,s,i,o)}Oo(n,r,s){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Ml}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,o)=>n[o]=i),s&&s.headers.forEach((i,o)=>n[o]=i)}xo(n,r){const s=a7[n];return`${this.Do}/v1/${r}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,s){const i=Eg();return new Promise((o,l)=>{const c=new OT;c.setWithCredentials(!0),c.listenOnce($T.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Eh.NO_ERROR:const d=c.getResponseJson();Y(fn,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(d)),o(d);break;case Eh.TIMEOUT:Y(fn,`RPC '${e}' ${i} timed out`),l(new W($.DEADLINE_EXCEEDED,"Request time out"));break;case Eh.HTTP_ERROR:const m=c.getStatus();if(Y(fn,`RPC '${e}' ${i} failed with status:`,m,"response text:",c.getResponseText()),m>0){let p=c.getResponseJson();Array.isArray(p)&&(p=p[0]);const g=p==null?void 0:p.error;if(g&&g.status&&g.message){const x=function(v){const S=v.toLowerCase().replace(/_/g,"-");return Object.values($).indexOf(S)>=0?S:$.UNKNOWN}(g.status);l(new W(x,g.message))}else l(new W($.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new W($.UNAVAILABLE,"Connection failed."));break;default:pe()}}finally{Y(fn,`RPC '${e}' ${i} completed.`)}});const u=JSON.stringify(s);Y(fn,`RPC '${e}' ${i} sending request:`,s),c.send(n,"POST",u,r,15)})}Bo(e,n,r){const s=Eg(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=VT(),l=BT(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Oo(c.initMessageHeaders,n,r),c.encodeInitMessageHeaders=!0;const d=i.join("");Y(fn,`Creating RPC '${e}' stream ${s}: ${d}`,c);const m=o.createWebChannel(d,c);let p=!1,g=!1;const x=new o7({Io:v=>{g?Y(fn,`Not sending because RPC '${e}' stream ${s} is closed:`,v):(p||(Y(fn,`Opening RPC '${e}' stream ${s} transport.`),m.open(),p=!0),Y(fn,`RPC '${e}' stream ${s} sending:`,v),m.send(v))},To:()=>m.close()}),w=(v,S,_)=>{v.listen(S,E=>{try{_(E)}catch(I){setTimeout(()=>{throw I},0)}})};return w(m,Sc.EventType.OPEN,()=>{g||(Y(fn,`RPC '${e}' stream ${s} transport opened.`),x.yo())}),w(m,Sc.EventType.CLOSE,()=>{g||(g=!0,Y(fn,`RPC '${e}' stream ${s} transport closed`),x.So())}),w(m,Sc.EventType.ERROR,v=>{g||(g=!0,fl(fn,`RPC '${e}' stream ${s} transport errored:`,v),x.So(new W($.UNAVAILABLE,"The operation could not be completed")))}),w(m,Sc.EventType.MESSAGE,v=>{var S;if(!g){const _=v.data[0];He(!!_);const E=_,I=E.error||((S=E[0])===null||S===void 0?void 0:S.error);if(I){Y(fn,`RPC '${e}' stream ${s} received error:`,I);const P=I.status;let F=function(C){const R=Et[C];if(R!==void 0)return mI(R)}(P),j=I.message;F===void 0&&(F=$.INTERNAL,j="Unknown error status: "+P+" with message "+I.message),g=!0,x.So(new W(F,j)),m.close()}else Y(fn,`RPC '${e}' stream ${s} received:`,_),x.bo(_)}}),w(l,zT.STAT_EVENT,v=>{v.stat===hx.PROXY?Y(fn,`RPC '${e}' stream ${s} detected buffering proxy`):v.stat===hx.NOPROXY&&Y(fn,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{x.wo()},0),x}}function kg(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fm(t){return new y9(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jI{constructor(e,n,r=1e3,s=1.5,i=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=s,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),s=Math.max(0,n-r);s>0&&Y("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TI{constructor(e,n,r,s,i,o,l,c){this.ui=e,this.Ho=r,this.Jo=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new jI(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===$.RESOURCE_EXHAUSTED?(ri(n.toString()),ri("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===$.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Yo===n&&this.P_(r,s)},r=>{e(()=>{const s=new W($.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(s)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{r(()=>this.I_(s))}),this.stream.onMessage(s=>{r(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return Y("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(Y("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class c7 extends TI{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=_9(this.serializer,e),r=function(i){if(!("targetChange"in i))return ve.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?ve.min():o.readTime?_s(o.readTime):ve.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=_x(this.serializer),n.addTarget=function(i,o){let l;const c=o.target;if(l=gx(c)?{documents:E9(i,c)}:{query:k9(i,c)._t},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=xI(i,o.resumeToken);const u=yx(i,o.expectedCount);u!==null&&(l.expectedCount=u)}else if(o.snapshotVersion.compareTo(ve.min())>0){l.readTime=wf(i,o.snapshotVersion.toTimestamp());const u=yx(i,o.expectedCount);u!==null&&(l.expectedCount=u)}return l}(this.serializer,e);const r=T9(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=_x(this.serializer),n.removeTarget=e,this.a_(n)}}class u7 extends TI{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return He(!!e.streamToken),this.lastStreamToken=e.streamToken,He(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){He(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=b9(e.writeResults,e.commitTime),r=_s(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=_x(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>S9(this.serializer,r))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d7 extends class{}{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new W($.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Mo(e,vx(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===$.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new W($.UNKNOWN,i.toString())})}Lo(e,n,r,s,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Lo(e,vx(n,r),s,o,l,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===$.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new W($.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class h7{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(ri(n),this.D_=!1):Y("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f7{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(o=>{r.enqueueAndForget(async()=>{uo(this)&&(Y("RemoteStore","Restarting streams for network reachability change."),await async function(c){const u=we(c);u.L_.add(4),await Vu(u),u.q_.set("Unknown"),u.L_.delete(4),await Mm(u)}(this))})}),this.q_=new h7(r,s)}}async function Mm(t){if(uo(t))for(const e of t.B_)await e(!0)}async function Vu(t){for(const e of t.B_)await e(!1)}function II(t,e){const n=we(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),Vv(n)?Bv(n):Ll(n).r_()&&zv(n,e))}function $v(t,e){const n=we(t),r=Ll(n);n.N_.delete(e),r.r_()&&CI(n,e),n.N_.size===0&&(r.r_()?r.o_():uo(n)&&n.q_.set("Unknown"))}function zv(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ve.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Ll(t).A_(e)}function CI(t,e){t.Q_.xe(e),Ll(t).R_(e)}function Bv(t){t.Q_=new m9({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),Ll(t).start(),t.q_.v_()}function Vv(t){return uo(t)&&!Ll(t).n_()&&t.N_.size>0}function uo(t){return we(t).L_.size===0}function RI(t){t.Q_=void 0}async function m7(t){t.q_.set("Online")}async function p7(t){t.N_.forEach((e,n)=>{zv(t,e)})}async function g7(t,e){RI(t),Vv(t)?(t.q_.M_(e),Bv(t)):t.q_.set("Unknown")}async function x7(t,e,n){if(t.q_.set("Online"),e instanceof gI&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const l of i.targetIds)s.N_.has(l)&&(await s.remoteSyncer.rejectListen(l,o),s.N_.delete(l),s.Q_.removeTarget(l))}(t,e)}catch(r){Y("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await _f(t,r)}else if(e instanceof Th?t.Q_.Ke(e):e instanceof pI?t.Q_.He(e):t.Q_.We(e),!n.isEqual(ve.min()))try{const r=await kI(t.localStore);n.compareTo(r)>=0&&await function(i,o){const l=i.Q_.rt(o);return l.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){const d=i.N_.get(u);d&&i.N_.set(u,d.withResumeToken(c.resumeToken,o))}}),l.targetMismatches.forEach((c,u)=>{const d=i.N_.get(c);if(!d)return;i.N_.set(c,d.withResumeToken(an.EMPTY_BYTE_STRING,d.snapshotVersion)),CI(i,c);const m=new Mi(d.target,c,u,d.sequenceNumber);zv(i,m)}),i.remoteSyncer.applyRemoteEvent(l)}(t,n)}catch(r){Y("RemoteStore","Failed to raise snapshot:",r),await _f(t,r)}}async function _f(t,e,n){if(!$u(e))throw e;t.L_.add(1),await Vu(t),t.q_.set("Offline"),n||(n=()=>kI(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Y("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await Mm(t)})}function NI(t,e){return e().catch(n=>_f(t,n,e))}async function Dm(t){const e=we(t),n=Zi(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;y7(e);)try{const s=await t7(e.localStore,r);if(s===null){e.O_.length===0&&n.o_();break}r=s.batchId,v7(e,s)}catch(s){await _f(e,s)}AI(e)&&PI(e)}function y7(t){return uo(t)&&t.O_.length<10}function v7(t,e){t.O_.push(e);const n=Zi(t);n.r_()&&n.V_&&n.m_(e.mutations)}function AI(t){return uo(t)&&!Zi(t).n_()&&t.O_.length>0}function PI(t){Zi(t).start()}async function w7(t){Zi(t).p_()}async function _7(t){const e=Zi(t);for(const n of t.O_)e.m_(n.mutations)}async function S7(t,e,n){const r=t.O_.shift(),s=Pv.from(r,e,n);await NI(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await Dm(t)}async function b7(t,e){e&&Zi(t).V_&&await async function(r,s){if(function(o){return d9(o)&&o!==$.ABORTED}(s.code)){const i=r.O_.shift();Zi(r).s_(),await NI(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await Dm(r)}}(t,e),AI(t)&&PI(t)}async function gb(t,e){const n=we(t);n.asyncQueue.verifyOperationInProgress(),Y("RemoteStore","RemoteStore received new credentials");const r=uo(n);n.L_.add(3),await Vu(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await Mm(n)}async function E7(t,e){const n=we(t);e?(n.L_.delete(2),await Mm(n)):e||(n.L_.add(2),await Vu(n),n.q_.set("Unknown"))}function Ll(t){return t.K_||(t.K_=function(n,r,s){const i=we(n);return i.w_(),new c7(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:m7.bind(null,t),Ro:p7.bind(null,t),mo:g7.bind(null,t),d_:x7.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),Vv(t)?Bv(t):t.q_.set("Unknown")):(await t.K_.stop(),RI(t))})),t.K_}function Zi(t){return t.U_||(t.U_=function(n,r,s){const i=we(n);return i.w_(),new u7(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:w7.bind(null,t),mo:b7.bind(null,t),f_:_7.bind(null,t),g_:S7.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await Dm(t)):(await t.U_.stop(),t.O_.length>0&&(Y("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uv{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new qs,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,l=new Uv(e,n,o,s,i);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new W($.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Hv(t,e){if(ri("AsyncQueue",`${e}: ${t}`),$u(t))return new W($.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class el{constructor(e){this.comparator=e?(n,r)=>e(n,r)||re.comparator(n.key,r.key):(n,r)=>re.comparator(n.key,r.key),this.keyedMap=bc(),this.sortedSet=new ct(this.comparator)}static emptySet(e){return new el(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof el)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new el;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xb{constructor(){this.W_=new ct(re.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):pe():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}}class vl{constructor(e,n,r,s,i,o,l,c,u){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(l=>{o.push({type:0,doc:l})}),new vl(e,n,el.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Im(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k7{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class j7{constructor(){this.queries=yb(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const s=we(n),i=s.queries;s.queries=yb(),i.forEach((o,l)=>{for(const c of l.j_)c.onError(r)})})(this,new W($.ABORTED,"Firestore shutting down"))}}function yb(){return new Dl(t=>eI(t),Im)}async function FI(t,e){const n=we(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.H_()&&e.J_()&&(r=2):(i=new k7,r=e.J_()?0:1);try{switch(r){case 0:i.z_=await n.onListen(s,!0);break;case 1:i.z_=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const l=Hv(o,`Initialization of query '${Co(e.query)}' failed`);return void e.onError(l)}n.queries.set(s,i),i.j_.push(e),e.Z_(n.onlineState),i.z_&&e.X_(i.z_)&&Gv(n)}async function MI(t,e){const n=we(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const o=i.j_.indexOf(e);o>=0&&(i.j_.splice(o,1),i.j_.length===0?s=e.J_()?0:1:!i.H_()&&e.J_()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function T7(t,e){const n=we(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const l of o.j_)l.X_(s)&&(r=!0);o.z_=s}}r&&Gv(n)}function I7(t,e,n){const r=we(t),s=r.queries.get(e);if(s)for(const i of s.j_)i.onError(n);r.queries.delete(e)}function Gv(t){t.Y_.forEach(e=>{e.next()})}var bx,vb;(vb=bx||(bx={})).ea="default",vb.Cache="cache";class DI{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new vl(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=vl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==bx.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LI{constructor(e){this.key=e}}class OI{constructor(e){this.key=e}}class C7{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Ie(),this.mutatedKeys=Ie(),this.Aa=tI(e),this.Ra=new el(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new xb,s=n?n.Ra:this.Ra;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,l=!1;const c=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,u=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((d,m)=>{const p=s.get(d),g=Cm(this.query,m)?m:null,x=!!p&&this.mutatedKeys.has(p.key),w=!!g&&(g.hasLocalMutations||this.mutatedKeys.has(g.key)&&g.hasCommittedMutations);let v=!1;p&&g?p.data.isEqual(g.data)?x!==w&&(r.track({type:3,doc:g}),v=!0):this.ga(p,g)||(r.track({type:2,doc:g}),v=!0,(c&&this.Aa(g,c)>0||u&&this.Aa(g,u)<0)&&(l=!0)):!p&&g?(r.track({type:0,doc:g}),v=!0):p&&!g&&(r.track({type:1,doc:p}),v=!0,(c||u)&&(l=!0)),v&&(g?(o=o.add(g),i=w?i.add(d):i.delete(d)):(o=o.delete(d),i=i.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),i=i.delete(d.key),r.track({type:1,doc:d})}return{Ra:o,fa:r,ns:l,mutatedKeys:i}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((d,m)=>function(g,x){const w=v=>{switch(v){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return pe()}};return w(g)-w(x)}(d.type,m.type)||this.Aa(d.doc,m.doc)),this.pa(r),s=s!=null&&s;const l=n&&!s?this.ya():[],c=this.da.size===0&&this.current&&!s?1:0,u=c!==this.Ea;return this.Ea=c,o.length!==0||u?{snapshot:new vl(this.query,e.Ra,i,o,e.mutatedKeys,c===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:l}:{wa:l}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new xb,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Ie(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new OI(r))}),this.da.forEach(r=>{e.has(r)||n.push(new LI(r))}),n}ba(e){this.Ta=e.Ts,this.da=Ie();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return vl.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class R7{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class N7{constructor(e){this.key=e,this.va=!1}}class A7{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new Dl(l=>eI(l),Im),this.Ma=new Map,this.xa=new Set,this.Oa=new ct(re.comparator),this.Na=new Map,this.La=new Dv,this.Ba={},this.ka=new Map,this.qa=yl.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function P7(t,e,n=!0){const r=HI(t);let s;const i=r.Fa.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.Da()):s=await $I(r,e,n,!0),s}async function F7(t,e){const n=HI(t);await $I(n,e,!0,!1)}async function $I(t,e,n,r){const s=await n7(t.localStore,ws(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let l;return r&&(l=await M7(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&II(t.remoteStore,s),l}async function M7(t,e,n,r,s){t.Ka=(m,p,g)=>async function(w,v,S,_){let E=v.view.ma(S);E.ns&&(E=await fb(w.localStore,v.query,!1).then(({documents:j})=>v.view.ma(j,E)));const I=_&&_.targetChanges.get(v.targetId),P=_&&_.targetMismatches.get(v.targetId)!=null,F=v.view.applyChanges(E,w.isPrimaryClient,I,P);return _b(w,v.targetId,F.wa),F.snapshot}(t,m,p,g);const i=await fb(t.localStore,e,!0),o=new C7(e,i.Ts),l=o.ma(i.documents),c=Bu.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),u=o.applyChanges(l,t.isPrimaryClient,c);_b(t,n,u.wa);const d=new R7(e,n,o);return t.Fa.set(e,d),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),u.snapshot}async function D7(t,e,n){const r=we(t),s=r.Fa.get(e),i=r.Ma.get(s.targetId);if(i.length>1)return r.Ma.set(s.targetId,i.filter(o=>!Im(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await Sx(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&$v(r.remoteStore,s.targetId),Ex(r,s.targetId)}).catch(Ou)):(Ex(r,s.targetId),await Sx(r.localStore,s.targetId,!0))}async function L7(t,e){const n=we(t),r=n.Fa.get(e),s=n.Ma.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),$v(n.remoteStore,r.targetId))}async function O7(t,e,n){const r=G7(t);try{const s=await function(o,l){const c=we(o),u=Tt.now(),d=l.reduce((g,x)=>g.add(x.key),Ie());let m,p;return c.persistence.runTransaction("Locally write mutations","readwrite",g=>{let x=si(),w=Ie();return c.cs.getEntries(g,d).next(v=>{x=v,x.forEach((S,_)=>{_.isValidDocument()||(w=w.add(S))})}).next(()=>c.localDocuments.getOverlayedDocuments(g,x)).next(v=>{m=v;const S=[];for(const _ of l){const E=a9(_,m.get(_.key).overlayedDocument);E!=null&&S.push(new la(_.key,E,qT(E.value.mapValue),Nn.exists(!0)))}return c.mutationQueue.addMutationBatch(g,u,S,l)}).next(v=>{p=v;const S=v.applyToLocalDocumentSet(m,w);return c.documentOverlayCache.saveOverlays(g,v.batchId,S)})}).then(()=>({batchId:p.batchId,changes:rI(m)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,l,c){let u=o.Ba[o.currentUser.toKey()];u||(u=new ct($e)),u=u.insert(l,c),o.Ba[o.currentUser.toKey()]=u}(r,s.batchId,n),await Uu(r,s.changes),await Dm(r.remoteStore)}catch(s){const i=Hv(s,"Failed to persist write");n.reject(i)}}async function zI(t,e){const n=we(t);try{const r=await Z9(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.Na.get(i);o&&(He(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.va=!0:s.modifiedDocuments.size>0?He(o.va):s.removedDocuments.size>0&&(He(o.va),o.va=!1))}),await Uu(n,r,e)}catch(r){await Ou(r)}}function wb(t,e,n){const r=we(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Fa.forEach((i,o)=>{const l=o.view.Z_(e);l.snapshot&&s.push(l.snapshot)}),function(o,l){const c=we(o);c.onlineState=l;let u=!1;c.queries.forEach((d,m)=>{for(const p of m.j_)p.Z_(l)&&(u=!0)}),u&&Gv(c)}(r.eventManager,e),s.length&&r.Ca.d_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function $7(t,e,n){const r=we(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Na.get(e),i=s&&s.key;if(i){let o=new ct(re.comparator);o=o.insert(i,xn.newNoDocument(i,ve.min()));const l=Ie().add(i),c=new Pm(ve.min(),new Map,new ct($e),o,l);await zI(r,c),r.Oa=r.Oa.remove(i),r.Na.delete(e),Wv(r)}else await Sx(r.localStore,e,!1).then(()=>Ex(r,e,n)).catch(Ou)}async function z7(t,e){const n=we(t),r=e.batch.batchId;try{const s=await J9(n.localStore,e);VI(n,r,null),BI(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Uu(n,s)}catch(s){await Ou(s)}}async function B7(t,e,n){const r=we(t);try{const s=await function(o,l){const c=we(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let d;return c.mutationQueue.lookupMutationBatch(u,l).next(m=>(He(m!==null),d=m.keys(),c.mutationQueue.removeMutationBatch(u,m))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,d,l)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,d)).next(()=>c.localDocuments.getDocuments(u,d))})}(r.localStore,e);VI(r,e,n),BI(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Uu(r,s)}catch(s){await Ou(s)}}function BI(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function VI(t,e,n){const r=we(t);let s=r.Ba[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Ba[r.currentUser.toKey()]=s}}function Ex(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||UI(t,r)})}function UI(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&($v(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),Wv(t))}function _b(t,e,n){for(const r of n)r instanceof LI?(t.La.addReference(r.key,e),V7(t,r)):r instanceof OI?(Y("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||UI(t,r.key)):pe()}function V7(t,e){const n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||(Y("SyncEngine","New document in limbo: "+n),t.xa.add(r),Wv(t))}function Wv(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new re(Qe.fromString(e)),r=t.qa.next();t.Na.set(r,new N7(n)),t.Oa=t.Oa.insert(n,r),II(t.remoteStore,new Mi(ws(Rv(n.path)),r,"TargetPurposeLimboResolution",kv.oe))}}async function Uu(t,e,n){const r=we(t),s=[],i=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((l,c)=>{o.push(r.Ka(c,e,n).then(u=>{var d;if((u||n)&&r.isPrimaryClient){const m=u?!u.fromCache:(d=n==null?void 0:n.targetChanges.get(c.targetId))===null||d===void 0?void 0:d.current;r.sharedClientState.updateQueryState(c.targetId,m?"current":"not-current")}if(u){s.push(u);const m=Ov.Wi(c.targetId,u);i.push(m)}}))}),await Promise.all(o),r.Ca.d_(s),await async function(c,u){const d=we(c);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>U.forEach(u,p=>U.forEach(p.$i,g=>d.persistence.referenceDelegate.addReference(m,p.targetId,g)).next(()=>U.forEach(p.Ui,g=>d.persistence.referenceDelegate.removeReference(m,p.targetId,g)))))}catch(m){if(!$u(m))throw m;Y("LocalStore","Failed to update sequence numbers: "+m)}for(const m of u){const p=m.targetId;if(!m.fromCache){const g=d.os.get(p),x=g.snapshotVersion,w=g.withLastLimboFreeSnapshotVersion(x);d.os=d.os.insert(p,w)}}}(r.localStore,i))}async function U7(t,e){const n=we(t);if(!n.currentUser.isEqual(e)){Y("SyncEngine","User change. New user:",e.toKey());const r=await EI(n.localStore,e);n.currentUser=e,function(i,o){i.ka.forEach(l=>{l.forEach(c=>{c.reject(new W($.CANCELLED,o))})}),i.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Uu(n,r.hs)}}function H7(t,e){const n=we(t),r=n.Na.get(e);if(r&&r.va)return Ie().add(r.key);{let s=Ie();const i=n.Ma.get(e);if(!i)return s;for(const o of i){const l=n.Fa.get(o);s=s.unionWith(l.view.Va)}return s}}function HI(t){const e=we(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=zI.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=H7.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=$7.bind(null,e),e.Ca.d_=T7.bind(null,e.eventManager),e.Ca.$a=I7.bind(null,e.eventManager),e}function G7(t){const e=we(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=z7.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=B7.bind(null,e),e}class Sf{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Fm(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return Y9(this.persistence,new Q9,e.initialUser,this.serializer)}Ga(e){return new W9(Lv.Zr,this.serializer)}Wa(e){return new s7}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Sf.provider={build:()=>new Sf};class kx{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>wb(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=U7.bind(null,this.syncEngine),await E7(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new j7}()}createDatastore(e){const n=Fm(e.databaseInfo.databaseId),r=function(i){return new l7(i)}(e.databaseInfo);return function(i,o,l,c){return new d7(i,o,l,c)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,l){return new f7(r,s,i,o,l)}(this.localStore,this.datastore,e.asyncQueue,n=>wb(this.syncEngine,n,0),function(){return pb.D()?new pb:new i7}())}createSyncEngine(e,n){return function(s,i,o,l,c,u,d){const m=new A7(s,i,o,l,c,u);return d&&(m.Qa=!0),m}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=we(s);Y("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await Vu(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}kx.provider={build:()=>new kx};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GI{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):ri("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W7{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=pn.UNAUTHENTICATED,this.clientId=HT.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{Y("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(Y("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new qs;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Hv(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function jg(t,e){t.asyncQueue.verifyOperationInProgress(),Y("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await EI(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Sb(t,e){t.asyncQueue.verifyOperationInProgress();const n=await q7(t);Y("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>gb(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>gb(e.remoteStore,s)),t._onlineComponents=e}async function q7(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Y("FirestoreClient","Using user provided OfflineComponentProvider");try{await jg(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===$.FAILED_PRECONDITION||s.code===$.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;fl("Error using user provided cache. Falling back to memory cache: "+n),await jg(t,new Sf)}}else Y("FirestoreClient","Using default OfflineComponentProvider"),await jg(t,new Sf);return t._offlineComponents}async function WI(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Y("FirestoreClient","Using user provided OnlineComponentProvider"),await Sb(t,t._uninitializedComponentsProvider._online)):(Y("FirestoreClient","Using default OnlineComponentProvider"),await Sb(t,new kx))),t._onlineComponents}function K7(t){return WI(t).then(e=>e.syncEngine)}async function qI(t){const e=await WI(t),n=e.eventManager;return n.onListen=P7.bind(null,e.syncEngine),n.onUnlisten=D7.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=F7.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=L7.bind(null,e.syncEngine),n}function Q7(t,e,n={}){const r=new qs;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,c,u){const d=new GI({next:p=>{d.Za(),o.enqueueAndForget(()=>MI(i,m));const g=p.docs.has(l);!g&&p.fromCache?u.reject(new W($.UNAVAILABLE,"Failed to get document because the client is offline.")):g&&p.fromCache&&c&&c.source==="server"?u.reject(new W($.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(p)},error:p=>u.reject(p)}),m=new DI(Rv(l.path),d,{includeMetadataChanges:!0,_a:!0});return FI(i,m)}(await qI(t),t.asyncQueue,e,n,r)),r.promise}function X7(t,e,n={}){const r=new qs;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,c,u){const d=new GI({next:p=>{d.Za(),o.enqueueAndForget(()=>MI(i,m)),p.fromCache&&c.source==="server"?u.reject(new W($.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(p)},error:p=>u.reject(p)}),m=new DI(l,d,{includeMetadataChanges:!0,_a:!0});return FI(i,m)}(await qI(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KI(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bb=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QI(t,e,n){if(!n)throw new W($.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function Y7(t,e,n,r){if(e===!0&&r===!0)throw new W($.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function Eb(t){if(!re.isDocumentKey(t))throw new W($.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function kb(t){if(re.isDocumentKey(t))throw new W($.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Lm(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":pe()}function Mr(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new W($.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Lm(t);throw new W($.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function J7(t,e){if(e<=0)throw new W($.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jb{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new W($.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new W($.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Y7("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=KI((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new W($.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new W($.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new W($.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Om{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new jb({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new W($.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new W($.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new jb(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new gO;switch(r.type){case"firstParty":return new wO(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new W($.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=bb.get(n);r&&(Y("ComponentProvider","Removing Datastore"),bb.delete(n),r.terminate())}(this),Promise.resolve()}}function Z7(t,e,n,r={}){var s;const i=(t=Mr(t,Om))._getSettings(),o=`${e}:${n}`;if(i.host!=="firestore.googleapis.com"&&i.host!==o&&fl("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},i),{host:o,ssl:!1})),r.mockUserToken){let l,c;if(typeof r.mockUserToken=="string")l=r.mockUserToken,c=pn.MOCK_USER;else{l=WL(r.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new W($.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new pn(u)}t._authCredentials=new xO(new UT(l,c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fi{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new fi(this.firestore,e,this._query)}}class An{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ki(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new An(this.firestore,e,this._key)}}class Ki extends fi{constructor(e,n,r){super(e,n,Rv(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new An(this.firestore,null,new re(e))}withConverter(e){return new Ki(this.firestore,e,this._path)}}function St(t,e,...n){if(t=Rt(t),QI("collection","path",e),t instanceof Om){const r=Qe.fromString(e,...n);return kb(r),new Ki(t,null,r)}{if(!(t instanceof An||t instanceof Ki))throw new W($.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Qe.fromString(e,...n));return kb(r),new Ki(t.firestore,null,r)}}function st(t,e,...n){if(t=Rt(t),arguments.length===1&&(e=HT.newId()),QI("doc","path",e),t instanceof Om){const r=Qe.fromString(e,...n);return Eb(r),new An(t,null,new re(r))}{if(!(t instanceof An||t instanceof Ki))throw new W($.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Qe.fromString(e,...n));return Eb(r),new An(t.firestore,t instanceof Ki?t.converter:null,new re(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tb{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new jI(this,"async_queue_retry"),this.Vu=()=>{const r=kg();r&&Y("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=kg();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=kg();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new qs;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!$u(e))throw e;Y("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const s=function(o){let l=o.message||"";return o.stack&&(l=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),l}(r);throw ri("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const s=Uv.createAndSchedule(this,e,n,r,i=>this.yu(i));return this.Tu.push(s),s}fu(){this.Eu&&pe()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}class ca extends Om{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new Tb,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Tb(e),this._firestoreClient=void 0,await e}}}function e$(t,e){const n=typeof t=="object"?t:FT(),r=typeof t=="string"?t:e||"(default)",s=bv(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=HL("firestore");i&&Z7(s,...i)}return s}function $m(t){if(t._terminated)throw new W($.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||t$(t),t._firestoreClient}function t$(t){var e,n,r;const s=t._freezeSettings(),i=function(l,c,u,d){return new PO(l,c,u,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,KI(d.experimentalLongPollingOptions),d.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((n=s.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new W7(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(l){const c=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(c),_online:c}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wl{constructor(e){this._byteString=e}static fromBase64String(e){try{return new wl(an.fromBase64String(e))}catch(n){throw new W($.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new wl(an.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ol{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new W($.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new tn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}function Lr(){return new Ol("__name__")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hu{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qv{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new W($.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new W($.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return $e(this._lat,e._lat)||$e(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kv{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n$=/^__.*__$/;class r${constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new la(e,this.data,this.fieldMask,n,this.fieldTransforms):new zu(e,this.data,n,this.fieldTransforms)}}class XI{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new la(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function YI(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw pe()}}class Qv{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new Qv(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.Ou(e),s}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return bf(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(YI(this.Cu)&&n$.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class s${constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Fm(e)}Qu(e,n,r,s=!1){return new Qv({Cu:e,methodName:n,qu:r,path:tn.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function $l(t){const e=t._freezeSettings(),n=Fm(t._databaseId);return new s$(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Xv(t,e,n,r,s,i={}){const o=t.Qu(i.merge||i.mergeFields?2:0,e,n,s);Zv("Data must be an object, but it was:",o,r);const l=tC(r,o);let c,u;if(i.merge)c=new dr(o.fieldMask),u=o.fieldTransforms;else if(i.mergeFields){const d=[];for(const m of i.mergeFields){const p=jx(e,m,n);if(!o.contains(p))throw new W($.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);rC(d,p)||d.push(p)}c=new dr(d),u=o.fieldTransforms.filter(m=>c.covers(m.field))}else c=null,u=o.fieldTransforms;return new r$(new qn(l),c,u)}class zm extends Hu{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof zm}}class Yv extends Hu{_toFieldTransform(e){return new dI(e.path,new fu)}isEqual(e){return e instanceof Yv}}class Jv extends Hu{constructor(e,n){super(e),this.$u=n}_toFieldTransform(e){const n=new gu(e.serializer,aI(e.serializer,this.$u));return new dI(e.path,n)}isEqual(e){return e instanceof Jv&&this.$u===e.$u}}function JI(t,e,n,r){const s=t.Qu(1,e,n);Zv("Data must be an object, but it was:",s,r);const i=[],o=qn.empty();lo(r,(c,u)=>{const d=ew(e,c,n);u=Rt(u);const m=s.Nu(d);if(u instanceof zm)i.push(d);else{const p=Gu(u,m);p!=null&&(i.push(d),o.set(d,p))}});const l=new dr(i);return new XI(o,l,s.fieldTransforms)}function ZI(t,e,n,r,s,i){const o=t.Qu(1,e,n),l=[jx(e,r,n)],c=[s];if(i.length%2!=0)throw new W($.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<i.length;p+=2)l.push(jx(e,i[p])),c.push(i[p+1]);const u=[],d=qn.empty();for(let p=l.length-1;p>=0;--p)if(!rC(u,l[p])){const g=l[p];let x=c[p];x=Rt(x);const w=o.Nu(g);if(x instanceof zm)u.push(g);else{const v=Gu(x,w);v!=null&&(u.push(g),d.set(g,v))}}const m=new dr(u);return new XI(d,m,o.fieldTransforms)}function eC(t,e,n,r=!1){return Gu(n,t.Qu(r?4:3,e))}function Gu(t,e){if(nC(t=Rt(t)))return Zv("Unsupported field value:",e,t),tC(t,e);if(t instanceof Hu)return function(r,s){if(!YI(s.Cu))throw s.Bu(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const l of r){let c=Gu(l,s.Lu(o));c==null&&(c={nullValue:"NULL_VALUE"}),i.push(c),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=Rt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return aI(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=Tt.fromDate(r);return{timestampValue:wf(s.serializer,i)}}if(r instanceof Tt){const i=new Tt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:wf(s.serializer,i)}}if(r instanceof qv)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof wl)return{bytesValue:xI(s.serializer,r._byteString)};if(r instanceof An){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Mv(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof Kv)return function(o,l){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw l.Bu("VectorValues must only contain numeric values.");return Av(l.serializer,c)})}}}}}}(r,s);throw s.Bu(`Unsupported field value: ${Lm(r)}`)}(t,e)}function tC(t,e){const n={};return GT(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):lo(t,(r,s)=>{const i=Gu(s,e.Mu(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function nC(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Tt||t instanceof qv||t instanceof wl||t instanceof An||t instanceof Hu||t instanceof Kv)}function Zv(t,e,n){if(!nC(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){const r=Lm(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function jx(t,e,n){if((e=Rt(e))instanceof Ol)return e._internalPath;if(typeof e=="string")return ew(t,e);throw bf("Field path arguments must be of type string or ",t,!1,void 0,n)}const i$=new RegExp("[~\\*/\\[\\]]");function ew(t,e,n){if(e.search(i$)>=0)throw bf(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Ol(...e.split("."))._internalPath}catch{throw bf(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function bf(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let l=`Function ${e}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let c="";return(i||o)&&(c+=" (found",i&&(c+=` in field ${r}`),o&&(c+=` in document ${s}`),c+=")"),new W($.INVALID_ARGUMENT,l+t+c)}function rC(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tw{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new An(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new a$(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Bm("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class a$ extends tw{data(){return super.data()}}function Bm(t,e){return typeof e=="string"?ew(t,e):e instanceof Ol?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o$(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new W($.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class nw{}class Vm extends nw{}function le(t,e,...n){let r=[];e instanceof nw&&r.push(e),r=r.concat(n),function(i){const o=i.filter(c=>c instanceof rw).length,l=i.filter(c=>c instanceof Um).length;if(o>1||o>0&&l>0)throw new W($.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class Um extends Vm{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Um(e,n,r)}_apply(e){const n=this._parse(e);return sC(e._query,n),new fi(e.firestore,e.converter,xx(e._query,n))}_parse(e){const n=$l(e.firestore);return function(i,o,l,c,u,d,m){let p;if(u.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new W($.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){Cb(m,d);const g=[];for(const x of m)g.push(Ib(c,i,x));p={arrayValue:{values:g}}}else p=Ib(c,i,m)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||Cb(m,d),p=eC(l,o,m,d==="in"||d==="not-in");return jt.create(u,d,p)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function Q(t,e,n){const r=e,s=Bm("where",t);return Um._create(s,r,n)}class rw extends nw{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new rw(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:ts.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let o=s;const l=i.getFlattenedFilters();for(const c of l)sC(o,c),o=xx(o,c)}(e._query,n),new fi(e.firestore,e.converter,xx(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class sw extends Vm{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new sw(e,n)}_apply(e){const n=function(s,i,o){if(s.startAt!==null)throw new W($.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new W($.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new hu(i,o)}(e._query,this._field,this._direction);return new fi(e.firestore,e.converter,function(s,i){const o=s.explicitOrderBy.concat([i]);return new co(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,n))}}function Lt(t,e="asc"){const n=e,r=Bm("orderBy",t);return sw._create(r,n)}class iw extends Vm{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new iw(e,n,r)}_apply(e){return new fi(e.firestore,e.converter,vf(e._query,this._limit,this._limitType))}}function Mt(t){return J7("limit",t),iw._create("limit",t,"F")}class aw extends Vm{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new aw(e,n,r)}_apply(e){const n=l$(e,this.type,this._docOrFields,this._inclusive);return new fi(e.firestore,e.converter,function(s,i){return new co(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,i,s.endAt)}(e._query,n))}}function Hm(...t){return aw._create("startAfter",t,!1)}function l$(t,e,n,r){if(n[0]=Rt(n[0]),n[0]instanceof tw)return function(i,o,l,c,u){if(!c)throw new W($.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${l}().`);const d=[];for(const m of Zo(i))if(m.field.isKeyField())d.push(yf(o,c.key));else{const p=c.data.field(m.field);if(Tm(p))throw new W($.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+m.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(p===null){const g=m.field.canonicalString();throw new W($.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${g}' (used as the orderBy) does not exist.`)}d.push(p)}return new xl(d,u)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{const s=$l(t.firestore);return function(o,l,c,u,d,m){const p=o.explicitOrderBy;if(d.length>p.length)throw new W($.INVALID_ARGUMENT,`Too many arguments provided to ${u}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const g=[];for(let x=0;x<d.length;x++){const w=d[x];if(p[x].field.isKeyField()){if(typeof w!="string")throw new W($.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${u}(), but got a ${typeof w}`);if(!Nv(o)&&w.indexOf("/")!==-1)throw new W($.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${u}() must be a plain document ID, but '${w}' contains a slash.`);const v=o.path.child(Qe.fromString(w));if(!re.isDocumentKey(v))throw new W($.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${u}() must result in a valid document path, but '${v}' is not because it contains an odd number of segments.`);const S=new re(v);g.push(yf(l,S))}else{const v=eC(c,u,w);g.push(v)}}return new xl(g,m)}(t._query,t.firestore._databaseId,s,e,n,r)}}function Ib(t,e,n){if(typeof(n=Rt(n))=="string"){if(n==="")throw new W($.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Nv(e)&&n.indexOf("/")!==-1)throw new W($.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Qe.fromString(n));if(!re.isDocumentKey(r))throw new W($.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return yf(t,new re(r))}if(n instanceof An)return yf(t,n._key);throw new W($.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Lm(n)}.`)}function Cb(t,e){if(!Array.isArray(t)||t.length===0)throw new W($.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function sC(t,e){const n=function(s,i){for(const o of s)for(const l of o.getFlattenedFilters())if(i.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new W($.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new W($.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class c${convertValue(e,n="none"){switch(Wa(e)){case 0:return null;case 1:return e.booleanValue;case 2:return xt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Ga(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw pe()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return lo(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var n,r,s;const i=(s=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(o=>xt(o.doubleValue));return new Kv(i)}convertGeoPoint(e){return new qv(xt(e.latitude),xt(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=jv(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(cu(e));default:return null}}convertTimestamp(e){const n=Ji(e);return new Tt(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Qe.fromString(e);He(bI(r));const s=new uu(r.get(1),r.get(3)),i=new re(r.popFirst(5));return s.isEqual(n)||ri(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ow(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kc{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class iC extends tw{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Ih(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Bm("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class Ih extends iC{data(e={}){return super.data(e)}}class u${constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new kc(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Ih(this._firestore,this._userDataWriter,r.key,r,new kc(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new W($.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(l=>{const c=new Ih(s._firestore,s._userDataWriter,l.doc.key,l.doc,new kc(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);return l.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(l=>i||l.type!==3).map(l=>{const c=new Ih(s._firestore,s._userDataWriter,l.doc.key,l.doc,new kc(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);let u=-1,d=-1;return l.type!==0&&(u=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),d=o.indexOf(l.doc.key)),{type:d$(l.type),doc:c,oldIndex:u,newIndex:d}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function d$(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return pe()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _l(t){t=Mr(t,An);const e=Mr(t.firestore,ca);return Q7($m(e),t._key).then(n=>p$(e,t,n))}class aC extends c${constructor(e){super(),this.firestore=e}convertBytes(e){return new wl(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new An(this.firestore,null,n)}}function bt(t){t=Mr(t,fi);const e=Mr(t.firestore,ca),n=$m(e),r=new aC(e);return o$(t._query),X7(n,t._query).then(s=>new u$(e,r,t,s))}function Tx(t,e,n){t=Mr(t,An);const r=Mr(t.firestore,ca),s=ow(t.converter,e,n);return Wu(r,[Xv($l(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,Nn.none())])}function h$(t,e,n,...r){t=Mr(t,An);const s=Mr(t.firestore,ca),i=$l(s);let o;return o=typeof(e=Rt(e))=="string"||e instanceof Ol?ZI(i,"updateDoc",t._key,e,n,r):JI(i,"updateDoc",t._key,e),Wu(s,[o.toMutation(t._key,Nn.exists(!0))])}function f$(t){return Wu(Mr(t.firestore,ca),[new Am(t._key,Nn.none())])}function m$(t,e){const n=Mr(t.firestore,ca),r=st(t),s=ow(t.converter,e);return Wu(n,[Xv($l(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,Nn.exists(!1))]).then(()=>r)}function Wu(t,e){return function(r,s){const i=new qs;return r.asyncQueue.enqueueAndForget(async()=>O7(await K7(r),s,i)),i.promise}($m(t),e)}function p$(t,e,n){const r=n.docs.get(e._key),s=new aC(t);return new iC(t,s,e._key,r,new kc(n.hasPendingWrites,n.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g${constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=$l(e)}set(e,n,r){this._verifyNotCommitted();const s=Tg(e,this._firestore),i=ow(s.converter,n,r),o=Xv(this._dataReader,"WriteBatch.set",s._key,i,s.converter!==null,r);return this._mutations.push(o.toMutation(s._key,Nn.none())),this}update(e,n,r,...s){this._verifyNotCommitted();const i=Tg(e,this._firestore);let o;return o=typeof(n=Rt(n))=="string"||n instanceof Ol?ZI(this._dataReader,"WriteBatch.update",i._key,n,r,s):JI(this._dataReader,"WriteBatch.update",i._key,n),this._mutations.push(o.toMutation(i._key,Nn.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=Tg(e,this._firestore);return this._mutations=this._mutations.concat(new Am(n._key,Nn.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new W($.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Tg(t,e){if((t=Rt(t)).firestore!==e)throw new W($.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}function mt(){return new Yv("serverTimestamp")}function Ks(t){return new Jv("increment",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mi(t){return $m(t=Mr(t,ca)),new g$(t,e=>Wu(t,e))}(function(e,n=!0){(function(s){Ml=s})(Fl),hl(new Ua("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),l=new ca(new yO(r.getProvider("auth-internal")),new SO(r.getProvider("app-check-internal")),function(u,d){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new W($.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new uu(u.options.projectId,d)}(o,s),o);return i=Object.assign({useFetchStreams:n},i),l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),qi(WS,"4.7.3",e),qi(WS,"4.7.3","esm2017")})();const oC="HD-MP3",bn=t=>(n=>n.toLocaleLowerCase().replace(/à|á|ạ|ả|ã|â|ầ|ấ|ậ|ẩ|ẫ|ă|ắ|ằ|ẳ|ẵ|ặ/g,"a").replace(/è|é|ẹ|ẻ|ẽ|ê|ề|ế|ệ|ể|ễ/g,"e").replace(/ì|í|ị|ỉ|ĩ/g,"i").replace(/ò|ó|ọ|ỏ|õ|ô|ồ|ố|ộ|ổ|ỗ|ơ|ớ|ờ|ở|ỡ|ợ/g,"o").replace(/ù|ú|ụ|ủ|ũ|ư|ừ|ứ|ự|ử|ữ/g,"u").replace(/ỳ|ý|ý|ỷ|ỹ/g,"y").replace(/đ/g,"d"))(t),qu=DL.create({baseURL:"https://express-zingmp3-production.up.railway.app/api"}),It=()=>JSON.parse(localStorage.getItem(oC)||"{}"),rt=(t,e)=>{const n=It();return n[t]=e,localStorage.setItem(oC,JSON.stringify(n))},ea=t=>{const e=Math.floor(t/60),n=Math.round(t%60);return`${e}:${n.toString().padStart(2,"0")}`},Jn=async t=>new Promise(e=>setTimeout(e,t)),lC=(t,e)=>{t.scrollIntoView({behavior:e||"smooth",block:"center"})},Ef=t=>t?"disable":"",ta=t=>t?"hidden":"",Qs=(t,e)=>t?e:"",x$=t=>{const e=new Date,n=new Date(e.getFullYear(),e.getMonth(),e.getDate(),...t);return Tt.fromDate(n)};let Ch=uf[0];const y$=It(),Rb=y$.theme;location.hash.includes("dashboard")?Ch=Ch:Rb&&[...uf,...Zj].forEach(t=>{t.id===Rb&&(Ch=t)});const v$=()=>{const[t,e]=h.useState(Ch);return{theme:t,setTheme:e,isOnMobile:window.innerWidth<768}},cC=h.createContext(null),w$=({children:t})=>a.jsx(cC.Provider,{value:v$(),children:t}),ss=()=>{const t=h.useContext(cC);if(!t)throw new Error("ThemeProvider not provided");return t},_$=()=>{const[t,e]=h.useState([]);return{toasts:t,setErrorToast:s=>e(i=>[...i,{variant:"error",id:Date.now()+"",desc:s||"Something went wrong"}]),setSuccessToast:s=>e(i=>[...i,{variant:"success",id:Date.now()+"",desc:s||"Successful"}]),setToasts:e}},uC=h.createContext(null);function S$({children:t}){return a.jsx(uC.Provider,{value:_$(),children:t})}const te=()=>{const t=h.useContext(uC);if(!t)throw new Error("Toast Context not provided");return t};function b$(){const[t,e]=h.useState(),[n,r]=h.useState(),[s,i]=h.useState([]),o=h.useRef(!0),l=h.useMemo(()=>{const u=[];return(t!=null&&t.category_ids?t.category_ids.split("_"):[]).forEach(m=>{const p=s.find(g=>g.id===m);p&&u.push(p)}),u},[t,s]),c=h.useMemo(()=>{const u=[];return(n!=null&&n.category_ids?n.category_ids.split("_"):[]).forEach(m=>{const p=s.find(g=>g.id===m);p&&u.push(p)}),u},[n,s]);return{categoryPage:t,setCategoryPage:e,homePage:n,setHomePage:r,categories:s,setCategories:i,categorySliders:l,homeSliders:c,shouldFetch:o}}const dC=h.createContext(null);function E$({children:t}){return a.jsx(dC.Provider,{value:b$(),children:t})}const Bn=()=>{const t=h.useContext(dC);if(!t)throw new Error("PageProvider is not provided");return t},k$=()=>{const[t,e]=h.useState([]),[n,r]=h.useState([]),s=h.useRef(!0);return{ahead:t,behind:n,setAhead:e,setBehind:r,shouldStoreLocation:s}},hC=h.createContext(null),fC=()=>{const t=h.useContext(hC);if(!t)throw new Error("Navigation context not provided");return t};function mC(){const{ahead:t,setAhead:e,setBehind:n,shouldStoreLocation:r}=fC(),s=Zn(),i=h.useMemo(()=>s.pathname+s.search,[s]),o=h.useRef(!1);return h.useEffect(()=>{if(!o.current){o.current=!0;return}return()=>{r.current?(t.length&&e([]),n(l=>[...l,i])):r.current=!0}},[s.pathname]),a.jsx(a.Fragment,{})}function pC({children:t}){return a.jsx(hC.Provider,{value:k$(),children:t})}function j$(){const[t,e]=h.useState([]),[n,r]=h.useState(!1);return{uploadingSongs:t,setUploadingSongs:e,isUploading:n,setIsUploading:r,resetUploadContext:()=>{r(!1),e([])}}}const gC=h.createContext(null),T$=({children:t})=>a.jsx(gC.Provider,{value:j$(),children:t}),xC=()=>{const t=h.useContext(gC);if(!t)throw new Error("UploadSongProvider not provided");return t},I$=["Songs","Karaoke","Lyric"],C$=["Playing","Lyric"],Eo=It();function R$(){const[t,e]=h.useState(!1),[n,r]=h.useState(!1),[s,i]=h.useState("Lyric"),[o,l]=h.useState("Lyric"),[c,u]=h.useState(!1),[d,m]=h.useState({lyricSize:Eo.lyricSize||"medium",repeat:Eo.isRepeat||"no",isShuffle:Eo.isShuffle||!1,isCrossFade:Eo.isCrossFade||!1,songBackground:Eo.songBackground||!0,songImage:Eo.songImage||!0,isEnableBeat:!1}),p=h.useRef(!0),g=h.useRef(0),x=h.useRef(!0),w=h.useRef(""),v=h.useRef(!1),S=h.useRef("var(--primary-cl)"),_=h.useRef(null),E=h.useRef(null),I=h.useRef(null);return{audioRef:_,themeCodeRef:w,isOpenFullScreen:t,isOpenSongQueue:n,idle:c,setIdle:u,setIsOpenFullScreen:e,setIsOpenSongQueue:r,activeTab:s,setActiveTab:i,desktopTabs:I$,mobileActiveTab:o,setMobileActiveTab:l,mobileTabs:C$,playerConfig:d,updatePlayerConfig:F=>{m(j=>({...j,...F}))},firstTimeSongLoaded:p,timelineEleRef:E,currentTimeEleRef:I,startFadeWhenEnd:g,isPlayingNewSong:x,shouldSyncSongDuration:v,timeLineColorRef:S}}const yC=h.createContext(null);function N$({children:t}){return a.jsx(yC.Provider,{value:R$(),children:t})}function ut(){const t=h.useContext(yC);if(!t)throw new Error("Player Context not provided");return t}const A$=()=>{const[t,e]=h.useState([]),[n,r]=h.useState(!1),s=h.useRef(!0);return{songLyrics:t,setSongLyrics:e,loading:n,setLoading:r,shouldGetLyric:s}},vC=h.createContext(null);function wC({children:t}){return a.jsx(vC.Provider,{value:A$(),children:t})}const lw=()=>{const t=h.useContext(vC);if(!t)throw new Error("Lyric context not found");return t},P$=()=>{const[t,e]=h.useState(!1),[n,r]=h.useState(!1),[s,i]=h.useState([]);return{isChecked:t,setIsChecked:e,isSelectAll:n,setIsSelectAll:r,setSelectedSongs:i,selectedSongs:s,selectAllSong:u=>{e(!0),r(!0),i(u)},selectSong:u=>{const d=[...s],m=d.findIndex(p=>p.id===u.id);m===-1?d.push(u):d.splice(m,1),e(!!d.length),i(d)},resetSelect:()=>{e(!1),r(!1),i([])}}},_C=h.createContext(null);function En({children:t}){return a.jsx(_C.Provider,{value:P$(),children:t})}const ho=()=>{const t=h.useContext(_C);if(!t)throw new Error("SelectSongContext not provided");return t};function Ig({onClick:t,theme:e,active:n}){return a.jsx(a.Fragment,{children:a.jsxs("div",{className:"w-[25%] px-2 mt-3 max-[549px]:w-[50%]",children:[a.jsx("div",{onClick:()=>t(e),className:`relative shadow-[0_0_6px_0_rgba(0,0,0,.15)] border-l-[20px] ${e.container} ${e.border}  pt-[100%] rounded-xl`,children:n&&a.jsx("div",{className:"absolute bottom-[10px] right-[10px]",children:a.jsx(uF,{className:"w-[25px]"})})}),a.jsx("p",{className:"text-base font-[500] mt-1",children:e.name})]})})}function SC({closeModal:t}){const{theme:e,setTheme:n}=ss(),r=c=>{rt("theme",c.id),n(c)},s={themeContainer:"overflow-auto flex-grow no-scrollbar space-y-5 pb-[5vh]",themeList:"flex flex-row -mx-2 -mt-3 flex-wrap"},i=uf.map(c=>{const u=c.id===e.id;if(c.type==="light")return a.jsx(Ig,{active:u,theme:c,onClick:r},c.id)}),o=uf.map(c=>{const u=c.id===e.id;if(c.type==="dark")return a.jsx(Ig,{active:u,theme:c,onClick:r},c.id)}),l=Zj.map(c=>{const u=c.id===e.id;return a.jsx(Ig,{active:u,theme:c,onClick:r},c.id)});return a.jsxs(_e,{className:"w-[900px]",children:[a.jsx(Be,{closeModal:t,title:"Themes"}),a.jsxs("div",{className:s.themeContainer,children:[a.jsxs("div",{children:[a.jsx(ee,{variant:"h2",className:"mb-3",title:"Specical"}),a.jsx("div",{className:s.themeList,children:l})]}),a.jsxs("div",{children:[a.jsx(ee,{variant:"h2",className:"mb-3",title:"Dark"}),a.jsx("div",{className:s.themeList,children:o})]}),a.jsxs("div",{children:[a.jsx(ee,{variant:"h2",className:"mb-3",title:"Light"}),a.jsx("div",{className:s.themeList,children:i})]})]})]})}function qt({loading:t,callback:e,label:n,children:r,closeModal:s,desc:i="This action cannot be undone"}){return a.jsxs(_e,{className:"w-[450px]",children:[a.jsx(Be,{closeModal:s,title:n||"Wait a minute"}),i&&a.jsx("p",{className:"font-semibold text-lg text-red-400",children:i}),a.jsx("div",{className:"flex space-x-3 mt-5",children:r||a.jsxs(a.Fragment,{children:[a.jsx(se,{onClick:s,disabled:t,className:"hover:bg-[--a-5-cl] rounded-full px-3 py-1",variant:"primary",size:"clear",children:"Close"}),a.jsx(se,{isLoading:t,color:"primary",className:"rounded-full px-3",variant:"primary",size:"clear",onClick:e,children:"Yes, Please"})]})})]})}const F$=[3,5,7,10];function bC({closeModal:t,active:e}){const n={button:"bg-[--a-5-cl] hover:bg-[--primary-cl] ml-2 mt-2 px-3  py-1 rounded-[99px]"},r=i=>{e(i),t()},s=F$.map(i=>a.jsxs("button",{type:"button",onClick:()=>r(i),className:`${n.button} `,children:[i," songs"]},i));return a.jsxs(_e,{children:[a.jsx(Be,{closeModal:t,title:"Sleep timer"}),a.jsx("div",{children:a.jsx("div",{className:"flex flex-wrap -mt-2 -ml-2 mb-3",children:s})})]})}function M$({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{fillRule:"evenodd",d:"M15.312 11.424a5.5 5.5 0 01-9.201 2.466l-.312-.311h2.433a.75.75 0 000-1.5H3.989a.75.75 0 00-.75.75v4.242a.75.75 0 001.5 0v-2.43l.31.31a7 7 0 0011.712-3.138.75.75 0 00-1.449-.39zm1.23-3.723a.75.75 0 00.219-.53V2.929a.75.75 0 00-1.5 0V5.36l-.31-.31A7 7 0 003.239 8.188a.75.75 0 101.448.389A5.5 5.5 0 0113.89 6.11l.311.31h-2.432a.75.75 0 000 1.5h4.243a.75.75 0 00.53-.219z",clipRule:"evenodd"}))}const D$=h.forwardRef(M$),EC=D$;function L$({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{fillRule:"evenodd",d:"M10 17a.75.75 0 01-.75-.75V5.612L5.29 9.77a.75.75 0 01-1.08-1.04l5.25-5.5a.75.75 0 011.08 0l5.25 5.5a.75.75 0 11-1.08 1.04l-3.96-4.158V16.25A.75.75 0 0110 17z",clipRule:"evenodd"}))}const O$=h.forwardRef(L$),$$=O$;function z$({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{fillRule:"evenodd",d:"M2 4.75A.75.75 0 012.75 4h14.5a.75.75 0 010 1.5H2.75A.75.75 0 012 4.75zM2 10a.75.75 0 01.75-.75h14.5a.75.75 0 010 1.5H2.75A.75.75 0 012 10zm0 5.25a.75.75 0 01.75-.75h14.5a.75.75 0 010 1.5H2.75a.75.75 0 01-.75-.75z",clipRule:"evenodd"}))}const B$=h.forwardRef(z$),V$=B$;function U$({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{fillRule:"evenodd",d:"M3.43 2.524A41.29 41.29 0 0110 2c2.236 0 4.43.18 6.57.524 1.437.231 2.43 1.49 2.43 2.902v5.148c0 1.413-.993 2.67-2.43 2.902a41.102 41.102 0 01-3.55.414c-.28.02-.521.18-.643.413l-1.712 3.293a.75.75 0 01-1.33 0l-1.713-3.293a.783.783 0 00-.642-.413 41.108 41.108 0 01-3.55-.414C1.993 13.245 1 11.986 1 10.574V5.426c0-1.413.993-2.67 2.43-2.902z",clipRule:"evenodd"}))}const H$=h.forwardRef(U$),G$=H$;function W$({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{fillRule:"evenodd",d:"M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.05-.143z",clipRule:"evenodd"}))}const q$=h.forwardRef(W$),Ku=q$;function K$({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{fillRule:"evenodd",d:"M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z",clipRule:"evenodd"}))}const Q$=h.forwardRef(K$),X$=Q$;function Y$({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm.75-13a.75.75 0 00-1.5 0v5c0 .414.336.75.75.75h4a.75.75 0 000-1.5h-3.25V5z",clipRule:"evenodd"}))}const J$=h.forwardRef(Y$),Z$=J$;function ez({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"}))}const tz=h.forwardRef(ez),kC=tz;function nz({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.536-4.464a.75.75 0 10-1.061-1.061 3.5 3.5 0 01-4.95 0 .75.75 0 00-1.06 1.06 5 5 0 007.07 0zM9 8.5c0 .828-.448 1.5-1 1.5s-1-.672-1-1.5S7.448 7 8 7s1 .672 1 1.5zm3 1.5c.552 0 1-.672 1-1.5S12.552 7 12 7s-1 .672-1 1.5.448 1.5 1 1.5z",clipRule:"evenodd"}))}const rz=h.forwardRef(nz),sz=rz;function iz({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{d:"M9.653 16.915l-.005-.003-.019-.01a20.759 20.759 0 01-1.162-.682 22.045 22.045 0 01-2.582-1.9C4.045 12.733 2 10.352 2 7.5a4.5 4.5 0 018-2.828A4.5 4.5 0 0118 7.5c0 2.852-2.044 5.233-3.885 6.82a22.049 22.049 0 01-3.744 2.582l-.019.01-.005.003h-.002a.739.739 0 01-.69.001l-.002-.001z"}))}const az=h.forwardRef(iz),zl=az;function oz({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{d:"M5.75 3a.75.75 0 00-.75.75v12.5c0 .414.336.75.75.75h1.5a.75.75 0 00.75-.75V3.75A.75.75 0 007.25 3h-1.5zM12.75 3a.75.75 0 00-.75.75v12.5c0 .414.336.75.75.75h1.5a.75.75 0 00.75-.75V3.75a.75.75 0 00-.75-.75h-1.5z"}))}const lz=h.forwardRef(oz),Qu=lz;function cz({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{d:"M5.433 13.917l1.262-3.155A4 4 0 017.58 9.42l6.92-6.918a2.121 2.121 0 013 3l-6.92 6.918c-.383.383-.84.685-1.343.886l-3.154 1.262a.5.5 0 01-.65-.65z"}),h.createElement("path",{d:"M3.5 5.75c0-.69.56-1.25 1.25-1.25H10A.75.75 0 0010 3H4.75A2.75 2.75 0 002 5.75v9.5A2.75 2.75 0 004.75 18h9.5A2.75 2.75 0 0017 15.25V10a.75.75 0 00-1.5 0v5.25c0 .69-.56 1.25-1.25 1.25h-9.5c-.69 0-1.25-.56-1.25-1.25v-9.5z"}))}const uz=h.forwardRef(cz),dz=uz;function hz({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{d:"M6.3 2.841A1.5 1.5 0 004 4.11V15.89a1.5 1.5 0 002.3 1.269l9.344-5.89a1.5 1.5 0 000-2.538L6.3 2.84z"}))}const fz=h.forwardRef(hz),qa=fz;function mz({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{d:"M10.75 4.75a.75.75 0 00-1.5 0v4.5h-4.5a.75.75 0 000 1.5h4.5v4.5a.75.75 0 001.5 0v-4.5h4.5a.75.75 0 000-1.5h-4.5v-4.5z"}))}const pz=h.forwardRef(mz),Es=pz;function gz({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{d:"M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"}))}const xz=h.forwardRef(gz),Xu=xz,yz=Ru("",{variants:{variant:{h1:"text-2xl font-bold",h2:"text-xl font-semibold",h3:"text-lg font-semibold"}},defaultVariants:{variant:"h1"}});function ee({title:t,variant:e,className:n=""}){return a.jsx("div",{className:`${yz({variant:e,className:n})} `,children:t})}function Be({closeModal:t,title:e}){return a.jsxs("div",{className:"flex justify-between items-center mb-3",children:[a.jsx(ee,{title:e}),a.jsx("button",{onClick:t,children:a.jsx(Xu,{className:"w-7"})})]})}const Nb=Ru("inline-flex relative hover:brightness-95 space-x-1 items-center z-0",{variants:{variant:{primary:"before:content-[''] before:absolute before:z-[-1] before:inset-0 active:translate-y-[2px] active:before:shadow-none",clear:"before:content-none"},color:{primary:"before:border-[#4a826f] text-[#fff] bg-[--primary-cl] before:shadow-[0_2px_0_#4a826f]",second:"before:border-[#ccc] text-[#333] bg-[#f6f6f6] before:shadow-[0_2px_0_#ccc]",clear:""},size:{primary:"px-5 py-1.5",clear:""},fontWeight:{primary:"",clear:""},border:{primary:"before:border-[2px]",thin:"before:border-[1px]",clear:"before:border-b-[2px]"},rounded:{xl:"before:rounded-xl rounded-xl",lg:"before:rounded-lg rounded-lg",md:"before:rounded-md rounded-md"}},defaultVariants:{variant:"primary",color:"primary",size:"primary",fontWeight:"primary",border:"primary",rounded:"lg"}});function vz({onClick:t,loading:e,children:n,border:r,size:s,color:i,fontWeight:o,type:l="button",variant:c,disabled:u,rounded:d,className:m,active:p,href:g},x){const w=u||e,v="before:shadow-none translate-y-[2px]";return a.jsx(a.Fragment,{children:g?a.jsx(X,{to:g,className:`${Nb({variant:c,size:s,color:i,fontWeight:o,rounded:d,border:r,className:m})} ${p?v:""}`,children:n}):a.jsx("button",{ref:x,type:l||"button",onClick:t,disabled:w,className:`${Nb({variant:c,size:s,color:p?"primary":i,border:r,fontWeight:o,className:m})} ${p?v:""}`,children:e?a.jsx(Ae,{className:"w-6 animate-spin"}):n})})}const q=h.forwardRef(vz),wz=Ru("border-2 border-b-[6px] rounded-xl",{variants:{p:{3:"p-3",clear:""}},defaultVariants:{p:"3"}});function Ot({children:t,onClick:e,p:n,className:r=""}){return a.jsx("div",{onClick:()=>e?e():{},className:`${wz({p:n,className:r})} `,children:t})}function Vn({className:t=""}){return a.jsx("div",{className:`flex flex-grow items-center justify-center ${t}`,children:a.jsx(Ae,{className:"w-6 animate-spin"})})}function ks({children:t,margin:e=!0,className:n=""}){const r=`${e?"mt-2 ml-2":""} font-medium flex px-3 py-1.5 text-sm rounded-lg bg-[#fff] border-[2px] border-[#e1e1e1] [&>div]:ml-1.5 [&>div]:pl-1.5 [&>div]:border [&>div]:border-transparent [&>div]:flex [&>div]:space-x-1 [&>div]:border-l-black/10 hover:[&_button]:scale-[1.05] ${n}`;return a.jsx("div",{className:r,children:t})}function _z({children:t,...e},n){return a.jsx(ce,{variant:"animation",...e,ref:n,children:t})}const cw=h.forwardRef(_z);function Bl({children:t,className:e=""}){return a.jsx("div",{className:`-ml-2 -mt-2 flex flex-wrap [&_button]:mt-2 [&_button]:ml-2 [&_button:not(.except)]:p-1.5 [&_svg]:w-5 [&_svg]:flex-shrink-0 md:[&_button:not(.except)]:px-3 ${e} `,children:t})}var Sz="firebase",bz="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */qi(Sz,bz,"app");function uw(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function jC(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Ez=jC,TC=new Du("auth","Firebase",jC());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kf=new _v("@firebase/auth");function kz(t,...e){kf.logLevel<=Pe.WARN&&kf.warn(`Auth (${Fl}): ${t}`,...e)}function Rh(t,...e){kf.logLevel<=Pe.ERROR&&kf.error(`Auth (${Fl}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function js(t,...e){throw hw(t,...e)}function Zr(t,...e){return hw(t,...e)}function dw(t,e,n){const r=Object.assign(Object.assign({},Ez()),{[e]:n});return new Du("auth","Firebase",r).create(e,{appName:t.name})}function Da(t){return dw(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function jz(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&js(t,"argument-error"),dw(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function hw(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return TC.create(t,...e)}function me(t,e,...n){if(!t)throw hw(e,...n)}function Vs(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Rh(e),new Error(e)}function ii(t,e){t||Vs(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ix(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function Tz(){return Ab()==="http:"||Ab()==="https:"}function Ab(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Iz(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Tz()||XL()||"connection"in navigator)?navigator.onLine:!0}function Cz(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yu{constructor(e,n){this.shortDelay=e,this.longDelay=n,ii(n>e,"Short delay should be less than long delay!"),this.isMobile=qL()||YL()}get(){return Iz()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fw(t,e){ii(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IC{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Vs("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Vs("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Vs("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rz={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nz=new Yu(3e4,6e4);function mw(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Vl(t,e,n,r,s={}){return CC(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const l=Lu(Object.assign({key:t.config.apiKey},o)).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const u=Object.assign({method:e,headers:c},i);return QL()||(u.referrerPolicy="no-referrer"),IC.fetch()(RC(t,t.config.apiHost,n,l),u)})}async function CC(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},Rz),e);try{const s=new Pz(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw Kd(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const l=i.ok?o.errorMessage:o.error.message,[c,u]=l.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Kd(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw Kd(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw Kd(t,"user-disabled",o);const d=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw dw(t,d,u);js(t,d)}}catch(s){if(s instanceof hi)throw s;js(t,"network-request-failed",{message:String(s)})}}async function Az(t,e,n,r,s={}){const i=await Vl(t,e,n,r,s);return"mfaPendingCredential"in i&&js(t,"multi-factor-auth-required",{_serverResponse:i}),i}function RC(t,e,n,r){const s=`${e}${n}?${r}`;return t.config.emulator?fw(t.config,s):`${t.config.apiScheme}://${s}`}class Pz{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Zr(this.auth,"network-request-failed")),Nz.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Kd(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=Zr(t,e,r);return s.customData._tokenResponse=n,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Fz(t,e){return Vl(t,"POST","/v1/accounts:delete",e)}async function NC(t,e){return Vl(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zc(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Mz(t,e=!1){const n=Rt(t),r=await n.getIdToken(e),s=pw(r);me(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:zc(Cg(s.auth_time)),issuedAtTime:zc(Cg(s.iat)),expirationTime:zc(Cg(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Cg(t){return Number(t)*1e3}function pw(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Rh("JWT malformed, contained fewer than 3 sections"),null;try{const s=TT(n);return s?JSON.parse(s):(Rh("Failed to decode base64 JWT payload"),null)}catch(s){return Rh("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function Pb(t){const e=pw(t);return me(e,"internal-error"),me(typeof e.exp<"u","internal-error"),me(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xu(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof hi&&Dz(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function Dz({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lz{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cx{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=zc(this.lastLoginAt),this.creationTime=zc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jf(t){var e;const n=t.auth,r=await t.getIdToken(),s=await xu(t,NC(n,{idToken:r}));me(s==null?void 0:s.users.length,n,"internal-error");const i=s.users[0];t._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?AC(i.providerUserInfo):[],l=$z(t.providerData,o),c=t.isAnonymous,u=!(t.email&&i.passwordHash)&&!(l!=null&&l.length),d=c?u:!1,m={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:l,metadata:new Cx(i.createdAt,i.lastLoginAt),isAnonymous:d};Object.assign(t,m)}async function Oz(t){const e=Rt(t);await jf(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function $z(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function AC(t){return t.map(e=>{var{providerId:n}=e,r=uw(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zz(t,e){const n=await CC(t,{},async()=>{const r=Lu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=RC(t,s,"/v1/token",`key=${i}`),l=await t._getAdditionalHeaders();return l["Content-Type"]="application/x-www-form-urlencoded",IC.fetch()(o,{method:"POST",headers:l,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function Bz(t,e){return Vl(t,"POST","/v2/accounts:revokeToken",mw(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){me(e.idToken,"internal-error"),me(typeof e.idToken<"u","internal-error"),me(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Pb(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){me(e.length!==0,"internal-error");const n=Pb(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(me(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await zz(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new tl;return r&&(me(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(me(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(me(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new tl,this.toJSON())}_performRefresh(){return Vs("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Si(t,e){me(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Us{constructor(e){var{uid:n,auth:r,stsTokenManager:s}=e,i=uw(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Lz(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Cx(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await xu(this,this.stsTokenManager.getToken(this.auth,e));return me(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return Mz(this,e)}reload(){return Oz(this)}_assign(e){this!==e&&(me(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Us(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){me(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await jf(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Bs(this.auth.app))return Promise.reject(Da(this.auth));const e=await this.getIdToken();return await xu(this,Fz(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,s,i,o,l,c,u,d;const m=(r=n.displayName)!==null&&r!==void 0?r:void 0,p=(s=n.email)!==null&&s!==void 0?s:void 0,g=(i=n.phoneNumber)!==null&&i!==void 0?i:void 0,x=(o=n.photoURL)!==null&&o!==void 0?o:void 0,w=(l=n.tenantId)!==null&&l!==void 0?l:void 0,v=(c=n._redirectEventId)!==null&&c!==void 0?c:void 0,S=(u=n.createdAt)!==null&&u!==void 0?u:void 0,_=(d=n.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:E,emailVerified:I,isAnonymous:P,providerData:F,stsTokenManager:j}=n;me(E&&j,e,"internal-error");const k=tl.fromJSON(this.name,j);me(typeof E=="string",e,"internal-error"),Si(m,e.name),Si(p,e.name),me(typeof I=="boolean",e,"internal-error"),me(typeof P=="boolean",e,"internal-error"),Si(g,e.name),Si(x,e.name),Si(w,e.name),Si(v,e.name),Si(S,e.name),Si(_,e.name);const C=new Us({uid:E,auth:e,email:p,emailVerified:I,displayName:m,isAnonymous:P,photoURL:x,phoneNumber:g,tenantId:w,stsTokenManager:k,createdAt:S,lastLoginAt:_});return F&&Array.isArray(F)&&(C.providerData=F.map(R=>Object.assign({},R))),v&&(C._redirectEventId=v),C}static async _fromIdTokenResponse(e,n,r=!1){const s=new tl;s.updateFromServerResponse(n);const i=new Us({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await jf(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];me(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?AC(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),l=new tl;l.updateFromIdToken(r);const c=new Us({uid:s.localId,auth:e,stsTokenManager:l,isAnonymous:o}),u={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new Cx(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(c,u),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fb=new Map;function Hs(t){ii(t instanceof Function,"Expected a class definition");let e=Fb.get(t);return e?(ii(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Fb.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PC{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}PC.type="NONE";const Mb=PC;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nh(t,e,n){return`firebase:${t}:${e}:${n}`}class nl{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=Nh(this.userKey,s.apiKey,i),this.fullPersistenceKey=Nh("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Us._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new nl(Hs(Mb),e,r);const s=(await Promise.all(n.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let i=s[0]||Hs(Mb);const o=Nh(r,e.config.apiKey,e.name);let l=null;for(const u of n)try{const d=await u._get(o);if(d){const m=Us._fromJSON(e,d);u!==i&&(l=m),i=u;break}}catch{}const c=s.filter(u=>u._shouldAllowMigration);return!i._shouldAllowMigration||!c.length?new nl(i,e,r):(i=c[0],l&&await i._set(o,l.toJSON()),await Promise.all(n.map(async u=>{if(u!==i)try{await u._remove(o)}catch{}})),new nl(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Db(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(LC(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(FC(e))return"Firefox";if(e.includes("silk/"))return"Silk";if($C(e))return"Blackberry";if(zC(e))return"Webos";if(MC(e))return"Safari";if((e.includes("chrome/")||DC(e))&&!e.includes("edge/"))return"Chrome";if(OC(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function FC(t=Sn()){return/firefox\//i.test(t)}function MC(t=Sn()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function DC(t=Sn()){return/crios\//i.test(t)}function LC(t=Sn()){return/iemobile/i.test(t)}function OC(t=Sn()){return/android/i.test(t)}function $C(t=Sn()){return/blackberry/i.test(t)}function zC(t=Sn()){return/webos/i.test(t)}function gw(t=Sn()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function Vz(t=Sn()){var e;return gw(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function Uz(){return JL()&&document.documentMode===10}function BC(t=Sn()){return gw(t)||OC(t)||zC(t)||$C(t)||/windows phone/i.test(t)||LC(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VC(t,e=[]){let n;switch(t){case"Browser":n=Db(Sn());break;case"Worker":n=`${Db(Sn())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Fl}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hz{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,l)=>{try{const c=e(i);o(c)}catch(c){l(c)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Gz(t,e={}){return Vl(t,"GET","/v2/passwordPolicy",mw(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wz=6;class qz{constructor(e){var n,r,s,i;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:Wz,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,s,i,o,l;const c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(n=c.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),c.isValid&&(c.isValid=(r=c.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(s=c.containsLowercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(i=c.containsUppercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(l=c.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),c}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kz{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Lb(this),this.idTokenSubscription=new Lb(this),this.beforeStateQueue=new Hz(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=TC,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Hs(n)),this._initializationPromise=this.queue(async()=>{var r,s;if(!this._deleted&&(this.persistenceManager=await nl.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await NC(this,{idToken:e}),r=await Us._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(Bs(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let s=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,l=s==null?void 0:s._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===l)&&(c!=null&&c.user)&&(s=c.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return me(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await jf(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Cz()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Bs(this.app))return Promise.reject(Da(this));const n=e?Rt(e):null;return n&&me(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&me(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Bs(this.app)?Promise.reject(Da(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Bs(this.app)?Promise.reject(Da(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Hs(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Gz(this),n=new qz(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Du("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await Bz(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Hs(e)||this._popupRedirectResolver;me(n,this,"argument-error"),this.redirectPersistenceManager=await nl.create(this,[Hs(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(me(l,this,"internal-error"),l.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const c=e.addObserver(n,r,s);return()=>{o=!0,c()}}else{const c=e.addObserver(n);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return me(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=VC(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(n["X-Firebase-AppCheck"]=s),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&kz(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function Gm(t){return Rt(t)}class Lb{constructor(e){this.auth=e,this.observer=null,this.addObserver=a6(n=>this.observer=n)}get next(){return me(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let xw={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Qz(t){xw=t}function Xz(t){return xw.loadJS(t)}function Yz(){return xw.gapiScript}function Jz(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zz(t,e){const n=bv(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(pf(i,e??{}))return s;js(s,"already-initialized")}return n.initialize({options:e})}function eB(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Hs);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function tB(t,e,n){const r=Gm(t);me(r._canInitEmulator,r,"emulator-config-failed"),me(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!!(n!=null&&n.disableWarnings),i=UC(e),{host:o,port:l}=nB(e),c=l===null?"":`:${l}`;r.config.emulator={url:`${i}//${o}${c}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:l,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),s||rB()}function UC(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function nB(t){const e=UC(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:Ob(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:Ob(o)}}}function Ob(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function rB(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HC{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Vs("not implemented")}_getIdTokenResponse(e){return Vs("not implemented")}_linkToIdToken(e,n){return Vs("not implemented")}_getReauthenticationResolver(e){return Vs("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rl(t,e){return Az(t,"POST","/v1/accounts:signInWithIdp",mw(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sB="http://localhost";class Ka extends HC{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Ka(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):js("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=n,i=uw(n,["providerId","signInMethod"]);if(!r||!s)return null;const o=new Ka(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return rl(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,rl(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,rl(e,n)}buildRequest(){const e={requestUri:sB,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Lu(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yw{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ju extends yw{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ii extends Ju{constructor(){super("facebook.com")}static credential(e){return Ka._fromParams({providerId:Ii.PROVIDER_ID,signInMethod:Ii.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ii.credentialFromTaggedObject(e)}static credentialFromError(e){return Ii.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ii.credential(e.oauthAccessToken)}catch{return null}}}Ii.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ii.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Os extends Ju{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Ka._fromParams({providerId:Os.PROVIDER_ID,signInMethod:Os.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Os.credentialFromTaggedObject(e)}static credentialFromError(e){return Os.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Os.credential(n,r)}catch{return null}}}Os.GOOGLE_SIGN_IN_METHOD="google.com";Os.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ci extends Ju{constructor(){super("github.com")}static credential(e){return Ka._fromParams({providerId:Ci.PROVIDER_ID,signInMethod:Ci.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ci.credentialFromTaggedObject(e)}static credentialFromError(e){return Ci.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ci.credential(e.oauthAccessToken)}catch{return null}}}Ci.GITHUB_SIGN_IN_METHOD="github.com";Ci.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ri extends Ju{constructor(){super("twitter.com")}static credential(e,n){return Ka._fromParams({providerId:Ri.PROVIDER_ID,signInMethod:Ri.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Ri.credentialFromTaggedObject(e)}static credentialFromError(e){return Ri.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Ri.credential(n,r)}catch{return null}}}Ri.TWITTER_SIGN_IN_METHOD="twitter.com";Ri.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sl{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await Us._fromIdTokenResponse(e,r,s),o=$b(r);return new Sl({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=$b(r);return new Sl({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function $b(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tf extends hi{constructor(e,n,r,s){var i;super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,Tf.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new Tf(e,n,r,s)}}function GC(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Tf._fromErrorAndOperation(t,i,e,r):i})}async function iB(t,e,n=!1){const r=await xu(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Sl._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aB(t,e,n=!1){const{auth:r}=t;if(Bs(r.app))return Promise.reject(Da(r));const s="reauthenticate";try{const i=await xu(t,GC(r,s,e,t),n);me(i.idToken,r,"internal-error");const o=pw(i.idToken);me(o,r,"internal-error");const{sub:l}=o;return me(t.uid===l,r,"user-mismatch"),Sl._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&js(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oB(t,e,n=!1){if(Bs(t.app))return Promise.reject(Da(t));const r="signIn",s=await GC(t,r,e),i=await Sl._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}function lB(t,e,n,r){return Rt(t).onIdTokenChanged(e,n,r)}function cB(t,e,n){return Rt(t).beforeAuthStateChanged(e,n)}function uB(t,e,n,r){return Rt(t).onAuthStateChanged(e,n,r)}function WC(t){return Rt(t).signOut()}const If="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qC{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(If,"1"),this.storage.removeItem(If),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dB=1e3,hB=10;class KC extends qC{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=BC(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,l,c)=>{this.notifyListeners(o,c)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);Uz()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,hB):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},dB)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}KC.type="LOCAL";const fB=KC;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QC extends qC{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}QC.type="SESSION";const XC=QC;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mB(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wm{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new Wm(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const l=Array.from(o).map(async u=>u(n.origin,i)),c=await mB(l);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:c})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Wm.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vw(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pB{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((l,c)=>{const u=vw("",20);s.port1.start();const d=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(m){const p=m;if(p.data.eventId===u)switch(p.data.status){case"ack":clearTimeout(d),i=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),l(p.data.response);break;default:clearTimeout(d),clearTimeout(i),c(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ss(){return window}function gB(t){Ss().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YC(){return typeof Ss().WorkerGlobalScope<"u"&&typeof Ss().importScripts=="function"}async function xB(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function yB(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function vB(){return YC()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JC="firebaseLocalStorageDb",wB=1,Cf="firebaseLocalStorage",ZC="fbase_key";class Zu{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function qm(t,e){return t.transaction([Cf],e?"readwrite":"readonly").objectStore(Cf)}function _B(){const t=indexedDB.deleteDatabase(JC);return new Zu(t).toPromise()}function Rx(){const t=indexedDB.open(JC,wB);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Cf,{keyPath:ZC})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Cf)?e(r):(r.close(),await _B(),e(await Rx()))})})}async function zb(t,e,n){const r=qm(t,!0).put({[ZC]:e,value:n});return new Zu(r).toPromise()}async function SB(t,e){const n=qm(t,!1).get(e),r=await new Zu(n).toPromise();return r===void 0?null:r.value}function Bb(t,e){const n=qm(t,!0).delete(e);return new Zu(n).toPromise()}const bB=800,EB=3;class eR{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Rx(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>EB)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return YC()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Wm._getInstance(vB()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await xB(),!this.activeServiceWorker)return;this.sender=new pB(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||yB()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Rx();return await zb(e,If,"1"),await Bb(e,If),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>zb(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>SB(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>Bb(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=qm(s,!1).getAll();return new Zu(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),bB)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}eR.type="LOCAL";const kB=eR;new Yu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tR(t,e){return e?Hs(e):(me(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ww extends HC{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return rl(e,this._buildIdpRequest())}_linkToIdToken(e,n){return rl(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return rl(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function jB(t){return oB(t.auth,new ww(t),t.bypassAuthState)}function TB(t){const{auth:e,user:n}=t;return me(n,e,"internal-error"),aB(n,new ww(t),t.bypassAuthState)}async function IB(t){const{auth:e,user:n}=t;return me(n,e,"internal-error"),iB(n,new ww(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nR{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:l}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(c))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return jB;case"linkViaPopup":case"linkViaRedirect":return IB;case"reauthViaPopup":case"reauthViaRedirect":return TB;default:js(this.auth,"internal-error")}}resolve(e){ii(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ii(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CB=new Yu(2e3,1e4);async function RB(t,e,n){if(Bs(t.app))return Promise.reject(Zr(t,"operation-not-supported-in-this-environment"));const r=Gm(t);jz(t,e,yw);const s=tR(r,n);return new Aa(r,"signInViaPopup",e,s).executeNotNull()}class Aa extends nR{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,Aa.currentPopupAction&&Aa.currentPopupAction.cancel(),Aa.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return me(e,this.auth,"internal-error"),e}async onExecution(){ii(this.filter.length===1,"Popup operations only handle one event");const e=vw();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Zr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Zr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Aa.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Zr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,CB.get())};e()}}Aa.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NB="pendingRedirect",Ah=new Map;class AB extends nR{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Ah.get(this.auth._key());if(!e){try{const r=await PB(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Ah.set(this.auth._key(),e)}return this.bypassAuthState||Ah.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function PB(t,e){const n=DB(e),r=MB(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function FB(t,e){Ah.set(t._key(),e)}function MB(t){return Hs(t._redirectPersistence)}function DB(t){return Nh(NB,t.config.apiKey,t.name)}async function LB(t,e,n=!1){if(Bs(t.app))return Promise.reject(Da(t));const r=Gm(t),s=tR(r,e),o=await new AB(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OB=10*60*1e3;class $B{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!zB(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!rR(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(Zr(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=OB&&this.cachedEventUids.clear(),this.cachedEventUids.has(Vb(e))}saveEventToCache(e){this.cachedEventUids.add(Vb(e)),this.lastProcessedEventTime=Date.now()}}function Vb(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function rR({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function zB(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return rR(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function BB(t,e={}){return Vl(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VB=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,UB=/^https?/;async function HB(t){if(t.config.emulator)return;const{authorizedDomains:e}=await BB(t);for(const n of e)try{if(GB(n))return}catch{}js(t,"unauthorized-domain")}function GB(t){const e=Ix(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!UB.test(n))return!1;if(VB.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WB=new Yu(3e4,6e4);function Ub(){const t=Ss().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function qB(t){return new Promise((e,n)=>{var r,s,i;function o(){Ub(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Ub(),n(Zr(t,"network-request-failed"))},timeout:WB.get()})}if(!((s=(r=Ss().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=Ss().gapi)===null||i===void 0)&&i.load)o();else{const l=Jz("iframefcb");return Ss()[l]=()=>{gapi.load?o():n(Zr(t,"network-request-failed"))},Xz(`${Yz()}?onload=${l}`).catch(c=>n(c))}}).catch(e=>{throw Ph=null,e})}let Ph=null;function KB(t){return Ph=Ph||qB(t),Ph}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QB=new Yu(5e3,15e3),XB="__/auth/iframe",YB="emulator/auth/iframe",JB={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},ZB=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function e8(t){const e=t.config;me(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?fw(e,YB):`https://${t.config.authDomain}/${XB}`,r={apiKey:e.apiKey,appName:t.name,v:Fl},s=ZB.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${Lu(r).slice(1)}`}async function t8(t){const e=await KB(t),n=Ss().gapi;return me(n,t,"internal-error"),e.open({where:document.body,url:e8(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:JB,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=Zr(t,"network-request-failed"),l=Ss().setTimeout(()=>{i(o)},QB.get());function c(){Ss().clearTimeout(l),s(r)}r.ping(c).then(c,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n8={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},r8=500,s8=600,i8="_blank",a8="http://localhost";class Hb{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function o8(t,e,n,r=r8,s=s8){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const c=Object.assign(Object.assign({},n8),{width:r.toString(),height:s.toString(),top:i,left:o}),u=Sn().toLowerCase();n&&(l=DC(u)?i8:n),FC(u)&&(e=e||a8,c.scrollbars="yes");const d=Object.entries(c).reduce((p,[g,x])=>`${p}${g}=${x},`,"");if(Vz(u)&&l!=="_self")return l8(e||"",l),new Hb(null);const m=window.open(e||"",l,d);me(m,t,"popup-blocked");try{m.focus()}catch{}return new Hb(m)}function l8(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c8="__/auth/handler",u8="emulator/auth/handler",d8=encodeURIComponent("fac");async function Gb(t,e,n,r,s,i){me(t.config.authDomain,t,"auth-domain-config-required"),me(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Fl,eventId:s};if(e instanceof yw){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",i6(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,m]of Object.entries(i||{}))o[d]=m}if(e instanceof Ju){const d=e.getScopes().filter(m=>m!=="");d.length>0&&(o.scopes=d.join(","))}t.tenantId&&(o.tid=t.tenantId);const l=o;for(const d of Object.keys(l))l[d]===void 0&&delete l[d];const c=await t._getAppCheckToken(),u=c?`#${d8}=${encodeURIComponent(c)}`:"";return`${h8(t)}?${Lu(l).slice(1)}${u}`}function h8({config:t}){return t.emulator?fw(t,u8):`https://${t.authDomain}/${c8}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rg="webStorageSupport";class f8{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=XC,this._completeRedirectFn=LB,this._overrideRedirectResult=FB}async _openPopup(e,n,r,s){var i;ii((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=await Gb(e,n,r,Ix(),s);return o8(e,o,vw())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await Gb(e,n,r,Ix(),s);return gB(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(ii(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await t8(e),r=new $B(e);return n.register("authEvent",s=>(me(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Rg,{type:Rg},s=>{var i;const o=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[Rg];o!==void 0&&n(!!o),js(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=HB(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return BC()||MC()||gw()}}const m8=f8;var Wb="@firebase/auth",qb="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p8{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){me(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g8(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function x8(t){hl(new Ua("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=r.options;me(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const c={apiKey:o,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:VC(t)},u=new Kz(r,s,i,c);return eB(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),hl(new Ua("auth-internal",e=>{const n=Gm(e.getProvider("auth").getImmediate());return(r=>new p8(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),qi(Wb,qb,g8(t)),qi(Wb,qb,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y8=5*60,v8=RT("authIdTokenMaxAge")||y8;let Kb=null;const w8=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>v8)return;const s=n==null?void 0:n.token;Kb!==s&&(Kb=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function _8(t=FT()){const e=bv(t,"auth");if(e.isInitialized())return e.getImmediate();const n=Zz(t,{popupRedirectResolver:m8,persistence:[kB,fB,XC]}),r=RT("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=w8(i.toString());cB(n,o,()=>o(n.currentUser)),lB(n,l=>o(l))}}const s=IT("auth");return s&&tB(n,`http://${s}`),n}function S8(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}Qz({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=Zr("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",S8().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});x8("Browser");const sR=PT({apiKey:"AIzaSyDS7lgm2PwJBFrYE6ZHSYJfqcQw2TLC878",appId:"1:938280289868:web:e36c48cfbd55e4a8de96e",projectId:"zingmp3-clone-61799",authDomain:"zingmp3-clone-61799.firebaseapp.com"}),ie=e$(sR),ai=_8(sR),b8=new Os;var Tr={MISSING_UPLOAD_FILE_PARAMETER:{message:"Missing file parameter for upload"},MISSING_UPLOAD_FILENAME_PARAMETER:{message:"Missing fileName parameter for upload"},MISSING_PUBLIC_KEY:{message:"Missing public key for upload"},UPLOAD_ENDPOINT_NETWORK_ERROR:{message:"Request to ImageKit upload endpoint failed due to network error"},MISSING_SIGNATURE:{message:"Missing signature for upload. The SDK expects token, signature and expire for authentication."},MISSING_TOKEN:{message:"Missing token for upload. The SDK expects token, signature and expire for authentication."},MISSING_EXPIRE:{message:"Missing expire for upload. The SDK expects token, signature and expire for authentication."},INVALID_TRANSFORMATION:{message:"Invalid transformation parameter. Please include at least pre, post, or both."},INVALID_PRE_TRANSFORMATION:{message:"Invalid pre transformation parameter."},INVALID_POST_TRANSFORMATION:{message:"Invalid post transformation parameter."}};class rr extends Error{constructor(e,n){super(e),this.$ResponseMetadata=void 0,this.name="ImageKitInvalidRequestError",this.$ResponseMetadata=n}}class Qb extends Error{constructor(e,n){super(e),this.reason=void 0,this.name="ImageKitAbortError",this.reason=n}}class E8 extends Error{constructor(e){super(e),this.name="ImageKitUploadNetworkError"}}class Xb extends Error{constructor(e,n){super(e),this.$ResponseMetadata=void 0,this.name="ImageKitServerError",this.$ResponseMetadata=n}}const k8=t=>t?new Promise((e,n)=>{const{xhr:r}=t||{};delete t.xhr;const s=r||new XMLHttpRequest;if(!t.file)return n(new rr(Tr.MISSING_UPLOAD_FILE_PARAMETER.message));if(!t.fileName)return n(new rr(Tr.MISSING_UPLOAD_FILENAME_PARAMETER.message));if(!t.publicKey||t.publicKey.length===0)return n(new rr(Tr.MISSING_PUBLIC_KEY.message));if(!t.token)return n(new rr(Tr.MISSING_TOKEN.message));if(!t.signature)return n(new rr(Tr.MISSING_SIGNATURE.message));if(!t.expire)return n(new rr(Tr.MISSING_EXPIRE.message));if(t.transformation){if(!(Object.keys(t.transformation).includes("pre")||Object.keys(t.transformation).includes("post")))return n(new rr(Tr.INVALID_TRANSFORMATION.message));if(Object.keys(t.transformation).includes("pre")&&!t.transformation.pre)return n(new rr(Tr.INVALID_PRE_TRANSFORMATION.message));if(Object.keys(t.transformation).includes("post"))if(Array.isArray(t.transformation.post))for(let u of t.transformation.post){if(u.type==="abs"&&!(u.protocol||u.value))return n(new rr(Tr.INVALID_POST_TRANSFORMATION.message));if(u.type==="transformation"&&!u.value)return n(new rr(Tr.INVALID_POST_TRANSFORMATION.message))}else return n(new rr(Tr.INVALID_POST_TRANSFORMATION.message))}var i=new FormData;let o;for(o in t)if(o){if(o==="file"&&typeof t.file!="string")i.set("file",t.file,String(t.fileName));else if(o==="tags"&&Array.isArray(t.tags))i.set("tags",t.tags.join(","));else if(o==="signature")i.set("signature",t.signature);else if(o==="expire")i.set("expire",String(t.expire));else if(o==="token")i.set("token",t.token);else if(o==="responseFields"&&Array.isArray(t.responseFields))i.set("responseFields",t.responseFields.join(","));else if(o==="extensions"&&Array.isArray(t.extensions))i.set("extensions",JSON.stringify(t.extensions));else if(o==="customMetadata"&&typeof t.customMetadata=="object"&&!Array.isArray(t.customMetadata)&&t.customMetadata!==null)i.set("customMetadata",JSON.stringify(t.customMetadata));else if(o==="transformation"&&typeof t.transformation=="object"&&t.transformation!==null)i.set(o,JSON.stringify(t.transformation));else if(o==="checks"&&t.checks)i.set("checks",t.checks);else if(t[o]!==void 0){if(["onProgress","abortSignal"].includes(o))continue;i.set(o,String(t[o]))}}t.onProgress&&(s.upload.onprogress=function(u){t.onProgress&&t.onProgress(u)});function l(){var u;return s.abort(),n(new Qb("Upload aborted",(u=t.abortSignal)===null||u===void 0?void 0:u.reason))}if(t.abortSignal){if(t.abortSignal.aborted){var c;return n(new Qb("Upload aborted",(c=t.abortSignal)===null||c===void 0?void 0:c.reason))}t.abortSignal.addEventListener("abort",l),s.addEventListener("loadend",()=>{t.abortSignal&&t.abortSignal.removeEventListener("abort",l)})}s.open("POST","https://upload.imagekit.io/api/v1/files/upload"),s.onerror=function(u){return n(new E8(Tr.UPLOAD_ENDPOINT_NETWORK_ERROR.message))},s.onload=function(){if(s.status>=200&&s.status<300)try{var u=JSON.parse(s.responseText),d=j8(u,s);return e(d)}catch(m){return n(m)}else if(s.status>=400&&s.status<500)try{var u=JSON.parse(s.responseText);return n(new rr(u.message??"Invalid request. Please check the parameters.",Fh(s)))}catch(m){return n(m)}else try{var u=JSON.parse(s.responseText);return n(new Xb(u.message??"Server error occurred while uploading the file. This is rare and usually temporary.",Fh(s)))}catch{return n(new Xb("Server error occurred while uploading the file. This is rare and usually temporary.",Fh(s)))}},s.send(i)}):Promise.reject(new rr("Invalid options provided for upload")),j8=(t,e)=>{let n={...t};const r=Fh(e);return Object.defineProperty(n,"$ResponseMetadata",{value:r,enumerable:!1,writable:!1}),n},Fh=t=>{const e=T8(t);return{statusCode:t.status,headers:e,requestId:e["x-request-id"]}};function T8(t){const e={},n=t.getAllResponseHeaders();return Object.keys(n).length&&n.trim().split(/[\r\n]+/).map(r=>r.split(/: /)).forEach(r=>{e[r[0].trim().toLowerCase()]=r[1].trim()}),e}h.createContext({});const I8=!0,_t=St(ie,"Songs"),vn=St(ie,"Playlists"),Qa=St(ie,"Singers");St(ie,"Users");St(ie,"Lyrics");const Xa=St(ie,"Comments");St(ie,"DailySong");St(ie,"DailySong");const iR=St(ie,"Genres");St(ie,"Trending_Metrics");St(ie,"Categories");const Km=async({collectionName:t,id:e,msg:n})=>{console.log(n??">>> api: delete doc"),await f$(st(ie,t,e))},Wt=async({collectionName:t,id:e,msg:n})=>(console.log(n??">>> api: get doc"),_l(st(ie,t,e))),Ts=async({collectionName:t,data:e,msg:n})=>(console.log(n??">>> api: add doc"),await m$(St(ie,t),e)),Se=async({collectionName:t,id:e,data:n,msg:r})=>(console.log(r??">>> api: update doc"),await h$(st(ie,t,e),n)),ed=async({file:t,msg:e,folder:n})=>{var v;console.log(e??">>> api: upload file");const r=Date.now(),s=await((v=ai.currentUser)==null?void 0:v.getIdToken(!0)),i=await qu.get("/storage/auth",{headers:{Authorization:`Bearer ${s}`}}),{expire:o,token:l,signature:c,publicKey:u}=i.data.data,d=t.name.split("."),m=d.pop(),p=d.join("_"),{url:g,fileId:x}=await k8({expire:o,token:l,signature:c,publicKey:u,file:t,fileName:bn(p)+"."+m,folder:`/hd-mp3${n}`}),w=(Date.now()-r)/1e3;return console.log(">>> api: upload file finished after",w),{url:g,fileId:x}},Gt=async({fileId:t,msg:e})=>{var n;try{I8&&console.log(e??">>> api: delete file");const r=await((n=ai.currentUser)==null?void 0:n.getIdToken(!0));if(!r)return;await qu.delete(`/storage/${t}`,{headers:{Authorization:`Bearer ${r}`}})}catch(r){console.log(r)}},aR=async t=>{try{Gt({fileId:t.song_file_id,msg:">>> api: delete song file"}),t.beat_file_id&&Gt({fileId:t.beat_file_id,msg:">>> api: delete song's image file"}),t.image_file_id&&Gt({fileId:t.image_file_id,msg:">>> api: delete song's image file"})}catch(e){console.log(e)}},oR=t=>{try{const e={total_play:Ks(1),today_play:Ks(1),week_play:Ks(1),last_active:mt()};Se({id:t,collectionName:"Songs",data:e,msg:"Increase song play"})}catch(e){console.log(e)}};function lr(t,e,n){const r=bn((n==null?void 0:n.trim())||""),s=r.charAt(0).toUpperCase()+r.slice(1);return r.split(" ").length>1?le(t,...e,Q("meta","array-contains-any",r.split(" "))):le(t,...e,Q("name",">=",s),Q("name","<=",s+""))}function C8(){const[t,e]=h.useState(),[n,r]=h.useState([]),[s,i]=h.useState();return{imageFile:s,setImageFile:i,playlist:t,setPlaylist:e,updatePlaylistData:l=>{t&&e({...t,...l})},songs:n,setSongs:r}}const lR=h.createContext(null);function R8({children:t}){return a.jsx(lR.Provider,{value:C8(),children:t})}const Qm=()=>{const t=h.useContext(lR);if(!t)throw new Error("PlaylistProvider not provided");return t},N8=6;function A8(){const[t,e]=h.useState([]),[n,r]=h.useState(!0),s=h.useRef(),i=h.useRef(!0);return{playlists:t,setPlaylists:e,shouldGetPlaylists:i,lastDoc:s,hasMore:n,setHasMore:r,PAGE_SIZE:N8}}const cR=h.createContext(null);function P8({children:t}){return a.jsx(cR.Provider,{value:A8(),children:t})}const td=()=>{const t=h.useContext(cR);if(!t)throw new Error("PlaylistProvider not provided");return t};function Xm(){const{setErrorToast:t,setSuccessToast:e}=te(),{shouldGetPlaylists:n,lastDoc:r}=td(),{playlist:s,songs:i,setSongs:o,updatePlaylistData:l}=Qm(),[c,u]=h.useState(!1),d=Nt(),m=async(g,x)=>{const w={};g.forEach(S=>w[S.id]=!0);const v={singers:g,singer_map:w};await Se({collectionName:"Playlists",id:x,data:v}),l(v)};return{isFetching:c,action:async g=>{try{if(!s)throw new Error("playlist not found");switch(u(!0),g.variant){case"delete-playlist":{const x=mi(ie),w=st(ie,"Playlists",s.id),v=await bt(le(Xa,Q("target_id","==",s.id)));x.delete(w),v.empty||(console.log(`Delete ${v.docs.length} comments`),v.forEach(S=>x.delete(S.ref))),await Promise.all([x.commit(),s.image_file_id?Gt({fileId:s.image_file_id}):()=>{}]),n.current=!0,r.current=void 0,e("Delete playlsit sucessful"),d("/dashboard/playlist");break}case"add-songs":{const x=[...i,...g.songs],v={song_ids:x.map(S=>S.id)};await Se({collectionName:"Playlists",id:s.id,data:v,msg:">>> api: update playlist doc"}),l(v),o(x),e("Songs added");break}case"edit-playlist":{await Se({collectionName:"Playlists",id:s.id,data:g.playlist,msg:">>> api: update playlist doc"});const x={...s,...g.playlist};l(x),n.current=!0,r.current=void 0,e("Playlist edited");break}case"remove-song":{const x=i.filter(v=>v.id!==g.song.id),w={song_ids:x.map(v=>v.id)};await Se({collectionName:"Playlists",id:s.id,data:w,msg:">>> api: update playlist doc"}),o(x),e(`'${g.song.name}' removed`);break}case"update-image":{const x={image_url:g.song.image_url,blurhash_encode:g.song.blurhash_encode,image_file_id:""};s.image_file_id&&Gt({fileId:s.image_file_id}),await Se({collectionName:"Playlists",data:x,id:s.id,msg:">>> api: set playlist doc"}),l(x),e("Playlist edited");break}case"remove-singer":{const x=s.singers.filter(w=>w.id!==g.singer.id);m(x,s.id),e("Singer removed");break}case"add-singer":{const x=[...s.singers];if(x.find(v=>v.id===g.singer.id))return;x.push(g.singer),m(x,s.id),e("Singer added");break}}}catch(x){console.log({message:x}),t("")}finally{u(!1)}},playlist:s}}function F8({song:t}){const{action:e,isFetching:n,playlist:r}=Xm(),s=h.useRef(null),i={overlay:"absolute flex items-center justify-center inset-0 bg-black/40"},o=()=>{var c;(c=s.current)==null||c.open()},l=async c=>{var u;switch(c.variant){case"remove-song":await e({variant:"remove-song",song:c.song});break;case"update-image":await e({variant:"update-image",song:c.song});break;case"add-singer":await e({variant:"add-singer",singer:c.singer}),(u=s.current)==null||u.close()}};return a.jsxs(a.Fragment,{children:[a.jsxs(uR,{song:t,children:[a.jsxs("button",{onClick:()=>l({variant:"remove-song",song:t}),children:[a.jsx(pt,{className:"w-5"}),a.jsx("span",{children:"Remove"})]}),a.jsxs("button",{onClick:o,children:[a.jsx(zt,{className:"w-5"}),a.jsx("span",{children:"Add singer to playlist"})]}),t.image_url&&a.jsxs("button",{className:`${(r==null?void 0:r.image_url)===t.image_url?"disable":""}`,onClick:()=>l({variant:"update-image",song:t}),children:[a.jsx(di,{className:"w-5"}),a.jsx("span",{children:"Set playlist image"})]}),n&&a.jsx("div",{className:i.overlay,children:a.jsx("div",{className:"h-[25px] w-[25px] border-[2px] border-r-black rounded-[50%] animate-spin"})})]}),a.jsx(cw,{ref:s,children:a.jsxs(_e,{children:[a.jsx(ee,{title:"Singers"}),a.jsx("div",{className:"space-x-2 mt-3 [&>*]:px-3 [&>*]:py-1 [&>*]:rounded-md  [&>*]:bg-[#f1f1f1] hover:[&>*]:bg-black/10",children:t.singers.map((c,u)=>a.jsx("button",{onClick:()=>l({variant:"add-singer",singer:c}),children:c.name},u))})]})})]})}function M8({song:t}){return a.jsx(a.Fragment,{children:a.jsx(uR,{song:t,children:a.jsxs(X,{to:`/dashboard/lyric/${t.id}`,children:[a.jsx(pm,{className:"w-5"}),a.jsx("span",{children:"Lyric"})]})})})}function D8({song:t}){return a.jsx("div",{className:"px-2 mb-3",children:a.jsxs("div",{className:"p-2 bg-white/10 rounded-md flex",children:[a.jsx("div",{className:"w-[60px] h-[60px] flex-shrink-0 rounded overflow-hidden",children:a.jsx(Ce,{className:"object-cover h-full",src:t.image_url})}),a.jsxs("div",{className:"ml-2 text-sm",children:[a.jsx("h5",{className:"line-clamp-1 font-[500]",children:t.name}),a.jsx("h5",{className:"line-clamp-1 text-sm opacity-[.7]",children:t.singers.map((e,n)=>(n?", ":"")+e.name)})]})]})})}function uR({song:t,children:e}){return a.jsx(a.Fragment,{children:a.jsx(Dn,{className:"w-[260px]",children:a.jsxs(er,{children:[a.jsx(D8,{song:t}),a.jsx(Or,{children:e})]})})})}function dR({song:t,variant:e}){const n=()=>{switch(e){case"songs":return a.jsx(M8,{song:t});case"playlist":return a.jsx(F8,{song:t})}};return a.jsx(a.Fragment,{children:a.jsxs(Fn,{appendOnPortal:!0,children:[a.jsx(Mn,{children:a.jsx(q,{size:"clear",color:"second",className:"p-1",children:a.jsx(ao,{className:"w-5"})})}),n()]})})}function L8({song:t,className:e="",variant:n,children:r}){var s;return a.jsxs("tr",{className:e,children:[a.jsx("td",{children:a.jsx(X,{to:`/dashboard/song/${t.id}/edit`,className:"hover:underline",children:t.name})}),a.jsx("td",{children:t.singers.map((i,o)=>a.jsxs(X,{className:"hover:underline",to:`/dashboard/singer/${i.id}`,children:[!!o&&", ",i.name]},o))}),a.jsxs("td",{children:[(s=t.main_genre)==null?void 0:s.name,t.genres.map((i,o)=>a.jsxs("span",{children:[", ",i.name]},o))]}),a.jsx("td",{children:a.jsx(dR,{variant:n,song:t})}),r]})}function hR({value:t,setValue:e,inputRef:n}){return a.jsxs(Ot,{className:"flex gap-2 justify-between items-center",children:[a.jsx(_n,{ref:n,value:t,onChange:r=>e(r.target.value),placeholder:"..."}),a.jsx(q,{onClick:()=>t?e(""):{},size:"clear",className:"p-2 flex-shrink-0",children:t?a.jsx(oo,{className:"w-6"}):a.jsx(Fu,{className:"w-6"})})]})}function fo({handleSubmit:t,setValue:e,value:n,className:r="",loading:s,inputRef:i}){const o=l=>{l.preventDefault(),n.trim()&&t(l)};return a.jsx(Ot,{className:r,children:a.jsxs("form",{onSubmit:o,className:"flex gap-2 justify-between items-center",children:[a.jsxs("div",{className:"relative flex-grow flex items-center text-[#333]",children:[a.jsx(_n,{type:"text",ref:i,value:n,onChange:l=>e(l.target.value),placeholder:"..."}),n&&a.jsx("button",{type:"button",onClick:()=>{!s&&e("")},className:"absolute right-3",children:s?a.jsx(Ae,{className:"w-6 animate-spin"}):a.jsx(oo,{className:"w-6"})})]}),a.jsx(q,{type:"submit",size:"clear",className:"p-2 flex-shrink-0",children:a.jsx(Fu,{className:"w-6"})})]})})}function ns(t){if(!t)return"0";const e=["","K","M","B"],n=Math.log10(Math.abs(t))/3|0;return n===0?t.toString():(t/Math.pow(10,n*3)).toFixed(1)+e[n]}function Ym({init:t,submit:e,loading:n}){const[r,s]=h.useState(0),i=h.useRef(null);return h.useEffect(()=>{s(t)},[]),a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{children:"Likes: "})," ",ns(t),a.jsx("button",{onClick:()=>{var o;return(o=i.current)==null?void 0:o.open()},children:a.jsx(Dr,{className:"w-5"})})]}),a.jsx(ce,{variant:"animation",ref:i,children:a.jsxs(_e,{children:[a.jsxs("div",{children:[a.jsx(Dt,{htmlFor:"like",children:"Like"}),a.jsx(_n,{value:r+""||"0",id:"like",onChange:o=>s(+o.target.value||0),type:"number"})]}),a.jsx("p",{className:"text-right mt-5",children:a.jsx(q,{color:"primary",onClick:()=>{e(r,i.current.close)},disabled:n,className:"rounded-full",children:"Save"})}),n&&a.jsx(da,{})]})})]})}function _w({closeModal:t,data:e,submit:n,isLoading:r}){const[s,i]=h.useState([]),[o,l]=h.useState(),c=h.useMemo(()=>{const d=[];return s.forEach(m=>{const p=e.find(g=>g.id===m);p&&d.push(p)}),d},[s]),u=d=>{if(o===void 0)l(d);else if(d===o)l(void 0);else{const m=[...s],p=m[o];m[o]=m[d],m[d]=p,i(m),l(void 0)}};return h.useEffect(()=>{i(e.map(d=>d.id))},[]),a.jsx(a.Fragment,{children:a.jsxs(_e,{children:[a.jsx(Be,{closeModal:t,title:"Change order"}),a.jsx("div",{className:"flex flex-col flex-grow overflow-auto space-y-2 py-2",children:c.map((d,m)=>a.jsx("button",{onClick:()=>u(m),"data-id":d.id,className:`attribute-item p-1.5 ${o===m?"bg-[--primary-cl] text-white":"hover:bg-[--a-5-cl] bg-[#f1f1f1]"}  border-[2px] border-[#ccc] rounded-md`,children:d.label},m))}),a.jsx("p",{className:"text-right mt-3",children:a.jsx(q,{onClick:()=>n(s),loading:r,children:"Ok"})})]})})}function O8({children:t,className:e,persisted:n=!1,...r},s){const i=r.variant||"default",[o,l]=h.useState(i==="default"),[c,u]=h.useState(i==="default"),[d,m]=h.useState(!1),p=()=>{c&&u(!1),o||l(!0)},g=()=>{l(!0)},x=()=>{u(!1),m(!1)},w=()=>{d||(i==="default"?r.closeModal&&r.closeModal():x())},v=E=>{m(E)},S=E=>{E.preventDefault(),E.stopPropagation(),w()};h.useImperativeHandle(s,()=>({toggle:p,close:x,open:g,setModalPersist:v})),h.useEffect(()=>{o&&m(n)},[o]),h.useEffect(()=>{i!=="default"&&(c||setTimeout(()=>{l(!1),r.onClose&&r.onClose()},300))},[c]),h.useEffect(()=>{i!=="default"&&o&&setTimeout(()=>{u(!0)},100)},[o]),h.useEffect(()=>{const E=I=>{I.key==="Escape"&&w()};return o&&window.addEventListener("keyup",E),()=>{window.removeEventListener("keyup",E)}},[o,d]);const _={unMountedContent:"opacity-0 scale-[.95]",mountedContent:"opacity-100 scale-[1]",unMountedLayer:"opacity-0",mountedLayer:"opacity-40"};return a.jsx(a.Fragment,{children:o&&so.createPortal(a.jsxs("div",{className:"fixed inset-0 z-[99]",children:[a.jsx("div",{onClick:S,className:`transition-opacity duration-300 absolute bg-black inset-0 z-[90]
                             ${c?_.mountedLayer:_.unMountedLayer}
                        `}),a.jsx("div",{className:`modal-content absolute duration-300 transition-[transform,opacity] z-[99] top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2
                            ${c?_.mountedContent:_.unMountedContent}
                        `,children:t})]}),document.getElementById("portals"))})}function _e({children:t,noStyle:e,disable:n,className:r="w-[400px]"}){return a.jsx("div",{className:`relative text-[--text-cl] transition-[color] overflow-hidden max-h-[80vh] max-w-[90vw] flex flex-col  ${n?"disabled":""} ${e?"":"p-3 md:p-4s rounded-xl"}  ${location.hash.includes("/dashboard")?"bg-white text-black":"bg-[--popup-cl]"} ${r}`,children:t})}const ce=h.forwardRef(O8),$8=({appendOnPortal:t})=>{const[e,n]=h.useState(!1),[r,s]=h.useState(!1),i=h.useRef(null),o=h.useRef(null);return{refs:{triggerRef:i,contentRef:o},setTriggerRef:m=>{i.current=m},setContentRef:m=>{o.current=m},state:{isMounted:r,isOpen:e},setIsMounted:s,setIsOpen:n,appendOnPortal:t,close:()=>{s(!1)},toggle:()=>{r&&s(!1),e||n(!0)}}},fR=h.createContext(null),Ul=()=>{const t=h.useContext(fR);return t||{}};function Fn({children:t,appendOnPortal:e,className:n="",...r}){return a.jsx(fR.Provider,{value:$8({...r,appendOnPortal:e}),children:e?t:a.jsx("div",{className:`relative z-[9] ${n}`,children:t})})}function z8(t){const{state:{isOpen:e},refs:n,close:r,appendOnPortal:s}=Ul(),i=h.useRef(null),o=()=>{const{origin:c="top right",position:u,spacer:d=8}=t,m=n.triggerRef.current,p=n.contentRef.current,g=i.current;if(!m||!p)return;const x=m.getBoundingClientRect(),w={top:x.top+m.clientHeight,left:x.left-p.clientWidth-d};if(s){switch(w.top=x.top+m.clientHeight+d,u){case"right-bottom":w.left=x.left+d;break}const v=w.top+p.clientHeight>window.innerHeight-90;if(v){let S=w.top-p.clientHeight-m.clientHeight;S-60<0&&(S=60),w.top=S}if(g){let S=c;v&&(S="bottom right"),g.style.transformOrigin=S}}p.style.left=`${w.left}px`,p.style.top=`${w.top}px`},l=r;return h.useEffect(()=>{if(!s)return;if(e)o();else return;const c=document.querySelector(".main-container");if(c)return c.addEventListener("wheel",l),()=>{c&&c.removeEventListener("wheel",l)}},[e]),{animationRef:i}}const Mn=h.forwardRef(function({children:t,needButton:e},n){const{refs:r,setIsMounted:s,setIsOpen:i,close:o,toggle:l,state:{isMounted:c,isOpen:u}}=Ul();return h.useImperativeHandle(n,()=>({close:o})),h.useEffect(()=>{c||setTimeout(()=>{i(!1)},400)},[c]),h.useEffect(()=>(u&&setTimeout(()=>{s(!0)},100),()=>{u||s(!1)}),[u]),h.useEffect(()=>{if(!u)return;const d=m=>{var p,g;!r.contentRef||!r.triggerRef||(p=r.triggerRef.current)!=null&&p.contains(m.target)||(g=r.contentRef.current)!=null&&g.contains(m.target)||s(!1)};return document.addEventListener("mousedown",d),document.addEventListener("touchstart",d),()=>{document.removeEventListener("mousedown",d),document.removeEventListener("touchstart",d)}},[u]),!e&&h.isValidElement(t)?h.cloneElement(t,{onClick:l,ref:r.triggerRef}):a.jsx("button",{ref:r.triggerRef,onClick:l,children:t})});function Dn(t){const{animationRef:e}=z8(t),{state:{isMounted:n,isOpen:r},appendOnPortal:s,setContentRef:i}=Ul(),o={unMountedContent:"opacity-0 scale-[.95]",mountedContent:"opacity-100 scale-[1]"},l=a.jsx("div",{ref:i,className:`${s?"fixed z-[99]":"absolute"} ${t.className||""}`,children:a.jsx("div",{ref:e,className:` transition-[transform,opacity] duration-[.25s] ease-linear ${t.animationClassName||""} ${n?o.mountedContent:o.unMountedContent}`,children:t.children})});return r?a.jsx(a.Fragment,{children:s?so.createPortal(l,document.getElementById("portals")):l}):a.jsx(a.Fragment,{})}function B8({children:t,className:e=""}){const{close:n}=Ul(),r=h.useRef(null);return h.useEffect(()=>{if(!r.current)return;const s=r.current.querySelectorAll("button");return s.forEach(i=>{i.addEventListener("click",n)}),()=>{s&&s.forEach(i=>{i.removeEventListener("click",n)})}},[]),a.jsx("div",{ref:r,className:`${e}`,children:t})}function Or({children:t,dismiss:e=!0,className:n=""}){const r={container:"hover:[&>*:not(div.absolute)]:bg-[--a-5-cl] [&>*]:px-3 [&>*]:py-2 [&>*]:w-full [&>*]:space-x-2 [&>*]:text-sm [&>*]:flex [&>*]:items-center [&_svg]:w-6  [&_svg]:flex-shrink-0 [&>*]:items-center [&_span]:font-semibold"};return e?a.jsx(B8,{className:`${r.container} ${n}`,children:t}):a.jsx("div",{className:r.container,children:t})}function er({children:t,className:e="",colorClasses:n="bg-[--popup-cl] text-[--text-cl]"}){return a.jsx("div",{className:`rounded-md py-2 shadow-[0_0_6px_0_rgba(0,0,0,0.2)]  transition-[color] ${n}  ${e}`,children:t})}var V8=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","#","$","%","*","+",",","-",".",":",";","=","?","@","[","]","^","_","{","|","}","~"],jc=t=>{let e=0;for(let n=0;n<t.length;n++){let r=t[n],s=V8.indexOf(r);e=e*83+s}return e},Ng=t=>{let e=t/255;return e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)},Ag=t=>{let e=Math.max(0,Math.min(1,t));return e<=.0031308?Math.trunc(e*12.92*255+.5):Math.trunc((1.055*Math.pow(e,.4166666666666667)-.055)*255+.5)},U8=t=>t<0?-1:1,Pg=(t,e)=>U8(t)*Math.pow(Math.abs(t),e),Yb=class extends Error{constructor(t){super(t),this.name="ValidationError",this.message=t}},H8=t=>{if(!t||t.length<6)throw new Yb("The blurhash string must be at least 6 characters");let e=jc(t[0]),n=Math.floor(e/9)+1,r=e%9+1;if(t.length!==4+2*r*n)throw new Yb(`blurhash length mismatch: length is ${t.length} but it should be ${4+2*r*n}`)},G8=t=>{let e=t>>16,n=t>>8&255,r=t&255;return[Ng(e),Ng(n),Ng(r)]},W8=(t,e)=>{let n=Math.floor(t/361),r=Math.floor(t/19)%19,s=t%19;return[Pg((n-9)/9,2)*e,Pg((r-9)/9,2)*e,Pg((s-9)/9,2)*e]},q8=(t,e,n,r)=>{H8(t),r=r|1;let s=jc(t[0]),i=Math.floor(s/9)+1,o=s%9+1,l=(jc(t[1])+1)/166,c=new Array(o*i);for(let m=0;m<c.length;m++)if(m===0){let p=jc(t.substring(2,6));c[m]=G8(p)}else{let p=jc(t.substring(4+m*2,6+m*2));c[m]=W8(p,l*r)}let u=e*4,d=new Uint8ClampedArray(u*n);for(let m=0;m<n;m++)for(let p=0;p<e;p++){let g=0,x=0,w=0;for(let E=0;E<i;E++)for(let I=0;I<o;I++){let P=Math.cos(Math.PI*p*I/e)*Math.cos(Math.PI*m*E/n),F=c[I+E*o];g+=F[0]*P,x+=F[1]*P,w+=F[2]*P}let v=Ag(g),S=Ag(x),_=Ag(w);d[4*p+0+m*u]=v,d[4*p+1+m*u]=S,d[4*p+2+m*u]=_,d[4*p+3+m*u]=255}return d},K8=q8,Q8=Object.defineProperty,X8=Object.defineProperties,Y8=Object.getOwnPropertyDescriptors,Rf=Object.getOwnPropertySymbols,mR=Object.prototype.hasOwnProperty,pR=Object.prototype.propertyIsEnumerable,Jb=(t,e,n)=>e in t?Q8(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Nx=(t,e)=>{for(var n in e||(e={}))mR.call(e,n)&&Jb(t,n,e[n]);if(Rf)for(var n of Rf(e))pR.call(e,n)&&Jb(t,n,e[n]);return t},Ax=(t,e)=>X8(t,Y8(e)),gR=(t,e)=>{var n={};for(var r in t)mR.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&Rf)for(var r of Rf(t))e.indexOf(r)<0&&pR.call(t,r)&&(n[r]=t[r]);return n},xR=class extends h.PureComponent{constructor(){super(...arguments),this.canvas=null,this.handleRef=t=>{this.canvas=t,this.draw()},this.draw=()=>{let{hash:t,height:e,punch:n,width:r}=this.props;if(this.canvas){let s=K8(t,r,e,n),i=this.canvas.getContext("2d"),o=i.createImageData(r,e);o.data.set(s),i.putImageData(o,0,0)}}}componentDidUpdate(){this.draw()}render(){let t=this.props,{hash:e,height:n,width:r}=t,s=gR(t,["hash","height","width"]);return h.createElement("canvas",Ax(Nx({},s),{height:n,width:r,ref:this.handleRef}))}};xR.defaultProps={height:128,width:128};var J8={position:"absolute",top:0,bottom:0,left:0,right:0,width:"100%",height:"100%"},nd=class extends h.PureComponent{componentDidUpdate(){if(this.props.resolutionX<=0)throw new Error("resolutionX must be larger than zero");if(this.props.resolutionY<=0)throw new Error("resolutionY must be larger than zero")}render(){let t=this.props,{hash:e,height:n,width:r,punch:s,resolutionX:i,resolutionY:o,style:l}=t,c=gR(t,["hash","height","width","punch","resolutionX","resolutionY","style"]);return h.createElement("div",Ax(Nx({},c),{style:Ax(Nx({display:"inline-block",height:n,width:r},l),{position:"relative"})}),h.createElement(xR,{hash:e,height:o,width:i,punch:s,style:J8}))}};nd.defaultProps={height:128,width:128,resolutionX:32,resolutionY:32};const Sw="USRKy:SK%|R*}@r@MxoeY$kWmnafBUR*oybu";function Ce({src:t,className:e="",width:n="w-full",blurHashEncode:r,onError:s}){const[i,o]=h.useState(!1),l=h.useRef(null),c=()=>{o(!0),t&&t!=null&&t.includes("blob")&&URL.revokeObjectURL(t)},u=()=>{const m=l.current;m.src="https://placehold.co/400",o(!0)},d=()=>{console.log("image error"),s?(s(),u()):u()};return a.jsxs(a.Fragment,{children:[!i&&a.jsx(a.Fragment,{children:a.jsx(nd,{hash:r||Sw,className:"rounded-md overflow-hidden",height:"100%",width:"100%"})}),a.jsx("img",{onLoad:c,onError:d,className:`${e} ${n} ${i?"":"hidden"}`,src:t||"https://placehold.co/400",ref:l})]})}function Zb({className:t,icon:e,label:n,to:r,arrowIcon:s,children:i}){return r?a.jsxs(X,{className:`w-full flex  justify-between  ${t}`,to:r,children:[a.jsxs("div",{className:"inline-flex items-center ",children:[e,a.jsx("span",{className:"text-lg font-medium",children:n})]}),i,s&&a.jsx("span",{children:s})]}):a.jsx("p",{children:"No onClick"})}const yR="/HD-MP3/assets/simon_empty-95813d48.png";function Re({children:t,variant:e="default",className:n=""}){const r=()=>{switch(e){case"less":return a.jsx(a.Fragment,{});case"with-home-button":return a.jsxs(a.Fragment,{children:[a.jsx("p",{className:"text-center",children:"No result found, ¯\\_(ツ)_/¯"}),a.jsx("p",{className:"text-center mt-5",children:a.jsx(X,{to:"/",children:a.jsxs(se,{color:"primary",children:[a.jsx(Pu,{className:"w-6"}),a.jsx("span",{children:"Home"})]})})})]});case"default":return a.jsx("p",{className:"text-center",children:"No result found, ¯\\_(ツ)_/¯"})}};return a.jsxs("div",{className:`${n}`,children:[a.jsx("img",{className:"mx-auto",src:yR,alt:""}),r(),t]})}function ze({children:t}){return a.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2",children:t})}function vR({colList:t,children:e,className:n=""}){const r={table:"w-full"};return a.jsxs("table",{className:`${r.table} ${n}`,children:[a.jsx("thead",{children:a.jsx("tr",{className:"no-hover",children:t.map((s,i)=>a.jsx("th",{children:s},i))})}),a.jsx("tbody",{children:e})]})}function Px(t,e){const[n,r]=h.useState(e),s=h.useRef(!1);return h.useEffect(()=>{const i=It()[t]||e;r(i)},[]),h.useEffect(()=>{if(!s.current){s.current=!0;return}rt(t,n)},[n]),[n,r]}function Z8({audioEle:t,postLocalStorageKey:e}){const[n,r]=Px(`audio_speed_${e}`,1),[s,i]=Px(`audio_volume_${e}`,100);return h.useEffect(()=>{t.volume=s/100,t.playbackRate=n},[s,n]),{speed:n,setSpeed:r,volume:s,setVolume:i}}function wR({className:t="",positions:e="right",bg:n="bg-[--primary-cl] text-white",menuColor:r="bg-[--popup-cl]",...s}){const{speed:i,volume:o,setVolume:l,setSpeed:c}=Z8(s);return a.jsxs(Fn,{appendOnPortal:!0,children:[a.jsx(Mn,{children:a.jsx(se,{className:`rounded-full ${n} ${t}`,children:a.jsx(dv,{className:"w-6"})})}),a.jsx(Dn,{...e==="right"?{position:"right-bottom",origin:"top left"}:{position:"left-bottom",origin:"top right"},children:a.jsx(er,{colorClasses:r,className:"w-[240px] px-2",children:a.jsxs("div",{className:"space-y-[6px]",children:[a.jsxs("div",{className:"flex space-x-1",children:[a.jsxs("div",{className:"w-[110px] flex-shrink-0",children:["Speed ",i,"x"]}),a.jsx("input",{className:"w-full",type:"range",step:.1,min:.6,max:1.5,value:i,onChange:u=>c(+u.target.value)})]}),a.jsxs("div",{className:"flex space-x-1",children:[a.jsxs("div",{className:"w-[110px] flex-shrink-0",children:["Volume ",o,"%"]}),a.jsx("input",{className:"w-full",type:"range",step:1,min:1,max:100,value:o,onChange:u=>l(+u.target.value)})]})]})})})]})}function ge({className:t}){return a.jsx("div",{className:`animate-pulse rounded-[4px] bg-gray-400 dark:bg-gray-600  ${t}`})}const Rs=[...Array(4).keys()].map(t=>a.jsxs("div",{className:"flex items-center p-[10px] border-b-[1px] border-transparent",children:[a.jsx(ge,{className:"h-[18px] w-[18px]"}),a.jsx(ge,{className:"h-[54px] w-[54px] ml-[10px] rounded-[4px]"}),a.jsxs("div",{className:"ml-[10px]",children:[a.jsx(ge,{className:"h-[20px] mb-[5px] w-[150px]"}),a.jsx(ge,{className:"h-[12px] mt-[5px] w-[100px]"})]})]},t)),_R=()=>a.jsx("div",{className:"py-3",children:a.jsx(ge,{className:"w-full h-[28px]"})}),eV=[...Array(2).keys()].map(t=>a.jsxs("div",{className:"p-2 w-1/2 md:w-1/4",children:[a.jsx(ge,{className:"pt-[100%] rounded-lg"}),a.jsx(ge,{className:"h-[21px] mt-1.5 w-3/4"}),a.jsx(ge,{className:"h-[13px] mt-1 w-3/4"})]},t));function Ho({cb:t,active:e,inActiveBg:n="bg-[--a-5-cl]",size:r="default"}){const s={circle:`${r==="default"?"w-[20px] h-[20px]":"w-[16px] h-[16px]"}  absolute bg-white left-[3px] rounded-[50%] transition-transform top-[50%] translate-y-[-50%]`,active:`${r==="default"?"translate-x-[14px]":"translate-x-[18px]"} `,inActive:"translate-x-[0]"};return a.jsx("div",{onClick:t,className:`relative  cursor-pointer ${r==="default"?"h-[24px]":"h-[20px]"} rounded-[99px] w-[40px] 
         ${e?"bg-[--primary-cl]":n} `,children:a.jsx("div",{className:`${s.circle} ${e?s.active:s.inActive}`})})}function tr({setTab:t,render:e,disable:n,tab:r,tabs:s,className:i="",buttonClasses:o="[&_button]:py-1 [&_button]:px-4 "}){const l={inActiveTab:" hover:bg-[--a-5-cl]",activeTab:"bg-[--primary-cl] text-white"};return a.jsx("div",{className:`bg-[--a-5-cl] ${n?"disable":""} p-1.5 space-x-1 rounded-full ${i} ${o}`,children:s.map((c,u)=>a.jsx(se,{size:"clear",onClick:d=>{t(c),d.target.blur()},className:`${c===r?l.activeTab:l.inActiveTab}`,children:e(c)},u))})}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function tV(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function l(d){try{u(r.next(d))}catch(m){o(m)}}function c(d){try{u(r.throw(d))}catch(m){o(m)}}function u(d){d.done?i(d.value):s(d.value).then(l,c)}u((r=r.apply(t,e||[])).next())})}function nV(t,e){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,s,i,o;return o={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(u){return function(d){return c([u,d])}}function c(u){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,s&&(i=u[0]&2?s.return:u[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,u[1])).done)return i;switch(s=0,i&&(u=[u[0]&2,i.value]),u[0]){case 0:case 1:i=u;break;case 4:return n.label++,{value:u[1],done:!1};case 5:n.label++,s=u[1],u=[0];continue;case 7:u=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(u[0]===6||u[0]===2)){n=0;continue}if(u[0]===3&&(!i||u[1]>i[0]&&u[1]<i[3])){n.label=u[1];break}if(u[0]===6&&n.label<i[1]){n.label=i[1],i=u;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(u);break}i[2]&&n.ops.pop(),n.trys.pop();continue}u=e.call(t,n)}catch(d){u=[6,d],s=0}finally{r=i=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Go=function(){return Go=Object.assign||function(e){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Go.apply(this,arguments)},SR=function(t){return{loading:t==null,value:t}},rV=function(){return function(t,e){switch(e.type){case"error":return Go(Go({},t),{error:e.error,loading:!1,value:void 0});case"reset":return SR(e.defaultValue);case"value":return Go(Go({},t),{error:void 0,loading:!1,value:e.value});default:return t}}},sV=function(t){var e=t?t():void 0,n=h.useReducer(rV(),SR(e)),r=n[0],s=n[1],i=h.useCallback(function(){var c=t?t():void 0;s({type:"reset",defaultValue:c})},[t]),o=h.useCallback(function(c){s({type:"error",error:c})},[]),l=h.useCallback(function(c){s({type:"value",value:c})},[]);return h.useMemo(function(){return{error:r.error,loading:r.loading,reset:i,setError:o,setValue:l,value:r.value}},[r.error,r.loading,i,o,l,r.value])},bw=function(t,e){var n=sV(function(){return t.currentUser}),r=n.error,s=n.loading,i=n.setError,o=n.setValue,l=n.value;return h.useEffect(function(){var c=uB(t,function(u){return tV(void 0,void 0,void 0,function(){var d;return nV(this,function(m){switch(m.label){case 0:if(!(e!=null&&e.onUserChanged))return[3,4];m.label=1;case 1:return m.trys.push([1,3,,4]),[4,e.onUserChanged(u)];case 2:return m.sent(),[3,4];case 3:return d=m.sent(),i(d),[3,4];case 4:return o(u),[2]}})})},i);return function(){c()}},[t]),[l,s,r]};const iV="/HD-MP3/assets/user-default-971f59df.png";function Fx({className:t}){const[e]=bw(ai),n={imageFrame:`${t||"w-[35px] h-[35px]"} flex-shrink-0 rounded-full overflow-hidden ${e!=null&&e.photoURL?"":"flex items-center justify-center bg-[#ccc]"}`};return a.jsx("div",{className:n.imageFrame,children:a.jsx(Ce,{src:(e==null?void 0:e.photoURL)||iV,className:"w-full"})})}function aV({children:t,onClose:e},n){const[r,s]=h.useState(!1),[i,o]=h.useState(!1),l=()=>{i&&o(!1),r||s(!0)},c=()=>{s(!0)},u=()=>{o(!1)},d=p=>{p.preventDefault(),p.stopPropagation(),u()};h.useImperativeHandle(n,()=>({toggle:l,close:u,open:c,setModalPersist:()=>{}})),h.useEffect(()=>{i||setTimeout(()=>{s(!1),e&&e()},400)},[i]),h.useEffect(()=>{r&&setTimeout(()=>{o(!0)},100)},[r]);const m={unMountedContent:"translate-y-full ",mountedContent:"translate-y-0",unMountedLayer:"opacity-0",mountedLayer:"opacity-20"};return a.jsx(a.Fragment,{children:r&&so.createPortal(a.jsxs("div",{className:"fixed inset-0 z-[99]",children:[a.jsx("div",{onClick:d,className:`transition-opacity duration-300 absolute bg-black inset-0 z-[90]
                             ${i?m.mountedLayer:m.unMountedLayer}
                        `}),a.jsx("div",{className:`modal-content absolute bottom-0 left-0 right-0 duration-300 transition-[transform,opacity] z-[99]
                            ${i?m.mountedContent:m.unMountedContent}
                        `,children:t})]}),document.getElementById("portals"))})}const Mx=h.forwardRef(aV),oV="/HD-MP3/assets/loading-b1210647.gif";function ua({className:t=""}){return a.jsx("img",{src:oV,className:`w-[200px] mx-auto ${t}`})}function Dt({children:t,className:e="",htmlFor:n}){const r=`text-gray-600 dark:text-gray-300 font-bold ${e}`;return n?a.jsx("label",{className:r,htmlFor:n,children:t}):a.jsx("p",{className:r,children:t})}function da(){return a.jsx("div",{className:"absolute z-[999] left-0 top-0 bottom-0 w-full flex items-center justify-center bg-white/60 dark:bg-white/30",children:a.jsx("div",{className:"w-9 h-9 animate-spin rounded-full border-r-[--primary-cl] border-4"})})}function rd({className:t="h-[6px]",onClick:e,elelRef:n,bg:r="var(--a-5-cl)"}){return a.jsx("div",{onClick:e,ref:n,style:{background:r},className:`rounded-full w-full progress-line ${t}`})}function mo({children:t,className:e="space-y-10"}){return a.jsx("div",{className:"min-h-[calc(100vh-127px-10px)] md:min-h-[unset] md:pt-10 "+e,children:t})}const Ew="data:image/gif;base64,R0lGODlhJAAkAIABAP///////yH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQ4IDc5LjE2NDAzNiwgMjAxOS8wOC8xMy0wMTowNjo1NyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo0NmRjOGMyNC03YmYxLTQxZTMtYjQ2Zi1mY2ZhMDk4MDE1YWYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MTBDRTc0QzlGNDBEMTFFQTk4NDZENjI0QzI1MENFQzgiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MTBDRTc0QzhGNDBEMTFFQTk4NDZENjI0QzI1MENFQzgiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6YzBhNGU4OWYtNjc4Yy00NmMyLTg4NmUtYzIxNGE0NTIwZDRjIiBzdFJlZjpkb2N1bWVudElEPSJhZG9iZTpkb2NpZDpwaG90b3Nob3A6ODRlMDBjYmEtZjhlNy03YzQ4LWE4MTgtNDc3NTI3MGQ1ZTAyIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkECQgAAQAsAAAAACQAJAAAAnKMj5nArQ9jc7HWyax+GOx/dCAojltpWmgqYazqvu0kz1StrHgYp6tO6gWAn59wZKSxkjcTM7MUEk/SY1BpmGqeHhs0W8Vywk3tkPw9iztcBLfNW7Pl9PLcXk/f8Xz9vguWB6h254Y2+Id4aLjH2Kc4UQAAIfkECQgAAQAsAAAAACQAJAAAAnSMj6nL7Q+jnAzYS+XFGW7beV/4fADpmGijrkvrJnA2z1Q9hvhG7lznA+lyBpuMGAieDiYlQulkIpvTKk9KFRatv2RW671uxeHskwv+ptHLsRnbhbLPZHW7vK6r6XF21J33Bngnp2fY98UXuNikSOg3B8dYAAAh+QQJCAABACwAAAAAJAAkAAACfIyPqcvtD6OctNqLKdg8N955C7iJI4mQAKam6NUeMTMHda3cr4EnOugCfnY2Yi8Y4hmXKqHSWYQ2mclodSqllmTY7fOqbSK9VnLXHB6Ludk2Vg1nv+Vo9zT+rc/zK3qf/wNmt8aHV0Z4aHj2l+inFqgXiQjJuKgYRnkJUgAAIfkECQgAAQAsAAAAACQAJAAAAnuMj6nL7Q+jnLTaC7K+T2/eeBkYiiQjAlyKsJh5uJYc0BRtTzgMpbsn8fFqQ4cQGCuWjqok0vA7toZR4fRJxDJHzg+Uur16s+Nt86sFM8VcdDncbZPlZvZ5fq/H82rp3m5XxZe29mfoZnWIF9hH1+gDqKiHOPhWSBlJWQAAIfkECQgAAQAsAAAAACQAJAAAAn6Mj6nL7Q8RmDTaQ+u1eW7efVg4ZqLRARIppqsZpW6pQTIbzPZd57jD6+keQQ/NuAu+esDiEkl0HlUxKerXKFKvsCTvuY0qp2Dw8IzTlslTdNf3VrO5Qiu8Hre78d/5HSpHB5imR5g3Jhi2d7OWaGbIN4j4pwjJ6Lco00gJVgAAIfkECQgAAQAsAAAAACQAJAAAAn2EH6nL7XnQmxRGULO7WHsbfRPHiQ95mRsqqQvbBqUGG29K13eYw3tMqXVAwJFOMcsIf7YeizmsLJE45ZHYtPqoPO2TWzxdZVXpOGneYqPBc7mtJnflsekaCkXry3Z61h/VtzcnyGcYN1jnRnj4dQf2V8g46QiIB0ly+bhWAAAh+QQJCAABACwAAAAAJAAkAAACfYyPqcvtD+MDtMobqt6Y7Q90C8iJCamZJ0qpCNu6Bhwen0S/JZTb+wTTpSK92c9RzBwbyRsx6BvyoEYpkCW0RLVVVDbWBSuxW7EzDPrW0OrzmPs2U+Nrevvnzs/11ib+T8ZWVufXB+g1qHZnyAhX6HhIopg4yAfZKEkpiFYAACH5BAkIAAEALAAAAAAkACQAAAJ7jI+py+0Po5y02ouB3tht3jGfFopjuYwqgK5npCLuJ8XHDEK2gZP3ywMGeqwfzZgb9mTCnRLHPAalz1k06SRefVPsEsmthrXgYnf8PZvFa7J6206z4fBs8w4t08t2at+qF6j2h+YnRxiX9ybIhrg3iOdlqDjH6Fa5qFYAACH5BAkIAAEALAAAAAAkACQAAAJ1jI+py+0Po5y02otzArxr1nmfEnIjWZ5bqh4l0Lqs8WK1HNpzcFs9/9o5fkFhg1gUQZBJWISZlECL0l3ThFMCc1lq10mzXhFT8Db6JYubam7Yffa+teVymz5O6+fyuLm+hgd39ReIxRd0d+inmLjH+GX3+FIAACH5BAUIAAEALAAAAAAkACQAAAJwjI+py+0Po5y0PoCzhVlv12EfGI5NCJgMqi5sm7zwIc9BPeOw3vKqb6oBLyUaqshB3o4diZDpSTaN0FTkWUVgo8sslbtlapXh43hqKJfP4Ko1TY574ehue24XffV0KJuf9xa4tifoZih351f4h9hRAAA7",Nf=t=>{const e=(t.variant==="image"||t.variant==="link")&&a.jsxs("div",{className:"aspect-[1/1] relative rounded-lg overflow-hidden",children:[a.jsx(Ce,{className:`hover:scale-[1.05] duration-[.3s] transition-transform object-cover ${t.active?"brightness-[90%]":""}`,src:t.data.image_url,blurHashEncode:t.data.blurhash_encode}),t.active&&a.jsx(ze,{children:a.jsx("img",{src:Ew,alt:"",className:"w-[30px]"})})]});return(()=>{switch(t.variant){case"skeleton":return a.jsxs("div",{className:"p-3 w-1/2 sm:w-1/3 md:w-1/4",children:[a.jsx(ge,{className:"aspect-[1/1] rounded-lg"}),a.jsx(ge,{className:"h-[21px] mt-1.5 w-3/4"}),a.jsx(ge,{className:"h-[13px] mt-1 w-3/4"})]});case"link":return a.jsxs("div",{className:"p-3 w-1/2 sm:w-1/3 md:w-1/4",children:[a.jsx(X,{to:`${t.link||"/playlist/"+t.data.id}`,className:"",children:e}),a.jsx("p",{className:"font-semibold leading-[1.3] line-clamp-1 mt-1.5",children:t.data.name}),a.jsx("p",{className:"text-sm opacity-[.7] leading-[1.3] line-clamp-1",children:t.data.is_album?t.data.singers[0].name:t.data.distributor})]});case"image":return e}})()};function lV({openModal:t}){const e=n=>{t(n)};return a.jsx(a.Fragment,{children:a.jsx(er,{className:"w-[200px] px-2",children:a.jsxs(Or,{className:"[&>button]:rounded-md",children:[a.jsxs("button",{className:"",onClick:()=>e("theme"),children:[a.jsx(Kj,{}),a.jsx("span",{children:"Themes"})]}),a.jsxs("button",{onClick:()=>e("info"),children:[a.jsx(qj,{}),a.jsx("span",{children:"Info"})]})]})})})}const cV=({data:t,active:e,onClick:n,hasTitle:r,classNames:s="",idleClass:i=""},o)=>{const l={container:"flex flex-col",imageFrame:"group relative transition-[width] duration-[.3s] origin-center rounded-xl overflow-hidden",image:"select-none object-cover object-center rounded w-full",overlay:`absolute  ${e?"":"inset-0 hidden bg-black/40 items-center justify-center"}   group-hover:flex`,playingGifFrame:"absolute h-[30px] w-[30px] bottom-[15px] left-[15px] -z-1",title:"text-2xl text-white mt-3 font-bold text-ellipsis line-clamp-1"};if(t)return a.jsxs("div",{ref:o,"queue-id":t.queue_id,className:`song-thumb ${e?"active":""} ${l.container} ${i}`,children:[a.jsx("div",{className:`${s} flex items-end justify-center flex-shrink-0 w-[350px] h-[350px] min-[1536px]:w-[450px] min-[1536px]:h-[450px] `,children:a.jsxs("div",{className:`border-[4px] rounded-[6px] overflow-hidden border-transparent ${l.imageFrame} ${e?"w-[350px] min-[1536px]:w-[450px]":"w-[280px] min-[1536px]:w-[330px]"}`,children:[a.jsx(Ce,{src:t.image_url,blurHashEncode:t.blurhash_encode}),a.jsx("div",{className:`${l.overlay}`,children:!e&&a.jsx(se,{onClick:n,variant:"circle",hover:"scale",size:"clear",className:"p-2 hover:bg-[#fff]/10",children:a.jsx(Qj,{className:"w-10"})})}),e&&a.jsx("div",{className:l.playingGifFrame,children:a.jsx("img",{src:Ew,alt:""})})]})}),r&&a.jsxs("div",{className:"text-center",children:[a.jsx("h2",{className:l.title,children:(t==null?void 0:t.name)||"Some song"}),a.jsx("p",{className:"text-md opacity-50 line-clamp-1",children:t.singers.map((c,u)=>a.jsx("span",{children:c.name},u))})]})]})},Fg=h.forwardRef(cV);var bR={exports:{}},ER={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sd=h;function uV(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var dV=typeof Object.is=="function"?Object.is:uV,hV=sd.useSyncExternalStore,fV=sd.useRef,mV=sd.useEffect,pV=sd.useMemo,gV=sd.useDebugValue;ER.useSyncExternalStoreWithSelector=function(t,e,n,r,s){var i=fV(null);if(i.current===null){var o={hasValue:!1,value:null};i.current=o}else o=i.current;i=pV(function(){function c(g){if(!u){if(u=!0,d=g,g=r(g),s!==void 0&&o.hasValue){var x=o.value;if(s(x,g))return m=x}return m=g}if(x=m,dV(d,g))return x;var w=r(g);return s!==void 0&&s(x,w)?(d=g,x):(d=g,m=w)}var u=!1,d,m,p=n===void 0?null:n;return[function(){return c(e())},p===null?void 0:function(){return c(p())}]},[e,n,r,s]);var l=hV(t,i[0],i[1]);return mV(function(){o.hasValue=!0,o.value=l},[l]),gV(l),l};bR.exports=ER;var xV=bR.exports;function yV(t){t()}function vV(){let t=null,e=null;return{clear(){t=null,e=null},notify(){yV(()=>{let n=t;for(;n;)n.callback(),n=n.next})},get(){const n=[];let r=t;for(;r;)n.push(r),r=r.next;return n},subscribe(n){let r=!0;const s=e={callback:n,next:null,prev:e};return s.prev?s.prev.next=s:t=s,function(){!r||t===null||(r=!1,s.next?s.next.prev=s.prev:e=s.prev,s.prev?s.prev.next=s.next:t=s.next)}}}}var eE={notify(){},get:()=>[]};function wV(t,e){let n,r=eE,s=0,i=!1;function o(w){d();const v=r.subscribe(w);let S=!1;return()=>{S||(S=!0,v(),m())}}function l(){r.notify()}function c(){x.onStateChange&&x.onStateChange()}function u(){return i}function d(){s++,n||(n=e?e.addNestedSub(c):t.subscribe(c),r=vV())}function m(){s--,n&&s===0&&(n(),n=void 0,r.clear(),r=eE)}function p(){i||(i=!0,d())}function g(){i&&(i=!1,m())}const x={addNestedSub:o,notifyNestedSubs:l,handleChangeWrapper:c,isSubscribed:u,trySubscribe:p,tryUnsubscribe:g,getListeners:()=>r};return x}var _V=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",SV=_V(),bV=()=>typeof navigator<"u"&&navigator.product==="ReactNative",EV=bV(),kV=()=>SV||EV?h.useLayoutEffect:h.useEffect,jV=kV(),Mg=Symbol.for("react-redux-context"),Dg=typeof globalThis<"u"?globalThis:{};function TV(){if(!h.createContext)return{};const t=Dg[Mg]??(Dg[Mg]=new Map);let e=t.get(h.createContext);return e||(e=h.createContext(null),t.set(h.createContext,e)),e}var na=TV();function IV(t){const{children:e,context:n,serverState:r,store:s}=t,i=h.useMemo(()=>{const c=wV(s);return{store:s,subscription:c,getServerState:r?()=>r:void 0}},[s,r]),o=h.useMemo(()=>s.getState(),[s]);jV(()=>{const{subscription:c}=i;return c.onStateChange=c.notifyNestedSubs,c.trySubscribe(),o!==s.getState()&&c.notifyNestedSubs(),()=>{c.tryUnsubscribe(),c.onStateChange=void 0}},[i,o]);const l=n||na;return h.createElement(l.Provider,{value:i},e)}var CV=IV;function kw(t=na){return function(){return h.useContext(t)}}var kR=kw();function jR(t=na){const e=t===na?kR:kw(t),n=()=>{const{store:r}=e();return r};return Object.assign(n,{withTypes:()=>n}),n}var RV=jR();function NV(t=na){const e=t===na?RV:jR(t),n=()=>e().dispatch;return Object.assign(n,{withTypes:()=>n}),n}var on=NV(),AV=(t,e)=>t===e;function PV(t=na){const e=t===na?kR:kw(t),n=(r,s={})=>{const{equalityFn:i=AV}=typeof s=="function"?{equalityFn:s}:s,o=e(),{store:l,subscription:c,getServerState:u}=o;h.useRef(!0);const d=h.useCallback({[r.name](p){return r(p)}}[r.name],[r]),m=xV.useSyncExternalStoreWithSelector(c.addNestedSub,l.getState,u||l.getState,d,i);return h.useDebugValue(m),m};return Object.assign(n,{withTypes:()=>n}),n}var oe=PV();function Yt(t){return`Minified Redux error #${t}; visit https://redux.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var FV=(()=>typeof Symbol=="function"&&Symbol.observable||"@@observable")(),tE=FV,Lg=()=>Math.random().toString(36).substring(7).split("").join("."),MV={INIT:`@@redux/INIT${Lg()}`,REPLACE:`@@redux/REPLACE${Lg()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${Lg()}`},Af=MV;function jw(t){if(typeof t!="object"||t===null)return!1;let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e||Object.getPrototypeOf(t)===null}function TR(t,e,n){if(typeof t!="function")throw new Error(Yt(2));if(typeof e=="function"&&typeof n=="function"||typeof n=="function"&&typeof arguments[3]=="function")throw new Error(Yt(0));if(typeof e=="function"&&typeof n>"u"&&(n=e,e=void 0),typeof n<"u"){if(typeof n!="function")throw new Error(Yt(1));return n(TR)(t,e)}let r=t,s=e,i=new Map,o=i,l=0,c=!1;function u(){o===i&&(o=new Map,i.forEach((v,S)=>{o.set(S,v)}))}function d(){if(c)throw new Error(Yt(3));return s}function m(v){if(typeof v!="function")throw new Error(Yt(4));if(c)throw new Error(Yt(5));let S=!0;u();const _=l++;return o.set(_,v),function(){if(S){if(c)throw new Error(Yt(6));S=!1,u(),o.delete(_),i=null}}}function p(v){if(!jw(v))throw new Error(Yt(7));if(typeof v.type>"u")throw new Error(Yt(8));if(typeof v.type!="string")throw new Error(Yt(17));if(c)throw new Error(Yt(9));try{c=!0,s=r(s,v)}finally{c=!1}return(i=o).forEach(_=>{_()}),v}function g(v){if(typeof v!="function")throw new Error(Yt(10));r=v,p({type:Af.REPLACE})}function x(){const v=m;return{subscribe(S){if(typeof S!="object"||S===null)throw new Error(Yt(11));function _(){const I=S;I.next&&I.next(d())}return _(),{unsubscribe:v(_)}},[tE](){return this}}}return p({type:Af.INIT}),{dispatch:p,subscribe:m,getState:d,replaceReducer:g,[tE]:x}}function DV(t){Object.keys(t).forEach(e=>{const n=t[e];if(typeof n(void 0,{type:Af.INIT})>"u")throw new Error(Yt(12));if(typeof n(void 0,{type:Af.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(Yt(13))})}function LV(t){const e=Object.keys(t),n={};for(let i=0;i<e.length;i++){const o=e[i];typeof t[o]=="function"&&(n[o]=t[o])}const r=Object.keys(n);let s;try{DV(n)}catch(i){s=i}return function(o={},l){if(s)throw s;let c=!1;const u={};for(let d=0;d<r.length;d++){const m=r[d],p=n[m],g=o[m],x=p(g,l);if(typeof x>"u")throw l&&l.type,new Error(Yt(14));u[m]=x,c=c||x!==g}return c=c||r.length!==Object.keys(o).length,c?u:o}}function Pf(...t){return t.length===0?e=>e:t.length===1?t[0]:t.reduce((e,n)=>(...r)=>e(n(...r)))}function OV(...t){return e=>(n,r)=>{const s=e(n,r);let i=()=>{throw new Error(Yt(15))};const o={getState:s.getState,dispatch:(c,...u)=>i(c,...u)},l=t.map(c=>c(o));return i=Pf(...l)(s.dispatch),{...s,dispatch:i}}}function $V(t){return jw(t)&&"type"in t&&typeof t.type=="string"}var IR=Symbol.for("immer-nothing"),nE=Symbol.for("immer-draftable"),xr=Symbol.for("immer-state");function qr(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var bl=Object.getPrototypeOf;function Ya(t){return!!t&&!!t[xr]}function oi(t){var e;return t?CR(t)||Array.isArray(t)||!!t[nE]||!!((e=t.constructor)!=null&&e[nE])||Zm(t)||ep(t):!1}var zV=Object.prototype.constructor.toString();function CR(t){if(!t||typeof t!="object")return!1;const e=bl(t);if(e===null)return!0;const n=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return n===Object?!0:typeof n=="function"&&Function.toString.call(n)===zV}function Ff(t,e){Jm(t)===0?Reflect.ownKeys(t).forEach(n=>{e(n,t[n],t)}):t.forEach((n,r)=>e(r,n,t))}function Jm(t){const e=t[xr];return e?e.type_:Array.isArray(t)?1:Zm(t)?2:ep(t)?3:0}function Dx(t,e){return Jm(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function RR(t,e,n){const r=Jm(t);r===2?t.set(e,n):r===3?t.add(n):t[e]=n}function BV(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}function Zm(t){return t instanceof Map}function ep(t){return t instanceof Set}function Ea(t){return t.copy_||t.base_}function Lx(t,e){if(Zm(t))return new Map(t);if(ep(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const n=CR(t);if(e===!0||e==="class_only"&&!n){const r=Object.getOwnPropertyDescriptors(t);delete r[xr];let s=Reflect.ownKeys(r);for(let i=0;i<s.length;i++){const o=s[i],l=r[o];l.writable===!1&&(l.writable=!0,l.configurable=!0),(l.get||l.set)&&(r[o]={configurable:!0,writable:!0,enumerable:l.enumerable,value:t[o]})}return Object.create(bl(t),r)}else{const r=bl(t);if(r!==null&&n)return{...t};const s=Object.create(r);return Object.assign(s,t)}}function Tw(t,e=!1){return tp(t)||Ya(t)||!oi(t)||(Jm(t)>1&&(t.set=t.add=t.clear=t.delete=VV),Object.freeze(t),e&&Object.entries(t).forEach(([n,r])=>Tw(r,!0))),t}function VV(){qr(2)}function tp(t){return Object.isFrozen(t)}var UV={};function Ja(t){const e=UV[t];return e||qr(0,t),e}var yu;function NR(){return yu}function HV(t,e){return{drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function rE(t,e){e&&(Ja("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function Ox(t){$x(t),t.drafts_.forEach(GV),t.drafts_=null}function $x(t){t===yu&&(yu=t.parent_)}function sE(t){return yu=HV(yu,t)}function GV(t){const e=t[xr];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function iE(t,e){e.unfinalizedDrafts_=e.drafts_.length;const n=e.drafts_[0];return t!==void 0&&t!==n?(n[xr].modified_&&(Ox(e),qr(4)),oi(t)&&(t=Mf(e,t),e.parent_||Df(e,t)),e.patches_&&Ja("Patches").generateReplacementPatches_(n[xr].base_,t,e.patches_,e.inversePatches_)):t=Mf(e,n,[]),Ox(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==IR?t:void 0}function Mf(t,e,n){if(tp(e))return e;const r=e[xr];if(!r)return Ff(e,(s,i)=>aE(t,r,e,s,i,n)),e;if(r.scope_!==t)return e;if(!r.modified_)return Df(t,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const s=r.copy_;let i=s,o=!1;r.type_===3&&(i=new Set(s),s.clear(),o=!0),Ff(i,(l,c)=>aE(t,r,s,l,c,n,o)),Df(t,s,!1),n&&t.patches_&&Ja("Patches").generatePatches_(r,n,t.patches_,t.inversePatches_)}return r.copy_}function aE(t,e,n,r,s,i,o){if(Ya(s)){const l=i&&e&&e.type_!==3&&!Dx(e.assigned_,r)?i.concat(r):void 0,c=Mf(t,s,l);if(RR(n,r,c),Ya(c))t.canAutoFreeze_=!1;else return}else o&&n.add(s);if(oi(s)&&!tp(s)){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1)return;Mf(t,s),(!e||!e.scope_.parent_)&&typeof r!="symbol"&&Object.prototype.propertyIsEnumerable.call(n,r)&&Df(t,s)}}function Df(t,e,n=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&Tw(e,n)}function WV(t,e){const n=Array.isArray(t),r={type_:n?1:0,scope_:e?e.scope_:NR(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let s=r,i=Iw;n&&(s=[r],i=vu);const{revoke:o,proxy:l}=Proxy.revocable(s,i);return r.draft_=l,r.revoke_=o,l}var Iw={get(t,e){if(e===xr)return t;const n=Ea(t);if(!Dx(n,e))return qV(t,n,e);const r=n[e];return t.finalized_||!oi(r)?r:r===Og(t.base_,e)?($g(t),t.copy_[e]=Bx(r,t)):r},has(t,e){return e in Ea(t)},ownKeys(t){return Reflect.ownKeys(Ea(t))},set(t,e,n){const r=AR(Ea(t),e);if(r!=null&&r.set)return r.set.call(t.draft_,n),!0;if(!t.modified_){const s=Og(Ea(t),e),i=s==null?void 0:s[xr];if(i&&i.base_===n)return t.copy_[e]=n,t.assigned_[e]=!1,!0;if(BV(n,s)&&(n!==void 0||Dx(t.base_,e)))return!0;$g(t),zx(t)}return t.copy_[e]===n&&(n!==void 0||e in t.copy_)||Number.isNaN(n)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=n,t.assigned_[e]=!0),!0},deleteProperty(t,e){return Og(t.base_,e)!==void 0||e in t.base_?(t.assigned_[e]=!1,$g(t),zx(t)):delete t.assigned_[e],t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const n=Ea(t),r=Reflect.getOwnPropertyDescriptor(n,e);return r&&{writable:!0,configurable:t.type_!==1||e!=="length",enumerable:r.enumerable,value:n[e]}},defineProperty(){qr(11)},getPrototypeOf(t){return bl(t.base_)},setPrototypeOf(){qr(12)}},vu={};Ff(Iw,(t,e)=>{vu[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});vu.deleteProperty=function(t,e){return vu.set.call(this,t,e,void 0)};vu.set=function(t,e,n){return Iw.set.call(this,t[0],e,n,t[0])};function Og(t,e){const n=t[xr];return(n?Ea(n):t)[e]}function qV(t,e,n){var s;const r=AR(e,n);return r?"value"in r?r.value:(s=r.get)==null?void 0:s.call(t.draft_):void 0}function AR(t,e){if(!(e in t))return;let n=bl(t);for(;n;){const r=Object.getOwnPropertyDescriptor(n,e);if(r)return r;n=bl(n)}}function zx(t){t.modified_||(t.modified_=!0,t.parent_&&zx(t.parent_))}function $g(t){t.copy_||(t.copy_=Lx(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var KV=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,n,r)=>{if(typeof e=="function"&&typeof n!="function"){const i=n;n=e;const o=this;return function(c=i,...u){return o.produce(c,d=>n.call(this,d,...u))}}typeof n!="function"&&qr(6),r!==void 0&&typeof r!="function"&&qr(7);let s;if(oi(e)){const i=sE(this),o=Bx(e,void 0);let l=!0;try{s=n(o),l=!1}finally{l?Ox(i):$x(i)}return rE(i,r),iE(s,i)}else if(!e||typeof e!="object"){if(s=n(e),s===void 0&&(s=e),s===IR&&(s=void 0),this.autoFreeze_&&Tw(s,!0),r){const i=[],o=[];Ja("Patches").generateReplacementPatches_(e,s,i,o),r(i,o)}return s}else qr(1,e)},this.produceWithPatches=(e,n)=>{if(typeof e=="function")return(o,...l)=>this.produceWithPatches(o,c=>e(c,...l));let r,s;return[this.produce(e,n,(o,l)=>{r=o,s=l}),r,s]},typeof(t==null?void 0:t.autoFreeze)=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof(t==null?void 0:t.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy)}createDraft(t){oi(t)||qr(8),Ya(t)&&(t=QV(t));const e=sE(this),n=Bx(t,void 0);return n[xr].isManual_=!0,$x(e),n}finishDraft(t,e){const n=t&&t[xr];(!n||!n.isManual_)&&qr(9);const{scope_:r}=n;return rE(r,e),iE(void 0,r)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}applyPatches(t,e){let n;for(n=e.length-1;n>=0;n--){const s=e[n];if(s.path.length===0&&s.op==="replace"){t=s.value;break}}n>-1&&(e=e.slice(n+1));const r=Ja("Patches").applyPatches_;return Ya(t)?r(t,e):this.produce(t,s=>r(s,e))}};function Bx(t,e){const n=Zm(t)?Ja("MapSet").proxyMap_(t,e):ep(t)?Ja("MapSet").proxySet_(t,e):WV(t,e);return(e?e.scope_:NR()).drafts_.push(n),n}function QV(t){return Ya(t)||qr(10,t),PR(t)}function PR(t){if(!oi(t)||tp(t))return t;const e=t[xr];let n;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,n=Lx(t,e.scope_.immer_.useStrictShallowCopy_)}else n=Lx(t,!0);return Ff(n,(r,s)=>{RR(n,r,PR(s))}),e&&(e.finalized_=!1),n}var yr=new KV,FR=yr.produce;yr.produceWithPatches.bind(yr);yr.setAutoFreeze.bind(yr);yr.setUseStrictShallowCopy.bind(yr);yr.applyPatches.bind(yr);yr.createDraft.bind(yr);yr.finishDraft.bind(yr);function MR(t){return({dispatch:n,getState:r})=>s=>i=>typeof i=="function"?i(n,r,t):s(i)}var XV=MR(),YV=MR,JV=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?Pf:Pf.apply(null,arguments)};function oE(t,e){function n(...r){if(e){let s=e(...r);if(!s)throw new Error(Xs(0));return{type:t,payload:s.payload,..."meta"in s&&{meta:s.meta},..."error"in s&&{error:s.error}}}return{type:t,payload:r[0]}}return n.toString=()=>`${t}`,n.type=t,n.match=r=>$V(r)&&r.type===t,n}var DR=class Tc extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,Tc.prototype)}static get[Symbol.species](){return Tc}concat(...e){return super.concat.apply(this,e)}prepend(...e){return e.length===1&&Array.isArray(e[0])?new Tc(...e[0].concat(this)):new Tc(...e.concat(this))}};function lE(t){return oi(t)?FR(t,()=>{}):t}function cE(t,e,n){return t.has(e)?t.get(e):t.set(e,n(e)).get(e)}function ZV(t){return typeof t=="boolean"}var eU=()=>function(e){const{thunk:n=!0,immutableCheck:r=!0,serializableCheck:s=!0,actionCreatorCheck:i=!0}=e??{};let o=new DR;return n&&(ZV(n)?o.push(XV):o.push(YV(n.extraArgument))),o},tU="RTK_autoBatch",uE=t=>e=>{setTimeout(e,t)},nU=(t={type:"raf"})=>e=>(...n)=>{const r=e(...n);let s=!0,i=!1,o=!1;const l=new Set,c=t.type==="tick"?queueMicrotask:t.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:uE(10):t.type==="callback"?t.queueNotification:uE(t.timeout),u=()=>{o=!1,i&&(i=!1,l.forEach(d=>d()))};return Object.assign({},r,{subscribe(d){const m=()=>s&&d(),p=r.subscribe(m);return l.add(d),()=>{p(),l.delete(d)}},dispatch(d){var m;try{return s=!((m=d==null?void 0:d.meta)!=null&&m[tU]),i=!s,i&&(o||(o=!0,c(u))),r.dispatch(d)}finally{s=!0}}})},rU=t=>function(n){const{autoBatch:r=!0}=n??{};let s=new DR(t);return r&&s.push(nU(typeof r=="object"?r:void 0)),s};function sU(t){const e=eU(),{reducer:n=void 0,middleware:r,devTools:s=!0,preloadedState:i=void 0,enhancers:o=void 0}=t||{};let l;if(typeof n=="function")l=n;else if(jw(n))l=LV(n);else throw new Error(Xs(1));let c;typeof r=="function"?c=r(e):c=e();let u=Pf;s&&(u=JV({trace:!1,...typeof s=="object"&&s}));const d=OV(...c),m=rU(d);let p=typeof o=="function"?o(m):m();const g=u(...p);return TR(l,i,g)}function LR(t){const e={},n=[];let r;const s={addCase(i,o){const l=typeof i=="string"?i:i.type;if(!l)throw new Error(Xs(28));if(l in e)throw new Error(Xs(29));return e[l]=o,s},addMatcher(i,o){return n.push({matcher:i,reducer:o}),s},addDefaultCase(i){return r=i,s}};return t(s),[e,n,r]}function iU(t){return typeof t=="function"}function aU(t,e){let[n,r,s]=LR(e),i;if(iU(t))i=()=>lE(t());else{const l=lE(t);i=()=>l}function o(l=i(),c){let u=[n[c.type],...r.filter(({matcher:d})=>d(c)).map(({reducer:d})=>d)];return u.filter(d=>!!d).length===0&&(u=[s]),u.reduce((d,m)=>{if(m)if(Ya(d)){const g=m(d,c);return g===void 0?d:g}else{if(oi(d))return FR(d,p=>m(p,c));{const p=m(d,c);if(p===void 0){if(d===null)return d;throw Error("A case reducer on a non-draftable value must not return undefined")}return p}}return d},l)}return o.getInitialState=i,o}var oU=Symbol.for("rtk-slice-createasyncthunk");function lU(t,e){return`${t}/${e}`}function cU({creators:t}={}){var n;const e=(n=t==null?void 0:t.asyncThunk)==null?void 0:n[oU];return function(s){const{name:i,reducerPath:o=i}=s;if(!i)throw new Error(Xs(11));typeof process<"u";const l=(typeof s.reducers=="function"?s.reducers(dU()):s.reducers)||{},c=Object.keys(l),u={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},d={addCase(E,I){const P=typeof E=="string"?E:E.type;if(!P)throw new Error(Xs(12));if(P in u.sliceCaseReducersByType)throw new Error(Xs(13));return u.sliceCaseReducersByType[P]=I,d},addMatcher(E,I){return u.sliceMatchers.push({matcher:E,reducer:I}),d},exposeAction(E,I){return u.actionCreators[E]=I,d},exposeCaseReducer(E,I){return u.sliceCaseReducersByName[E]=I,d}};c.forEach(E=>{const I=l[E],P={reducerName:E,type:lU(i,E),createNotation:typeof s.reducers=="function"};fU(I)?pU(P,I,d,e):hU(P,I,d)});function m(){const[E={},I=[],P=void 0]=typeof s.extraReducers=="function"?LR(s.extraReducers):[s.extraReducers],F={...E,...u.sliceCaseReducersByType};return aU(s.initialState,j=>{for(let k in F)j.addCase(k,F[k]);for(let k of u.sliceMatchers)j.addMatcher(k.matcher,k.reducer);for(let k of I)j.addMatcher(k.matcher,k.reducer);P&&j.addDefaultCase(P)})}const p=E=>E,g=new Map;let x;function w(E,I){return x||(x=m()),x(E,I)}function v(){return x||(x=m()),x.getInitialState()}function S(E,I=!1){function P(j){let k=j[E];return typeof k>"u"&&I&&(k=v()),k}function F(j=p){const k=cE(g,I,()=>new WeakMap);return cE(k,j,()=>{const C={};for(const[R,N]of Object.entries(s.selectors??{}))C[R]=uU(N,j,v,I);return C})}return{reducerPath:E,getSelectors:F,get selectors(){return F(P)},selectSlice:P}}const _={name:i,reducer:w,actions:u.actionCreators,caseReducers:u.sliceCaseReducersByName,getInitialState:v,...S(o),injectInto(E,{reducerPath:I,...P}={}){const F=I??o;return E.inject({reducerPath:F,reducer:w},P),{..._,...S(F,!0)}}};return _}}function uU(t,e,n,r){function s(i,...o){let l=e(i);return typeof l>"u"&&r&&(l=n()),t(l,...o)}return s.unwrapped=t,s}var Cw=cU();function dU(){function t(e,n){return{_reducerDefinitionType:"asyncThunk",payloadCreator:e,...n}}return t.withTypes=()=>t,{reducer(e){return Object.assign({[e.name](...n){return e(...n)}}[e.name],{_reducerDefinitionType:"reducer"})},preparedReducer(e,n){return{_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:n}},asyncThunk:t}}function hU({type:t,reducerName:e,createNotation:n},r,s){let i,o;if("reducer"in r){if(n&&!mU(r))throw new Error(Xs(17));i=r.reducer,o=r.prepare}else i=r;s.addCase(t,i).exposeCaseReducer(e,i).exposeAction(e,o?oE(t,o):oE(t))}function fU(t){return t._reducerDefinitionType==="asyncThunk"}function mU(t){return t._reducerDefinitionType==="reducerWithPrepare"}function pU({type:t,reducerName:e},n,r,s){if(!s)throw new Error(Xs(18));const{payloadCreator:i,fulfilled:o,pending:l,rejected:c,settled:u,options:d}=n,m=s(t,i,d);r.exposeAction(e,m),o&&r.addCase(m.fulfilled,o),l&&r.addCase(m.pending,l),c&&r.addCase(m.rejected,c),u&&r.addMatcher(m.settled,u),r.exposeCaseReducer(e,{fulfilled:o||Qd,pending:l||Qd,rejected:c||Qd,settled:u||Qd})}function Qd(){}function Xs(t){return`Minified Redux Toolkit error #${t}; visit https://redux-toolkit.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}const dE={queueSongs:It().queue||[],currentQueueId:null,currentSongData:null,isFetching:!1};function zg(t){for(let e=0;e<t.queueSongs.length;e++){const n=t.queueSongs[e];if(n.queue_id===t.currentQueueId){t.currentSongData={song:n,index:e};return}}t.currentSongData=null}const OR=Cw({name:"songQueue",initialState:dE,reducers:{setQueue(t,e){const n=e.payload.songs;t.queueSongs=n,zg(t),rt("queue",n)},setCurrentQueueId(t,e){const n=e.payload;t.currentQueueId=n,zg(t)},removeSongFromQueue(t,e){const{index:n}=e.payload;t.queueSongs.splice(n,1),rt("queue",t.queueSongs),t.currentSongData&&n<=t.currentSongData.index&&zg(t)},setIsFetchingRecommend(t,e){t.isFetching=e.payload},addSongToQueue:(t,e)=>{const n=e.payload.songs;t.queueSongs.push(...n),t.isFetching=!1,rt("queue",t.queueSongs)},resetSongQueue:t=>{rt("queue",[]),Object.assign(t,{...dE,queueSongs:[]})}}}),We=t=>t.songQueue,{addSongToQueue:np,setCurrentQueueId:Is,removeSongFromQueue:gU,setQueue:xU,resetSongQueue:yU,setIsFetchingRecommend:vU}=OR.actions,wU=OR.reducer;function Hl({className:t="",playlists:e,loading:n,skeNumber:r=2,whenEmpty:s}){const{currentSongData:i}=oe(We),o=()=>e.length?e.map((l,c)=>{const u=i==null?void 0:i.song.queue_id.includes(l.id);return a.jsx(Nf,{variant:"link",active:u,data:l},c)}):s||a.jsx(Re,{variant:"less",className:"mx-auto"});return a.jsx(a.Fragment,{children:a.jsxs("div",{className:`${!n&&!e.length?"":"flex flex-row flex-wrap -mx-3"} ${t}`,children:[n&&[...Array(r).keys()].map(l=>a.jsx(Nf,{variant:"skeleton"},l)),!n&&o()]})})}function $R(){const{playerConfig:{isCrossFade:t,songImage:e,isEnableBeat:n,lyricSize:r,songBackground:s},updatePlayerConfig:i,audioRef:o,shouldSyncSongDuration:l}=ut(),{currentSongData:c}=oe(We),u=g=>{i({lyricSize:g}),rt("lyricSize",g)},d=()=>{if(!o.current||!(c!=null&&c.song))return;const g=!n,x=o.current.currentTime;rt("current_time",x),l.current=!0,o.current.src=g?c.song.beat_url:c.song.song_url,i({isEnableBeat:g})},m=g=>g===r?"bg-[--primary-cl]":"bg-[--a-5-cl]",p={disableBtn:"bg-white/10 bg-opacity-20",lyricSizeBtn:"justify-center rounded-full hover:bg-[--a-10-cl]  font-[600] h-[30px] w-[30px] sm:h-[26px] sm:w-[26px] relative",itemContainer:"justify-between min-h-[30px]",text:"text-sm"};return a.jsx(a.Fragment,{children:a.jsx(er,{colorClasses:"bg-[#333] text-white",className:"w-[240px] sm:w-[290px]",children:a.jsxs(Or,{dismiss:!1,children:[a.jsxs("div",{className:`${p.itemContainer}`,children:[a.jsx("p",{className:p.text,children:"Lyric size"}),a.jsxs("div",{className:"flex space-x-[8px]",children:[a.jsx("button",{onClick:()=>u("small"),className:`${m("small")} ${p.lyricSizeBtn}`,children:a.jsx("span",{className:"leading-[1] text-[11px]",children:"A"})}),a.jsx("button",{onClick:()=>u("medium"),className:`${m("medium")} ${p.lyricSizeBtn}`,children:a.jsx("span",{className:"leading-[1] text-[13px]",children:"A"})}),a.jsx("button",{onClick:()=>u("large"),className:`${m("large")} ${p.lyricSizeBtn}`,children:a.jsx("span",{className:"leading-[1] text-[15px]",children:"A"})})]})]}),a.jsxs("div",{className:`${p.itemContainer}`,children:[a.jsx("p",{className:p.text,children:"Background"}),a.jsx(Ho,{size:"thin",active:s,cb:()=>i({songBackground:!s})})]}),a.jsxs("div",{className:`${p.itemContainer}`,children:[a.jsx("p",{className:p.text,children:"Song image"}),a.jsx(Ho,{size:"thin",active:e,cb:()=>i({songImage:!e})})]}),(c==null?void 0:c.song.beat_url)&&a.jsxs("div",{className:`${p.itemContainer}`,children:[a.jsx("p",{className:p.text,children:"Instrumental"}),a.jsx(Ho,{size:"thin",active:n,cb:d})]}),a.jsxs("div",{className:`${p.itemContainer}`,children:[a.jsx("p",{className:p.text,children:"Cross fade"}),a.jsx(Ho,{size:"thin",active:t,cb:()=>i({isCrossFade:!t})})]})]})})})}function _U({children:t,className:e="px-2 py-1 text-sm font-[500]",position:n="bottom-[calc(100%+8px)]",content:r,colorClasses:s="bg-[--popup-cl] text-[--text-cl]",isWrapped:i,...o},l){const[c,u]=h.useState(!1),{setTriggerRef:d,state:m}=Ul(),{onClick:p}=o,g=h.useRef(null),x=()=>{"ontouchstart"in document.documentElement||u(!0)},w=()=>{u(!1)};h.useEffect(()=>{const _=g.current;if(_)return d&&d(_),_.addEventListener("mouseenter",x),_.addEventListener("mouseleave",w),()=>{_.removeEventListener("mouseenter",x),_.removeEventListener("mouseleave",w)}},[]);const v={container:" shadow-[0_0_6px_0_rgba(0,0,0,.15)] font-semibold absolute whitespace-nowrap -translate-x-1/2 left-1/2 rounded-md z-[999]"},S=a.jsx(a.Fragment,{children:h.isValidElement(t)&&a.jsxs(a.Fragment,{children:[Object.keys(o).length?h.cloneElement(t,{ref:g,onClick:p}):h.cloneElement(t,{ref:g}),!(m!=null&&m.isOpen)&&c&&a.jsx("div",{className:`${v.container} ${s} ${n} ${e}`,children:r})]})});if(h.isValidElement(t))return a.jsx(a.Fragment,{children:i?S:a.jsx("div",{className:"relative",children:S})})}const Ys=h.forwardRef(_U);function Rw(){const{setSuccessToast:t}=te(),e=()=>{navigator.clipboard.writeText(location.href),t("Link copied")};return a.jsxs("button",{onClick:e,children:[a.jsx(JF,{}),a.jsx("span",{children:"Copy link"})]})}function hE(t){return a.jsxs("div",{className:"p-3",children:[t.variant==="skeleton"&&a.jsxs(a.Fragment,{children:[a.jsx(ge,{className:"pt-[100%] rounded-full"}),a.jsx(ge,{className:"mt-1 w-full h-[24px]"})]}),t.variant==="singer-item"&&a.jsxs(a.Fragment,{children:[a.jsx(X,{to:`/singer/${t.singer.id}`,children:a.jsx("div",{className:"aspect-[1/1] rounded-full overflow-hidden",children:a.jsx(Ce,{blurHashEncode:t.singer.blurhash_encode,src:t.singer.image_url,className:"hover:scale-[1.05] transition-transform"})})}),a.jsx("p",{className:"mt-1 font-medium text-center",children:t.singer.name})]})]})}const Nw=(t,e)=>{const{color:n="var(--primary-cl)",baseColor:r="var(--a-10-cl)"}=e||{};return`linear-gradient(to right, ${n} ${t}%, ${r} ${t}%, ${r}`};function rp({audioEle:t,baseColor:e,color:n,setStatusFromParent:r,statusFromParent:s,statusRefFromParent:i}){const[o,l]=h.useState("paused"),[c,u]=h.useState(!1),d=s||o,m=r||l,p=h.useRef(d),g=h.useRef(null),x=h.useRef(null),w=h.useRef(null),v=i||p,S=()=>{try{t.play(),u(!0)}catch{}},_=()=>{t==null||t.pause(),P()},E=()=>{d==="playing"?_():d==="paused"&&S()},I=()=>{m("playing")},P=()=>{m("paused")},F=()=>{m("paused"),w.current&&(w.current.innerText=ea(t.duration))},j=fe=>{if(!t)return;const Le=+(fe||t.currentTime/t.duration*100).toFixed(1);x.current&&(x.current.innerText=ea(t.currentTime)),g!=null&&g.current&&(g.current.style.background=Nw(Le,{color:n,baseColor:e}))},k=()=>{const Le=t.currentTime/(t.duration/100);j(+Le.toFixed(1))},C=()=>{console.log("error"),m("error")},R=fe=>{const Le=fe.target;if(g!=null&&g.current){const de=Le.getBoundingClientRect(),V=(fe.clientX-de.left)/g.current.offsetWidth,J=Math.round(V*t.duration);N(J)}},N=fe=>{t.currentTime=fe,j(),d!=="playing"&&S()},M=fe=>{t.currentTime=t.currentTime+fe},A=fe=>{t.currentTime=t.currentTime-fe};return h.useEffect(()=>{if(t)return t.addEventListener("error",C),t.addEventListener("pause",P),t.addEventListener("playing",I),t.addEventListener("loadedmetadata",F),g!=null&&g.current&&(g==null||g.current.addEventListener("click",R),t.addEventListener("timeupdate",k)),()=>{t.removeEventListener("error",C),t.removeEventListener("pause",P),t.removeEventListener("playing",I),t.removeEventListener("loadedmetadata",F),g!=null&&g.current&&(t.removeEventListener("timeupdate",k),g==null||g.current.removeEventListener("click",R))}},[t]),h.useEffect(()=>{v.current=d},[d]),{play:S,pause:_,seek:N,handlePlayPause:E,status:d,forward:M,backward:A,isClickPlay:c,statusRef:p,progressLineRef:g,currentTimeRef:x,durationRef:w}}const SU=()=>({playStatus:"paused",isLoaded:!0,countDown:0}),zR=Cw({name:"playStatus",initialState:()=>SU(),reducers:{setPlayStatus(t,e){Object.assign(t,e.payload)}}}),Un=t=>t.playStatus,{setPlayStatus:Zt}=zR.actions,bU=zR.reducer;function _r({variant:t}){const e=on(),{currentQueueId:n,queueSongs:r,currentSongData:s}=oe(We),i=h.useMemo(()=>{switch(t){default:return"queue_id"}},[]);return{handleSetSong:(l,c)=>{if(n!==l){e(Is(l)),e(Zt({playStatus:"loading"}));const u=r.map(m=>m[i]);if(!r.length||r.length!==c.length||!!c.find(m=>!u.includes(m[i])))return console.log("set queue"),e(xU({songs:c})),!0}return!1},currentSongData:s,queueSongs:r,currentQueueId:n}}function BR(t,e){const[n,r]=h.useState(t);return h.useEffect(()=>{if(!t){r("");return}const s=setTimeout(()=>{r(t)},e);return()=>{clearTimeout(s)}},[t]),n}const Aw={isDev:!1,focusDelay:3e3,scrollSongDelay:4e3,loadingDuration:200};function fE(t,e){const n=h.useRef(),[r,s]=h.useState(0),[i,o]=h.useState(0);return h.useEffect(()=>{r&&(n.current=setTimeout(()=>n.current=void 0,e))},[i,Aw]),h.useEffect(()=>{n.current||(t(),o(Math.random()*10))},[r]),()=>s(Math.random()*10)}const EU="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let po=(t=21)=>{let e="",n=crypto.getRandomValues(new Uint8Array(t|=0));for(;t--;)e+=EU[n[t]&63];return e};const Bg={currentPlaylist:null,playlistSongs:[]},VR=Cw({name:"currentPlaylist",initialState:Bg,reducers:{setCurrentPlaylist(t,e){const{playlist:n,songs:r}=e.payload;t.currentPlaylist=n,t.playlistSongs=r},updateCurrentPlaylist:(t,e)=>{if(!t.currentPlaylist)return t;Object.assign(t.currentPlaylist,e.payload)},addSongsToPlaylist(t,e){if(!t.currentPlaylist)return t;const n=e.payload.map(r=>({...r,song_in:`playlist_${t.currentPlaylist.id}`,queue_id:po(4)}));t.playlistSongs.push(...n)},setPlaylistSong(t,e){t.playlistSongs=e.payload},removeSong(t,e){const{index:n}=e.payload;t.playlistSongs.splice(n,1)},resetCurrentPlaylist:t=>{t.currentPlaylist=Bg.currentPlaylist,t.playlistSongs=Bg.playlistSongs}}}),ha=t=>t.currentPlaylist,{addSongsToPlaylist:gZ,removeSong:xZ,setCurrentPlaylist:kU,updateCurrentPlaylist:jU,resetCurrentPlaylist:TU,setPlaylistSong:IU}=VR.actions,CU=VR.reducer;function RU(){const t=on(),{setErrorToast:e}=te(),{user:n,loading:r}=xe(),s=ci(),[i,o]=h.useState(!0),l=async()=>{if(!s.id)return;const d=await Wt({collectionName:"Playlists",id:s.id,msg:">>> api get playlist"});if(d.exists())return{...d.data(),id:d.id}},c=async d=>{if(!d.song_ids.length)return[];const m=le(_t,Q(Lr(),"in",d.song_ids)),p=await bt(m);return p.docs.length?p.docs.map(x=>({id:x.id,...x.data(),queue_id:`${po(4)}_${d.id}}`})):[]},u=async()=>{try{if(!s.id)return;o(!0);const d=await l();if(!d||!(n?d.owner_email===n.email&&!d.is_official:!1)&&!d.is_public)return;const p=await c(d);t(kU({playlist:d,songs:p}))}catch(d){console.log({message:d}),e()}finally{o(!1)}};return h.useEffect(()=>{if(!r)return u(),()=>{t(TU())}},[r]),{isFetching:i}}function UR({setLoadingFromParent:t}){const[e,n]=h.useState(!1),r=t||n;return{getLyric:async i=>{try{if(!i.id)return;r(!0);const o=await Wt({collectionName:"Lyrics",id:i.lyric_id,msg:"useGetLyric, get lyric"});if(o.exists())return o.data()}catch(o){console.log({message:o})}finally{r(!1)}},loading:e}}function HR(){const t=on(),{setSuccessToast:e}=te();return{action:r=>{switch(r.variant){case"add":const s=r.songs.map(i=>({...i,queue_id:po(4)}));t(np({songs:s})),e("Song added to queue");break;case"remove":t(gU({index:r.index}))}}}}const NU=async t=>{const e=Date.now(),n=await qu.post("/image/encode",t);let r="";n&&(r=n.data.data.encode);const s=(Date.now()-e)/1e3;return console.log(">>> api: get blurHash encode finished after",s),{encode:r}},AU=async(t,e)=>{const n=new FormData;n.append("file",t);const r=Date.now(),s=await qu.post("/image/optimize",n,{responseType:"blob",params:e});let i;s&&(i=s.data);const o=(Date.now()-r)/1e3;return console.log(">>> api: optimize finished after",o),i};async function $t(t,e){const n=await bt(t);return n.docs?n.docs.map(s=>{const i={...s.data(),id:s.id,queue_id:po(4)};return e!=null&&e.getQueueId&&(i.queue_id=e.getQueueId(i)),i}):[]}async function Ln(t,e){const n=await bt(t);return n.docs.length?n.docs.map(s=>({...s.data(),id:s.id})):[]}async function wu(t){const e=await bt(t);return e.docs.length?e.docs.map(r=>({...r.data(),id:r.id})):[]}const pi=async({imageFile:t,blob:e,...n})=>{let r=e;if(t&&(r=await AU(t,n)),!r)throw new Error("File not found");const s=new File([r],"image.jpeg",{type:r.type}),i=ed({file:s,folder:"/images/"}),{encode:o}=await NU(r),{fileId:l,url:c}=await i;return{image_file_id:l,image_url:c,blurhash_encode:o}};function Pw(t){const{setOwnPlaylists:e}=it(),{setErrorToast:n}=te(),[r,s]=h.useState(!1),i=(t==null?void 0:t.setIsFetching)||s;return{isFetching:r,addPlaylist:async({imageFile:l,...c},u)=>{var d,m;try{if(i(!0),l){const p=await pi({imageFile:l});Object.assign(c.playlist,p),c.playlist.image_file_id&&Gt({fileId:c.playlist.image_file_id})}switch(c.variant){case"add":const p={...c.playlist,name:c.playlist.name.trim(),meta:bn(c.playlist.name.trim()).split(" ")},g=await Ts({collectionName:"Playlists",data:p,msg:">>> Add playlist doc"}),x=await _l(g),w={...x.data(),id:x.id},{push:v=!0}=u||{};return v&&e(S=>[...S,w]),w;case"edit":{console.log(c.playlist);const S={...c.playlist,name:(d=c.playlist.name)==null?void 0:d.trim(),meta:bn(((m=c.playlist.name)==null?void 0:m.trim())||"").split(" "),updated_at:mt()};return await Se({collectionName:"Playlists",data:S,id:c.id,msg:">>> Update playlist doc"}),!0}}}catch(p){console.log(p),n()}finally{i(!1)}}}}function sp(t){const{setIsFetchingFromParent:e}=t||{},[n,r]=h.useState(!0),{setErrorToast:s}=te(),i=e||r;return{fetchComment:async({target_id:l,comment_id:c})=>{try{i(!0);const u=l?le(Xa,Q("target_id","==",l),Lt("created_at","desc")):le(Xa,Q("comment_id","==",c),Lt("created_at","desc")),d=await bt(u);if(d.docs.length)return d.docs.map(p=>({...p.data(),id:p.id,replies:[]}))}catch(u){console.log(u),s()}finally{i(!1)}},isFetching:n}}function PU({audioEle:t}){const e=Zn(),n=h.useMemo(()=>e.pathname.includes("lyric")||e.pathname==="/",[e]);return h.useEffect(()=>{n&&t.pause()},[e]),{shouldHide:n}}function GR({setCategory:t}){const[e,n]=h.useState(!0),r=h.useRef(!1),{id:s}=ci(),i=async()=>{try{if(!s)return;n(!0);const o=await Wt({collectionName:"Categories",id:s});if(o.exists()){const l={...o.data(),id:s};t(l)}}catch(o){console.log(o)}finally{n(!1)}};return h.useEffect(()=>{r.current||(r.current=!0,i())},[]),{isFetching:e}}function WR({setSongs:t,songIds:e}){const[n,r]=h.useState(!1),s=h.useRef(!1),i=async()=>{try{if(!e.length)return;r(!0);const o=le(St(ie,"Songs"),Q(Lr(),"in",e)),l=await $t(o);t(l)}catch(o){console.log(o)}finally{r(!1)}};return h.useEffect(()=>{s.current||(s.current=!0,i())},[]),{isFetching:n}}function Fw({setPlaylists:t,playlistIds:e}){const[n,r]=h.useState(!0),s=h.useRef(!1),i=async()=>{try{if(!e.length)return;r(!0);const o=le(St(ie,"Playlists"),Q(Lr(),"in",e)),l=await Ln(o);t(l)}catch(o){console.log(o)}finally{r(!1)}};return h.useEffect(()=>{s.current||(s.current=!0,i())},[]),{isFetching:n}}function qR({isOpenLyricTabs:t,children:e}){const{currentSongData:n}=oe(We),{playStatus:r}=oe(Un),{setLoading:s,shouldGetLyric:i,setSongLyrics:o}=lw(),l=h.useRef(),{getLyric:c}=UR({setLoadingFromParent:s}),u=async m=>{if(m.lyric_id){const p=await c(m);p&&o(JSON.parse(p==null?void 0:p.lyrics))}else await Jn(300),s(!1)},d=()=>{clearTimeout(l.current),i.current=!0,s(!0),o([])};return h.useEffect(()=>{if(t&&(n!=null&&n.song)&&i.current){if(i.current=!1,r==="error"){s(!1);return}l.current=setTimeout(()=>u(n.song),500)}},[t,n==null?void 0:n.song.id,r]),h.useEffect(()=>()=>{d()},[n==null?void 0:n.song.id]),e}function FU(){const{user:t}=xe(),[e,n]=h.useState([]),[r,s]=h.useState(!0);return{isFetching:r,recentPlaylists:e,getRecentPlaylist:async()=>{try{if(t){if(t.recent_playlist_ids.length){const o=le(vn,Q(Lr(),"in",t.recent_playlist_ids)),l=await Ln(o);n(l)}}else{const o=It()["recent-playlists"]||[];n(o)}}catch(o){console.log({message:o})}finally{s(!1)}}}}function MU(){const{currentSongData:t}=oe(We),e=h.useRef(!1),{isFetching:n,getRecentPlaylist:r,recentPlaylists:s}=FU();h.useEffect(()=>{e.current||(e.current=!0,r())},[]);const i=()=>s.map((o,l)=>{const c=t==null?void 0:t.song.queue_id.includes(o.id);return a.jsx(Nf,{variant:"link",active:c,data:o},l)});return n?a.jsx("div",{className:"flex flex-row flex-wrap -mx-3 ",children:eV}):s.length?a.jsx(a.Fragment,{children:a.jsxs("div",{children:[a.jsx(ee,{title:"Recent listening"}),a.jsx("div",{className:"flex flex-row flex-wrap -mx-3 ",children:i()})]})}):a.jsx(a.Fragment,{})}function id(){const{user:t}=xe(),[e,n]=h.useState(!1);return{isFetching:e,action:async s=>{try{switch(n(!0),s){case"login":{await RB(ai,b8);break}case"logout":{await WC(ai);break}}n(!1)}catch(i){throw i}finally{n(!1)}},user:t}}function DU(){const{loading:t,user:e}=xe(),n=h.useRef(null),{action:r}=id(),[s,i]=h.useState(""),o=()=>{var m;return(m=n.current)==null?void 0:m.toggle()},l=m=>{var p;i(m),(p=n.current)==null||p.toggle()},c=async()=>{try{await r("logout")}catch(m){console.log("signOut error",{message:m})}finally{o()}},u=h.useMemo(()=>{switch(s){case"theme":return a.jsx(SC,{closeModal:o});case"info":return a.jsx(Jj,{closeModal:o});case"logout":return a.jsx(qt,{closeModal:o,callback:c,loading:!1,label:"Log out ?"})}},[s]),d={linkItem:"py-3 text-lg w-full border-b border-[--a-5-cl] space-x-2 last:border-none flex items-center",icon:"w-7"};return a.jsxs("div",{className:"md:hidden",children:[a.jsx("div",{className:"text-xl font-playwriteCU leading-[2.2] mb-3",children:"Setting"}),e&&a.jsxs("div",{className:"bg-[--a-5-cl] p-3 rounded-md flex mb-3",children:[a.jsx(Fx,{className:"h-[65px] w-[65px]"}),a.jsxs("div",{className:"ml-3",children:[a.jsx("p",{className:"text-lg font-[500]",children:e.display_name}),a.jsx("p",{className:"opacity-70 font-[500]",children:"Vip member ❤️"})]})]}),t?[...Array(3).keys()].map(m=>a.jsx(_R,{},m)):a.jsxs("div",{className:"",children:[a.jsxs("button",{className:d.linkItem,onClick:()=>l("theme"),children:[a.jsx(Kj,{className:d.icon}),a.jsx("span",{children:"Theme"})]}),a.jsxs("button",{className:d.linkItem,onClick:()=>l("info"),children:[a.jsx(qj,{className:d.icon}),a.jsx("span",{children:"Info"})]}),(e==null?void 0:e.role)==="ADMIN"&&a.jsxs(X,{to:"/dashboard",className:d.linkItem,children:[a.jsx(mm,{className:d.icon}),a.jsx("span",{children:"Dashboard"})]}),e&&a.jsxs("button",{className:d.linkItem,onClick:()=>l("logout"),children:[a.jsx(ov,{className:d.icon}),a.jsx("span",{children:"Logout"})]})]}),a.jsx(ce,{ref:n,variant:"animation",children:u})]})}function KR({amount:t}){const[e,n]=h.useState([]),{setErrorToast:r}=te(),[s,i]=h.useState(!0),o=h.useRef(!1),l=async()=>{try{i(!0);const c=x$([0,0,0,0]),u=le(_t,Q("last_active",">=",c),Lt("today_play","desc"),Mt(t)),d=await $t(u);n(d)}catch(c){console.log({message:c}),r()}finally{i(!1)}};return h.useEffect(()=>{o.current||(o.current=!0,l())},[]),{isFetching:s,songs:e}}function LU({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{fillRule:"evenodd",d:"M7.72 12.53a.75.75 0 010-1.06l7.5-7.5a.75.75 0 111.06 1.06L9.31 12l6.97 6.97a.75.75 0 11-1.06 1.06l-7.5-7.5z",clipRule:"evenodd"}))}const OU=h.forwardRef(LU),$U=OU;function zU({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{fillRule:"evenodd",d:"M16.28 11.47a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 01-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 011.06-1.06l7.5 7.5z",clipRule:"evenodd"}))}const BU=h.forwardRef(zU),VU=BU;function UU({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{fillRule:"evenodd",d:"M4.5 5.653c0-1.426 1.529-2.33 2.779-1.643l11.54 6.348c1.295.712 1.295 2.573 0 3.285L7.28 19.991c-1.25.687-2.779-.217-2.779-1.643V5.653z",clipRule:"evenodd"}))}const HU=h.forwardRef(UU),GU=HU;function WU({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{fillRule:"evenodd",d:"M12 3.75a.75.75 0 01.75.75v6.75h6.75a.75.75 0 010 1.5h-6.75v6.75a.75.75 0 01-1.5 0v-6.75H4.5a.75.75 0 010-1.5h6.75V4.5a.75.75 0 01.75-.75z",clipRule:"evenodd"}))}const qU=h.forwardRef(WU),KU=qU;function QU(){const{user:t}=xe(),{shouldFetchOwnPlaylists:e,setOwnPlaylists:n}=it(),{setErrorToast:r,setSuccessToast:s}=te(),[i,o]=h.useState(!1),l=async()=>{try{if(!t)return;const u=le(vn,Q("owner_email","==",t.email),Q("is_official","==",!1)),d=await Ln(u,"useGetMyMusicPlaylist, get user own playlists");n(d)}catch(u){console.log(u)}},c=async({songs:u,playlist:d})=>{try{o(!0);const m=[...d.song_ids];if(u.forEach(x=>{m.includes(x.id)||m.push(x.id)}),m.length===d.song_ids.length){await Jn(100),s("Song added to playlist");return}const g={song_ids:m};await Se({collectionName:"Playlists",id:d.id,data:g}),e.current=!0,s("Song added to playlist")}catch(m){console.log({message:m}),r()}finally{o(!1)}};return h.useEffect(()=>{e.current&&(e.current=!1,l())},[]),{isFetching:i,addToPlaylist:c}}const Vx=t=>({name:"",meta:[],image_url:"",song_url:"",beat_url:"",beat_file_id:"",duration:0,like:0,comment:0,lyric_id:"",image_file_id:"",song_file_id:"",blurhash_encode:"",singer_map:{},genre_ids:[],genres:[],singers:[],is_official:!1,size:0,today_play:0,week_play:0,last_week_play:0,last_week_rank:0,last_week_trending_score:0,total_play:0,release_year:new Date().getFullYear(),last_active:mt(),created_at:mt(),updated_at:mt(),...t}),Ux=t=>({name:"",meta:[],song_ids:[],image_url:"",singers:[],singer_map:{},is_album:!1,like:0,comment:0,blurhash_encode:"",is_public:!0,is_official:!1,image_file_id:"",created_at:mt(),updated_at:mt(),...t}),XU=({owner_email:t,distributor:e,...n})=>Ux({owner_email:t,is_album:!0,is_official:!0,is_public:!0,distributor:e,...n}),Hx=t=>({name:"",meta:[],description:"",image_file_id:"",image_url:"",like:0,created_at:mt(),blurhash_encode:"",...t}),mE=({start:t,end:e,text:n})=>{const r=n.trim().split(" "),s=r.map(()=>[]),i=r.map(()=>0);return{start:t,end:e,tune:{start:t,end:e,grow:i},cut:s,text:n}},pE=({user:t,target_id:e,...n})=>({target_id:e,text:"",like:0,reply:0,comment_id:"",user_email:t.email,user_image_url:t.photo_url,user_name:t.display_name,created_at:mt(),updated_at:mt(),...n}),gE=t=>({banner_file_id:"",banner_image_url:"",image_file_id:"",image_url:"",name:"",banner_blurhash_encode:"",blurhash_encode:"",playlist_ids:"",song_ids:"",created_at:mt(),updated_at:mt(),...t}),YU=(t="")=>({name:t,show:!0,target_ids:""});function JU(t){const[e,n]=h.useState(),[r,s]=h.useState(),i=h.useRef(null),o=m=>{e&&n({...e,...m})},l=h.useMemo(()=>t.variant==="add"?!0:!t.playlist||!e?!1:e.name!==t.playlist.name||e.like!==t.playlist.like||e.is_public!==t.playlist.is_public,[e]),c=!!r,u=h.useMemo(()=>{const m=!!(e!=null&&e.name)&&l;return t.variant==="add"?m:m||c},[c,l,e]),d=()=>{switch(t.variant){case"add":return Ux({distributor:t.user.display_name,owner_email:t.user.email,name:t.name});case"edit":const{id:m,updated_at:p,...g}=t.playlist;return Ux(g)}};return h.useEffect(()=>{var m,p;t.variant==="add"&&((m=i.current)==null||m.focus(),(p=t.modalRef.current)==null||p.setModalPersist(!0)),n(d())},[]),h.useEffect(()=>{var m;(l||c)&&((m=t.modalRef.current)==null||m.setModalPersist(!0))},[e,r]),h.useEffect(()=>{r&&o({image_url:URL.createObjectURL(r)})},[r]),{playlistData:e,imageFile:r,setImageFile:s,updatePlaylistData:o,setPlaylistData:n,inputRef:i,isValidToSubmit:u,isChanged:l,isChangeImage:c}}function Gl({isLoading:t,submit:e,...n}){const{imageFile:r,setImageFile:s,playlistData:i,updatePlaylistData:o,isChanged:l,isChangeImage:c,inputRef:u,isValidToSubmit:d}=JU(n),m=async()=>{i&&(!l&&!c||e(i,r))},p=g=>{var x;(x=g.target.files)!=null&&x.length&&s(g.target.files[0])};return i?a.jsxs(a.Fragment,{children:[a.jsx(Be,{closeModal:()=>{var g;return(g=n.modalRef.current)==null?void 0:g.close()},title:n.variant==="add"?"Add playlist":"Edit playlist"}),a.jsxs("div",{className:"md:flex md:space-x-3 overflow-auto",children:[a.jsxs("div",{className:"space-y-2.5",children:[a.jsx("div",{className:"w-[200px] h-[200px] rounded-lg overflow-hidden",children:a.jsx(Ce,{className:"object-cover object-center h-full",blurHashEncode:i.blurhash_encode,src:i.image_url})}),a.jsx("input",{ref:u,onChange:p,type:"file",value:"",multiple:!0,accept:"image/png, image/jpeg",id:"image_upload",className:"hidden"}),a.jsx("div",{className:"space-x-2 flex",children:a.jsx(se,{color:"primary",size:"clear",children:a.jsx("label",{htmlFor:"image_upload",className:"px-5 py-1 cursor-pointer ",children:a.jsx(di,{className:"w-5"})})})})]}),a.jsxs("div",{className:"mt-3 md:mt-0 flex-grow flex flex-col space-y-2.5",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(Dt,{htmlFor:"name",children:"Name"}),a.jsx(_n,{id:"name",ref:u,type:"text",placeholder:"name...",value:i.name,onChange:g=>o({name:g.target.value})})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(Dt,{children:"Public"}),a.jsx(Ho,{inActiveBg:"bg-black/10",active:i.is_public,cb:()=>o({is_public:!i.is_public})})]})]})]}),a.jsx("p",{className:"text-right mt-5 md:mt-0",children:a.jsx(se,{color:"primary",onClick:m,disabled:!d||t,className:"font-playwriteCU rounded-full",children:"Save"})}),t&&a.jsx(da,{})]}):a.jsx(a.Fragment,{})}function QR(){const{user:t,updateUserData:e}=xe(),{ownPlaylists:n,setOwnPlaylists:r,favoritePlaylists:s,setFavoritePlaylists:i}=it(),{setErrorToast:o,setSuccessToast:l}=te(),{addPlaylist:c,isFetching:u}=Pw();return{isFetching:u,myMusicAddPlaylist:async(m,p)=>{try{if(!t)return;const g=await c({variant:"add",playlist:m,imageFile:p},{push:!1});if(g){const x=[...n,g],w=[...s,g],v={liked_playlist_ids:w.map(S=>S.id)};Se({collectionName:"Users",data:v,id:t.email}),e(v),r(x),i(w),l("New playlist created")}}catch(g){console.log({error:g}),o()}}}}function ip({songs:t,closeModal:e}){const{user:n}=xe(),{ownPlaylists:r}=it(),{addToPlaylist:s,isFetching:i}=QU(),{myMusicAddPlaylist:o,isFetching:l}=QR(),c=h.useRef(null),u=async m=>{await s({playlist:m,songs:t}),e()},d=async(m,p)=>{var g;m.song_ids=t.map(x=>x.id),await o(m,p),(g=c.current)==null||g.close(),e()};if(n)return a.jsxs(a.Fragment,{children:[a.jsxs(_e,{children:[a.jsx(Be,{closeModal:e,title:"Playlists"}),a.jsx("div",{className:"flex-grow flex flex-col overflow-auto space-y-2",children:r.length?r.map((m,p)=>a.jsxs("button",{onClick:()=>u(m),className:"flex rounded-md p-2 hover:bg-[--a-5-cl]",children:[a.jsx(oa,{className:"w-5 mr-2"}),a.jsx("span",{children:m.name})]},p)):a.jsx(Re,{variant:"less"})}),a.jsx("p",{className:"text-center",children:a.jsxs(se,{color:"primary",className:"mt-5 rounded-full justify-center",onClick:()=>{var m;return(m=c.current)==null?void 0:m.open()},children:[a.jsx(zt,{className:"w-5"}),a.jsx("span",{children:"Add new playlist"})]})}),i&&a.jsx(da,{})]}),a.jsx(ce,{variant:"animation",ref:c,children:a.jsx(_e,{className:"w-[600px]",children:a.jsx(Gl,{modalRef:c,submit:d,isLoading:i||l,variant:"add",user:n})})})]})}function Mw({modalRef:t,song:e}){const{user:n}=xe();return n?a.jsx(ce,{variant:"animation",ref:t,children:a.jsx(ip,{closeModal:()=>{var r;return(r=t.current)==null?void 0:r.close()},songs:[e]})}):a.jsx(a.Fragment,{})}function Dw({modalRef:t}){const{user:e}=xe();return e?a.jsxs("button",{onClick:()=>{var n;return(n=t.current)==null?void 0:n.open()},children:[a.jsx(zt,{}),a.jsx("span",{children:"Add to playlist"})]}):a.jsx(a.Fragment,{})}function ZU({song:t,index:e}){const{action:n}=HR(),r=h.useRef(null),s=()=>{n({variant:"remove",index:e})};return a.jsxs(a.Fragment,{children:[a.jsxs(op,{song:t,children:[!1,a.jsxs("button",{onClick:s,children:[a.jsx(hv,{className:"w-5"}),a.jsx("span",{children:"Remove"})]}),a.jsx(Dw,{modalRef:r}),a.jsxs("a",{target:"_blank",href:t.song_url,children:[a.jsx(Nu,{className:"w-5"}),a.jsx("span",{children:"Download"})]})]}),a.jsx(Mw,{song:t,modalRef:r})]})}function eH({song:t,modalRef:e}){const{user:n}=xe(),{updateSong:r}=it(),[s,i]=h.useState({name:t.name,singer:t.singers[0].name,image_url:t.image_url}),[o,l]=h.useState(!1),[c,u]=h.useState(),{setErrorToast:d,setSuccessToast:m}=te(),p=h.useMemo(()=>t.name!==s.name||t.singers[0].name!==s.singer,[s]),g=!!s.name&&!!s.singer&&p||c,x=(v,S)=>{i({...s,[v]:S})},w=async()=>{var v,S;try{if(!n||!g)return;l(!0),(v=e.current)==null||v.setModalPersist(!0);const{id:_,...E}=t;if(p){if(!s.name||!s.singer)return;E.name=s.name,E.singers=[{...E.singers[0],name:s.singer}]}if(c){const I=await pi({imageFile:c});Object.assign(E,I),t.image_file_id&&Gt({fileId:t.image_file_id})}await Se({collectionName:"Songs",data:E,id:t.id}),r({id:t.id,song:E}),m("Song edited"),(S=e.current)==null||S.close()}catch(_){console.log({message:_}),d()}finally{l(!1)}};return h.useEffect(()=>{var v;p&&((v=e.current)==null||v.setModalPersist(!0))},[s]),{isFetching:o,isChanged:p,songData:s,isValidToSubmit:g,handleSubmit:w,imageFile:c,setImageFile:u,handleInput:x}}function tH({song:t,modalRef:e}){const n=h.useRef(null),r=h.useRef(null),{isValidToSubmit:s,songData:i,setImageFile:o,isFetching:l,handleSubmit:c,handleInput:u}=eH({song:t,modalRef:e}),d=p=>{const g=p.target.files;g!=null&&g.length&&(o(g[0]),u("image_url",URL.createObjectURL(g[0])))},m=p=>{var g;p.stopPropagation(),(g=e.current)==null||g.close()};return a.jsxs(_e,{className:"w-[500px]",children:[a.jsx("label",{ref:r,className:"hidden",htmlFor:"image"}),a.jsx("input",{ref:n,id:"image",type:"file",accept:"image/*",onChange:d,className:"hidden"}),a.jsx(Be,{title:"Edit song",closeModal:()=>{var p;return(p=e.current)==null?void 0:p.close()}}),a.jsxs("div",{className:"flex flex-col flex-grow overflow-auto md:overflow-hidden md:flex-row mt-5",children:[a.jsxs("div",{className:"space-y-2.5",children:[a.jsx("div",{className:"w-[200px] rounded-md overflow-hidden h-[200px] md:w-[160px] md:h-[160px] object-cover",children:a.jsx(Ce,{className:"object-cover h-full",src:i.image_url})}),a.jsx(se,{onClick:()=>{var p;return(p=r.current)==null?void 0:p.click()},color:"primary",children:a.jsx(di,{className:"w-5"})})]}),a.jsxs("div",{className:"pt-5 md:pt-0 md:pl-5 md:flex-grow space-y-3",children:[a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Dt,{htmlFor:"name",children:"Name"}),a.jsx(_n,{value:i.name,type:"text",id:"name",onChange:p=>u("name",p.target.value),placeholder:t.name})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Dt,{htmlFor:"singer",children:"Singer"}),a.jsx(_n,{value:i.singer,onChange:p=>u("singer",p.target.value),type:"text",id:"singer",placeholder:t.singers[0].name})]})]})]}),a.jsxs("div",{className:"flex mt-5 space-x-2 justify-end",children:[a.jsx(se,{onClick:m,className:"rounded-full",children:"Close"}),a.jsx(se,{isLoading:l,onClick:c,disabled:!s,className:" rounded-full",variant:"primary",color:"primary",children:"Save"})]}),l&&a.jsx(da,{})]})}function ap(){const{user:t,updateUserData:e}=xe(),{setErrorToast:n,setSuccessToast:r}=te(),{uploadedSongs:s,setUploadedSongs:i,shouldFetchFavoriteSongs:o}=it(),[l,c]=h.useState(!1);return{loading:l,action:async d=>{try{if(c(!0),!t)throw new Error("User not found");const m=mi(ie),p=st(ie,"Users",t.email),g=st(ie,"Songs",d.song.id);switch(d.variant){case"delete":{const x=s.filter(v=>v.id!==d.song.id),w={liked_song_ids:t.liked_song_ids.filter(v=>v!==d.song.id)};if(m.update(p,w),m.delete(g),d.song.lyric_id){const v=st(ie,"Lyrics",d.song.lyric_id);m.delete(v)}await Promise.all([m.commit(),aR(d.song)]),i(x),r(`'${d.song.name}' deleted`),t.liked_song_ids.includes(d.song.id)&&(o.current=!0);break}case"like":{if(!t)return;const x=[...t.liked_song_ids],w=x.findIndex(E=>E===d.song.id),v=w===-1;v?x.unshift(d.song.id):x.splice(w,1);const S={liked_song_ids:x},_={like:Ks(v?1:-1)};m.update(p,S),m.update(g,_),await m.commit(),e(S),o.current=!0;break}}}catch(m){console.log({message:m}),n()}finally{c(!1)}}}}function Lw({song:t}){const{action:e}=HR(),n=()=>{e({variant:"add",songs:[t]})};return a.jsxs("button",{onClick:n,children:[a.jsx(zt,{}),a.jsx("span",{children:"Add to queue"})]})}function nH({song:t}){const[e,n]=h.useState(""),r=h.useRef(null),s=h.useRef(null),{action:i,loading:o}=ap(),l=m=>{var p;n(m),(p=r.current)==null||p.open()},c=()=>{var m;(m=r.current)==null||m.close()},u=async()=>{await i({variant:"delete",song:t}),c()},d=()=>{switch(e){case"":return a.jsx(a.Fragment,{});case"delete":return a.jsx(qt,{callback:u,loading:o,closeModal:c,label:`Delete ' ${t.name} ' ?`});case"edit":return a.jsx(tH,{modalRef:r,song:t});case"add-to-playlist":return a.jsx(ip,{closeModal:c,songs:[t]})}};return a.jsxs(a.Fragment,{children:[a.jsxs(op,{song:t,children:[!1,a.jsx(Lw,{song:t}),a.jsx(Dw,{modalRef:s}),a.jsxs("button",{onClick:()=>l("edit"),children:[a.jsx(iv,{}),a.jsx("span",{children:"Edit"})]}),a.jsxs(X,{to:`lyric/${t.id}`,children:[a.jsx(pm,{}),a.jsx("span",{children:t.lyric_id?"Edit lyric":"Add lyric"})]}),a.jsxs("button",{onClick:()=>l("delete"),children:[a.jsx(pt,{}),a.jsx("span",{children:"Delete"})]}),a.jsxs("a",{target:"_blank",href:t.song_url,children:[a.jsx(Nu,{}),a.jsx("span",{children:"Download"})]})]}),a.jsx(ce,{variant:"animation",ref:r,children:d()}),a.jsx(Mw,{song:t,modalRef:s})]})}function rH({song:t}){const e=h.useRef(null);return a.jsxs(a.Fragment,{children:[a.jsxs(op,{song:t,children:[!1,a.jsx(Lw,{song:t}),a.jsx(Dw,{modalRef:e}),a.jsxs("a",{target:"_blank",href:t.song_url,children:[a.jsx(Nu,{}),a.jsx("span",{children:"Download"})]})]}),a.jsx(Mw,{song:t,modalRef:e})]})}function sH(){const t=on(),{playlistSongs:e,currentPlaylist:n}=oe(ha),{shouldFetchOwnPlaylists:r}=it(),{setErrorToast:s,setSuccessToast:i}=te(),[o,l]=h.useState(!1);return{isFetching:o,removeSongFromPlaylist:async({song:u})=>{try{if(!n)return;l(!0);const d=e.filter(p=>p.id!==u.id),m={song_ids:d.map(p=>p.id)};await Se({collectionName:"Playlists",id:n.id,data:m}),r.current=!0,t(IU(d)),i(`${u.name} removed`)}catch(d){console.log({message:d}),s()}finally{l(!1)}}}}function iH({song:t}){const{removeSongFromPlaylist:e}=sH();return a.jsxs("button",{onClick:()=>e({song:t}),children:[a.jsx(hv,{}),a.jsx("span",{children:"Remove"})]})}function aH({song:t}){return a.jsx(a.Fragment,{children:a.jsxs(op,{song:t,children:[!1,a.jsx(Lw,{song:t}),a.jsx(iH,{song:t}),a.jsxs("a",{target:"_blank",href:t.song_url,children:[a.jsx(Nu,{className:"w-5"}),a.jsx("span",{children:"Download"})]})]})})}function oH({song:t}){return a.jsx("div",{className:"px-2 mb-3",children:a.jsxs("div",{className:"p-2 bg-white/10 rounded-md flex",children:[a.jsx("div",{className:"w-[50px] h-[50px] rounded overflow-hidden flex-shrink-0",children:a.jsx(Ce,{src:t.image_url,className:"object-cover object-center w-full"})}),a.jsxs("div",{className:"ml-2 text-sm",children:[a.jsx("h5",{className:"line-clamp-1 font-[500]",children:t.name}),a.jsx("p",{className:"opacity-70 line-clamp-1",children:t.singers.map((e,n)=>e.name+(n?", ":""))})]})]})})}function op({children:t,song:e}){return a.jsx(Dn,{className:"w-[240px]",children:a.jsxs(er,{children:[a.jsx(oH,{song:e}),a.jsx(Or,{children:t}),a.jsxs("p",{className:"text-xs text-center opacity-70 mt-3",children:["By ",e.distributor]})]})})}function xE({song:t,index:e,variant:n}){const[r,s]=h.useState(!1),i=()=>{switch(n){case"queue-song":return a.jsx(ZU,{song:t,index:e});case"own-song":return a.jsx(nH,{song:t});case"own-playlist":return a.jsx(aH,{song:t});default:return a.jsx(rH,{song:t})}},o=()=>{switch(n){case"queue-song":case"recent-song":return a.jsx(a.Fragment,{});default:return a.jsx("span",{className:`text-sm font-[500] hidden p-2 group-hover/main:hidden ${r?"hidden":"md:block"}`,children:ea(t.duration)})}},l={button:"hover:bg-[--a-5-cl] p-2 rounded-full"},c=()=>r?"bg-[--primary-cl]":"block md:hidden";return a.jsx(a.Fragment,{children:a.jsxs(Fn,{appendOnPortal:!0,children:[a.jsx(Mn,{children:a.jsx("button",{type:"button",className:`block group-hover/main:block ${l.button} ${c()}`,children:a.jsx(ao,{className:"w-5"})})}),o(),i()]})})}function lH({isLiked:t,song:e,isSongActive:n,songVariant:r,className:s="p-1.5"}){const{action:i,loading:o}=ap(),l=()=>{switch(r){case"queue-song":case"recent-song":return"mr-1";default:return""}},c=()=>{if(t)switch(r){case"queue-song":case"recent-song":return"";default:return"!block"}return""},u=()=>{switch(r){case"queue-song":case"recent-song":return n?"text-white":"text-[--primary-cl]";default:return"text-[--primary-cl]"}},d={button:"hover:bg-[--a-5-cl] rounded-full"};return a.jsx("button",{onClick:()=>i({variant:"like",song:e}),className:`${d.button} ${l()} group-hover/main:block md:hidden ${s} ${c()}`,children:o?a.jsx(Ae,{className:"w-5 animate-spin"}):a.jsx(a.Fragment,{children:t?a.jsx(zl,{className:`w-5 ${u()}`}):a.jsx(Au,{className:"w-5"})})})}function cH({onClick:t,isChecked:e,isSelected:n}){return a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:t,className:`mr-2 md:mr-3 group-hover/main:block ${e?"block":"md:hidden "}`,children:n?a.jsx(Ku,{className:"w-[18px]"}):a.jsx(mv,{className:"w-[18px]"})}),a.jsx("button",{className:`mr-3 hidden group-hover/main:hidden group-hover/main:mr-[0px] md:block ${Qs(e,"md:hidden")}`,children:a.jsx(oa,{className:"w-[18px]"})})]})}function XR({song:t,onClick:e,isHasCheckBox:n,active:r=!0,isLiked:s,index:i,className:o="",imageUrl:l,showIndex:c,...u}){const{isOnMobile:d}=ss(),{isChecked:m,selectedSongs:p,selectSong:g}=ho(),x=h.useMemo(()=>p?p.indexOf(t)!=-1:!1,[p]),w=()=>{m!==void 0&&g(t)},v={itemContainer:"w-full sm:group/container flex flex-row rounded-md justify-between py-2 px-3 last:border-none",imageFrame:" relative rounded overflow-hidden flex-shrink-0",overlay:"absolute flex items-center justify-center inset-0 bg-black/40"},S=h.useMemo(()=>{switch(u.variant){default:return a.jsxs("div",{className:` ${v.overlay} 
               ${r?"":"hidden sm:group-hover/main:flex"}`,children:[a.jsx("img",{src:Ew,alt:"",className:`"h-[18px] w-[18px] ${ta(!r)}`}),a.jsx("button",{onClick:e,className:`${ta(r)} `,children:a.jsx(GU,{className:"w-[24px] text-white"})})]})}},[r,e]),_=()=>{switch(u.variant){case"queue-song":case"recent-song":return"text-xs";default:return"text-sm"}},E=()=>{switch(u.variant){case"queue-song":case"recent-song":return"w-10 h-10";default:return"h-[54px] w-[54px]"}},I=()=>{switch(u.variant){case"queue-song":case"recent-song":return"text-xs";default:return"text-xs"}},P=N=>{!d||N.target.tagName==="A"||e()},F=a.jsxs(a.Fragment,{children:[n&&a.jsx(cH,{isChecked:m,isSelected:x,onClick:w}),c&&a.jsx("div",{className:`song-index font-bold w-[50px] leading-[54px] flex-shrink-0 md:w-[60px] text-center text-[32px] ${i<=2?"is-top-"+(i+1):""}`,children:i+1}),a.jsxs("div",{className:"flex-grow flex",onClick:P,children:[a.jsxs("div",{className:`${v.imageFrame} ${E()}`,children:[a.jsx(Ce,{src:l||t.image_url,blurHashEncode:t.blurhash_encode}),S]}),a.jsxs("div",{className:"ml-[10px]",children:[a.jsxs("h5",{className:`line-clamp-1 font-semibold overflow-hidden ${_()}`,children:[t.name,!1]}),a.jsx("div",{className:`opacity-[.7] font-medium line-clamp-1 ${I()}`,children:t.singers.map((N,M)=>N.id?a.jsx(X,{to:`/singer/${N.id}`,className:"hover:text-[--primary-cl]  hover:underline",children:(M?", ":"")+N.name},M):a.jsxs("span",{children:[" ",(M?", ":"")+N.name]},M))})]})]})]}),j=()=>{switch(u.variant){case"queue-song":case"recent-song":return F;default:return a.jsx("div",{className:"flex flex-grow overflow-hidden",children:F})}},k=()=>{switch(u.variant){case"queue-song":case"recent-song":return a.jsx(xE,{variant:u.variant,song:t,index:i});default:return a.jsx("div",{className:"flex justify-center md:w-[60px]",children:a.jsx(xE,{variant:u.variant,song:t,index:i})})}},C=a.jsxs("div",{className:"flex items-center",children:[s!=null&&a.jsx(lH,{className:"p-2",isSongActive:r,songVariant:u.variant,isLiked:s,song:t}),k()]});return(()=>{switch(u.variant){case"queue-song":return a.jsxs("div",{className:`${v.itemContainer} group/main ${r?"bg-[--primary-cl] text-white":"hover:bg-[--a-5-cl]"}`,children:[j(),C]});default:return a.jsxs("div",{className:`${v.itemContainer} ${o} group/main ${r||x?"bg-[--a-5-cl]":"hover:bg-[--a-5-cl]"}`,children:[j(),C]})}})()}function Sr({songs:t,setSong:e,getActive:n,songVariant:r,imageUrl:s,showIndex:i,isHasCheckBox:o=!0,whenEmpty:l}){const{user:c}=xe(),{currentSongData:u}=oe(We);return t.length?t.map((d,m)=>{const p=c?d.owner_email===c.email&&d.is_official===!1:!1;return a.jsx(XR,{showIndex:i,active:u?n?n(d,u.song):d.id===u.song.id:!1,onClick:()=>e(d),variant:r||(p?"own-song":"system-song"),isHasCheckBox:o,isLiked:c?c.liked_song_ids.includes(d.id):null,song:d,imageUrl:s,index:m},d.queue_id)}):l||a.jsx(Re,{variant:"less"})}async function Gx(t){var s,i;if(console.log(t),!((s=t.main_genre)!=null&&s.id)||!t.genre_ids||!t.release_year)return[];const e=le(_t,Q("main_genre.id","==",(i=t.main_genre)==null?void 0:i.id),Q("genre_ids","array-contains-any",t.genre_ids),Q("release_year",">=",t.release_year-1),Q("release_year","<=",t.release_year+1));return(await $t(e,{msg:"Get relative songs"})).filter(o=>o.id!==t.id)}function ad(){const t=on();return{getRelatigeSongs:async n=>{try{t(vU(!0));const r=await Gx(n);t(np({songs:r}))}catch(r){console.log(r)}}}}function YR(t){const{isFetching:e,songs:n}=KR(t),{handleSetSong:r}=_r({variant:"songs"}),{getRelatigeSongs:s}=ad(),i=o=>{r(o.queue_id,n),s(o)};return a.jsx(a.Fragment,{children:a.jsxs("div",{children:[a.jsx(ee,{title:"Trending",className:"mb-3"}),a.jsxs(En,{children:[e&&Rs,!e&&a.jsx(Sr,{showIndex:!0,isHasCheckBox:!1,songs:n,setSong:o=>i(o)})]}),a.jsx("div",{className:"text-center mt-5 border-none",children:a.jsx(X,{to:"/trending",children:a.jsx(se,{color:"primary",children:"See more"})})})]})})}function JR({category_ids:t}){const[e,n]=h.useState([]),[r,s]=h.useState(!1),i=h.useRef(!1),o=async()=>{try{if(!t.length)return;s(!0);const l=le(St(ie,"Categories"),Q(Lr(),"in",t)),c=await bt(l);if(!c.empty){const u=c.docs.map(d=>({...d.data(),id:d.id}));n(u)}}catch(l){console.log(l)}finally{s(!1)}};return h.useEffect(()=>{i.current||(i.current=!0,o())},[]),{categories:e,isFetching:r}}function uH({autoPlay:t,images:e}){const[n,r]=h.useState(0);h.useEffect(()=>{if(!t||e.length<=1)return;const l=setInterval(()=>{r(c=>c===e.length-1?0:c+1)},5e3);return()=>clearInterval(l)},[t,5e3,e.length]),h.useEffect(()=>{const l=c=>{c.key==="ArrowLeft"?s():c.key==="ArrowRight"&&i()};return window.addEventListener("keydown",l),()=>window.removeEventListener("keydown",l)},[]);const s=()=>{r(l=>l===0?e.length-1:l-1)},i=()=>{r(l=>l===e.length-1?0:l+1)};return{next:i,previous:s,goToSlide:l=>{r(l)},currentIndex:n,setCurrentIndex:r}}function dH({images:t,autoPlay:e=!1,className:n=""}){const{next:r,previous:s,currentIndex:i}=uH({images:t,autoPlay:e});return!t||t.length===0?a.jsx(Ce,{className:""}):a.jsx("div",{className:`relative ${n}`,children:a.jsxs("div",{className:"relative h-full overflow-hidden rounded-lg",children:[a.jsx("div",{className:"flex transition-transform duration-500 ease-in-out h-full",style:{transform:`translateX(-${i*100}%)`},children:t.map((o,l)=>a.jsx(X,{to:o.link||"",className:"w-full h-full flex-shrink-0",children:a.jsx(Ce,{src:o.imageUrl,blurHashEncode:o.hash,className:"h-full object-cover"})},l))}),t.length>1&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"absolute left-4 top-1/2 transform -translate-y-1/2",children:a.jsx("button",{className:"p-1.5 rounded-full bg-black/50",onClick:s,"aria-label":"Previous image",children:a.jsx(uv,{className:"w-6 text-white"})})}),a.jsx("div",{className:"absolute right-4 top-1/2 transform -translate-y-1/2",children:a.jsx("button",{className:"p-1.5 rounded-full bg-black/50",onClick:r,"aria-label":"Next image",children:a.jsx(lf,{className:"w-6 text-white"})})})]})]})})}function ZR({categoryIds:t}){const{isFetching:e,categories:n}=JR({category_ids:t}),r=h.useMemo(()=>{const s=[];return t.forEach(i=>{const o=n.find(l=>l.id===i);o&&s.push(o)}),s},[n]);return e?a.jsx(ge,{className:"aspect-[16/4]"}):n.length?a.jsx(dH,{className:"aspect-[16/4]",images:r.map(s=>({imageUrl:s.banner_image_url,link:`/category/${s.id}`,hash:s.banner_blurhash_encode}))}):a.jsx(a.Fragment,{})}function Ow({playlistIds:t,title:e}){const[n,r]=h.useState([]),{isFetching:s}=Fw({setPlaylists:r,playlistIds:t});return n.length?a.jsx(a.Fragment,{children:a.jsxs("div",{children:[e&&a.jsx(ee,{variant:"h2",title:e}),a.jsx(Hl,{loading:s,playlists:n})]})}):a.jsx(a.Fragment,{})}function eN(){const{setCategoryPage:t,setHomePage:e,shouldFetch:n}=Bn(),[r,s]=h.useState(!0),i=h.useRef(!1),o=async()=>{try{s(!0);const l={category_ids:"",category_sections:[],playlist_sections:[],updated_at:""},[c,u]=await Promise.all([Wt({collectionName:"Page_Config",id:"category",msg:"Get category config"}),Wt({collectionName:"Page_Config",id:"home",msg:"Get home config"})]);t(c.exists()?c.data():l),e(u.exists()?u.data():l)}catch(l){console.log(l)}finally{s(!1)}};return h.useEffect(()=>{i.current||(i.current=!0,n.current?(n.current=!1,o()):setTimeout(()=>s(!1),100))},[]),{isFetching:r}}function hH({amount:t}){const{setErrorToast:e}=te(),{genres:n,setGenres:r}=it(),[s,i]=h.useState(),[o,l]=h.useState(""),[c,u]=h.useState(!0),d=h.useMemo(()=>n.length?n.map(_=>_.name):[],[n]),m=_=>n.find(E=>bn(_)===bn(E.name)),p=h.useMemo(()=>m(o),[n,o]),g=h.useMemo(()=>s?s[(p==null?void 0:p.id)||""].songs:[],[s,o]),x=()=>d.reduce((_,E)=>{var P;const I={songs:[],shouldFetching:!0};return{..._,[((P=m(E))==null?void 0:P.id)||""]:I}},{}),w=h.useRef(!1),v=async()=>{try{const _=le(iR,Q("is_main","==",!0)),E=await bt(_);if(E.empty)return;const I=E.docs.map(P=>({...P.data(),id:P.id}));r(I),l(I[0].name)}catch{console.log("Error when get genres")}},S=async()=>{try{if(!o||!p)return;u(!0);const _=s?{...s}:x(),E={..._[p.id]};if(E.shouldFetching){E.shouldFetching=!1;const I=le(_t,Q("main_genre.id","==",p.id),Lt("created_at","desc"),Mt(t)),P=await $t(I);E.songs=P,Object.assign(_,{[p.id]:E}),i(_)}else await Jn(300)}catch(_){console.log({message:_}),e()}finally{u(!1)}};return h.useEffect(()=>{w.current||(w.current=!0,n.length?l(d[0]):v())},[]),h.useEffect(()=>{o&&S()},[o]),{isFetching:c,currentSongs:g,tabs:d,tab:o,setTab:l}}function fH(t){const{isFetching:e,currentSongs:n,...r}=hH(t),{getRelatigeSongs:s}=ad(),{handleSetSong:i}=_r({variant:"songs"}),o=l=>{i(l.queue_id,[l]),s(l)};return a.jsx(a.Fragment,{children:a.jsxs("div",{children:[a.jsx(ee,{title:"New song",className:"mb-3"}),a.jsx("div",{className:"mb-5 space-y-3",children:a.jsx(tr,{className:"w-fit",render:l=>l,...r})}),a.jsxs(En,{children:[e&&Rs,!e&&a.jsx(Sr,{isHasCheckBox:!1,songs:n,setSong:l=>o(l)})]}),a.jsx("div",{className:"text-center mt-5 border-none",children:a.jsx(X,{to:"/trending",children:a.jsx(se,{color:"primary",children:"See more"})})})]})})}function mH(){const{loading:t,user:e}=xe(),{action:n}=id(),r=async()=>{try{await n("login")}catch(i){console.log(i)}finally{}},s={icon:"w-7 mr-2 inline",linkItem:"py-3 border-b text-lg border-[--a-5-cl] last:border-none"};return a.jsxs("div",{className:"block md:hidden",children:[a.jsx(ee,{title:"Library",className:"mb-1"}),t?[...Array(3).keys()].map(i=>a.jsx(_R,{},i)):a.jsx(a.Fragment,{children:e?a.jsxs(a.Fragment,{children:[a.jsx(Zb,{to:"/trending",className:s.linkItem,icon:a.jsx(fm,{className:s.icon}),label:"Trending",arrowIcon:a.jsx(lf,{className:"w-6"})}),a.jsx(Zb,{to:"/category",className:s.linkItem,icon:a.jsx(xm,{className:s.icon}),label:"Category",arrowIcon:a.jsx(lf,{className:"w-6"})})]}):a.jsxs(se,{color:"primary",onClick:r,className:"rounded-md",children:[a.jsx(ov,{className:"w-7"}),a.jsx("span",{className:"font-playwriteCU leading-[2.2]",children:"Login"})]})})]})}function pH(){const[t,e]=h.useState([]),{user:n}=xe(),[r,s]=h.useState(!0),i=h.useRef(!1),o=async()=>{try{s(!0);let l=[];if(n){const c=[...n.recent_song_ids],u=c[Math.floor(Math.random()*c.length)],d=await Wt({collectionName:"Songs",id:u});if(d.exists()){const m={...d.data(),id:d.id,queue_id:""},p=await Gx(m);p.length&&(l=p)}}else{const c=It()["recent-songs"]||[];if(c.length){const u=c[Math.floor(Math.random()*c.length)],d=await Gx(u);d.length?l=d:l=c}}if(!l.length){const c=le(_t,Lt("created_at","desc"),Mt(8));l=await $t(c,{msg:"useGetRecommendSongs, get new songs"})}e(l)}catch(l){console.log(l)}finally{s(!1)}};return h.useEffect(()=>{i.current||(i.current=!0,o())},[]),{songs:t,getRecomemdedSongs:o,isFetching:r}}function gH(){const{songs:t,isFetching:e}=pH(),{handleSetSong:n}=_r({variant:"songs"});return a.jsx(a.Fragment,{children:a.jsx(En,{children:a.jsxs("div",{children:[a.jsx(ee,{title:"Recommend"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-4 mt-3",children:e?Rs:a.jsx(Sr,{songs:t,setSong:r=>n(r.queue_id,t)})})]})})})}function xH(){const{homePage:t}=Bn(),{isFetching:e}=eN();return e?a.jsx(ze,{children:a.jsx(ua,{})}):t?a.jsxs(a.Fragment,{children:[a.jsxs(mo,{children:[a.jsx(ZR,{categoryIds:t!=null&&t.category_ids?t==null?void 0:t.category_ids.split("_"):[]}),a.jsx(mH,{}),t==null?void 0:t.playlist_sections.map((n,r)=>a.jsx(Ow,{playlistIds:n.target_ids?n.target_ids.split("_"):[]},r)),a.jsx(gH,{}),a.jsx(MU,{}),a.jsx(YR,{amount:5}),a.jsx(fH,{amount:5}),a.jsx(DU,{})]}),a.jsx(ui,{})]}):a.jsx(Re,{})}function yH(){const t=on(),{setSuccessToast:e}=te(),{selectedSongs:n,resetSelect:r}=ho(),s=()=>{t(np({songs:n})),e(`${n.length>1?"Songs":"Song"} added to queue`),r()};return a.jsxs("button",{onClick:s,children:[a.jsx(zt,{className:"w-5"}),a.jsx("span",{className:"",children:"Add to queue"})]})}function vH(){const{selectedSongs:t,resetSelect:e}=ho(),n=h.useRef(null);return a.jsxs(a.Fragment,{children:[a.jsxs("button",{onClick:()=>{var r;return(r=n.current)==null?void 0:r.open()},children:[a.jsx(Es,{className:"w-5"}),a.jsx("span",{children:"Add to playlist"})]}),a.jsx(ce,{variant:"animation",ref:n,children:a.jsx(ip,{closeModal:()=>{var r;(r=n.current)==null||r.close(),e()},songs:t})})]})}function lp({children:t,selectAll:e}){const{user:n}=xe(),{isSelectAll:r,isChecked:s,resetSelect:i,selectedSongs:o}=ho(),l=a.jsxs(a.Fragment,{children:[e&&a.jsx("button",{onClick:e,className:"ml-[10px]",children:r?a.jsx(aa,{className:"w-[20px]"}):a.jsx(mv,{className:"w-[20px]"})}),a.jsx("span",{className:"font-semibold opacity-[.5]",children:o.length}),a.jsxs("div",{className:"flex space-x-2 items-center [&>button]:bg-[--a-5-cl]  [&>button]:inline-flex [&>button]:space-x-1.5 [&_span]:text-sm [&_span]:font-medium [&>button]:py-1 [&>button]:px-3 [&>button]:rounded-full",children:[a.jsx(yH,{}),n&&a.jsx(vH,{})]}),a.jsx("button",{onClick:i,className:"flex-shrink-0",children:a.jsx(Xu,{className:"w-5"})})]});return a.jsx("div",{className:"flex items-center space-x-2 h-[44px]",children:s?l:t})}function tN(){const{user:t,updateUserData:e}=xe();return{updatePlaylist:async r=>{if(t){if(!t.recent_playlist_ids.find(i=>i===r.id)){const o={recent_playlist_ids:[...t.recent_playlist_ids,r.id]};await Se({collectionName:"Users",data:o,id:t.email}),e(o)}}else{const s=It()["recent-playlists"]||[];s.find(o=>o.id===r.id)||(s.push(r),rt("recent-playlists",s))}}}}const wH=a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"h-[30px] mb-[10px] flex items-center",children:a.jsx(ge,{className:"h-[20px] w-[90px]"})}),Rs]});function _H({variant:t,loading:e}){const{playlistSongs:n,currentPlaylist:r}=oe(ha),{handleSetSong:s}=_r({variant:"playlist"}),{updatePlaylist:i}=tN(),o=(r==null?void 0:r.is_album)&&!!(r!=null&&r.image_url),l=c=>{if(!r)return;s(c.queue_id,n)&&i(r)};return e?wH:a.jsx(a.Fragment,{children:a.jsxs(En,{children:[!!n.length&&a.jsx(lp,{variant:t==="others-playlist"?"system-song":"own-playlist",children:a.jsxs("p",{className:"font-[500] opacity-[.5]",children:[n.length," Songs"]})}),a.jsx(Sr,{imageUrl:o?r.image_url:"",songs:n,setSong:c=>l(c),songVariant:t==="my-playlist"?"own-playlist":"system-song"})]})})}function gi(){const t=on(),{playerConfig:{isShuffle:e,repeat:n,isCrossFade:r},updatePlayerConfig:s,firstTimeSongLoaded:i,audioRef:o,timelineEleRef:l,currentTimeEleRef:c,isPlayingNewSong:u,shouldSyncSongDuration:d,timeLineColorRef:m}=ut(),{currentSongData:p,queueSongs:g}=oe(We),{playStatus:x}=oe(Un),w=h.useRef(0),v=()=>{l.current&&c.current&&(c.current.innerText="0:00",l.current.style.background="var-(--a-5-cl)")},S=async()=>{try{if(d.current){d.current=!1;const N=It().current_time||0;o.current.currentTime=N}await o.current.play(),u.current&&(r&&(o.current.volume=0),u.current=!1)}catch{}},_=()=>{o.current.pause()},E=()=>{x==="playing"&&_(),x==="paused"&&S()},I=R=>{const N=l.current,M=c.current,A=R||o.current.currentTime;if(o.current.duration&&N){const fe=A/(o.current.duration/100);N.style.background=Nw(+fe.toFixed(1),{color:m.current||void 0})}M&&(M.innerText=ea(A)||"0:00")};return{toggleRepeat:()=>{let R;switch(n){case"no":R="one";break;case"one":R="all";break;case"all":R="no";break;default:R="no"}rt("repeat",R),s({repeat:R})},toggleShuffle:()=>{const R=!e;s({isShuffle:R}),rt("isShuffle",R)},next:()=>{if(!p)return;let R=p.index+1,N;R<g.length?N=g[R]:(R=0,N=g[0]),t(Is(N.queue_id))},previous:()=>{if(!p)return;let R=p.index-1,N;R>=0?N=g[R]:(N=g[g.length-1],R=g.length-1),t(Is(N.queue_id))},repeat:n,isShuffle:e,updateProgressElement:I,handleSeek:R=>{const N=R.target;if(l.current){const M=N.getBoundingClientRect(),fe=(R.clientX-M.left)/l.current.offsetWidth,Le=Math.round(fe*o.current.duration),de=o.current.currentTime;if(w.current&&Math.abs(de-w.current)<1&&Math.abs(Le-w.current)<1)return;I(Le),i.current?rt("current_time",Le):o.current.currentTime=Le,w.current=Le}},handlePlayPause:E,play:S,pause:_,resetForNewSong:v}}function Vg({onClick:t,children:e,text:n}){const{playlistSongs:r}=oe(ha);return a.jsxs(se,{onClick:t,disabled:!r.length,size:"clear",color:"primary",className:"rounded-full px-5 py-1",children:[e,a.jsx("span",{className:"font-playwriteCU leading-[2.2]",children:n})]})}function SH(){const{currentPlaylist:t,playlistSongs:e}=oe(ha),{currentSongData:n}=oe(We),{playStatus:r}=oe(Un),{handlePlayPause:s}=gi(),{handleSetSong:i}=_r({variant:"playlist"}),{updatePlaylist:o}=tN(),l=()=>{if(!t)return;const c=e[0];i(c.queue_id,e)&&o(t)};if(!t)return a.jsx(a.Fragment,{});if(n!=null&&n.song.queue_id.includes(t.id))switch(r){case"playing":case"waiting":return a.jsx(Vg,{text:"Pause",onClick:s,children:a.jsx(fv,{className:"w-7 mr-1"})});case"loading":case"paused":return a.jsx(Vg,{text:"Continue",onClick:s,children:a.jsx(cf,{className:"w-7 mr-1"})})}return a.jsx(Vg,{text:"Play",onClick:l,children:a.jsx(cf,{className:"w-7 mr-1"})})}function nN(){const t=on(),{user:e,updateUserData:n}=xe(),{setFavoritePlaylists:r,ownPlaylists:s,favoritePlaylists:i,setOwnPlaylists:o,shouldFetchFavoritePlaylists:l}=it(),[c,u]=h.useState(!1),{setSuccessToast:d,setErrorToast:m}=te(),p=Nt();return{isFetching:c,action:async x=>{try{if(!e)throw new Error("user not found");u(!0);const w=mi(ie),v=st(ie,"Users",e.email),S=st(ie,"Playlists",x.playlist.id),_=e.liked_playlist_ids.includes(x.playlist.id);switch(x.variant){case"like":{if(!e)throw Error();const E=[...e.liked_playlist_ids],I=E.findIndex(k=>k===x.playlist.id),P=I===-1;P?E.unshift(x.playlist.id):E.splice(I,1);const F={liked_playlist_ids:E},j={like:Ks(P?1:-1)};w.update(v,F),w.update(S,j),await w.commit(),r(P?k=>[x.playlist,...k]:k=>k.filter(C=>C.id!==x.playlist.id)),d(P?"Liked":"Disliked"),n(F);break}case"edit":{const{data:E,playlist:I,imageFile:P}=x,F={...I,...E};if(P){const N=await pi({imageFile:P});I.image_file_id&&Gt({fileId:I.image_file_id}),Object.assign(F,N)}await Se({collectionName:"Playlists",data:F,id:I.id,msg:">>> api: update playlist doc"});const j=[...s],k=j.findIndex(N=>N.id===I.id);k!==-1&&(j[k]=F,o(j),_&&(l.current=!0));const{updated_at:C,...R}=F;t(jU(R)),d("Playlist edited");break}case"delete":{const{playlist:E}=x;E.image_file_id&&Gt({fileId:E.image_file_id});const I=await bt(le(Xa,Q("target_id","==",E.id))),P={liked_playlist_ids:e.liked_playlist_ids.filter(j=>j!==E.id)};w.delete(S),w.update(v,P),I.empty||(console.log(`Delete ${I.docs.length} comments`),I.forEach(j=>w.delete(j.ref))),await w.commit();const F=s.filter(j=>j.id!==E.id);if(o(F),_){const j=i.filter(k=>k.id!==E.id);r(j)}d(`Playlist '${E.name}' deleted`),n(P),p("/my-music");break}}}catch(w){console.log({message:w}),m()}finally{u(!1)}},user:e}}function bH({isLiked:t,playlist:e,className:n=""}){const{action:r,isFetching:s}=nN();return a.jsx(se,{size:"clear",onClick:()=>r({variant:"like",playlist:e}),className:`${n}`,children:s?a.jsx(Ae,{className:"w-5 animate-spin"}):a.jsx(a.Fragment,{children:t?a.jsx(zl,{className:"w-5 text-[--primary-cl]"}):a.jsx(Au,{className:"w-5"})})})}function EH(){return a.jsx(a.Fragment,{children:a.jsx(rN,{children:a.jsx(Rw,{})})})}function kH(){const{currentPlaylist:t}=oe(ha),[e,n]=h.useState(""),r=h.useRef(null),{action:s,isFetching:i}=nN(),o=d=>{var m;n(d),(m=r.current)==null||m.open()},l=()=>{var d;return(d=r.current)==null?void 0:d.close()},c=async(d,m)=>{t&&(await s({variant:"edit",playlist:t,data:d,imageFile:m}),l())},u=()=>{if(!t)return a.jsx(a.Fragment,{});switch(e){case"":return a.jsx(a.Fragment,{});case"edit":return a.jsx(_e,{className:"w-[600px]",children:a.jsx(Gl,{isLoading:i,playlist:t,submit:c,variant:"edit",modalRef:r})});case"delete":return a.jsx(qt,{loading:i,label:`Delete playlist ' ${t.name} ' ?`,callback:()=>s({variant:"delete",playlist:t}),closeModal:l})}};return a.jsxs(a.Fragment,{children:[a.jsxs(rN,{children:[a.jsx(Rw,{}),a.jsxs("button",{onClick:()=>o("edit"),children:[a.jsx(Dr,{}),a.jsx("span",{children:"Edit"})]}),a.jsxs("button",{onClick:()=>o("delete"),children:[a.jsx(pt,{}),a.jsx("span",{children:"Delete"})]})]}),a.jsx(ce,{variant:"animation",ref:r,children:u()})]})}function rN({children:t}){return a.jsx(Dn,{className:"left-[calc(100%)] bottom-full w-[140px]",animationClassName:"origin-top-left",children:a.jsx(er,{children:a.jsx(Or,{children:t})})})}function jH({variant:t}){return a.jsx(a.Fragment,{children:a.jsxs(Fn,{children:[a.jsx(Mn,{children:a.jsx(se,{size:"clear",children:a.jsx(iv,{className:"w-5"})})}),t==="others-playlist"?a.jsx(EH,{}):a.jsx(kH,{})]})})}function TH({target:t}){const[e,n]=h.useState([]),[r,s]=h.useState(!1),[i,o]=h.useState(!0),l=h.useRef(!0);return{target:t,comments:e,isOpenComment:r,setIsOpenComment:s,setComments:n,shouldFetchComment:l,isFetching:i,setIsFetching:o}}const sN=h.createContext(null);function cp({children:t,target:e}){return a.jsx(sN.Provider,{value:TH({target:e}),children:t})}function On(){const t=h.useContext(sN);if(!t)throw new Error("CommentProvider not provided");return t}function iN({children:t}){return a.jsxs("div",{className:"h-[70vh] overflow-hidden text-white rounded-[16px_16px_0_0] relative p-3 flex flex-col",children:[a.jsx("div",{className:"bg-opacity-[0.8] bg-[#1f1f1f] backdrop-blur-[15px] z-[-1] absolute inset-0"}),t]})}function aN(){const{setErrorToast:t}=te(),{user:e,updateUserData:n}=xe(),{setComments:r,comments:s,target:i}=On(),[o,l]=h.useState(!1),c=h.useRef(null),u=async p=>(await qu.post({}.VITE_COMMENT_CHECK_ENDPOINT,{comment:p})).data.predicted_label==="toxic",d=(p,g)=>{const x={comment:Ks(g||1)};Se({collectionName:i==="song"?"Songs":"Playlists",data:x,id:p})};return{isFetching:o,action:async p=>{var g;try{if(!e)return;switch(l(!0),p.type){case"add":{if(await u(p.text)){(g=c.current)==null||g.open();return}const w=pE({user:e,target_id:p.target_id,text:p.text});d(p.target_id);const v=await Ts({collectionName:"Comments",data:w}),S=await _l(v);if(S.exists()){const _={...S.data(),id:v.id,replies:[]};r(E=>[_,...E]),l(!1)}break}case"reply":{const{comment:x,comment_index:w,text:v}=p;if(await u(p.text))return;const _=pE({user:e,target_id:x.target_id,text:v,comment_id:x.id});d(p.comment.target_id);const E=await Ts({collectionName:"Comments",data:_}),I=await _l(E);if(I.exists()){const P={reply:Ks(1)};await Se({collectionName:"Comments",data:P,id:x.id});const F={...I.data(),id:E.id,replies:[]},j=[...s];j[w]={...j[w],replies:[...j[w].replies,F]},r(j),l(!1)}break}case"like":{const x=[...e.liked_comment_ids],w=x.findIndex(E=>E===p.id),v=w===-1;v?x.push(p.id):x.splice(w,1);const S={like:Ks(v?1:-1)};await Se({collectionName:"Comments",data:S,id:p.id});const _={liked_comment_ids:x};rt("liked_comment_ids",x),n(_);break}case"delete":{const x=st(ie,"Comments",p.comment.id),w=mi(ie);if(w.delete(x),p.comment.reply){console.log(`Delete ${p.comment.reply} replies `);const _=le(Xa,Q("comment_id","==",p.comment.id));(await bt(_)).forEach(I=>{w.delete(I.ref)})}d(p.comment.target_id,-1),await w.commit();const v=[...e.liked_comment_ids],S=v.findIndex(_=>_===_);S!==-1&&(v.splice(S,1),rt("liked_comment_ids",v)),r(_=>_.filter(E=>E.id!==p.comment.id));break}}}catch(x){console.log({error:x}),t()}finally{l(!1)}},modalRef:c}}function oN(t){const e=t.toDate(),r=new Date().getTime()-e.getTime(),s=Math.floor(r/(1e3*60*60*24));return s?s+(s>1?" days ago":" day ago"):"Today"}const IH=["👍","❤️","😂","😮","😢","😡","😀","😊","😁","😂","🤣","😍","🤩","🥳","😎","😇","🤔","🤫","🤐","😐","😑","😒","🙄","😬","🤥","😌","👋","🙏","👏","🙌","👌","💯","🔥","✨","🎉","🚀","👍","👎","💪","💖"];function CH(){const[t,e]=h.useState(""),n=h.useRef(null),r=s=>{const i=n.current;if(i){const o=i.selectionStart,l=i.selectionEnd;e(t.substring(0,o)+s+t.substring(l)),setTimeout(()=>{i.focus(),i.selectionStart=i.selectionEnd=o+s.length},0)}};return h.useEffect(()=>{n.current&&(n.current.style.height="auto",n.current.scrollHeight>n.current.offsetHeight&&(n.current.style.height=n.current.scrollHeight+"px"))},[t]),{EMOJIS:IH,addEmoji:r,textareaRef:n,value:t,setValue:e}}function up({onSubmited:t,bg:e="bg-[--a-10-cl]",...n}){const{user:r}=xe(),{action:s,isFetching:i,modalRef:o}=aN(),{EMOJIS:l,textareaRef:c,addEmoji:u,value:d,setValue:m}=CH(),p=async()=>{if(!(!d||!d.trim())){switch(n.variant){case"comment":await s({type:"add",target_id:n.targetId,text:d});break;case"reply":await s({type:"reply",text:d,comment:n.comment,comment_index:n.commentIndex});break}m(""),t&&t()}},g=n.variant==="comment"?"...":`Reply to ${n.comment.user_name}...`;return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex w-full",children:[a.jsx("div",{className:"w-[40px] h-[40px] flex-shrink-0",children:a.jsx(Ce,{src:r==null?void 0:r.photo_url,className:"rounded-full"})}),a.jsxs("div",{className:`rounded-lg ml-2 flex-grow  p-1.5 flex items-end ${e}`,children:[a.jsx("textarea",{ref:c,placeholder:g,value:d,onChange:x=>m(x.target.value),rows:1,className:`${dl} no-scrollbar resize-none max-h-[30vh] w-full !bg-transparent border-none`}),a.jsxs(Fn,{appendOnPortal:!0,children:[a.jsx(Mn,{children:a.jsx("button",{className:"hover p-1.5 hover:bg-[--a-5-cl] rounded-full",children:a.jsx(sz,{className:"w-6"})})}),a.jsx(Dn,{children:a.jsx(er,{className:"w-[270px]",children:a.jsx("div",{className:"p-1.5 grid grid-cols-5 justify-items-center max-h-60 overflow-y-auto pr-2",children:l.map((x,w)=>a.jsx("button",{onClick:()=>u(x),className:"p-1 rounded-md hover:bg-gray-200 focus:outline-none focus:ring-1 focus:ring-blue-300  text-2xl","aria-label":`Insert emoji ${x}`,children:x},w))})})})]}),a.jsx("button",{onClick:p,className:"text-[--primary-cl] p-1.5 hover:bg-white/10 rounded-full",children:i?a.jsx(EC,{className:"w-6 animate-spin"}):a.jsx(qa,{className:"w-6"})})]})]}),a.jsx(ce,{variant:"animation",ref:o,children:a.jsxs(_e,{children:[a.jsx(Ce,{className:"w-[130px] mx-auto",src:"https://zalo-api.zadn.vn/api/emoticon/sticker/webpc?eid=46991&size=130"}),a.jsx(ee,{variant:"h2",className:"text-center",title:"Your commment is not allow"}),a.jsx("p",{className:"mt-5 text-right",children:a.jsx(se,{onClick:()=>{var x;return(x=o.current)==null?void 0:x.close()},color:"primary",children:"Ok"})})]})})]})}function RH({comment:t,commentIndex:e}){const{comments:n,setComments:r}=On(),[s,i]=h.useState(!1),{fetchComment:o}=sp(),l=async()=>{try{i(!0);const c=await o({comment_id:t.id});if(c){const u=[...n];u[e]={...u[e],replies:c},r(u)}}catch(c){console.log({error:c})}finally{i(!1)}};return a.jsxs("button",{onClick:l,className:"mt-1 text-[#ccc] flex items-center space-x-1",children:[a.jsxs("span",{children:["View ",t.reply," replies"]}),s?a.jsx(Ae,{className:"w-5 animate-spin"}):a.jsx(X$,{className:"w-5"})]})}function lN({comment:t,index:e,level:n,variant:r="dark-bg"}){const{user:s}=xe(),{action:i,isFetching:o}=aN(),[l,c]=h.useState(!1),u=h.useRef("like"),d=h.useRef(null),m=s==null?void 0:s.liked_comment_ids.includes(t.id),p=(s==null?void 0:s.email)===t.user_email,g=async()=>{var x;await i({type:"delete",comment:t}),(x=d.current)==null||x.close()};return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:`${n==1?"py-3":"mt-2"} `,children:a.jsxs("div",{className:"flex w-full items-start space-x-1.5",children:[a.jsx("div",{className:`flex-shrink-0 ${n===1?"w-[40px] h-[40px]":"w-[36px] h-[36px]"} rounded-full overflow-hidden`,children:a.jsx(Ce,{src:t.user_image_url})}),a.jsxs("div",{className:"flex-grow text-[13px]",children:[a.jsxs("div",{className:"flex",children:[a.jsxs("div",{className:"flex-grow ml-2",children:[a.jsxs("div",{className:`rounded-md ${r==="theme-bg"?"text-black dark:text-white":"text-white"}`,children:[a.jsx(X,{className:`font-medium line-clamp-1 ${r==="theme-bg"?"text-[#333] dark:text-[#f1f1f1]":"text-[#f1f1f1]"}`,to:`/user/${t.user_email}`,children:t.user_name}),a.jsx("div",{className:"text-base mt-1 break-all whitespace-break-spaces",children:t.text})]}),a.jsxs("div",{className:"flex space-x-2 mt-1",children:[a.jsx("span",{className:"opacity-[.7]",children:oN(t.created_at)}),s&&a.jsx(a.Fragment,{children:p?a.jsx("button",{onClick:()=>{var x;u.current="delete",(x=d.current)==null||x.open()},children:"Delete"}):n===1&&a.jsx("button",{onClick:()=>c(!0),children:"Reply"})})]}),!!t.reply&&n===1&&!t.replies.length&&a.jsx(RH,{comment:t,commentIndex:e})]}),a.jsxs("div",{className:"flex flex-col items-center",children:[a.jsx("button",{className:"p-1",onClick:()=>{u.current="like",i({type:"like",id:t.id})},children:o&&u.current==="like"?a.jsx(Ae,{className:"w-6 animate-spin"}):a.jsx(a.Fragment,{children:m?a.jsx(zl,{className:"w-6 text-red-500"}):a.jsx(Au,{className:"w-6"})})}),a.jsx("span",{children:t.like})]})]}),!!t.replies.length&&t.replies.map((x,w)=>a.jsx(lN,{comment:x,index:e,level:2},w)),l&&a.jsx("div",{className:"mt-2",children:a.jsx(up,{onSubmited:()=>c(!1),commentIndex:e,variant:"reply",comment:t})})]})]})}),a.jsx(ce,{variant:"animation",ref:d,children:a.jsx(qt,{label:"Delete comment",closeModal:()=>{var x;return(x=d.current)==null?void 0:x.close()},loading:o,callback:g})})]})}function $w({comments:t,isFetching:e=!1,className:n="",variant:r}){return a.jsx(a.Fragment,{children:a.jsxs("div",{className:`flex-grow relative overflow-auto no-scrollbar ${n}`,children:[e&&a.jsx(ze,{children:a.jsx(Ae,{className:"animate-spin w-7"})}),!e&&a.jsx(a.Fragment,{children:t.length?t.map((s,i)=>a.jsx(lN,{variant:r,level:1,index:i,comment:s},s.id)):a.jsx("p",{className:"text-center",children:"..."})})]})})}function NH(){const{shouldFetchComment:t,setComments:e,isOpenComment:n,setIsFetching:r}=On(),{currentPlaylist:s}=oe(ha),{fetchComment:i}=sp({setIsFetchingFromParent:r}),o=async()=>{if(!s)return;const l=await i({target_id:s.id});e(l||[])};h.useEffect(()=>{!n||!s||t.current&&(t.current=!1,o())},[n])}function yE({targetId:t}){const{isFetching:e,comments:n}=On();return NH(),e?a.jsx(ze,{children:a.jsx(Ae,{className:"w-6 animate-spin"})}):a.jsxs(a.Fragment,{children:[a.jsx($w,{comments:n}),a.jsx(up,{variant:"comment",targetId:t})]})}function AH({playlist:t}){const{isOnMobile:e}=ss(),{setIsOpenComment:n}=On(),r=h.useRef(null),s=()=>{var i;(i=r.current)==null||i.open(),n(!0)};return a.jsxs(a.Fragment,{children:[a.jsx(se,{size:"clear",onClick:()=>s(),children:a.jsx(cv,{className:"w-5"})}),!e&&a.jsx(ce,{onClose:()=>n(!1),variant:"animation",ref:r,children:a.jsx(_e,{className:"h-[400px] w-[500px]",children:a.jsx(yE,{targetId:t.id})})}),e&&a.jsx(Mx,{ref:r,onClose:()=>n(!1),children:a.jsx(iN,{children:a.jsx(yE,{targetId:t.id})})})]})}const El=(t,e)=>!(t!=null&&t.seconds)||!(t!=null&&t.seconds)?"":(e==null?void 0:e.type)==="date"?new Date(t==null?void 0:t.toDate()).toLocaleDateString("en-GB"):new Date(t==null?void 0:t.toDate()).toLocaleString();function PH({playlist:t,showSkeleton:e,isLiked:n,variant:r}){const{currentSongData:s}=oe(We),i=t?s==null?void 0:s.song.queue_id.includes(`${t.id}`):!1,o={container:"flex flex-col md:flex-row lg:flex-col",smallText:"",link:"hover:text-[--primary-cl] hover:underline"},l=()=>t?a.jsxs(a.Fragment,{children:[a.jsx(X,{className:`block hover:underline hover:text-[--primary-cl] ${o.smallText}`,to:`/singer/${t.singers[0].id}`,children:t.singers[0].name}),a.jsxs("p",{className:"text-sm",children:[a.jsx("span",{children:"❤️ "}),ns(t.like)]})]}):a.jsx(a.Fragment,{}),c=()=>{if(!t)return a.jsx(a.Fragment,{});switch(r){case"my-playlist":return a.jsx(a.Fragment,{children:a.jsx("p",{className:o.smallText,children:t.is_public?"Public":"Private"})});case"others-playlist":return a.jsxs(a.Fragment,{children:[a.jsxs("p",{children:[a.jsx("span",{className:"text-base",children:"❤️ "}),ns(t.like)]}),!!t.singers.length&&a.jsx("p",{className:o.smallText,children:t.singers.map((u,d)=>a.jsx(X,{className:`${o.link}`,to:`/singer/${u.id}`,children:(d?", ":"")+u.name},d))}),!t.is_official&&a.jsxs("p",{className:o.smallText,children:["Provided by"," ",a.jsx(X,{className:o.link,to:`/user/${t.owner_email}`,children:t.distributor})]}),a.jsxs("p",{className:o.smallText,children:["Last update:"," ",El(t.updated_at,{type:"date"})]})]})}};return a.jsx(a.Fragment,{children:a.jsxs("div",{className:o.container,children:[a.jsx("div",{className:"w-[250px] md:w-[200px] mx-auto md:m-0 lg:w-full",children:e?a.jsx(ge,{className:"pt-[100%] rounded-lg"}):t&&a.jsx(Nf,{data:t,active:i,variant:"image"})}),a.jsxs("div",{className:"flex flex-col items-center mt-3 md:items-start md:ml-5 md:mt-0 lg:ml-0 lg:mt-3 lg:items-center",children:[e?a.jsxs("div",{className:"space-y-1 flex flex-col items-center",children:[a.jsx(ge,{className:"h-[24px] w-[170px]"}),a.jsx(ge,{className:"h-[17px] w-[170px]"}),a.jsx(ge,{className:"h-[17px] w-[60px]"}),a.jsx(ge,{className:"h-[17px] w-[100px]"})]}):t&&a.jsxs(a.Fragment,{children:[a.jsx(ee,{className:"text-center",variant:"h2",title:t.name}),a.jsx("div",{className:"mt-2.5 text-[#666] text-center md:text-left lg:text-center text-sm",children:t.is_album?l():c()})]}),t&&a.jsxs("div",{className:"flex flex-col items-center mt-3 md:flex-row md:mt-auto lg:flex-col lg:mt-3",children:[a.jsx(SH,{}),a.jsxs("div",{className:"flex space-x-3 mt-3 md:ml-3 md:mt-0 lg:mt-3 lg:ml-0 hover:[&_button]:bg-[--a-5-cl] [&_button]:p-2",children:[a.jsx(jH,{variant:r}),n!==null&&a.jsx(bH,{isLiked:n,playlist:t}),a.jsx(cp,{target:"playlist",children:a.jsx(AH,{playlist:t})})]})]})]})]})})}function FH(){const{currentPlaylist:t}=oe(ha),{user:e}=xe(),n=e&&t?t.owner_email===e.email&&!t.is_official:!1,r=e?t?e.liked_playlist_ids.includes(t.id):!1:null,{isFetching:s}=RU();return!s&&!t?a.jsx(ze,{children:a.jsx(Re,{variant:"with-home-button"})}):a.jsxs(a.Fragment,{children:[a.jsx(mo,{children:a.jsxs("div",{className:"lg:flex lg:-mx-3",children:[a.jsx("div",{className:"w-full lg:w-1/4 lg:px-3",children:a.jsx(PH,{showSkeleton:s,variant:n?"my-playlist":"others-playlist",playlist:t,isLiked:r})}),a.jsx("div",{className:"w-full lg:w-3/4 lg:px-3",children:a.jsx("div",{className:"mt-[30px] lg:mt-0",children:a.jsx(_H,{loading:s,variant:n?"my-playlist":"others-playlist"})})})]})}),a.jsx(ui,{})]})}function zw({tab:t}){const{user:e}=xe(),{favoriteSongs:n,setUploadedSongs:r,setFavoriteSongs:s,shouldFetchUserSongs:i,shouldFetchFavoriteSongs:o}=it(),{setErrorToast:l}=te(),[c,u]=h.useState(!0);return{isFetching:c,getSongs:async()=>{if(e)try{switch(t){case"favorite":{if(o.current){if(o.current=!1,e.liked_song_ids.length){const p=[];for(let x=0;x<e.liked_song_ids.length;x+=30)p.push(e.liked_song_ids.slice(x,x+30));const g=[];for(const x of p)if(x.length>0){const w=le(_t,Q(Lr(),"in",x)),v=await $t(w);g.push(...v)}return s(g),g}}else return await Jn(100),n;break}case"uploaded":if(i.current){i.current=!1;const m=le(_t,Q("owner_email","==",e.email),Q("is_official","==",!1)),p=await $t(m);r(p)}else await Jn(100)}}catch(m){console.log({message:m}),l()}finally{u(!1)}}}}function MH(){const{favoriteSongs:t}=it(),{user:e}=xe(),{handleSetSong:n}=_r({variant:"songs"}),{getSongs:r,isFetching:s}=zw({tab:"favorite"}),i=o=>{n(o.queue_id,t)};if(h.useEffect(()=>{r()},[]),!!e)return a.jsxs(En,{children:[a.jsx(lp,{variant:"favorite-song",children:s?a.jsx(ge,{className:"h-[20px] w-[90px]"}):a.jsxs("p",{className:"font-[500] opacity-[.5]",children:[t.length," Songs"]})}),s&&Rs,!s&&a.jsx(Sr,{setSong:i,songs:t})]})}function DH({song:t}){return a.jsxs("div",{className:"flex items-center justify-between p-[10px]",children:[a.jsxs("div",{className:"flex-grow flex",children:[a.jsx(oa,{className:"w-[18px] mr-2.5"}),a.jsx("div",{className:"h-[54px] w-[54px] rounded overflow-hidden",children:a.jsx(Ce,{src:t.image_url})}),a.jsxs("div",{className:"ml-[10px]",children:[a.jsx("h5",{className:"line-clamp-1 font-medium overflow-hidden",children:t.name}),a.jsx("p",{className:"opacity-[.7] leading-[1.2] line-clamp-1 text-sm",children:t.singers[0].name})]})]}),a.jsxs("div",{className:"flex space-x-1",children:[a.jsx(Ae,{className:"animate-spin w-5"}),a.jsx("p",{className:"text-sm",children:"Uploading..."})]})]})}function LH(){const{uploadedSongs:t}=it(),{user:e}=xe(),n=h.useRef(null),{uploadingSongs:r,isUploading:s}=xC(),{handleSetSong:i}=_r({variant:"songs"}),{isFetching:o,getSongs:l}=zw({tab:"uploaded"}),c=d=>{i(d,t)},u=h.useMemo(()=>o?0:r.length+t.length,[r,t,o]);return h.useEffect(()=>{l()},[]),e?a.jsxs(En,{children:[a.jsx("label",{htmlFor:"song_upload",className:"hidden",ref:n}),a.jsx(lp,{variant:"uploaded-song",children:o?a.jsx(a.Fragment,{children:a.jsx("div",{className:"h-[30px] mb-[10px] flex items-center",children:a.jsx(ge,{className:"h-[20px] w-[90px]"})})}):a.jsxs("div",{className:"flex justify-between items-center w-full",children:[a.jsxs("p",{className:"font-[500] opacity-[.5]",children:[u," Songs"]}),a.jsxs(se,{onClick:()=>{var d;return(d=n.current)==null?void 0:d.click()},color:"primary",disabled:s,children:[a.jsx(lv,{className:"w-5"}),a.jsx("span",{className:"",children:"Upload"})]})]})}),a.jsxs("div",{className:"",children:[o&&Rs,!o&&a.jsx(a.Fragment,{children:u?a.jsxs(a.Fragment,{children:[!!t.length&&a.jsx(Sr,{setSong:d=>c(d.queue_id),songs:t,songVariant:"own-song"}),r.map((d,m)=>a.jsx(DH,{song:d},m))]}):a.jsx(Re,{variant:"less"})})]})]}):a.jsx(a.Fragment,{})}function cN(){const{user:t}=xe(),{shouldFetchUserSingers:e,setSingers:n,singers:r}=it(),{setErrorToast:s}=te(),[i,o]=h.useState(!0);return{isFetching:i,singers:r,user:t,setIsFetching:o,getSinger:async()=>{try{if(!t)return;if(o(!0),e.current&&t.liked_singer_ids.length){e.current=!1;const c=le(Qa,Q(Lr(),"in",t.liked_singer_ids)),u=await wu(c);return n(u),u}else return await Jn(100),r}catch(c){console.log({message:c}),s()}finally{o(!1)}}}}function Wx({singers:t,whenEmpty:e,loading:n=!1,skeNumber:r=4,className:s="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 "}){const i=[...Array(r).keys()].map(o=>a.jsx(hE,{variant:"skeleton"},o));return a.jsxs("div",{className:!n&&!t.length?"":`-mt-3 -mx-3 ${s}`,children:[n&&i,!n&&a.jsx(a.Fragment,{children:t.length?t.map((o,l)=>a.jsx(hE,{variant:"singer-item",singer:o},l)):e||a.jsx(Re,{className:"mx-auto",variant:"less"})})]})}function OH(){const{isFetching:t,singers:e,getSinger:n}=cN();return h.useEffect(()=>{n()},[]),t?a.jsxs(a.Fragment,{children:[a.jsx(ge,{className:"h-[48px] w-[160px]"}),a.jsx(Wx,{loading:t,singers:[]})]}):!t&&!e.length?a.jsx(a.Fragment,{}):a.jsx(a.Fragment,{children:a.jsxs("div",{children:[a.jsx(ee,{className:"mb-5",title:"Singers"}),a.jsx(Wx,{singers:e})]})})}function $H(){const{checkEntireUser:t}=it(),[e,n]=h.useState(!t.current),{getSinger:r}=cN(),{getSongs:s}=zw({tab:"favorite"}),i=async()=>{try{await Promise.all([r(),s()])}catch(o){console.log(o)}finally{n(!1)}};return h.useEffect(()=>{t.current||(t.current=!0,i())},[]),{isFetching:e}}const zH=["Favorite","Own"];function BH(){const{user:t}=xe(),{setOwnPlaylists:e,shouldFetchOwnPlaylists:n,setFavoritePlaylists:r,shouldFetchFavoritePlaylists:s}=it(),[i,o]=h.useState(""),{setErrorToast:l}=te(),[c,u]=h.useState(!0),d=h.useRef(!1),m=async p=>{try{if(!t)return;const g=p||i;switch(u(!0),g){case"Favorite":{if(s.current){if(s.current=!1,!t.liked_playlist_ids.length)return;const x=le(vn,Q(Lr(),"in",t.liked_playlist_ids)),v=(await Ln(x,"useGetMyMusicPlaylist, get user favorite playlists")).filter(S=>!S.is_official&&S.owner_email===t.email?!0:!!S.is_public);r(v)}else await Jn(100);break}case"Own":{if(n.current){n.current=!1;const x=le(vn,Q("owner_email","==",t.email),Q("is_official","==",!1)),w=await Ln(x,"useGetMyMusicPlaylist, get user own playlists");e(w)}else await Jn(100);break}}}catch(g){console.log({message:g}),l()}finally{u(!1)}};return h.useEffect(()=>{const p=async()=>{const g=It().last_playlist_tab;await m(g),o(g||"Favorite")};d.current||(d.current=!0,p())}),h.useEffect(()=>{i&&m()},[i]),{isFetching:c,getPlaylist:m,setIsFetching:u,tab:i,setTab:o,tabs:zH}}function VH(){const{user:t}=xe(),{myMusicAddPlaylist:e,isFetching:n}=QR(),r=h.useRef(null),s=()=>{var o;return(o=r.current)==null?void 0:o.close()},i=async(o,l)=>{await e(o,l),s()};if(t)return a.jsxs(a.Fragment,{children:[a.jsxs(se,{onClick:()=>{var o;return(o=r.current)==null?void 0:o.open()},size:"clear",className:"py-1 px-4",color:"primary",children:[a.jsx(Es,{className:"w-6"}),a.jsx("span",{children:"Add new playlist"})]}),a.jsx(ce,{ref:r,variant:"animation",children:a.jsx(_e,{className:"w-[600px]",children:a.jsx(Gl,{modalRef:r,isLoading:n,variant:"add",user:t,submit:i})})})]})}function UH(){const{ownPlaylists:t,favoritePlaylists:e}=it(),{isFetching:n,setIsFetching:r,setTab:s,tab:i,tabs:o}=BH();return a.jsx(a.Fragment,{children:a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between items-center mb-2",children:[a.jsx(ee,{title:"Playlist"}),a.jsx(VH,{})]}),a.jsx("div",{className:"flex space-x-2 my-3",children:a.jsx(tr,{render:l=>l,setTab:l=>{r(!0),s(l),rt("last_playlist_tab",l)},tab:i,tabs:o})}),a.jsx(Hl,{loading:n,skeNumber:4,playlists:i==="Favorite"?e:t})]})})}const HH=["Favorite","Uploaded"];function GH(){const[t,e]=h.useState("Favorite");return a.jsxs(a.Fragment,{children:[a.jsxs(mo,{children:[a.jsx(UH,{}),a.jsx(OH,{}),a.jsxs("div",{children:[a.jsx(ee,{title:"Songs"}),a.jsx("div",{className:"flex space-x-2 my-3",children:a.jsx(tr,{render:n=>n,setTab:e,tab:t,tabs:HH})}),t==="Favorite"?a.jsx(MH,{}):a.jsx(LH,{})]})]}),a.jsx(ui,{})]})}function WH(){const{isFetching:t}=$H();return t?a.jsx(ze,{children:a.jsx(ua,{})}):a.jsx(GH,{})}function uN(){const{behind:t,ahead:e,shouldStoreLocation:n,setBehind:r,setAhead:s}=fC(),i=Zn(),o=Nt(),l=h.useMemo(()=>i.pathname+i.search,[i]);return{ahead:e,behind:t,backward:()=>{const m=[...t],p=m.pop();p&&(n.current=!1,s(g=>[...g,l]),r(m),o(p))},forward:()=>{const m=[...e],p=m.pop();p&&(n.current=!1,r(g=>[...g,l]),s(m),o(p))},goHome:()=>{o("/")}}}function dN({className:t=""}){const{backward:e,behind:n,goHome:r}=uN(),s=()=>{n.length?e():r()};return a.jsx(se,{onClick:s,className:`p-1.5 md:hidden z-[9] relative ${t}`,color:"primary",size:"clear",children:n.length?a.jsx(uv,{className:"w-6"}):a.jsx(Pu,{className:"w-6"})})}const qH=()=>{const[t,e]=h.useState(),[n,r]=h.useState(""),[s,i]=h.useState([]),[o,l]=h.useState([]),[c,u]=h.useState(!1),[d,m]=h.useState(!1),[p,g]=h.useState(!1),[x,w]=h.useState(),v=h.useRef(0),S=h.useMemo(()=>x!==void 0?o[x]:void 0,[x,o]);return{song:t,setSong:e,baseLyric:n,setBaseLyric:r,baseLyricArr:s,setBaseLyricArr:i,lyrics:o,setLyrics:l,updateLyric:(E,I)=>{l(P=>{const F={...P[E],...I};return P[E]=F,[...P]})},isFetching:c,setIsFetching:u,isChanged:d,setIsChanged:m,start:v,selectLyricIndex:x,setSelectLyricIndex:w,currentLyric:S,isPreview:p,setIsPreview:g}},hN=h.createContext(null);function KH({children:t}){return a.jsx(hN.Provider,{value:qH(),children:t})}const Kt=()=>{const t=h.useContext(hN);if(!t)throw new Error("Edit lyric context not found");return t};function QH({audioEle:t,isClickPlay:e}){const{start:n,baseLyricArr:r,lyrics:s,setLyrics:i,setIsChanged:o,song:l,setIsFetching:c,baseLyric:u}=Kt(),{setErrorToast:d,setSuccessToast:m}=te(),p=s.length>=r.length,g=e&&!!r.length&&!p;return{addLyric:()=>{if(!t||!r.length||!l||p)return;const S=+t.currentTime.toFixed(1);if(n.current===S)return;const _=r[s.length],E=mE({start:n.current,end:S,text:_});if(n.current=S,i(I=>[...I,E]),r.length===s.length+2){const I=r[r.length-1],P=mE({start:n.current,end:l.duration,text:I});i(F=>[...F,P])}o(!0)},removeLyric:()=>{if(s.length&&t){const S=s[s.length-1].start;n.current=S,t.currentTime=S,i(_=>_.slice(0,-1)),o(!0)}},isEnableAddBtn:g,submit:async()=>{try{if(c(!0),!l)return;const S=mi(ie),_={lyrics:JSON.stringify(s),base:u},E=st(ie,"Songs",l.id);if(l.lyric_id){const I=st(ie,"Lyrics",l.lyric_id);S.update(I,_)}else{const I=st(St(ie,"Lyrics")),P={lyric_id:I.id,updated_at:mt()};S.set(I,_),S.update(E,P)}await S.commit(),m("Edit lyric successful"),o(!1)}catch(S){console.log({error:S}),d()}finally{c(!1)}}}}function XH({closeModal:t}){const{setErrorToast:e,setSuccessToast:n}=te(),{song:r,setSong:s}=Kt(),[i,o]=h.useState(),[l,c]=h.useState(!1);return{songFile:i,song:r,setSongFile:o,isFetching:l,handleSubmit:async()=>{try{if(!i||!r)throw new Error;c(!0);const{fileId:d,url:m}=await ed({file:i,folder:"/songs/"}),p={beat_url:m,beat_file_id:d};await Se({collectionName:"Songs",id:r.id,data:p}),r.beat_file_id&&Gt({fileId:r.beat_file_id}),s(()=>({...r,...p})),n("Upload song beat successful"),t()}catch(d){console.log({error:d}),e()}finally{c(!1)}}}}function YH({closeModal:t}){const e=h.useRef(null),{songFile:n,setSongFile:r,isFetching:s,handleSubmit:i,song:o}=XH({closeModal:t}),l=c=>{var u;(u=c.target.files)!=null&&u.length&&r(c.target.files[0])};return a.jsxs(_e,{className:"w-[500px]",children:[a.jsx(Be,{title:"Song beat",closeModal:t}),a.jsx("label",{ref:e,className:"hidden",htmlFor:"song_upload"}),a.jsx("input",{onChange:l,type:"file",multiple:!0,accept:"audio",id:"song_upload",className:"hidden"}),o&&(n||(o==null?void 0:o.beat_url))&&a.jsx("audio",{src:n?URL.createObjectURL(n):o.beat_url,controls:!0}),a.jsx("p",{className:"mt-3",children:a.jsx(se,{onClick:()=>{var c;return(c=e.current)==null?void 0:c.click()},color:"primary",children:a.jsx(lv,{className:"w-5"})})}),a.jsx(se,{disabled:!n,onClick:i,isLoading:s,color:"primary",className:"mt-3 ml-auto font-playwriteCU",children:"Save"})]})}const JH=40;function ZH({closeModal:t}){const{baseLyric:e,setBaseLyric:n,baseLyricArr:r,setIsChanged:s,lyrics:i}=Kt(),[o,l]=h.useState(e),c=h.useRef(null),u=h.useRef(null),d=()=>{const p=o.split(/\r?\n/).filter(g=>g).filter(g=>g.trim()).join(`\r
`);n(p),s(!0),t()};function m(p){const g=[...r];return g[p]=`<div style="color: transparent; border-radius: 4px; background-color: var(--a-10-cl);">${g[p]}</div>`,g.join(`\r
`)}return h.useEffect(()=>{if(i.length&&c.current&&u.current){const p=JH*(i.length-1);c.current.scrollTop=p,u.current.style.paddingBottom=p+"px"}},[]),h.useEffect(()=>{const p=()=>{if(c.current&&u.current){const g=c.current.scrollTop;u.current.scrollTop=g}};return c.current&&c.current.addEventListener("scroll",p),()=>{c.current&&c.current.removeEventListener("scroll",p)}},[]),a.jsxs(_e,{className:"w-[500px]",children:[a.jsx(Be,{closeModal:t,title:"Edit lyric"}),a.jsxs("div",{className:`relative h-[60vh] overflow-hidden rounded-md ${location.hash.includes("/dashboard")?"bg-black/10":"bg-white/10"} `,children:[a.jsx("div",{ref:u,className:"whitespace-break-spaces text-transparent px-2 py-2 absolute leading-[40px] h-full overflow-auto top-0 left-0 w-full",dangerouslySetInnerHTML:{__html:m(i.length===r.length?i.length-1:i.length)}}),a.jsx("textarea",{style:{resize:"none"},ref:c,className:"absolute bg-transparent top-0 outline-none w-full leading-[40px] py-2 px-3 h-full no-scrollbar",value:o,onChange:p=>l(p.target.value)})]}),a.jsx("p",{className:"ml-auto mt-5",children:a.jsx(se,{onClick:d,color:"primary",className:"rounded-full",children:"Save"})})]})}function vE(t){const[e,n,r]=t.split(":"),[s,i]=r.split(",");return+n*60+ +s+ +i/1e3}function eG(t){const e=t.split(`
`),n=[];let r={start:0,end:0,text:"",cut:[],tune:{start:0,end:0,grow:[]}};for(let s=0;s<e.length;s++){const i=e[s].trim();if(!i){if(!r.text)continue;const o=r.text.trim(),l=o.split(" "),c=l.map(()=>[]),u=l.map(()=>0),d={text:o,tune:{start:r.start,end:r.end,grow:u},cut:c};Object.assign(r,d),n.push({...r}),r.text=""}if(isNaN(+i))if(i.includes("-->")){const[o,l]=i.split("-->").map(d=>d.trim()),c=vE(o),u=vE(l);if(isNaN(c)||isNaN(u))throw new Error(`Error at '${s}'`);Object.assign(r,{start:c,end:u})}else r.text+=i.trim()+" "}return n}function tG(){const{setErrorToast:t}=te(),{setLyrics:e,setIsChanged:n,setIsPreview:r}=Kt();return{handleInputChange:i=>{if(!i.target.files)return;const o=i.target.files[0],l=["json","srt"],c=o.name.split(".")[o.name.split(".").length-1],u=new FileReader;u.onload=d=>{var m,p;try{if(!((m=d.target)!=null&&m.result)||typeof d.target.result!="string")return;if(c==="json"){const g=JSON.parse(((p=d.target)==null?void 0:p.result)||"[]");e(g)}else{const g=eG(d.target.result);e(g)}n(!0),r(!0)}catch(g){console.log(g),t(g.message||"")}finally{i.target.value=""}},l.includes(c)?u.readAsText(o):(t("File not supported"),i.target.value="")}}}function nG(){const{lyrics:t,song:e}=Kt(),n=(s,i)=>{if(!e)return;const o=new Blob([s],{type:"application/json"}),l=URL.createObjectURL(o),c=document.createElement("a");c.href=l,c.download=`lyric_${bn(e.name)}.${i}`,c.click(),URL.revokeObjectURL(l)};return{exportLyric:({type:s})=>{switch(s){case"json":n(JSON.stringify(t,null,2),"json");break;case"srt":{let i="";const o=l=>{const c=Math.floor(l/60),u=Math.floor(l%60),d=`${c.toString().padStart(2,"0")}:${u.toString().padStart(2,"0")}`,[m,p="0"]=l.toString().split(".");return`00:${d},${+p*100}`};t.forEach((l,c)=>{i+=`${c+1}
${o(l.start)} --> ${o(l.end)}
${l.text}

`}),n(i,"srt");break}}}}}function rG({closeModal:t}){const{lyrics:e,setLyrics:n,setIsChanged:r}=Kt(),s=h.useRef(null),i=()=>{var c;const o=+(((c=s.current)==null?void 0:c.value)||"");if(!o)return;const l=+It()["edit_current-lyric-index"];if(!isNaN(l)){const u=[...e];if(o<0&&e[0].end+o<0)return;u.forEach((d,m)=>{m>=l&&(u[m].start=+(u[m].start+o).toFixed(1),u[m].end=+(u[m].end+o).toFixed(1))}),n(u),r(!0),t()}};return h.useEffect(()=>{var o;(o=s.current)==null||o.focus()},[]),a.jsxs(_e,{children:[a.jsx(Be,{title:"Sync lyric",closeModal:t}),a.jsx(_n,{step:.2,ref:s,type:"number"}),a.jsx("p",{className:"mt-5 text-right",children:a.jsx(q,{onClick:i,children:"Save"})})]})}function sG({pause:t}){const{song:e,lyrics:n}=Kt(),[r,s]=h.useState(""),i=h.useRef(null),{handleInputChange:o}=tG(),{exportLyric:l}=nG(),c=m=>{var p;t(),s(m),(p=i.current)==null||p.open()},u=()=>{var m;return(m=i.current)==null?void 0:m.close()},d=()=>{if(r)switch(r){case"lyric":return a.jsx(ZH,{closeModal:u});case"song-beat":return e&&a.jsx(YH,{closeModal:u});case"export":return a.jsxs(_e,{children:[a.jsx(Be,{title:"Export",closeModal:u}),a.jsxs("div",{className:"flex ",children:[a.jsx(se,{color:"primary",onClick:()=>l({type:"json"}),children:"JSON"}),a.jsx(se,{color:"primary",onClick:()=>l({type:"srt"}),className:"ml-2",children:"SRT"})]})]});case"sync":return a.jsx(rG,{closeModal:u})}};return a.jsxs(a.Fragment,{children:[a.jsx("input",{id:"import_lyric",onChange:o,type:"file",className:"hidden"}),a.jsxs(Fn,{appendOnPortal:!0,children:[a.jsx(Mn,{children:a.jsx(se,{size:"clear",color:"primary",className:"h-[36px] w-[36px] justify-center rounded-full mt-2",children:a.jsx(ao,{className:"w-6"})})}),a.jsx(Dn,{origin:"top right",children:a.jsx(er,{className:"w-[220px]",children:a.jsxs(Or,{children:[a.jsxs("button",{disabled:!n.length,onClick:()=>c("sync"),children:[a.jsx(Ae,{}),a.jsx("span",{children:"Sync lyric"})]}),a.jsxs("button",{onClick:()=>c("lyric"),children:[a.jsx(Dr,{}),a.jsx("span",{children:"Edit lyric"})]}),!(e!=null&&e.is_official)&&a.jsxs("button",{onClick:()=>c("search"),children:[a.jsx(Fu,{}),a.jsx("span",{children:"Search lyric"})]}),a.jsxs("button",{onClick:()=>c("song-beat"),children:[a.jsx(oa,{}),a.jsx("span",{children:"Song beat"})]}),a.jsx("button",{className:"!p-0",children:a.jsxs("label",{className:"flex w-full px-3 py-2 cursor-pointer items-center space-x-2",htmlFor:"import_lyric",children:[a.jsx(Nu,{}),a.jsx("span",{children:"Import (JSON or SRT)"})]})}),a.jsxs("button",{disabled:!n.length,onClick:()=>c("export"),children:[a.jsx(Q4,{}),a.jsx("span",{children:"Export"})]})]})})})]}),a.jsx(ce,{variant:"animation",ref:i,children:d()})]})}function iG({audioEle:t},e){const{lyrics:n,isPreview:r,setIsPreview:s}=Kt(),{backward:i,forward:o,handlePlayPause:l,currentTimeRef:c,durationRef:u,progressLineRef:d,pause:m,seek:p,status:g,isClickPlay:x}=rp({audioEle:t}),{addLyric:w,removeLyric:v,isEnableAddBtn:S,submit:_}=QH({audioEle:t,isClickPlay:x});h.useImperativeHandle(e,()=>({seek:p,pause:m,submit:_}));const E=()=>{if(!x&&n.length){const F=n[n.length-1].end;t.currentTime=F}l()},I={button:"mt-2 ml-2 space-x-1 rounded-full",icon:"w-6",arrow:"before:content-[''] before:absolute before:-translate-x-1/2 before:left-[27px]  before:bottom-[calc(100%-1px)] before:z-[-1] before:border-8 before:border-transparent before:border-b-amber-800"},P=()=>{switch(g){case"error":return a.jsx(gm,{className:"w-6"});case"playing":return a.jsx(fv,{className:"w-6"});case"paused":return a.jsx(cf,{className:"w-6"});case"waiting":return a.jsx(Ae,{className:"w-6 animate-spin"})}};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-start flex-wrap -mt-2 -ml-2 [&_button]:outline-none",children:[a.jsx(wR,{className:"mt-2 ml-2",audioEle:t,postLocalStorageKey:"edit_lyric"}),a.jsx(se,{className:I.button,color:"primary",onClick:E,children:P()}),a.jsxs(se,{disabled:!S||r,onClick:w,className:I.button,color:"primary",children:[a.jsx(zt,{className:"w-6"}),a.jsx("span",{children:"Add"})]}),a.jsxs(se,{disabled:!n.length||r,onClick:v,className:I.button,color:"primary",children:[a.jsx(hv,{className:"w-6"}),a.jsx("span",{children:"Remove"})]}),a.jsxs(se,{onClick:()=>i(2),className:I.button,color:"primary",children:[a.jsx(Bj,{className:"w-6"}),a.jsx("span",{children:"2s"})]}),a.jsxs(se,{onClick:()=>o(2),className:I.button,color:"primary",children:[a.jsx("span",{children:"2s"}),a.jsx(Gj,{className:"w-6"})]}),a.jsxs(se,{disabled:!n.length,onClick:()=>{s(!r),m()},className:I.button,color:"primary",children:[a.jsx(LF,{className:"w-6"}),a.jsx("span",{children:r?"Edit":"Preview"})]}),a.jsx("div",{className:"ml-auto",children:a.jsx(sG,{pause:m})})]}),a.jsxs("div",{className:"flex items-center mt-3",children:[a.jsx("div",{className:"text-sm w-[50px]",ref:c,children:"00:00"}),a.jsx("div",{ref:d,style:{backgroundColor:"var(--a-5-cl)"},className:"h-1 rounded-full w-full progress-line"}),a.jsx("div",{className:"text-sm w-[50px] text-right",ref:u,children:"00:00"})]})]})}const aG=h.forwardRef(iG);function oG({lyric:t,openModal:e,seek:n,isLast:r,status:s,isPreview:i},o){const l=()=>{switch(s){case"active":return"text-[--primary-cl] dark:text-[#ffed00] active-lyric";default:return""}};return a.jsx(a.Fragment,{children:a.jsxs("div",{className:"pt-[10px] last:mb-[30vh]",children:[a.jsx("button",{className:"hover:underline mb-[3px] text-gray-500",onClick:()=>n(t.start),children:ea(+t.start)}),a.jsxs("p",{ref:o,className:`font-[700] select-none relative ${Qs(!i,"pr-6")} ${l()}`,children:[t.text,!i&&a.jsx("button",{onClick:e,className:" absolute mt-1 ml-1",children:a.jsx(dz,{className:"w-5"})})]}),r&&t.end!==t.start&&a.jsx("button",{className:"hover:underline pt-[10px]",onClick:()=>n(t.end),children:ea(+t.end)})]})})}const lG=h.forwardRef(oG);function cG({text:t,className:e="",status:n,activeColor:r},s){const i=()=>{switch(n){case"coming":return"opacity-[.4]";case"active":return`${r||"text-[#ffed00]"} active-lyric`;case"done":return"opacity-[.4]"}};return a.jsx("p",{ref:s,className:`${e} transition-transform duration-[.3s] origin-left select-none font-[700] ${i()}`,children:t})}const fN=h.forwardRef(cG),Xd=.3;function mN({audioEle:t,lyrics:e,isActive:n}){const[r,s]=h.useState(0),i=h.useRef("instant"),o=h.useRef(0),l=h.useRef([]),c=h.useRef(0),u=()=>{if(l.current[0]===null)return;const m=t.currentTime>o.current?"forward":"backward";o.current=t.currentTime;let p=c.current;switch(m){case"forward":for(;e[p+1]&&e[p+1].start-Xd<o.current+Xd;)p+=1;break;case"backward":for(;e[p-1]&&e[p-1].end-Xd>o.current+Xd;)p-=1;break}p!==c.current&&(Math.abs(p-c.current)>5&&(i.current="instant"),c.current=p,s(p),l.current[p]&&lC(l.current[p],i.current),i.current==="instant"&&(i.current="smooth"))},d=()=>{s(0),c.current=0,o.current=0};return h.useEffect(()=>(n&&u(),()=>{n||d()}),[n]),h.useEffect(()=>{if(!(!n||!e.length))return t.addEventListener("timeupdate",u),()=>{t.removeEventListener("timeupdate",u)}},[e,n]),h.useEffect(()=>()=>{d()},[e]),{currentIndex:r,lyricRefs:l}}function uG(){const{lyrics:t,isPreview:e}=Kt(),n=h.useRef(null),r=h.useRef("instant");return h.useEffect(()=>{!n.current||e||(lC(n.current,r.current),r.current="instant",r.current==="instant"&&(r.current="smooth"))},[t.length,e]),h.useEffect(()=>()=>{r.current="instant"},[e]),{activeLyricRef:n}}function dG({controlRef:t,audioEle:e,openEditModal:n}){const{baseLyricArr:r,lyrics:s,setSelectLyricIndex:i,song:o,isPreview:l}=Kt(),{activeLyricRef:c}=uG(),{currentIndex:u,lyricRefs:d}=mN({audioEle:e,isActive:l,lyrics:s}),m=g=>{var x;(x=t.current)==null||x.seek(g)},p=g=>{var x;typeof g=="number"&&((x=t.current)==null||x.pause(),i(g),n())};return h.useEffect(()=>{rt("edit_current-lyric-index",u)},[u]),a.jsx(a.Fragment,{children:a.jsxs("div",{className:`flex-grow overflow-auto flex font-[Inter,system-ui] no-scrollbar md:text-lg rounded-xl px-2 pt-3 mt-3 bg-[--popup-cl] shadow-[0_0_6px_0_rgba(0,0,0,0.15)] ${Qs(l,"justify-center")}`,children:[a.jsx("div",{className:`w-1/2 ${Qs(l,"hidden")}`,children:r.length?a.jsx(a.Fragment,{children:r.map((g,x)=>{let w=x===s.length?"active":x<s.length?"done":"coming";return w==="done"&&x===r.length-1&&(w="active"),a.jsx(fN,{ref:w==="active"?c:null,className:"pt-[38px] mr-[24px]",status:w,text:g},x)})}):a.jsx("p",{children:"..."})}),a.jsx("div",{className:`w-1/2 ${Qs(l,"text-center")}`,children:!!(s!=null&&s.length)&&o&&s.map((g,x)=>{let w="coming";return l&&(u===x?w="active":x<u&&(w="done")),a.jsx(lG,{ref:v=>d.current[x]=v,openModal:()=>p(x),seek:m,isPreview:l,lyric:g,status:w,activeColor:"text-[#ffed00]",isLast:x===s.length-1&&x!==r.length-1},x)})})]})})}function hG({audioRef:t}){const{baseLyric:e,setSong:n,song:r,setBaseLyricArr:s,setBaseLyric:i,setLyrics:o,isChanged:l,isFetching:c,start:u}=Kt(),[d,m]=h.useState(!0),p=h.useRef(!1),g=ci(),x=v=>{if(!v.length)return;const S=v.length-1;if(t.current){const _=v[S].end;u.current=_}},w=async()=>{try{if(!g.id)throw new Error("");const v=await Wt({collectionName:"Songs",id:g.id});if(!v.exists())throw new Error("");const S={...v.data(),id:v.id,queue_id:""};if(S.lyric_id){const _=await Wt({collectionName:"Lyrics",id:S.lyric_id});if(_.exists()){const{base:E,lyrics:I}=_.data(),P=JSON.parse(I);i(E),o(P),x(P)}}n(S)}catch(v){console.log({message:v})}finally{m(!1)}};return h.useEffect(()=>{p.current||(p.current=!0,r?m(!1):w())},[]),h.useEffect(()=>{if(!e)return;const v=e.split(/\r?\n/);s(v)},[e]),h.useEffect(()=>{if(!l)return;const v=S=>{S.preventDefault()};return window.addEventListener("beforeunload",v),()=>{window.removeEventListener("beforeunload",v)}},[l]),{isFetching:d,song:r,isChanged:l,isSubmitting:c}}function pN(t,e){if(e.length===1&&e[0]===0)return[t];const n=[];let r=0;e.sort((s,i)=>s-i);for(const s of e)s>t.length||s<0||(n.push(t.substring(r,s)),r=s);return n.push(t.substring(r)),n}const fG=["Edit","Record"];function mG(){const[t,e]=h.useState(0),[n,r]=h.useState(),[s,i]=h.useState(""),[o,l]=h.useState([[]]),[c,u]=h.useState([]),[d,m]=h.useState(!1),[p,g]=h.useState("Edit"),[x,w]=h.useState("paused"),v=h.useRef(null),S=h.useRef(null),_=h.useRef(null),E=h.useRef(null),I=h.useRef(null),P=h.useRef(null),F=h.useRef(null),j=h.useRef(null),k=h.useRef(),C=h.useRef(!1),R=h.useRef(0),N=h.useRef(0),M=h.useRef(0),A=h.useRef([]),fe=h.useRef([]),Le=h.useRef(!0),de=h.useRef(!1),he=h.useMemo(()=>s.split(" ").filter(Z=>Z.trim()),[s]),V=h.useMemo(()=>he.map((Z,je)=>({text:Z,positions:o[je]})),[s,o]),J=h.useMemo(()=>{const Z=[];return V.forEach(je=>{const Te=pN(je.text,je.positions);Z.push(...Te)}),Z.filter(je=>je)},[s,o]);return{eleRefs:{endTimeRangeRef:S,overlayRef:v,startTimeRangeRef:_,startRefText:E,endRefText:I,currentWordRef:P,growInputRef:F,tempWordRef:j},tabProps:{tab:p,setTab:g,tabs:fG},eventRefs:{playWhenSpaceRef:Le,moveArrowToGrowRef:de},currentWords:he,currentWordsData:V,currentSplitWords:J,actuallyEndRef:R,playerRef:k,actuallyStartRef:N,tempActuallyStartRef:M,wordsRatioRef:A,mergedGrowListRef:fe,isChangedRef:C,wordIndex:t,setWordIndex:e,growList:c,setGrowList:u,isOpenEditLyricModal:d,SetIsOpenEditLyricModal:m,setStatus:w,status:x,text:s,setText:i,cut:o,setCut:l,localLyricIndex:n,setLoacalLyricIndex:r}}const gN=h.createContext(null);function pG({children:t}){return a.jsx(gN.Provider,{value:mG(),children:t})}const Qt=()=>{const t=h.useContext(gN);if(!t)throw new Error("LyricEditorProvider not found");return t};function xN(t,e){const n=`lyric_${po(4)}`,r=document.querySelector("style.keyframe");if(!r)return n;let s=`@keyframes ${n}{0%{width:0%}`;if(!t.length)return s+="100%{width:100%}}",r.innerText=s,n;let i=t.reduce((u,d)=>u+d,0);const o=[];let l=0,c=0;for(let u=0;u<e.length-1;u++){const d=e[u],m=t[u];c+=d,l+=m,o.push({progress:Math.round(l/i*100),width:c})}for(const u of o)s+=`${u.progress}%{width:${u.width}%}`;return s+="100%{width:100%}}",r.innerText=s,n}function gG({audioEle:t}){const{eleRefs:e,actuallyEndRef:n,actuallyStartRef:r,tempActuallyStartRef:s,wordsRatioRef:i,mergedGrowListRef:o,status:l,setStatus:c}=Qt(),{play:u,pause:d,statusRef:m}=rp({audioEle:t,statusFromParent:l,setStatusFromParent:c}),{overlayRef:p}=e,g=()=>{d(),p.current&&(p.current.style.animation="none")},x=()=>{if(t.currentTime=r.current,!s.current&&p.current){const S=xN(o.current,i.current);p.current.style.animation=`${S} ${((n.current-r.current)/t.playbackRate).toFixed(2)}s linear`}u()},w=()=>{m.current==="paused"?x():g()},v=()=>{if(+t.currentTime.toFixed(1)>=n.current)return g()};return h.useEffect(()=>{if(t)return t.addEventListener("timeupdate",v),()=>{t.removeEventListener("timeupdate",v)}},[]),{handlePlayPause:w,_pause:g,_play:x,status:l}}function xG({audioEle:t}){const{playerRef:e}=Qt(),{_play:n,_pause:r,handlePlayPause:s}=gG({audioEle:t});return h.useEffect(()=>{e.current={handlePlayPause:s,pause:r,play:n}},[]),a.jsx(a.Fragment,{})}function yG(){const{status:t,playerRef:e}=Qt();return a.jsx(se,{size:"clear",className:"p-1.5",onClick:()=>{var n;return(n=e.current)==null?void 0:n.handlePlayPause()},color:"primary",children:t==="playing"?a.jsx(Qu,{className:"w-6"}):a.jsx(qa,{className:"w-6"})})}function vG({audioEle:t}){const{tabProps:e}=Qt();return a.jsxs(a.Fragment,{children:[a.jsx(xG,{audioEle:t}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(tr,{...e,render:n=>n}),a.jsxs("div",{className:"flex space-x-2",children:[a.jsx(yG,{}),a.jsx(wR,{positions:"left",audioEle:t,postLocalStorageKey:"edit_lyric_tune"})]})]})]})}function wG(){const{updateLyric:t,setIsChanged:e,selectLyricIndex:n}=Kt(),{actuallyEndRef:r,actuallyStartRef:s,growList:i,text:o,cut:l}=Qt();return{updateLyricTune:async()=>{if(typeof n!="number")throw new Error("selectLyricIndex is undefine");const u={tune:{start:s.current,end:r.current,grow:i},cut:l,text:o};t(n,u),e(!0)}}}function _G({closeModal:t}){const{setSelectLyricIndex:e,selectLyricIndex:n,lyrics:r}=Kt(),{isChangedRef:s,playerRef:i}=Qt(),{updateLyricTune:o}=wG(),l=()=>{o(),t()},c=u=>{var d;if(typeof n=="number")switch(s.current&&(s.current=!1,o()),(d=i.current)==null||d.pause(),u){case"next":if(n===r.length-1)return;e(m=>m+1);break;case"prev":if(n===0)return;e(m=>m-1);break}};return a.jsxs("div",{className:"flex justify-end space-x-2 mt-5 ",children:[a.jsxs(se,{color:"primary",disabled:n===0,onClick:()=>c("prev"),children:[a.jsx(av,{className:"w-6"}),a.jsx("span",{className:"hidden md:block",children:"Previous"})]}),a.jsxs(se,{color:"primary",disabled:n===r.length-1,onClick:()=>c("next"),children:[a.jsx("span",{className:"hidden md:block",children:"Next"}),a.jsx($j,{className:"w-6"})]}),a.jsxs(se,{disabled:!s.current,color:"primary",onClick:l,children:[a.jsx(aa,{className:"w-6"}),a.jsx("span",{children:"Ok"})]})]})}function SG(){const{isOpenEditLyricModal:t,playerRef:e,eleRefs:{currentWordRef:n},eventRefs:r}=Qt(),s=o=>{var l;if(o.key===" "){if(!r.playWhenSpaceRef.current)return;o.preventDefault(),console.log("handle play pause"),(l=e.current)==null||l.handlePlayPause()}if(o.key==="ArrowRight"||o.key==="ArrowLeft"){if(!r.moveArrowToGrowRef.current)return;const c=n.current;if(!c)return;switch(o.key){case"ArrowRight":o.preventDefault(),c!=null&&c.nextSibling&&(c==null?void 0:c.nextSibling).click();break;case"ArrowLeft":o.preventDefault(),c!=null&&c.previousSibling&&(c==null?void 0:c.previousSibling).click();break}}},i=o=>{if(!r.moveArrowToGrowRef.current)return;const l=o.target,c=document.querySelectorAll(".word-item");let u=!1;c.forEach(d=>d.contains(l)?u=!0:{}),!u&&(r.moveArrowToGrowRef.current=!1)};h.useEffect(()=>(window.addEventListener("mousedown",i),window.addEventListener("keydown",s),()=>{window.removeEventListener("mousedown",i),window.removeEventListener("keydown",s)}),[t])}const yN=t=>{const e=t.clientWidth,n=[];return t.childNodes.forEach(r=>{n.push(Math.round(r.offsetWidth/e*100))}),n};function Bw(t,e,n){const r=[];if(!n.length)return[];let s=0;return t.forEach((i,o)=>{const l=e[o].length;if(l===0)r.push(n[s]),s++;else if(l>0){const u=n.slice(s,s+l+1).reduce((d,m)=>(s++,+(d+m).toFixed(1)),0);r.push(u)}}),r}function bG(){const{selectLyricIndex:t,currentLyric:e}=Kt(),{eleRefs:n,actuallyEndRef:r,mergedGrowListRef:s,actuallyStartRef:i,wordsRatioRef:o,setGrowList:l,setCut:c,setText:u,currentWords:d}=Qt(),{tempWordRef:m,endTimeRangeRef:p,startTimeRangeRef:g,startRefText:x,endRefText:w}=n;h.useEffect(()=>{if(!m.current)return;const v=yN(m.current);o.current=v},[d]),h.useEffect(()=>{if(!e)return;const v=e.tune.grow,S=e.text.split(" ").filter(E=>E.trim());u(e.text),c(e.cut);const _=Bw(S,e.cut,v);l(v),s.current=_,w.current&&x.current&&g.current&&p.current&&(i.current=e!=null&&e.tune?e.tune.start:e.start,x.current.innerText=`${e.start} / ${i.current}`,g.current.max=e.end+"",g.current.value=i.current+"",r.current=e!=null&&e.tune?e.tune.end:e.end,w.current.innerText=`${r.current} / ${e.end}`,p.current.max=e.end+"",p.current.value=r.current+"")},[t])}function EG({audioEle:t}){const{playerRef:e,isChangedRef:n,tabProps:{tab:r,setTab:s},setGrowList:i,cut:o,actuallyStartRef:l,mergedGrowListRef:c,currentSplitWords:u,currentWords:d}=Qt(),[m,p]=h.useState(!1),[g,x]=h.useState([]),w=h.useRef(Date.now()),v=h.useRef(!1),S=h.useRef(!1),_=()=>{const M=+(t.currentTime-w.current).toFixed(2);x(A=>[...A,M])},E=()=>{var M;w.current=t.currentTime,v.current||(v.current=!0,(M=e.current)==null||M.play(),p(!0))},I=()=>{v.current&&_()},P=M=>{M.key===" "&&(S.current||(M.preventDefault(),S.current=!0,E()))},F=M=>{M.key===" "&&(M.preventDefault(),I(),S.current=!1)},C={onPointerDown:()=>{E()},onPointerUp:()=>{I()}},R=()=>{var M;(M=e.current)==null||M.pause(),v.current=!1,x([]),p(!1)},N=()=>{n.current=!0,i(g);const M=Bw(d,o,g);c.current=M,s("Edit"),R()};return h.useEffect(()=>{g.length===u.length&&N()},[g]),h.useEffect(()=>{var M;if(r==="Record")return(M=e.current)==null||M.pause(),window.addEventListener("keydown",P),window.addEventListener("keyup",F),t.currentTime=l.current,()=>{var A;(A=e.current)==null||A.pause(),window.removeEventListener("keydown",P),window.removeEventListener("keyup",F)}},[r]),{localGrowList:g,buttonProps:C,clear:R,isRecording:m}}function kG({audioEle:t}){const{currentSplitWords:e}=Qt(),{buttonProps:n,localGrowList:r,isRecording:s,clear:i}=EG({audioEle:t});return a.jsxs(a.Fragment,{children:[a.jsx(se,{disabled:!s,size:"clear",className:"p-1.5",onClick:i,color:"primary",children:a.jsx(oo,{className:"w-6"})}),a.jsxs("div",{className:"flex-grow flex flex-col justify-center",children:[a.jsx("div",{className:"md:text-xl font-[700] text-center",children:e.map((o,l)=>a.jsxs("span",{className:`${l<r.length?"text-[--primary-cl]":""} leading-[1]`,children:[o," "]},l))}),a.jsx("p",{className:"mt-5 text-center md:hidden",children:a.jsx(se,{...n,color:"primary",children:"Record"})})]})]})}function jG(){const{currentLyric:t}=Kt(),{eleRefs:e,isChangedRef:n,actuallyEndRef:r,actuallyStartRef:s,tempActuallyStartRef:i,setGrowList:o}=Qt(),{startRefText:l,endRefText:c}=e;return{setEndPoint:g=>{if(!t)return;const x=+g.toFixed(1);n.current=!0,r.current=x,c.current&&(c.current.textContent=`${x} / ${t.end}`),i.current&&(r.current=x,s.current=x-1)},setStartPoint:g=>{if(!t)return;const x=+g.toFixed(1);n.current=!0,s.current=x,l.current&&(l.current.textContent=`${t.start} / ${x}`)},endTimeRangeProps:{onFocus:()=>{i.current=s.current,s.current=r.current-1},onBlur:()=>{s.current=i.current,i.current=0}},handleGrowWord:g=>{n.current=!0,o(x=>{const w=[...x];let v=w[g.index];switch(g.variant){case"range":v=g.value;break;case"button":v=+(g.action==="minus"?v-.1:v+.1).toFixed(1)}return v<0&&(v=0),w[g.index]=v,w})}}}function TG(){const{setStartPoint:t,setEndPoint:e,endTimeRangeProps:n,handleGrowWord:r}=jG(),{currentLyric:s}=Kt(),{wordIndex:i,growList:o,eleRefs:l}=Qt();return s?a.jsxs("div",{className:"[&>div]:flex [&>div]:space-x-2 space-y-3 [&_label]:w-[150px] [&_label]:flex-shrink-0",children:[a.jsxs("div",{children:[a.jsxs(Dt,{htmlFor:"start",children:["Start: ",a.jsx("span",{ref:l.startRefText})]}),a.jsx("input",{ref:l.startTimeRangeRef,type:"range",id:"start",min:s.start,max:s.end,step:.2,className:"w-full",onChange:c=>t(+c.target.value)})]}),a.jsxs("div",{children:[a.jsxs(Dt,{htmlFor:"end",children:["End: ",a.jsx("span",{ref:l.endRefText})]}),a.jsx("input",{id:"end",ref:l.endTimeRangeRef,type:"range",min:s.start,step:.2,className:"w-full",onChange:c=>e(+c.target.value),...n})]}),a.jsxs("div",{children:[a.jsxs(Dt,{htmlFor:"grow",children:["Grow: ",o[i]]}),a.jsx("input",{ref:l.growInputRef,type:"range",id:"grow",min:0,max:10,step:.1,className:"w-full",value:o[i]+"",onChange:c=>r({variant:"range",value:+c.target.value,index:i})})]})]}):a.jsx(a.Fragment,{})}function IG(){const{eleRefs:t,eventRefs:e,setText:n,mergedGrowListRef:r,setCut:s,setGrowList:i,text:o}=Qt(),[l,c]=h.useState(!1),u=h.useRef(null),d=()=>{if(!u.current)return;const m=u.current.value.split(/\r?\n/).filter(x=>x).map(x=>x.trim()).join(" ").split(" ").filter(x=>x).join(" ");n(m);const p=m.split(" ").map(()=>0),g=m.split(" ").map(()=>[]);s(g),i(p),r.current=p,c(!1)};return h.useEffect(()=>{l?(e.playWhenSpaceRef.current=!1,e.moveArrowToGrowRef.current=!1,u.current&&(u.current.value=o)):(e.playWhenSpaceRef.current=!0,e.moveArrowToGrowRef.current=!0)},[l]),a.jsxs("div",{className:"mt-3 relative pt-5 font-[Inter,system-ui]",children:[a.jsx("div",{className:"absolute top-0 right-0 flex justify-end w space-x-2 hover:[&>button]:bg-black/10 [&>button]:rounded-full [&>button]:p-1",children:l?a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>c(!1),children:a.jsx(oo,{className:"w-5"})}),a.jsx("button",{onClick:d,children:a.jsx(aa,{className:"w-5"})})]}):a.jsx("button",{onClick:()=>c(!0),children:a.jsx(Dr,{className:"w-5"})})}),a.jsx("div",{className:"flex justify-center",children:l?a.jsx("textarea",{ref:u,rows:1,className:`${dl} w-full mt-3 bg-[--a-5-cl]`}):a.jsx(a.Fragment,{children:a.jsxs("div",{className:"relative whitespace-nowrap  sm:text-2xl font-[700]",children:[o,a.jsx("div",{ref:t.overlayRef,className:"absolute  top-0 left-0 overflow-hidden text-[--primary-cl] whitespace-nowrap w-0",children:o})]})})})]})}function CG({text:t,openModal:e,isShowScissor:n,index:r}){const{growList:s,setWordIndex:i,wordIndex:o,eventRefs:l,eleRefs:c}=Qt(),u=o===r,d=()=>{var m;r!==-1&&(i(r),l.moveArrowToGrowRef.current=!0,(m=c.growInputRef.current)==null||m.focus())};return a.jsxs("div",{ref:m=>u?c.currentWordRef.current=m:{},style:{flexGrow:s[r]!==0?s[r]:.05},onClick:d,className:`word-item cursor-pointer relative rounded-full flex items-center justify-center 
      ${u?"bg-[--primary-cl] text-white":"bg-[--a-5-cl]"}`,children:[a.jsx("span",{children:t}),n&&u&&a.jsx(se,{onClick:e,size:"clear",className:"!absolute bottom-0 translate-y-[16px] bg-[--popup-cl] text-[--text-cl] shadow-[0_0_6px__rgba(0,0,0,0.3)] p-1.5",children:a.jsx(Xj,{className:"w-5"})})]})}function RG({wordData:t,wordIndex:e,closeModal:n}){const{currentLyric:r,selectLyricIndex:s}=Kt(),{setCut:i,cut:o}=Qt(),[l,c]=h.useState(t.positions),u=h.useMemo(()=>pN(t.text,l).filter(g=>g),[l]),d=h.useMemo(()=>t.text.split(""),[]),m=g=>{const x=[...l],w=l.findIndex(v=>v===g);w===-1?x.push(g):x.splice(w,1),c(x)},p=()=>{if(!r||s===void 0)return;const g=l.sort((w,v)=>w-v),x=[...o];x[e]=g,i(x),n()};return a.jsxs(_e,{className:"w-[500px]",children:[a.jsx(ee,{title:"Split word "}),a.jsx("div",{className:"flex justify-center space-x-5",children:u.map((g,x)=>a.jsx("span",{className:"text-xl md:text-2xl font-[700]",children:g},x))}),a.jsx("div",{className:"mt-3 flex justify-center",children:d.map((g,x)=>{const w=l.includes(x);return a.jsxs("div",{children:[d.length>1&&x?a.jsx("button",{onClick:()=>m(x),className:` p-1 rounded-full ${w?"bg-[--primary-cl] text-white":"hover:bg-black/10"}`,children:a.jsx(Xj,{className:"w-5"})}):"",a.jsx("span",{className:"text-[50px] font-[500]",children:g})]},x)})}),a.jsx("p",{className:"mt-5 text-right",children:a.jsx(se,{onClick:p,color:"primary",className:"font-playwireCU",children:"OK"})})]})}function NG(){const{currentSplitWords:t,currentWordsData:e,currentWords:n}=Qt(),[r,s]=h.useState(),i=h.useRef(null),o=h.useMemo(()=>{const u={},d=e.map(p=>p.positions.length);let m=0;return d.forEach((p,g)=>{p===0?(u[m]=g,m++):p>0&&[...Array(p+1).keys()].forEach(()=>{u[m]=g,m++})}),u},[e]),l=h.useMemo(()=>r!==void 0?e[r]:void 0,[r,e]),c=u=>{var d;s(u),(d=i.current)==null||d.open()};return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"flex justify-center h-[36px] mt-5",children:t.map((u,d)=>{const m=o[d],p=n[m];return a.jsx(CG,{isShowScissor:p?p.length>1:!1,index:d,openModal:()=>c(m),text:u},d)})}),a.jsx(ce,{variant:"animation",ref:i,children:l&&r!==void 0&&a.jsx(RG,{wordIndex:r,closeModal:()=>{var u;return(u=i.current)==null?void 0:u.close()},wordData:l})})]})}function AG(){const{eventRefs:t,tabProps:{tab:e}}=Qt();h.useEffect(()=>{switch(e){case"Edit":t.playWhenSpaceRef.current=!0,t.moveArrowToGrowRef.current=!0;break;case"Record":t.playWhenSpaceRef.current=!1,t.moveArrowToGrowRef.current=!1;break}},[e])}function PG({closeModal:t}){const{song:e}=Kt(),{eleRefs:n,currentWords:r,tabProps:s}=Qt();SG(),bG(),AG();const i=h.useRef(null);return a.jsx(a.Fragment,{children:a.jsxs(_e,{className:"w-[800px] overflow-auto",children:[a.jsx(Be,{title:"Edit lyric",closeModal:t}),a.jsx("audio",{src:e==null?void 0:e.song_url,ref:i}),a.jsx("div",{ref:n.tempWordRef,className:"absolute inline-block opacity-0",children:r.map((o,l)=>a.jsx("span",{children:o},l))}),i.current&&a.jsx(vG,{audioEle:i.current}),a.jsxs("div",{className:"mt-5",children:[i.current&&a.jsx("div",{className:`${s.tab==="Record"?"block":"hidden"}`,children:a.jsx(kG,{audioEle:i.current})}),a.jsxs("div",{className:`${s.tab==="Edit"?"block":"hidden"}`,children:[a.jsx(TG,{}),a.jsx(IG,{}),a.jsx(NG,{})]})]}),a.jsx(_G,{closeModal:t})]})})}function FG(t){return a.jsx(pG,{children:a.jsx(PG,{...t})})}function MG({children:t}){const[e,n]=h.useState(""),r=h.useRef(null),s=h.useRef(null),i=h.useRef(null),{isFetching:o,isChanged:l,song:c,isSubmitting:u}=hG({audioRef:s}),d=()=>{var g,x;(g=r.current)==null||g.pause(),(x=r.current)==null||x.submit()},m=g=>{var x;n(g),(x=i.current)==null||x.open()},p=()=>{var g;return(g=i.current)==null?void 0:g.close()};return a.jsxs(a.Fragment,{children:[a.jsx("audio",{className:"hidden",ref:s,src:c==null?void 0:c.song_url}),o?a.jsx(ze,{children:a.jsx(Ae,{className:"w-6 animate-spin"})}):c&&a.jsxs(a.Fragment,{children:[t,a.jsx(ee,{className:"line-clamp-1",title:`Edit lyric - ${c.name}`}),a.jsx("div",{className:"mt-3",children:s.current&&a.jsxs(a.Fragment,{children:[a.jsx(aG,{audioEle:s.current,ref:r}),a.jsx(ce,{persisted:!0,variant:"animation",ref:i,children:e==="edit-lyric"&&a.jsx(FG,{closeModal:p})})]})}),s.current&&a.jsx(dG,{controlRef:r,audioEle:s.current,openEditModal:()=>{m("edit-lyric")}}),a.jsx("p",{className:"mt-5 text-right",children:a.jsx(se,{className:"rounded-full ",color:"primary",disabled:!l,isLoading:u,onClick:d,children:"Save"})})]})]})}function vN(t){return a.jsx(KH,{children:a.jsx(MG,{...t})})}function DG(){return a.jsxs("div",{className:"fixed left-[10px] top-[10px] bottom-[10px] right-[10px] flex flex-col md:right-0 md:top-0 md:left-[unset] md:right-[unset] md:relative md:h-full md:pb-4",children:[a.jsx(dN,{className:"mb-1 self-start"}),a.jsx(vN,{})]})}const LG=["All","Song","Playlist","Singer"],OG={songs:[],playlists:[],singers:[]};function $G(){const[t,e]=h.useState(!1),[n,r]=h.useState("Song"),s=Dj(),[i,o]=h.useState(OG),l=h.useRef(!0),c=h.useRef(!0),u=h.useRef(!0),d=h.useRef(!0),m=g=>{o(x=>({...x,...g}))},p=async()=>{try{const g=s[0].get("q");if(!g)return;switch(e(!0),await Jn(500),n){case"All":{if(!l.current)return;l.current=!1;const[x,w,v]=await Promise.all([$t(lr(_t,[Q("is_official","==",!0),Mt(6)],g)),Ln(lr(vn,[Mt(3)],g)),wu(lr(Qa,[Mt(3)],g))]);m({playlists:w,songs:x,singers:v});break}case"Song":{if(!c.current)return;c.current=!1;const x=lr(_t,[Q("is_official","==",!0)],g),w=await $t(x);m({songs:w});break}case"Playlist":{if(!u.current)return;u.current=!1;const x=lr(vn,[Q("is_public","==",!0)],g),w=await Ln(x);m({playlists:w});break}case"Singer":{if(!d.current)return;d.current=!1;const x=lr(Qa,[],g),w=await wu(x);m({singers:w});break}}}catch(g){console.log({message:g})}finally{e(!1)}};return h.useEffect(()=>{p()},[s[0].get("q"),n]),h.useEffect(()=>()=>{r("All"),l.current=!0,c.current=!0,u.current=!0,d.current=!0},[s[0].get("q")]),{isFetching:t,setIsFetching:e,tab:n,setTab:r,getResult:p,result:i,tabs:LG}}function zG(){const[t,e]=h.useState(""),[n,r]=h.useState(!1),[s,i]=h.useState(!1),[o,l]=h.useState([]),[c,u]=h.useState([]),d=h.useRef(null),m=h.useRef(null),p=h.useRef(null),g=h.useRef(!0),x=h.useRef(!0),w=Dj(),v=BR(t,700),S=new AbortController,_=I=>{const P=document.querySelector(".popup-content"),F=I.target,j=document.querySelectorAll(".modal-content");let k=!1;j.forEach(C=>C.contains(F)?k=!0:{}),!(d.current&&m.current&&(d.current.contains(F)||k||m.current.contains(F)||P!=null&&P.contains(F)))&&i(!1)},E=async()=>{try{const I=le(St(ie,"Trending_Keywords"),Lt("week_count","desc"),Mt(5)),P=await bt(I);if(P.empty)return;const F=P.docs.map(j=>j.id);u(F)}catch{console.log("error")}};return h.useEffect(()=>{console.log(x.current),x.current&&(x.current=!1,E())},[]),h.useEffect(()=>{if(!v.trim()){r(!1),l([]);return}const I=async()=>{try{r(!0);const P=lr(_t,[Q("is_official","==",!0)],t),F=await $t(P);l(F)}catch(P){console.log(P)}finally{r(!1)}};return g.current?I():g.current=!0,()=>{console.log("abort"),S.abort()}},[v]),h.useEffect(()=>(s&&document.addEventListener("click",_),()=>{document.removeEventListener("click",_)}),[s]),h.useEffect(()=>(e(w[0].get("q")||""),()=>{var I;g.current=!1,(I=p.current)==null||I.blur(),i(!1)}),[w[0].get("q")]),h.useEffect(()=>{w[0].get("q")!==t&&s&&(g.current=!0)},[t,s]),{isFetching:n,searchResult:o,value:t,setValue:e,isFocus:s,setIsFocus:i,formRef:d,searchResultRef:m,inputRef:p,trendingKeywords:c}}function BG({songs:t}){const{handleSetSong:e}=_r({variant:"search-bar"}),{getRelatigeSongs:n}=ad(),r=s=>{e(s.queue_id,[s]);const i=It()["recent-search"]||[];i.unshift({variant:"song",item:s}),rt("recent-search",i),n(s)};return a.jsx(En,{children:t.length?a.jsx(Sr,{songVariant:"recent-song",isHasCheckBox:!1,setSong:r,songs:t}):a.jsx(Re,{})})}const VG={itemContainer:"w-full sm:group/container flex flex-row rounded-md justify-between py-2 px-3 last:border-none hover:bg-white/10"};function UG({item:t}){return a.jsxs(X,{to:`/${t.variant}/${t.item.id}`,className:`${VG.itemContainer}`,children:[a.jsx("div",{className:"w-10 h-10",children:a.jsx(Ce,{src:t.item.image_url,blurHashEncode:t.item.blurhash_encode})}),a.jsxs("div",{className:"ml-10",children:[a.jsx("h5",{className:"line-clamp-1 font-medium overflow-hidden text-sm",children:t.item.name}),a.jsx("p",{className:"opacity-[.7] line-clamp-1 text-xs",children:t.variant})]})]})}function HG({item:t}){const{user:e}=xe(),{currentSongData:n}=oe(We),{handleSetSong:r}=_r({variant:"search-bar"}),{getRelatigeSongs:s}=ad(),i=l=>{r(l.queue_id,[l]),s(l)},o=()=>{switch(t.variant){case"song":return a.jsx(XR,{isHasCheckBox:!1,isLiked:(e==null?void 0:e.liked_song_ids.includes(t.item.id))||!1,variant:"recent-song",index:0,active:t.item.id===(n==null?void 0:n.song.id),onClick:()=>i(t.item),song:t.item});default:return a.jsx(UG,{item:t})}};return a.jsx(En,{children:o()})}function GG({words:t,recentSearchs:e}){const n={listWrapper:"[&>*]:px-3 *:text-sm [&>*]:py-2 [&>*]:flex [&>*]:items-center [&>*]:space-x-1 [&>*]:rounded-md "};return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"text-sm font-semibold mb-2",children:"Suggestion keyword"}),a.jsx("div",{className:`${n.listWrapper} hover:[&>*]:bg-[--a-5-cl]`,children:t.map((r,s)=>a.jsxs(X,{to:`/search?q=${r}`,children:[a.jsx(fm,{className:"w-5"}),a.jsx("span",{className:"text-sm",children:r})]},s))}),a.jsx("div",{className:"text-sm font-semibold my-2",children:"Recent search"}),a.jsx("div",{className:n.listWrapper,children:e.map((r,s)=>a.jsx(HG,{item:r},s))})]})}function wN(){const t=Nt(),{isFetching:e,inputRef:n,formRef:r,searchResultRef:s,value:i,searchResult:o,setIsFocus:l,isFocus:c,setValue:u,trendingKeywords:d}=zG(),m=h.useMemo(()=>It()["recent-search"]||[],[c]),p={container:"relative z-[9] h-[40px] flex px-3 w-full md:w-[300px] shadow-md",unFocusContainer:"bg-[--sidebar-cl] rounded-[20px]",focusedContainer:"bg-[--popup-cl] rounded-[20px_20px_0_0]",input:"bg-transparent outline-none placeholder:[#666] w-full",searchResultContainer:"overflow-auto bg-[--popup-cl] shadow-md  rounded-[0_0_20px_20px] p-3 position absolute top-full left-0 w-full max-h-[60vh] flex flex-col"},g=async x=>{x.preventDefault(),Ts({collectionName:"Search_Logs",data:{keyword:bn(i)},msg:"Add search log"}),t(`/search?q=${i}`),l(!1)};return a.jsx(a.Fragment,{children:a.jsxs("form",{ref:r,onSubmit:g,className:`${p.container} ${c?p.focusedContainer:p.unFocusContainer}`,children:[a.jsx("button",{className:"mr-2",children:a.jsx(Fu,{className:"w-6"})}),a.jsx("input",{ref:n,value:i,onFocus:()=>l(!0),onChange:x=>u(x.target.value),placeholder:"...",className:p.input,type:"text"}),a.jsx("button",{type:"button",onClick:()=>u(""),className:`${i?"opacity-100":"!opacity-0"} ${Ef(!i)}`,children:e?a.jsx(Ae,{className:"w-5 animate-spin"}):a.jsx(oo,{className:"w-5"})}),a.jsx("div",{ref:s,className:`${ta(!c)} ${p.searchResultContainer}`,children:o.length?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"text-sm font-semibold mb-2",children:"Suggestion results"}),a.jsx("div",{className:"overflow-auto no-scrollbar",children:a.jsx(BG,{songs:o})})]}):a.jsx(GG,{recentSearchs:m,words:d})})]})})}function WG(){const{isOnMobile:t}=ss(),{isFetching:e,setIsFetching:n,result:r,tab:s,setTab:i,tabs:o}=$G(),{handleSetSong:l}=_r({variant:"search-bar"}),{getRelatigeSongs:c}=ad(),u=p=>{l(p.queue_id,[p]),c(p)},d=p=>s==="All"||s===p?"":"hidden",m=p=>s!=="All"||s==="All"&&!p?"hidden":"mb-3";return a.jsxs(a.Fragment,{children:[a.jsxs(mo,{className:"space-y-8",children:[t&&a.jsx(wN,{}),a.jsxs("div",{className:"md:flex items-center",children:[a.jsx(ee,{title:"Result",className:"mt-1 md:mt-0"}),a.jsx(tr,{className:"w-fit [&_button]:text-sm mt-3 md:[&_button]:text-base md:mt-0 md:ml-4",tabs:o,render:p=>p,tab:s,setTab:p=>{i(p),n(!0)}})]}),a.jsx(En,{children:a.jsxs("div",{className:"space-y-5",children:[a.jsxs("div",{className:d("Song"),children:[a.jsx(ee,{variant:"h3",className:m(!!r.songs.length),title:"Songs"}),e&&Rs,!e&&a.jsx(a.Fragment,{children:r.songs.length?a.jsx(Sr,{setSong:u,songs:r.songs}):s==="Song"&&a.jsx(Re,{variant:"less",className:"mx-auto"})})]}),a.jsxs("div",{className:d("Playlist"),children:[a.jsx(ee,{variant:"h3",className:m(!!r.playlists.length),title:"Playlist"}),a.jsx(Hl,{whenEmpty:s!=="Playlist"?a.jsx(a.Fragment,{}):void 0,loading:e,playlists:r.playlists})]}),a.jsxs("div",{className:d("Singer"),children:[a.jsx(ee,{variant:"h3",className:m(!!r.singers.length),title:"Singers"}),a.jsx(Wx,{singers:r.singers,loading:e,skeNumber:2,whenEmpty:s==="All"?a.jsx(a.Fragment,{}):void 0})]})]})})]}),a.jsx(ui,{})]})}function qG(){return a.jsx(ze,{children:a.jsx(Re,{variant:"with-home-button"})})}function KG(){const t=Nt(),e=async()=>{await WC(ai),t("/login")};return a.jsxs("div",{className:"bg-[--layout-cl] text-[--text-cl] flex flex-col justify-center items-center min-h-screen",children:[a.jsx("h1",{className:"text-[30px] font-bold border p-[10px]",children:"Unauthorized"}),a.jsx(se,{onClick:e,variant:"primary",color:"primary",className:"font-bold text-[20px]  text-[#fff] rounded-full mt-[20px]",children:"Exit"})]})}function QG(){const[t]=bw(ai),{action:e}=id(),n=Nt(),r=async()=>{try{await e("login")}catch(s){console.log(s)}};return h.useEffect(()=>{if(t){n("/");return}},[]),a.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-[--layout-cl]",children:[a.jsx(se,{onClick:r,variant:"default",className:"bg-[--primary-cl] font-bold text-[#fff] text-[30px] rounded-full",children:"Login with google"})," "]})}function XG(){const[t,e]=h.useState(),[n,r]=h.useState(!0),[s,i]=h.useState([]),[o,l]=h.useState([]),[c,u]=h.useState([]);return{singer:t,setSinger:e,isFetching:n,setIsFetching:r,songs:s,setSongs:i,playlists:o,albums:c,setAlbums:u,setPlaylists:l}}const _N=h.createContext(null);function YG({children:t}){return a.jsx(_N.Provider,{value:XG(),children:t})}function xi(){const t=h.useContext(_N);if(!t)throw new Error("SingerProvider not provided");return t}let JG="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",ZG=(t=21)=>{let e="",n=t|0;for(;n--;)e+=JG[Math.random()*64|0];return e};function eW(){const{setIsFetching:t,setSinger:e,setAlbums:n,isFetching:r,setSongs:s,singer:i,setPlaylists:o}=xi(),{setErrorToast:l}=te(),c=ci(),u=h.useRef(!1),d=async()=>{try{if(!c.id)return;const m=await Wt({collectionName:"Singers",id:c.id});if(!m.exists())return;const p={...m.data(),id:c.id},g=le(_t,Q(`singer_map.${p.id}`,"==",!0)),x=await $t(g,{getQueueId:()=>ZG(4)+"_"+p.id}),w=le(vn,Q(`singer_map.${p.id}`,"==",!0)),v=await Ln(w),S=[],_=[];v.forEach(E=>E.is_album?_.push(E):S.push(E)),s(x),e(p),o(S),n(_)}catch(m){console.log({error:m}),l()}finally{t(!1)}};return h.useEffect(()=>{u.current||(u.current=!0,d())},[]),{singer:i,isFetching:r}}function Ug({onClick:t,children:e}){const{songs:n}=xi();return a.jsx(se,{onClick:t,disabled:!n.length,size:"clear",color:"primary",className:"p-3",children:e})}function tW(){const{songs:t,singer:e}=xi(),{playStatus:n}=oe(Un),{currentSongData:r}=oe(We),{handleSetSong:s}=_r({variant:"playlist"}),{handlePlayPause:i}=gi(),o=()=>{const l=t[0];s(l.queue_id,t)};if(e&&r!=null&&r.song.queue_id.includes(e.id))switch(n){case"loading":case"paused":return a.jsx(Ug,{onClick:i,children:a.jsx(qa,{className:"w-7"})});default:return a.jsx(Ug,{onClick:i,children:a.jsx(Qu,{className:"w-7"})})}else return a.jsx(Ug,{onClick:o,children:a.jsx(qa,{className:"w-7"})})}function nW(){const{user:t,updateUserData:e}=xe(),{setSingers:n}=it(),{setSuccessToast:r}=te(),[s,i]=h.useState(!1);return{likeSinger:async({singer:l})=>{try{if(i(!0),!t)return;const c=mi(ie),u=st(ie,"Users",t.email),d=st(ie,"Singers",l.id),m=[...t.liked_singer_ids],p=m.findIndex(v=>v===l.id),g=p===-1;g?m.unshift(l.id):m.splice(p,1);const x={liked_singer_ids:m},w={like:Ks(g?1:-1)};c.update(u,x),c.update(d,w),await c.commit(),g?(r("Liked"),n(v=>[l,...v])):(n(v=>v.filter(S=>S.id!==l.id)),r("Disliked")),e(x)}catch(c){console.log({error:c})}finally{i(!1)}},isFetching:s,user:t}}function rW(){const{singer:t}=xi(),{likeSinger:e,isFetching:n,user:r}=nW(),s=h.useMemo(()=>r&&t?r.liked_singer_ids.includes(t.id):!1,[r]);return t?a.jsx("button",{onClick:()=>e({singer:t}),className:`${s?"text-[--primary-cl]":""}`,children:n?a.jsx(Ae,{className:"animate-spin"}):a.jsx(a.Fragment,{children:s?a.jsx(zl,{}):a.jsx(Au,{})})}):a.jsx(a.Fragment,{})}function sW(){const[t,e]=h.useState(""),n=h.useRef(null),{singer:r}=xi(),s=i=>{var o;e(i),(o=n.current)==null||o.open()};return a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>s("more"),className:"text-sm ml-auto !mt-0",children:"See more"}),a.jsx("div",{className:"!mt-auto",children:a.jsxs("div",{className:"flex items-end",children:[a.jsx(tW,{}),a.jsxs("div",{className:"flex space-x-2 ml-3 [&_button]:p-2 [&_svg]:w-6 hover:[&_button]:bg-[--a-5-cl] [&_button]:rounded-full",children:[a.jsx(rW,{}),a.jsxs(Fn,{appendOnPortal:!0,children:[a.jsx(Mn,{children:a.jsx("button",{children:a.jsx(ao,{})})}),a.jsx(Dn,{position:"right-bottom",origin:"top left",children:a.jsx(er,{className:"w-[140px]",children:a.jsx(Or,{children:a.jsx(Rw,{})})})})]})]})]})}),t&&a.jsx(ce,{ref:n,variant:"animation",children:t==="more"&&r&&a.jsx(_e,{children:r.description})})]})}function iW(){const{isFetching:t,singer:e}=xi();return!t&&!e?a.jsx(a.Fragment,{}):a.jsx(a.Fragment,{children:a.jsxs("div",{className:"md:flex bg-transparent relative z-0 pb-5 md:p-10 items-start",children:[a.jsx("div",{className:"absolute overflow-hidden -left-10 -top-[100px] -right-10 inset-0",children:a.jsxs("div",{className:"relative h-full w-full",children:[a.jsx("div",{className:"absolute z-[-5] inset-0 bg-white/50 dark:bg-black/50  "}),a.jsx("img",{src:(e==null?void 0:e.image_url)||yR,className:"blur-[50px] absolute z-[-10] w-full h-full object-center object-cover"})]})}),a.jsx("div",{className:"w-[70%] aspect-[1/1] rounded-full overflow-hidden z-0 relative mx-auto md:w-1/4 md:flex-shrink-0 md:m-unset",children:t?a.jsx(ge,{className:"pt-[100%] "}):a.jsx(Ce,{src:e==null?void 0:e.image_url,blurHashEncode:e==null?void 0:e.blurhash_encode,className:"object-cover h-full"})}),a.jsx("div",{className:"flex-grow z-0 relative flex flex-col mt-5 space-y-2.5  md:mt-0 md:ml-5",children:t?a.jsxs(a.Fragment,{children:[a.jsx(ge,{className:"h-[60px] w-full md:w-[200px]"}),a.jsx(ge,{className:"h-[24px] w-[200px]"}),a.jsx(ge,{className:"h-[120px] w-full md:w-[100%]"})]}):e&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-3xl font-bold",children:e.name}),a.jsxs("span",{className:"ml-4",children:["❤️ ",ns(e.like)]})]}),a.jsx("p",{className:"line-clamp-2",children:e.description}),a.jsx(sW,{})]})})]})})}function aW(){const{handleSetSong:t}=_r({variant:"songs"}),{isFetching:e,songs:n}=xi();return a.jsx(a.Fragment,{children:a.jsxs("div",{children:[a.jsx(ee,{variant:"h2",className:`mb-3 ${ta(!n.length)}`,title:"Popular Songs"}),a.jsx(En,{children:e?Rs:a.jsx(Sr,{whenEmpty:a.jsx(a.Fragment,{}),songs:n,setSong:r=>t(r.queue_id,[r])})})]})})}function oW(){const{isFetching:t,playlists:e}=xi();return a.jsx(a.Fragment,{children:a.jsxs("div",{children:[a.jsx(ee,{variant:"h2",title:"Popular Playlists",className:ta(!e.length)}),a.jsx(Hl,{whenEmpty:a.jsx(a.Fragment,{}),playlists:e,loading:t})]})})}function lW(){const{albums:t,isFetching:e}=xi();return a.jsxs("div",{children:[a.jsx(ee,{variant:"h2",title:"Albums",className:ta(!t.length)}),a.jsx(Hl,{whenEmpty:a.jsx(a.Fragment,{}),playlists:t,loading:e})]})}function cW(){const{isFetching:t,singer:e}=eW();return!t&&!e?a.jsx(ze,{children:a.jsx(Re,{variant:"with-home-button"})}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"space-y-5",children:[a.jsx(iW,{}),a.jsx(aW,{}),a.jsx(lW,{}),a.jsx(oW,{})]}),a.jsx(ui,{})]})}function uW(){return a.jsx(YG,{children:a.jsx(cW,{})})}function dW(){const[t,e]=h.useState(),[n,r]=h.useState([]),[s,i]=h.useState(!0),{setErrorToast:o}=te(),l=ci(),c=h.useRef(!1),u=async()=>{try{if(!l.id)return;const d=await Wt({collectionName:"Users",id:l.id});if(!d.exists())return;const m={...d.data()},p=le(vn,Q("owner_email","==",m.email),Q("is_public","==",!0),Q("is_official","==",!1)),g=await Ln(p),x=[],w=[];g.forEach(v=>v.is_album?w.push(v):x.push(v)),r(x),e(m)}catch(d){console.log({error:d}),o()}finally{i(!1)}};return h.useEffect(()=>{c.current||(c.current=!0,u())},[]),{user:t,playlists:n,isFetching:s}}function hW(){const{playlists:t,isFetching:e,user:n}=dW();return!e&&!n?a.jsx(ze,{children:a.jsx(Re,{variant:"with-home-button"})}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"mb-5",children:a.jsx(dN,{})}),a.jsxs("div",{className:"space-y-5",children:[a.jsxs("div",{className:"flex flex-col md:flex-row items-center",children:[e?a.jsx(ge,{className:"w-[100px] h-[100px] rounded-full"}):n&&a.jsx("div",{className:"w-[100px] h-[100px] rounded-full overflow-hidden",children:a.jsx(Ce,{src:n.photo_url})}),a.jsx("div",{className:"text-center mt-3 md:mt-0 md:ml-3 md:text-left ",children:e?a.jsxs(a.Fragment,{children:[a.jsx(ge,{className:"w-[300px] h-[30px]"}),a.jsx(ge,{className:"w-[200px] h-[22px] mt-1"})]}):n&&a.jsxs(a.Fragment,{children:[a.jsx("p",{className:"font-semibold text-2xl",children:n.display_name}),a.jsxs("p",{className:"text-[#666]",children:["Last seen: ",oN(n.last_seen)]})]})})]}),a.jsxs("div",{children:[a.jsx(ee,{title:"Playlists"}),a.jsx(Hl,{loading:e,playlists:t})]})]}),a.jsx(ui,{})]})}function fW({category:t}){return a.jsxs(X,{to:`/category/${t.id}`,className:"aspect-[5/3]  group relative rounded-lg overflow-hidden",children:[a.jsx(Ce,{className:"h-full group-hover:scale-[1.1] transition-transform duration-[.3s] object-cover",src:t.image_url}),a.jsx("div",{className:"absolute z-[0] inset-0 bg-black/10",children:a.jsx(ze,{children:a.jsx("p",{className:"text-xl font-bold text-white",children:t.name})})})]})}function mW({title:t,category_ids:e}){const{isFetching:n,categories:r}=JR({category_ids:e}),s=[...Array(3).keys()].map(i=>a.jsx(ge,{className:"aspect-[5/3]"},i));return a.jsx(a.Fragment,{children:a.jsxs("div",{children:[a.jsx(ee,{variant:"h2",title:t}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-3 md:grid-cols-4   gap-4 mt-3",children:n?s:r.map((i,o)=>a.jsx(fW,{category:i},o))})]})})}function pW(){const{categoryPage:t}=Bn(),{isFetching:e}=eN();return e?a.jsx(ze,{children:a.jsx(ua,{})}):a.jsxs(a.Fragment,{children:[a.jsxs(mo,{children:[a.jsx(ZR,{categoryIds:t!=null&&t.category_ids?t==null?void 0:t.category_ids.split("_"):[]}),t==null?void 0:t.category_sections.map((n,r)=>a.jsx(mW,{title:n.name,category_ids:n.target_ids?n.target_ids.split("_"):[]},r)),t==null?void 0:t.playlist_sections.map((n,r)=>a.jsx(Ow,{title:n.name,playlistIds:n.target_ids?n.target_ids.split("_"):[]},r))]}),a.jsx(ui,{})]})}function gW(){const{setErrorToast:t}=te(),{genres:e,setGenres:n}=it(),[r,s]=h.useState(),[i,o]=h.useState(),[l,c]=h.useState(""),[u,d]=h.useState(""),[m,p]=h.useState(!0),g=h.useRef(""),x=h.useMemo(()=>e.length?e.map(P=>P.name):[],[e]),w=P=>{var F;return((F=e.find(j=>bn(P)===bn(j.name)))==null?void 0:F.id)||""},v=h.useMemo(()=>w(l),[e,l]),S=()=>x.reduce((P,F)=>{const j={songs:[],shouldFetching:!0};return{...P,[w(F)]:j}},{}),_=h.useRef(!1),E=async()=>{try{const P=le(iR,Q("is_main","==",!0)),F=await bt(P);if(F.empty)return;const j=F.docs.map(k=>({...k.data(),id:k.id}));n(j),c(j[0].name)}catch{console.log("Error when get genres")}},I=async()=>{try{if(!u||!l||!v)return;p(!0);const P=r?{...r}:S(),F={...P[v]};let j=i?{...i}:void 0;if(g.current!==u){g.current=u;const k=await Wt({collectionName:"Trending_Metrics",id:u,msg:"Get trending data"});k.exists()?j=k.data().trending_songs:j=void 0}if(!j){o(void 0),P&&s(void 0);return}if(F.shouldFetching){F.shouldFetching=!1;const k=j[v];if(!k||!k.length){F.songs=[],Object.assign(P,{[v]:F}),s(P);return}const C=k.map(M=>M.song_id),R=le(_t,Q(Lr(),"in",C)),N=await $t(R);F.songs=N,Object.assign(P,{[v]:F}),s(P),o(j)}else await Jn(100)}catch(P){console.log({message:P}),t()}finally{p(!1)}};return h.useEffect(()=>{_.current||(_.current=!0,e.length?c(x[0]):E())},[]),h.useEffect(()=>{!u||!l||I()},[u,l]),{isFetching:m,songMap:r,tabs:x,KEY:v,tab:l,setTab:c,setWeek:d}}function xW(){const t=new Date(Date.now()),e=t.getFullYear(),n=new Date(e,0,1);return n.setDate(n.getDate()+n.getDay()%7),{currentWeek:Math.round((t.getTime()-n.getTime())/(7*24*3600*1e3)),currentYear:e}}function yW({submit:t}){const[e,n]=h.useState([]),[r,s]=h.useState(0),i=h.useMemo(()=>e[r],[r]);return h.useEffect(()=>{const o=[],{currentWeek:l,currentYear:c}=xW();for(let u=1;u<=l;u++)o.push({label:`Week ${u}, ${c}`,value:`${c}-W${u}`});n(o),s(o.length-1),t(o[o.length-1].value)},[]),{weekOptions:e,currentWeekData:i,setCurrentIndex:s,currentIndex:r}}function vW({weekOptions:t,submit:e,currentIndex:n}){const{state:{isOpen:r}}=Ul(),s=h.useRef(null);return h.useEffect(()=>{r&&s.current&&s.current.scrollIntoView({behavior:"instant",block:"center"})},[r]),a.jsx(a.Fragment,{children:t.map((i,o)=>{const l=n===o;return a.jsx("button",{ref:l?s:void 0,className:`${l?"text-[--primary-cl] font-bold":""}`,onClick:()=>e(o),children:i.label},o)})})}function wW(t){const{weekOptions:e,currentIndex:n,currentWeekData:r,setCurrentIndex:s}=yW(t);return a.jsxs(Fn,{appendOnPortal:!0,children:[a.jsx(Mn,{children:a.jsx("button",{className:"py-2 text-sm font-semibold px-4 rounded-full bg-[--a-5-cl]",children:r==null?void 0:r.label})}),a.jsx(Dn,{position:"right-bottom",origin:"top left",children:a.jsx(er,{children:a.jsx(Or,{className:"w-[160px] h-[30vh] overflow-auto",children:a.jsx(vW,{weekOptions:e,currentIndex:n,submit:i=>{s(i),t.submit(e[i].value)}})})})})]})}function _W(){var i;const{isFetching:t,songMap:e,setWeek:n,KEY:r,...s}=gW();return a.jsxs("div",{children:[a.jsx(ee,{title:"Week Table",className:"mb-3"}),a.jsxs("div",{className:"mb-5 space-y-3",children:[a.jsx(tr,{className:"w-fit",render:o=>o,...s}),a.jsx(wW,{submit:o=>n(o)})]}),a.jsxs(En,{children:[t&&Rs,!t&&a.jsx(a.Fragment,{children:e&&((i=e[r])!=null&&i.songs.length)?a.jsx(Sr,{songs:e[r].songs,setSong:()=>{}}):a.jsx(Re,{})})]})]})}function SW(){return a.jsxs(a.Fragment,{children:[a.jsxs(mo,{children:[a.jsx(YR,{amount:10}),a.jsx(_W,{})]}),a.jsx(ui,{})]})}function bW({songIds:t}){const[e,n]=h.useState([]),{handleSetSong:r}=_r({variant:"songs"}),{isFetching:s}=WR({setSongs:n,songIds:t});return s?Rs:e.length?a.jsx(En,{children:a.jsxs("div",{className:"mt-5",children:[a.jsx(lp,{variant:"system-song",children:a.jsx(ee,{variant:"h2",title:"Hot songs"})}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-4 mt-3",children:a.jsx(Sr,{songs:e,setSong:i=>r(i.queue_id,e)})})]})}):a.jsx(a.Fragment,{})}function EW(){const[t,e]=h.useState(),{isFetching:n}=GR({setCategory:e}),[r,s]=h.useMemo(()=>[t!=null&&t.song_ids?t.song_ids.split("_"):[],t!=null&&t.playlist_ids?t.playlist_ids.split("_"):[]],[t]);return n?a.jsx(ze,{children:a.jsx(ua,{})}):t?a.jsxs(a.Fragment,{children:[a.jsxs(mo,{children:[a.jsxs("div",{children:[a.jsx(ee,{title:t.name}),a.jsx("div",{className:"relative rounded-lg overflow-hidden aspect-[16/4] mt-5",children:a.jsx(Ce,{src:t.banner_image_url,blurHashEncode:t.banner_blurhash_encode,className:"object-cover h-full"})})]}),a.jsx(bW,{songIds:r}),a.jsx(Ow,{playlistIds:s})]}),a.jsx(ui,{})]}):a.jsx(ze,{children:a.jsx(Re,{variant:"with-home-button"})})}function kW(){const{setErrorToast:t}=te(),[e,n]=h.useState(!1),[r,s]=h.useState([]),i=h.useRef(!0),o=async()=>{try{n(!0);const l=le(St(ie,"Trending_Keywords"),Lt("week_count","desc"),Mt(5)),c=await bt(l);if(c.empty)return;const u=c.docs.map(d=>d.id);s(u)}catch{console.log("error"),t("")}finally{n(!1)}};return h.useEffect(()=>{console.log(i.current),i.current&&(i.current=!1,o())},[]),{trendingKeywords:r,isFetching:e}}function jW(){const{trendingKeywords:t,isFetching:e}=kW();return a.jsxs(a.Fragment,{children:[a.jsx("h1",{className:"text-xl font-bold text-[#333]",children:"Trending search now"}),e&&a.jsx(Vn,{}),!e&&a.jsx(Ot,{children:a.jsx("div",{className:"flex flex-wrap -ml-2",children:t.map((n,r)=>a.jsx(ks,{children:a.jsxs("span",{children:[n," 🔥🔥🔥"]})},r))})})]})}function is({className:t="",children:e,...n}){return a.jsx(Ot,{className:"overflow-x-auto w-full",children:a.jsx("div",{className:"rounded-md overflow-hidden",children:a.jsx(vR,{className:`[&_td]:text-sm hover:[&_tr:not(.no-hover)]:bg-black/5 [&_tbody_tr:not(.no-hover)]:border-t [&_tr]:border-black/5 [&_th]:text-sm [&_th]:text-left [&_td]:p-2 [&_th]:p-2 [&_th]:font-bold  ${t}`,...n,children:e})})})}function TW(){const{songs:t,isFetching:e}=KR({amount:5});return a.jsxs(a.Fragment,{children:[a.jsx("h1",{className:"text-xl font-bold text-[#333]",children:"Trending song now"}),e&&a.jsx(ze,{children:a.jsx(Vn,{})}),!e&&a.jsx(is,{colList:["Name","Singers","Today plays"],children:t.length?t.map((n,r)=>a.jsxs("tr",{children:[a.jsx("td",{children:a.jsx(X,{to:`/dashboard/song/${n.id}/edit`,className:"hover:underline",children:n.name})}),a.jsx("td",{children:n.singers.map((s,i)=>a.jsxs(X,{className:"hover:underline",to:`/dashboard/singer/${s.id}`,children:[!!i&&", ",s.name]},i))}),a.jsx("td",{children:n.today_play})]},r)):a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"text-center",children:a.jsx(Re,{})})})})]})}function IW(){return a.jsx(a.Fragment,{children:a.jsxs("div",{className:"space-y-5",children:[a.jsx(TW,{}),a.jsx(jW,{})]})})}const Yd=6,CW=["All","Result"];function RW(){const{setUploadedSongs:t,lastDoc:e,shouldFetchUserSongs:n,setHasMore:r}=it(),{setErrorToast:s}=te(),[i,o]=h.useState(""),[l,c]=h.useState(!0),[u,d]=h.useState("All"),[m,p]=h.useState([]),g=async w=>{try{if(w.preventDefault(),l)return;c(!0);const v=lr(_t,[Q("is_official","==",!0)],i),S=await $t(v);p(S),d("Result")}catch(v){console.log({message:v}),s()}finally{c(!1)}},x=async()=>{try{c(!0);const w=St(ie,"Songs"),v=e.current?le(w,Q("is_official","==",!0),Lt("updated_at","desc"),Hm(e.current),Mt(Yd)):le(w,Q("is_official","==",!0),Lt("updated_at","desc"),Mt(Yd)),S=await bt(v),_=S.docs.map(E=>({...E.data(),id:E.id,queue_id:""}));e.current?t(E=>[...E,..._]):t(_),_.length<Yd?r(!1):e.current=S.docs[Yd-1]}catch(w){console.log({message:w}),s()}finally{c(!1)}};return h.useEffect(()=>{n.current?(n.current=!1,x()):c(!1)},[]),{isFetching:l,value:i,setValue:o,handleSubmit:g,tab:u,setTab:d,tabs:CW,getSong:x,searchResult:m}}function NW(){const{hasMore:t,uploadedSongs:e}=it(),{isFetching:n,getSong:r,searchResult:s,tabs:i,setTab:o,tab:l,...c}=RW(),u=h.useMemo(()=>l==="All"?e:s,[l,e,s]);return a.jsxs(a.Fragment,{children:[a.jsx(ee,{title:"Songs"}),a.jsxs("div",{className:"flex justify-between items-start mt-3",children:[a.jsx(fo,{loading:l==="Result"&&n,...c}),a.jsxs(q,{href:"/dashboard/song/add-song",className:"p-1.5 ml-5",size:"clear",children:[a.jsx(Es,{className:"w-6"}),a.jsx("div",{className:"hidden md:block",children:"Add song"})]})]}),a.jsx("div",{className:"mt-5 w-fit self-start",children:a.jsx(tr,{disable:l==="All",tabs:i,render:d=>d,tab:l,setTab:o})}),a.jsx("div",{className:"mt-3",children:a.jsx(is,{colList:["Name","Singers","Genre",""],children:u.length?a.jsxs(a.Fragment,{children:[u.map((d,m)=>a.jsx(L8,{variant:"songs",song:d},m)),l==="All"&&n&&a.jsx("tr",{className:"no-hover border-none",children:a.jsx("td",{colSpan:9,children:a.jsx(Ae,{className:"animate-spin w-7 mx-auto"})})}),l==="All"&&a.jsx("tr",{className:"no-hover",children:a.jsx("td",{colSpan:9,className:"text-center hover:bg-none",children:a.jsx(q,{disabled:!t,onClick:r,children:"Get more"})})})]}):a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"text-center",children:a.jsx(Re,{})})})})})]})}function AW(){const[t,e]=h.useState(),[n,r]=h.useState(),[s,i]=h.useState([]),[o,l]=h.useState(),[c,u]=h.useState([]),[d,m]=h.useState(),[p,g]=h.useState(),[x,w]=h.useState(),v=h.useRef("add"),S=h.useRef(null);return{imageFile:d,setImageFile:m,songFile:t,setSongFile:e,songData:n,song:p,setSong:g,variant:v,setSongData:r,updateSongData:F=>{n&&r({...n,...F})},singers:s,setSingers:i,setGenres:u,genres:c,selectGenre:F=>{const j=[...c],k=j.findIndex(C=>C.id===F.id);k===-1?j.push(F):j.splice(k,1),u(j)},selectSinger:F=>{const j=[...s],k=j.findIndex(C=>C.id===F.id);k===-1?j.push(F):j.splice(k,1),i(j)},imageBlob:x,setImageBlob:w,resetAddSongContext:()=>{e(void 0),i([]),u([])},audioRef:S,mainGenre:o,setMainGenre:l}}const SN=h.createContext(null);function PW({children:t}){return a.jsx(SN.Provider,{value:AW(),children:t})}const as=()=>{const t=h.useContext(SN);if(!t)throw new Error("AddSongProvider not provided");return t};function bN({afterSearched:t=()=>{},setIsFetchingParent:e}){const{setErrorToast:n}=te(),[r,s]=h.useState(""),[i,o]=h.useState(!1),[l,c]=h.useState(!1),[u,d]=h.useState([]),m=e||o;return{value:r,isShowResult:l,setValue:s,result:u,handleSubmit:async g=>{try{if(g.preventDefault(),g.stopPropagation(),i)return;m(!0),c(!0);const x=lr(Qa,[],r),w=await wu(x);console.log(w),d(w),t()}catch(x){console.log({message:x}),n()}finally{m(!1)}},isFetching:i}}const FW=6;function MW(){const[t,e]=h.useState([]),[n,r]=h.useState(),[s,i]=h.useState([]),[o,l]=h.useState([]),[c,u]=h.useState([]),[d,m]=h.useState(!0),p=h.useRef(),g=h.useRef(!0);return{singer:n,setSinger:r,singers:t,setSingers:e,songs:s,setSongs:i,playlists:o,setPlaylists:l,albums:c,setAlbums:u,hasMore:d,setHasMore:m,lastDoc:p,shouldGetSingers:g,PAGE_SIZE:FW}}const EN=h.createContext(null);function DW({children:t}){return a.jsx(EN.Provider,{value:MW(),children:t})}function os(){const t=h.useContext(EN);if(!t)throw new Error("SingerProvider not provided");return t}const LW=["Newest","Result"];function OW(){const{singers:t,PAGE_SIZE:e,setSingers:n,setHasMore:r,lastDoc:s,shouldGetSingers:i}=os(),[o,l]=h.useState(!1),[c,u]=h.useState("Newest"),{isFetching:d,...m}=bN({setIsFetchingParent:l,afterSearched:()=>{u("Result")}}),p=async()=>{try{l(!0),r(w=>s.current&&!w?(s.current=void 0,!w):w);const g=le(Qa,Lt("created_at","desc"),Mt(e)),x=await wu(g);n(x)}catch(g){console.log(g)}finally{l(!1)}};return h.useEffect(()=>{i.current&&(i.current=!1,p())},[]),{...m,isFetching:o,singers:t,getNewestSingers:p,tabs:LW,tab:c,setTab:u}}function kN(t){const{setErrorToast:e,setSuccessToast:n}=te(),{singer:r,setSinger:s,setSingers:i,shouldGetSingers:o,lastDoc:l}=os(),[c,u]=h.useState(),[d,m]=h.useState(),[p,g]=h.useState(!1),x=h.useRef(null),w=P=>{c&&u({...c,...P})},v=h.useMemo(()=>t.variant==="add"?!0:!r||!c?!1:c.name!==r.name||c.description!==r.description||c.like!==r.like,[c]),S=!!d,_=h.useMemo(()=>{const P=!!(c!=null&&c.name)&&v;return t.variant==="add"?P:P||S},[S,v,c]),E=async()=>{var P;try{if(!_||!c)return;g(!0);const F={...c,name:c.name.trim(),meta:bn(c.name.trim()).split(" ")};if(d){const j=await pi({imageFile:d});Object.assign(F,j)}switch(t.variant){case"add":{const j=await Ts({collectionName:"Singers",data:F}),k={...c,id:j.id};i(C=>[k,...C]),t.afterSubmit&&(Object.assign(k,{created_at:""}),t.afterSubmit(k)),n("Add singer successful");break}case"edit":{if(!r)return;await Se({collectionName:"Singers",id:r.id,data:F}),s({...r,...F}),o.current=!0,l.current=void 0,n("Edit singer successful")}}}catch(F){console.log(F),e()}finally{g(!1),(P=t.modalRef.current)==null||P.close()}},I=()=>{switch(t.variant){case"add":return Hx({name:t.name});case"edit":if(!r)throw new Error("");const{id:P,...F}=r;return Hx(F)}};return h.useEffect(()=>{var P,F;t.variant==="add"&&((P=x.current)==null||P.focus(),(F=t.modalRef.current)==null||F.setModalPersist(!0)),u(I())},[]),h.useEffect(()=>{var P;t.variant==="edit"&&(v||S)&&((P=t.modalRef.current)==null||P.setModalPersist(!0))},[v,S]),h.useEffect(()=>{d&&w({image_url:URL.createObjectURL(d)})},[d]),h.useEffect(()=>{var P;(P=x.current)==null||P.focus()},[]),{singerData:c,imageFile:d,setImageFile:m,updateSingerData:w,setSingerData:u,inputRef:x,handleSubmit:E,isFetching:p,isValidToSubmit:_}}function $W({modalRef:t,afterSubmit:e,singerName:n}){const{handleSubmit:r,isFetching:s,isValidToSubmit:i,singerData:o,updateSingerData:l}=kN({variant:"add",modalRef:t,afterSubmit:e,name:n}),c=(u,d)=>{l({...o,[u]:d})};return a.jsxs(_e,{className:"w-[450px]",children:[a.jsx(Be,{closeModal:()=>{var u;return(u=t.current)==null?void 0:u.close()},title:"Add singer"}),a.jsx("div",{className:"space-y-3 overflow-auto",children:a.jsxs("div",{className:"space-y-1",children:[a.jsx(Dt,{htmlFor:"name",children:"Singer name"}),a.jsx(_n,{id:"name",value:(o==null?void 0:o.name)||"",onChange:u=>c("name",u.target.value),placeholder:"name..."})]})}),a.jsx("div",{className:"text-center mt-5",children:a.jsxs(q,{disabled:!i,loading:s,onClick:()=>i&&r(),children:[a.jsx(aa,{className:"w-6"}),a.jsx("p",{className:"text-white",children:"Ok"})]})})]})}function jN({choose:t,closeModal:e}){const{result:n,isShowResult:r,isFetching:s,setTab:i,getNewestSingers:o,tab:l,singers:c,tabs:u,...d}=OW(),m=h.useRef(null),p=g=>g.map((x,w)=>a.jsx("button",{onClick:()=>t(x),className:"rounded-md w-full p-1 text-sm font-semibold text-left hover:bg-[--a-5-cl]",children:x.name},w));return a.jsxs(a.Fragment,{children:[a.jsxs(_e,{children:[a.jsx(Be,{title:"Singers",closeModal:e}),a.jsx(fo,{...d}),a.jsx(tr,{className:"w-fit mt-3",buttonClasses:"[&_button]:px-3 [&_button]:py-1/2",tabs:u,setTab:i,tab:l,render:g=>g}),a.jsx("div",{className:"h-[40vh] mt-2 space-y-1.5 overflow-auto bg-[--a-5-cl] p-2 rounded-md",children:s?a.jsx(Vn,{className:"h-full"}):a.jsxs(a.Fragment,{children:[l==="Newest"&&a.jsxs(a.Fragment,{children:[c.length?p(c):a.jsx(Re,{variant:"less"}),a.jsx("p",{className:"text-center mt-3",children:a.jsx(q,{onClick:o,children:a.jsx(Ae,{className:"w-5"})})})]}),l==="Result"&&r&&a.jsx(a.Fragment,{children:n.length?p(n):a.jsxs(a.Fragment,{children:[a.jsx(Re,{variant:"less"}),a.jsx("p",{className:"text-center mt-auto",children:a.jsxs(q,{onClick:()=>{var g;return(g=m.current)==null?void 0:g.open()},children:[a.jsx(Es,{className:"w-6"}),a.jsx("span",{children:"Add new singer"})]})})]})})]})})]}),a.jsx(ce,{ref:m,variant:"animation",children:a.jsx($W,{afterSubmit:t,singerName:d.value,modalRef:m})})]})}function zW(){const{singers:t,selectSinger:e}=as(),n=h.useRef(null),r=()=>{var i;return(i=n.current)==null?void 0:i.close()},s=i=>{e(i),r()};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("div",{children:"Singer"}),a.jsxs("div",{className:"-ml-2 flex flex-wrap",children:[t.map((i,o)=>a.jsxs(ks,{children:[a.jsx("span",{children:i.name}),a.jsx("div",{className:"flex",children:a.jsx("button",{onClick:()=>e(i),children:a.jsx(pt,{className:"w-5"})})})]},o)),a.jsx(q,{onClick:()=>{var i;return(i=n.current)==null?void 0:i.open()},className:"mt-2 ml-2 h-[38px] w-[38px] justify-center",size:"clear",children:a.jsx(Es,{className:"w-5"})})]})]}),a.jsx(cw,{ref:n,children:a.jsx(jN,{closeModal:r,choose:s})})]})}function BW({audioEle:t}){const{status:e,handlePlayPause:n,progressLineRef:r,currentTimeRef:s,durationRef:i}=rp({audioEle:t}),o=()=>{switch(e){case"error":return a.jsx(gm,{className:"w-6"});case"playing":return a.jsx(fv,{className:"w-6"});case"paused":return a.jsx(cf,{className:"w-6"});case"waiting":return a.jsx(Ae,{className:"w-6 animate-spin"})}};return a.jsx(a.Fragment,{children:a.jsxs("div",{className:"flex items-end justify-between",children:[a.jsx(q,{className:"p-1.5",size:"clear",onClick:n,children:o()}),a.jsxs("div",{className:"flex flex-grow items-center ml-4",children:[a.jsx("div",{className:"text-sm w-[50px]",ref:s,children:"00:00"}),a.jsx(rd,{elelRef:r,className:"h-1"}),a.jsx("div",{className:"text-sm w-[50px] text-right",ref:i,children:"00:00"})]})]})})}function VW(){const[t,e]=h.useState([]),{mains:n,subs:r}=h.useMemo(()=>{const i=[],o=[];return t.forEach(l=>{l.is_main?i.push(l):o.push(l)}),{mains:i,subs:o}},[t]),s=h.useRef(!0);return{genres:t,mains:n,subs:r,shouldFetchGenre:s,setGenres:e}}const TN=h.createContext(null);function UW({children:t}){return a.jsx(TN.Provider,{value:VW(),children:t})}const dp=()=>{const t=h.useContext(TN);if(!t)throw new Error("GenreProvider is not provided");return t};function IN(){const{setGenres:t,genres:e}=dp(),{setErrorToast:n,setSuccessToast:r}=te(),[s,i]=h.useState(!1);return{isFetching:s,action:async l=>{try{switch(i(!0),l.type){case"add":{if(e.find(m=>m.name===l.genre.name))return await Jn(100),n("Genre already exist");const u=await Ts({collectionName:"Genres",data:l.genre}),d={...l.genre,id:u.id};return t(m=>[d,...m]),i(!1),r("Add genre successful"),d}case"edit":{await Se({collectionName:"Genres",data:l.genre,id:l.id});const c=[...e],u=c.findIndex(m=>m.id===l.id),d={...e[u]};Object.assign(d,l.genre),c[u]=d,t(c),r("Edit genre successful");break}case"delete":{await Km({collectionName:"Genres",id:l.id}),t(c=>c.filter(u=>u.id!==l.id)),r("Delete genre successful");break}}}catch{}finally{i(!1)}}}}function hp({closeModal:t,afterSubmit:e,...n}){const[r,s]=h.useState(n.type==="add"?n.genreName||"":n.genre.name),[i,o]=h.useState(n.type==="add"?n.isMain||!1:n.genre.is_main),{action:l,isFetching:c}=IN(),{setErrorToast:u}=te(),d=h.useRef(null),m=!!r,p=async()=>{try{if(!r.trim())return;const w={is_main:i,name:r};switch(n.type){case"add":const v=await l({type:"add",genre:w});v&&e&&e(v);break;case"edit":await l({type:"edit",genre:w,id:n.genre.id});break}}catch(w){console.log(w),u()}finally{t()}},g={inputGroup:"space-y-1"};h.useEffect(()=>{var w;(w=d.current)==null||w.focus()},[]);const x=n.type==="edit"?`Edit '${n.genre.name}'`:"Add genre";return a.jsxs(_e,{className:"w-[450px]",children:[a.jsx(Be,{closeModal:t,title:x}),a.jsxs("div",{className:"space-y-3 overflow-auto mt-5",children:[a.jsxs("div",{className:g.inputGroup,children:[a.jsx(Dt,{children:"Name"}),a.jsx(_n,{ref:d,value:r,onChange:w=>s(w.target.value),placeholder:"name..."})]}),a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx(Dt,{children:"Main"}),a.jsx(Ho,{inActiveBg:"bg-black/10",active:i,cb:()=>o(!i)})]})]}),a.jsx("div",{className:"text-right mt-10",children:a.jsxs(q,{disabled:!m,loading:c,onClick:()=>m&&p(),children:[a.jsx(aa,{className:"w-6"}),a.jsx("p",{className:"text-white",children:"Ok"})]})}),c&&a.jsx(da,{})]})}function fp(){const{setGenres:t,shouldFetchGenre:e}=dp(),[n,r]=h.useState(!0);return{api:async()=>{try{if(e.current){e.current=!1;const i=St(ie,"Genres"),o=le(i);console.log(">>> fetch genres");const l=await bt(o);if(l.docs){const c=l.docs.map(u=>({...u.data(),id:u.id}));t(c)}}else await Jn(100)}catch(i){console.log(i)}finally{r(!1)}},isFetching:n}}function CN(){const{genres:t,subs:e,mains:n}=dp(),[r,s]=h.useState(""),i=BR(r,800),o=h.useMemo(()=>i?t.filter(l=>bn(l.name).includes(bn(i))):[],[i,t]);return{value:r,setValue:s,_genres:o,mains:n,subs:e}}function HW({closeModal:t,choose:e}){const{subs:n,...r}=CN(),s=h.useRef(null),i=h.useRef(null),o=()=>{var u;return(u=s.current)==null?void 0:u.close()},{api:l,isFetching:c}=fp();return h.useEffect(()=>{var u;l(),(u=i.current)==null||u.focus()},[]),a.jsxs(a.Fragment,{children:[a.jsxs(_e,{children:[a.jsx(Be,{title:"Genre",closeModal:t}),a.jsx(hR,{inputRef:i,...r}),a.jsx("div",{className:"h-[40vh] mt-3 space-y-1.5 overflow-auto",children:c?a.jsx(Vn,{className:"h-full"}):a.jsx(a.Fragment,{children:n.length?n.map((u,d)=>a.jsx(Ot,{onClick:()=>e(u),children:a.jsx("p",{className:"text-lg",children:u.name})},d)):a.jsx(a.Fragment,{children:a.jsx(Re,{})})})}),a.jsx("p",{className:"text-center mt-auto",children:a.jsxs(q,{onClick:()=>{var u;return(u=s.current)==null?void 0:u.open()},children:[a.jsx(zt,{className:"w-6"}),a.jsx("span",{children:"Add new genre"})]})})]}),a.jsx(ce,{ref:s,variant:"animation",children:a.jsx(hp,{afterSubmit:e,genreName:r.value,type:"add",closeModal:o})})]})}function GW({closeModal:t,choose:e}){const{mains:n}=dp(),r=h.useRef(null),s=()=>{var l;return(l=r.current)==null?void 0:l.close()},{api:i,isFetching:o}=fp();return h.useEffect(()=>{i()},[]),a.jsxs(a.Fragment,{children:[a.jsxs(_e,{children:[a.jsx(Be,{title:"Genre",closeModal:t}),a.jsx("div",{className:"h-[40vh] mt-3 space-y-1.5 overflow-auto",children:o?a.jsx(Vn,{className:"h-full"}):a.jsx(a.Fragment,{children:n.length?n.map((l,c)=>a.jsx(Ot,{onClick:()=>{e(l),t()},children:a.jsx("p",{className:"text-lg",children:l.name})},c)):a.jsx(a.Fragment,{children:a.jsx(Re,{})})})}),a.jsx("p",{className:"text-center mt-auto",children:a.jsxs(q,{onClick:()=>{var l;return(l=r.current)==null?void 0:l.open()},children:[a.jsx(zt,{className:"w-6"}),a.jsx("span",{children:"Add new genre"})]})})]}),a.jsx(ce,{ref:r,variant:"animation",children:a.jsx(hp,{afterSubmit:e,type:"add",isMain:!0,closeModal:s})})]})}function WW(){const{genres:t,songData:e,updateSongData:n,selectGenre:r}=as(),[s,i]=h.useState(""),o=h.useRef(null),l=d=>{var m;i(d),(m=o.current)==null||m.open()},c=d=>{r(d),u()},u=()=>{var d;return(d=o.current)==null?void 0:d.close()};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex w-full",children:[a.jsxs("div",{className:"w-1/2",children:[a.jsx("div",{children:"Main genre"}),a.jsxs("div",{className:"-ml-2 flex flex-wrap",children:[(e==null?void 0:e.main_genre)&&a.jsxs(ks,{className:"w-fit",children:[a.jsx("span",{children:e.main_genre.name}),a.jsx("div",{children:a.jsx("button",{onClick:()=>n({main_genre:void 0}),children:a.jsx(pt,{className:"w-5"})})})]}),!(e!=null&&e.main_genre)&&a.jsx(q,{onClick:()=>l("main"),className:"mt-2 ml-2 h-[38px] w-[38px] justify-center",size:"clear",children:a.jsx(Es,{className:"w-5"})})]})]}),a.jsxs("div",{className:"flex-grow",children:[a.jsx("div",{children:"Sub genres"}),a.jsxs("div",{className:"flex flex-wrap -ml-2",children:[t.map((d,m)=>a.jsxs(ks,{children:[a.jsx("span",{children:d.name}),a.jsx("div",{children:a.jsx("button",{onClick:()=>r(d),children:a.jsx(pt,{className:"w-5"})})})]},m)),a.jsx(q,{onClick:()=>l("sub"),className:"mt-2 ml-2 h-[38px] w-[38px] justify-center",size:"clear",children:a.jsx(Es,{className:"w-5"})})]})]})]}),a.jsxs(cw,{ref:o,children:[s==="sub"&&a.jsx(HW,{closeModal:u,choose:c}),s==="main"&&a.jsx(GW,{closeModal:u,choose:d=>n({main_genre:d})})]})]})}const qW="End-Of-Stream";class vt extends Error{constructor(){super(qW)}}class KW{constructor(){this.maxStreamReadSize=1*1024*1024,this.endOfStream=!1,this.peekQueue=[]}async peek(e,n,r){const s=await this.read(e,n,r);return this.peekQueue.push(e.subarray(n,n+s)),s}async read(e,n,r){if(r===0)return 0;let s=this.readFromPeekBuffer(e,n,r);if(s+=await this.readRemainderFromStream(e,n+s,r-s),s===0)throw new vt;return s}readFromPeekBuffer(e,n,r){let s=r,i=0;for(;this.peekQueue.length>0&&s>0;){const o=this.peekQueue.pop();if(!o)throw new Error("peekData should be defined");const l=Math.min(o.length,s);e.set(o.subarray(0,l),n+i),i+=l,s-=l,l<o.length&&this.peekQueue.push(o.subarray(l))}return i}async readRemainderFromStream(e,n,r){let s=r,i=0;for(;s>0&&!this.endOfStream;){const o=Math.min(s,this.maxStreamReadSize),l=await this.readFromStream(e,n+i,o);if(l===0)break;i+=l,s-=l}return i}}class QW extends KW{constructor(e){super(),this.reader=e.getReader({mode:"byob"})}async readFromStream(e,n,r){if(this.endOfStream)throw new vt;const s=await this.reader.read(new Uint8Array(r));return s.done&&(this.endOfStream=s.done),s.value?(e.set(s.value,n),s.value.byteLength):0}}class RN{constructor(e){this.position=0,this.numBuffer=new Uint8Array(8),this.fileInfo=(e==null?void 0:e.fileInfo)??{},this.onClose=e==null?void 0:e.onClose}async readToken(e,n=this.position){const r=new Uint8Array(e.len);if(await this.readBuffer(r,{position:n})<e.len)throw new vt;return e.get(r,0)}async peekToken(e,n=this.position){const r=new Uint8Array(e.len);if(await this.peekBuffer(r,{position:n})<e.len)throw new vt;return e.get(r,0)}async readNumber(e){if(await this.readBuffer(this.numBuffer,{length:e.len})<e.len)throw new vt;return e.get(this.numBuffer,0)}async peekNumber(e){if(await this.peekBuffer(this.numBuffer,{length:e.len})<e.len)throw new vt;return e.get(this.numBuffer,0)}async ignore(e){if(this.fileInfo.size!==void 0){const n=this.fileInfo.size-this.position;if(e>n)return this.position+=n,n}return this.position+=e,e}async close(){var e;await((e=this.onClose)==null?void 0:e.call(this))}normalizeOptions(e,n){if(n&&n.position!==void 0&&n.position<this.position)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");return n?{mayBeLess:n.mayBeLess===!0,offset:n.offset?n.offset:0,length:n.length?n.length:e.length-(n.offset?n.offset:0),position:n.position?n.position:this.position}:{mayBeLess:!1,offset:0,length:e.length,position:this.position}}}const XW=256e3;class YW extends RN{constructor(e,n){super(n),this.streamReader=e}async readBuffer(e,n){const r=this.normalizeOptions(e,n),s=r.position-this.position;if(s>0)return await this.ignore(s),this.readBuffer(e,n);if(s<0)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");if(r.length===0)return 0;const i=await this.streamReader.read(e,r.offset,r.length);if(this.position+=i,(!n||!n.mayBeLess)&&i<r.length)throw new vt;return i}async peekBuffer(e,n){const r=this.normalizeOptions(e,n);let s=0;if(r.position){const i=r.position-this.position;if(i>0){const o=new Uint8Array(r.length+i);return s=await this.peekBuffer(o,{mayBeLess:r.mayBeLess}),e.set(o.subarray(i),r.offset),s-i}if(i<0)throw new Error("Cannot peek from a negative offset in a stream")}if(r.length>0){try{s=await this.streamReader.peek(e,r.offset,r.length)}catch(i){if(n!=null&&n.mayBeLess&&i instanceof vt)return 0;throw i}if(!r.mayBeLess&&s<r.length)throw new vt}return s}async ignore(e){const n=Math.min(XW,e),r=new Uint8Array(n);let s=0;for(;s<e;){const i=e-s,o=await this.readBuffer(r,{length:Math.min(n,i)});if(o<0)return o;s+=o}return s}}class JW extends RN{constructor(e,n){super(n),this.uint8Array=e,this.fileInfo.size=this.fileInfo.size?this.fileInfo.size:e.length}async readBuffer(e,n){if(n!=null&&n.position){if(n.position<this.position)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");this.position=n.position}const r=await this.peekBuffer(e,n);return this.position+=r,r}async peekBuffer(e,n){const r=this.normalizeOptions(e,n),s=Math.min(this.uint8Array.length-r.position,r.length);if(!r.mayBeLess&&s<r.length)throw new vt;return e.set(this.uint8Array.subarray(r.position,r.position+s),r.offset),s}close(){return super.close()}}function NN(t,e){return new YW(new QW(t),e)}function kl(t,e){return new JW(t,e)}/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */var mp=function(t,e,n,r,s){var i,o,l=s*8-r-1,c=(1<<l)-1,u=c>>1,d=-7,m=n?s-1:0,p=n?-1:1,g=t[e+m];for(m+=p,i=g&(1<<-d)-1,g>>=-d,d+=l;d>0;i=i*256+t[e+m],m+=p,d-=8);for(o=i&(1<<-d)-1,i>>=-d,d+=r;d>0;o=o*256+t[e+m],m+=p,d-=8);if(i===0)i=1-u;else{if(i===c)return o?NaN:(g?-1:1)*(1/0);o=o+Math.pow(2,r),i=i-u}return(g?-1:1)*o*Math.pow(2,i-r)},pp=function(t,e,n,r,s,i){var o,l,c,u=i*8-s-1,d=(1<<u)-1,m=d>>1,p=s===23?Math.pow(2,-24)-Math.pow(2,-77):0,g=r?0:i-1,x=r?1:-1,w=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(l=isNaN(e)?1:0,o=d):(o=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-o))<1&&(o--,c*=2),o+m>=1?e+=p/c:e+=p*Math.pow(2,1-m),e*c>=2&&(o++,c/=2),o+m>=d?(l=0,o=d):o+m>=1?(l=(e*c-1)*Math.pow(2,s),o=o+m):(l=e*Math.pow(2,m-1)*Math.pow(2,s),o=0));s>=8;t[n+g]=l&255,g+=x,l/=256,s-=8);for(o=o<<s|l,u+=s;u>0;t[n+g]=o&255,g+=x,o/=256,u-=8);t[n+g-x]|=w*128};function Ee(t){return new DataView(t.buffer,t.byteOffset)}const ke={len:1,get(t,e){return Ee(t).getUint8(e)},put(t,e,n){return Ee(t).setUint8(e,n),e+1}},Ve={len:2,get(t,e){return Ee(t).getUint16(e,!0)},put(t,e,n){return Ee(t).setUint16(e,n,!0),e+2}},Ge={len:2,get(t,e){return Ee(t).getUint16(e)},put(t,e,n){return Ee(t).setUint16(e,n),e+2}},Lf={len:3,get(t,e){const n=Ee(t);return n.getUint8(e)+(n.getUint16(e+1,!0)<<8)},put(t,e,n){const r=Ee(t);return r.setUint8(e,n&255),r.setUint16(e+1,n>>8,!0),e+3}},Pn={len:3,get(t,e){const n=Ee(t);return(n.getUint16(e)<<8)+n.getUint8(e+2)},put(t,e,n){const r=Ee(t);return r.setUint16(e,n>>8),r.setUint8(e+2,n&255),e+3}},ne={len:4,get(t,e){return Ee(t).getUint32(e,!0)},put(t,e,n){return Ee(t).setUint32(e,n,!0),e+4}},ue={len:4,get(t,e){return Ee(t).getUint32(e)},put(t,e,n){return Ee(t).setUint32(e,n),e+4}},_u={len:1,get(t,e){return Ee(t).getInt8(e)},put(t,e,n){return Ee(t).setInt8(e,n),e+1}},Gs={len:2,get(t,e){return Ee(t).getInt16(e)},put(t,e,n){return Ee(t).setInt16(e,n),e+2}},ZW={len:2,get(t,e){return Ee(t).getInt16(e,!0)},put(t,e,n){return Ee(t).setInt16(e,n,!0),e+2}},eq={len:3,get(t,e){const n=Lf.get(t,e);return n>8388607?n-16777216:n},put(t,e,n){const r=Ee(t);return r.setUint8(e,n&255),r.setUint16(e+1,n>>8,!0),e+3}},Vw={len:3,get(t,e){const n=Pn.get(t,e);return n>8388607?n-16777216:n},put(t,e,n){const r=Ee(t);return r.setUint16(e,n>>8),r.setUint8(e+2,n&255),e+3}},pr={len:4,get(t,e){return Ee(t).getInt32(e)},put(t,e,n){return Ee(t).setInt32(e,n),e+4}},gt={len:4,get(t,e){return Ee(t).getInt32(e,!0)},put(t,e,n){return Ee(t).setInt32(e,n,!0),e+4}},Cn={len:8,get(t,e){return Ee(t).getBigUint64(e,!0)},put(t,e,n){return Ee(t).setBigUint64(e,n,!0),e+8}},Of={len:8,get(t,e){return Ee(t).getBigInt64(e,!0)},put(t,e,n){return Ee(t).setBigInt64(e,n,!0),e+8}},Uw={len:8,get(t,e){return Ee(t).getBigUint64(e)},put(t,e,n){return Ee(t).setBigUint64(e,n),e+8}},AN={len:8,get(t,e){return Ee(t).getBigInt64(e)},put(t,e,n){return Ee(t).setBigInt64(e,n),e+8}},tq={len:2,get(t,e){return mp(t,e,!1,10,this.len)},put(t,e,n){return pp(t,n,e,!1,10,this.len),e+this.len}},nq={len:2,get(t,e){return mp(t,e,!0,10,this.len)},put(t,e,n){return pp(t,n,e,!0,10,this.len),e+this.len}},PN={len:4,get(t,e){return Ee(t).getFloat32(e)},put(t,e,n){return Ee(t).setFloat32(e,n),e+4}},rq={len:4,get(t,e){return Ee(t).getFloat32(e,!0)},put(t,e,n){return Ee(t).setFloat32(e,n,!0),e+4}},qx={len:8,get(t,e){return Ee(t).getFloat64(e)},put(t,e,n){return Ee(t).setFloat64(e,n),e+8}},sq={len:8,get(t,e){return Ee(t).getFloat64(e,!0)},put(t,e,n){return Ee(t).setFloat64(e,n,!0),e+8}},iq={len:10,get(t,e){return mp(t,e,!1,63,this.len)},put(t,e,n){return pp(t,n,e,!1,63,this.len),e+this.len}},aq={len:10,get(t,e){return mp(t,e,!0,63,this.len)},put(t,e,n){return pp(t,n,e,!0,63,this.len),e+this.len}};class oq{constructor(e){this.len=e}get(e,n){}}class Hn{constructor(e){this.len=e}get(e,n){return e.subarray(n,n+this.len)}}class ae{constructor(e,n){this.len=e,this.encoding=n,this.textDecoder=new TextDecoder(n)}get(e,n){return this.textDecoder.decode(e.subarray(n,n+this.len))}}class lq{constructor(e){this.len=e,this.textDecoder=new TextDecoder("windows-1252")}get(e,n=0){return this.textDecoder.decode(e.subarray(n,n+this.len))}}const cq=Object.freeze(Object.defineProperty({__proto__:null,AnsiStringType:lq,Float16_BE:tq,Float16_LE:nq,Float32_BE:PN,Float32_LE:rq,Float64_BE:qx,Float64_LE:sq,Float80_BE:iq,Float80_LE:aq,INT16_BE:Gs,INT16_LE:ZW,INT24_BE:Vw,INT24_LE:eq,INT32_BE:pr,INT32_LE:gt,INT64_BE:AN,INT64_LE:Of,INT8:_u,IgnoreType:oq,StringType:ae,UINT16_BE:Ge,UINT16_LE:Ve,UINT24_BE:Pn,UINT24_LE:Lf,UINT32_BE:ue,UINT32_LE:ne,UINT64_BE:Uw,UINT64_LE:Cn,UINT8:ke,Uint8ArrayType:Hn},Symbol.toStringTag,{value:"Module"})),uq=Object.prototype.toString,dq="[object Uint8Array]",hq="[object ArrayBuffer]";function FN(t,e,n){return t?t.constructor===e?!0:uq.call(t)===n:!1}function MN(t){return FN(t,Uint8Array,dq)}function fq(t){return FN(t,ArrayBuffer,hq)}function mq(t){return MN(t)||fq(t)}function pq(t){if(!MN(t))throw new TypeError(`Expected \`Uint8Array\`, got \`${typeof t}\``)}function gq(t){if(!mq(t))throw new TypeError(`Expected \`Uint8Array\` or \`ArrayBuffer\`, got \`${typeof t}\``)}const Jd={utf8:new globalThis.TextDecoder("utf8")};function Hw(t,e="utf8"){return gq(t),Jd[e]??(Jd[e]=new globalThis.TextDecoder(e)),Jd[e].decode(t)}function DN(t){if(typeof t!="string")throw new TypeError(`Expected \`string\`, got \`${typeof t}\``)}const xq=new globalThis.TextEncoder;function yq(t){return DN(t),xq.encode(t)}const vq=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Gw(t){pq(t);let e="";for(let n=0;n<t.length;n++)e+=vq[t[n]];return e}const wE={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,a:10,b:11,c:12,d:13,e:14,f:15,A:10,B:11,C:12,D:13,E:14,F:15};function _E(t){if(DN(t),t.length%2!==0)throw new Error("Invalid Hex string length.");const e=t.length/2,n=new Uint8Array(e);for(let r=0;r<e;r++){const s=wE[t[r*2]],i=wE[t[r*2+1]];if(s===void 0||i===void 0)throw new Error(`Invalid Hex character encountered at position ${r*2}`);n[r]=s<<4|i}return n}function SE(t){const{byteLength:e}=t;if(e===6)return t.getUint16(0)*2**32+t.getUint32(2);if(e===5)return t.getUint8(0)*2**32+t.getUint32(1);if(e===4)return t.getUint32(0);if(e===3)return t.getUint8(0)*2**16+t.getUint16(1);if(e===2)return t.getUint16(0);if(e===1)return t.getUint8(0)}function LN(t,e){const n=t.length,r=e.length;if(r===0||r>n)return-1;const s=n-r;for(let i=0;i<=s;i++){let o=!0;for(let l=0;l<r;l++)if(t[i+l]!==e[l]){o=!1;break}if(o)return i}return-1}function wq(t,e){return LN(t,e)!==-1}function _q(t){return[...t].map(e=>e.charCodeAt(0))}function Sq(t,e=0){const n=Number.parseInt(new ae(6).get(t,148).replace(/\0.*$/,"").trim(),8);if(Number.isNaN(n))return!1;let r=8*32;for(let s=e;s<e+148;s++)r+=t[s];for(let s=e+156;s<e+512;s++)r+=t[s];return n===r}const bq={get:(t,e)=>t[e+3]&127|t[e+2]<<7|t[e+1]<<14|t[e]<<21,len:4},Eq=["jpg","png","apng","gif","webp","flif","xcf","cr2","cr3","orf","arw","dng","nef","rw2","raf","tif","bmp","icns","jxr","psd","indd","zip","tar","rar","gz","bz2","7z","dmg","mp4","mid","mkv","webm","mov","avi","mpg","mp2","mp3","m4a","oga","ogg","ogv","opus","flac","wav","spx","amr","pdf","epub","elf","macho","exe","swf","rtf","wasm","woff","woff2","eot","ttf","otf","ico","flv","ps","xz","sqlite","nes","crx","xpi","cab","deb","ar","rpm","Z","lz","cfb","mxf","mts","blend","bpg","docx","pptx","xlsx","3gp","3g2","j2c","jp2","jpm","jpx","mj2","aif","qcp","odt","ods","odp","xml","mobi","heic","cur","ktx","ape","wv","dcm","ics","glb","pcap","dsf","lnk","alias","voc","ac3","m4v","m4p","m4b","f4v","f4p","f4b","f4a","mie","asf","ogm","ogx","mpc","arrow","shp","aac","mp1","it","s3m","xm","ai","skp","avif","eps","lzh","pgp","asar","stl","chm","3mf","zst","jxl","vcf","jls","pst","dwg","parquet","class","arj","cpio","ace","avro","icc","fbx","vsdx"],kq=["image/jpeg","image/png","image/gif","image/webp","image/flif","image/x-xcf","image/x-canon-cr2","image/x-canon-cr3","image/tiff","image/bmp","image/vnd.ms-photo","image/vnd.adobe.photoshop","application/x-indesign","application/epub+zip","application/x-xpinstall","application/vnd.oasis.opendocument.text","application/vnd.oasis.opendocument.spreadsheet","application/vnd.oasis.opendocument.presentation","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/zip","application/x-tar","application/x-rar-compressed","application/gzip","application/x-bzip2","application/x-7z-compressed","application/x-apple-diskimage","application/x-apache-arrow","video/mp4","audio/midi","video/x-matroska","video/webm","video/quicktime","video/vnd.avi","audio/wav","audio/qcelp","audio/x-ms-asf","video/x-ms-asf","application/vnd.ms-asf","video/mpeg","video/3gpp","audio/mpeg","audio/mp4","audio/opus","video/ogg","audio/ogg","application/ogg","audio/x-flac","audio/ape","audio/wavpack","audio/amr","application/pdf","application/x-elf","application/x-mach-binary","application/x-msdownload","application/x-shockwave-flash","application/rtf","application/wasm","font/woff","font/woff2","application/vnd.ms-fontobject","font/ttf","font/otf","image/x-icon","video/x-flv","application/postscript","application/eps","application/x-xz","application/x-sqlite3","application/x-nintendo-nes-rom","application/x-google-chrome-extension","application/vnd.ms-cab-compressed","application/x-deb","application/x-unix-archive","application/x-rpm","application/x-compress","application/x-lzip","application/x-cfb","application/x-mie","application/mxf","video/mp2t","application/x-blender","image/bpg","image/j2c","image/jp2","image/jpx","image/jpm","image/mj2","audio/aiff","application/xml","application/x-mobipocket-ebook","image/heif","image/heif-sequence","image/heic","image/heic-sequence","image/icns","image/ktx","application/dicom","audio/x-musepack","text/calendar","text/vcard","model/gltf-binary","application/vnd.tcpdump.pcap","audio/x-dsf","application/x.ms.shortcut","application/x.apple.alias","audio/x-voc","audio/vnd.dolby.dd-raw","audio/x-m4a","image/apng","image/x-olympus-orf","image/x-sony-arw","image/x-adobe-dng","image/x-nikon-nef","image/x-panasonic-rw2","image/x-fujifilm-raf","video/x-m4v","video/3gpp2","application/x-esri-shape","audio/aac","audio/x-it","audio/x-s3m","audio/x-xm","video/MP1S","video/MP2P","application/vnd.sketchup.skp","image/avif","application/x-lzh-compressed","application/pgp-encrypted","application/x-asar","model/stl","application/vnd.ms-htmlhelp","model/3mf","image/jxl","application/zstd","image/jls","application/vnd.ms-outlook","image/vnd.dwg","application/x-parquet","application/java-vm","application/x-arj","application/x-cpio","application/x-ace-compressed","application/avro","application/vnd.iccprofile","application/x.autodesk.fbx","application/vnd.visio"],bE=4100;async function ON(t){return new jq().fromBuffer(t)}function us(t,e,n){n={offset:0,...n};for(const[r,s]of e.entries())if(n.mask){if(s!==(n.mask[r]&t[r+n.offset]))return!1}else if(s!==t[r+n.offset])return!1;return!0}class jq{constructor(e){this.detectors=e==null?void 0:e.customDetectors,this.fromTokenizer=this.fromTokenizer.bind(this),this.fromBuffer=this.fromBuffer.bind(this),this.parse=this.parse.bind(this)}async fromTokenizer(e){const n=e.position;for(const r of this.detectors||[]){const s=await r(e);if(s)return s;if(n!==e.position)return}return this.parse(e)}async fromBuffer(e){if(!(e instanceof Uint8Array||e instanceof ArrayBuffer))throw new TypeError(`Expected the \`input\` argument to be of type \`Uint8Array\` or \`ArrayBuffer\`, got \`${typeof e}\``);const n=e instanceof Uint8Array?e:new Uint8Array(e);if((n==null?void 0:n.length)>1)return this.fromTokenizer(kl(n))}async fromBlob(e){return this.fromStream(e.stream())}async fromStream(e){const n=await NN(e);try{return await this.fromTokenizer(n)}finally{await n.close()}}async toDetectionStream(e,n){const{sampleSize:r=bE}=n;let s,i;const o=e.getReader({mode:"byob"});try{const{value:u,done:d}=await o.read(new Uint8Array(r));if(i=u,!d&&u)try{s=await this.fromBuffer(u.slice(0,r))}catch(m){if(!(m instanceof vt))throw m;s=void 0}i=u}finally{o.releaseLock()}const l=new TransformStream({async start(u){u.enqueue(i)},transform(u,d){d.enqueue(u)}}),c=e.pipeThrough(l);return c.fileType=s,c}check(e,n){return us(this.buffer,e,n)}checkString(e,n){return this.check(_q(e),n)}async parse(e){if(this.buffer=new Uint8Array(bE),e.fileInfo.size===void 0&&(e.fileInfo.size=Number.MAX_SAFE_INTEGER),this.tokenizer=e,await e.peekBuffer(this.buffer,{length:12,mayBeLess:!0}),this.check([66,77]))return{ext:"bmp",mime:"image/bmp"};if(this.check([11,119]))return{ext:"ac3",mime:"audio/vnd.dolby.dd-raw"};if(this.check([120,1]))return{ext:"dmg",mime:"application/x-apple-diskimage"};if(this.check([77,90]))return{ext:"exe",mime:"application/x-msdownload"};if(this.check([37,33]))return await e.peekBuffer(this.buffer,{length:24,mayBeLess:!0}),this.checkString("PS-Adobe-",{offset:2})&&this.checkString(" EPSF-",{offset:14})?{ext:"eps",mime:"application/eps"}:{ext:"ps",mime:"application/postscript"};if(this.check([31,160])||this.check([31,157]))return{ext:"Z",mime:"application/x-compress"};if(this.check([199,113]))return{ext:"cpio",mime:"application/x-cpio"};if(this.check([96,234]))return{ext:"arj",mime:"application/x-arj"};if(this.check([239,187,191]))return this.tokenizer.ignore(3),this.parse(e);if(this.check([71,73,70]))return{ext:"gif",mime:"image/gif"};if(this.check([73,73,188]))return{ext:"jxr",mime:"image/vnd.ms-photo"};if(this.check([31,139,8]))return{ext:"gz",mime:"application/gzip"};if(this.check([66,90,104]))return{ext:"bz2",mime:"application/x-bzip2"};if(this.checkString("ID3")){await e.ignore(6);const n=await e.readToken(bq);return e.position+n>e.fileInfo.size?{ext:"mp3",mime:"audio/mpeg"}:(await e.ignore(n),this.fromTokenizer(e))}if(this.checkString("MP+"))return{ext:"mpc",mime:"audio/x-musepack"};if((this.buffer[0]===67||this.buffer[0]===70)&&this.check([87,83],{offset:1}))return{ext:"swf",mime:"application/x-shockwave-flash"};if(this.check([255,216,255]))return this.check([247],{offset:3})?{ext:"jls",mime:"image/jls"}:{ext:"jpg",mime:"image/jpeg"};if(this.check([79,98,106,1]))return{ext:"avro",mime:"application/avro"};if(this.checkString("FLIF"))return{ext:"flif",mime:"image/flif"};if(this.checkString("8BPS"))return{ext:"psd",mime:"image/vnd.adobe.photoshop"};if(this.checkString("WEBP",{offset:8}))return{ext:"webp",mime:"image/webp"};if(this.checkString("MPCK"))return{ext:"mpc",mime:"audio/x-musepack"};if(this.checkString("FORM"))return{ext:"aif",mime:"audio/aiff"};if(this.checkString("icns",{offset:0}))return{ext:"icns",mime:"image/icns"};if(this.check([80,75,3,4])){try{for(;e.position+30<e.fileInfo.size;){await e.readBuffer(this.buffer,{length:30});const n=new DataView(this.buffer.buffer),r={compressedSize:n.getUint32(18,!0),uncompressedSize:n.getUint32(22,!0),filenameLength:n.getUint16(26,!0),extraFieldLength:n.getUint16(28,!0)};if(r.filename=await e.readToken(new ae(r.filenameLength,"utf-8")),await e.ignore(r.extraFieldLength),r.filename==="META-INF/mozilla.rsa")return{ext:"xpi",mime:"application/x-xpinstall"};if(r.filename.endsWith(".rels")||r.filename.endsWith(".xml"))switch(r.filename.split("/")[0]){case"_rels":break;case"word":return{ext:"docx",mime:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"};case"ppt":return{ext:"pptx",mime:"application/vnd.openxmlformats-officedocument.presentationml.presentation"};case"xl":return{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"};case"visio":return{ext:"vsdx",mime:"application/vnd.visio"};default:break}if(r.filename.startsWith("xl/"))return{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"};if(r.filename.startsWith("3D/")&&r.filename.endsWith(".model"))return{ext:"3mf",mime:"model/3mf"};if(r.filename==="mimetype"&&r.compressedSize===r.uncompressedSize){let s=await e.readToken(new ae(r.compressedSize,"utf-8"));switch(s=s.trim(),s){case"application/epub+zip":return{ext:"epub",mime:"application/epub+zip"};case"application/vnd.oasis.opendocument.text":return{ext:"odt",mime:"application/vnd.oasis.opendocument.text"};case"application/vnd.oasis.opendocument.spreadsheet":return{ext:"ods",mime:"application/vnd.oasis.opendocument.spreadsheet"};case"application/vnd.oasis.opendocument.presentation":return{ext:"odp",mime:"application/vnd.oasis.opendocument.presentation"};default:}}if(r.compressedSize===0){let s=-1;for(;s<0&&e.position<e.fileInfo.size;)await e.peekBuffer(this.buffer,{mayBeLess:!0}),s=LN(this.buffer,new Uint8Array([80,75,3,4])),await e.ignore(s>=0?s:this.buffer.length)}else await e.ignore(r.compressedSize)}}catch(n){if(!(n instanceof vt))throw n}return{ext:"zip",mime:"application/zip"}}if(this.checkString("OggS")){await e.ignore(28);const n=new Uint8Array(8);return await e.readBuffer(n),us(n,[79,112,117,115,72,101,97,100])?{ext:"opus",mime:"audio/opus"}:us(n,[128,116,104,101,111,114,97])?{ext:"ogv",mime:"video/ogg"}:us(n,[1,118,105,100,101,111,0])?{ext:"ogm",mime:"video/ogg"}:us(n,[127,70,76,65,67])?{ext:"oga",mime:"audio/ogg"}:us(n,[83,112,101,101,120,32,32])?{ext:"spx",mime:"audio/ogg"}:us(n,[1,118,111,114,98,105,115])?{ext:"ogg",mime:"audio/ogg"}:{ext:"ogx",mime:"application/ogg"}}if(this.check([80,75])&&(this.buffer[2]===3||this.buffer[2]===5||this.buffer[2]===7)&&(this.buffer[3]===4||this.buffer[3]===6||this.buffer[3]===8))return{ext:"zip",mime:"application/zip"};if(this.checkString("ftyp",{offset:4})&&this.buffer[8]&96){const n=new ae(4,"latin1").get(this.buffer,8).replace("\0"," ").trim();switch(n){case"avif":case"avis":return{ext:"avif",mime:"image/avif"};case"mif1":return{ext:"heic",mime:"image/heif"};case"msf1":return{ext:"heic",mime:"image/heif-sequence"};case"heic":case"heix":return{ext:"heic",mime:"image/heic"};case"hevc":case"hevx":return{ext:"heic",mime:"image/heic-sequence"};case"qt":return{ext:"mov",mime:"video/quicktime"};case"M4V":case"M4VH":case"M4VP":return{ext:"m4v",mime:"video/x-m4v"};case"M4P":return{ext:"m4p",mime:"video/mp4"};case"M4B":return{ext:"m4b",mime:"audio/mp4"};case"M4A":return{ext:"m4a",mime:"audio/x-m4a"};case"F4V":return{ext:"f4v",mime:"video/mp4"};case"F4P":return{ext:"f4p",mime:"video/mp4"};case"F4A":return{ext:"f4a",mime:"audio/mp4"};case"F4B":return{ext:"f4b",mime:"audio/mp4"};case"crx":return{ext:"cr3",mime:"image/x-canon-cr3"};default:return n.startsWith("3g")?n.startsWith("3g2")?{ext:"3g2",mime:"video/3gpp2"}:{ext:"3gp",mime:"video/3gpp"}:{ext:"mp4",mime:"video/mp4"}}}if(this.checkString("MThd"))return{ext:"mid",mime:"audio/midi"};if(this.checkString("wOFF")&&(this.check([0,1,0,0],{offset:4})||this.checkString("OTTO",{offset:4})))return{ext:"woff",mime:"font/woff"};if(this.checkString("wOF2")&&(this.check([0,1,0,0],{offset:4})||this.checkString("OTTO",{offset:4})))return{ext:"woff2",mime:"font/woff2"};if(this.check([212,195,178,161])||this.check([161,178,195,212]))return{ext:"pcap",mime:"application/vnd.tcpdump.pcap"};if(this.checkString("DSD "))return{ext:"dsf",mime:"audio/x-dsf"};if(this.checkString("LZIP"))return{ext:"lz",mime:"application/x-lzip"};if(this.checkString("fLaC"))return{ext:"flac",mime:"audio/x-flac"};if(this.check([66,80,71,251]))return{ext:"bpg",mime:"image/bpg"};if(this.checkString("wvpk"))return{ext:"wv",mime:"audio/wavpack"};if(this.checkString("%PDF")){try{await e.ignore(1350);const n=10*1024*1024,r=new Uint8Array(Math.min(n,e.fileInfo.size));if(await e.readBuffer(r,{mayBeLess:!0}),wq(r,new TextEncoder().encode("AIPrivateData")))return{ext:"ai",mime:"application/postscript"}}catch(n){if(!(n instanceof vt))throw n}return{ext:"pdf",mime:"application/pdf"}}if(this.check([0,97,115,109]))return{ext:"wasm",mime:"application/wasm"};if(this.check([73,73])){const n=await this.readTiffHeader(!1);if(n)return n}if(this.check([77,77])){const n=await this.readTiffHeader(!0);if(n)return n}if(this.checkString("MAC "))return{ext:"ape",mime:"audio/ape"};if(this.check([26,69,223,163])){async function n(){const l=await e.peekNumber(ke);let c=128,u=0;for(;!(l&c)&&c!==0;)++u,c>>=1;const d=new Uint8Array(u+1);return await e.readBuffer(d),d}async function r(){const l=await n(),c=await n();c[0]^=128>>c.length-1;const u=Math.min(6,c.length),d=new DataView(l.buffer),m=new DataView(c.buffer,c.length-u,u);return{id:SE(d),len:SE(m)}}async function s(l){for(;l>0;){const c=await r();if(c.id===17026)return(await e.readToken(new ae(c.len))).replaceAll(/\00.*$/g,"");await e.ignore(c.len),--l}}const i=await r();switch(await s(i.len)){case"webm":return{ext:"webm",mime:"video/webm"};case"matroska":return{ext:"mkv",mime:"video/x-matroska"};default:return}}if(this.check([82,73,70,70])){if(this.check([65,86,73],{offset:8}))return{ext:"avi",mime:"video/vnd.avi"};if(this.check([87,65,86,69],{offset:8}))return{ext:"wav",mime:"audio/wav"};if(this.check([81,76,67,77],{offset:8}))return{ext:"qcp",mime:"audio/qcelp"}}if(this.checkString("SQLi"))return{ext:"sqlite",mime:"application/x-sqlite3"};if(this.check([78,69,83,26]))return{ext:"nes",mime:"application/x-nintendo-nes-rom"};if(this.checkString("Cr24"))return{ext:"crx",mime:"application/x-google-chrome-extension"};if(this.checkString("MSCF")||this.checkString("ISc("))return{ext:"cab",mime:"application/vnd.ms-cab-compressed"};if(this.check([237,171,238,219]))return{ext:"rpm",mime:"application/x-rpm"};if(this.check([197,208,211,198]))return{ext:"eps",mime:"application/eps"};if(this.check([40,181,47,253]))return{ext:"zst",mime:"application/zstd"};if(this.check([127,69,76,70]))return{ext:"elf",mime:"application/x-elf"};if(this.check([33,66,68,78]))return{ext:"pst",mime:"application/vnd.ms-outlook"};if(this.checkString("PAR1"))return{ext:"parquet",mime:"application/x-parquet"};if(this.check([207,250,237,254]))return{ext:"macho",mime:"application/x-mach-binary"};if(this.check([79,84,84,79,0]))return{ext:"otf",mime:"font/otf"};if(this.checkString("#!AMR"))return{ext:"amr",mime:"audio/amr"};if(this.checkString("{\\rtf"))return{ext:"rtf",mime:"application/rtf"};if(this.check([70,76,86,1]))return{ext:"flv",mime:"video/x-flv"};if(this.checkString("IMPM"))return{ext:"it",mime:"audio/x-it"};if(this.checkString("-lh0-",{offset:2})||this.checkString("-lh1-",{offset:2})||this.checkString("-lh2-",{offset:2})||this.checkString("-lh3-",{offset:2})||this.checkString("-lh4-",{offset:2})||this.checkString("-lh5-",{offset:2})||this.checkString("-lh6-",{offset:2})||this.checkString("-lh7-",{offset:2})||this.checkString("-lzs-",{offset:2})||this.checkString("-lz4-",{offset:2})||this.checkString("-lz5-",{offset:2})||this.checkString("-lhd-",{offset:2}))return{ext:"lzh",mime:"application/x-lzh-compressed"};if(this.check([0,0,1,186])){if(this.check([33],{offset:4,mask:[241]}))return{ext:"mpg",mime:"video/MP1S"};if(this.check([68],{offset:4,mask:[196]}))return{ext:"mpg",mime:"video/MP2P"}}if(this.checkString("ITSF"))return{ext:"chm",mime:"application/vnd.ms-htmlhelp"};if(this.check([202,254,186,190]))return{ext:"class",mime:"application/java-vm"};if(this.check([253,55,122,88,90,0]))return{ext:"xz",mime:"application/x-xz"};if(this.checkString("<?xml "))return{ext:"xml",mime:"application/xml"};if(this.check([55,122,188,175,39,28]))return{ext:"7z",mime:"application/x-7z-compressed"};if(this.check([82,97,114,33,26,7])&&(this.buffer[6]===0||this.buffer[6]===1))return{ext:"rar",mime:"application/x-rar-compressed"};if(this.checkString("solid "))return{ext:"stl",mime:"model/stl"};if(this.checkString("AC")){const n=new ae(4,"latin1").get(this.buffer,2);if(n.match("^d*")&&n>=1e3&&n<=1050)return{ext:"dwg",mime:"image/vnd.dwg"}}if(this.checkString("070707"))return{ext:"cpio",mime:"application/x-cpio"};if(this.checkString("BLENDER"))return{ext:"blend",mime:"application/x-blender"};if(this.checkString("!<arch>"))return await e.ignore(8),await e.readToken(new ae(13,"ascii"))==="debian-binary"?{ext:"deb",mime:"application/x-deb"}:{ext:"ar",mime:"application/x-unix-archive"};if(this.checkString("**ACE",{offset:7})&&(await e.peekBuffer(this.buffer,{length:14,mayBeLess:!0}),this.checkString("**",{offset:12})))return{ext:"ace",mime:"application/x-ace-compressed"};if(this.check([137,80,78,71,13,10,26,10])){await e.ignore(8);async function n(){return{length:await e.readToken(pr),type:await e.readToken(new ae(4,"latin1"))}}do{const r=await n();if(r.length<0)return;switch(r.type){case"IDAT":return{ext:"png",mime:"image/png"};case"acTL":return{ext:"apng",mime:"image/apng"};default:await e.ignore(r.length+4)}}while(e.position+8<e.fileInfo.size);return{ext:"png",mime:"image/png"}}if(this.check([65,82,82,79,87,49,0,0]))return{ext:"arrow",mime:"application/x-apache-arrow"};if(this.check([103,108,84,70,2,0,0,0]))return{ext:"glb",mime:"model/gltf-binary"};if(this.check([102,114,101,101],{offset:4})||this.check([109,100,97,116],{offset:4})||this.check([109,111,111,118],{offset:4})||this.check([119,105,100,101],{offset:4}))return{ext:"mov",mime:"video/quicktime"};if(this.check([73,73,82,79,8,0,0,0,24]))return{ext:"orf",mime:"image/x-olympus-orf"};if(this.checkString("gimp xcf "))return{ext:"xcf",mime:"image/x-xcf"};if(this.check([73,73,85,0,24,0,0,0,136,231,116,216]))return{ext:"rw2",mime:"image/x-panasonic-rw2"};if(this.check([48,38,178,117,142,102,207,17,166,217])){async function n(){const r=new Uint8Array(16);return await e.readBuffer(r),{id:r,size:Number(await e.readToken(Cn))}}for(await e.ignore(30);e.position+24<e.fileInfo.size;){const r=await n();let s=r.size-24;if(us(r.id,[145,7,220,183,183,169,207,17,142,230,0,192,12,32,83,101])){const i=new Uint8Array(16);if(s-=await e.readBuffer(i),us(i,[64,158,105,248,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"audio/x-ms-asf"};if(us(i,[192,239,25,188,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"video/x-ms-asf"};break}await e.ignore(s)}return{ext:"asf",mime:"application/vnd.ms-asf"}}if(this.check([171,75,84,88,32,49,49,187,13,10,26,10]))return{ext:"ktx",mime:"image/ktx"};if((this.check([126,16,4])||this.check([126,24,4]))&&this.check([48,77,73,69],{offset:4}))return{ext:"mie",mime:"application/x-mie"};if(this.check([39,10,0,0,0,0,0,0,0,0,0,0],{offset:2}))return{ext:"shp",mime:"application/x-esri-shape"};if(this.check([255,79,255,81]))return{ext:"j2c",mime:"image/j2c"};if(this.check([0,0,0,12,106,80,32,32,13,10,135,10]))switch(await e.ignore(20),await e.readToken(new ae(4,"ascii"))){case"jp2 ":return{ext:"jp2",mime:"image/jp2"};case"jpx ":return{ext:"jpx",mime:"image/jpx"};case"jpm ":return{ext:"jpm",mime:"image/jpm"};case"mjp2":return{ext:"mj2",mime:"image/mj2"};default:return}if(this.check([255,10])||this.check([0,0,0,12,74,88,76,32,13,10,135,10]))return{ext:"jxl",mime:"image/jxl"};if(this.check([254,255]))return this.check([0,60,0,63,0,120,0,109,0,108],{offset:2})?{ext:"xml",mime:"application/xml"}:void 0;if(this.check([0,0,1,186])||this.check([0,0,1,179]))return{ext:"mpg",mime:"video/mpeg"};if(this.check([0,1,0,0,0]))return{ext:"ttf",mime:"font/ttf"};if(this.check([0,0,1,0]))return{ext:"ico",mime:"image/x-icon"};if(this.check([0,0,2,0]))return{ext:"cur",mime:"image/x-icon"};if(this.check([208,207,17,224,161,177,26,225]))return{ext:"cfb",mime:"application/x-cfb"};if(await e.peekBuffer(this.buffer,{length:Math.min(256,e.fileInfo.size),mayBeLess:!0}),this.check([97,99,115,112],{offset:36}))return{ext:"icc",mime:"application/vnd.iccprofile"};if(this.checkString("BEGIN:")){if(this.checkString("VCARD",{offset:6}))return{ext:"vcf",mime:"text/vcard"};if(this.checkString("VCALENDAR",{offset:6}))return{ext:"ics",mime:"text/calendar"}}if(this.checkString("FUJIFILMCCD-RAW"))return{ext:"raf",mime:"image/x-fujifilm-raf"};if(this.checkString("Extended Module:"))return{ext:"xm",mime:"audio/x-xm"};if(this.checkString("Creative Voice File"))return{ext:"voc",mime:"audio/x-voc"};if(this.check([4,0,0,0])&&this.buffer.length>=16){const n=new DataView(this.buffer.buffer).getUint32(12,!0);if(n>12&&this.buffer.length>=n+16)try{const r=new TextDecoder().decode(this.buffer.slice(16,n+16));if(JSON.parse(r).files)return{ext:"asar",mime:"application/x-asar"}}catch{}}if(this.check([6,14,43,52,2,5,1,1,13,1,2,1,1,2]))return{ext:"mxf",mime:"application/mxf"};if(this.checkString("SCRM",{offset:44}))return{ext:"s3m",mime:"audio/x-s3m"};if(this.check([71])&&this.check([71],{offset:188}))return{ext:"mts",mime:"video/mp2t"};if(this.check([71],{offset:4})&&this.check([71],{offset:196}))return{ext:"mts",mime:"video/mp2t"};if(this.check([66,79,79,75,77,79,66,73],{offset:60}))return{ext:"mobi",mime:"application/x-mobipocket-ebook"};if(this.check([68,73,67,77],{offset:128}))return{ext:"dcm",mime:"application/dicom"};if(this.check([76,0,0,0,1,20,2,0,0,0,0,0,192,0,0,0,0,0,0,70]))return{ext:"lnk",mime:"application/x.ms.shortcut"};if(this.check([98,111,111,107,0,0,0,0,109,97,114,107,0,0,0,0]))return{ext:"alias",mime:"application/x.apple.alias"};if(this.checkString("Kaydara FBX Binary  \0"))return{ext:"fbx",mime:"application/x.autodesk.fbx"};if(this.check([76,80],{offset:34})&&(this.check([0,0,1],{offset:8})||this.check([1,0,2],{offset:8})||this.check([2,0,2],{offset:8})))return{ext:"eot",mime:"application/vnd.ms-fontobject"};if(this.check([6,6,237,245,216,29,70,229,189,49,239,231,254,116,183,29]))return{ext:"indd",mime:"application/x-indesign"};if(await e.peekBuffer(this.buffer,{length:Math.min(512,e.fileInfo.size),mayBeLess:!0}),Sq(this.buffer))return{ext:"tar",mime:"application/x-tar"};if(this.check([255,254]))return this.check([60,0,63,0,120,0,109,0,108,0],{offset:2})?{ext:"xml",mime:"application/xml"}:this.check([255,14,83,0,107,0,101,0,116,0,99,0,104,0,85,0,112,0,32,0,77,0,111,0,100,0,101,0,108,0],{offset:2})?{ext:"skp",mime:"application/vnd.sketchup.skp"}:void 0;if(this.checkString("-----BEGIN PGP MESSAGE-----"))return{ext:"pgp",mime:"application/pgp-encrypted"};if(this.buffer.length>=2&&this.check([255,224],{offset:0,mask:[255,224]})){if(this.check([16],{offset:1,mask:[22]}))return this.check([8],{offset:1,mask:[8]})?{ext:"aac",mime:"audio/aac"}:{ext:"aac",mime:"audio/aac"};if(this.check([2],{offset:1,mask:[6]}))return{ext:"mp3",mime:"audio/mpeg"};if(this.check([4],{offset:1,mask:[6]}))return{ext:"mp2",mime:"audio/mpeg"};if(this.check([6],{offset:1,mask:[6]}))return{ext:"mp1",mime:"audio/mpeg"}}}async readTiffTag(e){const n=await this.tokenizer.readToken(e?Ge:Ve);switch(this.tokenizer.ignore(10),n){case 50341:return{ext:"arw",mime:"image/x-sony-arw"};case 50706:return{ext:"dng",mime:"image/x-adobe-dng"}}}async readTiffIFD(e){const n=await this.tokenizer.readToken(e?Ge:Ve);for(let r=0;r<n;++r){const s=await this.readTiffTag(e);if(s)return s}}async readTiffHeader(e){const n=(e?Ge:Ve).get(this.buffer,2),r=(e?ue:ne).get(this.buffer,4);if(n===42){if(r>=6){if(this.checkString("CR",{offset:8}))return{ext:"cr2",mime:"image/x-canon-cr2"};if(r>=8&&(this.check([28,0,254,0],{offset:8})||this.check([31,0,11,0],{offset:8})))return{ext:"nef",mime:"image/x-nikon-nef"}}return await this.tokenizer.ignore(r),await this.readTiffIFD(e)??{ext:"tif",mime:"image/tiff"}}if(n===43)return{ext:"tif",mime:"image/tiff"}}}new Set(Eq);new Set(kq);var Ww={};/*!
 * content-type
 * Copyright(c) 2015 Douglas Christopher Wilson
 * MIT Licensed
 */var EE=/; *([!#$%&'*+.^_`|~0-9A-Za-z-]+) *= *("(?:[\u000b\u0020\u0021\u0023-\u005b\u005d-\u007e\u0080-\u00ff]|\\[\u000b\u0020-\u00ff])*"|[!#$%&'*+.^_`|~0-9A-Za-z-]+) */g,Tq=/^[\u000b\u0020-\u007e\u0080-\u00ff]+$/,$N=/^[!#$%&'*+.^_`|~0-9A-Za-z-]+$/,Iq=/\\([\u000b\u0020-\u00ff])/g,Cq=/([\\"])/g,zN=/^[!#$%&'*+.^_`|~0-9A-Za-z-]+\/[!#$%&'*+.^_`|~0-9A-Za-z-]+$/;Ww.format=Rq;Ww.parse=Nq;function Rq(t){if(!t||typeof t!="object")throw new TypeError("argument obj is required");var e=t.parameters,n=t.type;if(!n||!zN.test(n))throw new TypeError("invalid type");var r=n;if(e&&typeof e=="object")for(var s,i=Object.keys(e).sort(),o=0;o<i.length;o++){if(s=i[o],!$N.test(s))throw new TypeError("invalid parameter name");r+="; "+s+"="+Pq(e[s])}return r}function Nq(t){if(!t)throw new TypeError("argument string is required");var e=typeof t=="object"?Aq(t):t;if(typeof e!="string")throw new TypeError("argument string is required to be a string");var n=e.indexOf(";"),r=n!==-1?e.slice(0,n).trim():e.trim();if(!zN.test(r))throw new TypeError("invalid media type");var s=new Fq(r.toLowerCase());if(n!==-1){var i,o,l;for(EE.lastIndex=n;o=EE.exec(e);){if(o.index!==n)throw new TypeError("invalid parameter format");n+=o[0].length,i=o[1].toLowerCase(),l=o[2],l.charCodeAt(0)===34&&(l=l.slice(1,-1),l.indexOf("\\")!==-1&&(l=l.replace(Iq,"$1"))),s.parameters[i]=l}if(n!==e.length)throw new TypeError("invalid parameter format")}return s}function Aq(t){var e;if(typeof t.getHeader=="function"?e=t.getHeader("content-type"):typeof t.headers=="object"&&(e=t.headers&&t.headers["content-type"]),typeof e!="string")throw new TypeError("content-type header is missing from object");return e}function Pq(t){var e=String(t);if($N.test(e))return e;if(e.length>0&&!Tq.test(e))throw new TypeError("invalid parameter value");return'"'+e.replace(Cq,"\\$1")+'"'}function Fq(t){this.parameters=Object.create(null),this.type=t}/*!
 * media-typer
 * Copyright(c) 2014-2017 Douglas Christopher Wilson
 * MIT Licensed
 */var Mq=/^ *([A-Za-z0-9][A-Za-z0-9!#$&^_-]{0,126})\/([A-Za-z0-9][A-Za-z0-9!#$&^_.+-]{0,126}) *$/,Dq=Lq;function Lq(t){if(!t)throw new TypeError("argument string is required");if(typeof t!="string")throw new TypeError("argument string is required to be a string");var e=Mq.exec(t.toLowerCase());if(!e)throw new TypeError("invalid media type");var n=e[1],r=e[2],s,i=r.lastIndexOf("+");return i!==-1&&(s=r.substr(i+1),r=r.substr(0,i)),new Oq(n,r,s)}function Oq(t,e,n){this.type=t,this.subtype=e,this.suffix=n}var Kx={exports:{}},Hg,kE;function $q(){if(kE)return Hg;kE=1;var t=1e3,e=t*60,n=e*60,r=n*24,s=r*7,i=r*365.25;Hg=function(d,m){m=m||{};var p=typeof d;if(p==="string"&&d.length>0)return o(d);if(p==="number"&&isFinite(d))return m.long?c(d):l(d);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(d))};function o(d){if(d=String(d),!(d.length>100)){var m=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(d);if(m){var p=parseFloat(m[1]),g=(m[2]||"ms").toLowerCase();switch(g){case"years":case"year":case"yrs":case"yr":case"y":return p*i;case"weeks":case"week":case"w":return p*s;case"days":case"day":case"d":return p*r;case"hours":case"hour":case"hrs":case"hr":case"h":return p*n;case"minutes":case"minute":case"mins":case"min":case"m":return p*e;case"seconds":case"second":case"secs":case"sec":case"s":return p*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return p;default:return}}}}function l(d){var m=Math.abs(d);return m>=r?Math.round(d/r)+"d":m>=n?Math.round(d/n)+"h":m>=e?Math.round(d/e)+"m":m>=t?Math.round(d/t)+"s":d+"ms"}function c(d){var m=Math.abs(d);return m>=r?u(d,m,r,"day"):m>=n?u(d,m,n,"hour"):m>=e?u(d,m,e,"minute"):m>=t?u(d,m,t,"second"):d+" ms"}function u(d,m,p,g){var x=m>=p*1.5;return Math.round(d/p)+" "+g+(x?"s":"")}return Hg}function zq(t){n.debug=n,n.default=n,n.coerce=c,n.disable=i,n.enable=s,n.enabled=o,n.humanize=$q(),n.destroy=u,Object.keys(t).forEach(d=>{n[d]=t[d]}),n.names=[],n.skips=[],n.formatters={};function e(d){let m=0;for(let p=0;p<d.length;p++)m=(m<<5)-m+d.charCodeAt(p),m|=0;return n.colors[Math.abs(m)%n.colors.length]}n.selectColor=e;function n(d){let m,p=null,g,x;function w(...v){if(!w.enabled)return;const S=w,_=Number(new Date),E=_-(m||_);S.diff=E,S.prev=m,S.curr=_,m=_,v[0]=n.coerce(v[0]),typeof v[0]!="string"&&v.unshift("%O");let I=0;v[0]=v[0].replace(/%([a-zA-Z%])/g,(F,j)=>{if(F==="%%")return"%";I++;const k=n.formatters[j];if(typeof k=="function"){const C=v[I];F=k.call(S,C),v.splice(I,1),I--}return F}),n.formatArgs.call(S,v),(S.log||n.log).apply(S,v)}return w.namespace=d,w.useColors=n.useColors(),w.color=n.selectColor(d),w.extend=r,w.destroy=n.destroy,Object.defineProperty(w,"enabled",{enumerable:!0,configurable:!1,get:()=>p!==null?p:(g!==n.namespaces&&(g=n.namespaces,x=n.enabled(d)),x),set:v=>{p=v}}),typeof n.init=="function"&&n.init(w),w}function r(d,m){const p=n(this.namespace+(typeof m>"u"?":":m)+d);return p.log=this.log,p}function s(d){n.save(d),n.namespaces=d,n.names=[],n.skips=[];let m;const p=(typeof d=="string"?d:"").split(/[\s,]+/),g=p.length;for(m=0;m<g;m++)p[m]&&(d=p[m].replace(/\*/g,".*?"),d[0]==="-"?n.skips.push(new RegExp("^"+d.slice(1)+"$")):n.names.push(new RegExp("^"+d+"$")))}function i(){const d=[...n.names.map(l),...n.skips.map(l).map(m=>"-"+m)].join(",");return n.enable(""),d}function o(d){if(d[d.length-1]==="*")return!0;let m,p;for(m=0,p=n.skips.length;m<p;m++)if(n.skips[m].test(d))return!1;for(m=0,p=n.names.length;m<p;m++)if(n.names[m].test(d))return!0;return!1}function l(d){return d.toString().substring(2,d.toString().length-2).replace(/\.\*\?$/,"*")}function c(d){return d instanceof Error?d.stack||d.message:d}function u(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return n.enable(n.load()),n}var Bq=zq;(function(t,e){e.formatArgs=r,e.save=s,e.load=i,e.useColors=n,e.storage=o(),e.destroy=(()=>{let c=!1;return()=>{c||(c=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function n(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function r(c){if(c[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+c[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;const u="color: "+this.color;c.splice(1,0,u,"color: inherit");let d=0,m=0;c[0].replace(/%[a-zA-Z%]/g,p=>{p!=="%%"&&(d++,p==="%c"&&(m=d))}),c.splice(m,0,u)}e.log=console.debug||console.log||(()=>{});function s(c){try{c?e.storage.setItem("debug",c):e.storage.removeItem("debug")}catch{}}function i(){let c;try{c=e.storage.getItem("debug")}catch{}return!c&&typeof process<"u"&&"env"in process&&(c={}.DEBUG),c}function o(){try{return localStorage}catch{}}t.exports=Bq(e);const{formatters:l}=t.exports;l.j=function(c){try{return JSON.stringify(c)}catch(u){return"[UnexpectedJSONParseError]: "+u.message}}})(Kx,Kx.exports);var Vq=Kx.exports;const Ke=f2(Vq);var Qx;(function(t){t[t.shot=10]="shot",t[t.scene=20]="scene",t[t.track=30]="track",t[t.part=40]="part",t[t.album=50]="album",t[t.edition=60]="edition",t[t.collection=70]="collection"})(Qx||(Qx={}));var Za;(function(t){t[t.video=1]="video",t[t.audio=2]="audio",t[t.complex=3]="complex",t[t.logo=4]="logo",t[t.subtitle=17]="subtitle",t[t.button=18]="button",t[t.control=32]="control"})(Za||(Za={}));function ft(t,e,n){return(t[e]&1<<n)!==0}function sr(t,e,n,r){let s=e;if(r==="utf-16le"){for(;t[s]!==0||t[s+1]!==0;){if(s>=n)return n;s+=2}return s}for(;t[s]!==0;){if(s>=n)return n;s++}return s}function BN(t){const e=t.indexOf("\0");return e===-1?t:t.substr(0,e)}function Uq(t){const e=t.length;if(e&1)throw new Error("Buffer length must be even");for(let n=0;n<e;n+=2){const r=t[n];t[n]=t[n+1],t[n+1]=r}return t}function At(t,e){if(t[0]===255&&t[1]===254)return At(t.subarray(2),e);if(e==="utf-16le"&&t[0]===254&&t[1]===255){if(t.length&1)throw new Error("Expected even number of octets for 16-bit unicode string");return At(Uq(t),e)}return new ae(t.length,e).get(t,0)}function Ni(t){return t=t.replace(/^\x00+/g,""),t=t.replace(/\x00+$/g,""),t}function Fe(t,e,n,r){const s=e+~~(n/8),i=n%8;let o=t[s];o&=255>>i;const l=8-i,c=r-l;return c<0?o>>=8-i-r:c>0&&(o<<=c,o|=Fe(t,e,n+l,c)),o}function cr(t,e,n){return Fe(t,e,n,1)===1}function Hq(t){const e=[];for(let n=0,r=t.length;n<r;n++){const s=Number(t.charCodeAt(n)).toString(16);e.push(s.length===1?`0${s}`:s)}return e.join(" ")}function Gq(t){return 10*Math.log10(t)}function Wq(t){return 10**(t/10)}function qq(t){const e=t.split(" ").map(n=>n.trim().toLowerCase());if(e.length>=1){const n=Number.parseFloat(e[0]);return e.length===2&&e[1]==="db"?{dB:n,ratio:Wq(n)}:{dB:Gq(n),ratio:n}}}var Su;(function(t){t[t.Other=0]="Other",t[t["32x32 pixels 'file icon' (PNG only)"]=1]="32x32 pixels 'file icon' (PNG only)",t[t["Other file icon"]=2]="Other file icon",t[t["Cover (front)"]=3]="Cover (front)",t[t["Cover (back)"]=4]="Cover (back)",t[t["Leaflet page"]=5]="Leaflet page",t[t["Media (e.g. label side of CD)"]=6]="Media (e.g. label side of CD)",t[t["Lead artist/lead performer/soloist"]=7]="Lead artist/lead performer/soloist",t[t["Artist/performer"]=8]="Artist/performer",t[t.Conductor=9]="Conductor",t[t["Band/Orchestra"]=10]="Band/Orchestra",t[t.Composer=11]="Composer",t[t["Lyricist/text writer"]=12]="Lyricist/text writer",t[t["Recording Location"]=13]="Recording Location",t[t["During recording"]=14]="During recording",t[t["During performance"]=15]="During performance",t[t["Movie/video screen capture"]=16]="Movie/video screen capture",t[t["A bright coloured fish"]=17]="A bright coloured fish",t[t.Illustration=18]="Illustration",t[t["Band/artist logotype"]=19]="Band/artist logotype",t[t["Publisher/Studio logotype"]=20]="Publisher/Studio logotype"})(Su||(Su={}));var jE;(function(t){t[t.other=0]="other",t[t.lyrics=1]="lyrics",t[t.text=2]="text",t[t.movement_part=3]="movement_part",t[t.events=4]="events",t[t.chord=5]="chord",t[t.trivia_pop=6]="trivia_pop"})(jE||(jE={}));var TE;(function(t){t[t.notSynchronized0=0]="notSynchronized0",t[t.mpegFrameNumber=1]="mpegFrameNumber",t[t.milliseconds=2]="milliseconds"})(TE||(TE={}));const VN={get:(t,e)=>t[e+3]&127|t[e+2]<<7|t[e+1]<<14|t[e]<<21,len:4},Xx={len:10,get:(t,e)=>({fileIdentifier:new ae(3,"ascii").get(t,e),version:{major:_u.get(t,e+3),revision:_u.get(t,e+4)},flags:{unsynchronisation:ft(t,e+5,7),isExtendedHeader:ft(t,e+5,6),expIndicator:ft(t,e+5,5),footer:ft(t,e+5,4)},size:VN.get(t,e+6)})},IE={len:10,get:(t,e)=>({size:ue.get(t,e),extendedFlags:Ge.get(t,e+4),sizeOfPadding:ue.get(t,e+6),crcDataPresent:ft(t,e+4,31)})},UN={len:1,get:(t,e)=>{switch(t[e]){case 0:return{encoding:"latin1"};case 1:return{encoding:"utf-16le",bom:!0};case 2:return{encoding:"utf-16le",bom:!1};case 3:return{encoding:"utf8",bom:!1};default:return{encoding:"utf8",bom:!1}}}},Yx={len:4,get:(t,e)=>({encoding:UN.get(t,e),language:new ae(3,"latin1").get(t,e+1)})},CE={len:6,get:(t,e)=>{const n=Yx.get(t,e);return{encoding:n.encoding,language:n.language,timeStampFormat:ke.get(t,e+4),contentType:ke.get(t,e+5)}}},$f={year:{multiple:!1},track:{multiple:!1},disk:{multiple:!1},title:{multiple:!1},artist:{multiple:!1},artists:{multiple:!0,unique:!0},albumartist:{multiple:!1},album:{multiple:!1},date:{multiple:!1},originaldate:{multiple:!1},originalyear:{multiple:!1},releasedate:{multiple:!1},comment:{multiple:!0,unique:!1},genre:{multiple:!0,unique:!0},picture:{multiple:!0,unique:!0},composer:{multiple:!0,unique:!0},lyrics:{multiple:!0,unique:!1},albumsort:{multiple:!1,unique:!0},titlesort:{multiple:!1,unique:!0},work:{multiple:!1,unique:!0},artistsort:{multiple:!1,unique:!0},albumartistsort:{multiple:!1,unique:!0},composersort:{multiple:!1,unique:!0},lyricist:{multiple:!0,unique:!0},writer:{multiple:!0,unique:!0},conductor:{multiple:!0,unique:!0},remixer:{multiple:!0,unique:!0},arranger:{multiple:!0,unique:!0},engineer:{multiple:!0,unique:!0},producer:{multiple:!0,unique:!0},technician:{multiple:!0,unique:!0},djmixer:{multiple:!0,unique:!0},mixer:{multiple:!0,unique:!0},label:{multiple:!0,unique:!0},grouping:{multiple:!1},subtitle:{multiple:!0},discsubtitle:{multiple:!1},totaltracks:{multiple:!1},totaldiscs:{multiple:!1},compilation:{multiple:!1},rating:{multiple:!0},bpm:{multiple:!1},mood:{multiple:!1},media:{multiple:!1},catalognumber:{multiple:!0,unique:!0},tvShow:{multiple:!1},tvShowSort:{multiple:!1},tvSeason:{multiple:!1},tvEpisode:{multiple:!1},tvEpisodeId:{multiple:!1},tvNetwork:{multiple:!1},podcast:{multiple:!1},podcasturl:{multiple:!1},releasestatus:{multiple:!1},releasetype:{multiple:!0},releasecountry:{multiple:!1},script:{multiple:!1},language:{multiple:!1},copyright:{multiple:!1},license:{multiple:!1},encodedby:{multiple:!1},encodersettings:{multiple:!1},gapless:{multiple:!1},barcode:{multiple:!1},isrc:{multiple:!0},asin:{multiple:!1},musicbrainz_recordingid:{multiple:!1},musicbrainz_trackid:{multiple:!1},musicbrainz_albumid:{multiple:!1},musicbrainz_artistid:{multiple:!0},musicbrainz_albumartistid:{multiple:!0},musicbrainz_releasegroupid:{multiple:!1},musicbrainz_workid:{multiple:!1},musicbrainz_trmid:{multiple:!1},musicbrainz_discid:{multiple:!1},acoustid_id:{multiple:!1},acoustid_fingerprint:{multiple:!1},musicip_puid:{multiple:!1},musicip_fingerprint:{multiple:!1},website:{multiple:!1},"performer:instrument":{multiple:!0,unique:!0},averageLevel:{multiple:!1},peakLevel:{multiple:!1},notes:{multiple:!0,unique:!1},key:{multiple:!1},originalalbum:{multiple:!1},originalartist:{multiple:!1},discogs_artist_id:{multiple:!0,unique:!0},discogs_release_id:{multiple:!1},discogs_label_id:{multiple:!1},discogs_master_release_id:{multiple:!1},discogs_votes:{multiple:!1},discogs_rating:{multiple:!1},replaygain_track_peak:{multiple:!1},replaygain_track_gain:{multiple:!1},replaygain_album_peak:{multiple:!1},replaygain_album_gain:{multiple:!1},replaygain_track_minmax:{multiple:!1},replaygain_album_minmax:{multiple:!1},replaygain_undo:{multiple:!1},description:{multiple:!0},longDescription:{multiple:!1},category:{multiple:!0},hdVideo:{multiple:!1},keywords:{multiple:!0},movement:{multiple:!1},movementIndex:{multiple:!1},movementTotal:{multiple:!1},podcastId:{multiple:!1},showMovement:{multiple:!1},stik:{multiple:!1}};function Kq(t){return $f[t]&&!$f[t].multiple}function Qq(t){return!$f[t].multiple||$f[t].unique||!1}class hr{static toIntOrNull(e){const n=Number.parseInt(e,10);return Number.isNaN(n)?null:n}static normalizeTrack(e){const n=e.toString().split("/");return{no:Number.parseInt(n[0],10)||null,of:Number.parseInt(n[1],10)||null}}constructor(e,n){this.tagTypes=e,this.tagMap=n}mapGenericTag(e,n){e={id:e.id,value:e.value},this.postMap(e,n);const r=this.getCommonName(e.id);return r?{id:r,value:e.value}:null}getCommonName(e){return this.tagMap[e]}postMap(e,n){}}hr.maxRatingScore=1;const Xq={title:"title",artist:"artist",album:"album",year:"year",comment:"comment",track:"track",genre:"genre"};class Yq extends hr{constructor(){super(["ID3v1"],Xq)}}class od extends hr{constructor(e,n){const r={};for(const s of Object.keys(n))r[s.toUpperCase()]=n[s];super(e,r)}getCommonName(e){return this.tagMap[e.toUpperCase()]}}const Jq={TIT2:"title",TPE1:"artist","TXXX:Artists":"artists",TPE2:"albumartist",TALB:"album",TDRV:"date",TORY:"originalyear",TPOS:"disk",TCON:"genre",APIC:"picture",TCOM:"composer",USLT:"lyrics",TSOA:"albumsort",TSOT:"titlesort",TOAL:"originalalbum",TSOP:"artistsort",TSO2:"albumartistsort",TSOC:"composersort",TEXT:"lyricist","TXXX:Writer":"writer",TPE3:"conductor",TPE4:"remixer","IPLS:arranger":"arranger","IPLS:engineer":"engineer","IPLS:producer":"producer","IPLS:DJ-mix":"djmixer","IPLS:mix":"mixer",TPUB:"label",TIT1:"grouping",TIT3:"subtitle",TRCK:"track",TCMP:"compilation",POPM:"rating",TBPM:"bpm",TMED:"media","TXXX:CATALOGNUMBER":"catalognumber","TXXX:MusicBrainz Album Status":"releasestatus","TXXX:MusicBrainz Album Type":"releasetype","TXXX:MusicBrainz Album Release Country":"releasecountry","TXXX:RELEASECOUNTRY":"releasecountry","TXXX:SCRIPT":"script",TLAN:"language",TCOP:"copyright",WCOP:"license",TENC:"encodedby",TSSE:"encodersettings","TXXX:BARCODE":"barcode","TXXX:ISRC":"isrc",TSRC:"isrc","TXXX:ASIN":"asin","TXXX:originalyear":"originalyear","UFID:http://musicbrainz.org":"musicbrainz_recordingid","TXXX:MusicBrainz Release Track Id":"musicbrainz_trackid","TXXX:MusicBrainz Album Id":"musicbrainz_albumid","TXXX:MusicBrainz Artist Id":"musicbrainz_artistid","TXXX:MusicBrainz Album Artist Id":"musicbrainz_albumartistid","TXXX:MusicBrainz Release Group Id":"musicbrainz_releasegroupid","TXXX:MusicBrainz Work Id":"musicbrainz_workid","TXXX:MusicBrainz TRM Id":"musicbrainz_trmid","TXXX:MusicBrainz Disc Id":"musicbrainz_discid","TXXX:ACOUSTID_ID":"acoustid_id","TXXX:Acoustid Id":"acoustid_id","TXXX:Acoustid Fingerprint":"acoustid_fingerprint","TXXX:MusicIP PUID":"musicip_puid","TXXX:MusicMagic Fingerprint":"musicip_fingerprint",WOAR:"website",TDRC:"date",TYER:"year",TDOR:"originaldate","TIPL:arranger":"arranger","TIPL:engineer":"engineer","TIPL:producer":"producer","TIPL:DJ-mix":"djmixer","TIPL:mix":"mixer",TMOO:"mood",SYLT:"lyrics",TSST:"discsubtitle",TKEY:"key",COMM:"comment",TOPE:"originalartist","PRIV:AverageLevel":"averageLevel","PRIV:PeakLevel":"peakLevel","TXXX:DISCOGS_ARTIST_ID":"discogs_artist_id","TXXX:DISCOGS_ARTISTS":"artists","TXXX:DISCOGS_ARTIST_NAME":"artists","TXXX:DISCOGS_ALBUM_ARTISTS":"albumartist","TXXX:DISCOGS_CATALOG":"catalognumber","TXXX:DISCOGS_COUNTRY":"releasecountry","TXXX:DISCOGS_DATE":"originaldate","TXXX:DISCOGS_LABEL":"label","TXXX:DISCOGS_LABEL_ID":"discogs_label_id","TXXX:DISCOGS_MASTER_RELEASE_ID":"discogs_master_release_id","TXXX:DISCOGS_RATING":"discogs_rating","TXXX:DISCOGS_RELEASED":"date","TXXX:DISCOGS_RELEASE_ID":"discogs_release_id","TXXX:DISCOGS_VOTES":"discogs_votes","TXXX:CATALOGID":"catalognumber","TXXX:STYLE":"genre","TXXX:REPLAYGAIN_TRACK_PEAK":"replaygain_track_peak","TXXX:REPLAYGAIN_TRACK_GAIN":"replaygain_track_gain","TXXX:REPLAYGAIN_ALBUM_PEAK":"replaygain_album_peak","TXXX:REPLAYGAIN_ALBUM_GAIN":"replaygain_album_gain","TXXX:MP3GAIN_MINMAX":"replaygain_track_minmax","TXXX:MP3GAIN_ALBUM_MINMAX":"replaygain_album_minmax","TXXX:MP3GAIN_UNDO":"replaygain_undo",MVNM:"movement",MVIN:"movementIndex",PCST:"podcast",TCAT:"category",TDES:"description",TDRL:"releasedate",TGID:"podcastId",TKWD:"keywords",WFED:"podcasturl",GRP1:"grouping"};class qw extends od{static toRating(e){return{source:e.email,rating:e.rating>0?(e.rating-1)/254*hr.maxRatingScore:void 0}}constructor(){super(["ID3v2.3","ID3v2.4"],Jq)}postMap(e,n){switch(e.id){case"UFID":{const r=e.value;r.owner_identifier==="http://musicbrainz.org"&&(e.id+=`:${r.owner_identifier}`,e.value=At(r.identifier,"latin1"))}break;case"PRIV":{const r=e.value;switch(r.owner_identifier){case"AverageLevel":case"PeakValue":e.id+=`:${r.owner_identifier}`,e.value=r.data.length===4?ne.get(r.data,0):null,e.value===null&&n.addWarning("Failed to parse PRIV:PeakValue");break;default:n.addWarning(`Unknown PRIV owner-identifier: ${r.data}`)}}break;case"POPM":e.value=qw.toRating(e.value);break}}}const Zq={Title:"title",Author:"artist","WM/AlbumArtist":"albumartist","WM/AlbumTitle":"album","WM/Year":"date","WM/OriginalReleaseTime":"originaldate","WM/OriginalReleaseYear":"originalyear",Description:"comment","WM/TrackNumber":"track","WM/PartOfSet":"disk","WM/Genre":"genre","WM/Composer":"composer","WM/Lyrics":"lyrics","WM/AlbumSortOrder":"albumsort","WM/TitleSortOrder":"titlesort","WM/ArtistSortOrder":"artistsort","WM/AlbumArtistSortOrder":"albumartistsort","WM/ComposerSortOrder":"composersort","WM/Writer":"lyricist","WM/Conductor":"conductor","WM/ModifiedBy":"remixer","WM/Engineer":"engineer","WM/Producer":"producer","WM/DJMixer":"djmixer","WM/Mixer":"mixer","WM/Publisher":"label","WM/ContentGroupDescription":"grouping","WM/SubTitle":"subtitle","WM/SetSubTitle":"discsubtitle","WM/IsCompilation":"compilation","WM/SharedUserRating":"rating","WM/BeatsPerMinute":"bpm","WM/Mood":"mood","WM/Media":"media","WM/CatalogNo":"catalognumber","MusicBrainz/Album Status":"releasestatus","MusicBrainz/Album Type":"releasetype","MusicBrainz/Album Release Country":"releasecountry","WM/Script":"script","WM/Language":"language",Copyright:"copyright",LICENSE:"license","WM/EncodedBy":"encodedby","WM/EncodingSettings":"encodersettings","WM/Barcode":"barcode","WM/ISRC":"isrc","MusicBrainz/Track Id":"musicbrainz_recordingid","MusicBrainz/Release Track Id":"musicbrainz_trackid","MusicBrainz/Album Id":"musicbrainz_albumid","MusicBrainz/Artist Id":"musicbrainz_artistid","MusicBrainz/Album Artist Id":"musicbrainz_albumartistid","MusicBrainz/Release Group Id":"musicbrainz_releasegroupid","MusicBrainz/Work Id":"musicbrainz_workid","MusicBrainz/TRM Id":"musicbrainz_trmid","MusicBrainz/Disc Id":"musicbrainz_discid","Acoustid/Id":"acoustid_id","Acoustid/Fingerprint":"acoustid_fingerprint","MusicIP/PUID":"musicip_puid","WM/ARTISTS":"artists","WM/InitialKey":"key",ASIN:"asin","WM/Work":"work","WM/AuthorURL":"website","WM/Picture":"picture"};class Kw extends hr{static toRating(e){return{rating:Number.parseFloat(e+1)/5}}constructor(){super(["asf"],Zq)}postMap(e){switch(e.id){case"WM/SharedUserRating":{const n=e.id.split(":");e.value=Kw.toRating(e.value),e.id=n[0];break}}}}const eK={TT2:"title",TP1:"artist",TP2:"albumartist",TAL:"album",TYE:"year",COM:"comment",TRK:"track",TPA:"disk",TCO:"genre",PIC:"picture",TCM:"composer",TOR:"originaldate",TOT:"originalalbum",TXT:"lyricist",TP3:"conductor",TPB:"label",TT1:"grouping",TT3:"subtitle",TLA:"language",TCR:"copyright",WCP:"license",TEN:"encodedby",TSS:"encodersettings",WAR:"website",PCS:"podcast",TCP:"compilation",TDR:"date",TS2:"albumartistsort",TSA:"albumsort",TSC:"composersort",TSP:"artistsort",TST:"titlesort",WFD:"podcasturl",TBP:"bpm"};class tK extends od{constructor(){super(["ID3v2.2"],eK)}}const nK={Title:"title",Artist:"artist",Artists:"artists","Album Artist":"albumartist",Album:"album",Year:"date",Originalyear:"originalyear",Originaldate:"originaldate",Releasedate:"releasedate",Comment:"comment",Track:"track",Disc:"disk",DISCNUMBER:"disk",Genre:"genre","Cover Art (Front)":"picture","Cover Art (Back)":"picture",Composer:"composer",Lyrics:"lyrics",ALBUMSORT:"albumsort",TITLESORT:"titlesort",WORK:"work",ARTISTSORT:"artistsort",ALBUMARTISTSORT:"albumartistsort",COMPOSERSORT:"composersort",Lyricist:"lyricist",Writer:"writer",Conductor:"conductor",MixArtist:"remixer",Arranger:"arranger",Engineer:"engineer",Producer:"producer",DJMixer:"djmixer",Mixer:"mixer",Label:"label",Grouping:"grouping",Subtitle:"subtitle",DiscSubtitle:"discsubtitle",Compilation:"compilation",BPM:"bpm",Mood:"mood",Media:"media",CatalogNumber:"catalognumber",MUSICBRAINZ_ALBUMSTATUS:"releasestatus",MUSICBRAINZ_ALBUMTYPE:"releasetype",RELEASECOUNTRY:"releasecountry",Script:"script",Language:"language",Copyright:"copyright",LICENSE:"license",EncodedBy:"encodedby",EncoderSettings:"encodersettings",Barcode:"barcode",ISRC:"isrc",ASIN:"asin",musicbrainz_trackid:"musicbrainz_recordingid",musicbrainz_releasetrackid:"musicbrainz_trackid",MUSICBRAINZ_ALBUMID:"musicbrainz_albumid",MUSICBRAINZ_ARTISTID:"musicbrainz_artistid",MUSICBRAINZ_ALBUMARTISTID:"musicbrainz_albumartistid",MUSICBRAINZ_RELEASEGROUPID:"musicbrainz_releasegroupid",MUSICBRAINZ_WORKID:"musicbrainz_workid",MUSICBRAINZ_TRMID:"musicbrainz_trmid",MUSICBRAINZ_DISCID:"musicbrainz_discid",Acoustid_Id:"acoustid_id",ACOUSTID_FINGERPRINT:"acoustid_fingerprint",MUSICIP_PUID:"musicip_puid",Weblink:"website",REPLAYGAIN_TRACK_GAIN:"replaygain_track_gain",REPLAYGAIN_TRACK_PEAK:"replaygain_track_peak",MP3GAIN_MINMAX:"replaygain_track_minmax",MP3GAIN_UNDO:"replaygain_undo"};class rK extends od{constructor(){super(["APEv2"],nK)}}const sK={"©nam":"title","©ART":"artist",aART:"albumartist","----:com.apple.iTunes:Band":"albumartist","©alb":"album","©day":"date","©cmt":"comment","©com":"comment",trkn:"track",disk:"disk","©gen":"genre",covr:"picture","©wrt":"composer","©lyr":"lyrics",soal:"albumsort",sonm:"titlesort",soar:"artistsort",soaa:"albumartistsort",soco:"composersort","----:com.apple.iTunes:LYRICIST":"lyricist","----:com.apple.iTunes:CONDUCTOR":"conductor","----:com.apple.iTunes:REMIXER":"remixer","----:com.apple.iTunes:ENGINEER":"engineer","----:com.apple.iTunes:PRODUCER":"producer","----:com.apple.iTunes:DJMIXER":"djmixer","----:com.apple.iTunes:MIXER":"mixer","----:com.apple.iTunes:LABEL":"label","©grp":"grouping","----:com.apple.iTunes:SUBTITLE":"subtitle","----:com.apple.iTunes:DISCSUBTITLE":"discsubtitle",cpil:"compilation",tmpo:"bpm","----:com.apple.iTunes:MOOD":"mood","----:com.apple.iTunes:MEDIA":"media","----:com.apple.iTunes:CATALOGNUMBER":"catalognumber",tvsh:"tvShow",tvsn:"tvSeason",tves:"tvEpisode",sosn:"tvShowSort",tven:"tvEpisodeId",tvnn:"tvNetwork",pcst:"podcast",purl:"podcasturl","----:com.apple.iTunes:MusicBrainz Album Status":"releasestatus","----:com.apple.iTunes:MusicBrainz Album Type":"releasetype","----:com.apple.iTunes:MusicBrainz Album Release Country":"releasecountry","----:com.apple.iTunes:SCRIPT":"script","----:com.apple.iTunes:LANGUAGE":"language",cprt:"copyright","©cpy":"copyright","----:com.apple.iTunes:LICENSE":"license","©too":"encodedby",pgap:"gapless","----:com.apple.iTunes:BARCODE":"barcode","----:com.apple.iTunes:ISRC":"isrc","----:com.apple.iTunes:ASIN":"asin","----:com.apple.iTunes:NOTES":"comment","----:com.apple.iTunes:MusicBrainz Track Id":"musicbrainz_recordingid","----:com.apple.iTunes:MusicBrainz Release Track Id":"musicbrainz_trackid","----:com.apple.iTunes:MusicBrainz Album Id":"musicbrainz_albumid","----:com.apple.iTunes:MusicBrainz Artist Id":"musicbrainz_artistid","----:com.apple.iTunes:MusicBrainz Album Artist Id":"musicbrainz_albumartistid","----:com.apple.iTunes:MusicBrainz Release Group Id":"musicbrainz_releasegroupid","----:com.apple.iTunes:MusicBrainz Work Id":"musicbrainz_workid","----:com.apple.iTunes:MusicBrainz TRM Id":"musicbrainz_trmid","----:com.apple.iTunes:MusicBrainz Disc Id":"musicbrainz_discid","----:com.apple.iTunes:Acoustid Id":"acoustid_id","----:com.apple.iTunes:Acoustid Fingerprint":"acoustid_fingerprint","----:com.apple.iTunes:MusicIP PUID":"musicip_puid","----:com.apple.iTunes:fingerprint":"musicip_fingerprint","----:com.apple.iTunes:replaygain_track_gain":"replaygain_track_gain","----:com.apple.iTunes:replaygain_track_peak":"replaygain_track_peak","----:com.apple.iTunes:replaygain_album_gain":"replaygain_album_gain","----:com.apple.iTunes:replaygain_album_peak":"replaygain_album_peak","----:com.apple.iTunes:replaygain_track_minmax":"replaygain_track_minmax","----:com.apple.iTunes:replaygain_album_minmax":"replaygain_album_minmax","----:com.apple.iTunes:replaygain_undo":"replaygain_undo",gnre:"genre","----:com.apple.iTunes:ALBUMARTISTSORT":"albumartistsort","----:com.apple.iTunes:ARTISTS":"artists","----:com.apple.iTunes:ORIGINALDATE":"originaldate","----:com.apple.iTunes:ORIGINALYEAR":"originalyear","----:com.apple.iTunes:RELEASEDATE":"releasedate",desc:"description",ldes:"longDescription","©mvn":"movement","©mvi":"movementIndex","©mvc":"movementTotal","©wrk":"work",catg:"category",egid:"podcastId",hdvd:"hdVideo",keyw:"keywords",shwm:"showMovement",stik:"stik",rate:"rating"},iK="iTunes";class RE extends od{constructor(){super([iK],sK)}postMap(e,n){switch(e.id){case"rate":e.value={source:void 0,rating:Number.parseFloat(e.value)/100};break}}}const aK={TITLE:"title",ARTIST:"artist",ARTISTS:"artists",ALBUMARTIST:"albumartist","ALBUM ARTIST":"albumartist",ALBUM:"album",DATE:"date",ORIGINALDATE:"originaldate",ORIGINALYEAR:"originalyear",RELEASEDATE:"releasedate",COMMENT:"comment",TRACKNUMBER:"track",DISCNUMBER:"disk",GENRE:"genre",METADATA_BLOCK_PICTURE:"picture",COMPOSER:"composer",LYRICS:"lyrics",ALBUMSORT:"albumsort",TITLESORT:"titlesort",WORK:"work",ARTISTSORT:"artistsort",ALBUMARTISTSORT:"albumartistsort",COMPOSERSORT:"composersort",LYRICIST:"lyricist",WRITER:"writer",CONDUCTOR:"conductor",REMIXER:"remixer",ARRANGER:"arranger",ENGINEER:"engineer",PRODUCER:"producer",DJMIXER:"djmixer",MIXER:"mixer",LABEL:"label",GROUPING:"grouping",SUBTITLE:"subtitle",DISCSUBTITLE:"discsubtitle",TRACKTOTAL:"totaltracks",DISCTOTAL:"totaldiscs",COMPILATION:"compilation",RATING:"rating",BPM:"bpm",KEY:"key",MOOD:"mood",MEDIA:"media",CATALOGNUMBER:"catalognumber",RELEASESTATUS:"releasestatus",RELEASETYPE:"releasetype",RELEASECOUNTRY:"releasecountry",SCRIPT:"script",LANGUAGE:"language",COPYRIGHT:"copyright",LICENSE:"license",ENCODEDBY:"encodedby",ENCODERSETTINGS:"encodersettings",BARCODE:"barcode",ISRC:"isrc",ASIN:"asin",MUSICBRAINZ_TRACKID:"musicbrainz_recordingid",MUSICBRAINZ_RELEASETRACKID:"musicbrainz_trackid",MUSICBRAINZ_ALBUMID:"musicbrainz_albumid",MUSICBRAINZ_ARTISTID:"musicbrainz_artistid",MUSICBRAINZ_ALBUMARTISTID:"musicbrainz_albumartistid",MUSICBRAINZ_RELEASEGROUPID:"musicbrainz_releasegroupid",MUSICBRAINZ_WORKID:"musicbrainz_workid",MUSICBRAINZ_TRMID:"musicbrainz_trmid",MUSICBRAINZ_DISCID:"musicbrainz_discid",ACOUSTID_ID:"acoustid_id",ACOUSTID_ID_FINGERPRINT:"acoustid_fingerprint",MUSICIP_PUID:"musicip_puid",WEBSITE:"website",NOTES:"notes",TOTALTRACKS:"totaltracks",TOTALDISCS:"totaldiscs",DISCOGS_ARTIST_ID:"discogs_artist_id",DISCOGS_ARTISTS:"artists",DISCOGS_ARTIST_NAME:"artists",DISCOGS_ALBUM_ARTISTS:"albumartist",DISCOGS_CATALOG:"catalognumber",DISCOGS_COUNTRY:"releasecountry",DISCOGS_DATE:"originaldate",DISCOGS_LABEL:"label",DISCOGS_LABEL_ID:"discogs_label_id",DISCOGS_MASTER_RELEASE_ID:"discogs_master_release_id",DISCOGS_RATING:"discogs_rating",DISCOGS_RELEASED:"date",DISCOGS_RELEASE_ID:"discogs_release_id",DISCOGS_VOTES:"discogs_votes",CATALOGID:"catalognumber",STYLE:"genre",REPLAYGAIN_TRACK_GAIN:"replaygain_track_gain",REPLAYGAIN_TRACK_PEAK:"replaygain_track_peak",REPLAYGAIN_ALBUM_GAIN:"replaygain_album_gain",REPLAYGAIN_ALBUM_PEAK:"replaygain_album_peak",REPLAYGAIN_MINMAX:"replaygain_track_minmax",REPLAYGAIN_ALBUM_MINMAX:"replaygain_album_minmax",REPLAYGAIN_UNDO:"replaygain_undo"};class zf extends hr{static toRating(e,n,r){return{source:e?e.toLowerCase():void 0,rating:Number.parseFloat(n)/r*hr.maxRatingScore}}constructor(){super(["vorbis"],aK)}postMap(e){if(e.id==="RATING")e.value=zf.toRating(void 0,e.value,100);else if(e.id.indexOf("RATING:")===0){const n=e.id.split(":");e.value=zf.toRating(n[1],e.value,1),e.id=n[0]}}}const oK={IART:"artist",ICRD:"date",INAM:"title",TITL:"title",IPRD:"album",ITRK:"track",IPRT:"track",COMM:"comment",ICMT:"comment",ICNT:"releasecountry",GNRE:"genre",IWRI:"writer",RATE:"rating",YEAR:"year",ISFT:"encodedby",CODE:"encodedby",TURL:"website",IGNR:"genre",IENG:"engineer",ITCH:"technician",IMED:"media",IRPD:"album"};class lK extends hr{constructor(){super(["exif"],oK)}}const cK={"segment:title":"title","album:ARTIST":"albumartist","album:ARTISTSORT":"albumartistsort","album:TITLE":"album","album:DATE_RECORDED":"originaldate","album:DATE_RELEASED":"releasedate","album:PART_NUMBER":"disk","album:TOTAL_PARTS":"totaltracks","track:ARTIST":"artist","track:ARTISTSORT":"artistsort","track:TITLE":"title","track:PART_NUMBER":"track","track:MUSICBRAINZ_TRACKID":"musicbrainz_recordingid","track:MUSICBRAINZ_ALBUMID":"musicbrainz_albumid","track:MUSICBRAINZ_ARTISTID":"musicbrainz_artistid","track:PUBLISHER":"label","track:GENRE":"genre","track:ENCODER":"encodedby","track:ENCODER_OPTIONS":"encodersettings","edition:TOTAL_PARTS":"totaldiscs",picture:"picture"};class uK extends od{constructor(){super(["matroska"],cK)}}const dK={NAME:"title",AUTH:"artist","(c) ":"copyright",ANNO:"comment"};class hK extends hr{constructor(){super(["AIFF"],dK)}}class fK{constructor(){this.tagMappers={},[new Yq,new tK,new qw,new RE,new RE,new zf,new rK,new Kw,new lK,new uK,new hK].forEach(e=>{this.registerTagMapper(e)})}mapTag(e,n,r){if(this.tagMappers[e])return this.tagMappers[e].mapGenericTag(n,r);throw new Error(`No generic tag mapper defined for tag-format: ${e}`)}registerTagMapper(e){for(const n of e.tagTypes)this.tagMappers[n]=e}}const ya=Ke("music-metadata:collector"),mK=["matroska","APEv2","vorbis","ID3v2.4","ID3v2.3","ID3v2.2","exif","asf","iTunes","AIFF","ID3v1"];class pK{constructor(e){this.opts=e,this.format={tagTypes:[],trackInfo:[]},this.native={},this.common={track:{no:null,of:null},disk:{no:null,of:null},movementIndex:{no:null,of:null}},this.quality={warnings:[]},this.commonOrigin={},this.originPriority={},this.tagMapper=new fK;let n=1;for(const r of mK)this.originPriority[r]=n++;this.originPriority.artificial=500,this.originPriority.id3v1=600}hasAny(){return Object.keys(this.native).length>0}addStreamInfo(e){ya(`streamInfo: type=${e.type?Za[e.type]:"?"}, codec=${e.codecName}`),this.format.trackInfo.push(e)}setFormat(e,n){var r;ya(`format: ${e} = ${n}`),this.format[e]=n,(r=this.opts)!=null&&r.observer&&this.opts.observer({metadata:this,tag:{type:"format",id:e,value:n}})}async addTag(e,n,r){ya(`tag ${e}.${n} = ${r}`),this.native[e]||(this.format.tagTypes.push(e),this.native[e]=[]),this.native[e].push({id:n,value:r}),await this.toCommon(e,n,r)}addWarning(e){this.quality.warnings.push({message:e})}async postMap(e,n){switch(n.id){case"artist":if(this.commonOrigin.artist===this.originPriority[e])return this.postMap("artificial",{id:"artists",value:n.value});this.common.artists||this.setGenericTag("artificial",{id:"artists",value:n.value});break;case"artists":if((!this.common.artist||this.commonOrigin.artist===this.originPriority.artificial)&&(!this.common.artists||this.common.artists.indexOf(n.value)===-1)){const r=(this.common.artists||[]).concat([n.value]),i={id:"artist",value:gK(r)};this.setGenericTag("artificial",i)}break;case"picture":return this.postFixPicture(n.value).then(r=>{r!==null&&(n.value=r,this.setGenericTag(e,n))});case"totaltracks":this.common.track.of=hr.toIntOrNull(n.value);return;case"totaldiscs":this.common.disk.of=hr.toIntOrNull(n.value);return;case"movementTotal":this.common.movementIndex.of=hr.toIntOrNull(n.value);return;case"track":case"disk":case"movementIndex":{const r=this.common[n.id].of;this.common[n.id]=hr.normalizeTrack(n.value),this.common[n.id].of=r??this.common[n.id].of;return}case"bpm":case"year":case"originalyear":n.value=Number.parseInt(n.value,10);break;case"date":{const r=Number.parseInt(n.value.substr(0,4),10);Number.isNaN(r)||(this.common.year=r);break}case"discogs_label_id":case"discogs_release_id":case"discogs_master_release_id":case"discogs_artist_id":case"discogs_votes":n.value=typeof n.value=="string"?Number.parseInt(n.value,10):n.value;break;case"replaygain_track_gain":case"replaygain_track_peak":case"replaygain_album_gain":case"replaygain_album_peak":n.value=qq(n.value);break;case"replaygain_track_minmax":n.value=n.value.split(",").map(r=>Number.parseInt(r,10));break;case"replaygain_undo":{const r=n.value.split(",").map(s=>Number.parseInt(s,10));n.value={leftChannel:r[0],rightChannel:r[1]};break}case"gapless":case"compilation":case"podcast":case"showMovement":n.value=n.value==="1"||n.value===1;break;case"isrc":{const r=this.common[n.id];if(r&&r.indexOf(n.value)!==-1)return;break}case"comment":typeof n.value=="string"&&(n.value={text:n.value}),n.value.descriptor==="iTunPGAP"&&this.setGenericTag(e,{id:"gapless",value:n.value.text==="1"});break}n.value!==null&&this.setGenericTag(e,n)}toCommonMetadata(){return{format:this.format,native:this.native,quality:this.quality,common:this.common}}async postFixPicture(e){if(e.data&&e.data.length>0){if(!e.format){const n=await ON(Uint8Array.from(e.data));if(n)e.format=n.mime;else return null}switch(e.format=e.format.toLocaleLowerCase(),e.format){case"image/jpg":e.format="image/jpeg"}return e}return this.addWarning("Empty picture tag found"),null}async toCommon(e,n,r){const s={id:n,value:r},i=this.tagMapper.mapTag(e,s,this);i&&await this.postMap(e,i)}setGenericTag(e,n){var i;ya(`common.${n.id} = ${n.value}`);const r=this.commonOrigin[n.id]||1e3,s=this.originPriority[e];if(Kq(n.id))if(s<=r)this.common[n.id]=n.value,this.commonOrigin[n.id]=s;else return ya(`Ignore native tag (singleton): ${e}.${n.id} = ${n.value}`);else if(s===r)!Qq(n.id)||this.common[n.id].indexOf(n.value)===-1?this.common[n.id].push(n.value):ya(`Ignore duplicate value: ${e}.${n.id} = ${n.value}`);else if(s<r)this.common[n.id]=[n.value],this.commonOrigin[n.id]=s;else return ya(`Ignore native tag (list): ${e}.${n.id} = ${n.value}`);(i=this.opts)!=null&&i.observer&&this.opts.observer({metadata:this,tag:{type:"common",id:n.id,value:n.value}})}}function gK(t){return t.length>2?`${t.slice(0,t.length-1).join(", ")} & ${t[t.length-1]}`:t.join(" & ")}class br{constructor(){this.metadata=void 0,this.tokenizer=void 0,this.options=void 0}init(e,n,r){return this.metadata=e,this.tokenizer=n,this.options=r,this}}const xK=/^[\x21-\x7e©][\x20-\x7e\x00()]{3}/,tt={len:4,get:(t,e)=>{const n=Hw(t.slice(e,e+tt.len),"latin1");if(!n.match(xK))throw new Error(`FourCC contains invalid characters: ${Hq(n)} "${n}"`);return n},put:(t,e,n)=>{const r=yq(n);if(r.length!==4)throw new Error("Invalid length");return t.set(r,e),e+4}};var Wo;(function(t){t[t.text_utf8=0]="text_utf8",t[t.binary=1]="binary",t[t.external_info=2]="external_info",t[t.reserved=3]="reserved"})(Wo||(Wo={}));const NE={len:52,get:(t,e)=>({ID:tt.get(t,e),version:ne.get(t,e+4)/1e3,descriptorBytes:ne.get(t,e+8),headerBytes:ne.get(t,e+12),seekTableBytes:ne.get(t,e+16),headerDataBytes:ne.get(t,e+20),apeFrameDataBytes:ne.get(t,e+24),apeFrameDataBytesHigh:ne.get(t,e+28),terminatingDataBytes:ne.get(t,e+32),fileMD5:new Hn(16).get(t,e+36)})},yK={len:24,get:(t,e)=>({compressionLevel:Ve.get(t,e),formatFlags:Ve.get(t,e+2),blocksPerFrame:ne.get(t,e+4),finalFrameBlocks:ne.get(t,e+8),totalFrames:ne.get(t,e+12),bitsPerSample:Ve.get(t,e+16),channel:Ve.get(t,e+18),sampleRate:ne.get(t,e+20)})},Ir={len:32,get:(t,e)=>({ID:new ae(8,"ascii").get(t,e),version:ne.get(t,e+8),size:ne.get(t,e+12),fields:ne.get(t,e+16),flags:HN(ne.get(t,e+20))})},Gg={len:8,get:(t,e)=>({size:ne.get(t,e),flags:HN(ne.get(t,e+4))})};function HN(t){return{containsHeader:Zd(t,31),containsFooter:Zd(t,30),isHeader:Zd(t,29),readOnly:Zd(t,0),dataType:(t&6)>>1}}function Zd(t,e){return(t&1<<e)!==0}const va=Ke("music-metadata:parser:APEv2"),AE="APEv2",PE="APETAGEX";class xs extends br{constructor(){super(...arguments),this.ape={}}static tryParseApeHeader(e,n,r){const s=new xs;return s.init(e,n,r),s.tryParseApeHeader()}static calculateDuration(e){let n=e.totalFrames>1?e.blocksPerFrame*(e.totalFrames-1):0;return n+=e.finalFrameBlocks,n/e.sampleRate}static async findApeFooterOffset(e,n){const r=new Uint8Array(Ir.len);await e.randomRead(r,0,Ir.len,n-Ir.len);const s=Ir.get(r,0);if(s.ID==="APETAGEX")return s.flags.isHeader?va(`APE Header found at offset=${n-Ir.len}`):(va(`APE Footer found at offset=${n-Ir.len}`),n-=s.size),{footer:s,offset:n}}static parseTagFooter(e,n,r){const s=Ir.get(n,n.length-Ir.len);if(s.ID!==PE)throw new Error("Unexpected APEv2 Footer ID preamble value.");kl(n);const i=new xs;return i.init(e,kl(n),r),i.parseTags(s)}async tryParseApeHeader(){if(this.tokenizer.fileInfo.size&&this.tokenizer.fileInfo.size-this.tokenizer.position<Ir.len){va("No APEv2 header found, end-of-file reached");return}const e=await this.tokenizer.peekToken(Ir);if(e.ID===PE)return await this.tokenizer.ignore(Ir.len),this.parseTags(e);if(va(`APEv2 header not found at offset=${this.tokenizer.position}`),this.tokenizer.fileInfo.size){const n=this.tokenizer.fileInfo.size-this.tokenizer.position,r=new Uint8Array(n);return await this.tokenizer.readBuffer(r),xs.parseTagFooter(this.metadata,r,this.options)}}async parse(){const e=await this.tokenizer.readToken(NE);if(e.ID!=="MAC ")throw new Error("Unexpected descriptor ID");this.ape.descriptor=e;const n=e.descriptorBytes-NE.len,r=await(n>0?this.parseDescriptorExpansion(n):this.parseHeader());return await this.tokenizer.ignore(r.forwardBytes),this.tryParseApeHeader()}async parseTags(e){const n=new Uint8Array(256);let r=e.size-Ir.len;va(`Parse APE tags at offset=${this.tokenizer.position}, size=${r}`);for(let s=0;s<e.fields;s++){if(r<Gg.len){this.metadata.addWarning(`APEv2 Tag-header: ${e.fields-s} items remaining, but no more tag data to read.`);break}const i=await this.tokenizer.readToken(Gg);r-=Gg.len+i.size,await this.tokenizer.peekBuffer(n,{length:Math.min(n.length,r)});let o=sr(n,0,n.length);const l=await this.tokenizer.readToken(new ae(o,"ascii"));switch(await this.tokenizer.ignore(1),r-=l.length+1,i.flags.dataType){case Wo.text_utf8:{const u=(await this.tokenizer.readToken(new ae(i.size,"utf8"))).split(/\x00/g);await Promise.all(u.map(d=>this.metadata.addTag(AE,l,d)));break}case Wo.binary:if(this.options.skipCovers)await this.tokenizer.ignore(i.size);else{const c=new Uint8Array(i.size);await this.tokenizer.readBuffer(c),o=sr(c,0,c.length);const u=Hw(c.slice(0,o)),d=c.slice(o+1);await this.metadata.addTag(AE,l,{description:u,data:d})}break;case Wo.external_info:va(`Ignore external info ${l}`),await this.tokenizer.ignore(i.size);break;case Wo.reserved:va(`Ignore external info ${l}`),this.metadata.addWarning(`APEv2 header declares a reserved datatype for "${l}"`),await this.tokenizer.ignore(i.size);break}}}async parseDescriptorExpansion(e){return await this.tokenizer.ignore(e),this.parseHeader()}async parseHeader(){const e=await this.tokenizer.readToken(yK);if(this.metadata.setFormat("lossless",!0),this.metadata.setFormat("container","Monkey's Audio"),this.metadata.setFormat("bitsPerSample",e.bitsPerSample),this.metadata.setFormat("sampleRate",e.sampleRate),this.metadata.setFormat("numberOfChannels",e.channel),this.metadata.setFormat("duration",xs.calculateDuration(e)),!this.ape.descriptor)throw new Error("Missing APE descriptor");return{forwardBytes:this.ape.descriptor.seekTableBytes+this.ape.descriptor.headerDataBytes+this.ape.descriptor.apeFrameDataBytes+this.ape.descriptor.terminatingDataBytes}}}const eh=Ke("music-metadata:parser:ID3v1"),Bf=["Blues","Classic Rock","Country","Dance","Disco","Funk","Grunge","Hip-Hop","Jazz","Metal","New Age","Oldies","Other","Pop","R&B","Rap","Reggae","Rock","Techno","Industrial","Alternative","Ska","Death Metal","Pranks","Soundtrack","Euro-Techno","Ambient","Trip-Hop","Vocal","Jazz+Funk","Fusion","Trance","Classical","Instrumental","Acid","House","Game","Sound Clip","Gospel","Noise","Alt. Rock","Bass","Soul","Punk","Space","Meditative","Instrumental Pop","Instrumental Rock","Ethnic","Gothic","Darkwave","Techno-Industrial","Electronic","Pop-Folk","Eurodance","Dream","Southern Rock","Comedy","Cult","Gangsta Rap","Top 40","Christian Rap","Pop/Funk","Jungle","Native American","Cabaret","New Wave","Psychedelic","Rave","Showtunes","Trailer","Lo-Fi","Tribal","Acid Punk","Acid Jazz","Polka","Retro","Musical","Rock & Roll","Hard Rock","Folk","Folk/Rock","National Folk","Swing","Fast-Fusion","Bebob","Latin","Revival","Celtic","Bluegrass","Avantgarde","Gothic Rock","Progressive Rock","Psychedelic Rock","Symphonic Rock","Slow Rock","Big Band","Chorus","Easy Listening","Acoustic","Humour","Speech","Chanson","Opera","Chamber Music","Sonata","Symphony","Booty Bass","Primus","Porn Groove","Satire","Slow Jam","Club","Tango","Samba","Folklore","Ballad","Power Ballad","Rhythmic Soul","Freestyle","Duet","Punk Rock","Drum Solo","A Cappella","Euro-House","Dance Hall","Goa","Drum & Bass","Club-House","Hardcore","Terror","Indie","BritPop","Negerpunk","Polsk Punk","Beat","Christian Gangsta Rap","Heavy Metal","Black Metal","Crossover","Contemporary Christian","Christian Rock","Merengue","Salsa","Thrash Metal","Anime","JPop","Synthpop","Abstract","Art Rock","Baroque","Bhangra","Big Beat","Breakbeat","Chillout","Downtempo","Dub","EBM","Eclectic","Electro","Electroclash","Emo","Experimental","Garage","Global","IDM","Illbient","Industro-Goth","Jam Band","Krautrock","Leftfield","Lounge","Math Rock","New Romantic","Nu-Breakz","Post-Punk","Post-Rock","Psytrance","Shoegaze","Space Rock","Trop Rock","World Music","Neoclassical","Audiobook","Audio Theatre","Neue Deutsche Welle","Podcast","Indie Rock","G-Funk","Dubstep","Garage Rock","Psybient"],th={len:128,get:(t,e)=>{const n=new ko(3).get(t,e);return n==="TAG"?{header:n,title:new ko(30).get(t,e+3),artist:new ko(30).get(t,e+33),album:new ko(30).get(t,e+63),year:new ko(4).get(t,e+93),comment:new ko(28).get(t,e+97),zeroByte:ke.get(t,e+127),track:ke.get(t,e+126),genre:ke.get(t,e+127)}:null}};class ko{constructor(e){this.len=e,this.stringType=new ae(e,"latin1")}get(e,n){let r=this.stringType.get(e,n);return r=BN(r),r=r.trim(),r.length>0?r:void 0}}class Qw extends br{static getGenre(e){if(e<Bf.length)return Bf[e]}async parse(){if(!this.tokenizer.fileInfo.size){eh("Skip checking for ID3v1 because the file-size is unknown");return}if(this.options.apeHeader){this.tokenizer.ignore(this.options.apeHeader.offset-this.tokenizer.position);const r=new xs;r.init(this.metadata,this.tokenizer,this.options),await r.parseTags(this.options.apeHeader.footer)}const e=this.tokenizer.fileInfo.size-th.len;if(this.tokenizer.position>e){eh("Already consumed the last 128 bytes");return}const n=await this.tokenizer.readToken(th,e);if(n){eh("ID3v1 header found at: pos=%s",this.tokenizer.fileInfo.size-th.len);const r=["title","artist","album","comment","track","year"];for(const i of r)n[i]&&n[i]!==""&&await this.addTag(i,n[i]);const s=Qw.getGenre(n.genre);s&&await this.addTag("genre",s)}else eh("ID3v1 header not found at: pos=%s",this.tokenizer.fileInfo.size-th.len)}async addTag(e,n){await this.metadata.addTag("ID3v1",e,n)}}const FE=Ke("music-metadata:id3v2:frame-parser"),Ur="latin1";function vK(t){const e=[];let n,r="";for(const s of t)if(typeof n=="string")if(s==="("&&n==="")r+="(",n=void 0;else if(s===")"){r!==""&&(e.push(r),r="");const i=ME(n);i&&e.push(i),n=void 0}else n+=s;else s==="("?n="":r+=s;return r&&(e.length===0&&r.match(/^\d*$/)&&(r=ME(r)),r&&e.push(r)),e}function ME(t){if(t==="RX")return"Remix";if(t==="CR")return"Cover";if(t.match(/^\d*$/))return Bf[Number.parseInt(t)]}class ir{constructor(e,n){this.major=e,this.warningCollector=n}readData(e,n,r){if(e.length===0){this.warningCollector.addWarning(`id3v2.${this.major} header has empty tag type=${n}`);return}const{encoding:s,bom:i}=UN.get(e,0),o=e.length;let l=0,c=[];const u=ir.getNullTerminatorLength(s);let d;switch(FE(`Parsing tag type=${n}, encoding=${s}, bom=${i}`),n!=="TXXX"&&n[0]==="T"?"T*":n){case"T*":case"GRP1":case"IPLS":case"MVIN":case"MVNM":case"PCS":case"PCST":{let m;try{m=At(e.slice(1),s).replace(/\x00+$/,"")}catch(p){if(p instanceof Error){this.warningCollector.addWarning(`id3v2.${this.major} type=${n} header has invalid string value: ${p.message}`);break}throw p}switch(n){case"TMCL":case"TIPL":case"IPLS":c=ir.functionList(this.splitValue(n,m));break;case"TRK":case"TRCK":case"TPOS":c=m;break;case"TCOM":case"TEXT":case"TOLY":case"TOPE":case"TPE1":case"TSRC":c=this.splitValue(n,m);break;case"TCO":case"TCON":c=this.splitValue(n,m).map(p=>vK(p)).reduce((p,g)=>p.concat(g),[]);break;case"PCS":case"PCST":c=this.major>=4?this.splitValue(n,m):[m],c=Array.isArray(c)&&c[0]===""?1:0;break;default:c=this.major>=4?this.splitValue(n,m):[m]}break}case"TXXX":{const m=ir.readIdentifierAndData(e,l+1,o,s);c={description:m.id,text:this.splitValue(n,At(m.data,s).replace(/\x00+$/,""))};break}case"PIC":case"APIC":if(r){const m={};switch(l+=1,this.major){case 2:m.format=At(e.slice(l,l+3),"latin1"),l+=3;break;case 3:case 4:d=sr(e,l,o,Ur),m.format=At(e.slice(l,d),Ur),l=d+1;break;default:throw new Error(`Warning: unexpected major versionIndex: ${this.major}`)}m.format=ir.fixPictureMimeType(m.format),m.type=Su[e[l]],l+=1,d=sr(e,l,o,s),m.description=At(e.slice(l,d),s),l=d+u,m.data=e.slice(l,o),c=m}break;case"CNT":case"PCNT":c=ue.get(e,0);break;case"SYLT":{const m=CE.get(e,0);l+=CE.len;const p={descriptor:"",language:m.language,contentType:m.contentType,timeStampFormat:m.timeStampFormat,syncText:[]};let g=!1;for(;l<o;){const x=ir.readNullTerminatedString(e.subarray(l),m.encoding);if(l+=x.len,g){const w=ue.get(e,l);l+=ue.len,p.syncText.push({text:x.text,timestamp:w})}else p.descriptor=x.text,g=!0}c=p;break}case"ULT":case"USLT":case"COM":case"COMM":{const m=Yx.get(e,l);l+=Yx.len;const p=ir.readNullTerminatedString(e.subarray(l),m.encoding);l+=p.len;const g=ir.readNullTerminatedString(e.subarray(l),m.encoding);c={language:m.language,descriptor:p.text,text:g.text};break}case"UFID":{const m=ir.readIdentifierAndData(e,l,o,Ur);c={owner_identifier:m.id,identifier:m.data};break}case"PRIV":{const m=ir.readIdentifierAndData(e,l,o,Ur);c={owner_identifier:m.id,data:m.data};break}case"POPM":{d=sr(e,l,o,Ur);const m=At(e.slice(l,d),Ur);l=d+1;const p=o-l;c={email:m,rating:ke.get(e,l),counter:p>=5?ue.get(e,l+1):void 0};break}case"GEOB":{d=sr(e,l+1,o,s);const m=At(e.slice(l+1,d),Ur);l=d+1,d=sr(e,l,o-l,s);const p=At(e.slice(l,d),Ur);l=d+1,d=sr(e,l,o-l,s);const g=At(e.slice(l,d),Ur);c={type:m,filename:p,description:g,data:e.slice(l+1,o)};break}case"WCOM":case"WCOP":case"WOAF":case"WOAR":case"WOAS":case"WORS":case"WPAY":case"WPUB":d=sr(e,l+1,o,s),c=At(e.slice(l,d),Ur);break;case"WXXX":{d=sr(e,l+1,o,s);const m=At(e.slice(l+1,d),s);l=d+(s==="utf-16le"?2:1),c={description:m,url:At(e.slice(l,o),Ur)};break}case"WFD":case"WFED":c=At(e.slice(l+1,sr(e,l+1,o,s)),s);break;case"MCDI":{c=e.slice(0,o);break}default:FE(`Warning: unsupported id3v2-tag-type: ${n}`);break}return c}static readNullTerminatedString(e,n){let r=n.bom?2:0;const s=sr(e,r,e.length,n.encoding),i=e.slice(r,s);return n.encoding==="utf-16le"?r=s+2:r=s+1,{text:At(i,n.encoding),len:r}}static fixPictureMimeType(e){switch(e=e.toLocaleLowerCase(),e){case"jpg":return"image/jpeg";case"png":return"image/png"}return e}static functionList(e){const n={};for(let r=0;r+1<e.length;r+=2){const s=e[r+1].split(",");n[e[r]]=n[e[r]]?n[e[r]].concat(s):s}return n}splitValue(e,n){let r;return this.major<4?(r=n.split(/\x00/g),r.length>1?this.warningCollector.addWarning(`ID3v2.${this.major} ${e} uses non standard null-separator.`):r=n.split(/\//g)):r=n.split(/\x00/g),ir.trimArray(r)}static trimArray(e){return e.map(n=>n.replace(/\x00+$/,"").trim())}static readIdentifierAndData(e,n,r,s){const i=sr(e,n,r,s),o=At(e.slice(n,i),s);return n=i+ir.getNullTerminatorLength(s),{id:o,data:e.slice(n,r)}}static getNullTerminatorLength(e){return e==="utf-16le"?2:1}}const DE=new TextDecoder("ascii");class Kr{constructor(){this.tokenizer=void 0,this.id3Header=void 0,this.metadata=void 0,this.headerType=void 0,this.options=void 0}static removeUnsyncBytes(e){let n=0,r=0;for(;n<e.length-1;)n!==r&&(e[r]=e[n]),n+=e[n]===255&&e[n+1]===0?2:1,r++;return n<e.length&&(e[r++]=e[n]),e.slice(0,r)}static getFrameHeaderLength(e){switch(e){case 2:return 6;case 3:case 4:return 10;default:throw new Error("header versionIndex is incorrect")}}static readFrameFlags(e){return{status:{tag_alter_preservation:ft(e,0,6),file_alter_preservation:ft(e,0,5),read_only:ft(e,0,4)},format:{grouping_identity:ft(e,1,7),compression:ft(e,1,3),encryption:ft(e,1,2),unsynchronisation:ft(e,1,1),data_length_indicator:ft(e,1,0)}}}static readFrameData(e,n,r,s,i){var l,c;const o=new ir(r,i);switch(r){case 2:return o.readData(e,n.id,s);case 3:case 4:return(l=n.flags)!=null&&l.format.unsynchronisation&&(e=Kr.removeUnsyncBytes(e)),(c=n.flags)!=null&&c.format.data_length_indicator&&(e=e.slice(4,e.length)),o.readData(e,n.id,s);default:throw new Error(`Unexpected majorVer: ${r}`)}}static makeDescriptionTagName(e,n){return e+(n?`:${n}`:"")}async parse(e,n,r){this.tokenizer=n,this.metadata=e,this.options=r;const s=await this.tokenizer.readToken(Xx);if(s.fileIdentifier!=="ID3")throw new Error("expected ID3-header file-identifier 'ID3' was not found");return this.id3Header=s,this.headerType=`ID3v2.${s.version.major}`,s.flags.isExtendedHeader?this.parseExtendedHeader():this.parseId3Data(s.size)}async parseExtendedHeader(){const e=await this.tokenizer.readToken(IE),n=e.size-IE.len;return n>0?this.parseExtendedHeaderData(n,e.size):this.parseId3Data(this.id3Header.size-e.size)}async parseExtendedHeaderData(e,n){return await this.tokenizer.ignore(e),this.parseId3Data(this.id3Header.size-n)}async parseId3Data(e){const n=await this.tokenizer.readToken(new Hn(e));for(const r of this.parseMetadata(n))switch(r.id){case"TXXX":r.value&&await this.handleTag(r,r.value.text,()=>r.value.description);break;default:await(Array.isArray(r.value)?Promise.all(r.value.map(s=>this.addTag(r.id,s))):this.addTag(r.id,r.value))}}async handleTag(e,n,r,s=i=>i){await Promise.all(n.map(i=>this.addTag(Kr.makeDescriptionTagName(e.id,r(i)),s(i))))}async addTag(e,n){await this.metadata.addTag(this.headerType,e,n)}parseMetadata(e){let n=0;const r=[];for(;n!==e.length;){const s=Kr.getFrameHeaderLength(this.id3Header.version.major);if(n+s>e.length){this.metadata.addWarning("Illegal ID3v2 tag length");break}const i=e.slice(n,n+s);n+=s;const o=this.readFrameHeader(i,this.id3Header.version.major),l=e.slice(n,n+o.length);n+=o.length;const c=Kr.readFrameData(l,o,this.id3Header.version.major,!this.options.skipCovers,this.metadata);c&&r.push({id:o.id,value:c})}return r}readFrameHeader(e,n){let r;switch(n){case 2:r={id:DE.decode(e.slice(0,3)),length:Pn.get(e,3)},r.id.match(/[A-Z0-9]{3}/g)||this.metadata.addWarning(`Invalid ID3v2.${this.id3Header.version.major} frame-header-ID: ${r.id}`);break;case 3:case 4:r={id:DE.decode(e.slice(0,4)),length:(n===4?VN:ue).get(e,4),flags:Kr.readFrameFlags(e.slice(8,10))},r.id.match(/[A-Z0-9]{4}/g)||this.metadata.addWarning(`Invalid ID3v2.${this.id3Header.version.major} frame-header-ID: ${r.id}`);break;default:throw new Error(`Unexpected majorVer: ${n}`)}return r}}const wK={NONE:"not compressed	PCM	Apple Computer",sowt:"PCM (byte swapped)",fl32:"32-bit floating point IEEE 32-bit float",fl64:"64-bit floating point IEEE 64-bit float	Apple Computer",alaw:"ALaw 2:1	8-bit ITU-T G.711 A-law",ulaw:"µLaw 2:1	8-bit ITU-T G.711 µ-law	Apple Computer",ULAW:"CCITT G.711 u-law 8-bit ITU-T G.711 µ-law",ALAW:"CCITT G.711 A-law 8-bit ITU-T G.711 A-law",FL32:"Float 32	IEEE 32-bit float "};class _K{constructor(e,n){this.isAifc=n;const r=n?22:18;if(e.chunkSize<r)throw new Error(`COMMON CHUNK size should always be at least ${r}`);this.len=e.chunkSize}get(e,n){const r=Ge.get(e,n+8)-16398,s=Ge.get(e,n+8+2),i={numChannels:Ge.get(e,n),numSampleFrames:ue.get(e,n+2),sampleSize:Ge.get(e,n+6),sampleRate:r<0?s>>Math.abs(r):s<<r};if(this.isAifc){if(i.compressionType=tt.get(e,n+18),this.len>22){const o=ke.get(e,n+22);if(o>0){const l=(o+1)%2;if(23+o+l===this.len)i.compressionName=new ae(o,"latin1").get(e,n+23);else throw new Error("Illegal pstring length")}else i.compressionName=void 0}}else i.compressionName="PCM";return i}}const Wg={len:8,get:(t,e)=>({chunkID:tt.get(t,e),chunkSize:Number(BigInt(ue.get(t,e+4)))})},qg=Ke("music-metadata:parser:aiff");class SK extends br{constructor(){super(...arguments),this.isCompressed=null}async parse(){if((await this.tokenizer.readToken(Wg)).chunkID!=="FORM")throw new Error("Invalid Chunk-ID, expected 'FORM'");const n=await this.tokenizer.readToken(tt);switch(n){case"AIFF":this.metadata.setFormat("container",n),this.isCompressed=!1;break;case"AIFC":this.metadata.setFormat("container","AIFF-C"),this.isCompressed=!0;break;default:throw new Error(`Unsupported AIFF type: ${n}`)}this.metadata.setFormat("lossless",!this.isCompressed);try{for(;!this.tokenizer.fileInfo.size||this.tokenizer.fileInfo.size-this.tokenizer.position>=Wg.len;){qg(`Reading AIFF chunk at offset=${this.tokenizer.position}`);const r=await this.tokenizer.readToken(Wg),s=2*Math.round(r.chunkSize/2),i=await this.readData(r);await this.tokenizer.ignore(s-i)}}catch(r){if(r instanceof vt)qg("End-of-stream");else throw r}}async readData(e){switch(e.chunkID){case"COMM":{if(this.isCompressed===null)throw new Error("Failed to parse AIFF.COMM chunk when compression type is unknown");const n=await this.tokenizer.readToken(new _K(e,this.isCompressed));return this.metadata.setFormat("bitsPerSample",n.sampleSize),this.metadata.setFormat("sampleRate",n.sampleRate),this.metadata.setFormat("numberOfChannels",n.numChannels),this.metadata.setFormat("numberOfSamples",n.numSampleFrames),this.metadata.setFormat("duration",n.numSampleFrames/n.sampleRate),(n.compressionName||n.compressionType)&&this.metadata.setFormat("codec",n.compressionName??wK[n.compressionType]),e.chunkSize}case"ID3 ":{const n=await this.tokenizer.readToken(new Hn(e.chunkSize)),r=kl(n);return await new Kr().parse(this.metadata,r,this.options),e.chunkSize}case"SSND":return this.metadata.format.duration&&this.metadata.setFormat("bitrate",8*e.chunkSize/this.metadata.format.duration),0;case"NAME":case"AUTH":case"(c) ":case"ANNO":return this.readTextChunk(e);default:return qg(`Ignore chunk id=${e.chunkID}, size=${e.chunkSize}`),0}}async readTextChunk(e){const r=(await this.tokenizer.readToken(new ae(e.chunkSize,"ascii"))).split("\0").map(s=>s.trim()).filter(s=>s==null?void 0:s.length);return await Promise.all(r.map(s=>this.metadata.addTag("AIFF",e.chunkID,s))),e.chunkSize}}class z{static fromBin(e,n=0){return new z(z.decode(e,n))}static decode(e,n=0){const r=new DataView(e.buffer,n);return`${r.getUint32(0,!0).toString(16)}-${r.getUint16(4,!0).toString(16)}-${r.getUint16(6,!0).toString(16)}-${r.getUint16(8).toString(16)}-${Gw(e.slice(n+10,n+16))}`.toUpperCase()}static decodeMediaType(e){switch(e.str){case z.AudioMedia.str:return"audio";case z.VideoMedia.str:return"video";case z.CommandMedia.str:return"command";case z.Degradable_JPEG_Media.str:return"degradable-jpeg";case z.FileTransferMedia.str:return"file-transfer";case z.BinaryMedia.str:return"binary"}}static encode(e){const n=new Uint8Array(16),r=new DataView(n.buffer);return r.setUint32(0,Number.parseInt(e.slice(0,8),16),!0),r.setUint16(4,Number.parseInt(e.slice(9,13),16),!0),r.setUint16(6,Number.parseInt(e.slice(14,18),16),!0),n.set(_E(e.slice(19,23)),8),n.set(_E(e.slice(24)),10),n}constructor(e){this.str=e}equals(e){return this.str===e.str}toBin(){return z.encode(this.str)}}z.HeaderObject=new z("75B22630-668E-11CF-A6D9-00AA0062CE6C");z.DataObject=new z("75B22636-668E-11CF-A6D9-00AA0062CE6C");z.SimpleIndexObject=new z("33000890-E5B1-11CF-89F4-00A0C90349CB");z.IndexObject=new z("D6E229D3-35DA-11D1-9034-00A0C90349BE");z.MediaObjectIndexObject=new z("FEB103F8-12AD-4C64-840F-2A1D2F7AD48C");z.TimecodeIndexObject=new z("3CB73FD0-0C4A-4803-953D-EDF7B6228F0C");z.FilePropertiesObject=new z("8CABDCA1-A947-11CF-8EE4-00C00C205365");z.StreamPropertiesObject=new z("B7DC0791-A9B7-11CF-8EE6-00C00C205365");z.HeaderExtensionObject=new z("5FBF03B5-A92E-11CF-8EE3-00C00C205365");z.CodecListObject=new z("86D15240-311D-11D0-A3A4-00A0C90348F6");z.ScriptCommandObject=new z("1EFB1A30-0B62-11D0-A39B-00A0C90348F6");z.MarkerObject=new z("F487CD01-A951-11CF-8EE6-00C00C205365");z.BitrateMutualExclusionObject=new z("D6E229DC-35DA-11D1-9034-00A0C90349BE");z.ErrorCorrectionObject=new z("75B22635-668E-11CF-A6D9-00AA0062CE6C");z.ContentDescriptionObject=new z("75B22633-668E-11CF-A6D9-00AA0062CE6C");z.ExtendedContentDescriptionObject=new z("D2D0A440-E307-11D2-97F0-00A0C95EA850");z.ContentBrandingObject=new z("2211B3FA-BD23-11D2-B4B7-00A0C955FC6E");z.StreamBitratePropertiesObject=new z("7BF875CE-468D-11D1-8D82-006097C9A2B2");z.ContentEncryptionObject=new z("2211B3FB-BD23-11D2-B4B7-00A0C955FC6E");z.ExtendedContentEncryptionObject=new z("298AE614-2622-4C17-B935-DAE07EE9289C");z.DigitalSignatureObject=new z("2211B3FC-BD23-11D2-B4B7-00A0C955FC6E");z.PaddingObject=new z("1806D474-CADF-4509-A4BA-9AABCB96AAE8");z.ExtendedStreamPropertiesObject=new z("14E6A5CB-C672-4332-8399-A96952065B5A");z.AdvancedMutualExclusionObject=new z("A08649CF-4775-4670-8A16-6E35357566CD");z.GroupMutualExclusionObject=new z("D1465A40-5A79-4338-B71B-E36B8FD6C249");z.StreamPrioritizationObject=new z("D4FED15B-88D3-454F-81F0-ED5C45999E24");z.BandwidthSharingObject=new z("A69609E6-517B-11D2-B6AF-00C04FD908E9");z.LanguageListObject=new z("7C4346A9-EFE0-4BFC-B229-393EDE415C85");z.MetadataObject=new z("C5F8CBEA-5BAF-4877-8467-AA8C44FA4CCA");z.MetadataLibraryObject=new z("44231C94-9498-49D1-A141-1D134E457054");z.IndexParametersObject=new z("D6E229DF-35DA-11D1-9034-00A0C90349BE");z.MediaObjectIndexParametersObject=new z("6B203BAD-3F11-48E4-ACA8-D7613DE2CFA7");z.TimecodeIndexParametersObject=new z("F55E496D-9797-4B5D-8C8B-604DFE9BFB24");z.CompatibilityObject=new z("26F18B5D-4584-47EC-9F5F-0E651F0452C9");z.AdvancedContentEncryptionObject=new z("43058533-6981-49E6-9B74-AD12CB86D58C");z.AudioMedia=new z("F8699E40-5B4D-11CF-A8FD-00805F5C442B");z.VideoMedia=new z("BC19EFC0-5B4D-11CF-A8FD-00805F5C442B");z.CommandMedia=new z("59DACFC0-59E6-11D0-A3AC-00A0C90348F6");z.JFIF_Media=new z("B61BE100-5B4E-11CF-A8FD-00805F5C442B");z.Degradable_JPEG_Media=new z("35907DE0-E415-11CF-A917-00805F5C442B");z.FileTransferMedia=new z("91BD222C-F21C-497A-8B6D-5AA86BFC0185");z.BinaryMedia=new z("3AFB65E2-47EF-40F2-AC2C-70A90D71D343");z.ASF_Index_Placeholder_Object=new z("D9AADE20-7C17-4F9C-BC28-8555DD98E2A2");function bK(t){return EK[t]}function gp(t){return Ni(At(t,"utf-16le"))}const EK=[gp,LE,kK,jK,TK,GN,LE];function LE(t){return new Uint8Array(t)}function kK(t,e=0){return GN(t,e)===1}function jK(t,e=0){return ne.get(t,e)}function TK(t,e=0){return Cn.get(t,e)}function GN(t,e=0){return Ve.get(t,e)}var OE;(function(t){t[t.UnicodeString=0]="UnicodeString",t[t.ByteArray=1]="ByteArray",t[t.Bool=2]="Bool",t[t.DWord=3]="DWord",t[t.QWord=4]="QWord",t[t.Word=5]="Word"})(OE||(OE={}));const IK={len:30,get:(t,e)=>({objectId:z.fromBin(t,e),objectSize:Number(Cn.get(t,e+16)),numberOfHeaderObjects:ne.get(t,e+24)})},ka={len:24,get:(t,e)=>({objectId:z.fromBin(t,e),objectSize:Number(Cn.get(t,e+16))})};class go{constructor(e){this.len=Number(e.objectSize)-ka.len}postProcessTag(e,n,r,s){if(n==="WM/Picture")e.push({id:n,value:Xw.fromBuffer(s)});else{const i=bK(r);if(!i)throw new Error(`unexpected value headerType: ${r}`);e.push({id:n,value:i(s)})}}}class $E extends go{get(e,n){return null}}class Jx extends go{get(e,n){return{fileId:z.fromBin(e,n),fileSize:Cn.get(e,n+16),creationDate:Cn.get(e,n+24),dataPacketsCount:Cn.get(e,n+32),playDuration:Cn.get(e,n+40),sendDuration:Cn.get(e,n+48),preroll:Cn.get(e,n+56),flags:{broadcast:ft(e,n+64,24),seekable:ft(e,n+64,25)},minimumDataPacketSize:ne.get(e,n+68),maximumDataPacketSize:ne.get(e,n+72),maximumBitrate:ne.get(e,n+76)}}}Jx.guid=z.FilePropertiesObject;class Zx extends go{get(e,n){return{streamType:z.decodeMediaType(z.fromBin(e,n)),errorCorrectionType:z.fromBin(e,n+8)}}}Zx.guid=z.StreamPropertiesObject;class ey{constructor(){this.len=22}get(e,n){const r=new DataView(e.buffer,n);return{reserved1:z.fromBin(e,n),reserved2:r.getUint16(16,!0),extensionDataSize:r.getUint16(18,!0)}}}ey.guid=z.HeaderExtensionObject;const CK={len:20,get:(t,e)=>({entryCount:new DataView(t.buffer,e).getUint16(16,!0)})};async function zE(t){const e=await t.readNumber(Ve);return(await t.readToken(new ae(e*2,"utf-16le"))).replace("\0","")}async function RK(t){const e=await t.readToken(CK),n=[];for(let r=0;r<e.entryCount;++r)n.push(await AK(t));return n}async function NK(t){const e=await t.readNumber(Ve),n=new Uint8Array(e);return await t.readBuffer(n),n}async function AK(t){const e=await t.readNumber(Ve);return{type:{videoCodec:(e&1)===1,audioCodec:(e&2)===2},codecName:await zE(t),description:await zE(t),information:await NK(t)}}class eo extends go{get(e,n){const r=[],s=new DataView(e.buffer,n);let i=10;for(let o=0;o<eo.contentDescTags.length;++o){const l=s.getUint16(o*2,!0);if(l>0){const c=eo.contentDescTags[o],u=i+l;r.push({id:c,value:gp(e.slice(n+i,n+u))}),i=u}}return r}}eo.guid=z.ContentDescriptionObject;eo.contentDescTags=["Title","Author","Copyright","Description","Rating"];class ty extends go{get(e,n){const r=[],s=new DataView(e.buffer,n),i=s.getUint16(0,!0);let o=2;for(let l=0;l<i;l+=1){const c=s.getUint16(o,!0);o+=2;const u=gp(e.slice(n+o,n+o+c));o+=c;const d=s.getUint16(o,!0);o+=2;const m=s.getUint16(o,!0);o+=2;const p=e.slice(n+o,n+o+m);o+=m,this.postProcessTag(r,u,d,p)}return r}}ty.guid=z.ExtendedContentDescriptionObject;class ny extends go{get(e,n){const r=new DataView(e.buffer,n);return{startTime:Cn.get(e,n),endTime:Cn.get(e,n+8),dataBitrate:r.getInt32(12,!0),bufferSize:r.getInt32(16,!0),initialBufferFullness:r.getInt32(20,!0),alternateDataBitrate:r.getInt32(24,!0),alternateBufferSize:r.getInt32(28,!0),alternateInitialBufferFullness:r.getInt32(32,!0),maximumObjectSize:r.getInt32(36,!0),flags:{reliableFlag:ft(e,n+40,0),seekableFlag:ft(e,n+40,1),resendLiveCleanpointsFlag:ft(e,n+40,2)},streamNumber:r.getInt16(42,!0),streamLanguageId:r.getInt16(44,!0),averageTimePerFrame:r.getInt32(52,!0),streamNameCount:r.getInt32(54,!0),payloadExtensionSystems:r.getInt32(56,!0),streamNames:[],streamPropertiesObject:null}}}ny.guid=z.ExtendedStreamPropertiesObject;class Vf extends go{get(e,n){const r=[],s=new DataView(e.buffer,n),i=s.getUint16(0,!0);let o=2;for(let l=0;l<i;l+=1){o+=4;const c=s.getUint16(o,!0);o+=2;const u=s.getUint16(o,!0);o+=2;const d=s.getUint32(o,!0);o+=4;const m=gp(e.slice(n+o,n+o+c));o+=c;const p=e.slice(n+o,n+o+d);o+=d,this.postProcessTag(r,m,u,p)}return r}}Vf.guid=z.MetadataObject;class ry extends Vf{}ry.guid=z.MetadataLibraryObject;class Xw{static fromBuffer(e){return new Xw(e.length).get(e,0)}constructor(e){this.len=e}get(e,n){const r=new DataView(e.buffer,n),s=r.getUint8(0),i=r.getInt32(1,!0);let o=5;for(;r.getUint16(o)!==0;)o+=2;const l=new ae(o-5,"utf-16le").get(e,5);for(;r.getUint16(o)!==0;)o+=2;const c=new ae(o-5,"utf-16le").get(e,5);return{type:Su[s],format:l,description:c,size:i,data:e.slice(o+4)}}}const nh=Ke("music-metadata:parser:ASF"),PK="asf";class FK extends br{async parse(){const e=await this.tokenizer.readToken(IK);if(!e.objectId.equals(z.HeaderObject))throw new Error(`expected asf header; but was not found; got: ${e.objectId.str}`);try{await this.parseObjectHeader(e.numberOfHeaderObjects)}catch(n){nh("Error while parsing ASF: %s",n)}}async parseObjectHeader(e){let n;do{const r=await this.tokenizer.readToken(ka);switch(nh("header GUID=%s",r.objectId.str),r.objectId.str){case Jx.guid.str:{const s=await this.tokenizer.readToken(new Jx(r));this.metadata.setFormat("duration",Number(s.playDuration/BigInt(1e3))/1e4-Number(s.preroll)/1e3),this.metadata.setFormat("bitrate",s.maximumBitrate);break}case Zx.guid.str:{const s=await this.tokenizer.readToken(new Zx(r));this.metadata.setFormat("container",`ASF/${s.streamType}`);break}case ey.guid.str:{const s=await this.tokenizer.readToken(new ey);await this.parseExtensionObject(s.extensionDataSize);break}case eo.guid.str:n=await this.tokenizer.readToken(new eo(r)),await this.addTags(n);break;case ty.guid.str:n=await this.tokenizer.readToken(new ty(r)),await this.addTags(n);break;case z.CodecListObject.str:{const s=await RK(this.tokenizer);s.forEach(o=>{this.metadata.addStreamInfo({type:o.type.videoCodec?Za.video:Za.audio,codecName:o.codecName})});const i=s.filter(o=>o.type.audioCodec).map(o=>o.codecName).join("/");this.metadata.setFormat("codec",i);break}case z.StreamBitratePropertiesObject.str:await this.tokenizer.ignore(r.objectSize-ka.len);break;case z.PaddingObject.str:nh("Padding: %s bytes",r.objectSize-ka.len),await this.tokenizer.ignore(r.objectSize-ka.len);break;default:this.metadata.addWarning(`Ignore ASF-Object-GUID: ${r.objectId.str}`),nh("Ignore ASF-Object-GUID: %s",r.objectId.str),await this.tokenizer.readToken(new $E(r))}}while(--e)}async addTags(e){await Promise.all(e.map(({id:n,value:r})=>this.metadata.addTag(PK,n,r)))}async parseExtensionObject(e){do{const n=await this.tokenizer.readToken(ka),r=n.objectSize-ka.len;switch(n.objectId.str){case ny.guid.str:await this.tokenizer.readToken(new ny(n));break;case Vf.guid.str:{const s=await this.tokenizer.readToken(new Vf(n));await this.addTags(s);break}case ry.guid.str:{const s=await this.tokenizer.readToken(new ry(n));await this.addTags(s);break}case z.PaddingObject.str:await this.tokenizer.ignore(r);break;case z.CompatibilityObject.str:this.tokenizer.ignore(r);break;case z.ASF_Index_Placeholder_Object.str:await this.tokenizer.ignore(r);break;default:this.metadata.addWarning(`Ignore ASF-Object-GUID: ${n.objectId.str}`),await this.tokenizer.readToken(new $E(n));break}e-=n.objectSize}while(e>0)}}class bu{static fromBase64(e){return bu.fromBuffer(Uint8Array.from(atob(e),n=>n.charCodeAt(0)))}static fromBuffer(e){return new bu(e.length).get(e,0)}constructor(e){this.len=e}get(e,n){const r=Su[ue.get(e,n)];n+=4;const s=ue.get(e,n);n+=4;const i=new ae(s,"utf-8").get(e,n);n+=s;const o=ue.get(e,n);n+=4;const l=new ae(o,"utf-8").get(e,n);n+=o;const c=ue.get(e,n);n+=4;const u=ue.get(e,n);n+=4;const d=ue.get(e,n);n+=4;const m=ue.get(e,n);n+=4;const p=ue.get(e,n);n+=4;const g=Uint8Array.from(e.slice(n,n+p));return{type:r,format:i,description:l,width:c,height:u,colour_depth:d,indexed_color:m,data:g}}}const rh={len:7,get:(t,e)=>({packetType:ke.get(t,e),vorbis:new ae(6,"ascii").get(t,e+1)})},MK={len:23,get:(t,e)=>({version:ne.get(t,e+0),channelMode:ke.get(t,e+4),sampleRate:ne.get(t,e+5),bitrateMax:ne.get(t,e+9),bitrateNominal:ne.get(t,e+13),bitrateMin:ne.get(t,e+17)})},Kg=Ke("music-metadata:parser:ID3");class xp extends br{constructor(){super(...arguments),this.id3parser=new Kr}static async startsWithID3v2Header(e){return(await e.peekToken(Xx)).fileIdentifier==="ID3"}async parse(){try{await this.parseID3v2()}catch(e){if(e instanceof vt)Kg("End-of-stream");else throw e}}finalize(){}async parseID3v2(){await this.tryReadId3v2Headers(),Kg("End of ID3v2 header, go to MPEG-parser: pos=%s",this.tokenizer.position),await this.postId3v2Parse(),this.options.skipPostHeaders&&this.metadata.hasAny()?this.finalize():(await new Qw().init(this.metadata,this.tokenizer,this.options).parse(),this.finalize())}async tryReadId3v2Headers(){if((await this.tokenizer.peekToken(Xx)).fileIdentifier==="ID3")return Kg("Found ID3v2 header, pos=%s",this.tokenizer.position),await this.id3parser.parse(this.metadata,this.tokenizer,this.options),this.tryReadId3v2Headers()}}class WN{constructor(e,n){this.data=e,this.offset=n}readInt32(){const e=ne.get(this.data,this.offset);return this.offset+=4,e}readStringUtf8(){const e=this.readInt32(),n=new TextDecoder("utf-8").decode(this.data.subarray(this.offset,this.offset+e));return this.offset+=e,n}parseUserComment(){const e=this.offset,n=this.readStringUtf8(),r=n.indexOf("=");return{key:n.slice(0,r).toUpperCase(),value:n.slice(r+1),len:this.offset-e}}}const jo=Ke("music-metadata:parser:ogg:vorbis1");class to{constructor(e,n){this.metadata=e,this.options=n,this.pageSegments=[]}async parsePage(e,n){if(e.headerType.firstPage)this.parseFirstPage(e,n);else{if(e.headerType.continued){if(this.pageSegments.length===0)throw new Error("Cannot continue on previous page");this.pageSegments.push(n)}if(e.headerType.lastPage||!e.headerType.continued){if(this.pageSegments.length>0){const r=to.mergeUint8Arrays(this.pageSegments);await this.parseFullPage(r)}this.pageSegments=e.headerType.lastPage?[]:[n]}}e.headerType.lastPage&&this.calculateDuration(e)}static mergeUint8Arrays(e){const n=e.reduce((s,i)=>s+i.length,0),r=new Uint8Array(n);return e.forEach((s,i,o)=>{const l=o.slice(0,i).reduce((c,u)=>c+u.length,0);r.set(s,l)}),r}async flush(){await this.parseFullPage(to.mergeUint8Arrays(this.pageSegments))}async parseUserComment(e,n){const s=new WN(e,n).parseUserComment();return await this.addTag(s.key,s.value),s.len}async addTag(e,n){if(e==="METADATA_BLOCK_PICTURE"&&typeof n=="string"){if(this.options.skipCovers){jo("Ignore picture");return}n=bu.fromBase64(n),jo(`Push picture: id=${e}, format=${n.format}`)}else jo(`Push tag: id=${e}, value=${n}`);await this.metadata.addTag("vorbis",e,n)}calculateDuration(e){this.metadata.format.sampleRate&&e.absoluteGranulePosition>=0&&(this.metadata.setFormat("numberOfSamples",e.absoluteGranulePosition),this.metadata.setFormat("duration",e.absoluteGranulePosition/this.metadata.format.sampleRate))}parseFirstPage(e,n){this.metadata.setFormat("codec","Vorbis I"),jo("Parse first page");const r=rh.get(n,0);if(r.vorbis!=="vorbis")throw new Error("Metadata does not look like Vorbis");if(r.packetType===1){const s=MK.get(n,rh.len);this.metadata.setFormat("sampleRate",s.sampleRate),this.metadata.setFormat("bitrate",s.bitrateNominal),this.metadata.setFormat("numberOfChannels",s.channelMode),jo("sample-rate=%s[hz], bitrate=%s[b/s], channel-mode=%s",s.sampleRate,s.bitrateNominal,s.channelMode)}else throw new Error("First Ogg page should be type 1: the identification header")}async parseFullPage(e){const n=rh.get(e,0);switch(jo("Parse full page: type=%s, byteLength=%s",n.packetType,e.byteLength),n.packetType){case 3:return this.parseUserCommentList(e,rh.len)}}async parseUserCommentList(e,n){const r=ne.get(e,n);n+=4,n+=r;let s=ne.get(e,n);for(n+=4;s-- >0;)n+=await this.parseUserComment(e,n)}}const DK=Ke("music-metadata:parser:FLAC");var Ds;(function(t){t[t.STREAMINFO=0]="STREAMINFO",t[t.PADDING=1]="PADDING",t[t.APPLICATION=2]="APPLICATION",t[t.SEEKTABLE=3]="SEEKTABLE",t[t.VORBIS_COMMENT=4]="VORBIS_COMMENT",t[t.CUESHEET=5]="CUESHEET",t[t.PICTURE=6]="PICTURE"})(Ds||(Ds={}));class LK extends xp{constructor(){super(...arguments),this.padding=0}init(e,n,r){return super.init(e,n,r),this.vorbisParser=new to(e,r),this}async postId3v2Parse(){if((await this.tokenizer.readToken(tt)).toString()!=="fLaC")throw new Error("Invalid FLAC preamble");let n;do n=await this.tokenizer.readToken(OK),await this.parseDataBlock(n);while(!n.lastBlock);if(this.tokenizer.fileInfo.size&&this.metadata.format.duration){const r=this.tokenizer.fileInfo.size-this.tokenizer.position;this.metadata.setFormat("bitrate",8*r/this.metadata.format.duration)}}async parseDataBlock(e){switch(DK(`blockHeader type=${e.type}, length=${e.length}`),e.type){case Ds.STREAMINFO:return this.parseBlockStreamInfo(e.length);case Ds.PADDING:this.padding+=e.length;break;case Ds.APPLICATION:break;case Ds.SEEKTABLE:break;case Ds.VORBIS_COMMENT:return this.parseComment(e.length);case Ds.CUESHEET:break;case Ds.PICTURE:await this.parsePicture(e.length);return;default:this.metadata.addWarning(`Unknown block type: ${e.type}`)}return this.tokenizer.ignore(e.length).then()}async parseBlockStreamInfo(e){if(e!==BE.len)throw new Error("Unexpected block-stream-info length");const n=await this.tokenizer.readToken(BE);this.metadata.setFormat("container","FLAC"),this.metadata.setFormat("codec","FLAC"),this.metadata.setFormat("lossless",!0),this.metadata.setFormat("numberOfChannels",n.channels),this.metadata.setFormat("bitsPerSample",n.bitsPerSample),this.metadata.setFormat("sampleRate",n.sampleRate),n.totalSamples>0&&this.metadata.setFormat("duration",n.totalSamples/n.sampleRate)}async parseComment(e){const n=await this.tokenizer.readToken(new Hn(e)),r=new WN(n,0);r.readStringUtf8();const s=r.readInt32(),i=new Array(s);for(let o=0;o<s;o++)i[o]=r.parseUserComment();await Promise.all(i.map(o=>this.vorbisParser.addTag(o.key,o.value)))}async parsePicture(e){if(this.options.skipCovers)return this.tokenizer.ignore(e);const n=await this.tokenizer.readToken(new bu(e));this.vorbisParser.addTag("METADATA_BLOCK_PICTURE",n)}}const OK={len:4,get:(t,e)=>({lastBlock:ft(t,e,7),type:Fe(t,e,1,7),length:Pn.get(t,e+1)})},BE={len:34,get:(t,e)=>({minimumBlockSize:Ge.get(t,e),maximumBlockSize:Ge.get(t,e+2)/1e3,minimumFrameSize:Pn.get(t,e+4),maximumFrameSize:Pn.get(t,e+7),sampleRate:Pn.get(t,e+10)>>4,channels:Fe(t,e+12,4,3)+1,bitsPerSample:Fe(t,e+12,7,5)+1,totalSamples:Fe(t,e+13,4,36),fileMD5:new Hn(16).get(t,e+18)})},qN=Ke("music-metadata:parser:MP4:atom"),Uf={len:8,get:(t,e)=>{const n=ue.get(t,e);if(n<0)throw new Error("Invalid atom header length");return{length:BigInt(n),name:new ae(4,"latin1").get(t,e+4)}},put:(t,e,n)=>(ue.put(t,e,Number(n.length)),tt.put(t,e+4,n.name))},$K=Uw,VE={len:4,get:(t,e)=>({type:new ae(4,"ascii").get(t,e)})};class KN{constructor(e,n,r){if(this.len=e,e<n)throw new Error(`Atom ${r} expected to be ${n}, but specifies ${e} bytes long.`);e>n&&qN(`Warning: atom ${r} expected to be ${n}, but was actually ${e} bytes long.`)}}const jl={len:4,get:(t,e)=>{const n=ue.get(t,e)-2082844800;return new Date(n*1e3)}};class zK extends KN{constructor(e){super(e,24,"mdhd"),this.len=e}get(e,n){return{version:ke.get(e,n+0),flags:Pn.get(e,n+1),creationTime:jl.get(e,n+4),modificationTime:jl.get(e,n+8),timeScale:ue.get(e,n+12),duration:ue.get(e,n+16),language:Ge.get(e,n+20),quality:Ge.get(e,n+22)}}}class BK extends KN{constructor(e){super(e,100,"mvhd"),this.len=e}get(e,n){return{version:ke.get(e,n),flags:Pn.get(e,n+1),creationTime:jl.get(e,n+4),modificationTime:jl.get(e,n+8),timeScale:ue.get(e,n+12),duration:ue.get(e,n+16),preferredRate:ue.get(e,n+20),preferredVolume:Ge.get(e,n+24),previewTime:ue.get(e,n+72),previewDuration:ue.get(e,n+76),posterTime:ue.get(e,n+80),selectionTime:ue.get(e,n+84),selectionDuration:ue.get(e,n+88),currentTime:ue.get(e,n+92),nextTrackID:ue.get(e,n+96)}}}class VK{constructor(e){this.len=e}get(e,n){return{type:{set:ke.get(e,n+0),type:Pn.get(e,n+1)},locale:Pn.get(e,n+4),value:new Hn(this.len-8).get(e,n+8)}}}class UK{constructor(e){this.len=e}get(e,n){return{version:ke.get(e,n),flags:Pn.get(e,n+1),name:new ae(this.len-4,"utf-8").get(e,n+4)}}}class HK{constructor(e){this.len=e}get(e,n){return{version:ke.get(e,n),flags:Pn.get(e,n+1),creationTime:jl.get(e,n+4),modificationTime:jl.get(e,n+8),trackId:ue.get(e,n+12),duration:ue.get(e,n+20),layer:Ge.get(e,n+24),alternateGroup:Ge.get(e,n+26),volume:Ge.get(e,n+28)}}}const UE={len:8,get:(t,e)=>({version:ke.get(t,e),flags:Pn.get(t,e+1),numberOfEntries:ue.get(t,e+4)})};class GK{constructor(e){this.len=e}get(e,n){return{dataFormat:tt.get(e,n),dataReferenceIndex:Ge.get(e,n+10),description:new Hn(this.len-12).get(e,n+12)}}}class WK{constructor(e){this.len=e}get(e,n){const r=UE.get(e,n);n+=UE.len;const s=[];for(let i=0;i<r.numberOfEntries;++i){const o=ue.get(e,n);n+=ue.len,s.push(new GK(o).get(e,n)),n+=o}return{header:r,table:s}}}const HE={len:8,get(t,e){return{version:Gs.get(t,e),revision:Gs.get(t,e+2),vendor:pr.get(t,e+4)}}},qK={len:12,get(t,e){return{numAudioChannels:Gs.get(t,e+0),sampleSize:Gs.get(t,e+2),compressionId:Gs.get(t,e+4),packetSize:Gs.get(t,e+6),sampleRate:Ge.get(t,e+8)+Ge.get(t,e+10)/1e4}}};class Yw{constructor(e,n){this.len=e,this.token=n}get(e,n){const r=pr.get(e,n+4);return{version:_u.get(e,n+0),flags:Vw.get(e,n+1),numberOfEntries:r,entries:QN(e,this.token,n+8,this.len-8,r)}}}const KK={len:8,get(t,e){return{count:pr.get(t,e+0),duration:pr.get(t,e+4)}}};class QK extends Yw{constructor(e){super(e,KK),this.len=e}}const XK={len:12,get(t,e){return{firstChunk:pr.get(t,e),samplesPerChunk:pr.get(t,e+4),sampleDescriptionId:pr.get(t,e+8)}}};class YK extends Yw{constructor(e){super(e,XK),this.len=e}}class JK{constructor(e){this.len=e}get(e,n){const r=pr.get(e,n+8);return{version:_u.get(e,n),flags:Vw.get(e,n+1),sampleSize:pr.get(e,n+4),numberOfEntries:r,entries:QN(e,pr,n+12,this.len-12,r)}}}class ZK extends Yw{constructor(e){super(e,pr),this.len=e}}class eQ{constructor(e){this.len=e}get(e,n){const r=Gs.get(e,n+0);return new ae(r,"utf-8").get(e,n+2)}}function QN(t,e,n,r,s){if(qN(`remainingLen=${r}, numberOfEntries=${s} * token-len=${e.len}`),r===0)return[];if(r!==s*e.len)throw new Error("mismatch number-of-entries with remaining atom-length");const i=[];for(let o=0;o<s;++o)i.push(e.get(t,n)),n+=e.len;return i}const tQ=Ke("music-metadata:parser:MP4:Atom");class Hf{static async readAtom(e,n,r,s){const i=e.position,o=await e.readToken(Uf);o.length===BigInt(1)&&(o.length=await e.readToken($K));const c=new Hf(o,o.length===BigInt(1),r),u=c.getPayloadLength(s);return tQ(`parse atom name=${c.atomPath}, extended=${c.extended}, offset=${i}, len=${c.header.length}`),await c.readData(e,n,u),c}constructor(e,n,r){this.header=e,this.extended=n,this.parent=r,this.children=[],this.atomPath=(this.parent?`${this.parent.atomPath}.`:"")+this.header.name}getHeaderLength(){return this.extended?16:8}getPayloadLength(e){return(this.header.length===BigInt(0)?e:Number(this.header.length))-this.getHeaderLength()}async readAtoms(e,n,r){for(;r>0;){const s=await Hf.readAtom(e,n,this,r);this.children.push(s),r-=s.header.length===BigInt(0)?r:Number(s.header.length)}}async readData(e,n,r){switch(this.header.name){case"moov":case"udta":case"trak":case"mdia":case"minf":case"stbl":case"<id>":case"ilst":case"tref":return this.readAtoms(e,n,this.getPayloadLength(r));case"meta":{const i=(await e.peekToken(Uf)).name==="hdlr"?0:4;return await e.ignore(i),this.readAtoms(e,n,this.getPayloadLength(r)-i)}default:return n(this,r)}}}const ds=Ke("music-metadata:parser:MP4"),nQ="iTunes",GE={raw:{lossy:!1,format:"raw"},MAC3:{lossy:!0,format:"MACE 3:1"},MAC6:{lossy:!0,format:"MACE 6:1"},ima4:{lossy:!0,format:"IMA 4:1"},ulaw:{lossy:!0,format:"uLaw 2:1"},alaw:{lossy:!0,format:"uLaw 2:1"},Qclp:{lossy:!0,format:"QUALCOMM PureVoice"},".mp3":{lossy:!0,format:"MPEG-1 layer 3"},alac:{lossy:!1,format:"ALAC"},"ac-3":{lossy:!0,format:"AC-3"},mp4a:{lossy:!0,format:"MPEG-4/AAC"},mp4s:{lossy:!0,format:"MP4S"},c608:{lossy:!0,format:"CEA-608"},c708:{lossy:!0,format:"CEA-708"}};function WE(t,e,n){return n.indexOf(t)===e}class Gf extends br{constructor(){super(...arguments),this.tracks=[],this.atomParsers={mvhd:async e=>{const n=await this.tokenizer.readToken(new BK(e));this.metadata.setFormat("creationTime",n.creationTime),this.metadata.setFormat("modificationTime",n.modificationTime)},mdhd:async e=>{const n=await this.tokenizer.readToken(new zK(e)),r=this.getTrackDescription();r.creationTime=n.creationTime,r.modificationTime=n.modificationTime,r.timeScale=n.timeScale,r.duration=n.duration},chap:async e=>{const n=this.getTrackDescription(),r=[];for(;e>=ue.len;)r.push(await this.tokenizer.readNumber(ue)),e-=ue.len;n.chapterList=r},tkhd:async e=>{const n=await this.tokenizer.readToken(new HK(e));this.tracks.push(n)},mdat:async e=>{if(this.audioLengthInBytes=e,this.calculateBitRate(),this.options.includeChapters){const n=this.tracks.filter(r=>r.chapterList);if(n.length===1){const r=n[0].chapterList,s=this.tracks.filter(i=>r.indexOf(i.trackId)!==-1);if(s.length===1)return this.parseChapterTrack(s[0],n[0],e)}}await this.tokenizer.ignore(e)},ftyp:async e=>{const n=[];for(;e>0;){const s=await this.tokenizer.readToken(VE);e-=VE.len;const i=s.type.replace(/\W/g,"");i.length>0&&n.push(i)}ds(`ftyp: ${n.join("/")}`);const r=n.filter(WE).join("/");this.metadata.setFormat("container",r)},stsd:async e=>{const n=await this.tokenizer.readToken(new WK(e)),r=this.getTrackDescription();r.soundSampleDescription=n.table.map(s=>this.parseSoundSampleDescription(s))},stsc:async e=>{const n=await this.tokenizer.readToken(new YK(e));this.getTrackDescription().sampleToChunkTable=n.entries},stts:async e=>{const n=await this.tokenizer.readToken(new QK(e));this.getTrackDescription().timeToSampleTable=n.entries},stsz:async e=>{const n=await this.tokenizer.readToken(new JK(e)),r=this.getTrackDescription();r.sampleSize=n.sampleSize,r.sampleSizeTable=n.entries},stco:async e=>{const n=await this.tokenizer.readToken(new ZK(e));this.getTrackDescription().chunkOffsetTable=n.entries},date:async e=>{const n=await this.tokenizer.readToken(new ae(e,"utf-8"));await this.addTag("date",n)}}}static read_BE_Integer(e,n){const r=(n?"INT":"UINT")+e.length*8+(e.length>1?"_BE":""),s=cq[r];if(!s)throw new Error(`Token for integer type not found: "${r}"`);return Number(s.get(e,0))}async parse(){this.tracks=[];let e=this.tokenizer.fileInfo.size||0;for(;!this.tokenizer.fileInfo.size||e>0;){try{if((await this.tokenizer.peekToken(Uf)).name==="\0\0\0\0"){const o=`Error at offset=${this.tokenizer.position}: box.id=0`;ds(o),this.addWarning(o);break}}catch(i){if(i instanceof Error){const o=`Error at offset=${this.tokenizer.position}: ${i.message}`;ds(o),this.addWarning(o)}else throw i;break}const s=await Hf.readAtom(this.tokenizer,(i,o)=>this.handleAtom(i,o),null,e);e-=s.header.length===BigInt(0)?e:Number(s.header.length)}const n=[];this.tracks.forEach(s=>{const i=[];s.soundSampleDescription.forEach(o=>{const l={},c=GE[o.dataFormat];if(c?(i.push(c.format),l.codecName=c.format):l.codecName=`<${o.dataFormat}>`,o.description){const{description:u}=o;u.sampleRate>0&&(l.type=Za.audio,l.audio={samplingFrequency:u.sampleRate,bitDepth:u.sampleSize,channels:u.numAudioChannels})}this.metadata.addStreamInfo(l)}),i.length>=1&&n.push(i.join("/"))}),n.length>0&&this.metadata.setFormat("codec",n.filter(WE).join("+"));const r=this.tracks.filter(s=>s.soundSampleDescription.length>=1&&s.soundSampleDescription[0].description&&s.soundSampleDescription[0].description.numAudioChannels>0);if(r.length>=1){const s=r[0];if(s.timeScale>0){const l=s.duration/s.timeScale;this.metadata.setFormat("duration",l)}const i=s.soundSampleDescription[0];if(i.description&&(this.metadata.setFormat("sampleRate",i.description.sampleRate),this.metadata.setFormat("bitsPerSample",i.description.sampleSize),this.metadata.setFormat("numberOfChannels",i.description.numAudioChannels),s.timeScale===0&&s.timeToSampleTable.length>0)){const c=s.timeToSampleTable.map(u=>u.count*u.duration).reduce((u,d)=>u+d)/i.description.sampleRate;this.metadata.setFormat("duration",c)}const o=GE[i.dataFormat];o&&this.metadata.setFormat("lossless",!o.lossy),this.calculateBitRate()}}async handleAtom(e,n){if(e.parent)switch(e.parent.header.name){case"ilst":case"<id>":return this.parseMetadataItemData(e)}if(this.atomParsers[e.header.name])return this.atomParsers[e.header.name](n);ds(`No parser for atom path=${e.atomPath}, payload-len=${n}, ignoring atom`),await this.tokenizer.ignore(n)}getTrackDescription(){return this.tracks[this.tracks.length-1]}calculateBitRate(){this.audioLengthInBytes&&this.metadata.format.duration&&this.metadata.setFormat("bitrate",8*this.audioLengthInBytes/this.metadata.format.duration)}async addTag(e,n){await this.metadata.addTag(nQ,e,n)}addWarning(e){ds(`Warning: ${e}`),this.metadata.addWarning(e)}parseMetadataItemData(e){let n=e.header.name;return e.readAtoms(this.tokenizer,async(r,s)=>{const i=r.getPayloadLength(s);switch(r.header.name){case"data":return this.parseValueAtom(n,r);case"name":case"mean":case"rate":{const o=await this.tokenizer.readToken(new UK(i));n+=`:${o.name}`;break}default:{const o=await this.tokenizer.readToken(new Hn(i));this.addWarning(`Unsupported meta-item: ${n}[${r.header.name}] => value=${Gw(o)} ascii=${Hw(o,"ascii")}`)}}},e.getPayloadLength(0))}async parseValueAtom(e,n){const r=await this.tokenizer.readToken(new VK(Number(n.header.length)-Uf.len));if(r.type.set!==0)throw new Error(`Unsupported type-set != 0: ${r.type.set}`);switch(r.type.type){case 0:switch(e){case"trkn":case"disk":{const s=ke.get(r.value,3),i=ke.get(r.value,5);await this.addTag(e,`${s}/${i}`);break}case"gnre":{const s=ke.get(r.value,1),i=Bf[s-1];await this.addTag(e,i);break}case"rate":{const s=new TextDecoder("ascii").decode(r.value);await this.addTag(e,s);break}default:ds(`unknown proprietary value type for: ${n.atomPath}`)}break;case 1:case 18:await this.addTag(e,new TextDecoder("utf-8").decode(r.value));break;case 13:if(this.options.skipCovers)break;await this.addTag(e,{format:"image/jpeg",data:Uint8Array.from(r.value)});break;case 14:if(this.options.skipCovers)break;await this.addTag(e,{format:"image/png",data:Uint8Array.from(r.value)});break;case 21:await this.addTag(e,Gf.read_BE_Integer(r.value,!0));break;case 22:await this.addTag(e,Gf.read_BE_Integer(r.value,!1));break;case 65:await this.addTag(e,ke.get(r.value,0));break;case 66:await this.addTag(e,Ge.get(r.value,0));break;case 67:await this.addTag(e,ue.get(r.value,0));break;default:this.addWarning(`atom key=${e}, has unknown well-known-type (data-type): ${r.type.type}`)}}parseSoundSampleDescription(e){const n={dataFormat:e.dataFormat,dataReferenceIndex:e.dataReferenceIndex};let r=0;const s=HE.get(e.description,r);return r+=HE.len,s.version===0||s.version===1?n.description=qK.get(e.description,r):ds(`Warning: sound-sample-description ${s} not implemented`),n}async parseChapterTrack(e,n,r){if(!e.sampleSize&&e.chunkOffsetTable.length!==e.sampleSizeTable.length)throw new Error("Expected equal chunk-offset-table & sample-size-table length.");const s=[];for(let i=0;i<e.chunkOffsetTable.length&&r>0;++i){const l=e.chunkOffsetTable[i]-this.tokenizer.position,c=e.sampleSize>0?e.sampleSize:e.sampleSizeTable[i];if(r-=l+c,r<0)throw new Error("Chapter chunk exceeding token length");await this.tokenizer.ignore(l);const u=await this.tokenizer.readToken(new eQ(c));ds(`Chapter ${i+1}: ${u}`);const d={title:u,sampleOffset:this.findSampleOffset(n,this.tokenizer.position)};ds(`Chapter title=${d.title}, offset=${d.sampleOffset}/${this.tracks[0].duration}`),s.push(d)}this.metadata.setFormat("chapters",s),await this.tokenizer.ignore(r)}findSampleOffset(e,n){let r=0;e.timeToSampleTable.forEach(i=>{r+=i.count*i.duration}),ds(`Total duration=${r}`);let s=0;for(;s<e.chunkOffsetTable.length&&e.chunkOffsetTable[s]<n;)++s;return this.getChunkDuration(s+1,e)}getChunkDuration(e,n){let r=0,s=n.timeToSampleTable[r].count,i=n.timeToSampleTable[r].duration,o=1,l=this.getSamplesPerChunk(o,n.sampleToChunkTable),c=0;for(;o<e;){const u=Math.min(s,l);c+=u*i,s-=u,l-=u,l===0?(++o,l=this.getSamplesPerChunk(o,n.sampleToChunkTable)):(++r,s=n.timeToSampleTable[r].count,i=n.timeToSampleTable[r].duration)}return c}getSamplesPerChunk(e,n){for(let r=0;r<n.length-1;++r)if(e>=n[r].firstChunk&&e<n[r+1].firstChunk)return n[r].samplesPerChunk;return n[n.length-1].samplesPerChunk}}var qE;(function(t){t[t.not_set=0]="not_set",t[t.radio=1]="radio",t[t.audiophile=2]="audiophile"})(qE||(qE={}));var KE;(function(t){t[t.unspecified=0]="unspecified",t[t.engineer=1]="engineer",t[t.user=2]="user",t[t.automatic=3]="automatic",t[t.rms_average=4]="rms_average"})(KE||(KE={}));const QE={len:2,get:(t,e)=>{const n=Fe(t,e,0,3),r=Fe(t,e,6,1),s=Fe(t,e,7,9)/10;if(n>0)return{type:Fe(t,e,0,3),origin:Fe(t,e,3,3),adjustment:r?-s:s}}},rQ={len:27,get:(t,e)=>{const n=ue.get(t,e+2);return{revision:Fe(t,e,0,4),vbr_method:Fe(t,e,4,4),lowpass_filter:100*ke.get(t,e+1),track_peak:n===0?null:n/2**23,track_gain:QE.get(t,6),album_gain:QE.get(t,8),music_length:ue.get(t,e+20),music_crc:ke.get(t,e+24),header_crc:Ge.get(t,e+24)}}},XE=new ae(4,"ascii"),Qg=new ae(6,"ascii"),sQ={len:4,get:(t,e)=>({frames:cr(t,e,31),bytes:cr(t,e,30),toc:cr(t,e,29),vbrScale:cr(t,e,28)})};async function iQ(t){const e=await t.readToken(sQ),n={numFrames:null,streamSize:null,vbrScale:null};if(e.frames&&(n.numFrames=await t.readToken(ue)),e.bytes&&(n.streamSize=await t.readToken(ue)),e.toc&&(n.toc=new Uint8Array(100),await t.readBuffer(n.toc)),e.vbrScale&&(n.vbrScale=await t.readToken(ue)),await t.peekToken(new ae(4,"ascii"))==="LAME"){await t.ignore(4),n.lame={version:await t.readToken(new ae(5,"ascii"))};const s=n.lame.version.match(/\d+.\d+/g);if(s!==null){const o=s[0].split(".").map(l=>Number.parseInt(l,10));o[0]>=3&&o[1]>=90&&(n.lame.extended=await t.readToken(rQ))}}return n}const ar=Ke("music-metadata:parser:mpeg"),YE=1024,JE={AudioObjectTypes:["AAC Main","AAC LC","AAC SSR","AAC LTP"],SamplingFrequencies:[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350,null,null,-1]},aQ=[void 0,["front-center"],["front-left","front-right"],["front-center","front-left","front-right"],["front-center","front-left","front-right","back-center"],["front-center","front-left","front-right","back-left","back-right"],["front-center","front-left","front-right","back-left","back-right","LFE-channel"],["front-center","front-left","front-right","side-left","side-right","back-left","back-right","LFE-channel"]];class Ut{constructor(e,n){this.bitrateIndex=null,this.sampRateFreqIndex=null,this.padding=null,this.privateBit=null,this.channelModeIndex=null,this.modeExtension=null,this.isOriginalMedia=null,this.version=null,this.bitrate=null,this.samplingRate=null,this.frameLength=0,this.versionIndex=Fe(e,n+1,3,2),this.layer=Ut.LayerDescription[Fe(e,n+1,5,2)],this.versionIndex>1&&this.layer===0?this.parseAdtsHeader(e,n):this.parseMpegHeader(e,n),this.isProtectedByCRC=!cr(e,n+1,7)}calcDuration(e){return this.samplingRate==null?null:e*this.calcSamplesPerFrame()/this.samplingRate}calcSamplesPerFrame(){return Ut.samplesInFrameTable[this.version===1?0:1][this.layer]}calculateSideInfoLength(){if(this.layer!==3)return 2;if(this.channelModeIndex===3){if(this.version===1)return 17;if(this.version===2||this.version===2.5)return 9}else{if(this.version===1)return 32;if(this.version===2||this.version===2.5)return 17}return null}calcSlotSize(){return[null,4,1,1][this.layer]}parseMpegHeader(e,n){this.container="MPEG",this.bitrateIndex=Fe(e,n+2,0,4),this.sampRateFreqIndex=Fe(e,n+2,4,2),this.padding=cr(e,n+2,6),this.privateBit=cr(e,n+2,7),this.channelModeIndex=Fe(e,n+3,0,2),this.modeExtension=Fe(e,n+3,2,2),this.isCopyrighted=cr(e,n+3,4),this.isOriginalMedia=cr(e,n+3,5),this.emphasis=Fe(e,n+3,7,2),this.version=Ut.VersionID[this.versionIndex],this.channelMode=Ut.ChannelMode[this.channelModeIndex],this.codec=`MPEG ${this.version} Layer ${this.layer}`;const r=this.calcBitrate();if(!r)throw new Error("Cannot determine bit-rate");if(this.bitrate=r*1e3,this.samplingRate=this.calcSamplingRate(),this.samplingRate==null)throw new Error("Cannot determine sampling-rate")}parseAdtsHeader(e,n){ar("layer=0 => ADTS"),this.version=this.versionIndex===2?4:2,this.container=`ADTS/MPEG-${this.version}`;const r=Fe(e,n+2,0,2);this.codec="AAC",this.codecProfile=JE.AudioObjectTypes[r],ar(`MPEG-4 audio-codec=${this.codec}`);const s=Fe(e,n+2,2,4);this.samplingRate=JE.SamplingFrequencies[s],ar(`sampling-rate=${this.samplingRate}`);const i=Fe(e,n+2,7,3);this.mp4ChannelConfig=aQ[i],ar(`channel-config=${this.mp4ChannelConfig?this.mp4ChannelConfig.join("+"):"?"}`),this.frameLength=Fe(e,n+3,6,2)<<11}calcBitrate(){if(this.bitrateIndex===0||this.bitrateIndex===15)return null;if(this.version&&this.bitrateIndex){const e=10*Math.floor(this.version)+this.layer;return Ut.bitrate_index[this.bitrateIndex][e]}return null}calcSamplingRate(){return this.sampRateFreqIndex===3||this.version===null||this.sampRateFreqIndex==null?null:Ut.sampling_rate_freq_index[this.version][this.sampRateFreqIndex]}}Ut.SyncByte1=255;Ut.SyncByte2=224;Ut.VersionID=[2.5,null,2,1];Ut.LayerDescription=[0,3,2,1];Ut.ChannelMode=["stereo","joint_stereo","dual_channel","mono"];Ut.bitrate_index={1:{11:32,12:32,13:32,21:32,22:8,23:8},2:{11:64,12:48,13:40,21:48,22:16,23:16},3:{11:96,12:56,13:48,21:56,22:24,23:24},4:{11:128,12:64,13:56,21:64,22:32,23:32},5:{11:160,12:80,13:64,21:80,22:40,23:40},6:{11:192,12:96,13:80,21:96,22:48,23:48},7:{11:224,12:112,13:96,21:112,22:56,23:56},8:{11:256,12:128,13:112,21:128,22:64,23:64},9:{11:288,12:160,13:128,21:144,22:80,23:80},10:{11:320,12:192,13:160,21:160,22:96,23:96},11:{11:352,12:224,13:192,21:176,22:112,23:112},12:{11:384,12:256,13:224,21:192,22:128,23:128},13:{11:416,12:320,13:256,21:224,22:144,23:144},14:{11:448,12:384,13:320,21:256,22:160,23:160}};Ut.sampling_rate_freq_index={1:{0:44100,1:48e3,2:32e3},2:{0:22050,1:24e3,2:16e3},2.5:{0:11025,1:12e3,2:8e3}};Ut.samplesInFrameTable=[[0,384,1152,1152],[0,384,1152,576]];const ZE={len:4,get:(t,e)=>new Ut(t,e)};function oQ(t){return`V${Math.floor((100-t)/10)}`}class lQ extends xp{constructor(){super(...arguments),this.frameCount=0,this.syncFrameCount=-1,this.countSkipFrameData=0,this.totalDataLength=0,this.bitrates=[],this.offset=0,this.frame_size=0,this.crc=null,this.calculateEofDuration=!1,this.samplesPerFrame=null,this.buf_frame_header=new Uint8Array(4),this.mpegOffset=null,this.syncPeek={buf:new Uint8Array(YE),len:0}}async postId3v2Parse(){this.metadata.setFormat("lossless",!1);try{let e=!1;for(;!e;)await this.sync(),e=await this.parseCommonMpegHeader()}catch(e){if(e instanceof vt){if(ar("End-of-stream"),this.calculateEofDuration&&this.samplesPerFrame!==null){const n=this.frameCount*this.samplesPerFrame;if(this.metadata.setFormat("numberOfSamples",n),this.metadata.format.sampleRate){const r=n/this.metadata.format.sampleRate;ar(`Calculate duration at EOF: ${r} sec.`,r),this.metadata.setFormat("duration",r)}}}else throw e}}finalize(){const e=this.metadata.format,n=!!this.metadata.native.ID3v1;if(this.mpegOffset!==null){if(e.duration&&this.tokenizer.fileInfo.size){const r=this.tokenizer.fileInfo.size-this.mpegOffset-(n?128:0);e.codecProfile&&e.codecProfile[0]==="V"&&this.metadata.setFormat("bitrate",r*8/e.duration)}else if(this.tokenizer.fileInfo.size&&e.codecProfile==="CBR"){const r=this.tokenizer.fileInfo.size-this.mpegOffset-(n?128:0);if(this.frame_size!==null&&this.samplesPerFrame!==null){const s=Math.round(r/this.frame_size)*this.samplesPerFrame;if(this.metadata.setFormat("numberOfSamples",s),e.sampleRate){const i=s/e.sampleRate;ar("Calculate CBR duration based on file size: %s",i),this.metadata.setFormat("duration",i)}}}}}async sync(){let e=!1;for(;;){let n=0;if(this.syncPeek.len=await this.tokenizer.peekBuffer(this.syncPeek.buf,{length:YE,mayBeLess:!0}),this.syncPeek.len<=163)throw new vt;for(;;){if(e&&(this.syncPeek.buf[n]&224)===224){this.buf_frame_header[0]=Ut.SyncByte1,this.buf_frame_header[1]=this.syncPeek.buf[n],await this.tokenizer.ignore(n),ar(`Sync at offset=${this.tokenizer.position-1}, frameCount=${this.frameCount}`),this.syncFrameCount===this.frameCount&&(ar(`Re-synced MPEG stream, frameCount=${this.frameCount}`),this.frameCount=0,this.frame_size=0),this.syncFrameCount=this.frameCount;return}if(e=!1,n=this.syncPeek.buf.indexOf(Ut.SyncByte1,n),n===-1){if(this.syncPeek.len<this.syncPeek.buf.length)throw new vt;await this.tokenizer.ignore(this.syncPeek.len);break}++n,e=!0}}}async parseCommonMpegHeader(){this.frameCount===0&&(this.mpegOffset=this.tokenizer.position-1),await this.tokenizer.peekBuffer(this.buf_frame_header,{offset:1,length:3});let e;try{e=ZE.get(this.buf_frame_header,0)}catch(n){if(await this.tokenizer.ignore(1),n instanceof Error)return this.metadata.addWarning(`Parse error: ${n.message}`),!1;throw n}return await this.tokenizer.ignore(3),this.metadata.setFormat("container",e.container),this.metadata.setFormat("codec",e.codec),this.metadata.setFormat("lossless",!1),this.metadata.setFormat("sampleRate",e.samplingRate),this.frameCount++,e.version!==null&&e.version>=2&&e.layer===0?this.parseAdts(e):this.parseAudioFrameHeader(e)}async parseAudioFrameHeader(e){this.metadata.setFormat("numberOfChannels",e.channelMode==="mono"?1:2),this.metadata.setFormat("bitrate",e.bitrate),this.frameCount<20*1e4&&ar("offset=%s MP%s bitrate=%s sample-rate=%s",this.tokenizer.position-4,e.layer,e.bitrate,e.samplingRate);const n=e.calcSlotSize();if(n===null)throw new Error("invalid slot_size");const r=e.calcSamplesPerFrame();ar(`samples_per_frame=${r}`);const s=r/8;if(e.bitrate!==null&&e.samplingRate!=null){const i=s*e.bitrate/e.samplingRate+(e.padding?n:0);this.frame_size=Math.floor(i)}if(this.audioFrameHeader=e,e.bitrate!==null&&this.bitrates.push(e.bitrate),this.frameCount===1)return this.offset=ZE.len,await this.skipSideInformation(),!1;if(this.frameCount===3){if(this.areAllSame(this.bitrates)){if(this.samplesPerFrame=r,this.metadata.setFormat("codecProfile","CBR"),this.tokenizer.fileInfo.size)return!0}else if(this.metadata.format.duration)return!0;if(!this.options.duration)return!0}return this.options.duration&&this.frameCount===4&&(this.samplesPerFrame=r,this.calculateEofDuration=!0),this.offset=4,e.isProtectedByCRC?(await this.parseCrc(),!1):(await this.skipSideInformation(),!1)}async parseAdts(e){const n=new Uint8Array(3);if(await this.tokenizer.readBuffer(n),e.frameLength+=Fe(n,0,0,11),this.totalDataLength+=e.frameLength,this.samplesPerFrame=1024,e.samplingRate!==null){const r=e.samplingRate/this.samplesPerFrame,i=8*(this.frameCount===0?0:this.totalDataLength/this.frameCount)*r+.5;this.metadata.setFormat("bitrate",i),ar(`frame-count=${this.frameCount}, size=${e.frameLength} bytes, bit-rate=${i}`)}if(await this.tokenizer.ignore(e.frameLength>7?e.frameLength-7:1),this.frameCount===3)if(this.metadata.setFormat("codecProfile",e.codecProfile),e.mp4ChannelConfig&&this.metadata.setFormat("numberOfChannels",e.mp4ChannelConfig.length),this.options.duration)this.calculateEofDuration=!0;else return!0;return!1}async parseCrc(){return this.crc=await this.tokenizer.readNumber(Gs),this.offset+=2,this.skipSideInformation()}async skipSideInformation(){if(this.audioFrameHeader){const e=this.audioFrameHeader.calculateSideInfoLength();if(e!==null){await this.tokenizer.readToken(new Hn(e)),this.offset+=e,await this.readXtraInfoHeader();return}}}async readXtraInfoHeader(){const e=await this.tokenizer.readToken(XE);switch(this.offset+=XE.len,e){case"Info":return this.metadata.setFormat("codecProfile","CBR"),this.readXingInfoHeader();case"Xing":{const r=await this.readXingInfoHeader();if(r.vbrScale!==null){const s=oQ(r.vbrScale);this.metadata.setFormat("codecProfile",s)}return null}case"Xtra":break;case"LAME":{const r=await this.tokenizer.readToken(Qg);if(this.frame_size!==null&&this.frame_size>=this.offset+Qg.len)return this.offset+=Qg.len,this.metadata.setFormat("tool",`LAME ${r}`),await this.skipFrameData(this.frame_size-this.offset),null;this.metadata.addWarning("Corrupt LAME header");break}}const n=this.frame_size-this.offset;return n<0?this.metadata.addWarning(`Frame ${this.frameCount}corrupt: negative frameDataLeft`):await this.skipFrameData(n),null}async readXingInfoHeader(){const e=this.tokenizer.position,n=await iQ(this.tokenizer);if(this.offset+=this.tokenizer.position-e,n.lame&&(this.metadata.setFormat("tool",`LAME ${Ni(n.lame.version)}`),n.lame.extended&&(this.metadata.setFormat("trackPeakLevel",n.lame.extended.track_peak),n.lame.extended.track_gain&&this.metadata.setFormat("trackGain",n.lame.extended.track_gain.adjustment),n.lame.extended.album_gain&&this.metadata.setFormat("albumGain",n.lame.extended.album_gain.adjustment),this.metadata.setFormat("duration",n.lame.extended.music_length/1e3))),n.streamSize&&this.audioFrameHeader&&n.numFrames!==null){const s=this.audioFrameHeader.calcDuration(n.numFrames);return this.metadata.setFormat("duration",s),ar("Get duration from Xing header: %s",this.metadata.format.duration),n}const r=this.frame_size-this.offset;return await this.skipFrameData(r),n}async skipFrameData(e){if(e<0)throw new Error("frame-data-left cannot be negative");await this.tokenizer.ignore(e),this.countSkipFrameData+=e}areAllSame(e){const n=e[0];return e.every(r=>r===n)}}const e2=Ke("music-metadata:parser:musepack:sv8"),cQ=new ae(2,"latin1"),t2={len:5,get:(t,e)=>({crc:ne.get(t,e),streamVersion:ke.get(t,e+4)})},n2={len:2,get:(t,e)=>({sampleFrequency:[44100,48e3,37800,32e3][Fe(t,e,0,3)],maxUsedBands:Fe(t,e,3,5),channelCount:Fe(t,e+1,0,4)+1,msUsed:cr(t,e+1,4),audioBlockFrames:Fe(t,e+1,5,3)})};class uQ{constructor(e){this.tokenizer=e}async readPacketHeader(){const e=await this.tokenizer.readToken(cQ),n=await this.readVariableSizeField();return{key:e,payloadLength:n.value-2-n.len}}async readStreamHeader(e){const n={};e2(`Reading SH at offset=${this.tokenizer.position}`);const r=await this.tokenizer.readToken(t2);e-=t2.len,Object.assign(n,r),e2(`SH.streamVersion = ${r.streamVersion}`);const s=await this.readVariableSizeField();e-=s.len,n.sampleCount=s.value;const i=await this.readVariableSizeField();e-=i.len,n.beginningOfSilence=i.value;const o=await this.tokenizer.readToken(n2);return e-=n2.len,Object.assign(n,o),await this.tokenizer.ignore(e),n}async readVariableSizeField(e=1,n=0){let r=await this.tokenizer.readNumber(ke);return r&128?(r&=127,r+=n,this.readVariableSizeField(e+1,r<<7)):{len:e,value:n+r}}}const dQ=Ke("music-metadata:parser:musepack");class hQ extends br{constructor(){super(...arguments),this.audioLength=0}async parse(){if(await this.tokenizer.readToken(tt)!=="MPCK")throw new Error("Invalid Magic number");return this.metadata.setFormat("container","Musepack, SV8"),this.parsePacket()}async parsePacket(){const e=new uQ(this.tokenizer);do{const n=await e.readPacketHeader();switch(dQ(`packet-header key=${n.key}, payloadLength=${n.payloadLength}`),n.key){case"SH":{const r=await e.readStreamHeader(n.payloadLength);this.metadata.setFormat("numberOfSamples",r.sampleCount),this.metadata.setFormat("sampleRate",r.sampleFrequency),this.metadata.setFormat("duration",r.sampleCount/r.sampleFrequency),this.metadata.setFormat("numberOfChannels",r.channelCount);break}case"AP":this.audioLength+=n.payloadLength,await this.tokenizer.ignore(n.payloadLength);break;case"RG":case"EI":case"SO":case"ST":case"CT":await this.tokenizer.ignore(n.payloadLength);break;case"SE":return this.metadata.format.duration&&this.metadata.setFormat("bitrate",this.audioLength*8/this.metadata.format.duration),xs.tryParseApeHeader(this.metadata,this.tokenizer,this.options);default:throw new Error(`Unexpected header: ${n.key}`)}}while(!0)}}class fQ{constructor(e){this.tokenizer=e,this.pos=0,this.dword=null}async read(e){for(;this.dword===null;)this.dword=await this.tokenizer.readToken(ne);let n=this.dword;return this.pos+=e,this.pos<32?(n>>>=32-this.pos,n&(1<<e)-1):(this.pos-=32,this.pos===0?(this.dword=null,n&(1<<e)-1):(this.dword=await this.tokenizer.readToken(ne),this.pos&&(n<<=this.pos,n|=this.dword>>>32-this.pos),n&(1<<e)-1))}async ignore(e){if(this.pos>0){const s=32-this.pos;this.dword=null,e-=s,this.pos=0}const n=e%32,r=(e-n)/32;return await this.tokenizer.ignore(r*4),this.read(n)}}const mQ={len:6*4,get:(t,e)=>{const n={signature:new TextDecoder("latin1").decode(t.subarray(e,e+3)),streamMinorVersion:Fe(t,e+3,0,4),streamMajorVersion:Fe(t,e+3,4,4),frameCount:ne.get(t,e+4),maxLevel:Ve.get(t,e+8),sampleFrequency:[44100,48e3,37800,32e3][Fe(t,e+10,0,2)],link:Fe(t,e+10,2,2),profile:Fe(t,e+10,4,4),maxBand:Fe(t,e+11,0,6),intensityStereo:cr(t,e+11,6),midSideStereo:cr(t,e+11,7),titlePeak:Ve.get(t,e+12),titleGain:Ve.get(t,e+14),albumPeak:Ve.get(t,e+16),albumGain:Ve.get(t,e+18),lastFrameLength:ne.get(t,e+20)>>>20&2047,trueGapless:cr(t,e+23,0)};return n.lastFrameLength=n.trueGapless?ne.get(t,20)>>>20&2047:0,n}},r2=Ke("music-metadata:parser:musepack");class pQ extends br{constructor(){super(...arguments),this.bitreader=null,this.audioLength=0,this.duration=null}async parse(){const e=await this.tokenizer.readToken(mQ);if(e.signature!=="MP+")throw new Error("Unexpected magic number");r2(`stream-version=${e.streamMajorVersion}.${e.streamMinorVersion}`),this.metadata.setFormat("container","Musepack, SV7"),this.metadata.setFormat("sampleRate",e.sampleFrequency);const n=1152*(e.frameCount-1)+e.lastFrameLength;this.metadata.setFormat("numberOfSamples",n),this.duration=n/e.sampleFrequency,this.metadata.setFormat("duration",this.duration),this.bitreader=new fQ(this.tokenizer),this.metadata.setFormat("numberOfChannels",e.midSideStereo||e.intensityStereo?2:1);const r=await this.bitreader.read(8);return this.metadata.setFormat("codec",(r/100).toFixed(2)),await this.skipAudioData(e.frameCount),r2(`End of audio stream, switching to APEv2, offset=${this.tokenizer.position}`),xs.tryParseApeHeader(this.metadata,this.tokenizer,this.options)}async skipAudioData(e){for(;e-- >0;){const r=await this.bitreader.read(20);this.audioLength+=20+r,await this.bitreader.ignore(r)}const n=await this.bitreader.read(11);this.audioLength+=n,this.duration!==null&&this.metadata.setFormat("bitrate",this.audioLength/this.duration)}}const s2=Ke("music-metadata:parser:musepack");class gQ extends xp{async postId3v2Parse(){const e=await this.tokenizer.peekToken(new ae(3,"latin1"));let n;switch(e){case"MP+":{s2("Musepack stream-version 7"),n=new pQ;break}case"MPC":{s2("Musepack stream-version 8"),n=new hQ;break}default:throw new Error("Invalid Musepack signature prefix")}return n.init(this.metadata,this.tokenizer,this.options),n.parse()}}class xQ{constructor(e){if(this.len=e,e<19)throw new Error("ID-header-page 0 should be at least 19 bytes long")}get(e,n){return{magicSignature:new ae(8,"ascii").get(e,n+0),version:ke.get(e,n+8),channelCount:ke.get(e,n+9),preSkip:Ve.get(e,n+10),inputSampleRate:ne.get(e,n+12),outputGain:Ve.get(e,n+16),channelMapping:ke.get(e,n+18)}}}class yQ extends to{constructor(e,n,r){super(e,n),this.tokenizer=r,this.idHeader=null,this.lastPos=-1}parseFirstPage(e,n){if(this.metadata.setFormat("codec","Opus"),this.idHeader=new xQ(n.length).get(n,0),this.idHeader.magicSignature!=="OpusHead")throw new Error("Illegal ogg/Opus magic-signature");this.metadata.setFormat("sampleRate",this.idHeader.inputSampleRate),this.metadata.setFormat("numberOfChannels",this.idHeader.channelCount)}async parseFullPage(e){switch(new ae(8,"ascii").get(e,0)){case"OpusTags":await this.parseUserCommentList(e,8),this.lastPos=this.tokenizer.position-e.length;break}}calculateDuration(e){if(this.metadata.format.sampleRate&&e.absoluteGranulePosition>=0){const n=e.absoluteGranulePosition-this.idHeader.preSkip;if(this.metadata.setFormat("numberOfSamples",n),this.metadata.setFormat("duration",n/48e3),this.lastPos!==-1&&this.tokenizer.fileInfo.size&&this.metadata.format.duration){const r=this.tokenizer.fileInfo.size-this.lastPos;this.metadata.setFormat("bitrate",8*r/this.metadata.format.duration)}}}}const vQ={len:80,get:(t,e)=>({speex:new ae(8,"ascii").get(t,e+0),version:BN(new ae(20,"ascii").get(t,e+8)),version_id:gt.get(t,e+28),header_size:gt.get(t,e+32),rate:gt.get(t,e+36),mode:gt.get(t,e+40),mode_bitstream_version:gt.get(t,e+44),nb_channels:gt.get(t,e+48),bitrate:gt.get(t,e+52),frame_size:gt.get(t,e+56),vbr:gt.get(t,e+60),frames_per_packet:gt.get(t,e+64),extra_headers:gt.get(t,e+68),reserved1:gt.get(t,e+72),reserved2:gt.get(t,e+76)})},wQ=Ke("music-metadata:parser:ogg:speex");class _Q extends to{constructor(e,n,r){super(e,n),this.tokenizer=r}parseFirstPage(e,n){wQ("First Ogg/Speex page");const r=vQ.get(n,0);this.metadata.setFormat("codec",`Speex ${r.version}`),this.metadata.setFormat("numberOfChannels",r.nb_channels),this.metadata.setFormat("sampleRate",r.rate),r.bitrate!==-1&&this.metadata.setFormat("bitrate",r.bitrate)}}const SQ={len:42,get:(t,e)=>({id:new ae(7,"ascii").get(t,e),vmaj:ke.get(t,e+7),vmin:ke.get(t,e+8),vrev:ke.get(t,e+9),vmbw:Ge.get(t,e+10),vmbh:Ge.get(t,e+17),nombr:Pn.get(t,e+37),nqual:ke.get(t,e+40)})},Xg=Ke("music-metadata:parser:ogg:theora");class bQ{constructor(e,n,r){this.metadata=e,this.tokenizer=r}async parsePage(e,n){e.headerType.firstPage&&await this.parseFirstPage(e,n)}async flush(){Xg("flush")}calculateDuration(e){Xg("duration calculation not implemented")}async parseFirstPage(e,n){Xg("First Ogg/Theora page"),this.metadata.setFormat("codec","Theora");const r=SQ.get(n,0);this.metadata.setFormat("bitrate",r.nombr)}}const Fs=Ke("music-metadata:parser:ogg");class Jw{static sum(e,n,r){const s=new DataView(e.buffer,0);let i=0;for(let o=n;o<n+r;++o)i+=s.getUint8(o);return i}constructor(e){this.len=e.page_segments}get(e,n){return{totalPageSize:Jw.sum(e,n,this.len)}}}class yp extends br{constructor(){super(...arguments),this.header=null,this.pageNumber=0,this.pageConsumer=null}async parse(){Fs("pos=%s, parsePage()",this.tokenizer.position);try{let e;do{if(e=await this.tokenizer.readToken(yp.Header),e.capturePattern!=="OggS")throw new Error("Invalid Ogg capture pattern");this.metadata.setFormat("container","Ogg"),this.header=e,this.pageNumber=e.pageSequenceNo,Fs("page#=%s, Ogg.id=%s",e.pageSequenceNo,e.capturePattern);const n=await this.tokenizer.readToken(new Jw(e));Fs("totalPageSize=%s",n.totalPageSize);const r=await this.tokenizer.readToken(new Hn(n.totalPageSize));if(Fs("firstPage=%s, lastPage=%s, continued=%s",e.headerType.firstPage,e.headerType.lastPage,e.headerType.continued),e.headerType.firstPage){const s=new TextDecoder("ascii").decode(r.subarray(0,7));switch(s){case"vorbis":Fs("Set page consumer to Ogg/Vorbis"),this.pageConsumer=new to(this.metadata,this.options);break;case"OpusHea":Fs("Set page consumer to Ogg/Opus"),this.pageConsumer=new yQ(this.metadata,this.options,this.tokenizer);break;case"Speex  ":Fs("Set page consumer to Ogg/Speex"),this.pageConsumer=new _Q(this.metadata,this.options,this.tokenizer);break;case"fishead":case"\0theora":Fs("Set page consumer to Ogg/Theora"),this.pageConsumer=new bQ(this.metadata,this.options,this.tokenizer);break;default:throw new Error(`gg audio-codec not recognized (id=${s})`)}}await this.pageConsumer.parsePage(e,r)}while(!e.headerType.lastPage)}catch(e){if(e instanceof Error)e instanceof vt?(this.metadata.addWarning("Last OGG-page is not marked with last-page flag"),Fs("End-of-stream"),this.metadata.addWarning("Last OGG-page is not marked with last-page flag"),this.header&&this.pageConsumer.calculateDuration(this.header)):e.message.startsWith("FourCC")&&this.pageNumber>0&&(this.metadata.addWarning("Invalid FourCC ID, maybe last OGG-page is not marked with last-page flag"),await this.pageConsumer.flush());else throw e}}}yp.Header={len:27,get:(t,e)=>({capturePattern:tt.get(t,e),version:ke.get(t,e+4),headerType:{continued:ft(t,e+5,0),firstPage:ft(t,e+5,1),lastPage:ft(t,e+5,2)},absoluteGranulePosition:Number(Cn.get(t,e+6)),streamSerialNumber:ne.get(t,e+14),pageSequenceNo:ne.get(t,e+18),pageChecksum:ne.get(t,e+22),page_segments:ke.get(t,e+26)})};const gc={len:8,get:(t,e)=>({chunkID:new ae(4,"latin1").get(t,e),chunkSize:ne.get(t,e+4)})};class EQ{constructor(e){this.tagHeader=e,this.len=e.chunkSize,this.len+=this.len&1}get(e,n){return new ae(this.tagHeader.chunkSize,"ascii").get(e,n)}}var sy;(function(t){t[t.PCM=1]="PCM",t[t.ADPCM=2]="ADPCM",t[t.IEEE_FLOAT=3]="IEEE_FLOAT",t[t.MPEG_ADTS_AAC=5632]="MPEG_ADTS_AAC",t[t.MPEG_LOAS=5634]="MPEG_LOAS",t[t.RAW_AAC1=255]="RAW_AAC1",t[t.DOLBY_AC3_SPDIF=146]="DOLBY_AC3_SPDIF",t[t.DVM=8192]="DVM",t[t.RAW_SPORT=576]="RAW_SPORT",t[t.ESST_AC3=577]="ESST_AC3",t[t.DRM=9]="DRM",t[t.DTS2=8193]="DTS2",t[t.MPEG=80]="MPEG"})(sy||(sy={}));class kQ{constructor(e){if(e.chunkSize<16)throw new Error("Invalid chunk size");this.len=e.chunkSize}get(e,n){return{wFormatTag:Ve.get(e,n),nChannels:Ve.get(e,n+2),nSamplesPerSec:ne.get(e,n+4),nAvgBytesPerSec:ne.get(e,n+8),nBlockAlign:Ve.get(e,n+12),wBitsPerSample:Ve.get(e,n+14)}}}class jQ{constructor(e){if(e.chunkSize<4)throw new Error("Invalid fact chunk size.");this.len=e.chunkSize}get(e,n){return{dwSampleLength:ne.get(e,n)}}}const i2={len:420,get:(t,e)=>({description:Ni(new ae(256,"ascii").get(t,e)).trim(),originator:Ni(new ae(32,"ascii").get(t,e+256)).trim(),originatorReference:Ni(new ae(32,"ascii").get(t,e+288)).trim(),originationDate:Ni(new ae(10,"ascii").get(t,e+320)).trim(),originationTime:Ni(new ae(8,"ascii").get(t,e+330)).trim(),timeReferenceLow:ne.get(t,e+338),timeReferenceHigh:ne.get(t,e+342),version:Ve.get(t,e+346),umid:new Hn(64).get(t,e+348),loudnessValue:Ve.get(t,e+412),maxTruePeakLevel:Ve.get(t,e+414),maxMomentaryLoudness:Ve.get(t,e+416),maxShortTermLoudness:Ve.get(t,e+418)})},bi=Ke("music-metadata:parser:RIFF");class TQ extends br{constructor(){super(...arguments),this.blockAlign=0}async parse(){const e=await this.tokenizer.readToken(gc);if(bi(`pos=${this.tokenizer.position}, parse: chunkID=${e.chunkID}`),e.chunkID==="RIFF")return this.parseRiffChunk(e.chunkSize).catch(n=>{if(!(n instanceof vt))throw n})}async parseRiffChunk(e){const n=await this.tokenizer.readToken(tt);switch(this.metadata.setFormat("container",n),n){case"WAVE":return this.readWaveChunk(e-tt.len);default:throw new Error(`Unsupported RIFF format: RIFF/${n}`)}}async readWaveChunk(e){for(;e>=gc.len;){const n=await this.tokenizer.readToken(gc);switch(e-=gc.len+n.chunkSize,n.chunkSize>e&&this.metadata.addWarning("Data chunk size exceeds file size"),this.header=n,bi(`pos=${this.tokenizer.position}, readChunk: chunkID=RIFF/WAVE/${n.chunkID}`),n.chunkID){case"LIST":await this.parseListTag(n);break;case"fact":this.metadata.setFormat("lossless",!1),this.fact=await this.tokenizer.readToken(new jQ(n));break;case"fmt ":{const r=await this.tokenizer.readToken(new kQ(n));let s=sy[r.wFormatTag];s||(bi(`WAVE/non-PCM format=${r.wFormatTag}`),s=`non-PCM (${r.wFormatTag})`),this.metadata.setFormat("codec",s),this.metadata.setFormat("bitsPerSample",r.wBitsPerSample),this.metadata.setFormat("sampleRate",r.nSamplesPerSec),this.metadata.setFormat("numberOfChannels",r.nChannels),this.metadata.setFormat("bitrate",r.nBlockAlign*r.nSamplesPerSec*8),this.blockAlign=r.nBlockAlign;break}case"id3 ":case"ID3 ":{const r=await this.tokenizer.readToken(new Hn(n.chunkSize)),s=kl(r);await new Kr().parse(this.metadata,s,this.options);break}case"data":{this.metadata.format.lossless!==!1&&this.metadata.setFormat("lossless",!0);let r=n.chunkSize;if(this.tokenizer.fileInfo.size){const i=this.tokenizer.fileInfo.size-this.tokenizer.position;i<r&&(this.metadata.addWarning("data chunk length exceeding file length"),r=i)}const s=this.fact?this.fact.dwSampleLength:r===4294967295?void 0:r/this.blockAlign;s&&(this.metadata.setFormat("numberOfSamples",s),this.metadata.format.sampleRate&&this.metadata.setFormat("duration",s/this.metadata.format.sampleRate)),this.metadata.format.codec==="ADPCM"?this.metadata.setFormat("bitrate",352e3):this.metadata.format.sampleRate&&this.metadata.setFormat("bitrate",this.blockAlign*this.metadata.format.sampleRate*8),await this.tokenizer.ignore(n.chunkSize);break}case"bext":{const r=await this.tokenizer.readToken(i2);Object.keys(r).forEach(i=>{this.metadata.addTag("exif",`bext.${i}`,r[i])});const s=n.chunkSize-i2.len;await this.tokenizer.ignore(s);break}case"\0\0\0\0":bi(`Ignore padding chunk: RIFF/${n.chunkID} of ${n.chunkSize} bytes`),this.metadata.addWarning(`Ignore chunk: RIFF/${n.chunkID}`),await this.tokenizer.ignore(n.chunkSize);break;default:bi(`Ignore chunk: RIFF/${n.chunkID} of ${n.chunkSize} bytes`),this.metadata.addWarning(`Ignore chunk: RIFF/${n.chunkID}`),await this.tokenizer.ignore(n.chunkSize)}this.header.chunkSize%2===1&&(bi("Read odd padding byte"),await this.tokenizer.ignore(1))}}async parseListTag(e){const n=await this.tokenizer.readToken(new ae(4,"latin1"));switch(bi("pos=%s, parseListTag: chunkID=RIFF/WAVE/LIST/%s",this.tokenizer.position,n),n){case"INFO":return this.parseRiffInfoTags(e.chunkSize-4);default:return this.metadata.addWarning(`Ignore chunk: RIFF/WAVE/LIST/${n}`),bi(`Ignoring chunkID=RIFF/WAVE/LIST/${n}`),this.tokenizer.ignore(e.chunkSize-4).then()}}async parseRiffInfoTags(e){for(;e>=8;){const n=await this.tokenizer.readToken(gc),r=new EQ(n),s=await this.tokenizer.readToken(r);this.addTag(n.chunkID,Ni(s)),e-=8+r.len}if(e!==0)throw new Error(`Illegal remaining size: ${e}`)}addTag(e,n){this.metadata.addTag("exif",e,n)}}const IQ=[6e3,8e3,9600,11025,12e3,16e3,22050,24e3,32e3,44100,48e3,64e3,88200,96e3,192e3,-1],sh={len:32,get:(t,e)=>{const n=ne.get(t,e+24),r={BlockID:tt.get(t,e),blockSize:ne.get(t,e+4),version:Ve.get(t,e+8),totalSamples:ne.get(t,e+12),blockIndex:ne.get(t,e+16),blockSamples:ne.get(t,e+20),flags:{bitsPerSample:(1+Wf(n,0,2))*8,isMono:ps(n,2),isHybrid:ps(n,3),isJointStereo:ps(n,4),crossChannel:ps(n,5),hybridNoiseShaping:ps(n,6),floatingPoint:ps(n,7),samplingRate:IQ[Wf(n,23,4)],isDSD:ps(n,31)},crc:new Hn(4).get(t,e+28)};return r.flags.isDSD&&(r.totalSamples*=8),r}},Yg={len:1,get:(t,e)=>({functionId:Wf(t[e],0,6),isOptional:ps(t[e],5),isOddSize:ps(t[e],6),largeBlock:ps(t[e],7)})};function ps(t,e){return Wf(t,e,1)===1}function Wf(t,e,n){return t>>>e&4294967295>>>32-n}const wa=Ke("music-metadata:parser:WavPack");class CQ extends br{constructor(){super(...arguments),this.audioDataSize=0}async parse(){return this.audioDataSize=0,await this.parseWavPackBlocks(),xs.tryParseApeHeader(this.metadata,this.tokenizer,this.options)}async parseWavPackBlocks(){do{if(await this.tokenizer.peekToken(tt)!=="wvpk")break;const n=await this.tokenizer.readToken(sh);if(n.BlockID!=="wvpk")throw new Error("Invalid WavPack Block-ID");wa(`WavPack header blockIndex=${n.blockIndex}, len=${sh.len}`),n.blockIndex===0&&!this.metadata.format.container&&(this.metadata.setFormat("container","WavPack"),this.metadata.setFormat("lossless",!n.flags.isHybrid),this.metadata.setFormat("bitsPerSample",n.flags.bitsPerSample),n.flags.isDSD||(this.metadata.setFormat("sampleRate",n.flags.samplingRate),this.metadata.setFormat("duration",n.totalSamples/n.flags.samplingRate)),this.metadata.setFormat("numberOfChannels",n.flags.isMono?1:2),this.metadata.setFormat("numberOfSamples",n.totalSamples),this.metadata.setFormat("codec",n.flags.isDSD?"DSD":"PCM"));const r=n.blockSize-(sh.len-8);await(n.blockIndex===0?this.parseMetadataSubBlock(n,r):this.tokenizer.ignore(r)),n.blockSamples>0&&(this.audioDataSize+=n.blockSize)}while(!this.tokenizer.fileInfo.size||this.tokenizer.fileInfo.size-this.tokenizer.position>=sh.len);this.metadata.format.duration&&this.metadata.setFormat("bitrate",this.audioDataSize*8/this.metadata.format.duration)}async parseMetadataSubBlock(e,n){let r=n;for(;r>Yg.len;){const s=await this.tokenizer.readToken(Yg),i=await this.tokenizer.readNumber(s.largeBlock?Lf:ke),o=new Uint8Array(i*2-(s.isOddSize?1:0));switch(await this.tokenizer.readBuffer(o),wa(`Metadata Sub-Blocks functionId=0x${s.functionId.toString(16)}, id.largeBlock=${s.largeBlock},data-size=${o.length}`),s.functionId){case 0:break;case 14:{wa("ID_DSD_BLOCK");const l=1<<ke.get(o,0),c=e.flags.samplingRate*l*8;if(!e.flags.isDSD)throw new Error("Only expect DSD block if DSD-flag is set");this.metadata.setFormat("sampleRate",c),this.metadata.setFormat("duration",e.totalSamples/c);break}case 36:wa("ID_ALT_TRAILER: trailer for non-wav files");break;case 38:this.metadata.setFormat("audioMD5",o);break;case 47:wa(`ID_BLOCK_CHECKSUM: checksum=${Gw(o)}`);break;default:wa(`Ignore unsupported meta-sub-block-id functionId=0x${s.functionId.toString(16)}`);break}r-=Yg.len+(s.largeBlock?Lf.len:ke.len)+i*2,wa(`remainingLength=${r}`),s.isOddSize&&this.tokenizer.ignore(1)}if(r!==0)throw new Error("metadata-sub-block should fit it remaining length")}}const ih={len:12,get:(t,e)=>({id:tt.get(t,e),size:Cn.get(t,e+4)})},RQ={len:16,get:(t,e)=>({fileSize:Of.get(t,e),metadataPointer:Of.get(t,e+8)})};var a2;(function(t){t[t.mono=1]="mono",t[t.stereo=2]="stereo",t[t.channels=3]="channels",t[t.quad=4]="quad",t[t["4 channels"]=5]="4 channels",t[t["5 channels"]=6]="5 channels",t[t["5.1 channels"]=7]="5.1 channels"})(a2||(a2={}));const NQ={len:40,get:(t,e)=>({formatVersion:gt.get(t,e),formatID:gt.get(t,e+4),channelType:gt.get(t,e+8),channelNum:gt.get(t,e+12),samplingFrequency:gt.get(t,e+16),bitsPerSample:gt.get(t,e+20),sampleCount:Of.get(t,e+24),blockSizePerChannel:gt.get(t,e+32)})},Jg=Ke("music-metadata:parser:DSF");class AQ extends xp{async postId3v2Parse(){const e=this.tokenizer.position,n=await this.tokenizer.readToken(ih);if(n.id!=="DSD ")throw new Error("Invalid chunk signature");this.metadata.setFormat("container","DSF"),this.metadata.setFormat("lossless",!0);const r=await this.tokenizer.readToken(RQ);if(r.metadataPointer===BigInt(0))Jg("No ID3v2 tag present");else return Jg(`expect ID3v2 at offset=${r.metadataPointer}`),await this.parseChunks(r.fileSize-n.size),await this.tokenizer.ignore(Number(r.metadataPointer)-this.tokenizer.position-e),new Kr().parse(this.metadata,this.tokenizer,this.options)}async parseChunks(e){for(;e>=ih.len;){const n=await this.tokenizer.readToken(ih);switch(Jg(`Parsing chunk name=${n.id} size=${n.size}`),n.id){case"fmt ":{const r=await this.tokenizer.readToken(NQ);this.metadata.setFormat("numberOfChannels",r.channelNum),this.metadata.setFormat("sampleRate",r.samplingFrequency),this.metadata.setFormat("bitsPerSample",r.bitsPerSample),this.metadata.setFormat("numberOfSamples",r.sampleCount),this.metadata.setFormat("duration",Number(r.sampleCount)/r.samplingFrequency);const s=r.bitsPerSample*r.samplingFrequency*r.channelNum;this.metadata.setFormat("bitrate",s);return}default:this.tokenizer.ignore(Number(n.size)-ih.len);break}e-=n.size}}}const To={len:12,get:(t,e)=>({chunkID:tt.get(t,e),chunkSize:AN.get(t,e+4)})},Tn=Ke("music-metadata:parser:aiff");class PQ extends br{async parse(){const e=await this.tokenizer.readToken(To);if(e.chunkID!=="FRM8")throw new Error("Unexpected chunk-ID");const n=(await this.tokenizer.readToken(tt)).trim();switch(n){case"DSD":return this.metadata.setFormat("container",`DSDIFF/${n}`),this.metadata.setFormat("lossless",!0),this.readFmt8Chunks(e.chunkSize-BigInt(tt.len));default:throw new Error(`Unsupported DSDIFF type: ${n}`)}}async readFmt8Chunks(e){for(;e>=To.len;){const n=await this.tokenizer.readToken(To);Tn(`Chunk id=${n.chunkID}`),await this.readData(n),e-=BigInt(To.len)+n.chunkSize}}async readData(e){Tn(`Reading data of chunk[ID=${e.chunkID}, size=${e.chunkSize}]`);const n=this.tokenizer.position;switch(e.chunkID.trim()){case"FVER":{const s=await this.tokenizer.readToken(ne);Tn(`DSDIFF version=${s}`);break}case"PROP":{if(await this.tokenizer.readToken(tt)!=="SND ")throw new Error("Unexpected PROP-chunk ID");await this.handleSoundPropertyChunks(e.chunkSize-BigInt(tt.len));break}case"ID3":{const s=await this.tokenizer.readToken(new Hn(Number(e.chunkSize))),i=kl(s);await new Kr().parse(this.metadata,i,this.options);break}case"DSD":this.metadata.format.numberOfChannels&&this.metadata.setFormat("numberOfSamples",Number(e.chunkSize*BigInt(8)/BigInt(this.metadata.format.numberOfChannels))),this.metadata.format.numberOfSamples&&this.metadata.format.sampleRate&&this.metadata.setFormat("duration",this.metadata.format.numberOfSamples/this.metadata.format.sampleRate);break;default:Tn(`Ignore chunk[ID=${e.chunkID}, size=${e.chunkSize}]`);break}const r=e.chunkSize-BigInt(this.tokenizer.position-n);r>0&&(Tn(`After Parsing chunk, remaining ${r} bytes`),await this.tokenizer.ignore(Number(r)))}async handleSoundPropertyChunks(e){for(Tn(`Parsing sound-property-chunks, remainingSize=${e}`);e>0;){const n=await this.tokenizer.readToken(To);Tn(`Sound-property-chunk[ID=${n.chunkID}, size=${n.chunkSize}]`);const r=this.tokenizer.position;switch(n.chunkID.trim()){case"FS":{const i=await this.tokenizer.readToken(ue);this.metadata.setFormat("sampleRate",i);break}case"CHNL":{const i=await this.tokenizer.readToken(Ge);this.metadata.setFormat("numberOfChannels",i),await this.handleChannelChunks(n.chunkSize-BigInt(Ge.len));break}case"CMPR":{const i=(await this.tokenizer.readToken(tt)).trim(),o=await this.tokenizer.readToken(ke),l=await this.tokenizer.readToken(new ae(o,"ascii"));i==="DSD"&&(this.metadata.setFormat("lossless",!0),this.metadata.setFormat("bitsPerSample",1)),this.metadata.setFormat("codec",`${i} (${l})`);break}case"ABSS":{const i=await this.tokenizer.readToken(Ge),o=await this.tokenizer.readToken(ke),l=await this.tokenizer.readToken(ke),c=await this.tokenizer.readToken(ue);Tn(`ABSS ${i}:${o}:${l}.${c}`);break}case"LSCO":{const i=await this.tokenizer.readToken(Ge);Tn(`LSCO lsConfig=${i}`);break}default:Tn(`Unknown sound-property-chunk[ID=${n.chunkID}, size=${n.chunkSize}]`),await this.tokenizer.ignore(Number(n.chunkSize))}const s=n.chunkSize-BigInt(this.tokenizer.position-r);s>0&&(Tn(`After Parsing sound-property-chunk ${n.chunkSize}, remaining ${s} bytes`),await this.tokenizer.ignore(Number(s))),e-=BigInt(To.len)+n.chunkSize,Tn(`Parsing sound-property-chunks, remainingSize=${e}`)}if(this.metadata.format.lossless&&this.metadata.format.sampleRate&&this.metadata.format.numberOfChannels&&this.metadata.format.bitsPerSample){const n=this.metadata.format.sampleRate*this.metadata.format.numberOfChannels*this.metadata.format.bitsPerSample;this.metadata.setFormat("bitrate",n)}}async handleChannelChunks(e){Tn(`Parsing channel-chunks, remainingSize=${e}`);const n=[];for(;e>=tt.len;){const r=await this.tokenizer.readToken(tt);Tn(`Channel[ID=${r}]`),n.push(r),e-=BigInt(tt.len)}return Tn(`Channels: ${n.join(", ")}`),n}}var B;(function(t){t[t.string=0]="string",t[t.uint=1]="uint",t[t.uid=2]="uid",t[t.bool=3]="bool",t[t.binary=4]="binary",t[t.float=5]="float"})(B||(B={}));const FQ={name:"dtd",container:{440786851:{name:"ebml",container:{17030:{name:"ebmlVersion",value:B.uint},17143:{name:"ebmlReadVersion",value:B.uint},17138:{name:"ebmlMaxIDWidth",value:B.uint},17139:{name:"ebmlMaxSizeWidth",value:B.uint},17026:{name:"docType",value:B.string},17031:{name:"docTypeVersion",value:B.uint},17029:{name:"docTypeReadVersion",value:B.uint}}},408125543:{name:"segment",container:{290298740:{name:"seekHead",container:{19899:{name:"seek",multiple:!0,container:{21419:{name:"id",value:B.binary},21420:{name:"position",value:B.uint}}}}},357149030:{name:"info",container:{29604:{name:"uid",value:B.uid},29572:{name:"filename",value:B.string},3979555:{name:"prevUID",value:B.uid},3965867:{name:"prevFilename",value:B.string},4110627:{name:"nextUID",value:B.uid},4096955:{name:"nextFilename",value:B.string},2807729:{name:"timecodeScale",value:B.uint},17545:{name:"duration",value:B.float},17505:{name:"dateUTC",value:B.uint},31657:{name:"title",value:B.string},19840:{name:"muxingApp",value:B.string},22337:{name:"writingApp",value:B.string}}},524531317:{name:"cluster",multiple:!0,container:{231:{name:"timecode",value:B.uid},22743:{name:"silentTracks ",multiple:!0},167:{name:"position",value:B.uid},171:{name:"prevSize",value:B.uid},160:{name:"blockGroup"},163:{name:"simpleBlock"}}},374648427:{name:"tracks",container:{174:{name:"entries",multiple:!0,container:{215:{name:"trackNumber",value:B.uint},29637:{name:"uid",value:B.uid},131:{name:"trackType",value:B.uint},185:{name:"flagEnabled",value:B.bool},136:{name:"flagDefault",value:B.bool},21930:{name:"flagForced",value:B.bool},156:{name:"flagLacing",value:B.bool},28135:{name:"minCache",value:B.uint},28136:{name:"maxCache",value:B.uint},2352003:{name:"defaultDuration",value:B.uint},2306383:{name:"timecodeScale",value:B.float},21358:{name:"name",value:B.string},2274716:{name:"language",value:B.string},134:{name:"codecID",value:B.string},25506:{name:"codecPrivate",value:B.binary},2459272:{name:"codecName",value:B.string},3839639:{name:"codecSettings",value:B.string},3883072:{name:"codecInfoUrl",value:B.string},2536e3:{name:"codecDownloadUrl",value:B.string},170:{name:"codecDecodeAll",value:B.bool},28587:{name:"trackOverlay",value:B.uint},224:{name:"video",container:{154:{name:"flagInterlaced",value:B.bool},21432:{name:"stereoMode",value:B.uint},176:{name:"pixelWidth",value:B.uint},186:{name:"pixelHeight",value:B.uint},21680:{name:"displayWidth",value:B.uint},21690:{name:"displayHeight",value:B.uint},21683:{name:"aspectRatioType",value:B.uint},3061028:{name:"colourSpace",value:B.uint},3126563:{name:"gammaValue",value:B.float}}},225:{name:"audio",container:{181:{name:"samplingFrequency",value:B.float},30901:{name:"outputSamplingFrequency",value:B.float},159:{name:"channels",value:B.uint},148:{name:"channels",value:B.uint},32123:{name:"channelPositions",value:B.binary},25188:{name:"bitDepth",value:B.uint}}},28032:{name:"contentEncodings",container:{25152:{name:"contentEncoding",container:{20529:{name:"order",value:B.uint},20530:{name:"scope",value:B.bool},20531:{name:"type",value:B.uint},20532:{name:"contentEncoding",container:{16980:{name:"contentCompAlgo",value:B.uint},16981:{name:"contentCompSettings",value:B.binary}}},20533:{name:"contentEncoding",container:{18401:{name:"contentEncAlgo",value:B.uint},18402:{name:"contentEncKeyID",value:B.binary},18403:{name:"contentSignature ",value:B.binary},18404:{name:"ContentSigKeyID  ",value:B.binary},18405:{name:"contentSigAlgo ",value:B.uint},18406:{name:"contentSigHashAlgo ",value:B.uint}}},25188:{name:"bitDepth",value:B.uint}}}}}}}}},475249515:{name:"cues",container:{187:{name:"cuePoint",container:{179:{name:"cueTime",value:B.uid},183:{name:"positions",container:{247:{name:"track",value:B.uint},241:{name:"clusterPosition",value:B.uint},21368:{name:"blockNumber",value:B.uint},234:{name:"codecState",value:B.uint},219:{name:"reference",container:{150:{name:"time",value:B.uint},151:{name:"cluster",value:B.uint},21343:{name:"number",value:B.uint},235:{name:"codecState",value:B.uint}}},240:{name:"relativePosition",value:B.uint}}}}}}},423732329:{name:"attachments",container:{24999:{name:"attachedFiles",multiple:!0,container:{18046:{name:"description",value:B.string},18030:{name:"name",value:B.string},18016:{name:"mimeType",value:B.string},18012:{name:"data",value:B.binary},18094:{name:"uid",value:B.uid}}}}},272869232:{name:"chapters",container:{17849:{name:"editionEntry",container:{182:{name:"chapterAtom",container:{29636:{name:"uid",value:B.uid},145:{name:"timeStart",value:B.uint},146:{name:"timeEnd",value:B.uid},152:{name:"hidden",value:B.bool},17816:{name:"enabled",value:B.uid},143:{name:"track",container:{137:{name:"trackNumber",value:B.uid},128:{name:"display",container:{133:{name:"string",value:B.string},17276:{name:"language ",value:B.string},17278:{name:"country ",value:B.string}}}}}}}}}}},307544935:{name:"tags",container:{29555:{name:"tag",multiple:!0,container:{25536:{name:"target",container:{25541:{name:"tagTrackUID",value:B.uid},25540:{name:"tagChapterUID",value:B.uint},25542:{name:"tagAttachmentUID",value:B.uid},25546:{name:"targetType",value:B.string},26826:{name:"targetTypeValue",value:B.uint},25545:{name:"tagEditionUID",value:B.uid}}},26568:{name:"simpleTags",multiple:!0,container:{17827:{name:"name",value:B.string},17543:{name:"string",value:B.string},17541:{name:"binary",value:B.binary},17530:{name:"language",value:B.string},17531:{name:"languageIETF",value:B.string},17540:{name:"default",value:B.bool}}}}}}}}}}},Io=Ke("music-metadata:parser:ebml");var Qr;(function(t){t[t.ReadNext=0]="ReadNext",t[t.IgnoreElement=2]="IgnoreElement",t[t.SkipSiblings=3]="SkipSiblings",t[t.TerminateParsing=4]="TerminateParsing",t[t.SkipElement=5]="SkipElement"})(Qr||(Qr={}));class MQ{constructor(e){this.tokenizer=e,this.padding=0,this.parserMap=new Map,this.ebmlMaxIDLength=4,this.ebmlMaxSizeLength=8,this.parserMap.set(B.uint,n=>this.readUint(n)),this.parserMap.set(B.string,n=>this.readString(n)),this.parserMap.set(B.binary,n=>this.readBuffer(n)),this.parserMap.set(B.uid,async n=>this.readBuffer(n)),this.parserMap.set(B.bool,n=>this.readFlag(n)),this.parserMap.set(B.float,n=>this.readFloat(n))}async iterate(e,n,r){return this.parseContainer(XN(e),n,r)}async parseContainer(e,n,r){const s={};for(;this.tokenizer.position<n;){let i;const o=this.tokenizer.position;try{i=await this.readElement()}catch(c){if(c instanceof vt)break;throw c}const l=e.container[i.id];if(l)switch(r.startNext(l)){case Qr.ReadNext:if(i.id,Io(`Read element: name=${ja(l)}{id=0x${i.id.toString(16)}, container=${!!l.container}} at position=${o}`),l.container){const u=await this.parseContainer(l,i.len>=0?this.tokenizer.position+i.len:-1,r);l.multiple?(s[l.name]||(s[l.name]=[]),s[l.name].push(u)):s[l.name]=u,await r.elementValue(l,u,o)}else{const u=this.parserMap.get(l.value);if(typeof u=="function"){const d=await u(i);s[l.name]=d,await r.elementValue(l,d,o)}}break;case Qr.SkipElement:Io(`Go to next element: name=${ja(l)}, element.id=0x${i.id}, container=${!!l.container} at position=${o}`);break;case Qr.IgnoreElement:Io(`Ignore element: name=${ja(l)}, element.id=0x${i.id}, container=${!!l.container} at position=${o}`),await this.tokenizer.ignore(i.len);break;case Qr.SkipSiblings:Io(`Ignore remaining container, at: name=${ja(l)}, element.id=0x${i.id}, container=${!!l.container} at position=${o}`),await this.tokenizer.ignore(n-this.tokenizer.position);break;case Qr.TerminateParsing:return Io(`Terminate parsing at element: name=${ja(l)}, element.id=0x${i.id}, container=${!!l.container} at position=${o}`),s}else switch(i.id){case 236:this.padding+=i.len,await this.tokenizer.ignore(i.len);break;default:Io(`parseEbml: parent=${ja(e)}, unknown child: id=${i.id.toString(16)} at position=${o}`),this.padding+=i.len,await this.tokenizer.ignore(i.len)}}return s}async readVintData(e){const n=await this.tokenizer.peekNumber(ke);let r=128,s=1;for(;!(n&r);){if(s>e)throw new Error("VINT value exceeding maximum size");++s,r>>=1}const i=new Uint8Array(s);return await this.tokenizer.readBuffer(i),i}async readElement(){const e=await this.readVintData(this.ebmlMaxIDLength),n=await this.readVintData(this.ebmlMaxSizeLength);return n[0]^=128>>n.length-1,{id:Zg(e,e.length),len:Zg(n,n.length)}}async readFloat(e){switch(e.len){case 0:return 0;case 4:return this.tokenizer.readNumber(PN);case 8:return this.tokenizer.readNumber(qx);case 10:return this.tokenizer.readNumber(qx);default:throw new Error(`Invalid IEEE-754 float length: ${e.len}`)}}async readFlag(e){return await this.readUint(e)===1}async readUint(e){const n=await this.readBuffer(e);return Zg(n,e.len)}async readString(e){return(await this.tokenizer.readToken(new ae(e.len,"utf-8"))).replace(/\x00.*$/g,"")}async readBuffer(e){const n=new Uint8Array(e.len);return await this.tokenizer.readBuffer(n),n}}function Zg(t,e){return Number(DQ(t,e))}function DQ(t,e){const n=new Uint8Array(8),r=t.subarray(0,e);try{return n.set(r,8-e),Uw.get(n,0)}catch{return BigInt(-1)}}function XN(t){return t.container&&Object.keys(t.container).map(e=>{const n=t.container[e];return n.id=Number.parseInt(e),n}).forEach(e=>{e.parent=t,XN(e)}),t}function ja(t){let e="";return t.parent&&t.parent.name!=="dtd"&&(e+=`${ja(t.parent)}/`),e+t.name}const ah=Ke("music-metadata:parser:matroska");class LQ extends br{constructor(){super(...arguments),this.seekHeadOffset=0,this.flagUseIndexToSkipClusters=!1}init(e,n,r){return super.init(e,n,r),this.flagUseIndexToSkipClusters=r.mkvUseIndex??!1,this}async parse(){const e=this.tokenizer.fileInfo.size??Number.MAX_SAFE_INTEGER,n=new MQ(this.tokenizer);ah("Initializing DTD end MatroskaIterator"),await n.iterate(FQ,e,{startNext:r=>{switch(r.id){case 475249515:return ah(`Skip element: name=${r.name}, id=0x${r.id.toString(16)}`),Qr.IgnoreElement;case 524531317:if(this.flagUseIndexToSkipClusters&&this.seekHead){const s=this.seekHead.seek.find(i=>i.position+this.seekHeadOffset>this.tokenizer.position);if(s){const i=s.position+this.seekHeadOffset-this.tokenizer.position;return ah(`Use index to go to next position, ignoring ${i} bytes`),this.tokenizer.ignore(i),Qr.SkipElement}}return Qr.IgnoreElement;default:return Qr.ReadNext}},elementValue:async(r,s,i)=>{switch(ah(`Received: name=${r.name}, value=${s}`),r.id){case 17026:this.metadata.setFormat("container",`EBML/${s}`);break;case 290298740:this.seekHead=s,this.seekHeadOffset=i;break;case 357149030:{const o=s,l=o.timecodeScale?o.timecodeScale:1e6;if(typeof o.duration=="number"){const c=o.duration*l/1e9;await this.addTag("segment:title",o.title),this.metadata.setFormat("duration",Number(c))}}break;case 374648427:{const o=s;if(o!=null&&o.entries){o.entries.forEach(c=>{const u={codecName:c.codecID.replace("A_","").replace("V_",""),codecSettings:c.codecSettings,flagDefault:c.flagDefault,flagLacing:c.flagLacing,flagEnabled:c.flagEnabled,language:c.language,name:c.name,type:c.trackType,audio:c.audio,video:c.video};this.metadata.addStreamInfo(u)});const l=o.entries.filter(c=>c.trackType===Za.audio).reduce((c,u)=>!c||u.flagDefault&&!c.flagDefault||u.trackNumber<c.trackNumber?u:c,null);l&&(this.metadata.setFormat("codec",l.codecID.replace("A_","")),this.metadata.setFormat("sampleRate",l.audio.samplingFrequency),this.metadata.setFormat("numberOfChannels",l.audio.channels))}}break;case 307544935:{const o=s;await Promise.all(o.tag.map(async l=>{const c=l.target,u=c!=null&&c.targetTypeValue?Qx[c.targetTypeValue]:c!=null&&c.targetType?c.targetType:"track";await Promise.all(l.simpleTags.map(async d=>{const m=d.string?d.string:d.binary;await this.addTag(`${u}:${d.name}`,m)}))}))}break;case 423732329:{const o=s;await Promise.all(o.attachedFiles.filter(l=>l.mimeType.startsWith("image/")).map(l=>this.addTag("picture",{data:l.data,format:l.mimeType,description:l.description,name:l.name})))}break}}})}async addTag(e,n){await this.metadata.addTag("matroska",e,n)}}const qf=Ke("music-metadata:parser:factory");function OQ(t){const e=Ww.parse(t),n=Dq(e.type);return{type:n.type,subtype:n.subtype,suffix:n.suffix,parameters:e.parameters}}async function $Q(t,e){const{mimeType:n,path:r,url:s}=t.fileInfo,i=YN(n)||iy(r)||iy(s);return i||qf(`No parser found for MIME-type / extension: ${n}`),zQ(t,i,e)}async function zQ(t,e,n){if(!e){qf("Guess parser on content...");const i=new Uint8Array(4100);if(await t.peekBuffer(i,{mayBeLess:!0}),t.fileInfo.path&&(e=iy(t.fileInfo.path)),!e){const o=await ON(i);if(!o)throw new Error("Failed to determine audio format");if(qf(`Guessed file type is mime=${o.mime}, extension=${o.ext}`),e=YN(o.mime),!e)throw new Error(`Guessed MIME-type not supported: ${o.mime}`)}}const r=await BQ(e),s=new pK(n);return await r.init(s,t,n??{}).parse(),s.toCommonMetadata()}function iy(t){if(!t)return;switch(VQ(t).toLocaleLowerCase()||t){case".mp2":case".mp3":case".m2a":case".aac":return"mpeg";case".ape":return"apev2";case".mp4":case".m4a":case".m4b":case".m4pa":case".m4v":case".m4r":case".3gp":return"mp4";case".wma":case".wmv":case".asf":return"asf";case".flac":return"flac";case".ogg":case".ogv":case".oga":case".ogm":case".ogx":case".opus":case".spx":return"ogg";case".aif":case".aiff":case".aifc":return"aiff";case".wav":case".bwf":return"riff";case".wv":case".wvp":return"wavpack";case".mpc":return"musepack";case".dsf":return"dsf";case".dff":return"dsdiff";case".mka":case".mkv":case".mk3d":case".mks":case".webm":return"matroska"}}async function BQ(t){switch(t){case"aiff":return new SK;case"adts":case"mpeg":return new lQ;case"apev2":return new xs;case"asf":return new FK;case"dsf":return new AQ;case"dsdiff":return new PQ;case"flac":return new LK;case"mp4":return new Gf;case"musepack":return new gQ;case"ogg":return new yp;case"riff":return new TQ;case"wavpack":return new CQ;case"matroska":return new LQ;default:throw new Error(`Unknown parser type: ${t}`)}}function VQ(t){const e=t.lastIndexOf(".");return e===-1?"":t.slice(e)}function YN(t){let e;if(!t)return;try{e=OQ(t)}catch{qf(`Invalid HTTP Content-Type header value: ${t}`);return}const n=e.subtype.indexOf("x-")===0?e.subtype.substring(2):e.subtype;switch(e.type){case"audio":switch(n){case"mp3":case"mpeg":return"mpeg";case"aac":case"aacp":return"adts";case"flac":return"flac";case"ape":case"monkeys-audio":return"apev2";case"mp4":case"m4a":return"mp4";case"ogg":case"opus":case"speex":return"ogg";case"ms-wma":case"ms-wmv":case"ms-asf":return"asf";case"aiff":case"aif":case"aifc":return"aiff";case"vnd.wave":case"wav":case"wave":return"riff";case"wavpack":return"wavpack";case"musepack":return"musepack";case"matroska":case"webm":return"matroska";case"dsf":return"dsf"}break;case"video":switch(n){case"ms-asf":case"ms-wmv":return"asf";case"m4v":case"mp4":return"mp4";case"ogg":return"ogg";case"matroska":case"webm":return"matroska"}break;case"application":switch(n){case"vnd.ms-asf":return"asf";case"ogg":return"ogg"}break}}async function UQ(t,e={}){const n={mimeType:t.type,size:t.size};return t instanceof File&&(n.path=t.name),HQ(t.stream(),n,e)}function HQ(t,e,n={}){return GQ(NN(t,{fileInfo:typeof e=="string"?{mimeType:e}:e}),n)}function GQ(t,e){return $Q(t,e)}const JN=async t=>{var l;if(!t)return;const e=await UQ(t);if(!e)return;const{common:{title:n,artist:r,picture:s},format:{duration:i}}=e;return Object.assign({},{name:n||t.name,singer:r||"...",duration:i||0,image:s?(l=s[0])==null?void 0:l.data:null})};function WQ(t){const{resetPage:e}=it(),{setErrorToast:n,setSuccessToast:r}=te(),{songFile:s,imageFile:i,setSong:o,setImageFile:l,updateSongData:c,setSongData:u,songData:d,singers:m,song:p,genres:g,setGenres:x,setSingers:w,imageBlob:v,setImageBlob:S,audioRef:_,setSongFile:E}=as(),[I,P]=h.useState(!1),F=h.useRef(null),j=h.useMemo(()=>{var J,Z;if(t.variant==="add")return!0;if(!p||!d)return!1;if(d.name!==p.name||m.length!==p.singers.length||d.like!==p.like||g.length!==p.genres.length||d.release_year!==p.release_year||((J=d.main_genre)==null?void 0:J.id)!==((Z=p.main_genre)==null?void 0:Z.id))return!0;const he=m.find(je=>p.singers.find(Te=>Te.id!==je.id)),V=g.find(je=>p.genres.find(Te=>Te.id!==je.id));return he||V},[d,p,m,g]),k=!!i,C=h.useMemo(()=>{const de=!!(d!=null&&d.name)&&!!m.length&&!!g.length&&!!d.release_year&&!!d.main_genre&&j;return t.variant==="add"?de:de||k},[k,j,m,g,d]),R=()=>{switch(t.variant){case"add":return Vx({owner_email:t.ownerEmail,distributor:t.distributor,is_official:!0});case"edit":_.current&&(_.current.src=t.song.song_url);const{id:de,updated_at:he,...V}=t.song;return w(V.singers),x(V.genres),Vx(V)}},N=()=>{var de,he;switch(t.variant){case"add":(de=F.current)==null||de.close(),setTimeout(()=>{E(void 0),l(void 0),S(void 0),w([]),x([]),u(R())},500);break;case"edit":(he=F.current)==null||he.close()}},M=async()=>{if(!s)return;const de=await JN(s);if(de){const he={name:de.name+" "+de.singer,duration:Math.floor(de.duration),size:Math.floor(s.size/1024),image_url:""};if(de.image){const V=new Blob([de.image]);S(V),he.image_url=URL.createObjectURL(V)}c(he)}},A=()=>{if(!d)return[];const de=[];return de.push(...bn(d.name).split(" ")),m.forEach(he=>de.push(...bn(he.name).split(" "))),de},fe=()=>{const de={};m.forEach(V=>de[V.id]=!0);const he=g.map(V=>V.id);return{singer_map:de,genre_ids:he}},Le=async()=>{var de;try{if(!C||!d)return;const he={...d};if(P(!0),i||v){const V=await pi({imageFile:i,blob:v});t.variant==="edit"&&(p!=null&&p.image_file_id)&&Gt({fileId:p.image_file_id,msg:">>> api: Delete image file"}),Object.assign(he,V)}switch(t.variant){case"add":{if(!s)return;const{fileId:V,url:J}=await ed({file:s,folder:"/songs/",msg:">>> api: upload song file"}),Z={singers:m,genres:g,song_url:J,song_file_id:V,...fe(),meta:A()};Object.assign(he,Z),await Ts({collectionName:"Songs",data:he,msg:">>> api: set song doc"}),r(),(de=F.current)==null||de.open();break}case"edit":{if(!p)return;if(j){const V={singers:m,genres:g,...fe(),meta:A()};Object.assign(he,V)}p&&o({...p,...he}),l(void 0),await Se({collectionName:"Songs",id:p.id,data:he}),r("Song updated")}}e()}catch(he){console.log(he),n()}finally{P(!1)}};return h.useEffect(()=>{u(R())},[]),h.useEffect(()=>{!s||!_.current||(_.current.src=URL.createObjectURL(s),M())},[s]),h.useEffect(()=>{!d||!_.current||(_.current.src=d.song_url)},[d==null?void 0:d.song_url]),h.useEffect(()=>{i&&c({image_url:URL.createObjectURL(i)})},[i]),h.useEffect(()=>{if(!j)return;const de=he=>{he.preventDefault()};return window.addEventListener("beforeunload",de),()=>{window.removeEventListener("beforeunload",de)}},[j]),{isValidToSubmit:C,handleSubmit:Le,isFetching:I,updateSongData:c,handleCloseModalAfterFinished:N,modalRef:F}}function qQ({handleCloseModal:t,variant:e}){return a.jsxs(_e,{children:[a.jsx(Be,{closeModal:t,title:"Successful"}),a.jsx(Ce,{width:"w-[120px]",className:"mx-auto w-[120px]",src:"https://zalo-api.zadn.vn/api/emoticon/sticker/webpc?eid=46985&size=130"}),a.jsxs("div",{className:"flex justify-center mt-5 space-x-2",children:[a.jsxs(q,{href:"/dashboard/song",children:[a.jsx(av,{className:"w-6"}),a.jsx("span",{children:"Songs"})]}),a.jsxs(q,{onClick:t,children:[a.jsx(aa,{className:"w-6"}),a.jsx("span",{children:e==="add"?"Add more":"Ok"})]})]})]})}function KQ({closeModal:t}){const{songData:e,updateSongData:n}=as(),[r,s]=h.useState({name:"",release_year:0}),i=l=>{s(c=>({...c,...l}))},o=()=>{!r.name||!r.release_year||(n({name:r.name,release_year:r.release_year}),t())};return h.useEffect(()=>{e&&s({name:e.name,release_year:e.release_year})},[e]),a.jsxs(_e,{children:[a.jsx(Be,{title:"Edit song",closeModal:t}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx(Dt,{children:"Name"}),a.jsx(_n,{value:r==null?void 0:r.name,onChange:l=>i({name:l.target.value})})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx(Dt,{children:"Release year"}),a.jsx(_n,{type:"number",value:r.release_year+""||"0",onChange:l=>i({release_year:+l.target.value||0})})]})]}),a.jsx("p",{className:"mt-6 text-right",children:a.jsx(q,{onClick:o,children:"Ok"})})]})}function QQ({closeModal:t}){const{setErrorToast:e,setSuccessToast:n}=te(),{song:r,updateSongData:s}=as(),[i,o]=h.useState(),[l,c]=h.useState(!1);return{songFile:i,isFetching:l,submit:async()=>{try{if(!i||!r)return;c(!0),Gt({fileId:r.song_file_id});const{url:d,fileId:m}=await ed({file:i,folder:"/songs/"}),p={song_url:d,song_file_path:m};await Se({collectionName:"Songs",data:p,id:r.id}),s(p),n("Change song file successful"),t()}catch(d){console.log(d),e()}finally{c(!1)}},setSongFile:o}}function XQ({closeModal:t}){const{songFile:e,setSongFile:n,isFetching:r,submit:s}=QQ({closeModal:t}),i=h.useMemo(()=>e?URL.createObjectURL(e):"",[e]),o=l=>{var c;(c=l.target.files)!=null&&c.length&&n(l.target.files[0])};return a.jsx(a.Fragment,{children:a.jsxs(_e,{children:[a.jsx(Be,{title:"Change song file",closeModal:t}),!e&&a.jsx("input",{accept:"audio",type:"file",onChange:o}),e&&a.jsx("audio",{src:i,controls:!0}),a.jsx("p",{className:"text-right",children:a.jsx(q,{loading:r,className:"mt-5",onClick:s,children:"Save"})})]})})}function YQ(){const{shouldFetchUserSongs:t,lastDoc:e}=it(),{setSuccessToast:n,setErrorToast:r}=te(),[s,i]=h.useState(!1),o=Nt();return{actions:async c=>{try{i(!0);const u=mi(ie),d=st(ie,"Songs",c.song.id),m=await bt(le(Xa,Q("target_id","==",c.song.id)));switch(c.variant){case"delete":{if(u.delete(d),c.song.lyric_id){const p=st(ie,"Lyrics",c.song.lyric_id);u.delete(p)}m.empty||(console.log(`Delete ${m.docs.length} comments`),m.forEach(p=>u.delete(p.ref))),await Promise.all([u.commit(),aR(c.song)]),t.current=!0,e.current=void 0,n(`'${c.song.name}' deleted`),o("/dashboard/song");break}}}catch(u){console.log({message:u}),r()}finally{i(!1)}},isFetching:s}}function JQ(){const{song:t}=as(),{actions:e,isFetching:n}=YQ(),[r,s]=h.useState(""),i=h.useRef(null),o=c=>{var u;s(c),(u=i.current)==null||u.open()},l=()=>{var c;return(c=i.current)==null?void 0:c.close()};return a.jsxs(a.Fragment,{children:[a.jsxs(q,{onClick:()=>o("edit"),size:"clear",children:[a.jsx(Dr,{}),a.jsx("span",{children:"Edit"})]}),a.jsx(X,{to:`/dashboard/lyric/${t==null?void 0:t.id}`,children:a.jsxs(q,{size:"clear",children:[a.jsx(EF,{}),a.jsx("span",{children:"Lyric"})]})}),a.jsxs(q,{onClick:()=>o("change-file"),size:"clear",children:[a.jsx(oa,{}),a.jsx("span",{children:"Change song file"})]}),a.jsxs(q,{onClick:()=>o("delete"),size:"clear",children:[a.jsx(pt,{}),a.jsx("span",{children:"Delete"})]}),a.jsxs(ce,{variant:"animation",ref:i,children:[r==="edit"&&a.jsx(KQ,{closeModal:l}),r==="change-file"&&a.jsx(XQ,{closeModal:l}),r==="delete"&&t&&a.jsx(qt,{loading:n,label:`Delete '${t.name}' ?`,desc:"This action cannot be undone",callback:()=>e({variant:"delete",song:t}),closeModal:l})]})]})}function ZQ(){const{setImageFile:t,songData:e,updateSongData:n,imageBlob:r,setImageBlob:s}=as(),i=h.useRef(null),o=c=>{var u;(u=c.target.files)!=null&&u.length&&t(c.target.files[0])},l=()=>{e&&(s(void 0),URL.revokeObjectURL(e.image_url),n({image_url:""}))};return a.jsxs(a.Fragment,{children:[a.jsx(q,{className:"except",size:"clear",children:a.jsxs("label",{htmlFor:"image_upload",className:"inline-flex p-1.5 space-x-1 md:px-3",children:[a.jsx(di,{}),a.jsx("span",{children:"Change image"})]})}),r&&a.jsxs(q,{onClick:l,size:"clear",children:[a.jsx(oo,{}),a.jsx("span",{children:"Discard image"})]}),a.jsx("input",{ref:i,onChange:o,type:"file",multiple:!0,accept:"image/png, image/jpeg",id:"image_upload",className:"hidden"})]})}function ZN({title:t}){const{setSongFile:e}=as(),n=h.useRef(null),r=s=>{var i,o,l;(o=(i=s.target)==null?void 0:i.files)!=null&&o.length&&e((l=s.target)==null?void 0:l.files[0])};return a.jsxs(a.Fragment,{children:[a.jsx("label",{ref:n,htmlFor:"song_upload",className:"hidden",children:a.jsx(lv,{className:"w-6"})}),a.jsx("input",{onChange:r,type:"file",multiple:!0,accept:"audio",id:"song_upload",className:"hidden"}),a.jsxs(q,{onClick:()=>{var s;return(s=n.current)==null?void 0:s.click()},children:[a.jsx(pm,{}),a.jsx("span",{children:t})]})]})}function eX({isEdit:t}){return a.jsx(a.Fragment,{children:a.jsxs(Bl,{className:"[&_span]:text-sm",children:[a.jsx(ZQ,{}),t&&a.jsx(JQ,{}),!t&&a.jsx(ZN,{title:"Change song file"})]})})}function Eu({children:t,className:e="space-y-1"}){return a.jsx(Ot,{className:"text-sm  [&_span]:font-semibold [&_span]:text-[#666] [&_span]:mr-1 "+e,children:t})}function tX(){const{songData:t,updateSongData:e,variant:n}=as();return a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("div",{children:"Name"}),n.current==="edit"?a.jsx(ee,{variant:"h1",title:(t==null?void 0:t.name)||""}):a.jsx(_n,{className:"mt-2",placeholder:"...",value:(t==null?void 0:t.name)||"",onChange:r=>e({name:r.target.value})})]}),a.jsxs("div",{children:[a.jsx("div",{children:"Release year"}),n.current==="edit"?a.jsx(ee,{variant:"h2",title:(t==null?void 0:t.release_year)+""}):a.jsx(_n,{className:"mt-2 md:w-[50%]",placeholder:"...",type:"number",step:1,value:(t==null?void 0:t.release_year)+"",onChange:r=>isNaN(+r.target.value)?{}:e({release_year:+r.target.value})})]})]})}function eA(t){const{isFetching:e,handleSubmit:n,isValidToSubmit:r,modalRef:s,handleCloseModalAfterFinished:i,updateSongData:o}=WQ(t),{songFile:l,songData:c,song:u,audioRef:d}=as(),{api:m,isFetching:p}=fp(),g=h.useMemo(()=>u?u.updated_at:"",[u]);return h.useEffect(()=>{m()}),a.jsxs(a.Fragment,{children:[p?a.jsx(ze,{children:a.jsx(Vn,{})}):a.jsx(a.Fragment,{children:!l&&t.variant==="add"&&a.jsx(ze,{children:a.jsx(Bl,{children:a.jsx(ZN,{title:"Upload song file"})})})}),a.jsxs("div",{className:`w-full md:max-w-[800px] md:mx-auto ${t.variant==="add"&&(l?"":"hidden")}`,children:[a.jsx("audio",{ref:d,className:"hidden"}),a.jsxs("div",{className:`relative mt-5 md:flex md:space-x-5 ${Qs(e,"disable")}`,children:[a.jsxs("div",{className:"flex flex-col items-center md:w-1/3 md:block space-y-3",children:[a.jsx("div",{className:"max-w-[200px] w-full aspect-[1/1]  rounded-lg overflow-hidden",children:a.jsx(Ce,{className:"object-cover h-full",blurHashEncode:c==null?void 0:c.blurhash_encode,src:c==null?void 0:c.image_url})}),a.jsxs("div",{className:"flex md:block mt-5",children:[t.variant==="edit"&&a.jsxs(Eu,{children:[a.jsxs("p",{children:[a.jsx("span",{children:"Total plays:"}),c==null?void 0:c.today_play]}),a.jsxs("p",{children:[a.jsx("span",{children:"Week plays:"}),c==null?void 0:c.week_play]}),a.jsxs("p",{children:[a.jsx("span",{children:"Today plays:"}),c==null?void 0:c.today_play]}),a.jsxs("p",{children:[a.jsx("span",{children:"Ranking:"}),c==null?void 0:c.last_week_rank]}),a.jsx(Ym,{init:(u==null?void 0:u.like)||0,loading:!1,submit:(x,w)=>{o({like:x}),w()}}),a.jsxs("p",{children:[a.jsx("span",{children:"Comments:"}),ns((c==null?void 0:c.comment)||0)]}),a.jsxs("p",{children:[a.jsx("span",{children:"Last listen:"}),El(c==null?void 0:c.last_active)]}),a.jsxs("p",{children:[a.jsx("span",{children:"Last update:"}),El(g)]})]}),a.jsx("div",{className:"ml-3 md:ml-0 md:mt-3",children:a.jsx(eX,{isEdit:t.variant==="edit"})})]})]}),a.jsxs("div",{className:"mt-5 md:mt-0 space-y-5 flex-grow",children:[a.jsx(Ot,{children:d.current&&a.jsx(BW,{audioEle:d.current})}),a.jsxs("div",{children:[a.jsx(ee,{variant:"h2",className:"mb-3",title:"Info"}),a.jsxs(Ot,{className:"space-y-5",children:[a.jsx(tX,{}),a.jsx(zW,{}),a.jsx(WW,{})]})]})]})]}),a.jsx("p",{className:"text-center mt-5",children:a.jsxs(q,{onClick:n,disabled:!r,loading:e,children:[a.jsx(Ku,{className:"w-6"}),a.jsx("span",{children:"Save"})]})})]}),a.jsx(ce,{persisted:t.variant==="add",ref:s,variant:"animation",children:a.jsx(qQ,{variant:t.variant,handleCloseModal:i})})]})}function nX(){const{user:t}=xe();if(t)return a.jsxs(a.Fragment,{children:[a.jsx(ee,{className:"mb-5",title:"Add Song"}),a.jsx(eA,{distributor:t.display_name,ownerEmail:t.email,variant:"add"})]})}function rX(){const[t,e]=h.useState(!0),[n,r]=h.useState(),s=h.useRef(!1),i=Nt(),{setErrorToast:o}=te();return{song:n,isFetching:t,getSong:async c=>{try{const u=await Wt({collectionName:"Songs",id:c,msg:"useGetSong, Get song doc"});if(!u.exists())return i("/dashboard/song");const d={...u.data(),id:u.id,queue_id:""};r(d)}catch(u){console.log(u),o()}finally{e(!1)}},ranEffect:s}}function sX(){const{getSong:t,isFetching:e,song:n,ranEffect:r}=rX(),{variant:s,setSong:i}=as(),o=ci();return h.useEffect(()=>{if(!r.current){if(s.current="edit",r.current=!0,!o.songId)return;t(o.songId)}},[]),h.useEffect(()=>{n&&i(n)},[n]),e?a.jsx(ze,{children:a.jsx(Vn,{})}):n?a.jsxs(a.Fragment,{children:[a.jsx(ee,{className:"mb-5",title:"Song Detail"}),a.jsx(eA,{song:n,variant:"edit"})]}):a.jsx(ze,{children:a.jsx(Re,{})})}const iX=["All","Result"];function aX(){const{setPlaylists:t,lastDoc:e,PAGE_SIZE:n,setHasMore:r,shouldGetPlaylists:s}=td(),[i,o]=h.useState(""),[l,c]=h.useState(!0),[u,d]=h.useState("All"),[m,p]=h.useState([]),{setErrorToast:g}=te(),x=async v=>{try{if(v.preventDefault(),l)return;c(!0);const S=lr(vn,[Q("is_official","==",!0)],i),_=await Ln(S);p(_),d("Result")}catch(S){console.log({message:S}),g()}finally{c(!1)}},w=async()=>{try{c(!0);const v=e.current?le(vn,Q("is_official","==",!0),Q("is_album","==",!1),Lt("updated_at","desc"),Hm(e.current),Mt(n)):le(vn,Q("is_official","==",!0),Q("is_album","==",!1),Lt("updated_at","desc"),Mt(n)),S=await bt(v),_=S.docs.map(E=>({...E.data(),id:E.id}));e.current?t(E=>[...E,..._]):t(_),_.length<n?r(!1):e.current=S.docs[n-1]}catch(v){console.log({message:v}),g()}finally{c(!1)}};return h.useEffect(()=>{s.current?(s.current=!1,w()):c(!1)},[u]),{isFetching:l,value:i,setValue:o,handleSubmit:x,getPlaylists:w,tab:u,searchResult:m,setTab:d,tabs:iX}}function oX(){const{user:t}=xe(),{setPlaylists:e}=td(),{addPlaylist:n,isFetching:r}=Pw(),s=h.useRef(null),i=()=>{var l;return(l=s.current)==null?void 0:l.close()},o=async(l,c)=>{l.is_official=!0;const u=await n({variant:"add",playlist:l,imageFile:c},{push:!1});u&&e(d=>[u,...d]),i()};if(t)return a.jsxs(a.Fragment,{children:[a.jsxs(q,{onClick:()=>{var l;return(l=s.current)==null?void 0:l.open()},className:"self-start p-1.5 ml-5",size:"clear",color:"primary",children:[a.jsx(Es,{className:"w-6"}),a.jsx("div",{className:"hidden md:block",children:"Add new playlist"})]}),a.jsx(ce,{ref:s,variant:"animation",children:a.jsx(_e,{className:"w-[600px]",children:a.jsx(Gl,{modalRef:s,isLoading:r,variant:"add",user:t,submit:o})})})]})}function lX(){const{playlists:t,hasMore:e}=td(),{isFetching:n,getPlaylists:r,searchResult:s,tab:i,tabs:o,setTab:l,...c}=aX(),u=h.useMemo(()=>i==="All"?t:s,[i,t,s]);return a.jsxs(a.Fragment,{children:[a.jsx(ee,{title:"Playlists"}),a.jsxs("div",{className:"flex justify-between mt-3",children:[a.jsx(fo,{loading:i==="Result"&&n,...c}),a.jsx(oX,{})]}),a.jsx("div",{className:"mt-5 w-fit self-start",children:a.jsx(tr,{disable:i==="All",tabs:o,render:d=>d,tab:i,setTab:l})}),a.jsx("div",{className:"mt-3",children:a.jsx(is,{colList:["Name","Like",""],children:u.length?a.jsxs(a.Fragment,{children:[u.map((d,m)=>a.jsxs("tr",{children:[a.jsx("td",{children:a.jsx(X,{className:"hover:underline",to:`/dashboard/playlist/${d.id}`,children:d.name})}),a.jsx("td",{children:ns(d.like)}),a.jsx("td",{children:"-"})]},m)),i==="All"&&n&&a.jsx("tr",{className:"no-hover border-none",children:a.jsx("td",{colSpan:9,children:a.jsx(Ae,{className:"animate-spin w-7 mx-auto"})})}),i==="All"&&a.jsx("tr",{className:"no-hover",children:a.jsx("td",{colSpan:9,className:"text-center hover:bg-none",children:a.jsx(q,{disabled:!e,onClick:r,children:"Get more"})})})]}):a.jsx("tr",{children:a.jsx("td",{colSpan:4,children:a.jsx(Re,{})})})})})]})}const cX=["Newest","Result"];function uX(){const{uploadedSongs:t,setUploadedSongs:e,shouldFetchUserSongs:n,lastDoc:r,PAGE_SIZE:s,setHasMore:i}=it(),[o,l]=h.useState("Newest"),[c,u]=h.useState([]),[d,m]=h.useState(""),[p,g]=h.useState(!1),{setErrorToast:x}=te(),w=async()=>{try{g(!0),i(E=>r.current&&!E?(r.current=void 0,!E):E);const S=le(_t,Q("is_official","==",!0),Lt("updated_at","desc"),Mt(s)),_=await $t(S);e(_)}catch(S){console.log(S)}finally{g(!1)}},v=async S=>{try{S.preventDefault(),g(!0),l("Result");const _=lr(_t,[Q("is_official","==",!0)],d),E=await $t(_);u(E)}catch(_){console.log({message:_}),x()}finally{g(!1)}};return h.useEffect(()=>{n.current&&(n.current=!1,w())},[]),{isFetching:p,value:d,getNewestSongs:w,result:c,uploadedSongs:t,setValue:m,handleSubmit:v,tabs:cX,tab:o,setTab:l}}function dX({closeModal:t,submit:e,isLoading:n,current:r}){const{uploadedSongs:s,result:i,getNewestSongs:o,isFetching:l,setTab:c,tabs:u,tab:d,...m}=uX(),{selectedSongs:p,selectSong:g}=ho(),x=async()=>{p.length&&(e(p),t())},w={col:"md:w-1/2 flex-1 flex flex-col px-2 overflow-hidden",box:"rounded-lg bg-[--a-5-cl] p-2",songItem:"rounded-md w-full p-1 text-sm font-semibold text-left hover:bg-[--a-5-cl]"},v=S=>S.map((_,E)=>{const I=r.includes(_.id);return a.jsx("button",{onClick:()=>g(_),className:`${w.songItem} ${I||p.find(P=>P.id===_.id)?"text-[--primary-cl]":""} `,children:_.name},E)});return a.jsx(a.Fragment,{children:a.jsxs(_e,{className:"w-[600px] min-h-[400px]",children:[a.jsx(Be,{closeModal:t,title:"Add songs"}),a.jsx(fo,{className:"w-fit",...m}),a.jsxs("div",{className:"flex-grow flex flex-col md:flex-row -mx-2 overflow-hidden mt-3",children:[a.jsxs("div",{className:`${w.col}`,children:[a.jsx(tr,{className:"w-fit mb-1",buttonClasses:"[&_button]:px-3 [&_button]:py-1/2",tabs:u,setTab:c,tab:d,render:S=>S}),a.jsx("div",{className:`${w.box} flex-grow overflow-auto`,children:l?a.jsx(Vn,{className:"h-full"}):a.jsx(a.Fragment,{children:d==="Result"?v(i):a.jsxs(a.Fragment,{children:[v(s),a.jsx("p",{className:"text-center mt-3",children:a.jsx(q,{onClick:o,size:"clear",className:"p-1",children:a.jsx(Ae,{className:"w-5"})})})]})})})]}),a.jsxs("div",{className:`${w.col} mt-3 md:mt-0`,children:[a.jsx(Dt,{className:"mb-1 md:h-[36px]",children:"Selected"}),a.jsx("div",{className:`${w.box} flex-grow overflow-auto`,children:v(p)})]})]}),a.jsx("p",{className:"text-right mt-3 flex-shrink-0",children:a.jsxs(q,{disabled:!p.length,loading:n,onClick:x,children:[a.jsx(aa,{className:"w-6"}),a.jsx("span",{children:"Add"})]})}),n&&a.jsx(da,{})]})})}function Zw(t){return a.jsx(En,{children:a.jsx(dX,{...t})})}function hX(){const{songs:t}=Qm(),[e,n]=h.useState(""),r=h.useRef(null),{action:s,playlist:i,isFetching:o}=Xm(),l=m=>{var p,g;n(m),e==="add-song-to-playlist"&&((p=r.current)==null||p.setModalPersist(!0)),(g=r.current)==null||g.open()},c=()=>{var m;return(m=r.current)==null?void 0:m.close()},u=async m=>{await s(m),c()},d=()=>{switch(e){case"":return a.jsx(a.Fragment,{});case"edit":return i?a.jsx(a.Fragment,{children:a.jsx(_e,{className:"w-[600px]",children:a.jsx(Gl,{submit:(m,p)=>u({variant:"edit-playlist",playlist:m,imageFile:p}),variant:"edit",isLoading:o,playlist:i,modalRef:r})})}):"Playlist is undefined";case"delete":return a.jsx(qt,{loading:o,label:"Delete playlist ?",callback:()=>u({variant:"delete-playlist"}),closeModal:c});case"add-song-to-playlist":return a.jsx(Zw,{isLoading:o,submit:m=>u({variant:"add-songs",songs:m}),closeModal:c,current:t.map(m=>m.id)})}};return a.jsxs(a.Fragment,{children:[a.jsxs(Bl,{children:[a.jsxs(q,{onClick:()=>l("edit"),size:"clear",children:[a.jsx(Dr,{}),a.jsx("span",{children:"Edit"})]}),a.jsxs(q,{onClick:()=>l("delete"),size:"clear",children:[a.jsx(pt,{}),a.jsx("span",{children:"Delete"})]}),a.jsxs(q,{onClick:()=>l("add-song-to-playlist"),size:"clear",children:[a.jsx(KU,{}),a.jsx("span",{children:"Add song"})]})]}),a.jsx(ce,{variant:"animation",ref:r,children:d()})]})}function fX(){const[t,e]=h.useState(!0),{setSongs:n,setPlaylist:r}=Qm(),s=h.useRef(!1),i=ci(),o=Nt(),{setErrorToast:l}=te(),c=async()=>{try{if(!i.id)return;const u=await Wt({collectionName:"Playlists",id:i.id,msg:"useGetPlaylist, get playlist doc"});if(!u.exists())return o("/dashboard/playlist");const d={...u.data(),id:u.id};if(d.song_ids.length){const m=le(_t,Q(Lr(),"in",d.song_ids)),p=await $t(m);n(p)}r(d)}catch(u){console.log(u),l()}finally{e(!1)}};return h.useEffect(()=>{s.current||(s.current=!0,c())},[]),{isFetching:t}}function mX({singer:t}){const{action:e}=Xm();return a.jsxs(a.Fragment,{children:[a.jsx(X,{className:"hover:underline",to:`/dashboard/singer/${t.id}`,children:t.name}),a.jsx("div",{children:a.jsx("button",{onClick:()=>e({variant:"remove-singer",singer:t}),children:a.jsx(pt,{className:"w-5"})})})]})}function pX(){const{playlist:t,songs:e}=Qm(),{isFetching:n}=fX(),{action:r,isFetching:s}=Xm(),i=async(l,c)=>{await r({variant:"edit-playlist",playlist:{like:l,updated_at:mt()}}),c()},o=h.useMemo(()=>t==null?void 0:t.updated_at,[t==null?void 0:t.id]);return n?a.jsx(ze,{children:a.jsx(Vn,{})}):t?a.jsxs(a.Fragment,{children:[a.jsx(ee,{title:"Edit playlist",className:"mb-8"}),a.jsxs("div",{className:"md:flex md:-mx-3",children:[a.jsxs("div",{className:"space-y-3 md:px-3",children:[a.jsx("div",{className:"w-[200px] h-[200px] mx-auto rounded-md overflow-hidden",children:a.jsx(Ce,{className:"object-cover h-full",blurHashEncode:t.blurhash_encode,src:t.image_url})}),a.jsx(ee,{variant:"h2",title:t.name}),a.jsxs(Eu,{children:[a.jsxs("p",{children:[a.jsx("span",{children:"Public:"}),t.is_public?"Public":"Private"]}),a.jsxs("p",{children:[a.jsx("span",{children:"Songs:"}),e.length," songs"]}),a.jsxs("p",{children:[a.jsx("span",{children:"Comments:"}),ns(t.comment)]}),a.jsx(Ym,{init:t.like,loading:s,submit:i}),a.jsxs("p",{children:[a.jsx("span",{children:"Last update:"}),o?El(o):""]})]}),a.jsx(hX,{})]}),a.jsxs("div",{className:"w-full mt-3 md:mt-0 md:w-3/4 md:px-3",children:[a.jsx(ee,{variant:"h3",title:"Singers"}),a.jsx(Ot,{className:"mt-1",children:t.singers.length?a.jsx("div",{className:"-mt-2 -ml-2 flex ",children:t.singers.map((l,c)=>a.jsx(ks,{children:a.jsx(mX,{singer:l})},c))}):a.jsx(Re,{})}),a.jsx(ee,{title:"Songs",variant:"h3",className:"mt-3"}),a.jsx(Ot,{className:"mt-1",children:a.jsx("div",{className:"overflow-hidden",children:a.jsx(vR,{className:"[&_td]:text-sm [&_tbody>tr]:border-t [&_tr]:border-black/10 [&_th]:text-sm [&_th]:text-left [&_td]:p-2 [&_th]:p-2 hover:[&_tr:not(div.absolute)]:bg-black/5",colList:["Name","Singer","Genre",""],children:e.length?e.map((l,c)=>{var u;return a.jsxs("tr",{children:[a.jsx("td",{children:a.jsx(X,{to:`/dashboard/song/${l.id}/edit`,className:"hover:underline",children:l.name})}),a.jsx("td",{children:l.singers.map((d,m)=>a.jsxs(X,{className:"hover:underline",to:`/dashboard/singer/${d.id}`,children:[!!m&&", ",d.name]},m))}),a.jsx("td",{children:(u=l.main_genre)==null?void 0:u.name}),a.jsx("td",{children:a.jsx(dR,{variant:"playlist",song:l})})]},c)}):a.jsx("tr",{children:a.jsx("td",{colSpan:4,children:a.jsx(Re,{})})})})})})]})]})]}):a.jsx(a.Fragment,{})}function gX(){return a.jsx(R8,{children:a.jsx(pX,{})})}function tA(t){const e=h.useRef(null),{setImageFile:n,singerData:r,handleSubmit:s,isFetching:i,isValidToSubmit:o,updateSingerData:l,inputRef:c}=kN(t),u=d=>{var m;(m=d.target.files)!=null&&m.length&&n(d.target.files[0])};if(r)return a.jsxs(_e,{className:"w-[700px]",children:[a.jsx(Be,{closeModal:()=>{var d;return(d=t.modalRef.current)==null?void 0:d.close()},title:t.variant==="add"?"Add singer":"Edit singer"}),a.jsxs("div",{className:"flex-grow overflow-auto md:flex md:flex-[unset]",children:[a.jsxs("div",{className:"space-y-2.5",children:[a.jsx("div",{className:"w-[200px] h-[200px] rounded-lg border overflow-hidden",children:a.jsx(Ce,{className:"object-cover object-center h-full",blurHashEncode:r.blurhash_encode,src:r.image_url})}),a.jsx("label",{ref:e,htmlFor:"image_upload",className:"hidden"}),a.jsx("input",{onChange:u,type:"file",multiple:!0,accept:"image/png, image/jpeg, image/webp",id:"image_upload",className:"hidden"}),a.jsx(q,{onClick:()=>{var d;return(d=e.current)==null?void 0:d.click()},children:a.jsx(di,{className:"w-5"})})]}),a.jsxs("div",{className:"flex-grow flex flex-col mt-3  space-y-3 md:mt-0 md:ml-5",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx(Dt,{htmlFor:"name",children:"Name"}),a.jsx(_n,{ref:c,type:"text",id:"name",placeholder:"",value:r.name,onChange:d=>l({name:d.target.value})})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx(Dt,{htmlFor:"description",children:"Description"}),a.jsx("textarea",{placeholder:"...",id:"description",className:`${dl} rounded-md min-h-[100px]`,value:r.description,onChange:d=>l({description:d.target.value})})]})]})]}),a.jsx("p",{className:"text-right mt-3",children:a.jsx(q,{loading:i,color:"primary",onClick:s,disabled:!o,className:"font-playwriteCU rounded-full",children:"Save"})})]})}function xX(){const t=h.useRef(null);return a.jsxs(a.Fragment,{children:[a.jsxs(q,{onClick:()=>{var e;return(e=t.current)==null?void 0:e.open()},className:"self-start p-1.5 ml-5",size:"clear",children:[a.jsx(Es,{className:"w-6"}),a.jsx("div",{className:"hidden md:block",children:"Add new singer"})]}),a.jsx(ce,{ref:t,variant:"animation",children:a.jsx(tA,{modalRef:t,variant:"add"})})]})}const yX=["All","Result"];function vX(){const{setSingers:t,PAGE_SIZE:e,singers:n,setHasMore:r,shouldGetSingers:s,lastDoc:i}=os(),[o,l]=h.useState(!0),[c,u]=h.useState("All"),{handleSubmit:d,result:m,value:p,setValue:g}=bN({afterSearched:()=>{u("Result")},setIsFetchingParent:l}),{setErrorToast:x}=te(),w=async()=>{try{l(!0);const v=i.current?le(Qa,Lt("created_at","desc"),Hm(i.current),Mt(e)):le(Qa,Lt("created_at","desc"),Mt(e)),S=await bt(v),_=S.docs.map(E=>({...E.data(),id:E.id}));i.current?t(E=>[...E,..._]):t(_),_.length<e?r(!1):i.current=S.docs[e-1]}catch(v){console.log({message:v}),x()}finally{l(!1)}};return h.useEffect(()=>{s.current?(s.current=!1,w()):l(!1)},[]),{isFetching:o,value:p,setValue:g,handleSubmit:d,singers:n,tab:c,getSingers:w,setTab:u,result:m,tabs:yX}}function wX(){const{hasMore:t,singers:e}=os(),{isFetching:n,result:r,getSingers:s,tabs:i,tab:o,setTab:l,...c}=vX(),u=h.useMemo(()=>o==="All"?e:r,[o,e,r]);return a.jsxs(a.Fragment,{children:[a.jsx(ee,{title:"Singers"}),a.jsxs("div",{className:"flex justify-between mt-3",children:[a.jsx(fo,{loading:o==="Result"&&n,...c}),a.jsx(xX,{})]}),a.jsx("div",{className:"mt-5 w-fit self-start",children:a.jsx(tr,{disable:o==="All",tabs:i,render:d=>d,tab:o,setTab:l})}),a.jsx("div",{className:"mt-3",children:a.jsx(is,{colList:["Name","Like"],children:u.length?a.jsxs(a.Fragment,{children:[u.map((d,m)=>a.jsxs("tr",{children:[a.jsx("td",{children:a.jsx(X,{className:"hover:underline",to:`/dashboard/singer/${d.id}`,children:d.name})}),a.jsx("td",{children:ns(d.like)})]},m)),n&&a.jsx("tr",{className:"no-hover border-none",children:a.jsx("td",{colSpan:9,children:a.jsx(Ae,{className:"animate-spin w-7 mx-auto"})})}),o==="All"&&a.jsx("tr",{className:"no-hover",children:a.jsx("td",{colSpan:9,className:"text-center hover:bg-none",children:a.jsx(q,{disabled:!t,onClick:s,children:"Get more"})})})]}):a.jsx("tr",{children:a.jsx("td",{colSpan:2,children:a.jsx(Re,{})})})})})]})}function _X({value:t}){const e=h.useRef(null);return a.jsxs(a.Fragment,{children:[a.jsxs(q,{onClick:()=>{var n;return(n=e.current)==null?void 0:n.open()},className:"p-1.5 ml-5",size:"clear",children:[a.jsx(zt,{className:"w-6"}),a.jsx("div",{className:"hidden md:block",children:"Add genre"})]}),a.jsx(ce,{ref:e,variant:"animation",children:a.jsx(hp,{genreName:t,type:"add",closeModal:()=>{var n;return(n=e.current)==null?void 0:n.close()}})})]})}function e0({genre:t}){const[e,n]=h.useState(""),r=h.useRef(null),{action:s,isFetching:i}=IN(),o=u=>{var d;n(u),(d=r.current)==null||d.open()},l=()=>{var u;return(u=r.current)==null?void 0:u.close()},c=async()=>{await s({type:"delete",id:t.id})};return a.jsxs(a.Fragment,{children:[a.jsxs(ks,{children:[a.jsx("span",{children:t.name}),a.jsxs("div",{children:[a.jsx("button",{className:"",onClick:()=>o("edit"),children:a.jsx(Dr,{className:"w-5"})}),a.jsx("button",{onClick:()=>o("delete"),children:a.jsx(pt,{className:"w-5"})})]})]}),a.jsxs(ce,{variant:"animation",ref:r,children:[e==="edit"&&a.jsx(hp,{type:"edit",genre:t,closeModal:l}),e==="delete"&&a.jsx(qt,{callback:c,closeModal:l,loading:i,label:`Delete genre '${t.name}'`})]})]})}function SX(){const{isFetching:t,api:e}=fp(),{_genres:n,mains:r,subs:s,...i}=CN();return h.useEffect(()=>{e()},[]),a.jsxs(a.Fragment,{children:[a.jsx(ee,{title:"Genres"}),a.jsxs("div",{className:"flex justify-between items-start mt-3",children:[a.jsx(hR,{...i}),a.jsx(_X,{value:i.value})]}),a.jsxs("div",{className:"mt-5 space-y-5",children:[t&&a.jsx(ge,{className:"h-[200px] rounded-xl"}),!t&&a.jsx(a.Fragment,{children:n.length?a.jsx("div",{className:"flex flex-wrap -mt-2 -mx-2",children:n.map(o=>a.jsx(e0,{genre:o},o.id))}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx(ee,{variant:"h3",className:"mb-1",title:"Main genres"}),a.jsx(Ot,{className:"mt-1",children:r.length?a.jsx("div",{className:"flex flex-wrap -mt-2  -mx-2",children:r.map(o=>a.jsx(e0,{genre:o},o.id))}):a.jsx(Re,{})})]}),a.jsxs("div",{children:[a.jsx(ee,{variant:"h3",className:"mb-1",title:"Sub genres"}),a.jsx(Ot,{className:"mt-1",children:s.length?a.jsx("div",{className:"flex flex-wrap -mt-2 -mx-2",children:s.map(o=>a.jsx(e0,{genre:o},o.id))}):a.jsx(Re,{})})]})]})})]})]})}function o2(){return a.jsx(vN,{})}function bX(){const{setErrorToast:t}=te(),{singer:e,setSinger:n,shouldGetSingers:r,lastDoc:s}=os(),[i,o]=h.useState(!1),l=Nt();return{isFetching:i,action:async u=>{try{switch(u.variant){case"delete":{if(!e)throw new Error("");o(!0),await Km({collectionName:"Singers",id:e.id}),e.image_file_id&&Gt({fileId:e.image_file_id}),o(!1),r.current=!0,s.current=void 0,l("/dashboard/singer");break}}}catch(d){console.log({message:d}),t("")}finally{o(!1)}},singer:e,setSinger:n}}function EX(){const[t,e]=h.useState(""),n=h.useRef(null),{action:r,isFetching:s,singer:i}=bX(),o=c=>{var u;e(c),(u=n.current)==null||u.open()},l=()=>{var c;return(c=n.current)==null?void 0:c.close()};return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"mt-3",children:a.jsxs(Bl,{children:[a.jsxs(q,{onClick:()=>o("edit"),className:"md:px-3",size:"clear",children:[a.jsx(Dr,{className:"w-6"}),a.jsx("span",{children:"Edit singer"})]}),a.jsxs(q,{onClick:()=>o("delete"),className:"md:px-3",size:"clear",children:[a.jsx(pt,{className:"w-6"}),a.jsx("span",{children:"Delete"})]})]})}),a.jsxs(ce,{variant:"animation",ref:n,children:[t==="more"&&i&&a.jsx(_e,{children:i.description}),t==="edit"&&a.jsx(tA,{modalRef:n,variant:"edit"}),t==="delete"&&i&&a.jsx(qt,{label:`Delete singer '${i.name}'`,loading:s,callback:()=>r({variant:"delete"}),closeModal:l})]})]})}function kX(){const{setSinger:t,setSongs:e,setPlaylists:n,setAlbums:r}=os(),{setErrorToast:s}=te(),{setIsFetching:i}=ld(),o=ci(),l=Nt(),c=h.useRef(!1),u=async()=>{try{if(!o.id)return;const d=await Wt({collectionName:"Singers",id:o.id});d.exists()||l("/dashboard/singer");const m={...d.data(),id:o.id},p=le(_t,Q(`singer_map.${m.id}`,"==",!0)),g=await $t(p),x=le(vn,Q(`singer_map.${m.id}`,"==",!0)),w=await Ln(x),v=[],S=[];w.forEach(_=>_.is_album?S.push(_):v.push(_)),t(m),n(v),r(S),e(g)}catch(d){console.log({error:d}),s()}finally{i(!1)}};h.useEffect(()=>{c.current||(c.current=!0,u())},[])}function jX(){const[t,e]=h.useState(!0);return{isFetching:t,setIsFetching:e}}const nA=h.createContext(null);function TX({children:t}){return kX(),t}function IX({children:t}){return a.jsx(nA.Provider,{value:jX(),children:a.jsx(TX,{children:t})})}function ld(){const t=h.useContext(nA);if(!t)throw new Error;return t}function CX(){const{singer:t,setSinger:e}=os(),{isFetching:n}=ld(),r=async(s,i)=>{t&&(await Se({collectionName:"Singers",id:t.id,data:{like:s}}),e({...t,like:s}),i())};return!n&&!t?a.jsx(a.Fragment,{}):a.jsx(a.Fragment,{children:a.jsxs("div",{className:"md:flex",children:[a.jsx("div",{className:"flex-shrink-0 w-[260px] h-[260px] rounded-md overflow-hidden mx-auto md:m-unset",children:n?a.jsx(ge,{className:"pt-[100%] "}):a.jsx(Ce,{className:"object-cover",src:t==null?void 0:t.image_url,blurHashEncode:(t==null?void 0:t.blurhash_encode)||""})}),a.jsx("div",{className:"flex-grow flex flex-col mt-5 space-y-2.5  md:mt-0 md:ml-5",children:n?a.jsxs(a.Fragment,{children:[a.jsx(ge,{className:"h-[60px] w-full md:w-[200px]"}),a.jsx(ge,{className:"h-[120px] w-full md:w-[70%]"}),a.jsx(ge,{className:"h-[17px] w-[200px]"})]}):t&&a.jsxs(a.Fragment,{children:[a.jsxs(Eu,{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("span",{children:"Name"}),a.jsx(ee,{variant:"h1",title:t.name})]}),a.jsx(Ym,{init:t.like,loading:!1,submit:r}),a.jsxs("p",{children:[a.jsx("span",{children:"Description"})," ",a.jsx("br",{}),t.description]})]}),a.jsx(EX,{})]})})]})})}function RX(){const{songs:t}=os(),{isFetching:e}=ld();return a.jsxs(a.Fragment,{children:[a.jsx(ee,{variant:"h2",title:"Songs"}),a.jsx(En,{children:e?a.jsx(ge,{className:"h-[100px]"}):a.jsx(is,{colList:["Name","Singers","Genres"],children:t.length?t.map((n,r)=>a.jsxs("tr",{className:"hover:bg-black/10",children:[a.jsx("td",{children:a.jsx(X,{to:`/dashboard/song/${n.id}/edit`,children:n.name})}),a.jsx("td",{children:n.singers.map((s,i)=>a.jsx(X,{to:`/dashboard/singer/${s.id}`,className:"hover:text-green-500 hover:underline",children:(i?", ":"")+s.name},i))}),a.jsx("td",{children:n.genres.map((s,i)=>a.jsxs("span",{children:[!!i&&", ",s.name]},i))})]},r)):a.jsx("tr",{children:a.jsx("td",{colSpan:4,children:a.jsx(Re,{})})})})})]})}function NX(){const{playlists:t}=os(),{isFetching:e}=ld();return a.jsxs(a.Fragment,{children:[a.jsx(ee,{variant:"h2",title:"Playlists"}),e&&a.jsx(ge,{className:"h-[100px]"}),!e&&a.jsx(is,{colList:["Name",""],children:t.length?t.map((n,r)=>a.jsxs("tr",{className:"hover:bg-black/10",children:[a.jsx("td",{children:a.jsx(X,{to:`/dashboard/playlist/${n.id}`,children:n.name})}),a.jsx("td",{children:"-"})]},r)):a.jsx("tr",{children:a.jsx("td",{colSpan:2,children:a.jsx(Re,{})})})})]})}function AX(){const[t,e]=h.useState(),[n,r]=h.useState(),[s,i]=h.useState();return{singer:t,setSinger:e,updateAlbumData:l=>{n&&r({...n,...l})},albumData:n,imageFile:s,setImageFile:i,setAlbumData:r}}const rA=h.createContext(null);function PX({children:t}){return a.jsx(rA.Provider,{value:AX(),children:t})}function e1(){const t=h.useContext(rA);if(!t)throw new Error("AddAlbumProvider not provided");return t}function FX(t){const{imageFile:e,updateAlbumData:n,setSinger:r,albumData:s,singer:i,setImageFile:o,setAlbumData:l}=e1(),{setSuccessToast:c,setErrorToast:u}=te(),[d,m]=h.useState(!1),p=h.useRef(!1),g=h.useMemo(()=>t.variant==="add"?!0:!t.album||!s?!1:s.name!==t.album.name||(i==null?void 0:i.id)!==t.album.singers[0].id||s.like!==t.album.like,[s,i]),x=!!e,w=h.useMemo(()=>{const _=!!g&&!!s&&!!s.name&&!!i;return t.variant==="add"?_:_||x},[x,g,s,i]),v=async()=>{var _;try{if(!s||!i)return;if(m(!0),e){const E=await pi({imageFile:e});Object.assign(s,E)}switch(s.singers=[i],s.singer_map={[i.id]:!0},s.name=s.name.trim(),s.meta=bn(s.name).split(" "),t.variant){case"add":{const E=await Ts({collectionName:"Playlists",data:s}),I=await _l(E),P={...I.data(),id:I.id};t.afterSubmit(P),c("Album created");break}case"edit":{if(!t.album)return;await Se({collectionName:"Playlists",data:{...s,updated_at:mt()},id:t.album.id}),t.afterSubmit(s),c("Album edited");break}}(_=t.modalRef.current)==null||_.close()}catch(E){console.log(E),u()}finally{m(!1),o(void 0)}},S=async()=>{switch(t.variant){case"add":l(XU({owner_email:t.user.email,distributor:t.user.email})),r(t.singer);break;case"edit":const{id:_,...E}=t.album;r(E.singers[0]),l(E);break}};return h.useEffect(()=>{var _;p.current||(p.current=!0,S(),t.variant==="add"&&((_=t.modalRef.current)==null||_.setModalPersist(!0)))},[]),h.useEffect(()=>{var _;(g||e)&&((_=t.modalRef.current)==null||_.setModalPersist(!0))},[s,i,e]),h.useEffect(()=>{e&&n({image_url:URL.createObjectURL(e)})},[e]),{submit:v,isFetching:d,isValidToSubmit:w}}function MX(){const{singer:t,setSinger:e,albumData:n}=e1(),r=h.useRef(null),s=i=>{var o;e(i),(o=r.current)==null||o.close()};if(n)return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center space-x-1.5",children:[a.jsx(Dt,{children:"Singer"}),t?a.jsxs(ks,{className:"!mt-0",children:[a.jsx("span",{children:t.name}),a.jsx("div",{children:a.jsx("button",{onClick:()=>e(void 0),children:a.jsx(pt,{className:"w-5"})})})]}):a.jsx(q,{size:"clear",className:"p-1.5",onClick:()=>{var i;return(i=r.current)==null?void 0:i.open()},children:a.jsx(zt,{className:"w-5"})})]}),a.jsx(ce,{variant:"animation",ref:r,children:a.jsx(jN,{choose:s,closeModal:()=>{var i;return(i=r.current)==null?void 0:i.close()}})})]})}function DX({className:t="",...e}){const{albumData:n,setImageFile:r,updateAlbumData:s}=e1(),{submit:i,isFetching:o,isValidToSubmit:l}=FX(e),c=h.useRef(null),u=m=>{var p;(p=m.target.files)!=null&&p.length&&r(m.target.files[0])},d=a.jsxs(q,{size:"clear",className:"py-1.5 px-3",onClick:i,loading:o,disabled:!l||o,children:[a.jsx(Ku,{className:"w-6"}),a.jsx("span",{children:"Save"})]});return n?a.jsxs(a.Fragment,{children:[a.jsx(Be,{closeModal:()=>{var m;return(m=e.modalRef.current)==null?void 0:m.close()},title:e.variant==="add"?"Add album":"Edit albm"}),a.jsxs("div",{className:`md:flex ${t} overflow-auto`,children:[a.jsxs("div",{className:"space-y-3",children:[a.jsx(Ot,{p:"clear",className:"w-[200px] mx-auto h-[200px] rounded-lg overflow-hidden",children:a.jsx(Ce,{className:"object-cover object-center h-full",blurHashEncode:n.blurhash_encode,src:n.image_url})}),a.jsx("label",{ref:c,htmlFor:"image_upload"}),a.jsx("input",{onChange:u,type:"file",multiple:!0,accept:"image/png, image/jpeg",id:"image_upload",className:"hidden"}),a.jsx(q,{color:"primary",size:"clear",children:a.jsx("label",{htmlFor:"image_upload",className:"md:px-3 p-1.5 inline-flex space-x-1 cursor-pointer ",children:a.jsx(di,{className:"w-6"})})})]}),a.jsx("div",{className:"md:w-3/4 mt-5 md:mt-0 md:ml-5 flex-grow flex flex-col space-y-5",children:a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx(Dt,{htmlFor:"name",children:"Name"}),a.jsx(_n,{type:"text",placeholder:"name...",id:"name",className:"text-[#333]",value:n.name,onChange:m=>s({name:m.target.value})})]}),a.jsx(MX,{})]})})]}),a.jsx("p",{className:"text-right mt-3",children:d}),o&&a.jsx(da,{})]}):a.jsx(a.Fragment,{})}function t1(t){return a.jsx(PX,{children:a.jsx(DX,{...t})})}function LX(){const{user:t}=xe(),{singer:e,setAlbums:n}=os(),r=h.useRef(null),s=i=>{n(o=>[i,...o])};return a.jsxs(a.Fragment,{children:[a.jsxs(q,{onClick:()=>{var i;return(i=r.current)==null?void 0:i.open()},className:"px-3 py-1",size:"clear",children:[a.jsx(zt,{className:"w-5"}),a.jsx("span",{children:"Add album"})]}),a.jsx(ce,{variant:"animation",ref:r,children:a.jsx(_e,{className:"w-[700px]",children:t&&e&&a.jsxs(a.Fragment,{children:[a.jsx(Be,{title:"Add album",closeModal:()=>{var i;return(i=r.current)==null?void 0:i.close()}}),a.jsx(t1,{className:"flex-grow overflow-auto no-scrollbar md:overflow-hidden",variant:"add",modalRef:r,singer:e,afterSubmit:s,user:t})]})})})]})}function OX(){const{albums:t}=os(),{isFetching:e}=ld();return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx(ee,{variant:"h2",title:"Albums"}),a.jsx(LX,{})]}),e&&a.jsx(ge,{className:"h-[100px]"}),!e&&a.jsx(is,{colList:["Name",""],children:t.length?t.map((n,r)=>a.jsxs("tr",{className:"hover:bg-black/10",children:[a.jsx("td",{children:a.jsx(X,{to:`/dashboard/album/${n.id}`,children:n.name})}),a.jsx("td",{children:"-"})]},r)):a.jsx("tr",{children:a.jsx("td",{colSpan:2,children:a.jsx(Re,{})})})})]})}function $X(){return a.jsx(a.Fragment,{children:a.jsxs("div",{className:"space-y-5",children:[a.jsx(CX,{}),a.jsx(OX,{}),a.jsx(RX,{}),a.jsx(NX,{})]})})}function zX(){return a.jsx(IX,{children:a.jsx($X,{})})}function BX({setAlbums:t}){const{user:e}=xe(),n=h.useRef(null),r=()=>{var i;return(i=n.current)==null?void 0:i.close()},s=i=>{t(o=>[i,...o]),r()};if(e)return a.jsxs(a.Fragment,{children:[a.jsxs(q,{onClick:()=>{var i;return(i=n.current)==null?void 0:i.open()},className:"self-start p-1.5 ml-5",size:"clear",children:[a.jsx(Es,{className:"w-6"}),a.jsx("div",{className:"hidden md:block",children:"Add new album"})]}),a.jsx(ce,{ref:n,variant:"animation",persisted:!0,children:a.jsx(_e,{className:"w-[600px]",children:a.jsx(t1,{className:"overflow-auto",variant:"add",user:e,modalRef:n,afterSubmit:s})})})]})}const VX=["All","Result"];function UX(){const[t,e]=h.useState([]),[n,r]=h.useState(""),[s,i]=h.useState(!0),[o,l]=h.useState("All"),{setErrorToast:c}=te(),u=async m=>{try{if(m.preventDefault(),s)return;i(!0);const p=lr(vn,[Q("is_album","==",!0)],n),g=await Ln(p);e(g),l("Result")}catch(p){console.log({message:p}),c()}finally{i(!1)}},d=async()=>{try{i(!0);const m=le(vn,Q("is_album","==",!0),Lt("created_at","desc")),p=await Ln(m);e(p)}catch(m){console.log({message:m}),c()}finally{i(!1)}};return h.useEffect(()=>{o==="All"&&d()},[o]),{isFetching:s,value:n,setValue:r,handleSubmit:u,albums:t,tab:o,setTab:l,tabs:VX,setAlbums:e}}function HX(){const{isFetching:t,albums:e,tab:n,tabs:r,setTab:s,setAlbums:i,...o}=UX();return a.jsxs(a.Fragment,{children:[a.jsx(ee,{title:"Albums"}),a.jsxs("div",{className:"flex justify-between mt-3",children:[a.jsx(fo,{loading:n==="Result"&&t,...o}),a.jsx(BX,{setAlbums:i})]}),a.jsx("div",{className:"mt-5 w-fit  self-start",children:a.jsx(tr,{disable:n==="All",tabs:r,render:l=>l,tab:n,setTab:s})}),a.jsxs("div",{className:"mt-3",children:[t&&a.jsx(ge,{className:"h-[200px] rounded-xl"}),!t&&a.jsx(is,{colList:["Name","Singer","Like"],children:e.length?e.map((l,c)=>a.jsxs("tr",{children:[a.jsx("td",{children:a.jsx(X,{className:"hover:underline",to:`/dashboard/album/${l.id}`,children:l.name})}),a.jsx("td",{children:a.jsx(X,{to:`/dashboard/singer/${l.singers[0].id}`,children:l.singers[0].name})}),a.jsx("td",{children:ns(l.like)})]},c)):a.jsx("tr",{children:a.jsx("td",{colSpan:4,children:a.jsx(Re,{})})})})]})]})}function sA(){const{setErrorToast:t}=te(),{setCategoryPage:e,shouldFetch:n,setHomePage:r,setCategories:s}=Bn(),[i,o]=h.useState(!0),l=h.useRef(!1),c=async()=>{try{if(o(!0),n.current)n.current=!1;else{await Jn(100);return}const u={category_ids:"",category_sections:[],playlist_sections:[],updated_at:mt()};let d={...u},m={...u},p=[];const g=st(ie,"Page_Config","category"),x=st(ie,"Page_Config","home"),[w,v]=await Promise.all([Wt({collectionName:"Page_Config",id:"category",msg:"Get category config"}),Wt({collectionName:"Page_Config",id:"home",msg:"Get home config"})]),S=await bt(le(St(ie,"Categories")));w.exists()?d=w.data():await Tx(g,d),v.exists()?m=v.data():await Tx(x,m),S.empty||(p=S.docs.map(_=>({..._.data(),id:_.id}))),s(p),e(d),r(m)}catch(u){console.log(u),t()}finally{o(!1)}};return h.useEffect(()=>{l.current||(l.current=!1,c())},[]),{isFetching:i}}function GX({closeModal:t,choose:e}){const{categories:n}=Bn();return a.jsx(a.Fragment,{children:a.jsxs(_e,{children:[a.jsx(Be,{title:"Category",closeModal:t}),a.jsx("div",{className:"h-[40vh] mt-3 space-y-1.5 overflow-auto",children:n.length?n.map((r,s)=>a.jsx(Ot,{onClick:()=>e(r),children:a.jsx("p",{className:"text-lg",children:r.name})},s)):a.jsx(Re,{})})]})})}function iA(t){const e=location.hash.includes("homepage")?"home":"category",{categoryPage:n,homePage:r,setCategoryPage:s,setHomePage:i,categorySliders:o,homeSliders:l}=Bn(),{setErrorToast:c,setSuccessToast:u}=te(),[d,m]=h.useState(!1),p=e==="home"?r:n,g=e==="home"?i:s,x=e==="home"?l:o,w=async S=>{if(!p)return;const _={...p};_.category_ids=S.map(E=>E.id).join("_"),await Se({collectionName:"Page_Config",data:_,id:e}),g(_)};return{isFetching:d,action:async S=>{var _;try{if(!p)return;switch(console.log(e),m(!0),S.variant){case"add-category":{const E=[...x,...S.categories];w(E),u("Add category successful");break}case"remove-category":{const E=x.filter(I=>I.id!==S.id);w(E),u("Remove category successful");break}case"arrange":{const E={...p};E.category_ids=S.order.join("_"),await Se({collectionName:"Page_Config",data:E,id:e}),g(E);break}}(_=t==null?void 0:t.modalRef.current)==null||_.close()}catch(E){console.log(E),c()}finally{m(!1)}}}}function WX({orderedCategories:t}){const[e,n]=h.useState(""),r=h.useRef(null),{action:s,isFetching:i}=iA({modalRef:r}),o=c=>{var u;n(c),(u=r.current)==null||u.open()},l=()=>{var c;return(c=r.current)==null?void 0:c.close()};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex space-x-2 justify-center mt-3",children:[a.jsxs(q,{onClick:()=>o("add"),children:[a.jsx(zt,{className:"w-6"}),a.jsx("span",{children:"Add"})]}),a.jsxs(q,{onClick:()=>o("arrange"),disabled:t.length<2,children:[a.jsx(Ae,{className:"w-6"}),a.jsx("span",{children:"Arrange"})]})]}),a.jsxs(ce,{variant:"animation",ref:r,children:[e==="add"&&a.jsx(GX,{choose:c=>s({variant:"add-category",categories:[c]}),closeModal:l}),e==="arrange"&&a.jsx(_w,{closeModal:l,isLoading:i,data:t.map(c=>({id:c.id,label:c.name})),submit:c=>s({variant:"arrange",order:c})})]})]})}function qX({category:t}){const[e,n]=h.useState(""),r=h.useRef(null),{action:s,isFetching:i}=iA({modalRef:r}),o=c=>{var u;n(c),(u=r.current)==null||u.open()},l=()=>{var c;return(c=r.current)==null?void 0:c.close()};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("div",{className:"aspect-[16/4]",children:a.jsx(Ce,{src:t.banner_image_url,blurHashEncode:t.banner_blurhash_encode,className:"rounded-md h-full object-cover"})}),a.jsxs(ks,{margin:!1,className:"w-fit mx-auto mt-2",children:[a.jsx(X,{to:`/dashboard/category/${t.id}`,className:"hover:underline",children:t.name}),a.jsx("div",{children:a.jsx("button",{onClick:()=>o("delete"),children:a.jsx(pt,{className:"w-5"})})})]})]}),a.jsx(ce,{variant:"animation",ref:r,children:e==="delete"&&a.jsx(qt,{callback:()=>s({variant:"remove-category",id:t.id}),closeModal:l,loading:i,label:`Remove category '${t.name}'`})})]})}function aA(){const{categorySliders:t,homeSliders:e}=Bn(),r=(location.hash.includes("homepage")?"home":"category")==="home"?e:t;return a.jsxs(a.Fragment,{children:[a.jsx(ee,{title:"Slider",variant:"h2",className:"mb-3"}),a.jsxs(Ot,{children:[a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:r.length?r.map((s,i)=>a.jsx(qX,{category:s},i)):""}),a.jsx("div",{className:"mt-3",children:a.jsx(WX,{orderedCategories:r})})]})]})}function n1(t){const{categoryPage:e,homePage:n,setHomePage:r,setCategoryPage:s,setCategories:i}=Bn(),{setErrorToast:o,setSuccessToast:l}=te(),[c,u]=h.useState(!1),d=location.hash.includes("homepage")?"home":"category",m=d==="home"?n:e,p=d==="home"?r:s;return{isFetching:c,action:async x=>{var w;try{if(!m)return;switch(u(!0),x.type){case"add-section":{const v={...m};switch(x.variant){case"category":v.category_sections.push(x.section);break;case"playlist":v.playlist_sections.push(x.section);break}await Se({collectionName:"Page_Config",data:v,id:d}),u(!1),p(v),l("Add section successful");break}case"edit-section":{const{index:v,section:S}=x,_={...m};switch(x.variant){case"category":Object.assign(_.category_sections[v],S);break;case"playlist":Object.assign(_.playlist_sections[v],S);break}await Se({collectionName:"Page_Config",data:_,id:d}),u(!1),p(_),l("Update section successful");break}case"delete":{const v=mi(ie),S={...m};switch(x.variant){case"category":const _=S.category_sections[x.index].target_ids;_&&_.split("_").forEach(E=>v.delete(st(ie,"Categories",E))),S.category_sections.splice(x.index,1);break;case"playlist":S.playlist_sections.splice(x.index,1);break}v.update(st(ie,"Page_Config",d),S),await v.commit(),l("Delete section successful");break}case"add-category":{const{category:v,sectionIndex:S}=x,_={...m},E={..._.category_sections[S]};E.target_ids=E.target_ids?E.target_ids+`_${v.id}`:v.id,Object.assign(_.category_sections[S],E),await Se({collectionName:"Page_Config",data:_,id:d}),i(I=>[...I,v]),p(_),l("Add new category successful")}}(w=t==null?void 0:t.modalRef.current)==null||w.close()}catch(v){console.log(v),o()}finally{u(!1)}}}}function oA(){const t=location.hash.includes("homepage")?"home":"category",[e,n]=h.useState(""),r=h.useRef(null),{action:s,isFetching:i}=n1({modalRef:r}),o=l=>{var c;n(l),(c=r.current)==null||c.open()};return a.jsxs(a.Fragment,{children:[a.jsxs(Fn,{children:[a.jsx(Mn,{children:a.jsxs(q,{size:"clear",className:"p-1.5",children:[a.jsx(zt,{className:"w-6"}),a.jsx("span",{children:"Add new section"})]})}),a.jsx(Dn,{className:"top-[calc(100%+8px)]",children:a.jsx(er,{className:"w-[140px]",children:a.jsxs(Or,{children:[t==="category"&&a.jsxs("button",{onClick:()=>o("category"),children:[a.jsx(xm,{}),a.jsx("span",{children:"Category"})]}),a.jsxs("button",{onClick:()=>o("playlist"),children:[a.jsx(Hj,{}),a.jsx("span",{children:"Playlist"})]})]})})})]}),a.jsx(ce,{variant:"animation",ref:r,children:e&&a.jsx(Yj,{loading:i,cbWhenSubmit:l=>s({type:"add-section",variant:e,section:YU(l)}),closeModal:()=>{var l;return(l=r.current)==null?void 0:l.close()},title:e==="category"?"Add category section":"Add playlist section"})})]})}function KX(){const[t,e]=h.useState([]);return{playlists:t,setPlaylists:e}}const lA=h.createContext(null);function QX({children:t}){return a.jsx(lA.Provider,{value:KX(),children:t})}const cA=()=>{const t=h.useContext(lA);if(!t)throw new Error("PlaylistSectionProvider is not provided");return t};function uA(t){const{categoryPage:e,setCategoryPage:n,homePage:r,setHomePage:s}=Bn(),{setErrorToast:i,setSuccessToast:o}=te(),{playlists:l,setPlaylists:c}=cA(),[u,d]=h.useState(!1),m=location.hash.includes("homepage")?"home":"category",p=m==="home"?r:e,g=m==="home"?s:n,x=async(v,S)=>{if(!p)return;const _={...p},E={target_ids:v.map(I=>I.id).join("_")};Object.assign(_.playlist_sections[S],E),await Se({collectionName:"Page_Config",data:_,id:m}),c(v),g(_)};return{isFetching:u,action:async v=>{var S;try{if(!p)return;switch(d(!0),v.variant){case"add-playlist":{const _=[...l,...v.playlists];x(_,v.sectionIndex),o("Add playlist successful");break}case"remove-playlist":{const _=l.filter(E=>E.id!==v.id);x(_,v.sectionIndex),o("Remove playlist successful");break}case"arrange-playlist":{const _={...p};Object.assign(_.playlist_sections[v.sectionIndex],v.section),await Se({collectionName:"Page_Config",data:_,id:m}),g(_);break}}(S=t==null?void 0:t.modalRef.current)==null||S.close()}catch(_){console.log(_),i()}finally{d(!1)}}}}function XX({playlist:t,sectionIndex:e}){const[n,r]=h.useState(""),s=h.useRef(null),{action:i,isFetching:o}=uA({modalRef:s}),l=u=>{var d;r(u),(d=s.current)==null||d.open()},c=()=>{var u;return(u=s.current)==null?void 0:u.close()};return a.jsxs(a.Fragment,{children:[a.jsxs(ks,{children:[a.jsx(X,{to:`/dashboard/playlist/${t.id}`,className:"hover:underline",children:t.name}),a.jsx("div",{children:a.jsx("button",{onClick:()=>l("delete"),children:a.jsx(pt,{className:"w-5"})})})]}),a.jsx(ce,{variant:"animation",ref:s,children:n==="delete"&&a.jsx(qt,{callback:()=>i({variant:"remove-playlist",id:t.id,sectionIndex:e}),closeModal:c,loading:o,label:`Remove playlist '${t.name}'`})})]})}const YX=()=>{const[t,e]=h.useState(!1),[n,r]=h.useState(!1),[s,i]=h.useState([]);return{isChecked:t,setIsChecked:e,isSelectAll:n,setIsSelectAll:r,setSelectedPlaylists:i,selectedPlaylists:s,selectAllPlaylist:u=>{e(!0),r(!0),i(u)},selectPlaylist:u=>{const d=[...s],m=d.findIndex(p=>p.id===u.id);m===-1?d.push(u):d.splice(m,1),e(!!d.length),i(d)},resetSelect:()=>{e(!1),r(!1),i([])}}},dA=h.createContext(null);function JX({children:t}){return a.jsx(dA.Provider,{value:YX(),children:t})}const ZX=()=>{const t=h.useContext(dA);if(!t)throw new Error("PlaylistSelectProvider not provided");return t},eY=["Newest","Result"];function tY(){const{setErrorToast:t}=te(),{playlists:e,setPlaylists:n,setHasMore:r,shouldGetPlaylists:s,PAGE_SIZE:i,lastDoc:o}=td(),[l,c]=h.useState([]),[u,d]=h.useState(""),[m,p]=h.useState(""),[g,x]=h.useState(!1),[w,v]=h.useState("Newest"),S=async()=>{try{x(!0),r(P=>o.current&&!P?(o.current=void 0,!P):P);const E=le(vn,Q("is_official","==",!0),Q("is_album","==",!1),Lt("updated_at","desc"),Mt(i)),I=await Ln(E);n(I)}catch(E){console.log(E)}finally{x(!1)}},_=async E=>{try{E.preventDefault(),x(!0);const I=lr(vn,[Q("is_official","==",!0)],u),P=await Ln(I);c(P),p(u)}catch(I){console.log({message:I}),t()}finally{x(!1)}};return h.useEffect(()=>{s.current&&(s.current=!1,S())},[]),{isFetching:g,value:u,playlists:e,result:l,setValue:d,lastSubmit:m,handleSubmit:_,getNewestPlaylists:S,tabs:eY,tab:w,setTab:v}}function nY({closeModal:t,submit:e,isLoading:n,current:r}){const{user:s}=xe(),{playlists:i,isFetching:o,getNewestPlaylists:l,result:c,lastSubmit:u,tabs:d,setTab:m,tab:p,...g}=tY(),{selectedPlaylists:x,selectPlaylist:w}=ZX(),v=h.useRef(null),{addPlaylist:S,isFetching:_}=Pw(),E=async()=>{x.length&&(e(x),t())},I=async(k,C)=>{var N;k.is_official=!0;const R=await S({variant:"add",playlist:k,imageFile:C},{push:!1});R&&e([R]),(N=v.current)==null||N.close(),t()},P=h.useMemo(()=>{const k=x.map(C=>C.id);return c.filter(C=>!k.includes(C.id))},[c,x]),F={col:"md:w-1/2 flex-1 flex flex-col px-2 overflow-hidden",box:"rounded-lg bg-black/5 p-2",boxItem:"w-full px-3 py-1.5 text-left hover:bg-[--a-5-cl] rounded-md text-sm"},j=k=>k.map((C,R)=>{const N=r.includes(C.id);return a.jsx("button",{onClick:()=>!N&&w(C),className:`${F.boxItem} ${N||x.includes(C)?"text-[--primary-cl]":""} `,children:C.name},R)});return a.jsxs(a.Fragment,{children:[a.jsxs(_e,{className:"w-[600px] h-[500px]",children:[a.jsx(Be,{closeModal:t,title:"Add playlists"}),a.jsx(fo,{className:"w-fit",...g}),a.jsxs("div",{className:"flex-grow flex flex-col md:flex-row -mx-2 overflow-hidden mt-3",children:[a.jsxs("div",{className:`${F.col}`,children:[a.jsx(tr,{className:"w-fit mb-1",buttonClasses:"[&_button]:px-3 [&_button]:py-1/2",tabs:d,setTab:m,tab:p,render:k=>k}),a.jsxs("div",{className:`${F.box} relative flex-grow overflow-auto`,children:[o?a.jsx(Vn,{className:"h-full"}):a.jsx(a.Fragment,{children:p==="Result"?j(P):a.jsxs(a.Fragment,{children:[j(i),a.jsx("p",{className:"mt-3 text-center",children:a.jsx(q,{onClick:l,size:"clear",className:"p-1",children:a.jsx(Ae,{className:"w-5"})})})]})}),!o&&u&&g.value==u&&!P.length&&a.jsx(ze,{children:a.jsx(q,{onClick:()=>{var k;return(k=v.current)==null?void 0:k.open()},children:"Add playlist"})})]})]}),a.jsxs("div",{className:`${F.col} mt-3 md:mt-0`,children:[a.jsx("p",{className:"font-bold mb-1 h-[36px]",children:"Selected"}),a.jsx("div",{className:`${F.box} flex-grow overflow-auto`,children:j(x)})]})]}),a.jsx("p",{className:"text-right mt-3 flex-shrink-0",children:a.jsxs(q,{disabled:!x.length,loading:n,onClick:E,children:[a.jsx(aa,{className:"w-6"}),a.jsx("span",{children:"Add"})]})}),n&&a.jsx(da,{})]}),a.jsx(ce,{variant:"animation",ref:v,children:a.jsx(_e,{className:"w-[650px]",children:a.jsx(Gl,{modalRef:v,isLoading:_,variant:"add",submit:I,user:s,name:g.value})})})]})}function hA(t){return a.jsx(JX,{children:a.jsx(nY,{...t})})}function rY({sectionIndex:t,orderedPlaylists:e}){const[n,r]=h.useState(""),s=h.useRef(null),{action:i,isFetching:o}=uA({modalRef:s}),l=c=>{var u;r(c),(u=s.current)==null||u.open()};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex space-x-2 justify-center mt-3",children:[a.jsxs(q,{onClick:()=>l("add"),children:[a.jsx(zt,{className:"w-6"}),a.jsx("span",{children:"Add playlist "})]}),a.jsxs(q,{onClick:()=>l("arrange"),disabled:e.length<2,children:[a.jsx(Ae,{className:"w-6"}),a.jsx("span",{children:"Arrange"})]})]}),a.jsxs(ce,{variant:"animation",ref:s,children:[n==="add"&&a.jsx(hA,{current:e.map(c=>c.id),closeModal:()=>{var c;return(c=s.current)==null?void 0:c.close()},isLoading:o,submit:c=>i({variant:"add-playlist",playlists:c,sectionIndex:t})}),n==="arrange"&&a.jsx(_w,{closeModal:()=>{var c;return(c=s.current)==null?void 0:c.close()},isLoading:o,data:e.map(c=>({id:c.id,label:c.name})),submit:c=>i({variant:"arrange-playlist",section:{target_ids:c.join("_")},sectionIndex:t})})]})]})}function fA({name:t,index:e,variant:n,section:r}){const[s,i]=h.useState(""),o=h.useRef(null),{action:l,isFetching:c}=n1({modalRef:o}),u=m=>{var p;i(m),(p=o.current)==null||p.open()},d=()=>{var m;return(m=o.current)==null?void 0:m.close()};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex space-x-2 ml-4",children:[a.jsx(q,{onClick:()=>u("edit"),className:"p-1",size:"clear",children:a.jsx(Dr,{className:"w-6"})}),a.jsx(q,{onClick:()=>u("delete"),className:"p-1",size:"clear",children:a.jsx(pt,{className:"w-6"})})]}),a.jsxs(ce,{variant:"animation",ref:o,children:[s==="edit"&&a.jsx(Yj,{initValue:t,loading:c,cbWhenSubmit:m=>l({type:"edit-section",section:{name:m},index:e,variant:n}),closeModal:d,title:n==="category"?"Edit category section":"Edit playlist section"}),s==="delete"&&a.jsx(qt,{callback:()=>l({type:"delete",index:e,variant:n}),closeModal:d,loading:c,label:`Delete section '${r.name}'`})]})]})}function sY({section:t,index:e}){const{categoryPage:n}=Bn(),{playlists:r,setPlaylists:s}=cA(),i=h.useMemo(()=>{const l=[];return(t.target_ids?t.target_ids.split("_"):[]).forEach(u=>{const d=r.find(m=>m.id===u);d&&l.push(d)}),l},[n,r]),{isFetching:o}=Fw({setPlaylists:s,playlistIds:t.target_ids?t.target_ids.split("_"):[]});return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx(ee,{variant:"h2",title:t.name}),a.jsx(fA,{section:t,index:e,name:t.name,variant:"playlist"})]}),a.jsxs(Ot,{children:[o&&a.jsx(Vn,{}),!o&&a.jsxs(a.Fragment,{children:[!!i.length&&a.jsx("div",{className:"flex flex-wrap -mt-2 -mx-2",children:i.map((l,c)=>a.jsx(XX,{playlist:l,sectionIndex:e},c))}),a.jsx(rY,{sectionIndex:e,orderedPlaylists:i})]})]})]})}function mA(t){return a.jsx(QX,{children:a.jsx(sY,{...t})})}function iY(){const{homePage:t}=Bn(),{isFetching:e}=sA();return e?a.jsx(ze,{children:a.jsx(Vn,{})}):a.jsx(a.Fragment,{children:a.jsxs("div",{className:"space-y-5",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx(ee,{title:"Home Page"}),a.jsx(oA,{})]}),a.jsx(aA,{}),t==null?void 0:t.playlist_sections.map((n,r)=>a.jsx(mA,{section:n,index:r},r))]})})}function aY(t){const[e,n]=h.useState(),[r,s]=h.useState(),i=h.useRef(null),o=m=>{e&&n({...e,...m})},l=h.useMemo(()=>t.variant==="add"?!0:!t.category||!e?!1:e.name!==t.category.name,[e]),c=!!r,u=h.useMemo(()=>{const m=!!(e!=null&&e.name)&&l;return t.variant==="add"?m:m||c},[c,l,e]),d=()=>{switch(t.variant){case"add":return gE({});case"edit":const{id:m,updated_at:p,...g}=t.category;return gE(g)}};return h.useEffect(()=>{var m;t.variant==="add"&&((m=i.current)==null||m.focus()),n(d())},[]),h.useEffect(()=>{r&&o({image_url:URL.createObjectURL(r)})},[r]),{categoryData:e,imageFile:r,setImageFile:s,updateData:o,setCategoryData:n,inputRef:i,isValidToSubmit:u,isChanged:l,isChangeImage:c}}function r1({closeModal:t,isLoading:e,submit:n,...r}){const{imageFile:s,setImageFile:i,categoryData:o,updateData:l,isChanged:c,isChangeImage:u,inputRef:d,isValidToSubmit:m}=aY(r),p=async()=>{o&&(!c&&!u||n(o,s))},g=x=>{var w;(w=x.target.files)!=null&&w.length&&i(x.target.files[0])};if(o)return a.jsx(a.Fragment,{children:a.jsxs(_e,{className:"w-[500px]",children:[a.jsx(Be,{closeModal:t,title:r.variant==="add"?"Add category":"Edit category"}),a.jsxs("div",{className:"md:flex md:space-x-3",children:[a.jsxs("div",{className:"space-y-2.5",children:[a.jsx("div",{className:"w-[200px] aspect-[5/3] rounded-lg overflow-hidden",children:a.jsx(Ce,{className:"object-cover object-center h-full",blurHashEncode:o.blurhash_encode,src:o.image_url})}),a.jsx("input",{ref:d,onChange:g,type:"file",multiple:!0,accept:"image/png, image/jpeg",id:"image_upload",className:"hidden"}),a.jsx(q,{size:"clear",children:a.jsx("label",{htmlFor:"image_upload",className:"px-5 py-1 cursor-pointer ",children:a.jsx(di,{className:"w-5"})})})]}),a.jsx("div",{className:"mt-3 md:mt-0 flex-grow flex flex-col space-y-2.5",children:a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Dt,{htmlFor:"name",children:"Name"}),a.jsx(_n,{id:"name",ref:d,type:"text",placeholder:"name...",value:o.name,onChange:x=>l({name:x.target.value})})]})})]}),a.jsx("p",{className:"text-right mt-5 md:mt-0",children:a.jsx(q,{loading:e,onClick:p,disabled:!m,children:"Save"})})]})})}function pA(t){const{setErrorToast:e}=te(),[n,r]=h.useState(!1),s=(t==null?void 0:t.setIsFetching)||r;return{addCategory:async({imageFile:o,...l})=>{try{if(s(!0),o){const c=await pi({imageFile:o,width:870,height:490});Object.assign(l.category,c),l.category.image_file_id&&Gt({fileId:l.category.image_file_id})}switch(l.variant){case"add":const c=await Ts({collectionName:"Categories",data:l.category});return{...l.category,id:c.id};case"edit":return await Se({collectionName:"Categories",data:l.category,id:l.id}),!0}}catch(c){console.log(c),e()}finally{r(!1)}},isFetching:n}}function oY({sectionIndex:t}){const{action:e,isFetching:n}=n1(),{isFetching:r,addCategory:s}=pA(),i=h.useRef(null),o=async(l,c)=>{var d;const u=await s({variant:"add",category:l,imageFile:c});u&&e({type:"add-category",category:u,sectionIndex:t}),(d=i.current)==null||d.close()};return a.jsxs(a.Fragment,{children:[a.jsxs(q,{onClick:()=>{var l;return(l=i.current)==null?void 0:l.open()},children:[a.jsx(zt,{className:"w-6"}),a.jsx("span",{children:"Add new category"})]}),a.jsx(ce,{variant:"animation",ref:i,children:a.jsx(r1,{closeModal:()=>{var l;return(l=i.current)==null?void 0:l.close()},isLoading:n||r,variant:"add",submit:o})})]})}function lY(t){const{categories:e,setCategories:n}=Bn(),{setErrorToast:r,setSuccessToast:s}=te(),[i,o]=h.useState(!1);return{isFetching:i,action:async c=>{var u;try{switch(o(!0),c.type){case"edit":{await Se({collectionName:"Categories",data:c.category,id:c.id});const d=[...e],m=d.findIndex(g=>g.id===c.id),p={...e[m]};Object.assign(p,c.category),d[m]=p,n(d),s("Edit category successful");break}case"delete":{await Km({collectionName:"Categories",id:c.id}),n(d=>d.filter(m=>m.id!==c.id)),s("Delete category successful");break}}(u=t==null?void 0:t.modalRef.current)==null||u.close()}catch(d){console.log(d),r()}finally{o(!1)}}}}function cY({category:t}){const[e,n]=h.useState(""),r=h.useRef(null),{action:s,isFetching:i}=lY({modalRef:r}),o=c=>{var u;n(c),(u=r.current)==null||u.open()},l=()=>{var c;return(c=r.current)==null?void 0:c.close()};return a.jsxs(a.Fragment,{children:[a.jsxs(ks,{children:[a.jsx(X,{to:`/dashboard/category/${t.id}`,className:"hover:underline",children:t.name}),a.jsxs("div",{children:[a.jsx("button",{className:"",onClick:()=>o("edit"),children:a.jsx(Dr,{className:"w-5"})}),a.jsx("button",{onClick:()=>o("delete"),children:a.jsx(pt,{className:"w-5"})})]})]}),a.jsxs(ce,{variant:"animation",ref:r,children:[e==="edit"&&a.jsx(r1,{variant:"edit",category:t,closeModal:l,isLoading:i,submit:c=>s({type:"edit",category:c,id:t.id})}),e==="delete"&&a.jsx(qt,{callback:()=>s({type:"delete",id:t.id}),closeModal:l,loading:i,label:`Delete category '${t.name}'`})]})]})}function uY({section:t,index:e}){const{categories:n}=Bn(),r=h.useMemo(()=>{const s=[];return(t.target_ids?t.target_ids.split("_"):[]).forEach(o=>{const l=n.find(c=>c.id===o);l&&s.push(l)}),s},[t,n]);return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx("h1",{children:t.name}),a.jsx(fA,{section:t,index:e,name:t.name,variant:"category"})]}),a.jsxs(Ot,{children:[a.jsx("div",{className:"flex flex-wrap -mt-2 -mx-2",children:r.map((s,i)=>a.jsx(cY,{category:s},i))}),a.jsx("p",{className:"text-center mt-5",children:a.jsx(oY,{sectionIndex:e})})]})]})}function dY(){const{categoryPage:t}=Bn(),{isFetching:e}=sA();return e?a.jsx(ze,{children:a.jsx(Vn,{})}):t?a.jsx(a.Fragment,{children:a.jsxs("div",{className:"space-y-5 [&_h1]:text-lg [&_h1]:font-bold [&_h1]:text-[#333] ",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(ee,{title:"Category"}),a.jsx(oA,{})]}),a.jsx(aA,{}),t.category_sections.map((n,r)=>a.jsx(uY,{section:n,index:r},r)),t.playlist_sections.map((n,r)=>a.jsx(mA,{section:n,index:r},r))]})}):a.jsx(a.Fragment,{})}function hY(){return a.jsx(a.Fragment,{children:a.jsx(dY,{})})}function fY(){const[t,e]=h.useState(),[n,r]=h.useState([]),[s,i]=h.useState([]),o=h.useMemo(()=>t!=null&&t.playlist_ids?t.playlist_ids.split("_"):[],[t]),l=h.useMemo(()=>{const c=[];return o.forEach(u=>{const d=n.find(m=>m.id===u);d&&c.push(d)}),c},[o,n]);return{category:t,setCategory:e,playlists:n,setPlaylists:r,songs:s,setSongs:i,orderedPlaylists:l,playlistIds:o}}const gA=h.createContext(null);function mY({children:t}){return a.jsx(gA.Provider,{value:fY(),children:t})}const xo=()=>{const t=h.useContext(gA);if(!t)throw new Error("CategoryProvider is not provided");return t};function pY({closeModal:t}){const{category:e,setCategory:n}=xo(),{setErrorToast:r,setSuccessToast:s}=te(),[i,o]=h.useState(),[l,c]=h.useState(!1),u=async()=>{try{if(!i||!e)throw new Error;c(!0);const{image_url:m,image_file_id:p,blurhash_encode:g}=await pi({imageFile:i,height:400,width:1600}),x={banner_image_url:m,banner_file_id:p,banner_blurhash_encode:g};await Se({collectionName:"Categories",id:e.id,data:x}),e.banner_file_id&&Gt({fileId:e.banner_file_id}),n(()=>({...e,...x})),s("Update banner successful"),t()}catch(m){console.log({error:m}),r()}finally{c(!1)}},d=h.useMemo(()=>i&&URL.createObjectURL(i)||(e==null?void 0:e.banner_image_url)||"",[i]);return{category:e,imageUrl:d,imageFile:i,setImageFile:o,isFetching:l,handleSubmit:u}}function gY({closeModal:t}){const{imageUrl:e,setImageFile:n,handleSubmit:r,isFetching:s}=pY({closeModal:t}),i=h.useRef(null),o=l=>{var c;(c=l.target.files)!=null&&c.length&&n(l.target.files[0])};return a.jsx(a.Fragment,{children:a.jsxs(_e,{className:"w-[500px]",children:[a.jsx("label",{ref:i,htmlFor:"image-input",className:"hidden"}),a.jsx("input",{onChange:o,id:"image-input",type:"file",accept:"image",className:"hidden"}),a.jsx(Be,{closeModal:t,title:"Category banner"}),a.jsxs("div",{className:"overflow-auto",children:[a.jsx("div",{className:"aspect-[16/4]",children:a.jsx(Ce,{className:"h-full object-cover rounded-lg",src:e})}),a.jsx("p",{className:"mt-3",children:a.jsx(q,{className:"p-1",size:"clear",onClick:()=>{var l;return(l=i.current)==null?void 0:l.click()},children:a.jsx(di,{className:"w-6"})})}),a.jsx("p",{className:"text-right mt-5",children:a.jsx(q,{loading:s,onClick:r,children:"Ok"})})]})]})})}function cd(t){const{songs:e,setSongs:n,playlists:r,setPlaylists:s,orderedPlaylists:i,category:o,setCategory:l}=xo(),{setErrorToast:c,setSuccessToast:u}=te(),[d,m]=h.useState(!1),p=Nt();return{isFetching:d,action:async x=>{var w;try{if(!o)return;switch(m(!0),x.variant){case"add-songs":{const v={...o},S=[...e,...x.songs],E={song_ids:S.map(I=>I.id).join("_"),updated_at:mt()};await Se({collectionName:"Categories",data:E,id:o.id}),Object.assign(v,E),l(v),n(S),u("Add song successful");break}case"add-playlists":{const v={...o},S=[...r,...x.playlists],E={playlist_ids:S.map(I=>I.id).join("_"),updated_at:mt()};await Se({collectionName:"Categories",data:E,id:o.id}),Object.assign(v,E),l(v),s(S),u("Add playlist successful");break}case"arrange-playlist":{const v={...o},S={...x.category,updated_at:mt()};await Se({collectionName:"Categories",data:S,id:o.id}),Object.assign(v,x.category),l(v),u("Category updated");break}case"remove-song":{const v={...o},S=[...e];S.splice(x.index,1);const E={song_ids:S.map(I=>I.id).join("_"),updated_at:mt()};await Se({collectionName:"Categories",data:E,id:o.id}),Object.assign(v,E),l(v),n(S),u("Category updated");break}case"remove-playlist":{const v={...o},S=[...i];S.splice(x.index,1);const E={playlist_ids:S.map(I=>I.id).join("_"),updated_at:mt()};await Se({collectionName:"Categories",data:E,id:o.id}),Object.assign(v,E),l(v),s(S),u("Category updated");break}case"delete":{if(!o)return;o.banner_file_id&&Gt({fileId:o.banner_file_id}),o.image_file_id&&Gt({fileId:o.image_file_id}),await Km({collectionName:"Categories",id:o.id}),u("Category deleted"),p("/dashboard/category");break}}(w=t==null?void 0:t.modalRef.current)==null||w.close()}catch(v){console.log(v),c()}finally{m(!1)}}}}function xY(){const{categories:t,setCategories:e}=Bn(),{setSuccessToast:n}=te(),{category:r,setCategory:s}=xo(),[i,o]=h.useState(""),{addCategory:l,isFetching:c}=pA(),{action:u,isFetching:d}=cd(),m=v=>{var S;o(v),(S=g.current)==null||S.open()},p=()=>{var v;return(v=g.current)==null?void 0:v.close()},g=h.useRef(null),x=async(v,S)=>{if(!r)return;if(await l({variant:"edit",category:v,id:r.id,imageFile:S})){const E=[...t],I={...r};Object.assign(I,v);const P=E.findIndex(F=>F.id===r.id);P!==-1&&(Object.assign(E[P],v),e(E)),s(I),n("Category updated"),p()}},w=()=>{switch(i){case"":return a.jsx(a.Fragment,{});case"banner":return a.jsx(gY,{closeModal:p});case"edit":return r?a.jsx(a.Fragment,{children:a.jsx(r1,{submit:x,variant:"edit",isLoading:c,category:r,closeModal:p})}):"Playlist is undefined";case"delete":return a.jsx(qt,{loading:d,label:"Delete playlist ?",callback:()=>u({variant:"delete"}),closeModal:p})}};return a.jsxs(a.Fragment,{children:[a.jsxs(Bl,{children:[a.jsxs(q,{onClick:()=>m("edit"),size:"clear",children:[a.jsx(Dr,{}),a.jsx("span",{children:"Edit"})]}),a.jsxs(q,{onClick:()=>m("banner"),size:"clear",children:[a.jsx(di,{}),a.jsx("span",{children:"Banner"})]}),a.jsxs(q,{onClick:()=>m("delete"),size:"clear",children:[a.jsx(pt,{}),a.jsx("span",{children:"Delete"})]})]}),a.jsx(ce,{variant:"animation",ref:g,children:w()})]})}function yY(){const{orderedPlaylists:t}=xo(),[e,n]=h.useState(""),r=h.useRef(null),{action:s,isFetching:i}=cd({modalRef:r}),o=l=>{var c;n(l),(c=r.current)==null||c.open()};return a.jsxs(a.Fragment,{children:[a.jsxs(Fn,{children:[a.jsx(Mn,{children:a.jsxs(q,{size:"clear",className:"p-1",children:[a.jsx(ao,{className:"w-6"}),a.jsx("span",{className:"hidden md:block",children:"Menu"})]})}),a.jsx(Dn,{className:"top-[calc(100%+8px)] right-0",children:a.jsx(er,{className:"w-[160px]",children:a.jsxs(Or,{children:[a.jsxs("button",{onClick:()=>o("add"),children:[a.jsx(zt,{}),a.jsx("span",{children:"Add playlist"})]}),a.jsxs("button",{disabled:t.length<2,onClick:()=>o("arrange"),children:[a.jsx(Ae,{}),a.jsx("span",{children:"Arrange"})]})]})})})]}),a.jsxs(ce,{variant:"animation",ref:r,children:[e==="add"&&a.jsx(hA,{current:t.map(l=>l.id),closeModal:()=>{var l;return(l=r.current)==null?void 0:l.close()},isLoading:i,submit:l=>s({variant:"add-playlists",playlists:l})}),e==="arrange"&&a.jsx(_w,{closeModal:()=>{var l;return(l=r.current)==null?void 0:l.close()},isLoading:i,data:t.map(l=>({id:l.id,label:l.name})),submit:l=>s({variant:"arrange-playlist",category:{playlist_ids:l.join("_")}})})]})]})}function vY(){const{setPlaylists:t,orderedPlaylists:e,playlistIds:n}=xo(),{isFetching:r}=Fw({setPlaylists:t,playlistIds:n}),s=h.useRef(null),{action:i,isFetching:o}=cd();return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h1",{className:"text-lg font-bold text-[#333]",children:"Playlists"}),a.jsx(yY,{})]}),r&&a.jsx(Vn,{}),!r&&a.jsx(is,{colList:["Name","Like",""],children:e.length?e.map((l,c)=>a.jsxs("tr",{children:[a.jsx("td",{children:a.jsx(X,{className:"hover:underline",to:`/dashboard/playlist/${l.id}`,children:l.name})}),a.jsx("td",{children:ns(l.like)}),a.jsxs("td",{className:"text-right",children:[a.jsx(q,{onClick:()=>{var u;return(u=s.current)==null?void 0:u.open()},size:"clear",className:"p-1",children:a.jsx(pt,{className:"w-5"})}),a.jsx(ce,{variant:"animation",ref:s,children:a.jsx(qt,{callback:()=>i({variant:"remove-playlist",playlist:l,index:c}),closeModal:()=>{var u;return(u=s.current)==null?void 0:u.close()},loading:o,label:`Remove playlist '${l.name}'`})})]})]},c)):a.jsx("tr",{children:a.jsx("td",{colSpan:4,children:a.jsx(Re,{})})})})]})}function wY({songs:t}){const[e,n]=h.useState(""),r=h.useRef(null),{action:s,isFetching:i}=cd({modalRef:r}),o=l=>{var c;n(l),(c=r.current)==null||c.open()};return a.jsxs(a.Fragment,{children:[a.jsxs(Fn,{children:[a.jsx(Mn,{children:a.jsxs(q,{size:"clear",className:"p-1",children:[a.jsx(ao,{className:"w-6"}),a.jsx("span",{className:"hidden md:block",children:"Menu"})]})}),a.jsx(Dn,{className:"top-[calc(100%+8px)] right-0",children:a.jsx(er,{className:"w-[140px]",children:a.jsx(Or,{children:a.jsxs("button",{onClick:()=>o("add"),children:[a.jsx(zt,{}),a.jsx("span",{children:"Add songs"})]})})})})]}),a.jsx(ce,{variant:"animation",ref:r,children:e==="add"&&a.jsx(Zw,{closeModal:()=>{var l;return(l=r.current)==null?void 0:l.close()},isLoading:i,submit:l=>s({variant:"add-songs",songs:l}),current:t.map(l=>l.id)})})]})}function _Y(){const{setSongs:t,category:e,songs:n}=xo(),r=h.useRef(null),{action:s,isFetching:i}=cd(),o=h.useMemo(()=>e!=null&&e.song_ids?e.song_ids.split("_"):[],[e]),{isFetching:l}=WR({setSongs:t,songIds:o});return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h1",{className:"text-lg font-bold text-[#333]",children:"Songs"}),a.jsx(wY,{songs:n})]}),l&&a.jsx(Vn,{}),!l&&a.jsx(is,{colList:["Name","Singers",""],children:n.length?n.map((c,u)=>a.jsxs("tr",{children:[a.jsx("td",{children:a.jsx(X,{to:`/dashboard/song/${c.id}/edit`,className:"hover:underline",children:c.name})}),a.jsx("td",{children:c.singers.map((d,m)=>a.jsxs(X,{className:"hover:underline",to:`/dashboard/singer/${d.id}`,children:[!!m&&", ",d.name]},m))}),a.jsxs("td",{className:"text-right",children:[a.jsx(q,{onClick:()=>{var d;return(d=r.current)==null?void 0:d.open()},size:"clear",className:"p-1",children:a.jsx(pt,{className:"w-5"})}),a.jsx(ce,{variant:"animation",ref:r,children:a.jsx(qt,{callback:()=>s({variant:"remove-song",song:c,index:u}),closeModal:()=>{var d;return(d=r.current)==null?void 0:d.close()},loading:i,label:`Remove song '${c.name}'`})})]})]},u)):a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"text-center",children:a.jsx(Re,{})})})})]})}function SY(){const{category:t,setCategory:e}=xo(),{isFetching:n}=GR({setCategory:e}),r=h.useMemo(()=>t==null?void 0:t.updated_at,[t==null?void 0:t.id]);return n?a.jsx(ua,{}):t?a.jsxs(a.Fragment,{children:[a.jsx(ee,{title:"Category Detail"}),a.jsx("div",{className:"aspect-[16/4] mt-5",children:a.jsx(Ce,{className:"h-full object-cover rounded-lg",src:t.banner_image_url})}),a.jsxs("div",{className:"md:flex md:-mx-3 mt-5",children:[a.jsxs("div",{className:"space-y-2.5 md:px-3",children:[a.jsx("div",{className:"w-[260px] aspect-[5/3]",children:a.jsx(Ce,{className:"object-cover h-full rounded-lg",blurHashEncode:t.blurhash_encode,src:t.image_url})}),a.jsx("div",{className:"text-2xl font-bold text-[#333]",children:t.name}),a.jsx(xY,{}),a.jsxs("p",{className:"text-sm",children:["Last updated: ",El(r)]})]}),a.jsxs("div",{className:"w-full mt-3 md:mt-0 md:px-3 space-y-3",children:[a.jsx(_Y,{}),a.jsx(vY,{})]})]})]}):a.jsx(Re,{})}function bY(){return a.jsx(mY,{children:a.jsx(SY,{})})}function l2({children:t}){return a.jsx(PW,{children:t})}function EY(){const[t,e]=h.useState(),[n,r]=h.useState([]),[s,i]=h.useState();return{imageFile:s,setImageFile:i,album:t,setAlbum:e,updateAlbumData:l=>{t&&e({...t,...l})},songs:n,setSongs:r}}const xA=h.createContext(null);function kY({children:t}){return a.jsx(xA.Provider,{value:EY(),children:t})}const ud=()=>{const t=h.useContext(xA);if(!t)throw new Error("AlbumProvider not provided");return t};function jY(){const{setAlbum:t,setSongs:e}=ud(),[n,r]=h.useState(!0),s=h.useRef(!1),i=ci(),o=Nt(),{setErrorToast:l}=te(),c=async()=>{try{if(!i.id)return;const u=await Wt({collectionName:"Playlists",id:i.id});if(!u.exists())return o("/dashboard/album");const d={...u.data(),id:u.id};if(!d.is_album)return o(`/dashboard/playlist/${d.id}`);if(d.song_ids.length){const m=le(_t,Q(Lr(),"in",d.song_ids)),p=await $t(m);e(p)}t(d)}catch(u){console.log(u),l()}finally{r(!1)}};return h.useEffect(()=>{s.current||(s.current=!0,c())},[]),{isFetching:n}}function yA(){const{resetSelect:t}=ho(),{setErrorToast:e,setSuccessToast:n}=te(),{album:r,songs:s,setSongs:i,updateAlbumData:o}=ud(),[l,c]=h.useState(!1),u=Nt();return{isFetching:l,action:async m=>{try{if(!r)throw new Error("album not found");switch(c(!0),m.variant){case"delete":{const p=mi(ie),g=st(ie,"Playlists",r.id),x=await bt(le(Xa,Q("target_id","==",r.id)));p.delete(g),x.empty||(console.log(`Delete ${x.docs.length} comments`),x.forEach(w=>p.delete(w.ref))),await Promise.all([p.commit(),r.image_file_id?Gt({fileId:r.image_file_id}):()=>{}]),n("Delete album sucessful"),u("/dashboard/album");break}case"add-songs":{const p=[...s,...m.songs],x={song_ids:p.map(w=>w.id)};await Se({collectionName:"Playlists",id:r.id,data:x,msg:">>> api: update album doc"}),o(x),i(p),n("Songs added");break}case"remove-songs":{const p=m.songs.map(w=>w.id),g=s.filter(w=>!p.includes(w.id)),x={song_ids:g.map(w=>w.id)};await Se({collectionName:"Playlists",id:r.id,data:x,msg:">>> api: update album doc"}),i(g),n(`${m.songs.length} ${m.songs.length>1?"songs":"song"}  removed`),t();break}}}catch(p){console.log({message:p}),e("")}finally{c(!1)}}}}function TY(){const{album:t,songs:e,updateAlbumData:n}=ud(),[r,s]=h.useState(""),i=h.useRef(null),{isFetching:o,action:l}=yA(),c=p=>{var g;s(p),(g=i.current)==null||g.open()},u=()=>{var p;(p=i.current)==null||p.close()},d=async p=>{await l(p),u()},m=()=>{switch(r){case"":return a.jsx(a.Fragment,{});case"edit":return t?a.jsx(a.Fragment,{children:a.jsx(_e,{className:"w-[600px]",children:a.jsx(t1,{modalRef:i,variant:"edit",afterSubmit:p=>{n(p)},album:t})})}):"Playlist is undefined";case"delete":return a.jsx(qt,{loading:o,label:"Delete playlist ?",callback:()=>d({variant:"delete"}),closeModal:u});case"add-songs":return a.jsx(Zw,{isLoading:o,submit:p=>d({variant:"add-songs",songs:p}),closeModal:u,current:e.map(p=>p.id)})}};return a.jsxs(a.Fragment,{children:[a.jsx("div",{children:a.jsxs(Bl,{children:[a.jsxs(q,{onClick:()=>c("edit"),size:"clear",children:[a.jsx(Dr,{}),a.jsx("span",{children:"Edit"})]}),a.jsxs(q,{onClick:()=>c("delete"),size:"clear",children:[a.jsx(pt,{}),a.jsx("span",{children:"Delete"})]}),a.jsxs(q,{onClick:()=>c("add-songs"),size:"clear",children:[a.jsx(zt,{}),a.jsx("span",{children:"Add song"})]})]})}),a.jsx(ce,{ref:i,variant:"animation",children:m()})]})}function IY(){const{songs:t}=ud(),{selectedSongs:e,selectSong:n}=ho(),{action:r,isFetching:s}=yA(),i=h.useRef(null),o=async()=>{var l;await r({variant:"remove-songs",songs:e}),(l=i.current)==null||l.close()};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between items-center mb-3",children:[a.jsx(ee,{title:"Songs",variant:"h2"}),!!e.length&&a.jsx(q,{onClick:()=>{var l;return(l=i.current)==null?void 0:l.open()},className:"p-1",size:"clear",children:a.jsx(pt,{className:"w-5"})})]}),a.jsx(is,{colList:["Name","Singer","Genre",""],children:t.length?t.map((l,c)=>{var d;const u=e.find(m=>m.id===l.id);return a.jsxs("tr",{className:u?"bg-[--a-5-cl]":"",children:[a.jsx("td",{children:a.jsx(X,{to:`/dashboard/song/${l.id}/edit`,className:"hover:underline",children:l.name})}),a.jsx("td",{children:l.singers.map((m,p)=>a.jsxs(X,{className:"hover:underline",to:`/dashboard/singer/${m.id}`,children:[!!p&&", ",m.name]},p))}),a.jsx("td",{children:(d=l.main_genre)==null?void 0:d.name}),a.jsx("td",{children:a.jsx("button",{onClick:()=>n(l),children:u?a.jsx(Ku,{className:"w-5"}):a.jsx(mv,{className:"w-5"})})})]},c)}):a.jsx("tr",{children:a.jsx("td",{colSpan:4,children:a.jsx(Re,{variant:"less"})})})})]}),a.jsx(ce,{variant:"animation",ref:i,children:a.jsx(qt,{callback:o,closeModal:()=>{var l;return(l=i.current)==null?void 0:l.close()},loading:s,label:"Remove selected songs ?"})})]})}function CY(){const{album:t,songs:e}=ud(),{isFetching:n}=jY(),r=h.useMemo(()=>t==null?void 0:t.updated_at,[t==null?void 0:t.id]);return n?a.jsx(ze,{children:a.jsx(Ae,{className:"w-6 animate-spin"})}):t?a.jsxs(a.Fragment,{children:[a.jsx(ee,{title:"Edit album",className:"mb-3"}),a.jsxs("div",{className:"md:flex md:-mx-3",children:[a.jsxs("div",{className:"space-y-5 md:px-3",children:[a.jsx("div",{className:"w-[200px] h-[200px] mx-auto rounded-md overflow-hidden",children:a.jsx(Ce,{className:"object-cover h-full rounded-lg",blurHashEncode:t.blurhash_encode,src:t.image_url})}),a.jsxs(Eu,{className:"space-y-2",children:[a.jsxs("p",{children:[a.jsx("span",{children:"Public:"}),t.is_public?"Public":"Private"]}),a.jsxs("p",{children:[a.jsx("span",{children:"Song:"}),e.length]}),a.jsxs("p",{children:[a.jsx("span",{children:"Comments:"}),ns(t.comment)]}),a.jsx(Ym,{init:t.like,loading:!1,submit:()=>{}}),a.jsxs("p",{children:[a.jsx("span",{children:"Last update:"}),r?El(r):""]})]}),a.jsx(TY,{})]}),a.jsxs("div",{className:"w-full mt-3 md:mt-0 md:w-3/4 md:px-3 space-y-5",children:[a.jsxs("div",{children:[a.jsx(ee,{title:"Info",variant:"h2",className:"mb-3"}),a.jsxs(Eu,{children:[a.jsxs("div",{children:[a.jsx("span",{children:"Name:"}),a.jsx(ee,{variant:"h1",title:t.name})]}),a.jsxs("div",{children:[a.jsx("span",{children:"Singer:"}),a.jsx(ee,{variant:"h2",title:t.singers[0].name})]})]})]}),a.jsx(IY,{})]})]})]}):a.jsx(a.Fragment,{})}function RY(){return a.jsx(kY,{children:a.jsx(En,{children:a.jsx(CY,{})})})}function NY(){const[t,e]=h.useState([]),[n,r]=h.useState(999),s=h.useRef(!0);return{currentSong:h.useMemo(()=>t[n],[t,n]),songs:t,setSongs:e,currentIndex:n,setCurrentIndex:r,firstTimeSongLoaded:s}}const vA=h.createContext(null);function AY({children:t}){return a.jsx(vA.Provider,{value:NY(),children:t})}function fa(){const t=h.useContext(vA);if(!t)throw new Error("SongsContextProvider not provided");return t}function PY(){const{currentSong:t}=fa(),{setComments:e,isOpenComment:n,setIsFetching:r,shouldFetchComment:s}=On(),{fetchComment:i}=sp({setIsFetchingFromParent:r}),o=async()=>{const l=await i({target_id:t.id});l&&e(l)};h.useEffect(()=>{!n||!t||s.current&&(s.current=!1,o())},[t,n]),h.useEffect(()=>()=>{s.current=!0,e([])},[t])}function FY(){const{user:t}=xe(),{currentSong:e}=fa(),{isOpenComment:n,setIsOpenComment:r}=On();PY();const{comments:s,isFetching:i}=On(),o=n?"semi-lg:right-0 block":"semi-lg:right-[-100%] hidden semi-lg:block",l={border:"border-black/20 dark:border-white/20"};return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:`${n?"fixed":""} semi-lg:hidden bg-black/60 inset-0 z-[90]`}),a.jsx("div",{className:`transition-[right] max-h-[80vh] sm:max-h-[unset] max-w-[90vw] duration-[.3s] z-[99] semi-lg:z-[0] absolute rounded-xl  left-1/2 top-1/2 translate-y-[-50%] translate-x-[-50%] semi-lg:left-[unset] semi-lg:top-0 semi-lg:transform-none semi-lg:h-full semi-lg:min-h-[360px] w-[400px] xl:w-[480px] semi-lg:p-4 top-0 ${o}`,children:a.jsxs("div",{className:`semi-lg:border text-white h-[400px] bg-[#333] p-5 semi-lg:p-3 semi-lg:h-full w-full rounded-xl flex flex-col ${l.border}`,children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(ee,{variant:"h2",title:"Comments"}),a.jsx(se,{onClick:()=>r(!1),className:"p-1.5 hover:bg-black/20",size:"clear",children:a.jsx(Xu,{className:"w-8"})})]}),a.jsx($w,{variant:"dark-bg",isFetching:i,comments:s,className:"pr-2"}),t&&e&&a.jsx(up,{bg:"bg-white/10",variant:"comment",targetId:e.id})]})})]})}function MY(){const[t,e]=h.useState("idle"),[n,r]=h.useState(!1),[s,i]=h.useState([]),o=h.useRef(null),l=h.useRef("idle"),c=h.useRef(!0),u=h.useRef(!0);return{status:t,setStatus:e,statusRef:l,controlRef:o,canPlay:n,setCanPlay:r,lyrics:s,setLyrics:i,shouldGetLyric:c,shouldPlayAfterLoaded:u}}const wA=h.createContext(null);function DY({children:t}){return a.jsx(wA.Provider,{value:MY(),children:t})}function Wl(){const t=h.useContext(wA);if(!t)throw new Error("PlayerProvider not provided");return t}function LY({audioEle:t}){const{setStatus:e,shouldPlayAfterLoaded:n,canPlay:r}=Wl(),{firstTimeSongLoaded:s,currentSong:i}=fa(),o=()=>{e("loading")},l=()=>{if(s.current){s.current=!1,e("paused");return}n.current&&(n.current=!1,t==null||t.play())},c=()=>{e("error")};h.useEffect(()=>{r&&i&&(t.src=i.song_url)},[r]),h.useEffect(()=>(t.addEventListener("error",c),t.addEventListener("loadstart",o),t.addEventListener("loadedmetadata",l),()=>{t.removeEventListener("error",c),t.removeEventListener("loadstart",o),t.removeEventListener("loadedmetadata",l)}),[])}function OY({isLiked:t,song:e}){const{action:n,loading:r}=ap();return a.jsx("button",{className:" ",onClick:()=>n({variant:"like",song:e}),children:r?a.jsx(Ae,{className:" animate-spin"}):a.jsx(zl,{className:t?"text-[--primary-cl]":""})})}function $Y({song:t}){const{setIsOpenComment:e}=On(),{user:n}=xe();return a.jsxs("div",{className:`flex 
			space-x-2
			[&_button]:rounded-full
			[&_button]:p-2
			[&_svg]:w-6
			hover:[&_button]:bg-white/10
			[&_div]:flex-col
			[&_div]:flex
			[&_span]:text-center
			[&_span]:font-medium
		 `,children:[n&&a.jsx("div",{children:a.jsx(OY,{isLiked:n.liked_song_ids.includes(t.id),song:t})}),a.jsx("div",{children:a.jsx("button",{onClick:()=>e(!0),children:a.jsx(G$,{})})})]})}function zY({audioEle:t,song:e}){const{status:n,controlRef:r,setStatus:s,statusRef:i}=Wl();LY({audioEle:t});const{pause:o,play:l,handlePlayPause:c,progressLineRef:u}=rp({audioEle:t,setStatusFromParent:s,statusFromParent:n,statusRefFromParent:i,baseColor:"rgba(255,255,255,0.1)",color:"#fff"});h.useImperativeHandle(r,()=>({pause:o,play:l,handlePlayPause:c}));const d=()=>{switch(n){case"playing":return a.jsx(Qu,{});case"paused":return a.jsx(qa,{});case"error":return a.jsx(kC,{});case"loading":return a.jsx(Ae,{className:"animate-spin"});default:return a.jsx(oa,{})}};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex",children:[a.jsx("button",{onClick:c,className:"[&_svg]:w-7",children:d()}),a.jsx("div",{className:"flex space-x-2 ml-auto",children:a.jsx($Y,{song:e})})]}),a.jsx("div",{className:"h-2 flex items-center mt-3",children:a.jsx(rd,{bg:"rgba(255,255,255,0.1)",elelRef:u,className:`h-1 ${n==="idle"?"hidden":""}`})})]})}const oh=.3;function BY({audioEle:t,lyrics:e,isActive:n}){const[r,s]=h.useState(0),i=h.useRef(0),o=h.useRef(0),l=()=>{const c=t.currentTime>i.current?"forward":"backward";i.current=t.currentTime;let u=o.current;switch(c){case"forward":for(;e[u+1]&&e[u+1].start-oh<i.current+oh;)u+=1;break;case"backward":for(;e[u-1]&&e[u-1].end-oh>i.current+oh;)u-=1;break}u!==o.current&&(o.current=u,s(u))};return h.useEffect(()=>{if(!(!n||!e.length))return t.addEventListener("timeupdate",l),()=>{t.removeEventListener("timeupdate",l)}},[e,n]),{currentIndex:r}}function VY(){const{canPlay:t,setLyrics:e,shouldGetLyric:n}=Wl(),{currentSong:r}=fa(),s=h.useRef(),{loading:i,getLyric:o}=UR({}),l=async()=>{if(r&&r.lyric_id){const c=await o(r);c&&e(JSON.parse(c==null?void 0:c.lyrics))}};return h.useEffect(()=>{t&&n.current&&(n.current=!1,s.current=setTimeout(l,500))},[t]),{isFetching:i}}function UY({audioEle:t}){const{lyrics:e,canPlay:n}=Wl(),{isFetching:r}=VY(),s=h.useRef(null),i=h.useRef(null),{currentIndex:o}=BY({audioEle:t,lyrics:e,isActive:n}),l=()=>a.jsxs(a.Fragment,{children:[a.jsx("p",{className:"transition-transform origin-bottom-left duration-[.4s] translate-y-[50px]",ref:s,children:e[o].text},o),e[o+1]&&a.jsx("p",{ref:i,className:"mt-3 transition-transform duration-[.4s] opacity-[.4] translate-y-[-10px]",children:e[o+1].text},o+"asda")]}),c={container:"no-scrollbar [&_p]:w-[70%] [&_p]:select-none [&_p]:font-bold pt-4"};return h.useEffect(()=>{setTimeout(()=>{s.current&&Object.assign(s.current.style,{transform:"scale(1.3) translateY(0px)"}),i.current&&Object.assign(i.current.style,{transform:"translateY(0px)"})},10)},[o,e]),a.jsxs("div",{className:`${c.container}`,children:[r&&a.jsx("div",{className:"relative w-full h-full",children:a.jsx(Ae,{className:"w-7 animate-spin"})}),!r&&a.jsx(a.Fragment,{children:e.length?l():a.jsx("div",{children:"..."})})]})}function HY({index:t,songItemRef:e}){const{currentIndex:n,setCurrentIndex:r}=fa(),{setCanPlay:s,canPlay:i,controlRef:o,statusRef:l}=Wl(),[c,u]=h.useState(!1),d=h.useRef(),m=h.useMemo(()=>n===t,[n]),p=g=>{const[x]=g;u(x.isIntersecting)};h.useEffect(()=>{var g,x;m?i?(g=o.current)==null||g.play():s(!0):i&&l.current==="playing"&&((x=o.current)==null||x.pause())},[m]),h.useEffect(()=>{e.current&&new IntersectionObserver(p,{threshold:1}).observe(e.current)},[]),h.useEffect(()=>(d.current=setTimeout(()=>{c&&r(t)},600),()=>{clearTimeout(d.current)}),[c])}function GY({song:t,index:e,songItemRef:n}){const{controlRef:r}=Wl(),s=h.useRef(null);return HY({index:e,songItemRef:n}),a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"relative z-0 flex items-center flex-shrink-0 text-white h-full w-full sm:w-auto sm:aspect-[3/5] rounded-xl overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0 z-[-1] overflow-hidden ",children:t.blurhash_encode&&a.jsx(nd,{hash:t.blurhash_encode,height:"100%",width:"100%"})}),a.jsx("div",{className:"absolute top-0 p-4 left-0 w-full z-[99]",children:s.current&&a.jsx(UY,{audioEle:s.current})}),a.jsx("div",{className:"w-full aspect-[1/1] overflow relative mask-image",children:a.jsx("img",{onClick:()=>{var i;return(i=r.current)==null?void 0:i.handlePlayPause()},className:"w-full object-cover",src:t.image_url})}),a.jsx("div",{className:"absolute z-0 bottom-0 left-0 w-full",children:a.jsxs("div",{className:"relative p-4",children:[a.jsx("div",{className:"absolute inset-0 z-[-1] bg-gradient-to-b to-black/60 from-transparent"}),a.jsx("div",{className:"text-xl font-semibold",children:t.name}),a.jsx("div",{className:"opacity-[.8]",children:t.singers.map((i,o)=>a.jsxs("span",{children:[" ",(o?", ":"")+i.name]},o))}),a.jsx("div",{className:"mt-2",children:s.current&&a.jsx(zY,{song:t,audioEle:s.current})})]})})]}),a.jsx("audio",{className:"hidden",ref:s})]})}function WY(t,e){const{isOpenComment:n}=On(),r=h.useRef(null);return h.useImperativeHandle(e,()=>r.current),a.jsx(a.Fragment,{children:a.jsx("div",{className:"h-full flex-shrink-0 p-4 min-h-[360px] snap-center",children:a.jsx("div",{"data-index":t.index,className:`relative h-full w-full transition-[right] duration-[.3s]  ${n?"semi-lg:right-[calc(400px*0.5)] ":"right-0"}`,ref:r,children:a.jsx(DY,{children:a.jsx(GY,{...t,songItemRef:r})})})})})}const c2=h.forwardRef(WY);function qY(){const{setSongs:t}=fa(),{setErrorToast:e}=te(),[n,r]=h.useState(!0),s=h.useRef(!1),i=h.useRef(),o=h.useRef(null),l=h.useCallback(u=>{o.current&&o.current.disconnect(),o.current=new IntersectionObserver(d=>{d[0].isIntersecting&&c()},{threshold:1}),u&&o.current.observe(u)},[]),c=async()=>{try{r(!0);const u=i.current?le(_t,Q("is_official","==",!0),Lt("updated_at","desc"),Hm(i.current),Mt(3)):le(_t,Q("is_official","==",!0),Lt("updated_at","desc"),Mt(3)),d=await bt(u);if(d.docs){i.current=d.docs[d.docs.length-1];const m=d.docs.map(p=>({...p.data(),id:p.id,queue_id:po(4)}));t(p=>[...p,...m])}}catch(u){console.log({message:u}),e()}finally{r(!1)}};return h.useEffect(()=>{s.current||(s.current=!0,c())},[]),{isFetching:n,getSong:c,lastElementRef:l}}function _A(){const{user:t,updateUserData:e}=xe();return{pushRecentSong:async r=>{if(r.is_official)if(t){const s=[...t.recent_song_ids];if(!s.includes(r.id)){console.log("push recent songs"),s.unshift(r.id);const o={recent_song_ids:s.slice(0,10)};e(o),Se({collectionName:"Users",data:o,id:t.email})}}else{const s=It()["recent-songs"]||[];s.find(o=>o.id===r.id)||s.unshift(r),rt("recent-songs",s)}}}}function KY(){const{currentSong:t}=fa(),{pushRecentSong:e}=_A(),n=h.useRef();h.useEffect(()=>{if(t)return n.current=setTimeout(()=>{oR(t.id),e(t)},5e3),()=>{clearTimeout(n.current)}},[t])}function QY(){const{setCurrentIndex:t,songs:e}=fa(),{isFetching:n,lastElementRef:r}=qY();KY();const s=h.useMemo(()=>e.map((i,o)=>e.length===o+1?a.jsx(c2,{index:o,ref:r,song:i},o):a.jsx(c2,{index:o,song:i},o)),[e]);return h.useEffect(()=>{setTimeout(()=>{t(0)},1e3)},[]),a.jsxs("div",{className:"h-full snap-y snap-mandatory overflow-auto no-scrollbar flex flex-col md:items-center",children:[n&&a.jsx(ze,{children:a.jsx(ua,{})}),s]})}function XY(){return a.jsx(AY,{children:a.jsx(cp,{target:"song",children:a.jsxs("div",{className:"fixed bg-[--layout-cl] md:bg-transparent top-0 left-0 right-0 bottom-[47px] md:inset-0 sm:relative overflow-hidden flex-grow",children:[a.jsx(QY,{}),a.jsx(FY,{})]})})})}const hs={home:"/",discorver:"/discover",catogory:"/category",search:"/search",playlist:"/playlist/:id",login:"/login",unauthorized:"/unauthorized",singer:"/singer/:id",user:"/user/:id",trending:"/trending",catogoryDetail:"/category/:id"},u2={myMusic:"/my-music",songLyric:"/my-music/lyric/:id"},mn={dashboard:"/dashboard",genre:"/dashboard/genre",playlist:"/dashboard/playlist",song:"/dashboard/song",addSong:"/dashboard/song/add-song",editSong:"/dashboard/song/:songId/edit",playlistDetail:"/dashboard/playlist/:id",songLyric:"/dashboard/lyric/:id",singer:"/dashboard/singer",editSinger:"/dashboard/singer/:id",album:"/dashboard/album",editAlbum:"/dashboard/album/:id",homepage:"/dashboard/homepage",category:"/dashboard/category",categoryDetail:"/dashboard/category/:id"},YY=[{path:hs.home,component:XY,layout:""},{path:hs.discorver,component:xH,layout:""},{path:hs.playlist,component:FH,layout:""},{path:hs.search,component:WG,layout:""},{path:hs.unauthorized,component:KG,layout:""},{path:hs.singer,component:uW,layout:""},{path:hs.user,component:hW,layout:""},{path:hs.catogory,component:pW,layout:""},{path:hs.trending,component:SW,layout:""},{path:hs.catogoryDetail,component:EW,layout:""}],JY=[{path:u2.myMusic,component:WH,layout:""},{path:u2.songLyric,component:DG,layout:""}],ZY=[{path:mn.dashboard,component:IW,layout:""},{path:mn.playlist,component:lX,layout:""},{path:mn.genre,component:SX,layout:""},{path:mn.singer,component:wX,layout:""},{path:mn.editSinger,component:zX,layout:""},{path:mn.playlistDetail,component:gX,layout:""},{path:mn.album,component:HX,layout:""},{path:mn.editAlbum,component:RY,layout:""},{path:mn.song,component:NW,layout:""},{path:mn.addSong,component:nX,layout:l2},{path:mn.editSong,component:sX,layout:l2},{path:mn.songLyric,component:o2,layout:""},{path:mn.songLyric,component:o2,layout:""},{path:mn.homepage,component:iY,layout:""},{path:mn.category,component:hY,layout:""},{path:mn.categoryDetail,component:bY,layout:""}];function eJ(){const{user:t,loading:e}=xe();return e?a.jsx(ze,{children:a.jsx(ua,{})}):t?a.jsx(hm,{}):a.jsx(Mj,{state:{from:"/my-music"},replace:!0,to:"/login"})}function tJ(){const[t,e]=h.useState(!0),[n,r]=h.useState(!1),{user:s,loading:i}=xe();return h.useEffect(()=>{(async()=>{await Jn(1e3),r(!0),e(!1)})()},[]),i||t?a.jsx(ze,{children:a.jsx(ua,{})}):s&&n?a.jsx(hm,{}):a.jsx(Mj,{replace:!0,to:"/unauthorized"})}const SA=[{path:"/dashboard/homepage",title:"Home Page",icon:a.jsx(Pu,{})},{path:"/dashboard/category",title:"Category",icon:a.jsx(xm,{})},{path:"/dashboard/song",title:"Songs",icon:a.jsx(oa,{})},{path:"/dashboard/playlist",title:"Playlists",icon:a.jsx(oM,{})},{path:"/dashboard/album",title:"Albums",icon:a.jsx(Hj,{})},{path:"/dashboard/singer",title:"Singers",icon:a.jsx(ex,{})},{path:"/dashboard/genre",title:"Genres",icon:a.jsx(RM,{})}];function nJ(){const[t,e]=h.useState(!1);Zn();const n={container:"hidden md:block bg-[#f1f1f1] text-[#333] border-r border-black/10 transition-[width] relative flex-shrink-0",head:"h-[60px] flex items-center justify-center",logoText:"text-[22px] font-[500] whitespace-nowrap tracking-[-1px]",logoImage:"max-w-[50px] p-[4px]",item:"hover:bg-[--a-5-cl] flex whitespace-nowrap space-x-2 items-center justify-center p-2.5 text-sm",icon:"w-[24px] flex-shrink-0"};return a.jsxs("div",{className:`${n.container} ${t?"w-[150px]":"w-[70px]"}`,children:[a.jsx("div",{className:"h-[60px] flex items-center justify-center",children:a.jsx("div",{className:"w-10 flex items-center justify-center  bg-white rounded-full",children:a.jsx("span",{className:"font-bold text-[--primary-cl] leading-[40px] translate-y-[1px]",children:":D"})})}),a.jsxs("div",{className:"[&_svg]:w-5 [&_svg]:flex-shrink-0",children:[a.jsxs(X,{className:`
              ${n.item} ${t?"!justify-start":""}
              ${location.hash==="#/dashboard"?"text-[--primary-cl]":""}`,to:"/dashboard",children:[a.jsx(mm,{}),t&&a.jsx("span",{children:"Dashboard"})]}),SA.map((r,s)=>a.jsxs(X,{className:`
              ${n.item} ${t?"!justify-start":""}
              ${location.hash.includes(r.path)?"text-[--primary-cl]":""}`,to:r.path,children:[r.icon,t&&a.jsx("span",{children:r.title})]},s)),a.jsxs(X,{to:"/",target:"_blank",className:`${n.item} ${t?"!justify-start":""}
               ${location.pathname==="/dashboard"?"text-[--primary-cl]":""}
               `,children:[a.jsx(zj,{className:n.icon}),t&&a.jsx("span",{children:"Home"})]})]}),a.jsx(q,{onClick:()=>e(r=>!r),size:"clear",className:"!absolute p-1.5 bottom-5 right-0 translate-x-[50%]",children:t?a.jsx($U,{className:"w-5 "}):a.jsx(VU,{className:"w-5"})})]})}function bA({className:t=""}){const{behind:e,ahead:n,backward:r,forward:s}=uN();return a.jsxs("div",{className:`"flex space-x-3 [&>button]:p-1 ${t}`,children:[a.jsx("button",{onClick:r,className:`relative ${Ef(!e.length)}`,children:a.jsx(av,{className:"w-5"})}),a.jsx("button",{onClick:s,className:`relative ${Ef(!n.length)}`,children:a.jsx($j,{className:"w-5"})})]})}function rJ(){const[t,e]=h.useState(0),n=r=>{const s=r.target.scrollTop||0;e(s)};return h.useEffect(()=>{const r=document.querySelector(".main-container");return r==null||r.addEventListener("scroll",n),()=>{r==null||r.removeEventListener("scroll",n)}},[]),a.jsx(a.Fragment,{children:a.jsx("div",{className:`hidden md:flex px-[40px] z-[99] h-[60px] flex-shrink-0 items-center justify-between ${t?" shadow-lg":""}`,children:a.jsxs("div",{className:"flex",children:[a.jsx(X,{to:"/dashboard",className:"text-xl font-bold text-[--primary-cl]",children:"Dashboard"}),a.jsx(bA,{className:"ml-5"})]})})})}function sJ(){const[t,e]=h.useState(!1),n=h.useRef(null),r=s=>{var i;(i=n.current)!=null&&i.contains(s.target)||e(!1)};return h.useEffect(()=>(t&&window.addEventListener("click",r),()=>{window.removeEventListener("click",r)}),[t]),a.jsxs(a.Fragment,{children:[a.jsxs(Ot,{className:`[&_svg]:w-6 [&_span]:font-semibold text-sm absolute z-[99] duration-[.25] flex flex-col
        transition-[left,opacity] bg-[--popup-cl] bottom-[60px] 
        ${t?"left-[10px] opacity-[1] pointer-events-auto":"left-0 opacity-[0] pointer-events-none"}`,children:[a.jsxs(X,{className:"inline-flex items-center py-1.5 space-x-2",to:"/dashboard",children:[a.jsx(mm,{}),a.jsx("span",{children:"Dashboard"})]}),SA.map((s,i)=>a.jsxs(X,{className:"inline-flex items-center py-1.5 space-x-2",to:s.path,children:[s.icon,a.jsx("span",{children:s.title})]},i)),a.jsxs(X,{className:"inline-flex items-center py-1.5 space-x-2",target:"_blank",to:"/",children:[a.jsx(zj,{}),a.jsx("span",{children:"Go to app"})]})]}),a.jsx(q,{ref:n,size:"clear",onClick:()=>e(!t),className:"!absolute transition-[left] z-[99] bottom-[10px] left-[10px]  p-1.5",children:a.jsx(ao,{className:"w-6"})})]})}function iJ({className:t="",toast:e,onClick:n}){const[r,s]=h.useState(!1),i={icon:"w-6",container:"transition-[transform,opacity] shadow-[0_0_6px_0_rgba(0,0,0,0.3)] px-3 py-2 space-x-2 rounded-md flex items-center bg-[--popup-cl] text-[--text-cl] w-full",text:"font-semibold text-sm",open:"opacity-[1] translate-x-0",init:"opacity-0 translate-x-10"},o=()=>{switch(e.variant){case"success":return a.jsx(Ku,{className:`${i.icon} text-emerald-500`});case"error":return a.jsx(Xu,{className:`${i.icon} text-red-500`})}};return h.useEffect(()=>{setTimeout(()=>{s(!0)},0)},[]),a.jsxs("div",{onClick:()=>n?n(e.id):void 0,className:`whitespace-nowrap ${i.container} ${t} ${r?i.open:i.init} `,children:[o(),a.jsx("p",{className:i.text,children:e.desc})]})}const EA=({time:t=6e3,className:e=""})=>{const{setToasts:n,toasts:r}=te(),[s,i]=h.useState(""),o=l=>{n(c=>c.filter(u=>u.id!=l))};return h.useEffect(()=>{s&&n(l=>l.filter(c=>c.id!=s))},[s]),h.useEffect(()=>{if(!r.length)return;const l=r[r.length-1].id;setTimeout(()=>{i(l)},t)},[r]),a.jsx(a.Fragment,{children:so.createPortal(a.jsx("div",{className:`fixed z-[199] ${e}`,children:a.jsx("div",{className:"flex flex-col gap-[10px]",children:!!r.length&&r.map((l,c)=>a.jsx(iJ,{onClick:o,toast:l},c))})}),document.getElementById("portals"))})};function aJ({children:t}){return Zn().pathname.includes("lyric")?t:a.jsx("div",{className:"pb-[46px]",children:t})}function oJ(){const{isOnMobile:t}=ss(),e=h.useRef(!1);return h.useEffect(()=>{if(!e.current){e.current=!0;const n=document.querySelector("body");n&&(n.setAttribute("data-theme","white"),n.classList.remove("dark")),document.title="Dashboard"}},[]),a.jsx(a.Fragment,{children:a.jsx(pC,{children:a.jsx(DW,{children:a.jsx(P8,{children:a.jsx(UW,{children:a.jsxs("div",{className:"bg-[--layout-cl] text-[--text-cl] fixed inset-full flex ",children:[t?a.jsx(sJ,{}):a.jsx(nJ,{}),a.jsxs("div",{className:"flex flex-col flex-grow",children:[a.jsx(rJ,{}),a.jsx("div",{className:"main-container flex flex-col flex-grow overflow-auto p-[10px] md:px-[40px] md:pt-0",children:a.jsx(aJ,{children:a.jsx(hm,{})})})]}),a.jsx(EA,{className:"left-[50%] translate-x-[-50%] top-[10px] md:top-[unset] md:bottom-[60px] md:left-[20px] md:translate-x-0"}),a.jsx(mC,{})]})})})})})})}function lJ({variant:t="desktop"}){const{desktopTabs:e,activeTab:n,setActiveTab:r,mobileActiveTab:s,mobileTabs:i,setMobileActiveTab:o,idle:l}=ut(),c=t==="desktop"?n:s,u=t==="desktop"?r:o,d=t==="desktop"?e:i,m={item:"px-3 md:px-8 leading-[30px] font-bold cursor-pointer  rounded-full",fadeTransition:"opacity-0 transition-opacity duration-[.3s]"};return a.jsx("ul",{className:`inline-flex mx-auto rounded-full space-x-1 bg-white/10 p-1 ${l?m.fadeTransition:""}`,children:d.map((p,g)=>{const x=p===c;return a.jsx("li",{onClick:()=>u(p),className:`${m.item} ${x?"bg-white/20":"hover:bg-white/5"}`,children:p},g)})})}function cJ({children:t}){const{isOpenComment:e,setIsOpenComment:n}=On(),r={mainContainer:"hidden fixed w-[400px] md:flex flex-col bottom-0 right-[0] top-0 z-[99] p-3 pb-5 text-white border-l-[1px] border-[--a-5-cl] transition-[transform] duration-[.5s] linear delay-100"};return a.jsxs("div",{className:`text-white ${r.mainContainer} ${e?"translate-x-0":"translate-x-full"}     `,children:[a.jsx("div",{className:"bg-opacity-[0.8] backdrop-blur-[15px] z-[-1] bg-[#333] absolute inset-0"}),a.jsx("p",{children:a.jsx("button",{className:"p-1.5",onClick:()=>n(!1),children:a.jsx(Xu,{className:"w-7"})})}),t]})}function uJ(){const{shouldFetchComment:t,setComments:e,isOpenComment:n,setIsFetching:r}=On(),{currentSongData:s}=oe(We),{fetchComment:i}=sp(),o=async()=>{try{if(!(s!=null&&s.song))return;const l=await i({target_id:s.song.id});e(l||[])}catch(l){console.log({error:l})}finally{r(!1)}};h.useEffect(()=>{!n||!(s!=null&&s.song)||t.current&&(t.current=!1,o())},[n]),h.useEffect(()=>()=>{t.current||(t.current=!0)},[s==null?void 0:s.song])}function kA(){const{isFetching:t,comments:e}=On();return uJ(),t?a.jsx(ze,{children:a.jsx(Ae,{className:"w-6 animate-spin"})}):a.jsx($w,{comments:e})}function dJ({song:t}){const{setIsOpenComment:e}=On();return a.jsxs(a.Fragment,{children:[a.jsx(Ys,{colorClasses:"bg-[#333] text-white",position:"top-[calc(100%+8px)]",content:"Comment",children:a.jsx("button",{onClick:()=>e(!0),className:"btn",children:a.jsx(cv,{})})}),so.createPortal(a.jsxs(cJ,{children:[a.jsx(kA,{}),a.jsx(up,{variant:"comment",targetId:t.id})]}),document.getElementById("portals"))]})}function hJ(){const{user:t}=xe(),{activeTab:e,idle:n,setIsOpenFullScreen:r}=ut(),{currentSongData:s}=oe(We),i=Nt(),o=s&&t?s.song.owner_email===t.email&&s.song.is_official===!1:!1,l=()=>{s!=null&&s.song&&(r(!1),setTimeout(()=>{i(`/my-music/lyric/${s==null?void 0:s.song.id}`)},300))},c={rightCta:"[&_button.btn]:h-[38px] [&_button.btn]:w-[38px] [&_button.btn]:bg-white/5 [&_button.btn]:p-2 [&_button.btn]:rounded-full  hover:[&_button]:bg-[--primary-cl]",button:"btn",headerWrapper:"relative z-[90] flex py-[25px] px-[40px] w-full items-center",fadeTransition:"opacity-0 transition-opacity duration-[.3s]"};return a.jsx(a.Fragment,{children:a.jsxs("div",{className:`${c.headerWrapper} ${n?"pointer-events-none":""}`,children:[n&&s&&a.jsx("div",{className:"absolute left-4",children:e!=="Songs"&&a.jsxs(a.Fragment,{children:[a.jsx("p",{className:"font-playwriteCU text-sm",children:s.song.name}),a.jsx("p",{className:"opacity-70 text-sm",children:s.song.singers.map((u,d)=>(d?", ":"")+u.name)})]})}),a.jsx(lJ,{}),a.jsxs("div",{className:`absolute flex right-4 space-x-3 ${n&&c.fadeTransition} ${c.rightCta}`,children:[a.jsx(cp,{target:"song",children:(s==null?void 0:s.song)&&a.jsx(dJ,{song:s.song})}),o&&e==="Lyric"&&a.jsx(Ys,{colorClasses:"bg-[#333] text-white",position:"top-[calc(100%+8px)]",content:"Edit lyric",children:a.jsx("button",{onClick:()=>l(),className:` ${c.button}`,children:a.jsx(pm,{})})}),a.jsxs(Fn,{children:[a.jsx(Mn,{children:a.jsx(Ys,{colorClasses:"bg-[#333] text-white",isWrapped:!0,position:"top-[calc(100%+8px)]",content:"Setting",children:a.jsx("button",{className:`${c.button} `,children:a.jsx(dv,{})})})}),a.jsx(Dn,{className:"top-[calc(100%+8px)] right-0",animationClassName:"origin-top-right",children:a.jsx($R,{})})]}),a.jsx(Ys,{colorClasses:"bg-[#333] text-white",position:"top-[calc(100%+8px)]",content:"Close",children:a.jsx("button",{onClick:()=>r(!1),className:`p-2 ${c.button}`,children:a.jsx(Vj,{})})})]})]})})}function jA({className:t}){const{playerConfig:{lyricSize:e},audioRef:n,isOpenFullScreen:r,activeTab:s}=ut();if(!n.current)throw new Error("audioRef error");const{loading:i,songLyrics:o}=lw(),l=h.useMemo(()=>r&&s==="Lyric",[r,s]),{currentIndex:c,lyricRefs:u}=mN({audioEle:n.current,isActive:l,lyrics:o}),d={small:"text-[16px] sm:text-[26px]",medium:"text-[20px] sm:text-[30px]",large:"text-[26px] sm:text-[46px]"},m=()=>o.map((g,x)=>{let w="coming";return c===x?w="active":x<c&&(w="done"),a.jsx(fN,{ref:v=>u.current[x]=v,status:w,text:g.text,activeColor:"scale-[1.3]",className:"leading-[1.3] mb-5 w-[70%] last:mb-[50vh]"},x)}),p={container:"no-scrollbar pt-10 mask-image overflow-y-auto overflow-x-hidden font-['Inter',system-ui]"};return a.jsxs("div",{className:`${p.container} ${d[e||"medium"]} ${t}`,children:[i&&a.jsx("div",{className:"relative w-full h-full",children:a.jsx(ze,{children:a.jsx(Ae,{className:"w-7 animate-spin"})})}),!i&&a.jsx(a.Fragment,{children:o.length?m():a.jsx("div",{className:"relative w-full h-full",children:a.jsx(ze,{children:a.jsx("h1",{className:"text-[30px] opacity-60",children:"..."})})})})]})}const xc=.3,d2=t=>t%2!==0;function fJ(){const{songLyrics:t,loading:e}=lw(),{audioRef:n,isOpenFullScreen:r,activeTab:s}=ut();if(!n.current)throw new Error("useKaraoke !audioRef.current");const{playStatus:i}=oe(Un),[o,l]=h.useState(0),c=h.useRef(null),u=h.useRef(null),d=h.useRef(null),m=h.useRef(null),p=h.useRef(0),g=h.useRef(0),x=h.useRef("paused"),w=h.useRef(!1),v=h.useMemo(()=>r&&s=="Karaoke",[r,s]),S=h.useMemo(()=>{if(t.length){if(o<0)return{odd:"",even:""};const P=d2(o);if(!t[o+1])return{odd:"",even:""};const F=P?[o,o+1]:[o+1,o],j=t[F[0]].text.trim(),k=t[F[1]].text.trim();return{odd:j,even:k}}else return{odd:"",even:""}},[o,t]),_=P=>{P.style.animation="none"},E=(P,F,j,k)=>{var N,M;let C="running";x.current==="paused"&&(C="paused"),j.style.animation=`${P} ${(((N=F==null?void 0:F.tune)==null?void 0:N.end)||F.end)-(((M=F==null?void 0:F.tune)==null?void 0:M.start)||F.start)}s linear ${C} forwards`;const R=+k.toFixed(1);Math.abs(R)>.2&&(j.style.animationDelay=`${R}s`)},I=()=>{if(!t.length)return;const P=n.current.currentTime>=p.current?"forward":"backward";p.current=n.current.currentTime;let F=g.current;switch(P){case"forward":for(;F<t.length&&t[F+1]&&t[F+1].start-xc<p.current+xc;)F+=1;break;case"backward":for(;F>0&&t[F-1]&&t[F-1].end-xc>p.current+xc;)F-=1;break}if(F!==g.current||w.current||x.current==="paused"||x.current==="waiting"){if(w.current=!1,g.current=F,l(F),!c.current||!u.current||!m.current||!d.current)return;const j=t[F],{tune:k,text:C,cut:R}=j,N=p.current+xc-k.start,M=C.split(" "),A=d2(F),fe=yN(A?m.current:d.current),Le=Bw(M,R,k.grow),de=A?[c.current,u.current]:[u.current,c.current],he=xN(Le,fe);E(he,j,de[0],-N),_(de[1])}};return h.useEffect(()=>{x.current==="waiting"?setTimeout(()=>{x.current=i},300):x.current=i},[i]),h.useEffect(()=>{v&&(w.current=!0,i==="paused"&&I())},[v]),h.useEffect(()=>{if(!(!t.length||!v))return n.current.addEventListener("timeupdate",I),()=>{n.current.removeEventListener("timeupdate",I)}},[t,v]),h.useEffect(()=>()=>{p.current=0,g.current=-1,l(0)},[t]),{loading:e,currentIndexRef:g,oddOverlay:c,evenOverlay:u,currentIndex:o,textData:S,tempEventText:d,tempOddText:m}}function h2({text:t,overlayRef:e}){const{playStatus:n}=oe(Un),[r,s]=h.useState(t),[i,o]=h.useState(!1),l=h.useRef(!0);h.useEffect(()=>{t&&o(!1)},[t]),h.useEffect(()=>{if(i)return;const u=()=>{s(t),o(!0)};l.current?setTimeout(u,300):(l.current=!0,u())},[i]),h.useEffect(()=>{n==="waiting"&&(l.current=!1),e.current&&(n==="playing"?e.current.style.animationPlayState="running":e.current.style.animationPlayState="paused")},[n]);const c={lyric:"relative duration-300 text-[44px] font-[700] pointer-none whitespace-nowrap"};return a.jsxs("div",{className:`${c.lyric} ${l.current?"transition-opacity":""} ${i?"opacity-[1]":"opacity-0"}`,children:[r||"...",a.jsx("p",{ref:e,className:"absolute whitespace-nowrap w-0 overflow-hidden text-[#ffed00] left-0 top-0 h-full",children:r||"..."})]})}function mJ(){const{loading:t,evenOverlay:e,oddOverlay:n,tempEventText:r,tempOddText:s,textData:i}=fJ();return t?a.jsx(ze,{children:a.jsx(Ae,{className:"w-7 animate-spin"})}):a.jsxs(a.Fragment,{children:[a.jsx("div",{ref:r,className:"inline-flex h-0 opacity-0",children:i.even.split(" ").map((o,l)=>a.jsx("span",{className:"leading-1",children:o},l))}),a.jsx("div",{ref:s,className:"inline-flex h-0 opacity-0",children:i.odd.split(" ").map((o,l)=>a.jsx("span",{className:"k leading-1",children:o},l))}),a.jsx(h2,{overlayRef:e,text:i.even}),a.jsx("div",{className:"mt-8"}),a.jsx(h2,{overlayRef:n,text:i.odd})]})}const TA=()=>{window.dispatchEvent(new Event("mousemove"))};function ay(t,e,n=!1){const r=window.innerWidth,i=t.getBoundingClientRect().left,o=r-(i+t.offsetWidth),l=Math.abs(Math.ceil(i-o))/2;if(l<5)return!1;n&&(e.onscroll=()=>{},setTimeout(()=>{e.onscroll=TA},900)),n||Math.abs(i)>r||Math.abs(o)>r?e.style.scrollBehavior="auto":e.style.scrollBehavior="smooth";let c=e.scrollLeft;return o>i?setTimeout(()=>{e.scrollLeft=c-l},300):o<i&&setTimeout(()=>{e.scrollLeft=c+l},300),!0}function pJ(){const t=on(),{isOpenFullScreen:e,idle:n}=ut(),{currentQueueId:r}=oe(We),{playStatus:s}=oe(Un),i=h.useRef(null),o=h.useRef(null),l=h.useRef("paused"),c=()=>{!(o!=null&&o.current)||!(i!=null&&i.current)||ay(o.current,i.current,n)},u=p=>{let g=document.querySelector(".song-thumb.centered");if(!g)if(o.current)g=o.current;else return;let x;switch(p){case"ArrowRight":x=g.nextElementSibling;break;case"ArrowLeft":x=g.previousElementSibling;break}x&&i.current&&(g.classList.remove("centered"),x.classList.add("centered"),ay(x,i.current))},d=()=>{if(!o.current)return;const p=document.querySelector(".song-thumb.centered"),g=p==null?void 0:p.getAttribute("queue-id");g&&t(Is(g))},m=p=>{if(p.key==="ArrowRight"||p.key==="ArrowLeft")return p.preventDefault(),u(p.key);p.key==="Enter"&&d()};return h.useEffect(()=>{e&&c()},[r,e]),h.useEffect(()=>{if(e)return document.addEventListener("keydown",m),()=>{var p;document.removeEventListener("keydown",m),(p=document.querySelector(".song-thumb.centered"))==null||p.classList.remove("centered")}},[r,e]),h.useEffect(()=>{const p=i==null?void 0:i.current;if(p)return p.onscroll=TA,()=>{p.onscroll=()=>{}}},[]),h.useEffect(()=>{l.current=s},[s]),{activeSongRef:o,containerRef:i}}function gJ(){const t=on(),{activeTab:e,isOpenFullScreen:n,playerConfig:r,idle:s}=ut(),{currentSongData:i}=oe(We),{queueSongs:o,currentQueueId:l}=oe(We),{activeSongRef:c,containerRef:u}=pJ(),d=v=>{l!==v&&t(Is(v))},m=fE(()=>g("next"),200),p=fE(()=>g("previous"),200),g=(v="next")=>{const S=u.current;S.style.scrollBehavior="smooth",v==="next"?S.scrollLeft+=500:v==="previous"&&(S.scrollLeft-=500)},x={songsListTab:" relative h-full no-scrollbar flex items-center flex-row overflow-auto scroll-smooth px-[calc(50%-350px/2)]",absoluteButton:"absolute top-[50%] -translate-y-[50%] p-[8px] bg-white/5 rounded-full",lyricTabContainer:"px-[40px] min-[1536px]:container  min-[1536px]:px-[200px] h-full flex items-center justify-center flex-row",fadeTransition:"opacity-0 transition-opacity duration-[.3s]"},w=h.useMemo(()=>{if(i!=null&&i.song&&o.length)return o.map((v,S)=>v.queue_id===l?a.jsx(Fg,{ref:c,hasTitle:!0,onClick:()=>d(v.queue_id),active:!0,data:v},S):a.jsx(Fg,{idleClass:`${s?x.fadeTransition:""}`,hasTitle:!0,active:!1,data:v,onClick:()=>d(v.queue_id)},S))},[i==null?void 0:i.song,o,s]);return a.jsxs(a.Fragment,{children:[a.jsx("div",{ref:u,className:`song-list-container ${x.songsListTab} ${e!=="Songs"?"opacity-0":"opacity-100"}`,children:w}),e==="Songs"&&!s&&a.jsxs(a.Fragment,{children:[a.jsx(se,{hover:"scale",size:"clear",onClick:()=>p(),className:`${x.absoluteButton} left-[20px]`,children:a.jsx(uv,{className:"w-6"})}),a.jsx(se,{hover:"scale",size:"clear",onClick:()=>m(),className:`${x.absoluteButton} right-[20px]`,children:a.jsx(lf,{className:"w-6"})})]}),a.jsx(wC,{children:a.jsxs(qR,{isOpenLyricTabs:n&&(e==="Lyric"||e==="Karaoke"),children:[a.jsx("div",{className:`absolute inset-0 z-20 ${e==="Lyric"?"":"hidden"}`,children:a.jsxs("div",{className:x.lyricTabContainer,children:[a.jsx(Fg,{classNames:r.songImage?"":"hidden",active:!0,data:i==null?void 0:i.song}),a.jsx(jA,{className:`w-full ml-[40px] h-full ${r.songImage,""}`})]})}),a.jsx("div",{className:`absolute font-[Inter,system-ui] inset-0 z-20 flex flex-col items-center justify-center ${e==="Karaoke"?"":"hidden"}`,children:a.jsx(mJ,{})})]})})]})}function xJ(){var o,l;const{isOpenFullScreen:t,idle:e,activeTab:n,playerConfig:{songBackground:r}}=ut(),{currentSongData:s}=oe(We),i={wrapper:`fixed inset-0 z-50 overflow-hidden text-white bg-zinc-900
    } transition-transform duration-[.7s] linear delay-100`,bg:"absolute inset-0 -z-10 brightness-[70%]",container:"absolute w-full top-0 bottom-[90px] flex flex-col",content:"flex-grow relative overflow-hidden",fadeTransition:"opacity-0 transition-opacity duration-[.3s]"};return a.jsxs("div",{className:`${i.wrapper}  ${t?"translate-y-0":"translate-y-full"}`,children:[a.jsx("div",{className:` ${i.bg}`,children:r&&a.jsx(nd,{radioGroup:"",height:"100%",width:"100%",hash:((o=s==null?void 0:s.song)==null?void 0:o.blurhash_encode)||Sw})}),a.jsxs("div",{className:i.container,children:[a.jsx(hJ,{}),a.jsx("div",{className:i.content,children:a.jsx(gJ,{})}),n!=="Songs"&&a.jsxs("p",{className:`text-center ${e&&i.fadeTransition}`,children:[((l=s==null?void 0:s.song)==null?void 0:l.name)||"...",a.jsxs("span",{className:"opacity-70 text-sm",children:[" - ",s==null?void 0:s.song.singers.map((c,u)=>(u?", ":"")+c.name)]})]})]})]})}function yJ(){const{user:t}=xe(),[e,n]=h.useState([]),[r,s]=h.useState(!0);return{isFetching:r,recentSongs:e,getRecentSongs:async()=>{try{if(t&&t.recent_song_ids.length){const o=le(_t,Q(Lr(),"in",t.recent_song_ids)),l=await $t(o);n(l)}else{const o=It()["recent-songs"]||[];n(o)}}catch(o){console.log({message:o})}finally{s(!1)}}}}function vJ({setTab:t}){const e=on(),n=h.useRef(!1),{getRecentSongs:r,isFetching:s,recentSongs:i}=yJ(),o=[...Array(5).keys()].map(c=>a.jsx(ge,{className:"h-[57px] mt-1"},c)),l=c=>{e(np({songs:[c]})),e(Is(c.queue_id)),t("Queue")};return h.useEffect(()=>{n.current||(n.current=!0,r())},[]),s?o:a.jsx(Sr,{isHasCheckBox:!1,songVariant:"recent-song",songs:i,setSong:l})}const wJ=["Queue","Recent"];function _J(){const t=on(),{isOpenSongQueue:e,setIsOpenSongQueue:n}=ut(),{queueSongs:r,currentQueueId:s,isFetching:i}=oe(We),{resetForNewSong:o}=gi(),[l,c]=h.useState("Queue"),u=h.useCallback(g=>{g!==s&&t(Is(g))},[s]),d=h.useCallback(()=>{t(yU()),o(),n(!1)},[]),m=[...Array(5).keys()].map(g=>a.jsx(ge,{className:"h-[56px] mt-1 rounded-md"},g)),p={mainContainer:"hidden fixed w-[300px] md:flex flex-col bottom-[80px] right-[0] top-[0] z-20 px-3 pt-4 bg-[--layout-cl] border-l-[1px] border-[--a-5-cl] transition-[transform] duration-[.5s] linear delay-100",songListContainer:"flex-grow overflow-y-auto pb-[10px] overflow-x-hidden no-scrollbar mt-3"};return a.jsx(En,{children:a.jsxs("div",{className:`${p.mainContainer} ${e?"translate-x-0---":"translate-x-full"}     `,children:[a.jsx(tr,{className:"w-fit mx-auto text-sm",tab:l,setTab:c,tabs:wJ,render:g=>g}),a.jsx("div",{className:p.songListContainer,children:l==="Queue"?a.jsxs(a.Fragment,{children:[a.jsx(Sr,{isHasCheckBox:!1,songs:r,setSong:g=>u(g.queue_id),songVariant:"queue-song",getActive:(g,x)=>g.queue_id===x.queue_id}),i&&m,a.jsx("div",{className:"text-center",children:!!r.length&&a.jsxs(se,{onClick:d,size:"clear",color:"primary",className:"rounded-full my-5 px-3 py-1 space-x-1",children:[a.jsx(pt,{className:"w-6"}),a.jsx("span",{className:"font-playwriteCU leading-[2.2]",children:"Clear"})]})})]}):a.jsx(vJ,{setTab:c})})]})})}const SJ=h.memo(_J);function bJ({vinylRef:t}){const{playStatus:e}=oe(Un);h.useEffect(()=>{const n=t.current;n&&(e==="playing"?n.style.animationPlayState="running":n.style.animationPlayState="paused")},[e])}function EJ({textRef:t,textWrapperRef:e,content:n}){const r=h.useRef(),s=h.useRef(),i=h.useRef(!1),o=h.useRef(0),l=h.useRef(0),c=h.useRef(0),u=()=>{t.current&&(t.current.style.transition="none",t.current.style.transform="translateX(0)")},d=()=>{t.current&&(t.current.style.transition=`transform linear ${l.current}s`,t.current.style.transform=`translateX(-${c.current}px)`,s.current=setTimeout(u,l.current*1e3))},m=()=>{!t.current||!e.current||(c.current=t.current.offsetWidth-o.current,l.current=Math.ceil(c.current/35))},p=()=>{!i.current||!t.current||!e.current||(l.current=0,c.current=0,i.current=!1,clearInterval(r.current),clearTimeout(s.current),e.current.classList.remove("mask-image-horizontal"),u())},g=()=>{!t.current||!e.current||!n||!(t.current.offsetWidth>e.current.offsetWidth)||(i.current=!0,e.current.classList.add("mask-image-horizontal"),o.current=t.current.clientWidth,t.current.innerHTML=t.current.innerText+"&nbsp; &nbsp; &nbsp;"+t.current.innerText,m(),setTimeout(d,1e3),r.current=setInterval(d,l.current*1e3+3e3))};h.useEffect(()=>(g(),p),[n])}function kJ({content:t,className:e}){const n=h.useRef(null),r=h.useRef(null);return EJ({textRef:r,textWrapperRef:n,content:t}),a.jsx("div",{ref:n,className:"overflow-hidden relative h-full ",children:a.jsx("div",{ref:r,className:`absolute left-0 whitespace-nowrap ${e}`,children:t||"..."})})}const IA=h.memo(kJ);function jJ({isOpenFullScreen:t,song:e}){const n=h.useRef(null);bJ({vinylRef:n});const r={songInfoChild:"flex flex-row"};return a.jsx("div",{className:`w-1/4  ${ta(t)}`,children:a.jsxs("div",{className:`${r.songInfoChild} ${ta(t)}`,children:[a.jsx("div",{ref:n,className:"w-[56px] h-[56px] flex-shrink-0 animate-[spin_8s_linear_infinite]",children:a.jsx(Ce,{src:e==null?void 0:e.image_url,className:"rounded-full h-full object-cover"})}),a.jsxs("div",{className:"ml-2 flex-grow",children:[a.jsx("div",{className:"h-[32px]",children:a.jsx(IA,{className:"font-medium",content:(e==null?void 0:e.name)||"Name"})}),e&&a.jsx("div",{className:"leading-[1.2] text-sm opacity-[.7] line-clamp-1",children:e.singers.map((s,i)=>s.id?a.jsx(X,{to:`/singer/${s.id}`,className:"hover:text-[--primary-cl] hover:underline",children:(i?", ":"")+s.name},i):a.jsx("span",{children:(i?", ":"")+s.name},i))})]})]})})}function TJ({audioEle:t,volumeLineRef:e}){const{theme:n}=ss(),[r,s]=h.useState(!1),[i,o]=Px("volume",1),l=d=>{const p=d.target.getBoundingClientRect(),g=e.current;if(g){let x=+((d.clientX-p.x)/g.clientWidth).toFixed(2);x>.9?x=1:x<.05?(x=0,s(!0)):s(!1),o(x)}},c=d=>{d.preventDefault();const m=.1;let p=i;d.deltaY>0?p-m>0?p-=m:p=0:p+m<1?p+=m:p=1,o(+p.toFixed(2))},u=()=>s(!r);return h.useEffect(()=>{if(e.current&&t){const d=i*100;e.current.style.background=Nw(d),t.volume=i,s(i===0)}},[i,n]),h.useEffect(()=>{t&&(t.muted=r)},[r]),{volume:i,handleSetVolume:l,isMute:r,handleMute:u,handleWheel:c}}function IJ({audioEle:t}){const e=h.useRef(null),{handleMute:n,handleWheel:r,handleSetVolume:s,isMute:i}=TJ({audioEle:t,volumeLineRef:e});return a.jsxs("div",{className:"flex flex-grow items-center mr-2",children:[a.jsx("button",{onWheel:r,onClick:()=>n(),children:i?a.jsx(OM,{className:"w-6"}):a.jsx(MM,{className:"w-6"})}),a.jsx(rd,{className:"h-1 ml-1",onClick:s,elelRef:e})]})}function CJ({handlePlayPause:t,playStatus:e}){const n={icon:"w-[50px] sm:w-10"},r=()=>{switch(e){case"playing":return a.jsx(Qj,{className:`${n.icon}`});case"error":return a.jsx(gm,{className:`${n.icon}`});case"loading":case"waiting":return a.jsx(Ae,{className:`${n.icon} animate-spin`});case"paused":return a.jsx(wM,{className:`${n.icon}`})}};return a.jsx(a.Fragment,{children:a.jsx("button",{className:"inline-flex items-center justify-center",onClick:()=>t(),children:r()})})}function RJ(){var w;const{playerConfig:{isShuffle:t,repeat:e},isOpenFullScreen:n,timelineEleRef:r,currentTimeEleRef:s}=ut(),{currentSongData:i,queueSongs:o}=oe(We),{playStatus:l}=oe(Un),{next:c,previous:u,toggleRepeat:d,toggleShuffle:m,handlePlayPause:p,handleSeek:g}=gi(),x={button:"p-1 rounded-full md:bg-transparent ",buttonsContainer:"w-full flex justify-center items-center mb-3 sm:mb-0 space-x-3",progressContainer:"flex w-full flex-row items-center ",icon:"w-[44px] sm:w-7",before:"before:content-[''] before:w-[100%] before:h-[24px] before:absolute before:top-[50%] before:translate-y-[-50%]"};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:`${x.buttonsContainer}`,children:[a.jsxs("button",{disabled:o.length<=1,className:`relative ${x.button} ${e!=="no"&&"text-[--primary-cl]"}`,onClick:d,children:[a.jsx(Oj,{className:x.icon}),a.jsx("span",{className:"absolute font-bold text-[12px] top-1/2 left-1/2 -translate-x-[50%] -translate-y-[50%] ",children:e==="one"?"1":e==="all"?"-":""})]}),a.jsx("button",{disabled:o.length<=1,className:x.button,onClick:u,children:a.jsx(Bj,{className:x.icon})}),a.jsx(CJ,{playStatus:l,handlePlayPause:p}),a.jsx("button",{disabled:o.length<=1,className:`${x.button}`,onClick:c,children:a.jsx(Gj,{className:x.icon})}),a.jsx("button",{disabled:o.length<=1,className:`${x.button} ${t&&"text-[--primary-cl]"}`,onClick:m,children:a.jsx(fm,{className:x.icon})})]}),a.jsxs("div",{className:`${x.progressContainer} ${n?"mb-0":"mb-5 sm:mb-2"} ${l==="error"||l==="loading"?"disable":""}`,children:[a.jsx("div",{className:"w-[44px] sm:w-9",children:a.jsx("span",{ref:s,className:"text-lg sm:text-sm",children:"0:00"})}),a.jsx(rd,{className:"h-[6px] sm:h-1",onClick:g,elelRef:r}),a.jsx("div",{className:"w-[44px] sm:w-9 text-right",children:a.jsx("span",{className:"text-lg sm:text-sm",children:i!=null&&i.song?ea((w=i.song)==null?void 0:w.duration):"0:00"})})]})]})}function NJ(){const{theme:t}=ss(),e=h.useRef(null);return h.useEffect(()=>{if(e.current){if(!t.image){e.current.style.backgroundImage="";return}e.current.style.backgroundImage=`url(${t.image})`}},[t]),{containerRef:e}}function AJ(){const t=on(),{countDown:e}=oe(Un),n=h.useRef(null),r=()=>{var i;e?t(Zt({countDown:0})):(i=n.current)==null||i.open()},s={container:"w-[54px] sm:w-[50px] flex justify-center",button:"rounded-[99px] p-[5px] hover:bg-[--a-5-cl]",itemContainer:"flex justify-between items-center min-h-[30px]",text:"text-base text-[#ccc]"};return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:s.container,children:e?a.jsx(Ys,{content:"Clear timer",children:a.jsxs("button",{className:"group flex items-center",onClick:r,children:[a.jsx("span",{className:"text-base opacity-70 sm:text-sm group-hover:hidden",children:e.toString().padStart(2,"0")}),a.jsx("span",{className:`hidden group-hover:block ${s.button}`,children:a.jsx(oo,{className:"w-8 sm:w-6"})})]})}):a.jsx(Ys,{content:"Sleep timer",children:a.jsx("button",{onClick:r,className:s.button,children:a.jsx(Uj,{className:"w-8 sm:w-6"})})})}),a.jsx(ce,{ref:n,variant:"animation",children:a.jsx(bC,{active:i=>t(Zt({countDown:i})),closeModal:()=>{var i;return(i=n.current)==null?void 0:i.close()}})})]})}function PJ(){const{audioRef:t,idle:e}=ut();if(!t.current)throw new Error("BottomPlayer !audioRef.current");const{theme:n}=ss(),{isOpenFullScreen:r,isOpenSongQueue:s,setIsOpenFullScreen:i,setIsOpenSongQueue:o}=ut(),{currentQueueId:l,currentSongData:c}=oe(We),{containerRef:u}=NJ(),{shouldHide:d}=PU({audioEle:t.current}),m=()=>{s&&o(!1),i(!0)},p={wrapper:"bottom-player hidden md:block border-[--a-5-cl] fixed bottom-0 w-full border-t transition-transform z-50 md:px-3 lg:px-6 h-[90px]",container:"flex flex-row gap-[10px] h-full items-center",controlWrapper:`flex max-w-[420px] flex-grow ${r?"max-w-[600px] flex-col-reverse pb-[10px]":"flex-col justify-center"}`,right:"w-1/4 flex items-center justify-end",blurBg:"bg-opacity-[0.8] backdrop-blur-[15px] z-[-1] absolute inset-0 bg-[--player-cl]"};return a.jsxs("div",{ref:u,className:`${p.wrapper} ${r?"border-transparent":n.image?"bg-[--player-cl]":""} ${d&&"translate-y-[100%] "} `,children:[!n.image&&a.jsx("div",{className:`${p.blurBg} ${r?"opacity-0 transition-opacity delay-[.2s]":""}`}),a.jsxs("div",{className:`${p.container} ${r?"justify-center text-white":"justify-between"} ${e&&"transition-opacity duration-[.3s] opacity-0"}`,children:[a.jsx(jJ,{song:c==null?void 0:c.song,isOpenFullScreen:r}),a.jsx("div",{className:` ${p.controlWrapper} ${Ef(l===null)}`,children:a.jsx(RJ,{})}),a.jsxs("div",{className:`${p.right}  ${r?"hidden":""}`,children:[a.jsx(IJ,{audioEle:t.current}),a.jsxs("div",{className:`flex items-center ${l?"":"disable"}`,children:[a.jsx(Ys,{content:"Fullscreen mode",children:a.jsx("button",{onClick:m,className:"rounded-[99px]  hover:bg-[--a-5-cl]  p-[5px]",children:a.jsx(_F,{className:"w-6"})})}),a.jsx(Ys,{content:"Queue",children:a.jsx("button",{onClick:()=>o(!s),className:"ml-1 hover:bg-[--a-5-cl] rounded-md p-[5px]",children:a.jsx(TM,{className:"w-6"})})}),a.jsx("div",{className:"w-[2px] h-[26px] ml-2 bg-[--a-5-cl]"}),a.jsx(AJ,{})]})]})]})]})}function FJ({isOpenFullScreen:t}){const e=h.useRef(null);return h.useEffect(()=>{const n=e.current;n&&(t?(n.style.transform="translate(0)",n.style.zIndex="99"):(n.style.transform="translate(0, 100%)",setTimeout(()=>{n.style.zIndex="-10"},500)))},[t]),{wrapperRef:e}}function MJ({imageUrl:t}){const{mobileActiveTab:e,setMobileActiveTab:n}=ut(),r=e==="Playing";return a.jsx("div",{onClick:()=>n(r?"Lyric":"Playing"),className:` ${r?"w-full h-auto px-2 sm:w-[60px] sm:h-[60px] sm:px-0":"w-[60px] h-[60px] p-0 flex-shrink-0"}`,children:a.jsx(Ce,{src:t,className:"w-full rounded-md"})})}function DJ({song:t,onClick:e,active:n}){const r={itemContainer:`border-b 
    last:border-none border-white/10 rounded-md flex p-2 ${n?"bg-white/10":""}`,imageFrame:"w-[54px] h-[54px] relative rounded-md overflow-hidden flex-shrink-0"};return a.jsx(a.Fragment,{children:a.jsxs("div",{onClick:e,className:`${r.itemContainer} `,children:[a.jsx("div",{className:`${r.imageFrame}  `,children:a.jsx(Ce,{blurHashEncode:t.blurhash_encode,src:t.image_url})}),a.jsxs("div",{className:"ml-[10px]",children:[a.jsx("p",{className:"text-lg line-clamp-1 text-sm",children:t.name}),a.jsx("p",{className:"opacity-70 line-clamp-1 text-sm",children:t.singers.map((s,i)=>a.jsxs("span",{children:[" ",(i?", ":"")+s.name]},i))})]})]})})}function LJ({}){const t=on(),{queueSongs:e,isFetching:n,currentQueueId:r}=oe(We),s=[...Array(5).keys()].map(o=>a.jsx(ge,{className:"h-[40px] mt-1"},o)),i=()=>a.jsx(a.Fragment,{children:e.map((o,l)=>a.jsx(DJ,{song:o,active:r===o.queue_id,onClick:()=>t(Is(o.queue_id))},l))});return a.jsxs(a.Fragment,{children:[i(),n&&s]})}function OJ(){const t=h.useRef(null),e=on(),{countDown:n}=oe(Un),r=()=>{var s;n?e(Zt({countDown:0})):(s=t.current)==null||s.open()};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("button",{className:Qs(!!n,"active"),onClick:r,children:n?a.jsx(Z$,{className:"w-6"}):a.jsx(Uj,{className:"w-6"})}),a.jsx("span",{children:n?n.toString().padStart(2,"")+" songs":"Timer"})]}),a.jsx(ce,{ref:t,variant:"animation",children:a.jsx(bC,{active:s=>e(Zt({countDown:s})),closeModal:()=>{var s;return(s=t.current)==null?void 0:s.close()}})})]})}function $J({song:t}){const e=h.useRef(null);return a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("button",{onClick:()=>{var n;return(n=e.current)==null?void 0:n.open()},children:a.jsx(zt,{className:"w-6"})}),a.jsx("span",{children:"Add to playlist"})]}),a.jsx(ce,{variant:"animation",ref:e,children:a.jsx(ip,{closeModal:()=>{var n;return(n=e.current)==null?void 0:n.close()},songs:[t]})})]})}function zJ({isLiked:t,song:e}){const{action:n,loading:r}=ap();return a.jsxs("div",{children:[a.jsx("button",{onClick:()=>n({variant:"like",song:e}),className:`${Qs(t,"active")}`,children:r?a.jsx(Ae,{className:"w-6 animate-spin"}):a.jsx(a.Fragment,{children:t?a.jsx(zl,{className:"w-6"}):a.jsx(Au,{className:"w-6"})})}),a.jsx("span",{children:t?"Dislike":"Like"})]})}function BJ(){const{user:t}=xe(),{currentSongData:e,queueSongs:n}=oe(We),{toggleRepeat:r,repeat:s}=gi(),i={buttonList:"flex flex-shrink-0 overflow-auto space-x-2 [&_div]:flex [&_div]:w-[70px] [&_div]:flex-col [&_div]:items-center [&_div]:space-y-1.5 [&_div]:text-center [&_button]:p-3.5 [&_button]:bg-white/10 [&_button]:rounded-full [&_button.active]:text-[#198585] [&_span]:text-xs"};if(e)return a.jsx(a.Fragment,{children:a.jsxs("div",{className:"h-[70vh] overflow-hidden text-white rounded-[16px_16px_0_0] relative p-3 flex flex-col",children:[a.jsx("div",{className:"bg-opacity-[0.8] backdrop-blur-[15px] z-[-1] bg-[#1f1f1f] absolute inset-0"}),a.jsxs("div",{className:i.buttonList,children:[a.jsxs("div",{children:[a.jsx("button",{disabled:n.length<=1,className:`${Qs(s!=="no","active")}`,onClick:r,children:a.jsx(Oj,{className:"w-6"})}),a.jsx("span",{className:"break-word",children:s==="one"?"Repeat one":s==="all"?"Repeat all":"Play once"})]}),t&&a.jsxs(a.Fragment,{children:[a.jsx($J,{song:e.song}),a.jsx(zJ,{song:e.song,isLiked:!!(t!=null&&t.liked_song_ids.includes(e.song.id))})]}),a.jsx(OJ,{})]}),a.jsx("div",{className:"flex-grow overflow-auto mt-3 border-t border-white/60 pt-3",children:e&&a.jsx(LJ,{currentIndex:e.index})})]})})}function VJ(){const{setIsOpenFullScreen:t}=ut(),{setIsOpenComment:e}=On(),n=h.useRef(null),r=h.useRef(null),s=()=>{var i;(i=r.current)==null||i.open(),e(!0)};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex space-x-1 items-center",children:[a.jsx("button",{className:"p-1.5",onClick:s,children:a.jsx(cv,{className:"w-6"})}),a.jsx("button",{className:"p-1.5",onClick:()=>{var i;return(i=n.current)==null?void 0:i.open()},children:a.jsx(V$,{className:"w-6"})}),a.jsx("button",{onClick:()=>t(!1),className:"p-1.5",children:a.jsx(Vj,{className:"w-6"})})]}),a.jsx(Mx,{ref:n,children:a.jsx(BJ,{})}),a.jsx(Mx,{onClose:()=>e(!1),ref:r,children:a.jsx(iN,{children:a.jsx(kA,{})})})]})}function UJ({handlePlayPause:t,playStatus:e}){const n={icon:"w-10"},r=()=>{switch(e){case"playing":return a.jsx(Qu,{className:`${n.icon}`});case"error":return a.jsx(kC,{className:`${n.icon}`});case"loading":case"waiting":return a.jsx(EC,{className:`${n.icon} animate-spin`});case"paused":return a.jsx(qa,{className:`${n.icon}`})}};return a.jsx(a.Fragment,{children:a.jsx("button",{className:"inline-flex items-center justify-center",onClick:()=>t(),children:r()})})}function HJ(){var l;const{timelineEleRef:t,currentTimeEleRef:e}=ut(),{playStatus:n}=oe(Un),{currentSongData:r}=oe(We),{handleSeek:s,handlePlayPause:i}=gi(),o={buttonsContainer:"w-full flex items-center justify-between space-x-2 mt-2",progressContainer:"flex w-full flex-row items-center "};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:`${o.progressContainer}  ${n==="error"||n==="loading"?"disable":""}`,children:[a.jsx("div",{className:"w-[44px] flex-shrink-0 sm:w-9",children:a.jsx("span",{ref:e,className:"text-lg sm:text-sm",children:"0:00"})}),a.jsx(rd,{onClick:s,elelRef:t,className:"h-1.5"}),a.jsx("div",{className:"w-[44px] flex-shrink-0 sm:w-9 text-right",children:a.jsx("span",{className:"text-lg sm:text-sm",children:r!=null&&r.song?ea((l=r.song)==null?void 0:l.duration):"0:00"})})]}),a.jsxs("div",{className:`${o.buttonsContainer}`,children:[a.jsx(UJ,{playStatus:n,handlePlayPause:i}),a.jsx(cp,{target:"song",children:a.jsx(VJ,{})})]})]})}function GJ(){const{isOpenFullScreen:t,playerConfig:{songBackground:e},mobileActiveTab:n}=ut(),{currentSongData:r}=oe(We),s=h.useRef(null),{wrapperRef:i}=FJ({isOpenFullScreen:t}),o={headerWrapper:"flex mb-4",container:"flex-grow flex flex-col relative overflow-hidden",control:"mt-auto",bgImage:"absolute inset-0 z-[-9] brightness-[70%] blur-[4px] translate-3d-0"};return a.jsx(a.Fragment,{children:a.jsxs("div",{ref:i,style:{transform:"translate(0, 100%)",zIndex:"-10"},className:"block md:hidden fixed inset-0 bg-zinc-900 text-white overflow-hidden transition-[transform] duration-[.3s] ease-linear",children:[e&&a.jsx("div",{className:o.bgImage,children:a.jsx(nd,{width:"100%",height:"100%",hash:(r==null?void 0:r.song.blurhash_encode)||Sw})}),a.jsx("div",{className:"h-full z-10 p-4 flex flex-col",children:a.jsxs("div",{ref:s,className:o.container,children:[a.jsxs("div",{className:`${n!="Playing"?"flex items-center":"sm:flex"}`,children:[a.jsx(MJ,{imageUrl:r==null?void 0:r.song.image_url}),a.jsxs("div",{className:`ml-2 ${n!="Playing"?"block":"hidden sm:block"}`,children:[a.jsx("p",{className:"font-playwriteCU translate-y-[-6px] leading-[2.4] line-clamp-1",children:r==null?void 0:r.song.name}),a.jsx("div",{className:"opacity-[.7] line-clamp-1 text-sm",children:r==null?void 0:r.song.singers.map((l,c)=>a.jsxs("span",{children:[" ",(c?", ":"")+l.name]},c))})]}),n==="Lyric"&&a.jsxs(Fn,{appendOnPortal:!0,children:[a.jsx(Mn,{children:a.jsx("button",{className:" p-[6px] rounded-full ml-auto  bg-white/10",children:a.jsx(dv,{className:"w-6"})})}),a.jsx(Dn,{position:"left-bottom",origin:"top right",children:a.jsx($R,{})})]})]}),a.jsx("div",{className:`mt-2 justify-between items-center ${n!="Playing"?"hidden":"flex sm:hidden"}`,children:a.jsxs("div",{className:"flex-grow",children:[a.jsx("div",{className:"h-[40px]",children:a.jsx(IA,{className:"text-xl leading-[1.5] font-playwriteCU",content:(r==null?void 0:r.song.name)||"..."})}),a.jsx("div",{className:"opacity-[.7] line-clamp-1 text-sm",children:r==null?void 0:r.song.singers.map((l,c)=>l.id?a.jsx(X,{to:`/singer/${l.id}`,children:(c?", ":"")+l.name},c):a.jsxs("span",{children:[" ",(c?", ":"")+l.name]},c))})]})}),a.jsx(wC,{children:a.jsx(qR,{isOpenLyricTabs:t&&n=="Lyric",children:a.jsx(jA,{className:`text-left ${n==="Lyric"?"flex-1 block":"hidden"}`})})}),a.jsx("div",{className:`${o.control}`,children:a.jsx(HJ,{})})]})})]})})}function WJ({audioEle:t}){const e=Zn(),n=h.useMemo(()=>e.pathname==="/",[e]),r=h.useMemo(()=>e.pathname.includes("lyric"),[e]);return h.useEffect(()=>{(n||r)&&t.pause()},[e]),{shouldHidePlayer:n,location:e,shouldHideAll:r}}function qJ({ActiveClass:t}){const{user:e}=xe(),{action:n}=id(),r=Nt(),s=h.useRef(null),i=async()=>{try{await n("login"),r("/my-music")}catch(o){console.log(o)}};return e?a.jsx(X,{className:`
                  ${t}
                `,to:"/my-music",children:a.jsxs("div",{children:[a.jsx(ex,{}),a.jsx("span",{children:"My song"})]})}):a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>{var o;return(o=s.current)==null?void 0:o.open()},className:`
                  ${t}
                `,children:a.jsxs("div",{children:[a.jsx(ex,{}),a.jsx("span",{children:"Login"})]})}),a.jsx(ce,{ref:s,variant:"animation",children:a.jsxs(_e,{children:[a.jsx(Be,{closeModal:()=>{var o;return(o=s.current)==null?void 0:o.close()},title:"Login"}),a.jsx("div",{className:"text-center my-5",children:a.jsx(se,{onClick:i,color:"primary",children:"Login with Google"})})]})})]})}function KJ(){const{isOpenFullScreen:t,setIsOpenFullScreen:e,audioRef:n}=ut();if(!n.current)return a.jsx(a.Fragment,{});const{playStatus:r}=oe(Un),{currentSongData:s}=oe(We),{handlePlayPause:i}=gi(),{shouldHideAll:o,shouldHidePlayer:l,location:c}=WJ({audioEle:n.current}),u=h.useMemo(()=>{switch(r){case"playing":return a.jsx(Qu,{className:""});case"error":return a.jsx(gm,{className:""});case"loading":case"waiting":return a.jsx(Ae,{className:" animate-spin"});case"paused":return a.jsx(qa,{className:""})}},[r]),d=p=>p?"text-[--primary-cl]":"",m={wrapper:`block  ${l?"bg-[--layout-cl]":"bg-transparent"}  md:hidden fixed bottom-0 w-full transition-transform overflow-hidden border-t border-[--a-5-cl] z-[9]`,container:"absolute inset-0 bg-[--player-cl] bg-opacity-[0.7] backdrop-blur-[15px] z-[-1]",songImageWrapper:"flex flex-row items-center flex-grow h-full",image:"w-[54px] h-[54px] flex-shrink-0",cta:"ml-2 flex-shrink-0"};return a.jsxs("div",{className:`${m.wrapper} ${o?"translate-y-[100%]":""}`,children:[a.jsx("div",{className:`${m.container} ${t?"opacity-0 transition-opacity delay-[.3s]":""}`}),a.jsxs("div",{className:`flex justify-between items-center px-4 py-3 ${l?"hidden":""}`,children:[a.jsx("div",{onClick:()=>s!=null&&s.song.name?e(!0):{},className:"mobile-current-song flex-grow",children:a.jsxs("div",{className:m.songImageWrapper,children:[a.jsx("div",{className:m.image,children:a.jsx(Ce,{src:s==null?void 0:s.song.image_url,className:"rounded-full"})}),a.jsx("div",{className:"flex-grow ml-2",children:(s==null?void 0:s.song.song_url)&&a.jsxs(a.Fragment,{children:[a.jsx("p",{className:"font-playwriteCU line-clamp-1",children:(s==null?void 0:s.song.name)||"..."}),a.jsx("p",{className:"opacity-70 text-sm line-clamp-1",children:s==null?void 0:s.song.singers.map((p,g)=>(g?", ":"")+p.name)})]})})]})}),a.jsx("div",{className:`${m.cta} ${!(s!=null&&s.song.name)&&"disable"}`,children:a.jsx("button",{className:"p-1.5 [&_svg]:w-9 text-[--primary-cl]",onClick:i,children:u})})]}),a.jsxs("div",{className:`flex items-center py-1 justify-evenly [&_div]:flex 
      [&_div]:flex-col 
      [&_div]:items-center
      [&_svg]:w-6
      [&_span]:text-[10px]
      ${l?"":"border-t border-[--a-5-cl]"}
      `,children:[a.jsx(X,{className:`
              ${d(c.pathname==="/")}
            `,to:"/",children:a.jsxs("div",{children:[a.jsx(Pu,{}),a.jsx("span",{children:"For You"})]})}),a.jsx(X,{className:`
              ${d(c.pathname==="/discover")}
            `,to:"/discover",children:a.jsxs("div",{children:[a.jsx(Wj,{}),a.jsx("span",{children:"Discover"})]})}),a.jsx(X,{className:`
              ${d(c.pathname==="/search")}
            `,to:"/search",children:a.jsxs("div",{children:[a.jsx(Fu,{}),a.jsx("span",{children:"Search"})]})}),a.jsx(qJ,{ActiveClass:d(c.pathname==="/my-music")})]})]})}function QJ(){const t=on(),{audioRef:e,firstTimeSongLoaded:n}=ut(),{playStatus:r,countDown:s}=oe(Un),{handlePlayPause:i}=gi(),o=h.useRef(0),l=()=>(console.log("song end"),rt("timer",o.current-1),t(Zt({countDown:o.current-1})));h.useEffect(()=>{const c=It().timer||0;t(Zt({countDown:c}))},[]),h.useEffect(()=>{if(!(!s||!e.current))return e.current.addEventListener("ended",l),n.current||(rt("timer",s),rt("is_timer",!0),r==="paused"&&i()),()=>{var c;(c=e.current)==null||c.removeEventListener("ended",l)}},[!!s]),h.useEffect(()=>{o.current=s},[s])}function XJ(){const{playerConfig:{repeat:t,isShuffle:e,isCrossFade:n,isEnableBeat:r},audioRef:s,firstTimeSongLoaded:i,startFadeWhenEnd:o,isPlayingNewSong:l,timelineEleRef:c,currentTimeEleRef:u,shouldSyncSongDuration:d,isOpenFullScreen:m,timeLineColorRef:p}=ut();if(!s.current)throw new Error("Use Control audioRef.current is undefined");const g=on(),{queueSongs:x,currentSongData:w,currentQueueId:v}=oe(We),{playStatus:S}=oe(Un),{currentPlaylist:_}=oe(ha),E=h.useRef(),I=h.useRef(!1),P=h.useRef(!1),F=h.useRef(!1),j=h.useRef("paused"),k=Zn(),{setErrorToast:C}=te(),{next:R,updateProgressElement:N,play:M,pause:A}=gi(),fe=h.useMemo(()=>k.pathname.includes("edit"),[k]),Le=h.useMemo(()=>It(),[]),de=ye=>x[ye],he=()=>{g(Zt({playStatus:"paused"}))},V=()=>{S!=="playing"&&(g(Zt({playStatus:"playing"})),F.current=!1)},J=()=>{c.current&&u.current&&(u.current.innerText="0:00",c.current.style.background="var-(--a-10-cl)")},Z=ye=>{const $r=It().volume||1;if(ye<=2){const Gn=ye/2*$r;s.current.volume=Gn}else if(ye<o.current){s.current.volume!=$r&&(s.current.volume=$r);return}if(ye>=o.current){const Gn=(s.current.duration-ye)/2*$r;s.current.volume=Gn}},je=()=>{const ye=s.current.currentTime;j.current!=="paused"&&g(Zt({playStatus:"playing"})),N(ye),n&&Z(ye),ye&&Math.round(ye)%3===0&&rt("current_time",Math.round(ye))},Te=()=>{if(console.log("end"),!E.current)return;const ye=It(),$r=ye.volume||1,Gn=ye.timer;if(t==="one"&&Gn&&Gn!==1)return M();if(s.current.volume=$r,P.current=!0,e){let zr=E.current.index;for(;zr===E.current.index;)zr=Math.round(Math.random()*x.length-1);const Ns=de(zr);return g(Is(Ns.queue_id))}return Gn===0&&ye.is_timer?(I.current=!0,rt("is_timer",!1)):E.current.index===x.length-1&&(t==="all"||Gn>=1?I.current=!1:I.current=!0),x.length===1?J():R()},et=()=>{E.current&&g(Zt({playStatus:"loading"}))},Er=()=>{if(!E.current)return;const ye=s.current.duration;if(o.current=ye-3,rt("current_queue_id",E.current.song.queue_id),I.current)return I.current=!1,g(Zt({playStatus:"paused"}));if((fe||i.current)&&(g(Zt({playStatus:"paused"})),i.current)){i.current=!1,d.current=!0,N(Le.current_time||0);return}M()},kr=()=>{g(Zt({playStatus:"waiting"}))},jr=()=>{if(E.current){if(F.current||(F.current=!0,C("Found internet error")),!P.current)return g(Zt({playStatus:"error"}));if(x.length>1){if(E.current.index===x.length-1){g(Zt({playStatus:"error"}));return}R()}else g(Zt({playStatus:"error"}))}};h.useEffect(()=>{const ye=Le.current_queue_id||null;ye&&x.length?g(Is(ye)):i.current=!1},[]),h.useEffect(()=>(s.current.addEventListener("error",jr),s.current.addEventListener("pause",he),s.current.addEventListener("play",V),s.current.addEventListener("loadstart",et),s.current.addEventListener("loadedmetadata",Er),s.current.addEventListener("waiting",kr),()=>{var ye,$r,Gn,zr,Ns,yo;(ye=s.current)==null||ye.removeEventListener("error",jr),($r=s.current)==null||$r.removeEventListener("pause",he),(Gn=s.current)==null||Gn.removeEventListener("play",V),(zr=s.current)==null||zr.removeEventListener("loadstart",et),(Ns=s.current)==null||Ns.removeEventListener("loadedmetadata",Er),(yo=s.current)==null||yo.addEventListener("waiting",kr)}),[]),h.useEffect(()=>{if(!w||!v){j.current="paused",A();return}return s.current.src=r&&w.song.beat_url?w.song.beat_url:w.song.song_url,E.current=w,()=>{J(),l.current=!0,d.current&&(d.current=!1)}},[w==null?void 0:w.song]),h.useEffect(()=>{if(!w){S==="paused"&&J();return}let ye=`${w.song.name}`;S==="paused"&&_&&w.song.queue_id.includes(_.id)&&(ye=`${_.name}`),document.title=ye,j.current=S},[S]),h.useEffect(()=>(s.current.addEventListener("ended",Te),()=>{var ye;return(ye=s.current)==null?void 0:ye.removeEventListener("ended",Te)}),[t,e,v,x]),h.useEffect(()=>(s.current.addEventListener("timeupdate",je),()=>{var ye;(ye=s.current)==null||ye.removeEventListener("timeupdate",je)}),[n]),h.useEffect(()=>{fe&&S==="playing"&&A()},[fe]),h.useEffect(()=>{m?p.current="#fff":p.current="var(--primary-cl)"},[m])}function YJ(t,e){const{currentSongData:n}=oe(We),{isOpenFullScreen:r,setIdle:s}=ut(),[i,o]=h.useState(0),l=h.useRef(),c=h.useRef(),u=()=>{s(!1),o(Math.random())},d=()=>{clearTimeout(c.current),clearTimeout(l.current)},m=async()=>{if(!r)return;const p=document.querySelector(".song-thumb.active"),g=document.querySelector(".song-list-container");if(p&&g){const x=ay(p,g,!0);let w=Aw.focusDelay;x||(w=0),l.current=setTimeout(()=>{s(!0)},w)}};if(h.useEffect(()=>{if(!(e||!n)){if(!r){s(!1);return}return setTimeout(()=>{window.addEventListener("mousemove",u),window.dispatchEvent(new Event("mousemove"))},1e3),()=>{window.removeEventListener("mousemove",u),d()}}},[r]),h.useEffect(()=>(c.current=setTimeout(()=>{m()},t),()=>{d()}),[i]),!r)return!1}function JJ({audioEle:t}){const{currentSongData:e,currentQueueId:n}=oe(We),{pushRecentSong:r}=_A(),s=h.useRef(""),i=async()=>{if(!n||!(e!=null&&e.song))return;const o=e.song.id;r(e.song),e.song.is_official&&s.current!==n&&(s.current=n,oR(o))};h.useEffect(()=>(t.addEventListener("playing",i),()=>{t.removeEventListener("playing",i)}),[n])}function ZJ({children:t,audioEle:e}){const{isOnMobile:n}=ss();return XJ(),QJ(),YJ(Aw.focusDelay,n),JJ({audioEle:e}),h.useMemo(()=>t,[])}function eZ(){const{isOnMobile:t}=ss(),{audioRef:e}=ut(),[n,r]=h.useState(!1),s=e.current&&a.jsxs(a.Fragment,{children:[a.jsx(xJ,{}),a.jsx(SJ,{}),a.jsx(PJ,{})]}),i=e.current&&a.jsxs(a.Fragment,{children:[a.jsx(GJ,{}),a.jsx(KJ,{})]});return h.useEffect(()=>{r(!0)},[]),a.jsxs(a.Fragment,{children:[a.jsx("audio",{ref:e,className:"hidden"}),e.current&&a.jsx(ZJ,{audioEle:e.current,children:t?i:s})]})}function tZ({className:t}){const[e,n]=h.useState(!1),r=()=>{const i=document.querySelector(".main-container");if(!i)return;const o=i.scrollTop||0;n(o>100)},s=()=>{const i=document.querySelector(".main-container");i==null||i.scroll({behavior:"smooth",top:0})};return h.useEffect(()=>{const i=document.querySelector(".main-container");if(i)return i.addEventListener("scroll",r),()=>{i.removeEventListener("scroll",r)}},[]),a.jsx(se,{onClick:s,size:"clear",className:`absolute p-2 transition-[transform,opacity] 
         ${t||""} 
         w-[36px] 
         hover:bg-[--a-5-cl]  
      ${e?"opacity-[1]":"opacity-0 translate-y-[20px]"}`,children:a.jsx($$,{className:"w-6"})})}function nZ(){const{user:t,loading:e}=xe(),n=Zn(),r=Nt(),s=()=>{r("/dashboard")},i=[...Array(4).keys()].map(c=>a.jsxs("div",{className:"h-[55px] lg:h-[55px] w-full ske",children:[a.jsx(ge,{className:"w-6 h-6 flex-shrink-0"}),a.jsx(ge,{className:"w-[60px] h-[22px] md:h-[14px] md:mt-[2px] lg:h-[16px] lg:w-[70px]"})]},c)),o=c=>c?"text-[--primary-cl]":"",l={container:"w-[80px] lg:w-[160px] relative flex-shrink-0 h-screen bg-[--sidebar-collapse-cl] lg:bg-[--sidebar-cl] ",linkList:`
      hover:[&_div:not(.ske)]:bg-[--a-5-cl]
      [&_div]:py-1.5
      [&_div]:leading-[2.2] 
      [&_div]:flex 
      [&_div]:flex-col 
      [&_div]:items-center
      [&_span]:text-xs
      [&_span]:mt-[2px]
      [&_span]:font-semibold

      lg:[&_div]:py-2
      lg:[&_div]:pl-4
      lg:[&_span]:mt-0
      lg:[&_div]:space-x-2 
      lg:[&_div]:px-3
      lg:[&_div]:flex-row 
      lg:[&_div]:items-center
      [&_svg]:w-6
      [&_a]:w-full
      lg:[&_span]:text-[14px]
      lg:[&_span]:inline-block
      `};return a.jsxs("div",{className:`${l.container}`,children:[a.jsx("div",{className:"px-[10px] h-[80px] flex items-center justify-center",children:a.jsx(X,{to:"/",className:"bg-white dark:bg-[--layout-cl] w-12 flex h-12 rounded-full justify-center items-center",children:a.jsx("span",{className:"text-[--primary-cl] text-xl font-bold translate-y-[1px]",children:":D"})})}),a.jsxs("div",{className:`flex flex-col items-start ${l.linkList}`,children:[e&&i,!e&&a.jsxs(a.Fragment,{children:[a.jsx(X,{className:`
              ${o(n.pathname==="/")}
            `,to:"/",children:a.jsxs("div",{children:[a.jsx(Pu,{}),a.jsx("span",{children:"For You"})]})}),a.jsx(X,{className:`
              ${o(n.pathname.includes("/discover"))}
            `,to:"/discover",children:a.jsxs("div",{children:[a.jsx(Wj,{}),a.jsx("span",{children:"Discover"})]})}),a.jsx(X,{className:`
              ${o(n.pathname.includes("/category"))}
            `,to:"/category",children:a.jsxs("div",{children:[a.jsx(xm,{}),a.jsx("span",{children:"Category"})]})}),a.jsx(X,{className:`
              ${o(n.pathname.includes("/trending"))}
            `,to:"/trending",children:a.jsxs("div",{children:[a.jsx(fm,{}),a.jsx("span",{children:"Trending"})]})}),t&&a.jsxs(a.Fragment,{children:[a.jsx(X,{className:`
                  ${o(n.pathname.includes("/my-music"))}`,to:"/my-music",children:a.jsxs("div",{children:[a.jsx(oa,{}),a.jsx("span",{children:"My Song"})]})}),t.role==="ADMIN"&&a.jsx(X,{to:"/dashboard",className:"border-transparent",children:a.jsxs("div",{onClick:s,children:[a.jsx(mm,{}),a.jsx("span",{className:"",children:"Dashboard"})]})})]})]})]}),a.jsx(tZ,{className:"left-[50%] translate-x-[-50%] bottom-[80px] md:bottom-[100px]"})]})}function rZ({contentRef:t}){const[e,n]=h.useState(0),[r,s]=bw(ai),[i,o]=h.useState(""),l=h.useRef(null),c=h.useRef(null),u=h.useRef(null),{action:d}=id(),m=E=>{var I,P;o(E),(I=u.current)==null||I.toggle(),(P=l.current)==null||P.close()},p=()=>{var E;return(E=u.current)==null?void 0:E.close()},g=async()=>{var E;try{await d("logout")}catch(I){console.log("signOut error",{message:I})}finally{(E=u.current)==null||E.toggle()}},x=async()=>{var E;try{(E=c.current)==null||E.close(),await d("login")}catch(I){console.log({message:I})}},w=()=>{var I;const E=((I=t.current)==null?void 0:I.scrollTop)||0;n(E)},v=a.jsx(ge,{className:"h-[40px] w-[40px] rounded-full"}),S=h.useMemo(()=>{switch(i){case"":return a.jsx(a.Fragment,{});case"theme":return a.jsx(SC,{closeModal:p});case"info":return a.jsx(Jj,{closeModal:p});case"confirm":return a.jsx(qt,{closeModal:p,callback:g,loading:!1,label:"Sign out ?"})}},[i]);h.useEffect(()=>{var E;return(E=t.current)==null||E.addEventListener("scroll",w),()=>{document.removeEventListener("scroll",w)}},[]);const _={userName:"text-[16px] font-[500] ml-[8px] line-clamp-1",button:"h-[40px] w-[40px] rounded-full hover:bg-[--a-5-cl]",icon:"w-5 mr-1",divide:"h-[1px]  w-[calc(100%-20px)] mb-[10px] mt-[20px] mx-auto bg-[--a-5-cl]"};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:`h-[60px] fixed top-0 right-0  left-[80px] lg:left-[160px] z-[20] bg-transparent  ${e?"shadow-lg":""}`,children:[a.jsx("div",{className:`${e?"":"hidden "} absolute inset-0 bg-[--player-cl] bg-opacity-[0.8] backdrop-blur-[15px] z-[-1] `}),a.jsxs("div",{className:"px-[40px] items-center flex h-full",children:[a.jsx(bA,{className:"mr-5"}),a.jsx(wN,{}),a.jsxs("div",{className:"flex space-x-3 ml-auto",children:[a.jsxs(Fn,{children:[a.jsx(Mn,{ref:l,children:a.jsx(Ys,{isWrapped:!0,position:"top-[calc(100%+8px)]",content:"Settings",children:a.jsx("button",{className:`flex px-[6px] items-center ${_.button} `,children:a.jsx(iv,{className:"w-full"})})})}),a.jsx(Dn,{className:"top-[calc(100%+8px)] right-0",animationClassName:"origin-top-right",children:a.jsx(lV,{openModal:m,variant:"client"})})]}),a.jsxs(Fn,{children:[a.jsx(Mn,{ref:c,className:"flex items-center",children:a.jsx("button",{className:"flex hover:brightness-90",children:s?v:a.jsx(Fx,{className:"w-[40px] h-[40px]"})})}),a.jsx(Dn,{className:"top-[calc(100%+8px)] right-0",animationClassName:"origin-top-right",children:a.jsxs(er,{className:"w-[250px] px-3",children:[r&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center p-[10px] pb-0",children:[a.jsx(Fx,{className:"login-trigger w-[46px] h-[46px]"}),a.jsx("div",{className:"ml-[12px]",children:a.jsx("h5",{className:"font-semibold line-clamp-1",children:r==null?void 0:r.displayName})})]}),a.jsx("div",{className:_.divide})]}),a.jsxs(Or,{className:"[&_button]:rounded-md",children:[r&&a.jsxs("button",{onClick:()=>m("confirm"),children:[a.jsx(ov,{className:_.icon}),"Log out"]}),!r&&a.jsxs("button",{onClick:x,children:[a.jsx(D4,{className:_.icon}),"Log in"]})]})]})})]})]})]})]}),a.jsx(ce,{variant:"animation",ref:u,children:S})]})}function sZ(){const{setErrorToast:t,setSuccessToast:e}=te(),{user:n,setUser:r}=xe(),{uploadedSongs:s,setUploadedSongs:i,shouldFetchFavoriteSongs:o}=it(),{setIsUploading:l,isUploading:c,setUploadingSongs:u,resetUploadContext:d}=xC(),[m,p]=h.useState(""),g=h.useRef(null),x=()=>{const v=g.current;v&&(v.value=""),d()},w=async v=>{try{if(!n)return;const S=[],_=[],E=v.target.files;if(!E.length)return;const I=[],P=[],F=Date.now(),j=N=>s.some(M=>M.size===N.size)||I.some(M=>M.size===N.size);for(let N=0;N<=E.length-1;N++){const M=E[N],A=await JN(M);if(!A)continue;const fe={name:A.singer,created_at:""},Le={...Hx(fe),id:""},de={name:A.name,singers:[Le],duration:Math.floor(A.duration),size:Math.floor(M.size/1024)},he=A.image?new Blob([A.image]):null;he&&(_.push(he),de.image_url=URL.createObjectURL(he));const V=Vx({...de,owner_email:n.email,distributor:n.display_name});if(j(V)){console.log(">>>duplicate");continue}I.push(V),S.push(N)}if(s.length+S.length>20)throw p("You have reach the upload limit"),new Error("Limit");if(!I.length)return;u(I),l(!0);for(let N=0;N<S.length;N++){const M=S[N],A=_[N],fe={...I[N]},{fileId:Le,url:de}=await ed({file:E[M],folder:"/songs/",msg:">>> api: upload song file"});if(A){const Z=await pi({blob:A});Object.assign(fe,Z)}Object.assign(fe,{song_file_id:Le,song_url:de});const he=await Ts({collectionName:"Songs",data:fe,msg:">>> api: set song doc"}),V=await _l(he);P.push(V.id);const J={...V.data(),id:he.id,queue_id:po(4)};i(Z=>[...Z,J]),u(Z=>{const je=[...Z];return je.shift,je})}const C={liked_song_ids:[...P,...n.liked_song_ids]};await Se({collectionName:"Users",data:C,id:n.email}),r({...n,...C}),o.current=!0,e(`${I.length} songs uploaded`);const R=Date.now()}catch(S){console.log({message:S}),t(m)}finally{x()}};return h.useEffect(()=>{if(!c)return;const v=document.querySelector(".temp-song");v&&v.scrollIntoView({behavior:"smooth",block:"center"})},[c]),{handleInputChange:w,inputRef:g}}function iZ(){const{handleInputChange:t,inputRef:e}=sZ(),n={container:"upload portal fixed z-[199] bottom-[120px] right-[30px] max-[549px]:bottom-[unset] max-[540px]:top-[10px] max-[540px]:right-[10px]"};return a.jsx(a.Fragment,{children:so.createPortal(a.jsx("div",{className:n.container,children:a.jsx("input",{ref:e,onChange:t,type:"file",multiple:!0,accept:"audio",id:"song_upload",className:"hidden"})}),document.getElementById("portals"))})}function aZ({children:t}){const{theme:e,isOnMobile:n}=ss(),{isOpenFullScreen:r}=ut(),s=h.useRef(null),i={page:"md:flex md:h-screen bg-[--layout-cl] text-[--text-cl] transition-[color]",container:"main-container pt-5 overflow-x-hidden md:pt-0 md:h-full md:w-full md:flex md:flex-col px-[10px] md:px-[40px] md:pt-[60px] md:overflow-auto "};return h.useEffect(()=>{const o=document.querySelector(".my-tag"),l=document.querySelector("body");l&&(l.setAttribute("data-theme",e.id),e.type==="dark"?l.classList.add("dark"):l.classList.remove("dark"),r?l.classList.add("full-screen"):l.classList.remove("full-screen"),n&&(l.style.backgroundColor="var(--layout-cl)")),o&&o.setAttribute("content",e.container)},[e]),h.useEffect(()=>{const o=document.querySelector("body");o&&(r?o.classList.add("full-screen"):o.classList.remove("full-screen"))},[r]),a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:`${i.page}`,children:[!n&&a.jsx(nZ,{}),a.jsxs("div",{ref:s,className:`${i.container}`,children:[!n&&a.jsx(rZ,{contentRef:s}),t]}),a.jsx(eZ,{})]}),a.jsx(EA,{className:"left-[50%] translate-x-[-50%] top-[10px] md:top-[unset] md:bottom-[100px] md:left-[20px] md:translate-x-0"}),a.jsx(iZ,{}),!n&&a.jsx(mC,{})]})}function oZ(){return a.jsx(N$,{children:a.jsx(pC,{children:a.jsx(aZ,{children:a.jsx(hm,{})})})})}function t0({children:t}){return t}function lZ(){return a.jsx(a.Fragment,{children:a.jsx(k4,{children:a.jsxs(y4,{children:[a.jsx(fs,{path:"*",element:a.jsx(qG,{})}),a.jsx(fs,{path:"/login",element:a.jsx(QG,{})}),a.jsxs(fs,{element:a.jsx(oZ,{}),children:[YY.map((t,e)=>{const n=t.layout||t0,r=t.component;return a.jsx(fs,{path:t.path,element:a.jsx(n,{children:a.jsx(r,{})})},e)}),a.jsx(fs,{element:a.jsx(eJ,{}),children:JY.map((t,e)=>{const n=t.layout||t0,r=t.component;return a.jsx(fs,{path:t.path,element:a.jsx(n,{children:a.jsx(r,{})})},e)})})]}),a.jsx(fs,{element:a.jsx(tJ,{}),children:a.jsx(fs,{element:a.jsx(oJ,{}),children:ZY.map((t,e)=>{const n=t.layout||t0,r=t.component;return a.jsx(fs,{path:t.path,element:a.jsx(n,{children:a.jsx(r,{})})},e)})})})]})})})}const cZ=sU({reducer:{currentPlaylist:CU,playStatus:bU,songQueue:wU},middleware:t=>t({serializableCheck:!1})});function uZ(){const{setUser:t,setLoading:e,loading:n,user:r}=xe(),s=h.useRef(!1),i=async()=>{ai.onAuthStateChanged(async o=>{if(o&&o.email){const l=await Wt({collectionName:"Users",id:o.email,msg:"usePersistAuth, get user"}),c=l.data(),u={email:o.email,display_name:o.displayName,photo_url:o.photoURL,liked_song_ids:(c==null?void 0:c.liked_song_ids)||[],recent_playlist_ids:(c==null?void 0:c.recent_playlist_ids)||[],recent_song_ids:(c==null?void 0:c.recent_song_ids)||[],liked_singer_ids:(c==null?void 0:c.liked_singer_ids)||[],role:(c==null?void 0:c.role)||"USER",liked_playlist_ids:(c==null?void 0:c.liked_playlist_ids)||[],liked_comment_ids:It().liked_comment_ids||[],last_seen:""};l.exists()?Se({collectionName:"Users",id:u.email,data:{last_seen:mt()},msg:"usePersistAuth, update user doc"}):await Tx(st(ie,"Users",u.email),u),t(u)}else t(null);e(!1)})};return h.useEffect(()=>{s.current||(s.current=!0,i())},[]),{user:r,loading:n}}function dZ({children:t}){return uZ(),t}n0.createRoot(document.getElementById("root")).render(a.jsx(b2.StrictMode,{children:a.jsx(CV,{store:cZ,children:a.jsx(eD,{children:a.jsx(w$,{children:a.jsx(rD,{children:a.jsx(S$,{children:a.jsx(T$,{children:a.jsx(E$,{children:a.jsx(dZ,{children:a.jsx(lZ,{})})})})})})})})})}));
