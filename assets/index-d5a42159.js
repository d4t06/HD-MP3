function fP(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function ck(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var uk={exports:{}},_f={},dk={exports:{}},he={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var au=Symbol.for("react.element"),mP=Symbol.for("react.portal"),pP=Symbol.for("react.fragment"),gP=Symbol.for("react.strict_mode"),yP=Symbol.for("react.profiler"),xP=Symbol.for("react.provider"),vP=Symbol.for("react.context"),wP=Symbol.for("react.forward_ref"),_P=Symbol.for("react.suspense"),SP=Symbol.for("react.memo"),EP=Symbol.for("react.lazy"),$1=Symbol.iterator;function bP(t){return t===null||typeof t!="object"?null:(t=$1&&t[$1]||t["@@iterator"],typeof t=="function"?t:null)}var hk={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},fk=Object.assign,mk={};function Jo(t,e,n){this.props=t,this.context=e,this.refs=mk,this.updater=n||hk}Jo.prototype.isReactComponent={};Jo.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Jo.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function pk(){}pk.prototype=Jo.prototype;function rx(t,e,n){this.props=t,this.context=e,this.refs=mk,this.updater=n||hk}var sx=rx.prototype=new pk;sx.constructor=rx;fk(sx,Jo.prototype);sx.isPureReactComponent=!0;var z1=Array.isArray,gk=Object.prototype.hasOwnProperty,ix={current:null},yk={key:!0,ref:!0,__self:!0,__source:!0};function xk(t,e,n){var r,s={},i=null,a=null;if(e!=null)for(r in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(i=""+e.key),e)gk.call(e,r)&&!yk.hasOwnProperty(r)&&(s[r]=e[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:au,type:t,key:i,ref:a,props:s,_owner:ix.current}}function kP(t,e){return{$$typeof:au,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function ax(t){return typeof t=="object"&&t!==null&&t.$$typeof===au}function TP(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var B1=/\/+/g;function wp(t,e){return typeof t=="object"&&t!==null&&t.key!=null?TP(""+t.key):e.toString(36)}function Pd(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case au:case mP:a=!0}}if(a)return a=t,s=s(a),t=r===""?"."+wp(a,0):r,z1(s)?(n="",t!=null&&(n=t.replace(B1,"$&/")+"/"),Pd(s,e,n,"",function(u){return u})):s!=null&&(ax(s)&&(s=kP(s,n+(!s.key||a&&a.key===s.key?"":(""+s.key).replace(B1,"$&/")+"/")+t)),e.push(s)),1;if(a=0,r=r===""?".":r+":",z1(t))for(var l=0;l<t.length;l++){i=t[l];var c=r+wp(i,l);a+=Pd(i,e,n,c,s)}else if(c=bP(t),typeof c=="function")for(t=c.call(t),l=0;!(i=t.next()).done;)i=i.value,c=r+wp(i,l++),a+=Pd(i,e,n,c,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function Ku(t,e,n){if(t==null)return t;var r=[],s=0;return Pd(t,r,"","",function(i){return e.call(n,i,s++)}),r}function IP(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var fn={current:null},Fd={transition:null},CP={ReactCurrentDispatcher:fn,ReactCurrentBatchConfig:Fd,ReactCurrentOwner:ix};he.Children={map:Ku,forEach:function(t,e,n){Ku(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Ku(t,function(){e++}),e},toArray:function(t){return Ku(t,function(e){return e})||[]},only:function(t){if(!ax(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};he.Component=Jo;he.Fragment=pP;he.Profiler=yP;he.PureComponent=rx;he.StrictMode=gP;he.Suspense=_P;he.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=CP;he.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=fk({},t.props),s=t.key,i=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,a=ix.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)gk.call(e,c)&&!yk.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:au,type:t.type,key:s,ref:i,props:r,_owner:a}};he.createContext=function(t){return t={$$typeof:vP,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:xP,_context:t},t.Consumer=t};he.createElement=xk;he.createFactory=function(t){var e=xk.bind(null,t);return e.type=t,e};he.createRef=function(){return{current:null}};he.forwardRef=function(t){return{$$typeof:wP,render:t}};he.isValidElement=ax;he.lazy=function(t){return{$$typeof:EP,_payload:{_status:-1,_result:t},_init:IP}};he.memo=function(t,e){return{$$typeof:SP,type:t,compare:e===void 0?null:e}};he.startTransition=function(t){var e=Fd.transition;Fd.transition={};try{t()}finally{Fd.transition=e}};he.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};he.useCallback=function(t,e){return fn.current.useCallback(t,e)};he.useContext=function(t){return fn.current.useContext(t)};he.useDebugValue=function(){};he.useDeferredValue=function(t){return fn.current.useDeferredValue(t)};he.useEffect=function(t,e){return fn.current.useEffect(t,e)};he.useId=function(){return fn.current.useId()};he.useImperativeHandle=function(t,e,n){return fn.current.useImperativeHandle(t,e,n)};he.useInsertionEffect=function(t,e){return fn.current.useInsertionEffect(t,e)};he.useLayoutEffect=function(t,e){return fn.current.useLayoutEffect(t,e)};he.useMemo=function(t,e){return fn.current.useMemo(t,e)};he.useReducer=function(t,e,n){return fn.current.useReducer(t,e,n)};he.useRef=function(t){return fn.current.useRef(t)};he.useState=function(t){return fn.current.useState(t)};he.useSyncExternalStore=function(t,e,n){return fn.current.useSyncExternalStore(t,e,n)};he.useTransition=function(){return fn.current.useTransition()};he.version="18.2.0";dk.exports=he;var f=dk.exports;const vk=ck(f),RP=fP({__proto__:null,default:vk},[f]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var AP=f,jP=Symbol.for("react.element"),NP=Symbol.for("react.fragment"),PP=Object.prototype.hasOwnProperty,FP=AP.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,DP={key:!0,ref:!0,__self:!0,__source:!0};function wk(t,e,n){var r,s={},i=null,a=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(a=e.ref);for(r in e)PP.call(e,r)&&!DP.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:jP,type:t,key:i,ref:a,props:s,_owner:FP.current}}_f.Fragment=NP;_f.jsx=wk;_f.jsxs=wk;uk.exports=_f;var o=uk.exports;var Qg={},_k={exports:{}},Hn={},Sk={exports:{}},Ek={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(F,W){var q=F.length;F.push(W);e:for(;0<q;){var ue=q-1>>>1,Fe=F[ue];if(0<s(Fe,W))F[ue]=W,F[q]=Fe,q=ue;else break e}}function n(F){return F.length===0?null:F[0]}function r(F){if(F.length===0)return null;var W=F[0],q=F.pop();if(q!==W){F[0]=q;e:for(var ue=0,Fe=F.length,Ha=Fe>>>1;ue<Ha;){var hs=2*(ue+1)-1,Sl=F[hs],gr=hs+1,Wa=F[gr];if(0>s(Sl,q))gr<Fe&&0>s(Wa,Sl)?(F[ue]=Wa,F[gr]=q,ue=gr):(F[ue]=Sl,F[hs]=q,ue=hs);else if(gr<Fe&&0>s(Wa,q))F[ue]=Wa,F[gr]=q,ue=gr;else break e}}return W}function s(F,W){var q=F.sortIndex-W.sortIndex;return q!==0?q:F.id-W.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var c=[],u=[],d=1,h=null,m=3,p=!1,g=!1,y=!1,_=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(F){for(var W=n(u);W!==null;){if(W.callback===null)r(u);else if(W.startTime<=F)r(u),W.sortIndex=W.expirationTime,e(c,W);else break;W=n(u)}}function S(F){if(y=!1,v(F),!g)if(n(c)!==null)g=!0,me(E);else{var W=n(u);W!==null&&Ge(S,W.startTime-F)}}function E(F,W){g=!1,y&&(y=!1,w(A),A=-1),p=!0;var q=m;try{for(v(W),h=n(c);h!==null&&(!(h.expirationTime>W)||F&&!ce());){var ue=h.callback;if(typeof ue=="function"){h.callback=null,m=h.priorityLevel;var Fe=ue(h.expirationTime<=W);W=t.unstable_now(),typeof Fe=="function"?h.callback=Fe:h===n(c)&&r(c),v(W)}else r(c);h=n(c)}if(h!==null)var Ha=!0;else{var hs=n(u);hs!==null&&Ge(S,hs.startTime-W),Ha=!1}return Ha}finally{h=null,m=q,p=!1}}var b=!1,I=null,A=-1,L=5,P=-1;function ce(){return!(t.unstable_now()-P<L)}function K(){if(I!==null){var F=t.unstable_now();P=F;var W=!0;try{W=I(!0,F)}finally{W?Pe():(b=!1,I=null)}}else b=!1}var Pe;if(typeof x=="function")Pe=function(){x(K)};else if(typeof MessageChannel<"u"){var ie=new MessageChannel,ke=ie.port2;ie.port1.onmessage=K,Pe=function(){ke.postMessage(null)}}else Pe=function(){_(K,0)};function me(F){I=F,b||(b=!0,Pe())}function Ge(F,W){A=_(function(){F(t.unstable_now())},W)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(F){F.callback=null},t.unstable_continueExecution=function(){g||p||(g=!0,me(E))},t.unstable_forceFrameRate=function(F){0>F||125<F?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):L=0<F?Math.floor(1e3/F):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(F){switch(m){case 1:case 2:case 3:var W=3;break;default:W=m}var q=m;m=W;try{return F()}finally{m=q}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(F,W){switch(F){case 1:case 2:case 3:case 4:case 5:break;default:F=3}var q=m;m=F;try{return W()}finally{m=q}},t.unstable_scheduleCallback=function(F,W,q){var ue=t.unstable_now();switch(typeof q=="object"&&q!==null?(q=q.delay,q=typeof q=="number"&&0<q?ue+q:ue):q=ue,F){case 1:var Fe=-1;break;case 2:Fe=250;break;case 5:Fe=1073741823;break;case 4:Fe=1e4;break;default:Fe=5e3}return Fe=q+Fe,F={id:d++,callback:W,priorityLevel:F,startTime:q,expirationTime:Fe,sortIndex:-1},q>ue?(F.sortIndex=q,e(u,F),n(c)===null&&F===n(u)&&(y?(w(A),A=-1):y=!0,Ge(S,q-ue))):(F.sortIndex=Fe,e(c,F),g||p||(g=!0,me(E))),F},t.unstable_shouldYield=ce,t.unstable_wrapCallback=function(F){var W=m;return function(){var q=m;m=W;try{return F.apply(this,arguments)}finally{m=q}}}})(Ek);Sk.exports=Ek;var OP=Sk.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bk=f,Bn=OP;function j(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var kk=new Set,dc={};function ja(t,e){Ao(t,e),Ao(t+"Capture",e)}function Ao(t,e){for(dc[t]=e,t=0;t<e.length;t++)kk.add(e[t])}var Cs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Kg=Object.prototype.hasOwnProperty,MP=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,U1={},V1={};function LP(t){return Kg.call(V1,t)?!0:Kg.call(U1,t)?!1:MP.test(t)?V1[t]=!0:(U1[t]=!0,!1)}function $P(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function zP(t,e,n,r){if(e===null||typeof e>"u"||$P(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function mn(t,e,n,r,s,i,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=a}var Ot={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Ot[t]=new mn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Ot[e]=new mn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Ot[t]=new mn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Ot[t]=new mn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Ot[t]=new mn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Ot[t]=new mn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Ot[t]=new mn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Ot[t]=new mn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Ot[t]=new mn(t,5,!1,t.toLowerCase(),null,!1,!1)});var ox=/[\-:]([a-z])/g;function lx(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(ox,lx);Ot[e]=new mn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(ox,lx);Ot[e]=new mn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(ox,lx);Ot[e]=new mn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Ot[t]=new mn(t,1,!1,t.toLowerCase(),null,!1,!1)});Ot.xlinkHref=new mn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Ot[t]=new mn(t,1,!1,t.toLowerCase(),null,!0,!0)});function cx(t,e,n,r){var s=Ot.hasOwnProperty(e)?Ot[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(zP(e,n,s,r)&&(n=null),r||s===null?LP(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var $s=bk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Xu=Symbol.for("react.element"),eo=Symbol.for("react.portal"),to=Symbol.for("react.fragment"),ux=Symbol.for("react.strict_mode"),Xg=Symbol.for("react.profiler"),Tk=Symbol.for("react.provider"),Ik=Symbol.for("react.context"),dx=Symbol.for("react.forward_ref"),Yg=Symbol.for("react.suspense"),Jg=Symbol.for("react.suspense_list"),hx=Symbol.for("react.memo"),Ks=Symbol.for("react.lazy"),Ck=Symbol.for("react.offscreen"),H1=Symbol.iterator;function El(t){return t===null||typeof t!="object"?null:(t=H1&&t[H1]||t["@@iterator"],typeof t=="function"?t:null)}var Ye=Object.assign,_p;function Ll(t){if(_p===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);_p=e&&e[1]||""}return`
`+_p+t}var Sp=!1;function Ep(t,e){if(!t||Sp)return"";Sp=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),i=r.stack.split(`
`),a=s.length-1,l=i.length-1;1<=a&&0<=l&&s[a]!==i[l];)l--;for(;1<=a&&0<=l;a--,l--)if(s[a]!==i[l]){if(a!==1||l!==1)do if(a--,l--,0>l||s[a]!==i[l]){var c=`
`+s[a].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=a&&0<=l);break}}}finally{Sp=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Ll(t):""}function BP(t){switch(t.tag){case 5:return Ll(t.type);case 16:return Ll("Lazy");case 13:return Ll("Suspense");case 19:return Ll("SuspenseList");case 0:case 2:case 15:return t=Ep(t.type,!1),t;case 11:return t=Ep(t.type.render,!1),t;case 1:return t=Ep(t.type,!0),t;default:return""}}function Zg(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case to:return"Fragment";case eo:return"Portal";case Xg:return"Profiler";case ux:return"StrictMode";case Yg:return"Suspense";case Jg:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Ik:return(t.displayName||"Context")+".Consumer";case Tk:return(t._context.displayName||"Context")+".Provider";case dx:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case hx:return e=t.displayName||null,e!==null?e:Zg(t.type)||"Memo";case Ks:e=t._payload,t=t._init;try{return Zg(t(e))}catch{}}return null}function UP(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Zg(e);case 8:return e===ux?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ei(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Rk(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function VP(t){var e=Rk(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(a){r=""+a,i.call(this,a)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Yu(t){t._valueTracker||(t._valueTracker=VP(t))}function Ak(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=Rk(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function sh(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function e0(t,e){var n=e.checked;return Ye({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function W1(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Ei(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function jk(t,e){e=e.checked,e!=null&&cx(t,"checked",e,!1)}function t0(t,e){jk(t,e);var n=Ei(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?n0(t,e.type,n):e.hasOwnProperty("defaultValue")&&n0(t,e.type,Ei(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function q1(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function n0(t,e,n){(e!=="number"||sh(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var $l=Array.isArray;function go(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Ei(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function r0(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(j(91));return Ye({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function G1(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(j(92));if($l(n)){if(1<n.length)throw Error(j(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Ei(n)}}function Nk(t,e){var n=Ei(e.value),r=Ei(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Q1(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Pk(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function s0(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Pk(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Ju,Fk=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Ju=Ju||document.createElement("div"),Ju.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Ju.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function hc(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Kl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},HP=["Webkit","ms","Moz","O"];Object.keys(Kl).forEach(function(t){HP.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Kl[e]=Kl[t]})});function Dk(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Kl.hasOwnProperty(t)&&Kl[t]?(""+e).trim():e+"px"}function Ok(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=Dk(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var WP=Ye({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function i0(t,e){if(e){if(WP[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(j(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(j(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(j(61))}if(e.style!=null&&typeof e.style!="object")throw Error(j(62))}}function a0(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var o0=null;function fx(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var l0=null,yo=null,xo=null;function K1(t){if(t=cu(t)){if(typeof l0!="function")throw Error(j(280));var e=t.stateNode;e&&(e=Tf(e),l0(t.stateNode,t.type,e))}}function Mk(t){yo?xo?xo.push(t):xo=[t]:yo=t}function Lk(){if(yo){var t=yo,e=xo;if(xo=yo=null,K1(t),e)for(t=0;t<e.length;t++)K1(e[t])}}function $k(t,e){return t(e)}function zk(){}var bp=!1;function Bk(t,e,n){if(bp)return t(e,n);bp=!0;try{return $k(t,e,n)}finally{bp=!1,(yo!==null||xo!==null)&&(zk(),Lk())}}function fc(t,e){var n=t.stateNode;if(n===null)return null;var r=Tf(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(j(231,e,typeof n));return n}var c0=!1;if(Cs)try{var bl={};Object.defineProperty(bl,"passive",{get:function(){c0=!0}}),window.addEventListener("test",bl,bl),window.removeEventListener("test",bl,bl)}catch{c0=!1}function qP(t,e,n,r,s,i,a,l,c){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(d){this.onError(d)}}var Xl=!1,ih=null,ah=!1,u0=null,GP={onError:function(t){Xl=!0,ih=t}};function QP(t,e,n,r,s,i,a,l,c){Xl=!1,ih=null,qP.apply(GP,arguments)}function KP(t,e,n,r,s,i,a,l,c){if(QP.apply(this,arguments),Xl){if(Xl){var u=ih;Xl=!1,ih=null}else throw Error(j(198));ah||(ah=!0,u0=u)}}function Na(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Uk(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function X1(t){if(Na(t)!==t)throw Error(j(188))}function XP(t){var e=t.alternate;if(!e){if(e=Na(t),e===null)throw Error(j(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return X1(s),t;if(i===r)return X1(s),e;i=i.sibling}throw Error(j(188))}if(n.return!==r.return)n=s,r=i;else{for(var a=!1,l=s.child;l;){if(l===n){a=!0,n=s,r=i;break}if(l===r){a=!0,r=s,n=i;break}l=l.sibling}if(!a){for(l=i.child;l;){if(l===n){a=!0,n=i,r=s;break}if(l===r){a=!0,r=i,n=s;break}l=l.sibling}if(!a)throw Error(j(189))}}if(n.alternate!==r)throw Error(j(190))}if(n.tag!==3)throw Error(j(188));return n.stateNode.current===n?t:e}function Vk(t){return t=XP(t),t!==null?Hk(t):null}function Hk(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Hk(t);if(e!==null)return e;t=t.sibling}return null}var Wk=Bn.unstable_scheduleCallback,Y1=Bn.unstable_cancelCallback,YP=Bn.unstable_shouldYield,JP=Bn.unstable_requestPaint,ot=Bn.unstable_now,ZP=Bn.unstable_getCurrentPriorityLevel,mx=Bn.unstable_ImmediatePriority,qk=Bn.unstable_UserBlockingPriority,oh=Bn.unstable_NormalPriority,e5=Bn.unstable_LowPriority,Gk=Bn.unstable_IdlePriority,Sf=null,Gr=null;function t5(t){if(Gr&&typeof Gr.onCommitFiberRoot=="function")try{Gr.onCommitFiberRoot(Sf,t,void 0,(t.current.flags&128)===128)}catch{}}var Tr=Math.clz32?Math.clz32:s5,n5=Math.log,r5=Math.LN2;function s5(t){return t>>>=0,t===0?32:31-(n5(t)/r5|0)|0}var Zu=64,ed=4194304;function zl(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function lh(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,a=n&268435455;if(a!==0){var l=a&~s;l!==0?r=zl(l):(i&=a,i!==0&&(r=zl(i)))}else a=n&~s,a!==0?r=zl(a):i!==0&&(r=zl(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Tr(e),s=1<<n,r|=t[n],e&=~s;return r}function i5(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function a5(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var a=31-Tr(i),l=1<<a,c=s[a];c===-1?(!(l&n)||l&r)&&(s[a]=i5(l,e)):c<=e&&(t.expiredLanes|=l),i&=~l}}function d0(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Qk(){var t=Zu;return Zu<<=1,!(Zu&4194240)&&(Zu=64),t}function kp(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function ou(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Tr(e),t[e]=n}function o5(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-Tr(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function px(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Tr(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var Ce=0;function Kk(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Xk,gx,Yk,Jk,Zk,h0=!1,td=[],ci=null,ui=null,di=null,mc=new Map,pc=new Map,Ys=[],l5="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function J1(t,e){switch(t){case"focusin":case"focusout":ci=null;break;case"dragenter":case"dragleave":ui=null;break;case"mouseover":case"mouseout":di=null;break;case"pointerover":case"pointerout":mc.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":pc.delete(e.pointerId)}}function kl(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=cu(e),e!==null&&gx(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function c5(t,e,n,r,s){switch(e){case"focusin":return ci=kl(ci,t,e,n,r,s),!0;case"dragenter":return ui=kl(ui,t,e,n,r,s),!0;case"mouseover":return di=kl(di,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return mc.set(i,kl(mc.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,pc.set(i,kl(pc.get(i)||null,t,e,n,r,s)),!0}return!1}function e2(t){var e=na(t.target);if(e!==null){var n=Na(e);if(n!==null){if(e=n.tag,e===13){if(e=Uk(n),e!==null){t.blockedOn=e,Zk(t.priority,function(){Yk(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Dd(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=f0(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);o0=r,n.target.dispatchEvent(r),o0=null}else return e=cu(n),e!==null&&gx(e),t.blockedOn=n,!1;e.shift()}return!0}function Z1(t,e,n){Dd(t)&&n.delete(e)}function u5(){h0=!1,ci!==null&&Dd(ci)&&(ci=null),ui!==null&&Dd(ui)&&(ui=null),di!==null&&Dd(di)&&(di=null),mc.forEach(Z1),pc.forEach(Z1)}function Tl(t,e){t.blockedOn===e&&(t.blockedOn=null,h0||(h0=!0,Bn.unstable_scheduleCallback(Bn.unstable_NormalPriority,u5)))}function gc(t){function e(s){return Tl(s,t)}if(0<td.length){Tl(td[0],t);for(var n=1;n<td.length;n++){var r=td[n];r.blockedOn===t&&(r.blockedOn=null)}}for(ci!==null&&Tl(ci,t),ui!==null&&Tl(ui,t),di!==null&&Tl(di,t),mc.forEach(e),pc.forEach(e),n=0;n<Ys.length;n++)r=Ys[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Ys.length&&(n=Ys[0],n.blockedOn===null);)e2(n),n.blockedOn===null&&Ys.shift()}var vo=$s.ReactCurrentBatchConfig,ch=!0;function d5(t,e,n,r){var s=Ce,i=vo.transition;vo.transition=null;try{Ce=1,yx(t,e,n,r)}finally{Ce=s,vo.transition=i}}function h5(t,e,n,r){var s=Ce,i=vo.transition;vo.transition=null;try{Ce=4,yx(t,e,n,r)}finally{Ce=s,vo.transition=i}}function yx(t,e,n,r){if(ch){var s=f0(t,e,n,r);if(s===null)Dp(t,e,r,uh,n),J1(t,r);else if(c5(s,t,e,n,r))r.stopPropagation();else if(J1(t,r),e&4&&-1<l5.indexOf(t)){for(;s!==null;){var i=cu(s);if(i!==null&&Xk(i),i=f0(t,e,n,r),i===null&&Dp(t,e,r,uh,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else Dp(t,e,r,null,n)}}var uh=null;function f0(t,e,n,r){if(uh=null,t=fx(r),t=na(t),t!==null)if(e=Na(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Uk(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return uh=t,null}function t2(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ZP()){case mx:return 1;case qk:return 4;case oh:case e5:return 16;case Gk:return 536870912;default:return 16}default:return 16}}var ii=null,xx=null,Od=null;function n2(){if(Od)return Od;var t,e=xx,n=e.length,r,s="value"in ii?ii.value:ii.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var a=n-t;for(r=1;r<=a&&e[n-r]===s[i-r];r++);return Od=s.slice(t,1<r?1-r:void 0)}function Md(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function nd(){return!0}function e_(){return!1}function Wn(t){function e(n,r,s,i,a){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?nd:e_,this.isPropagationStopped=e_,this}return Ye(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=nd)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=nd)},persist:function(){},isPersistent:nd}),e}var Zo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},vx=Wn(Zo),lu=Ye({},Zo,{view:0,detail:0}),f5=Wn(lu),Tp,Ip,Il,Ef=Ye({},lu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:wx,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Il&&(Il&&t.type==="mousemove"?(Tp=t.screenX-Il.screenX,Ip=t.screenY-Il.screenY):Ip=Tp=0,Il=t),Tp)},movementY:function(t){return"movementY"in t?t.movementY:Ip}}),t_=Wn(Ef),m5=Ye({},Ef,{dataTransfer:0}),p5=Wn(m5),g5=Ye({},lu,{relatedTarget:0}),Cp=Wn(g5),y5=Ye({},Zo,{animationName:0,elapsedTime:0,pseudoElement:0}),x5=Wn(y5),v5=Ye({},Zo,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),w5=Wn(v5),_5=Ye({},Zo,{data:0}),n_=Wn(_5),S5={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},E5={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},b5={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function k5(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=b5[t])?!!e[t]:!1}function wx(){return k5}var T5=Ye({},lu,{key:function(t){if(t.key){var e=S5[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Md(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?E5[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:wx,charCode:function(t){return t.type==="keypress"?Md(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Md(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),I5=Wn(T5),C5=Ye({},Ef,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),r_=Wn(C5),R5=Ye({},lu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:wx}),A5=Wn(R5),j5=Ye({},Zo,{propertyName:0,elapsedTime:0,pseudoElement:0}),N5=Wn(j5),P5=Ye({},Ef,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),F5=Wn(P5),D5=[9,13,27,32],_x=Cs&&"CompositionEvent"in window,Yl=null;Cs&&"documentMode"in document&&(Yl=document.documentMode);var O5=Cs&&"TextEvent"in window&&!Yl,r2=Cs&&(!_x||Yl&&8<Yl&&11>=Yl),s_=String.fromCharCode(32),i_=!1;function s2(t,e){switch(t){case"keyup":return D5.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function i2(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var no=!1;function M5(t,e){switch(t){case"compositionend":return i2(e);case"keypress":return e.which!==32?null:(i_=!0,s_);case"textInput":return t=e.data,t===s_&&i_?null:t;default:return null}}function L5(t,e){if(no)return t==="compositionend"||!_x&&s2(t,e)?(t=n2(),Od=xx=ii=null,no=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return r2&&e.locale!=="ko"?null:e.data;default:return null}}var $5={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function a_(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!$5[t.type]:e==="textarea"}function a2(t,e,n,r){Mk(r),e=dh(e,"onChange"),0<e.length&&(n=new vx("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Jl=null,yc=null;function z5(t){y2(t,0)}function bf(t){var e=io(t);if(Ak(e))return t}function B5(t,e){if(t==="change")return e}var o2=!1;if(Cs){var Rp;if(Cs){var Ap="oninput"in document;if(!Ap){var o_=document.createElement("div");o_.setAttribute("oninput","return;"),Ap=typeof o_.oninput=="function"}Rp=Ap}else Rp=!1;o2=Rp&&(!document.documentMode||9<document.documentMode)}function l_(){Jl&&(Jl.detachEvent("onpropertychange",l2),yc=Jl=null)}function l2(t){if(t.propertyName==="value"&&bf(yc)){var e=[];a2(e,yc,t,fx(t)),Bk(z5,e)}}function U5(t,e,n){t==="focusin"?(l_(),Jl=e,yc=n,Jl.attachEvent("onpropertychange",l2)):t==="focusout"&&l_()}function V5(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return bf(yc)}function H5(t,e){if(t==="click")return bf(e)}function W5(t,e){if(t==="input"||t==="change")return bf(e)}function q5(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Cr=typeof Object.is=="function"?Object.is:q5;function xc(t,e){if(Cr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Kg.call(e,s)||!Cr(t[s],e[s]))return!1}return!0}function c_(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function u_(t,e){var n=c_(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=c_(n)}}function c2(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?c2(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function u2(){for(var t=window,e=sh();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=sh(t.document)}return e}function Sx(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function G5(t){var e=u2(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&c2(n.ownerDocument.documentElement,n)){if(r!==null&&Sx(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=u_(n,i);var a=u_(n,r);s&&a&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Q5=Cs&&"documentMode"in document&&11>=document.documentMode,ro=null,m0=null,Zl=null,p0=!1;function d_(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;p0||ro==null||ro!==sh(r)||(r=ro,"selectionStart"in r&&Sx(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Zl&&xc(Zl,r)||(Zl=r,r=dh(m0,"onSelect"),0<r.length&&(e=new vx("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=ro)))}function rd(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var so={animationend:rd("Animation","AnimationEnd"),animationiteration:rd("Animation","AnimationIteration"),animationstart:rd("Animation","AnimationStart"),transitionend:rd("Transition","TransitionEnd")},jp={},d2={};Cs&&(d2=document.createElement("div").style,"AnimationEvent"in window||(delete so.animationend.animation,delete so.animationiteration.animation,delete so.animationstart.animation),"TransitionEvent"in window||delete so.transitionend.transition);function kf(t){if(jp[t])return jp[t];if(!so[t])return t;var e=so[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in d2)return jp[t]=e[n];return t}var h2=kf("animationend"),f2=kf("animationiteration"),m2=kf("animationstart"),p2=kf("transitionend"),g2=new Map,h_="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Pi(t,e){g2.set(t,e),ja(e,[t])}for(var Np=0;Np<h_.length;Np++){var Pp=h_[Np],K5=Pp.toLowerCase(),X5=Pp[0].toUpperCase()+Pp.slice(1);Pi(K5,"on"+X5)}Pi(h2,"onAnimationEnd");Pi(f2,"onAnimationIteration");Pi(m2,"onAnimationStart");Pi("dblclick","onDoubleClick");Pi("focusin","onFocus");Pi("focusout","onBlur");Pi(p2,"onTransitionEnd");Ao("onMouseEnter",["mouseout","mouseover"]);Ao("onMouseLeave",["mouseout","mouseover"]);Ao("onPointerEnter",["pointerout","pointerover"]);Ao("onPointerLeave",["pointerout","pointerover"]);ja("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ja("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ja("onBeforeInput",["compositionend","keypress","textInput","paste"]);ja("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ja("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ja("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Bl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Y5=new Set("cancel close invalid load scroll toggle".split(" ").concat(Bl));function f_(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,KP(r,e,void 0,t),t.currentTarget=null}function y2(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var a=r.length-1;0<=a;a--){var l=r[a],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==i&&s.isPropagationStopped())break e;f_(s,l,u),i=c}else for(a=0;a<r.length;a++){if(l=r[a],c=l.instance,u=l.currentTarget,l=l.listener,c!==i&&s.isPropagationStopped())break e;f_(s,l,u),i=c}}}if(ah)throw t=u0,ah=!1,u0=null,t}function Le(t,e){var n=e[w0];n===void 0&&(n=e[w0]=new Set);var r=t+"__bubble";n.has(r)||(x2(e,t,2,!1),n.add(r))}function Fp(t,e,n){var r=0;e&&(r|=4),x2(n,t,r,e)}var sd="_reactListening"+Math.random().toString(36).slice(2);function vc(t){if(!t[sd]){t[sd]=!0,kk.forEach(function(n){n!=="selectionchange"&&(Y5.has(n)||Fp(n,!1,t),Fp(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[sd]||(e[sd]=!0,Fp("selectionchange",!1,e))}}function x2(t,e,n,r){switch(t2(e)){case 1:var s=d5;break;case 4:s=h5;break;default:s=yx}n=s.bind(null,e,n,t),s=void 0,!c0||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function Dp(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(a===4)for(a=r.return;a!==null;){var c=a.tag;if((c===3||c===4)&&(c=a.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;a=a.return}for(;l!==null;){if(a=na(l),a===null)return;if(c=a.tag,c===5||c===6){r=i=a;continue e}l=l.parentNode}}r=r.return}Bk(function(){var u=i,d=fx(n),h=[];e:{var m=g2.get(t);if(m!==void 0){var p=vx,g=t;switch(t){case"keypress":if(Md(n)===0)break e;case"keydown":case"keyup":p=I5;break;case"focusin":g="focus",p=Cp;break;case"focusout":g="blur",p=Cp;break;case"beforeblur":case"afterblur":p=Cp;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=t_;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=p5;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=A5;break;case h2:case f2:case m2:p=x5;break;case p2:p=N5;break;case"scroll":p=f5;break;case"wheel":p=F5;break;case"copy":case"cut":case"paste":p=w5;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=r_}var y=(e&4)!==0,_=!y&&t==="scroll",w=y?m!==null?m+"Capture":null:m;y=[];for(var x=u,v;x!==null;){v=x;var S=v.stateNode;if(v.tag===5&&S!==null&&(v=S,w!==null&&(S=fc(x,w),S!=null&&y.push(wc(x,S,v)))),_)break;x=x.return}0<y.length&&(m=new p(m,g,null,n,d),h.push({event:m,listeners:y}))}}if(!(e&7)){e:{if(m=t==="mouseover"||t==="pointerover",p=t==="mouseout"||t==="pointerout",m&&n!==o0&&(g=n.relatedTarget||n.fromElement)&&(na(g)||g[Rs]))break e;if((p||m)&&(m=d.window===d?d:(m=d.ownerDocument)?m.defaultView||m.parentWindow:window,p?(g=n.relatedTarget||n.toElement,p=u,g=g?na(g):null,g!==null&&(_=Na(g),g!==_||g.tag!==5&&g.tag!==6)&&(g=null)):(p=null,g=u),p!==g)){if(y=t_,S="onMouseLeave",w="onMouseEnter",x="mouse",(t==="pointerout"||t==="pointerover")&&(y=r_,S="onPointerLeave",w="onPointerEnter",x="pointer"),_=p==null?m:io(p),v=g==null?m:io(g),m=new y(S,x+"leave",p,n,d),m.target=_,m.relatedTarget=v,S=null,na(d)===u&&(y=new y(w,x+"enter",g,n,d),y.target=v,y.relatedTarget=_,S=y),_=S,p&&g)t:{for(y=p,w=g,x=0,v=y;v;v=qa(v))x++;for(v=0,S=w;S;S=qa(S))v++;for(;0<x-v;)y=qa(y),x--;for(;0<v-x;)w=qa(w),v--;for(;x--;){if(y===w||w!==null&&y===w.alternate)break t;y=qa(y),w=qa(w)}y=null}else y=null;p!==null&&m_(h,m,p,y,!1),g!==null&&_!==null&&m_(h,_,g,y,!0)}}e:{if(m=u?io(u):window,p=m.nodeName&&m.nodeName.toLowerCase(),p==="select"||p==="input"&&m.type==="file")var E=B5;else if(a_(m))if(o2)E=W5;else{E=V5;var b=U5}else(p=m.nodeName)&&p.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(E=H5);if(E&&(E=E(t,u))){a2(h,E,n,d);break e}b&&b(t,m,u),t==="focusout"&&(b=m._wrapperState)&&b.controlled&&m.type==="number"&&n0(m,"number",m.value)}switch(b=u?io(u):window,t){case"focusin":(a_(b)||b.contentEditable==="true")&&(ro=b,m0=u,Zl=null);break;case"focusout":Zl=m0=ro=null;break;case"mousedown":p0=!0;break;case"contextmenu":case"mouseup":case"dragend":p0=!1,d_(h,n,d);break;case"selectionchange":if(Q5)break;case"keydown":case"keyup":d_(h,n,d)}var I;if(_x)e:{switch(t){case"compositionstart":var A="onCompositionStart";break e;case"compositionend":A="onCompositionEnd";break e;case"compositionupdate":A="onCompositionUpdate";break e}A=void 0}else no?s2(t,n)&&(A="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(A="onCompositionStart");A&&(r2&&n.locale!=="ko"&&(no||A!=="onCompositionStart"?A==="onCompositionEnd"&&no&&(I=n2()):(ii=d,xx="value"in ii?ii.value:ii.textContent,no=!0)),b=dh(u,A),0<b.length&&(A=new n_(A,t,null,n,d),h.push({event:A,listeners:b}),I?A.data=I:(I=i2(n),I!==null&&(A.data=I)))),(I=O5?M5(t,n):L5(t,n))&&(u=dh(u,"onBeforeInput"),0<u.length&&(d=new n_("onBeforeInput","beforeinput",null,n,d),h.push({event:d,listeners:u}),d.data=I))}y2(h,e)})}function wc(t,e,n){return{instance:t,listener:e,currentTarget:n}}function dh(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=fc(t,n),i!=null&&r.unshift(wc(t,i,s)),i=fc(t,e),i!=null&&r.push(wc(t,i,s))),t=t.return}return r}function qa(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function m_(t,e,n,r,s){for(var i=e._reactName,a=[];n!==null&&n!==r;){var l=n,c=l.alternate,u=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&u!==null&&(l=u,s?(c=fc(n,i),c!=null&&a.unshift(wc(n,c,l))):s||(c=fc(n,i),c!=null&&a.push(wc(n,c,l)))),n=n.return}a.length!==0&&t.push({event:e,listeners:a})}var J5=/\r\n?/g,Z5=/\u0000|\uFFFD/g;function p_(t){return(typeof t=="string"?t:""+t).replace(J5,`
`).replace(Z5,"")}function id(t,e,n){if(e=p_(e),p_(t)!==e&&n)throw Error(j(425))}function hh(){}var g0=null,y0=null;function x0(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var v0=typeof setTimeout=="function"?setTimeout:void 0,e4=typeof clearTimeout=="function"?clearTimeout:void 0,g_=typeof Promise=="function"?Promise:void 0,t4=typeof queueMicrotask=="function"?queueMicrotask:typeof g_<"u"?function(t){return g_.resolve(null).then(t).catch(n4)}:v0;function n4(t){setTimeout(function(){throw t})}function Op(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),gc(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);gc(e)}function hi(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function y_(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var el=Math.random().toString(36).slice(2),$r="__reactFiber$"+el,_c="__reactProps$"+el,Rs="__reactContainer$"+el,w0="__reactEvents$"+el,r4="__reactListeners$"+el,s4="__reactHandles$"+el;function na(t){var e=t[$r];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Rs]||n[$r]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=y_(t);t!==null;){if(n=t[$r])return n;t=y_(t)}return e}t=n,n=t.parentNode}return null}function cu(t){return t=t[$r]||t[Rs],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function io(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(j(33))}function Tf(t){return t[_c]||null}var _0=[],ao=-1;function Fi(t){return{current:t}}function Be(t){0>ao||(t.current=_0[ao],_0[ao]=null,ao--)}function Me(t,e){ao++,_0[ao]=t.current,t.current=e}var bi={},Zt=Fi(bi),wn=Fi(!1),ma=bi;function jo(t,e){var n=t.type.contextTypes;if(!n)return bi;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function _n(t){return t=t.childContextTypes,t!=null}function fh(){Be(wn),Be(Zt)}function x_(t,e,n){if(Zt.current!==bi)throw Error(j(168));Me(Zt,e),Me(wn,n)}function v2(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(j(108,UP(t)||"Unknown",s));return Ye({},n,r)}function mh(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||bi,ma=Zt.current,Me(Zt,t),Me(wn,wn.current),!0}function v_(t,e,n){var r=t.stateNode;if(!r)throw Error(j(169));n?(t=v2(t,e,ma),r.__reactInternalMemoizedMergedChildContext=t,Be(wn),Be(Zt),Me(Zt,t)):Be(wn),Me(wn,n)}var gs=null,If=!1,Mp=!1;function w2(t){gs===null?gs=[t]:gs.push(t)}function i4(t){If=!0,w2(t)}function Di(){if(!Mp&&gs!==null){Mp=!0;var t=0,e=Ce;try{var n=gs;for(Ce=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}gs=null,If=!1}catch(s){throw gs!==null&&(gs=gs.slice(t+1)),Wk(mx,Di),s}finally{Ce=e,Mp=!1}}return null}var oo=[],lo=0,ph=null,gh=0,tr=[],nr=0,pa=null,xs=1,vs="";function Xi(t,e){oo[lo++]=gh,oo[lo++]=ph,ph=t,gh=e}function _2(t,e,n){tr[nr++]=xs,tr[nr++]=vs,tr[nr++]=pa,pa=t;var r=xs;t=vs;var s=32-Tr(r)-1;r&=~(1<<s),n+=1;var i=32-Tr(e)+s;if(30<i){var a=s-s%5;i=(r&(1<<a)-1).toString(32),r>>=a,s-=a,xs=1<<32-Tr(e)+s|n<<s|r,vs=i+t}else xs=1<<i|n<<s|r,vs=t}function Ex(t){t.return!==null&&(Xi(t,1),_2(t,1,0))}function bx(t){for(;t===ph;)ph=oo[--lo],oo[lo]=null,gh=oo[--lo],oo[lo]=null;for(;t===pa;)pa=tr[--nr],tr[nr]=null,vs=tr[--nr],tr[nr]=null,xs=tr[--nr],tr[nr]=null}var Ln=null,Fn=null,We=!1,Sr=null;function S2(t,e){var n=sr(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function w_(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Ln=t,Fn=hi(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Ln=t,Fn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=pa!==null?{id:xs,overflow:vs}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=sr(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Ln=t,Fn=null,!0):!1;default:return!1}}function S0(t){return(t.mode&1)!==0&&(t.flags&128)===0}function E0(t){if(We){var e=Fn;if(e){var n=e;if(!w_(t,e)){if(S0(t))throw Error(j(418));e=hi(n.nextSibling);var r=Ln;e&&w_(t,e)?S2(r,n):(t.flags=t.flags&-4097|2,We=!1,Ln=t)}}else{if(S0(t))throw Error(j(418));t.flags=t.flags&-4097|2,We=!1,Ln=t}}}function __(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Ln=t}function ad(t){if(t!==Ln)return!1;if(!We)return __(t),We=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!x0(t.type,t.memoizedProps)),e&&(e=Fn)){if(S0(t))throw E2(),Error(j(418));for(;e;)S2(t,e),e=hi(e.nextSibling)}if(__(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(j(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Fn=hi(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Fn=null}}else Fn=Ln?hi(t.stateNode.nextSibling):null;return!0}function E2(){for(var t=Fn;t;)t=hi(t.nextSibling)}function No(){Fn=Ln=null,We=!1}function kx(t){Sr===null?Sr=[t]:Sr.push(t)}var a4=$s.ReactCurrentBatchConfig;function wr(t,e){if(t&&t.defaultProps){e=Ye({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var yh=Fi(null),xh=null,co=null,Tx=null;function Ix(){Tx=co=xh=null}function Cx(t){var e=yh.current;Be(yh),t._currentValue=e}function b0(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function wo(t,e){xh=t,Tx=co=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(vn=!0),t.firstContext=null)}function or(t){var e=t._currentValue;if(Tx!==t)if(t={context:t,memoizedValue:e,next:null},co===null){if(xh===null)throw Error(j(308));co=t,xh.dependencies={lanes:0,firstContext:t}}else co=co.next=t;return e}var ra=null;function Rx(t){ra===null?ra=[t]:ra.push(t)}function b2(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,Rx(e)):(n.next=s.next,s.next=n),e.interleaved=n,As(t,r)}function As(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Xs=!1;function Ax(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function k2(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function bs(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function fi(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,ve&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,As(t,n)}return s=r.interleaved,s===null?(e.next=e,Rx(r)):(e.next=s.next,s.next=e),r.interleaved=e,As(t,n)}function Ld(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,px(t,n)}}function S_(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=a:i=i.next=a,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function vh(t,e,n,r){var s=t.updateQueue;Xs=!1;var i=s.firstBaseUpdate,a=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,u=c.next;c.next=null,a===null?i=u:a.next=u,a=c;var d=t.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==a&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(i!==null){var h=s.baseState;a=0,d=u=c=null,l=i;do{var m=l.lane,p=l.eventTime;if((r&m)===m){d!==null&&(d=d.next={eventTime:p,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var g=t,y=l;switch(m=e,p=n,y.tag){case 1:if(g=y.payload,typeof g=="function"){h=g.call(p,h,m);break e}h=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=y.payload,m=typeof g=="function"?g.call(p,h,m):g,m==null)break e;h=Ye({},h,m);break e;case 2:Xs=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,m=s.effects,m===null?s.effects=[l]:m.push(l))}else p={eventTime:p,lane:m,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=p,c=h):d=d.next=p,a|=m;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;m=l,l=m.next,m.next=null,s.lastBaseUpdate=m,s.shared.pending=null}}while(1);if(d===null&&(c=h),s.baseState=c,s.firstBaseUpdate=u,s.lastBaseUpdate=d,e=s.shared.interleaved,e!==null){s=e;do a|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);ya|=a,t.lanes=a,t.memoizedState=h}}function E_(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(j(191,s));s.call(r)}}}var T2=new bk.Component().refs;function k0(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Ye({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Cf={isMounted:function(t){return(t=t._reactInternals)?Na(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=dn(),s=pi(t),i=bs(r,s);i.payload=e,n!=null&&(i.callback=n),e=fi(t,i,s),e!==null&&(Ir(e,t,s,r),Ld(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=dn(),s=pi(t),i=bs(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=fi(t,i,s),e!==null&&(Ir(e,t,s,r),Ld(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=dn(),r=pi(t),s=bs(n,r);s.tag=2,e!=null&&(s.callback=e),e=fi(t,s,r),e!==null&&(Ir(e,t,r,n),Ld(e,t,r))}};function b_(t,e,n,r,s,i,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,a):e.prototype&&e.prototype.isPureReactComponent?!xc(n,r)||!xc(s,i):!0}function I2(t,e,n){var r=!1,s=bi,i=e.contextType;return typeof i=="object"&&i!==null?i=or(i):(s=_n(e)?ma:Zt.current,r=e.contextTypes,i=(r=r!=null)?jo(t,s):bi),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Cf,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function k_(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Cf.enqueueReplaceState(e,e.state,null)}function T0(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs=T2,Ax(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=or(i):(i=_n(e)?ma:Zt.current,s.context=jo(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(k0(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Cf.enqueueReplaceState(s,s.state,null),vh(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function Cl(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(j(309));var r=n.stateNode}if(!r)throw Error(j(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(a){var l=s.refs;l===T2&&(l=s.refs={}),a===null?delete l[i]:l[i]=a},e._stringRef=i,e)}if(typeof t!="string")throw Error(j(284));if(!n._owner)throw Error(j(290,t))}return t}function od(t,e){throw t=Object.prototype.toString.call(e),Error(j(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function T_(t){var e=t._init;return e(t._payload)}function C2(t){function e(w,x){if(t){var v=w.deletions;v===null?(w.deletions=[x],w.flags|=16):v.push(x)}}function n(w,x){if(!t)return null;for(;x!==null;)e(w,x),x=x.sibling;return null}function r(w,x){for(w=new Map;x!==null;)x.key!==null?w.set(x.key,x):w.set(x.index,x),x=x.sibling;return w}function s(w,x){return w=gi(w,x),w.index=0,w.sibling=null,w}function i(w,x,v){return w.index=v,t?(v=w.alternate,v!==null?(v=v.index,v<x?(w.flags|=2,x):v):(w.flags|=2,x)):(w.flags|=1048576,x)}function a(w){return t&&w.alternate===null&&(w.flags|=2),w}function l(w,x,v,S){return x===null||x.tag!==6?(x=Hp(v,w.mode,S),x.return=w,x):(x=s(x,v),x.return=w,x)}function c(w,x,v,S){var E=v.type;return E===to?d(w,x,v.props.children,S,v.key):x!==null&&(x.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===Ks&&T_(E)===x.type)?(S=s(x,v.props),S.ref=Cl(w,x,v),S.return=w,S):(S=Hd(v.type,v.key,v.props,null,w.mode,S),S.ref=Cl(w,x,v),S.return=w,S)}function u(w,x,v,S){return x===null||x.tag!==4||x.stateNode.containerInfo!==v.containerInfo||x.stateNode.implementation!==v.implementation?(x=Wp(v,w.mode,S),x.return=w,x):(x=s(x,v.children||[]),x.return=w,x)}function d(w,x,v,S,E){return x===null||x.tag!==7?(x=ua(v,w.mode,S,E),x.return=w,x):(x=s(x,v),x.return=w,x)}function h(w,x,v){if(typeof x=="string"&&x!==""||typeof x=="number")return x=Hp(""+x,w.mode,v),x.return=w,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Xu:return v=Hd(x.type,x.key,x.props,null,w.mode,v),v.ref=Cl(w,null,x),v.return=w,v;case eo:return x=Wp(x,w.mode,v),x.return=w,x;case Ks:var S=x._init;return h(w,S(x._payload),v)}if($l(x)||El(x))return x=ua(x,w.mode,v,null),x.return=w,x;od(w,x)}return null}function m(w,x,v,S){var E=x!==null?x.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return E!==null?null:l(w,x,""+v,S);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Xu:return v.key===E?c(w,x,v,S):null;case eo:return v.key===E?u(w,x,v,S):null;case Ks:return E=v._init,m(w,x,E(v._payload),S)}if($l(v)||El(v))return E!==null?null:d(w,x,v,S,null);od(w,v)}return null}function p(w,x,v,S,E){if(typeof S=="string"&&S!==""||typeof S=="number")return w=w.get(v)||null,l(x,w,""+S,E);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case Xu:return w=w.get(S.key===null?v:S.key)||null,c(x,w,S,E);case eo:return w=w.get(S.key===null?v:S.key)||null,u(x,w,S,E);case Ks:var b=S._init;return p(w,x,v,b(S._payload),E)}if($l(S)||El(S))return w=w.get(v)||null,d(x,w,S,E,null);od(x,S)}return null}function g(w,x,v,S){for(var E=null,b=null,I=x,A=x=0,L=null;I!==null&&A<v.length;A++){I.index>A?(L=I,I=null):L=I.sibling;var P=m(w,I,v[A],S);if(P===null){I===null&&(I=L);break}t&&I&&P.alternate===null&&e(w,I),x=i(P,x,A),b===null?E=P:b.sibling=P,b=P,I=L}if(A===v.length)return n(w,I),We&&Xi(w,A),E;if(I===null){for(;A<v.length;A++)I=h(w,v[A],S),I!==null&&(x=i(I,x,A),b===null?E=I:b.sibling=I,b=I);return We&&Xi(w,A),E}for(I=r(w,I);A<v.length;A++)L=p(I,w,A,v[A],S),L!==null&&(t&&L.alternate!==null&&I.delete(L.key===null?A:L.key),x=i(L,x,A),b===null?E=L:b.sibling=L,b=L);return t&&I.forEach(function(ce){return e(w,ce)}),We&&Xi(w,A),E}function y(w,x,v,S){var E=El(v);if(typeof E!="function")throw Error(j(150));if(v=E.call(v),v==null)throw Error(j(151));for(var b=E=null,I=x,A=x=0,L=null,P=v.next();I!==null&&!P.done;A++,P=v.next()){I.index>A?(L=I,I=null):L=I.sibling;var ce=m(w,I,P.value,S);if(ce===null){I===null&&(I=L);break}t&&I&&ce.alternate===null&&e(w,I),x=i(ce,x,A),b===null?E=ce:b.sibling=ce,b=ce,I=L}if(P.done)return n(w,I),We&&Xi(w,A),E;if(I===null){for(;!P.done;A++,P=v.next())P=h(w,P.value,S),P!==null&&(x=i(P,x,A),b===null?E=P:b.sibling=P,b=P);return We&&Xi(w,A),E}for(I=r(w,I);!P.done;A++,P=v.next())P=p(I,w,A,P.value,S),P!==null&&(t&&P.alternate!==null&&I.delete(P.key===null?A:P.key),x=i(P,x,A),b===null?E=P:b.sibling=P,b=P);return t&&I.forEach(function(K){return e(w,K)}),We&&Xi(w,A),E}function _(w,x,v,S){if(typeof v=="object"&&v!==null&&v.type===to&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case Xu:e:{for(var E=v.key,b=x;b!==null;){if(b.key===E){if(E=v.type,E===to){if(b.tag===7){n(w,b.sibling),x=s(b,v.props.children),x.return=w,w=x;break e}}else if(b.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===Ks&&T_(E)===b.type){n(w,b.sibling),x=s(b,v.props),x.ref=Cl(w,b,v),x.return=w,w=x;break e}n(w,b);break}else e(w,b);b=b.sibling}v.type===to?(x=ua(v.props.children,w.mode,S,v.key),x.return=w,w=x):(S=Hd(v.type,v.key,v.props,null,w.mode,S),S.ref=Cl(w,x,v),S.return=w,w=S)}return a(w);case eo:e:{for(b=v.key;x!==null;){if(x.key===b)if(x.tag===4&&x.stateNode.containerInfo===v.containerInfo&&x.stateNode.implementation===v.implementation){n(w,x.sibling),x=s(x,v.children||[]),x.return=w,w=x;break e}else{n(w,x);break}else e(w,x);x=x.sibling}x=Wp(v,w.mode,S),x.return=w,w=x}return a(w);case Ks:return b=v._init,_(w,x,b(v._payload),S)}if($l(v))return g(w,x,v,S);if(El(v))return y(w,x,v,S);od(w,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,x!==null&&x.tag===6?(n(w,x.sibling),x=s(x,v),x.return=w,w=x):(n(w,x),x=Hp(v,w.mode,S),x.return=w,w=x),a(w)):n(w,x)}return _}var Po=C2(!0),R2=C2(!1),uu={},Qr=Fi(uu),Sc=Fi(uu),Ec=Fi(uu);function sa(t){if(t===uu)throw Error(j(174));return t}function jx(t,e){switch(Me(Ec,e),Me(Sc,t),Me(Qr,uu),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:s0(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=s0(e,t)}Be(Qr),Me(Qr,e)}function Fo(){Be(Qr),Be(Sc),Be(Ec)}function A2(t){sa(Ec.current);var e=sa(Qr.current),n=s0(e,t.type);e!==n&&(Me(Sc,t),Me(Qr,n))}function Nx(t){Sc.current===t&&(Be(Qr),Be(Sc))}var Qe=Fi(0);function wh(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Lp=[];function Px(){for(var t=0;t<Lp.length;t++)Lp[t]._workInProgressVersionPrimary=null;Lp.length=0}var $d=$s.ReactCurrentDispatcher,$p=$s.ReactCurrentBatchConfig,ga=0,Ke=null,vt=null,bt=null,_h=!1,ec=!1,bc=0,o4=0;function zt(){throw Error(j(321))}function Fx(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Cr(t[n],e[n]))return!1;return!0}function Dx(t,e,n,r,s,i){if(ga=i,Ke=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,$d.current=t===null||t.memoizedState===null?d4:h4,t=n(r,s),ec){i=0;do{if(ec=!1,bc=0,25<=i)throw Error(j(301));i+=1,bt=vt=null,e.updateQueue=null,$d.current=f4,t=n(r,s)}while(ec)}if($d.current=Sh,e=vt!==null&&vt.next!==null,ga=0,bt=vt=Ke=null,_h=!1,e)throw Error(j(300));return t}function Ox(){var t=bc!==0;return bc=0,t}function Mr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return bt===null?Ke.memoizedState=bt=t:bt=bt.next=t,bt}function lr(){if(vt===null){var t=Ke.alternate;t=t!==null?t.memoizedState:null}else t=vt.next;var e=bt===null?Ke.memoizedState:bt.next;if(e!==null)bt=e,vt=t;else{if(t===null)throw Error(j(310));vt=t,t={memoizedState:vt.memoizedState,baseState:vt.baseState,baseQueue:vt.baseQueue,queue:vt.queue,next:null},bt===null?Ke.memoizedState=bt=t:bt=bt.next=t}return bt}function kc(t,e){return typeof e=="function"?e(t):e}function zp(t){var e=lr(),n=e.queue;if(n===null)throw Error(j(311));n.lastRenderedReducer=t;var r=vt,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var a=s.next;s.next=i.next,i.next=a}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=a=null,c=null,u=i;do{var d=u.lane;if((ga&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=h,a=r):c=c.next=h,Ke.lanes|=d,ya|=d}u=u.next}while(u!==null&&u!==i);c===null?a=r:c.next=l,Cr(r,e.memoizedState)||(vn=!0),e.memoizedState=r,e.baseState=a,e.baseQueue=c,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,Ke.lanes|=i,ya|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Bp(t){var e=lr(),n=e.queue;if(n===null)throw Error(j(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var a=s=s.next;do i=t(i,a.action),a=a.next;while(a!==s);Cr(i,e.memoizedState)||(vn=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function j2(){}function N2(t,e){var n=Ke,r=lr(),s=e(),i=!Cr(r.memoizedState,s);if(i&&(r.memoizedState=s,vn=!0),r=r.queue,Mx(D2.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||bt!==null&&bt.memoizedState.tag&1){if(n.flags|=2048,Tc(9,F2.bind(null,n,r,s,e),void 0,null),Tt===null)throw Error(j(349));ga&30||P2(n,e,s)}return s}function P2(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Ke.updateQueue,e===null?(e={lastEffect:null,stores:null},Ke.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function F2(t,e,n,r){e.value=n,e.getSnapshot=r,O2(e)&&M2(t)}function D2(t,e,n){return n(function(){O2(e)&&M2(t)})}function O2(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Cr(t,n)}catch{return!0}}function M2(t){var e=As(t,1);e!==null&&Ir(e,t,1,-1)}function I_(t){var e=Mr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:kc,lastRenderedState:t},e.queue=t,t=t.dispatch=u4.bind(null,Ke,t),[e.memoizedState,t]}function Tc(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Ke.updateQueue,e===null?(e={lastEffect:null,stores:null},Ke.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function L2(){return lr().memoizedState}function zd(t,e,n,r){var s=Mr();Ke.flags|=t,s.memoizedState=Tc(1|e,n,void 0,r===void 0?null:r)}function Rf(t,e,n,r){var s=lr();r=r===void 0?null:r;var i=void 0;if(vt!==null){var a=vt.memoizedState;if(i=a.destroy,r!==null&&Fx(r,a.deps)){s.memoizedState=Tc(e,n,i,r);return}}Ke.flags|=t,s.memoizedState=Tc(1|e,n,i,r)}function C_(t,e){return zd(8390656,8,t,e)}function Mx(t,e){return Rf(2048,8,t,e)}function $2(t,e){return Rf(4,2,t,e)}function z2(t,e){return Rf(4,4,t,e)}function B2(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function U2(t,e,n){return n=n!=null?n.concat([t]):null,Rf(4,4,B2.bind(null,e,t),n)}function Lx(){}function V2(t,e){var n=lr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Fx(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function H2(t,e){var n=lr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Fx(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function W2(t,e,n){return ga&21?(Cr(n,e)||(n=Qk(),Ke.lanes|=n,ya|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,vn=!0),t.memoizedState=n)}function l4(t,e){var n=Ce;Ce=n!==0&&4>n?n:4,t(!0);var r=$p.transition;$p.transition={};try{t(!1),e()}finally{Ce=n,$p.transition=r}}function q2(){return lr().memoizedState}function c4(t,e,n){var r=pi(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},G2(t))Q2(e,n);else if(n=b2(t,e,n,r),n!==null){var s=dn();Ir(n,t,r,s),K2(n,e,r)}}function u4(t,e,n){var r=pi(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(G2(t))Q2(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var a=e.lastRenderedState,l=i(a,n);if(s.hasEagerState=!0,s.eagerState=l,Cr(l,a)){var c=e.interleaved;c===null?(s.next=s,Rx(e)):(s.next=c.next,c.next=s),e.interleaved=s;return}}catch{}finally{}n=b2(t,e,s,r),n!==null&&(s=dn(),Ir(n,t,r,s),K2(n,e,r))}}function G2(t){var e=t.alternate;return t===Ke||e!==null&&e===Ke}function Q2(t,e){ec=_h=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function K2(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,px(t,n)}}var Sh={readContext:or,useCallback:zt,useContext:zt,useEffect:zt,useImperativeHandle:zt,useInsertionEffect:zt,useLayoutEffect:zt,useMemo:zt,useReducer:zt,useRef:zt,useState:zt,useDebugValue:zt,useDeferredValue:zt,useTransition:zt,useMutableSource:zt,useSyncExternalStore:zt,useId:zt,unstable_isNewReconciler:!1},d4={readContext:or,useCallback:function(t,e){return Mr().memoizedState=[t,e===void 0?null:e],t},useContext:or,useEffect:C_,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,zd(4194308,4,B2.bind(null,e,t),n)},useLayoutEffect:function(t,e){return zd(4194308,4,t,e)},useInsertionEffect:function(t,e){return zd(4,2,t,e)},useMemo:function(t,e){var n=Mr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Mr();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=c4.bind(null,Ke,t),[r.memoizedState,t]},useRef:function(t){var e=Mr();return t={current:t},e.memoizedState=t},useState:I_,useDebugValue:Lx,useDeferredValue:function(t){return Mr().memoizedState=t},useTransition:function(){var t=I_(!1),e=t[0];return t=l4.bind(null,t[1]),Mr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Ke,s=Mr();if(We){if(n===void 0)throw Error(j(407));n=n()}else{if(n=e(),Tt===null)throw Error(j(349));ga&30||P2(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,C_(D2.bind(null,r,i,t),[t]),r.flags|=2048,Tc(9,F2.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=Mr(),e=Tt.identifierPrefix;if(We){var n=vs,r=xs;n=(r&~(1<<32-Tr(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=bc++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=o4++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},h4={readContext:or,useCallback:V2,useContext:or,useEffect:Mx,useImperativeHandle:U2,useInsertionEffect:$2,useLayoutEffect:z2,useMemo:H2,useReducer:zp,useRef:L2,useState:function(){return zp(kc)},useDebugValue:Lx,useDeferredValue:function(t){var e=lr();return W2(e,vt.memoizedState,t)},useTransition:function(){var t=zp(kc)[0],e=lr().memoizedState;return[t,e]},useMutableSource:j2,useSyncExternalStore:N2,useId:q2,unstable_isNewReconciler:!1},f4={readContext:or,useCallback:V2,useContext:or,useEffect:Mx,useImperativeHandle:U2,useInsertionEffect:$2,useLayoutEffect:z2,useMemo:H2,useReducer:Bp,useRef:L2,useState:function(){return Bp(kc)},useDebugValue:Lx,useDeferredValue:function(t){var e=lr();return vt===null?e.memoizedState=t:W2(e,vt.memoizedState,t)},useTransition:function(){var t=Bp(kc)[0],e=lr().memoizedState;return[t,e]},useMutableSource:j2,useSyncExternalStore:N2,useId:q2,unstable_isNewReconciler:!1};function Do(t,e){try{var n="",r=e;do n+=BP(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function Up(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function I0(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var m4=typeof WeakMap=="function"?WeakMap:Map;function X2(t,e,n){n=bs(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){bh||(bh=!0,M0=r),I0(t,e)},n}function Y2(t,e,n){n=bs(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){I0(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){I0(t,e),typeof r!="function"&&(mi===null?mi=new Set([this]):mi.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),n}function R_(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new m4;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=C4.bind(null,t,e,n),e.then(t,t))}function A_(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function j_(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=bs(-1,1),e.tag=2,fi(n,e,1))),n.lanes|=1),t)}var p4=$s.ReactCurrentOwner,vn=!1;function on(t,e,n,r){e.child=t===null?R2(e,null,n,r):Po(e,t.child,n,r)}function N_(t,e,n,r,s){n=n.render;var i=e.ref;return wo(e,s),r=Dx(t,e,n,r,i,s),n=Ox(),t!==null&&!vn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,js(t,e,s)):(We&&n&&Ex(e),e.flags|=1,on(t,e,r,s),e.child)}function P_(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!qx(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,J2(t,e,i,r,s)):(t=Hd(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var a=i.memoizedProps;if(n=n.compare,n=n!==null?n:xc,n(a,r)&&t.ref===e.ref)return js(t,e,s)}return e.flags|=1,t=gi(i,r),t.ref=e.ref,t.return=e,e.child=t}function J2(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(xc(i,r)&&t.ref===e.ref)if(vn=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(vn=!0);else return e.lanes=t.lanes,js(t,e,s)}return C0(t,e,n,r,s)}function Z2(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Me(ho,Nn),Nn|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Me(ho,Nn),Nn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Me(ho,Nn),Nn|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,Me(ho,Nn),Nn|=r;return on(t,e,s,n),e.child}function eT(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function C0(t,e,n,r,s){var i=_n(n)?ma:Zt.current;return i=jo(e,i),wo(e,s),n=Dx(t,e,n,r,i,s),r=Ox(),t!==null&&!vn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,js(t,e,s)):(We&&r&&Ex(e),e.flags|=1,on(t,e,n,s),e.child)}function F_(t,e,n,r,s){if(_n(n)){var i=!0;mh(e)}else i=!1;if(wo(e,s),e.stateNode===null)Bd(t,e),I2(e,n,r),T0(e,n,r,s),r=!0;else if(t===null){var a=e.stateNode,l=e.memoizedProps;a.props=l;var c=a.context,u=n.contextType;typeof u=="object"&&u!==null?u=or(u):(u=_n(n)?ma:Zt.current,u=jo(e,u));var d=n.getDerivedStateFromProps,h=typeof d=="function"||typeof a.getSnapshotBeforeUpdate=="function";h||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==r||c!==u)&&k_(e,a,r,u),Xs=!1;var m=e.memoizedState;a.state=m,vh(e,r,a,s),c=e.memoizedState,l!==r||m!==c||wn.current||Xs?(typeof d=="function"&&(k0(e,n,d,r),c=e.memoizedState),(l=Xs||b_(e,n,l,r,m,c,u))?(h||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),a.props=r,a.state=c,a.context=u,r=l):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{a=e.stateNode,k2(t,e),l=e.memoizedProps,u=e.type===e.elementType?l:wr(e.type,l),a.props=u,h=e.pendingProps,m=a.context,c=n.contextType,typeof c=="object"&&c!==null?c=or(c):(c=_n(n)?ma:Zt.current,c=jo(e,c));var p=n.getDerivedStateFromProps;(d=typeof p=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==h||m!==c)&&k_(e,a,r,c),Xs=!1,m=e.memoizedState,a.state=m,vh(e,r,a,s);var g=e.memoizedState;l!==h||m!==g||wn.current||Xs?(typeof p=="function"&&(k0(e,n,p,r),g=e.memoizedState),(u=Xs||b_(e,n,u,r,m,g,c)||!1)?(d||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,g,c),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,g,c)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=g),a.props=r,a.state=g,a.context=c,r=u):(typeof a.componentDidUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),r=!1)}return R0(t,e,n,r,i,s)}function R0(t,e,n,r,s,i){eT(t,e);var a=(e.flags&128)!==0;if(!r&&!a)return s&&v_(e,n,!1),js(t,e,i);r=e.stateNode,p4.current=e;var l=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&a?(e.child=Po(e,t.child,null,i),e.child=Po(e,null,l,i)):on(t,e,l,i),e.memoizedState=r.state,s&&v_(e,n,!0),e.child}function tT(t){var e=t.stateNode;e.pendingContext?x_(t,e.pendingContext,e.pendingContext!==e.context):e.context&&x_(t,e.context,!1),jx(t,e.containerInfo)}function D_(t,e,n,r,s){return No(),kx(s),e.flags|=256,on(t,e,n,r),e.child}var A0={dehydrated:null,treeContext:null,retryLane:0};function j0(t){return{baseLanes:t,cachePool:null,transitions:null}}function nT(t,e,n){var r=e.pendingProps,s=Qe.current,i=!1,a=(e.flags&128)!==0,l;if((l=a)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Me(Qe,s&1),t===null)return E0(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=r.children,t=r.fallback,i?(r=e.mode,i=e.child,a={mode:"hidden",children:a},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=Nf(a,r,0,null),t=ua(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=j0(n),e.memoizedState=A0,t):$x(e,a));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return g4(t,e,a,r,l,s,n);if(i){i=r.fallback,a=e.mode,s=t.child,l=s.sibling;var c={mode:"hidden",children:r.children};return!(a&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=gi(s,c),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=gi(l,i):(i=ua(i,a,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,a=t.child.memoizedState,a=a===null?j0(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=t.childLanes&~n,e.memoizedState=A0,r}return i=t.child,t=i.sibling,r=gi(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function $x(t,e){return e=Nf({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function ld(t,e,n,r){return r!==null&&kx(r),Po(e,t.child,null,n),t=$x(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function g4(t,e,n,r,s,i,a){if(n)return e.flags&256?(e.flags&=-257,r=Up(Error(j(422))),ld(t,e,a,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=Nf({mode:"visible",children:r.children},s,0,null),i=ua(i,s,a,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Po(e,t.child,null,a),e.child.memoizedState=j0(a),e.memoizedState=A0,i);if(!(e.mode&1))return ld(t,e,a,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(j(419)),r=Up(i,r,void 0),ld(t,e,a,r)}if(l=(a&t.childLanes)!==0,vn||l){if(r=Tt,r!==null){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|a)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,As(t,s),Ir(r,t,s,-1))}return Wx(),r=Up(Error(j(421))),ld(t,e,a,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=R4.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,Fn=hi(s.nextSibling),Ln=e,We=!0,Sr=null,t!==null&&(tr[nr++]=xs,tr[nr++]=vs,tr[nr++]=pa,xs=t.id,vs=t.overflow,pa=e),e=$x(e,r.children),e.flags|=4096,e)}function O_(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),b0(t.return,e,n)}function Vp(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function rT(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(on(t,e,r.children,n),r=Qe.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&O_(t,n,e);else if(t.tag===19)O_(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Me(Qe,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&wh(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),Vp(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&wh(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}Vp(e,!0,n,null,i);break;case"together":Vp(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Bd(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function js(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),ya|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(j(153));if(e.child!==null){for(t=e.child,n=gi(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=gi(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function y4(t,e,n){switch(e.tag){case 3:tT(e),No();break;case 5:A2(e);break;case 1:_n(e.type)&&mh(e);break;case 4:jx(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Me(yh,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Me(Qe,Qe.current&1),e.flags|=128,null):n&e.child.childLanes?nT(t,e,n):(Me(Qe,Qe.current&1),t=js(t,e,n),t!==null?t.sibling:null);Me(Qe,Qe.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return rT(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Me(Qe,Qe.current),r)break;return null;case 22:case 23:return e.lanes=0,Z2(t,e,n)}return js(t,e,n)}var sT,N0,iT,aT;sT=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};N0=function(){};iT=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,sa(Qr.current);var i=null;switch(n){case"input":s=e0(t,s),r=e0(t,r),i=[];break;case"select":s=Ye({},s,{value:void 0}),r=Ye({},r,{value:void 0}),i=[];break;case"textarea":s=r0(t,s),r=r0(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=hh)}i0(n,r);var a;n=null;for(u in s)if(!r.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var l=s[u];for(a in l)l.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(dc.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in r){var c=r[u];if(l=s!=null?s[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(a in l)!l.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in c)c.hasOwnProperty(a)&&l[a]!==c[a]&&(n||(n={}),n[a]=c[a])}else n||(i||(i=[]),i.push(u,n)),n=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(dc.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&Le("scroll",t),i||l===c||(i=[])):(i=i||[]).push(u,c))}n&&(i=i||[]).push("style",n);var u=i;(e.updateQueue=u)&&(e.flags|=4)}};aT=function(t,e,n,r){n!==r&&(e.flags|=4)};function Rl(t,e){if(!We)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Bt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function x4(t,e,n){var r=e.pendingProps;switch(bx(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Bt(e),null;case 1:return _n(e.type)&&fh(),Bt(e),null;case 3:return r=e.stateNode,Fo(),Be(wn),Be(Zt),Px(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(ad(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Sr!==null&&(z0(Sr),Sr=null))),N0(t,e),Bt(e),null;case 5:Nx(e);var s=sa(Ec.current);if(n=e.type,t!==null&&e.stateNode!=null)iT(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(j(166));return Bt(e),null}if(t=sa(Qr.current),ad(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[$r]=e,r[_c]=i,t=(e.mode&1)!==0,n){case"dialog":Le("cancel",r),Le("close",r);break;case"iframe":case"object":case"embed":Le("load",r);break;case"video":case"audio":for(s=0;s<Bl.length;s++)Le(Bl[s],r);break;case"source":Le("error",r);break;case"img":case"image":case"link":Le("error",r),Le("load",r);break;case"details":Le("toggle",r);break;case"input":W1(r,i),Le("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Le("invalid",r);break;case"textarea":G1(r,i),Le("invalid",r)}i0(n,i),s=null;for(var a in i)if(i.hasOwnProperty(a)){var l=i[a];a==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&id(r.textContent,l,t),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&id(r.textContent,l,t),s=["children",""+l]):dc.hasOwnProperty(a)&&l!=null&&a==="onScroll"&&Le("scroll",r)}switch(n){case"input":Yu(r),q1(r,i,!0);break;case"textarea":Yu(r),Q1(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=hh)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{a=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Pk(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=a.createElement(n,{is:r.is}):(t=a.createElement(n),n==="select"&&(a=t,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):t=a.createElementNS(t,n),t[$r]=e,t[_c]=r,sT(t,e,!1,!1),e.stateNode=t;e:{switch(a=a0(n,r),n){case"dialog":Le("cancel",t),Le("close",t),s=r;break;case"iframe":case"object":case"embed":Le("load",t),s=r;break;case"video":case"audio":for(s=0;s<Bl.length;s++)Le(Bl[s],t);s=r;break;case"source":Le("error",t),s=r;break;case"img":case"image":case"link":Le("error",t),Le("load",t),s=r;break;case"details":Le("toggle",t),s=r;break;case"input":W1(t,r),s=e0(t,r),Le("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=Ye({},r,{value:void 0}),Le("invalid",t);break;case"textarea":G1(t,r),s=r0(t,r),Le("invalid",t);break;default:s=r}i0(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?Ok(t,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&Fk(t,c)):i==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&hc(t,c):typeof c=="number"&&hc(t,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(dc.hasOwnProperty(i)?c!=null&&i==="onScroll"&&Le("scroll",t):c!=null&&cx(t,i,c,a))}switch(n){case"input":Yu(t),q1(t,r,!1);break;case"textarea":Yu(t),Q1(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Ei(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?go(t,!!r.multiple,i,!1):r.defaultValue!=null&&go(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=hh)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Bt(e),null;case 6:if(t&&e.stateNode!=null)aT(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(j(166));if(n=sa(Ec.current),sa(Qr.current),ad(e)){if(r=e.stateNode,n=e.memoizedProps,r[$r]=e,(i=r.nodeValue!==n)&&(t=Ln,t!==null))switch(t.tag){case 3:id(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&id(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[$r]=e,e.stateNode=r}return Bt(e),null;case 13:if(Be(Qe),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(We&&Fn!==null&&e.mode&1&&!(e.flags&128))E2(),No(),e.flags|=98560,i=!1;else if(i=ad(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(j(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(j(317));i[$r]=e}else No(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Bt(e),i=!1}else Sr!==null&&(z0(Sr),Sr=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Qe.current&1?wt===0&&(wt=3):Wx())),e.updateQueue!==null&&(e.flags|=4),Bt(e),null);case 4:return Fo(),N0(t,e),t===null&&vc(e.stateNode.containerInfo),Bt(e),null;case 10:return Cx(e.type._context),Bt(e),null;case 17:return _n(e.type)&&fh(),Bt(e),null;case 19:if(Be(Qe),i=e.memoizedState,i===null)return Bt(e),null;if(r=(e.flags&128)!==0,a=i.rendering,a===null)if(r)Rl(i,!1);else{if(wt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=wh(t),a!==null){for(e.flags|=128,Rl(i,!1),r=a.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,t=a.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Me(Qe,Qe.current&1|2),e.child}t=t.sibling}i.tail!==null&&ot()>Oo&&(e.flags|=128,r=!0,Rl(i,!1),e.lanes=4194304)}else{if(!r)if(t=wh(a),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Rl(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!We)return Bt(e),null}else 2*ot()-i.renderingStartTime>Oo&&n!==1073741824&&(e.flags|=128,r=!0,Rl(i,!1),e.lanes=4194304);i.isBackwards?(a.sibling=e.child,e.child=a):(n=i.last,n!==null?n.sibling=a:e.child=a,i.last=a)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=ot(),e.sibling=null,n=Qe.current,Me(Qe,r?n&1|2:n&1),e):(Bt(e),null);case 22:case 23:return Hx(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Nn&1073741824&&(Bt(e),e.subtreeFlags&6&&(e.flags|=8192)):Bt(e),null;case 24:return null;case 25:return null}throw Error(j(156,e.tag))}function v4(t,e){switch(bx(e),e.tag){case 1:return _n(e.type)&&fh(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Fo(),Be(wn),Be(Zt),Px(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Nx(e),null;case 13:if(Be(Qe),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(j(340));No()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Be(Qe),null;case 4:return Fo(),null;case 10:return Cx(e.type._context),null;case 22:case 23:return Hx(),null;case 24:return null;default:return null}}var cd=!1,Wt=!1,w4=typeof WeakSet=="function"?WeakSet:Set,$=null;function uo(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){et(t,e,r)}else n.current=null}function P0(t,e,n){try{n()}catch(r){et(t,e,r)}}var M_=!1;function _4(t,e){if(g0=ch,t=u2(),Sx(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var a=0,l=-1,c=-1,u=0,d=0,h=t,m=null;t:for(;;){for(var p;h!==n||s!==0&&h.nodeType!==3||(l=a+s),h!==i||r!==0&&h.nodeType!==3||(c=a+r),h.nodeType===3&&(a+=h.nodeValue.length),(p=h.firstChild)!==null;)m=h,h=p;for(;;){if(h===t)break t;if(m===n&&++u===s&&(l=a),m===i&&++d===r&&(c=a),(p=h.nextSibling)!==null)break;h=m,m=h.parentNode}h=p}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(y0={focusedElem:t,selectionRange:n},ch=!1,$=e;$!==null;)if(e=$,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,$=t;else for(;$!==null;){e=$;try{var g=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var y=g.memoizedProps,_=g.memoizedState,w=e.stateNode,x=w.getSnapshotBeforeUpdate(e.elementType===e.type?y:wr(e.type,y),_);w.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var v=e.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(j(163))}}catch(S){et(e,e.return,S)}if(t=e.sibling,t!==null){t.return=e.return,$=t;break}$=e.return}return g=M_,M_=!1,g}function tc(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&P0(e,n,i)}s=s.next}while(s!==r)}}function Af(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function F0(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function oT(t){var e=t.alternate;e!==null&&(t.alternate=null,oT(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[$r],delete e[_c],delete e[w0],delete e[r4],delete e[s4])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function lT(t){return t.tag===5||t.tag===3||t.tag===4}function L_(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||lT(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function D0(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=hh));else if(r!==4&&(t=t.child,t!==null))for(D0(t,e,n),t=t.sibling;t!==null;)D0(t,e,n),t=t.sibling}function O0(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(O0(t,e,n),t=t.sibling;t!==null;)O0(t,e,n),t=t.sibling}var jt=null,_r=!1;function Ws(t,e,n){for(n=n.child;n!==null;)cT(t,e,n),n=n.sibling}function cT(t,e,n){if(Gr&&typeof Gr.onCommitFiberUnmount=="function")try{Gr.onCommitFiberUnmount(Sf,n)}catch{}switch(n.tag){case 5:Wt||uo(n,e);case 6:var r=jt,s=_r;jt=null,Ws(t,e,n),jt=r,_r=s,jt!==null&&(_r?(t=jt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):jt.removeChild(n.stateNode));break;case 18:jt!==null&&(_r?(t=jt,n=n.stateNode,t.nodeType===8?Op(t.parentNode,n):t.nodeType===1&&Op(t,n),gc(t)):Op(jt,n.stateNode));break;case 4:r=jt,s=_r,jt=n.stateNode.containerInfo,_r=!0,Ws(t,e,n),jt=r,_r=s;break;case 0:case 11:case 14:case 15:if(!Wt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&P0(n,e,a),s=s.next}while(s!==r)}Ws(t,e,n);break;case 1:if(!Wt&&(uo(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){et(n,e,l)}Ws(t,e,n);break;case 21:Ws(t,e,n);break;case 22:n.mode&1?(Wt=(r=Wt)||n.memoizedState!==null,Ws(t,e,n),Wt=r):Ws(t,e,n);break;default:Ws(t,e,n)}}function $_(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new w4),e.forEach(function(r){var s=A4.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function xr(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,a=e,l=a;e:for(;l!==null;){switch(l.tag){case 5:jt=l.stateNode,_r=!1;break e;case 3:jt=l.stateNode.containerInfo,_r=!0;break e;case 4:jt=l.stateNode.containerInfo,_r=!0;break e}l=l.return}if(jt===null)throw Error(j(160));cT(i,a,s),jt=null,_r=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(u){et(s,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)uT(e,t),e=e.sibling}function uT(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(xr(e,t),Pr(t),r&4){try{tc(3,t,t.return),Af(3,t)}catch(y){et(t,t.return,y)}try{tc(5,t,t.return)}catch(y){et(t,t.return,y)}}break;case 1:xr(e,t),Pr(t),r&512&&n!==null&&uo(n,n.return);break;case 5:if(xr(e,t),Pr(t),r&512&&n!==null&&uo(n,n.return),t.flags&32){var s=t.stateNode;try{hc(s,"")}catch(y){et(t,t.return,y)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,a=n!==null?n.memoizedProps:i,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&jk(s,i),a0(l,a);var u=a0(l,i);for(a=0;a<c.length;a+=2){var d=c[a],h=c[a+1];d==="style"?Ok(s,h):d==="dangerouslySetInnerHTML"?Fk(s,h):d==="children"?hc(s,h):cx(s,d,h,u)}switch(l){case"input":t0(s,i);break;case"textarea":Nk(s,i);break;case"select":var m=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var p=i.value;p!=null?go(s,!!i.multiple,p,!1):m!==!!i.multiple&&(i.defaultValue!=null?go(s,!!i.multiple,i.defaultValue,!0):go(s,!!i.multiple,i.multiple?[]:"",!1))}s[_c]=i}catch(y){et(t,t.return,y)}}break;case 6:if(xr(e,t),Pr(t),r&4){if(t.stateNode===null)throw Error(j(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(y){et(t,t.return,y)}}break;case 3:if(xr(e,t),Pr(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{gc(e.containerInfo)}catch(y){et(t,t.return,y)}break;case 4:xr(e,t),Pr(t);break;case 13:xr(e,t),Pr(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Ux=ot())),r&4&&$_(t);break;case 22:if(d=n!==null&&n.memoizedState!==null,t.mode&1?(Wt=(u=Wt)||d,xr(e,t),Wt=u):xr(e,t),Pr(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!d&&t.mode&1)for($=t,d=t.child;d!==null;){for(h=$=d;$!==null;){switch(m=$,p=m.child,m.tag){case 0:case 11:case 14:case 15:tc(4,m,m.return);break;case 1:uo(m,m.return);var g=m.stateNode;if(typeof g.componentWillUnmount=="function"){r=m,n=m.return;try{e=r,g.props=e.memoizedProps,g.state=e.memoizedState,g.componentWillUnmount()}catch(y){et(r,n,y)}}break;case 5:uo(m,m.return);break;case 22:if(m.memoizedState!==null){B_(h);continue}}p!==null?(p.return=m,$=p):B_(h)}d=d.sibling}e:for(d=null,h=t;;){if(h.tag===5){if(d===null){d=h;try{s=h.stateNode,u?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=h.stateNode,c=h.memoizedProps.style,a=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=Dk("display",a))}catch(y){et(t,t.return,y)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(y){et(t,t.return,y)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:xr(e,t),Pr(t),r&4&&$_(t);break;case 21:break;default:xr(e,t),Pr(t)}}function Pr(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(lT(n)){var r=n;break e}n=n.return}throw Error(j(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(hc(s,""),r.flags&=-33);var i=L_(t);O0(t,i,s);break;case 3:case 4:var a=r.stateNode.containerInfo,l=L_(t);D0(t,l,a);break;default:throw Error(j(161))}}catch(c){et(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function S4(t,e,n){$=t,dT(t)}function dT(t,e,n){for(var r=(t.mode&1)!==0;$!==null;){var s=$,i=s.child;if(s.tag===22&&r){var a=s.memoizedState!==null||cd;if(!a){var l=s.alternate,c=l!==null&&l.memoizedState!==null||Wt;l=cd;var u=Wt;if(cd=a,(Wt=c)&&!u)for($=s;$!==null;)a=$,c=a.child,a.tag===22&&a.memoizedState!==null?U_(s):c!==null?(c.return=a,$=c):U_(s);for(;i!==null;)$=i,dT(i),i=i.sibling;$=s,cd=l,Wt=u}z_(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,$=i):z_(t)}}function z_(t){for(;$!==null;){var e=$;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Wt||Af(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Wt)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:wr(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&E_(e,i,r);break;case 3:var a=e.updateQueue;if(a!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}E_(e,a,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&gc(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(j(163))}Wt||e.flags&512&&F0(e)}catch(m){et(e,e.return,m)}}if(e===t){$=null;break}if(n=e.sibling,n!==null){n.return=e.return,$=n;break}$=e.return}}function B_(t){for(;$!==null;){var e=$;if(e===t){$=null;break}var n=e.sibling;if(n!==null){n.return=e.return,$=n;break}$=e.return}}function U_(t){for(;$!==null;){var e=$;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Af(4,e)}catch(c){et(e,n,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(c){et(e,s,c)}}var i=e.return;try{F0(e)}catch(c){et(e,i,c)}break;case 5:var a=e.return;try{F0(e)}catch(c){et(e,a,c)}}}catch(c){et(e,e.return,c)}if(e===t){$=null;break}var l=e.sibling;if(l!==null){l.return=e.return,$=l;break}$=e.return}}var E4=Math.ceil,Eh=$s.ReactCurrentDispatcher,zx=$s.ReactCurrentOwner,ir=$s.ReactCurrentBatchConfig,ve=0,Tt=null,pt=null,Ft=0,Nn=0,ho=Fi(0),wt=0,Ic=null,ya=0,jf=0,Bx=0,nc=null,yn=null,Ux=0,Oo=1/0,ms=null,bh=!1,M0=null,mi=null,ud=!1,ai=null,kh=0,rc=0,L0=null,Ud=-1,Vd=0;function dn(){return ve&6?ot():Ud!==-1?Ud:Ud=ot()}function pi(t){return t.mode&1?ve&2&&Ft!==0?Ft&-Ft:a4.transition!==null?(Vd===0&&(Vd=Qk()),Vd):(t=Ce,t!==0||(t=window.event,t=t===void 0?16:t2(t.type)),t):1}function Ir(t,e,n,r){if(50<rc)throw rc=0,L0=null,Error(j(185));ou(t,n,r),(!(ve&2)||t!==Tt)&&(t===Tt&&(!(ve&2)&&(jf|=n),wt===4&&Js(t,Ft)),Sn(t,r),n===1&&ve===0&&!(e.mode&1)&&(Oo=ot()+500,If&&Di()))}function Sn(t,e){var n=t.callbackNode;a5(t,e);var r=lh(t,t===Tt?Ft:0);if(r===0)n!==null&&Y1(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Y1(n),e===1)t.tag===0?i4(V_.bind(null,t)):w2(V_.bind(null,t)),t4(function(){!(ve&6)&&Di()}),n=null;else{switch(Kk(r)){case 1:n=mx;break;case 4:n=qk;break;case 16:n=oh;break;case 536870912:n=Gk;break;default:n=oh}n=vT(n,hT.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function hT(t,e){if(Ud=-1,Vd=0,ve&6)throw Error(j(327));var n=t.callbackNode;if(_o()&&t.callbackNode!==n)return null;var r=lh(t,t===Tt?Ft:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Th(t,r);else{e=r;var s=ve;ve|=2;var i=mT();(Tt!==t||Ft!==e)&&(ms=null,Oo=ot()+500,ca(t,e));do try{T4();break}catch(l){fT(t,l)}while(1);Ix(),Eh.current=i,ve=s,pt!==null?e=0:(Tt=null,Ft=0,e=wt)}if(e!==0){if(e===2&&(s=d0(t),s!==0&&(r=s,e=$0(t,s))),e===1)throw n=Ic,ca(t,0),Js(t,r),Sn(t,ot()),n;if(e===6)Js(t,r);else{if(s=t.current.alternate,!(r&30)&&!b4(s)&&(e=Th(t,r),e===2&&(i=d0(t),i!==0&&(r=i,e=$0(t,i))),e===1))throw n=Ic,ca(t,0),Js(t,r),Sn(t,ot()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(j(345));case 2:Yi(t,yn,ms);break;case 3:if(Js(t,r),(r&130023424)===r&&(e=Ux+500-ot(),10<e)){if(lh(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){dn(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=v0(Yi.bind(null,t,yn,ms),e);break}Yi(t,yn,ms);break;case 4:if(Js(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var a=31-Tr(r);i=1<<a,a=e[a],a>s&&(s=a),r&=~i}if(r=s,r=ot()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*E4(r/1960))-r,10<r){t.timeoutHandle=v0(Yi.bind(null,t,yn,ms),r);break}Yi(t,yn,ms);break;case 5:Yi(t,yn,ms);break;default:throw Error(j(329))}}}return Sn(t,ot()),t.callbackNode===n?hT.bind(null,t):null}function $0(t,e){var n=nc;return t.current.memoizedState.isDehydrated&&(ca(t,e).flags|=256),t=Th(t,e),t!==2&&(e=yn,yn=n,e!==null&&z0(e)),t}function z0(t){yn===null?yn=t:yn.push.apply(yn,t)}function b4(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!Cr(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Js(t,e){for(e&=~Bx,e&=~jf,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Tr(e),r=1<<n;t[n]=-1,e&=~r}}function V_(t){if(ve&6)throw Error(j(327));_o();var e=lh(t,0);if(!(e&1))return Sn(t,ot()),null;var n=Th(t,e);if(t.tag!==0&&n===2){var r=d0(t);r!==0&&(e=r,n=$0(t,r))}if(n===1)throw n=Ic,ca(t,0),Js(t,e),Sn(t,ot()),n;if(n===6)throw Error(j(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Yi(t,yn,ms),Sn(t,ot()),null}function Vx(t,e){var n=ve;ve|=1;try{return t(e)}finally{ve=n,ve===0&&(Oo=ot()+500,If&&Di())}}function xa(t){ai!==null&&ai.tag===0&&!(ve&6)&&_o();var e=ve;ve|=1;var n=ir.transition,r=Ce;try{if(ir.transition=null,Ce=1,t)return t()}finally{Ce=r,ir.transition=n,ve=e,!(ve&6)&&Di()}}function Hx(){Nn=ho.current,Be(ho)}function ca(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,e4(n)),pt!==null)for(n=pt.return;n!==null;){var r=n;switch(bx(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&fh();break;case 3:Fo(),Be(wn),Be(Zt),Px();break;case 5:Nx(r);break;case 4:Fo();break;case 13:Be(Qe);break;case 19:Be(Qe);break;case 10:Cx(r.type._context);break;case 22:case 23:Hx()}n=n.return}if(Tt=t,pt=t=gi(t.current,null),Ft=Nn=e,wt=0,Ic=null,Bx=jf=ya=0,yn=nc=null,ra!==null){for(e=0;e<ra.length;e++)if(n=ra[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var a=i.next;i.next=s,r.next=a}n.pending=r}ra=null}return t}function fT(t,e){do{var n=pt;try{if(Ix(),$d.current=Sh,_h){for(var r=Ke.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}_h=!1}if(ga=0,bt=vt=Ke=null,ec=!1,bc=0,zx.current=null,n===null||n.return===null){wt=1,Ic=e,pt=null;break}e:{var i=t,a=n.return,l=n,c=e;if(e=Ft,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=l,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var m=d.alternate;m?(d.updateQueue=m.updateQueue,d.memoizedState=m.memoizedState,d.lanes=m.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=A_(a);if(p!==null){p.flags&=-257,j_(p,a,l,i,e),p.mode&1&&R_(i,u,e),e=p,c=u;var g=e.updateQueue;if(g===null){var y=new Set;y.add(c),e.updateQueue=y}else g.add(c);break e}else{if(!(e&1)){R_(i,u,e),Wx();break e}c=Error(j(426))}}else if(We&&l.mode&1){var _=A_(a);if(_!==null){!(_.flags&65536)&&(_.flags|=256),j_(_,a,l,i,e),kx(Do(c,l));break e}}i=c=Do(c,l),wt!==4&&(wt=2),nc===null?nc=[i]:nc.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var w=X2(i,c,e);S_(i,w);break e;case 1:l=c;var x=i.type,v=i.stateNode;if(!(i.flags&128)&&(typeof x.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(mi===null||!mi.has(v)))){i.flags|=65536,e&=-e,i.lanes|=e;var S=Y2(i,l,e);S_(i,S);break e}}i=i.return}while(i!==null)}gT(n)}catch(E){e=E,pt===n&&n!==null&&(pt=n=n.return);continue}break}while(1)}function mT(){var t=Eh.current;return Eh.current=Sh,t===null?Sh:t}function Wx(){(wt===0||wt===3||wt===2)&&(wt=4),Tt===null||!(ya&268435455)&&!(jf&268435455)||Js(Tt,Ft)}function Th(t,e){var n=ve;ve|=2;var r=mT();(Tt!==t||Ft!==e)&&(ms=null,ca(t,e));do try{k4();break}catch(s){fT(t,s)}while(1);if(Ix(),ve=n,Eh.current=r,pt!==null)throw Error(j(261));return Tt=null,Ft=0,wt}function k4(){for(;pt!==null;)pT(pt)}function T4(){for(;pt!==null&&!YP();)pT(pt)}function pT(t){var e=xT(t.alternate,t,Nn);t.memoizedProps=t.pendingProps,e===null?gT(t):pt=e,zx.current=null}function gT(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=v4(n,e),n!==null){n.flags&=32767,pt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{wt=6,pt=null;return}}else if(n=x4(n,e,Nn),n!==null){pt=n;return}if(e=e.sibling,e!==null){pt=e;return}pt=e=t}while(e!==null);wt===0&&(wt=5)}function Yi(t,e,n){var r=Ce,s=ir.transition;try{ir.transition=null,Ce=1,I4(t,e,n,r)}finally{ir.transition=s,Ce=r}return null}function I4(t,e,n,r){do _o();while(ai!==null);if(ve&6)throw Error(j(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(j(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(o5(t,i),t===Tt&&(pt=Tt=null,Ft=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||ud||(ud=!0,vT(oh,function(){return _o(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=ir.transition,ir.transition=null;var a=Ce;Ce=1;var l=ve;ve|=4,zx.current=null,_4(t,n),uT(n,t),G5(y0),ch=!!g0,y0=g0=null,t.current=n,S4(n),JP(),ve=l,Ce=a,ir.transition=i}else t.current=n;if(ud&&(ud=!1,ai=t,kh=s),i=t.pendingLanes,i===0&&(mi=null),t5(n.stateNode),Sn(t,ot()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(bh)throw bh=!1,t=M0,M0=null,t;return kh&1&&t.tag!==0&&_o(),i=t.pendingLanes,i&1?t===L0?rc++:(rc=0,L0=t):rc=0,Di(),null}function _o(){if(ai!==null){var t=Kk(kh),e=ir.transition,n=Ce;try{if(ir.transition=null,Ce=16>t?16:t,ai===null)var r=!1;else{if(t=ai,ai=null,kh=0,ve&6)throw Error(j(331));var s=ve;for(ve|=4,$=t.current;$!==null;){var i=$,a=i.child;if($.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for($=u;$!==null;){var d=$;switch(d.tag){case 0:case 11:case 15:tc(8,d,i)}var h=d.child;if(h!==null)h.return=d,$=h;else for(;$!==null;){d=$;var m=d.sibling,p=d.return;if(oT(d),d===u){$=null;break}if(m!==null){m.return=p,$=m;break}$=p}}}var g=i.alternate;if(g!==null){var y=g.child;if(y!==null){g.child=null;do{var _=y.sibling;y.sibling=null,y=_}while(y!==null)}}$=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,$=a;else e:for(;$!==null;){if(i=$,i.flags&2048)switch(i.tag){case 0:case 11:case 15:tc(9,i,i.return)}var w=i.sibling;if(w!==null){w.return=i.return,$=w;break e}$=i.return}}var x=t.current;for($=x;$!==null;){a=$;var v=a.child;if(a.subtreeFlags&2064&&v!==null)v.return=a,$=v;else e:for(a=x;$!==null;){if(l=$,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Af(9,l)}}catch(E){et(l,l.return,E)}if(l===a){$=null;break e}var S=l.sibling;if(S!==null){S.return=l.return,$=S;break e}$=l.return}}if(ve=s,Di(),Gr&&typeof Gr.onPostCommitFiberRoot=="function")try{Gr.onPostCommitFiberRoot(Sf,t)}catch{}r=!0}return r}finally{Ce=n,ir.transition=e}}return!1}function H_(t,e,n){e=Do(n,e),e=X2(t,e,1),t=fi(t,e,1),e=dn(),t!==null&&(ou(t,1,e),Sn(t,e))}function et(t,e,n){if(t.tag===3)H_(t,t,n);else for(;e!==null;){if(e.tag===3){H_(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(mi===null||!mi.has(r))){t=Do(n,t),t=Y2(e,t,1),e=fi(e,t,1),t=dn(),e!==null&&(ou(e,1,t),Sn(e,t));break}}e=e.return}}function C4(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=dn(),t.pingedLanes|=t.suspendedLanes&n,Tt===t&&(Ft&n)===n&&(wt===4||wt===3&&(Ft&130023424)===Ft&&500>ot()-Ux?ca(t,0):Bx|=n),Sn(t,e)}function yT(t,e){e===0&&(t.mode&1?(e=ed,ed<<=1,!(ed&130023424)&&(ed=4194304)):e=1);var n=dn();t=As(t,e),t!==null&&(ou(t,e,n),Sn(t,n))}function R4(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),yT(t,n)}function A4(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(j(314))}r!==null&&r.delete(e),yT(t,n)}var xT;xT=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||wn.current)vn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return vn=!1,y4(t,e,n);vn=!!(t.flags&131072)}else vn=!1,We&&e.flags&1048576&&_2(e,gh,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Bd(t,e),t=e.pendingProps;var s=jo(e,Zt.current);wo(e,n),s=Dx(null,e,r,t,s,n);var i=Ox();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,_n(r)?(i=!0,mh(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Ax(e),s.updater=Cf,e.stateNode=s,s._reactInternals=e,T0(e,r,t,n),e=R0(null,e,r,!0,i,n)):(e.tag=0,We&&i&&Ex(e),on(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Bd(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=N4(r),t=wr(r,t),s){case 0:e=C0(null,e,r,t,n);break e;case 1:e=F_(null,e,r,t,n);break e;case 11:e=N_(null,e,r,t,n);break e;case 14:e=P_(null,e,r,wr(r.type,t),n);break e}throw Error(j(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:wr(r,s),C0(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:wr(r,s),F_(t,e,r,s,n);case 3:e:{if(tT(e),t===null)throw Error(j(387));r=e.pendingProps,i=e.memoizedState,s=i.element,k2(t,e),vh(e,r,null,n);var a=e.memoizedState;if(r=a.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=Do(Error(j(423)),e),e=D_(t,e,r,n,s);break e}else if(r!==s){s=Do(Error(j(424)),e),e=D_(t,e,r,n,s);break e}else for(Fn=hi(e.stateNode.containerInfo.firstChild),Ln=e,We=!0,Sr=null,n=R2(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(No(),r===s){e=js(t,e,n);break e}on(t,e,r,n)}e=e.child}return e;case 5:return A2(e),t===null&&E0(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,a=s.children,x0(r,s)?a=null:i!==null&&x0(r,i)&&(e.flags|=32),eT(t,e),on(t,e,a,n),e.child;case 6:return t===null&&E0(e),null;case 13:return nT(t,e,n);case 4:return jx(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Po(e,null,r,n):on(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:wr(r,s),N_(t,e,r,s,n);case 7:return on(t,e,e.pendingProps,n),e.child;case 8:return on(t,e,e.pendingProps.children,n),e.child;case 12:return on(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,a=s.value,Me(yh,r._currentValue),r._currentValue=a,i!==null)if(Cr(i.value,a)){if(i.children===s.children&&!wn.current){e=js(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){a=i.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(i.tag===1){c=bs(-1,n&-n),c.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}i.lanes|=n,c=i.alternate,c!==null&&(c.lanes|=n),b0(i.return,n,e),l.lanes|=n;break}c=c.next}}else if(i.tag===10)a=i.type===e.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error(j(341));a.lanes|=n,l=a.alternate,l!==null&&(l.lanes|=n),b0(a,n,e),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===e){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}on(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,wo(e,n),s=or(s),r=r(s),e.flags|=1,on(t,e,r,n),e.child;case 14:return r=e.type,s=wr(r,e.pendingProps),s=wr(r.type,s),P_(t,e,r,s,n);case 15:return J2(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:wr(r,s),Bd(t,e),e.tag=1,_n(r)?(t=!0,mh(e)):t=!1,wo(e,n),I2(e,r,s),T0(e,r,s,n),R0(null,e,r,!0,t,n);case 19:return rT(t,e,n);case 22:return Z2(t,e,n)}throw Error(j(156,e.tag))};function vT(t,e){return Wk(t,e)}function j4(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function sr(t,e,n,r){return new j4(t,e,n,r)}function qx(t){return t=t.prototype,!(!t||!t.isReactComponent)}function N4(t){if(typeof t=="function")return qx(t)?1:0;if(t!=null){if(t=t.$$typeof,t===dx)return 11;if(t===hx)return 14}return 2}function gi(t,e){var n=t.alternate;return n===null?(n=sr(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Hd(t,e,n,r,s,i){var a=2;if(r=t,typeof t=="function")qx(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case to:return ua(n.children,s,i,e);case ux:a=8,s|=8;break;case Xg:return t=sr(12,n,e,s|2),t.elementType=Xg,t.lanes=i,t;case Yg:return t=sr(13,n,e,s),t.elementType=Yg,t.lanes=i,t;case Jg:return t=sr(19,n,e,s),t.elementType=Jg,t.lanes=i,t;case Ck:return Nf(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Tk:a=10;break e;case Ik:a=9;break e;case dx:a=11;break e;case hx:a=14;break e;case Ks:a=16,r=null;break e}throw Error(j(130,t==null?t:typeof t,""))}return e=sr(a,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function ua(t,e,n,r){return t=sr(7,t,r,e),t.lanes=n,t}function Nf(t,e,n,r){return t=sr(22,t,r,e),t.elementType=Ck,t.lanes=n,t.stateNode={isHidden:!1},t}function Hp(t,e,n){return t=sr(6,t,null,e),t.lanes=n,t}function Wp(t,e,n){return e=sr(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function P4(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=kp(0),this.expirationTimes=kp(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=kp(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Gx(t,e,n,r,s,i,a,l,c){return t=new P4(t,e,n,l,c),e===1?(e=1,i===!0&&(e|=8)):e=0,i=sr(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ax(i),t}function F4(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:eo,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function wT(t){if(!t)return bi;t=t._reactInternals;e:{if(Na(t)!==t||t.tag!==1)throw Error(j(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(_n(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(j(171))}if(t.tag===1){var n=t.type;if(_n(n))return v2(t,n,e)}return e}function _T(t,e,n,r,s,i,a,l,c){return t=Gx(n,r,!0,t,s,i,a,l,c),t.context=wT(null),n=t.current,r=dn(),s=pi(n),i=bs(r,s),i.callback=e??null,fi(n,i,s),t.current.lanes=s,ou(t,s,r),Sn(t,r),t}function Pf(t,e,n,r){var s=e.current,i=dn(),a=pi(s);return n=wT(n),e.context===null?e.context=n:e.pendingContext=n,e=bs(i,a),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=fi(s,e,a),t!==null&&(Ir(t,s,a,i),Ld(t,s,a)),a}function Ih(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function W_(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Qx(t,e){W_(t,e),(t=t.alternate)&&W_(t,e)}function D4(){return null}var ST=typeof reportError=="function"?reportError:function(t){console.error(t)};function Kx(t){this._internalRoot=t}Ff.prototype.render=Kx.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(j(409));Pf(t,e,null,null)};Ff.prototype.unmount=Kx.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;xa(function(){Pf(null,t,null,null)}),e[Rs]=null}};function Ff(t){this._internalRoot=t}Ff.prototype.unstable_scheduleHydration=function(t){if(t){var e=Jk();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Ys.length&&e!==0&&e<Ys[n].priority;n++);Ys.splice(n,0,t),n===0&&e2(t)}};function Xx(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Df(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function q_(){}function O4(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var u=Ih(a);i.call(u)}}var a=_T(e,r,t,0,null,!1,!1,"",q_);return t._reactRootContainer=a,t[Rs]=a.current,vc(t.nodeType===8?t.parentNode:t),xa(),a}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var u=Ih(c);l.call(u)}}var c=Gx(t,0,!1,null,null,!1,!1,"",q_);return t._reactRootContainer=c,t[Rs]=c.current,vc(t.nodeType===8?t.parentNode:t),xa(function(){Pf(e,c,n,r)}),c}function Of(t,e,n,r,s){var i=n._reactRootContainer;if(i){var a=i;if(typeof s=="function"){var l=s;s=function(){var c=Ih(a);l.call(c)}}Pf(e,a,t,s)}else a=O4(n,e,t,s,r);return Ih(a)}Xk=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=zl(e.pendingLanes);n!==0&&(px(e,n|1),Sn(e,ot()),!(ve&6)&&(Oo=ot()+500,Di()))}break;case 13:xa(function(){var r=As(t,1);if(r!==null){var s=dn();Ir(r,t,1,s)}}),Qx(t,1)}};gx=function(t){if(t.tag===13){var e=As(t,134217728);if(e!==null){var n=dn();Ir(e,t,134217728,n)}Qx(t,134217728)}};Yk=function(t){if(t.tag===13){var e=pi(t),n=As(t,e);if(n!==null){var r=dn();Ir(n,t,e,r)}Qx(t,e)}};Jk=function(){return Ce};Zk=function(t,e){var n=Ce;try{return Ce=t,e()}finally{Ce=n}};l0=function(t,e,n){switch(e){case"input":if(t0(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=Tf(r);if(!s)throw Error(j(90));Ak(r),t0(r,s)}}}break;case"textarea":Nk(t,n);break;case"select":e=n.value,e!=null&&go(t,!!n.multiple,e,!1)}};$k=Vx;zk=xa;var M4={usingClientEntryPoint:!1,Events:[cu,io,Tf,Mk,Lk,Vx]},Al={findFiberByHostInstance:na,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},L4={bundleType:Al.bundleType,version:Al.version,rendererPackageName:Al.rendererPackageName,rendererConfig:Al.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:$s.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Vk(t),t===null?null:t.stateNode},findFiberByHostInstance:Al.findFiberByHostInstance||D4,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var dd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!dd.isDisabled&&dd.supportsFiber)try{Sf=dd.inject(L4),Gr=dd}catch{}}Hn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=M4;Hn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Xx(e))throw Error(j(200));return F4(t,e,null,n)};Hn.createRoot=function(t,e){if(!Xx(t))throw Error(j(299));var n=!1,r="",s=ST;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Gx(t,1,!1,null,null,n,!1,r,s),t[Rs]=e.current,vc(t.nodeType===8?t.parentNode:t),new Kx(e)};Hn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(j(188)):(t=Object.keys(t).join(","),Error(j(268,t)));return t=Vk(e),t=t===null?null:t.stateNode,t};Hn.flushSync=function(t){return xa(t)};Hn.hydrate=function(t,e,n){if(!Df(e))throw Error(j(200));return Of(null,t,e,!0,n)};Hn.hydrateRoot=function(t,e,n){if(!Xx(t))throw Error(j(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",a=ST;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),e=_T(e,null,t,1,n??null,s,!1,i,a),t[Rs]=e.current,vc(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Ff(e)};Hn.render=function(t,e,n){if(!Df(e))throw Error(j(200));return Of(null,t,e,!1,n)};Hn.unmountComponentAtNode=function(t){if(!Df(t))throw Error(j(40));return t._reactRootContainer?(xa(function(){Of(null,null,t,!1,function(){t._reactRootContainer=null,t[Rs]=null})}),!0):!1};Hn.unstable_batchedUpdates=Vx;Hn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Df(n))throw Error(j(200));if(t==null||t._reactInternals===void 0)throw Error(j(38));return Of(t,e,n,!1,r)};Hn.version="18.2.0-next-9e3b772b8-20220608";function ET(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(ET)}catch(t){console.error(t)}}ET(),_k.exports=Hn;var tl=_k.exports,G_=tl;Qg.createRoot=G_.createRoot,Qg.hydrateRoot=G_.hydrateRoot;/**
 * @remix-run/router v1.7.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Cc(){return Cc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Cc.apply(this,arguments)}var oi;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(oi||(oi={}));const Q_="popstate";function $4(t){t===void 0&&(t={});function e(s,i){let{pathname:a="/",search:l="",hash:c=""}=Pa(s.location.hash.substr(1));return B0("",{pathname:a,search:l,hash:c},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(s,i){let a=s.document.querySelector("base"),l="";if(a&&a.getAttribute("href")){let c=s.location.href,u=c.indexOf("#");l=u===-1?c:c.slice(0,u)}return l+"#"+(typeof i=="string"?i:Ch(i))}function r(s,i){Mf(s.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(i)+")")}return B4(e,n,r,t)}function ut(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Mf(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function z4(){return Math.random().toString(36).substr(2,8)}function K_(t,e){return{usr:t.state,key:t.key,idx:e}}function B0(t,e,n,r){return n===void 0&&(n=null),Cc({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Pa(e):e,{state:n,key:e&&e.key||r||z4()})}function Ch(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Pa(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function B4(t,e,n,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:i=!1}=r,a=s.history,l=oi.Pop,c=null,u=d();u==null&&(u=0,a.replaceState(Cc({},a.state,{idx:u}),""));function d(){return(a.state||{idx:null}).idx}function h(){l=oi.Pop;let _=d(),w=_==null?null:_-u;u=_,c&&c({action:l,location:y.location,delta:w})}function m(_,w){l=oi.Push;let x=B0(y.location,_,w);n&&n(x,_),u=d()+1;let v=K_(x,u),S=y.createHref(x);try{a.pushState(v,"",S)}catch(E){if(E instanceof DOMException&&E.name==="DataCloneError")throw E;s.location.assign(S)}i&&c&&c({action:l,location:y.location,delta:1})}function p(_,w){l=oi.Replace;let x=B0(y.location,_,w);n&&n(x,_),u=d();let v=K_(x,u),S=y.createHref(x);a.replaceState(v,"",S),i&&c&&c({action:l,location:y.location,delta:0})}function g(_){let w=s.location.origin!=="null"?s.location.origin:s.location.href,x=typeof _=="string"?_:Ch(_);return ut(w,"No window.location.(origin|href) available to create URL for href: "+x),new URL(x,w)}let y={get action(){return l},get location(){return t(s,a)},listen(_){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(Q_,h),c=_,()=>{s.removeEventListener(Q_,h),c=null}},createHref(_){return e(s,_)},createURL:g,encodeLocation(_){let w=g(_);return{pathname:w.pathname,search:w.search,hash:w.hash}},push:m,replace:p,go(_){return a.go(_)}};return y}var X_;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(X_||(X_={}));function U4(t,e,n){n===void 0&&(n="/");let r=typeof e=="string"?Pa(e):e,s=Yx(r.pathname||"/",n);if(s==null)return null;let i=bT(t);V4(i);let a=null;for(let l=0;a==null&&l<i.length;++l)a=J4(i[l],t3(s));return a}function bT(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let s=(i,a,l)=>{let c={relativePath:l===void 0?i.path||"":l,caseSensitive:i.caseSensitive===!0,childrenIndex:a,route:i};c.relativePath.startsWith("/")&&(ut(c.relativePath.startsWith(r),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(r.length));let u=yi([r,c.relativePath]),d=n.concat(c);i.children&&i.children.length>0&&(ut(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),bT(i.children,e,d,u)),!(i.path==null&&!i.index)&&e.push({path:u,score:X4(u,i.index),routesMeta:d})};return t.forEach((i,a)=>{var l;if(i.path===""||!((l=i.path)!=null&&l.includes("?")))s(i,a);else for(let c of kT(i.path))s(i,a,c)}),e}function kT(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let a=kT(r.join("/")),l=[];return l.push(...a.map(c=>c===""?i:[i,c].join("/"))),s&&l.push(...a),l.map(c=>t.startsWith("/")&&c===""?"/":c)}function V4(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:Y4(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const H4=/^:\w+$/,W4=3,q4=2,G4=1,Q4=10,K4=-2,Y_=t=>t==="*";function X4(t,e){let n=t.split("/"),r=n.length;return n.some(Y_)&&(r+=K4),e&&(r+=q4),n.filter(s=>!Y_(s)).reduce((s,i)=>s+(H4.test(i)?W4:i===""?G4:Q4),r)}function Y4(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function J4(t,e){let{routesMeta:n}=t,r={},s="/",i=[];for(let a=0;a<n.length;++a){let l=n[a],c=a===n.length-1,u=s==="/"?e:e.slice(s.length)||"/",d=Z4({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u);if(!d)return null;Object.assign(r,d.params);let h=l.route;i.push({params:r,pathname:yi([s,d.pathname]),pathnameBase:i3(yi([s,d.pathnameBase])),route:h}),d.pathnameBase!=="/"&&(s=yi([s,d.pathnameBase]))}return i}function Z4(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=e3(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let i=s[0],a=i.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:r.reduce((u,d,h)=>{if(d==="*"){let m=l[h]||"";a=i.slice(0,i.length-m.length).replace(/(.)\/+$/,"$1")}return u[d]=n3(l[h]||"",d),u},{}),pathname:i,pathnameBase:a,pattern:t}}function e3(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),Mf(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/\/:(\w+)/g,(a,l)=>(r.push(l),"/([^\\/]+)"));return t.endsWith("*")?(r.push("*"),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function t3(t){try{return decodeURI(t)}catch(e){return Mf(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function n3(t,e){try{return decodeURIComponent(t)}catch(n){return Mf(!1,'The value for the URL param "'+e+'" will not be decoded because'+(' the string "'+t+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+n+").")),t}}function Yx(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function r3(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?Pa(t):t;return{pathname:n?n.startsWith("/")?n:s3(n,e):e,search:a3(r),hash:o3(s)}}function s3(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function qp(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Jx(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function Zx(t,e,n,r){r===void 0&&(r=!1);let s;typeof t=="string"?s=Pa(t):(s=Cc({},t),ut(!s.pathname||!s.pathname.includes("?"),qp("?","pathname","search",s)),ut(!s.pathname||!s.pathname.includes("#"),qp("#","pathname","hash",s)),ut(!s.search||!s.search.includes("#"),qp("#","search","hash",s)));let i=t===""||s.pathname==="",a=i?"/":s.pathname,l;if(r||a==null)l=n;else{let h=e.length-1;if(a.startsWith("..")){let m=a.split("/");for(;m[0]==="..";)m.shift(),h-=1;s.pathname=m.join("/")}l=h>=0?e[h]:"/"}let c=r3(s,l),u=a&&a!=="/"&&a.endsWith("/"),d=(i||a===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}const yi=t=>t.join("/").replace(/\/\/+/g,"/"),i3=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),a3=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,o3=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function l3(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const TT=["post","put","patch","delete"];new Set(TT);const c3=["get",...TT];new Set(c3);/**
 * React Router v6.14.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Rh(){return Rh=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Rh.apply(this,arguments)}const ev=f.createContext(null),u3=f.createContext(null),nl=f.createContext(null),Lf=f.createContext(null),as=f.createContext({outlet:null,matches:[],isDataRoute:!1}),IT=f.createContext(null);function d3(t,e){let{relative:n}=e===void 0?{}:e;rl()||ut(!1);let{basename:r,navigator:s}=f.useContext(nl),{hash:i,pathname:a,search:l}=RT(t,{relative:n}),c=a;return r!=="/"&&(c=a==="/"?r:yi([r,a])),s.createHref({pathname:c,search:l,hash:i})}function rl(){return f.useContext(Lf)!=null}function qn(){return rl()||ut(!1),f.useContext(Lf).location}function CT(t){f.useContext(nl).static||f.useLayoutEffect(t)}function nn(){let{isDataRoute:t}=f.useContext(as);return t?T3():h3()}function h3(){rl()||ut(!1);let t=f.useContext(ev),{basename:e,navigator:n}=f.useContext(nl),{matches:r}=f.useContext(as),{pathname:s}=qn(),i=JSON.stringify(Jx(r).map(c=>c.pathnameBase)),a=f.useRef(!1);return CT(()=>{a.current=!0}),f.useCallback(function(c,u){if(u===void 0&&(u={}),!a.current)return;if(typeof c=="number"){n.go(c);return}let d=Zx(c,JSON.parse(i),s,u.relative==="path");t==null&&e!=="/"&&(d.pathname=d.pathname==="/"?e:yi([e,d.pathname])),(u.replace?n.replace:n.push)(d,u.state,u)},[e,n,i,s,t])}const f3=f.createContext(null);function m3(t){let e=f.useContext(as).outlet;return e&&f.createElement(f3.Provider,{value:t},e)}function Fa(){let{matches:t}=f.useContext(as),e=t[t.length-1];return e?e.params:{}}function RT(t,e){let{relative:n}=e===void 0?{}:e,{matches:r}=f.useContext(as),{pathname:s}=qn(),i=JSON.stringify(Jx(r).map(a=>a.pathnameBase));return f.useMemo(()=>Zx(t,JSON.parse(i),s,n==="path"),[t,i,s,n])}function p3(t,e){return g3(t,e)}function g3(t,e,n){rl()||ut(!1);let{navigator:r}=f.useContext(nl),{matches:s}=f.useContext(as),i=s[s.length-1],a=i?i.params:{};i&&i.pathname;let l=i?i.pathnameBase:"/";i&&i.route;let c=qn(),u;if(e){var d;let y=typeof e=="string"?Pa(e):e;l==="/"||(d=y.pathname)!=null&&d.startsWith(l)||ut(!1),u=y}else u=c;let h=u.pathname||"/",m=l==="/"?h:h.slice(l.length)||"/",p=U4(t,{pathname:m}),g=_3(p&&p.map(y=>Object.assign({},y,{params:Object.assign({},a,y.params),pathname:yi([l,r.encodeLocation?r.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?l:yi([l,r.encodeLocation?r.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),s,n);return e&&g?f.createElement(Lf.Provider,{value:{location:Rh({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:oi.Pop}},g):g}function y3(){let t=k3(),e=l3(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},i=null;return f.createElement(f.Fragment,null,f.createElement("h2",null,"Unexpected Application Error!"),f.createElement("h3",{style:{fontStyle:"italic"}},e),n?f.createElement("pre",{style:s},n):null,i)}const x3=f.createElement(y3,null);class v3 extends f.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error||n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error?f.createElement(as.Provider,{value:this.props.routeContext},f.createElement(IT.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function w3(t){let{routeContext:e,match:n,children:r}=t,s=f.useContext(ev);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),f.createElement(as.Provider,{value:e},r)}function _3(t,e,n){var r;if(e===void 0&&(e=[]),n===void 0&&(n=null),t==null){var s;if((s=n)!=null&&s.errors)t=n.matches;else return null}let i=t,a=(r=n)==null?void 0:r.errors;if(a!=null){let l=i.findIndex(c=>c.route.id&&(a==null?void 0:a[c.route.id]));l>=0||ut(!1),i=i.slice(0,Math.min(i.length,l+1))}return i.reduceRight((l,c,u)=>{let d=c.route.id?a==null?void 0:a[c.route.id]:null,h=null;n&&(h=c.route.errorElement||x3);let m=e.concat(i.slice(0,u+1)),p=()=>{let g;return d?g=h:c.route.Component?g=f.createElement(c.route.Component,null):c.route.element?g=c.route.element:g=l,f.createElement(w3,{match:c,routeContext:{outlet:l,matches:m,isDataRoute:n!=null},children:g})};return n&&(c.route.ErrorBoundary||c.route.errorElement||u===0)?f.createElement(v3,{location:n.location,revalidation:n.revalidation,component:h,error:d,children:p(),routeContext:{outlet:null,matches:m,isDataRoute:!0}}):p()},null)}var U0;(function(t){t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate"})(U0||(U0={}));var Rc;(function(t){t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId"})(Rc||(Rc={}));function S3(t){let e=f.useContext(ev);return e||ut(!1),e}function E3(t){let e=f.useContext(u3);return e||ut(!1),e}function b3(t){let e=f.useContext(as);return e||ut(!1),e}function AT(t){let e=b3(),n=e.matches[e.matches.length-1];return n.route.id||ut(!1),n.route.id}function k3(){var t;let e=f.useContext(IT),n=E3(Rc.UseRouteError),r=AT(Rc.UseRouteError);return e||((t=n.errors)==null?void 0:t[r])}function T3(){let{router:t}=S3(U0.UseNavigateStable),e=AT(Rc.UseNavigateStable),n=f.useRef(!1);return CT(()=>{n.current=!0}),f.useCallback(function(s,i){i===void 0&&(i={}),n.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,Rh({fromRouteId:e},i)))},[t,e])}function jT(t){let{to:e,replace:n,state:r,relative:s}=t;rl()||ut(!1);let{matches:i}=f.useContext(as),{pathname:a}=qn(),l=nn(),c=Zx(e,Jx(i).map(d=>d.pathnameBase),a,s==="path"),u=JSON.stringify(c);return f.useEffect(()=>l(JSON.parse(u),{replace:n,state:r,relative:s}),[l,u,s,n,r]),null}function $f(t){return m3(t.context)}function Or(t){ut(!1)}function I3(t){let{basename:e="/",children:n=null,location:r,navigationType:s=oi.Pop,navigator:i,static:a=!1}=t;rl()&&ut(!1);let l=e.replace(/^\/*/,"/"),c=f.useMemo(()=>({basename:l,navigator:i,static:a}),[l,i,a]);typeof r=="string"&&(r=Pa(r));let{pathname:u="/",search:d="",hash:h="",state:m=null,key:p="default"}=r,g=f.useMemo(()=>{let y=Yx(u,l);return y==null?null:{location:{pathname:y,search:d,hash:h,state:m,key:p},navigationType:s}},[l,u,d,h,m,p,s]);return g==null?null:f.createElement(nl.Provider,{value:c},f.createElement(Lf.Provider,{children:n,value:g}))}function C3(t){let{children:e,location:n}=t;return p3(V0(e),n)}var J_;(function(t){t[t.pending=0]="pending",t[t.success=1]="success",t[t.error=2]="error"})(J_||(J_={}));new Promise(()=>{});function V0(t,e){e===void 0&&(e=[]);let n=[];return f.Children.forEach(t,(r,s)=>{if(!f.isValidElement(r))return;let i=[...e,s];if(r.type===f.Fragment){n.push.apply(n,V0(r.props.children,i));return}r.type!==Or&&ut(!1),!r.props.index||!r.props.children||ut(!1);let a={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(a.children=V0(r.props.children,i)),n.push(a)}),n}/**
 * React Router DOM v6.14.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function H0(){return H0=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},H0.apply(this,arguments)}function R3(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,i;for(i=0;i<r.length;i++)s=r[i],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}function A3(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function j3(t,e){return t.button===0&&(!e||e==="_self")&&!A3(t)}function W0(t){return t===void 0&&(t=""),new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let r=t[n];return e.concat(Array.isArray(r)?r.map(s=>[n,s]):[[n,r]])},[]))}function N3(t,e){let n=W0(t);if(e)for(let r of e.keys())n.has(r)||e.getAll(r).forEach(s=>{n.append(r,s)});return n}const P3=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset"],F3="startTransition",Z_=RP[F3];function D3(t){let{basename:e,children:n,future:r,window:s}=t,i=f.useRef();i.current==null&&(i.current=$4({window:s,v5Compat:!0}));let a=i.current,[l,c]=f.useState({action:a.action,location:a.location}),{v7_startTransition:u}=r||{},d=f.useCallback(h=>{u&&Z_?Z_(()=>c(h)):c(h)},[c,u]);return f.useLayoutEffect(()=>a.listen(d),[a,d]),f.createElement(I3,{basename:e,children:n,location:l.location,navigationType:l.action,navigator:a})}const O3=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",M3=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,we=f.forwardRef(function(e,n){let{onClick:r,relative:s,reloadDocument:i,replace:a,state:l,target:c,to:u,preventScrollReset:d}=e,h=R3(e,P3),{basename:m}=f.useContext(nl),p,g=!1;if(typeof u=="string"&&M3.test(u)&&(p=u,O3))try{let x=new URL(window.location.href),v=u.startsWith("//")?new URL(x.protocol+u):new URL(u),S=Yx(v.pathname,m);v.origin===x.origin&&S!=null?u=S+v.search+v.hash:g=!0}catch{}let y=d3(u,{relative:s}),_=L3(u,{replace:a,state:l,target:c,preventScrollReset:d,relative:s});function w(x){r&&r(x),x.defaultPrevented||_(x)}return f.createElement("a",H0({},h,{href:p||y,onClick:g||i?r:w,ref:n,target:c}))});var eS;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher"})(eS||(eS={}));var tS;(function(t){t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(tS||(tS={}));function L3(t,e){let{target:n,replace:r,state:s,preventScrollReset:i,relative:a}=e===void 0?{}:e,l=nn(),c=qn(),u=RT(t,{relative:a});return f.useCallback(d=>{if(j3(d,n)){d.preventDefault();let h=r!==void 0?r:Ch(c)===Ch(u);l(t,{replace:h,state:s,preventScrollReset:i,relative:a})}},[c,l,u,r,s,n,t,i,a])}function NT(t){let e=f.useRef(W0(t)),n=f.useRef(!1),r=qn(),s=f.useMemo(()=>N3(r.search,n.current?null:e.current),[r.search]),i=nn(),a=f.useCallback((l,c)=>{const u=W0(typeof l=="function"?l(s):l);n.current=!0,i("?"+u,c)},[i,s]);return[s,a]}function $3(){const[t,e]=f.useState([]),[n,r]=f.useState(),[s,i]=f.useState([]),[a,l]=f.useState([]),[c,u]=f.useState([]);return{singer:n,setSinger:r,singers:t,setSingers:e,songs:s,setSongs:i,playlists:a,setPlaylists:l,albums:c,setAlbums:u}}const PT=f.createContext(null);function z3({children:t}){return o.jsx(PT.Provider,{value:$3(),children:t})}function Oi(){const t=f.useContext(PT);if(!t)throw new Error("SingerProvider not provided");return t}function nS({children:t}){return o.jsx(z3,{children:t})}function zf(){const t={container:"pt-[30px] pb-[110px] md:mt-auto md:pb-[120px] md:flex md:justify-between md:items-center",icon:"w-6 hover:scale-[1.1] transition linear ",copyRightText:"text-sm"};return o.jsxs("div",{className:`${t.container}`,children:[o.jsxs("p",{className:t.copyRightText,children:["Make with ❤️ by d4t06 ",o.jsx("br",{})," © All rights no reserve ¯\\_(ツ)_/¯"]}),o.jsxs("div",{className:"flex items-center mt-[20px] md:mt-0 space-x-[10px]",children:[o.jsx("a",{href:"mailto:datnh0708@gmail.com",children:o.jsx("svg",{className:t.icon,fill:"currentColor",viewBox:"0 0 32 32",xmlns:"http://www.w3.org/2000/svg",children:o.jsxs("g",{children:[o.jsx("path",{d:"M16.601 14.648v4.105h9.813c-0.162 2.008-0.982 3.798-2.243 5.18l0.006-0.007c-1.825 1.86-4.364 3.012-7.172 3.012-0.142 0-0.283-0.003-0.424-0.009l0.020 0.001c-5.946-0.003-10.765-4.823-10.765-10.77 0-0.051 0-0.102 0.001-0.152l-0 0.008c-0.001-0.043-0.001-0.094-0.001-0.145 0-5.946 4.819-10.767 10.765-10.77h0c0.040-0.001 0.087-0.001 0.135-0.001 2.822 0 5.383 1.121 7.262 2.941l-0.003-0.003 2.888-2.888c-2.568-2.578-6.121-4.174-10.047-4.174-0.082 0-0.164 0.001-0.246 0.002l0.012-0c-0.002 0-0.005 0-0.008 0-8.337 0-15.11 6.699-15.228 15.009l-0 0.011c0.118 8.32 6.891 15.020 15.228 15.020 0.003 0 0.006 0 0.009 0h-0c0.169 0.007 0.367 0.012 0.566 0.012 3.892 0 7.407-1.616 9.91-4.213l0.004-0.004c2.208-2.408 3.561-5.63 3.561-9.169 0-0.15-0.002-0.3-0.007-0.449l0.001 0.022c0.001-0.054 0.001-0.119 0.001-0.183 0-0.844-0.079-1.669-0.231-2.469l0.013 0.082z"})," "]})})}),o.jsx("a",{href:"https://github.com/d4t06",target:"_blank",children:o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t.icon,fill:"currentColor",viewBox:"0 0 496 512",children:o.jsx("path",{d:"M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"})})}),o.jsx("a",{href:"https://www.linkedin.com/in/dat-nguyen-huu-9371a926a",target:"_blank",children:o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t.icon,viewBox:"0 0 448 512",fill:"currentColor",children:o.jsx("path",{d:"M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"})})})]})]})}const B3=()=>{const[t,e]=f.useState(null),[n,r]=f.useState(!0),s=f.useRef(!1);return{user:t,setUser:e,loading:n,setLoading:r,updateUserData:a=>{e(l=>l?{...l,...a}:null)},justRegistered:s}},FT=f.createContext(null);function fe(){const t=f.useContext(FT);if(!t)throw new Error("auth context not Provided");return t}function U3({children:t}){return o.jsx(FT.Provider,{value:B3(),children:t})}function V3(){const[t,e]=f.useState({songs:[],playlists:[]}),[n,r]=f.useState([]),[s,i]=f.useState([]),[a,l]=f.useState([]),[c,u]=f.useState([]),d=f.useRef(!0),h=f.useRef(!0),m=f.useRef(!0),p=f.useRef(!0);return{uploadedSongs:n,setUploadedSongs:r,playlists:a,setPlaylists:l,favoriteSongs:s,setFavoriteSongs:i,sysSongPlaylist:t,setSysSongPlaylist:e,shouldFetchUserSongs:d,shouldFetchUserPlaylists:m,shouldFetchFavoriteSongs:h,updateSong:y=>{const _=[...n],w=_.findIndex(x=>x.id===y.id);if(w!==-1){const x={..._[w]};Object.assign(x,y.song),_[w]=x,r(_)}},singers:c,setSingers:u,shouldFetchUserSingers:p}}const DT=f.createContext(null);function H3({children:t}){return o.jsx(DT.Provider,{value:V3(),children:t})}const Cn=()=>{const t=f.useContext(DT);if(!t)throw new Error("SongContext not provided");return t},Ah=[{name:"Red",id:"red",type:"dark",bottom_player_bg:"bg-[#3b1113]",side_bar_bg:"bg-[#391b1c]",content_text:"text-[#ca4954]",content_hover_text:"hover:text-[#ca4954]",content_border:"border-[#ca4954]",content_hover_border:"hover:border-[#ca4954]",content_bg:"bg-[#ca4954] text-[#fff]",modal_bg:"bg-[#4f171c]",content_code:"#ca4954",content_hover_bg:"hover:!bg-[#ca4954] hover:text-[#fff] ",container:"bg-[#2e0f10]",container_code:"#2e0f10",text_color:""},{name:"Black",id:"black",type:"dark",bottom_player_bg:"bg-[#181818]",side_bar_bg:"bg-[#242424]",content_text:"text-[#198585]",content_hover_text:"hover:text-[#198585]",content_border:"border-[#198585]",content_hover_border:"hover:border-[#198585]",content_bg:"bg-[#198585]  text-[#fff]",modal_bg:"bg-[#333]",content_code:"#198585",content_hover_bg:"hover:!bg-[#198585] hover:text-[#fff] ",container:"bg-[#1e1e1e]",container_code:"#1e1e1e",text_color:""},{name:"Deep blue",id:"deep_blue",type:"dark",bottom_player_bg:"bg-[#111f3b]",side_bar_bg:"bg-[#1b2639]",content_text:"text-[#0c9e85]",content_hover_text:"hover:text-[#0c9e85]",content_border:"border-[#0c9e85]",content_hover_border:"hover:border-[#0c9e85]",content_bg:"bg-[#0c9e85]  text-[#fff]",modal_bg:"bg-[#05473c]",content_code:"#0c9e85",content_hover_bg:"hover:!bg-[#0c9e85] hover:text-[#fff] ",container:"bg-[#0f1a2e]",container_code:"#0f1a2e",text_color:""},{name:"White",id:"white",type:"light",bottom_player_bg:"bg-[#fff]",side_bar_bg:"bg-[#f2f2f2]",content_text:"text-[#198585]",content_hover_text:"hover:text-[#198585]",content_border:"border-[#198585]",content_hover_border:"hover:border-[#198585]",content_bg:"bg-[#198585] text-[#fff]",modal_bg:"bg-[#105656]",content_code:"#198585",content_hover_bg:"hover:!bg-[#198585] hover:text-[#fff]",container:"bg-[#fff]",container_code:"#fff",text_color:""},{name:"Light green",id:"green_light",type:"light",bottom_player_bg:"bg-[#c0d8d8]",side_bar_bg:"bg-[#dde5e5]",content_text:"text-[#198585]",content_hover_text:"hover:text-[#198585]",content_border:"border-[#198585]",content_hover_border:"hover:border-[#198585]",content_bg:"bg-[#198585] text-[#fff]",modal_bg:"bg-[#105656]",content_code:"#198585",content_hover_bg:"hover:!bg-[#198585] hover:text-[#fff]",container:"bg-[#ced9d9]",container_code:"#ced9d9",text_color:""},{name:"Brown",id:"gray",type:"light",bottom_player_bg:"bg-[#dedad1]",side_bar_bg:"bg-[#d9d7d4]",content_text:"text-[#644646]",content_hover_text:"hover:text-[#644646]",content_border:"border-[#644646]",content_hover_border:"hover:border-[#644646]",content_bg:"bg-[#644646]  text-[#fff]",modal_bg:"bg-[#3c2a2a]",content_code:"#644646",content_hover_bg:"hover:!bg-[#644646] hover:text-[#fff]",container:"bg-white",container_code:"#fff",text_color:""}],W3={name:"dashboard",id:"dashboard",type:"light",bottom_player_bg:"bg-[#fff]",side_bar_bg:"bg-[#f2f2f2]",content_text:"text-[#5a9e87]",content_hover_text:"hover:text-[#5a9e87]",content_border:"border-[#5a9e87]",content_hover_border:"hover:border-[#5a9e87]",content_bg:"bg-[#5a9e87] text-[#fff]",modal_bg:"bg-[#417161]",content_code:"#5a9e87",content_hover_bg:"hover:!bg-[#5a9e87] hover:text-[#fff]",container:"bg-[#fff]",container_code:"#fff",text_color:""},OT=[{name:"Tet",id:"tet",type:"light",bottom_player_bg:"bg-[#fdf6e3]",side_bar_bg:"bg-[#fdf6e3]",content_text:"text-[#644646]",content_hover_text:"hover:text-[#644646]",content_border:"border-[#644646]",content_hover_border:"hover:border-[#644646]",content_bg:"bg-[#644646]  text-[#fff]",modal_bg:"bg-[#3c2a2a]",content_code:"#644646",content_hover_bg:"hover:!bg-[#644646] hover:text-[#fff]",container:"bg-[#f7f0de]",container_code:"#fdf6e3",text_color:"",image:"tet_theme_image.png"}];function MT(t,e){return function(){return t.apply(e,arguments)}}const{toString:q3}=Object.prototype,{getPrototypeOf:tv}=Object,Bf=(t=>e=>{const n=q3.call(e);return t[n]||(t[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),os=t=>(t=t.toLowerCase(),e=>Bf(e)===t),Uf=t=>e=>typeof e===t,{isArray:sl}=Array,Ac=Uf("undefined");function G3(t){return t!==null&&!Ac(t)&&t.constructor!==null&&!Ac(t.constructor)&&ar(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const LT=os("ArrayBuffer");function Q3(t){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&LT(t.buffer),e}const K3=Uf("string"),ar=Uf("function"),$T=Uf("number"),Vf=t=>t!==null&&typeof t=="object",X3=t=>t===!0||t===!1,Wd=t=>{if(Bf(t)!=="object")return!1;const e=tv(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},Y3=os("Date"),J3=os("File"),Z3=os("Blob"),eF=os("FileList"),tF=t=>Vf(t)&&ar(t.pipe),nF=t=>{let e;return t&&(typeof FormData=="function"&&t instanceof FormData||ar(t.append)&&((e=Bf(t))==="formdata"||e==="object"&&ar(t.toString)&&t.toString()==="[object FormData]"))},rF=os("URLSearchParams"),sF=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function du(t,e,{allOwnKeys:n=!1}={}){if(t===null||typeof t>"u")return;let r,s;if(typeof t!="object"&&(t=[t]),sl(t))for(r=0,s=t.length;r<s;r++)e.call(null,t[r],r,t);else{const i=n?Object.getOwnPropertyNames(t):Object.keys(t),a=i.length;let l;for(r=0;r<a;r++)l=i[r],e.call(null,t[l],l,t)}}function zT(t,e){e=e.toLowerCase();const n=Object.keys(t);let r=n.length,s;for(;r-- >0;)if(s=n[r],e===s.toLowerCase())return s;return null}const BT=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),UT=t=>!Ac(t)&&t!==BT;function q0(){const{caseless:t}=UT(this)&&this||{},e={},n=(r,s)=>{const i=t&&zT(e,s)||s;Wd(e[i])&&Wd(r)?e[i]=q0(e[i],r):Wd(r)?e[i]=q0({},r):sl(r)?e[i]=r.slice():e[i]=r};for(let r=0,s=arguments.length;r<s;r++)arguments[r]&&du(arguments[r],n);return e}const iF=(t,e,n,{allOwnKeys:r}={})=>(du(e,(s,i)=>{n&&ar(s)?t[i]=MT(s,n):t[i]=s},{allOwnKeys:r}),t),aF=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),oF=(t,e,n,r)=>{t.prototype=Object.create(e.prototype,r),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),n&&Object.assign(t.prototype,n)},lF=(t,e,n,r)=>{let s,i,a;const l={};if(e=e||{},t==null)return e;do{for(s=Object.getOwnPropertyNames(t),i=s.length;i-- >0;)a=s[i],(!r||r(a,t,e))&&!l[a]&&(e[a]=t[a],l[a]=!0);t=n!==!1&&tv(t)}while(t&&(!n||n(t,e))&&t!==Object.prototype);return e},cF=(t,e,n)=>{t=String(t),(n===void 0||n>t.length)&&(n=t.length),n-=e.length;const r=t.indexOf(e,n);return r!==-1&&r===n},uF=t=>{if(!t)return null;if(sl(t))return t;let e=t.length;if(!$T(e))return null;const n=new Array(e);for(;e-- >0;)n[e]=t[e];return n},dF=(t=>e=>t&&e instanceof t)(typeof Uint8Array<"u"&&tv(Uint8Array)),hF=(t,e)=>{const r=(t&&t[Symbol.iterator]).call(t);let s;for(;(s=r.next())&&!s.done;){const i=s.value;e.call(t,i[0],i[1])}},fF=(t,e)=>{let n;const r=[];for(;(n=t.exec(e))!==null;)r.push(n);return r},mF=os("HTMLFormElement"),pF=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,r,s){return r.toUpperCase()+s}),rS=(({hasOwnProperty:t})=>(e,n)=>t.call(e,n))(Object.prototype),gF=os("RegExp"),VT=(t,e)=>{const n=Object.getOwnPropertyDescriptors(t),r={};du(n,(s,i)=>{let a;(a=e(s,i,t))!==!1&&(r[i]=a||s)}),Object.defineProperties(t,r)},yF=t=>{VT(t,(e,n)=>{if(ar(t)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const r=t[n];if(ar(r)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},xF=(t,e)=>{const n={},r=s=>{s.forEach(i=>{n[i]=!0})};return sl(t)?r(t):r(String(t).split(e)),n},vF=()=>{},wF=(t,e)=>(t=+t,Number.isFinite(t)?t:e),Gp="abcdefghijklmnopqrstuvwxyz",sS="0123456789",HT={DIGIT:sS,ALPHA:Gp,ALPHA_DIGIT:Gp+Gp.toUpperCase()+sS},_F=(t=16,e=HT.ALPHA_DIGIT)=>{let n="";const{length:r}=e;for(;t--;)n+=e[Math.random()*r|0];return n};function SF(t){return!!(t&&ar(t.append)&&t[Symbol.toStringTag]==="FormData"&&t[Symbol.iterator])}const EF=t=>{const e=new Array(10),n=(r,s)=>{if(Vf(r)){if(e.indexOf(r)>=0)return;if(!("toJSON"in r)){e[s]=r;const i=sl(r)?[]:{};return du(r,(a,l)=>{const c=n(a,s+1);!Ac(c)&&(i[l]=c)}),e[s]=void 0,i}}return r};return n(t,0)},bF=os("AsyncFunction"),kF=t=>t&&(Vf(t)||ar(t))&&ar(t.then)&&ar(t.catch),R={isArray:sl,isArrayBuffer:LT,isBuffer:G3,isFormData:nF,isArrayBufferView:Q3,isString:K3,isNumber:$T,isBoolean:X3,isObject:Vf,isPlainObject:Wd,isUndefined:Ac,isDate:Y3,isFile:J3,isBlob:Z3,isRegExp:gF,isFunction:ar,isStream:tF,isURLSearchParams:rF,isTypedArray:dF,isFileList:eF,forEach:du,merge:q0,extend:iF,trim:sF,stripBOM:aF,inherits:oF,toFlatObject:lF,kindOf:Bf,kindOfTest:os,endsWith:cF,toArray:uF,forEachEntry:hF,matchAll:fF,isHTMLForm:mF,hasOwnProperty:rS,hasOwnProp:rS,reduceDescriptors:VT,freezeMethods:yF,toObjectSet:xF,toCamelCase:pF,noop:vF,toFiniteNumber:wF,findKey:zT,global:BT,isContextDefined:UT,ALPHABET:HT,generateString:_F,isSpecCompliantForm:SF,toJSONObject:EF,isAsyncFn:bF,isThenable:kF};function ye(t,e,n,r,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",e&&(this.code=e),n&&(this.config=n),r&&(this.request=r),s&&(this.response=s)}R.inherits(ye,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:R.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const WT=ye.prototype,qT={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{qT[t]={value:t}});Object.defineProperties(ye,qT);Object.defineProperty(WT,"isAxiosError",{value:!0});ye.from=(t,e,n,r,s,i)=>{const a=Object.create(WT);return R.toFlatObject(t,a,function(c){return c!==Error.prototype},l=>l!=="isAxiosError"),ye.call(a,t.message,e,n,r,s),a.cause=t,a.name=t.name,i&&Object.assign(a,i),a};const TF=null;function G0(t){return R.isPlainObject(t)||R.isArray(t)}function GT(t){return R.endsWith(t,"[]")?t.slice(0,-2):t}function iS(t,e,n){return t?t.concat(e).map(function(s,i){return s=GT(s),!n&&i?"["+s+"]":s}).join(n?".":""):e}function IF(t){return R.isArray(t)&&!t.some(G0)}const CF=R.toFlatObject(R,{},null,function(e){return/^is[A-Z]/.test(e)});function Hf(t,e,n){if(!R.isObject(t))throw new TypeError("target must be an object");e=e||new FormData,n=R.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(y,_){return!R.isUndefined(_[y])});const r=n.metaTokens,s=n.visitor||d,i=n.dots,a=n.indexes,c=(n.Blob||typeof Blob<"u"&&Blob)&&R.isSpecCompliantForm(e);if(!R.isFunction(s))throw new TypeError("visitor must be a function");function u(g){if(g===null)return"";if(R.isDate(g))return g.toISOString();if(!c&&R.isBlob(g))throw new ye("Blob is not supported. Use a Buffer instead.");return R.isArrayBuffer(g)||R.isTypedArray(g)?c&&typeof Blob=="function"?new Blob([g]):Buffer.from(g):g}function d(g,y,_){let w=g;if(g&&!_&&typeof g=="object"){if(R.endsWith(y,"{}"))y=r?y:y.slice(0,-2),g=JSON.stringify(g);else if(R.isArray(g)&&IF(g)||(R.isFileList(g)||R.endsWith(y,"[]"))&&(w=R.toArray(g)))return y=GT(y),w.forEach(function(v,S){!(R.isUndefined(v)||v===null)&&e.append(a===!0?iS([y],S,i):a===null?y:y+"[]",u(v))}),!1}return G0(g)?!0:(e.append(iS(_,y,i),u(g)),!1)}const h=[],m=Object.assign(CF,{defaultVisitor:d,convertValue:u,isVisitable:G0});function p(g,y){if(!R.isUndefined(g)){if(h.indexOf(g)!==-1)throw Error("Circular reference detected in "+y.join("."));h.push(g),R.forEach(g,function(w,x){(!(R.isUndefined(w)||w===null)&&s.call(e,w,R.isString(x)?x.trim():x,y,m))===!0&&p(w,y?y.concat(x):[x])}),h.pop()}}if(!R.isObject(t))throw new TypeError("data must be an object");return p(t),e}function aS(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(r){return e[r]})}function nv(t,e){this._pairs=[],t&&Hf(t,this,e)}const QT=nv.prototype;QT.append=function(e,n){this._pairs.push([e,n])};QT.toString=function(e){const n=e?function(r){return e.call(this,r,aS)}:aS;return this._pairs.map(function(s){return n(s[0])+"="+n(s[1])},"").join("&")};function RF(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function KT(t,e,n){if(!e)return t;const r=n&&n.encode||RF,s=n&&n.serialize;let i;if(s?i=s(e,n):i=R.isURLSearchParams(e)?e.toString():new nv(e,n).toString(r),i){const a=t.indexOf("#");a!==-1&&(t=t.slice(0,a)),t+=(t.indexOf("?")===-1?"?":"&")+i}return t}class AF{constructor(){this.handlers=[]}use(e,n,r){return this.handlers.push({fulfilled:e,rejected:n,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){R.forEach(this.handlers,function(r){r!==null&&e(r)})}}const oS=AF,XT={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},jF=typeof URLSearchParams<"u"?URLSearchParams:nv,NF=typeof FormData<"u"?FormData:null,PF=typeof Blob<"u"?Blob:null,FF=(()=>{let t;return typeof navigator<"u"&&((t=navigator.product)==="ReactNative"||t==="NativeScript"||t==="NS")?!1:typeof window<"u"&&typeof document<"u"})(),DF=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),Br={isBrowser:!0,classes:{URLSearchParams:jF,FormData:NF,Blob:PF},isStandardBrowserEnv:FF,isStandardBrowserWebWorkerEnv:DF,protocols:["http","https","file","blob","url","data"]};function OF(t,e){return Hf(t,new Br.classes.URLSearchParams,Object.assign({visitor:function(n,r,s,i){return Br.isNode&&R.isBuffer(n)?(this.append(r,n.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)}},e))}function MF(t){return R.matchAll(/\w+|\[(\w*)]/g,t).map(e=>e[0]==="[]"?"":e[1]||e[0])}function LF(t){const e={},n=Object.keys(t);let r;const s=n.length;let i;for(r=0;r<s;r++)i=n[r],e[i]=t[i];return e}function YT(t){function e(n,r,s,i){let a=n[i++];const l=Number.isFinite(+a),c=i>=n.length;return a=!a&&R.isArray(s)?s.length:a,c?(R.hasOwnProp(s,a)?s[a]=[s[a],r]:s[a]=r,!l):((!s[a]||!R.isObject(s[a]))&&(s[a]=[]),e(n,r,s[a],i)&&R.isArray(s[a])&&(s[a]=LF(s[a])),!l)}if(R.isFormData(t)&&R.isFunction(t.entries)){const n={};return R.forEachEntry(t,(r,s)=>{e(MF(r),s,n,0)}),n}return null}function $F(t,e,n){if(R.isString(t))try{return(e||JSON.parse)(t),R.trim(t)}catch(r){if(r.name!=="SyntaxError")throw r}return(n||JSON.stringify)(t)}const rv={transitional:XT,adapter:["xhr","http"],transformRequest:[function(e,n){const r=n.getContentType()||"",s=r.indexOf("application/json")>-1,i=R.isObject(e);if(i&&R.isHTMLForm(e)&&(e=new FormData(e)),R.isFormData(e))return s&&s?JSON.stringify(YT(e)):e;if(R.isArrayBuffer(e)||R.isBuffer(e)||R.isStream(e)||R.isFile(e)||R.isBlob(e))return e;if(R.isArrayBufferView(e))return e.buffer;if(R.isURLSearchParams(e))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let l;if(i){if(r.indexOf("application/x-www-form-urlencoded")>-1)return OF(e,this.formSerializer).toString();if((l=R.isFileList(e))||r.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return Hf(l?{"files[]":e}:e,c&&new c,this.formSerializer)}}return i||s?(n.setContentType("application/json",!1),$F(e)):e}],transformResponse:[function(e){const n=this.transitional||rv.transitional,r=n&&n.forcedJSONParsing,s=this.responseType==="json";if(e&&R.isString(e)&&(r&&!this.responseType||s)){const a=!(n&&n.silentJSONParsing)&&s;try{return JSON.parse(e)}catch(l){if(a)throw l.name==="SyntaxError"?ye.from(l,ye.ERR_BAD_RESPONSE,this,null,this.response):l}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Br.classes.FormData,Blob:Br.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};R.forEach(["delete","get","head","post","put","patch"],t=>{rv.headers[t]={}});const sv=rv,zF=R.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),BF=t=>{const e={};let n,r,s;return t&&t.split(`
`).forEach(function(a){s=a.indexOf(":"),n=a.substring(0,s).trim().toLowerCase(),r=a.substring(s+1).trim(),!(!n||e[n]&&zF[n])&&(n==="set-cookie"?e[n]?e[n].push(r):e[n]=[r]:e[n]=e[n]?e[n]+", "+r:r)}),e},lS=Symbol("internals");function jl(t){return t&&String(t).trim().toLowerCase()}function qd(t){return t===!1||t==null?t:R.isArray(t)?t.map(qd):String(t)}function UF(t){const e=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(t);)e[r[1]]=r[2];return e}const VF=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function Qp(t,e,n,r,s){if(R.isFunction(r))return r.call(this,e,n);if(s&&(e=n),!!R.isString(e)){if(R.isString(r))return e.indexOf(r)!==-1;if(R.isRegExp(r))return r.test(e)}}function HF(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,n,r)=>n.toUpperCase()+r)}function WF(t,e){const n=R.toCamelCase(" "+e);["get","set","has"].forEach(r=>{Object.defineProperty(t,r+n,{value:function(s,i,a){return this[r].call(this,e,s,i,a)},configurable:!0})})}class Wf{constructor(e){e&&this.set(e)}set(e,n,r){const s=this;function i(l,c,u){const d=jl(c);if(!d)throw new Error("header name must be a non-empty string");const h=R.findKey(s,d);(!h||s[h]===void 0||u===!0||u===void 0&&s[h]!==!1)&&(s[h||c]=qd(l))}const a=(l,c)=>R.forEach(l,(u,d)=>i(u,d,c));return R.isPlainObject(e)||e instanceof this.constructor?a(e,n):R.isString(e)&&(e=e.trim())&&!VF(e)?a(BF(e),n):e!=null&&i(n,e,r),this}get(e,n){if(e=jl(e),e){const r=R.findKey(this,e);if(r){const s=this[r];if(!n)return s;if(n===!0)return UF(s);if(R.isFunction(n))return n.call(this,s,r);if(R.isRegExp(n))return n.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,n){if(e=jl(e),e){const r=R.findKey(this,e);return!!(r&&this[r]!==void 0&&(!n||Qp(this,this[r],r,n)))}return!1}delete(e,n){const r=this;let s=!1;function i(a){if(a=jl(a),a){const l=R.findKey(r,a);l&&(!n||Qp(r,r[l],l,n))&&(delete r[l],s=!0)}}return R.isArray(e)?e.forEach(i):i(e),s}clear(e){const n=Object.keys(this);let r=n.length,s=!1;for(;r--;){const i=n[r];(!e||Qp(this,this[i],i,e,!0))&&(delete this[i],s=!0)}return s}normalize(e){const n=this,r={};return R.forEach(this,(s,i)=>{const a=R.findKey(r,i);if(a){n[a]=qd(s),delete n[i];return}const l=e?HF(i):String(i).trim();l!==i&&delete n[i],n[l]=qd(s),r[l]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const n=Object.create(null);return R.forEach(this,(r,s)=>{r!=null&&r!==!1&&(n[s]=e&&R.isArray(r)?r.join(", "):r)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,n])=>e+": "+n).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...n){const r=new this(e);return n.forEach(s=>r.set(s)),r}static accessor(e){const r=(this[lS]=this[lS]={accessors:{}}).accessors,s=this.prototype;function i(a){const l=jl(a);r[l]||(WF(s,a),r[l]=!0)}return R.isArray(e)?e.forEach(i):i(e),this}}Wf.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);R.reduceDescriptors(Wf.prototype,({value:t},e)=>{let n=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(r){this[n]=r}}});R.freezeMethods(Wf);const ks=Wf;function Kp(t,e){const n=this||sv,r=e||n,s=ks.from(r.headers);let i=r.data;return R.forEach(t,function(l){i=l.call(n,i,s.normalize(),e?e.status:void 0)}),s.normalize(),i}function JT(t){return!!(t&&t.__CANCEL__)}function hu(t,e,n){ye.call(this,t??"canceled",ye.ERR_CANCELED,e,n),this.name="CanceledError"}R.inherits(hu,ye,{__CANCEL__:!0});function qF(t,e,n){const r=n.config.validateStatus;!n.status||!r||r(n.status)?t(n):e(new ye("Request failed with status code "+n.status,[ye.ERR_BAD_REQUEST,ye.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}const GF=Br.isStandardBrowserEnv?function(){return{write:function(n,r,s,i,a,l){const c=[];c.push(n+"="+encodeURIComponent(r)),R.isNumber(s)&&c.push("expires="+new Date(s).toGMTString()),R.isString(i)&&c.push("path="+i),R.isString(a)&&c.push("domain="+a),l===!0&&c.push("secure"),document.cookie=c.join("; ")},read:function(n){const r=document.cookie.match(new RegExp("(^|;\\s*)("+n+")=([^;]*)"));return r?decodeURIComponent(r[3]):null},remove:function(n){this.write(n,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}();function QF(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function KF(t,e){return e?t.replace(/\/+$/,"")+"/"+e.replace(/^\/+/,""):t}function ZT(t,e){return t&&!QF(e)?KF(t,e):e}const XF=Br.isStandardBrowserEnv?function(){const e=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");let r;function s(i){let a=i;return e&&(n.setAttribute("href",a),a=n.href),n.setAttribute("href",a),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:n.pathname.charAt(0)==="/"?n.pathname:"/"+n.pathname}}return r=s(window.location.href),function(a){const l=R.isString(a)?s(a):a;return l.protocol===r.protocol&&l.host===r.host}}():function(){return function(){return!0}}();function YF(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}function JF(t,e){t=t||10;const n=new Array(t),r=new Array(t);let s=0,i=0,a;return e=e!==void 0?e:1e3,function(c){const u=Date.now(),d=r[i];a||(a=u),n[s]=c,r[s]=u;let h=i,m=0;for(;h!==s;)m+=n[h++],h=h%t;if(s=(s+1)%t,s===i&&(i=(i+1)%t),u-a<e)return;const p=d&&u-d;return p?Math.round(m*1e3/p):void 0}}function cS(t,e){let n=0;const r=JF(50,250);return s=>{const i=s.loaded,a=s.lengthComputable?s.total:void 0,l=i-n,c=r(l),u=i<=a;n=i;const d={loaded:i,total:a,progress:a?i/a:void 0,bytes:l,rate:c||void 0,estimated:c&&a&&u?(a-i)/c:void 0,event:s};d[e?"download":"upload"]=!0,t(d)}}const ZF=typeof XMLHttpRequest<"u",eD=ZF&&function(t){return new Promise(function(n,r){let s=t.data;const i=ks.from(t.headers).normalize(),a=t.responseType;let l;function c(){t.cancelToken&&t.cancelToken.unsubscribe(l),t.signal&&t.signal.removeEventListener("abort",l)}let u;R.isFormData(s)&&(Br.isStandardBrowserEnv||Br.isStandardBrowserWebWorkerEnv?i.setContentType(!1):i.getContentType(/^\s*multipart\/form-data/)?R.isString(u=i.getContentType())&&i.setContentType(u.replace(/^\s*(multipart\/form-data);+/,"$1")):i.setContentType("multipart/form-data"));let d=new XMLHttpRequest;if(t.auth){const g=t.auth.username||"",y=t.auth.password?unescape(encodeURIComponent(t.auth.password)):"";i.set("Authorization","Basic "+btoa(g+":"+y))}const h=ZT(t.baseURL,t.url);d.open(t.method.toUpperCase(),KT(h,t.params,t.paramsSerializer),!0),d.timeout=t.timeout;function m(){if(!d)return;const g=ks.from("getAllResponseHeaders"in d&&d.getAllResponseHeaders()),_={data:!a||a==="text"||a==="json"?d.responseText:d.response,status:d.status,statusText:d.statusText,headers:g,config:t,request:d};qF(function(x){n(x),c()},function(x){r(x),c()},_),d=null}if("onloadend"in d?d.onloadend=m:d.onreadystatechange=function(){!d||d.readyState!==4||d.status===0&&!(d.responseURL&&d.responseURL.indexOf("file:")===0)||setTimeout(m)},d.onabort=function(){d&&(r(new ye("Request aborted",ye.ECONNABORTED,t,d)),d=null)},d.onerror=function(){r(new ye("Network Error",ye.ERR_NETWORK,t,d)),d=null},d.ontimeout=function(){let y=t.timeout?"timeout of "+t.timeout+"ms exceeded":"timeout exceeded";const _=t.transitional||XT;t.timeoutErrorMessage&&(y=t.timeoutErrorMessage),r(new ye(y,_.clarifyTimeoutError?ye.ETIMEDOUT:ye.ECONNABORTED,t,d)),d=null},Br.isStandardBrowserEnv){const g=XF(h)&&t.xsrfCookieName&&GF.read(t.xsrfCookieName);g&&i.set(t.xsrfHeaderName,g)}s===void 0&&i.setContentType(null),"setRequestHeader"in d&&R.forEach(i.toJSON(),function(y,_){d.setRequestHeader(_,y)}),R.isUndefined(t.withCredentials)||(d.withCredentials=!!t.withCredentials),a&&a!=="json"&&(d.responseType=t.responseType),typeof t.onDownloadProgress=="function"&&d.addEventListener("progress",cS(t.onDownloadProgress,!0)),typeof t.onUploadProgress=="function"&&d.upload&&d.upload.addEventListener("progress",cS(t.onUploadProgress)),(t.cancelToken||t.signal)&&(l=g=>{d&&(r(!g||g.type?new hu(null,t,d):g),d.abort(),d=null)},t.cancelToken&&t.cancelToken.subscribe(l),t.signal&&(t.signal.aborted?l():t.signal.addEventListener("abort",l)));const p=YF(h);if(p&&Br.protocols.indexOf(p)===-1){r(new ye("Unsupported protocol "+p+":",ye.ERR_BAD_REQUEST,t));return}d.send(s||null)})},Q0={http:TF,xhr:eD};R.forEach(Q0,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch{}Object.defineProperty(t,"adapterName",{value:e})}});const uS=t=>`- ${t}`,tD=t=>R.isFunction(t)||t===null||t===!1,eI={getAdapter:t=>{t=R.isArray(t)?t:[t];const{length:e}=t;let n,r;const s={};for(let i=0;i<e;i++){n=t[i];let a;if(r=n,!tD(n)&&(r=Q0[(a=String(n)).toLowerCase()],r===void 0))throw new ye(`Unknown adapter '${a}'`);if(r)break;s[a||"#"+i]=r}if(!r){const i=Object.entries(s).map(([l,c])=>`adapter ${l} `+(c===!1?"is not supported by the environment":"is not available in the build"));let a=e?i.length>1?`since :
`+i.map(uS).join(`
`):" "+uS(i[0]):"as no adapter specified";throw new ye("There is no suitable adapter to dispatch the request "+a,"ERR_NOT_SUPPORT")}return r},adapters:Q0};function Xp(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new hu(null,t)}function dS(t){return Xp(t),t.headers=ks.from(t.headers),t.data=Kp.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),eI.getAdapter(t.adapter||sv.adapter)(t).then(function(r){return Xp(t),r.data=Kp.call(t,t.transformResponse,r),r.headers=ks.from(r.headers),r},function(r){return JT(r)||(Xp(t),r&&r.response&&(r.response.data=Kp.call(t,t.transformResponse,r.response),r.response.headers=ks.from(r.response.headers))),Promise.reject(r)})}const hS=t=>t instanceof ks?t.toJSON():t;function Mo(t,e){e=e||{};const n={};function r(u,d,h){return R.isPlainObject(u)&&R.isPlainObject(d)?R.merge.call({caseless:h},u,d):R.isPlainObject(d)?R.merge({},d):R.isArray(d)?d.slice():d}function s(u,d,h){if(R.isUndefined(d)){if(!R.isUndefined(u))return r(void 0,u,h)}else return r(u,d,h)}function i(u,d){if(!R.isUndefined(d))return r(void 0,d)}function a(u,d){if(R.isUndefined(d)){if(!R.isUndefined(u))return r(void 0,u)}else return r(void 0,d)}function l(u,d,h){if(h in e)return r(u,d);if(h in t)return r(void 0,u)}const c={url:i,method:i,data:i,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:l,headers:(u,d)=>s(hS(u),hS(d),!0)};return R.forEach(Object.keys(Object.assign({},t,e)),function(d){const h=c[d]||s,m=h(t[d],e[d],d);R.isUndefined(m)&&h!==l||(n[d]=m)}),n}const tI="1.6.0",iv={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{iv[t]=function(r){return typeof r===t||"a"+(e<1?"n ":" ")+t}});const fS={};iv.transitional=function(e,n,r){function s(i,a){return"[Axios v"+tI+"] Transitional option '"+i+"'"+a+(r?". "+r:"")}return(i,a,l)=>{if(e===!1)throw new ye(s(a," has been removed"+(n?" in "+n:"")),ye.ERR_DEPRECATED);return n&&!fS[a]&&(fS[a]=!0,console.warn(s(a," has been deprecated since v"+n+" and will be removed in the near future"))),e?e(i,a,l):!0}};function nD(t,e,n){if(typeof t!="object")throw new ye("options must be an object",ye.ERR_BAD_OPTION_VALUE);const r=Object.keys(t);let s=r.length;for(;s-- >0;){const i=r[s],a=e[i];if(a){const l=t[i],c=l===void 0||a(l,i,t);if(c!==!0)throw new ye("option "+i+" must be "+c,ye.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new ye("Unknown option "+i,ye.ERR_BAD_OPTION)}}const K0={assertOptions:nD,validators:iv},qs=K0.validators;class jh{constructor(e){this.defaults=e,this.interceptors={request:new oS,response:new oS}}request(e,n){typeof e=="string"?(n=n||{},n.url=e):n=e||{},n=Mo(this.defaults,n);const{transitional:r,paramsSerializer:s,headers:i}=n;r!==void 0&&K0.assertOptions(r,{silentJSONParsing:qs.transitional(qs.boolean),forcedJSONParsing:qs.transitional(qs.boolean),clarifyTimeoutError:qs.transitional(qs.boolean)},!1),s!=null&&(R.isFunction(s)?n.paramsSerializer={serialize:s}:K0.assertOptions(s,{encode:qs.function,serialize:qs.function},!0)),n.method=(n.method||this.defaults.method||"get").toLowerCase();let a=i&&R.merge(i.common,i[n.method]);i&&R.forEach(["delete","get","head","post","put","patch","common"],g=>{delete i[g]}),n.headers=ks.concat(a,i);const l=[];let c=!0;this.interceptors.request.forEach(function(y){typeof y.runWhen=="function"&&y.runWhen(n)===!1||(c=c&&y.synchronous,l.unshift(y.fulfilled,y.rejected))});const u=[];this.interceptors.response.forEach(function(y){u.push(y.fulfilled,y.rejected)});let d,h=0,m;if(!c){const g=[dS.bind(this),void 0];for(g.unshift.apply(g,l),g.push.apply(g,u),m=g.length,d=Promise.resolve(n);h<m;)d=d.then(g[h++],g[h++]);return d}m=l.length;let p=n;for(h=0;h<m;){const g=l[h++],y=l[h++];try{p=g(p)}catch(_){y.call(this,_);break}}try{d=dS.call(this,p)}catch(g){return Promise.reject(g)}for(h=0,m=u.length;h<m;)d=d.then(u[h++],u[h++]);return d}getUri(e){e=Mo(this.defaults,e);const n=ZT(e.baseURL,e.url);return KT(n,e.params,e.paramsSerializer)}}R.forEach(["delete","get","head","options"],function(e){jh.prototype[e]=function(n,r){return this.request(Mo(r||{},{method:e,url:n,data:(r||{}).data}))}});R.forEach(["post","put","patch"],function(e){function n(r){return function(i,a,l){return this.request(Mo(l||{},{method:e,headers:r?{"Content-Type":"multipart/form-data"}:{},url:i,data:a}))}}jh.prototype[e]=n(),jh.prototype[e+"Form"]=n(!0)});const Gd=jh;class av{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(i){n=i});const r=this;this.promise.then(s=>{if(!r._listeners)return;let i=r._listeners.length;for(;i-- >0;)r._listeners[i](s);r._listeners=null}),this.promise.then=s=>{let i;const a=new Promise(l=>{r.subscribe(l),i=l}).then(s);return a.cancel=function(){r.unsubscribe(i)},a},e(function(i,a,l){r.reason||(r.reason=new hu(i,a,l),n(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const n=this._listeners.indexOf(e);n!==-1&&this._listeners.splice(n,1)}static source(){let e;return{token:new av(function(s){e=s}),cancel:e}}}const rD=av;function sD(t){return function(n){return t.apply(null,n)}}function iD(t){return R.isObject(t)&&t.isAxiosError===!0}const X0={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(X0).forEach(([t,e])=>{X0[e]=t});const aD=X0;function nI(t){const e=new Gd(t),n=MT(Gd.prototype.request,e);return R.extend(n,Gd.prototype,e,{allOwnKeys:!0}),R.extend(n,e,null,{allOwnKeys:!0}),n.create=function(s){return nI(Mo(t,s))},n}const yt=nI(sv);yt.Axios=Gd;yt.CanceledError=hu;yt.CancelToken=rD;yt.isCancel=JT;yt.VERSION=tI;yt.toFormData=Hf;yt.AxiosError=ye;yt.Cancel=yt.CanceledError;yt.all=function(e){return Promise.all(e)};yt.spread=sD;yt.isAxiosError=iD;yt.mergeConfig=Mo;yt.AxiosHeaders=ks;yt.formToJSON=t=>YT(R.isHTMLForm(t)?new FormData(t):t);yt.getAdapter=eI.getAdapter;yt.HttpStatusCode=aD;yt.default=yt;const oD=yt,rI=oD.create({baseURL:{}.VITE_ENDPOINT||"https://express-zingmp3-awx6.vercel.app"}),lD=(t,e)=>(e==null?void 0:e.type)==="date"?new Date(t.toDate()).toLocaleDateString():new Date(t.toDate()).toLocaleString(),cn=()=>JSON.parse(localStorage.getItem("HD-MP3")||"{}"),lt=(t,e)=>{const n=cn();return n[t]=e,localStorage.setItem("HD-MP3",JSON.stringify(n))},ki=t=>{const e=Math.floor(t/60),n=Math.round(t%60);return`${e}:${n.toString().padStart(2,"0")}`},Ns=async t=>new Promise(e=>setTimeout(e,t)),sI=(t,e)=>{t.scrollIntoView({behavior:e||"smooth",block:"center"})},jc=t=>t?"disable":"",Nc=t=>t?"hidden":"",cD=(t,e)=>t?e:"";let Qd=Ah[3];const uD=cn(),mS=uD.theme;mS&&[...Ah,...OT].forEach(t=>{t.id===mS&&(Qd=t)});const dD={theme:{...Qd,alpha:Qd.type==="light"?"[#000]/5":"[#fff]/5",text_color:Qd.type==="light"?"text-[#333]":"text-[#fff]"},isOnMobile:window.innerWidth<768,isDev:!1},hD=(t,e)=>{switch(e.type){case 0:{const n=e.payload.theme;return{...t,theme:{...n,alpha:n.type==="dark"?"[#fff]/5":"[#000]/5",text_color:n.type==="light"?"text-[#333]":"text-[#fff]"}}}}},fD=()=>{const[t,e]=f.useReducer(hD,dD),n=f.useCallback(r=>{console.log("set theme"),e({type:0,payload:{theme:r}})},[]);return{state:t,setTheme:n}},iI=f.createContext(null),mD=({children:t})=>o.jsx(iI.Provider,{value:fD(),children:t}),O=()=>{const t=f.useContext(iI);if(!t)throw new Error("ThemeProvider not provided");const{state:e,...n}=t;return{...e,...n}},pD=()=>{const[t,e]=f.useState([]);return{toasts:t,setErrorToast:s=>e(i=>[...i,{variant:"error",id:Date.now()+"",desc:s||"Somethings went wrong"}]),setSuccessToast:s=>e(i=>[...i,{variant:"success",id:Date.now()+"",desc:s||"Successful"}]),setToasts:e}},aI=f.createContext(null);function gD({children:t}){return o.jsx(aI.Provider,{value:pD(),children:t})}const oe=()=>{const t=f.useContext(aI);if(!t)throw new Error("Toast Context not provided");return t},yD=()=>{const[t,e]=f.useState([]),[n,r]=f.useState([]),s=f.useRef(!0);return{ahead:t,behind:n,setAhead:e,setBehind:r,shouldStoreLocation:s}},oI=f.createContext(null),lI=()=>{const t=f.useContext(oI);if(!t)throw new Error("Navigation context not provided");return t};function cI(){const{ahead:t,setAhead:e,setBehind:n,shouldStoreLocation:r}=lI(),s=qn(),i=f.useMemo(()=>s.pathname+s.search,[s]),a=f.useRef(!1);return f.useEffect(()=>{if(!a.current){a.current=!0;return}return()=>{r.current?(t.length&&e([]),n(l=>[...l,i])):r.current=!0}},[s.pathname]),o.jsx(o.Fragment,{})}function uI({children:t}){return o.jsx(oI.Provider,{value:yD(),children:t})}function xD(){const[t,e]=f.useState([]),[n,r]=f.useState(!1);return{uploadingSongs:t,setUploadingSongs:e,isUploading:n,setIsUploading:r,resetUploadContext:()=>{r(!1),e([])}}}const dI=f.createContext(null),vD=({children:t})=>o.jsx(dI.Provider,{value:xD(),children:t}),hI=()=>{const t=f.useContext(dI);if(!t)throw new Error("UploadSongProvider not provided");return t},wD=["Songs","Karaoke","Lyric"],_D=["Songs","Playing","Lyric"];function SD(){const[t,e]=f.useState(!1),[n,r]=f.useState(!1),[s,i]=f.useState(!1),[a,l]=f.useState("Lyric"),[c,u]=f.useState("Lyric"),[d,h]=f.useState(!1),[m,p]=f.useState(!1),g=f.useRef(null),y=f.useRef(null);return{audioRef:g,controlRef:y,isOpenFullScreen:t,isOpenSongQueue:n,idle:d,setIdle:h,setIsOpenFullScreen:e,setIsOpenSongQueue:r,setIsHasAudioEle:i,activeTab:a,setActiveTab:l,isEnableBeat:m,setIsEnableBeat:p,desktopTabs:wD,mobileActiveTab:c,setMobileActiveTab:u,mobileTabs:_D}}const fI=f.createContext(null);function ED({children:t}){return o.jsx(fI.Provider,{value:SD(),children:t})}function Mt(){const t=f.useContext(fI);if(!t)throw new Error("Player Context not provided");return t}const bD=()=>{const[t,e]=f.useState([]),[n,r]=f.useState(!1),s=f.useRef(!1);return{songLyrics:t,setSongLyrics:e,loading:n,setLoading:r,ranGetLyric:s}},mI=f.createContext(null);function pI({children:t}){return o.jsx(mI.Provider,{value:bD(),children:t})}const kD=()=>{const t=f.useContext(mI);if(!t)throw new Error("Lyric context not found");return t},TD=()=>{const[t,e]=f.useState(!1),[n,r]=f.useState(!1),[s,i]=f.useState([]);return{isChecked:t,setIsChecked:e,isSelectAll:n,setIsSelectAll:r,setSelectedSongs:i,selectedSongs:s,selectAllSong:u=>{e(!0),r(!0),i(u)},selectSong:u=>{const d=[...s],h=d.findIndex(m=>m.id===u.id);h===-1?d.push(u):d.splice(h,1),e(!!d.length),i(d)},resetSelect:()=>{e(!1),r(!1),i([])}}},gI=f.createContext(null);function Nr({children:t}){return o.jsx(gI.Provider,{value:TD(),children:t})}const il=()=>{const t=f.useContext(gI);if(!t)throw new Error("SelectSongContext not provided");return t};function yI(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t))for(e=0;e<t.length;e++)t[e]&&(n=yI(t[e]))&&(r&&(r+=" "),r+=n);else for(e in t)t[e]&&(r&&(r+=" "),r+=e);return r}function ID(){for(var t,e,n=0,r="";n<arguments.length;)(t=arguments[n++])&&(e=yI(t))&&(r&&(r+=" "),r+=e);return r}const pS=t=>typeof t=="boolean"?"".concat(t):t===0?"0":t,gS=ID,fu=(t,e)=>n=>{var r;if((e==null?void 0:e.variants)==null)return gS(t,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:s,defaultVariants:i}=e,a=Object.keys(s).map(u=>{const d=n==null?void 0:n[u],h=i==null?void 0:i[u];if(d===null)return null;const m=pS(d)||pS(h);return s[u][m]}),l=n&&Object.entries(n).reduce((u,d)=>{let[h,m]=d;return m===void 0||(u[h]=m),u},{}),c=e==null||(r=e.compoundVariants)===null||r===void 0?void 0:r.reduce((u,d)=>{let{class:h,className:m,...p}=d;return Object.entries(p).every(g=>{let[y,_]=g;return Array.isArray(_)?_.includes({...i,...l}[y]):{...i,...l}[y]===_})?[...u,h,m]:u},[]);return gS(t,a,c,n==null?void 0:n.class,n==null?void 0:n.className)};function CD({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 6h9.75M10.5 6a1.5 1.5 0 11-3 0m3 0a1.5 1.5 0 10-3 0M3.75 6H7.5m3 12h9.75m-9.75 0a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0m-3.75 0H7.5m9-6h3.75m-3.75 0a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0m-9.75 0h9.75"}))}const RD=f.forwardRef(CD),mu=RD;function AD({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3"}))}const jD=f.forwardRef(AD),qf=jD;function ND({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6a2.25 2.25 0 00-2.25 2.25v13.5A2.25 2.25 0 007.5 21h6a2.25 2.25 0 002.25-2.25V15M12 9l-3 3m0 0l3 3m-3-3h12.75"}))}const PD=f.forwardRef(ND),FD=PD;function DD({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18"}))}const OD=f.forwardRef(DD),xI=OD;function MD({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 12c0-1.232-.046-2.453-.138-3.662a4.006 4.006 0 00-3.7-3.7 48.678 48.678 0 00-7.324 0 4.006 4.006 0 00-3.7 3.7c-.017.22-.032.441-.046.662M19.5 12l3-3m-3 3l-3-3m-12 3c0 1.232.046 2.453.138 3.662a4.006 4.006 0 003.7 3.7 48.656 48.656 0 007.324 0 4.006 4.006 0 003.7-3.7c.017-.22.032-.441.046-.662M4.5 12l3 3m-3-3l-3 3"}))}const LD=f.forwardRef(MD),$D=LD;function zD({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99"}))}const BD=f.forwardRef(zD),Lt=BD;function UD({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6a2.25 2.25 0 00-2.25 2.25v13.5A2.25 2.25 0 007.5 21h6a2.25 2.25 0 002.25-2.25V15m3 0l3-3m0 0l-3-3m3 3H9"}))}const VD=f.forwardRef(UD),ov=VD;function HD({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 4.5L21 12m0 0l-7.5 7.5M21 12H3"}))}const WD=f.forwardRef(HD),qD=WD;function GD({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 18L9 11.25l4.306 4.307a11.95 11.95 0 015.814-5.519l2.74-1.22m0 0l-5.94-2.28m5.94 2.28l-2.28 5.941"}))}const QD=f.forwardRef(GD),vI=QD;function KD({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5m-13.5-9L12 3m0 0l4.5 4.5M12 3v13.5"}))}const XD=f.forwardRef(KD),lv=XD;function YD({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 16.811c0 .864-.933 1.405-1.683.977l-7.108-4.062a1.125 1.125 0 010-1.953l7.108-4.062A1.125 1.125 0 0121 8.688v8.123zM11.25 16.811c0 .864-.933 1.405-1.683.977l-7.108-4.062a1.125 1.125 0 010-1.953L9.567 7.71a1.125 1.125 0 011.683.977v8.123z"}))}const JD=f.forwardRef(YD),cv=JD;function ZD({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"}))}const eO=f.forwardRef(ZD),al=eO;function tO({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}))}const nO=f.forwardRef(tO),rO=nO;function sO({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 12.75l6 6 9-13.5"}))}const iO=f.forwardRef(sO),pu=iO;function aO({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 8.25l-7.5 7.5-7.5-7.5"}))}const oO=f.forwardRef(aO),wI=oO;function lO({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5L8.25 12l7.5-7.5"}))}const cO=f.forwardRef(lO),_I=cO;function uO({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 4.5l7.5 7.5-7.5 7.5"}))}const dO=f.forwardRef(uO),Kd=dO;function hO({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 15.75l7.5-7.5 7.5 7.5"}))}const fO=f.forwardRef(hO),mO=fO;function pO({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z"}))}const gO=f.forwardRef(pO),SI=gO;function yO({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.324.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 011.37.49l1.296 2.247a1.125 1.125 0 01-.26 1.431l-1.003.827c-.293.24-.438.613-.431.992a6.759 6.759 0 010 .255c-.007.378.138.75.43.99l1.005.828c.424.35.534.954.26 1.43l-1.298 2.247a1.125 1.125 0 01-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.57 6.57 0 01-.22.128c-.331.183-.581.495-.644.869l-.213 1.28c-.09.543-.56.941-1.11.941h-2.594c-.55 0-1.02-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 01-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 01-1.369-.49l-1.297-2.247a1.125 1.125 0 01.26-1.431l1.004-.827c.292-.24.437-.613.43-.992a6.932 6.932 0 010-.255c.007-.378-.138-.75-.43-.99l-1.004-.828a1.125 1.125 0 01-.26-1.43l1.297-2.247a1.125 1.125 0 011.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.087.22-.128.332-.183.582-.495.644-.869l.214-1.281z"}),f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}))}const xO=f.forwardRef(yO),uv=xO;function vO({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 17.25v1.007a3 3 0 01-.879 2.122L7.5 21h9l-.621-.621A3 3 0 0115 18.257V17.25m6-12V15a2.25 2.25 0 01-2.25 2.25H5.25A2.25 2.25 0 013 15V5.25m18 0A2.25 2.25 0 0018.75 3H5.25A2.25 2.25 0 003 5.25m18 0V12a2.25 2.25 0 01-2.25 2.25H5.25A2.25 2.25 0 013 12V5.25"}))}const wO=f.forwardRef(vO),dv=wO;function _O({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z"}))}const SO=f.forwardRef(_O),hv=SO;function EO({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m9-.75a9 9 0 11-18 0 9 9 0 0118 0zm-9 3.75h.008v.008H12v-.008z"}))}const bO=f.forwardRef(EO),Gf=bO;function kO({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 8.688c0-.864.933-1.405 1.683-.977l7.108 4.062a1.125 1.125 0 010 1.953l-7.108 4.062A1.125 1.125 0 013 16.81V8.688zM12.75 8.688c0-.864.933-1.405 1.683-.977l7.108 4.062a1.125 1.125 0 010 1.953l-7.108 4.062a1.125 1.125 0 01-1.683-.977V8.688z"}))}const TO=f.forwardRef(kO),Qf=TO;function IO({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12z"}))}const CO=f.forwardRef(IO),Kf=CO;function RO({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 12l8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25"}))}const AO=f.forwardRef(RO),Xf=AO;function jO({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z"}))}const NO=f.forwardRef(jO),Y0=NO;function PO({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.19 8.688a4.5 4.5 0 011.242 7.244l-4.5 4.5a4.5 4.5 0 01-6.364-6.364l1.757-1.757m13.35-.622l1.757-1.757a4.5 4.5 0 00-6.364-6.364l-4.5 4.5a4.5 4.5 0 001.242 7.244"}))}const FO=f.forwardRef(PO),DO=FO;function OO({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"}))}const MO=f.forwardRef(OO),fv=MO;function LO({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 12h-15"}))}const $O=f.forwardRef(LO),mv=$O;function zO({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 9l10.5-3m0 6.553v3.75a2.25 2.25 0 01-1.632 2.163l-1.32.377a1.803 1.803 0 11-.99-3.467l2.31-.66a2.25 2.25 0 001.632-2.163zm0 0V2.25L9 5.25v10.303m0 0v3.75a2.25 2.25 0 01-1.632 2.163l-1.32.377a1.803 1.803 0 01-.99-3.467l2.31-.66A2.25 2.25 0 009 15.553z"}))}const BO=f.forwardRef(zO),Da=BO;function UO({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 7.5h1.5m-1.5 3h1.5m-7.5 3h7.5m-7.5 3h7.5m3-9h3.375c.621 0 1.125.504 1.125 1.125V18a2.25 2.25 0 01-2.25 2.25M16.5 7.5V18a2.25 2.25 0 002.25 2.25M16.5 7.5V4.875c0-.621-.504-1.125-1.125-1.125H4.125C3.504 3.75 3 4.254 3 4.875V18a2.25 2.25 0 002.25 2.25h13.5M6 7.5h3v3H6v-3z"}))}const VO=f.forwardRef(UO),yS=VO;function HO({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.53 16.122a3 3 0 00-5.78 1.128 2.25 2.25 0 01-2.4 2.245 4.5 4.5 0 008.4-2.245c0-.399-.078-.78-.22-1.128zm0 0a15.998 15.998 0 003.388-1.62m-5.043-.025a15.994 15.994 0 011.622-3.395m3.42 3.42a15.995 15.995 0 004.764-4.648l3.876-5.814a1.151 1.151 0 00-1.597-1.597L14.146 6.32a15.996 15.996 0 00-4.649 4.763m3.42 3.42a6.776 6.776 0 00-3.42-3.42"}))}const WO=f.forwardRef(HO),J0=WO;function qO({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.25 9v6m-4.5 0V9M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}))}const GO=f.forwardRef(qO),pv=GO;function QO({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 5.25v13.5m-7.5-13.5v13.5"}))}const KO=f.forwardRef(QO),Yf=KO;function XO({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125"}))}const YO=f.forwardRef(XO),Oa=YO;function JO({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 15.75l5.159-5.159a2.25 2.25 0 013.182 0l5.159 5.159m-1.5-1.5l1.409-1.409a2.25 2.25 0 013.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 001.5-1.5V6a1.5 1.5 0 00-1.5-1.5H3.75A1.5 1.5 0 002.25 6v12a1.5 1.5 0 001.5 1.5zm10.5-11.25h.008v.008h-.008V8.25zm.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0z"}))}const ZO=f.forwardRef(JO),ol=ZO;function eM({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}),f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.91 11.672a.375.375 0 010 .656l-5.603 3.113a.375.375 0 01-.557-.328V8.887c0-.286.307-.466.557-.327l5.603 3.112z"}))}const tM=f.forwardRef(eM),gv=tM;function nM({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 5.653c0-.856.917-1.398 1.667-.986l11.54 6.348a1.125 1.125 0 010 1.971l-11.54 6.347a1.125 1.125 0 01-1.667-.985V5.653z"}))}const rM=f.forwardRef(nM),Pc=rM;function sM({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"}))}const iM=f.forwardRef(sM),ls=iM;function aM({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442-.745.361-1.45.999-1.45 1.827v.75M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9 5.25h.008v.008H12v-.008z"}))}const oM=f.forwardRef(aM),EI=oM;function lM({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 12h16.5m-16.5 3.75h16.5M3.75 19.5h16.5M5.625 4.5h12.75a1.875 1.875 0 010 3.75H5.625a1.875 1.875 0 010-3.75z"}))}const cM=f.forwardRef(lM),uM=cM;function dM({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 7.125C2.25 6.504 2.754 6 3.375 6h6c.621 0 1.125.504 1.125 1.125v3.75c0 .621-.504 1.125-1.125 1.125h-6a1.125 1.125 0 01-1.125-1.125v-3.75zM14.25 8.625c0-.621.504-1.125 1.125-1.125h5.25c.621 0 1.125.504 1.125 1.125v8.25c0 .621-.504 1.125-1.125 1.125h-5.25a1.125 1.125 0 01-1.125-1.125v-8.25zM3.75 16.125c0-.621.504-1.125 1.125-1.125h5.25c.621 0 1.125.504 1.125 1.125v2.25c0 .621-.504 1.125-1.125 1.125h-5.25a1.125 1.125 0 01-1.125-1.125v-2.25z"}))}const hM=f.forwardRef(dM),fM=hM;function mM({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7.848 8.25l1.536.887M7.848 8.25a3 3 0 11-5.196-3 3 3 0 015.196 3zm1.536.887a2.165 2.165 0 011.083 1.839c.005.351.054.695.14 1.024M9.384 9.137l2.077 1.199M7.848 15.75l1.536-.887m-1.536.887a3 3 0 11-5.196 3 3 3 0 015.196-3zm1.536-.887a2.165 2.165 0 001.083-1.838c.005-.352.054-.695.14-1.025m-1.223 2.863l2.077-1.199m0-3.328a4.323 4.323 0 012.068-1.379l5.325-1.628a4.5 4.5 0 012.48-.044l.803.215-7.794 4.5m-2.882-1.664A4.331 4.331 0 0010.607 12m3.736 0l7.794 4.5-.802.215a4.5 4.5 0 01-2.48-.043l-5.326-1.629a4.324 4.324 0 01-2.068-1.379M14.343 12l-2.882 1.664"}))}const pM=f.forwardRef(mM),bI=pM;function gM({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.114 5.636a9 9 0 010 12.728M16.463 8.288a5.25 5.25 0 010 7.424M6.75 8.25l4.72-4.72a.75.75 0 011.28.53v15.88a.75.75 0 01-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.01 9.01 0 012.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75z"}))}const yM=f.forwardRef(gM),xM=yM;function vM({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17.25 9.75L19.5 12m0 0l2.25 2.25M19.5 12l2.25-2.25M19.5 12l-2.25 2.25m-10.5-6l4.72-4.72a.75.75 0 011.28.531V19.94a.75.75 0 01-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.506-1.938-1.354A9.01 9.01 0 012.25 12c0-.83.112-1.633.322-2.395C2.806 8.757 3.63 8.25 4.51 8.25H6.75z"}))}const wM=f.forwardRef(vM),_M=wM;function SM({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 7.5A2.25 2.25 0 017.5 5.25h9a2.25 2.25 0 012.25 2.25v9a2.25 2.25 0 01-2.25 2.25h-9a2.25 2.25 0 01-2.25-2.25v-9z"}))}const EM=f.forwardRef(SM),kI=EM;function bM({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"}))}const kM=f.forwardRef(bM),Gn=kM;function TM({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z"}))}const IM=f.forwardRef(TM),CM=IM;function RM({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"}))}const AM=f.forwardRef(RM),Mi=AM,jM=fu("inline-flex space-x-1 font-[500] items-center ",{variants:{variant:{default:"",circle:"rounded-full",list:"flex items-center py-[5px] w-full",outline:"border rounded-full",primary:""},color:{primary:"primary",clear:""},size:{primary:"px-4 py-1.5",small:"px-2 py-1",half:"w-1/2",full:"w-full",clear:""},rounded:{full:"rounded-full",md:"rounded-md",clear:""},hover:{default:"hover:brightness-90",scale:"transition-transform hover:scale-[1.05]",clear:""}},defaultVariants:{variant:"default",size:"primary",hover:"default",rounded:"full",color:"clear"}});function NM({className:t,children:e,variant:n,size:r,disabled:s,isLoading:i,rounded:a,color:l,hover:c,onClick:u,...d},h){const{theme:m}=O();return o.jsxs("button",{ref:h,type:"button",onClick:p=>u?u(p):"",...d,className:`${l==="primary"?m.content_bg:""}  ${jM({variant:n,size:r,hover:c,rounded:a,className:t})}`,disabled:i||s,children:[i?o.jsx(Lt,{className:"w-6 animate-spin"}):null,!i&&e]})}const ee=f.forwardRef(NM);function PM({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{fillRule:"evenodd",d:"M10 17a.75.75 0 01-.75-.75V5.612L5.29 9.77a.75.75 0 01-1.08-1.04l5.25-5.5a.75.75 0 011.08 0l5.25 5.5a.75.75 0 11-1.08 1.04l-3.96-4.158V16.25A.75.75 0 0110 17z",clipRule:"evenodd"}))}const FM=f.forwardRef(PM),DM=FM;function OM({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{fillRule:"evenodd",d:"M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.05-.143z",clipRule:"evenodd"}))}const MM=f.forwardRef(OM),yv=MM;function LM({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{d:"M9.653 16.915l-.005-.003-.019-.01a20.759 20.759 0 01-1.162-.682 22.045 22.045 0 01-2.582-1.9C4.045 12.733 2 10.352 2 7.5a4.5 4.5 0 018-2.828A4.5 4.5 0 0118 7.5c0 2.852-2.044 5.233-3.885 6.82a22.049 22.049 0 01-3.744 2.582l-.019.01-.005.003h-.002a.739.739 0 01-.69.001l-.002-.001z"}))}const $M=f.forwardRef(LM),xv=$M;function zM({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{d:"M5.75 3a.75.75 0 00-.75.75v12.5c0 .414.336.75.75.75h1.5a.75.75 0 00.75-.75V3.75A.75.75 0 007.25 3h-1.5zM12.75 3a.75.75 0 00-.75.75v12.5c0 .414.336.75.75.75h1.5a.75.75 0 00.75-.75V3.75a.75.75 0 00-.75-.75h-1.5z"}))}const BM=f.forwardRef(zM),UM=BM;function VM({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{d:"M5.433 13.917l1.262-3.155A4 4 0 017.58 9.42l6.92-6.918a2.121 2.121 0 013 3l-6.92 6.918c-.383.383-.84.685-1.343.886l-3.154 1.262a.5.5 0 01-.65-.65z"}),f.createElement("path",{d:"M3.5 5.75c0-.69.56-1.25 1.25-1.25H10A.75.75 0 0010 3H4.75A2.75 2.75 0 002 5.75v9.5A2.75 2.75 0 004.75 18h9.5A2.75 2.75 0 0017 15.25V10a.75.75 0 00-1.5 0v5.25c0 .69-.56 1.25-1.25 1.25h-9.5c-.69 0-1.25-.56-1.25-1.25v-9.5z"}))}const HM=f.forwardRef(VM),WM=HM;function qM({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{d:"M6.3 2.841A1.5 1.5 0 004 4.11V15.89a1.5 1.5 0 002.3 1.269l9.344-5.89a1.5 1.5 0 000-2.538L6.3 2.84z"}))}const GM=f.forwardRef(qM),xS=GM;function QM({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{d:"M10.75 4.75a.75.75 0 00-1.5 0v4.5h-4.5a.75.75 0 000 1.5h4.5v4.5a.75.75 0 001.5 0v-4.5h4.5a.75.75 0 000-1.5h-4.5v-4.5z"}))}const KM=f.forwardRef(QM),cs=KM;function XM({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{d:"M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"}))}const YM=f.forwardRef(XM),TI=YM;function $t({close:t,title:e}){return o.jsxs("div",{className:"flex justify-between mb-3",children:[o.jsx("div",{className:"text-xl leading-[2.2] font-playwriteCU",children:e}),o.jsx("button",{onClick:t,children:o.jsx(TI,{className:"w-7"})})]})}function vv({close:t}){return o.jsxs("div",{className:"w-[400px] max-w-[calc(90vw-40px)]",children:[o.jsx($t,{close:t,title:"HD MP3"}),o.jsxs("p",{children:[o.jsx("span",{className:"font-[500]",children:"Technologies: "})," React, Tailwind Css, Google firebase"]})]})}function Yp({onClick:t,theme:e,active:n}){return o.jsx(o.Fragment,{children:o.jsxs("div",{className:"w-[25%] px-2 mt-3 max-[549px]:w-[50%]",children:[o.jsx("div",{onClick:()=>t(e),className:`relative border-l-[20px] ${e.content_border} pt-[100%] rounded-xl ${e.side_bar_bg} ${n?e.content_border:""}`,children:n&&o.jsx("div",{className:"absolute bottom-[10px] right-[10px]",children:o.jsx(rO,{className:`${e.content_text} w-[25px]`})})}),o.jsx("p",{className:"text-base font-[500] mt-1",children:e.name})]})})}function wv({close:t}){const{theme:e,setTheme:n}=O(),r=c=>{lt("theme",c.id),n(c)},s={songItemContainer:`w-full border-b border-${e.alpha} last:border-none`,icon:"w-6 h-6 mr-2 inline",popupWrapper:"w-[900px] max-w-[calc(90vw-40px)]",themeContainer:"overflow-y-auto overflow-x-hidden no-scrollbar h-[calc(70vh-60px)]  pb-[5vh]",themeList:"flex flex-row -mx-2 -mt-3 flex-wrap",linkItem:`py-[10px] border-b border-${e.alpha} last:border-none`},i=Ah.map(c=>{const u=c.id===e.id;if(c.type==="light")return o.jsx(Yp,{active:u,theme:c,onClick:r},c.id)}),a=Ah.map(c=>{const u=c.id===e.id;if(c.type==="dark")return o.jsx(Yp,{active:u,theme:c,onClick:r},c.id)}),l=OT.map(c=>{const u=c.id===e.id;return o.jsx(Yp,{active:u,theme:c,onClick:r},c.id)});return o.jsxs("div",{className:s.popupWrapper,children:[o.jsx($t,{close:t,title:"Themes"}),o.jsxs("div",{className:s.themeContainer,children:[o.jsx("h2",{className:"text-lg font-semibold mb-[10px] mt-[30px]",children:"Specical"}),o.jsx("div",{className:s.themeList,children:l}),o.jsx("h2",{className:"text-lg font-semibold mb-[10px]",children:"Dark"}),o.jsx("div",{className:s.themeList,children:a}),o.jsx("h2",{className:"text-lg font-semibold mb-[10px] mt-[30px]",children:"Light"}),o.jsx("div",{className:s.themeList,children:i})]})]})}function Li({loading:t,callback:e,label:n,children:r,close:s,desc:i="This action cannot be undone",className:a}){const{theme:l}=O();return o.jsxs("div",{className:`${a||"w-[400px] max-w-[calc(90vw-40px)]"} ${t?"disable":""}`,children:[o.jsx("div",{className:"text-xl font-playwriteCU leading-[2.2] mb-3",children:n||"Wait a minute"}),i&&o.jsx("p",{className:"font-semibold text-lg text-red-400",children:i}),o.jsx("div",{className:"flex space-x-3 mt-5",children:r||o.jsxs(o.Fragment,{children:[o.jsx(ee,{onClick:s,className:"bg-white/10 border border-white/10 rounded-full px-3 py-0.5",variant:"primary",size:"clear",children:"Close"}),o.jsx(ee,{isLoading:t,className:`${l.content_bg} rounded-full px-3`,variant:"primary",size:"clear",onClick:e,children:"Yes, Please"})]})})]})}const JM=[3,5,7,10];function ZM({closeModal:t,active:e}){const{theme:n}=O(),r={button:`bg-[#fff]/5 ${n.content_hover_bg} ml-2 mt-2 px-3  py-1 rounded-[99px]`},s=a=>{e(a),t()},i=JM.map(a=>o.jsxs("button",{type:"button",onClick:()=>s(a),className:`${r.button} `,children:[a," songs"]},a));return o.jsxs("div",{className:"w-[300px] max-w-[calc(100vw-40px)]",children:[o.jsx($t,{close:t,title:"Sleep timer"}),o.jsx("div",{children:o.jsx("div",{className:"flex flex-wrap -mt-2 -ml-2 mb-3",children:i})})]})}function te({className:t}){const{theme:e}=O();return o.jsx("div",{className:`animate-pulse rounded-[4px] ${e.type==="light"?"bg-[#f1f1f1]":"bg-[#808080]"}  ${t}`})}const ll=[...Array(4).keys()].map(t=>o.jsxs("div",{className:"flex items-center p-[10px] border-b-[1px] border-transparent",children:[o.jsx(te,{className:"h-[18px] w-[18px]"}),o.jsx(te,{className:"h-[54px] w-[54px] ml-[10px] rounded-[4px]"}),o.jsxs("div",{className:"ml-[10px]",children:[o.jsx(te,{className:"h-[20px] mb-[5px] w-[150px]"}),o.jsx(te,{className:"h-[12px] mt-[5px] w-[100px]"})]})]},t)),II=()=>o.jsx("div",{className:"py-3",children:o.jsx(te,{className:"w-full h-[28px]"})}),_v=[...Array(2).keys()].map(t=>o.jsxs("div",{className:"p-2 w-1/2 md:w-1/4",children:[o.jsx(te,{className:"pt-[100%] rounded-lg"}),o.jsx(te,{className:"h-[21px] mt-1.5 w-3/4"}),o.jsx(te,{className:"h-[13px] mt-1 w-3/4"})]},t));var eL=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","#","$","%","*","+",",","-",".",":",";","=","?","@","[","]","^","_","{","|","}","~"],Ul=t=>{let e=0;for(let n=0;n<t.length;n++){let r=t[n],s=eL.indexOf(r);e=e*83+s}return e},Jp=t=>{let e=t/255;return e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)},Zp=t=>{let e=Math.max(0,Math.min(1,t));return e<=.0031308?Math.trunc(e*12.92*255+.5):Math.trunc((1.055*Math.pow(e,.4166666666666667)-.055)*255+.5)},tL=t=>t<0?-1:1,eg=(t,e)=>tL(t)*Math.pow(Math.abs(t),e),vS=class extends Error{constructor(e){super(e),this.name="ValidationError",this.message=e}},nL=t=>{if(!t||t.length<6)throw new vS("The blurhash string must be at least 6 characters");let e=Ul(t[0]),n=Math.floor(e/9)+1,r=e%9+1;if(t.length!==4+2*r*n)throw new vS(`blurhash length mismatch: length is ${t.length} but it should be ${4+2*r*n}`)},rL=t=>{let e=t>>16,n=t>>8&255,r=t&255;return[Jp(e),Jp(n),Jp(r)]},sL=(t,e)=>{let n=Math.floor(t/361),r=Math.floor(t/19)%19,s=t%19;return[eg((n-9)/9,2)*e,eg((r-9)/9,2)*e,eg((s-9)/9,2)*e]},iL=(t,e,n,r)=>{nL(t),r=r|1;let s=Ul(t[0]),i=Math.floor(s/9)+1,a=s%9+1,l=(Ul(t[1])+1)/166,c=new Array(a*i);for(let h=0;h<c.length;h++)if(h===0){let m=Ul(t.substring(2,6));c[h]=rL(m)}else{let m=Ul(t.substring(4+h*2,6+h*2));c[h]=sL(m,l*r)}let u=e*4,d=new Uint8ClampedArray(u*n);for(let h=0;h<n;h++)for(let m=0;m<e;m++){let p=0,g=0,y=0;for(let v=0;v<i;v++)for(let S=0;S<a;S++){let E=Math.cos(Math.PI*m*S/e)*Math.cos(Math.PI*h*v/n),b=c[S+v*a];p+=b[0]*E,g+=b[1]*E,y+=b[2]*E}let _=Zp(p),w=Zp(g),x=Zp(y);d[4*m+0+h*u]=_,d[4*m+1+h*u]=w,d[4*m+2+h*u]=x,d[4*m+3+h*u]=255}return d},aL=iL,oL=Object.defineProperty,lL=Object.defineProperties,cL=Object.getOwnPropertyDescriptors,Nh=Object.getOwnPropertySymbols,CI=Object.prototype.hasOwnProperty,RI=Object.prototype.propertyIsEnumerable,wS=(t,e,n)=>e in t?oL(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Z0=(t,e)=>{for(var n in e||(e={}))CI.call(e,n)&&wS(t,n,e[n]);if(Nh)for(var n of Nh(e))RI.call(e,n)&&wS(t,n,e[n]);return t},ey=(t,e)=>lL(t,cL(e)),AI=(t,e)=>{var n={};for(var r in t)CI.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&Nh)for(var r of Nh(t))e.indexOf(r)<0&&RI.call(t,r)&&(n[r]=t[r]);return n},jI=class extends f.PureComponent{constructor(){super(...arguments),this.canvas=null,this.handleRef=e=>{this.canvas=e,this.draw()},this.draw=()=>{let{hash:e,height:n,punch:r,width:s}=this.props;if(this.canvas){let i=aL(e,s,n,r),a=this.canvas.getContext("2d"),l=a.createImageData(s,n);l.data.set(i),a.putImageData(l,0,0)}}}componentDidUpdate(){this.draw()}render(){let e=this.props,{hash:n,height:r,width:s}=e,i=AI(e,["hash","height","width"]);return f.createElement("canvas",ey(Z0({},i),{height:r,width:s,ref:this.handleRef}))}};jI.defaultProps={height:128,width:128};var uL={position:"absolute",top:0,bottom:0,left:0,right:0,width:"100%",height:"100%"},Jf=class extends f.PureComponent{componentDidUpdate(){if(this.props.resolutionX<=0)throw new Error("resolutionX must be larger than zero");if(this.props.resolutionY<=0)throw new Error("resolutionY must be larger than zero")}render(){let e=this.props,{hash:n,height:r,width:s,punch:i,resolutionX:a,resolutionY:l,style:c}=e,u=AI(e,["hash","height","width","punch","resolutionX","resolutionY","style"]);return f.createElement("div",ey(Z0({},u),{style:ey(Z0({display:"inline-block",height:r,width:s},c),{position:"relative"})}),f.createElement(jI,{hash:n,height:l,width:a,punch:i,style:uL}))}};Jf.defaultProps={height:128,width:128,resolutionX:32,resolutionY:32};function ht({src:t,className:e="",width:n="w-full",blurHashEncode:r,onError:s}){const[i,a]=f.useState(!1),l=f.useRef(null),c=()=>{a(!0),t&&t!=null&&t.includes("blob")&&URL.revokeObjectURL(t)},u=()=>{const h=l.current;h.src="https://placehold.co/400",a(!0)},d=()=>{console.log("image error"),s?(s(),u()):u()};return o.jsxs(o.Fragment,{children:[!i&&o.jsx(o.Fragment,{children:r?o.jsx(Jf,{hash:r,height:"100%",width:"100%"}):o.jsx(te,{className:"w-full h-0"})}),o.jsx("img",{onLoad:c,onError:d,className:`${e} ${n} ${i?"":"hidden"}`,src:t||"https://placehold.co/400",ref:l})]})}function gu({children:t,className:e=""}){return o.jsx("div",{className:`pt-[100%] relative rounded-lg overflow-hidden ${e}`,children:o.jsx("div",{className:"absolute inset-0",children:t})})}const Sv="border border-black/10 placeholder:[#888] outline-none py-1.5 px-2",dL=fu("w-full",{variants:{variant:{primary:Sv,clear:""},rounded:{xl:"rounded-xl",lg:"rounded-lg",md:"rounded-md"}},defaultVariants:{variant:"primary",rounded:"md"}});function hL({variant:t,className:e="bg-white/10",...n},r){return o.jsx("input",{ref:r,className:` ${dL({variant:t,className:e})}`,...n})}const cr=f.forwardRef(hL),fL=fu("",{variants:{p:{3:"p-3",2:"p-2",1:"p-1",clear:""},rounded:{xl:"rounded-xl",lg:"rounded-lg",md:"rounded-md",sm:"rounded-sm"}},defaultVariants:{p:3,rounded:"xl"}});function zs({children:t,bg:e="primary",theme:n,className:r,p:s,rounded:i}){return o.jsx("div",{className:` ${e==="primary"?n.modal_bg:""} text-white border-[#fff]/5 border-[1px]  ${fL({p:s,rounded:i,className:r})}`,children:t})}function tg({className:t,icon:e,label:n,to:r,arrowIcon:s,children:i}){return r?o.jsxs(we,{className:`w-full flex  justify-between  ${t}`,to:r,children:[o.jsxs("div",{className:"inline-flex items-center ",children:[e,o.jsx("span",{className:"text-lg font-medium",children:n})]}),i,s&&o.jsx("span",{children:s})]}):o.jsx("p",{children:"No onClick"})}const NI="/HD-MP3/assets/simon_empty-95813d48.png";function Xe({children:t,variant:e="default",className:n=""}){const r=()=>{switch(e){case"less":return o.jsx(o.Fragment,{});case"with-home-button":return o.jsxs(o.Fragment,{children:[o.jsx("p",{className:"text-center",children:"No result found, ¯\\_(ツ)_/¯"}),o.jsx("p",{className:"text-center mt-5",children:o.jsx(we,{to:"/",children:o.jsxs(ee,{color:"primary",children:[o.jsx(Xf,{className:"w-6"}),o.jsx("span",{children:"Home"})]})})})]});case"default":return o.jsx("p",{className:"text-center",children:"No result found, ¯\\_(ツ)_/¯"})}};return o.jsxs("div",{className:`${n}`,children:[o.jsx("img",{className:"mx-auto",src:NI,alt:""}),r(),t]})}function ur({children:t}){return o.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2",children:t})}function xe({title:t,className:e=""}){return o.jsx("div",{className:`text-xl font-playwriteCU leading-[2.4] ${e}`,children:t})}function PI({colList:t,children:e,className:n=""}){const r={table:"w-full"};return o.jsxs("table",{className:`${r.table} ${n}`,children:[o.jsx("thead",{children:o.jsx("tr",{children:t.map((s,i)=>o.jsx("th",{children:s},i))})}),o.jsx("tbody",{children:e})]})}const mL=({appendOnPortal:t})=>{const[e,n]=f.useState(!1),[r,s]=f.useState(!1),i=f.useRef(null),a=f.useRef(null);return{refs:{triggerRef:i,contentRef:a},setTriggerRef:h=>{i.current=h},setContentRef:h=>{a.current=h},state:{isMounted:r,isOpen:e},setIsMounted:s,setIsOpen:n,appendOnPortal:t,close:()=>{s(!1)},toggle:()=>{r&&s(!1),e||n(!0)}}},FI=f.createContext(null),mr=()=>{const t=f.useContext(FI);return t||{}};function dr({children:t,relativeWrap:e=!0,appendOnPortal:n,...r}){return o.jsx(FI.Provider,{value:mL({...r,appendOnPortal:n}),children:n?t:o.jsx("div",{className:"relative",children:t})})}const hr=f.forwardRef(function({children:t,needButton:e,setIsOpenParent:n},r){const{refs:s,setIsMounted:i,setIsOpen:a,close:l,toggle:c,state:{isMounted:u,isOpen:d}}=mr();return f.useImperativeHandle(r,()=>({close:l})),f.useEffect(()=>{u||(n&&n(!1),setTimeout(()=>{a(!1)},400))},[u]),f.useEffect(()=>(d&&(n&&n(!0),setTimeout(()=>{i(!0)},100)),()=>{d||i(!1)}),[d]),f.useEffect(()=>{if(!d)return;const h=m=>{var p,g;!s.contentRef||!s.triggerRef||(p=s.triggerRef.current)!=null&&p.contains(m.target)||(g=s.contentRef.current)!=null&&g.contains(m.target)||i(!1)};return document.addEventListener("mousedown",h),document.addEventListener("touchstart",h),()=>{document.removeEventListener("mousedown",h),document.removeEventListener("touchstart",h)}},[d]),!e&&f.isValidElement(t)?f.cloneElement(t,{onClick:c,ref:s.triggerRef}):o.jsx("button",{ref:s.triggerRef,onClick:c,children:t})});function fr({children:t,className:e,animationClassName:n,...r}){const{state:{isMounted:s,isOpen:i},refs:a,close:l,appendOnPortal:c,setContentRef:u}=mr(),d=f.useRef(null),h=()=>{const y=a.triggerRef.current,_=a.contentRef.current,w=d.current;if(!y||!_)return;const x=y.getBoundingClientRect(),v={top:x.top+y.clientHeight,left:x.left-_.clientWidth};if(r.appendTo==="portal"){const{origin:S="top right",position:E,spacer:b=8}=r;switch(E){case"right-bottom":{v.top=x.top+y.clientHeight+b,v.left=x.left;break}}const I=v.top+_.clientHeight>window.innerHeight-90;if(I){let A=v.top-_.clientHeight-y.clientHeight;A-60<0&&(A=60),v.top=A}if(w){let A=S;I&&(A="bottom right"),w.style.transformOrigin=A}}_.style.left=`${v.left}px`,_.style.top=`${v.top}px`},m=l,p={unMountedContent:"opacity-0 scale-[.95]",mountedContent:"opacity-100 scale-[1]"},g=o.jsx("div",{ref:u,className:`popup-content ${c?"fixed z-[99]":"absolute"} ${e||""}`,children:o.jsx("div",{ref:d,className:` transition-[transform,opacity] duration-[.25s] ease-linear ${n||""} ${s?p.mountedContent:p.unMountedContent}`,children:t})});return f.useEffect(()=>{if(c)return i&&(h(),document.addEventListener("wheel",m)),()=>{document.removeEventListener("wheel",m)}},[i]),i?o.jsx(o.Fragment,{children:c?tl.createPortal(g,document.getElementById("portals")):g}):o.jsx(o.Fragment,{})}function Ph(t,e){const[n,r]=f.useState(e),s=f.useRef(!1);return f.useEffect(()=>{const i=cn()[t]||e;r(i)},[]),f.useEffect(()=>{if(!s.current){s.current=!0;return}lt(t,n)},[n]),[n,r]}function pL({audioEle:t,postLocalStorageKey:e}){const[n,r]=Ph(`audio_speed_${e}`,1),[s,i]=Ph(`audio_volume_${e}`,100);return f.useEffect(()=>{t.volume=s/100,t.playbackRate=n},[s,n]),{speed:n,setSpeed:r,volume:s,setVolume:i}}function DI({className:t="",positions:e="right",bg:n="",...r}){const{theme:s}=O(),{speed:i,volume:a,setVolume:l,setSpeed:c}=pL(r);return o.jsxs(dr,{children:[o.jsx(hr,{children:o.jsx(ee,{className:`${s.content_bg} rounded-full ${t}`,children:o.jsx(uv,{className:"w-6"})})}),o.jsx(fr,{className:`top-[calc(100%+8px)] ${e==="right"?"left-0":"right-0"} z-[9]`,appendTo:"parent",children:o.jsx(zs,{bg:"clear",className:`w-[240px] ${n||s.modal_bg} `,theme:s,children:o.jsxs("div",{className:"space-y-[6px]",children:[o.jsxs("div",{className:"flex space-x-1",children:[o.jsxs("div",{className:"w-[110px] flex-shrink-0",children:["Speed ",i,"x"]}),o.jsx("input",{className:"w-full",type:"range",step:.1,min:1,max:1.5,value:i,onChange:u=>c(+u.target.value)})]}),o.jsxs("div",{className:"flex space-x-1",children:[o.jsxs("div",{className:"w-[110px] flex-shrink-0",children:["Volume ",a,"%"]}),o.jsx("input",{className:"w-full",type:"range",step:1,min:1,max:100,value:a,onChange:u=>l(+u.target.value)})]})]})})})]})}function Zf({cb:t,active:e,className:n="",size:r="default"}){const{theme:s}=O(),i={circle:`${r==="default"?"w-[20px] h-[20px]":"w-[16px] h-[16px]"}  absolute bg-white left-[3px] rounded-[50%] transition-transform top-[50%] translate-y-[-50%]`,active:`${r==="default"?"translate-x-[14px]":"translate-x-[18px]"} `,inActive:"translate-x-[0]"};return o.jsx("div",{onClick:t,className:`relative  cursor-pointer ${r==="default"?"h-[24px]":"h-[20px]"} rounded-[99px] w-[40px] ${n||""} 
         ${e?s.content_bg:"bg-white/10"} `,children:o.jsx("div",{className:`${i.circle} ${e?i.active:i.inActive}`})})}function gL({children:t,className:e,persisted:n=!1,wrapped:r=!0,...s},i){const a=s.variant||"default",{theme:l}=O(),[c,u]=f.useState(a==="default"),[d,h]=f.useState(a==="default"),[m,p]=f.useState(n),g=()=>{d&&h(!1),c||u(!0)},y=()=>{u(!0)},_=()=>{h(!1),p(!1)},w=S=>{p(S)},x=S=>{S.preventDefault(),S.stopPropagation(),!m&&(a==="default"&&s.closeModal&&s.closeModal(),a==="animation"&&_())};f.useImperativeHandle(i,()=>({toggle:g,close:_,open:y,setModalPersist:w})),f.useEffect(()=>{a!=="default"&&(d||setTimeout(()=>{u(!1)},400))},[d]),f.useEffect(()=>{a!=="default"&&c&&setTimeout(()=>{h(!0)},100)},[c]);const v={unMountedContent:"opacity-0 scale-[.95]",mountedContent:"opacity-100 scale-[1]",unMountedLayer:"opacity-0",mountedLayer:"opacity-40"};return o.jsx(o.Fragment,{children:c&&tl.createPortal(o.jsxs("div",{className:"fixed inset-0 z-[99]",children:[o.jsx("div",{onClick:x,className:`transition-opacity duration-300 absolute bg-black inset-0 z-[90]
                             ${d?v.mountedLayer:v.unMountedLayer}
                        `}),o.jsx("div",{className:`modal-content absolute duration-300 transition-[transform,opacity] z-[99] top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2
                            ${d?v.mountedContent:v.unMountedContent}
                        `,children:r?o.jsx(zs,{className:e||"",theme:l,children:t}):t})]}),document.getElementById("portals"))})}const Ee=f.forwardRef(gL),Ev="data:image/gif;base64,R0lGODlhJAAkAIABAP///////yH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQ4IDc5LjE2NDAzNiwgMjAxOS8wOC8xMy0wMTowNjo1NyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo0NmRjOGMyNC03YmYxLTQxZTMtYjQ2Zi1mY2ZhMDk4MDE1YWYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MTBDRTc0QzlGNDBEMTFFQTk4NDZENjI0QzI1MENFQzgiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MTBDRTc0QzhGNDBEMTFFQTk4NDZENjI0QzI1MENFQzgiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6YzBhNGU4OWYtNjc4Yy00NmMyLTg4NmUtYzIxNGE0NTIwZDRjIiBzdFJlZjpkb2N1bWVudElEPSJhZG9iZTpkb2NpZDpwaG90b3Nob3A6ODRlMDBjYmEtZjhlNy03YzQ4LWE4MTgtNDc3NTI3MGQ1ZTAyIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkECQgAAQAsAAAAACQAJAAAAnKMj5nArQ9jc7HWyax+GOx/dCAojltpWmgqYazqvu0kz1StrHgYp6tO6gWAn59wZKSxkjcTM7MUEk/SY1BpmGqeHhs0W8Vywk3tkPw9iztcBLfNW7Pl9PLcXk/f8Xz9vguWB6h254Y2+Id4aLjH2Kc4UQAAIfkECQgAAQAsAAAAACQAJAAAAnSMj6nL7Q+jnAzYS+XFGW7beV/4fADpmGijrkvrJnA2z1Q9hvhG7lznA+lyBpuMGAieDiYlQulkIpvTKk9KFRatv2RW671uxeHskwv+ptHLsRnbhbLPZHW7vK6r6XF21J33Bngnp2fY98UXuNikSOg3B8dYAAAh+QQJCAABACwAAAAAJAAkAAACfIyPqcvtD6OctNqLKdg8N955C7iJI4mQAKam6NUeMTMHda3cr4EnOugCfnY2Yi8Y4hmXKqHSWYQ2mclodSqllmTY7fOqbSK9VnLXHB6Ludk2Vg1nv+Vo9zT+rc/zK3qf/wNmt8aHV0Z4aHj2l+inFqgXiQjJuKgYRnkJUgAAIfkECQgAAQAsAAAAACQAJAAAAnuMj6nL7Q+jnLTaC7K+T2/eeBkYiiQjAlyKsJh5uJYc0BRtTzgMpbsn8fFqQ4cQGCuWjqok0vA7toZR4fRJxDJHzg+Uur16s+Nt86sFM8VcdDncbZPlZvZ5fq/H82rp3m5XxZe29mfoZnWIF9hH1+gDqKiHOPhWSBlJWQAAIfkECQgAAQAsAAAAACQAJAAAAn6Mj6nL7Q8RmDTaQ+u1eW7efVg4ZqLRARIppqsZpW6pQTIbzPZd57jD6+keQQ/NuAu+esDiEkl0HlUxKerXKFKvsCTvuY0qp2Dw8IzTlslTdNf3VrO5Qiu8Hre78d/5HSpHB5imR5g3Jhi2d7OWaGbIN4j4pwjJ6Lco00gJVgAAIfkECQgAAQAsAAAAACQAJAAAAn2EH6nL7XnQmxRGULO7WHsbfRPHiQ95mRsqqQvbBqUGG29K13eYw3tMqXVAwJFOMcsIf7YeizmsLJE45ZHYtPqoPO2TWzxdZVXpOGneYqPBc7mtJnflsekaCkXry3Z61h/VtzcnyGcYN1jnRnj4dQf2V8g46QiIB0ly+bhWAAAh+QQJCAABACwAAAAAJAAkAAACfYyPqcvtD+MDtMobqt6Y7Q90C8iJCamZJ0qpCNu6Bhwen0S/JZTb+wTTpSK92c9RzBwbyRsx6BvyoEYpkCW0RLVVVDbWBSuxW7EzDPrW0OrzmPs2U+Nrevvnzs/11ib+T8ZWVufXB+g1qHZnyAhX6HhIopg4yAfZKEkpiFYAACH5BAkIAAEALAAAAAAkACQAAAJ7jI+py+0Po5y02ouB3tht3jGfFopjuYwqgK5npCLuJ8XHDEK2gZP3ywMGeqwfzZgb9mTCnRLHPAalz1k06SRefVPsEsmthrXgYnf8PZvFa7J6206z4fBs8w4t08t2at+qF6j2h+YnRxiX9ybIhrg3iOdlqDjH6Fa5qFYAACH5BAkIAAEALAAAAAAkACQAAAJ1jI+py+0Po5y02otzArxr1nmfEnIjWZ5bqh4l0Lqs8WK1HNpzcFs9/9o5fkFhg1gUQZBJWISZlECL0l3ThFMCc1lq10mzXhFT8Db6JYubam7Yffa+teVymz5O6+fyuLm+hgd39ReIxRd0d+inmLjH+GX3+FIAACH5BAUIAAEALAAAAAAkACQAAAJwjI+py+0Po5y0PoCzhVlv12EfGI5NCJgMqi5sm7zwIc9BPeOw3vKqb6oBLyUaqshB3o4diZDpSTaN0FTkWUVgo8sslbtlapXh43hqKJfP4Ko1TY574ehue24XffV0KJuf9xa4tifoZih351f4h9hRAAA7",bv=({data:t,variant:e="link",active:n,link:r})=>{const s=o.jsxs(gu,{children:[o.jsx(ht,{className:`hover:scale-[1.05] transition-transform object-cover ${n?"brightness-[90%]":""}`,src:t.image_url,blurHashEncode:t.blurhash_encode}),n&&o.jsx(ur,{children:o.jsx("img",{src:Ev,alt:"",className:"w-[30px]"})})]});return(()=>{switch(e){case"link":return o.jsxs(o.Fragment,{children:[o.jsx(we,{to:`${r||"/playlist/"+t.id}`,className:"",children:s}),o.jsx("p",{className:"text-lg font-[500] leading-[1.3] line-clamp-1 mt-1.5",children:t.name}),o.jsx("p",{className:"text-sm opacity-[.7] leading-[1.3] line-clamp-1",children:t.is_album?t.singers[0].name:t.distributor})]});case"image":return s}})()};var OI={exports:{}},MI={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Lo=f;function yL(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var xL=typeof Object.is=="function"?Object.is:yL,vL=Lo.useState,wL=Lo.useEffect,_L=Lo.useLayoutEffect,SL=Lo.useDebugValue;function EL(t,e){var n=e(),r=vL({inst:{value:n,getSnapshot:e}}),s=r[0].inst,i=r[1];return _L(function(){s.value=n,s.getSnapshot=e,ng(s)&&i({inst:s})},[t,n,e]),wL(function(){return ng(s)&&i({inst:s}),t(function(){ng(s)&&i({inst:s})})},[t]),SL(n),n}function ng(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!xL(t,n)}catch{return!0}}function bL(t,e){return e()}var kL=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?bL:EL;MI.useSyncExternalStore=Lo.useSyncExternalStore!==void 0?Lo.useSyncExternalStore:kL;OI.exports=MI;var TL=OI.exports,LI={exports:{}},$I={};/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var em=f,IL=TL;function CL(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var RL=typeof Object.is=="function"?Object.is:CL,AL=IL.useSyncExternalStore,jL=em.useRef,NL=em.useEffect,PL=em.useMemo,FL=em.useDebugValue;$I.useSyncExternalStoreWithSelector=function(t,e,n,r,s){var i=jL(null);if(i.current===null){var a={hasValue:!1,value:null};i.current=a}else a=i.current;i=PL(function(){function c(p){if(!u){if(u=!0,d=p,p=r(p),s!==void 0&&a.hasValue){var g=a.value;if(s(g,p))return h=g}return h=p}if(g=h,RL(d,p))return g;var y=r(p);return s!==void 0&&s(g,y)?g:(d=p,h=y)}var u=!1,d,h,m=n===void 0?null:n;return[function(){return c(e())},m===null?void 0:function(){return c(m())}]},[e,n,r,s]);var l=AL(t,i[0],i[1]);return NL(function(){a.hasValue=!0,a.value=l},[l]),FL(l),l};LI.exports=$I;var DL=LI.exports;function OL(t){t()}let zI=OL;const ML=t=>zI=t,LL=()=>zI,_S=Symbol.for("react-redux-context"),SS=typeof globalThis<"u"?globalThis:{};function $L(){var t;if(!f.createContext)return{};const e=(t=SS[_S])!=null?t:SS[_S]=new Map;let n=e.get(f.createContext);return n||(n=f.createContext(null),e.set(f.createContext,n)),n}const Ti=$L();function kv(t=Ti){return function(){return f.useContext(t)}}const BI=kv(),zL=()=>{throw new Error("uSES not initialized!")};let UI=zL;const BL=t=>{UI=t},UL=(t,e)=>t===e;function VL(t=Ti){const e=t===Ti?BI:kv(t);return function(r,s={}){const{equalityFn:i=UL,stabilityCheck:a=void 0,noopCheck:l=void 0}=typeof s=="function"?{equalityFn:s}:s,{store:c,subscription:u,getServerState:d,stabilityCheck:h,noopCheck:m}=e();f.useRef(!0);const p=f.useCallback({[r.name](y){return r(y)}}[r.name],[r,h,a]),g=UI(u.addNestedSub,c.getState,d||c.getState,p,i);return f.useDebugValue(g),g}}const ae=VL();var VI={exports:{}},Ae={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ct=typeof Symbol=="function"&&Symbol.for,Tv=Ct?Symbol.for("react.element"):60103,Iv=Ct?Symbol.for("react.portal"):60106,tm=Ct?Symbol.for("react.fragment"):60107,nm=Ct?Symbol.for("react.strict_mode"):60108,rm=Ct?Symbol.for("react.profiler"):60114,sm=Ct?Symbol.for("react.provider"):60109,im=Ct?Symbol.for("react.context"):60110,Cv=Ct?Symbol.for("react.async_mode"):60111,am=Ct?Symbol.for("react.concurrent_mode"):60111,om=Ct?Symbol.for("react.forward_ref"):60112,lm=Ct?Symbol.for("react.suspense"):60113,HL=Ct?Symbol.for("react.suspense_list"):60120,cm=Ct?Symbol.for("react.memo"):60115,um=Ct?Symbol.for("react.lazy"):60116,WL=Ct?Symbol.for("react.block"):60121,qL=Ct?Symbol.for("react.fundamental"):60117,GL=Ct?Symbol.for("react.responder"):60118,QL=Ct?Symbol.for("react.scope"):60119;function Qn(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case Tv:switch(t=t.type,t){case Cv:case am:case tm:case rm:case nm:case lm:return t;default:switch(t=t&&t.$$typeof,t){case im:case om:case um:case cm:case sm:return t;default:return e}}case Iv:return e}}}function HI(t){return Qn(t)===am}Ae.AsyncMode=Cv;Ae.ConcurrentMode=am;Ae.ContextConsumer=im;Ae.ContextProvider=sm;Ae.Element=Tv;Ae.ForwardRef=om;Ae.Fragment=tm;Ae.Lazy=um;Ae.Memo=cm;Ae.Portal=Iv;Ae.Profiler=rm;Ae.StrictMode=nm;Ae.Suspense=lm;Ae.isAsyncMode=function(t){return HI(t)||Qn(t)===Cv};Ae.isConcurrentMode=HI;Ae.isContextConsumer=function(t){return Qn(t)===im};Ae.isContextProvider=function(t){return Qn(t)===sm};Ae.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===Tv};Ae.isForwardRef=function(t){return Qn(t)===om};Ae.isFragment=function(t){return Qn(t)===tm};Ae.isLazy=function(t){return Qn(t)===um};Ae.isMemo=function(t){return Qn(t)===cm};Ae.isPortal=function(t){return Qn(t)===Iv};Ae.isProfiler=function(t){return Qn(t)===rm};Ae.isStrictMode=function(t){return Qn(t)===nm};Ae.isSuspense=function(t){return Qn(t)===lm};Ae.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===tm||t===am||t===rm||t===nm||t===lm||t===HL||typeof t=="object"&&t!==null&&(t.$$typeof===um||t.$$typeof===cm||t.$$typeof===sm||t.$$typeof===im||t.$$typeof===om||t.$$typeof===qL||t.$$typeof===GL||t.$$typeof===QL||t.$$typeof===WL)};Ae.typeOf=Qn;VI.exports=Ae;var KL=VI.exports,WI=KL,XL={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},YL={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},qI={};qI[WI.ForwardRef]=XL;qI[WI.Memo]=YL;var Ne={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rv=Symbol.for("react.element"),Av=Symbol.for("react.portal"),dm=Symbol.for("react.fragment"),hm=Symbol.for("react.strict_mode"),fm=Symbol.for("react.profiler"),mm=Symbol.for("react.provider"),pm=Symbol.for("react.context"),JL=Symbol.for("react.server_context"),gm=Symbol.for("react.forward_ref"),ym=Symbol.for("react.suspense"),xm=Symbol.for("react.suspense_list"),vm=Symbol.for("react.memo"),wm=Symbol.for("react.lazy"),ZL=Symbol.for("react.offscreen"),GI;GI=Symbol.for("react.module.reference");function pr(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case Rv:switch(t=t.type,t){case dm:case fm:case hm:case ym:case xm:return t;default:switch(t=t&&t.$$typeof,t){case JL:case pm:case gm:case wm:case vm:case mm:return t;default:return e}}case Av:return e}}}Ne.ContextConsumer=pm;Ne.ContextProvider=mm;Ne.Element=Rv;Ne.ForwardRef=gm;Ne.Fragment=dm;Ne.Lazy=wm;Ne.Memo=vm;Ne.Portal=Av;Ne.Profiler=fm;Ne.StrictMode=hm;Ne.Suspense=ym;Ne.SuspenseList=xm;Ne.isAsyncMode=function(){return!1};Ne.isConcurrentMode=function(){return!1};Ne.isContextConsumer=function(t){return pr(t)===pm};Ne.isContextProvider=function(t){return pr(t)===mm};Ne.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===Rv};Ne.isForwardRef=function(t){return pr(t)===gm};Ne.isFragment=function(t){return pr(t)===dm};Ne.isLazy=function(t){return pr(t)===wm};Ne.isMemo=function(t){return pr(t)===vm};Ne.isPortal=function(t){return pr(t)===Av};Ne.isProfiler=function(t){return pr(t)===fm};Ne.isStrictMode=function(t){return pr(t)===hm};Ne.isSuspense=function(t){return pr(t)===ym};Ne.isSuspenseList=function(t){return pr(t)===xm};Ne.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===dm||t===fm||t===hm||t===ym||t===xm||t===ZL||typeof t=="object"&&t!==null&&(t.$$typeof===wm||t.$$typeof===vm||t.$$typeof===mm||t.$$typeof===pm||t.$$typeof===gm||t.$$typeof===GI||t.getModuleId!==void 0)};Ne.typeOf=pr;function e6(){const t=LL();let e=null,n=null;return{clear(){e=null,n=null},notify(){t(()=>{let r=e;for(;r;)r.callback(),r=r.next})},get(){let r=[],s=e;for(;s;)r.push(s),s=s.next;return r},subscribe(r){let s=!0,i=n={callback:r,next:null,prev:n};return i.prev?i.prev.next=i:e=i,function(){!s||e===null||(s=!1,i.next?i.next.prev=i.prev:n=i.prev,i.prev?i.prev.next=i.next:e=i.next)}}}}const ES={notify(){},get:()=>[]};function t6(t,e){let n,r=ES;function s(h){return c(),r.subscribe(h)}function i(){r.notify()}function a(){d.onStateChange&&d.onStateChange()}function l(){return!!n}function c(){n||(n=e?e.addNestedSub(a):t.subscribe(a),r=e6())}function u(){n&&(n(),n=void 0,r.clear(),r=ES)}const d={addNestedSub:s,notifyNestedSubs:i,handleChangeWrapper:a,isSubscribed:l,trySubscribe:c,tryUnsubscribe:u,getListeners:()=>r};return d}const n6=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",r6=n6?f.useLayoutEffect:f.useEffect;function s6({store:t,context:e,children:n,serverState:r,stabilityCheck:s="once",noopCheck:i="once"}){const a=f.useMemo(()=>{const u=t6(t);return{store:t,subscription:u,getServerState:r?()=>r:void 0,stabilityCheck:s,noopCheck:i}},[t,r,s,i]),l=f.useMemo(()=>t.getState(),[t]);r6(()=>{const{subscription:u}=a;return u.onStateChange=u.notifyNestedSubs,u.trySubscribe(),l!==t.getState()&&u.notifyNestedSubs(),()=>{u.tryUnsubscribe(),u.onStateChange=void 0}},[a,l]);const c=e||Ti;return f.createElement(c.Provider,{value:a},n)}function QI(t=Ti){const e=t===Ti?BI:kv(t);return function(){const{store:r}=e();return r}}const i6=QI();function a6(t=Ti){const e=t===Ti?i6:QI(t);return function(){return e().dispatch}}const rn=a6();BL(DL.useSyncExternalStoreWithSelector);ML(tl.unstable_batchedUpdates);function Er(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];throw Error("[Immer] minified error nr: "+t+(n.length?" "+n.map(function(s){return"'"+s+"'"}).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function Ii(t){return!!t&&!!t[Ve]}function Ps(t){var e;return!!t&&(function(n){if(!n||typeof n!="object")return!1;var r=Object.getPrototypeOf(n);if(r===null)return!0;var s=Object.hasOwnProperty.call(r,"constructor")&&r.constructor;return s===Object||typeof s=="function"&&Function.toString.call(s)===p6}(t)||Array.isArray(t)||!!t[AS]||!!(!((e=t.constructor)===null||e===void 0)&&e[AS])||jv(t)||Nv(t))}function va(t,e,n){n===void 0&&(n=!1),cl(t)===0?(n?Object.keys:Eo)(t).forEach(function(r){n&&typeof r=="symbol"||e(r,t[r],t)}):t.forEach(function(r,s){return e(s,r,t)})}function cl(t){var e=t[Ve];return e?e.i>3?e.i-4:e.i:Array.isArray(t)?1:jv(t)?2:Nv(t)?3:0}function So(t,e){return cl(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function o6(t,e){return cl(t)===2?t.get(e):t[e]}function KI(t,e,n){var r=cl(t);r===2?t.set(e,n):r===3?t.add(n):t[e]=n}function XI(t,e){return t===e?t!==0||1/t==1/e:t!=t&&e!=e}function jv(t){return f6&&t instanceof Map}function Nv(t){return m6&&t instanceof Set}function Ji(t){return t.o||t.t}function Pv(t){if(Array.isArray(t))return Array.prototype.slice.call(t);var e=JI(t);delete e[Ve];for(var n=Eo(e),r=0;r<n.length;r++){var s=n[r],i=e[s];i.writable===!1&&(i.writable=!0,i.configurable=!0),(i.get||i.set)&&(e[s]={configurable:!0,writable:!0,enumerable:i.enumerable,value:t[s]})}return Object.create(Object.getPrototypeOf(t),e)}function Fv(t,e){return e===void 0&&(e=!1),Dv(t)||Ii(t)||!Ps(t)||(cl(t)>1&&(t.set=t.add=t.clear=t.delete=l6),Object.freeze(t),e&&va(t,function(n,r){return Fv(r,!0)},!0)),t}function l6(){Er(2)}function Dv(t){return t==null||typeof t!="object"||Object.isFrozen(t)}function Kr(t){var e=sy[t];return e||Er(18,t),e}function c6(t,e){sy[t]||(sy[t]=e)}function ty(){return Fc}function rg(t,e){e&&(Kr("Patches"),t.u=[],t.s=[],t.v=e)}function Fh(t){ny(t),t.p.forEach(u6),t.p=null}function ny(t){t===Fc&&(Fc=t.l)}function bS(t){return Fc={p:[],l:Fc,h:t,m:!0,_:0}}function u6(t){var e=t[Ve];e.i===0||e.i===1?e.j():e.g=!0}function sg(t,e){e._=e.p.length;var n=e.p[0],r=t!==void 0&&t!==n;return e.h.O||Kr("ES5").S(e,t,r),r?(n[Ve].P&&(Fh(e),Er(4)),Ps(t)&&(t=Dh(e,t),e.l||Oh(e,t)),e.u&&Kr("Patches").M(n[Ve].t,t,e.u,e.s)):t=Dh(e,n,[]),Fh(e),e.u&&e.v(e.u,e.s),t!==YI?t:void 0}function Dh(t,e,n){if(Dv(e))return e;var r=e[Ve];if(!r)return va(e,function(l,c){return kS(t,r,e,l,c,n)},!0),e;if(r.A!==t)return e;if(!r.P)return Oh(t,r.t,!0),r.t;if(!r.I){r.I=!0,r.A._--;var s=r.i===4||r.i===5?r.o=Pv(r.k):r.o,i=s,a=!1;r.i===3&&(i=new Set(s),s.clear(),a=!0),va(i,function(l,c){return kS(t,r,s,l,c,n,a)}),Oh(t,s,!1),n&&t.u&&Kr("Patches").N(r,n,t.u,t.s)}return r.o}function kS(t,e,n,r,s,i,a){if(Ii(s)){var l=Dh(t,s,i&&e&&e.i!==3&&!So(e.R,r)?i.concat(r):void 0);if(KI(n,r,l),!Ii(l))return;t.m=!1}else a&&n.add(s);if(Ps(s)&&!Dv(s)){if(!t.h.D&&t._<1)return;Dh(t,s),e&&e.A.l||Oh(t,s)}}function Oh(t,e,n){n===void 0&&(n=!1),!t.l&&t.h.D&&t.m&&Fv(e,n)}function ig(t,e){var n=t[Ve];return(n?Ji(n):t)[e]}function TS(t,e){if(e in t)for(var n=Object.getPrototypeOf(t);n;){var r=Object.getOwnPropertyDescriptor(n,e);if(r)return r;n=Object.getPrototypeOf(n)}}function Zs(t){t.P||(t.P=!0,t.l&&Zs(t.l))}function ag(t){t.o||(t.o=Pv(t.t))}function ry(t,e,n){var r=jv(e)?Kr("MapSet").F(e,n):Nv(e)?Kr("MapSet").T(e,n):t.O?function(s,i){var a=Array.isArray(s),l={i:a?1:0,A:i?i.A:ty(),P:!1,I:!1,R:{},l:i,t:s,k:null,o:null,j:null,C:!1},c=l,u=Dc;a&&(c=[l],u=Vl);var d=Proxy.revocable(c,u),h=d.revoke,m=d.proxy;return l.k=m,l.j=h,m}(e,n):Kr("ES5").J(e,n);return(n?n.A:ty()).p.push(r),r}function d6(t){return Ii(t)||Er(22,t),function e(n){if(!Ps(n))return n;var r,s=n[Ve],i=cl(n);if(s){if(!s.P&&(s.i<4||!Kr("ES5").K(s)))return s.t;s.I=!0,r=IS(n,i),s.I=!1}else r=IS(n,i);return va(r,function(a,l){s&&o6(s.t,a)===l||KI(r,a,e(l))}),i===3?new Set(r):r}(t)}function IS(t,e){switch(e){case 2:return new Map(t);case 3:return Array.from(t)}return Pv(t)}function h6(){function t(i,a){var l=s[i];return l?l.enumerable=a:s[i]=l={configurable:!0,enumerable:a,get:function(){var c=this[Ve];return Dc.get(c,i)},set:function(c){var u=this[Ve];Dc.set(u,i,c)}},l}function e(i){for(var a=i.length-1;a>=0;a--){var l=i[a][Ve];if(!l.P)switch(l.i){case 5:r(l)&&Zs(l);break;case 4:n(l)&&Zs(l)}}}function n(i){for(var a=i.t,l=i.k,c=Eo(l),u=c.length-1;u>=0;u--){var d=c[u];if(d!==Ve){var h=a[d];if(h===void 0&&!So(a,d))return!0;var m=l[d],p=m&&m[Ve];if(p?p.t!==h:!XI(m,h))return!0}}var g=!!a[Ve];return c.length!==Eo(a).length+(g?0:1)}function r(i){var a=i.k;if(a.length!==i.t.length)return!0;var l=Object.getOwnPropertyDescriptor(a,a.length-1);if(l&&!l.get)return!0;for(var c=0;c<a.length;c++)if(!a.hasOwnProperty(c))return!0;return!1}var s={};c6("ES5",{J:function(i,a){var l=Array.isArray(i),c=function(d,h){if(d){for(var m=Array(h.length),p=0;p<h.length;p++)Object.defineProperty(m,""+p,t(p,!0));return m}var g=JI(h);delete g[Ve];for(var y=Eo(g),_=0;_<y.length;_++){var w=y[_];g[w]=t(w,d||!!g[w].enumerable)}return Object.create(Object.getPrototypeOf(h),g)}(l,i),u={i:l?5:4,A:a?a.A:ty(),P:!1,I:!1,R:{},l:a,t:i,k:c,o:null,g:!1,C:!1};return Object.defineProperty(c,Ve,{value:u,writable:!0}),c},S:function(i,a,l){l?Ii(a)&&a[Ve].A===i&&e(i.p):(i.u&&function c(u){if(u&&typeof u=="object"){var d=u[Ve];if(d){var h=d.t,m=d.k,p=d.R,g=d.i;if(g===4)va(m,function(v){v!==Ve&&(h[v]!==void 0||So(h,v)?p[v]||c(m[v]):(p[v]=!0,Zs(d)))}),va(h,function(v){m[v]!==void 0||So(m,v)||(p[v]=!1,Zs(d))});else if(g===5){if(r(d)&&(Zs(d),p.length=!0),m.length<h.length)for(var y=m.length;y<h.length;y++)p[y]=!1;else for(var _=h.length;_<m.length;_++)p[_]=!0;for(var w=Math.min(m.length,h.length),x=0;x<w;x++)m.hasOwnProperty(x)||(p[x]=!0),p[x]===void 0&&c(m[x])}}}}(i.p[0]),e(i.p))},K:function(i){return i.i===4?n(i):r(i)}})}var CS,Fc,Ov=typeof Symbol<"u"&&typeof Symbol("x")=="symbol",f6=typeof Map<"u",m6=typeof Set<"u",RS=typeof Proxy<"u"&&Proxy.revocable!==void 0&&typeof Reflect<"u",YI=Ov?Symbol.for("immer-nothing"):((CS={})["immer-nothing"]=!0,CS),AS=Ov?Symbol.for("immer-draftable"):"__$immer_draftable",Ve=Ov?Symbol.for("immer-state"):"__$immer_state",p6=""+Object.prototype.constructor,Eo=typeof Reflect<"u"&&Reflect.ownKeys?Reflect.ownKeys:Object.getOwnPropertySymbols!==void 0?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:Object.getOwnPropertyNames,JI=Object.getOwnPropertyDescriptors||function(t){var e={};return Eo(t).forEach(function(n){e[n]=Object.getOwnPropertyDescriptor(t,n)}),e},sy={},Dc={get:function(t,e){if(e===Ve)return t;var n=Ji(t);if(!So(n,e))return function(s,i,a){var l,c=TS(i,a);return c?"value"in c?c.value:(l=c.get)===null||l===void 0?void 0:l.call(s.k):void 0}(t,n,e);var r=n[e];return t.I||!Ps(r)?r:r===ig(t.t,e)?(ag(t),t.o[e]=ry(t.A.h,r,t)):r},has:function(t,e){return e in Ji(t)},ownKeys:function(t){return Reflect.ownKeys(Ji(t))},set:function(t,e,n){var r=TS(Ji(t),e);if(r!=null&&r.set)return r.set.call(t.k,n),!0;if(!t.P){var s=ig(Ji(t),e),i=s==null?void 0:s[Ve];if(i&&i.t===n)return t.o[e]=n,t.R[e]=!1,!0;if(XI(n,s)&&(n!==void 0||So(t.t,e)))return!0;ag(t),Zs(t)}return t.o[e]===n&&(n!==void 0||e in t.o)||Number.isNaN(n)&&Number.isNaN(t.o[e])||(t.o[e]=n,t.R[e]=!0),!0},deleteProperty:function(t,e){return ig(t.t,e)!==void 0||e in t.t?(t.R[e]=!1,ag(t),Zs(t)):delete t.R[e],t.o&&delete t.o[e],!0},getOwnPropertyDescriptor:function(t,e){var n=Ji(t),r=Reflect.getOwnPropertyDescriptor(n,e);return r&&{writable:!0,configurable:t.i!==1||e!=="length",enumerable:r.enumerable,value:n[e]}},defineProperty:function(){Er(11)},getPrototypeOf:function(t){return Object.getPrototypeOf(t.t)},setPrototypeOf:function(){Er(12)}},Vl={};va(Dc,function(t,e){Vl[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}}),Vl.deleteProperty=function(t,e){return Vl.set.call(this,t,e,void 0)},Vl.set=function(t,e,n){return Dc.set.call(this,t[0],e,n,t[0])};var g6=function(){function t(n){var r=this;this.O=RS,this.D=!0,this.produce=function(s,i,a){if(typeof s=="function"&&typeof i!="function"){var l=i;i=s;var c=r;return function(y){var _=this;y===void 0&&(y=l);for(var w=arguments.length,x=Array(w>1?w-1:0),v=1;v<w;v++)x[v-1]=arguments[v];return c.produce(y,function(S){var E;return(E=i).call.apply(E,[_,S].concat(x))})}}var u;if(typeof i!="function"&&Er(6),a!==void 0&&typeof a!="function"&&Er(7),Ps(s)){var d=bS(r),h=ry(r,s,void 0),m=!0;try{u=i(h),m=!1}finally{m?Fh(d):ny(d)}return typeof Promise<"u"&&u instanceof Promise?u.then(function(y){return rg(d,a),sg(y,d)},function(y){throw Fh(d),y}):(rg(d,a),sg(u,d))}if(!s||typeof s!="object"){if((u=i(s))===void 0&&(u=s),u===YI&&(u=void 0),r.D&&Fv(u,!0),a){var p=[],g=[];Kr("Patches").M(s,u,p,g),a(p,g)}return u}Er(21,s)},this.produceWithPatches=function(s,i){if(typeof s=="function")return function(u){for(var d=arguments.length,h=Array(d>1?d-1:0),m=1;m<d;m++)h[m-1]=arguments[m];return r.produceWithPatches(u,function(p){return s.apply(void 0,[p].concat(h))})};var a,l,c=r.produce(s,i,function(u,d){a=u,l=d});return typeof Promise<"u"&&c instanceof Promise?c.then(function(u){return[u,a,l]}):[c,a,l]},typeof(n==null?void 0:n.useProxies)=="boolean"&&this.setUseProxies(n.useProxies),typeof(n==null?void 0:n.autoFreeze)=="boolean"&&this.setAutoFreeze(n.autoFreeze)}var e=t.prototype;return e.createDraft=function(n){Ps(n)||Er(8),Ii(n)&&(n=d6(n));var r=bS(this),s=ry(this,n,void 0);return s[Ve].C=!0,ny(r),s},e.finishDraft=function(n,r){var s=n&&n[Ve],i=s.A;return rg(i,r),sg(void 0,i)},e.setAutoFreeze=function(n){this.D=n},e.setUseProxies=function(n){n&&!RS&&Er(20),this.O=n},e.applyPatches=function(n,r){var s;for(s=r.length-1;s>=0;s--){var i=r[s];if(i.path.length===0&&i.op==="replace"){n=i.value;break}}s>-1&&(r=r.slice(s+1));var a=Kr("Patches").$;return Ii(n)?a(n,r):this.produce(n,function(l){return a(l,r)})},t}(),Un=new g6,ZI=Un.produce;Un.produceWithPatches.bind(Un);Un.setAutoFreeze.bind(Un);Un.setUseProxies.bind(Un);Un.applyPatches.bind(Un);Un.createDraft.bind(Un);Un.finishDraft.bind(Un);function Oc(t){"@babel/helpers - typeof";return Oc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Oc(t)}function y6(t,e){if(Oc(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Oc(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function x6(t){var e=y6(t,"string");return Oc(e)==="symbol"?e:String(e)}function v6(t,e,n){return e=x6(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jS(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function NS(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?jS(Object(n),!0).forEach(function(r){v6(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):jS(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Vt(t){return"Minified Redux error #"+t+"; visit https://redux.js.org/Errors?code="+t+" for the full message or use the non-minified dev environment for full errors. "}var PS=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}(),og=function(){return Math.random().toString(36).substring(7).split("").join(".")},Mh={INIT:"@@redux/INIT"+og(),REPLACE:"@@redux/REPLACE"+og(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+og()}};function w6(t){if(typeof t!="object"||t===null)return!1;for(var e=t;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}function eC(t,e,n){var r;if(typeof e=="function"&&typeof n=="function"||typeof n=="function"&&typeof arguments[3]=="function")throw new Error(Vt(0));if(typeof e=="function"&&typeof n>"u"&&(n=e,e=void 0),typeof n<"u"){if(typeof n!="function")throw new Error(Vt(1));return n(eC)(t,e)}if(typeof t!="function")throw new Error(Vt(2));var s=t,i=e,a=[],l=a,c=!1;function u(){l===a&&(l=a.slice())}function d(){if(c)throw new Error(Vt(3));return i}function h(y){if(typeof y!="function")throw new Error(Vt(4));if(c)throw new Error(Vt(5));var _=!0;return u(),l.push(y),function(){if(_){if(c)throw new Error(Vt(6));_=!1,u();var x=l.indexOf(y);l.splice(x,1),a=null}}}function m(y){if(!w6(y))throw new Error(Vt(7));if(typeof y.type>"u")throw new Error(Vt(8));if(c)throw new Error(Vt(9));try{c=!0,i=s(i,y)}finally{c=!1}for(var _=a=l,w=0;w<_.length;w++){var x=_[w];x()}return y}function p(y){if(typeof y!="function")throw new Error(Vt(10));s=y,m({type:Mh.REPLACE})}function g(){var y,_=h;return y={subscribe:function(x){if(typeof x!="object"||x===null)throw new Error(Vt(11));function v(){x.next&&x.next(d())}v();var S=_(v);return{unsubscribe:S}}},y[PS]=function(){return this},y}return m({type:Mh.INIT}),r={dispatch:m,subscribe:h,getState:d,replaceReducer:p},r[PS]=g,r}function _6(t){Object.keys(t).forEach(function(e){var n=t[e],r=n(void 0,{type:Mh.INIT});if(typeof r>"u")throw new Error(Vt(12));if(typeof n(void 0,{type:Mh.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(Vt(13))})}function S6(t){for(var e=Object.keys(t),n={},r=0;r<e.length;r++){var s=e[r];typeof t[s]=="function"&&(n[s]=t[s])}var i=Object.keys(n),a;try{_6(n)}catch(l){a=l}return function(c,u){if(c===void 0&&(c={}),a)throw a;for(var d=!1,h={},m=0;m<i.length;m++){var p=i[m],g=n[p],y=c[p],_=g(y,u);if(typeof _>"u")throw u&&u.type,new Error(Vt(14));h[p]=_,d=d||_!==y}return d=d||i.length!==Object.keys(c).length,d?h:c}}function Lh(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.length===0?function(r){return r}:e.length===1?e[0]:e.reduce(function(r,s){return function(){return r(s.apply(void 0,arguments))}})}function E6(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(r){return function(){var s=r.apply(void 0,arguments),i=function(){throw new Error(Vt(15))},a={getState:s.getState,dispatch:function(){return i.apply(void 0,arguments)}},l=e.map(function(c){return c(a)});return i=Lh.apply(void 0,l)(s.dispatch),NS(NS({},s),{},{dispatch:i})}}}function tC(t){var e=function(r){var s=r.dispatch,i=r.getState;return function(a){return function(l){return typeof l=="function"?l(s,i,t):a(l)}}};return e}var nC=tC();nC.withExtraArgument=tC;const FS=nC;var rC=globalThis&&globalThis.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,s){r.__proto__=s}||function(r,s){for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(r[i]=s[i])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),b6=globalThis&&globalThis.__generator||function(t,e){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,s,i,a;return a={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function l(u){return function(d){return c([u,d])}}function c(u){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,s&&(i=u[0]&2?s.return:u[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,u[1])).done)return i;switch(s=0,i&&(u=[u[0]&2,i.value]),u[0]){case 0:case 1:i=u;break;case 4:return n.label++,{value:u[1],done:!1};case 5:n.label++,s=u[1],u=[0];continue;case 7:u=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(u[0]===6||u[0]===2)){n=0;continue}if(u[0]===3&&(!i||u[1]>i[0]&&u[1]<i[3])){n.label=u[1];break}if(u[0]===6&&n.label<i[1]){n.label=i[1],i=u;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(u);break}i[2]&&n.ops.pop(),n.trys.pop();continue}u=e.call(t,n)}catch(d){u=[6,d],s=0}finally{r=i=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},$o=globalThis&&globalThis.__spreadArray||function(t,e){for(var n=0,r=e.length,s=t.length;n<r;n++,s++)t[s]=e[n];return t},k6=Object.defineProperty,T6=Object.defineProperties,I6=Object.getOwnPropertyDescriptors,DS=Object.getOwnPropertySymbols,C6=Object.prototype.hasOwnProperty,R6=Object.prototype.propertyIsEnumerable,OS=function(t,e,n){return e in t?k6(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n},xi=function(t,e){for(var n in e||(e={}))C6.call(e,n)&&OS(t,n,e[n]);if(DS)for(var r=0,s=DS(e);r<s.length;r++){var n=s[r];R6.call(e,n)&&OS(t,n,e[n])}return t},lg=function(t,e){return T6(t,I6(e))},A6=function(t,e,n){return new Promise(function(r,s){var i=function(c){try{l(n.next(c))}catch(u){s(u)}},a=function(c){try{l(n.throw(c))}catch(u){s(u)}},l=function(c){return c.done?r(c.value):Promise.resolve(c.value).then(i,a)};l((n=n.apply(t,e)).next())})},j6=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?Lh:Lh.apply(null,arguments)};function N6(t){if(typeof t!="object"||t===null)return!1;var e=Object.getPrototypeOf(t);if(e===null)return!0;for(var n=e;Object.getPrototypeOf(n)!==null;)n=Object.getPrototypeOf(n);return e===n}var P6=function(t){rC(e,t);function e(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var s=t.apply(this,n)||this;return Object.setPrototypeOf(s,e.prototype),s}return Object.defineProperty(e,Symbol.species,{get:function(){return e},enumerable:!1,configurable:!0}),e.prototype.concat=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return t.prototype.concat.apply(this,n)},e.prototype.prepend=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return n.length===1&&Array.isArray(n[0])?new(e.bind.apply(e,$o([void 0],n[0].concat(this)))):new(e.bind.apply(e,$o([void 0],n.concat(this))))},e}(Array),F6=function(t){rC(e,t);function e(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var s=t.apply(this,n)||this;return Object.setPrototypeOf(s,e.prototype),s}return Object.defineProperty(e,Symbol.species,{get:function(){return e},enumerable:!1,configurable:!0}),e.prototype.concat=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return t.prototype.concat.apply(this,n)},e.prototype.prepend=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return n.length===1&&Array.isArray(n[0])?new(e.bind.apply(e,$o([void 0],n[0].concat(this)))):new(e.bind.apply(e,$o([void 0],n.concat(this))))},e}(Array);function iy(t){return Ps(t)?ZI(t,function(){}):t}function D6(t){return typeof t=="boolean"}function O6(){return function(e){return M6(e)}}function M6(t){t===void 0&&(t={});var e=t.thunk,n=e===void 0?!0:e;t.immutableCheck,t.serializableCheck;var r=new P6;return n&&(D6(n)?r.push(FS):r.push(FS.withExtraArgument(n.extraArgument))),r}var L6=!0;function $6(t){var e=O6(),n=t||{},r=n.reducer,s=r===void 0?void 0:r,i=n.middleware,a=i===void 0?e():i,l=n.devTools,c=l===void 0?!0:l,u=n.preloadedState,d=u===void 0?void 0:u,h=n.enhancers,m=h===void 0?void 0:h,p;if(typeof s=="function")p=s;else if(N6(s))p=S6(s);else throw new Error('"reducer" is a required argument, and must be a function or an object of functions that can be passed to combineReducers');var g=a;typeof g=="function"&&(g=g(e));var y=E6.apply(void 0,g),_=Lh;c&&(_=j6(xi({trace:!L6},typeof c=="object"&&c)));var w=new F6(y),x=w;Array.isArray(m)?x=$o([y],m):typeof m=="function"&&(x=m(w));var v=_.apply(void 0,x);return eC(p,d,v)}function vi(t,e){function n(){for(var r=[],s=0;s<arguments.length;s++)r[s]=arguments[s];if(e){var i=e.apply(void 0,r);if(!i)throw new Error("prepareAction did not return an object");return xi(xi({type:t,payload:i.payload},"meta"in i&&{meta:i.meta}),"error"in i&&{error:i.error})}return{type:t,payload:r[0]}}return n.toString=function(){return""+t},n.type=t,n.match=function(r){return r.type===t},n}function sC(t){var e={},n=[],r,s={addCase:function(i,a){var l=typeof i=="string"?i:i.type;if(l in e)throw new Error("addCase cannot be called with two reducers for the same action type");return e[l]=a,s},addMatcher:function(i,a){return n.push({matcher:i,reducer:a}),s},addDefaultCase:function(i){return r=i,s}};return t(s),[e,n,r]}function z6(t){return typeof t=="function"}function B6(t,e,n,r){n===void 0&&(n=[]);var s=typeof e=="function"?sC(e):[e,n,r],i=s[0],a=s[1],l=s[2],c;if(z6(t))c=function(){return iy(t())};else{var u=iy(t);c=function(){return u}}function d(h,m){h===void 0&&(h=c());var p=$o([i[m.type]],a.filter(function(g){var y=g.matcher;return y(m)}).map(function(g){var y=g.reducer;return y}));return p.filter(function(g){return!!g}).length===0&&(p=[l]),p.reduce(function(g,y){if(y)if(Ii(g)){var _=g,w=y(_,m);return w===void 0?g:w}else{if(Ps(g))return ZI(g,function(x){return y(x,m)});var w=y(g,m);if(w===void 0){if(g===null)return g;throw Error("A case reducer on a non-draftable value must not return undefined")}return w}return g},h)}return d.getInitialState=c,d}function U6(t,e){return t+"/"+e}function Mv(t){var e=t.name;if(!e)throw new Error("`name` is a required option for createSlice");typeof process<"u";var n=typeof t.initialState=="function"?t.initialState:iy(t.initialState),r=t.reducers||{},s=Object.keys(r),i={},a={},l={};s.forEach(function(d){var h=r[d],m=U6(e,d),p,g;"reducer"in h?(p=h.reducer,g=h.prepare):p=h,i[d]=p,a[m]=p,l[d]=g?vi(m,g):vi(m)});function c(){var d=typeof t.extraReducers=="function"?sC(t.extraReducers):[t.extraReducers],h=d[0],m=h===void 0?{}:h,p=d[1],g=p===void 0?[]:p,y=d[2],_=y===void 0?void 0:y,w=xi(xi({},m),a);return B6(n,function(x){for(var v in w)x.addCase(v,w[v]);for(var S=0,E=g;S<E.length;S++){var b=E[S];x.addMatcher(b.matcher,b.reducer)}_&&x.addDefaultCase(_)})}var u;return{name:e,reducer:function(d,h){return u||(u=c()),u(d,h)},actions:l,caseReducers:i,getInitialState:function(){return u||(u=c()),u.getInitialState()}}}var V6="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",H6=function(t){t===void 0&&(t=21);for(var e="",n=t;n--;)e+=V6[Math.random()*64|0];return e},W6=["name","message","stack","code"],cg=function(){function t(e,n){this.payload=e,this.meta=n}return t}(),MS=function(){function t(e,n){this.payload=e,this.meta=n}return t}(),q6=function(t){if(typeof t=="object"&&t!==null){for(var e={},n=0,r=W6;n<r.length;n++){var s=r[n];typeof t[s]=="string"&&(e[s]=t[s])}return e}return{message:String(t)}};(function(){function t(e,n,r){var s=vi(e+"/fulfilled",function(u,d,h,m){return{payload:u,meta:lg(xi({},m||{}),{arg:h,requestId:d,requestStatus:"fulfilled"})}}),i=vi(e+"/pending",function(u,d,h){return{payload:void 0,meta:lg(xi({},h||{}),{arg:d,requestId:u,requestStatus:"pending"})}}),a=vi(e+"/rejected",function(u,d,h,m,p){return{payload:m,error:(r&&r.serializeError||q6)(u||"Rejected"),meta:lg(xi({},p||{}),{arg:h,requestId:d,rejectedWithValue:!!m,requestStatus:"rejected",aborted:(u==null?void 0:u.name)==="AbortError",condition:(u==null?void 0:u.name)==="ConditionError"})}}),l=typeof AbortController<"u"?AbortController:function(){function u(){this.signal={aborted:!1,addEventListener:function(){},dispatchEvent:function(){return!1},onabort:function(){},removeEventListener:function(){},reason:void 0,throwIfAborted:function(){}}}return u.prototype.abort=function(){},u}();function c(u){return function(d,h,m){var p=r!=null&&r.idGenerator?r.idGenerator(u):H6(),g=new l,y;function _(x){y=x,g.abort()}var w=function(){return A6(this,null,function(){var x,v,S,E,b,I,A;return b6(this,function(L){switch(L.label){case 0:return L.trys.push([0,4,,5]),E=(x=r==null?void 0:r.condition)==null?void 0:x.call(r,u,{getState:h,extra:m}),Q6(E)?[4,E]:[3,2];case 1:E=L.sent(),L.label=2;case 2:if(E===!1||g.signal.aborted)throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};return b=new Promise(function(P,ce){return g.signal.addEventListener("abort",function(){return ce({name:"AbortError",message:y||"Aborted"})})}),d(i(p,u,(v=r==null?void 0:r.getPendingMeta)==null?void 0:v.call(r,{requestId:p,arg:u},{getState:h,extra:m}))),[4,Promise.race([b,Promise.resolve(n(u,{dispatch:d,getState:h,extra:m,requestId:p,signal:g.signal,abort:_,rejectWithValue:function(P,ce){return new cg(P,ce)},fulfillWithValue:function(P,ce){return new MS(P,ce)}})).then(function(P){if(P instanceof cg)throw P;return P instanceof MS?s(P.payload,p,u,P.meta):s(P,p,u)})])];case 3:return S=L.sent(),[3,5];case 4:return I=L.sent(),S=I instanceof cg?a(null,p,u,I.payload,I.meta):a(I,p,u),[3,5];case 5:return A=r&&!r.dispatchConditionRejection&&a.match(S)&&S.meta.condition,A||d(S),[2,S]}})})}();return Object.assign(w,{abort:_,requestId:p,arg:u,unwrap:function(){return w.then(G6)}})}}return Object.assign(c,{pending:i,rejected:a,fulfilled:s,typePrefix:e})}return t.withTypes=function(){return t},t})();function G6(t){if(t.meta&&t.meta.rejectedWithValue)throw t.payload;if(t.error)throw t.error;return t.payload}function Q6(t){return t!==null&&typeof t=="object"&&typeof t.then=="function"}var Lv="listenerMiddleware";vi(Lv+"/add");vi(Lv+"/removeAll");vi(Lv+"/remove");var LS;typeof queueMicrotask=="function"&&queueMicrotask.bind(typeof window<"u"?window:typeof global<"u"?global:globalThis);h6();const K6=()=>{const t=cn();return{playStatus:"paused",triggerPlayStatus:"",lyricSize:t.lyricSize||"medium",isLoaded:!0,isRepeat:t.isRepeat||"no",isShuffle:t.isShuffle||!1,isCrossFade:t.isCrossFade||!1,songBackground:t.songBackground||!0}},iC=Mv({name:"playStatus",initialState:()=>K6(),reducers:{setPlayStatus(t,e){Object.assign(t,e.payload)},togglePlayControl(t,e){const{variant:n}=e.payload;switch(n){default:if(typeof t[n]=="boolean"){const r=!t[n];t[n]=r,lt(n,r)}}}}}),Kn=t=>t.playStatus,{setPlayStatus:Ze,togglePlayControl:X6}=iC.actions,Y6=iC.reducer;function aC({openModal:t,variant:e}){const{theme:n}=O(),r=rn(),s=d=>{t(d)},[i,a]=Ph("isCrossFade",!1),l=()=>{a(!i),r(Ze({isCrossFade:!i}))},c={menuItem:"hover:bg-[#fff]/5 rounded-md text-sm font-[500] px-2 py-2 inline-flex items-center cursor-pointer",icon:"w-5 mr-2",divide:"h-[1px]  w-[calc(100%-20px)] my-[4px] mx-auto bg-[#fff]/5"},u=()=>{switch(e){case"client":return o.jsxs(o.Fragment,{children:[o.jsxs("li",{className:`${c.menuItem} justify-between cursor-default`,children:[o.jsxs("div",{className:"flex items-center",children:[o.jsx(gv,{className:c.icon}),"Cross fade"]}),o.jsx(Zf,{active:i,cb:l})]}),o.jsxs("li",{className:`${c.menuItem}`,onClick:()=>s("theme"),children:[o.jsx(J0,{className:c.icon}),"Themes"]}),o.jsx("div",{className:c.divide}),o.jsxs("li",{className:`${c.menuItem}`,onClick:()=>s("info"),children:[o.jsx(Y0,{className:c.icon}),"Info"]})]});case"dashboard":return o.jsxs(o.Fragment,{children:[o.jsxs("li",{className:`${c.menuItem}`,onClick:()=>s("theme"),children:[o.jsx(J0,{className:c.icon}),"Themes"]}),o.jsx("div",{className:c.divide}),o.jsxs("li",{className:`${c.menuItem}`,onClick:()=>s("info"),children:[o.jsx(Y0,{className:c.icon}),"Info"]})]})}};return o.jsx(o.Fragment,{children:o.jsx(zs,{theme:n,children:o.jsx("ul",{className:"flex flex-col w-[200px]",children:u()})})})}const J6=({data:t,active:e,onClick:n,hasTitle:r,classNames:s="",idleClass:i=""},a)=>{const l={container:"flex flex-col",imageFrame:"group relative transition-[width] duration-[.3s] origin-center rounded-xl overflow-hidden",image:"select-none object-cover object-center rounded w-full",overlay:`absolute  ${e?"":"inset-0 hidden bg-black/40 items-center justify-center"}   group-hover:flex`,playingGifFrame:"absolute h-[30px] w-[30px] bottom-[15px] left-[15px] -z-1",title:"text-2xl text-white mt-3 font-bold text-ellipsis line-clamp-1"};if(t)return o.jsxs("div",{ref:a,"queue-id":t.queue_id,className:`song-thumb ${e?"active":""} ${l.container} ${i}`,children:[o.jsx("div",{className:`${s} flex items-end justify-center flex-shrink-0 w-[350px] h-[350px] min-[1536px]:w-[450px] min-[1536px]:h-[450px] `,children:o.jsxs("div",{className:`border-[4px] rounded-[6px] overflow-hidden border-transparent ${l.imageFrame} ${e?"w-[350px] min-[1536px]:w-[450px]":"w-[280px] min-[1536px]:w-[330px]"}`,children:[o.jsx(ht,{src:t.image_url,blurHashEncode:t.blurhash_encode}),o.jsx("div",{className:`${l.overlay}`,children:!e&&o.jsx(ee,{onClick:n,variant:"circle",hover:"scale",size:"clear",className:"p-2 hover:bg-[#fff]/10",children:o.jsx(pv,{className:"w-10"})})}),e&&o.jsx("div",{className:l.playingGifFrame,children:o.jsx("img",{src:Ev,alt:""})})]})}),r&&o.jsxs("div",{className:"text-center",children:[o.jsx("h2",{className:l.title,children:(t==null?void 0:t.name)||"Some song"}),o.jsx("p",{className:"text-md opacity-50 line-clamp-1",children:t.singers.map((c,u)=>o.jsx("span",{children:c.name},u))})]})]})},ug=f.forwardRef(J6),$S={queueSongs:cn().queue||[],currentQueueId:null,currentSongData:null,isFetching:!1};function dg(t){for(let e=0;e<t.queueSongs.length;e++){const n=t.queueSongs[e];if(n.queue_id===t.currentQueueId){t.currentSongData={song:n,index:e};return}}t.currentSongData=null}const oC=Mv({name:"songQueue",initialState:$S,reducers:{setQueue(t,e){const n=e.payload.songs;t.queueSongs=n,dg(t),lt("queue",n)},setCurrentQueueId(t,e){const n=e.payload;t.currentQueueId=n,dg(t)},removeSongFromQueue(t,e){const{index:n}=e.payload;t.queueSongs.splice(n,1),lt("queue",t.queueSongs),t.currentSongData&&n<=t.currentSongData.index&&dg(t)},setIsFetchingRecommend(t,e){t.isFetching=e.payload},addSongToQueue:(t,e)=>{const n=e.payload.songs;t.queueSongs.push(...n),lt("queue",t.queueSongs)},resetSongQueue:t=>{lt("queue",[]),Object.assign(t,$S)}}}),dt=t=>t.songQueue,{addSongToQueue:_m,setCurrentQueueId:Ur,removeSongFromQueue:Z6,setQueue:e$,resetSongQueue:t$,setIsFetchingRecommend:zS}=oC.actions,n$=oC.reducer;function yu({className:t="",playlists:e,loading:n}){const{currentSongData:r}=ae(dt),s=()=>e.length?e.map((i,a)=>{const l=r==null?void 0:r.song.queue_id.includes(i.id);return o.jsx("div",{className:"p-2 w-1/2 md:w-1/4",children:o.jsx(bv,{active:l,data:i})},a)}):o.jsx(Xe,{className:"mx-auto"});return o.jsx(o.Fragment,{children:o.jsxs("div",{className:`flex flex-row flex-wrap -mx-[8px] ${t}`,children:[n&&_v,!n&&s()]})})}function us({setTab:t,render:e,tab:n,tabs:r,className:s=""}){const{theme:i}=O(),a={inActiveTab:` hover:bg-${i.alpha}`,activeTab:`${i.content_bg}`};return o.jsx("div",{className:`bg-${i.alpha} p-1.5 space-x-1 rounded-full ${s}`,children:r.map((l,c)=>o.jsx(ee,{size:"clear",onClick:u=>{t(l),u.target.blur()},className:`py-1 px-4 ${l===n?a.activeTab:a.inActiveTab}`,children:e(l)},c))})}function r$({user:t},e){return e?o.jsx("p",{className:"text-xl mb-4 ml-2",ref:e,children:t.display_name}):o.jsx("p",{className:"text-xl mb-4 ml-2",children:t.display_name})}f.forwardRef(r$);function lC(){const{theme:t}=O(),e=rn(),{lyricSize:n,songBackground:r}=ae(Kn),s=a=>{e(Ze({lyricSize:a})),lt("lyricSize",a)},i={disableBtn:"bg-white/10 bg-opacity-20",lyricSizeBtn:`group/text justify-center !hover:brightness-100 font-[600] h-[30px] w-[30px] sm:h-[26px] sm:w-[26px] relative ${t.content_hover_bg}`,itemContainer:"flex justify-between  px-3 py-2 items-center min-h-[30px] hover:bg-[#fff]/5",text:"text-sm"};return o.jsx(o.Fragment,{children:o.jsx("div",{className:"w-[240px] sm:w-[220px]",children:o.jsxs(zs,{p:"clear",className:"space-y-[6px] text-white py-3",theme:t,children:[o.jsxs("div",{className:`${i.itemContainer}`,children:[o.jsx("p",{className:i.text,children:"Lyric size"}),o.jsxs("div",{className:"flex space-x-[8px]",children:[o.jsx(ee,{onClick:()=>s("small"),variant:"circle",size:"clear",className:`${n==="small"?t.content_bg:i.disableBtn} ${i.lyricSizeBtn}`,children:o.jsx("span",{className:"leading-[1] text-[11px]",children:"A"})}),o.jsx(ee,{onClick:()=>s("medium"),variant:"circle",size:"clear",className:`${n==="medium"?t.content_bg:i.disableBtn} ${i.lyricSizeBtn}`,children:o.jsx("span",{className:"leading-[1] text-[13px]",children:"A"})}),o.jsx(ee,{onClick:()=>s("large"),variant:"circle",size:"clear",className:`${n==="large"?t.content_bg:i.disableBtn} ${i.lyricSizeBtn}`,children:o.jsx("span",{className:"leading-[1] text-[15px]",children:"A"})})]})]}),o.jsxs("div",{className:`${i.itemContainer}`,children:[o.jsx("p",{className:i.text,children:"Song background"}),o.jsx(Zf,{size:"thin",className:"bg-white/10",active:r,cb:()=>e(X6({variant:"songBackground"}))})]})]})})})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cC=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},s$=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],a=t[n++],l=t[n++],c=((s&7)<<18|(i&63)<<12|(a&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const i=t[n++],a=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|a&63)}}return e.join("")},uC={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],a=s+1<t.length,l=a?t[s+1]:0,c=s+2<t.length,u=c?t[s+2]:0,d=i>>2,h=(i&3)<<4|l>>4;let m=(l&15)<<2|u>>6,p=u&63;c||(p=64,a||(m=64)),r.push(n[d],n[h],n[m],n[p])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(cC(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):s$(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],l=s<t.length?n[t.charAt(s)]:0;++s;const u=s<t.length?n[t.charAt(s)]:64;++s;const h=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||l==null||u==null||h==null)throw new i$;const m=i<<2|l>>4;if(r.push(m),u!==64){const p=l<<4&240|u>>2;if(r.push(p),h!==64){const g=u<<6&192|h;r.push(g)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class i$ extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const a$=function(t){const e=cC(t);return uC.encodeByteArray(e,!0)},$h=function(t){return a$(t).replace(/\./g,"")},dC=function(t){try{return uC.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o$(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l$=()=>o$().__FIREBASE_DEFAULTS__,c$=()=>{if(typeof process>"u"||typeof process.env>"u")return;const t={}.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},u$=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&dC(t[1]);return e&&JSON.parse(e)},Sm=()=>{try{return l$()||c$()||u$()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},hC=t=>{var e,n;return(n=(e=Sm())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},fC=t=>{const e=hC(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},mC=()=>{var t;return(t=Sm())===null||t===void 0?void 0:t.config},pC=t=>{var e;return(e=Sm())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d${constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gC(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t),l="";return[$h(JSON.stringify(n)),$h(JSON.stringify(a)),l].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function en(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function h$(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(en())}function f$(){var t;const e=(t=Sm())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function m$(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function p$(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function g$(){const t=en();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function y$(){try{return typeof indexedDB=="object"}catch{return!1}}function x$(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v$="FirebaseError";class ds extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=v$,Object.setPrototypeOf(this,ds.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,xu.prototype.create)}}class xu{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],a=i?w$(i,r):"Error",l=`${this.serviceName}: ${a} (${s}).`;return new ds(s,l,r)}}function w$(t,e){return t.replace(_$,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const _$=/\{\$([^}]+)}/g;function S$(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function zh(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],a=e[s];if(BS(i)&&BS(a)){if(!zh(i,a))return!1}else if(i!==a)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function BS(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vu(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function E$(t,e){const n=new b$(t,e);return n.subscribe.bind(n)}class b${constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");k$(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=hg),s.error===void 0&&(s.error=hg),s.complete===void 0&&(s.complete=hg);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function k$(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function hg(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qe(t){return t&&t._delegate?t._delegate:t}class Ci{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zi="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T${constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new d$;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(C$(e))try{this.getOrInitializeService({instanceIdentifier:Zi})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=Zi){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Zi){return this.instances.has(e)}getOptions(e=Zi){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,a]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);r===l&&a.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const a=this.instances.get(s);return a&&e(a,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:I$(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Zi){return this.component?this.component.multipleInstances?e:Zi:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function I$(t){return t===Zi?void 0:t}function C$(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R${constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new T$(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Se;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Se||(Se={}));const A$={debug:Se.DEBUG,verbose:Se.VERBOSE,info:Se.INFO,warn:Se.WARN,error:Se.ERROR,silent:Se.SILENT},j$=Se.INFO,N$={[Se.DEBUG]:"log",[Se.VERBOSE]:"log",[Se.INFO]:"info",[Se.WARN]:"warn",[Se.ERROR]:"error"},P$=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=N$[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class $v{constructor(e){this.name=e,this._logLevel=j$,this._logHandler=P$,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Se))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?A$[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Se.DEBUG,...e),this._logHandler(this,Se.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Se.VERBOSE,...e),this._logHandler(this,Se.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Se.INFO,...e),this._logHandler(this,Se.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Se.WARN,...e),this._logHandler(this,Se.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Se.ERROR,...e),this._logHandler(this,Se.ERROR,...e)}}const F$=(t,e)=>e.some(n=>t instanceof n);let US,VS;function D$(){return US||(US=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function O$(){return VS||(VS=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const yC=new WeakMap,ay=new WeakMap,xC=new WeakMap,fg=new WeakMap,zv=new WeakMap;function M$(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",a)},i=()=>{n(wi(t.result)),s()},a=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",a)});return e.then(n=>{n instanceof IDBCursor&&yC.set(n,t)}).catch(()=>{}),zv.set(e,t),e}function L$(t){if(ay.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",a),t.removeEventListener("abort",a)},i=()=>{n(),s()},a=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",a),t.addEventListener("abort",a)});ay.set(t,e)}let oy={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return ay.get(t);if(e==="objectStoreNames")return t.objectStoreNames||xC.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return wi(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function $$(t){oy=t(oy)}function z$(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(mg(this),e,...n);return xC.set(r,e.sort?e.sort():[e]),wi(r)}:O$().includes(t)?function(...e){return t.apply(mg(this),e),wi(yC.get(this))}:function(...e){return wi(t.apply(mg(this),e))}}function B$(t){return typeof t=="function"?z$(t):(t instanceof IDBTransaction&&L$(t),F$(t,D$())?new Proxy(t,oy):t)}function wi(t){if(t instanceof IDBRequest)return M$(t);if(fg.has(t))return fg.get(t);const e=B$(t);return e!==t&&(fg.set(t,e),zv.set(e,t)),e}const mg=t=>zv.get(t);function U$(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const a=indexedDB.open(t,e),l=wi(a);return r&&a.addEventListener("upgradeneeded",c=>{r(wi(a.result),c.oldVersion,c.newVersion,wi(a.transaction),c)}),n&&a.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),l.then(c=>{i&&c.addEventListener("close",()=>i()),s&&c.addEventListener("versionchange",u=>s(u.oldVersion,u.newVersion,u))}).catch(()=>{}),l}const V$=["get","getKey","getAll","getAllKeys","count"],H$=["put","add","delete","clear"],pg=new Map;function HS(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(pg.get(e))return pg.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=H$.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||V$.includes(n)))return;const i=async function(a,...l){const c=this.transaction(a,s?"readwrite":"readonly");let u=c.store;return r&&(u=u.index(l.shift())),(await Promise.all([u[n](...l),s&&c.done]))[0]};return pg.set(e,i),i}$$(t=>({...t,get:(e,n,r)=>HS(e,n)||t.get(e,n,r),has:(e,n)=>!!HS(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W${constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(q$(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function q$(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const ly="@firebase/app",WS="0.9.17";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wa=new $v("@firebase/app"),G$="@firebase/app-compat",Q$="@firebase/analytics-compat",K$="@firebase/analytics",X$="@firebase/app-check-compat",Y$="@firebase/app-check",J$="@firebase/auth",Z$="@firebase/auth-compat",e9="@firebase/database",t9="@firebase/database-compat",n9="@firebase/functions",r9="@firebase/functions-compat",s9="@firebase/installations",i9="@firebase/installations-compat",a9="@firebase/messaging",o9="@firebase/messaging-compat",l9="@firebase/performance",c9="@firebase/performance-compat",u9="@firebase/remote-config",d9="@firebase/remote-config-compat",h9="@firebase/storage",f9="@firebase/storage-compat",m9="@firebase/firestore",p9="@firebase/firestore-compat",g9="firebase",y9="10.3.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cy="[DEFAULT]",x9={[ly]:"fire-core",[G$]:"fire-core-compat",[K$]:"fire-analytics",[Q$]:"fire-analytics-compat",[Y$]:"fire-app-check",[X$]:"fire-app-check-compat",[J$]:"fire-auth",[Z$]:"fire-auth-compat",[e9]:"fire-rtdb",[t9]:"fire-rtdb-compat",[n9]:"fire-fn",[r9]:"fire-fn-compat",[s9]:"fire-iid",[i9]:"fire-iid-compat",[a9]:"fire-fcm",[o9]:"fire-fcm-compat",[l9]:"fire-perf",[c9]:"fire-perf-compat",[u9]:"fire-rc",[d9]:"fire-rc-compat",[h9]:"fire-gcs",[f9]:"fire-gcs-compat",[m9]:"fire-fst",[p9]:"fire-fst-compat","fire-js":"fire-js",[g9]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bh=new Map,uy=new Map;function v9(t,e){try{t.container.addComponent(e)}catch(n){wa.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function _a(t){const e=t.name;if(uy.has(e))return wa.debug(`There were multiple attempts to register component ${e}.`),!1;uy.set(e,t);for(const n of Bh.values())v9(n,t);return!0}function Em(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w9={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},_i=new xu("app","Firebase",w9);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _9{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Ci("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw _i.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ma=y9;function vC(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:cy,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw _i.create("bad-app-name",{appName:String(s)});if(n||(n=mC()),!n)throw _i.create("no-options");const i=Bh.get(s);if(i){if(zh(n,i.options)&&zh(r,i.config))return i;throw _i.create("duplicate-app",{appName:s})}const a=new R$(s);for(const c of uy.values())a.addComponent(c);const l=new _9(n,r,a);return Bh.set(s,l),l}function Bv(t=cy){const e=Bh.get(t);if(!e&&t===cy&&mC())return vC();if(!e)throw _i.create("no-app",{appName:t});return e}function Xr(t,e,n){var r;let s=(r=x9[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),a=e.match(/\s|\//);if(i||a){const l=[`Unable to register library "${s}" with version "${e}":`];i&&l.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&a&&l.push("and"),a&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),wa.warn(l.join(" "));return}_a(new Ci(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S9="firebase-heartbeat-database",E9=1,Mc="firebase-heartbeat-store";let gg=null;function wC(){return gg||(gg=U$(S9,E9,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Mc)}}}).catch(t=>{throw _i.create("idb-open",{originalErrorMessage:t.message})})),gg}async function b9(t){try{return await(await wC()).transaction(Mc).objectStore(Mc).get(_C(t))}catch(e){if(e instanceof ds)wa.warn(e.message);else{const n=_i.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});wa.warn(n.message)}}}async function qS(t,e){try{const r=(await wC()).transaction(Mc,"readwrite");await r.objectStore(Mc).put(e,_C(t)),await r.done}catch(n){if(n instanceof ds)wa.warn(n.message);else{const r=_i.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});wa.warn(r.message)}}}function _C(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k9=1024,T9=30*24*60*60*1e3;class I9{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new R9(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=GS();if(this._heartbeatsCache===null&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(s=>s.date===r)))return this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(s=>{const i=new Date(s.date).valueOf();return Date.now()-i<=T9}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache===null||this._heartbeatsCache.heartbeats.length===0)return"";const e=GS(),{heartbeatsToSend:n,unsentEntries:r}=C9(this._heartbeatsCache.heartbeats),s=$h(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}}function GS(){return new Date().toISOString().substring(0,10)}function C9(t,e=k9){const n=[];let r=t.slice();for(const s of t){const i=n.find(a=>a.agent===s.agent);if(i){if(i.dates.push(s.date),QS(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),QS(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class R9{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return y$()?x$().then(()=>!0).catch(()=>!1):!1}async read(){return await this._canUseIndexedDBPromise?await b9(this.app)||{heartbeats:[]}:{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return qS(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return qS(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function QS(t){return $h(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A9(t){_a(new Ci("platform-logger",e=>new W$(e),"PRIVATE")),_a(new Ci("heartbeat",e=>new I9(e),"PRIVATE")),Xr(ly,WS,t),Xr(ly,WS,"esm2017"),Xr("fire-js","")}A9("");function Uv(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function SC(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const j9=SC,EC=new xu("auth","Firebase",SC());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uh=new $v("@firebase/auth");function N9(t,...e){Uh.logLevel<=Se.WARN&&Uh.warn(`Auth (${Ma}): ${t}`,...e)}function Xd(t,...e){Uh.logLevel<=Se.ERROR&&Uh.error(`Auth (${Ma}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function es(t,...e){throw Vv(t,...e)}function Yr(t,...e){return Vv(t,...e)}function bC(t,e,n){const r=Object.assign(Object.assign({},j9()),{[e]:n});return new xu("auth","Firebase",r).create(e,{appName:t.name})}function P9(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&es(t,"argument-error"),bC(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Vv(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return EC.create(t,...e)}function Z(t,e,...n){if(!t)throw Vv(e,...n)}function ws(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Xd(e),new Error(e)}function Fs(t,e){t||ws(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dy(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function F9(){return KS()==="http:"||KS()==="https:"}function KS(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D9(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(F9()||m$()||"connection"in navigator)?navigator.onLine:!0}function O9(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wu{constructor(e,n){this.shortDelay=e,this.longDelay=n,Fs(n>e,"Short delay should be less than long delay!"),this.isMobile=h$()||p$()}get(){return D9()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hv(t,e){Fs(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kC{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;ws("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;ws("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;ws("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M9={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L9=new wu(3e4,6e4);function TC(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function _u(t,e,n,r,s={}){return IC(t,s,async()=>{let i={},a={};r&&(e==="GET"?a=r:i={body:JSON.stringify(r)});const l=vu(Object.assign({key:t.config.apiKey},a)).slice(1),c=await t._getAdditionalHeaders();return c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode),kC.fetch()(CC(t,t.config.apiHost,n,l),Object.assign({method:e,headers:c,referrerPolicy:"no-referrer"},i))})}async function IC(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},M9),e);try{const s=new z9(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const a=await i.json();if("needConfirmation"in a)throw hd(t,"account-exists-with-different-credential",a);if(i.ok&&!("errorMessage"in a))return a;{const l=i.ok?a.errorMessage:a.error.message,[c,u]=l.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw hd(t,"credential-already-in-use",a);if(c==="EMAIL_EXISTS")throw hd(t,"email-already-in-use",a);if(c==="USER_DISABLED")throw hd(t,"user-disabled",a);const d=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw bC(t,d,u);es(t,d)}}catch(s){if(s instanceof ds)throw s;es(t,"network-request-failed",{message:String(s)})}}async function $9(t,e,n,r,s={}){const i=await _u(t,e,n,r,s);return"mfaPendingCredential"in i&&es(t,"multi-factor-auth-required",{_serverResponse:i}),i}function CC(t,e,n,r){const s=`${e}${n}?${r}`;return t.config.emulator?Hv(t.config,s):`${t.config.apiScheme}://${s}`}class z9{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Yr(this.auth,"network-request-failed")),L9.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function hd(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=Yr(t,e,r);return s.customData._tokenResponse=n,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function B9(t,e){return _u(t,"POST","/v1/accounts:delete",e)}async function U9(t,e){return _u(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sc(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function V9(t,e=!1){const n=qe(t),r=await n.getIdToken(e),s=Wv(r);Z(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,a=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:sc(yg(s.auth_time)),issuedAtTime:sc(yg(s.iat)),expirationTime:sc(yg(s.exp)),signInProvider:a||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function yg(t){return Number(t)*1e3}function Wv(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Xd("JWT malformed, contained fewer than 3 sections"),null;try{const s=dC(n);return s?JSON.parse(s):(Xd("Failed to decode base64 JWT payload"),null)}catch(s){return Xd("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function H9(t){const e=Wv(t);return Z(e,"internal-error"),Z(typeof e.exp<"u","internal-error"),Z(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Lc(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof ds&&W9(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function W9({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q9{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RC{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=sc(this.lastLoginAt),this.creationTime=sc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vh(t){var e;const n=t.auth,r=await t.getIdToken(),s=await Lc(t,U9(n,{idToken:r}));Z(s==null?void 0:s.users.length,n,"internal-error");const i=s.users[0];t._notifyReloadListener(i);const a=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?K9(i.providerUserInfo):[],l=Q9(t.providerData,a),c=t.isAnonymous,u=!(t.email&&i.passwordHash)&&!(l!=null&&l.length),d=c?u:!1,h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:l,metadata:new RC(i.createdAt,i.lastLoginAt),isAnonymous:d};Object.assign(t,h)}async function G9(t){const e=qe(t);await Vh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Q9(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function K9(t){return t.map(e=>{var{providerId:n}=e,r=Uv(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function X9(t,e){const n=await IC(t,{},async()=>{const r=vu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,a=CC(t,s,"/v1/token",`key=${i}`),l=await t._getAdditionalHeaders();return l["Content-Type"]="application/x-www-form-urlencoded",kC.fetch()(a,{method:"POST",headers:l,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $c{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Z(e.idToken,"internal-error"),Z(typeof e.idToken<"u","internal-error"),Z(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):H9(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}async getToken(e,n=!1){return Z(!this.accessToken||this.refreshToken,e,"user-token-expired"),!n&&this.accessToken&&!this.isExpired?this.accessToken:this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await X9(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,a=new $c;return r&&(Z(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),s&&(Z(typeof s=="string","internal-error",{appName:e}),a.accessToken=s),i&&(Z(typeof i=="number","internal-error",{appName:e}),a.expirationTime=i),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new $c,this.toJSON())}_performRefresh(){return ws("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gs(t,e){Z(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class da{constructor(e){var{uid:n,auth:r,stsTokenManager:s}=e,i=Uv(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new q9(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new RC(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await Lc(this,this.stsTokenManager.getToken(this.auth,e));return Z(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return V9(this,e)}reload(){return G9(this)}_assign(e){this!==e&&(Z(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new da(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){Z(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Vh(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await Lc(this,B9(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,s,i,a,l,c,u,d;const h=(r=n.displayName)!==null&&r!==void 0?r:void 0,m=(s=n.email)!==null&&s!==void 0?s:void 0,p=(i=n.phoneNumber)!==null&&i!==void 0?i:void 0,g=(a=n.photoURL)!==null&&a!==void 0?a:void 0,y=(l=n.tenantId)!==null&&l!==void 0?l:void 0,_=(c=n._redirectEventId)!==null&&c!==void 0?c:void 0,w=(u=n.createdAt)!==null&&u!==void 0?u:void 0,x=(d=n.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:v,emailVerified:S,isAnonymous:E,providerData:b,stsTokenManager:I}=n;Z(v&&I,e,"internal-error");const A=$c.fromJSON(this.name,I);Z(typeof v=="string",e,"internal-error"),Gs(h,e.name),Gs(m,e.name),Z(typeof S=="boolean",e,"internal-error"),Z(typeof E=="boolean",e,"internal-error"),Gs(p,e.name),Gs(g,e.name),Gs(y,e.name),Gs(_,e.name),Gs(w,e.name),Gs(x,e.name);const L=new da({uid:v,auth:e,email:m,emailVerified:S,displayName:h,isAnonymous:E,photoURL:g,phoneNumber:p,tenantId:y,stsTokenManager:A,createdAt:w,lastLoginAt:x});return b&&Array.isArray(b)&&(L.providerData=b.map(P=>Object.assign({},P))),_&&(L._redirectEventId=_),L}static async _fromIdTokenResponse(e,n,r=!1){const s=new $c;s.updateFromServerResponse(n);const i=new da({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await Vh(i),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XS=new Map;function _s(t){Fs(t instanceof Function,"Expected a class definition");let e=XS.get(t);return e?(Fs(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,XS.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AC{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}AC.type="NONE";const YS=AC;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yd(t,e,n){return`firebase:${t}:${e}:${n}`}class bo{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=Yd(this.userKey,s.apiKey,i),this.fullPersistenceKey=Yd("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?da._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new bo(_s(YS),e,r);const s=(await Promise.all(n.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let i=s[0]||_s(YS);const a=Yd(r,e.config.apiKey,e.name);let l=null;for(const u of n)try{const d=await u._get(a);if(d){const h=da._fromJSON(e,d);u!==i&&(l=h),i=u;break}}catch{}const c=s.filter(u=>u._shouldAllowMigration);return!i._shouldAllowMigration||!c.length?new bo(i,e,r):(i=c[0],l&&await i._set(a,l.toJSON()),await Promise.all(n.map(async u=>{if(u!==i)try{await u._remove(a)}catch{}})),new bo(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JS(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(PC(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(jC(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(DC(e))return"Blackberry";if(OC(e))return"Webos";if(qv(e))return"Safari";if((e.includes("chrome/")||NC(e))&&!e.includes("edge/"))return"Chrome";if(FC(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function jC(t=en()){return/firefox\//i.test(t)}function qv(t=en()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function NC(t=en()){return/crios\//i.test(t)}function PC(t=en()){return/iemobile/i.test(t)}function FC(t=en()){return/android/i.test(t)}function DC(t=en()){return/blackberry/i.test(t)}function OC(t=en()){return/webos/i.test(t)}function bm(t=en()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function Y9(t=en()){var e;return bm(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function J9(){return g$()&&document.documentMode===10}function MC(t=en()){return bm(t)||FC(t)||OC(t)||DC(t)||/windows phone/i.test(t)||PC(t)}function Z9(){try{return!!(window&&window!==window.top)}catch{return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LC(t,e=[]){let n;switch(t){case"Browser":n=JS(en());break;case"Worker":n=`${JS(en())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Ma}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ez{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((a,l)=>{try{const c=e(i);a(c)}catch(c){l(c)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tz(t,e={}){return _u(t,"GET","/v2/passwordPolicy",TC(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nz=6;class rz{constructor(e){var n,r,s,i;const a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=a.minPasswordLength)!==null&&n!==void 0?n:nz,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,s,i,a,l;const c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(n=c.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),c.isValid&&(c.isValid=(r=c.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(s=c.containsLowercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(i=c.containsUppercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(a=c.containsNumericCharacter)!==null&&a!==void 0?a:!0),c.isValid&&(c.isValid=(l=c.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),c}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sz{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ZS(this),this.idTokenSubscription=new ZS(this),this.beforeStateQueue=new ez(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=EC,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=_s(n)),this._initializationPromise=this.queue(async()=>{var r,s;if(!this._deleted&&(this.persistenceManager=await bo.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUser(e){var n;const r=await this.assertedPersistence.getCurrentUser();let s=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,l=s==null?void 0:s._redirectEventId,c=await this.tryRedirectSignIn(e);(!a||a===l)&&(c!=null&&c.user)&&(s=c.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(a){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return Z(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Vh(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=O9()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const n=e?qe(e):null;return n&&Z(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&Z(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(e){return this.queue(async()=>{await this.assertedPersistence.setPersistence(_s(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await tz(this),n=new rz(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new xu("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&_s(e)||this._popupRedirectResolver;Z(n,this,"argument-error"),this.redirectPersistenceManager=await bo.create(this,[_s(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let a=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(Z(l,this,"internal-error"),l.then(()=>{a||i(this.currentUser)}),typeof n=="function"){const c=e.addObserver(n,r,s);return()=>{a=!0,c()}}else{const c=e.addObserver(n);return()=>{a=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Z(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=LC(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(n["X-Firebase-AppCheck"]=s),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&N9(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function km(t){return qe(t)}class ZS{constructor(e){this.auth=e,this.observer=null,this.addObserver=E$(n=>this.observer=n)}get next(){return Z(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iz(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}function az(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=Yr("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",iz().appendChild(r)})}function oz(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lz(t,e){const n=Em(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(zh(i,e??{}))return s;es(s,"already-initialized")}return n.initialize({options:e})}function cz(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(_s);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function uz(t,e,n){const r=km(t);Z(r._canInitEmulator,r,"emulator-config-failed"),Z(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!!(n!=null&&n.disableWarnings),i=$C(e),{host:a,port:l}=dz(e),c=l===null?"":`:${l}`;r.config.emulator={url:`${i}//${a}${c}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:a,port:l,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),s||hz()}function $C(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function dz(t){const e=$C(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:eE(r.substr(i.length+1))}}else{const[i,a]=r.split(":");return{host:i,port:eE(a)}}}function eE(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function hz(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zC{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return ws("not implemented")}_getIdTokenResponse(e){return ws("not implemented")}_linkToIdToken(e,n){return ws("not implemented")}_getReauthenticationResolver(e){return ws("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ko(t,e){return $9(t,"POST","/v1/accounts:signInWithIdp",TC(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fz="http://localhost";class Sa extends zC{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Sa(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):es("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=n,i=Uv(n,["providerId","signInMethod"]);if(!r||!s)return null;const a=new Sa(r,s);return a.idToken=i.idToken||void 0,a.accessToken=i.accessToken||void 0,a.secret=i.secret,a.nonce=i.nonce,a.pendingToken=i.pendingToken||null,a}_getIdTokenResponse(e){const n=this.buildRequest();return ko(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,ko(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,ko(e,n)}buildRequest(){const e={requestUri:fz,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=vu(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gv{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Su extends Gv{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ei extends Su{constructor(){super("facebook.com")}static credential(e){return Sa._fromParams({providerId:ei.PROVIDER_ID,signInMethod:ei.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ei.credentialFromTaggedObject(e)}static credentialFromError(e){return ei.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ei.credential(e.oauthAccessToken)}catch{return null}}}ei.FACEBOOK_SIGN_IN_METHOD="facebook.com";ei.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ys extends Su{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Sa._fromParams({providerId:ys.PROVIDER_ID,signInMethod:ys.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return ys.credentialFromTaggedObject(e)}static credentialFromError(e){return ys.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return ys.credential(n,r)}catch{return null}}}ys.GOOGLE_SIGN_IN_METHOD="google.com";ys.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ti extends Su{constructor(){super("github.com")}static credential(e){return Sa._fromParams({providerId:ti.PROVIDER_ID,signInMethod:ti.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ti.credentialFromTaggedObject(e)}static credentialFromError(e){return ti.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ti.credential(e.oauthAccessToken)}catch{return null}}}ti.GITHUB_SIGN_IN_METHOD="github.com";ti.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ni extends Su{constructor(){super("twitter.com")}static credential(e,n){return Sa._fromParams({providerId:ni.PROVIDER_ID,signInMethod:ni.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return ni.credentialFromTaggedObject(e)}static credentialFromError(e){return ni.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return ni.credential(n,r)}catch{return null}}}ni.TWITTER_SIGN_IN_METHOD="twitter.com";ni.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zo{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await da._fromIdTokenResponse(e,r,s),a=tE(r);return new zo({user:i,providerId:a,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=tE(r);return new zo({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function tE(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hh extends ds{constructor(e,n,r,s){var i;super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,Hh.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new Hh(e,n,r,s)}}function BC(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Hh._fromErrorAndOperation(t,i,e,r):i})}async function mz(t,e,n=!1){const r=await Lc(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return zo._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pz(t,e,n=!1){const{auth:r}=t,s="reauthenticate";try{const i=await Lc(t,BC(r,s,e,t),n);Z(i.idToken,r,"internal-error");const a=Wv(i.idToken);Z(a,r,"internal-error");const{sub:l}=a;return Z(t.uid===l,r,"user-mismatch"),zo._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&es(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gz(t,e,n=!1){const r="signIn",s=await BC(t,r,e),i=await zo._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}function yz(t,e,n,r){return qe(t).onIdTokenChanged(e,n,r)}function xz(t,e,n){return qe(t).beforeAuthStateChanged(e,n)}function vz(t,e,n,r){return qe(t).onAuthStateChanged(e,n,r)}function UC(t){return qe(t).signOut()}const Wh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VC{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Wh,"1"),this.storage.removeItem(Wh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wz(){const t=en();return qv(t)||bm(t)}const _z=1e3,Sz=10;class HC extends VC{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=wz()&&Z9(),this.fallbackToPolling=MC(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((a,l,c)=>{this.notifyListeners(a,c)});return}const r=e.key;if(n?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const a=this.storage.getItem(r);if(e.newValue!==a)e.newValue!==null?this.storage.setItem(r,e.newValue):this.storage.removeItem(r);else if(this.localCache[r]===e.newValue&&!n)return}const s=()=>{const a=this.storage.getItem(r);!n&&this.localCache[r]===a||this.notifyListeners(r,a)},i=this.storage.getItem(r);J9()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,Sz):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},_z)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}HC.type="LOCAL";const Ez=HC;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WC extends VC{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}WC.type="SESSION";const qC=WC;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bz(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tm{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new Tm(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,a=this.handlersMap[s];if(!(a!=null&&a.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const l=Array.from(a).map(async u=>u(n.origin,i)),c=await bz(l);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:c})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Tm.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qv(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kz{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,a;return new Promise((l,c)=>{const u=Qv("",20);s.port1.start();const d=setTimeout(()=>{c(new Error("unsupported_event"))},r);a={messageChannel:s,onMessage(h){const m=h;if(m.data.eventId===u)switch(m.data.status){case"ack":clearTimeout(d),i=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),l(m.data.response);break;default:clearTimeout(d),clearTimeout(i),c(new Error("invalid_response"));break}}},this.handlers.add(a),s.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:u,data:n},[s.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jr(){return window}function Tz(t){Jr().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GC(){return typeof Jr().WorkerGlobalScope<"u"&&typeof Jr().importScripts=="function"}async function Iz(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Cz(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function Rz(){return GC()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QC="firebaseLocalStorageDb",Az=1,qh="firebaseLocalStorage",KC="fbase_key";class Eu{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Im(t,e){return t.transaction([qh],e?"readwrite":"readonly").objectStore(qh)}function jz(){const t=indexedDB.deleteDatabase(QC);return new Eu(t).toPromise()}function hy(){const t=indexedDB.open(QC,Az);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(qh,{keyPath:KC})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(qh)?e(r):(r.close(),await jz(),e(await hy()))})})}async function nE(t,e,n){const r=Im(t,!0).put({[KC]:e,value:n});return new Eu(r).toPromise()}async function Nz(t,e){const n=Im(t,!1).get(e),r=await new Eu(n).toPromise();return r===void 0?null:r.value}function rE(t,e){const n=Im(t,!0).delete(e);return new Eu(n).toPromise()}const Pz=800,Fz=3;class XC{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await hy(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>Fz)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return GC()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Tm._getInstance(Rz()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await Iz(),!this.activeServiceWorker)return;this.sender=new kz(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Cz()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await hy();return await nE(e,Wh,"1"),await rE(e,Wh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>nE(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>Nz(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>rE(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=Im(s,!1).getAll();return new Eu(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Pz)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}XC.type="LOCAL";const Dz=XC;new wu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YC(t,e){return e?_s(e):(Z(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kv extends zC{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ko(e,this._buildIdpRequest())}_linkToIdToken(e,n){return ko(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return ko(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function Oz(t){return gz(t.auth,new Kv(t),t.bypassAuthState)}function Mz(t){const{auth:e,user:n}=t;return Z(n,e,"internal-error"),pz(n,new Kv(t),t.bypassAuthState)}async function Lz(t){const{auth:e,user:n}=t;return Z(n,e,"internal-error"),mz(n,new Kv(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JC{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:a,type:l}=e;if(a){this.reject(a);return}const c={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(c))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Oz;case"linkViaPopup":case"linkViaRedirect":return Lz;case"reauthViaPopup":case"reauthViaRedirect":return Mz;default:es(this.auth,"internal-error")}}resolve(e){Fs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Fs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $z=new wu(2e3,1e4);async function zz(t,e,n){const r=km(t);P9(t,e,Gv);const s=YC(r,n);return new ia(r,"signInViaPopup",e,s).executeNotNull()}class ia extends JC{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,ia.currentPopupAction&&ia.currentPopupAction.cancel(),ia.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Z(e,this.auth,"internal-error"),e}async onExecution(){Fs(this.filter.length===1,"Popup operations only handle one event");const e=Qv();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Yr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Yr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ia.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Yr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,$z.get())};e()}}ia.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bz="pendingRedirect",Jd=new Map;class Uz extends JC{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Jd.get(this.auth._key());if(!e){try{const r=await Vz(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Jd.set(this.auth._key(),e)}return this.bypassAuthState||Jd.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Vz(t,e){const n=qz(e),r=Wz(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function Hz(t,e){Jd.set(t._key(),e)}function Wz(t){return _s(t._redirectPersistence)}function qz(t){return Yd(Bz,t.config.apiKey,t.name)}async function Gz(t,e,n=!1){const r=km(t),s=YC(r,e),a=await new Uz(r,s,n).execute();return a&&!n&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qz=10*60*1e3;class Kz{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Xz(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!ZC(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(Yr(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Qz&&this.cachedEventUids.clear(),this.cachedEventUids.has(sE(e))}saveEventToCache(e){this.cachedEventUids.add(sE(e)),this.lastProcessedEventTime=Date.now()}}function sE(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function ZC({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function Xz(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return ZC(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Yz(t,e={}){return _u(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jz=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Zz=/^https?/;async function eB(t){if(t.config.emulator)return;const{authorizedDomains:e}=await Yz(t);for(const n of e)try{if(tB(n))return}catch{}es(t,"unauthorized-domain")}function tB(t){const e=dy(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&a.hostname===r}if(!Zz.test(n))return!1;if(Jz.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nB=new wu(3e4,6e4);function iE(){const t=Jr().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function rB(t){return new Promise((e,n)=>{var r,s,i;function a(){iE(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{iE(),n(Yr(t,"network-request-failed"))},timeout:nB.get()})}if(!((s=(r=Jr().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=Jr().gapi)===null||i===void 0)&&i.load)a();else{const l=oz("iframefcb");return Jr()[l]=()=>{gapi.load?a():n(Yr(t,"network-request-failed"))},az(`https://apis.google.com/js/api.js?onload=${l}`).catch(c=>n(c))}}).catch(e=>{throw Zd=null,e})}let Zd=null;function sB(t){return Zd=Zd||rB(t),Zd}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iB=new wu(5e3,15e3),aB="__/auth/iframe",oB="emulator/auth/iframe",lB={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},cB=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function uB(t){const e=t.config;Z(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Hv(e,oB):`https://${t.config.authDomain}/${aB}`,r={apiKey:e.apiKey,appName:t.name,v:Ma},s=cB.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${vu(r).slice(1)}`}async function dB(t){const e=await sB(t),n=Jr().gapi;return Z(n,t,"internal-error"),e.open({where:document.body,url:uB(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:lB,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const a=Yr(t,"network-request-failed"),l=Jr().setTimeout(()=>{i(a)},iB.get());function c(){Jr().clearTimeout(l),s(r)}r.ping(c).then(c,()=>{i(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hB={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},fB=500,mB=600,pB="_blank",gB="http://localhost";class aE{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function yB(t,e,n,r=fB,s=mB){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const c=Object.assign(Object.assign({},hB),{width:r.toString(),height:s.toString(),top:i,left:a}),u=en().toLowerCase();n&&(l=NC(u)?pB:n),jC(u)&&(e=e||gB,c.scrollbars="yes");const d=Object.entries(c).reduce((m,[p,g])=>`${m}${p}=${g},`,"");if(Y9(u)&&l!=="_self")return xB(e||"",l),new aE(null);const h=window.open(e||"",l,d);Z(h,t,"popup-blocked");try{h.focus()}catch{}return new aE(h)}function xB(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vB="__/auth/handler",wB="emulator/auth/handler",_B=encodeURIComponent("fac");async function oE(t,e,n,r,s,i){Z(t.config.authDomain,t,"auth-domain-config-required"),Z(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Ma,eventId:s};if(e instanceof Gv){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",S$(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,h]of Object.entries(i||{}))a[d]=h}if(e instanceof Su){const d=e.getScopes().filter(h=>h!=="");d.length>0&&(a.scopes=d.join(","))}t.tenantId&&(a.tid=t.tenantId);const l=a;for(const d of Object.keys(l))l[d]===void 0&&delete l[d];const c=await t._getAppCheckToken(),u=c?`#${_B}=${encodeURIComponent(c)}`:"";return`${SB(t)}?${vu(l).slice(1)}${u}`}function SB({config:t}){return t.emulator?Hv(t,wB):`https://${t.authDomain}/${vB}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xg="webStorageSupport";class EB{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=qC,this._completeRedirectFn=Gz,this._overrideRedirectResult=Hz}async _openPopup(e,n,r,s){var i;Fs((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const a=await oE(e,n,r,dy(),s);return yB(e,a,Qv())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await oE(e,n,r,dy(),s);return Tz(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(Fs(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await dB(e),r=new Kz(e);return n.register("authEvent",s=>(Z(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(xg,{type:xg},s=>{var i;const a=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[xg];a!==void 0&&n(!!a),es(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=eB(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return MC()||qv()||bm()}}const bB=EB;var lE="@firebase/auth",cE="1.3.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kB{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Z(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TB(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}function IB(t){_a(new Ci("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:a,authDomain:l}=r.options;Z(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const c={apiKey:a,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:LC(t)},u=new sz(r,s,i,c);return cz(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),_a(new Ci("auth-internal",e=>{const n=km(e.getProvider("auth").getImmediate());return(r=>new kB(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Xr(lE,cE,TB(t)),Xr(lE,cE,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CB=5*60,RB=pC("authIdTokenMaxAge")||CB;let uE=null;const AB=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>RB)return;const s=n==null?void 0:n.token;uE!==s&&(uE=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function jB(t=Bv()){const e=Em(t,"auth");if(e.isInitialized())return e.getImmediate();const n=lz(t,{popupRedirectResolver:bB,persistence:[Dz,Ez,qC]}),r=pC("authTokenSyncURL");if(r){const i=AB(r);xz(n,i,()=>i(n.currentUser)),yz(n,a=>i(a))}const s=hC("auth");return s&&uz(n,`http://${s}`),n}IB("Browser");/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function NB(t,e,n,r){function s(i){return i instanceof n?i:new n(function(a){a(i)})}return new(n||(n=Promise))(function(i,a){function l(d){try{u(r.next(d))}catch(h){a(h)}}function c(d){try{u(r.throw(d))}catch(h){a(h)}}function u(d){d.done?i(d.value):s(d.value).then(l,c)}u((r=r.apply(t,e||[])).next())})}function PB(t,e){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,s,i,a;return a={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function l(u){return function(d){return c([u,d])}}function c(u){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,s&&(i=u[0]&2?s.return:u[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,u[1])).done)return i;switch(s=0,i&&(u=[u[0]&2,i.value]),u[0]){case 0:case 1:i=u;break;case 4:return n.label++,{value:u[1],done:!1};case 5:n.label++,s=u[1],u=[0];continue;case 7:u=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(u[0]===6||u[0]===2)){n=0;continue}if(u[0]===3&&(!i||u[1]>i[0]&&u[1]<i[3])){n.label=u[1];break}if(u[0]===6&&n.label<i[1]){n.label=i[1],i=u;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(u);break}i[2]&&n.ops.pop(),n.trys.pop();continue}u=e.call(t,n)}catch(d){u=[6,d],s=0}finally{r=i=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var fo=function(){return fo=Object.assign||function(e){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},fo.apply(this,arguments)},eR=function(t){return{loading:t==null,value:t}},FB=function(){return function(t,e){switch(e.type){case"error":return fo(fo({},t),{error:e.error,loading:!1,value:void 0});case"reset":return eR(e.defaultValue);case"value":return fo(fo({},t),{error:void 0,loading:!1,value:e.value});default:return t}}},DB=function(t){var e=t?t():void 0,n=f.useReducer(FB(),eR(e)),r=n[0],s=n[1],i=f.useCallback(function(){var c=t?t():void 0;s({type:"reset",defaultValue:c})},[t]),a=f.useCallback(function(c){s({type:"error",error:c})},[]),l=f.useCallback(function(c){s({type:"value",value:c})},[]);return f.useMemo(function(){return{error:r.error,loading:r.loading,reset:i,setError:a,setValue:l,value:r.value}},[r.error,r.loading,i,a,l,r.value])},Xv=function(t,e){var n=DB(function(){return t.currentUser}),r=n.error,s=n.loading,i=n.setError,a=n.setValue,l=n.value;return f.useEffect(function(){var c=vz(t,function(u){return NB(void 0,void 0,void 0,function(){var d;return PB(this,function(h){switch(h.label){case 0:if(!(e!=null&&e.onUserChanged))return[3,4];h.label=1;case 1:return h.trys.push([1,3,,4]),[4,e.onUserChanged(u)];case 2:return h.sent(),[3,4];case 3:return d=h.sent(),i(d),[3,4];case 4:return a(u),[2]}})})},i);return function(){c()}},[t]),[l,s,r]},OB="firebase",MB="10.3.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Xr(OB,MB,"app");var LB=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},D,Yv=Yv||{},Y=LB||self;function Cm(t){var e=typeof t;return e=e!="object"?e:t?Array.isArray(t)?"array":e:"null",e=="array"||e=="object"&&typeof t.length=="number"}function bu(t){var e=typeof t;return e=="object"&&t!=null||e=="function"}function $B(t){return Object.prototype.hasOwnProperty.call(t,vg)&&t[vg]||(t[vg]=++zB)}var vg="closure_uid_"+(1e9*Math.random()>>>0),zB=0;function BB(t,e,n){return t.call.apply(t.bind,arguments)}function UB(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var s=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(s,r),t.apply(e,s)}}return function(){return t.apply(e,arguments)}}function Kt(t,e,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?Kt=BB:Kt=UB,Kt.apply(null,arguments)}function fd(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),t.apply(this,r)}}function Rt(t,e){function n(){}n.prototype=e.prototype,t.$=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ac=function(r,s,i){for(var a=Array(arguments.length-2),l=2;l<arguments.length;l++)a[l-2]=arguments[l];return e.prototype[s].apply(r,a)}}function $i(){this.s=this.s,this.o=this.o}var VB=0;$i.prototype.s=!1;$i.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),VB!=0)&&$B(this)};$i.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const tR=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(typeof t=="string")return typeof e!="string"||e.length!=1?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function Jv(t){const e=t.length;if(0<e){const n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function dE(t,e){for(let n=1;n<arguments.length;n++){const r=arguments[n];if(Cm(r)){const s=t.length||0,i=r.length||0;t.length=s+i;for(let a=0;a<i;a++)t[s+a]=r[a]}else t.push(r)}}function Xt(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}Xt.prototype.h=function(){this.defaultPrevented=!0};var HB=function(){if(!Y.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{Y.addEventListener("test",()=>{},e),Y.removeEventListener("test",()=>{},e)}catch{}return t}();function zc(t){return/^[\s\xa0]*$/.test(t)}function Rm(){var t=Y.navigator;return t&&(t=t.userAgent)?t:""}function zr(t){return Rm().indexOf(t)!=-1}function Zv(t){return Zv[" "](t),t}Zv[" "]=function(){};function WB(t,e){var n=MU;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}var qB=zr("Opera"),Bo=zr("Trident")||zr("MSIE"),nR=zr("Edge"),fy=nR||Bo,rR=zr("Gecko")&&!(Rm().toLowerCase().indexOf("webkit")!=-1&&!zr("Edge"))&&!(zr("Trident")||zr("MSIE"))&&!zr("Edge"),GB=Rm().toLowerCase().indexOf("webkit")!=-1&&!zr("Edge");function sR(){var t=Y.document;return t?t.documentMode:void 0}var my;e:{var wg="",_g=function(){var t=Rm();if(rR)return/rv:([^\);]+)(\)|;)/.exec(t);if(nR)return/Edge\/([\d\.]+)/.exec(t);if(Bo)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t);if(GB)return/WebKit\/(\S+)/.exec(t);if(qB)return/(?:Version)[ \/]?(\S+)/.exec(t)}();if(_g&&(wg=_g?_g[1]:""),Bo){var Sg=sR();if(Sg!=null&&Sg>parseFloat(wg)){my=String(Sg);break e}}my=wg}var py;if(Y.document&&Bo){var hE=sR();py=hE||parseInt(my,10)||void 0}else py=void 0;var QB=py;function Bc(t,e){if(Xt.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(rR){e:{try{Zv(e.nodeName);var s=!0;break e}catch{}s=!1}s||(e=null)}}else n=="mouseover"?e=t.fromElement:n=="mouseout"&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=t.clientX!==void 0?t.clientX:t.pageX,this.clientY=t.clientY!==void 0?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=typeof t.pointerType=="string"?t.pointerType:KB[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&Bc.$.h.call(this)}}Rt(Bc,Xt);var KB={2:"touch",3:"pen",4:"mouse"};Bc.prototype.h=function(){Bc.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var ku="closure_listenable_"+(1e6*Math.random()|0),XB=0;function YB(t,e,n,r,s){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.la=s,this.key=++XB,this.fa=this.ia=!1}function Am(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function ew(t,e,n){for(const r in t)e.call(n,t[r],r,t)}function JB(t,e){for(const n in t)e.call(void 0,t[n],n,t)}function iR(t){const e={};for(const n in t)e[n]=t[n];return e}const fE="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function aR(t,e){let n,r;for(let s=1;s<arguments.length;s++){r=arguments[s];for(n in r)t[n]=r[n];for(let i=0;i<fE.length;i++)n=fE[i],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function jm(t){this.src=t,this.g={},this.h=0}jm.prototype.add=function(t,e,n,r,s){var i=t.toString();t=this.g[i],t||(t=this.g[i]=[],this.h++);var a=yy(t,e,r,s);return-1<a?(e=t[a],n||(e.ia=!1)):(e=new YB(e,this.src,i,!!r,s),e.ia=n,t.push(e)),e};function gy(t,e){var n=e.type;if(n in t.g){var r=t.g[n],s=tR(r,e),i;(i=0<=s)&&Array.prototype.splice.call(r,s,1),i&&(Am(e),t.g[n].length==0&&(delete t.g[n],t.h--))}}function yy(t,e,n,r){for(var s=0;s<t.length;++s){var i=t[s];if(!i.fa&&i.listener==e&&i.capture==!!n&&i.la==r)return s}return-1}var tw="closure_lm_"+(1e6*Math.random()|0),Eg={};function oR(t,e,n,r,s){if(r&&r.once)return cR(t,e,n,r,s);if(Array.isArray(e)){for(var i=0;i<e.length;i++)oR(t,e[i],n,r,s);return null}return n=sw(n),t&&t[ku]?t.O(e,n,bu(r)?!!r.capture:!!r,s):lR(t,e,n,!1,r,s)}function lR(t,e,n,r,s,i){if(!e)throw Error("Invalid event type");var a=bu(s)?!!s.capture:!!s,l=rw(t);if(l||(t[tw]=l=new jm(t)),n=l.add(e,n,r,a,i),n.proxy)return n;if(r=ZB(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)HB||(s=a),s===void 0&&(s=!1),t.addEventListener(e.toString(),r,s);else if(t.attachEvent)t.attachEvent(dR(e.toString()),r);else if(t.addListener&&t.removeListener)t.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return n}function ZB(){function t(n){return e.call(t.src,t.listener,n)}const e=eU;return t}function cR(t,e,n,r,s){if(Array.isArray(e)){for(var i=0;i<e.length;i++)cR(t,e[i],n,r,s);return null}return n=sw(n),t&&t[ku]?t.P(e,n,bu(r)?!!r.capture:!!r,s):lR(t,e,n,!0,r,s)}function uR(t,e,n,r,s){if(Array.isArray(e))for(var i=0;i<e.length;i++)uR(t,e[i],n,r,s);else r=bu(r)?!!r.capture:!!r,n=sw(n),t&&t[ku]?(t=t.i,e=String(e).toString(),e in t.g&&(i=t.g[e],n=yy(i,n,r,s),-1<n&&(Am(i[n]),Array.prototype.splice.call(i,n,1),i.length==0&&(delete t.g[e],t.h--)))):t&&(t=rw(t))&&(e=t.g[e.toString()],t=-1,e&&(t=yy(e,n,r,s)),(n=-1<t?e[t]:null)&&nw(n))}function nw(t){if(typeof t!="number"&&t&&!t.fa){var e=t.src;if(e&&e[ku])gy(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(dR(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=rw(e))?(gy(n,t),n.h==0&&(n.src=null,e[tw]=null)):Am(t)}}}function dR(t){return t in Eg?Eg[t]:Eg[t]="on"+t}function eU(t,e){if(t.fa)t=!0;else{e=new Bc(e,this);var n=t.listener,r=t.la||t.src;t.ia&&nw(t),t=n.call(r,e)}return t}function rw(t){return t=t[tw],t instanceof jm?t:null}var bg="__closure_events_fn_"+(1e9*Math.random()>>>0);function sw(t){return typeof t=="function"?t:(t[bg]||(t[bg]=function(e){return t.handleEvent(e)}),t[bg])}function It(){$i.call(this),this.i=new jm(this),this.S=this,this.J=null}Rt(It,$i);It.prototype[ku]=!0;It.prototype.removeEventListener=function(t,e,n,r){uR(this,t,e,n,r)};function Dt(t,e){var n,r=t.J;if(r)for(n=[];r;r=r.J)n.push(r);if(t=t.S,r=e.type||e,typeof e=="string")e=new Xt(e,t);else if(e instanceof Xt)e.target=e.target||t;else{var s=e;e=new Xt(r,t),aR(e,s)}if(s=!0,n)for(var i=n.length-1;0<=i;i--){var a=e.g=n[i];s=md(a,r,!0,e)&&s}if(a=e.g=t,s=md(a,r,!0,e)&&s,s=md(a,r,!1,e)&&s,n)for(i=0;i<n.length;i++)a=e.g=n[i],s=md(a,r,!1,e)&&s}It.prototype.N=function(){if(It.$.N.call(this),this.i){var t=this.i,e;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)Am(n[r]);delete t.g[e],t.h--}}this.J=null};It.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)};It.prototype.P=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};function md(t,e,n,r){if(e=t.i.g[String(e)],!e)return!0;e=e.concat();for(var s=!0,i=0;i<e.length;++i){var a=e[i];if(a&&!a.fa&&a.capture==n){var l=a.listener,c=a.la||a.src;a.ia&&gy(t.i,a),s=l.call(c,r)!==!1&&s}}return s&&!r.defaultPrevented}var iw=Y.JSON.stringify;class tU{constructor(e,n){this.i=e,this.j=n,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}function nU(){var t=aw;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}class rU{constructor(){this.h=this.g=null}add(e,n){const r=hR.get();r.set(e,n),this.h?this.h.next=r:this.g=r,this.h=r}}var hR=new tU(()=>new sU,t=>t.reset());class sU{constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}}function iU(t){var e=1;t=t.split(":");const n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function aU(t){Y.setTimeout(()=>{throw t},0)}let Uc,Vc=!1,aw=new rU,fR=()=>{const t=Y.Promise.resolve(void 0);Uc=()=>{t.then(oU)}};var oU=()=>{for(var t;t=nU();){try{t.h.call(t.g)}catch(n){aU(n)}var e=hR;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}Vc=!1};function Nm(t,e){It.call(this),this.h=t||1,this.g=e||Y,this.j=Kt(this.qb,this),this.l=Date.now()}Rt(Nm,It);D=Nm.prototype;D.ga=!1;D.T=null;D.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),Dt(this,"tick"),this.ga&&(ow(this),this.start()))}};D.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function ow(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}D.N=function(){Nm.$.N.call(this),ow(this),delete this.g};function lw(t,e,n){if(typeof t=="function")n&&(t=Kt(t,n));else if(t&&typeof t.handleEvent=="function")t=Kt(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:Y.setTimeout(t,e||0)}function mR(t){t.g=lw(()=>{t.g=null,t.i&&(t.i=!1,mR(t))},t.j);const e=t.h;t.h=null,t.m.apply(null,e)}class lU extends $i{constructor(e,n){super(),this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:mR(this)}N(){super.N(),this.g&&(Y.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Hc(t){$i.call(this),this.h=t,this.g={}}Rt(Hc,$i);var mE=[];function pR(t,e,n,r){Array.isArray(n)||(n&&(mE[0]=n.toString()),n=mE);for(var s=0;s<n.length;s++){var i=oR(e,n[s],r||t.handleEvent,!1,t.h||t);if(!i)break;t.g[i.key]=i}}function gR(t){ew(t.g,function(e,n){this.g.hasOwnProperty(n)&&nw(e)},t),t.g={}}Hc.prototype.N=function(){Hc.$.N.call(this),gR(this)};Hc.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function Pm(){this.g=!0}Pm.prototype.Ea=function(){this.g=!1};function cU(t,e,n,r,s,i){t.info(function(){if(t.g)if(i)for(var a="",l=i.split("&"),c=0;c<l.length;c++){var u=l[c].split("=");if(1<u.length){var d=u[0];u=u[1];var h=d.split("_");a=2<=h.length&&h[1]=="type"?a+(d+"="+u+"&"):a+(d+"=redacted&")}}else a=null;else a=i;return"XMLHTTP REQ ("+r+") [attempt "+s+"]: "+e+`
`+n+`
`+a})}function uU(t,e,n,r,s,i,a){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+s+"]: "+e+`
`+n+`
`+i+" "+a})}function mo(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+hU(t,n)+(r?" "+r:"")})}function dU(t,e){t.info(function(){return"TIMEOUT: "+e})}Pm.prototype.info=function(){};function hU(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n){for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var s=r[1];if(Array.isArray(s)&&!(1>s.length)){var i=s[0];if(i!="noop"&&i!="stop"&&i!="close")for(var a=1;a<s.length;a++)s[a]=""}}}}return iw(n)}catch{return e}}var La={},pE=null;function Fm(){return pE=pE||new It}La.Ta="serverreachability";function yR(t){Xt.call(this,La.Ta,t)}Rt(yR,Xt);function Wc(t){const e=Fm();Dt(e,new yR(e))}La.STAT_EVENT="statevent";function xR(t,e){Xt.call(this,La.STAT_EVENT,t),this.stat=e}Rt(xR,Xt);function un(t){const e=Fm();Dt(e,new xR(e,t))}La.Ua="timingevent";function vR(t,e){Xt.call(this,La.Ua,t),this.size=e}Rt(vR,Xt);function Tu(t,e){if(typeof t!="function")throw Error("Fn must not be null and must be a function");return Y.setTimeout(function(){t()},e)}var Dm={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},wR={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function cw(){}cw.prototype.h=null;function gE(t){return t.h||(t.h=t.i())}function _R(){}var Iu={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function uw(){Xt.call(this,"d")}Rt(uw,Xt);function dw(){Xt.call(this,"c")}Rt(dw,Xt);var xy;function Om(){}Rt(Om,cw);Om.prototype.g=function(){return new XMLHttpRequest};Om.prototype.i=function(){return{}};xy=new Om;function Cu(t,e,n,r){this.l=t,this.j=e,this.m=n,this.W=r||1,this.U=new Hc(this),this.P=fU,t=fy?125:void 0,this.V=new Nm(t),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new SR}function SR(){this.i=null,this.g="",this.h=!1}var fU=45e3,vy={},Gh={};D=Cu.prototype;D.setTimeout=function(t){this.P=t};function wy(t,e,n){t.L=1,t.v=Lm(Ds(e)),t.s=n,t.S=!0,ER(t,null)}function ER(t,e){t.G=Date.now(),Ru(t),t.A=Ds(t.v);var n=t.A,r=t.W;Array.isArray(r)||(r=[String(r)]),jR(n.i,"t",r),t.C=0,n=t.l.J,t.h=new SR,t.g=JR(t.l,n?e:null,!t.s),0<t.O&&(t.M=new lU(Kt(t.Pa,t,t.g),t.O)),pR(t.U,t.g,"readystatechange",t.nb),e=t.I?iR(t.I):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.A,t.u,t.s,e)):(t.u="GET",t.g.ha(t.A,t.u,null,e)),Wc(),cU(t.j,t.u,t.A,t.m,t.W,t.s)}D.nb=function(t){t=t.target;const e=this.M;e&&Vr(t)==3?e.l():this.Pa(t)};D.Pa=function(t){try{if(t==this.g)e:{const d=Vr(this.g);var e=this.g.Ia();const h=this.g.da();if(!(3>d)&&(d!=3||fy||this.g&&(this.h.h||this.g.ja()||wE(this.g)))){this.J||d!=4||e==7||(e==8||0>=h?Wc(3):Wc(2)),Mm(this);var n=this.g.da();this.ca=n;t:if(bR(this)){var r=wE(this.g);t="";var s=r.length,i=Vr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){aa(this),ic(this);var a="";break t}this.h.i=new Y.TextDecoder}for(e=0;e<s;e++)this.h.h=!0,t+=this.h.i.decode(r[e],{stream:i&&e==s-1});r.splice(0,s),this.h.g+=t,this.C=0,a=this.h.g}else a=this.g.ja();if(this.i=n==200,uU(this.j,this.u,this.A,this.m,this.W,d,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var l,c=this.g;if((l=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!zc(l)){var u=l;break t}}u=null}if(n=u)mo(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,_y(this,n);else{this.i=!1,this.o=3,un(12),aa(this),ic(this);break e}}this.S?(kR(this,d,a),fy&&this.i&&d==3&&(pR(this.U,this.V,"tick",this.mb),this.V.start())):(mo(this.j,this.m,a,null),_y(this,a)),d==4&&aa(this),this.i&&!this.J&&(d==4?QR(this.l,this):(this.i=!1,Ru(this)))}else FU(this.g),n==400&&0<a.indexOf("Unknown SID")?(this.o=3,un(12)):(this.o=0,un(13)),aa(this),ic(this)}}}catch{}finally{}};function bR(t){return t.g?t.u=="GET"&&t.L!=2&&t.l.Ha:!1}function kR(t,e,n){let r=!0,s;for(;!t.J&&t.C<n.length;)if(s=mU(t,n),s==Gh){e==4&&(t.o=4,un(14),r=!1),mo(t.j,t.m,null,"[Incomplete Response]");break}else if(s==vy){t.o=4,un(15),mo(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}else mo(t.j,t.m,s,null),_y(t,s);bR(t)&&s!=Gh&&s!=vy&&(t.h.g="",t.C=0),e!=4||n.length!=0||t.h.h||(t.o=1,un(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.ba&&(t.ba=!0,e=t.l,e.g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),yw(e),e.M=!0,un(11))):(mo(t.j,t.m,n,"[Invalid Chunked Response]"),aa(t),ic(t))}D.mb=function(){if(this.g){var t=Vr(this.g),e=this.g.ja();this.C<e.length&&(Mm(this),kR(this,t,e),this.i&&t!=4&&Ru(this))}};function mU(t,e){var n=t.C,r=e.indexOf(`
`,n);return r==-1?Gh:(n=Number(e.substring(n,r)),isNaN(n)?vy:(r+=1,r+n>e.length?Gh:(e=e.slice(r,r+n),t.C=r+n,e)))}D.cancel=function(){this.J=!0,aa(this)};function Ru(t){t.Y=Date.now()+t.P,TR(t,t.P)}function TR(t,e){if(t.B!=null)throw Error("WatchDog timer not null");t.B=Tu(Kt(t.lb,t),e)}function Mm(t){t.B&&(Y.clearTimeout(t.B),t.B=null)}D.lb=function(){this.B=null;const t=Date.now();0<=t-this.Y?(dU(this.j,this.A),this.L!=2&&(Wc(),un(17)),aa(this),this.o=2,ic(this)):TR(this,this.Y-t)};function ic(t){t.l.H==0||t.J||QR(t.l,t)}function aa(t){Mm(t);var e=t.M;e&&typeof e.sa=="function"&&e.sa(),t.M=null,ow(t.V),gR(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function _y(t,e){try{var n=t.l;if(n.H!=0&&(n.g==t||Sy(n.i,t))){if(!t.K&&Sy(n.i,t)&&n.H==3){try{var r=n.Ja.g.parse(e)}catch{r=null}if(Array.isArray(r)&&r.length==3){var s=r;if(s[0]==0){e:if(!n.u){if(n.g)if(n.g.G+3e3<t.G)Xh(n),Um(n);else break e;gw(n),un(18)}}else n.Fa=s[1],0<n.Fa-n.V&&37500>s[2]&&n.G&&n.A==0&&!n.v&&(n.v=Tu(Kt(n.ib,n),6e3));if(1>=FR(n.i)&&n.oa){try{n.oa()}catch{}n.oa=void 0}}else oa(n,11)}else if((t.K||n.g==t)&&Xh(n),!zc(e))for(s=n.Ja.g.parse(e),e=0;e<s.length;e++){let u=s[e];if(n.V=u[0],u=u[1],n.H==2)if(u[0]=="c"){n.K=u[1],n.pa=u[2];const d=u[3];d!=null&&(n.ra=d,n.l.info("VER="+n.ra));const h=u[4];h!=null&&(n.Ga=h,n.l.info("SVER="+n.Ga));const m=u[5];m!=null&&typeof m=="number"&&0<m&&(r=1.5*m,n.L=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;const p=t.g;if(p){const g=p.g?p.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(g){var i=r.i;i.g||g.indexOf("spdy")==-1&&g.indexOf("quic")==-1&&g.indexOf("h2")==-1||(i.j=i.l,i.g=new Set,i.h&&(hw(i,i.h),i.h=null))}if(r.F){const y=p.g?p.g.getResponseHeader("X-HTTP-Session-Id"):null;y&&(r.Da=y,$e(r.I,r.F,y))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-t.G,n.l.info("Handshake RTT: "+n.S+"ms")),r=n;var a=t;if(r.wa=YR(r,r.J?r.pa:null,r.Y),a.K){DR(r.i,a);var l=a,c=r.L;c&&l.setTimeout(c),l.B&&(Mm(l),Ru(l)),r.g=a}else qR(r);0<n.j.length&&Vm(n)}else u[0]!="stop"&&u[0]!="close"||oa(n,7);else n.H==3&&(u[0]=="stop"||u[0]=="close"?u[0]=="stop"?oa(n,7):pw(n):u[0]!="noop"&&n.h&&n.h.Aa(u),n.A=0)}}Wc(4)}catch{}}function pU(t){if(t.Z&&typeof t.Z=="function")return t.Z();if(typeof Map<"u"&&t instanceof Map||typeof Set<"u"&&t instanceof Set)return Array.from(t.values());if(typeof t=="string")return t.split("");if(Cm(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}e=[],n=0;for(r in t)e[n++]=t[r];return e}function gU(t){if(t.ta&&typeof t.ta=="function")return t.ta();if(!t.Z||typeof t.Z!="function"){if(typeof Map<"u"&&t instanceof Map)return Array.from(t.keys());if(!(typeof Set<"u"&&t instanceof Set)){if(Cm(t)||typeof t=="string"){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(const r in t)e[n++]=r;return e}}}function IR(t,e){if(t.forEach&&typeof t.forEach=="function")t.forEach(e,void 0);else if(Cm(t)||typeof t=="string")Array.prototype.forEach.call(t,e,void 0);else for(var n=gU(t),r=pU(t),s=r.length,i=0;i<s;i++)e.call(void 0,r[i],n&&n[i],t)}var CR=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function yU(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),s=null;if(0<=r){var i=t[n].substring(0,r);s=t[n].substring(r+1)}else i=t[n];e(i,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}function ha(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof ha){this.h=t.h,Qh(this,t.j),this.s=t.s,this.g=t.g,Kh(this,t.m),this.l=t.l;var e=t.i,n=new qc;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),yE(this,n),this.o=t.o}else t&&(e=String(t).match(CR))?(this.h=!1,Qh(this,e[1]||"",!0),this.s=Hl(e[2]||""),this.g=Hl(e[3]||"",!0),Kh(this,e[4]),this.l=Hl(e[5]||"",!0),yE(this,e[6]||"",!0),this.o=Hl(e[7]||"")):(this.h=!1,this.i=new qc(null,this.h))}ha.prototype.toString=function(){var t=[],e=this.j;e&&t.push(Wl(e,xE,!0),":");var n=this.g;return(n||e=="file")&&(t.push("//"),(e=this.s)&&t.push(Wl(e,xE,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&t.push(":",String(n))),(n=this.l)&&(this.g&&n.charAt(0)!="/"&&t.push("/"),t.push(Wl(n,n.charAt(0)=="/"?wU:vU,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",Wl(n,SU)),t.join("")};function Ds(t){return new ha(t)}function Qh(t,e,n){t.j=n?Hl(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function Kh(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function yE(t,e,n){e instanceof qc?(t.i=e,EU(t.i,t.h)):(n||(e=Wl(e,_U)),t.i=new qc(e,t.h))}function $e(t,e,n){t.i.set(e,n)}function Lm(t){return $e(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function Hl(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Wl(t,e,n){return typeof t=="string"?(t=encodeURI(t).replace(e,xU),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function xU(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(t&15).toString(16)}var xE=/[#\/\?@]/g,vU=/[#\?:]/g,wU=/[#\?]/g,_U=/[#\?@]/g,SU=/#/g;function qc(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function zi(t){t.g||(t.g=new Map,t.h=0,t.i&&yU(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}D=qc.prototype;D.add=function(t,e){zi(this),this.i=null,t=ul(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this};function RR(t,e){zi(t),e=ul(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function AR(t,e){return zi(t),e=ul(t,e),t.g.has(e)}D.forEach=function(t,e){zi(this),this.g.forEach(function(n,r){n.forEach(function(s){t.call(e,s,r,this)},this)},this)};D.ta=function(){zi(this);const t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let r=0;r<e.length;r++){const s=t[r];for(let i=0;i<s.length;i++)n.push(e[r])}return n};D.Z=function(t){zi(this);let e=[];if(typeof t=="string")AR(this,t)&&(e=e.concat(this.g.get(ul(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e};D.set=function(t,e){return zi(this),this.i=null,t=ul(this,t),AR(this,t)&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this};D.get=function(t,e){return t?(t=this.Z(t),0<t.length?String(t[0]):e):e};function jR(t,e,n){RR(t,e),0<n.length&&(t.i=null,t.g.set(ul(t,e),Jv(n)),t.h+=n.length)}D.toString=function(){if(this.i)return this.i;if(!this.g)return"";const t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var r=e[n];const i=encodeURIComponent(String(r)),a=this.Z(r);for(r=0;r<a.length;r++){var s=i;a[r]!==""&&(s+="="+encodeURIComponent(String(a[r]))),t.push(s)}}return this.i=t.join("&")};function ul(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function EU(t,e){e&&!t.j&&(zi(t),t.i=null,t.g.forEach(function(n,r){var s=r.toLowerCase();r!=s&&(RR(this,r),jR(this,s,n))},t)),t.j=e}var bU=class{constructor(t,e){this.g=t,this.map=e}};function NR(t){this.l=t||kU,Y.PerformanceNavigationTiming?(t=Y.performance.getEntriesByType("navigation"),t=0<t.length&&(t[0].nextHopProtocol=="hq"||t[0].nextHopProtocol=="h2")):t=!!(Y.g&&Y.g.Ka&&Y.g.Ka()&&Y.g.Ka().ec),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var kU=10;function PR(t){return t.h?!0:t.g?t.g.size>=t.j:!1}function FR(t){return t.h?1:t.g?t.g.size:0}function Sy(t,e){return t.h?t.h==e:t.g?t.g.has(e):!1}function hw(t,e){t.g?t.g.add(e):t.h=e}function DR(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}NR.prototype.cancel=function(){if(this.i=OR(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const t of this.g.values())t.cancel();this.g.clear()}};function OR(t){if(t.h!=null)return t.i.concat(t.h.F);if(t.g!=null&&t.g.size!==0){let e=t.i;for(const n of t.g.values())e=e.concat(n.F);return e}return Jv(t.i)}var TU=class{stringify(t){return Y.JSON.stringify(t,void 0)}parse(t){return Y.JSON.parse(t,void 0)}};function IU(){this.g=new TU}function CU(t,e,n){const r=n||"";try{IR(t,function(s,i){let a=s;bu(s)&&(a=iw(s)),e.push(r+i+"="+encodeURIComponent(a))})}catch(s){throw e.push(r+"type="+encodeURIComponent("_badmap")),s}}function RU(t,e){const n=new Pm;if(Y.Image){const r=new Image;r.onload=fd(pd,n,r,"TestLoadImage: loaded",!0,e),r.onerror=fd(pd,n,r,"TestLoadImage: error",!1,e),r.onabort=fd(pd,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=fd(pd,n,r,"TestLoadImage: timeout",!1,e),Y.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}function pd(t,e,n,r,s){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,s(r)}catch{}}function $m(t){this.l=t.fc||null,this.j=t.ob||!1}Rt($m,cw);$m.prototype.g=function(){return new zm(this.l,this.j)};$m.prototype.i=function(t){return function(){return t}}({});function zm(t,e){It.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=fw,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Rt(zm,It);var fw=0;D=zm.prototype;D.open=function(t,e){if(this.readyState!=fw)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Gc(this)};D.send=function(t){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||Y).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))};D.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Au(this)),this.readyState=fw};D.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Gc(this)),this.g&&(this.readyState=3,Gc(this),this.g)))if(this.responseType==="arraybuffer")t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof Y.ReadableStream<"u"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;MR(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))};function MR(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}D.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?Au(this):Gc(this),this.readyState==3&&MR(this)}};D.Za=function(t){this.g&&(this.response=this.responseText=t,Au(this))};D.Ya=function(t){this.g&&(this.response=t,Au(this))};D.ka=function(){this.g&&Au(this)};function Au(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Gc(t)}D.setRequestHeader=function(t,e){this.v.append(t,e)};D.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""};D.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join(`\r
`)};function Gc(t){t.onreadystatechange&&t.onreadystatechange.call(t)}Object.defineProperty(zm.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(t){this.m=t?"include":"same-origin"}});var AU=Y.JSON.parse;function nt(t){It.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=LR,this.L=this.M=!1}Rt(nt,It);var LR="",jU=/^https?$/i,NU=["POST","PUT"];D=nt.prototype;D.Oa=function(t){this.M=t};D.ha=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():xy.g(),this.C=this.u?gE(this.u):gE(xy),this.g.onreadystatechange=Kt(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(i){vE(this,i);return}if(t=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var s in r)n.set(s,r[s]);else if(typeof r.keys=="function"&&typeof r.get=="function")for(const i of r.keys())n.set(i,r.get(i));else throw Error("Unknown input type for opt_headers: "+String(r));r=Array.from(n.keys()).find(i=>i.toLowerCase()=="content-type"),s=Y.FormData&&t instanceof Y.FormData,!(0<=tR(NU,e))||r||s||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[i,a]of n)this.g.setRequestHeader(i,a);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{BR(this),0<this.B&&((this.L=PU(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Kt(this.ua,this)):this.A=lw(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(i){vE(this,i)}};function PU(t){return Bo&&typeof t.timeout=="number"&&t.ontimeout!==void 0}D.ua=function(){typeof Yv<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Dt(this,"timeout"),this.abort(8))};function vE(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,$R(t),Bm(t)}function $R(t){t.F||(t.F=!0,Dt(t,"complete"),Dt(t,"error"))}D.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,Dt(this,"complete"),Dt(this,"abort"),Bm(this))};D.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Bm(this,!0)),nt.$.N.call(this)};D.La=function(){this.s||(this.G||this.v||this.l?zR(this):this.kb())};D.kb=function(){zR(this)};function zR(t){if(t.h&&typeof Yv<"u"&&(!t.C[1]||Vr(t)!=4||t.da()!=2)){if(t.v&&Vr(t)==4)lw(t.La,0,t);else if(Dt(t,"readystatechange"),Vr(t)==4){t.h=!1;try{const a=t.da();e:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var r;if(r=a===0){var s=String(t.I).match(CR)[1]||null;!s&&Y.self&&Y.self.location&&(s=Y.self.location.protocol.slice(0,-1)),r=!jU.test(s?s.toLowerCase():"")}n=r}if(n)Dt(t,"complete"),Dt(t,"success");else{t.m=6;try{var i=2<Vr(t)?t.g.statusText:""}catch{i=""}t.j=i+" ["+t.da()+"]",$R(t)}}finally{Bm(t)}}}}function Bm(t,e){if(t.g){BR(t);const n=t.g,r=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||Dt(t,"ready");try{n.onreadystatechange=r}catch{}}}function BR(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(Y.clearTimeout(t.A),t.A=null)}D.isActive=function(){return!!this.g};function Vr(t){return t.g?t.g.readyState:0}D.da=function(){try{return 2<Vr(this)?this.g.status:-1}catch{return-1}};D.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};D.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&e.indexOf(t)==0&&(e=e.substring(t.length)),AU(e)}};function wE(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case LR:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}function FU(t){const e={};t=(t.g&&2<=Vr(t)&&t.g.getAllResponseHeaders()||"").split(`\r
`);for(let r=0;r<t.length;r++){if(zc(t[r]))continue;var n=iU(t[r]);const s=n[0];if(n=n[1],typeof n!="string")continue;n=n.trim();const i=e[s]||[];e[s]=i,i.push(n)}JB(e,function(r){return r.join(", ")})}D.Ia=function(){return this.m};D.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function UR(t){let e="";return ew(t,function(n,r){e+=r,e+=":",e+=n,e+=`\r
`}),e}function mw(t,e,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=UR(n),typeof t=="string"?n!=null&&encodeURIComponent(String(n)):$e(t,e,n))}function Nl(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function VR(t){this.Ga=0,this.j=[],this.l=new Pm,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=Nl("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=Nl("baseRetryDelayMs",5e3,t),this.hb=Nl("retryDelaySeedMs",1e4,t),this.eb=Nl("forwardChannelMaxRetries",2,t),this.xa=Nl("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.dc||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new NR(t&&t.concurrentRequestLimit),this.Ja=new IU,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}D=VR.prototype;D.ra=8;D.H=1;function pw(t){if(HR(t),t.H==3){var e=t.W++,n=Ds(t.I);if($e(n,"SID",t.K),$e(n,"RID",e),$e(n,"TYPE","terminate"),ju(t,n),e=new Cu(t,t.l,e),e.L=2,e.v=Lm(Ds(n)),n=!1,Y.navigator&&Y.navigator.sendBeacon)try{n=Y.navigator.sendBeacon(e.v.toString(),"")}catch{}!n&&Y.Image&&(new Image().src=e.v,n=!0),n||(e.g=JR(e.l,null),e.g.ha(e.v)),e.G=Date.now(),Ru(e)}XR(t)}function Um(t){t.g&&(yw(t),t.g.cancel(),t.g=null)}function HR(t){Um(t),t.u&&(Y.clearTimeout(t.u),t.u=null),Xh(t),t.i.cancel(),t.m&&(typeof t.m=="number"&&Y.clearTimeout(t.m),t.m=null)}function Vm(t){if(!PR(t.i)&&!t.m){t.m=!0;var e=t.Na;Uc||fR(),Vc||(Uc(),Vc=!0),aw.add(e,t),t.C=0}}function DU(t,e){return FR(t.i)>=t.i.j-(t.m?1:0)?!1:t.m?(t.j=e.F.concat(t.j),!0):t.H==1||t.H==2||t.C>=(t.cb?0:t.eb)?!1:(t.m=Tu(Kt(t.Na,t,e),KR(t,t.C)),t.C++,!0)}D.Na=function(t){if(this.m)if(this.m=null,this.H==1){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;const s=new Cu(this,this.l,t);let i=this.s;if(this.U&&(i?(i=iR(i),aR(i,this.U)):i=this.U),this.o!==null||this.O||(s.I=i,i=null),this.P)e:{for(var e=0,n=0;n<this.j.length;n++){t:{var r=this.j[n];if("__data__"in r.map&&(r=r.map.__data__,typeof r=="string")){r=r.length;break t}r=void 0}if(r===void 0)break;if(e+=r,4096<e){e=n;break e}if(e===4096||n===this.j.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=WR(this,s,e),n=Ds(this.I),$e(n,"RID",t),$e(n,"CVER",22),this.F&&$e(n,"X-HTTP-Session-Id",this.F),ju(this,n),i&&(this.O?e="headers="+encodeURIComponent(String(UR(i)))+"&"+e:this.o&&mw(n,this.o,i)),hw(this.i,s),this.bb&&$e(n,"TYPE","init"),this.P?($e(n,"$req",e),$e(n,"SID","null"),s.aa=!0,wy(s,n,null)):wy(s,n,e),this.H=2}}else this.H==3&&(t?_E(this,t):this.j.length==0||PR(this.i)||_E(this))};function _E(t,e){var n;e?n=e.m:n=t.W++;const r=Ds(t.I);$e(r,"SID",t.K),$e(r,"RID",n),$e(r,"AID",t.V),ju(t,r),t.o&&t.s&&mw(r,t.o,t.s),n=new Cu(t,t.l,n,t.C+1),t.o===null&&(n.I=t.s),e&&(t.j=e.F.concat(t.j)),e=WR(t,n,1e3),n.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),hw(t.i,n),wy(n,r,e)}function ju(t,e){t.na&&ew(t.na,function(n,r){$e(e,r,n)}),t.h&&IR({},function(n,r){$e(e,r,n)})}function WR(t,e,n){n=Math.min(t.j.length,n);var r=t.h?Kt(t.h.Va,t.h,t):null;e:{var s=t.j;let i=-1;for(;;){const a=["count="+n];i==-1?0<n?(i=s[0].g,a.push("ofs="+i)):i=0:a.push("ofs="+i);let l=!0;for(let c=0;c<n;c++){let u=s[c].g;const d=s[c].map;if(u-=i,0>u)i=Math.max(0,s[c].g-100),l=!1;else try{CU(d,a,"req"+u+"_")}catch{r&&r(d)}}if(l){r=a.join("&");break e}}}return t=t.j.splice(0,n),e.F=t,r}function qR(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;Uc||fR(),Vc||(Uc(),Vc=!0),aw.add(e,t),t.A=0}}function gw(t){return t.g||t.u||3<=t.A?!1:(t.ba++,t.u=Tu(Kt(t.Ma,t),KR(t,t.A)),t.A++,!0)}D.Ma=function(){if(this.u=null,GR(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=Tu(Kt(this.jb,this),t)}};D.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,un(10),Um(this),GR(this))};function yw(t){t.B!=null&&(Y.clearTimeout(t.B),t.B=null)}function GR(t){t.g=new Cu(t,t.l,"rpc",t.ba),t.o===null&&(t.g.I=t.s),t.g.O=0;var e=Ds(t.wa);$e(e,"RID","rpc"),$e(e,"SID",t.K),$e(e,"AID",t.V),$e(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&$e(e,"TO",t.qa),$e(e,"TYPE","xmlhttp"),ju(t,e),t.o&&t.s&&mw(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var n=t.g;t=t.pa,n.L=1,n.v=Lm(Ds(e)),n.s=null,n.S=!0,ER(n,t)}D.ib=function(){this.v!=null&&(this.v=null,Um(this),gw(this),un(19))};function Xh(t){t.v!=null&&(Y.clearTimeout(t.v),t.v=null)}function QR(t,e){var n=null;if(t.g==e){Xh(t),yw(t),t.g=null;var r=2}else if(Sy(t.i,e))n=e.F,DR(t.i,e),r=1;else return;if(t.H!=0){if(e.i)if(r==1){n=e.s?e.s.length:0,e=Date.now()-e.G;var s=t.C;r=Fm(),Dt(r,new vR(r,n)),Vm(t)}else qR(t);else if(s=e.o,s==3||s==0&&0<e.ca||!(r==1&&DU(t,e)||r==2&&gw(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),s){case 1:oa(t,5);break;case 4:oa(t,10);break;case 3:oa(t,6);break;default:oa(t,2)}}}function KR(t,e){let n=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(n*=2),n*e}function oa(t,e){if(t.l.info("Error code "+e),e==2){var n=null;t.h&&(n=null);var r=Kt(t.pb,t);n||(n=new ha("//www.google.com/images/cleardot.gif"),Y.location&&Y.location.protocol=="http"||Qh(n,"https"),Lm(n)),RU(n.toString(),r)}else un(2);t.H=0,t.h&&t.h.za(e),XR(t),HR(t)}D.pb=function(t){t?(this.l.info("Successfully pinged google.com"),un(2)):(this.l.info("Failed to ping google.com"),un(1))};function XR(t){if(t.H=0,t.ma=[],t.h){const e=OR(t.i);(e.length!=0||t.j.length!=0)&&(dE(t.ma,e),dE(t.ma,t.j),t.i.i.length=0,Jv(t.j),t.j.length=0),t.h.ya()}}function YR(t,e,n){var r=n instanceof ha?Ds(n):new ha(n);if(r.g!="")e&&(r.g=e+"."+r.g),Kh(r,r.m);else{var s=Y.location;r=s.protocol,e=e?e+"."+s.hostname:s.hostname,s=+s.port;var i=new ha(null);r&&Qh(i,r),e&&(i.g=e),s&&Kh(i,s),n&&(i.l=n),r=i}return n=t.F,e=t.Da,n&&e&&$e(r,n,e),$e(r,"VER",t.ra),ju(t,r),r}function JR(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return e=n&&t.Ha&&!t.va?new nt(new $m({ob:!0})):new nt(t.va),e.Oa(t.J),e}D.isActive=function(){return!!this.h&&this.h.isActive(this)};function ZR(){}D=ZR.prototype;D.Ba=function(){};D.Aa=function(){};D.za=function(){};D.ya=function(){};D.isActive=function(){return!0};D.Va=function(){};function Yh(){if(Bo&&!(10<=Number(QB)))throw Error("Environmental error: no available transport.")}Yh.prototype.g=function(t,e){return new Vn(t,e)};function Vn(t,e){It.call(this),this.g=new VR(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!zc(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!zc(e)&&(this.g.F=e,t=this.h,t!==null&&e in t&&(t=this.h,e in t&&delete t[e])),this.j=new dl(this)}Rt(Vn,It);Vn.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,n=this.h||void 0;un(0),t.Y=e,t.na=n||{},t.G=t.aa,t.I=YR(t,null,t.Y),Vm(t)};Vn.prototype.close=function(){pw(this.g)};Vn.prototype.u=function(t){var e=this.g;if(typeof t=="string"){var n={};n.__data__=t,t=n}else this.v&&(n={},n.__data__=iw(t),t=n);e.j.push(new bU(e.fb++,t)),e.H==3&&Vm(e)};Vn.prototype.N=function(){this.g.h=null,delete this.j,pw(this.g),delete this.g,Vn.$.N.call(this)};function eA(t){uw.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){e:{for(const n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=e!==null&&t in e?e[t]:void 0),this.data=e}else this.data=t}Rt(eA,uw);function tA(){dw.call(this),this.status=1}Rt(tA,dw);function dl(t){this.g=t}Rt(dl,ZR);dl.prototype.Ba=function(){Dt(this.g,"a")};dl.prototype.Aa=function(t){Dt(this.g,new eA(t))};dl.prototype.za=function(t){Dt(this.g,new tA)};dl.prototype.ya=function(){Dt(this.g,"b")};function OU(){this.blockSize=-1}function Rr(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}Rt(Rr,OU);Rr.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function kg(t,e,n){n||(n=0);var r=Array(16);if(typeof e=="string")for(var s=0;16>s;++s)r[s]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(s=0;16>s;++s)r[s]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],s=t.g[2];var i=t.g[3],a=e+(i^n&(s^i))+r[0]+3614090360&4294967295;e=n+(a<<7&4294967295|a>>>25),a=i+(s^e&(n^s))+r[1]+3905402710&4294967295,i=e+(a<<12&4294967295|a>>>20),a=s+(n^i&(e^n))+r[2]+606105819&4294967295,s=i+(a<<17&4294967295|a>>>15),a=n+(e^s&(i^e))+r[3]+3250441966&4294967295,n=s+(a<<22&4294967295|a>>>10),a=e+(i^n&(s^i))+r[4]+4118548399&4294967295,e=n+(a<<7&4294967295|a>>>25),a=i+(s^e&(n^s))+r[5]+1200080426&4294967295,i=e+(a<<12&4294967295|a>>>20),a=s+(n^i&(e^n))+r[6]+2821735955&4294967295,s=i+(a<<17&4294967295|a>>>15),a=n+(e^s&(i^e))+r[7]+4249261313&4294967295,n=s+(a<<22&4294967295|a>>>10),a=e+(i^n&(s^i))+r[8]+1770035416&4294967295,e=n+(a<<7&4294967295|a>>>25),a=i+(s^e&(n^s))+r[9]+2336552879&4294967295,i=e+(a<<12&4294967295|a>>>20),a=s+(n^i&(e^n))+r[10]+4294925233&4294967295,s=i+(a<<17&4294967295|a>>>15),a=n+(e^s&(i^e))+r[11]+2304563134&4294967295,n=s+(a<<22&4294967295|a>>>10),a=e+(i^n&(s^i))+r[12]+1804603682&4294967295,e=n+(a<<7&4294967295|a>>>25),a=i+(s^e&(n^s))+r[13]+4254626195&4294967295,i=e+(a<<12&4294967295|a>>>20),a=s+(n^i&(e^n))+r[14]+2792965006&4294967295,s=i+(a<<17&4294967295|a>>>15),a=n+(e^s&(i^e))+r[15]+1236535329&4294967295,n=s+(a<<22&4294967295|a>>>10),a=e+(s^i&(n^s))+r[1]+4129170786&4294967295,e=n+(a<<5&4294967295|a>>>27),a=i+(n^s&(e^n))+r[6]+3225465664&4294967295,i=e+(a<<9&4294967295|a>>>23),a=s+(e^n&(i^e))+r[11]+643717713&4294967295,s=i+(a<<14&4294967295|a>>>18),a=n+(i^e&(s^i))+r[0]+3921069994&4294967295,n=s+(a<<20&4294967295|a>>>12),a=e+(s^i&(n^s))+r[5]+3593408605&4294967295,e=n+(a<<5&4294967295|a>>>27),a=i+(n^s&(e^n))+r[10]+38016083&4294967295,i=e+(a<<9&4294967295|a>>>23),a=s+(e^n&(i^e))+r[15]+3634488961&4294967295,s=i+(a<<14&4294967295|a>>>18),a=n+(i^e&(s^i))+r[4]+3889429448&4294967295,n=s+(a<<20&4294967295|a>>>12),a=e+(s^i&(n^s))+r[9]+568446438&4294967295,e=n+(a<<5&4294967295|a>>>27),a=i+(n^s&(e^n))+r[14]+3275163606&4294967295,i=e+(a<<9&4294967295|a>>>23),a=s+(e^n&(i^e))+r[3]+4107603335&4294967295,s=i+(a<<14&4294967295|a>>>18),a=n+(i^e&(s^i))+r[8]+1163531501&4294967295,n=s+(a<<20&4294967295|a>>>12),a=e+(s^i&(n^s))+r[13]+2850285829&4294967295,e=n+(a<<5&4294967295|a>>>27),a=i+(n^s&(e^n))+r[2]+4243563512&4294967295,i=e+(a<<9&4294967295|a>>>23),a=s+(e^n&(i^e))+r[7]+1735328473&4294967295,s=i+(a<<14&4294967295|a>>>18),a=n+(i^e&(s^i))+r[12]+2368359562&4294967295,n=s+(a<<20&4294967295|a>>>12),a=e+(n^s^i)+r[5]+4294588738&4294967295,e=n+(a<<4&4294967295|a>>>28),a=i+(e^n^s)+r[8]+2272392833&4294967295,i=e+(a<<11&4294967295|a>>>21),a=s+(i^e^n)+r[11]+1839030562&4294967295,s=i+(a<<16&4294967295|a>>>16),a=n+(s^i^e)+r[14]+4259657740&4294967295,n=s+(a<<23&4294967295|a>>>9),a=e+(n^s^i)+r[1]+2763975236&4294967295,e=n+(a<<4&4294967295|a>>>28),a=i+(e^n^s)+r[4]+1272893353&4294967295,i=e+(a<<11&4294967295|a>>>21),a=s+(i^e^n)+r[7]+4139469664&4294967295,s=i+(a<<16&4294967295|a>>>16),a=n+(s^i^e)+r[10]+3200236656&4294967295,n=s+(a<<23&4294967295|a>>>9),a=e+(n^s^i)+r[13]+681279174&4294967295,e=n+(a<<4&4294967295|a>>>28),a=i+(e^n^s)+r[0]+3936430074&4294967295,i=e+(a<<11&4294967295|a>>>21),a=s+(i^e^n)+r[3]+3572445317&4294967295,s=i+(a<<16&4294967295|a>>>16),a=n+(s^i^e)+r[6]+76029189&4294967295,n=s+(a<<23&4294967295|a>>>9),a=e+(n^s^i)+r[9]+3654602809&4294967295,e=n+(a<<4&4294967295|a>>>28),a=i+(e^n^s)+r[12]+3873151461&4294967295,i=e+(a<<11&4294967295|a>>>21),a=s+(i^e^n)+r[15]+530742520&4294967295,s=i+(a<<16&4294967295|a>>>16),a=n+(s^i^e)+r[2]+3299628645&4294967295,n=s+(a<<23&4294967295|a>>>9),a=e+(s^(n|~i))+r[0]+4096336452&4294967295,e=n+(a<<6&4294967295|a>>>26),a=i+(n^(e|~s))+r[7]+1126891415&4294967295,i=e+(a<<10&4294967295|a>>>22),a=s+(e^(i|~n))+r[14]+2878612391&4294967295,s=i+(a<<15&4294967295|a>>>17),a=n+(i^(s|~e))+r[5]+4237533241&4294967295,n=s+(a<<21&4294967295|a>>>11),a=e+(s^(n|~i))+r[12]+1700485571&4294967295,e=n+(a<<6&4294967295|a>>>26),a=i+(n^(e|~s))+r[3]+2399980690&4294967295,i=e+(a<<10&4294967295|a>>>22),a=s+(e^(i|~n))+r[10]+4293915773&4294967295,s=i+(a<<15&4294967295|a>>>17),a=n+(i^(s|~e))+r[1]+2240044497&4294967295,n=s+(a<<21&4294967295|a>>>11),a=e+(s^(n|~i))+r[8]+1873313359&4294967295,e=n+(a<<6&4294967295|a>>>26),a=i+(n^(e|~s))+r[15]+4264355552&4294967295,i=e+(a<<10&4294967295|a>>>22),a=s+(e^(i|~n))+r[6]+2734768916&4294967295,s=i+(a<<15&4294967295|a>>>17),a=n+(i^(s|~e))+r[13]+1309151649&4294967295,n=s+(a<<21&4294967295|a>>>11),a=e+(s^(n|~i))+r[4]+4149444226&4294967295,e=n+(a<<6&4294967295|a>>>26),a=i+(n^(e|~s))+r[11]+3174756917&4294967295,i=e+(a<<10&4294967295|a>>>22),a=s+(e^(i|~n))+r[2]+718787259&4294967295,s=i+(a<<15&4294967295|a>>>17),a=n+(i^(s|~e))+r[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(s+(a<<21&4294967295|a>>>11))&4294967295,t.g[2]=t.g[2]+s&4294967295,t.g[3]=t.g[3]+i&4294967295}Rr.prototype.j=function(t,e){e===void 0&&(e=t.length);for(var n=e-this.blockSize,r=this.m,s=this.h,i=0;i<e;){if(s==0)for(;i<=n;)kg(this,t,i),i+=this.blockSize;if(typeof t=="string"){for(;i<e;)if(r[s++]=t.charCodeAt(i++),s==this.blockSize){kg(this,r),s=0;break}}else for(;i<e;)if(r[s++]=t[i++],s==this.blockSize){kg(this,r),s=0;break}}this.h=s,this.i+=e};Rr.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=n&255,n/=256;for(this.j(t),t=Array(16),e=n=0;4>e;++e)for(var r=0;32>r;r+=8)t[n++]=this.g[e]>>>r&255;return t};function Re(t,e){this.h=e;for(var n=[],r=!0,s=t.length-1;0<=s;s--){var i=t[s]|0;r&&i==e||(n[s]=i,r=!1)}this.g=n}var MU={};function xw(t){return-128<=t&&128>t?WB(t,function(e){return new Re([e|0],0>e?-1:0)}):new Re([t|0],0>t?-1:0)}function Hr(t){if(isNaN(t)||!isFinite(t))return To;if(0>t)return Pt(Hr(-t));for(var e=[],n=1,r=0;t>=n;r++)e[r]=t/n|0,n*=Ey;return new Re(e,0)}function nA(t,e){if(t.length==0)throw Error("number format error: empty string");if(e=e||10,2>e||36<e)throw Error("radix out of range: "+e);if(t.charAt(0)=="-")return Pt(nA(t.substring(1),e));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var n=Hr(Math.pow(e,8)),r=To,s=0;s<t.length;s+=8){var i=Math.min(8,t.length-s),a=parseInt(t.substring(s,s+i),e);8>i?(i=Hr(Math.pow(e,i)),r=r.R(i).add(Hr(a))):(r=r.R(n),r=r.add(Hr(a)))}return r}var Ey=4294967296,To=xw(0),by=xw(1),SE=xw(16777216);D=Re.prototype;D.ea=function(){if(rr(this))return-Pt(this).ea();for(var t=0,e=1,n=0;n<this.g.length;n++){var r=this.D(n);t+=(0<=r?r:Ey+r)*e,e*=Ey}return t};D.toString=function(t){if(t=t||10,2>t||36<t)throw Error("radix out of range: "+t);if(Ss(this))return"0";if(rr(this))return"-"+Pt(this).toString(t);for(var e=Hr(Math.pow(t,6)),n=this,r="";;){var s=Zh(n,e).g;n=Jh(n,s.R(e));var i=((0<n.g.length?n.g[0]:n.h)>>>0).toString(t);if(n=s,Ss(n))return i+r;for(;6>i.length;)i="0"+i;r=i+r}};D.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h};function Ss(t){if(t.h!=0)return!1;for(var e=0;e<t.g.length;e++)if(t.g[e]!=0)return!1;return!0}function rr(t){return t.h==-1}D.X=function(t){return t=Jh(this,t),rr(t)?-1:Ss(t)?0:1};function Pt(t){for(var e=t.g.length,n=[],r=0;r<e;r++)n[r]=~t.g[r];return new Re(n,~t.h).add(by)}D.abs=function(){return rr(this)?Pt(this):this};D.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0,s=0;s<=e;s++){var i=r+(this.D(s)&65535)+(t.D(s)&65535),a=(i>>>16)+(this.D(s)>>>16)+(t.D(s)>>>16);r=a>>>16,i&=65535,a&=65535,n[s]=a<<16|i}return new Re(n,n[n.length-1]&-2147483648?-1:0)};function Jh(t,e){return t.add(Pt(e))}D.R=function(t){if(Ss(this)||Ss(t))return To;if(rr(this))return rr(t)?Pt(this).R(Pt(t)):Pt(Pt(this).R(t));if(rr(t))return Pt(this.R(Pt(t)));if(0>this.X(SE)&&0>t.X(SE))return Hr(this.ea()*t.ea());for(var e=this.g.length+t.g.length,n=[],r=0;r<2*e;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var s=0;s<t.g.length;s++){var i=this.D(r)>>>16,a=this.D(r)&65535,l=t.D(s)>>>16,c=t.D(s)&65535;n[2*r+2*s]+=a*c,gd(n,2*r+2*s),n[2*r+2*s+1]+=i*c,gd(n,2*r+2*s+1),n[2*r+2*s+1]+=a*l,gd(n,2*r+2*s+1),n[2*r+2*s+2]+=i*l,gd(n,2*r+2*s+2)}for(r=0;r<e;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=e;r<2*e;r++)n[r]=0;return new Re(n,0)};function gd(t,e){for(;(t[e]&65535)!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function Pl(t,e){this.g=t,this.h=e}function Zh(t,e){if(Ss(e))throw Error("division by zero");if(Ss(t))return new Pl(To,To);if(rr(t))return e=Zh(Pt(t),e),new Pl(Pt(e.g),Pt(e.h));if(rr(e))return e=Zh(t,Pt(e)),new Pl(Pt(e.g),e.h);if(30<t.g.length){if(rr(t)||rr(e))throw Error("slowDivide_ only works with positive integers.");for(var n=by,r=e;0>=r.X(t);)n=EE(n),r=EE(r);var s=Ga(n,1),i=Ga(r,1);for(r=Ga(r,2),n=Ga(n,2);!Ss(r);){var a=i.add(r);0>=a.X(t)&&(s=s.add(n),i=a),r=Ga(r,1),n=Ga(n,1)}return e=Jh(t,s.R(e)),new Pl(s,e)}for(s=To;0<=t.X(e);){for(n=Math.max(1,Math.floor(t.ea()/e.ea())),r=Math.ceil(Math.log(n)/Math.LN2),r=48>=r?1:Math.pow(2,r-48),i=Hr(n),a=i.R(e);rr(a)||0<a.X(t);)n-=r,i=Hr(n),a=i.R(e);Ss(i)&&(i=by),s=s.add(i),t=Jh(t,a)}return new Pl(s,t)}D.gb=function(t){return Zh(this,t).h};D.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)&t.D(r);return new Re(n,this.h&t.h)};D.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)|t.D(r);return new Re(n,this.h|t.h)};D.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)^t.D(r);return new Re(n,this.h^t.h)};function EE(t){for(var e=t.g.length+1,n=[],r=0;r<e;r++)n[r]=t.D(r)<<1|t.D(r-1)>>>31;return new Re(n,t.h)}function Ga(t,e){var n=e>>5;e%=32;for(var r=t.g.length-n,s=[],i=0;i<r;i++)s[i]=0<e?t.D(i+n)>>>e|t.D(i+n+1)<<32-e:t.D(i+n);return new Re(s,t.h)}Yh.prototype.createWebChannel=Yh.prototype.g;Vn.prototype.send=Vn.prototype.u;Vn.prototype.open=Vn.prototype.m;Vn.prototype.close=Vn.prototype.close;Dm.NO_ERROR=0;Dm.TIMEOUT=8;Dm.HTTP_ERROR=6;wR.COMPLETE="complete";_R.EventType=Iu;Iu.OPEN="a";Iu.CLOSE="b";Iu.ERROR="c";Iu.MESSAGE="d";It.prototype.listen=It.prototype.O;nt.prototype.listenOnce=nt.prototype.P;nt.prototype.getLastError=nt.prototype.Sa;nt.prototype.getLastErrorCode=nt.prototype.Ia;nt.prototype.getStatus=nt.prototype.da;nt.prototype.getResponseJson=nt.prototype.Wa;nt.prototype.getResponseText=nt.prototype.ja;nt.prototype.send=nt.prototype.ha;nt.prototype.setWithCredentials=nt.prototype.Oa;Rr.prototype.digest=Rr.prototype.l;Rr.prototype.reset=Rr.prototype.reset;Rr.prototype.update=Rr.prototype.j;Re.prototype.add=Re.prototype.add;Re.prototype.multiply=Re.prototype.R;Re.prototype.modulo=Re.prototype.gb;Re.prototype.compare=Re.prototype.X;Re.prototype.toNumber=Re.prototype.ea;Re.prototype.toString=Re.prototype.toString;Re.prototype.getBits=Re.prototype.D;Re.fromNumber=Hr;Re.fromString=nA;var LU=function(){return new Yh},$U=function(){return Fm()},Tg=Dm,zU=wR,BU=La,bE={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},yd=_R,UU=nt,VU=Rr,Io=Re;const kE="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ht{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ht.UNAUTHENTICATED=new Ht(null),Ht.GOOGLE_CREDENTIALS=new Ht("google-credentials-uid"),Ht.FIRST_PARTY=new Ht("first-party-uid"),Ht.MOCK_USER=new Ht("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let hl="10.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ea=new $v("@firebase/firestore");function TE(){return Ea.logLevel}function z(t,...e){if(Ea.logLevel<=Se.DEBUG){const n=e.map(vw);Ea.debug(`Firestore (${hl}): ${t}`,...n)}}function Os(t,...e){if(Ea.logLevel<=Se.ERROR){const n=e.map(vw);Ea.error(`Firestore (${hl}): ${t}`,...n)}}function Uo(t,...e){if(Ea.logLevel<=Se.WARN){const n=e.map(vw);Ea.warn(`Firestore (${hl}): ${t}`,...n)}}function vw(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X(t="Unexpected state"){const e=`FIRESTORE (${hl}) INTERNAL ASSERTION FAILED: `+t;throw Os(e),new Error(e)}function Ue(t,e){t||X()}function ne(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class M extends ds{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ts{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rA{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class HU{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Ht.UNAUTHENTICATED))}shutdown(){}}class WU{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class qU{constructor(e){this.t=e,this.currentUser=Ht.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){let r=this.i;const s=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve();let i=new Ts;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Ts,e.enqueueRetryable(()=>s(this.currentUser))};const a=()=>{const c=i;e.enqueueRetryable(async()=>{await c.promise,await s(this.currentUser)})},l=c=>{z("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.auth.addAuthTokenListener(this.o),a()};this.t.onInit(c=>l(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?l(c):(z("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Ts)}},0),a()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(z("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Ue(typeof r.accessToken=="string"),new rA(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return Ue(e===null||typeof e=="string"),new Ht(e)}}class GU{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=Ht.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class QU{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new GU(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(Ht.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class KU{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class XU{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){const r=i=>{i.error!=null&&z("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const a=i.token!==this.R;return this.R=i.token,z("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{z("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):z("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Ue(typeof n.token=="string"),this.R=n.token,new KU(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YU(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sA{static V(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=YU(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%e.length))}return r}}function be(t,e){return t<e?-1:t>e?1:0}function Vo(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _t{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new M(C.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new M(C.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new M(C.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new M(C.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return _t.fromMillis(Date.now())}static fromDate(e){return _t.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new _t(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?be(this.nanoseconds,e.nanoseconds):be(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J{constructor(e){this.timestamp=e}static fromTimestamp(e){return new J(e)}static min(){return new J(new _t(0,0))}static max(){return new J(new _t(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qc{constructor(e,n,r){n===void 0?n=0:n>e.length&&X(),r===void 0?r=e.length-n:r>e.length-n&&X(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Qc.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Qc?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=e.get(s),a=n.get(s);if(i<a)return-1;if(i>a)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class ze extends Qc{construct(e,n,r){return new ze(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new M(C.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new ze(n)}static emptyPath(){return new ze([])}}const JU=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Gt extends Qc{construct(e,n,r){return new Gt(e,n,r)}static isValidIdentifier(e){return JU.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Gt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Gt(["__name__"])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new M(C.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let a=!1;for(;s<e.length;){const l=e[s];if(l==="\\"){if(s+1===e.length)throw new M(C.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[s+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new M(C.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,s+=2}else l==="`"?(a=!a,s++):l!=="."||a?(r+=l,s++):(i(),s++)}if(i(),a)throw new M(C.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Gt(n)}static emptyPath(){return new Gt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H{constructor(e){this.path=e}static fromPath(e){return new H(ze.fromString(e))}static fromName(e){return new H(ze.fromString(e).popFirst(5))}static empty(){return new H(ze.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ze.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return ze.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new H(new ze(e.slice()))}}function ZU(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=J.fromTimestamp(r===1e9?new _t(n+1,0):new _t(n,r));return new Ri(s,H.empty(),e)}function eV(t){return new Ri(t.readTime,t.key,-1)}class Ri{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Ri(J.min(),H.empty(),-1)}static max(){return new Ri(J.max(),H.empty(),-1)}}function tV(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=H.comparator(t.documentKey,e.documentKey),n!==0?n:be(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nV="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class rV{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Nu(t){if(t.code!==C.FAILED_PRECONDITION||t.message!==nV)throw t;z("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&X(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new N((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof N?n:N.resolve(n)}catch(n){return N.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):N.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):N.reject(n)}static resolve(e){return new N((n,r)=>{n(e)})}static reject(e){return new N((n,r)=>{r(e)})}static waitFor(e){return new N((n,r)=>{let s=0,i=0,a=!1;e.forEach(l=>{++s,l.next(()=>{++i,a&&i===s&&n()},c=>r(c))}),a=!0,i===s&&n()})}static or(e){let n=N.resolve(!1);for(const r of e)n=n.next(s=>s?N.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new N((r,s)=>{const i=e.length,a=new Array(i);let l=0;for(let c=0;c<i;c++){const u=c;n(e[u]).next(d=>{a[u]=d,++l,l===i&&r(a)},d=>s(d))}})}static doWhile(e,n){return new N((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}function Pu(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ww{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.oe(r),this._e=r=>n.writeSequenceNumber(r))}oe(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this._e&&this._e(e),e}}ww.ae=-1;function Hm(t){return t==null}function ef(t){return t===0&&1/t==-1/0}function sV(t){return typeof t=="number"&&Number.isInteger(t)&&!ef(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IE(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function $a(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function iA(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Je{constructor(e,n){this.comparator=e,this.root=n||Nt.EMPTY}insert(e,n){return new Je(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Nt.BLACK,null,null))}remove(e){return new Je(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Nt.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new xd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new xd(this.root,e,this.comparator,!1)}getReverseIterator(){return new xd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new xd(this.root,e,this.comparator,!0)}}class xd{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Nt{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??Nt.RED,this.left=s??Nt.EMPTY,this.right=i??Nt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new Nt(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Nt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return Nt.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Nt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Nt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw X();const e=this.left.check();if(e!==this.right.check())throw X();return e+(this.isRed()?0:1)}}Nt.EMPTY=null,Nt.RED=!0,Nt.BLACK=!1;Nt.EMPTY=new class{constructor(){this.size=0}get key(){throw X()}get value(){throw X()}get color(){throw X()}get left(){throw X()}get right(){throw X()}copy(e,n,r,s,i){return this}insert(e,n,r){return new Nt(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yt{constructor(e){this.comparator=e,this.data=new Je(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new CE(this.data.getIterator())}getIteratorFrom(e){return new CE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Yt)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Yt(this.comparator);return n.data=e,n}}class CE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dn{constructor(e){this.fields=e,e.sort(Gt.comparator)}static empty(){return new Dn([])}unionWith(e){let n=new Yt(Gt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Dn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Vo(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aA extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tn{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new aA("Invalid base64 string: "+i):i}}(e);return new tn(n)}static fromUint8Array(e){const n=function(s){let i="";for(let a=0;a<s.length;++a)i+=String.fromCharCode(s[a]);return i}(e);return new tn(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return be(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}tn.EMPTY_BYTE_STRING=new tn("");const iV=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ai(t){if(Ue(!!t),typeof t=="string"){let e=0;const n=iV.exec(t);if(Ue(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:mt(t.seconds),nanos:mt(t.nanos)}}function mt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function ba(t){return typeof t=="string"?tn.fromBase64String(t):tn.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _w(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function Sw(t){const e=t.mapValue.fields.__previous_value__;return _w(e)?Sw(e):e}function Kc(t){const e=Ai(t.mapValue.fields.__local_write_time__.timestampValue);return new _t(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aV{constructor(e,n,r,s,i,a,l,c,u){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=a,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=u}}class Xc{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new Xc("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Xc&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vd={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function ka(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?_w(t)?4:oV(t)?9007199254740991:10:X()}function ts(t,e){if(t===e)return!0;const n=ka(t);if(n!==ka(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Kc(t).isEqual(Kc(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const a=Ai(s.timestampValue),l=Ai(i.timestampValue);return a.seconds===l.seconds&&a.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return ba(s.bytesValue).isEqual(ba(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return mt(s.geoPointValue.latitude)===mt(i.geoPointValue.latitude)&&mt(s.geoPointValue.longitude)===mt(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return mt(s.integerValue)===mt(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const a=mt(s.doubleValue),l=mt(i.doubleValue);return a===l?ef(a)===ef(l):isNaN(a)&&isNaN(l)}return!1}(t,e);case 9:return Vo(t.arrayValue.values||[],e.arrayValue.values||[],ts);case 10:return function(s,i){const a=s.mapValue.fields||{},l=i.mapValue.fields||{};if(IE(a)!==IE(l))return!1;for(const c in a)if(a.hasOwnProperty(c)&&(l[c]===void 0||!ts(a[c],l[c])))return!1;return!0}(t,e);default:return X()}}function Yc(t,e){return(t.values||[]).find(n=>ts(n,e))!==void 0}function Ho(t,e){if(t===e)return 0;const n=ka(t),r=ka(e);if(n!==r)return be(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return be(t.booleanValue,e.booleanValue);case 2:return function(i,a){const l=mt(i.integerValue||i.doubleValue),c=mt(a.integerValue||a.doubleValue);return l<c?-1:l>c?1:l===c?0:isNaN(l)?isNaN(c)?0:-1:1}(t,e);case 3:return RE(t.timestampValue,e.timestampValue);case 4:return RE(Kc(t),Kc(e));case 5:return be(t.stringValue,e.stringValue);case 6:return function(i,a){const l=ba(i),c=ba(a);return l.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(i,a){const l=i.split("/"),c=a.split("/");for(let u=0;u<l.length&&u<c.length;u++){const d=be(l[u],c[u]);if(d!==0)return d}return be(l.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,a){const l=be(mt(i.latitude),mt(a.latitude));return l!==0?l:be(mt(i.longitude),mt(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(i,a){const l=i.values||[],c=a.values||[];for(let u=0;u<l.length&&u<c.length;++u){const d=Ho(l[u],c[u]);if(d)return d}return be(l.length,c.length)}(t.arrayValue,e.arrayValue);case 10:return function(i,a){if(i===vd.mapValue&&a===vd.mapValue)return 0;if(i===vd.mapValue)return 1;if(a===vd.mapValue)return-1;const l=i.fields||{},c=Object.keys(l),u=a.fields||{},d=Object.keys(u);c.sort(),d.sort();for(let h=0;h<c.length&&h<d.length;++h){const m=be(c[h],d[h]);if(m!==0)return m;const p=Ho(l[c[h]],u[d[h]]);if(p!==0)return p}return be(c.length,d.length)}(t.mapValue,e.mapValue);default:throw X()}}function RE(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return be(t,e);const n=Ai(t),r=Ai(e),s=be(n.seconds,r.seconds);return s!==0?s:be(n.nanos,r.nanos)}function Wo(t){return ky(t)}function ky(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Ai(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return ba(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return H.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=ky(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const a of r)i?i=!1:s+=",",s+=`${a}:${ky(n.fields[a])}`;return s+"}"}(t.mapValue):X()}function AE(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Ty(t){return!!t&&"integerValue"in t}function Ew(t){return!!t&&"arrayValue"in t}function jE(t){return!!t&&"nullValue"in t}function NE(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function eh(t){return!!t&&"mapValue"in t}function ac(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return $a(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=ac(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=ac(t.arrayValue.values[n]);return e}return Object.assign({},t)}function oV(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xn{constructor(e){this.value=e}static empty(){return new xn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!eh(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=ac(n)}setAll(e){let n=Gt.emptyPath(),r={},s=[];e.forEach((a,l)=>{if(!n.isImmediateParentOf(l)){const c=this.getFieldsMap(n);this.applyChanges(c,r,s),r={},s=[],n=l.popLast()}a?r[l.lastSegment()]=ac(a):s.push(l.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());eh(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return ts(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];eh(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){$a(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new xn(ac(this.value))}}function oA(t){const e=[];return $a(t.fields,(n,r)=>{const s=new Gt([n]);if(eh(r)){const i=oA(r.mapValue).fields;if(i.length===0)e.push(s);else for(const a of i)e.push(s.child(a))}else e.push(s)}),new Dn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qt{constructor(e,n,r,s,i,a,l){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=a,this.documentState=l}static newInvalidDocument(e){return new qt(e,0,J.min(),J.min(),J.min(),xn.empty(),0)}static newFoundDocument(e,n,r,s){return new qt(e,1,n,J.min(),r,s,0)}static newNoDocument(e,n){return new qt(e,2,n,J.min(),J.min(),xn.empty(),0)}static newUnknownDocument(e,n){return new qt(e,3,n,J.min(),J.min(),xn.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(J.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=xn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=xn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=J.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof qt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new qt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tf{constructor(e,n){this.position=e,this.inclusive=n}}function PE(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],a=t.position[s];if(i.field.isKeyField()?r=H.comparator(H.fromName(a.referenceValue),n.key):r=Ho(a,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function FE(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!ts(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Co{constructor(e,n="asc"){this.field=e,this.dir=n}}function lV(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lA{}class gt extends lA{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new uV(e,n,r):n==="array-contains"?new fV(e,r):n==="in"?new mV(e,r):n==="not-in"?new pV(e,r):n==="array-contains-any"?new gV(e,r):new gt(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new dV(e,r):new hV(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(Ho(n,this.value)):n!==null&&ka(this.value)===ka(n)&&this.matchesComparison(Ho(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return X()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class Ar extends lA{constructor(e,n){super(),this.filters=e,this.op=n,this.ce=null}static create(e,n){return new Ar(e,n)}matches(e){return cA(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ce!==null||(this.ce=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ce}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){const e=this.le(n=>n.isInequality());return e!==null?e.field:null}le(e){for(const n of this.getFlattenedFilters())if(e(n))return n;return null}}function cA(t){return t.op==="and"}function uA(t){return cV(t)&&cA(t)}function cV(t){for(const e of t.filters)if(e instanceof Ar)return!1;return!0}function Iy(t){if(t instanceof gt)return t.field.canonicalString()+t.op.toString()+Wo(t.value);if(uA(t))return t.filters.map(e=>Iy(e)).join(",");{const e=t.filters.map(n=>Iy(n)).join(",");return`${t.op}(${e})`}}function dA(t,e){return t instanceof gt?function(r,s){return s instanceof gt&&r.op===s.op&&r.field.isEqual(s.field)&&ts(r.value,s.value)}(t,e):t instanceof Ar?function(r,s){return s instanceof Ar&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,a,l)=>i&&dA(a,s.filters[l]),!0):!1}(t,e):void X()}function hA(t){return t instanceof gt?function(n){return`${n.field.canonicalString()} ${n.op} ${Wo(n.value)}`}(t):t instanceof Ar?function(n){return n.op.toString()+" {"+n.getFilters().map(hA).join(" ,")+"}"}(t):"Filter"}class uV extends gt{constructor(e,n,r){super(e,n,r),this.key=H.fromName(r.referenceValue)}matches(e){const n=H.comparator(e.key,this.key);return this.matchesComparison(n)}}class dV extends gt{constructor(e,n){super(e,"in",n),this.keys=fA("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class hV extends gt{constructor(e,n){super(e,"not-in",n),this.keys=fA("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function fA(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>H.fromName(r.referenceValue))}class fV extends gt{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Ew(n)&&Yc(n.arrayValue,this.value)}}class mV extends gt{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Yc(this.value.arrayValue,n)}}class pV extends gt{constructor(e,n){super(e,"not-in",n)}matches(e){if(Yc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!Yc(this.value.arrayValue,n)}}class gV extends gt{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Ew(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Yc(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yV{constructor(e,n=null,r=[],s=[],i=null,a=null,l=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=a,this.endAt=l,this.he=null}}function DE(t,e=null,n=[],r=[],s=null,i=null,a=null){return new yV(t,e,n,r,s,i,a)}function bw(t){const e=ne(t);if(e.he===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Iy(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),Hm(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Wo(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Wo(r)).join(",")),e.he=n}return e.he}function kw(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!lV(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!dA(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!FE(t.startAt,e.startAt)&&FE(t.endAt,e.endAt)}function Cy(t){return H.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fl{constructor(e,n=null,r=[],s=[],i=null,a="F",l=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=a,this.startAt=l,this.endAt=c,this.Pe=null,this.Ie=null,this.Te=null,this.startAt,this.endAt}}function xV(t,e,n,r,s,i,a,l){return new fl(t,e,n,r,s,i,a,l)}function Tw(t){return new fl(t)}function OE(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function Iw(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function Wm(t){for(const e of t.filters){const n=e.getFirstInequalityField();if(n!==null)return n}return null}function mA(t){return t.collectionGroup!==null}function oc(t){const e=ne(t);if(e.Pe===null){e.Pe=[];const n=Wm(e),r=Iw(e);if(n!==null&&r===null)n.isKeyField()||e.Pe.push(new Co(n)),e.Pe.push(new Co(Gt.keyField(),"asc"));else{let s=!1;for(const i of e.explicitOrderBy)e.Pe.push(i),i.field.isKeyField()&&(s=!0);if(!s){const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.Pe.push(new Co(Gt.keyField(),i))}}}return e.Pe}function Ms(t){const e=ne(t);return e.Ie||(e.Ie=vV(e,oc(t))),e.Ie}function vV(t,e){if(t.limitType==="F")return DE(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new Co(s.field,i)});const n=t.endAt?new tf(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new tf(t.startAt.position,t.startAt.inclusive):null;return DE(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Ry(t,e){e.getFirstInequalityField(),Wm(t);const n=t.filters.concat([e]);return new fl(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function nf(t,e,n){return new fl(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function qm(t,e){return kw(Ms(t),Ms(e))&&t.limitType===e.limitType}function pA(t){return`${bw(Ms(t))}|lt:${t.limitType}`}function Ay(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>hA(s)).join(", ")}]`),Hm(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>Wo(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>Wo(s)).join(",")),`Target(${r})`}(Ms(t))}; limitType=${t.limitType})`}function Gm(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):H.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of oc(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(a,l,c){const u=PE(a,l,c);return a.inclusive?u<=0:u<0}(r.startAt,oc(r),s)||r.endAt&&!function(a,l,c){const u=PE(a,l,c);return a.inclusive?u>=0:u>0}(r.endAt,oc(r),s))}(t,e)}function wV(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function gA(t){return(e,n)=>{let r=!1;for(const s of oc(t)){const i=_V(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function _V(t,e,n){const r=t.field.isKeyField()?H.comparator(e.key,n.key):function(i,a,l){const c=a.data.field(i),u=l.data.field(i);return c!==null&&u!==null?Ho(c,u):X()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return X()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ml{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){$a(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return iA(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SV=new Je(H.comparator);function Ls(){return SV}const yA=new Je(H.comparator);function ql(...t){let e=yA;for(const n of t)e=e.insert(n.key,n);return e}function xA(t){let e=yA;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function la(){return lc()}function vA(){return lc()}function lc(){return new ml(t=>t.toString(),(t,e)=>t.isEqual(e))}const EV=new Je(H.comparator),bV=new Yt(H.comparator);function de(...t){let e=bV;for(const n of t)e=e.add(n);return e}const kV=new Yt(be);function TV(){return kV}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wA(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ef(e)?"-0":e}}function _A(t){return{integerValue:""+t}}function SA(t,e){return sV(e)?_A(e):wA(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qm{constructor(){this._=void 0}}function IV(t,e,n){return t instanceof Jc?function(s,i){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&_w(i)&&(i=Sw(i)),i&&(a.fields.__previous_value__=i),{mapValue:a}}(n,e):t instanceof Zc?bA(t,e):t instanceof eu?kA(t,e):function(s,i){const a=EA(s,i),l=ME(a)+ME(s.Ee);return Ty(a)&&Ty(s.Ee)?_A(l):wA(s.serializer,l)}(t,e)}function CV(t,e,n){return t instanceof Zc?bA(t,e):t instanceof eu?kA(t,e):n}function EA(t,e){return t instanceof tu?function(r){return Ty(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class Jc extends Qm{}class Zc extends Qm{constructor(e){super(),this.elements=e}}function bA(t,e){const n=TA(e);for(const r of t.elements)n.some(s=>ts(s,r))||n.push(r);return{arrayValue:{values:n}}}class eu extends Qm{constructor(e){super(),this.elements=e}}function kA(t,e){let n=TA(e);for(const r of t.elements)n=n.filter(s=>!ts(s,r));return{arrayValue:{values:n}}}class tu extends Qm{constructor(e,n){super(),this.serializer=e,this.Ee=n}}function ME(t){return mt(t.integerValue||t.doubleValue)}function TA(t){return Ew(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IA{constructor(e,n){this.field=e,this.transform=n}}function RV(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof Zc&&s instanceof Zc||r instanceof eu&&s instanceof eu?Vo(r.elements,s.elements,ts):r instanceof tu&&s instanceof tu?ts(r.Ee,s.Ee):r instanceof Jc&&s instanceof Jc}(t.transform,e.transform)}class AV{constructor(e,n){this.version=e,this.transformResults=n}}class En{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new En}static exists(e){return new En(void 0,e)}static updateTime(e){return new En(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function th(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Km{}function CA(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Xm(t.key,En.none()):new Fu(t.key,t.data,En.none());{const n=t.data,r=xn.empty();let s=new Yt(Gt.comparator);for(let i of e.fields)if(!s.has(i)){let a=n.field(i);a===null&&i.length>1&&(i=i.popLast(),a=n.field(i)),a===null?r.delete(i):r.set(i,a),s=s.add(i)}return new Bi(t.key,r,new Dn(s.toArray()),En.none())}}function jV(t,e,n){t instanceof Fu?function(s,i,a){const l=s.value.clone(),c=$E(s.fieldTransforms,i,a.transformResults);l.setAll(c),i.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(t,e,n):t instanceof Bi?function(s,i,a){if(!th(s.precondition,i))return void i.convertToUnknownDocument(a.version);const l=$E(s.fieldTransforms,i,a.transformResults),c=i.data;c.setAll(RA(s)),c.setAll(l),i.convertToFoundDocument(a.version,c).setHasCommittedMutations()}(t,e,n):function(s,i,a){i.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,n)}function cc(t,e,n,r){return t instanceof Fu?function(i,a,l,c){if(!th(i.precondition,a))return l;const u=i.value.clone(),d=zE(i.fieldTransforms,c,a);return u.setAll(d),a.convertToFoundDocument(a.version,u).setHasLocalMutations(),null}(t,e,n,r):t instanceof Bi?function(i,a,l,c){if(!th(i.precondition,a))return l;const u=zE(i.fieldTransforms,c,a),d=a.data;return d.setAll(RA(i)),d.setAll(u),a.convertToFoundDocument(a.version,d).setHasLocalMutations(),l===null?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(h=>h.field))}(t,e,n,r):function(i,a,l){return th(i.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):l}(t,e,n)}function NV(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=EA(r.transform,s||null);i!=null&&(n===null&&(n=xn.empty()),n.set(r.field,i))}return n||null}function LE(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Vo(r,s,(i,a)=>RV(i,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Fu extends Km{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Bi extends Km{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function RA(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function $E(t,e,n){const r=new Map;Ue(t.length===n.length);for(let s=0;s<n.length;s++){const i=t[s],a=i.transform,l=e.data.field(i.field);r.set(i.field,CV(a,l,n[s]))}return r}function zE(t,e,n){const r=new Map;for(const s of t){const i=s.transform,a=n.data.field(s.field);r.set(s.field,IV(i,a,e))}return r}class Xm extends Km{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class PV extends Km{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FV{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&jV(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=cc(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=cc(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=vA();return this.mutations.forEach(s=>{const i=e.get(s.key),a=i.overlayedDocument;let l=this.applyToLocalView(a,i.mutatedFields);l=n.has(s.key)?null:l;const c=CA(a,l);c!==null&&r.set(s.key,c),a.isValidDocument()||a.convertToNoDocument(J.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),de())}isEqual(e){return this.batchId===e.batchId&&Vo(this.mutations,e.mutations,(n,r)=>LE(n,r))&&Vo(this.baseMutations,e.baseMutations,(n,r)=>LE(n,r))}}class Cw{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){Ue(e.mutations.length===r.length);let s=function(){return EV}();const i=e.mutations;for(let a=0;a<i.length;a++)s=s.insert(i[a].key,r[a].version);return new Cw(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DV{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OV{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ft,ge;function MV(t){switch(t){default:return X();case C.CANCELLED:case C.UNKNOWN:case C.DEADLINE_EXCEEDED:case C.RESOURCE_EXHAUSTED:case C.INTERNAL:case C.UNAVAILABLE:case C.UNAUTHENTICATED:return!1;case C.INVALID_ARGUMENT:case C.NOT_FOUND:case C.ALREADY_EXISTS:case C.PERMISSION_DENIED:case C.FAILED_PRECONDITION:case C.ABORTED:case C.OUT_OF_RANGE:case C.UNIMPLEMENTED:case C.DATA_LOSS:return!0}}function AA(t){if(t===void 0)return Os("GRPC error has no .code"),C.UNKNOWN;switch(t){case ft.OK:return C.OK;case ft.CANCELLED:return C.CANCELLED;case ft.UNKNOWN:return C.UNKNOWN;case ft.DEADLINE_EXCEEDED:return C.DEADLINE_EXCEEDED;case ft.RESOURCE_EXHAUSTED:return C.RESOURCE_EXHAUSTED;case ft.INTERNAL:return C.INTERNAL;case ft.UNAVAILABLE:return C.UNAVAILABLE;case ft.UNAUTHENTICATED:return C.UNAUTHENTICATED;case ft.INVALID_ARGUMENT:return C.INVALID_ARGUMENT;case ft.NOT_FOUND:return C.NOT_FOUND;case ft.ALREADY_EXISTS:return C.ALREADY_EXISTS;case ft.PERMISSION_DENIED:return C.PERMISSION_DENIED;case ft.FAILED_PRECONDITION:return C.FAILED_PRECONDITION;case ft.ABORTED:return C.ABORTED;case ft.OUT_OF_RANGE:return C.OUT_OF_RANGE;case ft.UNIMPLEMENTED:return C.UNIMPLEMENTED;case ft.DATA_LOSS:return C.DATA_LOSS;default:return X()}}(ge=ft||(ft={}))[ge.OK=0]="OK",ge[ge.CANCELLED=1]="CANCELLED",ge[ge.UNKNOWN=2]="UNKNOWN",ge[ge.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ge[ge.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ge[ge.NOT_FOUND=5]="NOT_FOUND",ge[ge.ALREADY_EXISTS=6]="ALREADY_EXISTS",ge[ge.PERMISSION_DENIED=7]="PERMISSION_DENIED",ge[ge.UNAUTHENTICATED=16]="UNAUTHENTICATED",ge[ge.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ge[ge.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ge[ge.ABORTED=10]="ABORTED",ge[ge.OUT_OF_RANGE=11]="OUT_OF_RANGE",ge[ge.UNIMPLEMENTED=12]="UNIMPLEMENTED",ge[ge.INTERNAL=13]="INTERNAL",ge[ge.UNAVAILABLE=14]="UNAVAILABLE",ge[ge.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LV(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $V=new Io([4294967295,4294967295],0);function BE(t){const e=LV().encode(t),n=new VU;return n.update(e),new Uint8Array(n.digest())}function UE(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Io([n,r],0),new Io([s,i],0)]}class Rw{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Gl(`Invalid padding: ${n}`);if(r<0)throw new Gl(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Gl(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Gl(`Invalid padding when bitmap length is 0: ${n}`);this.Ae=8*e.length-n,this.Re=Io.fromNumber(this.Ae)}Ve(e,n,r){let s=e.add(n.multiply(Io.fromNumber(r)));return s.compare($V)===1&&(s=new Io([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Re).toNumber()}me(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ae===0)return!1;const n=BE(e),[r,s]=UE(n);for(let i=0;i<this.hashCount;i++){const a=this.Ve(r,s,i);if(!this.me(a))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),a=new Rw(i,s,n);return r.forEach(l=>a.insert(l)),a}insert(e){if(this.Ae===0)return;const n=BE(e),[r,s]=UE(n);for(let i=0;i<this.hashCount;i++){const a=this.Ve(r,s,i);this.fe(a)}}fe(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Gl extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ym{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,Du.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Ym(J.min(),s,new Je(be),Ls(),de())}}class Du{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Du(r,n,de(),de(),de())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nh{constructor(e,n,r,s){this.ge=e,this.removedTargetIds=n,this.key=r,this.pe=s}}class jA{constructor(e,n){this.targetId=e,this.ye=n}}class NA{constructor(e,n,r=tn.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class VE{constructor(){this.we=0,this.Se=WE(),this.be=tn.EMPTY_BYTE_STRING,this.De=!1,this.ve=!0}get current(){return this.De}get resumeToken(){return this.be}get Ce(){return this.we!==0}get Fe(){return this.ve}Me(e){e.approximateByteSize()>0&&(this.ve=!0,this.be=e)}xe(){let e=de(),n=de(),r=de();return this.Se.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:X()}}),new Du(this.be,this.De,e,n,r)}Oe(){this.ve=!1,this.Se=WE()}Ne(e,n){this.ve=!0,this.Se=this.Se.insert(e,n)}Be(e){this.ve=!0,this.Se=this.Se.remove(e)}Le(){this.we+=1}ke(){this.we-=1}qe(){this.ve=!0,this.De=!0}}class zV{constructor(e){this.Qe=e,this.Ke=new Map,this.$e=Ls(),this.Ue=HE(),this.We=new Je(be)}Ge(e){for(const n of e.ge)e.pe&&e.pe.isFoundDocument()?this.ze(n,e.pe):this.je(n,e.key,e.pe);for(const n of e.removedTargetIds)this.je(n,e.key,e.pe)}He(e){this.forEachTarget(e,n=>{const r=this.Je(n);switch(e.state){case 0:this.Ye(n)&&r.Me(e.resumeToken);break;case 1:r.ke(),r.Ce||r.Oe(),r.Me(e.resumeToken);break;case 2:r.ke(),r.Ce||this.removeTarget(n);break;case 3:this.Ye(n)&&(r.qe(),r.Me(e.resumeToken));break;case 4:this.Ye(n)&&(this.Ze(n),r.Me(e.resumeToken));break;default:X()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Ke.forEach((r,s)=>{this.Ye(s)&&n(s)})}Xe(e){const n=e.targetId,r=e.ye.count,s=this.et(n);if(s){const i=s.target;if(Cy(i))if(r===0){const a=new H(i.path);this.je(n,a,qt.newNoDocument(a,J.min()))}else Ue(r===1);else{const a=this.tt(n);if(a!==r){const l=this.nt(e),c=l?this.rt(l,e,a):1;if(c!==0){this.Ze(n);const u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.We=this.We.insert(n,u)}}}}}nt(e){const n=e.ye.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let a,l;try{a=ba(r).toUint8Array()}catch(c){if(c instanceof aA)return Uo("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{l=new Rw(a,s,i)}catch(c){return Uo(c instanceof Gl?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return l.Ae===0?null:l}rt(e,n,r){return n.ye.count===r-this.ot(e,n.targetId)?0:2}ot(e,n){const r=this.Qe.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const a=this.Qe.st(),l=`projects/${a.projectId}/databases/${a.database}/documents/${i.path.canonicalString()}`;e.mightContain(l)||(this.je(n,i,null),s++)}),s}_t(e){const n=new Map;this.Ke.forEach((i,a)=>{const l=this.et(a);if(l){if(i.current&&Cy(l.target)){const c=new H(l.target.path);this.$e.get(c)!==null||this.ut(a,c)||this.je(a,c,qt.newNoDocument(c,e))}i.Fe&&(n.set(a,i.xe()),i.Oe())}});let r=de();this.Ue.forEach((i,a)=>{let l=!0;a.forEachWhile(c=>{const u=this.et(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(i))}),this.$e.forEach((i,a)=>a.setReadTime(e));const s=new Ym(e,n,this.We,this.$e,r);return this.$e=Ls(),this.Ue=HE(),this.We=new Je(be),s}ze(e,n){if(!this.Ye(e))return;const r=this.ut(e,n.key)?2:0;this.Je(e).Ne(n.key,r),this.$e=this.$e.insert(n.key,n),this.Ue=this.Ue.insert(n.key,this.ct(n.key).add(e))}je(e,n,r){if(!this.Ye(e))return;const s=this.Je(e);this.ut(e,n)?s.Ne(n,1):s.Be(n),this.Ue=this.Ue.insert(n,this.ct(n).delete(e)),r&&(this.$e=this.$e.insert(n,r))}removeTarget(e){this.Ke.delete(e)}tt(e){const n=this.Je(e).xe();return this.Qe.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Le(e){this.Je(e).Le()}Je(e){let n=this.Ke.get(e);return n||(n=new VE,this.Ke.set(e,n)),n}ct(e){let n=this.Ue.get(e);return n||(n=new Yt(be),this.Ue=this.Ue.insert(e,n)),n}Ye(e){const n=this.et(e)!==null;return n||z("WatchChangeAggregator","Detected inactive target",e),n}et(e){const n=this.Ke.get(e);return n&&n.Ce?null:this.Qe.lt(e)}Ze(e){this.Ke.set(e,new VE),this.Qe.getRemoteKeysForTarget(e).forEach(n=>{this.je(e,n,null)})}ut(e,n){return this.Qe.getRemoteKeysForTarget(e).has(n)}}function HE(){return new Je(H.comparator)}function WE(){return new Je(H.comparator)}const BV=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),UV=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),VV=(()=>({and:"AND",or:"OR"}))();class HV{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function jy(t,e){return t.useProto3Json||Hm(e)?e:{value:e}}function rf(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function PA(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function WV(t,e){return rf(t,e.toTimestamp())}function Zr(t){return Ue(!!t),J.fromTimestamp(function(n){const r=Ai(n);return new _t(r.seconds,r.nanos)}(t))}function Aw(t,e){return function(r){return new ze(["projects",r.projectId,"databases",r.database])}(t).child("documents").child(e).canonicalString()}function FA(t){const e=ze.fromString(t);return Ue(LA(e)),e}function Ny(t,e){return Aw(t.databaseId,e.path)}function Ig(t,e){const n=FA(e);if(n.get(1)!==t.databaseId.projectId)throw new M(C.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new M(C.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new H(DA(n))}function Py(t,e){return Aw(t.databaseId,e)}function qV(t){const e=FA(t);return e.length===4?ze.emptyPath():DA(e)}function Fy(t){return new ze(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function DA(t){return Ue(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function qE(t,e,n){return{name:Ny(t,e),fields:n.value.mapValue.fields}}function GV(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:X()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(u,d){return u.useProto3Json?(Ue(d===void 0||typeof d=="string"),tn.fromBase64String(d||"")):(Ue(d===void 0||d instanceof Uint8Array),tn.fromUint8Array(d||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,l=a&&function(u){const d=u.code===void 0?C.UNKNOWN:AA(u.code);return new M(d,u.message||"")}(a);n=new NA(r,s,i,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=Ig(t,r.document.name),i=Zr(r.document.updateTime),a=r.document.createTime?Zr(r.document.createTime):J.min(),l=new xn({mapValue:{fields:r.document.fields}}),c=qt.newFoundDocument(s,i,a,l),u=r.targetIds||[],d=r.removedTargetIds||[];n=new nh(u,d,c.key,c)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=Ig(t,r.document),i=r.readTime?Zr(r.readTime):J.min(),a=qt.newNoDocument(s,i),l=r.removedTargetIds||[];n=new nh([],l,a.key,a)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=Ig(t,r.document),i=r.removedTargetIds||[];n=new nh([],i,s,null)}else{if(!("filter"in e))return X();{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,a=new OV(s,i),l=r.targetId;n=new jA(l,a)}}return n}function QV(t,e){let n;if(e instanceof Fu)n={update:qE(t,e.key,e.value)};else if(e instanceof Xm)n={delete:Ny(t,e.key)};else if(e instanceof Bi)n={update:qE(t,e.key,e.data),updateMask:r8(e.fieldMask)};else{if(!(e instanceof PV))return X();n={verify:Ny(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,a){const l=a.transform;if(l instanceof Jc)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof Zc)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof eu)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof tu)return{fieldPath:a.field.canonicalString(),increment:l.Ee};throw X()}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:WV(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:X()}(t,e.precondition)),n}function KV(t,e){return t&&t.length>0?(Ue(e!==void 0),t.map(n=>function(s,i){let a=s.updateTime?Zr(s.updateTime):Zr(i);return a.isEqual(J.min())&&(a=Zr(i)),new AV(a,s.transformResults||[])}(n,e))):[]}function XV(t,e){return{documents:[Py(t,e.path)]}}function YV(t,e){const n={structuredQuery:{}},r=e.path;e.collectionGroup!==null?(n.parent=Py(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Py(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);const s=function(c){if(c.length!==0)return MA(Ar.create(c,"and"))}(e.filters);s&&(n.structuredQuery.where=s);const i=function(c){if(c.length!==0)return c.map(u=>function(h){return{field:Ja(h.field),direction:e8(h.dir)}}(u))}(e.orderBy);i&&(n.structuredQuery.orderBy=i);const a=jy(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),n}function JV(t){let e=qV(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){Ue(r===1);const d=n.from[0];d.allDescendants?s=d.collectionId:e=e.child(d.collectionId)}let i=[];n.where&&(i=function(h){const m=OA(h);return m instanceof Ar&&uA(m)?m.getFilters():[m]}(n.where));let a=[];n.orderBy&&(a=function(h){return h.map(m=>function(g){return new Co(Za(g.field),function(_){switch(_){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(g.direction))}(m))}(n.orderBy));let l=null;n.limit&&(l=function(h){let m;return m=typeof h=="object"?h.value:h,Hm(m)?null:m}(n.limit));let c=null;n.startAt&&(c=function(h){const m=!!h.before,p=h.values||[];return new tf(p,m)}(n.startAt));let u=null;return n.endAt&&(u=function(h){const m=!h.before,p=h.values||[];return new tf(p,m)}(n.endAt)),xV(e,s,a,i,l,"F",c,u)}function ZV(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return X()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function OA(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Za(n.unaryFilter.field);return gt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Za(n.unaryFilter.field);return gt.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Za(n.unaryFilter.field);return gt.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Za(n.unaryFilter.field);return gt.create(a,"!=",{nullValue:"NULL_VALUE"});default:return X()}}(t):t.fieldFilter!==void 0?function(n){return gt.create(Za(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return X()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Ar.create(n.compositeFilter.filters.map(r=>OA(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return X()}}(n.compositeFilter.op))}(t):X()}function e8(t){return BV[t]}function t8(t){return UV[t]}function n8(t){return VV[t]}function Ja(t){return{fieldPath:t.canonicalString()}}function Za(t){return Gt.fromServerFormat(t.fieldPath)}function MA(t){return t instanceof gt?function(n){if(n.op==="=="){if(NE(n.value))return{unaryFilter:{field:Ja(n.field),op:"IS_NAN"}};if(jE(n.value))return{unaryFilter:{field:Ja(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(NE(n.value))return{unaryFilter:{field:Ja(n.field),op:"IS_NOT_NAN"}};if(jE(n.value))return{unaryFilter:{field:Ja(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ja(n.field),op:t8(n.op),value:n.value}}}(t):t instanceof Ar?function(n){const r=n.getFilters().map(s=>MA(s));return r.length===1?r[0]:{compositeFilter:{op:n8(n.op),filters:r}}}(t):X()}function r8(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function LA(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class li{constructor(e,n,r,s,i=J.min(),a=J.min(),l=tn.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(e){return new li(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new li(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new li(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new li(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s8{constructor(e){this.ht=e}}function i8(t){const e=JV({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?nf(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a8{constructor(){this._n=new o8}addToCollectionParentIndex(e,n){return this._n.add(n),N.resolve()}getCollectionParents(e,n){return N.resolve(this._n.getEntries(n))}addFieldIndex(e,n){return N.resolve()}deleteFieldIndex(e,n){return N.resolve()}getDocumentsMatchingTarget(e,n){return N.resolve(null)}getIndexType(e,n){return N.resolve(0)}getFieldIndexes(e,n){return N.resolve([])}getNextCollectionGroupToUpdate(e){return N.resolve(null)}getMinOffset(e,n){return N.resolve(Ri.min())}getMinOffsetFromCollectionGroup(e,n){return N.resolve(Ri.min())}updateCollectionGroup(e,n,r){return N.resolve()}updateIndexEntries(e,n){return N.resolve()}}class o8{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new Yt(ze.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new Yt(ze.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qo{constructor(e){this.On=e}next(){return this.On+=2,this.On}static Nn(){return new qo(0)}static Bn(){return new qo(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l8{constructor(){this.changes=new ml(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,qt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?N.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c8{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u8{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&cc(r.mutation,s,Dn.empty(),_t.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,de()).next(()=>r))}getLocalViewOfDocuments(e,n,r=de()){const s=la();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let a=ql();return i.forEach((l,c)=>{a=a.insert(l,c.overlayedDocument)}),a}))}getOverlayedDocuments(e,n){const r=la();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,de()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((a,l)=>{n.set(a,l)})})}computeViews(e,n,r,s){let i=Ls();const a=lc(),l=function(){return lc()}();return n.forEach((c,u)=>{const d=r.get(u.key);s.has(u.key)&&(d===void 0||d.mutation instanceof Bi)?i=i.insert(u.key,u):d!==void 0?(a.set(u.key,d.mutation.getFieldMask()),cc(d.mutation,u,d.mutation.getFieldMask(),_t.now())):a.set(u.key,Dn.empty())}),this.recalculateAndSaveOverlays(e,i).next(c=>(c.forEach((u,d)=>a.set(u,d)),n.forEach((u,d)=>{var h;return l.set(u,new c8(d,(h=a.get(u))!==null&&h!==void 0?h:null))}),l))}recalculateAndSaveOverlays(e,n){const r=lc();let s=new Je((a,l)=>a-l),i=de();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(a=>{for(const l of a)l.keys().forEach(c=>{const u=n.get(c);if(u===null)return;let d=r.get(c)||Dn.empty();d=l.applyToLocalView(u,d),r.set(c,d);const h=(s.get(l.batchId)||de()).add(c);s=s.insert(l.batchId,h)})}).next(()=>{const a=[],l=s.getReverseIterator();for(;l.hasNext();){const c=l.getNext(),u=c.key,d=c.value,h=vA();d.forEach(m=>{if(!i.has(m)){const p=CA(n.get(m),r.get(m));p!==null&&h.set(m,p),i=i.add(m)}}),a.push(this.documentOverlayCache.saveOverlays(e,u,h))}return N.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r){return function(i){return H.isDocumentKey(i.path)&&i.collectionGroup===null&&i.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):mA(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r):this.getDocumentsMatchingCollectionQuery(e,n,r)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const a=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):N.resolve(la());let l=-1,c=i;return a.next(u=>N.forEach(u,(d,h)=>(l<h.largestBatchId&&(l=h.largestBatchId),i.get(d)?N.resolve():this.remoteDocumentCache.getEntry(e,d).next(m=>{c=c.insert(d,m)}))).next(()=>this.populateOverlays(e,u,i)).next(()=>this.computeViews(e,c,u,de())).next(d=>({batchId:l,changes:xA(d)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new H(n)).next(r=>{let s=ql();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r){const s=n.collectionGroup;let i=ql();return this.indexManager.getCollectionParents(e,s).next(a=>N.forEach(a,l=>{const c=function(d,h){return new fl(h,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(n,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,c,r).next(u=>{u.forEach((d,h)=>{i=i.insert(d,h)})})}).next(()=>i))}getDocumentsMatchingCollectionQuery(e,n,r){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(i=>(s=i,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s))).next(i=>{s.forEach((l,c)=>{const u=c.getKey();i.get(u)===null&&(i=i.insert(u,qt.newInvalidDocument(u)))});let a=ql();return i.forEach((l,c)=>{const u=s.get(l);u!==void 0&&cc(u.mutation,c,Dn.empty(),_t.now()),Gm(n,c)&&(a=a.insert(l,c))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d8{constructor(e){this.serializer=e,this.cr=new Map,this.lr=new Map}getBundleMetadata(e,n){return N.resolve(this.cr.get(n))}saveBundleMetadata(e,n){return this.cr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:Zr(s.createTime)}}(n)),N.resolve()}getNamedQuery(e,n){return N.resolve(this.lr.get(n))}saveNamedQuery(e,n){return this.lr.set(n.name,function(s){return{name:s.name,query:i8(s.bundledQuery),readTime:Zr(s.readTime)}}(n)),N.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h8{constructor(){this.overlays=new Je(H.comparator),this.hr=new Map}getOverlay(e,n){return N.resolve(this.overlays.get(n))}getOverlays(e,n){const r=la();return N.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.It(e,n,i)}),N.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.hr.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.hr.delete(r)),N.resolve()}getOverlaysForCollection(e,n,r){const s=la(),i=n.length+1,a=new H(n.child("")),l=this.overlays.getIteratorFrom(a);for(;l.hasNext();){const c=l.getNext().value,u=c.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===i&&c.largestBatchId>r&&s.set(c.getKey(),c)}return N.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new Je((u,d)=>u-d);const a=this.overlays.getIterator();for(;a.hasNext();){const u=a.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>r){let d=i.get(u.largestBatchId);d===null&&(d=la(),i=i.insert(u.largestBatchId,d)),d.set(u.getKey(),u)}}const l=la(),c=i.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,d)=>l.set(u,d)),!(l.size()>=s)););return N.resolve(l)}It(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const a=this.hr.get(s.largestBatchId).delete(r.key);this.hr.set(s.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new DV(n,r));let i=this.hr.get(n);i===void 0&&(i=de(),this.hr.set(n,i)),this.hr.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jw{constructor(){this.Pr=new Yt(Et.Ir),this.Tr=new Yt(Et.Er)}isEmpty(){return this.Pr.isEmpty()}addReference(e,n){const r=new Et(e,n);this.Pr=this.Pr.add(r),this.Tr=this.Tr.add(r)}dr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Ar(new Et(e,n))}Rr(e,n){e.forEach(r=>this.removeReference(r,n))}Vr(e){const n=new H(new ze([])),r=new Et(n,e),s=new Et(n,e+1),i=[];return this.Tr.forEachInRange([r,s],a=>{this.Ar(a),i.push(a.key)}),i}mr(){this.Pr.forEach(e=>this.Ar(e))}Ar(e){this.Pr=this.Pr.delete(e),this.Tr=this.Tr.delete(e)}gr(e){const n=new H(new ze([])),r=new Et(n,e),s=new Et(n,e+1);let i=de();return this.Tr.forEachInRange([r,s],a=>{i=i.add(a.key)}),i}containsKey(e){const n=new Et(e,0),r=this.Pr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Et{constructor(e,n){this.key=e,this.pr=n}static Ir(e,n){return H.comparator(e.key,n.key)||be(e.pr,n.pr)}static Er(e,n){return be(e.pr,n.pr)||H.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f8{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.yr=1,this.wr=new Yt(Et.Ir)}checkEmpty(e){return N.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.yr;this.yr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new FV(i,n,r,s);this.mutationQueue.push(a);for(const l of s)this.wr=this.wr.add(new Et(l.key,i)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return N.resolve(a)}lookupMutationBatch(e,n){return N.resolve(this.Sr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.br(r),i=s<0?0:s;return N.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return N.resolve(this.mutationQueue.length===0?-1:this.yr-1)}getAllMutationBatches(e){return N.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Et(n,0),s=new Et(n,Number.POSITIVE_INFINITY),i=[];return this.wr.forEachInRange([r,s],a=>{const l=this.Sr(a.pr);i.push(l)}),N.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Yt(be);return n.forEach(s=>{const i=new Et(s,0),a=new Et(s,Number.POSITIVE_INFINITY);this.wr.forEachInRange([i,a],l=>{r=r.add(l.pr)})}),N.resolve(this.Dr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;H.isDocumentKey(i)||(i=i.child(""));const a=new Et(new H(i),0);let l=new Yt(be);return this.wr.forEachWhile(c=>{const u=c.key.path;return!!r.isPrefixOf(u)&&(u.length===s&&(l=l.add(c.pr)),!0)},a),N.resolve(this.Dr(l))}Dr(e){const n=[];return e.forEach(r=>{const s=this.Sr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){Ue(this.vr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.wr;return N.forEach(n.mutations,s=>{const i=new Et(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.wr=r})}Mn(e){}containsKey(e,n){const r=new Et(n,0),s=this.wr.firstAfterOrEqual(r);return N.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,N.resolve()}vr(e,n){return this.br(e)}br(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Sr(e){const n=this.br(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m8{constructor(e){this.Cr=e,this.docs=function(){return new Je(H.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,a=this.Cr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return N.resolve(r?r.document.mutableCopy():qt.newInvalidDocument(n))}getEntries(e,n){let r=Ls();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():qt.newInvalidDocument(s))}),N.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=Ls();const a=n.path,l=new H(a.child("")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){const{key:u,value:{document:d}}=c.getNext();if(!a.isPrefixOf(u.path))break;u.path.length>a.length+1||tV(eV(d),r)<=0||(s.has(d.key)||Gm(n,d))&&(i=i.insert(d.key,d.mutableCopy()))}return N.resolve(i)}getAllFromCollectionGroup(e,n,r,s){X()}Fr(e,n){return N.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new p8(this)}getSize(e){return N.resolve(this.size)}}class p8 extends l8{constructor(e){super(),this.ar=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.ar.addEntry(e,s)):this.ar.removeEntry(r)}),N.waitFor(n)}getFromCache(e,n){return this.ar.getEntry(e,n)}getAllFromCache(e,n){return this.ar.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g8{constructor(e){this.persistence=e,this.Mr=new ml(n=>bw(n),kw),this.lastRemoteSnapshotVersion=J.min(),this.highestTargetId=0,this.Or=0,this.Nr=new jw,this.targetCount=0,this.Br=qo.Nn()}forEachTarget(e,n){return this.Mr.forEach((r,s)=>n(s)),N.resolve()}getLastRemoteSnapshotVersion(e){return N.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return N.resolve(this.Or)}allocateTargetId(e){return this.highestTargetId=this.Br.next(),N.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Or&&(this.Or=n),N.resolve()}qn(e){this.Mr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.Br=new qo(n),this.highestTargetId=n),e.sequenceNumber>this.Or&&(this.Or=e.sequenceNumber)}addTargetData(e,n){return this.qn(n),this.targetCount+=1,N.resolve()}updateTargetData(e,n){return this.qn(n),N.resolve()}removeTargetData(e,n){return this.Mr.delete(n.target),this.Nr.Vr(n.targetId),this.targetCount-=1,N.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.Mr.forEach((a,l)=>{l.sequenceNumber<=n&&r.get(l.targetId)===null&&(this.Mr.delete(a),i.push(this.removeMatchingKeysForTargetId(e,l.targetId)),s++)}),N.waitFor(i).next(()=>s)}getTargetCount(e){return N.resolve(this.targetCount)}getTargetData(e,n){const r=this.Mr.get(n)||null;return N.resolve(r)}addMatchingKeys(e,n,r){return this.Nr.dr(n,r),N.resolve()}removeMatchingKeys(e,n,r){this.Nr.Rr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(a=>{i.push(s.markPotentiallyOrphaned(e,a))}),N.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.Nr.Vr(n),N.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Nr.gr(n);return N.resolve(r)}containsKey(e,n){return N.resolve(this.Nr.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y8{constructor(e,n){this.Lr={},this.overlays={},this.kr=new ww(0),this.qr=!1,this.qr=!0,this.referenceDelegate=e(this),this.Qr=new g8(this),this.indexManager=new a8,this.remoteDocumentCache=function(s){return new m8(s)}(r=>this.referenceDelegate.Kr(r)),this.serializer=new s8(n),this.$r=new d8(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new h8,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.Lr[e.toKey()];return r||(r=new f8(n,this.referenceDelegate),this.Lr[e.toKey()]=r),r}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction(e,n,r){z("MemoryPersistence","Starting transaction:",e);const s=new x8(this.kr.next());return this.referenceDelegate.Ur(),r(s).next(i=>this.referenceDelegate.Wr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Gr(e,n){return N.or(Object.values(this.Lr).map(r=>()=>r.containsKey(e,n)))}}class x8 extends rV{constructor(e){super(),this.currentSequenceNumber=e}}class Nw{constructor(e){this.persistence=e,this.zr=new jw,this.jr=null}static Hr(e){return new Nw(e)}get Jr(){if(this.jr)return this.jr;throw X()}addReference(e,n,r){return this.zr.addReference(r,n),this.Jr.delete(r.toString()),N.resolve()}removeReference(e,n,r){return this.zr.removeReference(r,n),this.Jr.add(r.toString()),N.resolve()}markPotentiallyOrphaned(e,n){return this.Jr.add(n.toString()),N.resolve()}removeTarget(e,n){this.zr.Vr(n.targetId).forEach(s=>this.Jr.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.Jr.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}Ur(){this.jr=new Set}Wr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return N.forEach(this.Jr,r=>{const s=H.fromPath(r);return this.Yr(e,s).next(i=>{i||n.removeEntry(s,J.min())})}).next(()=>(this.jr=null,n.apply(e)))}updateLimboDocument(e,n){return this.Yr(e,n).next(r=>{r?this.Jr.delete(n.toString()):this.Jr.add(n.toString())})}Kr(e){return 0}Yr(e,n){return N.or([()=>N.resolve(this.zr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Gr(e,n)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pw{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.qi=r,this.Qi=s}static Ki(e,n){let r=de(),s=de();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Pw(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v8{constructor(){this.$i=!1}initialize(e,n){this.Ui=e,this.indexManager=n,this.$i=!0}getDocumentsMatchingQuery(e,n,r,s){return this.Wi(e,n).next(i=>i||this.Gi(e,n,s,r)).next(i=>i||this.zi(e,n))}Wi(e,n){if(OE(n))return N.resolve(null);let r=Ms(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=nf(n,null,"F"),r=Ms(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const a=de(...i);return this.Ui.getDocuments(e,a).next(l=>this.indexManager.getMinOffset(e,r).next(c=>{const u=this.ji(n,l);return this.Hi(n,u,a,c.readTime)?this.Wi(e,nf(n,null,"F")):this.Ji(e,u,n,c)}))})))}Gi(e,n,r,s){return OE(n)||s.isEqual(J.min())?this.zi(e,n):this.Ui.getDocuments(e,r).next(i=>{const a=this.ji(n,i);return this.Hi(n,a,r,s)?this.zi(e,n):(TE()<=Se.DEBUG&&z("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Ay(n)),this.Ji(e,a,n,ZU(s,-1)))})}ji(e,n){let r=new Yt(gA(e));return n.forEach((s,i)=>{Gm(e,i)&&(r=r.add(i))}),r}Hi(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}zi(e,n){return TE()<=Se.DEBUG&&z("QueryEngine","Using full collection scan to execute query:",Ay(n)),this.Ui.getDocumentsMatchingQuery(e,n,Ri.min())}Ji(e,n,r,s){return this.Ui.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(a=>{i=i.insert(a.key,a)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w8{constructor(e,n,r,s){this.persistence=e,this.Yi=n,this.serializer=s,this.Zi=new Je(be),this.Xi=new ml(i=>bw(i),kw),this.es=new Map,this.ts=e.getRemoteDocumentCache(),this.Qr=e.getTargetCache(),this.$r=e.getBundleCache(),this.ns(r)}ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new u8(this.ts,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ts.setIndexManager(this.indexManager),this.Yi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Zi))}}function _8(t,e,n,r){return new w8(t,e,n,r)}async function $A(t,e){const n=ne(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.ns(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const a=[],l=[];let c=de();for(const u of s){a.push(u.batchId);for(const d of u.mutations)c=c.add(d.key)}for(const u of i){l.push(u.batchId);for(const d of u.mutations)c=c.add(d.key)}return n.localDocuments.getDocuments(r,c).next(u=>({rs:u,removedBatchIds:a,addedBatchIds:l}))})})}function S8(t,e){const n=ne(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.ts.newChangeBuffer({trackRemovals:!0});return function(l,c,u,d){const h=u.batch,m=h.keys();let p=N.resolve();return m.forEach(g=>{p=p.next(()=>d.getEntry(c,g)).next(y=>{const _=u.docVersions.get(g);Ue(_!==null),y.version.compareTo(_)<0&&(h.applyToRemoteDocument(y,u),y.isValidDocument()&&(y.setReadTime(u.commitVersion),d.addEntry(y)))})}),p.next(()=>l.mutationQueue.removeMutationBatch(c,h))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let c=de();for(let u=0;u<l.mutationResults.length;++u)l.mutationResults[u].transformResults.length>0&&(c=c.add(l.batch.mutations[u].key));return c}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function zA(t){const e=ne(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Qr.getLastRemoteSnapshotVersion(n))}function E8(t,e){const n=ne(t),r=e.snapshotVersion;let s=n.Zi;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const a=n.ts.newChangeBuffer({trackRemovals:!0});s=n.Zi;const l=[];e.targetChanges.forEach((d,h)=>{const m=s.get(h);if(!m)return;l.push(n.Qr.removeMatchingKeys(i,d.removedDocuments,h).next(()=>n.Qr.addMatchingKeys(i,d.addedDocuments,h)));let p=m.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(h)!==null?p=p.withResumeToken(tn.EMPTY_BYTE_STRING,J.min()).withLastLimboFreeSnapshotVersion(J.min()):d.resumeToken.approximateByteSize()>0&&(p=p.withResumeToken(d.resumeToken,r)),s=s.insert(h,p),function(y,_,w){return y.resumeToken.approximateByteSize()===0||_.snapshotVersion.toMicroseconds()-y.snapshotVersion.toMicroseconds()>=3e8?!0:w.addedDocuments.size+w.modifiedDocuments.size+w.removedDocuments.size>0}(m,p,d)&&l.push(n.Qr.updateTargetData(i,p))});let c=Ls(),u=de();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(i,d))}),l.push(b8(i,a,e.documentUpdates).next(d=>{c=d.ss,u=d.os})),!r.isEqual(J.min())){const d=n.Qr.getLastRemoteSnapshotVersion(i).next(h=>n.Qr.setTargetsMetadata(i,i.currentSequenceNumber,r));l.push(d)}return N.waitFor(l).next(()=>a.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,c,u)).next(()=>c)}).then(i=>(n.Zi=s,i))}function b8(t,e,n){let r=de(),s=de();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let a=Ls();return n.forEach((l,c)=>{const u=i.get(l);c.isFoundDocument()!==u.isFoundDocument()&&(s=s.add(l)),c.isNoDocument()&&c.version.isEqual(J.min())?(e.removeEntry(l,c.readTime),a=a.insert(l,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),a=a.insert(l,c)):z("LocalStore","Ignoring outdated watch update for ",l,". Current version:",u.version," Watch version:",c.version)}),{ss:a,os:s}})}function k8(t,e){const n=ne(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function T8(t,e){const n=ne(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Qr.getTargetData(r,e).next(i=>i?(s=i,N.resolve(s)):n.Qr.allocateTargetId(r).next(a=>(s=new li(e,a,"TargetPurposeListen",r.currentSequenceNumber),n.Qr.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.Zi.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.Zi=n.Zi.insert(r.targetId,r),n.Xi.set(e,r.targetId)),r})}async function Dy(t,e,n){const r=ne(t),s=r.Zi.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,a=>r.persistence.referenceDelegate.removeTarget(a,s))}catch(a){if(!Pu(a))throw a;z("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}r.Zi=r.Zi.remove(e),r.Xi.delete(s.target)}function GE(t,e,n){const r=ne(t);let s=J.min(),i=de();return r.persistence.runTransaction("Execute query","readonly",a=>function(c,u,d){const h=ne(c),m=h.Xi.get(d);return m!==void 0?N.resolve(h.Zi.get(m)):h.Qr.getTargetData(u,d)}(r,a,Ms(e)).next(l=>{if(l)return s=l.lastLimboFreeSnapshotVersion,r.Qr.getMatchingKeysForTargetId(a,l.targetId).next(c=>{i=c})}).next(()=>r.Yi.getDocumentsMatchingQuery(a,e,n?s:J.min(),n?i:de())).next(l=>(I8(r,wV(e),l),{documents:l,_s:i})))}function I8(t,e,n){let r=t.es.get(e)||J.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.es.set(e,r)}class QE{constructor(){this.activeTargetIds=TV()}Is(e){this.activeTargetIds=this.activeTargetIds.add(e)}Ts(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ps(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class C8{constructor(){this.Ys=new QE,this.Zs={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e){return this.Ys.Is(e),this.Zs[e]||"not-current"}updateQueryState(e,n,r){this.Zs[e]=n}removeLocalQueryTarget(e){this.Ys.Ts(e)}isLocalQueryTarget(e){return this.Ys.activeTargetIds.has(e)}clearQueryState(e){delete this.Zs[e]}getAllActiveQueryTargets(){return this.Ys.activeTargetIds}isActiveQueryTarget(e){return this.Ys.activeTargetIds.has(e)}start(){return this.Ys=new QE,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R8{Xs(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KE{constructor(){this.eo=()=>this.no(),this.ro=()=>this.io(),this.so=[],this.oo()}Xs(e){this.so.push(e)}shutdown(){window.removeEventListener("online",this.eo),window.removeEventListener("offline",this.ro)}oo(){window.addEventListener("online",this.eo),window.addEventListener("offline",this.ro)}no(){z("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.so)e(0)}io(){z("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.so)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wd=null;function Cg(){return wd===null?wd=function(){return 268435456+Math.round(2147483648*Math.random())}():wd++,"0x"+wd.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A8={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j8{constructor(e){this._o=e._o,this.ao=e.ao}uo(e){this.co=e}lo(e){this.ho=e}onMessage(e){this.Po=e}close(){this.ao()}send(e){this._o(e)}Io(){this.co()}To(e){this.ho(e)}Eo(e){this.Po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ut="WebChannelConnection";class N8 extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Ao=r+"://"+n.host,this.Ro=`projects/${s}/databases/${i}`,this.Vo=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get mo(){return!1}fo(n,r,s,i,a){const l=Cg(),c=this.po(n,r);z("RestConnection",`Sending RPC '${n}' ${l}:`,c,s);const u={"google-cloud-resource-prefix":this.Ro,"x-goog-request-params":this.Vo};return this.yo(u,i,a),this.wo(n,c,u,s).then(d=>(z("RestConnection",`Received RPC '${n}' ${l}: `,d),d),d=>{throw Uo("RestConnection",`RPC '${n}' ${l} failed with error: `,d,"url: ",c,"request:",s),d})}So(n,r,s,i,a,l){return this.fo(n,r,s,i,a)}yo(n,r,s){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+hl}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,a)=>n[a]=i),s&&s.headers.forEach((i,a)=>n[a]=i)}po(n,r){const s=A8[n];return`${this.Ao}/v1/${r}:${s}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}wo(e,n,r,s){const i=Cg();return new Promise((a,l)=>{const c=new UU;c.setWithCredentials(!0),c.listenOnce(zU.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Tg.NO_ERROR:const d=c.getResponseJson();z(Ut,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(d)),a(d);break;case Tg.TIMEOUT:z(Ut,`RPC '${e}' ${i} timed out`),l(new M(C.DEADLINE_EXCEEDED,"Request time out"));break;case Tg.HTTP_ERROR:const h=c.getStatus();if(z(Ut,`RPC '${e}' ${i} failed with status:`,h,"response text:",c.getResponseText()),h>0){let m=c.getResponseJson();Array.isArray(m)&&(m=m[0]);const p=m==null?void 0:m.error;if(p&&p.status&&p.message){const g=function(_){const w=_.toLowerCase().replace(/_/g,"-");return Object.values(C).indexOf(w)>=0?w:C.UNKNOWN}(p.status);l(new M(g,p.message))}else l(new M(C.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new M(C.UNAVAILABLE,"Connection failed."));break;default:X()}}finally{z(Ut,`RPC '${e}' ${i} completed.`)}});const u=JSON.stringify(s);z(Ut,`RPC '${e}' ${i} sending request:`,s),c.send(n,"POST",u,r,15)})}bo(e,n,r){const s=Cg(),i=[this.Ao,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=LU(),l=$U(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.yo(c.initMessageHeaders,n,r),c.encodeInitMessageHeaders=!0;const d=i.join("");z(Ut,`Creating RPC '${e}' stream ${s}: ${d}`,c);const h=a.createWebChannel(d,c);let m=!1,p=!1;const g=new j8({_o:_=>{p?z(Ut,`Not sending because RPC '${e}' stream ${s} is closed:`,_):(m||(z(Ut,`Opening RPC '${e}' stream ${s} transport.`),h.open(),m=!0),z(Ut,`RPC '${e}' stream ${s} sending:`,_),h.send(_))},ao:()=>h.close()}),y=(_,w,x)=>{_.listen(w,v=>{try{x(v)}catch(S){setTimeout(()=>{throw S},0)}})};return y(h,yd.EventType.OPEN,()=>{p||z(Ut,`RPC '${e}' stream ${s} transport opened.`)}),y(h,yd.EventType.CLOSE,()=>{p||(p=!0,z(Ut,`RPC '${e}' stream ${s} transport closed`),g.To())}),y(h,yd.EventType.ERROR,_=>{p||(p=!0,Uo(Ut,`RPC '${e}' stream ${s} transport errored:`,_),g.To(new M(C.UNAVAILABLE,"The operation could not be completed")))}),y(h,yd.EventType.MESSAGE,_=>{var w;if(!p){const x=_.data[0];Ue(!!x);const v=x,S=v.error||((w=v[0])===null||w===void 0?void 0:w.error);if(S){z(Ut,`RPC '${e}' stream ${s} received error:`,S);const E=S.status;let b=function(L){const P=ft[L];if(P!==void 0)return AA(P)}(E),I=S.message;b===void 0&&(b=C.INTERNAL,I="Unknown error status: "+E+" with message "+S.message),p=!0,g.To(new M(b,I)),h.close()}else z(Ut,`RPC '${e}' stream ${s} received:`,x),g.Eo(x)}}),y(l,BU.STAT_EVENT,_=>{_.stat===bE.PROXY?z(Ut,`RPC '${e}' stream ${s} detected buffering proxy`):_.stat===bE.NOPROXY&&z(Ut,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{g.Io()},0),g}}function Rg(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jm(t){return new HV(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BA{constructor(e,n,r=1e3,s=1.5,i=6e4){this.oi=e,this.timerId=n,this.Do=r,this.vo=s,this.Co=i,this.Fo=0,this.Mo=null,this.xo=Date.now(),this.reset()}reset(){this.Fo=0}Oo(){this.Fo=this.Co}No(e){this.cancel();const n=Math.floor(this.Fo+this.Bo()),r=Math.max(0,Date.now()-this.xo),s=Math.max(0,n-r);s>0&&z("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Fo} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.Mo=this.oi.enqueueAfterDelay(this.timerId,s,()=>(this.xo=Date.now(),e())),this.Fo*=this.vo,this.Fo<this.Do&&(this.Fo=this.Do),this.Fo>this.Co&&(this.Fo=this.Co)}Lo(){this.Mo!==null&&(this.Mo.skipDelay(),this.Mo=null)}cancel(){this.Mo!==null&&(this.Mo.cancel(),this.Mo=null)}Bo(){return(Math.random()-.5)*this.Fo}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UA{constructor(e,n,r,s,i,a,l,c){this.oi=e,this.ko=r,this.qo=s,this.connection=i,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.Qo=0,this.Ko=null,this.$o=null,this.stream=null,this.Uo=new BA(e,n)}Wo(){return this.state===1||this.state===5||this.Go()}Go(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.zo()}async stop(){this.Wo()&&await this.close(0)}jo(){this.state=0,this.Uo.reset()}Ho(){this.Go()&&this.Ko===null&&(this.Ko=this.oi.enqueueAfterDelay(this.ko,6e4,()=>this.Jo()))}Yo(e){this.Zo(),this.stream.send(e)}async Jo(){if(this.Go())return this.close(0)}Zo(){this.Ko&&(this.Ko.cancel(),this.Ko=null)}Xo(){this.$o&&(this.$o.cancel(),this.$o=null)}async close(e,n){this.Zo(),this.Xo(),this.Uo.cancel(),this.Qo++,e!==4?this.Uo.reset():n&&n.code===C.RESOURCE_EXHAUSTED?(Os(n.toString()),Os("Using maximum backoff delay to prevent overloading the backend."),this.Uo.Oo()):n&&n.code===C.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.e_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.lo(n)}e_(){}auth(){this.state=1;const e=this.t_(this.Qo),n=this.Qo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Qo===n&&this.n_(r,s)},r=>{e(()=>{const s=new M(C.UNKNOWN,"Fetching auth token failed: "+r.message);return this.r_(s)})})}n_(e,n){const r=this.t_(this.Qo);this.stream=this.i_(e,n),this.stream.uo(()=>{r(()=>(this.state=2,this.$o=this.oi.enqueueAfterDelay(this.qo,1e4,()=>(this.Go()&&(this.state=3),Promise.resolve())),this.listener.uo()))}),this.stream.lo(s=>{r(()=>this.r_(s))}),this.stream.onMessage(s=>{r(()=>this.onMessage(s))})}zo(){this.state=5,this.Uo.No(async()=>{this.state=0,this.start()})}r_(e){return z("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}t_(e){return n=>{this.oi.enqueueAndForget(()=>this.Qo===e?n():(z("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class P8 extends UA{constructor(e,n,r,s,i,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,a),this.serializer=i}i_(e,n){return this.connection.bo("Listen",e,n)}onMessage(e){this.Uo.reset();const n=GV(this.serializer,e),r=function(i){if(!("targetChange"in i))return J.min();const a=i.targetChange;return a.targetIds&&a.targetIds.length?J.min():a.readTime?Zr(a.readTime):J.min()}(e);return this.listener.s_(n,r)}o_(e){const n={};n.database=Fy(this.serializer),n.addTarget=function(i,a){let l;const c=a.target;if(l=Cy(c)?{documents:XV(i,c)}:{query:YV(i,c)},l.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){l.resumeToken=PA(i,a.resumeToken);const u=jy(i,a.expectedCount);u!==null&&(l.expectedCount=u)}else if(a.snapshotVersion.compareTo(J.min())>0){l.readTime=rf(i,a.snapshotVersion.toTimestamp());const u=jy(i,a.expectedCount);u!==null&&(l.expectedCount=u)}return l}(this.serializer,e);const r=ZV(this.serializer,e);r&&(n.labels=r),this.Yo(n)}__(e){const n={};n.database=Fy(this.serializer),n.removeTarget=e,this.Yo(n)}}class F8 extends UA{constructor(e,n,r,s,i,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,a),this.serializer=i,this.a_=!1}get u_(){return this.a_}start(){this.a_=!1,this.lastStreamToken=void 0,super.start()}e_(){this.a_&&this.c_([])}i_(e,n){return this.connection.bo("Write",e,n)}onMessage(e){if(Ue(!!e.streamToken),this.lastStreamToken=e.streamToken,this.a_){this.Uo.reset();const n=KV(e.writeResults,e.commitTime),r=Zr(e.commitTime);return this.listener.l_(r,n)}return Ue(!e.writeResults||e.writeResults.length===0),this.a_=!0,this.listener.h_()}P_(){const e={};e.database=Fy(this.serializer),this.Yo(e)}c_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>QV(this.serializer,r))};this.Yo(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D8 extends class{}{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.I_=!1}T_(){if(this.I_)throw new M(C.FAILED_PRECONDITION,"The client has already been terminated.")}fo(e,n,r){return this.T_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,i])=>this.connection.fo(e,n,r,s,i)).catch(s=>{throw s.name==="FirebaseError"?(s.code===C.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new M(C.UNKNOWN,s.toString())})}So(e,n,r,s){return this.T_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,a])=>this.connection.So(e,n,r,i,a,s)).catch(i=>{throw i.name==="FirebaseError"?(i.code===C.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new M(C.UNKNOWN,i.toString())})}terminate(){this.I_=!0}}class O8{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.d_=0,this.A_=null,this.R_=!0}V_(){this.d_===0&&(this.m_("Unknown"),this.A_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.A_=null,this.f_("Backend didn't respond within 10 seconds."),this.m_("Offline"),Promise.resolve())))}g_(e){this.state==="Online"?this.m_("Unknown"):(this.d_++,this.d_>=1&&(this.p_(),this.f_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.m_("Offline")))}set(e){this.p_(),this.d_=0,e==="Online"&&(this.R_=!1),this.m_(e)}m_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}f_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.R_?(Os(n),this.R_=!1):z("OnlineStateTracker",n)}p_(){this.A_!==null&&(this.A_.cancel(),this.A_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M8{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.y_=[],this.w_=new Map,this.S_=new Set,this.b_=[],this.D_=i,this.D_.Xs(a=>{r.enqueueAndForget(async()=>{za(this)&&(z("RemoteStore","Restarting streams for network reachability change."),await async function(c){const u=ne(c);u.S_.add(4),await Ou(u),u.v_.set("Unknown"),u.S_.delete(4),await Zm(u)}(this))})}),this.v_=new O8(r,s)}}async function Zm(t){if(za(t))for(const e of t.b_)await e(!0)}async function Ou(t){for(const e of t.b_)await e(!1)}function VA(t,e){const n=ne(t);n.w_.has(e.targetId)||(n.w_.set(e.targetId,e),Ow(n)?Dw(n):pl(n).Go()&&Fw(n,e))}function HA(t,e){const n=ne(t),r=pl(n);n.w_.delete(e),r.Go()&&WA(n,e),n.w_.size===0&&(r.Go()?r.Ho():za(n)&&n.v_.set("Unknown"))}function Fw(t,e){if(t.C_.Le(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(J.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}pl(t).o_(e)}function WA(t,e){t.C_.Le(e),pl(t).__(e)}function Dw(t){t.C_=new zV({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),lt:e=>t.w_.get(e)||null,st:()=>t.datastore.serializer.databaseId}),pl(t).start(),t.v_.V_()}function Ow(t){return za(t)&&!pl(t).Wo()&&t.w_.size>0}function za(t){return ne(t).S_.size===0}function qA(t){t.C_=void 0}async function L8(t){t.w_.forEach((e,n)=>{Fw(t,e)})}async function $8(t,e){qA(t),Ow(t)?(t.v_.g_(e),Dw(t)):t.v_.set("Unknown")}async function z8(t,e,n){if(t.v_.set("Online"),e instanceof NA&&e.state===2&&e.cause)try{await async function(s,i){const a=i.cause;for(const l of i.targetIds)s.w_.has(l)&&(await s.remoteSyncer.rejectListen(l,a),s.w_.delete(l),s.C_.removeTarget(l))}(t,e)}catch(r){z("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await sf(t,r)}else if(e instanceof nh?t.C_.Ge(e):e instanceof jA?t.C_.Xe(e):t.C_.He(e),!n.isEqual(J.min()))try{const r=await zA(t.localStore);n.compareTo(r)>=0&&await function(i,a){const l=i.C_._t(a);return l.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){const d=i.w_.get(u);d&&i.w_.set(u,d.withResumeToken(c.resumeToken,a))}}),l.targetMismatches.forEach((c,u)=>{const d=i.w_.get(c);if(!d)return;i.w_.set(c,d.withResumeToken(tn.EMPTY_BYTE_STRING,d.snapshotVersion)),WA(i,c);const h=new li(d.target,c,u,d.sequenceNumber);Fw(i,h)}),i.remoteSyncer.applyRemoteEvent(l)}(t,n)}catch(r){z("RemoteStore","Failed to raise snapshot:",r),await sf(t,r)}}async function sf(t,e,n){if(!Pu(e))throw e;t.S_.add(1),await Ou(t),t.v_.set("Offline"),n||(n=()=>zA(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{z("RemoteStore","Retrying IndexedDB access"),await n(),t.S_.delete(1),await Zm(t)})}function GA(t,e){return e().catch(n=>sf(t,n,e))}async function ep(t){const e=ne(t),n=ji(e);let r=e.y_.length>0?e.y_[e.y_.length-1].batchId:-1;for(;B8(e);)try{const s=await k8(e.localStore,r);if(s===null){e.y_.length===0&&n.Ho();break}r=s.batchId,U8(e,s)}catch(s){await sf(e,s)}QA(e)&&KA(e)}function B8(t){return za(t)&&t.y_.length<10}function U8(t,e){t.y_.push(e);const n=ji(t);n.Go()&&n.u_&&n.c_(e.mutations)}function QA(t){return za(t)&&!ji(t).Wo()&&t.y_.length>0}function KA(t){ji(t).start()}async function V8(t){ji(t).P_()}async function H8(t){const e=ji(t);for(const n of t.y_)e.c_(n.mutations)}async function W8(t,e,n){const r=t.y_.shift(),s=Cw.from(r,e,n);await GA(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await ep(t)}async function q8(t,e){e&&ji(t).u_&&await async function(r,s){if(function(a){return MV(a)&&a!==C.ABORTED}(s.code)){const i=r.y_.shift();ji(r).jo(),await GA(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await ep(r)}}(t,e),QA(t)&&KA(t)}async function XE(t,e){const n=ne(t);n.asyncQueue.verifyOperationInProgress(),z("RemoteStore","RemoteStore received new credentials");const r=za(n);n.S_.add(3),await Ou(n),r&&n.v_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.S_.delete(3),await Zm(n)}async function G8(t,e){const n=ne(t);e?(n.S_.delete(2),await Zm(n)):e||(n.S_.add(2),await Ou(n),n.v_.set("Unknown"))}function pl(t){return t.F_||(t.F_=function(n,r,s){const i=ne(n);return i.T_(),new P8(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{uo:L8.bind(null,t),lo:$8.bind(null,t),s_:z8.bind(null,t)}),t.b_.push(async e=>{e?(t.F_.jo(),Ow(t)?Dw(t):t.v_.set("Unknown")):(await t.F_.stop(),qA(t))})),t.F_}function ji(t){return t.M_||(t.M_=function(n,r,s){const i=ne(n);return i.T_(),new F8(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{uo:V8.bind(null,t),lo:q8.bind(null,t),h_:H8.bind(null,t),l_:W8.bind(null,t)}),t.b_.push(async e=>{e?(t.M_.jo(),await ep(t)):(await t.M_.stop(),t.y_.length>0&&(z("RemoteStore",`Stopping write stream with ${t.y_.length} pending writes`),t.y_=[]))})),t.M_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mw{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new Ts,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}static createAndSchedule(e,n,r,s,i){const a=Date.now()+r,l=new Mw(e,n,a,s,i);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new M(C.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Lw(t,e){if(Os("AsyncQueue",`${e}: ${t}`),Pu(t))return new M(C.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ro{constructor(e){this.comparator=e?(n,r)=>e(n,r)||H.comparator(n.key,r.key):(n,r)=>H.comparator(n.key,r.key),this.keyedMap=ql(),this.sortedSet=new Je(this.comparator)}static emptySet(e){return new Ro(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Ro)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Ro;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YE{constructor(){this.x_=new Je(H.comparator)}track(e){const n=e.doc.key,r=this.x_.get(n);r?e.type!==0&&r.type===3?this.x_=this.x_.insert(n,e):e.type===3&&r.type!==1?this.x_=this.x_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.x_=this.x_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.x_=this.x_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.x_=this.x_.remove(n):e.type===1&&r.type===2?this.x_=this.x_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.x_=this.x_.insert(n,{type:2,doc:e.doc}):X():this.x_=this.x_.insert(n,e)}O_(){const e=[];return this.x_.inorderTraversal((n,r)=>{e.push(r)}),e}}class Go{constructor(e,n,r,s,i,a,l,c,u){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=a,this.syncStateChanged=l,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,n,r,s,i){const a=[];return n.forEach(l=>{a.push({type:0,doc:l})}),new Go(e,n,Ro.emptySet(n),a,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&qm(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q8{constructor(){this.N_=void 0,this.listeners=[]}}class K8{constructor(){this.queries=new ml(e=>pA(e),qm),this.onlineState="Unknown",this.B_=new Set}}async function XA(t,e){const n=ne(t),r=e.query;let s=!1,i=n.queries.get(r);if(i||(s=!0,i=new Q8),s)try{i.N_=await n.onListen(r)}catch(a){const l=Lw(a,`Initialization of query '${Ay(e.query)}' failed`);return void e.onError(l)}n.queries.set(r,i),i.listeners.push(e),e.L_(n.onlineState),i.N_&&e.k_(i.N_)&&$w(n)}async function YA(t,e){const n=ne(t),r=e.query;let s=!1;const i=n.queries.get(r);if(i){const a=i.listeners.indexOf(e);a>=0&&(i.listeners.splice(a,1),s=i.listeners.length===0)}if(s)return n.queries.delete(r),n.onUnlisten(r)}function X8(t,e){const n=ne(t);let r=!1;for(const s of e){const i=s.query,a=n.queries.get(i);if(a){for(const l of a.listeners)l.k_(s)&&(r=!0);a.N_=s}}r&&$w(n)}function Y8(t,e,n){const r=ne(t),s=r.queries.get(e);if(s)for(const i of s.listeners)i.onError(n);r.queries.delete(e)}function $w(t){t.B_.forEach(e=>{e.next()})}class JA{constructor(e,n,r){this.query=e,this.q_=n,this.Q_=!1,this.K_=null,this.onlineState="Unknown",this.options=r||{}}k_(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Go(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Q_?this.U_(e)&&(this.q_.next(e),n=!0):this.W_(e,this.onlineState)&&(this.G_(e),n=!0),this.K_=e,n}onError(e){this.q_.error(e)}L_(e){this.onlineState=e;let n=!1;return this.K_&&!this.Q_&&this.W_(this.K_,e)&&(this.G_(this.K_),n=!0),n}W_(e,n){if(!e.fromCache)return!0;const r=n!=="Offline";return(!this.options.z_||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}U_(e){if(e.docChanges.length>0)return!0;const n=this.K_&&this.K_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}G_(e){e=Go.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Q_=!0,this.q_.next(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZA{constructor(e){this.key=e}}class ej{constructor(e){this.key=e}}class J8{constructor(e,n){this.query=e,this.ta=n,this.na=null,this.hasCachedResults=!1,this.current=!1,this.ra=de(),this.mutatedKeys=de(),this.ia=gA(e),this.sa=new Ro(this.ia)}get oa(){return this.ta}_a(e,n){const r=n?n.aa:new YE,s=n?n.sa:this.sa;let i=n?n.mutatedKeys:this.mutatedKeys,a=s,l=!1;const c=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,u=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((d,h)=>{const m=s.get(d),p=Gm(this.query,h)?h:null,g=!!m&&this.mutatedKeys.has(m.key),y=!!p&&(p.hasLocalMutations||this.mutatedKeys.has(p.key)&&p.hasCommittedMutations);let _=!1;m&&p?m.data.isEqual(p.data)?g!==y&&(r.track({type:3,doc:p}),_=!0):this.ua(m,p)||(r.track({type:2,doc:p}),_=!0,(c&&this.ia(p,c)>0||u&&this.ia(p,u)<0)&&(l=!0)):!m&&p?(r.track({type:0,doc:p}),_=!0):m&&!p&&(r.track({type:1,doc:m}),_=!0,(c||u)&&(l=!0)),_&&(p?(a=a.add(p),i=y?i.add(d):i.delete(d)):(a=a.delete(d),i=i.delete(d)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const d=this.query.limitType==="F"?a.last():a.first();a=a.delete(d.key),i=i.delete(d.key),r.track({type:1,doc:d})}return{sa:a,aa:r,Hi:l,mutatedKeys:i}}ua(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r){const s=this.sa;this.sa=e.sa,this.mutatedKeys=e.mutatedKeys;const i=e.aa.O_();i.sort((u,d)=>function(m,p){const g=y=>{switch(y){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return X()}};return g(m)-g(p)}(u.type,d.type)||this.ia(u.doc,d.doc)),this.ca(r);const a=n?this.la():[],l=this.ra.size===0&&this.current?1:0,c=l!==this.na;return this.na=l,i.length!==0||c?{snapshot:new Go(this.query,e.sa,s,i,e.mutatedKeys,l===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),ha:a}:{ha:a}}L_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({sa:this.sa,aa:new YE,mutatedKeys:this.mutatedKeys,Hi:!1},!1)):{ha:[]}}Pa(e){return!this.ta.has(e)&&!!this.sa.has(e)&&!this.sa.get(e).hasLocalMutations}ca(e){e&&(e.addedDocuments.forEach(n=>this.ta=this.ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.ta=this.ta.delete(n)),this.current=e.current)}la(){if(!this.current)return[];const e=this.ra;this.ra=de(),this.sa.forEach(r=>{this.Pa(r.key)&&(this.ra=this.ra.add(r.key))});const n=[];return e.forEach(r=>{this.ra.has(r)||n.push(new ej(r))}),this.ra.forEach(r=>{e.has(r)||n.push(new ZA(r))}),n}Ia(e){this.ta=e._s,this.ra=de();const n=this._a(e.documents);return this.applyChanges(n,!0)}Ta(){return Go.fromInitialDocuments(this.query,this.sa,this.mutatedKeys,this.na===0,this.hasCachedResults)}}class Z8{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class e7{constructor(e){this.key=e,this.Ea=!1}}class t7{constructor(e,n,r,s,i,a){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=a,this.da={},this.Aa=new ml(l=>pA(l),qm),this.Ra=new Map,this.Va=new Set,this.ma=new Je(H.comparator),this.fa=new Map,this.ga=new jw,this.pa={},this.ya=new Map,this.wa=qo.Bn(),this.onlineState="Unknown",this.Sa=void 0}get isPrimaryClient(){return this.Sa===!0}}async function n7(t,e){const n=h7(t);let r,s;const i=n.Aa.get(e);if(i)r=i.targetId,n.sharedClientState.addLocalQueryTarget(r),s=i.view.Ta();else{const a=await T8(n.localStore,Ms(e)),l=n.sharedClientState.addLocalQueryTarget(a.targetId);r=a.targetId,s=await r7(n,e,r,l==="current",a.resumeToken),n.isPrimaryClient&&VA(n.remoteStore,a)}return s}async function r7(t,e,n,r,s){t.ba=(h,m,p)=>async function(y,_,w,x){let v=_.view._a(w);v.Hi&&(v=await GE(y.localStore,_.query,!1).then(({documents:b})=>_.view._a(b,v)));const S=x&&x.targetChanges.get(_.targetId),E=_.view.applyChanges(v,y.isPrimaryClient,S);return ZE(y,_.targetId,E.ha),E.snapshot}(t,h,m,p);const i=await GE(t.localStore,e,!0),a=new J8(e,i._s),l=a._a(i.documents),c=Du.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),u=a.applyChanges(l,t.isPrimaryClient,c);ZE(t,n,u.ha);const d=new Z8(e,n,a);return t.Aa.set(e,d),t.Ra.has(n)?t.Ra.get(n).push(e):t.Ra.set(n,[e]),u.snapshot}async function s7(t,e){const n=ne(t),r=n.Aa.get(e),s=n.Ra.get(r.targetId);if(s.length>1)return n.Ra.set(r.targetId,s.filter(i=>!qm(i,e))),void n.Aa.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||await Dy(n.localStore,r.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(r.targetId),HA(n.remoteStore,r.targetId),Oy(n,r.targetId)}).catch(Nu)):(Oy(n,r.targetId),await Dy(n.localStore,r.targetId,!0))}async function i7(t,e,n){const r=f7(t);try{const s=await function(a,l){const c=ne(a),u=_t.now(),d=l.reduce((p,g)=>p.add(g.key),de());let h,m;return c.persistence.runTransaction("Locally write mutations","readwrite",p=>{let g=Ls(),y=de();return c.ts.getEntries(p,d).next(_=>{g=_,g.forEach((w,x)=>{x.isValidDocument()||(y=y.add(w))})}).next(()=>c.localDocuments.getOverlayedDocuments(p,g)).next(_=>{h=_;const w=[];for(const x of l){const v=NV(x,h.get(x.key).overlayedDocument);v!=null&&w.push(new Bi(x.key,v,oA(v.value.mapValue),En.exists(!0)))}return c.mutationQueue.addMutationBatch(p,u,w,l)}).next(_=>{m=_;const w=_.applyToLocalDocumentSet(h,y);return c.documentOverlayCache.saveOverlays(p,_.batchId,w)})}).then(()=>({batchId:m.batchId,changes:xA(h)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(a,l,c){let u=a.pa[a.currentUser.toKey()];u||(u=new Je(be)),u=u.insert(l,c),a.pa[a.currentUser.toKey()]=u}(r,s.batchId,n),await Mu(r,s.changes),await ep(r.remoteStore)}catch(s){const i=Lw(s,"Failed to persist write");n.reject(i)}}async function tj(t,e){const n=ne(t);try{const r=await E8(n.localStore,e);e.targetChanges.forEach((s,i)=>{const a=n.fa.get(i);a&&(Ue(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?a.Ea=!0:s.modifiedDocuments.size>0?Ue(a.Ea):s.removedDocuments.size>0&&(Ue(a.Ea),a.Ea=!1))}),await Mu(n,r,e)}catch(r){await Nu(r)}}function JE(t,e,n){const r=ne(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Aa.forEach((i,a)=>{const l=a.view.L_(e);l.snapshot&&s.push(l.snapshot)}),function(a,l){const c=ne(a);c.onlineState=l;let u=!1;c.queries.forEach((d,h)=>{for(const m of h.listeners)m.L_(l)&&(u=!0)}),u&&$w(c)}(r.eventManager,e),s.length&&r.da.s_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function a7(t,e,n){const r=ne(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.fa.get(e),i=s&&s.key;if(i){let a=new Je(H.comparator);a=a.insert(i,qt.newNoDocument(i,J.min()));const l=de().add(i),c=new Ym(J.min(),new Map,new Je(be),a,l);await tj(r,c),r.ma=r.ma.remove(i),r.fa.delete(e),zw(r)}else await Dy(r.localStore,e,!1).then(()=>Oy(r,e,n)).catch(Nu)}async function o7(t,e){const n=ne(t),r=e.batch.batchId;try{const s=await S8(n.localStore,e);rj(n,r,null),nj(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Mu(n,s)}catch(s){await Nu(s)}}async function l7(t,e,n){const r=ne(t);try{const s=await function(a,l){const c=ne(a);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let d;return c.mutationQueue.lookupMutationBatch(u,l).next(h=>(Ue(h!==null),d=h.keys(),c.mutationQueue.removeMutationBatch(u,h))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,d,l)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,d)).next(()=>c.localDocuments.getDocuments(u,d))})}(r.localStore,e);rj(r,e,n),nj(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Mu(r,s)}catch(s){await Nu(s)}}function nj(t,e){(t.ya.get(e)||[]).forEach(n=>{n.resolve()}),t.ya.delete(e)}function rj(t,e,n){const r=ne(t);let s=r.pa[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.pa[r.currentUser.toKey()]=s}}function Oy(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ra.get(e))t.Aa.delete(r),n&&t.da.Da(r,n);t.Ra.delete(e),t.isPrimaryClient&&t.ga.Vr(e).forEach(r=>{t.ga.containsKey(r)||sj(t,r)})}function sj(t,e){t.Va.delete(e.path.canonicalString());const n=t.ma.get(e);n!==null&&(HA(t.remoteStore,n),t.ma=t.ma.remove(e),t.fa.delete(n),zw(t))}function ZE(t,e,n){for(const r of n)r instanceof ZA?(t.ga.addReference(r.key,e),c7(t,r)):r instanceof ej?(z("SyncEngine","Document no longer in limbo: "+r.key),t.ga.removeReference(r.key,e),t.ga.containsKey(r.key)||sj(t,r.key)):X()}function c7(t,e){const n=e.key,r=n.path.canonicalString();t.ma.get(n)||t.Va.has(r)||(z("SyncEngine","New document in limbo: "+n),t.Va.add(r),zw(t))}function zw(t){for(;t.Va.size>0&&t.ma.size<t.maxConcurrentLimboResolutions;){const e=t.Va.values().next().value;t.Va.delete(e);const n=new H(ze.fromString(e)),r=t.wa.next();t.fa.set(r,new e7(n)),t.ma=t.ma.insert(n,r),VA(t.remoteStore,new li(Ms(Tw(n.path)),r,"TargetPurposeLimboResolution",ww.ae))}}async function Mu(t,e,n){const r=ne(t),s=[],i=[],a=[];r.Aa.isEmpty()||(r.Aa.forEach((l,c)=>{a.push(r.ba(c,e,n).then(u=>{if((u||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(c.targetId,u!=null&&u.fromCache?"not-current":"current"),u){s.push(u);const d=Pw.Ki(c.targetId,u);i.push(d)}}))}),await Promise.all(a),r.da.s_(s),await async function(c,u){const d=ne(c);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>N.forEach(u,m=>N.forEach(m.qi,p=>d.persistence.referenceDelegate.addReference(h,m.targetId,p)).next(()=>N.forEach(m.Qi,p=>d.persistence.referenceDelegate.removeReference(h,m.targetId,p)))))}catch(h){if(!Pu(h))throw h;z("LocalStore","Failed to update sequence numbers: "+h)}for(const h of u){const m=h.targetId;if(!h.fromCache){const p=d.Zi.get(m),g=p.snapshotVersion,y=p.withLastLimboFreeSnapshotVersion(g);d.Zi=d.Zi.insert(m,y)}}}(r.localStore,i))}async function u7(t,e){const n=ne(t);if(!n.currentUser.isEqual(e)){z("SyncEngine","User change. New user:",e.toKey());const r=await $A(n.localStore,e);n.currentUser=e,function(i,a){i.ya.forEach(l=>{l.forEach(c=>{c.reject(new M(C.CANCELLED,a))})}),i.ya.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Mu(n,r.rs)}}function d7(t,e){const n=ne(t),r=n.fa.get(e);if(r&&r.Ea)return de().add(r.key);{let s=de();const i=n.Ra.get(e);if(!i)return s;for(const a of i){const l=n.Aa.get(a);s=s.unionWith(l.view.oa)}return s}}function h7(t){const e=ne(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=tj.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=d7.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=a7.bind(null,e),e.da.s_=X8.bind(null,e.eventManager),e.da.Da=Y8.bind(null,e.eventManager),e}function f7(t){const e=ne(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=o7.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=l7.bind(null,e),e}class eb{constructor(){this.synchronizeTabs=!1}async initialize(e){this.serializer=Jm(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,n){return null}createIndexBackfillerScheduler(e,n){return null}createLocalStore(e){return _8(this.persistence,new v8,e.initialUser,this.serializer)}createPersistence(e){return new y8(Nw.Hr,this.serializer)}createSharedClientState(e){return new C8}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class m7{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>JE(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=u7.bind(null,this.syncEngine),await G8(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new K8}()}createDatastore(e){const n=Jm(e.databaseInfo.databaseId),r=function(i){return new N8(i)}(e.databaseInfo);return function(i,a,l,c){return new D8(i,a,l,c)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,a,l){return new M8(r,s,i,a,l)}(this.localStore,this.datastore,e.asyncQueue,n=>JE(this.syncEngine,n,0),function(){return KE.v()?new KE:new R8}())}createSyncEngine(e,n){return function(s,i,a,l,c,u,d){const h=new t7(s,i,a,l,c,u);return d&&(h.Sa=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}terminate(){return async function(n){const r=ne(n);z("RemoteStore","RemoteStore shutting down."),r.S_.add(5),await Ou(r),r.D_.shutdown(),r.v_.set("Unknown")}(this.remoteStore)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ij{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Fa(this.observer.next,e)}error(e){this.observer.error?this.Fa(this.observer.error,e):Os("Uncaught Error in snapshot listener:",e.toString())}Ma(){this.muted=!0}Fa(e,n){this.muted||setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p7{constructor(e,n,r,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=Ht.UNAUTHENTICATED,this.clientId=sA.V(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,async i=>{z("FirestoreClient","Received user=",i.uid),await this.authCredentialListener(i),this.user=i}),this.appCheckCredentials.start(r,i=>(z("FirestoreClient","Received new app check token=",i),this.appCheckCredentialListener(i,this.user)))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new M(C.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ts;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Lw(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Ag(t,e){t.asyncQueue.verifyOperationInProgress(),z("FirestoreClient","Initializing OfflineComponentProvider");const n=await t.getConfiguration();await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await $A(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function tb(t,e){t.asyncQueue.verifyOperationInProgress();const n=await y7(t);z("FirestoreClient","Initializing OnlineComponentProvider");const r=await t.getConfiguration();await e.initialize(n,r),t.setCredentialChangeListener(s=>XE(e.remoteStore,s)),t.setAppCheckTokenChangeListener((s,i)=>XE(e.remoteStore,i)),t._onlineComponents=e}function g7(t){return t.name==="FirebaseError"?t.code===C.FAILED_PRECONDITION||t.code===C.UNIMPLEMENTED:!(typeof DOMException<"u"&&t instanceof DOMException)||t.code===22||t.code===20||t.code===11}async function y7(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){z("FirestoreClient","Using user provided OfflineComponentProvider");try{await Ag(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!g7(n))throw n;Uo("Error using user provided cache. Falling back to memory cache: "+n),await Ag(t,new eb)}}else z("FirestoreClient","Using default OfflineComponentProvider"),await Ag(t,new eb);return t._offlineComponents}async function aj(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(z("FirestoreClient","Using user provided OnlineComponentProvider"),await tb(t,t._uninitializedComponentsProvider._online)):(z("FirestoreClient","Using default OnlineComponentProvider"),await tb(t,new m7))),t._onlineComponents}function x7(t){return aj(t).then(e=>e.syncEngine)}async function oj(t){const e=await aj(t),n=e.eventManager;return n.onListen=n7.bind(null,e.syncEngine),n.onUnlisten=s7.bind(null,e.syncEngine),n}function v7(t,e,n={}){const r=new Ts;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,l,c,u){const d=new ij({next:m=>{a.enqueueAndForget(()=>YA(i,h));const p=m.docs.has(l);!p&&m.fromCache?u.reject(new M(C.UNAVAILABLE,"Failed to get document because the client is offline.")):p&&m.fromCache&&c&&c.source==="server"?u.reject(new M(C.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(m)},error:m=>u.reject(m)}),h=new JA(Tw(l.path),d,{includeMetadataChanges:!0,z_:!0});return XA(i,h)}(await oj(t),t.asyncQueue,e,n,r)),r.promise}function w7(t,e,n={}){const r=new Ts;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,l,c,u){const d=new ij({next:m=>{a.enqueueAndForget(()=>YA(i,h)),m.fromCache&&c.source==="server"?u.reject(new M(C.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(m)},error:m=>u.reject(m)}),h=new JA(l,d,{includeMetadataChanges:!0,z_:!0});return XA(i,h)}(await oj(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lj(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nb=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cj(t,e,n){if(!n)throw new M(C.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function _7(t,e,n,r){if(e===!0&&r===!0)throw new M(C.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function rb(t){if(!H.isDocumentKey(t))throw new M(C.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function sb(t){if(H.isDocumentKey(t))throw new M(C.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function tp(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":X()}function ns(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new M(C.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=tp(t);throw new M(C.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function S7(t,e){if(e<=0)throw new M(C.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ib{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new M(C.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new M(C.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}_7("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=lj((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new M(C.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new M(C.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new M(C.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class np{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new ib({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new M(C.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new M(C.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new ib(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new HU;switch(r.type){case"firstParty":return new QU(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new M(C.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=nb.get(n);r&&(z("ComponentProvider","Removing Datastore"),nb.delete(n),r.terminate())}(this),Promise.resolve()}}function E7(t,e,n,r={}){var s;const i=(t=ns(t,np))._getSettings(),a=`${e}:${n}`;if(i.host!=="firestore.googleapis.com"&&i.host!==a&&Uo("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},i),{host:a,ssl:!1})),r.mockUserToken){let l,c;if(typeof r.mockUserToken=="string")l=r.mockUserToken,c=Ht.MOCK_USER;else{l=gC(r.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new M(C.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Ht(u)}t._authCredentials=new WU(new rA(l,c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ui{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Ui(this.firestore,e,this._query)}}class bn{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Si(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new bn(this.firestore,e,this._key)}}class Si extends Ui{constructor(e,n,r){super(e,n,Tw(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new bn(this.firestore,null,new H(e))}withConverter(e){return new Si(this.firestore,e,this._path)}}function rs(t,e,...n){if(t=qe(t),cj("collection","path",e),t instanceof np){const r=ze.fromString(e,...n);return sb(r),new Si(t,null,r)}{if(!(t instanceof bn||t instanceof Si))throw new M(C.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ze.fromString(e,...n));return sb(r),new Si(t.firestore,null,r)}}function Jt(t,e,...n){if(t=qe(t),arguments.length===1&&(e=sA.V()),cj("doc","path",e),t instanceof np){const r=ze.fromString(e,...n);return rb(r),new bn(t,null,new H(r))}{if(!(t instanceof bn||t instanceof Si))throw new M(C.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ze.fromString(e,...n));return rb(r),new bn(t.firestore,t instanceof Si?t.converter:null,new H(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b7{constructor(){this.za=Promise.resolve(),this.ja=[],this.Ha=!1,this.Ja=[],this.Ya=null,this.Za=!1,this.Xa=!1,this.eu=[],this.Uo=new BA(this,"async_queue_retry"),this.tu=()=>{const n=Rg();n&&z("AsyncQueue","Visibility state changed to "+n.visibilityState),this.Uo.Lo()};const e=Rg();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.tu)}get isShuttingDown(){return this.Ha}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.nu(),this.ru(e)}enterRestrictedMode(e){if(!this.Ha){this.Ha=!0,this.Xa=e||!1;const n=Rg();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.tu)}}enqueue(e){if(this.nu(),this.Ha)return new Promise(()=>{});const n=new Ts;return this.ru(()=>this.Ha&&this.Xa?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.ja.push(e),this.iu()))}async iu(){if(this.ja.length!==0){try{await this.ja[0](),this.ja.shift(),this.Uo.reset()}catch(e){if(!Pu(e))throw e;z("AsyncQueue","Operation failed with retryable error: "+e)}this.ja.length>0&&this.Uo.No(()=>this.iu())}}ru(e){const n=this.za.then(()=>(this.Za=!0,e().catch(r=>{this.Ya=r,this.Za=!1;const s=function(a){let l=a.message||"";return a.stack&&(l=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),l}(r);throw Os("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.Za=!1,r))));return this.za=n,n}enqueueAfterDelay(e,n,r){this.nu(),this.eu.indexOf(e)>-1&&(n=0);const s=Mw.createAndSchedule(this,e,n,r,i=>this.su(i));return this.Ja.push(s),s}nu(){this.Ya&&X()}verifyOperationInProgress(){}async ou(){let e;do e=this.za,await e;while(e!==this.za)}_u(e){for(const n of this.Ja)if(n.timerId===e)return!0;return!1}au(e){return this.ou().then(()=>{this.Ja.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Ja)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.ou()})}uu(e){this.eu.push(e)}su(e){const n=this.Ja.indexOf(e);this.Ja.splice(n,1)}}class Ba extends np{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=function(){return new b7}(),this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||uj(this),this._firestoreClient.terminate()}}function k7(t,e){const n=typeof t=="object"?t:Bv(),r=typeof t=="string"?t:e||"(default)",s=Em(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=fC("firestore");i&&E7(s,...i)}return s}function rp(t){return t._firestoreClient||uj(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function uj(t){var e,n,r;const s=t._freezeSettings(),i=function(l,c,u,d){return new aV(l,c,u,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,lj(d.experimentalLongPollingOptions),d.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._firestoreClient=new p7(t._authCredentials,t._appCheckCredentials,t._queue,i),!((n=s.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:s.localCache.kind,_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qo{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Qo(tn.fromBase64String(e))}catch(n){throw new M(C.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Qo(tn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gl{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new M(C.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Gt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}function Bs(){return new gl("__name__")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lu{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bw{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new M(C.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new M(C.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return be(this._lat,e._lat)||be(this._long,e._long)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T7=/^__.*__$/;class I7{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Bi(e,this.data,this.fieldMask,n,this.fieldTransforms):new Fu(e,this.data,n,this.fieldTransforms)}}class dj{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Bi(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function hj(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw X()}}class Uw{constructor(e,n,r,s,i,a){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.cu(),this.fieldTransforms=i||[],this.fieldMask=a||[]}get path(){return this.settings.path}get lu(){return this.settings.lu}hu(e){return new Uw(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Pu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.hu({path:r,Iu:!1});return s.Tu(e),s}Eu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.hu({path:r,Iu:!1});return s.cu(),s}du(e){return this.hu({path:void 0,Iu:!0})}Au(e){return af(e,this.settings.methodName,this.settings.Ru||!1,this.path,this.settings.Vu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}cu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Tu(this.path.get(e))}Tu(e){if(e.length===0)throw this.Au("Document fields must not be empty");if(hj(this.lu)&&T7.test(e))throw this.Au('Document fields cannot begin and end with "__"')}}class C7{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Jm(e)}mu(e,n,r,s=!1){return new Uw({lu:e,methodName:n,Vu:r,path:Gt.emptyPath(),Iu:!1,Ru:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function sp(t){const e=t._freezeSettings(),n=Jm(t._databaseId);return new C7(t._databaseId,!!e.ignoreUndefinedProperties,n)}function fj(t,e,n,r,s,i={}){const a=t.mu(i.merge||i.mergeFields?2:0,e,n,s);Hw("Data must be an object, but it was:",a,r);const l=gj(r,a);let c,u;if(i.merge)c=new Dn(a.fieldMask),u=a.fieldTransforms;else if(i.mergeFields){const d=[];for(const h of i.mergeFields){const m=My(e,h,n);if(!a.contains(m))throw new M(C.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);xj(d,m)||d.push(m)}c=new Dn(d),u=a.fieldTransforms.filter(h=>c.covers(h.field))}else c=null,u=a.fieldTransforms;return new I7(new xn(l),c,u)}class ip extends Lu{_toFieldTransform(e){if(e.lu!==2)throw e.lu===1?e.Au(`${this._methodName}() can only appear at the top level of your update data`):e.Au(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof ip}}class Vw extends Lu{_toFieldTransform(e){return new IA(e.path,new Jc)}isEqual(e){return e instanceof Vw}}class R7 extends Lu{constructor(e,n){super(e),this.gu=n}_toFieldTransform(e){const n=new tu(e.serializer,SA(e.serializer,this.gu));return new IA(e.path,n)}isEqual(e){return this===e}}function mj(t,e,n,r){const s=t.mu(1,e,n);Hw("Data must be an object, but it was:",s,r);const i=[],a=xn.empty();$a(r,(c,u)=>{const d=Ww(e,c,n);u=qe(u);const h=s.Eu(d);if(u instanceof ip)i.push(d);else{const m=$u(u,h);m!=null&&(i.push(d),a.set(d,m))}});const l=new Dn(i);return new dj(a,l,s.fieldTransforms)}function pj(t,e,n,r,s,i){const a=t.mu(1,e,n),l=[My(e,r,n)],c=[s];if(i.length%2!=0)throw new M(C.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<i.length;m+=2)l.push(My(e,i[m])),c.push(i[m+1]);const u=[],d=xn.empty();for(let m=l.length-1;m>=0;--m)if(!xj(u,l[m])){const p=l[m];let g=c[m];g=qe(g);const y=a.Eu(p);if(g instanceof ip)u.push(p);else{const _=$u(g,y);_!=null&&(u.push(p),d.set(p,_))}}const h=new Dn(u);return new dj(d,h,a.fieldTransforms)}function A7(t,e,n,r=!1){return $u(n,t.mu(r?4:3,e))}function $u(t,e){if(yj(t=qe(t)))return Hw("Unsupported field value:",e,t),gj(t,e);if(t instanceof Lu)return function(r,s){if(!hj(s.lu))throw s.Au(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Au(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Iu&&e.lu!==4)throw e.Au("Nested arrays are not supported");return function(r,s){const i=[];let a=0;for(const l of r){let c=$u(l,s.du(a));c==null&&(c={nullValue:"NULL_VALUE"}),i.push(c),a++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=qe(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return SA(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=_t.fromDate(r);return{timestampValue:rf(s.serializer,i)}}if(r instanceof _t){const i=new _t(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:rf(s.serializer,i)}}if(r instanceof Bw)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Qo)return{bytesValue:PA(s.serializer,r._byteString)};if(r instanceof bn){const i=s.databaseId,a=r.firestore._databaseId;if(!a.isEqual(i))throw s.Au(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Aw(r.firestore._databaseId||s.databaseId,r._key.path)}}throw s.Au(`Unsupported field value: ${tp(r)}`)}(t,e)}function gj(t,e){const n={};return iA(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):$a(t,(r,s)=>{const i=$u(s,e.Pu(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function yj(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof _t||t instanceof Bw||t instanceof Qo||t instanceof bn||t instanceof Lu)}function Hw(t,e,n){if(!yj(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){const r=tp(n);throw r==="an object"?e.Au(t+" a custom object"):e.Au(t+" "+r)}}function My(t,e,n){if((e=qe(e))instanceof gl)return e._internalPath;if(typeof e=="string")return Ww(t,e);throw af("Field path arguments must be of type string or ",t,!1,void 0,n)}const j7=new RegExp("[~\\*/\\[\\]]");function Ww(t,e,n){if(e.search(j7)>=0)throw af(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new gl(...e.split("."))._internalPath}catch{throw af(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function af(t,e,n,r,s){const i=r&&!r.isEmpty(),a=s!==void 0;let l=`Function ${e}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let c="";return(i||a)&&(c+=" (found",i&&(c+=` in field ${r}`),a&&(c+=` in document ${s}`),c+=")"),new M(C.INVALID_ARGUMENT,l+t+c)}function xj(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vj{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new bn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new N7(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(ap("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class N7 extends vj{data(){return super.data()}}function ap(t,e){return typeof e=="string"?Ww(t,e):e instanceof gl?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P7(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new M(C.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class qw{}class Gw extends qw{}function _e(t,e,...n){let r=[];e instanceof qw&&r.push(e),r=r.concat(n),function(i){const a=i.filter(c=>c instanceof Qw).length,l=i.filter(c=>c instanceof op).length;if(a>1||a>0&&l>0)throw new M(C.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class op extends Gw{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new op(e,n,r)}_apply(e){const n=this._parse(e);return wj(e._query,n),new Ui(e.firestore,e.converter,Ry(e._query,n))}_parse(e){const n=sp(e.firestore);return function(i,a,l,c,u,d,h){let m;if(u.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new M(C.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){ob(h,d);const p=[];for(const g of h)p.push(ab(c,i,g));m={arrayValue:{values:p}}}else m=ab(c,i,h)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||ob(h,d),m=A7(l,a,h,d==="in"||d==="not-in");return gt.create(u,d,m)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function V(t,e,n){const r=e,s=ap("where",t);return op._create(s,r,n)}class Qw extends qw{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Qw(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Ar.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let a=s;const l=i.getFlattenedFilters();for(const c of l)wj(a,c),a=Ry(a,c)}(e._query,n),new Ui(e.firestore,e.converter,Ry(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Kw extends Gw{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new Kw(e,n)}_apply(e){const n=function(s,i,a){if(s.startAt!==null)throw new M(C.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new M(C.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const l=new Co(i,a);return function(u,d){if(Iw(u)===null){const h=Wm(u);h!==null&&_j(u,h,d.field)}}(s,l),l}(e._query,this._field,this._direction);return new Ui(e.firestore,e.converter,function(s,i){const a=s.explicitOrderBy.concat([i]);return new fl(s.path,s.collectionGroup,a,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,n))}}function Ni(t,e="asc"){const n=e,r=ap("orderBy",t);return Kw._create(r,n)}class Xw extends Gw{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new Xw(e,n,r)}_apply(e){return new Ui(e.firestore,e.converter,nf(e._query,this._limit,this._limitType))}}function nu(t){return S7("limit",t),Xw._create("limit",t,"F")}function ab(t,e,n){if(typeof(n=qe(n))=="string"){if(n==="")throw new M(C.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!mA(e)&&n.indexOf("/")!==-1)throw new M(C.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(ze.fromString(n));if(!H.isDocumentKey(r))throw new M(C.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return AE(t,new H(r))}if(n instanceof bn)return AE(t,n._key);throw new M(C.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${tp(n)}.`)}function ob(t,e){if(!Array.isArray(t)||t.length===0)throw new M(C.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function wj(t,e){if(e.isInequality()){const r=Wm(t),s=e.field;if(r!==null&&!r.isEqual(s))throw new M(C.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${r.toString()}' and '${s.toString()}'`);const i=Iw(t);i!==null&&_j(t,s,i)}const n=function(s,i){for(const a of s)for(const l of a.getFlattenedFilters())if(i.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new M(C.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new M(C.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}function _j(t,e,n){if(!n.isEqual(e))throw new M(C.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${n.toString()}' instead.`)}class F7{convertValue(e,n="none"){switch(ka(e)){case 0:return null;case 1:return e.booleanValue;case 2:return mt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(ba(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw X()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return $a(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertGeoPoint(e){return new Bw(mt(e.latitude),mt(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=Sw(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Kc(e));default:return null}}convertTimestamp(e){const n=Ai(e);return new _t(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=ze.fromString(e);Ue(LA(r));const s=new Xc(r.get(1),r.get(3)),i=new H(r.popFirst(5));return s.isEqual(n)||Os(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sj(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ql{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Ej extends vj{constructor(e,n,r,s,i,a){super(e,n,r,s,a),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new rh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(ap("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class rh extends Ej{data(e={}){return super.data(e)}}class D7{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new Ql(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new rh(this._firestore,this._userDataWriter,r.key,r,new Ql(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new M(C.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let a=0;return s._snapshot.docChanges.map(l=>{const c=new rh(s._firestore,s._userDataWriter,l.doc.key,l.doc,new Ql(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);return l.doc,{type:"added",doc:c,oldIndex:-1,newIndex:a++}})}{let a=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(l=>i||l.type!==3).map(l=>{const c=new rh(s._firestore,s._userDataWriter,l.doc.key,l.doc,new Ql(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);let u=-1,d=-1;return l.type!==0&&(u=a.indexOf(l.doc.key),a=a.delete(l.doc.key)),l.type!==1&&(a=a.add(l.doc),d=a.indexOf(l.doc.key)),{type:O7(l.type),doc:c,oldIndex:u,newIndex:d}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function O7(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return X()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zu(t){t=ns(t,bn);const e=ns(t.firestore,Ba);return v7(rp(e),t._key).then(n=>z7(e,t,n))}class bj extends F7{constructor(e){super(),this.firestore=e}convertBytes(e){return new Qo(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new bn(this.firestore,null,n)}}function yl(t){t=ns(t,Ui);const e=ns(t.firestore,Ba),n=rp(e),r=new bj(e);return P7(t._query),w7(n,t._query).then(s=>new D7(e,r,t,s))}function M7(t,e,n,...r){t=ns(t,bn);const s=ns(t.firestore,Ba),i=sp(s);let a;return a=typeof(e=qe(e))=="string"||e instanceof gl?pj(i,"updateDoc",t._key,e,n,r):mj(i,"updateDoc",t._key,e),lp(s,[a.toMutation(t._key,En.exists(!0))])}function L7(t){return lp(ns(t.firestore,Ba),[new Xm(t._key,En.none())])}function $7(t,e){const n=ns(t.firestore,Ba),r=Jt(t),s=Sj(t.converter,e);return lp(n,[fj(sp(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,En.exists(!1))]).then(()=>r)}function lp(t,e){return function(r,s){const i=new Ts;return r.asyncQueue.enqueueAndForget(async()=>i7(await x7(r),s,i)),i.promise}(rp(t),e)}function z7(t,e,n){const r=n.docs.get(e._key),s=new bj(t);return new Ej(t,s,e._key,r,new Ql(n.hasPendingWrites,n.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B7{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=sp(e)}set(e,n,r){this._verifyNotCommitted();const s=jg(e,this._firestore),i=Sj(s.converter,n,r),a=fj(this._dataReader,"WriteBatch.set",s._key,i,s.converter!==null,r);return this._mutations.push(a.toMutation(s._key,En.none())),this}update(e,n,r,...s){this._verifyNotCommitted();const i=jg(e,this._firestore);let a;return a=typeof(n=qe(n))=="string"||n instanceof gl?pj(this._dataReader,"WriteBatch.update",i._key,n,r,s):mj(this._dataReader,"WriteBatch.update",i._key,n),this._mutations.push(a.toMutation(i._key,En.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=jg(e,this._firestore);return this._mutations=this._mutations.concat(new Xm(n._key,En.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new M(C.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function jg(t,e){if((t=qe(t)).firestore!==e)throw new M(C.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}function Ko(){return new Vw("serverTimestamp")}function Yw(t){return new R7("increment",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bu(t){return rp(t=ns(t,Ba)),new B7(t,e=>lp(t,e))}(function(e,n=!0){(function(s){hl=s})(Ma),_a(new Ci("firestore",(r,{instanceIdentifier:s,options:i})=>{const a=r.getProvider("app").getImmediate(),l=new Ba(new qU(r.getProvider("auth-internal")),new XU(r.getProvider("app-check-internal")),function(u,d){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new M(C.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Xc(u.options.projectId,d)}(a,s),a);return i=Object.assign({useFetchStreams:n},i),l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),Xr(kE,"4.1.2",e),Xr(kE,"4.1.2","esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kj="firebasestorage.googleapis.com",Tj="storageBucket",U7=2*60*1e3,V7=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class st extends ds{constructor(e,n,r=0){super(Ng(e),`Firebase Storage: ${n} (${Ng(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,st.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Ng(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var rt;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(rt||(rt={}));function Ng(t){return"storage/"+t}function Jw(){const t="An unknown error occurred, please check the error payload for server response.";return new st(rt.UNKNOWN,t)}function H7(t){return new st(rt.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function W7(t){return new st(rt.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function q7(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new st(rt.UNAUTHENTICATED,t)}function G7(){return new st(rt.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function Q7(t){return new st(rt.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function K7(){return new st(rt.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function X7(){return new st(rt.CANCELED,"User canceled the upload/download.")}function Y7(t){return new st(rt.INVALID_URL,"Invalid URL '"+t+"'.")}function J7(t){return new st(rt.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function Z7(){return new st(rt.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+Tj+"' property when initializing the app?")}function eH(){return new st(rt.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function tH(){return new st(rt.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function nH(t){return new st(rt.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Ly(t){return new st(rt.INVALID_ARGUMENT,t)}function Ij(){return new st(rt.APP_DELETED,"The Firebase app was deleted.")}function rH(t){return new st(rt.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function uc(t,e){return new st(rt.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function Fl(t){throw new st(rt.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class On{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=On.makeFromUrl(e,n)}catch{return new On(e,"")}if(r.path==="")return r;throw J7(e)}static makeFromUrl(e,n){let r=null;const s="([A-Za-z0-9.\\-_]+)";function i(S){S.path.charAt(S.path.length-1)==="/"&&(S.path_=S.path_.slice(0,-1))}const a="(/(.*))?$",l=new RegExp("^gs://"+s+a,"i"),c={bucket:1,path:3};function u(S){S.path_=decodeURIComponent(S.path)}const d="v[A-Za-z0-9_]+",h=n.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",p=new RegExp(`^https?://${h}/${d}/b/${s}/o${m}`,"i"),g={bucket:1,path:3},y=n===kj?"(?:storage.googleapis.com|storage.cloud.google.com)":n,_="([^?#]*)",w=new RegExp(`^https?://${y}/${s}/${_}`,"i"),v=[{regex:l,indices:c,postModify:i},{regex:p,indices:g,postModify:u},{regex:w,indices:{bucket:1,path:2},postModify:u}];for(let S=0;S<v.length;S++){const E=v[S],b=E.regex.exec(e);if(b){const I=b[E.indices.bucket];let A=b[E.indices.path];A||(A=""),r=new On(I,A),E.postModify(r);break}}if(r==null)throw Y7(e);return r}}class sH{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iH(t,e,n){let r=1,s=null,i=null,a=!1,l=0;function c(){return l===2}let u=!1;function d(..._){u||(u=!0,e.apply(null,_))}function h(_){s=setTimeout(()=>{s=null,t(p,c())},_)}function m(){i&&clearTimeout(i)}function p(_,...w){if(u){m();return}if(_){m(),d.call(null,_,...w);return}if(c()||a){m(),d.call(null,_,...w);return}r<64&&(r*=2);let v;l===1?(l=2,v=0):v=(r+Math.random())*1e3,h(v)}let g=!1;function y(_){g||(g=!0,m(),!u&&(s!==null?(_||(l=2),clearTimeout(s),h(0)):_||(l=1)))}return h(0),i=setTimeout(()=>{a=!0,y(!0)},n),y}function aH(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oH(t){return t!==void 0}function lH(t){return typeof t=="object"&&!Array.isArray(t)}function Zw(t){return typeof t=="string"||t instanceof String}function lb(t){return e1()&&t instanceof Blob}function e1(){return typeof Blob<"u"&&!f$()}function cb(t,e,n,r){if(r<e)throw Ly(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw Ly(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cp(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function Cj(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const s=e(r)+"="+e(t[r]);n=n+s+"&"}return n=n.slice(0,-1),n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var fa;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(fa||(fa={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cH(t,e){const n=t>=500&&t<600,s=[408,429].indexOf(t)!==-1,i=e.indexOf(t)!==-1;return n||s||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uH{constructor(e,n,r,s,i,a,l,c,u,d,h,m=!0){this.url_=e,this.method_=n,this.headers_=r,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=a,this.callback_=l,this.errorCallback_=c,this.timeout_=u,this.progressCallback_=d,this.connectionFactory_=h,this.retry=m,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((p,g)=>{this.resolve_=p,this.reject_=g,this.start_()})}start_(){const e=(r,s)=>{if(s){r(!1,new _d(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const a=l=>{const c=l.loaded,u=l.lengthComputable?l.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,u)};this.progressCallback_!==null&&i.addUploadProgressListener(a),i.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(a),this.pendingConnection_=null;const l=i.getErrorCode()===fa.NO_ERROR,c=i.getStatus();if(!l||cH(c,this.additionalRetryCodes_)&&this.retry){const d=i.getErrorCode()===fa.ABORT;r(!1,new _d(!1,null,d));return}const u=this.successCodes_.indexOf(c)!==-1;r(!0,new _d(u,i))})},n=(r,s)=>{const i=this.resolve_,a=this.reject_,l=s.connection;if(s.wasSuccessCode)try{const c=this.callback_(l,l.getResponse());oH(c)?i(c):i()}catch(c){a(c)}else if(l!==null){const c=Jw();c.serverResponse=l.getErrorText(),this.errorCallback_?a(this.errorCallback_(l,c)):a(c)}else if(s.canceled){const c=this.appDelete_?Ij():X7();a(c)}else{const c=K7();a(c)}};this.canceled_?n(!1,new _d(!1,null,!0)):this.backoffId_=iH(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&aH(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class _d{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function dH(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function hH(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function fH(t,e){e&&(t["X-Firebase-GMPID"]=e)}function mH(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function pH(t,e,n,r,s,i,a=!0){const l=Cj(t.urlParams),c=t.url+l,u=Object.assign({},t.headers);return fH(u,e),dH(u,n),hH(u,i),mH(u,r),new uH(c,t.method,u,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gH(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function yH(...t){const e=gH();if(e!==void 0){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(e1())return new Blob(t);throw new st(rt.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function xH(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vH(t){if(typeof atob>"u")throw nH("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wr={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Pg{constructor(e,n){this.data=e,this.contentType=n||null}}function wH(t,e){switch(t){case Wr.RAW:return new Pg(Rj(e));case Wr.BASE64:case Wr.BASE64URL:return new Pg(Aj(t,e));case Wr.DATA_URL:return new Pg(SH(e),EH(e))}throw Jw()}function Rj(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const i=r,a=t.charCodeAt(++n);r=65536|(i&1023)<<10|a&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function _H(t){let e;try{e=decodeURIComponent(t)}catch{throw uc(Wr.DATA_URL,"Malformed data URL.")}return Rj(e)}function Aj(t,e){switch(t){case Wr.BASE64:{const s=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(s||i)throw uc(t,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case Wr.BASE64URL:{const s=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(s||i)throw uc(t,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=vH(e)}catch(s){throw s.message.includes("polyfill")?s:uc(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}class jj{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw uc(Wr.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=bH(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function SH(t){const e=new jj(t);return e.base64?Aj(Wr.BASE64,e.rest):_H(e.rest)}function EH(t){return new jj(t).contentType}function bH(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ri{constructor(e,n){let r=0,s="";lb(e)?(this.data_=e,r=e.size,s=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=s}size(){return this.size_}type(){return this.type_}slice(e,n){if(lb(this.data_)){const r=this.data_,s=xH(r,e,n);return s===null?null:new ri(s)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new ri(r,!0)}}static getBlob(...e){if(e1()){const n=e.map(r=>r instanceof ri?r.data_:r);return new ri(yH.apply(null,n))}else{const n=e.map(a=>Zw(a)?wH(Wr.RAW,a).data:a.data_);let r=0;n.forEach(a=>{r+=a.byteLength});const s=new Uint8Array(r);let i=0;return n.forEach(a=>{for(let l=0;l<a.length;l++)s[i++]=a[l]}),new ri(s,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nj(t){let e;try{e=JSON.parse(t)}catch{return null}return lH(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kH(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function TH(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function Pj(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IH(t,e){return e}class sn{constructor(e,n,r,s){this.server=e,this.local=n||e,this.writable=!!r,this.xform=s||IH}}let Sd=null;function CH(t){return!Zw(t)||t.length<2?t:Pj(t)}function Fj(){if(Sd)return Sd;const t=[];t.push(new sn("bucket")),t.push(new sn("generation")),t.push(new sn("metageneration")),t.push(new sn("name","fullPath",!0));function e(i,a){return CH(a)}const n=new sn("name");n.xform=e,t.push(n);function r(i,a){return a!==void 0?Number(a):a}const s=new sn("size");return s.xform=r,t.push(s),t.push(new sn("timeCreated")),t.push(new sn("updated")),t.push(new sn("md5Hash",null,!0)),t.push(new sn("cacheControl",null,!0)),t.push(new sn("contentDisposition",null,!0)),t.push(new sn("contentEncoding",null,!0)),t.push(new sn("contentLanguage",null,!0)),t.push(new sn("contentType",null,!0)),t.push(new sn("metadata","customMetadata",!0)),Sd=t,Sd}function RH(t,e){function n(){const r=t.bucket,s=t.fullPath,i=new On(r,s);return e._makeStorageReference(i)}Object.defineProperty(t,"ref",{get:n})}function AH(t,e,n){const r={};r.type="file";const s=n.length;for(let i=0;i<s;i++){const a=n[i];r[a.local]=a.xform(r,e[a.server])}return RH(r,t),r}function Dj(t,e,n){const r=Nj(e);return r===null?null:AH(t,r,n)}function jH(t,e,n,r){const s=Nj(e);if(s===null||!Zw(s.downloadTokens))return null;const i=s.downloadTokens;if(i.length===0)return null;const a=encodeURIComponent;return i.split(",").map(u=>{const d=t.bucket,h=t.fullPath,m="/b/"+a(d)+"/o/"+a(h),p=cp(m,n,r),g=Cj({alt:"media",token:u});return p+g})[0]}function NH(t,e){const n={},r=e.length;for(let s=0;s<r;s++){const i=e[s];i.writable&&(n[i.server]=t[i.local])}return JSON.stringify(n)}class t1{constructor(e,n,r,s){this.url=e,this.method=n,this.handler=r,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oj(t){if(!t)throw Jw()}function PH(t,e){function n(r,s){const i=Dj(t,s,e);return Oj(i!==null),i}return n}function FH(t,e){function n(r,s){const i=Dj(t,s,e);return Oj(i!==null),jH(i,s,t.host,t._protocol)}return n}function Mj(t){function e(n,r){let s;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?s=G7():s=q7():n.getStatus()===402?s=W7(t.bucket):n.getStatus()===403?s=Q7(t.path):s=r,s.status=n.getStatus(),s.serverResponse=r.serverResponse,s}return e}function Lj(t){const e=Mj(t);function n(r,s){let i=e(r,s);return r.getStatus()===404&&(i=H7(t.path)),i.serverResponse=s.serverResponse,i}return n}function DH(t,e,n){const r=e.fullServerUrl(),s=cp(r,t.host,t._protocol),i="GET",a=t.maxOperationRetryTime,l=new t1(s,i,FH(t,n),a);return l.errorHandler=Lj(e),l}function OH(t,e){const n=e.fullServerUrl(),r=cp(n,t.host,t._protocol),s="DELETE",i=t.maxOperationRetryTime;function a(c,u){}const l=new t1(r,s,a,i);return l.successCodes=[200,204],l.errorHandler=Lj(e),l}function MH(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function LH(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=MH(null,e)),r}function $H(t,e,n,r,s){const i=e.bucketOnlyServerUrl(),a={"X-Goog-Upload-Protocol":"multipart"};function l(){let v="";for(let S=0;S<2;S++)v=v+Math.random().toString().slice(2);return v}const c=l();a["Content-Type"]="multipart/related; boundary="+c;const u=LH(e,r,s),d=NH(u,n),h="--"+c+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+d+`\r
--`+c+`\r
Content-Type: `+u.contentType+`\r
\r
`,m=`\r
--`+c+"--",p=ri.getBlob(h,r,m);if(p===null)throw eH();const g={name:u.fullPath},y=cp(i,t.host,t._protocol),_="POST",w=t.maxUploadRetryTime,x=new t1(y,_,PH(t,n),w);return x.urlParams=g,x.headers=a,x.body=p.uploadData(),x.errorHandler=Mj(e),x}class zH{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=fa.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=fa.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=fa.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,s){if(this.sent_)throw Fl("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(n,e,!0),s!==void 0)for(const i in s)s.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,s[i].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Fl("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Fl("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Fl("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Fl("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class BH extends zH{initXhr(){this.xhr_.responseType="text"}}function n1(){return new BH}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ta{constructor(e,n){this._service=e,n instanceof On?this._location=n:this._location=On.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new Ta(e,n)}get root(){const e=new On(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Pj(this._location.path)}get storage(){return this._service}get parent(){const e=kH(this._location.path);if(e===null)return null;const n=new On(this._location.bucket,e);return new Ta(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw rH(e)}}function UH(t,e,n){t._throwIfRoot("uploadBytes");const r=$H(t.storage,t._location,Fj(),new ri(e,!0),n);return t.storage.makeRequestWithTokens(r,n1).then(s=>({metadata:s,ref:t}))}function VH(t){t._throwIfRoot("getDownloadURL");const e=DH(t.storage,t._location,Fj());return t.storage.makeRequestWithTokens(e,n1).then(n=>{if(n===null)throw tH();return n})}function HH(t){t._throwIfRoot("deleteObject");const e=OH(t.storage,t._location);return t.storage.makeRequestWithTokens(e,n1)}function WH(t,e){const n=TH(t._location.path,e),r=new On(t._location.bucket,n);return new Ta(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qH(t){return/^[A-Za-z]+:\/\//.test(t)}function GH(t,e){return new Ta(t,e)}function $j(t,e){if(t instanceof r1){const n=t;if(n._bucket==null)throw Z7();const r=new Ta(n,n._bucket);return e!=null?$j(r,e):r}else return e!==void 0?WH(t,e):t}function QH(t,e){if(e&&qH(e)){if(t instanceof r1)return GH(t,e);throw Ly("To use ref(service, url), the first argument must be a Storage instance.")}else return $j(t,e)}function ub(t,e){const n=e==null?void 0:e[Tj];return n==null?null:On.makeFromBucketSpec(n,t)}function KH(t,e,n,r={}){t.host=`${e}:${n}`,t._protocol="http";const{mockUserToken:s}=r;s&&(t._overrideAuthToken=typeof s=="string"?s:gC(s,t.app.options.projectId))}class r1{constructor(e,n,r,s,i){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=s,this._firebaseVersion=i,this._bucket=null,this._host=kj,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=U7,this._maxUploadRetryTime=V7,this._requests=new Set,s!=null?this._bucket=On.makeFromBucketSpec(s,this._host):this._bucket=ub(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=On.makeFromBucketSpec(this._url,e):this._bucket=ub(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){cb("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){cb("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Ta(this,e)}_makeRequest(e,n,r,s,i=!0){if(this._deleted)return new sH(Ij());{const a=pH(e,this._appId,r,s,n,this._firebaseVersion,i);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}async makeRequestWithTokens(e,n){const[r,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,s).getPromise()}}const db="@firebase/storage",hb="0.11.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zj="storage";function Bj(t,e,n){return t=qe(t),UH(t,e,n)}function Uj(t){return t=qe(t),VH(t)}function XH(t){return t=qe(t),HH(t)}function s1(t,e){return t=qe(t),QH(t,e)}function YH(t=Bv(),e){t=qe(t);const r=Em(t,zj).getImmediate({identifier:e}),s=fC("storage");return s&&JH(r,...s),r}function JH(t,e,n,r={}){KH(t,e,n,r)}function ZH(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new r1(n,r,s,e,Ma)}function eW(){_a(new Ci(zj,ZH,"PUBLIC").setMultipleInstances(!0)),Xr(db,hb,""),Xr(db,hb,"esm2017")}eW();const i1=vC({apiKey:"AIzaSyBPNpckpYiu009eSzHz_1YMlwHLtScgVjE",appId:"1:938280289868:web:1b426fc2dba5d03dde96e9",projectId:"zingmp3-clone-61799",storageBucket:"zingmp3-clone-61799.appspot.com",authDomain:"zingmp3-clone-61799.firebaseapp.com",messagingSenderId:"938280289868"}),Ie=k7(i1),Ia=jB(i1),tW=new ys,a1=YH(i1),nW="/HD-MP3/assets/user-default-971f59df.png";function $y({className:t}){const[e]=Xv(Ia),n={imageFrame:`${t||"w-[35px] h-[35px]"} flex-shrink-0 rounded-full overflow-hidden ${e!=null&&e.photoURL?"":"flex items-center justify-center bg-[#ccc]"}`};return o.jsx("div",{className:n.imageFrame,children:o.jsx(ht,{src:(e==null?void 0:e.photoURL)||nW,className:"w-full"})})}function rW({children:t,className:e="px-2 py-1 text-sm font-[500]",position:n="bottom-[calc(100%+8px)]",content:r,isWrapped:s,...i},a){const[l,c]=f.useState(!1),{theme:u}=O(),{setTriggerRef:d,state:h}=mr(),{onClick:m}=i,p=f.useRef(null),g=()=>{"ontouchstart"in document.documentElement||c(!0)},y=()=>{c(!1)};f.useEffect(()=>{const x=p.current;if(x)return d&&d(x),x.addEventListener("mouseenter",g),x.addEventListener("mouseleave",y),()=>{x.removeEventListener("mouseenter",g),x.removeEventListener("mouseleave",y)}},[]);const _={container:`${u.modal_bg} text-white`},w=o.jsx(o.Fragment,{children:f.isValidElement(t)&&o.jsxs(o.Fragment,{children:[Object.keys(i).length?f.cloneElement(t,{ref:p,onClick:m}):f.cloneElement(t,{ref:p}),!(h!=null&&h.isOpen)&&l&&o.jsx("div",{className:`${_.container} absolute whitespace-nowrap -translate-x-1/2 left-1/2 rounded-md ${n} ${e}`,children:r})]})});if(f.isValidElement(t))return o.jsx(o.Fragment,{children:s?w:o.jsx("div",{className:"relative",children:w})})}const Is=f.forwardRef(rW);function o1(){const{setSuccessToast:t}=oe(),{close:e}=mr(),n=()=>{navigator.clipboard.writeText(location.href),t("Link copied"),e()};return o.jsxs("button",{onClick:n,children:[o.jsx(DO,{className:"w-5"}),o.jsx("span",{children:"Copy link"})]})}function zy(t){return o.jsxs("div",{className:"w-1/3 md:w-1/5 px-2",children:[t.variant==="skeleton"&&o.jsxs(o.Fragment,{children:[o.jsx(te,{className:"pt-[100%] rounded-full"}),o.jsx(te,{className:"mt-1 w-full h-[24px]"})]}),t.variant==="singer-item"&&o.jsxs(o.Fragment,{children:[o.jsx(we,{to:`/singer/${t.singer.id}`,children:o.jsx(gu,{className:"!rounded-full",children:o.jsx(ht,{src:t.singer.image_url,className:"hover:scale-[1.05] transition-transform"})})}),o.jsx("p",{className:"mt-1 text-center text-lg",children:t.singer.name})]})]})}let Uu=(t=21)=>crypto.getRandomValues(new Uint8Array(t)).reduce((e,n)=>(n&=63,n<36?e+=n.toString(36):n<62?e+=(n-26).toString(36).toUpperCase():n>62?e+="-":e+="_",e),"");const sW=!1,Tn=rs(Ie,"Songs"),jr=rs(Ie,"Playlists"),of=rs(Ie,"Singers");rs(Ie,"Lyrics");const l1=async({collectionName:t,id:e,msg:n})=>{await L7(Jt(Ie,t,e))},ss=async({collectionName:t,id:e,msg:n})=>zu(Jt(Ie,t,e)),Vi=async({collectionName:t,data:e,msg:n})=>await $7(rs(Ie,t),e),Qt=async({collectionName:t,id:e,data:n,msg:r})=>await M7(Jt(Ie,t,e),n),c1=async({file:t,folder:e,namePrefix:n,msg:r})=>{const s=n.replace("@gmail.com","")+"_"+t.name.replaceAll(" ","").toLowerCase(),i=s1(a1,`${e+s}`),a=await Bj(i,t);return{fileURL:await Uj(a.ref),filePath:a.metadata.fullPath}},iW=async({blob:t,folder:e,msg:n})=>{const r=Date.now()+".jpg",s=s1(a1,`${e+r}`),i=await Bj(s,t);return{fileURL:await Uj(i.ref),filePath:i.metadata.fullPath}},$n=async({filePath:t,msg:e})=>{try{const n=s1(a1,t);await XH(n)}catch(n){console.log({error:n})}},Vj=async t=>{await $n({filePath:t.song_file_path,msg:">>> api: delete song file"}),t.beat_file_path&&await $n({filePath:t.beat_file_path,msg:">>> api: delete song's image file"}),t.image_file_path&&await $n({filePath:t.image_file_path,msg:">>> api: delete song's image file"})},aW=async t=>{const e=Date.now(),n=await rI.post("/api/image/encode",t);let r="";n&&(r=n.data.encode);const s=(Date.now()-e)/1e3;return console.log(">>> api: get blurHash encode finished after",s),{encode:r}},oW=async t=>{const e=new FormData;e.append("file",t);const n=Date.now(),r=await rI.post("/api/image/optimize",e,{responseType:"blob"});let s;r&&(s=r.data);const i=(Date.now()-n)/1e3;return console.log(">>> api: optimize finished after",i),s};async function In(t,e){const n=await yl(t);return n.docs?n.docs.map(s=>{const i={...s.data(),id:s.id,queue_id:Uu(4)};return e!=null&&e.getQueueId&&(i.queue_id=e.getQueueId(i)),i}):[]}async function is(t){const e=await yl(t);return e.docs.length?e.docs.map(r=>({...r.data(),id:r.id})):[]}async function lf(t){const e=await yl(t);return e.docs.length?e.docs.map(r=>({...r.data(),id:r.id})):[]}const Hi=async({imageFile:t,blob:e})=>{let n=e;if(t&&(n=await oW(t)),!n)throw new Error("File not found");const r=iW({blob:n,folder:"/images/"}),{encode:s}=await aW(n),{filePath:i,fileURL:a}=await r;return{image_file_path:i,image_url:a,blurhash_encode:s}},Hj=["Newest","Popular"],lW=()=>Hj.reduce((t,e)=>{const n={playlists:[],shouldFetching:!0};return{...t,[e]:n}},{});function cW(){const[t,e]=f.useState(lW),{setErrorToast:n}=oe(),[r,s]=f.useState("Newest"),[i,a]=f.useState(!0),l=async()=>{try{const c={...t[r]};if(a(!0),c.shouldFetching){c.shouldFetching=!1;let u;switch(r){case"Newest":u=_e(jr,V("is_official","==",!0),V("is_public","==",!0),Ni("updated_at","desc"),nu(20));break;case"Popular":u=_e(jr,V("is_official","==",!0),V("is_public","==",!0),Ni("like","desc"),nu(20));break}if(u){const d=await is(u);c.playlists=d,e(h=>({...h,[r]:c}))}}else await Ns(100)}catch(c){console.log({message:c}),n()}finally{a(!1)}};return f.useEffect(()=>(l(),()=>{a(!0)}),[r]),{isFetching:i,playlistMap:t,getPlaylist:l,tabs:Hj,tab:r,setTab:s}}function uW(){const{getPlaylist:t,isFetching:e,playlistMap:n,...r}=cW();return o.jsx(o.Fragment,{children:o.jsxs("div",{children:[o.jsx(xe,{title:"Playlist"}),o.jsx("div",{className:"flex space-x-2 my-2",children:o.jsx(us,{render:s=>s,...r})}),o.jsx(yu,{loading:e,playlists:n[r.tab].playlists})]})})}const Wj=["Newest","Popular"],dW=()=>Wj.reduce((t,e)=>{const n={songs:[],shouldFetching:!0};return{...t,[e]:n}},{});function hW(){const[t,e]=f.useState(dW),{setErrorToast:n}=oe(),[r,s]=f.useState("Newest"),[i,a]=f.useState(!0),l=async()=>{try{const c={...t[r]};if(a(!0),c.shouldFetching){c.shouldFetching=!1;let u;switch(r){case"Newest":u=_e(Tn,V("is_official","==",!0),Ni("updated_at","desc"),nu(20));break;case"Popular":u=_e(Tn,V("is_official","==",!0),Ni("like","desc"),nu(20));break}if(u){const d=await In(u);c.songs=d,e(h=>({...h,[r]:c}))}}else await Ns(100)}catch(c){console.log({message:c}),n()}finally{a(!1)}};return f.useEffect(()=>(l(),()=>{a(!0)}),[r]),{isFetching:i,songMap:t,tabs:Wj,tab:r,setTab:s}}function fW({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{fillRule:"evenodd",d:"M7.72 12.53a.75.75 0 010-1.06l7.5-7.5a.75.75 0 111.06 1.06L9.31 12l6.97 6.97a.75.75 0 11-1.06 1.06l-7.5-7.5z",clipRule:"evenodd"}))}const mW=f.forwardRef(fW),pW=mW;function gW({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{fillRule:"evenodd",d:"M16.28 11.47a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 01-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 011.06-1.06l7.5 7.5z",clipRule:"evenodd"}))}const yW=f.forwardRef(gW),xW=yW;function vW({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{fillRule:"evenodd",d:"M4.5 5.653c0-1.426 1.529-2.33 2.779-1.643l11.54 6.348c1.295.712 1.295 2.573 0 3.285L7.28 19.991c-1.25.687-2.779-.217-2.779-1.643V5.653z",clipRule:"evenodd"}))}const wW=f.forwardRef(vW),_W=wW;function SW({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{fillRule:"evenodd",d:"M12 3.75a.75.75 0 01.75.75v6.75h6.75a.75.75 0 010 1.5h-6.75v6.75a.75.75 0 01-1.5 0v-6.75H4.5a.75.75 0 010-1.5h6.75V4.5a.75.75 0 01.75-.75z",clipRule:"evenodd"}))}const EW=f.forwardRef(SW),bW=EW;function qj({children:t,className:e=""}){const{theme:n}=O();return o.jsx("div",{className:`rounded-md py-2 ${n.modal_bg} text-white ${e}`,children:t})}function xl({children:t,className:e=""}){const n={container:"hover:[&>*:not(div.absolute)]:bg-white/5 [&>*]:px-3 [&>*]:py-2 [&>*]:w-full [&>*]:space-x-2 [&>*]:text-sm [&>*]:flex [&>*]:items-center"};return o.jsx("div",{className:`${n.container} ${e}`,children:t})}const u1=(t,e,n="rgba(255,255,255,.15)")=>`linear-gradient(to right, ${t} ${e}%, ${n} ${e}%, ${n}`;function d1({audioEle:t,baseColor:e,color:n,progressLineRef:r,setStatusFromParent:s,statusFromParent:i}){const{theme:a}=O(),[l,c]=f.useState("paused"),[u,d]=f.useState(!1),h=i||l,m=s||c,p=f.useRef(""),g=f.useRef(h),y=()=>{try{t.play(),d(!0)}catch{}},_=()=>{t==null||t.pause(),v()},w=()=>{h==="playing"?_():h==="paused"&&y()},x=()=>{m("playing")},v=()=>{m("paused")},S=P=>{if(!t)return;const ce=+(P||t.currentTime/t.duration*100).toFixed(1);r!=null&&r.current&&(r.current.style.background=u1(n||p.current,ce,e))},E=()=>{const ce=t.currentTime/(t.duration/100);S(+ce.toFixed(1))},b=()=>{console.log("error"),m("error")},I=P=>{t.currentTime=P,S(),h!=="playing"&&y()},A=P=>{t.currentTime=t.currentTime+P},L=P=>{t.currentTime=t.currentTime-P};return f.useEffect(()=>{if(t)return t.addEventListener("error",b),t.addEventListener("pause",v),t.addEventListener("playing",x),r!=null&&r.current&&t.addEventListener("timeupdate",E),()=>{t.removeEventListener("error",b),t.removeEventListener("pause",v),t.removeEventListener("playing",x),r!=null&&r.current&&t.removeEventListener("timeupdate",E)}},[t]),f.useEffect(()=>{p.current=a.content_code,h!=="playing"&&S()},[a]),f.useEffect(()=>{g.current=h},[h]),{play:y,pause:_,seek:I,handlePlayPause:w,status:h,forward:A,backward:L,isClickPlay:u,statusRef:g}}function Us({variant:t}){const e=rn(),{currentQueueId:n,queueSongs:r,currentSongData:s}=ae(dt),i=f.useMemo(()=>{switch(t){default:return"queue_id"}},[]);return{handleSetSong:(l,c)=>{if(n!==l){e(Ur(l)),e(Ze({playStatus:"loading"}));const u=r.map(h=>h[i]);if(!r.length||r.length!==c.length||!!c.find(h=>!u.includes(h[i])))return console.log("set queue"),e(e$({songs:c})),!0}return!1},currentSongData:s,queueSongs:r,currentQueueId:n}}function Gj(t,e){const[n,r]=f.useState(t);return f.useEffect(()=>{if(!t){r("");return}const s=setTimeout(()=>{r(t)},e);return()=>{clearTimeout(s)}},[t]),n}const h1={isDev:!1,focusDelay:3e3,scrollSongDelay:4e3,loadingDuration:200};function fb(t,e){const n=f.useRef(),[r,s]=f.useState(0),[i,a]=f.useState(0);return f.useEffect(()=>{r&&(n.current=setTimeout(()=>n.current=void 0,e))},[i,h1]),f.useEffect(()=>{n.current||(t(),a(Math.random()*10))},[r]),()=>s(Math.random()*10)}const Fg={currentPlaylist:null,playlistSongs:[]},Qj=Mv({name:"currentPlaylist",initialState:Fg,reducers:{setCurrentPlaylist(t,e){const{playlist:n,songs:r}=e.payload;t.currentPlaylist=n,t.playlistSongs=r},updateCurrentPlaylist:(t,e)=>{if(!t.currentPlaylist)return t;Object.assign(t.currentPlaylist,e.payload)},addSongsToPlaylist(t,e){if(!t.currentPlaylist)return t;const n=e.payload.map(r=>({...r,song_in:`playlist_${t.currentPlaylist.id}`,queue_id:Uu(4)}));t.playlistSongs.push(...n)},setPlaylistSong(t,e){t.playlistSongs=e.payload},removeSong(t,e){const{index:n}=e.payload;t.playlistSongs.splice(n,1)},resetCurrentPlaylist:t=>{t.currentPlaylist=Fg.currentPlaylist,t.playlistSongs=Fg.playlistSongs}}}),vl=t=>t.currentPlaylist,{addSongsToPlaylist:tZ,removeSong:nZ,setCurrentPlaylist:kW,updateCurrentPlaylist:TW,resetCurrentPlaylist:IW,setPlaylistSong:rZ}=Qj.actions,CW=Qj.reducer;function RW(){const t=rn(),{setErrorToast:e}=oe(),{user:n,loading:r}=fe(),s=Fa(),[i,a]=f.useState(!0),l=async()=>{if(!s.id)return;const d=await ss({collectionName:"Playlists",id:s.id,msg:">>> api get playlist"});if(d.exists())return{...d.data(),id:d.id}},c=async d=>{if(!d.song_ids.length)return[];const h=_e(Tn,V(Bs(),"in",d.song_ids)),m=await yl(h);return m.docs.length?m.docs.map(g=>({id:g.id,...g.data(),queue_id:`${Uu(4)}_${d.id}}`})):[]},u=async()=>{try{if(!s.id)return;a(!0);const d=await l();if(!d||!(n?d.owner_email===n.email&&!d.is_official:!1)&&!d.is_public)return;const m=await c(d);t(kW({playlist:d,songs:m}))}catch(d){console.log({message:d}),e()}finally{a(!1)}};return f.useEffect(()=>{if(!r)return u(),()=>{t(IW())}},[r]),{isFetching:i}}function Kj({active:t}){const{audioRef:e}=Mt();if(!e.current)throw new Error("useSongLyric !audioRef.current");const{playStatus:n}=ae(Kn),{currentSongData:r}=ae(dt),{setLoading:s,setSongLyrics:i,songLyrics:a,loading:l,ranGetLyric:c}=kD(),[u,d]=f.useState(!1),h=f.useRef(),m=async()=>{try{if(!r||!r.song.lyric_id)return s(!1);s(!0);const g=await ss({collectionName:"Lyrics",id:r.song.lyric_id});if(g.exists()){const y=g.data();typeof y.lyrics=="string"?i(JSON.parse(y.lyrics||"[]")):i(y.lyrics)}}catch(g){console.log({message:g})}finally{s(!1)}},p=()=>{clearTimeout(h.current),d(!1),s(!0),i([]),c.current=!1};return f.useEffect(()=>{const g=async()=>{d(!0)};return e.current.addEventListener("loadeddata",g),()=>{var y;(y=e.current)==null||y.removeEventListener("loadeddata",g)}},[]),f.useEffect(()=>{a.length||u&&t&&(c.current||(c.current=!0,h.current=setTimeout(()=>{m()},500)))},[u,t]),f.useEffect(()=>{if(n==="error"){s(!1);return}return()=>{p()}},[r,n==="error"]),{songLyrics:a,loading:l,playStatus:n}}function Xj(){const t=rn(),{setSuccessToast:e}=oe();return{action:r=>{switch(r.variant){case"add":t(_m({songs:r.songs})),e("Song added to queue");break;case"remove":t(Z6({index:r.index}))}}}}function Yj(){const{setPlaylists:t}=Cn(),{setErrorToast:e,setSuccessToast:n}=oe(),[r,s]=f.useState(!1);return{isFetching:r,handleAddPlaylist:async(a,l,c)=>{try{if(s(!0),l){const p=await Hi({imageFile:l});Object.assign(a,p)}const u=await Vi({collectionName:"Playlists",data:a}),d=await zu(u),h={...d.data(),id:d.id},{push:m=!0}=c||{};return m&&t(p=>[h,...p]),n("Playlist created"),h}catch(u){console.log(u),e()}finally{s(!1)}}}}function AW(){const{playlists:t,setPlaylists:e}=Cn(),{setErrorToast:n,setSuccessToast:r}=oe(),[s,i]=f.useState(!1);return{isFetching:s,addToPlaylist:async({song:l,playlist:c})=>{try{i(!0);const u={song_ids:[l.id,...c.song_ids]},d={...c,...u};await Qt({collectionName:"Playlists",id:c.id,data:u});const h=[...t],m=h.findIndex(p=>p.id===c.id);m!==-1&&(h[m]=d,e(h)),r("Song added")}catch(u){console.log({message:u}),n()}finally{i(!1)}}}}const By=t=>({name:"",image_url:"",song_url:"",beat_url:"",beat_file_path:"",duration:0,like:0,lyric_id:"",image_file_path:"",song_file_path:"",blurhash_encode:"",singer_map:{},genre_map:{},genres:[],singers:[],is_official:!1,size:0,created_at:Ko(),updated_at:Ko(),...t}),Uy=t=>({name:"",song_ids:[],image_url:"",singers:[],singer_map:{},genre_map:{},genres:[],is_album:!1,like:0,blurhash_encode:"",is_public:!0,is_official:!1,image_file_path:"",created_at:Ko(),updated_at:Ko(),...t}),mb=({owner_email:t,distributor:e,...n})=>Uy({owner_email:t,is_album:!0,is_official:!0,is_public:!0,distributor:e,...n}),cf=t=>({name:"",description:"",image_file_path:"",image_url:"",like:0,created_at:Ko(),blurhash_encode:"",...t}),pb=({start:t,end:e,text:n})=>{const r=n.trim().split(" "),s=r.map(()=>[]),i=r.map(()=>0);return{start:t,end:e,tune:{start:t,end:e,grow:i},cut:s,text:n}};function jW(){const[t,e]=f.useState(),[n,r]=f.useState(),s=f.useRef(null);return{playlistData:t,imageFile:n,setImageFile:r,updatePlaylistData:a=>{t&&e({...t,...a})},setPlaylistData:e,inputRef:s}}function wl({close:t,isLoading:e,submit:n,...r}){const{theme:s}=O(),{imageFile:i,setImageFile:a,playlistData:l,updatePlaylistData:c,setPlaylistData:u,inputRef:d}=jW(),h=f.useMemo(()=>r.variant==="add"?!0:!r.playlist||!l?!1:l.name!==r.playlist.name||l.is_public!==r.playlist.is_public,[l]),m=!!i,p=f.useMemo(()=>{const w=!!(l!=null&&l.name)&&h;return r.variant==="add"?w:w||m},[m,h,l]),g=()=>{switch(r.variant){case"add":return Uy({distributor:r.user.display_name,owner_email:r.user.email});case"edit":const{id:w,updated_at:x,...v}=r.playlist;return Uy(v)}},y=async()=>{l&&(!h&&!m||n(l,i))},_=w=>{var x;(x=w.target.files)!=null&&x.length&&a(w.target.files[0])};if(f.useEffect(()=>{var w;r.variant==="add"&&((w=d.current)==null||w.focus()),u(g())},[]),f.useEffect(()=>{i&&c({image_url:URL.createObjectURL(i)})},[i]),!!l)return o.jsxs("div",{className:"w-[500px] max-w-[calc(100vw-40px)]",children:[o.jsx($t,{close:t,title:r.variant==="add"?"Add playlist":"Edit playlist"}),o.jsxs("div",{className:"flex space-x-3",children:[o.jsxs("div",{className:"space-y-2.5",children:[o.jsx("div",{className:"w-[200px] h-[200px] rounded-lg overflow-hidden",children:o.jsx(ht,{className:"object-cover object-center h-full",blurHashEncode:l.blurhash_encode,src:l.image_url})}),o.jsx("input",{ref:d,onChange:_,type:"file",multiple:!0,accept:"image/png, image/jpeg",id:"image_upload",className:"hidden"}),o.jsx("div",{className:"space-x-2 flex",children:o.jsx(ee,{className:`${s.content_bg}`,size:"clear",children:o.jsx("label",{htmlFor:"image_upload",className:"px-5 py-1 cursor-pointer ",children:o.jsx(ol,{className:"w-5"})})})})]}),o.jsxs("div",{className:"flex-grow flex flex-col space-y-2.5",children:[o.jsx(cr,{ref:d,type:"text",placeholder:"name...",value:l.name,onChange:w=>c({name:w.target.value})}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{children:"Public"}),o.jsx(Zf,{className:"",active:l.is_public,cb:()=>c({is_public:!l.is_public})})]}),o.jsx("p",{className:"text-right !mt-auto",children:o.jsx(ee,{isLoading:e,color:"primary",onClick:y,disabled:!p,className:"font-playwriteCU rounded-full",children:"Save"})})]})]})]})}function up(){const t=rn(),{user:e,updateUserData:n}=fe(),{setPlaylists:r,playlists:s}=Cn(),[i,a]=f.useState(!1),{setSuccessToast:l,setErrorToast:c}=oe(),u=nn();return{isFetching:i,action:async h=>{try{if(!e)throw new Error("user not found");a(!0);const m=Bu(Ie),p=Jt(Ie,"Users",e.email),g=Jt(Ie,"Playlists",h.playlist.id);switch(h.variant){case"like":{if(!e)throw Error();const y=[...e.liked_playlist_ids],_=y.findIndex(S=>S===h.playlist.id),w=_===-1;w?y.unshift(h.playlist.id):y.splice(_,1);const x={liked_playlist_ids:y},v={like:Yw(w?1:-1)};m.update(p,x),m.update(g,v),await m.commit(),r(w?S=>[h.playlist,...S]:S=>S.filter(E=>E.id!==h.playlist.id)),n(x);break}case"edit":{const{data:y,playlist:_,imageFile:w}=h,x={..._,...y};if(w){const I=await Hi({imageFile:w});_.image_file_path&&await $n({filePath:_.image_file_path}),Object.assign(x,I)}await Qt({collectionName:"Playlists",data:x,id:_.id,msg:">>> api: update playlist doc"});const v=[...s],S=v.findIndex(I=>I.id===_.id);S!==-1&&(v[S]=x,r(v));const{updated_at:E,...b}=x;t(TW(b)),l("Playlist edited");break}case"delete":{const{playlist:y}=h;y.image_file_path&&await $n({filePath:y.image_file_path});const _={liked_playlist_ids:e.liked_playlist_ids.filter(x=>x!==y.id)};m.delete(g),m.update(p,_),await Promise.all([m.commit(),y.image_file_path?$n({filePath:y.image_file_path}):()=>{}]);const w=s.filter(x=>x.id!==y.id);r(w),n(_),u("/my-music");break}}}catch(m){console.log({message:m}),c()}finally{a(!1)}},user:e}}function f1(){const{user:t}=fe(),{setErrorToast:e}=oe(),{handleAddPlaylist:n,isFetching:r}=Yj(),{action:s,isFetching:i}=up();return{isFetching:r||i,myMusicAddPlaylist:async(c,u)=>{try{if(!t)return;const d=await n(c,u,{push:!1});d&&await s({variant:"like",playlist:d})}catch(d){console.log({error:d}),e()}}}}function Jj({song:t,closeModal:e}){const{user:n}=fe(),{playlists:r}=Cn(),{theme:s}=O(),{addToPlaylist:i,isFetching:a}=AW(),{myMusicAddPlaylist:l,isFetching:c}=f1(),u=f.useRef(null),d=n?r.filter(p=>p.owner_email===n.email&&!p.is_official):[],h=async p=>{await i({playlist:p,song:t}),e()},m=async(p,g)=>{var y;p.song_ids=[t.id],await l(p,g),(y=u.current)==null||y.close(),e()};if(n)return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"w-[300px] max-h-[80vh] max-w-[calc(90vw-40px)] flex flex-col ",children:[o.jsx($t,{close:e,title:"Playlists"}),o.jsx("div",{className:`flex-grow flex flex-col overflow-auto space-y-2 ${a?"disable":""}`,children:d.length?d.map((p,g)=>{const y=p.song_ids.includes(t.id);return o.jsxs("button",{disabled:y,onClick:()=>h(p),className:`flex rounded-md p-2 ${s.content_hover_bg} bg-white/10`,children:[o.jsx(Da,{className:"w-5 mr-2"}),o.jsx("span",{children:p.name})]},g)}):o.jsx(Xe,{variant:"less"})}),o.jsxs(ee,{className:`${s.content_bg} mt-5 rounded-full justify-center`,onClick:()=>{var p;return(p=u.current)==null?void 0:p.open()},children:[o.jsx(ls,{className:"w-5"}),o.jsx("span",{children:"Add new playlist"})]})]}),o.jsx(Ee,{variant:"animation",ref:u,children:o.jsx(wl,{close:()=>{var p;return(p=u.current)==null?void 0:p.close()},submit:m,isLoading:a||c,variant:"add",user:n})})]})}function m1({modalRef:t,song:e}){const{user:n}=fe();return n?o.jsx(Ee,{variant:"animation",ref:t,children:o.jsx(Jj,{closeModal:()=>{var r;return(r=t.current)==null?void 0:r.close()},song:e})}):o.jsx(o.Fragment,{})}function p1({modalRef:t}){const{user:e}=fe(),{close:n}=mr(),r=()=>{var s;(s=t.current)==null||s.open(),n()};return e?o.jsxs("button",{onClick:r,children:[o.jsx(cs,{className:"w-5"}),o.jsx("span",{children:"Add to playlist"})]}):o.jsx(o.Fragment,{})}function NW({song:t,index:e}){const{action:n}=Xj(),{close:r}=mr(),s=f.useRef(null),i=()=>{n({variant:"remove",index:e}),r()};return o.jsxs(o.Fragment,{children:[o.jsxs(dp,{song:t,children:[!1,o.jsxs("button",{onClick:i,children:[o.jsx(mv,{className:"w-5"}),o.jsx("span",{children:"Remove"})]}),o.jsx(p1,{modalRef:s}),o.jsxs("a",{target:"_blank",href:t.song_url,children:[o.jsx(qf,{className:"w-5"}),o.jsx("span",{children:"Download"})]})]}),o.jsx(m1,{song:t,modalRef:s})]})}function PW({song:t,modalRef:e}){const{user:n}=fe(),{updateSong:r}=Cn(),[s,i]=f.useState({name:t.name,singer:t.singers[0].name,image_url:t.image_url}),[a,l]=f.useState(!1),[c,u]=f.useState(),{setErrorToast:d,setSuccessToast:h}=oe(),m=f.useMemo(()=>t.name!==s.name||t.singers[0].name!==s.singer,[s]),p=!!s.name&&!!s.singer&&m||c;return{isFetching:a,isChanged:m,songData:s,isValidToSubmit:p,handleSubmit:async()=>{var _,w;try{if(!n||!p)return;l(!0),(_=e.current)==null||_.setModalPersist(!0);const{id:x,...v}=t;if(m){if(!s.name||!s.singer)return;v.name=s.name,v.singers=[{...v.singers[0],name:s.singer}]}if(c){const S=await Hi({imageFile:c});Object.assign(v,S),t.image_file_path&&await $n({filePath:t.image_file_path})}await Qt({collectionName:"Songs",data:v,id:t.id}),r({id:t.id,song:v}),h("Song edited"),(w=e.current)==null||w.close()}catch(x){console.log({message:x}),d()}finally{l(!1)}},imageFile:c,setImageFile:u,handleInput:(_,w)=>{i({...s,[_]:w})}}}function FW({song:t,modalRef:e}){const{theme:n}=O(),r=f.useRef(null),{isValidToSubmit:s,songData:i,setImageFile:a,isFetching:l,handleSubmit:c,handleInput:u}=PW({song:t,modalRef:e}),d=m=>{const p=m.target.files;p!=null&&p.length&&(a(p[0]),u("image_url",URL.createObjectURL(p[0])))},h=m=>{var p;m.stopPropagation(),(p=e.current)==null||p.close()};return o.jsxs("div",{className:`${jc(l)} w-[500px] max-h-[80vh] max-w-[90vw] text-white flex flex-col`,children:[o.jsx("input",{ref:r,id:"image-input",type:"file",accept:"image/*",onChange:d,className:"hidden"}),o.jsx($t,{title:"Edit song",close:()=>{var m;return(m=e.current)==null?void 0:m.close()}}),o.jsxs("div",{className:"flex flex-col flex-grow overflow-auto md:overflow-hidden md:flex-row mt-5",children:[o.jsxs("div",{className:"space-y-2.5",children:[o.jsx("div",{className:"w-[200px] rounded-md overflow-hidden h-[200px] md:w-[160px] md:h-[160px] object-cover",children:o.jsx(ht,{className:"object-cover h-full",src:i.image_url})}),o.jsx("label",{htmlFor:"image-input",className:`inline-block cursor-pointer hover:brightness-90 px-[20px] py-[5px] ${n.content_bg} rounded-full text-[14px]`,children:o.jsx(ol,{className:"w-5"})})]}),o.jsxs("div",{className:"pt-5 md:pt-0 md:pl-5 md:flex-grow space-y-3",children:[o.jsxs("div",{className:"space-y-1.5",children:[o.jsx("label",{htmlFor:"name",className:"",children:"Name"}),o.jsx(cr,{value:i.name,type:"text",id:"name",onChange:m=>u("name",m.target.value),placeholder:t.name})]}),o.jsxs("div",{className:"space-y-1.5",children:[o.jsx("label",{htmlFor:"singer",className:"",children:"Singer"}),o.jsx(cr,{value:i.singer,onChange:m=>u("singer",m.target.value),type:"text",id:"singer",placeholder:t.singers[0].name})]})]})]}),o.jsxs("div",{className:"flex mt-5 space-x-2 justify-end",children:[o.jsx(ee,{onClick:h,className:"rounded-full",children:"Close"}),o.jsx(ee,{isLoading:l,onClick:c,disabled:!s,className:`${n.content_bg} rounded-full`,variant:"primary",children:"Save"})]})]})}function Zj(){const{user:t,updateUserData:e}=fe(),{setErrorToast:n,setSuccessToast:r}=oe(),{uploadedSongs:s,setUploadedSongs:i,shouldFetchFavoriteSongs:a}=Cn(),[l,c]=f.useState(!1);return{loading:l,action:async d=>{try{if(c(!0),!t)throw new Error("User not found");const h=Bu(Ie),m=Jt(Ie,"Users",t.email),p=Jt(Ie,"Songs",d.song.id);switch(d.variant){case"delete":{const g=s.filter(_=>_.id!==d.song.id),y={liked_song_ids:t.liked_song_ids.filter(_=>_!==d.song.id)};if(h.update(m,y),h.delete(p),d.song.lyric_id){const _=Jt(Ie,"Lyrics",d.song.lyric_id);h.delete(_)}await Promise.all([h.commit(),Vj(d.song)]),i(g),r(`'${d.song.name}' deleted`);break}case"like":{if(!t)return;const g=[...t.liked_song_ids],y=g.findIndex(v=>v===d.song.id),_=y===-1;_?g.unshift(d.song.id):g.splice(y,1);const w={liked_song_ids:g},x={like:Yw(_?1:-1)};h.update(m,w),h.update(p,x),await h.commit(),e(w),a.current=!0;break}}}catch(h){console.log({message:h}),n()}finally{c(!1)}}}}function g1({song:t}){const{close:e}=mr(),{action:n}=Xj(),r=()=>{n({variant:"add",songs:[t]}),e()};return o.jsxs("button",{onClick:r,children:[o.jsx(ls,{className:"w-5"}),o.jsx("span",{children:"Add to queue"})]})}function DW({song:t}){const{close:e}=mr(),[n,r]=f.useState(""),s=f.useRef(null),i=f.useRef(null),{action:a,loading:l}=Zj(),c=m=>{var p;r(m),(p=s.current)==null||p.open(),e()},u=()=>{var m;(m=s.current)==null||m.close()},d=async()=>{await a({variant:"delete",song:t}),u()},h=()=>{switch(n){case"":return o.jsx(o.Fragment,{});case"delete":return o.jsx(Li,{callback:d,loading:l,close:u,label:`Delete ' ${t.name} ' ?`});case"edit":return o.jsx(FW,{modalRef:s,song:t});case"add-to-playlist":return o.jsx(Jj,{closeModal:u,song:t})}};return o.jsxs(o.Fragment,{children:[o.jsxs(dp,{song:t,children:[!1,o.jsx(g1,{song:t}),o.jsx(p1,{modalRef:i}),o.jsxs("button",{onClick:()=>c("edit"),children:[o.jsx(mu,{className:"w-5"}),o.jsx("span",{children:"Edit"})]}),o.jsxs(we,{to:`lyric/${t.id}`,children:[o.jsx(hv,{className:"w-5"}),o.jsx("span",{children:t.lyric_id?"Edit lyric":"Add lyric"})]}),o.jsxs("button",{onClick:()=>c("delete"),children:[o.jsx(Gn,{className:"w-5"}),o.jsx("span",{children:"Delete"})]}),o.jsxs("a",{target:"_blank",href:t.song_url,children:[o.jsx(qf,{className:"w-5"}),o.jsx("span",{children:"Download"})]})]}),o.jsx(Ee,{variant:"animation",ref:s,children:h()}),o.jsx(m1,{song:t,modalRef:i})]})}function OW({song:t}){const e=f.useRef(null);return o.jsxs(o.Fragment,{children:[o.jsxs(dp,{song:t,children:[!1,o.jsx(g1,{song:t}),o.jsx(p1,{modalRef:e}),o.jsxs("a",{target:"_blank",href:t.song_url,children:[o.jsx(qf,{className:"w-5"}),o.jsx("span",{children:"Download"})]})]}),o.jsx(m1,{song:t,modalRef:e})]})}function MW({song:t}){const{isFetching:e}=up();return o.jsx(o.Fragment,{children:o.jsxs(dp,{song:t,children:[!1,o.jsx(g1,{song:t}),o.jsx("button",{children:e?o.jsx(Lt,{className:"w-5 animate-spin"}):o.jsxs(o.Fragment,{children:[o.jsx(mv,{className:"w-5"}),o.jsx("span",{children:"Remove"})]})}),o.jsxs("a",{target:"_blank",href:t.song_url,children:[o.jsx(qf,{className:"w-5"}),o.jsx("span",{children:"Download"})]})]})})}function LW({song:t}){return o.jsx("div",{className:"px-2 mb-3",children:o.jsxs("div",{className:"p-3 bg-[#fff]/5 rounded-md flex",children:[o.jsx("div",{className:"w-[50px] h-[50px] rounded overflow-hidden flex-shrink-0",children:o.jsx(ht,{src:t.image_url,className:"object-cover object-center w-full"})}),o.jsxs("div",{className:"ml-1 text-sm",children:[o.jsx("h5",{className:"line-clamp-1 font-[500]",children:t.name}),o.jsx("p",{className:"opacity-70 line-clamp-1",children:t.singers.map((e,n)=>e.name+(n?", ":""))})]})]})})}function dp({children:t,song:e}){const{theme:n}=O();return o.jsx(fr,{appendTo:"portal",className:"w-[240px]",children:o.jsxs(zs,{className:"py-2",p:"clear",theme:n,children:[o.jsx(LW,{song:e}),o.jsx(xl,{children:t}),o.jsxs("p",{className:"text-xs text-center opacity-70 mt-3",children:["By ",e.distributor]})]})})}function gb({song:t,index:e,variant:n}){const{theme:r}=O(),[s,i]=f.useState(!1),a=()=>{switch(n){case"queue-song":return o.jsx(NW,{song:t,index:e});case"own-song":return o.jsx(DW,{song:t});case"own-playlist":return o.jsx(MW,{song:t});default:return o.jsx(OW,{song:t})}},l=()=>{switch(n){case"queue-song":case"recent-song":return o.jsx(o.Fragment,{});default:return o.jsx("span",{className:`text-sm font-[500] hidden p-2 group-hover/main:hidden ${s?"hidden":"md:block"}`,children:ki(t.duration)})}},c={button:`hover:bg-${r.alpha} p-2 rounded-full`},u=()=>s?`${r.content_bg}`:"block md:hidden";return o.jsx(o.Fragment,{children:o.jsxs(dr,{appendOnPortal:!0,children:[o.jsx(hr,{setIsOpenParent:i,children:o.jsx(Is,{isWrapped:!0,content:"Menu",children:o.jsx("button",{type:"button",className:`block group-hover/main:block ${c.button} ${u()}`,children:o.jsx(al,{className:"w-5"})})})}),l(),a()]})})}function $W({isLiked:t,song:e,isSongActive:n,songVariant:r,className:s="p-1.5"}){const{theme:i}=O(),{action:a,loading:l}=Zj(),c=()=>{switch(r){case"queue-song":case"recent-song":return"mr-1";default:return""}},u=()=>{if(t)switch(r){case"queue-song":case"recent-song":return"";default:return"!block"}return""},d=()=>{switch(r){case"queue-song":case"recent-song":return n?"text-white":i.content_text;default:return i.content_text}},h={button:`hover:bg-${i.alpha} rounded-full`};return o.jsx("button",{onClick:()=>a({variant:"like",song:e}),className:`${h.button} ${c()} group-hover/main:block md:hidden ${s} ${u()}`,children:l?o.jsx(Lt,{className:"w-5 animate-spin"}):o.jsx(o.Fragment,{children:t?o.jsx(xv,{className:`w-5 ${d()}`}):o.jsx(Kf,{className:"w-5"})})})}function zW({onClick:t,isChecked:e,isSelected:n}){return o.jsxs(o.Fragment,{children:[o.jsx("button",{onClick:t,className:`mr-2 md:mr-3 group-hover/main:block ${e?"block":"md:hidden "}`,children:n?o.jsx(yv,{className:"w-[18px]"}):o.jsx(kI,{className:"w-[18px]"})}),o.jsx("button",{className:`mr-3 hidden group-hover/main:hidden group-hover/main:mr-[0px] md:block ${cD(e,"md:hidden")}`,children:o.jsx(Da,{className:"w-[18px]"})})]})}function BW({song:t,onClick:e,isHasCheckBox:n,active:r=!0,isLiked:s,index:i,className:a="",...l}){const{theme:c,isOnMobile:u}=O(),{isChecked:d,selectedSongs:h,selectSong:m}=il(),p=f.useMemo(()=>h?h.indexOf(t)!=-1:!1,[h]),g=()=>{d!==void 0&&m(t)},y={button:`${c.content_hover_bg} p-[8px] rounded-full`,checkboxButton:"mr-3 text-[inherit]",itemContainer:`w-full sm:group/container flex flex-row rounded justify-between p-[10px] border-b border-${c.alpha} last:border-none`,imageFrame:" relative rounded-[4px] overflow-hidden flex-shrink-0",overlay:"absolute flex items-center justify-center inset-0 bg-black/40",ctaWrapper:"flex items-center justify-end flex-shrink-0"},_=f.useMemo(()=>{switch(l.variant){default:return o.jsxs("div",{className:` ${y.overlay} 
               ${r?"":"hidden sm:group-hover/main:flex"}`,children:[o.jsx("img",{src:Ev,alt:"",className:`"h-[18px] w-[18px] ${Nc(!r)}`}),o.jsx("button",{onClick:e,className:`${Nc(r)} `,children:o.jsx(_W,{className:"w-[24px] text-white"})})]})}},[r,e]),w=()=>{switch(l.variant){case"queue-song":case"recent-song":return"text-sm";default:return""}},x=()=>{switch(l.variant){case"queue-song":case"recent-song":return"w-10 h-10";default:return"h-[54px] w-[54px]"}},v=()=>{switch(l.variant){case"queue-song":case"recent-song":return"text-xs";default:return"text-sm"}},S=o.jsxs(o.Fragment,{children:[n&&o.jsx(zW,{isChecked:d,isSelected:p,onClick:g}),o.jsxs("div",{className:"flex-grow flex",onClick:u?e:()=>{},children:[o.jsxs("div",{className:`${y.imageFrame} ${x()}`,children:[o.jsx(ht,{src:t.image_url,blurHashEncode:t.blurhash_encode}),_]}),o.jsxs("div",{className:"ml-[10px]",children:[o.jsxs("h5",{className:`line-clamp-1 font-medium overflow-hidden ${w()}`,children:[t.name,!1]}),o.jsx("div",{className:`opacity-[.7] line-clamp-1 ${v()}`,children:t.singers.map((L,P)=>L.id?o.jsx(we,{to:`/singer/${L.id}`,className:`${c.content_hover_text}  hover:underline`,children:(P?", ":"")+L.name},P):o.jsxs("span",{children:[" ",(P?", ":"")+L.name]},P))})]})]})]}),E=()=>{switch(l.variant){case"queue-song":case"recent-song":return S;default:return o.jsx("div",{className:"flex flex-grow overflow-hidden",children:S})}},b=()=>{switch(l.variant){case"queue-song":case"recent-song":return o.jsx(gb,{variant:l.variant,song:t,index:i});default:return o.jsx("div",{className:"flex justify-center md:w-[60px]",children:o.jsx(gb,{variant:l.variant,song:t,index:i})})}},I=o.jsxs("div",{className:"flex items-center",children:[s!=null&&o.jsx($W,{className:"p-2",isSongActive:r,songVariant:l.variant,isLiked:s,song:t}),b()]});return(()=>{switch(l.variant){case"queue-song":case"recent-song":return o.jsxs("div",{className:`${y.itemContainer} group/main ${r?`${c.content_bg} text-white`:`hover:bg-${c.alpha}`}`,children:[E(),I]});default:return o.jsxs("div",{className:`${y.itemContainer} ${a} group/main ${r||p?`bg-${c.alpha}`:`hover:bg-${c.alpha}`}`,children:[E(),I]})}})()}function Vs({songs:t,setSong:e,getActive:n,songVariant:r,isHasCheckBox:s=!0}){const{user:i}=fe(),{currentSongData:a}=ae(dt);return t.length?t.map((l,c)=>{const u=i?l.owner_email===i.email&&l.is_official===!1:!1;return o.jsx(BW,{active:a?n?n(l,a.song):l.id===a.song.id:!1,onClick:()=>e(l),variant:r||(u?"own-song":"system-song"),isHasCheckBox:s,isLiked:i?i.liked_song_ids.includes(l.id):null,song:l,index:c},l.queue_id)}):o.jsx(Xe,{variant:"less"})}function UW(){const t=rn(),{setSuccessToast:e}=oe(),{selectedSongs:n,resetSelect:r}=il(),s=()=>{t(_m({songs:n})),e("songs added to queue"),r()};return o.jsxs("button",{onClick:s,children:[o.jsx(ls,{className:"w-5"}),o.jsx("span",{className:"",children:"Add to queue"})]})}function VW({modalRef:t}){const{user:e}=fe(),{selectedSongs:n}=il(),{myMusicAddPlaylist:r,isFetching:s}=f1(),i=async(a,l)=>{var c;a.song_ids=n.map(u=>u.id),await r(a,l),(c=t.current)==null||c.close()};return e?o.jsx(Ee,{variant:"animation",ref:t,children:o.jsx(wl,{close:()=>{var a;return(a=t.current)==null?void 0:a.close()},submit:i,isLoading:s,variant:"add",user:e})}):o.jsx(o.Fragment,{})}function HW({modalRef:t}){const{user:e}=fe(),{close:n}=mr(),r=()=>{var s;(s=t.current)==null||s.open(),n()};return e?o.jsxs("button",{onClick:r,children:[o.jsx(cs,{className:"w-5"}),o.jsx("span",{children:"Add to playlist"})]}):o.jsx(o.Fragment,{})}function WW(){const t=f.useRef(null);return o.jsxs(o.Fragment,{children:[o.jsx(qW,{children:o.jsx(HW,{modalRef:t})}),o.jsx(VW,{modalRef:t})]})}function qW({children:t}){const{theme:e}=O();return o.jsx(fr,{appendTo:"portal",children:o.jsx(zs,{className:"py-2",p:"clear",theme:e,children:o.jsx(xl,{children:t})})})}function GW({variant:t}){const e=()=>{switch(t){default:return o.jsx(WW,{})}};return o.jsx(o.Fragment,{children:o.jsxs(dr,{appendOnPortal:!0,children:[o.jsx(hr,{children:o.jsx("button",{className:"!p-1.5",type:"button",children:o.jsx(al,{className:"w-5"})})}),e()]})})}function hp({children:t,variant:e,selectAll:n}){const{theme:r}=O(),{user:s}=fe(),{isSelectAll:i,isChecked:a,resetSelect:l,selectedSongs:c}=il(),u=o.jsxs(o.Fragment,{children:[n&&o.jsx("button",{onClick:n,className:"ml-[10px]",children:i?o.jsx(pu,{className:"w-[20px]"}):o.jsx(kI,{className:"w-[20px]"})}),o.jsx("p",{className:"font-playwriteCU mr-1",children:c.length}),o.jsxs("div",{className:`flex space-x-2 items-center ${r.type==="light"?"[&>button]:bg-black/5":"[&>button]:bg-white/5"}  [&>button]:inline-flex [&>button]:space-x-1 [&>button]:py-1 [&>button]:px-2 [&>button]:rounded-full hover:[&>button]:brightness-95`,children:[o.jsx(UW,{}),s&&o.jsx(GW,{variant:e})]}),o.jsx("button",{onClick:l,className:"p-1 flex-shrink-0",children:o.jsx(Mi,{className:"w-[20px]"})})]});return o.jsx("div",{className:"flex items-center space-x-2 h-[44px] mb-3",children:a?u:t})}function y1(){const t=rn();return ae(dt),{getRecommend:async n=>{try{console.log("getRecommend"),t(zS(!0));const r=n.genres.map(l=>V(`genre_map.${l.id}`,"==",!0),nu(20)),s=V(Bs(),"!=",n.id),i=_e(Tn,...r,s),a=await In(i);t(_m({songs:a})),t(zS(!1))}catch{}}}}function QW(){const{isFetching:t,songMap:e,...n}=hW(),{handleSetSong:r}=Us({variant:"songs"}),{getRecommend:s}=y1(),i=a=>{r(a.queue_id,[a]),s(a)};return o.jsx(o.Fragment,{children:o.jsxs("div",{children:[o.jsx(xe,{title:"Song"}),o.jsx("div",{className:"flex space-x-1 my-2 p-1",children:o.jsx(us,{render:a=>a,...n})}),o.jsxs(Nr,{children:[o.jsx(hp,{variant:"system-song",children:o.jsx("p",{className:"font-[500] opacity-[.5]",children:"Songs"})}),t&&ll,!t&&o.jsx(Vs,{songs:e[n.tab].songs,setSong:a=>i(a)})]})]})})}function KW(){const{user:t}=fe(),[e,n]=f.useState([]),[r,s]=f.useState(!0);return{isFetching:r,recentPlaylists:e,getRecentPlaylist:async()=>{try{if(t){if(t.recent_song_ids.length){const a=_e(jr,V(Bs(),"in",t.recent_song_ids)),l=await is(a);n(l)}}else{const a=cn()["recent-playlists"]||[];n(a)}}catch(a){console.log({message:a})}finally{s(!1)}}}}function XW(){const{currentSongData:t}=ae(dt),e=f.useRef(!1),{isFetching:n,getRecentPlaylist:r,recentPlaylists:s}=KW();f.useEffect(()=>{e.current||(e.current=!0,r())},[]);const i={playlistItem:"w-1/4 p-[8px] max-[800px]:w-1/2"},a=()=>s.map((l,c)=>{const u=t==null?void 0:t.song.queue_id.includes(l.id);return o.jsx("div",{className:i.playlistItem,children:o.jsx(bv,{active:u,data:l})},c)});return n?o.jsx("div",{className:"flex flex-row flex-wrap -mx-[8px] ",children:_v}):s.length?o.jsx(o.Fragment,{children:o.jsxs("div",{children:[o.jsx(xe,{title:"Recent listening"}),o.jsx("div",{className:"flex flex-row flex-wrap -mx-[8px] ",children:a()})]})}):o.jsx(o.Fragment,{})}function fp(){const{user:t}=fe(),[e,n]=f.useState(!1);return{isFetching:e,action:async s=>{try{switch(n(!0),s){case"login":{await zz(Ia,tW);break}case"logout":{await UC(Ia);break}}n(!1)}catch(i){throw i}finally{n(!1)}},user:t}}function YW(){const{theme:t}=O(),{loading:e,user:n}=fe(),{action:r}=fp(),s=async()=>{try{await r("login")}catch(a){console.log(a)}finally{}},i={icon:"w-7 mr-2 inline",linkItem:`py-3 border-b text-lg border-${t.alpha} last:border-none`,button:`${t.content_bg} rounded-full`};return o.jsxs("div",{className:"block md:hidden",children:[o.jsx(xe,{title:"Library",className:"mb-1"}),e?[...Array(3).keys()].map(a=>o.jsx(II,{},a)):o.jsx(o.Fragment,{children:n?o.jsxs(o.Fragment,{children:[o.jsx(tg,{to:"/my-music",className:i.linkItem,icon:o.jsx(Da,{className:i.icon+t.content_text}),label:"All songs",arrowIcon:o.jsx(Kd,{className:"w-6"})}),o.jsx(tg,{to:"/my-music",className:i.linkItem,icon:o.jsx(Kf,{className:i.icon+t.content_text}),label:"Favorite",arrowIcon:o.jsx(Kd,{className:"w-6"})}),o.jsx(tg,{to:"/my-music",className:i.linkItem,icon:o.jsx(SI,{className:i.icon+t.content_text}),label:"Recent",arrowIcon:o.jsx(Kd,{className:"w-6"})})]}):o.jsxs(ee,{onClick:s,className:`${t.content_bg} rounded-md`,children:[o.jsx(ov,{className:"w-7"}),o.jsx("span",{className:"font-playwriteCU leading-[2.2]",children:"Login"})]})})]})}function JW(){const{theme:t}=O(),{loading:e,user:n}=fe(),r=f.useRef(null),{action:s}=fp(),[i,a]=f.useState(""),l=()=>{var m;return(m=r.current)==null?void 0:m.toggle()},c=m=>{var p;a(m),(p=r.current)==null||p.toggle()},u=async()=>{try{await s("logout")}catch(m){console.log("signOut error",{message:m})}finally{l()}},d=f.useMemo(()=>{switch(i){case"theme":return o.jsx(wv,{close:l});case"info":return o.jsx(vv,{close:l});case"logout":return o.jsx(Li,{close:l,callback:u,loading:!1,label:"Log out ?"})}},[i]),h={linkItem:`py-3 text-lg w-full border-b border-${t.alpha} space-x-2 last:border-none flex items-center`,icon:"w-7"};return o.jsxs("div",{className:"md:hidden",children:[o.jsx("div",{className:"text-xl font-playwriteCU leading-[2.2] mb-3",children:"Setting"}),n&&o.jsxs("div",{className:`bg-${t.alpha} p-3 rounded-md flex mb-3`,children:[o.jsx($y,{className:"h-[65px] w-[65px]"}),o.jsxs("div",{className:"ml-3",children:[o.jsx("p",{className:"text-lg font-[500]",children:n.display_name}),o.jsx("p",{className:"opacity-70 font-[500]",children:"Vip member ❤️"})]})]}),e?[...Array(3).keys()].map(m=>o.jsx(II,{},m)):o.jsxs("div",{className:"",children:[o.jsxs("button",{className:h.linkItem,onClick:()=>c("theme"),children:[o.jsx(J0,{className:h.icon}),o.jsx("span",{children:"Theme"})]}),o.jsxs("button",{className:h.linkItem,onClick:()=>c("info"),children:[o.jsx(Y0,{className:h.icon}),o.jsx("span",{children:"Info"})]}),(n==null?void 0:n.role)==="ADMIN"&&o.jsxs(we,{to:"/dashboard",className:h.linkItem,children:[o.jsx(dv,{className:h.icon}),o.jsx("span",{children:"Dashboard"})]}),n&&o.jsxs("button",{className:h.linkItem,onClick:()=>c("logout"),children:[o.jsx(ov,{className:h.icon}),o.jsx("span",{children:"Logout"})]})]}),o.jsx(Ee,{ref:r,variant:"animation",children:d})]})}function ZW(){return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"space-y-5",children:[o.jsx(YW,{}),o.jsx(XW,{}),o.jsx(uW,{}),o.jsx(QW,{}),o.jsx(JW,{})]}),o.jsx(zf,{})]})}function eN(){const{user:t,updateUserData:e}=fe();return{updatePlaylist:async r=>{if(t){if(!t.recent_playlist_ids.find(i=>i===r.id)){const a={recent_playlist_ids:[...t.recent_playlist_ids,r.id]};await Qt({collectionName:"Users",data:a,id:t.email}),e(a)}}else{const s=cn()["recent-playlists"]||[];s.find(a=>a.id===r.id)||(s.push(r),lt("recent-playlists",s))}}}}const eq=o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"h-[30px] mb-[10px] flex items-center",children:o.jsx(te,{className:"h-[20px] w-[90px]"})}),ll]});function tq({variant:t,loading:e}){const{playlistSongs:n,currentPlaylist:r}=ae(vl),{handleSetSong:s}=Us({variant:"playlist"}),{updatePlaylist:i}=eN(),a=l=>{if(!r)return;s(l.queue_id,n)&&i(r)};return e?eq:o.jsx(o.Fragment,{children:o.jsxs(Nr,{children:[!!n.length&&o.jsx(hp,{variant:t==="others-playlist"?"system-song":"own-playlist",children:o.jsxs("p",{className:"font-[500] opacity-[.5]",children:[n.length," Songs"]})}),o.jsx(Vs,{songs:n,setSong:l=>a(l),songVariant:t==="my-playlist"?"own-playlist":"system-song"})]})})}function Dg({onClick:t,children:e,text:n}){const{theme:r}=O(),{playlistSongs:s}=ae(vl);return o.jsxs(ee,{onClick:t,disabled:!s.length,size:"clear",className:`rounded-full px-5 py-1 ${r.content_bg}`,children:[e,o.jsx("span",{className:"font-playwriteCU leading-[2.2]",children:n})]})}function nq(){const t=rn(),{currentPlaylist:e,playlistSongs:n}=ae(vl),{currentSongData:r}=ae(dt),{playStatus:s}=ae(Kn),{handleSetSong:i}=Us({variant:"playlist"}),{updatePlaylist:a}=eN(),l=()=>{if(!e)return;const u=n[0];i(u.queue_id,n)&&a(e)},c=()=>{switch(s){case"playing":return t(Ze({triggerPlayStatus:"paused"}));case"paused":return t(Ze({triggerPlayStatus:"playing"}))}};if(f.useEffect(()=>{t(Ze({triggerPlayStatus:s}))},[s]),!e)return o.jsx(o.Fragment,{});if(r!=null&&r.song.queue_id.includes(e.id))switch(s){case"playing":case"waiting":return o.jsx(Dg,{text:"Pause",onClick:c,children:o.jsx(Yf,{className:"w-7 mr-1"})});case"loading":case"paused":return o.jsx(Dg,{text:"Continue",onClick:c,children:o.jsx(Pc,{className:"w-7 mr-1"})})}return o.jsx(Dg,{text:"Play",onClick:l,children:o.jsx(Pc,{className:"w-7 mr-1"})})}function rq({isLiked:t,playlist:e,className:n="p-1.5"}){const{theme:r}=O(),{action:s,isFetching:i}=up(),a={button:`bg-${r.alpha} hover:brightness-90 rounded-full w-[40px] flex justify-center`};return o.jsx("button",{onClick:()=>s({variant:"like",playlist:e}),className:` ${a.button} ${n}`,children:i?o.jsx(Lt,{className:"w-5 animate-spin"}):o.jsx(o.Fragment,{children:t?o.jsx(xv,{className:`w-5 ${r.content_text}`}):o.jsx(Kf,{className:"w-5"})})})}function sq(){return o.jsx(o.Fragment,{children:o.jsx(tN,{children:o.jsx(o1,{})})})}function iq(){const{currentPlaylist:t}=ae(vl),{close:e}=mr(),[n,r]=f.useState(""),s=f.useRef(null),{action:i,isFetching:a}=up(),l=h=>{var m;r(h),e(),(m=s.current)==null||m.open()},c=()=>{var h;return(h=s.current)==null?void 0:h.close()},u=async(h,m)=>{t&&(await i({variant:"edit",playlist:t,data:h,imageFile:m}),c())},d=()=>{if(!t)return o.jsx(o.Fragment,{});switch(n){case"":return o.jsx(o.Fragment,{});case"edit":return o.jsx(wl,{isLoading:a,playlist:t,submit:u,variant:"edit",close:c});case"delete":return o.jsx(Li,{loading:a,label:`Delete playist ' ${t.name} ' ?`,callback:()=>i({variant:"delete",playlist:t}),close:c})}};return o.jsxs(o.Fragment,{children:[o.jsxs(tN,{children:[o.jsx(o1,{}),o.jsxs("button",{onClick:()=>l("edit"),children:[o.jsx(Oa,{className:"w-5"}),o.jsx("span",{children:"Edit"})]}),o.jsxs("button",{onClick:()=>l("delete"),children:[o.jsx(Gn,{className:"w-5"}),o.jsx("span",{children:"Delete"})]})]}),o.jsx(Ee,{variant:"animation",ref:s,children:d()})]})}function tN({children:t}){return o.jsx(fr,{className:"left-[calc(100%)] bottom-full w-[120px]",animationClassName:"origin-top-left",appendTo:"parent",children:o.jsx(qj,{children:o.jsx(xl,{children:t})})})}function aq({variant:t}){const{theme:e}=O(),[n,r]=f.useState(!1),s=f.useRef(null);return o.jsx(o.Fragment,{children:o.jsxs(dr,{children:[o.jsx(hr,{setIsOpenParent:r,ref:s,children:o.jsx(ee,{size:"clear",className:`rounded-full p-2.5 ${n?e.content_bg:"bg-"+e.alpha} $
            } `,children:o.jsx(mu,{className:"w-5"})})}),t==="others-playlist"?o.jsx(sq,{}):o.jsx(iq,{})]})})}function oq({playlist:t,showSkeleton:e,isLiked:n,variant:r}){const{theme:s}=O(),{currentSongData:i}=ae(dt),a=t?i==null?void 0:i.song.queue_id.includes(`${t.id}`):!1,l={container:"flex flex-col md:flex-row lg:flex-col",smallText:"text-xs"},c=()=>t?o.jsxs(o.Fragment,{children:[o.jsx(we,{className:`hover:underline ${s.content_hover_text} ${l.smallText}`,to:`/singer/${t.singers[0].id}}`,children:t.singers[0].name}),o.jsxs("p",{className:l.smallText,children:[t.like," likes"]})]}):o.jsx(o.Fragment,{}),u=()=>{if(!t)return o.jsx(o.Fragment,{});switch(r){case"my-playlist":return o.jsx("p",{className:l.smallText,children:t.is_public?"Public":"Private"});case"others-playlist":return o.jsxs(o.Fragment,{children:[o.jsxs("p",{className:l.smallText,children:[t.like," likes"]}),o.jsx("p",{className:l.smallText,children:t.singers.map((d,h)=>o.jsx("span",{children:(h?", ":"")+d.name}))}),o.jsxs("p",{className:l.smallText,children:["Last update:"," ",lD(t.updated_at,{type:"date"})]})]})}};return o.jsx(o.Fragment,{children:o.jsxs("div",{className:l.container,children:[o.jsx("div",{className:"w-full flex-shrink-0 px-10 md:w-1/3 md:px-0 lg:w-full",children:e?o.jsx(te,{className:"pt-[100%] rounded-lg"}):t&&o.jsx(bv,{data:t,active:a,variant:"image"})}),o.jsxs("div",{className:"flex flex-col text-center mt-3 md:text-left md:ml-5 md:mt-0 lg:ml-0 lg:mt-3 lg:text-center",children:[e?o.jsxs("div",{className:"space-y-1 my-3",children:[o.jsx(te,{className:"h-[24px] w-[170px]"}),o.jsx(te,{className:"h-[17px] w-[170px]"}),o.jsx(te,{className:"h-[17px] w-[60px]"}),o.jsx(te,{className:"h-[17px] w-[100px]"})]}):t&&o.jsxs(o.Fragment,{children:[o.jsx("p",{className:"text-xl font-[600] leading-[1.2]",children:t.name}),o.jsx("div",{className:"flex-col items-center flex mt-2.5 text-[#666]",children:t.is_album?c():u()})]}),t&&o.jsxs("div",{className:"flex flex-col items-center md:flex-row md:mt-auto lg:flex-col lg:mt-3",children:[o.jsx(nq,{}),o.jsxs("div",{className:"flex space-x-3 mt-3 md:ml-3 md:mt-0 lg:mt-3 lg:ml-0",children:[o.jsx(aq,{variant:r}),r!=="my-playlist"&&n!==null&&o.jsx(rq,{isLiked:n,playlist:t})]})]})]})]})})}function nN(){const{behind:t,ahead:e,shouldStoreLocation:n,setBehind:r,setAhead:s}=lI(),i=qn(),a=nn(),l=f.useMemo(()=>i.pathname+i.search,[i]);return{ahead:e,behind:t,backward:()=>{const h=[...t],m=h.pop();m&&(n.current=!1,s(p=>[...p,l]),r(h),a(m))},forward:()=>{const h=[...e],m=h.pop();m&&(n.current=!1,r(p=>[...p,l]),s(h),a(m))},goHome:()=>{a("/")}}}function Vu({className:t=""}){const{backward:e,behind:n,goHome:r}=nN(),s=()=>{n.length?e():r()};return o.jsx(ee,{onClick:s,className:`p-1.5 md:hidden z-[9] relative ${t}`,color:"primary",size:"clear",children:n.length?o.jsx(_I,{className:"w-6"}):o.jsx(Xf,{className:"w-6"})})}function lq(){const{currentPlaylist:t}=ae(vl),{user:e}=fe(),n=e&&t?t.owner_email===e.email&&!t.is_official:!1,r=e?t?e.liked_playlist_ids.includes(t.id):!1:null,{isFetching:s}=RW();return!s&&!t?o.jsx(ur,{children:o.jsx(Xe,{variant:"with-home-button"})}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"mb-5",children:o.jsx(Vu,{})}),o.jsxs("div",{className:"lg:flex lg:-mx-3",children:[o.jsx("div",{className:"w-full lg:w-1/4 lg:px-3",children:o.jsx(oq,{showSkeleton:s,variant:n?"my-playlist":"others-playlist",playlist:t,isLiked:r})}),o.jsx("div",{className:"w-full lg:w-3/4 lg:px-3",children:o.jsx("div",{className:"mt-[30px] lg:mt-0",children:o.jsx(tq,{loading:s,variant:n?"my-playlist":"others-playlist"})})})]}),o.jsx(zf,{})]})}function rN({tab:t}){const{user:e}=fe(),{setUploadedSongs:n,setFavoriteSongs:r,shouldFetchUserSongs:s,shouldFetchFavoriteSongs:i,favoriteSongs:a,uploadedSongs:l}=Cn(),{setErrorToast:c}=oe(),[u,d]=f.useState(!0),h=async()=>{if(e)try{switch(t){case"favorite":{if(i.current){if(i.current=!1,e.liked_song_ids.length){const m=_e(Tn,V(Bs(),"in",e.liked_song_ids)),p=await In(m),g=[];e.liked_song_ids.forEach(y=>{const _=p.find(w=>w.id===y);_&&g.push(_)}),r(g)}}else await Ns(100);break}case"uploaded":if(s.current){s.current=!1;const m=_e(Tn,V("owner_email","==",e.email),V("is_official","==",!1)),p=await In(m);n(p)}else await Ns(100)}}catch(m){console.log({message:m}),c()}finally{d(!1)}};return f.useEffect(()=>{h()},[]),{isFetching:u,uploadedSongs:l,favoriteSongs:a,user:e}}function cq(){const{handleSetSong:t}=Us({variant:"songs"}),{favoriteSongs:e,user:n,isFetching:r}=rN({tab:"favorite"}),s=i=>{t(i.queue_id,e)};if(n)return o.jsxs(Nr,{children:[o.jsx(hp,{variant:"favorite-song",children:r?o.jsx(te,{className:"h-[20px] w-[90px]"}):o.jsxs("p",{className:"font-[500] opacity-[.5]",children:[e.length," Songs"]})}),r&&ll,!r&&o.jsx(o.Fragment,{children:e.length?o.jsx(o.Fragment,{children:o.jsx(Vs,{setSong:s,songs:e})}):o.jsx(Xe,{})})]})}function uq({song:t}){return o.jsxs("div",{className:"flex items-center justify-between p-[10px]",children:[o.jsxs("div",{className:"flex-grow flex",children:[o.jsx(Da,{className:"w-[18px] mr-2.5"}),o.jsx("div",{className:"h-[54px] w-[54px] rounded overflow-hidden",children:o.jsx(ht,{src:t.image_url})}),o.jsxs("div",{className:"ml-[10px]",children:[o.jsx("h5",{className:"line-clamp-1 font-medium overflow-hidden",children:t.name}),o.jsx("p",{className:"opacity-[.7] leading-[1.2] line-clamp-1 text-sm",children:t.singers[0].name})]})]}),o.jsxs("div",{className:"flex space-x-1",children:[o.jsx(Lt,{className:"animate-spin w-5"}),o.jsx("p",{className:"text-sm",children:"Uploading..."})]})]})}function dq(){const{theme:t}=O(),{uploadingSongs:e,isUploading:n}=hI(),{handleSetSong:r}=Us({variant:"songs"}),{uploadedSongs:s,isFetching:i,user:a}=rN({tab:"uploaded"}),l=u=>{r(u,s)},c=f.useMemo(()=>i?0:e.length+s.length,[e,s,i]);return a?o.jsxs(Nr,{children:[o.jsx(hp,{variant:"uploaded-song",children:i?o.jsx(o.Fragment,{children:o.jsx("div",{className:"h-[30px] mb-[10px] flex items-center",children:o.jsx(te,{className:"h-[20px] w-[90px]"})})}):o.jsxs("div",{className:"flex justify-between items-center w-full",children:[o.jsxs("p",{className:"font-[500] opacity-[.5]",children:[c," Songs"]}),o.jsx("button",{disabled:n,children:o.jsxs("label",{className:`${t.content_bg} items-center space-x-1 hover:opacity-80 py-1 rounded-full flex px-4 cursor-pointer`,htmlFor:"song_upload",children:[o.jsx(lv,{className:"w-5"}),o.jsx("span",{className:"",children:"Upload"})]})})]})}),o.jsxs("div",{className:"",children:[i&&ll,!i&&o.jsx(o.Fragment,{children:c?o.jsxs(o.Fragment,{children:[!!s.length&&o.jsx(Vs,{setSong:u=>l(u.queue_id),songs:s,songVariant:"own-song"}),e.map((u,d)=>o.jsx(uq,{song:u},d))]}):o.jsx(Xe,{})})]})]}):o.jsx(o.Fragment,{})}function sN(){const{user:t}=fe(),{setPlaylists:e,shouldFetchUserPlaylists:n,playlists:r}=Cn(),{setErrorToast:s}=oe(),[i,a]=f.useState(!0);return{isFetching:i,playlists:r,user:t,setIsFetching:a,getPlaylist:async()=>{try{if(!t)return;if(a(!0),n.current){n.current=!1;const c=_e(jr,V(Bs(),"in",t.liked_playlist_ids)),d=(await is(c)).filter(h=>!h.is_official&&h.owner_email===t.email?!0:!!h.is_public);e(d)}else await Ns(100)}catch(c){console.log({message:c}),s()}finally{a(!1)}}}}function hq(){const{user:t}=fe(),{myMusicAddPlaylist:e,isFetching:n}=f1(),r=f.useRef(null),s=()=>{var a;return(a=r.current)==null?void 0:a.close()},i=async(a,l)=>{await e(a,l),s()};if(t)return o.jsxs(o.Fragment,{children:[o.jsxs(ee,{onClick:()=>{var a;return(a=r.current)==null?void 0:a.open()},size:"clear",className:"py-1 px-4",color:"primary",children:[o.jsx(cs,{className:"w-6"}),o.jsx("span",{children:"Add new playlist"})]}),o.jsx(Ee,{ref:r,variant:"animation",children:o.jsx(wl,{close:s,isLoading:n,variant:"add",user:t,submit:i})})]})}function fq(){const{isFetching:t,playlists:e,getPlaylist:n}=sN();return f.useEffect(()=>{n()},[]),o.jsx(o.Fragment,{children:o.jsxs("div",{children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx(xe,{title:"Playlist"}),o.jsx(hq,{})]}),o.jsx(yu,{loading:t,playlists:e})]})})}function mq(){const{user:t}=fe(),{shouldFetchUserSingers:e,setSingers:n,singers:r}=Cn(),{setErrorToast:s}=oe(),[i,a]=f.useState(!0);return{isFetching:i,singers:r,user:t,setIsFetching:a,getSinger:async()=>{try{if(!t)return;if(a(!0),e.current&&t.liked_singer_ids.length){e.current=!1;const c=_e(of,V(Bs(),"in",t.liked_singer_ids)),u=await lf(c);n(u)}else await Ns(100)}catch(c){console.log({message:c}),s()}finally{a(!1)}}}}function pq(){const{isFetching:t,singers:e,getSinger:n}=mq(),r=[...Array(3).keys()].map(s=>o.jsx(zy,{variant:"skeleton"},s));return f.useEffect(()=>{n()},[]),t?o.jsxs(o.Fragment,{children:[o.jsx(te,{className:"h-[48px] w-[160px]"}),o.jsx("div",{className:"flex flex-row flex-wrap -mx-2 mt-3",children:r})]}):!t&&!e.length?o.jsx(o.Fragment,{}):o.jsx(o.Fragment,{children:o.jsxs("div",{children:[o.jsx(xe,{title:"Singers"}),o.jsx("div",{className:"flex flex-row flex-wrap -mx-2 mt-3",children:e.map((s,i)=>o.jsx(zy,{variant:"singer-item",singer:s},i))})]})})}function gq(){const[t,e]=f.useState("Favorite");return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"space-y-5",children:[o.jsx(Vu,{}),o.jsx(fq,{}),o.jsx(pq,{}),o.jsxs("div",{children:[o.jsx(xe,{title:"Songs"}),o.jsx("div",{className:"flex space-x-2 my-3",children:o.jsx(us,{render:n=>n,setTab:e,tab:t,tabs:["Favorite","Uploaded"]})}),t==="Favorite"?o.jsx(cq,{}):o.jsx(dq,{})]})]}),o.jsx(zf,{})]})}const yq=()=>{const[t,e]=f.useState(),[n,r]=f.useState(""),[s,i]=f.useState([]),[a,l]=f.useState([]),[c,u]=f.useState(!1),[d,h]=f.useState(!1),[m,p]=f.useState(),g=f.useRef(0),y=f.useMemo(()=>m!==void 0?a[m]:void 0,[m,a]);return{song:t,setSong:e,baseLyric:n,setBaseLyric:r,baseLyricArr:s,setBaseLyricArr:i,lyrics:a,setLyrics:l,updateLyric:(w,x)=>{l(v=>{const S={...v[w],...x};return v[w]=S,[...v]})},isFetching:c,setIsFetching:u,isChanged:d,setIsChanged:h,start:g,selectLyricIndex:m,setSelectLyricIndex:p,currentLyric:y}},iN=f.createContext(null);function xq({children:t}){return o.jsx(iN.Provider,{value:yq(),children:t})}const pn=()=>{const t=f.useContext(iN);if(!t)throw new Error("Edit lyric context not found");return t};function vq({audioEle:t,isClickPlay:e,song:n}){const{start:r,baseLyricArr:s,lyrics:i,setLyrics:a,setIsChanged:l,setIsFetching:c,baseLyric:u}=pn(),{setErrorToast:d,setSuccessToast:h}=oe(),m=i.length>=s.length,p=e&&!!s.length&&!m,g=()=>{if(!t||!s.length||m||!n)return;const x=+t.currentTime.toFixed(1);if(r.current===x)return;const v=s[i.length],S=pb({start:r.current,end:x,text:v});if(r.current=x,a(E=>[...E,S]),s.length===i.length+2){const E=s[s.length-1],b=pb({start:r.current,end:n.duration,text:E});a(I=>[...I,b])}l(!0)},y=()=>{if(i.length&&t){const x=i[i.length-1].start;r.current=x,t.currentTime=x,a(v=>v.slice(0,-1)),l(!0)}},_=()=>{if(!n)return;const x={song_id:n.id,base:u,lyrics:JSON.stringify(i)};lt("temp-lyric",x)};return{addLyric:g,removeLyric:y,isEnableAddBtn:p,submit:async()=>{try{if(c(!0),!n)return;const x=Bu(Ie),v={lyrics:JSON.stringify(i),base:u},S=Jt(Ie,"Songs",n.id);if(n.lyric_id){const E=Jt(Ie,"Lyrics",n.lyric_id);x.update(E,v)}else{const E=Jt(rs(Ie,"Lyrics")),b={lyric_id:E.id,updated_at:Ko()};x.set(E,v),x.update(S,b)}await x.commit(),h("Edit lyric successful"),l(!1),lt("temp-lyric","")}catch(x){console.log({error:x}),d(),_()}finally{c(!1)}}}}function wq({closeModal:t}){const{setErrorToast:e,setSuccessToast:n}=oe(),{song:r,setSong:s}=pn(),[i,a]=f.useState(),[l,c]=f.useState(!1);return{songFile:i,song:r,setSongFile:a,isFetching:l,handleSubmit:async()=>{try{if(!i||!r)throw new Error;c(!0);const{filePath:d,fileURL:h}=await c1({file:i,folder:"/songs/",namePrefix:"beat"}),m={beat_url:h,beat_file_path:d};await Qt({collectionName:"Songs",id:r.id,data:m}),r.beat_file_path&&$n({filePath:r.beat_file_path}),s(()=>({...r,...m})),n("Upload song beat successful"),t()}catch(d){console.log({error:d}),e()}finally{c(!1)}}}}function _q({closeModal:t}){const{theme:e}=O(),{songFile:n,setSongFile:r,isFetching:s,handleSubmit:i,song:a}=wq({closeModal:t}),l=c=>{var u;(u=c.target.files)!=null&&u.length&&r(c.target.files[0])};return o.jsxs("div",{className:"w-[500px] max-w-[80vw] flex flex-col",children:[o.jsx($t,{title:"Song beat",close:t}),o.jsx("input",{onChange:l,type:"file",multiple:!0,accept:"audio",id:"song_upload",className:"hidden"}),a&&(n||(a==null?void 0:a.beat_url))&&o.jsx("audio",{src:n?URL.createObjectURL(n):a.beat_url,controls:!0}),o.jsx(ee,{size:"clear",children:o.jsx("label",{htmlFor:"song_upload",className:`${e.content_bg} seld-start rounded-full px-5 py-1.5 cursor-pointer mt-2`,children:o.jsx(lv,{className:"w-5"})})}),o.jsx(ee,{disabled:!n,onClick:i,isLoading:s,color:"primary",className:"mt-3 ml-auto font-playwriteCU",children:"Save"})]})}const Sq=40;function Eq({closeModal:t}){const{theme:e}=O(),{baseLyric:n,setBaseLyric:r,baseLyricArr:s,setIsChanged:i,lyrics:a}=pn(),[l,c]=f.useState(n),u=f.useRef(null),d=f.useRef(null),h=()=>{const p=l.split(/\r?\n/).filter(g=>g).filter(g=>g.trim()).join(`\r
`);r(p),i(!0),t()};function m(p){const g=[...s];return g[p]=`<div style="color: transparent; border-radius: 4px; background-color: ${e.content_code}">${g[p]}</div>`,g.join(`\r
`)}return f.useEffect(()=>{if(a.length&&u.current&&d.current){const p=Sq*(a.length-1);u.current.scrollTop=p,d.current.style.paddingBottom=p+"px"}},[]),f.useEffect(()=>{const p=()=>{if(u.current&&d.current){const g=u.current.scrollTop;d.current.scrollTop=g}};return u.current&&u.current.addEventListener("scroll",p),()=>{u.current&&u.current.removeEventListener("scroll",p)}},[]),o.jsxs("div",{className:"w-[500px] max-w-[85vw]",children:[o.jsx($t,{close:t,title:"Edit lyric"}),o.jsxs("div",{className:"relative h-[60vh] overflow-hidden rounded-md bg-white/10 ",children:[o.jsx("div",{ref:d,className:"whitespace-break-spaces text-transparent px-2 py-2 absolute leading-[40px] h-full overflow-auto top-0 left-0 w-full",dangerouslySetInnerHTML:{__html:m(a.length===s.length?a.length-1:a.length)}}),o.jsx("textarea",{style:{resize:"none"},ref:u,className:"absolute bg-transparent top-0 outline-none w-full leading-[40px] py-2 px-3 h-full no-scrollbar",value:l,onChange:p=>c(p.target.value)})]}),o.jsx("p",{className:"ml-auto mt-5",children:o.jsx(ee,{onClick:h,color:"primary",className:"rounded-full",children:"Save"})})]})}function bq(){const{theme:t}=O(),{song:e}=pn(),[n,r]=f.useState(""),s=f.useRef(null),i=f.useRef(null),a=u=>{var d,h;r(u),(d=s.current)==null||d.open(),(h=i.current)==null||h.close()},l=()=>{var u;return(u=s.current)==null?void 0:u.close()},c=()=>{if(n)switch(n){case"lyric":return o.jsx(Eq,{closeModal:l});case"tutorial":return o.jsxs("div",{className:"w-[500px] max-w-[90vw]",children:[o.jsx($t,{title:"Tutorial",close:l}),o.jsx("div",{className:"h-[500px] max-h-[75vh] overflow-y-auto no-scrollbar",children:o.jsx("img",{className:"w-full border rounded-[16px]",src:"",alt:""})})]});case"song-beat":return e&&o.jsx(_q,{closeModal:l})}};return o.jsxs(o.Fragment,{children:[o.jsxs(dr,{children:[o.jsx(hr,{ref:i,children:o.jsx(ee,{size:"clear",className:`${t.content_bg} h-[36px] w-[36px] justify-center rounded-full mt-2`,children:o.jsx(al,{className:"w-6"})})}),o.jsx(fr,{className:"top-[calc(100%+8px)] right-0 z-[9]",appendTo:"parent",children:o.jsx(qj,{className:"w-[120px]",children:o.jsxs(xl,{children:[o.jsxs("button",{onClick:()=>a("lyric"),children:[o.jsx(Oa,{className:"w-5"}),o.jsx("span",{children:"Edit lyric"})]}),o.jsxs("button",{onClick:()=>a("tutorial"),children:[o.jsx(EI,{className:"w-5"}),o.jsx("span",{children:"Tutorial"})]}),o.jsxs("button",{onClick:()=>a("song-beat"),children:[o.jsx(Da,{className:"w-5"}),o.jsx("span",{children:"Song beat"})]})]})})})]}),o.jsx(Ee,{variant:"animation",ref:s,children:c()})]})}function kq({audioEle:t},e){const{theme:n}=O(),{song:r,lyrics:s}=pn(),i=f.useRef(null),{backward:a,forward:l,handlePlayPause:c,pause:u,seek:d,status:h,isClickPlay:m}=d1({audioEle:t,progressLineRef:i}),{addLyric:p,removeLyric:g,isEnableAddBtn:y,submit:_}=vq({audioEle:t,isClickPlay:m,song:r});f.useImperativeHandle(e,()=>({seek:d,pause:u,submit:_}));const w=()=>{if(!m&&s.length){const S=s[s.length-1].end;t.currentTime=S}c()},x={button:`mt-2 ml-2 space-x-1 ${n.content_bg} rounded-full`,icon:"w-6",arrow:"before:content-[''] before:absolute before:-translate-x-1/2 before:left-[27px]  before:bottom-[calc(100%-1px)] before:z-[-1] before:border-8 before:border-transparent before:border-b-amber-800"},v=()=>{switch(h){case"error":return o.jsx(Gf,{className:"w-6"});case"playing":return o.jsx(Yf,{className:"w-6"});case"paused":return o.jsx(Pc,{className:"w-6"});case"waiting":return o.jsx(Lt,{className:"w-6 animate-spin"})}};return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex items-start flex-wrap -mt-2 -ml-2",children:[o.jsx(DI,{className:"mt-2 ml-2",audioEle:t,postLocalStorageKey:"edit_lyric"}),o.jsx(ee,{className:x.button,onClick:w,children:v()}),o.jsxs(ee,{disabled:!y,onClick:p,className:x.button,children:[o.jsx(ls,{className:"w-6"}),o.jsx("span",{children:"Add"})]}),o.jsxs(ee,{disabled:!s.length,onClick:g,className:x.button,children:[o.jsx(mv,{className:"w-6"}),o.jsx("span",{children:"Remove"})]}),o.jsxs(ee,{onClick:()=>a(2),className:x.button,children:[o.jsx(cv,{className:"w-6"}),o.jsx("span",{children:"2s"})]}),o.jsxs(ee,{onClick:()=>l(2),className:x.button,children:[o.jsx("span",{children:"2s"}),o.jsx(Qf,{className:"w-6"})]}),o.jsx("div",{className:"ml-auto",children:o.jsx(bq,{})})]}),o.jsx("div",{ref:i,style:{backgroundColor:"rgba(255,255,255,.3)"},className:"h-1 rounded-full mt-3 w-full"})]})}const Tq=f.forwardRef(kq);function Iq({lyric:t,openModal:e,seek:n,theme:r,isLast:s}){return o.jsx(o.Fragment,{children:o.jsxs("div",{className:"pt-[10px] last:mb-[30vh]",children:[o.jsx("button",{className:`text-[18px] ${r.content_hover_text}`,onClick:()=>n(t.start),children:ki(+t.start)}),o.jsxs("p",{className:"font-[700] select-none flex items-center",children:[t.text,o.jsx("button",{onClick:e,className:"ml-1",children:o.jsx(WM,{className:"w-5"})})]}),s&&t.end!==t.start&&o.jsx("button",{className:`${r.content_hover_text} pt-[10px]`,onClick:()=>n(t.end),children:ki(+t.end)})]})})}function Cq({text:t,className:e="",status:n,activeColor:r},s){const i=()=>{switch(n){case"coming":return"";case"active":return`${r||"text-[#ffed00]"} active-lyric`;case"done":return"disable"}};return f.useEffect(()=>{n==="active"&&scroll()},[n]),o.jsx("p",{ref:s,className:`${e} select-none  font-[700] ${i()}`,children:t})}const aN=f.forwardRef(Cq);function Rq(){const{lyrics:t}=pn(),e=f.useRef(null);return f.useEffect(()=>{e.current&&sI(e.current)},[t.length]),{activeLyricRef:e}}function Aq({controlRef:t,modalRef:e}){const{theme:n}=O(),{baseLyricArr:r,lyrics:s,setSelectLyricIndex:i,song:a}=pn(),{activeLyricRef:l}=Rq(),c=d=>{var h;(h=t.current)==null||h.seek(d)},u=d=>{var h;typeof d=="number"&&(i(d),(h=e.current)==null||h.open())};return o.jsx(o.Fragment,{children:o.jsxs("div",{className:`flex-grow  overflow-auto flex  no-scrollbar md:text-lg rounded-xl px-2 pt-3 mt-3 ${n.side_bar_bg}`,children:[o.jsx("div",{className:"w-1/2",children:r.length?o.jsx(o.Fragment,{children:r.map((d,h)=>{let m=h===s.length?"active":h<s.length?"done":"coming";return m==="done"&&h===r.length-1&&(m="active"),o.jsx(aN,{ref:m==="active"?l:null,activeColor:n.type==="light"?n.content_text:"",className:"pt-[38px] mr-[24px]",status:m,text:d},h)})}):o.jsx("p",{children:"..."})}),o.jsx("div",{className:"w-1/2 ",children:!!(s!=null&&s.length)&&a&&s.map((d,h)=>o.jsx(Iq,{openModal:()=>u(h),seek:c,lyric:d,isLast:h===s.length-1&&h!==r.length-1,theme:n},h))})]})})}function jq({audioRef:t}){const{user:e}=fe(),{baseLyric:n,setSong:r,song:s,setBaseLyricArr:i,setBaseLyric:a,setLyrics:l,isChanged:c,lyrics:u,setIsChanged:d,isFetching:h,start:m}=pn(),[p,g]=f.useState(!0),y=f.useRef(!1),_=Fa(),w=S=>{if(!S.length)return;const E=S.length-1;if(t.current){const b=S[E].end;m.current=b}},x=()=>{if(!s)return;const S={song_id:s.id,base:n,lyrics:JSON.stringify(u)};lt("temp-lyric",S)},v=async()=>{try{if(!_.id)throw new Error("");const S=await ss({collectionName:"Songs",id:_.id});if(!S.exists())throw new Error("");const E={...S.data(),id:S.id,queue_id:""};if(E.lyric_id){const b=await ss({collectionName:"Lyrics",id:E.lyric_id});if(b.exists()){const{base:I,lyrics:A}=b.data(),L=JSON.parse(A);a(I),l(L),w(L)}}r(E)}catch(S){console.log({message:S})}finally{g(!1)}};return f.useEffect(()=>{y.current||(y.current=!0,v())},[e]),f.useEffect(()=>{(()=>{if(!s)return;const{base:E,lyrics:b,song_id:I}=cn()["temp-lyric"]||{};if(I===s.id){const A=JSON.parse(b);a(E),l(A),w(A),d(!0)}})()},[s]),f.useEffect(()=>{if(!n)return;const S=n.split(/\r?\n/);i(S)},[n]),f.useEffect(()=>{if(!c)return;const S=E=>{E.preventDefault(),x()};return window.addEventListener("beforeunload",S),()=>{window.removeEventListener("beforeunload",S)}},[c,n,u]),{isFetching:p,song:s,isChanged:c,isSubmitting:h}}function oN(t,e){if(e.length===1&&e[0]===0)return[t];const n=[];let r=0;e.sort((s,i)=>s-i);for(const s of e)s>t.length||s<0||(n.push(t.substring(r,s)),r=s);return n.push(t.substring(r)),n}const Nq=["Edit","Record"];function Pq(){const[t,e]=f.useState(0),[n,r]=f.useState(),[s,i]=f.useState(""),[a,l]=f.useState([[]]),[c,u]=f.useState([]),[d,h]=f.useState(!1),[m,p]=f.useState("Edit"),[g,y]=f.useState("paused"),_=f.useRef(null),w=f.useRef(null),x=f.useRef(null),v=f.useRef(null),S=f.useRef(null),E=f.useRef(null),b=f.useRef(null),I=f.useRef(null),A=f.useRef(),L=f.useRef(!1),P=f.useRef(0),ce=f.useRef(0),K=f.useRef(0),Pe=f.useRef([]),ie=f.useRef([]),ke=f.useRef(!0),me=f.useRef(!1),Ge=f.useMemo(()=>s.split(" ").filter(q=>q.trim()),[s]),F=f.useMemo(()=>Ge.map((q,ue)=>({text:q,positions:a[ue]})),[s,a]),W=f.useMemo(()=>{const q=[];return F.forEach(ue=>{const Fe=oN(ue.text,ue.positions);q.push(...Fe)}),q.filter(ue=>ue)},[s,a]);return{eleRefs:{endTimeRangeRef:w,overlayRef:_,startTimeRangeRef:x,startRefText:v,endRefText:S,currentWordRef:E,growInputRef:b,tempWordRef:I},tabProps:{tab:m,setTab:p,tabs:Nq},eventRefs:{playWhenSpaceRef:ke,moveArrowToGrowRef:me},currentWords:Ge,currentWordsData:F,currentSplitWords:W,actuallyEndRef:P,playerRef:A,actuallyStartRef:ce,tempActuallyStartRef:K,wordsRatioRef:Pe,mergedGrowListRef:ie,isChangedRef:L,wordIndex:t,setWordIndex:e,growList:c,setGrowList:u,isOpenEditLyricModal:d,SetIsOpenEditLyricModal:h,setStatus:y,status:g,text:s,setText:i,cut:a,setCut:l,localLyricIndex:n,setLoacalLyricIndex:r}}const lN=f.createContext(null);function Fq({children:t}){return o.jsx(lN.Provider,{value:Pq(),children:t})}const At=()=>{const t=f.useContext(lN);if(!t)throw new Error("LyricEditorProvider not found");return t};function cN(t,e){const n=`lyric_${Uu(4)}`,r=document.querySelector("style");if(!r)return n;let s=`@keyframes ${n}{0%{width:0%}`;if(!t.length)return s+="100%{width:100%}}",r.innerText=s,n;let i=t.reduce((u,d)=>u+d,0);const a=[];let l=0,c=0;for(let u=0;u<e.length-1;u++){const d=e[u],h=t[u];c+=d,l+=h,a.push({progress:Math.round(l/i*100),width:c})}for(const u of a)s+=`${u.progress}%{width:${u.width}%}`;return s+="100%{width:100%}}",r.innerText=s,n}function Dq({audioEle:t}){const{eleRefs:e,actuallyEndRef:n,actuallyStartRef:r,tempActuallyStartRef:s,wordsRatioRef:i,mergedGrowListRef:a,status:l,setStatus:c}=At(),{play:u,pause:d,statusRef:h}=d1({audioEle:t,statusFromParent:l,setStatusFromParent:c}),{overlayRef:m}=e,p=()=>{d(),m.current&&(m.current.style.animation="none")},g=()=>{if(t.currentTime=r.current,!s.current&&m.current){const w=cN(a.current,i.current);m.current.style.animation=`${w} ${((n.current-r.current)/t.playbackRate).toFixed(2)}s linear`}u()},y=()=>{h.current==="paused"?g():p()},_=()=>{if(+t.currentTime.toFixed(1)>=n.current)return p()};return f.useEffect(()=>{if(t)return t.addEventListener("timeupdate",_),()=>{t.removeEventListener("timeupdate",_)}},[]),{handlePlayPause:y,_pause:p,_play:g,status:l}}function Oq({audioEle:t}){const{playerRef:e}=At(),{_play:n,_pause:r,handlePlayPause:s}=Dq({audioEle:t});return f.useEffect(()=>{e.current={handlePlayPause:s,pause:r,play:n}},[]),o.jsx(o.Fragment,{})}function Mq({audioEle:t}){const{tabProps:e}=At(),{theme:n}=O();return o.jsxs(o.Fragment,{children:[o.jsx(Oq,{audioEle:t}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx(us,{className:"bg-white/10",...e,render:r=>r}),o.jsx(DI,{positions:"left",bg:n.content_bg,className:"bg-transparent hover:bg-white/10",audioEle:t,postLocalStorageKey:"edit_lyric_tune"})]})]})}function Lq(){const{updateLyric:t,setIsChanged:e,selectLyricIndex:n}=pn(),{actuallyEndRef:r,actuallyStartRef:s,growList:i,text:a,cut:l}=At();return{updateLyricTune:async()=>{if(typeof n!="number")throw new Error("selectLyricIndex is undefine");const u={tune:{start:s.current,end:r.current,grow:i},cut:l,text:a};t(n,u),e(!0)}}}function $q({closeModal:t}){const{setSelectLyricIndex:e,selectLyricIndex:n,lyrics:r}=pn(),{isChangedRef:s,playerRef:i}=At(),{updateLyricTune:a}=Lq(),l=()=>{a(),t()},c=u=>{var d;if(typeof n=="number")switch(s.current&&(s.current=!1,a()),(d=i.current)==null||d.pause(),u){case"next":if(n===r.length-1)return;e(h=>h+1);break;case"prev":if(n===0)return;e(h=>h-1);break}};return o.jsxs("div",{className:"flex justify-end space-x-2 mt-5 ",children:[o.jsxs(ee,{color:"primary",disabled:n===0,onClick:()=>c("prev"),className:"font-playwriteCU",children:[o.jsx(cv,{className:"w-6"}),o.jsx("span",{children:"Previous"})]}),o.jsxs(ee,{color:"primary",disabled:n===r.length-1,onClick:()=>c("next"),className:"font-playwriteCU",children:[o.jsx("span",{children:"Next"}),o.jsx(Qf,{className:"w-6"})]}),o.jsx(ee,{disabled:!s.current,color:"primary",onClick:l,className:"font-playwriteCU",children:"Ok"})]})}function zq(){const{isOpenEditLyricModal:t,playerRef:e,eleRefs:{currentWordRef:n},eventRefs:r}=At(),s=a=>{var l;if(a.key===" "){if(!r.playWhenSpaceRef.current)return;a.preventDefault(),(l=e.current)==null||l.handlePlayPause()}if(a.key==="ArrowRight"||a.key==="ArrowLeft"){if(!r.moveArrowToGrowRef.current)return;const c=n.current;if(!c)return;switch(a.key){case"ArrowRight":a.preventDefault(),c!=null&&c.nextSibling&&(c==null?void 0:c.nextSibling).click();break;case"ArrowLeft":a.preventDefault(),c!=null&&c.previousSibling&&(c==null?void 0:c.previousSibling).click();break}}},i=a=>{if(!r.moveArrowToGrowRef.current)return;const l=a.target,c=document.querySelectorAll(".word-item");let u=!1;c.forEach(d=>d.contains(l)?u=!0:{}),!u&&(r.moveArrowToGrowRef.current=!1)};f.useEffect(()=>(window.addEventListener("mousedown",i),window.addEventListener("keydown",s),()=>{window.removeEventListener("mousedown",i),window.removeEventListener("keydown",s)}),[t])}const uN=t=>{const e=t.clientWidth,n=[];return t.childNodes.forEach(r=>{n.push(Math.round(r.offsetWidth/e*100))}),n};function x1(t,e,n){const r=[];if(!n.length)return[];let s=0;return t.forEach((i,a)=>{const l=e[a].length;if(l===0)r.push(n[s]),s++;else if(l>0){const u=n.slice(s,s+l+1).reduce((d,h)=>(s++,+(d+h).toFixed(1)),0);r.push(u)}}),r}function Bq(){const{selectLyricIndex:t,currentLyric:e}=pn(),{eleRefs:n,actuallyEndRef:r,mergedGrowListRef:s,actuallyStartRef:i,wordsRatioRef:a,setGrowList:l,setCut:c,setText:u,currentWords:d}=At(),{tempWordRef:h,endTimeRangeRef:m,startTimeRangeRef:p,startRefText:g,endRefText:y}=n;f.useEffect(()=>{if(!h.current)return;const _=uN(h.current);a.current=_},[d]),f.useEffect(()=>{if(!e)return;const _=e.tune.grow,w=e.text.split(" ").filter(v=>v.trim());u(e.text),c(e.cut);const x=x1(w,e.cut,_);l(_),s.current=x,y.current&&g.current&&p.current&&m.current&&(i.current=e!=null&&e.tune?e.tune.start:e.start,g.current.innerText=`${e.start} / ${i.current}`,p.current.max=e.end+"",p.current.value=i.current+"",r.current=e!=null&&e.tune?e.tune.end:e.end,y.current.innerText=`${r.current} / ${e.end}`,m.current.max=e.end+"",m.current.value=r.current+"")},[t])}function Uq({audioEle:t}){const{playerRef:e,isChangedRef:n,tabProps:{tab:r,setTab:s},setGrowList:i,cut:a,actuallyStartRef:l,mergedGrowListRef:c,currentSplitWords:u,currentWords:d}=At(),[h,m]=f.useState(!1),[p,g]=f.useState([]),y=f.useRef(Date.now()),_=f.useRef(!1),w=f.useRef(!1),x=()=>{const K=+((Date.now()-y.current)/1e3).toFixed(1);g(Pe=>[...Pe,K])},v=()=>{var K;y.current=Date.now(),_.current||(_.current=!0,(K=e.current)==null||K.play(),m(!0))},S=()=>{_.current&&x()},E=K=>{K.key===" "&&(w.current||(K.preventDefault(),w.current=!0,v()))},b=K=>{K.key===" "&&(K.preventDefault(),S(),w.current=!1)},L={onPointerDown:()=>{v()},onPointerUp:()=>{S()}},P=()=>{var K;(K=e.current)==null||K.pause(),_.current=!1,g([]),m(!1)},ce=()=>{n.current=!0,i(p);const K=x1(d,a,p);c.current=K,s("Edit"),P()};return f.useEffect(()=>{p.length===u.length&&ce()},[p]),f.useEffect(()=>{var K;if(r==="Record")return(K=e.current)==null||K.pause(),window.addEventListener("keydown",E),window.addEventListener("keyup",b),t.currentTime=l.current,()=>{var Pe;(Pe=e.current)==null||Pe.pause(),window.removeEventListener("keydown",E),window.removeEventListener("keyup",b)}},[r]),{localGrowList:p,buttonProps:L,clear:P,isRecording:h}}function Vq({audioEle:t}){const{currentSplitWords:e}=At(),{buttonProps:n,localGrowList:r,isRecording:s,clear:i}=Uq({audioEle:t});return o.jsxs(o.Fragment,{children:[o.jsx(ee,{disabled:!s,size:"clear",className:"p-1.5",onClick:i,color:"primary",children:o.jsx(Mi,{className:"w-6"})}),o.jsxs("div",{className:"h-[240px] flex flex-col justify-center",children:[o.jsx("div",{className:"md:text-xl font-[700]",children:e.map((a,l)=>o.jsxs("span",{className:`${l<r.length?"text-[#ffed00]":""} leading-[1]`,children:[a," "]},l))}),o.jsx("p",{className:"mt-5 text-center md:hidden",children:o.jsx(ee,{...n,color:"primary",children:"Record"})})]})]})}function Hq(){const{currentLyric:t}=pn(),{eleRefs:e,isChangedRef:n,actuallyEndRef:r,actuallyStartRef:s,tempActuallyStartRef:i,setGrowList:a}=At(),{startRefText:l,endRefText:c}=e;return{setEndPoint:p=>{if(!t)return;const g=+p.toFixed(1);n.current=!0,r.current=g,c.current&&(c.current.textContent=`${g} / ${t.end}`),i.current&&(r.current=g,s.current=g-1)},setStartPoint:p=>{if(!t)return;const g=+p.toFixed(1);n.current=!0,s.current=g,l.current&&(l.current.textContent=`${t.start} / ${g}`)},endTimeRangeProps:{onFocus:()=>{i.current=s.current,s.current=r.current-1},onBlur:()=>{s.current=i.current,i.current=0}},handleGrowWord:p=>{p.variant==="range"&&p.value<1||(n.current=!0,a(g=>{const y=[...g];let _=y[p.index];switch(p.variant){case"range":_=p.value;break;case"button":_=+(p.action==="minus"?_-.2:_+.2).toFixed(1)}return y[p.index]=_,y}))}}}function Wq(){const{setStartPoint:t,setEndPoint:e,endTimeRangeProps:n,handleGrowWord:r}=Hq(),{currentLyric:s}=pn(),{wordIndex:i,growList:a,eleRefs:l}=At();return s?o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center mt-5 space-x-2",children:[o.jsxs("label",{htmlFor:"start",className:"flex-shrink-0 w-[150px]",children:["Start: ",o.jsx("span",{ref:l.startRefText})]}),o.jsx("input",{ref:l.startTimeRangeRef,type:"range",id:"start",min:s.start,max:s.end,step:.2,className:"w-full",onChange:c=>t(+c.target.value)})]}),o.jsxs("div",{className:"flex items-center mt-3 space-x-2",children:[o.jsxs("label",{htmlFor:"end",className:"flex-shrink-0 w-[150px]",children:["End: ",o.jsx("span",{ref:l.endRefText})]}),o.jsx("input",{id:"end",ref:l.endTimeRangeRef,type:"range",min:s.start,step:.2,className:"w-full",onChange:c=>e(+c.target.value),...n})]}),o.jsxs("div",{className:"flex items-center mt-3",children:[o.jsxs("label",{htmlFor:"grow",className:"flex-shrink-0 w-[150px] mr-2 leading-[1]",children:["Grow: ",a[i]]}),o.jsx("input",{ref:l.growInputRef,type:"range",id:"grow",min:0,max:30,step:.2,className:"w-full",value:a[i]+"",onChange:c=>r({variant:"range",value:+c.target.value,index:i})})]})]}):o.jsx(o.Fragment,{})}function qq(){const{eleRefs:t,eventRefs:e,setText:n,mergedGrowListRef:r,setCut:s,setGrowList:i,text:a}=At(),[l,c]=f.useState(!1),u=f.useRef(null),d=()=>{if(!u.current)return;const h=u.current.value.split(/\r?\n/).filter(g=>g).map(g=>g.trim()).join(" ").split(" ").filter(g=>g).join(" ");n(h);const m=h.split(" ").map(()=>0),p=h.split(" ").map(()=>[]);s(p),i(m),r.current=m,c(!1)};return f.useEffect(()=>{l?(e.playWhenSpaceRef.current=!1,e.moveArrowToGrowRef.current=!1,u.current&&(u.current.value=a)):(e.playWhenSpaceRef.current=!0,e.moveArrowToGrowRef.current=!0)},[l]),o.jsxs("div",{className:"mt-3 relative pt-5",children:[o.jsx("div",{className:"absolute top-0 right-0 flex justify-end w space-x-2 hover:[&>button]:bg-black/10 [&>button]:rounded-full [&>button]:p-1",children:l?o.jsxs(o.Fragment,{children:[o.jsx("button",{onClick:()=>c(!1),children:o.jsx(Mi,{className:"w-5"})}),o.jsx("button",{onClick:d,children:o.jsx(pu,{className:"w-5"})})]}):o.jsx("button",{onClick:()=>c(!0),children:o.jsx(Oa,{className:"w-5"})})}),o.jsx("div",{className:"flex justify-center",children:l?o.jsx("textarea",{ref:u,className:`${Sv} w-full mt-3 bg-white/10`}):o.jsx(o.Fragment,{children:o.jsxs("div",{className:"relative whitespace-nowrap  sm:text-2xl font-[700]",children:[a,o.jsx("div",{ref:t.overlayRef,className:"absolute  top-0 left-0 overflow-hidden text-[#ffed00] whitespace-nowrap w-0",children:a})]})})})]})}function Gq({text:t,openModal:e,isShowScissor:n,index:r}){const{theme:s}=O(),{growList:i,setWordIndex:a,wordIndex:l,eventRefs:c,eleRefs:u}=At(),d=l===r,h=()=>{var m;r!==-1&&(a(r),c.moveArrowToGrowRef.current=!0,(m=u.growInputRef.current)==null||m.focus())};return o.jsxs("div",{ref:m=>d?u.currentWordRef.current=m:{},style:{flexGrow:i[r]!==0?i[r]:1},onClick:h,className:`word-item cursor-pointer relative rounded-full flex items-center justify-center border ${s.content_border} ${d?s.content_bg:"bg-"+s.alpha}`,children:[o.jsx("span",{children:t}),n&&d&&o.jsx(ee,{onClick:e,size:"clear",className:"!absolute bottom-0 translate-y-[16px] bg-black/10 p-1.5",children:o.jsx(bI,{className:"w-5"})})]})}function Qq({wordData:t,wordIndex:e,closeModal:n}){const{theme:r}=O(),{currentLyric:s,selectLyricIndex:i}=pn(),{setCut:a,cut:l}=At(),[c,u]=f.useState(t.positions),d=f.useMemo(()=>oN(t.text,c).filter(g=>g),[c]),h=f.useMemo(()=>t.text.split(""),[]),m=g=>{const y=[...c],_=c.findIndex(w=>w===g);_===-1?y.push(g):y.splice(_,1),u(y)},p=()=>{if(!s||i===void 0)return;const g=c.sort((_,w)=>_-w),y=[...l];y[e]=g,a(y),n()};return o.jsxs("div",{className:"w-[500px] max-w-[90vw]",children:[o.jsx(xe,{title:"Split word "}),o.jsx("div",{className:"flex justify-center space-x-5",children:d.map((g,y)=>o.jsx("span",{className:"text-xl md:text-2xl font-[700]",children:g},y))}),o.jsx("div",{className:"mt-3 flex justify-center",children:h.map((g,y)=>{const _=c.includes(y);return o.jsxs("div",{children:[h.length>1&&y?o.jsx("button",{onClick:()=>m(y),className:` p-1 rounded-full ${_?r.content_bg:"hover:bg-black/10"}`,children:o.jsx(bI,{className:"w-5"})}):"",o.jsx("span",{className:"text-[50px] font-[500]",children:g})]},y)})}),o.jsx("p",{className:"mt-5 text-right",children:o.jsx(ee,{onClick:p,color:"primary",className:"font-playwireCU",children:"OK"})})]})}function Kq(){const{currentSplitWords:t,currentWordsData:e,currentWords:n}=At(),[r,s]=f.useState(),i=f.useRef(null),a=f.useMemo(()=>{const u={},d=e.map(m=>m.positions.length);let h=0;return d.forEach((m,p)=>{m===0?(u[h]=p,h++):m>0&&[...Array(m+1).keys()].forEach(()=>{u[h]=p,h++})}),u},[e]),l=f.useMemo(()=>r!==void 0?e[r]:void 0,[r,e]),c=u=>{var d;s(u),(d=i.current)==null||d.open()};return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"flex h-[44px] mt-5",children:t.map((u,d)=>{const h=a[d],m=n[h];return o.jsx(Gq,{isShowScissor:m?m.length>1:!1,index:d,openModal:()=>c(h),text:u},d)})}),o.jsx(Ee,{variant:"animation",ref:i,children:l&&r!==void 0&&o.jsx(Qq,{wordIndex:r,closeModal:()=>{var u;return(u=i.current)==null?void 0:u.close()},wordData:l})})]})}function Xq(){const{status:t,playerRef:e}=At();return o.jsx(ee,{size:"clear",className:"p-1.5",onClick:()=>{var n;return(n=e.current)==null?void 0:n.handlePlayPause()},color:"primary",children:t==="playing"?o.jsx(Yf,{className:"w-6"}):o.jsx(Pc,{className:"w-6"})})}function Yq(){const{eventRefs:t,tabProps:{tab:e}}=At();f.useEffect(()=>{switch(e){case"Edit":t.playWhenSpaceRef.current=!0,t.moveArrowToGrowRef.current=!0;break;case"Record":t.playWhenSpaceRef.current=!1,t.moveArrowToGrowRef.current=!1;break}},[e])}function Jq({closeModal:t}){const{song:e}=pn(),{eleRefs:n,currentWords:r,tabProps:s}=At();zq(),Bq(),Yq();const i=f.useRef(null);return o.jsx(o.Fragment,{children:o.jsxs("div",{className:"max-w-[90vw] w-[600px] relative",children:[o.jsx($t,{title:"Edit lyric",close:t}),o.jsx("audio",{src:e==null?void 0:e.song_url,ref:i}),o.jsx("div",{ref:n.tempWordRef,className:"absolute inline-block opacity-0",children:r.map((a,l)=>o.jsxs("span",{children:[a,o.jsx("span",{children:" "})]},l))}),i.current&&o.jsx(Mq,{audioEle:i.current}),o.jsxs("div",{className:"mt-5",children:[i.current&&o.jsx("div",{className:`${s.tab==="Record"?"block":"hidden"}`,children:o.jsx(Vq,{audioEle:i.current})}),o.jsxs("div",{className:`${s.tab==="Edit"?"block":"hidden"}`,children:[o.jsx(Xq,{}),o.jsx(Wq,{}),o.jsx(qq,{}),o.jsx(Kq,{})]})]}),o.jsx($q,{closeModal:t})]})})}function Zq(t){return o.jsx(Fq,{children:o.jsx(Jq,{...t})})}function eG({children:t}){const{theme:e}=O(),n=f.useRef(null),r=f.useRef(null),s=f.useRef(null),{isFetching:i,song:a,isChanged:l,isSubmitting:c}=jq({audioRef:r}),u=()=>{var d,h;(d=n.current)==null||d.pause(),(h=n.current)==null||h.submit()};return o.jsxs(o.Fragment,{children:[o.jsx("audio",{className:"hidden",ref:r,src:a==null?void 0:a.song_url}),i?o.jsx(ur,{children:o.jsx(Lt,{className:"w-6 animate-spin"})}):a&&o.jsxs("div",{className:"flex-grow flex flex-col overflow-hidden",children:[t,o.jsx(xe,{title:` Edit lyric - ${a==null?void 0:a.name}`}),o.jsx("div",{className:"mt-3",children:r.current&&o.jsxs(o.Fragment,{children:[o.jsx(Tq,{audioEle:r.current,ref:n}),o.jsx(Ee,{persisted:!0,variant:"animation",ref:s,children:o.jsx(Zq,{closeModal:()=>{var d;return(d=s.current)==null?void 0:d.close()}})})]})}),o.jsx(Aq,{modalRef:s,controlRef:n}),o.jsx(ee,{className:`${e.content_bg} font-playwriteCU self-end md:self-start rounded-full mt-5 `,variant:"primary",disabled:!l,isLoading:c,onClick:u,children:"Save"})]})]})}function dN(){return o.jsx(xq,{children:o.jsx(eG,{})})}function tG(){return o.jsxs("div",{className:"fixed left-[10px] top-[10px] bottom-[10px] right-[10px] flex flex-col md:right-0 md:top-0 md:left-[unset] md:right-[unset] md:relative md:h-full",children:[o.jsx(Vu,{className:"mb-1 self-start"}),o.jsx(dN,{})]})}const nG=["Song","Playlist","Singers"],rG={songs:[],playlists:[],singers:[]};function sG(){const[t,e]=f.useState(!1),[n,r]=f.useState("Song"),s=NT(),[i,a]=f.useState(rG),l=u=>{a(d=>({...d,...u}))},c=async()=>{try{const u=s[0].get("q");if(!u)return;switch(n){case"Song":{const d=_e(Tn,V("is_official","==",!0),V("name",">=",u),V("name","<=",u+"")),h=await In(d);l({songs:h});break}case"Playlist":{const d=_e(jr,V("is_public","==",!0),V("name",">=",u),V("name","<=",u+"")),h=await is(d);l({playlists:h});break}case"Singers":{const d=_e(of,V("name",">=",u),V("name","<=",u+"")),h=await lf(d);l({singers:h});break}}}catch(u){console.log({message:u})}finally{e(!1)}};return f.useEffect(()=>(c(),()=>{e(!0)}),[s[0].get("q"),n]),f.useEffect(()=>()=>{r("Song")},[s[0].get("q")]),{isFetching:t,setIsFetching:e,tab:n,setTab:r,getResult:c,result:i,tabs:nG}}function iG(){const{isFetching:t,result:e,tab:n,setTab:r,tabs:s}=sG(),{handleSetSong:i}=Us({variant:"search-bar"}),{getRecommend:a}=y1(),l=d=>{i(d.queue_id,[d]),a(d)},c=()=>{switch(n){case"Song":return ll;case"Playlist":return o.jsx("div",{className:"flex",children:_v})}},u=()=>{switch(n){case"Song":return e.songs.length?o.jsx(Vs,{setSong:l,songs:e.songs}):o.jsx(Xe,{className:"mx-auto"});case"Playlist":return e.playlists.length?o.jsx(yu,{loading:!1,playlists:e.playlists}):o.jsx(Xe,{className:"mx-auto"});case"Singers":return e.singers.length?o.jsx("div",{className:"flex flex-row flex-wrap -mx-2 mt-3",children:e.singers.map((d,h)=>o.jsx(zy,{variant:"singer-item",singer:d},h))}):o.jsx(Xe,{className:"mx-auto"})}};return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"mb-5",children:o.jsx(Vu,{})}),o.jsxs("div",{className:"flex items-center mt-3",children:[o.jsx("div",{className:"text-2xl font-bold",children:"Result"}),o.jsx("div",{className:`ml-5 ${t?"disable":""}`,children:o.jsx(us,{tabs:s,render:d=>d,tab:n,setTab:r})})]}),o.jsx(Nr,{children:o.jsxs("div",{className:"mt-5",children:[t&&c(),!t&&u()]})})]})}function aG(){const{theme:t}=O();return o.jsxs(ur,{children:[o.jsx("h1",{className:`text-[30px] font-bold ${t.text_color}`,children:"Page Not found"}),o.jsx("p",{className:"text-center",children:o.jsx(we,{to:"/",className:`${t.content_bg} inline-block mt-5 text-center rounded-full px-5 py-1.5 cursor-pointer`,children:"Go home"})})]})}function oG(){const{theme:t}=O(),e=nn(),n=async()=>{await UC(Ia),e("/login")};return o.jsxs("div",{className:`${t.container} flex flex-col justify-center items-center min-h-screen`,children:[o.jsx("h1",{className:`text-[30px] font-bold border p-[10px] ${t.text_color}`,children:"Unauthorized"}),o.jsx(ee,{onClick:n,variant:"primary",className:`${t.content_bg} font-bold text-[20px]  text-[#fff] rounded-full mt-[20px]`,children:"Exit"})]})}function lG(){const[t]=Xv(Ia),{theme:e}=O(),{action:n}=fp(),r=nn(),s=async()=>{try{await n("login")}catch(i){console.log(i)}};return f.useEffect(()=>{if(t){r("/");return}},[]),o.jsxs("div",{className:`min-h-screen flex flex-col items-center justify-center ${e.container} ${e.text_color}`,children:[o.jsx(ee,{onClick:s,variant:"default",className:`${e.content_bg} font-bold text-[#fff] text-[30px] rounded-full`,children:"Login with google"})," "]})}function cG(){const[t,e]=f.useState(),[n,r]=f.useState(!0),[s,i]=f.useState([]),[a,l]=f.useState([]),[c,u]=f.useState([]);return{singer:t,setSinger:e,isFetching:n,setIsFetching:r,songs:s,setSongs:i,playlists:a,albums:c,setAlbums:u,setPlaylists:l}}const hN=f.createContext(null);function uG({children:t}){return o.jsx(hN.Provider,{value:cG(),children:t})}function Hs(){const t=f.useContext(hN);if(!t)throw new Error("SingerProvider not provided");return t}let dG="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",hG=(t=21)=>{let e="",n=t;for(;n--;)e+=dG[Math.random()*64|0];return e};function fG(){const{setIsFetching:t,setSinger:e,setAlbums:n,isFetching:r,setSongs:s,singer:i,setPlaylists:a}=Hs(),{setErrorToast:l}=oe(),c=Fa(),u=f.useRef(!1),d=async()=>{try{if(!c.id)return;const h=await ss({collectionName:"Singers",id:c.id});if(!h.exists())return;const m={...h.data(),id:c.id},p=_e(Tn,V(`singer_map.${m.id}`,"==",!0)),g=await In(p,{getQueueId:()=>hG(4)+"_"+m.id}),y=_e(jr,V(`singer_map.${m.id}`,"==",!0)),_=await is(y),w=[],x=[];_.forEach(v=>v.is_album?x.push(v):w.push(v)),s(g),e(m),a(w),n(x)}catch(h){console.log({error:h}),l()}finally{t(!1)}};return f.useEffect(()=>{u.current||(u.current=!0,d())},[]),{singer:i,isFetching:r}}function Og({onClick:t,children:e}){const{songs:n}=Hs();return o.jsx(ee,{onClick:t,disabled:!n.length,size:"clear",color:"primary",className:"p-3",children:e})}function mG(){const t=rn(),{songs:e,singer:n}=Hs(),{playStatus:r}=ae(Kn),{currentSongData:s}=ae(dt),{handleSetSong:i}=Us({variant:"playlist"}),a=()=>{const c=e[0];console.log(e),i(c.queue_id,e)},l=()=>{switch(r){case"playing":return t(Ze({triggerPlayStatus:"paused"}));case"paused":return t(Ze({triggerPlayStatus:"playing"}))}};if(n&&s!=null&&s.song.queue_id.includes(n.id))switch(r){case"loading":case"paused":return o.jsx(Og,{onClick:l,children:o.jsx(xS,{className:"w-7"})});default:return o.jsx(Og,{onClick:l,children:o.jsx(UM,{className:"w-7"})})}else return o.jsx(Og,{onClick:a,children:o.jsx(xS,{className:"w-7"})})}function pG(){const{user:t,updateUserData:e}=fe(),{setSingers:n}=Cn(),[r,s]=f.useState(!1);return{likeSinger:async({singer:a})=>{try{if(s(!0),!t)return;const l=Bu(Ie),c=Jt(Ie,"Users",t.email),u=Jt(Ie,"Singers",a.id),d=[...t.liked_singer_ids],h=d.findIndex(y=>y===a.id),m=h===-1;m?d.unshift(a.id):d.splice(h,1);const p={liked_singer_ids:d},g={like:Yw(m?1:-1)};l.update(c,p),l.update(u,g),await l.commit(),n(m?y=>[a,...y]:y=>y.filter(_=>_.id!==a.id)),e(p)}catch(l){console.log({error:l})}finally{s(!1)}},isFetching:r,user:t}}function gG(){const{theme:t}=O(),{singer:e}=Hs(),{likeSinger:n,isFetching:r,user:s}=pG(),i=f.useMemo(()=>s&&e?s.liked_singer_ids.includes(e.id):!1,[s]);return e?o.jsx("button",{onClick:()=>n({singer:e}),className:`rounded-full p-2  ${i?t.content_bg:"bg-"+t.alpha}`,children:r?o.jsx(Lt,{className:"w-5 animate-spin"}):o.jsx(o.Fragment,{children:i?o.jsx(xv,{className:"w-5"}):o.jsx(Kf,{className:"w-5"})})}):o.jsx(o.Fragment,{})}function yG(){const{theme:t}=O(),[e,n]=f.useState(""),r=f.useRef(null),{singer:s}=Hs(),i=a=>{var l;n(a),(l=r.current)==null||l.open()};return o.jsxs(o.Fragment,{children:[o.jsx("button",{onClick:()=>i("more"),className:"text-sm ml-auto !mt-0",children:"See more"}),o.jsx("div",{className:"!mt-auto",children:o.jsxs("div",{className:"space-x-2 flex items-end",children:[o.jsx(mG,{}),o.jsx(gG,{}),o.jsxs(dr,{children:[o.jsx(hr,{children:o.jsx("button",{className:`p-2 bg-${t.alpha} hover:brightness-95 rounded-full`,children:o.jsx(al,{className:"w-5"})})}),o.jsx(fr,{appendTo:"parent",children:o.jsx(zs,{theme:t,p:"clear",className:"py-2",children:o.jsx(xl,{className:"w-[140px]",children:o.jsx(o1,{})})})})]})]})}),e&&o.jsx(Ee,{ref:r,variant:"animation",children:e==="more"&&s&&o.jsx("div",{className:"w-[400px] max-w-[calc(100vw-40px)]",children:s.description})})]})}function xG(){const{theme:t}=O(),{isFetching:e,singer:n}=Hs();return!e&&!n?o.jsx(o.Fragment,{}):o.jsx(o.Fragment,{children:o.jsxs("div",{className:`md:flex bg-transparent relative z-0 pb-5 md:p-10 ${t.text_color} `,children:[o.jsx("div",{className:"absolute overflow-hidden -left-10 -top-[100px] -right-10 inset-0",children:o.jsxs("div",{className:"relative h-full w-full",children:[o.jsx("div",{className:`absolute z-[-5] inset-0 ${t.type==="light"?"bg-white/50":"bg-black/50"}  `}),o.jsx("img",{src:(n==null?void 0:n.image_url)||NI,className:"blur-[50px] absolute z-[-10] w-full h-full object-center object-cover"})]})}),o.jsx("div",{className:"w-[70%] z-0 relative mx-auto md:w-1/4 md:flex-shrink-0 md:m-unset",children:e?o.jsx(te,{className:"pt-[100%] "}):o.jsx(gu,{children:o.jsx(ht,{src:n==null?void 0:n.image_url,blurHashEncode:n==null?void 0:n.blurhash_encode})})}),o.jsx("div",{className:"flex-grow z-0 relative flex flex-col mt-5 space-y-2.5  md:mt-0 md:ml-5",children:e?o.jsxs(o.Fragment,{children:[o.jsx(te,{className:"h-[60px] w-full md:w-[200px]"}),o.jsx(te,{className:"h-[24px] w-[200px]"}),o.jsx(te,{className:"h-[120px] w-full md:w-[100%]"})]}):n&&o.jsxs(o.Fragment,{children:[o.jsx("p",{className:"text-3xl leading-[2] font-playwriteCU",children:n.name}),o.jsxs("p",{children:[n.like," likes"]}),o.jsx("p",{className:"line-clamp-2",children:n.description}),o.jsx(yG,{})]})})]})})}function vG(){const{handleSetSong:t}=Us({variant:"songs"}),{isFetching:e,songs:n}=Hs();return o.jsx(o.Fragment,{children:o.jsxs("div",{children:[o.jsx(xe,{title:"Popular Songs"}),o.jsx(Nr,{children:e?ll:o.jsx(Vs,{songs:n,setSong:r=>t(r.queue_id,n)})})]})})}function wG(){const{isFetching:t,playlists:e}=Hs();return o.jsx(o.Fragment,{children:o.jsxs("div",{children:[o.jsx(xe,{title:"Popular Playlists"}),o.jsx(yu,{playlists:e,loading:t})]})})}function _G(){const{albums:t,isFetching:e}=Hs();return o.jsxs(o.Fragment,{children:[o.jsx(xe,{title:"Albums"}),o.jsx(yu,{playlists:t,loading:e})]})}function SG(){const{isFetching:t,singer:e}=fG();return!t&&!e?o.jsx(ur,{children:o.jsx(Xe,{variant:"with-home-button"})}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"space-y-5",children:[o.jsx(Vu,{}),o.jsx(xG,{}),o.jsx(vG,{}),o.jsx(_G,{}),o.jsx(wG,{})]}),o.jsx(zf,{})]})}function EG(){return o.jsx(uG,{children:o.jsx(SG,{})})}function bG(){return o.jsx(o.Fragment,{children:o.jsx("div",{className:"",children:o.jsx("p",{children:"This is dashboard page"})})})}const kG=["All","Result"];function TG(){const{uploadedSongs:t,setUploadedSongs:e}=Cn(),[n,r]=f.useState(""),[s,i]=f.useState(!0),[a,l]=f.useState("All"),{setErrorToast:c}=oe(),u=async h=>{try{h.preventDefault(),i(!0);const m=rs(Ie,"Songs"),p=_e(m,V("name",">=",n),V("name","<=",n+""),V("is_official","==",!0)),g=await In(p);e(g),l("Result")}catch(m){console.log({message:m}),c()}finally{i(!1)}},d=async()=>{try{i(!0);const h=rs(Ie,"Songs"),m=_e(h,V("is_official","==",!0),Ni("updated_at","desc")),p=await In(m);e(p)}catch(h){console.log({message:h}),c()}finally{i(!1)}};return f.useEffect(()=>{a==="All"&&d()},[a]),{isFetching:s,value:n,setValue:r,handleSubmit:u,uploadedSongs:t,tab:a,setTab:l,tabs:kG}}const yb=fu("inline-flex relative hover:brightness-95 space-x-1 items-center z-0",{variants:{variant:{primary:"before:content-[''] before:absolute before:z-[-1] before:inset-0 active:translate-y-[2px] active:before:shadow-none",clear:"before:content-none"},color:{primary:"before:border-[#4a826f] text-[#fff] bg-[#5a9e87] before:shadow-[0_2px_0_#4a826f]",second:"before:border-[#ccc] text-[#333] bg-[#f6f6f6] before:shadow-[0_2px_0_#ccc]",clear:""},size:{primary:"px-5 py-1.5",clear:""},fontWeight:{primary:"font-[500]",clear:""},border:{primary:"before:border-[2px]",thin:"before:border-[1px]",clear:"before:border-b-[2px]"},rounded:{xl:"before:rounded-xl rounded-xl",lg:"before:rounded-lg rounded-lg",md:"before:rounded-md rounded-md"}},defaultVariants:{variant:"primary",color:"primary",size:"primary",fontWeight:"primary",border:"primary",rounded:"lg"}});function IG({onClick:t,loading:e,children:n,border:r,size:s,color:i,fontWeight:a,type:l="button",variant:c,disabled:u,rounded:d,className:h,active:m,href:p},g){const y=u||e,_="before:shadow-none translate-y-[2px]";return o.jsx(o.Fragment,{children:p?o.jsx(we,{to:p,className:`${yb({variant:c,size:s,color:i,fontWeight:a,rounded:d,border:r,className:h})} ${m?_:""}`,children:n}):o.jsx("button",{ref:g,type:l||"button",onClick:t,disabled:y,className:`${yb({variant:c,size:s,color:m?"primary":i,border:r,fontWeight:a,className:h})} ${m?_:""}`,children:e?o.jsx(Lt,{className:"w-6 animate-spin"}):n})})}const le=f.forwardRef(IG),CG=fu("border-[2px] p-3 border-b-[6px] rounded-[14px]",{variants:{colors:{primary:"bg-white border-[#e1e1e1]",second:"bg-[#cee9b6] border-[#4a826f]",third:"bg-white border-[#4a826f]",clear:""}},defaultVariants:{colors:"primary"}});function kn({children:t,onClick:e,colors:n,className:r=""}){return o.jsx("div",{onClick:()=>e?e():{},className:`${CG({colors:n,className:r})} `,children:t})}function Hu({className:t=""}){return o.jsx("div",{className:`flex flex-grow items-center justify-center ${t}`,children:o.jsx(Lt,{className:"w-6 animate-spin"})})}function Xn({children:t,className:e="w-[400px]"}){return o.jsx("div",{className:`bg-white max-h-[80vh] overflow-hidden p-3 rounded-lg flex flex-col max-w-[90vw] ${e}`,children:t})}function Wu({children:t,className:e=""}){const n=`mt-2 ml-2 flex px-3 py-1.5 text-sm rounded-lg bg-[#fff] border-[2px] border-[#e1e1e1] [&>div]:ml-1.5 [&>div]:pl-1.5 [&>div]:border [&>div]:border-transparent [&>div]:flex [&>div]:space-x-1 [&>div]:border-l-black/10 hover:[&_button]:scale-[1.05] ${e}`;return o.jsx("div",{className:n,children:t})}function _l({handleSubmit:t,setValue:e,value:n,className:r="",inputRef:s}){return o.jsx(kn,{className:r,children:o.jsxs("form",{onSubmit:t,className:"flex gap-2 justify-between items-center",children:[o.jsxs("div",{className:"relative flex-grow flex items-center text-[#333]",children:[o.jsx(cr,{type:"text",ref:s,value:n,onChange:i=>e(i.target.value),placeholder:"..."}),n&&o.jsx("button",{type:"button",onClick:()=>{e("")},className:"absolute right-3",children:o.jsx(Mi,{className:"w-6"})})]}),o.jsx(le,{type:"submit",size:"clear",className:"p-2 flex-shrink-0",children:o.jsx(fv,{className:"w-6"})})]})})}function RG(){const[t,e]=f.useState(),[n,r]=f.useState(),[s,i]=f.useState([]);return{imageFile:n,setImageFile:r,playlist:t,setPlaylist:e,songs:s,setSongs:i,updatePlaylistData:l=>{t&&e({...t,...l})}}}const fN=f.createContext(null);function AG({children:t}){return o.jsx(fN.Provider,{value:RG(),children:t})}const mN=()=>{const t=f.useContext(fN);if(!t)throw new Error("PlaylistProvider not provided");return t};function v1(){const{user:t}=fe(),{playlist:e,songs:n,setSongs:r,updatePlaylistData:s}=mN(),[i,a]=f.useState(!1),l=nn(),{setErrorToast:c,setSuccessToast:u}=oe(),d=async(m,p)=>{const g={};m.forEach(_=>g[_.id]=!0);const y={singers:m,singer_map:g};await Qt({collectionName:"Playlists",id:p,data:y}),s(y)};return{isFetching:i,action:async m=>{try{if(!t)throw new Error("User not found");if(!e)throw new Error("playlist not found");switch(a(!0),m.variant){case"delete-playlist":{await Promise.all([l1({collectionName:"Playlists",id:e.id}),e.image_file_path?$n({filePath:e.image_file_path}):()=>{}]),l("/dashboard/playlist");break}case"add-songs":{const p=[...n,...m.songs],y={song_ids:p.map(_=>_.id)};await Qt({collectionName:"Playlists",id:e.id,data:y,msg:">>> api: update playlist doc"}),s(y),r(p),u("Songs added");break}case"edit-playlist":{const p={...e,...m.playlist};if(m.imageFile){const g=await Hi({imageFile:m.imageFile});e.image_file_path&&await $n({filePath:e.image_file_path}),Object.assign(p,g)}await Qt({collectionName:"Playlists",data:p,id:e.id,msg:">>> api: set playlist doc"}),s(p),u("Playlist edited");break}case"remove-song":{const p=n.filter(y=>y.id!==m.song.id),g={song_ids:p.map(y=>y.id)};await Qt({collectionName:"Playlists",id:e.id,data:g,msg:">>> api: update playlist doc"}),r(p),u(`'${m.song.name}' removed`);break}case"update-image":{const p={image_url:m.song.image_url,blurhash_encode:m.song.blurhash_encode,image_file_path:""};e.image_file_path&&await $n({filePath:e.image_file_path}),await Qt({collectionName:"Playlists",data:p,id:e.id,msg:">>> api: set playlist doc"}),s(p),u("Playlist edited;");break}case"remove-singer":{const p=e.singers.filter(g=>g.id!==m.singer.id);d(p,e.id),u("Singer removed");break}case"add-singer":{const p=[...e.singers];if(p.find(y=>y.id===m.singer.id))return;p.push(m.singer),d(p,e.id),u("Singer added");break}}}catch(p){console.log({message:p}),c("")}finally{a(!1)}},playlist:e}}function jG({song:t}){const{action:e,isFetching:n,playlist:r}=v1(),{close:s}=mr(),i=f.useRef(null),a={overlay:"absolute flex items-center justify-center inset-0 bg-black/40"},l=()=>{var u;(u=i.current)==null||u.open(),s()},c=async u=>{var d;switch(u.variant){case"remove-song":await e({variant:"remove-song",song:u.song});break;case"update-image":await e({variant:"update-image",song:u.song});break;case"add-singer":await e({variant:"add-singer",singer:u.singer}),(d=i.current)==null||d.close()}s()};return o.jsxs(o.Fragment,{children:[o.jsxs(pN,{song:t,children:[o.jsxs("button",{onClick:()=>c({variant:"remove-song",song:t}),children:[o.jsx(Gn,{className:"w-5"}),o.jsx("span",{children:"Remove"})]}),o.jsxs("button",{onClick:l,children:[o.jsx(ls,{className:"w-5"}),o.jsx("span",{children:"Add singer to playlist"})]}),t.image_url&&o.jsxs("button",{className:`${(r==null?void 0:r.image_url)===t.image_url?"disable":""}`,onClick:()=>c({variant:"update-image",song:t}),children:[o.jsx(ol,{className:"w-5"}),o.jsx("span",{children:"Set playlist image"})]}),n&&o.jsx("div",{className:a.overlay,children:o.jsx("div",{className:"h-[25px] w-[25px] border-[2px] border-r-black rounded-[50%] animate-spin"})})]}),o.jsx(Ee,{wrapped:!1,variant:"animation",ref:i,children:o.jsxs(Xn,{children:[o.jsx(xe,{title:"Singers"}),o.jsx("div",{className:"space-x-2 mt-3 [&>*]:px-3 [&>*]:py-1 [&>*]:rounded-md  [&>*]:bg-[#f1f1f1] hover:[&>*]:bg-black/10",children:t.singers.map(u=>o.jsx("button",{onClick:()=>c({variant:"add-singer",singer:u}),children:u.name}))})]})})]})}function NG(){const{setUploadedSongs:t,uploadedSongs:e}=Cn(),[n,r]=f.useState(!1),{setSuccessToast:s,setErrorToast:i}=oe();return{actions:async l=>{try{r(!0);const c=Bu(Ie),u=Jt(Ie,"Songs",l.song.id);switch(l.variant){case"delete":{const d=e.filter(h=>h.id!==l.song.id);if(c.delete(u),l.song.lyric_id){const h=Jt(Ie,"Lyrics",l.song.lyric_id);c.delete(h)}await Promise.all([c.commit(),Vj(l.song)]),t(d),s(`'${l.song.name}' deleted`);break}}}catch(c){console.log({message:c}),i()}finally{r(!1)}},isFetching:n}}function PG({song:t}){const{close:e}=mr(),{actions:n,isFetching:r}=NG(),[s,i]=f.useState(""),a=f.useRef(null),l=()=>{var h;return(h=a.current)==null?void 0:h.close()},c=h=>{var m;i(h),e(),(m=a.current)==null||m.open()},u=async h=>{switch(h.variant){case"delete":await n({variant:"delete",song:t})}l()},d=()=>{switch(s){case"":return o.jsx(o.Fragment,{});case"edit":case"delete":return o.jsx(Li,{loading:r,label:`Delete '${t.name}' ?`,desc:"This action cannot be undone",callback:()=>u({variant:"delete",song:t}),close:l})}};return o.jsxs(o.Fragment,{children:[o.jsxs(pN,{song:t,children:[o.jsxs(we,{to:`/dashboard/song/${t.id}/edit`,children:[o.jsx(mu,{className:"w-5"}),o.jsx("span",{children:"Edit"})]}),o.jsxs(we,{to:`/dashboard/lyric/${t.id}`,children:[o.jsx(hv,{className:"w-5"}),o.jsx("span",{children:"Lyric"})]}),o.jsxs("button",{onClick:()=>c("delete"),children:[o.jsx(Gn,{className:"w-5"}),o.jsx("span",{children:"Delete"})]})]}),o.jsx(Ee,{ref:a,variant:"animation",children:d()})]})}function FG({song:t}){return o.jsx("div",{className:"px-2 mb-3",children:o.jsxs("div",{className:"p-3 bg-white/10 rounded-md flex",children:[o.jsx("div",{className:"w-[60px] h-[60px] flex-shrink-0 rounded overflow-hidden",children:o.jsx(ht,{className:"object-cover h-full",src:t.image_url})}),o.jsxs("div",{className:"ml-2 text-sm",children:[o.jsx("h5",{className:"line-clamp-1 font-[500]",children:t.name}),o.jsx("h5",{className:"line-clamp-1 text-sm opacity-[.7]",children:t.singers.map((e,n)=>(n?", ":"")+e.name)})]})]})})}function pN({song:t,children:e}){const{theme:n}=O();return o.jsx(o.Fragment,{children:o.jsx(fr,{className:"w-[260px]",appendTo:"portal",children:o.jsxs(zs,{p:"clear",className:"py-2",theme:n,children:[o.jsx(FG,{song:t}),o.jsx(xl,{className:"hover:[&>*:not(div.absolute)]:bg-black/5",children:e}),o.jsxs("p",{className:"text-sm text-center opacity-70 mt-3",children:["Provided by ",t.distributor]})]})})})}function DG({song:t,variant:e}){const n=()=>{switch(e){case"songs":return o.jsx(PG,{song:t});case"playlist":return o.jsx(jG,{song:t})}};return o.jsx(o.Fragment,{children:o.jsxs(dr,{appendOnPortal:!0,children:[o.jsx(hr,{children:o.jsx(le,{size:"clear",color:"second",className:"p-1",children:o.jsx(al,{className:"w-5"})})}),n()]})})}function gN({song:t,className:e="",variant:n}){return o.jsxs("tr",{className:e,children:[o.jsx("td",{children:o.jsx(we,{to:`/dashboard/song/${t.id}/edit`,className:"hover:underline",children:t.name})}),o.jsx("td",{children:t.singers.map((r,s)=>o.jsxs(we,{className:"hover:underline",to:`/dashboard/singer/${r.id}`,children:[!!s&&", ",r.name]},s))}),o.jsx("td",{children:o.jsx(DG,{variant:n,song:t})})]})}function yN({value:t,setValue:e,inputRef:n}){return o.jsxs(kn,{className:"flex gap-2 justify-between items-center",children:[o.jsx(cr,{ref:n,value:t,onChange:r=>e(r.target.value),placeholder:"..."}),o.jsx(le,{onClick:()=>t?e(""):{},size:"clear",className:"p-2 flex-shrink-0",children:t?o.jsx(Mi,{className:"w-6"}):o.jsx(fv,{className:"w-6"})})]})}function Wi({className:t="",children:e,...n}){return o.jsx(kn,{children:o.jsx("div",{className:"rounded-md overflow-hidden",children:o.jsx(PI,{className:`[&_td]:text-sm hover:[&_tr]:bg-black/5 [&_tbody>tr]:border-t [&_tr]:border-black/5 [&_th]:text-sm [&_th]:text-left [&_td]:p-2 [&_th]:p-2 ${t}`,...n,children:e})})})}function OG(){const{isFetching:t,uploadedSongs:e,tabs:n,setTab:r,tab:s,...i}=TG();return o.jsxs("div",{className:"pb-[46px]",children:[o.jsx(xe,{title:"Songs"}),o.jsxs("div",{className:"flex justify-between items-start mt-3",children:[o.jsx(_l,{...i}),o.jsxs(le,{href:"/dashboard/song/add-song",className:"p-1.5 ml-5",size:"clear",children:[o.jsx(cs,{className:"w-6"}),o.jsx("div",{className:"hidden md:block",children:"Add song"})]})]}),o.jsx("div",{className:`mt-5 w-fit ${s==="All"?"pointer-events-none":""} self-start`,children:o.jsx(us,{tabs:n,render:a=>a,tab:s,setTab:r})}),o.jsxs("div",{className:"mt-3",children:[t&&o.jsx(te,{className:"h-[200px] rounded-xl"}),!t&&o.jsx(Wi,{colList:["Name","Singer",""],children:e.length?e.map((a,l)=>o.jsx(gN,{variant:"songs",song:a},l)):o.jsx("tr",{children:o.jsx("td",{colSpan:3,className:"text-center",children:o.jsx(Xe,{})})})})]})]})}function MG(){const[t,e]=f.useState(),[n,r]=f.useState(),[s,i]=f.useState([]),[a,l]=f.useState([]),[c,u]=f.useState(),[d,h]=f.useState(),[m,p]=f.useState(),g=f.useRef("add");return{imageFile:c,setImageFile:u,songFile:t,setSongFile:e,songData:n,song:d,setSong:h,variant:g,setSongData:r,updateSongData:v=>{n&&r({...n,...v})},singers:s,setSingers:i,setGenres:l,genres:a,selectGenre:v=>{const S=[...a],E=S.findIndex(b=>b.id===v.id);E===-1?S.push(v):S.splice(E,1),l(S)},selectSinger:v=>{const S=[...s],E=S.findIndex(b=>b.id===v.id);E===-1?S.push(v):S.splice(E,1),i(S)},imageBlob:m,setImageBlob:p,resetAddSongContext:v=>{e(void 0),r(v),i([]),l([])}}}const xN=f.createContext(null);function LG({children:t}){return o.jsx(xN.Provider,{value:MG(),children:t})}const Ua=()=>{const t=f.useContext(xN);if(!t)throw new Error("AddSongProvider not provided");return t};function vN(){const{setSongFile:t}=Ua(),e=f.useRef(null),n=r=>{var s;(s=r.target.files)!=null&&s.length&&t(r.target.files[0])};return o.jsxs(o.Fragment,{children:[o.jsx("input",{ref:e,onChange:n,type:"file",multiple:!0,accept:"audio",id:"song_upload",className:"hidden"}),o.jsx(le,{className:"",size:"clear",children:o.jsx("label",{htmlFor:"song_upload",className:"inline-flex p-1.5 cursor-pointer",children:o.jsx(lv,{className:"w-6"})})})]})}function $G(){const[t,e]=f.useState([]),n=f.useRef(!0);return{genres:t,shouldFetchGenre:n,setGenres:e}}const wN=f.createContext(null);function zG({children:t}){return o.jsx(wN.Provider,{value:$G(),children:t})}const w1=()=>{const t=f.useContext(wN);if(!t)throw new Error("GenreProvider is not provided");return t};function _N(){const{setGenres:t,genres:e}=w1(),{setErrorToast:n,setSuccessToast:r}=oe(),[s,i]=f.useState(!1);return{isFetching:s,action:async l=>{try{switch(i(!0),l.type){case"add":{if(e.find(h=>h.name===l.name))return await Ns(100),n("Genre already exist");const u=await Vi({collectionName:"Genres",data:{name:l.name}}),d={name:l.name,id:u.id};return t(h=>[d,...h]),i(!1),r("Add genre successful"),d}case"edit":{await Qt({collectionName:"Genres",data:{name:l.name},id:l.id});const c=[...e],u=c.findIndex(h=>h.id===l.id),d={...e[u]};Object.assign(d,{name:l.name}),c[u]=d,t(c),r("Edit genre successful");break}case"delete":{await l1({collectionName:"Genres",id:l.id}),t(c=>c.filter(u=>u.id!==l.id)),r("Delete genre successful");break}}}catch{}finally{i(!1)}}}}function SN(){const{genres:t,setGenres:e,shouldFetchGenre:n}=w1(),[r,s]=f.useState(!0);return{api:async()=>{try{if(n.current){n.current=!1;const a=rs(Ie,"Genres"),l=_e(a);console.log(">>> fetch genres");const c=await yl(l);if(c.docs){const u=c.docs.map(d=>({...d.data(),id:d.id}));e(u)}}else await Ns(100)}catch(a){console.log(a)}finally{s(!1)}},isFetching:r,setIsFetching:s,genres:t,shouldFetchGenre:n}}function EN(){const{genres:t}=w1(),[e,n]=f.useState(""),r=Gj(e,800),s=f.useMemo(()=>r?t.filter(i=>i.name.includes(r)):t,[r,t]);return{value:e,setValue:n,_genres:s}}function BG({afterSearched:t=()=>{}}){const[e,n]=f.useState(""),[r,s]=f.useState(!1),[i,a]=f.useState(!1),[l,c]=f.useState([]),{setErrorToast:u}=oe();return{value:e,isShowResult:i,setValue:n,result:l,handleSubmit:async h=>{try{h.preventDefault(),h.stopPropagation(),s(!0),a(!0);const m=rs(Ie,"Singers"),p=_e(m,V("name",">=",e),V("name","<=",e+"")),g=await yl(p);if(g.docs){const y=g.docs.map(_=>({..._.data(),id:_.id}));c(y),t()}}catch(m){console.log({message:m}),u()}finally{s(!1)}},isFetching:r}}function UG(){const{setSuccessToast:t,setErrorToast:e}=oe(),[n,r]=f.useState(!1);return{isFetching:n,addSinger:async({data:i})=>{try{r(!0);const a=await Vi({collectionName:"Singers",data:i}),c={...(await zu(a)).data(),id:a.id};return r(!1),t("Add singer successful"),c}catch(a){console.log({error:a}),e()}finally{r(!1)}}}}function VG({closeModal:t,afterSubmit:e,singerName:n}){const[r,s]=f.useState(cf({name:n})),{addSinger:i,isFetching:a}=UG(),l=r.name,c=(h,m)=>{s({...r,[h]:m.trim()})},u=async()=>{const h=await i({data:r});h&&e&&e(h),t()},d={inputGroup:"gap-1",input:"p-2 bg-[#f1f1f1] border border-black/20 rounded-lg",label:"text-[#3f3f3f] text-lg"};return o.jsxs(Xn,{className:"w-[450px]",children:[o.jsx($t,{close:t,title:"Add singer"}),o.jsx("div",{className:"space-y-3 overflow-auto",children:o.jsxs("div",{className:d.inputGroup,children:[o.jsx("label",{className:d.label,children:"Customer name:"}),o.jsx(cr,{value:r.name,onChange:h=>c("name",h.target.value),placeholder:"Enter name...",className:d.input})]})}),o.jsx("div",{className:"text-center mt-5",children:o.jsxs(le,{disabled:!l,loading:a,onClick:()=>l&&u(),children:[o.jsx(pu,{className:"w-6"}),o.jsx("p",{className:"text-white",children:"Ok"})]})})]})}function bN({choose:t,closeModal:e}){const{result:n,isShowResult:r,isFetching:s,...i}=BG({}),a=f.useRef(null),l=()=>{var c;return(c=a.current)==null?void 0:c.close()};return o.jsxs(o.Fragment,{children:[o.jsxs(Xn,{children:[o.jsx($t,{title:"Singers",close:e}),o.jsx(_l,{...i}),o.jsx("div",{className:"h-[40vh] mt-3 space-y-1.5 overflow-auto",children:r&&(s?o.jsx(Hu,{className:"h-full"}):o.jsx(o.Fragment,{children:n.length?n.map((c,u)=>o.jsx(kn,{onClick:()=>t(c),children:o.jsx("p",{className:"text-lg",children:c.name})},u)):o.jsx(o.Fragment,{children:o.jsx(Xe,{})})}))}),o.jsx("p",{className:"text-center mt-auto",children:o.jsxs(le,{onClick:()=>{var c;return(c=a.current)==null?void 0:c.open()},children:[o.jsx(cs,{className:"w-6"}),o.jsx("span",{children:"Add new singer"})]})})]}),o.jsx(Ee,{ref:a,wrapped:!1,variant:"animation",children:o.jsx(VG,{afterSubmit:t,singerName:i.value,closeModal:l})})]})}function HG(){const{singers:t,selectSinger:e}=Ua(),n=f.useRef(null),r=()=>{var i;return(i=n.current)==null?void 0:i.close()},s=i=>{e(i),r()};return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"",children:[o.jsxs("div",{className:"flex space-x-2 items-center",children:[o.jsx(xe,{title:"Singer"}),o.jsx(le,{onClick:()=>{var i;return(i=n.current)==null?void 0:i.open()},className:"p-1",size:"clear",children:o.jsx(cs,{className:"w-5"})})]}),o.jsx(kn,{className:" mt-1",children:o.jsx("div",{className:"flex flex-wrap -ml-2 -mt-2",children:t.length?t.map((i,a)=>o.jsxs(Wu,{children:[o.jsx("span",{children:i.name}),o.jsx("div",{className:"flex",children:o.jsx("button",{onClick:()=>e(i),children:o.jsx(Gn,{className:"w-5"})})})]},a)):"..."})})]}),o.jsx(Ee,{wrapped:!1,variant:"animation",ref:n,children:o.jsx(bN,{closeModal:r,choose:s})})]})}function WG({audioEle:t,variant:e}){const n=f.useRef(null),{status:r,handlePlayPause:s}=d1({audioEle:t,baseColor:"rgba(0,0,0,.10)",color:"#5a9e87",progressLineRef:n}),i=()=>{switch(r){case"error":return o.jsx(Gf,{className:"w-6"});case"playing":return o.jsx(Yf,{className:"w-6"});case"paused":return o.jsx(Pc,{className:"w-6"});case"waiting":return o.jsx(Lt,{className:"w-6 animate-spin"})}};return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex items-end justify-between",children:[o.jsx(le,{className:"p-1",size:"clear",onClick:s,children:i()}),e==="add"&&o.jsx(vN,{})]}),o.jsx("div",{style:{backgroundColor:"rgab(0,0,0,.05)"},ref:n,className:"h-1 rounded-full mt-3 w-full"})]})}function _1({closeModal:t,afterSubmit:e,...n}){const[r,s]=f.useState(n.type==="add"?n.genreName||"":n.genre.name),{action:i,isFetching:a}=_N(),{setErrorToast:l}=oe(),c=f.useRef(null),u=!!r,d=async()=>{try{switch(n.type){case"add":const p=await i({type:"add",name:r});p&&e&&e(p);break;case"edit":await i({type:"edit",name:r,id:n.genre.id});break}}catch(p){console.log(p),l()}finally{t()}},h={inputGroup:"gap-1",input:"p-2 bg-[#f1f1f1] border border-black/20 rounded-lg",label:"text-[#3f3f3f] text-lg"};f.useEffect(()=>{var p;(p=c.current)==null||p.focus()},[]);const m=n.type==="edit"?`Edit '${n.genre.name}'`:"Add genre";return o.jsxs(Xn,{className:"w-[450px]",children:[o.jsx($t,{close:t,title:m}),o.jsx("div",{className:"space-y-3 overflow-auto",children:o.jsxs("div",{className:h.inputGroup,children:[o.jsx("label",{className:h.label,children:"Genre name:"}),o.jsx(cr,{ref:c,value:r,onChange:p=>s(p.target.value),placeholder:"Enter name...",className:h.input})]})}),o.jsx("div",{className:"text-center mt-5",children:o.jsxs(le,{disabled:!u,loading:a,onClick:()=>u&&d(),children:[o.jsx(pu,{className:"w-6"}),o.jsx("p",{className:"text-white",children:"Ok"})]})})]})}function qG({closeModal:t,choose:e}){const{_genres:n,...r}=EN(),s=f.useRef(null),i=f.useRef(null),a=()=>{var u;return(u=s.current)==null?void 0:u.close()},{api:l,isFetching:c}=SN();return f.useEffect(()=>{var u;l(),(u=i.current)==null||u.focus()},[]),o.jsxs(o.Fragment,{children:[o.jsxs(Xn,{children:[o.jsx($t,{title:"Genre",close:t}),o.jsx(yN,{inputRef:i,...r}),o.jsx("div",{className:"h-[40vh] mt-3 space-y-1.5 overflow-auto",children:c?o.jsx(Hu,{className:"h-full"}):o.jsx(o.Fragment,{children:n.length?n.map((u,d)=>o.jsx(kn,{onClick:()=>e(u),children:o.jsx("p",{className:"text-lg",children:u.name})},d)):o.jsx(o.Fragment,{children:o.jsx(Xe,{})})})}),o.jsx("p",{className:"text-center mt-auto",children:o.jsxs(le,{onClick:()=>{var u;return(u=s.current)==null?void 0:u.open()},children:[o.jsx(ls,{className:"w-6"}),o.jsx("span",{children:"Add new genre"})]})})]}),o.jsx(Ee,{ref:s,wrapped:!1,variant:"animation",children:o.jsx(_1,{afterSubmit:e,genreName:r.value,type:"add",closeModal:a})})]})}function GG(){const{genres:t,selectGenre:e}=Ua(),n=f.useRef(null),r=i=>{e(i),s()},s=()=>{var i;return(i=n.current)==null?void 0:i.close()};return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"",children:[o.jsxs("div",{className:"flex space-x-2 items-center",children:[o.jsx(xe,{title:"Genre"}),o.jsx(le,{onClick:()=>{var i;return(i=n.current)==null?void 0:i.open()},className:"p-1",size:"clear",children:o.jsx(cs,{className:"w-5"})})]}),o.jsx(kn,{className:"mt-1",children:o.jsx("div",{className:"flex flex-wrap -ml-2 -mt-2",children:t.length?t.map((i,a)=>o.jsxs(Wu,{children:[o.jsx("span",{children:i.name}),o.jsx("div",{children:o.jsx("button",{onClick:()=>e(i),children:o.jsx(Gn,{className:"w-5"})})})]},a)):"..."})})]}),o.jsx(Ee,{wrapped:!1,variant:"animation",ref:n,children:o.jsx(qG,{closeModal:s,choose:r})})]})}const QG="End-Of-Stream";class ct extends Error{constructor(){super(QG)}}class KG{constructor(){this.maxStreamReadSize=1*1024*1024,this.endOfStream=!1,this.peekQueue=[]}async peek(e,n,r){const s=await this.read(e,n,r);return this.peekQueue.push(e.subarray(n,n+s)),s}async read(e,n,r){if(r===0)return 0;let s=this.readFromPeekBuffer(e,n,r);if(s+=await this.readRemainderFromStream(e,n+s,r-s),s===0)throw new ct;return s}readFromPeekBuffer(e,n,r){let s=r,i=0;for(;this.peekQueue.length>0&&s>0;){const a=this.peekQueue.pop();if(!a)throw new Error("peekData should be defined");const l=Math.min(a.length,s);e.set(a.subarray(0,l),n+i),i+=l,s-=l,l<a.length&&this.peekQueue.push(a.subarray(l))}return i}async readRemainderFromStream(e,n,r){let s=r,i=0;for(;s>0&&!this.endOfStream;){const a=Math.min(s,this.maxStreamReadSize),l=await this.readFromStream(e,n+i,a);if(l===0)break;i+=l,s-=l}return i}}class XG extends KG{constructor(e){super(),this.reader=e.getReader({mode:"byob"})}async readFromStream(e,n,r){if(this.endOfStream)throw new ct;const s=await this.reader.read(new Uint8Array(r));return s.done&&(this.endOfStream=s.done),s.value?(e.set(s.value,n),s.value.byteLength):0}}class kN{constructor(e){this.position=0,this.numBuffer=new Uint8Array(8),this.fileInfo=(e==null?void 0:e.fileInfo)??{},this.onClose=e==null?void 0:e.onClose}async readToken(e,n=this.position){const r=new Uint8Array(e.len);if(await this.readBuffer(r,{position:n})<e.len)throw new ct;return e.get(r,0)}async peekToken(e,n=this.position){const r=new Uint8Array(e.len);if(await this.peekBuffer(r,{position:n})<e.len)throw new ct;return e.get(r,0)}async readNumber(e){if(await this.readBuffer(this.numBuffer,{length:e.len})<e.len)throw new ct;return e.get(this.numBuffer,0)}async peekNumber(e){if(await this.peekBuffer(this.numBuffer,{length:e.len})<e.len)throw new ct;return e.get(this.numBuffer,0)}async ignore(e){if(this.fileInfo.size!==void 0){const n=this.fileInfo.size-this.position;if(e>n)return this.position+=n,n}return this.position+=e,e}async close(){var e;await((e=this.onClose)==null?void 0:e.call(this))}normalizeOptions(e,n){if(n&&n.position!==void 0&&n.position<this.position)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");return n?{mayBeLess:n.mayBeLess===!0,offset:n.offset?n.offset:0,length:n.length?n.length:e.length-(n.offset?n.offset:0),position:n.position?n.position:this.position}:{mayBeLess:!1,offset:0,length:e.length,position:this.position}}}const YG=256e3;class JG extends kN{constructor(e,n){super(n),this.streamReader=e}async readBuffer(e,n){const r=this.normalizeOptions(e,n),s=r.position-this.position;if(s>0)return await this.ignore(s),this.readBuffer(e,n);if(s<0)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");if(r.length===0)return 0;const i=await this.streamReader.read(e,r.offset,r.length);if(this.position+=i,(!n||!n.mayBeLess)&&i<r.length)throw new ct;return i}async peekBuffer(e,n){const r=this.normalizeOptions(e,n);let s=0;if(r.position){const i=r.position-this.position;if(i>0){const a=new Uint8Array(r.length+i);return s=await this.peekBuffer(a,{mayBeLess:r.mayBeLess}),e.set(a.subarray(i),r.offset),s-i}if(i<0)throw new Error("Cannot peek from a negative offset in a stream")}if(r.length>0){try{s=await this.streamReader.peek(e,r.offset,r.length)}catch(i){if(n!=null&&n.mayBeLess&&i instanceof ct)return 0;throw i}if(!r.mayBeLess&&s<r.length)throw new ct}return s}async ignore(e){const n=Math.min(YG,e),r=new Uint8Array(n);let s=0;for(;s<e;){const i=e-s,a=await this.readBuffer(r,{length:Math.min(n,i)});if(a<0)return a;s+=a}return s}}class ZG extends kN{constructor(e,n){super(n),this.uint8Array=e,this.fileInfo.size=this.fileInfo.size?this.fileInfo.size:e.length}async readBuffer(e,n){if(n!=null&&n.position){if(n.position<this.position)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");this.position=n.position}const r=await this.peekBuffer(e,n);return this.position+=r,r}async peekBuffer(e,n){const r=this.normalizeOptions(e,n),s=Math.min(this.uint8Array.length-r.position,r.length);if(!r.mayBeLess&&s<r.length)throw new ct;return e.set(this.uint8Array.subarray(r.position,r.position+s),r.offset),s}close(){return super.close()}}function TN(t,e){return new JG(new XG(t),e)}function Xo(t,e){return new ZG(t,e)}/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */var mp=function(t,e,n,r,s){var i,a,l=s*8-r-1,c=(1<<l)-1,u=c>>1,d=-7,h=n?s-1:0,m=n?-1:1,p=t[e+h];for(h+=m,i=p&(1<<-d)-1,p>>=-d,d+=l;d>0;i=i*256+t[e+h],h+=m,d-=8);for(a=i&(1<<-d)-1,i>>=-d,d+=r;d>0;a=a*256+t[e+h],h+=m,d-=8);if(i===0)i=1-u;else{if(i===c)return a?NaN:(p?-1:1)*(1/0);a=a+Math.pow(2,r),i=i-u}return(p?-1:1)*a*Math.pow(2,i-r)},pp=function(t,e,n,r,s,i){var a,l,c,u=i*8-s-1,d=(1<<u)-1,h=d>>1,m=s===23?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:i-1,g=r?1:-1,y=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(l=isNaN(e)?1:0,a=d):(a=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-a))<1&&(a--,c*=2),a+h>=1?e+=m/c:e+=m*Math.pow(2,1-h),e*c>=2&&(a++,c/=2),a+h>=d?(l=0,a=d):a+h>=1?(l=(e*c-1)*Math.pow(2,s),a=a+h):(l=e*Math.pow(2,h-1)*Math.pow(2,s),a=0));s>=8;t[n+p]=l&255,p+=g,l/=256,s-=8);for(a=a<<s|l,u+=s;u>0;t[n+p]=a&255,p+=g,a/=256,u-=8);t[n+p-g]|=y*128};function re(t){return new DataView(t.buffer,t.byteOffset)}const se={len:1,get(t,e){return re(t).getUint8(e)},put(t,e,n){return re(t).setUint8(e,n),e+1}},Te={len:2,get(t,e){return re(t).getUint16(e,!0)},put(t,e,n){return re(t).setUint16(e,n,!0),e+2}},je={len:2,get(t,e){return re(t).getUint16(e)},put(t,e,n){return re(t).setUint16(e,n),e+2}},uf={len:3,get(t,e){const n=re(t);return n.getUint8(e)+(n.getUint16(e+1,!0)<<8)},put(t,e,n){const r=re(t);return r.setUint8(e,n&255),r.setUint16(e+1,n>>8,!0),e+3}},hn={len:3,get(t,e){const n=re(t);return(n.getUint16(e)<<8)+n.getUint8(e+2)},put(t,e,n){const r=re(t);return r.setUint16(e,n>>8),r.setUint8(e+2,n&255),e+3}},U={len:4,get(t,e){return re(t).getUint32(e,!0)},put(t,e,n){return re(t).setUint32(e,n,!0),e+4}},Q={len:4,get(t,e){return re(t).getUint32(e)},put(t,e,n){return re(t).setUint32(e,n),e+4}},ru={len:1,get(t,e){return re(t).getInt8(e)},put(t,e,n){return re(t).setInt8(e,n),e+1}},Es={len:2,get(t,e){return re(t).getInt16(e)},put(t,e,n){return re(t).setInt16(e,n),e+2}},eQ={len:2,get(t,e){return re(t).getInt16(e,!0)},put(t,e,n){return re(t).setInt16(e,n,!0),e+2}},tQ={len:3,get(t,e){const n=uf.get(t,e);return n>8388607?n-16777216:n},put(t,e,n){const r=re(t);return r.setUint8(e,n&255),r.setUint16(e+1,n>>8,!0),e+3}},S1={len:3,get(t,e){const n=hn.get(t,e);return n>8388607?n-16777216:n},put(t,e,n){const r=re(t);return r.setUint16(e,n>>8),r.setUint8(e+2,n&255),e+3}},zn={len:4,get(t,e){return re(t).getInt32(e)},put(t,e,n){return re(t).setInt32(e,n),e+4}},at={len:4,get(t,e){return re(t).getInt32(e,!0)},put(t,e,n){return re(t).setInt32(e,n,!0),e+4}},ln={len:8,get(t,e){return re(t).getBigUint64(e,!0)},put(t,e,n){return re(t).setBigUint64(e,n,!0),e+8}},df={len:8,get(t,e){return re(t).getBigInt64(e,!0)},put(t,e,n){return re(t).setBigInt64(e,n,!0),e+8}},E1={len:8,get(t,e){return re(t).getBigUint64(e)},put(t,e,n){return re(t).setBigUint64(e,n),e+8}},IN={len:8,get(t,e){return re(t).getBigInt64(e)},put(t,e,n){return re(t).setBigInt64(e,n),e+8}},nQ={len:2,get(t,e){return mp(t,e,!1,10,this.len)},put(t,e,n){return pp(t,n,e,!1,10,this.len),e+this.len}},rQ={len:2,get(t,e){return mp(t,e,!0,10,this.len)},put(t,e,n){return pp(t,n,e,!0,10,this.len),e+this.len}},CN={len:4,get(t,e){return re(t).getFloat32(e)},put(t,e,n){return re(t).setFloat32(e,n),e+4}},sQ={len:4,get(t,e){return re(t).getFloat32(e,!0)},put(t,e,n){return re(t).setFloat32(e,n,!0),e+4}},Vy={len:8,get(t,e){return re(t).getFloat64(e)},put(t,e,n){return re(t).setFloat64(e,n),e+8}},iQ={len:8,get(t,e){return re(t).getFloat64(e,!0)},put(t,e,n){return re(t).setFloat64(e,n,!0),e+8}},aQ={len:10,get(t,e){return mp(t,e,!1,63,this.len)},put(t,e,n){return pp(t,n,e,!1,63,this.len),e+this.len}},oQ={len:10,get(t,e){return mp(t,e,!0,63,this.len)},put(t,e,n){return pp(t,n,e,!0,63,this.len),e+this.len}};class lQ{constructor(e){this.len=e}get(e,n){}}class gn{constructor(e){this.len=e}get(e,n){return e.subarray(n,n+this.len)}}class G{constructor(e,n){this.len=e,this.encoding=n,this.textDecoder=new TextDecoder(n)}get(e,n){return this.textDecoder.decode(e.subarray(n,n+this.len))}}class cQ{constructor(e){this.len=e,this.textDecoder=new TextDecoder("windows-1252")}get(e,n=0){return this.textDecoder.decode(e.subarray(n,n+this.len))}}const uQ=Object.freeze(Object.defineProperty({__proto__:null,AnsiStringType:cQ,Float16_BE:nQ,Float16_LE:rQ,Float32_BE:CN,Float32_LE:sQ,Float64_BE:Vy,Float64_LE:iQ,Float80_BE:aQ,Float80_LE:oQ,INT16_BE:Es,INT16_LE:eQ,INT24_BE:S1,INT24_LE:tQ,INT32_BE:zn,INT32_LE:at,INT64_BE:IN,INT64_LE:df,INT8:ru,IgnoreType:lQ,StringType:G,UINT16_BE:je,UINT16_LE:Te,UINT24_BE:hn,UINT24_LE:uf,UINT32_BE:Q,UINT32_LE:U,UINT64_BE:E1,UINT64_LE:ln,UINT8:se,Uint8ArrayType:gn},Symbol.toStringTag,{value:"Module"})),dQ=Object.prototype.toString,hQ="[object Uint8Array]",fQ="[object ArrayBuffer]";function RN(t,e,n){return t?t.constructor===e?!0:dQ.call(t)===n:!1}function AN(t){return RN(t,Uint8Array,hQ)}function mQ(t){return RN(t,ArrayBuffer,fQ)}function pQ(t){return AN(t)||mQ(t)}function gQ(t){if(!AN(t))throw new TypeError(`Expected \`Uint8Array\`, got \`${typeof t}\``)}function yQ(t){if(!pQ(t))throw new TypeError(`Expected \`Uint8Array\` or \`ArrayBuffer\`, got \`${typeof t}\``)}const Ed={utf8:new globalThis.TextDecoder("utf8")};function b1(t,e="utf8"){return yQ(t),Ed[e]??(Ed[e]=new globalThis.TextDecoder(e)),Ed[e].decode(t)}function jN(t){if(typeof t!="string")throw new TypeError(`Expected \`string\`, got \`${typeof t}\``)}const xQ=new globalThis.TextEncoder;function vQ(t){return jN(t),xQ.encode(t)}const wQ=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function k1(t){gQ(t);let e="";for(let n=0;n<t.length;n++)e+=wQ[t[n]];return e}const xb={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,a:10,b:11,c:12,d:13,e:14,f:15,A:10,B:11,C:12,D:13,E:14,F:15};function vb(t){if(jN(t),t.length%2!==0)throw new Error("Invalid Hex string length.");const e=t.length/2,n=new Uint8Array(e);for(let r=0;r<e;r++){const s=xb[t[r*2]],i=xb[t[r*2+1]];if(s===void 0||i===void 0)throw new Error(`Invalid Hex character encountered at position ${r*2}`);n[r]=s<<4|i}return n}function wb(t){const{byteLength:e}=t;if(e===6)return t.getUint16(0)*2**32+t.getUint32(2);if(e===5)return t.getUint8(0)*2**32+t.getUint32(1);if(e===4)return t.getUint32(0);if(e===3)return t.getUint8(0)*2**16+t.getUint16(1);if(e===2)return t.getUint16(0);if(e===1)return t.getUint8(0)}function NN(t,e){const n=t.length,r=e.length;if(r===0||r>n)return-1;const s=n-r;for(let i=0;i<=s;i++){let a=!0;for(let l=0;l<r;l++)if(t[i+l]!==e[l]){a=!1;break}if(a)return i}return-1}function _Q(t,e){return NN(t,e)!==-1}function SQ(t){return[...t].map(e=>e.charCodeAt(0))}function EQ(t,e=0){const n=Number.parseInt(new G(6).get(t,148).replace(/\0.*$/,"").trim(),8);if(Number.isNaN(n))return!1;let r=8*32;for(let s=e;s<e+148;s++)r+=t[s];for(let s=e+156;s<e+512;s++)r+=t[s];return n===r}const bQ={get:(t,e)=>t[e+3]&127|t[e+2]<<7|t[e+1]<<14|t[e]<<21,len:4},kQ=["jpg","png","apng","gif","webp","flif","xcf","cr2","cr3","orf","arw","dng","nef","rw2","raf","tif","bmp","icns","jxr","psd","indd","zip","tar","rar","gz","bz2","7z","dmg","mp4","mid","mkv","webm","mov","avi","mpg","mp2","mp3","m4a","oga","ogg","ogv","opus","flac","wav","spx","amr","pdf","epub","elf","macho","exe","swf","rtf","wasm","woff","woff2","eot","ttf","otf","ico","flv","ps","xz","sqlite","nes","crx","xpi","cab","deb","ar","rpm","Z","lz","cfb","mxf","mts","blend","bpg","docx","pptx","xlsx","3gp","3g2","j2c","jp2","jpm","jpx","mj2","aif","qcp","odt","ods","odp","xml","mobi","heic","cur","ktx","ape","wv","dcm","ics","glb","pcap","dsf","lnk","alias","voc","ac3","m4v","m4p","m4b","f4v","f4p","f4b","f4a","mie","asf","ogm","ogx","mpc","arrow","shp","aac","mp1","it","s3m","xm","ai","skp","avif","eps","lzh","pgp","asar","stl","chm","3mf","zst","jxl","vcf","jls","pst","dwg","parquet","class","arj","cpio","ace","avro","icc","fbx","vsdx"],TQ=["image/jpeg","image/png","image/gif","image/webp","image/flif","image/x-xcf","image/x-canon-cr2","image/x-canon-cr3","image/tiff","image/bmp","image/vnd.ms-photo","image/vnd.adobe.photoshop","application/x-indesign","application/epub+zip","application/x-xpinstall","application/vnd.oasis.opendocument.text","application/vnd.oasis.opendocument.spreadsheet","application/vnd.oasis.opendocument.presentation","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/zip","application/x-tar","application/x-rar-compressed","application/gzip","application/x-bzip2","application/x-7z-compressed","application/x-apple-diskimage","application/x-apache-arrow","video/mp4","audio/midi","video/x-matroska","video/webm","video/quicktime","video/vnd.avi","audio/wav","audio/qcelp","audio/x-ms-asf","video/x-ms-asf","application/vnd.ms-asf","video/mpeg","video/3gpp","audio/mpeg","audio/mp4","audio/opus","video/ogg","audio/ogg","application/ogg","audio/x-flac","audio/ape","audio/wavpack","audio/amr","application/pdf","application/x-elf","application/x-mach-binary","application/x-msdownload","application/x-shockwave-flash","application/rtf","application/wasm","font/woff","font/woff2","application/vnd.ms-fontobject","font/ttf","font/otf","image/x-icon","video/x-flv","application/postscript","application/eps","application/x-xz","application/x-sqlite3","application/x-nintendo-nes-rom","application/x-google-chrome-extension","application/vnd.ms-cab-compressed","application/x-deb","application/x-unix-archive","application/x-rpm","application/x-compress","application/x-lzip","application/x-cfb","application/x-mie","application/mxf","video/mp2t","application/x-blender","image/bpg","image/j2c","image/jp2","image/jpx","image/jpm","image/mj2","audio/aiff","application/xml","application/x-mobipocket-ebook","image/heif","image/heif-sequence","image/heic","image/heic-sequence","image/icns","image/ktx","application/dicom","audio/x-musepack","text/calendar","text/vcard","model/gltf-binary","application/vnd.tcpdump.pcap","audio/x-dsf","application/x.ms.shortcut","application/x.apple.alias","audio/x-voc","audio/vnd.dolby.dd-raw","audio/x-m4a","image/apng","image/x-olympus-orf","image/x-sony-arw","image/x-adobe-dng","image/x-nikon-nef","image/x-panasonic-rw2","image/x-fujifilm-raf","video/x-m4v","video/3gpp2","application/x-esri-shape","audio/aac","audio/x-it","audio/x-s3m","audio/x-xm","video/MP1S","video/MP2P","application/vnd.sketchup.skp","image/avif","application/x-lzh-compressed","application/pgp-encrypted","application/x-asar","model/stl","application/vnd.ms-htmlhelp","model/3mf","image/jxl","application/zstd","image/jls","application/vnd.ms-outlook","image/vnd.dwg","application/x-parquet","application/java-vm","application/x-arj","application/x-cpio","application/x-ace-compressed","application/avro","application/vnd.iccprofile","application/x.autodesk.fbx","application/vnd.visio"],_b=4100;async function PN(t){return new IQ().fromBuffer(t)}function Fr(t,e,n){n={offset:0,...n};for(const[r,s]of e.entries())if(n.mask){if(s!==(n.mask[r]&t[r+n.offset]))return!1}else if(s!==t[r+n.offset])return!1;return!0}class IQ{constructor(e){this.detectors=e==null?void 0:e.customDetectors,this.fromTokenizer=this.fromTokenizer.bind(this),this.fromBuffer=this.fromBuffer.bind(this),this.parse=this.parse.bind(this)}async fromTokenizer(e){const n=e.position;for(const r of this.detectors||[]){const s=await r(e);if(s)return s;if(n!==e.position)return}return this.parse(e)}async fromBuffer(e){if(!(e instanceof Uint8Array||e instanceof ArrayBuffer))throw new TypeError(`Expected the \`input\` argument to be of type \`Uint8Array\` or \`ArrayBuffer\`, got \`${typeof e}\``);const n=e instanceof Uint8Array?e:new Uint8Array(e);if((n==null?void 0:n.length)>1)return this.fromTokenizer(Xo(n))}async fromBlob(e){return this.fromStream(e.stream())}async fromStream(e){const n=await TN(e);try{return await this.fromTokenizer(n)}finally{await n.close()}}async toDetectionStream(e,n){const{sampleSize:r=_b}=n;let s,i;const a=e.getReader({mode:"byob"});try{const{value:u,done:d}=await a.read(new Uint8Array(r));if(i=u,!d&&u)try{s=await this.fromBuffer(u.slice(0,r))}catch(h){if(!(h instanceof ct))throw h;s=void 0}i=u}finally{a.releaseLock()}const l=new TransformStream({async start(u){u.enqueue(i)},transform(u,d){d.enqueue(u)}}),c=e.pipeThrough(l);return c.fileType=s,c}check(e,n){return Fr(this.buffer,e,n)}checkString(e,n){return this.check(SQ(e),n)}async parse(e){if(this.buffer=new Uint8Array(_b),e.fileInfo.size===void 0&&(e.fileInfo.size=Number.MAX_SAFE_INTEGER),this.tokenizer=e,await e.peekBuffer(this.buffer,{length:12,mayBeLess:!0}),this.check([66,77]))return{ext:"bmp",mime:"image/bmp"};if(this.check([11,119]))return{ext:"ac3",mime:"audio/vnd.dolby.dd-raw"};if(this.check([120,1]))return{ext:"dmg",mime:"application/x-apple-diskimage"};if(this.check([77,90]))return{ext:"exe",mime:"application/x-msdownload"};if(this.check([37,33]))return await e.peekBuffer(this.buffer,{length:24,mayBeLess:!0}),this.checkString("PS-Adobe-",{offset:2})&&this.checkString(" EPSF-",{offset:14})?{ext:"eps",mime:"application/eps"}:{ext:"ps",mime:"application/postscript"};if(this.check([31,160])||this.check([31,157]))return{ext:"Z",mime:"application/x-compress"};if(this.check([199,113]))return{ext:"cpio",mime:"application/x-cpio"};if(this.check([96,234]))return{ext:"arj",mime:"application/x-arj"};if(this.check([239,187,191]))return this.tokenizer.ignore(3),this.parse(e);if(this.check([71,73,70]))return{ext:"gif",mime:"image/gif"};if(this.check([73,73,188]))return{ext:"jxr",mime:"image/vnd.ms-photo"};if(this.check([31,139,8]))return{ext:"gz",mime:"application/gzip"};if(this.check([66,90,104]))return{ext:"bz2",mime:"application/x-bzip2"};if(this.checkString("ID3")){await e.ignore(6);const n=await e.readToken(bQ);return e.position+n>e.fileInfo.size?{ext:"mp3",mime:"audio/mpeg"}:(await e.ignore(n),this.fromTokenizer(e))}if(this.checkString("MP+"))return{ext:"mpc",mime:"audio/x-musepack"};if((this.buffer[0]===67||this.buffer[0]===70)&&this.check([87,83],{offset:1}))return{ext:"swf",mime:"application/x-shockwave-flash"};if(this.check([255,216,255]))return this.check([247],{offset:3})?{ext:"jls",mime:"image/jls"}:{ext:"jpg",mime:"image/jpeg"};if(this.check([79,98,106,1]))return{ext:"avro",mime:"application/avro"};if(this.checkString("FLIF"))return{ext:"flif",mime:"image/flif"};if(this.checkString("8BPS"))return{ext:"psd",mime:"image/vnd.adobe.photoshop"};if(this.checkString("WEBP",{offset:8}))return{ext:"webp",mime:"image/webp"};if(this.checkString("MPCK"))return{ext:"mpc",mime:"audio/x-musepack"};if(this.checkString("FORM"))return{ext:"aif",mime:"audio/aiff"};if(this.checkString("icns",{offset:0}))return{ext:"icns",mime:"image/icns"};if(this.check([80,75,3,4])){try{for(;e.position+30<e.fileInfo.size;){await e.readBuffer(this.buffer,{length:30});const n=new DataView(this.buffer.buffer),r={compressedSize:n.getUint32(18,!0),uncompressedSize:n.getUint32(22,!0),filenameLength:n.getUint16(26,!0),extraFieldLength:n.getUint16(28,!0)};if(r.filename=await e.readToken(new G(r.filenameLength,"utf-8")),await e.ignore(r.extraFieldLength),r.filename==="META-INF/mozilla.rsa")return{ext:"xpi",mime:"application/x-xpinstall"};if(r.filename.endsWith(".rels")||r.filename.endsWith(".xml"))switch(r.filename.split("/")[0]){case"_rels":break;case"word":return{ext:"docx",mime:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"};case"ppt":return{ext:"pptx",mime:"application/vnd.openxmlformats-officedocument.presentationml.presentation"};case"xl":return{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"};case"visio":return{ext:"vsdx",mime:"application/vnd.visio"};default:break}if(r.filename.startsWith("xl/"))return{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"};if(r.filename.startsWith("3D/")&&r.filename.endsWith(".model"))return{ext:"3mf",mime:"model/3mf"};if(r.filename==="mimetype"&&r.compressedSize===r.uncompressedSize){let s=await e.readToken(new G(r.compressedSize,"utf-8"));switch(s=s.trim(),s){case"application/epub+zip":return{ext:"epub",mime:"application/epub+zip"};case"application/vnd.oasis.opendocument.text":return{ext:"odt",mime:"application/vnd.oasis.opendocument.text"};case"application/vnd.oasis.opendocument.spreadsheet":return{ext:"ods",mime:"application/vnd.oasis.opendocument.spreadsheet"};case"application/vnd.oasis.opendocument.presentation":return{ext:"odp",mime:"application/vnd.oasis.opendocument.presentation"};default:}}if(r.compressedSize===0){let s=-1;for(;s<0&&e.position<e.fileInfo.size;)await e.peekBuffer(this.buffer,{mayBeLess:!0}),s=NN(this.buffer,new Uint8Array([80,75,3,4])),await e.ignore(s>=0?s:this.buffer.length)}else await e.ignore(r.compressedSize)}}catch(n){if(!(n instanceof ct))throw n}return{ext:"zip",mime:"application/zip"}}if(this.checkString("OggS")){await e.ignore(28);const n=new Uint8Array(8);return await e.readBuffer(n),Fr(n,[79,112,117,115,72,101,97,100])?{ext:"opus",mime:"audio/opus"}:Fr(n,[128,116,104,101,111,114,97])?{ext:"ogv",mime:"video/ogg"}:Fr(n,[1,118,105,100,101,111,0])?{ext:"ogm",mime:"video/ogg"}:Fr(n,[127,70,76,65,67])?{ext:"oga",mime:"audio/ogg"}:Fr(n,[83,112,101,101,120,32,32])?{ext:"spx",mime:"audio/ogg"}:Fr(n,[1,118,111,114,98,105,115])?{ext:"ogg",mime:"audio/ogg"}:{ext:"ogx",mime:"application/ogg"}}if(this.check([80,75])&&(this.buffer[2]===3||this.buffer[2]===5||this.buffer[2]===7)&&(this.buffer[3]===4||this.buffer[3]===6||this.buffer[3]===8))return{ext:"zip",mime:"application/zip"};if(this.checkString("ftyp",{offset:4})&&this.buffer[8]&96){const n=new G(4,"latin1").get(this.buffer,8).replace("\0"," ").trim();switch(n){case"avif":case"avis":return{ext:"avif",mime:"image/avif"};case"mif1":return{ext:"heic",mime:"image/heif"};case"msf1":return{ext:"heic",mime:"image/heif-sequence"};case"heic":case"heix":return{ext:"heic",mime:"image/heic"};case"hevc":case"hevx":return{ext:"heic",mime:"image/heic-sequence"};case"qt":return{ext:"mov",mime:"video/quicktime"};case"M4V":case"M4VH":case"M4VP":return{ext:"m4v",mime:"video/x-m4v"};case"M4P":return{ext:"m4p",mime:"video/mp4"};case"M4B":return{ext:"m4b",mime:"audio/mp4"};case"M4A":return{ext:"m4a",mime:"audio/x-m4a"};case"F4V":return{ext:"f4v",mime:"video/mp4"};case"F4P":return{ext:"f4p",mime:"video/mp4"};case"F4A":return{ext:"f4a",mime:"audio/mp4"};case"F4B":return{ext:"f4b",mime:"audio/mp4"};case"crx":return{ext:"cr3",mime:"image/x-canon-cr3"};default:return n.startsWith("3g")?n.startsWith("3g2")?{ext:"3g2",mime:"video/3gpp2"}:{ext:"3gp",mime:"video/3gpp"}:{ext:"mp4",mime:"video/mp4"}}}if(this.checkString("MThd"))return{ext:"mid",mime:"audio/midi"};if(this.checkString("wOFF")&&(this.check([0,1,0,0],{offset:4})||this.checkString("OTTO",{offset:4})))return{ext:"woff",mime:"font/woff"};if(this.checkString("wOF2")&&(this.check([0,1,0,0],{offset:4})||this.checkString("OTTO",{offset:4})))return{ext:"woff2",mime:"font/woff2"};if(this.check([212,195,178,161])||this.check([161,178,195,212]))return{ext:"pcap",mime:"application/vnd.tcpdump.pcap"};if(this.checkString("DSD "))return{ext:"dsf",mime:"audio/x-dsf"};if(this.checkString("LZIP"))return{ext:"lz",mime:"application/x-lzip"};if(this.checkString("fLaC"))return{ext:"flac",mime:"audio/x-flac"};if(this.check([66,80,71,251]))return{ext:"bpg",mime:"image/bpg"};if(this.checkString("wvpk"))return{ext:"wv",mime:"audio/wavpack"};if(this.checkString("%PDF")){try{await e.ignore(1350);const n=10*1024*1024,r=new Uint8Array(Math.min(n,e.fileInfo.size));if(await e.readBuffer(r,{mayBeLess:!0}),_Q(r,new TextEncoder().encode("AIPrivateData")))return{ext:"ai",mime:"application/postscript"}}catch(n){if(!(n instanceof ct))throw n}return{ext:"pdf",mime:"application/pdf"}}if(this.check([0,97,115,109]))return{ext:"wasm",mime:"application/wasm"};if(this.check([73,73])){const n=await this.readTiffHeader(!1);if(n)return n}if(this.check([77,77])){const n=await this.readTiffHeader(!0);if(n)return n}if(this.checkString("MAC "))return{ext:"ape",mime:"audio/ape"};if(this.check([26,69,223,163])){async function n(){const l=await e.peekNumber(se);let c=128,u=0;for(;!(l&c)&&c!==0;)++u,c>>=1;const d=new Uint8Array(u+1);return await e.readBuffer(d),d}async function r(){const l=await n(),c=await n();c[0]^=128>>c.length-1;const u=Math.min(6,c.length),d=new DataView(l.buffer),h=new DataView(c.buffer,c.length-u,u);return{id:wb(d),len:wb(h)}}async function s(l){for(;l>0;){const c=await r();if(c.id===17026)return(await e.readToken(new G(c.len))).replaceAll(/\00.*$/g,"");await e.ignore(c.len),--l}}const i=await r();switch(await s(i.len)){case"webm":return{ext:"webm",mime:"video/webm"};case"matroska":return{ext:"mkv",mime:"video/x-matroska"};default:return}}if(this.check([82,73,70,70])){if(this.check([65,86,73],{offset:8}))return{ext:"avi",mime:"video/vnd.avi"};if(this.check([87,65,86,69],{offset:8}))return{ext:"wav",mime:"audio/wav"};if(this.check([81,76,67,77],{offset:8}))return{ext:"qcp",mime:"audio/qcelp"}}if(this.checkString("SQLi"))return{ext:"sqlite",mime:"application/x-sqlite3"};if(this.check([78,69,83,26]))return{ext:"nes",mime:"application/x-nintendo-nes-rom"};if(this.checkString("Cr24"))return{ext:"crx",mime:"application/x-google-chrome-extension"};if(this.checkString("MSCF")||this.checkString("ISc("))return{ext:"cab",mime:"application/vnd.ms-cab-compressed"};if(this.check([237,171,238,219]))return{ext:"rpm",mime:"application/x-rpm"};if(this.check([197,208,211,198]))return{ext:"eps",mime:"application/eps"};if(this.check([40,181,47,253]))return{ext:"zst",mime:"application/zstd"};if(this.check([127,69,76,70]))return{ext:"elf",mime:"application/x-elf"};if(this.check([33,66,68,78]))return{ext:"pst",mime:"application/vnd.ms-outlook"};if(this.checkString("PAR1"))return{ext:"parquet",mime:"application/x-parquet"};if(this.check([207,250,237,254]))return{ext:"macho",mime:"application/x-mach-binary"};if(this.check([79,84,84,79,0]))return{ext:"otf",mime:"font/otf"};if(this.checkString("#!AMR"))return{ext:"amr",mime:"audio/amr"};if(this.checkString("{\\rtf"))return{ext:"rtf",mime:"application/rtf"};if(this.check([70,76,86,1]))return{ext:"flv",mime:"video/x-flv"};if(this.checkString("IMPM"))return{ext:"it",mime:"audio/x-it"};if(this.checkString("-lh0-",{offset:2})||this.checkString("-lh1-",{offset:2})||this.checkString("-lh2-",{offset:2})||this.checkString("-lh3-",{offset:2})||this.checkString("-lh4-",{offset:2})||this.checkString("-lh5-",{offset:2})||this.checkString("-lh6-",{offset:2})||this.checkString("-lh7-",{offset:2})||this.checkString("-lzs-",{offset:2})||this.checkString("-lz4-",{offset:2})||this.checkString("-lz5-",{offset:2})||this.checkString("-lhd-",{offset:2}))return{ext:"lzh",mime:"application/x-lzh-compressed"};if(this.check([0,0,1,186])){if(this.check([33],{offset:4,mask:[241]}))return{ext:"mpg",mime:"video/MP1S"};if(this.check([68],{offset:4,mask:[196]}))return{ext:"mpg",mime:"video/MP2P"}}if(this.checkString("ITSF"))return{ext:"chm",mime:"application/vnd.ms-htmlhelp"};if(this.check([202,254,186,190]))return{ext:"class",mime:"application/java-vm"};if(this.check([253,55,122,88,90,0]))return{ext:"xz",mime:"application/x-xz"};if(this.checkString("<?xml "))return{ext:"xml",mime:"application/xml"};if(this.check([55,122,188,175,39,28]))return{ext:"7z",mime:"application/x-7z-compressed"};if(this.check([82,97,114,33,26,7])&&(this.buffer[6]===0||this.buffer[6]===1))return{ext:"rar",mime:"application/x-rar-compressed"};if(this.checkString("solid "))return{ext:"stl",mime:"model/stl"};if(this.checkString("AC")){const n=new G(4,"latin1").get(this.buffer,2);if(n.match("^d*")&&n>=1e3&&n<=1050)return{ext:"dwg",mime:"image/vnd.dwg"}}if(this.checkString("070707"))return{ext:"cpio",mime:"application/x-cpio"};if(this.checkString("BLENDER"))return{ext:"blend",mime:"application/x-blender"};if(this.checkString("!<arch>"))return await e.ignore(8),await e.readToken(new G(13,"ascii"))==="debian-binary"?{ext:"deb",mime:"application/x-deb"}:{ext:"ar",mime:"application/x-unix-archive"};if(this.checkString("**ACE",{offset:7})&&(await e.peekBuffer(this.buffer,{length:14,mayBeLess:!0}),this.checkString("**",{offset:12})))return{ext:"ace",mime:"application/x-ace-compressed"};if(this.check([137,80,78,71,13,10,26,10])){await e.ignore(8);async function n(){return{length:await e.readToken(zn),type:await e.readToken(new G(4,"latin1"))}}do{const r=await n();if(r.length<0)return;switch(r.type){case"IDAT":return{ext:"png",mime:"image/png"};case"acTL":return{ext:"apng",mime:"image/apng"};default:await e.ignore(r.length+4)}}while(e.position+8<e.fileInfo.size);return{ext:"png",mime:"image/png"}}if(this.check([65,82,82,79,87,49,0,0]))return{ext:"arrow",mime:"application/x-apache-arrow"};if(this.check([103,108,84,70,2,0,0,0]))return{ext:"glb",mime:"model/gltf-binary"};if(this.check([102,114,101,101],{offset:4})||this.check([109,100,97,116],{offset:4})||this.check([109,111,111,118],{offset:4})||this.check([119,105,100,101],{offset:4}))return{ext:"mov",mime:"video/quicktime"};if(this.check([73,73,82,79,8,0,0,0,24]))return{ext:"orf",mime:"image/x-olympus-orf"};if(this.checkString("gimp xcf "))return{ext:"xcf",mime:"image/x-xcf"};if(this.check([73,73,85,0,24,0,0,0,136,231,116,216]))return{ext:"rw2",mime:"image/x-panasonic-rw2"};if(this.check([48,38,178,117,142,102,207,17,166,217])){async function n(){const r=new Uint8Array(16);return await e.readBuffer(r),{id:r,size:Number(await e.readToken(ln))}}for(await e.ignore(30);e.position+24<e.fileInfo.size;){const r=await n();let s=r.size-24;if(Fr(r.id,[145,7,220,183,183,169,207,17,142,230,0,192,12,32,83,101])){const i=new Uint8Array(16);if(s-=await e.readBuffer(i),Fr(i,[64,158,105,248,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"audio/x-ms-asf"};if(Fr(i,[192,239,25,188,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"video/x-ms-asf"};break}await e.ignore(s)}return{ext:"asf",mime:"application/vnd.ms-asf"}}if(this.check([171,75,84,88,32,49,49,187,13,10,26,10]))return{ext:"ktx",mime:"image/ktx"};if((this.check([126,16,4])||this.check([126,24,4]))&&this.check([48,77,73,69],{offset:4}))return{ext:"mie",mime:"application/x-mie"};if(this.check([39,10,0,0,0,0,0,0,0,0,0,0],{offset:2}))return{ext:"shp",mime:"application/x-esri-shape"};if(this.check([255,79,255,81]))return{ext:"j2c",mime:"image/j2c"};if(this.check([0,0,0,12,106,80,32,32,13,10,135,10]))switch(await e.ignore(20),await e.readToken(new G(4,"ascii"))){case"jp2 ":return{ext:"jp2",mime:"image/jp2"};case"jpx ":return{ext:"jpx",mime:"image/jpx"};case"jpm ":return{ext:"jpm",mime:"image/jpm"};case"mjp2":return{ext:"mj2",mime:"image/mj2"};default:return}if(this.check([255,10])||this.check([0,0,0,12,74,88,76,32,13,10,135,10]))return{ext:"jxl",mime:"image/jxl"};if(this.check([254,255]))return this.check([0,60,0,63,0,120,0,109,0,108],{offset:2})?{ext:"xml",mime:"application/xml"}:void 0;if(this.check([0,0,1,186])||this.check([0,0,1,179]))return{ext:"mpg",mime:"video/mpeg"};if(this.check([0,1,0,0,0]))return{ext:"ttf",mime:"font/ttf"};if(this.check([0,0,1,0]))return{ext:"ico",mime:"image/x-icon"};if(this.check([0,0,2,0]))return{ext:"cur",mime:"image/x-icon"};if(this.check([208,207,17,224,161,177,26,225]))return{ext:"cfb",mime:"application/x-cfb"};if(await e.peekBuffer(this.buffer,{length:Math.min(256,e.fileInfo.size),mayBeLess:!0}),this.check([97,99,115,112],{offset:36}))return{ext:"icc",mime:"application/vnd.iccprofile"};if(this.checkString("BEGIN:")){if(this.checkString("VCARD",{offset:6}))return{ext:"vcf",mime:"text/vcard"};if(this.checkString("VCALENDAR",{offset:6}))return{ext:"ics",mime:"text/calendar"}}if(this.checkString("FUJIFILMCCD-RAW"))return{ext:"raf",mime:"image/x-fujifilm-raf"};if(this.checkString("Extended Module:"))return{ext:"xm",mime:"audio/x-xm"};if(this.checkString("Creative Voice File"))return{ext:"voc",mime:"audio/x-voc"};if(this.check([4,0,0,0])&&this.buffer.length>=16){const n=new DataView(this.buffer.buffer).getUint32(12,!0);if(n>12&&this.buffer.length>=n+16)try{const r=new TextDecoder().decode(this.buffer.slice(16,n+16));if(JSON.parse(r).files)return{ext:"asar",mime:"application/x-asar"}}catch{}}if(this.check([6,14,43,52,2,5,1,1,13,1,2,1,1,2]))return{ext:"mxf",mime:"application/mxf"};if(this.checkString("SCRM",{offset:44}))return{ext:"s3m",mime:"audio/x-s3m"};if(this.check([71])&&this.check([71],{offset:188}))return{ext:"mts",mime:"video/mp2t"};if(this.check([71],{offset:4})&&this.check([71],{offset:196}))return{ext:"mts",mime:"video/mp2t"};if(this.check([66,79,79,75,77,79,66,73],{offset:60}))return{ext:"mobi",mime:"application/x-mobipocket-ebook"};if(this.check([68,73,67,77],{offset:128}))return{ext:"dcm",mime:"application/dicom"};if(this.check([76,0,0,0,1,20,2,0,0,0,0,0,192,0,0,0,0,0,0,70]))return{ext:"lnk",mime:"application/x.ms.shortcut"};if(this.check([98,111,111,107,0,0,0,0,109,97,114,107,0,0,0,0]))return{ext:"alias",mime:"application/x.apple.alias"};if(this.checkString("Kaydara FBX Binary  \0"))return{ext:"fbx",mime:"application/x.autodesk.fbx"};if(this.check([76,80],{offset:34})&&(this.check([0,0,1],{offset:8})||this.check([1,0,2],{offset:8})||this.check([2,0,2],{offset:8})))return{ext:"eot",mime:"application/vnd.ms-fontobject"};if(this.check([6,6,237,245,216,29,70,229,189,49,239,231,254,116,183,29]))return{ext:"indd",mime:"application/x-indesign"};if(await e.peekBuffer(this.buffer,{length:Math.min(512,e.fileInfo.size),mayBeLess:!0}),EQ(this.buffer))return{ext:"tar",mime:"application/x-tar"};if(this.check([255,254]))return this.check([60,0,63,0,120,0,109,0,108,0],{offset:2})?{ext:"xml",mime:"application/xml"}:this.check([255,14,83,0,107,0,101,0,116,0,99,0,104,0,85,0,112,0,32,0,77,0,111,0,100,0,101,0,108,0],{offset:2})?{ext:"skp",mime:"application/vnd.sketchup.skp"}:void 0;if(this.checkString("-----BEGIN PGP MESSAGE-----"))return{ext:"pgp",mime:"application/pgp-encrypted"};if(this.buffer.length>=2&&this.check([255,224],{offset:0,mask:[255,224]})){if(this.check([16],{offset:1,mask:[22]}))return this.check([8],{offset:1,mask:[8]})?{ext:"aac",mime:"audio/aac"}:{ext:"aac",mime:"audio/aac"};if(this.check([2],{offset:1,mask:[6]}))return{ext:"mp3",mime:"audio/mpeg"};if(this.check([4],{offset:1,mask:[6]}))return{ext:"mp2",mime:"audio/mpeg"};if(this.check([6],{offset:1,mask:[6]}))return{ext:"mp1",mime:"audio/mpeg"}}}async readTiffTag(e){const n=await this.tokenizer.readToken(e?je:Te);switch(this.tokenizer.ignore(10),n){case 50341:return{ext:"arw",mime:"image/x-sony-arw"};case 50706:return{ext:"dng",mime:"image/x-adobe-dng"}}}async readTiffIFD(e){const n=await this.tokenizer.readToken(e?je:Te);for(let r=0;r<n;++r){const s=await this.readTiffTag(e);if(s)return s}}async readTiffHeader(e){const n=(e?je:Te).get(this.buffer,2),r=(e?Q:U).get(this.buffer,4);if(n===42){if(r>=6){if(this.checkString("CR",{offset:8}))return{ext:"cr2",mime:"image/x-canon-cr2"};if(r>=8&&(this.check([28,0,254,0],{offset:8})||this.check([31,0,11,0],{offset:8})))return{ext:"nef",mime:"image/x-nikon-nef"}}return await this.tokenizer.ignore(r),await this.readTiffIFD(e)??{ext:"tif",mime:"image/tiff"}}if(n===43)return{ext:"tif",mime:"image/tiff"}}}new Set(kQ);new Set(TQ);var T1={};/*!
 * content-type
 * Copyright(c) 2015 Douglas Christopher Wilson
 * MIT Licensed
 */var Sb=/; *([!#$%&'*+.^_`|~0-9A-Za-z-]+) *= *("(?:[\u000b\u0020\u0021\u0023-\u005b\u005d-\u007e\u0080-\u00ff]|\\[\u000b\u0020-\u00ff])*"|[!#$%&'*+.^_`|~0-9A-Za-z-]+) */g,CQ=/^[\u000b\u0020-\u007e\u0080-\u00ff]+$/,FN=/^[!#$%&'*+.^_`|~0-9A-Za-z-]+$/,RQ=/\\([\u000b\u0020-\u00ff])/g,AQ=/([\\"])/g,DN=/^[!#$%&'*+.^_`|~0-9A-Za-z-]+\/[!#$%&'*+.^_`|~0-9A-Za-z-]+$/;T1.format=jQ;T1.parse=NQ;function jQ(t){if(!t||typeof t!="object")throw new TypeError("argument obj is required");var e=t.parameters,n=t.type;if(!n||!DN.test(n))throw new TypeError("invalid type");var r=n;if(e&&typeof e=="object")for(var s,i=Object.keys(e).sort(),a=0;a<i.length;a++){if(s=i[a],!FN.test(s))throw new TypeError("invalid parameter name");r+="; "+s+"="+FQ(e[s])}return r}function NQ(t){if(!t)throw new TypeError("argument string is required");var e=typeof t=="object"?PQ(t):t;if(typeof e!="string")throw new TypeError("argument string is required to be a string");var n=e.indexOf(";"),r=n!==-1?e.slice(0,n).trim():e.trim();if(!DN.test(r))throw new TypeError("invalid media type");var s=new DQ(r.toLowerCase());if(n!==-1){var i,a,l;for(Sb.lastIndex=n;a=Sb.exec(e);){if(a.index!==n)throw new TypeError("invalid parameter format");n+=a[0].length,i=a[1].toLowerCase(),l=a[2],l.charCodeAt(0)===34&&(l=l.slice(1,-1),l.indexOf("\\")!==-1&&(l=l.replace(RQ,"$1"))),s.parameters[i]=l}if(n!==e.length)throw new TypeError("invalid parameter format")}return s}function PQ(t){var e;if(typeof t.getHeader=="function"?e=t.getHeader("content-type"):typeof t.headers=="object"&&(e=t.headers&&t.headers["content-type"]),typeof e!="string")throw new TypeError("content-type header is missing from object");return e}function FQ(t){var e=String(t);if(FN.test(e))return e;if(e.length>0&&!CQ.test(e))throw new TypeError("invalid parameter value");return'"'+e.replace(AQ,"\\$1")+'"'}function DQ(t){this.parameters=Object.create(null),this.type=t}/*!
 * media-typer
 * Copyright(c) 2014-2017 Douglas Christopher Wilson
 * MIT Licensed
 */var OQ=/^ *([A-Za-z0-9][A-Za-z0-9!#$&^_-]{0,126})\/([A-Za-z0-9][A-Za-z0-9!#$&^_.+-]{0,126}) *$/,MQ=LQ;function LQ(t){if(!t)throw new TypeError("argument string is required");if(typeof t!="string")throw new TypeError("argument string is required to be a string");var e=OQ.exec(t.toLowerCase());if(!e)throw new TypeError("invalid media type");var n=e[1],r=e[2],s,i=r.lastIndexOf("+");return i!==-1&&(s=r.substr(i+1),r=r.substr(0,i)),new $Q(n,r,s)}function $Q(t,e,n){this.type=t,this.subtype=e,this.suffix=n}var Hy={exports:{}},Mg,Eb;function zQ(){if(Eb)return Mg;Eb=1;var t=1e3,e=t*60,n=e*60,r=n*24,s=r*7,i=r*365.25;Mg=function(d,h){h=h||{};var m=typeof d;if(m==="string"&&d.length>0)return a(d);if(m==="number"&&isFinite(d))return h.long?c(d):l(d);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(d))};function a(d){if(d=String(d),!(d.length>100)){var h=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(d);if(h){var m=parseFloat(h[1]),p=(h[2]||"ms").toLowerCase();switch(p){case"years":case"year":case"yrs":case"yr":case"y":return m*i;case"weeks":case"week":case"w":return m*s;case"days":case"day":case"d":return m*r;case"hours":case"hour":case"hrs":case"hr":case"h":return m*n;case"minutes":case"minute":case"mins":case"min":case"m":return m*e;case"seconds":case"second":case"secs":case"sec":case"s":return m*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return m;default:return}}}}function l(d){var h=Math.abs(d);return h>=r?Math.round(d/r)+"d":h>=n?Math.round(d/n)+"h":h>=e?Math.round(d/e)+"m":h>=t?Math.round(d/t)+"s":d+"ms"}function c(d){var h=Math.abs(d);return h>=r?u(d,h,r,"day"):h>=n?u(d,h,n,"hour"):h>=e?u(d,h,e,"minute"):h>=t?u(d,h,t,"second"):d+" ms"}function u(d,h,m,p){var g=h>=m*1.5;return Math.round(d/m)+" "+p+(g?"s":"")}return Mg}function BQ(t){n.debug=n,n.default=n,n.coerce=c,n.disable=i,n.enable=s,n.enabled=a,n.humanize=zQ(),n.destroy=u,Object.keys(t).forEach(d=>{n[d]=t[d]}),n.names=[],n.skips=[],n.formatters={};function e(d){let h=0;for(let m=0;m<d.length;m++)h=(h<<5)-h+d.charCodeAt(m),h|=0;return n.colors[Math.abs(h)%n.colors.length]}n.selectColor=e;function n(d){let h,m=null,p,g;function y(..._){if(!y.enabled)return;const w=y,x=Number(new Date),v=x-(h||x);w.diff=v,w.prev=h,w.curr=x,h=x,_[0]=n.coerce(_[0]),typeof _[0]!="string"&&_.unshift("%O");let S=0;_[0]=_[0].replace(/%([a-zA-Z%])/g,(b,I)=>{if(b==="%%")return"%";S++;const A=n.formatters[I];if(typeof A=="function"){const L=_[S];b=A.call(w,L),_.splice(S,1),S--}return b}),n.formatArgs.call(w,_),(w.log||n.log).apply(w,_)}return y.namespace=d,y.useColors=n.useColors(),y.color=n.selectColor(d),y.extend=r,y.destroy=n.destroy,Object.defineProperty(y,"enabled",{enumerable:!0,configurable:!1,get:()=>m!==null?m:(p!==n.namespaces&&(p=n.namespaces,g=n.enabled(d)),g),set:_=>{m=_}}),typeof n.init=="function"&&n.init(y),y}function r(d,h){const m=n(this.namespace+(typeof h>"u"?":":h)+d);return m.log=this.log,m}function s(d){n.save(d),n.namespaces=d,n.names=[],n.skips=[];let h;const m=(typeof d=="string"?d:"").split(/[\s,]+/),p=m.length;for(h=0;h<p;h++)m[h]&&(d=m[h].replace(/\*/g,".*?"),d[0]==="-"?n.skips.push(new RegExp("^"+d.slice(1)+"$")):n.names.push(new RegExp("^"+d+"$")))}function i(){const d=[...n.names.map(l),...n.skips.map(l).map(h=>"-"+h)].join(",");return n.enable(""),d}function a(d){if(d[d.length-1]==="*")return!0;let h,m;for(h=0,m=n.skips.length;h<m;h++)if(n.skips[h].test(d))return!1;for(h=0,m=n.names.length;h<m;h++)if(n.names[h].test(d))return!0;return!1}function l(d){return d.toString().substring(2,d.toString().length-2).replace(/\.\*\?$/,"*")}function c(d){return d instanceof Error?d.stack||d.message:d}function u(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return n.enable(n.load()),n}var UQ=BQ;(function(t,e){e.formatArgs=r,e.save=s,e.load=i,e.useColors=n,e.storage=a(),e.destroy=(()=>{let c=!1;return()=>{c||(c=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function n(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function r(c){if(c[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+c[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;const u="color: "+this.color;c.splice(1,0,u,"color: inherit");let d=0,h=0;c[0].replace(/%[a-zA-Z%]/g,m=>{m!=="%%"&&(d++,m==="%c"&&(h=d))}),c.splice(h,0,u)}e.log=console.debug||console.log||(()=>{});function s(c){try{c?e.storage.setItem("debug",c):e.storage.removeItem("debug")}catch{}}function i(){let c;try{c=e.storage.getItem("debug")}catch{}return!c&&typeof process<"u"&&"env"in process&&(c={}.DEBUG),c}function a(){try{return localStorage}catch{}}t.exports=UQ(e);const{formatters:l}=t.exports;l.j=function(c){try{return JSON.stringify(c)}catch(u){return"[UnexpectedJSONParseError]: "+u.message}}})(Hy,Hy.exports);var VQ=Hy.exports;const De=ck(VQ);var Wy;(function(t){t[t.shot=10]="shot",t[t.scene=20]="scene",t[t.track=30]="track",t[t.part=40]="part",t[t.album=50]="album",t[t.edition=60]="edition",t[t.collection=70]="collection"})(Wy||(Wy={}));var Ca;(function(t){t[t.video=1]="video",t[t.audio=2]="audio",t[t.complex=3]="complex",t[t.logo=4]="logo",t[t.subtitle=17]="subtitle",t[t.button=18]="button",t[t.control=32]="control"})(Ca||(Ca={}));function tt(t,e,n){return(t[e]&1<<n)!==0}function Rn(t,e,n,r){let s=e;if(r==="utf-16le"){for(;t[s]!==0||t[s+1]!==0;){if(s>=n)return n;s+=2}return s}for(;t[s]!==0;){if(s>=n)return n;s++}return s}function ON(t){const e=t.indexOf("\0");return e===-1?t:t.substr(0,e)}function HQ(t){const e=t.length;if(e&1)throw new Error("Buffer length must be even");for(let n=0;n<e;n+=2){const r=t[n];t[n]=t[n+1],t[n+1]=r}return t}function xt(t,e){if(t[0]===255&&t[1]===254)return xt(t.subarray(2),e);if(e==="utf-16le"&&t[0]===254&&t[1]===255){if(t.length&1)throw new Error("Expected even number of octets for 16-bit unicode string");return xt(HQ(t),e)}return new G(t.length,e).get(t,0)}function si(t){return t=t.replace(/^\x00+/g,""),t=t.replace(/\x00+$/g,""),t}function pe(t,e,n,r){const s=e+~~(n/8),i=n%8;let a=t[s];a&=255>>i;const l=8-i,c=r-l;return c<0?a>>=8-i-r:c>0&&(a<<=c,a|=pe(t,e,n+l,c)),a}function Pn(t,e,n){return pe(t,e,n,1)===1}function WQ(t){const e=[];for(let n=0,r=t.length;n<r;n++){const s=Number(t.charCodeAt(n)).toString(16);e.push(s.length===1?`0${s}`:s)}return e.join(" ")}function qQ(t){return 10*Math.log10(t)}function GQ(t){return 10**(t/10)}function QQ(t){const e=t.split(" ").map(n=>n.trim().toLowerCase());if(e.length>=1){const n=Number.parseFloat(e[0]);return e.length===2&&e[1]==="db"?{dB:n,ratio:GQ(n)}:{dB:qQ(n),ratio:n}}}var su;(function(t){t[t.Other=0]="Other",t[t["32x32 pixels 'file icon' (PNG only)"]=1]="32x32 pixels 'file icon' (PNG only)",t[t["Other file icon"]=2]="Other file icon",t[t["Cover (front)"]=3]="Cover (front)",t[t["Cover (back)"]=4]="Cover (back)",t[t["Leaflet page"]=5]="Leaflet page",t[t["Media (e.g. label side of CD)"]=6]="Media (e.g. label side of CD)",t[t["Lead artist/lead performer/soloist"]=7]="Lead artist/lead performer/soloist",t[t["Artist/performer"]=8]="Artist/performer",t[t.Conductor=9]="Conductor",t[t["Band/Orchestra"]=10]="Band/Orchestra",t[t.Composer=11]="Composer",t[t["Lyricist/text writer"]=12]="Lyricist/text writer",t[t["Recording Location"]=13]="Recording Location",t[t["During recording"]=14]="During recording",t[t["During performance"]=15]="During performance",t[t["Movie/video screen capture"]=16]="Movie/video screen capture",t[t["A bright coloured fish"]=17]="A bright coloured fish",t[t.Illustration=18]="Illustration",t[t["Band/artist logotype"]=19]="Band/artist logotype",t[t["Publisher/Studio logotype"]=20]="Publisher/Studio logotype"})(su||(su={}));var bb;(function(t){t[t.other=0]="other",t[t.lyrics=1]="lyrics",t[t.text=2]="text",t[t.movement_part=3]="movement_part",t[t.events=4]="events",t[t.chord=5]="chord",t[t.trivia_pop=6]="trivia_pop"})(bb||(bb={}));var kb;(function(t){t[t.notSynchronized0=0]="notSynchronized0",t[t.mpegFrameNumber=1]="mpegFrameNumber",t[t.milliseconds=2]="milliseconds"})(kb||(kb={}));const MN={get:(t,e)=>t[e+3]&127|t[e+2]<<7|t[e+1]<<14|t[e]<<21,len:4},qy={len:10,get:(t,e)=>({fileIdentifier:new G(3,"ascii").get(t,e),version:{major:ru.get(t,e+3),revision:ru.get(t,e+4)},flags:{unsynchronisation:tt(t,e+5,7),isExtendedHeader:tt(t,e+5,6),expIndicator:tt(t,e+5,5),footer:tt(t,e+5,4)},size:MN.get(t,e+6)})},Tb={len:10,get:(t,e)=>({size:Q.get(t,e),extendedFlags:je.get(t,e+4),sizeOfPadding:Q.get(t,e+6),crcDataPresent:tt(t,e+4,31)})},LN={len:1,get:(t,e)=>{switch(t[e]){case 0:return{encoding:"latin1"};case 1:return{encoding:"utf-16le",bom:!0};case 2:return{encoding:"utf-16le",bom:!1};case 3:return{encoding:"utf8",bom:!1};default:return{encoding:"utf8",bom:!1}}}},Gy={len:4,get:(t,e)=>({encoding:LN.get(t,e),language:new G(3,"latin1").get(t,e+1)})},Ib={len:6,get:(t,e)=>{const n=Gy.get(t,e);return{encoding:n.encoding,language:n.language,timeStampFormat:se.get(t,e+4),contentType:se.get(t,e+5)}}},hf={year:{multiple:!1},track:{multiple:!1},disk:{multiple:!1},title:{multiple:!1},artist:{multiple:!1},artists:{multiple:!0,unique:!0},albumartist:{multiple:!1},album:{multiple:!1},date:{multiple:!1},originaldate:{multiple:!1},originalyear:{multiple:!1},releasedate:{multiple:!1},comment:{multiple:!0,unique:!1},genre:{multiple:!0,unique:!0},picture:{multiple:!0,unique:!0},composer:{multiple:!0,unique:!0},lyrics:{multiple:!0,unique:!1},albumsort:{multiple:!1,unique:!0},titlesort:{multiple:!1,unique:!0},work:{multiple:!1,unique:!0},artistsort:{multiple:!1,unique:!0},albumartistsort:{multiple:!1,unique:!0},composersort:{multiple:!1,unique:!0},lyricist:{multiple:!0,unique:!0},writer:{multiple:!0,unique:!0},conductor:{multiple:!0,unique:!0},remixer:{multiple:!0,unique:!0},arranger:{multiple:!0,unique:!0},engineer:{multiple:!0,unique:!0},producer:{multiple:!0,unique:!0},technician:{multiple:!0,unique:!0},djmixer:{multiple:!0,unique:!0},mixer:{multiple:!0,unique:!0},label:{multiple:!0,unique:!0},grouping:{multiple:!1},subtitle:{multiple:!0},discsubtitle:{multiple:!1},totaltracks:{multiple:!1},totaldiscs:{multiple:!1},compilation:{multiple:!1},rating:{multiple:!0},bpm:{multiple:!1},mood:{multiple:!1},media:{multiple:!1},catalognumber:{multiple:!0,unique:!0},tvShow:{multiple:!1},tvShowSort:{multiple:!1},tvSeason:{multiple:!1},tvEpisode:{multiple:!1},tvEpisodeId:{multiple:!1},tvNetwork:{multiple:!1},podcast:{multiple:!1},podcasturl:{multiple:!1},releasestatus:{multiple:!1},releasetype:{multiple:!0},releasecountry:{multiple:!1},script:{multiple:!1},language:{multiple:!1},copyright:{multiple:!1},license:{multiple:!1},encodedby:{multiple:!1},encodersettings:{multiple:!1},gapless:{multiple:!1},barcode:{multiple:!1},isrc:{multiple:!0},asin:{multiple:!1},musicbrainz_recordingid:{multiple:!1},musicbrainz_trackid:{multiple:!1},musicbrainz_albumid:{multiple:!1},musicbrainz_artistid:{multiple:!0},musicbrainz_albumartistid:{multiple:!0},musicbrainz_releasegroupid:{multiple:!1},musicbrainz_workid:{multiple:!1},musicbrainz_trmid:{multiple:!1},musicbrainz_discid:{multiple:!1},acoustid_id:{multiple:!1},acoustid_fingerprint:{multiple:!1},musicip_puid:{multiple:!1},musicip_fingerprint:{multiple:!1},website:{multiple:!1},"performer:instrument":{multiple:!0,unique:!0},averageLevel:{multiple:!1},peakLevel:{multiple:!1},notes:{multiple:!0,unique:!1},key:{multiple:!1},originalalbum:{multiple:!1},originalartist:{multiple:!1},discogs_artist_id:{multiple:!0,unique:!0},discogs_release_id:{multiple:!1},discogs_label_id:{multiple:!1},discogs_master_release_id:{multiple:!1},discogs_votes:{multiple:!1},discogs_rating:{multiple:!1},replaygain_track_peak:{multiple:!1},replaygain_track_gain:{multiple:!1},replaygain_album_peak:{multiple:!1},replaygain_album_gain:{multiple:!1},replaygain_track_minmax:{multiple:!1},replaygain_album_minmax:{multiple:!1},replaygain_undo:{multiple:!1},description:{multiple:!0},longDescription:{multiple:!1},category:{multiple:!0},hdVideo:{multiple:!1},keywords:{multiple:!0},movement:{multiple:!1},movementIndex:{multiple:!1},movementTotal:{multiple:!1},podcastId:{multiple:!1},showMovement:{multiple:!1},stik:{multiple:!1}};function KQ(t){return hf[t]&&!hf[t].multiple}function XQ(t){return!hf[t].multiple||hf[t].unique||!1}class Mn{static toIntOrNull(e){const n=Number.parseInt(e,10);return Number.isNaN(n)?null:n}static normalizeTrack(e){const n=e.toString().split("/");return{no:Number.parseInt(n[0],10)||null,of:Number.parseInt(n[1],10)||null}}constructor(e,n){this.tagTypes=e,this.tagMap=n}mapGenericTag(e,n){e={id:e.id,value:e.value},this.postMap(e,n);const r=this.getCommonName(e.id);return r?{id:r,value:e.value}:null}getCommonName(e){return this.tagMap[e]}postMap(e,n){}}Mn.maxRatingScore=1;const YQ={title:"title",artist:"artist",album:"album",year:"year",comment:"comment",track:"track",genre:"genre"};class JQ extends Mn{constructor(){super(["ID3v1"],YQ)}}class qu extends Mn{constructor(e,n){const r={};for(const s of Object.keys(n))r[s.toUpperCase()]=n[s];super(e,r)}getCommonName(e){return this.tagMap[e.toUpperCase()]}}const ZQ={TIT2:"title",TPE1:"artist","TXXX:Artists":"artists",TPE2:"albumartist",TALB:"album",TDRV:"date",TORY:"originalyear",TPOS:"disk",TCON:"genre",APIC:"picture",TCOM:"composer",USLT:"lyrics",TSOA:"albumsort",TSOT:"titlesort",TOAL:"originalalbum",TSOP:"artistsort",TSO2:"albumartistsort",TSOC:"composersort",TEXT:"lyricist","TXXX:Writer":"writer",TPE3:"conductor",TPE4:"remixer","IPLS:arranger":"arranger","IPLS:engineer":"engineer","IPLS:producer":"producer","IPLS:DJ-mix":"djmixer","IPLS:mix":"mixer",TPUB:"label",TIT1:"grouping",TIT3:"subtitle",TRCK:"track",TCMP:"compilation",POPM:"rating",TBPM:"bpm",TMED:"media","TXXX:CATALOGNUMBER":"catalognumber","TXXX:MusicBrainz Album Status":"releasestatus","TXXX:MusicBrainz Album Type":"releasetype","TXXX:MusicBrainz Album Release Country":"releasecountry","TXXX:RELEASECOUNTRY":"releasecountry","TXXX:SCRIPT":"script",TLAN:"language",TCOP:"copyright",WCOP:"license",TENC:"encodedby",TSSE:"encodersettings","TXXX:BARCODE":"barcode","TXXX:ISRC":"isrc",TSRC:"isrc","TXXX:ASIN":"asin","TXXX:originalyear":"originalyear","UFID:http://musicbrainz.org":"musicbrainz_recordingid","TXXX:MusicBrainz Release Track Id":"musicbrainz_trackid","TXXX:MusicBrainz Album Id":"musicbrainz_albumid","TXXX:MusicBrainz Artist Id":"musicbrainz_artistid","TXXX:MusicBrainz Album Artist Id":"musicbrainz_albumartistid","TXXX:MusicBrainz Release Group Id":"musicbrainz_releasegroupid","TXXX:MusicBrainz Work Id":"musicbrainz_workid","TXXX:MusicBrainz TRM Id":"musicbrainz_trmid","TXXX:MusicBrainz Disc Id":"musicbrainz_discid","TXXX:ACOUSTID_ID":"acoustid_id","TXXX:Acoustid Id":"acoustid_id","TXXX:Acoustid Fingerprint":"acoustid_fingerprint","TXXX:MusicIP PUID":"musicip_puid","TXXX:MusicMagic Fingerprint":"musicip_fingerprint",WOAR:"website",TDRC:"date",TYER:"year",TDOR:"originaldate","TIPL:arranger":"arranger","TIPL:engineer":"engineer","TIPL:producer":"producer","TIPL:DJ-mix":"djmixer","TIPL:mix":"mixer",TMOO:"mood",SYLT:"lyrics",TSST:"discsubtitle",TKEY:"key",COMM:"comment",TOPE:"originalartist","PRIV:AverageLevel":"averageLevel","PRIV:PeakLevel":"peakLevel","TXXX:DISCOGS_ARTIST_ID":"discogs_artist_id","TXXX:DISCOGS_ARTISTS":"artists","TXXX:DISCOGS_ARTIST_NAME":"artists","TXXX:DISCOGS_ALBUM_ARTISTS":"albumartist","TXXX:DISCOGS_CATALOG":"catalognumber","TXXX:DISCOGS_COUNTRY":"releasecountry","TXXX:DISCOGS_DATE":"originaldate","TXXX:DISCOGS_LABEL":"label","TXXX:DISCOGS_LABEL_ID":"discogs_label_id","TXXX:DISCOGS_MASTER_RELEASE_ID":"discogs_master_release_id","TXXX:DISCOGS_RATING":"discogs_rating","TXXX:DISCOGS_RELEASED":"date","TXXX:DISCOGS_RELEASE_ID":"discogs_release_id","TXXX:DISCOGS_VOTES":"discogs_votes","TXXX:CATALOGID":"catalognumber","TXXX:STYLE":"genre","TXXX:REPLAYGAIN_TRACK_PEAK":"replaygain_track_peak","TXXX:REPLAYGAIN_TRACK_GAIN":"replaygain_track_gain","TXXX:REPLAYGAIN_ALBUM_PEAK":"replaygain_album_peak","TXXX:REPLAYGAIN_ALBUM_GAIN":"replaygain_album_gain","TXXX:MP3GAIN_MINMAX":"replaygain_track_minmax","TXXX:MP3GAIN_ALBUM_MINMAX":"replaygain_album_minmax","TXXX:MP3GAIN_UNDO":"replaygain_undo",MVNM:"movement",MVIN:"movementIndex",PCST:"podcast",TCAT:"category",TDES:"description",TDRL:"releasedate",TGID:"podcastId",TKWD:"keywords",WFED:"podcasturl",GRP1:"grouping"};class I1 extends qu{static toRating(e){return{source:e.email,rating:e.rating>0?(e.rating-1)/254*Mn.maxRatingScore:void 0}}constructor(){super(["ID3v2.3","ID3v2.4"],ZQ)}postMap(e,n){switch(e.id){case"UFID":{const r=e.value;r.owner_identifier==="http://musicbrainz.org"&&(e.id+=`:${r.owner_identifier}`,e.value=xt(r.identifier,"latin1"))}break;case"PRIV":{const r=e.value;switch(r.owner_identifier){case"AverageLevel":case"PeakValue":e.id+=`:${r.owner_identifier}`,e.value=r.data.length===4?U.get(r.data,0):null,e.value===null&&n.addWarning("Failed to parse PRIV:PeakValue");break;default:n.addWarning(`Unknown PRIV owner-identifier: ${r.data}`)}}break;case"POPM":e.value=I1.toRating(e.value);break}}}const eK={Title:"title",Author:"artist","WM/AlbumArtist":"albumartist","WM/AlbumTitle":"album","WM/Year":"date","WM/OriginalReleaseTime":"originaldate","WM/OriginalReleaseYear":"originalyear",Description:"comment","WM/TrackNumber":"track","WM/PartOfSet":"disk","WM/Genre":"genre","WM/Composer":"composer","WM/Lyrics":"lyrics","WM/AlbumSortOrder":"albumsort","WM/TitleSortOrder":"titlesort","WM/ArtistSortOrder":"artistsort","WM/AlbumArtistSortOrder":"albumartistsort","WM/ComposerSortOrder":"composersort","WM/Writer":"lyricist","WM/Conductor":"conductor","WM/ModifiedBy":"remixer","WM/Engineer":"engineer","WM/Producer":"producer","WM/DJMixer":"djmixer","WM/Mixer":"mixer","WM/Publisher":"label","WM/ContentGroupDescription":"grouping","WM/SubTitle":"subtitle","WM/SetSubTitle":"discsubtitle","WM/IsCompilation":"compilation","WM/SharedUserRating":"rating","WM/BeatsPerMinute":"bpm","WM/Mood":"mood","WM/Media":"media","WM/CatalogNo":"catalognumber","MusicBrainz/Album Status":"releasestatus","MusicBrainz/Album Type":"releasetype","MusicBrainz/Album Release Country":"releasecountry","WM/Script":"script","WM/Language":"language",Copyright:"copyright",LICENSE:"license","WM/EncodedBy":"encodedby","WM/EncodingSettings":"encodersettings","WM/Barcode":"barcode","WM/ISRC":"isrc","MusicBrainz/Track Id":"musicbrainz_recordingid","MusicBrainz/Release Track Id":"musicbrainz_trackid","MusicBrainz/Album Id":"musicbrainz_albumid","MusicBrainz/Artist Id":"musicbrainz_artistid","MusicBrainz/Album Artist Id":"musicbrainz_albumartistid","MusicBrainz/Release Group Id":"musicbrainz_releasegroupid","MusicBrainz/Work Id":"musicbrainz_workid","MusicBrainz/TRM Id":"musicbrainz_trmid","MusicBrainz/Disc Id":"musicbrainz_discid","Acoustid/Id":"acoustid_id","Acoustid/Fingerprint":"acoustid_fingerprint","MusicIP/PUID":"musicip_puid","WM/ARTISTS":"artists","WM/InitialKey":"key",ASIN:"asin","WM/Work":"work","WM/AuthorURL":"website","WM/Picture":"picture"};class C1 extends Mn{static toRating(e){return{rating:Number.parseFloat(e+1)/5}}constructor(){super(["asf"],eK)}postMap(e){switch(e.id){case"WM/SharedUserRating":{const n=e.id.split(":");e.value=C1.toRating(e.value),e.id=n[0];break}}}}const tK={TT2:"title",TP1:"artist",TP2:"albumartist",TAL:"album",TYE:"year",COM:"comment",TRK:"track",TPA:"disk",TCO:"genre",PIC:"picture",TCM:"composer",TOR:"originaldate",TOT:"originalalbum",TXT:"lyricist",TP3:"conductor",TPB:"label",TT1:"grouping",TT3:"subtitle",TLA:"language",TCR:"copyright",WCP:"license",TEN:"encodedby",TSS:"encodersettings",WAR:"website",PCS:"podcast",TCP:"compilation",TDR:"date",TS2:"albumartistsort",TSA:"albumsort",TSC:"composersort",TSP:"artistsort",TST:"titlesort",WFD:"podcasturl",TBP:"bpm"};class nK extends qu{constructor(){super(["ID3v2.2"],tK)}}const rK={Title:"title",Artist:"artist",Artists:"artists","Album Artist":"albumartist",Album:"album",Year:"date",Originalyear:"originalyear",Originaldate:"originaldate",Releasedate:"releasedate",Comment:"comment",Track:"track",Disc:"disk",DISCNUMBER:"disk",Genre:"genre","Cover Art (Front)":"picture","Cover Art (Back)":"picture",Composer:"composer",Lyrics:"lyrics",ALBUMSORT:"albumsort",TITLESORT:"titlesort",WORK:"work",ARTISTSORT:"artistsort",ALBUMARTISTSORT:"albumartistsort",COMPOSERSORT:"composersort",Lyricist:"lyricist",Writer:"writer",Conductor:"conductor",MixArtist:"remixer",Arranger:"arranger",Engineer:"engineer",Producer:"producer",DJMixer:"djmixer",Mixer:"mixer",Label:"label",Grouping:"grouping",Subtitle:"subtitle",DiscSubtitle:"discsubtitle",Compilation:"compilation",BPM:"bpm",Mood:"mood",Media:"media",CatalogNumber:"catalognumber",MUSICBRAINZ_ALBUMSTATUS:"releasestatus",MUSICBRAINZ_ALBUMTYPE:"releasetype",RELEASECOUNTRY:"releasecountry",Script:"script",Language:"language",Copyright:"copyright",LICENSE:"license",EncodedBy:"encodedby",EncoderSettings:"encodersettings",Barcode:"barcode",ISRC:"isrc",ASIN:"asin",musicbrainz_trackid:"musicbrainz_recordingid",musicbrainz_releasetrackid:"musicbrainz_trackid",MUSICBRAINZ_ALBUMID:"musicbrainz_albumid",MUSICBRAINZ_ARTISTID:"musicbrainz_artistid",MUSICBRAINZ_ALBUMARTISTID:"musicbrainz_albumartistid",MUSICBRAINZ_RELEASEGROUPID:"musicbrainz_releasegroupid",MUSICBRAINZ_WORKID:"musicbrainz_workid",MUSICBRAINZ_TRMID:"musicbrainz_trmid",MUSICBRAINZ_DISCID:"musicbrainz_discid",Acoustid_Id:"acoustid_id",ACOUSTID_FINGERPRINT:"acoustid_fingerprint",MUSICIP_PUID:"musicip_puid",Weblink:"website",REPLAYGAIN_TRACK_GAIN:"replaygain_track_gain",REPLAYGAIN_TRACK_PEAK:"replaygain_track_peak",MP3GAIN_MINMAX:"replaygain_track_minmax",MP3GAIN_UNDO:"replaygain_undo"};class sK extends qu{constructor(){super(["APEv2"],rK)}}const iK={"©nam":"title","©ART":"artist",aART:"albumartist","----:com.apple.iTunes:Band":"albumartist","©alb":"album","©day":"date","©cmt":"comment","©com":"comment",trkn:"track",disk:"disk","©gen":"genre",covr:"picture","©wrt":"composer","©lyr":"lyrics",soal:"albumsort",sonm:"titlesort",soar:"artistsort",soaa:"albumartistsort",soco:"composersort","----:com.apple.iTunes:LYRICIST":"lyricist","----:com.apple.iTunes:CONDUCTOR":"conductor","----:com.apple.iTunes:REMIXER":"remixer","----:com.apple.iTunes:ENGINEER":"engineer","----:com.apple.iTunes:PRODUCER":"producer","----:com.apple.iTunes:DJMIXER":"djmixer","----:com.apple.iTunes:MIXER":"mixer","----:com.apple.iTunes:LABEL":"label","©grp":"grouping","----:com.apple.iTunes:SUBTITLE":"subtitle","----:com.apple.iTunes:DISCSUBTITLE":"discsubtitle",cpil:"compilation",tmpo:"bpm","----:com.apple.iTunes:MOOD":"mood","----:com.apple.iTunes:MEDIA":"media","----:com.apple.iTunes:CATALOGNUMBER":"catalognumber",tvsh:"tvShow",tvsn:"tvSeason",tves:"tvEpisode",sosn:"tvShowSort",tven:"tvEpisodeId",tvnn:"tvNetwork",pcst:"podcast",purl:"podcasturl","----:com.apple.iTunes:MusicBrainz Album Status":"releasestatus","----:com.apple.iTunes:MusicBrainz Album Type":"releasetype","----:com.apple.iTunes:MusicBrainz Album Release Country":"releasecountry","----:com.apple.iTunes:SCRIPT":"script","----:com.apple.iTunes:LANGUAGE":"language",cprt:"copyright","©cpy":"copyright","----:com.apple.iTunes:LICENSE":"license","©too":"encodedby",pgap:"gapless","----:com.apple.iTunes:BARCODE":"barcode","----:com.apple.iTunes:ISRC":"isrc","----:com.apple.iTunes:ASIN":"asin","----:com.apple.iTunes:NOTES":"comment","----:com.apple.iTunes:MusicBrainz Track Id":"musicbrainz_recordingid","----:com.apple.iTunes:MusicBrainz Release Track Id":"musicbrainz_trackid","----:com.apple.iTunes:MusicBrainz Album Id":"musicbrainz_albumid","----:com.apple.iTunes:MusicBrainz Artist Id":"musicbrainz_artistid","----:com.apple.iTunes:MusicBrainz Album Artist Id":"musicbrainz_albumartistid","----:com.apple.iTunes:MusicBrainz Release Group Id":"musicbrainz_releasegroupid","----:com.apple.iTunes:MusicBrainz Work Id":"musicbrainz_workid","----:com.apple.iTunes:MusicBrainz TRM Id":"musicbrainz_trmid","----:com.apple.iTunes:MusicBrainz Disc Id":"musicbrainz_discid","----:com.apple.iTunes:Acoustid Id":"acoustid_id","----:com.apple.iTunes:Acoustid Fingerprint":"acoustid_fingerprint","----:com.apple.iTunes:MusicIP PUID":"musicip_puid","----:com.apple.iTunes:fingerprint":"musicip_fingerprint","----:com.apple.iTunes:replaygain_track_gain":"replaygain_track_gain","----:com.apple.iTunes:replaygain_track_peak":"replaygain_track_peak","----:com.apple.iTunes:replaygain_album_gain":"replaygain_album_gain","----:com.apple.iTunes:replaygain_album_peak":"replaygain_album_peak","----:com.apple.iTunes:replaygain_track_minmax":"replaygain_track_minmax","----:com.apple.iTunes:replaygain_album_minmax":"replaygain_album_minmax","----:com.apple.iTunes:replaygain_undo":"replaygain_undo",gnre:"genre","----:com.apple.iTunes:ALBUMARTISTSORT":"albumartistsort","----:com.apple.iTunes:ARTISTS":"artists","----:com.apple.iTunes:ORIGINALDATE":"originaldate","----:com.apple.iTunes:ORIGINALYEAR":"originalyear","----:com.apple.iTunes:RELEASEDATE":"releasedate",desc:"description",ldes:"longDescription","©mvn":"movement","©mvi":"movementIndex","©mvc":"movementTotal","©wrk":"work",catg:"category",egid:"podcastId",hdvd:"hdVideo",keyw:"keywords",shwm:"showMovement",stik:"stik",rate:"rating"},aK="iTunes";class Cb extends qu{constructor(){super([aK],iK)}postMap(e,n){switch(e.id){case"rate":e.value={source:void 0,rating:Number.parseFloat(e.value)/100};break}}}const oK={TITLE:"title",ARTIST:"artist",ARTISTS:"artists",ALBUMARTIST:"albumartist","ALBUM ARTIST":"albumartist",ALBUM:"album",DATE:"date",ORIGINALDATE:"originaldate",ORIGINALYEAR:"originalyear",RELEASEDATE:"releasedate",COMMENT:"comment",TRACKNUMBER:"track",DISCNUMBER:"disk",GENRE:"genre",METADATA_BLOCK_PICTURE:"picture",COMPOSER:"composer",LYRICS:"lyrics",ALBUMSORT:"albumsort",TITLESORT:"titlesort",WORK:"work",ARTISTSORT:"artistsort",ALBUMARTISTSORT:"albumartistsort",COMPOSERSORT:"composersort",LYRICIST:"lyricist",WRITER:"writer",CONDUCTOR:"conductor",REMIXER:"remixer",ARRANGER:"arranger",ENGINEER:"engineer",PRODUCER:"producer",DJMIXER:"djmixer",MIXER:"mixer",LABEL:"label",GROUPING:"grouping",SUBTITLE:"subtitle",DISCSUBTITLE:"discsubtitle",TRACKTOTAL:"totaltracks",DISCTOTAL:"totaldiscs",COMPILATION:"compilation",RATING:"rating",BPM:"bpm",KEY:"key",MOOD:"mood",MEDIA:"media",CATALOGNUMBER:"catalognumber",RELEASESTATUS:"releasestatus",RELEASETYPE:"releasetype",RELEASECOUNTRY:"releasecountry",SCRIPT:"script",LANGUAGE:"language",COPYRIGHT:"copyright",LICENSE:"license",ENCODEDBY:"encodedby",ENCODERSETTINGS:"encodersettings",BARCODE:"barcode",ISRC:"isrc",ASIN:"asin",MUSICBRAINZ_TRACKID:"musicbrainz_recordingid",MUSICBRAINZ_RELEASETRACKID:"musicbrainz_trackid",MUSICBRAINZ_ALBUMID:"musicbrainz_albumid",MUSICBRAINZ_ARTISTID:"musicbrainz_artistid",MUSICBRAINZ_ALBUMARTISTID:"musicbrainz_albumartistid",MUSICBRAINZ_RELEASEGROUPID:"musicbrainz_releasegroupid",MUSICBRAINZ_WORKID:"musicbrainz_workid",MUSICBRAINZ_TRMID:"musicbrainz_trmid",MUSICBRAINZ_DISCID:"musicbrainz_discid",ACOUSTID_ID:"acoustid_id",ACOUSTID_ID_FINGERPRINT:"acoustid_fingerprint",MUSICIP_PUID:"musicip_puid",WEBSITE:"website",NOTES:"notes",TOTALTRACKS:"totaltracks",TOTALDISCS:"totaldiscs",DISCOGS_ARTIST_ID:"discogs_artist_id",DISCOGS_ARTISTS:"artists",DISCOGS_ARTIST_NAME:"artists",DISCOGS_ALBUM_ARTISTS:"albumartist",DISCOGS_CATALOG:"catalognumber",DISCOGS_COUNTRY:"releasecountry",DISCOGS_DATE:"originaldate",DISCOGS_LABEL:"label",DISCOGS_LABEL_ID:"discogs_label_id",DISCOGS_MASTER_RELEASE_ID:"discogs_master_release_id",DISCOGS_RATING:"discogs_rating",DISCOGS_RELEASED:"date",DISCOGS_RELEASE_ID:"discogs_release_id",DISCOGS_VOTES:"discogs_votes",CATALOGID:"catalognumber",STYLE:"genre",REPLAYGAIN_TRACK_GAIN:"replaygain_track_gain",REPLAYGAIN_TRACK_PEAK:"replaygain_track_peak",REPLAYGAIN_ALBUM_GAIN:"replaygain_album_gain",REPLAYGAIN_ALBUM_PEAK:"replaygain_album_peak",REPLAYGAIN_MINMAX:"replaygain_track_minmax",REPLAYGAIN_ALBUM_MINMAX:"replaygain_album_minmax",REPLAYGAIN_UNDO:"replaygain_undo"};class ff extends Mn{static toRating(e,n,r){return{source:e?e.toLowerCase():void 0,rating:Number.parseFloat(n)/r*Mn.maxRatingScore}}constructor(){super(["vorbis"],oK)}postMap(e){if(e.id==="RATING")e.value=ff.toRating(void 0,e.value,100);else if(e.id.indexOf("RATING:")===0){const n=e.id.split(":");e.value=ff.toRating(n[1],e.value,1),e.id=n[0]}}}const lK={IART:"artist",ICRD:"date",INAM:"title",TITL:"title",IPRD:"album",ITRK:"track",IPRT:"track",COMM:"comment",ICMT:"comment",ICNT:"releasecountry",GNRE:"genre",IWRI:"writer",RATE:"rating",YEAR:"year",ISFT:"encodedby",CODE:"encodedby",TURL:"website",IGNR:"genre",IENG:"engineer",ITCH:"technician",IMED:"media",IRPD:"album"};class cK extends Mn{constructor(){super(["exif"],lK)}}const uK={"segment:title":"title","album:ARTIST":"albumartist","album:ARTISTSORT":"albumartistsort","album:TITLE":"album","album:DATE_RECORDED":"originaldate","album:DATE_RELEASED":"releasedate","album:PART_NUMBER":"disk","album:TOTAL_PARTS":"totaltracks","track:ARTIST":"artist","track:ARTISTSORT":"artistsort","track:TITLE":"title","track:PART_NUMBER":"track","track:MUSICBRAINZ_TRACKID":"musicbrainz_recordingid","track:MUSICBRAINZ_ALBUMID":"musicbrainz_albumid","track:MUSICBRAINZ_ARTISTID":"musicbrainz_artistid","track:PUBLISHER":"label","track:GENRE":"genre","track:ENCODER":"encodedby","track:ENCODER_OPTIONS":"encodersettings","edition:TOTAL_PARTS":"totaldiscs",picture:"picture"};class dK extends qu{constructor(){super(["matroska"],uK)}}const hK={NAME:"title",AUTH:"artist","(c) ":"copyright",ANNO:"comment"};class fK extends Mn{constructor(){super(["AIFF"],hK)}}class mK{constructor(){this.tagMappers={},[new JQ,new nK,new I1,new Cb,new Cb,new ff,new sK,new C1,new cK,new dK,new fK].forEach(e=>{this.registerTagMapper(e)})}mapTag(e,n,r){if(this.tagMappers[e])return this.tagMappers[e].mapGenericTag(n,r);throw new Error(`No generic tag mapper defined for tag-format: ${e}`)}registerTagMapper(e){for(const n of e.tagTypes)this.tagMappers[n]=e}}const Gi=De("music-metadata:collector"),pK=["matroska","APEv2","vorbis","ID3v2.4","ID3v2.3","ID3v2.2","exif","asf","iTunes","AIFF","ID3v1"];class gK{constructor(e){this.opts=e,this.format={tagTypes:[],trackInfo:[]},this.native={},this.common={track:{no:null,of:null},disk:{no:null,of:null},movementIndex:{no:null,of:null}},this.quality={warnings:[]},this.commonOrigin={},this.originPriority={},this.tagMapper=new mK;let n=1;for(const r of pK)this.originPriority[r]=n++;this.originPriority.artificial=500,this.originPriority.id3v1=600}hasAny(){return Object.keys(this.native).length>0}addStreamInfo(e){Gi(`streamInfo: type=${e.type?Ca[e.type]:"?"}, codec=${e.codecName}`),this.format.trackInfo.push(e)}setFormat(e,n){var r;Gi(`format: ${e} = ${n}`),this.format[e]=n,(r=this.opts)!=null&&r.observer&&this.opts.observer({metadata:this,tag:{type:"format",id:e,value:n}})}async addTag(e,n,r){Gi(`tag ${e}.${n} = ${r}`),this.native[e]||(this.format.tagTypes.push(e),this.native[e]=[]),this.native[e].push({id:n,value:r}),await this.toCommon(e,n,r)}addWarning(e){this.quality.warnings.push({message:e})}async postMap(e,n){switch(n.id){case"artist":if(this.commonOrigin.artist===this.originPriority[e])return this.postMap("artificial",{id:"artists",value:n.value});this.common.artists||this.setGenericTag("artificial",{id:"artists",value:n.value});break;case"artists":if((!this.common.artist||this.commonOrigin.artist===this.originPriority.artificial)&&(!this.common.artists||this.common.artists.indexOf(n.value)===-1)){const r=(this.common.artists||[]).concat([n.value]),i={id:"artist",value:yK(r)};this.setGenericTag("artificial",i)}break;case"picture":return this.postFixPicture(n.value).then(r=>{r!==null&&(n.value=r,this.setGenericTag(e,n))});case"totaltracks":this.common.track.of=Mn.toIntOrNull(n.value);return;case"totaldiscs":this.common.disk.of=Mn.toIntOrNull(n.value);return;case"movementTotal":this.common.movementIndex.of=Mn.toIntOrNull(n.value);return;case"track":case"disk":case"movementIndex":{const r=this.common[n.id].of;this.common[n.id]=Mn.normalizeTrack(n.value),this.common[n.id].of=r??this.common[n.id].of;return}case"bpm":case"year":case"originalyear":n.value=Number.parseInt(n.value,10);break;case"date":{const r=Number.parseInt(n.value.substr(0,4),10);Number.isNaN(r)||(this.common.year=r);break}case"discogs_label_id":case"discogs_release_id":case"discogs_master_release_id":case"discogs_artist_id":case"discogs_votes":n.value=typeof n.value=="string"?Number.parseInt(n.value,10):n.value;break;case"replaygain_track_gain":case"replaygain_track_peak":case"replaygain_album_gain":case"replaygain_album_peak":n.value=QQ(n.value);break;case"replaygain_track_minmax":n.value=n.value.split(",").map(r=>Number.parseInt(r,10));break;case"replaygain_undo":{const r=n.value.split(",").map(s=>Number.parseInt(s,10));n.value={leftChannel:r[0],rightChannel:r[1]};break}case"gapless":case"compilation":case"podcast":case"showMovement":n.value=n.value==="1"||n.value===1;break;case"isrc":{const r=this.common[n.id];if(r&&r.indexOf(n.value)!==-1)return;break}case"comment":typeof n.value=="string"&&(n.value={text:n.value}),n.value.descriptor==="iTunPGAP"&&this.setGenericTag(e,{id:"gapless",value:n.value.text==="1"});break}n.value!==null&&this.setGenericTag(e,n)}toCommonMetadata(){return{format:this.format,native:this.native,quality:this.quality,common:this.common}}async postFixPicture(e){if(e.data&&e.data.length>0){if(!e.format){const n=await PN(Uint8Array.from(e.data));if(n)e.format=n.mime;else return null}switch(e.format=e.format.toLocaleLowerCase(),e.format){case"image/jpg":e.format="image/jpeg"}return e}return this.addWarning("Empty picture tag found"),null}async toCommon(e,n,r){const s={id:n,value:r},i=this.tagMapper.mapTag(e,s,this);i&&await this.postMap(e,i)}setGenericTag(e,n){var i;Gi(`common.${n.id} = ${n.value}`);const r=this.commonOrigin[n.id]||1e3,s=this.originPriority[e];if(KQ(n.id))if(s<=r)this.common[n.id]=n.value,this.commonOrigin[n.id]=s;else return Gi(`Ignore native tag (singleton): ${e}.${n.id} = ${n.value}`);else if(s===r)!XQ(n.id)||this.common[n.id].indexOf(n.value)===-1?this.common[n.id].push(n.value):Gi(`Ignore duplicate value: ${e}.${n.id} = ${n.value}`);else if(s<r)this.common[n.id]=[n.value],this.commonOrigin[n.id]=s;else return Gi(`Ignore native tag (list): ${e}.${n.id} = ${n.value}`);(i=this.opts)!=null&&i.observer&&this.opts.observer({metadata:this,tag:{type:"common",id:n.id,value:n.value}})}}function yK(t){return t.length>2?`${t.slice(0,t.length-1).join(", ")} & ${t[t.length-1]}`:t.join(" & ")}class Yn{constructor(){this.metadata=void 0,this.tokenizer=void 0,this.options=void 0}init(e,n,r){return this.metadata=e,this.tokenizer=n,this.options=r,this}}const xK=/^[\x21-\x7e©][\x20-\x7e\x00()]{3}/,He={len:4,get:(t,e)=>{const n=b1(t.slice(e,e+He.len),"latin1");if(!n.match(xK))throw new Error(`FourCC contains invalid characters: ${WQ(n)} "${n}"`);return n},put:(t,e,n)=>{const r=vQ(n);if(r.length!==4)throw new Error("Invalid length");return t.set(r,e),e+4}};var po;(function(t){t[t.text_utf8=0]="text_utf8",t[t.binary=1]="binary",t[t.external_info=2]="external_info",t[t.reserved=3]="reserved"})(po||(po={}));const Rb={len:52,get:(t,e)=>({ID:He.get(t,e),version:U.get(t,e+4)/1e3,descriptorBytes:U.get(t,e+8),headerBytes:U.get(t,e+12),seekTableBytes:U.get(t,e+16),headerDataBytes:U.get(t,e+20),apeFrameDataBytes:U.get(t,e+24),apeFrameDataBytesHigh:U.get(t,e+28),terminatingDataBytes:U.get(t,e+32),fileMD5:new gn(16).get(t,e+36)})},vK={len:24,get:(t,e)=>({compressionLevel:Te.get(t,e),formatFlags:Te.get(t,e+2),blocksPerFrame:U.get(t,e+4),finalFrameBlocks:U.get(t,e+8),totalFrames:U.get(t,e+12),bitsPerSample:Te.get(t,e+16),channel:Te.get(t,e+18),sampleRate:U.get(t,e+20)})},Zn={len:32,get:(t,e)=>({ID:new G(8,"ascii").get(t,e),version:U.get(t,e+8),size:U.get(t,e+12),fields:U.get(t,e+16),flags:$N(U.get(t,e+20))})},Lg={len:8,get:(t,e)=>({size:U.get(t,e),flags:$N(U.get(t,e+4))})};function $N(t){return{containsHeader:bd(t,31),containsFooter:bd(t,30),isHeader:bd(t,29),readOnly:bd(t,0),dataType:(t&6)>>1}}function bd(t,e){return(t&1<<e)!==0}const Qi=De("music-metadata:parser:APEv2"),Ab="APEv2",jb="APETAGEX";class qr extends Yn{constructor(){super(...arguments),this.ape={}}static tryParseApeHeader(e,n,r){const s=new qr;return s.init(e,n,r),s.tryParseApeHeader()}static calculateDuration(e){let n=e.totalFrames>1?e.blocksPerFrame*(e.totalFrames-1):0;return n+=e.finalFrameBlocks,n/e.sampleRate}static async findApeFooterOffset(e,n){const r=new Uint8Array(Zn.len);await e.randomRead(r,0,Zn.len,n-Zn.len);const s=Zn.get(r,0);if(s.ID==="APETAGEX")return s.flags.isHeader?Qi(`APE Header found at offset=${n-Zn.len}`):(Qi(`APE Footer found at offset=${n-Zn.len}`),n-=s.size),{footer:s,offset:n}}static parseTagFooter(e,n,r){const s=Zn.get(n,n.length-Zn.len);if(s.ID!==jb)throw new Error("Unexpected APEv2 Footer ID preamble value.");Xo(n);const i=new qr;return i.init(e,Xo(n),r),i.parseTags(s)}async tryParseApeHeader(){if(this.tokenizer.fileInfo.size&&this.tokenizer.fileInfo.size-this.tokenizer.position<Zn.len){Qi("No APEv2 header found, end-of-file reached");return}const e=await this.tokenizer.peekToken(Zn);if(e.ID===jb)return await this.tokenizer.ignore(Zn.len),this.parseTags(e);if(Qi(`APEv2 header not found at offset=${this.tokenizer.position}`),this.tokenizer.fileInfo.size){const n=this.tokenizer.fileInfo.size-this.tokenizer.position,r=new Uint8Array(n);return await this.tokenizer.readBuffer(r),qr.parseTagFooter(this.metadata,r,this.options)}}async parse(){const e=await this.tokenizer.readToken(Rb);if(e.ID!=="MAC ")throw new Error("Unexpected descriptor ID");this.ape.descriptor=e;const n=e.descriptorBytes-Rb.len,r=await(n>0?this.parseDescriptorExpansion(n):this.parseHeader());return await this.tokenizer.ignore(r.forwardBytes),this.tryParseApeHeader()}async parseTags(e){const n=new Uint8Array(256);let r=e.size-Zn.len;Qi(`Parse APE tags at offset=${this.tokenizer.position}, size=${r}`);for(let s=0;s<e.fields;s++){if(r<Lg.len){this.metadata.addWarning(`APEv2 Tag-header: ${e.fields-s} items remaining, but no more tag data to read.`);break}const i=await this.tokenizer.readToken(Lg);r-=Lg.len+i.size,await this.tokenizer.peekBuffer(n,{length:Math.min(n.length,r)});let a=Rn(n,0,n.length);const l=await this.tokenizer.readToken(new G(a,"ascii"));switch(await this.tokenizer.ignore(1),r-=l.length+1,i.flags.dataType){case po.text_utf8:{const u=(await this.tokenizer.readToken(new G(i.size,"utf8"))).split(/\x00/g);await Promise.all(u.map(d=>this.metadata.addTag(Ab,l,d)));break}case po.binary:if(this.options.skipCovers)await this.tokenizer.ignore(i.size);else{const c=new Uint8Array(i.size);await this.tokenizer.readBuffer(c),a=Rn(c,0,c.length);const u=b1(c.slice(0,a)),d=c.slice(a+1);await this.metadata.addTag(Ab,l,{description:u,data:d})}break;case po.external_info:Qi(`Ignore external info ${l}`),await this.tokenizer.ignore(i.size);break;case po.reserved:Qi(`Ignore external info ${l}`),this.metadata.addWarning(`APEv2 header declares a reserved datatype for "${l}"`),await this.tokenizer.ignore(i.size);break}}}async parseDescriptorExpansion(e){return await this.tokenizer.ignore(e),this.parseHeader()}async parseHeader(){const e=await this.tokenizer.readToken(vK);if(this.metadata.setFormat("lossless",!0),this.metadata.setFormat("container","Monkey's Audio"),this.metadata.setFormat("bitsPerSample",e.bitsPerSample),this.metadata.setFormat("sampleRate",e.sampleRate),this.metadata.setFormat("numberOfChannels",e.channel),this.metadata.setFormat("duration",qr.calculateDuration(e)),!this.ape.descriptor)throw new Error("Missing APE descriptor");return{forwardBytes:this.ape.descriptor.seekTableBytes+this.ape.descriptor.headerDataBytes+this.ape.descriptor.apeFrameDataBytes+this.ape.descriptor.terminatingDataBytes}}}const kd=De("music-metadata:parser:ID3v1"),mf=["Blues","Classic Rock","Country","Dance","Disco","Funk","Grunge","Hip-Hop","Jazz","Metal","New Age","Oldies","Other","Pop","R&B","Rap","Reggae","Rock","Techno","Industrial","Alternative","Ska","Death Metal","Pranks","Soundtrack","Euro-Techno","Ambient","Trip-Hop","Vocal","Jazz+Funk","Fusion","Trance","Classical","Instrumental","Acid","House","Game","Sound Clip","Gospel","Noise","Alt. Rock","Bass","Soul","Punk","Space","Meditative","Instrumental Pop","Instrumental Rock","Ethnic","Gothic","Darkwave","Techno-Industrial","Electronic","Pop-Folk","Eurodance","Dream","Southern Rock","Comedy","Cult","Gangsta Rap","Top 40","Christian Rap","Pop/Funk","Jungle","Native American","Cabaret","New Wave","Psychedelic","Rave","Showtunes","Trailer","Lo-Fi","Tribal","Acid Punk","Acid Jazz","Polka","Retro","Musical","Rock & Roll","Hard Rock","Folk","Folk/Rock","National Folk","Swing","Fast-Fusion","Bebob","Latin","Revival","Celtic","Bluegrass","Avantgarde","Gothic Rock","Progressive Rock","Psychedelic Rock","Symphonic Rock","Slow Rock","Big Band","Chorus","Easy Listening","Acoustic","Humour","Speech","Chanson","Opera","Chamber Music","Sonata","Symphony","Booty Bass","Primus","Porn Groove","Satire","Slow Jam","Club","Tango","Samba","Folklore","Ballad","Power Ballad","Rhythmic Soul","Freestyle","Duet","Punk Rock","Drum Solo","A Cappella","Euro-House","Dance Hall","Goa","Drum & Bass","Club-House","Hardcore","Terror","Indie","BritPop","Negerpunk","Polsk Punk","Beat","Christian Gangsta Rap","Heavy Metal","Black Metal","Crossover","Contemporary Christian","Christian Rock","Merengue","Salsa","Thrash Metal","Anime","JPop","Synthpop","Abstract","Art Rock","Baroque","Bhangra","Big Beat","Breakbeat","Chillout","Downtempo","Dub","EBM","Eclectic","Electro","Electroclash","Emo","Experimental","Garage","Global","IDM","Illbient","Industro-Goth","Jam Band","Krautrock","Leftfield","Lounge","Math Rock","New Romantic","Nu-Breakz","Post-Punk","Post-Rock","Psytrance","Shoegaze","Space Rock","Trop Rock","World Music","Neoclassical","Audiobook","Audio Theatre","Neue Deutsche Welle","Podcast","Indie Rock","G-Funk","Dubstep","Garage Rock","Psybient"],Td={len:128,get:(t,e)=>{const n=new Qa(3).get(t,e);return n==="TAG"?{header:n,title:new Qa(30).get(t,e+3),artist:new Qa(30).get(t,e+33),album:new Qa(30).get(t,e+63),year:new Qa(4).get(t,e+93),comment:new Qa(28).get(t,e+97),zeroByte:se.get(t,e+127),track:se.get(t,e+126),genre:se.get(t,e+127)}:null}};class Qa{constructor(e){this.len=e,this.stringType=new G(e,"latin1")}get(e,n){let r=this.stringType.get(e,n);return r=ON(r),r=r.trim(),r.length>0?r:void 0}}class R1 extends Yn{static getGenre(e){if(e<mf.length)return mf[e]}async parse(){if(!this.tokenizer.fileInfo.size){kd("Skip checking for ID3v1 because the file-size is unknown");return}if(this.options.apeHeader){this.tokenizer.ignore(this.options.apeHeader.offset-this.tokenizer.position);const r=new qr;r.init(this.metadata,this.tokenizer,this.options),await r.parseTags(this.options.apeHeader.footer)}const e=this.tokenizer.fileInfo.size-Td.len;if(this.tokenizer.position>e){kd("Already consumed the last 128 bytes");return}const n=await this.tokenizer.readToken(Td,e);if(n){kd("ID3v1 header found at: pos=%s",this.tokenizer.fileInfo.size-Td.len);const r=["title","artist","album","comment","track","year"];for(const i of r)n[i]&&n[i]!==""&&await this.addTag(i,n[i]);const s=R1.getGenre(n.genre);s&&await this.addTag("genre",s)}else kd("ID3v1 header not found at: pos=%s",this.tokenizer.fileInfo.size-Td.len)}async addTag(e,n){await this.metadata.addTag("ID3v1",e,n)}}const Nb=De("music-metadata:id3v2:frame-parser"),vr="latin1";function wK(t){const e=[];let n,r="";for(const s of t)if(typeof n=="string")if(s==="("&&n==="")r+="(",n=void 0;else if(s===")"){r!==""&&(e.push(r),r="");const i=Pb(n);i&&e.push(i),n=void 0}else n+=s;else s==="("?n="":r+=s;return r&&(e.length===0&&r.match(/^\d*$/)&&(r=Pb(r)),r&&e.push(r)),e}function Pb(t){if(t==="RX")return"Remix";if(t==="CR")return"Cover";if(t.match(/^\d*$/))return mf[Number.parseInt(t)]}class An{constructor(e,n){this.major=e,this.warningCollector=n}readData(e,n,r){if(e.length===0){this.warningCollector.addWarning(`id3v2.${this.major} header has empty tag type=${n}`);return}const{encoding:s,bom:i}=LN.get(e,0),a=e.length;let l=0,c=[];const u=An.getNullTerminatorLength(s);let d;switch(Nb(`Parsing tag type=${n}, encoding=${s}, bom=${i}`),n!=="TXXX"&&n[0]==="T"?"T*":n){case"T*":case"GRP1":case"IPLS":case"MVIN":case"MVNM":case"PCS":case"PCST":{let h;try{h=xt(e.slice(1),s).replace(/\x00+$/,"")}catch(m){if(m instanceof Error){this.warningCollector.addWarning(`id3v2.${this.major} type=${n} header has invalid string value: ${m.message}`);break}throw m}switch(n){case"TMCL":case"TIPL":case"IPLS":c=An.functionList(this.splitValue(n,h));break;case"TRK":case"TRCK":case"TPOS":c=h;break;case"TCOM":case"TEXT":case"TOLY":case"TOPE":case"TPE1":case"TSRC":c=this.splitValue(n,h);break;case"TCO":case"TCON":c=this.splitValue(n,h).map(m=>wK(m)).reduce((m,p)=>m.concat(p),[]);break;case"PCS":case"PCST":c=this.major>=4?this.splitValue(n,h):[h],c=Array.isArray(c)&&c[0]===""?1:0;break;default:c=this.major>=4?this.splitValue(n,h):[h]}break}case"TXXX":{const h=An.readIdentifierAndData(e,l+1,a,s);c={description:h.id,text:this.splitValue(n,xt(h.data,s).replace(/\x00+$/,""))};break}case"PIC":case"APIC":if(r){const h={};switch(l+=1,this.major){case 2:h.format=xt(e.slice(l,l+3),"latin1"),l+=3;break;case 3:case 4:d=Rn(e,l,a,vr),h.format=xt(e.slice(l,d),vr),l=d+1;break;default:throw new Error(`Warning: unexpected major versionIndex: ${this.major}`)}h.format=An.fixPictureMimeType(h.format),h.type=su[e[l]],l+=1,d=Rn(e,l,a,s),h.description=xt(e.slice(l,d),s),l=d+u,h.data=e.slice(l,a),c=h}break;case"CNT":case"PCNT":c=Q.get(e,0);break;case"SYLT":{const h=Ib.get(e,0);l+=Ib.len;const m={descriptor:"",language:h.language,contentType:h.contentType,timeStampFormat:h.timeStampFormat,syncText:[]};let p=!1;for(;l<a;){const g=An.readNullTerminatedString(e.subarray(l),h.encoding);if(l+=g.len,p){const y=Q.get(e,l);l+=Q.len,m.syncText.push({text:g.text,timestamp:y})}else m.descriptor=g.text,p=!0}c=m;break}case"ULT":case"USLT":case"COM":case"COMM":{const h=Gy.get(e,l);l+=Gy.len;const m=An.readNullTerminatedString(e.subarray(l),h.encoding);l+=m.len;const p=An.readNullTerminatedString(e.subarray(l),h.encoding);c={language:h.language,descriptor:m.text,text:p.text};break}case"UFID":{const h=An.readIdentifierAndData(e,l,a,vr);c={owner_identifier:h.id,identifier:h.data};break}case"PRIV":{const h=An.readIdentifierAndData(e,l,a,vr);c={owner_identifier:h.id,data:h.data};break}case"POPM":{d=Rn(e,l,a,vr);const h=xt(e.slice(l,d),vr);l=d+1;const m=a-l;c={email:h,rating:se.get(e,l),counter:m>=5?Q.get(e,l+1):void 0};break}case"GEOB":{d=Rn(e,l+1,a,s);const h=xt(e.slice(l+1,d),vr);l=d+1,d=Rn(e,l,a-l,s);const m=xt(e.slice(l,d),vr);l=d+1,d=Rn(e,l,a-l,s);const p=xt(e.slice(l,d),vr);c={type:h,filename:m,description:p,data:e.slice(l+1,a)};break}case"WCOM":case"WCOP":case"WOAF":case"WOAR":case"WOAS":case"WORS":case"WPAY":case"WPUB":d=Rn(e,l+1,a,s),c=xt(e.slice(l,d),vr);break;case"WXXX":{d=Rn(e,l+1,a,s);const h=xt(e.slice(l+1,d),s);l=d+(s==="utf-16le"?2:1),c={description:h,url:xt(e.slice(l,a),vr)};break}case"WFD":case"WFED":c=xt(e.slice(l+1,Rn(e,l+1,a,s)),s);break;case"MCDI":{c=e.slice(0,a);break}default:Nb(`Warning: unsupported id3v2-tag-type: ${n}`);break}return c}static readNullTerminatedString(e,n){let r=n.bom?2:0;const s=Rn(e,r,e.length,n.encoding),i=e.slice(r,s);return n.encoding==="utf-16le"?r=s+2:r=s+1,{text:xt(i,n.encoding),len:r}}static fixPictureMimeType(e){switch(e=e.toLocaleLowerCase(),e){case"jpg":return"image/jpeg";case"png":return"image/png"}return e}static functionList(e){const n={};for(let r=0;r+1<e.length;r+=2){const s=e[r+1].split(",");n[e[r]]=n[e[r]]?n[e[r]].concat(s):s}return n}splitValue(e,n){let r;return this.major<4?(r=n.split(/\x00/g),r.length>1?this.warningCollector.addWarning(`ID3v2.${this.major} ${e} uses non standard null-separator.`):r=n.split(/\//g)):r=n.split(/\x00/g),An.trimArray(r)}static trimArray(e){return e.map(n=>n.replace(/\x00+$/,"").trim())}static readIdentifierAndData(e,n,r,s){const i=Rn(e,n,r,s),a=xt(e.slice(n,i),s);return n=i+An.getNullTerminatorLength(s),{id:a,data:e.slice(n,r)}}static getNullTerminatorLength(e){return e==="utf-16le"?2:1}}const Fb=new TextDecoder("ascii");class br{constructor(){this.tokenizer=void 0,this.id3Header=void 0,this.metadata=void 0,this.headerType=void 0,this.options=void 0}static removeUnsyncBytes(e){let n=0,r=0;for(;n<e.length-1;)n!==r&&(e[r]=e[n]),n+=e[n]===255&&e[n+1]===0?2:1,r++;return n<e.length&&(e[r++]=e[n]),e.slice(0,r)}static getFrameHeaderLength(e){switch(e){case 2:return 6;case 3:case 4:return 10;default:throw new Error("header versionIndex is incorrect")}}static readFrameFlags(e){return{status:{tag_alter_preservation:tt(e,0,6),file_alter_preservation:tt(e,0,5),read_only:tt(e,0,4)},format:{grouping_identity:tt(e,1,7),compression:tt(e,1,3),encryption:tt(e,1,2),unsynchronisation:tt(e,1,1),data_length_indicator:tt(e,1,0)}}}static readFrameData(e,n,r,s,i){var l,c;const a=new An(r,i);switch(r){case 2:return a.readData(e,n.id,s);case 3:case 4:return(l=n.flags)!=null&&l.format.unsynchronisation&&(e=br.removeUnsyncBytes(e)),(c=n.flags)!=null&&c.format.data_length_indicator&&(e=e.slice(4,e.length)),a.readData(e,n.id,s);default:throw new Error(`Unexpected majorVer: ${r}`)}}static makeDescriptionTagName(e,n){return e+(n?`:${n}`:"")}async parse(e,n,r){this.tokenizer=n,this.metadata=e,this.options=r;const s=await this.tokenizer.readToken(qy);if(s.fileIdentifier!=="ID3")throw new Error("expected ID3-header file-identifier 'ID3' was not found");return this.id3Header=s,this.headerType=`ID3v2.${s.version.major}`,s.flags.isExtendedHeader?this.parseExtendedHeader():this.parseId3Data(s.size)}async parseExtendedHeader(){const e=await this.tokenizer.readToken(Tb),n=e.size-Tb.len;return n>0?this.parseExtendedHeaderData(n,e.size):this.parseId3Data(this.id3Header.size-e.size)}async parseExtendedHeaderData(e,n){return await this.tokenizer.ignore(e),this.parseId3Data(this.id3Header.size-n)}async parseId3Data(e){const n=await this.tokenizer.readToken(new gn(e));for(const r of this.parseMetadata(n))switch(r.id){case"TXXX":r.value&&await this.handleTag(r,r.value.text,()=>r.value.description);break;default:await(Array.isArray(r.value)?Promise.all(r.value.map(s=>this.addTag(r.id,s))):this.addTag(r.id,r.value))}}async handleTag(e,n,r,s=i=>i){await Promise.all(n.map(i=>this.addTag(br.makeDescriptionTagName(e.id,r(i)),s(i))))}async addTag(e,n){await this.metadata.addTag(this.headerType,e,n)}parseMetadata(e){let n=0;const r=[];for(;n!==e.length;){const s=br.getFrameHeaderLength(this.id3Header.version.major);if(n+s>e.length){this.metadata.addWarning("Illegal ID3v2 tag length");break}const i=e.slice(n,n+s);n+=s;const a=this.readFrameHeader(i,this.id3Header.version.major),l=e.slice(n,n+a.length);n+=a.length;const c=br.readFrameData(l,a,this.id3Header.version.major,!this.options.skipCovers,this.metadata);c&&r.push({id:a.id,value:c})}return r}readFrameHeader(e,n){let r;switch(n){case 2:r={id:Fb.decode(e.slice(0,3)),length:hn.get(e,3)},r.id.match(/[A-Z0-9]{3}/g)||this.metadata.addWarning(`Invalid ID3v2.${this.id3Header.version.major} frame-header-ID: ${r.id}`);break;case 3:case 4:r={id:Fb.decode(e.slice(0,4)),length:(n===4?MN:Q).get(e,4),flags:br.readFrameFlags(e.slice(8,10))},r.id.match(/[A-Z0-9]{4}/g)||this.metadata.addWarning(`Invalid ID3v2.${this.id3Header.version.major} frame-header-ID: ${r.id}`);break;default:throw new Error(`Unexpected majorVer: ${n}`)}return r}}const _K={NONE:"not compressed	PCM	Apple Computer",sowt:"PCM (byte swapped)",fl32:"32-bit floating point IEEE 32-bit float",fl64:"64-bit floating point IEEE 64-bit float	Apple Computer",alaw:"ALaw 2:1	8-bit ITU-T G.711 A-law",ulaw:"µLaw 2:1	8-bit ITU-T G.711 µ-law	Apple Computer",ULAW:"CCITT G.711 u-law 8-bit ITU-T G.711 µ-law",ALAW:"CCITT G.711 A-law 8-bit ITU-T G.711 A-law",FL32:"Float 32	IEEE 32-bit float "};class SK{constructor(e,n){this.isAifc=n;const r=n?22:18;if(e.chunkSize<r)throw new Error(`COMMON CHUNK size should always be at least ${r}`);this.len=e.chunkSize}get(e,n){const r=je.get(e,n+8)-16398,s=je.get(e,n+8+2),i={numChannels:je.get(e,n),numSampleFrames:Q.get(e,n+2),sampleSize:je.get(e,n+6),sampleRate:r<0?s>>Math.abs(r):s<<r};if(this.isAifc){if(i.compressionType=He.get(e,n+18),this.len>22){const a=se.get(e,n+22);if(a>0){const l=(a+1)%2;if(23+a+l===this.len)i.compressionName=new G(a,"latin1").get(e,n+23);else throw new Error("Illegal pstring length")}else i.compressionName=void 0}}else i.compressionName="PCM";return i}}const $g={len:8,get:(t,e)=>({chunkID:He.get(t,e),chunkSize:Number(BigInt(Q.get(t,e+4)))})},zg=De("music-metadata:parser:aiff");class EK extends Yn{constructor(){super(...arguments),this.isCompressed=null}async parse(){if((await this.tokenizer.readToken($g)).chunkID!=="FORM")throw new Error("Invalid Chunk-ID, expected 'FORM'");const n=await this.tokenizer.readToken(He);switch(n){case"AIFF":this.metadata.setFormat("container",n),this.isCompressed=!1;break;case"AIFC":this.metadata.setFormat("container","AIFF-C"),this.isCompressed=!0;break;default:throw new Error(`Unsupported AIFF type: ${n}`)}this.metadata.setFormat("lossless",!this.isCompressed);try{for(;!this.tokenizer.fileInfo.size||this.tokenizer.fileInfo.size-this.tokenizer.position>=$g.len;){zg(`Reading AIFF chunk at offset=${this.tokenizer.position}`);const r=await this.tokenizer.readToken($g),s=2*Math.round(r.chunkSize/2),i=await this.readData(r);await this.tokenizer.ignore(s-i)}}catch(r){if(r instanceof ct)zg("End-of-stream");else throw r}}async readData(e){switch(e.chunkID){case"COMM":{if(this.isCompressed===null)throw new Error("Failed to parse AIFF.COMM chunk when compression type is unknown");const n=await this.tokenizer.readToken(new SK(e,this.isCompressed));return this.metadata.setFormat("bitsPerSample",n.sampleSize),this.metadata.setFormat("sampleRate",n.sampleRate),this.metadata.setFormat("numberOfChannels",n.numChannels),this.metadata.setFormat("numberOfSamples",n.numSampleFrames),this.metadata.setFormat("duration",n.numSampleFrames/n.sampleRate),(n.compressionName||n.compressionType)&&this.metadata.setFormat("codec",n.compressionName??_K[n.compressionType]),e.chunkSize}case"ID3 ":{const n=await this.tokenizer.readToken(new gn(e.chunkSize)),r=Xo(n);return await new br().parse(this.metadata,r,this.options),e.chunkSize}case"SSND":return this.metadata.format.duration&&this.metadata.setFormat("bitrate",8*e.chunkSize/this.metadata.format.duration),0;case"NAME":case"AUTH":case"(c) ":case"ANNO":return this.readTextChunk(e);default:return zg(`Ignore chunk id=${e.chunkID}, size=${e.chunkSize}`),0}}async readTextChunk(e){const r=(await this.tokenizer.readToken(new G(e.chunkSize,"ascii"))).split("\0").map(s=>s.trim()).filter(s=>s==null?void 0:s.length);return await Promise.all(r.map(s=>this.metadata.addTag("AIFF",e.chunkID,s))),e.chunkSize}}class k{static fromBin(e,n=0){return new k(k.decode(e,n))}static decode(e,n=0){const r=new DataView(e.buffer,n);return`${r.getUint32(0,!0).toString(16)}-${r.getUint16(4,!0).toString(16)}-${r.getUint16(6,!0).toString(16)}-${r.getUint16(8).toString(16)}-${k1(e.slice(n+10,n+16))}`.toUpperCase()}static decodeMediaType(e){switch(e.str){case k.AudioMedia.str:return"audio";case k.VideoMedia.str:return"video";case k.CommandMedia.str:return"command";case k.Degradable_JPEG_Media.str:return"degradable-jpeg";case k.FileTransferMedia.str:return"file-transfer";case k.BinaryMedia.str:return"binary"}}static encode(e){const n=new Uint8Array(16),r=new DataView(n.buffer);return r.setUint32(0,Number.parseInt(e.slice(0,8),16),!0),r.setUint16(4,Number.parseInt(e.slice(9,13),16),!0),r.setUint16(6,Number.parseInt(e.slice(14,18),16),!0),n.set(vb(e.slice(19,23)),8),n.set(vb(e.slice(24)),10),n}constructor(e){this.str=e}equals(e){return this.str===e.str}toBin(){return k.encode(this.str)}}k.HeaderObject=new k("75B22630-668E-11CF-A6D9-00AA0062CE6C");k.DataObject=new k("75B22636-668E-11CF-A6D9-00AA0062CE6C");k.SimpleIndexObject=new k("33000890-E5B1-11CF-89F4-00A0C90349CB");k.IndexObject=new k("D6E229D3-35DA-11D1-9034-00A0C90349BE");k.MediaObjectIndexObject=new k("FEB103F8-12AD-4C64-840F-2A1D2F7AD48C");k.TimecodeIndexObject=new k("3CB73FD0-0C4A-4803-953D-EDF7B6228F0C");k.FilePropertiesObject=new k("8CABDCA1-A947-11CF-8EE4-00C00C205365");k.StreamPropertiesObject=new k("B7DC0791-A9B7-11CF-8EE6-00C00C205365");k.HeaderExtensionObject=new k("5FBF03B5-A92E-11CF-8EE3-00C00C205365");k.CodecListObject=new k("86D15240-311D-11D0-A3A4-00A0C90348F6");k.ScriptCommandObject=new k("1EFB1A30-0B62-11D0-A39B-00A0C90348F6");k.MarkerObject=new k("F487CD01-A951-11CF-8EE6-00C00C205365");k.BitrateMutualExclusionObject=new k("D6E229DC-35DA-11D1-9034-00A0C90349BE");k.ErrorCorrectionObject=new k("75B22635-668E-11CF-A6D9-00AA0062CE6C");k.ContentDescriptionObject=new k("75B22633-668E-11CF-A6D9-00AA0062CE6C");k.ExtendedContentDescriptionObject=new k("D2D0A440-E307-11D2-97F0-00A0C95EA850");k.ContentBrandingObject=new k("2211B3FA-BD23-11D2-B4B7-00A0C955FC6E");k.StreamBitratePropertiesObject=new k("7BF875CE-468D-11D1-8D82-006097C9A2B2");k.ContentEncryptionObject=new k("2211B3FB-BD23-11D2-B4B7-00A0C955FC6E");k.ExtendedContentEncryptionObject=new k("298AE614-2622-4C17-B935-DAE07EE9289C");k.DigitalSignatureObject=new k("2211B3FC-BD23-11D2-B4B7-00A0C955FC6E");k.PaddingObject=new k("1806D474-CADF-4509-A4BA-9AABCB96AAE8");k.ExtendedStreamPropertiesObject=new k("14E6A5CB-C672-4332-8399-A96952065B5A");k.AdvancedMutualExclusionObject=new k("A08649CF-4775-4670-8A16-6E35357566CD");k.GroupMutualExclusionObject=new k("D1465A40-5A79-4338-B71B-E36B8FD6C249");k.StreamPrioritizationObject=new k("D4FED15B-88D3-454F-81F0-ED5C45999E24");k.BandwidthSharingObject=new k("A69609E6-517B-11D2-B6AF-00C04FD908E9");k.LanguageListObject=new k("7C4346A9-EFE0-4BFC-B229-393EDE415C85");k.MetadataObject=new k("C5F8CBEA-5BAF-4877-8467-AA8C44FA4CCA");k.MetadataLibraryObject=new k("44231C94-9498-49D1-A141-1D134E457054");k.IndexParametersObject=new k("D6E229DF-35DA-11D1-9034-00A0C90349BE");k.MediaObjectIndexParametersObject=new k("6B203BAD-3F11-48E4-ACA8-D7613DE2CFA7");k.TimecodeIndexParametersObject=new k("F55E496D-9797-4B5D-8C8B-604DFE9BFB24");k.CompatibilityObject=new k("26F18B5D-4584-47EC-9F5F-0E651F0452C9");k.AdvancedContentEncryptionObject=new k("43058533-6981-49E6-9B74-AD12CB86D58C");k.AudioMedia=new k("F8699E40-5B4D-11CF-A8FD-00805F5C442B");k.VideoMedia=new k("BC19EFC0-5B4D-11CF-A8FD-00805F5C442B");k.CommandMedia=new k("59DACFC0-59E6-11D0-A3AC-00A0C90348F6");k.JFIF_Media=new k("B61BE100-5B4E-11CF-A8FD-00805F5C442B");k.Degradable_JPEG_Media=new k("35907DE0-E415-11CF-A917-00805F5C442B");k.FileTransferMedia=new k("91BD222C-F21C-497A-8B6D-5AA86BFC0185");k.BinaryMedia=new k("3AFB65E2-47EF-40F2-AC2C-70A90D71D343");k.ASF_Index_Placeholder_Object=new k("D9AADE20-7C17-4F9C-BC28-8555DD98E2A2");function bK(t){return kK[t]}function gp(t){return si(xt(t,"utf-16le"))}const kK=[gp,Db,TK,IK,CK,zN,Db];function Db(t){return new Uint8Array(t)}function TK(t,e=0){return zN(t,e)===1}function IK(t,e=0){return U.get(t,e)}function CK(t,e=0){return ln.get(t,e)}function zN(t,e=0){return Te.get(t,e)}var Ob;(function(t){t[t.UnicodeString=0]="UnicodeString",t[t.ByteArray=1]="ByteArray",t[t.Bool=2]="Bool",t[t.DWord=3]="DWord",t[t.QWord=4]="QWord",t[t.Word=5]="Word"})(Ob||(Ob={}));const RK={len:30,get:(t,e)=>({objectId:k.fromBin(t,e),objectSize:Number(ln.get(t,e+16)),numberOfHeaderObjects:U.get(t,e+24)})},ea={len:24,get:(t,e)=>({objectId:k.fromBin(t,e),objectSize:Number(ln.get(t,e+16))})};class Va{constructor(e){this.len=Number(e.objectSize)-ea.len}postProcessTag(e,n,r,s){if(n==="WM/Picture")e.push({id:n,value:A1.fromBuffer(s)});else{const i=bK(r);if(!i)throw new Error(`unexpected value headerType: ${r}`);e.push({id:n,value:i(s)})}}}class Mb extends Va{get(e,n){return null}}class Qy extends Va{get(e,n){return{fileId:k.fromBin(e,n),fileSize:ln.get(e,n+16),creationDate:ln.get(e,n+24),dataPacketsCount:ln.get(e,n+32),playDuration:ln.get(e,n+40),sendDuration:ln.get(e,n+48),preroll:ln.get(e,n+56),flags:{broadcast:tt(e,n+64,24),seekable:tt(e,n+64,25)},minimumDataPacketSize:U.get(e,n+68),maximumDataPacketSize:U.get(e,n+72),maximumBitrate:U.get(e,n+76)}}}Qy.guid=k.FilePropertiesObject;class Ky extends Va{get(e,n){return{streamType:k.decodeMediaType(k.fromBin(e,n)),errorCorrectionType:k.fromBin(e,n+8)}}}Ky.guid=k.StreamPropertiesObject;class Xy{constructor(){this.len=22}get(e,n){const r=new DataView(e.buffer,n);return{reserved1:k.fromBin(e,n),reserved2:r.getUint16(16,!0),extensionDataSize:r.getUint16(18,!0)}}}Xy.guid=k.HeaderExtensionObject;const AK={len:20,get:(t,e)=>({entryCount:new DataView(t.buffer,e).getUint16(16,!0)})};async function Lb(t){const e=await t.readNumber(Te);return(await t.readToken(new G(e*2,"utf-16le"))).replace("\0","")}async function jK(t){const e=await t.readToken(AK),n=[];for(let r=0;r<e.entryCount;++r)n.push(await PK(t));return n}async function NK(t){const e=await t.readNumber(Te),n=new Uint8Array(e);return await t.readBuffer(n),n}async function PK(t){const e=await t.readNumber(Te);return{type:{videoCodec:(e&1)===1,audioCodec:(e&2)===2},codecName:await Lb(t),description:await Lb(t),information:await NK(t)}}class Ra extends Va{get(e,n){const r=[],s=new DataView(e.buffer,n);let i=10;for(let a=0;a<Ra.contentDescTags.length;++a){const l=s.getUint16(a*2,!0);if(l>0){const c=Ra.contentDescTags[a],u=i+l;r.push({id:c,value:gp(e.slice(n+i,n+u))}),i=u}}return r}}Ra.guid=k.ContentDescriptionObject;Ra.contentDescTags=["Title","Author","Copyright","Description","Rating"];class Yy extends Va{get(e,n){const r=[],s=new DataView(e.buffer,n),i=s.getUint16(0,!0);let a=2;for(let l=0;l<i;l+=1){const c=s.getUint16(a,!0);a+=2;const u=gp(e.slice(n+a,n+a+c));a+=c;const d=s.getUint16(a,!0);a+=2;const h=s.getUint16(a,!0);a+=2;const m=e.slice(n+a,n+a+h);a+=h,this.postProcessTag(r,u,d,m)}return r}}Yy.guid=k.ExtendedContentDescriptionObject;class Jy extends Va{get(e,n){const r=new DataView(e.buffer,n);return{startTime:ln.get(e,n),endTime:ln.get(e,n+8),dataBitrate:r.getInt32(12,!0),bufferSize:r.getInt32(16,!0),initialBufferFullness:r.getInt32(20,!0),alternateDataBitrate:r.getInt32(24,!0),alternateBufferSize:r.getInt32(28,!0),alternateInitialBufferFullness:r.getInt32(32,!0),maximumObjectSize:r.getInt32(36,!0),flags:{reliableFlag:tt(e,n+40,0),seekableFlag:tt(e,n+40,1),resendLiveCleanpointsFlag:tt(e,n+40,2)},streamNumber:r.getInt16(42,!0),streamLanguageId:r.getInt16(44,!0),averageTimePerFrame:r.getInt32(52,!0),streamNameCount:r.getInt32(54,!0),payloadExtensionSystems:r.getInt32(56,!0),streamNames:[],streamPropertiesObject:null}}}Jy.guid=k.ExtendedStreamPropertiesObject;class pf extends Va{get(e,n){const r=[],s=new DataView(e.buffer,n),i=s.getUint16(0,!0);let a=2;for(let l=0;l<i;l+=1){a+=4;const c=s.getUint16(a,!0);a+=2;const u=s.getUint16(a,!0);a+=2;const d=s.getUint32(a,!0);a+=4;const h=gp(e.slice(n+a,n+a+c));a+=c;const m=e.slice(n+a,n+a+d);a+=d,this.postProcessTag(r,h,u,m)}return r}}pf.guid=k.MetadataObject;class Zy extends pf{}Zy.guid=k.MetadataLibraryObject;class A1{static fromBuffer(e){return new A1(e.length).get(e,0)}constructor(e){this.len=e}get(e,n){const r=new DataView(e.buffer,n),s=r.getUint8(0),i=r.getInt32(1,!0);let a=5;for(;r.getUint16(a)!==0;)a+=2;const l=new G(a-5,"utf-16le").get(e,5);for(;r.getUint16(a)!==0;)a+=2;const c=new G(a-5,"utf-16le").get(e,5);return{type:su[s],format:l,description:c,size:i,data:e.slice(a+4)}}}const Id=De("music-metadata:parser:ASF"),FK="asf";class DK extends Yn{async parse(){const e=await this.tokenizer.readToken(RK);if(!e.objectId.equals(k.HeaderObject))throw new Error(`expected asf header; but was not found; got: ${e.objectId.str}`);try{await this.parseObjectHeader(e.numberOfHeaderObjects)}catch(n){Id("Error while parsing ASF: %s",n)}}async parseObjectHeader(e){let n;do{const r=await this.tokenizer.readToken(ea);switch(Id("header GUID=%s",r.objectId.str),r.objectId.str){case Qy.guid.str:{const s=await this.tokenizer.readToken(new Qy(r));this.metadata.setFormat("duration",Number(s.playDuration/BigInt(1e3))/1e4-Number(s.preroll)/1e3),this.metadata.setFormat("bitrate",s.maximumBitrate);break}case Ky.guid.str:{const s=await this.tokenizer.readToken(new Ky(r));this.metadata.setFormat("container",`ASF/${s.streamType}`);break}case Xy.guid.str:{const s=await this.tokenizer.readToken(new Xy);await this.parseExtensionObject(s.extensionDataSize);break}case Ra.guid.str:n=await this.tokenizer.readToken(new Ra(r)),await this.addTags(n);break;case Yy.guid.str:n=await this.tokenizer.readToken(new Yy(r)),await this.addTags(n);break;case k.CodecListObject.str:{const s=await jK(this.tokenizer);s.forEach(a=>{this.metadata.addStreamInfo({type:a.type.videoCodec?Ca.video:Ca.audio,codecName:a.codecName})});const i=s.filter(a=>a.type.audioCodec).map(a=>a.codecName).join("/");this.metadata.setFormat("codec",i);break}case k.StreamBitratePropertiesObject.str:await this.tokenizer.ignore(r.objectSize-ea.len);break;case k.PaddingObject.str:Id("Padding: %s bytes",r.objectSize-ea.len),await this.tokenizer.ignore(r.objectSize-ea.len);break;default:this.metadata.addWarning(`Ignore ASF-Object-GUID: ${r.objectId.str}`),Id("Ignore ASF-Object-GUID: %s",r.objectId.str),await this.tokenizer.readToken(new Mb(r))}}while(--e)}async addTags(e){await Promise.all(e.map(({id:n,value:r})=>this.metadata.addTag(FK,n,r)))}async parseExtensionObject(e){do{const n=await this.tokenizer.readToken(ea),r=n.objectSize-ea.len;switch(n.objectId.str){case Jy.guid.str:await this.tokenizer.readToken(new Jy(n));break;case pf.guid.str:{const s=await this.tokenizer.readToken(new pf(n));await this.addTags(s);break}case Zy.guid.str:{const s=await this.tokenizer.readToken(new Zy(n));await this.addTags(s);break}case k.PaddingObject.str:await this.tokenizer.ignore(r);break;case k.CompatibilityObject.str:this.tokenizer.ignore(r);break;case k.ASF_Index_Placeholder_Object.str:await this.tokenizer.ignore(r);break;default:this.metadata.addWarning(`Ignore ASF-Object-GUID: ${n.objectId.str}`),await this.tokenizer.readToken(new Mb(n));break}e-=n.objectSize}while(e>0)}}class iu{static fromBase64(e){return iu.fromBuffer(Uint8Array.from(atob(e),n=>n.charCodeAt(0)))}static fromBuffer(e){return new iu(e.length).get(e,0)}constructor(e){this.len=e}get(e,n){const r=su[Q.get(e,n)];n+=4;const s=Q.get(e,n);n+=4;const i=new G(s,"utf-8").get(e,n);n+=s;const a=Q.get(e,n);n+=4;const l=new G(a,"utf-8").get(e,n);n+=a;const c=Q.get(e,n);n+=4;const u=Q.get(e,n);n+=4;const d=Q.get(e,n);n+=4;const h=Q.get(e,n);n+=4;const m=Q.get(e,n);n+=4;const p=Uint8Array.from(e.slice(n,n+m));return{type:r,format:i,description:l,width:c,height:u,colour_depth:d,indexed_color:h,data:p}}}const Cd={len:7,get:(t,e)=>({packetType:se.get(t,e),vorbis:new G(6,"ascii").get(t,e+1)})},OK={len:23,get:(t,e)=>({version:U.get(t,e+0),channelMode:se.get(t,e+4),sampleRate:U.get(t,e+5),bitrateMax:U.get(t,e+9),bitrateNominal:U.get(t,e+13),bitrateMin:U.get(t,e+17)})},Bg=De("music-metadata:parser:ID3");class yp extends Yn{constructor(){super(...arguments),this.id3parser=new br}static async startsWithID3v2Header(e){return(await e.peekToken(qy)).fileIdentifier==="ID3"}async parse(){try{await this.parseID3v2()}catch(e){if(e instanceof ct)Bg("End-of-stream");else throw e}}finalize(){}async parseID3v2(){await this.tryReadId3v2Headers(),Bg("End of ID3v2 header, go to MPEG-parser: pos=%s",this.tokenizer.position),await this.postId3v2Parse(),this.options.skipPostHeaders&&this.metadata.hasAny()?this.finalize():(await new R1().init(this.metadata,this.tokenizer,this.options).parse(),this.finalize())}async tryReadId3v2Headers(){if((await this.tokenizer.peekToken(qy)).fileIdentifier==="ID3")return Bg("Found ID3v2 header, pos=%s",this.tokenizer.position),await this.id3parser.parse(this.metadata,this.tokenizer,this.options),this.tryReadId3v2Headers()}}class BN{constructor(e,n){this.data=e,this.offset=n}readInt32(){const e=U.get(this.data,this.offset);return this.offset+=4,e}readStringUtf8(){const e=this.readInt32(),n=new TextDecoder("utf-8").decode(this.data.subarray(this.offset,this.offset+e));return this.offset+=e,n}parseUserComment(){const e=this.offset,n=this.readStringUtf8(),r=n.indexOf("=");return{key:n.slice(0,r).toUpperCase(),value:n.slice(r+1),len:this.offset-e}}}const Ka=De("music-metadata:parser:ogg:vorbis1");class Aa{constructor(e,n){this.metadata=e,this.options=n,this.pageSegments=[]}async parsePage(e,n){if(e.headerType.firstPage)this.parseFirstPage(e,n);else{if(e.headerType.continued){if(this.pageSegments.length===0)throw new Error("Cannot continue on previous page");this.pageSegments.push(n)}if(e.headerType.lastPage||!e.headerType.continued){if(this.pageSegments.length>0){const r=Aa.mergeUint8Arrays(this.pageSegments);await this.parseFullPage(r)}this.pageSegments=e.headerType.lastPage?[]:[n]}}e.headerType.lastPage&&this.calculateDuration(e)}static mergeUint8Arrays(e){const n=e.reduce((s,i)=>s+i.length,0),r=new Uint8Array(n);return e.forEach((s,i,a)=>{const l=a.slice(0,i).reduce((c,u)=>c+u.length,0);r.set(s,l)}),r}async flush(){await this.parseFullPage(Aa.mergeUint8Arrays(this.pageSegments))}async parseUserComment(e,n){const s=new BN(e,n).parseUserComment();return await this.addTag(s.key,s.value),s.len}async addTag(e,n){if(e==="METADATA_BLOCK_PICTURE"&&typeof n=="string"){if(this.options.skipCovers){Ka("Ignore picture");return}n=iu.fromBase64(n),Ka(`Push picture: id=${e}, format=${n.format}`)}else Ka(`Push tag: id=${e}, value=${n}`);await this.metadata.addTag("vorbis",e,n)}calculateDuration(e){this.metadata.format.sampleRate&&e.absoluteGranulePosition>=0&&(this.metadata.setFormat("numberOfSamples",e.absoluteGranulePosition),this.metadata.setFormat("duration",e.absoluteGranulePosition/this.metadata.format.sampleRate))}parseFirstPage(e,n){this.metadata.setFormat("codec","Vorbis I"),Ka("Parse first page");const r=Cd.get(n,0);if(r.vorbis!=="vorbis")throw new Error("Metadata does not look like Vorbis");if(r.packetType===1){const s=OK.get(n,Cd.len);this.metadata.setFormat("sampleRate",s.sampleRate),this.metadata.setFormat("bitrate",s.bitrateNominal),this.metadata.setFormat("numberOfChannels",s.channelMode),Ka("sample-rate=%s[hz], bitrate=%s[b/s], channel-mode=%s",s.sampleRate,s.bitrateNominal,s.channelMode)}else throw new Error("First Ogg page should be type 1: the identification header")}async parseFullPage(e){const n=Cd.get(e,0);switch(Ka("Parse full page: type=%s, byteLength=%s",n.packetType,e.byteLength),n.packetType){case 3:return this.parseUserCommentList(e,Cd.len)}}async parseUserCommentList(e,n){const r=U.get(e,n);n+=4,n+=r;let s=U.get(e,n);for(n+=4;s-- >0;)n+=await this.parseUserComment(e,n)}}const MK=De("music-metadata:parser:FLAC");var ps;(function(t){t[t.STREAMINFO=0]="STREAMINFO",t[t.PADDING=1]="PADDING",t[t.APPLICATION=2]="APPLICATION",t[t.SEEKTABLE=3]="SEEKTABLE",t[t.VORBIS_COMMENT=4]="VORBIS_COMMENT",t[t.CUESHEET=5]="CUESHEET",t[t.PICTURE=6]="PICTURE"})(ps||(ps={}));class LK extends yp{constructor(){super(...arguments),this.padding=0}init(e,n,r){return super.init(e,n,r),this.vorbisParser=new Aa(e,r),this}async postId3v2Parse(){if((await this.tokenizer.readToken(He)).toString()!=="fLaC")throw new Error("Invalid FLAC preamble");let n;do n=await this.tokenizer.readToken($K),await this.parseDataBlock(n);while(!n.lastBlock);if(this.tokenizer.fileInfo.size&&this.metadata.format.duration){const r=this.tokenizer.fileInfo.size-this.tokenizer.position;this.metadata.setFormat("bitrate",8*r/this.metadata.format.duration)}}async parseDataBlock(e){switch(MK(`blockHeader type=${e.type}, length=${e.length}`),e.type){case ps.STREAMINFO:return this.parseBlockStreamInfo(e.length);case ps.PADDING:this.padding+=e.length;break;case ps.APPLICATION:break;case ps.SEEKTABLE:break;case ps.VORBIS_COMMENT:return this.parseComment(e.length);case ps.CUESHEET:break;case ps.PICTURE:await this.parsePicture(e.length);return;default:this.metadata.addWarning(`Unknown block type: ${e.type}`)}return this.tokenizer.ignore(e.length).then()}async parseBlockStreamInfo(e){if(e!==$b.len)throw new Error("Unexpected block-stream-info length");const n=await this.tokenizer.readToken($b);this.metadata.setFormat("container","FLAC"),this.metadata.setFormat("codec","FLAC"),this.metadata.setFormat("lossless",!0),this.metadata.setFormat("numberOfChannels",n.channels),this.metadata.setFormat("bitsPerSample",n.bitsPerSample),this.metadata.setFormat("sampleRate",n.sampleRate),n.totalSamples>0&&this.metadata.setFormat("duration",n.totalSamples/n.sampleRate)}async parseComment(e){const n=await this.tokenizer.readToken(new gn(e)),r=new BN(n,0);r.readStringUtf8();const s=r.readInt32(),i=new Array(s);for(let a=0;a<s;a++)i[a]=r.parseUserComment();await Promise.all(i.map(a=>this.vorbisParser.addTag(a.key,a.value)))}async parsePicture(e){if(this.options.skipCovers)return this.tokenizer.ignore(e);const n=await this.tokenizer.readToken(new iu(e));this.vorbisParser.addTag("METADATA_BLOCK_PICTURE",n)}}const $K={len:4,get:(t,e)=>({lastBlock:tt(t,e,7),type:pe(t,e,1,7),length:hn.get(t,e+1)})},$b={len:34,get:(t,e)=>({minimumBlockSize:je.get(t,e),maximumBlockSize:je.get(t,e+2)/1e3,minimumFrameSize:hn.get(t,e+4),maximumFrameSize:hn.get(t,e+7),sampleRate:hn.get(t,e+10)>>4,channels:pe(t,e+12,4,3)+1,bitsPerSample:pe(t,e+12,7,5)+1,totalSamples:pe(t,e+13,4,36),fileMD5:new gn(16).get(t,e+18)})},UN=De("music-metadata:parser:MP4:atom"),gf={len:8,get:(t,e)=>{const n=Q.get(t,e);if(n<0)throw new Error("Invalid atom header length");return{length:BigInt(n),name:new G(4,"latin1").get(t,e+4)}},put:(t,e,n)=>(Q.put(t,e,Number(n.length)),He.put(t,e+4,n.name))},zK=E1,zb={len:4,get:(t,e)=>({type:new G(4,"ascii").get(t,e)})};class VN{constructor(e,n,r){if(this.len=e,e<n)throw new Error(`Atom ${r} expected to be ${n}, but specifies ${e} bytes long.`);e>n&&UN(`Warning: atom ${r} expected to be ${n}, but was actually ${e} bytes long.`)}}const Yo={len:4,get:(t,e)=>{const n=Q.get(t,e)-2082844800;return new Date(n*1e3)}};class BK extends VN{constructor(e){super(e,24,"mdhd"),this.len=e}get(e,n){return{version:se.get(e,n+0),flags:hn.get(e,n+1),creationTime:Yo.get(e,n+4),modificationTime:Yo.get(e,n+8),timeScale:Q.get(e,n+12),duration:Q.get(e,n+16),language:je.get(e,n+20),quality:je.get(e,n+22)}}}class UK extends VN{constructor(e){super(e,100,"mvhd"),this.len=e}get(e,n){return{version:se.get(e,n),flags:hn.get(e,n+1),creationTime:Yo.get(e,n+4),modificationTime:Yo.get(e,n+8),timeScale:Q.get(e,n+12),duration:Q.get(e,n+16),preferredRate:Q.get(e,n+20),preferredVolume:je.get(e,n+24),previewTime:Q.get(e,n+72),previewDuration:Q.get(e,n+76),posterTime:Q.get(e,n+80),selectionTime:Q.get(e,n+84),selectionDuration:Q.get(e,n+88),currentTime:Q.get(e,n+92),nextTrackID:Q.get(e,n+96)}}}class VK{constructor(e){this.len=e}get(e,n){return{type:{set:se.get(e,n+0),type:hn.get(e,n+1)},locale:hn.get(e,n+4),value:new gn(this.len-8).get(e,n+8)}}}class HK{constructor(e){this.len=e}get(e,n){return{version:se.get(e,n),flags:hn.get(e,n+1),name:new G(this.len-4,"utf-8").get(e,n+4)}}}class WK{constructor(e){this.len=e}get(e,n){return{version:se.get(e,n),flags:hn.get(e,n+1),creationTime:Yo.get(e,n+4),modificationTime:Yo.get(e,n+8),trackId:Q.get(e,n+12),duration:Q.get(e,n+20),layer:je.get(e,n+24),alternateGroup:je.get(e,n+26),volume:je.get(e,n+28)}}}const Bb={len:8,get:(t,e)=>({version:se.get(t,e),flags:hn.get(t,e+1),numberOfEntries:Q.get(t,e+4)})};class qK{constructor(e){this.len=e}get(e,n){return{dataFormat:He.get(e,n),dataReferenceIndex:je.get(e,n+10),description:new gn(this.len-12).get(e,n+12)}}}class GK{constructor(e){this.len=e}get(e,n){const r=Bb.get(e,n);n+=Bb.len;const s=[];for(let i=0;i<r.numberOfEntries;++i){const a=Q.get(e,n);n+=Q.len,s.push(new qK(a).get(e,n)),n+=a}return{header:r,table:s}}}const Ub={len:8,get(t,e){return{version:Es.get(t,e),revision:Es.get(t,e+2),vendor:zn.get(t,e+4)}}},QK={len:12,get(t,e){return{numAudioChannels:Es.get(t,e+0),sampleSize:Es.get(t,e+2),compressionId:Es.get(t,e+4),packetSize:Es.get(t,e+6),sampleRate:je.get(t,e+8)+je.get(t,e+10)/1e4}}};class j1{constructor(e,n){this.len=e,this.token=n}get(e,n){const r=zn.get(e,n+4);return{version:ru.get(e,n+0),flags:S1.get(e,n+1),numberOfEntries:r,entries:HN(e,this.token,n+8,this.len-8,r)}}}const KK={len:8,get(t,e){return{count:zn.get(t,e+0),duration:zn.get(t,e+4)}}};class XK extends j1{constructor(e){super(e,KK),this.len=e}}const YK={len:12,get(t,e){return{firstChunk:zn.get(t,e),samplesPerChunk:zn.get(t,e+4),sampleDescriptionId:zn.get(t,e+8)}}};class JK extends j1{constructor(e){super(e,YK),this.len=e}}class ZK{constructor(e){this.len=e}get(e,n){const r=zn.get(e,n+8);return{version:ru.get(e,n),flags:S1.get(e,n+1),sampleSize:zn.get(e,n+4),numberOfEntries:r,entries:HN(e,zn,n+12,this.len-12,r)}}}class eX extends j1{constructor(e){super(e,zn),this.len=e}}class tX{constructor(e){this.len=e}get(e,n){const r=Es.get(e,n+0);return new G(r,"utf-8").get(e,n+2)}}function HN(t,e,n,r,s){if(UN(`remainingLen=${r}, numberOfEntries=${s} * token-len=${e.len}`),r===0)return[];if(r!==s*e.len)throw new Error("mismatch number-of-entries with remaining atom-length");const i=[];for(let a=0;a<s;++a)i.push(e.get(t,n)),n+=e.len;return i}const nX=De("music-metadata:parser:MP4:Atom");class yf{static async readAtom(e,n,r,s){const i=e.position,a=await e.readToken(gf);a.length===BigInt(1)&&(a.length=await e.readToken(zK));const c=new yf(a,a.length===BigInt(1),r),u=c.getPayloadLength(s);return nX(`parse atom name=${c.atomPath}, extended=${c.extended}, offset=${i}, len=${c.header.length}`),await c.readData(e,n,u),c}constructor(e,n,r){this.header=e,this.extended=n,this.parent=r,this.children=[],this.atomPath=(this.parent?`${this.parent.atomPath}.`:"")+this.header.name}getHeaderLength(){return this.extended?16:8}getPayloadLength(e){return(this.header.length===BigInt(0)?e:Number(this.header.length))-this.getHeaderLength()}async readAtoms(e,n,r){for(;r>0;){const s=await yf.readAtom(e,n,this,r);this.children.push(s),r-=s.header.length===BigInt(0)?r:Number(s.header.length)}}async readData(e,n,r){switch(this.header.name){case"moov":case"udta":case"trak":case"mdia":case"minf":case"stbl":case"<id>":case"ilst":case"tref":return this.readAtoms(e,n,this.getPayloadLength(r));case"meta":{const i=(await e.peekToken(gf)).name==="hdlr"?0:4;return await e.ignore(i),this.readAtoms(e,n,this.getPayloadLength(r)-i)}default:return n(this,r)}}}const Dr=De("music-metadata:parser:MP4"),rX="iTunes",Vb={raw:{lossy:!1,format:"raw"},MAC3:{lossy:!0,format:"MACE 3:1"},MAC6:{lossy:!0,format:"MACE 6:1"},ima4:{lossy:!0,format:"IMA 4:1"},ulaw:{lossy:!0,format:"uLaw 2:1"},alaw:{lossy:!0,format:"uLaw 2:1"},Qclp:{lossy:!0,format:"QUALCOMM PureVoice"},".mp3":{lossy:!0,format:"MPEG-1 layer 3"},alac:{lossy:!1,format:"ALAC"},"ac-3":{lossy:!0,format:"AC-3"},mp4a:{lossy:!0,format:"MPEG-4/AAC"},mp4s:{lossy:!0,format:"MP4S"},c608:{lossy:!0,format:"CEA-608"},c708:{lossy:!0,format:"CEA-708"}};function Hb(t,e,n){return n.indexOf(t)===e}class xf extends Yn{constructor(){super(...arguments),this.tracks=[],this.atomParsers={mvhd:async e=>{const n=await this.tokenizer.readToken(new UK(e));this.metadata.setFormat("creationTime",n.creationTime),this.metadata.setFormat("modificationTime",n.modificationTime)},mdhd:async e=>{const n=await this.tokenizer.readToken(new BK(e)),r=this.getTrackDescription();r.creationTime=n.creationTime,r.modificationTime=n.modificationTime,r.timeScale=n.timeScale,r.duration=n.duration},chap:async e=>{const n=this.getTrackDescription(),r=[];for(;e>=Q.len;)r.push(await this.tokenizer.readNumber(Q)),e-=Q.len;n.chapterList=r},tkhd:async e=>{const n=await this.tokenizer.readToken(new WK(e));this.tracks.push(n)},mdat:async e=>{if(this.audioLengthInBytes=e,this.calculateBitRate(),this.options.includeChapters){const n=this.tracks.filter(r=>r.chapterList);if(n.length===1){const r=n[0].chapterList,s=this.tracks.filter(i=>r.indexOf(i.trackId)!==-1);if(s.length===1)return this.parseChapterTrack(s[0],n[0],e)}}await this.tokenizer.ignore(e)},ftyp:async e=>{const n=[];for(;e>0;){const s=await this.tokenizer.readToken(zb);e-=zb.len;const i=s.type.replace(/\W/g,"");i.length>0&&n.push(i)}Dr(`ftyp: ${n.join("/")}`);const r=n.filter(Hb).join("/");this.metadata.setFormat("container",r)},stsd:async e=>{const n=await this.tokenizer.readToken(new GK(e)),r=this.getTrackDescription();r.soundSampleDescription=n.table.map(s=>this.parseSoundSampleDescription(s))},stsc:async e=>{const n=await this.tokenizer.readToken(new JK(e));this.getTrackDescription().sampleToChunkTable=n.entries},stts:async e=>{const n=await this.tokenizer.readToken(new XK(e));this.getTrackDescription().timeToSampleTable=n.entries},stsz:async e=>{const n=await this.tokenizer.readToken(new ZK(e)),r=this.getTrackDescription();r.sampleSize=n.sampleSize,r.sampleSizeTable=n.entries},stco:async e=>{const n=await this.tokenizer.readToken(new eX(e));this.getTrackDescription().chunkOffsetTable=n.entries},date:async e=>{const n=await this.tokenizer.readToken(new G(e,"utf-8"));await this.addTag("date",n)}}}static read_BE_Integer(e,n){const r=(n?"INT":"UINT")+e.length*8+(e.length>1?"_BE":""),s=uQ[r];if(!s)throw new Error(`Token for integer type not found: "${r}"`);return Number(s.get(e,0))}async parse(){this.tracks=[];let e=this.tokenizer.fileInfo.size||0;for(;!this.tokenizer.fileInfo.size||e>0;){try{if((await this.tokenizer.peekToken(gf)).name==="\0\0\0\0"){const a=`Error at offset=${this.tokenizer.position}: box.id=0`;Dr(a),this.addWarning(a);break}}catch(i){if(i instanceof Error){const a=`Error at offset=${this.tokenizer.position}: ${i.message}`;Dr(a),this.addWarning(a)}else throw i;break}const s=await yf.readAtom(this.tokenizer,(i,a)=>this.handleAtom(i,a),null,e);e-=s.header.length===BigInt(0)?e:Number(s.header.length)}const n=[];this.tracks.forEach(s=>{const i=[];s.soundSampleDescription.forEach(a=>{const l={},c=Vb[a.dataFormat];if(c?(i.push(c.format),l.codecName=c.format):l.codecName=`<${a.dataFormat}>`,a.description){const{description:u}=a;u.sampleRate>0&&(l.type=Ca.audio,l.audio={samplingFrequency:u.sampleRate,bitDepth:u.sampleSize,channels:u.numAudioChannels})}this.metadata.addStreamInfo(l)}),i.length>=1&&n.push(i.join("/"))}),n.length>0&&this.metadata.setFormat("codec",n.filter(Hb).join("+"));const r=this.tracks.filter(s=>s.soundSampleDescription.length>=1&&s.soundSampleDescription[0].description&&s.soundSampleDescription[0].description.numAudioChannels>0);if(r.length>=1){const s=r[0];if(s.timeScale>0){const l=s.duration/s.timeScale;this.metadata.setFormat("duration",l)}const i=s.soundSampleDescription[0];if(i.description&&(this.metadata.setFormat("sampleRate",i.description.sampleRate),this.metadata.setFormat("bitsPerSample",i.description.sampleSize),this.metadata.setFormat("numberOfChannels",i.description.numAudioChannels),s.timeScale===0&&s.timeToSampleTable.length>0)){const c=s.timeToSampleTable.map(u=>u.count*u.duration).reduce((u,d)=>u+d)/i.description.sampleRate;this.metadata.setFormat("duration",c)}const a=Vb[i.dataFormat];a&&this.metadata.setFormat("lossless",!a.lossy),this.calculateBitRate()}}async handleAtom(e,n){if(e.parent)switch(e.parent.header.name){case"ilst":case"<id>":return this.parseMetadataItemData(e)}if(this.atomParsers[e.header.name])return this.atomParsers[e.header.name](n);Dr(`No parser for atom path=${e.atomPath}, payload-len=${n}, ignoring atom`),await this.tokenizer.ignore(n)}getTrackDescription(){return this.tracks[this.tracks.length-1]}calculateBitRate(){this.audioLengthInBytes&&this.metadata.format.duration&&this.metadata.setFormat("bitrate",8*this.audioLengthInBytes/this.metadata.format.duration)}async addTag(e,n){await this.metadata.addTag(rX,e,n)}addWarning(e){Dr(`Warning: ${e}`),this.metadata.addWarning(e)}parseMetadataItemData(e){let n=e.header.name;return e.readAtoms(this.tokenizer,async(r,s)=>{const i=r.getPayloadLength(s);switch(r.header.name){case"data":return this.parseValueAtom(n,r);case"name":case"mean":case"rate":{const a=await this.tokenizer.readToken(new HK(i));n+=`:${a.name}`;break}default:{const a=await this.tokenizer.readToken(new gn(i));this.addWarning(`Unsupported meta-item: ${n}[${r.header.name}] => value=${k1(a)} ascii=${b1(a,"ascii")}`)}}},e.getPayloadLength(0))}async parseValueAtom(e,n){const r=await this.tokenizer.readToken(new VK(Number(n.header.length)-gf.len));if(r.type.set!==0)throw new Error(`Unsupported type-set != 0: ${r.type.set}`);switch(r.type.type){case 0:switch(e){case"trkn":case"disk":{const s=se.get(r.value,3),i=se.get(r.value,5);await this.addTag(e,`${s}/${i}`);break}case"gnre":{const s=se.get(r.value,1),i=mf[s-1];await this.addTag(e,i);break}case"rate":{const s=new TextDecoder("ascii").decode(r.value);await this.addTag(e,s);break}default:Dr(`unknown proprietary value type for: ${n.atomPath}`)}break;case 1:case 18:await this.addTag(e,new TextDecoder("utf-8").decode(r.value));break;case 13:if(this.options.skipCovers)break;await this.addTag(e,{format:"image/jpeg",data:Uint8Array.from(r.value)});break;case 14:if(this.options.skipCovers)break;await this.addTag(e,{format:"image/png",data:Uint8Array.from(r.value)});break;case 21:await this.addTag(e,xf.read_BE_Integer(r.value,!0));break;case 22:await this.addTag(e,xf.read_BE_Integer(r.value,!1));break;case 65:await this.addTag(e,se.get(r.value,0));break;case 66:await this.addTag(e,je.get(r.value,0));break;case 67:await this.addTag(e,Q.get(r.value,0));break;default:this.addWarning(`atom key=${e}, has unknown well-known-type (data-type): ${r.type.type}`)}}parseSoundSampleDescription(e){const n={dataFormat:e.dataFormat,dataReferenceIndex:e.dataReferenceIndex};let r=0;const s=Ub.get(e.description,r);return r+=Ub.len,s.version===0||s.version===1?n.description=QK.get(e.description,r):Dr(`Warning: sound-sample-description ${s} not implemented`),n}async parseChapterTrack(e,n,r){if(!e.sampleSize&&e.chunkOffsetTable.length!==e.sampleSizeTable.length)throw new Error("Expected equal chunk-offset-table & sample-size-table length.");const s=[];for(let i=0;i<e.chunkOffsetTable.length&&r>0;++i){const l=e.chunkOffsetTable[i]-this.tokenizer.position,c=e.sampleSize>0?e.sampleSize:e.sampleSizeTable[i];if(r-=l+c,r<0)throw new Error("Chapter chunk exceeding token length");await this.tokenizer.ignore(l);const u=await this.tokenizer.readToken(new tX(c));Dr(`Chapter ${i+1}: ${u}`);const d={title:u,sampleOffset:this.findSampleOffset(n,this.tokenizer.position)};Dr(`Chapter title=${d.title}, offset=${d.sampleOffset}/${this.tracks[0].duration}`),s.push(d)}this.metadata.setFormat("chapters",s),await this.tokenizer.ignore(r)}findSampleOffset(e,n){let r=0;e.timeToSampleTable.forEach(i=>{r+=i.count*i.duration}),Dr(`Total duration=${r}`);let s=0;for(;s<e.chunkOffsetTable.length&&e.chunkOffsetTable[s]<n;)++s;return this.getChunkDuration(s+1,e)}getChunkDuration(e,n){let r=0,s=n.timeToSampleTable[r].count,i=n.timeToSampleTable[r].duration,a=1,l=this.getSamplesPerChunk(a,n.sampleToChunkTable),c=0;for(;a<e;){const u=Math.min(s,l);c+=u*i,s-=u,l-=u,l===0?(++a,l=this.getSamplesPerChunk(a,n.sampleToChunkTable)):(++r,s=n.timeToSampleTable[r].count,i=n.timeToSampleTable[r].duration)}return c}getSamplesPerChunk(e,n){for(let r=0;r<n.length-1;++r)if(e>=n[r].firstChunk&&e<n[r+1].firstChunk)return n[r].samplesPerChunk;return n[n.length-1].samplesPerChunk}}var Wb;(function(t){t[t.not_set=0]="not_set",t[t.radio=1]="radio",t[t.audiophile=2]="audiophile"})(Wb||(Wb={}));var qb;(function(t){t[t.unspecified=0]="unspecified",t[t.engineer=1]="engineer",t[t.user=2]="user",t[t.automatic=3]="automatic",t[t.rms_average=4]="rms_average"})(qb||(qb={}));const Gb={len:2,get:(t,e)=>{const n=pe(t,e,0,3),r=pe(t,e,6,1),s=pe(t,e,7,9)/10;if(n>0)return{type:pe(t,e,0,3),origin:pe(t,e,3,3),adjustment:r?-s:s}}},sX={len:27,get:(t,e)=>{const n=Q.get(t,e+2);return{revision:pe(t,e,0,4),vbr_method:pe(t,e,4,4),lowpass_filter:100*se.get(t,e+1),track_peak:n===0?null:n/2**23,track_gain:Gb.get(t,6),album_gain:Gb.get(t,8),music_length:Q.get(t,e+20),music_crc:se.get(t,e+24),header_crc:je.get(t,e+24)}}},Qb=new G(4,"ascii"),Ug=new G(6,"ascii"),iX={len:4,get:(t,e)=>({frames:Pn(t,e,31),bytes:Pn(t,e,30),toc:Pn(t,e,29),vbrScale:Pn(t,e,28)})};async function aX(t){const e=await t.readToken(iX),n={numFrames:null,streamSize:null,vbrScale:null};if(e.frames&&(n.numFrames=await t.readToken(Q)),e.bytes&&(n.streamSize=await t.readToken(Q)),e.toc&&(n.toc=new Uint8Array(100),await t.readBuffer(n.toc)),e.vbrScale&&(n.vbrScale=await t.readToken(Q)),await t.peekToken(new G(4,"ascii"))==="LAME"){await t.ignore(4),n.lame={version:await t.readToken(new G(5,"ascii"))};const s=n.lame.version.match(/\d+.\d+/g);if(s!==null){const a=s[0].split(".").map(l=>Number.parseInt(l,10));a[0]>=3&&a[1]>=90&&(n.lame.extended=await t.readToken(sX))}}return n}const jn=De("music-metadata:parser:mpeg"),Kb=1024,Xb={AudioObjectTypes:["AAC Main","AAC LC","AAC SSR","AAC LTP"],SamplingFrequencies:[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350,null,null,-1]},oX=[void 0,["front-center"],["front-left","front-right"],["front-center","front-left","front-right"],["front-center","front-left","front-right","back-center"],["front-center","front-left","front-right","back-left","back-right"],["front-center","front-left","front-right","back-left","back-right","LFE-channel"],["front-center","front-left","front-right","side-left","side-right","back-left","back-right","LFE-channel"]];class kt{constructor(e,n){this.bitrateIndex=null,this.sampRateFreqIndex=null,this.padding=null,this.privateBit=null,this.channelModeIndex=null,this.modeExtension=null,this.isOriginalMedia=null,this.version=null,this.bitrate=null,this.samplingRate=null,this.frameLength=0,this.versionIndex=pe(e,n+1,3,2),this.layer=kt.LayerDescription[pe(e,n+1,5,2)],this.versionIndex>1&&this.layer===0?this.parseAdtsHeader(e,n):this.parseMpegHeader(e,n),this.isProtectedByCRC=!Pn(e,n+1,7)}calcDuration(e){return this.samplingRate==null?null:e*this.calcSamplesPerFrame()/this.samplingRate}calcSamplesPerFrame(){return kt.samplesInFrameTable[this.version===1?0:1][this.layer]}calculateSideInfoLength(){if(this.layer!==3)return 2;if(this.channelModeIndex===3){if(this.version===1)return 17;if(this.version===2||this.version===2.5)return 9}else{if(this.version===1)return 32;if(this.version===2||this.version===2.5)return 17}return null}calcSlotSize(){return[null,4,1,1][this.layer]}parseMpegHeader(e,n){this.container="MPEG",this.bitrateIndex=pe(e,n+2,0,4),this.sampRateFreqIndex=pe(e,n+2,4,2),this.padding=Pn(e,n+2,6),this.privateBit=Pn(e,n+2,7),this.channelModeIndex=pe(e,n+3,0,2),this.modeExtension=pe(e,n+3,2,2),this.isCopyrighted=Pn(e,n+3,4),this.isOriginalMedia=Pn(e,n+3,5),this.emphasis=pe(e,n+3,7,2),this.version=kt.VersionID[this.versionIndex],this.channelMode=kt.ChannelMode[this.channelModeIndex],this.codec=`MPEG ${this.version} Layer ${this.layer}`;const r=this.calcBitrate();if(!r)throw new Error("Cannot determine bit-rate");if(this.bitrate=r*1e3,this.samplingRate=this.calcSamplingRate(),this.samplingRate==null)throw new Error("Cannot determine sampling-rate")}parseAdtsHeader(e,n){jn("layer=0 => ADTS"),this.version=this.versionIndex===2?4:2,this.container=`ADTS/MPEG-${this.version}`;const r=pe(e,n+2,0,2);this.codec="AAC",this.codecProfile=Xb.AudioObjectTypes[r],jn(`MPEG-4 audio-codec=${this.codec}`);const s=pe(e,n+2,2,4);this.samplingRate=Xb.SamplingFrequencies[s],jn(`sampling-rate=${this.samplingRate}`);const i=pe(e,n+2,7,3);this.mp4ChannelConfig=oX[i],jn(`channel-config=${this.mp4ChannelConfig?this.mp4ChannelConfig.join("+"):"?"}`),this.frameLength=pe(e,n+3,6,2)<<11}calcBitrate(){if(this.bitrateIndex===0||this.bitrateIndex===15)return null;if(this.version&&this.bitrateIndex){const e=10*Math.floor(this.version)+this.layer;return kt.bitrate_index[this.bitrateIndex][e]}return null}calcSamplingRate(){return this.sampRateFreqIndex===3||this.version===null||this.sampRateFreqIndex==null?null:kt.sampling_rate_freq_index[this.version][this.sampRateFreqIndex]}}kt.SyncByte1=255;kt.SyncByte2=224;kt.VersionID=[2.5,null,2,1];kt.LayerDescription=[0,3,2,1];kt.ChannelMode=["stereo","joint_stereo","dual_channel","mono"];kt.bitrate_index={1:{11:32,12:32,13:32,21:32,22:8,23:8},2:{11:64,12:48,13:40,21:48,22:16,23:16},3:{11:96,12:56,13:48,21:56,22:24,23:24},4:{11:128,12:64,13:56,21:64,22:32,23:32},5:{11:160,12:80,13:64,21:80,22:40,23:40},6:{11:192,12:96,13:80,21:96,22:48,23:48},7:{11:224,12:112,13:96,21:112,22:56,23:56},8:{11:256,12:128,13:112,21:128,22:64,23:64},9:{11:288,12:160,13:128,21:144,22:80,23:80},10:{11:320,12:192,13:160,21:160,22:96,23:96},11:{11:352,12:224,13:192,21:176,22:112,23:112},12:{11:384,12:256,13:224,21:192,22:128,23:128},13:{11:416,12:320,13:256,21:224,22:144,23:144},14:{11:448,12:384,13:320,21:256,22:160,23:160}};kt.sampling_rate_freq_index={1:{0:44100,1:48e3,2:32e3},2:{0:22050,1:24e3,2:16e3},2.5:{0:11025,1:12e3,2:8e3}};kt.samplesInFrameTable=[[0,384,1152,1152],[0,384,1152,576]];const Yb={len:4,get:(t,e)=>new kt(t,e)};function lX(t){return`V${Math.floor((100-t)/10)}`}class cX extends yp{constructor(){super(...arguments),this.frameCount=0,this.syncFrameCount=-1,this.countSkipFrameData=0,this.totalDataLength=0,this.bitrates=[],this.offset=0,this.frame_size=0,this.crc=null,this.calculateEofDuration=!1,this.samplesPerFrame=null,this.buf_frame_header=new Uint8Array(4),this.mpegOffset=null,this.syncPeek={buf:new Uint8Array(Kb),len:0}}async postId3v2Parse(){this.metadata.setFormat("lossless",!1);try{let e=!1;for(;!e;)await this.sync(),e=await this.parseCommonMpegHeader()}catch(e){if(e instanceof ct){if(jn("End-of-stream"),this.calculateEofDuration&&this.samplesPerFrame!==null){const n=this.frameCount*this.samplesPerFrame;if(this.metadata.setFormat("numberOfSamples",n),this.metadata.format.sampleRate){const r=n/this.metadata.format.sampleRate;jn(`Calculate duration at EOF: ${r} sec.`,r),this.metadata.setFormat("duration",r)}}}else throw e}}finalize(){const e=this.metadata.format,n=!!this.metadata.native.ID3v1;if(this.mpegOffset!==null){if(e.duration&&this.tokenizer.fileInfo.size){const r=this.tokenizer.fileInfo.size-this.mpegOffset-(n?128:0);e.codecProfile&&e.codecProfile[0]==="V"&&this.metadata.setFormat("bitrate",r*8/e.duration)}else if(this.tokenizer.fileInfo.size&&e.codecProfile==="CBR"){const r=this.tokenizer.fileInfo.size-this.mpegOffset-(n?128:0);if(this.frame_size!==null&&this.samplesPerFrame!==null){const s=Math.round(r/this.frame_size)*this.samplesPerFrame;if(this.metadata.setFormat("numberOfSamples",s),e.sampleRate){const i=s/e.sampleRate;jn("Calculate CBR duration based on file size: %s",i),this.metadata.setFormat("duration",i)}}}}}async sync(){let e=!1;for(;;){let n=0;if(this.syncPeek.len=await this.tokenizer.peekBuffer(this.syncPeek.buf,{length:Kb,mayBeLess:!0}),this.syncPeek.len<=163)throw new ct;for(;;){if(e&&(this.syncPeek.buf[n]&224)===224){this.buf_frame_header[0]=kt.SyncByte1,this.buf_frame_header[1]=this.syncPeek.buf[n],await this.tokenizer.ignore(n),jn(`Sync at offset=${this.tokenizer.position-1}, frameCount=${this.frameCount}`),this.syncFrameCount===this.frameCount&&(jn(`Re-synced MPEG stream, frameCount=${this.frameCount}`),this.frameCount=0,this.frame_size=0),this.syncFrameCount=this.frameCount;return}if(e=!1,n=this.syncPeek.buf.indexOf(kt.SyncByte1,n),n===-1){if(this.syncPeek.len<this.syncPeek.buf.length)throw new ct;await this.tokenizer.ignore(this.syncPeek.len);break}++n,e=!0}}}async parseCommonMpegHeader(){this.frameCount===0&&(this.mpegOffset=this.tokenizer.position-1),await this.tokenizer.peekBuffer(this.buf_frame_header,{offset:1,length:3});let e;try{e=Yb.get(this.buf_frame_header,0)}catch(n){if(await this.tokenizer.ignore(1),n instanceof Error)return this.metadata.addWarning(`Parse error: ${n.message}`),!1;throw n}return await this.tokenizer.ignore(3),this.metadata.setFormat("container",e.container),this.metadata.setFormat("codec",e.codec),this.metadata.setFormat("lossless",!1),this.metadata.setFormat("sampleRate",e.samplingRate),this.frameCount++,e.version!==null&&e.version>=2&&e.layer===0?this.parseAdts(e):this.parseAudioFrameHeader(e)}async parseAudioFrameHeader(e){this.metadata.setFormat("numberOfChannels",e.channelMode==="mono"?1:2),this.metadata.setFormat("bitrate",e.bitrate),this.frameCount<20*1e4&&jn("offset=%s MP%s bitrate=%s sample-rate=%s",this.tokenizer.position-4,e.layer,e.bitrate,e.samplingRate);const n=e.calcSlotSize();if(n===null)throw new Error("invalid slot_size");const r=e.calcSamplesPerFrame();jn(`samples_per_frame=${r}`);const s=r/8;if(e.bitrate!==null&&e.samplingRate!=null){const i=s*e.bitrate/e.samplingRate+(e.padding?n:0);this.frame_size=Math.floor(i)}if(this.audioFrameHeader=e,e.bitrate!==null&&this.bitrates.push(e.bitrate),this.frameCount===1)return this.offset=Yb.len,await this.skipSideInformation(),!1;if(this.frameCount===3){if(this.areAllSame(this.bitrates)){if(this.samplesPerFrame=r,this.metadata.setFormat("codecProfile","CBR"),this.tokenizer.fileInfo.size)return!0}else if(this.metadata.format.duration)return!0;if(!this.options.duration)return!0}return this.options.duration&&this.frameCount===4&&(this.samplesPerFrame=r,this.calculateEofDuration=!0),this.offset=4,e.isProtectedByCRC?(await this.parseCrc(),!1):(await this.skipSideInformation(),!1)}async parseAdts(e){const n=new Uint8Array(3);if(await this.tokenizer.readBuffer(n),e.frameLength+=pe(n,0,0,11),this.totalDataLength+=e.frameLength,this.samplesPerFrame=1024,e.samplingRate!==null){const r=e.samplingRate/this.samplesPerFrame,i=8*(this.frameCount===0?0:this.totalDataLength/this.frameCount)*r+.5;this.metadata.setFormat("bitrate",i),jn(`frame-count=${this.frameCount}, size=${e.frameLength} bytes, bit-rate=${i}`)}if(await this.tokenizer.ignore(e.frameLength>7?e.frameLength-7:1),this.frameCount===3)if(this.metadata.setFormat("codecProfile",e.codecProfile),e.mp4ChannelConfig&&this.metadata.setFormat("numberOfChannels",e.mp4ChannelConfig.length),this.options.duration)this.calculateEofDuration=!0;else return!0;return!1}async parseCrc(){return this.crc=await this.tokenizer.readNumber(Es),this.offset+=2,this.skipSideInformation()}async skipSideInformation(){if(this.audioFrameHeader){const e=this.audioFrameHeader.calculateSideInfoLength();if(e!==null){await this.tokenizer.readToken(new gn(e)),this.offset+=e,await this.readXtraInfoHeader();return}}}async readXtraInfoHeader(){const e=await this.tokenizer.readToken(Qb);switch(this.offset+=Qb.len,e){case"Info":return this.metadata.setFormat("codecProfile","CBR"),this.readXingInfoHeader();case"Xing":{const r=await this.readXingInfoHeader();if(r.vbrScale!==null){const s=lX(r.vbrScale);this.metadata.setFormat("codecProfile",s)}return null}case"Xtra":break;case"LAME":{const r=await this.tokenizer.readToken(Ug);if(this.frame_size!==null&&this.frame_size>=this.offset+Ug.len)return this.offset+=Ug.len,this.metadata.setFormat("tool",`LAME ${r}`),await this.skipFrameData(this.frame_size-this.offset),null;this.metadata.addWarning("Corrupt LAME header");break}}const n=this.frame_size-this.offset;return n<0?this.metadata.addWarning(`Frame ${this.frameCount}corrupt: negative frameDataLeft`):await this.skipFrameData(n),null}async readXingInfoHeader(){const e=this.tokenizer.position,n=await aX(this.tokenizer);if(this.offset+=this.tokenizer.position-e,n.lame&&(this.metadata.setFormat("tool",`LAME ${si(n.lame.version)}`),n.lame.extended&&(this.metadata.setFormat("trackPeakLevel",n.lame.extended.track_peak),n.lame.extended.track_gain&&this.metadata.setFormat("trackGain",n.lame.extended.track_gain.adjustment),n.lame.extended.album_gain&&this.metadata.setFormat("albumGain",n.lame.extended.album_gain.adjustment),this.metadata.setFormat("duration",n.lame.extended.music_length/1e3))),n.streamSize&&this.audioFrameHeader&&n.numFrames!==null){const s=this.audioFrameHeader.calcDuration(n.numFrames);return this.metadata.setFormat("duration",s),jn("Get duration from Xing header: %s",this.metadata.format.duration),n}const r=this.frame_size-this.offset;return await this.skipFrameData(r),n}async skipFrameData(e){if(e<0)throw new Error("frame-data-left cannot be negative");await this.tokenizer.ignore(e),this.countSkipFrameData+=e}areAllSame(e){const n=e[0];return e.every(r=>r===n)}}const Jb=De("music-metadata:parser:musepack:sv8"),uX=new G(2,"latin1"),Zb={len:5,get:(t,e)=>({crc:U.get(t,e),streamVersion:se.get(t,e+4)})},ek={len:2,get:(t,e)=>({sampleFrequency:[44100,48e3,37800,32e3][pe(t,e,0,3)],maxUsedBands:pe(t,e,3,5),channelCount:pe(t,e+1,0,4)+1,msUsed:Pn(t,e+1,4),audioBlockFrames:pe(t,e+1,5,3)})};class dX{constructor(e){this.tokenizer=e}async readPacketHeader(){const e=await this.tokenizer.readToken(uX),n=await this.readVariableSizeField();return{key:e,payloadLength:n.value-2-n.len}}async readStreamHeader(e){const n={};Jb(`Reading SH at offset=${this.tokenizer.position}`);const r=await this.tokenizer.readToken(Zb);e-=Zb.len,Object.assign(n,r),Jb(`SH.streamVersion = ${r.streamVersion}`);const s=await this.readVariableSizeField();e-=s.len,n.sampleCount=s.value;const i=await this.readVariableSizeField();e-=i.len,n.beginningOfSilence=i.value;const a=await this.tokenizer.readToken(ek);return e-=ek.len,Object.assign(n,a),await this.tokenizer.ignore(e),n}async readVariableSizeField(e=1,n=0){let r=await this.tokenizer.readNumber(se);return r&128?(r&=127,r+=n,this.readVariableSizeField(e+1,r<<7)):{len:e,value:n+r}}}const hX=De("music-metadata:parser:musepack");class fX extends Yn{constructor(){super(...arguments),this.audioLength=0}async parse(){if(await this.tokenizer.readToken(He)!=="MPCK")throw new Error("Invalid Magic number");return this.metadata.setFormat("container","Musepack, SV8"),this.parsePacket()}async parsePacket(){const e=new dX(this.tokenizer);do{const n=await e.readPacketHeader();switch(hX(`packet-header key=${n.key}, payloadLength=${n.payloadLength}`),n.key){case"SH":{const r=await e.readStreamHeader(n.payloadLength);this.metadata.setFormat("numberOfSamples",r.sampleCount),this.metadata.setFormat("sampleRate",r.sampleFrequency),this.metadata.setFormat("duration",r.sampleCount/r.sampleFrequency),this.metadata.setFormat("numberOfChannels",r.channelCount);break}case"AP":this.audioLength+=n.payloadLength,await this.tokenizer.ignore(n.payloadLength);break;case"RG":case"EI":case"SO":case"ST":case"CT":await this.tokenizer.ignore(n.payloadLength);break;case"SE":return this.metadata.format.duration&&this.metadata.setFormat("bitrate",this.audioLength*8/this.metadata.format.duration),qr.tryParseApeHeader(this.metadata,this.tokenizer,this.options);default:throw new Error(`Unexpected header: ${n.key}`)}}while(!0)}}class mX{constructor(e){this.tokenizer=e,this.pos=0,this.dword=null}async read(e){for(;this.dword===null;)this.dword=await this.tokenizer.readToken(U);let n=this.dword;return this.pos+=e,this.pos<32?(n>>>=32-this.pos,n&(1<<e)-1):(this.pos-=32,this.pos===0?(this.dword=null,n&(1<<e)-1):(this.dword=await this.tokenizer.readToken(U),this.pos&&(n<<=this.pos,n|=this.dword>>>32-this.pos),n&(1<<e)-1))}async ignore(e){if(this.pos>0){const s=32-this.pos;this.dword=null,e-=s,this.pos=0}const n=e%32,r=(e-n)/32;return await this.tokenizer.ignore(r*4),this.read(n)}}const pX={len:6*4,get:(t,e)=>{const n={signature:new TextDecoder("latin1").decode(t.subarray(e,e+3)),streamMinorVersion:pe(t,e+3,0,4),streamMajorVersion:pe(t,e+3,4,4),frameCount:U.get(t,e+4),maxLevel:Te.get(t,e+8),sampleFrequency:[44100,48e3,37800,32e3][pe(t,e+10,0,2)],link:pe(t,e+10,2,2),profile:pe(t,e+10,4,4),maxBand:pe(t,e+11,0,6),intensityStereo:Pn(t,e+11,6),midSideStereo:Pn(t,e+11,7),titlePeak:Te.get(t,e+12),titleGain:Te.get(t,e+14),albumPeak:Te.get(t,e+16),albumGain:Te.get(t,e+18),lastFrameLength:U.get(t,e+20)>>>20&2047,trueGapless:Pn(t,e+23,0)};return n.lastFrameLength=n.trueGapless?U.get(t,20)>>>20&2047:0,n}},tk=De("music-metadata:parser:musepack");class gX extends Yn{constructor(){super(...arguments),this.bitreader=null,this.audioLength=0,this.duration=null}async parse(){const e=await this.tokenizer.readToken(pX);if(e.signature!=="MP+")throw new Error("Unexpected magic number");tk(`stream-version=${e.streamMajorVersion}.${e.streamMinorVersion}`),this.metadata.setFormat("container","Musepack, SV7"),this.metadata.setFormat("sampleRate",e.sampleFrequency);const n=1152*(e.frameCount-1)+e.lastFrameLength;this.metadata.setFormat("numberOfSamples",n),this.duration=n/e.sampleFrequency,this.metadata.setFormat("duration",this.duration),this.bitreader=new mX(this.tokenizer),this.metadata.setFormat("numberOfChannels",e.midSideStereo||e.intensityStereo?2:1);const r=await this.bitreader.read(8);return this.metadata.setFormat("codec",(r/100).toFixed(2)),await this.skipAudioData(e.frameCount),tk(`End of audio stream, switching to APEv2, offset=${this.tokenizer.position}`),qr.tryParseApeHeader(this.metadata,this.tokenizer,this.options)}async skipAudioData(e){for(;e-- >0;){const r=await this.bitreader.read(20);this.audioLength+=20+r,await this.bitreader.ignore(r)}const n=await this.bitreader.read(11);this.audioLength+=n,this.duration!==null&&this.metadata.setFormat("bitrate",this.audioLength/this.duration)}}const nk=De("music-metadata:parser:musepack");class yX extends yp{async postId3v2Parse(){const e=await this.tokenizer.peekToken(new G(3,"latin1"));let n;switch(e){case"MP+":{nk("Musepack stream-version 7"),n=new gX;break}case"MPC":{nk("Musepack stream-version 8"),n=new fX;break}default:throw new Error("Invalid Musepack signature prefix")}return n.init(this.metadata,this.tokenizer,this.options),n.parse()}}class xX{constructor(e){if(this.len=e,e<19)throw new Error("ID-header-page 0 should be at least 19 bytes long")}get(e,n){return{magicSignature:new G(8,"ascii").get(e,n+0),version:se.get(e,n+8),channelCount:se.get(e,n+9),preSkip:Te.get(e,n+10),inputSampleRate:U.get(e,n+12),outputGain:Te.get(e,n+16),channelMapping:se.get(e,n+18)}}}class vX extends Aa{constructor(e,n,r){super(e,n),this.tokenizer=r,this.idHeader=null,this.lastPos=-1}parseFirstPage(e,n){if(this.metadata.setFormat("codec","Opus"),this.idHeader=new xX(n.length).get(n,0),this.idHeader.magicSignature!=="OpusHead")throw new Error("Illegal ogg/Opus magic-signature");this.metadata.setFormat("sampleRate",this.idHeader.inputSampleRate),this.metadata.setFormat("numberOfChannels",this.idHeader.channelCount)}async parseFullPage(e){switch(new G(8,"ascii").get(e,0)){case"OpusTags":await this.parseUserCommentList(e,8),this.lastPos=this.tokenizer.position-e.length;break}}calculateDuration(e){if(this.metadata.format.sampleRate&&e.absoluteGranulePosition>=0){const n=e.absoluteGranulePosition-this.idHeader.preSkip;if(this.metadata.setFormat("numberOfSamples",n),this.metadata.setFormat("duration",n/48e3),this.lastPos!==-1&&this.tokenizer.fileInfo.size&&this.metadata.format.duration){const r=this.tokenizer.fileInfo.size-this.lastPos;this.metadata.setFormat("bitrate",8*r/this.metadata.format.duration)}}}}const wX={len:80,get:(t,e)=>({speex:new G(8,"ascii").get(t,e+0),version:ON(new G(20,"ascii").get(t,e+8)),version_id:at.get(t,e+28),header_size:at.get(t,e+32),rate:at.get(t,e+36),mode:at.get(t,e+40),mode_bitstream_version:at.get(t,e+44),nb_channels:at.get(t,e+48),bitrate:at.get(t,e+52),frame_size:at.get(t,e+56),vbr:at.get(t,e+60),frames_per_packet:at.get(t,e+64),extra_headers:at.get(t,e+68),reserved1:at.get(t,e+72),reserved2:at.get(t,e+76)})},_X=De("music-metadata:parser:ogg:speex");class SX extends Aa{constructor(e,n,r){super(e,n),this.tokenizer=r}parseFirstPage(e,n){_X("First Ogg/Speex page");const r=wX.get(n,0);this.metadata.setFormat("codec",`Speex ${r.version}`),this.metadata.setFormat("numberOfChannels",r.nb_channels),this.metadata.setFormat("sampleRate",r.rate),r.bitrate!==-1&&this.metadata.setFormat("bitrate",r.bitrate)}}const EX={len:42,get:(t,e)=>({id:new G(7,"ascii").get(t,e),vmaj:se.get(t,e+7),vmin:se.get(t,e+8),vrev:se.get(t,e+9),vmbw:je.get(t,e+10),vmbh:je.get(t,e+17),nombr:hn.get(t,e+37),nqual:se.get(t,e+40)})},Vg=De("music-metadata:parser:ogg:theora");class bX{constructor(e,n,r){this.metadata=e,this.tokenizer=r}async parsePage(e,n){e.headerType.firstPage&&await this.parseFirstPage(e,n)}async flush(){Vg("flush")}calculateDuration(e){Vg("duration calculation not implemented")}async parseFirstPage(e,n){Vg("First Ogg/Theora page"),this.metadata.setFormat("codec","Theora");const r=EX.get(n,0);this.metadata.setFormat("bitrate",r.nombr)}}const fs=De("music-metadata:parser:ogg");class N1{static sum(e,n,r){const s=new DataView(e.buffer,0);let i=0;for(let a=n;a<n+r;++a)i+=s.getUint8(a);return i}constructor(e){this.len=e.page_segments}get(e,n){return{totalPageSize:N1.sum(e,n,this.len)}}}class xp extends Yn{constructor(){super(...arguments),this.header=null,this.pageNumber=0,this.pageConsumer=null}async parse(){fs("pos=%s, parsePage()",this.tokenizer.position);try{let e;do{if(e=await this.tokenizer.readToken(xp.Header),e.capturePattern!=="OggS")throw new Error("Invalid Ogg capture pattern");this.metadata.setFormat("container","Ogg"),this.header=e,this.pageNumber=e.pageSequenceNo,fs("page#=%s, Ogg.id=%s",e.pageSequenceNo,e.capturePattern);const n=await this.tokenizer.readToken(new N1(e));fs("totalPageSize=%s",n.totalPageSize);const r=await this.tokenizer.readToken(new gn(n.totalPageSize));if(fs("firstPage=%s, lastPage=%s, continued=%s",e.headerType.firstPage,e.headerType.lastPage,e.headerType.continued),e.headerType.firstPage){const s=new TextDecoder("ascii").decode(r.subarray(0,7));switch(s){case"vorbis":fs("Set page consumer to Ogg/Vorbis"),this.pageConsumer=new Aa(this.metadata,this.options);break;case"OpusHea":fs("Set page consumer to Ogg/Opus"),this.pageConsumer=new vX(this.metadata,this.options,this.tokenizer);break;case"Speex  ":fs("Set page consumer to Ogg/Speex"),this.pageConsumer=new SX(this.metadata,this.options,this.tokenizer);break;case"fishead":case"\0theora":fs("Set page consumer to Ogg/Theora"),this.pageConsumer=new bX(this.metadata,this.options,this.tokenizer);break;default:throw new Error(`gg audio-codec not recognized (id=${s})`)}}await this.pageConsumer.parsePage(e,r)}while(!e.headerType.lastPage)}catch(e){if(e instanceof Error)e instanceof ct?(this.metadata.addWarning("Last OGG-page is not marked with last-page flag"),fs("End-of-stream"),this.metadata.addWarning("Last OGG-page is not marked with last-page flag"),this.header&&this.pageConsumer.calculateDuration(this.header)):e.message.startsWith("FourCC")&&this.pageNumber>0&&(this.metadata.addWarning("Invalid FourCC ID, maybe last OGG-page is not marked with last-page flag"),await this.pageConsumer.flush());else throw e}}}xp.Header={len:27,get:(t,e)=>({capturePattern:He.get(t,e),version:se.get(t,e+4),headerType:{continued:tt(t,e+5,0),firstPage:tt(t,e+5,1),lastPage:tt(t,e+5,2)},absoluteGranulePosition:Number(ln.get(t,e+6)),streamSerialNumber:U.get(t,e+14),pageSequenceNo:U.get(t,e+18),pageChecksum:U.get(t,e+22),page_segments:se.get(t,e+26)})};const Dl={len:8,get:(t,e)=>({chunkID:new G(4,"latin1").get(t,e),chunkSize:U.get(t,e+4)})};class kX{constructor(e){this.tagHeader=e,this.len=e.chunkSize,this.len+=this.len&1}get(e,n){return new G(this.tagHeader.chunkSize,"ascii").get(e,n)}}var ex;(function(t){t[t.PCM=1]="PCM",t[t.ADPCM=2]="ADPCM",t[t.IEEE_FLOAT=3]="IEEE_FLOAT",t[t.MPEG_ADTS_AAC=5632]="MPEG_ADTS_AAC",t[t.MPEG_LOAS=5634]="MPEG_LOAS",t[t.RAW_AAC1=255]="RAW_AAC1",t[t.DOLBY_AC3_SPDIF=146]="DOLBY_AC3_SPDIF",t[t.DVM=8192]="DVM",t[t.RAW_SPORT=576]="RAW_SPORT",t[t.ESST_AC3=577]="ESST_AC3",t[t.DRM=9]="DRM",t[t.DTS2=8193]="DTS2",t[t.MPEG=80]="MPEG"})(ex||(ex={}));class TX{constructor(e){if(e.chunkSize<16)throw new Error("Invalid chunk size");this.len=e.chunkSize}get(e,n){return{wFormatTag:Te.get(e,n),nChannels:Te.get(e,n+2),nSamplesPerSec:U.get(e,n+4),nAvgBytesPerSec:U.get(e,n+8),nBlockAlign:Te.get(e,n+12),wBitsPerSample:Te.get(e,n+14)}}}class IX{constructor(e){if(e.chunkSize<4)throw new Error("Invalid fact chunk size.");this.len=e.chunkSize}get(e,n){return{dwSampleLength:U.get(e,n)}}}const rk={len:420,get:(t,e)=>({description:si(new G(256,"ascii").get(t,e)).trim(),originator:si(new G(32,"ascii").get(t,e+256)).trim(),originatorReference:si(new G(32,"ascii").get(t,e+288)).trim(),originationDate:si(new G(10,"ascii").get(t,e+320)).trim(),originationTime:si(new G(8,"ascii").get(t,e+330)).trim(),timeReferenceLow:U.get(t,e+338),timeReferenceHigh:U.get(t,e+342),version:Te.get(t,e+346),umid:new gn(64).get(t,e+348),loudnessValue:Te.get(t,e+412),maxTruePeakLevel:Te.get(t,e+414),maxMomentaryLoudness:Te.get(t,e+416),maxShortTermLoudness:Te.get(t,e+418)})},Qs=De("music-metadata:parser:RIFF");class CX extends Yn{constructor(){super(...arguments),this.blockAlign=0}async parse(){const e=await this.tokenizer.readToken(Dl);if(Qs(`pos=${this.tokenizer.position}, parse: chunkID=${e.chunkID}`),e.chunkID==="RIFF")return this.parseRiffChunk(e.chunkSize).catch(n=>{if(!(n instanceof ct))throw n})}async parseRiffChunk(e){const n=await this.tokenizer.readToken(He);switch(this.metadata.setFormat("container",n),n){case"WAVE":return this.readWaveChunk(e-He.len);default:throw new Error(`Unsupported RIFF format: RIFF/${n}`)}}async readWaveChunk(e){for(;e>=Dl.len;){const n=await this.tokenizer.readToken(Dl);switch(e-=Dl.len+n.chunkSize,n.chunkSize>e&&this.metadata.addWarning("Data chunk size exceeds file size"),this.header=n,Qs(`pos=${this.tokenizer.position}, readChunk: chunkID=RIFF/WAVE/${n.chunkID}`),n.chunkID){case"LIST":await this.parseListTag(n);break;case"fact":this.metadata.setFormat("lossless",!1),this.fact=await this.tokenizer.readToken(new IX(n));break;case"fmt ":{const r=await this.tokenizer.readToken(new TX(n));let s=ex[r.wFormatTag];s||(Qs(`WAVE/non-PCM format=${r.wFormatTag}`),s=`non-PCM (${r.wFormatTag})`),this.metadata.setFormat("codec",s),this.metadata.setFormat("bitsPerSample",r.wBitsPerSample),this.metadata.setFormat("sampleRate",r.nSamplesPerSec),this.metadata.setFormat("numberOfChannels",r.nChannels),this.metadata.setFormat("bitrate",r.nBlockAlign*r.nSamplesPerSec*8),this.blockAlign=r.nBlockAlign;break}case"id3 ":case"ID3 ":{const r=await this.tokenizer.readToken(new gn(n.chunkSize)),s=Xo(r);await new br().parse(this.metadata,s,this.options);break}case"data":{this.metadata.format.lossless!==!1&&this.metadata.setFormat("lossless",!0);let r=n.chunkSize;if(this.tokenizer.fileInfo.size){const i=this.tokenizer.fileInfo.size-this.tokenizer.position;i<r&&(this.metadata.addWarning("data chunk length exceeding file length"),r=i)}const s=this.fact?this.fact.dwSampleLength:r===4294967295?void 0:r/this.blockAlign;s&&(this.metadata.setFormat("numberOfSamples",s),this.metadata.format.sampleRate&&this.metadata.setFormat("duration",s/this.metadata.format.sampleRate)),this.metadata.format.codec==="ADPCM"?this.metadata.setFormat("bitrate",352e3):this.metadata.format.sampleRate&&this.metadata.setFormat("bitrate",this.blockAlign*this.metadata.format.sampleRate*8),await this.tokenizer.ignore(n.chunkSize);break}case"bext":{const r=await this.tokenizer.readToken(rk);Object.keys(r).forEach(i=>{this.metadata.addTag("exif",`bext.${i}`,r[i])});const s=n.chunkSize-rk.len;await this.tokenizer.ignore(s);break}case"\0\0\0\0":Qs(`Ignore padding chunk: RIFF/${n.chunkID} of ${n.chunkSize} bytes`),this.metadata.addWarning(`Ignore chunk: RIFF/${n.chunkID}`),await this.tokenizer.ignore(n.chunkSize);break;default:Qs(`Ignore chunk: RIFF/${n.chunkID} of ${n.chunkSize} bytes`),this.metadata.addWarning(`Ignore chunk: RIFF/${n.chunkID}`),await this.tokenizer.ignore(n.chunkSize)}this.header.chunkSize%2===1&&(Qs("Read odd padding byte"),await this.tokenizer.ignore(1))}}async parseListTag(e){const n=await this.tokenizer.readToken(new G(4,"latin1"));switch(Qs("pos=%s, parseListTag: chunkID=RIFF/WAVE/LIST/%s",this.tokenizer.position,n),n){case"INFO":return this.parseRiffInfoTags(e.chunkSize-4);default:return this.metadata.addWarning(`Ignore chunk: RIFF/WAVE/LIST/${n}`),Qs(`Ignoring chunkID=RIFF/WAVE/LIST/${n}`),this.tokenizer.ignore(e.chunkSize-4).then()}}async parseRiffInfoTags(e){for(;e>=8;){const n=await this.tokenizer.readToken(Dl),r=new kX(n),s=await this.tokenizer.readToken(r);this.addTag(n.chunkID,si(s)),e-=8+r.len}if(e!==0)throw new Error(`Illegal remaining size: ${e}`)}addTag(e,n){this.metadata.addTag("exif",e,n)}}const RX=[6e3,8e3,9600,11025,12e3,16e3,22050,24e3,32e3,44100,48e3,64e3,88200,96e3,192e3,-1],Rd={len:32,get:(t,e)=>{const n=U.get(t,e+24),r={BlockID:He.get(t,e),blockSize:U.get(t,e+4),version:Te.get(t,e+8),totalSamples:U.get(t,e+12),blockIndex:U.get(t,e+16),blockSamples:U.get(t,e+20),flags:{bitsPerSample:(1+vf(n,0,2))*8,isMono:Lr(n,2),isHybrid:Lr(n,3),isJointStereo:Lr(n,4),crossChannel:Lr(n,5),hybridNoiseShaping:Lr(n,6),floatingPoint:Lr(n,7),samplingRate:RX[vf(n,23,4)],isDSD:Lr(n,31)},crc:new gn(4).get(t,e+28)};return r.flags.isDSD&&(r.totalSamples*=8),r}},Hg={len:1,get:(t,e)=>({functionId:vf(t[e],0,6),isOptional:Lr(t[e],5),isOddSize:Lr(t[e],6),largeBlock:Lr(t[e],7)})};function Lr(t,e){return vf(t,e,1)===1}function vf(t,e,n){return t>>>e&4294967295>>>32-n}const Ki=De("music-metadata:parser:WavPack");class AX extends Yn{constructor(){super(...arguments),this.audioDataSize=0}async parse(){return this.audioDataSize=0,await this.parseWavPackBlocks(),qr.tryParseApeHeader(this.metadata,this.tokenizer,this.options)}async parseWavPackBlocks(){do{if(await this.tokenizer.peekToken(He)!=="wvpk")break;const n=await this.tokenizer.readToken(Rd);if(n.BlockID!=="wvpk")throw new Error("Invalid WavPack Block-ID");Ki(`WavPack header blockIndex=${n.blockIndex}, len=${Rd.len}`),n.blockIndex===0&&!this.metadata.format.container&&(this.metadata.setFormat("container","WavPack"),this.metadata.setFormat("lossless",!n.flags.isHybrid),this.metadata.setFormat("bitsPerSample",n.flags.bitsPerSample),n.flags.isDSD||(this.metadata.setFormat("sampleRate",n.flags.samplingRate),this.metadata.setFormat("duration",n.totalSamples/n.flags.samplingRate)),this.metadata.setFormat("numberOfChannels",n.flags.isMono?1:2),this.metadata.setFormat("numberOfSamples",n.totalSamples),this.metadata.setFormat("codec",n.flags.isDSD?"DSD":"PCM"));const r=n.blockSize-(Rd.len-8);await(n.blockIndex===0?this.parseMetadataSubBlock(n,r):this.tokenizer.ignore(r)),n.blockSamples>0&&(this.audioDataSize+=n.blockSize)}while(!this.tokenizer.fileInfo.size||this.tokenizer.fileInfo.size-this.tokenizer.position>=Rd.len);this.metadata.format.duration&&this.metadata.setFormat("bitrate",this.audioDataSize*8/this.metadata.format.duration)}async parseMetadataSubBlock(e,n){let r=n;for(;r>Hg.len;){const s=await this.tokenizer.readToken(Hg),i=await this.tokenizer.readNumber(s.largeBlock?uf:se),a=new Uint8Array(i*2-(s.isOddSize?1:0));switch(await this.tokenizer.readBuffer(a),Ki(`Metadata Sub-Blocks functionId=0x${s.functionId.toString(16)}, id.largeBlock=${s.largeBlock},data-size=${a.length}`),s.functionId){case 0:break;case 14:{Ki("ID_DSD_BLOCK");const l=1<<se.get(a,0),c=e.flags.samplingRate*l*8;if(!e.flags.isDSD)throw new Error("Only expect DSD block if DSD-flag is set");this.metadata.setFormat("sampleRate",c),this.metadata.setFormat("duration",e.totalSamples/c);break}case 36:Ki("ID_ALT_TRAILER: trailer for non-wav files");break;case 38:this.metadata.setFormat("audioMD5",a);break;case 47:Ki(`ID_BLOCK_CHECKSUM: checksum=${k1(a)}`);break;default:Ki(`Ignore unsupported meta-sub-block-id functionId=0x${s.functionId.toString(16)}`);break}r-=Hg.len+(s.largeBlock?uf.len:se.len)+i*2,Ki(`remainingLength=${r}`),s.isOddSize&&this.tokenizer.ignore(1)}if(r!==0)throw new Error("metadata-sub-block should fit it remaining length")}}const Ad={len:12,get:(t,e)=>({id:He.get(t,e),size:ln.get(t,e+4)})},jX={len:16,get:(t,e)=>({fileSize:df.get(t,e),metadataPointer:df.get(t,e+8)})};var sk;(function(t){t[t.mono=1]="mono",t[t.stereo=2]="stereo",t[t.channels=3]="channels",t[t.quad=4]="quad",t[t["4 channels"]=5]="4 channels",t[t["5 channels"]=6]="5 channels",t[t["5.1 channels"]=7]="5.1 channels"})(sk||(sk={}));const NX={len:40,get:(t,e)=>({formatVersion:at.get(t,e),formatID:at.get(t,e+4),channelType:at.get(t,e+8),channelNum:at.get(t,e+12),samplingFrequency:at.get(t,e+16),bitsPerSample:at.get(t,e+20),sampleCount:df.get(t,e+24),blockSizePerChannel:at.get(t,e+32)})},Wg=De("music-metadata:parser:DSF");class PX extends yp{async postId3v2Parse(){const e=this.tokenizer.position,n=await this.tokenizer.readToken(Ad);if(n.id!=="DSD ")throw new Error("Invalid chunk signature");this.metadata.setFormat("container","DSF"),this.metadata.setFormat("lossless",!0);const r=await this.tokenizer.readToken(jX);if(r.metadataPointer===BigInt(0))Wg("No ID3v2 tag present");else return Wg(`expect ID3v2 at offset=${r.metadataPointer}`),await this.parseChunks(r.fileSize-n.size),await this.tokenizer.ignore(Number(r.metadataPointer)-this.tokenizer.position-e),new br().parse(this.metadata,this.tokenizer,this.options)}async parseChunks(e){for(;e>=Ad.len;){const n=await this.tokenizer.readToken(Ad);switch(Wg(`Parsing chunk name=${n.id} size=${n.size}`),n.id){case"fmt ":{const r=await this.tokenizer.readToken(NX);this.metadata.setFormat("numberOfChannels",r.channelNum),this.metadata.setFormat("sampleRate",r.samplingFrequency),this.metadata.setFormat("bitsPerSample",r.bitsPerSample),this.metadata.setFormat("numberOfSamples",r.sampleCount),this.metadata.setFormat("duration",Number(r.sampleCount)/r.samplingFrequency);const s=r.bitsPerSample*r.samplingFrequency*r.channelNum;this.metadata.setFormat("bitrate",s);return}default:this.tokenizer.ignore(Number(n.size)-Ad.len);break}e-=n.size}}}const Xa={len:12,get:(t,e)=>({chunkID:He.get(t,e),chunkSize:IN.get(t,e+4)})},an=De("music-metadata:parser:aiff");class FX extends Yn{async parse(){const e=await this.tokenizer.readToken(Xa);if(e.chunkID!=="FRM8")throw new Error("Unexpected chunk-ID");const n=(await this.tokenizer.readToken(He)).trim();switch(n){case"DSD":return this.metadata.setFormat("container",`DSDIFF/${n}`),this.metadata.setFormat("lossless",!0),this.readFmt8Chunks(e.chunkSize-BigInt(He.len));default:throw new Error(`Unsupported DSDIFF type: ${n}`)}}async readFmt8Chunks(e){for(;e>=Xa.len;){const n=await this.tokenizer.readToken(Xa);an(`Chunk id=${n.chunkID}`),await this.readData(n),e-=BigInt(Xa.len)+n.chunkSize}}async readData(e){an(`Reading data of chunk[ID=${e.chunkID}, size=${e.chunkSize}]`);const n=this.tokenizer.position;switch(e.chunkID.trim()){case"FVER":{const s=await this.tokenizer.readToken(U);an(`DSDIFF version=${s}`);break}case"PROP":{if(await this.tokenizer.readToken(He)!=="SND ")throw new Error("Unexpected PROP-chunk ID");await this.handleSoundPropertyChunks(e.chunkSize-BigInt(He.len));break}case"ID3":{const s=await this.tokenizer.readToken(new gn(Number(e.chunkSize))),i=Xo(s);await new br().parse(this.metadata,i,this.options);break}case"DSD":this.metadata.format.numberOfChannels&&this.metadata.setFormat("numberOfSamples",Number(e.chunkSize*BigInt(8)/BigInt(this.metadata.format.numberOfChannels))),this.metadata.format.numberOfSamples&&this.metadata.format.sampleRate&&this.metadata.setFormat("duration",this.metadata.format.numberOfSamples/this.metadata.format.sampleRate);break;default:an(`Ignore chunk[ID=${e.chunkID}, size=${e.chunkSize}]`);break}const r=e.chunkSize-BigInt(this.tokenizer.position-n);r>0&&(an(`After Parsing chunk, remaining ${r} bytes`),await this.tokenizer.ignore(Number(r)))}async handleSoundPropertyChunks(e){for(an(`Parsing sound-property-chunks, remainingSize=${e}`);e>0;){const n=await this.tokenizer.readToken(Xa);an(`Sound-property-chunk[ID=${n.chunkID}, size=${n.chunkSize}]`);const r=this.tokenizer.position;switch(n.chunkID.trim()){case"FS":{const i=await this.tokenizer.readToken(Q);this.metadata.setFormat("sampleRate",i);break}case"CHNL":{const i=await this.tokenizer.readToken(je);this.metadata.setFormat("numberOfChannels",i),await this.handleChannelChunks(n.chunkSize-BigInt(je.len));break}case"CMPR":{const i=(await this.tokenizer.readToken(He)).trim(),a=await this.tokenizer.readToken(se),l=await this.tokenizer.readToken(new G(a,"ascii"));i==="DSD"&&(this.metadata.setFormat("lossless",!0),this.metadata.setFormat("bitsPerSample",1)),this.metadata.setFormat("codec",`${i} (${l})`);break}case"ABSS":{const i=await this.tokenizer.readToken(je),a=await this.tokenizer.readToken(se),l=await this.tokenizer.readToken(se),c=await this.tokenizer.readToken(Q);an(`ABSS ${i}:${a}:${l}.${c}`);break}case"LSCO":{const i=await this.tokenizer.readToken(je);an(`LSCO lsConfig=${i}`);break}default:an(`Unknown sound-property-chunk[ID=${n.chunkID}, size=${n.chunkSize}]`),await this.tokenizer.ignore(Number(n.chunkSize))}const s=n.chunkSize-BigInt(this.tokenizer.position-r);s>0&&(an(`After Parsing sound-property-chunk ${n.chunkSize}, remaining ${s} bytes`),await this.tokenizer.ignore(Number(s))),e-=BigInt(Xa.len)+n.chunkSize,an(`Parsing sound-property-chunks, remainingSize=${e}`)}if(this.metadata.format.lossless&&this.metadata.format.sampleRate&&this.metadata.format.numberOfChannels&&this.metadata.format.bitsPerSample){const n=this.metadata.format.sampleRate*this.metadata.format.numberOfChannels*this.metadata.format.bitsPerSample;this.metadata.setFormat("bitrate",n)}}async handleChannelChunks(e){an(`Parsing channel-chunks, remainingSize=${e}`);const n=[];for(;e>=He.len;){const r=await this.tokenizer.readToken(He);an(`Channel[ID=${r}]`),n.push(r),e-=BigInt(He.len)}return an(`Channels: ${n.join(", ")}`),n}}var T;(function(t){t[t.string=0]="string",t[t.uint=1]="uint",t[t.uid=2]="uid",t[t.bool=3]="bool",t[t.binary=4]="binary",t[t.float=5]="float"})(T||(T={}));const DX={name:"dtd",container:{440786851:{name:"ebml",container:{17030:{name:"ebmlVersion",value:T.uint},17143:{name:"ebmlReadVersion",value:T.uint},17138:{name:"ebmlMaxIDWidth",value:T.uint},17139:{name:"ebmlMaxSizeWidth",value:T.uint},17026:{name:"docType",value:T.string},17031:{name:"docTypeVersion",value:T.uint},17029:{name:"docTypeReadVersion",value:T.uint}}},408125543:{name:"segment",container:{290298740:{name:"seekHead",container:{19899:{name:"seek",multiple:!0,container:{21419:{name:"id",value:T.binary},21420:{name:"position",value:T.uint}}}}},357149030:{name:"info",container:{29604:{name:"uid",value:T.uid},29572:{name:"filename",value:T.string},3979555:{name:"prevUID",value:T.uid},3965867:{name:"prevFilename",value:T.string},4110627:{name:"nextUID",value:T.uid},4096955:{name:"nextFilename",value:T.string},2807729:{name:"timecodeScale",value:T.uint},17545:{name:"duration",value:T.float},17505:{name:"dateUTC",value:T.uint},31657:{name:"title",value:T.string},19840:{name:"muxingApp",value:T.string},22337:{name:"writingApp",value:T.string}}},524531317:{name:"cluster",multiple:!0,container:{231:{name:"timecode",value:T.uid},22743:{name:"silentTracks ",multiple:!0},167:{name:"position",value:T.uid},171:{name:"prevSize",value:T.uid},160:{name:"blockGroup"},163:{name:"simpleBlock"}}},374648427:{name:"tracks",container:{174:{name:"entries",multiple:!0,container:{215:{name:"trackNumber",value:T.uint},29637:{name:"uid",value:T.uid},131:{name:"trackType",value:T.uint},185:{name:"flagEnabled",value:T.bool},136:{name:"flagDefault",value:T.bool},21930:{name:"flagForced",value:T.bool},156:{name:"flagLacing",value:T.bool},28135:{name:"minCache",value:T.uint},28136:{name:"maxCache",value:T.uint},2352003:{name:"defaultDuration",value:T.uint},2306383:{name:"timecodeScale",value:T.float},21358:{name:"name",value:T.string},2274716:{name:"language",value:T.string},134:{name:"codecID",value:T.string},25506:{name:"codecPrivate",value:T.binary},2459272:{name:"codecName",value:T.string},3839639:{name:"codecSettings",value:T.string},3883072:{name:"codecInfoUrl",value:T.string},2536e3:{name:"codecDownloadUrl",value:T.string},170:{name:"codecDecodeAll",value:T.bool},28587:{name:"trackOverlay",value:T.uint},224:{name:"video",container:{154:{name:"flagInterlaced",value:T.bool},21432:{name:"stereoMode",value:T.uint},176:{name:"pixelWidth",value:T.uint},186:{name:"pixelHeight",value:T.uint},21680:{name:"displayWidth",value:T.uint},21690:{name:"displayHeight",value:T.uint},21683:{name:"aspectRatioType",value:T.uint},3061028:{name:"colourSpace",value:T.uint},3126563:{name:"gammaValue",value:T.float}}},225:{name:"audio",container:{181:{name:"samplingFrequency",value:T.float},30901:{name:"outputSamplingFrequency",value:T.float},159:{name:"channels",value:T.uint},148:{name:"channels",value:T.uint},32123:{name:"channelPositions",value:T.binary},25188:{name:"bitDepth",value:T.uint}}},28032:{name:"contentEncodings",container:{25152:{name:"contentEncoding",container:{20529:{name:"order",value:T.uint},20530:{name:"scope",value:T.bool},20531:{name:"type",value:T.uint},20532:{name:"contentEncoding",container:{16980:{name:"contentCompAlgo",value:T.uint},16981:{name:"contentCompSettings",value:T.binary}}},20533:{name:"contentEncoding",container:{18401:{name:"contentEncAlgo",value:T.uint},18402:{name:"contentEncKeyID",value:T.binary},18403:{name:"contentSignature ",value:T.binary},18404:{name:"ContentSigKeyID  ",value:T.binary},18405:{name:"contentSigAlgo ",value:T.uint},18406:{name:"contentSigHashAlgo ",value:T.uint}}},25188:{name:"bitDepth",value:T.uint}}}}}}}}},475249515:{name:"cues",container:{187:{name:"cuePoint",container:{179:{name:"cueTime",value:T.uid},183:{name:"positions",container:{247:{name:"track",value:T.uint},241:{name:"clusterPosition",value:T.uint},21368:{name:"blockNumber",value:T.uint},234:{name:"codecState",value:T.uint},219:{name:"reference",container:{150:{name:"time",value:T.uint},151:{name:"cluster",value:T.uint},21343:{name:"number",value:T.uint},235:{name:"codecState",value:T.uint}}},240:{name:"relativePosition",value:T.uint}}}}}}},423732329:{name:"attachments",container:{24999:{name:"attachedFiles",multiple:!0,container:{18046:{name:"description",value:T.string},18030:{name:"name",value:T.string},18016:{name:"mimeType",value:T.string},18012:{name:"data",value:T.binary},18094:{name:"uid",value:T.uid}}}}},272869232:{name:"chapters",container:{17849:{name:"editionEntry",container:{182:{name:"chapterAtom",container:{29636:{name:"uid",value:T.uid},145:{name:"timeStart",value:T.uint},146:{name:"timeEnd",value:T.uid},152:{name:"hidden",value:T.bool},17816:{name:"enabled",value:T.uid},143:{name:"track",container:{137:{name:"trackNumber",value:T.uid},128:{name:"display",container:{133:{name:"string",value:T.string},17276:{name:"language ",value:T.string},17278:{name:"country ",value:T.string}}}}}}}}}}},307544935:{name:"tags",container:{29555:{name:"tag",multiple:!0,container:{25536:{name:"target",container:{25541:{name:"tagTrackUID",value:T.uid},25540:{name:"tagChapterUID",value:T.uint},25542:{name:"tagAttachmentUID",value:T.uid},25546:{name:"targetType",value:T.string},26826:{name:"targetTypeValue",value:T.uint},25545:{name:"tagEditionUID",value:T.uid}}},26568:{name:"simpleTags",multiple:!0,container:{17827:{name:"name",value:T.string},17543:{name:"string",value:T.string},17541:{name:"binary",value:T.binary},17530:{name:"language",value:T.string},17531:{name:"languageIETF",value:T.string},17540:{name:"default",value:T.bool}}}}}}}}}}},Ya=De("music-metadata:parser:ebml");var kr;(function(t){t[t.ReadNext=0]="ReadNext",t[t.IgnoreElement=2]="IgnoreElement",t[t.SkipSiblings=3]="SkipSiblings",t[t.TerminateParsing=4]="TerminateParsing",t[t.SkipElement=5]="SkipElement"})(kr||(kr={}));class OX{constructor(e){this.tokenizer=e,this.padding=0,this.parserMap=new Map,this.ebmlMaxIDLength=4,this.ebmlMaxSizeLength=8,this.parserMap.set(T.uint,n=>this.readUint(n)),this.parserMap.set(T.string,n=>this.readString(n)),this.parserMap.set(T.binary,n=>this.readBuffer(n)),this.parserMap.set(T.uid,async n=>this.readBuffer(n)),this.parserMap.set(T.bool,n=>this.readFlag(n)),this.parserMap.set(T.float,n=>this.readFloat(n))}async iterate(e,n,r){return this.parseContainer(WN(e),n,r)}async parseContainer(e,n,r){const s={};for(;this.tokenizer.position<n;){let i;const a=this.tokenizer.position;try{i=await this.readElement()}catch(c){if(c instanceof ct)break;throw c}const l=e.container[i.id];if(l)switch(r.startNext(l)){case kr.ReadNext:if(i.id,Ya(`Read element: name=${ta(l)}{id=0x${i.id.toString(16)}, container=${!!l.container}} at position=${a}`),l.container){const u=await this.parseContainer(l,i.len>=0?this.tokenizer.position+i.len:-1,r);l.multiple?(s[l.name]||(s[l.name]=[]),s[l.name].push(u)):s[l.name]=u,await r.elementValue(l,u,a)}else{const u=this.parserMap.get(l.value);if(typeof u=="function"){const d=await u(i);s[l.name]=d,await r.elementValue(l,d,a)}}break;case kr.SkipElement:Ya(`Go to next element: name=${ta(l)}, element.id=0x${i.id}, container=${!!l.container} at position=${a}`);break;case kr.IgnoreElement:Ya(`Ignore element: name=${ta(l)}, element.id=0x${i.id}, container=${!!l.container} at position=${a}`),await this.tokenizer.ignore(i.len);break;case kr.SkipSiblings:Ya(`Ignore remaining container, at: name=${ta(l)}, element.id=0x${i.id}, container=${!!l.container} at position=${a}`),await this.tokenizer.ignore(n-this.tokenizer.position);break;case kr.TerminateParsing:return Ya(`Terminate parsing at element: name=${ta(l)}, element.id=0x${i.id}, container=${!!l.container} at position=${a}`),s}else switch(i.id){case 236:this.padding+=i.len,await this.tokenizer.ignore(i.len);break;default:Ya(`parseEbml: parent=${ta(e)}, unknown child: id=${i.id.toString(16)} at position=${a}`),this.padding+=i.len,await this.tokenizer.ignore(i.len)}}return s}async readVintData(e){const n=await this.tokenizer.peekNumber(se);let r=128,s=1;for(;!(n&r);){if(s>e)throw new Error("VINT value exceeding maximum size");++s,r>>=1}const i=new Uint8Array(s);return await this.tokenizer.readBuffer(i),i}async readElement(){const e=await this.readVintData(this.ebmlMaxIDLength),n=await this.readVintData(this.ebmlMaxSizeLength);return n[0]^=128>>n.length-1,{id:qg(e,e.length),len:qg(n,n.length)}}async readFloat(e){switch(e.len){case 0:return 0;case 4:return this.tokenizer.readNumber(CN);case 8:return this.tokenizer.readNumber(Vy);case 10:return this.tokenizer.readNumber(Vy);default:throw new Error(`Invalid IEEE-754 float length: ${e.len}`)}}async readFlag(e){return await this.readUint(e)===1}async readUint(e){const n=await this.readBuffer(e);return qg(n,e.len)}async readString(e){return(await this.tokenizer.readToken(new G(e.len,"utf-8"))).replace(/\x00.*$/g,"")}async readBuffer(e){const n=new Uint8Array(e.len);return await this.tokenizer.readBuffer(n),n}}function qg(t,e){return Number(MX(t,e))}function MX(t,e){const n=new Uint8Array(8),r=t.subarray(0,e);try{return n.set(r,8-e),E1.get(n,0)}catch{return BigInt(-1)}}function WN(t){return t.container&&Object.keys(t.container).map(e=>{const n=t.container[e];return n.id=Number.parseInt(e),n}).forEach(e=>{e.parent=t,WN(e)}),t}function ta(t){let e="";return t.parent&&t.parent.name!=="dtd"&&(e+=`${ta(t.parent)}/`),e+t.name}const jd=De("music-metadata:parser:matroska");class LX extends Yn{constructor(){super(...arguments),this.seekHeadOffset=0,this.flagUseIndexToSkipClusters=!1}init(e,n,r){return super.init(e,n,r),this.flagUseIndexToSkipClusters=r.mkvUseIndex??!1,this}async parse(){const e=this.tokenizer.fileInfo.size??Number.MAX_SAFE_INTEGER,n=new OX(this.tokenizer);jd("Initializing DTD end MatroskaIterator"),await n.iterate(DX,e,{startNext:r=>{switch(r.id){case 475249515:return jd(`Skip element: name=${r.name}, id=0x${r.id.toString(16)}`),kr.IgnoreElement;case 524531317:if(this.flagUseIndexToSkipClusters&&this.seekHead){const s=this.seekHead.seek.find(i=>i.position+this.seekHeadOffset>this.tokenizer.position);if(s){const i=s.position+this.seekHeadOffset-this.tokenizer.position;return jd(`Use index to go to next position, ignoring ${i} bytes`),this.tokenizer.ignore(i),kr.SkipElement}}return kr.IgnoreElement;default:return kr.ReadNext}},elementValue:async(r,s,i)=>{switch(jd(`Received: name=${r.name}, value=${s}`),r.id){case 17026:this.metadata.setFormat("container",`EBML/${s}`);break;case 290298740:this.seekHead=s,this.seekHeadOffset=i;break;case 357149030:{const a=s,l=a.timecodeScale?a.timecodeScale:1e6;if(typeof a.duration=="number"){const c=a.duration*l/1e9;await this.addTag("segment:title",a.title),this.metadata.setFormat("duration",Number(c))}}break;case 374648427:{const a=s;if(a!=null&&a.entries){a.entries.forEach(c=>{const u={codecName:c.codecID.replace("A_","").replace("V_",""),codecSettings:c.codecSettings,flagDefault:c.flagDefault,flagLacing:c.flagLacing,flagEnabled:c.flagEnabled,language:c.language,name:c.name,type:c.trackType,audio:c.audio,video:c.video};this.metadata.addStreamInfo(u)});const l=a.entries.filter(c=>c.trackType===Ca.audio).reduce((c,u)=>!c||u.flagDefault&&!c.flagDefault||u.trackNumber<c.trackNumber?u:c,null);l&&(this.metadata.setFormat("codec",l.codecID.replace("A_","")),this.metadata.setFormat("sampleRate",l.audio.samplingFrequency),this.metadata.setFormat("numberOfChannels",l.audio.channels))}}break;case 307544935:{const a=s;await Promise.all(a.tag.map(async l=>{const c=l.target,u=c!=null&&c.targetTypeValue?Wy[c.targetTypeValue]:c!=null&&c.targetType?c.targetType:"track";await Promise.all(l.simpleTags.map(async d=>{const h=d.string?d.string:d.binary;await this.addTag(`${u}:${d.name}`,h)}))}))}break;case 423732329:{const a=s;await Promise.all(a.attachedFiles.filter(l=>l.mimeType.startsWith("image/")).map(l=>this.addTag("picture",{data:l.data,format:l.mimeType,description:l.description,name:l.name})))}break}}})}async addTag(e,n){await this.metadata.addTag("matroska",e,n)}}const wf=De("music-metadata:parser:factory");function $X(t){const e=T1.parse(t),n=MQ(e.type);return{type:n.type,subtype:n.subtype,suffix:n.suffix,parameters:e.parameters}}async function zX(t,e){const{mimeType:n,path:r,url:s}=t.fileInfo,i=qN(n)||tx(r)||tx(s);return i||wf(`No parser found for MIME-type / extension: ${n}`),BX(t,i,e)}async function BX(t,e,n){if(!e){wf("Guess parser on content...");const i=new Uint8Array(4100);if(await t.peekBuffer(i,{mayBeLess:!0}),t.fileInfo.path&&(e=tx(t.fileInfo.path)),!e){const a=await PN(i);if(!a)throw new Error("Failed to determine audio format");if(wf(`Guessed file type is mime=${a.mime}, extension=${a.ext}`),e=qN(a.mime),!e)throw new Error(`Guessed MIME-type not supported: ${a.mime}`)}}const r=await UX(e),s=new gK(n);return await r.init(s,t,n??{}).parse(),s.toCommonMetadata()}function tx(t){if(!t)return;switch(VX(t).toLocaleLowerCase()||t){case".mp2":case".mp3":case".m2a":case".aac":return"mpeg";case".ape":return"apev2";case".mp4":case".m4a":case".m4b":case".m4pa":case".m4v":case".m4r":case".3gp":return"mp4";case".wma":case".wmv":case".asf":return"asf";case".flac":return"flac";case".ogg":case".ogv":case".oga":case".ogm":case".ogx":case".opus":case".spx":return"ogg";case".aif":case".aiff":case".aifc":return"aiff";case".wav":case".bwf":return"riff";case".wv":case".wvp":return"wavpack";case".mpc":return"musepack";case".dsf":return"dsf";case".dff":return"dsdiff";case".mka":case".mkv":case".mk3d":case".mks":case".webm":return"matroska"}}async function UX(t){switch(t){case"aiff":return new EK;case"adts":case"mpeg":return new cX;case"apev2":return new qr;case"asf":return new DK;case"dsf":return new PX;case"dsdiff":return new FX;case"flac":return new LK;case"mp4":return new xf;case"musepack":return new yX;case"ogg":return new xp;case"riff":return new CX;case"wavpack":return new AX;case"matroska":return new LX;default:throw new Error(`Unknown parser type: ${t}`)}}function VX(t){const e=t.lastIndexOf(".");return e===-1?"":t.slice(e)}function qN(t){let e;if(!t)return;try{e=$X(t)}catch{wf(`Invalid HTTP Content-Type header value: ${t}`);return}const n=e.subtype.indexOf("x-")===0?e.subtype.substring(2):e.subtype;switch(e.type){case"audio":switch(n){case"mp3":case"mpeg":return"mpeg";case"aac":case"aacp":return"adts";case"flac":return"flac";case"ape":case"monkeys-audio":return"apev2";case"mp4":case"m4a":return"mp4";case"ogg":case"opus":case"speex":return"ogg";case"ms-wma":case"ms-wmv":case"ms-asf":return"asf";case"aiff":case"aif":case"aifc":return"aiff";case"vnd.wave":case"wav":case"wave":return"riff";case"wavpack":return"wavpack";case"musepack":return"musepack";case"matroska":case"webm":return"matroska";case"dsf":return"dsf"}break;case"video":switch(n){case"ms-asf":case"ms-wmv":return"asf";case"m4v":case"mp4":return"mp4";case"ogg":return"ogg";case"matroska":case"webm":return"matroska"}break;case"application":switch(n){case"vnd.ms-asf":return"asf";case"ogg":return"ogg"}break}}async function HX(t,e={}){const n={mimeType:t.type,size:t.size};return t instanceof File&&(n.path=t.name),WX(t.stream(),n,e)}function WX(t,e,n={}){return qX(TN(t,{fileInfo:typeof e=="string"?{mimeType:e}:e}),n)}function qX(t,e){return zX(t,e)}const GN=async t=>{var l;if(!t)return;const e=await HX(t);if(!e)return;const{common:{title:n,artist:r,picture:s},format:{duration:i}}=e;return Object.assign({},{name:n||t.name,singer:r||"...",duration:i||0,image:s?(l=s[0])==null?void 0:l.data:[]})};function GX(t){const{setErrorToast:e,setSuccessToast:n}=oe(),{songFile:r,imageFile:s,setSong:i,setImageFile:a,updateSongData:l,setSongData:c,resetAddSongContext:u,songData:d,singers:h,song:m,genres:p,setGenres:g,setSingers:y,imageBlob:_,setImageBlob:w,...x}=Ua(),[v,S]=f.useState(!1),E=f.useRef(null),b=f.useMemo(()=>t.variant==="add"?!0:!m||!d?!1:d.name!==m.name||h.length!==m.singers.length||d.like!==m.like||p.length!==m.genres.length,[d,m,h,p]),I=!!s,A=f.useMemo(()=>{const ie=!!(d!=null&&d.name)&&!!h.length&&!!p.length&&b;return t.variant==="add"?ie:ie||I},[I,b,h,p,d]),L=()=>{switch(t.variant){case"add":return By({owner_email:t.ownerEmail,distributor:t.distributor,is_official:!0});case"edit":const{id:ie,updated_at:ke,...me}=t.song;return y(me.singers),g(me.genres),By(me)}},P=()=>{var ie,ke;switch(t.variant){case"add":(ie=E.current)==null||ie.close(),setTimeout(()=>u(L()),500);break;case"edit":(ke=E.current)==null||ke.close()}},ce=async()=>{if(!r)return;const ie=await GN(r);if(ie){const ke={name:ie.name,duration:Math.floor(ie.duration),size:Math.floor(r.size/1024),image_url:""};if(ie.image){const me=new Blob([ie.image]);w(me),ke.image_url=URL.createObjectURL(me)}l(ke)}},K=()=>{const ie={},ke={};return p.forEach(me=>ie[me.id]=!0),h.forEach(me=>ke[me.id]=!0),{genre_map:ie,singer_map:ke}},Pe=async()=>{var ie,ke;try{if(!A||!d)return;const me={...d};if(S(!0),s||_){const Ge=await Hi({imageFile:s,blob:_});t.variant==="edit"&&(m!=null&&m.image_file_path)&&$n({filePath:m.image_file_path,msg:">>> api: Delete image file"}),Object.assign(me,Ge)}switch(t.variant){case"add":{if(!r)return;const{filePath:Ge,fileURL:F}=await c1({file:r,folder:"/songs/",msg:">>> api: upload song file",namePrefix:"song"}),W={singers:h,genres:p,song_url:F,song_file_path:Ge,...K()};Object.assign(me,W),await Vi({collectionName:"Songs",data:me,msg:">>> api: set song doc"}),n(),(ie=E.current)==null||ie.open();break}case"edit":{if(!m)return;if(b){const Ge={singers:h,genres:p,...K()};Object.assign(me,Ge)}m&&i({...m,...me}),a(void 0),await Qt({collectionName:"Songs",id:m.id,data:me}),n(),(ke=E.current)==null||ke.open()}}}catch(me){console.log(me),e()}finally{S(!1)}};return f.useEffect(()=>{c(L())},[]),f.useEffect(()=>{r&&ce()},[r]),f.useEffect(()=>{s&&l({image_url:URL.createObjectURL(s)})},[s]),{isValidToSubmit:A,handleSubmit:Pe,isFetching:v,updateSongData:l,songFile:r,songData:d,genres:p,singers:h,modalRef:E,handleCloseModalAfterFinished:P,...x}}function QX({handleCloseModal:t,variant:e}){return o.jsxs(Xn,{children:[o.jsx(xe,{title:"Finished"}),o.jsx(ht,{width:"w-[120px]",className:"mx-auto w-[120px]",src:"https://zalo-api.zadn.vn/api/emoticon/sticker/webpc?eid=46985&size=130"}),o.jsxs("div",{className:"flex justify-center mt-5 space-x-2",children:[o.jsxs(le,{href:"/dashboard/song",children:[o.jsx(xI,{className:"w-6"}),o.jsx("span",{children:"Songs"})]}),o.jsxs(le,{onClick:t,children:[o.jsx(ls,{className:"w-6"}),o.jsx("span",{children:e==="add"?"Add more":"Ok"})]})]})]})}function KX(){const{setImageFile:t,songData:e,updateSongData:n,imageBlob:r,setImageBlob:s}=Ua(),i=f.useRef(null),a=f.useRef(null),l=u=>{var d;(d=u.target.files)!=null&&d.length&&t(u.target.files[0])},c=()=>{e&&(s(void 0),URL.revokeObjectURL(e.image_url),n({image_url:""}))};return o.jsxs(o.Fragment,{children:[o.jsx(le,{className:"",size:"clear",children:o.jsx("label",{htmlFor:"image_upload",className:"inline-flex py-1.5 space-x-1 cursor-pointer px-5 ",children:o.jsx(ol,{className:"w-6"})})}),r&&o.jsx(le,{onClick:c,className:"h-[36px] justify-center w-[36px]",size:"clear",children:o.jsx(Mi,{className:"w-6"})}),(e==null?void 0:e.image_url)&&o.jsx(le,{onClick:()=>{var u;return(u=a.current)==null?void 0:u.open()},className:"h-[36px] justify-center w-[36px]",size:"clear",children:o.jsx(EI,{className:"w-6"})}),o.jsx("input",{ref:i,onChange:l,type:"file",multiple:!0,accept:"image/png, image/jpeg",id:"image_upload",className:"hidden"}),(e==null?void 0:e.image_url)&&o.jsxs(Ee,{variant:"animation",ref:a,children:[o.jsxs("p",{children:["Url: ",e==null?void 0:e.image_url]}),o.jsxs("p",{children:["Hash: ",e==null?void 0:e.blurhash_encode]})]})]})}function XX(){const t=f.useRef(null),{songData:e,updateSongData:n}=Ua(),[r,s]=f.useState({name:e==null?void 0:e.name,like:e==null?void 0:e.like}),i=l=>{s(c=>({...c,...l}))},a=()=>{var l;n(r),(l=t.current)==null||l.close()};return o.jsxs(o.Fragment,{children:[o.jsx(le,{onClick:()=>{var l;return(l=t.current)==null?void 0:l.open()},className:"h-[36px] justify-center w-[36px]",size:"clear",children:o.jsx(Oa,{className:"w-5"})}),o.jsx(Ee,{variant:"animation",wrapped:!1,ref:t,children:o.jsxs(Xn,{children:[o.jsx($t,{title:"Edit song",close:()=>{var l;return(l=t.current)==null?void 0:l.close()}}),o.jsxs("div",{children:[o.jsx("p",{children:"Name:"}),o.jsx(cr,{className:"bg-black/10",value:r==null?void 0:r.name,onChange:l=>i({name:l.target.value})})]}),o.jsxs("div",{className:"t",children:[o.jsx("p",{children:"Like:"}),o.jsx(cr,{className:"bg-black/10",value:r==null?void 0:r.like,onChange:l=>isNaN(+l.target.value)?{}:i({like:+l.target.value})})]}),o.jsx("p",{className:"mt-5 text-right",children:o.jsx(le,{onClick:a,children:"Ok"})})]})})]})}function QN(t){const{isFetching:e,handleSubmit:n,updateSongData:r,songData:s,isValidToSubmit:i,songFile:a,modalRef:l,handleCloseModalAfterFinished:c}=GX(t),u=f.useRef(null);return t.variant==="add"&&!a?o.jsx(ur,{children:o.jsx(vN,{})}):o.jsxs("div",{className:"w-full md:max-w-[800px] md:mx-auto",children:[o.jsx("audio",{ref:u,src:t.variant==="add"?URL.createObjectURL(a):(s==null?void 0:s.song_url)||"",className:"hidden"}),s&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"md:flex md:space-x-5",children:[o.jsxs("div",{className:"flex flex-col items-center md:block space-y-2.5",children:[o.jsx("div",{className:"w-[200px] h-[200px] bg-black/5 rounded-lg overflow-hidden",children:o.jsx(ht,{className:"object-cover h-full",blurHashEncode:s.blurhash_encode,src:s.image_url})}),t.variant==="edit"&&o.jsxs("div",{className:"w-full",children:[o.jsx(xe,{title:s.name}),o.jsxs(kn,{className:"[&>*]:text-sm ",children:[o.jsxs("p",{children:["Duration: ",ki(s.duration)]}),o.jsxs("p",{children:["Size: ",s.size," kb"]}),o.jsxs("p",{children:["Like: ",s.like]})]})]}),o.jsxs("div",{className:"space-x-2 flex w-full",children:[o.jsx(KX,{}),t.variant==="edit"&&o.jsx(XX,{})]})]}),o.jsxs("div",{className:"mt-5 md:mt-0 space-y-3 flex-grow",children:[u.current&&o.jsx(WG,{variant:t.variant,audioEle:u.current}),t.variant==="add"&&o.jsx(kn,{children:o.jsxs("span",{children:["Duration: ",ki(s.duration)," , Size: ",s.size,"kb"]})}),t.variant==="add"&&o.jsxs("div",{className:"",children:[o.jsx(xe,{title:"Name"}),o.jsx(cr,{value:s.name,onChange:d=>r({name:d.target.value})})]}),o.jsx(HG,{}),o.jsx(GG,{})]})]}),o.jsx("p",{className:"text-center mt-5",children:o.jsxs(le,{onClick:n,disabled:!i,loading:e,children:[o.jsx(yv,{className:"w-6"}),o.jsx("span",{children:"Ok"})]})}),o.jsx(Ee,{persisted:t.variant==="add",ref:l,wrapped:!1,variant:"animation",children:o.jsx(QX,{variant:t.variant,handleCloseModal:c})})]})]})}function YX(){const{user:t}=fe();if(t)return o.jsxs("div",{className:"pb-[46px]",children:[o.jsx(xe,{className:"mb-5",title:"Add Song"}),o.jsx(QN,{distributor:t.display_name,ownerEmail:t.email,variant:"add"})]})}function JX(){const[t,e]=f.useState(!0),[n,r]=f.useState(),s=f.useRef(!1),i=nn(),{setErrorToast:a}=oe();return{song:n,isFetching:t,getSong:async c=>{try{const u=await ss({collectionName:"Songs",id:c});if(!u.exists())return i("/dashboard/song");const d={...u.data(),id:u.id,queue_id:""};r(d)}catch(u){console.log(u),a()}finally{e(!1)}},ranEffect:s}}function ZX(){const{getSong:t,isFetching:e,song:n,ranEffect:r}=JX(),{variant:s,setSong:i}=Ua(),a=Fa();return f.useEffect(()=>{if(!r.current){if(s.current="edit",r.current=!0,!a.songId)return;t(a.songId)}},[]),f.useEffect(()=>{n&&i(n)},[n]),e?o.jsx(ur,{children:o.jsx(Hu,{})}):n?o.jsxs("div",{className:"pb-[46px]",children:[o.jsx(xe,{className:"mb-5",title:"Edit Song"}),o.jsx(QN,{song:n,variant:"edit"})]}):o.jsx(o.Fragment,{})}const eY=["All","Result"];function tY(){const{setPlaylists:t,playlists:e}=Cn(),[n,r]=f.useState(""),[s,i]=f.useState(!0),[a,l]=f.useState("All"),{setErrorToast:c}=oe(),u=async h=>{try{h.preventDefault(),i(!0);const m=_e(jr,V("is_official","==",!0),V("is_album","==",!1),V("name",">=",n),V("name","<=",n+"")),p=await is(m);t(p),l("Result")}catch(m){console.log({message:m}),c()}finally{i(!1)}},d=async()=>{try{i(!0);const h=_e(jr,V("is_official","==",!0),V("is_album","==",!1),Ni("updated_at","desc")),m=await is(h);t(m)}catch(h){console.log({message:h}),c()}finally{i(!1)}};return f.useEffect(()=>{a==="All"&&d()},[a]),{isFetching:s,value:n,setValue:r,handleSubmit:u,playlists:e,tab:a,setTab:l,tabs:eY}}function nY(){const{user:t}=fe(),{handleAddPlaylist:e,isFetching:n}=Yj(),r=f.useRef(null),s=()=>{var a;return(a=r.current)==null?void 0:a.close()},i=async(a,l)=>{a.is_official=!0,await e(a,l),s()};if(t)return o.jsxs(o.Fragment,{children:[o.jsxs(le,{onClick:()=>{var a;return(a=r.current)==null?void 0:a.open()},className:"h-[32px] space-x-1 px-2.5 ml-5",size:"clear",children:[o.jsx(cs,{className:"w-6"}),o.jsx("div",{className:"hidden md:block",children:"Add new playlist"})]}),o.jsx(Ee,{ref:r,variant:"animation",children:o.jsx(wl,{close:s,isLoading:n,variant:"add",user:t,submit:i})})]})}function rY(){const{isFetching:t,playlists:e,tab:n,tabs:r,setTab:s,...i}=tY();return o.jsxs("div",{className:"pb-[46px]",children:[o.jsx(xe,{title:"Playlists"}),o.jsxs("div",{className:"flex justify-between mt-3",children:[o.jsx(_l,{...i}),o.jsx(nY,{})]}),o.jsx("div",{className:`mt-5 w-fit ${n==="All"?"pointer-events-none":""} self-start`,children:o.jsx(us,{tabs:r,render:a=>a,tab:n,setTab:s})}),o.jsxs("div",{className:"mt-3",children:[t&&o.jsx(te,{className:"h-[200px] rounded-xl"}),!t&&o.jsx(Wi,{colList:["Name","Played","Songs",""],children:e.length?e.map((a,l)=>o.jsxs("tr",{children:[o.jsx("td",{children:o.jsx(we,{className:"hover:underline",to:`/dashboard/playlist/${a.id}`,children:a.name})}),o.jsx("td",{children:"-"}),o.jsx("td",{children:"-"}),o.jsx("td",{children:"-"})]},l)):o.jsx("tr",{children:o.jsx("td",{colSpan:4,children:o.jsx(Xe,{})})})})]})]})}function sY(){const[t,e]=f.useState([]),[n,r]=f.useState(""),[s,i]=f.useState(!1),{setErrorToast:a}=oe();return{isFetching:s,value:n,songs:t,setValue:r,handleSubmit:async c=>{try{c.preventDefault(),i(!0);const u=_e(Tn,V("name",">=",n),V("name","<=",n+""),V("is_official","==",!0)),d=await In(u);e(d)}catch(u){console.log({message:u}),a()}finally{i(!1)}}}}function iY({closeModal:t,submit:e,isLoading:n}){const{theme:r}=O(),{songs:s,isFetching:i,...a}=sY(),{selectedSongs:l,selectSong:c}=il(),u=async()=>{l.length&&(e(l),t())},d=f.useMemo(()=>{const m=l.map(p=>p.id);return s.filter(p=>!m.includes(p.id))},[s,l]),h={col:"w-1/2 flex flex-col px-2",box:"rounded-lg bg-black/10 overflow-hidden p-2",songItem:"rounded-md w-full p-1 text-left"};return o.jsxs(o.Fragment,{children:[o.jsx($t,{close:t,title:"Add song to playist"}),o.jsxs("div",{className:"flex-grow flex flex-col md:flex-row md:-mx-3 overflow-hidden",children:[o.jsxs("div",{className:`${h.col}`,children:[o.jsx(_l,{...a}),o.jsx("div",{className:`${h.box} flex-grow mt-3`,children:o.jsx("div",{className:"h-full overflow-auto space-y-2",children:i?o.jsx(Hu,{className:"h-full"}):d.map((m,p)=>o.jsx("button",{onClick:()=>c(m),className:`${h.songItem} bg-black/10 ${r.content_hover_bg}`,children:o.jsx("h5",{className:"",children:m.name})},p))})})]}),o.jsxs("div",{className:h.col,children:[o.jsx("div",{className:"h-[70px] font-[500]",children:"Selected:"}),o.jsx("div",{className:`${h.box} flex-grow mt-3 space-y-2`,children:l.map((m,p)=>o.jsx("button",{onClick:()=>c(m),className:`${h.songItem} ${r.content_bg} hover:brightness-95`,children:o.jsx("h5",{className:"",children:m.name})},p))})]})]}),o.jsx("p",{className:"text-right mt-3",children:o.jsxs(le,{disabled:!l.length,loading:n,onClick:u,children:[o.jsx(pu,{className:"w-6"}),o.jsx("span",{children:"Add"})]})})]})}function KN(t){return o.jsx(Nr,{children:o.jsx(iY,{...t})})}function aY(){const[t,e]=f.useState(""),n=f.useRef(null),{action:r,playlist:s,isFetching:i}=v1(),a=h=>{var m,p;e(h),t==="add-song-to-playlist"&&((m=n.current)==null||m.setModalPersist(!0)),(p=n.current)==null||p.open()},l=()=>{var h;return(h=n.current)==null?void 0:h.close()},c=async h=>{await r(h),l()},u=()=>{switch(t){case"":return o.jsx(o.Fragment,{});case"edit":return s?o.jsx(o.Fragment,{children:o.jsx(wl,{submit:(h,m)=>c({variant:"edit-playlist",playlist:h,imageFile:m}),variant:"edit",isLoading:i,playlist:s,close:l})}):"Playlist is undefined";case"delete":return o.jsx(Li,{loading:i,label:"Delete playlist ?",callback:()=>c({variant:"delete-playlist"}),close:l});case"add-song-to-playlist":return o.jsx(KN,{isLoading:i,submit:h=>c({variant:"add-songs",songs:h}),closeModal:l})}},d={button:"p-1.5"};return o.jsxs("div",{className:"space-x-2",children:[o.jsx(le,{onClick:()=>a("edit"),size:"clear",className:`${d.button} `,children:o.jsx(Oa,{className:"w-5"})}),o.jsx(le,{onClick:()=>a("delete"),size:"clear",className:`${d.button} `,children:o.jsx(Gn,{className:"w-5"})}),o.jsxs(le,{onClick:()=>a("add-song-to-playlist"),size:"clear",className:`${d.button} `,children:[o.jsx(bW,{className:"w-5"}),o.jsx("span",{children:"Add song"})]}),o.jsx(Ee,{wrapped:!1,variant:"animation",ref:n,children:o.jsx(Xn,{className:"w-[unset]",children:u()})})]})}function oY(){const[t,e]=f.useState(!0),{setSongs:n,setPlaylist:r,playlist:s,songs:i}=mN(),a=f.useRef(!1),l=Fa(),c=nn(),{setErrorToast:u}=oe(),d=async()=>{try{if(!l.id)return;const h=await ss({collectionName:"Playlists",id:l.id});if(!h.exists())return c("/dashboard/playlist");const m={...h.data(),id:h.id};if(m.song_ids.length){const p=_e(Tn,V(Bs(),"in",m.song_ids)),g=await In(p);n(g)}r(m)}catch(h){console.log(h),u()}finally{e(!1)}};return f.useEffect(()=>{a.current||(a.current=!0,d())},[]),{songs:i,playlist:s,isFetching:t}}function lY({singer:t}){const{action:e}=v1();return o.jsxs(o.Fragment,{children:[o.jsx(we,{className:"hover:underline",to:`/dashboard/singer/${t.id}`,children:t.name}),o.jsx("div",{children:o.jsx("button",{onClick:()=>e({variant:"remove-singer",singer:t}),children:o.jsx(Gn,{className:"w-5"})})})]})}function cY(){const{isFetching:t,songs:e,playlist:n}=oY(),r=f.useMemo(()=>e.reduce((s,i)=>s+i.duration,0),[e]);return t?o.jsx(ur,{children:o.jsx(Hu,{})}):n?o.jsxs("div",{className:"pb-[46px]",children:[o.jsx(xe,{title:"Edit playlist",className:"mb-3"}),o.jsxs("div",{className:"md:flex md:-mx-3",children:[o.jsxs("div",{className:"space-y-2.5 md:px-3",children:[o.jsx("div",{className:"w-[200px] h-[200px] mx-auto",children:o.jsx(gu,{children:o.jsx(ht,{className:"object-cover h-full",blurHashEncode:n.blurhash_encode,src:n.image_url})})}),o.jsxs("div",{children:[o.jsx(xe,{title:n.name}),o.jsxs(kn,{className:"mt-1",children:[o.jsx("p",{children:n.is_public?"Public":"Private"}),o.jsxs("p",{children:[e.length," songs - ",ki(r)]}),o.jsxs("p",{children:[n.like," likes"]})]})]}),o.jsx(aY,{})]}),o.jsxs("div",{className:"w-full mt-3 md:mt-0 md:w-3/4 md:px-3",children:[o.jsx(xe,{title:"Singers"}),o.jsx(kn,{className:"mt-1",children:n.singers.length?o.jsx("div",{className:"-mt-2 -ml-2 flex ",children:n.singers.map((s,i)=>o.jsx(Wu,{children:o.jsx(lY,{singer:s})},i))}):o.jsx(Xe,{})}),o.jsx(xe,{title:"Songs",className:"mt-3"}),o.jsx(kn,{className:"mt-1",children:o.jsx("div",{className:"overflow-hidden",children:o.jsx(PI,{className:"[&_td]:text-sm [&_tbody>tr]:border-t [&_tr]:border-black/10 [&_th]:text-sm [&_th]:text-left [&_td]:p-2 [&_th]:p-2 hover:[&_tr:not(div.absolute)]:bg-black/5",colList:["Name","Singer",""],children:e.length?e.map((s,i)=>o.jsx(gN,{variant:"playlist",song:s},i)):o.jsx("tr",{children:o.jsx("td",{colSpan:3,children:o.jsx(Xe,{})})})})})})]})]})]}):o.jsx(o.Fragment,{})}function uY(t){const{setErrorToast:e,setSuccessToast:n}=oe(),{singer:r,setSinger:s,setSingers:i}=Oi(),[a,l]=f.useState(),[c,u]=f.useState(),[d,h]=f.useState(!1),m=f.useRef(null),p=v=>{a&&l({...a,...v})},g=f.useMemo(()=>t.variant==="add"?!0:!r||!a?!1:a.name!==r.name||a.description!==r.description,[a]),y=!!c,_=f.useMemo(()=>{const v=!!(a!=null&&a.name)&&g;return t.variant==="add"?v:v||y},[y,g,a]),w=async()=>{try{if(!_||!a)return;h(!0);const v={...a};if(c){const S=await Hi({imageFile:c});Object.assign(v,S)}switch(t.variant){case"add":{const S=await Vi({collectionName:"Singers",data:v}),E={...a,id:S.id};i(b=>[E,...b]),n("Add singer successful");break}case"edit":{if(!r)return;await Qt({collectionName:"Singers",id:r.id,data:v}),s({...r,...v}),n("Edit singer successful")}}}catch(v){console.log(v),e()}finally{h(!1),t.closeModal()}},x=()=>{switch(t.variant){case"add":return cf({});case"edit":if(!r)throw new Error("");const{id:v,...S}=r;return cf(S)}};return f.useEffect(()=>{var v;t.variant==="add"&&((v=m.current)==null||v.focus()),l(x())},[]),f.useEffect(()=>{c&&p({image_url:URL.createObjectURL(c)})},[c]),f.useEffect(()=>{var v;(v=m.current)==null||v.focus()},[]),{singerData:a,imageFile:c,setImageFile:u,updateSingerData:p,setSingerData:l,inputRef:m,handleSubmit:w,isFetching:d,isValidToSubmit:_}}function XN(t){const{theme:e}=O(),{setImageFile:n,singerData:r,handleSubmit:s,isFetching:i,isValidToSubmit:a,updateSingerData:l,inputRef:c}=uY(t),u=d=>{var h;(h=d.target.files)!=null&&h.length&&n(d.target.files[0])};if(r)return o.jsxs("div",{className:"w-[700px]",children:[o.jsx($t,{close:t.closeModal,title:t.variant==="add"?"Add singer":"Edit singer"}),o.jsxs("div",{className:"flex space-x-3",children:[o.jsxs("div",{className:"space-y-2.5",children:[o.jsx("div",{className:"w-[200px] h-[200px] rounded-lg overflow-hidden",children:o.jsx(ht,{className:"object-cover object-center h-full",blurHashEncode:r.blurhash_encode,src:r.image_url})}),o.jsx("input",{onChange:u,type:"file",multiple:!0,accept:"image/png, image/jpeg, image/webp",id:"image_upload",className:"hidden"}),o.jsx("div",{className:"space-x-2 flex",children:o.jsx(le,{className:`${e.content_bg}`,size:"clear",children:o.jsx("label",{htmlFor:"image_upload",className:"px-5 py-1 cursor-pointer ",children:o.jsx(ol,{className:"w-5"})})})})]}),o.jsxs("div",{className:"flex-grow flex flex-col space-y-2.5",children:[o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{htmlFor:"name",className:"opacity-[.8]",children:"Name:"}),o.jsx(cr,{ref:c,type:"text",id:"name",placeholder:"",className:"bg-[#f1f1f1]",value:r.name,onChange:d=>l({name:d.target.value})})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{htmlFor:"description",className:"opacity-[.8]",children:"Description:"}),o.jsx("textarea",{placeholder:"...",id:"description",className:`${Sv} w-full bg-[#f1f1f1] rounded-md min-h-[100px]`,value:r.description,onChange:d=>l({description:d.target.value})})]})]})]}),o.jsx("p",{className:"text-right mt-3",children:o.jsx(le,{loading:i,color:"primary",onClick:s,disabled:!a,className:"font-playwriteCU rounded-full",children:"Save"})})]})}function dY(){const t=f.useRef(null),e=()=>{var n;return(n=t.current)==null?void 0:n.close()};return o.jsxs(o.Fragment,{children:[o.jsxs(le,{onClick:()=>{var n;return(n=t.current)==null?void 0:n.open()},className:"h-[32px]  space-x-1 px-2.5 ml-5",size:"clear",children:[o.jsx(cs,{className:"w-6"}),o.jsx("div",{className:"hidden md:block",children:"Add new singer"})]}),o.jsx(Ee,{wrapped:!1,ref:t,variant:"animation",children:o.jsx(Xn,{className:"w-[unset]",children:o.jsx(XN,{closeModal:e,variant:"add"})})})]})}const hY=["All","Result"];function fY(){const{setSingers:t,singers:e}=Oi(),[n,r]=f.useState(""),[s,i]=f.useState(!0),[a,l]=f.useState("All"),{setErrorToast:c}=oe(),u=async h=>{try{h.preventDefault(),i(!0);const m=_e(of,V("name",">=",n),V("name","<=",n+"")),p=await lf(m);t(p),l("Result")}catch(m){console.log({message:m}),c()}finally{i(!1)}},d=async()=>{try{i(!0);const h=_e(of,Ni("created_at","desc")),m=await lf(h);t(m)}catch(h){console.log({message:h}),c()}finally{i(!1)}};return f.useEffect(()=>{a==="All"&&d()},[a]),{isFetching:s,value:n,setValue:r,handleSubmit:u,singers:e,tab:a,setTab:l,tabs:hY}}function mY(){const{isFetching:t,singers:e,tabs:n,tab:r,setTab:s,...i}=fY();return o.jsxs("div",{className:"pb-[46px]",children:[o.jsx(xe,{title:"Singer"}),o.jsxs("div",{className:"flex justify-between mt-3",children:[o.jsx(_l,{...i}),o.jsx(dY,{})]}),o.jsx("div",{className:`mt-5 w-fit ${r==="All"?"pointer-events-none":""} self-start`,children:o.jsx(us,{tabs:n,render:a=>a,tab:r,setTab:s})}),o.jsxs("div",{className:"mt-3",children:[t&&o.jsx(te,{className:"h-[200px] rounded-xl"}),!t&&o.jsx(Wi,{colList:["Name",""],children:e.length?e.map((a,l)=>o.jsxs("tr",{children:[o.jsx("td",{children:o.jsx(we,{className:"hover:underline",to:`/dashboard/singer/${a.id}`,children:a.name})}),o.jsx("td",{children:"-"})]},l)):o.jsx("tr",{children:o.jsx("td",{colSpan:2,children:o.jsx(Xe,{})})})})]})]})}function pY({value:t}){const e=f.useRef(null);return o.jsxs(o.Fragment,{children:[o.jsxs(le,{onClick:()=>{var n;return(n=e.current)==null?void 0:n.open()},className:"p-1.5 ml-5",size:"clear",children:[o.jsx(ls,{className:"w-6"}),o.jsx("div",{className:"hidden md:block",children:"Add genre"})]}),o.jsx(Ee,{ref:e,variant:"animation",wrapped:!1,children:o.jsx(_1,{genreName:t,type:"add",closeModal:()=>{var n;return(n=e.current)==null?void 0:n.close()}})})]})}function gY({genre:t}){const[e,n]=f.useState(""),r=f.useRef(null),{action:s,isFetching:i}=_N(),a=u=>{var d;n(u),(d=r.current)==null||d.open()},l=()=>{var u;return(u=r.current)==null?void 0:u.close()},c=async()=>{await s({type:"delete",id:t.id})};return o.jsxs(o.Fragment,{children:[o.jsxs(Wu,{children:[o.jsx("span",{children:t.name}),o.jsxs("div",{children:[o.jsx("button",{className:"",onClick:()=>a("edit"),children:o.jsx(Oa,{className:"w-5"})}),o.jsx("button",{onClick:()=>a("delete"),children:o.jsx(Gn,{className:"w-5"})})]})]}),o.jsxs(Ee,{variant:"animation",ref:r,wrapped:!1,children:[e==="edit"&&o.jsx(_1,{type:"edit",genre:t,closeModal:l}),e==="delete"&&o.jsx(Xn,{children:o.jsx(Li,{callback:c,close:l,loading:i,label:`Delete genre '${t.name}'`})})]})]})}function yY(){const{isFetching:t,api:e}=SN(),{_genres:n,...r}=EN();return f.useEffect(()=>{e()},[]),o.jsxs("div",{className:"pb-[46px]",children:[o.jsx(xe,{title:"Genres"}),o.jsxs("div",{className:"flex justify-between items-start mt-3",children:[o.jsx(yN,{...r}),o.jsx(pY,{value:r.value})]}),o.jsxs("div",{className:"mt-3",children:[t&&o.jsx(te,{className:"h-[200px] rounded-xl"}),!t&&o.jsx(o.Fragment,{children:n.length?o.jsx("div",{className:"flex flex-wrap -mt-2 -mx-2",children:n.map(s=>o.jsx(gY,{genre:s},s.id))}):o.jsx(Xe,{})})]})]})}function xY(){return o.jsx(dN,{})}function vY(){const{setErrorToast:t}=oe(),{singer:e,setSinger:n}=Oi(),[r,s]=f.useState(!1),i=nn();return{isFetching:r,action:async l=>{try{switch(l.variant){case"delete":{if(!e)throw new Error("");s(!0),await l1({collectionName:"Singers",id:e.id}),e.image_file_path&&await $n({filePath:e.image_file_path}),s(!1),i("/dashboard/singer");break}}}catch(c){console.log({message:c}),t("")}finally{s(!1)}},singer:e,setSinger:n}}function wY(){const[t,e]=f.useState(""),n=f.useRef(null),{action:r,isFetching:s,singer:i}=vY(),a=c=>{var u;e(c),(u=n.current)==null||u.open()},l=()=>{var c;return(c=n.current)==null?void 0:c.close()};return o.jsxs(o.Fragment,{children:[o.jsx("button",{onClick:()=>a("more"),className:"text-sm ml-auto !mt-0",children:"See more"}),o.jsx("div",{className:"!mt-auto",children:o.jsxs("div",{className:"space-x-2",children:[o.jsxs(le,{onClick:()=>a("edit"),className:"h-[32px]  space-x-1 px-2.5",size:"clear",children:[o.jsx(Oa,{className:"w-6"}),o.jsx("div",{className:"hidden md:block",children:"Edit singer"})]}),o.jsxs(le,{onClick:()=>a("delete"),className:"h-[32px]  space-x-1 px-2.5",size:"clear",children:[o.jsx(Gn,{className:"w-6"}),o.jsx("div",{className:"hidden md:block",children:"Delete"})]})]})}),t&&o.jsx(Ee,{wrapped:!1,ref:n,variant:"animation",children:o.jsxs(Xn,{className:"w-[unset]",children:[t==="more"&&i&&o.jsx("div",{className:"w-[400px] max-w-[calc(100vw-40px)]",children:i.description}),t==="edit"&&o.jsx(XN,{closeModal:l,variant:"edit"}),t==="delete"&&i&&o.jsx(Li,{label:`Delete singer '${i.name}'`,loading:s,callback:()=>r({variant:"delete"}),close:l})]})})]})}function _Y(){const{setSinger:t,setSongs:e,setPlaylists:n,setAlbums:r}=Oi(),{setErrorToast:s}=oe(),{setIsFetching:i}=Gu(),a=Fa(),l=nn(),c=f.useRef(!1),u=async()=>{try{if(!a.id)return;const d=await ss({collectionName:"Singers",id:a.id});d.exists()||l("/dashboard/singer");const h={...d.data(),id:a.id},m=_e(Tn,V(`singer_map.${h.id}`,"==",!0)),p=await In(m),g=_e(jr,V(`singer_map.${h.id}`,"==",!0)),y=await is(g),_=[],w=[];y.forEach(x=>x.is_album?w.push(x):_.push(x)),t(h),n(_),r(w),e(p)}catch(d){console.log({error:d}),s()}finally{i(!1)}};f.useEffect(()=>{c.current||(c.current=!0,u())},[])}function SY(){const[t,e]=f.useState(!0);return{isFetching:t,setIsFetching:e}}const YN=f.createContext(null);function EY({children:t}){return _Y(),t}function bY({children:t}){return o.jsx(YN.Provider,{value:SY(),children:o.jsx(EY,{children:t})})}function Gu(){const t=f.useContext(YN);if(!t)throw new Error;return t}function kY(){const{singer:t}=Oi(),{isFetching:e}=Gu();return!e&&!t?o.jsx(o.Fragment,{}):o.jsx(o.Fragment,{children:o.jsxs("div",{className:"md:flex",children:[o.jsx("div",{className:"w-[70%] mx-auto md:w-1/4 md:flex-shrink-0 md:m-unset",children:e?o.jsx(te,{className:"pt-[100%] "}):o.jsx(gu,{children:o.jsx(ht,{src:t==null?void 0:t.image_url,blurHashEncode:(t==null?void 0:t.blurhash_encode)||""})})}),o.jsx("div",{className:"flex-grow flex flex-col mt-5 space-y-2.5  md:mt-0 md:ml-5",children:e?o.jsxs(o.Fragment,{children:[o.jsx(te,{className:"h-[60px] w-full md:w-[200px]"}),o.jsx(te,{className:"h-[120px] w-full md:w-[70%]"}),o.jsx(te,{className:"h-[17px] w-[200px]"})]}):t&&o.jsxs(o.Fragment,{children:[o.jsx("p",{className:"text-3xl leading-[2] font-playwriteCU",children:t.name}),o.jsxs("p",{children:[t.like," likes"]}),o.jsx("p",{className:"line-clamp-2",children:t.description}),o.jsx(wY,{})]})})]})})}function TY(){const{songs:t}=Oi(),{isFetching:e}=Gu();return o.jsxs(o.Fragment,{children:[o.jsx(xe,{title:"Songs"}),o.jsx(Nr,{children:e?o.jsx(te,{className:"h-[100px]"}):o.jsx(Wi,{colList:["Name","Singer"],children:t.length?t.map((n,r)=>o.jsxs("tr",{className:"hover:bg-black/10",children:[o.jsx("td",{children:o.jsx(we,{to:`/dashboard/song/${n.id}/edit`,children:n.name})}),o.jsx("td",{children:n.singers.map((s,i)=>o.jsx(we,{to:`/dashboard/singer/${s.id}`,className:"hover:text-green-500 hover:underline",children:(i?", ":"")+s.name},i))})]},r)):o.jsx("tr",{children:o.jsx("td",{colSpan:2,children:o.jsx(Xe,{})})})})})]})}function IY(){const{playlists:t}=Oi(),{isFetching:e}=Gu();return o.jsxs(o.Fragment,{children:[o.jsx(xe,{title:"Playlists"}),e&&o.jsx(te,{className:"h-[100px]"}),!e&&o.jsx(Wi,{colList:["Name",""],children:t.length?t.map((n,r)=>o.jsxs("tr",{className:"hover:bg-black/10",children:[o.jsx("td",{children:o.jsx(we,{to:`/dashboard/playlist/${n.id}`,children:n.name})}),o.jsx("td",{children:"-"})]},r)):o.jsx("tr",{children:o.jsx("td",{colSpan:2,children:o.jsx(Xe,{})})})})]})}function CY(){const{albums:t}=Oi(),{isFetching:e}=Gu();return o.jsxs(o.Fragment,{children:[o.jsx(xe,{title:"Albums"}),e&&o.jsx(te,{className:"h-[100px]"}),!e&&o.jsx(Wi,{colList:["Name",""],children:t.length?t.map((n,r)=>o.jsxs("tr",{className:"hover:bg-black/10",children:[o.jsx("td",{children:o.jsx(we,{to:`/dashboard/album/${n.id}`,children:n.name})}),o.jsx("td",{children:"-"})]},r)):o.jsx("tr",{children:o.jsx("td",{colSpan:2,children:o.jsx(Xe,{})})})})]})}function RY(){return o.jsx(o.Fragment,{children:o.jsxs("div",{className:"pb-[46px] space-y-3",children:[o.jsx(kY,{}),o.jsx(CY,{}),o.jsx(TY,{}),o.jsx(IY,{})]})})}function AY(){return o.jsx(bY,{children:o.jsx(RY,{})})}function jY(){const[t,e]=f.useState(),[n,r]=f.useState([]),[s,i]=f.useState(),[a,l]=f.useState(),[c,u]=f.useState();return{singer:t,setSinger:e,songs:n,setSongs:r,updateAlbumData:h=>{s&&i({...s,...h})},albumData:s,imageFile:a,setImageFile:l,setAlbumData:i,album:c,setAlbum:u}}const JN=f.createContext(null);function NY({children:t}){return o.jsx(JN.Provider,{value:jY(),children:t})}function vp(){const t=f.useContext(JN);if(!t)throw new Error("AddAlbumProvider not provided");return t}function PY(t){const{imageFile:e,updateAlbumData:n,setSinger:r,albumData:s,setSongs:i,album:a,singer:l,songs:c,setAlbum:u,setImageFile:d,setAlbumData:h}=vp(),{setSuccessToast:m,setErrorToast:p}=oe(),[g,y]=f.useState(!1),_=f.useRef(!1),w=f.useMemo(()=>t.variant==="add"?!0:!a||!s||!l?!1:s.name!==a.name||l&&l.id!==a.singers[0].id||!!c.find(b=>!a.song_ids.includes(b.id)),[s,a,l,c]),x=!!e,v=f.useMemo(()=>{const b=!!w&&!!s&&!!s.name&&!!l&&!!c.length;return t.variant==="add"?b:b||x},[x,w,s,l,c]);console.log(v,w);const S=async()=>{try{if(!s||!l)return;if(y(!0),e){const b=await Hi({imageFile:e});Object.assign(s,b)}switch(s.singers=[l],s.singer_map={[l.id]:!0},s.song_ids=c.map(b=>b.id),t.variant){case"add":{const b=await Vi({collectionName:"Playlists",data:s}),I=await zu(b),A={...I.data(),id:I.id};t.callback(A),m("Album created");break}case"edit":{if(!a)return;await Qt({collectionName:"Playlists",data:s,id:a.id}),u({...a,...s}),m("Album edited");break}}}catch(b){console.log(b),p()}finally{y(!1),d(void 0)}},E=async()=>{switch(t.variant){case"add":h(mb({owner_email:t.user.email,distributor:t.user.email}));break;case"edit":const{id:b,song_ids:I,singers:A,...L}=t.album;if(I){const P=_e(Tn,V(Bs(),"in",I)),ce=await In(P);i(ce)}u(t.album),r(A[0]),h(mb({...L,song_ids:I,singers:A}));break}};return f.useEffect(()=>{_.current||(_.current=!0,E())},[]),f.useEffect(()=>{e&&n({image_url:URL.createObjectURL(e)})},[e]),{submit:S,isFetching:g,isValidToSubmit:v}}function FY(){const{singer:t,setSinger:e,albumData:n,updateAlbumData:r}=vp(),s=f.useRef(null),i=a=>{var l;e(a),(l=s.current)==null||l.close()};if(n)return o.jsxs(o.Fragment,{children:[o.jsxs(kn,{className:"space-y-2.5",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-lg",htmlFor:"name",children:"Name"}),o.jsx(cr,{type:"text",placeholder:"name...",id:"name",className:"text-[#333]",value:n.name,onChange:a=>r({name:a.target.value})})]}),o.jsxs("div",{className:"flex items-center space-x-1.5",children:[o.jsx("p",{className:"text-lg",children:"Singer"}),t?o.jsxs(Wu,{className:"mt-0",children:[o.jsx("span",{children:t.name}),o.jsx("div",{children:o.jsx("button",{onClick:()=>e(void 0),children:o.jsx(Gn,{className:"w-5"})})})]}):o.jsx(le,{size:"clear",className:"p-1.5",onClick:()=>{var a;return(a=s.current)==null?void 0:a.open()},children:o.jsx(ls,{className:"w-5"})})]})]}),o.jsx(Ee,{wrapped:!1,variant:"animation",ref:s,children:o.jsx(bN,{choose:i,closeModal:()=>{var a;return(a=s.current)==null?void 0:a.close()}})})]})}function DY(){const{songs:t,setSongs:e}=vp(),n=f.useRef(null),r=i=>{const a=t.map(c=>c.id),l=i.filter(c=>!a.includes(c.id));e([...t,...l])},s=i=>{const a=t.filter(l=>l.id!==i.id);e(a)};return o.jsxs(o.Fragment,{children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-lg mb-1",children:"Songs"}),o.jsxs(Wi,{colList:["Name","Singer",""],children:[t.map((i,a)=>o.jsxs("tr",{children:[o.jsx("td",{children:o.jsx("span",{children:i.name})}),o.jsx("td",{children:i.singers.map((l,c)=>o.jsxs("span",{className:"hover:underline",children:[!!c&&", ",l.name]},c))}),o.jsx("td",{children:o.jsx(le,{onClick:()=>s(i),size:"clear",className:"p-1",children:o.jsx(Gn,{className:"w-5"})})})]},a)),o.jsx("tr",{children:o.jsx("td",{colSpan:3,children:o.jsx("p",{className:"text-center",children:o.jsxs(le,{onClick:()=>{var i;return(i=n.current)==null?void 0:i.open()},children:[o.jsx(ls,{className:"w-6"}),o.jsx("span",{children:"Add song"})]})})})})]})]}),o.jsx(Ee,{wrapped:!1,variant:"animation",ref:n,children:o.jsx(Xn,{className:"w-[700px] min-h-[50vh]",children:o.jsx(KN,{submit:r,closeModal:()=>{var i;return(i=n.current)==null?void 0:i.close()},isLoading:!1})})})]})}function OY(t){const{theme:e}=O(),{albumData:n,setImageFile:r}=vp(),{submit:s,isFetching:i,isValidToSubmit:a}=PY(t),l=c=>{var u;(u=c.target.files)!=null&&u.length&&r(c.target.files[0])};return n?o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"md:flex overflow-auto",children:[o.jsxs("div",{className:"space-y-2.5",children:[o.jsx("div",{className:"w-[200px] h-[200px] rounded-lg overflow-hidden",children:o.jsx(ht,{className:"object-cover object-center h-full",blurHashEncode:n.blurhash_encode,src:n.image_url})}),o.jsx("input",{onChange:l,type:"file",multiple:!0,accept:"image/png, image/jpeg",id:"image_upload",className:"hidden"}),o.jsx("div",{className:"space-x-2 flex",children:o.jsx(le,{className:`${e.content_bg}`,size:"clear",children:o.jsx("label",{htmlFor:"image_upload",className:"px-5 py-1 cursor-pointer ",children:o.jsx(ol,{className:"w-5"})})})})]}),o.jsxs("div",{className:"mt-3 md:mt-0 md:ml-3 flex-grow flex flex-col space-y-2.5",children:[o.jsx(FY,{}),o.jsx(DY,{})]})]}),o.jsx("p",{className:"text-right mt-5",children:o.jsx(le,{loading:i,color:"primary",onClick:s,disabled:!a,className:"font-playwriteCU rounded-full",children:"Save"})})]}):o.jsx(o.Fragment,{})}function ZN(t){return o.jsx(NY,{children:o.jsx(OY,{...t})})}function MY({setAlbums:t}){const{user:e}=fe(),n=f.useRef(null),r=()=>{var i;return(i=n.current)==null?void 0:i.close()},s=i=>{t(a=>[i,...a]),r()};if(e)return o.jsxs(o.Fragment,{children:[o.jsxs(le,{onClick:()=>{var i;return(i=n.current)==null?void 0:i.open()},className:"h-[32px] space-x-1 px-2.5 ml-5",size:"clear",children:[o.jsx(cs,{className:"w-6"}),o.jsx("div",{className:"hidden md:block",children:"Add new album"})]}),o.jsx(Ee,{wrapped:!1,ref:n,variant:"animation",children:o.jsxs(Xn,{className:"w-[800px]",children:[o.jsx(xe,{title:"Add album"}),o.jsx(ZN,{variant:"add",user:e,callback:s})]})})]})}const LY=["All","Result"];function $Y(){const[t,e]=f.useState([]),[n,r]=f.useState(""),[s,i]=f.useState(!0),[a,l]=f.useState("All"),{setErrorToast:c}=oe(),u=async h=>{try{h.preventDefault(),i(!0);const m=_e(jr,V("is_album","==",!0),V("name",">=",n),V("name","<=",n+"")),p=await is(m);e(p),l("Result")}catch(m){console.log({message:m}),c()}finally{i(!1)}},d=async()=>{try{i(!0);const h=_e(jr,V("is_album","==",!0),Ni("created_at","desc")),m=await is(h);e(m)}catch(h){console.log({message:h}),c()}finally{i(!1)}};return f.useEffect(()=>{a==="All"&&d()},[a]),{isFetching:s,value:n,setValue:r,handleSubmit:u,albums:t,tab:a,setTab:l,tabs:LY,setAlbums:e}}function zY(){const{isFetching:t,albums:e,tab:n,tabs:r,setTab:s,setAlbums:i,...a}=$Y();return o.jsxs("div",{className:"pb-[46px]",children:[o.jsx(xe,{title:"Albums"}),o.jsxs("div",{className:"flex justify-between mt-3",children:[o.jsx(_l,{...a}),o.jsx(MY,{setAlbums:i})]}),o.jsx("div",{className:`mt-5 w-fit ${n==="All"?"pointer-events-none":""} self-start`,children:o.jsx(us,{tabs:r,render:l=>l,tab:n,setTab:s})}),o.jsxs("div",{className:"mt-3",children:[t&&o.jsx(te,{className:"h-[200px] rounded-xl"}),!t&&o.jsx(Wi,{colList:["Name","Singer",""],children:e.length?e.map((l,c)=>o.jsxs("tr",{children:[o.jsx("td",{children:o.jsx(we,{className:"hover:underline",to:`/dashboard/album/${l.id}`,children:l.name})}),o.jsx("td",{children:o.jsx(we,{to:`/dashboard/${l.singers[0].id}`,children:l.singers[0].name})}),o.jsx("td",{children:"-"}),o.jsx("td",{children:"-"})]},c)):o.jsx("tr",{children:o.jsx("td",{colSpan:4,children:o.jsx(Xe,{})})})})]})]})}function ik({children:t}){return o.jsx(LG,{children:t})}function BY({children:t}){return o.jsx(AG,{children:t})}function UY(){const[t,e]=f.useState(!0),[n,r]=f.useState(),s=f.useRef(!1),i=Fa(),a=nn(),{setErrorToast:l}=oe(),c=async()=>{try{if(!i.id)return;const u=await ss({collectionName:"Playlists",id:i.id});if(!u.exists())return a("/dashboard/album");const d={...u.data(),id:u.id};if(!d.is_album)return a(`/dashboard/playlist/${d.id}`);r(d)}catch(u){console.log(u),l()}finally{e(!1)}};return f.useEffect(()=>{s.current||(s.current=!0,c())},[]),{album:n,isFetching:t}}function VY(){const{album:t,isFetching:e}=UY();return console.log(t),e?o.jsx(ur,{children:o.jsx(Lt,{className:"w-6 animate-spin"})}):t?o.jsxs(o.Fragment,{children:[o.jsx(xe,{title:"Edit album",className:"mb-3"}),o.jsx(ZN,{variant:"edit",album:t})]}):o.jsx(o.Fragment,{})}const Ol={home:"/",search:"/search",playlist:"/playlist/:id",login:"/login",unauthorized:"/unauthorized",singer:"/singer/:id"},ak={myMusic:"/my-music",songLyric:"/my-music/lyric/:id"},er={dashboard:"/dashboard",genre:"/dashboard/genre",playlist:"/dashboard/playlist",song:"/dashboard/song",addSong:"/dashboard/song/add-song",editSong:"/dashboard/song/:songId/edit",playlistDetail:"/dashboard/playlist/:id",songLyric:"/dashboard/lyric/:id",singer:"/dashboard/singer",editSinger:"/dashboard/singer/:id",album:"/dashboard/album",editAlbum:"/dashboard/album/:id"},HY=[{path:Ol.home,component:ZW,layout:""},{path:Ol.playlist,component:lq,layout:""},{path:Ol.search,component:iG,layout:""},{path:Ol.unauthorized,component:oG,layout:""},{path:Ol.singer,component:EG,layout:""}],WY=[{path:ak.myMusic,component:gq,layout:""},{path:ak.songLyric,component:tG,layout:""}],qY=[{path:er.dashboard,component:bG,layout:""},{path:er.playlist,component:rY,layout:""},{path:er.genre,component:yY,layout:""},{path:er.singer,component:mY,layout:nS},{path:er.editSinger,component:AY,layout:nS},{path:er.playlistDetail,component:cY,layout:BY},{path:er.album,component:zY,layout:""},{path:er.editAlbum,component:VY,layout:""},{path:er.song,component:OG,layout:""},{path:er.addSong,component:YX,layout:ik},{path:er.editSong,component:ZX,layout:ik},{path:er.songLyric,component:xY,layout:""}],eP="/HD-MP3/assets/loading-b1210647.gif";function GY(){const{user:t,loading:e}=fe(),{theme:n}=O();return e?o.jsx("div",{className:`min-h-screen flex flex-col items-center justify-center ${n.container}`,children:o.jsx("img",{className:"w-[150px]",src:eP,alt:""})}):t?o.jsx($f,{}):o.jsx(jT,{state:{from:"/my-music"},replace:!0,to:"/login"})}function QY(){const[t,e]=f.useState(!0),[n,r]=f.useState(!1),{user:s,loading:i}=fe(),{theme:a}=O();return f.useEffect(()=>{(async()=>{await Ns(1e3),r(!0),e(!1)})()},[]),i||t?o.jsx("div",{className:`min-h-screen flex flex-col items-center justify-center ${a.container}`,children:o.jsx("img",{className:"w-[150px]",src:eP,alt:""})}):s&&n?o.jsx($f,{}):o.jsx(jT,{replace:!0,to:"/unauthorized"})}const tP=[{path:"/dashboard",title:"Dashboard",icon:o.jsx(dv,{className:"w-5 flex-shrink-0"})},{path:"/dashboard/song",title:"Songs",icon:o.jsx(Da,{className:"w-5 flex-shrink-0"})},{path:"/dashboard/playlist",title:"Playlists",icon:o.jsx(yS,{className:"w-5 flex-shrink-0"})},{path:"/dashboard/album",title:"Albums",icon:o.jsx(yS,{className:"w-5 flex-shrink-0"})},{path:"/dashboard/singer",title:"Singers",icon:o.jsx(CM,{className:"w-5 flex-shrink-0"})},{path:"/dashboard/genre",title:"Genres",icon:o.jsx(fM,{className:"w-5 flex-shrink-0"})}];function KY(){const{theme:t}=O(),[e,n]=f.useState(!1),r=qn(),s="",i={container:"hidden md:block bg-[#f1f1f1] text-[#333] border-r border-black/10 transition-[width] relative flex-shrink-0",head:"h-[60px] flex items-center justify-center",logoText:"text-[22px] font-[500] whitespace-nowrap tracking-[-1px]",logoImage:"max-w-[50px] p-[4px]",item:"flex whitespace-nowrap space-x-2 items-center justify-center p-2.5 ",itemActive:"text-[#cd1818] bg-[#f1f1f1]",icon:"w-[24px] flex-shrink-0"};return o.jsxs("div",{className:`${i.container} ${e?"w-[150px]":"w-[70px]"}`,children:[o.jsxs("div",{className:"md:mt-[60px]",children:[tP.map((a,l)=>{const c=r.pathname===a.path;return o.jsxs(we,{className:`
              ${c?t.content_bg:"hover:bg-black/10"}
              ${i.item} ${e?"!justify-start":""}
              ${s===a.path?i.itemActive:""}`,to:a.path,children:[a.icon,e&&o.jsx("span",{children:a.title})]},l)}),o.jsxs(we,{to:"/",target:"_blank",className:`${i.item} ${e?"!justify-start":""}
               
               `,children:[o.jsx(Xf,{className:i.icon}),e&&o.jsx("span",{children:"Home"})]})]}),o.jsx(le,{onClick:()=>n(a=>!a),size:"clear",className:"!absolute p-1.5 bottom-5 right-0 translate-x-[50%]",children:e?o.jsx(pW,{className:"w-5 "}):o.jsx(xW,{className:"w-5"})})]})}function nP({className:t=""}){const{behind:e,ahead:n,backward:r,forward:s}=nN();return o.jsxs("div",{className:`"flex space-x-3 [&>button]:p-1 ${t}`,children:[o.jsx("button",{onClick:r,className:`relative ${jc(!e.length)}`,children:o.jsx(xI,{className:"w-5"})}),o.jsx("button",{onClick:s,className:`relative ${jc(!n.length)}`,children:o.jsx(qD,{className:"w-5"})})]})}function XY(){const{theme:t}=O(),[e,n]=f.useState(0),[r,s]=f.useState(""),i=f.useRef(null),a=f.useRef(null),l=h=>{var m,p;s(h),(m=a.current)==null||m.close(),(p=i.current)==null||p.open()},c=()=>{var h;return(h=i.current)==null?void 0:h.close()},u=h=>{const m=h.target.scrollTop||0;n(m)},d=()=>{switch(r){case"":return o.jsx(o.Fragment,{});case"theme":return o.jsx(wv,{close:c});case"info":return o.jsx(vv,{close:c})}};return f.useEffect(()=>{const h=document.querySelector(".main-container");return h==null||h.addEventListener("scroll",u),()=>{h==null||h.removeEventListener("scroll",u)}},[]),o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:`hidden md:flex px-[40px] z-[99] h-[60px] flex-shrink-0 items-center justify-between ${e?" shadow-lg":""}`,children:[o.jsxs("div",{className:"flex",children:[o.jsxs(we,{to:"/dashboard",className:"text-xl font-[500]",children:["HD",o.jsx("span",{className:`${t.content_text} ml-[4px] uppercase`,children:"Dashboard"})]}),o.jsx(nP,{className:"ml-5"})]}),o.jsx("div",{className:"flex",children:o.jsxs(dr,{children:[o.jsx(hr,{ref:a,children:o.jsx("button",{className:`flex p-2 items-center rounded-full bg-${t.alpha} ${t.content_hover_bg}`,children:o.jsx(mu,{className:"w-6"})})}),o.jsx(fr,{appendTo:"parent",className:"top-[calc(100%+8px)] right-0",animationClassName:"origin-top-right",children:o.jsx(aC,{openModal:l,variant:"dashboard"})})]})})]}),o.jsx(Ee,{ref:i,variant:"animation",children:d()})]})}function YY(){const[t,e]=f.useState(!1),n=f.useRef(null),r=s=>{var i;(i=n.current)!=null&&i.contains(s.target)||e(!1)};return f.useEffect(()=>(t&&window.addEventListener("click",r),()=>{window.removeEventListener("click",r)}),[t]),o.jsxs(o.Fragment,{children:[o.jsx(kn,{colors:"third",className:`absolute z-[99] duration-[.25] flex flex-col
        transition-[left,opacity] bottom-[80px] 
        ${t?"left-[10px] opacity-[1] pointer-events-auto":"left-0 opacity-[0] pointer-events-none"}`,children:tP.map((s,i)=>o.jsxs(we,{className:"inline-flex py-1.5 space-x-1",to:s.path,children:[s.icon,o.jsx("span",{children:s.title})]},i))}),o.jsx(le,{ref:n,size:"clear",onClick:()=>e(!t),className:"!absolute transition-[left] bottom-[10px] left-[10px]  p-1.5",children:o.jsx(al,{className:"w-6"})})]})}function JY({className:t="",toast:e,onClick:n}){const{theme:r}=O(),[s,i]=f.useState(!1),a={icon:"w-6",container:`transition-[transform,opacity] text-white px-3 py-1 space-x-1 rounded-md flex items-center ${r.modal_bg}`,text:"font-[500] text-sm",open:"opacity-[1] translate-x-0",init:"opacity-0 translate-x-10"},l=()=>{switch(e.variant){case"success":return o.jsx(yv,{className:`${a.icon} text-emerald-500`});case"error":return o.jsx(TI,{className:`${a.icon} text-red-500`})}};return f.useEffect(()=>{setTimeout(()=>{i(!0)},0)},[]),o.jsxs("div",{onClick:()=>n?n(e.id):void 0,className:`${a.container} ${t} ${s?a.open:a.init} `,children:[l(),o.jsx("p",{className:a.text,children:e.desc})]})}const rP=({time:t=6e3,className:e=""})=>{const{setToasts:n,toasts:r}=oe(),[s,i]=f.useState(""),a=l=>{n(c=>c.filter(u=>u.id!=l))};return f.useEffect(()=>{s&&n(l=>l.filter(c=>c.id!=s))},[s]),f.useEffect(()=>{if(!r.length)return;const l=r[r.length-1].id;setTimeout(()=>{i(l)},t)},[r]),o.jsx(o.Fragment,{children:tl.createPortal(o.jsx("div",{className:`fixed z-[199] ${e}`,children:o.jsx("div",{className:"flex flex-col gap-[10px]",children:!!r.length&&r.map((l,c)=>o.jsx(JY,{onClick:a,toast:l},c))})}),document.getElementById("portals"))})};function ZY(){const{setTheme:t,isOnMobile:e,theme:n}=O();return f.useEffect(()=>{t(W3)},[]),o.jsx(o.Fragment,{children:o.jsx(uI,{children:o.jsx(zG,{children:o.jsxs("div",{className:`${n.container} fixed inset-full flex ${n.text_color}`,children:[e?o.jsx(YY,{}):o.jsx(KY,{}),o.jsxs("div",{className:"flex flex-col flex-grow",children:[o.jsx(XY,{}),o.jsx("div",{className:"main-container flex flex-col flex-grow overflow-auto p-[10px] md:px-[40px] md:pt-0",children:o.jsx($f,{})})]}),o.jsx(rP,{className:"left-[50%] translate-x-[-50%] top-[10px] md:top-[unset] md:bottom-[60px] md:left-[20px] md:translate-x-0"}),o.jsx(cI,{})]})})})})}const sP="USRKy:SK%|R*}@r@MxoeY$kWmnafBUR*oybu";function iP({variant:t="desktop"}){const{desktopTabs:e,activeTab:n,setActiveTab:r,mobileActiveTab:s,mobileTabs:i,setMobileActiveTab:a,idle:l}=Mt(),c=t==="desktop"?n:s,u=t==="desktop"?r:a,d=t==="desktop"?e:i,h={item:"px-3 md:px-8 leading-[30px] font-[600] cursor-pointer  rounded-full",fadeTransition:"opacity-0 transition-opacity duration-[.3s]"};return o.jsx("ul",{className:`inline-flex mx-auto rounded-full space-x-1 bg-white/10 p-1 ${l?h.fadeTransition:""}`,children:d.map((m,p)=>{const g=m===c;return o.jsx("li",{onClick:()=>u(m),className:`${h.item} ${g?"bg-white/20":"hover:bg-white/5"}`,children:m},p)})})}function eJ(){const{user:t}=fe(),{theme:e}=O(),{activeTab:n,idle:r,setIsOpenFullScreen:s,isEnableBeat:i,setIsEnableBeat:a,audioRef:l}=Mt(),{currentSongData:c}=ae(dt),u=nn(),d=c&&t?c.song.owner_email===t.email&&c.song.is_official===!1:!1,h=()=>{c!=null&&c.song&&(s(!1),setTimeout(()=>{u(`/my-music/lyric/${c==null?void 0:c.song.id}`)},300))},m=()=>{if(!l.current||!(c!=null&&c.song))return;const g=!i;a(g);const y=l.current.currentTime;l.current.src=g?c.song.beat_url:c.song.song_url,l.current.currentTime=y},p={button:`w-[38px] h-[38px] bg-white/10 rounded-[99px] transition-transform ${e.content_hover_bg}`,headerWrapper:"relative flex py-[25px] px-[40px] w-full items-center",fadeTransition:"opacity-0 transition-opacity duration-[.3s]"};return o.jsxs("div",{className:`${p.headerWrapper} ${r?"pointer-events-none":""}`,children:[r&&c&&o.jsx("div",{className:"absolute left-4",children:n!=="Songs"&&o.jsxs(o.Fragment,{children:[o.jsx("p",{className:"font-playwriteCU text-sm",children:c.song.name}),o.jsx("p",{className:"opacity-70 text-sm",children:c.song.singers.map((g,y)=>(y?", ":"")+g.name)})]})}),o.jsx(iP,{}),o.jsxs("div",{className:`absolute flex right-4 space-x-3 ${r&&p.fadeTransition}`,children:[d&&n==="Lyric"&&o.jsx(Is,{position:"top-[calc(100%+8px)]",content:"Edit lyric",children:o.jsx("button",{onClick:()=>h(),className:`p-2 ${p.button}`,children:o.jsx(hv,{})})}),n==="Karaoke"&&(c==null?void 0:c.song.beat_url)&&o.jsxs("div",{className:"flex items-center space-x-1",children:[o.jsx("span",{className:"font-[500]",children:"Beat"}),o.jsx(Zf,{active:i,cb:m})]}),o.jsxs(dr,{children:[o.jsx(hr,{children:o.jsx(Is,{position:"top-[calc(100%+8px)]",content:"Setting",children:o.jsx("button",{className:`${p.button} p-2`,children:o.jsx(uv,{})})})}),o.jsx(fr,{appendTo:"parent",className:"top-[calc(100%+8px)] right-0 z-[99]",animationClassName:"origin-top-right",children:o.jsx(lC,{})})]}),o.jsx(Is,{position:"top-[calc(100%+8px)]",content:"Close",children:o.jsx("button",{onClick:()=>s(!1),className:`p-2 ${p.button}`,children:o.jsx(wI,{})})})]})]})}const Nd=.3;function tJ({active:t}){const{audioRef:e}=Mt();if(!e.current)throw new Error("useSongLyric !audioRef.current");const[n,r]=f.useState(0),s=f.useRef("instant"),i=f.useRef(null),a=f.useRef(0),l=f.useRef([]),c=f.useRef(0),{loading:u,songLyrics:d}=Kj({active:t}),h=()=>{const m=e.current.currentTime>a.current?"forward":"backward";a.current=e.current.currentTime;let p=c.current;switch(m){case"forward":for(;d[p+1]&&d[p+1].start-Nd<a.current+Nd;)p+=1;break;case"backward":for(;d[p-1]&&d[p-1].end-Nd>a.current+Nd;)p-=1;break}p!==c.current&&(Math.abs(p-c.current)>5&&(s.current="instant"),c.current=p,r(p),sI(l.current[p],s.current),s.current==="instant"&&(s.current="smooth"))};return f.useEffect(()=>{h()},[t]),f.useEffect(()=>{if(!(!t||!d.length))return e.current.addEventListener("timeupdate",h),()=>{e.current.removeEventListener("timeupdate",h)}},[t,d]),f.useEffect(()=>()=>{r(0),c.current=0},[d]),{songLyrics:d,loading:u,currentIndex:n,containerRef:i,lyricRefs:l,scrollBehavior:s}}function aP({className:t,active:e}){const{lyricSize:n}=ae(Kn),{loading:r,songLyrics:s,currentIndex:i,containerRef:a,lyricRefs:l}=tJ({active:e}),c={small:"text-[20px] sm:text-[30px]",medium:"text-[25px] sm:text-[35px]",large:"text-[30px] sm:text-[40px]"},u=()=>s.map((h,m)=>{let p="coming";return i===m?p="active":m<i&&(p="done"),o.jsx(aN,{ref:g=>l.current[m]=g,status:p,text:h.text,className:" mb-[30px] last:mb-[50vh]"},m)}),d={container:"no-scrollbar pt-[20px] mask-image overflow-y-auto overflow-x-hidden"};return o.jsxs("div",{ref:a,className:`${d.container} ${c[n||"medium"]} ${t}`,children:[r&&o.jsx("div",{className:"relative w-full h-full",children:o.jsx(ur,{children:o.jsx(Lt,{className:"w-7 animate-spin"})})}),!r&&o.jsx(o.Fragment,{children:s.length?u():o.jsx("div",{className:"relative w-full h-full",children:o.jsx(ur,{children:o.jsx("h1",{className:"text-[30px] opacity-60",children:"..."})})})})]})}const Ml=.3,ok=t=>t%2!==0;function nJ({active:t}){const{audioRef:e}=Mt();if(!e.current)throw new Error("useKaraoke !audioRef.current");const[n,r]=f.useState(0),s=f.useRef(null),i=f.useRef(null),a=f.useRef(null),l=f.useRef(null),c=f.useRef(0),u=f.useRef(0),d=f.useRef("paused"),h=f.useRef(!1),{songLyrics:m,loading:p,playStatus:g}=Kj({active:t}),y=f.useMemo(()=>{if(m.length){if(n<0)return{odd:"",even:""};const v=ok(n);if(!m[n+1])return{odd:"",even:""};const S=v?[n,n+1]:[n+1,n],E=m[S[0]].text.trim(),b=m[S[1]].text.trim();return{odd:E,even:b}}else return{odd:"",even:""}},[n,m]),_=v=>{v.style.animation="none"},w=(v,S,E,b)=>{var L,P;let I="running";d.current==="paused"&&(I="paused"),E.style.animation=`${v} ${(((L=S==null?void 0:S.tune)==null?void 0:L.end)||S.end)-(((P=S==null?void 0:S.tune)==null?void 0:P.start)||S.start)}s linear ${I} forwards`;const A=+b.toFixed(1);Math.abs(A)>.2&&(E.style.animationDelay=`${A}s`)},x=()=>{if(!m.length)return;const v=e.current.currentTime>=c.current?"forward":"backward";c.current=e.current.currentTime;let S=u.current;switch(v){case"forward":for(;S<m.length&&m[S+1]&&m[S+1].start-Ml<c.current+Ml;)S+=1;break;case"backward":for(;S>0&&m[S-1]&&m[S-1].end-Ml>c.current+Ml;)S-=1;break}if(S!==u.current||h.current||d.current==="paused"||d.current==="waiting"){if(h.current=!1,u.current=S,r(S),!s.current||!i.current||!l.current||!a.current)return;const E=m[S],{tune:b,text:I,cut:A}=E,L=c.current+Ml-b.start,P=I.split(" "),ce=ok(S),K=uN(ce?l.current:a.current),Pe=x1(P,A,b.grow),ie=ce?[s.current,i.current]:[i.current,s.current],ke=cN(Pe,K);w(ke,E,ie[0],-L),_(ie[1])}};return f.useEffect(()=>{d.current==="waiting"?setTimeout(()=>{d.current=g},300):d.current=g},[g]),f.useEffect(()=>{t&&(h.current=!0,g==="paused"&&x())},[t]),f.useEffect(()=>{if(!(!m.length||!t))return e.current.addEventListener("timeupdate",x),()=>{e.current.removeEventListener("timeupdate",x)}},[m,t]),f.useEffect(()=>()=>{c.current=0,u.current=-1,r(0)},[m]),{loading:p,currentIndexRef:u,oddOverlay:s,evenOverlay:i,currentIndex:n,textData:y,tempEventText:a,tempOddText:l}}function lk({text:t,overlayRef:e}){const{playStatus:n}=ae(Kn),[r,s]=f.useState(t),[i,a]=f.useState(!1),l=f.useRef(!0);f.useEffect(()=>{t&&a(!1)},[t]),f.useEffect(()=>{if(i)return;const u=()=>{s(t),a(!0)};l.current?setTimeout(u,300):(l.current=!0,u())},[i]),f.useEffect(()=>{n==="waiting"&&(l.current=!1),e.current&&(n==="playing"?e.current.style.animationPlayState="running":e.current.style.animationPlayState="paused")},[n]);const c={lyric:"relative duration-300 text-[44px] font-[700] pointer-none whitespace-nowrap"};return o.jsxs("div",{className:`${c.lyric} ${l.current?"transition-opacity":""} ${i?"opacity-[1]":"opacity-0"}`,children:[r||"...",o.jsx("p",{ref:e,className:"absolute whitespace-nowrap w-0 overflow-hidden text-[#ffed00] left-0 top-0 h-full",children:r||"..."})]})}function rJ({active:t}){const{loading:e,evenOverlay:n,oddOverlay:r,tempEventText:s,tempOddText:i,textData:a}=nJ({active:t});return e?o.jsx(ur,{children:o.jsx(Lt,{className:"w-7 animate-spin"})}):o.jsxs(o.Fragment,{children:[o.jsx("div",{ref:s,className:"inline-flex h-0 opacity-0",children:a.even.split(" ").map((l,c)=>o.jsx("span",{className:"leading-1",children:l},c))}),o.jsx("div",{ref:i,className:"inline-flex h-0 opacity-0",children:a.odd.split(" ").map((l,c)=>o.jsx("span",{className:"k leading-1",children:l},c))}),o.jsx(lk,{overlayRef:n,text:a.even}),o.jsx("div",{className:"mt-8"}),o.jsx(lk,{overlayRef:r,text:a.odd})]})}const oP=()=>{window.dispatchEvent(new Event("mousemove"))};function nx(t,e,n=!1){const r=window.innerWidth,i=t.getBoundingClientRect().left,a=r-(i+t.offsetWidth),l=Math.abs(Math.ceil(i-a))/2;if(l<5)return!1;n&&(e.onscroll=()=>{},setTimeout(()=>{e.onscroll=oP},900)),n||Math.abs(i)>r||Math.abs(a)>r?e.style.scrollBehavior="auto":e.style.scrollBehavior="smooth";let c=e.scrollLeft;return a>i?setTimeout(()=>{e.scrollLeft=c-l},300):a<i&&setTimeout(()=>{e.scrollLeft=c+l},300),!0}function sJ(){const t=rn(),{isOpenFullScreen:e,idle:n}=Mt(),{currentQueueId:r}=ae(dt),{playStatus:s}=ae(Kn),i=f.useRef(null),a=f.useRef(null),l=f.useRef("paused"),c=()=>{!(a!=null&&a.current)||!(i!=null&&i.current)||nx(a.current,i.current,n)},u=m=>{let p=document.querySelector(".song-thumb.centered");if(!p)if(a.current)p=a.current;else return;let g;switch(m){case"ArrowRight":g=p.nextElementSibling;break;case"ArrowLeft":g=p.previousElementSibling;break}g&&i.current&&(p.classList.remove("centered"),g.classList.add("centered"),nx(g,i.current))},d=()=>{if(!a.current)return;const m=document.querySelector(".song-thumb.centered");if(!m||m.getAttribute("queue-id")===r)switch(console.log("go here"),l.current){case"playing":return t(Ze({triggerPlayStatus:"paused"}));case"paused":return t(Ze({triggerPlayStatus:"playing"}))}const p=m==null?void 0:m.getAttribute("queue-id");p&&t(Ur(p))},h=m=>{if(m.key==="ArrowRight"||m.key==="ArrowLeft")return m.preventDefault(),u(m.key);m.key==="Enter"&&(m.preventDefault(),d())};return f.useEffect(()=>{e&&c()},[r,e]),f.useEffect(()=>{if(e)return document.addEventListener("keydown",h),()=>{var m;document.removeEventListener("keydown",h),(m=document.querySelector(".song-thumb.centered"))==null||m.classList.remove("centered")}},[r,e]),f.useEffect(()=>{const m=i==null?void 0:i.current;if(m)return m.onscroll=oP,()=>{m.onscroll=()=>{}}},[]),f.useEffect(()=>{l.current=s},[s]),{activeSongRef:a,containerRef:i}}function iJ(){const t=rn(),{activeTab:e,isOpenFullScreen:n,idle:r}=Mt(),{theme:s}=O(),{currentSongData:i}=ae(dt),{queueSongs:a,currentQueueId:l}=ae(dt),{activeSongRef:c,containerRef:u}=sJ(),d=_=>{l!==_&&t(Ur(_))},h=fb(()=>p("next"),200),m=fb(()=>p("previous"),200),p=(_="next")=>{const w=u.current;w.style.scrollBehavior="smooth",_==="next"?w.scrollLeft+=500:_==="previous"&&(w.scrollLeft-=500)},g={songsListTab:" relative h-full no-scrollbar flex items-center flex-row overflow-auto scroll-smooth px-[calc(50%-350px/2)]",absoluteButton:`absolute top-[50%] -translate-y-[50%] p-[8px] bg-white/30 rounded-full ${s.content_hover_bg}`,lyricTabContainer:"px-[40px] min-[1536px]:container  min-[1536px]:px-[200px] h-full flex items-center justify-center flex-row",fadeTransition:"opacity-0 transition-opacity duration-[.3s]"},y=f.useMemo(()=>{if(i!=null&&i.song&&a.length)return a.map((_,w)=>_.queue_id===l?o.jsx(ug,{ref:c,hasTitle:!0,onClick:()=>d(_.queue_id),active:!0,data:_},w):o.jsx(ug,{idleClass:`${r?g.fadeTransition:""}`,hasTitle:!0,active:!1,data:_,onClick:()=>d(_.queue_id)},w))},[i==null?void 0:i.song,a,r]);return o.jsxs(o.Fragment,{children:[o.jsx("div",{ref:u,className:`song-list-container ${g.songsListTab} ${e!=="Songs"?"opacity-0":"opacity-100"}`,children:y}),e==="Songs"&&!r&&o.jsxs(o.Fragment,{children:[o.jsx(ee,{hover:"scale",size:"clear",onClick:()=>m(),className:`${g.absoluteButton} left-[20px]`,children:o.jsx(_I,{className:"w-[30px]"})}),o.jsx(ee,{hover:"scale",size:"clear",onClick:()=>h(),className:`${g.absoluteButton} right-[20px]`,children:o.jsx(Kd,{className:"w-[30px]"})})]}),o.jsxs(pI,{children:[o.jsx("div",{className:`absolute inset-0 z-20 ${e==="Lyric"?"":"hidden"}`,children:o.jsxs("div",{className:g.lyricTabContainer,children:[o.jsx(ug,{active:!0,data:i==null?void 0:i.song}),o.jsx(aP,{className:"w-full ml-[40px] h-full",active:n&&e==="Lyric"})]})}),o.jsx("div",{className:`absolute inset-0 z-20 flex flex-col items-center justify-center ${e==="Karaoke"?"":"hidden"}`,children:o.jsx(rJ,{active:n&&e==="Karaoke"})})]})]})}function aJ(){var a,l;const{isOpenFullScreen:t,idle:e,activeTab:n}=Mt(),{currentSongData:r}=ae(dt),{songBackground:s}=ae(Kn),i={wrapper:`fixed inset-0 z-50 overflow-hidden text-white bg-zinc-900
    } transition-transform duration-[.7s] linear delay-100`,bg:"absolute inset-0 -z-10 brightness-[70%]",container:"absolute w-full top-0 bottom-[90px] flex flex-col",content:"flex-grow relative overflow-hidden",fadeTransition:"opacity-0 transition-opacity duration-[.3s]"};return o.jsxs("div",{className:`${i.wrapper}  ${t?"translate-y-0":"translate-y-full"}`,children:[o.jsx("div",{className:` ${i.bg}`,children:s&&o.jsx(Jf,{radioGroup:"",height:"100%",width:"100%",hash:((a=r==null?void 0:r.song)==null?void 0:a.blurhash_encode)||sP})}),o.jsxs("div",{className:i.container,children:[o.jsx(eJ,{}),o.jsx("div",{className:i.content,children:o.jsx(iJ,{})}),n!=="Songs"&&o.jsxs("p",{className:`text-center ${e&&i.fadeTransition}`,children:[((l=r==null?void 0:r.song)==null?void 0:l.name)||"...",o.jsxs("span",{className:"opacity-70 text-sm",children:[" - ",r==null?void 0:r.song.singers.map((c,u)=>(u?", ":"")+c.name)]})]})]})]})}function oJ(){const{user:t}=fe(),[e,n]=f.useState([]),[r,s]=f.useState(!0);return{isFetching:r,recentSongs:e,getRecentSongs:async()=>{try{if(t&&t.recent_song_ids.length){const a=_e(Tn,V(Bs(),"in",t.recent_song_ids)),l=await In(a);n(l)}else{const a=cn()["recent-songs"]||[];n(a)}}catch(a){console.log({message:a})}finally{s(!1)}}}}function lJ({setTab:t}){const e=rn(),n=f.useRef(!1),{getRecentSongs:r,isFetching:s,recentSongs:i}=oJ(),a=[...Array(5).keys()].map(c=>o.jsx(te,{className:"h-[57px] mt-1"},c)),l=c=>{e(_m({songs:[c]})),e(Ur(c.queue_id)),t("Queue")};return f.useEffect(()=>{n.current||(n.current=!0,r())},[]),s?a:o.jsx(Vs,{isHasCheckBox:!1,songVariant:"recent-song",songs:i,setSong:l})}const cJ=["Queue","Recent"];function uJ(){const t=rn(),{theme:e}=O(),{isOpenSongQueue:n,setIsOpenSongQueue:r,controlRef:s}=Mt(),{queueSongs:i,currentQueueId:a,isFetching:l}=ae(dt),[c,u]=f.useState("Queue"),d=f.useCallback(g=>{g!==a&&t(Ur(g))},[a]),h=f.useCallback(()=>{var g;t(t$()),(g=s.current)==null||g.resetForNewSong(),r(!1)},[]),m=[...Array(5).keys()].map(g=>o.jsx(te,{className:"h-[56px] mt-1"},g)),p={mainContainer:`hidden fixed w-[300px] md:flex flex-col bottom-[80px] right-[0] top-[0] z-20 px-3 pt-4 ${e.container} border-l-[1px] border-${e.alpha} transition-[transform] duration-[.5s] linear delay-100`,songListContainer:"flex-grow overflow-y-auto pb-[10px] overflow-x-hidden no-scrollbar mt-3"};return o.jsx(Nr,{children:o.jsxs("div",{className:`${e.text_color} ${p.mainContainer} ${n?"translate-x-0---":"translate-x-full"}     `,children:[o.jsx(us,{className:"w-fit mx-auto text-sm",tab:c,setTab:u,tabs:cJ,render:g=>g}),o.jsx("div",{className:p.songListContainer,children:c==="Queue"?o.jsxs(o.Fragment,{children:[o.jsx(Vs,{isHasCheckBox:!1,songs:i,setSong:g=>d(g.queue_id),songVariant:"queue-song",getActive:(g,y)=>g.queue_id===y.queue_id}),l&&m,o.jsx("div",{className:"text-center",children:!!i.length&&o.jsxs(ee,{onClick:h,size:"clear",className:`${e.content_bg} rounded-full my-5 px-3 py-1 space-x-1`,children:[o.jsx(Gn,{className:"w-6"}),o.jsx("span",{className:"font-playwriteCU leading-[2.2]",children:"Clear"})]})})]}):o.jsx(lJ,{setTab:u})})]})})}const dJ=f.memo(uJ);function hJ({vinylRef:t}){const{playStatus:e}=ae(Kn);f.useEffect(()=>{const n=t.current;n&&(e==="playing"?n.style.animationPlayState="running":n.style.animationPlayState="paused")},[e])}function fJ({textRef:t,textWrapperRef:e,content:n}){const r=f.useRef(),s=f.useRef(),i=f.useRef(!1),a=f.useRef(0),l=f.useRef(0),c=f.useRef(0),u=()=>{t.current&&(t.current.style.transition="none",t.current.style.transform="translateX(0)")},d=()=>{t.current&&(t.current.style.transition=`transform linear ${l.current}s`,t.current.style.transform=`translateX(-${c.current}px)`,s.current=setTimeout(u,l.current*1e3))},h=()=>{!t.current||!e.current||(c.current=t.current.offsetWidth-a.current,l.current=Math.ceil(c.current/35))},m=()=>{!i.current||!t.current||!e.current||(l.current=0,c.current=0,i.current=!1,clearInterval(r.current),clearTimeout(s.current),e.current.classList.remove("mask-image-horizontal"),u())},p=()=>{!t.current||!e.current||!n||!(t.current.offsetWidth>e.current.offsetWidth)||(i.current=!0,e.current.classList.add("mask-image-horizontal"),a.current=t.current.clientWidth,t.current.innerHTML=t.current.innerText+"&nbsp; &nbsp; &nbsp;"+t.current.innerText,h(),setTimeout(d,1e3),r.current=setInterval(d,l.current*1e3+3e3))};f.useEffect(()=>(p(),m),[n])}function mJ({content:t,className:e}){const n=f.useRef(null),r=f.useRef(null);return fJ({textRef:r,textWrapperRef:n,content:t}),o.jsx("div",{ref:n,className:"overflow-hidden relative h-full ",children:o.jsx("div",{ref:r,className:`absolute left-0 whitespace-nowrap ${e}`,children:t||"..."})})}const lP=f.memo(mJ);function pJ({isOpenFullScreen:t,song:e}){const n=f.useRef(null),{theme:r}=O();hJ({vinylRef:n});const s={songInfoChild:"flex flex-row"};return o.jsx("div",{className:`w-1/4  ${Nc(t)}`,children:o.jsxs("div",{className:`${s.songInfoChild} ${Nc(t)}`,children:[o.jsx("div",{ref:n,className:"w-[56px] h-[56px] flex-shrink-0 animate-[spin_8s_linear_infinite]",children:o.jsx(ht,{src:e==null?void 0:e.image_url,className:"rounded-full h-full object-cover"})}),o.jsxs("div",{className:"ml-2 flex-grow",children:[o.jsx("div",{className:"h-[32px]",children:o.jsx(lP,{className:"leading-[1.5] font-playwriteCU",content:(e==null?void 0:e.name)||"Name"})}),e&&o.jsx("div",{className:"leading-[1.2] text-sm opacity-[.7] line-clamp-1",children:e.singers.map((i,a)=>i.id?o.jsx(we,{to:`/singer/${i.id}`,className:`${r.content_hover_text}  hover:underline`,children:(a?", ":"")+i.name},a):o.jsx("span",{children:(a?", ":"")+i.name}))})]})]})})}function gJ({audioEle:t,volumeLineRef:e}){const{theme:n}=O(),[r,s]=f.useState(!1),[i,a]=Ph("volume",1),l=d=>{const m=d.target.getBoundingClientRect(),p=e.current;if(p){let g=+((d.clientX-m.x)/p.clientWidth).toFixed(2);g>.9?g=1:g<.05?(g=0,s(!0)):s(!1),a(g)}},c=d=>{d.preventDefault();const h=.1;let m=i;d.deltaY>0?m-h>0?m-=h:m=0:m+h<1?m+=h:m=1,a(+m.toFixed(2))},u=()=>s(!r);return f.useEffect(()=>{if(e.current&&t){const d=i*100;e.current.style.background=u1(n.content_code,d),t.volume=i,s(i===0)}},[i,n]),f.useEffect(()=>{t&&(t.muted=r)},[r]),{volume:i,handleSetVolume:l,isMute:r,handleMute:u,handleWheel:c}}function yJ({audioEle:t}){const e=f.useRef(null),{handleMute:n,handleWheel:r,handleSetVolume:s,isMute:i}=gJ({audioEle:t,volumeLineRef:e}),a={before:"before:content-[''] before:w-[100%] before:h-[16px] before:absolute before:top-[50%] before:translate-y-[-50%]",volumeLineBase:"ml-1 w-full relative h-[4px] cursor-pointer rounded-full shadow-[2px_2px_10px_rgba(0,0,0,.15)]"};return o.jsxs("div",{className:"flex flex-grow items-center max-w-[120px] mr-2",children:[o.jsx("button",{onWheel:r,onClick:()=>n(),children:i?o.jsx(_M,{className:"w-6"}):o.jsx(xM,{className:"w-6"})}),o.jsx("div",{onClick:l=>s(l),ref:e,className:`${a.volumeLineBase} ${a.before}`,style:{background:"#e1e1e1"}})]})}function xJ({handlePlayPause:t,playStatus:e}){const n={icon:"w-[50px] sm:w-10"},r=()=>{switch(e){case"playing":return o.jsx(pv,{className:`${n.icon}`});case"error":return o.jsx(Gf,{className:`${n.icon}`});case"loading":case"waiting":return o.jsx(Lt,{className:`${n.icon} animate-spin`});case"paused":return o.jsx(gv,{className:`${n.icon}`})}};return o.jsx(o.Fragment,{children:o.jsx("button",{className:"p-1  inline-flex items-center justify-center",onClick:()=>t(),children:r()})})}function vJ(){const{isOpenFullScreen:t,audioRef:e}=Mt();if(!e.current)throw new Error("Use Control audioRef.current is undefined");const n=rn(),{theme:r}=O(),{user:s,updateUserData:i}=fe(),{queueSongs:a,currentSongData:l,currentQueueId:c}=ae(dt),{playStatus:u,triggerPlayStatus:d,isRepeat:h,isShuffle:m,isCrossFade:p}=ae(Kn),{currentPlaylist:g}=ae(vl),y=f.useRef(!0),_=f.useRef(),w=f.useRef(0),x=f.useRef(0),v=f.useRef(r.content_code),S=f.useRef(!1),E=f.useRef(!0),b=f.useRef(!1),I=f.useRef(!1),A=f.useRef(null),L=f.useRef(null),P=f.useRef("paused"),ce=f.useRef([]),K=qn(),{setErrorToast:Pe}=oe(),ie=f.useMemo(()=>K.pathname.includes("edit"),[K]),ke=f.useMemo(()=>cn(),[]),me=async B=>{try{if(y.current&&(y.current=!1,B)){const it=cn().current_time||0;e.current.currentTime=it}if(await e.current.play(),I.current=!1,b.current=!1,!s)return;E.current&&(p&&(e.current.volume=0),E.current=!1)}catch{}},Ge=()=>{e.current.pause()},F=B=>a[B],W=()=>{u==="playing"&&Ge(),u==="paused"&&me(!0)},q=()=>{n(Ze({playStatus:"paused"}))},ue=()=>{u!=="playing"&&n(Ze({playStatus:"playing"}))},Fe=()=>{if(!l)return;let B=l.index+1,Oe;B<a.length?Oe=a[B]:(B=0,Oe=a[0]),n(Ur(Oe.queue_id))},Ha=()=>{if(!l)return;let B=l.index-1,Oe;B>=0?Oe=a[B]:(Oe=a[a.length-1],B=a.length-1),n(Ur(Oe.queue_id))},hs=()=>{const B=!m;n(Ze({isShuffle:B})),lt("isShuffle",B)},Sl=()=>{let B;switch(h){case"no":B="one";break;case"one":B="all";break;case"all":B="no";break;default:B="no"}lt("isRepeat",B),n(Ze({isRepeat:B}))},gr=()=>{A.current&&L.current&&(L.current.innerText="0:00",A.current.style.background="rgba(255, 255, 255, 0.15)")},Wa=B=>{const Oe=B.target;if(A.current){const it=Oe.getBoundingClientRect(),Jn=(B.clientX-it.left)/A.current.offsetWidth,yr=Math.round(Jn*e.current.duration),qi=e.current.currentTime;if(w.current&&Math.abs(qi-w.current)<1&&Math.abs(yr-w.current)<1)return;Qu(yr),y.current?lt("current_time",yr):e.current.currentTime=yr,w.current=yr}},hP=B=>{const Oe=cn().volume||1;if(B<=2){const it=B/2*Oe;e.current.volume=it}else if(B<x.current){e.current.volume!=Oe&&(e.current.volume=Oe);return}if(B>=x.current){const it=(e.current.duration-B)/2*Oe;e.current.volume=it}},Qu=B=>{const Oe=A.current,it=L.current,St=B||e.current.currentTime;if(e.current.duration&&Oe){const Jn=St/(e.current.duration/100);Oe.style.background=u1(v.current,+Jn.toFixed(1))}it&&(it.innerText=ki(St)||"0:00")},P1=()=>{const B=e.current.currentTime;P.current!=="paused"&&n(Ze({playStatus:"playing"})),Qu(B),p&&hP(B),B&&Math.round(B)%3===0&&lt("current_time",Math.round(B))},F1=()=>{if(!_.current)return;const B=cn(),Oe=B.volume||1,it=B.timer;if(h==="one"&&it&&it!==1)return me();if(e.current.volume=Oe,b.current=!0,m){let St=_.current.index;for(;St===_.current.index;)St=Math.round(Math.random()*a.length-1);const Jn=F(St);return n(Ur(Jn.queue_id))}return it===1?S.current=!0:_.current.index===a.length-1&&(h==="all"?S.current=!1:S.current=!0),Fe()},D1=()=>{_.current&&n(Ze({playStatus:"loading"}))},O1=()=>{var it;if(!_.current)return;const B=e.current.duration,Oe=ke.current_queue_id;if(x.current=B-3,lt("current_queue_id",_.current.song.queue_id),S.current)return S.current=!1,n(Ze({playStatus:"paused"}));if((ie||y.current)&&(n(Ze({playStatus:"paused"})),y.current&&Oe===((it=_.current)==null?void 0:it.song.queue_id))){Qu(ke.current_time||0);return}if(_.current)if(s){const St=_.current.song.id,Jn=[...ce.current];if(!Jn.includes(St)){console.log("push recent songs");const qi={recent_song_ids:[...Jn,St]};i(qi),Qt({collectionName:"Users",data:qi,id:s.email})}}else{const St=cn()["recent-songs"]||[];St.find(yr=>{var qi;return yr.id===((qi=_.current)==null?void 0:qi.song.id)})||St.unshift(_.current.song),lt("recent-songs",St)}me()},M1=()=>{n(Ze({playStatus:"waiting"}))},L1=()=>{if(_.current){if(I.current||(I.current=!0,Pe("Found internet error")),!b.current)return n(Ze({playStatus:"error"}));if(a.length>1){if(_.current.index===a.length-1){n(Ze({playStatus:"error"}));return}Fe()}else n(Ze({playStatus:"error"}))}};return f.useEffect(()=>{s&&(ce.current=s.recent_song_ids)},[s]),f.useEffect(()=>{const B=ke.current_queue_id||null;B&&a.length?n(Ur(B)):y.current=!1},[]),f.useEffect(()=>(e.current.addEventListener("error",L1),e.current.addEventListener("pause",q),e.current.addEventListener("play",ue),e.current.addEventListener("loadstart",D1),e.current.addEventListener("loadedmetadata",O1),e.current.addEventListener("waiting",M1),()=>{var B,Oe,it,St,Jn,yr;(B=e.current)==null||B.removeEventListener("error",L1),(Oe=e.current)==null||Oe.removeEventListener("pause",q),(it=e.current)==null||it.removeEventListener("play",ue),(St=e.current)==null||St.removeEventListener("loadstart",D1),(Jn=e.current)==null||Jn.removeEventListener("loadedmetadata",O1),(yr=e.current)==null||yr.addEventListener("waiting",M1)}),[]),f.useEffect(()=>{if(!l||!c){P.current="paused",Ge();return}return e.current.src=l.song.song_url,_.current=l,()=>{gr(),E.current=!0}},[l==null?void 0:l.song]),f.useEffect(()=>{if(!l){u==="paused"&&gr();return}let B=`${l.song.name}`;u==="paused"&&g&&l.song.queue_id.includes(g.id)&&(B=`${g.name}`),document.title=B,P.current=u},[u]),f.useEffect(()=>{if(!(!d||d===u))switch(d){case"playing":me();break;case"paused":Ge();break}},[d]),f.useEffect(()=>(e.current.addEventListener("ended",F1),()=>{var B;return(B=e.current)==null?void 0:B.removeEventListener("ended",F1)}),[h,m,c,a]),f.useEffect(()=>(e.current.addEventListener("timeupdate",P1),()=>{var B;(B=e.current)==null||B.removeEventListener("timeupdate",P1)}),[p]),f.useEffect(()=>{_.current&&(t?v.current="#fff":v.current=r.content_code,Qu(y.current?ke.current_time:0))},[r,t]),f.useEffect(()=>{ie&&u==="playing"&&Ge()},[ie]),{isOpenFullScreen:t,timelineEleRef:A,currentTimeEleRef:L,handleSeek:Wa,playStatus:u,currentSongData:l,play:me,pause:Ge,handlePlayPause:W,isRepeat:h,isShuffle:m,isCrossFade:p,handlePrevious:Ha,handleRepeatSong:Sl,handleShuffle:hs,queueSongs:a,resetForNewSong:gr,handleNext:Fe}}function wJ({variant:t},e){var S;const{theme:n}=O(),{isOpenFullScreen:r,currentSongData:s,handleSeek:i,handlePlayPause:a,handleNext:l,handlePrevious:c,handleRepeatSong:u,handleShuffle:d,isRepeat:h,isShuffle:m,playStatus:p,queueSongs:g,currentTimeEleRef:y,timelineEleRef:_,resetForNewSong:w,pause:x}=vJ();f.useImperativeHandle(e,()=>({handlePlayPause:a,handleNext:l,pause:x,resetForNewSong:w}));const v={button:"p-1 rounded-full md:bg-transparent ",buttonsContainer:"w-full flex justify-center items-center mb-3 sm:mb-0 space-x-3",progressContainer:"flex w-full flex-row items-center ",processLineBase:"h-[6px] sm:h-1 flex-grow relative cursor-pointer rounded-[99px] shadow-[2px_2px_10px_rgba(0,0,0,.15)] ",icon:"w-[44px] sm:w-7",before:"before:content-[''] before:w-[100%] before:h-[24px] before:absolute before:top-[50%] before:translate-y-[-50%]"};return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:`${v.buttonsContainer}`,children:[o.jsxs("button",{disabled:g.length<=1,className:`relative ${v.button} ${h!=="no"&&n.content_text}`,onClick:u,children:[o.jsx($D,{className:v.icon}),o.jsx("span",{className:"absolute font-bold text-[12px] top-1/2 left-1/2 -translate-x-[50%] -translate-y-[50%] ",children:h==="one"?"1":h==="all"?"-":""})]}),o.jsx("button",{disabled:g.length<=1,className:v.button,onClick:()=>c(),children:o.jsx(cv,{className:v.icon})}),o.jsx(xJ,{playStatus:p,handlePlayPause:a}),o.jsx("button",{disabled:g.length<=1,className:`${v.button}`,onClick:()=>l(),children:o.jsx(Qf,{className:v.icon})}),o.jsx("button",{disabled:g.length<=1,className:`${v.button} ${m&&n.content_text}`,onClick:d,children:o.jsx(vI,{className:v.icon})})]}),o.jsxs("div",{className:`${v.progressContainer} ${t==="desktop"&&r?"mb-0":"mb-5 sm:mb-2"} ${p==="error"||p==="loading"?"disable":""}`,children:[o.jsx("div",{className:"w-[44px] sm:w-9",children:o.jsx("span",{ref:y,className:"text-lg sm:text-sm",children:"0:00"})}),o.jsx("div",{ref:_,style:{background:"rgba(255, 255, 255, 0.3)"},onClick:E=>i(E),className:`${v.processLineBase}  ${v.before}`}),o.jsx("div",{className:"w-[44px] sm:w-9 text-right",children:o.jsx("span",{className:"text-lg sm:text-sm",children:s!=null&&s.song?ki((S=s.song)==null?void 0:S.duration):"0:00"})})]})]})}const cP=f.forwardRef(wJ);function _J(){const{theme:t}=O(),e=f.useRef(null);return f.useEffect(()=>{if(e.current){if(!t.image){e.current.style.backgroundImage="";return}e.current.style.backgroundImage=`url(${t.image})`}},[t]),{containerRef:e}}function SJ(){const{audioRef:t,controlRef:e}=Mt();if(!t.current)throw new Error("useCountDown audioRef.current is undefined");const{playStatus:n}=ae(Kn),[r,s]=f.useState(0),[i,a]=f.useState(0),l=f.useRef(!1),c=d=>{lt("timer",0),s(0),l.current=!0,d&&a(0)},u=()=>{a(d=>d-1>0?(lt("timer",d-1),d-1):(c(),0))};return f.useEffect(()=>{const d=cn().timer||0;s(d),a(d)},[]),f.useEffect(()=>{if(r)return t.current.addEventListener("ended",u),()=>{t.current.removeEventListener("ended",u)}},[r]),f.useEffect(()=>{var d;r&&(i||(a(r),lt("timer",r),n==="paused"&&((d=e.current)==null||d.handlePlayPause())))},[r]),{countDown:i,clearTimer:c,setCountDown:a,setIsActive:s,isActive:r}}function uP(){const{theme:t}=O(),e=f.useRef(null),{countDown:n,isActive:r,clearTimer:s,setIsActive:i}=SJ(),a=u=>i(u),l=()=>{var u;r?s(!0):(u=e.current)==null||u.open()},c={container:"w-[54px] sm:w-[50px] flex justify-center",button:`rounded-[99px]  hover:bg-${t.alpha} p-[5px]`,itemContainer:"flex justify-between items-center min-h-[30px]",text:"text-base text-[#ccc]"};return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:c.container,children:r?o.jsx(Is,{content:"Clear timer",children:o.jsxs("button",{className:"group flex items-center",onClick:l,children:[o.jsx("span",{className:"text-base opacity-70 sm:text-sm group-hover:hidden",children:n.toString().padStart(2,"0")}),o.jsx("span",{className:`hidden group-hover:block ${c.button}`,children:o.jsx(Mi,{className:"w-8 sm:w-6"})})]})}):o.jsx(Is,{content:"Sleep timer",children:o.jsx("button",{onClick:l,className:c.button,children:o.jsx(SI,{className:"w-8 sm:w-6"})})})}),o.jsx(Ee,{ref:e,variant:"animation",children:o.jsx(ZM,{active:a,closeModal:()=>{var u;return(u=e.current)==null?void 0:u.close()}})})]})}function EJ(){const{audioRef:t,idle:e}=Mt();if(!t.current)throw new Error("BottomPlayer !audioRef.current");const{theme:n}=O(),{isOpenFullScreen:r,controlRef:s,isOpenSongQueue:i,setIsOpenFullScreen:a,setIsOpenSongQueue:l}=Mt(),{currentQueueId:c,currentSongData:u}=ae(dt),{containerRef:d}=_J(),h=qn(),m=f.useMemo(()=>h.pathname.includes("lyric"),[h]),p=()=>{i&&l(!1),a(!0)},g={wrapper:`hidden md:block border-${n.alpha} fixed bottom-0 w-full border-t transition-transform z-50 md:px-3 lg:px-6 h-[90px]`,container:"flex flex-row gap-[10px] h-full items-center",controlWrapper:`flex max-w-[420px] flex-grow ${r?"max-w-[600px] flex-col-reverse pb-[10px]":"flex-col justify-center"}`,right:"w-1/4 flex items-center justify-end",blurBg:`bg-opacity-[0.8] backdrop-blur-[15px] z-[-1] absolute inset-0 ${n.bottom_player_bg}`};return o.jsxs("div",{ref:d,className:`${g.wrapper} ${r?"border-transparent":n.image?n.bottom_player_bg:""} ${m&&"translate-y-[100%] "} `,children:[!n.image&&o.jsx("div",{className:`${g.blurBg} ${r?"opacity-0 transition-opacity delay-[.2s]":""}`}),o.jsxs("div",{className:`${g.container} ${r?"justify-center text-white":"justify-between"} ${e&&"transition-opacity duration-[.3s] opacity-0"}`,children:[o.jsx(pJ,{song:u==null?void 0:u.song,isOpenFullScreen:r}),o.jsx("div",{className:` ${g.controlWrapper} ${jc(c===null)}`,children:o.jsx(cP,{variant:"desktop",ref:s})}),o.jsxs("div",{className:`${g.right}  ${r?"hidden":""}`,children:[o.jsx(yJ,{audioEle:t.current}),o.jsxs("div",{className:`flex items-center ${c?"":"disable"}`,children:[o.jsx(Is,{content:"Fullscreen mode",children:o.jsx("button",{onClick:p,className:`rounded-[99px]  hover:bg-${n.alpha}  p-[5px]`,children:o.jsx(mO,{className:"w-6"})})}),o.jsx(Is,{content:"Queue",children:o.jsx("button",{onClick:()=>l(!i),className:`ml-1 hover:bg-${n.alpha} rounded-md p-[5px]`,children:o.jsx(uM,{className:"w-6"})})}),o.jsx("div",{className:`w-[2px] h-[26px] ml-2 bg-${n.alpha}`}),o.jsx(uP,{})]})]})]})]})}function bJ({isOpenFullScreen:t}){const e=f.useRef(null);f.useEffect(()=>{const r=e.current;r&&(t?(r.style.transform="translate(0)",r.style.zIndex="99"):(r.style.transform="translate(0, 100%)",setTimeout(()=>{r.style.zIndex="-10"},500)))},[t]);const n=()=>{const r=document.querySelector("body");r&&(t?r.style.overflow="hidden":r.style.overflow="auto")};return f.useEffect(()=>{n()},[t]),{wrapperRef:e}}function kJ({imageUrl:t,expand:e}){return o.jsx("div",{className:` ${e?"w-full h-auto px-10 sm:w-[60px] sm:h-[60px] sm:px-0":"w-[60px] h-[60px] p-0 flex-shrink-0"}`,children:o.jsx(ht,{src:t,className:"w-full rounded-md"})})}function TJ({song:t,theme:e,...n}){const{selectedSongs:r,selectSong:s}=il(),i=c=>{switch(n.variant){case"default":case"playing-next":return n.onClick(c);case"select":return s(t)}},a=f.useMemo(()=>n.variant!=="select"?!1:r.findIndex(c=>c.id===t.id)!=-1,[r]),l={itemContainer:`items-center justify-between cursor-pointer border-b 
    last:border-none border-white/10 flex rounded-md p-2`,button:`${e.content_bg} rounded-full`,songListButton:"mr-[10px] px-[5px]",imageFrame:"w-[54px] h-[54px] relative rounded-[4px] overflow-hidden flex-shrink-0",before:"after:content-[''] after:absolute after:h-[100%] after:w-[10px] after:right-[100%]"};return o.jsx(o.Fragment,{children:o.jsx("div",{onClick:i,className:`target-class opacity-100 transition-[opacity,transform] duration-500 ${l.itemContainer} `,children:o.jsx("div",{className:"flex",children:o.jsxs("div",{className:"flex-grow flex",children:[o.jsx("div",{className:`${l.imageFrame}  `,children:o.jsx(ht,{blurHashEncode:t.blurhash_encode,src:t.image_url})}),o.jsxs("div",{className:"ml-[10px]",children:[o.jsx("p",{className:`text-lg line-clamp-1 ${a&&e.content_text}`,children:t.name}),o.jsx("p",{className:"opacity-60 bg-blend-lighten line-clamp-1",children:t.singers.map((c,u)=>o.jsxs("span",{children:[" ",(u?", ":"")+c.name]},u))})]})]})})})})}const IJ=t=>{let e=0,n=t;for(;!n.classList.contains("target-class")&&e<5;)n=n.parentElement,e++;return n},dP={opacity:"0",transform:"translate(-100%, 0)"},CJ=t=>{let e=0,n=t.previousElementSibling;for(;n&&e<100;)Object.assign(n.style,dP),e++,n=n.previousElementSibling};function RJ({currentIndex:t}){const e=rn(),{theme:n}=O(),{queueSongs:r,isFetching:s}=ae(dt),i=(c,u)=>{const d=c.target,h=IJ(d);CJ(h),Object.assign(h.style,dP),setTimeout(()=>{e(Ur(u))},500)},a=[...Array(5).keys()].map(c=>o.jsx(te,{className:"h-[40px] mt-1"},c)),l=()=>o.jsx(o.Fragment,{children:t===r.length-1||r.length<=1?o.jsx("p",{children:"..."}):r.map((c,u)=>{if(u>t)return o.jsx(TJ,{variant:"playing-next",theme:n,song:c,onClick:d=>i(d,c.queue_id)},u)})});return o.jsx(o.Fragment,{children:o.jsxs(Nr,{children:[l(),s&&a]})})}function AJ(){const{controlRef:t,setIsOpenFullScreen:e,isOpenFullScreen:n,mobileActiveTab:r}=Mt(),{currentSongData:s}=ae(dt),{songBackground:i}=ae(Kn),a=f.useRef(null),{wrapperRef:l}=bJ({isOpenFullScreen:n}),c={headerWrapper:"flex mb-4",container:"flex-grow flex flex-col relative overflow-hidden",control:"flex flex-col-reverse justify-center",bgImage:"absolute inset-0 z-[-9] brightness-[70%] blur-[4px] translate-3d-0",button:"flex justify-center items-center rounded-full w-[38px]"};return o.jsx(o.Fragment,{children:o.jsxs("div",{ref:l,style:{transform:"translate(0, 100%)",zIndex:"-10"},className:"block md:hidden fixed inset-0 bg-zinc-900 text-white overflow-hidden transition-[transform] duration-[.3s] ease-linear",children:[i&&o.jsx("div",{className:c.bgImage,children:o.jsx(Jf,{width:"100%",height:"100%",hash:(s==null?void 0:s.song.blurhash_encode)||sP})}),o.jsxs("div",{className:"h-full z-10 p-4 flex flex-col",children:[o.jsxs("div",{className:c.headerWrapper,children:[o.jsxs(dr,{appendOnPortal:!0,children:[o.jsx(hr,{children:o.jsx("button",{className:`${c.button} p-[6px] left-0 bg-white/10`,children:o.jsx(uv,{className:"w-full"})})}),o.jsx(fr,{appendTo:"portal",position:"right-bottom",origin:"top left",children:o.jsx(lC,{})})]}),o.jsx(iP,{variant:"mobile"}),o.jsx("button",{className:`${c.button} p-[6px] bg-white/10`,onClick:()=>e(!1),children:o.jsx(wI,{className:"w-6"})})]}),o.jsxs("div",{ref:a,className:c.container,children:[o.jsxs("div",{className:`${r!="Playing"?"flex":"sm:flex"}`,children:[o.jsx(kJ,{expand:r==="Playing",imageUrl:s==null?void 0:s.song.image_url}),o.jsx("div",{className:`ml-2 ${r!="Playing"?"block":"hidden sm:block"}`,children:o.jsx("p",{className:"font-playwriteCU translate-y-[-6px] leading-[2.4] line-clamp-1",children:s==null?void 0:s.song.name})})]}),o.jsxs("div",{className:`mt-5 justify-between items-center ${r!="Playing"?"hidden":"flex sm:hidden"}`,children:[o.jsx("div",{className:"flex-grow",children:o.jsx("div",{className:"h-[40px]",children:o.jsx(lP,{className:"text-xl leading-[1.5] font-playwriteCU",content:(s==null?void 0:s.song.name)||"..."})})}),o.jsx(uP,{})]}),o.jsx(pI,{children:o.jsx(aP,{active:n&&r==="Lyric",className:`text-center ${r==="Lyric"?"flex-1 block":"hidden"}`})}),o.jsx("div",{className:`leading-[2.2] font-playwriteCU my-2 ${r==="Songs"?"":"hidden"}`,children:"Playing next"}),o.jsx("div",{className:`flex-grow no-scrollbar overflow-auto ${r==="Songs"?"":"hidden"}`,children:s&&o.jsx(RJ,{currentIndex:s.index})}),o.jsx("div",{className:`${c.control} ${r==="Songs"?"opacity-0 pointer-events-none h-[0px]":""} ${r==="Playing"?"flex-grow":""}`,children:o.jsx(cP,{variant:"mobile",ref:t})})]})]})]})})}const jJ=()=>{const{theme:t}=O(),{controlRef:e,isOpenFullScreen:n,setIsOpenFullScreen:r}=Mt(),{playStatus:s}=ae(Kn),{currentSongData:i}=ae(dt),a=qn(),l=f.useMemo(()=>a.pathname.includes("lyric"),[a]),c=f.useMemo(()=>{switch(s){case"playing":return o.jsx(pv,{className:"w-10"});case"error":return o.jsx(Gf,{className:"w-10"});case"loading":case"waiting":return o.jsx(Lt,{className:"w-10 animate-spin"});case"paused":return o.jsx(gv,{className:"w-10"})}},[s]),u={wrapper:`block md:hidden fixed bottom-0 transition-transform w-full h-[80px] border-t border-${t.alpha} z-40  px-4`,container:`absolute inset-0 ${t.bottom_player_bg} bg-opacity-[0.7] backdrop-blur-[15px] z-[-1]`,songImageWrapper:"flex flex-row items-center flex-grow h-full",image:"w-[54px] h-[54px] flex-shrink-0",cta:"pl-2 flex-shrink-0"};return o.jsxs("div",{className:`${u.wrapper} ${l?"translate-y-[100%]":""}`,children:[o.jsx("div",{className:`${u.container} ${n?"opacity-0 transition-opacity delay-[.3s]":""}`}),o.jsxs("div",{className:"flex items-center  h-full",children:[o.jsx("div",{onClick:()=>i!=null&&i.song.name?r(!0):{},className:"mobile-current-song flex-grow",children:o.jsxs("div",{className:u.songImageWrapper,children:[o.jsx("div",{className:u.image,children:o.jsx(ht,{src:i==null?void 0:i.song.image_url,className:"rounded-full"})}),o.jsx("div",{className:"flex-grow  ml-[10px]",children:(i==null?void 0:i.song.song_url)&&o.jsxs(o.Fragment,{children:[o.jsx("p",{className:"font-playwriteCU line-clamp-1",children:(i==null?void 0:i.song.name)||"..."}),o.jsx("p",{className:"opacity-70 text-sm line-clamp-1",children:i==null?void 0:i.song.singers.map((d,h)=>(h?", ":"")+d.name)})]})})]})}),o.jsxs("div",{className:`${u.cta} ${!(i!=null&&i.song.name)&&"disable"}`,children:[o.jsx("button",{className:"p-[4px]",onClick:()=>{var d;return(d=e.current)==null?void 0:d.handlePlayPause()},children:c}),o.jsx("button",{onClick:()=>{var d;return(d=e.current)==null?void 0:d.handleNext()},className:"p-[4px]",children:o.jsx(Qf,{className:"w-10"})})]})]})]})};function NJ(t,e){const{currentSongData:n}=ae(dt),{isOpenFullScreen:r,setIdle:s}=Mt(),[i,a]=f.useState(0),l=f.useRef(),c=f.useRef(),u=()=>{s(!1),a(Math.random())},d=()=>{clearTimeout(c.current),clearTimeout(l.current)},h=async()=>{if(!r)return;const m=document.querySelector(".song-thumb.active"),p=document.querySelector(".song-list-container");if(m&&p){const g=nx(m,p,!0);let y=h1.focusDelay;g||(y=0),l.current=setTimeout(()=>{s(!0)},y)}};if(f.useEffect(()=>{if(!(e||!n)){if(!r){s(!1);return}return setTimeout(()=>{window.addEventListener("mousemove",u),window.dispatchEvent(new Event("mousemove"))},1e3),()=>{window.removeEventListener("mousemove",u),d()}}},[r]),f.useEffect(()=>(c.current=setTimeout(()=>{h()},t),()=>{d()}),[i]),!r)return!1}const PJ=()=>{const{isOnMobile:t}=O(),{audioRef:e,setIsHasAudioEle:n}=Mt();NJ(h1.focusDelay,t);const r=e.current&&o.jsxs(o.Fragment,{children:[o.jsx(aJ,{}),o.jsx(dJ,{}),o.jsx(EJ,{})]}),s=e.current&&o.jsxs(o.Fragment,{children:[o.jsx(AJ,{}),o.jsx(jJ,{})]});return f.useEffect(()=>{e.current&&n(!0)},[]),o.jsxs(o.Fragment,{children:[o.jsx("audio",{ref:e,className:"hidden"}),e.current&&(t?s:r)]})};function FJ(){return o.jsx(ED,{children:o.jsx(PJ,{})})}function DJ({className:t}){const[e,n]=f.useState(!1),{theme:r}=O(),s=()=>{const a=document.querySelector(".main-container");if(!a)return;const l=a.scrollTop||0;n(l>100)},i=()=>{const a=document.querySelector(".main-container");a==null||a.scroll({behavior:"smooth",top:0})};return f.useEffect(()=>{const a=document.querySelector(".main-container");if(a)return a.addEventListener("scroll",s),()=>{a.removeEventListener("scroll",s)}},[]),o.jsx(ee,{onClick:i,variant:"circle",size:"clear",className:`absolute p-[8px] hover:scale-[1.05] transition-[opacity,transform] 
         ${t||""} 
         w-[36px] 
         ${r.content_hover_bg} h-[36px] bg-${r.alpha} 
      ${e?"opacity-[1]":"opacity-0 translate-y-[20px]"}`,children:o.jsx(DM,{className:"w-full"})})}function OJ(){const{theme:t}=O(),{user:e,loading:n}=fe(),r=qn(),s=nn(),i=()=>{s("/dashboard")},a=[...Array(2).keys()].map(c=>o.jsxs("div",{className:"px-3 w-full h-[51px] flex items-center",children:[o.jsx(te,{className:"w-[28px] h-[28px] mr-1 flex-shrink-0"}),o.jsx(te,{className:"w-[100px] h-[30px]"})]},c)),l={container:`w-[180px] relative  flex-shrink-0 border-r-[1px] h-screen ${t.side_bar_bg} border-${t.alpha}`,navItem:`  px-3 py-2 leading-[2.2] font-playwriteCU flex items-center ${t.content_hover_text}`,icon:"w-7 mr-2",link:"w-full border-l-[4px]",activeLink:`${t.content_text} ${t.container} ${t.content_border}  `};return o.jsxs("div",{className:`hidden md:block ${l.container} ${t.text_color}`,children:[o.jsx("div",{className:"px-[10px] h-[60px] flex items-center justify-center",children:o.jsxs(we,{to:"/",className:"text-[24px] font-[500]",children:["HD",o.jsx("span",{className:`${t.content_text} ml-[4px]`,children:"MP3"})]})}),o.jsxs("div",{className:"flex flex-col items-start",children:[n&&a,!n&&o.jsxs(o.Fragment,{children:[o.jsx(we,{className:`${l.link} ${r.pathname==="/"?l.activeLink:"border-transparent"}`,to:"/",children:o.jsxs("div",{className:l.navItem,children:[o.jsx(Xf,{className:l.icon}),o.jsx("span",{children:"Discover"})]})}),e&&o.jsxs(o.Fragment,{children:[o.jsx(we,{className:`${l.link}  ${r.pathname.includes("my-music")?l.activeLink:"border-transparent"}`,to:"/my-music",children:o.jsxs("div",{className:l.navItem,children:[o.jsx(Da,{className:l.icon}),o.jsx("span",{children:"My Song"})]})}),e.role==="ADMIN"&&o.jsx(we,{to:"/dashboard",className:`${l.link} border-transparent`,children:o.jsxs("div",{onClick:i,className:` ${l.navItem}`,children:[o.jsx(dv,{className:l.icon}),o.jsx("span",{className:"",children:"Dashboard"})]})})]})]})]}),o.jsx(DJ,{className:"left-[50%] translate-x-[-50%] bottom-[80px] md:bottom-[100px]"})]})}function MJ(){const[t,e]=f.useState(""),[n,r]=f.useState(!1),[s,i]=f.useState(!1),[a,l]=f.useState([]),c=f.useRef(null),u=f.useRef(null),d=f.useRef(null),h=f.useRef(!0),m=NT(),p=Gj(t,700),g=new AbortController,y=_=>{const w=document.querySelector(".popup-content"),x=_.target,v=document.querySelectorAll(".modal-content");let S=!1;v.forEach(E=>E.contains(x)?S=!0:{}),!(c.current&&u.current&&(c.current.contains(x)||S||u.current.contains(x)||w!=null&&w.contains(x)))&&i(!1)};return f.useEffect(()=>{if(!p.trim()){r(!1),l([]);return}const _=async()=>{try{r(!0);const w=_e(Tn,V("is_official","==",!0),V("name",">=",t),V("name","<=",t+"")),x=await In(w);l(x)}catch(w){console.log(w)}finally{r(!1)}};return h.current?_():h.current=!0,()=>{console.log("abort"),g.abort()}},[p]),f.useEffect(()=>(s&&document.addEventListener("click",y),()=>{document.removeEventListener("click",y)}),[s]),f.useEffect(()=>(e(m[0].get("q")||""),()=>{var _;h.current=!1,(_=d.current)==null||_.blur(),i(!1)}),[m[0].get("q")]),f.useEffect(()=>{m[0].get("q")!==t&&s&&(h.current=!0)},[t,s]),{isFetching:n,searchResult:a,value:t,setValue:e,isFocus:s,setIsFocus:i,formRef:c,searchResultRef:u,inputRef:d}}function LJ({songs:t}){const{handleSetSong:e}=Us({variant:"search-bar"}),{getRecommend:n}=y1(),r=s=>{e(s.queue_id,[s]),n(s)};return o.jsx(Nr,{children:t.length?o.jsx(Vs,{isHasCheckBox:!1,setSong:r,songs:t}):o.jsx(Xe,{})})}function $J(){const t={listWrapper:"[&>*]:px-3 *:text-sm [&>*]:py-2 [&>*]:flex [&>*]:items-center [&>*]:space-x-1 [&>*]:rounded-md "};return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"text-sm font-[500] mb-2",children:"Suggestion keyword"}),o.jsx("div",{className:t.listWrapper,children:o.jsxs(we,{to:"/search?q=nhac-tet",children:[o.jsx(vI,{className:"w-5"}),o.jsx("span",{children:"Nhac tet"})]})})]})}function zJ(){const{theme:t}=O(),e=nn(),{isFetching:n,inputRef:r,formRef:s,searchResultRef:i,value:a,searchResult:l,setIsFocus:c,isFocus:u,setValue:d}=MJ(),h={container:`relative h-[40px] flex px-3 w-[300px] ${t.text_color} shadow-md`,unFocusContainer:`bg-${t.alpha} rounded-[20px]`,focusedContainer:`${t.type==="dark"?t.modal_bg:t.side_bar_bg} rounded-[20px_20px_0_0]`,input:`bg-transparent outline-none  w-full ${t.type==="light"?"placeholder:text-black":"placeholder:text-white"}`,searchResultContainer:`${t.type==="dark"?t.modal_bg:t.side_bar_bg} shadow-md  rounded-[0_0_20px_20px] p-3 position absolute top-full left-0 w-full max-h-[60vh] overflow-hidden flex flex-col`},m=async p=>{p.preventDefault(),e(`/search?q=${a}`),c(!1)};return o.jsx(o.Fragment,{children:o.jsxs("form",{ref:s,onSubmit:m,className:`${h.container} ${u?h.focusedContainer:h.unFocusContainer}`,children:[o.jsx("button",{className:"mr-2",children:o.jsx(fv,{className:"w-6"})}),o.jsx("input",{ref:r,value:a,onFocus:()=>c(!0),onChange:p=>d(p.target.value.trim()),placeholder:"Nhac tet...",className:h.input,type:"text"}),o.jsx("button",{type:"button",onClick:()=>d(""),className:`${a?"opacity-100":"!opacity-0"} ${jc(!a)}`,children:n?o.jsx(Lt,{className:"w-5 animate-spin"}):o.jsx(Mi,{className:"w-5"})}),o.jsx("div",{ref:i,className:`${Nc(!u)} ${h.searchResultContainer}`,children:l.length?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"text-sm font-[500] mb-2",children:"Suggestion results"}),o.jsx("div",{className:"overflow-auto no-scrollbar",children:o.jsx(LJ,{songs:l})})]}):o.jsx($J,{})})]})})}function BJ({contentRef:t}){const{theme:e}=O(),[n,r]=f.useState(0),[s,i]=Xv(Ia),[a,l]=f.useState(""),c=f.useRef(null),u=f.useRef(null),d=f.useRef(null),{action:h}=fp(),m=v=>{var S,E;l(v),(S=d.current)==null||S.toggle(),(E=c.current)==null||E.close()},p=async()=>{var v;try{await h("logout")}catch(S){console.log("signOut error",{message:S})}finally{(v=d.current)==null||v.toggle()}},g=async()=>{var v;try{(v=u.current)==null||v.close(),await h("login")}catch(S){console.log({message:S})}},y=()=>{var S;const v=((S=t.current)==null?void 0:S.scrollTop)||0;r(v)},_=o.jsx(te,{className:"h-[40px] w-[40px] rounded-full"}),w=f.useMemo(()=>{switch(a){case"":return o.jsx(o.Fragment,{});case"theme":return o.jsx(wv,{close:()=>{var v;return(v=d.current)==null?void 0:v.toggle()}});case"info":return o.jsx(vv,{close:()=>{var v;return(v=d.current)==null?void 0:v.toggle()}});case"confirm":return o.jsx(Li,{close:()=>{var v;return(v=d.current)==null?void 0:v.toggle()},callback:p,loading:!1,label:"Sign out ?"})}},[a]);f.useEffect(()=>{var v;return(v=t.current)==null||v.addEventListener("scroll",y),()=>{document.removeEventListener("scroll",y)}},[]);const x={userName:"text-[16px] font-[500] ml-[8px] line-clamp-1",button:"h-[40px] w-[40px] rounded-full",menuItem:"hover:bg-white/5 rounded-[4px] w-full text-sm px-[10px] h-[44px] inline-flex items-center font-[500]",icon:"w-5 mr-1",divide:`h-[1px]  w-[calc(100%-20px)] mb-[10px] mt-[20px] mx-auto bg-${e.alpha}`};return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:`hidden md:block h-[60px] fixed top-0 right-0 left-[180px] z-[20]  ${n?"shadow-lg":"bg-transparent"}`,children:[o.jsx("div",{className:`${n?"":"hidden "} absolute inset-0 ${e.container} bg-opacity-[0.9] backdrop-blur-[15px] z-[-1] `}),o.jsxs("div",{className:"px-[40px] items-center flex h-full",children:[o.jsx(nP,{className:"mr-5"}),o.jsx(zJ,{}),o.jsxs("div",{className:"flex space-x-3 ml-auto",children:[o.jsxs(dr,{children:[o.jsx(hr,{ref:c,children:o.jsx(Is,{isWrapped:!0,position:"top-[calc(100%+8px)]",content:"Settings",children:o.jsx("button",{className:`flex px-[6px] items-center ${x.button} bg-${e.alpha} ${e.content_hover_bg}`,children:o.jsx(mu,{className:"w-full"})})})}),o.jsx(fr,{appendTo:"parent",className:"top-[calc(100%+8px)] right-0",animationClassName:"origin-top-right",children:o.jsx(aC,{openModal:m,variant:"client"})})]}),o.jsxs(dr,{children:[o.jsx(hr,{ref:u,className:"flex items-center",children:o.jsx("button",{className:"flex hover:brightness-90",children:i?_:o.jsx($y,{className:"w-[40px] h-[40px]"})})}),o.jsx(fr,{appendTo:"parent",className:"top-[calc(100%+8px)] right-0",animationClassName:"origin-top-right",children:o.jsx(zs,{theme:e,children:o.jsxs("div",{className:"w-[250px] max-h-[50vh]",children:[s&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex items-center p-[10px] pb-0",children:[o.jsx($y,{className:"login-trigger w-[46px] h-[46px]"}),o.jsx("div",{className:"ml-[12px]",children:o.jsx("h5",{className:"font-semibold line-clamp-1",children:s==null?void 0:s.displayName})})]}),o.jsx("div",{className:x.divide}),o.jsxs("button",{className:`${x.menuItem}`,onClick:()=>m("confirm"),children:[o.jsx(ov,{className:x.icon}),"Log out"]})]}),!s&&o.jsxs("button",{className:`${x.menuItem}`,onClick:g,children:[o.jsx(FD,{className:x.icon}),"Log in"]})]})})})]})]})]})]}),o.jsx(Ee,{variant:"animation",ref:d,children:w})]})}function UJ(){const{user:t,setUser:e}=fe(),{isDev:n}=O(),{uploadedSongs:r,setUploadedSongs:s,shouldFetchFavoriteSongs:i}=Cn(),{setIsUploading:a,isUploading:l,setUploadingSongs:c,resetUploadContext:u}=hI(),[d,h]=f.useState(""),m=f.useRef(null),{setErrorToast:p,setSuccessToast:g}=oe(),y=()=>{const w=m.current;w&&(w.value=""),u()},_=async w=>{try{if(!t)return;const x=[],v=[],S=w.target.files;if(!S.length)return;const E=[],b=[],I=Date.now(),A=K=>r.some(Pe=>Pe.size===K.size)||E.some(Pe=>Pe.size===K.size);for(let K=0;K<=S.length-1;K++){const Pe=S[K],ie=await GN(Pe);if(!ie)continue;const ke={name:ie.singer,created_at:""},me={...cf(ke),id:""},Ge={name:ie.name,singers:[me],duration:Math.floor(ie.duration),size:Math.floor(Pe.size/1024)},F=ie.image?new Blob([ie.image]):null;F&&(v.push(F),Ge.image_url=URL.createObjectURL(F));const W=By({...Ge,owner_email:t.email,distributor:t.display_name});if(A(W)){console.log(">>>duplicate");continue}E.push(W),x.push(K)}if(r.length+x.length>5)return h("You have reach the upload limit");if(!E.length)return;c(E),a(!0);for(let K=0;K<x.length;K++){const Pe=x[K],ie=v[K],ke={...E[K]},{filePath:me,fileURL:Ge}=await c1({file:S[Pe],folder:"/songs/",namePrefix:t.email,msg:">>> api: upload song file"});if(ie){const ue=await Hi({blob:ie});Object.assign(ke,ue)}Object.assign(ke,{song_file_path:me,song_url:Ge});const F=await Vi({collectionName:"Songs",data:ke,msg:">>> api: set song doc"}),W=await zu(F);b.push(W.id);const q={...W.data(),id:F.id,queue_id:Uu(4)};s(ue=>[...ue,q]),c(ue=>{const Fe=[...ue];return Fe.shift,Fe})}const P={liked_song_ids:[...b,...t.liked_song_ids]};await Qt({collectionName:"Users",data:P,id:t.email}),e({...t,...P}),i.current=!0,g(`${E.length} songs uploaded`);const ce=Date.now();n&&console.log(">>> upload songs finished after",(ce-I)/1e3)}catch(x){console.log({message:x}),p(d)}finally{y()}};return f.useEffect(()=>{if(!l)return;const w=document.querySelector(".temp-song");w&&w.scrollIntoView({behavior:"smooth",block:"center"})},[l]),{handleInputChange:_,inputRef:m}}function VJ(){const{handleInputChange:t,inputRef:e}=UJ(),n={container:"upload portal fixed z-[199] bottom-[120px] right-[30px] max-[549px]:bottom-[unset] max-[540px]:top-[10px] max-[540px]:right-[10px]"};return o.jsx(o.Fragment,{children:tl.createPortal(o.jsx("div",{className:n.container,children:o.jsx("input",{ref:e,onChange:t,type:"file",multiple:!0,accept:"audio",id:"song_upload",className:"hidden"})}),document.getElementById("portals"))})}function HJ(){const{theme:t}=O(),e=f.useRef(null),n={page:`md:flex md:h-screen md:overflow-hidden ${t.container} ${t.text_color}`,container:"h-full md:w-full md:flex md:flex-col px-[10px] md:px-[40px] pt-[30px] md:pt-[60px] md:overflow-auto"};return f.useEffect(()=>{const r=document.querySelector(".my-tag"),s=document.querySelector("body");s.style.backgroundColor=t.container_code,r&&r.setAttribute("content",t.container_code)},[t]),o.jsx(o.Fragment,{children:o.jsxs(uI,{children:[o.jsxs("div",{className:`${n.page}`,children:[o.jsx(OJ,{}),o.jsxs("div",{ref:e,className:n.container,children:[o.jsx(BJ,{contentRef:e}),o.jsx($f,{})]}),o.jsx(FJ,{})]}),o.jsx(rP,{className:"left-[50%] translate-x-[-50%] top-[10px] md:top-[unset] md:bottom-[100px] md:left-[20px] md:translate-x-0"}),o.jsx(VJ,{}),o.jsx(cI,{})]})})}function Gg({children:t}){return t}function WJ(){return o.jsx(o.Fragment,{children:o.jsx(D3,{children:o.jsxs(C3,{children:[o.jsx(Or,{path:"*",element:o.jsx(aG,{})}),o.jsx(Or,{path:"/login",element:o.jsx(lG,{})}),o.jsxs(Or,{element:o.jsx(HJ,{}),children:[HY.map((t,e)=>{const n=t.layout||Gg,r=t.component;return o.jsx(Or,{path:t.path,element:o.jsx(n,{children:o.jsx(r,{})})},e)}),o.jsx(Or,{element:o.jsx(GY,{}),children:WY.map((t,e)=>{const n=t.layout||Gg,r=t.component;return o.jsx(Or,{path:t.path,element:o.jsx(n,{children:o.jsx(r,{})})},e)})})]}),o.jsx(Or,{element:o.jsx(QY,{}),children:o.jsx(Or,{element:o.jsx(ZY,{}),children:qY.map((t,e)=>{const n=t.layout||Gg,r=t.component;return o.jsx(Or,{path:t.path,element:o.jsx(n,{children:o.jsx(r,{})})},e)})})})]})})})}const qJ=$6({reducer:{currentPlaylist:CW,playStatus:Y6,songQueue:n$},middleware:t=>t({serializableCheck:!1})});function GJ(){const{setUser:t,setLoading:e,loading:n,user:r}=fe(),{getPlaylist:s}=sN();return f.useEffect(()=>{(async()=>{Ia.onAuthStateChanged(async a=>{if(a&&a.email){const l=await ss({collectionName:"Users",id:a.email}),c=l.data(),u={email:a.email,display_name:a.displayName,photo_url:a.photoURL,liked_song_ids:c.liked_song_ids||[],recent_playlist_ids:c.recent_playlist_ids||[],recent_song_ids:c.recent_song_ids||[],liked_singer_ids:c.liked_singer_ids||[],role:c.role||"USER",liked_playlist_ids:c.liked_playlist_ids||[]};l.exists()?await s():await Vi({collectionName:"Users",data:u}),t(u)}else t(null);e(!1)})})()},[]),{user:r,loading:n}}function QJ({children:t}){return GJ(),t}Qg.createRoot(document.getElementById("root")).render(o.jsx(vk.StrictMode,{children:o.jsx(s6,{store:qJ,children:o.jsx(U3,{children:o.jsx(mD,{children:o.jsx(H3,{children:o.jsx(gD,{children:o.jsx(vD,{children:o.jsx(QJ,{children:o.jsx(WJ,{})})})})})})})})}));
