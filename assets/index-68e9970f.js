function G4(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();function Hb(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var qb={exports:{}},gf={},Gb={exports:{}},ge={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xc=Symbol.for("react.element"),K4=Symbol.for("react.portal"),X4=Symbol.for("react.fragment"),Q4=Symbol.for("react.strict_mode"),Y4=Symbol.for("react.profiler"),J4=Symbol.for("react.provider"),Z4=Symbol.for("react.context"),eN=Symbol.for("react.forward_ref"),tN=Symbol.for("react.suspense"),nN=Symbol.for("react.memo"),rN=Symbol.for("react.lazy"),aw=Symbol.iterator;function iN(t){return t===null||typeof t!="object"?null:(t=aw&&t[aw]||t["@@iterator"],typeof t=="function"?t:null)}var Kb={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Xb=Object.assign,Qb={};function Ha(t,e,n){this.props=t,this.context=e,this.refs=Qb,this.updater=n||Kb}Ha.prototype.isReactComponent={};Ha.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Ha.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Yb(){}Yb.prototype=Ha.prototype;function Hy(t,e,n){this.props=t,this.context=e,this.refs=Qb,this.updater=n||Kb}var qy=Hy.prototype=new Yb;qy.constructor=Hy;Xb(qy,Ha.prototype);qy.isPureReactComponent=!0;var lw=Array.isArray,Jb=Object.prototype.hasOwnProperty,Gy={current:null},Zb={key:!0,ref:!0,__self:!0,__source:!0};function ek(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)Jb.call(e,r)&&!Zb.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];i.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:Xc,type:t,key:s,ref:o,props:i,_owner:Gy.current}}function sN(t,e){return{$$typeof:Xc,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Ky(t){return typeof t=="object"&&t!==null&&t.$$typeof===Xc}function oN(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var cw=/\/+/g;function rp(t,e){return typeof t=="object"&&t!==null&&t.key!=null?oN(""+t.key):e.toString(36)}function xd(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Xc:case K4:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+rp(o,0):r,lw(i)?(n="",t!=null&&(n=t.replace(cw,"$&/")+"/"),xd(i,e,n,"",function(c){return c})):i!=null&&(Ky(i)&&(i=sN(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(cw,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",lw(t))for(var a=0;a<t.length;a++){s=t[a];var l=r+rp(s,a);o+=xd(s,e,n,l,i)}else if(l=iN(t),typeof l=="function")for(t=l.call(t),a=0;!(s=t.next()).done;)s=s.value,l=r+rp(s,a++),o+=xd(s,e,n,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Pu(t,e,n){if(t==null)return t;var r=[],i=0;return xd(t,r,"","",function(s){return e.call(n,s,i++)}),r}function aN(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var an={current:null},wd={transition:null},lN={ReactCurrentDispatcher:an,ReactCurrentBatchConfig:wd,ReactCurrentOwner:Gy};ge.Children={map:Pu,forEach:function(t,e,n){Pu(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Pu(t,function(){e++}),e},toArray:function(t){return Pu(t,function(e){return e})||[]},only:function(t){if(!Ky(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ge.Component=Ha;ge.Fragment=X4;ge.Profiler=Y4;ge.PureComponent=Hy;ge.StrictMode=Q4;ge.Suspense=tN;ge.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=lN;ge.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Xb({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=Gy.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)Jb.call(e,l)&&!Zb.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];r.children=a}return{$$typeof:Xc,type:t.type,key:i,ref:s,props:r,_owner:o}};ge.createContext=function(t){return t={$$typeof:Z4,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:J4,_context:t},t.Consumer=t};ge.createElement=ek;ge.createFactory=function(t){var e=ek.bind(null,t);return e.type=t,e};ge.createRef=function(){return{current:null}};ge.forwardRef=function(t){return{$$typeof:eN,render:t}};ge.isValidElement=Ky;ge.lazy=function(t){return{$$typeof:rN,_payload:{_status:-1,_result:t},_init:aN}};ge.memo=function(t,e){return{$$typeof:nN,type:t,compare:e===void 0?null:e}};ge.startTransition=function(t){var e=wd.transition;wd.transition={};try{t()}finally{wd.transition=e}};ge.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};ge.useCallback=function(t,e){return an.current.useCallback(t,e)};ge.useContext=function(t){return an.current.useContext(t)};ge.useDebugValue=function(){};ge.useDeferredValue=function(t){return an.current.useDeferredValue(t)};ge.useEffect=function(t,e){return an.current.useEffect(t,e)};ge.useId=function(){return an.current.useId()};ge.useImperativeHandle=function(t,e,n){return an.current.useImperativeHandle(t,e,n)};ge.useInsertionEffect=function(t,e){return an.current.useInsertionEffect(t,e)};ge.useLayoutEffect=function(t,e){return an.current.useLayoutEffect(t,e)};ge.useMemo=function(t,e){return an.current.useMemo(t,e)};ge.useReducer=function(t,e,n){return an.current.useReducer(t,e,n)};ge.useRef=function(t){return an.current.useRef(t)};ge.useState=function(t){return an.current.useState(t)};ge.useSyncExternalStore=function(t,e,n){return an.current.useSyncExternalStore(t,e,n)};ge.useTransition=function(){return an.current.useTransition()};ge.version="18.2.0";Gb.exports=ge;var f=Gb.exports;const tk=Hb(f),Xy=G4({__proto__:null,default:tk},[f]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cN=f,uN=Symbol.for("react.element"),dN=Symbol.for("react.fragment"),hN=Object.prototype.hasOwnProperty,fN=cN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,mN={key:!0,ref:!0,__self:!0,__source:!0};function nk(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)hN.call(e,r)&&!mN.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:uN,type:t,key:s,ref:o,props:i,_owner:fN.current}}gf.Fragment=dN;gf.jsx=nk;gf.jsxs=nk;qb.exports=gf;var u=qb.exports;var Og={},rk={exports:{}},Fn={},ik={exports:{}},sk={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(I,$){var q=I.length;I.push($);e:for(;0<q;){var j=q-1>>>1,G=I[j];if(0<i(G,$))I[j]=$,I[q]=G,q=j;else break e}}function n(I){return I.length===0?null:I[0]}function r(I){if(I.length===0)return null;var $=I[0],q=I.pop();if(q!==$){I[0]=q;e:for(var j=0,G=I.length,ee=G>>>1;j<ee;){var ie=2*(j+1)-1,De=I[ie],Se=ie+1,je=I[Se];if(0>i(De,q))Se<G&&0>i(je,De)?(I[j]=je,I[Se]=q,j=Se):(I[j]=De,I[ie]=q,j=ie);else if(Se<G&&0>i(je,q))I[j]=je,I[Se]=q,j=Se;else break e}}return $}function i(I,$){var q=I.sortIndex-$.sortIndex;return q!==0?q:I.id-$.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],c=[],d=1,h=null,m=3,p=!1,y=!1,x=!1,E=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,g=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(I){for(var $=n(c);$!==null;){if($.callback===null)r(c);else if($.startTime<=I)r(c),$.sortIndex=$.expirationTime,e(l,$);else break;$=n(c)}}function _(I){if(x=!1,w(I),!y)if(n(l)!==null)y=!0,K(S);else{var $=n(c);$!==null&&fe(_,$.startTime-I)}}function S(I,$){y=!1,x&&(x=!1,v(k),k=-1),p=!0;var q=m;try{for(w($),h=n(l);h!==null&&(!(h.expirationTime>$)||I&&!O());){var j=h.callback;if(typeof j=="function"){h.callback=null,m=h.priorityLevel;var G=j(h.expirationTime<=$);$=t.unstable_now(),typeof G=="function"?h.callback=G:h===n(l)&&r(l),w($)}else r(l);h=n(l)}if(h!==null)var ee=!0;else{var ie=n(c);ie!==null&&fe(_,ie.startTime-$),ee=!1}return ee}finally{h=null,m=q,p=!1}}var T=!1,b=null,k=-1,R=5,P=-1;function O(){return!(t.unstable_now()-P<R)}function W(){if(b!==null){var I=t.unstable_now();P=I;var $=!0;try{$=b(!0,I)}finally{$?L():(T=!1,b=null)}}else T=!1}var L;if(typeof g=="function")L=function(){g(W)};else if(typeof MessageChannel<"u"){var z=new MessageChannel,H=z.port2;z.port1.onmessage=W,L=function(){H.postMessage(null)}}else L=function(){E(W,0)};function K(I){b=I,T||(T=!0,L())}function fe(I,$){k=E(function(){I(t.unstable_now())},$)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(I){I.callback=null},t.unstable_continueExecution=function(){y||p||(y=!0,K(S))},t.unstable_forceFrameRate=function(I){0>I||125<I?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<I?Math.floor(1e3/I):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(I){switch(m){case 1:case 2:case 3:var $=3;break;default:$=m}var q=m;m=$;try{return I()}finally{m=q}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(I,$){switch(I){case 1:case 2:case 3:case 4:case 5:break;default:I=3}var q=m;m=I;try{return $()}finally{m=q}},t.unstable_scheduleCallback=function(I,$,q){var j=t.unstable_now();switch(typeof q=="object"&&q!==null?(q=q.delay,q=typeof q=="number"&&0<q?j+q:j):q=j,I){case 1:var G=-1;break;case 2:G=250;break;case 5:G=1073741823;break;case 4:G=1e4;break;default:G=5e3}return G=q+G,I={id:d++,callback:$,priorityLevel:I,startTime:q,expirationTime:G,sortIndex:-1},q>j?(I.sortIndex=q,e(c,I),n(l)===null&&I===n(c)&&(x?(v(k),k=-1):x=!0,fe(_,q-j))):(I.sortIndex=G,e(l,I),y||p||(y=!0,K(S))),I},t.unstable_shouldYield=O,t.unstable_wrapCallback=function(I){var $=m;return function(){var q=m;m=$;try{return I.apply(this,arguments)}finally{m=q}}}})(sk);ik.exports=sk;var pN=ik.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ok=f,jn=pN;function M(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var ak=new Set,ec={};function yo(t,e){ya(t,e),ya(t+"Capture",e)}function ya(t,e){for(ec[t]=e,t=0;t<e.length;t++)ak.add(e[t])}var ai=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Mg=Object.prototype.hasOwnProperty,gN=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,uw={},dw={};function yN(t){return Mg.call(dw,t)?!0:Mg.call(uw,t)?!1:gN.test(t)?dw[t]=!0:(uw[t]=!0,!1)}function vN(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function xN(t,e,n,r){if(e===null||typeof e>"u"||vN(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function ln(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var jt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){jt[t]=new ln(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];jt[e]=new ln(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){jt[t]=new ln(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){jt[t]=new ln(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){jt[t]=new ln(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){jt[t]=new ln(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){jt[t]=new ln(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){jt[t]=new ln(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){jt[t]=new ln(t,5,!1,t.toLowerCase(),null,!1,!1)});var Qy=/[\-:]([a-z])/g;function Yy(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Qy,Yy);jt[e]=new ln(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Qy,Yy);jt[e]=new ln(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Qy,Yy);jt[e]=new ln(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){jt[t]=new ln(t,1,!1,t.toLowerCase(),null,!1,!1)});jt.xlinkHref=new ln("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){jt[t]=new ln(t,1,!1,t.toLowerCase(),null,!0,!0)});function Jy(t,e,n,r){var i=jt.hasOwnProperty(e)?jt[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(xN(e,n,i,r)&&(n=null),r||i===null?yN(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var yi=ok.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Nu=Symbol.for("react.element"),Bo=Symbol.for("react.portal"),Vo=Symbol.for("react.fragment"),Zy=Symbol.for("react.strict_mode"),Lg=Symbol.for("react.profiler"),lk=Symbol.for("react.provider"),ck=Symbol.for("react.context"),ev=Symbol.for("react.forward_ref"),Fg=Symbol.for("react.suspense"),$g=Symbol.for("react.suspense_list"),tv=Symbol.for("react.memo"),Ii=Symbol.for("react.lazy"),uk=Symbol.for("react.offscreen"),hw=Symbol.iterator;function ul(t){return t===null||typeof t!="object"?null:(t=hw&&t[hw]||t["@@iterator"],typeof t=="function"?t:null)}var Ge=Object.assign,ip;function bl(t){if(ip===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);ip=e&&e[1]||""}return`
`+ip+t}var sp=!1;function op(t,e){if(!t||sp)return"";sp=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){r=c}t.call(e.prototype)}else{try{throw Error()}catch(c){r=c}t()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var l=`
`+i[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{sp=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?bl(t):""}function wN(t){switch(t.tag){case 5:return bl(t.type);case 16:return bl("Lazy");case 13:return bl("Suspense");case 19:return bl("SuspenseList");case 0:case 2:case 15:return t=op(t.type,!1),t;case 11:return t=op(t.type.render,!1),t;case 1:return t=op(t.type,!0),t;default:return""}}function zg(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Vo:return"Fragment";case Bo:return"Portal";case Lg:return"Profiler";case Zy:return"StrictMode";case Fg:return"Suspense";case $g:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case ck:return(t.displayName||"Context")+".Consumer";case lk:return(t._context.displayName||"Context")+".Provider";case ev:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case tv:return e=t.displayName||null,e!==null?e:zg(t.type)||"Memo";case Ii:e=t._payload,t=t._init;try{return zg(t(e))}catch{}}return null}function _N(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return zg(e);case 8:return e===Zy?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function rs(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function dk(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function EN(t){var e=dk(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Du(t){t._valueTracker||(t._valueTracker=EN(t))}function hk(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=dk(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Hd(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Bg(t,e){var n=e.checked;return Ge({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function fw(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=rs(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function fk(t,e){e=e.checked,e!=null&&Jy(t,"checked",e,!1)}function Vg(t,e){fk(t,e);var n=rs(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Ug(t,e.type,n):e.hasOwnProperty("defaultValue")&&Ug(t,e.type,rs(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function mw(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Ug(t,e,n){(e!=="number"||Hd(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var kl=Array.isArray;function na(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+rs(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Wg(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(M(91));return Ge({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function pw(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(M(92));if(kl(n)){if(1<n.length)throw Error(M(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:rs(n)}}function mk(t,e){var n=rs(e.value),r=rs(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function gw(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function pk(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Hg(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?pk(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var ju,gk=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(ju=ju||document.createElement("div"),ju.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=ju.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function tc(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Ol={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},SN=["Webkit","ms","Moz","O"];Object.keys(Ol).forEach(function(t){SN.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Ol[e]=Ol[t]})});function yk(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Ol.hasOwnProperty(t)&&Ol[t]?(""+e).trim():e+"px"}function vk(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=yk(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var bN=Ge({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function qg(t,e){if(e){if(bN[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(M(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(M(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(M(61))}if(e.style!=null&&typeof e.style!="object")throw Error(M(62))}}function Gg(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Kg=null;function nv(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Xg=null,ra=null,ia=null;function yw(t){if(t=Jc(t)){if(typeof Xg!="function")throw Error(M(280));var e=t.stateNode;e&&(e=_f(e),Xg(t.stateNode,t.type,e))}}function xk(t){ra?ia?ia.push(t):ia=[t]:ra=t}function wk(){if(ra){var t=ra,e=ia;if(ia=ra=null,yw(t),e)for(t=0;t<e.length;t++)yw(e[t])}}function _k(t,e){return t(e)}function Ek(){}var ap=!1;function Sk(t,e,n){if(ap)return t(e,n);ap=!0;try{return _k(t,e,n)}finally{ap=!1,(ra!==null||ia!==null)&&(Ek(),wk())}}function nc(t,e){var n=t.stateNode;if(n===null)return null;var r=_f(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(M(231,e,typeof n));return n}var Qg=!1;if(ai)try{var dl={};Object.defineProperty(dl,"passive",{get:function(){Qg=!0}}),window.addEventListener("test",dl,dl),window.removeEventListener("test",dl,dl)}catch{Qg=!1}function kN(t,e,n,r,i,s,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(d){this.onError(d)}}var Ml=!1,qd=null,Gd=!1,Yg=null,TN={onError:function(t){Ml=!0,qd=t}};function IN(t,e,n,r,i,s,o,a,l){Ml=!1,qd=null,kN.apply(TN,arguments)}function CN(t,e,n,r,i,s,o,a,l){if(IN.apply(this,arguments),Ml){if(Ml){var c=qd;Ml=!1,qd=null}else throw Error(M(198));Gd||(Gd=!0,Yg=c)}}function vo(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function bk(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function vw(t){if(vo(t)!==t)throw Error(M(188))}function AN(t){var e=t.alternate;if(!e){if(e=vo(t),e===null)throw Error(M(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return vw(i),t;if(s===r)return vw(i),e;s=s.sibling}throw Error(M(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o)throw Error(M(189))}}if(n.alternate!==r)throw Error(M(190))}if(n.tag!==3)throw Error(M(188));return n.stateNode.current===n?t:e}function kk(t){return t=AN(t),t!==null?Tk(t):null}function Tk(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Tk(t);if(e!==null)return e;t=t.sibling}return null}var Ik=jn.unstable_scheduleCallback,xw=jn.unstable_cancelCallback,RN=jn.unstable_shouldYield,PN=jn.unstable_requestPaint,nt=jn.unstable_now,NN=jn.unstable_getCurrentPriorityLevel,rv=jn.unstable_ImmediatePriority,Ck=jn.unstable_UserBlockingPriority,Kd=jn.unstable_NormalPriority,DN=jn.unstable_LowPriority,Ak=jn.unstable_IdlePriority,yf=null,Rr=null;function jN(t){if(Rr&&typeof Rr.onCommitFiberRoot=="function")try{Rr.onCommitFiberRoot(yf,t,void 0,(t.current.flags&128)===128)}catch{}}var hr=Math.clz32?Math.clz32:LN,ON=Math.log,MN=Math.LN2;function LN(t){return t>>>=0,t===0?32:31-(ON(t)/MN|0)|0}var Ou=64,Mu=4194304;function Tl(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Xd(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~i;a!==0?r=Tl(a):(s&=o,s!==0&&(r=Tl(s)))}else o=n&~i,o!==0?r=Tl(o):s!==0&&(r=Tl(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-hr(e),i=1<<n,r|=t[n],e&=~i;return r}function FN(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function $N(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-hr(s),a=1<<o,l=i[o];l===-1?(!(a&n)||a&r)&&(i[o]=FN(a,e)):l<=e&&(t.expiredLanes|=a),s&=~a}}function Jg(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Rk(){var t=Ou;return Ou<<=1,!(Ou&4194240)&&(Ou=64),t}function lp(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Qc(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-hr(e),t[e]=n}function zN(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-hr(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function iv(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-hr(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var Te=0;function Pk(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Nk,sv,Dk,jk,Ok,Zg=!1,Lu=[],Vi=null,Ui=null,Wi=null,rc=new Map,ic=new Map,Ai=[],BN="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ww(t,e){switch(t){case"focusin":case"focusout":Vi=null;break;case"dragenter":case"dragleave":Ui=null;break;case"mouseover":case"mouseout":Wi=null;break;case"pointerover":case"pointerout":rc.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":ic.delete(e.pointerId)}}function hl(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=Jc(e),e!==null&&sv(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function VN(t,e,n,r,i){switch(e){case"focusin":return Vi=hl(Vi,t,e,n,r,i),!0;case"dragenter":return Ui=hl(Ui,t,e,n,r,i),!0;case"mouseover":return Wi=hl(Wi,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return rc.set(s,hl(rc.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,ic.set(s,hl(ic.get(s)||null,t,e,n,r,i)),!0}return!1}function Mk(t){var e=Ns(t.target);if(e!==null){var n=vo(e);if(n!==null){if(e=n.tag,e===13){if(e=bk(n),e!==null){t.blockedOn=e,Ok(t.priority,function(){Dk(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function _d(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=e0(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Kg=r,n.target.dispatchEvent(r),Kg=null}else return e=Jc(n),e!==null&&sv(e),t.blockedOn=n,!1;e.shift()}return!0}function _w(t,e,n){_d(t)&&n.delete(e)}function UN(){Zg=!1,Vi!==null&&_d(Vi)&&(Vi=null),Ui!==null&&_d(Ui)&&(Ui=null),Wi!==null&&_d(Wi)&&(Wi=null),rc.forEach(_w),ic.forEach(_w)}function fl(t,e){t.blockedOn===e&&(t.blockedOn=null,Zg||(Zg=!0,jn.unstable_scheduleCallback(jn.unstable_NormalPriority,UN)))}function sc(t){function e(i){return fl(i,t)}if(0<Lu.length){fl(Lu[0],t);for(var n=1;n<Lu.length;n++){var r=Lu[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Vi!==null&&fl(Vi,t),Ui!==null&&fl(Ui,t),Wi!==null&&fl(Wi,t),rc.forEach(e),ic.forEach(e),n=0;n<Ai.length;n++)r=Ai[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Ai.length&&(n=Ai[0],n.blockedOn===null);)Mk(n),n.blockedOn===null&&Ai.shift()}var sa=yi.ReactCurrentBatchConfig,Qd=!0;function WN(t,e,n,r){var i=Te,s=sa.transition;sa.transition=null;try{Te=1,ov(t,e,n,r)}finally{Te=i,sa.transition=s}}function HN(t,e,n,r){var i=Te,s=sa.transition;sa.transition=null;try{Te=4,ov(t,e,n,r)}finally{Te=i,sa.transition=s}}function ov(t,e,n,r){if(Qd){var i=e0(t,e,n,r);if(i===null)vp(t,e,r,Yd,n),ww(t,r);else if(VN(i,t,e,n,r))r.stopPropagation();else if(ww(t,r),e&4&&-1<BN.indexOf(t)){for(;i!==null;){var s=Jc(i);if(s!==null&&Nk(s),s=e0(t,e,n,r),s===null&&vp(t,e,r,Yd,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else vp(t,e,r,null,n)}}var Yd=null;function e0(t,e,n,r){if(Yd=null,t=nv(r),t=Ns(t),t!==null)if(e=vo(t),e===null)t=null;else if(n=e.tag,n===13){if(t=bk(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Yd=t,null}function Lk(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(NN()){case rv:return 1;case Ck:return 4;case Kd:case DN:return 16;case Ak:return 536870912;default:return 16}default:return 16}}var Li=null,av=null,Ed=null;function Fk(){if(Ed)return Ed;var t,e=av,n=e.length,r,i="value"in Li?Li.value:Li.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return Ed=i.slice(t,1<r?1-r:void 0)}function Sd(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Fu(){return!0}function Ew(){return!1}function $n(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Fu:Ew,this.isPropagationStopped=Ew,this}return Ge(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Fu)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Fu)},persist:function(){},isPersistent:Fu}),e}var qa={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},lv=$n(qa),Yc=Ge({},qa,{view:0,detail:0}),qN=$n(Yc),cp,up,ml,vf=Ge({},Yc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:cv,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==ml&&(ml&&t.type==="mousemove"?(cp=t.screenX-ml.screenX,up=t.screenY-ml.screenY):up=cp=0,ml=t),cp)},movementY:function(t){return"movementY"in t?t.movementY:up}}),Sw=$n(vf),GN=Ge({},vf,{dataTransfer:0}),KN=$n(GN),XN=Ge({},Yc,{relatedTarget:0}),dp=$n(XN),QN=Ge({},qa,{animationName:0,elapsedTime:0,pseudoElement:0}),YN=$n(QN),JN=Ge({},qa,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),ZN=$n(JN),e3=Ge({},qa,{data:0}),bw=$n(e3),t3={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},n3={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},r3={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function i3(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=r3[t])?!!e[t]:!1}function cv(){return i3}var s3=Ge({},Yc,{key:function(t){if(t.key){var e=t3[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Sd(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?n3[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:cv,charCode:function(t){return t.type==="keypress"?Sd(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Sd(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),o3=$n(s3),a3=Ge({},vf,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),kw=$n(a3),l3=Ge({},Yc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:cv}),c3=$n(l3),u3=Ge({},qa,{propertyName:0,elapsedTime:0,pseudoElement:0}),d3=$n(u3),h3=Ge({},vf,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),f3=$n(h3),m3=[9,13,27,32],uv=ai&&"CompositionEvent"in window,Ll=null;ai&&"documentMode"in document&&(Ll=document.documentMode);var p3=ai&&"TextEvent"in window&&!Ll,$k=ai&&(!uv||Ll&&8<Ll&&11>=Ll),Tw=String.fromCharCode(32),Iw=!1;function zk(t,e){switch(t){case"keyup":return m3.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Bk(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Uo=!1;function g3(t,e){switch(t){case"compositionend":return Bk(e);case"keypress":return e.which!==32?null:(Iw=!0,Tw);case"textInput":return t=e.data,t===Tw&&Iw?null:t;default:return null}}function y3(t,e){if(Uo)return t==="compositionend"||!uv&&zk(t,e)?(t=Fk(),Ed=av=Li=null,Uo=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return $k&&e.locale!=="ko"?null:e.data;default:return null}}var v3={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Cw(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!v3[t.type]:e==="textarea"}function Vk(t,e,n,r){xk(r),e=Jd(e,"onChange"),0<e.length&&(n=new lv("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Fl=null,oc=null;function x3(t){Zk(t,0)}function xf(t){var e=qo(t);if(hk(e))return t}function w3(t,e){if(t==="change")return e}var Uk=!1;if(ai){var hp;if(ai){var fp="oninput"in document;if(!fp){var Aw=document.createElement("div");Aw.setAttribute("oninput","return;"),fp=typeof Aw.oninput=="function"}hp=fp}else hp=!1;Uk=hp&&(!document.documentMode||9<document.documentMode)}function Rw(){Fl&&(Fl.detachEvent("onpropertychange",Wk),oc=Fl=null)}function Wk(t){if(t.propertyName==="value"&&xf(oc)){var e=[];Vk(e,oc,t,nv(t)),Sk(x3,e)}}function _3(t,e,n){t==="focusin"?(Rw(),Fl=e,oc=n,Fl.attachEvent("onpropertychange",Wk)):t==="focusout"&&Rw()}function E3(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return xf(oc)}function S3(t,e){if(t==="click")return xf(e)}function b3(t,e){if(t==="input"||t==="change")return xf(e)}function k3(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var mr=typeof Object.is=="function"?Object.is:k3;function ac(t,e){if(mr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!Mg.call(e,i)||!mr(t[i],e[i]))return!1}return!0}function Pw(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Nw(t,e){var n=Pw(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Pw(n)}}function Hk(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Hk(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function qk(){for(var t=window,e=Hd();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Hd(t.document)}return e}function dv(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function T3(t){var e=qk(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&Hk(n.ownerDocument.documentElement,n)){if(r!==null&&dv(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=Nw(n,s);var o=Nw(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var I3=ai&&"documentMode"in document&&11>=document.documentMode,Wo=null,t0=null,$l=null,n0=!1;function Dw(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;n0||Wo==null||Wo!==Hd(r)||(r=Wo,"selectionStart"in r&&dv(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),$l&&ac($l,r)||($l=r,r=Jd(t0,"onSelect"),0<r.length&&(e=new lv("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Wo)))}function $u(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Ho={animationend:$u("Animation","AnimationEnd"),animationiteration:$u("Animation","AnimationIteration"),animationstart:$u("Animation","AnimationStart"),transitionend:$u("Transition","TransitionEnd")},mp={},Gk={};ai&&(Gk=document.createElement("div").style,"AnimationEvent"in window||(delete Ho.animationend.animation,delete Ho.animationiteration.animation,delete Ho.animationstart.animation),"TransitionEvent"in window||delete Ho.transitionend.transition);function wf(t){if(mp[t])return mp[t];if(!Ho[t])return t;var e=Ho[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Gk)return mp[t]=e[n];return t}var Kk=wf("animationend"),Xk=wf("animationiteration"),Qk=wf("animationstart"),Yk=wf("transitionend"),Jk=new Map,jw="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function gs(t,e){Jk.set(t,e),yo(e,[t])}for(var pp=0;pp<jw.length;pp++){var gp=jw[pp],C3=gp.toLowerCase(),A3=gp[0].toUpperCase()+gp.slice(1);gs(C3,"on"+A3)}gs(Kk,"onAnimationEnd");gs(Xk,"onAnimationIteration");gs(Qk,"onAnimationStart");gs("dblclick","onDoubleClick");gs("focusin","onFocus");gs("focusout","onBlur");gs(Yk,"onTransitionEnd");ya("onMouseEnter",["mouseout","mouseover"]);ya("onMouseLeave",["mouseout","mouseover"]);ya("onPointerEnter",["pointerout","pointerover"]);ya("onPointerLeave",["pointerout","pointerover"]);yo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));yo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));yo("onBeforeInput",["compositionend","keypress","textInput","paste"]);yo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));yo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));yo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Il="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),R3=new Set("cancel close invalid load scroll toggle".split(" ").concat(Il));function Ow(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,CN(r,e,void 0,t),t.currentTarget=null}function Zk(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;Ow(i,a,c),s=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,c=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;Ow(i,a,c),s=l}}}if(Gd)throw t=Yg,Gd=!1,Yg=null,t}function Me(t,e){var n=e[a0];n===void 0&&(n=e[a0]=new Set);var r=t+"__bubble";n.has(r)||(e2(e,t,2,!1),n.add(r))}function yp(t,e,n){var r=0;e&&(r|=4),e2(n,t,r,e)}var zu="_reactListening"+Math.random().toString(36).slice(2);function lc(t){if(!t[zu]){t[zu]=!0,ak.forEach(function(n){n!=="selectionchange"&&(R3.has(n)||yp(n,!1,t),yp(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[zu]||(e[zu]=!0,yp("selectionchange",!1,e))}}function e2(t,e,n,r){switch(Lk(e)){case 1:var i=WN;break;case 4:i=HN;break;default:i=ov}n=i.bind(null,e,n,t),i=void 0,!Qg||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function vp(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;a!==null;){if(o=Ns(a),o===null)return;if(l=o.tag,l===5||l===6){r=s=o;continue e}a=a.parentNode}}r=r.return}Sk(function(){var c=s,d=nv(n),h=[];e:{var m=Jk.get(t);if(m!==void 0){var p=lv,y=t;switch(t){case"keypress":if(Sd(n)===0)break e;case"keydown":case"keyup":p=o3;break;case"focusin":y="focus",p=dp;break;case"focusout":y="blur",p=dp;break;case"beforeblur":case"afterblur":p=dp;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=Sw;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=KN;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=c3;break;case Kk:case Xk:case Qk:p=YN;break;case Yk:p=d3;break;case"scroll":p=qN;break;case"wheel":p=f3;break;case"copy":case"cut":case"paste":p=ZN;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=kw}var x=(e&4)!==0,E=!x&&t==="scroll",v=x?m!==null?m+"Capture":null:m;x=[];for(var g=c,w;g!==null;){w=g;var _=w.stateNode;if(w.tag===5&&_!==null&&(w=_,v!==null&&(_=nc(g,v),_!=null&&x.push(cc(g,_,w)))),E)break;g=g.return}0<x.length&&(m=new p(m,y,null,n,d),h.push({event:m,listeners:x}))}}if(!(e&7)){e:{if(m=t==="mouseover"||t==="pointerover",p=t==="mouseout"||t==="pointerout",m&&n!==Kg&&(y=n.relatedTarget||n.fromElement)&&(Ns(y)||y[li]))break e;if((p||m)&&(m=d.window===d?d:(m=d.ownerDocument)?m.defaultView||m.parentWindow:window,p?(y=n.relatedTarget||n.toElement,p=c,y=y?Ns(y):null,y!==null&&(E=vo(y),y!==E||y.tag!==5&&y.tag!==6)&&(y=null)):(p=null,y=c),p!==y)){if(x=Sw,_="onMouseLeave",v="onMouseEnter",g="mouse",(t==="pointerout"||t==="pointerover")&&(x=kw,_="onPointerLeave",v="onPointerEnter",g="pointer"),E=p==null?m:qo(p),w=y==null?m:qo(y),m=new x(_,g+"leave",p,n,d),m.target=E,m.relatedTarget=w,_=null,Ns(d)===c&&(x=new x(v,g+"enter",y,n,d),x.target=w,x.relatedTarget=E,_=x),E=_,p&&y)t:{for(x=p,v=y,g=0,w=x;w;w=Ro(w))g++;for(w=0,_=v;_;_=Ro(_))w++;for(;0<g-w;)x=Ro(x),g--;for(;0<w-g;)v=Ro(v),w--;for(;g--;){if(x===v||v!==null&&x===v.alternate)break t;x=Ro(x),v=Ro(v)}x=null}else x=null;p!==null&&Mw(h,m,p,x,!1),y!==null&&E!==null&&Mw(h,E,y,x,!0)}}e:{if(m=c?qo(c):window,p=m.nodeName&&m.nodeName.toLowerCase(),p==="select"||p==="input"&&m.type==="file")var S=w3;else if(Cw(m))if(Uk)S=b3;else{S=E3;var T=_3}else(p=m.nodeName)&&p.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(S=S3);if(S&&(S=S(t,c))){Vk(h,S,n,d);break e}T&&T(t,m,c),t==="focusout"&&(T=m._wrapperState)&&T.controlled&&m.type==="number"&&Ug(m,"number",m.value)}switch(T=c?qo(c):window,t){case"focusin":(Cw(T)||T.contentEditable==="true")&&(Wo=T,t0=c,$l=null);break;case"focusout":$l=t0=Wo=null;break;case"mousedown":n0=!0;break;case"contextmenu":case"mouseup":case"dragend":n0=!1,Dw(h,n,d);break;case"selectionchange":if(I3)break;case"keydown":case"keyup":Dw(h,n,d)}var b;if(uv)e:{switch(t){case"compositionstart":var k="onCompositionStart";break e;case"compositionend":k="onCompositionEnd";break e;case"compositionupdate":k="onCompositionUpdate";break e}k=void 0}else Uo?zk(t,n)&&(k="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(k="onCompositionStart");k&&($k&&n.locale!=="ko"&&(Uo||k!=="onCompositionStart"?k==="onCompositionEnd"&&Uo&&(b=Fk()):(Li=d,av="value"in Li?Li.value:Li.textContent,Uo=!0)),T=Jd(c,k),0<T.length&&(k=new bw(k,t,null,n,d),h.push({event:k,listeners:T}),b?k.data=b:(b=Bk(n),b!==null&&(k.data=b)))),(b=p3?g3(t,n):y3(t,n))&&(c=Jd(c,"onBeforeInput"),0<c.length&&(d=new bw("onBeforeInput","beforeinput",null,n,d),h.push({event:d,listeners:c}),d.data=b))}Zk(h,e)})}function cc(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Jd(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=nc(t,n),s!=null&&r.unshift(cc(t,s,i)),s=nc(t,e),s!=null&&r.push(cc(t,s,i))),t=t.return}return r}function Ro(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Mw(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,c=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&c!==null&&(a=c,i?(l=nc(n,s),l!=null&&o.unshift(cc(n,l,a))):i||(l=nc(n,s),l!=null&&o.push(cc(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var P3=/\r\n?/g,N3=/\u0000|\uFFFD/g;function Lw(t){return(typeof t=="string"?t:""+t).replace(P3,`
`).replace(N3,"")}function Bu(t,e,n){if(e=Lw(e),Lw(t)!==e&&n)throw Error(M(425))}function Zd(){}var r0=null,i0=null;function s0(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var o0=typeof setTimeout=="function"?setTimeout:void 0,D3=typeof clearTimeout=="function"?clearTimeout:void 0,Fw=typeof Promise=="function"?Promise:void 0,j3=typeof queueMicrotask=="function"?queueMicrotask:typeof Fw<"u"?function(t){return Fw.resolve(null).then(t).catch(O3)}:o0;function O3(t){setTimeout(function(){throw t})}function xp(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),sc(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);sc(e)}function Hi(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function $w(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Ga=Math.random().toString(36).slice(2),Er="__reactFiber$"+Ga,uc="__reactProps$"+Ga,li="__reactContainer$"+Ga,a0="__reactEvents$"+Ga,M3="__reactListeners$"+Ga,L3="__reactHandles$"+Ga;function Ns(t){var e=t[Er];if(e)return e;for(var n=t.parentNode;n;){if(e=n[li]||n[Er]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=$w(t);t!==null;){if(n=t[Er])return n;t=$w(t)}return e}t=n,n=t.parentNode}return null}function Jc(t){return t=t[Er]||t[li],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function qo(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(M(33))}function _f(t){return t[uc]||null}var l0=[],Go=-1;function ys(t){return{current:t}}function $e(t){0>Go||(t.current=l0[Go],l0[Go]=null,Go--)}function Oe(t,e){Go++,l0[Go]=t.current,t.current=e}var is={},Kt=ys(is),mn=ys(!1),Gs=is;function va(t,e){var n=t.type.contextTypes;if(!n)return is;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function pn(t){return t=t.childContextTypes,t!=null}function eh(){$e(mn),$e(Kt)}function zw(t,e,n){if(Kt.current!==is)throw Error(M(168));Oe(Kt,e),Oe(mn,n)}function t2(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(M(108,_N(t)||"Unknown",i));return Ge({},n,r)}function th(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||is,Gs=Kt.current,Oe(Kt,t),Oe(mn,mn.current),!0}function Bw(t,e,n){var r=t.stateNode;if(!r)throw Error(M(169));n?(t=t2(t,e,Gs),r.__reactInternalMemoizedMergedChildContext=t,$e(mn),$e(Kt),Oe(Kt,t)):$e(mn),Oe(mn,n)}var Xr=null,Ef=!1,wp=!1;function n2(t){Xr===null?Xr=[t]:Xr.push(t)}function F3(t){Ef=!0,n2(t)}function vs(){if(!wp&&Xr!==null){wp=!0;var t=0,e=Te;try{var n=Xr;for(Te=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Xr=null,Ef=!1}catch(i){throw Xr!==null&&(Xr=Xr.slice(t+1)),Ik(rv,vs),i}finally{Te=e,wp=!1}}return null}var Ko=[],Xo=0,nh=null,rh=0,Hn=[],qn=0,Ks=null,Qr=1,Yr="";function Ts(t,e){Ko[Xo++]=rh,Ko[Xo++]=nh,nh=t,rh=e}function r2(t,e,n){Hn[qn++]=Qr,Hn[qn++]=Yr,Hn[qn++]=Ks,Ks=t;var r=Qr;t=Yr;var i=32-hr(r)-1;r&=~(1<<i),n+=1;var s=32-hr(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Qr=1<<32-hr(e)+i|n<<i|r,Yr=s+t}else Qr=1<<s|n<<i|r,Yr=t}function hv(t){t.return!==null&&(Ts(t,1),r2(t,1,0))}function fv(t){for(;t===nh;)nh=Ko[--Xo],Ko[Xo]=null,rh=Ko[--Xo],Ko[Xo]=null;for(;t===Ks;)Ks=Hn[--qn],Hn[qn]=null,Yr=Hn[--qn],Hn[qn]=null,Qr=Hn[--qn],Hn[qn]=null}var Rn=null,Tn=null,Ue=!1,ar=null;function i2(t,e){var n=Xn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Vw(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Rn=t,Tn=Hi(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Rn=t,Tn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Ks!==null?{id:Qr,overflow:Yr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Xn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Rn=t,Tn=null,!0):!1;default:return!1}}function c0(t){return(t.mode&1)!==0&&(t.flags&128)===0}function u0(t){if(Ue){var e=Tn;if(e){var n=e;if(!Vw(t,e)){if(c0(t))throw Error(M(418));e=Hi(n.nextSibling);var r=Rn;e&&Vw(t,e)?i2(r,n):(t.flags=t.flags&-4097|2,Ue=!1,Rn=t)}}else{if(c0(t))throw Error(M(418));t.flags=t.flags&-4097|2,Ue=!1,Rn=t}}}function Uw(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Rn=t}function Vu(t){if(t!==Rn)return!1;if(!Ue)return Uw(t),Ue=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!s0(t.type,t.memoizedProps)),e&&(e=Tn)){if(c0(t))throw s2(),Error(M(418));for(;e;)i2(t,e),e=Hi(e.nextSibling)}if(Uw(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(M(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Tn=Hi(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Tn=null}}else Tn=Rn?Hi(t.stateNode.nextSibling):null;return!0}function s2(){for(var t=Tn;t;)t=Hi(t.nextSibling)}function xa(){Tn=Rn=null,Ue=!1}function mv(t){ar===null?ar=[t]:ar.push(t)}var $3=yi.ReactCurrentBatchConfig;function ir(t,e){if(t&&t.defaultProps){e=Ge({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var ih=ys(null),sh=null,Qo=null,pv=null;function gv(){pv=Qo=sh=null}function yv(t){var e=ih.current;$e(ih),t._currentValue=e}function d0(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function oa(t,e){sh=t,pv=Qo=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(fn=!0),t.firstContext=null)}function Zn(t){var e=t._currentValue;if(pv!==t)if(t={context:t,memoizedValue:e,next:null},Qo===null){if(sh===null)throw Error(M(308));Qo=t,sh.dependencies={lanes:0,firstContext:t}}else Qo=Qo.next=t;return e}var Ds=null;function vv(t){Ds===null?Ds=[t]:Ds.push(t)}function o2(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,vv(e)):(n.next=i.next,i.next=n),e.interleaved=n,ci(t,r)}function ci(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Ci=!1;function xv(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function a2(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function ri(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function qi(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,we&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,ci(t,n)}return i=r.interleaved,i===null?(e.next=e,vv(r)):(e.next=i.next,i.next=e),r.interleaved=e,ci(t,n)}function bd(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,iv(t,n)}}function Ww(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function oh(t,e,n,r){var i=t.updateQueue;Ci=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,c=l.next;l.next=null,o===null?s=c:o.next=c,o=l;var d=t.alternate;d!==null&&(d=d.updateQueue,a=d.lastBaseUpdate,a!==o&&(a===null?d.firstBaseUpdate=c:a.next=c,d.lastBaseUpdate=l))}if(s!==null){var h=i.baseState;o=0,d=c=l=null,a=s;do{var m=a.lane,p=a.eventTime;if((r&m)===m){d!==null&&(d=d.next={eventTime:p,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var y=t,x=a;switch(m=e,p=n,x.tag){case 1:if(y=x.payload,typeof y=="function"){h=y.call(p,h,m);break e}h=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=x.payload,m=typeof y=="function"?y.call(p,h,m):y,m==null)break e;h=Ge({},h,m);break e;case 2:Ci=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,m=i.effects,m===null?i.effects=[a]:m.push(a))}else p={eventTime:p,lane:m,tag:a.tag,payload:a.payload,callback:a.callback,next:null},d===null?(c=d=p,l=h):d=d.next=p,o|=m;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;m=a,a=m.next,m.next=null,i.lastBaseUpdate=m,i.shared.pending=null}}while(1);if(d===null&&(l=h),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=d,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Qs|=o,t.lanes=o,t.memoizedState=h}}function Hw(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(M(191,i));i.call(r)}}}var l2=new ok.Component().refs;function h0(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Ge({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Sf={isMounted:function(t){return(t=t._reactInternals)?vo(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=rn(),i=Ki(t),s=ri(r,i);s.payload=e,n!=null&&(s.callback=n),e=qi(t,s,i),e!==null&&(fr(e,t,i,r),bd(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=rn(),i=Ki(t),s=ri(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=qi(t,s,i),e!==null&&(fr(e,t,i,r),bd(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=rn(),r=Ki(t),i=ri(n,r);i.tag=2,e!=null&&(i.callback=e),e=qi(t,i,r),e!==null&&(fr(e,t,r,n),bd(e,t,r))}};function qw(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!ac(n,r)||!ac(i,s):!0}function c2(t,e,n){var r=!1,i=is,s=e.contextType;return typeof s=="object"&&s!==null?s=Zn(s):(i=pn(e)?Gs:Kt.current,r=e.contextTypes,s=(r=r!=null)?va(t,i):is),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Sf,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function Gw(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Sf.enqueueReplaceState(e,e.state,null)}function f0(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs=l2,xv(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=Zn(s):(s=pn(e)?Gs:Kt.current,i.context=va(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(h0(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Sf.enqueueReplaceState(i,i.state,null),oh(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function pl(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(M(309));var r=n.stateNode}if(!r)throw Error(M(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;a===l2&&(a=i.refs={}),o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(M(284));if(!n._owner)throw Error(M(290,t))}return t}function Uu(t,e){throw t=Object.prototype.toString.call(e),Error(M(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Kw(t){var e=t._init;return e(t._payload)}function u2(t){function e(v,g){if(t){var w=v.deletions;w===null?(v.deletions=[g],v.flags|=16):w.push(g)}}function n(v,g){if(!t)return null;for(;g!==null;)e(v,g),g=g.sibling;return null}function r(v,g){for(v=new Map;g!==null;)g.key!==null?v.set(g.key,g):v.set(g.index,g),g=g.sibling;return v}function i(v,g){return v=Xi(v,g),v.index=0,v.sibling=null,v}function s(v,g,w){return v.index=w,t?(w=v.alternate,w!==null?(w=w.index,w<g?(v.flags|=2,g):w):(v.flags|=2,g)):(v.flags|=1048576,g)}function o(v){return t&&v.alternate===null&&(v.flags|=2),v}function a(v,g,w,_){return g===null||g.tag!==6?(g=Ip(w,v.mode,_),g.return=v,g):(g=i(g,w),g.return=v,g)}function l(v,g,w,_){var S=w.type;return S===Vo?d(v,g,w.props.children,_,w.key):g!==null&&(g.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Ii&&Kw(S)===g.type)?(_=i(g,w.props),_.ref=pl(v,g,w),_.return=v,_):(_=Rd(w.type,w.key,w.props,null,v.mode,_),_.ref=pl(v,g,w),_.return=v,_)}function c(v,g,w,_){return g===null||g.tag!==4||g.stateNode.containerInfo!==w.containerInfo||g.stateNode.implementation!==w.implementation?(g=Cp(w,v.mode,_),g.return=v,g):(g=i(g,w.children||[]),g.return=v,g)}function d(v,g,w,_,S){return g===null||g.tag!==7?(g=Vs(w,v.mode,_,S),g.return=v,g):(g=i(g,w),g.return=v,g)}function h(v,g,w){if(typeof g=="string"&&g!==""||typeof g=="number")return g=Ip(""+g,v.mode,w),g.return=v,g;if(typeof g=="object"&&g!==null){switch(g.$$typeof){case Nu:return w=Rd(g.type,g.key,g.props,null,v.mode,w),w.ref=pl(v,null,g),w.return=v,w;case Bo:return g=Cp(g,v.mode,w),g.return=v,g;case Ii:var _=g._init;return h(v,_(g._payload),w)}if(kl(g)||ul(g))return g=Vs(g,v.mode,w,null),g.return=v,g;Uu(v,g)}return null}function m(v,g,w,_){var S=g!==null?g.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return S!==null?null:a(v,g,""+w,_);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Nu:return w.key===S?l(v,g,w,_):null;case Bo:return w.key===S?c(v,g,w,_):null;case Ii:return S=w._init,m(v,g,S(w._payload),_)}if(kl(w)||ul(w))return S!==null?null:d(v,g,w,_,null);Uu(v,w)}return null}function p(v,g,w,_,S){if(typeof _=="string"&&_!==""||typeof _=="number")return v=v.get(w)||null,a(g,v,""+_,S);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Nu:return v=v.get(_.key===null?w:_.key)||null,l(g,v,_,S);case Bo:return v=v.get(_.key===null?w:_.key)||null,c(g,v,_,S);case Ii:var T=_._init;return p(v,g,w,T(_._payload),S)}if(kl(_)||ul(_))return v=v.get(w)||null,d(g,v,_,S,null);Uu(g,_)}return null}function y(v,g,w,_){for(var S=null,T=null,b=g,k=g=0,R=null;b!==null&&k<w.length;k++){b.index>k?(R=b,b=null):R=b.sibling;var P=m(v,b,w[k],_);if(P===null){b===null&&(b=R);break}t&&b&&P.alternate===null&&e(v,b),g=s(P,g,k),T===null?S=P:T.sibling=P,T=P,b=R}if(k===w.length)return n(v,b),Ue&&Ts(v,k),S;if(b===null){for(;k<w.length;k++)b=h(v,w[k],_),b!==null&&(g=s(b,g,k),T===null?S=b:T.sibling=b,T=b);return Ue&&Ts(v,k),S}for(b=r(v,b);k<w.length;k++)R=p(b,v,k,w[k],_),R!==null&&(t&&R.alternate!==null&&b.delete(R.key===null?k:R.key),g=s(R,g,k),T===null?S=R:T.sibling=R,T=R);return t&&b.forEach(function(O){return e(v,O)}),Ue&&Ts(v,k),S}function x(v,g,w,_){var S=ul(w);if(typeof S!="function")throw Error(M(150));if(w=S.call(w),w==null)throw Error(M(151));for(var T=S=null,b=g,k=g=0,R=null,P=w.next();b!==null&&!P.done;k++,P=w.next()){b.index>k?(R=b,b=null):R=b.sibling;var O=m(v,b,P.value,_);if(O===null){b===null&&(b=R);break}t&&b&&O.alternate===null&&e(v,b),g=s(O,g,k),T===null?S=O:T.sibling=O,T=O,b=R}if(P.done)return n(v,b),Ue&&Ts(v,k),S;if(b===null){for(;!P.done;k++,P=w.next())P=h(v,P.value,_),P!==null&&(g=s(P,g,k),T===null?S=P:T.sibling=P,T=P);return Ue&&Ts(v,k),S}for(b=r(v,b);!P.done;k++,P=w.next())P=p(b,v,k,P.value,_),P!==null&&(t&&P.alternate!==null&&b.delete(P.key===null?k:P.key),g=s(P,g,k),T===null?S=P:T.sibling=P,T=P);return t&&b.forEach(function(W){return e(v,W)}),Ue&&Ts(v,k),S}function E(v,g,w,_){if(typeof w=="object"&&w!==null&&w.type===Vo&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case Nu:e:{for(var S=w.key,T=g;T!==null;){if(T.key===S){if(S=w.type,S===Vo){if(T.tag===7){n(v,T.sibling),g=i(T,w.props.children),g.return=v,v=g;break e}}else if(T.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Ii&&Kw(S)===T.type){n(v,T.sibling),g=i(T,w.props),g.ref=pl(v,T,w),g.return=v,v=g;break e}n(v,T);break}else e(v,T);T=T.sibling}w.type===Vo?(g=Vs(w.props.children,v.mode,_,w.key),g.return=v,v=g):(_=Rd(w.type,w.key,w.props,null,v.mode,_),_.ref=pl(v,g,w),_.return=v,v=_)}return o(v);case Bo:e:{for(T=w.key;g!==null;){if(g.key===T)if(g.tag===4&&g.stateNode.containerInfo===w.containerInfo&&g.stateNode.implementation===w.implementation){n(v,g.sibling),g=i(g,w.children||[]),g.return=v,v=g;break e}else{n(v,g);break}else e(v,g);g=g.sibling}g=Cp(w,v.mode,_),g.return=v,v=g}return o(v);case Ii:return T=w._init,E(v,g,T(w._payload),_)}if(kl(w))return y(v,g,w,_);if(ul(w))return x(v,g,w,_);Uu(v,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,g!==null&&g.tag===6?(n(v,g.sibling),g=i(g,w),g.return=v,v=g):(n(v,g),g=Ip(w,v.mode,_),g.return=v,v=g),o(v)):n(v,g)}return E}var wa=u2(!0),d2=u2(!1),Zc={},Pr=ys(Zc),dc=ys(Zc),hc=ys(Zc);function js(t){if(t===Zc)throw Error(M(174));return t}function wv(t,e){switch(Oe(hc,e),Oe(dc,t),Oe(Pr,Zc),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Hg(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Hg(e,t)}$e(Pr),Oe(Pr,e)}function _a(){$e(Pr),$e(dc),$e(hc)}function h2(t){js(hc.current);var e=js(Pr.current),n=Hg(e,t.type);e!==n&&(Oe(dc,t),Oe(Pr,n))}function _v(t){dc.current===t&&($e(Pr),$e(dc))}var He=ys(0);function ah(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var _p=[];function Ev(){for(var t=0;t<_p.length;t++)_p[t]._workInProgressVersionPrimary=null;_p.length=0}var kd=yi.ReactCurrentDispatcher,Ep=yi.ReactCurrentBatchConfig,Xs=0,qe=null,gt=null,_t=null,lh=!1,zl=!1,fc=0,z3=0;function Lt(){throw Error(M(321))}function Sv(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!mr(t[n],e[n]))return!1;return!0}function bv(t,e,n,r,i,s){if(Xs=s,qe=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,kd.current=t===null||t.memoizedState===null?W3:H3,t=n(r,i),zl){s=0;do{if(zl=!1,fc=0,25<=s)throw Error(M(301));s+=1,_t=gt=null,e.updateQueue=null,kd.current=q3,t=n(r,i)}while(zl)}if(kd.current=ch,e=gt!==null&&gt.next!==null,Xs=0,_t=gt=qe=null,lh=!1,e)throw Error(M(300));return t}function kv(){var t=fc!==0;return fc=0,t}function wr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return _t===null?qe.memoizedState=_t=t:_t=_t.next=t,_t}function er(){if(gt===null){var t=qe.alternate;t=t!==null?t.memoizedState:null}else t=gt.next;var e=_t===null?qe.memoizedState:_t.next;if(e!==null)_t=e,gt=t;else{if(t===null)throw Error(M(310));gt=t,t={memoizedState:gt.memoizedState,baseState:gt.baseState,baseQueue:gt.baseQueue,queue:gt.queue,next:null},_t===null?qe.memoizedState=_t=t:_t=_t.next=t}return _t}function mc(t,e){return typeof e=="function"?e(t):e}function Sp(t){var e=er(),n=e.queue;if(n===null)throw Error(M(311));n.lastRenderedReducer=t;var r=gt,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,l=null,c=s;do{var d=c.lane;if((Xs&d)===d)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:t(r,c.action);else{var h={lane:d,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=h,o=r):l=l.next=h,qe.lanes|=d,Qs|=d}c=c.next}while(c!==null&&c!==s);l===null?o=r:l.next=a,mr(r,e.memoizedState)||(fn=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,qe.lanes|=s,Qs|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function bp(t){var e=er(),n=e.queue;if(n===null)throw Error(M(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);mr(s,e.memoizedState)||(fn=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function f2(){}function m2(t,e){var n=qe,r=er(),i=e(),s=!mr(r.memoizedState,i);if(s&&(r.memoizedState=i,fn=!0),r=r.queue,Tv(y2.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||_t!==null&&_t.memoizedState.tag&1){if(n.flags|=2048,pc(9,g2.bind(null,n,r,i,e),void 0,null),bt===null)throw Error(M(349));Xs&30||p2(n,e,i)}return i}function p2(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=qe.updateQueue,e===null?(e={lastEffect:null,stores:null},qe.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function g2(t,e,n,r){e.value=n,e.getSnapshot=r,v2(e)&&x2(t)}function y2(t,e,n){return n(function(){v2(e)&&x2(t)})}function v2(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!mr(t,n)}catch{return!0}}function x2(t){var e=ci(t,1);e!==null&&fr(e,t,1,-1)}function Xw(t){var e=wr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:mc,lastRenderedState:t},e.queue=t,t=t.dispatch=U3.bind(null,qe,t),[e.memoizedState,t]}function pc(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=qe.updateQueue,e===null?(e={lastEffect:null,stores:null},qe.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function w2(){return er().memoizedState}function Td(t,e,n,r){var i=wr();qe.flags|=t,i.memoizedState=pc(1|e,n,void 0,r===void 0?null:r)}function bf(t,e,n,r){var i=er();r=r===void 0?null:r;var s=void 0;if(gt!==null){var o=gt.memoizedState;if(s=o.destroy,r!==null&&Sv(r,o.deps)){i.memoizedState=pc(e,n,s,r);return}}qe.flags|=t,i.memoizedState=pc(1|e,n,s,r)}function Qw(t,e){return Td(8390656,8,t,e)}function Tv(t,e){return bf(2048,8,t,e)}function _2(t,e){return bf(4,2,t,e)}function E2(t,e){return bf(4,4,t,e)}function S2(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function b2(t,e,n){return n=n!=null?n.concat([t]):null,bf(4,4,S2.bind(null,e,t),n)}function Iv(){}function k2(t,e){var n=er();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Sv(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function T2(t,e){var n=er();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Sv(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function I2(t,e,n){return Xs&21?(mr(n,e)||(n=Rk(),qe.lanes|=n,Qs|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,fn=!0),t.memoizedState=n)}function B3(t,e){var n=Te;Te=n!==0&&4>n?n:4,t(!0);var r=Ep.transition;Ep.transition={};try{t(!1),e()}finally{Te=n,Ep.transition=r}}function C2(){return er().memoizedState}function V3(t,e,n){var r=Ki(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},A2(t))R2(e,n);else if(n=o2(t,e,n,r),n!==null){var i=rn();fr(n,t,r,i),P2(n,e,r)}}function U3(t,e,n){var r=Ki(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(A2(t))R2(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,mr(a,o)){var l=e.interleaved;l===null?(i.next=i,vv(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}n=o2(t,e,i,r),n!==null&&(i=rn(),fr(n,t,r,i),P2(n,e,r))}}function A2(t){var e=t.alternate;return t===qe||e!==null&&e===qe}function R2(t,e){zl=lh=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function P2(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,iv(t,n)}}var ch={readContext:Zn,useCallback:Lt,useContext:Lt,useEffect:Lt,useImperativeHandle:Lt,useInsertionEffect:Lt,useLayoutEffect:Lt,useMemo:Lt,useReducer:Lt,useRef:Lt,useState:Lt,useDebugValue:Lt,useDeferredValue:Lt,useTransition:Lt,useMutableSource:Lt,useSyncExternalStore:Lt,useId:Lt,unstable_isNewReconciler:!1},W3={readContext:Zn,useCallback:function(t,e){return wr().memoizedState=[t,e===void 0?null:e],t},useContext:Zn,useEffect:Qw,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Td(4194308,4,S2.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Td(4194308,4,t,e)},useInsertionEffect:function(t,e){return Td(4,2,t,e)},useMemo:function(t,e){var n=wr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=wr();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=V3.bind(null,qe,t),[r.memoizedState,t]},useRef:function(t){var e=wr();return t={current:t},e.memoizedState=t},useState:Xw,useDebugValue:Iv,useDeferredValue:function(t){return wr().memoizedState=t},useTransition:function(){var t=Xw(!1),e=t[0];return t=B3.bind(null,t[1]),wr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=qe,i=wr();if(Ue){if(n===void 0)throw Error(M(407));n=n()}else{if(n=e(),bt===null)throw Error(M(349));Xs&30||p2(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,Qw(y2.bind(null,r,s,t),[t]),r.flags|=2048,pc(9,g2.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=wr(),e=bt.identifierPrefix;if(Ue){var n=Yr,r=Qr;n=(r&~(1<<32-hr(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=fc++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=z3++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},H3={readContext:Zn,useCallback:k2,useContext:Zn,useEffect:Tv,useImperativeHandle:b2,useInsertionEffect:_2,useLayoutEffect:E2,useMemo:T2,useReducer:Sp,useRef:w2,useState:function(){return Sp(mc)},useDebugValue:Iv,useDeferredValue:function(t){var e=er();return I2(e,gt.memoizedState,t)},useTransition:function(){var t=Sp(mc)[0],e=er().memoizedState;return[t,e]},useMutableSource:f2,useSyncExternalStore:m2,useId:C2,unstable_isNewReconciler:!1},q3={readContext:Zn,useCallback:k2,useContext:Zn,useEffect:Tv,useImperativeHandle:b2,useInsertionEffect:_2,useLayoutEffect:E2,useMemo:T2,useReducer:bp,useRef:w2,useState:function(){return bp(mc)},useDebugValue:Iv,useDeferredValue:function(t){var e=er();return gt===null?e.memoizedState=t:I2(e,gt.memoizedState,t)},useTransition:function(){var t=bp(mc)[0],e=er().memoizedState;return[t,e]},useMutableSource:f2,useSyncExternalStore:m2,useId:C2,unstable_isNewReconciler:!1};function Ea(t,e){try{var n="",r=e;do n+=wN(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function kp(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function m0(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var G3=typeof WeakMap=="function"?WeakMap:Map;function N2(t,e,n){n=ri(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){dh||(dh=!0,b0=r),m0(t,e)},n}function D2(t,e,n){n=ri(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){m0(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){m0(t,e),typeof r!="function"&&(Gi===null?Gi=new Set([this]):Gi.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function Yw(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new G3;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=a5.bind(null,t,e,n),e.then(t,t))}function Jw(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Zw(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=ri(-1,1),e.tag=2,qi(n,e,1))),n.lanes|=1),t)}var K3=yi.ReactCurrentOwner,fn=!1;function Zt(t,e,n,r){e.child=t===null?d2(e,null,n,r):wa(e,t.child,n,r)}function e_(t,e,n,r,i){n=n.render;var s=e.ref;return oa(e,i),r=bv(t,e,n,r,s,i),n=kv(),t!==null&&!fn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,ui(t,e,i)):(Ue&&n&&hv(e),e.flags|=1,Zt(t,e,r,i),e.child)}function t_(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!Ov(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,j2(t,e,s,r,i)):(t=Rd(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:ac,n(o,r)&&t.ref===e.ref)return ui(t,e,i)}return e.flags|=1,t=Xi(s,r),t.ref=e.ref,t.return=e,e.child=t}function j2(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(ac(s,r)&&t.ref===e.ref)if(fn=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(fn=!0);else return e.lanes=t.lanes,ui(t,e,i)}return p0(t,e,n,r,i)}function O2(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Oe(Jo,bn),bn|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Oe(Jo,bn),bn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,Oe(Jo,bn),bn|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,Oe(Jo,bn),bn|=r;return Zt(t,e,i,n),e.child}function M2(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function p0(t,e,n,r,i){var s=pn(n)?Gs:Kt.current;return s=va(e,s),oa(e,i),n=bv(t,e,n,r,s,i),r=kv(),t!==null&&!fn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,ui(t,e,i)):(Ue&&r&&hv(e),e.flags|=1,Zt(t,e,n,i),e.child)}function n_(t,e,n,r,i){if(pn(n)){var s=!0;th(e)}else s=!1;if(oa(e,i),e.stateNode===null)Id(t,e),c2(e,n,r),f0(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,c=n.contextType;typeof c=="object"&&c!==null?c=Zn(c):(c=pn(n)?Gs:Kt.current,c=va(e,c));var d=n.getDerivedStateFromProps,h=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==c)&&Gw(e,o,r,c),Ci=!1;var m=e.memoizedState;o.state=m,oh(e,r,o,i),l=e.memoizedState,a!==r||m!==l||mn.current||Ci?(typeof d=="function"&&(h0(e,n,d,r),l=e.memoizedState),(a=Ci||qw(e,n,a,r,m,l,c))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=c,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,a2(t,e),a=e.memoizedProps,c=e.type===e.elementType?a:ir(e.type,a),o.props=c,h=e.pendingProps,m=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=Zn(l):(l=pn(n)?Gs:Kt.current,l=va(e,l));var p=n.getDerivedStateFromProps;(d=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==h||m!==l)&&Gw(e,o,r,l),Ci=!1,m=e.memoizedState,o.state=m,oh(e,r,o,i);var y=e.memoizedState;a!==h||m!==y||mn.current||Ci?(typeof p=="function"&&(h0(e,n,p,r),y=e.memoizedState),(c=Ci||qw(e,n,c,r,m,y,l)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,y,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,y,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=y),o.props=r,o.state=y,o.context=l,r=c):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),r=!1)}return g0(t,e,n,r,s,i)}function g0(t,e,n,r,i,s){M2(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&Bw(e,n,!1),ui(t,e,s);r=e.stateNode,K3.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=wa(e,t.child,null,s),e.child=wa(e,null,a,s)):Zt(t,e,a,s),e.memoizedState=r.state,i&&Bw(e,n,!0),e.child}function L2(t){var e=t.stateNode;e.pendingContext?zw(t,e.pendingContext,e.pendingContext!==e.context):e.context&&zw(t,e.context,!1),wv(t,e.containerInfo)}function r_(t,e,n,r,i){return xa(),mv(i),e.flags|=256,Zt(t,e,n,r),e.child}var y0={dehydrated:null,treeContext:null,retryLane:0};function v0(t){return{baseLanes:t,cachePool:null,transitions:null}}function F2(t,e,n){var r=e.pendingProps,i=He.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),Oe(He,i&1),t===null)return u0(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=If(o,r,0,null),t=Vs(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=v0(n),e.memoizedState=y0,t):Cv(e,o));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return X3(t,e,o,r,a,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=Xi(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=Xi(a,s):(s=Vs(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?v0(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=y0,r}return s=t.child,t=s.sibling,r=Xi(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Cv(t,e){return e=If({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Wu(t,e,n,r){return r!==null&&mv(r),wa(e,t.child,null,n),t=Cv(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function X3(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=kp(Error(M(422))),Wu(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=If({mode:"visible",children:r.children},i,0,null),s=Vs(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&wa(e,t.child,null,o),e.child.memoizedState=v0(o),e.memoizedState=y0,s);if(!(e.mode&1))return Wu(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(M(419)),r=kp(s,r,void 0),Wu(t,e,o,r)}if(a=(o&t.childLanes)!==0,fn||a){if(r=bt,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,ci(t,i),fr(r,t,i,-1))}return jv(),r=kp(Error(M(421))),Wu(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=l5.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,Tn=Hi(i.nextSibling),Rn=e,Ue=!0,ar=null,t!==null&&(Hn[qn++]=Qr,Hn[qn++]=Yr,Hn[qn++]=Ks,Qr=t.id,Yr=t.overflow,Ks=e),e=Cv(e,r.children),e.flags|=4096,e)}function i_(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),d0(t.return,e,n)}function Tp(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function $2(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(Zt(t,e,r.children,n),r=He.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&i_(t,n,e);else if(t.tag===19)i_(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Oe(He,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&ah(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),Tp(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&ah(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}Tp(e,!0,n,null,s);break;case"together":Tp(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Id(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function ui(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Qs|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(M(153));if(e.child!==null){for(t=e.child,n=Xi(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Xi(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function Q3(t,e,n){switch(e.tag){case 3:L2(e),xa();break;case 5:h2(e);break;case 1:pn(e.type)&&th(e);break;case 4:wv(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;Oe(ih,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Oe(He,He.current&1),e.flags|=128,null):n&e.child.childLanes?F2(t,e,n):(Oe(He,He.current&1),t=ui(t,e,n),t!==null?t.sibling:null);Oe(He,He.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return $2(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Oe(He,He.current),r)break;return null;case 22:case 23:return e.lanes=0,O2(t,e,n)}return ui(t,e,n)}var z2,x0,B2,V2;z2=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};x0=function(){};B2=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,js(Pr.current);var s=null;switch(n){case"input":i=Bg(t,i),r=Bg(t,r),s=[];break;case"select":i=Ge({},i,{value:void 0}),r=Ge({},r,{value:void 0}),s=[];break;case"textarea":i=Wg(t,i),r=Wg(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Zd)}qg(n,r);var o;n=null;for(c in i)if(!r.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var a=i[c];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(ec.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in r){var l=r[c];if(a=i!=null?i[c]:void 0,r.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(s||(s=[]),s.push(c,n)),n=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(ec.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Me("scroll",t),s||a===l||(s=[])):(s=s||[]).push(c,l))}n&&(s=s||[]).push("style",n);var c=s;(e.updateQueue=c)&&(e.flags|=4)}};V2=function(t,e,n,r){n!==r&&(e.flags|=4)};function gl(t,e){if(!Ue)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Ft(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function Y3(t,e,n){var r=e.pendingProps;switch(fv(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ft(e),null;case 1:return pn(e.type)&&eh(),Ft(e),null;case 3:return r=e.stateNode,_a(),$e(mn),$e(Kt),Ev(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Vu(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,ar!==null&&(I0(ar),ar=null))),x0(t,e),Ft(e),null;case 5:_v(e);var i=js(hc.current);if(n=e.type,t!==null&&e.stateNode!=null)B2(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(M(166));return Ft(e),null}if(t=js(Pr.current),Vu(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[Er]=e,r[uc]=s,t=(e.mode&1)!==0,n){case"dialog":Me("cancel",r),Me("close",r);break;case"iframe":case"object":case"embed":Me("load",r);break;case"video":case"audio":for(i=0;i<Il.length;i++)Me(Il[i],r);break;case"source":Me("error",r);break;case"img":case"image":case"link":Me("error",r),Me("load",r);break;case"details":Me("toggle",r);break;case"input":fw(r,s),Me("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Me("invalid",r);break;case"textarea":pw(r,s),Me("invalid",r)}qg(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&Bu(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&Bu(r.textContent,a,t),i=["children",""+a]):ec.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Me("scroll",r)}switch(n){case"input":Du(r),mw(r,s,!0);break;case"textarea":Du(r),gw(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=Zd)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=pk(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Er]=e,t[uc]=r,z2(t,e,!1,!1),e.stateNode=t;e:{switch(o=Gg(n,r),n){case"dialog":Me("cancel",t),Me("close",t),i=r;break;case"iframe":case"object":case"embed":Me("load",t),i=r;break;case"video":case"audio":for(i=0;i<Il.length;i++)Me(Il[i],t);i=r;break;case"source":Me("error",t),i=r;break;case"img":case"image":case"link":Me("error",t),Me("load",t),i=r;break;case"details":Me("toggle",t),i=r;break;case"input":fw(t,r),i=Bg(t,r),Me("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=Ge({},r,{value:void 0}),Me("invalid",t);break;case"textarea":pw(t,r),i=Wg(t,r),Me("invalid",t);break;default:i=r}qg(n,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?vk(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&gk(t,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&tc(t,l):typeof l=="number"&&tc(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(ec.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Me("scroll",t):l!=null&&Jy(t,s,l,o))}switch(n){case"input":Du(t),mw(t,r,!1);break;case"textarea":Du(t),gw(t);break;case"option":r.value!=null&&t.setAttribute("value",""+rs(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?na(t,!!r.multiple,s,!1):r.defaultValue!=null&&na(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Zd)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Ft(e),null;case 6:if(t&&e.stateNode!=null)V2(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(M(166));if(n=js(hc.current),js(Pr.current),Vu(e)){if(r=e.stateNode,n=e.memoizedProps,r[Er]=e,(s=r.nodeValue!==n)&&(t=Rn,t!==null))switch(t.tag){case 3:Bu(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Bu(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Er]=e,e.stateNode=r}return Ft(e),null;case 13:if($e(He),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Ue&&Tn!==null&&e.mode&1&&!(e.flags&128))s2(),xa(),e.flags|=98560,s=!1;else if(s=Vu(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(M(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(M(317));s[Er]=e}else xa(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Ft(e),s=!1}else ar!==null&&(I0(ar),ar=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||He.current&1?yt===0&&(yt=3):jv())),e.updateQueue!==null&&(e.flags|=4),Ft(e),null);case 4:return _a(),x0(t,e),t===null&&lc(e.stateNode.containerInfo),Ft(e),null;case 10:return yv(e.type._context),Ft(e),null;case 17:return pn(e.type)&&eh(),Ft(e),null;case 19:if($e(He),s=e.memoizedState,s===null)return Ft(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)gl(s,!1);else{if(yt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=ah(t),o!==null){for(e.flags|=128,gl(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Oe(He,He.current&1|2),e.child}t=t.sibling}s.tail!==null&&nt()>Sa&&(e.flags|=128,r=!0,gl(s,!1),e.lanes=4194304)}else{if(!r)if(t=ah(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),gl(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Ue)return Ft(e),null}else 2*nt()-s.renderingStartTime>Sa&&n!==1073741824&&(e.flags|=128,r=!0,gl(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=nt(),e.sibling=null,n=He.current,Oe(He,r?n&1|2:n&1),e):(Ft(e),null);case 22:case 23:return Dv(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?bn&1073741824&&(Ft(e),e.subtreeFlags&6&&(e.flags|=8192)):Ft(e),null;case 24:return null;case 25:return null}throw Error(M(156,e.tag))}function J3(t,e){switch(fv(e),e.tag){case 1:return pn(e.type)&&eh(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return _a(),$e(mn),$e(Kt),Ev(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return _v(e),null;case 13:if($e(He),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(M(340));xa()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return $e(He),null;case 4:return _a(),null;case 10:return yv(e.type._context),null;case 22:case 23:return Dv(),null;case 24:return null;default:return null}}var Hu=!1,Vt=!1,Z3=typeof WeakSet=="function"?WeakSet:Set,V=null;function Yo(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Xe(t,e,r)}else n.current=null}function w0(t,e,n){try{n()}catch(r){Xe(t,e,r)}}var s_=!1;function e5(t,e){if(r0=Qd,t=qk(),dv(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,c=0,d=0,h=t,m=null;t:for(;;){for(var p;h!==n||i!==0&&h.nodeType!==3||(a=o+i),h!==s||r!==0&&h.nodeType!==3||(l=o+r),h.nodeType===3&&(o+=h.nodeValue.length),(p=h.firstChild)!==null;)m=h,h=p;for(;;){if(h===t)break t;if(m===n&&++c===i&&(a=o),m===s&&++d===r&&(l=o),(p=h.nextSibling)!==null)break;h=m,m=h.parentNode}h=p}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(i0={focusedElem:t,selectionRange:n},Qd=!1,V=e;V!==null;)if(e=V,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,V=t;else for(;V!==null;){e=V;try{var y=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var x=y.memoizedProps,E=y.memoizedState,v=e.stateNode,g=v.getSnapshotBeforeUpdate(e.elementType===e.type?x:ir(e.type,x),E);v.__reactInternalSnapshotBeforeUpdate=g}break;case 3:var w=e.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(M(163))}}catch(_){Xe(e,e.return,_)}if(t=e.sibling,t!==null){t.return=e.return,V=t;break}V=e.return}return y=s_,s_=!1,y}function Bl(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&w0(e,n,s)}i=i.next}while(i!==r)}}function kf(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function _0(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function U2(t){var e=t.alternate;e!==null&&(t.alternate=null,U2(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Er],delete e[uc],delete e[a0],delete e[M3],delete e[L3])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function W2(t){return t.tag===5||t.tag===3||t.tag===4}function o_(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||W2(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function E0(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Zd));else if(r!==4&&(t=t.child,t!==null))for(E0(t,e,n),t=t.sibling;t!==null;)E0(t,e,n),t=t.sibling}function S0(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(S0(t,e,n),t=t.sibling;t!==null;)S0(t,e,n),t=t.sibling}var Ct=null,sr=!1;function Ei(t,e,n){for(n=n.child;n!==null;)H2(t,e,n),n=n.sibling}function H2(t,e,n){if(Rr&&typeof Rr.onCommitFiberUnmount=="function")try{Rr.onCommitFiberUnmount(yf,n)}catch{}switch(n.tag){case 5:Vt||Yo(n,e);case 6:var r=Ct,i=sr;Ct=null,Ei(t,e,n),Ct=r,sr=i,Ct!==null&&(sr?(t=Ct,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Ct.removeChild(n.stateNode));break;case 18:Ct!==null&&(sr?(t=Ct,n=n.stateNode,t.nodeType===8?xp(t.parentNode,n):t.nodeType===1&&xp(t,n),sc(t)):xp(Ct,n.stateNode));break;case 4:r=Ct,i=sr,Ct=n.stateNode.containerInfo,sr=!0,Ei(t,e,n),Ct=r,sr=i;break;case 0:case 11:case 14:case 15:if(!Vt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&w0(n,e,o),i=i.next}while(i!==r)}Ei(t,e,n);break;case 1:if(!Vt&&(Yo(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){Xe(n,e,a)}Ei(t,e,n);break;case 21:Ei(t,e,n);break;case 22:n.mode&1?(Vt=(r=Vt)||n.memoizedState!==null,Ei(t,e,n),Vt=r):Ei(t,e,n);break;default:Ei(t,e,n)}}function a_(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new Z3),e.forEach(function(r){var i=c5.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function nr(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Ct=a.stateNode,sr=!1;break e;case 3:Ct=a.stateNode.containerInfo,sr=!0;break e;case 4:Ct=a.stateNode.containerInfo,sr=!0;break e}a=a.return}if(Ct===null)throw Error(M(160));H2(s,o,i),Ct=null,sr=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(c){Xe(i,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)q2(e,t),e=e.sibling}function q2(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(nr(e,t),yr(t),r&4){try{Bl(3,t,t.return),kf(3,t)}catch(x){Xe(t,t.return,x)}try{Bl(5,t,t.return)}catch(x){Xe(t,t.return,x)}}break;case 1:nr(e,t),yr(t),r&512&&n!==null&&Yo(n,n.return);break;case 5:if(nr(e,t),yr(t),r&512&&n!==null&&Yo(n,n.return),t.flags&32){var i=t.stateNode;try{tc(i,"")}catch(x){Xe(t,t.return,x)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&fk(i,s),Gg(a,o);var c=Gg(a,s);for(o=0;o<l.length;o+=2){var d=l[o],h=l[o+1];d==="style"?vk(i,h):d==="dangerouslySetInnerHTML"?gk(i,h):d==="children"?tc(i,h):Jy(i,d,h,c)}switch(a){case"input":Vg(i,s);break;case"textarea":mk(i,s);break;case"select":var m=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var p=s.value;p!=null?na(i,!!s.multiple,p,!1):m!==!!s.multiple&&(s.defaultValue!=null?na(i,!!s.multiple,s.defaultValue,!0):na(i,!!s.multiple,s.multiple?[]:"",!1))}i[uc]=s}catch(x){Xe(t,t.return,x)}}break;case 6:if(nr(e,t),yr(t),r&4){if(t.stateNode===null)throw Error(M(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(x){Xe(t,t.return,x)}}break;case 3:if(nr(e,t),yr(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{sc(e.containerInfo)}catch(x){Xe(t,t.return,x)}break;case 4:nr(e,t),yr(t);break;case 13:nr(e,t),yr(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(Pv=nt())),r&4&&a_(t);break;case 22:if(d=n!==null&&n.memoizedState!==null,t.mode&1?(Vt=(c=Vt)||d,nr(e,t),Vt=c):nr(e,t),yr(t),r&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!d&&t.mode&1)for(V=t,d=t.child;d!==null;){for(h=V=d;V!==null;){switch(m=V,p=m.child,m.tag){case 0:case 11:case 14:case 15:Bl(4,m,m.return);break;case 1:Yo(m,m.return);var y=m.stateNode;if(typeof y.componentWillUnmount=="function"){r=m,n=m.return;try{e=r,y.props=e.memoizedProps,y.state=e.memoizedState,y.componentWillUnmount()}catch(x){Xe(r,n,x)}}break;case 5:Yo(m,m.return);break;case 22:if(m.memoizedState!==null){c_(h);continue}}p!==null?(p.return=m,V=p):c_(h)}d=d.sibling}e:for(d=null,h=t;;){if(h.tag===5){if(d===null){d=h;try{i=h.stateNode,c?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=h.stateNode,l=h.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=yk("display",o))}catch(x){Xe(t,t.return,x)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(x){Xe(t,t.return,x)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:nr(e,t),yr(t),r&4&&a_(t);break;case 21:break;default:nr(e,t),yr(t)}}function yr(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(W2(n)){var r=n;break e}n=n.return}throw Error(M(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(tc(i,""),r.flags&=-33);var s=o_(t);S0(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=o_(t);E0(t,a,o);break;default:throw Error(M(161))}}catch(l){Xe(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function t5(t,e,n){V=t,G2(t)}function G2(t,e,n){for(var r=(t.mode&1)!==0;V!==null;){var i=V,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||Hu;if(!o){var a=i.alternate,l=a!==null&&a.memoizedState!==null||Vt;a=Hu;var c=Vt;if(Hu=o,(Vt=l)&&!c)for(V=i;V!==null;)o=V,l=o.child,o.tag===22&&o.memoizedState!==null?u_(i):l!==null?(l.return=o,V=l):u_(i);for(;s!==null;)V=s,G2(s),s=s.sibling;V=i,Hu=a,Vt=c}l_(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,V=s):l_(t)}}function l_(t){for(;V!==null;){var e=V;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Vt||kf(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Vt)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:ir(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&Hw(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Hw(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var d=c.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&sc(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(M(163))}Vt||e.flags&512&&_0(e)}catch(m){Xe(e,e.return,m)}}if(e===t){V=null;break}if(n=e.sibling,n!==null){n.return=e.return,V=n;break}V=e.return}}function c_(t){for(;V!==null;){var e=V;if(e===t){V=null;break}var n=e.sibling;if(n!==null){n.return=e.return,V=n;break}V=e.return}}function u_(t){for(;V!==null;){var e=V;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{kf(4,e)}catch(l){Xe(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){Xe(e,i,l)}}var s=e.return;try{_0(e)}catch(l){Xe(e,s,l)}break;case 5:var o=e.return;try{_0(e)}catch(l){Xe(e,o,l)}}}catch(l){Xe(e,e.return,l)}if(e===t){V=null;break}var a=e.sibling;if(a!==null){a.return=e.return,V=a;break}V=e.return}}var n5=Math.ceil,uh=yi.ReactCurrentDispatcher,Av=yi.ReactCurrentOwner,Qn=yi.ReactCurrentBatchConfig,we=0,bt=null,dt=null,Nt=0,bn=0,Jo=ys(0),yt=0,gc=null,Qs=0,Tf=0,Rv=0,Vl=null,dn=null,Pv=0,Sa=1/0,Gr=null,dh=!1,b0=null,Gi=null,qu=!1,Fi=null,hh=0,Ul=0,k0=null,Cd=-1,Ad=0;function rn(){return we&6?nt():Cd!==-1?Cd:Cd=nt()}function Ki(t){return t.mode&1?we&2&&Nt!==0?Nt&-Nt:$3.transition!==null?(Ad===0&&(Ad=Rk()),Ad):(t=Te,t!==0||(t=window.event,t=t===void 0?16:Lk(t.type)),t):1}function fr(t,e,n,r){if(50<Ul)throw Ul=0,k0=null,Error(M(185));Qc(t,n,r),(!(we&2)||t!==bt)&&(t===bt&&(!(we&2)&&(Tf|=n),yt===4&&Ri(t,Nt)),gn(t,r),n===1&&we===0&&!(e.mode&1)&&(Sa=nt()+500,Ef&&vs()))}function gn(t,e){var n=t.callbackNode;$N(t,e);var r=Xd(t,t===bt?Nt:0);if(r===0)n!==null&&xw(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&xw(n),e===1)t.tag===0?F3(d_.bind(null,t)):n2(d_.bind(null,t)),j3(function(){!(we&6)&&vs()}),n=null;else{switch(Pk(r)){case 1:n=rv;break;case 4:n=Ck;break;case 16:n=Kd;break;case 536870912:n=Ak;break;default:n=Kd}n=tT(n,K2.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function K2(t,e){if(Cd=-1,Ad=0,we&6)throw Error(M(327));var n=t.callbackNode;if(aa()&&t.callbackNode!==n)return null;var r=Xd(t,t===bt?Nt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=fh(t,r);else{e=r;var i=we;we|=2;var s=Q2();(bt!==t||Nt!==e)&&(Gr=null,Sa=nt()+500,Bs(t,e));do try{s5();break}catch(a){X2(t,a)}while(1);gv(),uh.current=s,we=i,dt!==null?e=0:(bt=null,Nt=0,e=yt)}if(e!==0){if(e===2&&(i=Jg(t),i!==0&&(r=i,e=T0(t,i))),e===1)throw n=gc,Bs(t,0),Ri(t,r),gn(t,nt()),n;if(e===6)Ri(t,r);else{if(i=t.current.alternate,!(r&30)&&!r5(i)&&(e=fh(t,r),e===2&&(s=Jg(t),s!==0&&(r=s,e=T0(t,s))),e===1))throw n=gc,Bs(t,0),Ri(t,r),gn(t,nt()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(M(345));case 2:Is(t,dn,Gr);break;case 3:if(Ri(t,r),(r&130023424)===r&&(e=Pv+500-nt(),10<e)){if(Xd(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){rn(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=o0(Is.bind(null,t,dn,Gr),e);break}Is(t,dn,Gr);break;case 4:if(Ri(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-hr(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=nt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*n5(r/1960))-r,10<r){t.timeoutHandle=o0(Is.bind(null,t,dn,Gr),r);break}Is(t,dn,Gr);break;case 5:Is(t,dn,Gr);break;default:throw Error(M(329))}}}return gn(t,nt()),t.callbackNode===n?K2.bind(null,t):null}function T0(t,e){var n=Vl;return t.current.memoizedState.isDehydrated&&(Bs(t,e).flags|=256),t=fh(t,e),t!==2&&(e=dn,dn=n,e!==null&&I0(e)),t}function I0(t){dn===null?dn=t:dn.push.apply(dn,t)}function r5(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!mr(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Ri(t,e){for(e&=~Rv,e&=~Tf,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-hr(e),r=1<<n;t[n]=-1,e&=~r}}function d_(t){if(we&6)throw Error(M(327));aa();var e=Xd(t,0);if(!(e&1))return gn(t,nt()),null;var n=fh(t,e);if(t.tag!==0&&n===2){var r=Jg(t);r!==0&&(e=r,n=T0(t,r))}if(n===1)throw n=gc,Bs(t,0),Ri(t,e),gn(t,nt()),n;if(n===6)throw Error(M(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Is(t,dn,Gr),gn(t,nt()),null}function Nv(t,e){var n=we;we|=1;try{return t(e)}finally{we=n,we===0&&(Sa=nt()+500,Ef&&vs())}}function Ys(t){Fi!==null&&Fi.tag===0&&!(we&6)&&aa();var e=we;we|=1;var n=Qn.transition,r=Te;try{if(Qn.transition=null,Te=1,t)return t()}finally{Te=r,Qn.transition=n,we=e,!(we&6)&&vs()}}function Dv(){bn=Jo.current,$e(Jo)}function Bs(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,D3(n)),dt!==null)for(n=dt.return;n!==null;){var r=n;switch(fv(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&eh();break;case 3:_a(),$e(mn),$e(Kt),Ev();break;case 5:_v(r);break;case 4:_a();break;case 13:$e(He);break;case 19:$e(He);break;case 10:yv(r.type._context);break;case 22:case 23:Dv()}n=n.return}if(bt=t,dt=t=Xi(t.current,null),Nt=bn=e,yt=0,gc=null,Rv=Tf=Qs=0,dn=Vl=null,Ds!==null){for(e=0;e<Ds.length;e++)if(n=Ds[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}Ds=null}return t}function X2(t,e){do{var n=dt;try{if(gv(),kd.current=ch,lh){for(var r=qe.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}lh=!1}if(Xs=0,_t=gt=qe=null,zl=!1,fc=0,Av.current=null,n===null||n.return===null){yt=1,gc=e,dt=null;break}e:{var s=t,o=n.return,a=n,l=e;if(e=Nt,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,d=a,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var m=d.alternate;m?(d.updateQueue=m.updateQueue,d.memoizedState=m.memoizedState,d.lanes=m.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=Jw(o);if(p!==null){p.flags&=-257,Zw(p,o,a,s,e),p.mode&1&&Yw(s,c,e),e=p,l=c;var y=e.updateQueue;if(y===null){var x=new Set;x.add(l),e.updateQueue=x}else y.add(l);break e}else{if(!(e&1)){Yw(s,c,e),jv();break e}l=Error(M(426))}}else if(Ue&&a.mode&1){var E=Jw(o);if(E!==null){!(E.flags&65536)&&(E.flags|=256),Zw(E,o,a,s,e),mv(Ea(l,a));break e}}s=l=Ea(l,a),yt!==4&&(yt=2),Vl===null?Vl=[s]:Vl.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var v=N2(s,l,e);Ww(s,v);break e;case 1:a=l;var g=s.type,w=s.stateNode;if(!(s.flags&128)&&(typeof g.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Gi===null||!Gi.has(w)))){s.flags|=65536,e&=-e,s.lanes|=e;var _=D2(s,a,e);Ww(s,_);break e}}s=s.return}while(s!==null)}J2(n)}catch(S){e=S,dt===n&&n!==null&&(dt=n=n.return);continue}break}while(1)}function Q2(){var t=uh.current;return uh.current=ch,t===null?ch:t}function jv(){(yt===0||yt===3||yt===2)&&(yt=4),bt===null||!(Qs&268435455)&&!(Tf&268435455)||Ri(bt,Nt)}function fh(t,e){var n=we;we|=2;var r=Q2();(bt!==t||Nt!==e)&&(Gr=null,Bs(t,e));do try{i5();break}catch(i){X2(t,i)}while(1);if(gv(),we=n,uh.current=r,dt!==null)throw Error(M(261));return bt=null,Nt=0,yt}function i5(){for(;dt!==null;)Y2(dt)}function s5(){for(;dt!==null&&!RN();)Y2(dt)}function Y2(t){var e=eT(t.alternate,t,bn);t.memoizedProps=t.pendingProps,e===null?J2(t):dt=e,Av.current=null}function J2(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=J3(n,e),n!==null){n.flags&=32767,dt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{yt=6,dt=null;return}}else if(n=Y3(n,e,bn),n!==null){dt=n;return}if(e=e.sibling,e!==null){dt=e;return}dt=e=t}while(e!==null);yt===0&&(yt=5)}function Is(t,e,n){var r=Te,i=Qn.transition;try{Qn.transition=null,Te=1,o5(t,e,n,r)}finally{Qn.transition=i,Te=r}return null}function o5(t,e,n,r){do aa();while(Fi!==null);if(we&6)throw Error(M(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(M(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(zN(t,s),t===bt&&(dt=bt=null,Nt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||qu||(qu=!0,tT(Kd,function(){return aa(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=Qn.transition,Qn.transition=null;var o=Te;Te=1;var a=we;we|=4,Av.current=null,e5(t,n),q2(n,t),T3(i0),Qd=!!r0,i0=r0=null,t.current=n,t5(n),PN(),we=a,Te=o,Qn.transition=s}else t.current=n;if(qu&&(qu=!1,Fi=t,hh=i),s=t.pendingLanes,s===0&&(Gi=null),jN(n.stateNode),gn(t,nt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(dh)throw dh=!1,t=b0,b0=null,t;return hh&1&&t.tag!==0&&aa(),s=t.pendingLanes,s&1?t===k0?Ul++:(Ul=0,k0=t):Ul=0,vs(),null}function aa(){if(Fi!==null){var t=Pk(hh),e=Qn.transition,n=Te;try{if(Qn.transition=null,Te=16>t?16:t,Fi===null)var r=!1;else{if(t=Fi,Fi=null,hh=0,we&6)throw Error(M(331));var i=we;for(we|=4,V=t.current;V!==null;){var s=V,o=s.child;if(V.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(V=c;V!==null;){var d=V;switch(d.tag){case 0:case 11:case 15:Bl(8,d,s)}var h=d.child;if(h!==null)h.return=d,V=h;else for(;V!==null;){d=V;var m=d.sibling,p=d.return;if(U2(d),d===c){V=null;break}if(m!==null){m.return=p,V=m;break}V=p}}}var y=s.alternate;if(y!==null){var x=y.child;if(x!==null){y.child=null;do{var E=x.sibling;x.sibling=null,x=E}while(x!==null)}}V=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,V=o;else e:for(;V!==null;){if(s=V,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Bl(9,s,s.return)}var v=s.sibling;if(v!==null){v.return=s.return,V=v;break e}V=s.return}}var g=t.current;for(V=g;V!==null;){o=V;var w=o.child;if(o.subtreeFlags&2064&&w!==null)w.return=o,V=w;else e:for(o=g;V!==null;){if(a=V,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:kf(9,a)}}catch(S){Xe(a,a.return,S)}if(a===o){V=null;break e}var _=a.sibling;if(_!==null){_.return=a.return,V=_;break e}V=a.return}}if(we=i,vs(),Rr&&typeof Rr.onPostCommitFiberRoot=="function")try{Rr.onPostCommitFiberRoot(yf,t)}catch{}r=!0}return r}finally{Te=n,Qn.transition=e}}return!1}function h_(t,e,n){e=Ea(n,e),e=N2(t,e,1),t=qi(t,e,1),e=rn(),t!==null&&(Qc(t,1,e),gn(t,e))}function Xe(t,e,n){if(t.tag===3)h_(t,t,n);else for(;e!==null;){if(e.tag===3){h_(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Gi===null||!Gi.has(r))){t=Ea(n,t),t=D2(e,t,1),e=qi(e,t,1),t=rn(),e!==null&&(Qc(e,1,t),gn(e,t));break}}e=e.return}}function a5(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=rn(),t.pingedLanes|=t.suspendedLanes&n,bt===t&&(Nt&n)===n&&(yt===4||yt===3&&(Nt&130023424)===Nt&&500>nt()-Pv?Bs(t,0):Rv|=n),gn(t,e)}function Z2(t,e){e===0&&(t.mode&1?(e=Mu,Mu<<=1,!(Mu&130023424)&&(Mu=4194304)):e=1);var n=rn();t=ci(t,e),t!==null&&(Qc(t,e,n),gn(t,n))}function l5(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),Z2(t,n)}function c5(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(M(314))}r!==null&&r.delete(e),Z2(t,n)}var eT;eT=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||mn.current)fn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return fn=!1,Q3(t,e,n);fn=!!(t.flags&131072)}else fn=!1,Ue&&e.flags&1048576&&r2(e,rh,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Id(t,e),t=e.pendingProps;var i=va(e,Kt.current);oa(e,n),i=bv(null,e,r,t,i,n);var s=kv();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,pn(r)?(s=!0,th(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,xv(e),i.updater=Sf,e.stateNode=i,i._reactInternals=e,f0(e,r,t,n),e=g0(null,e,r,!0,s,n)):(e.tag=0,Ue&&s&&hv(e),Zt(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Id(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=d5(r),t=ir(r,t),i){case 0:e=p0(null,e,r,t,n);break e;case 1:e=n_(null,e,r,t,n);break e;case 11:e=e_(null,e,r,t,n);break e;case 14:e=t_(null,e,r,ir(r.type,t),n);break e}throw Error(M(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:ir(r,i),p0(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:ir(r,i),n_(t,e,r,i,n);case 3:e:{if(L2(e),t===null)throw Error(M(387));r=e.pendingProps,s=e.memoizedState,i=s.element,a2(t,e),oh(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Ea(Error(M(423)),e),e=r_(t,e,r,n,i);break e}else if(r!==i){i=Ea(Error(M(424)),e),e=r_(t,e,r,n,i);break e}else for(Tn=Hi(e.stateNode.containerInfo.firstChild),Rn=e,Ue=!0,ar=null,n=d2(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(xa(),r===i){e=ui(t,e,n);break e}Zt(t,e,r,n)}e=e.child}return e;case 5:return h2(e),t===null&&u0(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,s0(r,i)?o=null:s!==null&&s0(r,s)&&(e.flags|=32),M2(t,e),Zt(t,e,o,n),e.child;case 6:return t===null&&u0(e),null;case 13:return F2(t,e,n);case 4:return wv(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=wa(e,null,r,n):Zt(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:ir(r,i),e_(t,e,r,i,n);case 7:return Zt(t,e,e.pendingProps,n),e.child;case 8:return Zt(t,e,e.pendingProps.children,n),e.child;case 12:return Zt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,Oe(ih,r._currentValue),r._currentValue=o,s!==null)if(mr(s.value,o)){if(s.children===i.children&&!mn.current){e=ui(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=ri(-1,n&-n),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var d=c.pending;d===null?l.next=l:(l.next=d.next,d.next=l),c.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),d0(s.return,n,e),a.lanes|=n;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(M(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),d0(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Zt(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,oa(e,n),i=Zn(i),r=r(i),e.flags|=1,Zt(t,e,r,n),e.child;case 14:return r=e.type,i=ir(r,e.pendingProps),i=ir(r.type,i),t_(t,e,r,i,n);case 15:return j2(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:ir(r,i),Id(t,e),e.tag=1,pn(r)?(t=!0,th(e)):t=!1,oa(e,n),c2(e,r,i),f0(e,r,i,n),g0(null,e,r,!0,t,n);case 19:return $2(t,e,n);case 22:return O2(t,e,n)}throw Error(M(156,e.tag))};function tT(t,e){return Ik(t,e)}function u5(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Xn(t,e,n,r){return new u5(t,e,n,r)}function Ov(t){return t=t.prototype,!(!t||!t.isReactComponent)}function d5(t){if(typeof t=="function")return Ov(t)?1:0;if(t!=null){if(t=t.$$typeof,t===ev)return 11;if(t===tv)return 14}return 2}function Xi(t,e){var n=t.alternate;return n===null?(n=Xn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Rd(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")Ov(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Vo:return Vs(n.children,i,s,e);case Zy:o=8,i|=8;break;case Lg:return t=Xn(12,n,e,i|2),t.elementType=Lg,t.lanes=s,t;case Fg:return t=Xn(13,n,e,i),t.elementType=Fg,t.lanes=s,t;case $g:return t=Xn(19,n,e,i),t.elementType=$g,t.lanes=s,t;case uk:return If(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case lk:o=10;break e;case ck:o=9;break e;case ev:o=11;break e;case tv:o=14;break e;case Ii:o=16,r=null;break e}throw Error(M(130,t==null?t:typeof t,""))}return e=Xn(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function Vs(t,e,n,r){return t=Xn(7,t,r,e),t.lanes=n,t}function If(t,e,n,r){return t=Xn(22,t,r,e),t.elementType=uk,t.lanes=n,t.stateNode={isHidden:!1},t}function Ip(t,e,n){return t=Xn(6,t,null,e),t.lanes=n,t}function Cp(t,e,n){return e=Xn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function h5(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=lp(0),this.expirationTimes=lp(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=lp(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Mv(t,e,n,r,i,s,o,a,l){return t=new h5(t,e,n,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Xn(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},xv(s),t}function f5(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Bo,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function nT(t){if(!t)return is;t=t._reactInternals;e:{if(vo(t)!==t||t.tag!==1)throw Error(M(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(pn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(M(171))}if(t.tag===1){var n=t.type;if(pn(n))return t2(t,n,e)}return e}function rT(t,e,n,r,i,s,o,a,l){return t=Mv(n,r,!0,t,i,s,o,a,l),t.context=nT(null),n=t.current,r=rn(),i=Ki(n),s=ri(r,i),s.callback=e??null,qi(n,s,i),t.current.lanes=i,Qc(t,i,r),gn(t,r),t}function Cf(t,e,n,r){var i=e.current,s=rn(),o=Ki(i);return n=nT(n),e.context===null?e.context=n:e.pendingContext=n,e=ri(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=qi(i,e,o),t!==null&&(fr(t,i,o,s),bd(t,i,o)),o}function mh(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function f_(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Lv(t,e){f_(t,e),(t=t.alternate)&&f_(t,e)}function m5(){return null}var iT=typeof reportError=="function"?reportError:function(t){console.error(t)};function Fv(t){this._internalRoot=t}Af.prototype.render=Fv.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(M(409));Cf(t,e,null,null)};Af.prototype.unmount=Fv.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Ys(function(){Cf(null,t,null,null)}),e[li]=null}};function Af(t){this._internalRoot=t}Af.prototype.unstable_scheduleHydration=function(t){if(t){var e=jk();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Ai.length&&e!==0&&e<Ai[n].priority;n++);Ai.splice(n,0,t),n===0&&Mk(t)}};function $v(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Rf(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function m_(){}function p5(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var c=mh(o);s.call(c)}}var o=rT(e,r,t,0,null,!1,!1,"",m_);return t._reactRootContainer=o,t[li]=o.current,lc(t.nodeType===8?t.parentNode:t),Ys(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var c=mh(l);a.call(c)}}var l=Mv(t,0,!1,null,null,!1,!1,"",m_);return t._reactRootContainer=l,t[li]=l.current,lc(t.nodeType===8?t.parentNode:t),Ys(function(){Cf(e,l,n,r)}),l}function Pf(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var l=mh(o);a.call(l)}}Cf(e,o,t,i)}else o=p5(n,e,t,i,r);return mh(o)}Nk=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Tl(e.pendingLanes);n!==0&&(iv(e,n|1),gn(e,nt()),!(we&6)&&(Sa=nt()+500,vs()))}break;case 13:Ys(function(){var r=ci(t,1);if(r!==null){var i=rn();fr(r,t,1,i)}}),Lv(t,1)}};sv=function(t){if(t.tag===13){var e=ci(t,134217728);if(e!==null){var n=rn();fr(e,t,134217728,n)}Lv(t,134217728)}};Dk=function(t){if(t.tag===13){var e=Ki(t),n=ci(t,e);if(n!==null){var r=rn();fr(n,t,e,r)}Lv(t,e)}};jk=function(){return Te};Ok=function(t,e){var n=Te;try{return Te=t,e()}finally{Te=n}};Xg=function(t,e,n){switch(e){case"input":if(Vg(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=_f(r);if(!i)throw Error(M(90));hk(r),Vg(r,i)}}}break;case"textarea":mk(t,n);break;case"select":e=n.value,e!=null&&na(t,!!n.multiple,e,!1)}};_k=Nv;Ek=Ys;var g5={usingClientEntryPoint:!1,Events:[Jc,qo,_f,xk,wk,Nv]},yl={findFiberByHostInstance:Ns,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},y5={bundleType:yl.bundleType,version:yl.version,rendererPackageName:yl.rendererPackageName,rendererConfig:yl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:yi.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=kk(t),t===null?null:t.stateNode},findFiberByHostInstance:yl.findFiberByHostInstance||m5,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Gu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Gu.isDisabled&&Gu.supportsFiber)try{yf=Gu.inject(y5),Rr=Gu}catch{}}Fn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=g5;Fn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!$v(e))throw Error(M(200));return f5(t,e,null,n)};Fn.createRoot=function(t,e){if(!$v(t))throw Error(M(299));var n=!1,r="",i=iT;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Mv(t,1,!1,null,null,n,!1,r,i),t[li]=e.current,lc(t.nodeType===8?t.parentNode:t),new Fv(e)};Fn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(M(188)):(t=Object.keys(t).join(","),Error(M(268,t)));return t=kk(e),t=t===null?null:t.stateNode,t};Fn.flushSync=function(t){return Ys(t)};Fn.hydrate=function(t,e,n){if(!Rf(e))throw Error(M(200));return Pf(null,t,e,!0,n)};Fn.hydrateRoot=function(t,e,n){if(!$v(t))throw Error(M(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=iT;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=rT(e,null,t,1,n??null,i,!1,s,o),t[li]=e.current,lc(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new Af(e)};Fn.render=function(t,e,n){if(!Rf(e))throw Error(M(200));return Pf(null,t,e,!1,n)};Fn.unmountComponentAtNode=function(t){if(!Rf(t))throw Error(M(40));return t._reactRootContainer?(Ys(function(){Pf(null,null,t,!1,function(){t._reactRootContainer=null,t[li]=null})}),!0):!1};Fn.unstable_batchedUpdates=Nv;Fn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Rf(n))throw Error(M(200));if(t==null||t._reactInternals===void 0)throw Error(M(38));return Pf(t,e,n,!1,r)};Fn.version="18.2.0-next-9e3b772b8-20220608";function sT(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(sT)}catch(t){console.error(t)}}sT(),rk.exports=Fn;var Ka=rk.exports,p_=Ka;Og.createRoot=p_.createRoot,Og.hydrateRoot=p_.hydrateRoot;/**
 * @remix-run/router v1.7.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ba(){return ba=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ba.apply(this,arguments)}var $i;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})($i||($i={}));const g_="popstate";function v5(t){t===void 0&&(t={});function e(i,s){let{pathname:o="/",search:a="",hash:l=""}=xo(i.location.hash.substr(1));return C0("",{pathname:o,search:a,hash:l},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(i,s){let o=i.document.querySelector("base"),a="";if(o&&o.getAttribute("href")){let l=i.location.href,c=l.indexOf("#");a=c===-1?l:l.slice(0,c)}return a+"#"+(typeof s=="string"?s:ph(s))}function r(i,s){Nf(i.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(s)+")")}return w5(e,n,r,t)}function st(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Nf(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function x5(){return Math.random().toString(36).substr(2,8)}function y_(t,e){return{usr:t.state,key:t.key,idx:e}}function C0(t,e,n,r){return n===void 0&&(n=null),ba({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?xo(e):e,{state:n,key:e&&e.key||r||x5()})}function ph(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function xo(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function w5(t,e,n,r){r===void 0&&(r={});let{window:i=document.defaultView,v5Compat:s=!1}=r,o=i.history,a=$i.Pop,l=null,c=d();c==null&&(c=0,o.replaceState(ba({},o.state,{idx:c}),""));function d(){return(o.state||{idx:null}).idx}function h(){a=$i.Pop;let E=d(),v=E==null?null:E-c;c=E,l&&l({action:a,location:x.location,delta:v})}function m(E,v){a=$i.Push;let g=C0(x.location,E,v);n&&n(g,E),c=d()+1;let w=y_(g,c),_=x.createHref(g);try{o.pushState(w,"",_)}catch(S){if(S instanceof DOMException&&S.name==="DataCloneError")throw S;i.location.assign(_)}s&&l&&l({action:a,location:x.location,delta:1})}function p(E,v){a=$i.Replace;let g=C0(x.location,E,v);n&&n(g,E),c=d();let w=y_(g,c),_=x.createHref(g);o.replaceState(w,"",_),s&&l&&l({action:a,location:x.location,delta:0})}function y(E){let v=i.location.origin!=="null"?i.location.origin:i.location.href,g=typeof E=="string"?E:ph(E);return st(v,"No window.location.(origin|href) available to create URL for href: "+g),new URL(g,v)}let x={get action(){return a},get location(){return t(i,o)},listen(E){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(g_,h),l=E,()=>{i.removeEventListener(g_,h),l=null}},createHref(E){return e(i,E)},createURL:y,encodeLocation(E){let v=y(E);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:m,replace:p,go(E){return o.go(E)}};return x}var v_;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(v_||(v_={}));function _5(t,e,n){n===void 0&&(n="/");let r=typeof e=="string"?xo(e):e,i=zv(r.pathname||"/",n);if(i==null)return null;let s=oT(t);E5(s);let o=null;for(let a=0;o==null&&a<s.length;++a)o=P5(s[a],j5(i));return o}function oT(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let i=(s,o,a)=>{let l={relativePath:a===void 0?s.path||"":a,caseSensitive:s.caseSensitive===!0,childrenIndex:o,route:s};l.relativePath.startsWith("/")&&(st(l.relativePath.startsWith(r),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(r.length));let c=Qi([r,l.relativePath]),d=n.concat(l);s.children&&s.children.length>0&&(st(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),oT(s.children,e,d,c)),!(s.path==null&&!s.index)&&e.push({path:c,score:A5(c,s.index),routesMeta:d})};return t.forEach((s,o)=>{var a;if(s.path===""||!((a=s.path)!=null&&a.includes("?")))i(s,o);else for(let l of aT(s.path))i(s,o,l)}),e}function aT(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,i=n.endsWith("?"),s=n.replace(/\?$/,"");if(r.length===0)return i?[s,""]:[s];let o=aT(r.join("/")),a=[];return a.push(...o.map(l=>l===""?s:[s,l].join("/"))),i&&a.push(...o),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function E5(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:R5(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const S5=/^:\w+$/,b5=3,k5=2,T5=1,I5=10,C5=-2,x_=t=>t==="*";function A5(t,e){let n=t.split("/"),r=n.length;return n.some(x_)&&(r+=C5),e&&(r+=k5),n.filter(i=>!x_(i)).reduce((i,s)=>i+(S5.test(s)?b5:s===""?T5:I5),r)}function R5(t,e){return t.length===e.length&&t.slice(0,-1).every((r,i)=>r===e[i])?t[t.length-1]-e[e.length-1]:0}function P5(t,e){let{routesMeta:n}=t,r={},i="/",s=[];for(let o=0;o<n.length;++o){let a=n[o],l=o===n.length-1,c=i==="/"?e:e.slice(i.length)||"/",d=N5({path:a.relativePath,caseSensitive:a.caseSensitive,end:l},c);if(!d)return null;Object.assign(r,d.params);let h=a.route;s.push({params:r,pathname:Qi([i,d.pathname]),pathnameBase:F5(Qi([i,d.pathnameBase])),route:h}),d.pathnameBase!=="/"&&(i=Qi([i,d.pathnameBase]))}return s}function N5(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=D5(t.path,t.caseSensitive,t.end),i=e.match(n);if(!i)return null;let s=i[0],o=s.replace(/(.)\/+$/,"$1"),a=i.slice(1);return{params:r.reduce((c,d,h)=>{if(d==="*"){let m=a[h]||"";o=s.slice(0,s.length-m.length).replace(/(.)\/+$/,"$1")}return c[d]=O5(a[h]||"",d),c},{}),pathname:s,pathnameBase:o,pattern:t}}function D5(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),Nf(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/\/:(\w+)/g,(o,a)=>(r.push(a),"/([^\\/]+)"));return t.endsWith("*")?(r.push("*"),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function j5(t){try{return decodeURI(t)}catch(e){return Nf(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function O5(t,e){try{return decodeURIComponent(t)}catch(n){return Nf(!1,'The value for the URL param "'+e+'" will not be decoded because'+(' the string "'+t+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+n+").")),t}}function zv(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function M5(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:i=""}=typeof t=="string"?xo(t):t;return{pathname:n?n.startsWith("/")?n:L5(n,e):e,search:$5(r),hash:z5(i)}}function L5(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function Ap(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Bv(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function Vv(t,e,n,r){r===void 0&&(r=!1);let i;typeof t=="string"?i=xo(t):(i=ba({},t),st(!i.pathname||!i.pathname.includes("?"),Ap("?","pathname","search",i)),st(!i.pathname||!i.pathname.includes("#"),Ap("#","pathname","hash",i)),st(!i.search||!i.search.includes("#"),Ap("#","search","hash",i)));let s=t===""||i.pathname==="",o=s?"/":i.pathname,a;if(r||o==null)a=n;else{let h=e.length-1;if(o.startsWith("..")){let m=o.split("/");for(;m[0]==="..";)m.shift(),h-=1;i.pathname=m.join("/")}a=h>=0?e[h]:"/"}let l=M5(i,a),c=o&&o!=="/"&&o.endsWith("/"),d=(s||o===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(c||d)&&(l.pathname+="/"),l}const Qi=t=>t.join("/").replace(/\/\/+/g,"/"),F5=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),$5=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,z5=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t,B5=function(e,n){n===void 0&&(n=302);let r=n;typeof r=="number"?r={status:r}:typeof r.status>"u"&&(r.status=302);let i=new Headers(r.headers);return i.set("Location",e),new Response(null,ba({},r,{headers:i}))};function V5(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const lT=["post","put","patch","delete"];new Set(lT);const U5=["get",...lT];new Set(U5);/**
 * React Router v6.14.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function gh(){return gh=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},gh.apply(this,arguments)}const Uv=f.createContext(null),W5=f.createContext(null),Xa=f.createContext(null),Df=f.createContext(null),Br=f.createContext({outlet:null,matches:[],isDataRoute:!1}),cT=f.createContext(null);function H5(t,e){let{relative:n}=e===void 0?{}:e;Qa()||st(!1);let{basename:r,navigator:i}=f.useContext(Xa),{hash:s,pathname:o,search:a}=dT(t,{relative:n}),l=o;return r!=="/"&&(l=o==="/"?r:Qi([r,o])),i.createHref({pathname:l,search:a,hash:s})}function Qa(){return f.useContext(Df)!=null}function zn(){return Qa()||st(!1),f.useContext(Df).location}function uT(t){f.useContext(Xa).static||f.useLayoutEffect(t)}function vn(){let{isDataRoute:t}=f.useContext(Br);return t?oD():q5()}function q5(){Qa()||st(!1);let t=f.useContext(Uv),{basename:e,navigator:n}=f.useContext(Xa),{matches:r}=f.useContext(Br),{pathname:i}=zn(),s=JSON.stringify(Bv(r).map(l=>l.pathnameBase)),o=f.useRef(!1);return uT(()=>{o.current=!0}),f.useCallback(function(l,c){if(c===void 0&&(c={}),!o.current)return;if(typeof l=="number"){n.go(l);return}let d=Vv(l,JSON.parse(s),i,c.relative==="path");t==null&&e!=="/"&&(d.pathname=d.pathname==="/"?e:Qi([e,d.pathname])),(c.replace?n.replace:n.push)(d,c.state,c)},[e,n,s,i,t])}const G5=f.createContext(null);function K5(t){let e=f.useContext(Br).outlet;return e&&f.createElement(G5.Provider,{value:t},e)}function jf(){let{matches:t}=f.useContext(Br),e=t[t.length-1];return e?e.params:{}}function dT(t,e){let{relative:n}=e===void 0?{}:e,{matches:r}=f.useContext(Br),{pathname:i}=zn(),s=JSON.stringify(Bv(r).map(o=>o.pathnameBase));return f.useMemo(()=>Vv(t,JSON.parse(s),i,n==="path"),[t,s,i,n])}function X5(t,e){return Q5(t,e)}function Q5(t,e,n){Qa()||st(!1);let{navigator:r}=f.useContext(Xa),{matches:i}=f.useContext(Br),s=i[i.length-1],o=s?s.params:{};s&&s.pathname;let a=s?s.pathnameBase:"/";s&&s.route;let l=zn(),c;if(e){var d;let x=typeof e=="string"?xo(e):e;a==="/"||(d=x.pathname)!=null&&d.startsWith(a)||st(!1),c=x}else c=l;let h=c.pathname||"/",m=a==="/"?h:h.slice(a.length)||"/",p=_5(t,{pathname:m}),y=tD(p&&p.map(x=>Object.assign({},x,{params:Object.assign({},o,x.params),pathname:Qi([a,r.encodeLocation?r.encodeLocation(x.pathname).pathname:x.pathname]),pathnameBase:x.pathnameBase==="/"?a:Qi([a,r.encodeLocation?r.encodeLocation(x.pathnameBase).pathname:x.pathnameBase])})),i,n);return e&&y?f.createElement(Df.Provider,{value:{location:gh({pathname:"/",search:"",hash:"",state:null,key:"default"},c),navigationType:$i.Pop}},y):y}function Y5(){let t=sD(),e=V5(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},s=null;return f.createElement(f.Fragment,null,f.createElement("h2",null,"Unexpected Application Error!"),f.createElement("h3",{style:{fontStyle:"italic"}},e),n?f.createElement("pre",{style:i},n):null,s)}const J5=f.createElement(Y5,null);class Z5 extends f.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error||n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error?f.createElement(Br.Provider,{value:this.props.routeContext},f.createElement(cT.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function eD(t){let{routeContext:e,match:n,children:r}=t,i=f.useContext(Uv);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),f.createElement(Br.Provider,{value:e},r)}function tD(t,e,n){var r;if(e===void 0&&(e=[]),n===void 0&&(n=null),t==null){var i;if((i=n)!=null&&i.errors)t=n.matches;else return null}let s=t,o=(r=n)==null?void 0:r.errors;if(o!=null){let a=s.findIndex(l=>l.route.id&&(o==null?void 0:o[l.route.id]));a>=0||st(!1),s=s.slice(0,Math.min(s.length,a+1))}return s.reduceRight((a,l,c)=>{let d=l.route.id?o==null?void 0:o[l.route.id]:null,h=null;n&&(h=l.route.errorElement||J5);let m=e.concat(s.slice(0,c+1)),p=()=>{let y;return d?y=h:l.route.Component?y=f.createElement(l.route.Component,null):l.route.element?y=l.route.element:y=a,f.createElement(eD,{match:l,routeContext:{outlet:a,matches:m,isDataRoute:n!=null},children:y})};return n&&(l.route.ErrorBoundary||l.route.errorElement||c===0)?f.createElement(Z5,{location:n.location,revalidation:n.revalidation,component:h,error:d,children:p(),routeContext:{outlet:null,matches:m,isDataRoute:!0}}):p()},null)}var A0;(function(t){t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate"})(A0||(A0={}));var yc;(function(t){t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId"})(yc||(yc={}));function nD(t){let e=f.useContext(Uv);return e||st(!1),e}function rD(t){let e=f.useContext(W5);return e||st(!1),e}function iD(t){let e=f.useContext(Br);return e||st(!1),e}function hT(t){let e=iD(),n=e.matches[e.matches.length-1];return n.route.id||st(!1),n.route.id}function sD(){var t;let e=f.useContext(cT),n=rD(yc.UseRouteError),r=hT(yc.UseRouteError);return e||((t=n.errors)==null?void 0:t[r])}function oD(){let{router:t}=nD(A0.UseNavigateStable),e=hT(yc.UseNavigateStable),n=f.useRef(!1);return uT(()=>{n.current=!0}),f.useCallback(function(i,s){s===void 0&&(s={}),n.current&&(typeof i=="number"?t.navigate(i):t.navigate(i,gh({fromRouteId:e},s)))},[t,e])}function aD(t){let{to:e,replace:n,state:r,relative:i}=t;Qa()||st(!1);let{matches:s}=f.useContext(Br),{pathname:o}=zn(),a=vn(),l=Vv(e,Bv(s).map(d=>d.pathnameBase),o,i==="path"),c=JSON.stringify(l);return f.useEffect(()=>a(JSON.parse(c),{replace:n,state:r,relative:i}),[a,c,i,n,r]),null}function fT(t){return K5(t.context)}function Ti(t){st(!1)}function lD(t){let{basename:e="/",children:n=null,location:r,navigationType:i=$i.Pop,navigator:s,static:o=!1}=t;Qa()&&st(!1);let a=e.replace(/^\/*/,"/"),l=f.useMemo(()=>({basename:a,navigator:s,static:o}),[a,s,o]);typeof r=="string"&&(r=xo(r));let{pathname:c="/",search:d="",hash:h="",state:m=null,key:p="default"}=r,y=f.useMemo(()=>{let x=zv(c,a);return x==null?null:{location:{pathname:x,search:d,hash:h,state:m,key:p},navigationType:i}},[a,c,d,h,m,p,i]);return y==null?null:f.createElement(Xa.Provider,{value:l},f.createElement(Df.Provider,{children:n,value:y}))}function cD(t){let{children:e,location:n}=t;return X5(R0(e),n)}var w_;(function(t){t[t.pending=0]="pending",t[t.success=1]="success",t[t.error=2]="error"})(w_||(w_={}));new Promise(()=>{});function R0(t,e){e===void 0&&(e=[]);let n=[];return f.Children.forEach(t,(r,i)=>{if(!f.isValidElement(r))return;let s=[...e,i];if(r.type===f.Fragment){n.push.apply(n,R0(r.props.children,s));return}r.type!==Ti&&st(!1),!r.props.index||!r.props.children||st(!1);let o={id:r.props.id||s.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=R0(r.props.children,s)),n.push(o)}),n}/**
 * React Router DOM v6.14.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function P0(){return P0=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},P0.apply(this,arguments)}function uD(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function dD(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function hD(t,e){return t.button===0&&(!e||e==="_self")&&!dD(t)}const fD=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset"],mD="startTransition",__=Xy[mD];function pD(t){let{basename:e,children:n,future:r,window:i}=t,s=f.useRef();s.current==null&&(s.current=v5({window:i,v5Compat:!0}));let o=s.current,[a,l]=f.useState({action:o.action,location:o.location}),{v7_startTransition:c}=r||{},d=f.useCallback(h=>{c&&__?__(()=>l(h)):l(h)},[l,c]);return f.useLayoutEffect(()=>o.listen(d),[o,d]),f.createElement(lD,{basename:e,children:n,location:a.location,navigationType:a.action,navigator:o})}const gD=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",yD=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Yi=f.forwardRef(function(e,n){let{onClick:r,relative:i,reloadDocument:s,replace:o,state:a,target:l,to:c,preventScrollReset:d}=e,h=uD(e,fD),{basename:m}=f.useContext(Xa),p,y=!1;if(typeof c=="string"&&yD.test(c)&&(p=c,gD))try{let g=new URL(window.location.href),w=c.startsWith("//")?new URL(g.protocol+c):new URL(c),_=zv(w.pathname,m);w.origin===g.origin&&_!=null?c=_+w.search+w.hash:y=!0}catch{}let x=H5(c,{relative:i}),E=vD(c,{replace:o,state:a,target:l,preventScrollReset:d,relative:i});function v(g){r&&r(g),g.defaultPrevented||E(g)}return f.createElement("a",P0({},h,{href:p||x,onClick:y||s?r:v,ref:n,target:l}))});var E_;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher"})(E_||(E_={}));var S_;(function(t){t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(S_||(S_={}));function vD(t,e){let{target:n,replace:r,state:i,preventScrollReset:s,relative:o}=e===void 0?{}:e,a=vn(),l=zn(),c=dT(t,{relative:o});return f.useCallback(d=>{if(hD(d,n)){d.preventDefault();let h=r!==void 0?r:ph(l)===ph(c);a(t,{replace:h,state:i,preventScrollReset:s,relative:o})}},[l,a,c,r,i,n,t,s,o])}function mT(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t))for(e=0;e<t.length;e++)t[e]&&(n=mT(t[e]))&&(r&&(r+=" "),r+=n);else for(e in t)t[e]&&(r&&(r+=" "),r+=e);return r}function xD(){for(var t,e,n=0,r="";n<arguments.length;)(t=arguments[n++])&&(e=mT(t))&&(r&&(r+=" "),r+=e);return r}const b_=t=>typeof t=="boolean"?"".concat(t):t===0?"0":t,k_=xD,pT=(t,e)=>n=>{var r;if((e==null?void 0:e.variants)==null)return k_(t,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:i,defaultVariants:s}=e,o=Object.keys(i).map(c=>{const d=n==null?void 0:n[c],h=s==null?void 0:s[c];if(d===null)return null;const m=b_(d)||b_(h);return i[c][m]}),a=n&&Object.entries(n).reduce((c,d)=>{let[h,m]=d;return m===void 0||(c[h]=m),c},{}),l=e==null||(r=e.compoundVariants)===null||r===void 0?void 0:r.reduce((c,d)=>{let{class:h,className:m,...p}=d;return Object.entries(p).every(y=>{let[x,E]=y;return Array.isArray(E)?E.includes({...s,...a}[x]):{...s,...a}[x]===E})?[...c,h,m]:c},[]);return k_(t,o,l,n==null?void 0:n.class,n==null?void 0:n.className)};function wD({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 6h9.75M10.5 6a1.5 1.5 0 11-3 0m3 0a1.5 1.5 0 10-3 0M3.75 6H7.5m3 12h9.75m-9.75 0a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0m-3.75 0H7.5m9-6h3.75m-3.75 0a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0m-9.75 0h9.75"}))}const _D=f.forwardRef(wD),gT=_D;function ED({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3"}))}const SD=f.forwardRef(ED),bD=SD;function kD({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6a2.25 2.25 0 00-2.25 2.25v13.5A2.25 2.25 0 007.5 21h6a2.25 2.25 0 002.25-2.25V15M12 9l-3 3m0 0l3 3m-3-3h12.75"}))}const TD=f.forwardRef(kD),ID=TD;function CD({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 12c0-1.232-.046-2.453-.138-3.662a4.006 4.006 0 00-3.7-3.7 48.678 48.678 0 00-7.324 0 4.006 4.006 0 00-3.7 3.7c-.017.22-.032.441-.046.662M19.5 12l3-3m-3 3l-3-3m-12 3c0 1.232.046 2.453.138 3.662a4.006 4.006 0 003.7 3.7 48.656 48.656 0 007.324 0 4.006 4.006 0 003.7-3.7c.017-.22.032-.441.046-.662M4.5 12l3 3m-3-3l-3 3"}))}const AD=f.forwardRef(CD),RD=AD;function PD({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99"}))}const ND=f.forwardRef(PD),Js=ND;function DD({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6a2.25 2.25 0 00-2.25 2.25v13.5A2.25 2.25 0 007.5 21h6a2.25 2.25 0 002.25-2.25V15m3 0l3-3m0 0l-3-3m3 3H9"}))}const jD=f.forwardRef(DD),Wv=jD;function OD({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 18L9 11.25l4.306 4.307a11.95 11.95 0 015.814-5.519l2.74-1.22m0 0l-5.94-2.28m5.94 2.28l-2.28 5.941"}))}const MD=f.forwardRef(OD),LD=MD;function FD({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5m-13.5-9L12 3m0 0l4.5 4.5M12 3v13.5"}))}const $D=f.forwardRef(FD),zD=$D;function BD({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 16.811c0 .864-.933 1.405-1.683.977l-7.108-4.062a1.125 1.125 0 010-1.953l7.108-4.062A1.125 1.125 0 0121 8.688v8.123zM11.25 16.811c0 .864-.933 1.405-1.683.977l-7.108-4.062a1.125 1.125 0 010-1.953L9.567 7.71a1.125 1.125 0 011.683.977v8.123z"}))}const VD=f.forwardRef(BD),UD=VD;function WD({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}))}const HD=f.forwardRef(WD),yT=HD;function qD({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 12.75l6 6 9-13.5"}))}const GD=f.forwardRef(qD),Pd=GD;function KD({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18.75 19.5l-7.5-7.5 7.5-7.5m-6 15L5.25 12l7.5-7.5"}))}const XD=f.forwardRef(KD),QD=XD;function YD({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.25 4.5l7.5 7.5-7.5 7.5m-6-15l7.5 7.5-7.5 7.5"}))}const JD=f.forwardRef(YD),ZD=JD;function ej({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 8.25l-7.5 7.5-7.5-7.5"}))}const tj=f.forwardRef(ej),nj=tj;function rj({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5L8.25 12l7.5-7.5"}))}const ij=f.forwardRef(rj),sj=ij;function oj({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 4.5l7.5 7.5-7.5 7.5"}))}const aj=f.forwardRef(oj),Rp=aj;function lj({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 15.75l7.5-7.5 7.5 7.5"}))}const cj=f.forwardRef(lj),uj=cj;function dj({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z"}))}const hj=f.forwardRef(dj),vT=hj;function fj({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.324.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 011.37.49l1.296 2.247a1.125 1.125 0 01-.26 1.431l-1.003.827c-.293.24-.438.613-.431.992a6.759 6.759 0 010 .255c-.007.378.138.75.43.99l1.005.828c.424.35.534.954.26 1.43l-1.298 2.247a1.125 1.125 0 01-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.57 6.57 0 01-.22.128c-.331.183-.581.495-.644.869l-.213 1.28c-.09.543-.56.941-1.11.941h-2.594c-.55 0-1.02-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 01-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 01-1.369-.49l-1.297-2.247a1.125 1.125 0 01.26-1.431l1.004-.827c.292-.24.437-.613.43-.992a6.932 6.932 0 010-.255c.007-.378-.138-.75-.43-.99l-1.004-.828a1.125 1.125 0 01-.26-1.43l1.297-2.247a1.125 1.125 0 011.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.087.22-.128.332-.183.582-.495.644-.869l.214-1.281z"}),f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}))}const mj=f.forwardRef(fj),xT=mj;function pj({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 17.25v1.007a3 3 0 01-.879 2.122L7.5 21h9l-.621-.621A3 3 0 0115 18.257V17.25m6-12V15a2.25 2.25 0 01-2.25 2.25H5.25A2.25 2.25 0 013 15V5.25m18 0A2.25 2.25 0 0018.75 3H5.25A2.25 2.25 0 003 5.25m18 0V12a2.25 2.25 0 01-2.25 2.25H5.25A2.25 2.25 0 013 12V5.25"}))}const gj=f.forwardRef(pj),yj=gj;function vj({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z"}))}const xj=f.forwardRef(vj),wj=xj;function _j({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m9-.75a9 9 0 11-18 0 9 9 0 0118 0zm-9 3.75h.008v.008H12v-.008z"}))}const Ej=f.forwardRef(_j),Hv=Ej;function Sj({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 8.688c0-.864.933-1.405 1.683-.977l7.108 4.062a1.125 1.125 0 010 1.953l-7.108 4.062A1.125 1.125 0 013 16.81V8.688zM12.75 8.688c0-.864.933-1.405 1.683-.977l7.108 4.062a1.125 1.125 0 010 1.953l-7.108 4.062a1.125 1.125 0 01-1.683-.977V8.688z"}))}const bj=f.forwardRef(Sj),wT=bj;function kj({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12z"}))}const Tj=f.forwardRef(kj),_T=Tj;function Ij({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 12l8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25"}))}const Cj=f.forwardRef(Ij),Aj=Cj;function Rj({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z"}))}const Pj=f.forwardRef(Rj),ET=Pj;function Nj({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z"}))}const Dj=f.forwardRef(Nj),T_=Dj;function jj({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 12h-15"}))}const Oj=f.forwardRef(jj),ST=Oj;function Mj({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 9l10.5-3m0 6.553v3.75a2.25 2.25 0 01-1.632 2.163l-1.32.377a1.803 1.803 0 11-.99-3.467l2.31-.66a2.25 2.25 0 001.632-2.163zm0 0V2.25L9 5.25v10.303m0 0v3.75a2.25 2.25 0 01-1.632 2.163l-1.32.377a1.803 1.803 0 01-.99-3.467l2.31-.66A2.25 2.25 0 009 15.553z"}))}const Lj=f.forwardRef(Mj),ka=Lj;function Fj({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.53 16.122a3 3 0 00-5.78 1.128 2.25 2.25 0 01-2.4 2.245 4.5 4.5 0 008.4-2.245c0-.399-.078-.78-.22-1.128zm0 0a15.998 15.998 0 003.388-1.62m-5.043-.025a15.994 15.994 0 011.622-3.395m3.42 3.42a15.995 15.995 0 004.764-4.648l3.876-5.814a1.151 1.151 0 00-1.597-1.597L14.146 6.32a15.996 15.996 0 00-4.649 4.763m3.42 3.42a6.776 6.776 0 00-3.42-3.42"}))}const $j=f.forwardRef(Fj),bT=$j;function zj({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.25 9v6m-4.5 0V9M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}))}const Bj=f.forwardRef(zj),qv=Bj;function Vj({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10"}))}const Uj=f.forwardRef(Vj),kT=Uj;function Wj({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}),f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.91 11.672a.375.375 0 010 .656l-5.603 3.113a.375.375 0 01-.557-.328V8.887c0-.286.307-.466.557-.327l5.603 3.112z"}))}const Hj=f.forwardRef(Wj),Gv=Hj;function qj({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 5.653c0-.856.917-1.398 1.667-.986l11.54 6.348a1.125 1.125 0 010 1.971l-11.54 6.347a1.125 1.125 0 01-1.667-.985V5.653z"}))}const Gj=f.forwardRef(qj),I_=Gj;function Kj({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v6m3-3H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z"}))}const Xj=f.forwardRef(Kj),yh=Xj;function Qj({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"}))}const Yj=f.forwardRef(Qj),zi=Yj;function Jj({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442-.745.361-1.45.999-1.45 1.827v.75M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9 5.25h.008v.008H12v-.008z"}))}const Zj=f.forwardRef(Jj),eO=Zj;function tO({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 12h16.5m-16.5 3.75h16.5M3.75 19.5h16.5M5.625 4.5h12.75a1.875 1.875 0 010 3.75H5.625a1.875 1.875 0 010-3.75z"}))}const nO=f.forwardRef(tO),rO=nO;function iO({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.114 5.636a9 9 0 010 12.728M16.463 8.288a5.25 5.25 0 010 7.424M6.75 8.25l4.72-4.72a.75.75 0 011.28.53v15.88a.75.75 0 01-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.01 9.01 0 012.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75z"}))}const sO=f.forwardRef(iO),oO=sO;function aO({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17.25 9.75L19.5 12m0 0l2.25 2.25M19.5 12l2.25-2.25M19.5 12l-2.25 2.25m-10.5-6l4.72-4.72a.75.75 0 011.28.531V19.94a.75.75 0 01-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.506-1.938-1.354A9.01 9.01 0 012.25 12c0-.83.112-1.633.322-2.395C2.806 8.757 3.63 8.25 4.51 8.25H6.75z"}))}const lO=f.forwardRef(aO),cO=lO;function uO({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 7.5A2.25 2.25 0 017.5 5.25h9a2.25 2.25 0 012.25 2.25v9a2.25 2.25 0 01-2.25 2.25h-9a2.25 2.25 0 01-2.25-2.25v-9z"}))}const dO=f.forwardRef(uO),vc=dO;function hO({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"}))}const fO=f.forwardRef(hO),xc=fO;function mO({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.75 9.75l4.5 4.5m0-4.5l-4.5 4.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}))}const pO=f.forwardRef(mO),gO=pO;function yO({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"}))}const vO=f.forwardRef(yO),Os=vO,xO=pT("inline-flex font-[500] items-center ",{variants:{variant:{default:"",circle:"rounded-[99px] justify-center",list:"flex items-center py-[5px] w-full",primary:"px-[16px] py-[4px]",outline:"border rounded-full"},size:{clear:"",half:"w-1/2",full:"w-full",small:"px-[10px] py-[3px]",normal:"px-[16px] py-[4px]",large:"h-[40px] w-[40px]"},hover:{default:"hover:brightness-90",scale:"transition-transform hover:scale-[1.05]",clear:""}},defaultVariants:{variant:"default",size:"normal",hover:"default"}}),X=({className:t,children:e,variant:n,size:r,disabled:i,isLoading:s,hover:o,onClick:a,...l})=>u.jsxs("button",{type:"button",onClick:c=>a?a(c):"",...l,className:xO({variant:n,size:r,hover:o,className:t}),disabled:s||i,children:[s?u.jsx(Js,{className:"w-[22px] animate-spin"}):null,!s&&e]}),vh=[{name:"Red",id:"red",type:"dark",bottom_player_bg:"bg-[#3b1113]",side_bar_bg:"bg-[#391b1c]",content_text:"text-[#ca4954]",content_hover_text:"hover:text-[#ca4954]",content_border:"border-[#ca4954]",content_hover_border:"hover:border-[#ca4954]",content_bg:"!bg-[#ca4954]  text-[#fff]",content_code:"#ca4954",content_hover_bg:"hover:!bg-[#ca4954] hover:text-[#fff] ",container:"bg-[#2e0f10]"},{name:"Black",id:"black",type:"dark",bottom_player_bg:"bg-[#181818]",side_bar_bg:"bg-[#242424]",content_text:"text-[#198585]",content_hover_text:"hover:text-[#198585]",content_border:"border-[#198585]",content_hover_border:"hover:border-[#198585]",content_bg:"!bg-[#198585]  text-[#fff]",content_code:"#198585",content_hover_bg:"hover:!bg-[#198585] hover:text-[#fff] ",container:"bg-[#1e1e1e]"},{name:"Deep blue",id:"deep_blue",type:"dark",bottom_player_bg:"bg-[#111f3b]",side_bar_bg:"bg-[#1b2639]",content_text:"text-[#0c9e85]",content_hover_text:"hover:text-[#0c9e85]",content_border:"border-[#0c9e85]",content_hover_border:"hover:border-[#0c9e85]",content_bg:"!bg-[#0c9e85]  text-[#fff]",content_code:"#0c9e85",content_hover_bg:"hover:!bg-[#0c9e85] hover:text-[#fff] ",container:"bg-[#0f1a2e]"},{name:"White",id:"white",type:"light",bottom_player_bg:"bg-[#fff]",side_bar_bg:"bg-[#f2f2f2]",content_text:"text-[#198585]",content_hover_text:"hover:text-[#198585]",content_border:"border-[#198585]",content_hover_border:"hover:border-[#198585]",content_bg:"!bg-[#198585] text-[#fff]",content_code:"#198585",content_hover_bg:"hover:!bg-[#198585] hover:text-[#fff]",container:"bg-[#fff]"},{name:"Light green",id:"green_light",type:"light",bottom_player_bg:"bg-[#c0d8d8]",side_bar_bg:"bg-[#dde5e5]",content_text:"text-[#198585]",content_hover_text:"hover:text-[#198585]",content_border:"border-[#198585]",content_hover_border:"hover:border-[#198585]",content_bg:"!bg-[#198585] text-[#fff]",content_code:"#198585",content_hover_bg:"hover:!bg-[#198585] hover:text-[#fff]",container:"bg-[#ced9d9]"},{name:"Brown",id:"gray",type:"light",bottom_player_bg:"bg-[#dedad1]",side_bar_bg:"bg-[#d9d7d4]",content_text:"text-[#644646]",content_hover_text:"hover:text-[#644646]",content_border:"border-[#644646]",content_hover_border:"hover:border-[#644646]",content_bg:"!bg-[#644646]  text-[#fff]",content_code:"#644646",content_hover_bg:"hover:!bg-[#644646] hover:text-[#fff]",container:"bg-[#e5e3df]"}],wO="End-Of-Stream";class it extends Error{constructor(){super(wO)}}class _O{constructor(){this.maxStreamReadSize=1*1024*1024,this.endOfStream=!1,this.peekQueue=[]}async peek(e,n,r){const i=await this.read(e,n,r);return this.peekQueue.push(e.subarray(n,n+i)),i}async read(e,n,r){if(r===0)return 0;let i=this.readFromPeekBuffer(e,n,r);if(i+=await this.readRemainderFromStream(e,n+i,r-i),i===0)throw new it;return i}readFromPeekBuffer(e,n,r){let i=r,s=0;for(;this.peekQueue.length>0&&i>0;){const o=this.peekQueue.pop();if(!o)throw new Error("peekData should be defined");const a=Math.min(o.length,i);e.set(o.subarray(0,a),n+s),s+=a,i-=a,a<o.length&&this.peekQueue.push(o.subarray(a))}return s}async readRemainderFromStream(e,n,r){let i=r,s=0;for(;i>0&&!this.endOfStream;){const o=Math.min(i,this.maxStreamReadSize),a=await this.readFromStream(e,n+s,o);if(a===0)break;s+=a,i-=a}return s}}class EO extends _O{constructor(e){super(),this.reader=e.getReader({mode:"byob"})}async readFromStream(e,n,r){if(this.endOfStream)throw new it;const i=await this.reader.read(new Uint8Array(r));return i.done&&(this.endOfStream=i.done),i.value?(e.set(i.value,n),i.value.byteLength):0}}class TT{constructor(e){this.position=0,this.numBuffer=new Uint8Array(8),this.fileInfo=(e==null?void 0:e.fileInfo)??{},this.onClose=e==null?void 0:e.onClose}async readToken(e,n=this.position){const r=new Uint8Array(e.len);if(await this.readBuffer(r,{position:n})<e.len)throw new it;return e.get(r,0)}async peekToken(e,n=this.position){const r=new Uint8Array(e.len);if(await this.peekBuffer(r,{position:n})<e.len)throw new it;return e.get(r,0)}async readNumber(e){if(await this.readBuffer(this.numBuffer,{length:e.len})<e.len)throw new it;return e.get(this.numBuffer,0)}async peekNumber(e){if(await this.peekBuffer(this.numBuffer,{length:e.len})<e.len)throw new it;return e.get(this.numBuffer,0)}async ignore(e){if(this.fileInfo.size!==void 0){const n=this.fileInfo.size-this.position;if(e>n)return this.position+=n,n}return this.position+=e,e}async close(){var e;await((e=this.onClose)==null?void 0:e.call(this))}normalizeOptions(e,n){if(n&&n.position!==void 0&&n.position<this.position)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");return n?{mayBeLess:n.mayBeLess===!0,offset:n.offset?n.offset:0,length:n.length?n.length:e.length-(n.offset?n.offset:0),position:n.position?n.position:this.position}:{mayBeLess:!1,offset:0,length:e.length,position:this.position}}}const SO=256e3;class bO extends TT{constructor(e,n){super(n),this.streamReader=e}async readBuffer(e,n){const r=this.normalizeOptions(e,n),i=r.position-this.position;if(i>0)return await this.ignore(i),this.readBuffer(e,n);if(i<0)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");if(r.length===0)return 0;const s=await this.streamReader.read(e,r.offset,r.length);if(this.position+=s,(!n||!n.mayBeLess)&&s<r.length)throw new it;return s}async peekBuffer(e,n){const r=this.normalizeOptions(e,n);let i=0;if(r.position){const s=r.position-this.position;if(s>0){const o=new Uint8Array(r.length+s);return i=await this.peekBuffer(o,{mayBeLess:r.mayBeLess}),e.set(o.subarray(s),r.offset),i-s}if(s<0)throw new Error("Cannot peek from a negative offset in a stream")}if(r.length>0){try{i=await this.streamReader.peek(e,r.offset,r.length)}catch(s){if(n!=null&&n.mayBeLess&&s instanceof it)return 0;throw s}if(!r.mayBeLess&&i<r.length)throw new it}return i}async ignore(e){const n=Math.min(SO,e),r=new Uint8Array(n);let i=0;for(;i<e;){const s=e-i,o=await this.readBuffer(r,{length:Math.min(n,s)});if(o<0)return o;i+=o}return i}}class kO extends TT{constructor(e,n){super(n),this.uint8Array=e,this.fileInfo.size=this.fileInfo.size?this.fileInfo.size:e.length}async readBuffer(e,n){if(n!=null&&n.position){if(n.position<this.position)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");this.position=n.position}const r=await this.peekBuffer(e,n);return this.position+=r,r}async peekBuffer(e,n){const r=this.normalizeOptions(e,n),i=Math.min(this.uint8Array.length-r.position,r.length);if(!r.mayBeLess&&i<r.length)throw new it;return e.set(this.uint8Array.subarray(r.position,r.position+i),r.offset),i}close(){return super.close()}}function IT(t,e){return new bO(new EO(t),e)}function Ta(t,e){return new kO(t,e)}/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */var Of=function(t,e,n,r,i){var s,o,a=i*8-r-1,l=(1<<a)-1,c=l>>1,d=-7,h=n?i-1:0,m=n?-1:1,p=t[e+h];for(h+=m,s=p&(1<<-d)-1,p>>=-d,d+=a;d>0;s=s*256+t[e+h],h+=m,d-=8);for(o=s&(1<<-d)-1,s>>=-d,d+=r;d>0;o=o*256+t[e+h],h+=m,d-=8);if(s===0)s=1-c;else{if(s===l)return o?NaN:(p?-1:1)*(1/0);o=o+Math.pow(2,r),s=s-c}return(p?-1:1)*o*Math.pow(2,s-r)},Mf=function(t,e,n,r,i,s){var o,a,l,c=s*8-i-1,d=(1<<c)-1,h=d>>1,m=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:s-1,y=r?1:-1,x=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=d):(o=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-o))<1&&(o--,l*=2),o+h>=1?e+=m/l:e+=m*Math.pow(2,1-h),e*l>=2&&(o++,l/=2),o+h>=d?(a=0,o=d):o+h>=1?(a=(e*l-1)*Math.pow(2,i),o=o+h):(a=e*Math.pow(2,h-1)*Math.pow(2,i),o=0));i>=8;t[n+p]=a&255,p+=y,a/=256,i-=8);for(o=o<<i|a,c+=i;c>0;t[n+p]=o&255,p+=y,o/=256,c-=8);t[n+p-y]|=x*128};function ue(t){return new DataView(t.buffer,t.byteOffset)}const he={len:1,get(t,e){return ue(t).getUint8(e)},put(t,e,n){return ue(t).setUint8(e,n),e+1}},ke={len:2,get(t,e){return ue(t).getUint16(e,!0)},put(t,e,n){return ue(t).setUint16(e,n,!0),e+2}},Re={len:2,get(t,e){return ue(t).getUint16(e)},put(t,e,n){return ue(t).setUint16(e,n),e+2}},xh={len:3,get(t,e){const n=ue(t);return n.getUint8(e)+(n.getUint16(e+1,!0)<<8)},put(t,e,n){const r=ue(t);return r.setUint8(e,n&255),r.setUint16(e+1,n>>8,!0),e+3}},sn={len:3,get(t,e){const n=ue(t);return(n.getUint16(e)<<8)+n.getUint8(e+2)},put(t,e,n){const r=ue(t);return r.setUint16(e,n>>8),r.setUint8(e+2,n&255),e+3}},J={len:4,get(t,e){return ue(t).getUint32(e,!0)},put(t,e,n){return ue(t).setUint32(e,n,!0),e+4}},re={len:4,get(t,e){return ue(t).getUint32(e)},put(t,e,n){return ue(t).setUint32(e,n),e+4}},wc={len:1,get(t,e){return ue(t).getInt8(e)},put(t,e,n){return ue(t).setInt8(e,n),e+1}},Jr={len:2,get(t,e){return ue(t).getInt16(e)},put(t,e,n){return ue(t).setInt16(e,n),e+2}},TO={len:2,get(t,e){return ue(t).getInt16(e,!0)},put(t,e,n){return ue(t).setInt16(e,n,!0),e+2}},IO={len:3,get(t,e){const n=xh.get(t,e);return n>8388607?n-16777216:n},put(t,e,n){const r=ue(t);return r.setUint8(e,n&255),r.setUint16(e+1,n>>8,!0),e+3}},Kv={len:3,get(t,e){const n=sn.get(t,e);return n>8388607?n-16777216:n},put(t,e,n){const r=ue(t);return r.setUint16(e,n>>8),r.setUint8(e+2,n&255),e+3}},Pn={len:4,get(t,e){return ue(t).getInt32(e)},put(t,e,n){return ue(t).setInt32(e,n),e+4}},tt={len:4,get(t,e){return ue(t).getInt32(e,!0)},put(t,e,n){return ue(t).setInt32(e,n,!0),e+4}},en={len:8,get(t,e){return ue(t).getBigUint64(e,!0)},put(t,e,n){return ue(t).setBigUint64(e,n,!0),e+8}},wh={len:8,get(t,e){return ue(t).getBigInt64(e,!0)},put(t,e,n){return ue(t).setBigInt64(e,n,!0),e+8}},Xv={len:8,get(t,e){return ue(t).getBigUint64(e)},put(t,e,n){return ue(t).setBigUint64(e,n),e+8}},CT={len:8,get(t,e){return ue(t).getBigInt64(e)},put(t,e,n){return ue(t).setBigInt64(e,n),e+8}},CO={len:2,get(t,e){return Of(t,e,!1,10,this.len)},put(t,e,n){return Mf(t,n,e,!1,10,this.len),e+this.len}},AO={len:2,get(t,e){return Of(t,e,!0,10,this.len)},put(t,e,n){return Mf(t,n,e,!0,10,this.len),e+this.len}},AT={len:4,get(t,e){return ue(t).getFloat32(e)},put(t,e,n){return ue(t).setFloat32(e,n),e+4}},RO={len:4,get(t,e){return ue(t).getFloat32(e,!0)},put(t,e,n){return ue(t).setFloat32(e,n,!0),e+4}},N0={len:8,get(t,e){return ue(t).getFloat64(e)},put(t,e,n){return ue(t).setFloat64(e,n),e+8}},PO={len:8,get(t,e){return ue(t).getFloat64(e,!0)},put(t,e,n){return ue(t).setFloat64(e,n,!0),e+8}},NO={len:10,get(t,e){return Of(t,e,!1,63,this.len)},put(t,e,n){return Mf(t,n,e,!1,63,this.len),e+this.len}},DO={len:10,get(t,e){return Of(t,e,!0,63,this.len)},put(t,e,n){return Mf(t,n,e,!0,63,this.len),e+this.len}};class jO{constructor(e){this.len=e}get(e,n){}}class cn{constructor(e){this.len=e}get(e,n){return e.subarray(n,n+this.len)}}class ne{constructor(e,n){this.len=e,this.encoding=n,this.textDecoder=new TextDecoder(n)}get(e,n){return this.textDecoder.decode(e.subarray(n,n+this.len))}}class OO{constructor(e){this.len=e,this.textDecoder=new TextDecoder("windows-1252")}get(e,n=0){return this.textDecoder.decode(e.subarray(n,n+this.len))}}const MO=Object.freeze(Object.defineProperty({__proto__:null,AnsiStringType:OO,Float16_BE:CO,Float16_LE:AO,Float32_BE:AT,Float32_LE:RO,Float64_BE:N0,Float64_LE:PO,Float80_BE:NO,Float80_LE:DO,INT16_BE:Jr,INT16_LE:TO,INT24_BE:Kv,INT24_LE:IO,INT32_BE:Pn,INT32_LE:tt,INT64_BE:CT,INT64_LE:wh,INT8:wc,IgnoreType:jO,StringType:ne,UINT16_BE:Re,UINT16_LE:ke,UINT24_BE:sn,UINT24_LE:xh,UINT32_BE:re,UINT32_LE:J,UINT64_BE:Xv,UINT64_LE:en,UINT8:he,Uint8ArrayType:cn},Symbol.toStringTag,{value:"Module"})),LO=Object.prototype.toString,FO="[object Uint8Array]",$O="[object ArrayBuffer]";function RT(t,e,n){return t?t.constructor===e?!0:LO.call(t)===n:!1}function PT(t){return RT(t,Uint8Array,FO)}function zO(t){return RT(t,ArrayBuffer,$O)}function BO(t){return PT(t)||zO(t)}function VO(t){if(!PT(t))throw new TypeError(`Expected \`Uint8Array\`, got \`${typeof t}\``)}function UO(t){if(!BO(t))throw new TypeError(`Expected \`Uint8Array\` or \`ArrayBuffer\`, got \`${typeof t}\``)}const Ku={utf8:new globalThis.TextDecoder("utf8")};function Qv(t,e="utf8"){return UO(t),Ku[e]??(Ku[e]=new globalThis.TextDecoder(e)),Ku[e].decode(t)}function NT(t){if(typeof t!="string")throw new TypeError(`Expected \`string\`, got \`${typeof t}\``)}const WO=new globalThis.TextEncoder;function HO(t){return NT(t),WO.encode(t)}const qO=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Yv(t){VO(t);let e="";for(let n=0;n<t.length;n++)e+=qO[t[n]];return e}const C_={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,a:10,b:11,c:12,d:13,e:14,f:15,A:10,B:11,C:12,D:13,E:14,F:15};function A_(t){if(NT(t),t.length%2!==0)throw new Error("Invalid Hex string length.");const e=t.length/2,n=new Uint8Array(e);for(let r=0;r<e;r++){const i=C_[t[r*2]],s=C_[t[r*2+1]];if(i===void 0||s===void 0)throw new Error(`Invalid Hex character encountered at position ${r*2}`);n[r]=i<<4|s}return n}function R_(t){const{byteLength:e}=t;if(e===6)return t.getUint16(0)*2**32+t.getUint32(2);if(e===5)return t.getUint8(0)*2**32+t.getUint32(1);if(e===4)return t.getUint32(0);if(e===3)return t.getUint8(0)*2**16+t.getUint16(1);if(e===2)return t.getUint16(0);if(e===1)return t.getUint8(0)}function DT(t,e){const n=t.length,r=e.length;if(r===0||r>n)return-1;const i=n-r;for(let s=0;s<=i;s++){let o=!0;for(let a=0;a<r;a++)if(t[s+a]!==e[a]){o=!1;break}if(o)return s}return-1}function GO(t,e){return DT(t,e)!==-1}function KO(t){return[...t].map(e=>e.charCodeAt(0))}function XO(t,e=0){const n=Number.parseInt(new ne(6).get(t,148).replace(/\0.*$/,"").trim(),8);if(Number.isNaN(n))return!1;let r=8*32;for(let i=e;i<e+148;i++)r+=t[i];for(let i=e+156;i<e+512;i++)r+=t[i];return n===r}const QO={get:(t,e)=>t[e+3]&127|t[e+2]<<7|t[e+1]<<14|t[e]<<21,len:4},YO=["jpg","png","apng","gif","webp","flif","xcf","cr2","cr3","orf","arw","dng","nef","rw2","raf","tif","bmp","icns","jxr","psd","indd","zip","tar","rar","gz","bz2","7z","dmg","mp4","mid","mkv","webm","mov","avi","mpg","mp2","mp3","m4a","oga","ogg","ogv","opus","flac","wav","spx","amr","pdf","epub","elf","macho","exe","swf","rtf","wasm","woff","woff2","eot","ttf","otf","ico","flv","ps","xz","sqlite","nes","crx","xpi","cab","deb","ar","rpm","Z","lz","cfb","mxf","mts","blend","bpg","docx","pptx","xlsx","3gp","3g2","j2c","jp2","jpm","jpx","mj2","aif","qcp","odt","ods","odp","xml","mobi","heic","cur","ktx","ape","wv","dcm","ics","glb","pcap","dsf","lnk","alias","voc","ac3","m4v","m4p","m4b","f4v","f4p","f4b","f4a","mie","asf","ogm","ogx","mpc","arrow","shp","aac","mp1","it","s3m","xm","ai","skp","avif","eps","lzh","pgp","asar","stl","chm","3mf","zst","jxl","vcf","jls","pst","dwg","parquet","class","arj","cpio","ace","avro","icc","fbx","vsdx"],JO=["image/jpeg","image/png","image/gif","image/webp","image/flif","image/x-xcf","image/x-canon-cr2","image/x-canon-cr3","image/tiff","image/bmp","image/vnd.ms-photo","image/vnd.adobe.photoshop","application/x-indesign","application/epub+zip","application/x-xpinstall","application/vnd.oasis.opendocument.text","application/vnd.oasis.opendocument.spreadsheet","application/vnd.oasis.opendocument.presentation","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/zip","application/x-tar","application/x-rar-compressed","application/gzip","application/x-bzip2","application/x-7z-compressed","application/x-apple-diskimage","application/x-apache-arrow","video/mp4","audio/midi","video/x-matroska","video/webm","video/quicktime","video/vnd.avi","audio/wav","audio/qcelp","audio/x-ms-asf","video/x-ms-asf","application/vnd.ms-asf","video/mpeg","video/3gpp","audio/mpeg","audio/mp4","audio/opus","video/ogg","audio/ogg","application/ogg","audio/x-flac","audio/ape","audio/wavpack","audio/amr","application/pdf","application/x-elf","application/x-mach-binary","application/x-msdownload","application/x-shockwave-flash","application/rtf","application/wasm","font/woff","font/woff2","application/vnd.ms-fontobject","font/ttf","font/otf","image/x-icon","video/x-flv","application/postscript","application/eps","application/x-xz","application/x-sqlite3","application/x-nintendo-nes-rom","application/x-google-chrome-extension","application/vnd.ms-cab-compressed","application/x-deb","application/x-unix-archive","application/x-rpm","application/x-compress","application/x-lzip","application/x-cfb","application/x-mie","application/mxf","video/mp2t","application/x-blender","image/bpg","image/j2c","image/jp2","image/jpx","image/jpm","image/mj2","audio/aiff","application/xml","application/x-mobipocket-ebook","image/heif","image/heif-sequence","image/heic","image/heic-sequence","image/icns","image/ktx","application/dicom","audio/x-musepack","text/calendar","text/vcard","model/gltf-binary","application/vnd.tcpdump.pcap","audio/x-dsf","application/x.ms.shortcut","application/x.apple.alias","audio/x-voc","audio/vnd.dolby.dd-raw","audio/x-m4a","image/apng","image/x-olympus-orf","image/x-sony-arw","image/x-adobe-dng","image/x-nikon-nef","image/x-panasonic-rw2","image/x-fujifilm-raf","video/x-m4v","video/3gpp2","application/x-esri-shape","audio/aac","audio/x-it","audio/x-s3m","audio/x-xm","video/MP1S","video/MP2P","application/vnd.sketchup.skp","image/avif","application/x-lzh-compressed","application/pgp-encrypted","application/x-asar","model/stl","application/vnd.ms-htmlhelp","model/3mf","image/jxl","application/zstd","image/jls","application/vnd.ms-outlook","image/vnd.dwg","application/x-parquet","application/java-vm","application/x-arj","application/x-cpio","application/x-ace-compressed","application/avro","application/vnd.iccprofile","application/x.autodesk.fbx","application/vnd.visio"],P_=4100;async function jT(t){return new ZO().fromBuffer(t)}function vr(t,e,n){n={offset:0,...n};for(const[r,i]of e.entries())if(n.mask){if(i!==(n.mask[r]&t[r+n.offset]))return!1}else if(i!==t[r+n.offset])return!1;return!0}class ZO{constructor(e){this.detectors=e==null?void 0:e.customDetectors,this.fromTokenizer=this.fromTokenizer.bind(this),this.fromBuffer=this.fromBuffer.bind(this),this.parse=this.parse.bind(this)}async fromTokenizer(e){const n=e.position;for(const r of this.detectors||[]){const i=await r(e);if(i)return i;if(n!==e.position)return}return this.parse(e)}async fromBuffer(e){if(!(e instanceof Uint8Array||e instanceof ArrayBuffer))throw new TypeError(`Expected the \`input\` argument to be of type \`Uint8Array\` or \`ArrayBuffer\`, got \`${typeof e}\``);const n=e instanceof Uint8Array?e:new Uint8Array(e);if((n==null?void 0:n.length)>1)return this.fromTokenizer(Ta(n))}async fromBlob(e){return this.fromStream(e.stream())}async fromStream(e){const n=await IT(e);try{return await this.fromTokenizer(n)}finally{await n.close()}}async toDetectionStream(e,n){const{sampleSize:r=P_}=n;let i,s;const o=e.getReader({mode:"byob"});try{const{value:c,done:d}=await o.read(new Uint8Array(r));if(s=c,!d&&c)try{i=await this.fromBuffer(c.slice(0,r))}catch(h){if(!(h instanceof it))throw h;i=void 0}s=c}finally{o.releaseLock()}const a=new TransformStream({async start(c){c.enqueue(s)},transform(c,d){d.enqueue(c)}}),l=e.pipeThrough(a);return l.fileType=i,l}check(e,n){return vr(this.buffer,e,n)}checkString(e,n){return this.check(KO(e),n)}async parse(e){if(this.buffer=new Uint8Array(P_),e.fileInfo.size===void 0&&(e.fileInfo.size=Number.MAX_SAFE_INTEGER),this.tokenizer=e,await e.peekBuffer(this.buffer,{length:12,mayBeLess:!0}),this.check([66,77]))return{ext:"bmp",mime:"image/bmp"};if(this.check([11,119]))return{ext:"ac3",mime:"audio/vnd.dolby.dd-raw"};if(this.check([120,1]))return{ext:"dmg",mime:"application/x-apple-diskimage"};if(this.check([77,90]))return{ext:"exe",mime:"application/x-msdownload"};if(this.check([37,33]))return await e.peekBuffer(this.buffer,{length:24,mayBeLess:!0}),this.checkString("PS-Adobe-",{offset:2})&&this.checkString(" EPSF-",{offset:14})?{ext:"eps",mime:"application/eps"}:{ext:"ps",mime:"application/postscript"};if(this.check([31,160])||this.check([31,157]))return{ext:"Z",mime:"application/x-compress"};if(this.check([199,113]))return{ext:"cpio",mime:"application/x-cpio"};if(this.check([96,234]))return{ext:"arj",mime:"application/x-arj"};if(this.check([239,187,191]))return this.tokenizer.ignore(3),this.parse(e);if(this.check([71,73,70]))return{ext:"gif",mime:"image/gif"};if(this.check([73,73,188]))return{ext:"jxr",mime:"image/vnd.ms-photo"};if(this.check([31,139,8]))return{ext:"gz",mime:"application/gzip"};if(this.check([66,90,104]))return{ext:"bz2",mime:"application/x-bzip2"};if(this.checkString("ID3")){await e.ignore(6);const n=await e.readToken(QO);return e.position+n>e.fileInfo.size?{ext:"mp3",mime:"audio/mpeg"}:(await e.ignore(n),this.fromTokenizer(e))}if(this.checkString("MP+"))return{ext:"mpc",mime:"audio/x-musepack"};if((this.buffer[0]===67||this.buffer[0]===70)&&this.check([87,83],{offset:1}))return{ext:"swf",mime:"application/x-shockwave-flash"};if(this.check([255,216,255]))return this.check([247],{offset:3})?{ext:"jls",mime:"image/jls"}:{ext:"jpg",mime:"image/jpeg"};if(this.check([79,98,106,1]))return{ext:"avro",mime:"application/avro"};if(this.checkString("FLIF"))return{ext:"flif",mime:"image/flif"};if(this.checkString("8BPS"))return{ext:"psd",mime:"image/vnd.adobe.photoshop"};if(this.checkString("WEBP",{offset:8}))return{ext:"webp",mime:"image/webp"};if(this.checkString("MPCK"))return{ext:"mpc",mime:"audio/x-musepack"};if(this.checkString("FORM"))return{ext:"aif",mime:"audio/aiff"};if(this.checkString("icns",{offset:0}))return{ext:"icns",mime:"image/icns"};if(this.check([80,75,3,4])){try{for(;e.position+30<e.fileInfo.size;){await e.readBuffer(this.buffer,{length:30});const n=new DataView(this.buffer.buffer),r={compressedSize:n.getUint32(18,!0),uncompressedSize:n.getUint32(22,!0),filenameLength:n.getUint16(26,!0),extraFieldLength:n.getUint16(28,!0)};if(r.filename=await e.readToken(new ne(r.filenameLength,"utf-8")),await e.ignore(r.extraFieldLength),r.filename==="META-INF/mozilla.rsa")return{ext:"xpi",mime:"application/x-xpinstall"};if(r.filename.endsWith(".rels")||r.filename.endsWith(".xml"))switch(r.filename.split("/")[0]){case"_rels":break;case"word":return{ext:"docx",mime:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"};case"ppt":return{ext:"pptx",mime:"application/vnd.openxmlformats-officedocument.presentationml.presentation"};case"xl":return{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"};case"visio":return{ext:"vsdx",mime:"application/vnd.visio"};default:break}if(r.filename.startsWith("xl/"))return{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"};if(r.filename.startsWith("3D/")&&r.filename.endsWith(".model"))return{ext:"3mf",mime:"model/3mf"};if(r.filename==="mimetype"&&r.compressedSize===r.uncompressedSize){let i=await e.readToken(new ne(r.compressedSize,"utf-8"));switch(i=i.trim(),i){case"application/epub+zip":return{ext:"epub",mime:"application/epub+zip"};case"application/vnd.oasis.opendocument.text":return{ext:"odt",mime:"application/vnd.oasis.opendocument.text"};case"application/vnd.oasis.opendocument.spreadsheet":return{ext:"ods",mime:"application/vnd.oasis.opendocument.spreadsheet"};case"application/vnd.oasis.opendocument.presentation":return{ext:"odp",mime:"application/vnd.oasis.opendocument.presentation"};default:}}if(r.compressedSize===0){let i=-1;for(;i<0&&e.position<e.fileInfo.size;)await e.peekBuffer(this.buffer,{mayBeLess:!0}),i=DT(this.buffer,new Uint8Array([80,75,3,4])),await e.ignore(i>=0?i:this.buffer.length)}else await e.ignore(r.compressedSize)}}catch(n){if(!(n instanceof it))throw n}return{ext:"zip",mime:"application/zip"}}if(this.checkString("OggS")){await e.ignore(28);const n=new Uint8Array(8);return await e.readBuffer(n),vr(n,[79,112,117,115,72,101,97,100])?{ext:"opus",mime:"audio/opus"}:vr(n,[128,116,104,101,111,114,97])?{ext:"ogv",mime:"video/ogg"}:vr(n,[1,118,105,100,101,111,0])?{ext:"ogm",mime:"video/ogg"}:vr(n,[127,70,76,65,67])?{ext:"oga",mime:"audio/ogg"}:vr(n,[83,112,101,101,120,32,32])?{ext:"spx",mime:"audio/ogg"}:vr(n,[1,118,111,114,98,105,115])?{ext:"ogg",mime:"audio/ogg"}:{ext:"ogx",mime:"application/ogg"}}if(this.check([80,75])&&(this.buffer[2]===3||this.buffer[2]===5||this.buffer[2]===7)&&(this.buffer[3]===4||this.buffer[3]===6||this.buffer[3]===8))return{ext:"zip",mime:"application/zip"};if(this.checkString("ftyp",{offset:4})&&this.buffer[8]&96){const n=new ne(4,"latin1").get(this.buffer,8).replace("\0"," ").trim();switch(n){case"avif":case"avis":return{ext:"avif",mime:"image/avif"};case"mif1":return{ext:"heic",mime:"image/heif"};case"msf1":return{ext:"heic",mime:"image/heif-sequence"};case"heic":case"heix":return{ext:"heic",mime:"image/heic"};case"hevc":case"hevx":return{ext:"heic",mime:"image/heic-sequence"};case"qt":return{ext:"mov",mime:"video/quicktime"};case"M4V":case"M4VH":case"M4VP":return{ext:"m4v",mime:"video/x-m4v"};case"M4P":return{ext:"m4p",mime:"video/mp4"};case"M4B":return{ext:"m4b",mime:"audio/mp4"};case"M4A":return{ext:"m4a",mime:"audio/x-m4a"};case"F4V":return{ext:"f4v",mime:"video/mp4"};case"F4P":return{ext:"f4p",mime:"video/mp4"};case"F4A":return{ext:"f4a",mime:"audio/mp4"};case"F4B":return{ext:"f4b",mime:"audio/mp4"};case"crx":return{ext:"cr3",mime:"image/x-canon-cr3"};default:return n.startsWith("3g")?n.startsWith("3g2")?{ext:"3g2",mime:"video/3gpp2"}:{ext:"3gp",mime:"video/3gpp"}:{ext:"mp4",mime:"video/mp4"}}}if(this.checkString("MThd"))return{ext:"mid",mime:"audio/midi"};if(this.checkString("wOFF")&&(this.check([0,1,0,0],{offset:4})||this.checkString("OTTO",{offset:4})))return{ext:"woff",mime:"font/woff"};if(this.checkString("wOF2")&&(this.check([0,1,0,0],{offset:4})||this.checkString("OTTO",{offset:4})))return{ext:"woff2",mime:"font/woff2"};if(this.check([212,195,178,161])||this.check([161,178,195,212]))return{ext:"pcap",mime:"application/vnd.tcpdump.pcap"};if(this.checkString("DSD "))return{ext:"dsf",mime:"audio/x-dsf"};if(this.checkString("LZIP"))return{ext:"lz",mime:"application/x-lzip"};if(this.checkString("fLaC"))return{ext:"flac",mime:"audio/x-flac"};if(this.check([66,80,71,251]))return{ext:"bpg",mime:"image/bpg"};if(this.checkString("wvpk"))return{ext:"wv",mime:"audio/wavpack"};if(this.checkString("%PDF")){try{await e.ignore(1350);const n=10*1024*1024,r=new Uint8Array(Math.min(n,e.fileInfo.size));if(await e.readBuffer(r,{mayBeLess:!0}),GO(r,new TextEncoder().encode("AIPrivateData")))return{ext:"ai",mime:"application/postscript"}}catch(n){if(!(n instanceof it))throw n}return{ext:"pdf",mime:"application/pdf"}}if(this.check([0,97,115,109]))return{ext:"wasm",mime:"application/wasm"};if(this.check([73,73])){const n=await this.readTiffHeader(!1);if(n)return n}if(this.check([77,77])){const n=await this.readTiffHeader(!0);if(n)return n}if(this.checkString("MAC "))return{ext:"ape",mime:"audio/ape"};if(this.check([26,69,223,163])){async function n(){const a=await e.peekNumber(he);let l=128,c=0;for(;!(a&l)&&l!==0;)++c,l>>=1;const d=new Uint8Array(c+1);return await e.readBuffer(d),d}async function r(){const a=await n(),l=await n();l[0]^=128>>l.length-1;const c=Math.min(6,l.length),d=new DataView(a.buffer),h=new DataView(l.buffer,l.length-c,c);return{id:R_(d),len:R_(h)}}async function i(a){for(;a>0;){const l=await r();if(l.id===17026)return(await e.readToken(new ne(l.len))).replaceAll(/\00.*$/g,"");await e.ignore(l.len),--a}}const s=await r();switch(await i(s.len)){case"webm":return{ext:"webm",mime:"video/webm"};case"matroska":return{ext:"mkv",mime:"video/x-matroska"};default:return}}if(this.check([82,73,70,70])){if(this.check([65,86,73],{offset:8}))return{ext:"avi",mime:"video/vnd.avi"};if(this.check([87,65,86,69],{offset:8}))return{ext:"wav",mime:"audio/wav"};if(this.check([81,76,67,77],{offset:8}))return{ext:"qcp",mime:"audio/qcelp"}}if(this.checkString("SQLi"))return{ext:"sqlite",mime:"application/x-sqlite3"};if(this.check([78,69,83,26]))return{ext:"nes",mime:"application/x-nintendo-nes-rom"};if(this.checkString("Cr24"))return{ext:"crx",mime:"application/x-google-chrome-extension"};if(this.checkString("MSCF")||this.checkString("ISc("))return{ext:"cab",mime:"application/vnd.ms-cab-compressed"};if(this.check([237,171,238,219]))return{ext:"rpm",mime:"application/x-rpm"};if(this.check([197,208,211,198]))return{ext:"eps",mime:"application/eps"};if(this.check([40,181,47,253]))return{ext:"zst",mime:"application/zstd"};if(this.check([127,69,76,70]))return{ext:"elf",mime:"application/x-elf"};if(this.check([33,66,68,78]))return{ext:"pst",mime:"application/vnd.ms-outlook"};if(this.checkString("PAR1"))return{ext:"parquet",mime:"application/x-parquet"};if(this.check([207,250,237,254]))return{ext:"macho",mime:"application/x-mach-binary"};if(this.check([79,84,84,79,0]))return{ext:"otf",mime:"font/otf"};if(this.checkString("#!AMR"))return{ext:"amr",mime:"audio/amr"};if(this.checkString("{\\rtf"))return{ext:"rtf",mime:"application/rtf"};if(this.check([70,76,86,1]))return{ext:"flv",mime:"video/x-flv"};if(this.checkString("IMPM"))return{ext:"it",mime:"audio/x-it"};if(this.checkString("-lh0-",{offset:2})||this.checkString("-lh1-",{offset:2})||this.checkString("-lh2-",{offset:2})||this.checkString("-lh3-",{offset:2})||this.checkString("-lh4-",{offset:2})||this.checkString("-lh5-",{offset:2})||this.checkString("-lh6-",{offset:2})||this.checkString("-lh7-",{offset:2})||this.checkString("-lzs-",{offset:2})||this.checkString("-lz4-",{offset:2})||this.checkString("-lz5-",{offset:2})||this.checkString("-lhd-",{offset:2}))return{ext:"lzh",mime:"application/x-lzh-compressed"};if(this.check([0,0,1,186])){if(this.check([33],{offset:4,mask:[241]}))return{ext:"mpg",mime:"video/MP1S"};if(this.check([68],{offset:4,mask:[196]}))return{ext:"mpg",mime:"video/MP2P"}}if(this.checkString("ITSF"))return{ext:"chm",mime:"application/vnd.ms-htmlhelp"};if(this.check([202,254,186,190]))return{ext:"class",mime:"application/java-vm"};if(this.check([253,55,122,88,90,0]))return{ext:"xz",mime:"application/x-xz"};if(this.checkString("<?xml "))return{ext:"xml",mime:"application/xml"};if(this.check([55,122,188,175,39,28]))return{ext:"7z",mime:"application/x-7z-compressed"};if(this.check([82,97,114,33,26,7])&&(this.buffer[6]===0||this.buffer[6]===1))return{ext:"rar",mime:"application/x-rar-compressed"};if(this.checkString("solid "))return{ext:"stl",mime:"model/stl"};if(this.checkString("AC")){const n=new ne(4,"latin1").get(this.buffer,2);if(n.match("^d*")&&n>=1e3&&n<=1050)return{ext:"dwg",mime:"image/vnd.dwg"}}if(this.checkString("070707"))return{ext:"cpio",mime:"application/x-cpio"};if(this.checkString("BLENDER"))return{ext:"blend",mime:"application/x-blender"};if(this.checkString("!<arch>"))return await e.ignore(8),await e.readToken(new ne(13,"ascii"))==="debian-binary"?{ext:"deb",mime:"application/x-deb"}:{ext:"ar",mime:"application/x-unix-archive"};if(this.checkString("**ACE",{offset:7})&&(await e.peekBuffer(this.buffer,{length:14,mayBeLess:!0}),this.checkString("**",{offset:12})))return{ext:"ace",mime:"application/x-ace-compressed"};if(this.check([137,80,78,71,13,10,26,10])){await e.ignore(8);async function n(){return{length:await e.readToken(Pn),type:await e.readToken(new ne(4,"latin1"))}}do{const r=await n();if(r.length<0)return;switch(r.type){case"IDAT":return{ext:"png",mime:"image/png"};case"acTL":return{ext:"apng",mime:"image/apng"};default:await e.ignore(r.length+4)}}while(e.position+8<e.fileInfo.size);return{ext:"png",mime:"image/png"}}if(this.check([65,82,82,79,87,49,0,0]))return{ext:"arrow",mime:"application/x-apache-arrow"};if(this.check([103,108,84,70,2,0,0,0]))return{ext:"glb",mime:"model/gltf-binary"};if(this.check([102,114,101,101],{offset:4})||this.check([109,100,97,116],{offset:4})||this.check([109,111,111,118],{offset:4})||this.check([119,105,100,101],{offset:4}))return{ext:"mov",mime:"video/quicktime"};if(this.check([73,73,82,79,8,0,0,0,24]))return{ext:"orf",mime:"image/x-olympus-orf"};if(this.checkString("gimp xcf "))return{ext:"xcf",mime:"image/x-xcf"};if(this.check([73,73,85,0,24,0,0,0,136,231,116,216]))return{ext:"rw2",mime:"image/x-panasonic-rw2"};if(this.check([48,38,178,117,142,102,207,17,166,217])){async function n(){const r=new Uint8Array(16);return await e.readBuffer(r),{id:r,size:Number(await e.readToken(en))}}for(await e.ignore(30);e.position+24<e.fileInfo.size;){const r=await n();let i=r.size-24;if(vr(r.id,[145,7,220,183,183,169,207,17,142,230,0,192,12,32,83,101])){const s=new Uint8Array(16);if(i-=await e.readBuffer(s),vr(s,[64,158,105,248,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"audio/x-ms-asf"};if(vr(s,[192,239,25,188,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"video/x-ms-asf"};break}await e.ignore(i)}return{ext:"asf",mime:"application/vnd.ms-asf"}}if(this.check([171,75,84,88,32,49,49,187,13,10,26,10]))return{ext:"ktx",mime:"image/ktx"};if((this.check([126,16,4])||this.check([126,24,4]))&&this.check([48,77,73,69],{offset:4}))return{ext:"mie",mime:"application/x-mie"};if(this.check([39,10,0,0,0,0,0,0,0,0,0,0],{offset:2}))return{ext:"shp",mime:"application/x-esri-shape"};if(this.check([255,79,255,81]))return{ext:"j2c",mime:"image/j2c"};if(this.check([0,0,0,12,106,80,32,32,13,10,135,10]))switch(await e.ignore(20),await e.readToken(new ne(4,"ascii"))){case"jp2 ":return{ext:"jp2",mime:"image/jp2"};case"jpx ":return{ext:"jpx",mime:"image/jpx"};case"jpm ":return{ext:"jpm",mime:"image/jpm"};case"mjp2":return{ext:"mj2",mime:"image/mj2"};default:return}if(this.check([255,10])||this.check([0,0,0,12,74,88,76,32,13,10,135,10]))return{ext:"jxl",mime:"image/jxl"};if(this.check([254,255]))return this.check([0,60,0,63,0,120,0,109,0,108],{offset:2})?{ext:"xml",mime:"application/xml"}:void 0;if(this.check([0,0,1,186])||this.check([0,0,1,179]))return{ext:"mpg",mime:"video/mpeg"};if(this.check([0,1,0,0,0]))return{ext:"ttf",mime:"font/ttf"};if(this.check([0,0,1,0]))return{ext:"ico",mime:"image/x-icon"};if(this.check([0,0,2,0]))return{ext:"cur",mime:"image/x-icon"};if(this.check([208,207,17,224,161,177,26,225]))return{ext:"cfb",mime:"application/x-cfb"};if(await e.peekBuffer(this.buffer,{length:Math.min(256,e.fileInfo.size),mayBeLess:!0}),this.check([97,99,115,112],{offset:36}))return{ext:"icc",mime:"application/vnd.iccprofile"};if(this.checkString("BEGIN:")){if(this.checkString("VCARD",{offset:6}))return{ext:"vcf",mime:"text/vcard"};if(this.checkString("VCALENDAR",{offset:6}))return{ext:"ics",mime:"text/calendar"}}if(this.checkString("FUJIFILMCCD-RAW"))return{ext:"raf",mime:"image/x-fujifilm-raf"};if(this.checkString("Extended Module:"))return{ext:"xm",mime:"audio/x-xm"};if(this.checkString("Creative Voice File"))return{ext:"voc",mime:"audio/x-voc"};if(this.check([4,0,0,0])&&this.buffer.length>=16){const n=new DataView(this.buffer.buffer).getUint32(12,!0);if(n>12&&this.buffer.length>=n+16)try{const r=new TextDecoder().decode(this.buffer.slice(16,n+16));if(JSON.parse(r).files)return{ext:"asar",mime:"application/x-asar"}}catch{}}if(this.check([6,14,43,52,2,5,1,1,13,1,2,1,1,2]))return{ext:"mxf",mime:"application/mxf"};if(this.checkString("SCRM",{offset:44}))return{ext:"s3m",mime:"audio/x-s3m"};if(this.check([71])&&this.check([71],{offset:188}))return{ext:"mts",mime:"video/mp2t"};if(this.check([71],{offset:4})&&this.check([71],{offset:196}))return{ext:"mts",mime:"video/mp2t"};if(this.check([66,79,79,75,77,79,66,73],{offset:60}))return{ext:"mobi",mime:"application/x-mobipocket-ebook"};if(this.check([68,73,67,77],{offset:128}))return{ext:"dcm",mime:"application/dicom"};if(this.check([76,0,0,0,1,20,2,0,0,0,0,0,192,0,0,0,0,0,0,70]))return{ext:"lnk",mime:"application/x.ms.shortcut"};if(this.check([98,111,111,107,0,0,0,0,109,97,114,107,0,0,0,0]))return{ext:"alias",mime:"application/x.apple.alias"};if(this.checkString("Kaydara FBX Binary  \0"))return{ext:"fbx",mime:"application/x.autodesk.fbx"};if(this.check([76,80],{offset:34})&&(this.check([0,0,1],{offset:8})||this.check([1,0,2],{offset:8})||this.check([2,0,2],{offset:8})))return{ext:"eot",mime:"application/vnd.ms-fontobject"};if(this.check([6,6,237,245,216,29,70,229,189,49,239,231,254,116,183,29]))return{ext:"indd",mime:"application/x-indesign"};if(await e.peekBuffer(this.buffer,{length:Math.min(512,e.fileInfo.size),mayBeLess:!0}),XO(this.buffer))return{ext:"tar",mime:"application/x-tar"};if(this.check([255,254]))return this.check([60,0,63,0,120,0,109,0,108,0],{offset:2})?{ext:"xml",mime:"application/xml"}:this.check([255,14,83,0,107,0,101,0,116,0,99,0,104,0,85,0,112,0,32,0,77,0,111,0,100,0,101,0,108,0],{offset:2})?{ext:"skp",mime:"application/vnd.sketchup.skp"}:void 0;if(this.checkString("-----BEGIN PGP MESSAGE-----"))return{ext:"pgp",mime:"application/pgp-encrypted"};if(this.buffer.length>=2&&this.check([255,224],{offset:0,mask:[255,224]})){if(this.check([16],{offset:1,mask:[22]}))return this.check([8],{offset:1,mask:[8]})?{ext:"aac",mime:"audio/aac"}:{ext:"aac",mime:"audio/aac"};if(this.check([2],{offset:1,mask:[6]}))return{ext:"mp3",mime:"audio/mpeg"};if(this.check([4],{offset:1,mask:[6]}))return{ext:"mp2",mime:"audio/mpeg"};if(this.check([6],{offset:1,mask:[6]}))return{ext:"mp1",mime:"audio/mpeg"}}}async readTiffTag(e){const n=await this.tokenizer.readToken(e?Re:ke);switch(this.tokenizer.ignore(10),n){case 50341:return{ext:"arw",mime:"image/x-sony-arw"};case 50706:return{ext:"dng",mime:"image/x-adobe-dng"}}}async readTiffIFD(e){const n=await this.tokenizer.readToken(e?Re:ke);for(let r=0;r<n;++r){const i=await this.readTiffTag(e);if(i)return i}}async readTiffHeader(e){const n=(e?Re:ke).get(this.buffer,2),r=(e?re:J).get(this.buffer,4);if(n===42){if(r>=6){if(this.checkString("CR",{offset:8}))return{ext:"cr2",mime:"image/x-canon-cr2"};if(r>=8&&(this.check([28,0,254,0],{offset:8})||this.check([31,0,11,0],{offset:8})))return{ext:"nef",mime:"image/x-nikon-nef"}}return await this.tokenizer.ignore(r),await this.readTiffIFD(e)??{ext:"tif",mime:"image/tiff"}}if(n===43)return{ext:"tif",mime:"image/tiff"}}}new Set(YO);new Set(JO);var Jv={};/*!
 * content-type
 * Copyright(c) 2015 Douglas Christopher Wilson
 * MIT Licensed
 */var N_=/; *([!#$%&'*+.^_`|~0-9A-Za-z-]+) *= *("(?:[\u000b\u0020\u0021\u0023-\u005b\u005d-\u007e\u0080-\u00ff]|\\[\u000b\u0020-\u00ff])*"|[!#$%&'*+.^_`|~0-9A-Za-z-]+) */g,eM=/^[\u000b\u0020-\u007e\u0080-\u00ff]+$/,OT=/^[!#$%&'*+.^_`|~0-9A-Za-z-]+$/,tM=/\\([\u000b\u0020-\u00ff])/g,nM=/([\\"])/g,MT=/^[!#$%&'*+.^_`|~0-9A-Za-z-]+\/[!#$%&'*+.^_`|~0-9A-Za-z-]+$/;Jv.format=rM;Jv.parse=iM;function rM(t){if(!t||typeof t!="object")throw new TypeError("argument obj is required");var e=t.parameters,n=t.type;if(!n||!MT.test(n))throw new TypeError("invalid type");var r=n;if(e&&typeof e=="object")for(var i,s=Object.keys(e).sort(),o=0;o<s.length;o++){if(i=s[o],!OT.test(i))throw new TypeError("invalid parameter name");r+="; "+i+"="+oM(e[i])}return r}function iM(t){if(!t)throw new TypeError("argument string is required");var e=typeof t=="object"?sM(t):t;if(typeof e!="string")throw new TypeError("argument string is required to be a string");var n=e.indexOf(";"),r=n!==-1?e.slice(0,n).trim():e.trim();if(!MT.test(r))throw new TypeError("invalid media type");var i=new aM(r.toLowerCase());if(n!==-1){var s,o,a;for(N_.lastIndex=n;o=N_.exec(e);){if(o.index!==n)throw new TypeError("invalid parameter format");n+=o[0].length,s=o[1].toLowerCase(),a=o[2],a.charCodeAt(0)===34&&(a=a.slice(1,-1),a.indexOf("\\")!==-1&&(a=a.replace(tM,"$1"))),i.parameters[s]=a}if(n!==e.length)throw new TypeError("invalid parameter format")}return i}function sM(t){var e;if(typeof t.getHeader=="function"?e=t.getHeader("content-type"):typeof t.headers=="object"&&(e=t.headers&&t.headers["content-type"]),typeof e!="string")throw new TypeError("content-type header is missing from object");return e}function oM(t){var e=String(t);if(OT.test(e))return e;if(e.length>0&&!eM.test(e))throw new TypeError("invalid parameter value");return'"'+e.replace(nM,"\\$1")+'"'}function aM(t){this.parameters=Object.create(null),this.type=t}/*!
 * media-typer
 * Copyright(c) 2014-2017 Douglas Christopher Wilson
 * MIT Licensed
 */var lM=/^ *([A-Za-z0-9][A-Za-z0-9!#$&^_-]{0,126})\/([A-Za-z0-9][A-Za-z0-9!#$&^_.+-]{0,126}) *$/,cM=uM;function uM(t){if(!t)throw new TypeError("argument string is required");if(typeof t!="string")throw new TypeError("argument string is required to be a string");var e=lM.exec(t.toLowerCase());if(!e)throw new TypeError("invalid media type");var n=e[1],r=e[2],i,s=r.lastIndexOf("+");return s!==-1&&(i=r.substr(s+1),r=r.substr(0,s)),new dM(n,r,i)}function dM(t,e,n){this.type=t,this.subtype=e,this.suffix=n}var D0={exports:{}},Pp,D_;function hM(){if(D_)return Pp;D_=1;var t=1e3,e=t*60,n=e*60,r=n*24,i=r*7,s=r*365.25;Pp=function(d,h){h=h||{};var m=typeof d;if(m==="string"&&d.length>0)return o(d);if(m==="number"&&isFinite(d))return h.long?l(d):a(d);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(d))};function o(d){if(d=String(d),!(d.length>100)){var h=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(d);if(h){var m=parseFloat(h[1]),p=(h[2]||"ms").toLowerCase();switch(p){case"years":case"year":case"yrs":case"yr":case"y":return m*s;case"weeks":case"week":case"w":return m*i;case"days":case"day":case"d":return m*r;case"hours":case"hour":case"hrs":case"hr":case"h":return m*n;case"minutes":case"minute":case"mins":case"min":case"m":return m*e;case"seconds":case"second":case"secs":case"sec":case"s":return m*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return m;default:return}}}}function a(d){var h=Math.abs(d);return h>=r?Math.round(d/r)+"d":h>=n?Math.round(d/n)+"h":h>=e?Math.round(d/e)+"m":h>=t?Math.round(d/t)+"s":d+"ms"}function l(d){var h=Math.abs(d);return h>=r?c(d,h,r,"day"):h>=n?c(d,h,n,"hour"):h>=e?c(d,h,e,"minute"):h>=t?c(d,h,t,"second"):d+" ms"}function c(d,h,m,p){var y=h>=m*1.5;return Math.round(d/m)+" "+p+(y?"s":"")}return Pp}function fM(t){n.debug=n,n.default=n,n.coerce=l,n.disable=s,n.enable=i,n.enabled=o,n.humanize=hM(),n.destroy=c,Object.keys(t).forEach(d=>{n[d]=t[d]}),n.names=[],n.skips=[],n.formatters={};function e(d){let h=0;for(let m=0;m<d.length;m++)h=(h<<5)-h+d.charCodeAt(m),h|=0;return n.colors[Math.abs(h)%n.colors.length]}n.selectColor=e;function n(d){let h,m=null,p,y;function x(...E){if(!x.enabled)return;const v=x,g=Number(new Date),w=g-(h||g);v.diff=w,v.prev=h,v.curr=g,h=g,E[0]=n.coerce(E[0]),typeof E[0]!="string"&&E.unshift("%O");let _=0;E[0]=E[0].replace(/%([a-zA-Z%])/g,(T,b)=>{if(T==="%%")return"%";_++;const k=n.formatters[b];if(typeof k=="function"){const R=E[_];T=k.call(v,R),E.splice(_,1),_--}return T}),n.formatArgs.call(v,E),(v.log||n.log).apply(v,E)}return x.namespace=d,x.useColors=n.useColors(),x.color=n.selectColor(d),x.extend=r,x.destroy=n.destroy,Object.defineProperty(x,"enabled",{enumerable:!0,configurable:!1,get:()=>m!==null?m:(p!==n.namespaces&&(p=n.namespaces,y=n.enabled(d)),y),set:E=>{m=E}}),typeof n.init=="function"&&n.init(x),x}function r(d,h){const m=n(this.namespace+(typeof h>"u"?":":h)+d);return m.log=this.log,m}function i(d){n.save(d),n.namespaces=d,n.names=[],n.skips=[];let h;const m=(typeof d=="string"?d:"").split(/[\s,]+/),p=m.length;for(h=0;h<p;h++)m[h]&&(d=m[h].replace(/\*/g,".*?"),d[0]==="-"?n.skips.push(new RegExp("^"+d.slice(1)+"$")):n.names.push(new RegExp("^"+d+"$")))}function s(){const d=[...n.names.map(a),...n.skips.map(a).map(h=>"-"+h)].join(",");return n.enable(""),d}function o(d){if(d[d.length-1]==="*")return!0;let h,m;for(h=0,m=n.skips.length;h<m;h++)if(n.skips[h].test(d))return!1;for(h=0,m=n.names.length;h<m;h++)if(n.names[h].test(d))return!0;return!1}function a(d){return d.toString().substring(2,d.toString().length-2).replace(/\.\*\?$/,"*")}function l(d){return d instanceof Error?d.stack||d.message:d}function c(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return n.enable(n.load()),n}var mM=fM;(function(t,e){e.formatArgs=r,e.save=i,e.load=s,e.useColors=n,e.storage=o(),e.destroy=(()=>{let l=!1;return()=>{l||(l=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function n(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function r(l){if(l[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+l[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;const c="color: "+this.color;l.splice(1,0,c,"color: inherit");let d=0,h=0;l[0].replace(/%[a-zA-Z%]/g,m=>{m!=="%%"&&(d++,m==="%c"&&(h=d))}),l.splice(h,0,c)}e.log=console.debug||console.log||(()=>{});function i(l){try{l?e.storage.setItem("debug",l):e.storage.removeItem("debug")}catch{}}function s(){let l;try{l=e.storage.getItem("debug")}catch{}return!l&&typeof process<"u"&&"env"in process&&(l={}.DEBUG),l}function o(){try{return localStorage}catch{}}t.exports=mM(e);const{formatters:a}=t.exports;a.j=function(l){try{return JSON.stringify(l)}catch(c){return"[UnexpectedJSONParseError]: "+c.message}}})(D0,D0.exports);var pM=D0.exports;const Ne=Hb(pM);var j0;(function(t){t[t.shot=10]="shot",t[t.scene=20]="scene",t[t.track=30]="track",t[t.part=40]="part",t[t.album=50]="album",t[t.edition=60]="edition",t[t.collection=70]="collection"})(j0||(j0={}));var Zs;(function(t){t[t.video=1]="video",t[t.audio=2]="audio",t[t.complex=3]="complex",t[t.logo=4]="logo",t[t.subtitle=17]="subtitle",t[t.button=18]="button",t[t.control=32]="control"})(Zs||(Zs={}));function Qe(t,e,n){return(t[e]&1<<n)!==0}function _n(t,e,n,r){let i=e;if(r==="utf-16le"){for(;t[i]!==0||t[i+1]!==0;){if(i>=n)return n;i+=2}return i}for(;t[i]!==0;){if(i>=n)return n;i++}return i}function LT(t){const e=t.indexOf("\0");return e===-1?t:t.substr(0,e)}function gM(t){const e=t.length;if(e&1)throw new Error("Buffer length must be even");for(let n=0;n<e;n+=2){const r=t[n];t[n]=t[n+1],t[n+1]=r}return t}function pt(t,e){if(t[0]===255&&t[1]===254)return pt(t.subarray(2),e);if(e==="utf-16le"&&t[0]===254&&t[1]===255){if(t.length&1)throw new Error("Expected even number of octets for 16-bit unicode string");return pt(gM(t),e)}return new ne(t.length,e).get(t,0)}function Pi(t){return t=t.replace(/^\x00+/g,""),t=t.replace(/\x00+$/g,""),t}function ye(t,e,n,r){const i=e+~~(n/8),s=n%8;let o=t[i];o&=255>>s;const a=8-s,l=r-a;return l<0?o>>=8-s-r:l>0&&(o<<=l,o|=ye(t,e,n+a,l)),o}function kn(t,e,n){return ye(t,e,n,1)===1}function yM(t){const e=[];for(let n=0,r=t.length;n<r;n++){const i=Number(t.charCodeAt(n)).toString(16);e.push(i.length===1?`0${i}`:i)}return e.join(" ")}function vM(t){return 10*Math.log10(t)}function xM(t){return 10**(t/10)}function wM(t){const e=t.split(" ").map(n=>n.trim().toLowerCase());if(e.length>=1){const n=Number.parseFloat(e[0]);return e.length===2&&e[1]==="db"?{dB:n,ratio:xM(n)}:{dB:vM(n),ratio:n}}}var _c;(function(t){t[t.Other=0]="Other",t[t["32x32 pixels 'file icon' (PNG only)"]=1]="32x32 pixels 'file icon' (PNG only)",t[t["Other file icon"]=2]="Other file icon",t[t["Cover (front)"]=3]="Cover (front)",t[t["Cover (back)"]=4]="Cover (back)",t[t["Leaflet page"]=5]="Leaflet page",t[t["Media (e.g. label side of CD)"]=6]="Media (e.g. label side of CD)",t[t["Lead artist/lead performer/soloist"]=7]="Lead artist/lead performer/soloist",t[t["Artist/performer"]=8]="Artist/performer",t[t.Conductor=9]="Conductor",t[t["Band/Orchestra"]=10]="Band/Orchestra",t[t.Composer=11]="Composer",t[t["Lyricist/text writer"]=12]="Lyricist/text writer",t[t["Recording Location"]=13]="Recording Location",t[t["During recording"]=14]="During recording",t[t["During performance"]=15]="During performance",t[t["Movie/video screen capture"]=16]="Movie/video screen capture",t[t["A bright coloured fish"]=17]="A bright coloured fish",t[t.Illustration=18]="Illustration",t[t["Band/artist logotype"]=19]="Band/artist logotype",t[t["Publisher/Studio logotype"]=20]="Publisher/Studio logotype"})(_c||(_c={}));var j_;(function(t){t[t.other=0]="other",t[t.lyrics=1]="lyrics",t[t.text=2]="text",t[t.movement_part=3]="movement_part",t[t.events=4]="events",t[t.chord=5]="chord",t[t.trivia_pop=6]="trivia_pop"})(j_||(j_={}));var O_;(function(t){t[t.notSynchronized0=0]="notSynchronized0",t[t.mpegFrameNumber=1]="mpegFrameNumber",t[t.milliseconds=2]="milliseconds"})(O_||(O_={}));const FT={get:(t,e)=>t[e+3]&127|t[e+2]<<7|t[e+1]<<14|t[e]<<21,len:4},O0={len:10,get:(t,e)=>({fileIdentifier:new ne(3,"ascii").get(t,e),version:{major:wc.get(t,e+3),revision:wc.get(t,e+4)},flags:{unsynchronisation:Qe(t,e+5,7),isExtendedHeader:Qe(t,e+5,6),expIndicator:Qe(t,e+5,5),footer:Qe(t,e+5,4)},size:FT.get(t,e+6)})},M_={len:10,get:(t,e)=>({size:re.get(t,e),extendedFlags:Re.get(t,e+4),sizeOfPadding:re.get(t,e+6),crcDataPresent:Qe(t,e+4,31)})},$T={len:1,get:(t,e)=>{switch(t[e]){case 0:return{encoding:"latin1"};case 1:return{encoding:"utf-16le",bom:!0};case 2:return{encoding:"utf-16le",bom:!1};case 3:return{encoding:"utf8",bom:!1};default:return{encoding:"utf8",bom:!1}}}},M0={len:4,get:(t,e)=>({encoding:$T.get(t,e),language:new ne(3,"latin1").get(t,e+1)})},L_={len:6,get:(t,e)=>{const n=M0.get(t,e);return{encoding:n.encoding,language:n.language,timeStampFormat:he.get(t,e+4),contentType:he.get(t,e+5)}}},_h={year:{multiple:!1},track:{multiple:!1},disk:{multiple:!1},title:{multiple:!1},artist:{multiple:!1},artists:{multiple:!0,unique:!0},albumartist:{multiple:!1},album:{multiple:!1},date:{multiple:!1},originaldate:{multiple:!1},originalyear:{multiple:!1},releasedate:{multiple:!1},comment:{multiple:!0,unique:!1},genre:{multiple:!0,unique:!0},picture:{multiple:!0,unique:!0},composer:{multiple:!0,unique:!0},lyrics:{multiple:!0,unique:!1},albumsort:{multiple:!1,unique:!0},titlesort:{multiple:!1,unique:!0},work:{multiple:!1,unique:!0},artistsort:{multiple:!1,unique:!0},albumartistsort:{multiple:!1,unique:!0},composersort:{multiple:!1,unique:!0},lyricist:{multiple:!0,unique:!0},writer:{multiple:!0,unique:!0},conductor:{multiple:!0,unique:!0},remixer:{multiple:!0,unique:!0},arranger:{multiple:!0,unique:!0},engineer:{multiple:!0,unique:!0},producer:{multiple:!0,unique:!0},technician:{multiple:!0,unique:!0},djmixer:{multiple:!0,unique:!0},mixer:{multiple:!0,unique:!0},label:{multiple:!0,unique:!0},grouping:{multiple:!1},subtitle:{multiple:!0},discsubtitle:{multiple:!1},totaltracks:{multiple:!1},totaldiscs:{multiple:!1},compilation:{multiple:!1},rating:{multiple:!0},bpm:{multiple:!1},mood:{multiple:!1},media:{multiple:!1},catalognumber:{multiple:!0,unique:!0},tvShow:{multiple:!1},tvShowSort:{multiple:!1},tvSeason:{multiple:!1},tvEpisode:{multiple:!1},tvEpisodeId:{multiple:!1},tvNetwork:{multiple:!1},podcast:{multiple:!1},podcasturl:{multiple:!1},releasestatus:{multiple:!1},releasetype:{multiple:!0},releasecountry:{multiple:!1},script:{multiple:!1},language:{multiple:!1},copyright:{multiple:!1},license:{multiple:!1},encodedby:{multiple:!1},encodersettings:{multiple:!1},gapless:{multiple:!1},barcode:{multiple:!1},isrc:{multiple:!0},asin:{multiple:!1},musicbrainz_recordingid:{multiple:!1},musicbrainz_trackid:{multiple:!1},musicbrainz_albumid:{multiple:!1},musicbrainz_artistid:{multiple:!0},musicbrainz_albumartistid:{multiple:!0},musicbrainz_releasegroupid:{multiple:!1},musicbrainz_workid:{multiple:!1},musicbrainz_trmid:{multiple:!1},musicbrainz_discid:{multiple:!1},acoustid_id:{multiple:!1},acoustid_fingerprint:{multiple:!1},musicip_puid:{multiple:!1},musicip_fingerprint:{multiple:!1},website:{multiple:!1},"performer:instrument":{multiple:!0,unique:!0},averageLevel:{multiple:!1},peakLevel:{multiple:!1},notes:{multiple:!0,unique:!1},key:{multiple:!1},originalalbum:{multiple:!1},originalartist:{multiple:!1},discogs_artist_id:{multiple:!0,unique:!0},discogs_release_id:{multiple:!1},discogs_label_id:{multiple:!1},discogs_master_release_id:{multiple:!1},discogs_votes:{multiple:!1},discogs_rating:{multiple:!1},replaygain_track_peak:{multiple:!1},replaygain_track_gain:{multiple:!1},replaygain_album_peak:{multiple:!1},replaygain_album_gain:{multiple:!1},replaygain_track_minmax:{multiple:!1},replaygain_album_minmax:{multiple:!1},replaygain_undo:{multiple:!1},description:{multiple:!0},longDescription:{multiple:!1},category:{multiple:!0},hdVideo:{multiple:!1},keywords:{multiple:!0},movement:{multiple:!1},movementIndex:{multiple:!1},movementTotal:{multiple:!1},podcastId:{multiple:!1},showMovement:{multiple:!1},stik:{multiple:!1}};function _M(t){return _h[t]&&!_h[t].multiple}function EM(t){return!_h[t].multiple||_h[t].unique||!1}class In{static toIntOrNull(e){const n=Number.parseInt(e,10);return Number.isNaN(n)?null:n}static normalizeTrack(e){const n=e.toString().split("/");return{no:Number.parseInt(n[0],10)||null,of:Number.parseInt(n[1],10)||null}}constructor(e,n){this.tagTypes=e,this.tagMap=n}mapGenericTag(e,n){e={id:e.id,value:e.value},this.postMap(e,n);const r=this.getCommonName(e.id);return r?{id:r,value:e.value}:null}getCommonName(e){return this.tagMap[e]}postMap(e,n){}}In.maxRatingScore=1;const SM={title:"title",artist:"artist",album:"album",year:"year",comment:"comment",track:"track",genre:"genre"};class bM extends In{constructor(){super(["ID3v1"],SM)}}class eu extends In{constructor(e,n){const r={};for(const i of Object.keys(n))r[i.toUpperCase()]=n[i];super(e,r)}getCommonName(e){return this.tagMap[e.toUpperCase()]}}const kM={TIT2:"title",TPE1:"artist","TXXX:Artists":"artists",TPE2:"albumartist",TALB:"album",TDRV:"date",TORY:"originalyear",TPOS:"disk",TCON:"genre",APIC:"picture",TCOM:"composer",USLT:"lyrics",TSOA:"albumsort",TSOT:"titlesort",TOAL:"originalalbum",TSOP:"artistsort",TSO2:"albumartistsort",TSOC:"composersort",TEXT:"lyricist","TXXX:Writer":"writer",TPE3:"conductor",TPE4:"remixer","IPLS:arranger":"arranger","IPLS:engineer":"engineer","IPLS:producer":"producer","IPLS:DJ-mix":"djmixer","IPLS:mix":"mixer",TPUB:"label",TIT1:"grouping",TIT3:"subtitle",TRCK:"track",TCMP:"compilation",POPM:"rating",TBPM:"bpm",TMED:"media","TXXX:CATALOGNUMBER":"catalognumber","TXXX:MusicBrainz Album Status":"releasestatus","TXXX:MusicBrainz Album Type":"releasetype","TXXX:MusicBrainz Album Release Country":"releasecountry","TXXX:RELEASECOUNTRY":"releasecountry","TXXX:SCRIPT":"script",TLAN:"language",TCOP:"copyright",WCOP:"license",TENC:"encodedby",TSSE:"encodersettings","TXXX:BARCODE":"barcode","TXXX:ISRC":"isrc",TSRC:"isrc","TXXX:ASIN":"asin","TXXX:originalyear":"originalyear","UFID:http://musicbrainz.org":"musicbrainz_recordingid","TXXX:MusicBrainz Release Track Id":"musicbrainz_trackid","TXXX:MusicBrainz Album Id":"musicbrainz_albumid","TXXX:MusicBrainz Artist Id":"musicbrainz_artistid","TXXX:MusicBrainz Album Artist Id":"musicbrainz_albumartistid","TXXX:MusicBrainz Release Group Id":"musicbrainz_releasegroupid","TXXX:MusicBrainz Work Id":"musicbrainz_workid","TXXX:MusicBrainz TRM Id":"musicbrainz_trmid","TXXX:MusicBrainz Disc Id":"musicbrainz_discid","TXXX:ACOUSTID_ID":"acoustid_id","TXXX:Acoustid Id":"acoustid_id","TXXX:Acoustid Fingerprint":"acoustid_fingerprint","TXXX:MusicIP PUID":"musicip_puid","TXXX:MusicMagic Fingerprint":"musicip_fingerprint",WOAR:"website",TDRC:"date",TYER:"year",TDOR:"originaldate","TIPL:arranger":"arranger","TIPL:engineer":"engineer","TIPL:producer":"producer","TIPL:DJ-mix":"djmixer","TIPL:mix":"mixer",TMOO:"mood",SYLT:"lyrics",TSST:"discsubtitle",TKEY:"key",COMM:"comment",TOPE:"originalartist","PRIV:AverageLevel":"averageLevel","PRIV:PeakLevel":"peakLevel","TXXX:DISCOGS_ARTIST_ID":"discogs_artist_id","TXXX:DISCOGS_ARTISTS":"artists","TXXX:DISCOGS_ARTIST_NAME":"artists","TXXX:DISCOGS_ALBUM_ARTISTS":"albumartist","TXXX:DISCOGS_CATALOG":"catalognumber","TXXX:DISCOGS_COUNTRY":"releasecountry","TXXX:DISCOGS_DATE":"originaldate","TXXX:DISCOGS_LABEL":"label","TXXX:DISCOGS_LABEL_ID":"discogs_label_id","TXXX:DISCOGS_MASTER_RELEASE_ID":"discogs_master_release_id","TXXX:DISCOGS_RATING":"discogs_rating","TXXX:DISCOGS_RELEASED":"date","TXXX:DISCOGS_RELEASE_ID":"discogs_release_id","TXXX:DISCOGS_VOTES":"discogs_votes","TXXX:CATALOGID":"catalognumber","TXXX:STYLE":"genre","TXXX:REPLAYGAIN_TRACK_PEAK":"replaygain_track_peak","TXXX:REPLAYGAIN_TRACK_GAIN":"replaygain_track_gain","TXXX:REPLAYGAIN_ALBUM_PEAK":"replaygain_album_peak","TXXX:REPLAYGAIN_ALBUM_GAIN":"replaygain_album_gain","TXXX:MP3GAIN_MINMAX":"replaygain_track_minmax","TXXX:MP3GAIN_ALBUM_MINMAX":"replaygain_album_minmax","TXXX:MP3GAIN_UNDO":"replaygain_undo",MVNM:"movement",MVIN:"movementIndex",PCST:"podcast",TCAT:"category",TDES:"description",TDRL:"releasedate",TGID:"podcastId",TKWD:"keywords",WFED:"podcasturl",GRP1:"grouping"};class Zv extends eu{static toRating(e){return{source:e.email,rating:e.rating>0?(e.rating-1)/254*In.maxRatingScore:void 0}}constructor(){super(["ID3v2.3","ID3v2.4"],kM)}postMap(e,n){switch(e.id){case"UFID":{const r=e.value;r.owner_identifier==="http://musicbrainz.org"&&(e.id+=`:${r.owner_identifier}`,e.value=pt(r.identifier,"latin1"))}break;case"PRIV":{const r=e.value;switch(r.owner_identifier){case"AverageLevel":case"PeakValue":e.id+=`:${r.owner_identifier}`,e.value=r.data.length===4?J.get(r.data,0):null,e.value===null&&n.addWarning("Failed to parse PRIV:PeakValue");break;default:n.addWarning(`Unknown PRIV owner-identifier: ${r.data}`)}}break;case"POPM":e.value=Zv.toRating(e.value);break}}}const TM={Title:"title",Author:"artist","WM/AlbumArtist":"albumartist","WM/AlbumTitle":"album","WM/Year":"date","WM/OriginalReleaseTime":"originaldate","WM/OriginalReleaseYear":"originalyear",Description:"comment","WM/TrackNumber":"track","WM/PartOfSet":"disk","WM/Genre":"genre","WM/Composer":"composer","WM/Lyrics":"lyrics","WM/AlbumSortOrder":"albumsort","WM/TitleSortOrder":"titlesort","WM/ArtistSortOrder":"artistsort","WM/AlbumArtistSortOrder":"albumartistsort","WM/ComposerSortOrder":"composersort","WM/Writer":"lyricist","WM/Conductor":"conductor","WM/ModifiedBy":"remixer","WM/Engineer":"engineer","WM/Producer":"producer","WM/DJMixer":"djmixer","WM/Mixer":"mixer","WM/Publisher":"label","WM/ContentGroupDescription":"grouping","WM/SubTitle":"subtitle","WM/SetSubTitle":"discsubtitle","WM/IsCompilation":"compilation","WM/SharedUserRating":"rating","WM/BeatsPerMinute":"bpm","WM/Mood":"mood","WM/Media":"media","WM/CatalogNo":"catalognumber","MusicBrainz/Album Status":"releasestatus","MusicBrainz/Album Type":"releasetype","MusicBrainz/Album Release Country":"releasecountry","WM/Script":"script","WM/Language":"language",Copyright:"copyright",LICENSE:"license","WM/EncodedBy":"encodedby","WM/EncodingSettings":"encodersettings","WM/Barcode":"barcode","WM/ISRC":"isrc","MusicBrainz/Track Id":"musicbrainz_recordingid","MusicBrainz/Release Track Id":"musicbrainz_trackid","MusicBrainz/Album Id":"musicbrainz_albumid","MusicBrainz/Artist Id":"musicbrainz_artistid","MusicBrainz/Album Artist Id":"musicbrainz_albumartistid","MusicBrainz/Release Group Id":"musicbrainz_releasegroupid","MusicBrainz/Work Id":"musicbrainz_workid","MusicBrainz/TRM Id":"musicbrainz_trmid","MusicBrainz/Disc Id":"musicbrainz_discid","Acoustid/Id":"acoustid_id","Acoustid/Fingerprint":"acoustid_fingerprint","MusicIP/PUID":"musicip_puid","WM/ARTISTS":"artists","WM/InitialKey":"key",ASIN:"asin","WM/Work":"work","WM/AuthorURL":"website","WM/Picture":"picture"};class ex extends In{static toRating(e){return{rating:Number.parseFloat(e+1)/5}}constructor(){super(["asf"],TM)}postMap(e){switch(e.id){case"WM/SharedUserRating":{const n=e.id.split(":");e.value=ex.toRating(e.value),e.id=n[0];break}}}}const IM={TT2:"title",TP1:"artist",TP2:"albumartist",TAL:"album",TYE:"year",COM:"comment",TRK:"track",TPA:"disk",TCO:"genre",PIC:"picture",TCM:"composer",TOR:"originaldate",TOT:"originalalbum",TXT:"lyricist",TP3:"conductor",TPB:"label",TT1:"grouping",TT3:"subtitle",TLA:"language",TCR:"copyright",WCP:"license",TEN:"encodedby",TSS:"encodersettings",WAR:"website",PCS:"podcast",TCP:"compilation",TDR:"date",TS2:"albumartistsort",TSA:"albumsort",TSC:"composersort",TSP:"artistsort",TST:"titlesort",WFD:"podcasturl",TBP:"bpm"};class CM extends eu{constructor(){super(["ID3v2.2"],IM)}}const AM={Title:"title",Artist:"artist",Artists:"artists","Album Artist":"albumartist",Album:"album",Year:"date",Originalyear:"originalyear",Originaldate:"originaldate",Releasedate:"releasedate",Comment:"comment",Track:"track",Disc:"disk",DISCNUMBER:"disk",Genre:"genre","Cover Art (Front)":"picture","Cover Art (Back)":"picture",Composer:"composer",Lyrics:"lyrics",ALBUMSORT:"albumsort",TITLESORT:"titlesort",WORK:"work",ARTISTSORT:"artistsort",ALBUMARTISTSORT:"albumartistsort",COMPOSERSORT:"composersort",Lyricist:"lyricist",Writer:"writer",Conductor:"conductor",MixArtist:"remixer",Arranger:"arranger",Engineer:"engineer",Producer:"producer",DJMixer:"djmixer",Mixer:"mixer",Label:"label",Grouping:"grouping",Subtitle:"subtitle",DiscSubtitle:"discsubtitle",Compilation:"compilation",BPM:"bpm",Mood:"mood",Media:"media",CatalogNumber:"catalognumber",MUSICBRAINZ_ALBUMSTATUS:"releasestatus",MUSICBRAINZ_ALBUMTYPE:"releasetype",RELEASECOUNTRY:"releasecountry",Script:"script",Language:"language",Copyright:"copyright",LICENSE:"license",EncodedBy:"encodedby",EncoderSettings:"encodersettings",Barcode:"barcode",ISRC:"isrc",ASIN:"asin",musicbrainz_trackid:"musicbrainz_recordingid",musicbrainz_releasetrackid:"musicbrainz_trackid",MUSICBRAINZ_ALBUMID:"musicbrainz_albumid",MUSICBRAINZ_ARTISTID:"musicbrainz_artistid",MUSICBRAINZ_ALBUMARTISTID:"musicbrainz_albumartistid",MUSICBRAINZ_RELEASEGROUPID:"musicbrainz_releasegroupid",MUSICBRAINZ_WORKID:"musicbrainz_workid",MUSICBRAINZ_TRMID:"musicbrainz_trmid",MUSICBRAINZ_DISCID:"musicbrainz_discid",Acoustid_Id:"acoustid_id",ACOUSTID_FINGERPRINT:"acoustid_fingerprint",MUSICIP_PUID:"musicip_puid",Weblink:"website",REPLAYGAIN_TRACK_GAIN:"replaygain_track_gain",REPLAYGAIN_TRACK_PEAK:"replaygain_track_peak",MP3GAIN_MINMAX:"replaygain_track_minmax",MP3GAIN_UNDO:"replaygain_undo"};class RM extends eu{constructor(){super(["APEv2"],AM)}}const PM={"©nam":"title","©ART":"artist",aART:"albumartist","----:com.apple.iTunes:Band":"albumartist","©alb":"album","©day":"date","©cmt":"comment","©com":"comment",trkn:"track",disk:"disk","©gen":"genre",covr:"picture","©wrt":"composer","©lyr":"lyrics",soal:"albumsort",sonm:"titlesort",soar:"artistsort",soaa:"albumartistsort",soco:"composersort","----:com.apple.iTunes:LYRICIST":"lyricist","----:com.apple.iTunes:CONDUCTOR":"conductor","----:com.apple.iTunes:REMIXER":"remixer","----:com.apple.iTunes:ENGINEER":"engineer","----:com.apple.iTunes:PRODUCER":"producer","----:com.apple.iTunes:DJMIXER":"djmixer","----:com.apple.iTunes:MIXER":"mixer","----:com.apple.iTunes:LABEL":"label","©grp":"grouping","----:com.apple.iTunes:SUBTITLE":"subtitle","----:com.apple.iTunes:DISCSUBTITLE":"discsubtitle",cpil:"compilation",tmpo:"bpm","----:com.apple.iTunes:MOOD":"mood","----:com.apple.iTunes:MEDIA":"media","----:com.apple.iTunes:CATALOGNUMBER":"catalognumber",tvsh:"tvShow",tvsn:"tvSeason",tves:"tvEpisode",sosn:"tvShowSort",tven:"tvEpisodeId",tvnn:"tvNetwork",pcst:"podcast",purl:"podcasturl","----:com.apple.iTunes:MusicBrainz Album Status":"releasestatus","----:com.apple.iTunes:MusicBrainz Album Type":"releasetype","----:com.apple.iTunes:MusicBrainz Album Release Country":"releasecountry","----:com.apple.iTunes:SCRIPT":"script","----:com.apple.iTunes:LANGUAGE":"language",cprt:"copyright","©cpy":"copyright","----:com.apple.iTunes:LICENSE":"license","©too":"encodedby",pgap:"gapless","----:com.apple.iTunes:BARCODE":"barcode","----:com.apple.iTunes:ISRC":"isrc","----:com.apple.iTunes:ASIN":"asin","----:com.apple.iTunes:NOTES":"comment","----:com.apple.iTunes:MusicBrainz Track Id":"musicbrainz_recordingid","----:com.apple.iTunes:MusicBrainz Release Track Id":"musicbrainz_trackid","----:com.apple.iTunes:MusicBrainz Album Id":"musicbrainz_albumid","----:com.apple.iTunes:MusicBrainz Artist Id":"musicbrainz_artistid","----:com.apple.iTunes:MusicBrainz Album Artist Id":"musicbrainz_albumartistid","----:com.apple.iTunes:MusicBrainz Release Group Id":"musicbrainz_releasegroupid","----:com.apple.iTunes:MusicBrainz Work Id":"musicbrainz_workid","----:com.apple.iTunes:MusicBrainz TRM Id":"musicbrainz_trmid","----:com.apple.iTunes:MusicBrainz Disc Id":"musicbrainz_discid","----:com.apple.iTunes:Acoustid Id":"acoustid_id","----:com.apple.iTunes:Acoustid Fingerprint":"acoustid_fingerprint","----:com.apple.iTunes:MusicIP PUID":"musicip_puid","----:com.apple.iTunes:fingerprint":"musicip_fingerprint","----:com.apple.iTunes:replaygain_track_gain":"replaygain_track_gain","----:com.apple.iTunes:replaygain_track_peak":"replaygain_track_peak","----:com.apple.iTunes:replaygain_album_gain":"replaygain_album_gain","----:com.apple.iTunes:replaygain_album_peak":"replaygain_album_peak","----:com.apple.iTunes:replaygain_track_minmax":"replaygain_track_minmax","----:com.apple.iTunes:replaygain_album_minmax":"replaygain_album_minmax","----:com.apple.iTunes:replaygain_undo":"replaygain_undo",gnre:"genre","----:com.apple.iTunes:ALBUMARTISTSORT":"albumartistsort","----:com.apple.iTunes:ARTISTS":"artists","----:com.apple.iTunes:ORIGINALDATE":"originaldate","----:com.apple.iTunes:ORIGINALYEAR":"originalyear","----:com.apple.iTunes:RELEASEDATE":"releasedate",desc:"description",ldes:"longDescription","©mvn":"movement","©mvi":"movementIndex","©mvc":"movementTotal","©wrk":"work",catg:"category",egid:"podcastId",hdvd:"hdVideo",keyw:"keywords",shwm:"showMovement",stik:"stik",rate:"rating"},NM="iTunes";class F_ extends eu{constructor(){super([NM],PM)}postMap(e,n){switch(e.id){case"rate":e.value={source:void 0,rating:Number.parseFloat(e.value)/100};break}}}const DM={TITLE:"title",ARTIST:"artist",ARTISTS:"artists",ALBUMARTIST:"albumartist","ALBUM ARTIST":"albumartist",ALBUM:"album",DATE:"date",ORIGINALDATE:"originaldate",ORIGINALYEAR:"originalyear",RELEASEDATE:"releasedate",COMMENT:"comment",TRACKNUMBER:"track",DISCNUMBER:"disk",GENRE:"genre",METADATA_BLOCK_PICTURE:"picture",COMPOSER:"composer",LYRICS:"lyrics",ALBUMSORT:"albumsort",TITLESORT:"titlesort",WORK:"work",ARTISTSORT:"artistsort",ALBUMARTISTSORT:"albumartistsort",COMPOSERSORT:"composersort",LYRICIST:"lyricist",WRITER:"writer",CONDUCTOR:"conductor",REMIXER:"remixer",ARRANGER:"arranger",ENGINEER:"engineer",PRODUCER:"producer",DJMIXER:"djmixer",MIXER:"mixer",LABEL:"label",GROUPING:"grouping",SUBTITLE:"subtitle",DISCSUBTITLE:"discsubtitle",TRACKTOTAL:"totaltracks",DISCTOTAL:"totaldiscs",COMPILATION:"compilation",RATING:"rating",BPM:"bpm",KEY:"key",MOOD:"mood",MEDIA:"media",CATALOGNUMBER:"catalognumber",RELEASESTATUS:"releasestatus",RELEASETYPE:"releasetype",RELEASECOUNTRY:"releasecountry",SCRIPT:"script",LANGUAGE:"language",COPYRIGHT:"copyright",LICENSE:"license",ENCODEDBY:"encodedby",ENCODERSETTINGS:"encodersettings",BARCODE:"barcode",ISRC:"isrc",ASIN:"asin",MUSICBRAINZ_TRACKID:"musicbrainz_recordingid",MUSICBRAINZ_RELEASETRACKID:"musicbrainz_trackid",MUSICBRAINZ_ALBUMID:"musicbrainz_albumid",MUSICBRAINZ_ARTISTID:"musicbrainz_artistid",MUSICBRAINZ_ALBUMARTISTID:"musicbrainz_albumartistid",MUSICBRAINZ_RELEASEGROUPID:"musicbrainz_releasegroupid",MUSICBRAINZ_WORKID:"musicbrainz_workid",MUSICBRAINZ_TRMID:"musicbrainz_trmid",MUSICBRAINZ_DISCID:"musicbrainz_discid",ACOUSTID_ID:"acoustid_id",ACOUSTID_ID_FINGERPRINT:"acoustid_fingerprint",MUSICIP_PUID:"musicip_puid",WEBSITE:"website",NOTES:"notes",TOTALTRACKS:"totaltracks",TOTALDISCS:"totaldiscs",DISCOGS_ARTIST_ID:"discogs_artist_id",DISCOGS_ARTISTS:"artists",DISCOGS_ARTIST_NAME:"artists",DISCOGS_ALBUM_ARTISTS:"albumartist",DISCOGS_CATALOG:"catalognumber",DISCOGS_COUNTRY:"releasecountry",DISCOGS_DATE:"originaldate",DISCOGS_LABEL:"label",DISCOGS_LABEL_ID:"discogs_label_id",DISCOGS_MASTER_RELEASE_ID:"discogs_master_release_id",DISCOGS_RATING:"discogs_rating",DISCOGS_RELEASED:"date",DISCOGS_RELEASE_ID:"discogs_release_id",DISCOGS_VOTES:"discogs_votes",CATALOGID:"catalognumber",STYLE:"genre",REPLAYGAIN_TRACK_GAIN:"replaygain_track_gain",REPLAYGAIN_TRACK_PEAK:"replaygain_track_peak",REPLAYGAIN_ALBUM_GAIN:"replaygain_album_gain",REPLAYGAIN_ALBUM_PEAK:"replaygain_album_peak",REPLAYGAIN_MINMAX:"replaygain_track_minmax",REPLAYGAIN_ALBUM_MINMAX:"replaygain_album_minmax",REPLAYGAIN_UNDO:"replaygain_undo"};class Eh extends In{static toRating(e,n,r){return{source:e?e.toLowerCase():void 0,rating:Number.parseFloat(n)/r*In.maxRatingScore}}constructor(){super(["vorbis"],DM)}postMap(e){if(e.id==="RATING")e.value=Eh.toRating(void 0,e.value,100);else if(e.id.indexOf("RATING:")===0){const n=e.id.split(":");e.value=Eh.toRating(n[1],e.value,1),e.id=n[0]}}}const jM={IART:"artist",ICRD:"date",INAM:"title",TITL:"title",IPRD:"album",ITRK:"track",IPRT:"track",COMM:"comment",ICMT:"comment",ICNT:"releasecountry",GNRE:"genre",IWRI:"writer",RATE:"rating",YEAR:"year",ISFT:"encodedby",CODE:"encodedby",TURL:"website",IGNR:"genre",IENG:"engineer",ITCH:"technician",IMED:"media",IRPD:"album"};class OM extends In{constructor(){super(["exif"],jM)}}const MM={"segment:title":"title","album:ARTIST":"albumartist","album:ARTISTSORT":"albumartistsort","album:TITLE":"album","album:DATE_RECORDED":"originaldate","album:DATE_RELEASED":"releasedate","album:PART_NUMBER":"disk","album:TOTAL_PARTS":"totaltracks","track:ARTIST":"artist","track:ARTISTSORT":"artistsort","track:TITLE":"title","track:PART_NUMBER":"track","track:MUSICBRAINZ_TRACKID":"musicbrainz_recordingid","track:MUSICBRAINZ_ALBUMID":"musicbrainz_albumid","track:MUSICBRAINZ_ARTISTID":"musicbrainz_artistid","track:PUBLISHER":"label","track:GENRE":"genre","track:ENCODER":"encodedby","track:ENCODER_OPTIONS":"encodersettings","edition:TOTAL_PARTS":"totaldiscs",picture:"picture"};class LM extends eu{constructor(){super(["matroska"],MM)}}const FM={NAME:"title",AUTH:"artist","(c) ":"copyright",ANNO:"comment"};class $M extends In{constructor(){super(["AIFF"],FM)}}class zM{constructor(){this.tagMappers={},[new bM,new CM,new Zv,new F_,new F_,new Eh,new RM,new ex,new OM,new LM,new $M].forEach(e=>{this.registerTagMapper(e)})}mapTag(e,n,r){if(this.tagMappers[e])return this.tagMappers[e].mapGenericTag(n,r);throw new Error(`No generic tag mapper defined for tag-format: ${e}`)}registerTagMapper(e){for(const n of e.tagTypes)this.tagMappers[n]=e}}const Es=Ne("music-metadata:collector"),BM=["matroska","APEv2","vorbis","ID3v2.4","ID3v2.3","ID3v2.2","exif","asf","iTunes","AIFF","ID3v1"];class VM{constructor(e){this.opts=e,this.format={tagTypes:[],trackInfo:[]},this.native={},this.common={track:{no:null,of:null},disk:{no:null,of:null},movementIndex:{no:null,of:null}},this.quality={warnings:[]},this.commonOrigin={},this.originPriority={},this.tagMapper=new zM;let n=1;for(const r of BM)this.originPriority[r]=n++;this.originPriority.artificial=500,this.originPriority.id3v1=600}hasAny(){return Object.keys(this.native).length>0}addStreamInfo(e){Es(`streamInfo: type=${e.type?Zs[e.type]:"?"}, codec=${e.codecName}`),this.format.trackInfo.push(e)}setFormat(e,n){var r;Es(`format: ${e} = ${n}`),this.format[e]=n,(r=this.opts)!=null&&r.observer&&this.opts.observer({metadata:this,tag:{type:"format",id:e,value:n}})}async addTag(e,n,r){Es(`tag ${e}.${n} = ${r}`),this.native[e]||(this.format.tagTypes.push(e),this.native[e]=[]),this.native[e].push({id:n,value:r}),await this.toCommon(e,n,r)}addWarning(e){this.quality.warnings.push({message:e})}async postMap(e,n){switch(n.id){case"artist":if(this.commonOrigin.artist===this.originPriority[e])return this.postMap("artificial",{id:"artists",value:n.value});this.common.artists||this.setGenericTag("artificial",{id:"artists",value:n.value});break;case"artists":if((!this.common.artist||this.commonOrigin.artist===this.originPriority.artificial)&&(!this.common.artists||this.common.artists.indexOf(n.value)===-1)){const r=(this.common.artists||[]).concat([n.value]),s={id:"artist",value:UM(r)};this.setGenericTag("artificial",s)}break;case"picture":return this.postFixPicture(n.value).then(r=>{r!==null&&(n.value=r,this.setGenericTag(e,n))});case"totaltracks":this.common.track.of=In.toIntOrNull(n.value);return;case"totaldiscs":this.common.disk.of=In.toIntOrNull(n.value);return;case"movementTotal":this.common.movementIndex.of=In.toIntOrNull(n.value);return;case"track":case"disk":case"movementIndex":{const r=this.common[n.id].of;this.common[n.id]=In.normalizeTrack(n.value),this.common[n.id].of=r??this.common[n.id].of;return}case"bpm":case"year":case"originalyear":n.value=Number.parseInt(n.value,10);break;case"date":{const r=Number.parseInt(n.value.substr(0,4),10);Number.isNaN(r)||(this.common.year=r);break}case"discogs_label_id":case"discogs_release_id":case"discogs_master_release_id":case"discogs_artist_id":case"discogs_votes":n.value=typeof n.value=="string"?Number.parseInt(n.value,10):n.value;break;case"replaygain_track_gain":case"replaygain_track_peak":case"replaygain_album_gain":case"replaygain_album_peak":n.value=wM(n.value);break;case"replaygain_track_minmax":n.value=n.value.split(",").map(r=>Number.parseInt(r,10));break;case"replaygain_undo":{const r=n.value.split(",").map(i=>Number.parseInt(i,10));n.value={leftChannel:r[0],rightChannel:r[1]};break}case"gapless":case"compilation":case"podcast":case"showMovement":n.value=n.value==="1"||n.value===1;break;case"isrc":{const r=this.common[n.id];if(r&&r.indexOf(n.value)!==-1)return;break}case"comment":typeof n.value=="string"&&(n.value={text:n.value}),n.value.descriptor==="iTunPGAP"&&this.setGenericTag(e,{id:"gapless",value:n.value.text==="1"});break}n.value!==null&&this.setGenericTag(e,n)}toCommonMetadata(){return{format:this.format,native:this.native,quality:this.quality,common:this.common}}async postFixPicture(e){if(e.data&&e.data.length>0){if(!e.format){const n=await jT(Uint8Array.from(e.data));if(n)e.format=n.mime;else return null}switch(e.format=e.format.toLocaleLowerCase(),e.format){case"image/jpg":e.format="image/jpeg"}return e}return this.addWarning("Empty picture tag found"),null}async toCommon(e,n,r){const i={id:n,value:r},s=this.tagMapper.mapTag(e,i,this);s&&await this.postMap(e,s)}setGenericTag(e,n){var s;Es(`common.${n.id} = ${n.value}`);const r=this.commonOrigin[n.id]||1e3,i=this.originPriority[e];if(_M(n.id))if(i<=r)this.common[n.id]=n.value,this.commonOrigin[n.id]=i;else return Es(`Ignore native tag (singleton): ${e}.${n.id} = ${n.value}`);else if(i===r)!EM(n.id)||this.common[n.id].indexOf(n.value)===-1?this.common[n.id].push(n.value):Es(`Ignore duplicate value: ${e}.${n.id} = ${n.value}`);else if(i<r)this.common[n.id]=[n.value],this.commonOrigin[n.id]=i;else return Es(`Ignore native tag (list): ${e}.${n.id} = ${n.value}`);(s=this.opts)!=null&&s.observer&&this.opts.observer({metadata:this,tag:{type:"common",id:n.id,value:n.value}})}}function UM(t){return t.length>2?`${t.slice(0,t.length-1).join(", ")} & ${t[t.length-1]}`:t.join(" & ")}class Bn{constructor(){this.metadata=void 0,this.tokenizer=void 0,this.options=void 0}init(e,n,r){return this.metadata=e,this.tokenizer=n,this.options=r,this}}const WM=/^[\x21-\x7e©][\x20-\x7e\x00()]{3}/,Ve={len:4,get:(t,e)=>{const n=Qv(t.slice(e,e+Ve.len),"latin1");if(!n.match(WM))throw new Error(`FourCC contains invalid characters: ${yM(n)} "${n}"`);return n},put:(t,e,n)=>{const r=HO(n);if(r.length!==4)throw new Error("Invalid length");return t.set(r,e),e+4}};var Zo;(function(t){t[t.text_utf8=0]="text_utf8",t[t.binary=1]="binary",t[t.external_info=2]="external_info",t[t.reserved=3]="reserved"})(Zo||(Zo={}));const $_={len:52,get:(t,e)=>({ID:Ve.get(t,e),version:J.get(t,e+4)/1e3,descriptorBytes:J.get(t,e+8),headerBytes:J.get(t,e+12),seekTableBytes:J.get(t,e+16),headerDataBytes:J.get(t,e+20),apeFrameDataBytes:J.get(t,e+24),apeFrameDataBytesHigh:J.get(t,e+28),terminatingDataBytes:J.get(t,e+32),fileMD5:new cn(16).get(t,e+36)})},HM={len:24,get:(t,e)=>({compressionLevel:ke.get(t,e),formatFlags:ke.get(t,e+2),blocksPerFrame:J.get(t,e+4),finalFrameBlocks:J.get(t,e+8),totalFrames:J.get(t,e+12),bitsPerSample:ke.get(t,e+16),channel:ke.get(t,e+18),sampleRate:J.get(t,e+20)})},Wn={len:32,get:(t,e)=>({ID:new ne(8,"ascii").get(t,e),version:J.get(t,e+8),size:J.get(t,e+12),fields:J.get(t,e+16),flags:zT(J.get(t,e+20))})},Np={len:8,get:(t,e)=>({size:J.get(t,e),flags:zT(J.get(t,e+4))})};function zT(t){return{containsHeader:Xu(t,31),containsFooter:Xu(t,30),isHeader:Xu(t,29),readOnly:Xu(t,0),dataType:(t&6)>>1}}function Xu(t,e){return(t&1<<e)!==0}const Ss=Ne("music-metadata:parser:APEv2"),z_="APEv2",B_="APETAGEX";class kr extends Bn{constructor(){super(...arguments),this.ape={}}static tryParseApeHeader(e,n,r){const i=new kr;return i.init(e,n,r),i.tryParseApeHeader()}static calculateDuration(e){let n=e.totalFrames>1?e.blocksPerFrame*(e.totalFrames-1):0;return n+=e.finalFrameBlocks,n/e.sampleRate}static async findApeFooterOffset(e,n){const r=new Uint8Array(Wn.len);await e.randomRead(r,0,Wn.len,n-Wn.len);const i=Wn.get(r,0);if(i.ID==="APETAGEX")return i.flags.isHeader?Ss(`APE Header found at offset=${n-Wn.len}`):(Ss(`APE Footer found at offset=${n-Wn.len}`),n-=i.size),{footer:i,offset:n}}static parseTagFooter(e,n,r){const i=Wn.get(n,n.length-Wn.len);if(i.ID!==B_)throw new Error("Unexpected APEv2 Footer ID preamble value.");Ta(n);const s=new kr;return s.init(e,Ta(n),r),s.parseTags(i)}async tryParseApeHeader(){if(this.tokenizer.fileInfo.size&&this.tokenizer.fileInfo.size-this.tokenizer.position<Wn.len){Ss("No APEv2 header found, end-of-file reached");return}const e=await this.tokenizer.peekToken(Wn);if(e.ID===B_)return await this.tokenizer.ignore(Wn.len),this.parseTags(e);if(Ss(`APEv2 header not found at offset=${this.tokenizer.position}`),this.tokenizer.fileInfo.size){const n=this.tokenizer.fileInfo.size-this.tokenizer.position,r=new Uint8Array(n);return await this.tokenizer.readBuffer(r),kr.parseTagFooter(this.metadata,r,this.options)}}async parse(){const e=await this.tokenizer.readToken($_);if(e.ID!=="MAC ")throw new Error("Unexpected descriptor ID");this.ape.descriptor=e;const n=e.descriptorBytes-$_.len,r=await(n>0?this.parseDescriptorExpansion(n):this.parseHeader());return await this.tokenizer.ignore(r.forwardBytes),this.tryParseApeHeader()}async parseTags(e){const n=new Uint8Array(256);let r=e.size-Wn.len;Ss(`Parse APE tags at offset=${this.tokenizer.position}, size=${r}`);for(let i=0;i<e.fields;i++){if(r<Np.len){this.metadata.addWarning(`APEv2 Tag-header: ${e.fields-i} items remaining, but no more tag data to read.`);break}const s=await this.tokenizer.readToken(Np);r-=Np.len+s.size,await this.tokenizer.peekBuffer(n,{length:Math.min(n.length,r)});let o=_n(n,0,n.length);const a=await this.tokenizer.readToken(new ne(o,"ascii"));switch(await this.tokenizer.ignore(1),r-=a.length+1,s.flags.dataType){case Zo.text_utf8:{const c=(await this.tokenizer.readToken(new ne(s.size,"utf8"))).split(/\x00/g);await Promise.all(c.map(d=>this.metadata.addTag(z_,a,d)));break}case Zo.binary:if(this.options.skipCovers)await this.tokenizer.ignore(s.size);else{const l=new Uint8Array(s.size);await this.tokenizer.readBuffer(l),o=_n(l,0,l.length);const c=Qv(l.slice(0,o)),d=l.slice(o+1);await this.metadata.addTag(z_,a,{description:c,data:d})}break;case Zo.external_info:Ss(`Ignore external info ${a}`),await this.tokenizer.ignore(s.size);break;case Zo.reserved:Ss(`Ignore external info ${a}`),this.metadata.addWarning(`APEv2 header declares a reserved datatype for "${a}"`),await this.tokenizer.ignore(s.size);break}}}async parseDescriptorExpansion(e){return await this.tokenizer.ignore(e),this.parseHeader()}async parseHeader(){const e=await this.tokenizer.readToken(HM);if(this.metadata.setFormat("lossless",!0),this.metadata.setFormat("container","Monkey's Audio"),this.metadata.setFormat("bitsPerSample",e.bitsPerSample),this.metadata.setFormat("sampleRate",e.sampleRate),this.metadata.setFormat("numberOfChannels",e.channel),this.metadata.setFormat("duration",kr.calculateDuration(e)),!this.ape.descriptor)throw new Error("Missing APE descriptor");return{forwardBytes:this.ape.descriptor.seekTableBytes+this.ape.descriptor.headerDataBytes+this.ape.descriptor.apeFrameDataBytes+this.ape.descriptor.terminatingDataBytes}}}const Qu=Ne("music-metadata:parser:ID3v1"),Sh=["Blues","Classic Rock","Country","Dance","Disco","Funk","Grunge","Hip-Hop","Jazz","Metal","New Age","Oldies","Other","Pop","R&B","Rap","Reggae","Rock","Techno","Industrial","Alternative","Ska","Death Metal","Pranks","Soundtrack","Euro-Techno","Ambient","Trip-Hop","Vocal","Jazz+Funk","Fusion","Trance","Classical","Instrumental","Acid","House","Game","Sound Clip","Gospel","Noise","Alt. Rock","Bass","Soul","Punk","Space","Meditative","Instrumental Pop","Instrumental Rock","Ethnic","Gothic","Darkwave","Techno-Industrial","Electronic","Pop-Folk","Eurodance","Dream","Southern Rock","Comedy","Cult","Gangsta Rap","Top 40","Christian Rap","Pop/Funk","Jungle","Native American","Cabaret","New Wave","Psychedelic","Rave","Showtunes","Trailer","Lo-Fi","Tribal","Acid Punk","Acid Jazz","Polka","Retro","Musical","Rock & Roll","Hard Rock","Folk","Folk/Rock","National Folk","Swing","Fast-Fusion","Bebob","Latin","Revival","Celtic","Bluegrass","Avantgarde","Gothic Rock","Progressive Rock","Psychedelic Rock","Symphonic Rock","Slow Rock","Big Band","Chorus","Easy Listening","Acoustic","Humour","Speech","Chanson","Opera","Chamber Music","Sonata","Symphony","Booty Bass","Primus","Porn Groove","Satire","Slow Jam","Club","Tango","Samba","Folklore","Ballad","Power Ballad","Rhythmic Soul","Freestyle","Duet","Punk Rock","Drum Solo","A Cappella","Euro-House","Dance Hall","Goa","Drum & Bass","Club-House","Hardcore","Terror","Indie","BritPop","Negerpunk","Polsk Punk","Beat","Christian Gangsta Rap","Heavy Metal","Black Metal","Crossover","Contemporary Christian","Christian Rock","Merengue","Salsa","Thrash Metal","Anime","JPop","Synthpop","Abstract","Art Rock","Baroque","Bhangra","Big Beat","Breakbeat","Chillout","Downtempo","Dub","EBM","Eclectic","Electro","Electroclash","Emo","Experimental","Garage","Global","IDM","Illbient","Industro-Goth","Jam Band","Krautrock","Leftfield","Lounge","Math Rock","New Romantic","Nu-Breakz","Post-Punk","Post-Rock","Psytrance","Shoegaze","Space Rock","Trop Rock","World Music","Neoclassical","Audiobook","Audio Theatre","Neue Deutsche Welle","Podcast","Indie Rock","G-Funk","Dubstep","Garage Rock","Psybient"],Yu={len:128,get:(t,e)=>{const n=new Po(3).get(t,e);return n==="TAG"?{header:n,title:new Po(30).get(t,e+3),artist:new Po(30).get(t,e+33),album:new Po(30).get(t,e+63),year:new Po(4).get(t,e+93),comment:new Po(28).get(t,e+97),zeroByte:he.get(t,e+127),track:he.get(t,e+126),genre:he.get(t,e+127)}:null}};class Po{constructor(e){this.len=e,this.stringType=new ne(e,"latin1")}get(e,n){let r=this.stringType.get(e,n);return r=LT(r),r=r.trim(),r.length>0?r:void 0}}class tx extends Bn{static getGenre(e){if(e<Sh.length)return Sh[e]}async parse(){if(!this.tokenizer.fileInfo.size){Qu("Skip checking for ID3v1 because the file-size is unknown");return}if(this.options.apeHeader){this.tokenizer.ignore(this.options.apeHeader.offset-this.tokenizer.position);const r=new kr;r.init(this.metadata,this.tokenizer,this.options),await r.parseTags(this.options.apeHeader.footer)}const e=this.tokenizer.fileInfo.size-Yu.len;if(this.tokenizer.position>e){Qu("Already consumed the last 128 bytes");return}const n=await this.tokenizer.readToken(Yu,e);if(n){Qu("ID3v1 header found at: pos=%s",this.tokenizer.fileInfo.size-Yu.len);const r=["title","artist","album","comment","track","year"];for(const s of r)n[s]&&n[s]!==""&&await this.addTag(s,n[s]);const i=tx.getGenre(n.genre);i&&await this.addTag("genre",i)}else Qu("ID3v1 header not found at: pos=%s",this.tokenizer.fileInfo.size-Yu.len)}async addTag(e,n){await this.metadata.addTag("ID3v1",e,n)}}const V_=Ne("music-metadata:id3v2:frame-parser"),rr="latin1";function qM(t){const e=[];let n,r="";for(const i of t)if(typeof n=="string")if(i==="("&&n==="")r+="(",n=void 0;else if(i===")"){r!==""&&(e.push(r),r="");const s=U_(n);s&&e.push(s),n=void 0}else n+=i;else i==="("?n="":r+=i;return r&&(e.length===0&&r.match(/^\d*$/)&&(r=U_(r)),r&&e.push(r)),e}function U_(t){if(t==="RX")return"Remix";if(t==="CR")return"Cover";if(t.match(/^\d*$/))return Sh[Number.parseInt(t)]}class En{constructor(e,n){this.major=e,this.warningCollector=n}readData(e,n,r){if(e.length===0){this.warningCollector.addWarning(`id3v2.${this.major} header has empty tag type=${n}`);return}const{encoding:i,bom:s}=$T.get(e,0),o=e.length;let a=0,l=[];const c=En.getNullTerminatorLength(i);let d;switch(V_(`Parsing tag type=${n}, encoding=${i}, bom=${s}`),n!=="TXXX"&&n[0]==="T"?"T*":n){case"T*":case"GRP1":case"IPLS":case"MVIN":case"MVNM":case"PCS":case"PCST":{let h;try{h=pt(e.slice(1),i).replace(/\x00+$/,"")}catch(m){if(m instanceof Error){this.warningCollector.addWarning(`id3v2.${this.major} type=${n} header has invalid string value: ${m.message}`);break}throw m}switch(n){case"TMCL":case"TIPL":case"IPLS":l=En.functionList(this.splitValue(n,h));break;case"TRK":case"TRCK":case"TPOS":l=h;break;case"TCOM":case"TEXT":case"TOLY":case"TOPE":case"TPE1":case"TSRC":l=this.splitValue(n,h);break;case"TCO":case"TCON":l=this.splitValue(n,h).map(m=>qM(m)).reduce((m,p)=>m.concat(p),[]);break;case"PCS":case"PCST":l=this.major>=4?this.splitValue(n,h):[h],l=Array.isArray(l)&&l[0]===""?1:0;break;default:l=this.major>=4?this.splitValue(n,h):[h]}break}case"TXXX":{const h=En.readIdentifierAndData(e,a+1,o,i);l={description:h.id,text:this.splitValue(n,pt(h.data,i).replace(/\x00+$/,""))};break}case"PIC":case"APIC":if(r){const h={};switch(a+=1,this.major){case 2:h.format=pt(e.slice(a,a+3),"latin1"),a+=3;break;case 3:case 4:d=_n(e,a,o,rr),h.format=pt(e.slice(a,d),rr),a=d+1;break;default:throw new Error(`Warning: unexpected major versionIndex: ${this.major}`)}h.format=En.fixPictureMimeType(h.format),h.type=_c[e[a]],a+=1,d=_n(e,a,o,i),h.description=pt(e.slice(a,d),i),a=d+c,h.data=e.slice(a,o),l=h}break;case"CNT":case"PCNT":l=re.get(e,0);break;case"SYLT":{const h=L_.get(e,0);a+=L_.len;const m={descriptor:"",language:h.language,contentType:h.contentType,timeStampFormat:h.timeStampFormat,syncText:[]};let p=!1;for(;a<o;){const y=En.readNullTerminatedString(e.subarray(a),h.encoding);if(a+=y.len,p){const x=re.get(e,a);a+=re.len,m.syncText.push({text:y.text,timestamp:x})}else m.descriptor=y.text,p=!0}l=m;break}case"ULT":case"USLT":case"COM":case"COMM":{const h=M0.get(e,a);a+=M0.len;const m=En.readNullTerminatedString(e.subarray(a),h.encoding);a+=m.len;const p=En.readNullTerminatedString(e.subarray(a),h.encoding);l={language:h.language,descriptor:m.text,text:p.text};break}case"UFID":{const h=En.readIdentifierAndData(e,a,o,rr);l={owner_identifier:h.id,identifier:h.data};break}case"PRIV":{const h=En.readIdentifierAndData(e,a,o,rr);l={owner_identifier:h.id,data:h.data};break}case"POPM":{d=_n(e,a,o,rr);const h=pt(e.slice(a,d),rr);a=d+1;const m=o-a;l={email:h,rating:he.get(e,a),counter:m>=5?re.get(e,a+1):void 0};break}case"GEOB":{d=_n(e,a+1,o,i);const h=pt(e.slice(a+1,d),rr);a=d+1,d=_n(e,a,o-a,i);const m=pt(e.slice(a,d),rr);a=d+1,d=_n(e,a,o-a,i);const p=pt(e.slice(a,d),rr);l={type:h,filename:m,description:p,data:e.slice(a+1,o)};break}case"WCOM":case"WCOP":case"WOAF":case"WOAR":case"WOAS":case"WORS":case"WPAY":case"WPUB":d=_n(e,a+1,o,i),l=pt(e.slice(a,d),rr);break;case"WXXX":{d=_n(e,a+1,o,i);const h=pt(e.slice(a+1,d),i);a=d+(i==="utf-16le"?2:1),l={description:h,url:pt(e.slice(a,o),rr)};break}case"WFD":case"WFED":l=pt(e.slice(a+1,_n(e,a+1,o,i)),i);break;case"MCDI":{l=e.slice(0,o);break}default:V_(`Warning: unsupported id3v2-tag-type: ${n}`);break}return l}static readNullTerminatedString(e,n){let r=n.bom?2:0;const i=_n(e,r,e.length,n.encoding),s=e.slice(r,i);return n.encoding==="utf-16le"?r=i+2:r=i+1,{text:pt(s,n.encoding),len:r}}static fixPictureMimeType(e){switch(e=e.toLocaleLowerCase(),e){case"jpg":return"image/jpeg";case"png":return"image/png"}return e}static functionList(e){const n={};for(let r=0;r+1<e.length;r+=2){const i=e[r+1].split(",");n[e[r]]=n[e[r]]?n[e[r]].concat(i):i}return n}splitValue(e,n){let r;return this.major<4?(r=n.split(/\x00/g),r.length>1?this.warningCollector.addWarning(`ID3v2.${this.major} ${e} uses non standard null-separator.`):r=n.split(/\//g)):r=n.split(/\x00/g),En.trimArray(r)}static trimArray(e){return e.map(n=>n.replace(/\x00+$/,"").trim())}static readIdentifierAndData(e,n,r,i){const s=_n(e,n,r,i),o=pt(e.slice(n,s),i);return n=s+En.getNullTerminatorLength(i),{id:o,data:e.slice(n,r)}}static getNullTerminatorLength(e){return e==="utf-16le"?2:1}}const W_=new TextDecoder("ascii");class lr{constructor(){this.tokenizer=void 0,this.id3Header=void 0,this.metadata=void 0,this.headerType=void 0,this.options=void 0}static removeUnsyncBytes(e){let n=0,r=0;for(;n<e.length-1;)n!==r&&(e[r]=e[n]),n+=e[n]===255&&e[n+1]===0?2:1,r++;return n<e.length&&(e[r++]=e[n]),e.slice(0,r)}static getFrameHeaderLength(e){switch(e){case 2:return 6;case 3:case 4:return 10;default:throw new Error("header versionIndex is incorrect")}}static readFrameFlags(e){return{status:{tag_alter_preservation:Qe(e,0,6),file_alter_preservation:Qe(e,0,5),read_only:Qe(e,0,4)},format:{grouping_identity:Qe(e,1,7),compression:Qe(e,1,3),encryption:Qe(e,1,2),unsynchronisation:Qe(e,1,1),data_length_indicator:Qe(e,1,0)}}}static readFrameData(e,n,r,i,s){var a,l;const o=new En(r,s);switch(r){case 2:return o.readData(e,n.id,i);case 3:case 4:return(a=n.flags)!=null&&a.format.unsynchronisation&&(e=lr.removeUnsyncBytes(e)),(l=n.flags)!=null&&l.format.data_length_indicator&&(e=e.slice(4,e.length)),o.readData(e,n.id,i);default:throw new Error(`Unexpected majorVer: ${r}`)}}static makeDescriptionTagName(e,n){return e+(n?`:${n}`:"")}async parse(e,n,r){this.tokenizer=n,this.metadata=e,this.options=r;const i=await this.tokenizer.readToken(O0);if(i.fileIdentifier!=="ID3")throw new Error("expected ID3-header file-identifier 'ID3' was not found");return this.id3Header=i,this.headerType=`ID3v2.${i.version.major}`,i.flags.isExtendedHeader?this.parseExtendedHeader():this.parseId3Data(i.size)}async parseExtendedHeader(){const e=await this.tokenizer.readToken(M_),n=e.size-M_.len;return n>0?this.parseExtendedHeaderData(n,e.size):this.parseId3Data(this.id3Header.size-e.size)}async parseExtendedHeaderData(e,n){return await this.tokenizer.ignore(e),this.parseId3Data(this.id3Header.size-n)}async parseId3Data(e){const n=await this.tokenizer.readToken(new cn(e));for(const r of this.parseMetadata(n))switch(r.id){case"TXXX":r.value&&await this.handleTag(r,r.value.text,()=>r.value.description);break;default:await(Array.isArray(r.value)?Promise.all(r.value.map(i=>this.addTag(r.id,i))):this.addTag(r.id,r.value))}}async handleTag(e,n,r,i=s=>s){await Promise.all(n.map(s=>this.addTag(lr.makeDescriptionTagName(e.id,r(s)),i(s))))}async addTag(e,n){await this.metadata.addTag(this.headerType,e,n)}parseMetadata(e){let n=0;const r=[];for(;n!==e.length;){const i=lr.getFrameHeaderLength(this.id3Header.version.major);if(n+i>e.length){this.metadata.addWarning("Illegal ID3v2 tag length");break}const s=e.slice(n,n+i);n+=i;const o=this.readFrameHeader(s,this.id3Header.version.major),a=e.slice(n,n+o.length);n+=o.length;const l=lr.readFrameData(a,o,this.id3Header.version.major,!this.options.skipCovers,this.metadata);l&&r.push({id:o.id,value:l})}return r}readFrameHeader(e,n){let r;switch(n){case 2:r={id:W_.decode(e.slice(0,3)),length:sn.get(e,3)},r.id.match(/[A-Z0-9]{3}/g)||this.metadata.addWarning(`Invalid ID3v2.${this.id3Header.version.major} frame-header-ID: ${r.id}`);break;case 3:case 4:r={id:W_.decode(e.slice(0,4)),length:(n===4?FT:re).get(e,4),flags:lr.readFrameFlags(e.slice(8,10))},r.id.match(/[A-Z0-9]{4}/g)||this.metadata.addWarning(`Invalid ID3v2.${this.id3Header.version.major} frame-header-ID: ${r.id}`);break;default:throw new Error(`Unexpected majorVer: ${n}`)}return r}}const GM={NONE:"not compressed	PCM	Apple Computer",sowt:"PCM (byte swapped)",fl32:"32-bit floating point IEEE 32-bit float",fl64:"64-bit floating point IEEE 64-bit float	Apple Computer",alaw:"ALaw 2:1	8-bit ITU-T G.711 A-law",ulaw:"µLaw 2:1	8-bit ITU-T G.711 µ-law	Apple Computer",ULAW:"CCITT G.711 u-law 8-bit ITU-T G.711 µ-law",ALAW:"CCITT G.711 A-law 8-bit ITU-T G.711 A-law",FL32:"Float 32	IEEE 32-bit float "};class KM{constructor(e,n){this.isAifc=n;const r=n?22:18;if(e.chunkSize<r)throw new Error(`COMMON CHUNK size should always be at least ${r}`);this.len=e.chunkSize}get(e,n){const r=Re.get(e,n+8)-16398,i=Re.get(e,n+8+2),s={numChannels:Re.get(e,n),numSampleFrames:re.get(e,n+2),sampleSize:Re.get(e,n+6),sampleRate:r<0?i>>Math.abs(r):i<<r};if(this.isAifc){if(s.compressionType=Ve.get(e,n+18),this.len>22){const o=he.get(e,n+22);if(o>0){const a=(o+1)%2;if(23+o+a===this.len)s.compressionName=new ne(o,"latin1").get(e,n+23);else throw new Error("Illegal pstring length")}else s.compressionName=void 0}}else s.compressionName="PCM";return s}}const Dp={len:8,get:(t,e)=>({chunkID:Ve.get(t,e),chunkSize:Number(BigInt(re.get(t,e+4)))})},jp=Ne("music-metadata:parser:aiff");class XM extends Bn{constructor(){super(...arguments),this.isCompressed=null}async parse(){if((await this.tokenizer.readToken(Dp)).chunkID!=="FORM")throw new Error("Invalid Chunk-ID, expected 'FORM'");const n=await this.tokenizer.readToken(Ve);switch(n){case"AIFF":this.metadata.setFormat("container",n),this.isCompressed=!1;break;case"AIFC":this.metadata.setFormat("container","AIFF-C"),this.isCompressed=!0;break;default:throw new Error(`Unsupported AIFF type: ${n}`)}this.metadata.setFormat("lossless",!this.isCompressed);try{for(;!this.tokenizer.fileInfo.size||this.tokenizer.fileInfo.size-this.tokenizer.position>=Dp.len;){jp(`Reading AIFF chunk at offset=${this.tokenizer.position}`);const r=await this.tokenizer.readToken(Dp),i=2*Math.round(r.chunkSize/2),s=await this.readData(r);await this.tokenizer.ignore(i-s)}}catch(r){if(r instanceof it)jp("End-of-stream");else throw r}}async readData(e){switch(e.chunkID){case"COMM":{if(this.isCompressed===null)throw new Error("Failed to parse AIFF.COMM chunk when compression type is unknown");const n=await this.tokenizer.readToken(new KM(e,this.isCompressed));return this.metadata.setFormat("bitsPerSample",n.sampleSize),this.metadata.setFormat("sampleRate",n.sampleRate),this.metadata.setFormat("numberOfChannels",n.numChannels),this.metadata.setFormat("numberOfSamples",n.numSampleFrames),this.metadata.setFormat("duration",n.numSampleFrames/n.sampleRate),(n.compressionName||n.compressionType)&&this.metadata.setFormat("codec",n.compressionName??GM[n.compressionType]),e.chunkSize}case"ID3 ":{const n=await this.tokenizer.readToken(new cn(e.chunkSize)),r=Ta(n);return await new lr().parse(this.metadata,r,this.options),e.chunkSize}case"SSND":return this.metadata.format.duration&&this.metadata.setFormat("bitrate",8*e.chunkSize/this.metadata.format.duration),0;case"NAME":case"AUTH":case"(c) ":case"ANNO":return this.readTextChunk(e);default:return jp(`Ignore chunk id=${e.chunkID}, size=${e.chunkSize}`),0}}async readTextChunk(e){const r=(await this.tokenizer.readToken(new ne(e.chunkSize,"ascii"))).split("\0").map(i=>i.trim()).filter(i=>i==null?void 0:i.length);return await Promise.all(r.map(i=>this.metadata.addTag("AIFF",e.chunkID,i))),e.chunkSize}}class C{static fromBin(e,n=0){return new C(C.decode(e,n))}static decode(e,n=0){const r=new DataView(e.buffer,n);return`${r.getUint32(0,!0).toString(16)}-${r.getUint16(4,!0).toString(16)}-${r.getUint16(6,!0).toString(16)}-${r.getUint16(8).toString(16)}-${Yv(e.slice(n+10,n+16))}`.toUpperCase()}static decodeMediaType(e){switch(e.str){case C.AudioMedia.str:return"audio";case C.VideoMedia.str:return"video";case C.CommandMedia.str:return"command";case C.Degradable_JPEG_Media.str:return"degradable-jpeg";case C.FileTransferMedia.str:return"file-transfer";case C.BinaryMedia.str:return"binary"}}static encode(e){const n=new Uint8Array(16),r=new DataView(n.buffer);return r.setUint32(0,Number.parseInt(e.slice(0,8),16),!0),r.setUint16(4,Number.parseInt(e.slice(9,13),16),!0),r.setUint16(6,Number.parseInt(e.slice(14,18),16),!0),n.set(A_(e.slice(19,23)),8),n.set(A_(e.slice(24)),10),n}constructor(e){this.str=e}equals(e){return this.str===e.str}toBin(){return C.encode(this.str)}}C.HeaderObject=new C("75B22630-668E-11CF-A6D9-00AA0062CE6C");C.DataObject=new C("75B22636-668E-11CF-A6D9-00AA0062CE6C");C.SimpleIndexObject=new C("33000890-E5B1-11CF-89F4-00A0C90349CB");C.IndexObject=new C("D6E229D3-35DA-11D1-9034-00A0C90349BE");C.MediaObjectIndexObject=new C("FEB103F8-12AD-4C64-840F-2A1D2F7AD48C");C.TimecodeIndexObject=new C("3CB73FD0-0C4A-4803-953D-EDF7B6228F0C");C.FilePropertiesObject=new C("8CABDCA1-A947-11CF-8EE4-00C00C205365");C.StreamPropertiesObject=new C("B7DC0791-A9B7-11CF-8EE6-00C00C205365");C.HeaderExtensionObject=new C("5FBF03B5-A92E-11CF-8EE3-00C00C205365");C.CodecListObject=new C("86D15240-311D-11D0-A3A4-00A0C90348F6");C.ScriptCommandObject=new C("1EFB1A30-0B62-11D0-A39B-00A0C90348F6");C.MarkerObject=new C("F487CD01-A951-11CF-8EE6-00C00C205365");C.BitrateMutualExclusionObject=new C("D6E229DC-35DA-11D1-9034-00A0C90349BE");C.ErrorCorrectionObject=new C("75B22635-668E-11CF-A6D9-00AA0062CE6C");C.ContentDescriptionObject=new C("75B22633-668E-11CF-A6D9-00AA0062CE6C");C.ExtendedContentDescriptionObject=new C("D2D0A440-E307-11D2-97F0-00A0C95EA850");C.ContentBrandingObject=new C("2211B3FA-BD23-11D2-B4B7-00A0C955FC6E");C.StreamBitratePropertiesObject=new C("7BF875CE-468D-11D1-8D82-006097C9A2B2");C.ContentEncryptionObject=new C("2211B3FB-BD23-11D2-B4B7-00A0C955FC6E");C.ExtendedContentEncryptionObject=new C("298AE614-2622-4C17-B935-DAE07EE9289C");C.DigitalSignatureObject=new C("2211B3FC-BD23-11D2-B4B7-00A0C955FC6E");C.PaddingObject=new C("1806D474-CADF-4509-A4BA-9AABCB96AAE8");C.ExtendedStreamPropertiesObject=new C("14E6A5CB-C672-4332-8399-A96952065B5A");C.AdvancedMutualExclusionObject=new C("A08649CF-4775-4670-8A16-6E35357566CD");C.GroupMutualExclusionObject=new C("D1465A40-5A79-4338-B71B-E36B8FD6C249");C.StreamPrioritizationObject=new C("D4FED15B-88D3-454F-81F0-ED5C45999E24");C.BandwidthSharingObject=new C("A69609E6-517B-11D2-B6AF-00C04FD908E9");C.LanguageListObject=new C("7C4346A9-EFE0-4BFC-B229-393EDE415C85");C.MetadataObject=new C("C5F8CBEA-5BAF-4877-8467-AA8C44FA4CCA");C.MetadataLibraryObject=new C("44231C94-9498-49D1-A141-1D134E457054");C.IndexParametersObject=new C("D6E229DF-35DA-11D1-9034-00A0C90349BE");C.MediaObjectIndexParametersObject=new C("6B203BAD-3F11-48E4-ACA8-D7613DE2CFA7");C.TimecodeIndexParametersObject=new C("F55E496D-9797-4B5D-8C8B-604DFE9BFB24");C.CompatibilityObject=new C("26F18B5D-4584-47EC-9F5F-0E651F0452C9");C.AdvancedContentEncryptionObject=new C("43058533-6981-49E6-9B74-AD12CB86D58C");C.AudioMedia=new C("F8699E40-5B4D-11CF-A8FD-00805F5C442B");C.VideoMedia=new C("BC19EFC0-5B4D-11CF-A8FD-00805F5C442B");C.CommandMedia=new C("59DACFC0-59E6-11D0-A3AC-00A0C90348F6");C.JFIF_Media=new C("B61BE100-5B4E-11CF-A8FD-00805F5C442B");C.Degradable_JPEG_Media=new C("35907DE0-E415-11CF-A917-00805F5C442B");C.FileTransferMedia=new C("91BD222C-F21C-497A-8B6D-5AA86BFC0185");C.BinaryMedia=new C("3AFB65E2-47EF-40F2-AC2C-70A90D71D343");C.ASF_Index_Placeholder_Object=new C("D9AADE20-7C17-4F9C-BC28-8555DD98E2A2");function QM(t){return YM[t]}function Lf(t){return Pi(pt(t,"utf-16le"))}const YM=[Lf,H_,JM,ZM,e6,BT,H_];function H_(t){return new Uint8Array(t)}function JM(t,e=0){return BT(t,e)===1}function ZM(t,e=0){return J.get(t,e)}function e6(t,e=0){return en.get(t,e)}function BT(t,e=0){return ke.get(t,e)}var q_;(function(t){t[t.UnicodeString=0]="UnicodeString",t[t.ByteArray=1]="ByteArray",t[t.Bool=2]="Bool",t[t.DWord=3]="DWord",t[t.QWord=4]="QWord",t[t.Word=5]="Word"})(q_||(q_={}));const t6={len:30,get:(t,e)=>({objectId:C.fromBin(t,e),objectSize:Number(en.get(t,e+16)),numberOfHeaderObjects:J.get(t,e+24)})},Cs={len:24,get:(t,e)=>({objectId:C.fromBin(t,e),objectSize:Number(en.get(t,e+16))})};class wo{constructor(e){this.len=Number(e.objectSize)-Cs.len}postProcessTag(e,n,r,i){if(n==="WM/Picture")e.push({id:n,value:nx.fromBuffer(i)});else{const s=QM(r);if(!s)throw new Error(`unexpected value headerType: ${r}`);e.push({id:n,value:s(i)})}}}class G_ extends wo{get(e,n){return null}}class L0 extends wo{get(e,n){return{fileId:C.fromBin(e,n),fileSize:en.get(e,n+16),creationDate:en.get(e,n+24),dataPacketsCount:en.get(e,n+32),playDuration:en.get(e,n+40),sendDuration:en.get(e,n+48),preroll:en.get(e,n+56),flags:{broadcast:Qe(e,n+64,24),seekable:Qe(e,n+64,25)},minimumDataPacketSize:J.get(e,n+68),maximumDataPacketSize:J.get(e,n+72),maximumBitrate:J.get(e,n+76)}}}L0.guid=C.FilePropertiesObject;class F0 extends wo{get(e,n){return{streamType:C.decodeMediaType(C.fromBin(e,n)),errorCorrectionType:C.fromBin(e,n+8)}}}F0.guid=C.StreamPropertiesObject;class $0{constructor(){this.len=22}get(e,n){const r=new DataView(e.buffer,n);return{reserved1:C.fromBin(e,n),reserved2:r.getUint16(16,!0),extensionDataSize:r.getUint16(18,!0)}}}$0.guid=C.HeaderExtensionObject;const n6={len:20,get:(t,e)=>({entryCount:new DataView(t.buffer,e).getUint16(16,!0)})};async function K_(t){const e=await t.readNumber(ke);return(await t.readToken(new ne(e*2,"utf-16le"))).replace("\0","")}async function r6(t){const e=await t.readToken(n6),n=[];for(let r=0;r<e.entryCount;++r)n.push(await s6(t));return n}async function i6(t){const e=await t.readNumber(ke),n=new Uint8Array(e);return await t.readBuffer(n),n}async function s6(t){const e=await t.readNumber(ke);return{type:{videoCodec:(e&1)===1,audioCodec:(e&2)===2},codecName:await K_(t),description:await K_(t),information:await i6(t)}}class eo extends wo{get(e,n){const r=[],i=new DataView(e.buffer,n);let s=10;for(let o=0;o<eo.contentDescTags.length;++o){const a=i.getUint16(o*2,!0);if(a>0){const l=eo.contentDescTags[o],c=s+a;r.push({id:l,value:Lf(e.slice(n+s,n+c))}),s=c}}return r}}eo.guid=C.ContentDescriptionObject;eo.contentDescTags=["Title","Author","Copyright","Description","Rating"];class z0 extends wo{get(e,n){const r=[],i=new DataView(e.buffer,n),s=i.getUint16(0,!0);let o=2;for(let a=0;a<s;a+=1){const l=i.getUint16(o,!0);o+=2;const c=Lf(e.slice(n+o,n+o+l));o+=l;const d=i.getUint16(o,!0);o+=2;const h=i.getUint16(o,!0);o+=2;const m=e.slice(n+o,n+o+h);o+=h,this.postProcessTag(r,c,d,m)}return r}}z0.guid=C.ExtendedContentDescriptionObject;class B0 extends wo{get(e,n){const r=new DataView(e.buffer,n);return{startTime:en.get(e,n),endTime:en.get(e,n+8),dataBitrate:r.getInt32(12,!0),bufferSize:r.getInt32(16,!0),initialBufferFullness:r.getInt32(20,!0),alternateDataBitrate:r.getInt32(24,!0),alternateBufferSize:r.getInt32(28,!0),alternateInitialBufferFullness:r.getInt32(32,!0),maximumObjectSize:r.getInt32(36,!0),flags:{reliableFlag:Qe(e,n+40,0),seekableFlag:Qe(e,n+40,1),resendLiveCleanpointsFlag:Qe(e,n+40,2)},streamNumber:r.getInt16(42,!0),streamLanguageId:r.getInt16(44,!0),averageTimePerFrame:r.getInt32(52,!0),streamNameCount:r.getInt32(54,!0),payloadExtensionSystems:r.getInt32(56,!0),streamNames:[],streamPropertiesObject:null}}}B0.guid=C.ExtendedStreamPropertiesObject;class bh extends wo{get(e,n){const r=[],i=new DataView(e.buffer,n),s=i.getUint16(0,!0);let o=2;for(let a=0;a<s;a+=1){o+=4;const l=i.getUint16(o,!0);o+=2;const c=i.getUint16(o,!0);o+=2;const d=i.getUint32(o,!0);o+=4;const h=Lf(e.slice(n+o,n+o+l));o+=l;const m=e.slice(n+o,n+o+d);o+=d,this.postProcessTag(r,h,c,m)}return r}}bh.guid=C.MetadataObject;class V0 extends bh{}V0.guid=C.MetadataLibraryObject;class nx{static fromBuffer(e){return new nx(e.length).get(e,0)}constructor(e){this.len=e}get(e,n){const r=new DataView(e.buffer,n),i=r.getUint8(0),s=r.getInt32(1,!0);let o=5;for(;r.getUint16(o)!==0;)o+=2;const a=new ne(o-5,"utf-16le").get(e,5);for(;r.getUint16(o)!==0;)o+=2;const l=new ne(o-5,"utf-16le").get(e,5);return{type:_c[i],format:a,description:l,size:s,data:e.slice(o+4)}}}const Ju=Ne("music-metadata:parser:ASF"),o6="asf";class a6 extends Bn{async parse(){const e=await this.tokenizer.readToken(t6);if(!e.objectId.equals(C.HeaderObject))throw new Error(`expected asf header; but was not found; got: ${e.objectId.str}`);try{await this.parseObjectHeader(e.numberOfHeaderObjects)}catch(n){Ju("Error while parsing ASF: %s",n)}}async parseObjectHeader(e){let n;do{const r=await this.tokenizer.readToken(Cs);switch(Ju("header GUID=%s",r.objectId.str),r.objectId.str){case L0.guid.str:{const i=await this.tokenizer.readToken(new L0(r));this.metadata.setFormat("duration",Number(i.playDuration/BigInt(1e3))/1e4-Number(i.preroll)/1e3),this.metadata.setFormat("bitrate",i.maximumBitrate);break}case F0.guid.str:{const i=await this.tokenizer.readToken(new F0(r));this.metadata.setFormat("container",`ASF/${i.streamType}`);break}case $0.guid.str:{const i=await this.tokenizer.readToken(new $0);await this.parseExtensionObject(i.extensionDataSize);break}case eo.guid.str:n=await this.tokenizer.readToken(new eo(r)),await this.addTags(n);break;case z0.guid.str:n=await this.tokenizer.readToken(new z0(r)),await this.addTags(n);break;case C.CodecListObject.str:{const i=await r6(this.tokenizer);i.forEach(o=>{this.metadata.addStreamInfo({type:o.type.videoCodec?Zs.video:Zs.audio,codecName:o.codecName})});const s=i.filter(o=>o.type.audioCodec).map(o=>o.codecName).join("/");this.metadata.setFormat("codec",s);break}case C.StreamBitratePropertiesObject.str:await this.tokenizer.ignore(r.objectSize-Cs.len);break;case C.PaddingObject.str:Ju("Padding: %s bytes",r.objectSize-Cs.len),await this.tokenizer.ignore(r.objectSize-Cs.len);break;default:this.metadata.addWarning(`Ignore ASF-Object-GUID: ${r.objectId.str}`),Ju("Ignore ASF-Object-GUID: %s",r.objectId.str),await this.tokenizer.readToken(new G_(r))}}while(--e)}async addTags(e){await Promise.all(e.map(({id:n,value:r})=>this.metadata.addTag(o6,n,r)))}async parseExtensionObject(e){do{const n=await this.tokenizer.readToken(Cs),r=n.objectSize-Cs.len;switch(n.objectId.str){case B0.guid.str:await this.tokenizer.readToken(new B0(n));break;case bh.guid.str:{const i=await this.tokenizer.readToken(new bh(n));await this.addTags(i);break}case V0.guid.str:{const i=await this.tokenizer.readToken(new V0(n));await this.addTags(i);break}case C.PaddingObject.str:await this.tokenizer.ignore(r);break;case C.CompatibilityObject.str:this.tokenizer.ignore(r);break;case C.ASF_Index_Placeholder_Object.str:await this.tokenizer.ignore(r);break;default:this.metadata.addWarning(`Ignore ASF-Object-GUID: ${n.objectId.str}`),await this.tokenizer.readToken(new G_(n));break}e-=n.objectSize}while(e>0)}}class Ec{static fromBase64(e){return Ec.fromBuffer(Uint8Array.from(atob(e),n=>n.charCodeAt(0)))}static fromBuffer(e){return new Ec(e.length).get(e,0)}constructor(e){this.len=e}get(e,n){const r=_c[re.get(e,n)];n+=4;const i=re.get(e,n);n+=4;const s=new ne(i,"utf-8").get(e,n);n+=i;const o=re.get(e,n);n+=4;const a=new ne(o,"utf-8").get(e,n);n+=o;const l=re.get(e,n);n+=4;const c=re.get(e,n);n+=4;const d=re.get(e,n);n+=4;const h=re.get(e,n);n+=4;const m=re.get(e,n);n+=4;const p=Uint8Array.from(e.slice(n,n+m));return{type:r,format:s,description:a,width:l,height:c,colour_depth:d,indexed_color:h,data:p}}}const Zu={len:7,get:(t,e)=>({packetType:he.get(t,e),vorbis:new ne(6,"ascii").get(t,e+1)})},l6={len:23,get:(t,e)=>({version:J.get(t,e+0),channelMode:he.get(t,e+4),sampleRate:J.get(t,e+5),bitrateMax:J.get(t,e+9),bitrateNominal:J.get(t,e+13),bitrateMin:J.get(t,e+17)})},Op=Ne("music-metadata:parser:ID3");class Ff extends Bn{constructor(){super(...arguments),this.id3parser=new lr}static async startsWithID3v2Header(e){return(await e.peekToken(O0)).fileIdentifier==="ID3"}async parse(){try{await this.parseID3v2()}catch(e){if(e instanceof it)Op("End-of-stream");else throw e}}finalize(){}async parseID3v2(){await this.tryReadId3v2Headers(),Op("End of ID3v2 header, go to MPEG-parser: pos=%s",this.tokenizer.position),await this.postId3v2Parse(),this.options.skipPostHeaders&&this.metadata.hasAny()?this.finalize():(await new tx().init(this.metadata,this.tokenizer,this.options).parse(),this.finalize())}async tryReadId3v2Headers(){if((await this.tokenizer.peekToken(O0)).fileIdentifier==="ID3")return Op("Found ID3v2 header, pos=%s",this.tokenizer.position),await this.id3parser.parse(this.metadata,this.tokenizer,this.options),this.tryReadId3v2Headers()}}class VT{constructor(e,n){this.data=e,this.offset=n}readInt32(){const e=J.get(this.data,this.offset);return this.offset+=4,e}readStringUtf8(){const e=this.readInt32(),n=new TextDecoder("utf-8").decode(this.data.subarray(this.offset,this.offset+e));return this.offset+=e,n}parseUserComment(){const e=this.offset,n=this.readStringUtf8(),r=n.indexOf("=");return{key:n.slice(0,r).toUpperCase(),value:n.slice(r+1),len:this.offset-e}}}const No=Ne("music-metadata:parser:ogg:vorbis1");class to{constructor(e,n){this.metadata=e,this.options=n,this.pageSegments=[]}async parsePage(e,n){if(e.headerType.firstPage)this.parseFirstPage(e,n);else{if(e.headerType.continued){if(this.pageSegments.length===0)throw new Error("Cannot continue on previous page");this.pageSegments.push(n)}if(e.headerType.lastPage||!e.headerType.continued){if(this.pageSegments.length>0){const r=to.mergeUint8Arrays(this.pageSegments);await this.parseFullPage(r)}this.pageSegments=e.headerType.lastPage?[]:[n]}}e.headerType.lastPage&&this.calculateDuration(e)}static mergeUint8Arrays(e){const n=e.reduce((i,s)=>i+s.length,0),r=new Uint8Array(n);return e.forEach((i,s,o)=>{const a=o.slice(0,s).reduce((l,c)=>l+c.length,0);r.set(i,a)}),r}async flush(){await this.parseFullPage(to.mergeUint8Arrays(this.pageSegments))}async parseUserComment(e,n){const i=new VT(e,n).parseUserComment();return await this.addTag(i.key,i.value),i.len}async addTag(e,n){if(e==="METADATA_BLOCK_PICTURE"&&typeof n=="string"){if(this.options.skipCovers){No("Ignore picture");return}n=Ec.fromBase64(n),No(`Push picture: id=${e}, format=${n.format}`)}else No(`Push tag: id=${e}, value=${n}`);await this.metadata.addTag("vorbis",e,n)}calculateDuration(e){this.metadata.format.sampleRate&&e.absoluteGranulePosition>=0&&(this.metadata.setFormat("numberOfSamples",e.absoluteGranulePosition),this.metadata.setFormat("duration",e.absoluteGranulePosition/this.metadata.format.sampleRate))}parseFirstPage(e,n){this.metadata.setFormat("codec","Vorbis I"),No("Parse first page");const r=Zu.get(n,0);if(r.vorbis!=="vorbis")throw new Error("Metadata does not look like Vorbis");if(r.packetType===1){const i=l6.get(n,Zu.len);this.metadata.setFormat("sampleRate",i.sampleRate),this.metadata.setFormat("bitrate",i.bitrateNominal),this.metadata.setFormat("numberOfChannels",i.channelMode),No("sample-rate=%s[hz], bitrate=%s[b/s], channel-mode=%s",i.sampleRate,i.bitrateNominal,i.channelMode)}else throw new Error("First Ogg page should be type 1: the identification header")}async parseFullPage(e){const n=Zu.get(e,0);switch(No("Parse full page: type=%s, byteLength=%s",n.packetType,e.byteLength),n.packetType){case 3:return this.parseUserCommentList(e,Zu.len)}}async parseUserCommentList(e,n){const r=J.get(e,n);n+=4,n+=r;let i=J.get(e,n);for(n+=4;i-- >0;)n+=await this.parseUserComment(e,n)}}const c6=Ne("music-metadata:parser:FLAC");var Kr;(function(t){t[t.STREAMINFO=0]="STREAMINFO",t[t.PADDING=1]="PADDING",t[t.APPLICATION=2]="APPLICATION",t[t.SEEKTABLE=3]="SEEKTABLE",t[t.VORBIS_COMMENT=4]="VORBIS_COMMENT",t[t.CUESHEET=5]="CUESHEET",t[t.PICTURE=6]="PICTURE"})(Kr||(Kr={}));class u6 extends Ff{constructor(){super(...arguments),this.padding=0}init(e,n,r){return super.init(e,n,r),this.vorbisParser=new to(e,r),this}async postId3v2Parse(){if((await this.tokenizer.readToken(Ve)).toString()!=="fLaC")throw new Error("Invalid FLAC preamble");let n;do n=await this.tokenizer.readToken(d6),await this.parseDataBlock(n);while(!n.lastBlock);if(this.tokenizer.fileInfo.size&&this.metadata.format.duration){const r=this.tokenizer.fileInfo.size-this.tokenizer.position;this.metadata.setFormat("bitrate",8*r/this.metadata.format.duration)}}async parseDataBlock(e){switch(c6(`blockHeader type=${e.type}, length=${e.length}`),e.type){case Kr.STREAMINFO:return this.parseBlockStreamInfo(e.length);case Kr.PADDING:this.padding+=e.length;break;case Kr.APPLICATION:break;case Kr.SEEKTABLE:break;case Kr.VORBIS_COMMENT:return this.parseComment(e.length);case Kr.CUESHEET:break;case Kr.PICTURE:await this.parsePicture(e.length);return;default:this.metadata.addWarning(`Unknown block type: ${e.type}`)}return this.tokenizer.ignore(e.length).then()}async parseBlockStreamInfo(e){if(e!==X_.len)throw new Error("Unexpected block-stream-info length");const n=await this.tokenizer.readToken(X_);this.metadata.setFormat("container","FLAC"),this.metadata.setFormat("codec","FLAC"),this.metadata.setFormat("lossless",!0),this.metadata.setFormat("numberOfChannels",n.channels),this.metadata.setFormat("bitsPerSample",n.bitsPerSample),this.metadata.setFormat("sampleRate",n.sampleRate),n.totalSamples>0&&this.metadata.setFormat("duration",n.totalSamples/n.sampleRate)}async parseComment(e){const n=await this.tokenizer.readToken(new cn(e)),r=new VT(n,0);r.readStringUtf8();const i=r.readInt32(),s=new Array(i);for(let o=0;o<i;o++)s[o]=r.parseUserComment();await Promise.all(s.map(o=>this.vorbisParser.addTag(o.key,o.value)))}async parsePicture(e){if(this.options.skipCovers)return this.tokenizer.ignore(e);const n=await this.tokenizer.readToken(new Ec(e));this.vorbisParser.addTag("METADATA_BLOCK_PICTURE",n)}}const d6={len:4,get:(t,e)=>({lastBlock:Qe(t,e,7),type:ye(t,e,1,7),length:sn.get(t,e+1)})},X_={len:34,get:(t,e)=>({minimumBlockSize:Re.get(t,e),maximumBlockSize:Re.get(t,e+2)/1e3,minimumFrameSize:sn.get(t,e+4),maximumFrameSize:sn.get(t,e+7),sampleRate:sn.get(t,e+10)>>4,channels:ye(t,e+12,4,3)+1,bitsPerSample:ye(t,e+12,7,5)+1,totalSamples:ye(t,e+13,4,36),fileMD5:new cn(16).get(t,e+18)})},UT=Ne("music-metadata:parser:MP4:atom"),kh={len:8,get:(t,e)=>{const n=re.get(t,e);if(n<0)throw new Error("Invalid atom header length");return{length:BigInt(n),name:new ne(4,"latin1").get(t,e+4)}},put:(t,e,n)=>(re.put(t,e,Number(n.length)),Ve.put(t,e+4,n.name))},h6=Xv,Q_={len:4,get:(t,e)=>({type:new ne(4,"ascii").get(t,e)})};class WT{constructor(e,n,r){if(this.len=e,e<n)throw new Error(`Atom ${r} expected to be ${n}, but specifies ${e} bytes long.`);e>n&&UT(`Warning: atom ${r} expected to be ${n}, but was actually ${e} bytes long.`)}}const Ia={len:4,get:(t,e)=>{const n=re.get(t,e)-2082844800;return new Date(n*1e3)}};class f6 extends WT{constructor(e){super(e,24,"mdhd"),this.len=e}get(e,n){return{version:he.get(e,n+0),flags:sn.get(e,n+1),creationTime:Ia.get(e,n+4),modificationTime:Ia.get(e,n+8),timeScale:re.get(e,n+12),duration:re.get(e,n+16),language:Re.get(e,n+20),quality:Re.get(e,n+22)}}}class m6 extends WT{constructor(e){super(e,100,"mvhd"),this.len=e}get(e,n){return{version:he.get(e,n),flags:sn.get(e,n+1),creationTime:Ia.get(e,n+4),modificationTime:Ia.get(e,n+8),timeScale:re.get(e,n+12),duration:re.get(e,n+16),preferredRate:re.get(e,n+20),preferredVolume:Re.get(e,n+24),previewTime:re.get(e,n+72),previewDuration:re.get(e,n+76),posterTime:re.get(e,n+80),selectionTime:re.get(e,n+84),selectionDuration:re.get(e,n+88),currentTime:re.get(e,n+92),nextTrackID:re.get(e,n+96)}}}class p6{constructor(e){this.len=e}get(e,n){return{type:{set:he.get(e,n+0),type:sn.get(e,n+1)},locale:sn.get(e,n+4),value:new cn(this.len-8).get(e,n+8)}}}class g6{constructor(e){this.len=e}get(e,n){return{version:he.get(e,n),flags:sn.get(e,n+1),name:new ne(this.len-4,"utf-8").get(e,n+4)}}}class y6{constructor(e){this.len=e}get(e,n){return{version:he.get(e,n),flags:sn.get(e,n+1),creationTime:Ia.get(e,n+4),modificationTime:Ia.get(e,n+8),trackId:re.get(e,n+12),duration:re.get(e,n+20),layer:Re.get(e,n+24),alternateGroup:Re.get(e,n+26),volume:Re.get(e,n+28)}}}const Y_={len:8,get:(t,e)=>({version:he.get(t,e),flags:sn.get(t,e+1),numberOfEntries:re.get(t,e+4)})};class v6{constructor(e){this.len=e}get(e,n){return{dataFormat:Ve.get(e,n),dataReferenceIndex:Re.get(e,n+10),description:new cn(this.len-12).get(e,n+12)}}}class x6{constructor(e){this.len=e}get(e,n){const r=Y_.get(e,n);n+=Y_.len;const i=[];for(let s=0;s<r.numberOfEntries;++s){const o=re.get(e,n);n+=re.len,i.push(new v6(o).get(e,n)),n+=o}return{header:r,table:i}}}const J_={len:8,get(t,e){return{version:Jr.get(t,e),revision:Jr.get(t,e+2),vendor:Pn.get(t,e+4)}}},w6={len:12,get(t,e){return{numAudioChannels:Jr.get(t,e+0),sampleSize:Jr.get(t,e+2),compressionId:Jr.get(t,e+4),packetSize:Jr.get(t,e+6),sampleRate:Re.get(t,e+8)+Re.get(t,e+10)/1e4}}};class rx{constructor(e,n){this.len=e,this.token=n}get(e,n){const r=Pn.get(e,n+4);return{version:wc.get(e,n+0),flags:Kv.get(e,n+1),numberOfEntries:r,entries:HT(e,this.token,n+8,this.len-8,r)}}}const _6={len:8,get(t,e){return{count:Pn.get(t,e+0),duration:Pn.get(t,e+4)}}};class E6 extends rx{constructor(e){super(e,_6),this.len=e}}const S6={len:12,get(t,e){return{firstChunk:Pn.get(t,e),samplesPerChunk:Pn.get(t,e+4),sampleDescriptionId:Pn.get(t,e+8)}}};class b6 extends rx{constructor(e){super(e,S6),this.len=e}}class k6{constructor(e){this.len=e}get(e,n){const r=Pn.get(e,n+8);return{version:wc.get(e,n),flags:Kv.get(e,n+1),sampleSize:Pn.get(e,n+4),numberOfEntries:r,entries:HT(e,Pn,n+12,this.len-12,r)}}}class T6 extends rx{constructor(e){super(e,Pn),this.len=e}}class I6{constructor(e){this.len=e}get(e,n){const r=Jr.get(e,n+0);return new ne(r,"utf-8").get(e,n+2)}}function HT(t,e,n,r,i){if(UT(`remainingLen=${r}, numberOfEntries=${i} * token-len=${e.len}`),r===0)return[];if(r!==i*e.len)throw new Error("mismatch number-of-entries with remaining atom-length");const s=[];for(let o=0;o<i;++o)s.push(e.get(t,n)),n+=e.len;return s}const C6=Ne("music-metadata:parser:MP4:Atom");class Th{static async readAtom(e,n,r,i){const s=e.position,o=await e.readToken(kh);o.length===BigInt(1)&&(o.length=await e.readToken(h6));const l=new Th(o,o.length===BigInt(1),r),c=l.getPayloadLength(i);return C6(`parse atom name=${l.atomPath}, extended=${l.extended}, offset=${s}, len=${l.header.length}`),await l.readData(e,n,c),l}constructor(e,n,r){this.header=e,this.extended=n,this.parent=r,this.children=[],this.atomPath=(this.parent?`${this.parent.atomPath}.`:"")+this.header.name}getHeaderLength(){return this.extended?16:8}getPayloadLength(e){return(this.header.length===BigInt(0)?e:Number(this.header.length))-this.getHeaderLength()}async readAtoms(e,n,r){for(;r>0;){const i=await Th.readAtom(e,n,this,r);this.children.push(i),r-=i.header.length===BigInt(0)?r:Number(i.header.length)}}async readData(e,n,r){switch(this.header.name){case"moov":case"udta":case"trak":case"mdia":case"minf":case"stbl":case"<id>":case"ilst":case"tref":return this.readAtoms(e,n,this.getPayloadLength(r));case"meta":{const s=(await e.peekToken(kh)).name==="hdlr"?0:4;return await e.ignore(s),this.readAtoms(e,n,this.getPayloadLength(r)-s)}default:return n(this,r)}}}const xr=Ne("music-metadata:parser:MP4"),A6="iTunes",Z_={raw:{lossy:!1,format:"raw"},MAC3:{lossy:!0,format:"MACE 3:1"},MAC6:{lossy:!0,format:"MACE 6:1"},ima4:{lossy:!0,format:"IMA 4:1"},ulaw:{lossy:!0,format:"uLaw 2:1"},alaw:{lossy:!0,format:"uLaw 2:1"},Qclp:{lossy:!0,format:"QUALCOMM PureVoice"},".mp3":{lossy:!0,format:"MPEG-1 layer 3"},alac:{lossy:!1,format:"ALAC"},"ac-3":{lossy:!0,format:"AC-3"},mp4a:{lossy:!0,format:"MPEG-4/AAC"},mp4s:{lossy:!0,format:"MP4S"},c608:{lossy:!0,format:"CEA-608"},c708:{lossy:!0,format:"CEA-708"}};function eE(t,e,n){return n.indexOf(t)===e}class Ih extends Bn{constructor(){super(...arguments),this.tracks=[],this.atomParsers={mvhd:async e=>{const n=await this.tokenizer.readToken(new m6(e));this.metadata.setFormat("creationTime",n.creationTime),this.metadata.setFormat("modificationTime",n.modificationTime)},mdhd:async e=>{const n=await this.tokenizer.readToken(new f6(e)),r=this.getTrackDescription();r.creationTime=n.creationTime,r.modificationTime=n.modificationTime,r.timeScale=n.timeScale,r.duration=n.duration},chap:async e=>{const n=this.getTrackDescription(),r=[];for(;e>=re.len;)r.push(await this.tokenizer.readNumber(re)),e-=re.len;n.chapterList=r},tkhd:async e=>{const n=await this.tokenizer.readToken(new y6(e));this.tracks.push(n)},mdat:async e=>{if(this.audioLengthInBytes=e,this.calculateBitRate(),this.options.includeChapters){const n=this.tracks.filter(r=>r.chapterList);if(n.length===1){const r=n[0].chapterList,i=this.tracks.filter(s=>r.indexOf(s.trackId)!==-1);if(i.length===1)return this.parseChapterTrack(i[0],n[0],e)}}await this.tokenizer.ignore(e)},ftyp:async e=>{const n=[];for(;e>0;){const i=await this.tokenizer.readToken(Q_);e-=Q_.len;const s=i.type.replace(/\W/g,"");s.length>0&&n.push(s)}xr(`ftyp: ${n.join("/")}`);const r=n.filter(eE).join("/");this.metadata.setFormat("container",r)},stsd:async e=>{const n=await this.tokenizer.readToken(new x6(e)),r=this.getTrackDescription();r.soundSampleDescription=n.table.map(i=>this.parseSoundSampleDescription(i))},stsc:async e=>{const n=await this.tokenizer.readToken(new b6(e));this.getTrackDescription().sampleToChunkTable=n.entries},stts:async e=>{const n=await this.tokenizer.readToken(new E6(e));this.getTrackDescription().timeToSampleTable=n.entries},stsz:async e=>{const n=await this.tokenizer.readToken(new k6(e)),r=this.getTrackDescription();r.sampleSize=n.sampleSize,r.sampleSizeTable=n.entries},stco:async e=>{const n=await this.tokenizer.readToken(new T6(e));this.getTrackDescription().chunkOffsetTable=n.entries},date:async e=>{const n=await this.tokenizer.readToken(new ne(e,"utf-8"));await this.addTag("date",n)}}}static read_BE_Integer(e,n){const r=(n?"INT":"UINT")+e.length*8+(e.length>1?"_BE":""),i=MO[r];if(!i)throw new Error(`Token for integer type not found: "${r}"`);return Number(i.get(e,0))}async parse(){this.tracks=[];let e=this.tokenizer.fileInfo.size||0;for(;!this.tokenizer.fileInfo.size||e>0;){try{if((await this.tokenizer.peekToken(kh)).name==="\0\0\0\0"){const o=`Error at offset=${this.tokenizer.position}: box.id=0`;xr(o),this.addWarning(o);break}}catch(s){if(s instanceof Error){const o=`Error at offset=${this.tokenizer.position}: ${s.message}`;xr(o),this.addWarning(o)}else throw s;break}const i=await Th.readAtom(this.tokenizer,(s,o)=>this.handleAtom(s,o),null,e);e-=i.header.length===BigInt(0)?e:Number(i.header.length)}const n=[];this.tracks.forEach(i=>{const s=[];i.soundSampleDescription.forEach(o=>{const a={},l=Z_[o.dataFormat];if(l?(s.push(l.format),a.codecName=l.format):a.codecName=`<${o.dataFormat}>`,o.description){const{description:c}=o;c.sampleRate>0&&(a.type=Zs.audio,a.audio={samplingFrequency:c.sampleRate,bitDepth:c.sampleSize,channels:c.numAudioChannels})}this.metadata.addStreamInfo(a)}),s.length>=1&&n.push(s.join("/"))}),n.length>0&&this.metadata.setFormat("codec",n.filter(eE).join("+"));const r=this.tracks.filter(i=>i.soundSampleDescription.length>=1&&i.soundSampleDescription[0].description&&i.soundSampleDescription[0].description.numAudioChannels>0);if(r.length>=1){const i=r[0];if(i.timeScale>0){const a=i.duration/i.timeScale;this.metadata.setFormat("duration",a)}const s=i.soundSampleDescription[0];if(s.description&&(this.metadata.setFormat("sampleRate",s.description.sampleRate),this.metadata.setFormat("bitsPerSample",s.description.sampleSize),this.metadata.setFormat("numberOfChannels",s.description.numAudioChannels),i.timeScale===0&&i.timeToSampleTable.length>0)){const l=i.timeToSampleTable.map(c=>c.count*c.duration).reduce((c,d)=>c+d)/s.description.sampleRate;this.metadata.setFormat("duration",l)}const o=Z_[s.dataFormat];o&&this.metadata.setFormat("lossless",!o.lossy),this.calculateBitRate()}}async handleAtom(e,n){if(e.parent)switch(e.parent.header.name){case"ilst":case"<id>":return this.parseMetadataItemData(e)}if(this.atomParsers[e.header.name])return this.atomParsers[e.header.name](n);xr(`No parser for atom path=${e.atomPath}, payload-len=${n}, ignoring atom`),await this.tokenizer.ignore(n)}getTrackDescription(){return this.tracks[this.tracks.length-1]}calculateBitRate(){this.audioLengthInBytes&&this.metadata.format.duration&&this.metadata.setFormat("bitrate",8*this.audioLengthInBytes/this.metadata.format.duration)}async addTag(e,n){await this.metadata.addTag(A6,e,n)}addWarning(e){xr(`Warning: ${e}`),this.metadata.addWarning(e)}parseMetadataItemData(e){let n=e.header.name;return e.readAtoms(this.tokenizer,async(r,i)=>{const s=r.getPayloadLength(i);switch(r.header.name){case"data":return this.parseValueAtom(n,r);case"name":case"mean":case"rate":{const o=await this.tokenizer.readToken(new g6(s));n+=`:${o.name}`;break}default:{const o=await this.tokenizer.readToken(new cn(s));this.addWarning(`Unsupported meta-item: ${n}[${r.header.name}] => value=${Yv(o)} ascii=${Qv(o,"ascii")}`)}}},e.getPayloadLength(0))}async parseValueAtom(e,n){const r=await this.tokenizer.readToken(new p6(Number(n.header.length)-kh.len));if(r.type.set!==0)throw new Error(`Unsupported type-set != 0: ${r.type.set}`);switch(r.type.type){case 0:switch(e){case"trkn":case"disk":{const i=he.get(r.value,3),s=he.get(r.value,5);await this.addTag(e,`${i}/${s}`);break}case"gnre":{const i=he.get(r.value,1),s=Sh[i-1];await this.addTag(e,s);break}case"rate":{const i=new TextDecoder("ascii").decode(r.value);await this.addTag(e,i);break}default:xr(`unknown proprietary value type for: ${n.atomPath}`)}break;case 1:case 18:await this.addTag(e,new TextDecoder("utf-8").decode(r.value));break;case 13:if(this.options.skipCovers)break;await this.addTag(e,{format:"image/jpeg",data:Uint8Array.from(r.value)});break;case 14:if(this.options.skipCovers)break;await this.addTag(e,{format:"image/png",data:Uint8Array.from(r.value)});break;case 21:await this.addTag(e,Ih.read_BE_Integer(r.value,!0));break;case 22:await this.addTag(e,Ih.read_BE_Integer(r.value,!1));break;case 65:await this.addTag(e,he.get(r.value,0));break;case 66:await this.addTag(e,Re.get(r.value,0));break;case 67:await this.addTag(e,re.get(r.value,0));break;default:this.addWarning(`atom key=${e}, has unknown well-known-type (data-type): ${r.type.type}`)}}parseSoundSampleDescription(e){const n={dataFormat:e.dataFormat,dataReferenceIndex:e.dataReferenceIndex};let r=0;const i=J_.get(e.description,r);return r+=J_.len,i.version===0||i.version===1?n.description=w6.get(e.description,r):xr(`Warning: sound-sample-description ${i} not implemented`),n}async parseChapterTrack(e,n,r){if(!e.sampleSize&&e.chunkOffsetTable.length!==e.sampleSizeTable.length)throw new Error("Expected equal chunk-offset-table & sample-size-table length.");const i=[];for(let s=0;s<e.chunkOffsetTable.length&&r>0;++s){const a=e.chunkOffsetTable[s]-this.tokenizer.position,l=e.sampleSize>0?e.sampleSize:e.sampleSizeTable[s];if(r-=a+l,r<0)throw new Error("Chapter chunk exceeding token length");await this.tokenizer.ignore(a);const c=await this.tokenizer.readToken(new I6(l));xr(`Chapter ${s+1}: ${c}`);const d={title:c,sampleOffset:this.findSampleOffset(n,this.tokenizer.position)};xr(`Chapter title=${d.title}, offset=${d.sampleOffset}/${this.tracks[0].duration}`),i.push(d)}this.metadata.setFormat("chapters",i),await this.tokenizer.ignore(r)}findSampleOffset(e,n){let r=0;e.timeToSampleTable.forEach(s=>{r+=s.count*s.duration}),xr(`Total duration=${r}`);let i=0;for(;i<e.chunkOffsetTable.length&&e.chunkOffsetTable[i]<n;)++i;return this.getChunkDuration(i+1,e)}getChunkDuration(e,n){let r=0,i=n.timeToSampleTable[r].count,s=n.timeToSampleTable[r].duration,o=1,a=this.getSamplesPerChunk(o,n.sampleToChunkTable),l=0;for(;o<e;){const c=Math.min(i,a);l+=c*s,i-=c,a-=c,a===0?(++o,a=this.getSamplesPerChunk(o,n.sampleToChunkTable)):(++r,i=n.timeToSampleTable[r].count,s=n.timeToSampleTable[r].duration)}return l}getSamplesPerChunk(e,n){for(let r=0;r<n.length-1;++r)if(e>=n[r].firstChunk&&e<n[r+1].firstChunk)return n[r].samplesPerChunk;return n[n.length-1].samplesPerChunk}}var tE;(function(t){t[t.not_set=0]="not_set",t[t.radio=1]="radio",t[t.audiophile=2]="audiophile"})(tE||(tE={}));var nE;(function(t){t[t.unspecified=0]="unspecified",t[t.engineer=1]="engineer",t[t.user=2]="user",t[t.automatic=3]="automatic",t[t.rms_average=4]="rms_average"})(nE||(nE={}));const rE={len:2,get:(t,e)=>{const n=ye(t,e,0,3),r=ye(t,e,6,1),i=ye(t,e,7,9)/10;if(n>0)return{type:ye(t,e,0,3),origin:ye(t,e,3,3),adjustment:r?-i:i}}},R6={len:27,get:(t,e)=>{const n=re.get(t,e+2);return{revision:ye(t,e,0,4),vbr_method:ye(t,e,4,4),lowpass_filter:100*he.get(t,e+1),track_peak:n===0?null:n/2**23,track_gain:rE.get(t,6),album_gain:rE.get(t,8),music_length:re.get(t,e+20),music_crc:he.get(t,e+24),header_crc:Re.get(t,e+24)}}},iE=new ne(4,"ascii"),Mp=new ne(6,"ascii"),P6={len:4,get:(t,e)=>({frames:kn(t,e,31),bytes:kn(t,e,30),toc:kn(t,e,29),vbrScale:kn(t,e,28)})};async function N6(t){const e=await t.readToken(P6),n={numFrames:null,streamSize:null,vbrScale:null};if(e.frames&&(n.numFrames=await t.readToken(re)),e.bytes&&(n.streamSize=await t.readToken(re)),e.toc&&(n.toc=new Uint8Array(100),await t.readBuffer(n.toc)),e.vbrScale&&(n.vbrScale=await t.readToken(re)),await t.peekToken(new ne(4,"ascii"))==="LAME"){await t.ignore(4),n.lame={version:await t.readToken(new ne(5,"ascii"))};const i=n.lame.version.match(/\d+.\d+/g);if(i!==null){const o=i[0].split(".").map(a=>Number.parseInt(a,10));o[0]>=3&&o[1]>=90&&(n.lame.extended=await t.readToken(R6))}}return n}const Sn=Ne("music-metadata:parser:mpeg"),sE=1024,oE={AudioObjectTypes:["AAC Main","AAC LC","AAC SSR","AAC LTP"],SamplingFrequencies:[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350,null,null,-1]},D6=[void 0,["front-center"],["front-left","front-right"],["front-center","front-left","front-right"],["front-center","front-left","front-right","back-center"],["front-center","front-left","front-right","back-left","back-right"],["front-center","front-left","front-right","back-left","back-right","LFE-channel"],["front-center","front-left","front-right","side-left","side-right","back-left","back-right","LFE-channel"]];class Et{constructor(e,n){this.bitrateIndex=null,this.sampRateFreqIndex=null,this.padding=null,this.privateBit=null,this.channelModeIndex=null,this.modeExtension=null,this.isOriginalMedia=null,this.version=null,this.bitrate=null,this.samplingRate=null,this.frameLength=0,this.versionIndex=ye(e,n+1,3,2),this.layer=Et.LayerDescription[ye(e,n+1,5,2)],this.versionIndex>1&&this.layer===0?this.parseAdtsHeader(e,n):this.parseMpegHeader(e,n),this.isProtectedByCRC=!kn(e,n+1,7)}calcDuration(e){return this.samplingRate==null?null:e*this.calcSamplesPerFrame()/this.samplingRate}calcSamplesPerFrame(){return Et.samplesInFrameTable[this.version===1?0:1][this.layer]}calculateSideInfoLength(){if(this.layer!==3)return 2;if(this.channelModeIndex===3){if(this.version===1)return 17;if(this.version===2||this.version===2.5)return 9}else{if(this.version===1)return 32;if(this.version===2||this.version===2.5)return 17}return null}calcSlotSize(){return[null,4,1,1][this.layer]}parseMpegHeader(e,n){this.container="MPEG",this.bitrateIndex=ye(e,n+2,0,4),this.sampRateFreqIndex=ye(e,n+2,4,2),this.padding=kn(e,n+2,6),this.privateBit=kn(e,n+2,7),this.channelModeIndex=ye(e,n+3,0,2),this.modeExtension=ye(e,n+3,2,2),this.isCopyrighted=kn(e,n+3,4),this.isOriginalMedia=kn(e,n+3,5),this.emphasis=ye(e,n+3,7,2),this.version=Et.VersionID[this.versionIndex],this.channelMode=Et.ChannelMode[this.channelModeIndex],this.codec=`MPEG ${this.version} Layer ${this.layer}`;const r=this.calcBitrate();if(!r)throw new Error("Cannot determine bit-rate");if(this.bitrate=r*1e3,this.samplingRate=this.calcSamplingRate(),this.samplingRate==null)throw new Error("Cannot determine sampling-rate")}parseAdtsHeader(e,n){Sn("layer=0 => ADTS"),this.version=this.versionIndex===2?4:2,this.container=`ADTS/MPEG-${this.version}`;const r=ye(e,n+2,0,2);this.codec="AAC",this.codecProfile=oE.AudioObjectTypes[r],Sn(`MPEG-4 audio-codec=${this.codec}`);const i=ye(e,n+2,2,4);this.samplingRate=oE.SamplingFrequencies[i],Sn(`sampling-rate=${this.samplingRate}`);const s=ye(e,n+2,7,3);this.mp4ChannelConfig=D6[s],Sn(`channel-config=${this.mp4ChannelConfig?this.mp4ChannelConfig.join("+"):"?"}`),this.frameLength=ye(e,n+3,6,2)<<11}calcBitrate(){if(this.bitrateIndex===0||this.bitrateIndex===15)return null;if(this.version&&this.bitrateIndex){const e=10*Math.floor(this.version)+this.layer;return Et.bitrate_index[this.bitrateIndex][e]}return null}calcSamplingRate(){return this.sampRateFreqIndex===3||this.version===null||this.sampRateFreqIndex==null?null:Et.sampling_rate_freq_index[this.version][this.sampRateFreqIndex]}}Et.SyncByte1=255;Et.SyncByte2=224;Et.VersionID=[2.5,null,2,1];Et.LayerDescription=[0,3,2,1];Et.ChannelMode=["stereo","joint_stereo","dual_channel","mono"];Et.bitrate_index={1:{11:32,12:32,13:32,21:32,22:8,23:8},2:{11:64,12:48,13:40,21:48,22:16,23:16},3:{11:96,12:56,13:48,21:56,22:24,23:24},4:{11:128,12:64,13:56,21:64,22:32,23:32},5:{11:160,12:80,13:64,21:80,22:40,23:40},6:{11:192,12:96,13:80,21:96,22:48,23:48},7:{11:224,12:112,13:96,21:112,22:56,23:56},8:{11:256,12:128,13:112,21:128,22:64,23:64},9:{11:288,12:160,13:128,21:144,22:80,23:80},10:{11:320,12:192,13:160,21:160,22:96,23:96},11:{11:352,12:224,13:192,21:176,22:112,23:112},12:{11:384,12:256,13:224,21:192,22:128,23:128},13:{11:416,12:320,13:256,21:224,22:144,23:144},14:{11:448,12:384,13:320,21:256,22:160,23:160}};Et.sampling_rate_freq_index={1:{0:44100,1:48e3,2:32e3},2:{0:22050,1:24e3,2:16e3},2.5:{0:11025,1:12e3,2:8e3}};Et.samplesInFrameTable=[[0,384,1152,1152],[0,384,1152,576]];const aE={len:4,get:(t,e)=>new Et(t,e)};function j6(t){return`V${Math.floor((100-t)/10)}`}class O6 extends Ff{constructor(){super(...arguments),this.frameCount=0,this.syncFrameCount=-1,this.countSkipFrameData=0,this.totalDataLength=0,this.bitrates=[],this.offset=0,this.frame_size=0,this.crc=null,this.calculateEofDuration=!1,this.samplesPerFrame=null,this.buf_frame_header=new Uint8Array(4),this.mpegOffset=null,this.syncPeek={buf:new Uint8Array(sE),len:0}}async postId3v2Parse(){this.metadata.setFormat("lossless",!1);try{let e=!1;for(;!e;)await this.sync(),e=await this.parseCommonMpegHeader()}catch(e){if(e instanceof it){if(Sn("End-of-stream"),this.calculateEofDuration&&this.samplesPerFrame!==null){const n=this.frameCount*this.samplesPerFrame;if(this.metadata.setFormat("numberOfSamples",n),this.metadata.format.sampleRate){const r=n/this.metadata.format.sampleRate;Sn(`Calculate duration at EOF: ${r} sec.`,r),this.metadata.setFormat("duration",r)}}}else throw e}}finalize(){const e=this.metadata.format,n=!!this.metadata.native.ID3v1;if(this.mpegOffset!==null){if(e.duration&&this.tokenizer.fileInfo.size){const r=this.tokenizer.fileInfo.size-this.mpegOffset-(n?128:0);e.codecProfile&&e.codecProfile[0]==="V"&&this.metadata.setFormat("bitrate",r*8/e.duration)}else if(this.tokenizer.fileInfo.size&&e.codecProfile==="CBR"){const r=this.tokenizer.fileInfo.size-this.mpegOffset-(n?128:0);if(this.frame_size!==null&&this.samplesPerFrame!==null){const i=Math.round(r/this.frame_size)*this.samplesPerFrame;if(this.metadata.setFormat("numberOfSamples",i),e.sampleRate){const s=i/e.sampleRate;Sn("Calculate CBR duration based on file size: %s",s),this.metadata.setFormat("duration",s)}}}}}async sync(){let e=!1;for(;;){let n=0;if(this.syncPeek.len=await this.tokenizer.peekBuffer(this.syncPeek.buf,{length:sE,mayBeLess:!0}),this.syncPeek.len<=163)throw new it;for(;;){if(e&&(this.syncPeek.buf[n]&224)===224){this.buf_frame_header[0]=Et.SyncByte1,this.buf_frame_header[1]=this.syncPeek.buf[n],await this.tokenizer.ignore(n),Sn(`Sync at offset=${this.tokenizer.position-1}, frameCount=${this.frameCount}`),this.syncFrameCount===this.frameCount&&(Sn(`Re-synced MPEG stream, frameCount=${this.frameCount}`),this.frameCount=0,this.frame_size=0),this.syncFrameCount=this.frameCount;return}if(e=!1,n=this.syncPeek.buf.indexOf(Et.SyncByte1,n),n===-1){if(this.syncPeek.len<this.syncPeek.buf.length)throw new it;await this.tokenizer.ignore(this.syncPeek.len);break}++n,e=!0}}}async parseCommonMpegHeader(){this.frameCount===0&&(this.mpegOffset=this.tokenizer.position-1),await this.tokenizer.peekBuffer(this.buf_frame_header,{offset:1,length:3});let e;try{e=aE.get(this.buf_frame_header,0)}catch(n){if(await this.tokenizer.ignore(1),n instanceof Error)return this.metadata.addWarning(`Parse error: ${n.message}`),!1;throw n}return await this.tokenizer.ignore(3),this.metadata.setFormat("container",e.container),this.metadata.setFormat("codec",e.codec),this.metadata.setFormat("lossless",!1),this.metadata.setFormat("sampleRate",e.samplingRate),this.frameCount++,e.version!==null&&e.version>=2&&e.layer===0?this.parseAdts(e):this.parseAudioFrameHeader(e)}async parseAudioFrameHeader(e){this.metadata.setFormat("numberOfChannels",e.channelMode==="mono"?1:2),this.metadata.setFormat("bitrate",e.bitrate),this.frameCount<20*1e4&&Sn("offset=%s MP%s bitrate=%s sample-rate=%s",this.tokenizer.position-4,e.layer,e.bitrate,e.samplingRate);const n=e.calcSlotSize();if(n===null)throw new Error("invalid slot_size");const r=e.calcSamplesPerFrame();Sn(`samples_per_frame=${r}`);const i=r/8;if(e.bitrate!==null&&e.samplingRate!=null){const s=i*e.bitrate/e.samplingRate+(e.padding?n:0);this.frame_size=Math.floor(s)}if(this.audioFrameHeader=e,e.bitrate!==null&&this.bitrates.push(e.bitrate),this.frameCount===1)return this.offset=aE.len,await this.skipSideInformation(),!1;if(this.frameCount===3){if(this.areAllSame(this.bitrates)){if(this.samplesPerFrame=r,this.metadata.setFormat("codecProfile","CBR"),this.tokenizer.fileInfo.size)return!0}else if(this.metadata.format.duration)return!0;if(!this.options.duration)return!0}return this.options.duration&&this.frameCount===4&&(this.samplesPerFrame=r,this.calculateEofDuration=!0),this.offset=4,e.isProtectedByCRC?(await this.parseCrc(),!1):(await this.skipSideInformation(),!1)}async parseAdts(e){const n=new Uint8Array(3);if(await this.tokenizer.readBuffer(n),e.frameLength+=ye(n,0,0,11),this.totalDataLength+=e.frameLength,this.samplesPerFrame=1024,e.samplingRate!==null){const r=e.samplingRate/this.samplesPerFrame,s=8*(this.frameCount===0?0:this.totalDataLength/this.frameCount)*r+.5;this.metadata.setFormat("bitrate",s),Sn(`frame-count=${this.frameCount}, size=${e.frameLength} bytes, bit-rate=${s}`)}if(await this.tokenizer.ignore(e.frameLength>7?e.frameLength-7:1),this.frameCount===3)if(this.metadata.setFormat("codecProfile",e.codecProfile),e.mp4ChannelConfig&&this.metadata.setFormat("numberOfChannels",e.mp4ChannelConfig.length),this.options.duration)this.calculateEofDuration=!0;else return!0;return!1}async parseCrc(){return this.crc=await this.tokenizer.readNumber(Jr),this.offset+=2,this.skipSideInformation()}async skipSideInformation(){if(this.audioFrameHeader){const e=this.audioFrameHeader.calculateSideInfoLength();if(e!==null){await this.tokenizer.readToken(new cn(e)),this.offset+=e,await this.readXtraInfoHeader();return}}}async readXtraInfoHeader(){const e=await this.tokenizer.readToken(iE);switch(this.offset+=iE.len,e){case"Info":return this.metadata.setFormat("codecProfile","CBR"),this.readXingInfoHeader();case"Xing":{const r=await this.readXingInfoHeader();if(r.vbrScale!==null){const i=j6(r.vbrScale);this.metadata.setFormat("codecProfile",i)}return null}case"Xtra":break;case"LAME":{const r=await this.tokenizer.readToken(Mp);if(this.frame_size!==null&&this.frame_size>=this.offset+Mp.len)return this.offset+=Mp.len,this.metadata.setFormat("tool",`LAME ${r}`),await this.skipFrameData(this.frame_size-this.offset),null;this.metadata.addWarning("Corrupt LAME header");break}}const n=this.frame_size-this.offset;return n<0?this.metadata.addWarning(`Frame ${this.frameCount}corrupt: negative frameDataLeft`):await this.skipFrameData(n),null}async readXingInfoHeader(){const e=this.tokenizer.position,n=await N6(this.tokenizer);if(this.offset+=this.tokenizer.position-e,n.lame&&(this.metadata.setFormat("tool",`LAME ${Pi(n.lame.version)}`),n.lame.extended&&(this.metadata.setFormat("trackPeakLevel",n.lame.extended.track_peak),n.lame.extended.track_gain&&this.metadata.setFormat("trackGain",n.lame.extended.track_gain.adjustment),n.lame.extended.album_gain&&this.metadata.setFormat("albumGain",n.lame.extended.album_gain.adjustment),this.metadata.setFormat("duration",n.lame.extended.music_length/1e3))),n.streamSize&&this.audioFrameHeader&&n.numFrames!==null){const i=this.audioFrameHeader.calcDuration(n.numFrames);return this.metadata.setFormat("duration",i),Sn("Get duration from Xing header: %s",this.metadata.format.duration),n}const r=this.frame_size-this.offset;return await this.skipFrameData(r),n}async skipFrameData(e){if(e<0)throw new Error("frame-data-left cannot be negative");await this.tokenizer.ignore(e),this.countSkipFrameData+=e}areAllSame(e){const n=e[0];return e.every(r=>r===n)}}const lE=Ne("music-metadata:parser:musepack:sv8"),M6=new ne(2,"latin1"),cE={len:5,get:(t,e)=>({crc:J.get(t,e),streamVersion:he.get(t,e+4)})},uE={len:2,get:(t,e)=>({sampleFrequency:[44100,48e3,37800,32e3][ye(t,e,0,3)],maxUsedBands:ye(t,e,3,5),channelCount:ye(t,e+1,0,4)+1,msUsed:kn(t,e+1,4),audioBlockFrames:ye(t,e+1,5,3)})};class L6{constructor(e){this.tokenizer=e}async readPacketHeader(){const e=await this.tokenizer.readToken(M6),n=await this.readVariableSizeField();return{key:e,payloadLength:n.value-2-n.len}}async readStreamHeader(e){const n={};lE(`Reading SH at offset=${this.tokenizer.position}`);const r=await this.tokenizer.readToken(cE);e-=cE.len,Object.assign(n,r),lE(`SH.streamVersion = ${r.streamVersion}`);const i=await this.readVariableSizeField();e-=i.len,n.sampleCount=i.value;const s=await this.readVariableSizeField();e-=s.len,n.beginningOfSilence=s.value;const o=await this.tokenizer.readToken(uE);return e-=uE.len,Object.assign(n,o),await this.tokenizer.ignore(e),n}async readVariableSizeField(e=1,n=0){let r=await this.tokenizer.readNumber(he);return r&128?(r&=127,r+=n,this.readVariableSizeField(e+1,r<<7)):{len:e,value:n+r}}}const F6=Ne("music-metadata:parser:musepack");class $6 extends Bn{constructor(){super(...arguments),this.audioLength=0}async parse(){if(await this.tokenizer.readToken(Ve)!=="MPCK")throw new Error("Invalid Magic number");return this.metadata.setFormat("container","Musepack, SV8"),this.parsePacket()}async parsePacket(){const e=new L6(this.tokenizer);do{const n=await e.readPacketHeader();switch(F6(`packet-header key=${n.key}, payloadLength=${n.payloadLength}`),n.key){case"SH":{const r=await e.readStreamHeader(n.payloadLength);this.metadata.setFormat("numberOfSamples",r.sampleCount),this.metadata.setFormat("sampleRate",r.sampleFrequency),this.metadata.setFormat("duration",r.sampleCount/r.sampleFrequency),this.metadata.setFormat("numberOfChannels",r.channelCount);break}case"AP":this.audioLength+=n.payloadLength,await this.tokenizer.ignore(n.payloadLength);break;case"RG":case"EI":case"SO":case"ST":case"CT":await this.tokenizer.ignore(n.payloadLength);break;case"SE":return this.metadata.format.duration&&this.metadata.setFormat("bitrate",this.audioLength*8/this.metadata.format.duration),kr.tryParseApeHeader(this.metadata,this.tokenizer,this.options);default:throw new Error(`Unexpected header: ${n.key}`)}}while(!0)}}class z6{constructor(e){this.tokenizer=e,this.pos=0,this.dword=null}async read(e){for(;this.dword===null;)this.dword=await this.tokenizer.readToken(J);let n=this.dword;return this.pos+=e,this.pos<32?(n>>>=32-this.pos,n&(1<<e)-1):(this.pos-=32,this.pos===0?(this.dword=null,n&(1<<e)-1):(this.dword=await this.tokenizer.readToken(J),this.pos&&(n<<=this.pos,n|=this.dword>>>32-this.pos),n&(1<<e)-1))}async ignore(e){if(this.pos>0){const i=32-this.pos;this.dword=null,e-=i,this.pos=0}const n=e%32,r=(e-n)/32;return await this.tokenizer.ignore(r*4),this.read(n)}}const B6={len:6*4,get:(t,e)=>{const n={signature:new TextDecoder("latin1").decode(t.subarray(e,e+3)),streamMinorVersion:ye(t,e+3,0,4),streamMajorVersion:ye(t,e+3,4,4),frameCount:J.get(t,e+4),maxLevel:ke.get(t,e+8),sampleFrequency:[44100,48e3,37800,32e3][ye(t,e+10,0,2)],link:ye(t,e+10,2,2),profile:ye(t,e+10,4,4),maxBand:ye(t,e+11,0,6),intensityStereo:kn(t,e+11,6),midSideStereo:kn(t,e+11,7),titlePeak:ke.get(t,e+12),titleGain:ke.get(t,e+14),albumPeak:ke.get(t,e+16),albumGain:ke.get(t,e+18),lastFrameLength:J.get(t,e+20)>>>20&2047,trueGapless:kn(t,e+23,0)};return n.lastFrameLength=n.trueGapless?J.get(t,20)>>>20&2047:0,n}},dE=Ne("music-metadata:parser:musepack");class V6 extends Bn{constructor(){super(...arguments),this.bitreader=null,this.audioLength=0,this.duration=null}async parse(){const e=await this.tokenizer.readToken(B6);if(e.signature!=="MP+")throw new Error("Unexpected magic number");dE(`stream-version=${e.streamMajorVersion}.${e.streamMinorVersion}`),this.metadata.setFormat("container","Musepack, SV7"),this.metadata.setFormat("sampleRate",e.sampleFrequency);const n=1152*(e.frameCount-1)+e.lastFrameLength;this.metadata.setFormat("numberOfSamples",n),this.duration=n/e.sampleFrequency,this.metadata.setFormat("duration",this.duration),this.bitreader=new z6(this.tokenizer),this.metadata.setFormat("numberOfChannels",e.midSideStereo||e.intensityStereo?2:1);const r=await this.bitreader.read(8);return this.metadata.setFormat("codec",(r/100).toFixed(2)),await this.skipAudioData(e.frameCount),dE(`End of audio stream, switching to APEv2, offset=${this.tokenizer.position}`),kr.tryParseApeHeader(this.metadata,this.tokenizer,this.options)}async skipAudioData(e){for(;e-- >0;){const r=await this.bitreader.read(20);this.audioLength+=20+r,await this.bitreader.ignore(r)}const n=await this.bitreader.read(11);this.audioLength+=n,this.duration!==null&&this.metadata.setFormat("bitrate",this.audioLength/this.duration)}}const hE=Ne("music-metadata:parser:musepack");class U6 extends Ff{async postId3v2Parse(){const e=await this.tokenizer.peekToken(new ne(3,"latin1"));let n;switch(e){case"MP+":{hE("Musepack stream-version 7"),n=new V6;break}case"MPC":{hE("Musepack stream-version 8"),n=new $6;break}default:throw new Error("Invalid Musepack signature prefix")}return n.init(this.metadata,this.tokenizer,this.options),n.parse()}}class W6{constructor(e){if(this.len=e,e<19)throw new Error("ID-header-page 0 should be at least 19 bytes long")}get(e,n){return{magicSignature:new ne(8,"ascii").get(e,n+0),version:he.get(e,n+8),channelCount:he.get(e,n+9),preSkip:ke.get(e,n+10),inputSampleRate:J.get(e,n+12),outputGain:ke.get(e,n+16),channelMapping:he.get(e,n+18)}}}class H6 extends to{constructor(e,n,r){super(e,n),this.tokenizer=r,this.idHeader=null,this.lastPos=-1}parseFirstPage(e,n){if(this.metadata.setFormat("codec","Opus"),this.idHeader=new W6(n.length).get(n,0),this.idHeader.magicSignature!=="OpusHead")throw new Error("Illegal ogg/Opus magic-signature");this.metadata.setFormat("sampleRate",this.idHeader.inputSampleRate),this.metadata.setFormat("numberOfChannels",this.idHeader.channelCount)}async parseFullPage(e){switch(new ne(8,"ascii").get(e,0)){case"OpusTags":await this.parseUserCommentList(e,8),this.lastPos=this.tokenizer.position-e.length;break}}calculateDuration(e){if(this.metadata.format.sampleRate&&e.absoluteGranulePosition>=0){const n=e.absoluteGranulePosition-this.idHeader.preSkip;if(this.metadata.setFormat("numberOfSamples",n),this.metadata.setFormat("duration",n/48e3),this.lastPos!==-1&&this.tokenizer.fileInfo.size&&this.metadata.format.duration){const r=this.tokenizer.fileInfo.size-this.lastPos;this.metadata.setFormat("bitrate",8*r/this.metadata.format.duration)}}}}const q6={len:80,get:(t,e)=>({speex:new ne(8,"ascii").get(t,e+0),version:LT(new ne(20,"ascii").get(t,e+8)),version_id:tt.get(t,e+28),header_size:tt.get(t,e+32),rate:tt.get(t,e+36),mode:tt.get(t,e+40),mode_bitstream_version:tt.get(t,e+44),nb_channels:tt.get(t,e+48),bitrate:tt.get(t,e+52),frame_size:tt.get(t,e+56),vbr:tt.get(t,e+60),frames_per_packet:tt.get(t,e+64),extra_headers:tt.get(t,e+68),reserved1:tt.get(t,e+72),reserved2:tt.get(t,e+76)})},G6=Ne("music-metadata:parser:ogg:speex");class K6 extends to{constructor(e,n,r){super(e,n),this.tokenizer=r}parseFirstPage(e,n){G6("First Ogg/Speex page");const r=q6.get(n,0);this.metadata.setFormat("codec",`Speex ${r.version}`),this.metadata.setFormat("numberOfChannels",r.nb_channels),this.metadata.setFormat("sampleRate",r.rate),r.bitrate!==-1&&this.metadata.setFormat("bitrate",r.bitrate)}}const X6={len:42,get:(t,e)=>({id:new ne(7,"ascii").get(t,e),vmaj:he.get(t,e+7),vmin:he.get(t,e+8),vrev:he.get(t,e+9),vmbw:Re.get(t,e+10),vmbh:Re.get(t,e+17),nombr:sn.get(t,e+37),nqual:he.get(t,e+40)})},Lp=Ne("music-metadata:parser:ogg:theora");class Q6{constructor(e,n,r){this.metadata=e,this.tokenizer=r}async parsePage(e,n){e.headerType.firstPage&&await this.parseFirstPage(e,n)}async flush(){Lp("flush")}calculateDuration(e){Lp("duration calculation not implemented")}async parseFirstPage(e,n){Lp("First Ogg/Theora page"),this.metadata.setFormat("codec","Theora");const r=X6.get(n,0);this.metadata.setFormat("bitrate",r.nombr)}}const qr=Ne("music-metadata:parser:ogg");class ix{static sum(e,n,r){const i=new DataView(e.buffer,0);let s=0;for(let o=n;o<n+r;++o)s+=i.getUint8(o);return s}constructor(e){this.len=e.page_segments}get(e,n){return{totalPageSize:ix.sum(e,n,this.len)}}}class $f extends Bn{constructor(){super(...arguments),this.header=null,this.pageNumber=0,this.pageConsumer=null}async parse(){qr("pos=%s, parsePage()",this.tokenizer.position);try{let e;do{if(e=await this.tokenizer.readToken($f.Header),e.capturePattern!=="OggS")throw new Error("Invalid Ogg capture pattern");this.metadata.setFormat("container","Ogg"),this.header=e,this.pageNumber=e.pageSequenceNo,qr("page#=%s, Ogg.id=%s",e.pageSequenceNo,e.capturePattern);const n=await this.tokenizer.readToken(new ix(e));qr("totalPageSize=%s",n.totalPageSize);const r=await this.tokenizer.readToken(new cn(n.totalPageSize));if(qr("firstPage=%s, lastPage=%s, continued=%s",e.headerType.firstPage,e.headerType.lastPage,e.headerType.continued),e.headerType.firstPage){const i=new TextDecoder("ascii").decode(r.subarray(0,7));switch(i){case"vorbis":qr("Set page consumer to Ogg/Vorbis"),this.pageConsumer=new to(this.metadata,this.options);break;case"OpusHea":qr("Set page consumer to Ogg/Opus"),this.pageConsumer=new H6(this.metadata,this.options,this.tokenizer);break;case"Speex  ":qr("Set page consumer to Ogg/Speex"),this.pageConsumer=new K6(this.metadata,this.options,this.tokenizer);break;case"fishead":case"\0theora":qr("Set page consumer to Ogg/Theora"),this.pageConsumer=new Q6(this.metadata,this.options,this.tokenizer);break;default:throw new Error(`gg audio-codec not recognized (id=${i})`)}}await this.pageConsumer.parsePage(e,r)}while(!e.headerType.lastPage)}catch(e){if(e instanceof Error)e instanceof it?(this.metadata.addWarning("Last OGG-page is not marked with last-page flag"),qr("End-of-stream"),this.metadata.addWarning("Last OGG-page is not marked with last-page flag"),this.header&&this.pageConsumer.calculateDuration(this.header)):e.message.startsWith("FourCC")&&this.pageNumber>0&&(this.metadata.addWarning("Invalid FourCC ID, maybe last OGG-page is not marked with last-page flag"),await this.pageConsumer.flush());else throw e}}}$f.Header={len:27,get:(t,e)=>({capturePattern:Ve.get(t,e),version:he.get(t,e+4),headerType:{continued:Qe(t,e+5,0),firstPage:Qe(t,e+5,1),lastPage:Qe(t,e+5,2)},absoluteGranulePosition:Number(en.get(t,e+6)),streamSerialNumber:J.get(t,e+14),pageSequenceNo:J.get(t,e+18),pageChecksum:J.get(t,e+22),page_segments:he.get(t,e+26)})};const vl={len:8,get:(t,e)=>({chunkID:new ne(4,"latin1").get(t,e),chunkSize:J.get(t,e+4)})};class Y6{constructor(e){this.tagHeader=e,this.len=e.chunkSize,this.len+=this.len&1}get(e,n){return new ne(this.tagHeader.chunkSize,"ascii").get(e,n)}}var U0;(function(t){t[t.PCM=1]="PCM",t[t.ADPCM=2]="ADPCM",t[t.IEEE_FLOAT=3]="IEEE_FLOAT",t[t.MPEG_ADTS_AAC=5632]="MPEG_ADTS_AAC",t[t.MPEG_LOAS=5634]="MPEG_LOAS",t[t.RAW_AAC1=255]="RAW_AAC1",t[t.DOLBY_AC3_SPDIF=146]="DOLBY_AC3_SPDIF",t[t.DVM=8192]="DVM",t[t.RAW_SPORT=576]="RAW_SPORT",t[t.ESST_AC3=577]="ESST_AC3",t[t.DRM=9]="DRM",t[t.DTS2=8193]="DTS2",t[t.MPEG=80]="MPEG"})(U0||(U0={}));class J6{constructor(e){if(e.chunkSize<16)throw new Error("Invalid chunk size");this.len=e.chunkSize}get(e,n){return{wFormatTag:ke.get(e,n),nChannels:ke.get(e,n+2),nSamplesPerSec:J.get(e,n+4),nAvgBytesPerSec:J.get(e,n+8),nBlockAlign:ke.get(e,n+12),wBitsPerSample:ke.get(e,n+14)}}}class Z6{constructor(e){if(e.chunkSize<4)throw new Error("Invalid fact chunk size.");this.len=e.chunkSize}get(e,n){return{dwSampleLength:J.get(e,n)}}}const fE={len:420,get:(t,e)=>({description:Pi(new ne(256,"ascii").get(t,e)).trim(),originator:Pi(new ne(32,"ascii").get(t,e+256)).trim(),originatorReference:Pi(new ne(32,"ascii").get(t,e+288)).trim(),originationDate:Pi(new ne(10,"ascii").get(t,e+320)).trim(),originationTime:Pi(new ne(8,"ascii").get(t,e+330)).trim(),timeReferenceLow:J.get(t,e+338),timeReferenceHigh:J.get(t,e+342),version:ke.get(t,e+346),umid:new cn(64).get(t,e+348),loudnessValue:ke.get(t,e+412),maxTruePeakLevel:ke.get(t,e+414),maxMomentaryLoudness:ke.get(t,e+416),maxShortTermLoudness:ke.get(t,e+418)})},Si=Ne("music-metadata:parser:RIFF");class eL extends Bn{constructor(){super(...arguments),this.blockAlign=0}async parse(){const e=await this.tokenizer.readToken(vl);if(Si(`pos=${this.tokenizer.position}, parse: chunkID=${e.chunkID}`),e.chunkID==="RIFF")return this.parseRiffChunk(e.chunkSize).catch(n=>{if(!(n instanceof it))throw n})}async parseRiffChunk(e){const n=await this.tokenizer.readToken(Ve);switch(this.metadata.setFormat("container",n),n){case"WAVE":return this.readWaveChunk(e-Ve.len);default:throw new Error(`Unsupported RIFF format: RIFF/${n}`)}}async readWaveChunk(e){for(;e>=vl.len;){const n=await this.tokenizer.readToken(vl);switch(e-=vl.len+n.chunkSize,n.chunkSize>e&&this.metadata.addWarning("Data chunk size exceeds file size"),this.header=n,Si(`pos=${this.tokenizer.position}, readChunk: chunkID=RIFF/WAVE/${n.chunkID}`),n.chunkID){case"LIST":await this.parseListTag(n);break;case"fact":this.metadata.setFormat("lossless",!1),this.fact=await this.tokenizer.readToken(new Z6(n));break;case"fmt ":{const r=await this.tokenizer.readToken(new J6(n));let i=U0[r.wFormatTag];i||(Si(`WAVE/non-PCM format=${r.wFormatTag}`),i=`non-PCM (${r.wFormatTag})`),this.metadata.setFormat("codec",i),this.metadata.setFormat("bitsPerSample",r.wBitsPerSample),this.metadata.setFormat("sampleRate",r.nSamplesPerSec),this.metadata.setFormat("numberOfChannels",r.nChannels),this.metadata.setFormat("bitrate",r.nBlockAlign*r.nSamplesPerSec*8),this.blockAlign=r.nBlockAlign;break}case"id3 ":case"ID3 ":{const r=await this.tokenizer.readToken(new cn(n.chunkSize)),i=Ta(r);await new lr().parse(this.metadata,i,this.options);break}case"data":{this.metadata.format.lossless!==!1&&this.metadata.setFormat("lossless",!0);let r=n.chunkSize;if(this.tokenizer.fileInfo.size){const s=this.tokenizer.fileInfo.size-this.tokenizer.position;s<r&&(this.metadata.addWarning("data chunk length exceeding file length"),r=s)}const i=this.fact?this.fact.dwSampleLength:r===4294967295?void 0:r/this.blockAlign;i&&(this.metadata.setFormat("numberOfSamples",i),this.metadata.format.sampleRate&&this.metadata.setFormat("duration",i/this.metadata.format.sampleRate)),this.metadata.format.codec==="ADPCM"?this.metadata.setFormat("bitrate",352e3):this.metadata.format.sampleRate&&this.metadata.setFormat("bitrate",this.blockAlign*this.metadata.format.sampleRate*8),await this.tokenizer.ignore(n.chunkSize);break}case"bext":{const r=await this.tokenizer.readToken(fE);Object.keys(r).forEach(s=>{this.metadata.addTag("exif",`bext.${s}`,r[s])});const i=n.chunkSize-fE.len;await this.tokenizer.ignore(i);break}case"\0\0\0\0":Si(`Ignore padding chunk: RIFF/${n.chunkID} of ${n.chunkSize} bytes`),this.metadata.addWarning(`Ignore chunk: RIFF/${n.chunkID}`),await this.tokenizer.ignore(n.chunkSize);break;default:Si(`Ignore chunk: RIFF/${n.chunkID} of ${n.chunkSize} bytes`),this.metadata.addWarning(`Ignore chunk: RIFF/${n.chunkID}`),await this.tokenizer.ignore(n.chunkSize)}this.header.chunkSize%2===1&&(Si("Read odd padding byte"),await this.tokenizer.ignore(1))}}async parseListTag(e){const n=await this.tokenizer.readToken(new ne(4,"latin1"));switch(Si("pos=%s, parseListTag: chunkID=RIFF/WAVE/LIST/%s",this.tokenizer.position,n),n){case"INFO":return this.parseRiffInfoTags(e.chunkSize-4);default:return this.metadata.addWarning(`Ignore chunk: RIFF/WAVE/LIST/${n}`),Si(`Ignoring chunkID=RIFF/WAVE/LIST/${n}`),this.tokenizer.ignore(e.chunkSize-4).then()}}async parseRiffInfoTags(e){for(;e>=8;){const n=await this.tokenizer.readToken(vl),r=new Y6(n),i=await this.tokenizer.readToken(r);this.addTag(n.chunkID,Pi(i)),e-=8+r.len}if(e!==0)throw new Error(`Illegal remaining size: ${e}`)}addTag(e,n){this.metadata.addTag("exif",e,n)}}const tL=[6e3,8e3,9600,11025,12e3,16e3,22050,24e3,32e3,44100,48e3,64e3,88200,96e3,192e3,-1],ed={len:32,get:(t,e)=>{const n=J.get(t,e+24),r={BlockID:Ve.get(t,e),blockSize:J.get(t,e+4),version:ke.get(t,e+8),totalSamples:J.get(t,e+12),blockIndex:J.get(t,e+16),blockSamples:J.get(t,e+20),flags:{bitsPerSample:(1+Ch(n,0,2))*8,isMono:_r(n,2),isHybrid:_r(n,3),isJointStereo:_r(n,4),crossChannel:_r(n,5),hybridNoiseShaping:_r(n,6),floatingPoint:_r(n,7),samplingRate:tL[Ch(n,23,4)],isDSD:_r(n,31)},crc:new cn(4).get(t,e+28)};return r.flags.isDSD&&(r.totalSamples*=8),r}},Fp={len:1,get:(t,e)=>({functionId:Ch(t[e],0,6),isOptional:_r(t[e],5),isOddSize:_r(t[e],6),largeBlock:_r(t[e],7)})};function _r(t,e){return Ch(t,e,1)===1}function Ch(t,e,n){return t>>>e&4294967295>>>32-n}const bs=Ne("music-metadata:parser:WavPack");class nL extends Bn{constructor(){super(...arguments),this.audioDataSize=0}async parse(){return this.audioDataSize=0,await this.parseWavPackBlocks(),kr.tryParseApeHeader(this.metadata,this.tokenizer,this.options)}async parseWavPackBlocks(){do{if(await this.tokenizer.peekToken(Ve)!=="wvpk")break;const n=await this.tokenizer.readToken(ed);if(n.BlockID!=="wvpk")throw new Error("Invalid WavPack Block-ID");bs(`WavPack header blockIndex=${n.blockIndex}, len=${ed.len}`),n.blockIndex===0&&!this.metadata.format.container&&(this.metadata.setFormat("container","WavPack"),this.metadata.setFormat("lossless",!n.flags.isHybrid),this.metadata.setFormat("bitsPerSample",n.flags.bitsPerSample),n.flags.isDSD||(this.metadata.setFormat("sampleRate",n.flags.samplingRate),this.metadata.setFormat("duration",n.totalSamples/n.flags.samplingRate)),this.metadata.setFormat("numberOfChannels",n.flags.isMono?1:2),this.metadata.setFormat("numberOfSamples",n.totalSamples),this.metadata.setFormat("codec",n.flags.isDSD?"DSD":"PCM"));const r=n.blockSize-(ed.len-8);await(n.blockIndex===0?this.parseMetadataSubBlock(n,r):this.tokenizer.ignore(r)),n.blockSamples>0&&(this.audioDataSize+=n.blockSize)}while(!this.tokenizer.fileInfo.size||this.tokenizer.fileInfo.size-this.tokenizer.position>=ed.len);this.metadata.format.duration&&this.metadata.setFormat("bitrate",this.audioDataSize*8/this.metadata.format.duration)}async parseMetadataSubBlock(e,n){let r=n;for(;r>Fp.len;){const i=await this.tokenizer.readToken(Fp),s=await this.tokenizer.readNumber(i.largeBlock?xh:he),o=new Uint8Array(s*2-(i.isOddSize?1:0));switch(await this.tokenizer.readBuffer(o),bs(`Metadata Sub-Blocks functionId=0x${i.functionId.toString(16)}, id.largeBlock=${i.largeBlock},data-size=${o.length}`),i.functionId){case 0:break;case 14:{bs("ID_DSD_BLOCK");const a=1<<he.get(o,0),l=e.flags.samplingRate*a*8;if(!e.flags.isDSD)throw new Error("Only expect DSD block if DSD-flag is set");this.metadata.setFormat("sampleRate",l),this.metadata.setFormat("duration",e.totalSamples/l);break}case 36:bs("ID_ALT_TRAILER: trailer for non-wav files");break;case 38:this.metadata.setFormat("audioMD5",o);break;case 47:bs(`ID_BLOCK_CHECKSUM: checksum=${Yv(o)}`);break;default:bs(`Ignore unsupported meta-sub-block-id functionId=0x${i.functionId.toString(16)}`);break}r-=Fp.len+(i.largeBlock?xh.len:he.len)+s*2,bs(`remainingLength=${r}`),i.isOddSize&&this.tokenizer.ignore(1)}if(r!==0)throw new Error("metadata-sub-block should fit it remaining length")}}const td={len:12,get:(t,e)=>({id:Ve.get(t,e),size:en.get(t,e+4)})},rL={len:16,get:(t,e)=>({fileSize:wh.get(t,e),metadataPointer:wh.get(t,e+8)})};var mE;(function(t){t[t.mono=1]="mono",t[t.stereo=2]="stereo",t[t.channels=3]="channels",t[t.quad=4]="quad",t[t["4 channels"]=5]="4 channels",t[t["5 channels"]=6]="5 channels",t[t["5.1 channels"]=7]="5.1 channels"})(mE||(mE={}));const iL={len:40,get:(t,e)=>({formatVersion:tt.get(t,e),formatID:tt.get(t,e+4),channelType:tt.get(t,e+8),channelNum:tt.get(t,e+12),samplingFrequency:tt.get(t,e+16),bitsPerSample:tt.get(t,e+20),sampleCount:wh.get(t,e+24),blockSizePerChannel:tt.get(t,e+32)})},$p=Ne("music-metadata:parser:DSF");class sL extends Ff{async postId3v2Parse(){const e=this.tokenizer.position,n=await this.tokenizer.readToken(td);if(n.id!=="DSD ")throw new Error("Invalid chunk signature");this.metadata.setFormat("container","DSF"),this.metadata.setFormat("lossless",!0);const r=await this.tokenizer.readToken(rL);if(r.metadataPointer===BigInt(0))$p("No ID3v2 tag present");else return $p(`expect ID3v2 at offset=${r.metadataPointer}`),await this.parseChunks(r.fileSize-n.size),await this.tokenizer.ignore(Number(r.metadataPointer)-this.tokenizer.position-e),new lr().parse(this.metadata,this.tokenizer,this.options)}async parseChunks(e){for(;e>=td.len;){const n=await this.tokenizer.readToken(td);switch($p(`Parsing chunk name=${n.id} size=${n.size}`),n.id){case"fmt ":{const r=await this.tokenizer.readToken(iL);this.metadata.setFormat("numberOfChannels",r.channelNum),this.metadata.setFormat("sampleRate",r.samplingFrequency),this.metadata.setFormat("bitsPerSample",r.bitsPerSample),this.metadata.setFormat("numberOfSamples",r.sampleCount),this.metadata.setFormat("duration",Number(r.sampleCount)/r.samplingFrequency);const i=r.bitsPerSample*r.samplingFrequency*r.channelNum;this.metadata.setFormat("bitrate",i);return}default:this.tokenizer.ignore(Number(n.size)-td.len);break}e-=n.size}}}const Do={len:12,get:(t,e)=>({chunkID:Ve.get(t,e),chunkSize:CT.get(t,e+4)})},Yt=Ne("music-metadata:parser:aiff");class oL extends Bn{async parse(){const e=await this.tokenizer.readToken(Do);if(e.chunkID!=="FRM8")throw new Error("Unexpected chunk-ID");const n=(await this.tokenizer.readToken(Ve)).trim();switch(n){case"DSD":return this.metadata.setFormat("container",`DSDIFF/${n}`),this.metadata.setFormat("lossless",!0),this.readFmt8Chunks(e.chunkSize-BigInt(Ve.len));default:throw new Error(`Unsupported DSDIFF type: ${n}`)}}async readFmt8Chunks(e){for(;e>=Do.len;){const n=await this.tokenizer.readToken(Do);Yt(`Chunk id=${n.chunkID}`),await this.readData(n),e-=BigInt(Do.len)+n.chunkSize}}async readData(e){Yt(`Reading data of chunk[ID=${e.chunkID}, size=${e.chunkSize}]`);const n=this.tokenizer.position;switch(e.chunkID.trim()){case"FVER":{const i=await this.tokenizer.readToken(J);Yt(`DSDIFF version=${i}`);break}case"PROP":{if(await this.tokenizer.readToken(Ve)!=="SND ")throw new Error("Unexpected PROP-chunk ID");await this.handleSoundPropertyChunks(e.chunkSize-BigInt(Ve.len));break}case"ID3":{const i=await this.tokenizer.readToken(new cn(Number(e.chunkSize))),s=Ta(i);await new lr().parse(this.metadata,s,this.options);break}case"DSD":this.metadata.format.numberOfChannels&&this.metadata.setFormat("numberOfSamples",Number(e.chunkSize*BigInt(8)/BigInt(this.metadata.format.numberOfChannels))),this.metadata.format.numberOfSamples&&this.metadata.format.sampleRate&&this.metadata.setFormat("duration",this.metadata.format.numberOfSamples/this.metadata.format.sampleRate);break;default:Yt(`Ignore chunk[ID=${e.chunkID}, size=${e.chunkSize}]`);break}const r=e.chunkSize-BigInt(this.tokenizer.position-n);r>0&&(Yt(`After Parsing chunk, remaining ${r} bytes`),await this.tokenizer.ignore(Number(r)))}async handleSoundPropertyChunks(e){for(Yt(`Parsing sound-property-chunks, remainingSize=${e}`);e>0;){const n=await this.tokenizer.readToken(Do);Yt(`Sound-property-chunk[ID=${n.chunkID}, size=${n.chunkSize}]`);const r=this.tokenizer.position;switch(n.chunkID.trim()){case"FS":{const s=await this.tokenizer.readToken(re);this.metadata.setFormat("sampleRate",s);break}case"CHNL":{const s=await this.tokenizer.readToken(Re);this.metadata.setFormat("numberOfChannels",s),await this.handleChannelChunks(n.chunkSize-BigInt(Re.len));break}case"CMPR":{const s=(await this.tokenizer.readToken(Ve)).trim(),o=await this.tokenizer.readToken(he),a=await this.tokenizer.readToken(new ne(o,"ascii"));s==="DSD"&&(this.metadata.setFormat("lossless",!0),this.metadata.setFormat("bitsPerSample",1)),this.metadata.setFormat("codec",`${s} (${a})`);break}case"ABSS":{const s=await this.tokenizer.readToken(Re),o=await this.tokenizer.readToken(he),a=await this.tokenizer.readToken(he),l=await this.tokenizer.readToken(re);Yt(`ABSS ${s}:${o}:${a}.${l}`);break}case"LSCO":{const s=await this.tokenizer.readToken(Re);Yt(`LSCO lsConfig=${s}`);break}default:Yt(`Unknown sound-property-chunk[ID=${n.chunkID}, size=${n.chunkSize}]`),await this.tokenizer.ignore(Number(n.chunkSize))}const i=n.chunkSize-BigInt(this.tokenizer.position-r);i>0&&(Yt(`After Parsing sound-property-chunk ${n.chunkSize}, remaining ${i} bytes`),await this.tokenizer.ignore(Number(i))),e-=BigInt(Do.len)+n.chunkSize,Yt(`Parsing sound-property-chunks, remainingSize=${e}`)}if(this.metadata.format.lossless&&this.metadata.format.sampleRate&&this.metadata.format.numberOfChannels&&this.metadata.format.bitsPerSample){const n=this.metadata.format.sampleRate*this.metadata.format.numberOfChannels*this.metadata.format.bitsPerSample;this.metadata.setFormat("bitrate",n)}}async handleChannelChunks(e){Yt(`Parsing channel-chunks, remainingSize=${e}`);const n=[];for(;e>=Ve.len;){const r=await this.tokenizer.readToken(Ve);Yt(`Channel[ID=${r}]`),n.push(r),e-=BigInt(Ve.len)}return Yt(`Channels: ${n.join(", ")}`),n}}var A;(function(t){t[t.string=0]="string",t[t.uint=1]="uint",t[t.uid=2]="uid",t[t.bool=3]="bool",t[t.binary=4]="binary",t[t.float=5]="float"})(A||(A={}));const aL={name:"dtd",container:{440786851:{name:"ebml",container:{17030:{name:"ebmlVersion",value:A.uint},17143:{name:"ebmlReadVersion",value:A.uint},17138:{name:"ebmlMaxIDWidth",value:A.uint},17139:{name:"ebmlMaxSizeWidth",value:A.uint},17026:{name:"docType",value:A.string},17031:{name:"docTypeVersion",value:A.uint},17029:{name:"docTypeReadVersion",value:A.uint}}},408125543:{name:"segment",container:{290298740:{name:"seekHead",container:{19899:{name:"seek",multiple:!0,container:{21419:{name:"id",value:A.binary},21420:{name:"position",value:A.uint}}}}},357149030:{name:"info",container:{29604:{name:"uid",value:A.uid},29572:{name:"filename",value:A.string},3979555:{name:"prevUID",value:A.uid},3965867:{name:"prevFilename",value:A.string},4110627:{name:"nextUID",value:A.uid},4096955:{name:"nextFilename",value:A.string},2807729:{name:"timecodeScale",value:A.uint},17545:{name:"duration",value:A.float},17505:{name:"dateUTC",value:A.uint},31657:{name:"title",value:A.string},19840:{name:"muxingApp",value:A.string},22337:{name:"writingApp",value:A.string}}},524531317:{name:"cluster",multiple:!0,container:{231:{name:"timecode",value:A.uid},22743:{name:"silentTracks ",multiple:!0},167:{name:"position",value:A.uid},171:{name:"prevSize",value:A.uid},160:{name:"blockGroup"},163:{name:"simpleBlock"}}},374648427:{name:"tracks",container:{174:{name:"entries",multiple:!0,container:{215:{name:"trackNumber",value:A.uint},29637:{name:"uid",value:A.uid},131:{name:"trackType",value:A.uint},185:{name:"flagEnabled",value:A.bool},136:{name:"flagDefault",value:A.bool},21930:{name:"flagForced",value:A.bool},156:{name:"flagLacing",value:A.bool},28135:{name:"minCache",value:A.uint},28136:{name:"maxCache",value:A.uint},2352003:{name:"defaultDuration",value:A.uint},2306383:{name:"timecodeScale",value:A.float},21358:{name:"name",value:A.string},2274716:{name:"language",value:A.string},134:{name:"codecID",value:A.string},25506:{name:"codecPrivate",value:A.binary},2459272:{name:"codecName",value:A.string},3839639:{name:"codecSettings",value:A.string},3883072:{name:"codecInfoUrl",value:A.string},2536e3:{name:"codecDownloadUrl",value:A.string},170:{name:"codecDecodeAll",value:A.bool},28587:{name:"trackOverlay",value:A.uint},224:{name:"video",container:{154:{name:"flagInterlaced",value:A.bool},21432:{name:"stereoMode",value:A.uint},176:{name:"pixelWidth",value:A.uint},186:{name:"pixelHeight",value:A.uint},21680:{name:"displayWidth",value:A.uint},21690:{name:"displayHeight",value:A.uint},21683:{name:"aspectRatioType",value:A.uint},3061028:{name:"colourSpace",value:A.uint},3126563:{name:"gammaValue",value:A.float}}},225:{name:"audio",container:{181:{name:"samplingFrequency",value:A.float},30901:{name:"outputSamplingFrequency",value:A.float},159:{name:"channels",value:A.uint},148:{name:"channels",value:A.uint},32123:{name:"channelPositions",value:A.binary},25188:{name:"bitDepth",value:A.uint}}},28032:{name:"contentEncodings",container:{25152:{name:"contentEncoding",container:{20529:{name:"order",value:A.uint},20530:{name:"scope",value:A.bool},20531:{name:"type",value:A.uint},20532:{name:"contentEncoding",container:{16980:{name:"contentCompAlgo",value:A.uint},16981:{name:"contentCompSettings",value:A.binary}}},20533:{name:"contentEncoding",container:{18401:{name:"contentEncAlgo",value:A.uint},18402:{name:"contentEncKeyID",value:A.binary},18403:{name:"contentSignature ",value:A.binary},18404:{name:"ContentSigKeyID  ",value:A.binary},18405:{name:"contentSigAlgo ",value:A.uint},18406:{name:"contentSigHashAlgo ",value:A.uint}}},25188:{name:"bitDepth",value:A.uint}}}}}}}}},475249515:{name:"cues",container:{187:{name:"cuePoint",container:{179:{name:"cueTime",value:A.uid},183:{name:"positions",container:{247:{name:"track",value:A.uint},241:{name:"clusterPosition",value:A.uint},21368:{name:"blockNumber",value:A.uint},234:{name:"codecState",value:A.uint},219:{name:"reference",container:{150:{name:"time",value:A.uint},151:{name:"cluster",value:A.uint},21343:{name:"number",value:A.uint},235:{name:"codecState",value:A.uint}}},240:{name:"relativePosition",value:A.uint}}}}}}},423732329:{name:"attachments",container:{24999:{name:"attachedFiles",multiple:!0,container:{18046:{name:"description",value:A.string},18030:{name:"name",value:A.string},18016:{name:"mimeType",value:A.string},18012:{name:"data",value:A.binary},18094:{name:"uid",value:A.uid}}}}},272869232:{name:"chapters",container:{17849:{name:"editionEntry",container:{182:{name:"chapterAtom",container:{29636:{name:"uid",value:A.uid},145:{name:"timeStart",value:A.uint},146:{name:"timeEnd",value:A.uid},152:{name:"hidden",value:A.bool},17816:{name:"enabled",value:A.uid},143:{name:"track",container:{137:{name:"trackNumber",value:A.uid},128:{name:"display",container:{133:{name:"string",value:A.string},17276:{name:"language ",value:A.string},17278:{name:"country ",value:A.string}}}}}}}}}}},307544935:{name:"tags",container:{29555:{name:"tag",multiple:!0,container:{25536:{name:"target",container:{25541:{name:"tagTrackUID",value:A.uid},25540:{name:"tagChapterUID",value:A.uint},25542:{name:"tagAttachmentUID",value:A.uid},25546:{name:"targetType",value:A.string},26826:{name:"targetTypeValue",value:A.uint},25545:{name:"tagEditionUID",value:A.uid}}},26568:{name:"simpleTags",multiple:!0,container:{17827:{name:"name",value:A.string},17543:{name:"string",value:A.string},17541:{name:"binary",value:A.binary},17530:{name:"language",value:A.string},17531:{name:"languageIETF",value:A.string},17540:{name:"default",value:A.bool}}}}}}}}}}},jo=Ne("music-metadata:parser:ebml");var cr;(function(t){t[t.ReadNext=0]="ReadNext",t[t.IgnoreElement=2]="IgnoreElement",t[t.SkipSiblings=3]="SkipSiblings",t[t.TerminateParsing=4]="TerminateParsing",t[t.SkipElement=5]="SkipElement"})(cr||(cr={}));class lL{constructor(e){this.tokenizer=e,this.padding=0,this.parserMap=new Map,this.ebmlMaxIDLength=4,this.ebmlMaxSizeLength=8,this.parserMap.set(A.uint,n=>this.readUint(n)),this.parserMap.set(A.string,n=>this.readString(n)),this.parserMap.set(A.binary,n=>this.readBuffer(n)),this.parserMap.set(A.uid,async n=>this.readBuffer(n)),this.parserMap.set(A.bool,n=>this.readFlag(n)),this.parserMap.set(A.float,n=>this.readFloat(n))}async iterate(e,n,r){return this.parseContainer(qT(e),n,r)}async parseContainer(e,n,r){const i={};for(;this.tokenizer.position<n;){let s;const o=this.tokenizer.position;try{s=await this.readElement()}catch(l){if(l instanceof it)break;throw l}const a=e.container[s.id];if(a)switch(r.startNext(a)){case cr.ReadNext:if(s.id,jo(`Read element: name=${As(a)}{id=0x${s.id.toString(16)}, container=${!!a.container}} at position=${o}`),a.container){const c=await this.parseContainer(a,s.len>=0?this.tokenizer.position+s.len:-1,r);a.multiple?(i[a.name]||(i[a.name]=[]),i[a.name].push(c)):i[a.name]=c,await r.elementValue(a,c,o)}else{const c=this.parserMap.get(a.value);if(typeof c=="function"){const d=await c(s);i[a.name]=d,await r.elementValue(a,d,o)}}break;case cr.SkipElement:jo(`Go to next element: name=${As(a)}, element.id=0x${s.id}, container=${!!a.container} at position=${o}`);break;case cr.IgnoreElement:jo(`Ignore element: name=${As(a)}, element.id=0x${s.id}, container=${!!a.container} at position=${o}`),await this.tokenizer.ignore(s.len);break;case cr.SkipSiblings:jo(`Ignore remaining container, at: name=${As(a)}, element.id=0x${s.id}, container=${!!a.container} at position=${o}`),await this.tokenizer.ignore(n-this.tokenizer.position);break;case cr.TerminateParsing:return jo(`Terminate parsing at element: name=${As(a)}, element.id=0x${s.id}, container=${!!a.container} at position=${o}`),i}else switch(s.id){case 236:this.padding+=s.len,await this.tokenizer.ignore(s.len);break;default:jo(`parseEbml: parent=${As(e)}, unknown child: id=${s.id.toString(16)} at position=${o}`),this.padding+=s.len,await this.tokenizer.ignore(s.len)}}return i}async readVintData(e){const n=await this.tokenizer.peekNumber(he);let r=128,i=1;for(;!(n&r);){if(i>e)throw new Error("VINT value exceeding maximum size");++i,r>>=1}const s=new Uint8Array(i);return await this.tokenizer.readBuffer(s),s}async readElement(){const e=await this.readVintData(this.ebmlMaxIDLength),n=await this.readVintData(this.ebmlMaxSizeLength);return n[0]^=128>>n.length-1,{id:zp(e,e.length),len:zp(n,n.length)}}async readFloat(e){switch(e.len){case 0:return 0;case 4:return this.tokenizer.readNumber(AT);case 8:return this.tokenizer.readNumber(N0);case 10:return this.tokenizer.readNumber(N0);default:throw new Error(`Invalid IEEE-754 float length: ${e.len}`)}}async readFlag(e){return await this.readUint(e)===1}async readUint(e){const n=await this.readBuffer(e);return zp(n,e.len)}async readString(e){return(await this.tokenizer.readToken(new ne(e.len,"utf-8"))).replace(/\x00.*$/g,"")}async readBuffer(e){const n=new Uint8Array(e.len);return await this.tokenizer.readBuffer(n),n}}function zp(t,e){return Number(cL(t,e))}function cL(t,e){const n=new Uint8Array(8),r=t.subarray(0,e);try{return n.set(r,8-e),Xv.get(n,0)}catch{return BigInt(-1)}}function qT(t){return t.container&&Object.keys(t.container).map(e=>{const n=t.container[e];return n.id=Number.parseInt(e),n}).forEach(e=>{e.parent=t,qT(e)}),t}function As(t){let e="";return t.parent&&t.parent.name!=="dtd"&&(e+=`${As(t.parent)}/`),e+t.name}const nd=Ne("music-metadata:parser:matroska");class uL extends Bn{constructor(){super(...arguments),this.seekHeadOffset=0,this.flagUseIndexToSkipClusters=!1}init(e,n,r){return super.init(e,n,r),this.flagUseIndexToSkipClusters=r.mkvUseIndex??!1,this}async parse(){const e=this.tokenizer.fileInfo.size??Number.MAX_SAFE_INTEGER,n=new lL(this.tokenizer);nd("Initializing DTD end MatroskaIterator"),await n.iterate(aL,e,{startNext:r=>{switch(r.id){case 475249515:return nd(`Skip element: name=${r.name}, id=0x${r.id.toString(16)}`),cr.IgnoreElement;case 524531317:if(this.flagUseIndexToSkipClusters&&this.seekHead){const i=this.seekHead.seek.find(s=>s.position+this.seekHeadOffset>this.tokenizer.position);if(i){const s=i.position+this.seekHeadOffset-this.tokenizer.position;return nd(`Use index to go to next position, ignoring ${s} bytes`),this.tokenizer.ignore(s),cr.SkipElement}}return cr.IgnoreElement;default:return cr.ReadNext}},elementValue:async(r,i,s)=>{switch(nd(`Received: name=${r.name}, value=${i}`),r.id){case 17026:this.metadata.setFormat("container",`EBML/${i}`);break;case 290298740:this.seekHead=i,this.seekHeadOffset=s;break;case 357149030:{const o=i,a=o.timecodeScale?o.timecodeScale:1e6;if(typeof o.duration=="number"){const l=o.duration*a/1e9;await this.addTag("segment:title",o.title),this.metadata.setFormat("duration",Number(l))}}break;case 374648427:{const o=i;if(o!=null&&o.entries){o.entries.forEach(l=>{const c={codecName:l.codecID.replace("A_","").replace("V_",""),codecSettings:l.codecSettings,flagDefault:l.flagDefault,flagLacing:l.flagLacing,flagEnabled:l.flagEnabled,language:l.language,name:l.name,type:l.trackType,audio:l.audio,video:l.video};this.metadata.addStreamInfo(c)});const a=o.entries.filter(l=>l.trackType===Zs.audio).reduce((l,c)=>!l||c.flagDefault&&!l.flagDefault||c.trackNumber<l.trackNumber?c:l,null);a&&(this.metadata.setFormat("codec",a.codecID.replace("A_","")),this.metadata.setFormat("sampleRate",a.audio.samplingFrequency),this.metadata.setFormat("numberOfChannels",a.audio.channels))}}break;case 307544935:{const o=i;await Promise.all(o.tag.map(async a=>{const l=a.target,c=l!=null&&l.targetTypeValue?j0[l.targetTypeValue]:l!=null&&l.targetType?l.targetType:"track";await Promise.all(a.simpleTags.map(async d=>{const h=d.string?d.string:d.binary;await this.addTag(`${c}:${d.name}`,h)}))}))}break;case 423732329:{const o=i;await Promise.all(o.attachedFiles.filter(a=>a.mimeType.startsWith("image/")).map(a=>this.addTag("picture",{data:a.data,format:a.mimeType,description:a.description,name:a.name})))}break}}})}async addTag(e,n){await this.metadata.addTag("matroska",e,n)}}const Ah=Ne("music-metadata:parser:factory");function dL(t){const e=Jv.parse(t),n=cM(e.type);return{type:n.type,subtype:n.subtype,suffix:n.suffix,parameters:e.parameters}}async function hL(t,e){const{mimeType:n,path:r,url:i}=t.fileInfo,s=GT(n)||W0(r)||W0(i);return s||Ah(`No parser found for MIME-type / extension: ${n}`),fL(t,s,e)}async function fL(t,e,n){if(!e){Ah("Guess parser on content...");const s=new Uint8Array(4100);if(await t.peekBuffer(s,{mayBeLess:!0}),t.fileInfo.path&&(e=W0(t.fileInfo.path)),!e){const o=await jT(s);if(!o)throw new Error("Failed to determine audio format");if(Ah(`Guessed file type is mime=${o.mime}, extension=${o.ext}`),e=GT(o.mime),!e)throw new Error(`Guessed MIME-type not supported: ${o.mime}`)}}const r=await mL(e),i=new VM(n);return await r.init(i,t,n??{}).parse(),i.toCommonMetadata()}function W0(t){if(!t)return;switch(pL(t).toLocaleLowerCase()||t){case".mp2":case".mp3":case".m2a":case".aac":return"mpeg";case".ape":return"apev2";case".mp4":case".m4a":case".m4b":case".m4pa":case".m4v":case".m4r":case".3gp":return"mp4";case".wma":case".wmv":case".asf":return"asf";case".flac":return"flac";case".ogg":case".ogv":case".oga":case".ogm":case".ogx":case".opus":case".spx":return"ogg";case".aif":case".aiff":case".aifc":return"aiff";case".wav":case".bwf":return"riff";case".wv":case".wvp":return"wavpack";case".mpc":return"musepack";case".dsf":return"dsf";case".dff":return"dsdiff";case".mka":case".mkv":case".mk3d":case".mks":case".webm":return"matroska"}}async function mL(t){switch(t){case"aiff":return new XM;case"adts":case"mpeg":return new O6;case"apev2":return new kr;case"asf":return new a6;case"dsf":return new sL;case"dsdiff":return new oL;case"flac":return new u6;case"mp4":return new Ih;case"musepack":return new U6;case"ogg":return new $f;case"riff":return new eL;case"wavpack":return new nL;case"matroska":return new uL;default:throw new Error(`Unknown parser type: ${t}`)}}function pL(t){const e=t.lastIndexOf(".");return e===-1?"":t.slice(e)}function GT(t){let e;if(!t)return;try{e=dL(t)}catch{Ah(`Invalid HTTP Content-Type header value: ${t}`);return}const n=e.subtype.indexOf("x-")===0?e.subtype.substring(2):e.subtype;switch(e.type){case"audio":switch(n){case"mp3":case"mpeg":return"mpeg";case"aac":case"aacp":return"adts";case"flac":return"flac";case"ape":case"monkeys-audio":return"apev2";case"mp4":case"m4a":return"mp4";case"ogg":case"opus":case"speex":return"ogg";case"ms-wma":case"ms-wmv":case"ms-asf":return"asf";case"aiff":case"aif":case"aifc":return"aiff";case"vnd.wave":case"wav":case"wave":return"riff";case"wavpack":return"wavpack";case"musepack":return"musepack";case"matroska":case"webm":return"matroska";case"dsf":return"dsf"}break;case"video":switch(n){case"ms-asf":case"ms-wmv":return"asf";case"m4v":case"mp4":return"mp4";case"ogg":return"ogg";case"matroska":case"webm":return"matroska"}break;case"application":switch(n){case"vnd.ms-asf":return"asf";case"ogg":return"ogg"}break}}async function gL(t,e={}){const n={mimeType:t.type,size:t.size};return t instanceof File&&(n.path=t.name),yL(t.stream(),n,e)}function yL(t,e,n={}){return vL(IT(t,{fileInfo:typeof e=="string"?{mimeType:e}:e}),n)}function vL(t,e){return hL(t,e)}let Rh=(t=21)=>crypto.getRandomValues(new Uint8Array(t)).reduce((e,n)=>(n&=63,n<36?e+=n.toString(36):n<62?e+=(n-26).toString(36).toUpperCase():n>62?e+="-":e+="_",e),"");function KT(t,e){return function(){return t.apply(e,arguments)}}const{toString:xL}=Object.prototype,{getPrototypeOf:sx}=Object,zf=(t=>e=>{const n=xL.call(e);return t[n]||(t[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),Vr=t=>(t=t.toLowerCase(),e=>zf(e)===t),Bf=t=>e=>typeof e===t,{isArray:Ya}=Array,Sc=Bf("undefined");function wL(t){return t!==null&&!Sc(t)&&t.constructor!==null&&!Sc(t.constructor)&&Yn(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const XT=Vr("ArrayBuffer");function _L(t){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&XT(t.buffer),e}const EL=Bf("string"),Yn=Bf("function"),QT=Bf("number"),Vf=t=>t!==null&&typeof t=="object",SL=t=>t===!0||t===!1,Nd=t=>{if(zf(t)!=="object")return!1;const e=sx(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},bL=Vr("Date"),kL=Vr("File"),TL=Vr("Blob"),IL=Vr("FileList"),CL=t=>Vf(t)&&Yn(t.pipe),AL=t=>{let e;return t&&(typeof FormData=="function"&&t instanceof FormData||Yn(t.append)&&((e=zf(t))==="formdata"||e==="object"&&Yn(t.toString)&&t.toString()==="[object FormData]"))},RL=Vr("URLSearchParams"),PL=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function tu(t,e,{allOwnKeys:n=!1}={}){if(t===null||typeof t>"u")return;let r,i;if(typeof t!="object"&&(t=[t]),Ya(t))for(r=0,i=t.length;r<i;r++)e.call(null,t[r],r,t);else{const s=n?Object.getOwnPropertyNames(t):Object.keys(t),o=s.length;let a;for(r=0;r<o;r++)a=s[r],e.call(null,t[a],a,t)}}function YT(t,e){e=e.toLowerCase();const n=Object.keys(t);let r=n.length,i;for(;r-- >0;)if(i=n[r],e===i.toLowerCase())return i;return null}const JT=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),ZT=t=>!Sc(t)&&t!==JT;function H0(){const{caseless:t}=ZT(this)&&this||{},e={},n=(r,i)=>{const s=t&&YT(e,i)||i;Nd(e[s])&&Nd(r)?e[s]=H0(e[s],r):Nd(r)?e[s]=H0({},r):Ya(r)?e[s]=r.slice():e[s]=r};for(let r=0,i=arguments.length;r<i;r++)arguments[r]&&tu(arguments[r],n);return e}const NL=(t,e,n,{allOwnKeys:r}={})=>(tu(e,(i,s)=>{n&&Yn(i)?t[s]=KT(i,n):t[s]=i},{allOwnKeys:r}),t),DL=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),jL=(t,e,n,r)=>{t.prototype=Object.create(e.prototype,r),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),n&&Object.assign(t.prototype,n)},OL=(t,e,n,r)=>{let i,s,o;const a={};if(e=e||{},t==null)return e;do{for(i=Object.getOwnPropertyNames(t),s=i.length;s-- >0;)o=i[s],(!r||r(o,t,e))&&!a[o]&&(e[o]=t[o],a[o]=!0);t=n!==!1&&sx(t)}while(t&&(!n||n(t,e))&&t!==Object.prototype);return e},ML=(t,e,n)=>{t=String(t),(n===void 0||n>t.length)&&(n=t.length),n-=e.length;const r=t.indexOf(e,n);return r!==-1&&r===n},LL=t=>{if(!t)return null;if(Ya(t))return t;let e=t.length;if(!QT(e))return null;const n=new Array(e);for(;e-- >0;)n[e]=t[e];return n},FL=(t=>e=>t&&e instanceof t)(typeof Uint8Array<"u"&&sx(Uint8Array)),$L=(t,e)=>{const r=(t&&t[Symbol.iterator]).call(t);let i;for(;(i=r.next())&&!i.done;){const s=i.value;e.call(t,s[0],s[1])}},zL=(t,e)=>{let n;const r=[];for(;(n=t.exec(e))!==null;)r.push(n);return r},BL=Vr("HTMLFormElement"),VL=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,r,i){return r.toUpperCase()+i}),pE=(({hasOwnProperty:t})=>(e,n)=>t.call(e,n))(Object.prototype),UL=Vr("RegExp"),eI=(t,e)=>{const n=Object.getOwnPropertyDescriptors(t),r={};tu(n,(i,s)=>{let o;(o=e(i,s,t))!==!1&&(r[s]=o||i)}),Object.defineProperties(t,r)},WL=t=>{eI(t,(e,n)=>{if(Yn(t)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const r=t[n];if(Yn(r)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},HL=(t,e)=>{const n={},r=i=>{i.forEach(s=>{n[s]=!0})};return Ya(t)?r(t):r(String(t).split(e)),n},qL=()=>{},GL=(t,e)=>(t=+t,Number.isFinite(t)?t:e),Bp="abcdefghijklmnopqrstuvwxyz",gE="0123456789",tI={DIGIT:gE,ALPHA:Bp,ALPHA_DIGIT:Bp+Bp.toUpperCase()+gE},KL=(t=16,e=tI.ALPHA_DIGIT)=>{let n="";const{length:r}=e;for(;t--;)n+=e[Math.random()*r|0];return n};function XL(t){return!!(t&&Yn(t.append)&&t[Symbol.toStringTag]==="FormData"&&t[Symbol.iterator])}const QL=t=>{const e=new Array(10),n=(r,i)=>{if(Vf(r)){if(e.indexOf(r)>=0)return;if(!("toJSON"in r)){e[i]=r;const s=Ya(r)?[]:{};return tu(r,(o,a)=>{const l=n(o,i+1);!Sc(l)&&(s[a]=l)}),e[i]=void 0,s}}return r};return n(t,0)},YL=Vr("AsyncFunction"),JL=t=>t&&(Vf(t)||Yn(t))&&Yn(t.then)&&Yn(t.catch),N={isArray:Ya,isArrayBuffer:XT,isBuffer:wL,isFormData:AL,isArrayBufferView:_L,isString:EL,isNumber:QT,isBoolean:SL,isObject:Vf,isPlainObject:Nd,isUndefined:Sc,isDate:bL,isFile:kL,isBlob:TL,isRegExp:UL,isFunction:Yn,isStream:CL,isURLSearchParams:RL,isTypedArray:FL,isFileList:IL,forEach:tu,merge:H0,extend:NL,trim:PL,stripBOM:DL,inherits:jL,toFlatObject:OL,kindOf:zf,kindOfTest:Vr,endsWith:ML,toArray:LL,forEachEntry:$L,matchAll:zL,isHTMLForm:BL,hasOwnProperty:pE,hasOwnProp:pE,reduceDescriptors:eI,freezeMethods:WL,toObjectSet:HL,toCamelCase:VL,noop:qL,toFiniteNumber:GL,findKey:YT,global:JT,isContextDefined:ZT,ALPHABET:tI,generateString:KL,isSpecCompliantForm:XL,toJSONObject:QL,isAsyncFn:YL,isThenable:JL};function xe(t,e,n,r,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",e&&(this.code=e),n&&(this.config=n),r&&(this.request=r),i&&(this.response=i)}N.inherits(xe,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:N.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const nI=xe.prototype,rI={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{rI[t]={value:t}});Object.defineProperties(xe,rI);Object.defineProperty(nI,"isAxiosError",{value:!0});xe.from=(t,e,n,r,i,s)=>{const o=Object.create(nI);return N.toFlatObject(t,o,function(l){return l!==Error.prototype},a=>a!=="isAxiosError"),xe.call(o,t.message,e,n,r,i),o.cause=t,o.name=t.name,s&&Object.assign(o,s),o};const ZL=null;function q0(t){return N.isPlainObject(t)||N.isArray(t)}function iI(t){return N.endsWith(t,"[]")?t.slice(0,-2):t}function yE(t,e,n){return t?t.concat(e).map(function(i,s){return i=iI(i),!n&&s?"["+i+"]":i}).join(n?".":""):e}function eF(t){return N.isArray(t)&&!t.some(q0)}const tF=N.toFlatObject(N,{},null,function(e){return/^is[A-Z]/.test(e)});function Uf(t,e,n){if(!N.isObject(t))throw new TypeError("target must be an object");e=e||new FormData,n=N.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(x,E){return!N.isUndefined(E[x])});const r=n.metaTokens,i=n.visitor||d,s=n.dots,o=n.indexes,l=(n.Blob||typeof Blob<"u"&&Blob)&&N.isSpecCompliantForm(e);if(!N.isFunction(i))throw new TypeError("visitor must be a function");function c(y){if(y===null)return"";if(N.isDate(y))return y.toISOString();if(!l&&N.isBlob(y))throw new xe("Blob is not supported. Use a Buffer instead.");return N.isArrayBuffer(y)||N.isTypedArray(y)?l&&typeof Blob=="function"?new Blob([y]):Buffer.from(y):y}function d(y,x,E){let v=y;if(y&&!E&&typeof y=="object"){if(N.endsWith(x,"{}"))x=r?x:x.slice(0,-2),y=JSON.stringify(y);else if(N.isArray(y)&&eF(y)||(N.isFileList(y)||N.endsWith(x,"[]"))&&(v=N.toArray(y)))return x=iI(x),v.forEach(function(w,_){!(N.isUndefined(w)||w===null)&&e.append(o===!0?yE([x],_,s):o===null?x:x+"[]",c(w))}),!1}return q0(y)?!0:(e.append(yE(E,x,s),c(y)),!1)}const h=[],m=Object.assign(tF,{defaultVisitor:d,convertValue:c,isVisitable:q0});function p(y,x){if(!N.isUndefined(y)){if(h.indexOf(y)!==-1)throw Error("Circular reference detected in "+x.join("."));h.push(y),N.forEach(y,function(v,g){(!(N.isUndefined(v)||v===null)&&i.call(e,v,N.isString(g)?g.trim():g,x,m))===!0&&p(v,x?x.concat(g):[g])}),h.pop()}}if(!N.isObject(t))throw new TypeError("data must be an object");return p(t),e}function vE(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(r){return e[r]})}function ox(t,e){this._pairs=[],t&&Uf(t,this,e)}const sI=ox.prototype;sI.append=function(e,n){this._pairs.push([e,n])};sI.toString=function(e){const n=e?function(r){return e.call(this,r,vE)}:vE;return this._pairs.map(function(i){return n(i[0])+"="+n(i[1])},"").join("&")};function nF(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function oI(t,e,n){if(!e)return t;const r=n&&n.encode||nF,i=n&&n.serialize;let s;if(i?s=i(e,n):s=N.isURLSearchParams(e)?e.toString():new ox(e,n).toString(r),s){const o=t.indexOf("#");o!==-1&&(t=t.slice(0,o)),t+=(t.indexOf("?")===-1?"?":"&")+s}return t}class rF{constructor(){this.handlers=[]}use(e,n,r){return this.handlers.push({fulfilled:e,rejected:n,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){N.forEach(this.handlers,function(r){r!==null&&e(r)})}}const xE=rF,aI={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},iF=typeof URLSearchParams<"u"?URLSearchParams:ox,sF=typeof FormData<"u"?FormData:null,oF=typeof Blob<"u"?Blob:null,aF=(()=>{let t;return typeof navigator<"u"&&((t=navigator.product)==="ReactNative"||t==="NativeScript"||t==="NS")?!1:typeof window<"u"&&typeof document<"u"})(),lF=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),Tr={isBrowser:!0,classes:{URLSearchParams:iF,FormData:sF,Blob:oF},isStandardBrowserEnv:aF,isStandardBrowserWebWorkerEnv:lF,protocols:["http","https","file","blob","url","data"]};function cF(t,e){return Uf(t,new Tr.classes.URLSearchParams,Object.assign({visitor:function(n,r,i,s){return Tr.isNode&&N.isBuffer(n)?(this.append(r,n.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)}},e))}function uF(t){return N.matchAll(/\w+|\[(\w*)]/g,t).map(e=>e[0]==="[]"?"":e[1]||e[0])}function dF(t){const e={},n=Object.keys(t);let r;const i=n.length;let s;for(r=0;r<i;r++)s=n[r],e[s]=t[s];return e}function lI(t){function e(n,r,i,s){let o=n[s++];const a=Number.isFinite(+o),l=s>=n.length;return o=!o&&N.isArray(i)?i.length:o,l?(N.hasOwnProp(i,o)?i[o]=[i[o],r]:i[o]=r,!a):((!i[o]||!N.isObject(i[o]))&&(i[o]=[]),e(n,r,i[o],s)&&N.isArray(i[o])&&(i[o]=dF(i[o])),!a)}if(N.isFormData(t)&&N.isFunction(t.entries)){const n={};return N.forEachEntry(t,(r,i)=>{e(uF(r),i,n,0)}),n}return null}function hF(t,e,n){if(N.isString(t))try{return(e||JSON.parse)(t),N.trim(t)}catch(r){if(r.name!=="SyntaxError")throw r}return(n||JSON.stringify)(t)}const ax={transitional:aI,adapter:["xhr","http"],transformRequest:[function(e,n){const r=n.getContentType()||"",i=r.indexOf("application/json")>-1,s=N.isObject(e);if(s&&N.isHTMLForm(e)&&(e=new FormData(e)),N.isFormData(e))return i&&i?JSON.stringify(lI(e)):e;if(N.isArrayBuffer(e)||N.isBuffer(e)||N.isStream(e)||N.isFile(e)||N.isBlob(e))return e;if(N.isArrayBufferView(e))return e.buffer;if(N.isURLSearchParams(e))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let a;if(s){if(r.indexOf("application/x-www-form-urlencoded")>-1)return cF(e,this.formSerializer).toString();if((a=N.isFileList(e))||r.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return Uf(a?{"files[]":e}:e,l&&new l,this.formSerializer)}}return s||i?(n.setContentType("application/json",!1),hF(e)):e}],transformResponse:[function(e){const n=this.transitional||ax.transitional,r=n&&n.forcedJSONParsing,i=this.responseType==="json";if(e&&N.isString(e)&&(r&&!this.responseType||i)){const o=!(n&&n.silentJSONParsing)&&i;try{return JSON.parse(e)}catch(a){if(o)throw a.name==="SyntaxError"?xe.from(a,xe.ERR_BAD_RESPONSE,this,null,this.response):a}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Tr.classes.FormData,Blob:Tr.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};N.forEach(["delete","get","head","post","put","patch"],t=>{ax.headers[t]={}});const lx=ax,fF=N.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),mF=t=>{const e={};let n,r,i;return t&&t.split(`
`).forEach(function(o){i=o.indexOf(":"),n=o.substring(0,i).trim().toLowerCase(),r=o.substring(i+1).trim(),!(!n||e[n]&&fF[n])&&(n==="set-cookie"?e[n]?e[n].push(r):e[n]=[r]:e[n]=e[n]?e[n]+", "+r:r)}),e},wE=Symbol("internals");function xl(t){return t&&String(t).trim().toLowerCase()}function Dd(t){return t===!1||t==null?t:N.isArray(t)?t.map(Dd):String(t)}function pF(t){const e=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(t);)e[r[1]]=r[2];return e}const gF=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function Vp(t,e,n,r,i){if(N.isFunction(r))return r.call(this,e,n);if(i&&(e=n),!!N.isString(e)){if(N.isString(r))return e.indexOf(r)!==-1;if(N.isRegExp(r))return r.test(e)}}function yF(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,n,r)=>n.toUpperCase()+r)}function vF(t,e){const n=N.toCamelCase(" "+e);["get","set","has"].forEach(r=>{Object.defineProperty(t,r+n,{value:function(i,s,o){return this[r].call(this,e,i,s,o)},configurable:!0})})}class Wf{constructor(e){e&&this.set(e)}set(e,n,r){const i=this;function s(a,l,c){const d=xl(l);if(!d)throw new Error("header name must be a non-empty string");const h=N.findKey(i,d);(!h||i[h]===void 0||c===!0||c===void 0&&i[h]!==!1)&&(i[h||l]=Dd(a))}const o=(a,l)=>N.forEach(a,(c,d)=>s(c,d,l));return N.isPlainObject(e)||e instanceof this.constructor?o(e,n):N.isString(e)&&(e=e.trim())&&!gF(e)?o(mF(e),n):e!=null&&s(n,e,r),this}get(e,n){if(e=xl(e),e){const r=N.findKey(this,e);if(r){const i=this[r];if(!n)return i;if(n===!0)return pF(i);if(N.isFunction(n))return n.call(this,i,r);if(N.isRegExp(n))return n.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,n){if(e=xl(e),e){const r=N.findKey(this,e);return!!(r&&this[r]!==void 0&&(!n||Vp(this,this[r],r,n)))}return!1}delete(e,n){const r=this;let i=!1;function s(o){if(o=xl(o),o){const a=N.findKey(r,o);a&&(!n||Vp(r,r[a],a,n))&&(delete r[a],i=!0)}}return N.isArray(e)?e.forEach(s):s(e),i}clear(e){const n=Object.keys(this);let r=n.length,i=!1;for(;r--;){const s=n[r];(!e||Vp(this,this[s],s,e,!0))&&(delete this[s],i=!0)}return i}normalize(e){const n=this,r={};return N.forEach(this,(i,s)=>{const o=N.findKey(r,s);if(o){n[o]=Dd(i),delete n[s];return}const a=e?yF(s):String(s).trim();a!==s&&delete n[s],n[a]=Dd(i),r[a]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const n=Object.create(null);return N.forEach(this,(r,i)=>{r!=null&&r!==!1&&(n[i]=e&&N.isArray(r)?r.join(", "):r)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,n])=>e+": "+n).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...n){const r=new this(e);return n.forEach(i=>r.set(i)),r}static accessor(e){const r=(this[wE]=this[wE]={accessors:{}}).accessors,i=this.prototype;function s(o){const a=xl(o);r[a]||(vF(i,o),r[a]=!0)}return N.isArray(e)?e.forEach(s):s(e),this}}Wf.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);N.reduceDescriptors(Wf.prototype,({value:t},e)=>{let n=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(r){this[n]=r}}});N.freezeMethods(Wf);const ii=Wf;function Up(t,e){const n=this||lx,r=e||n,i=ii.from(r.headers);let s=r.data;return N.forEach(t,function(a){s=a.call(n,s,i.normalize(),e?e.status:void 0)}),i.normalize(),s}function cI(t){return!!(t&&t.__CANCEL__)}function nu(t,e,n){xe.call(this,t??"canceled",xe.ERR_CANCELED,e,n),this.name="CanceledError"}N.inherits(nu,xe,{__CANCEL__:!0});function xF(t,e,n){const r=n.config.validateStatus;!n.status||!r||r(n.status)?t(n):e(new xe("Request failed with status code "+n.status,[xe.ERR_BAD_REQUEST,xe.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}const wF=Tr.isStandardBrowserEnv?function(){return{write:function(n,r,i,s,o,a){const l=[];l.push(n+"="+encodeURIComponent(r)),N.isNumber(i)&&l.push("expires="+new Date(i).toGMTString()),N.isString(s)&&l.push("path="+s),N.isString(o)&&l.push("domain="+o),a===!0&&l.push("secure"),document.cookie=l.join("; ")},read:function(n){const r=document.cookie.match(new RegExp("(^|;\\s*)("+n+")=([^;]*)"));return r?decodeURIComponent(r[3]):null},remove:function(n){this.write(n,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}();function _F(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function EF(t,e){return e?t.replace(/\/+$/,"")+"/"+e.replace(/^\/+/,""):t}function uI(t,e){return t&&!_F(e)?EF(t,e):e}const SF=Tr.isStandardBrowserEnv?function(){const e=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");let r;function i(s){let o=s;return e&&(n.setAttribute("href",o),o=n.href),n.setAttribute("href",o),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:n.pathname.charAt(0)==="/"?n.pathname:"/"+n.pathname}}return r=i(window.location.href),function(o){const a=N.isString(o)?i(o):o;return a.protocol===r.protocol&&a.host===r.host}}():function(){return function(){return!0}}();function bF(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}function kF(t,e){t=t||10;const n=new Array(t),r=new Array(t);let i=0,s=0,o;return e=e!==void 0?e:1e3,function(l){const c=Date.now(),d=r[s];o||(o=c),n[i]=l,r[i]=c;let h=s,m=0;for(;h!==i;)m+=n[h++],h=h%t;if(i=(i+1)%t,i===s&&(s=(s+1)%t),c-o<e)return;const p=d&&c-d;return p?Math.round(m*1e3/p):void 0}}function _E(t,e){let n=0;const r=kF(50,250);return i=>{const s=i.loaded,o=i.lengthComputable?i.total:void 0,a=s-n,l=r(a),c=s<=o;n=s;const d={loaded:s,total:o,progress:o?s/o:void 0,bytes:a,rate:l||void 0,estimated:l&&o&&c?(o-s)/l:void 0,event:i};d[e?"download":"upload"]=!0,t(d)}}const TF=typeof XMLHttpRequest<"u",IF=TF&&function(t){return new Promise(function(n,r){let i=t.data;const s=ii.from(t.headers).normalize(),o=t.responseType;let a;function l(){t.cancelToken&&t.cancelToken.unsubscribe(a),t.signal&&t.signal.removeEventListener("abort",a)}let c;N.isFormData(i)&&(Tr.isStandardBrowserEnv||Tr.isStandardBrowserWebWorkerEnv?s.setContentType(!1):s.getContentType(/^\s*multipart\/form-data/)?N.isString(c=s.getContentType())&&s.setContentType(c.replace(/^\s*(multipart\/form-data);+/,"$1")):s.setContentType("multipart/form-data"));let d=new XMLHttpRequest;if(t.auth){const y=t.auth.username||"",x=t.auth.password?unescape(encodeURIComponent(t.auth.password)):"";s.set("Authorization","Basic "+btoa(y+":"+x))}const h=uI(t.baseURL,t.url);d.open(t.method.toUpperCase(),oI(h,t.params,t.paramsSerializer),!0),d.timeout=t.timeout;function m(){if(!d)return;const y=ii.from("getAllResponseHeaders"in d&&d.getAllResponseHeaders()),E={data:!o||o==="text"||o==="json"?d.responseText:d.response,status:d.status,statusText:d.statusText,headers:y,config:t,request:d};xF(function(g){n(g),l()},function(g){r(g),l()},E),d=null}if("onloadend"in d?d.onloadend=m:d.onreadystatechange=function(){!d||d.readyState!==4||d.status===0&&!(d.responseURL&&d.responseURL.indexOf("file:")===0)||setTimeout(m)},d.onabort=function(){d&&(r(new xe("Request aborted",xe.ECONNABORTED,t,d)),d=null)},d.onerror=function(){r(new xe("Network Error",xe.ERR_NETWORK,t,d)),d=null},d.ontimeout=function(){let x=t.timeout?"timeout of "+t.timeout+"ms exceeded":"timeout exceeded";const E=t.transitional||aI;t.timeoutErrorMessage&&(x=t.timeoutErrorMessage),r(new xe(x,E.clarifyTimeoutError?xe.ETIMEDOUT:xe.ECONNABORTED,t,d)),d=null},Tr.isStandardBrowserEnv){const y=SF(h)&&t.xsrfCookieName&&wF.read(t.xsrfCookieName);y&&s.set(t.xsrfHeaderName,y)}i===void 0&&s.setContentType(null),"setRequestHeader"in d&&N.forEach(s.toJSON(),function(x,E){d.setRequestHeader(E,x)}),N.isUndefined(t.withCredentials)||(d.withCredentials=!!t.withCredentials),o&&o!=="json"&&(d.responseType=t.responseType),typeof t.onDownloadProgress=="function"&&d.addEventListener("progress",_E(t.onDownloadProgress,!0)),typeof t.onUploadProgress=="function"&&d.upload&&d.upload.addEventListener("progress",_E(t.onUploadProgress)),(t.cancelToken||t.signal)&&(a=y=>{d&&(r(!y||y.type?new nu(null,t,d):y),d.abort(),d=null)},t.cancelToken&&t.cancelToken.subscribe(a),t.signal&&(t.signal.aborted?a():t.signal.addEventListener("abort",a)));const p=bF(h);if(p&&Tr.protocols.indexOf(p)===-1){r(new xe("Unsupported protocol "+p+":",xe.ERR_BAD_REQUEST,t));return}d.send(i||null)})},G0={http:ZL,xhr:IF};N.forEach(G0,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch{}Object.defineProperty(t,"adapterName",{value:e})}});const EE=t=>`- ${t}`,CF=t=>N.isFunction(t)||t===null||t===!1,dI={getAdapter:t=>{t=N.isArray(t)?t:[t];const{length:e}=t;let n,r;const i={};for(let s=0;s<e;s++){n=t[s];let o;if(r=n,!CF(n)&&(r=G0[(o=String(n)).toLowerCase()],r===void 0))throw new xe(`Unknown adapter '${o}'`);if(r)break;i[o||"#"+s]=r}if(!r){const s=Object.entries(i).map(([a,l])=>`adapter ${a} `+(l===!1?"is not supported by the environment":"is not available in the build"));let o=e?s.length>1?`since :
`+s.map(EE).join(`
`):" "+EE(s[0]):"as no adapter specified";throw new xe("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return r},adapters:G0};function Wp(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new nu(null,t)}function SE(t){return Wp(t),t.headers=ii.from(t.headers),t.data=Up.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),dI.getAdapter(t.adapter||lx.adapter)(t).then(function(r){return Wp(t),r.data=Up.call(t,t.transformResponse,r),r.headers=ii.from(r.headers),r},function(r){return cI(r)||(Wp(t),r&&r.response&&(r.response.data=Up.call(t,t.transformResponse,r.response),r.response.headers=ii.from(r.response.headers))),Promise.reject(r)})}const bE=t=>t instanceof ii?t.toJSON():t;function Ca(t,e){e=e||{};const n={};function r(c,d,h){return N.isPlainObject(c)&&N.isPlainObject(d)?N.merge.call({caseless:h},c,d):N.isPlainObject(d)?N.merge({},d):N.isArray(d)?d.slice():d}function i(c,d,h){if(N.isUndefined(d)){if(!N.isUndefined(c))return r(void 0,c,h)}else return r(c,d,h)}function s(c,d){if(!N.isUndefined(d))return r(void 0,d)}function o(c,d){if(N.isUndefined(d)){if(!N.isUndefined(c))return r(void 0,c)}else return r(void 0,d)}function a(c,d,h){if(h in e)return r(c,d);if(h in t)return r(void 0,c)}const l={url:s,method:s,data:s,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:a,headers:(c,d)=>i(bE(c),bE(d),!0)};return N.forEach(Object.keys(Object.assign({},t,e)),function(d){const h=l[d]||i,m=h(t[d],e[d],d);N.isUndefined(m)&&h!==a||(n[d]=m)}),n}const hI="1.6.0",cx={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{cx[t]=function(r){return typeof r===t||"a"+(e<1?"n ":" ")+t}});const kE={};cx.transitional=function(e,n,r){function i(s,o){return"[Axios v"+hI+"] Transitional option '"+s+"'"+o+(r?". "+r:"")}return(s,o,a)=>{if(e===!1)throw new xe(i(o," has been removed"+(n?" in "+n:"")),xe.ERR_DEPRECATED);return n&&!kE[o]&&(kE[o]=!0,console.warn(i(o," has been deprecated since v"+n+" and will be removed in the near future"))),e?e(s,o,a):!0}};function AF(t,e,n){if(typeof t!="object")throw new xe("options must be an object",xe.ERR_BAD_OPTION_VALUE);const r=Object.keys(t);let i=r.length;for(;i-- >0;){const s=r[i],o=e[s];if(o){const a=t[s],l=a===void 0||o(a,s,t);if(l!==!0)throw new xe("option "+s+" must be "+l,xe.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new xe("Unknown option "+s,xe.ERR_BAD_OPTION)}}const K0={assertOptions:AF,validators:cx},bi=K0.validators;class Ph{constructor(e){this.defaults=e,this.interceptors={request:new xE,response:new xE}}request(e,n){typeof e=="string"?(n=n||{},n.url=e):n=e||{},n=Ca(this.defaults,n);const{transitional:r,paramsSerializer:i,headers:s}=n;r!==void 0&&K0.assertOptions(r,{silentJSONParsing:bi.transitional(bi.boolean),forcedJSONParsing:bi.transitional(bi.boolean),clarifyTimeoutError:bi.transitional(bi.boolean)},!1),i!=null&&(N.isFunction(i)?n.paramsSerializer={serialize:i}:K0.assertOptions(i,{encode:bi.function,serialize:bi.function},!0)),n.method=(n.method||this.defaults.method||"get").toLowerCase();let o=s&&N.merge(s.common,s[n.method]);s&&N.forEach(["delete","get","head","post","put","patch","common"],y=>{delete s[y]}),n.headers=ii.concat(o,s);const a=[];let l=!0;this.interceptors.request.forEach(function(x){typeof x.runWhen=="function"&&x.runWhen(n)===!1||(l=l&&x.synchronous,a.unshift(x.fulfilled,x.rejected))});const c=[];this.interceptors.response.forEach(function(x){c.push(x.fulfilled,x.rejected)});let d,h=0,m;if(!l){const y=[SE.bind(this),void 0];for(y.unshift.apply(y,a),y.push.apply(y,c),m=y.length,d=Promise.resolve(n);h<m;)d=d.then(y[h++],y[h++]);return d}m=a.length;let p=n;for(h=0;h<m;){const y=a[h++],x=a[h++];try{p=y(p)}catch(E){x.call(this,E);break}}try{d=SE.call(this,p)}catch(y){return Promise.reject(y)}for(h=0,m=c.length;h<m;)d=d.then(c[h++],c[h++]);return d}getUri(e){e=Ca(this.defaults,e);const n=uI(e.baseURL,e.url);return oI(n,e.params,e.paramsSerializer)}}N.forEach(["delete","get","head","options"],function(e){Ph.prototype[e]=function(n,r){return this.request(Ca(r||{},{method:e,url:n,data:(r||{}).data}))}});N.forEach(["post","put","patch"],function(e){function n(r){return function(s,o,a){return this.request(Ca(a||{},{method:e,headers:r?{"Content-Type":"multipart/form-data"}:{},url:s,data:o}))}}Ph.prototype[e]=n(),Ph.prototype[e+"Form"]=n(!0)});const jd=Ph;class ux{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(s){n=s});const r=this;this.promise.then(i=>{if(!r._listeners)return;let s=r._listeners.length;for(;s-- >0;)r._listeners[s](i);r._listeners=null}),this.promise.then=i=>{let s;const o=new Promise(a=>{r.subscribe(a),s=a}).then(i);return o.cancel=function(){r.unsubscribe(s)},o},e(function(s,o,a){r.reason||(r.reason=new nu(s,o,a),n(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const n=this._listeners.indexOf(e);n!==-1&&this._listeners.splice(n,1)}static source(){let e;return{token:new ux(function(i){e=i}),cancel:e}}}const RF=ux;function PF(t){return function(n){return t.apply(null,n)}}function NF(t){return N.isObject(t)&&t.isAxiosError===!0}const X0={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(X0).forEach(([t,e])=>{X0[e]=t});const DF=X0;function fI(t){const e=new jd(t),n=KT(jd.prototype.request,e);return N.extend(n,jd.prototype,e,{allOwnKeys:!0}),N.extend(n,e,null,{allOwnKeys:!0}),n.create=function(i){return fI(Ca(t,i))},n}const ft=fI(lx);ft.Axios=jd;ft.CanceledError=nu;ft.CancelToken=RF;ft.isCancel=cI;ft.VERSION=hI;ft.toFormData=Uf;ft.AxiosError=xe;ft.Cancel=ft.CanceledError;ft.all=function(e){return Promise.all(e)};ft.spread=PF;ft.isAxiosError=NF;ft.mergeConfig=Ca;ft.AxiosHeaders=ii;ft.formToJSON=t=>lI(N.isHTMLForm(t)?new FormData(t):t);ft.getAdapter=dI.getAdapter;ft.HttpStatusCode=DF;ft.default=ft;const jF=ft,mI=jF.create({baseURL:{}.VITE_ENDPOINT||"https://express-zingmp3-awx6.vercel.app"}),OF=t=>new Date(t.toDate().getTime()).toLocaleString(),si=()=>JSON.parse(localStorage.getItem("HD-MP3")||"{}"),tn=(t,e)=>{const n=si();return n[t]=e,localStorage.setItem("HD-MP3",JSON.stringify(n))},dx=t=>(n=>n.toLocaleLowerCase().replace(/à|á|ạ|ả|ã|â|ầ|ấ|ậ|ẩ|ẫ/g,"a").replace(/è|é|ẹ|ẻ|ẽ|ê|ề|ế|ệ|ể|ễ/g,"e").replace(/ì|í|ị|ỉ|ĩ/g,"i").replace(/ò|ó|ọ|ỏ|õ|ô|ồ|ố|ộ|ổ|ỗ/g,"o").replace(/ù|ú|ụ|ủ|ũ|ư|ừ|ứ|ự|ử|ữ/g,"u").replace(/ỳ|ý|ỵ|ỷ|ỹ/g,"y").replace(/đ/g,"d"))(t).toLocaleLowerCase().replaceAll(/[\W_]/g,"")+"_"+Rh(4),MF=async t=>{if(!t)return;const e=await gL(t);if(!e)return;const{common:{title:n,artist:r},format:{duration:i}}=e,s={name:"",singer:"",image:null,duration:0};return s.name=n||t.name,s.singer=r||"...",s.duration=i||0,s},Aa=t=>{const e=Math.floor(t/60),n=Math.floor(t%60);return`${e}:${n.toString().padStart(2,"0")}`},LF=(t,e)=>{const n=e.findIndex(r=>r.id===t.id);if(n!=-1)return e[n]=t,n},hx=({...t})=>({...{name:"",singer:"",image_url:"",song_url:"",by:"",duration:0,lyric_id:"",image_file_path:"",song_file_path:"",id:"",song_in:"",blurhash_encode:"",size:0},...t}),fx=({...t})=>({...{id:"",name:"",song_ids:[],by:"",image_url:"",blurhash_encode:""},...t}),Nh=async t=>new Promise(e=>setTimeout(e,t));let Q0=vh[0];const FF=si(),TE=FF.theme;TE&&vh.forEach(t=>{t.id===TE&&(Q0=t)});const pI={theme:{...Q0,alpha:Q0.type==="light"?"[#000]/[.1]":"[#fff]/[.1]"},isOnMobile:window.innerWidth<800,isDev:!1},$F=(t,e)=>{switch(e.type){case 0:{const n=e.payload.theme;return{...t,theme:{...n,alpha:n.type==="dark"?"[#fff]/[.1]":"[#000]/[.1]"}}}}},zF=()=>{const[t,e]=f.useReducer($F,pI),n=f.useCallback(r=>{console.log("set theme"),e({type:0,payload:{theme:r}})},[]);return{state:t,setTheme:n}},BF={state:pI,setTheme:()=>{}},gI=f.createContext(BF),VF=({children:t})=>u.jsx(gI.Provider,{value:zF(),children:t}),te=()=>{const{state:{...t},...e}=f.useContext(gI);return{...t,...e}};function St({className:t}){const{theme:e}=te();return u.jsx("div",{className:`animate-pulse rounded-[4px] bg-${e.alpha} ${t}`})}const Hf=[...Array(4).keys()].map(t=>u.jsxs("div",{className:"flex items-center p-[10px] border-b-[1px] border-transparent",children:[u.jsx(St,{className:"h-[18px] w-[18px]"}),u.jsx(St,{className:"h-[54px] w-[54px] ml-[10px] rounded-[4px]"}),u.jsxs("div",{className:"ml-[10px]",children:[u.jsx(St,{className:"h-[20px] mb-[5px] w-[150px]"}),u.jsx(St,{className:"h-[12px] mt-[5px] w-[100px]"})]})]},t)),yI=[...Array(1).keys()].map(t=>u.jsx(St,{className:"w-full h-[40px]"},t)),UF=[...Array(2).keys()].map(t=>u.jsxs("div",{className:"w-1/4 p-[8px] max-[549px]:w-1/2",children:[u.jsx(St,{className:"pt-[100%] rounded-[8px]"}),u.jsx(St,{className:"h-[22px] mt-[6px] w-[50%]"})]},t));var WF=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","#","$","%","*","+",",","-",".",":",";","=","?","@","[","]","^","_","{","|","}","~"],Cl=t=>{let e=0;for(let n=0;n<t.length;n++){let r=t[n],i=WF.indexOf(r);e=e*83+i}return e},Hp=t=>{let e=t/255;return e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)},qp=t=>{let e=Math.max(0,Math.min(1,t));return e<=.0031308?Math.trunc(e*12.92*255+.5):Math.trunc((1.055*Math.pow(e,.4166666666666667)-.055)*255+.5)},HF=t=>t<0?-1:1,Gp=(t,e)=>HF(t)*Math.pow(Math.abs(t),e),IE=class extends Error{constructor(e){super(e),this.name="ValidationError",this.message=e}},qF=t=>{if(!t||t.length<6)throw new IE("The blurhash string must be at least 6 characters");let e=Cl(t[0]),n=Math.floor(e/9)+1,r=e%9+1;if(t.length!==4+2*r*n)throw new IE(`blurhash length mismatch: length is ${t.length} but it should be ${4+2*r*n}`)},GF=t=>{let e=t>>16,n=t>>8&255,r=t&255;return[Hp(e),Hp(n),Hp(r)]},KF=(t,e)=>{let n=Math.floor(t/361),r=Math.floor(t/19)%19,i=t%19;return[Gp((n-9)/9,2)*e,Gp((r-9)/9,2)*e,Gp((i-9)/9,2)*e]},XF=(t,e,n,r)=>{qF(t),r=r|1;let i=Cl(t[0]),s=Math.floor(i/9)+1,o=i%9+1,a=(Cl(t[1])+1)/166,l=new Array(o*s);for(let h=0;h<l.length;h++)if(h===0){let m=Cl(t.substring(2,6));l[h]=GF(m)}else{let m=Cl(t.substring(4+h*2,6+h*2));l[h]=KF(m,a*r)}let c=e*4,d=new Uint8ClampedArray(c*n);for(let h=0;h<n;h++)for(let m=0;m<e;m++){let p=0,y=0,x=0;for(let w=0;w<s;w++)for(let _=0;_<o;_++){let S=Math.cos(Math.PI*m*_/e)*Math.cos(Math.PI*h*w/n),T=l[_+w*o];p+=T[0]*S,y+=T[1]*S,x+=T[2]*S}let E=qp(p),v=qp(y),g=qp(x);d[4*m+0+h*c]=E,d[4*m+1+h*c]=v,d[4*m+2+h*c]=g,d[4*m+3+h*c]=255}return d},QF=XF,YF=Object.defineProperty,JF=Object.defineProperties,ZF=Object.getOwnPropertyDescriptors,Dh=Object.getOwnPropertySymbols,vI=Object.prototype.hasOwnProperty,xI=Object.prototype.propertyIsEnumerable,CE=(t,e,n)=>e in t?YF(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Y0=(t,e)=>{for(var n in e||(e={}))vI.call(e,n)&&CE(t,n,e[n]);if(Dh)for(var n of Dh(e))xI.call(e,n)&&CE(t,n,e[n]);return t},J0=(t,e)=>JF(t,ZF(e)),wI=(t,e)=>{var n={};for(var r in t)vI.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&Dh)for(var r of Dh(t))e.indexOf(r)<0&&xI.call(t,r)&&(n[r]=t[r]);return n},_I=class extends f.PureComponent{constructor(){super(...arguments),this.canvas=null,this.handleRef=e=>{this.canvas=e,this.draw()},this.draw=()=>{let{hash:e,height:n,punch:r,width:i}=this.props;if(this.canvas){let s=QF(e,i,n,r),o=this.canvas.getContext("2d"),a=o.createImageData(i,n);a.data.set(s),o.putImageData(a,0,0)}}}componentDidUpdate(){this.draw()}render(){let e=this.props,{hash:n,height:r,width:i}=e,s=wI(e,["hash","height","width"]);return f.createElement("canvas",J0(Y0({},s),{height:r,width:i,ref:this.handleRef}))}};_I.defaultProps={height:128,width:128};var e$={position:"absolute",top:0,bottom:0,left:0,right:0,width:"100%",height:"100%"},EI=class extends f.PureComponent{componentDidUpdate(){if(this.props.resolutionX<=0)throw new Error("resolutionX must be larger than zero");if(this.props.resolutionY<=0)throw new Error("resolutionY must be larger than zero")}render(){let e=this.props,{hash:n,height:r,width:i,punch:s,resolutionX:o,resolutionY:a,style:l}=e,c=wI(e,["hash","height","width","punch","resolutionX","resolutionY","style"]);return f.createElement("div",J0(Y0({},c),{style:J0(Y0({display:"inline-block",height:r,width:i},l),{position:"relative"})}),f.createElement(_I,{hash:n,height:a,width:o,punch:s,style:e$}))}};EI.defaultProps={height:128,width:128,resolutionX:32,resolutionY:32};const t$="/HD-MP3/assets/logo-17dffbdd.png";function vi({src:t,classNames:e,blurHashEncode:n,onError:r}){const[i,s]=f.useState(!1),o=f.useRef(null),a=()=>{s(!0),t&&t!=null&&t.includes("blob")&&URL.revokeObjectURL(t)},l=()=>{const d=o.current;d.src="https://placehold.co/100",s(!0)},c=()=>{r?(r(),l()):l()};return u.jsxs(u.Fragment,{children:[!i&&u.jsx(u.Fragment,{children:n?u.jsx(EI,{hash:n,height:"100%",width:"100%"}):u.jsx(St,{className:"w-full h-0"})}),u.jsx("img",{onLoad:a,onError:c,className:`${e||""} w-full ${i?"":"hidden"}`,src:t||t$,ref:o})]})}const n$=({className:t,onClick:e,theme:n})=>u.jsx("div",{className:`w-full rounded-[8px] border ${n.type==="light"?"border-[#333]":"border-[#fff]"} relative`,children:u.jsx("div",{onClick:()=>e(),className:`${n==null?void 0:n.content_hover_text} ${t} cursor-pointer`,children:u.jsx(X,{className:`absolute top-1/2 left-1/2 -translate-x-[50%] -translate-y-[50%] ${n.type==="light"?"text-[#333]":"text-[#fff]"}`,children:u.jsx(yh,{className:"w-[40px] max-[549px]:w-[30px]"})})})}),r$=pT("",{variants:{variant:{default:"p-4",thin:"p-[6px]"}},defaultVariants:{variant:"default"}});function _o({children:t,theme:e,className:n,color:r="container",variant:i}){const s={black:"bg-[#292929]",container:e.container,sidebar:e.side_bar_bg};return u.jsx("div",{className:`rounded-[6px]  ${e.type==="light"?"text-[#333]":"text-white"} ${s[r]} border-[1px] border-${e.alpha} ${r$({variant:i,className:n})}`,children:t})}function Kp({className:t,icon:e,label:n,to:r,arrowIcon:i,children:s}){return r?u.jsxs(Yi,{className:`w-full flex  justify-between  ${t}`,to:r,children:[u.jsxs("div",{className:"inline-flex items-center ",children:[e,u.jsx("span",{className:"text-lg font-medium",children:n})]}),s,i&&u.jsx("span",{children:i})]}):u.jsx("p",{children:"No onClick"})}const mx={userSongs:[],userPlaylists:[],adminSongs:[],adminPlaylists:[],initial:!1},i$=(t,e)=>{switch(e.type){case 8:{const n=e.payload;return{...t,...n,initial:!0}}case 2:{const{songs:n}=e.payload,r=[...t.userSongs,...n];return{...t,userSongs:r}}case 3:{const{song:n}=e.payload,r=[...t.userSongs],i=r.findIndex(s=>s.id===n.id);return i===-1?t:(r[i]=n,{...t,userSongs:r})}case 4:{const{playlist:n}=e.payload;return{...t,userPlaylists:[...t.userPlaylists,n]}}case 5:{const{playlist:n}=e.payload,r=[...t.userPlaylists],i=r.findIndex(s=>s.id===n.id);return i===-1?t:(r[i]=n,{...t,userPlaylists:r})}case 9:return mx;case 0:{const{songs:n}=e.payload;return{...t,userSongs:n}}case 6:{const{playlists:n}=e.payload;return{...t,userPlaylists:n}}default:return t}},s$=()=>{const[t,e]=f.useReducer(i$,mx),n=f.useCallback(d=>e({type:0,payload:{songs:d}}),[]),r=f.useCallback(d=>e({type:2,payload:{songs:d}}),[]),i=f.useCallback(d=>e({type:3,payload:{song:d}}),[]),s=f.useCallback(d=>e({type:4,payload:{playlist:d}}),[]),o=f.useCallback(d=>e({type:6,payload:{playlists:d}}),[]),a=f.useCallback(d=>e({type:5,payload:{playlist:d}}),[]),l=f.useCallback(()=>e({type:9}),[]),c=f.useCallback(d=>e({type:8,payload:d}),[]);return{state:t,resetSongPlaylistStore:l,setUserSongs:n,addUserSongs:r,addUserPlaylist:s,updateUserSong:i,updateUserPlaylist:a,initSongsContext:c,setUserPlaylists:o}},o$={state:mx,initSongsContext:()=>{},addUserPlaylist:()=>{},addUserSongs:()=>{},resetSongPlaylistStore:()=>{},setUserSongs:()=>{},updateUserPlaylist:()=>{},updateUserSong:()=>{},setUserPlaylists:()=>{}},SI=f.createContext(o$),a$=({children:t})=>u.jsx(SI.Provider,{value:s$(),children:t}),ot=()=>{const{state:{...t},...e}=f.useContext(SI);return{...t,...e}},bI={isChecked:!1,isSelectAll:!1,selectedSongs:[]},l$=(t,e)=>{switch(e.type){case 0:{const{song:n}=e.payload,r=[...t.selectedSongs],i=r.findIndex(s=>s.id===n.id);return i===-1?r.push(n):r.splice(i,1),{...t,selectedSongs:r,isChecked:!!r.length}}case 2:return bI;case 3:return t;case 4:{const{songs:n}=e.payload;return{...t,selectedSongs:n,isChecked:!0,isSelectAll:!0}}}return t},c$=()=>{const[t,e]=f.useReducer(l$,bI),n=f.useCallback(()=>{e({type:3})},[]),r=f.useCallback(()=>{e({type:2})},[]),i=f.useCallback(o=>{e({type:0,payload:{song:o}})},[]),s=f.useCallback(o=>{e({type:4,payload:{songs:o}})},[]);return{state:t,setChecked:n,selectSong:i,selectAll:s,resetSelect:r}},u$={state:{isChecked:!1,isSelectAll:!1,selectedSongs:[]},resetSelect:()=>{},selectAll:()=>{},selectSong:()=>{},setChecked:()=>{}},kI=f.createContext(u$),ru=()=>{const t=f.useContext(kI),{state:{...e},...n}=t;return{...e,...n}};function bc({children:t}){return u.jsx(kI.Provider,{value:c$(),children:t})}function TI({song:t,theme:e,...n}){const{isChecked:r,selectedSongs:i,selectSong:s}=ru(),o=d=>{switch(n.variant){case"default":case"playing-next":return n.onClick(d);case"select":return s(t)}},a=f.useMemo(()=>n.variant!=="select"?!1:i.findIndex(d=>d.id===t.id)!=-1,[i]),l={itemContainer:`hover:bg-${e.alpha} items-center justify-between cursor-pointer  border-b 
    last:border-none border-${e.alpha} 
    flex rounded-md p-2 ${r&&"bg-"+e.alpha}`,button:`${e.content_bg} rounded-full`,songListButton:"mr-[10px] px-[5px]",imageFrame:"w-[54px] h-[54px] relative rounded-[4px] overflow-hidden group/image flex-shrink-0",before:"after:content-[''] after:absolute after:h-[100%] after:w-[10px] after:right-[100%]"},c=()=>{switch(n.variant){case"select":return r?u.jsx(vc,{className:"w-[18px] "}):u.jsx(u.Fragment,{children:a?u.jsx(Pd,{className:"w-[18px]"}):u.jsx(vc,{className:"w-[18px]"})});default:return u.jsx(u.Fragment,{})}};return u.jsx(u.Fragment,{children:u.jsx("div",{onClick:o,className:`target-class opacity-100 transition-[opacity,transform] duration-300 ${l.itemContainer} `,children:u.jsxs("div",{className:"flex flex-row w-[100%]",children:[c(),u.jsxs("div",{className:"flex-grow flex",children:[u.jsx("div",{className:`${l.imageFrame}  `,children:u.jsx(vi,{blurHashEncode:t.blurhash_encode,src:t.image_url})}),u.jsxs("div",{className:"ml-[10px]",children:[u.jsx("h5",{className:`text-mg line-clamp-1 ${a&&e.content_text}`,children:t.name}),u.jsx("p",{className:"text-xs opacity-60 bg-blend-lighten line-clamp-1",children:t.singer})]})]})]})})})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const II=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},d$=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[n++],o=t[n++],a=t[n++],l=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const s=t[n++],o=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},CI={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const s=t[i],o=i+1<t.length,a=o?t[i+1]:0,l=i+2<t.length,c=l?t[i+2]:0,d=s>>2,h=(s&3)<<4|a>>4;let m=(a&15)<<2|c>>6,p=c&63;l||(p=64,o||(m=64)),r.push(n[d],n[h],n[m],n[p])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(II(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):d$(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const s=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0;++i;const c=i<t.length?n[t.charAt(i)]:64;++i;const h=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||a==null||c==null||h==null)throw new h$;const m=s<<2|a>>4;if(r.push(m),c!==64){const p=a<<4&240|c>>2;if(r.push(p),h!==64){const y=c<<6&192|h;r.push(y)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class h$ extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const f$=function(t){const e=II(t);return CI.encodeByteArray(e,!0)},jh=function(t){return f$(t).replace(/\./g,"")},AI=function(t){try{return CI.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m$(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p$=()=>m$().__FIREBASE_DEFAULTS__,g$=()=>{if(typeof process>"u"||typeof process.env>"u")return;const t={}.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},y$=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&AI(t[1]);return e&&JSON.parse(e)},qf=()=>{try{return p$()||g$()||y$()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},RI=t=>{var e,n;return(n=(e=qf())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},PI=t=>{const e=RI(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},NI=()=>{var t;return(t=qf())===null||t===void 0?void 0:t.config},DI=t=>{var e;return(e=qf())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v${constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jI(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t),a="";return[jh(JSON.stringify(n)),jh(JSON.stringify(o)),a].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function x$(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Xt())}function w$(){var t;const e=(t=qf())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function _$(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function E$(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function S$(){const t=Xt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function b$(){try{return typeof indexedDB=="object"}catch{return!1}}function k$(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T$="FirebaseError";class Ur extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=T$,Object.setPrototypeOf(this,Ur.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,iu.prototype.create)}}class iu{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?I$(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new Ur(i,a,r)}}function I$(t,e){return t.replace(C$,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const C$=/\{\$([^}]+)}/g;function A$(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Oh(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const s=t[i],o=e[i];if(AE(s)&&AE(o)){if(!Oh(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function AE(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function su(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function R$(t,e){const n=new P$(t,e);return n.subscribe.bind(n)}class P${constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");N$(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=Xp),i.error===void 0&&(i.error=Xp),i.complete===void 0&&(i.complete=Xp);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function N$(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Xp(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xt(t){return t&&t._delegate?t._delegate:t}class ss{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rs="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let D$=class{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new v$;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(O$(e))try{this.getOrInitializeService({instanceIdentifier:Rs})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Rs){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Rs){return this.instances.has(e)}getOptions(e=Rs){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,n){var r;const i=this.normalizeInstanceIdentifier(n),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);const o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:j$(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Rs){return this.component?this.component.multipleInstances?e:Rs:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function j$(t){return t===Rs?void 0:t}function O$(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M${constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new D$(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var _e;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(_e||(_e={}));const L$={debug:_e.DEBUG,verbose:_e.VERBOSE,info:_e.INFO,warn:_e.WARN,error:_e.ERROR,silent:_e.SILENT},F$=_e.INFO,$$={[_e.DEBUG]:"log",[_e.VERBOSE]:"log",[_e.INFO]:"info",[_e.WARN]:"warn",[_e.ERROR]:"error"},z$=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=$$[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class px{constructor(e){this.name=e,this._logLevel=F$,this._logHandler=z$,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in _e))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?L$[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,_e.DEBUG,...e),this._logHandler(this,_e.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,_e.VERBOSE,...e),this._logHandler(this,_e.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,_e.INFO,...e),this._logHandler(this,_e.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,_e.WARN,...e),this._logHandler(this,_e.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,_e.ERROR,...e),this._logHandler(this,_e.ERROR,...e)}}const B$=(t,e)=>e.some(n=>t instanceof n);let RE,PE;function V$(){return RE||(RE=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function U$(){return PE||(PE=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const OI=new WeakMap,Z0=new WeakMap,MI=new WeakMap,Qp=new WeakMap,gx=new WeakMap;function W$(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n(Ji(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&OI.set(n,t)}).catch(()=>{}),gx.set(e,t),e}function H$(t){if(Z0.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});Z0.set(t,e)}let ey={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Z0.get(t);if(e==="objectStoreNames")return t.objectStoreNames||MI.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Ji(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function q$(t){ey=t(ey)}function G$(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Yp(this),e,...n);return MI.set(r,e.sort?e.sort():[e]),Ji(r)}:U$().includes(t)?function(...e){return t.apply(Yp(this),e),Ji(OI.get(this))}:function(...e){return Ji(t.apply(Yp(this),e))}}function K$(t){return typeof t=="function"?G$(t):(t instanceof IDBTransaction&&H$(t),B$(t,V$())?new Proxy(t,ey):t)}function Ji(t){if(t instanceof IDBRequest)return W$(t);if(Qp.has(t))return Qp.get(t);const e=K$(t);return e!==t&&(Qp.set(t,e),gx.set(e,t)),e}const Yp=t=>gx.get(t);function X$(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(t,e),a=Ji(o);return r&&o.addEventListener("upgradeneeded",l=>{r(Ji(o.result),l.oldVersion,l.newVersion,Ji(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",c=>i(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const Q$=["get","getKey","getAll","getAllKeys","count"],Y$=["put","add","delete","clear"],Jp=new Map;function NE(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Jp.get(e))return Jp.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=Y$.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||Q$.includes(n)))return;const s=async function(o,...a){const l=this.transaction(o,i?"readwrite":"readonly");let c=l.store;return r&&(c=c.index(a.shift())),(await Promise.all([c[n](...a),i&&l.done]))[0]};return Jp.set(e,s),s}q$(t=>({...t,get:(e,n,r)=>NE(e,n)||t.get(e,n,r),has:(e,n)=>!!NE(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J${constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(Z$(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function Z$(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const ty="@firebase/app",DE="0.9.17";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const no=new px("@firebase/app"),e9="@firebase/app-compat",t9="@firebase/analytics-compat",n9="@firebase/analytics",r9="@firebase/app-check-compat",i9="@firebase/app-check",s9="@firebase/auth",o9="@firebase/auth-compat",a9="@firebase/database",l9="@firebase/database-compat",c9="@firebase/functions",u9="@firebase/functions-compat",d9="@firebase/installations",h9="@firebase/installations-compat",f9="@firebase/messaging",m9="@firebase/messaging-compat",p9="@firebase/performance",g9="@firebase/performance-compat",y9="@firebase/remote-config",v9="@firebase/remote-config-compat",x9="@firebase/storage",w9="@firebase/storage-compat",_9="@firebase/firestore",E9="@firebase/firestore-compat",S9="firebase",b9="10.3.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ny="[DEFAULT]",k9={[ty]:"fire-core",[e9]:"fire-core-compat",[n9]:"fire-analytics",[t9]:"fire-analytics-compat",[i9]:"fire-app-check",[r9]:"fire-app-check-compat",[s9]:"fire-auth",[o9]:"fire-auth-compat",[a9]:"fire-rtdb",[l9]:"fire-rtdb-compat",[c9]:"fire-fn",[u9]:"fire-fn-compat",[d9]:"fire-iid",[h9]:"fire-iid-compat",[f9]:"fire-fcm",[m9]:"fire-fcm-compat",[p9]:"fire-perf",[g9]:"fire-perf-compat",[y9]:"fire-rc",[v9]:"fire-rc-compat",[x9]:"fire-gcs",[w9]:"fire-gcs-compat",[_9]:"fire-fst",[E9]:"fire-fst-compat","fire-js":"fire-js",[S9]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mh=new Map,ry=new Map;function T9(t,e){try{t.container.addComponent(e)}catch(n){no.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function ro(t){const e=t.name;if(ry.has(e))return no.debug(`There were multiple attempts to register component ${e}.`),!1;ry.set(e,t);for(const n of Mh.values())T9(n,t);return!0}function Gf(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I9={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},Zi=new iu("app","Firebase",I9);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C9{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new ss("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Zi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Eo=b9;function LI(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:ny,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw Zi.create("bad-app-name",{appName:String(i)});if(n||(n=NI()),!n)throw Zi.create("no-options");const s=Mh.get(i);if(s){if(Oh(n,s.options)&&Oh(r,s.config))return s;throw Zi.create("duplicate-app",{appName:i})}const o=new M$(i);for(const l of ry.values())o.addComponent(l);const a=new C9(n,r,o);return Mh.set(i,a),a}function yx(t=ny){const e=Mh.get(t);if(!e&&t===ny&&NI())return LI();if(!e)throw Zi.create("no-app",{appName:t});return e}function Nr(t,e,n){var r;let i=(r=k9[t])!==null&&r!==void 0?r:t;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const a=[`Unable to register library "${i}" with version "${e}":`];s&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),no.warn(a.join(" "));return}ro(new ss(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A9="firebase-heartbeat-database",R9=1,kc="firebase-heartbeat-store";let Zp=null;function FI(){return Zp||(Zp=X$(A9,R9,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(kc)}}}).catch(t=>{throw Zi.create("idb-open",{originalErrorMessage:t.message})})),Zp}async function P9(t){try{return await(await FI()).transaction(kc).objectStore(kc).get($I(t))}catch(e){if(e instanceof Ur)no.warn(e.message);else{const n=Zi.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});no.warn(n.message)}}}async function jE(t,e){try{const r=(await FI()).transaction(kc,"readwrite");await r.objectStore(kc).put(e,$I(t)),await r.done}catch(n){if(n instanceof Ur)no.warn(n.message);else{const r=Zi.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});no.warn(r.message)}}}function $I(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N9=1024,D9=30*24*60*60*1e3;class j9{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new M9(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=OE();if(this._heartbeatsCache===null&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(i=>i.date===r)))return this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(i=>{const s=new Date(i.date).valueOf();return Date.now()-s<=D9}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache===null||this._heartbeatsCache.heartbeats.length===0)return"";const e=OE(),{heartbeatsToSend:n,unsentEntries:r}=O9(this._heartbeatsCache.heartbeats),i=jh(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}}function OE(){return new Date().toISOString().substring(0,10)}function O9(t,e=N9){const n=[];let r=t.slice();for(const i of t){const s=n.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),ME(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),ME(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class M9{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return b$()?k$().then(()=>!0).catch(()=>!1):!1}async read(){return await this._canUseIndexedDBPromise?await P9(this.app)||{heartbeats:[]}:{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return jE(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return jE(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function ME(t){return jh(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L9(t){ro(new ss("platform-logger",e=>new J$(e),"PRIVATE")),ro(new ss("heartbeat",e=>new j9(e),"PRIVATE")),Nr(ty,DE,t),Nr(ty,DE,"esm2017"),Nr("fire-js","")}L9("");function vx(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function zI(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const F9=zI,BI=new iu("auth","Firebase",zI());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lh=new px("@firebase/auth");function $9(t,...e){Lh.logLevel<=_e.WARN&&Lh.warn(`Auth (${Eo}): ${t}`,...e)}function Od(t,...e){Lh.logLevel<=_e.ERROR&&Lh.error(`Auth (${Eo}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fr(t,...e){throw xx(t,...e)}function Dr(t,...e){return xx(t,...e)}function VI(t,e,n){const r=Object.assign(Object.assign({},F9()),{[e]:n});return new iu("auth","Firebase",r).create(e,{appName:t.name})}function z9(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&Fr(t,"argument-error"),VI(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function xx(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return BI.create(t,...e)}function ce(t,e,...n){if(!t)throw xx(e,...n)}function Zr(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Od(e),new Error(e)}function di(t,e){t||Zr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iy(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function B9(){return LE()==="http:"||LE()==="https:"}function LE(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V9(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(B9()||_$()||"connection"in navigator)?navigator.onLine:!0}function U9(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ou{constructor(e,n){this.shortDelay=e,this.longDelay=n,di(n>e,"Short delay should be less than long delay!"),this.isMobile=x$()||E$()}get(){return V9()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wx(t,e){di(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UI{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;Zr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;Zr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;Zr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W9={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H9=new ou(3e4,6e4);function WI(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function au(t,e,n,r,i={}){return HI(t,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});const a=su(Object.assign({key:t.config.apiKey},o)).slice(1),l=await t._getAdditionalHeaders();return l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode),UI.fetch()(qI(t,t.config.apiHost,n,a),Object.assign({method:e,headers:l,referrerPolicy:"no-referrer"},s))})}async function HI(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},W9),e);try{const i=new G9(t),s=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw rd(t,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const a=s.ok?o.errorMessage:o.error.message,[l,c]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw rd(t,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw rd(t,"email-already-in-use",o);if(l==="USER_DISABLED")throw rd(t,"user-disabled",o);const d=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw VI(t,d,c);Fr(t,d)}}catch(i){if(i instanceof Ur)throw i;Fr(t,"network-request-failed",{message:String(i)})}}async function q9(t,e,n,r,i={}){const s=await au(t,e,n,r,i);return"mfaPendingCredential"in s&&Fr(t,"multi-factor-auth-required",{_serverResponse:s}),s}function qI(t,e,n,r){const i=`${e}${n}?${r}`;return t.config.emulator?wx(t.config,i):`${t.config.apiScheme}://${i}`}class G9{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Dr(this.auth,"network-request-failed")),H9.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function rd(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=Dr(t,e,r);return i.customData._tokenResponse=n,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function K9(t,e){return au(t,"POST","/v1/accounts:delete",e)}async function X9(t,e){return au(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wl(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Q9(t,e=!1){const n=xt(t),r=await n.getIdToken(e),i=_x(r);ce(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:Wl(eg(i.auth_time)),issuedAtTime:Wl(eg(i.iat)),expirationTime:Wl(eg(i.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function eg(t){return Number(t)*1e3}function _x(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Od("JWT malformed, contained fewer than 3 sections"),null;try{const i=AI(n);return i?JSON.parse(i):(Od("Failed to decode base64 JWT payload"),null)}catch(i){return Od("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function Y9(t){const e=_x(t);return ce(e,"internal-error"),ce(typeof e.exp<"u","internal-error"),ce(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Tc(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Ur&&J9(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function J9({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z9{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const i=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GI{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Wl(this.lastLoginAt),this.creationTime=Wl(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Fh(t){var e;const n=t.auth,r=await t.getIdToken(),i=await Tc(t,X9(n,{idToken:r}));ce(i==null?void 0:i.users.length,n,"internal-error");const s=i.users[0];t._notifyReloadListener(s);const o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?nz(s.providerUserInfo):[],a=tz(t.providerData,o),l=t.isAnonymous,c=!(t.email&&s.passwordHash)&&!(a!=null&&a.length),d=l?c:!1,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new GI(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(t,h)}async function ez(t){const e=xt(t);await Fh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function tz(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function nz(t){return t.map(e=>{var{providerId:n}=e,r=vx(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rz(t,e){const n=await HI(t,{},async()=>{const r=su({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,o=qI(t,i,"/v1/token",`key=${s}`),a=await t._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",UI.fetch()(o,{method:"POST",headers:a,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ic{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ce(e.idToken,"internal-error"),ce(typeof e.idToken<"u","internal-error"),ce(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Y9(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}async getToken(e,n=!1){return ce(!this.accessToken||this.refreshToken,e,"user-token-expired"),!n&&this.accessToken&&!this.isExpired?this.accessToken:this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:i,expiresIn:s}=await rz(e,n);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:i,expirationTime:s}=n,o=new Ic;return r&&(ce(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(ce(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(ce(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Ic,this.toJSON())}_performRefresh(){return Zr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ki(t,e){ce(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Us{constructor(e){var{uid:n,auth:r,stsTokenManager:i}=e,s=vx(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Z9(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new GI(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await Tc(this,this.stsTokenManager.getToken(this.auth,e));return ce(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return Q9(this,e)}reload(){return ez(this)}_assign(e){this!==e&&(ce(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Us(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){ce(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Fh(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await Tc(this,K9(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,i,s,o,a,l,c,d;const h=(r=n.displayName)!==null&&r!==void 0?r:void 0,m=(i=n.email)!==null&&i!==void 0?i:void 0,p=(s=n.phoneNumber)!==null&&s!==void 0?s:void 0,y=(o=n.photoURL)!==null&&o!==void 0?o:void 0,x=(a=n.tenantId)!==null&&a!==void 0?a:void 0,E=(l=n._redirectEventId)!==null&&l!==void 0?l:void 0,v=(c=n.createdAt)!==null&&c!==void 0?c:void 0,g=(d=n.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:w,emailVerified:_,isAnonymous:S,providerData:T,stsTokenManager:b}=n;ce(w&&b,e,"internal-error");const k=Ic.fromJSON(this.name,b);ce(typeof w=="string",e,"internal-error"),ki(h,e.name),ki(m,e.name),ce(typeof _=="boolean",e,"internal-error"),ce(typeof S=="boolean",e,"internal-error"),ki(p,e.name),ki(y,e.name),ki(x,e.name),ki(E,e.name),ki(v,e.name),ki(g,e.name);const R=new Us({uid:w,auth:e,email:m,emailVerified:_,displayName:h,isAnonymous:S,photoURL:y,phoneNumber:p,tenantId:x,stsTokenManager:k,createdAt:v,lastLoginAt:g});return T&&Array.isArray(T)&&(R.providerData=T.map(P=>Object.assign({},P))),E&&(R._redirectEventId=E),R}static async _fromIdTokenResponse(e,n,r=!1){const i=new Ic;i.updateFromServerResponse(n);const s=new Us({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await Fh(s),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FE=new Map;function ei(t){di(t instanceof Function,"Expected a class definition");let e=FE.get(t);return e?(di(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,FE.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KI{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}KI.type="NONE";const $E=KI;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Md(t,e,n){return`firebase:${t}:${e}:${n}`}class la{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=Md(this.userKey,i.apiKey,s),this.fullPersistenceKey=Md("persistence",i.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Us._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new la(ei($E),e,r);const i=(await Promise.all(n.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let s=i[0]||ei($E);const o=Md(r,e.config.apiKey,e.name);let a=null;for(const c of n)try{const d=await c._get(o);if(d){const h=Us._fromJSON(e,d);c!==s&&(a=h),s=c;break}}catch{}const l=i.filter(c=>c._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new la(s,e,r):(s=l[0],a&&await s._set(o,a.toJSON()),await Promise.all(n.map(async c=>{if(c!==s)try{await c._remove(o)}catch{}})),new la(s,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zE(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(YI(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(XI(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(ZI(e))return"Blackberry";if(eC(e))return"Webos";if(Ex(e))return"Safari";if((e.includes("chrome/")||QI(e))&&!e.includes("edge/"))return"Chrome";if(JI(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function XI(t=Xt()){return/firefox\//i.test(t)}function Ex(t=Xt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function QI(t=Xt()){return/crios\//i.test(t)}function YI(t=Xt()){return/iemobile/i.test(t)}function JI(t=Xt()){return/android/i.test(t)}function ZI(t=Xt()){return/blackberry/i.test(t)}function eC(t=Xt()){return/webos/i.test(t)}function Kf(t=Xt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function iz(t=Xt()){var e;return Kf(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function sz(){return S$()&&document.documentMode===10}function tC(t=Xt()){return Kf(t)||JI(t)||eC(t)||ZI(t)||/windows phone/i.test(t)||YI(t)}function oz(){try{return!!(window&&window!==window.top)}catch{return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nC(t,e=[]){let n;switch(t){case"Browser":n=zE(Xt());break;case"Worker":n=`${zE(Xt())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Eo}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class az{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=s=>new Promise((o,a)=>{try{const l=e(s);o(l)}catch(l){a(l)}});r.onAbort=n,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lz(t,e={}){return au(t,"GET","/v2/passwordPolicy",WI(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cz=6;class uz{constructor(e){var n,r,i,s;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:cz,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,i,s,o,a;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(n=l.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(r=l.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(i=l.containsLowercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(s=l.containsUppercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(o=l.containsNumericCharacter)!==null&&o!==void 0?o:!0),l.isValid&&(l.isValid=(a=l.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),l}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dz{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new BE(this),this.idTokenSubscription=new BE(this),this.beforeStateQueue=new az(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=BI,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=ei(n)),this._initializationPromise=this.queue(async()=>{var r,i;if(!this._deleted&&(this.persistenceManager=await la.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUser(e){var n;const r=await this.assertedPersistence.getCurrentUser();let i=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,a=i==null?void 0:i._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(i=l.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(o){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return ce(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Fh(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=U9()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const n=e?xt(e):null;return n&&ce(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&ce(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(e){return this.queue(async()=>{await this.assertedPersistence.setPersistence(ei(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await lz(this),n=new uz(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new iu("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&ei(e)||this._popupRedirectResolver;ce(n,this,"argument-error"),this.redirectPersistenceManager=await la.create(this,[ei(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};const s=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(ce(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof n=="function"){const l=e.addObserver(n,r,i);return()=>{o=!0,l()}}else{const l=e.addObserver(n);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ce(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=nC(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const i=await this._getAppCheckToken();return i&&(n["X-Firebase-AppCheck"]=i),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&$9(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function Xf(t){return xt(t)}class BE{constructor(e){this.auth=e,this.observer=null,this.addObserver=R$(n=>this.observer=n)}get next(){return ce(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hz(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}function fz(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{const s=Dr("internal-error");s.customData=i,n(s)},r.type="text/javascript",r.charset="UTF-8",hz().appendChild(r)})}function mz(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pz(t,e){const n=Gf(t,"auth");if(n.isInitialized()){const i=n.getImmediate(),s=n.getOptions();if(Oh(s,e??{}))return i;Fr(i,"already-initialized")}return n.initialize({options:e})}function gz(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(ei);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function yz(t,e,n){const r=Xf(t);ce(r._canInitEmulator,r,"emulator-config-failed"),ce(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!!(n!=null&&n.disableWarnings),s=rC(e),{host:o,port:a}=vz(e),l=a===null?"":`:${a}`;r.config.emulator={url:`${s}//${o}${l}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||xz()}function rC(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function vz(t){const e=rC(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:VE(r.substr(s.length+1))}}else{const[s,o]=r.split(":");return{host:s,port:VE(o)}}}function VE(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function xz(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iC{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Zr("not implemented")}_getIdTokenResponse(e){return Zr("not implemented")}_linkToIdToken(e,n){return Zr("not implemented")}_getReauthenticationResolver(e){return Zr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ca(t,e){return q9(t,"POST","/v1/accounts:signInWithIdp",WI(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wz="http://localhost";class io extends iC{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new io(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Fr("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=n,s=vx(n,["providerId","signInMethod"]);if(!r||!i)return null;const o=new io(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return ca(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,ca(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,ca(e,n)}buildRequest(){const e={requestUri:wz,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=su(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sx{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lu extends Sx{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ni extends lu{constructor(){super("facebook.com")}static credential(e){return io._fromParams({providerId:Ni.PROVIDER_ID,signInMethod:Ni.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ni.credentialFromTaggedObject(e)}static credentialFromError(e){return Ni.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ni.credential(e.oauthAccessToken)}catch{return null}}}Ni.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ni.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sr extends lu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return io._fromParams({providerId:Sr.PROVIDER_ID,signInMethod:Sr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Sr.credentialFromTaggedObject(e)}static credentialFromError(e){return Sr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Sr.credential(n,r)}catch{return null}}}Sr.GOOGLE_SIGN_IN_METHOD="google.com";Sr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Di extends lu{constructor(){super("github.com")}static credential(e){return io._fromParams({providerId:Di.PROVIDER_ID,signInMethod:Di.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Di.credentialFromTaggedObject(e)}static credentialFromError(e){return Di.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Di.credential(e.oauthAccessToken)}catch{return null}}}Di.GITHUB_SIGN_IN_METHOD="github.com";Di.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ji extends lu{constructor(){super("twitter.com")}static credential(e,n){return io._fromParams({providerId:ji.PROVIDER_ID,signInMethod:ji.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return ji.credentialFromTaggedObject(e)}static credentialFromError(e){return ji.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return ji.credential(n,r)}catch{return null}}}ji.TWITTER_SIGN_IN_METHOD="twitter.com";ji.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ra{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,i=!1){const s=await Us._fromIdTokenResponse(e,r,i),o=UE(r);return new Ra({user:s,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const i=UE(r);return new Ra({user:e,providerId:i,_tokenResponse:r,operationType:n})}}function UE(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $h extends Ur{constructor(e,n,r,i){var s;super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,$h.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,i){return new $h(e,n,r,i)}}function sC(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?$h._fromErrorAndOperation(t,s,e,r):s})}async function _z(t,e,n=!1){const r=await Tc(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Ra._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ez(t,e,n=!1){const{auth:r}=t,i="reauthenticate";try{const s=await Tc(t,sC(r,i,e,t),n);ce(s.idToken,r,"internal-error");const o=_x(s.idToken);ce(o,r,"internal-error");const{sub:a}=o;return ce(t.uid===a,r,"user-mismatch"),Ra._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&Fr(r,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Sz(t,e,n=!1){const r="signIn",i=await sC(t,r,e),s=await Ra._fromIdTokenResponse(t,r,i);return n||await t._updateCurrentUser(s.user),s}function bz(t,e,n,r){return xt(t).onIdTokenChanged(e,n,r)}function kz(t,e,n){return xt(t).beforeAuthStateChanged(e,n)}function Tz(t,e,n,r){return xt(t).onAuthStateChanged(e,n,r)}function oC(t){return xt(t).signOut()}const zh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aC{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(zh,"1"),this.storage.removeItem(zh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Iz(){const t=Xt();return Ex(t)||Kf(t)}const Cz=1e3,Az=10;class lC extends aC{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=Iz()&&oz(),this.fallbackToPolling=tC(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),i=this.localCache[n];r!==i&&e(n,i,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;if(n?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const o=this.storage.getItem(r);if(e.newValue!==o)e.newValue!==null?this.storage.setItem(r,e.newValue):this.storage.removeItem(r);else if(this.localCache[r]===e.newValue&&!n)return}const i=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},s=this.storage.getItem(r);sz()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,Az):i()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},Cz)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}lC.type="LOCAL";const Rz=lC;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cC extends aC{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}cC.type="SESSION";const uC=cC;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pz(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const r=new Qf(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:i,data:s}=n.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const a=Array.from(o).map(async c=>c(n.origin,s)),l=await Pz(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Qf.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bx(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nz{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,l)=>{const c=bx("",20);i.port1.start();const d=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(h){const m=h;if(m.data.eventId===c)switch(m.data.status){case"ack":clearTimeout(d),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(m.data.response);break;default:clearTimeout(d),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:c,data:n},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jr(){return window}function Dz(t){jr().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dC(){return typeof jr().WorkerGlobalScope<"u"&&typeof jr().importScripts=="function"}async function jz(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Oz(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function Mz(){return dC()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hC="firebaseLocalStorageDb",Lz=1,Bh="firebaseLocalStorage",fC="fbase_key";class cu{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Yf(t,e){return t.transaction([Bh],e?"readwrite":"readonly").objectStore(Bh)}function Fz(){const t=indexedDB.deleteDatabase(hC);return new cu(t).toPromise()}function sy(){const t=indexedDB.open(hC,Lz);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Bh,{keyPath:fC})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Bh)?e(r):(r.close(),await Fz(),e(await sy()))})})}async function WE(t,e,n){const r=Yf(t,!0).put({[fC]:e,value:n});return new cu(r).toPromise()}async function $z(t,e){const n=Yf(t,!1).get(e),r=await new cu(n).toPromise();return r===void 0?null:r.value}function HE(t,e){const n=Yf(t,!0).delete(e);return new cu(n).toPromise()}const zz=800,Bz=3;class mC{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await sy(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>Bz)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return dC()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Qf._getInstance(Mz()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await jz(),!this.activeServiceWorker)return;this.sender=new Nz(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Oz()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await sy();return await WE(e,zh,"1"),await HE(e,zh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>WE(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>$z(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>HE(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=Yf(i,!1).getAll();return new cu(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),zz)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}mC.type="LOCAL";const Vz=mC;new ou(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pC(t,e){return e?ei(e):(ce(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kx extends iC{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ca(e,this._buildIdpRequest())}_linkToIdToken(e,n){return ca(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return ca(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function Uz(t){return Sz(t.auth,new kx(t),t.bypassAuthState)}function Wz(t){const{auth:e,user:n}=t;return ce(n,e,"internal-error"),Ez(n,new kx(t),t.bypassAuthState)}async function Hz(t){const{auth:e,user:n}=t;return ce(n,e,"internal-error"),_z(n,new kx(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gC{constructor(e,n,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:i,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:n,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Uz;case"linkViaPopup":case"linkViaRedirect":return Hz;case"reauthViaPopup":case"reauthViaRedirect":return Wz;default:Fr(this.auth,"internal-error")}}resolve(e){di(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){di(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qz=new ou(2e3,1e4);async function Gz(t,e,n){const r=Xf(t);z9(t,e,Sx);const i=pC(r,n);return new Ms(r,"signInViaPopup",e,i).executeNotNull()}class Ms extends gC{constructor(e,n,r,i,s){super(e,n,i,s),this.provider=r,this.authWindow=null,this.pollId=null,Ms.currentPopupAction&&Ms.currentPopupAction.cancel(),Ms.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ce(e,this.auth,"internal-error"),e}async onExecution(){di(this.filter.length===1,"Popup operations only handle one event");const e=bx();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Dr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Dr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ms.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Dr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,qz.get())};e()}}Ms.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kz="pendingRedirect",Ld=new Map;class Xz extends gC{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Ld.get(this.auth._key());if(!e){try{const r=await Qz(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Ld.set(this.auth._key(),e)}return this.bypassAuthState||Ld.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Qz(t,e){const n=Zz(e),r=Jz(t);if(!await r._isAvailable())return!1;const i=await r._get(n)==="true";return await r._remove(n),i}function Yz(t,e){Ld.set(t._key(),e)}function Jz(t){return ei(t._redirectPersistence)}function Zz(t){return Md(Kz,t.config.apiKey,t.name)}async function e8(t,e,n=!1){const r=Xf(t),i=pC(r,e),o=await new Xz(r,i,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t8=10*60*1e3;class n8{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!r8(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!yC(e)){const i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(Dr(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=t8&&this.cachedEventUids.clear(),this.cachedEventUids.has(qE(e))}saveEventToCache(e){this.cachedEventUids.add(qE(e)),this.lastProcessedEventTime=Date.now()}}function qE(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function yC({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function r8(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return yC(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function i8(t,e={}){return au(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s8=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,o8=/^https?/;async function a8(t){if(t.config.emulator)return;const{authorizedDomains:e}=await i8(t);for(const n of e)try{if(l8(n))return}catch{}Fr(t,"unauthorized-domain")}function l8(t){const e=iy(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!o8.test(n))return!1;if(s8.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c8=new ou(3e4,6e4);function GE(){const t=jr().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function u8(t){return new Promise((e,n)=>{var r,i,s;function o(){GE(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{GE(),n(Dr(t,"network-request-failed"))},timeout:c8.get()})}if(!((i=(r=jr().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=jr().gapi)===null||s===void 0)&&s.load)o();else{const a=mz("iframefcb");return jr()[a]=()=>{gapi.load?o():n(Dr(t,"network-request-failed"))},fz(`https://apis.google.com/js/api.js?onload=${a}`).catch(l=>n(l))}}).catch(e=>{throw Fd=null,e})}let Fd=null;function d8(t){return Fd=Fd||u8(t),Fd}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h8=new ou(5e3,15e3),f8="__/auth/iframe",m8="emulator/auth/iframe",p8={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},g8=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function y8(t){const e=t.config;ce(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?wx(e,m8):`https://${t.config.authDomain}/${f8}`,r={apiKey:e.apiKey,appName:t.name,v:Eo},i=g8.get(t.config.apiHost);i&&(r.eid=i);const s=t._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${su(r).slice(1)}`}async function v8(t){const e=await d8(t),n=jr().gapi;return ce(n,t,"internal-error"),e.open({where:document.body,url:y8(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:p8,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const o=Dr(t,"network-request-failed"),a=jr().setTimeout(()=>{s(o)},h8.get());function l(){jr().clearTimeout(a),i(r)}r.ping(l).then(l,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x8={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},w8=500,_8=600,E8="_blank",S8="http://localhost";class KE{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function b8(t,e,n,r=w8,i=_8){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l=Object.assign(Object.assign({},x8),{width:r.toString(),height:i.toString(),top:s,left:o}),c=Xt().toLowerCase();n&&(a=QI(c)?E8:n),XI(c)&&(e=e||S8,l.scrollbars="yes");const d=Object.entries(l).reduce((m,[p,y])=>`${m}${p}=${y},`,"");if(iz(c)&&a!=="_self")return k8(e||"",a),new KE(null);const h=window.open(e||"",a,d);ce(h,t,"popup-blocked");try{h.focus()}catch{}return new KE(h)}function k8(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T8="__/auth/handler",I8="emulator/auth/handler",C8=encodeURIComponent("fac");async function XE(t,e,n,r,i,s){ce(t.config.authDomain,t,"auth-domain-config-required"),ce(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Eo,eventId:i};if(e instanceof Sx){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",A$(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,h]of Object.entries(s||{}))o[d]=h}if(e instanceof lu){const d=e.getScopes().filter(h=>h!=="");d.length>0&&(o.scopes=d.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const d of Object.keys(a))a[d]===void 0&&delete a[d];const l=await t._getAppCheckToken(),c=l?`#${C8}=${encodeURIComponent(l)}`:"";return`${A8(t)}?${su(a).slice(1)}${c}`}function A8({config:t}){return t.emulator?wx(t,I8):`https://${t.authDomain}/${T8}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tg="webStorageSupport";class R8{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=uC,this._completeRedirectFn=e8,this._overrideRedirectResult=Yz}async _openPopup(e,n,r,i){var s;di((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const o=await XE(e,n,r,iy(),i);return b8(e,o,bx())}async _openRedirect(e,n,r,i){await this._originValidation(e);const s=await XE(e,n,r,iy(),i);return Dz(s),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:s}=this.eventManagers[n];return i?Promise.resolve(i):(di(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await v8(e),r=new n8(e);return n.register("authEvent",i=>(ce(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(tg,{type:tg},i=>{var s;const o=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[tg];o!==void 0&&n(!!o),Fr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=a8(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return tC()||Ex()||Kf()}}const P8=R8;var QE="@firebase/auth",YE="1.3.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N8{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){ce(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D8(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}function j8(t){ro(new ss("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;ce(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:nC(t)},c=new dz(r,i,s,l);return gz(c,n),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),ro(new ss("auth-internal",e=>{const n=Xf(e.getProvider("auth").getImmediate());return(r=>new N8(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Nr(QE,YE,D8(t)),Nr(QE,YE,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O8=5*60,M8=DI("authIdTokenMaxAge")||O8;let JE=null;const L8=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>M8)return;const i=n==null?void 0:n.token;JE!==i&&(JE=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function F8(t=yx()){const e=Gf(t,"auth");if(e.isInitialized())return e.getImmediate();const n=pz(t,{popupRedirectResolver:P8,persistence:[Vz,Rz,uC]}),r=DI("authTokenSyncURL");if(r){const s=L8(r);kz(n,s,()=>s(n.currentUser)),bz(n,o=>s(o))}const i=RI("auth");return i&&yz(n,`http://${i}`),n}j8("Browser");var $8="firebase",z8="10.3.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Nr($8,z8,"app");var B8=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},B,Tx=Tx||{},ae=B8||self;function Jf(t){var e=typeof t;return e=e!="object"?e:t?Array.isArray(t)?"array":e:"null",e=="array"||e=="object"&&typeof t.length=="number"}function uu(t){var e=typeof t;return e=="object"&&t!=null||e=="function"}function V8(t){return Object.prototype.hasOwnProperty.call(t,ng)&&t[ng]||(t[ng]=++U8)}var ng="closure_uid_"+(1e9*Math.random()>>>0),U8=0;function W8(t,e,n){return t.call.apply(t.bind,arguments)}function H8(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),t.apply(e,i)}}return function(){return t.apply(e,arguments)}}function Ht(t,e,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?Ht=W8:Ht=H8,Ht.apply(null,arguments)}function id(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),t.apply(this,r)}}function Tt(t,e){function n(){}n.prototype=e.prototype,t.$=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ac=function(r,i,s){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[i].apply(r,o)}}function xs(){this.s=this.s,this.o=this.o}var q8=0;xs.prototype.s=!1;xs.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),q8!=0)&&V8(this)};xs.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const vC=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(typeof t=="string")return typeof e!="string"||e.length!=1?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function Ix(t){const e=t.length;if(0<e){const n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function ZE(t,e){for(let n=1;n<arguments.length;n++){const r=arguments[n];if(Jf(r)){const i=t.length||0,s=r.length||0;t.length=i+s;for(let o=0;o<s;o++)t[i+o]=r[o]}else t.push(r)}}function qt(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}qt.prototype.h=function(){this.defaultPrevented=!0};var G8=function(){if(!ae.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{ae.addEventListener("test",()=>{},e),ae.removeEventListener("test",()=>{},e)}catch{}return t}();function Cc(t){return/^[\s\xa0]*$/.test(t)}function Zf(){var t=ae.navigator;return t&&(t=t.userAgent)?t:""}function br(t){return Zf().indexOf(t)!=-1}function Cx(t){return Cx[" "](t),t}Cx[" "]=function(){};function K8(t,e){var n=zB;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}var X8=br("Opera"),Pa=br("Trident")||br("MSIE"),xC=br("Edge"),oy=xC||Pa,wC=br("Gecko")&&!(Zf().toLowerCase().indexOf("webkit")!=-1&&!br("Edge"))&&!(br("Trident")||br("MSIE"))&&!br("Edge"),Q8=Zf().toLowerCase().indexOf("webkit")!=-1&&!br("Edge");function _C(){var t=ae.document;return t?t.documentMode:void 0}var ay;e:{var rg="",ig=function(){var t=Zf();if(wC)return/rv:([^\);]+)(\)|;)/.exec(t);if(xC)return/Edge\/([\d\.]+)/.exec(t);if(Pa)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t);if(Q8)return/WebKit\/(\S+)/.exec(t);if(X8)return/(?:Version)[ \/]?(\S+)/.exec(t)}();if(ig&&(rg=ig?ig[1]:""),Pa){var sg=_C();if(sg!=null&&sg>parseFloat(rg)){ay=String(sg);break e}}ay=rg}var ly;if(ae.document&&Pa){var eS=_C();ly=eS||parseInt(ay,10)||void 0}else ly=void 0;var Y8=ly;function Ac(t,e){if(qt.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(wC){e:{try{Cx(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else n=="mouseover"?e=t.fromElement:n=="mouseout"&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=t.clientX!==void 0?t.clientX:t.pageX,this.clientY=t.clientY!==void 0?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=typeof t.pointerType=="string"?t.pointerType:J8[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&Ac.$.h.call(this)}}Tt(Ac,qt);var J8={2:"touch",3:"pen",4:"mouse"};Ac.prototype.h=function(){Ac.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var du="closure_listenable_"+(1e6*Math.random()|0),Z8=0;function eB(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.la=i,this.key=++Z8,this.fa=this.ia=!1}function em(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function Ax(t,e,n){for(const r in t)e.call(n,t[r],r,t)}function tB(t,e){for(const n in t)e.call(void 0,t[n],n,t)}function EC(t){const e={};for(const n in t)e[n]=t[n];return e}const tS="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function SC(t,e){let n,r;for(let i=1;i<arguments.length;i++){r=arguments[i];for(n in r)t[n]=r[n];for(let s=0;s<tS.length;s++)n=tS[s],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function tm(t){this.src=t,this.g={},this.h=0}tm.prototype.add=function(t,e,n,r,i){var s=t.toString();t=this.g[s],t||(t=this.g[s]=[],this.h++);var o=uy(t,e,r,i);return-1<o?(e=t[o],n||(e.ia=!1)):(e=new eB(e,this.src,s,!!r,i),e.ia=n,t.push(e)),e};function cy(t,e){var n=e.type;if(n in t.g){var r=t.g[n],i=vC(r,e),s;(s=0<=i)&&Array.prototype.splice.call(r,i,1),s&&(em(e),t.g[n].length==0&&(delete t.g[n],t.h--))}}function uy(t,e,n,r){for(var i=0;i<t.length;++i){var s=t[i];if(!s.fa&&s.listener==e&&s.capture==!!n&&s.la==r)return i}return-1}var Rx="closure_lm_"+(1e6*Math.random()|0),og={};function bC(t,e,n,r,i){if(r&&r.once)return TC(t,e,n,r,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)bC(t,e[s],n,r,i);return null}return n=Dx(n),t&&t[du]?t.O(e,n,uu(r)?!!r.capture:!!r,i):kC(t,e,n,!1,r,i)}function kC(t,e,n,r,i,s){if(!e)throw Error("Invalid event type");var o=uu(i)?!!i.capture:!!i,a=Nx(t);if(a||(t[Rx]=a=new tm(t)),n=a.add(e,n,r,o,s),n.proxy)return n;if(r=nB(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)G8||(i=o),i===void 0&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(CC(e.toString()),r);else if(t.addListener&&t.removeListener)t.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return n}function nB(){function t(n){return e.call(t.src,t.listener,n)}const e=rB;return t}function TC(t,e,n,r,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)TC(t,e[s],n,r,i);return null}return n=Dx(n),t&&t[du]?t.P(e,n,uu(r)?!!r.capture:!!r,i):kC(t,e,n,!0,r,i)}function IC(t,e,n,r,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)IC(t,e[s],n,r,i);else r=uu(r)?!!r.capture:!!r,n=Dx(n),t&&t[du]?(t=t.i,e=String(e).toString(),e in t.g&&(s=t.g[e],n=uy(s,n,r,i),-1<n&&(em(s[n]),Array.prototype.splice.call(s,n,1),s.length==0&&(delete t.g[e],t.h--)))):t&&(t=Nx(t))&&(e=t.g[e.toString()],t=-1,e&&(t=uy(e,n,r,i)),(n=-1<t?e[t]:null)&&Px(n))}function Px(t){if(typeof t!="number"&&t&&!t.fa){var e=t.src;if(e&&e[du])cy(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(CC(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Nx(e))?(cy(n,t),n.h==0&&(n.src=null,e[Rx]=null)):em(t)}}}function CC(t){return t in og?og[t]:og[t]="on"+t}function rB(t,e){if(t.fa)t=!0;else{e=new Ac(e,this);var n=t.listener,r=t.la||t.src;t.ia&&Px(t),t=n.call(r,e)}return t}function Nx(t){return t=t[Rx],t instanceof tm?t:null}var ag="__closure_events_fn_"+(1e9*Math.random()>>>0);function Dx(t){return typeof t=="function"?t:(t[ag]||(t[ag]=function(e){return t.handleEvent(e)}),t[ag])}function kt(){xs.call(this),this.i=new tm(this),this.S=this,this.J=null}Tt(kt,xs);kt.prototype[du]=!0;kt.prototype.removeEventListener=function(t,e,n,r){IC(this,t,e,n,r)};function Dt(t,e){var n,r=t.J;if(r)for(n=[];r;r=r.J)n.push(r);if(t=t.S,r=e.type||e,typeof e=="string")e=new qt(e,t);else if(e instanceof qt)e.target=e.target||t;else{var i=e;e=new qt(r,t),SC(e,i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=e.g=n[s];i=sd(o,r,!0,e)&&i}if(o=e.g=t,i=sd(o,r,!0,e)&&i,i=sd(o,r,!1,e)&&i,n)for(s=0;s<n.length;s++)o=e.g=n[s],i=sd(o,r,!1,e)&&i}kt.prototype.N=function(){if(kt.$.N.call(this),this.i){var t=this.i,e;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)em(n[r]);delete t.g[e],t.h--}}this.J=null};kt.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)};kt.prototype.P=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};function sd(t,e,n,r){if(e=t.i.g[String(e)],!e)return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.fa&&o.capture==n){var a=o.listener,l=o.la||o.src;o.ia&&cy(t.i,o),i=a.call(l,r)!==!1&&i}}return i&&!r.defaultPrevented}var jx=ae.JSON.stringify;class iB{constructor(e,n){this.i=e,this.j=n,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}function sB(){var t=Ox;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}class oB{constructor(){this.h=this.g=null}add(e,n){const r=AC.get();r.set(e,n),this.h?this.h.next=r:this.g=r,this.h=r}}var AC=new iB(()=>new aB,t=>t.reset());class aB{constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}}function lB(t){var e=1;t=t.split(":");const n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function cB(t){ae.setTimeout(()=>{throw t},0)}let Rc,Pc=!1,Ox=new oB,RC=()=>{const t=ae.Promise.resolve(void 0);Rc=()=>{t.then(uB)}};var uB=()=>{for(var t;t=sB();){try{t.h.call(t.g)}catch(n){cB(n)}var e=AC;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}Pc=!1};function nm(t,e){kt.call(this),this.h=t||1,this.g=e||ae,this.j=Ht(this.qb,this),this.l=Date.now()}Tt(nm,kt);B=nm.prototype;B.ga=!1;B.T=null;B.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),Dt(this,"tick"),this.ga&&(Mx(this),this.start()))}};B.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function Mx(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}B.N=function(){nm.$.N.call(this),Mx(this),delete this.g};function Lx(t,e,n){if(typeof t=="function")n&&(t=Ht(t,n));else if(t&&typeof t.handleEvent=="function")t=Ht(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:ae.setTimeout(t,e||0)}function PC(t){t.g=Lx(()=>{t.g=null,t.i&&(t.i=!1,PC(t))},t.j);const e=t.h;t.h=null,t.m.apply(null,e)}class dB extends xs{constructor(e,n){super(),this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:PC(this)}N(){super.N(),this.g&&(ae.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Nc(t){xs.call(this),this.h=t,this.g={}}Tt(Nc,xs);var nS=[];function NC(t,e,n,r){Array.isArray(n)||(n&&(nS[0]=n.toString()),n=nS);for(var i=0;i<n.length;i++){var s=bC(e,n[i],r||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}}function DC(t){Ax(t.g,function(e,n){this.g.hasOwnProperty(n)&&Px(e)},t),t.g={}}Nc.prototype.N=function(){Nc.$.N.call(this),DC(this)};Nc.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function rm(){this.g=!0}rm.prototype.Ea=function(){this.g=!1};function hB(t,e,n,r,i,s){t.info(function(){if(t.g)if(s)for(var o="",a=s.split("&"),l=0;l<a.length;l++){var c=a[l].split("=");if(1<c.length){var d=c[0];c=c[1];var h=d.split("_");o=2<=h.length&&h[1]=="type"?o+(d+"="+c+"&"):o+(d+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+`
`+n+`
`+o})}function fB(t,e,n,r,i,s,o){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+`
`+n+`
`+s+" "+o})}function ea(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+pB(t,n)+(r?" "+r:"")})}function mB(t,e){t.info(function(){return"TIMEOUT: "+e})}rm.prototype.info=function(){};function pB(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n){for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if(s!="noop"&&s!="stop"&&s!="close")for(var o=1;o<i.length;o++)i[o]=""}}}}return jx(n)}catch{return e}}var So={},rS=null;function im(){return rS=rS||new kt}So.Ta="serverreachability";function jC(t){qt.call(this,So.Ta,t)}Tt(jC,qt);function Dc(t){const e=im();Dt(e,new jC(e))}So.STAT_EVENT="statevent";function OC(t,e){qt.call(this,So.STAT_EVENT,t),this.stat=e}Tt(OC,qt);function nn(t){const e=im();Dt(e,new OC(e,t))}So.Ua="timingevent";function MC(t,e){qt.call(this,So.Ua,t),this.size=e}Tt(MC,qt);function hu(t,e){if(typeof t!="function")throw Error("Fn must not be null and must be a function");return ae.setTimeout(function(){t()},e)}var sm={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},LC={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function Fx(){}Fx.prototype.h=null;function iS(t){return t.h||(t.h=t.i())}function FC(){}var fu={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function $x(){qt.call(this,"d")}Tt($x,qt);function zx(){qt.call(this,"c")}Tt(zx,qt);var dy;function om(){}Tt(om,Fx);om.prototype.g=function(){return new XMLHttpRequest};om.prototype.i=function(){return{}};dy=new om;function mu(t,e,n,r){this.l=t,this.j=e,this.m=n,this.W=r||1,this.U=new Nc(this),this.P=gB,t=oy?125:void 0,this.V=new nm(t),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new $C}function $C(){this.i=null,this.g="",this.h=!1}var gB=45e3,hy={},Vh={};B=mu.prototype;B.setTimeout=function(t){this.P=t};function fy(t,e,n){t.L=1,t.v=lm(hi(e)),t.s=n,t.S=!0,zC(t,null)}function zC(t,e){t.G=Date.now(),pu(t),t.A=hi(t.v);var n=t.A,r=t.W;Array.isArray(r)||(r=[String(r)]),KC(n.i,"t",r),t.C=0,n=t.l.J,t.h=new $C,t.g=pA(t.l,n?e:null,!t.s),0<t.O&&(t.M=new dB(Ht(t.Pa,t,t.g),t.O)),NC(t.U,t.g,"readystatechange",t.nb),e=t.I?EC(t.I):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.A,t.u,t.s,e)):(t.u="GET",t.g.ha(t.A,t.u,null,e)),Dc(),hB(t.j,t.u,t.A,t.m,t.W,t.s)}B.nb=function(t){t=t.target;const e=this.M;e&&Ir(t)==3?e.l():this.Pa(t)};B.Pa=function(t){try{if(t==this.g)e:{const d=Ir(this.g);var e=this.g.Ia();const h=this.g.da();if(!(3>d)&&(d!=3||oy||this.g&&(this.h.h||this.g.ja()||lS(this.g)))){this.J||d!=4||e==7||(e==8||0>=h?Dc(3):Dc(2)),am(this);var n=this.g.da();this.ca=n;t:if(BC(this)){var r=lS(this.g);t="";var i=r.length,s=Ir(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Ls(this),Hl(this);var o="";break t}this.h.i=new ae.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,t+=this.h.i.decode(r[e],{stream:s&&e==i-1});r.splice(0,i),this.h.g+=t,this.C=0,o=this.h.g}else o=this.g.ja();if(this.i=n==200,fB(this.j,this.u,this.A,this.m,this.W,d,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,l=this.g;if((a=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Cc(a)){var c=a;break t}}c=null}if(n=c)ea(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,my(this,n);else{this.i=!1,this.o=3,nn(12),Ls(this),Hl(this);break e}}this.S?(VC(this,d,o),oy&&this.i&&d==3&&(NC(this.U,this.V,"tick",this.mb),this.V.start())):(ea(this.j,this.m,o,null),my(this,o)),d==4&&Ls(this),this.i&&!this.J&&(d==4?dA(this.l,this):(this.i=!1,pu(this)))}else LB(this.g),n==400&&0<o.indexOf("Unknown SID")?(this.o=3,nn(12)):(this.o=0,nn(13)),Ls(this),Hl(this)}}}catch{}finally{}};function BC(t){return t.g?t.u=="GET"&&t.L!=2&&t.l.Ha:!1}function VC(t,e,n){let r=!0,i;for(;!t.J&&t.C<n.length;)if(i=yB(t,n),i==Vh){e==4&&(t.o=4,nn(14),r=!1),ea(t.j,t.m,null,"[Incomplete Response]");break}else if(i==hy){t.o=4,nn(15),ea(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}else ea(t.j,t.m,i,null),my(t,i);BC(t)&&i!=Vh&&i!=hy&&(t.h.g="",t.C=0),e!=4||n.length!=0||t.h.h||(t.o=1,nn(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.ba&&(t.ba=!0,e=t.l,e.g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),qx(e),e.M=!0,nn(11))):(ea(t.j,t.m,n,"[Invalid Chunked Response]"),Ls(t),Hl(t))}B.mb=function(){if(this.g){var t=Ir(this.g),e=this.g.ja();this.C<e.length&&(am(this),VC(this,t,e),this.i&&t!=4&&pu(this))}};function yB(t,e){var n=t.C,r=e.indexOf(`
`,n);return r==-1?Vh:(n=Number(e.substring(n,r)),isNaN(n)?hy:(r+=1,r+n>e.length?Vh:(e=e.slice(r,r+n),t.C=r+n,e)))}B.cancel=function(){this.J=!0,Ls(this)};function pu(t){t.Y=Date.now()+t.P,UC(t,t.P)}function UC(t,e){if(t.B!=null)throw Error("WatchDog timer not null");t.B=hu(Ht(t.lb,t),e)}function am(t){t.B&&(ae.clearTimeout(t.B),t.B=null)}B.lb=function(){this.B=null;const t=Date.now();0<=t-this.Y?(mB(this.j,this.A),this.L!=2&&(Dc(),nn(17)),Ls(this),this.o=2,Hl(this)):UC(this,this.Y-t)};function Hl(t){t.l.H==0||t.J||dA(t.l,t)}function Ls(t){am(t);var e=t.M;e&&typeof e.sa=="function"&&e.sa(),t.M=null,Mx(t.V),DC(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function my(t,e){try{var n=t.l;if(n.H!=0&&(n.g==t||py(n.i,t))){if(!t.K&&py(n.i,t)&&n.H==3){try{var r=n.Ja.g.parse(e)}catch{r=null}if(Array.isArray(r)&&r.length==3){var i=r;if(i[0]==0){e:if(!n.u){if(n.g)if(n.g.G+3e3<t.G)Hh(n),hm(n);else break e;Hx(n),nn(18)}}else n.Fa=i[1],0<n.Fa-n.V&&37500>i[2]&&n.G&&n.A==0&&!n.v&&(n.v=hu(Ht(n.ib,n),6e3));if(1>=YC(n.i)&&n.oa){try{n.oa()}catch{}n.oa=void 0}}else Fs(n,11)}else if((t.K||n.g==t)&&Hh(n),!Cc(e))for(i=n.Ja.g.parse(e),e=0;e<i.length;e++){let c=i[e];if(n.V=c[0],c=c[1],n.H==2)if(c[0]=="c"){n.K=c[1],n.pa=c[2];const d=c[3];d!=null&&(n.ra=d,n.l.info("VER="+n.ra));const h=c[4];h!=null&&(n.Ga=h,n.l.info("SVER="+n.Ga));const m=c[5];m!=null&&typeof m=="number"&&0<m&&(r=1.5*m,n.L=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;const p=t.g;if(p){const y=p.g?p.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(y){var s=r.i;s.g||y.indexOf("spdy")==-1&&y.indexOf("quic")==-1&&y.indexOf("h2")==-1||(s.j=s.l,s.g=new Set,s.h&&(Bx(s,s.h),s.h=null))}if(r.F){const x=p.g?p.g.getResponseHeader("X-HTTP-Session-Id"):null;x&&(r.Da=x,Le(r.I,r.F,x))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-t.G,n.l.info("Handshake RTT: "+n.S+"ms")),r=n;var o=t;if(r.wa=mA(r,r.J?r.pa:null,r.Y),o.K){JC(r.i,o);var a=o,l=r.L;l&&a.setTimeout(l),a.B&&(am(a),pu(a)),r.g=o}else cA(r);0<n.j.length&&fm(n)}else c[0]!="stop"&&c[0]!="close"||Fs(n,7);else n.H==3&&(c[0]=="stop"||c[0]=="close"?c[0]=="stop"?Fs(n,7):Wx(n):c[0]!="noop"&&n.h&&n.h.Aa(c),n.A=0)}}Dc(4)}catch{}}function vB(t){if(t.Z&&typeof t.Z=="function")return t.Z();if(typeof Map<"u"&&t instanceof Map||typeof Set<"u"&&t instanceof Set)return Array.from(t.values());if(typeof t=="string")return t.split("");if(Jf(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}e=[],n=0;for(r in t)e[n++]=t[r];return e}function xB(t){if(t.ta&&typeof t.ta=="function")return t.ta();if(!t.Z||typeof t.Z!="function"){if(typeof Map<"u"&&t instanceof Map)return Array.from(t.keys());if(!(typeof Set<"u"&&t instanceof Set)){if(Jf(t)||typeof t=="string"){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(const r in t)e[n++]=r;return e}}}function WC(t,e){if(t.forEach&&typeof t.forEach=="function")t.forEach(e,void 0);else if(Jf(t)||typeof t=="string")Array.prototype.forEach.call(t,e,void 0);else for(var n=xB(t),r=vB(t),i=r.length,s=0;s<i;s++)e.call(void 0,r[s],n&&n[s],t)}var HC=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function wB(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var s=t[n].substring(0,r);i=t[n].substring(r+1)}else s=t[n];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function Ws(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof Ws){this.h=t.h,Uh(this,t.j),this.s=t.s,this.g=t.g,Wh(this,t.m),this.l=t.l;var e=t.i,n=new jc;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),sS(this,n),this.o=t.o}else t&&(e=String(t).match(HC))?(this.h=!1,Uh(this,e[1]||"",!0),this.s=Al(e[2]||""),this.g=Al(e[3]||"",!0),Wh(this,e[4]),this.l=Al(e[5]||"",!0),sS(this,e[6]||"",!0),this.o=Al(e[7]||"")):(this.h=!1,this.i=new jc(null,this.h))}Ws.prototype.toString=function(){var t=[],e=this.j;e&&t.push(Rl(e,oS,!0),":");var n=this.g;return(n||e=="file")&&(t.push("//"),(e=this.s)&&t.push(Rl(e,oS,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&t.push(":",String(n))),(n=this.l)&&(this.g&&n.charAt(0)!="/"&&t.push("/"),t.push(Rl(n,n.charAt(0)=="/"?SB:EB,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",Rl(n,kB)),t.join("")};function hi(t){return new Ws(t)}function Uh(t,e,n){t.j=n?Al(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function Wh(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function sS(t,e,n){e instanceof jc?(t.i=e,TB(t.i,t.h)):(n||(e=Rl(e,bB)),t.i=new jc(e,t.h))}function Le(t,e,n){t.i.set(e,n)}function lm(t){return Le(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function Al(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Rl(t,e,n){return typeof t=="string"?(t=encodeURI(t).replace(e,_B),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function _B(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(t&15).toString(16)}var oS=/[#\/\?@]/g,EB=/[#\?:]/g,SB=/[#\?]/g,bB=/[#\?@]/g,kB=/#/g;function jc(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function ws(t){t.g||(t.g=new Map,t.h=0,t.i&&wB(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}B=jc.prototype;B.add=function(t,e){ws(this),this.i=null,t=Ja(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this};function qC(t,e){ws(t),e=Ja(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function GC(t,e){return ws(t),e=Ja(t,e),t.g.has(e)}B.forEach=function(t,e){ws(this),this.g.forEach(function(n,r){n.forEach(function(i){t.call(e,i,r,this)},this)},this)};B.ta=function(){ws(this);const t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let r=0;r<e.length;r++){const i=t[r];for(let s=0;s<i.length;s++)n.push(e[r])}return n};B.Z=function(t){ws(this);let e=[];if(typeof t=="string")GC(this,t)&&(e=e.concat(this.g.get(Ja(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e};B.set=function(t,e){return ws(this),this.i=null,t=Ja(this,t),GC(this,t)&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this};B.get=function(t,e){return t?(t=this.Z(t),0<t.length?String(t[0]):e):e};function KC(t,e,n){qC(t,e),0<n.length&&(t.i=null,t.g.set(Ja(t,e),Ix(n)),t.h+=n.length)}B.toString=function(){if(this.i)return this.i;if(!this.g)return"";const t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var r=e[n];const s=encodeURIComponent(String(r)),o=this.Z(r);for(r=0;r<o.length;r++){var i=s;o[r]!==""&&(i+="="+encodeURIComponent(String(o[r]))),t.push(i)}}return this.i=t.join("&")};function Ja(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function TB(t,e){e&&!t.j&&(ws(t),t.i=null,t.g.forEach(function(n,r){var i=r.toLowerCase();r!=i&&(qC(this,r),KC(this,i,n))},t)),t.j=e}var IB=class{constructor(t,e){this.g=t,this.map=e}};function XC(t){this.l=t||CB,ae.PerformanceNavigationTiming?(t=ae.performance.getEntriesByType("navigation"),t=0<t.length&&(t[0].nextHopProtocol=="hq"||t[0].nextHopProtocol=="h2")):t=!!(ae.g&&ae.g.Ka&&ae.g.Ka()&&ae.g.Ka().ec),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var CB=10;function QC(t){return t.h?!0:t.g?t.g.size>=t.j:!1}function YC(t){return t.h?1:t.g?t.g.size:0}function py(t,e){return t.h?t.h==e:t.g?t.g.has(e):!1}function Bx(t,e){t.g?t.g.add(e):t.h=e}function JC(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}XC.prototype.cancel=function(){if(this.i=ZC(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const t of this.g.values())t.cancel();this.g.clear()}};function ZC(t){if(t.h!=null)return t.i.concat(t.h.F);if(t.g!=null&&t.g.size!==0){let e=t.i;for(const n of t.g.values())e=e.concat(n.F);return e}return Ix(t.i)}var AB=class{stringify(t){return ae.JSON.stringify(t,void 0)}parse(t){return ae.JSON.parse(t,void 0)}};function RB(){this.g=new AB}function PB(t,e,n){const r=n||"";try{WC(t,function(i,s){let o=i;uu(i)&&(o=jx(i)),e.push(r+s+"="+encodeURIComponent(o))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function NB(t,e){const n=new rm;if(ae.Image){const r=new Image;r.onload=id(od,n,r,"TestLoadImage: loaded",!0,e),r.onerror=id(od,n,r,"TestLoadImage: error",!1,e),r.onabort=id(od,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=id(od,n,r,"TestLoadImage: timeout",!1,e),ae.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}function od(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch{}}function cm(t){this.l=t.fc||null,this.j=t.ob||!1}Tt(cm,Fx);cm.prototype.g=function(){return new um(this.l,this.j)};cm.prototype.i=function(t){return function(){return t}}({});function um(t,e){kt.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=Vx,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Tt(um,kt);var Vx=0;B=um.prototype;B.open=function(t,e){if(this.readyState!=Vx)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Oc(this)};B.send=function(t){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||ae).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))};B.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,gu(this)),this.readyState=Vx};B.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Oc(this)),this.g&&(this.readyState=3,Oc(this),this.g)))if(this.responseType==="arraybuffer")t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof ae.ReadableStream<"u"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;eA(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))};function eA(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}B.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?gu(this):Oc(this),this.readyState==3&&eA(this)}};B.Za=function(t){this.g&&(this.response=this.responseText=t,gu(this))};B.Ya=function(t){this.g&&(this.response=t,gu(this))};B.ka=function(){this.g&&gu(this)};function gu(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Oc(t)}B.setRequestHeader=function(t,e){this.v.append(t,e)};B.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""};B.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join(`\r
`)};function Oc(t){t.onreadystatechange&&t.onreadystatechange.call(t)}Object.defineProperty(um.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(t){this.m=t?"include":"same-origin"}});var DB=ae.JSON.parse;function Ye(t){kt.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=tA,this.L=this.M=!1}Tt(Ye,kt);var tA="",jB=/^https?$/i,OB=["POST","PUT"];B=Ye.prototype;B.Oa=function(t){this.M=t};B.ha=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():dy.g(),this.C=this.u?iS(this.u):iS(dy),this.g.onreadystatechange=Ht(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(s){aS(this,s);return}if(t=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else if(typeof r.keys=="function"&&typeof r.get=="function")for(const s of r.keys())n.set(s,r.get(s));else throw Error("Unknown input type for opt_headers: "+String(r));r=Array.from(n.keys()).find(s=>s.toLowerCase()=="content-type"),i=ae.FormData&&t instanceof ae.FormData,!(0<=vC(OB,e))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[s,o]of n)this.g.setRequestHeader(s,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{iA(this),0<this.B&&((this.L=MB(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Ht(this.ua,this)):this.A=Lx(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(s){aS(this,s)}};function MB(t){return Pa&&typeof t.timeout=="number"&&t.ontimeout!==void 0}B.ua=function(){typeof Tx<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Dt(this,"timeout"),this.abort(8))};function aS(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,nA(t),dm(t)}function nA(t){t.F||(t.F=!0,Dt(t,"complete"),Dt(t,"error"))}B.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,Dt(this,"complete"),Dt(this,"abort"),dm(this))};B.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),dm(this,!0)),Ye.$.N.call(this)};B.La=function(){this.s||(this.G||this.v||this.l?rA(this):this.kb())};B.kb=function(){rA(this)};function rA(t){if(t.h&&typeof Tx<"u"&&(!t.C[1]||Ir(t)!=4||t.da()!=2)){if(t.v&&Ir(t)==4)Lx(t.La,0,t);else if(Dt(t,"readystatechange"),Ir(t)==4){t.h=!1;try{const o=t.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var r;if(r=o===0){var i=String(t.I).match(HC)[1]||null;!i&&ae.self&&ae.self.location&&(i=ae.self.location.protocol.slice(0,-1)),r=!jB.test(i?i.toLowerCase():"")}n=r}if(n)Dt(t,"complete"),Dt(t,"success");else{t.m=6;try{var s=2<Ir(t)?t.g.statusText:""}catch{s=""}t.j=s+" ["+t.da()+"]",nA(t)}}finally{dm(t)}}}}function dm(t,e){if(t.g){iA(t);const n=t.g,r=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||Dt(t,"ready");try{n.onreadystatechange=r}catch{}}}function iA(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(ae.clearTimeout(t.A),t.A=null)}B.isActive=function(){return!!this.g};function Ir(t){return t.g?t.g.readyState:0}B.da=function(){try{return 2<Ir(this)?this.g.status:-1}catch{return-1}};B.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};B.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&e.indexOf(t)==0&&(e=e.substring(t.length)),DB(e)}};function lS(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case tA:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}function LB(t){const e={};t=(t.g&&2<=Ir(t)&&t.g.getAllResponseHeaders()||"").split(`\r
`);for(let r=0;r<t.length;r++){if(Cc(t[r]))continue;var n=lB(t[r]);const i=n[0];if(n=n[1],typeof n!="string")continue;n=n.trim();const s=e[i]||[];e[i]=s,s.push(n)}tB(e,function(r){return r.join(", ")})}B.Ia=function(){return this.m};B.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function sA(t){let e="";return Ax(t,function(n,r){e+=r,e+=":",e+=n,e+=`\r
`}),e}function Ux(t,e,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=sA(n),typeof t=="string"?n!=null&&encodeURIComponent(String(n)):Le(t,e,n))}function wl(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function oA(t){this.Ga=0,this.j=[],this.l=new rm,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=wl("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=wl("baseRetryDelayMs",5e3,t),this.hb=wl("retryDelaySeedMs",1e4,t),this.eb=wl("forwardChannelMaxRetries",2,t),this.xa=wl("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.dc||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new XC(t&&t.concurrentRequestLimit),this.Ja=new RB,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}B=oA.prototype;B.ra=8;B.H=1;function Wx(t){if(aA(t),t.H==3){var e=t.W++,n=hi(t.I);if(Le(n,"SID",t.K),Le(n,"RID",e),Le(n,"TYPE","terminate"),yu(t,n),e=new mu(t,t.l,e),e.L=2,e.v=lm(hi(n)),n=!1,ae.navigator&&ae.navigator.sendBeacon)try{n=ae.navigator.sendBeacon(e.v.toString(),"")}catch{}!n&&ae.Image&&(new Image().src=e.v,n=!0),n||(e.g=pA(e.l,null),e.g.ha(e.v)),e.G=Date.now(),pu(e)}fA(t)}function hm(t){t.g&&(qx(t),t.g.cancel(),t.g=null)}function aA(t){hm(t),t.u&&(ae.clearTimeout(t.u),t.u=null),Hh(t),t.i.cancel(),t.m&&(typeof t.m=="number"&&ae.clearTimeout(t.m),t.m=null)}function fm(t){if(!QC(t.i)&&!t.m){t.m=!0;var e=t.Na;Rc||RC(),Pc||(Rc(),Pc=!0),Ox.add(e,t),t.C=0}}function FB(t,e){return YC(t.i)>=t.i.j-(t.m?1:0)?!1:t.m?(t.j=e.F.concat(t.j),!0):t.H==1||t.H==2||t.C>=(t.cb?0:t.eb)?!1:(t.m=hu(Ht(t.Na,t,e),hA(t,t.C)),t.C++,!0)}B.Na=function(t){if(this.m)if(this.m=null,this.H==1){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;const i=new mu(this,this.l,t);let s=this.s;if(this.U&&(s?(s=EC(s),SC(s,this.U)):s=this.U),this.o!==null||this.O||(i.I=s,s=null),this.P)e:{for(var e=0,n=0;n<this.j.length;n++){t:{var r=this.j[n];if("__data__"in r.map&&(r=r.map.__data__,typeof r=="string")){r=r.length;break t}r=void 0}if(r===void 0)break;if(e+=r,4096<e){e=n;break e}if(e===4096||n===this.j.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=lA(this,i,e),n=hi(this.I),Le(n,"RID",t),Le(n,"CVER",22),this.F&&Le(n,"X-HTTP-Session-Id",this.F),yu(this,n),s&&(this.O?e="headers="+encodeURIComponent(String(sA(s)))+"&"+e:this.o&&Ux(n,this.o,s)),Bx(this.i,i),this.bb&&Le(n,"TYPE","init"),this.P?(Le(n,"$req",e),Le(n,"SID","null"),i.aa=!0,fy(i,n,null)):fy(i,n,e),this.H=2}}else this.H==3&&(t?cS(this,t):this.j.length==0||QC(this.i)||cS(this))};function cS(t,e){var n;e?n=e.m:n=t.W++;const r=hi(t.I);Le(r,"SID",t.K),Le(r,"RID",n),Le(r,"AID",t.V),yu(t,r),t.o&&t.s&&Ux(r,t.o,t.s),n=new mu(t,t.l,n,t.C+1),t.o===null&&(n.I=t.s),e&&(t.j=e.F.concat(t.j)),e=lA(t,n,1e3),n.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),Bx(t.i,n),fy(n,r,e)}function yu(t,e){t.na&&Ax(t.na,function(n,r){Le(e,r,n)}),t.h&&WC({},function(n,r){Le(e,r,n)})}function lA(t,e,n){n=Math.min(t.j.length,n);var r=t.h?Ht(t.h.Va,t.h,t):null;e:{var i=t.j;let s=-1;for(;;){const o=["count="+n];s==-1?0<n?(s=i[0].g,o.push("ofs="+s)):s=0:o.push("ofs="+s);let a=!0;for(let l=0;l<n;l++){let c=i[l].g;const d=i[l].map;if(c-=s,0>c)s=Math.max(0,i[l].g-100),a=!1;else try{PB(d,o,"req"+c+"_")}catch{r&&r(d)}}if(a){r=o.join("&");break e}}}return t=t.j.splice(0,n),e.F=t,r}function cA(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;Rc||RC(),Pc||(Rc(),Pc=!0),Ox.add(e,t),t.A=0}}function Hx(t){return t.g||t.u||3<=t.A?!1:(t.ba++,t.u=hu(Ht(t.Ma,t),hA(t,t.A)),t.A++,!0)}B.Ma=function(){if(this.u=null,uA(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=hu(Ht(this.jb,this),t)}};B.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,nn(10),hm(this),uA(this))};function qx(t){t.B!=null&&(ae.clearTimeout(t.B),t.B=null)}function uA(t){t.g=new mu(t,t.l,"rpc",t.ba),t.o===null&&(t.g.I=t.s),t.g.O=0;var e=hi(t.wa);Le(e,"RID","rpc"),Le(e,"SID",t.K),Le(e,"AID",t.V),Le(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&Le(e,"TO",t.qa),Le(e,"TYPE","xmlhttp"),yu(t,e),t.o&&t.s&&Ux(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var n=t.g;t=t.pa,n.L=1,n.v=lm(hi(e)),n.s=null,n.S=!0,zC(n,t)}B.ib=function(){this.v!=null&&(this.v=null,hm(this),Hx(this),nn(19))};function Hh(t){t.v!=null&&(ae.clearTimeout(t.v),t.v=null)}function dA(t,e){var n=null;if(t.g==e){Hh(t),qx(t),t.g=null;var r=2}else if(py(t.i,e))n=e.F,JC(t.i,e),r=1;else return;if(t.H!=0){if(e.i)if(r==1){n=e.s?e.s.length:0,e=Date.now()-e.G;var i=t.C;r=im(),Dt(r,new MC(r,n)),fm(t)}else cA(t);else if(i=e.o,i==3||i==0&&0<e.ca||!(r==1&&FB(t,e)||r==2&&Hx(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),i){case 1:Fs(t,5);break;case 4:Fs(t,10);break;case 3:Fs(t,6);break;default:Fs(t,2)}}}function hA(t,e){let n=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(n*=2),n*e}function Fs(t,e){if(t.l.info("Error code "+e),e==2){var n=null;t.h&&(n=null);var r=Ht(t.pb,t);n||(n=new Ws("//www.google.com/images/cleardot.gif"),ae.location&&ae.location.protocol=="http"||Uh(n,"https"),lm(n)),NB(n.toString(),r)}else nn(2);t.H=0,t.h&&t.h.za(e),fA(t),aA(t)}B.pb=function(t){t?(this.l.info("Successfully pinged google.com"),nn(2)):(this.l.info("Failed to ping google.com"),nn(1))};function fA(t){if(t.H=0,t.ma=[],t.h){const e=ZC(t.i);(e.length!=0||t.j.length!=0)&&(ZE(t.ma,e),ZE(t.ma,t.j),t.i.i.length=0,Ix(t.j),t.j.length=0),t.h.ya()}}function mA(t,e,n){var r=n instanceof Ws?hi(n):new Ws(n);if(r.g!="")e&&(r.g=e+"."+r.g),Wh(r,r.m);else{var i=ae.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var s=new Ws(null);r&&Uh(s,r),e&&(s.g=e),i&&Wh(s,i),n&&(s.l=n),r=s}return n=t.F,e=t.Da,n&&e&&Le(r,n,e),Le(r,"VER",t.ra),yu(t,r),r}function pA(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return e=n&&t.Ha&&!t.va?new Ye(new cm({ob:!0})):new Ye(t.va),e.Oa(t.J),e}B.isActive=function(){return!!this.h&&this.h.isActive(this)};function gA(){}B=gA.prototype;B.Ba=function(){};B.Aa=function(){};B.za=function(){};B.ya=function(){};B.isActive=function(){return!0};B.Va=function(){};function qh(){if(Pa&&!(10<=Number(Y8)))throw Error("Environmental error: no available transport.")}qh.prototype.g=function(t,e){return new On(t,e)};function On(t,e){kt.call(this),this.g=new oA(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!Cc(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Cc(e)&&(this.g.F=e,t=this.h,t!==null&&e in t&&(t=this.h,e in t&&delete t[e])),this.j=new Za(this)}Tt(On,kt);On.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,n=this.h||void 0;nn(0),t.Y=e,t.na=n||{},t.G=t.aa,t.I=mA(t,null,t.Y),fm(t)};On.prototype.close=function(){Wx(this.g)};On.prototype.u=function(t){var e=this.g;if(typeof t=="string"){var n={};n.__data__=t,t=n}else this.v&&(n={},n.__data__=jx(t),t=n);e.j.push(new IB(e.fb++,t)),e.H==3&&fm(e)};On.prototype.N=function(){this.g.h=null,delete this.j,Wx(this.g),delete this.g,On.$.N.call(this)};function yA(t){$x.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){e:{for(const n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=e!==null&&t in e?e[t]:void 0),this.data=e}else this.data=t}Tt(yA,$x);function vA(){zx.call(this),this.status=1}Tt(vA,zx);function Za(t){this.g=t}Tt(Za,gA);Za.prototype.Ba=function(){Dt(this.g,"a")};Za.prototype.Aa=function(t){Dt(this.g,new yA(t))};Za.prototype.za=function(t){Dt(this.g,new vA)};Za.prototype.ya=function(){Dt(this.g,"b")};function $B(){this.blockSize=-1}function pr(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}Tt(pr,$B);pr.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function lg(t,e,n){n||(n=0);var r=Array(16);if(typeof e=="string")for(var i=0;16>i;++i)r[i]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],i=t.g[2];var s=t.g[3],o=e+(s^n&(i^s))+r[0]+3614090360&4294967295;e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[1]+3905402710&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[2]+606105819&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[3]+3250441966&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[4]+4118548399&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[5]+1200080426&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[6]+2821735955&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[7]+4249261313&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[8]+1770035416&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[9]+2336552879&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[10]+4294925233&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[11]+2304563134&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[12]+1804603682&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[13]+4254626195&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[14]+2792965006&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[15]+1236535329&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(i^s&(n^i))+r[1]+4129170786&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[6]+3225465664&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[11]+643717713&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[0]+3921069994&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[5]+3593408605&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[10]+38016083&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[15]+3634488961&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[4]+3889429448&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[9]+568446438&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[14]+3275163606&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[3]+4107603335&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[8]+1163531501&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[13]+2850285829&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[2]+4243563512&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[7]+1735328473&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[12]+2368359562&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(n^i^s)+r[5]+4294588738&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[8]+2272392833&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[11]+1839030562&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[14]+4259657740&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[1]+2763975236&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[4]+1272893353&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[7]+4139469664&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[10]+3200236656&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[13]+681279174&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[0]+3936430074&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[3]+3572445317&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[6]+76029189&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[9]+3654602809&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[12]+3873151461&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[15]+530742520&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[2]+3299628645&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(i^(n|~s))+r[0]+4096336452&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[7]+1126891415&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[14]+2878612391&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[5]+4237533241&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[12]+1700485571&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[3]+2399980690&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[10]+4293915773&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[1]+2240044497&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[8]+1873313359&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[15]+4264355552&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[6]+2734768916&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[13]+1309151649&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[4]+4149444226&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[11]+3174756917&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[2]+718787259&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,t.g[2]=t.g[2]+i&4294967295,t.g[3]=t.g[3]+s&4294967295}pr.prototype.j=function(t,e){e===void 0&&(e=t.length);for(var n=e-this.blockSize,r=this.m,i=this.h,s=0;s<e;){if(i==0)for(;s<=n;)lg(this,t,s),s+=this.blockSize;if(typeof t=="string"){for(;s<e;)if(r[i++]=t.charCodeAt(s++),i==this.blockSize){lg(this,r),i=0;break}}else for(;s<e;)if(r[i++]=t[s++],i==this.blockSize){lg(this,r),i=0;break}}this.h=i,this.i+=e};pr.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=n&255,n/=256;for(this.j(t),t=Array(16),e=n=0;4>e;++e)for(var r=0;32>r;r+=8)t[n++]=this.g[e]>>>r&255;return t};function Ie(t,e){this.h=e;for(var n=[],r=!0,i=t.length-1;0<=i;i--){var s=t[i]|0;r&&s==e||(n[i]=s,r=!1)}this.g=n}var zB={};function Gx(t){return-128<=t&&128>t?K8(t,function(e){return new Ie([e|0],0>e?-1:0)}):new Ie([t|0],0>t?-1:0)}function Cr(t){if(isNaN(t)||!isFinite(t))return ua;if(0>t)return Rt(Cr(-t));for(var e=[],n=1,r=0;t>=n;r++)e[r]=t/n|0,n*=gy;return new Ie(e,0)}function xA(t,e){if(t.length==0)throw Error("number format error: empty string");if(e=e||10,2>e||36<e)throw Error("radix out of range: "+e);if(t.charAt(0)=="-")return Rt(xA(t.substring(1),e));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var n=Cr(Math.pow(e,8)),r=ua,i=0;i<t.length;i+=8){var s=Math.min(8,t.length-i),o=parseInt(t.substring(i,i+s),e);8>s?(s=Cr(Math.pow(e,s)),r=r.R(s).add(Cr(o))):(r=r.R(n),r=r.add(Cr(o)))}return r}var gy=4294967296,ua=Gx(0),yy=Gx(1),uS=Gx(16777216);B=Ie.prototype;B.ea=function(){if(Gn(this))return-Rt(this).ea();for(var t=0,e=1,n=0;n<this.g.length;n++){var r=this.D(n);t+=(0<=r?r:gy+r)*e,e*=gy}return t};B.toString=function(t){if(t=t||10,2>t||36<t)throw Error("radix out of range: "+t);if(ti(this))return"0";if(Gn(this))return"-"+Rt(this).toString(t);for(var e=Cr(Math.pow(t,6)),n=this,r="";;){var i=Kh(n,e).g;n=Gh(n,i.R(e));var s=((0<n.g.length?n.g[0]:n.h)>>>0).toString(t);if(n=i,ti(n))return s+r;for(;6>s.length;)s="0"+s;r=s+r}};B.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h};function ti(t){if(t.h!=0)return!1;for(var e=0;e<t.g.length;e++)if(t.g[e]!=0)return!1;return!0}function Gn(t){return t.h==-1}B.X=function(t){return t=Gh(this,t),Gn(t)?-1:ti(t)?0:1};function Rt(t){for(var e=t.g.length,n=[],r=0;r<e;r++)n[r]=~t.g[r];return new Ie(n,~t.h).add(yy)}B.abs=function(){return Gn(this)?Rt(this):this};B.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0,i=0;i<=e;i++){var s=r+(this.D(i)&65535)+(t.D(i)&65535),o=(s>>>16)+(this.D(i)>>>16)+(t.D(i)>>>16);r=o>>>16,s&=65535,o&=65535,n[i]=o<<16|s}return new Ie(n,n[n.length-1]&-2147483648?-1:0)};function Gh(t,e){return t.add(Rt(e))}B.R=function(t){if(ti(this)||ti(t))return ua;if(Gn(this))return Gn(t)?Rt(this).R(Rt(t)):Rt(Rt(this).R(t));if(Gn(t))return Rt(this.R(Rt(t)));if(0>this.X(uS)&&0>t.X(uS))return Cr(this.ea()*t.ea());for(var e=this.g.length+t.g.length,n=[],r=0;r<2*e;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<t.g.length;i++){var s=this.D(r)>>>16,o=this.D(r)&65535,a=t.D(i)>>>16,l=t.D(i)&65535;n[2*r+2*i]+=o*l,ad(n,2*r+2*i),n[2*r+2*i+1]+=s*l,ad(n,2*r+2*i+1),n[2*r+2*i+1]+=o*a,ad(n,2*r+2*i+1),n[2*r+2*i+2]+=s*a,ad(n,2*r+2*i+2)}for(r=0;r<e;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=e;r<2*e;r++)n[r]=0;return new Ie(n,0)};function ad(t,e){for(;(t[e]&65535)!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function _l(t,e){this.g=t,this.h=e}function Kh(t,e){if(ti(e))throw Error("division by zero");if(ti(t))return new _l(ua,ua);if(Gn(t))return e=Kh(Rt(t),e),new _l(Rt(e.g),Rt(e.h));if(Gn(e))return e=Kh(t,Rt(e)),new _l(Rt(e.g),e.h);if(30<t.g.length){if(Gn(t)||Gn(e))throw Error("slowDivide_ only works with positive integers.");for(var n=yy,r=e;0>=r.X(t);)n=dS(n),r=dS(r);var i=Oo(n,1),s=Oo(r,1);for(r=Oo(r,2),n=Oo(n,2);!ti(r);){var o=s.add(r);0>=o.X(t)&&(i=i.add(n),s=o),r=Oo(r,1),n=Oo(n,1)}return e=Gh(t,i.R(e)),new _l(i,e)}for(i=ua;0<=t.X(e);){for(n=Math.max(1,Math.floor(t.ea()/e.ea())),r=Math.ceil(Math.log(n)/Math.LN2),r=48>=r?1:Math.pow(2,r-48),s=Cr(n),o=s.R(e);Gn(o)||0<o.X(t);)n-=r,s=Cr(n),o=s.R(e);ti(s)&&(s=yy),i=i.add(s),t=Gh(t,o)}return new _l(i,t)}B.gb=function(t){return Kh(this,t).h};B.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)&t.D(r);return new Ie(n,this.h&t.h)};B.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)|t.D(r);return new Ie(n,this.h|t.h)};B.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)^t.D(r);return new Ie(n,this.h^t.h)};function dS(t){for(var e=t.g.length+1,n=[],r=0;r<e;r++)n[r]=t.D(r)<<1|t.D(r-1)>>>31;return new Ie(n,t.h)}function Oo(t,e){var n=e>>5;e%=32;for(var r=t.g.length-n,i=[],s=0;s<r;s++)i[s]=0<e?t.D(s+n)>>>e|t.D(s+n+1)<<32-e:t.D(s+n);return new Ie(i,t.h)}qh.prototype.createWebChannel=qh.prototype.g;On.prototype.send=On.prototype.u;On.prototype.open=On.prototype.m;On.prototype.close=On.prototype.close;sm.NO_ERROR=0;sm.TIMEOUT=8;sm.HTTP_ERROR=6;LC.COMPLETE="complete";FC.EventType=fu;fu.OPEN="a";fu.CLOSE="b";fu.ERROR="c";fu.MESSAGE="d";kt.prototype.listen=kt.prototype.O;Ye.prototype.listenOnce=Ye.prototype.P;Ye.prototype.getLastError=Ye.prototype.Sa;Ye.prototype.getLastErrorCode=Ye.prototype.Ia;Ye.prototype.getStatus=Ye.prototype.da;Ye.prototype.getResponseJson=Ye.prototype.Wa;Ye.prototype.getResponseText=Ye.prototype.ja;Ye.prototype.send=Ye.prototype.ha;Ye.prototype.setWithCredentials=Ye.prototype.Oa;pr.prototype.digest=pr.prototype.l;pr.prototype.reset=pr.prototype.reset;pr.prototype.update=pr.prototype.j;Ie.prototype.add=Ie.prototype.add;Ie.prototype.multiply=Ie.prototype.R;Ie.prototype.modulo=Ie.prototype.gb;Ie.prototype.compare=Ie.prototype.X;Ie.prototype.toNumber=Ie.prototype.ea;Ie.prototype.toString=Ie.prototype.toString;Ie.prototype.getBits=Ie.prototype.D;Ie.fromNumber=Cr;Ie.fromString=xA;var BB=function(){return new qh},VB=function(){return im()},cg=sm,UB=LC,WB=So,hS={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},ld=FC,HB=Ye,qB=pr,da=Ie;const fS="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Bt.UNAUTHENTICATED=new Bt(null),Bt.GOOGLE_CREDENTIALS=new Bt("google-credentials-uid"),Bt.FIRST_PARTY=new Bt("first-party-uid"),Bt.MOCK_USER=new Bt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let el="10.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const so=new px("@firebase/firestore");function mS(){return so.logLevel}function Y(t,...e){if(so.logLevel<=_e.DEBUG){const n=e.map(Kx);so.debug(`Firestore (${el}): ${t}`,...n)}}function fi(t,...e){if(so.logLevel<=_e.ERROR){const n=e.map(Kx);so.error(`Firestore (${el}): ${t}`,...n)}}function Na(t,...e){if(so.logLevel<=_e.WARN){const n=e.map(Kx);so.warn(`Firestore (${el}): ${t}`,...n)}}function Kx(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oe(t="Unexpected state"){const e=`FIRESTORE (${el}) INTERNAL ASSERTION FAILED: `+t;throw fi(e),new Error(e)}function ze(t,e){t||oe()}function de(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class U extends Ur{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oi{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wA{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class GB{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Bt.UNAUTHENTICATED))}shutdown(){}}class KB{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class XB{constructor(e){this.t=e,this.currentUser=Bt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){let r=this.i;const i=l=>this.i!==r?(r=this.i,n(l)):Promise.resolve();let s=new oi;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new oi,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},a=l=>{Y("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(Y("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new oi)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(Y("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ze(typeof r.accessToken=="string"),new wA(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return ze(e===null||typeof e=="string"),new Bt(e)}}class QB{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=Bt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class YB{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new QB(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(Bt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class JB{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class ZB{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){const r=s=>{s.error!=null&&Y("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.R;return this.R=s.token,Y("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{Y("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):Y("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(ze(typeof n.token=="string"),this.R=n.token,new JB(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eV(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _A{static V(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=eV(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%e.length))}return r}}function Ee(t,e){return t<e?-1:t>e?1:0}function Da(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vt{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new U(D.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new U(D.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new U(D.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new U(D.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return vt.fromMillis(Date.now())}static fromDate(e){return vt.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new vt(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Ee(this.nanoseconds,e.nanoseconds):Ee(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class le{constructor(e){this.timestamp=e}static fromTimestamp(e){return new le(e)}static min(){return new le(new vt(0,0))}static max(){return new le(new vt(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mc{constructor(e,n,r){n===void 0?n=0:n>e.length&&oe(),r===void 0?r=e.length-n:r>e.length-n&&oe(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Mc.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Mc?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=e.get(i),o=n.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class Fe extends Mc{construct(e,n,r){return new Fe(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new U(D.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new Fe(n)}static emptyPath(){return new Fe([])}}const tV=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Wt extends Mc{construct(e,n,r){return new Wt(e,n,r)}static isValidIdentifier(e){return tV.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Wt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Wt(["__name__"])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new U(D.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<e.length;){const a=e[i];if(a==="\\"){if(i+1===e.length)throw new U(D.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new U(D.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new U(D.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Wt(n)}static emptyPath(){return new Wt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z{constructor(e){this.path=e}static fromPath(e){return new Z(Fe.fromString(e))}static fromName(e){return new Z(Fe.fromString(e).popFirst(5))}static empty(){return new Z(Fe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Fe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Fe.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Z(new Fe(e.slice()))}}function nV(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=le.fromTimestamp(r===1e9?new vt(n+1,0):new vt(n,r));return new os(i,Z.empty(),e)}function rV(t){return new os(t.readTime,t.key,-1)}class os{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new os(le.min(),Z.empty(),-1)}static max(){return new os(le.max(),Z.empty(),-1)}}function iV(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=Z.comparator(t.documentKey,e.documentKey),n!==0?n:Ee(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sV="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class oV{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vu(t){if(t.code!==D.FAILED_PRECONDITION||t.message!==sV)throw t;Y("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&oe(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new F((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof F?n:F.resolve(n)}catch(n){return F.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):F.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):F.reject(n)}static resolve(e){return new F((n,r)=>{n(e)})}static reject(e){return new F((n,r)=>{r(e)})}static waitFor(e){return new F((n,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},l=>r(l))}),o=!0,s===i&&n()})}static or(e){let n=F.resolve(!1);for(const r of e)n=n.next(i=>i?F.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new F((r,i)=>{const s=e.length,o=new Array(s);let a=0;for(let l=0;l<s;l++){const c=l;n(e[c]).next(d=>{o[c]=d,++a,a===s&&r(o)},d=>i(d))}})}static doWhile(e,n){return new F((r,i)=>{const s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}}function xu(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xx{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.oe(r),this._e=r=>n.writeSequenceNumber(r))}oe(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this._e&&this._e(e),e}}Xx.ae=-1;function mm(t){return t==null}function Xh(t){return t===0&&1/t==-1/0}function aV(t){return typeof t=="number"&&Number.isInteger(t)&&!Xh(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pS(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function tl(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function EA(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ke{constructor(e,n){this.comparator=e,this.root=n||At.EMPTY}insert(e,n){return new Ke(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,At.BLACK,null,null))}remove(e){return new Ke(this.comparator,this.root.remove(e,this.comparator).copy(null,null,At.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new cd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new cd(this.root,e,this.comparator,!1)}getReverseIterator(){return new cd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new cd(this.root,e,this.comparator,!0)}}class cd{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class At{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??At.RED,this.left=i??At.EMPTY,this.right=s??At.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new At(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return At.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return At.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,At.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,At.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw oe();const e=this.left.check();if(e!==this.right.check())throw oe();return e+(this.isRed()?0:1)}}At.EMPTY=null,At.RED=!0,At.BLACK=!1;At.EMPTY=new class{constructor(){this.size=0}get key(){throw oe()}get value(){throw oe()}get color(){throw oe()}get left(){throw oe()}get right(){throw oe()}copy(e,n,r,i,s){return this}insert(e,n,r){return new At(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gt{constructor(e){this.comparator=e,this.data=new Ke(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new gS(this.data.getIterator())}getIteratorFrom(e){return new gS(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Gt)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Gt(this.comparator);return n.data=e,n}}class gS{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dr{constructor(e){this.fields=e,e.sort(Wt.comparator)}static empty(){return new dr([])}unionWith(e){let n=new Gt(Wt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new dr(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Da(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SA extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new SA("Invalid base64 string: "+s):s}}(e);return new Qt(n)}static fromUint8Array(e){const n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new Qt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ee(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Qt.EMPTY_BYTE_STRING=new Qt("");const lV=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function as(t){if(ze(!!t),typeof t=="string"){let e=0;const n=lV.exec(t);if(ze(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ut(t.seconds),nanos:ut(t.nanos)}}function ut(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function oo(t){return typeof t=="string"?Qt.fromBase64String(t):Qt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qx(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function Yx(t){const e=t.mapValue.fields.__previous_value__;return Qx(e)?Yx(e):e}function Lc(t){const e=as(t.mapValue.fields.__local_write_time__.timestampValue);return new vt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cV{constructor(e,n,r,i,s,o,a,l,c){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=c}}class Fc{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new Fc("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Fc&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ud={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function ao(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Qx(t)?4:uV(t)?9007199254740991:10:oe()}function $r(t,e){if(t===e)return!0;const n=ao(t);if(n!==ao(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Lc(t).isEqual(Lc(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=as(i.timestampValue),a=as(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return oo(i.bytesValue).isEqual(oo(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return ut(i.geoPointValue.latitude)===ut(s.geoPointValue.latitude)&&ut(i.geoPointValue.longitude)===ut(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return ut(i.integerValue)===ut(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=ut(i.doubleValue),a=ut(s.doubleValue);return o===a?Xh(o)===Xh(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return Da(t.arrayValue.values||[],e.arrayValue.values||[],$r);case 10:return function(i,s){const o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(pS(o)!==pS(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!$r(o[l],a[l])))return!1;return!0}(t,e);default:return oe()}}function $c(t,e){return(t.values||[]).find(n=>$r(n,e))!==void 0}function ja(t,e){if(t===e)return 0;const n=ao(t),r=ao(e);if(n!==r)return Ee(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Ee(t.booleanValue,e.booleanValue);case 2:return function(s,o){const a=ut(s.integerValue||s.doubleValue),l=ut(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(t,e);case 3:return yS(t.timestampValue,e.timestampValue);case 4:return yS(Lc(t),Lc(e));case 5:return Ee(t.stringValue,e.stringValue);case 6:return function(s,o){const a=oo(s),l=oo(o);return a.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){const a=s.split("/"),l=o.split("/");for(let c=0;c<a.length&&c<l.length;c++){const d=Ee(a[c],l[c]);if(d!==0)return d}return Ee(a.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){const a=Ee(ut(s.latitude),ut(o.latitude));return a!==0?a:Ee(ut(s.longitude),ut(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(s,o){const a=s.values||[],l=o.values||[];for(let c=0;c<a.length&&c<l.length;++c){const d=ja(a[c],l[c]);if(d)return d}return Ee(a.length,l.length)}(t.arrayValue,e.arrayValue);case 10:return function(s,o){if(s===ud.mapValue&&o===ud.mapValue)return 0;if(s===ud.mapValue)return 1;if(o===ud.mapValue)return-1;const a=s.fields||{},l=Object.keys(a),c=o.fields||{},d=Object.keys(c);l.sort(),d.sort();for(let h=0;h<l.length&&h<d.length;++h){const m=Ee(l[h],d[h]);if(m!==0)return m;const p=ja(a[l[h]],c[d[h]]);if(p!==0)return p}return Ee(l.length,d.length)}(t.mapValue,e.mapValue);default:throw oe()}}function yS(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Ee(t,e);const n=as(t),r=as(e),i=Ee(n.seconds,r.seconds);return i!==0?i:Ee(n.nanos,r.nanos)}function Oa(t){return vy(t)}function vy(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=as(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return oo(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return Z.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=vy(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${vy(n.fields[o])}`;return i+"}"}(t.mapValue):oe()}function vS(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function xy(t){return!!t&&"integerValue"in t}function Jx(t){return!!t&&"arrayValue"in t}function xS(t){return!!t&&"nullValue"in t}function wS(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function $d(t){return!!t&&"mapValue"in t}function ql(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return tl(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=ql(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=ql(t.arrayValue.values[n]);return e}return Object.assign({},t)}function uV(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kn{constructor(e){this.value=e}static empty(){return new Kn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!$d(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=ql(n)}setAll(e){let n=Wt.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=ql(o):i.push(a.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());$d(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return $r(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];$d(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){tl(n,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new Kn(ql(this.value))}}function bA(t){const e=[];return tl(t.fields,(n,r)=>{const i=new Wt([n]);if($d(r)){const s=bA(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new dr(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ut{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new Ut(e,0,le.min(),le.min(),le.min(),Kn.empty(),0)}static newFoundDocument(e,n,r,i){return new Ut(e,1,n,le.min(),r,i,0)}static newNoDocument(e,n){return new Ut(e,2,n,le.min(),le.min(),Kn.empty(),0)}static newUnknownDocument(e,n){return new Ut(e,3,n,le.min(),le.min(),Kn.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(le.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Kn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Kn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=le.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Ut&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ut(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qh{constructor(e,n){this.position=e,this.inclusive=n}}function _S(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],o=t.position[i];if(s.field.isKeyField()?r=Z.comparator(Z.fromName(o.referenceValue),n.key):r=ja(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function ES(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!$r(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gl{constructor(e,n="asc"){this.field=e,this.dir=n}}function dV(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kA{}class ht extends kA{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new fV(e,n,r):n==="array-contains"?new gV(e,r):n==="in"?new yV(e,r):n==="not-in"?new vV(e,r):n==="array-contains-any"?new xV(e,r):new ht(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new mV(e,r):new pV(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(ja(n,this.value)):n!==null&&ao(this.value)===ao(n)&&this.matchesComparison(ja(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return oe()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class gr extends kA{constructor(e,n){super(),this.filters=e,this.op=n,this.ce=null}static create(e,n){return new gr(e,n)}matches(e){return TA(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ce!==null||(this.ce=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ce}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){const e=this.le(n=>n.isInequality());return e!==null?e.field:null}le(e){for(const n of this.getFlattenedFilters())if(e(n))return n;return null}}function TA(t){return t.op==="and"}function IA(t){return hV(t)&&TA(t)}function hV(t){for(const e of t.filters)if(e instanceof gr)return!1;return!0}function wy(t){if(t instanceof ht)return t.field.canonicalString()+t.op.toString()+Oa(t.value);if(IA(t))return t.filters.map(e=>wy(e)).join(",");{const e=t.filters.map(n=>wy(n)).join(",");return`${t.op}(${e})`}}function CA(t,e){return t instanceof ht?function(r,i){return i instanceof ht&&r.op===i.op&&r.field.isEqual(i.field)&&$r(r.value,i.value)}(t,e):t instanceof gr?function(r,i){return i instanceof gr&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&CA(o,i.filters[a]),!0):!1}(t,e):void oe()}function AA(t){return t instanceof ht?function(n){return`${n.field.canonicalString()} ${n.op} ${Oa(n.value)}`}(t):t instanceof gr?function(n){return n.op.toString()+" {"+n.getFilters().map(AA).join(" ,")+"}"}(t):"Filter"}class fV extends ht{constructor(e,n,r){super(e,n,r),this.key=Z.fromName(r.referenceValue)}matches(e){const n=Z.comparator(e.key,this.key);return this.matchesComparison(n)}}class mV extends ht{constructor(e,n){super(e,"in",n),this.keys=RA("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class pV extends ht{constructor(e,n){super(e,"not-in",n),this.keys=RA("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function RA(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>Z.fromName(r.referenceValue))}class gV extends ht{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Jx(n)&&$c(n.arrayValue,this.value)}}class yV extends ht{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&$c(this.value.arrayValue,n)}}class vV extends ht{constructor(e,n){super(e,"not-in",n)}matches(e){if($c(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!$c(this.value.arrayValue,n)}}class xV extends ht{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Jx(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>$c(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wV{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.he=null}}function SS(t,e=null,n=[],r=[],i=null,s=null,o=null){return new wV(t,e,n,r,i,s,o)}function Zx(t){const e=de(t);if(e.he===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>wy(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),mm(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Oa(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Oa(r)).join(",")),e.he=n}return e.he}function e1(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!dV(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!CA(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!ES(t.startAt,e.startAt)&&ES(t.endAt,e.endAt)}function _y(t){return Z.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wu{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=l,this.Pe=null,this.Ie=null,this.Te=null,this.startAt,this.endAt}}function _V(t,e,n,r,i,s,o,a){return new wu(t,e,n,r,i,s,o,a)}function t1(t){return new wu(t)}function bS(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function PA(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function n1(t){for(const e of t.filters){const n=e.getFirstInequalityField();if(n!==null)return n}return null}function NA(t){return t.collectionGroup!==null}function Kl(t){const e=de(t);if(e.Pe===null){e.Pe=[];const n=n1(e),r=PA(e);if(n!==null&&r===null)n.isKeyField()||e.Pe.push(new Gl(n)),e.Pe.push(new Gl(Wt.keyField(),"asc"));else{let i=!1;for(const s of e.explicitOrderBy)e.Pe.push(s),s.field.isKeyField()&&(i=!0);if(!i){const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.Pe.push(new Gl(Wt.keyField(),s))}}}return e.Pe}function mi(t){const e=de(t);return e.Ie||(e.Ie=EV(e,Kl(t))),e.Ie}function EV(t,e){if(t.limitType==="F")return SS(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new Gl(i.field,s)});const n=t.endAt?new Qh(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Qh(t.startAt.position,t.startAt.inclusive):null;return SS(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Ey(t,e){e.getFirstInequalityField(),n1(t);const n=t.filters.concat([e]);return new wu(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Sy(t,e,n){return new wu(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function pm(t,e){return e1(mi(t),mi(e))&&t.limitType===e.limitType}function DA(t){return`${Zx(mi(t))}|lt:${t.limitType}`}function by(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>AA(i)).join(", ")}]`),mm(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>Oa(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>Oa(i)).join(",")),`Target(${r})`}(mi(t))}; limitType=${t.limitType})`}function gm(t,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):Z.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(const s of Kl(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,a,l){const c=_S(o,a,l);return o.inclusive?c<=0:c<0}(r.startAt,Kl(r),i)||r.endAt&&!function(o,a,l){const c=_S(o,a,l);return o.inclusive?c>=0:c>0}(r.endAt,Kl(r),i))}(t,e)}function SV(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function jA(t){return(e,n)=>{let r=!1;for(const i of Kl(t)){const s=bV(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function bV(t,e,n){const r=t.field.isKeyField()?Z.comparator(e.key,n.key):function(s,o,a){const l=o.data.field(s),c=a.data.field(s);return l!==null&&c!==null?ja(l,c):oe()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return oe()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nl{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){tl(this.inner,(n,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return EA(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kV=new Ke(Z.comparator);function pi(){return kV}const OA=new Ke(Z.comparator);function Pl(...t){let e=OA;for(const n of t)e=e.insert(n.key,n);return e}function MA(t){let e=OA;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function $s(){return Xl()}function LA(){return Xl()}function Xl(){return new nl(t=>t.toString(),(t,e)=>t.isEqual(e))}const TV=new Ke(Z.comparator),IV=new Gt(Z.comparator);function pe(...t){let e=IV;for(const n of t)e=e.add(n);return e}const CV=new Gt(Ee);function AV(){return CV}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FA(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Xh(e)?"-0":e}}function $A(t){return{integerValue:""+t}}function RV(t,e){return aV(e)?$A(e):FA(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ym{constructor(){this._=void 0}}function PV(t,e,n){return t instanceof Yh?function(i,s){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Qx(s)&&(s=Yx(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(n,e):t instanceof zc?BA(t,e):t instanceof Bc?VA(t,e):function(i,s){const o=zA(i,s),a=kS(o)+kS(i.Ee);return xy(o)&&xy(i.Ee)?$A(a):FA(i.serializer,a)}(t,e)}function NV(t,e,n){return t instanceof zc?BA(t,e):t instanceof Bc?VA(t,e):n}function zA(t,e){return t instanceof Jh?function(r){return xy(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class Yh extends ym{}class zc extends ym{constructor(e){super(),this.elements=e}}function BA(t,e){const n=UA(e);for(const r of t.elements)n.some(i=>$r(i,r))||n.push(r);return{arrayValue:{values:n}}}class Bc extends ym{constructor(e){super(),this.elements=e}}function VA(t,e){let n=UA(e);for(const r of t.elements)n=n.filter(i=>!$r(i,r));return{arrayValue:{values:n}}}class Jh extends ym{constructor(e,n){super(),this.serializer=e,this.Ee=n}}function kS(t){return ut(t.integerValue||t.doubleValue)}function UA(t){return Jx(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function DV(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof zc&&i instanceof zc||r instanceof Bc&&i instanceof Bc?Da(r.elements,i.elements,$r):r instanceof Jh&&i instanceof Jh?$r(r.Ee,i.Ee):r instanceof Yh&&i instanceof Yh}(t.transform,e.transform)}class jV{constructor(e,n){this.version=e,this.transformResults=n}}class Or{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Or}static exists(e){return new Or(void 0,e)}static updateTime(e){return new Or(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function zd(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class vm{}function WA(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new r1(t.key,Or.none()):new _u(t.key,t.data,Or.none());{const n=t.data,r=Kn.empty();let i=new Gt(Wt.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new bo(t.key,r,new dr(i.toArray()),Or.none())}}function OV(t,e,n){t instanceof _u?function(i,s,o){const a=i.value.clone(),l=IS(i.fieldTransforms,s,o.transformResults);a.setAll(l),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof bo?function(i,s,o){if(!zd(i.precondition,s))return void s.convertToUnknownDocument(o.version);const a=IS(i.fieldTransforms,s,o.transformResults),l=s.data;l.setAll(HA(i)),l.setAll(a),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function Ql(t,e,n,r){return t instanceof _u?function(s,o,a,l){if(!zd(s.precondition,o))return a;const c=s.value.clone(),d=CS(s.fieldTransforms,l,o);return c.setAll(d),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(t,e,n,r):t instanceof bo?function(s,o,a,l){if(!zd(s.precondition,o))return a;const c=CS(s.fieldTransforms,l,o),d=o.data;return d.setAll(HA(s)),d.setAll(c),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(h=>h.field))}(t,e,n,r):function(s,o,a){return zd(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function MV(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=zA(r.transform,i||null);s!=null&&(n===null&&(n=Kn.empty()),n.set(r.field,s))}return n||null}function TS(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Da(r,i,(s,o)=>DV(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class _u extends vm{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class bo extends vm{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function HA(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function IS(t,e,n){const r=new Map;ze(t.length===n.length);for(let i=0;i<n.length;i++){const s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,NV(o,a,n[i]))}return r}function CS(t,e,n){const r=new Map;for(const i of t){const s=i.transform,o=n.data.field(i.field);r.set(i.field,PV(s,o,e))}return r}class r1 extends vm{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class LV extends vm{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FV{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&OV(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Ql(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Ql(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=LA();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;const l=WA(o,a);l!==null&&r.set(i.key,l),o.isValidDocument()||o.convertToNoDocument(le.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),pe())}isEqual(e){return this.batchId===e.batchId&&Da(this.mutations,e.mutations,(n,r)=>TS(n,r))&&Da(this.baseMutations,e.baseMutations,(n,r)=>TS(n,r))}}class i1{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){ze(e.mutations.length===r.length);let i=function(){return TV}();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new i1(e,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $V{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zV{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ct,ve;function BV(t){switch(t){default:return oe();case D.CANCELLED:case D.UNKNOWN:case D.DEADLINE_EXCEEDED:case D.RESOURCE_EXHAUSTED:case D.INTERNAL:case D.UNAVAILABLE:case D.UNAUTHENTICATED:return!1;case D.INVALID_ARGUMENT:case D.NOT_FOUND:case D.ALREADY_EXISTS:case D.PERMISSION_DENIED:case D.FAILED_PRECONDITION:case D.ABORTED:case D.OUT_OF_RANGE:case D.UNIMPLEMENTED:case D.DATA_LOSS:return!0}}function qA(t){if(t===void 0)return fi("GRPC error has no .code"),D.UNKNOWN;switch(t){case ct.OK:return D.OK;case ct.CANCELLED:return D.CANCELLED;case ct.UNKNOWN:return D.UNKNOWN;case ct.DEADLINE_EXCEEDED:return D.DEADLINE_EXCEEDED;case ct.RESOURCE_EXHAUSTED:return D.RESOURCE_EXHAUSTED;case ct.INTERNAL:return D.INTERNAL;case ct.UNAVAILABLE:return D.UNAVAILABLE;case ct.UNAUTHENTICATED:return D.UNAUTHENTICATED;case ct.INVALID_ARGUMENT:return D.INVALID_ARGUMENT;case ct.NOT_FOUND:return D.NOT_FOUND;case ct.ALREADY_EXISTS:return D.ALREADY_EXISTS;case ct.PERMISSION_DENIED:return D.PERMISSION_DENIED;case ct.FAILED_PRECONDITION:return D.FAILED_PRECONDITION;case ct.ABORTED:return D.ABORTED;case ct.OUT_OF_RANGE:return D.OUT_OF_RANGE;case ct.UNIMPLEMENTED:return D.UNIMPLEMENTED;case ct.DATA_LOSS:return D.DATA_LOSS;default:return oe()}}(ve=ct||(ct={}))[ve.OK=0]="OK",ve[ve.CANCELLED=1]="CANCELLED",ve[ve.UNKNOWN=2]="UNKNOWN",ve[ve.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ve[ve.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ve[ve.NOT_FOUND=5]="NOT_FOUND",ve[ve.ALREADY_EXISTS=6]="ALREADY_EXISTS",ve[ve.PERMISSION_DENIED=7]="PERMISSION_DENIED",ve[ve.UNAUTHENTICATED=16]="UNAUTHENTICATED",ve[ve.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ve[ve.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ve[ve.ABORTED=10]="ABORTED",ve[ve.OUT_OF_RANGE=11]="OUT_OF_RANGE",ve[ve.UNIMPLEMENTED=12]="UNIMPLEMENTED",ve[ve.INTERNAL=13]="INTERNAL",ve[ve.UNAVAILABLE=14]="UNAVAILABLE",ve[ve.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VV(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UV=new da([4294967295,4294967295],0);function AS(t){const e=VV().encode(t),n=new qB;return n.update(e),new Uint8Array(n.digest())}function RS(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new da([n,r],0),new da([i,s],0)]}class s1{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Nl(`Invalid padding: ${n}`);if(r<0)throw new Nl(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Nl(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Nl(`Invalid padding when bitmap length is 0: ${n}`);this.Ae=8*e.length-n,this.Re=da.fromNumber(this.Ae)}Ve(e,n,r){let i=e.add(n.multiply(da.fromNumber(r)));return i.compare(UV)===1&&(i=new da([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Re).toNumber()}me(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ae===0)return!1;const n=AS(e),[r,i]=RS(n);for(let s=0;s<this.hashCount;s++){const o=this.Ve(r,i,s);if(!this.me(o))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new s1(s,i,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Ae===0)return;const n=AS(e),[r,i]=RS(n);for(let s=0;s<this.hashCount;s++){const o=this.Ve(r,i,s);this.fe(o)}}fe(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Nl extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xm{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,Eu.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new xm(le.min(),i,new Ke(Ee),pi(),pe())}}class Eu{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Eu(r,n,pe(),pe(),pe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bd{constructor(e,n,r,i){this.ge=e,this.removedTargetIds=n,this.key=r,this.pe=i}}class GA{constructor(e,n){this.targetId=e,this.ye=n}}class KA{constructor(e,n,r=Qt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class PS{constructor(){this.we=0,this.Se=DS(),this.be=Qt.EMPTY_BYTE_STRING,this.De=!1,this.ve=!0}get current(){return this.De}get resumeToken(){return this.be}get Ce(){return this.we!==0}get Fe(){return this.ve}Me(e){e.approximateByteSize()>0&&(this.ve=!0,this.be=e)}xe(){let e=pe(),n=pe(),r=pe();return this.Se.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:oe()}}),new Eu(this.be,this.De,e,n,r)}Oe(){this.ve=!1,this.Se=DS()}Ne(e,n){this.ve=!0,this.Se=this.Se.insert(e,n)}Be(e){this.ve=!0,this.Se=this.Se.remove(e)}Le(){this.we+=1}ke(){this.we-=1}qe(){this.ve=!0,this.De=!0}}class WV{constructor(e){this.Qe=e,this.Ke=new Map,this.$e=pi(),this.Ue=NS(),this.We=new Ke(Ee)}Ge(e){for(const n of e.ge)e.pe&&e.pe.isFoundDocument()?this.ze(n,e.pe):this.je(n,e.key,e.pe);for(const n of e.removedTargetIds)this.je(n,e.key,e.pe)}He(e){this.forEachTarget(e,n=>{const r=this.Je(n);switch(e.state){case 0:this.Ye(n)&&r.Me(e.resumeToken);break;case 1:r.ke(),r.Ce||r.Oe(),r.Me(e.resumeToken);break;case 2:r.ke(),r.Ce||this.removeTarget(n);break;case 3:this.Ye(n)&&(r.qe(),r.Me(e.resumeToken));break;case 4:this.Ye(n)&&(this.Ze(n),r.Me(e.resumeToken));break;default:oe()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Ke.forEach((r,i)=>{this.Ye(i)&&n(i)})}Xe(e){const n=e.targetId,r=e.ye.count,i=this.et(n);if(i){const s=i.target;if(_y(s))if(r===0){const o=new Z(s.path);this.je(n,o,Ut.newNoDocument(o,le.min()))}else ze(r===1);else{const o=this.tt(n);if(o!==r){const a=this.nt(e),l=a?this.rt(a,e,o):1;if(l!==0){this.Ze(n);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.We=this.We.insert(n,c)}}}}}nt(e){const n=e.ye.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let o,a;try{o=oo(r).toUint8Array()}catch(l){if(l instanceof SA)return Na("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new s1(o,i,s)}catch(l){return Na(l instanceof Nl?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.Ae===0?null:a}rt(e,n,r){return n.ye.count===r-this.ot(e,n.targetId)?0:2}ot(e,n){const r=this.Qe.getRemoteKeysForTarget(n);let i=0;return r.forEach(s=>{const o=this.Qe.st(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.je(n,s,null),i++)}),i}_t(e){const n=new Map;this.Ke.forEach((s,o)=>{const a=this.et(o);if(a){if(s.current&&_y(a.target)){const l=new Z(a.target.path);this.$e.get(l)!==null||this.ut(o,l)||this.je(o,l,Ut.newNoDocument(l,e))}s.Fe&&(n.set(o,s.xe()),s.Oe())}});let r=pe();this.Ue.forEach((s,o)=>{let a=!0;o.forEachWhile(l=>{const c=this.et(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.$e.forEach((s,o)=>o.setReadTime(e));const i=new xm(e,n,this.We,this.$e,r);return this.$e=pi(),this.Ue=NS(),this.We=new Ke(Ee),i}ze(e,n){if(!this.Ye(e))return;const r=this.ut(e,n.key)?2:0;this.Je(e).Ne(n.key,r),this.$e=this.$e.insert(n.key,n),this.Ue=this.Ue.insert(n.key,this.ct(n.key).add(e))}je(e,n,r){if(!this.Ye(e))return;const i=this.Je(e);this.ut(e,n)?i.Ne(n,1):i.Be(n),this.Ue=this.Ue.insert(n,this.ct(n).delete(e)),r&&(this.$e=this.$e.insert(n,r))}removeTarget(e){this.Ke.delete(e)}tt(e){const n=this.Je(e).xe();return this.Qe.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Le(e){this.Je(e).Le()}Je(e){let n=this.Ke.get(e);return n||(n=new PS,this.Ke.set(e,n)),n}ct(e){let n=this.Ue.get(e);return n||(n=new Gt(Ee),this.Ue=this.Ue.insert(e,n)),n}Ye(e){const n=this.et(e)!==null;return n||Y("WatchChangeAggregator","Detected inactive target",e),n}et(e){const n=this.Ke.get(e);return n&&n.Ce?null:this.Qe.lt(e)}Ze(e){this.Ke.set(e,new PS),this.Qe.getRemoteKeysForTarget(e).forEach(n=>{this.je(e,n,null)})}ut(e,n){return this.Qe.getRemoteKeysForTarget(e).has(n)}}function NS(){return new Ke(Z.comparator)}function DS(){return new Ke(Z.comparator)}const HV=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),qV=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),GV=(()=>({and:"AND",or:"OR"}))();class KV{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function ky(t,e){return t.useProto3Json||mm(e)?e:{value:e}}function Zh(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function XA(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function XV(t,e){return Zh(t,e.toTimestamp())}function Mr(t){return ze(!!t),le.fromTimestamp(function(n){const r=as(n);return new vt(r.seconds,r.nanos)}(t))}function o1(t,e){return function(r){return new Fe(["projects",r.projectId,"databases",r.database])}(t).child("documents").child(e).canonicalString()}function QA(t){const e=Fe.fromString(t);return ze(eR(e)),e}function Ty(t,e){return o1(t.databaseId,e.path)}function ug(t,e){const n=QA(e);if(n.get(1)!==t.databaseId.projectId)throw new U(D.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new U(D.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Z(YA(n))}function Iy(t,e){return o1(t.databaseId,e)}function QV(t){const e=QA(t);return e.length===4?Fe.emptyPath():YA(e)}function Cy(t){return new Fe(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function YA(t){return ze(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function jS(t,e,n){return{name:Ty(t,e),fields:n.value.mapValue.fields}}function YV(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:oe()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(c,d){return c.useProto3Json?(ze(d===void 0||typeof d=="string"),Qt.fromBase64String(d||"")):(ze(d===void 0||d instanceof Uint8Array),Qt.fromUint8Array(d||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){const d=c.code===void 0?D.UNKNOWN:qA(c.code);return new U(d,c.message||"")}(o);n=new KA(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=ug(t,r.document.name),s=Mr(r.document.updateTime),o=r.document.createTime?Mr(r.document.createTime):le.min(),a=new Kn({mapValue:{fields:r.document.fields}}),l=Ut.newFoundDocument(i,s,o,a),c=r.targetIds||[],d=r.removedTargetIds||[];n=new Bd(c,d,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=ug(t,r.document),s=r.readTime?Mr(r.readTime):le.min(),o=Ut.newNoDocument(i,s),a=r.removedTargetIds||[];n=new Bd([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=ug(t,r.document),s=r.removedTargetIds||[];n=new Bd([],s,i,null)}else{if(!("filter"in e))return oe();{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new zV(i,s),a=r.targetId;n=new GA(a,o)}}return n}function JV(t,e){let n;if(e instanceof _u)n={update:jS(t,e.key,e.value)};else if(e instanceof r1)n={delete:Ty(t,e.key)};else if(e instanceof bo)n={update:jS(t,e.key,e.data),updateMask:aU(e.fieldMask)};else{if(!(e instanceof LV))return oe();n={verify:Ty(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const a=o.transform;if(a instanceof Yh)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof zc)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Bc)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Jh)return{fieldPath:o.field.canonicalString(),increment:a.Ee};throw oe()}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:XV(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:oe()}(t,e.precondition)),n}function ZV(t,e){return t&&t.length>0?(ze(e!==void 0),t.map(n=>function(i,s){let o=i.updateTime?Mr(i.updateTime):Mr(s);return o.isEqual(le.min())&&(o=Mr(s)),new jV(o,i.transformResults||[])}(n,e))):[]}function eU(t,e){return{documents:[Iy(t,e.path)]}}function tU(t,e){const n={structuredQuery:{}},r=e.path;e.collectionGroup!==null?(n.parent=Iy(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Iy(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);const i=function(l){if(l.length!==0)return ZA(gr.create(l,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const s=function(l){if(l.length!==0)return l.map(c=>function(h){return{field:Fo(h.field),direction:iU(h.dir)}}(c))}(e.orderBy);s&&(n.structuredQuery.orderBy=s);const o=ky(t,e.limit);return o!==null&&(n.structuredQuery.limit=o),e.startAt&&(n.structuredQuery.startAt=function(l){return{before:l.inclusive,values:l.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(e.endAt)),n}function nU(t){let e=QV(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){ze(r===1);const d=n.from[0];d.allDescendants?i=d.collectionId:e=e.child(d.collectionId)}let s=[];n.where&&(s=function(h){const m=JA(h);return m instanceof gr&&IA(m)?m.getFilters():[m]}(n.where));let o=[];n.orderBy&&(o=function(h){return h.map(m=>function(y){return new Gl($o(y.field),function(E){switch(E){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(y.direction))}(m))}(n.orderBy));let a=null;n.limit&&(a=function(h){let m;return m=typeof h=="object"?h.value:h,mm(m)?null:m}(n.limit));let l=null;n.startAt&&(l=function(h){const m=!!h.before,p=h.values||[];return new Qh(p,m)}(n.startAt));let c=null;return n.endAt&&(c=function(h){const m=!h.before,p=h.values||[];return new Qh(p,m)}(n.endAt)),_V(e,i,o,s,a,"F",l,c)}function rU(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return oe()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function JA(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=$o(n.unaryFilter.field);return ht.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=$o(n.unaryFilter.field);return ht.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=$o(n.unaryFilter.field);return ht.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=$o(n.unaryFilter.field);return ht.create(o,"!=",{nullValue:"NULL_VALUE"});default:return oe()}}(t):t.fieldFilter!==void 0?function(n){return ht.create($o(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return oe()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return gr.create(n.compositeFilter.filters.map(r=>JA(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return oe()}}(n.compositeFilter.op))}(t):oe()}function iU(t){return HV[t]}function sU(t){return qV[t]}function oU(t){return GV[t]}function Fo(t){return{fieldPath:t.canonicalString()}}function $o(t){return Wt.fromServerFormat(t.fieldPath)}function ZA(t){return t instanceof ht?function(n){if(n.op==="=="){if(wS(n.value))return{unaryFilter:{field:Fo(n.field),op:"IS_NAN"}};if(xS(n.value))return{unaryFilter:{field:Fo(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(wS(n.value))return{unaryFilter:{field:Fo(n.field),op:"IS_NOT_NAN"}};if(xS(n.value))return{unaryFilter:{field:Fo(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Fo(n.field),op:sU(n.op),value:n.value}}}(t):t instanceof gr?function(n){const r=n.getFilters().map(i=>ZA(i));return r.length===1?r[0]:{compositeFilter:{op:oU(n.op),filters:r}}}(t):oe()}function aU(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function eR(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bi{constructor(e,n,r,i,s=le.min(),o=le.min(),a=Qt.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new Bi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Bi(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Bi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Bi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lU{constructor(e){this.ht=e}}function cU(t){const e=nU({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Sy(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uU{constructor(){this._n=new dU}addToCollectionParentIndex(e,n){return this._n.add(n),F.resolve()}getCollectionParents(e,n){return F.resolve(this._n.getEntries(n))}addFieldIndex(e,n){return F.resolve()}deleteFieldIndex(e,n){return F.resolve()}getDocumentsMatchingTarget(e,n){return F.resolve(null)}getIndexType(e,n){return F.resolve(0)}getFieldIndexes(e,n){return F.resolve([])}getNextCollectionGroupToUpdate(e){return F.resolve(null)}getMinOffset(e,n){return F.resolve(os.min())}getMinOffsetFromCollectionGroup(e,n){return F.resolve(os.min())}updateCollectionGroup(e,n,r){return F.resolve()}updateIndexEntries(e,n){return F.resolve()}}class dU{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new Gt(Fe.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Gt(Fe.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ma{constructor(e){this.On=e}next(){return this.On+=2,this.On}static Nn(){return new Ma(0)}static Bn(){return new Ma(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hU{constructor(){this.changes=new nl(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Ut.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?F.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fU{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mU{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&Ql(r.mutation,i,dr.empty(),vt.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,pe()).next(()=>r))}getLocalViewOfDocuments(e,n,r=pe()){const i=$s();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=Pl();return s.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=$s();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,pe()))}populateOverlays(e,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,i){let s=pi();const o=Xl(),a=function(){return Xl()}();return n.forEach((l,c)=>{const d=r.get(c.key);i.has(c.key)&&(d===void 0||d.mutation instanceof bo)?s=s.insert(c.key,c):d!==void 0?(o.set(c.key,d.mutation.getFieldMask()),Ql(d.mutation,c,d.mutation.getFieldMask(),vt.now())):o.set(c.key,dr.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((c,d)=>o.set(c,d)),n.forEach((c,d)=>{var h;return a.set(c,new fU(d,(h=o.get(c))!==null&&h!==void 0?h:null))}),a))}recalculateAndSaveOverlays(e,n){const r=Xl();let i=new Ke((o,a)=>o-a),s=pe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(l=>{const c=n.get(l);if(c===null)return;let d=r.get(l)||dr.empty();d=a.applyToLocalView(c,d),r.set(l,d);const h=(i.get(a.batchId)||pe()).add(l);i=i.insert(a.batchId,h)})}).next(()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),c=l.key,d=l.value,h=LA();d.forEach(m=>{if(!s.has(m)){const p=WA(n.get(m),r.get(m));p!==null&&h.set(m,p),s=s.add(m)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,h))}return F.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r){return function(s){return Z.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):NA(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r):this.getDocumentsMatchingCollectionQuery(e,n,r)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):F.resolve($s());let a=-1,l=s;return o.next(c=>F.forEach(c,(d,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),s.get(d)?F.resolve():this.remoteDocumentCache.getEntry(e,d).next(m=>{l=l.insert(d,m)}))).next(()=>this.populateOverlays(e,c,s)).next(()=>this.computeViews(e,l,c,pe())).next(d=>({batchId:a,changes:MA(d)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new Z(n)).next(r=>{let i=Pl();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r){const i=n.collectionGroup;let s=Pl();return this.indexManager.getCollectionParents(e,i).next(o=>F.forEach(o,a=>{const l=function(d,h){return new wu(h,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(n,a.child(i));return this.getDocumentsMatchingCollectionQuery(e,l,r).next(c=>{c.forEach((d,h)=>{s=s.insert(d,h)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,n,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(s=>(i=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i))).next(s=>{i.forEach((a,l)=>{const c=l.getKey();s.get(c)===null&&(s=s.insert(c,Ut.newInvalidDocument(c)))});let o=Pl();return s.forEach((a,l)=>{const c=i.get(a);c!==void 0&&Ql(c.mutation,l,dr.empty(),vt.now()),gm(n,l)&&(o=o.insert(a,l))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pU{constructor(e){this.serializer=e,this.cr=new Map,this.lr=new Map}getBundleMetadata(e,n){return F.resolve(this.cr.get(n))}saveBundleMetadata(e,n){return this.cr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:Mr(i.createTime)}}(n)),F.resolve()}getNamedQuery(e,n){return F.resolve(this.lr.get(n))}saveNamedQuery(e,n){return this.lr.set(n.name,function(i){return{name:i.name,query:cU(i.bundledQuery),readTime:Mr(i.readTime)}}(n)),F.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gU{constructor(){this.overlays=new Ke(Z.comparator),this.hr=new Map}getOverlay(e,n){return F.resolve(this.overlays.get(n))}getOverlays(e,n){const r=$s();return F.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.It(e,n,s)}),F.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.hr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.hr.delete(r)),F.resolve()}getOverlaysForCollection(e,n,r){const i=$s(),s=n.length+1,o=new Z(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,c=l.getKey();if(!n.isPrefixOf(c.path))break;c.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return F.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new Ke((c,d)=>c-d);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===n&&c.largestBatchId>r){let d=s.get(c.largestBatchId);d===null&&(d=$s(),s=s.insert(c.largestBatchId,d)),d.set(c.getKey(),c)}}const a=$s(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,d)=>a.set(c,d)),!(a.size()>=i)););return F.resolve(a)}It(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.hr.get(i.largestBatchId).delete(r.key);this.hr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new $V(n,r));let s=this.hr.get(n);s===void 0&&(s=pe(),this.hr.set(n,s)),this.hr.set(n,s.add(r.key))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a1{constructor(){this.Pr=new Gt(wt.Ir),this.Tr=new Gt(wt.Er)}isEmpty(){return this.Pr.isEmpty()}addReference(e,n){const r=new wt(e,n);this.Pr=this.Pr.add(r),this.Tr=this.Tr.add(r)}dr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Ar(new wt(e,n))}Rr(e,n){e.forEach(r=>this.removeReference(r,n))}Vr(e){const n=new Z(new Fe([])),r=new wt(n,e),i=new wt(n,e+1),s=[];return this.Tr.forEachInRange([r,i],o=>{this.Ar(o),s.push(o.key)}),s}mr(){this.Pr.forEach(e=>this.Ar(e))}Ar(e){this.Pr=this.Pr.delete(e),this.Tr=this.Tr.delete(e)}gr(e){const n=new Z(new Fe([])),r=new wt(n,e),i=new wt(n,e+1);let s=pe();return this.Tr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const n=new wt(e,0),r=this.Pr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class wt{constructor(e,n){this.key=e,this.pr=n}static Ir(e,n){return Z.comparator(e.key,n.key)||Ee(e.pr,n.pr)}static Er(e,n){return Ee(e.pr,n.pr)||Z.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yU{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.yr=1,this.wr=new Gt(wt.Ir)}checkEmpty(e){return F.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const s=this.yr;this.yr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new FV(s,n,r,i);this.mutationQueue.push(o);for(const a of i)this.wr=this.wr.add(new wt(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return F.resolve(o)}lookupMutationBatch(e,n){return F.resolve(this.Sr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.br(r),s=i<0?0:i;return F.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return F.resolve(this.mutationQueue.length===0?-1:this.yr-1)}getAllMutationBatches(e){return F.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new wt(n,0),i=new wt(n,Number.POSITIVE_INFINITY),s=[];return this.wr.forEachInRange([r,i],o=>{const a=this.Sr(o.pr);s.push(a)}),F.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Gt(Ee);return n.forEach(i=>{const s=new wt(i,0),o=new wt(i,Number.POSITIVE_INFINITY);this.wr.forEachInRange([s,o],a=>{r=r.add(a.pr)})}),F.resolve(this.Dr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;Z.isDocumentKey(s)||(s=s.child(""));const o=new wt(new Z(s),0);let a=new Gt(Ee);return this.wr.forEachWhile(l=>{const c=l.key.path;return!!r.isPrefixOf(c)&&(c.length===i&&(a=a.add(l.pr)),!0)},o),F.resolve(this.Dr(a))}Dr(e){const n=[];return e.forEach(r=>{const i=this.Sr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){ze(this.vr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.wr;return F.forEach(n.mutations,i=>{const s=new wt(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.wr=r})}Mn(e){}containsKey(e,n){const r=new wt(n,0),i=this.wr.firstAfterOrEqual(r);return F.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,F.resolve()}vr(e,n){return this.br(e)}br(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Sr(e){const n=this.br(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vU{constructor(e){this.Cr=e,this.docs=function(){return new Ke(Z.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.Cr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return F.resolve(r?r.document.mutableCopy():Ut.newInvalidDocument(n))}getEntries(e,n){let r=pi();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Ut.newInvalidDocument(i))}),F.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=pi();const o=n.path,a=new Z(o.child("")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:c,value:{document:d}}=l.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||iV(rV(d),r)<=0||(i.has(d.key)||gm(n,d))&&(s=s.insert(d.key,d.mutableCopy()))}return F.resolve(s)}getAllFromCollectionGroup(e,n,r,i){oe()}Fr(e,n){return F.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new xU(this)}getSize(e){return F.resolve(this.size)}}class xU extends hU{constructor(e){super(),this.ar=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.ar.addEntry(e,i)):this.ar.removeEntry(r)}),F.waitFor(n)}getFromCache(e,n){return this.ar.getEntry(e,n)}getAllFromCache(e,n){return this.ar.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wU{constructor(e){this.persistence=e,this.Mr=new nl(n=>Zx(n),e1),this.lastRemoteSnapshotVersion=le.min(),this.highestTargetId=0,this.Or=0,this.Nr=new a1,this.targetCount=0,this.Br=Ma.Nn()}forEachTarget(e,n){return this.Mr.forEach((r,i)=>n(i)),F.resolve()}getLastRemoteSnapshotVersion(e){return F.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return F.resolve(this.Or)}allocateTargetId(e){return this.highestTargetId=this.Br.next(),F.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Or&&(this.Or=n),F.resolve()}qn(e){this.Mr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.Br=new Ma(n),this.highestTargetId=n),e.sequenceNumber>this.Or&&(this.Or=e.sequenceNumber)}addTargetData(e,n){return this.qn(n),this.targetCount+=1,F.resolve()}updateTargetData(e,n){return this.qn(n),F.resolve()}removeTargetData(e,n){return this.Mr.delete(n.target),this.Nr.Vr(n.targetId),this.targetCount-=1,F.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.Mr.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.Mr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),F.waitFor(s).next(()=>i)}getTargetCount(e){return F.resolve(this.targetCount)}getTargetData(e,n){const r=this.Mr.get(n)||null;return F.resolve(r)}addMatchingKeys(e,n,r){return this.Nr.dr(n,r),F.resolve()}removeMatchingKeys(e,n,r){this.Nr.Rr(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),F.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.Nr.Vr(n),F.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Nr.gr(n);return F.resolve(r)}containsKey(e,n){return F.resolve(this.Nr.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _U{constructor(e,n){this.Lr={},this.overlays={},this.kr=new Xx(0),this.qr=!1,this.qr=!0,this.referenceDelegate=e(this),this.Qr=new wU(this),this.indexManager=new uU,this.remoteDocumentCache=function(i){return new vU(i)}(r=>this.referenceDelegate.Kr(r)),this.serializer=new lU(n),this.$r=new pU(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new gU,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.Lr[e.toKey()];return r||(r=new yU(n,this.referenceDelegate),this.Lr[e.toKey()]=r),r}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction(e,n,r){Y("MemoryPersistence","Starting transaction:",e);const i=new EU(this.kr.next());return this.referenceDelegate.Ur(),r(i).next(s=>this.referenceDelegate.Wr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Gr(e,n){return F.or(Object.values(this.Lr).map(r=>()=>r.containsKey(e,n)))}}class EU extends oV{constructor(e){super(),this.currentSequenceNumber=e}}class l1{constructor(e){this.persistence=e,this.zr=new a1,this.jr=null}static Hr(e){return new l1(e)}get Jr(){if(this.jr)return this.jr;throw oe()}addReference(e,n,r){return this.zr.addReference(r,n),this.Jr.delete(r.toString()),F.resolve()}removeReference(e,n,r){return this.zr.removeReference(r,n),this.Jr.add(r.toString()),F.resolve()}markPotentiallyOrphaned(e,n){return this.Jr.add(n.toString()),F.resolve()}removeTarget(e,n){this.zr.Vr(n.targetId).forEach(i=>this.Jr.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.Jr.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}Ur(){this.jr=new Set}Wr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return F.forEach(this.Jr,r=>{const i=Z.fromPath(r);return this.Yr(e,i).next(s=>{s||n.removeEntry(i,le.min())})}).next(()=>(this.jr=null,n.apply(e)))}updateLimboDocument(e,n){return this.Yr(e,n).next(r=>{r?this.Jr.delete(n.toString()):this.Jr.add(n.toString())})}Kr(e){return 0}Yr(e,n){return F.or([()=>F.resolve(this.zr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Gr(e,n)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c1{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.qi=r,this.Qi=i}static Ki(e,n){let r=pe(),i=pe();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new c1(e,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SU{constructor(){this.$i=!1}initialize(e,n){this.Ui=e,this.indexManager=n,this.$i=!0}getDocumentsMatchingQuery(e,n,r,i){return this.Wi(e,n).next(s=>s||this.Gi(e,n,i,r)).next(s=>s||this.zi(e,n))}Wi(e,n){if(bS(n))return F.resolve(null);let r=mi(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=Sy(n,null,"F"),r=mi(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=pe(...s);return this.Ui.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const c=this.ji(n,a);return this.Hi(n,c,o,l.readTime)?this.Wi(e,Sy(n,null,"F")):this.Ji(e,c,n,l)}))})))}Gi(e,n,r,i){return bS(n)||i.isEqual(le.min())?this.zi(e,n):this.Ui.getDocuments(e,r).next(s=>{const o=this.ji(n,s);return this.Hi(n,o,r,i)?this.zi(e,n):(mS()<=_e.DEBUG&&Y("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),by(n)),this.Ji(e,o,n,nV(i,-1)))})}ji(e,n){let r=new Gt(jA(e));return n.forEach((i,s)=>{gm(e,s)&&(r=r.add(s))}),r}Hi(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}zi(e,n){return mS()<=_e.DEBUG&&Y("QueryEngine","Using full collection scan to execute query:",by(n)),this.Ui.getDocumentsMatchingQuery(e,n,os.min())}Ji(e,n,r,i){return this.Ui.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bU{constructor(e,n,r,i){this.persistence=e,this.Yi=n,this.serializer=i,this.Zi=new Ke(Ee),this.Xi=new nl(s=>Zx(s),e1),this.es=new Map,this.ts=e.getRemoteDocumentCache(),this.Qr=e.getTargetCache(),this.$r=e.getBundleCache(),this.ns(r)}ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new mU(this.ts,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ts.setIndexManager(this.indexManager),this.Yi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Zi))}}function kU(t,e,n,r){return new bU(t,e,n,r)}async function tR(t,e){const n=de(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.ns(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],a=[];let l=pe();for(const c of i){o.push(c.batchId);for(const d of c.mutations)l=l.add(d.key)}for(const c of s){a.push(c.batchId);for(const d of c.mutations)l=l.add(d.key)}return n.localDocuments.getDocuments(r,l).next(c=>({rs:c,removedBatchIds:o,addedBatchIds:a}))})})}function TU(t,e){const n=de(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=n.ts.newChangeBuffer({trackRemovals:!0});return function(a,l,c,d){const h=c.batch,m=h.keys();let p=F.resolve();return m.forEach(y=>{p=p.next(()=>d.getEntry(l,y)).next(x=>{const E=c.docVersions.get(y);ze(E!==null),x.version.compareTo(E)<0&&(h.applyToRemoteDocument(x,c),x.isValidDocument()&&(x.setReadTime(c.commitVersion),d.addEntry(x)))})}),p.next(()=>a.mutationQueue.removeMutationBatch(l,h))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=pe();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(l=l.add(a.batch.mutations[c].key));return l}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function nR(t){const e=de(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Qr.getLastRemoteSnapshotVersion(n))}function IU(t,e){const n=de(t),r=e.snapshotVersion;let i=n.Zi;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=n.ts.newChangeBuffer({trackRemovals:!0});i=n.Zi;const a=[];e.targetChanges.forEach((d,h)=>{const m=i.get(h);if(!m)return;a.push(n.Qr.removeMatchingKeys(s,d.removedDocuments,h).next(()=>n.Qr.addMatchingKeys(s,d.addedDocuments,h)));let p=m.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(h)!==null?p=p.withResumeToken(Qt.EMPTY_BYTE_STRING,le.min()).withLastLimboFreeSnapshotVersion(le.min()):d.resumeToken.approximateByteSize()>0&&(p=p.withResumeToken(d.resumeToken,r)),i=i.insert(h,p),function(x,E,v){return x.resumeToken.approximateByteSize()===0||E.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=3e8?!0:v.addedDocuments.size+v.modifiedDocuments.size+v.removedDocuments.size>0}(m,p,d)&&a.push(n.Qr.updateTargetData(s,p))});let l=pi(),c=pe();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,d))}),a.push(CU(s,o,e.documentUpdates).next(d=>{l=d.ss,c=d.os})),!r.isEqual(le.min())){const d=n.Qr.getLastRemoteSnapshotVersion(s).next(h=>n.Qr.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(d)}return F.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,l,c)).next(()=>l)}).then(s=>(n.Zi=i,s))}function CU(t,e,n){let r=pe(),i=pe();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=pi();return n.forEach((a,l)=>{const c=s.get(a);l.isFoundDocument()!==c.isFoundDocument()&&(i=i.add(a)),l.isNoDocument()&&l.version.isEqual(le.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):Y("LocalStore","Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",l.version)}),{ss:o,os:i}})}function AU(t,e){const n=de(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function RU(t,e){const n=de(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Qr.getTargetData(r,e).next(s=>s?(i=s,F.resolve(i)):n.Qr.allocateTargetId(r).next(o=>(i=new Bi(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Qr.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.Zi.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.Zi=n.Zi.insert(r.targetId,r),n.Xi.set(e,r.targetId)),r})}async function Ay(t,e,n){const r=de(t),i=r.Zi.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!xu(o))throw o;Y("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.Zi=r.Zi.remove(e),r.Xi.delete(i.target)}function OS(t,e,n){const r=de(t);let i=le.min(),s=pe();return r.persistence.runTransaction("Execute query","readonly",o=>function(l,c,d){const h=de(l),m=h.Xi.get(d);return m!==void 0?F.resolve(h.Zi.get(m)):h.Qr.getTargetData(c,d)}(r,o,mi(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Qr.getMatchingKeysForTargetId(o,a.targetId).next(l=>{s=l})}).next(()=>r.Yi.getDocumentsMatchingQuery(o,e,n?i:le.min(),n?s:pe())).next(a=>(PU(r,SV(e),a),{documents:a,_s:s})))}function PU(t,e,n){let r=t.es.get(e)||le.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.es.set(e,r)}class MS{constructor(){this.activeTargetIds=AV()}Is(e){this.activeTargetIds=this.activeTargetIds.add(e)}Ts(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ps(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class NU{constructor(){this.Ys=new MS,this.Zs={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e){return this.Ys.Is(e),this.Zs[e]||"not-current"}updateQueryState(e,n,r){this.Zs[e]=n}removeLocalQueryTarget(e){this.Ys.Ts(e)}isLocalQueryTarget(e){return this.Ys.activeTargetIds.has(e)}clearQueryState(e){delete this.Zs[e]}getAllActiveQueryTargets(){return this.Ys.activeTargetIds}isActiveQueryTarget(e){return this.Ys.activeTargetIds.has(e)}start(){return this.Ys=new MS,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DU{Xs(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LS{constructor(){this.eo=()=>this.no(),this.ro=()=>this.io(),this.so=[],this.oo()}Xs(e){this.so.push(e)}shutdown(){window.removeEventListener("online",this.eo),window.removeEventListener("offline",this.ro)}oo(){window.addEventListener("online",this.eo),window.addEventListener("offline",this.ro)}no(){Y("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.so)e(0)}io(){Y("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.so)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let dd=null;function dg(){return dd===null?dd=function(){return 268435456+Math.round(2147483648*Math.random())}():dd++,"0x"+dd.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jU={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OU{constructor(e){this._o=e._o,this.ao=e.ao}uo(e){this.co=e}lo(e){this.ho=e}onMessage(e){this.Po=e}close(){this.ao()}send(e){this._o(e)}Io(){this.co()}To(e){this.ho(e)}Eo(e){this.Po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $t="WebChannelConnection";class MU extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Ao=r+"://"+n.host,this.Ro=`projects/${i}/databases/${s}`,this.Vo=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get mo(){return!1}fo(n,r,i,s,o){const a=dg(),l=this.po(n,r);Y("RestConnection",`Sending RPC '${n}' ${a}:`,l,i);const c={"google-cloud-resource-prefix":this.Ro,"x-goog-request-params":this.Vo};return this.yo(c,s,o),this.wo(n,l,c,i).then(d=>(Y("RestConnection",`Received RPC '${n}' ${a}: `,d),d),d=>{throw Na("RestConnection",`RPC '${n}' ${a} failed with error: `,d,"url: ",l,"request:",i),d})}So(n,r,i,s,o,a){return this.fo(n,r,i,s,o)}yo(n,r,i){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+el}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>n[o]=s),i&&i.headers.forEach((s,o)=>n[o]=s)}po(n,r){const i=jU[n];return`${this.Ao}/v1/${r}:${i}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}wo(e,n,r,i){const s=dg();return new Promise((o,a)=>{const l=new HB;l.setWithCredentials(!0),l.listenOnce(UB.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case cg.NO_ERROR:const d=l.getResponseJson();Y($t,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(d)),o(d);break;case cg.TIMEOUT:Y($t,`RPC '${e}' ${s} timed out`),a(new U(D.DEADLINE_EXCEEDED,"Request time out"));break;case cg.HTTP_ERROR:const h=l.getStatus();if(Y($t,`RPC '${e}' ${s} failed with status:`,h,"response text:",l.getResponseText()),h>0){let m=l.getResponseJson();Array.isArray(m)&&(m=m[0]);const p=m==null?void 0:m.error;if(p&&p.status&&p.message){const y=function(E){const v=E.toLowerCase().replace(/_/g,"-");return Object.values(D).indexOf(v)>=0?v:D.UNKNOWN}(p.status);a(new U(y,p.message))}else a(new U(D.UNKNOWN,"Server responded with status "+l.getStatus()))}else a(new U(D.UNAVAILABLE,"Connection failed."));break;default:oe()}}finally{Y($t,`RPC '${e}' ${s} completed.`)}});const c=JSON.stringify(i);Y($t,`RPC '${e}' ${s} sending request:`,i),l.send(n,"POST",c,r,15)})}bo(e,n,r){const i=dg(),s=[this.Ao,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=BB(),a=VB(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.yo(l.initMessageHeaders,n,r),l.encodeInitMessageHeaders=!0;const d=s.join("");Y($t,`Creating RPC '${e}' stream ${i}: ${d}`,l);const h=o.createWebChannel(d,l);let m=!1,p=!1;const y=new OU({_o:E=>{p?Y($t,`Not sending because RPC '${e}' stream ${i} is closed:`,E):(m||(Y($t,`Opening RPC '${e}' stream ${i} transport.`),h.open(),m=!0),Y($t,`RPC '${e}' stream ${i} sending:`,E),h.send(E))},ao:()=>h.close()}),x=(E,v,g)=>{E.listen(v,w=>{try{g(w)}catch(_){setTimeout(()=>{throw _},0)}})};return x(h,ld.EventType.OPEN,()=>{p||Y($t,`RPC '${e}' stream ${i} transport opened.`)}),x(h,ld.EventType.CLOSE,()=>{p||(p=!0,Y($t,`RPC '${e}' stream ${i} transport closed`),y.To())}),x(h,ld.EventType.ERROR,E=>{p||(p=!0,Na($t,`RPC '${e}' stream ${i} transport errored:`,E),y.To(new U(D.UNAVAILABLE,"The operation could not be completed")))}),x(h,ld.EventType.MESSAGE,E=>{var v;if(!p){const g=E.data[0];ze(!!g);const w=g,_=w.error||((v=w[0])===null||v===void 0?void 0:v.error);if(_){Y($t,`RPC '${e}' stream ${i} received error:`,_);const S=_.status;let T=function(R){const P=ct[R];if(P!==void 0)return qA(P)}(S),b=_.message;T===void 0&&(T=D.INTERNAL,b="Unknown error status: "+S+" with message "+_.message),p=!0,y.To(new U(T,b)),h.close()}else Y($t,`RPC '${e}' stream ${i} received:`,g),y.Eo(g)}}),x(a,WB.STAT_EVENT,E=>{E.stat===hS.PROXY?Y($t,`RPC '${e}' stream ${i} detected buffering proxy`):E.stat===hS.NOPROXY&&Y($t,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{y.Io()},0),y}}function hg(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wm(t){return new KV(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rR{constructor(e,n,r=1e3,i=1.5,s=6e4){this.oi=e,this.timerId=n,this.Do=r,this.vo=i,this.Co=s,this.Fo=0,this.Mo=null,this.xo=Date.now(),this.reset()}reset(){this.Fo=0}Oo(){this.Fo=this.Co}No(e){this.cancel();const n=Math.floor(this.Fo+this.Bo()),r=Math.max(0,Date.now()-this.xo),i=Math.max(0,n-r);i>0&&Y("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Fo} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.Mo=this.oi.enqueueAfterDelay(this.timerId,i,()=>(this.xo=Date.now(),e())),this.Fo*=this.vo,this.Fo<this.Do&&(this.Fo=this.Do),this.Fo>this.Co&&(this.Fo=this.Co)}Lo(){this.Mo!==null&&(this.Mo.skipDelay(),this.Mo=null)}cancel(){this.Mo!==null&&(this.Mo.cancel(),this.Mo=null)}Bo(){return(Math.random()-.5)*this.Fo}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iR{constructor(e,n,r,i,s,o,a,l){this.oi=e,this.ko=r,this.qo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.Qo=0,this.Ko=null,this.$o=null,this.stream=null,this.Uo=new rR(e,n)}Wo(){return this.state===1||this.state===5||this.Go()}Go(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.zo()}async stop(){this.Wo()&&await this.close(0)}jo(){this.state=0,this.Uo.reset()}Ho(){this.Go()&&this.Ko===null&&(this.Ko=this.oi.enqueueAfterDelay(this.ko,6e4,()=>this.Jo()))}Yo(e){this.Zo(),this.stream.send(e)}async Jo(){if(this.Go())return this.close(0)}Zo(){this.Ko&&(this.Ko.cancel(),this.Ko=null)}Xo(){this.$o&&(this.$o.cancel(),this.$o=null)}async close(e,n){this.Zo(),this.Xo(),this.Uo.cancel(),this.Qo++,e!==4?this.Uo.reset():n&&n.code===D.RESOURCE_EXHAUSTED?(fi(n.toString()),fi("Using maximum backoff delay to prevent overloading the backend."),this.Uo.Oo()):n&&n.code===D.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.e_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.lo(n)}e_(){}auth(){this.state=1;const e=this.t_(this.Qo),n=this.Qo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Qo===n&&this.n_(r,i)},r=>{e(()=>{const i=new U(D.UNKNOWN,"Fetching auth token failed: "+r.message);return this.r_(i)})})}n_(e,n){const r=this.t_(this.Qo);this.stream=this.i_(e,n),this.stream.uo(()=>{r(()=>(this.state=2,this.$o=this.oi.enqueueAfterDelay(this.qo,1e4,()=>(this.Go()&&(this.state=3),Promise.resolve())),this.listener.uo()))}),this.stream.lo(i=>{r(()=>this.r_(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}zo(){this.state=5,this.Uo.No(async()=>{this.state=0,this.start()})}r_(e){return Y("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}t_(e){return n=>{this.oi.enqueueAndForget(()=>this.Qo===e?n():(Y("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class LU extends iR{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}i_(e,n){return this.connection.bo("Listen",e,n)}onMessage(e){this.Uo.reset();const n=YV(this.serializer,e),r=function(s){if(!("targetChange"in s))return le.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?le.min():o.readTime?Mr(o.readTime):le.min()}(e);return this.listener.s_(n,r)}o_(e){const n={};n.database=Cy(this.serializer),n.addTarget=function(s,o){let a;const l=o.target;if(a=_y(l)?{documents:eU(s,l)}:{query:tU(s,l)},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=XA(s,o.resumeToken);const c=ky(s,o.expectedCount);c!==null&&(a.expectedCount=c)}else if(o.snapshotVersion.compareTo(le.min())>0){a.readTime=Zh(s,o.snapshotVersion.toTimestamp());const c=ky(s,o.expectedCount);c!==null&&(a.expectedCount=c)}return a}(this.serializer,e);const r=rU(this.serializer,e);r&&(n.labels=r),this.Yo(n)}__(e){const n={};n.database=Cy(this.serializer),n.removeTarget=e,this.Yo(n)}}class FU extends iR{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s,this.a_=!1}get u_(){return this.a_}start(){this.a_=!1,this.lastStreamToken=void 0,super.start()}e_(){this.a_&&this.c_([])}i_(e,n){return this.connection.bo("Write",e,n)}onMessage(e){if(ze(!!e.streamToken),this.lastStreamToken=e.streamToken,this.a_){this.Uo.reset();const n=ZV(e.writeResults,e.commitTime),r=Mr(e.commitTime);return this.listener.l_(r,n)}return ze(!e.writeResults||e.writeResults.length===0),this.a_=!0,this.listener.h_()}P_(){const e={};e.database=Cy(this.serializer),this.Yo(e)}c_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>JV(this.serializer,r))};this.Yo(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $U extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.I_=!1}T_(){if(this.I_)throw new U(D.FAILED_PRECONDITION,"The client has already been terminated.")}fo(e,n,r){return this.T_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,s])=>this.connection.fo(e,n,r,i,s)).catch(i=>{throw i.name==="FirebaseError"?(i.code===D.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new U(D.UNKNOWN,i.toString())})}So(e,n,r,i){return this.T_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.So(e,n,r,s,o,i)).catch(s=>{throw s.name==="FirebaseError"?(s.code===D.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new U(D.UNKNOWN,s.toString())})}terminate(){this.I_=!0}}class zU{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.d_=0,this.A_=null,this.R_=!0}V_(){this.d_===0&&(this.m_("Unknown"),this.A_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.A_=null,this.f_("Backend didn't respond within 10 seconds."),this.m_("Offline"),Promise.resolve())))}g_(e){this.state==="Online"?this.m_("Unknown"):(this.d_++,this.d_>=1&&(this.p_(),this.f_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.m_("Offline")))}set(e){this.p_(),this.d_=0,e==="Online"&&(this.R_=!1),this.m_(e)}m_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}f_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.R_?(fi(n),this.R_=!1):Y("OnlineStateTracker",n)}p_(){this.A_!==null&&(this.A_.cancel(),this.A_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BU{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.y_=[],this.w_=new Map,this.S_=new Set,this.b_=[],this.D_=s,this.D_.Xs(o=>{r.enqueueAndForget(async()=>{ko(this)&&(Y("RemoteStore","Restarting streams for network reachability change."),await async function(l){const c=de(l);c.S_.add(4),await Su(c),c.v_.set("Unknown"),c.S_.delete(4),await _m(c)}(this))})}),this.v_=new zU(r,i)}}async function _m(t){if(ko(t))for(const e of t.b_)await e(!0)}async function Su(t){for(const e of t.b_)await e(!1)}function sR(t,e){const n=de(t);n.w_.has(e.targetId)||(n.w_.set(e.targetId,e),h1(n)?d1(n):rl(n).Go()&&u1(n,e))}function oR(t,e){const n=de(t),r=rl(n);n.w_.delete(e),r.Go()&&aR(n,e),n.w_.size===0&&(r.Go()?r.Ho():ko(n)&&n.v_.set("Unknown"))}function u1(t,e){if(t.C_.Le(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(le.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}rl(t).o_(e)}function aR(t,e){t.C_.Le(e),rl(t).__(e)}function d1(t){t.C_=new WV({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),lt:e=>t.w_.get(e)||null,st:()=>t.datastore.serializer.databaseId}),rl(t).start(),t.v_.V_()}function h1(t){return ko(t)&&!rl(t).Wo()&&t.w_.size>0}function ko(t){return de(t).S_.size===0}function lR(t){t.C_=void 0}async function VU(t){t.w_.forEach((e,n)=>{u1(t,e)})}async function UU(t,e){lR(t),h1(t)?(t.v_.g_(e),d1(t)):t.v_.set("Unknown")}async function WU(t,e,n){if(t.v_.set("Online"),e instanceof KA&&e.state===2&&e.cause)try{await async function(i,s){const o=s.cause;for(const a of s.targetIds)i.w_.has(a)&&(await i.remoteSyncer.rejectListen(a,o),i.w_.delete(a),i.C_.removeTarget(a))}(t,e)}catch(r){Y("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await ef(t,r)}else if(e instanceof Bd?t.C_.Ge(e):e instanceof GA?t.C_.Xe(e):t.C_.He(e),!n.isEqual(le.min()))try{const r=await nR(t.localStore);n.compareTo(r)>=0&&await function(s,o){const a=s.C_._t(o);return a.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const d=s.w_.get(c);d&&s.w_.set(c,d.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,c)=>{const d=s.w_.get(l);if(!d)return;s.w_.set(l,d.withResumeToken(Qt.EMPTY_BYTE_STRING,d.snapshotVersion)),aR(s,l);const h=new Bi(d.target,l,c,d.sequenceNumber);u1(s,h)}),s.remoteSyncer.applyRemoteEvent(a)}(t,n)}catch(r){Y("RemoteStore","Failed to raise snapshot:",r),await ef(t,r)}}async function ef(t,e,n){if(!xu(e))throw e;t.S_.add(1),await Su(t),t.v_.set("Offline"),n||(n=()=>nR(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Y("RemoteStore","Retrying IndexedDB access"),await n(),t.S_.delete(1),await _m(t)})}function cR(t,e){return e().catch(n=>ef(t,n,e))}async function Em(t){const e=de(t),n=ls(e);let r=e.y_.length>0?e.y_[e.y_.length-1].batchId:-1;for(;HU(e);)try{const i=await AU(e.localStore,r);if(i===null){e.y_.length===0&&n.Ho();break}r=i.batchId,qU(e,i)}catch(i){await ef(e,i)}uR(e)&&dR(e)}function HU(t){return ko(t)&&t.y_.length<10}function qU(t,e){t.y_.push(e);const n=ls(t);n.Go()&&n.u_&&n.c_(e.mutations)}function uR(t){return ko(t)&&!ls(t).Wo()&&t.y_.length>0}function dR(t){ls(t).start()}async function GU(t){ls(t).P_()}async function KU(t){const e=ls(t);for(const n of t.y_)e.c_(n.mutations)}async function XU(t,e,n){const r=t.y_.shift(),i=i1.from(r,e,n);await cR(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await Em(t)}async function QU(t,e){e&&ls(t).u_&&await async function(r,i){if(function(o){return BV(o)&&o!==D.ABORTED}(i.code)){const s=r.y_.shift();ls(r).jo(),await cR(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await Em(r)}}(t,e),uR(t)&&dR(t)}async function FS(t,e){const n=de(t);n.asyncQueue.verifyOperationInProgress(),Y("RemoteStore","RemoteStore received new credentials");const r=ko(n);n.S_.add(3),await Su(n),r&&n.v_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.S_.delete(3),await _m(n)}async function YU(t,e){const n=de(t);e?(n.S_.delete(2),await _m(n)):e||(n.S_.add(2),await Su(n),n.v_.set("Unknown"))}function rl(t){return t.F_||(t.F_=function(n,r,i){const s=de(n);return s.T_(),new LU(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{uo:VU.bind(null,t),lo:UU.bind(null,t),s_:WU.bind(null,t)}),t.b_.push(async e=>{e?(t.F_.jo(),h1(t)?d1(t):t.v_.set("Unknown")):(await t.F_.stop(),lR(t))})),t.F_}function ls(t){return t.M_||(t.M_=function(n,r,i){const s=de(n);return s.T_(),new FU(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{uo:GU.bind(null,t),lo:QU.bind(null,t),h_:KU.bind(null,t),l_:XU.bind(null,t)}),t.b_.push(async e=>{e?(t.M_.jo(),await Em(t)):(await t.M_.stop(),t.y_.length>0&&(Y("RemoteStore",`Stopping write stream with ${t.y_.length} pending writes`),t.y_=[]))})),t.M_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f1{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new oi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}static createAndSchedule(e,n,r,i,s){const o=Date.now()+r,a=new f1(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new U(D.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function m1(t,e){if(fi("AsyncQueue",`${e}: ${t}`),xu(t))return new U(D.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ha{constructor(e){this.comparator=e?(n,r)=>e(n,r)||Z.comparator(n.key,r.key):(n,r)=>Z.comparator(n.key,r.key),this.keyedMap=Pl(),this.sortedSet=new Ke(this.comparator)}static emptySet(e){return new ha(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof ha)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new ha;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $S{constructor(){this.x_=new Ke(Z.comparator)}track(e){const n=e.doc.key,r=this.x_.get(n);r?e.type!==0&&r.type===3?this.x_=this.x_.insert(n,e):e.type===3&&r.type!==1?this.x_=this.x_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.x_=this.x_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.x_=this.x_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.x_=this.x_.remove(n):e.type===1&&r.type===2?this.x_=this.x_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.x_=this.x_.insert(n,{type:2,doc:e.doc}):oe():this.x_=this.x_.insert(n,e)}O_(){const e=[];return this.x_.inorderTraversal((n,r)=>{e.push(r)}),e}}class La{constructor(e,n,r,i,s,o,a,l,c){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,n,r,i,s){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new La(e,n,ha.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&pm(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JU{constructor(){this.N_=void 0,this.listeners=[]}}class ZU{constructor(){this.queries=new nl(e=>DA(e),pm),this.onlineState="Unknown",this.B_=new Set}}async function hR(t,e){const n=de(t),r=e.query;let i=!1,s=n.queries.get(r);if(s||(i=!0,s=new JU),i)try{s.N_=await n.onListen(r)}catch(o){const a=m1(o,`Initialization of query '${by(e.query)}' failed`);return void e.onError(a)}n.queries.set(r,s),s.listeners.push(e),e.L_(n.onlineState),s.N_&&e.k_(s.N_)&&p1(n)}async function fR(t,e){const n=de(t),r=e.query;let i=!1;const s=n.queries.get(r);if(s){const o=s.listeners.indexOf(e);o>=0&&(s.listeners.splice(o,1),i=s.listeners.length===0)}if(i)return n.queries.delete(r),n.onUnlisten(r)}function e7(t,e){const n=de(t);let r=!1;for(const i of e){const s=i.query,o=n.queries.get(s);if(o){for(const a of o.listeners)a.k_(i)&&(r=!0);o.N_=i}}r&&p1(n)}function t7(t,e,n){const r=de(t),i=r.queries.get(e);if(i)for(const s of i.listeners)s.onError(n);r.queries.delete(e)}function p1(t){t.B_.forEach(e=>{e.next()})}class mR{constructor(e,n,r){this.query=e,this.q_=n,this.Q_=!1,this.K_=null,this.onlineState="Unknown",this.options=r||{}}k_(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new La(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Q_?this.U_(e)&&(this.q_.next(e),n=!0):this.W_(e,this.onlineState)&&(this.G_(e),n=!0),this.K_=e,n}onError(e){this.q_.error(e)}L_(e){this.onlineState=e;let n=!1;return this.K_&&!this.Q_&&this.W_(this.K_,e)&&(this.G_(this.K_),n=!0),n}W_(e,n){if(!e.fromCache)return!0;const r=n!=="Offline";return(!this.options.z_||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}U_(e){if(e.docChanges.length>0)return!0;const n=this.K_&&this.K_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}G_(e){e=La.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Q_=!0,this.q_.next(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pR{constructor(e){this.key=e}}class gR{constructor(e){this.key=e}}class n7{constructor(e,n){this.query=e,this.ta=n,this.na=null,this.hasCachedResults=!1,this.current=!1,this.ra=pe(),this.mutatedKeys=pe(),this.ia=jA(e),this.sa=new ha(this.ia)}get oa(){return this.ta}_a(e,n){const r=n?n.aa:new $S,i=n?n.sa:this.sa;let s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,c=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((d,h)=>{const m=i.get(d),p=gm(this.query,h)?h:null,y=!!m&&this.mutatedKeys.has(m.key),x=!!p&&(p.hasLocalMutations||this.mutatedKeys.has(p.key)&&p.hasCommittedMutations);let E=!1;m&&p?m.data.isEqual(p.data)?y!==x&&(r.track({type:3,doc:p}),E=!0):this.ua(m,p)||(r.track({type:2,doc:p}),E=!0,(l&&this.ia(p,l)>0||c&&this.ia(p,c)<0)&&(a=!0)):!m&&p?(r.track({type:0,doc:p}),E=!0):m&&!p&&(r.track({type:1,doc:m}),E=!0,(l||c)&&(a=!0)),E&&(p?(o=o.add(p),s=x?s.add(d):s.delete(d)):(o=o.delete(d),s=s.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),s=s.delete(d.key),r.track({type:1,doc:d})}return{sa:o,aa:r,Hi:a,mutatedKeys:s}}ua(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r){const i=this.sa;this.sa=e.sa,this.mutatedKeys=e.mutatedKeys;const s=e.aa.O_();s.sort((c,d)=>function(m,p){const y=x=>{switch(x){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return oe()}};return y(m)-y(p)}(c.type,d.type)||this.ia(c.doc,d.doc)),this.ca(r);const o=n?this.la():[],a=this.ra.size===0&&this.current?1:0,l=a!==this.na;return this.na=a,s.length!==0||l?{snapshot:new La(this.query,e.sa,i,s,e.mutatedKeys,a===0,l,!1,!!r&&r.resumeToken.approximateByteSize()>0),ha:o}:{ha:o}}L_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({sa:this.sa,aa:new $S,mutatedKeys:this.mutatedKeys,Hi:!1},!1)):{ha:[]}}Pa(e){return!this.ta.has(e)&&!!this.sa.has(e)&&!this.sa.get(e).hasLocalMutations}ca(e){e&&(e.addedDocuments.forEach(n=>this.ta=this.ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.ta=this.ta.delete(n)),this.current=e.current)}la(){if(!this.current)return[];const e=this.ra;this.ra=pe(),this.sa.forEach(r=>{this.Pa(r.key)&&(this.ra=this.ra.add(r.key))});const n=[];return e.forEach(r=>{this.ra.has(r)||n.push(new gR(r))}),this.ra.forEach(r=>{e.has(r)||n.push(new pR(r))}),n}Ia(e){this.ta=e._s,this.ra=pe();const n=this._a(e.documents);return this.applyChanges(n,!0)}Ta(){return La.fromInitialDocuments(this.query,this.sa,this.mutatedKeys,this.na===0,this.hasCachedResults)}}class r7{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class i7{constructor(e){this.key=e,this.Ea=!1}}class s7{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.da={},this.Aa=new nl(a=>DA(a),pm),this.Ra=new Map,this.Va=new Set,this.ma=new Ke(Z.comparator),this.fa=new Map,this.ga=new a1,this.pa={},this.ya=new Map,this.wa=Ma.Bn(),this.onlineState="Unknown",this.Sa=void 0}get isPrimaryClient(){return this.Sa===!0}}async function o7(t,e){const n=g7(t);let r,i;const s=n.Aa.get(e);if(s)r=s.targetId,n.sharedClientState.addLocalQueryTarget(r),i=s.view.Ta();else{const o=await RU(n.localStore,mi(e)),a=n.sharedClientState.addLocalQueryTarget(o.targetId);r=o.targetId,i=await a7(n,e,r,a==="current",o.resumeToken),n.isPrimaryClient&&sR(n.remoteStore,o)}return i}async function a7(t,e,n,r,i){t.ba=(h,m,p)=>async function(x,E,v,g){let w=E.view._a(v);w.Hi&&(w=await OS(x.localStore,E.query,!1).then(({documents:T})=>E.view._a(T,w)));const _=g&&g.targetChanges.get(E.targetId),S=E.view.applyChanges(w,x.isPrimaryClient,_);return BS(x,E.targetId,S.ha),S.snapshot}(t,h,m,p);const s=await OS(t.localStore,e,!0),o=new n7(e,s._s),a=o._a(s.documents),l=Eu.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),c=o.applyChanges(a,t.isPrimaryClient,l);BS(t,n,c.ha);const d=new r7(e,n,o);return t.Aa.set(e,d),t.Ra.has(n)?t.Ra.get(n).push(e):t.Ra.set(n,[e]),c.snapshot}async function l7(t,e){const n=de(t),r=n.Aa.get(e),i=n.Ra.get(r.targetId);if(i.length>1)return n.Ra.set(r.targetId,i.filter(s=>!pm(s,e))),void n.Aa.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||await Ay(n.localStore,r.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(r.targetId),oR(n.remoteStore,r.targetId),Ry(n,r.targetId)}).catch(vu)):(Ry(n,r.targetId),await Ay(n.localStore,r.targetId,!0))}async function c7(t,e,n){const r=y7(t);try{const i=await function(o,a){const l=de(o),c=vt.now(),d=a.reduce((p,y)=>p.add(y.key),pe());let h,m;return l.persistence.runTransaction("Locally write mutations","readwrite",p=>{let y=pi(),x=pe();return l.ts.getEntries(p,d).next(E=>{y=E,y.forEach((v,g)=>{g.isValidDocument()||(x=x.add(v))})}).next(()=>l.localDocuments.getOverlayedDocuments(p,y)).next(E=>{h=E;const v=[];for(const g of a){const w=MV(g,h.get(g.key).overlayedDocument);w!=null&&v.push(new bo(g.key,w,bA(w.value.mapValue),Or.exists(!0)))}return l.mutationQueue.addMutationBatch(p,c,v,a)}).next(E=>{m=E;const v=E.applyToLocalDocumentSet(h,x);return l.documentOverlayCache.saveOverlays(p,E.batchId,v)})}).then(()=>({batchId:m.batchId,changes:MA(h)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,l){let c=o.pa[o.currentUser.toKey()];c||(c=new Ke(Ee)),c=c.insert(a,l),o.pa[o.currentUser.toKey()]=c}(r,i.batchId,n),await bu(r,i.changes),await Em(r.remoteStore)}catch(i){const s=m1(i,"Failed to persist write");n.reject(s)}}async function yR(t,e){const n=de(t);try{const r=await IU(n.localStore,e);e.targetChanges.forEach((i,s)=>{const o=n.fa.get(s);o&&(ze(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.Ea=!0:i.modifiedDocuments.size>0?ze(o.Ea):i.removedDocuments.size>0&&(ze(o.Ea),o.Ea=!1))}),await bu(n,r,e)}catch(r){await vu(r)}}function zS(t,e,n){const r=de(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Aa.forEach((s,o)=>{const a=o.view.L_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){const l=de(o);l.onlineState=a;let c=!1;l.queries.forEach((d,h)=>{for(const m of h.listeners)m.L_(a)&&(c=!0)}),c&&p1(l)}(r.eventManager,e),i.length&&r.da.s_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function u7(t,e,n){const r=de(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.fa.get(e),s=i&&i.key;if(s){let o=new Ke(Z.comparator);o=o.insert(s,Ut.newNoDocument(s,le.min()));const a=pe().add(s),l=new xm(le.min(),new Map,new Ke(Ee),o,a);await yR(r,l),r.ma=r.ma.remove(s),r.fa.delete(e),g1(r)}else await Ay(r.localStore,e,!1).then(()=>Ry(r,e,n)).catch(vu)}async function d7(t,e){const n=de(t),r=e.batch.batchId;try{const i=await TU(n.localStore,e);xR(n,r,null),vR(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await bu(n,i)}catch(i){await vu(i)}}async function h7(t,e,n){const r=de(t);try{const i=await function(o,a){const l=de(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let d;return l.mutationQueue.lookupMutationBatch(c,a).next(h=>(ze(h!==null),d=h.keys(),l.mutationQueue.removeMutationBatch(c,h))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,d,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,d)).next(()=>l.localDocuments.getDocuments(c,d))})}(r.localStore,e);xR(r,e,n),vR(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await bu(r,i)}catch(i){await vu(i)}}function vR(t,e){(t.ya.get(e)||[]).forEach(n=>{n.resolve()}),t.ya.delete(e)}function xR(t,e,n){const r=de(t);let i=r.pa[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.pa[r.currentUser.toKey()]=i}}function Ry(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ra.get(e))t.Aa.delete(r),n&&t.da.Da(r,n);t.Ra.delete(e),t.isPrimaryClient&&t.ga.Vr(e).forEach(r=>{t.ga.containsKey(r)||wR(t,r)})}function wR(t,e){t.Va.delete(e.path.canonicalString());const n=t.ma.get(e);n!==null&&(oR(t.remoteStore,n),t.ma=t.ma.remove(e),t.fa.delete(n),g1(t))}function BS(t,e,n){for(const r of n)r instanceof pR?(t.ga.addReference(r.key,e),f7(t,r)):r instanceof gR?(Y("SyncEngine","Document no longer in limbo: "+r.key),t.ga.removeReference(r.key,e),t.ga.containsKey(r.key)||wR(t,r.key)):oe()}function f7(t,e){const n=e.key,r=n.path.canonicalString();t.ma.get(n)||t.Va.has(r)||(Y("SyncEngine","New document in limbo: "+n),t.Va.add(r),g1(t))}function g1(t){for(;t.Va.size>0&&t.ma.size<t.maxConcurrentLimboResolutions;){const e=t.Va.values().next().value;t.Va.delete(e);const n=new Z(Fe.fromString(e)),r=t.wa.next();t.fa.set(r,new i7(n)),t.ma=t.ma.insert(n,r),sR(t.remoteStore,new Bi(mi(t1(n.path)),r,"TargetPurposeLimboResolution",Xx.ae))}}async function bu(t,e,n){const r=de(t),i=[],s=[],o=[];r.Aa.isEmpty()||(r.Aa.forEach((a,l)=>{o.push(r.ba(l,e,n).then(c=>{if((c||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(l.targetId,c!=null&&c.fromCache?"not-current":"current"),c){i.push(c);const d=c1.Ki(l.targetId,c);s.push(d)}}))}),await Promise.all(o),r.da.s_(i),await async function(l,c){const d=de(l);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>F.forEach(c,m=>F.forEach(m.qi,p=>d.persistence.referenceDelegate.addReference(h,m.targetId,p)).next(()=>F.forEach(m.Qi,p=>d.persistence.referenceDelegate.removeReference(h,m.targetId,p)))))}catch(h){if(!xu(h))throw h;Y("LocalStore","Failed to update sequence numbers: "+h)}for(const h of c){const m=h.targetId;if(!h.fromCache){const p=d.Zi.get(m),y=p.snapshotVersion,x=p.withLastLimboFreeSnapshotVersion(y);d.Zi=d.Zi.insert(m,x)}}}(r.localStore,s))}async function m7(t,e){const n=de(t);if(!n.currentUser.isEqual(e)){Y("SyncEngine","User change. New user:",e.toKey());const r=await tR(n.localStore,e);n.currentUser=e,function(s,o){s.ya.forEach(a=>{a.forEach(l=>{l.reject(new U(D.CANCELLED,o))})}),s.ya.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await bu(n,r.rs)}}function p7(t,e){const n=de(t),r=n.fa.get(e);if(r&&r.Ea)return pe().add(r.key);{let i=pe();const s=n.Ra.get(e);if(!s)return i;for(const o of s){const a=n.Aa.get(o);i=i.unionWith(a.view.oa)}return i}}function g7(t){const e=de(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=yR.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=p7.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=u7.bind(null,e),e.da.s_=e7.bind(null,e.eventManager),e.da.Da=t7.bind(null,e.eventManager),e}function y7(t){const e=de(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=d7.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=h7.bind(null,e),e}class VS{constructor(){this.synchronizeTabs=!1}async initialize(e){this.serializer=wm(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,n){return null}createIndexBackfillerScheduler(e,n){return null}createLocalStore(e){return kU(this.persistence,new SU,e.initialUser,this.serializer)}createPersistence(e){return new _U(l1.Hr,this.serializer)}createSharedClientState(e){return new NU}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class v7{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>zS(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=m7.bind(null,this.syncEngine),await YU(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new ZU}()}createDatastore(e){const n=wm(e.databaseInfo.databaseId),r=function(s){return new MU(s)}(e.databaseInfo);return function(s,o,a,l){return new $U(s,o,a,l)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,a){return new BU(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>zS(this.syncEngine,n,0),function(){return LS.v()?new LS:new DU}())}createSyncEngine(e,n){return function(i,s,o,a,l,c,d){const h=new s7(i,s,o,a,l,c);return d&&(h.Sa=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}terminate(){return async function(n){const r=de(n);Y("RemoteStore","RemoteStore shutting down."),r.S_.add(5),await Su(r),r.D_.shutdown(),r.v_.set("Unknown")}(this.remoteStore)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _R{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Fa(this.observer.next,e)}error(e){this.observer.error?this.Fa(this.observer.error,e):fi("Uncaught Error in snapshot listener:",e.toString())}Ma(){this.muted=!0}Fa(e,n){this.muted||setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x7{constructor(e,n,r,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=Bt.UNAUTHENTICATED,this.clientId=_A.V(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,async s=>{Y("FirestoreClient","Received user=",s.uid),await this.authCredentialListener(s),this.user=s}),this.appCheckCredentials.start(r,s=>(Y("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new U(D.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new oi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=m1(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function fg(t,e){t.asyncQueue.verifyOperationInProgress(),Y("FirestoreClient","Initializing OfflineComponentProvider");const n=await t.getConfiguration();await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async i=>{r.isEqual(i)||(await tR(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function US(t,e){t.asyncQueue.verifyOperationInProgress();const n=await _7(t);Y("FirestoreClient","Initializing OnlineComponentProvider");const r=await t.getConfiguration();await e.initialize(n,r),t.setCredentialChangeListener(i=>FS(e.remoteStore,i)),t.setAppCheckTokenChangeListener((i,s)=>FS(e.remoteStore,s)),t._onlineComponents=e}function w7(t){return t.name==="FirebaseError"?t.code===D.FAILED_PRECONDITION||t.code===D.UNIMPLEMENTED:!(typeof DOMException<"u"&&t instanceof DOMException)||t.code===22||t.code===20||t.code===11}async function _7(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Y("FirestoreClient","Using user provided OfflineComponentProvider");try{await fg(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!w7(n))throw n;Na("Error using user provided cache. Falling back to memory cache: "+n),await fg(t,new VS)}}else Y("FirestoreClient","Using default OfflineComponentProvider"),await fg(t,new VS);return t._offlineComponents}async function ER(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Y("FirestoreClient","Using user provided OnlineComponentProvider"),await US(t,t._uninitializedComponentsProvider._online)):(Y("FirestoreClient","Using default OnlineComponentProvider"),await US(t,new v7))),t._onlineComponents}function E7(t){return ER(t).then(e=>e.syncEngine)}async function SR(t){const e=await ER(t),n=e.eventManager;return n.onListen=o7.bind(null,e.syncEngine),n.onUnlisten=l7.bind(null,e.syncEngine),n}function S7(t,e,n={}){const r=new oi;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,c){const d=new _R({next:m=>{o.enqueueAndForget(()=>fR(s,h));const p=m.docs.has(a);!p&&m.fromCache?c.reject(new U(D.UNAVAILABLE,"Failed to get document because the client is offline.")):p&&m.fromCache&&l&&l.source==="server"?c.reject(new U(D.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(m)},error:m=>c.reject(m)}),h=new mR(t1(a.path),d,{includeMetadataChanges:!0,z_:!0});return hR(s,h)}(await SR(t),t.asyncQueue,e,n,r)),r.promise}function b7(t,e,n={}){const r=new oi;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,c){const d=new _R({next:m=>{o.enqueueAndForget(()=>fR(s,h)),m.fromCache&&l.source==="server"?c.reject(new U(D.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(m)},error:m=>c.reject(m)}),h=new mR(a,d,{includeMetadataChanges:!0,z_:!0});return hR(s,h)}(await SR(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bR(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WS=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kR(t,e,n){if(!n)throw new U(D.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function k7(t,e,n,r){if(e===!0&&r===!0)throw new U(D.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function HS(t){if(!Z.isDocumentKey(t))throw new U(D.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function qS(t){if(Z.isDocumentKey(t))throw new U(D.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Sm(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":oe()}function cs(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new U(D.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Sm(t);throw new U(D.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GS{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new U(D.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new U(D.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}k7("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=bR((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new U(D.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new U(D.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new U(D.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class bm{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new GS({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new U(D.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new U(D.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new GS(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new GB;switch(r.type){case"firstParty":return new YB(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new U(D.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=WS.get(n);r&&(Y("ComponentProvider","Removing Datastore"),WS.delete(n),r.terminate())}(this),Promise.resolve()}}function T7(t,e,n,r={}){var i;const s=(t=cs(t,bm))._getSettings(),o=`${e}:${n}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&Na("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,l;if(typeof r.mockUserToken=="string")a=r.mockUserToken,l=Bt.MOCK_USER;else{a=jI(r.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);const c=r.mockUserToken.sub||r.mockUserToken.user_id;if(!c)throw new U(D.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new Bt(c)}t._authCredentials=new KB(new wA(a,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class il{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new il(this.firestore,e,this._query)}}class yn{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new es(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new yn(this.firestore,e,this._key)}}class es extends il{constructor(e,n,r){super(e,n,t1(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new yn(this.firestore,null,new Z(e))}withConverter(e){return new es(this.firestore,e,this._path)}}function km(t,e,...n){if(t=xt(t),kR("collection","path",e),t instanceof bm){const r=Fe.fromString(e,...n);return qS(r),new es(t,null,r)}{if(!(t instanceof yn||t instanceof es))throw new U(D.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Fe.fromString(e,...n));return qS(r),new es(t.firestore,null,r)}}function y1(t,e,...n){if(t=xt(t),arguments.length===1&&(e=_A.V()),kR("doc","path",e),t instanceof bm){const r=Fe.fromString(e,...n);return HS(r),new yn(t,null,new Z(r))}{if(!(t instanceof yn||t instanceof es))throw new U(D.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Fe.fromString(e,...n));return HS(r),new yn(t.firestore,t instanceof es?t.converter:null,new Z(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I7{constructor(){this.za=Promise.resolve(),this.ja=[],this.Ha=!1,this.Ja=[],this.Ya=null,this.Za=!1,this.Xa=!1,this.eu=[],this.Uo=new rR(this,"async_queue_retry"),this.tu=()=>{const n=hg();n&&Y("AsyncQueue","Visibility state changed to "+n.visibilityState),this.Uo.Lo()};const e=hg();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.tu)}get isShuttingDown(){return this.Ha}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.nu(),this.ru(e)}enterRestrictedMode(e){if(!this.Ha){this.Ha=!0,this.Xa=e||!1;const n=hg();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.tu)}}enqueue(e){if(this.nu(),this.Ha)return new Promise(()=>{});const n=new oi;return this.ru(()=>this.Ha&&this.Xa?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.ja.push(e),this.iu()))}async iu(){if(this.ja.length!==0){try{await this.ja[0](),this.ja.shift(),this.Uo.reset()}catch(e){if(!xu(e))throw e;Y("AsyncQueue","Operation failed with retryable error: "+e)}this.ja.length>0&&this.Uo.No(()=>this.iu())}}ru(e){const n=this.za.then(()=>(this.Za=!0,e().catch(r=>{this.Ya=r,this.Za=!1;const i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw fi("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.Za=!1,r))));return this.za=n,n}enqueueAfterDelay(e,n,r){this.nu(),this.eu.indexOf(e)>-1&&(n=0);const i=f1.createAndSchedule(this,e,n,r,s=>this.su(s));return this.Ja.push(i),i}nu(){this.Ya&&oe()}verifyOperationInProgress(){}async ou(){let e;do e=this.za,await e;while(e!==this.za)}_u(e){for(const n of this.Ja)if(n.timerId===e)return!0;return!1}au(e){return this.ou().then(()=>{this.Ja.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Ja)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.ou()})}uu(e){this.eu.push(e)}su(e){const n=this.Ja.indexOf(e);this.Ja.splice(n,1)}}class ku extends bm{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=function(){return new I7}(),this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||TR(this),this._firestoreClient.terminate()}}function C7(t,e){const n=typeof t=="object"?t:yx(),r=typeof t=="string"?t:e||"(default)",i=Gf(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=PI("firestore");s&&T7(i,...s)}return i}function v1(t){return t._firestoreClient||TR(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function TR(t){var e,n,r;const i=t._freezeSettings(),s=function(a,l,c,d){return new cV(a,l,c,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,bR(d.experimentalLongPollingOptions),d.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._firestoreClient=new x7(t._authCredentials,t._appCheckCredentials,t._queue,s),!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fa{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Fa(Qt.fromBase64String(e))}catch(n){throw new U(D.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Fa(Qt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x1{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new U(D.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Wt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IR{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w1{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new U(D.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new U(D.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Ee(this._lat,e._lat)||Ee(this._long,e._long)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A7=/^__.*__$/;class R7{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new bo(e,this.data,this.fieldMask,n,this.fieldTransforms):new _u(e,this.data,n,this.fieldTransforms)}}function CR(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw oe()}}class _1{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.cu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get lu(){return this.settings.lu}hu(e){return new _1(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Pu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.hu({path:r,Iu:!1});return i.Tu(e),i}Eu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.hu({path:r,Iu:!1});return i.cu(),i}du(e){return this.hu({path:void 0,Iu:!0})}Au(e){return tf(e,this.settings.methodName,this.settings.Ru||!1,this.path,this.settings.Vu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}cu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Tu(this.path.get(e))}Tu(e){if(e.length===0)throw this.Au("Document fields must not be empty");if(CR(this.lu)&&A7.test(e))throw this.Au('Document fields cannot begin and end with "__"')}}class P7{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||wm(e)}mu(e,n,r,i=!1){return new _1({lu:e,methodName:n,Vu:r,path:Wt.emptyPath(),Iu:!1,Ru:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function AR(t){const e=t._freezeSettings(),n=wm(t._databaseId);return new P7(t._databaseId,!!e.ignoreUndefinedProperties,n)}function N7(t,e,n,r,i,s={}){const o=t.mu(s.merge||s.mergeFields?2:0,e,n,i);NR("Data must be an object, but it was:",o,r);const a=RR(r,o);let l,c;if(s.merge)l=new dr(o.fieldMask),c=o.fieldTransforms;else if(s.mergeFields){const d=[];for(const h of s.mergeFields){const m=j7(e,h,n);if(!o.contains(m))throw new U(D.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);M7(d,m)||d.push(m)}l=new dr(d),c=o.fieldTransforms.filter(h=>l.covers(h.field))}else l=null,c=o.fieldTransforms;return new R7(new Kn(a),l,c)}function D7(t,e,n,r=!1){return E1(n,t.mu(r?4:3,e))}function E1(t,e){if(PR(t=xt(t)))return NR("Unsupported field value:",e,t),RR(t,e);if(t instanceof IR)return function(r,i){if(!CR(i.lu))throw i.Au(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Au(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Iu&&e.lu!==4)throw e.Au("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const a of r){let l=E1(a,i.du(o));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=xt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return RV(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=vt.fromDate(r);return{timestampValue:Zh(i.serializer,s)}}if(r instanceof vt){const s=new vt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Zh(i.serializer,s)}}if(r instanceof w1)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Fa)return{bytesValue:XA(i.serializer,r._byteString)};if(r instanceof yn){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Au(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:o1(r.firestore._databaseId||i.databaseId,r._key.path)}}throw i.Au(`Unsupported field value: ${Sm(r)}`)}(t,e)}function RR(t,e){const n={};return EA(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):tl(t,(r,i)=>{const s=E1(i,e.Pu(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function PR(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof vt||t instanceof w1||t instanceof Fa||t instanceof yn||t instanceof IR)}function NR(t,e,n){if(!PR(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){const r=Sm(n);throw r==="an object"?e.Au(t+" a custom object"):e.Au(t+" "+r)}}function j7(t,e,n){if((e=xt(e))instanceof x1)return e._internalPath;if(typeof e=="string")return DR(t,e);throw tf("Field path arguments must be of type string or ",t,!1,void 0,n)}const O7=new RegExp("[~\\*/\\[\\]]");function DR(t,e,n){if(e.search(O7)>=0)throw tf(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new x1(...e.split("."))._internalPath}catch{throw tf(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function tf(t,e,n,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${r}`),o&&(l+=` in document ${i}`),l+=")"),new U(D.INVALID_ARGUMENT,a+t+l)}function M7(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jR{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new yn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new L7(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(S1("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class L7 extends jR{data(){return super.data()}}function S1(t,e){return typeof e=="string"?DR(t,e):e instanceof x1?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F7(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new U(D.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class b1{}class $7 extends b1{}function sl(t,e,...n){let r=[];e instanceof b1&&r.push(e),r=r.concat(n),function(s){const o=s.filter(l=>l instanceof k1).length,a=s.filter(l=>l instanceof Tm).length;if(o>1||o>0&&a>0)throw new U(D.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)t=i._apply(t);return t}class Tm extends $7{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Tm(e,n,r)}_apply(e){const n=this._parse(e);return OR(e._query,n),new il(e.firestore,e.converter,Ey(e._query,n))}_parse(e){const n=AR(e.firestore);return function(s,o,a,l,c,d,h){let m;if(c.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new U(D.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){XS(h,d);const p=[];for(const y of h)p.push(KS(l,s,y));m={arrayValue:{values:p}}}else m=KS(l,s,h)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||XS(h,d),m=D7(a,o,h,d==="in"||d==="not-in");return ht.create(c,d,m)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function ol(t,e,n){const r=e,i=S1("where",t);return Tm._create(i,r,n)}class k1 extends b1{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new k1(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:gr.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let o=i;const a=s.getFlattenedFilters();for(const l of a)OR(o,l),o=Ey(o,l)}(e._query,n),new il(e.firestore,e.converter,Ey(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function KS(t,e,n){if(typeof(n=xt(n))=="string"){if(n==="")throw new U(D.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!NA(e)&&n.indexOf("/")!==-1)throw new U(D.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Fe.fromString(n));if(!Z.isDocumentKey(r))throw new U(D.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return vS(t,new Z(r))}if(n instanceof yn)return vS(t,n._key);throw new U(D.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Sm(n)}.`)}function XS(t,e){if(!Array.isArray(t)||t.length===0)throw new U(D.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function OR(t,e){if(e.isInequality()){const r=n1(t),i=e.field;if(r!==null&&!r.isEqual(i))throw new U(D.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${r.toString()}' and '${i.toString()}'`);const s=PA(t);s!==null&&z7(t,i,s)}const n=function(i,s){for(const o of i)for(const a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new U(D.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new U(D.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}function z7(t,e,n){if(!n.isEqual(e))throw new U(D.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${n.toString()}' instead.`)}class B7{convertValue(e,n="none"){switch(ao(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ut(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(oo(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw oe()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return tl(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertGeoPoint(e){return new w1(ut(e.latitude),ut(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=Yx(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Lc(e));default:return null}}convertTimestamp(e){const n=as(e);return new vt(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Fe.fromString(e);ze(eR(r));const i=new Fc(r.get(1),r.get(3)),s=new Z(r.popFirst(5));return i.isEqual(n)||fi(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V7(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dl{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class MR extends jR{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Vd(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(S1("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class Vd extends MR{data(e={}){return super.data(e)}}class U7{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new Dl(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Vd(this._firestore,this._userDataWriter,r.key,r,new Dl(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new U(D.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{const l=new Vd(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Dl(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{const l=new Vd(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Dl(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let c=-1,d=-1;return a.type!==0&&(c=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),d=o.indexOf(a.doc.key)),{type:W7(a.type),doc:l,oldIndex:c,newIndex:d}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function W7(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return oe()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H7(t){t=cs(t,yn);const e=cs(t.firestore,ku);return S7(v1(e),t._key).then(n=>K7(e,t,n))}class LR extends B7{constructor(e){super(),this.firestore=e}convertBytes(e){return new Fa(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new yn(this.firestore,null,n)}}function al(t){t=cs(t,il);const e=cs(t.firestore,ku),n=v1(e),r=new LR(e);return F7(t._query),b7(n,t._query).then(i=>new U7(e,r,t,i))}function q7(t,e,n){t=cs(t,yn);const r=cs(t.firestore,ku),i=V7(t.converter,e,n);return FR(r,[N7(AR(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,Or.none())])}function G7(t){return FR(cs(t.firestore,ku),[new r1(t._key,Or.none())])}function FR(t,e){return function(r,i){const s=new oi;return r.asyncQueue.enqueueAndForget(async()=>c7(await E7(r),i,s)),s.promise}(v1(t),e)}function K7(t,e,n){const r=n.docs.get(e._key),i=new LR(t);return new MR(t,i,e._key,r,new Dl(n.hasPendingWrites,n.fromCache),e.converter)}(function(e,n=!0){(function(i){el=i})(Eo),ro(new ss("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),a=new ku(new XB(r.getProvider("auth-internal")),new ZB(r.getProvider("app-check-internal")),function(c,d){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new U(D.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Fc(c.options.projectId,d)}(o,i),o);return s=Object.assign({useFetchStreams:n},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),Nr(fS,"4.1.2",e),Nr(fS,"4.1.2","esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $R="firebasestorage.googleapis.com",zR="storageBucket",X7=2*60*1e3,Q7=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ze extends Ur{constructor(e,n,r=0){super(mg(e),`Firebase Storage: ${n} (${mg(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Ze.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return mg(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Je;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Je||(Je={}));function mg(t){return"storage/"+t}function T1(){const t="An unknown error occurred, please check the error payload for server response.";return new Ze(Je.UNKNOWN,t)}function Y7(t){return new Ze(Je.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function J7(t){return new Ze(Je.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function Z7(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Ze(Je.UNAUTHENTICATED,t)}function eW(){return new Ze(Je.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function tW(t){return new Ze(Je.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function nW(){return new Ze(Je.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function rW(){return new Ze(Je.CANCELED,"User canceled the upload/download.")}function iW(t){return new Ze(Je.INVALID_URL,"Invalid URL '"+t+"'.")}function sW(t){return new Ze(Je.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function oW(){return new Ze(Je.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+zR+"' property when initializing the app?")}function aW(){return new Ze(Je.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function lW(){return new Ze(Je.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function cW(t){return new Ze(Je.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Py(t){return new Ze(Je.INVALID_ARGUMENT,t)}function BR(){return new Ze(Je.APP_DELETED,"The Firebase app was deleted.")}function uW(t){return new Ze(Je.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Yl(t,e){return new Ze(Je.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function El(t){throw new Ze(Je.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cn{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=Cn.makeFromUrl(e,n)}catch{return new Cn(e,"")}if(r.path==="")return r;throw sW(e)}static makeFromUrl(e,n){let r=null;const i="([A-Za-z0-9.\\-_]+)";function s(_){_.path.charAt(_.path.length-1)==="/"&&(_.path_=_.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+i+o,"i"),l={bucket:1,path:3};function c(_){_.path_=decodeURIComponent(_.path)}const d="v[A-Za-z0-9_]+",h=n.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",p=new RegExp(`^https?://${h}/${d}/b/${i}/o${m}`,"i"),y={bucket:1,path:3},x=n===$R?"(?:storage.googleapis.com|storage.cloud.google.com)":n,E="([^?#]*)",v=new RegExp(`^https?://${x}/${i}/${E}`,"i"),w=[{regex:a,indices:l,postModify:s},{regex:p,indices:y,postModify:c},{regex:v,indices:{bucket:1,path:2},postModify:c}];for(let _=0;_<w.length;_++){const S=w[_],T=S.regex.exec(e);if(T){const b=T[S.indices.bucket];let k=T[S.indices.path];k||(k=""),r=new Cn(b,k),S.postModify(r);break}}if(r==null)throw iW(e);return r}}class dW{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hW(t,e,n){let r=1,i=null,s=null,o=!1,a=0;function l(){return a===2}let c=!1;function d(...E){c||(c=!0,e.apply(null,E))}function h(E){i=setTimeout(()=>{i=null,t(p,l())},E)}function m(){s&&clearTimeout(s)}function p(E,...v){if(c){m();return}if(E){m(),d.call(null,E,...v);return}if(l()||o){m(),d.call(null,E,...v);return}r<64&&(r*=2);let w;a===1?(a=2,w=0):w=(r+Math.random())*1e3,h(w)}let y=!1;function x(E){y||(y=!0,m(),!c&&(i!==null?(E||(a=2),clearTimeout(i),h(0)):E||(a=1)))}return h(0),s=setTimeout(()=>{o=!0,x(!0)},n),x}function fW(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mW(t){return t!==void 0}function pW(t){return typeof t=="object"&&!Array.isArray(t)}function I1(t){return typeof t=="string"||t instanceof String}function QS(t){return C1()&&t instanceof Blob}function C1(){return typeof Blob<"u"&&!w$()}function YS(t,e,n,r){if(r<e)throw Py(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw Py(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Im(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function VR(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const i=e(r)+"="+e(t[r]);n=n+i+"&"}return n=n.slice(0,-1),n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Hs;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(Hs||(Hs={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gW(t,e){const n=t>=500&&t<600,i=[408,429].indexOf(t)!==-1,s=e.indexOf(t)!==-1;return n||i||s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yW{constructor(e,n,r,i,s,o,a,l,c,d,h,m=!0){this.url_=e,this.method_=n,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=l,this.timeout_=c,this.progressCallback_=d,this.connectionFactory_=h,this.retry=m,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((p,y)=>{this.resolve_=p,this.reject_=y,this.start_()})}start_(){const e=(r,i)=>{if(i){r(!1,new hd(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const o=a=>{const l=a.loaded,c=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,c)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;const a=s.getErrorCode()===Hs.NO_ERROR,l=s.getStatus();if(!a||gW(l,this.additionalRetryCodes_)&&this.retry){const d=s.getErrorCode()===Hs.ABORT;r(!1,new hd(!1,null,d));return}const c=this.successCodes_.indexOf(l)!==-1;r(!0,new hd(c,s))})},n=(r,i)=>{const s=this.resolve_,o=this.reject_,a=i.connection;if(i.wasSuccessCode)try{const l=this.callback_(a,a.getResponse());mW(l)?s(l):s()}catch(l){o(l)}else if(a!==null){const l=T1();l.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,l)):o(l)}else if(i.canceled){const l=this.appDelete_?BR():rW();o(l)}else{const l=nW();o(l)}};this.canceled_?n(!1,new hd(!1,null,!0)):this.backoffId_=hW(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&fW(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class hd{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function vW(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function xW(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function wW(t,e){e&&(t["X-Firebase-GMPID"]=e)}function _W(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function EW(t,e,n,r,i,s,o=!0){const a=VR(t.urlParams),l=t.url+a,c=Object.assign({},t.headers);return wW(c,e),vW(c,n),xW(c,s),_W(c,r),new yW(l,t.method,c,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SW(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function bW(...t){const e=SW();if(e!==void 0){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(C1())return new Blob(t);throw new Ze(Je.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function kW(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TW(t){if(typeof atob>"u")throw cW("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ar={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class pg{constructor(e,n){this.data=e,this.contentType=n||null}}function IW(t,e){switch(t){case Ar.RAW:return new pg(UR(e));case Ar.BASE64:case Ar.BASE64URL:return new pg(WR(t,e));case Ar.DATA_URL:return new pg(AW(e),RW(e))}throw T1()}function UR(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const s=r,o=t.charCodeAt(++n);r=65536|(s&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function CW(t){let e;try{e=decodeURIComponent(t)}catch{throw Yl(Ar.DATA_URL,"Malformed data URL.")}return UR(e)}function WR(t,e){switch(t){case Ar.BASE64:{const i=e.indexOf("-")!==-1,s=e.indexOf("_")!==-1;if(i||s)throw Yl(t,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case Ar.BASE64URL:{const i=e.indexOf("+")!==-1,s=e.indexOf("/")!==-1;if(i||s)throw Yl(t,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=TW(e)}catch(i){throw i.message.includes("polyfill")?i:Yl(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}class HR{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw Yl(Ar.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=PW(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function AW(t){const e=new HR(t);return e.base64?WR(Ar.BASE64,e.rest):CW(e.rest)}function RW(t){return new HR(t).contentType}function PW(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oi{constructor(e,n){let r=0,i="";QS(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,n){if(QS(this.data_)){const r=this.data_,i=kW(r,e,n);return i===null?null:new Oi(i)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new Oi(r,!0)}}static getBlob(...e){if(C1()){const n=e.map(r=>r instanceof Oi?r.data_:r);return new Oi(bW.apply(null,n))}else{const n=e.map(o=>I1(o)?IW(Ar.RAW,o).data:o.data_);let r=0;n.forEach(o=>{r+=o.byteLength});const i=new Uint8Array(r);let s=0;return n.forEach(o=>{for(let a=0;a<o.length;a++)i[s++]=o[a]}),new Oi(i,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qR(t){let e;try{e=JSON.parse(t)}catch{return null}return pW(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NW(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function DW(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function GR(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jW(t,e){return e}class Jt{constructor(e,n,r,i){this.server=e,this.local=n||e,this.writable=!!r,this.xform=i||jW}}let fd=null;function OW(t){return!I1(t)||t.length<2?t:GR(t)}function KR(){if(fd)return fd;const t=[];t.push(new Jt("bucket")),t.push(new Jt("generation")),t.push(new Jt("metageneration")),t.push(new Jt("name","fullPath",!0));function e(s,o){return OW(o)}const n=new Jt("name");n.xform=e,t.push(n);function r(s,o){return o!==void 0?Number(o):o}const i=new Jt("size");return i.xform=r,t.push(i),t.push(new Jt("timeCreated")),t.push(new Jt("updated")),t.push(new Jt("md5Hash",null,!0)),t.push(new Jt("cacheControl",null,!0)),t.push(new Jt("contentDisposition",null,!0)),t.push(new Jt("contentEncoding",null,!0)),t.push(new Jt("contentLanguage",null,!0)),t.push(new Jt("contentType",null,!0)),t.push(new Jt("metadata","customMetadata",!0)),fd=t,fd}function MW(t,e){function n(){const r=t.bucket,i=t.fullPath,s=new Cn(r,i);return e._makeStorageReference(s)}Object.defineProperty(t,"ref",{get:n})}function LW(t,e,n){const r={};r.type="file";const i=n.length;for(let s=0;s<i;s++){const o=n[s];r[o.local]=o.xform(r,e[o.server])}return MW(r,t),r}function XR(t,e,n){const r=qR(e);return r===null?null:LW(t,r,n)}function FW(t,e,n,r){const i=qR(e);if(i===null||!I1(i.downloadTokens))return null;const s=i.downloadTokens;if(s.length===0)return null;const o=encodeURIComponent;return s.split(",").map(c=>{const d=t.bucket,h=t.fullPath,m="/b/"+o(d)+"/o/"+o(h),p=Im(m,n,r),y=VR({alt:"media",token:c});return p+y})[0]}function $W(t,e){const n={},r=e.length;for(let i=0;i<r;i++){const s=e[i];s.writable&&(n[s.server]=t[s.local])}return JSON.stringify(n)}class A1{constructor(e,n,r,i){this.url=e,this.method=n,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QR(t){if(!t)throw T1()}function zW(t,e){function n(r,i){const s=XR(t,i,e);return QR(s!==null),s}return n}function BW(t,e){function n(r,i){const s=XR(t,i,e);return QR(s!==null),FW(s,i,t.host,t._protocol)}return n}function YR(t){function e(n,r){let i;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?i=eW():i=Z7():n.getStatus()===402?i=J7(t.bucket):n.getStatus()===403?i=tW(t.path):i=r,i.status=n.getStatus(),i.serverResponse=r.serverResponse,i}return e}function JR(t){const e=YR(t);function n(r,i){let s=e(r,i);return r.getStatus()===404&&(s=Y7(t.path)),s.serverResponse=i.serverResponse,s}return n}function VW(t,e,n){const r=e.fullServerUrl(),i=Im(r,t.host,t._protocol),s="GET",o=t.maxOperationRetryTime,a=new A1(i,s,BW(t,n),o);return a.errorHandler=JR(e),a}function UW(t,e){const n=e.fullServerUrl(),r=Im(n,t.host,t._protocol),i="DELETE",s=t.maxOperationRetryTime;function o(l,c){}const a=new A1(r,i,o,s);return a.successCodes=[200,204],a.errorHandler=JR(e),a}function WW(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function HW(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=WW(null,e)),r}function qW(t,e,n,r,i){const s=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let w="";for(let _=0;_<2;_++)w=w+Math.random().toString().slice(2);return w}const l=a();o["Content-Type"]="multipart/related; boundary="+l;const c=HW(e,r,i),d=$W(c,n),h="--"+l+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+d+`\r
--`+l+`\r
Content-Type: `+c.contentType+`\r
\r
`,m=`\r
--`+l+"--",p=Oi.getBlob(h,r,m);if(p===null)throw aW();const y={name:c.fullPath},x=Im(s,t.host,t._protocol),E="POST",v=t.maxUploadRetryTime,g=new A1(x,E,zW(t,n),v);return g.urlParams=y,g.headers=o,g.body=p.uploadData(),g.errorHandler=YR(e),g}class GW{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Hs.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Hs.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Hs.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,i){if(this.sent_)throw El("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(n,e,!0),i!==void 0)for(const s in i)i.hasOwnProperty(s)&&this.xhr_.setRequestHeader(s,i[s].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw El("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw El("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw El("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw El("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class KW extends GW{initXhr(){this.xhr_.responseType="text"}}function R1(){return new KW}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lo{constructor(e,n){this._service=e,n instanceof Cn?this._location=n:this._location=Cn.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new lo(e,n)}get root(){const e=new Cn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return GR(this._location.path)}get storage(){return this._service}get parent(){const e=NW(this._location.path);if(e===null)return null;const n=new Cn(this._location.bucket,e);return new lo(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw uW(e)}}function XW(t,e,n){t._throwIfRoot("uploadBytes");const r=qW(t.storage,t._location,KR(),new Oi(e,!0),n);return t.storage.makeRequestWithTokens(r,R1).then(i=>({metadata:i,ref:t}))}function QW(t){t._throwIfRoot("getDownloadURL");const e=VW(t.storage,t._location,KR());return t.storage.makeRequestWithTokens(e,R1).then(n=>{if(n===null)throw lW();return n})}function YW(t){t._throwIfRoot("deleteObject");const e=UW(t.storage,t._location);return t.storage.makeRequestWithTokens(e,R1)}function JW(t,e){const n=DW(t._location.path,e),r=new Cn(t._location.bucket,n);return new lo(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZW(t){return/^[A-Za-z]+:\/\//.test(t)}function eH(t,e){return new lo(t,e)}function ZR(t,e){if(t instanceof P1){const n=t;if(n._bucket==null)throw oW();const r=new lo(n,n._bucket);return e!=null?ZR(r,e):r}else return e!==void 0?JW(t,e):t}function tH(t,e){if(e&&ZW(e)){if(t instanceof P1)return eH(t,e);throw Py("To use ref(service, url), the first argument must be a Storage instance.")}else return ZR(t,e)}function JS(t,e){const n=e==null?void 0:e[zR];return n==null?null:Cn.makeFromBucketSpec(n,t)}function nH(t,e,n,r={}){t.host=`${e}:${n}`,t._protocol="http";const{mockUserToken:i}=r;i&&(t._overrideAuthToken=typeof i=="string"?i:jI(i,t.app.options.projectId))}class P1{constructor(e,n,r,i,s){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._bucket=null,this._host=$R,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=X7,this._maxUploadRetryTime=Q7,this._requests=new Set,i!=null?this._bucket=Cn.makeFromBucketSpec(i,this._host):this._bucket=JS(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Cn.makeFromBucketSpec(this._url,e):this._bucket=JS(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){YS("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){YS("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new lo(this,e)}_makeRequest(e,n,r,i,s=!0){if(this._deleted)return new dW(BR());{const o=EW(e,this._appId,r,i,n,this._firebaseVersion,s);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,n){const[r,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,i).getPromise()}}const ZS="@firebase/storage",eb="0.11.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eP="storage";function tP(t,e,n){return t=xt(t),XW(t,e,n)}function nP(t){return t=xt(t),QW(t)}function rH(t){return t=xt(t),YW(t)}function N1(t,e){return t=xt(t),tH(t,e)}function iH(t=yx(),e){t=xt(t);const r=Gf(t,eP).getImmediate({identifier:e}),i=PI("storage");return i&&sH(r,...i),r}function sH(t,e,n,r={}){nH(t,e,n,r)}function oH(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),i=t.getProvider("app-check-internal");return new P1(n,r,i,e,Eo)}function aH(){ro(new ss(eP,oH,"PUBLIC").setMultipleInstances(!0)),Nr(ZS,eb,""),Nr(ZS,eb,"esm2017")}aH();const D1=LI({apiKey:"AIzaSyBPNpckpYiu009eSzHz_1YMlwHLtScgVjE",appId:"1:938280289868:web:1b426fc2dba5d03dde96e9",projectId:"zingmp3-clone-61799",storageBucket:"zingmp3-clone-61799.appspot.com",authDomain:"zingmp3-clone-61799.firebaseapp.com",messagingSenderId:"938280289868"}),To=C7(D1),us=F8(D1);new Sr;const j1=iH(D1);/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function rP(t,e,n,r){function i(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function a(d){try{c(r.next(d))}catch(h){o(h)}}function l(d){try{c(r.throw(d))}catch(h){o(h)}}function c(d){d.done?s(d.value):i(d.value).then(a,l)}c((r=r.apply(t,e||[])).next())})}function iP(t,e){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,i,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(c){return function(d){return l([c,d])}}function l(c){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,i&&(s=c[0]&2?i.return:c[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,c[1])).done)return s;switch(i=0,s&&(c=[c[0]&2,s.value]),c[0]){case 0:case 1:s=c;break;case 4:return n.label++,{value:c[1],done:!1};case 5:n.label++,i=c[1],c=[0];continue;case 7:c=n.ops.pop(),n.trys.pop();continue;default:if(s=n.trys,!(s=s.length>0&&s[s.length-1])&&(c[0]===6||c[0]===2)){n=0;continue}if(c[0]===3&&(!s||c[1]>s[0]&&c[1]<s[3])){n.label=c[1];break}if(c[0]===6&&n.label<s[1]){n.label=s[1],s=c;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(c);break}s[2]&&n.ops.pop(),n.trys.pop();continue}c=e.call(t,n)}catch(d){c=[6,d],i=0}finally{r=s=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var ta=function(){return ta=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},ta.apply(this,arguments)},sP=function(t){return{loading:t==null,value:t}},lH=function(){return function(t,e){switch(e.type){case"error":return ta(ta({},t),{error:e.error,loading:!1,value:void 0});case"reset":return sP(e.defaultValue);case"value":return ta(ta({},t),{error:void 0,loading:!1,value:e.value});default:return t}}},cH=function(t){var e=t?t():void 0,n=f.useReducer(lH(),sP(e)),r=n[0],i=n[1],s=f.useCallback(function(){var l=t?t():void 0;i({type:"reset",defaultValue:l})},[t]),o=f.useCallback(function(l){i({type:"error",error:l})},[]),a=f.useCallback(function(l){i({type:"value",value:l})},[]);return f.useMemo(function(){return{error:r.error,loading:r.loading,reset:s,setError:o,setValue:a,value:r.value}},[r.error,r.loading,s,o,a,r.value])},Tu=function(t,e){var n=cH(function(){return t.currentUser}),r=n.error,i=n.loading,s=n.setError,o=n.setValue,a=n.value;return f.useEffect(function(){var l=Tz(t,function(c){return rP(void 0,void 0,void 0,function(){var d;return iP(this,function(h){switch(h.label){case 0:if(!(e!=null&&e.onUserChanged))return[3,4];h.label=1;case 1:return h.trys.push([1,3,,4]),[4,e.onUserChanged(c)];case 2:return h.sent(),[3,4];case 3:return d=h.sent(),s(d),[3,4];case 4:return o(c),[2]}})})},s);return function(){l()}},[t]),[a,i,r]},uH=function(t){var e=f.useCallback(function(n,r){var i=new Sr;return n&&n.forEach(function(s){return i.addScope(s)}),r&&i.setCustomParameters(r),i},[]);return dH(t,e)},dH=function(t,e){var n=f.useState(),r=n[0],i=n[1],s=f.useState(),o=s[0],a=s[1],l=f.useState(!1),c=l[0],d=l[1],h=f.useCallback(function(m,p){return rP(void 0,void 0,void 0,function(){var y,x,E;return iP(this,function(v){switch(v.label){case 0:d(!0),i(void 0),v.label=1;case 1:return v.trys.push([1,3,4,5]),y=e(m,p),[4,Gz(t,y)];case 2:return x=v.sent(),a(x),[2,x];case 3:return E=v.sent(),i(E),[3,5];case 4:return d(!1),[7];case 5:return[2]}})})},[t,e]);return[h,o,c,r]},oP={exports:{}},aP={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $a=f;function hH(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var fH=typeof Object.is=="function"?Object.is:hH,mH=$a.useState,pH=$a.useEffect,gH=$a.useLayoutEffect,yH=$a.useDebugValue;function vH(t,e){var n=e(),r=mH({inst:{value:n,getSnapshot:e}}),i=r[0].inst,s=r[1];return gH(function(){i.value=n,i.getSnapshot=e,gg(i)&&s({inst:i})},[t,n,e]),pH(function(){return gg(i)&&s({inst:i}),t(function(){gg(i)&&s({inst:i})})},[t]),yH(n),n}function gg(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!fH(t,n)}catch{return!0}}function xH(t,e){return e()}var wH=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?xH:vH;aP.useSyncExternalStore=$a.useSyncExternalStore!==void 0?$a.useSyncExternalStore:wH;oP.exports=aP;var _H=oP.exports,lP={exports:{}},cP={};/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Cm=f,EH=_H;function SH(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var bH=typeof Object.is=="function"?Object.is:SH,kH=EH.useSyncExternalStore,TH=Cm.useRef,IH=Cm.useEffect,CH=Cm.useMemo,AH=Cm.useDebugValue;cP.useSyncExternalStoreWithSelector=function(t,e,n,r,i){var s=TH(null);if(s.current===null){var o={hasValue:!1,value:null};s.current=o}else o=s.current;s=CH(function(){function l(p){if(!c){if(c=!0,d=p,p=r(p),i!==void 0&&o.hasValue){var y=o.value;if(i(y,p))return h=y}return h=p}if(y=h,bH(d,p))return y;var x=r(p);return i!==void 0&&i(y,x)?y:(d=p,h=x)}var c=!1,d,h,m=n===void 0?null:n;return[function(){return l(e())},m===null?void 0:function(){return l(m())}]},[e,n,r,i]);var a=kH(t,s[0],s[1]);return IH(function(){o.hasValue=!0,o.value=a},[a]),AH(a),a};lP.exports=cP;var RH=lP.exports;function PH(t){t()}let uP=PH;const NH=t=>uP=t,DH=()=>uP,tb=Symbol.for("react-redux-context"),nb=typeof globalThis<"u"?globalThis:{};function jH(){var t;if(!f.createContext)return{};const e=(t=nb[tb])!=null?t:nb[tb]=new Map;let n=e.get(f.createContext);return n||(n=f.createContext(null),e.set(f.createContext,n)),n}const ds=jH();function O1(t=ds){return function(){return f.useContext(t)}}const dP=O1(),OH=()=>{throw new Error("uSES not initialized!")};let hP=OH;const MH=t=>{hP=t},LH=(t,e)=>t===e;function FH(t=ds){const e=t===ds?dP:O1(t);return function(r,i={}){const{equalityFn:s=LH,stabilityCheck:o=void 0,noopCheck:a=void 0}=typeof i=="function"?{equalityFn:i}:i,{store:l,subscription:c,getServerState:d,stabilityCheck:h,noopCheck:m}=e();f.useRef(!0);const p=f.useCallback({[r.name](x){return r(x)}}[r.name],[r,h,o]),y=hP(c.addNestedSub,l.getState,d||l.getState,p,s);return f.useDebugValue(y),y}}const Q=FH();var fP={exports:{}},Ce={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var It=typeof Symbol=="function"&&Symbol.for,M1=It?Symbol.for("react.element"):60103,L1=It?Symbol.for("react.portal"):60106,Am=It?Symbol.for("react.fragment"):60107,Rm=It?Symbol.for("react.strict_mode"):60108,Pm=It?Symbol.for("react.profiler"):60114,Nm=It?Symbol.for("react.provider"):60109,Dm=It?Symbol.for("react.context"):60110,F1=It?Symbol.for("react.async_mode"):60111,jm=It?Symbol.for("react.concurrent_mode"):60111,Om=It?Symbol.for("react.forward_ref"):60112,Mm=It?Symbol.for("react.suspense"):60113,$H=It?Symbol.for("react.suspense_list"):60120,Lm=It?Symbol.for("react.memo"):60115,Fm=It?Symbol.for("react.lazy"):60116,zH=It?Symbol.for("react.block"):60121,BH=It?Symbol.for("react.fundamental"):60117,VH=It?Symbol.for("react.responder"):60118,UH=It?Symbol.for("react.scope"):60119;function Vn(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case M1:switch(t=t.type,t){case F1:case jm:case Am:case Pm:case Rm:case Mm:return t;default:switch(t=t&&t.$$typeof,t){case Dm:case Om:case Fm:case Lm:case Nm:return t;default:return e}}case L1:return e}}}function mP(t){return Vn(t)===jm}Ce.AsyncMode=F1;Ce.ConcurrentMode=jm;Ce.ContextConsumer=Dm;Ce.ContextProvider=Nm;Ce.Element=M1;Ce.ForwardRef=Om;Ce.Fragment=Am;Ce.Lazy=Fm;Ce.Memo=Lm;Ce.Portal=L1;Ce.Profiler=Pm;Ce.StrictMode=Rm;Ce.Suspense=Mm;Ce.isAsyncMode=function(t){return mP(t)||Vn(t)===F1};Ce.isConcurrentMode=mP;Ce.isContextConsumer=function(t){return Vn(t)===Dm};Ce.isContextProvider=function(t){return Vn(t)===Nm};Ce.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===M1};Ce.isForwardRef=function(t){return Vn(t)===Om};Ce.isFragment=function(t){return Vn(t)===Am};Ce.isLazy=function(t){return Vn(t)===Fm};Ce.isMemo=function(t){return Vn(t)===Lm};Ce.isPortal=function(t){return Vn(t)===L1};Ce.isProfiler=function(t){return Vn(t)===Pm};Ce.isStrictMode=function(t){return Vn(t)===Rm};Ce.isSuspense=function(t){return Vn(t)===Mm};Ce.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===Am||t===jm||t===Pm||t===Rm||t===Mm||t===$H||typeof t=="object"&&t!==null&&(t.$$typeof===Fm||t.$$typeof===Lm||t.$$typeof===Nm||t.$$typeof===Dm||t.$$typeof===Om||t.$$typeof===BH||t.$$typeof===VH||t.$$typeof===UH||t.$$typeof===zH)};Ce.typeOf=Vn;fP.exports=Ce;var WH=fP.exports,pP=WH,HH={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},qH={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},gP={};gP[pP.ForwardRef]=HH;gP[pP.Memo]=qH;var Pe={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $1=Symbol.for("react.element"),z1=Symbol.for("react.portal"),$m=Symbol.for("react.fragment"),zm=Symbol.for("react.strict_mode"),Bm=Symbol.for("react.profiler"),Vm=Symbol.for("react.provider"),Um=Symbol.for("react.context"),GH=Symbol.for("react.server_context"),Wm=Symbol.for("react.forward_ref"),Hm=Symbol.for("react.suspense"),qm=Symbol.for("react.suspense_list"),Gm=Symbol.for("react.memo"),Km=Symbol.for("react.lazy"),KH=Symbol.for("react.offscreen"),yP;yP=Symbol.for("react.module.reference");function tr(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case $1:switch(t=t.type,t){case $m:case Bm:case zm:case Hm:case qm:return t;default:switch(t=t&&t.$$typeof,t){case GH:case Um:case Wm:case Km:case Gm:case Vm:return t;default:return e}}case z1:return e}}}Pe.ContextConsumer=Um;Pe.ContextProvider=Vm;Pe.Element=$1;Pe.ForwardRef=Wm;Pe.Fragment=$m;Pe.Lazy=Km;Pe.Memo=Gm;Pe.Portal=z1;Pe.Profiler=Bm;Pe.StrictMode=zm;Pe.Suspense=Hm;Pe.SuspenseList=qm;Pe.isAsyncMode=function(){return!1};Pe.isConcurrentMode=function(){return!1};Pe.isContextConsumer=function(t){return tr(t)===Um};Pe.isContextProvider=function(t){return tr(t)===Vm};Pe.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===$1};Pe.isForwardRef=function(t){return tr(t)===Wm};Pe.isFragment=function(t){return tr(t)===$m};Pe.isLazy=function(t){return tr(t)===Km};Pe.isMemo=function(t){return tr(t)===Gm};Pe.isPortal=function(t){return tr(t)===z1};Pe.isProfiler=function(t){return tr(t)===Bm};Pe.isStrictMode=function(t){return tr(t)===zm};Pe.isSuspense=function(t){return tr(t)===Hm};Pe.isSuspenseList=function(t){return tr(t)===qm};Pe.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===$m||t===Bm||t===zm||t===Hm||t===qm||t===KH||typeof t=="object"&&t!==null&&(t.$$typeof===Km||t.$$typeof===Gm||t.$$typeof===Vm||t.$$typeof===Um||t.$$typeof===Wm||t.$$typeof===yP||t.getModuleId!==void 0)};Pe.typeOf=tr;function XH(){const t=DH();let e=null,n=null;return{clear(){e=null,n=null},notify(){t(()=>{let r=e;for(;r;)r.callback(),r=r.next})},get(){let r=[],i=e;for(;i;)r.push(i),i=i.next;return r},subscribe(r){let i=!0,s=n={callback:r,next:null,prev:n};return s.prev?s.prev.next=s:e=s,function(){!i||e===null||(i=!1,s.next?s.next.prev=s.prev:n=s.prev,s.prev?s.prev.next=s.next:e=s.next)}}}}const rb={notify(){},get:()=>[]};function QH(t,e){let n,r=rb;function i(h){return l(),r.subscribe(h)}function s(){r.notify()}function o(){d.onStateChange&&d.onStateChange()}function a(){return!!n}function l(){n||(n=e?e.addNestedSub(o):t.subscribe(o),r=XH())}function c(){n&&(n(),n=void 0,r.clear(),r=rb)}const d={addNestedSub:i,notifyNestedSubs:s,handleChangeWrapper:o,isSubscribed:a,trySubscribe:l,tryUnsubscribe:c,getListeners:()=>r};return d}const YH=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",JH=YH?f.useLayoutEffect:f.useEffect;function ZH({store:t,context:e,children:n,serverState:r,stabilityCheck:i="once",noopCheck:s="once"}){const o=f.useMemo(()=>{const c=QH(t);return{store:t,subscription:c,getServerState:r?()=>r:void 0,stabilityCheck:i,noopCheck:s}},[t,r,i,s]),a=f.useMemo(()=>t.getState(),[t]);JH(()=>{const{subscription:c}=o;return c.onStateChange=c.notifyNestedSubs,c.trySubscribe(),a!==t.getState()&&c.notifyNestedSubs(),()=>{c.tryUnsubscribe(),c.onStateChange=void 0}},[o,a]);const l=e||ds;return f.createElement(l.Provider,{value:o},n)}function vP(t=ds){const e=t===ds?dP:O1(t);return function(){const{store:r}=e();return r}}const eq=vP();function tq(t=ds){const e=t===ds?eq:vP(t);return function(){return e().dispatch}}const We=tq();MH(RH.useSyncExternalStoreWithSelector);NH(Ka.unstable_batchedUpdates);function ur(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];throw Error("[Immer] minified error nr: "+t+(n.length?" "+n.map(function(i){return"'"+i+"'"}).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function hs(t){return!!t&&!!t[Be]}function gi(t){var e;return!!t&&(function(n){if(!n||typeof n!="object")return!1;var r=Object.getPrototypeOf(n);if(r===null)return!0;var i=Object.hasOwnProperty.call(r,"constructor")&&r.constructor;return i===Object||typeof i=="function"&&Function.toString.call(i)===cq}(t)||Array.isArray(t)||!!t[ub]||!!(!((e=t.constructor)===null||e===void 0)&&e[ub])||B1(t)||V1(t))}function co(t,e,n){n===void 0&&(n=!1),ll(t)===0?(n?Object.keys:ma)(t).forEach(function(r){n&&typeof r=="symbol"||e(r,t[r],t)}):t.forEach(function(r,i){return e(i,r,t)})}function ll(t){var e=t[Be];return e?e.i>3?e.i-4:e.i:Array.isArray(t)?1:B1(t)?2:V1(t)?3:0}function fa(t,e){return ll(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function nq(t,e){return ll(t)===2?t.get(e):t[e]}function xP(t,e,n){var r=ll(t);r===2?t.set(e,n):r===3?t.add(n):t[e]=n}function wP(t,e){return t===e?t!==0||1/t==1/e:t!=t&&e!=e}function B1(t){return aq&&t instanceof Map}function V1(t){return lq&&t instanceof Set}function Ps(t){return t.o||t.t}function U1(t){if(Array.isArray(t))return Array.prototype.slice.call(t);var e=EP(t);delete e[Be];for(var n=ma(e),r=0;r<n.length;r++){var i=n[r],s=e[i];s.writable===!1&&(s.writable=!0,s.configurable=!0),(s.get||s.set)&&(e[i]={configurable:!0,writable:!0,enumerable:s.enumerable,value:t[i]})}return Object.create(Object.getPrototypeOf(t),e)}function W1(t,e){return e===void 0&&(e=!1),H1(t)||hs(t)||!gi(t)||(ll(t)>1&&(t.set=t.add=t.clear=t.delete=rq),Object.freeze(t),e&&co(t,function(n,r){return W1(r,!0)},!0)),t}function rq(){ur(2)}function H1(t){return t==null||typeof t!="object"||Object.isFrozen(t)}function Lr(t){var e=My[t];return e||ur(18,t),e}function iq(t,e){My[t]||(My[t]=e)}function Ny(){return Vc}function yg(t,e){e&&(Lr("Patches"),t.u=[],t.s=[],t.v=e)}function nf(t){Dy(t),t.p.forEach(sq),t.p=null}function Dy(t){t===Vc&&(Vc=t.l)}function ib(t){return Vc={p:[],l:Vc,h:t,m:!0,_:0}}function sq(t){var e=t[Be];e.i===0||e.i===1?e.j():e.g=!0}function vg(t,e){e._=e.p.length;var n=e.p[0],r=t!==void 0&&t!==n;return e.h.O||Lr("ES5").S(e,t,r),r?(n[Be].P&&(nf(e),ur(4)),gi(t)&&(t=rf(e,t),e.l||sf(e,t)),e.u&&Lr("Patches").M(n[Be].t,t,e.u,e.s)):t=rf(e,n,[]),nf(e),e.u&&e.v(e.u,e.s),t!==_P?t:void 0}function rf(t,e,n){if(H1(e))return e;var r=e[Be];if(!r)return co(e,function(a,l){return sb(t,r,e,a,l,n)},!0),e;if(r.A!==t)return e;if(!r.P)return sf(t,r.t,!0),r.t;if(!r.I){r.I=!0,r.A._--;var i=r.i===4||r.i===5?r.o=U1(r.k):r.o,s=i,o=!1;r.i===3&&(s=new Set(i),i.clear(),o=!0),co(s,function(a,l){return sb(t,r,i,a,l,n,o)}),sf(t,i,!1),n&&t.u&&Lr("Patches").N(r,n,t.u,t.s)}return r.o}function sb(t,e,n,r,i,s,o){if(hs(i)){var a=rf(t,i,s&&e&&e.i!==3&&!fa(e.R,r)?s.concat(r):void 0);if(xP(n,r,a),!hs(a))return;t.m=!1}else o&&n.add(i);if(gi(i)&&!H1(i)){if(!t.h.D&&t._<1)return;rf(t,i),e&&e.A.l||sf(t,i)}}function sf(t,e,n){n===void 0&&(n=!1),!t.l&&t.h.D&&t.m&&W1(e,n)}function xg(t,e){var n=t[Be];return(n?Ps(n):t)[e]}function ob(t,e){if(e in t)for(var n=Object.getPrototypeOf(t);n;){var r=Object.getOwnPropertyDescriptor(n,e);if(r)return r;n=Object.getPrototypeOf(n)}}function Mi(t){t.P||(t.P=!0,t.l&&Mi(t.l))}function wg(t){t.o||(t.o=U1(t.t))}function jy(t,e,n){var r=B1(e)?Lr("MapSet").F(e,n):V1(e)?Lr("MapSet").T(e,n):t.O?function(i,s){var o=Array.isArray(i),a={i:o?1:0,A:s?s.A:Ny(),P:!1,I:!1,R:{},l:s,t:i,k:null,o:null,j:null,C:!1},l=a,c=Uc;o&&(l=[a],c=jl);var d=Proxy.revocable(l,c),h=d.revoke,m=d.proxy;return a.k=m,a.j=h,m}(e,n):Lr("ES5").J(e,n);return(n?n.A:Ny()).p.push(r),r}function Oy(t){return hs(t)||ur(22,t),function e(n){if(!gi(n))return n;var r,i=n[Be],s=ll(n);if(i){if(!i.P&&(i.i<4||!Lr("ES5").K(i)))return i.t;i.I=!0,r=ab(n,s),i.I=!1}else r=ab(n,s);return co(r,function(o,a){i&&nq(i.t,o)===a||xP(r,o,e(a))}),s===3?new Set(r):r}(t)}function ab(t,e){switch(e){case 2:return new Map(t);case 3:return Array.from(t)}return U1(t)}function oq(){function t(s,o){var a=i[s];return a?a.enumerable=o:i[s]=a={configurable:!0,enumerable:o,get:function(){var l=this[Be];return Uc.get(l,s)},set:function(l){var c=this[Be];Uc.set(c,s,l)}},a}function e(s){for(var o=s.length-1;o>=0;o--){var a=s[o][Be];if(!a.P)switch(a.i){case 5:r(a)&&Mi(a);break;case 4:n(a)&&Mi(a)}}}function n(s){for(var o=s.t,a=s.k,l=ma(a),c=l.length-1;c>=0;c--){var d=l[c];if(d!==Be){var h=o[d];if(h===void 0&&!fa(o,d))return!0;var m=a[d],p=m&&m[Be];if(p?p.t!==h:!wP(m,h))return!0}}var y=!!o[Be];return l.length!==ma(o).length+(y?0:1)}function r(s){var o=s.k;if(o.length!==s.t.length)return!0;var a=Object.getOwnPropertyDescriptor(o,o.length-1);if(a&&!a.get)return!0;for(var l=0;l<o.length;l++)if(!o.hasOwnProperty(l))return!0;return!1}var i={};iq("ES5",{J:function(s,o){var a=Array.isArray(s),l=function(d,h){if(d){for(var m=Array(h.length),p=0;p<h.length;p++)Object.defineProperty(m,""+p,t(p,!0));return m}var y=EP(h);delete y[Be];for(var x=ma(y),E=0;E<x.length;E++){var v=x[E];y[v]=t(v,d||!!y[v].enumerable)}return Object.create(Object.getPrototypeOf(h),y)}(a,s),c={i:a?5:4,A:o?o.A:Ny(),P:!1,I:!1,R:{},l:o,t:s,k:l,o:null,g:!1,C:!1};return Object.defineProperty(l,Be,{value:c,writable:!0}),l},S:function(s,o,a){a?hs(o)&&o[Be].A===s&&e(s.p):(s.u&&function l(c){if(c&&typeof c=="object"){var d=c[Be];if(d){var h=d.t,m=d.k,p=d.R,y=d.i;if(y===4)co(m,function(w){w!==Be&&(h[w]!==void 0||fa(h,w)?p[w]||l(m[w]):(p[w]=!0,Mi(d)))}),co(h,function(w){m[w]!==void 0||fa(m,w)||(p[w]=!1,Mi(d))});else if(y===5){if(r(d)&&(Mi(d),p.length=!0),m.length<h.length)for(var x=m.length;x<h.length;x++)p[x]=!1;else for(var E=h.length;E<m.length;E++)p[E]=!0;for(var v=Math.min(m.length,h.length),g=0;g<v;g++)m.hasOwnProperty(g)||(p[g]=!0),p[g]===void 0&&l(m[g])}}}}(s.p[0]),e(s.p))},K:function(s){return s.i===4?n(s):r(s)}})}var lb,Vc,q1=typeof Symbol<"u"&&typeof Symbol("x")=="symbol",aq=typeof Map<"u",lq=typeof Set<"u",cb=typeof Proxy<"u"&&Proxy.revocable!==void 0&&typeof Reflect<"u",_P=q1?Symbol.for("immer-nothing"):((lb={})["immer-nothing"]=!0,lb),ub=q1?Symbol.for("immer-draftable"):"__$immer_draftable",Be=q1?Symbol.for("immer-state"):"__$immer_state",cq=""+Object.prototype.constructor,ma=typeof Reflect<"u"&&Reflect.ownKeys?Reflect.ownKeys:Object.getOwnPropertySymbols!==void 0?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:Object.getOwnPropertyNames,EP=Object.getOwnPropertyDescriptors||function(t){var e={};return ma(t).forEach(function(n){e[n]=Object.getOwnPropertyDescriptor(t,n)}),e},My={},Uc={get:function(t,e){if(e===Be)return t;var n=Ps(t);if(!fa(n,e))return function(i,s,o){var a,l=ob(s,o);return l?"value"in l?l.value:(a=l.get)===null||a===void 0?void 0:a.call(i.k):void 0}(t,n,e);var r=n[e];return t.I||!gi(r)?r:r===xg(t.t,e)?(wg(t),t.o[e]=jy(t.A.h,r,t)):r},has:function(t,e){return e in Ps(t)},ownKeys:function(t){return Reflect.ownKeys(Ps(t))},set:function(t,e,n){var r=ob(Ps(t),e);if(r!=null&&r.set)return r.set.call(t.k,n),!0;if(!t.P){var i=xg(Ps(t),e),s=i==null?void 0:i[Be];if(s&&s.t===n)return t.o[e]=n,t.R[e]=!1,!0;if(wP(n,i)&&(n!==void 0||fa(t.t,e)))return!0;wg(t),Mi(t)}return t.o[e]===n&&(n!==void 0||e in t.o)||Number.isNaN(n)&&Number.isNaN(t.o[e])||(t.o[e]=n,t.R[e]=!0),!0},deleteProperty:function(t,e){return xg(t.t,e)!==void 0||e in t.t?(t.R[e]=!1,wg(t),Mi(t)):delete t.R[e],t.o&&delete t.o[e],!0},getOwnPropertyDescriptor:function(t,e){var n=Ps(t),r=Reflect.getOwnPropertyDescriptor(n,e);return r&&{writable:!0,configurable:t.i!==1||e!=="length",enumerable:r.enumerable,value:n[e]}},defineProperty:function(){ur(11)},getPrototypeOf:function(t){return Object.getPrototypeOf(t.t)},setPrototypeOf:function(){ur(12)}},jl={};co(Uc,function(t,e){jl[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}}),jl.deleteProperty=function(t,e){return jl.set.call(this,t,e,void 0)},jl.set=function(t,e,n){return Uc.set.call(this,t[0],e,n,t[0])};var uq=function(){function t(n){var r=this;this.O=cb,this.D=!0,this.produce=function(i,s,o){if(typeof i=="function"&&typeof s!="function"){var a=s;s=i;var l=r;return function(x){var E=this;x===void 0&&(x=a);for(var v=arguments.length,g=Array(v>1?v-1:0),w=1;w<v;w++)g[w-1]=arguments[w];return l.produce(x,function(_){var S;return(S=s).call.apply(S,[E,_].concat(g))})}}var c;if(typeof s!="function"&&ur(6),o!==void 0&&typeof o!="function"&&ur(7),gi(i)){var d=ib(r),h=jy(r,i,void 0),m=!0;try{c=s(h),m=!1}finally{m?nf(d):Dy(d)}return typeof Promise<"u"&&c instanceof Promise?c.then(function(x){return yg(d,o),vg(x,d)},function(x){throw nf(d),x}):(yg(d,o),vg(c,d))}if(!i||typeof i!="object"){if((c=s(i))===void 0&&(c=i),c===_P&&(c=void 0),r.D&&W1(c,!0),o){var p=[],y=[];Lr("Patches").M(i,c,p,y),o(p,y)}return c}ur(21,i)},this.produceWithPatches=function(i,s){if(typeof i=="function")return function(c){for(var d=arguments.length,h=Array(d>1?d-1:0),m=1;m<d;m++)h[m-1]=arguments[m];return r.produceWithPatches(c,function(p){return i.apply(void 0,[p].concat(h))})};var o,a,l=r.produce(i,s,function(c,d){o=c,a=d});return typeof Promise<"u"&&l instanceof Promise?l.then(function(c){return[c,o,a]}):[l,o,a]},typeof(n==null?void 0:n.useProxies)=="boolean"&&this.setUseProxies(n.useProxies),typeof(n==null?void 0:n.autoFreeze)=="boolean"&&this.setAutoFreeze(n.autoFreeze)}var e=t.prototype;return e.createDraft=function(n){gi(n)||ur(8),hs(n)&&(n=Oy(n));var r=ib(this),i=jy(this,n,void 0);return i[Be].C=!0,Dy(r),i},e.finishDraft=function(n,r){var i=n&&n[Be],s=i.A;return yg(s,r),vg(void 0,s)},e.setAutoFreeze=function(n){this.D=n},e.setUseProxies=function(n){n&&!cb&&ur(20),this.O=n},e.applyPatches=function(n,r){var i;for(i=r.length-1;i>=0;i--){var s=r[i];if(s.path.length===0&&s.op==="replace"){n=s.value;break}}i>-1&&(r=r.slice(i+1));var o=Lr("Patches").$;return hs(n)?o(n,r):this.produce(n,function(a){return o(a,r)})},t}(),Mn=new uq,SP=Mn.produce;Mn.produceWithPatches.bind(Mn);Mn.setAutoFreeze.bind(Mn);Mn.setUseProxies.bind(Mn);Mn.applyPatches.bind(Mn);Mn.createDraft.bind(Mn);Mn.finishDraft.bind(Mn);function Wc(t){"@babel/helpers - typeof";return Wc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wc(t)}function dq(t,e){if(Wc(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Wc(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function hq(t){var e=dq(t,"string");return Wc(e)==="symbol"?e:String(e)}function fq(t,e,n){return e=hq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function db(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function hb(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?db(Object(n),!0).forEach(function(r){fq(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):db(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function zt(t){return"Minified Redux error #"+t+"; visit https://redux.js.org/Errors?code="+t+" for the full message or use the non-minified dev environment for full errors. "}var fb=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}(),_g=function(){return Math.random().toString(36).substring(7).split("").join(".")},of={INIT:"@@redux/INIT"+_g(),REPLACE:"@@redux/REPLACE"+_g(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+_g()}};function mq(t){if(typeof t!="object"||t===null)return!1;for(var e=t;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}function bP(t,e,n){var r;if(typeof e=="function"&&typeof n=="function"||typeof n=="function"&&typeof arguments[3]=="function")throw new Error(zt(0));if(typeof e=="function"&&typeof n>"u"&&(n=e,e=void 0),typeof n<"u"){if(typeof n!="function")throw new Error(zt(1));return n(bP)(t,e)}if(typeof t!="function")throw new Error(zt(2));var i=t,s=e,o=[],a=o,l=!1;function c(){a===o&&(a=o.slice())}function d(){if(l)throw new Error(zt(3));return s}function h(x){if(typeof x!="function")throw new Error(zt(4));if(l)throw new Error(zt(5));var E=!0;return c(),a.push(x),function(){if(E){if(l)throw new Error(zt(6));E=!1,c();var g=a.indexOf(x);a.splice(g,1),o=null}}}function m(x){if(!mq(x))throw new Error(zt(7));if(typeof x.type>"u")throw new Error(zt(8));if(l)throw new Error(zt(9));try{l=!0,s=i(s,x)}finally{l=!1}for(var E=o=a,v=0;v<E.length;v++){var g=E[v];g()}return x}function p(x){if(typeof x!="function")throw new Error(zt(10));i=x,m({type:of.REPLACE})}function y(){var x,E=h;return x={subscribe:function(g){if(typeof g!="object"||g===null)throw new Error(zt(11));function w(){g.next&&g.next(d())}w();var _=E(w);return{unsubscribe:_}}},x[fb]=function(){return this},x}return m({type:of.INIT}),r={dispatch:m,subscribe:h,getState:d,replaceReducer:p},r[fb]=y,r}function pq(t){Object.keys(t).forEach(function(e){var n=t[e],r=n(void 0,{type:of.INIT});if(typeof r>"u")throw new Error(zt(12));if(typeof n(void 0,{type:of.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(zt(13))})}function gq(t){for(var e=Object.keys(t),n={},r=0;r<e.length;r++){var i=e[r];typeof t[i]=="function"&&(n[i]=t[i])}var s=Object.keys(n),o;try{pq(n)}catch(a){o=a}return function(l,c){if(l===void 0&&(l={}),o)throw o;for(var d=!1,h={},m=0;m<s.length;m++){var p=s[m],y=n[p],x=l[p],E=y(x,c);if(typeof E>"u")throw c&&c.type,new Error(zt(14));h[p]=E,d=d||E!==x}return d=d||s.length!==Object.keys(l).length,d?h:l}}function af(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.length===0?function(r){return r}:e.length===1?e[0]:e.reduce(function(r,i){return function(){return r(i.apply(void 0,arguments))}})}function yq(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(r){return function(){var i=r.apply(void 0,arguments),s=function(){throw new Error(zt(15))},o={getState:i.getState,dispatch:function(){return s.apply(void 0,arguments)}},a=e.map(function(l){return l(o)});return s=af.apply(void 0,a)(i.dispatch),hb(hb({},i),{},{dispatch:s})}}}function kP(t){var e=function(r){var i=r.dispatch,s=r.getState;return function(o){return function(a){return typeof a=="function"?a(i,s,t):o(a)}}};return e}var TP=kP();TP.withExtraArgument=kP;const mb=TP;var IP=globalThis&&globalThis.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),vq=globalThis&&globalThis.__generator||function(t,e){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,i,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(c){return function(d){return l([c,d])}}function l(c){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,i&&(s=c[0]&2?i.return:c[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,c[1])).done)return s;switch(i=0,s&&(c=[c[0]&2,s.value]),c[0]){case 0:case 1:s=c;break;case 4:return n.label++,{value:c[1],done:!1};case 5:n.label++,i=c[1],c=[0];continue;case 7:c=n.ops.pop(),n.trys.pop();continue;default:if(s=n.trys,!(s=s.length>0&&s[s.length-1])&&(c[0]===6||c[0]===2)){n=0;continue}if(c[0]===3&&(!s||c[1]>s[0]&&c[1]<s[3])){n.label=c[1];break}if(c[0]===6&&n.label<s[1]){n.label=s[1],s=c;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(c);break}s[2]&&n.ops.pop(),n.trys.pop();continue}c=e.call(t,n)}catch(d){c=[6,d],i=0}finally{r=s=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}},za=globalThis&&globalThis.__spreadArray||function(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t},xq=Object.defineProperty,wq=Object.defineProperties,_q=Object.getOwnPropertyDescriptors,pb=Object.getOwnPropertySymbols,Eq=Object.prototype.hasOwnProperty,Sq=Object.prototype.propertyIsEnumerable,gb=function(t,e,n){return e in t?xq(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n},ts=function(t,e){for(var n in e||(e={}))Eq.call(e,n)&&gb(t,n,e[n]);if(pb)for(var r=0,i=pb(e);r<i.length;r++){var n=i[r];Sq.call(e,n)&&gb(t,n,e[n])}return t},Eg=function(t,e){return wq(t,_q(e))},bq=function(t,e,n){return new Promise(function(r,i){var s=function(l){try{a(n.next(l))}catch(c){i(c)}},o=function(l){try{a(n.throw(l))}catch(c){i(c)}},a=function(l){return l.done?r(l.value):Promise.resolve(l.value).then(s,o)};a((n=n.apply(t,e)).next())})},kq=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?af:af.apply(null,arguments)};function Tq(t){if(typeof t!="object"||t===null)return!1;var e=Object.getPrototypeOf(t);if(e===null)return!0;for(var n=e;Object.getPrototypeOf(n)!==null;)n=Object.getPrototypeOf(n);return e===n}var Iq=function(t){IP(e,t);function e(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var i=t.apply(this,n)||this;return Object.setPrototypeOf(i,e.prototype),i}return Object.defineProperty(e,Symbol.species,{get:function(){return e},enumerable:!1,configurable:!0}),e.prototype.concat=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return t.prototype.concat.apply(this,n)},e.prototype.prepend=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return n.length===1&&Array.isArray(n[0])?new(e.bind.apply(e,za([void 0],n[0].concat(this)))):new(e.bind.apply(e,za([void 0],n.concat(this))))},e}(Array),Cq=function(t){IP(e,t);function e(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var i=t.apply(this,n)||this;return Object.setPrototypeOf(i,e.prototype),i}return Object.defineProperty(e,Symbol.species,{get:function(){return e},enumerable:!1,configurable:!0}),e.prototype.concat=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return t.prototype.concat.apply(this,n)},e.prototype.prepend=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return n.length===1&&Array.isArray(n[0])?new(e.bind.apply(e,za([void 0],n[0].concat(this)))):new(e.bind.apply(e,za([void 0],n.concat(this))))},e}(Array);function Ly(t){return gi(t)?SP(t,function(){}):t}function Aq(t){return typeof t=="boolean"}function Rq(){return function(e){return Pq(e)}}function Pq(t){t===void 0&&(t={});var e=t.thunk,n=e===void 0?!0:e;t.immutableCheck,t.serializableCheck;var r=new Iq;return n&&(Aq(n)?r.push(mb):r.push(mb.withExtraArgument(n.extraArgument))),r}var Nq=!0;function Dq(t){var e=Rq(),n=t||{},r=n.reducer,i=r===void 0?void 0:r,s=n.middleware,o=s===void 0?e():s,a=n.devTools,l=a===void 0?!0:a,c=n.preloadedState,d=c===void 0?void 0:c,h=n.enhancers,m=h===void 0?void 0:h,p;if(typeof i=="function")p=i;else if(Tq(i))p=gq(i);else throw new Error('"reducer" is a required argument, and must be a function or an object of functions that can be passed to combineReducers');var y=o;typeof y=="function"&&(y=y(e));var x=yq.apply(void 0,y),E=af;l&&(E=kq(ts({trace:!Nq},typeof l=="object"&&l)));var v=new Cq(x),g=v;Array.isArray(m)?g=za([x],m):typeof m=="function"&&(g=m(v));var w=E.apply(void 0,g);return bP(p,d,w)}function ns(t,e){function n(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];if(e){var s=e.apply(void 0,r);if(!s)throw new Error("prepareAction did not return an object");return ts(ts({type:t,payload:s.payload},"meta"in s&&{meta:s.meta}),"error"in s&&{error:s.error})}return{type:t,payload:r[0]}}return n.toString=function(){return""+t},n.type=t,n.match=function(r){return r.type===t},n}function CP(t){var e={},n=[],r,i={addCase:function(s,o){var a=typeof s=="string"?s:s.type;if(a in e)throw new Error("addCase cannot be called with two reducers for the same action type");return e[a]=o,i},addMatcher:function(s,o){return n.push({matcher:s,reducer:o}),i},addDefaultCase:function(s){return r=s,i}};return t(i),[e,n,r]}function jq(t){return typeof t=="function"}function Oq(t,e,n,r){n===void 0&&(n=[]);var i=typeof e=="function"?CP(e):[e,n,r],s=i[0],o=i[1],a=i[2],l;if(jq(t))l=function(){return Ly(t())};else{var c=Ly(t);l=function(){return c}}function d(h,m){h===void 0&&(h=l());var p=za([s[m.type]],o.filter(function(y){var x=y.matcher;return x(m)}).map(function(y){var x=y.reducer;return x}));return p.filter(function(y){return!!y}).length===0&&(p=[a]),p.reduce(function(y,x){if(x)if(hs(y)){var E=y,v=x(E,m);return v===void 0?y:v}else{if(gi(y))return SP(y,function(g){return x(g,m)});var v=x(y,m);if(v===void 0){if(y===null)return y;throw Error("A case reducer on a non-draftable value must not return undefined")}return v}return y},h)}return d.getInitialState=l,d}function Mq(t,e){return t+"/"+e}function Xm(t){var e=t.name;if(!e)throw new Error("`name` is a required option for createSlice");typeof process<"u";var n=typeof t.initialState=="function"?t.initialState:Ly(t.initialState),r=t.reducers||{},i=Object.keys(r),s={},o={},a={};i.forEach(function(d){var h=r[d],m=Mq(e,d),p,y;"reducer"in h?(p=h.reducer,y=h.prepare):p=h,s[d]=p,o[m]=p,a[d]=y?ns(m,y):ns(m)});function l(){var d=typeof t.extraReducers=="function"?CP(t.extraReducers):[t.extraReducers],h=d[0],m=h===void 0?{}:h,p=d[1],y=p===void 0?[]:p,x=d[2],E=x===void 0?void 0:x,v=ts(ts({},m),o);return Oq(n,function(g){for(var w in v)g.addCase(w,v[w]);for(var _=0,S=y;_<S.length;_++){var T=S[_];g.addMatcher(T.matcher,T.reducer)}E&&g.addDefaultCase(E)})}var c;return{name:e,reducer:function(d,h){return c||(c=l()),c(d,h)},actions:a,caseReducers:s,getInitialState:function(){return c||(c=l()),c.getInitialState()}}}var Lq="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",Fq=function(t){t===void 0&&(t=21);for(var e="",n=t;n--;)e+=Lq[Math.random()*64|0];return e},$q=["name","message","stack","code"],Sg=function(){function t(e,n){this.payload=e,this.meta=n}return t}(),yb=function(){function t(e,n){this.payload=e,this.meta=n}return t}(),zq=function(t){if(typeof t=="object"&&t!==null){for(var e={},n=0,r=$q;n<r.length;n++){var i=r[n];typeof t[i]=="string"&&(e[i]=t[i])}return e}return{message:String(t)}};(function(){function t(e,n,r){var i=ns(e+"/fulfilled",function(c,d,h,m){return{payload:c,meta:Eg(ts({},m||{}),{arg:h,requestId:d,requestStatus:"fulfilled"})}}),s=ns(e+"/pending",function(c,d,h){return{payload:void 0,meta:Eg(ts({},h||{}),{arg:d,requestId:c,requestStatus:"pending"})}}),o=ns(e+"/rejected",function(c,d,h,m,p){return{payload:m,error:(r&&r.serializeError||zq)(c||"Rejected"),meta:Eg(ts({},p||{}),{arg:h,requestId:d,rejectedWithValue:!!m,requestStatus:"rejected",aborted:(c==null?void 0:c.name)==="AbortError",condition:(c==null?void 0:c.name)==="ConditionError"})}}),a=typeof AbortController<"u"?AbortController:function(){function c(){this.signal={aborted:!1,addEventListener:function(){},dispatchEvent:function(){return!1},onabort:function(){},removeEventListener:function(){},reason:void 0,throwIfAborted:function(){}}}return c.prototype.abort=function(){},c}();function l(c){return function(d,h,m){var p=r!=null&&r.idGenerator?r.idGenerator(c):Fq(),y=new a,x;function E(g){x=g,y.abort()}var v=function(){return bq(this,null,function(){var g,w,_,S,T,b,k;return vq(this,function(R){switch(R.label){case 0:return R.trys.push([0,4,,5]),S=(g=r==null?void 0:r.condition)==null?void 0:g.call(r,c,{getState:h,extra:m}),Vq(S)?[4,S]:[3,2];case 1:S=R.sent(),R.label=2;case 2:if(S===!1||y.signal.aborted)throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};return T=new Promise(function(P,O){return y.signal.addEventListener("abort",function(){return O({name:"AbortError",message:x||"Aborted"})})}),d(s(p,c,(w=r==null?void 0:r.getPendingMeta)==null?void 0:w.call(r,{requestId:p,arg:c},{getState:h,extra:m}))),[4,Promise.race([T,Promise.resolve(n(c,{dispatch:d,getState:h,extra:m,requestId:p,signal:y.signal,abort:E,rejectWithValue:function(P,O){return new Sg(P,O)},fulfillWithValue:function(P,O){return new yb(P,O)}})).then(function(P){if(P instanceof Sg)throw P;return P instanceof yb?i(P.payload,p,c,P.meta):i(P,p,c)})])];case 3:return _=R.sent(),[3,5];case 4:return b=R.sent(),_=b instanceof Sg?o(null,p,c,b.payload,b.meta):o(b,p,c),[3,5];case 5:return k=r&&!r.dispatchConditionRejection&&o.match(_)&&_.meta.condition,k||d(_),[2,_]}})})}();return Object.assign(v,{abort:E,requestId:p,arg:c,unwrap:function(){return v.then(Bq)}})}}return Object.assign(l,{pending:s,rejected:o,fulfilled:i,typePrefix:e})}return t.withTypes=function(){return t},t})();function Bq(t){if(t.meta&&t.meta.rejectedWithValue)throw t.payload;if(t.error)throw t.error;return t.payload}function Vq(t){return t!==null&&typeof t=="object"&&typeof t.then=="function"}var G1="listenerMiddleware";ns(G1+"/add");ns(G1+"/removeAll");ns(G1+"/remove");var vb;typeof queueMicrotask=="function"&&queueMicrotask.bind(typeof window<"u"?window:typeof global<"u"?global:globalThis);oq();const Uq=si();let Wq=Uq.current||{...hx({}),currentIndex:0,song_in:""};const Hq={currentSong:Wq},AP=Xm({name:"currentSong",initialState:Hq,reducers:{setSong(t,e){t.currentSong=e.payload},updateSong:(t,e)=>{const n=e.payload;Object.assign(t.currentSong,n)},resetCurrentSong:t=>{t.currentSong={...hx({}),currentIndex:0,song_in:""}}}}),Ae=t=>t.currentSong,{setSong:Nn,resetCurrentSong:uo,updateSong:XQ}=AP.actions,qq=AP.reducer,Gq=si(),Kq={queueSongs:Gq.queue||[],from:[]},RP=Xm({name:"songQueue",initialState:Kq,reducers:{setQueue:(t,e)=>{const{songs:n}=e.payload;t.queueSongs=n,t.from=[n[0].song_in],tn("queue",t.queueSongs)},removeSongFromQueue:(t,e)=>{const{index:n}=e.payload;t.queueSongs.splice(n,1),tn("queue",t.queueSongs);const r=[];t.queueSongs.forEach(i=>{r.includes(i.song_in)||r.push(i.song_in)}),t.from=r},addSongToQueue:(t,e)=>{const{songs:n}=e.payload;t.from.includes(n[0].song_in)||t.from.push(n[0].song_in),t.queueSongs.push(...n),tn("queue",t.queueSongs)},updateSongInQueue:(t,e)=>{const{song:n}=e.payload,r=t.queueSongs.findIndex(i=>i.id===n.id);Object.assign(t.queueSongs[r],n)},resetSongQueue:t=>{t.queueSongs=[],tn("queue",[])}}}),xi=t=>t.songQueue,{addSongToQueue:K1,updateSongInQueue:QQ,removeSongFromQueue:Xq,setQueue:Qm,resetSongQueue:PP}=RP.actions,Qq=RP.reducer,NP={user:null,loading:!0},Yq=(t,e)=>{switch(e.type){case 0:return{user:e.payload.user,loading:!1};case 1:return{user:null,loading:!0};default:return{user:t.user,loading:t.loading}}},Jq={state:{user:NP.user,loading:!0},setUser:()=>{}},DP=f.createContext(Jq),Zq=()=>{const[t,e]=f.useReducer(Yq,NP),n=f.useCallback(r=>{switch(r.type){case"set-user":return console.log("set user"),e({type:0,payload:{user:r.user}});case"reset":return console.log("reset user"),e({type:1,payload:{user:null}})}},[]);return{state:{loading:t.loading,user:t.user},setUser:n}},eG=({children:t})=>{const{state:{loading:e,user:n},setUser:r}=Zq();return u.jsx(DP.Provider,{value:{state:{loading:e,user:n},setUser:r},children:t})},mt=()=>{const{state:{loading:t,user:e},setUser:n}=f.useContext(DP);return{loading:t,user:e,setUser:n}},Iu=()=>{const t=vn(),e=We(),{setUser:n}=mt(),{resetSongPlaylistStore:r}=ot(),[i]=uH(us),s=()=>{document.querySelector(".hd-mp3").pause(),e(uo())};return{logOut:async()=>{await oC(us),n({type:"reset"}),e(PP()),r(),s(),t(Pt.Home)},logIn:async()=>{await i()&&(e(uo()),r(),n({type:"reset"}))}}},tG={toasts:[]},nG={state:tG,setToasts:()=>{},setErrorToast:()=>{},setSuccessToast:()=>{}},jP=f.createContext(nG),rG=({children:t})=>{const[e,n]=f.useState([]),r=({message:s="Somethings went wrong"})=>n(o=>[...o,{title:"error",id:Rh(4),desc:s}]),i=({message:s="Success"})=>n(o=>[...o,{title:"success",id:Rh(4),desc:`${s}`}]);return u.jsx(jP.Provider,{value:{state:{toasts:e},setToasts:n,setErrorToast:r,setSuccessToast:i},children:t})},xn=()=>{const{state:{toasts:t},setToasts:e,setErrorToast:n,setSuccessToast:r}=f.useContext(jP);return{toasts:t,setToasts:e,setErrorToast:n,setSuccessToast:r}},OP={tempSongs:[],status:""},iG=(t,e)=>{switch(e.type){case 0:{const{songs:n}=e.payload;return{...t,tempSongs:n,status:"uploading"}}case 1:{const n=[...t.tempSongs];return n.shift(),{...t,tempSongs:n}}case 2:{const{status:n}=e.payload;return{...t,tempSongs:[],status:n}}}},sG=()=>{const[t,e]=f.useReducer(iG,OP),n=f.useCallback(s=>{e({type:0,payload:{songs:s}})},[]),r=f.useCallback(()=>{e({type:1})},[]),i=f.useCallback(s=>{e({type:2,payload:{status:s}})},[]);return{state:t,setTempSongs:n,shiftSong:r,clearTempSongs:i}},oG={state:OP,setTempSongs:()=>{},shiftSong:()=>{},clearTempSongs:()=>{}},MP=f.createContext(oG),aG=({children:t})=>u.jsx(MP.Provider,{value:sG(),children:t}),Ym=()=>{const{state:{...t},...e}=f.useContext(MP);return{...e,...t}},Hc=async({collection:t,id:e,msg:n})=>{await G7(y1(To,t,e))},Ba=async({collection:t,id:e,msg:n})=>H7(y1(To,t,e)),Jn=async({collection:t,id:e,data:n,msg:r})=>await q7(y1(To,t,e),{...n},{merge:!0}),LP=async({file:t,folder:e,email:n,msg:r})=>{const i=n.replace("@gmail.com","")+"_"+t.name.replaceAll(" ","").toLowerCase(),s=N1(j1,`${e+i}`),o=await tP(s,t);return{fileURL:await nP(o.ref),filePath:o.metadata.fullPath}},lG=async({blob:t,folder:e,songId:n,msg:r})=>{const i=n+"_stock",s=N1(j1,`${e+i}`),o=await tP(s,t);return{fileURL:await nP(o.ref),filePath:o.metadata.fullPath}},Fy=async({filePath:t,msg:e})=>{const n=N1(j1,t);await rH(n)},FP=async t=>{await Hc({collection:"songs",id:t.id,msg:">>> api: delete song doc"}),await Fy({filePath:t.song_file_path,msg:">>> api: delete song file"}),t.lyric_id&&await Hc({collection:"lyrics",id:t.lyric_id,msg:">>> api: delete song lyric doc"}),t.image_file_path&&await Fy({filePath:t.image_file_path,msg:">>> api: delete song's image file"})},xb=async(t,e)=>{const n=t.map(r=>r.id);await Jn({collection:"users",data:{playlist_ids:n},id:e.email,msg:">>> api: set user playlist_ids"})},bg={currentPlaylist:fx({}),playlistSongs:[]},$P=Xm({name:"currentPlaylist",initialState:bg,reducers:{setCurrentPlaylist(t,e){const{playlist:n,songs:r}=e.payload;t.currentPlaylist=n,t.playlistSongs=r},updateCurrentPlaylist:(t,e)=>{const n=e.payload;Object.assign(t.currentPlaylist,n)},addSongsAndUpdateCurrent(t,e){const{songs:n}=e.payload,r=n.map(i=>({...i,song_in:`playlist_${t.currentPlaylist.id}`}));console.log("current",Oy(t.playlistSongs).map(i=>i.id)),console.log("add playlist songs",n.map(i=>i.id)),t.playlistSongs.push(...r),t.currentPlaylist.song_ids.push(...n.map(i=>i.id))},setPlaylistSongs(t,e){const{songs:n}=e.payload;t.playlistSongs=n},removeSong(t,e){const{index:n}=e.payload;t.playlistSongs.splice(n,1)},setPlaylistSongsAndUpdateCurrent(t,e){const{songs:n}=e.payload;console.log("current",Oy(t.playlistSongs).map(r=>r.id)),console.log("set playlist songs",n.map(r=>r.id)),t.playlistSongs=n,t.currentPlaylist.song_ids=n.map(r=>r.id)},resetCurrentPlaylist:t=>{t.currentPlaylist=bg.currentPlaylist,t.playlistSongs=bg.playlistSongs}}}),wi=t=>t.currentPlaylist,{addSongsAndUpdateCurrent:cG,removeSong:YQ,setCurrentPlaylist:uG,updateCurrentPlaylist:Jl,resetCurrentPlaylist:X1,setPlaylistSongs:wb,setPlaylistSongsAndUpdateCurrent:_b}=$P.actions,dG=$P.reducer;function Io(){const t=We(),{user:e}=mt(),{currentPlaylist:n,playlistSongs:r}=Q(wi),{currentSong:i}=Q(Ae),{userPlaylists:s,updateUserPlaylist:o,setUserPlaylists:a}=ot(),[l,c]=f.useState(!1),{setErrorToast:d,setSuccessToast:h}=xn(),m=vn(),p=async S=>{await Jn({collection:"playlist",data:S,id:S.id,msg:">>> api: set playlist doc"}),o(S)},y=async S=>{if(!e)throw new Error("user not found");if(!S)throw new Error("playlist name invalid");const T=dx(S),b=fx({id:T,by:e.email,name:S});c(!0);const k=[...s,b];await Jn({collection:"playlist",data:b,id:T,msg:">>> api: set playlist doc"}),await xb(k,e),a(k),c(!1)},x=async()=>{if(!e)return;c(!0);const S=s.filter(T=>T.id!==n.id);await Hc({collection:"playlist",id:n.id,msg:">>> api: delete playlist doc"}),await xb(S,e),a(S),t(X1()),i.song_in===`playlist_${n.id}`&&t(uo()),c(!1),m("/mysongs")},E=async S=>{c(!0);const T={...n};if(T.song_ids=[...n.song_ids,...S.map(b=>b.id)],await p(T),console.log(">>> playlist songs",r.length),t(cG({songs:S})),i.song_in===`playlist_${n.id}`){const b=S.map(k=>({...k,song_in:`playlist_${n.id}`}));t(K1({songs:b}))}c(!1),h({message:`${S.length} songs added`})},v=async(S,T)=>{try{c(!0);const b={...T,name:S};await p(b),t(Jl(b)),h({message:"Playlist edited"})}catch(b){throw console.log(b),new Error("Error when edit playlist")}finally{c(!1)}},g=async(S,T)=>{try{c(!0);const b=[...T.song_ids,S.id],k={...T};k.song_ids=b,T.id===n.id&&t(Jl({song_ids:b})),await p(k)}catch(b){throw console.log({message:b}),new Error("Error when edit playlist")}finally{c(!1)}},w=async S=>{c(!0);const T=r.filter(k=>k.id!==S.id);console.log("delete songs",r.map(k=>k.id),T.map(k=>k.id));const b={...n};b.song_ids=T.map(k=>k.id),await p(b),t(_b({songs:T})),c(!1),h({message:`'${S.name}' removed`})};return{isFetching:l,addPlaylist:y,editPlaylist:v,deletePlaylist:x,addSongsToPlaylist:E,deleteSongsFromPlaylist:async S=>{if(console.log("playlist action deleteManyFromPlaylist"),!n.song_ids)throw console.log("Wrong playlist data"),d({}),new Error("Wrong playlist data");if(S.length===1)return w(S[0]);const T=S.map(R=>R.id),b=r.filter(R=>!T.includes(R.id)),k={...n};return k.song_ids=b.map(R=>R.id),c(!0),await p(k),t(_b({songs:b})),c(!1),h({message:`${S.length} songs removed`}),b},deleteSongFromPlaylist:w,addSongToPlaylistSongItem:g,setPlaylistDocAndUpdateUserPlaylist:p}}function hG({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{fillRule:"evenodd",d:"M10 17a.75.75 0 01-.75-.75V5.612L5.29 9.77a.75.75 0 01-1.08-1.04l5.25-5.5a.75.75 0 011.08 0l5.25 5.5a.75.75 0 11-1.08 1.04l-3.96-4.158V16.25A.75.75 0 0110 17z",clipRule:"evenodd"}))}const fG=f.forwardRef(hG),mG=fG;function pG({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{fillRule:"evenodd",d:"M2 4.75A.75.75 0 012.75 4h14.5a.75.75 0 010 1.5H2.75A.75.75 0 012 4.75zM2 10a.75.75 0 01.75-.75h14.5a.75.75 0 010 1.5H2.75A.75.75 0 012 10zm0 5.25a.75.75 0 01.75-.75h14.5a.75.75 0 010 1.5H2.75a.75.75 0 01-.75-.75z",clipRule:"evenodd"}))}const gG=f.forwardRef(pG),yG=gG;function vG({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{fillRule:"evenodd",d:"M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.05-.143z",clipRule:"evenodd"}))}const xG=f.forwardRef(vG),$y=xG;function wG({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{fillRule:"evenodd",d:"M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z",clipRule:"evenodd"}))}const _G=f.forwardRef(wG),EG=_G;function SG({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{fillRule:"evenodd",d:"M12.79 5.23a.75.75 0 01-.02 1.06L8.832 10l3.938 3.71a.75.75 0 11-1.04 1.08l-4.5-4.25a.75.75 0 010-1.08l4.5-4.25a.75.75 0 011.06.02z",clipRule:"evenodd"}))}const bG=f.forwardRef(SG),zP=bG;function kG({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{fillRule:"evenodd",d:"M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z",clipRule:"evenodd"}))}const TG=f.forwardRef(kG),IG=TG;function CG({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{fillRule:"evenodd",d:"M7.84 1.804A1 1 0 018.82 1h2.36a1 1 0 01.98.804l.331 1.652a6.993 6.993 0 011.929 1.115l1.598-.54a1 1 0 011.186.447l1.18 2.044a1 1 0 01-.205 1.251l-1.267 1.113a7.047 7.047 0 010 2.228l1.267 1.113a1 1 0 01.206 1.25l-1.18 2.045a1 1 0 01-1.187.447l-1.598-.54a6.993 6.993 0 01-1.929 1.115l-.33 1.652a1 1 0 01-.98.804H8.82a1 1 0 01-.98-.804l-.331-1.652a6.993 6.993 0 01-1.929-1.115l-1.598.54a1 1 0 01-1.186-.447l-1.18-2.044a1 1 0 01.205-1.251l1.267-1.114a7.05 7.05 0 010-2.227L1.821 7.773a1 1 0 01-.206-1.25l1.18-2.045a1 1 0 011.187-.447l1.598.54A6.993 6.993 0 017.51 3.456l.33-1.652zM10 13a3 3 0 100-6 3 3 0 000 6z",clipRule:"evenodd"}))}const AG=f.forwardRef(CG),RG=AG;function PG({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{fillRule:"evenodd",d:"M4.5 2A1.5 1.5 0 003 3.5v13A1.5 1.5 0 004.5 18h11a1.5 1.5 0 001.5-1.5V7.621a1.5 1.5 0 00-.44-1.06l-4.12-4.122A1.5 1.5 0 0011.378 2H4.5zm2.25 8.5a.75.75 0 000 1.5h6.5a.75.75 0 000-1.5h-6.5zm0 3a.75.75 0 000 1.5h6.5a.75.75 0 000-1.5h-6.5z",clipRule:"evenodd"}))}const NG=f.forwardRef(PG),DG=NG;function jG({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{d:"M10.75 4.75a.75.75 0 00-1.5 0v4.5h-4.5a.75.75 0 000 1.5h4.5v4.5a.75.75 0 001.5 0v-4.5h4.5a.75.75 0 000-1.5h-4.5v-4.5z"}))}const OG=f.forwardRef(jG),MG=OG;function LG({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{d:"M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"}))}const FG=f.forwardRef(LG),$G=FG;function _s({close:t,title:e}){return u.jsxs("div",{className:"flex justify-between mb-3",children:[u.jsx("div",{className:"text-xl leading-[2.2] font-playwriteCU",children:e}),u.jsx("button",{onClick:t,children:u.jsx($G,{className:"w-7"})})]})}function zG({closeModal:t,playlistSongs:e}){const{theme:n}=te(),{selectedSongs:r}=ru(),{userSongs:i}=ot(),{addSongsToPlaylist:s,isFetching:o}=Io(),a={addSongContainer:"pb-[40px] relative",addSongContent:"max-h-[calc(60vh)] w-[700px] max-w-[80vw] overflow-auto"},l=f.useMemo(()=>!!r.length,[r]),c=async()=>{try{if(!r.length)return;await s(r)}catch(d){console.log({message:d})}finally{close()}};return u.jsxs("div",{className:a.addSongContainer,children:[u.jsx(_s,{close:t,title:"Add song to playlist"}),u.jsxs("div",{className:a.addSongContent,children:[u.jsxs(X,{onClick:c,variant:"primary",isLoading:o,className:`rounded-full ${n.content_bg} absolute bottom-0 right-[15px] min-w-[34px] h-[32px] ${!l&&"disable"}`,children:["Add",`${r.length?` (${r.length})`:""}`]}),i.length?i.map((d,h)=>{if(e.findIndex(p=>p.id===d.id)===-1)return u.jsx(TI,{song:d,variant:"select",theme:n},h)}):u.jsx("p",{children:"No song jet..."})]})]})}function BP({children:t,active:e,done:n,inUpload:r,className:i,scrollBehavior:s}){const o=f.useRef(null),a=()=>{const l=o.current;l&&(l.scrollIntoView({behavior:s.current,block:"center"}),s.current==="instant"&&(s.current="smooth"))};return f.useEffect(()=>{e&&a()},[e]),u.jsxs("p",{ref:o,className:`lyric ${i&&i} ${r?"text-[16px]":""}  select-none  max-[549px]:text-center font-bold ${n&&"opacity-40"} ${r?"flex":""} ${e&&!r?"text-[#ffed00]":""}`,children:[t,r&&e&&u.jsx("span",{className:"ml-[10px] text-[16px]"})]})}const BG=()=>{const t=si();return{playStatus:{isError:!1,isPlaying:!1,isWaiting:!1,lyricSize:t.lyricSize||"medium",isLoaded:!0,isRepeat:t.isRepeat||"no",isShuffle:t.isShuffle||!1,isCrossFade:t.isCrossFade||!1,songBackground:t.songBackground||!1,songImage:t.songImage||!1}}},VP=Xm({name:"playStatus",initialState:()=>BG(),reducers:{setPlayStatus(t,e){t.playStatus={...t.playStatus,...e.payload}},togglePlayControl(t,e){const{variant:n}=e.payload;switch(n){default:if(typeof t.playStatus[n]=="boolean"){const r=!t.playStatus[n];t.playStatus[n]=r,tn(n,r)}}}}}),Un=t=>t.playStatus,{setPlayStatus:or,togglePlayControl:Eb}=VP.actions,VG=VP.reducer;function UG({handlePlayPause:t}){const{playStatus:{isError:e,isPlaying:n,isWaiting:r}}=Q(Un),{currentSong:i}=Q(Ae),s=f.useMemo(()=>r?u.jsx(Js,{className:"w-10 animate-spin"}):e&&i.name?u.jsx(Hv,{className:"w-10"}):n?u.jsx(qv,{className:"w-10"}):u.jsx(Gv,{className:"w-10"}),[r,e,n,i]);return u.jsx(u.Fragment,{children:u.jsx("button",{className:`p-1 ${r&&"pointer-events-none"} inline-flex items-center justify-center`,onClick:()=>t(),children:s})})}const Sb=f.memo(UG);function UP({bgRef:t,currentSong:e}){const{playStatus:{songBackground:n}}=Q(Un);f.useEffect(()=>{if(n&&e.image_url){const r=t.current;r&&(r.style.backgroundImage=`url(${e.image_url})`)}},[e,n]),f.useEffect(()=>{if(!n){const r=t.current;r&&(r.style.backgroundImage="none")}},[n])}function WG({audioEle:t,isOpenFullScreen:e}){const{currentSong:n}=Q(Ae),{playStatus:{isError:r}}=Q(Un),[i,s]=f.useState({id:"",base:"",real_time:[]}),[o,a]=f.useState(!1),[l,c]=f.useState(!1),d=f.useRef(),h=async()=>{a(!0);try{const p=await Ba({collection:"lyrics",id:n.lyric_id,msg:">>> api: get lyric doc"});if(p.exists()){const y=p.data();s(y)}}catch{console.log("[error] get lyric error")}finally{a(!1)}},m=()=>{clearTimeout(d.current),c(!1),a(!0),s({base:"",real_time:[],id:""})};return f.useEffect(()=>{const p=async()=>{console.log("song loaded"),c(!0)};return t&&t.addEventListener("loadeddata",p),()=>{t&&t.removeEventListener("loadeddata",p)}},[]),f.useEffect(()=>{if(!n.lyric_id&&l){a(!1);return}i.real_time.length||l&&e&&(d.current=setTimeout(()=>{h()},500))},[l,e]),f.useEffect(()=>{if(r){a(!1);return}return()=>{m()}},[n,r]),{songLyric:i,loading:o}}const WP=(t,e)=>{const[n,r]=f.useState(()=>JSON.parse(localStorage.getItem("HD-MP3")||"{}")[t]||e);return f.useEffect(()=>{const i=JSON.parse(localStorage.getItem("HD-MP3")||"{}");i[t]=n,localStorage.setItem("HD-MP3",JSON.stringify(i))},[n]),[n,r]};function HG(){const t=We(),{currentPlaylist:e,playlistSongs:n}=Q(wi),r=jf(),{setErrorToast:i}=xn(),s=f.useRef(!1),[o,a]=f.useState(!0),l=async()=>{if(!r.id)throw new Error("invalid playlist id");const h=await Ba({collection:"playlist",id:r.id,msg:">>> api get playlist"});if(h.exists())return h.data()},c=async h=>{if(!h.song_ids.length)return[];console.log(">>> api: get playlist songs",h.song_ids);const m=km(To,"songs"),p=sl(m,ol("id","in",h.song_ids)),y=await al(p);return y.docs.length?y.docs.map(E=>({...E.data(),song_in:`playlist_${h.id}`})):(h.song_ids.length&&i({}),[])},d=async()=>{try{if(!r.id)throw new Error("invalid playlist id");let h;const m=e.id===r.id;if(a(!0),m?h=e:h=await l(),!h)throw new Error("playlist not found");const p=await c(h);m||t(uG({playlist:h,songs:p})),t(wb({songs:p}))}catch(h){console.log({message:h}),i({})}finally{a(!1)}};return f.useEffect(()=>{s.current||(s.current=!0,console.log("run init"),d())},[]),{isFetching:o,setPlaylistSongs:wb,playlistSongs:n,currentPlaylist:e}}function qG(){const t=We(),{currentPlaylist:e}=Q(wi),{isFetching:n,playlistSongs:r}=HG(),i=async()=>{const o=r.find(l=>l.image_url);if(!o||e.image_url&&e.image_url===o.image_url)return;const a={...e,image_url:o.image_url,blurhash_encode:o.blurhash_encode||""};await Jn({collection:"playlist",id:e.id,data:a,msg:">>> api: update playlist doc"}),t(Jl({image_url:o.image_url}))},s=async()=>{if(console.log(e.song_ids.length,r.length),!e.song_ids.length){if(e.image_url){const l={...e,image_url:"",blurhash_encode:""};await Jn({collection:"playlist",id:e.id,data:l,msg:">>> api: update playlist doc"})}t(Jl({image_url:"",blurhash_encode:""}));return}if(e.song_ids.length===r.length)return;const o=r.map(l=>l.id),a={...e,song_ids:o};await Jn({collection:"playlist",id:e.id,data:a,msg:">>> api: update playlist doc"}),t(Jl({song_ids:o}))};return f.useEffect(()=>{n||!r.length||!e||i()},[r,n]),f.useEffect(()=>{n||e&&s()},[n]),{playlistSongs:r,loading:n}}const HP=()=>{window.dispatchEvent(new Event("mousemove"))},qP=(t,e,n=!1)=>{const r=window.innerWidth;if(!t||!e){console.log("ele not found");return}const s=t.getBoundingClientRect().left,o=r-(s+t.offsetWidth),a=Math.abs(Math.ceil(s-o))/2;if(a<5)return!1;n&&(e.onscroll=()=>{},setTimeout(()=>{e.onscroll=HP},900)),n||Math.abs(s)>r||Math.abs(o)>r?e.style.scrollBehavior="auto":e.style.scrollBehavior="smooth";let l=e.scrollLeft;return o>s?setTimeout(()=>{e.scrollLeft=l-a},300):o<s&&setTimeout(()=>{e.scrollLeft=l+a},300),!0};function GG({containerRef:t,songItemRef:e,isOpenFullScreen:n,idle:r}){const{currentSong:i}=Q(Ae),s=()=>{const o=e==null?void 0:e.current,a=t==null?void 0:t.current;qP(o,a,r)};f.useEffect(()=>{if(n){if(!scroll||!(t!=null&&t.current)||!(e!=null&&e.current)){console.log("lack props");return}i.name&&n&&s()}},[i,n]),f.useEffect(()=>{const o=t==null?void 0:t.current;if(o)return o.onscroll=HP,()=>{o.onscroll=()=>{}}},[])}function KG({textRef:t,textWrapperRef:e,content:n}){const r=f.useRef(),i=f.useRef(),s=f.useRef(!1),o=f.useRef(0),a=f.useRef(0),l=f.useRef(0),c=()=>{t.current&&(t.current.style.transition="none",t.current.style.transform="translateX(0)")},d=()=>{t.current&&(t.current.style.transition=`transform linear ${a.current}s`,t.current.style.transform=`translateX(-${l.current}px)`,i.current=setTimeout(c,a.current*1e3))},h=()=>{!t.current||!e.current||(l.current=t.current.offsetWidth-o.current,a.current=Math.ceil(l.current/35))},m=()=>{!s.current||!t.current||!e.current||(a.current=0,l.current=0,s.current=!1,clearInterval(r.current),clearTimeout(i.current),e.current.classList.remove("mask-image-horizontal"),c())},p=()=>{!t.current||!e.current||!n||!(t.current.offsetWidth>e.current.offsetWidth)||(s.current=!0,e.current.classList.add("mask-image-horizontal"),o.current=t.current.clientWidth,t.current.innerHTML=t.current.innerText+"&nbsp; &nbsp; &nbsp;"+t.current.innerText,h(),setTimeout(d,1e3),r.current=setInterval(d,a.current*1e3+3e3))};f.useEffect(()=>(p(),m),[n])}const XG=({song:t,closeModal:e,setIsOpenPopup:n})=>{const r=We(),{setErrorToast:i,setSuccessToast:s}=xn(),{currentSong:o}=Q(Ae),{userSongs:a,setUserSongs:l}=ot(),[c,d]=f.useState(!1),{addSongToPlaylistSongItem:h,deleteSongFromPlaylist:m}=Io();return{updateAndSetUserSongs:f.useCallback(async({song:g})=>{let w=[...a];const _=w.indexOf(g);w.splice(_,1);const S=w.map(T=>T.id);if(w.length!==a.length)return l(w),S},[a]),handleDeleteSong:async()=>{try{d(!0);let g=[...a];const w=g.indexOf(t);g.splice(w,1),await FP(t),l(g),o.id===t.id&&r(uo()),s({message:`'${t.name}' deleted`})}catch(g){throw console.log({message:g}),new Error("Error when delete song")}finally{d(!1),e()}},handleAddSongToPlaylistMobile:async g=>{try{d(!0),await h(t,g),s({message:`'${t.name}' added to '${g.name}'`})}catch(w){throw console.log(w),new Error("Error when add song to playlist")}finally{d(!1),e()}},handleRemoveSongFromPlaylist:async()=>{try{d(!0),await m(t)}catch(g){throw console.log({message:g}),new Error("Error when remove song from playlist")}finally{d(!1),n(!1)}},handleAddSongToPlaylist:async g=>{if(!t||!g){i({message:"Lack of props"});return}try{d(!0),await h(t,g),s({message:`'${t.name}' added to '${g.name}'`})}catch(w){throw console.log(w),new Error("Error when add song to playlist")}finally{d(!1),n(!1)}},loading:c}},zs={isDev:!0,focusDelay:3e3,scrollSongDelay:4e3,loadingDuration:200},GP=km(To,"songs"),KP=km(To,"playlist"),QG=async()=>{const t=sl(GP,ol("by","==","admin")),e=await al(t);if(e.docs)return e.docs.map(r=>({...r.data(),song_in:"admin"}))},YG=async()=>{const t=sl(KP,ol("by","==","admin")),e=await al(t);if(e.docs)return e.docs.map(r=>r.data())},JG=async t=>{const e=sl(KP,ol("by","==",t.email)),n=await al(e);if(n.docs.length)return n.docs.map(i=>i.data())},ZG=async t=>{const e=sl(GP,ol("by","==",t.email)),n=await al(e);if(n.docs.length)return n.docs.map(i=>({...i.data(),song_in:"user"}))},eK=async t=>{const e={userSongs:[],userPlaylists:[]},n=await ZG(t);n!=null&&n.length&&(e.userSongs=n);const r=await JG(t);return r!=null&&r.length&&(e.userPlaylists=r),e},tK=[{song_file_path:"songs/huudat01234560_cloud9-itrotobu-3522118.mpga",size:4300,song_in:"admin",lyric_id:"",singer:"Itro, Tobu",image_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/images%2Fcloud9_5smE_admin_stock?alt=media&token=cd1f3afe-0c29-462f-ad17-b28b95b6e903",song_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/songs%2Fhuudat01234560_cloud9-itrotobu-3522118.mpga?alt=media&token=2184079b-1183-4d89-ab40-792ce60f9db5",image_file_path:"images/cloud9_5smE_admin_stock",id:"cloud9_5smE_admin",duration:276,blurhash_encode:"U9L;1{%200t600xaXNxt0JR*?ExZ01R*~AoL",name:"Cloud 9",by:"admin"},{song_in:"admin",blurhash_encode:"UF9QO,sSImR$N+kDjroMDzkEt9oh=}WARka#",duration:172,image_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/images%2Fcreepextended_5T-X_admin_stock?alt=media&token=1aa0e0e5-0371-400e-a3c9-3d091c3e138c",singer:"GAMPER & DADONI",song_file_path:"songs/huudat01234560_creepextended-gamperdadoni-8177347(mp3cut.net).mp3",name:"Creep",id:"creepextended_5T-X_admin",lyric_id:"creepextended_5T-X_admin",song_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/songs%2Fhuudat01234560_creepextended-gamperdadoni-8177347(mp3cut.net).mp3?alt=media&token=afbbff42-29de-4509-84c4-f8c1d8b55c0a",by:"admin",image_file_path:"images/creepextended_5T-X_admin_stock",size:2910},{by:"admin",size:3230,duration:207,image_file_path:"",id:"diviners_exqv_admin",lyric_id:"",name:"Diviners",song_in:"admin",song_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/songs%2Fhuudat01234560_diviners-savannahphillyk-4271809.mpga?alt=media&token=0a2bab43-8fe1-42fe-9991-3d798f4bd46e",song_file_path:"songs/huudat01234560_diviners-savannahphillyk-4271809.mpga",singer:"Savannah, Philly K",image_url:"",blurhash_encode:""},{image_file_path:"",song_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/songs%2Fhuudat01234560_gizmo-syncole-6046197.mpga?alt=media&token=eed274e0-5716-47fc-a020-872a14c2fa6d",singer:"Syn Cole",blurhash_encode:"",name:"Gizmo",by:"admin",image_url:"",size:3007,song_file_path:"songs/huudat01234560_gizmo-syncole-6046197.mpga",lyric_id:"",id:"gizmo_VMF2_admin",duration:191,song_in:"admin"},{id:"goodtimeowlcitycarlyraejepsen49b6mpga_vxSV_admin",blurhash_encode:"UID9|+tR%MM{?^-pt7RjyDV@e.WB00IoWBof",song_file_path:"songs/huudat01234560_goodtime-owlcity-carlyraejepsen_49b6.mpga",singer:"OwlCity, CarlyRaeJepsen",song_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/songs%2Fhuudat01234560_goodtime-owlcity-carlyraejepsen_49b6.mpga?alt=media&token=0fd9fd15-5f09-4e95-a101-32c648827723",by:"admin",duration:208,image_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/images%2Fgoodtimeowlcitycarlyraejepsen49b6mpga_vxSV_admin_stock?alt=media&token=55478c10-9a5e-4b02-a0e3-d9cf53136f51",song_in:"admin",lyric_id:"goodtimeowlcitycarlyraejepsen49b6mpga_vxSV_admin",image_file_path:"images/goodtimeowlcitycarlyraejepsen49b6mpga_vxSV_admin_stock",size:3235,name:"GoodTime"},{image_file_path:"images/heybrother_-8jG_admin_stock",by:"admin",size:3987,singer:"Avicii",duration:256,lyric_id:"heybrother_-8jG_admin",name:"Hey Brother",song_file_path:"songs/huudat01234560_heybrother-avicii-3044424.mpga",song_in:"admin",song_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/songs%2Fhuudat01234560_heybrother-avicii-3044424.mpga?alt=media&token=dba0759f-6762-47f4-9899-d6494a6fab15",blurhash_encode:"U98#7;X7Ntbb00oyt7oz~qWBoLbG00oLjZof",image_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/images%2Fheybrother_-8jG_admin_stock?alt=media&token=bbbc1aa3-7f52-4d60-9773-2f3f7818cd01",id:"heybrother_-8jG_admin"},{song_in:"admin",lyric_id:"",image_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/images%2Fhope_AI6Q_admin_stock?alt=media&token=9f282ea4-69c7-42f2-bba3-a232c9e7e194",song_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/songs%2Fhuudat01234560_hope-tobu-3117457.mpga?alt=media&token=e1bfc470-a344-4505-b177-4ef96991b3fc",image_file_path:"images/hope_AI6Q_admin_stock",singer:"Tobu",duration:289,name:"Hope",by:"admin",size:4506,song_file_path:"songs/huudat01234560_hope-tobu-3117457.mpga",id:"hope_AI6Q_admin",blurhash_encode:"UEBiHzyG00sVt:VWaioy00Mz^~WVIXtQnhRj"},{duration:220,image_file_path:"images/itaintme_8IYS_admin_stock",lyric_id:"itaintme_8IYS_admin",name:"It Ain't Me",image_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/images%2Fitaintme_8IYS_admin_stock?alt=media&token=023ee525-6d9e-44ce-90b7-60b88c08a505",singer:"Kygo,Selena Gomez",size:3664,song_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/songs%2Fhuudat01234560_itaintme-kygoselenagomez-5817724.mpga?alt=media&token=4328f6fc-3b04-490b-a37e-00c9ce8718d8",id:"itaintme_8IYS_admin",by:"admin",song_file_path:"songs/huudat01234560_itaintme-kygoselenagomez-5817724.mpga",blurhash_encode:"U26Qe$KN5i}Y0|IpxH^j0x^P-W0zn7S_OTE2",song_in:"admin"},{id:"lethergo_QrJg_admin",image_file_path:"images/lethergo_QrJg_admin_stock",by:"admin",song_in:"admin",song_file_path:"songs/huudat01234560_lethergo-passenger-3719556.mpga",image_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/images%2Flethergo_QrJg_admin_stock?alt=media&token=11c785b1-534f-4314-882e-9599b0dec8e4",size:3892,duration:250,blurhash_encode:"URBND:-;xZRSt:bxS4ja07E7NItPqtn4nQbb",song_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/songs%2Fhuudat01234560_lethergo-passenger-3719556.mpga?alt=media&token=7cbaf060-cc4f-4970-9967-5876943a7ced",lyric_id:"lethergo_QrJg_admin",singer:"Passenger",name:"Let Her Go"},{singer:"Alec Benjamin",song_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/songs%2Fhuudat01234560_letmedownslowly-alecbenjamin-6360069.mpga?alt=media&token=966e502f-6f95-4615-a961-08a95f5bab43",by:"admin",song_in:"admin",duration:170,image_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/images%2Fletmedownslowly_KFip_admin_stock?alt=media&token=f6c875c3-335b-4195-abea-e8d065c0d50b",blurhash_encode:"UhK,EXv|-VNG}@V@RPbcNZo#I;WqxCWBN{jY",lyric_id:"letmedownslowly_KFip_admin",size:2883,name:"Let Me Down Slowly",id:"letmedownslowly_KFip_admin",song_file_path:"songs/huudat01234560_letmedownslowly-alecbenjamin-6360069.mpga",image_file_path:"images/letmedownslowly_KFip_admin_stock"},{singer:"Lost Sky, ft. Sara Skinner",name:"Dreams ",song_in:"admin",image_file_path:"images/lostskydreamsptiifeatsaraskinner_RXI2_admin_stock",by:"admin",size:3600,blurhash_encode:"UHD%%%JoF^Jm|wNcE#a#J--BNtxF1ubF,Wwd",image_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/images%2Flostskydreamsptiifeatsaraskinner_RXI2_admin_stock?alt=media&token=0dc0a53a-e457-4bda-b4cd-ac71e1852145",song_file_path:"songs/huudat01234560_p4fh9nm1y1.mpga",lyric_id:"",id:"lostskydreamsptiifeatsaraskinner_RXI2_admin",song_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/songs%2Fhuudat01234560_p4fh9nm1y1.mpga?alt=media&token=f7a7ad35-e4d2-4387-8319-2688fabd9282",duration:216},{name:"Perfect",song_in:"admin",blurhash_encode:"UY9,tJRQyZRQn-V[oJWBpKaeROkBbIWBfikB",song_file_path:"songs/huudat01234560_perfect-edsheeran-5208784.mpga",id:"perfectedsheeran5208784mpga_wOSF_admin",duration:264,image_file_path:"images/perfectedsheeran5208784mpga_wOSF_admin_stock",size:4117,song_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/songs%2Fhuudat01234560_perfect-edsheeran-5208784.mpga?alt=media&token=3c953332-727a-4846-aace-93a18882de2b",lyric_id:"perfectedsheeran5208784mpga_wOSF_admin",image_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/images%2Fperfectedsheeran5208784mpga_wOSF_admin_stock?alt=media&token=11e8ee8b-5c3e-426c-8301-3ac87451654a",by:"admin",singer:"EdSheeran"},{image_file_path:"images/stealmygirl_nhcW_admin_stock",lyric_id:"stealmygirl_nhcW_admin",song_in:"admin",name:"Steal My Girl",blurhash_encode:"UOHw}rNaVYae_Nt7R+M|^*RjWBoLofofs:WB",singer:"One Direction",image_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/images%2Fstealmygirl_nhcW_admin_stock?alt=media&token=c4a6cc9b-c92c-497b-a76f-a557d1647bc7",song_file_path:"songs/huudat01234560_stealmygirl-onedirection-5434790.mpga",size:3772,by:"admin",duration:227,id:"stealmygirl_nhcW_admin",song_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/songs%2Fhuudat01234560_stealmygirl-onedirection-5434790.mpga?alt=media&token=41b6f6b9-5961-42bd-a7e3-d5764ba4dcae"},{song_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/songs%2Fhuudat01234560_sugar--3330663.mpga?alt=media&token=c7fe9b02-a189-4721-9ed9-ebd96618f291",by:"admin",blurhash_encode:"UkE{P7jFNwf6T#WVsTbHxcjZoLjZO=bIWWbH",image_file_path:"images/sugar_H5zA_admin_stock",song_file_path:"songs/huudat01234560_sugar--3330663.mpga",id:"sugar_H5zA_admin",singer:"Maroon 5",lyric_id:"sugar_H5zA_admin",size:3681,name:"Sugar",duration:236,image_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/images%2Fsugar_H5zA_admin_stock?alt=media&token=833833b1-d54d-4c50-8f24-e290de179191",song_in:"admin"},{singer:"Consoul Trainin",image_file_path:"images/takemetoinfinityconsoultrainin_Nkiw_admin_stock",song_in:"admin",song_file_path:"songs/huudat01234560_takemetoinfinity-consoultrainin-4723303.mpga",image_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/images%2Ftakemetoinfinityconsoultrainin_Nkiw_admin_stock?alt=media&token=04ecc734-f3fc-4b0d-b08b-456b29fd4c55",lyric_id:"takemetoinfinityconsoultrainin_Nkiw_admin",duration:208,by:"admin",song_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/songs%2Fhuudat01234560_takemetoinfinity-consoultrainin-4723303.mpga?alt=media&token=045f8984-8de7-4baa-9414-23386de5e0f9",name:"Take Me To Infinity",blurhash_encode:"UBDy@My5yqsE8|OlO9og.ivVm-kpKZWYizaK",size:3248,id:"takemetoinfinityconsoultrainin_Nkiw_admin"},{image_file_path:"images/thecalling_eRwo_admin_stock",song_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/songs%2Fhuudat01234560_thecalling-thefatratlaurabrehm-4391253.mpga?alt=media&token=779e3253-e60d-46d3-9a3f-f924752178f4",lyric_id:"",song_file_path:"songs/huudat01234560_thecalling-thefatratlaurabrehm-4391253.mpga",id:"thecalling_eRwo_admin",blurhash_encode:"UKE3b*WrDiMx00n#t7t7~WWCbbo#OHjFRPRj",image_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/images%2Fthecalling_eRwo_admin_stock?alt=media&token=97909f54-8b4a-422a-84e9-4a1724ba0bd8",singer:"TheFatRat, Laura Brehm",duration:234,name:"The Calling",song_in:"admin",size:3651,by:"admin"},{image_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/images%2Ftimber_NNe3_admin_stock?alt=media&token=dd80433d-dd6c-4cab-999b-7a66ac64d907",lyric_id:"timber_NNe3_admin",blurhash_encode:"ULNTg+XT00D*~WE2xat8D*WBIAM|~XxuIUax",id:"timber_NNe3_admin",duration:204,song_in:"admin",image_file_path:"images/timber_NNe3_admin_stock",name:"Timber",size:3265,singer:"Pitbull feat. Ke",by:"admin",song_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/songs%2Fhuudat01234560_timber-pitbullfeatkeha-6629607.mpga?alt=media&token=09e07118-f611-41d1-8ad1-d97a353dd2a8",song_file_path:"songs/huudat01234560_timber-pitbullfeatkeha-6629607.mpga"},{image_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/images%2Fyoui_DhYr_admin_stock?alt=media&token=ae005e9b-21d4-4c40-839d-a75fe81f6504",size:3954,singer:"One Direction",duration:238,song_file_path:"songs/huudat01234560_youi-onedirection-8438574.mpga",song_in:"admin",by:"admin",name:"You & I",song_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/songs%2Fhuudat01234560_youi-onedirection-8438574.mpga?alt=media&token=707a3005-6630-4f62-a8ed-96cc0895159f",id:"youi_DhYr_admin",image_file_path:"images/youi_DhYr_admin_stock",lyric_id:"youi_DhYr_admin",blurhash_encode:"UeI;|=M{JPs-?wn%a1WB%hsTs:bHMyt7R*ni"}],nK=[{image_url:"https://firebasestorage.googleapis.com/v0/b/zingmp3-clone-61799.appspot.com/o/images%2Fcloud9_5smE_admin_stock?alt=media&token=cd1f3afe-0c29-462f-ad17-b28b95b6e903",name:"NCS",by:"admin",id:"test_RVt4_admin",blurhash_encode:"U9L;1{%200t600xaXNxt0JR*?ExZ01R*~AoL",song_ids:["hope_AI6Q_admin","thecalling_eRwo_admin","lostskydreamsptiifeatsaraskinner_RXI2_admin","cloud9_5smE_admin","diviners_exqv_admin"]}];function Jm({admin:t}){const{setErrorToast:e}=xn(),{user:n,loading:r}=mt(),{initial:i,initSongsContext:s}=ot(),[o,a]=f.useState(""),[l,c]=f.useState(!0),d=m=>{c(!1),a(m),e({message:"Use song error"})},h=async()=>{try{if(zs.isDev){await Nh(zs.loadingDuration),s({adminSongs:tK,adminPlaylists:nK});return}const m=await QG(),p=await YG();if(console.log("check admin songs",m),console.log("check admin playlists",p),t){s({userSongs:m,userPlaylists:p}),console.log("admin",p,m),c(!1);return}if(!n)await Nh(zs.loadingDuration),s({adminSongs:m,adminPlaylists:p});else{const y=await eK(n);s({...y,adminSongs:m,adminPlaylists:p})}}catch(m){console.log({message:m}),d("init song error")}finally{c(!1)}};return f.useEffect(()=>{if(r)return c(!0);if(i){console.log("Already init"),setTimeout(()=>c(!1),zs.loadingDuration);return}else{h();return}},[r]),{initial:i,loading:l,errorMsg:o,initSongsAndPlaylists:h}}function rK({admin:t,inputRef:e}){const{user:n}=mt(),{isDev:r}=te(),{userSongs:i,addUserSongs:s}=ot(),{currentSong:o}=Q(Ae),{setTempSongs:a,tempSongs:l,clearTempSongs:c,shiftSong:d,status:h}=Ym(),m=f.useRef([]),p=f.useRef([]),y=f.useRef(!1),{setErrorToast:x,setSuccessToast:E,setToasts:v}=xn(),g=_=>{if(!e.current)return;const S=e.current;S&&(S.value="",p.current=[]),c(_)},w=f.useCallback(async _=>{if(!n)return x({message:"Missing user data"});c("uploading");const T=_.target.files;if(!T.length){c("finish");return}let b=hx({by:t?"admin":n.email,song_in:t?"admin":"user"}),k=[];const R=Date.now(),P=O=>i.some(W=>W.singer===O.singer&&W.name===O.name&&W.size===O.size)||k.some(W=>W.singer===O.singer&&W.name===O.name&&W.size===O.size);try{let O;for(O=0;O<=T.length-1;O++){const L=T[O],z=await MF(L);if(!z){x({message:"Error when parser song"}),g("finish-error");return}let H={...b,name:z.name,singer:z.singer,duration:Math.floor(z.duration),size:Math.floor(L.size/1024)};if(P(H)){console.log(">>>duplicate"),y.current=!0,m.current.push(H);continue}k.push(H),p.current=[...p.current,O]}if(i.length+p.current.length>5&&n.role!=="ADMIN"){g("finish-error"),x({message:"You have reach the upload limit"});return}if(!k.length){y.current=!1,g("finish-error"),x({message:"Duplicate song"});return}a(k);for(let L=0;L<p.current.length;L++){const z=p.current[L];let H=dx(k[L].name);t&&(H+="_admin");const K={...k[L]},{filePath:fe,fileURL:I}=await LP({file:T[z],folder:"/songs/",email:n.email,msg:">>> api: upload song file"});Object.assign(K,{id:H,song_file_path:fe,song_url:I}),await Jn({collection:"songs",data:K,id:K.id,msg:">>> api: set song doc"}),s([K]),d(),r&&console.log(K.name,"uploaded")}p.current=[],y.current?(g("finish-error"),v(L=>[...L,{id:Rh(4),title:"warning",desc:"Song duplicate"}])):(g("finish"),E({message:`${k.length} songs uploaded`}));const W=Date.now();r&&console.log(">>> upload songs finished after",(W-R)/1e3);return}catch(O){console.log({message:O}),g("finish-error"),x({});return}},[n,i,o.song_in]);return f.useEffect(()=>{const _=document.querySelector(".temp-song");_&&_.scrollIntoView({behavior:"smooth",block:"center"})},[l]),{handleInputChange:w}}function iK(t,e){const{theme:n}=te(),[r,i]=f.useState(!1),[s,o]=WP("volume",1),a=d=>{const m=d.target.getBoundingClientRect(),p=t.current;if(p){let y=+((d.clientX-m.x)/p.clientWidth).toFixed(2);y>.9?y=1:y<.05?(y=0,i(!0)):i(!1),o(y)}},l=d=>{d.preventDefault();const h=.1;let m=s;d.deltaY>0?m-h>0?m-=h:m=0:m+h<1?m+=h:m=1,o(+m.toFixed(2))},c=()=>i(!r);return f.useEffect(()=>{if(t.current&&e){const d=s*100;t.current.style.background=`linear-gradient(to right, ${n.content_code} ${d}%, #e1e1e1 ${d}%, #e1e1e1 100%)`,e.volume=s,i(s===0)}},[s,n]),f.useEffect(()=>{e&&(e.muted=r)},[r]),{volume:s,handleSetVolume:a,isMute:r,handleMute:c,handleWheel:l}}const sK=/(?:https?):\/\/(\w+:?\w*)?(\S+)(:\d+)?(\/|\/([\w#!:.?+=&%!\-\/]))?/;function oK({data:t,inputFields:e,imageURLFromLocal:n}){const[r,i]=f.useState(!!t.name),[s,o]=f.useState(!!t.singer),[a,l]=f.useState(!1),[c,d]=f.useState(!1),[h,m]=f.useState(!1);return f.useEffect(()=>{e.name?i(!0):i(!1)},[e.name]),f.useEffect(()=>{e.singer?o(!0):o(!1)},[e.singer]),f.useEffect(()=>{if(!e.image_url){l(!0);return}const p=sK.test(e.image_url);l(p)},[e.image_url]),f.useEffect(()=>{(e.name!==t.name||e.singer!==t.singer||e.image_url)&&m(!0)},[e,n]),f.useEffect(()=>{d(r&&s&&a&&h)},[r,s,a,h]),{validName:r,validSinger:s,validURL:a,isAbleToSubmit:c,isChangeInEdit:h,setValidURL:l}}const aK=async t=>{const e=Date.now(),n=await mI.post("/api/image/encode",t);let r;n&&(r=n.data.encode);const i=(Date.now()-e)/1e3;return console.log(">>> api: get blurHash encode finished after",i),{encode:r}},lK=async t=>{const e=new FormData;e.append("file",t);const n=Date.now(),r=await mI.post("/api/image/optimize",e,{responseType:"blob"});let i;r&&(i=r.data);const s=(Date.now()-n)/1e3;return console.log(">>> api: optimize finished after",s),i};function cK({song:t,close:e}){const n=We(),{theme:r}=te(),{user:i}=mt(),{setErrorToast:s,setSuccessToast:o}=xn(),{currentSong:a}=Q(Ae),{updateUserSong:l}=ot(),[c,d]=f.useState(!1),[h,m]=f.useState(!1),[p,y]=f.useState(t.image_url),[x,E]=f.useState(""),[v,g]=f.useState(),[w,_]=f.useState({name:t.name,singer:t.singer,image_url:""}),S=f.useRef(null),{isAbleToSubmit:T,validName:b,validSinger:k,validURL:R,isChangeInEdit:P,setValidURL:O}=oK({data:t,inputFields:w,imageURLFromLocal:x}),W=f.useMemo(()=>{if(x)return x;if(p)return p;if(R)return w.image_url},[w,x,p,t,R]),L=f.useMemo(()=>!!x||!!p,[x,p]),z=(j,G)=>{_({...w,[j]:G})},H=f.useCallback(()=>{t.image_file_path&&!x?y(""):x?(E(""),g(void 0)):y(""),m(!0);const j=S.current;j&&(j.value="")},[x,t.image_file_path]),K=f.useCallback(j=>{const ee=j.target.files[0];E(URL.createObjectURL(ee)),m(!0),g(ee)},[]),fe=()=>{d(!1),e()},I=j=>{j.stopPropagation(),fe()},$=async()=>{if(i){if(!t.id){s({message:"Edit song wrong data id"});return}try{let j={...t};if(P){if(console.log("is change in edit"),!w.name||!w.singer){console.log("input invalid"),s({});return}const G=w.image_url&&R?w.image_url:j.image_url;if(d(!0),j={...j,name:w.name,singer:w.singer,image_url:G},j.name!==w.name||j.singer!==w.singer){console.log("input invalid"),s({});return}if(v&&h){const{filePath:ee,fileURL:ie}=await LP({file:v,folder:"/images/",email:i.email});j.image_file_path=ee,j.image_url=ie}else h&&(j.image_file_path="")}if(h&&(d(!0),console.log("isImpactOnImage"),t.image_file_path&&(j.image_file_path="",j.image_url="",await Fy({filePath:t.image_file_path,msg:">>> api: delete song's image file"})),!p&&!v&&(console.log("remove current image url"),j.image_file_path="",j.image_url=""),v)){console.log("upload new file");const G=await lK(v);if(G==null)return;const ee=lG({blob:G,folder:"/images/",songId:j.id}),{encode:ie}=await aK(G);ie&&(j.blurhash_encode=ie,console.log("check encode",ie));const{filePath:De,fileURL:Se}=await ee;j.image_file_path=De,j.image_url=Se}await Jn({collection:"songs",data:j,id:j.id,msg:">>> api: update song doc"}),l(j),a.id===j.id&&n(Nn({...j,currentIndex:a.currentIndex,song_in:a.song_in})),o({message:"Song edited"}),fe()}catch(j){console.log({message:j}),s({})}finally{d(!1)}}},q={textColor:r.type==="light"?"text-[#333]":"text-[#fff]",input:`px-[10px] py-[5px] rounded-[4px] bg-transparent border border-${r.alpha} text-[14px] font-[500]`};return u.jsxs("div",{className:`w-[500px] max-w-[calc(90vw-40px)] h-[auto] ${c?"disable":""}`,children:[u.jsx("input",{ref:S,id:"editImageInput",type:"file",accept:"image/*",onChange:K,className:"hidden"}),u.jsx("h1",{className:"text-[20px] font-semibold",children:"Edit"}),u.jsxs("div",{className:"flex gap-[20px] mt-[10px] max-[800px]:flex-col",children:[u.jsxs("div",{className:"w-[30%] max-[800px]:flex max-[800px]:w-full max-[800px]:gap-[12px]",children:[u.jsx("div",{className:"w-full rounded-[5px] overflow-hidden",children:u.jsx(vi,{classNames:"object-cover object-center w-full h-full",onError:()=>O(!1),src:W,blurHashEncode:t.blurhash_encode})}),u.jsxs("div",{className:"md:mt-[10px]",children:[u.jsxs("div",{className:"flex gap-[10px]",children:[u.jsx("label",{htmlFor:"editImageInput",className:`inline-block cursor-pointer hover:brightness-90 px-[20px] py-[5px] bg-${r.alpha} rounded-full text-[14px]`,children:u.jsx(zD,{className:"w-[15px]"})}),L&&u.jsx(X,{onClick:()=>H(),className:`inline-block hover:brightness-90 px-[20px] py-[5px] ${r.content_bg} rounded-full text-[14px]`,children:u.jsx(Os,{className:"w-[15px]"})})]}),u.jsx("p",{className:`text-[12px] ${q.textColor} mt-[10px]`,children:"* Image from URL will not be apply until you remove current image"})]})]}),u.jsxs("div",{className:"flex flex-col flex-grow gap-[10px]",children:[u.jsxs("div",{className:"flex flex-col gap-[5px]",children:[u.jsxs("p",{className:"text-[14px] inline-flex",children:["Name:",b?u.jsx(Pd,{className:"w-[20px] text-emerald-500 ml-[10px]"}):u.jsx(Os,{className:"w-[20px] text-red-500 ml-[10px]"})]}),u.jsx("input",{className:`${q.input} ${q.textColor}`,value:w.name,type:"text",onChange:j=>z("name",j.target.value),placeholder:t.name})]}),u.jsxs("div",{className:"flex flex-col gap-[5px]",children:[u.jsxs("p",{className:"inline-flex text-[14px]",children:["Singer:",k?u.jsx(Pd,{className:"w-[20px] text-emerald-500 ml-[10px]"}):u.jsx(Os,{className:"w-[20px] text-red-500 ml-[10px]"})]}),u.jsx("input",{className:q.input,value:w.singer,onChange:j=>z("singer",j.target.value),type:"text",placeholder:t.singer})]}),u.jsxs("div",{className:"flex flex-col gap-[5px]",children:[u.jsxs("p",{className:"inline-flex text-[14px]",children:["Image URL:",w.image_url&&u.jsx(u.Fragment,{children:R?u.jsx(Pd,{className:"w-[20px] text-emerald-500 ml-[10px]"}):u.jsx(Os,{className:"w-[20px] text-red-500 ml-[10px]"})})]}),u.jsx("input",{className:q.input,value:w.image_url,onChange:j=>z("image_url",j.target.value),type:"text"})]}),u.jsxs("div",{className:"flex gap-[10px] mt-[10px]",children:[u.jsx(X,{isLoading:c,onClick:$,className:`${r.content_bg} rounded-full text-[14px] ${T?"":!h&&"disable"}`,variant:"primary",children:"Save"}),u.jsx(X,{onClick:I,className:`bg-${r.alpha} rounded-full hover:bg-red-500 hover:text-[#fff] text-[14px]`,variant:"primary",children:"Close"})]})]})]})]})}function uK({toast:t,theme:e,onClick:n}){const r={icon:"w-[30px] max-[549px]:w-[25px]",container:`text-white px-[12px] py-[6px] rounded-[4px] flex items-center  ${e.side_bar_bg} border border-${e.alpha}`,text:`font-[500] text-[14px] max-[549px]:text-[14px] ${e.type==="light"?"text-[#333]":""}`};return u.jsxs("div",{onClick:()=>n?n(t.id):void 0,className:`${r.container} animate-[fadeIn_0.3s_linear]`,children:[t.title&&u.jsxs("span",{className:"mr-[10px]",children:[t.title==="success"&&u.jsx(yT,{className:`${r.icon} text-emerald-500 `}),t.title==="error"&&u.jsx(gO,{className:`${r.icon} text-red-500`}),t.title==="warning"&&u.jsx(Hv,{className:`${r.icon} text-yellow-500`})]}),u.jsx("p",{className:r.text,children:t.desc})]})}function dK({lyric:t,handleSetTime:e,theme:n,realTimeLyrics:r,index:i,setRealTimeLyrics:s}){const[o,a]=f.useState(!1),[l,c]=f.useState(t.text),d=f.useRef(null),h=p=>{p.preventDefault();const y=[...r],x={...y[i],text:l};y[i]=x,console.log("check new lyric ",x),s(y),a(!1)},m={input:`bg-${n.alpha} rounded-[4px] outline-none w-full px-[8px] text-[16px]`};return f.useEffect(()=>{var p;o&&((p=d.current)==null||p.focus())},[o]),u.jsxs("div",{className:"pb-[10px]",children:[!o&&u.jsxs("p",{className:"text-[16px] leading-[1.2] font-bold select-none flex items-center",children:[t.text,u.jsx("button",{onClick:()=>a(!0),className:"ml-[8px]",children:u.jsx(kT,{className:"w-[16px]"})})]}),o&&u.jsx("form",{action:"",onSubmit:h,children:u.jsx("input",{onBlur:()=>a(!1),value:l,onChange:p=>c(p.target.value),ref:d,type:"text",className:m.input})}),u.jsxs("div",{className:"flex gap-[10px] h-[20px]",children:[u.jsxs("button",{className:` ${n.content_hover_text}`,onClick:()=>e(t.start),children:[t.start,"s"]}),u.jsx("span",{children:" - "}),u.jsxs("button",{className:` ${n.content_hover_text}`,onClick:()=>e(t.end),children:[t.end,"s"]})]})]})}function lf({cb:t,active:e,className:n,size:r="default"}){const{theme:i}=te(),s={circle:`${r==="default"?"w-[20px] h-[20px]":"w-[16px] h-[16px]"}  absolute bg-white left-[3px] rounded-[50%] transition-transform top-[50%] translate-y-[-50%]`,active:`${r==="default"?"translate-x-[14px]":"translate-x-[18px]"} `,inActive:"translate-x-[0]"};return u.jsx("div",{onClick:t,className:`relative  cursor-pointer ${r==="default"?"h-[24px]":"h-[20px]"} rounded-[99px] w-[40px] ${n||""} 
         ${e?i.content_bg:"bg-"+i.alpha} `,children:u.jsx("div",{className:`${s.circle} ${e?s.active:s.inActive}`})})}const zy=Math.min,pa=Math.max,cf=Math.round,md=Math.floor,fs=t=>({x:t,y:t});function hK(t,e){return typeof t=="function"?t(e):t}function Q1(t){return t.split("-")[0]}function XP(t){return t.split("-")[1]}function fK(t){return t==="x"?"y":"x"}function mK(t){return t==="y"?"height":"width"}function Y1(t){return["top","bottom"].includes(Q1(t))?"y":"x"}function pK(t){return fK(Y1(t))}function QP(t){return{...t,top:t.y,left:t.x,right:t.x+t.width,bottom:t.y+t.height}}function bb(t,e,n){let{reference:r,floating:i}=t;const s=Y1(e),o=pK(e),a=mK(o),l=Q1(e),c=s==="y",d=r.x+r.width/2-i.width/2,h=r.y+r.height/2-i.height/2,m=r[a]/2-i[a]/2;let p;switch(l){case"top":p={x:d,y:r.y-i.height};break;case"bottom":p={x:d,y:r.y+r.height};break;case"right":p={x:r.x+r.width,y:h};break;case"left":p={x:r.x-i.width,y:h};break;default:p={x:r.x,y:r.y}}switch(XP(e)){case"start":p[o]-=m*(n&&c?-1:1);break;case"end":p[o]+=m*(n&&c?-1:1);break}return p}const gK=async(t,e,n)=>{const{placement:r="bottom",strategy:i="absolute",middleware:s=[],platform:o}=n,a=s.filter(Boolean),l=await(o.isRTL==null?void 0:o.isRTL(e));let c=await o.getElementRects({reference:t,floating:e,strategy:i}),{x:d,y:h}=bb(c,r,l),m=r,p={},y=0;for(let x=0;x<a.length;x++){const{name:E,fn:v}=a[x],{x:g,y:w,data:_,reset:S}=await v({x:d,y:h,initialPlacement:r,placement:m,strategy:i,middlewareData:p,rects:c,platform:o,elements:{reference:t,floating:e}});if(d=g??d,h=w??h,p={...p,[E]:{...p[E],..._}},S&&y<=50){y++,typeof S=="object"&&(S.placement&&(m=S.placement),S.rects&&(c=S.rects===!0?await o.getElementRects({reference:t,floating:e,strategy:i}):S.rects),{x:d,y:h}=bb(c,m,l)),x=-1;continue}}return{x:d,y:h,placement:m,strategy:i,middlewareData:p}};async function yK(t,e){const{placement:n,platform:r,elements:i}=t,s=await(r.isRTL==null?void 0:r.isRTL(i.floating)),o=Q1(n),a=XP(n),l=Y1(n)==="y",c=["left","top"].includes(o)?-1:1,d=s&&l?-1:1,h=hK(e,t);let{mainAxis:m,crossAxis:p,alignmentAxis:y}=typeof h=="number"?{mainAxis:h,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...h};return a&&typeof y=="number"&&(p=a==="end"?y*-1:y),l?{x:p*d,y:m*c}:{x:m*c,y:p*d}}const YP=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){const{x:n,y:r}=e,i=await yK(e,t);return{x:n+i.x,y:r+i.y,data:i}}}};function ms(t){return JP(t)?(t.nodeName||"").toLowerCase():"#document"}function Dn(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function _i(t){var e;return(e=(JP(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function JP(t){return t instanceof Node||t instanceof Dn(t).Node}function rt(t){return t instanceof Element||t instanceof Dn(t).Element}function on(t){return t instanceof HTMLElement||t instanceof Dn(t).HTMLElement}function By(t){return typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof Dn(t).ShadowRoot}function Cu(t){const{overflow:e,overflowX:n,overflowY:r,display:i}=Ln(t);return/auto|scroll|overlay|hidden|clip/.test(e+r+n)&&!["inline","contents"].includes(i)}function vK(t){return["table","td","th"].includes(ms(t))}function J1(t){const e=Z1(),n=Ln(t);return n.transform!=="none"||n.perspective!=="none"||(n.containerType?n.containerType!=="normal":!1)||!e&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!e&&(n.filter?n.filter!=="none":!1)||["transform","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function xK(t){let e=ho(t);for(;on(e)&&!Au(e);){if(J1(e))return e;e=ho(e)}return null}function Z1(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Au(t){return["html","body","#document"].includes(ms(t))}function Ln(t){return Dn(t).getComputedStyle(t)}function Zm(t){return rt(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function ho(t){if(ms(t)==="html")return t;const e=t.assignedSlot||t.parentNode||By(t)&&t.host||_i(t);return By(e)?e.host:e}function ZP(t){const e=ho(t);return Au(e)?t.ownerDocument?t.ownerDocument.body:t.body:on(e)&&Cu(e)?e:ZP(e)}function qs(t,e){var n;e===void 0&&(e=[]);const r=ZP(t),i=r===((n=t.ownerDocument)==null?void 0:n.body),s=Dn(r);return i?e.concat(s,s.visualViewport||[],Cu(r)?r:[]):e.concat(r,qs(r))}function e4(t){const e=Ln(t);let n=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const i=on(t),s=i?t.offsetWidth:n,o=i?t.offsetHeight:r,a=cf(n)!==s||cf(r)!==o;return a&&(n=s,r=o),{width:n,height:r,$:a}}function ew(t){return rt(t)?t:t.contextElement}function ga(t){const e=ew(t);if(!on(e))return fs(1);const n=e.getBoundingClientRect(),{width:r,height:i,$:s}=e4(e);let o=(s?cf(n.width):n.width)/r,a=(s?cf(n.height):n.height)/i;return(!o||!Number.isFinite(o))&&(o=1),(!a||!Number.isFinite(a))&&(a=1),{x:o,y:a}}const wK=fs(0);function t4(t){const e=Dn(t);return!Z1()||!e.visualViewport?wK:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function _K(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==Dn(t)?!1:e}function fo(t,e,n,r){e===void 0&&(e=!1),n===void 0&&(n=!1);const i=t.getBoundingClientRect(),s=ew(t);let o=fs(1);e&&(r?rt(r)&&(o=ga(r)):o=ga(t));const a=_K(s,n,r)?t4(s):fs(0);let l=(i.left+a.x)/o.x,c=(i.top+a.y)/o.y,d=i.width/o.x,h=i.height/o.y;if(s){const m=Dn(s),p=r&&rt(r)?Dn(r):r;let y=m.frameElement;for(;y&&r&&p!==m;){const x=ga(y),E=y.getBoundingClientRect(),v=Ln(y),g=E.left+(y.clientLeft+parseFloat(v.paddingLeft))*x.x,w=E.top+(y.clientTop+parseFloat(v.paddingTop))*x.y;l*=x.x,c*=x.y,d*=x.x,h*=x.y,l+=g,c+=w,y=Dn(y).frameElement}}return QP({width:d,height:h,x:l,y:c})}function EK(t){let{rect:e,offsetParent:n,strategy:r}=t;const i=on(n),s=_i(n);if(n===s)return e;let o={scrollLeft:0,scrollTop:0},a=fs(1);const l=fs(0);if((i||!i&&r!=="fixed")&&((ms(n)!=="body"||Cu(s))&&(o=Zm(n)),on(n))){const c=fo(n);a=ga(n),l.x=c.x+n.clientLeft,l.y=c.y+n.clientTop}return{width:e.width*a.x,height:e.height*a.y,x:e.x*a.x-o.scrollLeft*a.x+l.x,y:e.y*a.y-o.scrollTop*a.y+l.y}}function SK(t){return Array.from(t.getClientRects())}function n4(t){return fo(_i(t)).left+Zm(t).scrollLeft}function bK(t){const e=_i(t),n=Zm(t),r=t.ownerDocument.body,i=pa(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),s=pa(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let o=-n.scrollLeft+n4(t);const a=-n.scrollTop;return Ln(r).direction==="rtl"&&(o+=pa(e.clientWidth,r.clientWidth)-i),{width:i,height:s,x:o,y:a}}function kK(t,e){const n=Dn(t),r=_i(t),i=n.visualViewport;let s=r.clientWidth,o=r.clientHeight,a=0,l=0;if(i){s=i.width,o=i.height;const c=Z1();(!c||c&&e==="fixed")&&(a=i.offsetLeft,l=i.offsetTop)}return{width:s,height:o,x:a,y:l}}function TK(t,e){const n=fo(t,!0,e==="fixed"),r=n.top+t.clientTop,i=n.left+t.clientLeft,s=on(t)?ga(t):fs(1),o=t.clientWidth*s.x,a=t.clientHeight*s.y,l=i*s.x,c=r*s.y;return{width:o,height:a,x:l,y:c}}function kb(t,e,n){let r;if(e==="viewport")r=kK(t,n);else if(e==="document")r=bK(_i(t));else if(rt(e))r=TK(e,n);else{const i=t4(t);r={...e,x:e.x-i.x,y:e.y-i.y}}return QP(r)}function r4(t,e){const n=ho(t);return n===e||!rt(n)||Au(n)?!1:Ln(n).position==="fixed"||r4(n,e)}function IK(t,e){const n=e.get(t);if(n)return n;let r=qs(t).filter(a=>rt(a)&&ms(a)!=="body"),i=null;const s=Ln(t).position==="fixed";let o=s?ho(t):t;for(;rt(o)&&!Au(o);){const a=Ln(o),l=J1(o);!l&&a.position==="fixed"&&(i=null),(s?!l&&!i:!l&&a.position==="static"&&!!i&&["absolute","fixed"].includes(i.position)||Cu(o)&&!l&&r4(t,o))?r=r.filter(d=>d!==o):i=a,o=ho(o)}return e.set(t,r),r}function CK(t){let{element:e,boundary:n,rootBoundary:r,strategy:i}=t;const o=[...n==="clippingAncestors"?IK(e,this._c):[].concat(n),r],a=o[0],l=o.reduce((c,d)=>{const h=kb(e,d,i);return c.top=pa(h.top,c.top),c.right=zy(h.right,c.right),c.bottom=zy(h.bottom,c.bottom),c.left=pa(h.left,c.left),c},kb(e,a,i));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function AK(t){return e4(t)}function RK(t,e,n){const r=on(e),i=_i(e),s=n==="fixed",o=fo(t,!0,s,e);let a={scrollLeft:0,scrollTop:0};const l=fs(0);if(r||!r&&!s)if((ms(e)!=="body"||Cu(i))&&(a=Zm(e)),r){const c=fo(e,!0,s,e);l.x=c.x+e.clientLeft,l.y=c.y+e.clientTop}else i&&(l.x=n4(i));return{x:o.left+a.scrollLeft-l.x,y:o.top+a.scrollTop-l.y,width:o.width,height:o.height}}function Tb(t,e){return!on(t)||Ln(t).position==="fixed"?null:e?e(t):t.offsetParent}function i4(t,e){const n=Dn(t);if(!on(t))return n;let r=Tb(t,e);for(;r&&vK(r)&&Ln(r).position==="static";)r=Tb(r,e);return r&&(ms(r)==="html"||ms(r)==="body"&&Ln(r).position==="static"&&!J1(r))?n:r||xK(t)||n}const PK=async function(t){let{reference:e,floating:n,strategy:r}=t;const i=this.getOffsetParent||i4,s=this.getDimensions;return{reference:RK(e,await i(n),r),floating:{x:0,y:0,...await s(n)}}};function NK(t){return Ln(t).direction==="rtl"}const DK={convertOffsetParentRelativeRectToViewportRelativeRect:EK,getDocumentElement:_i,getClippingRect:CK,getOffsetParent:i4,getElementRects:PK,getClientRects:SK,getDimensions:AK,getScale:ga,isElement:rt,isRTL:NK};function jK(t,e){let n=null,r;const i=_i(t);function s(){clearTimeout(r),n&&n.disconnect(),n=null}function o(a,l){a===void 0&&(a=!1),l===void 0&&(l=1),s();const{left:c,top:d,width:h,height:m}=t.getBoundingClientRect();if(a||e(),!h||!m)return;const p=md(d),y=md(i.clientWidth-(c+h)),x=md(i.clientHeight-(d+m)),E=md(c),g={rootMargin:-p+"px "+-y+"px "+-x+"px "+-E+"px",threshold:pa(0,zy(1,l))||1};let w=!0;function _(S){const T=S[0].intersectionRatio;if(T!==l){if(!w)return o();T?o(!1,T):r=setTimeout(()=>{o(!1,1e-7)},100)}w=!1}try{n=new IntersectionObserver(_,{...g,root:i.ownerDocument})}catch{n=new IntersectionObserver(_,g)}n.observe(t)}return o(!0),s}function s4(t,e,n,r){r===void 0&&(r={});const{ancestorScroll:i=!0,ancestorResize:s=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:l=!1}=r,c=ew(t),d=i||s?[...c?qs(c):[],...qs(e)]:[];d.forEach(v=>{i&&v.addEventListener("scroll",n,{passive:!0}),s&&v.addEventListener("resize",n)});const h=c&&a?jK(c,n):null;let m=-1,p=null;o&&(p=new ResizeObserver(v=>{let[g]=v;g&&g.target===c&&p&&(p.unobserve(e),cancelAnimationFrame(m),m=requestAnimationFrame(()=>{p&&p.observe(e)})),n()}),c&&!l&&p.observe(c),p.observe(e));let y,x=l?fo(t):null;l&&E();function E(){const v=fo(t);x&&(v.x!==x.x||v.y!==x.y||v.width!==x.width||v.height!==x.height)&&n(),x=v,y=requestAnimationFrame(E)}return n(),()=>{d.forEach(v=>{i&&v.removeEventListener("scroll",n),s&&v.removeEventListener("resize",n)}),h&&h(),p&&p.disconnect(),p=null,l&&cancelAnimationFrame(y)}}const OK=(t,e,n)=>{const r=new Map,i={platform:DK,...n},s={...i.platform,_c:r};return gK(t,e,{...i,platform:s})};var Ud=typeof document<"u"?f.useLayoutEffect:f.useEffect;function uf(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let n,r,i;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(n=t.length,n!=e.length)return!1;for(r=n;r--!==0;)if(!uf(t[r],e[r]))return!1;return!0}if(i=Object.keys(t),n=i.length,n!==Object.keys(e).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(e,i[r]))return!1;for(r=n;r--!==0;){const s=i[r];if(!(s==="_owner"&&t.$$typeof)&&!uf(t[s],e[s]))return!1}return!0}return t!==t&&e!==e}function o4(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function Ib(t,e){const n=o4(t);return Math.round(e*n)/n}function Cb(t){const e=f.useRef(t);return Ud(()=>{e.current=t}),e}function MK(t){t===void 0&&(t={});const{placement:e="bottom",strategy:n="absolute",middleware:r=[],platform:i,elements:{reference:s,floating:o}={},transform:a=!0,whileElementsMounted:l,open:c}=t,[d,h]=f.useState({x:0,y:0,strategy:n,placement:e,middlewareData:{},isPositioned:!1}),[m,p]=f.useState(r);uf(m,r)||p(r);const[y,x]=f.useState(null),[E,v]=f.useState(null),g=f.useCallback(K=>{K!=T.current&&(T.current=K,x(K))},[x]),w=f.useCallback(K=>{K!==b.current&&(b.current=K,v(K))},[v]),_=s||y,S=o||E,T=f.useRef(null),b=f.useRef(null),k=f.useRef(d),R=Cb(l),P=Cb(i),O=f.useCallback(()=>{if(!T.current||!b.current)return;const K={placement:e,strategy:n,middleware:m};P.current&&(K.platform=P.current),OK(T.current,b.current,K).then(fe=>{const I={...fe,isPositioned:!0};W.current&&!uf(k.current,I)&&(k.current=I,Ka.flushSync(()=>{h(I)}))})},[m,e,n,P]);Ud(()=>{c===!1&&k.current.isPositioned&&(k.current.isPositioned=!1,h(K=>({...K,isPositioned:!1})))},[c]);const W=f.useRef(!1);Ud(()=>(W.current=!0,()=>{W.current=!1}),[]),Ud(()=>{if(_&&(T.current=_),S&&(b.current=S),_&&S){if(R.current)return R.current(_,S,O);O()}},[_,S,O,R]);const L=f.useMemo(()=>({reference:T,floating:b,setReference:g,setFloating:w}),[g,w]),z=f.useMemo(()=>({reference:_,floating:S}),[_,S]),H=f.useMemo(()=>{const K={position:n,left:0,top:0};if(!z.floating)return K;const fe=Ib(z.floating,d.x),I=Ib(z.floating,d.y);return a?{...K,transform:"translate("+fe+"px, "+I+"px)",...o4(z.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:fe,top:I}},[n,a,z.floating,d.x,d.y]);return f.useMemo(()=>({...d,update:O,refs:L,elements:z,floatingStyles:H}),[d,O,L,z,H])}function zo(t){let e=t.activeElement;for(;((n=e)==null||(r=n.shadowRoot)==null?void 0:r.activeElement)!=null;){var n,r;e=e.shadowRoot.activeElement}return e}function un(t,e){if(!t||!e)return!1;const n=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(n&&By(n)){let r=e;for(;r;){if(t===r)return!0;r=r.parentNode||r.host}}return!1}function LK(){const t=navigator.userAgentData;return t!=null&&t.platform?t.platform:navigator.platform}function FK(){const t=navigator.userAgentData;return t&&Array.isArray(t.brands)?t.brands.map(e=>{let{brand:n,version:r}=e;return n+"/"+r}).join(" "):navigator.userAgent}function $K(t){if(t.mozInputSource===0&&t.isTrusted)return!0;const e=/Android/i;return(e.test(LK())||e.test(FK()))&&t.pointerType?t.type==="click"&&t.buttons===1:t.detail===0&&!t.pointerType}function zK(t){return t.width===0&&t.height===0||t.width===1&&t.height===1&&t.pressure===0&&t.detail===0&&t.pointerType!=="mouse"||t.width<1&&t.height<1&&t.pressure===0&&t.detail===0}function BK(){return/apple/i.test(navigator.vendor)}function df(t,e){const n=["mouse","pen"];return e||n.push("",void 0),n.includes(t)}function VK(t){return"nativeEvent"in t}function UK(t){return t.matches("html,body")}function hn(t){return(t==null?void 0:t.ownerDocument)||document}function kg(t,e){if(e==null)return!1;if("composedPath"in t)return t.composedPath().includes(e);const n=t;return n.target!=null&&e.contains(n.target)}function a4(t){return"composedPath"in t?t.composedPath()[0]:t.target}const WK="input:not([type='hidden']):not([disabled]),[contenteditable]:not([contenteditable='false']),textarea:not([disabled])";function l4(t){return on(t)&&t.matches(WK)}function Tg(t){t.preventDefault(),t.stopPropagation()}/*!
* tabbable 6.2.0
* @license MIT, https://github.com/focus-trap/tabbable/blob/master/LICENSE
*/var HK=["input:not([inert])","select:not([inert])","textarea:not([inert])","a[href]:not([inert])","button:not([inert])","[tabindex]:not(slot):not([inert])","audio[controls]:not([inert])","video[controls]:not([inert])",'[contenteditable]:not([contenteditable="false"]):not([inert])',"details>summary:first-of-type:not([inert])","details:not([inert])"],Vy=HK.join(","),c4=typeof Element>"u",qc=c4?function(){}:Element.prototype.matches||Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector,hf=!c4&&Element.prototype.getRootNode?function(t){var e;return t==null||(e=t.getRootNode)===null||e===void 0?void 0:e.call(t)}:function(t){return t==null?void 0:t.ownerDocument},ff=function t(e,n){var r;n===void 0&&(n=!0);var i=e==null||(r=e.getAttribute)===null||r===void 0?void 0:r.call(e,"inert"),s=i===""||i==="true",o=s||n&&e&&t(e.parentNode);return o},qK=function(e){var n,r=e==null||(n=e.getAttribute)===null||n===void 0?void 0:n.call(e,"contenteditable");return r===""||r==="true"},GK=function(e,n,r){if(ff(e))return[];var i=Array.prototype.slice.apply(e.querySelectorAll(Vy));return n&&qc.call(e,Vy)&&i.unshift(e),i=i.filter(r),i},KK=function t(e,n,r){for(var i=[],s=Array.from(e);s.length;){var o=s.shift();if(!ff(o,!1))if(o.tagName==="SLOT"){var a=o.assignedElements(),l=a.length?a:o.children,c=t(l,!0,r);r.flatten?i.push.apply(i,c):i.push({scopeParent:o,candidates:c})}else{var d=qc.call(o,Vy);d&&r.filter(o)&&(n||!e.includes(o))&&i.push(o);var h=o.shadowRoot||typeof r.getShadowRoot=="function"&&r.getShadowRoot(o),m=!ff(h,!1)&&(!r.shadowRootFilter||r.shadowRootFilter(o));if(h&&m){var p=t(h===!0?o.children:h.children,!0,r);r.flatten?i.push.apply(i,p):i.push({scopeParent:o,candidates:p})}else s.unshift.apply(s,o.children)}}return i},u4=function(e){return!isNaN(parseInt(e.getAttribute("tabindex"),10))},d4=function(e){if(!e)throw new Error("No node provided");return e.tabIndex<0&&(/^(AUDIO|VIDEO|DETAILS)$/.test(e.tagName)||qK(e))&&!u4(e)?0:e.tabIndex},XK=function(e,n){var r=d4(e);return r<0&&n&&!u4(e)?0:r},QK=function(e,n){return e.tabIndex===n.tabIndex?e.documentOrder-n.documentOrder:e.tabIndex-n.tabIndex},h4=function(e){return e.tagName==="INPUT"},YK=function(e){return h4(e)&&e.type==="hidden"},JK=function(e){var n=e.tagName==="DETAILS"&&Array.prototype.slice.apply(e.children).some(function(r){return r.tagName==="SUMMARY"});return n},ZK=function(e,n){for(var r=0;r<e.length;r++)if(e[r].checked&&e[r].form===n)return e[r]},eX=function(e){if(!e.name)return!0;var n=e.form||hf(e),r=function(a){return n.querySelectorAll('input[type="radio"][name="'+a+'"]')},i;if(typeof window<"u"&&typeof window.CSS<"u"&&typeof window.CSS.escape=="function")i=r(window.CSS.escape(e.name));else try{i=r(e.name)}catch(o){return console.error("Looks like you have a radio button with a name attribute containing invalid CSS selector characters and need the CSS.escape polyfill: %s",o.message),!1}var s=ZK(i,e.form);return!s||s===e},tX=function(e){return h4(e)&&e.type==="radio"},nX=function(e){return tX(e)&&!eX(e)},rX=function(e){var n,r=e&&hf(e),i=(n=r)===null||n===void 0?void 0:n.host,s=!1;if(r&&r!==e){var o,a,l;for(s=!!((o=i)!==null&&o!==void 0&&(a=o.ownerDocument)!==null&&a!==void 0&&a.contains(i)||e!=null&&(l=e.ownerDocument)!==null&&l!==void 0&&l.contains(e));!s&&i;){var c,d,h;r=hf(i),i=(c=r)===null||c===void 0?void 0:c.host,s=!!((d=i)!==null&&d!==void 0&&(h=d.ownerDocument)!==null&&h!==void 0&&h.contains(i))}}return s},Ab=function(e){var n=e.getBoundingClientRect(),r=n.width,i=n.height;return r===0&&i===0},iX=function(e,n){var r=n.displayCheck,i=n.getShadowRoot;if(getComputedStyle(e).visibility==="hidden")return!0;var s=qc.call(e,"details>summary:first-of-type"),o=s?e.parentElement:e;if(qc.call(o,"details:not([open]) *"))return!0;if(!r||r==="full"||r==="legacy-full"){if(typeof i=="function"){for(var a=e;e;){var l=e.parentElement,c=hf(e);if(l&&!l.shadowRoot&&i(l)===!0)return Ab(e);e.assignedSlot?e=e.assignedSlot:!l&&c!==e.ownerDocument?e=c.host:e=l}e=a}if(rX(e))return!e.getClientRects().length;if(r!=="legacy-full")return!0}else if(r==="non-zero-area")return Ab(e);return!1},sX=function(e){if(/^(INPUT|BUTTON|SELECT|TEXTAREA)$/.test(e.tagName))for(var n=e.parentElement;n;){if(n.tagName==="FIELDSET"&&n.disabled){for(var r=0;r<n.children.length;r++){var i=n.children.item(r);if(i.tagName==="LEGEND")return qc.call(n,"fieldset[disabled] *")?!0:!i.contains(e)}return!0}n=n.parentElement}return!1},oX=function(e,n){return!(n.disabled||ff(n)||YK(n)||iX(n,e)||JK(n)||sX(n))},Rb=function(e,n){return!(nX(n)||d4(n)<0||!oX(e,n))},aX=function(e){var n=parseInt(e.getAttribute("tabindex"),10);return!!(isNaN(n)||n>=0)},lX=function t(e){var n=[],r=[];return e.forEach(function(i,s){var o=!!i.scopeParent,a=o?i.scopeParent:i,l=XK(a,o),c=o?t(i.candidates):a;l===0?o?n.push.apply(n,c):n.push(a):r.push({documentOrder:s,tabIndex:l,item:i,isScope:o,content:c})}),r.sort(QK).reduce(function(i,s){return s.isScope?i.push.apply(i,s.content):i.push(s.content),i},[]).concat(n)},f4=function(e,n){n=n||{};var r;return n.getShadowRoot?r=KK([e],n.includeContainer,{filter:Rb.bind(null,n),flatten:!1,getShadowRoot:n.getShadowRoot,shadowRootFilter:aX}):r=GK(e,n.includeContainer,Rb.bind(null,n)),lX(r)};function mf(){return mf=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},mf.apply(this,arguments)}var An=typeof document<"u"?f.useLayoutEffect:f.useEffect;let Ig=!1,cX=0;const Pb=()=>"floating-ui-"+cX++;function uX(){const[t,e]=f.useState(()=>Ig?Pb():void 0);return An(()=>{t==null&&e(Pb())},[]),f.useEffect(()=>{Ig||(Ig=!0)},[]),t}const dX=Xy["useId".toString()],m4=dX||uX;function hX(){const t=new Map;return{emit(e,n){var r;(r=t.get(e))==null||r.forEach(i=>i(n))},on(e,n){t.set(e,[...t.get(e)||[],n])},off(e,n){var r;t.set(e,((r=t.get(e))==null?void 0:r.filter(i=>i!==n))||[])}}}const fX=f.createContext(null),mX=f.createContext(null),p4=()=>{var t;return((t=f.useContext(fX))==null?void 0:t.id)||null},ep=()=>f.useContext(mX);function Gc(t){return"data-floating-ui-"+t}function ni(t){const e=f.useRef(t);return An(()=>{e.current=t}),e}const Nb=Gc("safe-polygon");function Cg(t,e,n){return n&&!df(n)?0:typeof t=="number"?t:t==null?void 0:t[e]}function pX(t,e){e===void 0&&(e={});const{open:n,onOpenChange:r,dataRef:i,events:s,elements:{domReference:o,floating:a},refs:l}=t,{enabled:c=!0,delay:d=0,handleClose:h=null,mouseOnly:m=!1,restMs:p=0,move:y=!0}=e,x=ep(),E=p4(),v=ni(h),g=ni(d),w=f.useRef(),_=f.useRef(),S=f.useRef(),T=f.useRef(),b=f.useRef(!0),k=f.useRef(!1),R=f.useRef(()=>{}),P=f.useCallback(()=>{var z;const H=(z=i.current.openEvent)==null?void 0:z.type;return(H==null?void 0:H.includes("mouse"))&&H!=="mousedown"},[i]);f.useEffect(()=>{if(!c)return;function z(){clearTimeout(_.current),clearTimeout(T.current),b.current=!0}return s.on("dismiss",z),()=>{s.off("dismiss",z)}},[c,s]),f.useEffect(()=>{if(!c||!v.current||!n)return;function z(K){P()&&r(!1,K)}const H=hn(a).documentElement;return H.addEventListener("mouseleave",z),()=>{H.removeEventListener("mouseleave",z)}},[a,n,r,c,v,i,P]);const O=f.useCallback(function(z,H){H===void 0&&(H=!0);const K=Cg(g.current,"close",w.current);K&&!S.current?(clearTimeout(_.current),_.current=setTimeout(()=>r(!1,z),K)):H&&(clearTimeout(_.current),r(!1,z))},[g,r]),W=f.useCallback(()=>{R.current(),S.current=void 0},[]),L=f.useCallback(()=>{if(k.current){const z=hn(l.floating.current).body;z.style.pointerEvents="",z.removeAttribute(Nb),k.current=!1}},[l]);return f.useEffect(()=>{if(!c)return;function z(){return i.current.openEvent?["click","mousedown"].includes(i.current.openEvent.type):!1}function H(I){if(clearTimeout(_.current),b.current=!1,m&&!df(w.current)||p>0&&Cg(g.current,"open")===0)return;const $=Cg(g.current,"open",w.current);$?_.current=setTimeout(()=>{r(!0,I)},$):r(!0,I)}function K(I){if(z())return;R.current();const $=hn(a);if(clearTimeout(T.current),v.current){n||clearTimeout(_.current),S.current=v.current({...t,tree:x,x:I.clientX,y:I.clientY,onClose(){L(),W(),O(I)}});const j=S.current;$.addEventListener("mousemove",j),R.current=()=>{$.removeEventListener("mousemove",j)};return}(w.current==="touch"?!un(a,I.relatedTarget):!0)&&O(I)}function fe(I){z()||v.current==null||v.current({...t,tree:x,x:I.clientX,y:I.clientY,onClose(){L(),W(),O(I)}})(I)}if(rt(o)){const I=o;return n&&I.addEventListener("mouseleave",fe),a==null||a.addEventListener("mouseleave",fe),y&&I.addEventListener("mousemove",H,{once:!0}),I.addEventListener("mouseenter",H),I.addEventListener("mouseleave",K),()=>{n&&I.removeEventListener("mouseleave",fe),a==null||a.removeEventListener("mouseleave",fe),y&&I.removeEventListener("mousemove",H),I.removeEventListener("mouseenter",H),I.removeEventListener("mouseleave",K)}}},[o,a,c,t,m,p,y,O,W,L,r,n,x,g,v,i]),An(()=>{var z;if(c&&n&&(z=v.current)!=null&&z.__options.blockPointerEvents&&P()){const fe=hn(a).body;if(fe.setAttribute(Nb,""),fe.style.pointerEvents="none",k.current=!0,rt(o)&&a){var H,K;const I=o,$=x==null||(H=x.nodesRef.current.find(q=>q.id===E))==null||(K=H.context)==null?void 0:K.elements.floating;return $&&($.style.pointerEvents=""),I.style.pointerEvents="auto",a.style.pointerEvents="auto",()=>{I.style.pointerEvents="",a.style.pointerEvents=""}}}},[c,n,E,a,o,x,v,i,P]),An(()=>{n||(w.current=void 0,W(),L())},[n,W,L]),f.useEffect(()=>()=>{W(),clearTimeout(_.current),clearTimeout(T.current),L()},[c,o,W,L]),f.useMemo(()=>{if(!c)return{};function z(H){w.current=H.pointerType}return{reference:{onPointerDown:z,onPointerEnter:z,onMouseMove(H){n||p===0||(clearTimeout(T.current),T.current=setTimeout(()=>{b.current||r(!0,H.nativeEvent)},p))}},floating:{onMouseEnter(){clearTimeout(_.current)},onMouseLeave(H){s.emit("dismiss",{type:"mouseLeave",data:{returnFocus:!1}}),O(H.nativeEvent,!1)}}}},[s,c,p,n,r,O])}let Db=0;function ks(t,e){e===void 0&&(e={});const{preventScroll:n=!1,cancelPrevious:r=!0,sync:i=!1}=e;r&&cancelAnimationFrame(Db);const s=()=>t==null?void 0:t.focus({preventScroll:n});i?s():Db=requestAnimationFrame(s)}function gX(t,e){var n;let r=[],i=(n=t.find(s=>s.id===e))==null?void 0:n.parentId;for(;i;){const s=t.find(o=>o.id===i);i=s==null?void 0:s.parentId,s&&(r=r.concat(s))}return r}function Zl(t,e){let n=t.filter(i=>{var s;return i.parentId===e&&((s=i.context)==null?void 0:s.open)}),r=n;for(;r.length;)r=t.filter(i=>{var s;return(s=r)==null?void 0:s.some(o=>{var a;return i.parentId===o.id&&((a=i.context)==null?void 0:a.open)})}),n=n.concat(r);return n}let Mo=new WeakMap,pd=new WeakSet,gd={},Ag=0;const yX=()=>typeof HTMLElement<"u"&&"inert"in HTMLElement.prototype,g4=t=>t&&(t.host||g4(t.parentNode)),vX=(t,e)=>e.map(n=>{if(t.contains(n))return n;const r=g4(n);return t.contains(r)?r:null}).filter(n=>n!=null);function xX(t,e,n,r){const i="data-floating-ui-inert",s=r?"inert":n?"aria-hidden":null,o=vX(e,t),a=new Set,l=new Set(o),c=[];gd[i]||(gd[i]=new WeakMap);const d=gd[i];o.forEach(h),m(e),a.clear();function h(p){!p||a.has(p)||(a.add(p),p.parentNode&&h(p.parentNode))}function m(p){!p||l.has(p)||Array.prototype.forEach.call(p.children,y=>{if(a.has(y))m(y);else{const x=s?y.getAttribute(s):null,E=x!==null&&x!=="false",v=(Mo.get(y)||0)+1,g=(d.get(y)||0)+1;Mo.set(y,v),d.set(y,g),c.push(y),v===1&&E&&pd.add(y),g===1&&y.setAttribute(i,""),!E&&s&&y.setAttribute(s,"true")}})}return Ag++,()=>{c.forEach(p=>{const y=(Mo.get(p)||0)-1,x=(d.get(p)||0)-1;Mo.set(p,y),d.set(p,x),y||(!pd.has(p)&&s&&p.removeAttribute(s),pd.delete(p)),x||p.removeAttribute(i)}),Ag--,Ag||(Mo=new WeakMap,Mo=new WeakMap,pd=new WeakSet,gd={})}}function jb(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!1);const r=hn(t[0]).body;return xX(t.concat(Array.from(r.querySelectorAll("[aria-live]"))),r,e,n)}const y4=()=>({getShadowRoot:!0,displayCheck:typeof ResizeObserver=="function"&&ResizeObserver.toString().includes("[native code]")?"full":"none"});function v4(t,e){const n=f4(t,y4());e==="prev"&&n.reverse();const r=n.indexOf(zo(hn(t)));return n.slice(r+1)[0]}function wX(){return v4(document.body,"next")}function _X(){return v4(document.body,"prev")}function Ob(t,e){const n=e||t.currentTarget,r=t.relatedTarget;return!r||!un(n,r)}const x4={border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"fixed",whiteSpace:"nowrap",width:"1px",top:0,left:0};let EX;function Mb(t){t.key==="Tab"&&(t.target,clearTimeout(EX))}const Lb=f.forwardRef(function(e,n){const[r,i]=f.useState();An(()=>(BK()&&i("button"),document.addEventListener("keydown",Mb),()=>{document.removeEventListener("keydown",Mb)}),[]);const s={ref:n,tabIndex:0,role:r,"aria-hidden":r?void 0:!0,[Gc("focus-guard")]:"",style:x4};return f.createElement("span",mf({},e,s))}),SX=f.createContext(null),bX=()=>f.useContext(SX),kX=f.forwardRef(function(e,n){return f.createElement("button",mf({},e,{type:"button",ref:n,tabIndex:-1,style:x4}))});function w4(t){const{context:e,children:n,disabled:r=!1,order:i=["content"],guards:s=!0,initialFocus:o=0,returnFocus:a=!0,modal:l=!0,visuallyHiddenDismiss:c=!1,closeOnFocusOut:d=!0}=t,{open:h,refs:m,nodeId:p,onOpenChange:y,events:x,dataRef:E,elements:{domReference:v,floating:g}}=e,w=yX()?s:!0,_=ni(i),S=ni(o),T=ni(a),b=ep(),k=bX(),R=typeof o=="number"&&o<0,P=f.useRef(null),O=f.useRef(null),W=f.useRef(!1),L=f.useRef(null),z=f.useRef(!1),H=k!=null,K=v&&v.getAttribute("role")==="combobox"&&l4(v),fe=f.useCallback(function(j){return j===void 0&&(j=g),j?f4(j,y4()):[]},[g]),I=f.useCallback(j=>{const G=fe(j);return _.current.map(ee=>v&&ee==="reference"?v:g&&ee==="floating"?g:G).filter(Boolean).flat()},[v,g,_,fe]);f.useEffect(()=>{if(r||!l)return;function j(ee){if(ee.key==="Tab"){un(g,zo(hn(g)))&&fe().length===0&&!K&&Tg(ee);const ie=I(),De=a4(ee);_.current[0]==="reference"&&De===v&&(Tg(ee),ee.shiftKey?ks(ie[ie.length-1]):ks(ie[1])),_.current[1]==="floating"&&De===g&&ee.shiftKey&&(Tg(ee),ks(ie[0]))}}const G=hn(g);return G.addEventListener("keydown",j),()=>{G.removeEventListener("keydown",j)}},[r,v,g,l,_,m,K,fe,I]),f.useEffect(()=>{if(r||!d)return;function j(){z.current=!0,setTimeout(()=>{z.current=!1})}function G(ee){const ie=ee.relatedTarget;queueMicrotask(()=>{const De=!(un(v,ie)||un(g,ie)||un(ie,g)||un(k==null?void 0:k.portalNode,ie)||ie!=null&&ie.hasAttribute(Gc("focus-guard"))||b&&(Zl(b.nodesRef.current,p).find(Se=>{var je,Ot;return un((je=Se.context)==null?void 0:je.elements.floating,ie)||un((Ot=Se.context)==null?void 0:Ot.elements.domReference,ie)})||gX(b.nodesRef.current,p).find(Se=>{var je,Ot;return((je=Se.context)==null?void 0:je.elements.floating)===ie||((Ot=Se.context)==null?void 0:Ot.elements.domReference)===ie})));ie&&De&&!z.current&&ie!==L.current&&(W.current=!0,y(!1,ee))})}if(g&&on(v))return v.addEventListener("focusout",G),v.addEventListener("pointerdown",j),!l&&g.addEventListener("focusout",G),()=>{v.removeEventListener("focusout",G),v.removeEventListener("pointerdown",j),!l&&g.removeEventListener("focusout",G)}},[r,v,g,l,p,b,k,y,d]),f.useEffect(()=>{var j;if(r)return;const G=Array.from((k==null||(j=k.portalNode)==null?void 0:j.querySelectorAll("["+Gc("portal")+"]"))||[]);if(g){const ee=[g,...G,P.current,O.current,_.current.includes("reference")||K?v:null].filter(De=>De!=null),ie=l?jb(ee,w,!w):jb(ee);return()=>{ie()}}},[r,v,g,l,_,k,K,w]),An(()=>{if(r||!g)return;const j=hn(g),G=zo(j);queueMicrotask(()=>{const ee=I(g),ie=S.current,De=(typeof ie=="number"?ee[ie]:ie.current)||g,Se=un(g,G);!R&&!Se&&h&&ks(De,{preventScroll:De===g})})},[r,h,g,R,I,S]),An(()=>{if(r||!g)return;let j=!1;const G=hn(g),ee=zo(G),ie=E.current;L.current=ee;function De(Se){if(Se.type==="escapeKey"&&m.domReference.current&&(L.current=m.domReference.current),["referencePress","escapeKey"].includes(Se.type))return;const je=Se.data.returnFocus;typeof je=="object"?(W.current=!1,j=je.preventScroll):W.current=!je}return x.on("dismiss",De),()=>{x.off("dismiss",De);const Se=zo(G);(un(g,Se)||b&&Zl(b.nodesRef.current,p).some(Ot=>{var Mt;return un((Mt=Ot.context)==null?void 0:Mt.elements.floating,Se)})||ie.openEvent&&["click","mousedown"].includes(ie.openEvent.type))&&m.domReference.current&&(L.current=m.domReference.current),T.current&&on(L.current)&&!W.current&&ks(L.current,{cancelPrevious:!1,preventScroll:j})}},[r,g,T,E,m,x,b,p]),An(()=>{if(!(r||!k))return k.setFocusManagerState({modal:l,closeOnFocusOut:d,open:h,onOpenChange:y,refs:m}),()=>{k.setFocusManagerState(null)}},[r,k,l,h,y,m,d]),An(()=>{if(!r&&g&&typeof MutationObserver=="function"){const j=()=>{const ee=g.getAttribute("tabindex");_.current.includes("floating")||zo(hn(g))!==m.domReference.current&&fe().length===0?ee!=="0"&&g.setAttribute("tabindex","0"):ee!=="-1"&&g.setAttribute("tabindex","-1")};j();const G=new MutationObserver(j);return G.observe(g,{childList:!0,subtree:!0,attributes:!0}),()=>{G.disconnect()}}},[r,g,m,_,fe]);function $(j){return r||!c||!l?null:f.createElement(kX,{ref:j==="start"?P:O,onClick:G=>y(!1,G.nativeEvent)},typeof c=="string"?c:"Dismiss")}const q=!r&&w&&!K&&(H||l);return f.createElement(f.Fragment,null,q&&f.createElement(Lb,{"data-type":"inside",ref:k==null?void 0:k.beforeInsideRef,onFocus:j=>{if(l){const ee=I();ks(i[0]==="reference"?ee[0]:ee[ee.length-1])}else if(k!=null&&k.preserveTabOrder&&k.portalNode)if(W.current=!1,Ob(j,k.portalNode)){const ee=wX()||v;ee==null||ee.focus()}else{var G;(G=k.beforeOutsideRef.current)==null||G.focus()}}}),!K&&$("start"),n,$("end"),q&&f.createElement(Lb,{"data-type":"inside",ref:k==null?void 0:k.afterInsideRef,onFocus:j=>{if(l)ks(I()[0]);else if(k!=null&&k.preserveTabOrder&&k.portalNode)if(d&&(W.current=!0),Ob(j,k.portalNode)){const ee=_X()||v;ee==null||ee.focus()}else{var G;(G=k.afterOutsideRef.current)==null||G.focus()}}}))}function Fb(t){return on(t.target)&&t.target.tagName==="BUTTON"}function $b(t){return l4(t)}function TX(t,e){e===void 0&&(e={});const{open:n,onOpenChange:r,dataRef:i,elements:{domReference:s}}=t,{enabled:o=!0,event:a="click",toggle:l=!0,ignoreMouse:c=!1,keyboardHandlers:d=!0}=e,h=f.useRef(),m=f.useRef(!1);return f.useMemo(()=>o?{reference:{onPointerDown(p){h.current=p.pointerType},onMouseDown(p){p.button===0&&(df(h.current,!0)&&c||a!=="click"&&(n&&l&&(!i.current.openEvent||i.current.openEvent.type==="mousedown")?r(!1,p.nativeEvent):(p.preventDefault(),r(!0,p.nativeEvent))))},onClick(p){if(a==="mousedown"&&h.current){h.current=void 0;return}df(h.current,!0)&&c||(n&&l&&(!i.current.openEvent||i.current.openEvent.type==="click")?r(!1,p.nativeEvent):r(!0,p.nativeEvent))},onKeyDown(p){h.current=void 0,!(p.defaultPrevented||!d||Fb(p))&&(p.key===" "&&!$b(s)&&(p.preventDefault(),m.current=!0),p.key==="Enter"&&r(!(n&&l),p.nativeEvent))},onKeyUp(p){p.defaultPrevented||!d||Fb(p)||$b(s)||p.key===" "&&m.current&&(m.current=!1,r(!(n&&l),p.nativeEvent))}}}:{},[o,i,a,c,d,s,l,n,r])}const IX=Xy["useInsertionEffect".toString()],CX=IX||(t=>t());function Wd(t){const e=f.useRef(()=>{});return CX(()=>{e.current=t}),f.useCallback(function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.current==null?void 0:e.current(...r)},[])}const AX={pointerdown:"onPointerDown",mousedown:"onMouseDown",click:"onClick"},RX={pointerdown:"onPointerDownCapture",mousedown:"onMouseDownCapture",click:"onClickCapture"},PX=t=>{var e,n;return{escapeKeyBubbles:typeof t=="boolean"?t:(e=t==null?void 0:t.escapeKey)!=null?e:!1,outsidePressBubbles:typeof t=="boolean"?t:(n=t==null?void 0:t.outsidePress)!=null?n:!0}};function _4(t,e){e===void 0&&(e={});const{open:n,onOpenChange:r,events:i,nodeId:s,elements:{reference:o,domReference:a,floating:l},dataRef:c}=t,{enabled:d=!0,escapeKey:h=!0,outsidePress:m=!0,outsidePressEvent:p="pointerdown",referencePress:y=!1,referencePressEvent:x="pointerdown",ancestorScroll:E=!1,bubbles:v}=e,g=ep(),w=p4()!=null,_=Wd(typeof m=="function"?m:()=>!1),S=typeof m=="function"?_:m,T=f.useRef(!1),{escapeKeyBubbles:b,outsidePressBubbles:k}=PX(v),R=Wd(O=>{if(!n||!d||!h||O.key!=="Escape")return;const W=g?Zl(g.nodesRef.current,s):[];if(!b&&(O.stopPropagation(),W.length>0)){let L=!0;if(W.forEach(z=>{var H;if((H=z.context)!=null&&H.open&&!z.context.dataRef.current.__escapeKeyBubbles){L=!1;return}}),!L)return}i.emit("dismiss",{type:"escapeKey",data:{returnFocus:{preventScroll:!1}}}),r(!1,VK(O)?O.nativeEvent:O)}),P=Wd(O=>{const W=T.current;if(T.current=!1,W||typeof S=="function"&&!S(O))return;const L=a4(O),z="["+Gc("inert")+"]",H=hn(l).querySelectorAll(z);let K=rt(L)?L:null;for(;K&&!Au(K);){const $=ho(K);if($===hn(l).body||!rt($))break;K=$}if(H.length&&rt(L)&&!UK(L)&&!un(L,l)&&Array.from(H).every($=>!un(K,$)))return;if(on(L)&&l){const $=L.clientWidth>0&&L.scrollWidth>L.clientWidth,q=L.clientHeight>0&&L.scrollHeight>L.clientHeight;let j=q&&O.offsetX>L.clientWidth;if(q&&Ln(L).direction==="rtl"&&(j=O.offsetX<=L.offsetWidth-L.clientWidth),j||$&&O.offsetY>L.clientHeight)return}const fe=g&&Zl(g.nodesRef.current,s).some($=>{var q;return kg(O,(q=$.context)==null?void 0:q.elements.floating)});if(kg(O,l)||kg(O,a)||fe)return;const I=g?Zl(g.nodesRef.current,s):[];if(I.length>0){let $=!0;if(I.forEach(q=>{var j;if((j=q.context)!=null&&j.open&&!q.context.dataRef.current.__outsidePressBubbles){$=!1;return}}),!$)return}i.emit("dismiss",{type:"outsidePress",data:{returnFocus:w?{preventScroll:!0}:$K(O)||zK(O)}}),r(!1,O)});return f.useEffect(()=>{if(!n||!d)return;c.current.__escapeKeyBubbles=b,c.current.__outsidePressBubbles=k;function O(z){r(!1,z)}const W=hn(l);h&&W.addEventListener("keydown",R),S&&W.addEventListener(p,P);let L=[];return E&&(rt(a)&&(L=qs(a)),rt(l)&&(L=L.concat(qs(l))),!rt(o)&&o&&o.contextElement&&(L=L.concat(qs(o.contextElement)))),L=L.filter(z=>{var H;return z!==((H=W.defaultView)==null?void 0:H.visualViewport)}),L.forEach(z=>{z.addEventListener("scroll",O,{passive:!0})}),()=>{h&&W.removeEventListener("keydown",R),S&&W.removeEventListener(p,P),L.forEach(z=>{z.removeEventListener("scroll",O)})}},[c,l,a,o,h,S,p,n,r,E,d,b,k,R,P]),f.useEffect(()=>{T.current=!1},[S,p]),f.useMemo(()=>d?{reference:{onKeyDown:R,[AX[x]]:O=>{y&&(i.emit("dismiss",{type:"referencePress",data:{returnFocus:!1}}),r(!1,O.nativeEvent))}},floating:{onKeyDown:R,[RX[p]]:()=>{T.current=!0}}}:{},[d,i,y,p,x,r,R])}function E4(t){var e;t===void 0&&(t={});const{open:n=!1,onOpenChange:r,nodeId:i}=t,[s,o]=f.useState(null),a=((e=t.elements)==null?void 0:e.reference)||s,l=MK(t),c=ep(),d=Wd((_,S)=>{_&&(m.current.openEvent=S),r==null||r(_,S)}),h=f.useRef(null),m=f.useRef({}),p=f.useState(()=>hX())[0],y=m4(),x=f.useCallback(_=>{const S=rt(_)?{getBoundingClientRect:()=>_.getBoundingClientRect(),contextElement:_}:_;l.refs.setReference(S)},[l.refs]),E=f.useCallback(_=>{(rt(_)||_===null)&&(h.current=_,o(_)),(rt(l.refs.reference.current)||l.refs.reference.current===null||_!==null&&!rt(_))&&l.refs.setReference(_)},[l.refs]),v=f.useMemo(()=>({...l.refs,setReference:E,setPositionReference:x,domReference:h}),[l.refs,E,x]),g=f.useMemo(()=>({...l.elements,domReference:a}),[l.elements,a]),w=f.useMemo(()=>({...l,refs:v,elements:g,dataRef:m,nodeId:i,floatingId:y,events:p,open:n,onOpenChange:d}),[l,i,y,p,n,d,v,g]);return An(()=>{const _=c==null?void 0:c.nodesRef.current.find(S=>S.id===i);_&&(_.context=w)}),f.useMemo(()=>({...l,context:w,refs:v,elements:g}),[l,v,g,w])}function Rg(t,e,n){const r=new Map;return{...n==="floating"&&{tabIndex:-1},...t,...e.map(i=>i?i[n]:null).concat(t).reduce((i,s)=>(s&&Object.entries(s).forEach(o=>{let[a,l]=o;if(a.indexOf("on")===0){if(r.has(a)||r.set(a,[]),typeof l=="function"){var c;(c=r.get(a))==null||c.push(l),i[a]=function(){for(var d,h=arguments.length,m=new Array(h),p=0;p<h;p++)m[p]=arguments[p];return(d=r.get(a))==null?void 0:d.map(y=>y(...m)).find(y=>y!==void 0)}}}else i[a]=l}),i),{})}}function S4(t){t===void 0&&(t=[]);const e=t,n=f.useCallback(s=>Rg(s,t,"reference"),e),r=f.useCallback(s=>Rg(s,t,"floating"),e),i=f.useCallback(s=>Rg(s,t,"item"),t.map(s=>s==null?void 0:s.item));return f.useMemo(()=>({getReferenceProps:n,getFloatingProps:r,getItemProps:i}),[n,r,i])}function b4(t,e){e===void 0&&(e={});const{open:n,floatingId:r}=t,{enabled:i=!0,role:s="dialog"}=e,o=m4();return f.useMemo(()=>{const a={id:r,role:s};return i?s==="tooltip"?{reference:{"aria-describedby":n?r:void 0},floating:a}:{reference:{"aria-expanded":n?"true":"false","aria-haspopup":s==="alertdialog"?"dialog":s,"aria-controls":n?r:void 0,...s==="listbox"&&{role:"combobox"},...s==="menu"&&{id:o}},floating:{...a,...s==="menu"&&{"aria-labelledby":o}}}:{}},[i,s,n,r,o])}const zb=t=>t.replace(/[A-Z]+(?![a-z])|[A-Z]/g,(e,n)=>(n?"-":"")+e.toLowerCase());function Lo(t,e){return typeof t=="function"?t(e):t}function NX(t,e){const[n,r]=f.useState(t);return t&&!n&&r(!0),f.useEffect(()=>{if(!t){const i=setTimeout(()=>r(!1),e);return()=>clearTimeout(i)}},[t,e]),n}function k4(t,e){e===void 0&&(e={});const{open:n,elements:{floating:r}}=t,{duration:i=250}=e,o=(typeof i=="number"?i:i.close)||0,[a,l]=f.useState(!1),[c,d]=f.useState("unmounted"),h=NX(n,o);return An(()=>{a&&!h&&d("unmounted")},[a,h]),An(()=>{if(r)if(n){d("initial");const m=requestAnimationFrame(()=>{d("open")});return()=>{cancelAnimationFrame(m)}}else l(!0),d("close")},[n,r]),{isMounted:h,status:c}}function DX(t,e){e===void 0&&(e={});const{initial:n={opacity:0},open:r,close:i,common:s,duration:o=250}=e,a=t.placement,l=a.split("-")[0],c=f.useMemo(()=>({side:l,placement:a}),[l,a]),d=typeof o=="number",h=(d?o:o.open)||0,m=(d?o:o.close)||0,[p,y]=f.useState(()=>({...Lo(s,c),...Lo(n,c)})),{isMounted:x,status:E}=k4(t,{duration:o}),v=ni(n),g=ni(r),w=ni(i),_=ni(s);return An(()=>{const S=Lo(v.current,c),T=Lo(w.current,c),b=Lo(_.current,c),k=Lo(g.current,c)||Object.keys(S).reduce((R,P)=>(R[P]="",R),{});if(E==="initial"&&y(R=>({transitionProperty:R.transitionProperty,...b,...S})),E==="open"&&y({transitionProperty:Object.keys(k).map(zb).join(","),transitionDuration:h+"ms",...b,...k}),E==="close"){const R=T||S;y({transitionProperty:Object.keys(R).map(zb).join(","),transitionDuration:m+"ms",...b,...R})}},[m,w,v,g,_,h,E,c]),{isMounted:x,styles:p}}function jX({placement:t="bottom"}={}){const[e,n]=f.useState(!1),{context:r,floatingStyles:i,refs:s}=E4({placement:t,open:e,onOpenChange:n,whileElementsMounted:s4,middleware:[YP(10)]}),o=pX(r,{move:!1}),a=_4(r),l=b4(r,{role:"tooltip"}),{getFloatingProps:c,getReferenceProps:d}=S4([o,a,l]);return{isOpen:e,setIsOpen:n,getFloatingProps:c,getReferenceProps:d,floatingStyles:i,refs:s,context:r}}const T4=f.createContext(null),I4=()=>{const t=f.useContext(T4);if(t==null)throw new Error("Popover components must be wrapped in <Popover />");return t};function Va({children:t,...e}){const n=jX({...e});return u.jsx(T4.Provider,{value:n,children:t})}function Ua({children:t,...e}){const{getReferenceProps:n,refs:r,isOpen:i}=I4();return u.jsx("button",{ref:r.setReference,"data-state":i?"open":"closed",...n(e),children:t})}function Wa({children:t,className:e,...n}){const{theme:r}=te(),{context:i,refs:s,getFloatingProps:o,floatingStyles:a,isOpen:l}=I4(),c={container:`${r.type==="dark"?"bg-white/70 text-[#333]":"bg-black/70 text-white"}`};if(l)return u.jsx(w4,{context:i,modal:!1,children:u.jsx("div",{className:`${c.container}  text-[13px] font-semibold px-[6px] py-[3px] rounded-[4px]`,ref:s.setFloating,style:{...a},...o(n),children:t})})}const tw="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABnCAMAAADBqBfIAAAAAXNSR0IB2cksfwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAu5QTFRF+9t4AAAA////+tp4+9t6iWRS/fDGkm1W//35imVT///+imRT/Oah9NN25sRx/eej+91+//78i2ZT+9x7kGtV/vbeiWRS9tZ2+Nd3/fHL+96C/OWd//zz//32/vPS2rlu/vLOjWhU/e/D+9+F//rslXBX/euy/vTXl3NX/vTV+dl3/ems7s10/OGN/vfhlnBQ/Oem/OSa/OKQt5Ri8dB1/N+I/vXaoHta/eu1/vjk/fHJ/vnp/OCK/e26o39b6chyj2lR/e/BimVSiWRS7Mtz/eiqjGdR/eqv//vv/OSYjWdR4b9vzqxp/OOWk21Qi2ZRnXlZ/vnnpoJcv5xl3bxumnNP/OKUimRSimVSkGlRm3ZZimRSq4del3BP1LJrmnJPzKppnXVO2LZtroZMt45Mj2hRqH9MrIJKmXJPqIRdrIhelG1Qn3dPxaNms49hqoJLlG1Qm3NPupFJoXlOnXZPnHVPlG5QlW5QkWtRjmhRjGZSi2ZSn3dOmHFPjWdSnXVOtZJhoXhO/e6948FwvZpk/OGPmXJQqoJJu5djrodFvpVIj2hRl3BPj2lRjGdRsohLkWpRm3NP////jWdRw5lGqIFNpHxPlm9QlG1Qn3dPl3BPsYhNx6Rn0K5qsY5gmHBP//vxkWtR////////zqNJ////////s4pIkGpRl3BQ///+pn1M////ropfmHFQpn5PjmhRmnNPonpOm3VOl3BQxp9JxZlLkmxRwp9lk2xRs4lK////lnBQwplJnXZPkmtQzLqvkmtQ////lW9Q9/Tx+vj2sJN74s+lkmxQ6+Xjo4Rx2c3EspmN2rt4////5sqFwa6k////xZtD5dfDoXhKlnRl////uaCQ+/jy////zKBH////totJ////////4MeV////////1Kc++vfznHdYu5RFn3hOr4dLnXZP8ezp////////vpVD////////mnNP////l3BQkWtRmXJPpH1Np39Q////rINMmnROoHhQyC8s0wAAAPp0Uk5T/wD////3///////9//////////////r///////////////////////////////9o/////////////////////7//4u7//9X////K////iN///////0P/8uyf/+j/Q/8Y/x3/AwKuBg1O//9xDP//C4Q1BRMuK3hWirnn2idLzxf/Cf////86A/8CA7RSqNAIm0v5xQEVFmJqEl0E////WP+kBVcBf7wCkT0VEeP/XgujPCBVfwEClf+OD8pLBTqrwkqTJsneoApf///h6P8d///rAv8E66f//4sCKxNpw/+i1wHWXwIxCyf/sTQKDOoh9G7EZC4NkhEsBY8dBX0AAAe/SURBVHic7ZpnWBNJGMd3E0IIoYQQktACoUZ6C6GDdFEBkd6kSrFixY7KoWfvXRTLnd07z16v9957P73e77z7drshOxOyk82mPPfcPY//j+/svr+Zd2benbIY/i8Iuwf5P0Pe/3Duw0v2REf/dqCh59z3tofcmRO9fkOVUCzhBwergoP5SoE0e2tvZ/Msm0Gubh4qkSo1fU3luQnOMrlc5pwQ4dJyuVslzFk67/bnNoDM6GznSbqaMsMwupzL+1WCkt7FbdZB7uzKF2r2R3ARhGHJXeL5VWt7LlgO2T1lIX8w0yhAp7BxGYKs45Mtg7RGZ0smJphCkOKOrZdmLbYA0jaQJelzZoPQyi9D2rvbXMjymdIyk4EaGTT+ogbzIE8USZqM9zZaCfWC81PNgJypLss1E0E2plG5dQdbyOR54j7UtDAtl9KSAXaQN28JG80NFSXnripUx9AgJx/it1iIICSP550xDZm8QOJiOYPomNXSR7aZgMyo4a+0hkFQJvLWMUO2bVJa1Q5S3D7ebSbI3l3KRmsZRL+czv6aAXKdZ/YURElWu2GjUciyutM2QBDK5F9ZZQTyd3sp+4zILD/pASOQKWKrOx1osHo3ErKjOt5mDCxCdWwVAtJaY7NgkfLjVSAgAzw/GzIwbkbRGhqkrSjDlgwiIyuv0yA94nLbQrjTi84aQCZnddtiGuorVzDfANLDG2tjBoZ1FelBrn37+NFH3/GujFQH2tkSMlYwF0I4Orn5pMbZEiIvvQIhP3OAxqAeTk8qyItxih0fF+kObHZs2jyubjsK4o16FpS6qYGtYJTC398zxV6ngNFarUgPCXcdo6YqkCDsBJAfIcQJBXEDxZHAZs9hkENiuncaSdK0A8gpWJyHgjiA4vuALYUJQspXUeCFXV54g4J8BotC2EI8TUEIudm/IlhMQT6G9nQUxAcB8WcB4XDeffVLCvI2tNqjIIWguBIBCXClFBOeHqBI9nXUxzz5sg5yFNoSUZAJoHg8sCmAzWCs2MUVJLrpUa79MAw5DE2pKIgHKIbTCELoo17kHaXXmj8PaSEfbAEWBxQkFOFwFKJ1ehi9cbHlOy3kxGvQFIh4BQ5XGBoIjkS8gYmSocv3tJBnnoIWVL3SQSmcRhCCqhaGOcGAPaCFdLwAIeG6h9xFXuq0yMpYp5jwEBgaOI0Sgc0dCVE7GEBmvwghCqe8kPQAT0ViVGqhr/4o0SqdDkH24gjIp1rIpLdg2xwdOQyC0wiMuEI0JBb6OTwMyfmGybOeFHRIMhoCh/ipEzrIGywhHnRIKJJRCSP90fBknFT9CWOQoFLBpyqKMiETUVoqeOWLQ8OQ2XUv+SB9Et3qE+ShsAfjtVBEg6DydhxMRM89rctdHdn76UnVN3lUQFJMbBrp1psy+nhRfsBko2cV9xBY5YPPF+sgN/L3jdGrfGpoSlJMZZoX/IoHgjK1IcTNYMLbqQs8YOw94vi/UOuuBfF2ED5BhBnKzldX5gg+KFRAYNsIicaH+x+E1XWzF8kEnRTkUhk3ALYEsSwCPeBtCHHwTElJ8STkrwiNCvLl6CGivN2xXOkcChKtkkXCGRpAh4AqFFCWVA6zHJPzyIiUVy+jIAPKCDuYjA7Sl1SutAqYgES5DodxX/5GCnJX6IfpdX0sDaKm4gCmXpBxgM+oJGo0cOuHwIL7Qkk/Zge/5AoaxJ2qeDIzxDHIPyRWDfOyLDgaruqHNBgWDkaeQxqNMpqqJWVI9FB4BqxIKggnFrDD8h4TpzZM+y5wSYTjZ8QyTAQrt4IGiaWqSrnxErFZDE+rngUhzTl+er3L8aVNFRGZ8ApDV+ShP1HGpFmvtwlqyxokAg+bEk57PNkjKTbQPAKGOQsO6O+05ksSiKaA/FzoZfi8Rbujpuzd+pCTvHFEU8BHwjHJEp+Gkms2XRyxZ1xfS+xL49yM94oFGrGdI3VcSp6rwIyPXN6bqe78r0ZC9i7oDiMGJuh7H/RyyhzlCg232HiFmDx7BMPYgz4hzVV8/lRDyJqtGeRpgXYh55CC3KCaJxflEtwQgjdIyeOCNCIV+o+3xXa+K7+VDmmrqSWPomI8K02+z0booyi8uWoixnKDblrOtTWtKAg+T2zWjQmj+nK240jI8rUa2x10zsfREGK9Omib86hc/jFjR7Y4vo5MYdZLXpo/8kpoBOTIFKUV1xqAMZ3xGB3fO2TdxYZW8bybOBMEX97Ot5ISNo23B2eG4B2/WknpFx540BQEv7qWb8W5qryfF23oEXVxNvWW5ZcosnredVo70FeAxcJ+y64AMzXZFXR/6MvM1meruiy4zOQ2SoqaUQwj17K/L5K0mNsY50Fp73KkN2MXzDtmCrsizGKMU5U8dj/amfH7+Iqlyn7W+ZK7soy36a4xVwyX/n/sWhg8UcaKMbZbnNXTatQT4+8LHb11ktW5phKz3K9MuKECMXDZQXB8WfFCZZcfQ3O4EdNqhUWbZzB6MflLyawl7VXisn2ZiO4JSyhfrRIuKj53xIQPFj/HvN68c0GOOLj+cotLglxXf1nuyv2rNXxhyaWGsyYdsP3NZ81fO2s21PEEAkmwSkX+5SOsKskq7txOu6+2BkJq1uyfbq6Lnjdz5vkpOzfPae64yPrN/9yvV/cgOP4PsP50Fs+e30kAAAAASUVORK5CYII=";function OX({vinylRef:t}){const{playStatus:{isPlaying:e}}=Q(Un);f.useEffect(()=>{const n=t.current;n&&(e?n.style.animationPlayState="running":n.style.animationPlayState="paused")},[e])}function MX({isOpenFullScreen:t,admin:e}){const n=f.useRef(null),{currentSong:r}=Q(Ae);OX({vinylRef:n});const i={songInfoWrapper:`${e?"w-1/4":"w-1/4 "}`,songInfoChild:"flex flex-row"};return u.jsx("div",{className:`${i.songInfoWrapper}  ${t?"hidden":""}`,children:u.jsxs("div",{className:`${i.songInfoChild} ${t?"hidden":""}`,children:[u.jsx("div",{className:e?"w-[46px]":"w-[56px]",children:u.jsx("img",{ref:n,src:r.image_url||tw,className:"rounded-full w-full animate-[spin_8s_linear_infinite]"})}),u.jsxs("div",{className:"ml-2 flex-grow",children:[u.jsx("div",{className:"h-[32px]",children:u.jsx(pf,{className:"leading-[1.5] font-playwriteCU",content:r.name||"Name"})}),u.jsx("div",{className:"h-[20px]",children:u.jsx(pf,{autoScroll:!0,className:"font-[600] opacity-70 leading-[1.2]",content:r.singer||"..."})})]})]})})}function LX({audioEle:t}){const e=f.useRef(!1),{playStatus:{isPlaying:n}}=Q(Un),[r,i]=f.useState(0),[s,o]=f.useState(0),a=f.useRef(),l=c=>{i(0),tn("timer",0),clearInterval(a.current),c&&o(0)};return f.useEffect(()=>{if(e.current&&(console.log("check cd",s,r,n),!!r)){if(!s)o(r),n||t.play();else if(!n)return;return a.current=setInterval(()=>o(c=>c===1?(t.pause(),l(),0):((c===r||c%5===0)&&tn("timer",c-1),c-1)),1e3),()=>{clearInterval(a.current)}}},[n,r]),f.useEffect(()=>{if(!e.current){e.current=!0;const c=si().timer||0;o(c),i(c)}},[]),{countDown:s,isActive:r,handleEndTimer:l,setIsActive:i}}function C4({audioEle:t,variant:e="desktop"}){const{theme:n}=te(),r=f.useRef(null),{countDown:i,isActive:s,handleEndTimer:o,setIsActive:a}=LX({audioEle:t}),l=m=>a(m),c=()=>{var m;s?o(!0):(m=r.current)==null||m.toggle()},d={container:"w-[50px] flex justify-center",button:`rounded-[99px]  hover:bg-${n.alpha} p-[5px]`,itemContainer:"flex justify-between items-center min-h-[30px]",text:"text-base text-[#ccc]"},h=()=>{switch(e){case"desktop":return u.jsx("div",{className:d.container,children:s?u.jsxs(Va,{placement:"top",children:[u.jsx(Ua,{onClick:c,children:u.jsxs("div",{className:"group",children:[u.jsx("div",{className:"text-sm group-hover:hidden",children:Aa(i)}),u.jsx("div",{className:`hidden group-hover:block ${d.button}`,children:u.jsx(Os,{className:"w-6"})})]})}),u.jsx(Wa,{children:"Clear timer"})]}):u.jsxs(Va,{placement:"top",children:[u.jsx(Ua,{onClick:c,className:d.button,children:u.jsx(vT,{className:"w-6"})}),u.jsx(Wa,{children:"Sleep timer"})]})});case"mobile":return u.jsxs("div",{className:`${d.itemContainer}`,children:[u.jsx("p",{className:d.text,children:s?Aa(i):"Sleep timer"}),u.jsx(lf,{size:"thin",className:"bg-white/10",active:!!s,cb:c})]})}};return u.jsxs(u.Fragment,{children:[h(),u.jsx(Wr,{ref:r,variant:"animation",children:u.jsx(_Q,{active:l,close:()=>{var m;return(m=r.current)==null?void 0:m.toggle()}})})]})}function FX({idle:t,audioEle:e,admin:n,isOpenFullScreen:r,setIsOpenFullScreen:i,isOpenSongQueue:s,setIsOpenSongQueue:o}){const{theme:a}=te(),{currentSong:l}=Q(Ae),{playStatus:{isPlaying:c,isWaiting:d}}=Q(Un),h=f.useRef(null),m=zn(),{handleSetVolume:p,isMute:y,handleMute:x,handleWheel:E}=iK(h,e),v=f.useMemo(()=>m.pathname.includes("edit"),[m]),g=()=>{s&&o(!1),i(!0)},w={before:"before:content-[''] before:w-[100%] before:h-[16px] before:absolute before:top-[50%] before:translate-y-[-50%]",wrapper:`border-${a.alpha} fixed bottom-0 w-full border-t transition-transform z-50 px-10 ${n?"h-[60px]":"h-[90px]"}`,container:"flex flex-row gap-[10px] h-full items-center",controlWrapper:"flex max-w-[450px] flex-grow",controlWrapperChild_1:`${r?"max-w-[600px] flex-col-reverse pb-[10px]":"flex-col justify-center"}`,controlWrapperChild_2:`${!l.song_url&&"disable"}`,right:`${n?"w-1/4":"w-1/4 "} flex items-center justify-end`,volumeLineBase:"ml-1 w-full relative h-[4px] cursor-pointer rounded-full",volumeLineCurrent:"absolute left-0 top-0 h-full w-full ",blurBg:`bg-opacity-[0.8] backdrop-blur-[15px] z-[-1] absolute inset-0 ${a.bottom_player_bg}`};return u.jsxs("div",{className:`${w.wrapper} ${r&&"border-transparent"} ${v&&"translate-y-[100%] "} bg-transparent`,children:[u.jsx("div",{className:`${w.blurBg} ${r?"opacity-0 transition-opacity delay-[.2s]":""}`}),u.jsxs("div",{className:`${w.container} ${r?"justify-center text-white":"justify-between"} ${t&&"transition-opacity duration-[.3s] opacity-0"}`,children:[u.jsx(MX,{isOpenFullScreen:r,admin:n}),u.jsx("div",{className:` ${w.controlWrapper} ${n?"":w.controlWrapperChild_1}  ${w.controlWrapperChild_2}`,children:f.useMemo(()=>u.jsx(A4,{admin:n,audioEle:e,idle:!1,isOpenFullScreen:r}),[c,r,d])}),u.jsxs("div",{className:`${w.right}  ${r?"hidden":""}`,children:[u.jsxs("div",{className:"flex flex-grow items-center max-w-[120px] mr-2",children:[u.jsx("button",{onWheel:E,onClick:()=>x(),children:y?u.jsx(cO,{className:"w-6"}):u.jsx(oO,{className:"w-6"})}),u.jsx("div",{onClick:_=>p(_),ref:h,className:`${w.volumeLineBase} ${w.before}`,style:{background:"#e1e1e1"}})]}),!n&&u.jsxs("div",{className:`flex items-center ${l.name?"":"disable"}`,children:[u.jsxs(Va,{placement:"top",children:[u.jsx(Ua,{onClick:g,className:` ml-1 rounded-[99px]  hover:bg-${a.alpha}  p-[5px]`,children:u.jsx(uj,{className:"w-6"})}),u.jsx(Wa,{children:"Fullscreen mode"})]}),u.jsxs(Va,{placement:"top",children:[u.jsx(Ua,{onClick:()=>o(!s),className:` hover:bg-${a.alpha} rounded-md p-[5px]`,children:u.jsx(rO,{className:"w-6"})}),u.jsx(Wa,{children:"Queue"})]}),u.jsx("div",{className:`w-[2px] h-[26px] mx-3 bg-${a.alpha}`}),u.jsx(C4,{variant:"desktop",audioEle:e})]})]})]})]})}const $X=f.memo(FX);function zX(t,e){f.useEffect(()=>{if(t)return t(),window.addEventListener("resize",t),()=>{window.removeEventListener("resize",t)}},[...e])}function BX({audioEle:t,isOpenFullScreen:e,timelineRef:n,currentTimeRef:r,remainingTimeRef:i}){const s=We(),{theme:o}=te(),{user:a}=mt(),{queueSongs:l}=Q(xi),{playStatus:{isPlaying:c,isRepeat:d,isShuffle:h,isCrossFade:m}}=Q(Un),{currentSong:p}=Q(Ae),{currentPlaylist:y}=Q(wi),[x,E]=f.useState(!1),[v,g]=f.useState(0),w=f.useRef(!0),_=f.useRef(0),S=f.useRef(0),T=f.useRef(),b=f.useRef(0),k=f.useRef(0),R=f.useRef(0),P=f.useRef(o.content_code),O=f.useRef(!1),W=f.useRef(!0),L=f.useRef(),z=zn(),{setErrorToast:H}=xn(),K=f.useMemo(()=>z.pathname.includes("edit"),[z]);zX(()=>{var me;T.current=(me=n.current)==null?void 0:me.offsetWidth},[e]);const I=()=>{try{if(t==null||t.play(),!a)return;W.current&&(m&&(t.volume=0),W.current=!1)}catch{}},$=()=>{t==null||t.pause()},q=me=>l[me],j=()=>{s(or({isPlaying:!1})),L.current&&clearInterval(L.current)},G=()=>{w.current=!1,s(or({isPlaying:!0,isWaiting:!1,isError:!1}))},ee=()=>{E(!1),w.current||tn("duration",0),n.current&&r.current&&i.current&&(r.current.innerText="0:00",i.current.innerText="0:00",n.current.style.background="#e1e1e1")},ie=f.useCallback(me=>{const et=me.target;if(T.current&&S.current){const at=et.getBoundingClientRect(),Ao=(me.clientX-at.left)/T.current,cl=Math.ceil(Ao*S.current);if(t){const tp=t.currentTime;if(b.current&&Math.abs(tp-b.current)<1&&Math.abs(cl-b.current)<1){console.log("no seek");return}t.currentTime=cl,b.current=cl}}},[e,p,c]),De=f.useCallback(()=>{let me=_.current+1,et;me<l.length?et=l[me]:(me=0,et=l[0]),s(Nn({...et,currentIndex:me,song_in:p.song_in}))},[p,l]),Se=f.useCallback(()=>{let me=_.current-1,et;me>=0?et=l[me]:(et=l[l.length-1],me=l.length-1),s(Nn({...et,currentIndex:me,song_in:p.song_in}))},[p,l]),je=me=>{const at=si().volume||1;if(me<=2){const wn=me/2*at;t.volume=wn}else if(me<k.current){t.volume!=at&&(t.volume=at);return}if(me>=k.current){const wn=(S.current-me)/2*at;t.volume=wn}},Ot=()=>{if(!t){console.log("auto ele is undefined when update time");return}const me=t==null?void 0:t.currentTime,et=n.current;if(S.current&&me&&et){const at=me/(S.current/100);et.style.background=`linear-gradient(to right, ${P.current} ${at}%, #e1e1e1 ${at}%, #e1e1e1 100%)`}r.current&&(r.current.innerText=Aa(me)||"00:00"),m&&je(me)},Mt=()=>{const et=si().volume||1;if(t.volume=et,d==="one")return I();if(h){let at=_.current;for(;at===_.current;)at=Math.floor(Math.random()*l.length);const wn=q(at);return s(Nn({...wn,currentIndex:at,song_in:p.song_in}))}return _.current===l.length-1&&(d==="all"?O.current=!1:O.current=!0),De()},Hr=()=>{var Ao;if(!t)return;const me=i.current,et=t.duration;E(!0);const at=si(),wn=at.current;if(S.current=et,me.innerText=Aa(et),T.current=(Ao=n.current)==null?void 0:Ao.offsetWidth,k.current=et-3,(!w.current||!wn)&&tn("current",p),O.current){O.current=!1,s(or({isWaiting:!1,isPlaying:!1}));return}if((K||w.current)&&(s(or({isWaiting:!1,isPlaying:!1})),w.current)){if(w.current=!1,wn&&wn.id===p.id){t.currentTime=at.duration||0,Ot();return}console.log("play"),I()}I()},Co=()=>{g(Math.random())};return f.useEffect(()=>{if(!t){console.log("Audio element is undefined in use control");return}return t.addEventListener("error",Co),t.addEventListener("pause",j),t.addEventListener("playing",G),()=>{t.removeEventListener("error",Co),t.removeEventListener("pause",j),t.removeEventListener("playing",G)}},[]),f.useEffect(()=>{v&&(w.current||p.name&&(l.length>1?(De(),H({message:"Có lỗi do đường truyền mạng"})):s(or({isWaiting:!1,isError:!0}))))},[v]),f.useEffect(()=>{if(!t||!p.name){s(or({isWaiting:!1,isPlaying:!1}));return}return $(),s(or({isWaiting:!0,isError:!1,isPlaying:!1})),t.src=p.song_url,_.current=p.currentIndex,p.name&&(document.title=`${p.name} - ${p.singer}`),()=>{ee(),clearInterval(L.current),W.current=!0}},[p.id+p.song_in+p.currentIndex]),f.useEffect(()=>{if(!p.name)return;let me=`${p.name} - ${p.singer}`;!c&&y.name&&p.song_in.includes(y.id)&&(me=`${y.name}`),document.title=me},[c]),f.useEffect(()=>{if(t)return t==null||t.addEventListener("ended",Mt),()=>t==null?void 0:t.removeEventListener("ended",Mt)},[d,h,p.song_in,l]),f.useEffect(()=>(t.addEventListener("timeupdate",Ot),()=>t.removeEventListener("timeupdate",Ot)),[m]),f.useEffect(()=>{P.current=o.content_code,c||Ot()},[o]),f.useEffect(()=>{if(t)return K&&c&&$(),t.addEventListener("loadedmetadata",Hr),()=>{t.removeEventListener("loadedmetadata",Hr)}},[K,p.id,m]),f.useEffect(()=>(R.current=t.volume,c&&(L.current=setInterval(()=>{tn("duration",t.currentTime.toFixed(1))},3e3)),()=>clearInterval(L.current)),[c]),{handleNext:De,handlePrevious:Se,handleSeek:ie,play:I,pause:$,isLoaded:x}}function A4({audioEle:t,admin:e,isOpenFullScreen:n}){const r=We(),{theme:i}=te(),{queueSongs:s}=Q(xi),{playStatus:{isPlaying:o,isRepeat:a,isShuffle:l,isError:c}}=Q(Un),{currentSong:d}=Q(Ae),h=f.useRef(null),m=f.useRef(null),p=f.useRef(null),{handleNext:y,handlePrevious:x,handleSeek:E,play:v,pause:g,isLoaded:w}=BX({audioEle:t,isOpenFullScreen:n,admin:e,timelineRef:h,currentTimeRef:m,remainingTimeRef:p}),_=f.useCallback(()=>{o?g():v()},[o]),S=()=>{let k;switch(a){case"no":k="one";break;case"one":k="all";break;case"all":k="no";break;default:k="no"}tn("isRepeat",k),r(or({isRepeat:k}))},T=()=>{const k=!l;r(or({isShuffle:k})),tn("isShuffle",k)},b={button:"p-1",buttonsContainer:"w-full flex justify-center items-center space-x-5 mb-5 sm:mb-0",progressContainer:`flex w-full flex-row items-center mb-2 ${e?"h-full":""}`,processLineBase:"h-[4px] flex-grow relative cursor-pointer rounded-[99px] ",processLineCurrent:`absolute left-0 rounded-l-[99px] top-0 h-full ${i.content_bg}`,currentTime:"opacity-60 text-[14px] font-semibold",duration:"text-[14px] font-semibold",icon:"w-10 sm:w-7",before:"before:content-[''] before:w-[100%] before:h-[16px] before:absolute before:top-[50%] before:translate-y-[-50%]"};return u.jsxs(u.Fragment,{children:[u.jsx("div",{className:`${b.buttonsContainer}`,children:!e&&u.jsxs(u.Fragment,{children:[u.jsxs("button",{disabled:s.length<=1,className:`relative ${b.button} ${a!=="no"&&i.content_text}`,onClick:S,children:[u.jsx(RD,{className:b.icon}),u.jsx("span",{className:"absolute font-bold text-[12px] font-playwriteCU top-1/2 left-1/2 -translate-x-[50%] -translate-y-[50%] ",children:d.name&&(a==="one"?"1":a==="all"?"--":"")})]}),u.jsx("button",{disabled:s.length<=1,className:b.button,onClick:()=>x(),children:u.jsx(UD,{className:b.icon})}),u.jsx(Sb,{handlePlayPause:_}),u.jsx("button",{disabled:s.length<=1,className:`${b.button}`,onClick:()=>y(),children:u.jsx(wT,{className:b.icon})}),u.jsx("button",{disabled:s.length<=1,className:`${b.button} ${l&&i.content_text}`,onClick:T,children:u.jsx(LD,{className:b.icon})})]})}),u.jsxs("div",{className:`${b.progressContainer} ${c?"disable":""}`,children:[u.jsx("div",{className:"w-[36px]",children:t&&u.jsx("span",{ref:m,className:`${b.currentTime}`,children:"00:00"})}),u.jsx("div",{ref:h,onClick:k=>E(k),className:`${b.processLineBase} ${!w&&"disable"}  ${b.before}`}),u.jsx("div",{className:"w-[36px] text-right pl-[5px]",children:t&&u.jsx("span",{ref:p,className:b.duration,children:"00:00"})}),e&&u.jsx("div",{className:"flex items-center",children:u.jsx(Sb,{handlePlayPause:_})})]})]})}function Bb(t,e){const n=f.useRef(),[r,i]=f.useState(0),[s,o]=f.useState(0);return f.useEffect(()=>{r&&(n.current=setTimeout(()=>n.current=void 0,e))},[s,zs]),f.useEffect(()=>{n.current||(t(),o(Math.random()*10))},[r]),()=>i(Math.random()*10)}function VX({placement:t="bottom",isOpenFromParent:e,setIsOpenFromParent:n}={}){const[r,i]=f.useState(!1),{context:s,floatingStyles:o,refs:a}=E4({placement:t,open:e||r,onOpenChange:n||i,whileElementsMounted:s4,middleware:[YP(6)]}),l=TX(s),c=_4(s,{escapeKey:!1}),d=b4(s),{isMounted:h,styles:m}=DX(s,{duration:150,initial:{opacity:0,transform:"scale(0.8)"},close:{opacity:0,transform:"scale(0.8)"},open:{opacity:1,transform:"scale(1)"},common:({side:x})=>({transformOrigin:{top:"bottom",bottom:"top",left:"right",right:"left"}[x]})}),{getFloatingProps:p,getReferenceProps:y}=S4([l,c,d]);return{isOpen:e||r,setIsOpen:n||i,getFloatingProps:p,getReferenceProps:y,floatingStyles:o,refs:a,context:s,styles:m,isMounted:h}}const R4=f.createContext(null),P4=()=>{const t=f.useContext(R4);if(t==null)throw new Error("Popover components must be wrapped in <Popover />");return t};function mo({children:t,...e}){const n=VX({...e});return u.jsx(R4.Provider,{value:n,children:t})}function po({children:t,className:e,asChild:n=!1,...r}){const{getReferenceProps:i,refs:s,isOpen:o}=P4();return n&&f.isValidElement(t)?f.cloneElement(t,i({ref:s.setReference,...r,...t.props,"data-state":o?"open":"closed"})):u.jsx("button",{type:"button",ref:s.setReference,"data-state":o?"open":"closed",className:`${e??""}`,...i(r),children:t})}function go({children:t,className:e,...n}){const{context:r,refs:i,getFloatingProps:s,floatingStyles:o,styles:a}=P4(),{isMounted:l,status:c}=k4(r);return u.jsx(u.Fragment,{children:l&&u.jsx(w4,{context:r,modal:!1,children:u.jsx("div",{ref:i.setFloating,className:`${e||"z-[20]"}`,style:{...o},...s(n),"data-status":c,children:u.jsx("div",{style:{...a},children:t})})})})}function N4({audioEle:t}){const{theme:e,isOnMobile:n}=te(),r=We(),{playStatus:{lyricSize:i,songBackground:s,songImage:o}}=Q(Un),a=c=>{r(or({lyricSize:c})),tn("lyricSize",c)},l={disableBtn:"bg-white/10 bg-opacity-20",lyricSizeBtn:`group/text !hover:brightness-100 font-[600] h-[30px] w-[30px] sm:h-[26px] sm:w-[26px] relative ${e.content_hover_bg}`,itemContainer:"flex justify-between items-center min-h-[30px]",text:"text-base text-[#ccc]"};return u.jsx(u.Fragment,{children:u.jsx("div",{className:"w-[240px] sm:w-[220px]",children:u.jsxs(_o,{variant:"default",color:"black",className:"space-y-[6px] text-white",theme:e,children:[u.jsxs("div",{className:l.itemContainer,children:[u.jsx("p",{className:l.text,children:"Lyric size"}),u.jsxs("div",{className:"flex space-x-[8px]",children:[u.jsx(X,{onClick:()=>a("small"),variant:"circle",size:"clear",className:`${i==="small"?e.content_bg:l.disableBtn} ${l.lyricSizeBtn}`,children:u.jsx("h1",{className:"leading-[1] text-[11px]",children:"A"})}),u.jsx(X,{onClick:()=>a("medium"),variant:"circle",size:"clear",className:`${i==="medium"?e.content_bg:l.disableBtn} ${l.lyricSizeBtn}`,children:u.jsx("h1",{className:"leading-[1] text-[13px]",children:"A"})}),u.jsx(X,{onClick:()=>a("large"),variant:"circle",size:"clear",className:`${i==="large"?e.content_bg:l.disableBtn} ${l.lyricSizeBtn}`,children:u.jsx("h1",{className:"leading-[1] text-[15px]",children:"A"})})]})]}),u.jsxs("div",{className:`${l.itemContainer}`,children:[u.jsx("p",{className:l.text,children:"Song background"}),u.jsx(lf,{size:"thin",className:"bg-white/10",active:s,cb:()=>r(Eb({variant:"songBackground"}))})]}),!n&&u.jsxs("div",{className:`${l.itemContainer}`,children:[u.jsx("p",{className:l.text,children:"Song image"}),u.jsx(lf,{size:"thin",className:"bg-white/10",active:o,cb:()=>r(Eb({variant:"songImage"}))})]}),u.jsx(C4,{audioEle:t,variant:"mobile"})]})})})}function UX({isOpenFullScreen:t,setIsOpenFullScreen:e,idle:n,audioEle:r}){const i=We(),{theme:s}=te(),{currentSong:o}=Q(Ae),{queueSongs:a}=Q(xi),{playStatus:{songImage:l}}=Q(Un),[c,d]=f.useState("Lyric"),h=f.useRef(null),m=f.useRef(null),p=f.useRef(null),y=vn();UP({bgRef:h,currentSong:o}),GG({containerRef:m,songItemRef:p,isOpenFullScreen:t,idle:n});const x=Bb(()=>g("next"),200),E=Bb(()=>g("previous"),200),v=(b,k)=>{o.id!==b.id&&i(Nn({...b,currentIndex:k,song_in:o.song_in}))},g=(b="next")=>{const k=m.current;k.style.scrollBehavior="smooth",b==="next"?k.scrollLeft+=500:b==="previous"&&(k.scrollLeft-=500)},w=()=>{e(!1),setTimeout(()=>{y(`/mysongs/edit/${o.id}`)},300)},_={button:`h-[35px] w-[35px] bg-white/10 rounded-[99px] hover:scale-[1.05] transition-transform ${s.content_hover_bg}`,mainContainer:`fixed inset-0 z-50 overflow-hidden text-white bg-zinc-900
    } transition-transform duration-[.7s] linear delay-100`,bg:"-z-10 bg-no-repeat bg-cover bg-center blur-[50px]",overplay:"bg-zinc-900 bg-opacity-60 bg-blend-multiply",absoluteFull:"absolute h-[100vh] w-[100vw] inset-0",headerWrapper:"py-[20px] px-[40px] w-full",header:"relative flex",headerCta:"absolute h-full flex items-center",contentContainer:"h-[calc(100%-120px)] relative overflow-hidden",songsListTab:" relative h-full no-scrollbar flex items-center flex-row overflow-auto scroll-smooth px-[calc(50%-350px/2)]",absoluteButton:`absolute top-[50%] -translate-y-[50%] p-[8px] bg-white/30 rounded-full ${s.content_hover_bg}`,songNameSinger:"relative text-center",lyricTabContainer:"px-[40px] min-[1536px]:container min-[1536px]:mx-auto min-[1536px]:px-[200px] h-full flex items-center justify-center flex-row",fadeTransition:"opacity-0 transition-opacity duration-[.3s]",before:"before:content-[''] before:w-[50px] before:h-[10px] before:absolute before:bottom-[-7px] ",logo:"animate-[spin_8s_linear_infinite] w-[46px] mr-[10px]"},S=f.useMemo(()=>{if(o.id&&a.length)return a.map((b,k)=>{const R=k===o.currentIndex;return R?u.jsx(Pg,{ref:p,classNames:"active",hasTitle:!0,onClick:()=>v(b,k),active:R,data:b},k):u.jsx(Pg,{idleClass:`${!R&&n?_.fadeTransition:""}`,hasTitle:!0,active:R,data:b,onClick:()=>v(b,k)},k)})},[o,a,n]),T=u.jsxs("div",{className:_.lyricTabContainer,children:[l&&u.jsx(Pg,{active:!0,data:o}),u.jsx(j4,{className:`w-full ml-[40px] h-full ${!l&&"text-center"}`,audioEle:r,isOpenFullScreen:t&&c==="Lyric",active:c==="Lyric"})]});return u.jsxs("div",{className:`${_.mainContainer}  ${t?"translate-y-0":"translate-y-full"}`,children:[u.jsx("div",{ref:h,className:`${_.absoluteFull} ${_.bg}`}),u.jsx("div",{className:`${_.absoluteFull} ${_.overplay}`}),u.jsxs("div",{className:"h-[calc(100vh-90px)]",children:[u.jsx("div",{className:_.headerWrapper,children:u.jsxs("div",{className:_.header,children:[n&&u.jsxs("div",{className:`${_.headerCta} left-0`,children:[u.jsx("img",{className:`${_.logo}`,src:tw,alt:""}),c==="Lyric"&&u.jsxs("p",{className:`${_.songNameSinger}`,children:[o.name," -"," ",u.jsx("span",{className:"opacity-50",children:o.singer})]})]}),u.jsx(F4,{inFullScreen:!0,activeTab:c,setActiveTab:d,className:`${n&&_.fadeTransition}`,tabs:["Songs","Karaoke","Lyric"],render:b=>b}),u.jsxs("div",{className:`${_.headerCta} right-0 gap-[10px] ${n&&_.fadeTransition}`,children:[o.by!=="admin"&&c==="Lyric"&&u.jsxs(Va,{placement:"bottom",children:[u.jsx(Ua,{onClick:()=>w(),className:`p-[8px] ${_.button}`,children:u.jsx(DG,{})}),u.jsx(Wa,{children:"Lyric"})]}),u.jsxs(mo,{placement:"bottom-end",children:[u.jsx(po,{className:`${_.button} p-[8px]`,children:u.jsx(RG,{})}),u.jsx(go,{className:"z-[99]",children:u.jsx(N4,{audioEle:r})})]}),u.jsxs(Va,{placement:"bottom",children:[u.jsx(Ua,{onClick:()=>e(!1),className:`p-[4px] ${_.button}`,children:u.jsx(EG,{})}),u.jsx(Wa,{children:"Close"})]})]})]})}),u.jsxs("div",{className:_.contentContainer,children:[u.jsx("div",{ref:m,className:`song-list-container ${_.songsListTab} ${c!=="Songs"?"opacity-0":"opacity-100"}`,children:S}),c==="Songs"&&!n&&u.jsxs(u.Fragment,{children:[u.jsx(X,{hover:"scale",size:"clear",onClick:()=>E(),className:`${_.absoluteButton} left-[20px]`,children:u.jsx(zP,{className:"w-[30px]"})}),u.jsx(X,{hover:"scale",size:"clear",onClick:()=>x(),className:`${_.absoluteButton} right-[20px]`,children:u.jsx(IG,{className:"w-[30px]"})})]}),u.jsx("div",{className:`absolute inset-0 z-20 ${c==="Lyric"?"":"hidden"}`,children:T}),u.jsx("div",{className:`absolute inset-0 z-20 ${c==="Karaoke"?"":"hidden"}`,children:u.jsx("h1",{className:"text-center font-semibold opacity-60 relative top-[50%]",children:"Coming soon..."})})]}),t&&c==="Lyric"&&!n&&u.jsxs("p",{className:`pt-[20px] ${_.songNameSinger} ${n&&_.fadeTransition}`,children:[o.name," -"," ",u.jsx("span",{className:"opacity-50",children:o.singer})]})]})]})}const WX=f.memo(UX),HX="/HD-MP3/assets/tutorial1-1bb11af6.png",qX="/HD-MP3/assets/tutorial2-2363d450.png";function D4({audioRef:t,theme:e,song:n,admin:r,lyric:i}){const{userSongs:s,setUserSongs:o}=ot(),[a,l]=f.useState(!1),[c,d]=f.useState(!1),[h,m]=f.useState(i?i.base:""),[p,y]=f.useState([]),[x,E]=f.useState(i?i.real_time:[]),[v,g]=f.useState(!1),[w,_]=f.useState(1),[S,T]=f.useState(!1),[b,k]=f.useState(""),[R,P]=f.useState(x?x.length:0),[O,W]=f.useState(h||""),[L,z]=f.useState(!1),H=f.useRef(!0),K=f.useRef(null),fe=f.useRef(0),I=f.useRef(0),$=f.useRef("smooth"),q=f.useRef(null),{setSuccessToast:j,setErrorToast:G}=xn(),ee=vn(),ie=f.useMemo(()=>x.length>=p.length,[p,x,c]),De=f.useMemo(()=>x.length===p.length-1,[p,x,c]),Se=f.useMemo(()=>c&&!!p.length&&!ie,[ie,p,c]),je=()=>{var se;return(se=q.current)==null?void 0:se.toggle()},Ot=f.useMemo(()=>!!p.length,[p]),Mt=()=>{const se=t.current;se&&(se.play(),l(!0),d(!0))},Hr=()=>{const se=t.current;se&&(se.pause(),l(!1))},Co=se=>{const be=t.current;be&&(be.playbackRate=se,_(se)),g(!1)},me=()=>{m(O),je()},et=se=>{const be=t.current;be&&(be.currentTime=se)},at=f.useCallback(()=>{if(!p.length)return;const se=t.current;if(!se||ie||I.current==+se.currentTime.toFixed(1))return;De?fe.current=+se.duration.toFixed(1):fe.current=+se.currentTime.toFixed(1);const be=p[R],Ru={start:I.current,text:be,end:fe.current};I.current=fe.current,E([...x,Ru]),P(R+1)},[p,R]),wn=()=>{if(R<=0)return;if(t.current){I.current=x[R-1].start,fe.current=0;const be=x.slice(0,R-1);E(be),P(R-1)}},Ao=se=>{const be=[...s],Ru=LF(se,be);if(Ru==null){G({message:"No song found"}),T(!1);return}return o(be),console.log("setActuallySongs"),Ru},cl=async()=>{try{T(!0),Hr(),await Jn({collection:"lyrics",data:{real_time:x,base:h},id:n.id}),await Jn({collection:"songs",data:{lyric_id:n.id},id:n.id}),j({message:"Add lyrics successful"}),z(!1)}catch(se){console.log({message:se})}finally{T(!1)}},tp=async()=>{try{T(!0),await Jn({collection:"songs",data:{lyric_id:""},id:n.id}),await Hc({collection:"lyrics",id:n.lyric_id}),j({message:"Delete lyric successful"});const se={...n,lyric_id:""};if(!Ao(se))return;np()}catch(se){console.log(se)}finally{T(!1)}},sw=()=>{Hr(),at()},ow=se=>{const be=t.current;se==="next"?be.currentTime+=2:be.currentTime-=2},U4=()=>{L?k("confirm-navigate"):np()},np=()=>ee(r?"/dashboard":"/mysongs");f.useEffect(()=>{if(h){const se=h.split(/\r?\n/).filter(be=>be);y(se)}p.length&&H.current&&(H.current=!1),console.log("check firstTimeRender",H.current)},[h]),f.useEffect(()=>{const se=t.current;if(se){if(x.length){const be=x[x.length-1].end;se&&(se.currentTime=be,I.current=be)}return se.addEventListener("ended",sw),()=>{se.removeEventListener("ended",sw)}}},[]),f.useEffect(()=>{if(!L){if(!i){z(!0);return}(i.real_time!==x||i.base!=h)&&z(!0)}},[h,x]),f.useEffect(()=>{if(!L)return;const se=be=>{be.preventDefault()};return window.addEventListener("beforeunload",se),()=>{window.removeEventListener("beforeunload",se)}},[L]);const W4=`${e.type==="light"?"text-[#333]":"text-white"}`,lt={section:`bg-${e.alpha} p-[10px] rounded-[12px]`,row:"flex no-scrollbar",col:"flex-grow flex flex-col gap-[10px]",formGroup:"flex flex-col gap-[5px] flex-grow",label:"text-md font-[500]",button:`${e.content_bg} rounded-full font-[500] text-white text-[14px] px-[10px]`,icon:"h-[20px] w-[20px]",lyricBox:"list-none h-full px-[10px] max-[549px]:w-[100%] pb-[20%] ",listItem:"h-[34px] w-[34px] text-[14px]",changeSpeedBtn:"inline-flex items-center hover:brightness-90 px-[20px] py-[5px] rounded-full text-white text-[14px]",ctaContainer:"flex justify-between space-x-[10px] mb-[20px]",getActiveClass:se=>se?e.content_bg:`bg-${e.alpha}`},H4=f.useMemo(()=>{switch(b){case"":return u.jsx(u.Fragment,{});case"tutorial":return u.jsxs(u.Fragment,{children:[u.jsx(_s,{title:"Tutorial",close:je}),u.jsxs("div",{className:"h-[500px] max-h-[75vh] overflow-y-auto no-scrollbar",children:[u.jsx("h1",{className:"font-semibold mb-[12px]",children:"Phím chắc năng:"}),u.jsx("img",{className:"w-full border rounded-[16px]",src:qX,alt:""}),u.jsx("br",{}),u.jsx("h1",{className:"font-semibold mb-[12px]",children:"Cách thêm lời bài hát:"}),u.jsx("img",{className:"w-full border rounded-[16px]",src:HX,alt:""})]})]});case"add-base-lyric":return u.jsxs(u.Fragment,{children:[u.jsx("textarea",{ref:K,value:O,onChange:se=>W(se.target.value),className:"w-full rounded-[4px] mb-[10px] min-h-[50vh] bg-transparent border p-[10px]"}),u.jsx(X,{variant:"primary",onClick:me,className:lt.button,children:"Ok"})]});case"delete-lyric":return u.jsx(zr,{loading:S,label:"Delete playlist ?",theme:e,callback:tp,close:je});case"confirm-navigate":return u.jsx(zr,{loading:S,label:"Your change not save",theme:e,buttonLabel:"Close and don't save",callback:np,close:je})}},[b,O]),q4=u.jsxs("div",{className:`${lt.ctaContainer} ${W4}`,children:[u.jsxs("div",{className:"left flex flex-wrap gap-[10px]",children:[u.jsx("button",{onClick:()=>k("add-base-lyric"),className:lt.button,children:h?"Change lyric":"Add lyric"}),u.jsxs(mo,{isOpenFromParent:v,setIsOpenFromParent:g,placement:"bottom-start",children:[u.jsxs(po,{className:`${lt.button} ${lt.changeSpeedBtn}`,children:[w,"x"]}),u.jsx(go,{children:u.jsx(_o,{variant:"thin",theme:e,children:u.jsxs("div",{className:"flex justify-center gap-[8px]",children:[u.jsx(X,{variant:"circle",onClick:()=>Co(1),className:`${lt.getActiveClass(w===1)} ${lt.listItem}`,children:"1x"}),u.jsx(X,{variant:"circle",onClick:()=>Co(1.2),className:`${lt.getActiveClass(w===1.2)} ${lt.listItem}`,children:"1.2x"}),u.jsx(X,{variant:"circle",onClick:()=>Co(1.5),className:`${lt.getActiveClass(w===1.5)} ${lt.listItem}`,children:"1.5x"})]})})})]}),a?u.jsx(X,{variant:"primary",onClick:Hr,className:lt.button+(c?"":"disable"),children:"Pause"}):u.jsx(X,{variant:"primary",onClick:Mt,className:lt.button+(a||!Ot?"disable":""),children:"Play"}),u.jsx(X,{variant:"primary",onClick:at,className:lt.button+(!Se&&"disable"),children:u.jsx(zi,{className:"w-[16px]"})}),u.jsx(X,{variant:"primary",onClick:wn,className:lt.button+(!x.length||!p.length?"disable":""),children:u.jsx(ST,{className:"w-[16px]"})}),u.jsxs(X,{variant:"primary",onClick:()=>ow("prev"),className:lt.button+(!c||!p.length?"disabele":""),children:[u.jsx(QD,{className:"w-[16px] mr-[5px]"}),"2s"]}),u.jsxs(X,{variant:"primary",onClick:()=>ow("next"),className:lt.button+(!c||!p.length?"disabele":""),children:["2s",u.jsx(ZD,{className:"w-[16px] ml-[5px]"})]})]}),u.jsx("button",{onClick:()=>k("tutorial"),children:u.jsx(eO,{className:"w-[20px]"})})]});return u.jsxs("div",{className:`${S?"disable":""}`,children:[u.jsxs("button",{onClick:U4,className:`inline-flex text-[20px] font-bold mb-[14px] ${e.content_hover_text}`,children:[u.jsx(sj,{className:"w-[25px]"}),u.jsx("span",{className:"ml-[12px]",children:n.name})]}),q4,u.jsxs("div",{className:`${lt.row} bg-${e.alpha} rounded-[12px] pt-[10px] mb-[0] h-[55vh] min-h-[200px] overflow-auto`,children:[u.jsx("div",{className:lt.lyricBox+"w-[50%]",children:p.length?u.jsx(u.Fragment,{children:p.map((se,be)=>u.jsx(BP,{inUpload:!0,scrollBehavior:$,className:"pb-[30px] leading-[1.2] mr-[24px]",active:be===R,done:be!=R,children:se},be))}):u.jsx("h1",{children:"Base lyric..."})}),u.jsx("div",{className:lt.lyricBox+" border-none w-[50%]",children:!!(x!=null&&x.length)&&x.map((se,be)=>u.jsx(dK,{handleSetTime:et,lyric:se,theme:e,index:be,realTimeLyrics:x,setRealTimeLyrics:E},be))})]}),u.jsx(X,{className:`${e.content_bg} ${L?"":"disable"} text-[14px] rounded-full mt-[20px]`,variant:"primary",onClick:cl,children:"Save"}),u.jsx(X,{className:"bg-red-500 text-[#fff] text-[14px] font-bold ml-[12px] rounded-full mt-[20px]",variant:"primary",onClick:()=>k("delete-lyric"),children:"Delete"}),u.jsx(Wr,{variant:"animation",className:"w-[700px] max-w-[calc(100vw-40px)]",children:H4})]})}const j4=({audioEle:t,className:e,isOpenFullScreen:n,active:r})=>{const{playStatus:{lyricSize:i}}=Q(Un),[s,o]=f.useState(0),a=f.useRef("instant"),l=f.useRef(null),{currentSong:c}=Q(Ae),d=f.useRef(0),{loading:h,songLyric:m}=WG({audioEle:t,isOpenFullScreen:n}),p=f.useCallback(()=>{const v=t.currentTime;if(o(v),Math.abs(v-d.current)>5){a.current="instant",d.current=v;return}d.current=v},[]),y={small:"text-[20px] sm:text-[30px]",medium:"text-[25px] sm:text-[35px]",large:"text-[30px] sm:text-[40px]"},x=()=>m.real_time.map((v,g)=>{const _=s>=v.start-.5&&s<v.end-.5;return u.jsx(BP,{done:!_&&s>v.end-.5,active:_,scrollBehavior:a,className:`${y[i||"medium"]} ${_?"active":""} mb-[30px]`,children:v.text},g)});f.useEffect(()=>{if(t)return t.addEventListener("timeupdate",p),()=>{t&&t.removeEventListener("timeupdate",p)}},[]),f.useEffect(()=>{const v=document.querySelector(".active.lyric");v&&v.scrollIntoView({behavior:"instant",block:"center"})},[r]),f.useEffect(()=>{a.current!=="instant"&&(a.current="instant")},[c]);const E={container:"overflow-y-auto overflow-x-hidden no-scrollbar pt-[20px] mask-image",loadingContainer:"flex justify-center items-center h-full w-full",loadingIcon:"opacity-[.6] animate-spin w-[35px] duration-[2s]"};return u.jsxs("div",{ref:l,className:`${E.container} ${e||""}`,children:[h&&u.jsx("div",{className:E.loadingContainer,children:u.jsx("span",{children:u.jsx(Js,{className:E.loadingIcon})})}),!h&&u.jsx(u.Fragment,{children:m.real_time.length?x():u.jsx("div",{className:E.loadingContainer,children:u.jsx("h1",{className:"text-[30px] opacity-60",children:"..."})})})]})},GX=({audioEle:t,setIsOpenFullScreen:e,isOpenFullScreen:n})=>{const r=We(),{currentSong:i}=Q(Ae),{playStatus:{isPlaying:s,isError:o,isWaiting:a}}=Q(Un),{userSongs:l}=ot(),{theme:c}=te(),d=zn(),h=f.useMemo(()=>d.pathname.includes("edit"),[d]),m=()=>{t==null||t.play()},p=()=>{t==null||t.pause()},y=()=>{s?p():m()},x=()=>{let g=i.currentIndex+1,w;g<l.length?w=l[g]:(w=l[0],g=0),r(Nn({...w,currentIndex:g,song_in:i.song_in}))},E=f.useMemo(()=>a?u.jsx(Js,{className:"w-[36px] animate-spin"}):o&&i.name?u.jsx(Hv,{className:"w-[36px] "}):s?u.jsx(qv,{className:"w-[36px] "}):u.jsx(Gv,{className:"w-[36px]"}),[a,o,s]),v={wrapper:`fixed bottom-0 transition-transform w-full h-[70px] border-t border-${c.alpha} z-40  px-[20px]`,container:`absolute inset-0 ${c.bottom_player_bg} bg-opacity-[0.7] backdrop-blur-[15px] z-[-1]`,songImageWrapper:"flex flex-row items-center flex-grow h-full",image:"w-[46px] h-[46px] flex-shrink-0",cta:"mobile-bottom-player flex items-center h-full pl-[15px] gap-[10px]"};return u.jsxs("div",{className:`${v.wrapper} ${h?"translate-y-full":""}`,children:[u.jsx("div",{className:`${v.container} ${n?"opacity-0 transition-opacity delay-[.3s]":""}`}),u.jsxs("div",{className:"flex flex-row  h-full",children:[u.jsx("div",{onClick:()=>e(!0),className:"mobile-current-song flex-grow",children:u.jsxs("div",{className:v.songImageWrapper,children:[u.jsx("div",{className:v.image,children:u.jsx(vi,{src:i.image_url||tw,classNames:"rounded-full"})}),u.jsx("div",{className:"flex-grow  ml-[10px]",children:i.song_url&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"h-[30px] relative overflow-hidden",children:u.jsx("div",{className:"absolute left-0 whitespace-nowrap font-playwriteCU leading-[1.5]",children:i.name||"name"})}),u.jsx("p",{className:"text-[14px] opacity-70 line-clamp-1",children:i.singer||"singer"})]})})]})}),u.jsxs("div",{className:`${v.cta} ${!i.name&&"disable"}`,children:[u.jsx("button",{className:" p-[4px]",onClick:()=>y(),children:E}),u.jsx("button",{onClick:x,className:" p-[4px]",children:u.jsx(wT,{className:"w-[35px]"})})]})]})]})};function KX({isOpenFullScreen:t}){const e=()=>{const n=document.querySelector("body");n&&(t?n.style.overflow="hidden":n.style.overflow="auto")};f.useEffect(()=>{e()},[t])}function XX(){const[t,e]=f.useState(!1);return f.useEffect(()=>{const n=()=>{window.innerWidth>549&&window.innerWidth<800?e(!0):e(!1)};return n(),window.addEventListener("resize",n),()=>window.removeEventListener("resize",n)},[]),{isLandscape:t}}function QX({audioEle:t,isOpenFullScreen:e,setIsOpenFullScreen:n}){const r=We(),{theme:i}=te(),{currentSong:s}=Q(Ae),{playStatus:{isPlaying:o}}=Q(Un),{queueSongs:a}=Q(xi),[l,c]=f.useState("Playing"),[d,h]=f.useState(!1),m=f.useRef(null),p=f.useRef(null),y=f.useRef(null),x=f.useRef(null);KX({isOpenFullScreen:e}),UP({bgRef:p,currentSong:s});const{isLandscape:E}=XX(),v=b=>{let k=0,R=b.parentElement;for(;!R.classList.contains("target-class")&&k<5;)R=R.parentElement,k++;return R},g={opacity:"0",transform:"translate(-100%, 0)"},w=b=>{let k=0,R=b.previousElementSibling;for(;R&&k<100;)Object.assign(R.style,g),k++,R=R.previousElementSibling},_=(b,k,R)=>{const P=b.target,O=v(P);w(O),Object.assign(O.style,g),setTimeout(()=>{r(Nn({...k,currentIndex:R,song_in:s.song_in}))},250)},S=f.useMemo(()=>u.jsx(u.Fragment,{children:s&&u.jsx(u.Fragment,{children:s.currentIndex===a.length-1?u.jsx("p",{children:"..."}):u.jsx(u.Fragment,{children:a.map((b,k)=>{if(k>s.currentIndex)return u.jsx(TI,{variant:"playing-next",theme:i,song:b,onClick:R=>_(R,b,k)},k)})})})}),[s,a]);f.useEffect(()=>{const b=m.current;b&&(e?(b.style.transform="translate(0)",b.style.zIndex="99"):(b.style.transform="translate(0, 100%)",setTimeout(()=>{b.style.zIndex="-10"},500)))},[e]);const T={headerWrapper:"h-[65px] p-4",header:"relative w-full",container:"flex-grow flex flex-col relative px-4 overflow-hidden",songImage:"flex-shrink-0 transition-[height, width] origin-top-left",nameAndSinger:"flex flex-grow justify-between items-center",control:"absolute bottom-0 left-4 right-4",lyricContainer:"absolute top-[65px] bottom-[120px] py-[16px] left-4 right-4",bgImage:"absolute inset-0 bg-no-repeat bg-cover bg-center blur-[50px] transition-[background-image] duration-[.3s ]",overlay:"absolute inset-0 bg-zinc-900 bg-opacity-60 bg-blend-multiply overflow-hidden",button:"inline-flex justify-center items-center rounded-full absolute top-0 h-full w-[35px]"};return u.jsx(u.Fragment,{children:u.jsxs("div",{ref:m,style:{transform:"translate(0, 100%)",zIndex:"-10"},className:"fixed inset-0 bg-zinc-900 text-white overflow-hidden transition-[transform] duration-[.3s] ease-linear",children:[u.jsx("div",{ref:p,className:T.bgImage}),u.jsx("div",{className:T.overlay}),u.jsxs("div",{className:"absolute inset-0 z-10 flex flex-col",children:[u.jsx("div",{className:T.headerWrapper,children:u.jsxs("div",{className:T.header,children:[u.jsxs(mo,{placement:"bottom-start",children:[u.jsx(po,{className:`${T.button} p-[6px] left-0 bg-gray-500 bg-opacity-20`,children:u.jsx(xT,{className:"w-[20px]"})}),u.jsx(go,{children:u.jsx(N4,{audioEle:t})})]}),u.jsx(F4,{inFullScreen:!0,className:"w-fit font-[500]",setActiveTab:c,activeTab:l,render:b=>b,tabs:["Songs","Playing","Lyric"]}),u.jsx("button",{className:`${T.button} p-[6px] right-0 bg-gray-500 bg-opacity-20`,onClick:()=>n(!1),children:u.jsx(nj,{className:"w-[20px]"})})]})}),u.jsxs("div",{ref:y,className:T.container,children:[u.jsxs("div",{className:`${l!="Playing"&&!d||E?"flex":""}`,children:[f.useMemo(()=>u.jsx(mQ,{active:l==="Playing"&&!E,data:s}),[s,o,l,E]),u.jsx("div",{className:`${T.nameAndSinger} ${l!="Playing"||E?"ml-[10px]":"mt-[15px] min-[549px]:mt-0"}`,children:u.jsxs("div",{className:"group flex-grow overflow-hidden",children:[u.jsx("div",{className:"h-[34px]",children:u.jsx(pf,{autoScroll:!0,className:`${l==="Playing"||E?"text-lg":"text-base"} leading-[1.5] font-playwriteCU`,content:s.name||"..."})}),u.jsx("div",{className:"h-[33px]",children:u.jsx(pf,{autoScroll:!0,className:`opacity-60 ${l==="Playing"||E?"text-lg":"text-base"}`,content:s.singer||"..."})})]})})]}),u.jsx("div",{ref:x,className:`${T.lyricContainer} ${l==="Lyric"?"block":"hidden"}`,children:f.useMemo(()=>u.jsx(j4,{active:l==="Lyric",className:"h-[100%]",audioEle:t,isOpenFullScreen:e&&l==="Lyric"}),[e,l,E])}),u.jsxs("div",{className:`${l==="Songs"?"flex-grow flex flex-col overflow-hidden":"hidden"}`,children:[u.jsx("div",{className:"leading-[2.2] text-sm font-playwriteCU my-2",children:"Playing next"}),u.jsx("div",{className:"flex-grow pb-[30px] no-scrollbar overflow-auto",children:S})]}),u.jsx("div",{className:`${T.control} ${l==="Songs"&&"opacity-0 pointer-events-none h-[0px] mb-[0px]"}`,children:u.jsx("div",{className:"h-[120px]",children:f.useMemo(()=>u.jsx(A4,{audioEle:t,isOpenFullScreen:!0,idle:!1}),[e])})})]})]})]})})}function YX(){const{theme:t}=te(),{loading:e,user:n}=mt(),{logIn:r}=Iu(),i=async()=>{try{await r()}catch(o){console.log(o)}finally{}},s={icon:"w-6 h-6 mr-2 inline",linkItem:`py-[10px] border-b border-${t.alpha} last:border-none`,button:`${t.content_bg} rounded-full`};return u.jsxs("div",{className:"pb-[30px]",children:[u.jsx("div",{className:"text-xl font-playwriteCU leading-[2.2] mb-3",children:"Library"}),u.jsx("div",{className:"flex flex-col space-y-3 items-start ",children:e?[...Array(3).keys()].map(()=>yI):u.jsx(u.Fragment,{children:n?u.jsxs(u.Fragment,{children:[u.jsx(Kp,{className:s.linkItem,to:Pt.MySongs,icon:u.jsx(ka,{className:s.icon+t.content_text}),label:"All songs",arrowIcon:u.jsx(Rp,{className:"w-6"})}),u.jsx(Kp,{className:s.linkItem,to:Pt.MySongs,icon:u.jsx(_T,{className:s.icon+t.content_text}),label:"Favorite",arrowIcon:u.jsx(Rp,{className:"w-6"})}),u.jsx(Kp,{className:s.linkItem,to:Pt.MySongs,icon:u.jsx(vT,{className:s.icon+t.content_text}),label:"Recent",arrowIcon:u.jsx(Rp,{className:"w-6"})})]}):u.jsxs(X,{onClick:i,className:`${t.content_bg} rounded-md space-x-1`,children:[u.jsx(Wv,{className:"w-6"}),u.jsx("span",{className:"font-playwriteCU leading-[2.2] text-sm",children:"Login"})]})})})]})}function JX(){const{theme:t}=te(),{loading:e,user:n}=mt(),r=f.useRef(null),{logOut:i}=Iu(),[s,o]=f.useState(""),a=()=>{var m;return(m=r.current)==null?void 0:m.toggle()},l=m=>{var p;o(m),(p=r.current)==null||p.toggle()},c=async()=>{try{await i()}catch(m){console.log("signOut error",{messsage:m})}finally{a()}},d=f.useMemo(()=>{switch(s){case"theme":return u.jsx(z4,{close:a});case"info":return u.jsx(iw,{close:a});case"logout":return u.jsx(zr,{close:a,callback:c,loading:!1,theme:t,label:"Log out ?"})}},[s]),h={linkItem:`py-[10px] w-full border-b border-${t.alpha} space-x-2 last:border-none flex items-center`,icon:"w-6"};return u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"pb-[30px]",children:[u.jsx("div",{className:"text-xl font-playwriteCU leading-[2.2] mb-3",children:"Setting"}),n&&u.jsxs("div",{className:`bg-${t.alpha} p-3 rounded-md flex mb-2`,children:[u.jsx(Wy,{className:"h-[65px] w-[65px]"}),u.jsxs("div",{className:"ml-3",children:[u.jsx("p",{className:"text-lg font-[500]",children:n?n.display_name:"Guest"}),u.jsx("p",{className:"opacity-70 font-[500]",children:"Vip member 💗"})]})]}),e?[...Array(3).keys()].map(()=>yI):u.jsxs(u.Fragment,{children:[u.jsxs("button",{className:h.linkItem,onClick:()=>l("theme"),children:[u.jsx(bT,{className:h.icon}),u.jsx("span",{children:"Theme"})]}),u.jsxs("button",{className:h.linkItem,onClick:()=>l("info"),children:[u.jsx(ET,{className:h.icon}),u.jsx("span",{children:"Info"})]}),n&&u.jsxs("button",{className:h.linkItem,onClick:()=>l("logout"),children:[u.jsx(Wv,{className:h.icon}),u.jsx("span",{children:"Logout"})]})]})]}),u.jsx(Wr,{ref:r,variant:"animation",children:d})]})}function ZX({children:t,className:e,...n},r){const i=n.variant||"default",{theme:s}=te(),[o,a]=f.useState(i==="default"),[l,c]=f.useState(i==="default"),d=()=>{l&&c(!1),o||a(!0)},h=p=>{p.preventDefault(),p.stopPropagation(),i==="default"&&n.closeModal&&n.closeModal(),i==="animation"&&d()};f.useImperativeHandle(r,()=>({toggle:d})),f.useEffect(()=>{i!=="default"&&(l||setTimeout(()=>{a(!1)},400))},[l]),f.useEffect(()=>{i!=="default"&&o&&setTimeout(()=>{c(!0)},100)},[o]);const m={unMountedContent:"opacity-0 scale-[.95]",mountedContent:"opacity-100 scale-[1]",unMountedLayer:"opacity-0",mountedLayer:"opacity-60"};return u.jsx(u.Fragment,{children:o&&Ka.createPortal(u.jsxs("div",{className:"fixed inset-0 z-[99]",children:[u.jsx("div",{onClick:h,className:`transition-opacity duration-300 absolute bg-black inset-0 z-[90]
                             ${l?m.mountedLayer:m.unMountedLayer}
                        `}),u.jsx("div",{className:`absolute duration-300 transition-[transform,opacity] z-[99] top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2
                            ${l?m.mountedContent:m.unMountedContent}
                        `,children:u.jsx(_o,{className:e||"",theme:s,children:t})})]}),document.getElementById("portals"))})}const Wr=f.forwardRef(ZX);function eQ({isOpenSongQueue:t,setIsOpenSongQueue:e}){const n=We(),{theme:r}=te(),{user:i}=mt(),{queueSongs:s}=Q(xi),{currentSong:o}=Q(Ae),[a,l]=f.useState("Queue"),c=f.useCallback((m,p)=>{p!==o.currentIndex&&n(Nn({...m,currentIndex:p}))},[o]),d=f.useCallback(()=>{e(!1),n(PP()),n(uo()),tn("duration",0)},[]);f.useEffect(()=>{i&&(i.email||(e(!1),l("Queue")))},[i]),f.useEffect(()=>{setTimeout(()=>{t||l("Queue")},1e3)},[t]);const h={textColor:`${r.type==="dark"?"text-white":"text-[#333]"} `,mainContainer:`fixed w-[300px] flex flex-col bottom-[80px] right-[0] top-[0] z-20 px-3 pt-4 ${r.container} border-l-[1px] border-${r.alpha} transition-[transform] duration-[.5s] linear delay-100`,songListContainer:"flex-grow overflow-y-auto pb-[10px] overflow-x-hidden no-scrollbar"};return u.jsxs("div",{className:`${h.textColor} ${h.mainContainer} ${t?"translate-x-0---":"translate-x-full"}     `,children:[u.jsx("div",{className:"leading-[2.2] font-playwriteCU mb-2",children:"Song queue"}),u.jsx("div",{className:h.songListContainer,children:a==="Queue"&&u.jsxs(u.Fragment,{children:[u.jsx(ps,{variant:"queue",songs:s,handleSetSong:c}),u.jsx("div",{className:"text-center",children:!!s.length&&u.jsxs(X,{onClick:d,size:"small",className:`${r.content_bg} rounded-full my-5 space-x-1`,children:[u.jsx(xc,{className:"w-6"}),u.jsx("span",{className:"font-playwriteCU text-sm leading-[2.2]",children:"Clear"})]})})]})})]})}const tQ=f.memo(eQ);function nQ(t,e,n){const{currentSong:r}=Q(Ae),[i,s]=f.useState(!1),[o,a]=f.useState(0),l=f.useRef(),c=f.useRef(),d=()=>{s(!1),a(Math.random())},h=()=>{clearTimeout(c.current),clearTimeout(l.current)},m=async()=>{if(!n)return;const p=document.querySelector(".song-thumb.active"),y=document.querySelector(".song-list-container");if(p&&y){const x=qP(p,y,!0);let E=zs.focusDelay;x||(E=0),l.current=setTimeout(()=>{s(!0)},E)}};return f.useEffect(()=>{if(n&&!(e||!r.id))return setTimeout(()=>{window.addEventListener("mousemove",d),window.dispatchEvent(new Event("mousemove"))},1e3),()=>{window.removeEventListener("mousemove",d),h()}},[n]),f.useEffect(()=>(c.current=setTimeout(()=>{m()},t),()=>{h()}),[o]),n?i:!1}const O4=({admin:t})=>{const{currentSong:e}=Q(Ae),{isOnMobile:n}=te(),[r,i]=f.useState(!1),[s,o]=f.useState(!1),[a,l]=f.useState(!1),c=f.useRef(null),d=nQ(zs.focusDelay,n,r),h=u.jsxs(u.Fragment,{children:[!t&&u.jsx(WX,{audioEle:c.current,idle:d,isOpenFullScreen:r,setIsOpenFullScreen:i}),u.jsx(tQ,{isOpenSongQueue:s,setIsOpenSongQueue:o}),u.jsx($X,{admin:t,audioEle:c.current,idle:d&&r,isOpenFullScreen:r,isOpenSongQueue:s,setIsOpenSongQueue:o,setIsOpenFullScreen:i})]}),m=u.jsxs(u.Fragment,{children:[u.jsx(QX,{audioEle:c.current,isOpenFullScreen:r,setIsOpenFullScreen:i}),u.jsx(GX,{audioEle:c.current,idle:d&&r,isOpenFullScreen:r,setIsOpenFullScreen:i})]});return f.useEffect(()=>{a||c.current&&l(!0)},[]),u.jsxs("div",{className:"absolute",children:[u.jsx("audio",{ref:c,src:e.song_url,className:"hd-mp3 hidden"}),a?n?m:h:""]})},nw="data:image/gif;base64,R0lGODlhJAAkAIABAP///////yH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQ4IDc5LjE2NDAzNiwgMjAxOS8wOC8xMy0wMTowNjo1NyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo0NmRjOGMyNC03YmYxLTQxZTMtYjQ2Zi1mY2ZhMDk4MDE1YWYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MTBDRTc0QzlGNDBEMTFFQTk4NDZENjI0QzI1MENFQzgiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MTBDRTc0QzhGNDBEMTFFQTk4NDZENjI0QzI1MENFQzgiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6YzBhNGU4OWYtNjc4Yy00NmMyLTg4NmUtYzIxNGE0NTIwZDRjIiBzdFJlZjpkb2N1bWVudElEPSJhZG9iZTpkb2NpZDpwaG90b3Nob3A6ODRlMDBjYmEtZjhlNy03YzQ4LWE4MTgtNDc3NTI3MGQ1ZTAyIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkECQgAAQAsAAAAACQAJAAAAnKMj5nArQ9jc7HWyax+GOx/dCAojltpWmgqYazqvu0kz1StrHgYp6tO6gWAn59wZKSxkjcTM7MUEk/SY1BpmGqeHhs0W8Vywk3tkPw9iztcBLfNW7Pl9PLcXk/f8Xz9vguWB6h254Y2+Id4aLjH2Kc4UQAAIfkECQgAAQAsAAAAACQAJAAAAnSMj6nL7Q+jnAzYS+XFGW7beV/4fADpmGijrkvrJnA2z1Q9hvhG7lznA+lyBpuMGAieDiYlQulkIpvTKk9KFRatv2RW671uxeHskwv+ptHLsRnbhbLPZHW7vK6r6XF21J33Bngnp2fY98UXuNikSOg3B8dYAAAh+QQJCAABACwAAAAAJAAkAAACfIyPqcvtD6OctNqLKdg8N955C7iJI4mQAKam6NUeMTMHda3cr4EnOugCfnY2Yi8Y4hmXKqHSWYQ2mclodSqllmTY7fOqbSK9VnLXHB6Ludk2Vg1nv+Vo9zT+rc/zK3qf/wNmt8aHV0Z4aHj2l+inFqgXiQjJuKgYRnkJUgAAIfkECQgAAQAsAAAAACQAJAAAAnuMj6nL7Q+jnLTaC7K+T2/eeBkYiiQjAlyKsJh5uJYc0BRtTzgMpbsn8fFqQ4cQGCuWjqok0vA7toZR4fRJxDJHzg+Uur16s+Nt86sFM8VcdDncbZPlZvZ5fq/H82rp3m5XxZe29mfoZnWIF9hH1+gDqKiHOPhWSBlJWQAAIfkECQgAAQAsAAAAACQAJAAAAn6Mj6nL7Q8RmDTaQ+u1eW7efVg4ZqLRARIppqsZpW6pQTIbzPZd57jD6+keQQ/NuAu+esDiEkl0HlUxKerXKFKvsCTvuY0qp2Dw8IzTlslTdNf3VrO5Qiu8Hre78d/5HSpHB5imR5g3Jhi2d7OWaGbIN4j4pwjJ6Lco00gJVgAAIfkECQgAAQAsAAAAACQAJAAAAn2EH6nL7XnQmxRGULO7WHsbfRPHiQ95mRsqqQvbBqUGG29K13eYw3tMqXVAwJFOMcsIf7YeizmsLJE45ZHYtPqoPO2TWzxdZVXpOGneYqPBc7mtJnflsekaCkXry3Z61h/VtzcnyGcYN1jnRnj4dQf2V8g46QiIB0ly+bhWAAAh+QQJCAABACwAAAAAJAAkAAACfYyPqcvtD+MDtMobqt6Y7Q90C8iJCamZJ0qpCNu6Bhwen0S/JZTb+wTTpSK92c9RzBwbyRsx6BvyoEYpkCW0RLVVVDbWBSuxW7EzDPrW0OrzmPs2U+Nrevvnzs/11ib+T8ZWVufXB+g1qHZnyAhX6HhIopg4yAfZKEkpiFYAACH5BAkIAAEALAAAAAAkACQAAAJ7jI+py+0Po5y02ouB3tht3jGfFopjuYwqgK5npCLuJ8XHDEK2gZP3ywMGeqwfzZgb9mTCnRLHPAalz1k06SRefVPsEsmthrXgYnf8PZvFa7J6206z4fBs8w4t08t2at+qF6j2h+YnRxiX9ybIhrg3iOdlqDjH6Fa5qFYAACH5BAkIAAEALAAAAAAkACQAAAJ1jI+py+0Po5y02otzArxr1nmfEnIjWZ5bqh4l0Lqs8WK1HNpzcFs9/9o5fkFhg1gUQZBJWISZlECL0l3ThFMCc1lq10mzXhFT8Db6JYubam7Yffa+teVymz5O6+fyuLm+hgd39ReIxRd0d+inmLjH+GX3+FIAACH5BAUIAAEALAAAAAAkACQAAAJwjI+py+0Po5y0PoCzhVlv12EfGI5NCJgMqi5sm7zwIc9BPeOw3vKqb6oBLyUaqshB3o4diZDpSTaN0FTkWUVgo8sslbtlapXh43hqKJfP4Ko1TY574ehue24XffV0KJuf9xa4tifoZih351f4h9hRAAA7",Uy=({data:t,inDetail:e,theme:n,active:r,link:i})=>{const s={button:`rounded-full text-[#201f1f] p-[4px] hover:bg-${n==null?void 0:n.alpha}`,imageContainer:"absolute inset-0 overflow-hidden rounded-[6px]",absoluteContainer:"absolute inset-0 group-hover:block",overlay:"absolute inset-0 bg-[#000] opacity-[.5]",buttonContainer:"justify-center items-center h-full z-10 relative",buttonWrapper:"flex items-center justify-center z-10 h-full w-full relative"},o=u.jsxs("div",{className:s.imageContainer,children:[u.jsx(vi,{classNames:"group-hover:scale-[1.1] transition duration-[.3s]",src:t.image_url,blurHashEncode:t.blurhash_encode}),u.jsxs("div",{className:`${s.absoluteContainer} ${r?"block":"hidden"}`,children:[u.jsx("div",{className:s.overlay}),r&&u.jsx("div",{className:s.buttonWrapper,children:u.jsx("img",{src:nw,alt:"",className:"w-[30px]"})})]})]});return e?u.jsx("div",{className:"group relative pt-[100%] w-full block",children:o}):u.jsxs(u.Fragment,{children:[u.jsx(Yi,{to:`${i||"/playlist/"+t.id}`,className:"group relative pt-[100%] w-full block",children:o}),u.jsx("h5",{className:"text-[20px] font-[500] line-clamp-1 leading-[24px]  mt-[6px]",children:t.name})]})};function rQ({content:t,className:e}){const n=f.useRef(null),r=f.useRef(null);return KG({textRef:r,textWrapperRef:n,content:t}),u.jsx("div",{ref:n,className:"overflow-hidden relative h-full ",children:u.jsx("div",{ref:r,className:`absolute left-0 whitespace-nowrap ${e}`,children:t||"..."})})}const pf=f.memo(rQ);function M4({openModal:t}){const{theme:e}=te(),n=We(),r=l=>{t(l)},[i,s]=WP("isCrossFade",!1),o=()=>{s(!i),n(or({isCrossFade:!i}))},a={menuItem:`${e.content_hover_text} hover:bg-${e.alpha} rounded-[4px] font-[500] w-full px-[10px] text-[14px] h-[40px] inline-flex items-center cursor-pointer`,icon:"w-[25px] mr-[8px]",divide:`h-[1px]  w-[calc(100%-20px)] my-[4px] mx-auto bg-${e.alpha}`};return u.jsx(u.Fragment,{children:u.jsx(_o,{variant:"thin",color:"sidebar",theme:e,children:u.jsxs("ul",{className:"flex flex-col w-[200px]",children:[u.jsxs("li",{className:`${a.menuItem} justify-between hover:bg-[unset]`,children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx(Gv,{className:a.icon}),"Cross fade"]}),u.jsx(lf,{active:i,cb:o})]}),u.jsxs("li",{className:`${a.menuItem}`,onClick:()=>r("theme"),children:[u.jsx(bT,{className:a.icon}),"Themes"]}),u.jsx("div",{className:a.divide}),u.jsxs("li",{className:`${a.menuItem}`,onClick:()=>r("info"),children:[u.jsx(ET,{className:a.icon}),"Info"]})]})})})}function iQ({className:t}){const[e,n]=f.useState(!1),{theme:r}=te(),i=()=>{const o=document.querySelector(".main-container");if(!o)return;const a=o.scrollTop||0;n(a>100)},s=()=>{const o=document.querySelector(".main-container");o==null||o.scroll({behavior:"smooth",top:0})};return f.useEffect(()=>{const o=document.querySelector(".main-container");if(o)return o.addEventListener("scroll",i),()=>{o.removeEventListener("scroll",i)}},[]),u.jsx(X,{onClick:s,variant:"circle",size:"clear",className:`absolute p-[8px] hover:scale-[1.05] transition-[opacity,transform] 
         ${t||""} 
         w-[36px] 
         ${r.content_hover_bg} h-[36px] bg-${r.alpha} 
      ${e?"opacity-[1]":"opacity-0 translate-y-[20px]"}`,children:u.jsx(mG,{className:"w-full"})})}function sQ(){const t=We(),{theme:e}=te(),{user:n,loading:r}=mt(),{resetSongPlaylistStore:i}=ot(),s=zn(),o=vn(),a=()=>{t(uo()),t(X1()),i()},l=()=>{a(),o("/dashboard")},c=[...Array(2).keys()].map(h=>u.jsxs("div",{className:"pl-[14px] h-[44px] flex items-center",children:[u.jsx(St,{className:"w-[25px] h-[25px] flex-shrink-0"}),u.jsx(St,{className:"w-[80px] h-[19px] ml-[5px]"})]},h)),d={container:`w-[180px] relative  flex-shrink-0 border-r-[1px] h-screen ${e.side_bar_bg} border-${e.alpha}`,button:`w-full ${e.content_hover_text}`,text:e.type==="light"?"text-[#333]":"text-white",icon:"w-7 mr-2",menuItem:"w-full font-playwriteCU  border-l-[4px] h-[44px] inline-flex items-center",activeMenu:`${e.content_text} ${e.container} ${e.content_border}`};return u.jsxs("div",{className:`${d.container} ${d.text}`,children:[u.jsx("div",{className:"px-[10px] h-[60px] flex items-center justify-center",children:u.jsxs(Yi,{to:"/",className:"text-[24px] font-bold",children:["HD",u.jsx("span",{className:`${e.content_text} ml-[4px]`,children:"MP3"})]})}),u.jsxs("div",{className:"flex flex-col items-start",children:[r&&c,!r&&u.jsxs(u.Fragment,{children:[u.jsx(Yi,{className:`${d.menuItem} ${s.pathname==="/"?d.activeMenu:"border-transparent"}`,to:Pt.Home,children:u.jsxs(X,{className:d.button,children:[u.jsx(Aj,{className:d.icon}),"Discover"]})}),n&&u.jsxs(u.Fragment,{children:[u.jsx(Yi,{className:`${d.menuItem}  ${s.pathname.includes("mysongs")?d.activeMenu:"border-transparent"}`,to:Pt.MySongs,children:u.jsxs(X,{className:d.button,children:[u.jsx(ka,{className:d.icon}),"My Song"]})}),n.role==="ADMIN"&&u.jsxs(X,{onClick:l,className:`${d.menuItem} ${d.button} border-transparent`,children:[u.jsx(yj,{className:d.icon}),"Dashboard"]})]})]})]}),u.jsx(iQ,{className:"left-[50%] translate-x-[-50%] bottom-[80px] md:bottom-[100px]"})]})}function oQ({contentRef:t}){const{theme:e}=te(),[n,r]=f.useState(0),[i,s]=Tu(us),[o,a]=f.useState(""),[l,c]=f.useState(!1),d=f.useRef(null),{logOut:h,logIn:m}=Iu(),p=_=>{var S;a(_),(S=d.current)==null||S.toggle(),c(!1)},y=async()=>{var _;try{await h()}catch(S){console.log("signOut error",{messsage:S})}finally{(_=d.current)==null||_.toggle()}},x=async()=>{try{const _=document.querySelector(".login-trigger");await m(),_&&_.click()}catch(_){console.log(_)}},E=()=>{var S;const _=((S=t.current)==null?void 0:S.scrollTop)||0;r(_)},v=u.jsx(St,{className:"w-[35px] h-[35px] rounded-full"}),g=f.useMemo(()=>{switch(o){case"":return u.jsx(u.Fragment,{});case"theme":return u.jsx(z4,{close:()=>{var _;return(_=d.current)==null?void 0:_.toggle()}});case"info":return u.jsx(iw,{close:()=>{var _;return(_=d.current)==null?void 0:_.toggle()}});case"confirm":return u.jsx(zr,{close:()=>{var _;return(_=d.current)==null?void 0:_.toggle()},callback:y,loading:!1,label:"Sign out ?",desc:"",theme:e})}},[o]);f.useEffect(()=>{var _;return(_=t.current)==null||_.addEventListener("scroll",E),()=>{document.removeEventListener("scroll",E)}},[]);const w={userName:"text-[16px] font-[500] ml-[8px] line-clamp-1",button:"h-[35px] w-[35px] rounded-full",menuItem:`hover:bg-${e.alpha} ${e.content_hover_text} rounded-[4px] w-full px-[10px] h-[44px] inline-flex items-center font-[500]`,icon:"w-[25px] mr-[5px]",divide:`h-[1px]  w-[calc(100%-20px)] mb-[10px] mt-[20px] mx-auto bg-${e.alpha}`};return u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:`${e.container} ${n?"shadow-lg":""} h-[60px] fixed right-0 ${n?"bg-transparent":""} left-[180px] z-[20]`,children:[u.jsx("div",{className:`${n?"":"hidden "} absolute  inset-0 ${e.container} bg-opacity-[0.9] backdrop-blur-[15px] z-[-1] `}),u.jsxs("div",{className:"px-[40px] flex items-center justify-between h-full",children:[u.jsx("div",{className:""}),u.jsxs("div",{className:"flex gap-[16px]",children:[u.jsxs(mo,{isOpenFromParent:l,setIsOpenFromParent:c,placement:"bottom-end",children:[u.jsx(po,{className:`flex px-[6px] items-center ${w.button} bg-${e.alpha} ${e.content_hover_bg}`,children:u.jsx(gT,{className:"w-full"})}),u.jsx(go,{children:u.jsx(M4,{openModal:p,loggedIn:!1})})]}),u.jsxs(mo,{placement:"bottom-end",children:[u.jsx(po,{className:`flex login-trigger items-center hover:brightness-75 ${w.button}`,children:s?v:u.jsx(Wy,{})}),u.jsx(go,{children:u.jsx(_o,{color:"sidebar",variant:"thin",theme:e,children:u.jsxs("div",{className:"w-[250px] max-h-[50vh]",children:[i&&u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"flex items-center p-[10px] pb-0",children:[u.jsx(Wy,{className:"login-trigger w-[46px] h-[46px]"}),u.jsx("div",{className:"ml-[12px]",children:u.jsx("h5",{className:"font-semibold line-clamp-1",children:i==null?void 0:i.displayName})})]}),u.jsx("div",{className:w.divide}),u.jsxs("button",{className:`${w.menuItem}`,onClick:()=>a("confirm"),children:[u.jsx(Wv,{className:w.icon}),"Log out"]})]}),!i&&u.jsxs("button",{className:`${w.menuItem}`,onClick:x,children:[u.jsx(ID,{className:w.icon}),"Log in"]})]})})})]})]})]})]}),u.jsx(Wr,{variant:"animation",ref:d,children:g})]})}function aQ({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{d:"M11.645 20.91l-.007-.003-.022-.012a15.247 15.247 0 01-.383-.218 25.18 25.18 0 01-4.244-3.17C4.688 15.36 2.25 12.174 2.25 8.25 2.25 5.322 4.714 3 7.688 3A5.5 5.5 0 0112 5.052 5.5 5.5 0 0116.313 3c2.973 0 5.437 2.322 5.437 5.25 0 3.925-2.438 7.111-4.739 9.256a25.175 25.175 0 01-4.244 3.17 15.247 15.247 0 01-.383.219l-.022.012-.007.004-.003.001a.752.752 0 01-.704 0l-.003-.001z"}))}const lQ=f.forwardRef(aQ),cQ=lQ;function uQ({title:t,titleId:e,...n},r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?f.createElement("title",{id:e},t):null,f.createElement("path",{fillRule:"evenodd",d:"M4.5 5.653c0-1.426 1.529-2.33 2.779-1.643l11.54 6.348c1.295.712 1.295 2.573 0 3.285L7.28 19.991c-1.25.687-2.779-.217-2.779-1.643V5.653z",clipRule:"evenodd"}))}const dQ=f.forwardRef(uQ),hQ=dQ;function yd({song:t,closeMenu:e,...n}){const r=We(),{user:i}=mt(),{theme:s,isOnMobile:o}=te(),{setSuccessToast:a}=xn(),{userPlaylists:l}=ot(),c=()=>{r(K1({songs:[t]})),e(),a({message:"Song added to queue"})},d={before:"after:content-[''] after:absolute after:h-[100%] after:w-[10px] after:right-[100%]",level2Menu:"w-[100%] absolute right-[calc(100%+5px)] hidden group-hover/add-playlist:block hover:block",menuItem:`hover:bg-${s.alpha} font-[500] ${s.content_hover_text} max-[549px]:!bg-transparent pl-[8px] rounded-[4px]`,menuIcon:"w-[18px] mr-[10px]",overlay:"absolute flex items-center justify-center inset-0 bg-[#000] bg-opacity-[.5]"},h=f.useMemo(()=>{if(!i)return u.jsx(u.Fragment,{});switch(n.variant){case"home":case"my-songs":case"dashboard-songs":return o?u.jsxs(X,{className:`group relative ${d.menuItem}  ${s.content_hover_text} ${d.before}`,variant:"list",onClick:()=>n.handleOpenModal("add-to-playlist"),children:[u.jsx(yh,{className:d.menuIcon}),"Add to playlist"]}):u.jsxs(X,{className:`group/add-playlist hover:!brightness-100 relative ${d.menuItem}  ${s.content_hover_text} ${d.before}`,variant:"list",children:[u.jsx(yh,{className:d.menuIcon}),"Add to playlist",u.jsx(_o,{variant:"thin",className:`${d.level2Menu} z-[99] 
                  
                     `,color:"sidebar",theme:s,children:u.jsx("ul",{className:"w-full",children:l!=null&&l.length?u.jsx(u.Fragment,{children:l.map((y,x)=>{const E=y.song_ids.includes(t.id);return u.jsxs("li",{onClick:()=>!E&&n.handleAddSongToPlaylist(y),className:`list-none w-full flex rounded-[4px] p-[5px] ${E&&"disable"} ${d.menuItem}`,children:[u.jsx("span",{children:u.jsx(ka,{className:d.menuIcon})}),u.jsxs("p",{className:"line-clamp-1 text-left",children:[y.name," ",E&&"(Added)"]})]},x)})}):u.jsx("p",{children:"No playlist jet..."})})})]})}},[l]),m=f.useMemo(()=>{switch(n.variant){case"home":return u.jsxs(u.Fragment,{children:[u.jsxs(X,{onClick:c,className:` ${d.menuItem}`,variant:"list",children:[u.jsx(zi,{className:d.menuIcon}),"Add to queue"]}),h]});case"playlist":case"dashboard-playlist":return u.jsx(u.Fragment,{children:u.jsxs(X,{className:d.menuItem,variant:"list",onClick:n.handleRemoveSongFromPlaylist,children:[u.jsx(T_,{className:d.menuIcon}),"Remove"]})});case"my-songs":case"dashboard-songs":return u.jsxs(u.Fragment,{children:[n.variant!=="dashboard-songs"&&u.jsxs(X,{onClick:c,className:` ${d.menuItem}`,variant:"list",children:[u.jsx(zi,{className:d.menuIcon}),"Add to queue"]}),h,u.jsxs(X,{onClick:()=>n.handleOpenModal("edit"),className:` ${d.menuItem} `,variant:"list",children:[u.jsx(gT,{className:d.menuIcon}),"Edit"]}),u.jsx(Yi,{to:`edit/${t.id}`,children:u.jsxs(X,{className:` ${d.menuItem} `,variant:"list",children:[u.jsx(wj,{className:d.menuIcon}),t.lyric_id?"Edit lyric":"Add lyric"]})}),u.jsxs(X,{onClick:()=>n.handleOpenModal("delete"),className:` ${d.menuItem} `,variant:"list",children:[u.jsx(xc,{className:d.menuIcon}),"Delete"]})]});case"queue":return u.jsxs(u.Fragment,{children:[u.jsxs(X,{onClick:n.handleRemoveSongFromQueue,className:` ${d.menuItem}`,variant:"list",children:[u.jsx(T_,{className:d.menuIcon}),"Remove"]}),h]})}},[n]),p=f.useMemo(()=>{switch(n.variant){case"queue":return u.jsx(u.Fragment,{});default:return u.jsxs("div",{className:"pl-[10px] py-[6px]",children:[u.jsx("h5",{className:"line-clamp-1 font-[500] text-lg",children:t.name}),u.jsx("p",{className:"text-base opacity-70 line-clamp-1",children:t.singer})]})}},[t]);return u.jsx(u.Fragment,{children:u.jsxs("div",{className:` ${n.variant==="queue"?"w-[140px]":"w-[200px]"} `,children:[p,m,u.jsxs("a",{target:"_blank",download:!0,href:t.song_url,className:` ${d.menuItem} w-full py-[5px] text-[14px] inline-flex items-center cursor-pointer`,children:[u.jsx(bD,{className:"w-[18px] mr-[10px]"}),"Download"]}),n.variant!=="queue"&&!o&&u.jsxs("p",{className:"opacity-50 font-[500] text-center text-[13px] mt-[10px]",children:["Uploaded by ",t.by]})]})})}function vd({song:t,onClick:e,active:n=!0,index:r,className:i,...s}){const o=We(),{theme:a,isOnMobile:l}=te(),{user:c}=mt(),{isChecked:d,selectedSongs:h,selectSong:m}=ru(),{userPlaylists:p}=ot(),[y,x]=f.useState(!1),[E,v]=f.useState(!1),[g,w]=f.useState(""),_=f.useRef(null),{setErrorToast:S}=xn(),T=()=>{var Mt;return(Mt=_.current)==null?void 0:Mt.toggle()},b=()=>v(!1),{handleDeleteSong:k,handleAddSongToPlaylistMobile:R,handleAddSongToPlaylist:P,handleRemoveSongFromPlaylist:O,loading:W}=XG({song:t,closeModal:T,setIsOpenPopup:v}),L=Mt=>{var Hr;w(Mt),b(),(Hr=_.current)==null||Hr.toggle()},z=f.useMemo(()=>h?h.indexOf(t)!=-1:!1,[h]),H=f.useMemo(()=>c?c.like_song_ids.includes(t.id):!1,[c==null?void 0:c.like_song_ids,t]),K=()=>{r!==void 0&&o(Xq({index:r}))},fe=async()=>{if(c)try{}catch(Mt){console.log(Mt),S({message:"Error when liked song"})}finally{x(!1)}},I=Mt=>{d!==void 0&&m(Mt)},$={button:`${a.content_hover_bg} p-[8px] rounded-full`,songListButton:"mr-[10px] text-[inherit]",itemContainer:`group/container flex flex-row rounded justify-between px-[10px] py-[10px] w-full border-b 
    border-${a.alpha} last:border-none p-[0px]`,imageFrame:` relative rounded-[4px] overflow-hidden flex-shrink-0 ${s.variant==="queue"?"w-[40px] h-[40px]":"h-[54px] w-[54px]"}`,overlay:"absolute flex items-center justify-center inset-0 bg-black/40",ctaWrapper:"flex items-center justify-end flex-shrink-0",menuBtnWrapper:"w-[50px] flex justify-center "},q=()=>{switch(s.variant){case"queue":return u.jsx(u.Fragment,{});case"uploading":return u.jsx("button",{className:`${$.songListButton}`,children:u.jsx(ka,{className:"w-[18px]"})});default:return l?u.jsx("button",{onClick:()=>I(t),className:`${$.songListButton} text-[inherit]`,children:z?u.jsx($y,{className:"w-[18px]"}):u.jsx(vc,{className:"w-[18px]"})}):u.jsxs(u.Fragment,{children:[u.jsx("button",{onClick:()=>I(t),className:`${$.songListButton} ${!z&&"hidden"} group-hover/main:block`,children:z?u.jsx($y,{className:"w-[18px]"}):u.jsx(vc,{className:"w-[18px]"})}),u.jsx("button",{className:`${$.songListButton} ${z&&"hidden"} group-hover/main:hidden group-hover/main:mr-[0px]`,children:u.jsx(ka,{className:"w-[18px]"})})]})}},j=f.useMemo(()=>{switch(s.variant){case"uploading":return u.jsx(u.Fragment,{});default:return u.jsx("div",{className:` ${$.overlay} 
               ${n?"":"hidden sm:group-hover/main:flex"}`,children:n?u.jsx("img",{src:nw,alt:"",className:"h-[18px] w-[18px]"}):u.jsx("div",{onClick:e,className:"cursor-pointer w-full h-full flex items-center justify-center",children:u.jsx(hQ,{className:"w-[24px] text-white"})})})}},[n,e]),G=u.jsxs(u.Fragment,{children:[q(),u.jsxs("div",{className:"flex-grow flex",onClick:l&&s.variant!=="uploading"?e:()=>{},children:[u.jsxs("div",{className:`${$.imageFrame}`,children:[u.jsx(vi,{src:t.image_url,blurHashEncode:t.blurhash_encode}),j]}),u.jsxs("div",{className:`ml-[10px]  ${s.variant==="queue",""}`,children:[u.jsx("h5",{className:`line-clamp-1  leading-[1.2] font-medium overflow-hidden ${s.variant==="queue"?"text-sm":"text-lg"}`,children:t.name}),u.jsx("p",{className:`opacity-[.7] line-clamp-1 
               ${s.variant==="queue"?"text-sm":""}
                       `,children:t.singer})]})]})]}),ee=()=>{switch(s.variant){case"uploading":return u.jsx("div",{className:"opacity-[.7]",children:G});case"queue":return G;default:return u.jsx("div",{className:"flex flex-grow",children:G})}},ie=f.useMemo(()=>{if(y)return u.jsx(Js,{className:"w-[20px] animate-spin"});switch(s.variant){case"dashboard-songs":case"dashboard-playlist":return u.jsx(u.Fragment,{});default:return c?u.jsxs("button",{onClick:fe,className:`${$.button} max-[549px]:!bg-transparent group`,children:[u.jsx(cQ,{className:`w-[20px]  ${H?`${a.content_text} block group-hover:hidden`:"text-white hidden group-hover:block"}`}),u.jsx(_T,{className:`w-[20px] ${H?"hidden group-hover:block":"block group-hover:hidden"}`})]}):u.jsx(u.Fragment,{})}},[fe,H]),De=f.useMemo(()=>{switch(s.variant){case"home":case"dashboard-songs":return u.jsx(yd,{closeMenu:b,variant:s.variant,handleAddSongToPlaylist:P,handleOpenModal:L,song:t});case"my-songs":case"favorite":return u.jsx(yd,{closeMenu:b,variant:"my-songs",handleAddSongToPlaylist:P,handleOpenModal:L,song:t});case"my-playlist":case"admin-playlist":case"dashboard-playlist":return u.jsx(yd,{closeMenu:b,variant:"playlist",handleRemoveSongFromPlaylist:O,handleOpenModal:L,song:t});case"queue":return u.jsx(yd,{closeMenu:b,handleRemoveSongFromQueue:K,variant:"queue",handleOpenModal:L,song:t});default:return u.jsx(u.Fragment,{})}},[s.variant,t,E]),Se=f.useMemo(()=>{switch(g){case"":return u.jsx(u.Fragment,{});case"edit":return u.jsx(cK,{close:T,song:t});case"delete":return u.jsx(zr,{loading:W,label:`Delete '${t.name}' ?`,desc:"This action cannot be undone",theme:a,callback:k,close:T});case"add-to-playlist":return u.jsx(wQ,{loading:W,handleAddSongToPlaylist:R,closeModal:T,song:t,userPlaylists:p})}},[g,W]),je=()=>{switch(s.variant){case"uploading":return u.jsxs("div",{className:"flex items-center",children:[u.jsx("span",{children:u.jsx(Js,{className:"w-[20px] mr-[10px] animate-spin"})}),u.jsx("p",{className:"text-[14px]",children:"In process..."})]});default:return u.jsxs("div",{className:$.ctaWrapper,children:[ie,u.jsxs("div",{className:$.menuBtnWrapper,children:[u.jsxs(mo,{isOpenFromParent:E,setIsOpenFromParent:v,placement:s.variant==="queue"?"bottom-end":"left",children:[u.jsx(po,{asChild:!0,children:u.jsx("button",{className:`block group-hover/main:block ${$.button} ${E||s.variant==="queue"?"md:block":"md:hidden max-[549px]:!bg-transparent"}`,children:u.jsx(yG,{className:"w-[20px]"})})}),u.jsx(go,{children:u.jsxs(_o,{className:`${W?"overflow-hidden relative":""}`,variant:"thin",color:"sidebar",theme:a,children:[De,W&&u.jsx("div",{className:$.overlay,children:u.jsx("div",{className:"h-[25px] w-[25px] border-[2px] border-r-black rounded-[50%] animate-spin"})})]})})]}),u.jsx("span",{className:`text-[12px] font-[500] hidden  group-hover/main:hidden ${E||s.variant==="queue"?"hidden":"md:block"}`,children:Aa(t.duration)})]})]})}},Ot=()=>{switch(s.variant){case"uploading":return u.jsxs("div",{className:`${$.itemContainer} ${i||""} `,children:[ee(),je()]});case"queue":return u.jsxs("div",{className:`${$.itemContainer} group/main py-[6px] ${n?`${a.content_bg} text-white`:`hover:bg-${a.alpha}`}`,children:[ee(),je()]});default:return u.jsxs("div",{className:`${$.itemContainer} ${i||""} 
               group/main ${n||z?`bg-${a.alpha}`:`hover:bg-${a.alpha}`}
               `,children:[ee(),je()]})}};return u.jsxs(u.Fragment,{children:[Ot(),u.jsx(Wr,{ref:_,variant:"animation",children:Se})]})}const fQ=({data:t,active:e,onClick:n,hasTitle:r,classNames:i,idleClass:s},o)=>{const{theme:a}=te(),l={container:"flex flex-col",imageFrame:"group relative transition-[width] duration-[.3s] origin-center rounded-[6px] overflow-hidden",image:"select-none object-cover object-center rounded w-full",overlay:`absolute  ${e?"":"inset-0 hidden bg-opacity-60 bg-[#333] items-center justify-center"}   group-hover:flex`,playingGifFrame:"absolute h-[30px] w-[30px] bottom-[15px] left-[15px] -z-1",title:"text-[22px] text-white mt-[10px] font-bold text-ellipsis line-clamp-1"};if(t)return u.jsxs("div",{ref:o,className:`${l.container} ${s||""}`,children:[u.jsx("div",{className:`song-thumb ${i??""} flex items-end justify-center flex-shrink-0 w-[350px] h-[350px] min-[1536px]:w-[450px] min-[1536px]:h-[450px] `,children:u.jsxs("div",{className:`${l.imageFrame} ${e?"w-[350px] min-[1536px]:w-[450px]":"w-[280px] min-[1536px]:w-[330px]"}`,children:[u.jsx(vi,{classNames:"rounded-[6px]",src:t.image_url,blurHashEncode:t.blurhash_encode}),u.jsx("div",{className:`${l.overlay}`,children:!e&&u.jsx(X,{onClick:n,variant:"circle",hover:"scale",size:"clear",className:`h-[50px] w-[50px] ${a.content_hover_text}`,children:u.jsx(qv,{className:"w-full"})})}),e&&u.jsx("div",{className:l.playingGifFrame,children:u.jsx("img",{src:nw,alt:""})})]})}),r&&u.jsxs("div",{className:"text-center",children:[u.jsx("h2",{className:l.title,children:(t==null?void 0:t.name)||"Some song"}),u.jsx("p",{className:"text-md opacity-50 line-clamp-1",children:(t==null?void 0:t.singer)||"..."})]})]})},Pg=f.forwardRef(fQ);function mQ({data:t,active:e}){const n={container:"flex flex-col",imageFrame:"rounded-[4px] overflow-hidden",image:"select-none object-cover object-center w-full"};if(t)return u.jsx("div",{className:`${n.container} ${e?"w-full px-[20px]":"w-[60px] h-[60px] flex-shrink-0"}`,children:u.jsx("div",{className:`${n.imageFrame}`,children:u.jsx(vi,{src:t.image_url,classNames:"w-full"})})})}function ps({songs:t,...e}){const{theme:n}=te(),{currentSong:r}=Q(Ae),{queueSongs:i}=Q(xi),s=f.useMemo(()=>e.variant!=="uploading"?u.jsx(u.Fragment,{}):t.map((l,c)=>{const d={key:c,onClick:()=>{},song:l};return c==0?u.jsx(vd,{variant:"uploading",className:"temp-song",...d}):u.jsx(vd,{variant:"uploading",...d})}),[e]),o=u.jsx("p",{className:"text-center my-[60px]",children:"... ¯\\_(ツ)_/¯"}),a=f.useMemo(()=>{if(e.variant==="uploading")return u.jsx(u.Fragment,{});switch(e.variant){case"my-songs":if(!t.length&&!e.tempSongs.length)return o;break;default:if(!t.length)return o}const{handleSetSong:l,activeExtend:c=!0}=e;return t.map((d,h)=>{let m=c&&r.id===d.id;e.variant==="queue"&&(m=m&&r.currentIndex===h);const p=r.currentIndex===i.length-1;return e.variant==="queue"&&m&&!p?u.jsxs("div",{children:[u.jsx(vd,{active:m,onClick:()=>l(d,h),variant:e.variant,song:d,index:h}),u.jsx("div",{className:"mt-[12px] mb-[4px]",children:u.jsx("p",{className:`${n.content_text} text-[14px] font-[600]`,children:"Playing next"})})]},d.id+d.name.length+h):u.jsx(vd,{active:m,onClick:()=>l(d,h),variant:e.variant,song:d,index:h},d.id+d.name.length+h)})},[r,e,i,n]);return u.jsxs(u.Fragment,{children:[a,s]})}function Sl({children:t,...e}){const{isSelectAll:n,resetSelect:r}=ru();switch(e.variant){case"home":case"dashboard-songs":return u.jsxs(u.Fragment,{children:[t,u.jsx(X,{onClick:r,className:"px-[5px] flex-shrink-0",children:u.jsx(Os,{className:"w-[20px]"})})]});case"my-playlist":case"my-songs":case"dashboard-playlist":case"admin-playlist":return u.jsxs(u.Fragment,{children:[u.jsx("button",{onClick:e.selectAll,className:"ml-[10px]",children:n?u.jsx($y,{className:"w-[20px]"}):u.jsx(vc,{className:"w-[20px]"})}),t,u.jsx(X,{onClick:r,className:"px-[5px] flex-shrink-0",children:u.jsx(Os,{className:"w-[20px]"})})]})}}function Kc({children:t,...e}){const n=We(),{theme:r}=te(),{user:i}=mt(),{isChecked:s,selectedSongs:o,selectAll:a,resetSelect:l}=ru(),{playlistSongs:c}=Q(wi),{userSongs:d,setUserSongs:h}=ot(),[m,p]=f.useState(!1),[y,x]=f.useState(""),{setErrorToast:E,setSuccessToast:v}=xn(),{deleteSongsFromPlaylist:g,isFetching:w}=Io(),_=()=>{x("")},S=()=>{o.length<d.length?a(d):l()},T=()=>{o.length<c.length?a(c):l()},b=()=>{n(K1({songs:o})),v({message:"songs added to queue"}),l()},k=async()=>{if(i)try{p(!0);const L=o.map(H=>H.id);for(let H of o)await FP(H);const z=d.filter(H=>!L.includes(H.id));h(z),v({message:`${o.length} songs deleted`})}catch(L){console.log({message:L}),E({})}finally{l(),p(!1),_()}},R=async()=>{try{await g(o)}catch(L){console.log(L),E({message:"Error when delete song"})}finally{_(),l()}},P={title:"text-xl leading-[2.2] font-playwriteCU",outlineButton:`border-${r.alpha} ${r.side_bar_bg} space-x-1`,icon:"w-[20px]"},O=f.useMemo(()=>{if(y)switch(y){case"delete-selected-songs":return u.jsx(zr,{loading:m,label:`Delete ${o.length} songs ?`,theme:r,callback:k,close:_});case"remove-selects-songs":return u.jsx(zr,{loading:w,label:`Remove ${o.length} songs ?`,theme:r,callback:R,close:_})}},[y,w,m]),W=f.useMemo(()=>{switch(e.variant){case"home":return u.jsxs(u.Fragment,{children:[!s&&u.jsx("h3",{className:`${P.title} !mr-[14px]`,children:"Songs"}),s&&u.jsxs(Sl,{variant:e.variant,children:[u.jsx("p",{className:"font-playwriteCU mr-1",children:o.length}),u.jsxs(X,{onClick:b,variant:"outline",size:"small",className:P.outlineButton,children:[u.jsx(zi,{className:P.icon}),u.jsx("span",{className:"hidden sm:block",children:"Add to queue"})]})]})]});case"dashboard-songs":return u.jsxs(u.Fragment,{children:[!s&&t,s&&u.jsxs(Sl,{variant:e.variant,children:[u.jsx("div",{className:"font-playwriteCU",children:o.length}),u.jsxs(X,{variant:"outline",size:"small",onClick:()=>console.log("confirm modal"),className:P.outlineButton,children:[u.jsx(xc,{className:P.icon}),u.jsx("span",{className:"hidden sm:block",children:"Delete"})]})]})]});case"my-songs":return u.jsxs(u.Fragment,{children:[!s&&t,s&&u.jsxs(Sl,{selectAll:S,variant:e.variant,children:[u.jsx("div",{className:"font-playwriteCU !mr-[14px]",children:o.length}),u.jsxs(X,{variant:"outline",size:"small",onClick:b,className:P.outlineButton,children:[u.jsx(zi,{className:P.icon}),u.jsx("span",{className:"hidden sm:block",children:"Add to queue"})]}),u.jsxs(X,{variant:"outline",size:"small",onClick:()=>x("delete-selected-songs"),className:P.outlineButton,children:[u.jsx(xc,{className:P.icon}),u.jsx("span",{className:"hidden sm:block",children:"Delete"})]})]})]});case"dashboard-playlist":case"my-playlist":return u.jsxs(u.Fragment,{children:[!s&&t,s&&u.jsxs(Sl,{selectAll:T,variant:e.variant,children:[u.jsx("p",{className:"font-playwriteCU !mr-[14px]",children:o.length}),e.variant!=="dashboard-playlist"&&u.jsxs(X,{variant:"outline",size:"small",onClick:b,className:P.outlineButton,children:[u.jsx(zi,{className:P.icon}),"Add to songs queue"]}),u.jsxs(X,{variant:"outline",size:"small",onClick:()=>x("remove-selects-songs"),className:P.outlineButton,children:[u.jsx(ST,{className:P.icon}),"Remove"]})]})]});case"admin-playlist":return u.jsxs(u.Fragment,{children:[!s&&u.jsx("div",{className:`${P.title} !mr-[14px]`,children:"Songs"}),s&&u.jsxs(Sl,{selectAll:T,variant:e.variant,children:[u.jsx("p",{className:"font-[500]",children:o.length}),u.jsxs(X,{variant:"outline",size:"small",onClick:b,className:P.outlineButton,children:[u.jsx(zi,{className:P.icon}),"Add to songs queue"]})]})]})}},[s,o,e]);return u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"flex items-center space-x-2 h-[44px] mb-3",children:W}),u.jsx(Wr,{variant:"animation",children:O})]})}function pQ({loading:t}){const e=We(),{adminSongs:n}=ot(),{from:r}=Q(xi),{currentSong:i}=Q(Ae),s=(o,a)=>{(i.id!==o.id||i.song_in!=="admin")&&(e(Nn({...o,currentIndex:a})),(r.length>1||r[0]!=o.song_in)&&e(Qm({songs:n})))};return u.jsxs(bc,{children:[u.jsx(Kc,{variant:"home"}),t&&Hf,!t&&u.jsx(u.Fragment,{children:n.length?u.jsx(u.Fragment,{children:u.jsx(ps,{variant:"home",handleSetSong:s,activeExtend:i.song_in==="admin"||i.song_in==="favorite",songs:n})}):u.jsx("h1",{className:"text-[22px] text-center",children:"..."})})]})}function L4(){const t=We(),{userPlaylists:e,setUserPlaylists:n}=ot(),{currentPlaylist:r}=Q(wi),{currentSong:i}=Q(Ae),[s,o]=f.useState(!1),a=vn(),{setErrorToast:l}=xn();return{isFetching:s,addAdminPlaylist:async h=>{try{if(!h)throw new Error("playlist name invalid");const m=dx(h)+"_admin",p=fx({id:m,by:"admin",name:h});o(!0);const y=[...e,p];await Jn({collection:"playlist",data:p,id:m,msg:">>> api: set playlist doc"}),n(y)}catch(m){console.log({message:m}),l({})}finally{o(!1)}},deleteAdminPlaylist:async()=>{o(!0),await Hc({collection:"playlist",id:r.id,msg:">>> api: delete playlist doc"});const h=e.filter(m=>m.id!==r.id);n(h),t(X1()),i.song_in===`playlist_${r.id}`&&t(uo()),o(!1),a("/dashboard")}}}function rw({playlist:t,loading:e,activeCondition:n=!0,className:r,...i}){const{theme:s}=te(),{currentSong:o}=Q(Ae),a=f.useRef(null),{addPlaylist:l,isFetching:c}=Io(),{addAdminPlaylist:d,isFetching:h}=L4(),m=()=>{var y;return(y=a.current)==null?void 0:y.toggle()},p={playlistItem:"w-1/4 p-[8px] max-[800px]:w-1/2"};return u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:`flex flex-row flex-wrap -mx-[8px] ${r}`,children:[e&&UF,!e&&u.jsxs(u.Fragment,{children:[t.length?t.map((y,x)=>{const E=n&&o.song_in.includes(y.id);switch(i.location){case"home":case"my-songs":return u.jsx("div",{className:p.playlistItem,children:u.jsx(Uy,{active:E,theme:s,data:y})},x);case"dashboard":return u.jsx("div",{className:p.playlistItem,children:u.jsx(Uy,{active:E,theme:s,data:y,link:`/dashboard/playlist/${y.id}`})},x)}}):i.location==="home"&&u.jsx("p",{className:"text-center w-full",children:"..."}),i.location!=="home"&&u.jsx("div",{className:`${p.playlistItem} mb-[25px]`,children:u.jsx(n$,{theme:s,className:"pt-[100%]",onClick:()=>{var y;return(y=a.current)==null?void 0:y.toggle()}})})]})]}),i.location!=="home"&&u.jsxs(Wr,{variant:"animation",ref:a,children:[i.location==="my-songs"&&u.jsx(Ub,{addPlaylist:l,isFetching:c,close:m}),i.location==="dashboard"&&u.jsx(Ub,{addPlaylist:d,isFetching:h,close:m})]})]})}function F4({tabs:t,activeTab:e,setActiveTab:n,className:r,render:i,inFullScreen:s}){const{theme:o}=te();return u.jsx("ul",{className:`flex space-x-[4px] py-[4px] h-full px-[4px] items-center ${s?"mx-auto":""} rounded-full ${s?"bg-white/10":o.side_bar_bg} ${r&&r}`,children:t.map((a,l)=>u.jsx("li",{onClick:()=>n(a),className:`${s?"px-[30px]":"px-[20px]"}  cursor-pointer hover:bg-white/20 h-full rounded-full max-[549px]:px-[15px] ${s?"":o.content_hover_text} ${e===a?s?"bg-white/20":`${o.content_text} ${o.container}`:"opacity-60"}`,children:u.jsx("span",{className:"leading-[27px] font-semibold max-[549px]:font-normal",children:i(a)})},l))})}function $4({to:t}){const{theme:e}=te(),n=vn(),r=zn(),i=o=>{typeof t=="string"&&B5(t),o==="back"&&n(-1)},s={button:`h-[36px] w-[36px] p-[4px] rounded-full ${e.content_hover_bg} bg-${e.alpha}`};return u.jsx("div",{className:"flex gap-[10px] mb-[30px]",children:u.jsx("button",{onClick:()=>i("back"),className:`${s.button} ${r.pathname==="/"?"disable":""}`,children:u.jsx(zP,{})})})}const gQ=({time:t=6e3,autoClose:e})=>{const{setToasts:n,toasts:r}=xn(),{theme:i}=te(),[s,o]=f.useState(""),a=c=>{n(d=>d.filter(h=>h.id!=c))};f.useEffect(()=>{s&&n(c=>c.filter(d=>d.id!=s))},[s]),f.useEffect(()=>{if(!e||!r.length)return;const c=r[r.length-1].id;setTimeout(()=>{o(c)},t)},[r]);const l={container:"toast-portal fixed z-[199] bottom-[100px] left-[20px] max-[549px]:bottom-[unset] max-[540px]:top-[10px] max-[540px]:right-[10px]"};return u.jsx(u.Fragment,{children:Ka.createPortal(u.jsx("div",{className:l.container,children:u.jsx("div",{className:"flex flex-col gap-[10px]",children:!!r.length&&r.map((c,d)=>u.jsx(uK,{onClick:a,theme:i,toast:c},d))})}),document.getElementById("portals"))})};function yQ({user:t},e){return e?u.jsx("p",{className:"text-xl mb-4 ml-2",ref:e,children:t.display_name}):u.jsx("p",{className:"text-xl mb-4 ml-2",children:t.display_name})}f.forwardRef(yQ);function vQ(){const{theme:t}=te(),[e]=Tu(us),[n,r]=f.useState(""),i=f.useRef(null),{logOut:s}=Iu(),o=()=>{var h;return(h=i.current)==null?void 0:h.toggle()},a=h=>r(h),l=async()=>{try{await s()}catch(h){console.log("signOut error",{messsage:h})}finally{o()}},c=f.useMemo(()=>{switch(n){case"":return u.jsx(u.Fragment,{});case"logout":return u.jsx(zr,{callback:l,close:o,loading:!1,theme:t,label:"Log out ?"});case"info":return u.jsx(iw,{close:o});case"theme":return}},[n]),d={header:`${t.side_bar_bg} fixed top-0 z-10 left-0 right-0`,container:"container mx-auto px-[40px] flex justify-between items-center h-[50px]",avatarFrame:"w-[34px] h-[34px] rounded-full",settingBtn:` flex ml-[12px] justify-center items-center hover:brightness-75 bg-${t.alpha}`};return u.jsxs(u.Fragment,{children:[u.jsx("div",{className:`${d.header}`,children:u.jsxs("div",{className:d.container,children:[u.jsxs(Yi,{to:"/dashboard",className:"text-[24px] font-semibold",children:["HD",u.jsx("span",{className:`${t.content_text} ml-[4px] uppercase`,children:"Dashboard"})]}),u.jsxs("div",{className:"flex items-center",children:[(e==null?void 0:e.displayName)&&u.jsx("p",{className:"text-[14px] mr-[8px]",children:e.displayName}),u.jsx("div",{className:`${d.avatarFrame} overflow-hidden `,children:(e==null?void 0:e.photoURL)&&u.jsx("img",{src:e.photoURL,className:"w-full",alt:""})}),u.jsxs(mo,{placement:"bottom-end",children:[u.jsx(po,{className:`${d.avatarFrame} ${d.settingBtn}`,children:u.jsx(xT,{className:"w-[24px]"})}),u.jsx(go,{children:u.jsx(M4,{loggedIn:!1,openModal:a})})]})]})]})}),u.jsx(Wr,{variant:"animation",ref:i,children:c})]})}const xQ="/HD-MP3/assets/user-default-971f59df.png";function Wy({className:t}){const[e]=Tu(us),n={imageFrame:`${t||"w-[35px] h-[35px]"} flex-shrink-0 rounded-full overflow-hidden ${e!=null&&e.photoURL?"":"flex items-center justify-center bg-[#ccc]"}`};return u.jsx("div",{className:n.imageFrame,children:u.jsx(vi,{src:(e==null?void 0:e.photoURL)||xQ,classNames:"w-full"})})}function iw({close:t}){return u.jsxs("div",{className:"w-[400px] max-w-[calc(90vw-40px)]",children:[u.jsx(_s,{close:t,title:"HD MP3"}),u.jsxs("p",{children:[u.jsx("span",{className:"font-[500]",children:"Technologies: "})," React, Tailwind Css, Google firebase"]})]})}function Vb({onClick:t,theme:e,active:n}){return u.jsx(u.Fragment,{children:u.jsxs("div",{className:"w-[25%] px-2 mt-3 max-[549px]:w-[50%]",children:[u.jsx("div",{onClick:()=>t(e),className:`relative border-l-[20px] ${e.content_border} pt-[100%] rounded-xl ${e.side_bar_bg} ${n?e.content_border:""}`,children:n&&u.jsx("div",{className:"absolute bottom-[10px] right-[10px]",children:u.jsx(yT,{className:`${e.content_text} w-[25px]`})})}),u.jsx("p",{className:"text-base font-[500] mt-1",children:e.name})]})})}function z4({close:t}){const{theme:e,setTheme:n}=te(),r=a=>{tn("theme",a.id),n(a)},i={songItemContainer:`w-full border-b border-${e.alpha} last:border-none`,icon:"w-6 h-6 mr-2 inline",popupWrapper:"w-[900px] max-w-[calc(90vw-40px)]",themeContainer:"overflow-y-auto overflow-x-hidden no-scrollbar h-[calc(70vh-60px)]  pb-[5vh]",themeList:"flex flex-row -mx-2 -mt-3 flex-wrap",linkItem:`py-[10px] border-b border-${e.alpha} last:border-none`},s=vh.map(a=>{const l=a.id===e.id;if(a.type==="light")return u.jsx(Vb,{active:l,theme:a,onClick:r},a.id)}),o=vh.map(a=>{const l=a.id===e.id;if(a.type==="dark")return u.jsx(Vb,{active:l,theme:a,onClick:r},a.id)});return u.jsxs("div",{className:i.popupWrapper,children:[u.jsx(_s,{close:t,title:"Themes"}),u.jsxs("div",{className:i.themeContainer,children:[u.jsx("h2",{className:"text-lg font-semibold mb-[10px]",children:"Dark"}),u.jsx("div",{className:i.themeList,children:o}),u.jsx("h2",{className:"text-lg font-semibold mb-[10px] mt-[30px]",children:"Light"}),u.jsx("div",{className:i.themeList,children:s})]})]})}function zr({loading:t,theme:e,callback:n,label:r,close:i,buttonLabel:s,desc:o="This action cannot be undone",className:a}){return u.jsxs("div",{className:`${a||"w-[400px] max-w-[calc(90vw-40px)]"} ${t?"disable":""}`,children:[u.jsx("div",{className:"text-xl font-playwriteCU leading-[2.2] mb-3",children:r||"Wait a minute"}),o&&u.jsx("p",{className:"font-semibold text-red-500",children:o}),u.jsxs("div",{className:"flex space-x-3 mt-5",children:[u.jsx(X,{onClick:i,className:`${e.content_bg} rounded-full text-[14px]`,variant:"primary",children:"Close"}),u.jsx(X,{isLoading:t,className:" text-[#fff] bg-red-500 rounded-full text-[14px] font-bold",variant:"primary",onClick:n,children:s||"Yes please"})]})]})}function Ub({close:t,addPlaylist:e,isFetching:n}){const{theme:r}=te(),[i,s]=f.useState(""),o=f.useRef(null),a=async l=>{l.preventDefault(),i&&(await e(i),t())};return f.useEffect(()=>{var l;(l=o.current)==null||l.focus()},[]),u.jsxs("div",{className:"w-[300px] max-w-[calc(100vw-40px)]:",children:[u.jsx(_s,{close:t,title:"Add playlist"}),u.jsxs("form",{action:"",onSubmit:a,children:[u.jsx("input",{ref:o,className:`bg-${r.alpha} px-[20px] rounded-full outline-none mt-[10px] text-[16px]  h-[35px] w-full`,type:"text",placeholder:"name...",value:i,onChange:l=>s(l.target.value)}),u.jsx("p",{className:"text-right mt-[20px]",children:u.jsx(X,{type:"submit",isLoading:n,variant:"primary",className:`${r.content_bg} rounded-full ${i?"":"disable"}`,children:"Save"})})]})]})}function wQ({closeModal:t,handleAddSongToPlaylist:e,userPlaylists:n,song:r,loading:i}){return u.jsxs("div",{className:`w-[400px] max-w-[calc(90vw-40px)] ${i?"disable":""}`,children:[u.jsx(_s,{close:t,title:"Playlist"}),u.jsx("div",{className:"max-h-[60vh]",children:u.jsx("ul",{className:"",children:n!=null&&n.length?u.jsx(u.Fragment,{children:n.map((s,o)=>{const a=s.song_ids.includes(r.id);return u.jsxs("li",{onClick:()=>!a&&e(s),className:`list-none flex rounded-[4px] p-[5px] ${a&&"opacity-60"}`,children:[u.jsx(ka,{className:"w-[20px] mr-[5px]"}),u.jsxs("p",{children:[s.name," ",a&&"(added)"]})]},o)})}):"No playlist jet..."})})]})}function _Q({close:t,active:e}){const{theme:n}=te(),r={button:`bg-${n.alpha} ${n.content_hover_bg} text-[14px] font-[500] px-[10px]  py-[4px] rounded-[99px]`,input:`bg-${n.alpha} px-[10px] rounded-[4px] outline-none mt-[10px] text-[16px]  h-[35px] w-full`},i=s=>{e(s),t()};return u.jsxs("div",{className:"w-[300px] max-w-[calc(100vw-40px)]",children:[u.jsx(_s,{close:t,title:"Sleep timer"}),u.jsx("div",{children:u.jsxs("div",{className:"flex space-x-[10px] mb-[12px]",children:[u.jsx("button",{type:"button",onClick:()=>i(15),className:`${r.button} `,children:"15 min"}),u.jsx("button",{type:"button",onClick:()=>i(20),className:`${r.button} `,children:"20 min"}),u.jsx("button",{type:"button",onClick:()=>i(30),className:`${r.button} `,children:"30 min"})]})})]})}function B4({admin:t}){const e=f.useRef(null),n=f.useRef(null),r=f.useRef(null),{handleInputChange:i}=rK({audioRef:e,testImageRef:r,inputRef:n,admin:t}),s={container:"upload portal fixed z-[199] bottom-[120px] right-[30px] max-[549px]:bottom-[unset] max-[540px]:top-[10px] max-[540px]:right-[10px]"};return u.jsx(u.Fragment,{children:Ka.createPortal(u.jsxs("div",{className:s.container,children:[u.jsx("audio",{className:"hidden",ref:e}),u.jsx("input",{ref:n,onChange:i,type:"file",multiple:!0,accept:"audio",id:"song_upload",className:"hidden"}),u.jsx("img",{className:"hidden",ref:r})]}),document.getElementById("portals"))})}function Ng({children:t}){const{theme:e}=te();return u.jsx(u.Fragment,{children:u.jsxs("div",{className:`${e.container} min-h-screen ${e.type==="dark"?"text-white":"text-[#333]"}`,children:[u.jsx(vQ,{}),u.jsxs("div",{className:"h-[calc(100vh-50px)] no-scrollbar overflow-auto",children:[u.jsx("div",{className:"h-[100px]"}),u.jsx("div",{className:"container mx-[auto] px-[40px]",children:t})]}),u.jsx(O4,{admin:!0}),u.jsx(B4,{admin:!0})]})})}function EQ(){const{loading:t}=mt(),{adminPlaylists:e}=ot(),{isOnMobile:n}=te(),{loading:r}=Jm({});return u.jsxs(u.Fragment,{children:[n&&u.jsx(YX,{}),u.jsxs("div",{className:"pb-[30px]",children:[u.jsx("h3",{className:"text-xl leading-[2.2] font-playwriteCU mb-3",children:"Popular"}),u.jsx(rw,{loading:r||t,playlist:e,location:"home"})]}),u.jsx("div",{className:"pb-[30px]",children:u.jsx(pQ,{loading:r})}),n&&u.jsx(JX,{})]})}function SQ(){const{theme:t}=te(),{currentSong:e}=Q(Ae),{userSongs:n}=ot(),[r,i]=f.useState(),[s,o]=f.useState({base:"",real_time:[],id:""}),a=f.useRef(null),[l,c]=f.useState(!1),d=f.useRef(!1),{errorMsg:h,loading:m,initial:p}=Jm({}),y=vn(),x=jf(),E=f.useCallback(async g=>{try{if(g.lyric_id){c(!0);const w=await Ba({collection:"lyrics",id:g.lyric_id,msg:">>> api: get lyric doc"});if(w.exists()){const _=w.data();o(_)}}}catch(w){console.log({message:w})}finally{c(!1)}},[]),v=f.useCallback(async()=>{if(console.log("get song"),e.name&&e.id===x.id)e.by==="admin"?y(Pt.Home):(i(e),await E(e));else{const g=n.find(w=>w.id===x.id);g?(i(g),await E(g)):y(Pt.Home)}},[e,n]);return f.useEffect(()=>{p&&(d.current||(d.current=!0,r||v()))},[p]),m||l?u.jsx("h1",{children:u.jsx(Js,{className:"w-[25px] animate-spin"})}):h?u.jsx("h1",{children:h}):u.jsxs("div",{className:"",children:[u.jsx("audio",{ref:a,src:r==null?void 0:r.song_url,className:"hidden"}),r&&u.jsx(u.Fragment,{children:u.jsx(D4,{lyric:s,audioRef:a,theme:t,song:r})})]})}function bQ({initialLoading:t}){const e=We(),{userSongs:n}=ot(),{currentSong:r}=Q(Ae),{tempSongs:i}=Ym(),s=f.useMemo(()=>i.length+n.length,[i,n]),o=(a,l)=>{r.id!==a.id&&e(Nn({...a,currentIndex:l}))};return u.jsxs(bc,{children:[u.jsx(Kc,{variant:"dashboard-songs",children:t?u.jsx(u.Fragment,{children:u.jsx("div",{className:"h-[30px] mb-[10px] flex items-center",children:u.jsx(St,{className:"h-[20px] w-[90px]"})})}):u.jsxs("p",{className:"font-semibold opacity-[.6]",children:[s," Songs"]})}),u.jsxs("div",{className:"min-h-[50vh]",children:[t&&Hf,!t&&u.jsx(u.Fragment,{children:s?u.jsxs(u.Fragment,{children:[u.jsx(ps,{variant:"dashboard-songs",tempSongs:i,activeExtend:!0,songs:n,handleSetSong:o}),u.jsx(ps,{variant:"uploading",songs:i})]}):u.jsx("p",{className:"text-center",children:"¯\\_(ツ)_/¯"})})]})]})}function kQ(){const{theme:t}=te(),{user:e,loading:n}=mt(),{currentSong:r}=Q(Ae),{userPlaylists:i}=ot(),[s,o]=f.useState(!0),[a,l]=f.useState([]),[c,d]=f.useState("userSongs"),{loading:h,errorMsg:m}=Jm({admin:!0}),p=async()=>{console.log(">>> api: get user");try{if(!e)return;o(!0);const E=sl(km(To,"users"),ol("email","!=",e.email)),v=await al(E);if(v.docs){const g=v.docs.map(w=>w.data());l(g)}}catch(E){console.log(E)}finally{o(!1)}},y=()=>a.map((E,v)=>u.jsxs("tr",{className:"",children:[u.jsx("td",{className:x.td,children:u.jsx("div",{className:"h-[44px] w-[44px] ml-[20px]",children:u.jsx(vi,{classNames:"rounded-[4px]",src:E.photoURL})})}),u.jsx("td",{className:x.td,children:E.display_name}),u.jsx("td",{className:x.td,children:E.email}),u.jsx("td",{className:x.td,children:OF(E==null?void 0:E.latest_seen)})]},v));f.useEffect(()=>{n||c==="users"&&!a.length&&p()},[c]);const x={button:`${t.content_bg} rounded-full`,inActiveBtn:`bg-${t.alpha}`,activeBtn:`${t.content_bg}`,td:`py-[10px] my-[10px] border-${t.alpha} border-b-[1px]`,th:"py-[5px]",tableContainer:`border border-${t.alpha} rounded-[4px]`,tableHeader:`border-b border-${t.alpha} ${t.side_bar_bg} flex items-center h-[50px] gap-[15px]`};return u.jsx(u.Fragment,{children:u.jsxs("div",{className:"container mx-auto pb-[60px]",children:[u.jsxs("div",{className:"mb-[20px]",children:[u.jsx(X,{onClick:()=>d("userSongs"),className:`${c==="userSongs"?x.activeBtn:x.inActiveBtn}  rounded-full`,variant:"primary",children:"Songs"}),u.jsx(X,{onClick:()=>d("users"),className:` ${c==="users"?x.activeBtn:x.inActiveBtn} rounded-full ml-[10px]`,variant:"primary",children:"Users"})]}),u.jsxs("div",{className:"mt-[30px]",children:[c==="userSongs"&&u.jsxs(u.Fragment,{children:[u.jsx("h3",{className:"text-2xl font-bold mb-[10px]",children:"Playlist"}),u.jsx(rw,{activeCondition:!!r.song_in,loading:h,playlist:i,location:"dashboard"}),u.jsxs("div",{className:"mt-[30px] flex justify-between mb-[10px]",children:[u.jsx("h3",{className:"text-2xl font-bold",children:"Songs"}),u.jsx("div",{className:"flex items-center",children:u.jsxs("label",{className:`${t.content_bg} ${status==="uploading"||h?"disable":""} rounded-full flex px-[20px] py-[4px] cursor-pointer`,htmlFor:"song_upload",children:[u.jsx(yh,{className:"w-[20px] mr-[5px]"}),"Upload"]})})]}),m&&u.jsx("p",{children:"Some thing went wrong"}),!m&&u.jsx(bQ,{initialLoading:h})]}),c==="users"&&u.jsx("div",{className:x.tableContainer,children:u.jsxs("table",{className:"w-full",children:[u.jsx("thead",{className:`${t.bottom_player_bg} w-full text-[14px] py-[4px]`,children:u.jsxs("tr",{children:[u.jsx("th",{}),u.jsx("th",{className:"text-left py-[4px]",children:"Name"}),u.jsx("th",{className:"text-left py-[4px]",children:"Email"}),u.jsx("th",{className:"text-left py-[4px]",children:"Latest Seen"})]})}),u.jsx("tbody",{children:y()})]})})]})]})})}function TQ({playlist:t,close:e}){const{theme:n}=te(),r=f.useRef(null),[i,s]=f.useState(""),[o,a]=f.useState(!1),{editPlaylist:l,isFetching:c}=Io(),d=async m=>{if(m.preventDefault(),!!o)try{await l(i,t)}catch(p){console.log(p)}finally{e()}},h={editContainer:"w-[400px] max-w-[calc(90vw-40px)]",input:"text-[20px] rounded-[4px] px-[10px] h-[40px] mb-[15px] outline-none w-full"};return f.useEffect(()=>{const m=r.current;m==null||m.focus(),s(t.name)},[]),f.useEffect(()=>{i.trim()&&i.trim()!==t.name?a(!0):a(!1)},[i]),u.jsxs(u.Fragment,{children:[u.jsx(_s,{close:e,title:"Edit playlist"}),u.jsxs("form",{action:"",onSubmit:d,className:`${h.editContainer} ${c?"disable":""}`,children:[u.jsx("input",{ref:r,value:i,onChange:m=>s(m.target.value),type:"text",className:`${h.input} bg-${n.alpha} ${n.type==="light"?"text-[#333]":"text-white"}`}),u.jsx(X,{type:"submit",variant:"primary",isLoading:c,className:`${n.content_bg} rounded-full self-end mt-[15px] ${o?"":"disable"}`,children:"Save"})]})]})}function Dg({loading:t,type:e}){const n=We(),{theme:r,isOnMobile:i}=te(),{currentSong:s}=Q(Ae),{currentPlaylist:o,playlistSongs:a}=Q(wi),[l,c]=f.useState(""),d=f.useRef(null),h=jf(),{deletePlaylist:m,isFetching:p}=Io(),{deleteAdminPlaylist:y,isFetching:x}=L4(),E=f.useMemo(()=>a.reduce((P,O)=>P+O.duration,0),[a]),v=P=>{var O;c(P),(O=d.current)==null||O.toggle()},g=()=>{var P;return(P=d.current)==null?void 0:P.toggle()},w=(P,O)=>{const W=`playlist_${o.id}`;(s.id!==P.id||s.song_in!==W)&&(n(Nn({...P,currentIndex:O,song_in:W})),s.song_in!==W&&(n(Qm({songs:a})),console.log("setActuallySongs when playlist list")))},_=()=>{const P=a[0];s.song_in.includes(h.name)||w(P,0)},S=u.jsxs(u.Fragment,{children:[u.jsx(St,{className:"h-[38px] mb-[6px] w-[200px]"}),u.jsx(St,{className:"hidden md:block h-[16px] w-[60px]"}),u.jsx(St,{className:"hidden md:block h-[16px] w-[200px]"})]}),T=f.useMemo(()=>t?S:u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"text-xl leading-[2.2] font-playwriteCU",children:o.name}),!i&&u.jsx("p",{className:"text-lg leading-[1] font-[500]",children:Aa(E)}),u.jsxs("p",{className:"hidden md:block opacity-60 leading-[1]",children:["created by ",o.by]})]}),[t,o]),b=f.useMemo(()=>{if(t)return u.jsx(u.Fragment,{});switch(e){case"my-playlist":case"dashboard-playlist":return u.jsxs(u.Fragment,{children:[u.jsxs(X,{onClick:_,className:`rounded-full px-[20px] py-[6px] ${r.content_bg} ${!o.song_ids.length&&"disable"}`,children:[u.jsx(I_,{className:"w-[22px]"}),u.jsx("span",{className:"font-playwriteCU",children:"Play"})]}),u.jsx(X,{onClick:()=>v("delete"),className:`p-[8px] rounded-full ${r.content_hover_bg} bg-${r.alpha}`,children:u.jsx(xc,{className:"w-[22px]"})}),u.jsx(X,{onClick:()=>v("edit"),className:`p-[8px] rounded-full ${r.content_hover_bg} bg-${r.alpha}`,children:u.jsx(kT,{className:"w-[22px]"})})]});case"admin-playlist":return u.jsxs(X,{onClick:_,className:`rounded-full px-[20px] space-x-1 py-[6px] ${r.content_bg} ${!o.song_ids.length&&"disable"}`,children:[u.jsx(I_,{className:"w-[22px]"}),u.jsx("span",{className:"font-playwriteCU",children:"Play"})]})}},[t,a]),k=f.useMemo(()=>{switch(l){case"":return u.jsx(u.Fragment,{});case"edit":return u.jsx(TQ,{close:g,playlist:o});case"delete":if(e==="my-playlist")return u.jsx(zr,{loading:p,label:"Delete playlist ?",theme:r,callback:m,close:g});if(e==="dashboard-playlist")return u.jsx(zr,{loading:x,label:"Delete playlist ?",theme:r,callback:y,close:g})}},[l,p,x]),R={container:"w-full space-y-[12px] md:space-y-0 md:space-x-[12px] flex flex-col md:flex-row",playlistInfoContainer:"flex flex-col gap-[12px] md:justify-between",infoTop:"flex justify-center items-center gap-[8px] md:flex-col md:items-start",countSongText:"text-[14px]] font-semibold opacity-[.6] leading-[1]",ctaContainer:"flex justify-center space-x-[12px] md:justify-start"};return u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:R.container,children:[u.jsx("div",{className:"w-full px-[20px] md:w-1/4 md:px-0",children:t?u.jsx(St,{className:"pt-[100%] rounded-[8px]"}):u.jsx(Uy,{data:o,active:s.song_in===`playlist_${o.id}`,inDetail:!0,theme:r})}),u.jsxs("div",{className:R.playlistInfoContainer,children:[u.jsx("div",{className:R.infoTop,children:T}),u.jsx("div",{className:`${R.ctaContainer} `,children:b})]})]}),u.jsx(Wr,{variant:"animation",ref:d,children:k})]})}function jg({variant:t}){const e=We(),{theme:n}=te(),{currentSong:r}=Q(Ae),{from:i,queueSongs:s}=Q(xi),{currentPlaylist:o,playlistSongs:a}=Q(wi),l=f.useRef(null),c=()=>{var E;return(E=l.current)==null?void 0:E.toggle()},{setErrorToast:d}=xn(),{deleteSongFromPlaylist:h}=Io(),m=(E,v)=>{const g=`playlist_${o.id}`;(r.id!==E.id||r.song_in!==g)&&(e(Nn({...E,currentIndex:v,song_in:g})),(i.length>1||i[0]!=g||a.length!==s.length)&&e(Qm({songs:a})))},p=async E=>{try{await h(E)}catch(v){console.log(v),d({})}},y=f.useMemo(()=>{if(!a.length)return u.jsx(u.Fragment,{});switch(t){case"admin-playlist":return u.jsx(Kc,{variant:"admin-playlist",children:u.jsxs("p",{className:"font-[500] opacity-[.5]",children:[a.length," Songs"]})});case"my-playlist":case"dashboard-playlist":return u.jsx(Kc,{variant:"my-playlist",children:u.jsxs("p",{className:"font-[500] opacity-[.5]",children:[a.length," Songs"]})})}},[o,a]),x=f.useMemo(()=>{switch(t){case"admin-playlist":return u.jsx(ps,{variant:"admin-playlist",songs:a,handleSetSong:m,activeExtend:r.song_in.includes(o.id)});case"my-playlist":case"dashboard-playlist":return u.jsxs(u.Fragment,{children:[u.jsx(ps,{variant:t,songs:a,handleSetSong:m,activeExtend:r.song_in.includes(o.id),deleteFromPlaylist:p}),u.jsx("div",{className:"flex justify-center mt-[20px]",children:u.jsxs(X,{onClick:()=>{var E;return(E=l.current)==null?void 0:E.toggle()},className:`${n.content_bg} rounded-full`,variant:"primary",size:"clear",children:[u.jsx(zi,{className:"w-6 mr-[5px]"}),u.jsx("span",{className:"font-playwriteCU leading-[2.2] text-sm",children:"Add song"})]})})]})}},[o,a,r]);return u.jsxs(u.Fragment,{children:[u.jsxs(bc,{children:[y,x]}),u.jsx(Wr,{ref:l,variant:"animation",children:u.jsx(bc,{children:u.jsx(zG,{closeModal:c,playlistSongs:a})})})]})}function V4(){const{currentPlaylist:t}=Q(wi),{loading:e}=qG(),n=zn(),r=f.useMemo(()=>n.pathname.includes("/dashboard/playlist"),[n]),i=f.useMemo(()=>r?u.jsx(Dg,{loading:e,type:"dashboard-playlist"}):t.by==="admin"?u.jsx(Dg,{loading:e,type:"admin-playlist"}):u.jsx(Dg,{loading:e,type:"my-playlist"}),[e]),s=f.useMemo(()=>e?u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"h-[30px] mb-[10px] flex items-center",children:u.jsx(St,{className:"h-[20px] w-[90px]"})}),Hf]}):r?u.jsx(jg,{variant:"dashboard-playlist"}):t.by==="admin"?u.jsx(jg,{variant:"admin-playlist"}):u.jsx(jg,{variant:"my-playlist"}),[e]);return u.jsxs("div",{className:"min-h-screen",children:[u.jsx($4,{}),i,u.jsx("div",{className:"pb-[50px] mt-[20px]",children:s})]})}const IQ=["mine","favorite"];function CQ({initialLoading:t}){const e=We(),{theme:n}=te(),{user:r}=mt(),{userSongs:i}=ot(),{currentSong:s}=Q(Ae),{from:o,queueSongs:a}=Q(xi),[l,c]=f.useState("mine"),[d,h]=f.useState(!1),{tempSongs:m}=Ym(),p=f.useMemo(()=>t?0:m.length+i.length,[m,i,t]),y=async()=>{if(r)return await Nh(300),h(!1)},x=async v=>{c(v),h(!0),v==="favorite"?await y():(await Nh(300),h(!1))},E=(v,g)=>{(o.length>1||i.length!==a.length||o[0]!="user")&&e(Qm({songs:i})),(s.id!==v.id||s.song_in!=="user")&&e(Nn({...v,currentIndex:g}))};return u.jsxs(u.Fragment,{children:[u.jsx(Kc,{variant:"my-songs",children:t?u.jsx(u.Fragment,{children:u.jsx("div",{className:"h-[30px] mb-[10px] flex items-center",children:u.jsx(St,{className:"h-[20px] w-[90px]"})})}):u.jsxs("p",{className:"font-[500] opacity-[.5]",children:[p," Songs"]})}),u.jsx("div",{className:"flex items-center space-x-[10px] py-[10px]",children:IQ.map((v,g)=>{const w=l===v;return u.jsx("button",{onClick:()=>x(v),className:`text-[14px] font-[500] px-[10px] 
                        ${n.content_border} border py-[4px] rounded-[99px] ${w?n.content_bg:""}
                    `,children:v==="mine"?"My songs":"Favorite"},g)})}),u.jsxs("div",{className:"min-h-[50vh]",children:[(t||d)&&Hf,!t&&!d&&u.jsxs(u.Fragment,{children:[l==="mine"&&!!p&&u.jsxs(u.Fragment,{children:[u.jsx(ps,{variant:"my-songs",handleSetSong:E,activeExtend:s.song_in==="user"||s.song_in==="favorite",songs:i,tempSongs:m}),u.jsx(ps,{songs:m,variant:"uploading"})]}),l==="favorite"&&u.jsx("img",{className:"mx-auto my-5",src:"https://d4t06.github.io/Vue-Mobile/assets/search-empty-ChRLxitn.png",alt:""})]})]})]})}function AQ(){const{theme:t}=te(),{loading:e,user:n}=mt(),{currentSong:r}=Q(Ae),{userPlaylists:i}=ot(),{status:s}=Ym(),o=vn(),{loading:a,errorMsg:l,initial:c}=Jm({});return f.useEffect(()=>{e||n&&(n.email||(o(Pt.Home),console.log(">>> navigate to home")))},[e,c]),l?u.jsx("h1",{children:l}):u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"pb-[30px] ",children:[window.innerWidth<800&&u.jsx($4,{to:""}),u.jsx("h3",{className:"font-playwriteCU leading-[2.2] mb-3 text-xl",children:"Playlist"}),u.jsx(rw,{activeCondition:!!r.song_in,loading:a,playlist:i,location:"my-songs"})]}),u.jsxs("div",{className:"pb-[30px]",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("h3",{className:"font-playwriteCU leading-[2.2] mb-3 text-xl",children:"Songs"}),u.jsxs("label",{className:`${t.content_bg} ${s==="uploading"||a?"disable":""} items-center hover:opacity-60 rounded-full flex px-3 cursor-pointer`,htmlFor:"song_upload",children:[u.jsx(MG,{className:"w-6 mr-[5px]"}),u.jsx("span",{className:" font-playwriteCU text-sm leading-[2.2] py-1",children:"Upload"})]})]}),u.jsxs(bc,{children:[l&&u.jsx("p",{children:"Some thing went wrong"}),!l&&u.jsx(CQ,{initialLoading:a})]})]})]})}function RQ(){const{theme:t}=te(),{user:e,loading:n}=mt(),[r,i]=f.useState(),[s,o]=f.useState({base:"",real_time:[],id:""}),a=f.useRef(null),l=f.useRef(!1),c=jf(),d=vn(),h=async()=>{try{const m=await Ba({collection:"songs",id:c==null?void 0:c.id,msg:">>> api: get song doc"});if(!m.exists()){d("/dashboard");return}const p=m.data();if(p.lyric_id){const y=await Ba({collection:"lyrics",id:p.lyric_id});if(y.exists()){const x=y.data();o(x)}}i(p)}catch(m){console.log({message:m})}};return f.useEffect(()=>{if(!n){if(!e)return d(Pt.Home);l.current||(l.current=!0,h())}},[]),u.jsxs("div",{className:"container mx-auto pb-[60px]",children:[u.jsx("audio",{ref:a,src:r&&r.song_url,className:"hidden"}),r&&u.jsx(u.Fragment,{children:u.jsx(D4,{admin:!0,lyric:s,audioRef:a,theme:t,song:r})})]})}function PQ(){const{theme:t}=te();return u.jsxs("div",{className:`min-h-screen flex flex-col items-center justify-center ${t.container} ${t.type==="dark"?"text-white":"text-black"}`,children:[u.jsx("h1",{className:`text-[30px] font-bold border p-[10px] ${t.type==="light"?"text-[#333]":"text-white"}`,children:"Page Not found"}),u.jsx(Yi,{to:"/",className:`${t.content_bg} font-bold  text-[#fff] mt-[20px] rounded-full flex px-[20px] py-[4px] cursor-pointer`,children:"Go home"})," "]})}function NQ(){const{theme:t}=te(),e=vn(),n=async()=>{await oC(us),e("/login")};return u.jsxs("div",{className:`${t.container} flex flex-col justify-center items-center min-h-screen`,children:[u.jsx("h1",{className:`text-[30px] font-bold border p-[10px] ${t.type==="light"?"text-[#333]":"text-white"}`,children:"Unauthorized"}),u.jsx(X,{onClick:n,variant:"primary",size:"normal",className:`${t.content_bg} font-bold text-[20px]  text-[#fff] rounded-full mt-[20px]`,children:"Exit"})]})}function DQ(){var a,l;const[t]=Tu(us),{logIn:e}=Iu(),{theme:n}=te(),r=vn(),i=zn(),s=((l=(a=i==null?void 0:i.state)==null?void 0:a.from)==null?void 0:l.pathname)||"/dashboard",o=async()=>{try{await e()}catch(c){console.log(c)}};return f.useEffect(()=>{if(t!=null&&t.email){r(s,{replace:!0});return}console.log("run effect")},[t]),u.jsxs("div",{className:`min-h-screen flex flex-col items-center justify-center ${n.container} ${n.type==="dark"?"text-white":"text-black"}`,children:[u.jsx(X,{onClick:o,variant:"default",size:"normal",className:`${n.content_bg} font-bold text-[#fff] text-[30px] rounded-full`,children:"Login with google"})," "]})}const Pt={Home:"/",Dashboard:"/dashboard",DashboardPlaylist:"/dashboard/playlist/:id",DashboardEdit:"/dashboard/edit/:id",MySongs:"/mysongs",Favorite:"/favorite",Playlist:"/playlist/:id",Edit:"/mysongs/edit/:id"},jQ=[{path:Pt.Home,component:EQ,layout:""},{path:Pt.MySongs,component:AQ,layout:""},{path:Pt.Playlist,component:V4,layout:""},{path:Pt.Edit,component:SQ,layout:""}],OQ=[{path:Pt.Dashboard,component:kQ,layout:Ng},{path:Pt.DashboardPlaylist,component:V4,layout:Ng},{path:Pt.DashboardEdit,component:RQ,layout:Ng}];function MQ(){const t={container:"my-[30px] flex flex-col md:flex-row md:justify-between items-start",icon:"w-[26px] sm:w-[20px] scale-[1] hover:scale-[1.1] transition linear ",copyRightText:"text-[14px]"};return u.jsxs("div",{className:`${t.container}`,children:[u.jsxs("p",{className:t.copyRightText,children:["Make with ❤️ by d4t06 ",u.jsx("br",{})," © All rights no reserved ¯\\_(ツ)_/¯"]}),u.jsxs("div",{className:"flex mt-[20px] md:mt-0 space-x-[10px]",children:[u.jsx("a",{href:"https://facebook.com/DAtdz06",target:"_blank",children:u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t.icon,viewBox:"0 0 448 512",fill:"currentColor",children:u.jsx("path",{d:"M400 32H48A48 48 0 0 0 0 80v352a48 48 0 0 0 48 48h137.25V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.27c-30.81 0-40.42 19.12-40.42 38.73V256h68.78l-11 71.69h-57.78V480H400a48 48 0 0 0 48-48V80a48 48 0 0 0-48-48z"})})}),u.jsx("a",{href:"https://www.linkedin.com/in/dat-nguyen-9371a926a",target:"_blank",children:u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t.icon,viewBox:"0 0 448 512",fill:"currentColor",children:u.jsx("path",{d:"M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"})})}),u.jsx("a",{href:"https://github.com/d4t06",target:"_blank",children:u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t.icon,viewBox:"0 0 496 512",fill:"currentColor",children:u.jsx("path",{d:"M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"})})})]})]})}const Wb=({children:t})=>{const{theme:e}=te(),n=zn(),r=f.useMemo(()=>n.pathname.includes("edit"),[n]),i=f.useRef(null),s={container:` main-container sm:overflow-auto no-scrollbar main-content w-full ${r?"":"min-h-[100vh] pb-[90px]"} max-[549px]:h-full `,content:"px-[40px] max-[549px]:px-[15px] mt-[60px]",page:`flex min-h-[100vh] sm:h-[100vh] sm:overflow-hidden ${e.type==="dark"?"text-white":"text-[#333]"} ${e.container}`};return u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:s.page,children:[window.innerWidth>=800&&u.jsx(sQ,{}),u.jsxs("div",{ref:i,className:s.container,children:[window.innerWidth>=800&&u.jsx(oQ,{contentRef:i}),u.jsxs("div",{className:s.content,children:[t,u.jsx(MQ,{})]})]}),u.jsx(O4,{})]}),u.jsx(B4,{})]})},LQ="/HD-MP3/assets/loading-b1210647.gif";function FQ({allowedRole:t}){const{user:e,loading:n}=mt(),{theme:r}=te();return n?u.jsx("div",{className:`min-h-screen flex flex-col items-center justify-center ${r.container}`,children:u.jsx("img",{className:"w-[150px]",src:LQ,alt:""})}):e&&(t!=null&&t.find(i=>e.role===i))||!t.length?u.jsx(fT,{}):u.jsx(aD,{replace:!0,to:"/login"})}function $Q(){const{setUser:t}=mt(),[e,n]=Tu(us);return f.useEffect(()=>{if(n)return;(async()=>{try{if(!e||!e.email)return t({type:"set-user",user:null});const s=(await Ba({collection:"users",id:e.email,msg:">>> api: get auth info"})).data();Object.assign(s,{email:e.email,display_name:e.displayName,photoURL:e.photoURL,like_song_ids:s.like_song_ids||[],playlist_ids:s.playlist_ids||[],play_history:s.play_history||[]}),t({type:"set-user",user:s})}catch(i){console.log({message:i})}})()},[n,e]),u.jsx(fT,{})}function zQ(){return u.jsxs(u.Fragment,{children:[u.jsx(pD,{children:u.jsxs(cD,{children:[u.jsx(Ti,{path:"/login",element:u.jsx(DQ,{})}),u.jsx(Ti,{path:"/unauthorized",element:u.jsx(NQ,{})}),u.jsx(Ti,{path:"*",element:u.jsx(PQ,{})}),u.jsxs(Ti,{element:u.jsx($Q,{}),children:[jQ.map((t,e)=>{let n;const r=t.component;return t.layout?n=t.layout:n=Wb,u.jsx(Ti,{path:t.path,element:u.jsx(n,{children:u.jsx(r,{})})},e)}),u.jsx(Ti,{element:u.jsx(FQ,{allowedRole:["ADMIN"]}),children:OQ.map((t,e)=>{let n;const r=t.component;return t.layout?n=t.layout:n=Wb,u.jsx(Ti,{path:t.path,element:u.jsx(n,{children:u.jsx(r,{})})},e)})})]})]})}),u.jsx(gQ,{autoClose:!0})]})}const BQ=Dq({reducer:{currentSong:qq,currentPlaylist:dG,playStatus:VG,songQueue:Qq}});Og.createRoot(document.getElementById("root")).render(u.jsx(tk.StrictMode,{children:u.jsx(eG,{children:u.jsx(VF,{children:u.jsx(a$,{children:u.jsx(rG,{children:u.jsx(aG,{children:u.jsx(ZH,{store:BQ,children:u.jsx(zQ,{})})})})})})})}));
