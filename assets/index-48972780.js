function l5(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function wE(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var _E={exports:{}},Yf={},SE={exports:{}},Pe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Iu=Symbol.for("react.element"),c5=Symbol.for("react.portal"),u5=Symbol.for("react.fragment"),d5=Symbol.for("react.strict_mode"),h5=Symbol.for("react.profiler"),f5=Symbol.for("react.provider"),m5=Symbol.for("react.context"),p5=Symbol.for("react.forward_ref"),g5=Symbol.for("react.suspense"),x5=Symbol.for("react.memo"),y5=Symbol.for("react.lazy"),u_=Symbol.iterator;function v5(t){return t===null||typeof t!="object"?null:(t=u_&&t[u_]||t["@@iterator"],typeof t=="function"?t:null)}var bE={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},EE=Object.assign,jE={};function Il(t,e,n){this.props=t,this.context=e,this.refs=jE,this.updater=n||bE}Il.prototype.isReactComponent={};Il.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Il.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function kE(){}kE.prototype=Il.prototype;function dy(t,e,n){this.props=t,this.context=e,this.refs=jE,this.updater=n||bE}var hy=dy.prototype=new kE;hy.constructor=dy;EE(hy,Il.prototype);hy.isPureReactComponent=!0;var d_=Array.isArray,TE=Object.prototype.hasOwnProperty,fy={current:null},IE={key:!0,ref:!0,__self:!0,__source:!0};function CE(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)TE.call(e,r)&&!IE.hasOwnProperty(r)&&(s[r]=e[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:Iu,type:t,key:i,ref:o,props:s,_owner:fy.current}}function w5(t,e){return{$$typeof:Iu,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function my(t){return typeof t=="object"&&t!==null&&t.$$typeof===Iu}function _5(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var h_=/\/+/g;function Wp(t,e){return typeof t=="object"&&t!==null&&t.key!=null?_5(""+t.key):e.toString(36)}function dh(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Iu:case c5:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+Wp(o,0):r,d_(s)?(n="",t!=null&&(n=t.replace(h_,"$&/")+"/"),dh(s,e,n,"",function(u){return u})):s!=null&&(my(s)&&(s=w5(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(h_,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",d_(t))for(var l=0;l<t.length;l++){i=t[l];var c=r+Wp(i,l);o+=dh(i,e,n,c,s)}else if(c=v5(t),typeof c=="function")for(t=c.call(t),l=0;!(i=t.next()).done;)i=i.value,c=r+Wp(i,l++),o+=dh(i,e,n,c,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Rd(t,e,n){if(t==null)return t;var r=[],s=0;return dh(t,r,"","",function(i){return e.call(n,i,s++)}),r}function S5(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Bn={current:null},hh={transition:null},b5={ReactCurrentDispatcher:Bn,ReactCurrentBatchConfig:hh,ReactCurrentOwner:fy};Pe.Children={map:Rd,forEach:function(t,e,n){Rd(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Rd(t,function(){e++}),e},toArray:function(t){return Rd(t,function(e){return e})||[]},only:function(t){if(!my(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Pe.Component=Il;Pe.Fragment=u5;Pe.Profiler=h5;Pe.PureComponent=dy;Pe.StrictMode=d5;Pe.Suspense=g5;Pe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=b5;Pe.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=EE({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=fy.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)TE.call(e,c)&&!IE.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:Iu,type:t.type,key:s,ref:i,props:r,_owner:o}};Pe.createContext=function(t){return t={$$typeof:m5,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:f5,_context:t},t.Consumer=t};Pe.createElement=CE;Pe.createFactory=function(t){var e=CE.bind(null,t);return e.type=t,e};Pe.createRef=function(){return{current:null}};Pe.forwardRef=function(t){return{$$typeof:p5,render:t}};Pe.isValidElement=my;Pe.lazy=function(t){return{$$typeof:y5,_payload:{_status:-1,_result:t},_init:S5}};Pe.memo=function(t,e){return{$$typeof:x5,type:t,compare:e===void 0?null:e}};Pe.startTransition=function(t){var e=hh.transition;hh.transition={};try{t()}finally{hh.transition=e}};Pe.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Pe.useCallback=function(t,e){return Bn.current.useCallback(t,e)};Pe.useContext=function(t){return Bn.current.useContext(t)};Pe.useDebugValue=function(){};Pe.useDeferredValue=function(t){return Bn.current.useDeferredValue(t)};Pe.useEffect=function(t,e){return Bn.current.useEffect(t,e)};Pe.useId=function(){return Bn.current.useId()};Pe.useImperativeHandle=function(t,e,n){return Bn.current.useImperativeHandle(t,e,n)};Pe.useInsertionEffect=function(t,e){return Bn.current.useInsertionEffect(t,e)};Pe.useLayoutEffect=function(t,e){return Bn.current.useLayoutEffect(t,e)};Pe.useMemo=function(t,e){return Bn.current.useMemo(t,e)};Pe.useReducer=function(t,e,n){return Bn.current.useReducer(t,e,n)};Pe.useRef=function(t){return Bn.current.useRef(t)};Pe.useState=function(t){return Bn.current.useState(t)};Pe.useSyncExternalStore=function(t,e,n){return Bn.current.useSyncExternalStore(t,e,n)};Pe.useTransition=function(){return Bn.current.useTransition()};Pe.version="18.2.0";SE.exports=Pe;var h=SE.exports;const RE=wE(h),E5=l5({__proto__:null,default:RE},[h]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var j5=h,k5=Symbol.for("react.element"),T5=Symbol.for("react.fragment"),I5=Object.prototype.hasOwnProperty,C5=j5.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,R5={key:!0,ref:!0,__self:!0,__source:!0};function NE(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)I5.call(e,r)&&!R5.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:k5,type:t,key:i,ref:o,props:s,_owner:C5.current}}Yf.Fragment=T5;Yf.jsx=NE;Yf.jsxs=NE;_E.exports=Yf;var a=_E.exports;var a0={},AE={exports:{}},wr={},PE={exports:{}},FE={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(H,K){var ee=H.length;H.push(K);e:for(;0<ee;){var be=ee-1>>>1,Re=H[be];if(0<s(Re,K))H[be]=K,H[ee]=Re,ee=be;else break e}}function n(H){return H.length===0?null:H[0]}function r(H){if(H.length===0)return null;var K=H[0],ee=H.pop();if(ee!==K){H[0]=ee;e:for(var be=0,Re=H.length,Oe=Re>>>1;be<Oe;){var kn=2*(be+1)-1,jr=H[kn],kr=kn+1,xe=H[kr];if(0>s(jr,ee))kr<Re&&0>s(xe,jr)?(H[be]=xe,H[kr]=ee,be=kr):(H[be]=jr,H[kn]=ee,be=kn);else if(kr<Re&&0>s(xe,ee))H[be]=xe,H[kr]=ee,be=kr;else break e}}return K}function s(H,K){var ee=H.sortIndex-K.sortIndex;return ee!==0?ee:H.id-K.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,m=null,p=3,g=!1,x=!1,w=!1,v=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function E(H){for(var K=n(u);K!==null;){if(K.callback===null)r(u);else if(K.startTime<=H)r(u),K.sortIndex=K.expirationTime,e(c,K);else break;K=n(u)}}function I(H){if(w=!1,E(H),!x)if(n(c)!==null)x=!0,he(N);else{var K=n(u);K!==null&&ge(I,K.startTime-H)}}function N(H,K){x=!1,w&&(w=!1,S(j),j=-1),g=!0;var ee=p;try{for(E(K),m=n(c);m!==null&&(!(m.expirationTime>K)||H&&!A());){var be=m.callback;if(typeof be=="function"){m.callback=null,p=m.priorityLevel;var Re=be(m.expirationTime<=K);K=t.unstable_now(),typeof Re=="function"?m.callback=Re:m===n(c)&&r(c),E(K)}else r(c);m=n(c)}if(m!==null)var Oe=!0;else{var kn=n(u);kn!==null&&ge(I,kn.startTime-K),Oe=!1}return Oe}finally{m=null,p=ee,g=!1}}var F=!1,k=null,j=-1,C=5,R=-1;function A(){return!(t.unstable_now()-R<C)}function M(){if(k!==null){var H=t.unstable_now();R=H;var K=!0;try{K=k(!0,H)}finally{K?P():(F=!1,k=null)}}else F=!1}var P;if(typeof _=="function")P=function(){_(M)};else if(typeof MessageChannel<"u"){var we=new MessageChannel,ne=we.port2;we.port1.onmessage=M,P=function(){ne.postMessage(null)}}else P=function(){v(M,0)};function he(H){k=H,F||(F=!0,P())}function ge(H,K){j=v(function(){H(t.unstable_now())},K)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(H){H.callback=null},t.unstable_continueExecution=function(){x||g||(x=!0,he(N))},t.unstable_forceFrameRate=function(H){0>H||125<H?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<H?Math.floor(1e3/H):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(H){switch(p){case 1:case 2:case 3:var K=3;break;default:K=p}var ee=p;p=K;try{return H()}finally{p=ee}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(H,K){switch(H){case 1:case 2:case 3:case 4:case 5:break;default:H=3}var ee=p;p=H;try{return K()}finally{p=ee}},t.unstable_scheduleCallback=function(H,K,ee){var be=t.unstable_now();switch(typeof ee=="object"&&ee!==null?(ee=ee.delay,ee=typeof ee=="number"&&0<ee?be+ee:be):ee=be,H){case 1:var Re=-1;break;case 2:Re=250;break;case 5:Re=1073741823;break;case 4:Re=1e4;break;default:Re=5e3}return Re=ee+Re,H={id:d++,callback:K,priorityLevel:H,startTime:ee,expirationTime:Re,sortIndex:-1},ee>be?(H.sortIndex=ee,e(u,H),n(c)===null&&H===n(u)&&(w?(S(j),j=-1):w=!0,ge(I,ee-be))):(H.sortIndex=Re,e(c,H),x||g||(x=!0,he(N))),H},t.unstable_shouldYield=A,t.unstable_wrapCallback=function(H){var K=p;return function(){var ee=p;p=K;try{return H.apply(this,arguments)}finally{p=ee}}}})(FE);PE.exports=FE;var N5=PE.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ME=h,gr=N5;function U(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var DE=new Set,Hc={};function no(t,e){sl(t,e),sl(t+"Capture",e)}function sl(t,e){for(Hc[t]=e,t=0;t<e.length;t++)DE.add(e[t])}var Js=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),o0=Object.prototype.hasOwnProperty,A5=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f_={},m_={};function P5(t){return o0.call(m_,t)?!0:o0.call(f_,t)?!1:A5.test(t)?m_[t]=!0:(f_[t]=!0,!1)}function F5(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function M5(t,e,n,r){if(e===null||typeof e>"u"||F5(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Vn(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var rn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){rn[t]=new Vn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];rn[e]=new Vn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){rn[t]=new Vn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){rn[t]=new Vn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){rn[t]=new Vn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){rn[t]=new Vn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){rn[t]=new Vn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){rn[t]=new Vn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){rn[t]=new Vn(t,5,!1,t.toLowerCase(),null,!1,!1)});var py=/[\-:]([a-z])/g;function gy(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(py,gy);rn[e]=new Vn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(py,gy);rn[e]=new Vn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(py,gy);rn[e]=new Vn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){rn[t]=new Vn(t,1,!1,t.toLowerCase(),null,!1,!1)});rn.xlinkHref=new Vn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){rn[t]=new Vn(t,1,!1,t.toLowerCase(),null,!0,!0)});function xy(t,e,n,r){var s=rn.hasOwnProperty(e)?rn[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(M5(e,n,s,r)&&(n=null),r||s===null?P5(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var oi=ME.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Nd=Symbol.for("react.element"),Ao=Symbol.for("react.portal"),Po=Symbol.for("react.fragment"),yy=Symbol.for("react.strict_mode"),l0=Symbol.for("react.profiler"),LE=Symbol.for("react.provider"),OE=Symbol.for("react.context"),vy=Symbol.for("react.forward_ref"),c0=Symbol.for("react.suspense"),u0=Symbol.for("react.suspense_list"),wy=Symbol.for("react.memo"),Ei=Symbol.for("react.lazy"),$E=Symbol.for("react.offscreen"),p_=Symbol.iterator;function lc(t){return t===null||typeof t!="object"?null:(t=p_&&t[p_]||t["@@iterator"],typeof t=="function"?t:null)}var ct=Object.assign,qp;function wc(t){if(qp===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);qp=e&&e[1]||""}return`
`+qp+t}var Kp=!1;function Qp(t,e){if(!t||Kp)return"";Kp=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,l=i.length-1;1<=o&&0<=l&&s[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==i[l]){var c=`
`+s[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=l);break}}}finally{Kp=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?wc(t):""}function D5(t){switch(t.tag){case 5:return wc(t.type);case 16:return wc("Lazy");case 13:return wc("Suspense");case 19:return wc("SuspenseList");case 0:case 2:case 15:return t=Qp(t.type,!1),t;case 11:return t=Qp(t.type.render,!1),t;case 1:return t=Qp(t.type,!0),t;default:return""}}function d0(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Po:return"Fragment";case Ao:return"Portal";case l0:return"Profiler";case yy:return"StrictMode";case c0:return"Suspense";case u0:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case OE:return(t.displayName||"Context")+".Consumer";case LE:return(t._context.displayName||"Context")+".Provider";case vy:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case wy:return e=t.displayName||null,e!==null?e:d0(t.type)||"Memo";case Ei:e=t._payload,t=t._init;try{return d0(t(e))}catch{}}return null}function L5(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return d0(e);case 8:return e===yy?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Xi(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function zE(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function O5(t){var e=zE(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Ad(t){t._valueTracker||(t._valueTracker=O5(t))}function BE(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=zE(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Oh(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function h0(t,e){var n=e.checked;return ct({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function g_(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Xi(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function VE(t,e){e=e.checked,e!=null&&xy(t,"checked",e,!1)}function f0(t,e){VE(t,e);var n=Xi(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?m0(t,e.type,n):e.hasOwnProperty("defaultValue")&&m0(t,e.type,Xi(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function x_(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function m0(t,e,n){(e!=="number"||Oh(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var _c=Array.isArray;function qo(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Xi(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function p0(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(U(91));return ct({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function y_(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(U(92));if(_c(n)){if(1<n.length)throw Error(U(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Xi(n)}}function UE(t,e){var n=Xi(e.value),r=Xi(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function v_(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function HE(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function g0(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?HE(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Pd,GE=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Pd=Pd||document.createElement("div"),Pd.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Pd.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Gc(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Rc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},$5=["Webkit","ms","Moz","O"];Object.keys(Rc).forEach(function(t){$5.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Rc[e]=Rc[t]})});function WE(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Rc.hasOwnProperty(t)&&Rc[t]?(""+e).trim():e+"px"}function qE(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=WE(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var z5=ct({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function x0(t,e){if(e){if(z5[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(U(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(U(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(U(61))}if(e.style!=null&&typeof e.style!="object")throw Error(U(62))}}function y0(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var v0=null;function _y(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var w0=null,Ko=null,Qo=null;function w_(t){if(t=Nu(t)){if(typeof w0!="function")throw Error(U(280));var e=t.stateNode;e&&(e=nm(e),w0(t.stateNode,t.type,e))}}function KE(t){Ko?Qo?Qo.push(t):Qo=[t]:Ko=t}function QE(){if(Ko){var t=Ko,e=Qo;if(Qo=Ko=null,w_(t),e)for(t=0;t<e.length;t++)w_(e[t])}}function XE(t,e){return t(e)}function YE(){}var Xp=!1;function JE(t,e,n){if(Xp)return t(e,n);Xp=!0;try{return XE(t,e,n)}finally{Xp=!1,(Ko!==null||Qo!==null)&&(YE(),QE())}}function Wc(t,e){var n=t.stateNode;if(n===null)return null;var r=nm(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(U(231,e,typeof n));return n}var _0=!1;if(Js)try{var cc={};Object.defineProperty(cc,"passive",{get:function(){_0=!0}}),window.addEventListener("test",cc,cc),window.removeEventListener("test",cc,cc)}catch{_0=!1}function B5(t,e,n,r,s,i,o,l,c){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(d){this.onError(d)}}var Nc=!1,$h=null,zh=!1,S0=null,V5={onError:function(t){Nc=!0,$h=t}};function U5(t,e,n,r,s,i,o,l,c){Nc=!1,$h=null,B5.apply(V5,arguments)}function H5(t,e,n,r,s,i,o,l,c){if(U5.apply(this,arguments),Nc){if(Nc){var u=$h;Nc=!1,$h=null}else throw Error(U(198));zh||(zh=!0,S0=u)}}function ro(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function ZE(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function __(t){if(ro(t)!==t)throw Error(U(188))}function G5(t){var e=t.alternate;if(!e){if(e=ro(t),e===null)throw Error(U(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return __(s),t;if(i===r)return __(s),e;i=i.sibling}throw Error(U(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o)throw Error(U(189))}}if(n.alternate!==r)throw Error(U(190))}if(n.tag!==3)throw Error(U(188));return n.stateNode.current===n?t:e}function ej(t){return t=G5(t),t!==null?tj(t):null}function tj(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=tj(t);if(e!==null)return e;t=t.sibling}return null}var nj=gr.unstable_scheduleCallback,S_=gr.unstable_cancelCallback,W5=gr.unstable_shouldYield,q5=gr.unstable_requestPaint,yt=gr.unstable_now,K5=gr.unstable_getCurrentPriorityLevel,Sy=gr.unstable_ImmediatePriority,rj=gr.unstable_UserBlockingPriority,Bh=gr.unstable_NormalPriority,Q5=gr.unstable_LowPriority,sj=gr.unstable_IdlePriority,Jf=null,vs=null;function X5(t){if(vs&&typeof vs.onCommitFiberRoot=="function")try{vs.onCommitFiberRoot(Jf,t,void 0,(t.current.flags&128)===128)}catch{}}var Yr=Math.clz32?Math.clz32:Z5,Y5=Math.log,J5=Math.LN2;function Z5(t){return t>>>=0,t===0?32:31-(Y5(t)/J5|0)|0}var Fd=64,Md=4194304;function Sc(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Vh(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var l=o&~s;l!==0?r=Sc(l):(i&=o,i!==0&&(r=Sc(i)))}else o=n&~s,o!==0?r=Sc(o):i!==0&&(r=Sc(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Yr(e),s=1<<n,r|=t[n],e&=~s;return r}function eP(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function tP(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-Yr(i),l=1<<o,c=s[o];c===-1?(!(l&n)||l&r)&&(s[o]=eP(l,e)):c<=e&&(t.expiredLanes|=l),i&=~l}}function b0(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function ij(){var t=Fd;return Fd<<=1,!(Fd&4194240)&&(Fd=64),t}function Yp(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Cu(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Yr(e),t[e]=n}function nP(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-Yr(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function by(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Yr(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var He=0;function aj(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var oj,Ey,lj,cj,uj,E0=!1,Dd=[],Di=null,Li=null,Oi=null,qc=new Map,Kc=new Map,ki=[],rP="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function b_(t,e){switch(t){case"focusin":case"focusout":Di=null;break;case"dragenter":case"dragleave":Li=null;break;case"mouseover":case"mouseout":Oi=null;break;case"pointerover":case"pointerout":qc.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Kc.delete(e.pointerId)}}function uc(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=Nu(e),e!==null&&Ey(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function sP(t,e,n,r,s){switch(e){case"focusin":return Di=uc(Di,t,e,n,r,s),!0;case"dragenter":return Li=uc(Li,t,e,n,r,s),!0;case"mouseover":return Oi=uc(Oi,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return qc.set(i,uc(qc.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Kc.set(i,uc(Kc.get(i)||null,t,e,n,r,s)),!0}return!1}function dj(t){var e=Ta(t.target);if(e!==null){var n=ro(e);if(n!==null){if(e=n.tag,e===13){if(e=ZE(n),e!==null){t.blockedOn=e,uj(t.priority,function(){lj(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function fh(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=j0(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);v0=r,n.target.dispatchEvent(r),v0=null}else return e=Nu(n),e!==null&&Ey(e),t.blockedOn=n,!1;e.shift()}return!0}function E_(t,e,n){fh(t)&&n.delete(e)}function iP(){E0=!1,Di!==null&&fh(Di)&&(Di=null),Li!==null&&fh(Li)&&(Li=null),Oi!==null&&fh(Oi)&&(Oi=null),qc.forEach(E_),Kc.forEach(E_)}function dc(t,e){t.blockedOn===e&&(t.blockedOn=null,E0||(E0=!0,gr.unstable_scheduleCallback(gr.unstable_NormalPriority,iP)))}function Qc(t){function e(s){return dc(s,t)}if(0<Dd.length){dc(Dd[0],t);for(var n=1;n<Dd.length;n++){var r=Dd[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Di!==null&&dc(Di,t),Li!==null&&dc(Li,t),Oi!==null&&dc(Oi,t),qc.forEach(e),Kc.forEach(e),n=0;n<ki.length;n++)r=ki[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<ki.length&&(n=ki[0],n.blockedOn===null);)dj(n),n.blockedOn===null&&ki.shift()}var Xo=oi.ReactCurrentBatchConfig,Uh=!0;function aP(t,e,n,r){var s=He,i=Xo.transition;Xo.transition=null;try{He=1,jy(t,e,n,r)}finally{He=s,Xo.transition=i}}function oP(t,e,n,r){var s=He,i=Xo.transition;Xo.transition=null;try{He=4,jy(t,e,n,r)}finally{He=s,Xo.transition=i}}function jy(t,e,n,r){if(Uh){var s=j0(t,e,n,r);if(s===null)og(t,e,r,Hh,n),b_(t,r);else if(sP(s,t,e,n,r))r.stopPropagation();else if(b_(t,r),e&4&&-1<rP.indexOf(t)){for(;s!==null;){var i=Nu(s);if(i!==null&&oj(i),i=j0(t,e,n,r),i===null&&og(t,e,r,Hh,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else og(t,e,r,null,n)}}var Hh=null;function j0(t,e,n,r){if(Hh=null,t=_y(r),t=Ta(t),t!==null)if(e=ro(t),e===null)t=null;else if(n=e.tag,n===13){if(t=ZE(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Hh=t,null}function hj(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(K5()){case Sy:return 1;case rj:return 4;case Bh:case Q5:return 16;case sj:return 536870912;default:return 16}default:return 16}}var Ai=null,ky=null,mh=null;function fj(){if(mh)return mh;var t,e=ky,n=e.length,r,s="value"in Ai?Ai.value:Ai.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return mh=s.slice(t,1<r?1-r:void 0)}function ph(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Ld(){return!0}function j_(){return!1}function _r(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Ld:j_,this.isPropagationStopped=j_,this}return ct(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Ld)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Ld)},persist:function(){},isPersistent:Ld}),e}var Cl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ty=_r(Cl),Ru=ct({},Cl,{view:0,detail:0}),lP=_r(Ru),Jp,Zp,hc,Zf=ct({},Ru,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Iy,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==hc&&(hc&&t.type==="mousemove"?(Jp=t.screenX-hc.screenX,Zp=t.screenY-hc.screenY):Zp=Jp=0,hc=t),Jp)},movementY:function(t){return"movementY"in t?t.movementY:Zp}}),k_=_r(Zf),cP=ct({},Zf,{dataTransfer:0}),uP=_r(cP),dP=ct({},Ru,{relatedTarget:0}),eg=_r(dP),hP=ct({},Cl,{animationName:0,elapsedTime:0,pseudoElement:0}),fP=_r(hP),mP=ct({},Cl,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),pP=_r(mP),gP=ct({},Cl,{data:0}),T_=_r(gP),xP={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},yP={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},vP={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function wP(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=vP[t])?!!e[t]:!1}function Iy(){return wP}var _P=ct({},Ru,{key:function(t){if(t.key){var e=xP[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=ph(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?yP[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Iy,charCode:function(t){return t.type==="keypress"?ph(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?ph(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),SP=_r(_P),bP=ct({},Zf,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),I_=_r(bP),EP=ct({},Ru,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Iy}),jP=_r(EP),kP=ct({},Cl,{propertyName:0,elapsedTime:0,pseudoElement:0}),TP=_r(kP),IP=ct({},Zf,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),CP=_r(IP),RP=[9,13,27,32],Cy=Js&&"CompositionEvent"in window,Ac=null;Js&&"documentMode"in document&&(Ac=document.documentMode);var NP=Js&&"TextEvent"in window&&!Ac,mj=Js&&(!Cy||Ac&&8<Ac&&11>=Ac),C_=String.fromCharCode(32),R_=!1;function pj(t,e){switch(t){case"keyup":return RP.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function gj(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Fo=!1;function AP(t,e){switch(t){case"compositionend":return gj(e);case"keypress":return e.which!==32?null:(R_=!0,C_);case"textInput":return t=e.data,t===C_&&R_?null:t;default:return null}}function PP(t,e){if(Fo)return t==="compositionend"||!Cy&&pj(t,e)?(t=fj(),mh=ky=Ai=null,Fo=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return mj&&e.locale!=="ko"?null:e.data;default:return null}}var FP={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function N_(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!FP[t.type]:e==="textarea"}function xj(t,e,n,r){KE(r),e=Gh(e,"onChange"),0<e.length&&(n=new Ty("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Pc=null,Xc=null;function MP(t){Ij(t,0)}function em(t){var e=Lo(t);if(BE(e))return t}function DP(t,e){if(t==="change")return e}var yj=!1;if(Js){var tg;if(Js){var ng="oninput"in document;if(!ng){var A_=document.createElement("div");A_.setAttribute("oninput","return;"),ng=typeof A_.oninput=="function"}tg=ng}else tg=!1;yj=tg&&(!document.documentMode||9<document.documentMode)}function P_(){Pc&&(Pc.detachEvent("onpropertychange",vj),Xc=Pc=null)}function vj(t){if(t.propertyName==="value"&&em(Xc)){var e=[];xj(e,Xc,t,_y(t)),JE(MP,e)}}function LP(t,e,n){t==="focusin"?(P_(),Pc=e,Xc=n,Pc.attachEvent("onpropertychange",vj)):t==="focusout"&&P_()}function OP(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return em(Xc)}function $P(t,e){if(t==="click")return em(e)}function zP(t,e){if(t==="input"||t==="change")return em(e)}function BP(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var ts=typeof Object.is=="function"?Object.is:BP;function Yc(t,e){if(ts(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!o0.call(e,s)||!ts(t[s],e[s]))return!1}return!0}function F_(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function M_(t,e){var n=F_(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=F_(n)}}function wj(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?wj(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function _j(){for(var t=window,e=Oh();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Oh(t.document)}return e}function Ry(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function VP(t){var e=_j(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&wj(n.ownerDocument.documentElement,n)){if(r!==null&&Ry(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=M_(n,i);var o=M_(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var UP=Js&&"documentMode"in document&&11>=document.documentMode,Mo=null,k0=null,Fc=null,T0=!1;function D_(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;T0||Mo==null||Mo!==Oh(r)||(r=Mo,"selectionStart"in r&&Ry(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Fc&&Yc(Fc,r)||(Fc=r,r=Gh(k0,"onSelect"),0<r.length&&(e=new Ty("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Mo)))}function Od(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Do={animationend:Od("Animation","AnimationEnd"),animationiteration:Od("Animation","AnimationIteration"),animationstart:Od("Animation","AnimationStart"),transitionend:Od("Transition","TransitionEnd")},rg={},Sj={};Js&&(Sj=document.createElement("div").style,"AnimationEvent"in window||(delete Do.animationend.animation,delete Do.animationiteration.animation,delete Do.animationstart.animation),"TransitionEvent"in window||delete Do.transitionend.transition);function tm(t){if(rg[t])return rg[t];if(!Do[t])return t;var e=Do[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Sj)return rg[t]=e[n];return t}var bj=tm("animationend"),Ej=tm("animationiteration"),jj=tm("animationstart"),kj=tm("transitionend"),Tj=new Map,L_="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function sa(t,e){Tj.set(t,e),no(e,[t])}for(var sg=0;sg<L_.length;sg++){var ig=L_[sg],HP=ig.toLowerCase(),GP=ig[0].toUpperCase()+ig.slice(1);sa(HP,"on"+GP)}sa(bj,"onAnimationEnd");sa(Ej,"onAnimationIteration");sa(jj,"onAnimationStart");sa("dblclick","onDoubleClick");sa("focusin","onFocus");sa("focusout","onBlur");sa(kj,"onTransitionEnd");sl("onMouseEnter",["mouseout","mouseover"]);sl("onMouseLeave",["mouseout","mouseover"]);sl("onPointerEnter",["pointerout","pointerover"]);sl("onPointerLeave",["pointerout","pointerover"]);no("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));no("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));no("onBeforeInput",["compositionend","keypress","textInput","paste"]);no("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));no("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));no("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var bc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),WP=new Set("cancel close invalid load scroll toggle".split(" ").concat(bc));function O_(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,H5(r,e,void 0,t),t.currentTarget=null}function Ij(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var l=r[o],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==i&&s.isPropagationStopped())break e;O_(s,l,u),i=c}else for(o=0;o<r.length;o++){if(l=r[o],c=l.instance,u=l.currentTarget,l=l.listener,c!==i&&s.isPropagationStopped())break e;O_(s,l,u),i=c}}}if(zh)throw t=S0,zh=!1,S0=null,t}function Ze(t,e){var n=e[A0];n===void 0&&(n=e[A0]=new Set);var r=t+"__bubble";n.has(r)||(Cj(e,t,2,!1),n.add(r))}function ag(t,e,n){var r=0;e&&(r|=4),Cj(n,t,r,e)}var $d="_reactListening"+Math.random().toString(36).slice(2);function Jc(t){if(!t[$d]){t[$d]=!0,DE.forEach(function(n){n!=="selectionchange"&&(WP.has(n)||ag(n,!1,t),ag(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[$d]||(e[$d]=!0,ag("selectionchange",!1,e))}}function Cj(t,e,n,r){switch(hj(e)){case 1:var s=aP;break;case 4:s=oP;break;default:s=jy}n=s.bind(null,e,n,t),s=void 0,!_0||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function og(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;o=o.return}for(;l!==null;){if(o=Ta(l),o===null)return;if(c=o.tag,c===5||c===6){r=i=o;continue e}l=l.parentNode}}r=r.return}JE(function(){var u=i,d=_y(n),m=[];e:{var p=Tj.get(t);if(p!==void 0){var g=Ty,x=t;switch(t){case"keypress":if(ph(n)===0)break e;case"keydown":case"keyup":g=SP;break;case"focusin":x="focus",g=eg;break;case"focusout":x="blur",g=eg;break;case"beforeblur":case"afterblur":g=eg;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=k_;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=uP;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=jP;break;case bj:case Ej:case jj:g=fP;break;case kj:g=TP;break;case"scroll":g=lP;break;case"wheel":g=CP;break;case"copy":case"cut":case"paste":g=pP;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=I_}var w=(e&4)!==0,v=!w&&t==="scroll",S=w?p!==null?p+"Capture":null:p;w=[];for(var _=u,E;_!==null;){E=_;var I=E.stateNode;if(E.tag===5&&I!==null&&(E=I,S!==null&&(I=Wc(_,S),I!=null&&w.push(Zc(_,I,E)))),v)break;_=_.return}0<w.length&&(p=new g(p,x,null,n,d),m.push({event:p,listeners:w}))}}if(!(e&7)){e:{if(p=t==="mouseover"||t==="pointerover",g=t==="mouseout"||t==="pointerout",p&&n!==v0&&(x=n.relatedTarget||n.fromElement)&&(Ta(x)||x[Zs]))break e;if((g||p)&&(p=d.window===d?d:(p=d.ownerDocument)?p.defaultView||p.parentWindow:window,g?(x=n.relatedTarget||n.toElement,g=u,x=x?Ta(x):null,x!==null&&(v=ro(x),x!==v||x.tag!==5&&x.tag!==6)&&(x=null)):(g=null,x=u),g!==x)){if(w=k_,I="onMouseLeave",S="onMouseEnter",_="mouse",(t==="pointerout"||t==="pointerover")&&(w=I_,I="onPointerLeave",S="onPointerEnter",_="pointer"),v=g==null?p:Lo(g),E=x==null?p:Lo(x),p=new w(I,_+"leave",g,n,d),p.target=v,p.relatedTarget=E,I=null,Ta(d)===u&&(w=new w(S,_+"enter",x,n,d),w.target=E,w.relatedTarget=v,I=w),v=I,g&&x)t:{for(w=g,S=x,_=0,E=w;E;E=bo(E))_++;for(E=0,I=S;I;I=bo(I))E++;for(;0<_-E;)w=bo(w),_--;for(;0<E-_;)S=bo(S),E--;for(;_--;){if(w===S||S!==null&&w===S.alternate)break t;w=bo(w),S=bo(S)}w=null}else w=null;g!==null&&$_(m,p,g,w,!1),x!==null&&v!==null&&$_(m,v,x,w,!0)}}e:{if(p=u?Lo(u):window,g=p.nodeName&&p.nodeName.toLowerCase(),g==="select"||g==="input"&&p.type==="file")var N=DP;else if(N_(p))if(yj)N=zP;else{N=OP;var F=LP}else(g=p.nodeName)&&g.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(N=$P);if(N&&(N=N(t,u))){xj(m,N,n,d);break e}F&&F(t,p,u),t==="focusout"&&(F=p._wrapperState)&&F.controlled&&p.type==="number"&&m0(p,"number",p.value)}switch(F=u?Lo(u):window,t){case"focusin":(N_(F)||F.contentEditable==="true")&&(Mo=F,k0=u,Fc=null);break;case"focusout":Fc=k0=Mo=null;break;case"mousedown":T0=!0;break;case"contextmenu":case"mouseup":case"dragend":T0=!1,D_(m,n,d);break;case"selectionchange":if(UP)break;case"keydown":case"keyup":D_(m,n,d)}var k;if(Cy)e:{switch(t){case"compositionstart":var j="onCompositionStart";break e;case"compositionend":j="onCompositionEnd";break e;case"compositionupdate":j="onCompositionUpdate";break e}j=void 0}else Fo?pj(t,n)&&(j="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(j="onCompositionStart");j&&(mj&&n.locale!=="ko"&&(Fo||j!=="onCompositionStart"?j==="onCompositionEnd"&&Fo&&(k=fj()):(Ai=d,ky="value"in Ai?Ai.value:Ai.textContent,Fo=!0)),F=Gh(u,j),0<F.length&&(j=new T_(j,t,null,n,d),m.push({event:j,listeners:F}),k?j.data=k:(k=gj(n),k!==null&&(j.data=k)))),(k=NP?AP(t,n):PP(t,n))&&(u=Gh(u,"onBeforeInput"),0<u.length&&(d=new T_("onBeforeInput","beforeinput",null,n,d),m.push({event:d,listeners:u}),d.data=k))}Ij(m,e)})}function Zc(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Gh(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Wc(t,n),i!=null&&r.unshift(Zc(t,i,s)),i=Wc(t,e),i!=null&&r.push(Zc(t,i,s))),t=t.return}return r}function bo(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function $_(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var l=n,c=l.alternate,u=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&u!==null&&(l=u,s?(c=Wc(n,i),c!=null&&o.unshift(Zc(n,c,l))):s||(c=Wc(n,i),c!=null&&o.push(Zc(n,c,l)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var qP=/\r\n?/g,KP=/\u0000|\uFFFD/g;function z_(t){return(typeof t=="string"?t:""+t).replace(qP,`
`).replace(KP,"")}function zd(t,e,n){if(e=z_(e),z_(t)!==e&&n)throw Error(U(425))}function Wh(){}var I0=null,C0=null;function R0(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var N0=typeof setTimeout=="function"?setTimeout:void 0,QP=typeof clearTimeout=="function"?clearTimeout:void 0,B_=typeof Promise=="function"?Promise:void 0,XP=typeof queueMicrotask=="function"?queueMicrotask:typeof B_<"u"?function(t){return B_.resolve(null).then(t).catch(YP)}:N0;function YP(t){setTimeout(function(){throw t})}function lg(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),Qc(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Qc(e)}function $i(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function V_(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Rl=Math.random().toString(36).slice(2),gs="__reactFiber$"+Rl,eu="__reactProps$"+Rl,Zs="__reactContainer$"+Rl,A0="__reactEvents$"+Rl,JP="__reactListeners$"+Rl,ZP="__reactHandles$"+Rl;function Ta(t){var e=t[gs];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Zs]||n[gs]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=V_(t);t!==null;){if(n=t[gs])return n;t=V_(t)}return e}t=n,n=t.parentNode}return null}function Nu(t){return t=t[gs]||t[Zs],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Lo(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(U(33))}function nm(t){return t[eu]||null}var P0=[],Oo=-1;function ia(t){return{current:t}}function et(t){0>Oo||(t.current=P0[Oo],P0[Oo]=null,Oo--)}function Ye(t,e){Oo++,P0[Oo]=t.current,t.current=e}var Yi={},wn=ia(Yi),Xn=ia(!1),La=Yi;function il(t,e){var n=t.type.contextTypes;if(!n)return Yi;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Yn(t){return t=t.childContextTypes,t!=null}function qh(){et(Xn),et(wn)}function U_(t,e,n){if(wn.current!==Yi)throw Error(U(168));Ye(wn,e),Ye(Xn,n)}function Rj(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(U(108,L5(t)||"Unknown",s));return ct({},n,r)}function Kh(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Yi,La=wn.current,Ye(wn,t),Ye(Xn,Xn.current),!0}function H_(t,e,n){var r=t.stateNode;if(!r)throw Error(U(169));n?(t=Rj(t,e,La),r.__reactInternalMemoizedMergedChildContext=t,et(Xn),et(wn),Ye(wn,t)):et(Xn),Ye(Xn,n)}var Os=null,rm=!1,cg=!1;function Nj(t){Os===null?Os=[t]:Os.push(t)}function e3(t){rm=!0,Nj(t)}function aa(){if(!cg&&Os!==null){cg=!0;var t=0,e=He;try{var n=Os;for(He=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Os=null,rm=!1}catch(s){throw Os!==null&&(Os=Os.slice(t+1)),nj(Sy,aa),s}finally{He=e,cg=!1}}return null}var $o=[],zo=0,Qh=null,Xh=0,Cr=[],Rr=0,Oa=null,zs=1,Bs="";function _a(t,e){$o[zo++]=Xh,$o[zo++]=Qh,Qh=t,Xh=e}function Aj(t,e,n){Cr[Rr++]=zs,Cr[Rr++]=Bs,Cr[Rr++]=Oa,Oa=t;var r=zs;t=Bs;var s=32-Yr(r)-1;r&=~(1<<s),n+=1;var i=32-Yr(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,zs=1<<32-Yr(e)+s|n<<s|r,Bs=i+t}else zs=1<<i|n<<s|r,Bs=t}function Ny(t){t.return!==null&&(_a(t,1),Aj(t,1,0))}function Ay(t){for(;t===Qh;)Qh=$o[--zo],$o[zo]=null,Xh=$o[--zo],$o[zo]=null;for(;t===Oa;)Oa=Cr[--Rr],Cr[Rr]=null,Bs=Cr[--Rr],Cr[Rr]=null,zs=Cr[--Rr],Cr[Rr]=null}var fr=null,ur=null,rt=!1,qr=null;function Pj(t,e){var n=Nr(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function G_(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,fr=t,ur=$i(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,fr=t,ur=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Oa!==null?{id:zs,overflow:Bs}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Nr(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,fr=t,ur=null,!0):!1;default:return!1}}function F0(t){return(t.mode&1)!==0&&(t.flags&128)===0}function M0(t){if(rt){var e=ur;if(e){var n=e;if(!G_(t,e)){if(F0(t))throw Error(U(418));e=$i(n.nextSibling);var r=fr;e&&G_(t,e)?Pj(r,n):(t.flags=t.flags&-4097|2,rt=!1,fr=t)}}else{if(F0(t))throw Error(U(418));t.flags=t.flags&-4097|2,rt=!1,fr=t}}}function W_(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;fr=t}function Bd(t){if(t!==fr)return!1;if(!rt)return W_(t),rt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!R0(t.type,t.memoizedProps)),e&&(e=ur)){if(F0(t))throw Fj(),Error(U(418));for(;e;)Pj(t,e),e=$i(e.nextSibling)}if(W_(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(U(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){ur=$i(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}ur=null}}else ur=fr?$i(t.stateNode.nextSibling):null;return!0}function Fj(){for(var t=ur;t;)t=$i(t.nextSibling)}function al(){ur=fr=null,rt=!1}function Py(t){qr===null?qr=[t]:qr.push(t)}var t3=oi.ReactCurrentBatchConfig;function Gr(t,e){if(t&&t.defaultProps){e=ct({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var Yh=ia(null),Jh=null,Bo=null,Fy=null;function My(){Fy=Bo=Jh=null}function Dy(t){var e=Yh.current;et(Yh),t._currentValue=e}function D0(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Yo(t,e){Jh=t,Fy=Bo=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Qn=!0),t.firstContext=null)}function Pr(t){var e=t._currentValue;if(Fy!==t)if(t={context:t,memoizedValue:e,next:null},Bo===null){if(Jh===null)throw Error(U(308));Bo=t,Jh.dependencies={lanes:0,firstContext:t}}else Bo=Bo.next=t;return e}var Ia=null;function Ly(t){Ia===null?Ia=[t]:Ia.push(t)}function Mj(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,Ly(e)):(n.next=s.next,s.next=n),e.interleaved=n,ei(t,r)}function ei(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var ji=!1;function Oy(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Dj(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function qs(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function zi(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Le&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,ei(t,n)}return s=r.interleaved,s===null?(e.next=e,Ly(r)):(e.next=s.next,s.next=e),r.interleaved=e,ei(t,n)}function gh(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,by(t,n)}}function q_(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Zh(t,e,n,r){var s=t.updateQueue;ji=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,u=c.next;c.next=null,o===null?i=u:o.next=u,o=c;var d=t.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==o&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(i!==null){var m=s.baseState;o=0,d=u=c=null,l=i;do{var p=l.lane,g=l.eventTime;if((r&p)===p){d!==null&&(d=d.next={eventTime:g,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var x=t,w=l;switch(p=e,g=n,w.tag){case 1:if(x=w.payload,typeof x=="function"){m=x.call(g,m,p);break e}m=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=w.payload,p=typeof x=="function"?x.call(g,m,p):x,p==null)break e;m=ct({},m,p);break e;case 2:ji=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,p=s.effects,p===null?s.effects=[l]:p.push(l))}else g={eventTime:g,lane:p,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=g,c=m):d=d.next=g,o|=p;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;p=l,l=p.next,p.next=null,s.lastBaseUpdate=p,s.shared.pending=null}}while(1);if(d===null&&(c=m),s.baseState=c,s.firstBaseUpdate=u,s.lastBaseUpdate=d,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);za|=o,t.lanes=o,t.memoizedState=m}}function K_(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(U(191,s));s.call(r)}}}var Lj=new ME.Component().refs;function L0(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:ct({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var sm={isMounted:function(t){return(t=t._reactInternals)?ro(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=An(),s=Vi(t),i=qs(r,s);i.payload=e,n!=null&&(i.callback=n),e=zi(t,i,s),e!==null&&(Jr(e,t,s,r),gh(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=An(),s=Vi(t),i=qs(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=zi(t,i,s),e!==null&&(Jr(e,t,s,r),gh(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=An(),r=Vi(t),s=qs(n,r);s.tag=2,e!=null&&(s.callback=e),e=zi(t,s,r),e!==null&&(Jr(e,t,r,n),gh(e,t,r))}};function Q_(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!Yc(n,r)||!Yc(s,i):!0}function Oj(t,e,n){var r=!1,s=Yi,i=e.contextType;return typeof i=="object"&&i!==null?i=Pr(i):(s=Yn(e)?La:wn.current,r=e.contextTypes,i=(r=r!=null)?il(t,s):Yi),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=sm,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function X_(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&sm.enqueueReplaceState(e,e.state,null)}function O0(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs=Lj,Oy(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=Pr(i):(i=Yn(e)?La:wn.current,s.context=il(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(L0(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&sm.enqueueReplaceState(s,s.state,null),Zh(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function fc(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(U(309));var r=n.stateNode}if(!r)throw Error(U(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var l=s.refs;l===Lj&&(l=s.refs={}),o===null?delete l[i]:l[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(U(284));if(!n._owner)throw Error(U(290,t))}return t}function Vd(t,e){throw t=Object.prototype.toString.call(e),Error(U(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Y_(t){var e=t._init;return e(t._payload)}function $j(t){function e(S,_){if(t){var E=S.deletions;E===null?(S.deletions=[_],S.flags|=16):E.push(_)}}function n(S,_){if(!t)return null;for(;_!==null;)e(S,_),_=_.sibling;return null}function r(S,_){for(S=new Map;_!==null;)_.key!==null?S.set(_.key,_):S.set(_.index,_),_=_.sibling;return S}function s(S,_){return S=Ui(S,_),S.index=0,S.sibling=null,S}function i(S,_,E){return S.index=E,t?(E=S.alternate,E!==null?(E=E.index,E<_?(S.flags|=2,_):E):(S.flags|=2,_)):(S.flags|=1048576,_)}function o(S){return t&&S.alternate===null&&(S.flags|=2),S}function l(S,_,E,I){return _===null||_.tag!==6?(_=gg(E,S.mode,I),_.return=S,_):(_=s(_,E),_.return=S,_)}function c(S,_,E,I){var N=E.type;return N===Po?d(S,_,E.props.children,I,E.key):_!==null&&(_.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===Ei&&Y_(N)===_.type)?(I=s(_,E.props),I.ref=fc(S,_,E),I.return=S,I):(I=Sh(E.type,E.key,E.props,null,S.mode,I),I.ref=fc(S,_,E),I.return=S,I)}function u(S,_,E,I){return _===null||_.tag!==4||_.stateNode.containerInfo!==E.containerInfo||_.stateNode.implementation!==E.implementation?(_=xg(E,S.mode,I),_.return=S,_):(_=s(_,E.children||[]),_.return=S,_)}function d(S,_,E,I,N){return _===null||_.tag!==7?(_=Fa(E,S.mode,I,N),_.return=S,_):(_=s(_,E),_.return=S,_)}function m(S,_,E){if(typeof _=="string"&&_!==""||typeof _=="number")return _=gg(""+_,S.mode,E),_.return=S,_;if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Nd:return E=Sh(_.type,_.key,_.props,null,S.mode,E),E.ref=fc(S,null,_),E.return=S,E;case Ao:return _=xg(_,S.mode,E),_.return=S,_;case Ei:var I=_._init;return m(S,I(_._payload),E)}if(_c(_)||lc(_))return _=Fa(_,S.mode,E,null),_.return=S,_;Vd(S,_)}return null}function p(S,_,E,I){var N=_!==null?_.key:null;if(typeof E=="string"&&E!==""||typeof E=="number")return N!==null?null:l(S,_,""+E,I);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case Nd:return E.key===N?c(S,_,E,I):null;case Ao:return E.key===N?u(S,_,E,I):null;case Ei:return N=E._init,p(S,_,N(E._payload),I)}if(_c(E)||lc(E))return N!==null?null:d(S,_,E,I,null);Vd(S,E)}return null}function g(S,_,E,I,N){if(typeof I=="string"&&I!==""||typeof I=="number")return S=S.get(E)||null,l(_,S,""+I,N);if(typeof I=="object"&&I!==null){switch(I.$$typeof){case Nd:return S=S.get(I.key===null?E:I.key)||null,c(_,S,I,N);case Ao:return S=S.get(I.key===null?E:I.key)||null,u(_,S,I,N);case Ei:var F=I._init;return g(S,_,E,F(I._payload),N)}if(_c(I)||lc(I))return S=S.get(E)||null,d(_,S,I,N,null);Vd(_,I)}return null}function x(S,_,E,I){for(var N=null,F=null,k=_,j=_=0,C=null;k!==null&&j<E.length;j++){k.index>j?(C=k,k=null):C=k.sibling;var R=p(S,k,E[j],I);if(R===null){k===null&&(k=C);break}t&&k&&R.alternate===null&&e(S,k),_=i(R,_,j),F===null?N=R:F.sibling=R,F=R,k=C}if(j===E.length)return n(S,k),rt&&_a(S,j),N;if(k===null){for(;j<E.length;j++)k=m(S,E[j],I),k!==null&&(_=i(k,_,j),F===null?N=k:F.sibling=k,F=k);return rt&&_a(S,j),N}for(k=r(S,k);j<E.length;j++)C=g(k,S,j,E[j],I),C!==null&&(t&&C.alternate!==null&&k.delete(C.key===null?j:C.key),_=i(C,_,j),F===null?N=C:F.sibling=C,F=C);return t&&k.forEach(function(A){return e(S,A)}),rt&&_a(S,j),N}function w(S,_,E,I){var N=lc(E);if(typeof N!="function")throw Error(U(150));if(E=N.call(E),E==null)throw Error(U(151));for(var F=N=null,k=_,j=_=0,C=null,R=E.next();k!==null&&!R.done;j++,R=E.next()){k.index>j?(C=k,k=null):C=k.sibling;var A=p(S,k,R.value,I);if(A===null){k===null&&(k=C);break}t&&k&&A.alternate===null&&e(S,k),_=i(A,_,j),F===null?N=A:F.sibling=A,F=A,k=C}if(R.done)return n(S,k),rt&&_a(S,j),N;if(k===null){for(;!R.done;j++,R=E.next())R=m(S,R.value,I),R!==null&&(_=i(R,_,j),F===null?N=R:F.sibling=R,F=R);return rt&&_a(S,j),N}for(k=r(S,k);!R.done;j++,R=E.next())R=g(k,S,j,R.value,I),R!==null&&(t&&R.alternate!==null&&k.delete(R.key===null?j:R.key),_=i(R,_,j),F===null?N=R:F.sibling=R,F=R);return t&&k.forEach(function(M){return e(S,M)}),rt&&_a(S,j),N}function v(S,_,E,I){if(typeof E=="object"&&E!==null&&E.type===Po&&E.key===null&&(E=E.props.children),typeof E=="object"&&E!==null){switch(E.$$typeof){case Nd:e:{for(var N=E.key,F=_;F!==null;){if(F.key===N){if(N=E.type,N===Po){if(F.tag===7){n(S,F.sibling),_=s(F,E.props.children),_.return=S,S=_;break e}}else if(F.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===Ei&&Y_(N)===F.type){n(S,F.sibling),_=s(F,E.props),_.ref=fc(S,F,E),_.return=S,S=_;break e}n(S,F);break}else e(S,F);F=F.sibling}E.type===Po?(_=Fa(E.props.children,S.mode,I,E.key),_.return=S,S=_):(I=Sh(E.type,E.key,E.props,null,S.mode,I),I.ref=fc(S,_,E),I.return=S,S=I)}return o(S);case Ao:e:{for(F=E.key;_!==null;){if(_.key===F)if(_.tag===4&&_.stateNode.containerInfo===E.containerInfo&&_.stateNode.implementation===E.implementation){n(S,_.sibling),_=s(_,E.children||[]),_.return=S,S=_;break e}else{n(S,_);break}else e(S,_);_=_.sibling}_=xg(E,S.mode,I),_.return=S,S=_}return o(S);case Ei:return F=E._init,v(S,_,F(E._payload),I)}if(_c(E))return x(S,_,E,I);if(lc(E))return w(S,_,E,I);Vd(S,E)}return typeof E=="string"&&E!==""||typeof E=="number"?(E=""+E,_!==null&&_.tag===6?(n(S,_.sibling),_=s(_,E),_.return=S,S=_):(n(S,_),_=gg(E,S.mode,I),_.return=S,S=_),o(S)):n(S,_)}return v}var ol=$j(!0),zj=$j(!1),Au={},ws=ia(Au),tu=ia(Au),nu=ia(Au);function Ca(t){if(t===Au)throw Error(U(174));return t}function $y(t,e){switch(Ye(nu,e),Ye(tu,t),Ye(ws,Au),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:g0(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=g0(e,t)}et(ws),Ye(ws,e)}function ll(){et(ws),et(tu),et(nu)}function Bj(t){Ca(nu.current);var e=Ca(ws.current),n=g0(e,t.type);e!==n&&(Ye(tu,t),Ye(ws,n))}function zy(t){tu.current===t&&(et(ws),et(tu))}var ot=ia(0);function ef(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var ug=[];function By(){for(var t=0;t<ug.length;t++)ug[t]._workInProgressVersionPrimary=null;ug.length=0}var xh=oi.ReactCurrentDispatcher,dg=oi.ReactCurrentBatchConfig,$a=0,lt=null,Pt=null,Vt=null,tf=!1,Mc=!1,ru=0,n3=0;function dn(){throw Error(U(321))}function Vy(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!ts(t[n],e[n]))return!1;return!0}function Uy(t,e,n,r,s,i){if($a=i,lt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,xh.current=t===null||t.memoizedState===null?a3:o3,t=n(r,s),Mc){i=0;do{if(Mc=!1,ru=0,25<=i)throw Error(U(301));i+=1,Vt=Pt=null,e.updateQueue=null,xh.current=l3,t=n(r,s)}while(Mc)}if(xh.current=nf,e=Pt!==null&&Pt.next!==null,$a=0,Vt=Pt=lt=null,tf=!1,e)throw Error(U(300));return t}function Hy(){var t=ru!==0;return ru=0,t}function ms(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Vt===null?lt.memoizedState=Vt=t:Vt=Vt.next=t,Vt}function Fr(){if(Pt===null){var t=lt.alternate;t=t!==null?t.memoizedState:null}else t=Pt.next;var e=Vt===null?lt.memoizedState:Vt.next;if(e!==null)Vt=e,Pt=t;else{if(t===null)throw Error(U(310));Pt=t,t={memoizedState:Pt.memoizedState,baseState:Pt.baseState,baseQueue:Pt.baseQueue,queue:Pt.queue,next:null},Vt===null?lt.memoizedState=Vt=t:Vt=Vt.next=t}return Vt}function su(t,e){return typeof e=="function"?e(t):e}function hg(t){var e=Fr(),n=e.queue;if(n===null)throw Error(U(311));n.lastRenderedReducer=t;var r=Pt,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=o=null,c=null,u=i;do{var d=u.lane;if(($a&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var m={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=m,o=r):c=c.next=m,lt.lanes|=d,za|=d}u=u.next}while(u!==null&&u!==i);c===null?o=r:c.next=l,ts(r,e.memoizedState)||(Qn=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=c,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,lt.lanes|=i,za|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function fg(t){var e=Fr(),n=e.queue;if(n===null)throw Error(U(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);ts(i,e.memoizedState)||(Qn=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function Vj(){}function Uj(t,e){var n=lt,r=Fr(),s=e(),i=!ts(r.memoizedState,s);if(i&&(r.memoizedState=s,Qn=!0),r=r.queue,Gy(Wj.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||Vt!==null&&Vt.memoizedState.tag&1){if(n.flags|=2048,iu(9,Gj.bind(null,n,r,s,e),void 0,null),Ht===null)throw Error(U(349));$a&30||Hj(n,e,s)}return s}function Hj(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=lt.updateQueue,e===null?(e={lastEffect:null,stores:null},lt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function Gj(t,e,n,r){e.value=n,e.getSnapshot=r,qj(e)&&Kj(t)}function Wj(t,e,n){return n(function(){qj(e)&&Kj(t)})}function qj(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!ts(t,n)}catch{return!0}}function Kj(t){var e=ei(t,1);e!==null&&Jr(e,t,1,-1)}function J_(t){var e=ms();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:su,lastRenderedState:t},e.queue=t,t=t.dispatch=i3.bind(null,lt,t),[e.memoizedState,t]}function iu(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=lt.updateQueue,e===null?(e={lastEffect:null,stores:null},lt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function Qj(){return Fr().memoizedState}function yh(t,e,n,r){var s=ms();lt.flags|=t,s.memoizedState=iu(1|e,n,void 0,r===void 0?null:r)}function im(t,e,n,r){var s=Fr();r=r===void 0?null:r;var i=void 0;if(Pt!==null){var o=Pt.memoizedState;if(i=o.destroy,r!==null&&Vy(r,o.deps)){s.memoizedState=iu(e,n,i,r);return}}lt.flags|=t,s.memoizedState=iu(1|e,n,i,r)}function Z_(t,e){return yh(8390656,8,t,e)}function Gy(t,e){return im(2048,8,t,e)}function Xj(t,e){return im(4,2,t,e)}function Yj(t,e){return im(4,4,t,e)}function Jj(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Zj(t,e,n){return n=n!=null?n.concat([t]):null,im(4,4,Jj.bind(null,e,t),n)}function Wy(){}function ek(t,e){var n=Fr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Vy(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function tk(t,e){var n=Fr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Vy(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function nk(t,e,n){return $a&21?(ts(n,e)||(n=ij(),lt.lanes|=n,za|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Qn=!0),t.memoizedState=n)}function r3(t,e){var n=He;He=n!==0&&4>n?n:4,t(!0);var r=dg.transition;dg.transition={};try{t(!1),e()}finally{He=n,dg.transition=r}}function rk(){return Fr().memoizedState}function s3(t,e,n){var r=Vi(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},sk(t))ik(e,n);else if(n=Mj(t,e,n,r),n!==null){var s=An();Jr(n,t,r,s),ak(n,e,r)}}function i3(t,e,n){var r=Vi(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(sk(t))ik(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,l=i(o,n);if(s.hasEagerState=!0,s.eagerState=l,ts(l,o)){var c=e.interleaved;c===null?(s.next=s,Ly(e)):(s.next=c.next,c.next=s),e.interleaved=s;return}}catch{}finally{}n=Mj(t,e,s,r),n!==null&&(s=An(),Jr(n,t,r,s),ak(n,e,r))}}function sk(t){var e=t.alternate;return t===lt||e!==null&&e===lt}function ik(t,e){Mc=tf=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function ak(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,by(t,n)}}var nf={readContext:Pr,useCallback:dn,useContext:dn,useEffect:dn,useImperativeHandle:dn,useInsertionEffect:dn,useLayoutEffect:dn,useMemo:dn,useReducer:dn,useRef:dn,useState:dn,useDebugValue:dn,useDeferredValue:dn,useTransition:dn,useMutableSource:dn,useSyncExternalStore:dn,useId:dn,unstable_isNewReconciler:!1},a3={readContext:Pr,useCallback:function(t,e){return ms().memoizedState=[t,e===void 0?null:e],t},useContext:Pr,useEffect:Z_,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,yh(4194308,4,Jj.bind(null,e,t),n)},useLayoutEffect:function(t,e){return yh(4194308,4,t,e)},useInsertionEffect:function(t,e){return yh(4,2,t,e)},useMemo:function(t,e){var n=ms();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=ms();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=s3.bind(null,lt,t),[r.memoizedState,t]},useRef:function(t){var e=ms();return t={current:t},e.memoizedState=t},useState:J_,useDebugValue:Wy,useDeferredValue:function(t){return ms().memoizedState=t},useTransition:function(){var t=J_(!1),e=t[0];return t=r3.bind(null,t[1]),ms().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=lt,s=ms();if(rt){if(n===void 0)throw Error(U(407));n=n()}else{if(n=e(),Ht===null)throw Error(U(349));$a&30||Hj(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,Z_(Wj.bind(null,r,i,t),[t]),r.flags|=2048,iu(9,Gj.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=ms(),e=Ht.identifierPrefix;if(rt){var n=Bs,r=zs;n=(r&~(1<<32-Yr(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=ru++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=n3++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},o3={readContext:Pr,useCallback:ek,useContext:Pr,useEffect:Gy,useImperativeHandle:Zj,useInsertionEffect:Xj,useLayoutEffect:Yj,useMemo:tk,useReducer:hg,useRef:Qj,useState:function(){return hg(su)},useDebugValue:Wy,useDeferredValue:function(t){var e=Fr();return nk(e,Pt.memoizedState,t)},useTransition:function(){var t=hg(su)[0],e=Fr().memoizedState;return[t,e]},useMutableSource:Vj,useSyncExternalStore:Uj,useId:rk,unstable_isNewReconciler:!1},l3={readContext:Pr,useCallback:ek,useContext:Pr,useEffect:Gy,useImperativeHandle:Zj,useInsertionEffect:Xj,useLayoutEffect:Yj,useMemo:tk,useReducer:fg,useRef:Qj,useState:function(){return fg(su)},useDebugValue:Wy,useDeferredValue:function(t){var e=Fr();return Pt===null?e.memoizedState=t:nk(e,Pt.memoizedState,t)},useTransition:function(){var t=fg(su)[0],e=Fr().memoizedState;return[t,e]},useMutableSource:Vj,useSyncExternalStore:Uj,useId:rk,unstable_isNewReconciler:!1};function cl(t,e){try{var n="",r=e;do n+=D5(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function mg(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function $0(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var c3=typeof WeakMap=="function"?WeakMap:Map;function ok(t,e,n){n=qs(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){sf||(sf=!0,Q0=r),$0(t,e)},n}function lk(t,e,n){n=qs(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){$0(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){$0(t,e),typeof r!="function"&&(Bi===null?Bi=new Set([this]):Bi.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function eS(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new c3;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=b3.bind(null,t,e,n),e.then(t,t))}function tS(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function nS(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=qs(-1,1),e.tag=2,zi(n,e,1))),n.lanes|=1),t)}var u3=oi.ReactCurrentOwner,Qn=!1;function Rn(t,e,n,r){e.child=t===null?zj(e,null,n,r):ol(e,t.child,n,r)}function rS(t,e,n,r,s){n=n.render;var i=e.ref;return Yo(e,s),r=Uy(t,e,n,r,i,s),n=Hy(),t!==null&&!Qn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,ti(t,e,s)):(rt&&n&&Ny(e),e.flags|=1,Rn(t,e,r,s),e.child)}function sS(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!ev(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,ck(t,e,i,r,s)):(t=Sh(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Yc,n(o,r)&&t.ref===e.ref)return ti(t,e,s)}return e.flags|=1,t=Ui(i,r),t.ref=e.ref,t.return=e,e.child=t}function ck(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(Yc(i,r)&&t.ref===e.ref)if(Qn=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(Qn=!0);else return e.lanes=t.lanes,ti(t,e,s)}return z0(t,e,n,r,s)}function uk(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ye(Uo,or),or|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Ye(Uo,or),or|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Ye(Uo,or),or|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,Ye(Uo,or),or|=r;return Rn(t,e,s,n),e.child}function dk(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function z0(t,e,n,r,s){var i=Yn(n)?La:wn.current;return i=il(e,i),Yo(e,s),n=Uy(t,e,n,r,i,s),r=Hy(),t!==null&&!Qn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,ti(t,e,s)):(rt&&r&&Ny(e),e.flags|=1,Rn(t,e,n,s),e.child)}function iS(t,e,n,r,s){if(Yn(n)){var i=!0;Kh(e)}else i=!1;if(Yo(e,s),e.stateNode===null)vh(t,e),Oj(e,n,r),O0(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var c=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=Pr(u):(u=Yn(n)?La:wn.current,u=il(e,u));var d=n.getDerivedStateFromProps,m=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";m||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||c!==u)&&X_(e,o,r,u),ji=!1;var p=e.memoizedState;o.state=p,Zh(e,r,o,s),c=e.memoizedState,l!==r||p!==c||Xn.current||ji?(typeof d=="function"&&(L0(e,n,d,r),c=e.memoizedState),(l=ji||Q_(e,n,l,r,p,c,u))?(m||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),o.props=r,o.state=c,o.context=u,r=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,Dj(t,e),l=e.memoizedProps,u=e.type===e.elementType?l:Gr(e.type,l),o.props=u,m=e.pendingProps,p=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=Pr(c):(c=Yn(n)?La:wn.current,c=il(e,c));var g=n.getDerivedStateFromProps;(d=typeof g=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==m||p!==c)&&X_(e,o,r,c),ji=!1,p=e.memoizedState,o.state=p,Zh(e,r,o,s);var x=e.memoizedState;l!==m||p!==x||Xn.current||ji?(typeof g=="function"&&(L0(e,n,g,r),x=e.memoizedState),(u=ji||Q_(e,n,u,r,p,x,c)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,x,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,x,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=x),o.props=r,o.state=x,o.context=c,r=u):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),r=!1)}return B0(t,e,n,r,i,s)}function B0(t,e,n,r,s,i){dk(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&H_(e,n,!1),ti(t,e,i);r=e.stateNode,u3.current=e;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=ol(e,t.child,null,i),e.child=ol(e,null,l,i)):Rn(t,e,l,i),e.memoizedState=r.state,s&&H_(e,n,!0),e.child}function hk(t){var e=t.stateNode;e.pendingContext?U_(t,e.pendingContext,e.pendingContext!==e.context):e.context&&U_(t,e.context,!1),$y(t,e.containerInfo)}function aS(t,e,n,r,s){return al(),Py(s),e.flags|=256,Rn(t,e,n,r),e.child}var V0={dehydrated:null,treeContext:null,retryLane:0};function U0(t){return{baseLanes:t,cachePool:null,transitions:null}}function fk(t,e,n){var r=e.pendingProps,s=ot.current,i=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Ye(ot,s&1),t===null)return M0(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=lm(o,r,0,null),t=Fa(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=U0(n),e.memoizedState=V0,t):qy(e,o));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return d3(t,e,o,r,l,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,l=s.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=Ui(s,c),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=Ui(l,i):(i=Fa(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?U0(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=V0,r}return i=t.child,t=i.sibling,r=Ui(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function qy(t,e){return e=lm({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Ud(t,e,n,r){return r!==null&&Py(r),ol(e,t.child,null,n),t=qy(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function d3(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=mg(Error(U(422))),Ud(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=lm({mode:"visible",children:r.children},s,0,null),i=Fa(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&ol(e,t.child,null,o),e.child.memoizedState=U0(o),e.memoizedState=V0,i);if(!(e.mode&1))return Ud(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(U(419)),r=mg(i,r,void 0),Ud(t,e,o,r)}if(l=(o&t.childLanes)!==0,Qn||l){if(r=Ht,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,ei(t,s),Jr(r,t,s,-1))}return Zy(),r=mg(Error(U(421))),Ud(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=E3.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,ur=$i(s.nextSibling),fr=e,rt=!0,qr=null,t!==null&&(Cr[Rr++]=zs,Cr[Rr++]=Bs,Cr[Rr++]=Oa,zs=t.id,Bs=t.overflow,Oa=e),e=qy(e,r.children),e.flags|=4096,e)}function oS(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),D0(t.return,e,n)}function pg(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function mk(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(Rn(t,e,r.children,n),r=ot.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&oS(t,n,e);else if(t.tag===19)oS(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Ye(ot,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&ef(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),pg(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&ef(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}pg(e,!0,n,null,i);break;case"together":pg(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function vh(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function ti(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),za|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(U(153));if(e.child!==null){for(t=e.child,n=Ui(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Ui(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function h3(t,e,n){switch(e.tag){case 3:hk(e),al();break;case 5:Bj(e);break;case 1:Yn(e.type)&&Kh(e);break;case 4:$y(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Ye(Yh,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Ye(ot,ot.current&1),e.flags|=128,null):n&e.child.childLanes?fk(t,e,n):(Ye(ot,ot.current&1),t=ti(t,e,n),t!==null?t.sibling:null);Ye(ot,ot.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return mk(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Ye(ot,ot.current),r)break;return null;case 22:case 23:return e.lanes=0,uk(t,e,n)}return ti(t,e,n)}var pk,H0,gk,xk;pk=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};H0=function(){};gk=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,Ca(ws.current);var i=null;switch(n){case"input":s=h0(t,s),r=h0(t,r),i=[];break;case"select":s=ct({},s,{value:void 0}),r=ct({},r,{value:void 0}),i=[];break;case"textarea":s=p0(t,s),r=p0(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Wh)}x0(n,r);var o;n=null;for(u in s)if(!r.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var l=s[u];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Hc.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in r){var c=r[u];if(l=s!=null?s[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(i||(i=[]),i.push(u,n)),n=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Hc.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&Ze("scroll",t),i||l===c||(i=[])):(i=i||[]).push(u,c))}n&&(i=i||[]).push("style",n);var u=i;(e.updateQueue=u)&&(e.flags|=4)}};xk=function(t,e,n,r){n!==r&&(e.flags|=4)};function mc(t,e){if(!rt)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function hn(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function f3(t,e,n){var r=e.pendingProps;switch(Ay(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return hn(e),null;case 1:return Yn(e.type)&&qh(),hn(e),null;case 3:return r=e.stateNode,ll(),et(Xn),et(wn),By(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Bd(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,qr!==null&&(J0(qr),qr=null))),H0(t,e),hn(e),null;case 5:zy(e);var s=Ca(nu.current);if(n=e.type,t!==null&&e.stateNode!=null)gk(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(U(166));return hn(e),null}if(t=Ca(ws.current),Bd(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[gs]=e,r[eu]=i,t=(e.mode&1)!==0,n){case"dialog":Ze("cancel",r),Ze("close",r);break;case"iframe":case"object":case"embed":Ze("load",r);break;case"video":case"audio":for(s=0;s<bc.length;s++)Ze(bc[s],r);break;case"source":Ze("error",r);break;case"img":case"image":case"link":Ze("error",r),Ze("load",r);break;case"details":Ze("toggle",r);break;case"input":g_(r,i),Ze("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Ze("invalid",r);break;case"textarea":y_(r,i),Ze("invalid",r)}x0(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&zd(r.textContent,l,t),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&zd(r.textContent,l,t),s=["children",""+l]):Hc.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Ze("scroll",r)}switch(n){case"input":Ad(r),x_(r,i,!0);break;case"textarea":Ad(r),v_(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Wh)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=HE(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[gs]=e,t[eu]=r,pk(t,e,!1,!1),e.stateNode=t;e:{switch(o=y0(n,r),n){case"dialog":Ze("cancel",t),Ze("close",t),s=r;break;case"iframe":case"object":case"embed":Ze("load",t),s=r;break;case"video":case"audio":for(s=0;s<bc.length;s++)Ze(bc[s],t);s=r;break;case"source":Ze("error",t),s=r;break;case"img":case"image":case"link":Ze("error",t),Ze("load",t),s=r;break;case"details":Ze("toggle",t),s=r;break;case"input":g_(t,r),s=h0(t,r),Ze("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=ct({},r,{value:void 0}),Ze("invalid",t);break;case"textarea":y_(t,r),s=p0(t,r),Ze("invalid",t);break;default:s=r}x0(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?qE(t,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&GE(t,c)):i==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&Gc(t,c):typeof c=="number"&&Gc(t,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Hc.hasOwnProperty(i)?c!=null&&i==="onScroll"&&Ze("scroll",t):c!=null&&xy(t,i,c,o))}switch(n){case"input":Ad(t),x_(t,r,!1);break;case"textarea":Ad(t),v_(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Xi(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?qo(t,!!r.multiple,i,!1):r.defaultValue!=null&&qo(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=Wh)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return hn(e),null;case 6:if(t&&e.stateNode!=null)xk(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(U(166));if(n=Ca(nu.current),Ca(ws.current),Bd(e)){if(r=e.stateNode,n=e.memoizedProps,r[gs]=e,(i=r.nodeValue!==n)&&(t=fr,t!==null))switch(t.tag){case 3:zd(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&zd(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[gs]=e,e.stateNode=r}return hn(e),null;case 13:if(et(ot),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(rt&&ur!==null&&e.mode&1&&!(e.flags&128))Fj(),al(),e.flags|=98560,i=!1;else if(i=Bd(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(U(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(U(317));i[gs]=e}else al(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;hn(e),i=!1}else qr!==null&&(J0(qr),qr=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||ot.current&1?Ft===0&&(Ft=3):Zy())),e.updateQueue!==null&&(e.flags|=4),hn(e),null);case 4:return ll(),H0(t,e),t===null&&Jc(e.stateNode.containerInfo),hn(e),null;case 10:return Dy(e.type._context),hn(e),null;case 17:return Yn(e.type)&&qh(),hn(e),null;case 19:if(et(ot),i=e.memoizedState,i===null)return hn(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)mc(i,!1);else{if(Ft!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=ef(t),o!==null){for(e.flags|=128,mc(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Ye(ot,ot.current&1|2),e.child}t=t.sibling}i.tail!==null&&yt()>ul&&(e.flags|=128,r=!0,mc(i,!1),e.lanes=4194304)}else{if(!r)if(t=ef(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),mc(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!rt)return hn(e),null}else 2*yt()-i.renderingStartTime>ul&&n!==1073741824&&(e.flags|=128,r=!0,mc(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=yt(),e.sibling=null,n=ot.current,Ye(ot,r?n&1|2:n&1),e):(hn(e),null);case 22:case 23:return Jy(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?or&1073741824&&(hn(e),e.subtreeFlags&6&&(e.flags|=8192)):hn(e),null;case 24:return null;case 25:return null}throw Error(U(156,e.tag))}function m3(t,e){switch(Ay(e),e.tag){case 1:return Yn(e.type)&&qh(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return ll(),et(Xn),et(wn),By(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return zy(e),null;case 13:if(et(ot),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(U(340));al()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return et(ot),null;case 4:return ll(),null;case 10:return Dy(e.type._context),null;case 22:case 23:return Jy(),null;case 24:return null;default:return null}}var Hd=!1,gn=!1,p3=typeof WeakSet=="function"?WeakSet:Set,Q=null;function Vo(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){mt(t,e,r)}else n.current=null}function G0(t,e,n){try{n()}catch(r){mt(t,e,r)}}var lS=!1;function g3(t,e){if(I0=Uh,t=_j(),Ry(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,l=-1,c=-1,u=0,d=0,m=t,p=null;t:for(;;){for(var g;m!==n||s!==0&&m.nodeType!==3||(l=o+s),m!==i||r!==0&&m.nodeType!==3||(c=o+r),m.nodeType===3&&(o+=m.nodeValue.length),(g=m.firstChild)!==null;)p=m,m=g;for(;;){if(m===t)break t;if(p===n&&++u===s&&(l=o),p===i&&++d===r&&(c=o),(g=m.nextSibling)!==null)break;m=p,p=m.parentNode}m=g}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(C0={focusedElem:t,selectionRange:n},Uh=!1,Q=e;Q!==null;)if(e=Q,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Q=t;else for(;Q!==null;){e=Q;try{var x=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var w=x.memoizedProps,v=x.memoizedState,S=e.stateNode,_=S.getSnapshotBeforeUpdate(e.elementType===e.type?w:Gr(e.type,w),v);S.__reactInternalSnapshotBeforeUpdate=_}break;case 3:var E=e.stateNode.containerInfo;E.nodeType===1?E.textContent="":E.nodeType===9&&E.documentElement&&E.removeChild(E.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(U(163))}}catch(I){mt(e,e.return,I)}if(t=e.sibling,t!==null){t.return=e.return,Q=t;break}Q=e.return}return x=lS,lS=!1,x}function Dc(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&G0(e,n,i)}s=s.next}while(s!==r)}}function am(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function W0(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function yk(t){var e=t.alternate;e!==null&&(t.alternate=null,yk(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[gs],delete e[eu],delete e[A0],delete e[JP],delete e[ZP])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function vk(t){return t.tag===5||t.tag===3||t.tag===4}function cS(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||vk(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function q0(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Wh));else if(r!==4&&(t=t.child,t!==null))for(q0(t,e,n),t=t.sibling;t!==null;)q0(t,e,n),t=t.sibling}function K0(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(K0(t,e,n),t=t.sibling;t!==null;)K0(t,e,n),t=t.sibling}var Yt=null,Wr=!1;function _i(t,e,n){for(n=n.child;n!==null;)wk(t,e,n),n=n.sibling}function wk(t,e,n){if(vs&&typeof vs.onCommitFiberUnmount=="function")try{vs.onCommitFiberUnmount(Jf,n)}catch{}switch(n.tag){case 5:gn||Vo(n,e);case 6:var r=Yt,s=Wr;Yt=null,_i(t,e,n),Yt=r,Wr=s,Yt!==null&&(Wr?(t=Yt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Yt.removeChild(n.stateNode));break;case 18:Yt!==null&&(Wr?(t=Yt,n=n.stateNode,t.nodeType===8?lg(t.parentNode,n):t.nodeType===1&&lg(t,n),Qc(t)):lg(Yt,n.stateNode));break;case 4:r=Yt,s=Wr,Yt=n.stateNode.containerInfo,Wr=!0,_i(t,e,n),Yt=r,Wr=s;break;case 0:case 11:case 14:case 15:if(!gn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&G0(n,e,o),s=s.next}while(s!==r)}_i(t,e,n);break;case 1:if(!gn&&(Vo(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){mt(n,e,l)}_i(t,e,n);break;case 21:_i(t,e,n);break;case 22:n.mode&1?(gn=(r=gn)||n.memoizedState!==null,_i(t,e,n),gn=r):_i(t,e,n);break;default:_i(t,e,n)}}function uS(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new p3),e.forEach(function(r){var s=j3.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Vr(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:Yt=l.stateNode,Wr=!1;break e;case 3:Yt=l.stateNode.containerInfo,Wr=!0;break e;case 4:Yt=l.stateNode.containerInfo,Wr=!0;break e}l=l.return}if(Yt===null)throw Error(U(160));wk(i,o,s),Yt=null,Wr=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(u){mt(s,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)_k(e,t),e=e.sibling}function _k(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Vr(e,t),us(t),r&4){try{Dc(3,t,t.return),am(3,t)}catch(w){mt(t,t.return,w)}try{Dc(5,t,t.return)}catch(w){mt(t,t.return,w)}}break;case 1:Vr(e,t),us(t),r&512&&n!==null&&Vo(n,n.return);break;case 5:if(Vr(e,t),us(t),r&512&&n!==null&&Vo(n,n.return),t.flags&32){var s=t.stateNode;try{Gc(s,"")}catch(w){mt(t,t.return,w)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&VE(s,i),y0(l,o);var u=y0(l,i);for(o=0;o<c.length;o+=2){var d=c[o],m=c[o+1];d==="style"?qE(s,m):d==="dangerouslySetInnerHTML"?GE(s,m):d==="children"?Gc(s,m):xy(s,d,m,u)}switch(l){case"input":f0(s,i);break;case"textarea":UE(s,i);break;case"select":var p=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var g=i.value;g!=null?qo(s,!!i.multiple,g,!1):p!==!!i.multiple&&(i.defaultValue!=null?qo(s,!!i.multiple,i.defaultValue,!0):qo(s,!!i.multiple,i.multiple?[]:"",!1))}s[eu]=i}catch(w){mt(t,t.return,w)}}break;case 6:if(Vr(e,t),us(t),r&4){if(t.stateNode===null)throw Error(U(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(w){mt(t,t.return,w)}}break;case 3:if(Vr(e,t),us(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Qc(e.containerInfo)}catch(w){mt(t,t.return,w)}break;case 4:Vr(e,t),us(t);break;case 13:Vr(e,t),us(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Xy=yt())),r&4&&uS(t);break;case 22:if(d=n!==null&&n.memoizedState!==null,t.mode&1?(gn=(u=gn)||d,Vr(e,t),gn=u):Vr(e,t),us(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!d&&t.mode&1)for(Q=t,d=t.child;d!==null;){for(m=Q=d;Q!==null;){switch(p=Q,g=p.child,p.tag){case 0:case 11:case 14:case 15:Dc(4,p,p.return);break;case 1:Vo(p,p.return);var x=p.stateNode;if(typeof x.componentWillUnmount=="function"){r=p,n=p.return;try{e=r,x.props=e.memoizedProps,x.state=e.memoizedState,x.componentWillUnmount()}catch(w){mt(r,n,w)}}break;case 5:Vo(p,p.return);break;case 22:if(p.memoizedState!==null){hS(m);continue}}g!==null?(g.return=p,Q=g):hS(m)}d=d.sibling}e:for(d=null,m=t;;){if(m.tag===5){if(d===null){d=m;try{s=m.stateNode,u?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=m.stateNode,c=m.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=WE("display",o))}catch(w){mt(t,t.return,w)}}}else if(m.tag===6){if(d===null)try{m.stateNode.nodeValue=u?"":m.memoizedProps}catch(w){mt(t,t.return,w)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===t)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===t)break e;for(;m.sibling===null;){if(m.return===null||m.return===t)break e;d===m&&(d=null),m=m.return}d===m&&(d=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:Vr(e,t),us(t),r&4&&uS(t);break;case 21:break;default:Vr(e,t),us(t)}}function us(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(vk(n)){var r=n;break e}n=n.return}throw Error(U(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Gc(s,""),r.flags&=-33);var i=cS(t);K0(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,l=cS(t);q0(t,l,o);break;default:throw Error(U(161))}}catch(c){mt(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function x3(t,e,n){Q=t,Sk(t)}function Sk(t,e,n){for(var r=(t.mode&1)!==0;Q!==null;){var s=Q,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||Hd;if(!o){var l=s.alternate,c=l!==null&&l.memoizedState!==null||gn;l=Hd;var u=gn;if(Hd=o,(gn=c)&&!u)for(Q=s;Q!==null;)o=Q,c=o.child,o.tag===22&&o.memoizedState!==null?fS(s):c!==null?(c.return=o,Q=c):fS(s);for(;i!==null;)Q=i,Sk(i),i=i.sibling;Q=s,Hd=l,gn=u}dS(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,Q=i):dS(t)}}function dS(t){for(;Q!==null;){var e=Q;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:gn||am(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!gn)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:Gr(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&K_(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}K_(e,o,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var m=d.dehydrated;m!==null&&Qc(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(U(163))}gn||e.flags&512&&W0(e)}catch(p){mt(e,e.return,p)}}if(e===t){Q=null;break}if(n=e.sibling,n!==null){n.return=e.return,Q=n;break}Q=e.return}}function hS(t){for(;Q!==null;){var e=Q;if(e===t){Q=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Q=n;break}Q=e.return}}function fS(t){for(;Q!==null;){var e=Q;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{am(4,e)}catch(c){mt(e,n,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(c){mt(e,s,c)}}var i=e.return;try{W0(e)}catch(c){mt(e,i,c)}break;case 5:var o=e.return;try{W0(e)}catch(c){mt(e,o,c)}}}catch(c){mt(e,e.return,c)}if(e===t){Q=null;break}var l=e.sibling;if(l!==null){l.return=e.return,Q=l;break}Q=e.return}}var y3=Math.ceil,rf=oi.ReactCurrentDispatcher,Ky=oi.ReactCurrentOwner,Ar=oi.ReactCurrentBatchConfig,Le=0,Ht=null,jt=null,tn=0,or=0,Uo=ia(0),Ft=0,au=null,za=0,om=0,Qy=0,Lc=null,qn=null,Xy=0,ul=1/0,Ds=null,sf=!1,Q0=null,Bi=null,Gd=!1,Pi=null,af=0,Oc=0,X0=null,wh=-1,_h=0;function An(){return Le&6?yt():wh!==-1?wh:wh=yt()}function Vi(t){return t.mode&1?Le&2&&tn!==0?tn&-tn:t3.transition!==null?(_h===0&&(_h=ij()),_h):(t=He,t!==0||(t=window.event,t=t===void 0?16:hj(t.type)),t):1}function Jr(t,e,n,r){if(50<Oc)throw Oc=0,X0=null,Error(U(185));Cu(t,n,r),(!(Le&2)||t!==Ht)&&(t===Ht&&(!(Le&2)&&(om|=n),Ft===4&&Ti(t,tn)),Jn(t,r),n===1&&Le===0&&!(e.mode&1)&&(ul=yt()+500,rm&&aa()))}function Jn(t,e){var n=t.callbackNode;tP(t,e);var r=Vh(t,t===Ht?tn:0);if(r===0)n!==null&&S_(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&S_(n),e===1)t.tag===0?e3(mS.bind(null,t)):Nj(mS.bind(null,t)),XP(function(){!(Le&6)&&aa()}),n=null;else{switch(aj(r)){case 1:n=Sy;break;case 4:n=rj;break;case 16:n=Bh;break;case 536870912:n=sj;break;default:n=Bh}n=Rk(n,bk.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function bk(t,e){if(wh=-1,_h=0,Le&6)throw Error(U(327));var n=t.callbackNode;if(Jo()&&t.callbackNode!==n)return null;var r=Vh(t,t===Ht?tn:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=of(t,r);else{e=r;var s=Le;Le|=2;var i=jk();(Ht!==t||tn!==e)&&(Ds=null,ul=yt()+500,Pa(t,e));do try{_3();break}catch(l){Ek(t,l)}while(1);My(),rf.current=i,Le=s,jt!==null?e=0:(Ht=null,tn=0,e=Ft)}if(e!==0){if(e===2&&(s=b0(t),s!==0&&(r=s,e=Y0(t,s))),e===1)throw n=au,Pa(t,0),Ti(t,r),Jn(t,yt()),n;if(e===6)Ti(t,r);else{if(s=t.current.alternate,!(r&30)&&!v3(s)&&(e=of(t,r),e===2&&(i=b0(t),i!==0&&(r=i,e=Y0(t,i))),e===1))throw n=au,Pa(t,0),Ti(t,r),Jn(t,yt()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(U(345));case 2:Sa(t,qn,Ds);break;case 3:if(Ti(t,r),(r&130023424)===r&&(e=Xy+500-yt(),10<e)){if(Vh(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){An(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=N0(Sa.bind(null,t,qn,Ds),e);break}Sa(t,qn,Ds);break;case 4:if(Ti(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-Yr(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=yt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*y3(r/1960))-r,10<r){t.timeoutHandle=N0(Sa.bind(null,t,qn,Ds),r);break}Sa(t,qn,Ds);break;case 5:Sa(t,qn,Ds);break;default:throw Error(U(329))}}}return Jn(t,yt()),t.callbackNode===n?bk.bind(null,t):null}function Y0(t,e){var n=Lc;return t.current.memoizedState.isDehydrated&&(Pa(t,e).flags|=256),t=of(t,e),t!==2&&(e=qn,qn=n,e!==null&&J0(e)),t}function J0(t){qn===null?qn=t:qn.push.apply(qn,t)}function v3(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!ts(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Ti(t,e){for(e&=~Qy,e&=~om,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Yr(e),r=1<<n;t[n]=-1,e&=~r}}function mS(t){if(Le&6)throw Error(U(327));Jo();var e=Vh(t,0);if(!(e&1))return Jn(t,yt()),null;var n=of(t,e);if(t.tag!==0&&n===2){var r=b0(t);r!==0&&(e=r,n=Y0(t,r))}if(n===1)throw n=au,Pa(t,0),Ti(t,e),Jn(t,yt()),n;if(n===6)throw Error(U(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Sa(t,qn,Ds),Jn(t,yt()),null}function Yy(t,e){var n=Le;Le|=1;try{return t(e)}finally{Le=n,Le===0&&(ul=yt()+500,rm&&aa())}}function Ba(t){Pi!==null&&Pi.tag===0&&!(Le&6)&&Jo();var e=Le;Le|=1;var n=Ar.transition,r=He;try{if(Ar.transition=null,He=1,t)return t()}finally{He=r,Ar.transition=n,Le=e,!(Le&6)&&aa()}}function Jy(){or=Uo.current,et(Uo)}function Pa(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,QP(n)),jt!==null)for(n=jt.return;n!==null;){var r=n;switch(Ay(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&qh();break;case 3:ll(),et(Xn),et(wn),By();break;case 5:zy(r);break;case 4:ll();break;case 13:et(ot);break;case 19:et(ot);break;case 10:Dy(r.type._context);break;case 22:case 23:Jy()}n=n.return}if(Ht=t,jt=t=Ui(t.current,null),tn=or=e,Ft=0,au=null,Qy=om=za=0,qn=Lc=null,Ia!==null){for(e=0;e<Ia.length;e++)if(n=Ia[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}Ia=null}return t}function Ek(t,e){do{var n=jt;try{if(My(),xh.current=nf,tf){for(var r=lt.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}tf=!1}if($a=0,Vt=Pt=lt=null,Mc=!1,ru=0,Ky.current=null,n===null||n.return===null){Ft=1,au=e,jt=null;break}e:{var i=t,o=n.return,l=n,c=e;if(e=tn,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=l,m=d.tag;if(!(d.mode&1)&&(m===0||m===11||m===15)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var g=tS(o);if(g!==null){g.flags&=-257,nS(g,o,l,i,e),g.mode&1&&eS(i,u,e),e=g,c=u;var x=e.updateQueue;if(x===null){var w=new Set;w.add(c),e.updateQueue=w}else x.add(c);break e}else{if(!(e&1)){eS(i,u,e),Zy();break e}c=Error(U(426))}}else if(rt&&l.mode&1){var v=tS(o);if(v!==null){!(v.flags&65536)&&(v.flags|=256),nS(v,o,l,i,e),Py(cl(c,l));break e}}i=c=cl(c,l),Ft!==4&&(Ft=2),Lc===null?Lc=[i]:Lc.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var S=ok(i,c,e);q_(i,S);break e;case 1:l=c;var _=i.type,E=i.stateNode;if(!(i.flags&128)&&(typeof _.getDerivedStateFromError=="function"||E!==null&&typeof E.componentDidCatch=="function"&&(Bi===null||!Bi.has(E)))){i.flags|=65536,e&=-e,i.lanes|=e;var I=lk(i,l,e);q_(i,I);break e}}i=i.return}while(i!==null)}Tk(n)}catch(N){e=N,jt===n&&n!==null&&(jt=n=n.return);continue}break}while(1)}function jk(){var t=rf.current;return rf.current=nf,t===null?nf:t}function Zy(){(Ft===0||Ft===3||Ft===2)&&(Ft=4),Ht===null||!(za&268435455)&&!(om&268435455)||Ti(Ht,tn)}function of(t,e){var n=Le;Le|=2;var r=jk();(Ht!==t||tn!==e)&&(Ds=null,Pa(t,e));do try{w3();break}catch(s){Ek(t,s)}while(1);if(My(),Le=n,rf.current=r,jt!==null)throw Error(U(261));return Ht=null,tn=0,Ft}function w3(){for(;jt!==null;)kk(jt)}function _3(){for(;jt!==null&&!W5();)kk(jt)}function kk(t){var e=Ck(t.alternate,t,or);t.memoizedProps=t.pendingProps,e===null?Tk(t):jt=e,Ky.current=null}function Tk(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=m3(n,e),n!==null){n.flags&=32767,jt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Ft=6,jt=null;return}}else if(n=f3(n,e,or),n!==null){jt=n;return}if(e=e.sibling,e!==null){jt=e;return}jt=e=t}while(e!==null);Ft===0&&(Ft=5)}function Sa(t,e,n){var r=He,s=Ar.transition;try{Ar.transition=null,He=1,S3(t,e,n,r)}finally{Ar.transition=s,He=r}return null}function S3(t,e,n,r){do Jo();while(Pi!==null);if(Le&6)throw Error(U(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(U(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(nP(t,i),t===Ht&&(jt=Ht=null,tn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Gd||(Gd=!0,Rk(Bh,function(){return Jo(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=Ar.transition,Ar.transition=null;var o=He;He=1;var l=Le;Le|=4,Ky.current=null,g3(t,n),_k(n,t),VP(C0),Uh=!!I0,C0=I0=null,t.current=n,x3(n),q5(),Le=l,He=o,Ar.transition=i}else t.current=n;if(Gd&&(Gd=!1,Pi=t,af=s),i=t.pendingLanes,i===0&&(Bi=null),X5(n.stateNode),Jn(t,yt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(sf)throw sf=!1,t=Q0,Q0=null,t;return af&1&&t.tag!==0&&Jo(),i=t.pendingLanes,i&1?t===X0?Oc++:(Oc=0,X0=t):Oc=0,aa(),null}function Jo(){if(Pi!==null){var t=aj(af),e=Ar.transition,n=He;try{if(Ar.transition=null,He=16>t?16:t,Pi===null)var r=!1;else{if(t=Pi,Pi=null,af=0,Le&6)throw Error(U(331));var s=Le;for(Le|=4,Q=t.current;Q!==null;){var i=Q,o=i.child;if(Q.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(Q=u;Q!==null;){var d=Q;switch(d.tag){case 0:case 11:case 15:Dc(8,d,i)}var m=d.child;if(m!==null)m.return=d,Q=m;else for(;Q!==null;){d=Q;var p=d.sibling,g=d.return;if(yk(d),d===u){Q=null;break}if(p!==null){p.return=g,Q=p;break}Q=g}}}var x=i.alternate;if(x!==null){var w=x.child;if(w!==null){x.child=null;do{var v=w.sibling;w.sibling=null,w=v}while(w!==null)}}Q=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,Q=o;else e:for(;Q!==null;){if(i=Q,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Dc(9,i,i.return)}var S=i.sibling;if(S!==null){S.return=i.return,Q=S;break e}Q=i.return}}var _=t.current;for(Q=_;Q!==null;){o=Q;var E=o.child;if(o.subtreeFlags&2064&&E!==null)E.return=o,Q=E;else e:for(o=_;Q!==null;){if(l=Q,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:am(9,l)}}catch(N){mt(l,l.return,N)}if(l===o){Q=null;break e}var I=l.sibling;if(I!==null){I.return=l.return,Q=I;break e}Q=l.return}}if(Le=s,aa(),vs&&typeof vs.onPostCommitFiberRoot=="function")try{vs.onPostCommitFiberRoot(Jf,t)}catch{}r=!0}return r}finally{He=n,Ar.transition=e}}return!1}function pS(t,e,n){e=cl(n,e),e=ok(t,e,1),t=zi(t,e,1),e=An(),t!==null&&(Cu(t,1,e),Jn(t,e))}function mt(t,e,n){if(t.tag===3)pS(t,t,n);else for(;e!==null;){if(e.tag===3){pS(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Bi===null||!Bi.has(r))){t=cl(n,t),t=lk(e,t,1),e=zi(e,t,1),t=An(),e!==null&&(Cu(e,1,t),Jn(e,t));break}}e=e.return}}function b3(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=An(),t.pingedLanes|=t.suspendedLanes&n,Ht===t&&(tn&n)===n&&(Ft===4||Ft===3&&(tn&130023424)===tn&&500>yt()-Xy?Pa(t,0):Qy|=n),Jn(t,e)}function Ik(t,e){e===0&&(t.mode&1?(e=Md,Md<<=1,!(Md&130023424)&&(Md=4194304)):e=1);var n=An();t=ei(t,e),t!==null&&(Cu(t,e,n),Jn(t,n))}function E3(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),Ik(t,n)}function j3(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(U(314))}r!==null&&r.delete(e),Ik(t,n)}var Ck;Ck=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Xn.current)Qn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Qn=!1,h3(t,e,n);Qn=!!(t.flags&131072)}else Qn=!1,rt&&e.flags&1048576&&Aj(e,Xh,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;vh(t,e),t=e.pendingProps;var s=il(e,wn.current);Yo(e,n),s=Uy(null,e,r,t,s,n);var i=Hy();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Yn(r)?(i=!0,Kh(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Oy(e),s.updater=sm,e.stateNode=s,s._reactInternals=e,O0(e,r,t,n),e=B0(null,e,r,!0,i,n)):(e.tag=0,rt&&i&&Ny(e),Rn(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(vh(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=T3(r),t=Gr(r,t),s){case 0:e=z0(null,e,r,t,n);break e;case 1:e=iS(null,e,r,t,n);break e;case 11:e=rS(null,e,r,t,n);break e;case 14:e=sS(null,e,r,Gr(r.type,t),n);break e}throw Error(U(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Gr(r,s),z0(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Gr(r,s),iS(t,e,r,s,n);case 3:e:{if(hk(e),t===null)throw Error(U(387));r=e.pendingProps,i=e.memoizedState,s=i.element,Dj(t,e),Zh(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=cl(Error(U(423)),e),e=aS(t,e,r,n,s);break e}else if(r!==s){s=cl(Error(U(424)),e),e=aS(t,e,r,n,s);break e}else for(ur=$i(e.stateNode.containerInfo.firstChild),fr=e,rt=!0,qr=null,n=zj(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(al(),r===s){e=ti(t,e,n);break e}Rn(t,e,r,n)}e=e.child}return e;case 5:return Bj(e),t===null&&M0(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,R0(r,s)?o=null:i!==null&&R0(r,i)&&(e.flags|=32),dk(t,e),Rn(t,e,o,n),e.child;case 6:return t===null&&M0(e),null;case 13:return fk(t,e,n);case 4:return $y(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=ol(e,null,r,n):Rn(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Gr(r,s),rS(t,e,r,s,n);case 7:return Rn(t,e,e.pendingProps,n),e.child;case 8:return Rn(t,e,e.pendingProps.children,n),e.child;case 12:return Rn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,Ye(Yh,r._currentValue),r._currentValue=o,i!==null)if(ts(i.value,o)){if(i.children===s.children&&!Xn.current){e=ti(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(i.tag===1){c=qs(-1,n&-n),c.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}i.lanes|=n,c=i.alternate,c!==null&&(c.lanes|=n),D0(i.return,n,e),l.lanes|=n;break}c=c.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(U(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),D0(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Rn(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Yo(e,n),s=Pr(s),r=r(s),e.flags|=1,Rn(t,e,r,n),e.child;case 14:return r=e.type,s=Gr(r,e.pendingProps),s=Gr(r.type,s),sS(t,e,r,s,n);case 15:return ck(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Gr(r,s),vh(t,e),e.tag=1,Yn(r)?(t=!0,Kh(e)):t=!1,Yo(e,n),Oj(e,r,s),O0(e,r,s,n),B0(null,e,r,!0,t,n);case 19:return mk(t,e,n);case 22:return uk(t,e,n)}throw Error(U(156,e.tag))};function Rk(t,e){return nj(t,e)}function k3(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Nr(t,e,n,r){return new k3(t,e,n,r)}function ev(t){return t=t.prototype,!(!t||!t.isReactComponent)}function T3(t){if(typeof t=="function")return ev(t)?1:0;if(t!=null){if(t=t.$$typeof,t===vy)return 11;if(t===wy)return 14}return 2}function Ui(t,e){var n=t.alternate;return n===null?(n=Nr(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Sh(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")ev(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Po:return Fa(n.children,s,i,e);case yy:o=8,s|=8;break;case l0:return t=Nr(12,n,e,s|2),t.elementType=l0,t.lanes=i,t;case c0:return t=Nr(13,n,e,s),t.elementType=c0,t.lanes=i,t;case u0:return t=Nr(19,n,e,s),t.elementType=u0,t.lanes=i,t;case $E:return lm(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case LE:o=10;break e;case OE:o=9;break e;case vy:o=11;break e;case wy:o=14;break e;case Ei:o=16,r=null;break e}throw Error(U(130,t==null?t:typeof t,""))}return e=Nr(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function Fa(t,e,n,r){return t=Nr(7,t,r,e),t.lanes=n,t}function lm(t,e,n,r){return t=Nr(22,t,r,e),t.elementType=$E,t.lanes=n,t.stateNode={isHidden:!1},t}function gg(t,e,n){return t=Nr(6,t,null,e),t.lanes=n,t}function xg(t,e,n){return e=Nr(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function I3(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Yp(0),this.expirationTimes=Yp(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Yp(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function tv(t,e,n,r,s,i,o,l,c){return t=new I3(t,e,n,l,c),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Nr(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Oy(i),t}function C3(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ao,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function Nk(t){if(!t)return Yi;t=t._reactInternals;e:{if(ro(t)!==t||t.tag!==1)throw Error(U(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Yn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(U(171))}if(t.tag===1){var n=t.type;if(Yn(n))return Rj(t,n,e)}return e}function Ak(t,e,n,r,s,i,o,l,c){return t=tv(n,r,!0,t,s,i,o,l,c),t.context=Nk(null),n=t.current,r=An(),s=Vi(n),i=qs(r,s),i.callback=e??null,zi(n,i,s),t.current.lanes=s,Cu(t,s,r),Jn(t,r),t}function cm(t,e,n,r){var s=e.current,i=An(),o=Vi(s);return n=Nk(n),e.context===null?e.context=n:e.pendingContext=n,e=qs(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=zi(s,e,o),t!==null&&(Jr(t,s,o,i),gh(t,s,o)),o}function lf(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function gS(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function nv(t,e){gS(t,e),(t=t.alternate)&&gS(t,e)}function R3(){return null}var Pk=typeof reportError=="function"?reportError:function(t){console.error(t)};function rv(t){this._internalRoot=t}um.prototype.render=rv.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(U(409));cm(t,e,null,null)};um.prototype.unmount=rv.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Ba(function(){cm(null,t,null,null)}),e[Zs]=null}};function um(t){this._internalRoot=t}um.prototype.unstable_scheduleHydration=function(t){if(t){var e=cj();t={blockedOn:null,target:t,priority:e};for(var n=0;n<ki.length&&e!==0&&e<ki[n].priority;n++);ki.splice(n,0,t),n===0&&dj(t)}};function sv(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function dm(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function xS(){}function N3(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var u=lf(o);i.call(u)}}var o=Ak(e,r,t,0,null,!1,!1,"",xS);return t._reactRootContainer=o,t[Zs]=o.current,Jc(t.nodeType===8?t.parentNode:t),Ba(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var u=lf(c);l.call(u)}}var c=tv(t,0,!1,null,null,!1,!1,"",xS);return t._reactRootContainer=c,t[Zs]=c.current,Jc(t.nodeType===8?t.parentNode:t),Ba(function(){cm(e,c,n,r)}),c}function hm(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var l=s;s=function(){var c=lf(o);l.call(c)}}cm(e,o,t,s)}else o=N3(n,e,t,s,r);return lf(o)}oj=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Sc(e.pendingLanes);n!==0&&(by(e,n|1),Jn(e,yt()),!(Le&6)&&(ul=yt()+500,aa()))}break;case 13:Ba(function(){var r=ei(t,1);if(r!==null){var s=An();Jr(r,t,1,s)}}),nv(t,1)}};Ey=function(t){if(t.tag===13){var e=ei(t,134217728);if(e!==null){var n=An();Jr(e,t,134217728,n)}nv(t,134217728)}};lj=function(t){if(t.tag===13){var e=Vi(t),n=ei(t,e);if(n!==null){var r=An();Jr(n,t,e,r)}nv(t,e)}};cj=function(){return He};uj=function(t,e){var n=He;try{return He=t,e()}finally{He=n}};w0=function(t,e,n){switch(e){case"input":if(f0(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=nm(r);if(!s)throw Error(U(90));BE(r),f0(r,s)}}}break;case"textarea":UE(t,n);break;case"select":e=n.value,e!=null&&qo(t,!!n.multiple,e,!1)}};XE=Yy;YE=Ba;var A3={usingClientEntryPoint:!1,Events:[Nu,Lo,nm,KE,QE,Yy]},pc={findFiberByHostInstance:Ta,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},P3={bundleType:pc.bundleType,version:pc.version,rendererPackageName:pc.rendererPackageName,rendererConfig:pc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:oi.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=ej(t),t===null?null:t.stateNode},findFiberByHostInstance:pc.findFiberByHostInstance||R3,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Wd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Wd.isDisabled&&Wd.supportsFiber)try{Jf=Wd.inject(P3),vs=Wd}catch{}}wr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=A3;wr.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!sv(e))throw Error(U(200));return C3(t,e,null,n)};wr.createRoot=function(t,e){if(!sv(t))throw Error(U(299));var n=!1,r="",s=Pk;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=tv(t,1,!1,null,null,n,!1,r,s),t[Zs]=e.current,Jc(t.nodeType===8?t.parentNode:t),new rv(e)};wr.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(U(188)):(t=Object.keys(t).join(","),Error(U(268,t)));return t=ej(e),t=t===null?null:t.stateNode,t};wr.flushSync=function(t){return Ba(t)};wr.hydrate=function(t,e,n){if(!dm(e))throw Error(U(200));return hm(null,t,e,!0,n)};wr.hydrateRoot=function(t,e,n){if(!sv(t))throw Error(U(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=Pk;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=Ak(e,null,t,1,n??null,s,!1,i,o),t[Zs]=e.current,Jc(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new um(e)};wr.render=function(t,e,n){if(!dm(e))throw Error(U(200));return hm(null,t,e,!1,n)};wr.unmountComponentAtNode=function(t){if(!dm(t))throw Error(U(40));return t._reactRootContainer?(Ba(function(){hm(null,null,t,!1,function(){t._reactRootContainer=null,t[Zs]=null})}),!0):!1};wr.unstable_batchedUpdates=Yy;wr.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!dm(n))throw Error(U(200));if(t==null||t._reactInternals===void 0)throw Error(U(38));return hm(t,e,n,!1,r)};wr.version="18.2.0-next-9e3b772b8-20220608";function Fk(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Fk)}catch(t){console.error(t)}}Fk(),AE.exports=wr;var so=AE.exports,yS=so;a0.createRoot=yS.createRoot,a0.hydrateRoot=yS.hydrateRoot;/**
 * @remix-run/router v1.7.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ou(){return ou=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ou.apply(this,arguments)}var Fi;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Fi||(Fi={}));const vS="popstate";function F3(t){t===void 0&&(t={});function e(s,i){let{pathname:o="/",search:l="",hash:c=""}=io(s.location.hash.substr(1));return Z0("",{pathname:o,search:l,hash:c},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(s,i){let o=s.document.querySelector("base"),l="";if(o&&o.getAttribute("href")){let c=s.location.href,u=c.indexOf("#");l=u===-1?c:c.slice(0,u)}return l+"#"+(typeof i=="string"?i:cf(i))}function r(s,i){fm(s.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(i)+")")}return D3(e,n,r,t)}function wt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function fm(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function M3(){return Math.random().toString(36).substr(2,8)}function wS(t,e){return{usr:t.state,key:t.key,idx:e}}function Z0(t,e,n,r){return n===void 0&&(n=null),ou({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?io(e):e,{state:n,key:e&&e.key||r||M3()})}function cf(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function io(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function D3(t,e,n,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:i=!1}=r,o=s.history,l=Fi.Pop,c=null,u=d();u==null&&(u=0,o.replaceState(ou({},o.state,{idx:u}),""));function d(){return(o.state||{idx:null}).idx}function m(){l=Fi.Pop;let v=d(),S=v==null?null:v-u;u=v,c&&c({action:l,location:w.location,delta:S})}function p(v,S){l=Fi.Push;let _=Z0(w.location,v,S);n&&n(_,v),u=d()+1;let E=wS(_,u),I=w.createHref(_);try{o.pushState(E,"",I)}catch(N){if(N instanceof DOMException&&N.name==="DataCloneError")throw N;s.location.assign(I)}i&&c&&c({action:l,location:w.location,delta:1})}function g(v,S){l=Fi.Replace;let _=Z0(w.location,v,S);n&&n(_,v),u=d();let E=wS(_,u),I=w.createHref(_);o.replaceState(E,"",I),i&&c&&c({action:l,location:w.location,delta:0})}function x(v){let S=s.location.origin!=="null"?s.location.origin:s.location.href,_=typeof v=="string"?v:cf(v);return wt(S,"No window.location.(origin|href) available to create URL for href: "+_),new URL(_,S)}let w={get action(){return l},get location(){return t(s,o)},listen(v){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(vS,m),c=v,()=>{s.removeEventListener(vS,m),c=null}},createHref(v){return e(s,v)},createURL:x,encodeLocation(v){let S=x(v);return{pathname:S.pathname,search:S.search,hash:S.hash}},push:p,replace:g,go(v){return o.go(v)}};return w}var _S;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(_S||(_S={}));function L3(t,e,n){n===void 0&&(n="/");let r=typeof e=="string"?io(e):e,s=iv(r.pathname||"/",n);if(s==null)return null;let i=Mk(t);O3(i);let o=null;for(let l=0;o==null&&l<i.length;++l)o=q3(i[l],X3(s));return o}function Mk(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let s=(i,o,l)=>{let c={relativePath:l===void 0?i.path||"":l,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};c.relativePath.startsWith("/")&&(wt(c.relativePath.startsWith(r),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(r.length));let u=Hi([r,c.relativePath]),d=n.concat(c);i.children&&i.children.length>0&&(wt(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),Mk(i.children,e,d,u)),!(i.path==null&&!i.index)&&e.push({path:u,score:G3(u,i.index),routesMeta:d})};return t.forEach((i,o)=>{var l;if(i.path===""||!((l=i.path)!=null&&l.includes("?")))s(i,o);else for(let c of Dk(i.path))s(i,o,c)}),e}function Dk(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let o=Dk(r.join("/")),l=[];return l.push(...o.map(c=>c===""?i:[i,c].join("/"))),s&&l.push(...o),l.map(c=>t.startsWith("/")&&c===""?"/":c)}function O3(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:W3(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const $3=/^:\w+$/,z3=3,B3=2,V3=1,U3=10,H3=-2,SS=t=>t==="*";function G3(t,e){let n=t.split("/"),r=n.length;return n.some(SS)&&(r+=H3),e&&(r+=B3),n.filter(s=>!SS(s)).reduce((s,i)=>s+($3.test(i)?z3:i===""?V3:U3),r)}function W3(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function q3(t,e){let{routesMeta:n}=t,r={},s="/",i=[];for(let o=0;o<n.length;++o){let l=n[o],c=o===n.length-1,u=s==="/"?e:e.slice(s.length)||"/",d=K3({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u);if(!d)return null;Object.assign(r,d.params);let m=l.route;i.push({params:r,pathname:Hi([s,d.pathname]),pathnameBase:e4(Hi([s,d.pathnameBase])),route:m}),d.pathnameBase!=="/"&&(s=Hi([s,d.pathnameBase]))}return i}function K3(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=Q3(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:r.reduce((u,d,m)=>{if(d==="*"){let p=l[m]||"";o=i.slice(0,i.length-p.length).replace(/(.)\/+$/,"$1")}return u[d]=Y3(l[m]||"",d),u},{}),pathname:i,pathnameBase:o,pattern:t}}function Q3(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),fm(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/\/:(\w+)/g,(o,l)=>(r.push(l),"/([^\\/]+)"));return t.endsWith("*")?(r.push("*"),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function X3(t){try{return decodeURI(t)}catch(e){return fm(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function Y3(t,e){try{return decodeURIComponent(t)}catch(n){return fm(!1,'The value for the URL param "'+e+'" will not be decoded because'+(' the string "'+t+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+n+").")),t}}function iv(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function J3(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?io(t):t;return{pathname:n?n.startsWith("/")?n:Z3(n,e):e,search:t4(r),hash:n4(s)}}function Z3(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function yg(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function av(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function ov(t,e,n,r){r===void 0&&(r=!1);let s;typeof t=="string"?s=io(t):(s=ou({},t),wt(!s.pathname||!s.pathname.includes("?"),yg("?","pathname","search",s)),wt(!s.pathname||!s.pathname.includes("#"),yg("#","pathname","hash",s)),wt(!s.search||!s.search.includes("#"),yg("#","search","hash",s)));let i=t===""||s.pathname==="",o=i?"/":s.pathname,l;if(r||o==null)l=n;else{let m=e.length-1;if(o.startsWith("..")){let p=o.split("/");for(;p[0]==="..";)p.shift(),m-=1;s.pathname=p.join("/")}l=m>=0?e[m]:"/"}let c=J3(s,l),u=o&&o!=="/"&&o.endsWith("/"),d=(i||o===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}const Hi=t=>t.join("/").replace(/\/\/+/g,"/"),e4=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),t4=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,n4=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function r4(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const Lk=["post","put","patch","delete"];new Set(Lk);const s4=["get",...Lk];new Set(s4);/**
 * React Router v6.14.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function uf(){return uf=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},uf.apply(this,arguments)}const lv=h.createContext(null),i4=h.createContext(null),Nl=h.createContext(null),mm=h.createContext(null),Rs=h.createContext({outlet:null,matches:[],isDataRoute:!1}),Ok=h.createContext(null);function a4(t,e){let{relative:n}=e===void 0?{}:e;Al()||wt(!1);let{basename:r,navigator:s}=h.useContext(Nl),{hash:i,pathname:o,search:l}=zk(t,{relative:n}),c=o;return r!=="/"&&(c=o==="/"?r:Hi([r,o])),s.createHref({pathname:c,search:l,hash:i})}function Al(){return h.useContext(mm)!=null}function Zn(){return Al()||wt(!1),h.useContext(mm).location}function $k(t){h.useContext(Nl).static||h.useLayoutEffect(t)}function Wt(){let{isDataRoute:t}=h.useContext(Rs);return t?_4():o4()}function o4(){Al()||wt(!1);let t=h.useContext(lv),{basename:e,navigator:n}=h.useContext(Nl),{matches:r}=h.useContext(Rs),{pathname:s}=Zn(),i=JSON.stringify(av(r).map(c=>c.pathnameBase)),o=h.useRef(!1);return $k(()=>{o.current=!0}),h.useCallback(function(c,u){if(u===void 0&&(u={}),!o.current)return;if(typeof c=="number"){n.go(c);return}let d=ov(c,JSON.parse(i),s,u.relative==="path");t==null&&e!=="/"&&(d.pathname=d.pathname==="/"?e:Hi([e,d.pathname])),(u.replace?n.replace:n.push)(d,u.state,u)},[e,n,i,s,t])}const l4=h.createContext(null);function c4(t){let e=h.useContext(Rs).outlet;return e&&h.createElement(l4.Provider,{value:t},e)}function li(){let{matches:t}=h.useContext(Rs),e=t[t.length-1];return e?e.params:{}}function zk(t,e){let{relative:n}=e===void 0?{}:e,{matches:r}=h.useContext(Rs),{pathname:s}=Zn(),i=JSON.stringify(av(r).map(o=>o.pathnameBase));return h.useMemo(()=>ov(t,JSON.parse(i),s,n==="path"),[t,i,s,n])}function u4(t,e){return d4(t,e)}function d4(t,e,n){Al()||wt(!1);let{navigator:r}=h.useContext(Nl),{matches:s}=h.useContext(Rs),i=s[s.length-1],o=i?i.params:{};i&&i.pathname;let l=i?i.pathnameBase:"/";i&&i.route;let c=Zn(),u;if(e){var d;let w=typeof e=="string"?io(e):e;l==="/"||(d=w.pathname)!=null&&d.startsWith(l)||wt(!1),u=w}else u=c;let m=u.pathname||"/",p=l==="/"?m:m.slice(l.length)||"/",g=L3(t,{pathname:p}),x=g4(g&&g.map(w=>Object.assign({},w,{params:Object.assign({},o,w.params),pathname:Hi([l,r.encodeLocation?r.encodeLocation(w.pathname).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?l:Hi([l,r.encodeLocation?r.encodeLocation(w.pathnameBase).pathname:w.pathnameBase])})),s,n);return e&&x?h.createElement(mm.Provider,{value:{location:uf({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:Fi.Pop}},x):x}function h4(){let t=w4(),e=r4(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},i=null;return h.createElement(h.Fragment,null,h.createElement("h2",null,"Unexpected Application Error!"),h.createElement("h3",{style:{fontStyle:"italic"}},e),n?h.createElement("pre",{style:s},n):null,i)}const f4=h.createElement(h4,null);class m4 extends h.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error||n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error?h.createElement(Rs.Provider,{value:this.props.routeContext},h.createElement(Ok.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function p4(t){let{routeContext:e,match:n,children:r}=t,s=h.useContext(lv);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),h.createElement(Rs.Provider,{value:e},r)}function g4(t,e,n){var r;if(e===void 0&&(e=[]),n===void 0&&(n=null),t==null){var s;if((s=n)!=null&&s.errors)t=n.matches;else return null}let i=t,o=(r=n)==null?void 0:r.errors;if(o!=null){let l=i.findIndex(c=>c.route.id&&(o==null?void 0:o[c.route.id]));l>=0||wt(!1),i=i.slice(0,Math.min(i.length,l+1))}return i.reduceRight((l,c,u)=>{let d=c.route.id?o==null?void 0:o[c.route.id]:null,m=null;n&&(m=c.route.errorElement||f4);let p=e.concat(i.slice(0,u+1)),g=()=>{let x;return d?x=m:c.route.Component?x=h.createElement(c.route.Component,null):c.route.element?x=c.route.element:x=l,h.createElement(p4,{match:c,routeContext:{outlet:l,matches:p,isDataRoute:n!=null},children:x})};return n&&(c.route.ErrorBoundary||c.route.errorElement||u===0)?h.createElement(m4,{location:n.location,revalidation:n.revalidation,component:m,error:d,children:g(),routeContext:{outlet:null,matches:p,isDataRoute:!0}}):g()},null)}var ex;(function(t){t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate"})(ex||(ex={}));var lu;(function(t){t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId"})(lu||(lu={}));function x4(t){let e=h.useContext(lv);return e||wt(!1),e}function y4(t){let e=h.useContext(i4);return e||wt(!1),e}function v4(t){let e=h.useContext(Rs);return e||wt(!1),e}function Bk(t){let e=v4(),n=e.matches[e.matches.length-1];return n.route.id||wt(!1),n.route.id}function w4(){var t;let e=h.useContext(Ok),n=y4(lu.UseRouteError),r=Bk(lu.UseRouteError);return e||((t=n.errors)==null?void 0:t[r])}function _4(){let{router:t}=x4(ex.UseNavigateStable),e=Bk(lu.UseNavigateStable),n=h.useRef(!1);return $k(()=>{n.current=!0}),h.useCallback(function(s,i){i===void 0&&(i={}),n.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,uf({fromRouteId:e},i)))},[t,e])}function cv(t){let{to:e,replace:n,state:r,relative:s}=t;Al()||wt(!1);let{matches:i}=h.useContext(Rs),{pathname:o}=Zn(),l=Wt(),c=ov(e,av(i).map(d=>d.pathnameBase),o,s==="path"),u=JSON.stringify(c);return h.useEffect(()=>l(JSON.parse(u),{replace:n,state:r,relative:s}),[l,u,s,n,r]),null}function pm(t){return c4(t.context)}function Hr(t){wt(!1)}function S4(t){let{basename:e="/",children:n=null,location:r,navigationType:s=Fi.Pop,navigator:i,static:o=!1}=t;Al()&&wt(!1);let l=e.replace(/^\/*/,"/"),c=h.useMemo(()=>({basename:l,navigator:i,static:o}),[l,i,o]);typeof r=="string"&&(r=io(r));let{pathname:u="/",search:d="",hash:m="",state:p=null,key:g="default"}=r,x=h.useMemo(()=>{let w=iv(u,l);return w==null?null:{location:{pathname:w,search:d,hash:m,state:p,key:g},navigationType:s}},[l,u,d,m,p,g,s]);return x==null?null:h.createElement(Nl.Provider,{value:c},h.createElement(mm.Provider,{children:n,value:x}))}function b4(t){let{children:e,location:n}=t;return u4(tx(e),n)}var bS;(function(t){t[t.pending=0]="pending",t[t.success=1]="success",t[t.error=2]="error"})(bS||(bS={}));new Promise(()=>{});function tx(t,e){e===void 0&&(e=[]);let n=[];return h.Children.forEach(t,(r,s)=>{if(!h.isValidElement(r))return;let i=[...e,s];if(r.type===h.Fragment){n.push.apply(n,tx(r.props.children,i));return}r.type!==Hr&&wt(!1),!r.props.index||!r.props.children||wt(!1);let o={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=tx(r.props.children,i)),n.push(o)}),n}/**
 * React Router DOM v6.14.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function nx(){return nx=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},nx.apply(this,arguments)}function E4(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,i;for(i=0;i<r.length;i++)s=r[i],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}function j4(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function k4(t,e){return t.button===0&&(!e||e==="_self")&&!j4(t)}function rx(t){return t===void 0&&(t=""),new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let r=t[n];return e.concat(Array.isArray(r)?r.map(s=>[n,s]):[[n,r]])},[]))}function T4(t,e){let n=rx(t);if(e)for(let r of e.keys())n.has(r)||e.getAll(r).forEach(s=>{n.append(r,s)});return n}const I4=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset"],C4="startTransition",ES=E5[C4];function R4(t){let{basename:e,children:n,future:r,window:s}=t,i=h.useRef();i.current==null&&(i.current=F3({window:s,v5Compat:!0}));let o=i.current,[l,c]=h.useState({action:o.action,location:o.location}),{v7_startTransition:u}=r||{},d=h.useCallback(m=>{u&&ES?ES(()=>c(m)):c(m)},[c,u]);return h.useLayoutEffect(()=>o.listen(d),[o,d]),h.createElement(S4,{basename:e,children:n,location:l.location,navigationType:l.action,navigator:o})}const N4=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",A4=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Y=h.forwardRef(function(e,n){let{onClick:r,relative:s,reloadDocument:i,replace:o,state:l,target:c,to:u,preventScrollReset:d}=e,m=E4(e,I4),{basename:p}=h.useContext(Nl),g,x=!1;if(typeof u=="string"&&A4.test(u)&&(g=u,N4))try{let _=new URL(window.location.href),E=u.startsWith("//")?new URL(_.protocol+u):new URL(u),I=iv(E.pathname,p);E.origin===_.origin&&I!=null?u=I+E.search+E.hash:x=!0}catch{}let w=a4(u,{relative:s}),v=P4(u,{replace:o,state:l,target:c,preventScrollReset:d,relative:s});function S(_){r&&r(_),_.defaultPrevented||v(_)}return h.createElement("a",nx({},m,{href:g||w,onClick:x||i?r:S,ref:n,target:c}))});var jS;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher"})(jS||(jS={}));var kS;(function(t){t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(kS||(kS={}));function P4(t,e){let{target:n,replace:r,state:s,preventScrollReset:i,relative:o}=e===void 0?{}:e,l=Wt(),c=Zn(),u=zk(t,{relative:o});return h.useCallback(d=>{if(k4(d,n)){d.preventDefault();let m=r!==void 0?r:cf(c)===cf(u);l(t,{replace:m,state:s,preventScrollReset:i,relative:o})}},[c,l,u,r,s,n,t,i,o])}function Vk(t){let e=h.useRef(rx(t)),n=h.useRef(!1),r=Zn(),s=h.useMemo(()=>T4(r.search,n.current?null:e.current),[r.search]),i=Wt(),o=h.useCallback((l,c)=>{const u=rx(typeof l=="function"?l(s):l);n.current=!0,i("?"+u,c)},[i,s]);return[s,o]}function ci(){const t={container:"pt-[30px] pb-[calc(127px+30px)] md:mt-auto md:pb-[120px] md:flex md:justify-between md:items-center",icon:"w-6 hover:scale-[1.1] transition linear ",copyRightText:"text-sm font-medium"};return a.jsxs("div",{className:`${t.container}`,children:[a.jsxs("p",{className:t.copyRightText,children:["Make with  ",a.jsx("span",{children:"❤️ "}),"by d4t06 ",a.jsx("br",{})," © All rights no reserve ¯\\_(ツ)_/¯"]}),a.jsxs("div",{className:"flex items-center mt-5 md:mt-0 space-x-[10px] h-[30px]",children:[a.jsx("a",{href:"mailto:datnh0708@gmail.com",children:a.jsx("svg",{className:t.icon,fill:"currentColor",viewBox:"0 0 32 32",xmlns:"http://www.w3.org/2000/svg",children:a.jsxs("g",{children:[a.jsx("path",{d:"M16.601 14.648v4.105h9.813c-0.162 2.008-0.982 3.798-2.243 5.18l0.006-0.007c-1.825 1.86-4.364 3.012-7.172 3.012-0.142 0-0.283-0.003-0.424-0.009l0.020 0.001c-5.946-0.003-10.765-4.823-10.765-10.77 0-0.051 0-0.102 0.001-0.152l-0 0.008c-0.001-0.043-0.001-0.094-0.001-0.145 0-5.946 4.819-10.767 10.765-10.77h0c0.040-0.001 0.087-0.001 0.135-0.001 2.822 0 5.383 1.121 7.262 2.941l-0.003-0.003 2.888-2.888c-2.568-2.578-6.121-4.174-10.047-4.174-0.082 0-0.164 0.001-0.246 0.002l0.012-0c-0.002 0-0.005 0-0.008 0-8.337 0-15.11 6.699-15.228 15.009l-0 0.011c0.118 8.32 6.891 15.020 15.228 15.020 0.003 0 0.006 0 0.009 0h-0c0.169 0.007 0.367 0.012 0.566 0.012 3.892 0 7.407-1.616 9.91-4.213l0.004-0.004c2.208-2.408 3.561-5.63 3.561-9.169 0-0.15-0.002-0.3-0.007-0.449l0.001 0.022c0.001-0.054 0.001-0.119 0.001-0.183 0-0.844-0.079-1.669-0.231-2.469l0.013 0.082z"})," "]})})}),a.jsx("a",{href:"https://github.com/d4t06",target:"_blank",children:a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t.icon,fill:"currentColor",viewBox:"0 0 496 512",children:a.jsx("path",{d:"M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"})})}),a.jsx("a",{href:"https://www.linkedin.com/in/dat-nguyen-huu-9371a926a",target:"_blank",children:a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t.icon,viewBox:"0 0 448 512",fill:"currentColor",children:a.jsx("path",{d:"M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"})})})]})]})}function Uk(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t))for(e=0;e<t.length;e++)t[e]&&(n=Uk(t[e]))&&(r&&(r+=" "),r+=n);else for(e in t)t[e]&&(r&&(r+=" "),r+=e);return r}function F4(){for(var t,e,n=0,r="";n<arguments.length;)(t=arguments[n++])&&(e=Uk(t))&&(r&&(r+=" "),r+=e);return r}const TS=t=>typeof t=="boolean"?"".concat(t):t===0?"0":t,IS=F4,Pu=(t,e)=>n=>{var r;if((e==null?void 0:e.variants)==null)return IS(t,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:s,defaultVariants:i}=e,o=Object.keys(s).map(u=>{const d=n==null?void 0:n[u],m=i==null?void 0:i[u];if(d===null)return null;const p=TS(d)||TS(m);return s[u][p]}),l=n&&Object.entries(n).reduce((u,d)=>{let[m,p]=d;return p===void 0||(u[m]=p),u},{}),c=e==null||(r=e.compoundVariants)===null||r===void 0?void 0:r.reduce((u,d)=>{let{class:m,className:p,...g}=d;return Object.entries(g).every(x=>{let[w,v]=x;return Array.isArray(v)?v.includes({...i,...l}[w]):{...i,...l}[w]===v})?[...u,m,p]:u},[]);return IS(t,o,c,n==null?void 0:n.class,n==null?void 0:n.className)};function M4({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 6h9.75M10.5 6a1.5 1.5 0 11-3 0m3 0a1.5 1.5 0 10-3 0M3.75 6H7.5m3 12h9.75m-9.75 0a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0m-3.75 0H7.5m9-6h3.75m-3.75 0a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0m-9.75 0h9.75"}))}const D4=h.forwardRef(M4),uv=D4;function L4({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3"}))}const O4=h.forwardRef(L4),Fu=O4;function $4({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6a2.25 2.25 0 00-2.25 2.25v13.5A2.25 2.25 0 007.5 21h6a2.25 2.25 0 002.25-2.25V15M12 9l-3 3m0 0l3 3m-3-3h12.75"}))}const z4=h.forwardRef($4),B4=z4;function V4({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18"}))}const U4=h.forwardRef(V4),dv=U4;function H4({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 12c0-1.232-.046-2.453-.138-3.662a4.006 4.006 0 00-3.7-3.7 48.678 48.678 0 00-7.324 0 4.006 4.006 0 00-3.7 3.7c-.017.22-.032.441-.046.662M19.5 12l3-3m-3 3l-3-3m-12 3c0 1.232.046 2.453.138 3.662a4.006 4.006 0 003.7 3.7 48.656 48.656 0 007.324 0 4.006 4.006 0 003.7-3.7c.017-.22.032-.441.046-.662M4.5 12l3 3m-3-3l-3 3"}))}const G4=h.forwardRef(H4),Hk=G4;function W4({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99"}))}const q4=h.forwardRef(W4),Ie=q4;function K4({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6a2.25 2.25 0 00-2.25 2.25v13.5A2.25 2.25 0 007.5 21h6a2.25 2.25 0 002.25-2.25V15m3 0l3-3m0 0l-3-3m3 3H9"}))}const Q4=h.forwardRef(K4),hv=Q4;function X4({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 4.5L21 12m0 0l-7.5 7.5M21 12H3"}))}const Y4=h.forwardRef(X4),Gk=Y4;function J4({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 6H5.25A2.25 2.25 0 003 8.25v10.5A2.25 2.25 0 005.25 21h10.5A2.25 2.25 0 0018 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"}))}const Z4=h.forwardRef(J4),eF=Z4;function tF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 18L9 11.25l4.306 4.307a11.95 11.95 0 015.814-5.519l2.74-1.22m0 0l-5.94-2.28m5.94 2.28l-2.28 5.941"}))}const nF=h.forwardRef(tF),gm=nF;function rF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 19.5l15-15m0 0H8.25m11.25 0v11.25"}))}const sF=h.forwardRef(rF),Wk=sF;function iF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5m-13.5-9L12 3m0 0l4.5 4.5M12 3v13.5"}))}const aF=h.forwardRef(iF),fv=aF;function oF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 16.811c0 .864-.933 1.405-1.683.977l-7.108-4.062a1.125 1.125 0 010-1.953l7.108-4.062A1.125 1.125 0 0121 8.688v8.123zM11.25 16.811c0 .864-.933 1.405-1.683.977l-7.108-4.062a1.125 1.125 0 010-1.953L9.567 7.71a1.125 1.125 0 011.683.977v8.123z"}))}const lF=h.forwardRef(oF),qk=lF;function cF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"}))}const uF=h.forwardRef(cF),ao=uF;function dF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20.25 8.511c.884.284 1.5 1.128 1.5 2.097v4.286c0 1.136-.847 2.1-1.98 2.193-.34.027-.68.052-1.02.072v3.091l-3-3c-1.354 0-2.694-.055-4.02-.163a2.115 2.115 0 01-.825-.242m9.345-8.334a2.126 2.126 0 00-.476-.095 48.64 48.64 0 00-8.048 0c-1.131.094-1.976 1.057-1.976 2.192v4.286c0 .837.46 1.58 1.155 1.951m9.345-8.334V6.637c0-1.621-1.152-3.026-2.76-3.235A48.455 48.455 0 0011.25 3c-2.115 0-4.198.137-6.24.402-1.608.209-2.76 1.614-2.76 3.235v6.226c0 1.621 1.152 3.026 2.76 3.235.577.075 1.157.14 1.74.194V21l4.155-4.155"}))}const hF=h.forwardRef(dF),mv=hF;function fF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}))}const mF=h.forwardRef(fF),pF=mF;function gF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 12.75l6 6 9-13.5"}))}const xF=h.forwardRef(gF),oa=xF;function yF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 8.25l-7.5 7.5-7.5-7.5"}))}const vF=h.forwardRef(yF),Kk=vF;function wF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5L8.25 12l7.5-7.5"}))}const _F=h.forwardRef(wF),pv=_F;function SF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 4.5l7.5 7.5-7.5 7.5"}))}const bF=h.forwardRef(SF),df=bF;function EF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 15.75l7.5-7.5 7.5 7.5"}))}const jF=h.forwardRef(EF),kF=jF;function TF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 7.5V6.108c0-1.135.845-2.098 1.976-2.192.373-.03.748-.057 1.123-.08M15.75 18H18a2.25 2.25 0 002.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 00-1.123-.08M15.75 18.75v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5A3.375 3.375 0 006.375 7.5H5.25m11.9-3.664A2.251 2.251 0 0015 2.25h-1.5a2.251 2.251 0 00-2.15 1.586m5.8 0c.065.21.1.433.1.664v.75h-6V4.5c0-.231.035-.454.1-.664M6.75 7.5H4.875c-.621 0-1.125.504-1.125 1.125v12c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V16.5a9 9 0 00-9-9z"}))}const IF=h.forwardRef(TF),CF=IF;function RF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z"}))}const NF=h.forwardRef(RF),Qk=NF;function AF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.324.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 011.37.49l1.296 2.247a1.125 1.125 0 01-.26 1.431l-1.003.827c-.293.24-.438.613-.431.992a6.759 6.759 0 010 .255c-.007.378.138.75.43.99l1.005.828c.424.35.534.954.26 1.43l-1.298 2.247a1.125 1.125 0 01-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.57 6.57 0 01-.22.128c-.331.183-.581.495-.644.869l-.213 1.28c-.09.543-.56.941-1.11.941h-2.594c-.55 0-1.02-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 01-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 01-1.369-.49l-1.297-2.247a1.125 1.125 0 01.26-1.431l1.004-.827c.292-.24.437-.613.43-.992a6.932 6.932 0 010-.255c.007-.378-.138-.75-.43-.99l-1.004-.828a1.125 1.125 0 01-.26-1.43l1.297-2.247a1.125 1.125 0 011.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.087.22-.128.332-.183.582-.495.644-.869l.214-1.281z"}),h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}))}const PF=h.forwardRef(AF),gv=PF;function FF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 17.25v1.007a3 3 0 01-.879 2.122L7.5 21h9l-.621-.621A3 3 0 0115 18.257V17.25m6-12V15a2.25 2.25 0 01-2.25 2.25H5.25A2.25 2.25 0 013 15V5.25m18 0A2.25 2.25 0 0018.75 3H5.25A2.25 2.25 0 003 5.25m18 0V12a2.25 2.25 0 01-2.25 2.25H5.25A2.25 2.25 0 013 12V5.25"}))}const MF=h.forwardRef(FF),xm=MF;function DF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z"}))}const LF=h.forwardRef(DF),ym=LF;function OF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m9-.75a9 9 0 11-18 0 9 9 0 0118 0zm-9 3.75h.008v.008H12v-.008z"}))}const $F=h.forwardRef(OF),vm=$F;function zF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z"}),h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}))}const BF=h.forwardRef(zF),VF=BF;function UF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.375 19.5h17.25m-17.25 0a1.125 1.125 0 01-1.125-1.125M3.375 19.5h1.5C5.496 19.5 6 18.996 6 18.375m-3.75 0V5.625m0 12.75v-1.5c0-.621.504-1.125 1.125-1.125m18.375 2.625V5.625m0 12.75c0 .621-.504 1.125-1.125 1.125m1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125m0 3.75h-1.5A1.125 1.125 0 0118 18.375M20.625 4.5H3.375m17.25 0c.621 0 1.125.504 1.125 1.125M20.625 4.5h-1.5C18.504 4.5 18 5.004 18 5.625m3.75 0v1.5c0 .621-.504 1.125-1.125 1.125M3.375 4.5c-.621 0-1.125.504-1.125 1.125M3.375 4.5h1.5C5.496 4.5 6 5.004 6 5.625m-3.75 0v1.5c0 .621.504 1.125 1.125 1.125m0 0h1.5m-1.5 0c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125m1.5-3.75C5.496 8.25 6 7.746 6 7.125v-1.5M4.875 8.25C5.496 8.25 6 8.754 6 9.375v1.5m0-5.25v5.25m0-5.25C6 5.004 6.504 4.5 7.125 4.5h9.75c.621 0 1.125.504 1.125 1.125m1.125 2.625h1.5m-1.5 0A1.125 1.125 0 0118 7.125v-1.5m1.125 2.625c-.621 0-1.125.504-1.125 1.125v1.5m2.625-2.625c.621 0 1.125.504 1.125 1.125v1.5c0 .621-.504 1.125-1.125 1.125M18 5.625v5.25M7.125 12h9.75m-9.75 0A1.125 1.125 0 016 10.875M7.125 12C6.504 12 6 12.504 6 13.125m0-2.25C6 11.496 5.496 12 4.875 12M18 10.875c0 .621-.504 1.125-1.125 1.125M18 10.875c0 .621.504 1.125 1.125 1.125m-2.25 0c.621 0 1.125.504 1.125 1.125m-12 5.25v-5.25m0 5.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125m-12 0v-1.5c0-.621-.504-1.125-1.125-1.125M18 18.375v-5.25m0 5.25v-1.5c0-.621.504-1.125 1.125-1.125M18 13.125v1.5c0 .621.504 1.125 1.125 1.125M18 13.125c0-.621.504-1.125 1.125-1.125M6 13.125v1.5c0 .621-.504 1.125-1.125 1.125M6 13.125C6 12.504 5.496 12 4.875 12m-1.5 0h1.5m-1.5 0c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125M19.125 12h1.5m0 0c.621 0 1.125.504 1.125 1.125v1.5c0 .621-.504 1.125-1.125 1.125m-17.25 0h1.5m14.25 0h1.5"}))}const HF=h.forwardRef(UF),Xk=HF;function GF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 9.776c.112-.017.227-.026.344-.026h15.812c.117 0 .232.009.344.026m-16.5 0a2.25 2.25 0 00-1.883 2.542l.857 6a2.25 2.25 0 002.227 1.932H19.05a2.25 2.25 0 002.227-1.932l.857-6a2.25 2.25 0 00-1.883-2.542m-16.5 0V6A2.25 2.25 0 016 3.75h3.879a1.5 1.5 0 011.06.44l2.122 2.12a1.5 1.5 0 001.06.44H18A2.25 2.25 0 0120.25 9v.776"}))}const WF=h.forwardRef(GF),qF=WF;function KF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 8.688c0-.864.933-1.405 1.683-.977l7.108 4.062a1.125 1.125 0 010 1.953l-7.108 4.062A1.125 1.125 0 013 16.81V8.688zM12.75 8.688c0-.864.933-1.405 1.683-.977l7.108 4.062a1.125 1.125 0 010 1.953l-7.108 4.062a1.125 1.125 0 01-1.683-.977V8.688z"}))}const QF=h.forwardRef(KF),Yk=QF;function XF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12.75 3.03v.568c0 .334.148.65.405.864l1.068.89c.442.369.535 1.01.216 1.49l-.51.766a2.25 2.25 0 01-1.161.886l-.143.048a1.107 1.107 0 00-.57 1.664c.369.555.169 1.307-.427 1.605L9 13.125l.423 1.059a.956.956 0 01-1.652.928l-.679-.906a1.125 1.125 0 00-1.906.172L4.5 15.75l-.612.153M12.75 3.031a9 9 0 00-8.862 12.872M12.75 3.031a9 9 0 016.69 14.036m0 0l-.177-.529A2.25 2.25 0 0017.128 15H16.5l-.324-.324a1.453 1.453 0 00-2.328.377l-.036.073a1.586 1.586 0 01-.982.816l-.99.282c-.55.157-.894.702-.8 1.267l.073.438c.08.474.49.821.97.821.846 0 1.598.542 1.865 1.345l.215.643m5.276-3.67a9.012 9.012 0 01-5.276 3.67m0 0a9 9 0 01-10.275-4.835M15.75 9c0 .896-.393 1.7-1.016 2.25"}))}const YF=h.forwardRef(XF),Jk=YF;function JF({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12z"}))}const ZF=h.forwardRef(JF),Mu=ZF;function eM({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 12l8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25"}))}const tM=h.forwardRef(eM),Du=tM;function nM({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z"}))}const rM=h.forwardRef(nM),Zk=rM;function sM({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.19 8.688a4.5 4.5 0 011.242 7.244l-4.5 4.5a4.5 4.5 0 01-6.364-6.364l1.757-1.757m13.35-.622l1.757-1.757a4.5 4.5 0 00-6.364-6.364l-4.5 4.5a4.5 4.5 0 001.242 7.244"}))}const iM=h.forwardRef(sM),aM=iM;function oM({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"}))}const lM=h.forwardRef(oM),Lu=lM;function cM({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 12h-15"}))}const uM=h.forwardRef(cM),xv=uM;function dM({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 9l10.5-3m0 6.553v3.75a2.25 2.25 0 01-1.632 2.163l-1.32.377a1.803 1.803 0 11-.99-3.467l2.31-.66a2.25 2.25 0 001.632-2.163zm0 0V2.25L9 5.25v10.303m0 0v3.75a2.25 2.25 0 01-1.632 2.163l-1.32.377a1.803 1.803 0 01-.99-3.467l2.31-.66A2.25 2.25 0 009 15.553z"}))}const hM=h.forwardRef(dM),la=hM;function fM({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 7.5h1.5m-1.5 3h1.5m-7.5 3h7.5m-7.5 3h7.5m3-9h3.375c.621 0 1.125.504 1.125 1.125V18a2.25 2.25 0 01-2.25 2.25M16.5 7.5V18a2.25 2.25 0 002.25 2.25M16.5 7.5V4.875c0-.621-.504-1.125-1.125-1.125H4.125C3.504 3.75 3 4.254 3 4.875V18a2.25 2.25 0 002.25 2.25h13.5M6 7.5h3v3H6v-3z"}))}const mM=h.forwardRef(fM),pM=mM;function gM({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.53 16.122a3 3 0 00-5.78 1.128 2.25 2.25 0 01-2.4 2.245 4.5 4.5 0 008.4-2.245c0-.399-.078-.78-.22-1.128zm0 0a15.998 15.998 0 003.388-1.62m-5.043-.025a15.994 15.994 0 011.622-3.395m3.42 3.42a15.995 15.995 0 004.764-4.648l3.876-5.814a1.151 1.151 0 00-1.597-1.597L14.146 6.32a15.996 15.996 0 00-4.649 4.763m3.42 3.42a6.776 6.776 0 00-3.42-3.42"}))}const xM=h.forwardRef(gM),eT=xM;function yM({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.25 9v6m-4.5 0V9M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}))}const vM=h.forwardRef(yM),tT=vM;function wM({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 5.25v13.5m-7.5-13.5v13.5"}))}const _M=h.forwardRef(wM),yv=_M;function SM({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125"}))}const bM=h.forwardRef(SM),Dr=bM;function EM({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 15.75l5.159-5.159a2.25 2.25 0 013.182 0l5.159 5.159m-1.5-1.5l1.409-1.409a2.25 2.25 0 013.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 001.5-1.5V6a1.5 1.5 0 00-1.5-1.5H3.75A1.5 1.5 0 002.25 6v12a1.5 1.5 0 001.5 1.5zm10.5-11.25h.008v.008h-.008V8.25zm.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0z"}))}const jM=h.forwardRef(EM),ui=jM;function kM({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}),h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.91 11.672a.375.375 0 010 .656l-5.603 3.113a.375.375 0 01-.557-.328V8.887c0-.286.307-.466.557-.327l5.603 3.112z"}))}const TM=h.forwardRef(kM),IM=TM;function CM({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 5.653c0-.856.917-1.398 1.667-.986l11.54 6.348a1.125 1.125 0 010 1.971l-11.54 6.347a1.125 1.125 0 01-1.667-.985V5.653z"}))}const RM=h.forwardRef(CM),hf=RM;function NM({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"}))}const AM=h.forwardRef(NM),Nt=AM;function PM({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 12h16.5m-16.5 3.75h16.5M3.75 19.5h16.5M5.625 4.5h12.75a1.875 1.875 0 010 3.75H5.625a1.875 1.875 0 010-3.75z"}))}const FM=h.forwardRef(PM),MM=FM;function DM({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 7.125C2.25 6.504 2.754 6 3.375 6h6c.621 0 1.125.504 1.125 1.125v3.75c0 .621-.504 1.125-1.125 1.125h-6a1.125 1.125 0 01-1.125-1.125v-3.75zM14.25 8.625c0-.621.504-1.125 1.125-1.125h5.25c.621 0 1.125.504 1.125 1.125v8.25c0 .621-.504 1.125-1.125 1.125h-5.25a1.125 1.125 0 01-1.125-1.125v-8.25zM3.75 16.125c0-.621.504-1.125 1.125-1.125h5.25c.621 0 1.125.504 1.125 1.125v2.25c0 .621-.504 1.125-1.125 1.125h-5.25a1.125 1.125 0 01-1.125-1.125v-2.25z"}))}const LM=h.forwardRef(DM),OM=LM;function $M({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7.848 8.25l1.536.887M7.848 8.25a3 3 0 11-5.196-3 3 3 0 015.196 3zm1.536.887a2.165 2.165 0 011.083 1.839c.005.351.054.695.14 1.024M9.384 9.137l2.077 1.199M7.848 15.75l1.536-.887m-1.536.887a3 3 0 11-5.196 3 3 3 0 015.196-3zm1.536-.887a2.165 2.165 0 001.083-1.838c.005-.352.054-.695.14-1.025m-1.223 2.863l2.077-1.199m0-3.328a4.323 4.323 0 012.068-1.379l5.325-1.628a4.5 4.5 0 012.48-.044l.803.215-7.794 4.5m-2.882-1.664A4.331 4.331 0 0010.607 12m3.736 0l7.794 4.5-.802.215a4.5 4.5 0 01-2.48-.043l-5.326-1.629a4.324 4.324 0 01-2.068-1.379M14.343 12l-2.882 1.664"}))}const zM=h.forwardRef($M),nT=zM;function BM({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.114 5.636a9 9 0 010 12.728M16.463 8.288a5.25 5.25 0 010 7.424M6.75 8.25l4.72-4.72a.75.75 0 011.28.53v15.88a.75.75 0 01-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.01 9.01 0 012.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75z"}))}const VM=h.forwardRef(BM),UM=VM;function HM({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17.25 9.75L19.5 12m0 0l2.25 2.25M19.5 12l2.25-2.25M19.5 12l-2.25 2.25m-10.5-6l4.72-4.72a.75.75 0 011.28.531V19.94a.75.75 0 01-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.506-1.938-1.354A9.01 9.01 0 012.25 12c0-.83.112-1.633.322-2.395C2.806 8.757 3.63 8.25 4.51 8.25H6.75z"}))}const GM=h.forwardRef(HM),WM=GM;function qM({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 16.875h3.375m0 0h3.375m-3.375 0V13.5m0 3.375v3.375M6 10.5h2.25a2.25 2.25 0 002.25-2.25V6a2.25 2.25 0 00-2.25-2.25H6A2.25 2.25 0 003.75 6v2.25A2.25 2.25 0 006 10.5zm0 9.75h2.25A2.25 2.25 0 0010.5 18v-2.25a2.25 2.25 0 00-2.25-2.25H6a2.25 2.25 0 00-2.25 2.25V18A2.25 2.25 0 006 20.25zm9.75-9.75H18a2.25 2.25 0 002.25-2.25V6A2.25 2.25 0 0018 3.75h-2.25A2.25 2.25 0 0013.5 6v2.25a2.25 2.25 0 002.25 2.25z"}))}const KM=h.forwardRef(qM),wm=KM;function QM({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 7.5A2.25 2.25 0 017.5 5.25h9a2.25 2.25 0 012.25 2.25v9a2.25 2.25 0 01-2.25 2.25h-9a2.25 2.25 0 01-2.25-2.25v-9z"}))}const XM=h.forwardRef(QM),vv=XM;function YM({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"}))}const JM=h.forwardRef(YM),ut=JM;function ZM({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z"}))}const eD=h.forwardRef(ZM),sx=eD;function tD({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"}))}const nD=h.forwardRef(tD),oo=nD,rD=Pu("inline-flex space-x-1 font-semibold items-center ",{variants:{variant:{default:"",circle:"rounded-full",list:"flex items-center py-[5px] w-full",outline:"border rounded-full",primary:""},color:{primary:"bg-[--primary-cl] text-white",clear:""},size:{primary:"px-4 py-1.5",small:"px-2 py-1",half:"w-1/2",full:"w-full",clear:""},rounded:{full:"rounded-full",md:"rounded-md",clear:""},hover:{default:"hover:brightness-90",scale:"transition-transform hover:scale-[1.05]",clear:""}},defaultVariants:{variant:"default",size:"primary",hover:"default",rounded:"full",color:"clear"}});function sD({className:t,children:e,variant:n,size:r,disabled:s,isLoading:i,rounded:o,color:l,hover:c,onClick:u,...d},m){return a.jsxs("button",{ref:m,type:"button",onClick:p=>u?u(p):"",...d,className:`${rD({color:l,variant:n,size:r,hover:c,rounded:o,className:t})}`,disabled:i||s,children:[i?a.jsx(Ie,{className:"w-6 animate-spin"}):null,!i&&e]})}const se=h.forwardRef(sD),dl='border w-full placeholder:[#666] rounded-md outline-none py-1.5 px-2 bg-[--a-5-cl] border-[--a-5-cl] "',iD=Pu("w-full",{variants:{variant:{primary:dl,clear:""},rounded:{xl:"rounded-xl",lg:"rounded-lg",md:"rounded-md"}},defaultVariants:{variant:"primary",rounded:"md"}});function aD({variant:t,className:e="",...n},r){return a.jsx("input",{ref:r,className:` ${iD({variant:t,className:e})}`,...n})}const _n=h.forwardRef(aD);function rT({closeModal:t,cbWhenSubmit:e,title:n,initValue:r="",loading:s,variant:i="input",children:o}){const[l,c]=h.useState(r||""),u=h.useRef(null),d=h.useRef(!1),m=h.useMemo(()=>l.trim()&&l!==r,[l]),p=g=>{g.preventDefault(),m&&(d.current||(d.current=!0,e(l)))};return h.useEffect(()=>{var g;(g=u.current)==null||g.focus()},[]),a.jsxs(ve,{children:[a.jsx(Be,{closeModal:t,title:n}),a.jsxs("form",{action:"",onSubmit:p,children:[i==="input"&&a.jsx("input",{className:dl,ref:u,placeholder:"name...",value:l,onChange:g=>c(g.target.value)}),i==="text-area"&&a.jsx("textarea",{className:dl,value:l,onChange:g=>c(g.target.value)}),o,a.jsx("p",{className:"text-right mt-3",children:a.jsx(se,{type:"submit",variant:"primary",isLoading:s,color:"primary",className:`rounded-full self-end mt-[15px] ${m?"":"disable"}`,children:"Save"})})]})]})}function sT({closeModal:t}){return a.jsxs(ve,{children:[a.jsx(Be,{closeModal:t,title:"HD MP3"}),a.jsxs("p",{children:[a.jsx("span",{className:"font-[500]",children:"Technologies: "})," React, Tailwind Css, Google firebase"]})]})}const ff=[{name:"White",id:"white",type:"light",border:"border-[#198585]",container:"bg-[#fff]"},{name:"Red",id:"red",type:"dark",border:"border-[#ca4954]",container:"bg-[#2e0f10]"},{name:"Black",id:"black",type:"dark",border:"border-[#198585]",container:"bg-[#1e1e1e]"},{name:"Deep blue",id:"deep_blue",type:"dark",border:"border-[#0c9e85]",container:"bg-[#0f1a2e]"},{name:"Light green",id:"light_green",type:"light",border:"border-[#198585]",container:"bg-[#ced9d9]"},{name:"Brown",id:"brown",type:"light",border:"border-[#644646]",container:"bg-white"}],iT=[{name:"Tet",id:"tet",type:"light",container:"bg-[#644646]",border:"bg-[#f7f0de]",image:"tet_theme_image.png"}],oD=()=>{const[t,e]=h.useState(null),[n,r]=h.useState(!0),s=h.useRef(!1);return{user:t,setUser:e,loading:n,setLoading:r,updateUserData:o=>{e(l=>l?{...l,...o}:null)},justRegistered:s}},aT=h.createContext(null);function pe(){const t=h.useContext(aT);if(!t)throw new Error("auth context not Provided");return t}function lD({children:t}){return a.jsx(aT.Provider,{value:oD(),children:t})}const cD=6;function uD(){const[t,e]=h.useState({songs:[],playlists:[]}),[n,r]=h.useState([]),[s,i]=h.useState([]),[o,l]=h.useState([]),[c,u]=h.useState([]),[d,m]=h.useState([]),[p,g]=h.useState([]),[x,w]=h.useState(!0),v=h.useRef(!0),S=h.useRef(!0),_=h.useRef(!0),E=h.useRef(!0),I=h.useRef(!0),N=h.useRef(),F=h.useRef(!1);return{uploadedSongs:s,setUploadedSongs:i,ownPlaylists:c,setOwnPlaylists:u,favoritePlaylists:d,setFavoritePlaylists:m,favoriteSongs:o,setFavoriteSongs:l,sysSongPlaylist:t,setSysSongPlaylist:e,shouldFetchUserSongs:v,shouldFetchFavoriteSongs:S,shouldFetchOwnPlaylists:_,shouldFetchFavoritePlaylists:E,updateSong:C=>{const R=[...s],A=R.findIndex(M=>M.id===C.id);if(A!==-1){const M={...R[A]};Object.assign(M,C.song),R[A]=M,i(R)}},singers:p,setSingers:g,shouldFetchUserSingers:I,lastDoc:N,hasMore:x,setHasMore:w,checkEntireUser:F,genres:n,setGenres:r,resetPage:()=>{v.current=!0,N.current=void 0,w(!0)},PAGE_SIZE:cD}}const oT=h.createContext(null);function dD({children:t}){return a.jsx(oT.Provider,{value:uD(),children:t})}const at=()=>{const t=h.useContext(oT);if(!t)throw new Error("SongContext not provided");return t};function lT(t,e){return function(){return t.apply(e,arguments)}}const{toString:hD}=Object.prototype,{getPrototypeOf:wv}=Object,_m=(t=>e=>{const n=hD.call(e);return t[n]||(t[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),ss=t=>(t=t.toLowerCase(),e=>_m(e)===t),Sm=t=>e=>typeof e===t,{isArray:Pl}=Array,cu=Sm("undefined");function fD(t){return t!==null&&!cu(t)&&t.constructor!==null&&!cu(t.constructor)&&mr(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const cT=ss("ArrayBuffer");function mD(t){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&cT(t.buffer),e}const pD=Sm("string"),mr=Sm("function"),uT=Sm("number"),bm=t=>t!==null&&typeof t=="object",gD=t=>t===!0||t===!1,bh=t=>{if(_m(t)!=="object")return!1;const e=wv(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},xD=ss("Date"),yD=ss("File"),vD=ss("Blob"),wD=ss("FileList"),_D=t=>bm(t)&&mr(t.pipe),SD=t=>{let e;return t&&(typeof FormData=="function"&&t instanceof FormData||mr(t.append)&&((e=_m(t))==="formdata"||e==="object"&&mr(t.toString)&&t.toString()==="[object FormData]"))},bD=ss("URLSearchParams"),[ED,jD,kD,TD]=["ReadableStream","Request","Response","Headers"].map(ss),ID=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Ou(t,e,{allOwnKeys:n=!1}={}){if(t===null||typeof t>"u")return;let r,s;if(typeof t!="object"&&(t=[t]),Pl(t))for(r=0,s=t.length;r<s;r++)e.call(null,t[r],r,t);else{const i=n?Object.getOwnPropertyNames(t):Object.keys(t),o=i.length;let l;for(r=0;r<o;r++)l=i[r],e.call(null,t[l],l,t)}}function dT(t,e){e=e.toLowerCase();const n=Object.keys(t);let r=n.length,s;for(;r-- >0;)if(s=n[r],e===s.toLowerCase())return s;return null}const Ra=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),hT=t=>!cu(t)&&t!==Ra;function ix(){const{caseless:t}=hT(this)&&this||{},e={},n=(r,s)=>{const i=t&&dT(e,s)||s;bh(e[i])&&bh(r)?e[i]=ix(e[i],r):bh(r)?e[i]=ix({},r):Pl(r)?e[i]=r.slice():e[i]=r};for(let r=0,s=arguments.length;r<s;r++)arguments[r]&&Ou(arguments[r],n);return e}const CD=(t,e,n,{allOwnKeys:r}={})=>(Ou(e,(s,i)=>{n&&mr(s)?t[i]=lT(s,n):t[i]=s},{allOwnKeys:r}),t),RD=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),ND=(t,e,n,r)=>{t.prototype=Object.create(e.prototype,r),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),n&&Object.assign(t.prototype,n)},AD=(t,e,n,r)=>{let s,i,o;const l={};if(e=e||{},t==null)return e;do{for(s=Object.getOwnPropertyNames(t),i=s.length;i-- >0;)o=s[i],(!r||r(o,t,e))&&!l[o]&&(e[o]=t[o],l[o]=!0);t=n!==!1&&wv(t)}while(t&&(!n||n(t,e))&&t!==Object.prototype);return e},PD=(t,e,n)=>{t=String(t),(n===void 0||n>t.length)&&(n=t.length),n-=e.length;const r=t.indexOf(e,n);return r!==-1&&r===n},FD=t=>{if(!t)return null;if(Pl(t))return t;let e=t.length;if(!uT(e))return null;const n=new Array(e);for(;e-- >0;)n[e]=t[e];return n},MD=(t=>e=>t&&e instanceof t)(typeof Uint8Array<"u"&&wv(Uint8Array)),DD=(t,e)=>{const r=(t&&t[Symbol.iterator]).call(t);let s;for(;(s=r.next())&&!s.done;){const i=s.value;e.call(t,i[0],i[1])}},LD=(t,e)=>{let n;const r=[];for(;(n=t.exec(e))!==null;)r.push(n);return r},OD=ss("HTMLFormElement"),$D=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,r,s){return r.toUpperCase()+s}),CS=(({hasOwnProperty:t})=>(e,n)=>t.call(e,n))(Object.prototype),zD=ss("RegExp"),fT=(t,e)=>{const n=Object.getOwnPropertyDescriptors(t),r={};Ou(n,(s,i)=>{let o;(o=e(s,i,t))!==!1&&(r[i]=o||s)}),Object.defineProperties(t,r)},BD=t=>{fT(t,(e,n)=>{if(mr(t)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const r=t[n];if(mr(r)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},VD=(t,e)=>{const n={},r=s=>{s.forEach(i=>{n[i]=!0})};return Pl(t)?r(t):r(String(t).split(e)),n},UD=()=>{},HD=(t,e)=>t!=null&&Number.isFinite(t=+t)?t:e;function GD(t){return!!(t&&mr(t.append)&&t[Symbol.toStringTag]==="FormData"&&t[Symbol.iterator])}const WD=t=>{const e=new Array(10),n=(r,s)=>{if(bm(r)){if(e.indexOf(r)>=0)return;if(!("toJSON"in r)){e[s]=r;const i=Pl(r)?[]:{};return Ou(r,(o,l)=>{const c=n(o,s+1);!cu(c)&&(i[l]=c)}),e[s]=void 0,i}}return r};return n(t,0)},qD=ss("AsyncFunction"),KD=t=>t&&(bm(t)||mr(t))&&mr(t.then)&&mr(t.catch),mT=((t,e)=>t?setImmediate:e?((n,r)=>(Ra.addEventListener("message",({source:s,data:i})=>{s===Ra&&i===n&&r.length&&r.shift()()},!1),s=>{r.push(s),Ra.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",mr(Ra.postMessage)),QD=typeof queueMicrotask<"u"?queueMicrotask.bind(Ra):typeof process<"u"&&process.nextTick||mT,O={isArray:Pl,isArrayBuffer:cT,isBuffer:fD,isFormData:SD,isArrayBufferView:mD,isString:pD,isNumber:uT,isBoolean:gD,isObject:bm,isPlainObject:bh,isReadableStream:ED,isRequest:jD,isResponse:kD,isHeaders:TD,isUndefined:cu,isDate:xD,isFile:yD,isBlob:vD,isRegExp:zD,isFunction:mr,isStream:_D,isURLSearchParams:bD,isTypedArray:MD,isFileList:wD,forEach:Ou,merge:ix,extend:CD,trim:ID,stripBOM:RD,inherits:ND,toFlatObject:AD,kindOf:_m,kindOfTest:ss,endsWith:PD,toArray:FD,forEachEntry:DD,matchAll:LD,isHTMLForm:OD,hasOwnProperty:CS,hasOwnProp:CS,reduceDescriptors:fT,freezeMethods:BD,toObjectSet:VD,toCamelCase:$D,noop:UD,toFiniteNumber:HD,findKey:dT,global:Ra,isContextDefined:hT,isSpecCompliantForm:GD,toJSONObject:WD,isAsyncFn:qD,isThenable:KD,setImmediate:mT,asap:QD};function Ee(t,e,n,r,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",e&&(this.code=e),n&&(this.config=n),r&&(this.request=r),s&&(this.response=s,this.status=s.status?s.status:null)}O.inherits(Ee,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:O.toJSONObject(this.config),code:this.code,status:this.status}}});const pT=Ee.prototype,gT={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{gT[t]={value:t}});Object.defineProperties(Ee,gT);Object.defineProperty(pT,"isAxiosError",{value:!0});Ee.from=(t,e,n,r,s,i)=>{const o=Object.create(pT);return O.toFlatObject(t,o,function(c){return c!==Error.prototype},l=>l!=="isAxiosError"),Ee.call(o,t.message,e,n,r,s),o.cause=t,o.name=t.name,i&&Object.assign(o,i),o};const XD=null;function ax(t){return O.isPlainObject(t)||O.isArray(t)}function xT(t){return O.endsWith(t,"[]")?t.slice(0,-2):t}function RS(t,e,n){return t?t.concat(e).map(function(s,i){return s=xT(s),!n&&i?"["+s+"]":s}).join(n?".":""):e}function YD(t){return O.isArray(t)&&!t.some(ax)}const JD=O.toFlatObject(O,{},null,function(e){return/^is[A-Z]/.test(e)});function Em(t,e,n){if(!O.isObject(t))throw new TypeError("target must be an object");e=e||new FormData,n=O.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(w,v){return!O.isUndefined(v[w])});const r=n.metaTokens,s=n.visitor||d,i=n.dots,o=n.indexes,c=(n.Blob||typeof Blob<"u"&&Blob)&&O.isSpecCompliantForm(e);if(!O.isFunction(s))throw new TypeError("visitor must be a function");function u(x){if(x===null)return"";if(O.isDate(x))return x.toISOString();if(!c&&O.isBlob(x))throw new Ee("Blob is not supported. Use a Buffer instead.");return O.isArrayBuffer(x)||O.isTypedArray(x)?c&&typeof Blob=="function"?new Blob([x]):Buffer.from(x):x}function d(x,w,v){let S=x;if(x&&!v&&typeof x=="object"){if(O.endsWith(w,"{}"))w=r?w:w.slice(0,-2),x=JSON.stringify(x);else if(O.isArray(x)&&YD(x)||(O.isFileList(x)||O.endsWith(w,"[]"))&&(S=O.toArray(x)))return w=xT(w),S.forEach(function(E,I){!(O.isUndefined(E)||E===null)&&e.append(o===!0?RS([w],I,i):o===null?w:w+"[]",u(E))}),!1}return ax(x)?!0:(e.append(RS(v,w,i),u(x)),!1)}const m=[],p=Object.assign(JD,{defaultVisitor:d,convertValue:u,isVisitable:ax});function g(x,w){if(!O.isUndefined(x)){if(m.indexOf(x)!==-1)throw Error("Circular reference detected in "+w.join("."));m.push(x),O.forEach(x,function(S,_){(!(O.isUndefined(S)||S===null)&&s.call(e,S,O.isString(_)?_.trim():_,w,p))===!0&&g(S,w?w.concat(_):[_])}),m.pop()}}if(!O.isObject(t))throw new TypeError("data must be an object");return g(t),e}function NS(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(r){return e[r]})}function _v(t,e){this._pairs=[],t&&Em(t,this,e)}const yT=_v.prototype;yT.append=function(e,n){this._pairs.push([e,n])};yT.toString=function(e){const n=e?function(r){return e.call(this,r,NS)}:NS;return this._pairs.map(function(s){return n(s[0])+"="+n(s[1])},"").join("&")};function ZD(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function vT(t,e,n){if(!e)return t;const r=n&&n.encode||ZD;O.isFunction(n)&&(n={serialize:n});const s=n&&n.serialize;let i;if(s?i=s(e,n):i=O.isURLSearchParams(e)?e.toString():new _v(e,n).toString(r),i){const o=t.indexOf("#");o!==-1&&(t=t.slice(0,o)),t+=(t.indexOf("?")===-1?"?":"&")+i}return t}class eL{constructor(){this.handlers=[]}use(e,n,r){return this.handlers.push({fulfilled:e,rejected:n,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){O.forEach(this.handlers,function(r){r!==null&&e(r)})}}const AS=eL,wT={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},tL=typeof URLSearchParams<"u"?URLSearchParams:_v,nL=typeof FormData<"u"?FormData:null,rL=typeof Blob<"u"?Blob:null,sL={isBrowser:!0,classes:{URLSearchParams:tL,FormData:nL,Blob:rL},protocols:["http","https","file","blob","url","data"]},Sv=typeof window<"u"&&typeof document<"u",ox=typeof navigator=="object"&&navigator||void 0,iL=Sv&&(!ox||["ReactNative","NativeScript","NS"].indexOf(ox.product)<0),aL=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),oL=Sv&&window.location.href||"http://localhost",lL=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Sv,hasStandardBrowserEnv:iL,hasStandardBrowserWebWorkerEnv:aL,navigator:ox,origin:oL},Symbol.toStringTag,{value:"Module"})),yn={...lL,...sL};function cL(t,e){return Em(t,new yn.classes.URLSearchParams,Object.assign({visitor:function(n,r,s,i){return yn.isNode&&O.isBuffer(n)?(this.append(r,n.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)}},e))}function uL(t){return O.matchAll(/\w+|\[(\w*)]/g,t).map(e=>e[0]==="[]"?"":e[1]||e[0])}function dL(t){const e={},n=Object.keys(t);let r;const s=n.length;let i;for(r=0;r<s;r++)i=n[r],e[i]=t[i];return e}function _T(t){function e(n,r,s,i){let o=n[i++];if(o==="__proto__")return!0;const l=Number.isFinite(+o),c=i>=n.length;return o=!o&&O.isArray(s)?s.length:o,c?(O.hasOwnProp(s,o)?s[o]=[s[o],r]:s[o]=r,!l):((!s[o]||!O.isObject(s[o]))&&(s[o]=[]),e(n,r,s[o],i)&&O.isArray(s[o])&&(s[o]=dL(s[o])),!l)}if(O.isFormData(t)&&O.isFunction(t.entries)){const n={};return O.forEachEntry(t,(r,s)=>{e(uL(r),s,n,0)}),n}return null}function hL(t,e,n){if(O.isString(t))try{return(e||JSON.parse)(t),O.trim(t)}catch(r){if(r.name!=="SyntaxError")throw r}return(n||JSON.stringify)(t)}const bv={transitional:wT,adapter:["xhr","http","fetch"],transformRequest:[function(e,n){const r=n.getContentType()||"",s=r.indexOf("application/json")>-1,i=O.isObject(e);if(i&&O.isHTMLForm(e)&&(e=new FormData(e)),O.isFormData(e))return s?JSON.stringify(_T(e)):e;if(O.isArrayBuffer(e)||O.isBuffer(e)||O.isStream(e)||O.isFile(e)||O.isBlob(e)||O.isReadableStream(e))return e;if(O.isArrayBufferView(e))return e.buffer;if(O.isURLSearchParams(e))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let l;if(i){if(r.indexOf("application/x-www-form-urlencoded")>-1)return cL(e,this.formSerializer).toString();if((l=O.isFileList(e))||r.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return Em(l?{"files[]":e}:e,c&&new c,this.formSerializer)}}return i||s?(n.setContentType("application/json",!1),hL(e)):e}],transformResponse:[function(e){const n=this.transitional||bv.transitional,r=n&&n.forcedJSONParsing,s=this.responseType==="json";if(O.isResponse(e)||O.isReadableStream(e))return e;if(e&&O.isString(e)&&(r&&!this.responseType||s)){const o=!(n&&n.silentJSONParsing)&&s;try{return JSON.parse(e)}catch(l){if(o)throw l.name==="SyntaxError"?Ee.from(l,Ee.ERR_BAD_RESPONSE,this,null,this.response):l}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:yn.classes.FormData,Blob:yn.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};O.forEach(["delete","get","head","post","put","patch"],t=>{bv.headers[t]={}});const Ev=bv,fL=O.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),mL=t=>{const e={};let n,r,s;return t&&t.split(`
`).forEach(function(o){s=o.indexOf(":"),n=o.substring(0,s).trim().toLowerCase(),r=o.substring(s+1).trim(),!(!n||e[n]&&fL[n])&&(n==="set-cookie"?e[n]?e[n].push(r):e[n]=[r]:e[n]=e[n]?e[n]+", "+r:r)}),e},PS=Symbol("internals");function gc(t){return t&&String(t).trim().toLowerCase()}function Eh(t){return t===!1||t==null?t:O.isArray(t)?t.map(Eh):String(t)}function pL(t){const e=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(t);)e[r[1]]=r[2];return e}const gL=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function vg(t,e,n,r,s){if(O.isFunction(r))return r.call(this,e,n);if(s&&(e=n),!!O.isString(e)){if(O.isString(r))return e.indexOf(r)!==-1;if(O.isRegExp(r))return r.test(e)}}function xL(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,n,r)=>n.toUpperCase()+r)}function yL(t,e){const n=O.toCamelCase(" "+e);["get","set","has"].forEach(r=>{Object.defineProperty(t,r+n,{value:function(s,i,o){return this[r].call(this,e,s,i,o)},configurable:!0})})}class jm{constructor(e){e&&this.set(e)}set(e,n,r){const s=this;function i(l,c,u){const d=gc(c);if(!d)throw new Error("header name must be a non-empty string");const m=O.findKey(s,d);(!m||s[m]===void 0||u===!0||u===void 0&&s[m]!==!1)&&(s[m||c]=Eh(l))}const o=(l,c)=>O.forEach(l,(u,d)=>i(u,d,c));if(O.isPlainObject(e)||e instanceof this.constructor)o(e,n);else if(O.isString(e)&&(e=e.trim())&&!gL(e))o(mL(e),n);else if(O.isHeaders(e))for(const[l,c]of e.entries())i(c,l,r);else e!=null&&i(n,e,r);return this}get(e,n){if(e=gc(e),e){const r=O.findKey(this,e);if(r){const s=this[r];if(!n)return s;if(n===!0)return pL(s);if(O.isFunction(n))return n.call(this,s,r);if(O.isRegExp(n))return n.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,n){if(e=gc(e),e){const r=O.findKey(this,e);return!!(r&&this[r]!==void 0&&(!n||vg(this,this[r],r,n)))}return!1}delete(e,n){const r=this;let s=!1;function i(o){if(o=gc(o),o){const l=O.findKey(r,o);l&&(!n||vg(r,r[l],l,n))&&(delete r[l],s=!0)}}return O.isArray(e)?e.forEach(i):i(e),s}clear(e){const n=Object.keys(this);let r=n.length,s=!1;for(;r--;){const i=n[r];(!e||vg(this,this[i],i,e,!0))&&(delete this[i],s=!0)}return s}normalize(e){const n=this,r={};return O.forEach(this,(s,i)=>{const o=O.findKey(r,i);if(o){n[o]=Eh(s),delete n[i];return}const l=e?xL(i):String(i).trim();l!==i&&delete n[i],n[l]=Eh(s),r[l]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const n=Object.create(null);return O.forEach(this,(r,s)=>{r!=null&&r!==!1&&(n[s]=e&&O.isArray(r)?r.join(", "):r)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,n])=>e+": "+n).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...n){const r=new this(e);return n.forEach(s=>r.set(s)),r}static accessor(e){const r=(this[PS]=this[PS]={accessors:{}}).accessors,s=this.prototype;function i(o){const l=gc(o);r[l]||(yL(s,o),r[l]=!0)}return O.isArray(e)?e.forEach(i):i(e),this}}jm.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);O.reduceDescriptors(jm.prototype,({value:t},e)=>{let n=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(r){this[n]=r}}});O.freezeMethods(jm);const Zr=jm;function wg(t,e){const n=this||Ev,r=e||n,s=Zr.from(r.headers);let i=r.data;return O.forEach(t,function(l){i=l.call(n,i,s.normalize(),e?e.status:void 0)}),s.normalize(),i}function ST(t){return!!(t&&t.__CANCEL__)}function Fl(t,e,n){Ee.call(this,t??"canceled",Ee.ERR_CANCELED,e,n),this.name="CanceledError"}O.inherits(Fl,Ee,{__CANCEL__:!0});function bT(t,e,n){const r=n.config.validateStatus;!n.status||!r||r(n.status)?t(n):e(new Ee("Request failed with status code "+n.status,[Ee.ERR_BAD_REQUEST,Ee.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function vL(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}function wL(t,e){t=t||10;const n=new Array(t),r=new Array(t);let s=0,i=0,o;return e=e!==void 0?e:1e3,function(c){const u=Date.now(),d=r[i];o||(o=u),n[s]=c,r[s]=u;let m=i,p=0;for(;m!==s;)p+=n[m++],m=m%t;if(s=(s+1)%t,s===i&&(i=(i+1)%t),u-o<e)return;const g=d&&u-d;return g?Math.round(p*1e3/g):void 0}}function _L(t,e){let n=0,r=1e3/e,s,i;const o=(u,d=Date.now())=>{n=d,s=null,i&&(clearTimeout(i),i=null),t.apply(null,u)};return[(...u)=>{const d=Date.now(),m=d-n;m>=r?o(u,d):(s=u,i||(i=setTimeout(()=>{i=null,o(s)},r-m)))},()=>s&&o(s)]}const mf=(t,e,n=3)=>{let r=0;const s=wL(50,250);return _L(i=>{const o=i.loaded,l=i.lengthComputable?i.total:void 0,c=o-r,u=s(c),d=o<=l;r=o;const m={loaded:o,total:l,progress:l?o/l:void 0,bytes:c,rate:u||void 0,estimated:u&&l&&d?(l-o)/u:void 0,event:i,lengthComputable:l!=null,[e?"download":"upload"]:!0};t(m)},n)},FS=(t,e)=>{const n=t!=null;return[r=>e[0]({lengthComputable:n,total:t,loaded:r}),e[1]]},MS=t=>(...e)=>O.asap(()=>t(...e)),SL=yn.hasStandardBrowserEnv?((t,e)=>n=>(n=new URL(n,yn.origin),t.protocol===n.protocol&&t.host===n.host&&(e||t.port===n.port)))(new URL(yn.origin),yn.navigator&&/(msie|trident)/i.test(yn.navigator.userAgent)):()=>!0,bL=yn.hasStandardBrowserEnv?{write(t,e,n,r,s,i){const o=[t+"="+encodeURIComponent(e)];O.isNumber(n)&&o.push("expires="+new Date(n).toGMTString()),O.isString(r)&&o.push("path="+r),O.isString(s)&&o.push("domain="+s),i===!0&&o.push("secure"),document.cookie=o.join("; ")},read(t){const e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function EL(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function jL(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}function ET(t,e,n){let r=!EL(e);return t&&r||n==!1?jL(t,e):e}const DS=t=>t instanceof Zr?{...t}:t;function Va(t,e){e=e||{};const n={};function r(u,d,m,p){return O.isPlainObject(u)&&O.isPlainObject(d)?O.merge.call({caseless:p},u,d):O.isPlainObject(d)?O.merge({},d):O.isArray(d)?d.slice():d}function s(u,d,m,p){if(O.isUndefined(d)){if(!O.isUndefined(u))return r(void 0,u,m,p)}else return r(u,d,m,p)}function i(u,d){if(!O.isUndefined(d))return r(void 0,d)}function o(u,d){if(O.isUndefined(d)){if(!O.isUndefined(u))return r(void 0,u)}else return r(void 0,d)}function l(u,d,m){if(m in e)return r(u,d);if(m in t)return r(void 0,u)}const c={url:i,method:i,data:i,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:l,headers:(u,d,m)=>s(DS(u),DS(d),m,!0)};return O.forEach(Object.keys(Object.assign({},t,e)),function(d){const m=c[d]||s,p=m(t[d],e[d],d);O.isUndefined(p)&&m!==l||(n[d]=p)}),n}const jT=t=>{const e=Va({},t);let{data:n,withXSRFToken:r,xsrfHeaderName:s,xsrfCookieName:i,headers:o,auth:l}=e;e.headers=o=Zr.from(o),e.url=vT(ET(e.baseURL,e.url),t.params,t.paramsSerializer),l&&o.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):"")));let c;if(O.isFormData(n)){if(yn.hasStandardBrowserEnv||yn.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((c=o.getContentType())!==!1){const[u,...d]=c?c.split(";").map(m=>m.trim()).filter(Boolean):[];o.setContentType([u||"multipart/form-data",...d].join("; "))}}if(yn.hasStandardBrowserEnv&&(r&&O.isFunction(r)&&(r=r(e)),r||r!==!1&&SL(e.url))){const u=s&&i&&bL.read(i);u&&o.set(s,u)}return e},kL=typeof XMLHttpRequest<"u",TL=kL&&function(t){return new Promise(function(n,r){const s=jT(t);let i=s.data;const o=Zr.from(s.headers).normalize();let{responseType:l,onUploadProgress:c,onDownloadProgress:u}=s,d,m,p,g,x;function w(){g&&g(),x&&x(),s.cancelToken&&s.cancelToken.unsubscribe(d),s.signal&&s.signal.removeEventListener("abort",d)}let v=new XMLHttpRequest;v.open(s.method.toUpperCase(),s.url,!0),v.timeout=s.timeout;function S(){if(!v)return;const E=Zr.from("getAllResponseHeaders"in v&&v.getAllResponseHeaders()),N={data:!l||l==="text"||l==="json"?v.responseText:v.response,status:v.status,statusText:v.statusText,headers:E,config:t,request:v};bT(function(k){n(k),w()},function(k){r(k),w()},N),v=null}"onloadend"in v?v.onloadend=S:v.onreadystatechange=function(){!v||v.readyState!==4||v.status===0&&!(v.responseURL&&v.responseURL.indexOf("file:")===0)||setTimeout(S)},v.onabort=function(){v&&(r(new Ee("Request aborted",Ee.ECONNABORTED,t,v)),v=null)},v.onerror=function(){r(new Ee("Network Error",Ee.ERR_NETWORK,t,v)),v=null},v.ontimeout=function(){let I=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const N=s.transitional||wT;s.timeoutErrorMessage&&(I=s.timeoutErrorMessage),r(new Ee(I,N.clarifyTimeoutError?Ee.ETIMEDOUT:Ee.ECONNABORTED,t,v)),v=null},i===void 0&&o.setContentType(null),"setRequestHeader"in v&&O.forEach(o.toJSON(),function(I,N){v.setRequestHeader(N,I)}),O.isUndefined(s.withCredentials)||(v.withCredentials=!!s.withCredentials),l&&l!=="json"&&(v.responseType=s.responseType),u&&([p,x]=mf(u,!0),v.addEventListener("progress",p)),c&&v.upload&&([m,g]=mf(c),v.upload.addEventListener("progress",m),v.upload.addEventListener("loadend",g)),(s.cancelToken||s.signal)&&(d=E=>{v&&(r(!E||E.type?new Fl(null,t,v):E),v.abort(),v=null)},s.cancelToken&&s.cancelToken.subscribe(d),s.signal&&(s.signal.aborted?d():s.signal.addEventListener("abort",d)));const _=vL(s.url);if(_&&yn.protocols.indexOf(_)===-1){r(new Ee("Unsupported protocol "+_+":",Ee.ERR_BAD_REQUEST,t));return}v.send(i||null)})},IL=(t,e)=>{const{length:n}=t=t?t.filter(Boolean):[];if(e||n){let r=new AbortController,s;const i=function(u){if(!s){s=!0,l();const d=u instanceof Error?u:this.reason;r.abort(d instanceof Ee?d:new Fl(d instanceof Error?d.message:d))}};let o=e&&setTimeout(()=>{o=null,i(new Ee(`timeout ${e} of ms exceeded`,Ee.ETIMEDOUT))},e);const l=()=>{t&&(o&&clearTimeout(o),o=null,t.forEach(u=>{u.unsubscribe?u.unsubscribe(i):u.removeEventListener("abort",i)}),t=null)};t.forEach(u=>u.addEventListener("abort",i));const{signal:c}=r;return c.unsubscribe=()=>O.asap(l),c}},CL=IL,RL=function*(t,e){let n=t.byteLength;if(!e||n<e){yield t;return}let r=0,s;for(;r<n;)s=r+e,yield t.slice(r,s),r=s},NL=async function*(t,e){for await(const n of AL(t))yield*RL(n,e)},AL=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const e=t.getReader();try{for(;;){const{done:n,value:r}=await e.read();if(n)break;yield r}}finally{await e.cancel()}},LS=(t,e,n,r)=>{const s=NL(t,e);let i=0,o,l=c=>{o||(o=!0,r&&r(c))};return new ReadableStream({async pull(c){try{const{done:u,value:d}=await s.next();if(u){l(),c.close();return}let m=d.byteLength;if(n){let p=i+=m;n(p)}c.enqueue(new Uint8Array(d))}catch(u){throw l(u),u}},cancel(c){return l(c),s.return()}},{highWaterMark:2})},km=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",kT=km&&typeof ReadableStream=="function",PL=km&&(typeof TextEncoder=="function"?(t=>e=>t.encode(e))(new TextEncoder):async t=>new Uint8Array(await new Response(t).arrayBuffer())),TT=(t,...e)=>{try{return!!t(...e)}catch{return!1}},FL=kT&&TT(()=>{let t=!1;const e=new Request(yn.origin,{body:new ReadableStream,method:"POST",get duplex(){return t=!0,"half"}}).headers.has("Content-Type");return t&&!e}),OS=64*1024,lx=kT&&TT(()=>O.isReadableStream(new Response("").body)),pf={stream:lx&&(t=>t.body)};km&&(t=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!pf[e]&&(pf[e]=O.isFunction(t[e])?n=>n[e]():(n,r)=>{throw new Ee(`Response type '${e}' is not supported`,Ee.ERR_NOT_SUPPORT,r)})})})(new Response);const ML=async t=>{if(t==null)return 0;if(O.isBlob(t))return t.size;if(O.isSpecCompliantForm(t))return(await new Request(yn.origin,{method:"POST",body:t}).arrayBuffer()).byteLength;if(O.isArrayBufferView(t)||O.isArrayBuffer(t))return t.byteLength;if(O.isURLSearchParams(t)&&(t=t+""),O.isString(t))return(await PL(t)).byteLength},DL=async(t,e)=>{const n=O.toFiniteNumber(t.getContentLength());return n??ML(e)},LL=km&&(async t=>{let{url:e,method:n,data:r,signal:s,cancelToken:i,timeout:o,onDownloadProgress:l,onUploadProgress:c,responseType:u,headers:d,withCredentials:m="same-origin",fetchOptions:p}=jT(t);u=u?(u+"").toLowerCase():"text";let g=CL([s,i&&i.toAbortSignal()],o),x;const w=g&&g.unsubscribe&&(()=>{g.unsubscribe()});let v;try{if(c&&FL&&n!=="get"&&n!=="head"&&(v=await DL(d,r))!==0){let N=new Request(e,{method:"POST",body:r,duplex:"half"}),F;if(O.isFormData(r)&&(F=N.headers.get("content-type"))&&d.setContentType(F),N.body){const[k,j]=FS(v,mf(MS(c)));r=LS(N.body,OS,k,j)}}O.isString(m)||(m=m?"include":"omit");const S="credentials"in Request.prototype;x=new Request(e,{...p,signal:g,method:n.toUpperCase(),headers:d.normalize().toJSON(),body:r,duplex:"half",credentials:S?m:void 0});let _=await fetch(x);const E=lx&&(u==="stream"||u==="response");if(lx&&(l||E&&w)){const N={};["status","statusText","headers"].forEach(C=>{N[C]=_[C]});const F=O.toFiniteNumber(_.headers.get("content-length")),[k,j]=l&&FS(F,mf(MS(l),!0))||[];_=new Response(LS(_.body,OS,k,()=>{j&&j(),w&&w()}),N)}u=u||"text";let I=await pf[O.findKey(pf,u)||"text"](_,t);return!E&&w&&w(),await new Promise((N,F)=>{bT(N,F,{data:I,headers:Zr.from(_.headers),status:_.status,statusText:_.statusText,config:t,request:x})})}catch(S){throw w&&w(),S&&S.name==="TypeError"&&/fetch/i.test(S.message)?Object.assign(new Ee("Network Error",Ee.ERR_NETWORK,t,x),{cause:S.cause||S}):Ee.from(S,S&&S.code,t,x)}}),cx={http:XD,xhr:TL,fetch:LL};O.forEach(cx,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch{}Object.defineProperty(t,"adapterName",{value:e})}});const $S=t=>`- ${t}`,OL=t=>O.isFunction(t)||t===null||t===!1,IT={getAdapter:t=>{t=O.isArray(t)?t:[t];const{length:e}=t;let n,r;const s={};for(let i=0;i<e;i++){n=t[i];let o;if(r=n,!OL(n)&&(r=cx[(o=String(n)).toLowerCase()],r===void 0))throw new Ee(`Unknown adapter '${o}'`);if(r)break;s[o||"#"+i]=r}if(!r){const i=Object.entries(s).map(([l,c])=>`adapter ${l} `+(c===!1?"is not supported by the environment":"is not available in the build"));let o=e?i.length>1?`since :
`+i.map($S).join(`
`):" "+$S(i[0]):"as no adapter specified";throw new Ee("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return r},adapters:cx};function _g(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new Fl(null,t)}function zS(t){return _g(t),t.headers=Zr.from(t.headers),t.data=wg.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),IT.getAdapter(t.adapter||Ev.adapter)(t).then(function(r){return _g(t),r.data=wg.call(t,t.transformResponse,r),r.headers=Zr.from(r.headers),r},function(r){return ST(r)||(_g(t),r&&r.response&&(r.response.data=wg.call(t,t.transformResponse,r.response),r.response.headers=Zr.from(r.response.headers))),Promise.reject(r)})}const CT="1.8.1",Tm={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{Tm[t]=function(r){return typeof r===t||"a"+(e<1?"n ":" ")+t}});const BS={};Tm.transitional=function(e,n,r){function s(i,o){return"[Axios v"+CT+"] Transitional option '"+i+"'"+o+(r?". "+r:"")}return(i,o,l)=>{if(e===!1)throw new Ee(s(o," has been removed"+(n?" in "+n:"")),Ee.ERR_DEPRECATED);return n&&!BS[o]&&(BS[o]=!0,console.warn(s(o," has been deprecated since v"+n+" and will be removed in the near future"))),e?e(i,o,l):!0}};Tm.spelling=function(e){return(n,r)=>(console.warn(`${r} is likely a misspelling of ${e}`),!0)};function $L(t,e,n){if(typeof t!="object")throw new Ee("options must be an object",Ee.ERR_BAD_OPTION_VALUE);const r=Object.keys(t);let s=r.length;for(;s-- >0;){const i=r[s],o=e[i];if(o){const l=t[i],c=l===void 0||o(l,i,t);if(c!==!0)throw new Ee("option "+i+" must be "+c,Ee.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new Ee("Unknown option "+i,Ee.ERR_BAD_OPTION)}}const jh={assertOptions:$L,validators:Tm},ds=jh.validators;class gf{constructor(e){this.defaults=e,this.interceptors={request:new AS,response:new AS}}async request(e,n){try{return await this._request(e,n)}catch(r){if(r instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const i=s.stack?s.stack.replace(/^.+\n/,""):"";try{r.stack?i&&!String(r.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+i):r.stack=i}catch{}}throw r}}_request(e,n){typeof e=="string"?(n=n||{},n.url=e):n=e||{},n=Va(this.defaults,n);const{transitional:r,paramsSerializer:s,headers:i}=n;r!==void 0&&jh.assertOptions(r,{silentJSONParsing:ds.transitional(ds.boolean),forcedJSONParsing:ds.transitional(ds.boolean),clarifyTimeoutError:ds.transitional(ds.boolean)},!1),s!=null&&(O.isFunction(s)?n.paramsSerializer={serialize:s}:jh.assertOptions(s,{encode:ds.function,serialize:ds.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),jh.assertOptions(n,{baseUrl:ds.spelling("baseURL"),withXsrfToken:ds.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let o=i&&O.merge(i.common,i[n.method]);i&&O.forEach(["delete","get","head","post","put","patch","common"],x=>{delete i[x]}),n.headers=Zr.concat(o,i);const l=[];let c=!0;this.interceptors.request.forEach(function(w){typeof w.runWhen=="function"&&w.runWhen(n)===!1||(c=c&&w.synchronous,l.unshift(w.fulfilled,w.rejected))});const u=[];this.interceptors.response.forEach(function(w){u.push(w.fulfilled,w.rejected)});let d,m=0,p;if(!c){const x=[zS.bind(this),void 0];for(x.unshift.apply(x,l),x.push.apply(x,u),p=x.length,d=Promise.resolve(n);m<p;)d=d.then(x[m++],x[m++]);return d}p=l.length;let g=n;for(m=0;m<p;){const x=l[m++],w=l[m++];try{g=x(g)}catch(v){w.call(this,v);break}}try{d=zS.call(this,g)}catch(x){return Promise.reject(x)}for(m=0,p=u.length;m<p;)d=d.then(u[m++],u[m++]);return d}getUri(e){e=Va(this.defaults,e);const n=ET(e.baseURL,e.url,e.allowAbsoluteUrls);return vT(n,e.params,e.paramsSerializer)}}O.forEach(["delete","get","head","options"],function(e){gf.prototype[e]=function(n,r){return this.request(Va(r||{},{method:e,url:n,data:(r||{}).data}))}});O.forEach(["post","put","patch"],function(e){function n(r){return function(i,o,l){return this.request(Va(l||{},{method:e,headers:r?{"Content-Type":"multipart/form-data"}:{},url:i,data:o}))}}gf.prototype[e]=n(),gf.prototype[e+"Form"]=n(!0)});const kh=gf;class jv{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(i){n=i});const r=this;this.promise.then(s=>{if(!r._listeners)return;let i=r._listeners.length;for(;i-- >0;)r._listeners[i](s);r._listeners=null}),this.promise.then=s=>{let i;const o=new Promise(l=>{r.subscribe(l),i=l}).then(s);return o.cancel=function(){r.unsubscribe(i)},o},e(function(i,o,l){r.reason||(r.reason=new Fl(i,o,l),n(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const n=this._listeners.indexOf(e);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const e=new AbortController,n=r=>{e.abort(r)};return this.subscribe(n),e.signal.unsubscribe=()=>this.unsubscribe(n),e.signal}static source(){let e;return{token:new jv(function(s){e=s}),cancel:e}}}const zL=jv;function BL(t){return function(n){return t.apply(null,n)}}function VL(t){return O.isObject(t)&&t.isAxiosError===!0}const ux={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(ux).forEach(([t,e])=>{ux[e]=t});const UL=ux;function RT(t){const e=new kh(t),n=lT(kh.prototype.request,e);return O.extend(n,kh.prototype,e,{allOwnKeys:!0}),O.extend(n,e,null,{allOwnKeys:!0}),n.create=function(s){return RT(Va(t,s))},n}const Ct=RT(Ev);Ct.Axios=kh;Ct.CanceledError=Fl;Ct.CancelToken=zL;Ct.isCancel=ST;Ct.VERSION=CT;Ct.toFormData=Em;Ct.AxiosError=Ee;Ct.Cancel=Ct.CanceledError;Ct.all=function(e){return Promise.all(e)};Ct.spread=BL;Ct.isAxiosError=VL;Ct.mergeConfig=Va;Ct.AxiosHeaders=Zr;Ct.formToJSON=t=>_T(O.isHTMLForm(t)?new FormData(t):t);Ct.getAdapter=IT.getAdapter;Ct.HttpStatusCode=UL;Ct.default=Ct;const HL=Ct;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NT=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},GL=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],l=t[n++],c=((s&7)<<18|(i&63)<<12|(o&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},AT={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,l=o?t[s+1]:0,c=s+2<t.length,u=c?t[s+2]:0,d=i>>2,m=(i&3)<<4|l>>4;let p=(l&15)<<2|u>>6,g=u&63;c||(g=64,o||(p=64)),r.push(n[d],n[m],n[p],n[g])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(NT(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):GL(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],l=s<t.length?n[t.charAt(s)]:0;++s;const u=s<t.length?n[t.charAt(s)]:64;++s;const m=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||l==null||u==null||m==null)throw new WL;const p=i<<2|l>>4;if(r.push(p),u!==64){const g=l<<4&240|u>>2;if(r.push(g),m!==64){const x=u<<6&192|m;r.push(x)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class WL extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const qL=function(t){const e=NT(t);return AT.encodeByteArray(e,!0)},xf=function(t){return qL(t).replace(/\./g,"")},PT=function(t){try{return AT.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KL(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QL=()=>KL().__FIREBASE_DEFAULTS__,XL=()=>{if(typeof process>"u"||typeof process.env>"u")return;const t={}.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},YL=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&PT(t[1]);return e&&JSON.parse(e)},Im=()=>{try{return QL()||XL()||YL()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},FT=t=>{var e,n;return(n=(e=Im())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},JL=t=>{const e=FT(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},MT=()=>{var t;return(t=Im())===null||t===void 0?void 0:t.config},DT=t=>{var e;return(e=Im())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZL{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e6(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t),l="";return[xf(JSON.stringify(n)),xf(JSON.stringify(o)),l].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function t6(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Sn())}function n6(){var t;const e=(t=Im())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function r6(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function s6(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function i6(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function a6(){const t=Sn();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function o6(){return!n6()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function l6(){try{return typeof indexedDB=="object"}catch{return!1}}function c6(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u6="FirebaseError";class di extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=u6,Object.setPrototypeOf(this,di.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,$u.prototype.create)}}class $u{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?d6(i,r):"Error",l=`${this.serviceName}: ${o} (${s}).`;return new di(s,l,r)}}function d6(t,e){return t.replace(h6,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const h6=/\{\$([^}]+)}/g;function f6(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function yf(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(VS(i)&&VS(o)){if(!yf(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function VS(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zu(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function m6(t,e){const n=new p6(t,e);return n.subscribe.bind(n)}class p6{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");g6(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=Sg),s.error===void 0&&(s.error=Sg),s.complete===void 0&&(s.complete=Sg);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function g6(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Sg(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rt(t){return t&&t._delegate?t._delegate:t}class Ua{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ba="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let x6=class{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new ZL;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(v6(e))try{this.getOrInitializeService({instanceIdentifier:ba})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=ba){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ba){return this.instances.has(e)}getOptions(e=ba){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);r===l&&o.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:y6(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=ba){return this.component?this.component.multipleInstances?e:ba:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function y6(t){return t===ba?void 0:t}function v6(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w6{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new x6(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Fe;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Fe||(Fe={}));const _6={debug:Fe.DEBUG,verbose:Fe.VERBOSE,info:Fe.INFO,warn:Fe.WARN,error:Fe.ERROR,silent:Fe.SILENT},S6=Fe.INFO,b6={[Fe.DEBUG]:"log",[Fe.VERBOSE]:"log",[Fe.INFO]:"info",[Fe.WARN]:"warn",[Fe.ERROR]:"error"},E6=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=b6[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class kv{constructor(e){this.name=e,this._logLevel=S6,this._logHandler=E6,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Fe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?_6[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Fe.DEBUG,...e),this._logHandler(this,Fe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Fe.VERBOSE,...e),this._logHandler(this,Fe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Fe.INFO,...e),this._logHandler(this,Fe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Fe.WARN,...e),this._logHandler(this,Fe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Fe.ERROR,...e),this._logHandler(this,Fe.ERROR,...e)}}const j6=(t,e)=>e.some(n=>t instanceof n);let US,HS;function k6(){return US||(US=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function T6(){return HS||(HS=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const LT=new WeakMap,dx=new WeakMap,OT=new WeakMap,bg=new WeakMap,Tv=new WeakMap;function I6(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(Gi(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&LT.set(n,t)}).catch(()=>{}),Tv.set(e,t),e}function C6(t){if(dx.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});dx.set(t,e)}let hx={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return dx.get(t);if(e==="objectStoreNames")return t.objectStoreNames||OT.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Gi(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function R6(t){hx=t(hx)}function N6(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Eg(this),e,...n);return OT.set(r,e.sort?e.sort():[e]),Gi(r)}:T6().includes(t)?function(...e){return t.apply(Eg(this),e),Gi(LT.get(this))}:function(...e){return Gi(t.apply(Eg(this),e))}}function A6(t){return typeof t=="function"?N6(t):(t instanceof IDBTransaction&&C6(t),j6(t,k6())?new Proxy(t,hx):t)}function Gi(t){if(t instanceof IDBRequest)return I6(t);if(bg.has(t))return bg.get(t);const e=A6(t);return e!==t&&(bg.set(t,e),Tv.set(e,t)),e}const Eg=t=>Tv.get(t);function P6(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),l=Gi(o);return r&&o.addEventListener("upgradeneeded",c=>{r(Gi(o.result),c.oldVersion,c.newVersion,Gi(o.transaction),c)}),n&&o.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),l.then(c=>{i&&c.addEventListener("close",()=>i()),s&&c.addEventListener("versionchange",u=>s(u.oldVersion,u.newVersion,u))}).catch(()=>{}),l}const F6=["get","getKey","getAll","getAllKeys","count"],M6=["put","add","delete","clear"],jg=new Map;function GS(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(jg.get(e))return jg.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=M6.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||F6.includes(n)))return;const i=async function(o,...l){const c=this.transaction(o,s?"readwrite":"readonly");let u=c.store;return r&&(u=u.index(l.shift())),(await Promise.all([u[n](...l),s&&c.done]))[0]};return jg.set(e,i),i}R6(t=>({...t,get:(e,n,r)=>GS(e,n)||t.get(e,n,r),has:(e,n)=>!!GS(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D6{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(L6(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function L6(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const fx="@firebase/app",WS="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ni=new kv("@firebase/app"),O6="@firebase/app-compat",$6="@firebase/analytics-compat",z6="@firebase/analytics",B6="@firebase/app-check-compat",V6="@firebase/app-check",U6="@firebase/auth",H6="@firebase/auth-compat",G6="@firebase/database",W6="@firebase/data-connect",q6="@firebase/database-compat",K6="@firebase/functions",Q6="@firebase/functions-compat",X6="@firebase/installations",Y6="@firebase/installations-compat",J6="@firebase/messaging",Z6="@firebase/messaging-compat",eO="@firebase/performance",tO="@firebase/performance-compat",nO="@firebase/remote-config",rO="@firebase/remote-config-compat",sO="@firebase/storage",iO="@firebase/storage-compat",aO="@firebase/firestore",oO="@firebase/vertexai-preview",lO="@firebase/firestore-compat",cO="firebase",uO="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mx="[DEFAULT]",dO={[fx]:"fire-core",[O6]:"fire-core-compat",[z6]:"fire-analytics",[$6]:"fire-analytics-compat",[V6]:"fire-app-check",[B6]:"fire-app-check-compat",[U6]:"fire-auth",[H6]:"fire-auth-compat",[G6]:"fire-rtdb",[W6]:"fire-data-connect",[q6]:"fire-rtdb-compat",[K6]:"fire-fn",[Q6]:"fire-fn-compat",[X6]:"fire-iid",[Y6]:"fire-iid-compat",[J6]:"fire-fcm",[Z6]:"fire-fcm-compat",[eO]:"fire-perf",[tO]:"fire-perf-compat",[nO]:"fire-rc",[rO]:"fire-rc-compat",[sO]:"fire-gcs",[iO]:"fire-gcs-compat",[aO]:"fire-fst",[lO]:"fire-fst-compat",[oO]:"fire-vertex","fire-js":"fire-js",[cO]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vf=new Map,hO=new Map,px=new Map;function qS(t,e){try{t.container.addComponent(e)}catch(n){ni.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function hl(t){const e=t.name;if(px.has(e))return ni.debug(`There were multiple attempts to register component ${e}.`),!1;px.set(e,t);for(const n of vf.values())qS(n,t);for(const n of hO.values())qS(n,t);return!0}function Iv(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Vs(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fO={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Wi=new $u("app","Firebase",fO);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mO{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Ua("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Wi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ml=uO;function $T(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:mx,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw Wi.create("bad-app-name",{appName:String(s)});if(n||(n=MT()),!n)throw Wi.create("no-options");const i=vf.get(s);if(i){if(yf(n,i.options)&&yf(r,i.config))return i;throw Wi.create("duplicate-app",{appName:s})}const o=new w6(s);for(const c of px.values())o.addComponent(c);const l=new mO(n,r,o);return vf.set(s,l),l}function zT(t=mx){const e=vf.get(t);if(!e&&t===mx&&MT())return $T();if(!e)throw Wi.create("no-app",{appName:t});return e}function qi(t,e,n){var r;let s=(r=dO[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const l=[`Unable to register library "${s}" with version "${e}":`];i&&l.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ni.warn(l.join(" "));return}hl(new Ua(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pO="firebase-heartbeat-database",gO=1,uu="firebase-heartbeat-store";let kg=null;function BT(){return kg||(kg=P6(pO,gO,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(uu)}catch(n){console.warn(n)}}}}).catch(t=>{throw Wi.create("idb-open",{originalErrorMessage:t.message})})),kg}async function xO(t){try{const n=(await BT()).transaction(uu),r=await n.objectStore(uu).get(VT(t));return await n.done,r}catch(e){if(e instanceof di)ni.warn(e.message);else{const n=Wi.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});ni.warn(n.message)}}}async function KS(t,e){try{const r=(await BT()).transaction(uu,"readwrite");await r.objectStore(uu).put(e,VT(t)),await r.done}catch(n){if(n instanceof di)ni.warn(n.message);else{const r=Wi.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});ni.warn(r.message)}}}function VT(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yO=1024,vO=30*24*60*60*1e3;class wO{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new SO(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=QS();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const l=new Date(o.date).valueOf();return Date.now()-l<=vO}),this._storage.overwrite(this._heartbeatsCache))}catch(r){ni.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=QS(),{heartbeatsToSend:r,unsentEntries:s}=_O(this._heartbeatsCache.heartbeats),i=xf(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return ni.warn(n),""}}}function QS(){return new Date().toISOString().substring(0,10)}function _O(t,e=yO){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),XS(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),XS(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class SO{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return l6()?c6().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await xO(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return KS(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return KS(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function XS(t){return xf(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bO(t){hl(new Ua("platform-logger",e=>new D6(e),"PRIVATE")),hl(new Ua("heartbeat",e=>new wO(e),"PRIVATE")),qi(fx,WS,t),qi(fx,WS,"esm2017"),qi("fire-js","")}bO("");var YS=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ma,UT;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(k,j){function C(){}C.prototype=j.prototype,k.D=j.prototype,k.prototype=new C,k.prototype.constructor=k,k.C=function(R,A,M){for(var P=Array(arguments.length-2),we=2;we<arguments.length;we++)P[we-2]=arguments[we];return j.prototype[A].apply(R,P)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(k,j,C){C||(C=0);var R=Array(16);if(typeof j=="string")for(var A=0;16>A;++A)R[A]=j.charCodeAt(C++)|j.charCodeAt(C++)<<8|j.charCodeAt(C++)<<16|j.charCodeAt(C++)<<24;else for(A=0;16>A;++A)R[A]=j[C++]|j[C++]<<8|j[C++]<<16|j[C++]<<24;j=k.g[0],C=k.g[1],A=k.g[2];var M=k.g[3],P=j+(M^C&(A^M))+R[0]+3614090360&4294967295;j=C+(P<<7&4294967295|P>>>25),P=M+(A^j&(C^A))+R[1]+3905402710&4294967295,M=j+(P<<12&4294967295|P>>>20),P=A+(C^M&(j^C))+R[2]+606105819&4294967295,A=M+(P<<17&4294967295|P>>>15),P=C+(j^A&(M^j))+R[3]+3250441966&4294967295,C=A+(P<<22&4294967295|P>>>10),P=j+(M^C&(A^M))+R[4]+4118548399&4294967295,j=C+(P<<7&4294967295|P>>>25),P=M+(A^j&(C^A))+R[5]+1200080426&4294967295,M=j+(P<<12&4294967295|P>>>20),P=A+(C^M&(j^C))+R[6]+2821735955&4294967295,A=M+(P<<17&4294967295|P>>>15),P=C+(j^A&(M^j))+R[7]+4249261313&4294967295,C=A+(P<<22&4294967295|P>>>10),P=j+(M^C&(A^M))+R[8]+1770035416&4294967295,j=C+(P<<7&4294967295|P>>>25),P=M+(A^j&(C^A))+R[9]+2336552879&4294967295,M=j+(P<<12&4294967295|P>>>20),P=A+(C^M&(j^C))+R[10]+4294925233&4294967295,A=M+(P<<17&4294967295|P>>>15),P=C+(j^A&(M^j))+R[11]+2304563134&4294967295,C=A+(P<<22&4294967295|P>>>10),P=j+(M^C&(A^M))+R[12]+1804603682&4294967295,j=C+(P<<7&4294967295|P>>>25),P=M+(A^j&(C^A))+R[13]+4254626195&4294967295,M=j+(P<<12&4294967295|P>>>20),P=A+(C^M&(j^C))+R[14]+2792965006&4294967295,A=M+(P<<17&4294967295|P>>>15),P=C+(j^A&(M^j))+R[15]+1236535329&4294967295,C=A+(P<<22&4294967295|P>>>10),P=j+(A^M&(C^A))+R[1]+4129170786&4294967295,j=C+(P<<5&4294967295|P>>>27),P=M+(C^A&(j^C))+R[6]+3225465664&4294967295,M=j+(P<<9&4294967295|P>>>23),P=A+(j^C&(M^j))+R[11]+643717713&4294967295,A=M+(P<<14&4294967295|P>>>18),P=C+(M^j&(A^M))+R[0]+3921069994&4294967295,C=A+(P<<20&4294967295|P>>>12),P=j+(A^M&(C^A))+R[5]+3593408605&4294967295,j=C+(P<<5&4294967295|P>>>27),P=M+(C^A&(j^C))+R[10]+38016083&4294967295,M=j+(P<<9&4294967295|P>>>23),P=A+(j^C&(M^j))+R[15]+3634488961&4294967295,A=M+(P<<14&4294967295|P>>>18),P=C+(M^j&(A^M))+R[4]+3889429448&4294967295,C=A+(P<<20&4294967295|P>>>12),P=j+(A^M&(C^A))+R[9]+568446438&4294967295,j=C+(P<<5&4294967295|P>>>27),P=M+(C^A&(j^C))+R[14]+3275163606&4294967295,M=j+(P<<9&4294967295|P>>>23),P=A+(j^C&(M^j))+R[3]+4107603335&4294967295,A=M+(P<<14&4294967295|P>>>18),P=C+(M^j&(A^M))+R[8]+1163531501&4294967295,C=A+(P<<20&4294967295|P>>>12),P=j+(A^M&(C^A))+R[13]+2850285829&4294967295,j=C+(P<<5&4294967295|P>>>27),P=M+(C^A&(j^C))+R[2]+4243563512&4294967295,M=j+(P<<9&4294967295|P>>>23),P=A+(j^C&(M^j))+R[7]+1735328473&4294967295,A=M+(P<<14&4294967295|P>>>18),P=C+(M^j&(A^M))+R[12]+2368359562&4294967295,C=A+(P<<20&4294967295|P>>>12),P=j+(C^A^M)+R[5]+4294588738&4294967295,j=C+(P<<4&4294967295|P>>>28),P=M+(j^C^A)+R[8]+2272392833&4294967295,M=j+(P<<11&4294967295|P>>>21),P=A+(M^j^C)+R[11]+1839030562&4294967295,A=M+(P<<16&4294967295|P>>>16),P=C+(A^M^j)+R[14]+4259657740&4294967295,C=A+(P<<23&4294967295|P>>>9),P=j+(C^A^M)+R[1]+2763975236&4294967295,j=C+(P<<4&4294967295|P>>>28),P=M+(j^C^A)+R[4]+1272893353&4294967295,M=j+(P<<11&4294967295|P>>>21),P=A+(M^j^C)+R[7]+4139469664&4294967295,A=M+(P<<16&4294967295|P>>>16),P=C+(A^M^j)+R[10]+3200236656&4294967295,C=A+(P<<23&4294967295|P>>>9),P=j+(C^A^M)+R[13]+681279174&4294967295,j=C+(P<<4&4294967295|P>>>28),P=M+(j^C^A)+R[0]+3936430074&4294967295,M=j+(P<<11&4294967295|P>>>21),P=A+(M^j^C)+R[3]+3572445317&4294967295,A=M+(P<<16&4294967295|P>>>16),P=C+(A^M^j)+R[6]+76029189&4294967295,C=A+(P<<23&4294967295|P>>>9),P=j+(C^A^M)+R[9]+3654602809&4294967295,j=C+(P<<4&4294967295|P>>>28),P=M+(j^C^A)+R[12]+3873151461&4294967295,M=j+(P<<11&4294967295|P>>>21),P=A+(M^j^C)+R[15]+530742520&4294967295,A=M+(P<<16&4294967295|P>>>16),P=C+(A^M^j)+R[2]+3299628645&4294967295,C=A+(P<<23&4294967295|P>>>9),P=j+(A^(C|~M))+R[0]+4096336452&4294967295,j=C+(P<<6&4294967295|P>>>26),P=M+(C^(j|~A))+R[7]+1126891415&4294967295,M=j+(P<<10&4294967295|P>>>22),P=A+(j^(M|~C))+R[14]+2878612391&4294967295,A=M+(P<<15&4294967295|P>>>17),P=C+(M^(A|~j))+R[5]+4237533241&4294967295,C=A+(P<<21&4294967295|P>>>11),P=j+(A^(C|~M))+R[12]+1700485571&4294967295,j=C+(P<<6&4294967295|P>>>26),P=M+(C^(j|~A))+R[3]+2399980690&4294967295,M=j+(P<<10&4294967295|P>>>22),P=A+(j^(M|~C))+R[10]+4293915773&4294967295,A=M+(P<<15&4294967295|P>>>17),P=C+(M^(A|~j))+R[1]+2240044497&4294967295,C=A+(P<<21&4294967295|P>>>11),P=j+(A^(C|~M))+R[8]+1873313359&4294967295,j=C+(P<<6&4294967295|P>>>26),P=M+(C^(j|~A))+R[15]+4264355552&4294967295,M=j+(P<<10&4294967295|P>>>22),P=A+(j^(M|~C))+R[6]+2734768916&4294967295,A=M+(P<<15&4294967295|P>>>17),P=C+(M^(A|~j))+R[13]+1309151649&4294967295,C=A+(P<<21&4294967295|P>>>11),P=j+(A^(C|~M))+R[4]+4149444226&4294967295,j=C+(P<<6&4294967295|P>>>26),P=M+(C^(j|~A))+R[11]+3174756917&4294967295,M=j+(P<<10&4294967295|P>>>22),P=A+(j^(M|~C))+R[2]+718787259&4294967295,A=M+(P<<15&4294967295|P>>>17),P=C+(M^(A|~j))+R[9]+3951481745&4294967295,k.g[0]=k.g[0]+j&4294967295,k.g[1]=k.g[1]+(A+(P<<21&4294967295|P>>>11))&4294967295,k.g[2]=k.g[2]+A&4294967295,k.g[3]=k.g[3]+M&4294967295}r.prototype.u=function(k,j){j===void 0&&(j=k.length);for(var C=j-this.blockSize,R=this.B,A=this.h,M=0;M<j;){if(A==0)for(;M<=C;)s(this,k,M),M+=this.blockSize;if(typeof k=="string"){for(;M<j;)if(R[A++]=k.charCodeAt(M++),A==this.blockSize){s(this,R),A=0;break}}else for(;M<j;)if(R[A++]=k[M++],A==this.blockSize){s(this,R),A=0;break}}this.h=A,this.o+=j},r.prototype.v=function(){var k=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);k[0]=128;for(var j=1;j<k.length-8;++j)k[j]=0;var C=8*this.o;for(j=k.length-8;j<k.length;++j)k[j]=C&255,C/=256;for(this.u(k),k=Array(16),j=C=0;4>j;++j)for(var R=0;32>R;R+=8)k[C++]=this.g[j]>>>R&255;return k};function i(k,j){var C=l;return Object.prototype.hasOwnProperty.call(C,k)?C[k]:C[k]=j(k)}function o(k,j){this.h=j;for(var C=[],R=!0,A=k.length-1;0<=A;A--){var M=k[A]|0;R&&M==j||(C[A]=M,R=!1)}this.g=C}var l={};function c(k){return-128<=k&&128>k?i(k,function(j){return new o([j|0],0>j?-1:0)}):new o([k|0],0>k?-1:0)}function u(k){if(isNaN(k)||!isFinite(k))return m;if(0>k)return v(u(-k));for(var j=[],C=1,R=0;k>=C;R++)j[R]=k/C|0,C*=4294967296;return new o(j,0)}function d(k,j){if(k.length==0)throw Error("number format error: empty string");if(j=j||10,2>j||36<j)throw Error("radix out of range: "+j);if(k.charAt(0)=="-")return v(d(k.substring(1),j));if(0<=k.indexOf("-"))throw Error('number format error: interior "-" character');for(var C=u(Math.pow(j,8)),R=m,A=0;A<k.length;A+=8){var M=Math.min(8,k.length-A),P=parseInt(k.substring(A,A+M),j);8>M?(M=u(Math.pow(j,M)),R=R.j(M).add(u(P))):(R=R.j(C),R=R.add(u(P)))}return R}var m=c(0),p=c(1),g=c(16777216);t=o.prototype,t.m=function(){if(w(this))return-v(this).m();for(var k=0,j=1,C=0;C<this.g.length;C++){var R=this.i(C);k+=(0<=R?R:4294967296+R)*j,j*=4294967296}return k},t.toString=function(k){if(k=k||10,2>k||36<k)throw Error("radix out of range: "+k);if(x(this))return"0";if(w(this))return"-"+v(this).toString(k);for(var j=u(Math.pow(k,6)),C=this,R="";;){var A=I(C,j).g;C=S(C,A.j(j));var M=((0<C.g.length?C.g[0]:C.h)>>>0).toString(k);if(C=A,x(C))return M+R;for(;6>M.length;)M="0"+M;R=M+R}},t.i=function(k){return 0>k?0:k<this.g.length?this.g[k]:this.h};function x(k){if(k.h!=0)return!1;for(var j=0;j<k.g.length;j++)if(k.g[j]!=0)return!1;return!0}function w(k){return k.h==-1}t.l=function(k){return k=S(this,k),w(k)?-1:x(k)?0:1};function v(k){for(var j=k.g.length,C=[],R=0;R<j;R++)C[R]=~k.g[R];return new o(C,~k.h).add(p)}t.abs=function(){return w(this)?v(this):this},t.add=function(k){for(var j=Math.max(this.g.length,k.g.length),C=[],R=0,A=0;A<=j;A++){var M=R+(this.i(A)&65535)+(k.i(A)&65535),P=(M>>>16)+(this.i(A)>>>16)+(k.i(A)>>>16);R=P>>>16,M&=65535,P&=65535,C[A]=P<<16|M}return new o(C,C[C.length-1]&-2147483648?-1:0)};function S(k,j){return k.add(v(j))}t.j=function(k){if(x(this)||x(k))return m;if(w(this))return w(k)?v(this).j(v(k)):v(v(this).j(k));if(w(k))return v(this.j(v(k)));if(0>this.l(g)&&0>k.l(g))return u(this.m()*k.m());for(var j=this.g.length+k.g.length,C=[],R=0;R<2*j;R++)C[R]=0;for(R=0;R<this.g.length;R++)for(var A=0;A<k.g.length;A++){var M=this.i(R)>>>16,P=this.i(R)&65535,we=k.i(A)>>>16,ne=k.i(A)&65535;C[2*R+2*A]+=P*ne,_(C,2*R+2*A),C[2*R+2*A+1]+=M*ne,_(C,2*R+2*A+1),C[2*R+2*A+1]+=P*we,_(C,2*R+2*A+1),C[2*R+2*A+2]+=M*we,_(C,2*R+2*A+2)}for(R=0;R<j;R++)C[R]=C[2*R+1]<<16|C[2*R];for(R=j;R<2*j;R++)C[R]=0;return new o(C,0)};function _(k,j){for(;(k[j]&65535)!=k[j];)k[j+1]+=k[j]>>>16,k[j]&=65535,j++}function E(k,j){this.g=k,this.h=j}function I(k,j){if(x(j))throw Error("division by zero");if(x(k))return new E(m,m);if(w(k))return j=I(v(k),j),new E(v(j.g),v(j.h));if(w(j))return j=I(k,v(j)),new E(v(j.g),j.h);if(30<k.g.length){if(w(k)||w(j))throw Error("slowDivide_ only works with positive integers.");for(var C=p,R=j;0>=R.l(k);)C=N(C),R=N(R);var A=F(C,1),M=F(R,1);for(R=F(R,2),C=F(C,2);!x(R);){var P=M.add(R);0>=P.l(k)&&(A=A.add(C),M=P),R=F(R,1),C=F(C,1)}return j=S(k,A.j(j)),new E(A,j)}for(A=m;0<=k.l(j);){for(C=Math.max(1,Math.floor(k.m()/j.m())),R=Math.ceil(Math.log(C)/Math.LN2),R=48>=R?1:Math.pow(2,R-48),M=u(C),P=M.j(j);w(P)||0<P.l(k);)C-=R,M=u(C),P=M.j(j);x(M)&&(M=p),A=A.add(M),k=S(k,P)}return new E(A,k)}t.A=function(k){return I(this,k).h},t.and=function(k){for(var j=Math.max(this.g.length,k.g.length),C=[],R=0;R<j;R++)C[R]=this.i(R)&k.i(R);return new o(C,this.h&k.h)},t.or=function(k){for(var j=Math.max(this.g.length,k.g.length),C=[],R=0;R<j;R++)C[R]=this.i(R)|k.i(R);return new o(C,this.h|k.h)},t.xor=function(k){for(var j=Math.max(this.g.length,k.g.length),C=[],R=0;R<j;R++)C[R]=this.i(R)^k.i(R);return new o(C,this.h^k.h)};function N(k){for(var j=k.g.length+1,C=[],R=0;R<j;R++)C[R]=k.i(R)<<1|k.i(R-1)>>>31;return new o(C,k.h)}function F(k,j){var C=j>>5;j%=32;for(var R=k.g.length-C,A=[],M=0;M<R;M++)A[M]=0<j?k.i(M+C)>>>j|k.i(M+C+1)<<32-j:k.i(M+C);return new o(A,k.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,UT=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=d,Ma=o}).apply(typeof YS<"u"?YS:typeof self<"u"?self:typeof window<"u"?window:{});var qd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var HT,Ec,GT,Th,gx,WT,qT,KT;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(f,y,b){return f==Array.prototype||f==Object.prototype||(f[y]=b.value),f};function n(f){f=[typeof globalThis=="object"&&globalThis,f,typeof window=="object"&&window,typeof self=="object"&&self,typeof qd=="object"&&qd];for(var y=0;y<f.length;++y){var b=f[y];if(b&&b.Math==Math)return b}throw Error("Cannot find global object")}var r=n(this);function s(f,y){if(y)e:{var b=r;f=f.split(".");for(var T=0;T<f.length-1;T++){var D=f[T];if(!(D in b))break e;b=b[D]}f=f[f.length-1],T=b[f],y=y(T),y!=T&&y!=null&&e(b,f,{configurable:!0,writable:!0,value:y})}}function i(f,y){f instanceof String&&(f+="");var b=0,T=!1,D={next:function(){if(!T&&b<f.length){var L=b++;return{value:y(L,f[L]),done:!1}}return T=!0,{done:!0,value:void 0}}};return D[Symbol.iterator]=function(){return D},D}s("Array.prototype.values",function(f){return f||function(){return i(this,function(y,b){return b})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function c(f){var y=typeof f;return y=y!="object"?y:f?Array.isArray(f)?"array":y:"null",y=="array"||y=="object"&&typeof f.length=="number"}function u(f){var y=typeof f;return y=="object"&&f!=null||y=="function"}function d(f,y,b){return f.call.apply(f.bind,arguments)}function m(f,y,b){if(!f)throw Error();if(2<arguments.length){var T=Array.prototype.slice.call(arguments,2);return function(){var D=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(D,T),f.apply(y,D)}}return function(){return f.apply(y,arguments)}}function p(f,y,b){return p=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:m,p.apply(null,arguments)}function g(f,y){var b=Array.prototype.slice.call(arguments,1);return function(){var T=b.slice();return T.push.apply(T,arguments),f.apply(this,T)}}function x(f,y){function b(){}b.prototype=y.prototype,f.aa=y.prototype,f.prototype=new b,f.prototype.constructor=f,f.Qb=function(T,D,L){for(var G=Array(arguments.length-2),Ke=2;Ke<arguments.length;Ke++)G[Ke-2]=arguments[Ke];return y.prototype[D].apply(T,G)}}function w(f){const y=f.length;if(0<y){const b=Array(y);for(let T=0;T<y;T++)b[T]=f[T];return b}return[]}function v(f,y){for(let b=1;b<arguments.length;b++){const T=arguments[b];if(c(T)){const D=f.length||0,L=T.length||0;f.length=D+L;for(let G=0;G<L;G++)f[D+G]=T[G]}else f.push(T)}}class S{constructor(y,b){this.i=y,this.j=b,this.h=0,this.g=null}get(){let y;return 0<this.h?(this.h--,y=this.g,this.g=y.next,y.next=null):y=this.i(),y}}function _(f){return/^[\s\xa0]*$/.test(f)}function E(){var f=l.navigator;return f&&(f=f.userAgent)?f:""}function I(f){return I[" "](f),f}I[" "]=function(){};var N=E().indexOf("Gecko")!=-1&&!(E().toLowerCase().indexOf("webkit")!=-1&&E().indexOf("Edge")==-1)&&!(E().indexOf("Trident")!=-1||E().indexOf("MSIE")!=-1)&&E().indexOf("Edge")==-1;function F(f,y,b){for(const T in f)y.call(b,f[T],T,f)}function k(f,y){for(const b in f)y.call(void 0,f[b],b,f)}function j(f){const y={};for(const b in f)y[b]=f[b];return y}const C="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function R(f,y){let b,T;for(let D=1;D<arguments.length;D++){T=arguments[D];for(b in T)f[b]=T[b];for(let L=0;L<C.length;L++)b=C[L],Object.prototype.hasOwnProperty.call(T,b)&&(f[b]=T[b])}}function A(f){var y=1;f=f.split(":");const b=[];for(;0<y&&f.length;)b.push(f.shift()),y--;return f.length&&b.push(f.join(":")),b}function M(f){l.setTimeout(()=>{throw f},0)}function P(){var f=K;let y=null;return f.g&&(y=f.g,f.g=f.g.next,f.g||(f.h=null),y.next=null),y}class we{constructor(){this.h=this.g=null}add(y,b){const T=ne.get();T.set(y,b),this.h?this.h.next=T:this.g=T,this.h=T}}var ne=new S(()=>new he,f=>f.reset());class he{constructor(){this.next=this.g=this.h=null}set(y,b){this.h=y,this.g=b,this.next=null}reset(){this.next=this.g=this.h=null}}let ge,H=!1,K=new we,ee=()=>{const f=l.Promise.resolve(void 0);ge=()=>{f.then(be)}};var be=()=>{for(var f;f=P();){try{f.h.call(f.g)}catch(b){M(b)}var y=ne;y.j(f),100>y.h&&(y.h++,f.next=y.g,y.g=f)}H=!1};function Re(){this.s=this.s,this.C=this.C}Re.prototype.s=!1,Re.prototype.ma=function(){this.s||(this.s=!0,this.N())},Re.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Oe(f,y){this.type=f,this.g=this.target=y,this.defaultPrevented=!1}Oe.prototype.h=function(){this.defaultPrevented=!0};var kn=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var f=!1,y=Object.defineProperty({},"passive",{get:function(){f=!0}});try{const b=()=>{};l.addEventListener("test",b,y),l.removeEventListener("test",b,y)}catch{}return f}();function jr(f,y){if(Oe.call(this,f?f.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,f){var b=this.type=f.type,T=f.changedTouches&&f.changedTouches.length?f.changedTouches[0]:null;if(this.target=f.target||f.srcElement,this.g=y,y=f.relatedTarget){if(N){e:{try{I(y.nodeName);var D=!0;break e}catch{}D=!1}D||(y=null)}}else b=="mouseover"?y=f.fromElement:b=="mouseout"&&(y=f.toElement);this.relatedTarget=y,T?(this.clientX=T.clientX!==void 0?T.clientX:T.pageX,this.clientY=T.clientY!==void 0?T.clientY:T.pageY,this.screenX=T.screenX||0,this.screenY=T.screenY||0):(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0),this.button=f.button,this.key=f.key||"",this.ctrlKey=f.ctrlKey,this.altKey=f.altKey,this.shiftKey=f.shiftKey,this.metaKey=f.metaKey,this.pointerId=f.pointerId||0,this.pointerType=typeof f.pointerType=="string"?f.pointerType:kr[f.pointerType]||"",this.state=f.state,this.i=f,f.defaultPrevented&&jr.aa.h.call(this)}}x(jr,Oe);var kr={2:"touch",3:"pen",4:"mouse"};jr.prototype.h=function(){jr.aa.h.call(this);var f=this.i;f.preventDefault?f.preventDefault():f.returnValue=!1};var xe="closure_listenable_"+(1e6*Math.random()|0),$r=0;function Wn(f,y,b,T,D){this.listener=f,this.proxy=null,this.src=y,this.type=b,this.capture=!!T,this.ha=D,this.key=++$r,this.da=this.fa=!1}function zr(f){f.da=!0,f.listener=null,f.proxy=null,f.src=null,f.ha=null}function Ns(f){this.src=f,this.g={},this.h=0}Ns.prototype.add=function(f,y,b,T,D){var L=f.toString();f=this.g[L],f||(f=this.g[L]=[],this.h++);var G=bp(f,y,T,D);return-1<G?(y=f[G],b||(y.fa=!1)):(y=new Wn(y,this.src,L,!!T,D),y.fa=b,f.push(y)),y};function yo(f,y){var b=y.type;if(b in f.g){var T=f.g[b],D=Array.prototype.indexOf.call(T,y,void 0),L;(L=0<=D)&&Array.prototype.splice.call(T,D,1),L&&(zr(y),f.g[b].length==0&&(delete f.g[b],f.h--))}}function bp(f,y,b,T){for(var D=0;D<f.length;++D){var L=f[D];if(!L.da&&L.listener==y&&L.capture==!!b&&L.ha==T)return D}return-1}var Ep="closure_lm_"+(1e6*Math.random()|0),jp={};function u1(f,y,b,T,D){if(T&&T.once)return h1(f,y,b,T,D);if(Array.isArray(y)){for(var L=0;L<y.length;L++)u1(f,y[L],b,T,D);return null}return b=Cp(b),f&&f[xe]?f.K(y,b,u(T)?!!T.capture:!!T,D):d1(f,y,b,!1,T,D)}function d1(f,y,b,T,D,L){if(!y)throw Error("Invalid event type");var G=u(D)?!!D.capture:!!D,Ke=Tp(f);if(Ke||(f[Ep]=Ke=new Ns(f)),b=Ke.add(y,b,T,G,L),b.proxy)return b;if(T=FA(),b.proxy=T,T.src=f,T.listener=b,f.addEventListener)kn||(D=G),D===void 0&&(D=!1),f.addEventListener(y.toString(),T,D);else if(f.attachEvent)f.attachEvent(m1(y.toString()),T);else if(f.addListener&&f.removeListener)f.addListener(T);else throw Error("addEventListener and attachEvent are unavailable.");return b}function FA(){function f(b){return y.call(f.src,f.listener,b)}const y=MA;return f}function h1(f,y,b,T,D){if(Array.isArray(y)){for(var L=0;L<y.length;L++)h1(f,y[L],b,T,D);return null}return b=Cp(b),f&&f[xe]?f.L(y,b,u(T)?!!T.capture:!!T,D):d1(f,y,b,!0,T,D)}function f1(f,y,b,T,D){if(Array.isArray(y))for(var L=0;L<y.length;L++)f1(f,y[L],b,T,D);else T=u(T)?!!T.capture:!!T,b=Cp(b),f&&f[xe]?(f=f.i,y=String(y).toString(),y in f.g&&(L=f.g[y],b=bp(L,b,T,D),-1<b&&(zr(L[b]),Array.prototype.splice.call(L,b,1),L.length==0&&(delete f.g[y],f.h--)))):f&&(f=Tp(f))&&(y=f.g[y.toString()],f=-1,y&&(f=bp(y,b,T,D)),(b=-1<f?y[f]:null)&&kp(b))}function kp(f){if(typeof f!="number"&&f&&!f.da){var y=f.src;if(y&&y[xe])yo(y.i,f);else{var b=f.type,T=f.proxy;y.removeEventListener?y.removeEventListener(b,T,f.capture):y.detachEvent?y.detachEvent(m1(b),T):y.addListener&&y.removeListener&&y.removeListener(T),(b=Tp(y))?(yo(b,f),b.h==0&&(b.src=null,y[Ep]=null)):zr(f)}}}function m1(f){return f in jp?jp[f]:jp[f]="on"+f}function MA(f,y){if(f.da)f=!0;else{y=new jr(y,this);var b=f.listener,T=f.ha||f.src;f.fa&&kp(f),f=b.call(T,y)}return f}function Tp(f){return f=f[Ep],f instanceof Ns?f:null}var Ip="__closure_events_fn_"+(1e9*Math.random()>>>0);function Cp(f){return typeof f=="function"?f:(f[Ip]||(f[Ip]=function(y){return f.handleEvent(y)}),f[Ip])}function ln(){Re.call(this),this.i=new Ns(this),this.M=this,this.F=null}x(ln,Re),ln.prototype[xe]=!0,ln.prototype.removeEventListener=function(f,y,b,T){f1(this,f,y,b,T)};function Tn(f,y){var b,T=f.F;if(T)for(b=[];T;T=T.F)b.push(T);if(f=f.M,T=y.type||y,typeof y=="string")y=new Oe(y,f);else if(y instanceof Oe)y.target=y.target||f;else{var D=y;y=new Oe(T,f),R(y,D)}if(D=!0,b)for(var L=b.length-1;0<=L;L--){var G=y.g=b[L];D=md(G,T,!0,y)&&D}if(G=y.g=f,D=md(G,T,!0,y)&&D,D=md(G,T,!1,y)&&D,b)for(L=0;L<b.length;L++)G=y.g=b[L],D=md(G,T,!1,y)&&D}ln.prototype.N=function(){if(ln.aa.N.call(this),this.i){var f=this.i,y;for(y in f.g){for(var b=f.g[y],T=0;T<b.length;T++)zr(b[T]);delete f.g[y],f.h--}}this.F=null},ln.prototype.K=function(f,y,b,T){return this.i.add(String(f),y,!1,b,T)},ln.prototype.L=function(f,y,b,T){return this.i.add(String(f),y,!0,b,T)};function md(f,y,b,T){if(y=f.i.g[String(y)],!y)return!0;y=y.concat();for(var D=!0,L=0;L<y.length;++L){var G=y[L];if(G&&!G.da&&G.capture==b){var Ke=G.listener,Qt=G.ha||G.src;G.fa&&yo(f.i,G),D=Ke.call(Qt,T)!==!1&&D}}return D&&!T.defaultPrevented}function p1(f,y,b){if(typeof f=="function")b&&(f=p(f,b));else if(f&&typeof f.handleEvent=="function")f=p(f.handleEvent,f);else throw Error("Invalid listener argument");return 2147483647<Number(y)?-1:l.setTimeout(f,y||0)}function g1(f){f.g=p1(()=>{f.g=null,f.i&&(f.i=!1,g1(f))},f.l);const y=f.h;f.h=null,f.m.apply(null,y)}class DA extends Re{constructor(y,b){super(),this.m=y,this.l=b,this.h=null,this.i=!1,this.g=null}j(y){this.h=arguments,this.g?this.i=!0:g1(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ql(f){Re.call(this),this.h=f,this.g={}}x(Ql,Re);var x1=[];function y1(f){F(f.g,function(y,b){this.g.hasOwnProperty(b)&&kp(y)},f),f.g={}}Ql.prototype.N=function(){Ql.aa.N.call(this),y1(this)},Ql.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Rp=l.JSON.stringify,LA=l.JSON.parse,OA=class{stringify(f){return l.JSON.stringify(f,void 0)}parse(f){return l.JSON.parse(f,void 0)}};function Np(){}Np.prototype.h=null;function v1(f){return f.h||(f.h=f.i())}function w1(){}var Xl={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ap(){Oe.call(this,"d")}x(Ap,Oe);function Pp(){Oe.call(this,"c")}x(Pp,Oe);var ma={},_1=null;function pd(){return _1=_1||new ln}ma.La="serverreachability";function S1(f){Oe.call(this,ma.La,f)}x(S1,Oe);function Yl(f){const y=pd();Tn(y,new S1(y))}ma.STAT_EVENT="statevent";function b1(f,y){Oe.call(this,ma.STAT_EVENT,f),this.stat=y}x(b1,Oe);function In(f){const y=pd();Tn(y,new b1(y,f))}ma.Ma="timingevent";function E1(f,y){Oe.call(this,ma.Ma,f),this.size=y}x(E1,Oe);function Jl(f,y){if(typeof f!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){f()},y)}function Zl(){this.g=!0}Zl.prototype.xa=function(){this.g=!1};function $A(f,y,b,T,D,L){f.info(function(){if(f.g)if(L)for(var G="",Ke=L.split("&"),Qt=0;Qt<Ke.length;Qt++){var $e=Ke[Qt].split("=");if(1<$e.length){var cn=$e[0];$e=$e[1];var un=cn.split("_");G=2<=un.length&&un[1]=="type"?G+(cn+"="+$e+"&"):G+(cn+"=redacted&")}}else G=null;else G=L;return"XMLHTTP REQ ("+T+") [attempt "+D+"]: "+y+`
`+b+`
`+G})}function zA(f,y,b,T,D,L,G){f.info(function(){return"XMLHTTP RESP ("+T+") [ attempt "+D+"]: "+y+`
`+b+`
`+L+" "+G})}function vo(f,y,b,T){f.info(function(){return"XMLHTTP TEXT ("+y+"): "+VA(f,b)+(T?" "+T:"")})}function BA(f,y){f.info(function(){return"TIMEOUT: "+y})}Zl.prototype.info=function(){};function VA(f,y){if(!f.g)return y;if(!y)return null;try{var b=JSON.parse(y);if(b){for(f=0;f<b.length;f++)if(Array.isArray(b[f])){var T=b[f];if(!(2>T.length)){var D=T[1];if(Array.isArray(D)&&!(1>D.length)){var L=D[0];if(L!="noop"&&L!="stop"&&L!="close")for(var G=1;G<D.length;G++)D[G]=""}}}}return Rp(b)}catch{return y}}var gd={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},j1={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Fp;function xd(){}x(xd,Np),xd.prototype.g=function(){return new XMLHttpRequest},xd.prototype.i=function(){return{}},Fp=new xd;function yi(f,y,b,T){this.j=f,this.i=y,this.l=b,this.R=T||1,this.U=new Ql(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new k1}function k1(){this.i=null,this.g="",this.h=!1}var T1={},Mp={};function Dp(f,y,b){f.L=1,f.v=_d(As(y)),f.m=b,f.P=!0,I1(f,null)}function I1(f,y){f.F=Date.now(),yd(f),f.A=As(f.v);var b=f.A,T=f.R;Array.isArray(T)||(T=[String(T)]),V1(b.i,"t",T),f.C=0,b=f.j.J,f.h=new k1,f.g=a_(f.j,b?y:null,!f.m),0<f.O&&(f.M=new DA(p(f.Y,f,f.g),f.O)),y=f.U,b=f.g,T=f.ca;var D="readystatechange";Array.isArray(D)||(D&&(x1[0]=D.toString()),D=x1);for(var L=0;L<D.length;L++){var G=u1(b,D[L],T||y.handleEvent,!1,y.h||y);if(!G)break;y.g[G.key]=G}y=f.H?j(f.H):{},f.m?(f.u||(f.u="POST"),y["Content-Type"]="application/x-www-form-urlencoded",f.g.ea(f.A,f.u,f.m,y)):(f.u="GET",f.g.ea(f.A,f.u,null,y)),Yl(),$A(f.i,f.u,f.A,f.l,f.R,f.m)}yi.prototype.ca=function(f){f=f.target;const y=this.M;y&&Ps(f)==3?y.j():this.Y(f)},yi.prototype.Y=function(f){try{if(f==this.g)e:{const un=Ps(this.g);var y=this.g.Ba();const So=this.g.Z();if(!(3>un)&&(un!=3||this.g&&(this.h.h||this.g.oa()||Q1(this.g)))){this.J||un!=4||y==7||(y==8||0>=So?Yl(3):Yl(2)),Lp(this);var b=this.g.Z();this.X=b;t:if(C1(this)){var T=Q1(this.g);f="";var D=T.length,L=Ps(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){pa(this),ec(this);var G="";break t}this.h.i=new l.TextDecoder}for(y=0;y<D;y++)this.h.h=!0,f+=this.h.i.decode(T[y],{stream:!(L&&y==D-1)});T.length=0,this.h.g+=f,this.C=0,G=this.h.g}else G=this.g.oa();if(this.o=b==200,zA(this.i,this.u,this.A,this.l,this.R,un,b),this.o){if(this.T&&!this.K){t:{if(this.g){var Ke,Qt=this.g;if((Ke=Qt.g?Qt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!_(Ke)){var $e=Ke;break t}}$e=null}if(b=$e)vo(this.i,this.l,b,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Op(this,b);else{this.o=!1,this.s=3,In(12),pa(this),ec(this);break e}}if(this.P){b=!0;let Br;for(;!this.J&&this.C<G.length;)if(Br=UA(this,G),Br==Mp){un==4&&(this.s=4,In(14),b=!1),vo(this.i,this.l,null,"[Incomplete Response]");break}else if(Br==T1){this.s=4,In(15),vo(this.i,this.l,G,"[Invalid Chunk]"),b=!1;break}else vo(this.i,this.l,Br,null),Op(this,Br);if(C1(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),un!=4||G.length!=0||this.h.h||(this.s=1,In(16),b=!1),this.o=this.o&&b,!b)vo(this.i,this.l,G,"[Invalid Chunked Response]"),pa(this),ec(this);else if(0<G.length&&!this.W){this.W=!0;var cn=this.j;cn.g==this&&cn.ba&&!cn.M&&(cn.j.info("Great, no buffering proxy detected. Bytes received: "+G.length),Hp(cn),cn.M=!0,In(11))}}else vo(this.i,this.l,G,null),Op(this,G);un==4&&pa(this),this.o&&!this.J&&(un==4?n_(this.j,this):(this.o=!1,yd(this)))}else a5(this.g),b==400&&0<G.indexOf("Unknown SID")?(this.s=3,In(12)):(this.s=0,In(13)),pa(this),ec(this)}}}catch{}finally{}};function C1(f){return f.g?f.u=="GET"&&f.L!=2&&f.j.Ca:!1}function UA(f,y){var b=f.C,T=y.indexOf(`
`,b);return T==-1?Mp:(b=Number(y.substring(b,T)),isNaN(b)?T1:(T+=1,T+b>y.length?Mp:(y=y.slice(T,T+b),f.C=T+b,y)))}yi.prototype.cancel=function(){this.J=!0,pa(this)};function yd(f){f.S=Date.now()+f.I,R1(f,f.I)}function R1(f,y){if(f.B!=null)throw Error("WatchDog timer not null");f.B=Jl(p(f.ba,f),y)}function Lp(f){f.B&&(l.clearTimeout(f.B),f.B=null)}yi.prototype.ba=function(){this.B=null;const f=Date.now();0<=f-this.S?(BA(this.i,this.A),this.L!=2&&(Yl(),In(17)),pa(this),this.s=2,ec(this)):R1(this,this.S-f)};function ec(f){f.j.G==0||f.J||n_(f.j,f)}function pa(f){Lp(f);var y=f.M;y&&typeof y.ma=="function"&&y.ma(),f.M=null,y1(f.U),f.g&&(y=f.g,f.g=null,y.abort(),y.ma())}function Op(f,y){try{var b=f.j;if(b.G!=0&&(b.g==f||$p(b.h,f))){if(!f.K&&$p(b.h,f)&&b.G==3){try{var T=b.Da.g.parse(y)}catch{T=null}if(Array.isArray(T)&&T.length==3){var D=T;if(D[0]==0){e:if(!b.u){if(b.g)if(b.g.F+3e3<f.F)Td(b),jd(b);else break e;Up(b),In(18)}}else b.za=D[1],0<b.za-b.T&&37500>D[2]&&b.F&&b.v==0&&!b.C&&(b.C=Jl(p(b.Za,b),6e3));if(1>=P1(b.h)&&b.ca){try{b.ca()}catch{}b.ca=void 0}}else xa(b,11)}else if((f.K||b.g==f)&&Td(b),!_(y))for(D=b.Da.g.parse(y),y=0;y<D.length;y++){let $e=D[y];if(b.T=$e[0],$e=$e[1],b.G==2)if($e[0]=="c"){b.K=$e[1],b.ia=$e[2];const cn=$e[3];cn!=null&&(b.la=cn,b.j.info("VER="+b.la));const un=$e[4];un!=null&&(b.Aa=un,b.j.info("SVER="+b.Aa));const So=$e[5];So!=null&&typeof So=="number"&&0<So&&(T=1.5*So,b.L=T,b.j.info("backChannelRequestTimeoutMs_="+T)),T=b;const Br=f.g;if(Br){const Cd=Br.g?Br.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Cd){var L=T.h;L.g||Cd.indexOf("spdy")==-1&&Cd.indexOf("quic")==-1&&Cd.indexOf("h2")==-1||(L.j=L.l,L.g=new Set,L.h&&(zp(L,L.h),L.h=null))}if(T.D){const Gp=Br.g?Br.g.getResponseHeader("X-HTTP-Session-Id"):null;Gp&&(T.ya=Gp,Je(T.I,T.D,Gp))}}b.G=3,b.l&&b.l.ua(),b.ba&&(b.R=Date.now()-f.F,b.j.info("Handshake RTT: "+b.R+"ms")),T=b;var G=f;if(T.qa=i_(T,T.J?T.ia:null,T.W),G.K){F1(T.h,G);var Ke=G,Qt=T.L;Qt&&(Ke.I=Qt),Ke.B&&(Lp(Ke),yd(Ke)),T.g=G}else e_(T);0<b.i.length&&kd(b)}else $e[0]!="stop"&&$e[0]!="close"||xa(b,7);else b.G==3&&($e[0]=="stop"||$e[0]=="close"?$e[0]=="stop"?xa(b,7):Vp(b):$e[0]!="noop"&&b.l&&b.l.ta($e),b.v=0)}}Yl(4)}catch{}}var HA=class{constructor(f,y){this.g=f,this.map=y}};function N1(f){this.l=f||10,l.PerformanceNavigationTiming?(f=l.performance.getEntriesByType("navigation"),f=0<f.length&&(f[0].nextHopProtocol=="hq"||f[0].nextHopProtocol=="h2")):f=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=f?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function A1(f){return f.h?!0:f.g?f.g.size>=f.j:!1}function P1(f){return f.h?1:f.g?f.g.size:0}function $p(f,y){return f.h?f.h==y:f.g?f.g.has(y):!1}function zp(f,y){f.g?f.g.add(y):f.h=y}function F1(f,y){f.h&&f.h==y?f.h=null:f.g&&f.g.has(y)&&f.g.delete(y)}N1.prototype.cancel=function(){if(this.i=M1(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const f of this.g.values())f.cancel();this.g.clear()}};function M1(f){if(f.h!=null)return f.i.concat(f.h.D);if(f.g!=null&&f.g.size!==0){let y=f.i;for(const b of f.g.values())y=y.concat(b.D);return y}return w(f.i)}function GA(f){if(f.V&&typeof f.V=="function")return f.V();if(typeof Map<"u"&&f instanceof Map||typeof Set<"u"&&f instanceof Set)return Array.from(f.values());if(typeof f=="string")return f.split("");if(c(f)){for(var y=[],b=f.length,T=0;T<b;T++)y.push(f[T]);return y}y=[],b=0;for(T in f)y[b++]=f[T];return y}function WA(f){if(f.na&&typeof f.na=="function")return f.na();if(!f.V||typeof f.V!="function"){if(typeof Map<"u"&&f instanceof Map)return Array.from(f.keys());if(!(typeof Set<"u"&&f instanceof Set)){if(c(f)||typeof f=="string"){var y=[];f=f.length;for(var b=0;b<f;b++)y.push(b);return y}y=[],b=0;for(const T in f)y[b++]=T;return y}}}function D1(f,y){if(f.forEach&&typeof f.forEach=="function")f.forEach(y,void 0);else if(c(f)||typeof f=="string")Array.prototype.forEach.call(f,y,void 0);else for(var b=WA(f),T=GA(f),D=T.length,L=0;L<D;L++)y.call(void 0,T[L],b&&b[L],f)}var L1=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function qA(f,y){if(f){f=f.split("&");for(var b=0;b<f.length;b++){var T=f[b].indexOf("="),D=null;if(0<=T){var L=f[b].substring(0,T);D=f[b].substring(T+1)}else L=f[b];y(L,D?decodeURIComponent(D.replace(/\+/g," ")):"")}}}function ga(f){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,f instanceof ga){this.h=f.h,vd(this,f.j),this.o=f.o,this.g=f.g,wd(this,f.s),this.l=f.l;var y=f.i,b=new rc;b.i=y.i,y.g&&(b.g=new Map(y.g),b.h=y.h),O1(this,b),this.m=f.m}else f&&(y=String(f).match(L1))?(this.h=!1,vd(this,y[1]||"",!0),this.o=tc(y[2]||""),this.g=tc(y[3]||"",!0),wd(this,y[4]),this.l=tc(y[5]||"",!0),O1(this,y[6]||"",!0),this.m=tc(y[7]||"")):(this.h=!1,this.i=new rc(null,this.h))}ga.prototype.toString=function(){var f=[],y=this.j;y&&f.push(nc(y,$1,!0),":");var b=this.g;return(b||y=="file")&&(f.push("//"),(y=this.o)&&f.push(nc(y,$1,!0),"@"),f.push(encodeURIComponent(String(b)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),b=this.s,b!=null&&f.push(":",String(b))),(b=this.l)&&(this.g&&b.charAt(0)!="/"&&f.push("/"),f.push(nc(b,b.charAt(0)=="/"?XA:QA,!0))),(b=this.i.toString())&&f.push("?",b),(b=this.m)&&f.push("#",nc(b,JA)),f.join("")};function As(f){return new ga(f)}function vd(f,y,b){f.j=b?tc(y,!0):y,f.j&&(f.j=f.j.replace(/:$/,""))}function wd(f,y){if(y){if(y=Number(y),isNaN(y)||0>y)throw Error("Bad port number "+y);f.s=y}else f.s=null}function O1(f,y,b){y instanceof rc?(f.i=y,ZA(f.i,f.h)):(b||(y=nc(y,YA)),f.i=new rc(y,f.h))}function Je(f,y,b){f.i.set(y,b)}function _d(f){return Je(f,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),f}function tc(f,y){return f?y?decodeURI(f.replace(/%25/g,"%2525")):decodeURIComponent(f):""}function nc(f,y,b){return typeof f=="string"?(f=encodeURI(f).replace(y,KA),b&&(f=f.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f):null}function KA(f){return f=f.charCodeAt(0),"%"+(f>>4&15).toString(16)+(f&15).toString(16)}var $1=/[#\/\?@]/g,QA=/[#\?:]/g,XA=/[#\?]/g,YA=/[#\?@]/g,JA=/#/g;function rc(f,y){this.h=this.g=null,this.i=f||null,this.j=!!y}function vi(f){f.g||(f.g=new Map,f.h=0,f.i&&qA(f.i,function(y,b){f.add(decodeURIComponent(y.replace(/\+/g," ")),b)}))}t=rc.prototype,t.add=function(f,y){vi(this),this.i=null,f=wo(this,f);var b=this.g.get(f);return b||this.g.set(f,b=[]),b.push(y),this.h+=1,this};function z1(f,y){vi(f),y=wo(f,y),f.g.has(y)&&(f.i=null,f.h-=f.g.get(y).length,f.g.delete(y))}function B1(f,y){return vi(f),y=wo(f,y),f.g.has(y)}t.forEach=function(f,y){vi(this),this.g.forEach(function(b,T){b.forEach(function(D){f.call(y,D,T,this)},this)},this)},t.na=function(){vi(this);const f=Array.from(this.g.values()),y=Array.from(this.g.keys()),b=[];for(let T=0;T<y.length;T++){const D=f[T];for(let L=0;L<D.length;L++)b.push(y[T])}return b},t.V=function(f){vi(this);let y=[];if(typeof f=="string")B1(this,f)&&(y=y.concat(this.g.get(wo(this,f))));else{f=Array.from(this.g.values());for(let b=0;b<f.length;b++)y=y.concat(f[b])}return y},t.set=function(f,y){return vi(this),this.i=null,f=wo(this,f),B1(this,f)&&(this.h-=this.g.get(f).length),this.g.set(f,[y]),this.h+=1,this},t.get=function(f,y){return f?(f=this.V(f),0<f.length?String(f[0]):y):y};function V1(f,y,b){z1(f,y),0<b.length&&(f.i=null,f.g.set(wo(f,y),w(b)),f.h+=b.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const f=[],y=Array.from(this.g.keys());for(var b=0;b<y.length;b++){var T=y[b];const L=encodeURIComponent(String(T)),G=this.V(T);for(T=0;T<G.length;T++){var D=L;G[T]!==""&&(D+="="+encodeURIComponent(String(G[T]))),f.push(D)}}return this.i=f.join("&")};function wo(f,y){return y=String(y),f.j&&(y=y.toLowerCase()),y}function ZA(f,y){y&&!f.j&&(vi(f),f.i=null,f.g.forEach(function(b,T){var D=T.toLowerCase();T!=D&&(z1(this,T),V1(this,D,b))},f)),f.j=y}function e5(f,y){const b=new Zl;if(l.Image){const T=new Image;T.onload=g(wi,b,"TestLoadImage: loaded",!0,y,T),T.onerror=g(wi,b,"TestLoadImage: error",!1,y,T),T.onabort=g(wi,b,"TestLoadImage: abort",!1,y,T),T.ontimeout=g(wi,b,"TestLoadImage: timeout",!1,y,T),l.setTimeout(function(){T.ontimeout&&T.ontimeout()},1e4),T.src=f}else y(!1)}function t5(f,y){const b=new Zl,T=new AbortController,D=setTimeout(()=>{T.abort(),wi(b,"TestPingServer: timeout",!1,y)},1e4);fetch(f,{signal:T.signal}).then(L=>{clearTimeout(D),L.ok?wi(b,"TestPingServer: ok",!0,y):wi(b,"TestPingServer: server error",!1,y)}).catch(()=>{clearTimeout(D),wi(b,"TestPingServer: error",!1,y)})}function wi(f,y,b,T,D){try{D&&(D.onload=null,D.onerror=null,D.onabort=null,D.ontimeout=null),T(b)}catch{}}function n5(){this.g=new OA}function r5(f,y,b){const T=b||"";try{D1(f,function(D,L){let G=D;u(D)&&(G=Rp(D)),y.push(T+L+"="+encodeURIComponent(G))})}catch(D){throw y.push(T+"type="+encodeURIComponent("_badmap")),D}}function Sd(f){this.l=f.Ub||null,this.j=f.eb||!1}x(Sd,Np),Sd.prototype.g=function(){return new bd(this.l,this.j)},Sd.prototype.i=function(f){return function(){return f}}({});function bd(f,y){ln.call(this),this.D=f,this.o=y,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}x(bd,ln),t=bd.prototype,t.open=function(f,y){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=f,this.A=y,this.readyState=1,ic(this)},t.send=function(f){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const y={headers:this.u,method:this.B,credentials:this.m,cache:void 0};f&&(y.body=f),(this.D||l).fetch(new Request(this.A,y)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,sc(this)),this.readyState=0},t.Sa=function(f){if(this.g&&(this.l=f,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=f.headers,this.readyState=2,ic(this)),this.g&&(this.readyState=3,ic(this),this.g)))if(this.responseType==="arraybuffer")f.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in f){if(this.j=f.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;U1(this)}else f.text().then(this.Ra.bind(this),this.ga.bind(this))};function U1(f){f.j.read().then(f.Pa.bind(f)).catch(f.ga.bind(f))}t.Pa=function(f){if(this.g){if(this.o&&f.value)this.response.push(f.value);else if(!this.o){var y=f.value?f.value:new Uint8Array(0);(y=this.v.decode(y,{stream:!f.done}))&&(this.response=this.responseText+=y)}f.done?sc(this):ic(this),this.readyState==3&&U1(this)}},t.Ra=function(f){this.g&&(this.response=this.responseText=f,sc(this))},t.Qa=function(f){this.g&&(this.response=f,sc(this))},t.ga=function(){this.g&&sc(this)};function sc(f){f.readyState=4,f.l=null,f.j=null,f.v=null,ic(f)}t.setRequestHeader=function(f,y){this.u.append(f,y)},t.getResponseHeader=function(f){return this.h&&this.h.get(f.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const f=[],y=this.h.entries();for(var b=y.next();!b.done;)b=b.value,f.push(b[0]+": "+b[1]),b=y.next();return f.join(`\r
`)};function ic(f){f.onreadystatechange&&f.onreadystatechange.call(f)}Object.defineProperty(bd.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(f){this.m=f?"include":"same-origin"}});function H1(f){let y="";return F(f,function(b,T){y+=T,y+=":",y+=b,y+=`\r
`}),y}function Bp(f,y,b){e:{for(T in b){var T=!1;break e}T=!0}T||(b=H1(b),typeof f=="string"?b!=null&&encodeURIComponent(String(b)):Je(f,y,b))}function ft(f){ln.call(this),this.headers=new Map,this.o=f||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}x(ft,ln);var s5=/^https?$/i,i5=["POST","PUT"];t=ft.prototype,t.Ha=function(f){this.J=f},t.ea=function(f,y,b,T){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+f);y=y?y.toUpperCase():"GET",this.D=f,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Fp.g(),this.v=this.o?v1(this.o):v1(Fp),this.g.onreadystatechange=p(this.Ea,this);try{this.B=!0,this.g.open(y,String(f),!0),this.B=!1}catch(L){G1(this,L);return}if(f=b||"",b=new Map(this.headers),T)if(Object.getPrototypeOf(T)===Object.prototype)for(var D in T)b.set(D,T[D]);else if(typeof T.keys=="function"&&typeof T.get=="function")for(const L of T.keys())b.set(L,T.get(L));else throw Error("Unknown input type for opt_headers: "+String(T));T=Array.from(b.keys()).find(L=>L.toLowerCase()=="content-type"),D=l.FormData&&f instanceof l.FormData,!(0<=Array.prototype.indexOf.call(i5,y,void 0))||T||D||b.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[L,G]of b)this.g.setRequestHeader(L,G);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{K1(this),this.u=!0,this.g.send(f),this.u=!1}catch(L){G1(this,L)}};function G1(f,y){f.h=!1,f.g&&(f.j=!0,f.g.abort(),f.j=!1),f.l=y,f.m=5,W1(f),Ed(f)}function W1(f){f.A||(f.A=!0,Tn(f,"complete"),Tn(f,"error"))}t.abort=function(f){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=f||7,Tn(this,"complete"),Tn(this,"abort"),Ed(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ed(this,!0)),ft.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?q1(this):this.bb())},t.bb=function(){q1(this)};function q1(f){if(f.h&&typeof o<"u"&&(!f.v[1]||Ps(f)!=4||f.Z()!=2)){if(f.u&&Ps(f)==4)p1(f.Ea,0,f);else if(Tn(f,"readystatechange"),Ps(f)==4){f.h=!1;try{const G=f.Z();e:switch(G){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var y=!0;break e;default:y=!1}var b;if(!(b=y)){var T;if(T=G===0){var D=String(f.D).match(L1)[1]||null;!D&&l.self&&l.self.location&&(D=l.self.location.protocol.slice(0,-1)),T=!s5.test(D?D.toLowerCase():"")}b=T}if(b)Tn(f,"complete"),Tn(f,"success");else{f.m=6;try{var L=2<Ps(f)?f.g.statusText:""}catch{L=""}f.l=L+" ["+f.Z()+"]",W1(f)}}finally{Ed(f)}}}}function Ed(f,y){if(f.g){K1(f);const b=f.g,T=f.v[0]?()=>{}:null;f.g=null,f.v=null,y||Tn(f,"ready");try{b.onreadystatechange=T}catch{}}}function K1(f){f.I&&(l.clearTimeout(f.I),f.I=null)}t.isActive=function(){return!!this.g};function Ps(f){return f.g?f.g.readyState:0}t.Z=function(){try{return 2<Ps(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(f){if(this.g){var y=this.g.responseText;return f&&y.indexOf(f)==0&&(y=y.substring(f.length)),LA(y)}};function Q1(f){try{if(!f.g)return null;if("response"in f.g)return f.g.response;switch(f.H){case"":case"text":return f.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in f.g)return f.g.mozResponseArrayBuffer}return null}catch{return null}}function a5(f){const y={};f=(f.g&&2<=Ps(f)&&f.g.getAllResponseHeaders()||"").split(`\r
`);for(let T=0;T<f.length;T++){if(_(f[T]))continue;var b=A(f[T]);const D=b[0];if(b=b[1],typeof b!="string")continue;b=b.trim();const L=y[D]||[];y[D]=L,L.push(b)}k(y,function(T){return T.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function ac(f,y,b){return b&&b.internalChannelParams&&b.internalChannelParams[f]||y}function X1(f){this.Aa=0,this.i=[],this.j=new Zl,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=ac("failFast",!1,f),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=ac("baseRetryDelayMs",5e3,f),this.cb=ac("retryDelaySeedMs",1e4,f),this.Wa=ac("forwardChannelMaxRetries",2,f),this.wa=ac("forwardChannelRequestTimeoutMs",2e4,f),this.pa=f&&f.xmlHttpFactory||void 0,this.Xa=f&&f.Tb||void 0,this.Ca=f&&f.useFetchStreams||!1,this.L=void 0,this.J=f&&f.supportsCrossDomainXhr||!1,this.K="",this.h=new N1(f&&f.concurrentRequestLimit),this.Da=new n5,this.P=f&&f.fastHandshake||!1,this.O=f&&f.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=f&&f.Rb||!1,f&&f.xa&&this.j.xa(),f&&f.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&f&&f.detectBufferingProxy||!1,this.ja=void 0,f&&f.longPollingTimeout&&0<f.longPollingTimeout&&(this.ja=f.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=X1.prototype,t.la=8,t.G=1,t.connect=function(f,y,b,T){In(0),this.W=f,this.H=y||{},b&&T!==void 0&&(this.H.OSID=b,this.H.OAID=T),this.F=this.X,this.I=i_(this,null,this.W),kd(this)};function Vp(f){if(Y1(f),f.G==3){var y=f.U++,b=As(f.I);if(Je(b,"SID",f.K),Je(b,"RID",y),Je(b,"TYPE","terminate"),oc(f,b),y=new yi(f,f.j,y),y.L=2,y.v=_d(As(b)),b=!1,l.navigator&&l.navigator.sendBeacon)try{b=l.navigator.sendBeacon(y.v.toString(),"")}catch{}!b&&l.Image&&(new Image().src=y.v,b=!0),b||(y.g=a_(y.j,null),y.g.ea(y.v)),y.F=Date.now(),yd(y)}s_(f)}function jd(f){f.g&&(Hp(f),f.g.cancel(),f.g=null)}function Y1(f){jd(f),f.u&&(l.clearTimeout(f.u),f.u=null),Td(f),f.h.cancel(),f.s&&(typeof f.s=="number"&&l.clearTimeout(f.s),f.s=null)}function kd(f){if(!A1(f.h)&&!f.s){f.s=!0;var y=f.Ga;ge||ee(),H||(ge(),H=!0),K.add(y,f),f.B=0}}function o5(f,y){return P1(f.h)>=f.h.j-(f.s?1:0)?!1:f.s?(f.i=y.D.concat(f.i),!0):f.G==1||f.G==2||f.B>=(f.Va?0:f.Wa)?!1:(f.s=Jl(p(f.Ga,f,y),r_(f,f.B)),f.B++,!0)}t.Ga=function(f){if(this.s)if(this.s=null,this.G==1){if(!f){this.U=Math.floor(1e5*Math.random()),f=this.U++;const D=new yi(this,this.j,f);let L=this.o;if(this.S&&(L?(L=j(L),R(L,this.S)):L=this.S),this.m!==null||this.O||(D.H=L,L=null),this.P)e:{for(var y=0,b=0;b<this.i.length;b++){t:{var T=this.i[b];if("__data__"in T.map&&(T=T.map.__data__,typeof T=="string")){T=T.length;break t}T=void 0}if(T===void 0)break;if(y+=T,4096<y){y=b;break e}if(y===4096||b===this.i.length-1){y=b+1;break e}}y=1e3}else y=1e3;y=Z1(this,D,y),b=As(this.I),Je(b,"RID",f),Je(b,"CVER",22),this.D&&Je(b,"X-HTTP-Session-Id",this.D),oc(this,b),L&&(this.O?y="headers="+encodeURIComponent(String(H1(L)))+"&"+y:this.m&&Bp(b,this.m,L)),zp(this.h,D),this.Ua&&Je(b,"TYPE","init"),this.P?(Je(b,"$req",y),Je(b,"SID","null"),D.T=!0,Dp(D,b,null)):Dp(D,b,y),this.G=2}}else this.G==3&&(f?J1(this,f):this.i.length==0||A1(this.h)||J1(this))};function J1(f,y){var b;y?b=y.l:b=f.U++;const T=As(f.I);Je(T,"SID",f.K),Je(T,"RID",b),Je(T,"AID",f.T),oc(f,T),f.m&&f.o&&Bp(T,f.m,f.o),b=new yi(f,f.j,b,f.B+1),f.m===null&&(b.H=f.o),y&&(f.i=y.D.concat(f.i)),y=Z1(f,b,1e3),b.I=Math.round(.5*f.wa)+Math.round(.5*f.wa*Math.random()),zp(f.h,b),Dp(b,T,y)}function oc(f,y){f.H&&F(f.H,function(b,T){Je(y,T,b)}),f.l&&D1({},function(b,T){Je(y,T,b)})}function Z1(f,y,b){b=Math.min(f.i.length,b);var T=f.l?p(f.l.Na,f.l,f):null;e:{var D=f.i;let L=-1;for(;;){const G=["count="+b];L==-1?0<b?(L=D[0].g,G.push("ofs="+L)):L=0:G.push("ofs="+L);let Ke=!0;for(let Qt=0;Qt<b;Qt++){let $e=D[Qt].g;const cn=D[Qt].map;if($e-=L,0>$e)L=Math.max(0,D[Qt].g-100),Ke=!1;else try{r5(cn,G,"req"+$e+"_")}catch{T&&T(cn)}}if(Ke){T=G.join("&");break e}}}return f=f.i.splice(0,b),y.D=f,T}function e_(f){if(!f.g&&!f.u){f.Y=1;var y=f.Fa;ge||ee(),H||(ge(),H=!0),K.add(y,f),f.v=0}}function Up(f){return f.g||f.u||3<=f.v?!1:(f.Y++,f.u=Jl(p(f.Fa,f),r_(f,f.v)),f.v++,!0)}t.Fa=function(){if(this.u=null,t_(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var f=2*this.R;this.j.info("BP detection timer enabled: "+f),this.A=Jl(p(this.ab,this),f)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,In(10),jd(this),t_(this))};function Hp(f){f.A!=null&&(l.clearTimeout(f.A),f.A=null)}function t_(f){f.g=new yi(f,f.j,"rpc",f.Y),f.m===null&&(f.g.H=f.o),f.g.O=0;var y=As(f.qa);Je(y,"RID","rpc"),Je(y,"SID",f.K),Je(y,"AID",f.T),Je(y,"CI",f.F?"0":"1"),!f.F&&f.ja&&Je(y,"TO",f.ja),Je(y,"TYPE","xmlhttp"),oc(f,y),f.m&&f.o&&Bp(y,f.m,f.o),f.L&&(f.g.I=f.L);var b=f.g;f=f.ia,b.L=1,b.v=_d(As(y)),b.m=null,b.P=!0,I1(b,f)}t.Za=function(){this.C!=null&&(this.C=null,jd(this),Up(this),In(19))};function Td(f){f.C!=null&&(l.clearTimeout(f.C),f.C=null)}function n_(f,y){var b=null;if(f.g==y){Td(f),Hp(f),f.g=null;var T=2}else if($p(f.h,y))b=y.D,F1(f.h,y),T=1;else return;if(f.G!=0){if(y.o)if(T==1){b=y.m?y.m.length:0,y=Date.now()-y.F;var D=f.B;T=pd(),Tn(T,new E1(T,b)),kd(f)}else e_(f);else if(D=y.s,D==3||D==0&&0<y.X||!(T==1&&o5(f,y)||T==2&&Up(f)))switch(b&&0<b.length&&(y=f.h,y.i=y.i.concat(b)),D){case 1:xa(f,5);break;case 4:xa(f,10);break;case 3:xa(f,6);break;default:xa(f,2)}}}function r_(f,y){let b=f.Ta+Math.floor(Math.random()*f.cb);return f.isActive()||(b*=2),b*y}function xa(f,y){if(f.j.info("Error code "+y),y==2){var b=p(f.fb,f),T=f.Xa;const D=!T;T=new ga(T||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||vd(T,"https"),_d(T),D?e5(T.toString(),b):t5(T.toString(),b)}else In(2);f.G=0,f.l&&f.l.sa(y),s_(f),Y1(f)}t.fb=function(f){f?(this.j.info("Successfully pinged google.com"),In(2)):(this.j.info("Failed to ping google.com"),In(1))};function s_(f){if(f.G=0,f.ka=[],f.l){const y=M1(f.h);(y.length!=0||f.i.length!=0)&&(v(f.ka,y),v(f.ka,f.i),f.h.i.length=0,w(f.i),f.i.length=0),f.l.ra()}}function i_(f,y,b){var T=b instanceof ga?As(b):new ga(b);if(T.g!="")y&&(T.g=y+"."+T.g),wd(T,T.s);else{var D=l.location;T=D.protocol,y=y?y+"."+D.hostname:D.hostname,D=+D.port;var L=new ga(null);T&&vd(L,T),y&&(L.g=y),D&&wd(L,D),b&&(L.l=b),T=L}return b=f.D,y=f.ya,b&&y&&Je(T,b,y),Je(T,"VER",f.la),oc(f,T),T}function a_(f,y,b){if(y&&!f.J)throw Error("Can't create secondary domain capable XhrIo object.");return y=f.Ca&&!f.pa?new ft(new Sd({eb:b})):new ft(f.pa),y.Ha(f.J),y}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function o_(){}t=o_.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Id(){}Id.prototype.g=function(f,y){return new nr(f,y)};function nr(f,y){ln.call(this),this.g=new X1(y),this.l=f,this.h=y&&y.messageUrlParams||null,f=y&&y.messageHeaders||null,y&&y.clientProtocolHeaderRequired&&(f?f["X-Client-Protocol"]="webchannel":f={"X-Client-Protocol":"webchannel"}),this.g.o=f,f=y&&y.initMessageHeaders||null,y&&y.messageContentType&&(f?f["X-WebChannel-Content-Type"]=y.messageContentType:f={"X-WebChannel-Content-Type":y.messageContentType}),y&&y.va&&(f?f["X-WebChannel-Client-Profile"]=y.va:f={"X-WebChannel-Client-Profile":y.va}),this.g.S=f,(f=y&&y.Sb)&&!_(f)&&(this.g.m=f),this.v=y&&y.supportsCrossDomainXhr||!1,this.u=y&&y.sendRawJson||!1,(y=y&&y.httpSessionIdParam)&&!_(y)&&(this.g.D=y,f=this.h,f!==null&&y in f&&(f=this.h,y in f&&delete f[y])),this.j=new _o(this)}x(nr,ln),nr.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},nr.prototype.close=function(){Vp(this.g)},nr.prototype.o=function(f){var y=this.g;if(typeof f=="string"){var b={};b.__data__=f,f=b}else this.u&&(b={},b.__data__=Rp(f),f=b);y.i.push(new HA(y.Ya++,f)),y.G==3&&kd(y)},nr.prototype.N=function(){this.g.l=null,delete this.j,Vp(this.g),delete this.g,nr.aa.N.call(this)};function l_(f){Ap.call(this),f.__headers__&&(this.headers=f.__headers__,this.statusCode=f.__status__,delete f.__headers__,delete f.__status__);var y=f.__sm__;if(y){e:{for(const b in y){f=b;break e}f=void 0}(this.i=f)&&(f=this.i,y=y!==null&&f in y?y[f]:void 0),this.data=y}else this.data=f}x(l_,Ap);function c_(){Pp.call(this),this.status=1}x(c_,Pp);function _o(f){this.g=f}x(_o,o_),_o.prototype.ua=function(){Tn(this.g,"a")},_o.prototype.ta=function(f){Tn(this.g,new l_(f))},_o.prototype.sa=function(f){Tn(this.g,new c_)},_o.prototype.ra=function(){Tn(this.g,"b")},Id.prototype.createWebChannel=Id.prototype.g,nr.prototype.send=nr.prototype.o,nr.prototype.open=nr.prototype.m,nr.prototype.close=nr.prototype.close,KT=function(){return new Id},qT=function(){return pd()},WT=ma,gx={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},gd.NO_ERROR=0,gd.TIMEOUT=8,gd.HTTP_ERROR=6,Th=gd,j1.COMPLETE="complete",GT=j1,w1.EventType=Xl,Xl.OPEN="a",Xl.CLOSE="b",Xl.ERROR="c",Xl.MESSAGE="d",ln.prototype.listen=ln.prototype.K,Ec=w1,ft.prototype.listenOnce=ft.prototype.L,ft.prototype.getLastError=ft.prototype.Ka,ft.prototype.getLastErrorCode=ft.prototype.Ba,ft.prototype.getStatus=ft.prototype.Z,ft.prototype.getResponseJson=ft.prototype.Oa,ft.prototype.getResponseText=ft.prototype.oa,ft.prototype.send=ft.prototype.ea,ft.prototype.setWithCredentials=ft.prototype.Ha,HT=ft}).apply(typeof qd<"u"?qd:typeof self<"u"?self:typeof window<"u"?window:{});const JS="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}pn.UNAUTHENTICATED=new pn(null),pn.GOOGLE_CREDENTIALS=new pn("google-credentials-uid"),pn.FIRST_PARTY=new pn("first-party-uid"),pn.MOCK_USER=new pn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Dl="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ha=new kv("@firebase/firestore");function xc(){return Ha.logLevel}function J(t,...e){if(Ha.logLevel<=Fe.DEBUG){const n=e.map(Cv);Ha.debug(`Firestore (${Dl}): ${t}`,...n)}}function ri(t,...e){if(Ha.logLevel<=Fe.ERROR){const n=e.map(Cv);Ha.error(`Firestore (${Dl}): ${t}`,...n)}}function fl(t,...e){if(Ha.logLevel<=Fe.WARN){const n=e.map(Cv);Ha.warn(`Firestore (${Dl}): ${t}`,...n)}}function Cv(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function me(t="Unexpected state"){const e=`FIRESTORE (${Dl}) INTERNAL ASSERTION FAILED: `+t;throw ri(e),new Error(e)}function Ge(t,e){t||me()}function Se(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class W extends di{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ks{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QT{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class EO{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(pn.UNAUTHENTICATED))}shutdown(){}}class jO{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class kO{constructor(e){this.t=e,this.currentUser=pn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Ge(this.o===void 0);let r=this.i;const s=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve();let i=new Ks;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Ks,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const c=i;e.enqueueRetryable(async()=>{await c.promise,await s(this.currentUser)})},l=c=>{J("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>l(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?l(c):(J("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Ks)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(J("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Ge(typeof r.accessToken=="string"),new QT(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ge(e===null||typeof e=="string"),new pn(e)}}class TO{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=pn.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class IO{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new TO(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(pn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class CO{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class RO{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){Ge(this.o===void 0);const r=i=>{i.error!=null&&J("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.R;return this.R=i.token,J("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{J("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):J("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Ge(typeof n.token=="string"),this.R=n.token,new CO(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NO(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XT{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=NO(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%e.length))}return r}}function ze(t,e){return t<e?-1:t>e?1:0}function ml(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tt{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new W($.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new W($.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new W($.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new W($.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Tt.fromMillis(Date.now())}static fromDate(e){return Tt.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new Tt(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ze(this.nanoseconds,e.nanoseconds):ze(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _e{constructor(e){this.timestamp=e}static fromTimestamp(e){return new _e(e)}static min(){return new _e(new Tt(0,0))}static max(){return new _e(new Tt(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class du{constructor(e,n,r){n===void 0?n=0:n>e.length&&me(),r===void 0?r=e.length-n:r>e.length-n&&me(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return du.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof du?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=e.get(s),o=n.get(s);if(i<o)return-1;if(i>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class Xe extends du{construct(e,n,r){return new Xe(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new W($.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new Xe(n)}static emptyPath(){return new Xe([])}}const AO=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class en extends du{construct(e,n,r){return new en(e,n,r)}static isValidIdentifier(e){return AO.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),en.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new en(["__name__"])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new W($.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const l=e[s];if(l==="\\"){if(s+1===e.length)throw new W($.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[s+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new W($.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,s+=2}else l==="`"?(o=!o,s++):l!=="."||o?(r+=l,s++):(i(),s++)}if(i(),o)throw new W($.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new en(n)}static emptyPath(){return new en([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ae{constructor(e){this.path=e}static fromPath(e){return new ae(Xe.fromString(e))}static fromName(e){return new ae(Xe.fromString(e).popFirst(5))}static empty(){return new ae(Xe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Xe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Xe.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ae(new Xe(e.slice()))}}function PO(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=_e.fromTimestamp(r===1e9?new Tt(n+1,0):new Tt(n,r));return new Ji(s,ae.empty(),e)}function FO(t){return new Ji(t.readTime,t.key,-1)}class Ji{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Ji(_e.min(),ae.empty(),-1)}static max(){return new Ji(_e.max(),ae.empty(),-1)}}function MO(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=ae.comparator(t.documentKey,e.documentKey),n!==0?n:ze(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DO="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class LO{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Bu(t){if(t.code!==$.FAILED_PRECONDITION||t.message!==DO)throw t;J("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&me(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new V((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof V?n:V.resolve(n)}catch(n){return V.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):V.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):V.reject(n)}static resolve(e){return new V((n,r)=>{n(e)})}static reject(e){return new V((n,r)=>{r(e)})}static waitFor(e){return new V((n,r)=>{let s=0,i=0,o=!1;e.forEach(l=>{++s,l.next(()=>{++i,o&&i===s&&n()},c=>r(c))}),o=!0,i===s&&n()})}static or(e){let n=V.resolve(!1);for(const r of e)n=n.next(s=>s?V.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new V((r,s)=>{const i=e.length,o=new Array(i);let l=0;for(let c=0;c<i;c++){const u=c;n(e[u]).next(d=>{o[u]=d,++l,l===i&&r(o)},d=>s(d))}})}static doWhile(e,n){return new V((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}function OO(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Vu(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rv{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Rv.oe=-1;function Cm(t){return t==null}function wf(t){return t===0&&1/t==-1/0}function $O(t){return typeof t=="number"&&Number.isInteger(t)&&!wf(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZS(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function lo(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function YT(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dt{constructor(e,n){this.comparator=e,this.root=n||Zt.EMPTY}insert(e,n){return new dt(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Zt.BLACK,null,null))}remove(e){return new dt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Zt.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Kd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Kd(this.root,e,this.comparator,!1)}getReverseIterator(){return new Kd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Kd(this.root,e,this.comparator,!0)}}class Kd{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Zt{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??Zt.RED,this.left=s??Zt.EMPTY,this.right=i??Zt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new Zt(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Zt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return Zt.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Zt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Zt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw me();const e=this.left.check();if(e!==this.right.check())throw me();return e+(this.isRed()?0:1)}}Zt.EMPTY=null,Zt.RED=!0,Zt.BLACK=!1;Zt.EMPTY=new class{constructor(){this.size=0}get key(){throw me()}get value(){throw me()}get color(){throw me()}get left(){throw me()}get right(){throw me()}copy(e,n,r,s,i){return this}insert(e,n,r){return new Zt(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nn{constructor(e){this.comparator=e,this.data=new dt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new eb(this.data.getIterator())}getIteratorFrom(e){return new eb(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof nn)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new nn(this.comparator);return n.data=e,n}}class eb{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dr{constructor(e){this.fields=e,e.sort(en.comparator)}static empty(){return new dr([])}unionWith(e){let n=new nn(en.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new dr(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return ml(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JT extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sn{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new JT("Invalid base64 string: "+i):i}}(e);return new sn(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new sn(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ze(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}sn.EMPTY_BYTE_STRING=new sn("");const zO=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Zi(t){if(Ge(!!t),typeof t=="string"){let e=0;const n=zO.exec(t);if(Ge(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:xt(t.seconds),nanos:xt(t.nanos)}}function xt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Ga(t){return typeof t=="string"?sn.fromBase64String(t):sn.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rm(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function Nv(t){const e=t.mapValue.fields.__previous_value__;return Rm(e)?Nv(e):e}function hu(t){const e=Zi(t.mapValue.fields.__local_write_time__.timestampValue);return new Tt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BO{constructor(e,n,r,s,i,o,l,c,u){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=u}}class fu{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new fu("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof fu&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qd={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Wa(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Rm(t)?4:UO(t)?9007199254740991:VO(t)?10:11:me()}function Es(t,e){if(t===e)return!0;const n=Wa(t);if(n!==Wa(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return hu(t).isEqual(hu(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=Zi(s.timestampValue),l=Zi(i.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return Ga(s.bytesValue).isEqual(Ga(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return xt(s.geoPointValue.latitude)===xt(i.geoPointValue.latitude)&&xt(s.geoPointValue.longitude)===xt(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return xt(s.integerValue)===xt(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=xt(s.doubleValue),l=xt(i.doubleValue);return o===l?wf(o)===wf(l):isNaN(o)&&isNaN(l)}return!1}(t,e);case 9:return ml(t.arrayValue.values||[],e.arrayValue.values||[],Es);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},l=i.mapValue.fields||{};if(ZS(o)!==ZS(l))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(l[c]===void 0||!Es(o[c],l[c])))return!1;return!0}(t,e);default:return me()}}function mu(t,e){return(t.values||[]).find(n=>Es(n,e))!==void 0}function pl(t,e){if(t===e)return 0;const n=Wa(t),r=Wa(e);if(n!==r)return ze(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return ze(t.booleanValue,e.booleanValue);case 2:return function(i,o){const l=xt(i.integerValue||i.doubleValue),c=xt(o.integerValue||o.doubleValue);return l<c?-1:l>c?1:l===c?0:isNaN(l)?isNaN(c)?0:-1:1}(t,e);case 3:return tb(t.timestampValue,e.timestampValue);case 4:return tb(hu(t),hu(e));case 5:return ze(t.stringValue,e.stringValue);case 6:return function(i,o){const l=Ga(i),c=Ga(o);return l.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const l=i.split("/"),c=o.split("/");for(let u=0;u<l.length&&u<c.length;u++){const d=ze(l[u],c[u]);if(d!==0)return d}return ze(l.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const l=ze(xt(i.latitude),xt(o.latitude));return l!==0?l:ze(xt(i.longitude),xt(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return nb(t.arrayValue,e.arrayValue);case 10:return function(i,o){var l,c,u,d;const m=i.fields||{},p=o.fields||{},g=(l=m.value)===null||l===void 0?void 0:l.arrayValue,x=(c=p.value)===null||c===void 0?void 0:c.arrayValue,w=ze(((u=g==null?void 0:g.values)===null||u===void 0?void 0:u.length)||0,((d=x==null?void 0:x.values)===null||d===void 0?void 0:d.length)||0);return w!==0?w:nb(g,x)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===Qd.mapValue&&o===Qd.mapValue)return 0;if(i===Qd.mapValue)return 1;if(o===Qd.mapValue)return-1;const l=i.fields||{},c=Object.keys(l),u=o.fields||{},d=Object.keys(u);c.sort(),d.sort();for(let m=0;m<c.length&&m<d.length;++m){const p=ze(c[m],d[m]);if(p!==0)return p;const g=pl(l[c[m]],u[d[m]]);if(g!==0)return g}return ze(c.length,d.length)}(t.mapValue,e.mapValue);default:throw me()}}function tb(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return ze(t,e);const n=Zi(t),r=Zi(e),s=ze(n.seconds,r.seconds);return s!==0?s:ze(n.nanos,r.nanos)}function nb(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=pl(n[s],r[s]);if(i)return i}return ze(n.length,r.length)}function gl(t){return xx(t)}function xx(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Zi(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Ga(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return ae.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=xx(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${xx(n.fields[o])}`;return s+"}"}(t.mapValue):me()}function _f(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function yx(t){return!!t&&"integerValue"in t}function Av(t){return!!t&&"arrayValue"in t}function rb(t){return!!t&&"nullValue"in t}function sb(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Ih(t){return!!t&&"mapValue"in t}function VO(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function $c(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return lo(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=$c(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=$c(t.arrayValue.values[n]);return e}return Object.assign({},t)}function UO(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kn{constructor(e){this.value=e}static empty(){return new Kn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Ih(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=$c(n)}setAll(e){let n=en.emptyPath(),r={},s=[];e.forEach((o,l)=>{if(!n.isImmediateParentOf(l)){const c=this.getFieldsMap(n);this.applyChanges(c,r,s),r={},s=[],n=l.popLast()}o?r[l.lastSegment()]=$c(o):s.push(l.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());Ih(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Es(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];Ih(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){lo(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new Kn($c(this.value))}}function ZT(t){const e=[];return lo(t.fields,(n,r)=>{const s=new en([n]);if(Ih(r)){const i=ZT(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new dr(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xn{constructor(e,n,r,s,i,o,l){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=l}static newInvalidDocument(e){return new xn(e,0,_e.min(),_e.min(),_e.min(),Kn.empty(),0)}static newFoundDocument(e,n,r,s){return new xn(e,1,n,_e.min(),r,s,0)}static newNoDocument(e,n){return new xn(e,2,n,_e.min(),_e.min(),Kn.empty(),0)}static newUnknownDocument(e,n){return new xn(e,3,n,_e.min(),_e.min(),Kn.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(_e.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Kn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Kn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=_e.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof xn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new xn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xl{constructor(e,n){this.position=e,this.inclusive=n}}function ib(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=ae.comparator(ae.fromName(o.referenceValue),n.key):r=pl(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function ab(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Es(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pu{constructor(e,n="asc"){this.field=e,this.dir=n}}function HO(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eI{}class kt extends eI{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new WO(e,n,r):n==="array-contains"?new QO(e,r):n==="in"?new XO(e,r):n==="not-in"?new YO(e,r):n==="array-contains-any"?new JO(e,r):new kt(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new qO(e,r):new KO(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(pl(n,this.value)):n!==null&&Wa(this.value)===Wa(n)&&this.matchesComparison(pl(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return me()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ns extends eI{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new ns(e,n)}matches(e){return tI(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function tI(t){return t.op==="and"}function nI(t){return GO(t)&&tI(t)}function GO(t){for(const e of t.filters)if(e instanceof ns)return!1;return!0}function vx(t){if(t instanceof kt)return t.field.canonicalString()+t.op.toString()+gl(t.value);if(nI(t))return t.filters.map(e=>vx(e)).join(",");{const e=t.filters.map(n=>vx(n)).join(",");return`${t.op}(${e})`}}function rI(t,e){return t instanceof kt?function(r,s){return s instanceof kt&&r.op===s.op&&r.field.isEqual(s.field)&&Es(r.value,s.value)}(t,e):t instanceof ns?function(r,s){return s instanceof ns&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,l)=>i&&rI(o,s.filters[l]),!0):!1}(t,e):void me()}function sI(t){return t instanceof kt?function(n){return`${n.field.canonicalString()} ${n.op} ${gl(n.value)}`}(t):t instanceof ns?function(n){return n.op.toString()+" {"+n.getFilters().map(sI).join(" ,")+"}"}(t):"Filter"}class WO extends kt{constructor(e,n,r){super(e,n,r),this.key=ae.fromName(r.referenceValue)}matches(e){const n=ae.comparator(e.key,this.key);return this.matchesComparison(n)}}class qO extends kt{constructor(e,n){super(e,"in",n),this.keys=iI("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class KO extends kt{constructor(e,n){super(e,"not-in",n),this.keys=iI("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function iI(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>ae.fromName(r.referenceValue))}class QO extends kt{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Av(n)&&mu(n.arrayValue,this.value)}}class XO extends kt{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&mu(this.value.arrayValue,n)}}class YO extends kt{constructor(e,n){super(e,"not-in",n)}matches(e){if(mu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!mu(this.value.arrayValue,n)}}class JO extends kt{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Av(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>mu(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZO{constructor(e,n=null,r=[],s=[],i=null,o=null,l=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=l,this.ue=null}}function ob(t,e=null,n=[],r=[],s=null,i=null,o=null){return new ZO(t,e,n,r,s,i,o)}function Pv(t){const e=Se(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>vx(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),Cm(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>gl(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>gl(r)).join(",")),e.ue=n}return e.ue}function Fv(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!HO(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!rI(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!ab(t.startAt,e.startAt)&&ab(t.endAt,e.endAt)}function wx(t){return ae.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class co{constructor(e,n=null,r=[],s=[],i=null,o="F",l=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=l,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function e7(t,e,n,r,s,i,o,l){return new co(t,e,n,r,s,i,o,l)}function Mv(t){return new co(t)}function lb(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function Dv(t){return t.collectionGroup!==null}function Zo(t){const e=Se(t);if(e.ce===null){e.ce=[];const n=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new nn(en.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(u=>{u.isInequality()&&(l=l.add(u.field))})}),l})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.ce.push(new pu(i,r))}),n.has(en.keyField().canonicalString())||e.ce.push(new pu(en.keyField(),r))}return e.ce}function _s(t){const e=Se(t);return e.le||(e.le=t7(e,Zo(t))),e.le}function t7(t,e){if(t.limitType==="F")return ob(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new pu(s.field,i)});const n=t.endAt?new xl(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new xl(t.startAt.position,t.startAt.inclusive):null;return ob(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function _x(t,e){const n=t.filters.concat([e]);return new co(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Sf(t,e,n){return new co(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Nm(t,e){return Fv(_s(t),_s(e))&&t.limitType===e.limitType}function aI(t){return`${Pv(_s(t))}|lt:${t.limitType}`}function Co(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>sI(s)).join(", ")}]`),Cm(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>gl(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>gl(s)).join(",")),`Target(${r})`}(_s(t))}; limitType=${t.limitType})`}function Am(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):ae.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of Zo(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,l,c){const u=ib(o,l,c);return o.inclusive?u<=0:u<0}(r.startAt,Zo(r),s)||r.endAt&&!function(o,l,c){const u=ib(o,l,c);return o.inclusive?u>=0:u>0}(r.endAt,Zo(r),s))}(t,e)}function n7(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function oI(t){return(e,n)=>{let r=!1;for(const s of Zo(t)){const i=r7(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function r7(t,e,n){const r=t.field.isKeyField()?ae.comparator(e.key,n.key):function(i,o,l){const c=o.data.field(i),u=l.data.field(i);return c!==null&&u!==null?pl(c,u):me()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return me()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ll{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){lo(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return YT(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s7=new dt(ae.comparator);function si(){return s7}const lI=new dt(ae.comparator);function jc(...t){let e=lI;for(const n of t)e=e.insert(n.key,n);return e}function cI(t){let e=lI;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Na(){return zc()}function uI(){return zc()}function zc(){return new Ll(t=>t.toString(),(t,e)=>t.isEqual(e))}const i7=new dt(ae.comparator),a7=new nn(ae.comparator);function Ne(...t){let e=a7;for(const n of t)e=e.add(n);return e}const o7=new nn(ze);function l7(){return o7}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lv(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:wf(e)?"-0":e}}function dI(t){return{integerValue:""+t}}function hI(t,e){return $O(e)?dI(e):Lv(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pm{constructor(){this._=void 0}}function c7(t,e,n){return t instanceof gu?function(s,i){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&Rm(i)&&(i=Nv(i)),i&&(o.fields.__previous_value__=i),{mapValue:o}}(n,e):t instanceof xu?mI(t,e):t instanceof yu?pI(t,e):function(s,i){const o=fI(s,i),l=cb(o)+cb(s.Pe);return yx(o)&&yx(s.Pe)?dI(l):Lv(s.serializer,l)}(t,e)}function u7(t,e,n){return t instanceof xu?mI(t,e):t instanceof yu?pI(t,e):n}function fI(t,e){return t instanceof vu?function(r){return yx(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class gu extends Pm{}class xu extends Pm{constructor(e){super(),this.elements=e}}function mI(t,e){const n=gI(e);for(const r of t.elements)n.some(s=>Es(s,r))||n.push(r);return{arrayValue:{values:n}}}class yu extends Pm{constructor(e){super(),this.elements=e}}function pI(t,e){let n=gI(e);for(const r of t.elements)n=n.filter(s=>!Es(s,r));return{arrayValue:{values:n}}}class vu extends Pm{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function cb(t){return xt(t.integerValue||t.doubleValue)}function gI(t){return Av(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xI{constructor(e,n){this.field=e,this.transform=n}}function d7(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof xu&&s instanceof xu||r instanceof yu&&s instanceof yu?ml(r.elements,s.elements,Es):r instanceof vu&&s instanceof vu?Es(r.Pe,s.Pe):r instanceof gu&&s instanceof gu}(t.transform,e.transform)}class h7{constructor(e,n){this.version=e,this.transformResults=n}}class Pn{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Pn}static exists(e){return new Pn(void 0,e)}static updateTime(e){return new Pn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ch(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Fm{}function yI(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Mm(t.key,Pn.none()):new Uu(t.key,t.data,Pn.none());{const n=t.data,r=Kn.empty();let s=new nn(en.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new ca(t.key,r,new dr(s.toArray()),Pn.none())}}function f7(t,e,n){t instanceof Uu?function(s,i,o){const l=s.value.clone(),c=db(s.fieldTransforms,i,o.transformResults);l.setAll(c),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):t instanceof ca?function(s,i,o){if(!Ch(s.precondition,i))return void i.convertToUnknownDocument(o.version);const l=db(s.fieldTransforms,i,o.transformResults),c=i.data;c.setAll(vI(s)),c.setAll(l),i.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function Bc(t,e,n,r){return t instanceof Uu?function(i,o,l,c){if(!Ch(i.precondition,o))return l;const u=i.value.clone(),d=hb(i.fieldTransforms,c,o);return u.setAll(d),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(t,e,n,r):t instanceof ca?function(i,o,l,c){if(!Ch(i.precondition,o))return l;const u=hb(i.fieldTransforms,c,o),d=o.data;return d.setAll(vI(i)),d.setAll(u),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),l===null?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(m=>m.field))}(t,e,n,r):function(i,o,l){return Ch(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(t,e,n)}function m7(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=fI(r.transform,s||null);i!=null&&(n===null&&(n=Kn.empty()),n.set(r.field,i))}return n||null}function ub(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&ml(r,s,(i,o)=>d7(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Uu extends Fm{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class ca extends Fm{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function vI(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function db(t,e,n){const r=new Map;Ge(t.length===n.length);for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,l=e.data.field(i.field);r.set(i.field,u7(o,l,n[s]))}return r}function hb(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,c7(i,o,e))}return r}class Mm extends Fm{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class p7 extends Fm{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g7{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&f7(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Bc(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Bc(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=uI();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let l=this.applyToLocalView(o,i.mutatedFields);l=n.has(s.key)?null:l;const c=yI(o,l);c!==null&&r.set(s.key,c),o.isValidDocument()||o.convertToNoDocument(_e.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Ne())}isEqual(e){return this.batchId===e.batchId&&ml(this.mutations,e.mutations,(n,r)=>ub(n,r))&&ml(this.baseMutations,e.baseMutations,(n,r)=>ub(n,r))}}class Ov{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){Ge(e.mutations.length===r.length);let s=function(){return i7}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new Ov(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x7{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y7{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Et,De;function v7(t){switch(t){default:return me();case $.CANCELLED:case $.UNKNOWN:case $.DEADLINE_EXCEEDED:case $.RESOURCE_EXHAUSTED:case $.INTERNAL:case $.UNAVAILABLE:case $.UNAUTHENTICATED:return!1;case $.INVALID_ARGUMENT:case $.NOT_FOUND:case $.ALREADY_EXISTS:case $.PERMISSION_DENIED:case $.FAILED_PRECONDITION:case $.ABORTED:case $.OUT_OF_RANGE:case $.UNIMPLEMENTED:case $.DATA_LOSS:return!0}}function wI(t){if(t===void 0)return ri("GRPC error has no .code"),$.UNKNOWN;switch(t){case Et.OK:return $.OK;case Et.CANCELLED:return $.CANCELLED;case Et.UNKNOWN:return $.UNKNOWN;case Et.DEADLINE_EXCEEDED:return $.DEADLINE_EXCEEDED;case Et.RESOURCE_EXHAUSTED:return $.RESOURCE_EXHAUSTED;case Et.INTERNAL:return $.INTERNAL;case Et.UNAVAILABLE:return $.UNAVAILABLE;case Et.UNAUTHENTICATED:return $.UNAUTHENTICATED;case Et.INVALID_ARGUMENT:return $.INVALID_ARGUMENT;case Et.NOT_FOUND:return $.NOT_FOUND;case Et.ALREADY_EXISTS:return $.ALREADY_EXISTS;case Et.PERMISSION_DENIED:return $.PERMISSION_DENIED;case Et.FAILED_PRECONDITION:return $.FAILED_PRECONDITION;case Et.ABORTED:return $.ABORTED;case Et.OUT_OF_RANGE:return $.OUT_OF_RANGE;case Et.UNIMPLEMENTED:return $.UNIMPLEMENTED;case Et.DATA_LOSS:return $.DATA_LOSS;default:return me()}}(De=Et||(Et={}))[De.OK=0]="OK",De[De.CANCELLED=1]="CANCELLED",De[De.UNKNOWN=2]="UNKNOWN",De[De.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",De[De.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",De[De.NOT_FOUND=5]="NOT_FOUND",De[De.ALREADY_EXISTS=6]="ALREADY_EXISTS",De[De.PERMISSION_DENIED=7]="PERMISSION_DENIED",De[De.UNAUTHENTICATED=16]="UNAUTHENTICATED",De[De.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",De[De.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",De[De.ABORTED=10]="ABORTED",De[De.OUT_OF_RANGE=11]="OUT_OF_RANGE",De[De.UNIMPLEMENTED=12]="UNIMPLEMENTED",De[De.INTERNAL=13]="INTERNAL",De[De.UNAVAILABLE=14]="UNAVAILABLE",De[De.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w7(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _7=new Ma([4294967295,4294967295],0);function fb(t){const e=w7().encode(t),n=new UT;return n.update(e),new Uint8Array(n.digest())}function mb(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Ma([n,r],0),new Ma([s,i],0)]}class $v{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new kc(`Invalid padding: ${n}`);if(r<0)throw new kc(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new kc(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new kc(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=Ma.fromNumber(this.Ie)}Ee(e,n,r){let s=e.add(n.multiply(Ma.fromNumber(r)));return s.compare(_7)===1&&(s=new Ma([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=fb(e),[r,s]=mb(n);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);if(!this.de(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new $v(i,s,n);return r.forEach(l=>o.insert(l)),o}insert(e){if(this.Ie===0)return;const n=fb(e),[r,s]=mb(n);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);this.Ae(o)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class kc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dm{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,Hu.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Dm(_e.min(),s,new dt(ze),si(),Ne())}}class Hu{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Hu(r,n,Ne(),Ne(),Ne())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rh{constructor(e,n,r,s){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=s}}class _I{constructor(e,n){this.targetId=e,this.me=n}}class SI{constructor(e,n,r=sn.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class pb{constructor(){this.fe=0,this.ge=xb(),this.pe=sn.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Ne(),n=Ne(),r=Ne();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:me()}}),new Hu(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=xb()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Ge(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class S7{constructor(e){this.Le=e,this.Be=new Map,this.ke=si(),this.qe=gb(),this.Qe=new dt(ze)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:me()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,s)=>{this.ze(s)&&n(s)})}He(e){const n=e.targetId,r=e.me.count,s=this.Je(n);if(s){const i=s.target;if(wx(i))if(r===0){const o=new ae(i.path);this.Ue(n,o,xn.newNoDocument(o,_e.min()))}else Ge(r===1);else{const o=this.Ye(n);if(o!==r){const l=this.Ze(e),c=l?this.Xe(l,e,o):1;if(c!==0){this.je(n);const u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,u)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,l;try{o=Ga(r).toUint8Array()}catch(c){if(c instanceof JT)return fl("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{l=new $v(o,s,i)}catch(c){return fl(c instanceof kc?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return l.Ie===0?null:l}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.Le.tt(),l=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(l)||(this.Ue(n,i,null),s++)}),s}rt(e){const n=new Map;this.Be.forEach((i,o)=>{const l=this.Je(o);if(l){if(i.current&&wx(l.target)){const c=new ae(l.target.path);this.ke.get(c)!==null||this.it(o,c)||this.Ue(o,c,xn.newNoDocument(c,e))}i.be&&(n.set(o,i.ve()),i.Ce())}});let r=Ne();this.qe.forEach((i,o)=>{let l=!0;o.forEachWhile(c=>{const u=this.Je(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(i))}),this.ke.forEach((i,o)=>o.setReadTime(e));const s=new Dm(e,n,this.Qe,this.ke,r);return this.ke=si(),this.qe=gb(),this.Qe=new dt(ze),s}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,n)?s.Fe(n,1):s.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new pb,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new nn(ze),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||J("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new pb),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function gb(){return new dt(ae.comparator)}function xb(){return new dt(ae.comparator)}const b7=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),E7=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),j7=(()=>({and:"AND",or:"OR"}))();class k7{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Sx(t,e){return t.useProto3Json||Cm(e)?e:{value:e}}function bf(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function bI(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function T7(t,e){return bf(t,e.toTimestamp())}function Ss(t){return Ge(!!t),_e.fromTimestamp(function(n){const r=Zi(n);return new Tt(r.seconds,r.nanos)}(t))}function zv(t,e){return bx(t,e).canonicalString()}function bx(t,e){const n=function(s){return new Xe(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function EI(t){const e=Xe.fromString(t);return Ge(CI(e)),e}function Ex(t,e){return zv(t.databaseId,e.path)}function Tg(t,e){const n=EI(e);if(n.get(1)!==t.databaseId.projectId)throw new W($.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new W($.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new ae(kI(n))}function jI(t,e){return zv(t.databaseId,e)}function I7(t){const e=EI(t);return e.length===4?Xe.emptyPath():kI(e)}function jx(t){return new Xe(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function kI(t){return Ge(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function yb(t,e,n){return{name:Ex(t,e),fields:n.value.mapValue.fields}}function C7(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:me()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(u,d){return u.useProto3Json?(Ge(d===void 0||typeof d=="string"),sn.fromBase64String(d||"")):(Ge(d===void 0||d instanceof Buffer||d instanceof Uint8Array),sn.fromUint8Array(d||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(u){const d=u.code===void 0?$.UNKNOWN:wI(u.code);return new W(d,u.message||"")}(o);n=new SI(r,s,i,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=Tg(t,r.document.name),i=Ss(r.document.updateTime),o=r.document.createTime?Ss(r.document.createTime):_e.min(),l=new Kn({mapValue:{fields:r.document.fields}}),c=xn.newFoundDocument(s,i,o,l),u=r.targetIds||[],d=r.removedTargetIds||[];n=new Rh(u,d,c.key,c)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=Tg(t,r.document),i=r.readTime?Ss(r.readTime):_e.min(),o=xn.newNoDocument(s,i),l=r.removedTargetIds||[];n=new Rh([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=Tg(t,r.document),i=r.removedTargetIds||[];n=new Rh([],i,s,null)}else{if(!("filter"in e))return me();{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new y7(s,i),l=r.targetId;n=new _I(l,o)}}return n}function R7(t,e){let n;if(e instanceof Uu)n={update:yb(t,e.key,e.value)};else if(e instanceof Mm)n={delete:Ex(t,e.key)};else if(e instanceof ca)n={update:yb(t,e.key,e.data),updateMask:$7(e.fieldMask)};else{if(!(e instanceof p7))return me();n={verify:Ex(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const l=o.transform;if(l instanceof gu)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof xu)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof yu)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof vu)return{fieldPath:o.field.canonicalString(),increment:l.Pe};throw me()}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:T7(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:me()}(t,e.precondition)),n}function N7(t,e){return t&&t.length>0?(Ge(e!==void 0),t.map(n=>function(s,i){let o=s.updateTime?Ss(s.updateTime):Ss(i);return o.isEqual(_e.min())&&(o=Ss(i)),new h7(o,s.transformResults||[])}(n,e))):[]}function A7(t,e){return{documents:[jI(t,e.path)]}}function P7(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=jI(t,s);const i=function(u){if(u.length!==0)return II(ns.create(u,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(u){if(u.length!==0)return u.map(d=>function(p){return{field:Ro(p.field),direction:D7(p.dir)}}(d))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const l=Sx(t,e.limit);return l!==null&&(n.structuredQuery.limit=l),e.startAt&&(n.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{_t:n,parent:s}}function F7(t){let e=I7(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){Ge(r===1);const d=n.from[0];d.allDescendants?s=d.collectionId:e=e.child(d.collectionId)}let i=[];n.where&&(i=function(m){const p=TI(m);return p instanceof ns&&nI(p)?p.getFilters():[p]}(n.where));let o=[];n.orderBy&&(o=function(m){return m.map(p=>function(x){return new pu(No(x.field),function(v){switch(v){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(x.direction))}(p))}(n.orderBy));let l=null;n.limit&&(l=function(m){let p;return p=typeof m=="object"?m.value:m,Cm(p)?null:p}(n.limit));let c=null;n.startAt&&(c=function(m){const p=!!m.before,g=m.values||[];return new xl(g,p)}(n.startAt));let u=null;return n.endAt&&(u=function(m){const p=!m.before,g=m.values||[];return new xl(g,p)}(n.endAt)),e7(e,s,o,i,l,"F",c,u)}function M7(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return me()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function TI(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=No(n.unaryFilter.field);return kt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=No(n.unaryFilter.field);return kt.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=No(n.unaryFilter.field);return kt.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=No(n.unaryFilter.field);return kt.create(o,"!=",{nullValue:"NULL_VALUE"});default:return me()}}(t):t.fieldFilter!==void 0?function(n){return kt.create(No(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return me()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return ns.create(n.compositeFilter.filters.map(r=>TI(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return me()}}(n.compositeFilter.op))}(t):me()}function D7(t){return b7[t]}function L7(t){return E7[t]}function O7(t){return j7[t]}function Ro(t){return{fieldPath:t.canonicalString()}}function No(t){return en.fromServerFormat(t.fieldPath)}function II(t){return t instanceof kt?function(n){if(n.op==="=="){if(sb(n.value))return{unaryFilter:{field:Ro(n.field),op:"IS_NAN"}};if(rb(n.value))return{unaryFilter:{field:Ro(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(sb(n.value))return{unaryFilter:{field:Ro(n.field),op:"IS_NOT_NAN"}};if(rb(n.value))return{unaryFilter:{field:Ro(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ro(n.field),op:L7(n.op),value:n.value}}}(t):t instanceof ns?function(n){const r=n.getFilters().map(s=>II(s));return r.length===1?r[0]:{compositeFilter:{op:O7(n.op),filters:r}}}(t):me()}function $7(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function CI(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mi{constructor(e,n,r,s,i=_e.min(),o=_e.min(),l=sn.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(e){return new Mi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Mi(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Mi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Mi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z7{constructor(e){this.ct=e}}function B7(t){const e=F7({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Sf(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V7{constructor(){this.un=new U7}addToCollectionParentIndex(e,n){return this.un.add(n),V.resolve()}getCollectionParents(e,n){return V.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return V.resolve()}deleteFieldIndex(e,n){return V.resolve()}deleteAllFieldIndexes(e){return V.resolve()}createTargetIndexes(e,n){return V.resolve()}getDocumentsMatchingTarget(e,n){return V.resolve(null)}getIndexType(e,n){return V.resolve(0)}getFieldIndexes(e,n){return V.resolve([])}getNextCollectionGroupToUpdate(e){return V.resolve(null)}getMinOffset(e,n){return V.resolve(Ji.min())}getMinOffsetFromCollectionGroup(e,n){return V.resolve(Ji.min())}updateCollectionGroup(e,n,r){return V.resolve()}updateIndexEntries(e,n){return V.resolve()}}class U7{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new nn(Xe.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new nn(Xe.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yl{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new yl(0)}static kn(){return new yl(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H7{constructor(){this.changes=new Ll(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,xn.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?V.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G7{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W7{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&Bc(r.mutation,s,dr.empty(),Tt.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Ne()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Ne()){const s=Na();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=jc();return i.forEach((l,c)=>{o=o.insert(l,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=Na();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Ne()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,l)=>{n.set(o,l)})})}computeViews(e,n,r,s){let i=si();const o=zc(),l=function(){return zc()}();return n.forEach((c,u)=>{const d=r.get(u.key);s.has(u.key)&&(d===void 0||d.mutation instanceof ca)?i=i.insert(u.key,u):d!==void 0?(o.set(u.key,d.mutation.getFieldMask()),Bc(d.mutation,u,d.mutation.getFieldMask(),Tt.now())):o.set(u.key,dr.empty())}),this.recalculateAndSaveOverlays(e,i).next(c=>(c.forEach((u,d)=>o.set(u,d)),n.forEach((u,d)=>{var m;return l.set(u,new G7(d,(m=o.get(u))!==null&&m!==void 0?m:null))}),l))}recalculateAndSaveOverlays(e,n){const r=zc();let s=new dt((o,l)=>o-l),i=Ne();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const l of o)l.keys().forEach(c=>{const u=n.get(c);if(u===null)return;let d=r.get(c)||dr.empty();d=l.applyToLocalView(u,d),r.set(c,d);const m=(s.get(l.batchId)||Ne()).add(c);s=s.insert(l.batchId,m)})}).next(()=>{const o=[],l=s.getReverseIterator();for(;l.hasNext();){const c=l.getNext(),u=c.key,d=c.value,m=uI();d.forEach(p=>{if(!i.has(p)){const g=yI(n.get(p),r.get(p));g!==null&&m.set(p,g),i=i.add(p)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,m))}return V.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(o){return ae.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):Dv(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):V.resolve(Na());let l=-1,c=i;return o.next(u=>V.forEach(u,(d,m)=>(l<m.largestBatchId&&(l=m.largestBatchId),i.get(d)?V.resolve():this.remoteDocumentCache.getEntry(e,d).next(p=>{c=c.insert(d,p)}))).next(()=>this.populateOverlays(e,u,i)).next(()=>this.computeViews(e,c,u,Ne())).next(d=>({batchId:l,changes:cI(d)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new ae(n)).next(r=>{let s=jc();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=jc();return this.indexManager.getCollectionParents(e,i).next(l=>V.forEach(l,c=>{const u=function(m,p){return new co(p,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)}(n,c.child(i));return this.getDocumentsMatchingCollectionQuery(e,u,r,s).next(d=>{d.forEach((m,p)=>{o=o.insert(m,p)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((c,u)=>{const d=u.getKey();o.get(d)===null&&(o=o.insert(d,xn.newInvalidDocument(d)))});let l=jc();return o.forEach((c,u)=>{const d=i.get(c);d!==void 0&&Bc(d.mutation,u,dr.empty(),Tt.now()),Am(n,u)&&(l=l.insert(c,u))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q7{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return V.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:Ss(s.createTime)}}(n)),V.resolve()}getNamedQuery(e,n){return V.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(s){return{name:s.name,query:B7(s.bundledQuery),readTime:Ss(s.readTime)}}(n)),V.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K7{constructor(){this.overlays=new dt(ae.comparator),this.Ir=new Map}getOverlay(e,n){return V.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Na();return V.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.ht(e,n,i)}),V.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.Ir.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(r)),V.resolve()}getOverlaysForCollection(e,n,r){const s=Na(),i=n.length+1,o=new ae(n.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const c=l.getNext().value,u=c.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===i&&c.largestBatchId>r&&s.set(c.getKey(),c)}return V.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new dt((u,d)=>u-d);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>r){let d=i.get(u.largestBatchId);d===null&&(d=Na(),i=i.insert(u.largestBatchId,d)),d.set(u.getKey(),u)}}const l=Na(),c=i.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,d)=>l.set(u,d)),!(l.size()>=s)););return V.resolve(l)}ht(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.Ir.get(s.largestBatchId).delete(r.key);this.Ir.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new x7(n,r));let i=this.Ir.get(n);i===void 0&&(i=Ne(),this.Ir.set(n,i)),this.Ir.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q7{constructor(){this.sessionToken=sn.EMPTY_BYTE_STRING}getSessionToken(e){return V.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,V.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bv{constructor(){this.Tr=new nn(Bt.Er),this.dr=new nn(Bt.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new Bt(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new Bt(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new ae(new Xe([])),r=new Bt(n,e),s=new Bt(n,e+1),i=[];return this.dr.forEachInRange([r,s],o=>{this.Vr(o),i.push(o.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new ae(new Xe([])),r=new Bt(n,e),s=new Bt(n,e+1);let i=Ne();return this.dr.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new Bt(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Bt{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return ae.comparator(e.key,n.key)||ze(e.wr,n.wr)}static Ar(e,n){return ze(e.wr,n.wr)||ae.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X7{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new nn(Bt.Er)}checkEmpty(e){return V.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new g7(i,n,r,s);this.mutationQueue.push(o);for(const l of s)this.br=this.br.add(new Bt(l.key,i)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return V.resolve(o)}lookupMutationBatch(e,n){return V.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.vr(r),i=s<0?0:s;return V.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return V.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return V.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Bt(n,0),s=new Bt(n,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([r,s],o=>{const l=this.Dr(o.wr);i.push(l)}),V.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new nn(ze);return n.forEach(s=>{const i=new Bt(s,0),o=new Bt(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,o],l=>{r=r.add(l.wr)})}),V.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;ae.isDocumentKey(i)||(i=i.child(""));const o=new Bt(new ae(i),0);let l=new nn(ze);return this.br.forEachWhile(c=>{const u=c.key.path;return!!r.isPrefixOf(u)&&(u.length===s&&(l=l.add(c.wr)),!0)},o),V.resolve(this.Cr(l))}Cr(e){const n=[];return e.forEach(r=>{const s=this.Dr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){Ge(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return V.forEach(n.mutations,s=>{const i=new Bt(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new Bt(n,0),s=this.br.firstAfterOrEqual(r);return V.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,V.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y7{constructor(e){this.Mr=e,this.docs=function(){return new dt(ae.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return V.resolve(r?r.document.mutableCopy():xn.newInvalidDocument(n))}getEntries(e,n){let r=si();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():xn.newInvalidDocument(s))}),V.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=si();const o=n.path,l=new ae(o.child("")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){const{key:u,value:{document:d}}=c.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||MO(FO(d),r)<=0||(s.has(d.key)||Am(n,d))&&(i=i.insert(d.key,d.mutableCopy()))}return V.resolve(i)}getAllFromCollectionGroup(e,n,r,s){me()}Or(e,n){return V.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new J7(this)}getSize(e){return V.resolve(this.size)}}class J7 extends H7{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.cr.addEntry(e,s)):this.cr.removeEntry(r)}),V.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z7{constructor(e){this.persistence=e,this.Nr=new Ll(n=>Pv(n),Fv),this.lastRemoteSnapshotVersion=_e.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Bv,this.targetCount=0,this.kr=yl.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,s)=>n(s)),V.resolve()}getLastRemoteSnapshotVersion(e){return V.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return V.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),V.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),V.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new yl(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,V.resolve()}updateTargetData(e,n){return this.Kn(n),V.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,V.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.Nr.forEach((o,l)=>{l.sequenceNumber<=n&&r.get(l.targetId)===null&&(this.Nr.delete(o),i.push(this.removeMatchingKeysForTargetId(e,l.targetId)),s++)}),V.waitFor(i).next(()=>s)}getTargetCount(e){return V.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return V.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),V.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),V.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),V.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return V.resolve(r)}containsKey(e,n){return V.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e9{constructor(e,n){this.qr={},this.overlays={},this.Qr=new Rv(0),this.Kr=!1,this.Kr=!0,this.$r=new Q7,this.referenceDelegate=e(this),this.Ur=new Z7(this),this.indexManager=new V7,this.remoteDocumentCache=function(s){return new Y7(s)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new z7(n),this.Gr=new q7(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new K7,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new X7(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){J("MemoryPersistence","Starting transaction:",e);const s=new t9(this.Qr.next());return this.referenceDelegate.zr(),r(s).next(i=>this.referenceDelegate.jr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Hr(e,n){return V.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}}class t9 extends LO{constructor(e){super(),this.currentSequenceNumber=e}}class Vv{constructor(e){this.persistence=e,this.Jr=new Bv,this.Yr=null}static Zr(e){return new Vv(e)}get Xr(){if(this.Yr)return this.Yr;throw me()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),V.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),V.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),V.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(s=>this.Xr.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.Xr.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return V.forEach(this.Xr,r=>{const s=ae.fromPath(r);return this.ei(e,s).next(i=>{i||n.removeEntry(s,_e.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return V.or([()=>V.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uv{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=s}static Wi(e,n){let r=Ne(),s=Ne();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Uv(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n9{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r9{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return o6()?8:OO(Sn())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.Yi(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.Zi(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new n9;return this.Xi(e,n,o).next(l=>{if(i.result=l,this.zi)return this.es(e,n,o,l.size)})}).next(()=>i.result)}es(e,n,r,s){return r.documentReadCount<this.ji?(xc()<=Fe.DEBUG&&J("QueryEngine","SDK will not create cache indexes for query:",Co(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),V.resolve()):(xc()<=Fe.DEBUG&&J("QueryEngine","Query:",Co(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.Hi*s?(xc()<=Fe.DEBUG&&J("QueryEngine","The SDK decides to create cache indexes for query:",Co(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,_s(n))):V.resolve())}Yi(e,n){if(lb(n))return V.resolve(null);let r=_s(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=Sf(n,null,"F"),r=_s(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=Ne(...i);return this.Ji.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,r).next(c=>{const u=this.ts(n,l);return this.ns(n,u,o,c.readTime)?this.Yi(e,Sf(n,null,"F")):this.rs(e,u,n,c)}))})))}Zi(e,n,r,s){return lb(n)||s.isEqual(_e.min())?V.resolve(null):this.Ji.getDocuments(e,r).next(i=>{const o=this.ts(n,i);return this.ns(n,o,r,s)?V.resolve(null):(xc()<=Fe.DEBUG&&J("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Co(n)),this.rs(e,o,n,PO(s,-1)).next(l=>l))})}ts(e,n){let r=new nn(oI(e));return n.forEach((s,i)=>{Am(e,i)&&(r=r.add(i))}),r}ns(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Xi(e,n,r){return xc()<=Fe.DEBUG&&J("QueryEngine","Using full collection scan to execute query:",Co(n)),this.Ji.getDocumentsMatchingQuery(e,n,Ji.min(),r)}rs(e,n,r,s){return this.Ji.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s9{constructor(e,n,r,s){this.persistence=e,this.ss=n,this.serializer=s,this.os=new dt(ze),this._s=new Ll(i=>Pv(i),Fv),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new W7(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function i9(t,e,n,r){return new s9(t,e,n,r)}async function RI(t,e){const n=Se(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],l=[];let c=Ne();for(const u of s){o.push(u.batchId);for(const d of u.mutations)c=c.add(d.key)}for(const u of i){l.push(u.batchId);for(const d of u.mutations)c=c.add(d.key)}return n.localDocuments.getDocuments(r,c).next(u=>({hs:u,removedBatchIds:o,addedBatchIds:l}))})})}function a9(t,e){const n=Se(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.cs.newChangeBuffer({trackRemovals:!0});return function(l,c,u,d){const m=u.batch,p=m.keys();let g=V.resolve();return p.forEach(x=>{g=g.next(()=>d.getEntry(c,x)).next(w=>{const v=u.docVersions.get(x);Ge(v!==null),w.version.compareTo(v)<0&&(m.applyToRemoteDocument(w,u),w.isValidDocument()&&(w.setReadTime(u.commitVersion),d.addEntry(w)))})}),g.next(()=>l.mutationQueue.removeMutationBatch(c,m))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let c=Ne();for(let u=0;u<l.mutationResults.length;++u)l.mutationResults[u].transformResults.length>0&&(c=c.add(l.batch.mutations[u].key));return c}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function NI(t){const e=Se(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function o9(t,e){const n=Se(t),r=e.snapshotVersion;let s=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.cs.newChangeBuffer({trackRemovals:!0});s=n.os;const l=[];e.targetChanges.forEach((d,m)=>{const p=s.get(m);if(!p)return;l.push(n.Ur.removeMatchingKeys(i,d.removedDocuments,m).next(()=>n.Ur.addMatchingKeys(i,d.addedDocuments,m)));let g=p.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(m)!==null?g=g.withResumeToken(sn.EMPTY_BYTE_STRING,_e.min()).withLastLimboFreeSnapshotVersion(_e.min()):d.resumeToken.approximateByteSize()>0&&(g=g.withResumeToken(d.resumeToken,r)),s=s.insert(m,g),function(w,v,S){return w.resumeToken.approximateByteSize()===0||v.snapshotVersion.toMicroseconds()-w.snapshotVersion.toMicroseconds()>=3e8?!0:S.addedDocuments.size+S.modifiedDocuments.size+S.removedDocuments.size>0}(p,g,d)&&l.push(n.Ur.updateTargetData(i,g))});let c=si(),u=Ne();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(i,d))}),l.push(l9(i,o,e.documentUpdates).next(d=>{c=d.Ps,u=d.Is})),!r.isEqual(_e.min())){const d=n.Ur.getLastRemoteSnapshotVersion(i).next(m=>n.Ur.setTargetsMetadata(i,i.currentSequenceNumber,r));l.push(d)}return V.waitFor(l).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,c,u)).next(()=>c)}).then(i=>(n.os=s,i))}function l9(t,e,n){let r=Ne(),s=Ne();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=si();return n.forEach((l,c)=>{const u=i.get(l);c.isFoundDocument()!==u.isFoundDocument()&&(s=s.add(l)),c.isNoDocument()&&c.version.isEqual(_e.min())?(e.removeEntry(l,c.readTime),o=o.insert(l,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),o=o.insert(l,c)):J("LocalStore","Ignoring outdated watch update for ",l,". Current version:",u.version," Watch version:",c.version)}),{Ps:o,Is:s}})}function c9(t,e){const n=Se(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function u9(t,e){const n=Se(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Ur.getTargetData(r,e).next(i=>i?(s=i,V.resolve(s)):n.Ur.allocateTargetId(r).next(o=>(s=new Mi(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.os.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function kx(t,e,n){const r=Se(t),s=r.os.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!Vu(o))throw o;J("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(s.target)}function vb(t,e,n){const r=Se(t);let s=_e.min(),i=Ne();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,u,d){const m=Se(c),p=m._s.get(d);return p!==void 0?V.resolve(m.os.get(p)):m.Ur.getTargetData(u,d)}(r,o,_s(e)).next(l=>{if(l)return s=l.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,l.targetId).next(c=>{i=c})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,n?s:_e.min(),n?i:Ne())).next(l=>(d9(r,n7(e),l),{documents:l,Ts:i})))}function d9(t,e,n){let r=t.us.get(e)||_e.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.us.set(e,r)}class wb{constructor(){this.activeTargetIds=l7()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class h9{constructor(){this.so=new wb,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new wb,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f9{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _b{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){J("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){J("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Xd=null;function Ig(){return Xd===null?Xd=function(){return 268435456+Math.round(2147483648*Math.random())}():Xd++,"0x"+Xd.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m9={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p9{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fn="WebChannelConnection";class g9 extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${s}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get Fo(){return!1}Mo(n,r,s,i,o){const l=Ig(),c=this.xo(n,r.toUriEncodedString());J("RestConnection",`Sending RPC '${n}' ${l}:`,c,s);const u={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(u,i,o),this.No(n,c,u,s).then(d=>(J("RestConnection",`Received RPC '${n}' ${l}: `,d),d),d=>{throw fl("RestConnection",`RPC '${n}' ${l} failed with error: `,d,"url: ",c,"request:",s),d})}Lo(n,r,s,i,o,l){return this.Mo(n,r,s,i,o)}Oo(n,r,s){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Dl}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,o)=>n[o]=i),s&&s.headers.forEach((i,o)=>n[o]=i)}xo(n,r){const s=m9[n];return`${this.Do}/v1/${r}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,s){const i=Ig();return new Promise((o,l)=>{const c=new HT;c.setWithCredentials(!0),c.listenOnce(GT.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Th.NO_ERROR:const d=c.getResponseJson();J(fn,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(d)),o(d);break;case Th.TIMEOUT:J(fn,`RPC '${e}' ${i} timed out`),l(new W($.DEADLINE_EXCEEDED,"Request time out"));break;case Th.HTTP_ERROR:const m=c.getStatus();if(J(fn,`RPC '${e}' ${i} failed with status:`,m,"response text:",c.getResponseText()),m>0){let p=c.getResponseJson();Array.isArray(p)&&(p=p[0]);const g=p==null?void 0:p.error;if(g&&g.status&&g.message){const x=function(v){const S=v.toLowerCase().replace(/_/g,"-");return Object.values($).indexOf(S)>=0?S:$.UNKNOWN}(g.status);l(new W(x,g.message))}else l(new W($.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new W($.UNAVAILABLE,"Connection failed."));break;default:me()}}finally{J(fn,`RPC '${e}' ${i} completed.`)}});const u=JSON.stringify(s);J(fn,`RPC '${e}' ${i} sending request:`,s),c.send(n,"POST",u,r,15)})}Bo(e,n,r){const s=Ig(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=KT(),l=qT(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Oo(c.initMessageHeaders,n,r),c.encodeInitMessageHeaders=!0;const d=i.join("");J(fn,`Creating RPC '${e}' stream ${s}: ${d}`,c);const m=o.createWebChannel(d,c);let p=!1,g=!1;const x=new p9({Io:v=>{g?J(fn,`Not sending because RPC '${e}' stream ${s} is closed:`,v):(p||(J(fn,`Opening RPC '${e}' stream ${s} transport.`),m.open(),p=!0),J(fn,`RPC '${e}' stream ${s} sending:`,v),m.send(v))},To:()=>m.close()}),w=(v,S,_)=>{v.listen(S,E=>{try{_(E)}catch(I){setTimeout(()=>{throw I},0)}})};return w(m,Ec.EventType.OPEN,()=>{g||(J(fn,`RPC '${e}' stream ${s} transport opened.`),x.yo())}),w(m,Ec.EventType.CLOSE,()=>{g||(g=!0,J(fn,`RPC '${e}' stream ${s} transport closed`),x.So())}),w(m,Ec.EventType.ERROR,v=>{g||(g=!0,fl(fn,`RPC '${e}' stream ${s} transport errored:`,v),x.So(new W($.UNAVAILABLE,"The operation could not be completed")))}),w(m,Ec.EventType.MESSAGE,v=>{var S;if(!g){const _=v.data[0];Ge(!!_);const E=_,I=E.error||((S=E[0])===null||S===void 0?void 0:S.error);if(I){J(fn,`RPC '${e}' stream ${s} received error:`,I);const N=I.status;let F=function(C){const R=Et[C];if(R!==void 0)return wI(R)}(N),k=I.message;F===void 0&&(F=$.INTERNAL,k="Unknown error status: "+N+" with message "+I.message),g=!0,x.So(new W(F,k)),m.close()}else J(fn,`RPC '${e}' stream ${s} received:`,_),x.bo(_)}}),w(l,WT.STAT_EVENT,v=>{v.stat===gx.PROXY?J(fn,`RPC '${e}' stream ${s} detected buffering proxy`):v.stat===gx.NOPROXY&&J(fn,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{x.wo()},0),x}}function Cg(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lm(t){return new k7(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AI{constructor(e,n,r=1e3,s=1.5,i=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=s,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),s=Math.max(0,n-r);s>0&&J("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PI{constructor(e,n,r,s,i,o,l,c){this.ui=e,this.Ho=r,this.Jo=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new AI(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===$.RESOURCE_EXHAUSTED?(ri(n.toString()),ri("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===$.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Yo===n&&this.P_(r,s)},r=>{e(()=>{const s=new W($.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(s)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{r(()=>this.I_(s))}),this.stream.onMessage(s=>{r(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return J("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(J("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class x9 extends PI{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=C7(this.serializer,e),r=function(i){if(!("targetChange"in i))return _e.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?_e.min():o.readTime?Ss(o.readTime):_e.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=jx(this.serializer),n.addTarget=function(i,o){let l;const c=o.target;if(l=wx(c)?{documents:A7(i,c)}:{query:P7(i,c)._t},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=bI(i,o.resumeToken);const u=Sx(i,o.expectedCount);u!==null&&(l.expectedCount=u)}else if(o.snapshotVersion.compareTo(_e.min())>0){l.readTime=bf(i,o.snapshotVersion.toTimestamp());const u=Sx(i,o.expectedCount);u!==null&&(l.expectedCount=u)}return l}(this.serializer,e);const r=M7(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=jx(this.serializer),n.removeTarget=e,this.a_(n)}}class y9 extends PI{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return Ge(!!e.streamToken),this.lastStreamToken=e.streamToken,Ge(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Ge(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=N7(e.writeResults,e.commitTime),r=Ss(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=jx(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>R7(this.serializer,r))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v9 extends class{}{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new W($.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Mo(e,bx(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===$.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new W($.UNKNOWN,i.toString())})}Lo(e,n,r,s,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Lo(e,bx(n,r),s,o,l,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===$.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new W($.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class w9{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(ri(n),this.D_=!1):J("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _9{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(o=>{r.enqueueAndForget(async()=>{uo(this)&&(J("RemoteStore","Restarting streams for network reachability change."),await async function(c){const u=Se(c);u.L_.add(4),await Gu(u),u.q_.set("Unknown"),u.L_.delete(4),await Om(u)}(this))})}),this.q_=new w9(r,s)}}async function Om(t){if(uo(t))for(const e of t.B_)await e(!0)}async function Gu(t){for(const e of t.B_)await e(!1)}function FI(t,e){const n=Se(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),qv(n)?Wv(n):Ol(n).r_()&&Gv(n,e))}function Hv(t,e){const n=Se(t),r=Ol(n);n.N_.delete(e),r.r_()&&MI(n,e),n.N_.size===0&&(r.r_()?r.o_():uo(n)&&n.q_.set("Unknown"))}function Gv(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(_e.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Ol(t).A_(e)}function MI(t,e){t.Q_.xe(e),Ol(t).R_(e)}function Wv(t){t.Q_=new S7({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),Ol(t).start(),t.q_.v_()}function qv(t){return uo(t)&&!Ol(t).n_()&&t.N_.size>0}function uo(t){return Se(t).L_.size===0}function DI(t){t.Q_=void 0}async function S9(t){t.q_.set("Online")}async function b9(t){t.N_.forEach((e,n)=>{Gv(t,e)})}async function E9(t,e){DI(t),qv(t)?(t.q_.M_(e),Wv(t)):t.q_.set("Unknown")}async function j9(t,e,n){if(t.q_.set("Online"),e instanceof SI&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const l of i.targetIds)s.N_.has(l)&&(await s.remoteSyncer.rejectListen(l,o),s.N_.delete(l),s.Q_.removeTarget(l))}(t,e)}catch(r){J("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Ef(t,r)}else if(e instanceof Rh?t.Q_.Ke(e):e instanceof _I?t.Q_.He(e):t.Q_.We(e),!n.isEqual(_e.min()))try{const r=await NI(t.localStore);n.compareTo(r)>=0&&await function(i,o){const l=i.Q_.rt(o);return l.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){const d=i.N_.get(u);d&&i.N_.set(u,d.withResumeToken(c.resumeToken,o))}}),l.targetMismatches.forEach((c,u)=>{const d=i.N_.get(c);if(!d)return;i.N_.set(c,d.withResumeToken(sn.EMPTY_BYTE_STRING,d.snapshotVersion)),MI(i,c);const m=new Mi(d.target,c,u,d.sequenceNumber);Gv(i,m)}),i.remoteSyncer.applyRemoteEvent(l)}(t,n)}catch(r){J("RemoteStore","Failed to raise snapshot:",r),await Ef(t,r)}}async function Ef(t,e,n){if(!Vu(e))throw e;t.L_.add(1),await Gu(t),t.q_.set("Offline"),n||(n=()=>NI(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{J("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await Om(t)})}function LI(t,e){return e().catch(n=>Ef(t,n,e))}async function $m(t){const e=Se(t),n=ea(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;k9(e);)try{const s=await c9(e.localStore,r);if(s===null){e.O_.length===0&&n.o_();break}r=s.batchId,T9(e,s)}catch(s){await Ef(e,s)}OI(e)&&$I(e)}function k9(t){return uo(t)&&t.O_.length<10}function T9(t,e){t.O_.push(e);const n=ea(t);n.r_()&&n.V_&&n.m_(e.mutations)}function OI(t){return uo(t)&&!ea(t).n_()&&t.O_.length>0}function $I(t){ea(t).start()}async function I9(t){ea(t).p_()}async function C9(t){const e=ea(t);for(const n of t.O_)e.m_(n.mutations)}async function R9(t,e,n){const r=t.O_.shift(),s=Ov.from(r,e,n);await LI(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await $m(t)}async function N9(t,e){e&&ea(t).V_&&await async function(r,s){if(function(o){return v7(o)&&o!==$.ABORTED}(s.code)){const i=r.O_.shift();ea(r).s_(),await LI(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await $m(r)}}(t,e),OI(t)&&$I(t)}async function Sb(t,e){const n=Se(t);n.asyncQueue.verifyOperationInProgress(),J("RemoteStore","RemoteStore received new credentials");const r=uo(n);n.L_.add(3),await Gu(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await Om(n)}async function A9(t,e){const n=Se(t);e?(n.L_.delete(2),await Om(n)):e||(n.L_.add(2),await Gu(n),n.q_.set("Unknown"))}function Ol(t){return t.K_||(t.K_=function(n,r,s){const i=Se(n);return i.w_(),new x9(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:S9.bind(null,t),Ro:b9.bind(null,t),mo:E9.bind(null,t),d_:j9.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),qv(t)?Wv(t):t.q_.set("Unknown")):(await t.K_.stop(),DI(t))})),t.K_}function ea(t){return t.U_||(t.U_=function(n,r,s){const i=Se(n);return i.w_(),new y9(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:I9.bind(null,t),mo:N9.bind(null,t),f_:C9.bind(null,t),g_:R9.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await $m(t)):(await t.U_.stop(),t.O_.length>0&&(J("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kv{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new Ks,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,l=new Kv(e,n,o,s,i);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new W($.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Qv(t,e){if(ri("AsyncQueue",`${e}: ${t}`),Vu(t))return new W($.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class el{constructor(e){this.comparator=e?(n,r)=>e(n,r)||ae.comparator(n.key,r.key):(n,r)=>ae.comparator(n.key,r.key),this.keyedMap=jc(),this.sortedSet=new dt(this.comparator)}static emptySet(e){return new el(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof el)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new el;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bb{constructor(){this.W_=new dt(ae.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):me():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}}class vl{constructor(e,n,r,s,i,o,l,c,u){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(l=>{o.push({type:0,doc:l})}),new vl(e,n,el.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Nm(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P9{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class F9{constructor(){this.queries=Eb(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const s=Se(n),i=s.queries;s.queries=Eb(),i.forEach((o,l)=>{for(const c of l.j_)c.onError(r)})})(this,new W($.ABORTED,"Firestore shutting down"))}}function Eb(){return new Ll(t=>aI(t),Nm)}async function zI(t,e){const n=Se(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.H_()&&e.J_()&&(r=2):(i=new P9,r=e.J_()?0:1);try{switch(r){case 0:i.z_=await n.onListen(s,!0);break;case 1:i.z_=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const l=Qv(o,`Initialization of query '${Co(e.query)}' failed`);return void e.onError(l)}n.queries.set(s,i),i.j_.push(e),e.Z_(n.onlineState),i.z_&&e.X_(i.z_)&&Xv(n)}async function BI(t,e){const n=Se(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const o=i.j_.indexOf(e);o>=0&&(i.j_.splice(o,1),i.j_.length===0?s=e.J_()?0:1:!i.H_()&&e.J_()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function M9(t,e){const n=Se(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const l of o.j_)l.X_(s)&&(r=!0);o.z_=s}}r&&Xv(n)}function D9(t,e,n){const r=Se(t),s=r.queries.get(e);if(s)for(const i of s.j_)i.onError(n);r.queries.delete(e)}function Xv(t){t.Y_.forEach(e=>{e.next()})}var Tx,jb;(jb=Tx||(Tx={})).ea="default",jb.Cache="cache";class VI{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new vl(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=vl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Tx.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UI{constructor(e){this.key=e}}class HI{constructor(e){this.key=e}}class L9{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Ne(),this.mutatedKeys=Ne(),this.Aa=oI(e),this.Ra=new el(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new bb,s=n?n.Ra:this.Ra;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,l=!1;const c=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,u=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((d,m)=>{const p=s.get(d),g=Am(this.query,m)?m:null,x=!!p&&this.mutatedKeys.has(p.key),w=!!g&&(g.hasLocalMutations||this.mutatedKeys.has(g.key)&&g.hasCommittedMutations);let v=!1;p&&g?p.data.isEqual(g.data)?x!==w&&(r.track({type:3,doc:g}),v=!0):this.ga(p,g)||(r.track({type:2,doc:g}),v=!0,(c&&this.Aa(g,c)>0||u&&this.Aa(g,u)<0)&&(l=!0)):!p&&g?(r.track({type:0,doc:g}),v=!0):p&&!g&&(r.track({type:1,doc:p}),v=!0,(c||u)&&(l=!0)),v&&(g?(o=o.add(g),i=w?i.add(d):i.delete(d)):(o=o.delete(d),i=i.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),i=i.delete(d.key),r.track({type:1,doc:d})}return{Ra:o,fa:r,ns:l,mutatedKeys:i}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((d,m)=>function(g,x){const w=v=>{switch(v){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return me()}};return w(g)-w(x)}(d.type,m.type)||this.Aa(d.doc,m.doc)),this.pa(r),s=s!=null&&s;const l=n&&!s?this.ya():[],c=this.da.size===0&&this.current&&!s?1:0,u=c!==this.Ea;return this.Ea=c,o.length!==0||u?{snapshot:new vl(this.query,e.Ra,i,o,e.mutatedKeys,c===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:l}:{wa:l}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new bb,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Ne(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new HI(r))}),this.da.forEach(r=>{e.has(r)||n.push(new UI(r))}),n}ba(e){this.Ta=e.Ts,this.da=Ne();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return vl.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class O9{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class $9{constructor(e){this.key=e,this.va=!1}}class z9{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new Ll(l=>aI(l),Nm),this.Ma=new Map,this.xa=new Set,this.Oa=new dt(ae.comparator),this.Na=new Map,this.La=new Bv,this.Ba={},this.ka=new Map,this.qa=yl.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function B9(t,e,n=!0){const r=XI(t);let s;const i=r.Fa.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.Da()):s=await GI(r,e,n,!0),s}async function V9(t,e){const n=XI(t);await GI(n,e,!0,!1)}async function GI(t,e,n,r){const s=await u9(t.localStore,_s(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let l;return r&&(l=await U9(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&FI(t.remoteStore,s),l}async function U9(t,e,n,r,s){t.Ka=(m,p,g)=>async function(w,v,S,_){let E=v.view.ma(S);E.ns&&(E=await vb(w.localStore,v.query,!1).then(({documents:k})=>v.view.ma(k,E)));const I=_&&_.targetChanges.get(v.targetId),N=_&&_.targetMismatches.get(v.targetId)!=null,F=v.view.applyChanges(E,w.isPrimaryClient,I,N);return Tb(w,v.targetId,F.wa),F.snapshot}(t,m,p,g);const i=await vb(t.localStore,e,!0),o=new L9(e,i.Ts),l=o.ma(i.documents),c=Hu.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),u=o.applyChanges(l,t.isPrimaryClient,c);Tb(t,n,u.wa);const d=new O9(e,n,o);return t.Fa.set(e,d),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),u.snapshot}async function H9(t,e,n){const r=Se(t),s=r.Fa.get(e),i=r.Ma.get(s.targetId);if(i.length>1)return r.Ma.set(s.targetId,i.filter(o=>!Nm(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await kx(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&Hv(r.remoteStore,s.targetId),Ix(r,s.targetId)}).catch(Bu)):(Ix(r,s.targetId),await kx(r.localStore,s.targetId,!0))}async function G9(t,e){const n=Se(t),r=n.Fa.get(e),s=n.Ma.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Hv(n.remoteStore,r.targetId))}async function W9(t,e,n){const r=Z9(t);try{const s=await function(o,l){const c=Se(o),u=Tt.now(),d=l.reduce((g,x)=>g.add(x.key),Ne());let m,p;return c.persistence.runTransaction("Locally write mutations","readwrite",g=>{let x=si(),w=Ne();return c.cs.getEntries(g,d).next(v=>{x=v,x.forEach((S,_)=>{_.isValidDocument()||(w=w.add(S))})}).next(()=>c.localDocuments.getOverlayedDocuments(g,x)).next(v=>{m=v;const S=[];for(const _ of l){const E=m7(_,m.get(_.key).overlayedDocument);E!=null&&S.push(new ca(_.key,E,ZT(E.value.mapValue),Pn.exists(!0)))}return c.mutationQueue.addMutationBatch(g,u,S,l)}).next(v=>{p=v;const S=v.applyToLocalDocumentSet(m,w);return c.documentOverlayCache.saveOverlays(g,v.batchId,S)})}).then(()=>({batchId:p.batchId,changes:cI(m)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,l,c){let u=o.Ba[o.currentUser.toKey()];u||(u=new dt(ze)),u=u.insert(l,c),o.Ba[o.currentUser.toKey()]=u}(r,s.batchId,n),await Wu(r,s.changes),await $m(r.remoteStore)}catch(s){const i=Qv(s,"Failed to persist write");n.reject(i)}}async function WI(t,e){const n=Se(t);try{const r=await o9(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.Na.get(i);o&&(Ge(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.va=!0:s.modifiedDocuments.size>0?Ge(o.va):s.removedDocuments.size>0&&(Ge(o.va),o.va=!1))}),await Wu(n,r,e)}catch(r){await Bu(r)}}function kb(t,e,n){const r=Se(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Fa.forEach((i,o)=>{const l=o.view.Z_(e);l.snapshot&&s.push(l.snapshot)}),function(o,l){const c=Se(o);c.onlineState=l;let u=!1;c.queries.forEach((d,m)=>{for(const p of m.j_)p.Z_(l)&&(u=!0)}),u&&Xv(c)}(r.eventManager,e),s.length&&r.Ca.d_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function q9(t,e,n){const r=Se(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Na.get(e),i=s&&s.key;if(i){let o=new dt(ae.comparator);o=o.insert(i,xn.newNoDocument(i,_e.min()));const l=Ne().add(i),c=new Dm(_e.min(),new Map,new dt(ze),o,l);await WI(r,c),r.Oa=r.Oa.remove(i),r.Na.delete(e),Yv(r)}else await kx(r.localStore,e,!1).then(()=>Ix(r,e,n)).catch(Bu)}async function K9(t,e){const n=Se(t),r=e.batch.batchId;try{const s=await a9(n.localStore,e);KI(n,r,null),qI(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Wu(n,s)}catch(s){await Bu(s)}}async function Q9(t,e,n){const r=Se(t);try{const s=await function(o,l){const c=Se(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let d;return c.mutationQueue.lookupMutationBatch(u,l).next(m=>(Ge(m!==null),d=m.keys(),c.mutationQueue.removeMutationBatch(u,m))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,d,l)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,d)).next(()=>c.localDocuments.getDocuments(u,d))})}(r.localStore,e);KI(r,e,n),qI(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Wu(r,s)}catch(s){await Bu(s)}}function qI(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function KI(t,e,n){const r=Se(t);let s=r.Ba[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Ba[r.currentUser.toKey()]=s}}function Ix(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||QI(t,r)})}function QI(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(Hv(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),Yv(t))}function Tb(t,e,n){for(const r of n)r instanceof UI?(t.La.addReference(r.key,e),X9(t,r)):r instanceof HI?(J("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||QI(t,r.key)):me()}function X9(t,e){const n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||(J("SyncEngine","New document in limbo: "+n),t.xa.add(r),Yv(t))}function Yv(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new ae(Xe.fromString(e)),r=t.qa.next();t.Na.set(r,new $9(n)),t.Oa=t.Oa.insert(n,r),FI(t.remoteStore,new Mi(_s(Mv(n.path)),r,"TargetPurposeLimboResolution",Rv.oe))}}async function Wu(t,e,n){const r=Se(t),s=[],i=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((l,c)=>{o.push(r.Ka(c,e,n).then(u=>{var d;if((u||n)&&r.isPrimaryClient){const m=u?!u.fromCache:(d=n==null?void 0:n.targetChanges.get(c.targetId))===null||d===void 0?void 0:d.current;r.sharedClientState.updateQueryState(c.targetId,m?"current":"not-current")}if(u){s.push(u);const m=Uv.Wi(c.targetId,u);i.push(m)}}))}),await Promise.all(o),r.Ca.d_(s),await async function(c,u){const d=Se(c);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>V.forEach(u,p=>V.forEach(p.$i,g=>d.persistence.referenceDelegate.addReference(m,p.targetId,g)).next(()=>V.forEach(p.Ui,g=>d.persistence.referenceDelegate.removeReference(m,p.targetId,g)))))}catch(m){if(!Vu(m))throw m;J("LocalStore","Failed to update sequence numbers: "+m)}for(const m of u){const p=m.targetId;if(!m.fromCache){const g=d.os.get(p),x=g.snapshotVersion,w=g.withLastLimboFreeSnapshotVersion(x);d.os=d.os.insert(p,w)}}}(r.localStore,i))}async function Y9(t,e){const n=Se(t);if(!n.currentUser.isEqual(e)){J("SyncEngine","User change. New user:",e.toKey());const r=await RI(n.localStore,e);n.currentUser=e,function(i,o){i.ka.forEach(l=>{l.forEach(c=>{c.reject(new W($.CANCELLED,o))})}),i.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Wu(n,r.hs)}}function J9(t,e){const n=Se(t),r=n.Na.get(e);if(r&&r.va)return Ne().add(r.key);{let s=Ne();const i=n.Ma.get(e);if(!i)return s;for(const o of i){const l=n.Fa.get(o);s=s.unionWith(l.view.Va)}return s}}function XI(t){const e=Se(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=WI.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=J9.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=q9.bind(null,e),e.Ca.d_=M9.bind(null,e.eventManager),e.Ca.$a=D9.bind(null,e.eventManager),e}function Z9(t){const e=Se(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=K9.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Q9.bind(null,e),e}class jf{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Lm(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return i9(this.persistence,new r9,e.initialUser,this.serializer)}Ga(e){return new e9(Vv.Zr,this.serializer)}Wa(e){return new h9}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}jf.provider={build:()=>new jf};class Cx{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>kb(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=Y9.bind(null,this.syncEngine),await A9(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new F9}()}createDatastore(e){const n=Lm(e.databaseInfo.databaseId),r=function(i){return new g9(i)}(e.databaseInfo);return function(i,o,l,c){return new v9(i,o,l,c)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,l){return new _9(r,s,i,o,l)}(this.localStore,this.datastore,e.asyncQueue,n=>kb(this.syncEngine,n,0),function(){return _b.D()?new _b:new f9}())}createSyncEngine(e,n){return function(s,i,o,l,c,u,d){const m=new z9(s,i,o,l,c,u);return d&&(m.Qa=!0),m}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=Se(s);J("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await Gu(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}Cx.provider={build:()=>new Cx};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YI{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):ri("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e${constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=pn.UNAUTHENTICATED,this.clientId=XT.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{J("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(J("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ks;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Qv(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Rg(t,e){t.asyncQueue.verifyOperationInProgress(),J("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await RI(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Ib(t,e){t.asyncQueue.verifyOperationInProgress();const n=await t$(t);J("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>Sb(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>Sb(e.remoteStore,s)),t._onlineComponents=e}async function t$(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){J("FirestoreClient","Using user provided OfflineComponentProvider");try{await Rg(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===$.FAILED_PRECONDITION||s.code===$.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;fl("Error using user provided cache. Falling back to memory cache: "+n),await Rg(t,new jf)}}else J("FirestoreClient","Using default OfflineComponentProvider"),await Rg(t,new jf);return t._offlineComponents}async function JI(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(J("FirestoreClient","Using user provided OnlineComponentProvider"),await Ib(t,t._uninitializedComponentsProvider._online)):(J("FirestoreClient","Using default OnlineComponentProvider"),await Ib(t,new Cx))),t._onlineComponents}function n$(t){return JI(t).then(e=>e.syncEngine)}async function ZI(t){const e=await JI(t),n=e.eventManager;return n.onListen=B9.bind(null,e.syncEngine),n.onUnlisten=H9.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=V9.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=G9.bind(null,e.syncEngine),n}function r$(t,e,n={}){const r=new Ks;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,c,u){const d=new YI({next:p=>{d.Za(),o.enqueueAndForget(()=>BI(i,m));const g=p.docs.has(l);!g&&p.fromCache?u.reject(new W($.UNAVAILABLE,"Failed to get document because the client is offline.")):g&&p.fromCache&&c&&c.source==="server"?u.reject(new W($.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(p)},error:p=>u.reject(p)}),m=new VI(Mv(l.path),d,{includeMetadataChanges:!0,_a:!0});return zI(i,m)}(await ZI(t),t.asyncQueue,e,n,r)),r.promise}function s$(t,e,n={}){const r=new Ks;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,c,u){const d=new YI({next:p=>{d.Za(),o.enqueueAndForget(()=>BI(i,m)),p.fromCache&&c.source==="server"?u.reject(new W($.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(p)},error:p=>u.reject(p)}),m=new VI(l,d,{includeMetadataChanges:!0,_a:!0});return zI(i,m)}(await ZI(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eC(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cb=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tC(t,e,n){if(!n)throw new W($.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function i$(t,e,n,r){if(e===!0&&r===!0)throw new W($.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function Rb(t){if(!ae.isDocumentKey(t))throw new W($.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Nb(t){if(ae.isDocumentKey(t))throw new W($.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function zm(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":me()}function Mr(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new W($.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=zm(t);throw new W($.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function a$(t,e){if(e<=0)throw new W($.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ab{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new W($.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new W($.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}i$("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=eC((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new W($.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new W($.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new W($.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Bm{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Ab({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new W($.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new W($.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Ab(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new EO;switch(r.type){case"firstParty":return new IO(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new W($.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=Cb.get(n);r&&(J("ComponentProvider","Removing Datastore"),Cb.delete(n),r.terminate())}(this),Promise.resolve()}}function o$(t,e,n,r={}){var s;const i=(t=Mr(t,Bm))._getSettings(),o=`${e}:${n}`;if(i.host!=="firestore.googleapis.com"&&i.host!==o&&fl("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},i),{host:o,ssl:!1})),r.mockUserToken){let l,c;if(typeof r.mockUserToken=="string")l=r.mockUserToken,c=pn.MOCK_USER;else{l=e6(r.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new W($.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new pn(u)}t._authCredentials=new jO(new QT(l,c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hi{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new hi(this.firestore,e,this._query)}}class Fn{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ki(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Fn(this.firestore,e,this._key)}}class Ki extends hi{constructor(e,n,r){super(e,n,Mv(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Fn(this.firestore,null,new ae(e))}withConverter(e){return new Ki(this.firestore,e,this._path)}}function St(t,e,...n){if(t=Rt(t),tC("collection","path",e),t instanceof Bm){const r=Xe.fromString(e,...n);return Nb(r),new Ki(t,null,r)}{if(!(t instanceof Fn||t instanceof Ki))throw new W($.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Xe.fromString(e,...n));return Nb(r),new Ki(t.firestore,null,r)}}function it(t,e,...n){if(t=Rt(t),arguments.length===1&&(e=XT.newId()),tC("doc","path",e),t instanceof Bm){const r=Xe.fromString(e,...n);return Rb(r),new Fn(t,null,new ae(r))}{if(!(t instanceof Fn||t instanceof Ki))throw new W($.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Xe.fromString(e,...n));return Rb(r),new Fn(t.firestore,t instanceof Ki?t.converter:null,new ae(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pb{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new AI(this,"async_queue_retry"),this.Vu=()=>{const r=Cg();r&&J("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=Cg();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=Cg();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new Ks;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Vu(e))throw e;J("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const s=function(o){let l=o.message||"";return o.stack&&(l=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),l}(r);throw ri("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const s=Kv.createAndSchedule(this,e,n,r,i=>this.yu(i));return this.Tu.push(s),s}fu(){this.Eu&&me()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}class ua extends Bm{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new Pb,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Pb(e),this._firestoreClient=void 0,await e}}}function l$(t,e){const n=typeof t=="object"?t:zT(),r=typeof t=="string"?t:e||"(default)",s=Iv(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=JL("firestore");i&&o$(s,...i)}return s}function Vm(t){if(t._terminated)throw new W($.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||c$(t),t._firestoreClient}function c$(t){var e,n,r;const s=t._freezeSettings(),i=function(l,c,u,d){return new BO(l,c,u,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,eC(d.experimentalLongPollingOptions),d.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((n=s.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new e$(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(l){const c=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(c),_online:c}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wl{constructor(e){this._byteString=e}static fromBase64String(e){try{return new wl(sn.fromBase64String(e))}catch(n){throw new W($.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new wl(sn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $l{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new W($.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new en(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}function Lr(){return new $l("__name__")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qu{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jv{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new W($.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new W($.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ze(this._lat,e._lat)||ze(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zv{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u$=/^__.*__$/;class d${constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new ca(e,this.data,this.fieldMask,n,this.fieldTransforms):new Uu(e,this.data,n,this.fieldTransforms)}}class nC{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new ca(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function rC(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw me()}}class ew{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new ew(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.Ou(e),s}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return kf(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(rC(this.Cu)&&u$.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class h${constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Lm(e)}Qu(e,n,r,s=!1){return new ew({Cu:e,methodName:n,qu:r,path:en.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function zl(t){const e=t._freezeSettings(),n=Lm(t._databaseId);return new h$(t._databaseId,!!e.ignoreUndefinedProperties,n)}function tw(t,e,n,r,s,i={}){const o=t.Qu(i.merge||i.mergeFields?2:0,e,n,s);sw("Data must be an object, but it was:",o,r);const l=oC(r,o);let c,u;if(i.merge)c=new dr(o.fieldMask),u=o.fieldTransforms;else if(i.mergeFields){const d=[];for(const m of i.mergeFields){const p=Rx(e,m,n);if(!o.contains(p))throw new W($.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);cC(d,p)||d.push(p)}c=new dr(d),u=o.fieldTransforms.filter(m=>c.covers(m.field))}else c=null,u=o.fieldTransforms;return new d$(new Kn(l),c,u)}class Um extends qu{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Um}}class nw extends qu{_toFieldTransform(e){return new xI(e.path,new gu)}isEqual(e){return e instanceof nw}}class rw extends qu{constructor(e,n){super(e),this.$u=n}_toFieldTransform(e){const n=new vu(e.serializer,hI(e.serializer,this.$u));return new xI(e.path,n)}isEqual(e){return e instanceof rw&&this.$u===e.$u}}function sC(t,e,n,r){const s=t.Qu(1,e,n);sw("Data must be an object, but it was:",s,r);const i=[],o=Kn.empty();lo(r,(c,u)=>{const d=iw(e,c,n);u=Rt(u);const m=s.Nu(d);if(u instanceof Um)i.push(d);else{const p=Ku(u,m);p!=null&&(i.push(d),o.set(d,p))}});const l=new dr(i);return new nC(o,l,s.fieldTransforms)}function iC(t,e,n,r,s,i){const o=t.Qu(1,e,n),l=[Rx(e,r,n)],c=[s];if(i.length%2!=0)throw new W($.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<i.length;p+=2)l.push(Rx(e,i[p])),c.push(i[p+1]);const u=[],d=Kn.empty();for(let p=l.length-1;p>=0;--p)if(!cC(u,l[p])){const g=l[p];let x=c[p];x=Rt(x);const w=o.Nu(g);if(x instanceof Um)u.push(g);else{const v=Ku(x,w);v!=null&&(u.push(g),d.set(g,v))}}const m=new dr(u);return new nC(d,m,o.fieldTransforms)}function aC(t,e,n,r=!1){return Ku(n,t.Qu(r?4:3,e))}function Ku(t,e){if(lC(t=Rt(t)))return sw("Unsupported field value:",e,t),oC(t,e);if(t instanceof qu)return function(r,s){if(!rC(s.Cu))throw s.Bu(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const l of r){let c=Ku(l,s.Lu(o));c==null&&(c={nullValue:"NULL_VALUE"}),i.push(c),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=Rt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return hI(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=Tt.fromDate(r);return{timestampValue:bf(s.serializer,i)}}if(r instanceof Tt){const i=new Tt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:bf(s.serializer,i)}}if(r instanceof Jv)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof wl)return{bytesValue:bI(s.serializer,r._byteString)};if(r instanceof Fn){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:zv(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof Zv)return function(o,l){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw l.Bu("VectorValues must only contain numeric values.");return Lv(l.serializer,c)})}}}}}}(r,s);throw s.Bu(`Unsupported field value: ${zm(r)}`)}(t,e)}function oC(t,e){const n={};return YT(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):lo(t,(r,s)=>{const i=Ku(s,e.Mu(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function lC(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Tt||t instanceof Jv||t instanceof wl||t instanceof Fn||t instanceof qu||t instanceof Zv)}function sw(t,e,n){if(!lC(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){const r=zm(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function Rx(t,e,n){if((e=Rt(e))instanceof $l)return e._internalPath;if(typeof e=="string")return iw(t,e);throw kf("Field path arguments must be of type string or ",t,!1,void 0,n)}const f$=new RegExp("[~\\*/\\[\\]]");function iw(t,e,n){if(e.search(f$)>=0)throw kf(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new $l(...e.split("."))._internalPath}catch{throw kf(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function kf(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let l=`Function ${e}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let c="";return(i||o)&&(c+=" (found",i&&(c+=` in field ${r}`),o&&(c+=` in document ${s}`),c+=")"),new W($.INVALID_ARGUMENT,l+t+c)}function cC(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aw{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Fn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new m$(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Hm("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class m$ extends aw{data(){return super.data()}}function Hm(t,e){return typeof e=="string"?iw(t,e):e instanceof $l?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p$(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new W($.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class ow{}class Gm extends ow{}function ue(t,e,...n){let r=[];e instanceof ow&&r.push(e),r=r.concat(n),function(i){const o=i.filter(c=>c instanceof lw).length,l=i.filter(c=>c instanceof Wm).length;if(o>1||o>0&&l>0)throw new W($.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class Wm extends Gm{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Wm(e,n,r)}_apply(e){const n=this._parse(e);return uC(e._query,n),new hi(e.firestore,e.converter,_x(e._query,n))}_parse(e){const n=zl(e.firestore);return function(i,o,l,c,u,d,m){let p;if(u.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new W($.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){Mb(m,d);const g=[];for(const x of m)g.push(Fb(c,i,x));p={arrayValue:{values:g}}}else p=Fb(c,i,m)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||Mb(m,d),p=aC(l,o,m,d==="in"||d==="not-in");return kt.create(u,d,p)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function X(t,e,n){const r=e,s=Hm("where",t);return Wm._create(s,r,n)}class lw extends ow{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new lw(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:ns.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let o=s;const l=i.getFlattenedFilters();for(const c of l)uC(o,c),o=_x(o,c)}(e._query,n),new hi(e.firestore,e.converter,_x(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class cw extends Gm{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new cw(e,n)}_apply(e){const n=function(s,i,o){if(s.startAt!==null)throw new W($.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new W($.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new pu(i,o)}(e._query,this._field,this._direction);return new hi(e.firestore,e.converter,function(s,i){const o=s.explicitOrderBy.concat([i]);return new co(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,n))}}function Ot(t,e="asc"){const n=e,r=Hm("orderBy",t);return cw._create(r,n)}class uw extends Gm{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new uw(e,n,r)}_apply(e){return new hi(e.firestore,e.converter,Sf(e._query,this._limit,this._limitType))}}function Mt(t){return a$("limit",t),uw._create("limit",t,"F")}class dw extends Gm{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new dw(e,n,r)}_apply(e){const n=g$(e,this.type,this._docOrFields,this._inclusive);return new hi(e.firestore,e.converter,function(s,i){return new co(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,i,s.endAt)}(e._query,n))}}function qm(...t){return dw._create("startAfter",t,!1)}function g$(t,e,n,r){if(n[0]=Rt(n[0]),n[0]instanceof aw)return function(i,o,l,c,u){if(!c)throw new W($.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${l}().`);const d=[];for(const m of Zo(i))if(m.field.isKeyField())d.push(_f(o,c.key));else{const p=c.data.field(m.field);if(Rm(p))throw new W($.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+m.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(p===null){const g=m.field.canonicalString();throw new W($.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${g}' (used as the orderBy) does not exist.`)}d.push(p)}return new xl(d,u)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{const s=zl(t.firestore);return function(o,l,c,u,d,m){const p=o.explicitOrderBy;if(d.length>p.length)throw new W($.INVALID_ARGUMENT,`Too many arguments provided to ${u}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const g=[];for(let x=0;x<d.length;x++){const w=d[x];if(p[x].field.isKeyField()){if(typeof w!="string")throw new W($.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${u}(), but got a ${typeof w}`);if(!Dv(o)&&w.indexOf("/")!==-1)throw new W($.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${u}() must be a plain document ID, but '${w}' contains a slash.`);const v=o.path.child(Xe.fromString(w));if(!ae.isDocumentKey(v))throw new W($.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${u}() must result in a valid document path, but '${v}' is not because it contains an odd number of segments.`);const S=new ae(v);g.push(_f(l,S))}else{const v=aC(c,u,w);g.push(v)}}return new xl(g,m)}(t._query,t.firestore._databaseId,s,e,n,r)}}function Fb(t,e,n){if(typeof(n=Rt(n))=="string"){if(n==="")throw new W($.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Dv(e)&&n.indexOf("/")!==-1)throw new W($.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Xe.fromString(n));if(!ae.isDocumentKey(r))throw new W($.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return _f(t,new ae(r))}if(n instanceof Fn)return _f(t,n._key);throw new W($.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${zm(n)}.`)}function Mb(t,e){if(!Array.isArray(t)||t.length===0)throw new W($.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function uC(t,e){const n=function(s,i){for(const o of s)for(const l of o.getFlattenedFilters())if(i.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new W($.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new W($.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class x${convertValue(e,n="none"){switch(Wa(e)){case 0:return null;case 1:return e.booleanValue;case 2:return xt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Ga(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw me()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return lo(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var n,r,s;const i=(s=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(o=>xt(o.doubleValue));return new Zv(i)}convertGeoPoint(e){return new Jv(xt(e.latitude),xt(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=Nv(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(hu(e));default:return null}}convertTimestamp(e){const n=Zi(e);return new Tt(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Xe.fromString(e);Ge(CI(r));const s=new fu(r.get(1),r.get(3)),i=new ae(r.popFirst(5));return s.isEqual(n)||ri(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hw(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tc{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class dC extends aw{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Nh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Hm("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class Nh extends dC{data(e={}){return super.data(e)}}class y${constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new Tc(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Nh(this._firestore,this._userDataWriter,r.key,r,new Tc(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new W($.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(l=>{const c=new Nh(s._firestore,s._userDataWriter,l.doc.key,l.doc,new Tc(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);return l.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(l=>i||l.type!==3).map(l=>{const c=new Nh(s._firestore,s._userDataWriter,l.doc.key,l.doc,new Tc(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);let u=-1,d=-1;return l.type!==0&&(u=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),d=o.indexOf(l.doc.key)),{type:v$(l.type),doc:c,oldIndex:u,newIndex:d}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function v$(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return me()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _l(t){t=Mr(t,Fn);const e=Mr(t.firestore,ua);return r$(Vm(e),t._key).then(n=>b$(e,t,n))}class hC extends x${constructor(e){super(),this.firestore=e}convertBytes(e){return new wl(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Fn(this.firestore,null,n)}}function bt(t){t=Mr(t,hi);const e=Mr(t.firestore,ua),n=Vm(e),r=new hC(e);return p$(t._query),s$(n,t._query).then(s=>new y$(e,r,t,s))}function Nx(t,e,n){t=Mr(t,Fn);const r=Mr(t.firestore,ua),s=hw(t.converter,e,n);return Qu(r,[tw(zl(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,Pn.none())])}function w$(t,e,n,...r){t=Mr(t,Fn);const s=Mr(t.firestore,ua),i=zl(s);let o;return o=typeof(e=Rt(e))=="string"||e instanceof $l?iC(i,"updateDoc",t._key,e,n,r):sC(i,"updateDoc",t._key,e),Qu(s,[o.toMutation(t._key,Pn.exists(!0))])}function _$(t){return Qu(Mr(t.firestore,ua),[new Mm(t._key,Pn.none())])}function S$(t,e){const n=Mr(t.firestore,ua),r=it(t),s=hw(t.converter,e);return Qu(n,[tw(zl(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,Pn.exists(!1))]).then(()=>r)}function Qu(t,e){return function(r,s){const i=new Ks;return r.asyncQueue.enqueueAndForget(async()=>W9(await n$(r),s,i)),i.promise}(Vm(t),e)}function b$(t,e,n){const r=n.docs.get(e._key),s=new hC(t);return new dC(t,s,e._key,r,new Tc(n.hasPendingWrites,n.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E${constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=zl(e)}set(e,n,r){this._verifyNotCommitted();const s=Ng(e,this._firestore),i=hw(s.converter,n,r),o=tw(this._dataReader,"WriteBatch.set",s._key,i,s.converter!==null,r);return this._mutations.push(o.toMutation(s._key,Pn.none())),this}update(e,n,r,...s){this._verifyNotCommitted();const i=Ng(e,this._firestore);let o;return o=typeof(n=Rt(n))=="string"||n instanceof $l?iC(this._dataReader,"WriteBatch.update",i._key,n,r,s):sC(this._dataReader,"WriteBatch.update",i._key,n),this._mutations.push(o.toMutation(i._key,Pn.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=Ng(e,this._firestore);return this._mutations=this._mutations.concat(new Mm(n._key,Pn.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new W($.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Ng(t,e){if((t=Rt(t)).firestore!==e)throw new W($.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}function st(){return new nw("serverTimestamp")}function Qs(t){return new rw("increment",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fi(t){return Vm(t=Mr(t,ua)),new E$(t,e=>Qu(t,e))}(function(e,n=!0){(function(s){Dl=s})(Ml),hl(new Ua("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),l=new ua(new kO(r.getProvider("auth-internal")),new RO(r.getProvider("app-check-internal")),function(u,d){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new W($.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new fu(u.options.projectId,d)}(o,s),o);return i=Object.assign({useFetchStreams:n},i),l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),qi(JS,"4.7.3",e),qi(JS,"4.7.3","esm2017")})();const fC="HD-MP3",bn=t=>(n=>n.toLocaleLowerCase().replace(/à|á|ạ|ả|ã|â|ầ|ấ|ậ|ẩ|ẫ|ă|ắ|ằ|ẳ|ẵ|ặ/g,"a").replace(/è|é|ẹ|ẻ|ẽ|ê|ề|ế|ệ|ể|ễ/g,"e").replace(/ì|í|ị|ỉ|ĩ/g,"i").replace(/ò|ó|ọ|ỏ|õ|ô|ồ|ố|ộ|ổ|ỗ|ơ|ớ|ờ|ở|ỡ|ợ/g,"o").replace(/ù|ú|ụ|ủ|ũ|ư|ừ|ứ|ự|ử|ữ/g,"u").replace(/ỳ|ý|ý|ỷ|ỹ/g,"y").replace(/đ/g,"d"))(t),Xu=HL.create({baseURL:"https://express-zingmp3-production.up.railway.app/api"}),It=()=>JSON.parse(localStorage.getItem(fC)||"{}"),tt=(t,e)=>{const n=It();return n[t]=e,localStorage.setItem(fC,JSON.stringify(n))},Sl=t=>{const e=Math.floor(t/60),n=Math.round(t%60);return`${e}:${n.toString().padStart(2,"0")}`},xr=async t=>new Promise(e=>setTimeout(e,t)),mC=(t,e)=>{t.scrollIntoView({behavior:e||"smooth",block:"center"})},Tf=t=>t?"disable":"",ta=t=>t?"hidden":"",Qi=(t,e)=>t?e:"",j$=t=>{const e=new Date,n=new Date(e.getFullYear(),e.getMonth(),e.getDate(),...t);return Tt.fromDate(n)};let Ah=ff[0];const k$=It(),Db=k$.theme;location.hash.includes("dashboard")?Ah=Ah:Db&&[...ff,...iT].forEach(t=>{t.id===Db&&(Ah=t)});const T$=()=>{const[t,e]=h.useState(Ah);return{theme:t,setTheme:e,isOnMobile:window.innerWidth<768}},pC=h.createContext(null),I$=({children:t})=>a.jsx(pC.Provider,{value:T$(),children:t}),is=()=>{const t=h.useContext(pC);if(!t)throw new Error("ThemeProvider not provided");return t},C$=()=>{const[t,e]=h.useState([]);return{toasts:t,setErrorToast:s=>e(i=>[...i,{variant:"error",id:Date.now()+"",desc:s||"Something went wrong"}]),setSuccessToast:s=>e(i=>[...i,{variant:"success",id:Date.now()+"",desc:s||"Successful"}]),setToasts:e}},gC=h.createContext(null);function R$({children:t}){return a.jsx(gC.Provider,{value:C$(),children:t})}const te=()=>{const t=h.useContext(gC);if(!t)throw new Error("Toast Context not provided");return t};function N$(){const[t,e]=h.useState(),[n,r]=h.useState(),[s,i]=h.useState([]),o=h.useRef(!0),l=h.useMemo(()=>{const u=[];return(t!=null&&t.category_ids?t.category_ids.split("_"):[]).forEach(m=>{const p=s.find(g=>g.id===m);p&&u.push(p)}),u},[t,s]),c=h.useMemo(()=>{const u=[];return(n!=null&&n.category_ids?n.category_ids.split("_"):[]).forEach(m=>{const p=s.find(g=>g.id===m);p&&u.push(p)}),u},[n,s]);return{categoryPage:t,setCategoryPage:e,homePage:n,setHomePage:r,categories:s,setCategories:i,categorySliders:l,homeSliders:c,shouldFetch:o}}const xC=h.createContext(null);function A$({children:t}){return a.jsx(xC.Provider,{value:N$(),children:t})}const En=()=>{const t=h.useContext(xC);if(!t)throw new Error("PageProvider is not provided");return t},P$=()=>{const[t,e]=h.useState([]),[n,r]=h.useState([]),s=h.useRef(!0);return{ahead:t,behind:n,setAhead:e,setBehind:r,shouldStoreLocation:s}},yC=h.createContext(null),vC=()=>{const t=h.useContext(yC);if(!t)throw new Error("Navigation context not provided");return t};function wC(){const{ahead:t,setAhead:e,setBehind:n,shouldStoreLocation:r}=vC(),s=Zn(),i=h.useMemo(()=>s.pathname+s.search,[s]),o=h.useRef(!1);return h.useEffect(()=>{if(!o.current){o.current=!0;return}return()=>{r.current?(t.length&&e([]),n(l=>[...l,i])):r.current=!0}},[s.pathname]),a.jsx(a.Fragment,{})}function _C({children:t}){return a.jsx(yC.Provider,{value:P$(),children:t})}function F$(){const[t,e]=h.useState([]),[n,r]=h.useState(!1);return{uploadingSongs:t,setUploadingSongs:e,isUploading:n,setIsUploading:r,resetUploadContext:()=>{r(!1),e([])}}}const SC=h.createContext(null),M$=({children:t})=>a.jsx(SC.Provider,{value:F$(),children:t}),bC=()=>{const t=h.useContext(SC);if(!t)throw new Error("UploadSongProvider not provided");return t},D$=["Songs","Karaoke","Lyric"],L$=["Playing","Lyric"],Eo=It();function O$(){const[t,e]=h.useState(!1),[n,r]=h.useState(!1),[s,i]=h.useState("Lyric"),[o,l]=h.useState("Lyric"),[c,u]=h.useState(!1),[d,m]=h.useState({lyricSize:Eo.lyricSize||"medium",repeat:Eo.isRepeat||"no",isShuffle:Eo.isShuffle||!1,isCrossFade:Eo.isCrossFade||!1,songBackground:Eo.songBackground||!0,songImage:Eo.songImage||!0,isEnableBeat:!1}),p=h.useRef(!0),g=h.useRef(0),x=h.useRef(!0),w=h.useRef(""),v=h.useRef(!1),S=h.useRef("var(--primary-cl)"),_=h.useRef(null),E=h.useRef(null),I=h.useRef(null);return{audioRef:_,themeCodeRef:w,isOpenFullScreen:t,isOpenSongQueue:n,idle:c,setIdle:u,setIsOpenFullScreen:e,setIsOpenSongQueue:r,activeTab:s,setActiveTab:i,desktopTabs:D$,mobileActiveTab:o,setMobileActiveTab:l,mobileTabs:L$,playerConfig:d,updatePlayerConfig:F=>{m(k=>({...k,...F}))},firstTimeSongLoaded:p,timelineEleRef:E,currentTimeEleRef:I,startFadeWhenEnd:g,isPlayingNewSong:x,shouldSyncSongDuration:v,timeLineColorRef:S}}const EC=h.createContext(null);function $$({children:t}){return a.jsx(EC.Provider,{value:O$(),children:t})}function ht(){const t=h.useContext(EC);if(!t)throw new Error("Player Context not provided");return t}const z$=()=>{const[t,e]=h.useState([]),[n,r]=h.useState(!1),s=h.useRef(!0);return{songLyrics:t,setSongLyrics:e,loading:n,setLoading:r,shouldGetLyric:s}},jC=h.createContext(null);function kC({children:t}){return a.jsx(jC.Provider,{value:z$(),children:t})}const fw=()=>{const t=h.useContext(jC);if(!t)throw new Error("Lyric context not found");return t},B$=()=>{const[t,e]=h.useState(!1),[n,r]=h.useState(!1),[s,i]=h.useState([]);return{isChecked:t,setIsChecked:e,isSelectAll:n,setIsSelectAll:r,setSelectedSongs:i,selectedSongs:s,selectAllSong:u=>{e(!0),r(!0),i(u)},selectSong:u=>{const d=[...s],m=d.findIndex(p=>p.id===u.id);m===-1?d.push(u):d.splice(m,1),e(!!d.length),i(d)},resetSelect:()=>{e(!1),r(!1),i([])}}},TC=h.createContext(null);function jn({children:t}){return a.jsx(TC.Provider,{value:B$(),children:t})}const ho=()=>{const t=h.useContext(TC);if(!t)throw new Error("SelectSongContext not provided");return t};function Ag({onClick:t,theme:e,active:n}){return a.jsx(a.Fragment,{children:a.jsxs("div",{className:"w-[25%] px-2 mt-3 max-[549px]:w-[50%]",children:[a.jsx("div",{onClick:()=>t(e),className:`relative shadow-[0_0_6px_0_rgba(0,0,0,.15)] border-l-[20px] ${e.container} ${e.border}  pt-[100%] rounded-xl`,children:n&&a.jsx("div",{className:"absolute bottom-[10px] right-[10px]",children:a.jsx(pF,{className:"w-[25px]"})})}),a.jsx("p",{className:"text-base font-[500] mt-1",children:e.name})]})})}function IC({closeModal:t}){const{theme:e,setTheme:n}=is(),r=c=>{tt("theme",c.id),n(c)},s={themeContainer:"overflow-auto flex-grow no-scrollbar space-y-5 pb-[5vh]",themeList:"flex flex-row -mx-2 -mt-3 flex-wrap"},i=ff.map(c=>{const u=c.id===e.id;if(c.type==="light")return a.jsx(Ag,{active:u,theme:c,onClick:r},c.id)}),o=ff.map(c=>{const u=c.id===e.id;if(c.type==="dark")return a.jsx(Ag,{active:u,theme:c,onClick:r},c.id)}),l=iT.map(c=>{const u=c.id===e.id;return a.jsx(Ag,{active:u,theme:c,onClick:r},c.id)});return a.jsxs(ve,{className:"w-[900px]",children:[a.jsx(Be,{closeModal:t,title:"Themes"}),a.jsxs("div",{className:s.themeContainer,children:[a.jsxs("div",{children:[a.jsx(Z,{variant:"h2",className:"mb-3",title:"Specical"}),a.jsx("div",{className:s.themeList,children:l})]}),a.jsxs("div",{children:[a.jsx(Z,{variant:"h2",className:"mb-3",title:"Dark"}),a.jsx("div",{className:s.themeList,children:o})]}),a.jsxs("div",{children:[a.jsx(Z,{variant:"h2",className:"mb-3",title:"Light"}),a.jsx("div",{className:s.themeList,children:i})]})]})]})}function an({loading:t,callback:e,label:n,children:r,closeModal:s,desc:i="This action cannot be undone"}){return a.jsxs(ve,{className:"w-[450px]",children:[a.jsx(Be,{closeModal:s,title:n||"Wait a minute"}),i&&a.jsx("p",{className:"font-semibold text-lg text-red-400",children:i}),a.jsx("div",{className:"flex space-x-3 mt-5",children:r||a.jsxs(a.Fragment,{children:[a.jsx(se,{onClick:s,disabled:t,className:"hover:bg-[--a-5-cl] rounded-full px-3 py-1",variant:"primary",size:"clear",children:"Close"}),a.jsx(se,{isLoading:t,color:"primary",className:"rounded-full px-3",variant:"primary",size:"clear",onClick:e,children:"Yes, Please"})]})})]})}const V$=[3,5,7,10];function CC({closeModal:t,active:e}){const n={button:"bg-[--a-5-cl] hover:bg-[--primary-cl] ml-2 mt-2 px-3  py-1 rounded-[99px]"},r=i=>{e(i),t()},s=V$.map(i=>a.jsxs("button",{type:"button",onClick:()=>r(i),className:`${n.button} `,children:[i," songs"]},i));return a.jsxs(ve,{children:[a.jsx(Be,{closeModal:t,title:"Sleep timer"}),a.jsx("div",{children:a.jsx("div",{className:"flex flex-wrap -mt-2 -ml-2 mb-3",children:s})})]})}function U$({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{fillRule:"evenodd",d:"M15.312 11.424a5.5 5.5 0 01-9.201 2.466l-.312-.311h2.433a.75.75 0 000-1.5H3.989a.75.75 0 00-.75.75v4.242a.75.75 0 001.5 0v-2.43l.31.31a7 7 0 0011.712-3.138.75.75 0 00-1.449-.39zm1.23-3.723a.75.75 0 00.219-.53V2.929a.75.75 0 00-1.5 0V5.36l-.31-.31A7 7 0 003.239 8.188a.75.75 0 101.448.389A5.5 5.5 0 0113.89 6.11l.311.31h-2.432a.75.75 0 000 1.5h4.243a.75.75 0 00.53-.219z",clipRule:"evenodd"}))}const H$=h.forwardRef(U$),RC=H$;function G$({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{fillRule:"evenodd",d:"M10 17a.75.75 0 01-.75-.75V5.612L5.29 9.77a.75.75 0 01-1.08-1.04l5.25-5.5a.75.75 0 011.08 0l5.25 5.5a.75.75 0 11-1.08 1.04l-3.96-4.158V16.25A.75.75 0 0110 17z",clipRule:"evenodd"}))}const W$=h.forwardRef(G$),q$=W$;function K$({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{fillRule:"evenodd",d:"M2 4.75A.75.75 0 012.75 4h14.5a.75.75 0 010 1.5H2.75A.75.75 0 012 4.75zM2 10a.75.75 0 01.75-.75h14.5a.75.75 0 010 1.5H2.75A.75.75 0 012 10zm0 5.25a.75.75 0 01.75-.75h14.5a.75.75 0 010 1.5H2.75a.75.75 0 01-.75-.75z",clipRule:"evenodd"}))}const Q$=h.forwardRef(K$),X$=Q$;function Y$({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{fillRule:"evenodd",d:"M3.43 2.524A41.29 41.29 0 0110 2c2.236 0 4.43.18 6.57.524 1.437.231 2.43 1.49 2.43 2.902v5.148c0 1.413-.993 2.67-2.43 2.902a41.102 41.102 0 01-3.55.414c-.28.02-.521.18-.643.413l-1.712 3.293a.75.75 0 01-1.33 0l-1.713-3.293a.783.783 0 00-.642-.413 41.108 41.108 0 01-3.55-.414C1.993 13.245 1 11.986 1 10.574V5.426c0-1.413.993-2.67 2.43-2.902z",clipRule:"evenodd"}))}const J$=h.forwardRef(Y$),Z$=J$;function ez({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{fillRule:"evenodd",d:"M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.05-.143z",clipRule:"evenodd"}))}const tz=h.forwardRef(ez),Yu=tz;function nz({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{fillRule:"evenodd",d:"M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z",clipRule:"evenodd"}))}const rz=h.forwardRef(nz),sz=rz;function iz({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm.75-13a.75.75 0 00-1.5 0v5c0 .414.336.75.75.75h4a.75.75 0 000-1.5h-3.25V5z",clipRule:"evenodd"}))}const az=h.forwardRef(iz),oz=az;function lz({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"}))}const cz=h.forwardRef(lz),NC=cz;function uz({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.536-4.464a.75.75 0 10-1.061-1.061 3.5 3.5 0 01-4.95 0 .75.75 0 00-1.06 1.06 5 5 0 007.07 0zM9 8.5c0 .828-.448 1.5-1 1.5s-1-.672-1-1.5S7.448 7 8 7s1 .672 1 1.5zm3 1.5c.552 0 1-.672 1-1.5S12.552 7 12 7s-1 .672-1 1.5.448 1.5 1 1.5z",clipRule:"evenodd"}))}const dz=h.forwardRef(uz),hz=dz;function fz({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{d:"M9.653 16.915l-.005-.003-.019-.01a20.759 20.759 0 01-1.162-.682 22.045 22.045 0 01-2.582-1.9C4.045 12.733 2 10.352 2 7.5a4.5 4.5 0 018-2.828A4.5 4.5 0 0118 7.5c0 2.852-2.044 5.233-3.885 6.82a22.049 22.049 0 01-3.744 2.582l-.019.01-.005.003h-.002a.739.739 0 01-.69.001l-.002-.001z"}))}const mz=h.forwardRef(fz),Bl=mz;function pz({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{fillRule:"evenodd",d:"M9.293 2.293a1 1 0 011.414 0l7 7A1 1 0 0117 11h-1v6a1 1 0 01-1 1h-2a1 1 0 01-1-1v-3a1 1 0 00-1-1H9a1 1 0 00-1 1v3a1 1 0 01-1 1H5a1 1 0 01-1-1v-6H3a1 1 0 01-.707-1.707l7-7z",clipRule:"evenodd"}))}const gz=h.forwardRef(pz),xz=gz;function yz({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{d:"M5.75 3a.75.75 0 00-.75.75v12.5c0 .414.336.75.75.75h1.5a.75.75 0 00.75-.75V3.75A.75.75 0 007.25 3h-1.5zM12.75 3a.75.75 0 00-.75.75v12.5c0 .414.336.75.75.75h1.5a.75.75 0 00.75-.75V3.75a.75.75 0 00-.75-.75h-1.5z"}))}const vz=h.forwardRef(yz),Ju=vz;function wz({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{d:"M5.433 13.917l1.262-3.155A4 4 0 017.58 9.42l6.92-6.918a2.121 2.121 0 013 3l-6.92 6.918c-.383.383-.84.685-1.343.886l-3.154 1.262a.5.5 0 01-.65-.65z"}),h.createElement("path",{d:"M3.5 5.75c0-.69.56-1.25 1.25-1.25H10A.75.75 0 0010 3H4.75A2.75 2.75 0 002 5.75v9.5A2.75 2.75 0 004.75 18h9.5A2.75 2.75 0 0017 15.25V10a.75.75 0 00-1.5 0v5.25c0 .69-.56 1.25-1.25 1.25h-9.5c-.69 0-1.25-.56-1.25-1.25v-9.5z"}))}const _z=h.forwardRef(wz),Sz=_z;function bz({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{d:"M6.3 2.841A1.5 1.5 0 004 4.11V15.89a1.5 1.5 0 002.3 1.269l9.344-5.89a1.5 1.5 0 000-2.538L6.3 2.84z"}))}const Ez=h.forwardRef(bz),qa=Ez;function jz({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{d:"M10.75 4.75a.75.75 0 00-1.5 0v4.5h-4.5a.75.75 0 000 1.5h4.5v4.5a.75.75 0 001.5 0v-4.5h4.5a.75.75 0 000-1.5h-4.5v-4.5z"}))}const kz=h.forwardRef(jz),js=kz;function Tz({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{d:"M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"}))}const Iz=h.forwardRef(Tz),Zu=Iz,Cz=Pu("",{variants:{variant:{h1:"text-2xl font-bold",h2:"text-xl font-semibold",h3:"text-lg font-semibold"}},defaultVariants:{variant:"h1"}});function Z({title:t,variant:e,className:n=""}){return a.jsx("div",{className:`${Cz({variant:e,className:n})} `,children:t})}function Be({closeModal:t,title:e}){return a.jsxs("div",{className:"flex justify-between items-center mb-3",children:[a.jsx(Z,{title:e}),a.jsx("button",{onClick:t,children:a.jsx(Zu,{className:"w-7"})})]})}const Lb=Pu("inline-flex relative hover:brightness-95 space-x-1 items-center z-0",{variants:{variant:{primary:"before:content-[''] before:absolute before:z-[-1] before:inset-0 active:translate-y-[2px] active:before:shadow-none",clear:"before:content-none"},color:{primary:"before:border-[#4a826f] text-[#fff] bg-[--primary-cl] before:shadow-[0_2px_0_#4a826f]",second:"before:border-[#ccc] text-[#333] bg-[#f6f6f6] before:shadow-[0_2px_0_#ccc]",clear:""},size:{primary:"px-5 py-1.5",clear:""},fontWeight:{primary:"",clear:""},border:{primary:"before:border-[2px]",thin:"before:border-[1px]",clear:"before:border-b-[2px]"},rounded:{xl:"before:rounded-xl rounded-xl",lg:"before:rounded-lg rounded-lg",md:"before:rounded-md rounded-md"}},defaultVariants:{variant:"primary",color:"primary",size:"primary",fontWeight:"primary",border:"primary",rounded:"lg"}});function Rz({onClick:t,loading:e,children:n,border:r,size:s,color:i,fontWeight:o,type:l="button",variant:c,disabled:u,rounded:d,className:m,active:p,href:g},x){const w=u||e,v="before:shadow-none translate-y-[2px]";return a.jsx(a.Fragment,{children:g?a.jsx(Y,{to:g,className:`${Lb({variant:c,size:s,color:i,fontWeight:o,rounded:d,border:r,className:m})} ${p?v:""}`,children:n}):a.jsx("button",{ref:x,type:l||"button",onClick:t,disabled:w,className:`${Lb({variant:c,size:s,color:p?"primary":i,border:r,fontWeight:o,className:m})} ${p?v:""}`,children:e?a.jsx(Ie,{className:"w-6 animate-spin"}):n})})}const q=h.forwardRef(Rz),Nz=Pu("border-2 border-b-[6px] rounded-xl",{variants:{p:{3:"p-3",clear:""}},defaultVariants:{p:"3"}});function $t({children:t,onClick:e,p:n,className:r=""}){return a.jsx("div",{onClick:()=>e?e():{},className:`${Nz({p:n,className:r})} `,children:t})}function Un({className:t=""}){return a.jsx("div",{className:`flex flex-grow items-center justify-center ${t}`,children:a.jsx(Ie,{className:"w-6 animate-spin"})})}function ks({children:t,margin:e=!0,className:n=""}){const r=`${e?"mt-2 ml-2":""} font-medium flex px-3 py-1.5 text-sm rounded-lg bg-[#fff] border-[2px] border-[#e1e1e1] [&>div]:ml-1.5 [&>div]:pl-1.5 [&>div]:border [&>div]:border-transparent [&>div]:flex [&>div]:space-x-1 [&>div]:border-l-black/10 hover:[&_button]:scale-[1.05] ${n}`;return a.jsx("div",{className:r,children:t})}function Az({children:t,...e},n){return a.jsx(re,{variant:"animation",...e,ref:n,children:t})}const mw=h.forwardRef(Az);function Vl({children:t,className:e=""}){return a.jsx("div",{className:`-ml-2 -mt-2 flex flex-wrap [&_button]:mt-2 [&_button]:ml-2 [&_button:not(.except)]:p-1.5 [&_svg]:w-5 [&_svg]:flex-shrink-0 md:[&_button:not(.except)]:px-3 ${e} `,children:t})}var Pz="firebase",Fz="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */qi(Pz,Fz,"app");function pw(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function AC(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Mz=AC,PC=new $u("auth","Firebase",AC());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const If=new kv("@firebase/auth");function Dz(t,...e){If.logLevel<=Fe.WARN&&If.warn(`Auth (${Ml}): ${t}`,...e)}function Ph(t,...e){If.logLevel<=Fe.ERROR&&If.error(`Auth (${Ml}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ts(t,...e){throw xw(t,...e)}function es(t,...e){return xw(t,...e)}function gw(t,e,n){const r=Object.assign(Object.assign({},Mz()),{[e]:n});return new $u("auth","Firebase",r).create(e,{appName:t.name})}function Da(t){return gw(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Lz(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&Ts(t,"argument-error"),gw(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function xw(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return PC.create(t,...e)}function fe(t,e,...n){if(!t)throw xw(e,...n)}function Us(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Ph(e),new Error(e)}function ii(t,e){t||Us(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ax(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function Oz(){return Ob()==="http:"||Ob()==="https:"}function Ob(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $z(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Oz()||s6()||"connection"in navigator)?navigator.onLine:!0}function zz(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ed{constructor(e,n){this.shortDelay=e,this.longDelay=n,ii(n>e,"Short delay should be less than long delay!"),this.isMobile=t6()||i6()}get(){return $z()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yw(t,e){ii(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FC{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Us("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Us("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Us("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bz={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vz=new ed(3e4,6e4);function vw(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Ul(t,e,n,r,s={}){return MC(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const l=zu(Object.assign({key:t.config.apiKey},o)).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const u=Object.assign({method:e,headers:c},i);return r6()||(u.referrerPolicy="no-referrer"),FC.fetch()(DC(t,t.config.apiHost,n,l),u)})}async function MC(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},Bz),e);try{const s=new Hz(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw Yd(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const l=i.ok?o.errorMessage:o.error.message,[c,u]=l.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Yd(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw Yd(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw Yd(t,"user-disabled",o);const d=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw gw(t,d,u);Ts(t,d)}}catch(s){if(s instanceof di)throw s;Ts(t,"network-request-failed",{message:String(s)})}}async function Uz(t,e,n,r,s={}){const i=await Ul(t,e,n,r,s);return"mfaPendingCredential"in i&&Ts(t,"multi-factor-auth-required",{_serverResponse:i}),i}function DC(t,e,n,r){const s=`${e}${n}?${r}`;return t.config.emulator?yw(t.config,s):`${t.config.apiScheme}://${s}`}class Hz{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(es(this.auth,"network-request-failed")),Vz.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Yd(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=es(t,e,r);return s.customData._tokenResponse=n,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Gz(t,e){return Ul(t,"POST","/v1/accounts:delete",e)}async function LC(t,e){return Ul(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vc(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Wz(t,e=!1){const n=Rt(t),r=await n.getIdToken(e),s=ww(r);fe(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:Vc(Pg(s.auth_time)),issuedAtTime:Vc(Pg(s.iat)),expirationTime:Vc(Pg(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Pg(t){return Number(t)*1e3}function ww(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Ph("JWT malformed, contained fewer than 3 sections"),null;try{const s=PT(n);return s?JSON.parse(s):(Ph("Failed to decode base64 JWT payload"),null)}catch(s){return Ph("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function $b(t){const e=ww(t);return fe(e,"internal-error"),fe(typeof e.exp<"u","internal-error"),fe(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wu(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof di&&qz(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function qz({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kz{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Px{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Vc(this.lastLoginAt),this.creationTime=Vc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Cf(t){var e;const n=t.auth,r=await t.getIdToken(),s=await wu(t,LC(n,{idToken:r}));fe(s==null?void 0:s.users.length,n,"internal-error");const i=s.users[0];t._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?OC(i.providerUserInfo):[],l=Xz(t.providerData,o),c=t.isAnonymous,u=!(t.email&&i.passwordHash)&&!(l!=null&&l.length),d=c?u:!1,m={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:l,metadata:new Px(i.createdAt,i.lastLoginAt),isAnonymous:d};Object.assign(t,m)}async function Qz(t){const e=Rt(t);await Cf(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Xz(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function OC(t){return t.map(e=>{var{providerId:n}=e,r=pw(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Yz(t,e){const n=await MC(t,{},async()=>{const r=zu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=DC(t,s,"/v1/token",`key=${i}`),l=await t._getAdditionalHeaders();return l["Content-Type"]="application/x-www-form-urlencoded",FC.fetch()(o,{method:"POST",headers:l,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function Jz(t,e){return Ul(t,"POST","/v2/accounts:revokeToken",vw(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){fe(e.idToken,"internal-error"),fe(typeof e.idToken<"u","internal-error"),fe(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):$b(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){fe(e.length!==0,"internal-error");const n=$b(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(fe(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await Yz(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new tl;return r&&(fe(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(fe(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(fe(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new tl,this.toJSON())}_performRefresh(){return Us("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Si(t,e){fe(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Hs{constructor(e){var{uid:n,auth:r,stsTokenManager:s}=e,i=pw(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Kz(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Px(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await wu(this,this.stsTokenManager.getToken(this.auth,e));return fe(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return Wz(this,e)}reload(){return Qz(this)}_assign(e){this!==e&&(fe(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Hs(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){fe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Cf(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Vs(this.auth.app))return Promise.reject(Da(this.auth));const e=await this.getIdToken();return await wu(this,Gz(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,s,i,o,l,c,u,d;const m=(r=n.displayName)!==null&&r!==void 0?r:void 0,p=(s=n.email)!==null&&s!==void 0?s:void 0,g=(i=n.phoneNumber)!==null&&i!==void 0?i:void 0,x=(o=n.photoURL)!==null&&o!==void 0?o:void 0,w=(l=n.tenantId)!==null&&l!==void 0?l:void 0,v=(c=n._redirectEventId)!==null&&c!==void 0?c:void 0,S=(u=n.createdAt)!==null&&u!==void 0?u:void 0,_=(d=n.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:E,emailVerified:I,isAnonymous:N,providerData:F,stsTokenManager:k}=n;fe(E&&k,e,"internal-error");const j=tl.fromJSON(this.name,k);fe(typeof E=="string",e,"internal-error"),Si(m,e.name),Si(p,e.name),fe(typeof I=="boolean",e,"internal-error"),fe(typeof N=="boolean",e,"internal-error"),Si(g,e.name),Si(x,e.name),Si(w,e.name),Si(v,e.name),Si(S,e.name),Si(_,e.name);const C=new Hs({uid:E,auth:e,email:p,emailVerified:I,displayName:m,isAnonymous:N,photoURL:x,phoneNumber:g,tenantId:w,stsTokenManager:j,createdAt:S,lastLoginAt:_});return F&&Array.isArray(F)&&(C.providerData=F.map(R=>Object.assign({},R))),v&&(C._redirectEventId=v),C}static async _fromIdTokenResponse(e,n,r=!1){const s=new tl;s.updateFromServerResponse(n);const i=new Hs({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await Cf(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];fe(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?OC(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),l=new tl;l.updateFromIdToken(r);const c=new Hs({uid:s.localId,auth:e,stsTokenManager:l,isAnonymous:o}),u={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new Px(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(c,u),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zb=new Map;function Gs(t){ii(t instanceof Function,"Expected a class definition");let e=zb.get(t);return e?(ii(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,zb.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $C{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}$C.type="NONE";const Bb=$C;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fh(t,e,n){return`firebase:${t}:${e}:${n}`}class nl{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=Fh(this.userKey,s.apiKey,i),this.fullPersistenceKey=Fh("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Hs._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new nl(Gs(Bb),e,r);const s=(await Promise.all(n.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let i=s[0]||Gs(Bb);const o=Fh(r,e.config.apiKey,e.name);let l=null;for(const u of n)try{const d=await u._get(o);if(d){const m=Hs._fromJSON(e,d);u!==i&&(l=m),i=u;break}}catch{}const c=s.filter(u=>u._shouldAllowMigration);return!i._shouldAllowMigration||!c.length?new nl(i,e,r):(i=c[0],l&&await i._set(o,l.toJSON()),await Promise.all(n.map(async u=>{if(u!==i)try{await u._remove(o)}catch{}})),new nl(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vb(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(UC(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(zC(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(GC(e))return"Blackberry";if(WC(e))return"Webos";if(BC(e))return"Safari";if((e.includes("chrome/")||VC(e))&&!e.includes("edge/"))return"Chrome";if(HC(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function zC(t=Sn()){return/firefox\//i.test(t)}function BC(t=Sn()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function VC(t=Sn()){return/crios\//i.test(t)}function UC(t=Sn()){return/iemobile/i.test(t)}function HC(t=Sn()){return/android/i.test(t)}function GC(t=Sn()){return/blackberry/i.test(t)}function WC(t=Sn()){return/webos/i.test(t)}function _w(t=Sn()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function Zz(t=Sn()){var e;return _w(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function eB(){return a6()&&document.documentMode===10}function qC(t=Sn()){return _w(t)||HC(t)||WC(t)||GC(t)||/windows phone/i.test(t)||UC(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KC(t,e=[]){let n;switch(t){case"Browser":n=Vb(Sn());break;case"Worker":n=`${Vb(Sn())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Ml}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tB{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,l)=>{try{const c=e(i);o(c)}catch(c){l(c)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nB(t,e={}){return Ul(t,"GET","/v2/passwordPolicy",vw(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rB=6;class sB{constructor(e){var n,r,s,i;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:rB,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,s,i,o,l;const c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(n=c.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),c.isValid&&(c.isValid=(r=c.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(s=c.containsLowercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(i=c.containsUppercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(l=c.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),c}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iB{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ub(this),this.idTokenSubscription=new Ub(this),this.beforeStateQueue=new tB(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=PC,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Gs(n)),this._initializationPromise=this.queue(async()=>{var r,s;if(!this._deleted&&(this.persistenceManager=await nl.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await LC(this,{idToken:e}),r=await Hs._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(Vs(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let s=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,l=s==null?void 0:s._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===l)&&(c!=null&&c.user)&&(s=c.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return fe(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Cf(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=zz()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Vs(this.app))return Promise.reject(Da(this));const n=e?Rt(e):null;return n&&fe(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&fe(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Vs(this.app)?Promise.reject(Da(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Vs(this.app)?Promise.reject(Da(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Gs(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await nB(this),n=new sB(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new $u("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await Jz(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Gs(e)||this._popupRedirectResolver;fe(n,this,"argument-error"),this.redirectPersistenceManager=await nl.create(this,[Gs(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(fe(l,this,"internal-error"),l.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const c=e.addObserver(n,r,s);return()=>{o=!0,c()}}else{const c=e.addObserver(n);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return fe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=KC(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(n["X-Firebase-AppCheck"]=s),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&Dz(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function Km(t){return Rt(t)}class Ub{constructor(e){this.auth=e,this.observer=null,this.addObserver=m6(n=>this.observer=n)}get next(){return fe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Sw={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function aB(t){Sw=t}function oB(t){return Sw.loadJS(t)}function lB(){return Sw.gapiScript}function cB(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uB(t,e){const n=Iv(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(yf(i,e??{}))return s;Ts(s,"already-initialized")}return n.initialize({options:e})}function dB(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Gs);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function hB(t,e,n){const r=Km(t);fe(r._canInitEmulator,r,"emulator-config-failed"),fe(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!!(n!=null&&n.disableWarnings),i=QC(e),{host:o,port:l}=fB(e),c=l===null?"":`:${l}`;r.config.emulator={url:`${i}//${o}${c}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:l,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),s||mB()}function QC(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function fB(t){const e=QC(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:Hb(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:Hb(o)}}}function Hb(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function mB(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XC{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Us("not implemented")}_getIdTokenResponse(e){return Us("not implemented")}_linkToIdToken(e,n){return Us("not implemented")}_getReauthenticationResolver(e){return Us("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rl(t,e){return Uz(t,"POST","/v1/accounts:signInWithIdp",vw(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pB="http://localhost";class Ka extends XC{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Ka(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Ts("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=n,i=pw(n,["providerId","signInMethod"]);if(!r||!s)return null;const o=new Ka(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return rl(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,rl(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,rl(e,n)}buildRequest(){const e={requestUri:pB,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=zu(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bw{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class td extends bw{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ii extends td{constructor(){super("facebook.com")}static credential(e){return Ka._fromParams({providerId:Ii.PROVIDER_ID,signInMethod:Ii.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ii.credentialFromTaggedObject(e)}static credentialFromError(e){return Ii.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ii.credential(e.oauthAccessToken)}catch{return null}}}Ii.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ii.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $s extends td{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Ka._fromParams({providerId:$s.PROVIDER_ID,signInMethod:$s.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return $s.credentialFromTaggedObject(e)}static credentialFromError(e){return $s.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return $s.credential(n,r)}catch{return null}}}$s.GOOGLE_SIGN_IN_METHOD="google.com";$s.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ci extends td{constructor(){super("github.com")}static credential(e){return Ka._fromParams({providerId:Ci.PROVIDER_ID,signInMethod:Ci.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ci.credentialFromTaggedObject(e)}static credentialFromError(e){return Ci.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ci.credential(e.oauthAccessToken)}catch{return null}}}Ci.GITHUB_SIGN_IN_METHOD="github.com";Ci.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ri extends td{constructor(){super("twitter.com")}static credential(e,n){return Ka._fromParams({providerId:Ri.PROVIDER_ID,signInMethod:Ri.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Ri.credentialFromTaggedObject(e)}static credentialFromError(e){return Ri.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Ri.credential(n,r)}catch{return null}}}Ri.TWITTER_SIGN_IN_METHOD="twitter.com";Ri.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bl{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await Hs._fromIdTokenResponse(e,r,s),o=Gb(r);return new bl({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=Gb(r);return new bl({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function Gb(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rf extends di{constructor(e,n,r,s){var i;super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,Rf.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new Rf(e,n,r,s)}}function YC(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Rf._fromErrorAndOperation(t,i,e,r):i})}async function gB(t,e,n=!1){const r=await wu(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return bl._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xB(t,e,n=!1){const{auth:r}=t;if(Vs(r.app))return Promise.reject(Da(r));const s="reauthenticate";try{const i=await wu(t,YC(r,s,e,t),n);fe(i.idToken,r,"internal-error");const o=ww(i.idToken);fe(o,r,"internal-error");const{sub:l}=o;return fe(t.uid===l,r,"user-mismatch"),bl._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&Ts(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yB(t,e,n=!1){if(Vs(t.app))return Promise.reject(Da(t));const r="signIn",s=await YC(t,r,e),i=await bl._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}function vB(t,e,n,r){return Rt(t).onIdTokenChanged(e,n,r)}function wB(t,e,n){return Rt(t).beforeAuthStateChanged(e,n)}function _B(t,e,n,r){return Rt(t).onAuthStateChanged(e,n,r)}function SB(t){return Rt(t).signOut()}const Nf="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JC{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Nf,"1"),this.storage.removeItem(Nf),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bB=1e3,EB=10;class ZC extends JC{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=qC(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,l,c)=>{this.notifyListeners(o,c)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);eB()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,EB):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},bB)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}ZC.type="LOCAL";const jB=ZC;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eR extends JC{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}eR.type="SESSION";const tR=eR;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kB(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qm{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new Qm(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const l=Array.from(o).map(async u=>u(n.origin,i)),c=await kB(l);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:c})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Qm.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ew(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TB{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((l,c)=>{const u=Ew("",20);s.port1.start();const d=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(m){const p=m;if(p.data.eventId===u)switch(p.data.status){case"ack":clearTimeout(d),i=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),l(p.data.response);break;default:clearTimeout(d),clearTimeout(i),c(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bs(){return window}function IB(t){bs().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nR(){return typeof bs().WorkerGlobalScope<"u"&&typeof bs().importScripts=="function"}async function CB(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function RB(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function NB(){return nR()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rR="firebaseLocalStorageDb",AB=1,Af="firebaseLocalStorage",sR="fbase_key";class nd{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Xm(t,e){return t.transaction([Af],e?"readwrite":"readonly").objectStore(Af)}function PB(){const t=indexedDB.deleteDatabase(rR);return new nd(t).toPromise()}function Fx(){const t=indexedDB.open(rR,AB);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Af,{keyPath:sR})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Af)?e(r):(r.close(),await PB(),e(await Fx()))})})}async function Wb(t,e,n){const r=Xm(t,!0).put({[sR]:e,value:n});return new nd(r).toPromise()}async function FB(t,e){const n=Xm(t,!1).get(e),r=await new nd(n).toPromise();return r===void 0?null:r.value}function qb(t,e){const n=Xm(t,!0).delete(e);return new nd(n).toPromise()}const MB=800,DB=3;class iR{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Fx(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>DB)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return nR()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Qm._getInstance(NB()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await CB(),!this.activeServiceWorker)return;this.sender=new TB(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||RB()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Fx();return await Wb(e,Nf,"1"),await qb(e,Nf),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>Wb(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>FB(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>qb(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=Xm(s,!1).getAll();return new nd(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),MB)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}iR.type="LOCAL";const LB=iR;new ed(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aR(t,e){return e?Gs(e):(fe(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jw extends XC{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return rl(e,this._buildIdpRequest())}_linkToIdToken(e,n){return rl(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return rl(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function OB(t){return yB(t.auth,new jw(t),t.bypassAuthState)}function $B(t){const{auth:e,user:n}=t;return fe(n,e,"internal-error"),xB(n,new jw(t),t.bypassAuthState)}async function zB(t){const{auth:e,user:n}=t;return fe(n,e,"internal-error"),gB(n,new jw(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oR{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:l}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(c))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return OB;case"linkViaPopup":case"linkViaRedirect":return zB;case"reauthViaPopup":case"reauthViaRedirect":return $B;default:Ts(this.auth,"internal-error")}}resolve(e){ii(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ii(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BB=new ed(2e3,1e4);async function VB(t,e,n){if(Vs(t.app))return Promise.reject(es(t,"operation-not-supported-in-this-environment"));const r=Km(t);Lz(t,e,bw);const s=aR(r,n);return new Aa(r,"signInViaPopup",e,s).executeNotNull()}class Aa extends oR{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,Aa.currentPopupAction&&Aa.currentPopupAction.cancel(),Aa.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return fe(e,this.auth,"internal-error"),e}async onExecution(){ii(this.filter.length===1,"Popup operations only handle one event");const e=Ew();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(es(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(es(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Aa.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(es(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,BB.get())};e()}}Aa.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UB="pendingRedirect",Mh=new Map;class HB extends oR{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Mh.get(this.auth._key());if(!e){try{const r=await GB(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Mh.set(this.auth._key(),e)}return this.bypassAuthState||Mh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function GB(t,e){const n=KB(e),r=qB(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function WB(t,e){Mh.set(t._key(),e)}function qB(t){return Gs(t._redirectPersistence)}function KB(t){return Fh(UB,t.config.apiKey,t.name)}async function QB(t,e,n=!1){if(Vs(t.app))return Promise.reject(Da(t));const r=Km(t),s=aR(r,e),o=await new HB(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XB=10*60*1e3;class YB{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!JB(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!lR(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(es(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=XB&&this.cachedEventUids.clear(),this.cachedEventUids.has(Kb(e))}saveEventToCache(e){this.cachedEventUids.add(Kb(e)),this.lastProcessedEventTime=Date.now()}}function Kb(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function lR({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function JB(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return lR(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ZB(t,e={}){return Ul(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e8=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,t8=/^https?/;async function n8(t){if(t.config.emulator)return;const{authorizedDomains:e}=await ZB(t);for(const n of e)try{if(r8(n))return}catch{}Ts(t,"unauthorized-domain")}function r8(t){const e=Ax(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!t8.test(n))return!1;if(e8.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s8=new ed(3e4,6e4);function Qb(){const t=bs().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function i8(t){return new Promise((e,n)=>{var r,s,i;function o(){Qb(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Qb(),n(es(t,"network-request-failed"))},timeout:s8.get()})}if(!((s=(r=bs().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=bs().gapi)===null||i===void 0)&&i.load)o();else{const l=cB("iframefcb");return bs()[l]=()=>{gapi.load?o():n(es(t,"network-request-failed"))},oB(`${lB()}?onload=${l}`).catch(c=>n(c))}}).catch(e=>{throw Dh=null,e})}let Dh=null;function a8(t){return Dh=Dh||i8(t),Dh}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o8=new ed(5e3,15e3),l8="__/auth/iframe",c8="emulator/auth/iframe",u8={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},d8=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function h8(t){const e=t.config;fe(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?yw(e,c8):`https://${t.config.authDomain}/${l8}`,r={apiKey:e.apiKey,appName:t.name,v:Ml},s=d8.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${zu(r).slice(1)}`}async function f8(t){const e=await a8(t),n=bs().gapi;return fe(n,t,"internal-error"),e.open({where:document.body,url:h8(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:u8,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=es(t,"network-request-failed"),l=bs().setTimeout(()=>{i(o)},o8.get());function c(){bs().clearTimeout(l),s(r)}r.ping(c).then(c,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m8={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},p8=500,g8=600,x8="_blank",y8="http://localhost";class Xb{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function v8(t,e,n,r=p8,s=g8){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const c=Object.assign(Object.assign({},m8),{width:r.toString(),height:s.toString(),top:i,left:o}),u=Sn().toLowerCase();n&&(l=VC(u)?x8:n),zC(u)&&(e=e||y8,c.scrollbars="yes");const d=Object.entries(c).reduce((p,[g,x])=>`${p}${g}=${x},`,"");if(Zz(u)&&l!=="_self")return w8(e||"",l),new Xb(null);const m=window.open(e||"",l,d);fe(m,t,"popup-blocked");try{m.focus()}catch{}return new Xb(m)}function w8(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _8="__/auth/handler",S8="emulator/auth/handler",b8=encodeURIComponent("fac");async function Yb(t,e,n,r,s,i){fe(t.config.authDomain,t,"auth-domain-config-required"),fe(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Ml,eventId:s};if(e instanceof bw){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",f6(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,m]of Object.entries(i||{}))o[d]=m}if(e instanceof td){const d=e.getScopes().filter(m=>m!=="");d.length>0&&(o.scopes=d.join(","))}t.tenantId&&(o.tid=t.tenantId);const l=o;for(const d of Object.keys(l))l[d]===void 0&&delete l[d];const c=await t._getAppCheckToken(),u=c?`#${b8}=${encodeURIComponent(c)}`:"";return`${E8(t)}?${zu(l).slice(1)}${u}`}function E8({config:t}){return t.emulator?yw(t,S8):`https://${t.authDomain}/${_8}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fg="webStorageSupport";class j8{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=tR,this._completeRedirectFn=QB,this._overrideRedirectResult=WB}async _openPopup(e,n,r,s){var i;ii((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=await Yb(e,n,r,Ax(),s);return v8(e,o,Ew())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await Yb(e,n,r,Ax(),s);return IB(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(ii(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await f8(e),r=new YB(e);return n.register("authEvent",s=>(fe(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Fg,{type:Fg},s=>{var i;const o=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[Fg];o!==void 0&&n(!!o),Ts(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=n8(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return qC()||BC()||_w()}}const k8=j8;var Jb="@firebase/auth",Zb="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T8{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){fe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I8(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function C8(t){hl(new Ua("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=r.options;fe(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const c={apiKey:o,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:KC(t)},u=new iB(r,s,i,c);return dB(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),hl(new Ua("auth-internal",e=>{const n=Km(e.getProvider("auth").getImmediate());return(r=>new T8(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),qi(Jb,Zb,I8(t)),qi(Jb,Zb,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R8=5*60,N8=DT("authIdTokenMaxAge")||R8;let e2=null;const A8=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>N8)return;const s=n==null?void 0:n.token;e2!==s&&(e2=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function P8(t=zT()){const e=Iv(t,"auth");if(e.isInitialized())return e.getImmediate();const n=uB(t,{popupRedirectResolver:k8,persistence:[LB,jB,tR]}),r=DT("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=A8(i.toString());wB(n,o,()=>o(n.currentUser)),vB(n,l=>o(l))}}const s=FT("auth");return s&&hB(n,`http://${s}`),n}function F8(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}aB({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=es("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",F8().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});C8("Browser");const cR=$T({apiKey:"AIzaSyDS7lgm2PwJBFrYE6ZHSYJfqcQw2TLC878",appId:{}.VITE_APPID||"1:938280289868:web:e36c48cfbd55e4a8de96e",projectId:{}.VITE_PROJECTID||"zingmp3-clone-61799",authDomain:{}.VITE_AUTHDOMAIN||"zingmp3-clone-61799.firebaseapp.com"}),oe=l$(cR),na=P8(cR),M8=new $s;var Tr={MISSING_UPLOAD_FILE_PARAMETER:{message:"Missing file parameter for upload"},MISSING_UPLOAD_FILENAME_PARAMETER:{message:"Missing fileName parameter for upload"},MISSING_PUBLIC_KEY:{message:"Missing public key for upload"},UPLOAD_ENDPOINT_NETWORK_ERROR:{message:"Request to ImageKit upload endpoint failed due to network error"},MISSING_SIGNATURE:{message:"Missing signature for upload. The SDK expects token, signature and expire for authentication."},MISSING_TOKEN:{message:"Missing token for upload. The SDK expects token, signature and expire for authentication."},MISSING_EXPIRE:{message:"Missing expire for upload. The SDK expects token, signature and expire for authentication."},INVALID_TRANSFORMATION:{message:"Invalid transformation parameter. Please include at least pre, post, or both."},INVALID_PRE_TRANSFORMATION:{message:"Invalid pre transformation parameter."},INVALID_POST_TRANSFORMATION:{message:"Invalid post transformation parameter."}};class rr extends Error{constructor(e,n){super(e),this.$ResponseMetadata=void 0,this.name="ImageKitInvalidRequestError",this.$ResponseMetadata=n}}class t2 extends Error{constructor(e,n){super(e),this.reason=void 0,this.name="ImageKitAbortError",this.reason=n}}class D8 extends Error{constructor(e){super(e),this.name="ImageKitUploadNetworkError"}}class n2 extends Error{constructor(e,n){super(e),this.$ResponseMetadata=void 0,this.name="ImageKitServerError",this.$ResponseMetadata=n}}const L8=t=>t?new Promise((e,n)=>{const{xhr:r}=t||{};delete t.xhr;const s=r||new XMLHttpRequest;if(!t.file)return n(new rr(Tr.MISSING_UPLOAD_FILE_PARAMETER.message));if(!t.fileName)return n(new rr(Tr.MISSING_UPLOAD_FILENAME_PARAMETER.message));if(!t.publicKey||t.publicKey.length===0)return n(new rr(Tr.MISSING_PUBLIC_KEY.message));if(!t.token)return n(new rr(Tr.MISSING_TOKEN.message));if(!t.signature)return n(new rr(Tr.MISSING_SIGNATURE.message));if(!t.expire)return n(new rr(Tr.MISSING_EXPIRE.message));if(t.transformation){if(!(Object.keys(t.transformation).includes("pre")||Object.keys(t.transformation).includes("post")))return n(new rr(Tr.INVALID_TRANSFORMATION.message));if(Object.keys(t.transformation).includes("pre")&&!t.transformation.pre)return n(new rr(Tr.INVALID_PRE_TRANSFORMATION.message));if(Object.keys(t.transformation).includes("post"))if(Array.isArray(t.transformation.post))for(let u of t.transformation.post){if(u.type==="abs"&&!(u.protocol||u.value))return n(new rr(Tr.INVALID_POST_TRANSFORMATION.message));if(u.type==="transformation"&&!u.value)return n(new rr(Tr.INVALID_POST_TRANSFORMATION.message))}else return n(new rr(Tr.INVALID_POST_TRANSFORMATION.message))}var i=new FormData;let o;for(o in t)if(o){if(o==="file"&&typeof t.file!="string")i.set("file",t.file,String(t.fileName));else if(o==="tags"&&Array.isArray(t.tags))i.set("tags",t.tags.join(","));else if(o==="signature")i.set("signature",t.signature);else if(o==="expire")i.set("expire",String(t.expire));else if(o==="token")i.set("token",t.token);else if(o==="responseFields"&&Array.isArray(t.responseFields))i.set("responseFields",t.responseFields.join(","));else if(o==="extensions"&&Array.isArray(t.extensions))i.set("extensions",JSON.stringify(t.extensions));else if(o==="customMetadata"&&typeof t.customMetadata=="object"&&!Array.isArray(t.customMetadata)&&t.customMetadata!==null)i.set("customMetadata",JSON.stringify(t.customMetadata));else if(o==="transformation"&&typeof t.transformation=="object"&&t.transformation!==null)i.set(o,JSON.stringify(t.transformation));else if(o==="checks"&&t.checks)i.set("checks",t.checks);else if(t[o]!==void 0){if(["onProgress","abortSignal"].includes(o))continue;i.set(o,String(t[o]))}}t.onProgress&&(s.upload.onprogress=function(u){t.onProgress&&t.onProgress(u)});function l(){var u;return s.abort(),n(new t2("Upload aborted",(u=t.abortSignal)===null||u===void 0?void 0:u.reason))}if(t.abortSignal){if(t.abortSignal.aborted){var c;return n(new t2("Upload aborted",(c=t.abortSignal)===null||c===void 0?void 0:c.reason))}t.abortSignal.addEventListener("abort",l),s.addEventListener("loadend",()=>{t.abortSignal&&t.abortSignal.removeEventListener("abort",l)})}s.open("POST","https://upload.imagekit.io/api/v1/files/upload"),s.onerror=function(u){return n(new D8(Tr.UPLOAD_ENDPOINT_NETWORK_ERROR.message))},s.onload=function(){if(s.status>=200&&s.status<300)try{var u=JSON.parse(s.responseText),d=O8(u,s);return e(d)}catch(m){return n(m)}else if(s.status>=400&&s.status<500)try{var u=JSON.parse(s.responseText);return n(new rr(u.message??"Invalid request. Please check the parameters.",Lh(s)))}catch(m){return n(m)}else try{var u=JSON.parse(s.responseText);return n(new n2(u.message??"Server error occurred while uploading the file. This is rare and usually temporary.",Lh(s)))}catch{return n(new n2("Server error occurred while uploading the file. This is rare and usually temporary.",Lh(s)))}},s.send(i)}):Promise.reject(new rr("Invalid options provided for upload")),O8=(t,e)=>{let n={...t};const r=Lh(e);return Object.defineProperty(n,"$ResponseMetadata",{value:r,enumerable:!1,writable:!1}),n},Lh=t=>{const e=$8(t);return{statusCode:t.status,headers:e,requestId:e["x-request-id"]}};function $8(t){const e={},n=t.getAllResponseHeaders();return Object.keys(n).length&&n.trim().split(/[\r\n]+/).map(r=>r.split(/: /)).forEach(r=>{e[r[0].trim().toLowerCase()]=r[1].trim()}),e}h.createContext({});const z8=!0,_t=St(oe,"Songs"),vn=St(oe,"Playlists"),Qa=St(oe,"Singers");St(oe,"Users");St(oe,"Lyrics");const Xa=St(oe,"Comments");St(oe,"DailySong");St(oe,"DailySong");const uR=St(oe,"Genres");St(oe,"Trending_Metrics");St(oe,"Categories");const kw=async({collectionName:t,id:e,msg:n})=>{console.log(n??">>> api: delete doc"),await _$(it(oe,t,e))},Gt=async({collectionName:t,id:e,msg:n})=>(console.log(n??">>> api: get doc"),_l(it(oe,t,e))),Is=async({collectionName:t,data:e,msg:n})=>(console.log(n??">>> api: add doc"),await S$(St(oe,t),e)),je=async({collectionName:t,id:e,data:n,msg:r})=>(console.log(r??">>> api: update doc"),await w$(it(oe,t,e),n)),rd=async({file:t,msg:e,folder:n})=>{var v;console.log(e??">>> api: upload file");const r=Date.now(),s=await((v=na.currentUser)==null?void 0:v.getIdToken(!0)),i=await Xu.get("/storage/auth",{headers:{Authorization:`Bearer ${s}`}}),{expire:o,token:l,signature:c,publicKey:u}=i.data.data,d=t.name.split("."),m=d.pop(),p=d.join("_"),{url:g="",fileId:x=""}=await L8({expire:o,token:l,signature:c,publicKey:u,file:t,fileName:bn(p)+"."+m,folder:`/hd-mp3${n}`}),w=(Date.now()-r)/1e3;return console.log(">>> api: upload file finished after",w),{url:g,fileId:x}},Dt=async({fileId:t,msg:e})=>{var n;try{z8&&console.log(e??">>> api: delete file");const r=await((n=na.currentUser)==null?void 0:n.getIdToken(!0));if(!r)return;await Xu.delete(`/storage/${t}`,{headers:{Authorization:`Bearer ${r}`}})}catch(r){console.log(r)}},dR=async t=>{try{Dt({fileId:t.song_file_id,msg:">>> api: delete song file"}),t.beat_file_id&&Dt({fileId:t.beat_file_id,msg:">>> api: delete song's image file"}),t.image_file_id&&Dt({fileId:t.image_file_id,msg:">>> api: delete song's image file"})}catch(e){console.log(e)}},hR=t=>{try{const e={total_play:Qs(1),today_play:Qs(1),week_play:Qs(1),last_active:st()};je({id:t,collectionName:"Songs",data:e,msg:"Increase song play"})}catch(e){console.log(e)}};function lr(t,e,n){const r=bn((n==null?void 0:n.trim())||""),s=r.charAt(0).toUpperCase()+r.slice(1);return r.split(" ").length>1?ue(t,...e,X("meta","array-contains-any",r.split(" "))):ue(t,...e,X("name",">=",s),X("name","<=",s+""))}function B8(){const[t,e]=h.useState(),[n,r]=h.useState([]),[s,i]=h.useState();return{imageFile:s,setImageFile:i,playlist:t,setPlaylist:e,updatePlaylistData:l=>{t&&e({...t,...l})},songs:n,setSongs:r}}const fR=h.createContext(null);function V8({children:t}){return a.jsx(fR.Provider,{value:B8(),children:t})}const Ym=()=>{const t=h.useContext(fR);if(!t)throw new Error("PlaylistProvider not provided");return t},U8=6;function H8(){const[t,e]=h.useState([]),[n,r]=h.useState(!0),s=h.useRef(),i=h.useRef(!0);return{playlists:t,setPlaylists:e,shouldGetPlaylists:i,lastDoc:s,hasMore:n,setHasMore:r,PAGE_SIZE:U8}}const mR=h.createContext(null);function G8({children:t}){return a.jsx(mR.Provider,{value:H8(),children:t})}const sd=()=>{const t=h.useContext(mR);if(!t)throw new Error("PlaylistProvider not provided");return t},Tw=(t,e)=>{const{color:n="var(--primary-cl)",baseColor:r="var(--a-10-cl)"}=e||{};return`linear-gradient(to right, ${n} ${t}%, ${r} ${t}%, ${r}`};function Jm({audioEle:t,baseColor:e,color:n,setStatusFromParent:r,statusFromParent:s,statusRefFromParent:i}){const[o,l]=h.useState("paused"),[c,u]=h.useState(!1),d=s||o,m=r||l,p=h.useRef(d),g=h.useRef(null),x=h.useRef(null),w=h.useRef(null),v=i||p,S=()=>{try{t.play(),u(!0)}catch{}},_=()=>{t==null||t.pause(),N()},E=()=>{d==="playing"?_():d==="paused"&&S()},I=()=>{m("playing")},N=()=>{m("paused")},F=()=>{m("paused"),w.current&&(w.current.innerText=Sl(t.duration))},k=we=>{if(!t)return;const ne=+(we||t.currentTime/t.duration*100).toFixed(1);x.current&&(x.current.innerText=Sl(t.currentTime)),g!=null&&g.current&&(g.current.style.background=Tw(ne,{color:n,baseColor:e}))},j=()=>{const ne=t.currentTime/(t.duration/100);k(+ne.toFixed(1))},C=()=>{console.log("error"),m("error")},R=we=>{const ne=we.target;if(g!=null&&g.current){const he=ne.getBoundingClientRect(),H=(we.clientX-he.left)/g.current.offsetWidth,K=Math.round(H*t.duration);A(K)}},A=we=>{t.currentTime=we,k(),d!=="playing"&&S()},M=we=>{t.currentTime=t.currentTime+we},P=we=>{t.currentTime=t.currentTime-we};return h.useEffect(()=>{if(t)return t.addEventListener("error",C),t.addEventListener("pause",N),t.addEventListener("playing",I),t.addEventListener("loadedmetadata",F),g!=null&&g.current&&(g==null||g.current.addEventListener("click",R),t.addEventListener("timeupdate",j)),()=>{t.removeEventListener("error",C),t.removeEventListener("pause",N),t.removeEventListener("playing",I),t.removeEventListener("loadedmetadata",F),g!=null&&g.current&&(t.removeEventListener("timeupdate",j),g==null||g.current.removeEventListener("click",R))}},[t]),h.useEffect(()=>{v.current=d},[d]),{play:S,pause:_,seek:A,handlePlayPause:E,status:d,forward:M,backward:P,isClickPlay:c,statusRef:p,progressLineRef:g,currentTimeRef:x,durationRef:w}}function Mx(t,e){const[n,r]=h.useState(e),s=h.useRef(!1);return h.useEffect(()=>{const i=It()[t]||e;r(i)},[]),h.useEffect(()=>{if(!s.current){s.current=!0;return}tt(t,n)},[n]),[n,r]}function Xt(t){return`Minified Redux error #${t}; visit https://redux.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var W8=(()=>typeof Symbol=="function"&&Symbol.observable||"@@observable")(),r2=W8,Mg=()=>Math.random().toString(36).substring(7).split("").join("."),q8={INIT:`@@redux/INIT${Mg()}`,REPLACE:`@@redux/REPLACE${Mg()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${Mg()}`},Pf=q8;function Iw(t){if(typeof t!="object"||t===null)return!1;let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e||Object.getPrototypeOf(t)===null}function pR(t,e,n){if(typeof t!="function")throw new Error(Xt(2));if(typeof e=="function"&&typeof n=="function"||typeof n=="function"&&typeof arguments[3]=="function")throw new Error(Xt(0));if(typeof e=="function"&&typeof n>"u"&&(n=e,e=void 0),typeof n<"u"){if(typeof n!="function")throw new Error(Xt(1));return n(pR)(t,e)}let r=t,s=e,i=new Map,o=i,l=0,c=!1;function u(){o===i&&(o=new Map,i.forEach((v,S)=>{o.set(S,v)}))}function d(){if(c)throw new Error(Xt(3));return s}function m(v){if(typeof v!="function")throw new Error(Xt(4));if(c)throw new Error(Xt(5));let S=!0;u();const _=l++;return o.set(_,v),function(){if(S){if(c)throw new Error(Xt(6));S=!1,u(),o.delete(_),i=null}}}function p(v){if(!Iw(v))throw new Error(Xt(7));if(typeof v.type>"u")throw new Error(Xt(8));if(typeof v.type!="string")throw new Error(Xt(17));if(c)throw new Error(Xt(9));try{c=!0,s=r(s,v)}finally{c=!1}return(i=o).forEach(_=>{_()}),v}function g(v){if(typeof v!="function")throw new Error(Xt(10));r=v,p({type:Pf.REPLACE})}function x(){const v=m;return{subscribe(S){if(typeof S!="object"||S===null)throw new Error(Xt(11));function _(){const I=S;I.next&&I.next(d())}return _(),{unsubscribe:v(_)}},[r2](){return this}}}return p({type:Pf.INIT}),{dispatch:p,subscribe:m,getState:d,replaceReducer:g,[r2]:x}}function K8(t){Object.keys(t).forEach(e=>{const n=t[e];if(typeof n(void 0,{type:Pf.INIT})>"u")throw new Error(Xt(12));if(typeof n(void 0,{type:Pf.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(Xt(13))})}function Q8(t){const e=Object.keys(t),n={};for(let i=0;i<e.length;i++){const o=e[i];typeof t[o]=="function"&&(n[o]=t[o])}const r=Object.keys(n);let s;try{K8(n)}catch(i){s=i}return function(o={},l){if(s)throw s;let c=!1;const u={};for(let d=0;d<r.length;d++){const m=r[d],p=n[m],g=o[m],x=p(g,l);if(typeof x>"u")throw l&&l.type,new Error(Xt(14));u[m]=x,c=c||x!==g}return c=c||r.length!==Object.keys(o).length,c?u:o}}function Ff(...t){return t.length===0?e=>e:t.length===1?t[0]:t.reduce((e,n)=>(...r)=>e(n(...r)))}function X8(...t){return e=>(n,r)=>{const s=e(n,r);let i=()=>{throw new Error(Xt(15))};const o={getState:s.getState,dispatch:(c,...u)=>i(c,...u)},l=t.map(c=>c(o));return i=Ff(...l)(s.dispatch),{...s,dispatch:i}}}function Y8(t){return Iw(t)&&"type"in t&&typeof t.type=="string"}var gR=Symbol.for("immer-nothing"),s2=Symbol.for("immer-draftable"),yr=Symbol.for("immer-state");function Kr(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var El=Object.getPrototypeOf;function Ya(t){return!!t&&!!t[yr]}function ai(t){var e;return t?xR(t)||Array.isArray(t)||!!t[s2]||!!((e=t.constructor)!=null&&e[s2])||ep(t)||tp(t):!1}var J8=Object.prototype.constructor.toString();function xR(t){if(!t||typeof t!="object")return!1;const e=El(t);if(e===null)return!0;const n=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return n===Object?!0:typeof n=="function"&&Function.toString.call(n)===J8}function Mf(t,e){Zm(t)===0?Reflect.ownKeys(t).forEach(n=>{e(n,t[n],t)}):t.forEach((n,r)=>e(r,n,t))}function Zm(t){const e=t[yr];return e?e.type_:Array.isArray(t)?1:ep(t)?2:tp(t)?3:0}function Dx(t,e){return Zm(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function yR(t,e,n){const r=Zm(t);r===2?t.set(e,n):r===3?t.add(n):t[e]=n}function Z8(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}function ep(t){return t instanceof Map}function tp(t){return t instanceof Set}function Ea(t){return t.copy_||t.base_}function Lx(t,e){if(ep(t))return new Map(t);if(tp(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const n=xR(t);if(e===!0||e==="class_only"&&!n){const r=Object.getOwnPropertyDescriptors(t);delete r[yr];let s=Reflect.ownKeys(r);for(let i=0;i<s.length;i++){const o=s[i],l=r[o];l.writable===!1&&(l.writable=!0,l.configurable=!0),(l.get||l.set)&&(r[o]={configurable:!0,writable:!0,enumerable:l.enumerable,value:t[o]})}return Object.create(El(t),r)}else{const r=El(t);if(r!==null&&n)return{...t};const s=Object.create(r);return Object.assign(s,t)}}function Cw(t,e=!1){return np(t)||Ya(t)||!ai(t)||(Zm(t)>1&&(t.set=t.add=t.clear=t.delete=eV),Object.freeze(t),e&&Object.entries(t).forEach(([n,r])=>Cw(r,!0))),t}function eV(){Kr(2)}function np(t){return Object.isFrozen(t)}var tV={};function Ja(t){const e=tV[t];return e||Kr(0,t),e}var _u;function vR(){return _u}function nV(t,e){return{drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function i2(t,e){e&&(Ja("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function Ox(t){$x(t),t.drafts_.forEach(rV),t.drafts_=null}function $x(t){t===_u&&(_u=t.parent_)}function a2(t){return _u=nV(_u,t)}function rV(t){const e=t[yr];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function o2(t,e){e.unfinalizedDrafts_=e.drafts_.length;const n=e.drafts_[0];return t!==void 0&&t!==n?(n[yr].modified_&&(Ox(e),Kr(4)),ai(t)&&(t=Df(e,t),e.parent_||Lf(e,t)),e.patches_&&Ja("Patches").generateReplacementPatches_(n[yr].base_,t,e.patches_,e.inversePatches_)):t=Df(e,n,[]),Ox(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==gR?t:void 0}function Df(t,e,n){if(np(e))return e;const r=e[yr];if(!r)return Mf(e,(s,i)=>l2(t,r,e,s,i,n)),e;if(r.scope_!==t)return e;if(!r.modified_)return Lf(t,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const s=r.copy_;let i=s,o=!1;r.type_===3&&(i=new Set(s),s.clear(),o=!0),Mf(i,(l,c)=>l2(t,r,s,l,c,n,o)),Lf(t,s,!1),n&&t.patches_&&Ja("Patches").generatePatches_(r,n,t.patches_,t.inversePatches_)}return r.copy_}function l2(t,e,n,r,s,i,o){if(Ya(s)){const l=i&&e&&e.type_!==3&&!Dx(e.assigned_,r)?i.concat(r):void 0,c=Df(t,s,l);if(yR(n,r,c),Ya(c))t.canAutoFreeze_=!1;else return}else o&&n.add(s);if(ai(s)&&!np(s)){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1)return;Df(t,s),(!e||!e.scope_.parent_)&&typeof r!="symbol"&&Object.prototype.propertyIsEnumerable.call(n,r)&&Lf(t,s)}}function Lf(t,e,n=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&Cw(e,n)}function sV(t,e){const n=Array.isArray(t),r={type_:n?1:0,scope_:e?e.scope_:vR(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let s=r,i=Rw;n&&(s=[r],i=Su);const{revoke:o,proxy:l}=Proxy.revocable(s,i);return r.draft_=l,r.revoke_=o,l}var Rw={get(t,e){if(e===yr)return t;const n=Ea(t);if(!Dx(n,e))return iV(t,n,e);const r=n[e];return t.finalized_||!ai(r)?r:r===Dg(t.base_,e)?(Lg(t),t.copy_[e]=Bx(r,t)):r},has(t,e){return e in Ea(t)},ownKeys(t){return Reflect.ownKeys(Ea(t))},set(t,e,n){const r=wR(Ea(t),e);if(r!=null&&r.set)return r.set.call(t.draft_,n),!0;if(!t.modified_){const s=Dg(Ea(t),e),i=s==null?void 0:s[yr];if(i&&i.base_===n)return t.copy_[e]=n,t.assigned_[e]=!1,!0;if(Z8(n,s)&&(n!==void 0||Dx(t.base_,e)))return!0;Lg(t),zx(t)}return t.copy_[e]===n&&(n!==void 0||e in t.copy_)||Number.isNaN(n)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=n,t.assigned_[e]=!0),!0},deleteProperty(t,e){return Dg(t.base_,e)!==void 0||e in t.base_?(t.assigned_[e]=!1,Lg(t),zx(t)):delete t.assigned_[e],t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const n=Ea(t),r=Reflect.getOwnPropertyDescriptor(n,e);return r&&{writable:!0,configurable:t.type_!==1||e!=="length",enumerable:r.enumerable,value:n[e]}},defineProperty(){Kr(11)},getPrototypeOf(t){return El(t.base_)},setPrototypeOf(){Kr(12)}},Su={};Mf(Rw,(t,e)=>{Su[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});Su.deleteProperty=function(t,e){return Su.set.call(this,t,e,void 0)};Su.set=function(t,e,n){return Rw.set.call(this,t[0],e,n,t[0])};function Dg(t,e){const n=t[yr];return(n?Ea(n):t)[e]}function iV(t,e,n){var s;const r=wR(e,n);return r?"value"in r?r.value:(s=r.get)==null?void 0:s.call(t.draft_):void 0}function wR(t,e){if(!(e in t))return;let n=El(t);for(;n;){const r=Object.getOwnPropertyDescriptor(n,e);if(r)return r;n=El(n)}}function zx(t){t.modified_||(t.modified_=!0,t.parent_&&zx(t.parent_))}function Lg(t){t.copy_||(t.copy_=Lx(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var aV=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,n,r)=>{if(typeof e=="function"&&typeof n!="function"){const i=n;n=e;const o=this;return function(c=i,...u){return o.produce(c,d=>n.call(this,d,...u))}}typeof n!="function"&&Kr(6),r!==void 0&&typeof r!="function"&&Kr(7);let s;if(ai(e)){const i=a2(this),o=Bx(e,void 0);let l=!0;try{s=n(o),l=!1}finally{l?Ox(i):$x(i)}return i2(i,r),o2(s,i)}else if(!e||typeof e!="object"){if(s=n(e),s===void 0&&(s=e),s===gR&&(s=void 0),this.autoFreeze_&&Cw(s,!0),r){const i=[],o=[];Ja("Patches").generateReplacementPatches_(e,s,i,o),r(i,o)}return s}else Kr(1,e)},this.produceWithPatches=(e,n)=>{if(typeof e=="function")return(o,...l)=>this.produceWithPatches(o,c=>e(c,...l));let r,s;return[this.produce(e,n,(o,l)=>{r=o,s=l}),r,s]},typeof(t==null?void 0:t.autoFreeze)=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof(t==null?void 0:t.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy)}createDraft(t){ai(t)||Kr(8),Ya(t)&&(t=oV(t));const e=a2(this),n=Bx(t,void 0);return n[yr].isManual_=!0,$x(e),n}finishDraft(t,e){const n=t&&t[yr];(!n||!n.isManual_)&&Kr(9);const{scope_:r}=n;return i2(r,e),o2(void 0,r)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}applyPatches(t,e){let n;for(n=e.length-1;n>=0;n--){const s=e[n];if(s.path.length===0&&s.op==="replace"){t=s.value;break}}n>-1&&(e=e.slice(n+1));const r=Ja("Patches").applyPatches_;return Ya(t)?r(t,e):this.produce(t,s=>r(s,e))}};function Bx(t,e){const n=ep(t)?Ja("MapSet").proxyMap_(t,e):tp(t)?Ja("MapSet").proxySet_(t,e):sV(t,e);return(e?e.scope_:vR()).drafts_.push(n),n}function oV(t){return Ya(t)||Kr(10,t),_R(t)}function _R(t){if(!ai(t)||np(t))return t;const e=t[yr];let n;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,n=Lx(t,e.scope_.immer_.useStrictShallowCopy_)}else n=Lx(t,!0);return Mf(n,(r,s)=>{yR(n,r,_R(s))}),e&&(e.finalized_=!1),n}var vr=new aV,SR=vr.produce;vr.produceWithPatches.bind(vr);vr.setAutoFreeze.bind(vr);vr.setUseStrictShallowCopy.bind(vr);vr.applyPatches.bind(vr);vr.createDraft.bind(vr);vr.finishDraft.bind(vr);function bR(t){return({dispatch:n,getState:r})=>s=>i=>typeof i=="function"?i(n,r,t):s(i)}var lV=bR(),cV=bR,uV=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?Ff:Ff.apply(null,arguments)};function c2(t,e){function n(...r){if(e){let s=e(...r);if(!s)throw new Error(Xs(0));return{type:t,payload:s.payload,..."meta"in s&&{meta:s.meta},..."error"in s&&{error:s.error}}}return{type:t,payload:r[0]}}return n.toString=()=>`${t}`,n.type=t,n.match=r=>Y8(r)&&r.type===t,n}var ER=class Ic extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,Ic.prototype)}static get[Symbol.species](){return Ic}concat(...e){return super.concat.apply(this,e)}prepend(...e){return e.length===1&&Array.isArray(e[0])?new Ic(...e[0].concat(this)):new Ic(...e.concat(this))}};function u2(t){return ai(t)?SR(t,()=>{}):t}function d2(t,e,n){return t.has(e)?t.get(e):t.set(e,n(e)).get(e)}function dV(t){return typeof t=="boolean"}var hV=()=>function(e){const{thunk:n=!0,immutableCheck:r=!0,serializableCheck:s=!0,actionCreatorCheck:i=!0}=e??{};let o=new ER;return n&&(dV(n)?o.push(lV):o.push(cV(n.extraArgument))),o},fV="RTK_autoBatch",h2=t=>e=>{setTimeout(e,t)},mV=(t={type:"raf"})=>e=>(...n)=>{const r=e(...n);let s=!0,i=!1,o=!1;const l=new Set,c=t.type==="tick"?queueMicrotask:t.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:h2(10):t.type==="callback"?t.queueNotification:h2(t.timeout),u=()=>{o=!1,i&&(i=!1,l.forEach(d=>d()))};return Object.assign({},r,{subscribe(d){const m=()=>s&&d(),p=r.subscribe(m);return l.add(d),()=>{p(),l.delete(d)}},dispatch(d){var m;try{return s=!((m=d==null?void 0:d.meta)!=null&&m[fV]),i=!s,i&&(o||(o=!0,c(u))),r.dispatch(d)}finally{s=!0}}})},pV=t=>function(n){const{autoBatch:r=!0}=n??{};let s=new ER(t);return r&&s.push(mV(typeof r=="object"?r:void 0)),s};function gV(t){const e=hV(),{reducer:n=void 0,middleware:r,devTools:s=!0,preloadedState:i=void 0,enhancers:o=void 0}=t||{};let l;if(typeof n=="function")l=n;else if(Iw(n))l=Q8(n);else throw new Error(Xs(1));let c;typeof r=="function"?c=r(e):c=e();let u=Ff;s&&(u=uV({trace:!1,...typeof s=="object"&&s}));const d=X8(...c),m=pV(d);let p=typeof o=="function"?o(m):m();const g=u(...p);return pR(l,i,g)}function jR(t){const e={},n=[];let r;const s={addCase(i,o){const l=typeof i=="string"?i:i.type;if(!l)throw new Error(Xs(28));if(l in e)throw new Error(Xs(29));return e[l]=o,s},addMatcher(i,o){return n.push({matcher:i,reducer:o}),s},addDefaultCase(i){return r=i,s}};return t(s),[e,n,r]}function xV(t){return typeof t=="function"}function yV(t,e){let[n,r,s]=jR(e),i;if(xV(t))i=()=>u2(t());else{const l=u2(t);i=()=>l}function o(l=i(),c){let u=[n[c.type],...r.filter(({matcher:d})=>d(c)).map(({reducer:d})=>d)];return u.filter(d=>!!d).length===0&&(u=[s]),u.reduce((d,m)=>{if(m)if(Ya(d)){const g=m(d,c);return g===void 0?d:g}else{if(ai(d))return SR(d,p=>m(p,c));{const p=m(d,c);if(p===void 0){if(d===null)return d;throw Error("A case reducer on a non-draftable value must not return undefined")}return p}}return d},l)}return o.getInitialState=i,o}var vV=Symbol.for("rtk-slice-createasyncthunk");function wV(t,e){return`${t}/${e}`}function _V({creators:t}={}){var n;const e=(n=t==null?void 0:t.asyncThunk)==null?void 0:n[vV];return function(s){const{name:i,reducerPath:o=i}=s;if(!i)throw new Error(Xs(11));typeof process<"u";const l=(typeof s.reducers=="function"?s.reducers(bV()):s.reducers)||{},c=Object.keys(l),u={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},d={addCase(E,I){const N=typeof E=="string"?E:E.type;if(!N)throw new Error(Xs(12));if(N in u.sliceCaseReducersByType)throw new Error(Xs(13));return u.sliceCaseReducersByType[N]=I,d},addMatcher(E,I){return u.sliceMatchers.push({matcher:E,reducer:I}),d},exposeAction(E,I){return u.actionCreators[E]=I,d},exposeCaseReducer(E,I){return u.sliceCaseReducersByName[E]=I,d}};c.forEach(E=>{const I=l[E],N={reducerName:E,type:wV(i,E),createNotation:typeof s.reducers=="function"};jV(I)?TV(N,I,d,e):EV(N,I,d)});function m(){const[E={},I=[],N=void 0]=typeof s.extraReducers=="function"?jR(s.extraReducers):[s.extraReducers],F={...E,...u.sliceCaseReducersByType};return yV(s.initialState,k=>{for(let j in F)k.addCase(j,F[j]);for(let j of u.sliceMatchers)k.addMatcher(j.matcher,j.reducer);for(let j of I)k.addMatcher(j.matcher,j.reducer);N&&k.addDefaultCase(N)})}const p=E=>E,g=new Map;let x;function w(E,I){return x||(x=m()),x(E,I)}function v(){return x||(x=m()),x.getInitialState()}function S(E,I=!1){function N(k){let j=k[E];return typeof j>"u"&&I&&(j=v()),j}function F(k=p){const j=d2(g,I,()=>new WeakMap);return d2(j,k,()=>{const C={};for(const[R,A]of Object.entries(s.selectors??{}))C[R]=SV(A,k,v,I);return C})}return{reducerPath:E,getSelectors:F,get selectors(){return F(N)},selectSlice:N}}const _={name:i,reducer:w,actions:u.actionCreators,caseReducers:u.sliceCaseReducersByName,getInitialState:v,...S(o),injectInto(E,{reducerPath:I,...N}={}){const F=I??o;return E.inject({reducerPath:F,reducer:w},N),{..._,...S(F,!0)}}};return _}}function SV(t,e,n,r){function s(i,...o){let l=e(i);return typeof l>"u"&&r&&(l=n()),t(l,...o)}return s.unwrapped=t,s}var Nw=_V();function bV(){function t(e,n){return{_reducerDefinitionType:"asyncThunk",payloadCreator:e,...n}}return t.withTypes=()=>t,{reducer(e){return Object.assign({[e.name](...n){return e(...n)}}[e.name],{_reducerDefinitionType:"reducer"})},preparedReducer(e,n){return{_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:n}},asyncThunk:t}}function EV({type:t,reducerName:e,createNotation:n},r,s){let i,o;if("reducer"in r){if(n&&!kV(r))throw new Error(Xs(17));i=r.reducer,o=r.prepare}else i=r;s.addCase(t,i).exposeCaseReducer(e,i).exposeAction(e,o?c2(t,o):c2(t))}function jV(t){return t._reducerDefinitionType==="asyncThunk"}function kV(t){return t._reducerDefinitionType==="reducerWithPrepare"}function TV({type:t,reducerName:e},n,r,s){if(!s)throw new Error(Xs(18));const{payloadCreator:i,fulfilled:o,pending:l,rejected:c,settled:u,options:d}=n,m=s(t,i,d);r.exposeAction(e,m),o&&r.addCase(m.fulfilled,o),l&&r.addCase(m.pending,l),c&&r.addCase(m.rejected,c),u&&r.addMatcher(m.settled,u),r.exposeCaseReducer(e,{fulfilled:o||Jd,pending:l||Jd,rejected:c||Jd,settled:u||Jd})}function Jd(){}function Xs(t){return`Minified Redux Toolkit error #${t}; visit https://redux-toolkit.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}const IV=()=>({playStatus:"paused",isLoaded:!0,countDown:0}),kR=Nw({name:"playStatus",initialState:()=>IV(),reducers:{setPlayStatus(t,e){Object.assign(t,e.payload)}}}),Hn=t=>t.playStatus,{setPlayStatus:Jt}=kR.actions,CV=kR.reducer,f2={queueSongs:It().queue||[],currentQueueId:null,currentSongData:null,isFetching:!1};function Og(t){for(let e=0;e<t.queueSongs.length;e++){const n=t.queueSongs[e];if(n.queue_id===t.currentQueueId){t.currentSongData={song:n,index:e};return}}t.currentSongData=null}const TR=Nw({name:"songQueue",initialState:f2,reducers:{setQueue(t,e){const n=e.payload.songs;t.queueSongs=n,Og(t),tt("queue",n)},setCurrentQueueId(t,e){const n=e.payload;t.currentQueueId=n,Og(t)},removeSongFromQueue(t,e){const{index:n}=e.payload;t.queueSongs.splice(n,1),tt("queue",t.queueSongs),t.currentSongData&&n<=t.currentSongData.index&&Og(t)},setIsFetchingRecommend(t,e){t.isFetching=e.payload},addSongToQueue:(t,e)=>{const n=e.payload.songs;t.queueSongs.push(...n),t.isFetching=!1,tt("queue",t.queueSongs)},resetSongQueue:t=>{tt("queue",[]),Object.assign(t,{...f2,queueSongs:[]})}}}),qe=t=>t.songQueue,{addSongToQueue:rp,setCurrentQueueId:Cs,removeSongFromQueue:RV,setQueue:NV,resetSongQueue:AV,setIsFetchingRecommend:PV}=TR.actions,FV=TR.reducer;var IR={exports:{}},CR={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var id=h;function MV(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var DV=typeof Object.is=="function"?Object.is:MV,LV=id.useSyncExternalStore,OV=id.useRef,$V=id.useEffect,zV=id.useMemo,BV=id.useDebugValue;CR.useSyncExternalStoreWithSelector=function(t,e,n,r,s){var i=OV(null);if(i.current===null){var o={hasValue:!1,value:null};i.current=o}else o=i.current;i=zV(function(){function c(g){if(!u){if(u=!0,d=g,g=r(g),s!==void 0&&o.hasValue){var x=o.value;if(s(x,g))return m=x}return m=g}if(x=m,DV(d,g))return x;var w=r(g);return s!==void 0&&s(x,w)?(d=g,x):(d=g,m=w)}var u=!1,d,m,p=n===void 0?null:n;return[function(){return c(e())},p===null?void 0:function(){return c(p())}]},[e,n,r,s]);var l=LV(t,i[0],i[1]);return $V(function(){o.hasValue=!0,o.value=l},[l]),BV(l),l};IR.exports=CR;var VV=IR.exports;function UV(t){t()}function HV(){let t=null,e=null;return{clear(){t=null,e=null},notify(){UV(()=>{let n=t;for(;n;)n.callback(),n=n.next})},get(){const n=[];let r=t;for(;r;)n.push(r),r=r.next;return n},subscribe(n){let r=!0;const s=e={callback:n,next:null,prev:e};return s.prev?s.prev.next=s:t=s,function(){!r||t===null||(r=!1,s.next?s.next.prev=s.prev:e=s.prev,s.prev?s.prev.next=s.next:t=s.next)}}}}var m2={notify(){},get:()=>[]};function GV(t,e){let n,r=m2,s=0,i=!1;function o(w){d();const v=r.subscribe(w);let S=!1;return()=>{S||(S=!0,v(),m())}}function l(){r.notify()}function c(){x.onStateChange&&x.onStateChange()}function u(){return i}function d(){s++,n||(n=e?e.addNestedSub(c):t.subscribe(c),r=HV())}function m(){s--,n&&s===0&&(n(),n=void 0,r.clear(),r=m2)}function p(){i||(i=!0,d())}function g(){i&&(i=!1,m())}const x={addNestedSub:o,notifyNestedSubs:l,handleChangeWrapper:c,isSubscribed:u,trySubscribe:p,tryUnsubscribe:g,getListeners:()=>r};return x}var WV=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",qV=WV(),KV=()=>typeof navigator<"u"&&navigator.product==="ReactNative",QV=KV(),XV=()=>qV||QV?h.useLayoutEffect:h.useEffect,YV=XV(),$g=Symbol.for("react-redux-context"),zg=typeof globalThis<"u"?globalThis:{};function JV(){if(!h.createContext)return{};const t=zg[$g]??(zg[$g]=new Map);let e=t.get(h.createContext);return e||(e=h.createContext(null),t.set(h.createContext,e)),e}var ra=JV();function ZV(t){const{children:e,context:n,serverState:r,store:s}=t,i=h.useMemo(()=>{const c=GV(s);return{store:s,subscription:c,getServerState:r?()=>r:void 0}},[s,r]),o=h.useMemo(()=>s.getState(),[s]);YV(()=>{const{subscription:c}=i;return c.onStateChange=c.notifyNestedSubs,c.trySubscribe(),o!==s.getState()&&c.notifyNestedSubs(),()=>{c.tryUnsubscribe(),c.onStateChange=void 0}},[i,o]);const l=n||ra;return h.createElement(l.Provider,{value:i},e)}var eU=ZV;function Aw(t=ra){return function(){return h.useContext(t)}}var RR=Aw();function NR(t=ra){const e=t===ra?RR:Aw(t),n=()=>{const{store:r}=e();return r};return Object.assign(n,{withTypes:()=>n}),n}var tU=NR();function nU(t=ra){const e=t===ra?tU:NR(t),n=()=>e().dispatch;return Object.assign(n,{withTypes:()=>n}),n}var on=nU(),rU=(t,e)=>t===e;function sU(t=ra){const e=t===ra?RR:Aw(t),n=(r,s={})=>{const{equalityFn:i=rU}=typeof s=="function"?{equalityFn:s}:s,o=e(),{store:l,subscription:c,getServerState:u}=o;h.useRef(!0);const d=h.useCallback({[r.name](p){return r(p)}}[r.name],[r]),m=VV.useSyncExternalStoreWithSelector(c.addNestedSub,l.getState,u||l.getState,d,i);return h.useDebugValue(m),m};return Object.assign(n,{withTypes:()=>n}),n}var ce=sU();function Sr({variant:t}){const e=on(),{currentQueueId:n,queueSongs:r,currentSongData:s}=ce(qe),i=h.useMemo(()=>{switch(t){default:return"queue_id"}},[]);return{handleSetSong:(l,c)=>{if(n!==l){e(Cs(l)),e(Jt({playStatus:"loading"}));const u=r.map(m=>m[i]);if(!r.length||r.length!==c.length||!!c.find(m=>!u.includes(m[i])))return console.log("set queue"),e(NV({songs:c})),!0}return!1},currentSongData:s,queueSongs:r,currentQueueId:n}}function AR(t,e){const[n,r]=h.useState(t);return h.useEffect(()=>{if(!t){r("");return}const s=setTimeout(()=>{r(t)},e);return()=>{clearTimeout(s)}},[t]),n}const Pw={isDev:!1,focusDelay:3e3,scrollSongDelay:4e3,loadingDuration:200};function p2(t,e){const n=h.useRef(),[r,s]=h.useState(0),[i,o]=h.useState(0);return h.useEffect(()=>{r&&(n.current=setTimeout(()=>n.current=void 0,e))},[i,Pw]),h.useEffect(()=>{n.current||(t(),o(Math.random()*10))},[r]),()=>s(Math.random()*10)}const iU="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let fo=(t=21)=>{let e="",n=crypto.getRandomValues(new Uint8Array(t|=0));for(;t--;)e+=iU[n[t]&63];return e};const Bg={currentPlaylist:null,playlistSongs:[]},PR=Nw({name:"currentPlaylist",initialState:Bg,reducers:{setCurrentPlaylist(t,e){const{playlist:n,songs:r}=e.payload;t.currentPlaylist=n,t.playlistSongs=r},updateCurrentPlaylist:(t,e)=>{if(!t.currentPlaylist)return t;Object.assign(t.currentPlaylist,e.payload)},addSongsToPlaylist(t,e){if(!t.currentPlaylist)return t;const n=e.payload.map(r=>({...r,song_in:`playlist_${t.currentPlaylist.id}`,queue_id:fo(4)}));t.playlistSongs.push(...n)},setPlaylistSong(t,e){t.playlistSongs=e.payload},removeSong(t,e){const{index:n}=e.payload;t.playlistSongs.splice(n,1)},resetCurrentPlaylist:t=>{t.currentPlaylist=Bg.currentPlaylist,t.playlistSongs=Bg.playlistSongs}}}),da=t=>t.currentPlaylist,{addSongsToPlaylist:TZ,removeSong:IZ,setCurrentPlaylist:aU,updateCurrentPlaylist:oU,resetCurrentPlaylist:lU,setPlaylistSong:cU}=PR.actions,uU=PR.reducer;function dU(){const t=on(),{setErrorToast:e}=te(),{user:n,loading:r}=pe(),s=li(),[i,o]=h.useState(!0),l=async()=>{if(!s.id)return;const d=await Gt({collectionName:"Playlists",id:s.id,msg:">>> api get playlist"});if(d.exists())return{...d.data(),id:d.id}},c=async d=>{if(!d.song_ids.length)return[];const m=ue(_t,X(Lr(),"in",d.song_ids)),p=await bt(m);return p.docs.length?p.docs.map(x=>({id:x.id,...x.data(),queue_id:`${fo(4)}_${d.id}}`})):[]},u=async()=>{try{if(!s.id)return;o(!0);const d=await l();if(!d||!(n?d.owner_email===n.email&&!d.is_official:!1)&&!d.is_public)return;const p=await c(d);t(aU({playlist:d,songs:p}))}catch(d){console.log({message:d}),e()}finally{o(!1)}};return h.useEffect(()=>{if(!r)return u(),()=>{t(lU())}},[r]),{isFetching:i}}function FR({setLoadingFromParent:t}){const[e,n]=h.useState(!1),r=t||n;return{getLyric:async i=>{try{if(!i.id)return;r(!0);const o=await Gt({collectionName:"Lyrics",id:i.lyric_id,msg:"useGetLyric, get lyric"});if(o.exists())return o.data()}catch(o){console.log({message:o})}finally{r(!1)}},loading:e}}function MR(){const t=on(),{setSuccessToast:e}=te();return{action:r=>{switch(r.variant){case"add":const s=r.songs.map(i=>({...i,queue_id:fo(4)}));t(rp({songs:s})),e("Song added to queue");break;case"remove":t(RV({index:r.index}))}}}}const hU=async t=>{const e=Date.now(),n=await Xu.post("/image/encode",t);let r="";n&&(r=n.data.data.encode);const s=(Date.now()-e)/1e3;return console.log(">>> api: get blurHash encode finished after",s),{encode:r}},fU=async(t,e)=>{const n=new FormData;n.append("file",t);const r=Date.now(),s=await Xu.post("/image/optimize",n,{responseType:"blob",params:e});let i;s&&(i=s.data);const o=(Date.now()-r)/1e3;return console.log(">>> api: optimize finished after",o),i};async function zt(t,e){const n=await bt(t);return n.docs?n.docs.map(s=>{const i={...s.data(),id:s.id,queue_id:fo(4)};return e!=null&&e.getQueueId&&(i.queue_id=e.getQueueId(i)),i}):[]}async function Dn(t,e){const n=await bt(t);return n.docs.length?n.docs.map(s=>({...s.data(),id:s.id})):[]}async function bu(t){const e=await bt(t);return e.docs.length?e.docs.map(r=>({...r.data(),id:r.id})):[]}const mi=async({imageFile:t,blob:e,...n})=>{let r=e;if(t&&(r=await fU(t,n)),!r)throw new Error("File not found");const s=new File([r],"image.jpeg",{type:r.type}),i=rd({file:s,folder:"/images/",msg:"upload image file"}),{encode:o}=await hU(r),{fileId:l,url:c}=await i;return{image_file_id:l||"",image_url:c||"",blurhash_encode:o}};function sp(t){const{setOwnPlaylists:e}=at(),{setErrorToast:n}=te(),[r,s]=h.useState(!1),i=(t==null?void 0:t.setIsFetching)||s;return{isFetching:r,addPlaylist:async({imageFile:l,...c},u)=>{var d,m;try{if(i(!0),l){c.playlist.image_file_id&&Dt({fileId:c.playlist.image_file_id});const p=await mi({imageFile:l});Object.assign(c.playlist,p)}switch(c.variant){case"add":const p={...c.playlist,name:c.playlist.name.trim(),meta:bn(c.playlist.name.trim()).split(" ")},g=await Is({collectionName:"Playlists",data:p,msg:">>> Add playlist doc"}),x=await _l(g),w={...x.data(),id:x.id},{push:v=!0}=u||{};return v&&e(S=>[...S,w]),w;case"edit":{const S={...c.playlist,name:(d=c.playlist.name)==null?void 0:d.trim(),meta:bn(((m=c.playlist.name)==null?void 0:m.trim())||"").split(" "),updated_at:st()};return await je({collectionName:"Playlists",data:S,id:c.id,msg:">>> Update playlist doc"}),!0}}}catch(p){console.log(p),n()}finally{i(!1)}}}}function ip(t){const{setIsFetchingFromParent:e}=t||{},[n,r]=h.useState(!0),{setErrorToast:s}=te(),i=e||r;return{fetchComment:async({target_id:l,comment_id:c})=>{try{i(!0);const u=l?ue(Xa,X("target_id","==",l),Ot("created_at","desc")):ue(Xa,X("comment_id","==",c),Ot("created_at","desc")),d=await bt(u);if(d.docs.length)return d.docs.map(p=>({...p.data(),id:p.id,replies:[]}))}catch(u){console.log(u),s()}finally{i(!1)}},isFetching:n}}function mU({audioEle:t}){const e=Zn(),n=h.useMemo(()=>e.pathname.includes("lyric")||e.pathname==="/",[e]);return h.useEffect(()=>{n&&t.pause()},[e]),{shouldHide:n}}function DR({setCategory:t}){const[e,n]=h.useState(!0),r=h.useRef(!1),{id:s}=li(),i=async()=>{try{if(!s)return;n(!0);const o=await Gt({collectionName:"Categories",id:s});if(o.exists()){const l={...o.data(),id:s};t(l)}}catch(o){console.log(o)}finally{n(!1)}};return h.useEffect(()=>{r.current||(r.current=!0,i())},[]),{isFetching:e}}function LR({setSongs:t,songIds:e}){const[n,r]=h.useState(!1),s=h.useRef(!1),i=async()=>{try{if(!e.length)return;r(!0);const o=ue(St(oe,"Songs"),X(Lr(),"in",e)),l=await zt(o);t(l)}catch(o){console.log(o)}finally{r(!1)}};return h.useEffect(()=>{s.current||(s.current=!0,i())},[]),{isFetching:n}}function Fw({setPlaylists:t,playlistIds:e}){const[n,r]=h.useState(!0),s=h.useRef(!1),i=async()=>{try{if(!e.length)return;r(!0);const o=ue(St(oe,"Playlists"),X(Lr(),"in",e)),l=await Dn(o);t(l)}catch(o){console.log(o)}finally{r(!1)}};return h.useEffect(()=>{s.current||(s.current=!0,i())},[]),{isFetching:n}}function Mw(t){const[e,n]=h.useState(),r=(t==null?void 0:t.setImageFileFromParent)||n,s=async i=>{var o,l,c;try{const u=(o=i.clipboardData)==null?void 0:o.files;if(!u)return;r(u[0]),(c=(l=t==null?void 0:t.modalRef)==null?void 0:l.current)==null||c.close()}catch(u){console.log(u)}};return h.useEffect(()=>(window.addEventListener("paste",s),()=>{window.removeEventListener("paste",s)}),[]),{imageFile:e,setImageFile:n}}function ap(){const{setErrorToast:t,setSuccessToast:e}=te(),{shouldGetPlaylists:n,lastDoc:r}=sd(),{playlist:s,songs:i,setSongs:o,updatePlaylistData:l}=Ym(),[c,u]=h.useState(!1),d=Wt(),{addPlaylist:m,isFetching:p}=sp(),g=async(w,v)=>{const S={};w.forEach(E=>S[E.id]=!0);const _={singers:w,singer_map:S};await je({collectionName:"Playlists",id:v,data:_}),l(_)};return{isFetching:c,action:async w=>{try{if(!s)throw new Error("playlist not found");switch(u(!0),w.variant){case"delete-playlist":{const v=fi(oe),S=it(oe,"Playlists",s.id),_=await bt(ue(Xa,X("target_id","==",s.id)));v.delete(S),_.empty||(console.log(`Delete ${_.docs.length} comments`),_.forEach(E=>v.delete(E.ref))),await Promise.all([v.commit(),s.image_file_id?Dt({fileId:s.image_file_id}):()=>{}]),n.current=!0,r.current=void 0,e("Delete playlsit sucessful"),d("/dashboard/playlist");break}case"add-songs":{const v=[...i,...w.songs],_={song_ids:v.map(E=>E.id),updated_at:st()};await je({collectionName:"Playlists",id:s.id,data:_,msg:">>> api: update playlist doc"}),l(_),o(v),e("Songs added");break}case"edit-playlist":{await m({variant:"edit",id:s.id,playlist:w.playlist,imageFile:w.imageFile});const v={...s,...w.playlist};l(v),n.current=!0,r.current=void 0,e("Playlist edited");break}case"remove-song":{const v=i.filter(_=>_.id!==w.song.id),S={song_ids:v.map(_=>_.id),updated_at:st()};await je({collectionName:"Playlists",id:s.id,data:S,msg:">>> api: update playlist doc"}),o(v),e(`'${w.song.name}' removed`);break}case"remove-singer":{const v=s.singers.filter(S=>S.id!==w.singer.id);g(v,s.id),e("Singer removed");break}case"add-singer":{const v=[...s.singers];if(v.find(_=>_.id===w.singer.id))return;v.push(w.singer),g(v,s.id),e("Singer added");break}}}catch(v){console.log({message:v}),t("")}finally{u(!1)}},playlist:s,addPlaylistFetching:p}}function pU({song:t}){const{action:e,isFetching:n,playlist:r}=ap(),s=h.useRef(null),i={overlay:"absolute flex items-center justify-center inset-0 bg-black/40"},o=()=>{var c;(c=s.current)==null||c.open()},l=async c=>{var u;switch(c.variant){case"remove-song":await e({variant:"remove-song",song:c.song});break;case"update-image":await e({variant:"update-image",song:c.song});break;case"add-singer":await e({variant:"add-singer",singer:c.singer}),(u=s.current)==null||u.close()}};return a.jsxs(a.Fragment,{children:[a.jsxs(OR,{song:t,children:[a.jsxs("button",{onClick:()=>l({variant:"remove-song",song:t}),children:[a.jsx(ut,{className:"w-5"}),a.jsx("span",{children:"Remove"})]}),a.jsxs("button",{onClick:o,children:[a.jsx(Nt,{className:"w-5"}),a.jsx("span",{children:"Add singer to playlist"})]}),t.image_url&&a.jsxs("button",{className:`${(r==null?void 0:r.image_url)===t.image_url?"disable":""}`,onClick:()=>l({variant:"update-image",song:t}),children:[a.jsx(ui,{className:"w-5"}),a.jsx("span",{children:"Set playlist image"})]}),n&&a.jsx("div",{className:i.overlay,children:a.jsx("div",{className:"h-[25px] w-[25px] border-[2px] border-r-black rounded-[50%] animate-spin"})})]}),a.jsx(mw,{ref:s,children:a.jsxs(ve,{children:[a.jsx(Z,{title:"Singers"}),a.jsx("div",{className:"space-x-2 mt-3 [&>*]:px-3 [&>*]:py-1 [&>*]:rounded-md  [&>*]:bg-[#f1f1f1] hover:[&>*]:bg-black/10",children:t.singers.map((c,u)=>a.jsx("button",{onClick:()=>l({variant:"add-singer",singer:c}),children:c.name},u))})]})})]})}function gU({song:t}){return a.jsx(a.Fragment,{children:a.jsx(OR,{song:t,children:a.jsxs(Y,{to:`/dashboard/lyric/${t.id}`,children:[a.jsx(ym,{className:"w-5"}),a.jsx("span",{children:"Lyric"})]})})})}function xU({song:t}){return a.jsx("div",{className:"px-2 mb-3",children:a.jsxs("div",{className:"p-2 bg-white/10 rounded-md flex",children:[a.jsx("div",{className:"w-[60px] h-[60px] flex-shrink-0 rounded overflow-hidden",children:a.jsx(Ae,{className:"object-cover h-full",src:t.image_url})}),a.jsxs("div",{className:"ml-2 text-sm",children:[a.jsx("h5",{className:"line-clamp-1 font-[500]",children:t.name}),a.jsx("h5",{className:"line-clamp-1 text-sm opacity-[.7]",children:t.singers.map((e,n)=>(n?", ":"")+e.name)})]})]})})}function OR({song:t,children:e}){return a.jsx(a.Fragment,{children:a.jsx($n,{className:"w-[260px]",children:a.jsxs(er,{children:[a.jsx(xU,{song:t}),a.jsx(Or,{children:e})]})})})}function $R({song:t,variant:e}){const n=()=>{switch(e){case"songs":return a.jsx(gU,{song:t});case"playlist":return a.jsx(pU,{song:t})}};return a.jsx(a.Fragment,{children:a.jsxs(Ln,{appendOnPortal:!0,children:[a.jsx(On,{children:a.jsx(q,{size:"clear",color:"second",className:"p-1",children:a.jsx(ao,{className:"w-5"})})}),n()]})})}function yU({song:t,className:e="",variant:n,children:r}){var s;return a.jsxs("tr",{className:e,children:[a.jsx("td",{children:a.jsx(Y,{to:`/dashboard/song/${t.id}/edit`,className:"hover:underline",children:t.name})}),a.jsx("td",{children:t.singers.map((i,o)=>a.jsxs(Y,{className:"hover:underline",to:`/dashboard/singer/${i.id}`,children:[!!o&&", ",i.name]},o))}),a.jsxs("td",{children:[(s=t.main_genre)==null?void 0:s.name,t.genres.map((i,o)=>a.jsxs("span",{children:[", ",i.name]},o))]}),a.jsx("td",{children:a.jsx($R,{variant:n,song:t})}),r]})}function zR({value:t,setValue:e,inputRef:n}){return a.jsxs($t,{className:"flex gap-2 justify-between items-center",children:[a.jsx(_n,{ref:n,value:t,onChange:r=>e(r.target.value),placeholder:"..."}),a.jsx(q,{onClick:()=>t?e(""):{},size:"clear",className:"p-2 flex-shrink-0",children:t?a.jsx(oo,{className:"w-6"}):a.jsx(Lu,{className:"w-6"})})]})}function mo({handleSubmit:t,setValue:e,value:n,className:r="",loading:s,inputRef:i}){const o=l=>{l.preventDefault(),n.trim()&&t(l)};return a.jsx($t,{className:r,children:a.jsxs("form",{onSubmit:o,className:"flex gap-2 justify-between items-center",children:[a.jsxs("div",{className:"relative flex-grow flex items-center text-[#333]",children:[a.jsx(_n,{type:"text",ref:i,value:n,onChange:l=>e(l.target.value),placeholder:"..."}),n&&a.jsx("button",{type:"button",onClick:()=>{!s&&e("")},className:"absolute right-3",children:s?a.jsx(Ie,{className:"w-6 animate-spin"}):a.jsx(oo,{className:"w-6"})})]}),a.jsx(q,{type:"submit",size:"clear",className:"p-2 flex-shrink-0",children:a.jsx(Lu,{className:"w-6"})})]})})}function rs(t){if(!t)return"0";const e=["","K","M","B"],n=Math.log10(Math.abs(t))/3|0;return n===0?t.toString():(t/Math.pow(10,n*3)).toFixed(1)+e[n]}function op({init:t,submit:e,loading:n}){const[r,s]=h.useState(0),i=h.useRef(null);return h.useEffect(()=>{s(t)},[]),a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{children:"Likes: "})," ",rs(t),a.jsx("button",{onClick:()=>{var o;return(o=i.current)==null?void 0:o.open()},children:a.jsx(Dr,{className:"w-5"})})]}),a.jsx(re,{variant:"animation",ref:i,children:a.jsxs(ve,{children:[a.jsxs("div",{children:[a.jsx(Lt,{htmlFor:"like",children:"Like"}),a.jsx(_n,{value:r+""||"0",id:"like",onChange:o=>s(+o.target.value||0),type:"number"})]}),a.jsx("p",{className:"text-right mt-5",children:a.jsx(q,{color:"primary",onClick:()=>{e(r,i.current.close)},disabled:n,className:"rounded-full",children:"Save"})}),n&&a.jsx(pi,{})]})})]})}function lp({closeModal:t,data:e,submit:n,isLoading:r}){const[s,i]=h.useState([]),[o,l]=h.useState(),c=h.useMemo(()=>{const d=[];return s.forEach(m=>{const p=e.find(g=>g.id===m);p&&d.push(p)}),d},[s]),u=d=>{if(o===void 0)l(d);else if(d===o)l(void 0);else{const m=[...s],p=m[o];m[o]=m[d],m[d]=p,i(m),l(void 0)}};return h.useEffect(()=>{i(e.map(d=>d.id))},[]),a.jsx(a.Fragment,{children:a.jsxs(ve,{children:[a.jsx(Be,{closeModal:t,title:"Change order"}),a.jsx("div",{className:"flex flex-col flex-grow overflow-auto space-y-2 py-2",children:c.map((d,m)=>a.jsx("button",{onClick:()=>u(m),"data-id":d.id,className:`attribute-item p-1.5 ${o===m?"bg-[--primary-cl] text-white":"hover:bg-[--a-5-cl] bg-[#f1f1f1]"}  border-[2px] border-[#ccc] rounded-md`,children:d.label},m))}),a.jsx("p",{className:"text-right mt-3",children:a.jsx(q,{onClick:()=>n(s),loading:r,children:"Ok"})})]})})}function Hl({title:t,modalRef:e,setImageFile:n}){Mw({modalRef:e,setImageFileFromParent:n});const r=h.useRef(null),s=i=>{var o,l;(o=i.target.files)!=null&&o.length&&(n(i.target.files[0]),(l=e.current)==null||l.close())};return a.jsxs(ve,{children:[a.jsx("input",{onChange:s,type:"file",value:"",multiple:!0,accept:"image/png, image/jpeg",id:"image_upload",className:"hidden"}),a.jsx("label",{ref:r,htmlFor:"image_upload"}),a.jsx(Be,{title:t||"Choose image",closeModal:()=>{var i;return(i=e.current)==null?void 0:i.close()}}),a.jsx("label",{htmlFor:"image_upload",className:"inline-flex p-1.5 space-x-1 md:px-3"}),a.jsx("p",{className:"text-center",children:a.jsxs(se,{onClick:()=>{var i;return(i=r.current)==null?void 0:i.click()},color:"primary",children:[a.jsx(qF,{className:"w-6"}),a.jsx("span",{children:"Choose from computer"})]})})]})}function vU({children:t,className:e,persisted:n=!1,...r},s){const i=r.variant||"default",[o,l]=h.useState(i==="default"),[c,u]=h.useState(i==="default"),[d,m]=h.useState(!1),p=()=>{c&&u(!1),o||l(!0)},g=()=>{l(!0)},x=()=>{u(!1),m(!1)},w=()=>{d||(i==="default"?r.closeModal&&r.closeModal():x())},v=E=>{m(E)},S=E=>{E.preventDefault(),E.stopPropagation(),w()};h.useImperativeHandle(s,()=>({toggle:p,close:x,open:g,setModalPersist:v})),h.useEffect(()=>{o&&m(n)},[o]),h.useEffect(()=>{i!=="default"&&(c||setTimeout(()=>{l(!1),r.onClose&&r.onClose()},300))},[c]),h.useEffect(()=>{i!=="default"&&o&&setTimeout(()=>{u(!0)},100)},[o]),h.useEffect(()=>{const E=I=>{I.key==="Escape"&&w()};return o&&window.addEventListener("keyup",E),()=>{window.removeEventListener("keyup",E)}},[o,d]);const _={unMountedContent:"opacity-0 scale-[.95]",mountedContent:"opacity-100 scale-[1]",unMountedLayer:"opacity-0",mountedLayer:"opacity-40"};return a.jsx(a.Fragment,{children:o&&so.createPortal(a.jsxs("div",{className:"fixed inset-0 z-[99]",children:[a.jsx("div",{onClick:S,className:`transition-opacity duration-300 absolute bg-black inset-0 z-[90]
                             ${c?_.mountedLayer:_.unMountedLayer}
                        `}),a.jsx("div",{className:`modal-content absolute duration-300 transition-[transform,opacity] z-[99] top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2
                            ${c?_.mountedContent:_.unMountedContent}
                        `,children:t})]}),document.getElementById("portals"))})}function ve({children:t,noStyle:e,disable:n,className:r="w-[400px]"}){return a.jsx("div",{className:`relative text-[--text-cl] transition-[color] overflow-hidden max-h-[80vh] max-w-[90vw] flex flex-col  ${n?"disabled":""} ${e?"":"p-3 md:p-4s rounded-xl"}  ${location.hash.includes("/dashboard")?"bg-white text-black":"bg-[--popup-cl]"} ${r}`,children:t})}const re=h.forwardRef(vU),wU=({appendOnPortal:t})=>{const[e,n]=h.useState(!1),[r,s]=h.useState(!1),i=h.useRef(null),o=h.useRef(null);return{refs:{triggerRef:i,contentRef:o},setTriggerRef:m=>{i.current=m},setContentRef:m=>{o.current=m},state:{isMounted:r,isOpen:e},setIsMounted:s,setIsOpen:n,appendOnPortal:t,close:()=>{s(!1)},toggle:()=>{r&&s(!1),e||n(!0)}}},BR=h.createContext(null),Gl=()=>{const t=h.useContext(BR);return t||{}};function Ln({children:t,appendOnPortal:e,className:n="",...r}){return a.jsx(BR.Provider,{value:wU({...r,appendOnPortal:e}),children:e?t:a.jsx("div",{className:`relative z-[9] ${n}`,children:t})})}function _U(t){const{state:{isOpen:e},refs:n,close:r,appendOnPortal:s}=Gl(),i=h.useRef(null),o=()=>{const{origin:c="top right",position:u,spacer:d=8}=t,m=n.triggerRef.current,p=n.contentRef.current,g=i.current;if(!m||!p)return;const x=m.getBoundingClientRect(),w={top:x.top+m.clientHeight,left:x.left-p.clientWidth-d};if(s){switch(w.top=x.top+m.clientHeight+d,u){case"right-bottom":w.left=x.left+d;break}const v=w.top+p.clientHeight>window.innerHeight-90;if(v){let S=w.top-p.clientHeight-m.clientHeight;S-60<0&&(S=60),w.top=S}if(g){let S=c;v&&(S="bottom right"),g.style.transformOrigin=S}}p.style.left=`${w.left}px`,p.style.top=`${w.top}px`},l=r;return h.useEffect(()=>{if(!s)return;if(e)o();else return;const c=document.querySelector(".main-container");if(c)return c.addEventListener("wheel",l),()=>{c&&c.removeEventListener("wheel",l)}},[e]),{animationRef:i}}const On=h.forwardRef(function({children:t,needButton:e},n){const{refs:r,setIsMounted:s,setIsOpen:i,close:o,toggle:l,state:{isMounted:c,isOpen:u}}=Gl();return h.useImperativeHandle(n,()=>({close:o})),h.useEffect(()=>{c||setTimeout(()=>{i(!1)},400)},[c]),h.useEffect(()=>(u&&setTimeout(()=>{s(!0)},100),()=>{u||s(!1)}),[u]),h.useEffect(()=>{if(!u)return;const d=m=>{var p,g;!r.contentRef||!r.triggerRef||(p=r.triggerRef.current)!=null&&p.contains(m.target)||(g=r.contentRef.current)!=null&&g.contains(m.target)||s(!1)};return document.addEventListener("mousedown",d),document.addEventListener("touchstart",d),()=>{document.removeEventListener("mousedown",d),document.removeEventListener("touchstart",d)}},[u]),!e&&h.isValidElement(t)?h.cloneElement(t,{onClick:l,ref:r.triggerRef}):a.jsx("button",{ref:r.triggerRef,onClick:l,children:t})});function $n(t){const{animationRef:e}=_U(t),{state:{isMounted:n,isOpen:r},appendOnPortal:s,setContentRef:i}=Gl(),o={unMountedContent:"opacity-0 scale-[.95]",mountedContent:"opacity-100 scale-[1]"},l=a.jsx("div",{ref:i,className:`${s?"fixed z-[99]":"absolute"} ${t.className||""}`,children:a.jsx("div",{ref:e,className:` transition-[transform,opacity] duration-[.25s] ease-linear ${t.animationClassName||""} ${n?o.mountedContent:o.unMountedContent}`,children:t.children})});return r?a.jsx(a.Fragment,{children:s?so.createPortal(l,document.getElementById("portals")):l}):a.jsx(a.Fragment,{})}function SU({children:t,className:e=""}){const{close:n}=Gl(),r=h.useRef(null);return h.useEffect(()=>{if(!r.current)return;const s=r.current.querySelectorAll("button");return s.forEach(i=>{i.addEventListener("click",n)}),()=>{s&&s.forEach(i=>{i.removeEventListener("click",n)})}},[]),a.jsx("div",{ref:r,className:`${e}`,children:t})}function Or({children:t,dismiss:e=!0,className:n=""}){const r={container:"hover:[&>*:not(div.absolute)]:bg-[--a-5-cl] [&>*]:px-3 [&>*]:py-2 [&>*]:w-full [&>*]:space-x-2 [&>*]:text-sm [&>*]:flex [&>*]:items-center [&_svg]:w-6  [&_svg]:flex-shrink-0 [&>*]:items-center [&_span]:font-semibold"};return e?a.jsx(SU,{className:`${r.container} ${n}`,children:t}):a.jsx("div",{className:r.container,children:t})}function er({children:t,className:e="",colorClasses:n="bg-[--popup-cl] text-[--text-cl]"}){return a.jsx("div",{className:`rounded-md py-2 shadow-[0_0_6px_0_rgba(0,0,0,0.2)]  transition-[color] ${n}  ${e}`,children:t})}var bU=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","#","$","%","*","+",",","-",".",":",";","=","?","@","[","]","^","_","{","|","}","~"],Cc=t=>{let e=0;for(let n=0;n<t.length;n++){let r=t[n],s=bU.indexOf(r);e=e*83+s}return e},Vg=t=>{let e=t/255;return e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)},Ug=t=>{let e=Math.max(0,Math.min(1,t));return e<=.0031308?Math.trunc(e*12.92*255+.5):Math.trunc((1.055*Math.pow(e,.4166666666666667)-.055)*255+.5)},EU=t=>t<0?-1:1,Hg=(t,e)=>EU(t)*Math.pow(Math.abs(t),e),g2=class extends Error{constructor(t){super(t),this.name="ValidationError",this.message=t}},jU=t=>{if(!t||t.length<6)throw new g2("The blurhash string must be at least 6 characters");let e=Cc(t[0]),n=Math.floor(e/9)+1,r=e%9+1;if(t.length!==4+2*r*n)throw new g2(`blurhash length mismatch: length is ${t.length} but it should be ${4+2*r*n}`)},kU=t=>{let e=t>>16,n=t>>8&255,r=t&255;return[Vg(e),Vg(n),Vg(r)]},TU=(t,e)=>{let n=Math.floor(t/361),r=Math.floor(t/19)%19,s=t%19;return[Hg((n-9)/9,2)*e,Hg((r-9)/9,2)*e,Hg((s-9)/9,2)*e]},IU=(t,e,n,r)=>{jU(t),r=r|1;let s=Cc(t[0]),i=Math.floor(s/9)+1,o=s%9+1,l=(Cc(t[1])+1)/166,c=new Array(o*i);for(let m=0;m<c.length;m++)if(m===0){let p=Cc(t.substring(2,6));c[m]=kU(p)}else{let p=Cc(t.substring(4+m*2,6+m*2));c[m]=TU(p,l*r)}let u=e*4,d=new Uint8ClampedArray(u*n);for(let m=0;m<n;m++)for(let p=0;p<e;p++){let g=0,x=0,w=0;for(let E=0;E<i;E++)for(let I=0;I<o;I++){let N=Math.cos(Math.PI*p*I/e)*Math.cos(Math.PI*m*E/n),F=c[I+E*o];g+=F[0]*N,x+=F[1]*N,w+=F[2]*N}let v=Ug(g),S=Ug(x),_=Ug(w);d[4*p+0+m*u]=v,d[4*p+1+m*u]=S,d[4*p+2+m*u]=_,d[4*p+3+m*u]=255}return d},CU=IU,RU=Object.defineProperty,NU=Object.defineProperties,AU=Object.getOwnPropertyDescriptors,Of=Object.getOwnPropertySymbols,VR=Object.prototype.hasOwnProperty,UR=Object.prototype.propertyIsEnumerable,x2=(t,e,n)=>e in t?RU(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Vx=(t,e)=>{for(var n in e||(e={}))VR.call(e,n)&&x2(t,n,e[n]);if(Of)for(var n of Of(e))UR.call(e,n)&&x2(t,n,e[n]);return t},Ux=(t,e)=>NU(t,AU(e)),HR=(t,e)=>{var n={};for(var r in t)VR.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&Of)for(var r of Of(t))e.indexOf(r)<0&&UR.call(t,r)&&(n[r]=t[r]);return n},GR=class extends h.PureComponent{constructor(){super(...arguments),this.canvas=null,this.handleRef=t=>{this.canvas=t,this.draw()},this.draw=()=>{let{hash:t,height:e,punch:n,width:r}=this.props;if(this.canvas){let s=CU(t,r,e,n),i=this.canvas.getContext("2d"),o=i.createImageData(r,e);o.data.set(s),i.putImageData(o,0,0)}}}componentDidUpdate(){this.draw()}render(){let t=this.props,{hash:e,height:n,width:r}=t,s=HR(t,["hash","height","width"]);return h.createElement("canvas",Ux(Vx({},s),{height:n,width:r,ref:this.handleRef}))}};GR.defaultProps={height:128,width:128};var PU={position:"absolute",top:0,bottom:0,left:0,right:0,width:"100%",height:"100%"},ad=class extends h.PureComponent{componentDidUpdate(){if(this.props.resolutionX<=0)throw new Error("resolutionX must be larger than zero");if(this.props.resolutionY<=0)throw new Error("resolutionY must be larger than zero")}render(){let t=this.props,{hash:e,height:n,width:r,punch:s,resolutionX:i,resolutionY:o,style:l}=t,c=HR(t,["hash","height","width","punch","resolutionX","resolutionY","style"]);return h.createElement("div",Ux(Vx({},c),{style:Ux(Vx({display:"inline-block",height:n,width:r},l),{position:"relative"})}),h.createElement(GR,{hash:e,height:o,width:i,punch:s,style:PU}))}};ad.defaultProps={height:128,width:128,resolutionX:32,resolutionY:32};const Dw="USRKy:SK%|R*}@r@MxoeY$kWmnafBUR*oybu",Uc={image:"./meo_vo_tri.png",blurhash:"LGRx;gsj^Vo~iFbJpMRP^oj=Ixbd"},y2={image:"./cho_vo_tri.png",blurhash:"LDRf4[-e|,ErI7EUkv$@nK-iEVIb"};function Ae({src:t,className:e="",width:n="w-full",blurHashEncode:r,onError:s,fallback:i}){const[o,l]=h.useState(!1),c=h.useRef(null),u=()=>{setTimeout(()=>l(!0),200),t&&t!=null&&t.includes("blob")&&URL.revokeObjectURL(t)},d=()=>{const p=c.current;p.src=i||"https://placehold.co/400",l(!0)},m=()=>{console.log("image error"),s?(s(),d()):d()};return a.jsxs(a.Fragment,{children:[!o&&a.jsx(a.Fragment,{children:a.jsx(ad,{hash:r||Dw,className:`overflow-hidden ${e}`,height:"100%",width:"100%"})}),a.jsx("img",{onLoad:u,onError:m,className:`${e} ${n} ${o?"":"hidden"}`,src:t||"https://placehold.co/500",ref:c})]})}function v2({className:t,icon:e,label:n,to:r,arrowIcon:s,children:i}){return r?a.jsxs(Y,{className:`w-full flex  justify-between  ${t}`,to:r,children:[a.jsxs("div",{className:"inline-flex items-center ",children:[e,a.jsx("span",{className:"text-lg font-medium",children:n})]}),i,s&&a.jsx("span",{children:s})]}):a.jsx("p",{children:"No onClick"})}const Lw="/HD-MP3/assets/simon_empty-95813d48.png";function Ce({children:t,variant:e="default",className:n=""}){const r=()=>{switch(e){case"less":return a.jsx(a.Fragment,{});case"with-home-button":return a.jsxs(a.Fragment,{children:[a.jsx("p",{className:"text-center",children:"No result found, ¯\\_(ツ)_/¯"}),a.jsx("p",{className:"text-center mt-5",children:a.jsx(Y,{to:"/",children:a.jsxs(se,{color:"primary",children:[a.jsx(Du,{className:"w-6"}),a.jsx("span",{children:"Home"})]})})})]});case"default":return a.jsx("p",{className:"text-center",children:"No result found, ¯\\_(ツ)_/¯"})}};return a.jsxs("div",{className:`${n}`,children:[a.jsx("img",{className:"mx-auto",src:Lw,alt:""}),r(),t]})}function Ve({children:t}){return a.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2",children:t})}function WR({colList:t,children:e,className:n=""}){const r={table:"w-full"};return a.jsxs("table",{className:`${r.table} ${n}`,children:[a.jsx("thead",{children:a.jsx("tr",{className:"no-hover",children:t.map((s,i)=>a.jsx("th",{children:s},i))})}),a.jsx("tbody",{children:e})]})}function FU({audioEle:t,postLocalStorageKey:e}){const[n,r]=Mx(`audio_speed_${e}`,1),[s,i]=Mx(`audio_volume_${e}`,100);return h.useEffect(()=>{t.volume=s/100,t.playbackRate=n},[s,n]),{speed:n,setSpeed:r,volume:s,setVolume:i}}function qR({className:t="",positions:e="right",bg:n="bg-[--primary-cl] text-white",menuColor:r="bg-[--popup-cl]",...s}){const{speed:i,volume:o,setVolume:l,setSpeed:c}=FU(s);return a.jsxs(Ln,{appendOnPortal:!0,children:[a.jsx(On,{children:a.jsx(se,{className:`rounded-full ${n} ${t}`,children:a.jsx(gv,{className:"w-6"})})}),a.jsx($n,{...e==="right"?{position:"right-bottom",origin:"top left"}:{position:"left-bottom",origin:"top right"},children:a.jsx(er,{colorClasses:r,className:"w-[240px] px-2",children:a.jsxs("div",{className:"space-y-[6px]",children:[a.jsxs("div",{className:"flex space-x-1",children:[a.jsxs("div",{className:"w-[110px] flex-shrink-0",children:["Speed ",i,"x"]}),a.jsx("input",{className:"w-full",type:"range",step:.1,min:.6,max:1.5,value:i,onChange:u=>c(+u.target.value)})]}),a.jsxs("div",{className:"flex space-x-1",children:[a.jsxs("div",{className:"w-[110px] flex-shrink-0",children:["Volume ",o,"%"]}),a.jsx("input",{className:"w-full",type:"range",step:1,min:1,max:100,value:o,onChange:u=>l(+u.target.value)})]})]})})})]})}function ye({className:t}){return a.jsx("div",{className:`animate-pulse rounded-[4px] bg-gray-400 dark:bg-gray-600  ${t}`})}function as(t){const{variant:e="default",skeNum:n=4,hasCheckBox:r=!0}=t;return[...Array(n).keys()].map(s=>a.jsxs("div",{className:"flex items-center px-3 py-2",children:[r&&a.jsx(ye,{className:"h-[18px] w-[18px]"}),a.jsx(ye,{className:`${e==="default"?"h-[54px] w-[54px]":"h-10 w-10"}  ml-[10px]`}),a.jsxs("div",{className:"ml-[10px]",children:[a.jsx(ye,{className:"h-[16px] w-[140px] max-w-full"}),a.jsx(ye,{className:"h-[14px] w-[80px] mt-[6px] max-w-1/2"})]})]},s))}const KR=()=>a.jsx("div",{className:"py-3",children:a.jsx(ye,{className:"w-full h-[28px]"})}),MU=[...Array(2).keys()].map(t=>a.jsxs("div",{className:"p-2 w-1/2 md:w-1/4",children:[a.jsx(ye,{className:"pt-[100%] rounded-lg"}),a.jsx(ye,{className:"h-[21px] mt-1.5 w-3/4"}),a.jsx(ye,{className:"h-[13px] mt-1 w-3/4"})]},t));function Ho({cb:t,active:e,inActiveBg:n="bg-[--a-5-cl]",size:r="default"}){const s={circle:`${r==="default"?"w-[20px] h-[20px]":"w-[16px] h-[16px]"}  absolute bg-white left-[3px] rounded-[50%] transition-transform top-[50%] translate-y-[-50%]`,active:`${r==="default"?"translate-x-[14px]":"translate-x-[18px]"} `,inActive:"translate-x-[0]"};return a.jsx("div",{onClick:t,className:`relative  cursor-pointer ${r==="default"?"h-[24px]":"h-[20px]"} rounded-[99px] w-[40px] 
         ${e?"bg-[--primary-cl]":n} `,children:a.jsx("div",{className:`${s.circle} ${e?s.active:s.inActive}`})})}function tr({setTab:t,render:e,disable:n,tab:r,tabs:s,className:i="",buttonClasses:o="[&_button]:py-1 [&_button]:px-4 "}){const l={inActiveTab:" hover:bg-[--a-5-cl]",activeTab:"bg-[--primary-cl] text-white"};return a.jsx("div",{className:`bg-[--a-5-cl] ${n?"disable":""} p-1.5 space-x-1 rounded-full ${i} ${o}`,children:s.map((c,u)=>a.jsx(se,{size:"clear",onClick:d=>{t(c),d.target.blur()},className:`${c===r?l.activeTab:l.inActiveTab}`,children:e(c)},u))})}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function DU(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function l(d){try{u(r.next(d))}catch(m){o(m)}}function c(d){try{u(r.throw(d))}catch(m){o(m)}}function u(d){d.done?i(d.value):s(d.value).then(l,c)}u((r=r.apply(t,e||[])).next())})}function LU(t,e){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,s,i,o;return o={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(u){return function(d){return c([u,d])}}function c(u){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,s&&(i=u[0]&2?s.return:u[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,u[1])).done)return i;switch(s=0,i&&(u=[u[0]&2,i.value]),u[0]){case 0:case 1:i=u;break;case 4:return n.label++,{value:u[1],done:!1};case 5:n.label++,s=u[1],u=[0];continue;case 7:u=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(u[0]===6||u[0]===2)){n=0;continue}if(u[0]===3&&(!i||u[1]>i[0]&&u[1]<i[3])){n.label=u[1];break}if(u[0]===6&&n.label<i[1]){n.label=i[1],i=u;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(u);break}i[2]&&n.ops.pop(),n.trys.pop();continue}u=e.call(t,n)}catch(d){u=[6,d],s=0}finally{r=i=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Go=function(){return Go=Object.assign||function(e){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Go.apply(this,arguments)},QR=function(t){return{loading:t==null,value:t}},OU=function(){return function(t,e){switch(e.type){case"error":return Go(Go({},t),{error:e.error,loading:!1,value:void 0});case"reset":return QR(e.defaultValue);case"value":return Go(Go({},t),{error:void 0,loading:!1,value:e.value});default:return t}}},$U=function(t){var e=t?t():void 0,n=h.useReducer(OU(),QR(e)),r=n[0],s=n[1],i=h.useCallback(function(){var c=t?t():void 0;s({type:"reset",defaultValue:c})},[t]),o=h.useCallback(function(c){s({type:"error",error:c})},[]),l=h.useCallback(function(c){s({type:"value",value:c})},[]);return h.useMemo(function(){return{error:r.error,loading:r.loading,reset:i,setError:o,setValue:l,value:r.value}},[r.error,r.loading,i,o,l,r.value])},Ow=function(t,e){var n=$U(function(){return t.currentUser}),r=n.error,s=n.loading,i=n.setError,o=n.setValue,l=n.value;return h.useEffect(function(){var c=_B(t,function(u){return DU(void 0,void 0,void 0,function(){var d;return LU(this,function(m){switch(m.label){case 0:if(!(e!=null&&e.onUserChanged))return[3,4];m.label=1;case 1:return m.trys.push([1,3,,4]),[4,e.onUserChanged(u)];case 2:return m.sent(),[3,4];case 3:return d=m.sent(),i(d),[3,4];case 4:return o(u),[2]}})})},i);return function(){c()}},[t]),[l,s,r]};function Hx({className:t}){const[e]=Ow(na),n={imageFrame:`${t||"w-[35px] h-[35px]"} flex-shrink-0 rounded-full overflow-hidden ${e!=null&&e.photoURL?"":"flex items-center justify-center bg-[#ccc]"}`};return a.jsx("div",{className:n.imageFrame,children:a.jsx(Ae,{fallback:Uc.image,src:(e==null?void 0:e.photoURL)||Uc.image,blurHashEncode:e!=null&&e.photoURL?"":Uc.blurhash,className:"w-full"})})}function zU({children:t,onClose:e},n){const[r,s]=h.useState(!1),[i,o]=h.useState(!1),l=()=>{i&&o(!1),r||s(!0)},c=()=>{s(!0)},u=()=>{o(!1)},d=p=>{p.preventDefault(),p.stopPropagation(),u()};h.useImperativeHandle(n,()=>({toggle:l,close:u,open:c,setModalPersist:()=>{}})),h.useEffect(()=>{i||setTimeout(()=>{s(!1),e&&e()},400)},[i]),h.useEffect(()=>{r&&setTimeout(()=>{o(!0)},100)},[r]);const m={unMountedContent:"translate-y-full ",mountedContent:"translate-y-0",unMountedLayer:"opacity-0",mountedLayer:"opacity-20"};return a.jsx(a.Fragment,{children:r&&so.createPortal(a.jsxs("div",{className:"fixed inset-0 z-[99]",children:[a.jsx("div",{onClick:d,className:`transition-opacity duration-300 absolute bg-black inset-0 z-[90]
                             ${i?m.mountedLayer:m.unMountedLayer}
                        `}),a.jsx("div",{className:`modal-content absolute bottom-0 left-0 right-0 duration-300 transition-[transform,opacity] z-[99]
                            ${i?m.mountedContent:m.unMountedContent}
                        `,children:t})]}),document.getElementById("portals"))})}const Gx=h.forwardRef(zU),BU="/HD-MP3/assets/loading-b1210647.gif";function ha({className:t=""}){return a.jsx("img",{src:BU,className:`w-[200px] mx-auto ${t}`})}function Lt({children:t,className:e="",htmlFor:n}){const r=`text-gray-600 dark:text-gray-300 font-bold ${e}`;return n?a.jsx("label",{className:r,htmlFor:n,children:t}):a.jsx("p",{className:r,children:t})}function pi(){return a.jsx("div",{className:"absolute z-[999] left-0 top-0 bottom-0 w-full flex items-center justify-center bg-white/60 dark:bg-white/30",children:a.jsx("div",{className:"w-9 h-9 animate-spin rounded-full border-r-[--primary-cl] border-4"})})}function od({className:t="h-[6px]",onClick:e,elelRef:n,bg:r="var(--a-5-cl)"}){return a.jsx("div",{onClick:e,ref:n,style:{background:r},className:`rounded-full w-full progress-line ${t}`})}function po({children:t,className:e="space-y-10"}){return a.jsx("div",{className:"min-h-[calc(100vh-127px-10px)] md:min-h-[unset] md:pt-10 "+e,children:t})}const $w="data:image/gif;base64,R0lGODlhJAAkAIABAP///////yH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQ4IDc5LjE2NDAzNiwgMjAxOS8wOC8xMy0wMTowNjo1NyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo0NmRjOGMyNC03YmYxLTQxZTMtYjQ2Zi1mY2ZhMDk4MDE1YWYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MTBDRTc0QzlGNDBEMTFFQTk4NDZENjI0QzI1MENFQzgiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MTBDRTc0QzhGNDBEMTFFQTk4NDZENjI0QzI1MENFQzgiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6YzBhNGU4OWYtNjc4Yy00NmMyLTg4NmUtYzIxNGE0NTIwZDRjIiBzdFJlZjpkb2N1bWVudElEPSJhZG9iZTpkb2NpZDpwaG90b3Nob3A6ODRlMDBjYmEtZjhlNy03YzQ4LWE4MTgtNDc3NTI3MGQ1ZTAyIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkECQgAAQAsAAAAACQAJAAAAnKMj5nArQ9jc7HWyax+GOx/dCAojltpWmgqYazqvu0kz1StrHgYp6tO6gWAn59wZKSxkjcTM7MUEk/SY1BpmGqeHhs0W8Vywk3tkPw9iztcBLfNW7Pl9PLcXk/f8Xz9vguWB6h254Y2+Id4aLjH2Kc4UQAAIfkECQgAAQAsAAAAACQAJAAAAnSMj6nL7Q+jnAzYS+XFGW7beV/4fADpmGijrkvrJnA2z1Q9hvhG7lznA+lyBpuMGAieDiYlQulkIpvTKk9KFRatv2RW671uxeHskwv+ptHLsRnbhbLPZHW7vK6r6XF21J33Bngnp2fY98UXuNikSOg3B8dYAAAh+QQJCAABACwAAAAAJAAkAAACfIyPqcvtD6OctNqLKdg8N955C7iJI4mQAKam6NUeMTMHda3cr4EnOugCfnY2Yi8Y4hmXKqHSWYQ2mclodSqllmTY7fOqbSK9VnLXHB6Ludk2Vg1nv+Vo9zT+rc/zK3qf/wNmt8aHV0Z4aHj2l+inFqgXiQjJuKgYRnkJUgAAIfkECQgAAQAsAAAAACQAJAAAAnuMj6nL7Q+jnLTaC7K+T2/eeBkYiiQjAlyKsJh5uJYc0BRtTzgMpbsn8fFqQ4cQGCuWjqok0vA7toZR4fRJxDJHzg+Uur16s+Nt86sFM8VcdDncbZPlZvZ5fq/H82rp3m5XxZe29mfoZnWIF9hH1+gDqKiHOPhWSBlJWQAAIfkECQgAAQAsAAAAACQAJAAAAn6Mj6nL7Q8RmDTaQ+u1eW7efVg4ZqLRARIppqsZpW6pQTIbzPZd57jD6+keQQ/NuAu+esDiEkl0HlUxKerXKFKvsCTvuY0qp2Dw8IzTlslTdNf3VrO5Qiu8Hre78d/5HSpHB5imR5g3Jhi2d7OWaGbIN4j4pwjJ6Lco00gJVgAAIfkECQgAAQAsAAAAACQAJAAAAn2EH6nL7XnQmxRGULO7WHsbfRPHiQ95mRsqqQvbBqUGG29K13eYw3tMqXVAwJFOMcsIf7YeizmsLJE45ZHYtPqoPO2TWzxdZVXpOGneYqPBc7mtJnflsekaCkXry3Z61h/VtzcnyGcYN1jnRnj4dQf2V8g46QiIB0ly+bhWAAAh+QQJCAABACwAAAAAJAAkAAACfYyPqcvtD+MDtMobqt6Y7Q90C8iJCamZJ0qpCNu6Bhwen0S/JZTb+wTTpSK92c9RzBwbyRsx6BvyoEYpkCW0RLVVVDbWBSuxW7EzDPrW0OrzmPs2U+Nrevvnzs/11ib+T8ZWVufXB+g1qHZnyAhX6HhIopg4yAfZKEkpiFYAACH5BAkIAAEALAAAAAAkACQAAAJ7jI+py+0Po5y02ouB3tht3jGfFopjuYwqgK5npCLuJ8XHDEK2gZP3ywMGeqwfzZgb9mTCnRLHPAalz1k06SRefVPsEsmthrXgYnf8PZvFa7J6206z4fBs8w4t08t2at+qF6j2h+YnRxiX9ybIhrg3iOdlqDjH6Fa5qFYAACH5BAkIAAEALAAAAAAkACQAAAJ1jI+py+0Po5y02otzArxr1nmfEnIjWZ5bqh4l0Lqs8WK1HNpzcFs9/9o5fkFhg1gUQZBJWISZlECL0l3ThFMCc1lq10mzXhFT8Db6JYubam7Yffa+teVymz5O6+fyuLm+hgd39ReIxRd0d+inmLjH+GX3+FIAACH5BAUIAAEALAAAAAAkACQAAAJwjI+py+0Po5y0PoCzhVlv12EfGI5NCJgMqi5sm7zwIc9BPeOw3vKqb6oBLyUaqshB3o4diZDpSTaN0FTkWUVgo8sslbtlapXh43hqKJfP4Ko1TY574ehue24XffV0KJuf9xa4tifoZih351f4h9hRAAA7",$f=t=>{const e=(t.variant==="image"||t.variant==="link")&&a.jsxs("div",{className:"aspect-[1/1] relative rounded-lg overflow-hidden",children:[a.jsx(Ae,{className:`hover:scale-[1.05] duration-[.3s] transition-transform object-cover ${t.active?"brightness-[90%]":""}`,src:t.data.image_url,blurHashEncode:t.data.blurhash_encode}),t.active&&a.jsx(Ve,{children:a.jsx("img",{src:$w,alt:"",className:"w-[30px]"})})]});return(()=>{switch(t.variant){case"skeleton":return a.jsxs("div",{className:"p-3 w-1/2 sm:w-1/3 md:w-1/4",children:[a.jsx(ye,{className:"aspect-[1/1] rounded-lg"}),a.jsx(ye,{className:"h-[21px] mt-1.5 w-3/4"}),a.jsx(ye,{className:"h-[13px] mt-1 w-3/4"})]});case"link":return a.jsxs("div",{className:"p-3 w-1/2 sm:w-1/3 md:w-1/4",children:[a.jsx(Y,{to:`${t.link||"/playlist/"+t.data.id}`,className:"",children:e}),a.jsx("p",{className:"font-semibold leading-[1.3] line-clamp-1 mt-1.5",children:t.data.name}),a.jsx("p",{className:"text-sm item-info leading-[1.3] line-clamp-1",children:t.data.is_album?t.data.singers[0].name:t.data.distributor})]});case"image":return e}})()};function VU({openModal:t}){const e=n=>{t(n)};return a.jsx(a.Fragment,{children:a.jsx(er,{className:"w-[200px] px-2",children:a.jsxs(Or,{className:"[&>button]:rounded-md",children:[a.jsxs("button",{className:"",onClick:()=>e("theme"),children:[a.jsx(eT,{}),a.jsx("span",{children:"Themes"})]}),a.jsxs("button",{onClick:()=>e("info"),children:[a.jsx(Zk,{}),a.jsx("span",{children:"Info"})]})]})})})}const UU=({data:t,active:e,onClick:n,hasTitle:r,classNames:s="",idleClass:i=""},o)=>{const l={container:"flex flex-col",imageFrame:"group relative transition-[width] duration-[.3s] origin-center rounded-xl overflow-hidden",image:"select-none object-cover object-center rounded w-full",overlay:`absolute  ${e?"":"inset-0 hidden bg-black/40 items-center justify-center"}   group-hover:flex`,playingGifFrame:"absolute h-[30px] w-[30px] bottom-[15px] left-[15px] -z-1",title:"text-2xl text-white mt-3 font-bold text-ellipsis line-clamp-1"};if(t)return a.jsxs("div",{ref:o,"queue-id":t.queue_id,className:`song-thumb ${e?"active":""} ${l.container} ${i}`,children:[a.jsx("div",{className:`${s} flex items-end justify-center flex-shrink-0 w-[350px] h-[350px] min-[1536px]:w-[450px] min-[1536px]:h-[450px] `,children:a.jsxs("div",{className:`border-[4px] rounded-[6px] overflow-hidden border-transparent ${l.imageFrame} ${e?"w-[350px] min-[1536px]:w-[450px]":"w-[280px] min-[1536px]:w-[330px]"}`,children:[a.jsx(Ae,{src:t.image_url,blurHashEncode:t.blurhash_encode}),a.jsx("div",{className:`${l.overlay}`,children:!e&&a.jsx(se,{onClick:n,variant:"circle",hover:"scale",size:"clear",className:"p-2 hover:bg-[#fff]/10",children:a.jsx(tT,{className:"w-10"})})}),e&&a.jsx("div",{className:l.playingGifFrame,children:a.jsx("img",{src:$w,alt:""})})]})}),r&&a.jsxs("div",{className:"text-center",children:[a.jsx("h2",{className:l.title,children:(t==null?void 0:t.name)||"Some song"}),a.jsx("p",{className:"text-md opacity-50 line-clamp-1",children:t.singers.map((c,u)=>a.jsx("span",{children:c.name},u))})]})]})},Gg=h.forwardRef(UU);function Wl({className:t="",playlists:e,loading:n,skeNumber:r=2,whenEmpty:s}){const{currentSongData:i}=ce(qe),o=()=>e.length?e.map((l,c)=>{const u=i==null?void 0:i.song.queue_id.includes(l.id);return a.jsx($f,{variant:"link",active:u,data:l},c)}):s||a.jsx(Ce,{variant:"less",className:"mx-auto"});return a.jsx(a.Fragment,{children:a.jsxs("div",{className:`${!n&&!e.length?"":"flex flex-row flex-wrap -mx-3"} ${t}`,children:[n&&[...Array(r).keys()].map(l=>a.jsx($f,{variant:"skeleton"},l)),!n&&o()]})})}function XR(){const{playerConfig:{isCrossFade:t,songImage:e,isEnableBeat:n,lyricSize:r,songBackground:s},updatePlayerConfig:i,audioRef:o,shouldSyncSongDuration:l}=ht(),{currentSongData:c}=ce(qe),u=g=>{i({lyricSize:g}),tt("lyricSize",g)},d=()=>{if(!o.current||!(c!=null&&c.song))return;const g=!n,x=o.current.currentTime;tt("current_time",x),l.current=!0,o.current.src=g?c.song.beat_url:c.song.song_url,i({isEnableBeat:g})},m=g=>g===r?"bg-[--primary-cl]":"bg-[--a-5-cl]",p={disableBtn:"bg-white/10 bg-opacity-20",lyricSizeBtn:"justify-center rounded-full hover:bg-[--a-10-cl]  font-[600] h-[30px] w-[30px] sm:h-[26px] sm:w-[26px] relative",itemContainer:"justify-between min-h-[30px]",text:"text-sm"};return a.jsx(a.Fragment,{children:a.jsx(er,{colorClasses:"bg-[#333] text-white",className:"w-[240px] sm:w-[290px]",children:a.jsxs(Or,{dismiss:!1,children:[a.jsxs("div",{className:`${p.itemContainer}`,children:[a.jsx("p",{className:p.text,children:"Lyric size"}),a.jsxs("div",{className:"flex space-x-[8px]",children:[a.jsx("button",{onClick:()=>u("small"),className:`${m("small")} ${p.lyricSizeBtn}`,children:a.jsx("span",{className:"leading-[1] text-[11px]",children:"A"})}),a.jsx("button",{onClick:()=>u("medium"),className:`${m("medium")} ${p.lyricSizeBtn}`,children:a.jsx("span",{className:"leading-[1] text-[13px]",children:"A"})}),a.jsx("button",{onClick:()=>u("large"),className:`${m("large")} ${p.lyricSizeBtn}`,children:a.jsx("span",{className:"leading-[1] text-[15px]",children:"A"})})]})]}),a.jsxs("div",{className:`${p.itemContainer}`,children:[a.jsx("p",{className:p.text,children:"Background"}),a.jsx(Ho,{size:"thin",active:s,cb:()=>i({songBackground:!s})})]}),a.jsxs("div",{className:`${p.itemContainer}`,children:[a.jsx("p",{className:p.text,children:"Song image"}),a.jsx(Ho,{size:"thin",active:e,cb:()=>i({songImage:!e})})]}),(c==null?void 0:c.song.beat_url)&&a.jsxs("div",{className:`${p.itemContainer}`,children:[a.jsx("p",{className:p.text,children:"Instrumental"}),a.jsx(Ho,{size:"thin",active:n,cb:d})]}),a.jsxs("div",{className:`${p.itemContainer}`,children:[a.jsx("p",{className:p.text,children:"Cross fade"}),a.jsx(Ho,{size:"thin",active:t,cb:()=>i({isCrossFade:!t})})]})]})})})}function HU({children:t,className:e="px-2 py-1 text-sm font-[500]",position:n="bottom-[calc(100%+8px)]",content:r,colorClasses:s="bg-[--popup-cl] text-[--text-cl]",isWrapped:i,...o},l){const[c,u]=h.useState(!1),{setTriggerRef:d,state:m}=Gl(),{onClick:p}=o,g=h.useRef(null),x=()=>{"ontouchstart"in document.documentElement||u(!0)},w=()=>{u(!1)};h.useEffect(()=>{const _=g.current;if(_)return d&&d(_),_.addEventListener("mouseenter",x),_.addEventListener("mouseleave",w),()=>{_.removeEventListener("mouseenter",x),_.removeEventListener("mouseleave",w)}},[]);const v={container:" shadow-[0_0_6px_0_rgba(0,0,0,.15)] font-semibold absolute whitespace-nowrap -translate-x-1/2 left-1/2 rounded-md z-[999]"},S=a.jsx(a.Fragment,{children:h.isValidElement(t)&&a.jsxs(a.Fragment,{children:[Object.keys(o).length?h.cloneElement(t,{ref:g,onClick:p}):h.cloneElement(t,{ref:g}),!(m!=null&&m.isOpen)&&c&&a.jsx("div",{className:`${v.container} ${s} ${n} ${e}`,children:r})]})});if(h.isValidElement(t))return a.jsx(a.Fragment,{children:i?S:a.jsx("div",{className:"relative",children:S})})}const Ys=h.forwardRef(HU);function zw(){const{setSuccessToast:t}=te(),e=()=>{navigator.clipboard.writeText(location.href),t("Link copied")};return a.jsxs("button",{onClick:e,children:[a.jsx(aM,{}),a.jsx("span",{children:"Copy link"})]})}function w2(t){return a.jsxs("div",{className:"p-3",children:[t.variant==="skeleton"&&a.jsxs(a.Fragment,{children:[a.jsx(ye,{className:"pt-[100%] rounded-full"}),a.jsx(ye,{className:"mt-1 w-full h-[24px]"})]}),t.variant==="singer-item"&&a.jsxs(a.Fragment,{children:[a.jsx(Y,{to:`/singer/${t.singer.id}`,children:a.jsx("div",{className:"aspect-[1/1] rounded-full overflow-hidden",children:a.jsx(Ae,{blurHashEncode:t.singer.blurhash_encode,src:t.singer.image_url,className:"hover:scale-[1.05] transition-transform"})})}),a.jsx("p",{className:"mt-1 font-medium text-center",children:t.singer.name})]})]})}function YR({isOpenLyricTabs:t,children:e}){const{currentSongData:n}=ce(qe),{playStatus:r}=ce(Hn),{setLoading:s,shouldGetLyric:i,setSongLyrics:o}=fw(),l=h.useRef(),{getLyric:c}=FR({setLoadingFromParent:s}),u=async m=>{if(m.lyric_id){const p=await c(m);p&&o(JSON.parse(p==null?void 0:p.lyrics))}else await xr(300),s(!1)},d=()=>{clearTimeout(l.current),i.current=!0,s(!0),o([])};return h.useEffect(()=>{if(t&&(n!=null&&n.song)&&i.current){if(i.current=!1,r==="error"){s(!1);return}l.current=setTimeout(()=>u(n.song),500)}},[t,n==null?void 0:n.song.id,r]),h.useEffect(()=>()=>{d()},[n==null?void 0:n.song.id]),e}function GU(){const{user:t}=pe(),[e,n]=h.useState([]),[r,s]=h.useState(!0);return{isFetching:r,recentPlaylists:e,getRecentPlaylist:async()=>{try{if(t){if(t.recent_playlist_ids.length){const o=ue(vn,X(Lr(),"in",t.recent_playlist_ids)),l=await Dn(o),c=[];t==null||t.recent_playlist_ids.forEach(u=>{const d=l.find(m=>m.id===u);d&&c.push(d)}),n(c)}}else{const o=It()["recent-playlists"]||[];n(o)}}catch(o){console.log({message:o})}finally{s(!1)}}}}function WU(){const{currentSongData:t}=ce(qe),e=h.useRef(!1),{isFetching:n,getRecentPlaylist:r,recentPlaylists:s}=GU();h.useEffect(()=>{e.current||(e.current=!0,r())},[]);const i=()=>s.map((o,l)=>{const c=t==null?void 0:t.song.queue_id.includes(o.id);return a.jsx($f,{variant:"link",active:c,data:o},l)});return n?a.jsx("div",{className:"flex flex-row flex-wrap -mx-3 ",children:MU}):s.length?a.jsx(a.Fragment,{children:a.jsxs("div",{children:[a.jsx(Z,{title:"Recent listening"}),a.jsx("div",{className:"flex flex-row flex-wrap -mx-3 ",children:i()})]})}):a.jsx(a.Fragment,{})}function ld(){const{user:t}=pe(),[e,n]=h.useState(!1);return{isFetching:e,action:async s=>{try{switch(n(!0),s){case"login":{await VB(na,M8);break}case"logout":{await SB(na);break}}n(!1)}catch(i){throw i}finally{n(!1)}},user:t}}function qU(){const{loading:t,user:e}=pe(),n=h.useRef(null),{action:r}=ld(),[s,i]=h.useState(""),o=()=>{var m;return(m=n.current)==null?void 0:m.toggle()},l=m=>{var p;i(m),(p=n.current)==null||p.toggle()},c=async()=>{try{await r("logout")}catch(m){console.log("signOut error",{message:m})}finally{o()}},u=h.useMemo(()=>{switch(s){case"theme":return a.jsx(IC,{closeModal:o});case"info":return a.jsx(sT,{closeModal:o});case"logout":return a.jsx(an,{closeModal:o,callback:c,loading:!1,label:"Log out ?"})}},[s]),d={linkItem:"py-3 text-lg w-full border-b border-[--a-5-cl] space-x-2 last:border-none flex items-center",icon:"w-7"};return a.jsxs("div",{className:"md:hidden",children:[a.jsx("div",{className:"text-xl font-playwriteCU leading-[2.2] mb-3",children:"Setting"}),e&&a.jsxs("div",{className:"bg-[--a-5-cl] p-3 rounded-md flex mb-3",children:[a.jsx(Hx,{className:"h-[65px] w-[65px]"}),a.jsxs("div",{className:"ml-3",children:[a.jsx("p",{className:"text-lg font-[500]",children:e.display_name}),a.jsx("p",{className:"opacity-70 font-[500]",children:"Vip member ❤️"})]})]}),t?[...Array(3).keys()].map(m=>a.jsx(KR,{},m)):a.jsxs("div",{className:"",children:[a.jsxs("button",{className:d.linkItem,onClick:()=>l("theme"),children:[a.jsx(eT,{className:d.icon}),a.jsx("span",{children:"Theme"})]}),a.jsxs("button",{className:d.linkItem,onClick:()=>l("info"),children:[a.jsx(Zk,{className:d.icon}),a.jsx("span",{children:"Info"})]}),(e==null?void 0:e.role)==="ADMIN"&&a.jsxs(Y,{to:"/dashboard",className:d.linkItem,children:[a.jsx(xm,{className:d.icon}),a.jsx("span",{children:"Dashboard"})]}),e&&a.jsxs("button",{className:d.linkItem,onClick:()=>l("logout"),children:[a.jsx(hv,{className:d.icon}),a.jsx("span",{children:"Logout"})]})]}),a.jsx(re,{ref:n,variant:"animation",children:u})]})}function JR({amount:t}){const[e,n]=h.useState([]),{setErrorToast:r}=te(),[s,i]=h.useState(!0),o=h.useRef(!1),l=async()=>{try{i(!0);const c=j$([0,0,0,0]),u=ue(_t,X("last_active",">=",c),Ot("today_play","desc"),Mt(t)),d=await zt(u);n(d)}catch(c){console.log({message:c}),r()}finally{i(!1)}};return h.useEffect(()=>{o.current||(o.current=!0,l())},[]),{isFetching:s,songs:e}}function KU({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{fillRule:"evenodd",d:"M7.72 12.53a.75.75 0 010-1.06l7.5-7.5a.75.75 0 111.06 1.06L9.31 12l6.97 6.97a.75.75 0 11-1.06 1.06l-7.5-7.5z",clipRule:"evenodd"}))}const QU=h.forwardRef(KU),XU=QU;function YU({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{fillRule:"evenodd",d:"M16.28 11.47a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 01-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 011.06-1.06l7.5 7.5z",clipRule:"evenodd"}))}const JU=h.forwardRef(YU),ZU=JU;function eH({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{fillRule:"evenodd",d:"M4.5 5.653c0-1.426 1.529-2.33 2.779-1.643l11.54 6.348c1.295.712 1.295 2.573 0 3.285L7.28 19.991c-1.25.687-2.779-.217-2.779-1.643V5.653z",clipRule:"evenodd"}))}const tH=h.forwardRef(eH),nH=tH;function rH({title:t,titleId:e,...n},r){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":e},n),t?h.createElement("title",{id:e},t):null,h.createElement("path",{fillRule:"evenodd",d:"M12 3.75a.75.75 0 01.75.75v6.75h6.75a.75.75 0 010 1.5h-6.75v6.75a.75.75 0 01-1.5 0v-6.75H4.5a.75.75 0 010-1.5h6.75V4.5a.75.75 0 01.75-.75z",clipRule:"evenodd"}))}const sH=h.forwardRef(rH),iH=sH;function aH(){const{user:t}=pe(),{shouldFetchOwnPlaylists:e,setOwnPlaylists:n}=at(),{setErrorToast:r,setSuccessToast:s}=te(),[i,o]=h.useState(!1),l=async()=>{try{if(!t)return;const u=ue(vn,X("owner_email","==",t.email),X("is_official","==",!1)),d=await Dn(u,"useGetMyMusicPlaylist, get user own playlists");n(d)}catch(u){console.log(u)}},c=async({songs:u,playlist:d})=>{try{o(!0);const m=[...d.song_ids];if(u.forEach(x=>{m.includes(x.id)||m.push(x.id)}),m.length===d.song_ids.length){await xr(100),s("Song added to playlist");return}const g={song_ids:m};await je({collectionName:"Playlists",id:d.id,data:g}),e.current=!0,s("Song added to playlist")}catch(m){console.log({message:m}),r()}finally{o(!1)}};return h.useEffect(()=>{e.current&&(e.current=!1,l())},[]),{isFetching:i,addToPlaylist:c}}const Wx=t=>({name:"",meta:[],image_url:"",song_url:"",beat_url:"",beat_file_id:"",duration:0,like:0,comment:0,lyric_id:"",image_file_id:"",song_file_id:"",blurhash_encode:"",singer_map:{},genre_ids:[],genres:[],singers:[],is_official:!1,size:0,today_play:0,week_play:0,last_week_play:0,last_week_rank:0,last_week_trending_score:0,total_play:0,release_year:new Date().getFullYear(),last_active:st(),created_at:st(),updated_at:st(),...t}),qx=t=>({name:"",meta:[],song_ids:[],image_url:"",singers:[],singer_map:{},is_album:!1,like:0,comment:0,blurhash_encode:"",is_public:!0,is_official:!1,image_file_id:"",created_at:st(),updated_at:st(),...t}),oH=({owner_email:t,distributor:e,...n})=>qx({owner_email:t,is_album:!0,is_official:!0,is_public:!0,distributor:e,...n}),Kx=t=>({name:"",meta:[],description:"",image_file_id:"",image_url:"",like:0,created_at:st(),blurhash_encode:"",...t}),_2=({start:t,end:e,text:n})=>{const r=n.trim().split(" "),s=r.map(()=>[]),i=r.map(()=>0);return{start:t,end:e,tune:{start:t,end:e,grow:i},cut:s,text:n}},S2=({user:t,target_id:e,...n})=>({target_id:e,text:"",like:0,reply:0,comment_id:"",user_email:t.email,user_image_url:t.photo_url,user_name:t.display_name,created_at:st(),updated_at:st(),...n}),b2=t=>({banner_file_id:"",banner_image_url:"",image_file_id:"",image_url:"",name:"",banner_blurhash_encode:"",blurhash_encode:"",playlist_ids:"",song_ids:"",created_at:st(),updated_at:st(),...t}),lH=(t="")=>({name:t,show:!0,target_ids:""});function cH(t){const[e,n]=h.useState(),[r,s]=h.useState(),i=h.useRef(null),o=m=>{e&&n({...e,...m})},l=h.useMemo(()=>t.variant==="add"?!0:!t.playlist||!e?!1:e.name!==t.playlist.name||e.like!==t.playlist.like||e.is_public!==t.playlist.is_public,[e]),c=!!r,u=h.useMemo(()=>{const m=!!(e!=null&&e.name)&&l;return t.variant==="add"?m:m||c},[c,l,e]),d=()=>{switch(t.variant){case"add":return qx({distributor:t.user.display_name,owner_email:t.user.email,name:t.name});case"edit":const{id:m,updated_at:p,...g}=t.playlist;return qx(g)}};return h.useEffect(()=>{var m,p;t.variant==="add"&&((m=i.current)==null||m.focus(),(p=t.modalRef.current)==null||p.setModalPersist(!0)),n(d())},[]),h.useEffect(()=>{var m;(l||c)&&((m=t.modalRef.current)==null||m.setModalPersist(!0))},[e,r]),h.useEffect(()=>{r&&o({image_url:URL.createObjectURL(r)})},[r]),{playlistData:e,imageFile:r,setImageFile:s,updatePlaylistData:o,setPlaylistData:n,inputRef:i,isValidToSubmit:u,isChanged:l,isChangeImage:c}}function ql({isLoading:t,submit:e,...n}){const{imageFile:r,setImageFile:s,playlistData:i,updatePlaylistData:o,isChanged:l,isChangeImage:c,inputRef:u,isValidToSubmit:d}=cH(n),m=h.useRef(null),p=async()=>{i&&(!l&&!c||e(i,r))};return i?a.jsxs(a.Fragment,{children:[a.jsx(Be,{closeModal:()=>{var g;return(g=n.modalRef.current)==null?void 0:g.close()},title:n.variant==="add"?"Add playlist":"Edit playlist"}),a.jsxs("div",{className:"md:flex md:space-x-3 overflow-auto",children:[a.jsxs("div",{className:"space-y-2.5",children:[a.jsx("div",{className:"w-[200px] h-[200px] rounded-lg overflow-hidden",children:a.jsx(Ae,{className:"object-cover object-center h-full",blurHashEncode:i.blurhash_encode,src:i.image_url})}),a.jsx("p",{className:"",children:a.jsxs(se,{onClick:()=>{var g;return(g=m.current)==null?void 0:g.open()},color:"primary",children:[a.jsx(ui,{className:"w-5"}),a.jsx("span",{children:"Change image"})]})})]}),a.jsxs("div",{className:"mt-3 md:mt-0 flex-grow flex flex-col space-y-2.5",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(Lt,{htmlFor:"name",children:"Name"}),a.jsx(_n,{id:"name",ref:u,type:"text",placeholder:"name...",value:i.name||"",onChange:g=>o({name:g.target.value})})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(Lt,{children:"Public"}),a.jsx(Ho,{inActiveBg:"bg-black/10",active:i.is_public,cb:()=>o({is_public:!i.is_public})})]})]})]}),a.jsx("p",{className:"text-right mt-5 md:mt-0",children:a.jsx(se,{color:"primary",onClick:p,disabled:!d||t,className:"font-playwriteCU rounded-full",children:"Save"})}),t&&a.jsx(pi,{}),a.jsx(re,{variant:"animation",ref:m,children:a.jsx(Hl,{modalRef:m,setImageFile:s,title:"Playlist image"})})]}):a.jsx(a.Fragment,{})}function ZR(){const{user:t,updateUserData:e}=pe(),{ownPlaylists:n,setOwnPlaylists:r,favoritePlaylists:s,setFavoritePlaylists:i}=at(),{setErrorToast:o,setSuccessToast:l}=te(),{addPlaylist:c,isFetching:u}=sp();return{isFetching:u,myMusicAddPlaylist:async(m,p)=>{try{if(!t)return;const g=await c({variant:"add",playlist:m,imageFile:p},{push:!1});if(g){const x=[...n,g],w=[...s,g],v={liked_playlist_ids:w.map(S=>S.id)};je({collectionName:"Users",data:v,id:t.email}),e(v),r(x),i(w),l("New playlist created")}}catch(g){console.log({error:g}),o()}}}}function cp({songs:t,closeModal:e}){const{user:n}=pe(),{ownPlaylists:r}=at(),{addToPlaylist:s,isFetching:i}=aH(),{myMusicAddPlaylist:o,isFetching:l}=ZR(),c=h.useRef(null),u=async m=>{await s({playlist:m,songs:t}),e()},d=async(m,p)=>{var g;m.song_ids=t.map(x=>x.id),await o(m,p),(g=c.current)==null||g.close(),e()};if(n)return a.jsxs(a.Fragment,{children:[a.jsxs(ve,{children:[a.jsx(Be,{closeModal:e,title:"Playlists"}),a.jsx("div",{className:"flex-grow flex flex-col overflow-auto space-y-2",children:r.length?r.map((m,p)=>a.jsxs("button",{onClick:()=>u(m),className:"flex rounded-md p-2 hover:bg-[--a-5-cl]",children:[a.jsx(la,{className:"w-5 mr-2"}),a.jsx("span",{children:m.name})]},p)):a.jsx(Ce,{variant:"less"})}),a.jsx("p",{className:"text-center",children:a.jsxs(se,{color:"primary",className:"mt-5 rounded-full justify-center",onClick:()=>{var m;return(m=c.current)==null?void 0:m.open()},children:[a.jsx(Nt,{className:"w-5"}),a.jsx("span",{children:"Add new playlist"})]})}),i&&a.jsx(pi,{})]}),a.jsx(re,{variant:"animation",ref:c,children:a.jsx(ve,{className:"w-[600px]",children:a.jsx(ql,{modalRef:c,submit:d,isLoading:i||l,variant:"add",user:n})})})]})}function Bw({modalRef:t,song:e}){const{user:n}=pe();return n?a.jsx(re,{variant:"animation",ref:t,children:a.jsx(cp,{closeModal:()=>{var r;return(r=t.current)==null?void 0:r.close()},songs:[e]})}):a.jsx(a.Fragment,{})}function Vw({modalRef:t}){const{user:e}=pe();return e?a.jsxs("button",{onClick:()=>{var n;return(n=t.current)==null?void 0:n.open()},children:[a.jsx(Nt,{}),a.jsx("span",{children:"Add to playlist"})]}):a.jsx(a.Fragment,{})}function uH({song:t,index:e}){const{action:n}=MR(),r=h.useRef(null),s=()=>{n({variant:"remove",index:e})};return a.jsxs(a.Fragment,{children:[a.jsxs(dp,{song:t,children:[!1,a.jsxs("button",{onClick:s,children:[a.jsx(xv,{className:"w-5"}),a.jsx("span",{children:"Remove"})]}),a.jsx(Vw,{modalRef:r}),a.jsxs("a",{target:"_blank",href:t.song_url,children:[a.jsx(Fu,{className:"w-5"}),a.jsx("span",{children:"Download"})]})]}),a.jsx(Bw,{song:t,modalRef:r})]})}function dH({song:t,modalRef:e}){const{user:n}=pe(),{updateSong:r}=at(),[s,i]=h.useState({name:t.name,singer:t.singers[0].name,image_url:t.image_url}),[o,l]=h.useState(!1),[c,u]=h.useState(),{setErrorToast:d,setSuccessToast:m}=te(),p=h.useMemo(()=>t.name!==s.name||t.singers[0].name!==s.singer,[s]),g=!!s.name&&!!s.singer&&p||c,x=(v,S)=>{i({...s,[v]:S})},w=async()=>{var v,S;try{if(!n||!g)return;l(!0),(v=e.current)==null||v.setModalPersist(!0);const{id:_,...E}=t;if(p){if(!s.name||!s.singer)return;E.name=s.name,E.singers=[{...E.singers[0],name:s.singer}]}if(c){t.image_file_id&&Dt({fileId:t.image_file_id});const I=await mi({imageFile:c});Object.assign(E,I)}await je({collectionName:"Songs",data:E,id:t.id}),r({id:t.id,song:E}),m("Song edited"),(S=e.current)==null||S.close()}catch(_){console.log({message:_}),d()}finally{l(!1)}};return h.useEffect(()=>{var v;p&&((v=e.current)==null||v.setModalPersist(!0))},[s]),{isFetching:o,isChanged:p,songData:s,isValidToSubmit:g,handleSubmit:w,imageFile:c,setImageFile:u,handleInput:x}}function hH({song:t,modalRef:e}){const n=h.useRef(null),r=h.useRef(null),{isValidToSubmit:s,songData:i,setImageFile:o,isFetching:l,handleSubmit:c,handleInput:u}=dH({song:t,modalRef:e}),d=p=>{const g=p.target.files;g!=null&&g.length&&(o(g[0]),u("image_url",URL.createObjectURL(g[0])))},m=p=>{var g;p.stopPropagation(),(g=e.current)==null||g.close()};return a.jsxs(ve,{className:"w-[500px]",children:[a.jsx("label",{ref:r,className:"hidden",htmlFor:"image"}),a.jsx("input",{ref:n,id:"image",type:"file",accept:"image/*",onChange:d,className:"hidden"}),a.jsx(Be,{title:"Edit song",closeModal:()=>{var p;return(p=e.current)==null?void 0:p.close()}}),a.jsxs("div",{className:"flex flex-col flex-grow overflow-auto md:overflow-hidden md:flex-row mt-5",children:[a.jsxs("div",{className:"space-y-2.5",children:[a.jsx("div",{className:"w-[200px] rounded-md overflow-hidden h-[200px] md:w-[160px] md:h-[160px] object-cover",children:a.jsx(Ae,{className:"object-cover h-full",src:i.image_url})}),a.jsx(se,{onClick:()=>{var p;return(p=r.current)==null?void 0:p.click()},color:"primary",children:a.jsx(ui,{className:"w-5"})})]}),a.jsxs("div",{className:"pt-5 md:pt-0 md:pl-5 md:flex-grow space-y-3",children:[a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Lt,{htmlFor:"name",children:"Name"}),a.jsx(_n,{value:i.name,type:"text",id:"name",onChange:p=>u("name",p.target.value),placeholder:t.name})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Lt,{htmlFor:"singer",children:"Singer"}),a.jsx(_n,{value:i.singer,onChange:p=>u("singer",p.target.value),type:"text",id:"singer",placeholder:t.singers[0].name})]})]})]}),a.jsxs("div",{className:"flex mt-5 space-x-2 justify-end",children:[a.jsx(se,{onClick:m,className:"rounded-full",children:"Close"}),a.jsx(se,{isLoading:l,onClick:c,disabled:!s,className:" rounded-full",variant:"primary",color:"primary",children:"Save"})]}),l&&a.jsx(pi,{})]})}function up(){const{user:t,updateUserData:e}=pe(),{setErrorToast:n,setSuccessToast:r}=te(),{uploadedSongs:s,setUploadedSongs:i,shouldFetchFavoriteSongs:o}=at(),[l,c]=h.useState(!1);return{loading:l,action:async d=>{try{if(c(!0),!t)throw new Error("User not found");const m=fi(oe),p=it(oe,"Users",t.email),g=it(oe,"Songs",d.song.id);switch(d.variant){case"delete":{const x=s.filter(v=>v.id!==d.song.id),w={liked_song_ids:t.liked_song_ids.filter(v=>v!==d.song.id)};if(m.update(p,w),m.delete(g),d.song.lyric_id){const v=it(oe,"Lyrics",d.song.lyric_id);m.delete(v)}await Promise.all([m.commit(),dR(d.song)]),i(x),r(`'${d.song.name}' deleted`),t.liked_song_ids.includes(d.song.id)&&(o.current=!0);break}case"like":{if(!t)return;const x=[...t.liked_song_ids],w=x.findIndex(E=>E===d.song.id),v=w===-1;v?x.unshift(d.song.id):x.splice(w,1);const S={liked_song_ids:x},_={like:Qs(v?1:-1)};m.update(p,S),m.update(g,_),await m.commit(),e(S),o.current=!0;break}}}catch(m){console.log({message:m}),n()}finally{c(!1)}}}}function Uw({song:t}){const{action:e}=MR(),n=()=>{e({variant:"add",songs:[t]})};return a.jsxs("button",{onClick:n,children:[a.jsx(Nt,{}),a.jsx("span",{children:"Add to queue"})]})}function fH({song:t}){const[e,n]=h.useState(""),r=h.useRef(null),s=h.useRef(null),{action:i,loading:o}=up(),l=m=>{var p;n(m),(p=r.current)==null||p.open()},c=()=>{var m;(m=r.current)==null||m.close()},u=async()=>{await i({variant:"delete",song:t}),c()},d=()=>{switch(e){case"":return a.jsx(a.Fragment,{});case"delete":return a.jsx(an,{callback:u,loading:o,closeModal:c,label:`Delete ' ${t.name} ' ?`});case"edit":return a.jsx(hH,{modalRef:r,song:t});case"add-to-playlist":return a.jsx(cp,{closeModal:c,songs:[t]})}};return a.jsxs(a.Fragment,{children:[a.jsxs(dp,{song:t,children:[!1,a.jsx(Uw,{song:t}),a.jsx(Vw,{modalRef:s}),a.jsxs("button",{onClick:()=>l("edit"),children:[a.jsx(uv,{}),a.jsx("span",{children:"Edit"})]}),a.jsxs(Y,{to:`lyric/${t.id}`,children:[a.jsx(ym,{}),a.jsx("span",{children:t.lyric_id?"Edit lyric":"Add lyric"})]}),a.jsxs("button",{onClick:()=>l("delete"),children:[a.jsx(ut,{}),a.jsx("span",{children:"Delete"})]}),a.jsxs("a",{target:"_blank",href:t.song_url,children:[a.jsx(Fu,{}),a.jsx("span",{children:"Download"})]})]}),a.jsx(re,{variant:"animation",ref:r,children:d()}),a.jsx(Bw,{song:t,modalRef:s})]})}function mH({song:t}){const e=h.useRef(null);return a.jsxs(a.Fragment,{children:[a.jsxs(dp,{song:t,children:[!1,a.jsx(Uw,{song:t}),a.jsx(Vw,{modalRef:e}),a.jsxs("a",{target:"_blank",href:t.song_url,children:[a.jsx(Fu,{}),a.jsx("span",{children:"Download"})]})]}),a.jsx(Bw,{song:t,modalRef:e})]})}function pH(){const t=on(),{playlistSongs:e,currentPlaylist:n}=ce(da),{shouldFetchOwnPlaylists:r}=at(),{setErrorToast:s,setSuccessToast:i}=te(),[o,l]=h.useState(!1);return{isFetching:o,removeSongFromPlaylist:async({song:u})=>{try{if(!n)return;l(!0);const d=e.filter(p=>p.id!==u.id),m={song_ids:d.map(p=>p.id)};await je({collectionName:"Playlists",id:n.id,data:m}),r.current=!0,t(cU(d)),i(`${u.name} removed`)}catch(d){console.log({message:d}),s()}finally{l(!1)}}}}function gH({song:t}){const{removeSongFromPlaylist:e}=pH();return a.jsxs("button",{onClick:()=>e({song:t}),children:[a.jsx(xv,{}),a.jsx("span",{children:"Remove"})]})}function xH({song:t}){return a.jsx(a.Fragment,{children:a.jsxs(dp,{song:t,children:[!1,a.jsx(Uw,{song:t}),a.jsx(gH,{song:t}),a.jsxs("a",{target:"_blank",href:t.song_url,children:[a.jsx(Fu,{className:"w-5"}),a.jsx("span",{children:"Download"})]})]})})}function yH({song:t}){return a.jsx("div",{className:"px-2 mb-3",children:a.jsxs("div",{className:"p-2 bg-white/10 rounded-md flex",children:[a.jsx("div",{className:"w-[50px] h-[50px] rounded overflow-hidden flex-shrink-0",children:a.jsx(Ae,{src:t.image_url,className:"object-cover object-center w-full"})}),a.jsxs("div",{className:"ml-2 text-sm",children:[a.jsx("h5",{className:"line-clamp-1 font-[500]",children:t.name}),a.jsx("p",{className:"opacity-70 line-clamp-1",children:t.singers.map((e,n)=>e.name+(n?", ":""))})]})]})})}function dp({children:t,song:e}){return a.jsx($n,{className:"w-[240px]",children:a.jsxs(er,{children:[a.jsx(yH,{song:e}),a.jsx(Or,{children:t}),a.jsxs("p",{className:"text-xs text-center opacity-70 mt-3",children:["By ",e.distributor]})]})})}function E2({song:t,index:e,variant:n}){const[r,s]=h.useState(!1),i=()=>{switch(n){case"queue-song":return a.jsx(uH,{song:t,index:e});case"own-song":return a.jsx(fH,{song:t});case"own-playlist":return a.jsx(xH,{song:t});default:return a.jsx(mH,{song:t})}},o=()=>{switch(n){case"queue-song":case"recent-song":return a.jsx(a.Fragment,{});default:return a.jsx("span",{className:`text-sm font-[500] hidden p-2 group-hover/main:hidden ${r?"hidden":"md:block"}`,children:Sl(t.duration)})}},l={button:"hover:bg-[--a-5-cl] p-2 rounded-full"},c=()=>r?"bg-[--primary-cl]":"block md:hidden";return a.jsx(a.Fragment,{children:a.jsxs(Ln,{appendOnPortal:!0,children:[a.jsx(On,{children:a.jsx("button",{type:"button",className:`block group-hover/main:block ${l.button} ${c()}`,children:a.jsx(ao,{className:"w-5"})})}),o(),i()]})})}function vH({isLiked:t,song:e,isSongActive:n,songVariant:r,className:s="p-1.5"}){const{action:i,loading:o}=up(),l=()=>{switch(r){case"queue-song":case"recent-song":return"mr-1";default:return""}},c=()=>{if(t)switch(r){case"queue-song":case"recent-song":return"";default:return"!block"}return""},u=()=>{switch(r){case"queue-song":case"recent-song":return n?"text-white":"text-[--primary-cl]";default:return"text-[--primary-cl]"}},d={button:"hover:bg-[--a-5-cl] rounded-full"};return a.jsx("button",{onClick:()=>i({variant:"like",song:e}),className:`${d.button} ${l()} group-hover/main:block md:hidden ${s} ${c()}`,children:o?a.jsx(Ie,{className:"w-5 animate-spin"}):a.jsx(a.Fragment,{children:t?a.jsx(Bl,{className:`w-5 ${u()}`}):a.jsx(Mu,{className:"w-5"})})})}function wH({onClick:t,isChecked:e,isSelected:n}){return a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:t,className:`mr-2 md:mr-3 group-hover/main:block ${e?"block":"md:hidden "}`,children:n?a.jsx(Yu,{className:"w-[18px]"}):a.jsx(vv,{className:"w-[18px]"})}),a.jsx("button",{className:`mr-3 hidden group-hover/main:hidden group-hover/main:mr-[0px] md:block ${Qi(e,"md:hidden")}`,children:a.jsx(la,{className:"w-[18px]"})})]})}function eN({song:t,onClick:e,isHasCheckBox:n,active:r=!0,isLiked:s,index:i,className:o="",imageUrl:l,showIndex:c,...u}){const{isOnMobile:d}=is(),{isChecked:m,selectedSongs:p,selectSong:g}=ho(),x=h.useMemo(()=>p?p.indexOf(t)!=-1:!1,[p]),w=()=>{m!==void 0&&g(t)},v={itemContainer:"w-full sm:group/container flex flex-row rounded-md justify-between py-2 px-3 last:border-none",imageFrame:" relative rounded overflow-hidden flex-shrink-0",overlay:"absolute flex items-center justify-center inset-0 bg-black/40"},S=h.useMemo(()=>{switch(u.variant){default:return a.jsxs("div",{className:` ${v.overlay} 
               ${r?"":"hidden sm:group-hover/main:flex"}`,children:[a.jsx("img",{src:$w,alt:"",className:`"h-[18px] w-[18px] ${ta(!r)}`}),a.jsx("button",{onClick:e,className:`${ta(r)} `,children:a.jsx(nH,{className:"w-[24px] text-white"})})]})}},[r,e]),_=()=>{switch(u.variant){case"queue-song":case"recent-song":return"text-xs";default:return"text-sm"}},E=()=>{switch(u.variant){case"queue-song":case"recent-song":return"w-10 h-10";default:return"h-[54px] w-[54px]"}},I=()=>{switch(u.variant){case"queue-song":case"recent-song":return"text-xs";default:return"text-xs"}},N=A=>{!d||A.target.tagName==="A"||e()},F=a.jsxs(a.Fragment,{children:[n&&a.jsx(wH,{isChecked:m,isSelected:x,onClick:w}),c&&a.jsx("div",{className:`song-index font-bold w-[50px] leading-[54px] flex-shrink-0 md:w-[60px] text-center text-[32px] ${i<=2?"is-top-"+(i+1):""}`,children:i+1}),a.jsxs("div",{className:"flex-grow flex",onClick:N,children:[a.jsxs("div",{className:`${v.imageFrame} ${E()}`,children:[a.jsx(Ae,{src:l||t.image_url,blurHashEncode:t.blurhash_encode}),S]}),a.jsxs("div",{className:"ml-[10px]",children:[a.jsxs("h5",{className:`line-clamp-1 font-semibold overflow-hidden ${_()}`,children:[t.name,!1]}),a.jsx("div",{className:`${u.variant==="queue-song"&&r?"":"item-info"} font-medium line-clamp-1 ${I()}`,children:t.singers.map((A,M)=>A.id?a.jsx(Y,{to:`/singer/${A.id}`,className:"hover:text-[--primary-cl]  hover:underline",children:(M?", ":"")+A.name},M):a.jsxs("span",{children:[" ",(M?", ":"")+A.name]},M))})]})]})]}),k=()=>{switch(u.variant){case"queue-song":case"recent-song":return F;default:return a.jsx("div",{className:"flex flex-grow overflow-hidden",children:F})}},j=()=>{switch(u.variant){case"queue-song":case"recent-song":return a.jsx(E2,{variant:u.variant,song:t,index:i});default:return a.jsx("div",{className:"flex justify-center md:w-[60px]",children:a.jsx(E2,{variant:u.variant,song:t,index:i})})}},C=a.jsxs("div",{className:"flex items-center",children:[s!=null&&a.jsx(vH,{className:"p-2",isSongActive:r,songVariant:u.variant,isLiked:s,song:t}),j()]});return(()=>{switch(u.variant){case"queue-song":return a.jsxs("div",{className:`${v.itemContainer} group/main ${r?"bg-[--primary-cl] text-white":"hover:bg-[--a-5-cl]"}`,children:[k(),C]});default:return a.jsxs("div",{className:`${v.itemContainer} ${o} group/main ${r||x?"bg-[--a-5-cl]":"hover:bg-[--a-5-cl]"}`,children:[k(),C]})}})()}function br({songs:t,setSong:e,getActive:n,songVariant:r,imageUrl:s,showIndex:i,isHasCheckBox:o=!0,whenEmpty:l}){const{user:c}=pe(),{currentSongData:u}=ce(qe);return t.length?t.map((d,m)=>{const p=c?d.owner_email===c.email&&d.is_official===!1:!1;return a.jsx(eN,{showIndex:i,active:u?n?n(d,u.song):d.id===u.song.id:!1,onClick:()=>e(d),variant:r||(p?"own-song":"system-song"),isHasCheckBox:o,isLiked:c?c.liked_song_ids.includes(d.id):null,song:d,imageUrl:s,index:m},d.queue_id)}):l||a.jsx(Ce,{variant:"less"})}async function Qx(t){var s,i;if(console.log(t),!((s=t.main_genre)!=null&&s.id)||!t.genre_ids||!t.release_year)return[];const e=ue(_t,X("main_genre.id","==",(i=t.main_genre)==null?void 0:i.id),X("genre_ids","array-contains-any",t.genre_ids),X("release_year",">=",t.release_year-1),X("release_year","<=",t.release_year+1));return(await zt(e,{msg:"Get relative songs"})).filter(o=>o.id!==t.id)}function cd(){const t=on();return{getRelatigeSongs:async n=>{try{t(PV(!0));const r=await Qx(n);t(rp({songs:r}))}catch(r){console.log(r)}}}}function tN(t){const{isFetching:e,songs:n}=JR(t),{handleSetSong:r}=Sr({variant:"songs"}),{getRelatigeSongs:s}=cd(),i=o=>{r(o.queue_id,n),s(o)};return a.jsx(a.Fragment,{children:a.jsxs("div",{children:[a.jsx(Z,{title:"Trending",className:"mb-3"}),a.jsxs(jn,{children:[e&&a.jsx(as,{}),!e&&a.jsx(br,{showIndex:!0,isHasCheckBox:!1,songs:n,setSong:o=>i(o)})]}),a.jsx("div",{className:"text-center mt-5 border-none",children:a.jsx(Y,{to:"/trending",children:a.jsx(se,{color:"primary",children:"See more"})})})]})})}function nN({category_ids:t}){const[e,n]=h.useState([]),[r,s]=h.useState(!1),i=h.useRef(!1),o=async()=>{try{if(!t.length)return;s(!0);const l=ue(St(oe,"Categories"),X(Lr(),"in",t)),c=await bt(l);if(!c.empty){const u=c.docs.map(d=>({...d.data(),id:d.id}));n(u)}}catch(l){console.log(l)}finally{s(!1)}};return h.useEffect(()=>{i.current||(i.current=!0,o())},[]),{categories:e,isFetching:r}}function _H({autoPlay:t,images:e}){const[n,r]=h.useState(0);h.useEffect(()=>{if(!t||e.length<=1)return;const l=setInterval(()=>{r(c=>c===e.length-1?0:c+1)},5e3);return()=>clearInterval(l)},[t,5e3,e.length]),h.useEffect(()=>{const l=c=>{c.key==="ArrowLeft"?s():c.key==="ArrowRight"&&i()};return window.addEventListener("keydown",l),()=>window.removeEventListener("keydown",l)},[]);const s=()=>{r(l=>l===0?e.length-1:l-1)},i=()=>{r(l=>l===e.length-1?0:l+1)};return{next:i,previous:s,goToSlide:l=>{r(l)},currentIndex:n,setCurrentIndex:r}}function SH({images:t,autoPlay:e=!1,className:n=""}){const{next:r,previous:s,currentIndex:i}=_H({images:t,autoPlay:e});return!t||t.length===0?a.jsx(Ae,{className:""}):a.jsx("div",{className:`relative ${n}`,children:a.jsxs("div",{className:"relative h-full overflow-hidden rounded-lg",children:[a.jsx("div",{className:"flex transition-transform duration-500 ease-in-out h-full",style:{transform:`translateX(-${i*100}%)`},children:t.map((o,l)=>a.jsx(Y,{to:o.link||"",className:"w-full h-full flex-shrink-0",children:a.jsx(Ae,{src:o.imageUrl,blurHashEncode:o.hash,className:"h-full object-cover"})},l))}),t.length>1&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"absolute left-4 top-1/2 transform -translate-y-1/2",children:a.jsx("button",{className:"p-1.5 rounded-full bg-black/50",onClick:s,"aria-label":"Previous image",children:a.jsx(pv,{className:"w-6 text-white"})})}),a.jsx("div",{className:"absolute right-4 top-1/2 transform -translate-y-1/2",children:a.jsx("button",{className:"p-1.5 rounded-full bg-black/50",onClick:r,"aria-label":"Next image",children:a.jsx(df,{className:"w-6 text-white"})})})]})]})})}function rN({categoryIds:t}){const{isFetching:e,categories:n}=nN({category_ids:t}),r=h.useMemo(()=>{const s=[];return t.forEach(i=>{const o=n.find(l=>l.id===i);o&&s.push(o)}),s},[n]);return e?a.jsx(ye,{className:"aspect-[16/4]"}):n.length?a.jsx(SH,{className:"aspect-[16/4]",images:r.map(s=>({imageUrl:s.banner_image_url,link:`/category/${s.id}`,hash:s.banner_blurhash_encode}))}):a.jsx(a.Fragment,{})}function Hw({playlistIds:t,title:e}){const[n,r]=h.useState([]),{isFetching:s}=Fw({setPlaylists:r,playlistIds:t});return n.length?a.jsx(a.Fragment,{children:a.jsxs("div",{children:[e&&a.jsx(Z,{variant:"h2",title:e}),a.jsx(Wl,{loading:s,playlists:n})]})}):a.jsx(a.Fragment,{})}function sN(){const{setCategoryPage:t,setHomePage:e,shouldFetch:n}=En(),[r,s]=h.useState(!0),i=h.useRef(!1),o=async()=>{try{s(!0);const l={category_ids:"",category_sections:[],playlist_sections:[],updated_at:""},[c,u]=await Promise.all([Gt({collectionName:"Page_Config",id:"category",msg:"Get category config"}),Gt({collectionName:"Page_Config",id:"home",msg:"Get home config"})]);t(c.exists()?c.data():l),e(u.exists()?u.data():l)}catch(l){console.log(l)}finally{s(!1)}};return h.useEffect(()=>{i.current||(i.current=!0,n.current?(n.current=!1,o()):setTimeout(()=>s(!1),100))},[]),{isFetching:r}}function bH({amount:t}){const{setErrorToast:e}=te(),{genres:n,setGenres:r}=at(),[s,i]=h.useState(),[o,l]=h.useState(""),[c,u]=h.useState(!0),d=h.useMemo(()=>n.length?n.map(_=>_.name):[],[n]),m=_=>n.find(E=>bn(_)===bn(E.name)),p=h.useMemo(()=>m(o),[n,o]),g=h.useMemo(()=>s?s[(p==null?void 0:p.id)||""].songs:[],[s,o]),x=()=>d.reduce((_,E)=>{var N;const I={songs:[],shouldFetching:!0};return{..._,[((N=m(E))==null?void 0:N.id)||""]:I}},{}),w=h.useRef(!1),v=async()=>{try{const _=ue(uR,X("is_main","==",!0)),E=await bt(_);if(E.empty)return;const I=E.docs.map(N=>({...N.data(),id:N.id}));r(I),l(I[0].name)}catch{console.log("Error when get genres")}},S=async()=>{try{if(!o||!p)return;u(!0);const _=s?{...s}:x(),E={..._[p.id]};if(E.shouldFetching){E.shouldFetching=!1;const I=ue(_t,X("main_genre.id","==",p.id),Ot("updated_at","desc"),Mt(t)),N=await zt(I);E.songs=N,Object.assign(_,{[p.id]:E}),i(_)}else await xr(300)}catch(_){console.log({message:_}),e()}finally{u(!1)}};return h.useEffect(()=>{w.current||(w.current=!0,n.length?l(d[0]):v())},[]),h.useEffect(()=>{o&&S()},[o]),{isFetching:c,currentSongs:g,tabs:d,tab:o,setTab:l}}function EH(t){const{isFetching:e,currentSongs:n,...r}=bH(t),{getRelatigeSongs:s}=cd(),{handleSetSong:i}=Sr({variant:"songs"}),o=l=>{i(l.queue_id,[l]),s(l)};return a.jsx(a.Fragment,{children:a.jsxs("div",{children:[a.jsx(Z,{title:"New song",className:"mb-3"}),a.jsx("div",{className:"mb-5 space-y-3",children:a.jsx(tr,{className:"w-fit",render:l=>l,...r})}),a.jsxs(jn,{children:[e&&a.jsx(as,{}),!e&&a.jsx(br,{isHasCheckBox:!1,songs:n,setSong:l=>o(l)})]}),a.jsx("div",{className:"text-center mt-5 border-none",children:a.jsx(Y,{to:"/trending",children:a.jsx(se,{color:"primary",children:"See more"})})})]})})}function jH(){const{loading:t,user:e}=pe(),{action:n}=ld(),r=async()=>{try{await n("login")}catch(i){console.log(i)}finally{}},s={icon:"w-7 mr-2 inline",linkItem:"py-3 border-b text-lg border-[--a-5-cl] last:border-none"};return a.jsxs("div",{className:"block md:hidden",children:[a.jsx(Z,{title:"Library",className:"mb-1"}),t?[...Array(3).keys()].map(i=>a.jsx(KR,{},i)):a.jsx(a.Fragment,{children:e?a.jsxs(a.Fragment,{children:[a.jsx(v2,{to:"/trending",className:s.linkItem,icon:a.jsx(gm,{className:s.icon}),label:"Trending",arrowIcon:a.jsx(df,{className:"w-6"})}),a.jsx(v2,{to:"/category",className:s.linkItem,icon:a.jsx(wm,{className:s.icon}),label:"Category",arrowIcon:a.jsx(df,{className:"w-6"})})]}):a.jsxs(se,{color:"primary",onClick:r,className:"rounded-md",children:[a.jsx(hv,{className:"w-7"}),a.jsx("span",{className:"font-playwriteCU leading-[2.2]",children:"Login"})]})})]})}function kH(){const[t,e]=h.useState([]),{user:n,loading:r}=pe(),[s,i]=h.useState(!0),o=h.useRef(!1),l=async()=>{try{i(!0);let c=[];if(n){tt("recent-songs",[]);const u=[...n.recent_song_ids],d=u[Math.floor(Math.random()*u.length)],m=await Gt({collectionName:"Songs",id:d});if(m.exists()){const p={...m.data(),id:m.id,queue_id:""},g=await Qx(p);g.length&&(c=g)}}else{const u=It()["recent-songs"]||[];if(u.length){const d=u[Math.floor(Math.random()*u.length)],m=await Qx(d);m.length?c=m:c=u}}if(!c.length){const u=ue(_t,X("is_official","==",!0),Ot("updated_at","desc"),Mt(8));c=await zt(u,{msg:"useGetRecommendSongs, get new songs"})}e(c)}catch(c){console.log(c)}finally{i(!1)}};return h.useEffect(()=>{r||o.current||(o.current=!0,l())},[r]),{songs:t,getRecomemdedSongs:l,isFetching:s}}function TH(){const{songs:t,isFetching:e}=kH(),{handleSetSong:n}=Sr({variant:"songs"});return a.jsx(a.Fragment,{children:a.jsx(jn,{children:a.jsxs("div",{children:[a.jsx(Z,{title:"Recommend"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-4 mt-3",children:e?a.jsx(as,{}):a.jsx(br,{songs:t,setSong:r=>n(r.queue_id,t)})})]})})})}function IH(){const{homePage:t}=En(),{isFetching:e}=sN();return e?a.jsx(Ve,{children:a.jsx(ha,{})}):t?a.jsxs(a.Fragment,{children:[a.jsxs(po,{children:[a.jsx(rN,{categoryIds:t!=null&&t.category_ids?t==null?void 0:t.category_ids.split("_"):[]}),a.jsx(jH,{}),t==null?void 0:t.playlist_sections.map((n,r)=>a.jsx(Hw,{playlistIds:n.target_ids?n.target_ids.split("_"):[]},r)),a.jsx(TH,{}),a.jsx(WU,{}),a.jsx(tN,{amount:5}),a.jsx(EH,{amount:5}),a.jsx(qU,{})]}),a.jsx(ci,{})]}):a.jsx(Ce,{})}function CH(){const t=on(),{setSuccessToast:e}=te(),{selectedSongs:n,resetSelect:r}=ho(),s=()=>{t(rp({songs:n})),e(`${n.length>1?"Songs":"Song"} added to queue`),r()};return a.jsxs("button",{onClick:s,children:[a.jsx(Nt,{className:"w-5"}),a.jsx("span",{className:"",children:"Add to queue"})]})}function RH(){const{selectedSongs:t,resetSelect:e}=ho(),n=h.useRef(null);return a.jsxs(a.Fragment,{children:[a.jsxs("button",{onClick:()=>{var r;return(r=n.current)==null?void 0:r.open()},children:[a.jsx(js,{className:"w-5"}),a.jsx("span",{children:"Add to playlist"})]}),a.jsx(re,{variant:"animation",ref:n,children:a.jsx(cp,{closeModal:()=>{var r;(r=n.current)==null||r.close(),e()},songs:t})})]})}function hp({children:t,selectAll:e}){const{user:n}=pe(),{isSelectAll:r,isChecked:s,resetSelect:i,selectedSongs:o}=ho(),l=a.jsxs(a.Fragment,{children:[e&&a.jsx("button",{onClick:e,className:"ml-[10px]",children:r?a.jsx(oa,{className:"w-[20px]"}):a.jsx(vv,{className:"w-[20px]"})}),a.jsx("span",{className:"font-semibold opacity-[.5]",children:o.length}),a.jsxs("div",{className:"flex space-x-2 items-center [&>button]:bg-[--a-5-cl]  [&>button]:inline-flex [&>button]:space-x-1.5 [&_span]:text-sm [&_span]:font-medium [&>button]:py-1 [&>button]:px-3 [&>button]:rounded-full",children:[a.jsx(CH,{}),n&&a.jsx(RH,{})]}),a.jsx("button",{onClick:i,className:"flex-shrink-0",children:a.jsx(Zu,{className:"w-5"})})]});return a.jsx("div",{className:"flex items-center space-x-2 h-[44px]",children:s?l:t})}function iN(){const{user:t,updateUserData:e}=pe();return{pushRecentPlaylist:async r=>{try{if(t){if(!t.recent_playlist_ids.find(i=>i===r.id)){const o={recent_playlist_ids:[r.id,...t.recent_playlist_ids].slice(0,4)};await je({collectionName:"Users",data:o,id:t.email}),e(o)}}else{const s=It()["recent-playlists"]||[];s.find(o=>o.id===r.id)||(s.unshift(r),tt("recent-playlists",s.slice(0,4)))}}catch(s){console.log({error:s})}}}}const NH=a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"h-[30px] mb-[10px] flex items-center",children:a.jsx(ye,{className:"h-[20px] w-[90px]"})}),a.jsx(as,{})]});function AH({variant:t,loading:e}){const{playlistSongs:n,currentPlaylist:r}=ce(da),{handleSetSong:s}=Sr({variant:"playlist"}),{pushRecentPlaylist:i}=iN(),o=(r==null?void 0:r.is_album)&&!!(r!=null&&r.image_url),l=c=>{if(!r)return;s(c.queue_id,n)&&i(r)};return e?NH:a.jsx(a.Fragment,{children:a.jsxs(jn,{children:[!!n.length&&a.jsx(hp,{variant:t==="others-playlist"?"system-song":"own-playlist",children:a.jsxs("p",{className:"font-[500] opacity-[.5]",children:[n.length," Songs"]})}),a.jsx(br,{imageUrl:o?r.image_url:"",songs:n,setSong:c=>l(c),songVariant:t==="my-playlist"?"own-playlist":"system-song"})]})})}function gi(){const t=on(),{playerConfig:{isShuffle:e,repeat:n,isCrossFade:r},updatePlayerConfig:s,firstTimeSongLoaded:i,audioRef:o,timelineEleRef:l,currentTimeEleRef:c,isPlayingNewSong:u,shouldSyncSongDuration:d,timeLineColorRef:m}=ht(),{currentSongData:p,queueSongs:g}=ce(qe),{playStatus:x}=ce(Hn),w=h.useRef(0),v=()=>{l.current&&c.current&&(c.current.innerText="0:00",l.current.style.background="var-(--a-5-cl)")},S=async()=>{try{if(d.current){d.current=!1;const A=It().current_time||0;o.current.currentTime=A}await o.current.play(),u.current&&(r&&(o.current.volume=0),u.current=!1)}catch{}},_=()=>{o.current.pause()},E=()=>{x==="playing"&&_(),x==="paused"&&S()},I=R=>{const A=l.current,M=c.current,P=R||o.current.currentTime;if(o.current.duration&&A){const we=P/(o.current.duration/100);A.style.background=Tw(+we.toFixed(1),{color:m.current||void 0})}M&&(M.innerText=Sl(P)||"0:00")};return{toggleRepeat:()=>{let R;switch(n){case"no":R="one";break;case"one":R="all";break;case"all":R="no";break;default:R="no"}tt("repeat",R),s({repeat:R})},toggleShuffle:()=>{const R=!e;s({isShuffle:R}),tt("isShuffle",R)},next:()=>{if(!p)return;let R=p.index+1,A;R<g.length?A=g[R]:(R=0,A=g[0]),t(Cs(A.queue_id))},previous:()=>{if(!p)return;let R=p.index-1,A;R>=0?A=g[R]:(A=g[g.length-1],R=g.length-1),t(Cs(A.queue_id))},repeat:n,isShuffle:e,updateProgressElement:I,handleSeek:R=>{const A=R.target;if(l.current){const M=A.getBoundingClientRect(),we=(R.clientX-M.left)/l.current.offsetWidth,ne=Math.round(we*o.current.duration),he=o.current.currentTime;if(w.current&&Math.abs(he-w.current)<1&&Math.abs(ne-w.current)<1)return;I(ne),i.current?tt("current_time",ne):o.current.currentTime=ne,w.current=ne}},handlePlayPause:E,play:S,pause:_,resetForNewSong:v}}function Wg({onClick:t,children:e,text:n}){const{playlistSongs:r}=ce(da);return a.jsxs(se,{onClick:t,disabled:!r.length,size:"clear",color:"primary",className:"rounded-full px-5 py-1",children:[e,a.jsx("span",{className:"font-playwriteCU leading-[2.2]",children:n})]})}function PH(){const{currentPlaylist:t,playlistSongs:e}=ce(da),{currentSongData:n}=ce(qe),{playStatus:r}=ce(Hn),{handlePlayPause:s}=gi(),{handleSetSong:i}=Sr({variant:"playlist"}),{pushRecentPlaylist:o}=iN(),l=()=>{if(!t)return;const c=e[0];i(c.queue_id,e)&&o(t)};if(!t)return a.jsx(a.Fragment,{});if(n!=null&&n.song.queue_id.includes(t.id))switch(r){case"playing":case"waiting":return a.jsx(Wg,{text:"Pause",onClick:s,children:a.jsx(yv,{className:"w-7 mr-1"})});case"loading":case"paused":return a.jsx(Wg,{text:"Continue",onClick:s,children:a.jsx(hf,{className:"w-7 mr-1"})})}return a.jsx(Wg,{text:"Play",onClick:l,children:a.jsx(hf,{className:"w-7 mr-1"})})}function aN(){const t=on(),{user:e,updateUserData:n}=pe(),{setFavoritePlaylists:r,ownPlaylists:s,favoritePlaylists:i,setOwnPlaylists:o,shouldFetchFavoritePlaylists:l,shouldFetchOwnPlaylists:c}=at(),[u,d]=h.useState(!1),{setSuccessToast:m,setErrorToast:p}=te(),g=Wt();return{isFetching:u,action:async w=>{try{if(!e)throw new Error("user not found");d(!0);const v=fi(oe),S=it(oe,"Users",e.email),_=it(oe,"Playlists",w.playlist.id),E=e.liked_playlist_ids.includes(w.playlist.id);switch(w.variant){case"like":{if(!e)throw Error();const I=[...e.liked_playlist_ids],N=I.findIndex(C=>C===w.playlist.id),F=N===-1;F?I.unshift(w.playlist.id):I.splice(N,1);const k={liked_playlist_ids:I},j={like:Qs(F?1:-1)};v.update(S,k),v.update(_,j),await v.commit(),r(F?C=>[w.playlist,...C]:C=>C.filter(R=>R.id!==w.playlist.id)),m(F?"Liked":"Disliked"),n(k);break}case"edit":{const{data:I,playlist:N,imageFile:F}=w,k={...N,...I};if(F){N.image_file_id&&Dt({fileId:N.image_file_id});const R=await mi({imageFile:F});Object.assign(k,R)}await je({collectionName:"Playlists",data:k,id:N.id,msg:">>> api: update playlist doc"}),c.current=!0,E&&(l.current=!0);const{updated_at:j,...C}=k;t(oU(C)),m("Playlist edited");break}case"delete":{const{playlist:I}=w;I.image_file_id&&Dt({fileId:I.image_file_id});const N=await bt(ue(Xa,X("target_id","==",I.id))),F={liked_playlist_ids:e.liked_playlist_ids.filter(j=>j!==I.id)};v.delete(_),v.update(S,F),N.empty||(console.log(`Delete ${N.docs.length} comments`),N.forEach(j=>v.delete(j.ref))),await v.commit();const k=s.filter(j=>j.id!==I.id);if(o(k),E){const j=i.filter(C=>C.id!==I.id);r(j)}m(`Playlist '${I.name}' deleted`),n(F),g("/my-music");break}}}catch(v){console.log({message:v}),p()}finally{d(!1)}},user:e}}function FH({isLiked:t,playlist:e,className:n=""}){const{action:r,isFetching:s}=aN();return a.jsx(se,{size:"clear",onClick:()=>r({variant:"like",playlist:e}),className:`${n}`,children:s?a.jsx(Ie,{className:"w-5 animate-spin"}):a.jsx(a.Fragment,{children:t?a.jsx(Bl,{className:"w-5 text-[--primary-cl]"}):a.jsx(Mu,{className:"w-5"})})})}function MH(){return a.jsx(a.Fragment,{children:a.jsx(oN,{children:a.jsx(zw,{})})})}function DH(){const{currentPlaylist:t}=ce(da),[e,n]=h.useState(""),r=h.useRef(null),{action:s,isFetching:i}=aN(),o=d=>{var m;n(d),(m=r.current)==null||m.open()},l=()=>{var d;return(d=r.current)==null?void 0:d.close()},c=async(d,m)=>{t&&(await s({variant:"edit",playlist:t,data:d,imageFile:m}),l())},u=()=>{if(!t)return a.jsx(a.Fragment,{});switch(e){case"":return a.jsx(a.Fragment,{});case"edit":return a.jsx(ve,{className:"w-[600px]",children:a.jsx(ql,{isLoading:i,playlist:t,submit:c,variant:"edit",modalRef:r})});case"delete":return a.jsx(an,{loading:i,label:`Delete playlist ' ${t.name} ' ?`,callback:()=>s({variant:"delete",playlist:t}),closeModal:l})}};return a.jsxs(a.Fragment,{children:[a.jsxs(oN,{children:[a.jsx(zw,{}),a.jsxs("button",{onClick:()=>o("edit"),children:[a.jsx(Dr,{}),a.jsx("span",{children:"Edit"})]}),a.jsxs("button",{onClick:()=>o("delete"),children:[a.jsx(ut,{}),a.jsx("span",{children:"Delete"})]})]}),a.jsx(re,{variant:"animation",ref:r,children:u()})]})}function oN({children:t}){return a.jsx($n,{className:"left-[calc(100%)] bottom-full w-[140px]",animationClassName:"origin-top-left",children:a.jsx(er,{children:a.jsx(Or,{children:t})})})}function LH({variant:t}){return a.jsx(a.Fragment,{children:a.jsxs(Ln,{children:[a.jsx(On,{children:a.jsx(se,{size:"clear",children:a.jsx(uv,{className:"w-5"})})}),t==="others-playlist"?a.jsx(MH,{}):a.jsx(DH,{})]})})}function OH({target:t}){const[e,n]=h.useState([]),[r,s]=h.useState(!1),[i,o]=h.useState(!0),l=h.useRef(!0);return{target:t,comments:e,isOpenComment:r,setIsOpenComment:s,setComments:n,shouldFetchComment:l,isFetching:i,setIsFetching:o}}const lN=h.createContext(null);function fp({children:t,target:e}){return a.jsx(lN.Provider,{value:OH({target:e}),children:t})}function zn(){const t=h.useContext(lN);if(!t)throw new Error("CommentProvider not provided");return t}function cN({children:t}){return a.jsxs("div",{className:"h-[70vh] overflow-hidden text-white rounded-[16px_16px_0_0] relative p-3 flex flex-col",children:[a.jsx("div",{className:"bg-opacity-[0.8] bg-[#1f1f1f] backdrop-blur-[15px] z-[-1] absolute inset-0"}),t]})}const $H="https://flasktoxic-check-production.up.railway.app/predict";function uN(){const{setErrorToast:t}=te(),{user:e,updateUserData:n}=pe(),{setComments:r,comments:s,target:i}=zn(),[o,l]=h.useState(!1),c=h.useRef(null),u=async p=>(await Xu.post($H,{comment:p})).data.predicted_label==="toxic",d=(p,g)=>{const x={comment:Qs(g||1)};je({collectionName:i==="song"?"Songs":"Playlists",data:x,id:p})};return{isFetching:o,action:async p=>{var g;try{if(!e)return;switch(l(!0),p.type){case"add":{if(await u(p.text)){(g=c.current)==null||g.open();return}const w=S2({user:e,target_id:p.target_id,text:p.text});d(p.target_id);const v=await Is({collectionName:"Comments",data:w}),S=await _l(v);if(S.exists()){const _={...S.data(),id:v.id,replies:[]};r(E=>[_,...E]),l(!1)}break}case"reply":{const{comment:x,comment_index:w,text:v}=p;if(await u(p.text))return;const _=S2({user:e,target_id:x.target_id,text:v,comment_id:x.id});d(p.comment.target_id);const E=await Is({collectionName:"Comments",data:_}),I=await _l(E);if(I.exists()){const N={reply:Qs(1)};await je({collectionName:"Comments",data:N,id:x.id});const F={...I.data(),id:E.id,replies:[]},k=[...s];k[w]={...k[w],replies:[...k[w].replies,F]},r(k),l(!1)}break}case"like":{const x=[...e.liked_comment_ids],w=x.findIndex(E=>E===p.id),v=w===-1;v?x.push(p.id):x.splice(w,1);const S={like:Qs(v?1:-1)};await je({collectionName:"Comments",data:S,id:p.id});const _={liked_comment_ids:x};tt("liked_comment_ids",x),n(_);break}case"delete":{const x=it(oe,"Comments",p.comment.id),w=fi(oe);if(w.delete(x),p.comment.reply){console.log(`Delete ${p.comment.reply} replies `);const _=ue(Xa,X("comment_id","==",p.comment.id));(await bt(_)).forEach(I=>{w.delete(I.ref)})}d(p.comment.target_id,-1),await w.commit();const v=[...e.liked_comment_ids],S=v.findIndex(_=>_===_);S!==-1&&(v.splice(S,1),tt("liked_comment_ids",v)),r(_=>_.filter(E=>E.id!==p.comment.id));break}}}catch(x){console.log({error:x}),t()}finally{l(!1)}},modalRef:c}}function dN(t){const e=t.toDate(),r=new Date().getTime()-e.getTime(),s=Math.floor(r/(1e3*60*60*24));return s?s+(s>1?" days ago":" day ago"):"Today"}const zH=["👍","❤️","😂","😮","😢","😡","😀","😊","😁","😂","🤣","😍","🤩","🥳","😎","😇","🤔","🤫","🤐","😐","😑","😒","🙄","😬","🤥","😌","👋","🙏","👏","🙌","👌","💯","🔥","✨","🎉","🚀","👍","👎","💪","💖"];function BH(){const[t,e]=h.useState(""),n=h.useRef(null),r=s=>{const i=n.current;if(i){const o=i.selectionStart,l=i.selectionEnd;e(t.substring(0,o)+s+t.substring(l)),setTimeout(()=>{i.focus(),i.selectionStart=i.selectionEnd=o+s.length},0)}};return h.useEffect(()=>{n.current&&(n.current.style.height="auto",n.current.scrollHeight>n.current.offsetHeight&&(n.current.style.height=n.current.scrollHeight+"px"))},[t]),{EMOJIS:zH,addEmoji:r,textareaRef:n,value:t,setValue:e}}function mp({onSubmited:t,bg:e="bg-[--a-10-cl]",...n}){const{user:r}=pe(),{action:s,isFetching:i,modalRef:o}=uN(),{EMOJIS:l,textareaRef:c,addEmoji:u,value:d,setValue:m}=BH(),p=async()=>{if(!(!d||!d.trim())){switch(n.variant){case"comment":await s({type:"add",target_id:n.targetId,text:d});break;case"reply":await s({type:"reply",text:d,comment:n.comment,comment_index:n.commentIndex});break}m(""),t&&t()}},g=n.variant==="comment"?"...":`Reply to ${n.comment.user_name}...`;return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex w-full",children:[a.jsx("div",{className:"w-[40px] h-[40px] flex-shrink-0",children:a.jsx(Ae,{fallback:Uc.image,src:r==null?void 0:r.photo_url,blurHashEncode:r!=null&&r.photo_url?"":Uc.blurhash,className:"rounded-full"})}),a.jsxs("div",{className:`rounded-lg ml-2 flex-grow  p-1.5 flex items-end ${e}`,children:[a.jsx("textarea",{ref:c,placeholder:g,value:d,onChange:x=>m(x.target.value),rows:1,className:`${dl} no-scrollbar resize-none max-h-[30vh] w-full !bg-transparent border-none`}),a.jsxs(Ln,{appendOnPortal:!0,children:[a.jsx(On,{children:a.jsx("button",{className:"hover p-1.5 hover:bg-[--a-5-cl] rounded-full",children:a.jsx(hz,{className:"w-6"})})}),a.jsx($n,{children:a.jsx(er,{className:"w-[270px]",children:a.jsx("div",{className:"p-1.5 grid grid-cols-5 justify-items-center max-h-60 overflow-y-auto pr-2",children:l.map((x,w)=>a.jsx("button",{onClick:()=>u(x),className:"p-1 rounded-md hover:bg-gray-200 focus:outline-none focus:ring-1 focus:ring-blue-300  text-2xl","aria-label":`Insert emoji ${x}`,children:x},w))})})})]}),a.jsx("button",{onClick:p,className:"text-[--primary-cl] p-1.5 hover:bg-white/10 rounded-full",children:i?a.jsx(RC,{className:"w-6 animate-spin"}):a.jsx(qa,{className:"w-6"})})]})]}),a.jsx(re,{variant:"animation",ref:o,children:a.jsxs(ve,{children:[a.jsx(Ae,{className:"mx-auto",width:"w-[130px]",src:Lw}),a.jsx(Z,{variant:"h2",className:"text-center",title:"Your commment is not allow"}),a.jsx("p",{className:"mt-5 text-right",children:a.jsx(se,{onClick:()=>{var x;return(x=o.current)==null?void 0:x.close()},color:"primary",children:"Ok"})})]})})]})}function VH({comment:t,commentIndex:e}){const{comments:n,setComments:r}=zn(),[s,i]=h.useState(!1),{fetchComment:o}=ip(),l=async()=>{try{i(!0);const c=await o({comment_id:t.id});if(c){const u=[...n];u[e]={...u[e],replies:c},r(u)}}catch(c){console.log({error:c})}finally{i(!1)}};return a.jsxs("button",{onClick:l,className:"mt-1 text-[#ccc] flex items-center space-x-1",children:[a.jsxs("span",{children:["View ",t.reply," replies"]}),s?a.jsx(Ie,{className:"w-5 animate-spin"}):a.jsx(sz,{className:"w-5"})]})}function hN({comment:t,index:e,level:n,variant:r="dark-bg"}){const{user:s}=pe(),{action:i,isFetching:o}=uN(),[l,c]=h.useState(!1),u=h.useRef("like"),d=h.useRef(null),m=s==null?void 0:s.liked_comment_ids.includes(t.id),p=(s==null?void 0:s.email)===t.user_email,g=async()=>{var x;await i({type:"delete",comment:t}),(x=d.current)==null||x.close()};return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:`${n==1?"py-3":"mt-2"} `,children:a.jsxs("div",{className:"flex w-full items-start space-x-1.5",children:[a.jsx("div",{className:`flex-shrink-0 ${n===1?"w-[40px] h-[40px]":"w-[36px] h-[36px]"} rounded-full overflow-hidden`,children:a.jsx(Ae,{src:t.user_image_url})}),a.jsxs("div",{className:"flex-grow text-[13px]",children:[a.jsxs("div",{className:"flex",children:[a.jsxs("div",{className:"flex-grow ml-2",children:[a.jsxs("div",{className:`rounded-md ${r==="theme-bg"?"text-black dark:text-white":"text-white"}`,children:[a.jsx(Y,{className:`font-medium line-clamp-1 ${r==="theme-bg"?"text-[#333] dark:text-[#f1f1f1]":"text-[#f1f1f1]"}`,to:`/user/${t.user_email}`,children:t.user_name}),a.jsx("div",{className:"text-base mt-1 break-all whitespace-break-spaces",children:t.text})]}),a.jsxs("div",{className:"flex space-x-2 mt-1",children:[a.jsx("span",{className:"opacity-[.7]",children:dN(t.created_at)}),s&&a.jsx(a.Fragment,{children:p?a.jsx("button",{onClick:()=>{var x;u.current="delete",(x=d.current)==null||x.open()},children:"Delete"}):n===1&&a.jsx("button",{onClick:()=>c(!0),children:"Reply"})})]}),!!t.reply&&n===1&&!t.replies.length&&a.jsx(VH,{comment:t,commentIndex:e})]}),a.jsxs("div",{className:"flex flex-col items-center",children:[a.jsx("button",{className:"p-1",onClick:()=>{u.current="like",i({type:"like",id:t.id})},children:o&&u.current==="like"?a.jsx(Ie,{className:"w-6 animate-spin"}):a.jsx(a.Fragment,{children:m?a.jsx(Bl,{className:"w-6 text-red-500"}):a.jsx(Mu,{className:"w-6"})})}),a.jsx("span",{children:t.like})]})]}),!!t.replies.length&&t.replies.map((x,w)=>a.jsx(hN,{comment:x,index:e,level:2},w)),l&&a.jsx("div",{className:"mt-2",children:a.jsx(mp,{onSubmited:()=>c(!1),commentIndex:e,variant:"reply",comment:t})})]})]})}),a.jsx(re,{variant:"animation",ref:d,children:a.jsx(an,{label:"Delete comment",closeModal:()=>{var x;return(x=d.current)==null?void 0:x.close()},loading:o,callback:g})})]})}function Gw({comments:t,isFetching:e=!1,className:n="",variant:r}){return a.jsx(a.Fragment,{children:a.jsxs("div",{className:`flex-grow relative overflow-auto no-scrollbar ${n}`,children:[e&&a.jsx(Ve,{children:a.jsx(Ie,{className:"animate-spin w-7"})}),!e&&a.jsx(a.Fragment,{children:t.length?t.map((s,i)=>a.jsx(hN,{variant:r,level:1,index:i,comment:s},s.id)):a.jsx("p",{className:"text-center",children:"..."})})]})})}function UH(){const{shouldFetchComment:t,setComments:e,isOpenComment:n,setIsFetching:r}=zn(),{currentPlaylist:s}=ce(da),{fetchComment:i}=ip({setIsFetchingFromParent:r}),o=async()=>{if(!s)return;const l=await i({target_id:s.id});e(l||[])};h.useEffect(()=>{!n||!s||t.current&&(t.current=!1,o())},[n])}function j2({targetId:t}){const{isFetching:e,comments:n}=zn();return UH(),e?a.jsx(Ve,{children:a.jsx(Ie,{className:"w-6 animate-spin"})}):a.jsxs(a.Fragment,{children:[a.jsx(Gw,{comments:n}),a.jsx(mp,{variant:"comment",targetId:t})]})}function HH({playlist:t}){const{isOnMobile:e}=is(),{setIsOpenComment:n}=zn(),r=h.useRef(null),s=()=>{var i;(i=r.current)==null||i.open(),n(!0)};return a.jsxs(a.Fragment,{children:[a.jsx(se,{size:"clear",onClick:()=>s(),children:a.jsx(mv,{className:"w-5"})}),!e&&a.jsx(re,{onClose:()=>n(!1),variant:"animation",ref:r,children:a.jsx(ve,{className:"h-[400px] w-[500px]",children:a.jsx(j2,{targetId:t.id})})}),e&&a.jsx(Gx,{ref:r,onClose:()=>n(!1),children:a.jsx(cN,{children:a.jsx(j2,{targetId:t.id})})})]})}const jl=(t,e)=>!(t!=null&&t.seconds)||!(t!=null&&t.seconds)?"":(e==null?void 0:e.type)==="date"?new Date(t==null?void 0:t.toDate()).toLocaleDateString("en-GB"):new Date(t==null?void 0:t.toDate()).toLocaleString();function GH({playlist:t,showSkeleton:e,isLiked:n,variant:r}){const{currentSongData:s}=ce(qe),i=t?s==null?void 0:s.song.queue_id.includes(`${t.id}`):!1,o={container:"flex flex-col md:flex-row lg:flex-col",smallText:"",link:"hover:text-[--primary-cl] hover:underline"},l=()=>t?a.jsxs(a.Fragment,{children:[a.jsx(Y,{className:`block hover:underline hover:text-[--primary-cl] ${o.smallText}`,to:`/singer/${t.singers[0].id}`,children:t.singers[0].name}),a.jsxs("p",{className:"text-sm",children:[a.jsx("span",{children:"❤️ "}),rs(t.like)]})]}):a.jsx(a.Fragment,{}),c=()=>{if(!t)return a.jsx(a.Fragment,{});switch(r){case"my-playlist":return a.jsx(a.Fragment,{children:a.jsx("p",{className:o.smallText,children:t.is_public?"Public":"Private"})});case"others-playlist":return a.jsxs(a.Fragment,{children:[a.jsxs("p",{children:[a.jsx("span",{className:"text-base",children:"❤️ "}),rs(t.like)]}),!!t.singers.length&&a.jsx("p",{className:o.smallText,children:t.singers.map((u,d)=>a.jsx(Y,{className:`${o.link}`,to:`/singer/${u.id}`,children:(d?", ":"")+u.name},d))}),!t.is_official&&a.jsxs("p",{className:o.smallText,children:["Provided by"," ",a.jsx(Y,{className:o.link,to:`/user/${t.owner_email}`,children:t.distributor})]}),a.jsxs("p",{className:o.smallText,children:["Last update:"," ",jl(t.updated_at,{type:"date"})]})]})}};return a.jsx(a.Fragment,{children:a.jsxs("div",{className:o.container,children:[a.jsx("div",{className:"w-[250px] md:w-[200px] mx-auto md:m-0 lg:w-full",children:e?a.jsx(ye,{className:"pt-[100%] rounded-lg"}):t&&a.jsx($f,{data:t,active:i,variant:"image"})}),a.jsxs("div",{className:"flex flex-col items-center mt-3 md:items-start md:ml-5 md:mt-0 lg:ml-0 lg:mt-3 lg:items-center",children:[e?a.jsxs("div",{className:"space-y-1 flex flex-col items-center",children:[a.jsx(ye,{className:"h-[24px] w-[170px]"}),a.jsx(ye,{className:"h-[17px] w-[170px]"}),a.jsx(ye,{className:"h-[17px] w-[60px]"}),a.jsx(ye,{className:"h-[17px] w-[100px]"})]}):t&&a.jsxs(a.Fragment,{children:[a.jsx(Z,{className:"text-center",variant:"h2",title:t.name}),a.jsx("div",{className:"mt-2.5 text-center md:text-left lg:text-center text-sm item-info",children:t.is_album?l():c()})]}),t&&a.jsxs("div",{className:"flex flex-col items-center mt-3 md:flex-row md:mt-auto lg:flex-col lg:mt-3",children:[a.jsx(PH,{}),a.jsxs("div",{className:"flex space-x-3 mt-3 md:ml-3 md:mt-0 lg:mt-3 lg:ml-0 hover:[&_button]:bg-[--a-5-cl] [&_button]:p-2",children:[a.jsx(LH,{variant:r}),n!==null&&a.jsx(FH,{isLiked:n,playlist:t}),a.jsx(fp,{target:"playlist",children:a.jsx(HH,{playlist:t})})]})]})]})]})})}function WH(){const{currentPlaylist:t}=ce(da),{user:e}=pe(),n=e&&t?t.owner_email===e.email&&!t.is_official:!1,r=e?t?e.liked_playlist_ids.includes(t.id):!1:null,{isFetching:s}=dU();return!s&&!t?a.jsx(Ve,{children:a.jsx(Ce,{variant:"with-home-button"})}):a.jsxs(a.Fragment,{children:[a.jsx(po,{children:a.jsxs("div",{className:"lg:flex lg:-mx-3",children:[a.jsx("div",{className:"w-full lg:w-1/4 lg:px-3",children:a.jsx(GH,{showSkeleton:s,variant:n?"my-playlist":"others-playlist",playlist:t,isLiked:r})}),a.jsx("div",{className:"w-full lg:w-3/4 lg:px-3",children:a.jsx("div",{className:"mt-[30px] lg:mt-0",children:a.jsx(AH,{loading:s,variant:n?"my-playlist":"others-playlist"})})})]})}),a.jsx(ci,{})]})}function Ww({tab:t}){const{user:e}=pe(),{favoriteSongs:n,setUploadedSongs:r,setFavoriteSongs:s,shouldFetchUserSongs:i,shouldFetchFavoriteSongs:o}=at(),{setErrorToast:l}=te(),[c,u]=h.useState(!0);return{isFetching:c,getSongs:async()=>{if(e)try{switch(t){case"favorite":{if(o.current){if(o.current=!1,e.liked_song_ids.length){const p=[];for(let x=0;x<e.liked_song_ids.length;x+=30)p.push(e.liked_song_ids.slice(x,x+30));const g=[];for(const x of p)if(x.length>0){const w=ue(_t,X(Lr(),"in",x)),v=await zt(w);g.push(...v)}return s(g),g}}else return await xr(100),n;break}case"uploaded":if(i.current){i.current=!1;const m=ue(_t,X("owner_email","==",e.email),X("is_official","==",!1)),p=await zt(m);r(p)}else await xr(100)}}catch(m){console.log({message:m}),l()}finally{u(!1)}}}}function qH(){const{favoriteSongs:t}=at(),{user:e}=pe(),{handleSetSong:n}=Sr({variant:"songs"}),{getSongs:r,isFetching:s}=Ww({tab:"favorite"}),i=o=>{n(o.queue_id,t)};if(h.useEffect(()=>{r()},[]),!!e)return a.jsxs(jn,{children:[a.jsx(hp,{variant:"favorite-song",children:s?a.jsx(ye,{className:"h-[20px] w-[90px]"}):a.jsxs("p",{className:"font-[500] opacity-[.5]",children:[t.length," Songs"]})}),s&&a.jsx(as,{}),!s&&a.jsx(br,{setSong:i,songs:t})]})}function KH({song:t}){return a.jsxs("div",{className:"flex items-center justify-between p-[10px]",children:[a.jsxs("div",{className:"flex-grow flex",children:[a.jsx(la,{className:"w-[18px] mr-2.5"}),a.jsx("div",{className:"h-[54px] w-[54px] rounded overflow-hidden",children:a.jsx(Ae,{src:t.image_url})}),a.jsxs("div",{className:"ml-[10px]",children:[a.jsx("h5",{className:"line-clamp-1 font-medium overflow-hidden",children:t.name}),a.jsx("p",{className:"opacity-[.7] leading-[1.2] line-clamp-1 text-sm",children:t.singers[0].name})]})]}),a.jsxs("div",{className:"flex space-x-1",children:[a.jsx(Ie,{className:"animate-spin w-5"}),a.jsx("p",{className:"text-sm",children:"Uploading..."})]})]})}function QH(){const{uploadedSongs:t}=at(),{user:e}=pe(),n=h.useRef(null),{uploadingSongs:r,isUploading:s}=bC(),{handleSetSong:i}=Sr({variant:"songs"}),{isFetching:o,getSongs:l}=Ww({tab:"uploaded"}),c=d=>{i(d,t)},u=h.useMemo(()=>o?0:r.length+t.length,[r,t,o]);return h.useEffect(()=>{l()},[]),e?a.jsxs(jn,{children:[a.jsx("label",{htmlFor:"song_upload",className:"hidden",ref:n}),a.jsx(hp,{variant:"uploaded-song",children:o?a.jsx(a.Fragment,{children:a.jsx("div",{className:"h-[30px] mb-[10px] flex items-center",children:a.jsx(ye,{className:"h-[20px] w-[90px]"})})}):a.jsxs("div",{className:"flex justify-between items-center w-full",children:[a.jsxs("p",{className:"font-[500] opacity-[.5]",children:[u," Songs"]}),a.jsxs(se,{onClick:()=>{var d;return(d=n.current)==null?void 0:d.click()},color:"primary",disabled:s,children:[a.jsx(fv,{className:"w-5"}),a.jsx("span",{className:"",children:"Upload"})]})]})}),a.jsxs("div",{className:"",children:[o&&a.jsx(as,{}),!o&&a.jsx(a.Fragment,{children:u?a.jsxs(a.Fragment,{children:[!!t.length&&a.jsx(br,{setSong:d=>c(d.queue_id),songs:t,songVariant:"own-song"}),r.map((d,m)=>a.jsx(KH,{song:d},m))]}):a.jsx(Ce,{variant:"less"})})]})]}):a.jsx(a.Fragment,{})}function fN(){const{user:t}=pe(),{shouldFetchUserSingers:e,setSingers:n,singers:r}=at(),{setErrorToast:s}=te(),[i,o]=h.useState(!0);return{isFetching:i,singers:r,user:t,setIsFetching:o,getSinger:async()=>{try{if(!t)return;if(o(!0),e.current&&t.liked_singer_ids.length){e.current=!1;const c=ue(Qa,X(Lr(),"in",t.liked_singer_ids)),u=await bu(c);return n(u),u}else return await xr(100),r}catch(c){console.log({message:c}),s()}finally{o(!1)}}}}function Xx({singers:t,whenEmpty:e,loading:n=!1,skeNumber:r=4,className:s="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 "}){const i=[...Array(r).keys()].map(o=>a.jsx(w2,{variant:"skeleton"},o));return a.jsxs("div",{className:!n&&!t.length?"":`-mt-3 -mx-3 ${s}`,children:[n&&i,!n&&a.jsx(a.Fragment,{children:t.length?t.map((o,l)=>a.jsx(w2,{variant:"singer-item",singer:o},l)):e||a.jsx(Ce,{className:"mx-auto",variant:"less"})})]})}function XH(){const{isFetching:t,singers:e,getSinger:n}=fN();return h.useEffect(()=>{n()},[]),t?a.jsxs(a.Fragment,{children:[a.jsx(ye,{className:"h-[48px] w-[160px]"}),a.jsx(Xx,{loading:t,singers:[]})]}):!t&&!e.length?a.jsx(a.Fragment,{}):a.jsx(a.Fragment,{children:a.jsxs("div",{children:[a.jsx(Z,{className:"mb-5",title:"Singers"}),a.jsx(Xx,{singers:e})]})})}function YH(){const{checkEntireUser:t}=at(),[e,n]=h.useState(!t.current),{getSinger:r}=fN(),{getSongs:s}=Ww({tab:"favorite"}),i=async()=>{try{await Promise.all([r(),s()])}catch(o){console.log(o)}finally{n(!1)}};return h.useEffect(()=>{t.current||(t.current=!0,i())},[]),{isFetching:e}}const JH=["Favorite","Own"];function ZH(){const{user:t}=pe(),{setOwnPlaylists:e,shouldFetchOwnPlaylists:n,setFavoritePlaylists:r,shouldFetchFavoritePlaylists:s}=at(),[i,o]=h.useState(""),{setErrorToast:l}=te(),[c,u]=h.useState(!0),d=h.useRef(!1),m=async p=>{try{if(!t)return;const g=p||i;switch(u(!0),g){case"Favorite":{if(s.current){if(s.current=!1,!t.liked_playlist_ids.length)return;const x=ue(vn,X(Lr(),"in",t.liked_playlist_ids)),v=(await Dn(x,"useGetMyMusicPlaylist, get user favorite playlists")).filter(S=>!S.is_official&&S.owner_email===t.email?!0:!!S.is_public);r(v)}else await xr(100);break}case"Own":{if(n.current){n.current=!1;const x=ue(vn,X("owner_email","==",t.email),X("is_official","==",!1)),w=await Dn(x,"useGetMyMusicPlaylist, get user own playlists");e(w)}else await xr(100);break}}}catch(g){console.log({message:g}),l()}finally{u(!1)}};return h.useEffect(()=>{const p=async()=>{const g=It().last_playlist_tab;await m(g),o(g||"Favorite")};d.current||(d.current=!0,p())}),h.useEffect(()=>{i&&m()},[i]),{isFetching:c,getPlaylist:m,setIsFetching:u,tab:i,setTab:o,tabs:JH}}function eG(){const{user:t}=pe(),{myMusicAddPlaylist:e,isFetching:n}=ZR(),r=h.useRef(null),s=()=>{var o;return(o=r.current)==null?void 0:o.close()},i=async(o,l)=>{await e(o,l),s()};if(t)return a.jsxs(a.Fragment,{children:[a.jsxs(se,{onClick:()=>{var o;return(o=r.current)==null?void 0:o.open()},size:"clear",className:"py-1 px-4",color:"primary",children:[a.jsx(js,{className:"w-6"}),a.jsx("span",{children:"Add new playlist"})]}),a.jsx(re,{ref:r,variant:"animation",children:a.jsx(ve,{className:"w-[600px]",children:a.jsx(ql,{modalRef:r,isLoading:n,variant:"add",user:t,submit:i})})})]})}function tG(){const{ownPlaylists:t,favoritePlaylists:e}=at(),{isFetching:n,setIsFetching:r,setTab:s,tab:i,tabs:o}=ZH();return a.jsx(a.Fragment,{children:a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between items-center mb-2",children:[a.jsx(Z,{title:"Playlist"}),a.jsx(eG,{})]}),a.jsx("div",{className:"flex space-x-2 my-3",children:a.jsx(tr,{render:l=>l,setTab:l=>{r(!0),s(l),tt("last_playlist_tab",l)},tab:i,tabs:o})}),a.jsx(Wl,{loading:n,skeNumber:4,playlists:i==="Favorite"?e:t})]})})}const nG=["Favorite","Uploaded"];function rG(){const[t,e]=h.useState("Favorite");return a.jsxs(a.Fragment,{children:[a.jsxs(po,{children:[a.jsx(tG,{}),a.jsx(XH,{}),a.jsxs("div",{children:[a.jsx(Z,{title:"Songs"}),a.jsx("div",{className:"flex space-x-2 my-3",children:a.jsx(tr,{render:n=>n,setTab:e,tab:t,tabs:nG})}),t==="Favorite"?a.jsx(qH,{}):a.jsx(QH,{})]})]}),a.jsx(ci,{})]})}function sG(){const{isFetching:t}=YH();return t?a.jsx(Ve,{children:a.jsx(ha,{})}):a.jsx(rG,{})}function mN(){const{behind:t,ahead:e,shouldStoreLocation:n,setBehind:r,setAhead:s}=vC(),i=Zn(),o=Wt(),l=h.useMemo(()=>i.pathname+i.search,[i]);return{ahead:e,behind:t,backward:()=>{const m=[...t],p=m.pop();p&&(n.current=!1,s(g=>[...g,l]),r(m),o(p))},forward:()=>{const m=[...e],p=m.pop();p&&(n.current=!1,r(g=>[...g,l]),s(m),o(p))},goHome:()=>{o("/")}}}function pN({className:t=""}){const{backward:e,behind:n,goHome:r}=mN(),s=()=>{n.length?e():r()};return a.jsx(se,{onClick:s,className:`p-1.5 md:hidden z-[9] relative ${t}`,color:"primary",size:"clear",children:n.length?a.jsx(pv,{className:"w-6"}):a.jsx(Du,{className:"w-6"})})}const iG=()=>{const[t,e]=h.useState(),[n,r]=h.useState(""),[s,i]=h.useState([]),[o,l]=h.useState([]),[c,u]=h.useState(!1),[d,m]=h.useState(!1),[p,g]=h.useState("edit"),[x,w]=h.useState(),v=h.useRef(0),S=h.useMemo(()=>x!==void 0?o[x]:void 0,[x,o]);return{song:t,setSong:e,baseLyric:n,setBaseLyric:r,baseLyricArr:s,setBaseLyricArr:i,lyrics:o,setLyrics:l,updateLyric:(E,I)=>{l(N=>{const F={...N[E],...I};return N[E]=F,[...N]})},isFetching:c,setIsFetching:u,isChanged:d,setIsChanged:m,start:v,selectLyricIndex:x,setSelectLyricIndex:w,currentLyric:S,viewMode:p,setViewMode:g}},gN=h.createContext(null);function aG({children:t}){return a.jsx(gN.Provider,{value:iG(),children:t})}const qt=()=>{const t=h.useContext(gN);if(!t)throw new Error("Edit lyric context not found");return t};function oG({audioEle:t,isClickPlay:e}){const{start:n,baseLyricArr:r,lyrics:s,setLyrics:i,setIsChanged:o,song:l,setIsFetching:c,baseLyric:u}=qt(),{setErrorToast:d,setSuccessToast:m}=te(),p=s.length>=r.length,g=e&&!!r.length&&!p;return{addLyric:()=>{if(!t||!r.length||!l||p)return;const S=+t.currentTime.toFixed(1);if(n.current===S)return;const _=r[s.length],E=_2({start:n.current,end:S,text:_});if(n.current=S,i(I=>[...I,E]),r.length===s.length+2){const I=r[r.length-1],N=_2({start:n.current,end:l.duration,text:I});i(F=>[...F,N])}o(!0)},removeLyric:()=>{if(s.length&&t){const S=s[s.length-1].start;n.current=S,t.currentTime=S,i(_=>_.slice(0,-1)),o(!0)}},isEnableAddBtn:g,submit:async()=>{try{if(c(!0),!l)return;const S=fi(oe),_={lyrics:JSON.stringify(s),base:u},E=it(oe,"Songs",l.id);if(l.lyric_id){const I=it(oe,"Lyrics",l.lyric_id);S.update(I,_)}else{const I=it(St(oe,"Lyrics")),N={lyric_id:I.id,updated_at:st()};S.set(I,_),S.update(E,N)}await S.commit(),m("Edit lyric successful"),o(!1)}catch(S){console.log({error:S}),d()}finally{c(!1)}}}}function lG({closeModal:t}){const{setErrorToast:e,setSuccessToast:n}=te(),{song:r,setSong:s}=qt(),[i,o]=h.useState(),[l,c]=h.useState(!1);return{songFile:i,song:r,setSongFile:o,isFetching:l,handleSubmit:async()=>{try{if(!i||!r)throw new Error;c(!0);const{fileId:d,url:m}=await rd({file:i,folder:"/songs/"}),p={beat_url:m,beat_file_id:d};await je({collectionName:"Songs",id:r.id,data:p}),r.beat_file_id&&Dt({fileId:r.beat_file_id}),s(()=>({...r,...p})),n("Upload song beat successful"),t()}catch(d){console.log({error:d}),e()}finally{c(!1)}}}}function cG({closeModal:t}){const e=h.useRef(null),{songFile:n,setSongFile:r,isFetching:s,handleSubmit:i,song:o}=lG({closeModal:t}),l=c=>{var u;(u=c.target.files)!=null&&u.length&&r(c.target.files[0])};return a.jsxs(ve,{className:"w-[500px]",children:[a.jsx(Be,{title:"Song beat",closeModal:t}),a.jsx("label",{ref:e,className:"hidden",htmlFor:"song_upload"}),a.jsx("input",{onChange:l,type:"file",multiple:!0,accept:"audio",id:"song_upload",className:"hidden"}),o&&(n||(o==null?void 0:o.beat_url))&&a.jsx("audio",{src:n?URL.createObjectURL(n):o.beat_url,controls:!0}),a.jsx("p",{className:"mt-3",children:a.jsx(se,{onClick:()=>{var c;return(c=e.current)==null?void 0:c.click()},color:"primary",children:a.jsx(fv,{className:"w-5"})})}),a.jsx(se,{disabled:!n,onClick:i,isLoading:s,color:"primary",className:"mt-3 ml-auto font-playwriteCU",children:"Save"})]})}const uG=40;function dG({closeModal:t}){const{baseLyric:e,setBaseLyric:n,baseLyricArr:r,setIsChanged:s,lyrics:i}=qt(),[o,l]=h.useState(e),c=h.useRef(null),u=h.useRef(null),d=()=>{const p=o.split(/\r?\n/).filter(g=>g).filter(g=>g.trim()).join(`\r
`);n(p),s(!0),t()};function m(p){const g=[...r];return g[p]=`<div style="color: transparent; border-radius: 4px; background-color: var(--a-10-cl);">${g[p]}</div>`,g.join(`\r
`)}return h.useEffect(()=>{if(i.length&&c.current&&u.current){const p=uG*(i.length-1);c.current.scrollTop=p,u.current.style.paddingBottom=p+"px"}},[]),h.useEffect(()=>{const p=()=>{if(c.current&&u.current){const g=c.current.scrollTop;u.current.scrollTop=g}};return c.current&&c.current.addEventListener("scroll",p),()=>{c.current&&c.current.removeEventListener("scroll",p)}},[]),a.jsxs(ve,{className:"w-[500px]",children:[a.jsx(Be,{closeModal:t,title:"Edit lyric"}),a.jsxs("div",{className:`relative h-[60vh] overflow-hidden rounded-md ${location.hash.includes("/dashboard")?"bg-black/10":"bg-white/10"} `,children:[a.jsx("div",{ref:u,className:"whitespace-break-spaces text-transparent px-2 py-2 absolute leading-[40px] h-full overflow-auto top-0 left-0 w-full",dangerouslySetInnerHTML:{__html:m(i.length===r.length?i.length-1:i.length)}}),a.jsx("textarea",{style:{resize:"none"},ref:c,className:"absolute bg-transparent top-0 outline-none w-full leading-[40px] py-2 px-3 h-full no-scrollbar",value:o,onChange:p=>l(p.target.value)})]}),a.jsx("p",{className:"ml-auto mt-5",children:a.jsx(se,{onClick:d,color:"primary",className:"rounded-full",children:"Save"})})]})}function k2(t){const[e,n,r]=t.split(":"),[s,i]=r.split(",");return+n*60+ +s+ +i/1e3}function hG(t){const e=t.split(`
`),n=[];let r={start:0,end:0,text:"",cut:[],tune:{start:0,end:0,grow:[]}};for(let s=0;s<e.length;s++){const i=e[s].trim();if(!i){if(!r.text)continue;const o=r.text.trim(),l=o.split(" "),c=l.map(()=>[]),u=l.map(()=>0),d={text:o,tune:{start:r.start,end:r.end,grow:u},cut:c};Object.assign(r,d),n.push({...r}),r.text=""}if(isNaN(+i))if(i.includes("-->")){const[o,l]=i.split("-->").map(d=>d.trim()),c=k2(o),u=k2(l);if(isNaN(c)||isNaN(u))throw new Error(`Error at '${s}'`);Object.assign(r,{start:c,end:u})}else r.text+=i.trim()+" "}return n}function fG(){const{setErrorToast:t}=te(),{setLyrics:e,setIsChanged:n,setViewMode:r}=qt();return{handleInputChange:i=>{if(!i.target.files)return;const o=i.target.files[0],l=["json","srt"],c=o.name.split(".")[o.name.split(".").length-1],u=new FileReader;u.onload=d=>{var m,p;try{if(!((m=d.target)!=null&&m.result)||typeof d.target.result!="string")return;if(c==="json"){const g=JSON.parse(((p=d.target)==null?void 0:p.result)||"[]");e(g)}else{const g=hG(d.target.result);e(g)}n(!0),r("import")}catch(g){console.log(g),t(g.message||"")}finally{i.target.value=""}},l.includes(c)?u.readAsText(o):(t("File not supported"),i.target.value="")}}}function mG(){const{lyrics:t,song:e}=qt(),n=(s,i)=>{if(!e)return;const o=new Blob([s],{type:"application/json"}),l=URL.createObjectURL(o),c=document.createElement("a");c.href=l,c.download=`lyric_${bn(e.name)}.${i}`,c.click(),URL.revokeObjectURL(l)};return{exportLyric:({type:s})=>{switch(s){case"json":n(JSON.stringify(t,null,2),"json");break;case"srt":{let i="";const o=l=>{const c=Math.floor(l/60),u=Math.floor(l%60),d=`${c.toString().padStart(2,"0")}:${u.toString().padStart(2,"0")}`,[m,p="0"]=l.toString().split(".");return`00:${d},${+p*100}`};t.forEach((l,c)=>{i+=`${c+1}
${o(l.start)} --> ${o(l.end)}
${l.text}

`}),n(i,"srt");break}}}}}function xN({closeModal:t}){const{lyrics:e,setLyrics:n,setIsChanged:r,song:s}=qt(),{setErrorToast:i}=te(),o=h.useRef(null),l=c=>{var m;if(c.preventDefault(),!s)return;const u=+(((m=o.current)==null?void 0:m.value)||"");if(!u)return;const d=+It()["edit_current-lyric-index"];if(!isNaN(d)){const p=[...e];if(u<0&&e[d].start+u<(d>0?e[d-1].start:0)){i("Invalid number");return}p.forEach((g,x)=>{if(x>=d){const w={start:+(p[x].start+u).toFixed(1),end:+(p[x].end+u).toFixed(1)};p[x]={...p[x],...w,tune:{...p[x].tune,...w}}}}),d>0&&(p[d-1].end=p[d].start,p[d-1].tune.end=p[d].start),p[e.length-1].end=s.duration,p[e.length-1].tune.end=s.duration,n(p),r(!0),t()}};return h.useEffect(()=>{var c;(c=o.current)==null||c.focus()},[]),a.jsxs(ve,{children:[a.jsx(Be,{title:"Sync lyric",closeModal:t}),a.jsxs("form",{action:"",onSubmit:l,children:[a.jsx(_n,{step:.2,ref:o,type:"number"}),a.jsx("p",{className:"mt-5 text-right",children:a.jsx(q,{type:"submit",children:"Save"})})]})]})}function pG({pause:t}){const{song:e,lyrics:n}=qt(),[r,s]=h.useState(""),i=h.useRef(null),{handleInputChange:o}=fG(),{exportLyric:l}=mG(),c=m=>{var p;t(),s(m),(p=i.current)==null||p.open()},u=()=>{var m;return(m=i.current)==null?void 0:m.close()},d=()=>{if(r)switch(r){case"lyric":return a.jsx(dG,{closeModal:u});case"song-beat":return e&&a.jsx(cG,{closeModal:u});case"export":return a.jsxs(ve,{children:[a.jsx(Be,{title:"Export",closeModal:u}),a.jsxs("div",{className:"flex ",children:[a.jsx(se,{color:"primary",onClick:()=>l({type:"json"}),children:"JSON"}),a.jsx(se,{color:"primary",onClick:()=>l({type:"srt"}),className:"ml-2",children:"SRT"})]})]});case"sync":return a.jsx(xN,{closeModal:u})}};return a.jsxs(a.Fragment,{children:[a.jsx("input",{id:"import_lyric",onChange:o,type:"file",className:"hidden"}),a.jsxs(Ln,{appendOnPortal:!0,children:[a.jsx(On,{children:a.jsx(se,{size:"clear",color:"primary",className:"h-[36px] w-[36px] justify-center rounded-full mt-2",children:a.jsx(ao,{className:"w-6"})})}),a.jsx($n,{origin:"top right",children:a.jsx(er,{className:"w-[220px]",children:a.jsxs(Or,{children:[a.jsxs("button",{disabled:!n.length,onClick:()=>c("sync"),children:[a.jsx(Ie,{}),a.jsx("span",{children:"Sync lyric"})]}),a.jsxs("button",{onClick:()=>c("lyric"),children:[a.jsx(Dr,{}),a.jsx("span",{children:"Edit lyric"})]}),!(e!=null&&e.is_official)&&a.jsxs("button",{onClick:()=>c("search"),children:[a.jsx(Lu,{}),a.jsx("span",{children:"Search lyric"})]}),a.jsxs("button",{onClick:()=>c("song-beat"),children:[a.jsx(la,{}),a.jsx("span",{children:"Song beat"})]}),a.jsx("button",{className:"!p-0",children:a.jsxs("label",{className:"flex w-full px-3 py-2 cursor-pointer items-center space-x-2",htmlFor:"import_lyric",children:[a.jsx(Fu,{}),a.jsx("span",{children:"Import (JSON or SRT)"})]})}),a.jsxs("button",{disabled:!n.length,onClick:()=>c("export"),children:[a.jsx(eF,{}),a.jsx("span",{children:"Export"})]})]})})})]}),a.jsx(re,{variant:"animation",ref:i,children:d()})]})}function gG({audioEle:t},e){const{lyrics:n,viewMode:r,setViewMode:s}=qt(),i=h.useRef(null),{backward:o,forward:l,handlePlayPause:c,currentTimeRef:u,durationRef:d,progressLineRef:m,pause:p,seek:g,status:x,isClickPlay:w}=Jm({audioEle:t}),{addLyric:v,removeLyric:S,isEnableAddBtn:_,submit:E}=oG({audioEle:t,isClickPlay:w});h.useImperativeHandle(e,()=>({seek:g,pause:p,submit:E}));const I=()=>{if(!w&&n.length){const F=n[n.length-1].end;t.currentTime=F}c()},N=()=>{switch(x){case"error":return a.jsx(vm,{className:"w-6"});case"playing":return a.jsx(yv,{className:"w-6"});case"paused":return a.jsx(hf,{className:"w-6"});case"waiting":return a.jsx(Ie,{className:"w-6 animate-spin"})}};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-start flex-wrap -mt-2 -ml-2 [&_svg]:w-6 [&_button]:outline-none [&_button]:ml-2 [&_button]:mt-2",children:[a.jsx(qR,{className:"mt-2 ml-2",audioEle:t,postLocalStorageKey:"edit_lyric"}),a.jsx(se,{color:"primary",onClick:I,children:N()}),r==="edit"&&a.jsxs(a.Fragment,{children:[a.jsxs(se,{disabled:!_,onClick:v,color:"primary",children:[a.jsx(Nt,{}),a.jsx("span",{children:"Add"})]}),a.jsxs(se,{disabled:!n.length,onClick:S,color:"primary",children:[a.jsx(xv,{}),a.jsx("span",{children:"Remove"})]}),a.jsxs(se,{onClick:()=>o(2),color:"primary",children:[a.jsx(qk,{}),a.jsx("span",{children:"2s"})]}),a.jsxs(se,{onClick:()=>l(2),color:"primary",children:[a.jsx("span",{children:"2s"}),a.jsx(Yk,{})]})]}),r!=="import"&&a.jsxs(se,{disabled:!n.length,onClick:()=>{s(r==="edit"?"preview":"edit"),p()},color:"primary",children:[a.jsx(VF,{}),a.jsx("span",{children:r==="preview"?"Preview":"Edit"})]}),r==="import"&&a.jsx(a.Fragment,{children:a.jsxs(se,{color:"primary",onClick:()=>{var F;return(F=i.current)==null?void 0:F.open()},children:[a.jsx(Ie,{}),a.jsx("span",{children:"Sync lyric"})]})}),a.jsx("div",{className:"ml-auto",children:a.jsx(pG,{pause:p})})]}),a.jsxs("div",{className:"flex items-center mt-3",children:[a.jsx("div",{className:"text-sm w-[50px]",ref:u,children:"00:00"}),a.jsx("div",{ref:m,style:{backgroundColor:"var(--a-5-cl)"},className:"h-1 rounded-full w-full progress-line"}),a.jsx("div",{className:"text-sm w-[50px] text-right",ref:d,children:"00:00"})]}),a.jsx(re,{variant:"animation",ref:i,children:a.jsx(xN,{closeModal:()=>{var F;return(F=i.current)==null?void 0:F.close()}})})]})}const xG=h.forwardRef(gG);function yG({lyric:t,openModal:e,seek:n,isLast:r,status:s,viewMode:i,removeLyric:o},l){const c=()=>{switch(s){case"active":return"text-[--primary-cl] dark:text-[#ffed00] active-lyric";default:return""}};return a.jsx(a.Fragment,{children:a.jsxs("div",{className:"pt-[10px] last:mb-[30vh]",children:[a.jsxs("div",{className:`flex ${i!=="edit"?"justify-center":""}  space-x-1.5 mb-[3px]`,children:[a.jsx("button",{className:"hover:underline item-info",onClick:()=>n(t.start),children:xs(+t.start)}),a.jsx("button",{onClick:e,className:"",children:a.jsx(Sz,{className:"w-5"})}),i==="import"&&a.jsx(a.Fragment,{children:a.jsx("button",{onClick:o,className:"",children:a.jsx(ut,{className:"w-5"})})})]}),a.jsx("p",{ref:l,className:`font-[700] select-none relative ${c()}`,children:t.text}),r&&t.end!==t.start&&a.jsx("button",{className:"hover:underline pt-[10px]",onClick:()=>n(t.end),children:xs(+t.end)})]})})}const vG=h.forwardRef(yG);function wG({text:t,className:e="",status:n,activeColor:r},s){const i=()=>{switch(n){case"coming":return"opacity-[.4]";case"active":return`${r||"text-[#ffed00]"} active-lyric`;case"done":return"opacity-[.4]"}};return a.jsx("p",{ref:s,className:`${e} transition-transform duration-[.3s] origin-left select-none font-[700] ${i()}`,children:t})}const yN=h.forwardRef(wG),Zd=.3;function vN({audioEle:t,lyrics:e,isActive:n}){const[r,s]=h.useState(0),i=h.useRef("instant"),o=h.useRef(0),l=h.useRef([]),c=h.useRef(0),u=()=>{if(l.current[0]===null)return;const m=t.currentTime>o.current?"forward":"backward";o.current=t.currentTime;let p=c.current;switch(m){case"forward":for(;e[p+1]&&e[p+1].start-Zd<o.current+Zd;)p+=1;break;case"backward":for(;e[p-1]&&e[p-1].end-Zd>o.current+Zd;)p-=1;break}p!==c.current&&(Math.abs(p-c.current)>5&&(i.current="instant"),c.current=p,s(p),l.current[p]&&mC(l.current[p],i.current),i.current==="instant"&&(i.current="smooth"))},d=()=>{s(0),c.current=0,o.current=0};return h.useEffect(()=>(n&&u(),()=>{n||d()}),[n]),h.useEffect(()=>{if(!(!n||!e.length))return t.addEventListener("timeupdate",u),()=>{t.removeEventListener("timeupdate",u)}},[e,n]),h.useEffect(()=>()=>{d()},[e]),{currentIndex:r,lyricRefs:l}}function _G(){const{lyrics:t,viewMode:e}=qt(),n=h.useRef(null),r=h.useRef("instant");return h.useEffect(()=>{!n.current||e==="preview"||(mC(n.current,r.current),r.current="instant",r.current==="instant"&&(r.current="smooth"))},[t.length,e]),h.useEffect(()=>()=>{r.current="instant"},[e]),{activeLyricRef:n}}function SG({controlRef:t,audioEle:e,openEditModal:n}){const{baseLyricArr:r,lyrics:s,setLyrics:i,setSelectLyricIndex:o,song:l,viewMode:c}=qt(),{activeLyricRef:u}=_G(),{currentIndex:d,lyricRefs:m}=vN({audioEle:e,isActive:c!=="edit",lyrics:s}),p=w=>{var v;(v=t.current)==null||v.seek(w)},g=w=>{var v;typeof w=="number"&&((v=t.current)==null||v.pause(),o(w),n())},x=w=>{if(!l)return;const v=[...s],S=w===s.length-1;w===0?v[1].start=0:S||(v[w-1].end=v[w+1].start),v.splice(w,1),v[v.length-1].end=l.duration,i(v)};return h.useEffect(()=>{tt("edit_current-lyric-index",d)},[d]),a.jsx(a.Fragment,{children:a.jsxs("div",{className:`flex-grow overflow-auto flex font-[Inter,system-ui] no-scrollbar md:text-lg rounded-xl px-2 pt-3 mt-3 bg-[--popup-cl] shadow-[0_0_6px_0_rgba(0,0,0,0.15)] ${Qi(c!=="edit","justify-center")}`,children:[a.jsx("div",{className:`w-1/2 ${Qi(c!=="edit","hidden")}`,children:r.length?a.jsx(a.Fragment,{children:r.map((w,v)=>{let S=v===s.length?"active":v<s.length?"done":"coming";return S==="done"&&v===r.length-1&&(S="active"),a.jsx(yN,{ref:S==="active"?u:null,className:"pt-[38px]",status:S,text:w},v)})}):a.jsx("p",{children:"..."})}),a.jsx("div",{className:`w-1/2 ${Qi(c!=="edit","text-center")}`,children:!!(s!=null&&s.length)&&l&&s.map((w,v)=>{let S="coming";return c!=="edit"&&(d===v?S="active":v<d&&(S="done")),a.jsx(vG,{ref:_=>m.current[v]=_,openModal:()=>g(v),seek:p,removeLyric:()=>x(v),viewMode:c,lyric:w,status:S,activeColor:"text-[#ffed00]",isLast:v===s.length-1&&v!==r.length-1},v)})})]})})}function bG({audioRef:t}){const{baseLyric:e,setSong:n,song:r,setBaseLyricArr:s,setBaseLyric:i,setLyrics:o,isChanged:l,isFetching:c,start:u}=qt(),[d,m]=h.useState(!0),p=h.useRef(!1),g=li(),x=v=>{if(!v.length)return;const S=v.length-1;if(t.current){const _=v[S].end;u.current=_}},w=async()=>{try{if(!g.id)throw new Error("");const v=await Gt({collectionName:"Songs",id:g.id});if(!v.exists())throw new Error("");const S={...v.data(),id:v.id,queue_id:""};if(S.lyric_id){const _=await Gt({collectionName:"Lyrics",id:S.lyric_id});if(_.exists()){const{base:E,lyrics:I}=_.data(),N=JSON.parse(I);i(E),o(N),x(N)}}n(S)}catch(v){console.log({message:v})}finally{m(!1)}};return h.useEffect(()=>{p.current||(p.current=!0,r?m(!1):w())},[]),h.useEffect(()=>{if(!e)return;const v=e.split(/\r?\n/);s(v)},[e]),h.useEffect(()=>{if(!l)return;const v=S=>{S.preventDefault()};return window.addEventListener("beforeunload",v),()=>{window.removeEventListener("beforeunload",v)}},[l]),{isFetching:d,song:r,isChanged:l,isSubmitting:c}}function wN(t,e){if(e.length===1&&e[0]===0)return[t];const n=[];let r=0;e.sort((s,i)=>s-i);for(const s of e)s>t.length||s<0||(n.push(t.substring(r,s)),r=s);return n.push(t.substring(r)),n}const EG=["Edit","Record"];function jG(){const[t,e]=h.useState(0),[n,r]=h.useState(),[s,i]=h.useState(""),[o,l]=h.useState([[]]),[c,u]=h.useState([]),[d,m]=h.useState(!1),[p,g]=h.useState("Edit"),[x,w]=h.useState("paused"),v=h.useRef(null),S=h.useRef(null),_=h.useRef(null),E=h.useRef(null),I=h.useRef(null),N=h.useRef(null),F=h.useRef(null),k=h.useRef(null),j=h.useRef(),C=h.useRef(!1),R=h.useRef(0),A=h.useRef(0),M=h.useRef(0),P=h.useRef([]),we=h.useRef([]),ne=h.useRef(!0),he=h.useRef(!1),ge=h.useMemo(()=>s.split(" ").filter(ee=>ee.trim()),[s]),H=h.useMemo(()=>ge.map((ee,be)=>({text:ee,positions:o[be]})),[s,o]),K=h.useMemo(()=>{const ee=[];return H.forEach(be=>{const Re=wN(be.text,be.positions);ee.push(...Re)}),ee.filter(be=>be)},[s,o]);return{eleRefs:{endTimeRangeRef:S,overlayRef:v,startTimeRangeRef:_,startRefText:E,endRefText:I,currentWordRef:N,growInputRef:F,tempWordRef:k},tabProps:{tab:p,setTab:g,tabs:EG},eventRefs:{playWhenSpaceRef:ne,moveArrowToGrowRef:he},currentWords:ge,currentWordsData:H,currentSplitWords:K,actuallyEndRef:R,playerRef:j,actuallyStartRef:A,tempActuallyStartRef:M,wordsRatioRef:P,mergedGrowListRef:we,isChangedRef:C,wordIndex:t,setWordIndex:e,growList:c,setGrowList:u,isOpenEditLyricModal:d,SetIsOpenEditLyricModal:m,setStatus:w,status:x,text:s,setText:i,cut:o,setCut:l,localLyricIndex:n,setLoacalLyricIndex:r}}const _N=h.createContext(null);function kG({children:t}){return a.jsx(_N.Provider,{value:jG(),children:t})}const Kt=()=>{const t=h.useContext(_N);if(!t)throw new Error("LyricEditorProvider not found");return t};function SN(t,e){const n=`lyric_${fo(4)}`,r=document.querySelector("style.keyframe");if(!r)return n;let s=`@keyframes ${n}{0%{width:0%}`;if(t.findIndex(d=>!d)!==-1)return s+="100%{width:100%}}",r.innerText=s,n;let o=t.reduce((d,m)=>d+m,0);const l=[];let c=0,u=0;for(let d=0;d<e.length-1;d++){const m=e[d],p=t[d];u+=m,c+=p,l.push({progress:Math.round(c/o*100),width:u})}for(const d of l)s+=`${d.progress}%{width:${d.width}%}`;return s+="100%{width:100%}}",r.innerText=s,n}function TG({audioEle:t}){const{eleRefs:e,actuallyEndRef:n,actuallyStartRef:r,tempActuallyStartRef:s,wordsRatioRef:i,mergedGrowListRef:o,status:l,setStatus:c}=Kt(),{play:u,pause:d,statusRef:m}=Jm({audioEle:t,statusFromParent:l,setStatusFromParent:c}),{overlayRef:p}=e,g=()=>{d(),p.current&&(p.current.style.animation="none")},x=()=>{if(t.currentTime=r.current,!s.current&&p.current){const S=SN(o.current,i.current);p.current.style.animation=`${S} ${((n.current-r.current)/t.playbackRate).toFixed(2)}s linear`}u()},w=()=>{m.current==="paused"?x():g()},v=()=>{if(+t.currentTime.toFixed(1)>=n.current)return g()};return h.useEffect(()=>{if(t)return t.addEventListener("timeupdate",v),()=>{t.removeEventListener("timeupdate",v)}},[]),{handlePlayPause:w,_pause:g,_play:x,status:l}}function IG({audioEle:t}){const{playerRef:e}=Kt(),{_play:n,_pause:r,handlePlayPause:s}=TG({audioEle:t});return h.useEffect(()=>{e.current={handlePlayPause:s,pause:r,play:n}},[]),a.jsx(a.Fragment,{})}function CG(){const{status:t,playerRef:e}=Kt();return a.jsx(se,{size:"clear",className:"p-1.5",onClick:()=>{var n;return(n=e.current)==null?void 0:n.handlePlayPause()},color:"primary",children:t==="playing"?a.jsx(Ju,{className:"w-6"}):a.jsx(qa,{className:"w-6"})})}function RG({audioEle:t}){const{tabProps:e}=Kt();return a.jsxs(a.Fragment,{children:[a.jsx(IG,{audioEle:t}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(tr,{...e,render:n=>n}),a.jsxs("div",{className:"flex space-x-2",children:[a.jsx(CG,{}),a.jsx(qR,{positions:"left",audioEle:t,postLocalStorageKey:"edit_lyric_tune"})]})]})]})}function NG(){const{updateLyric:t,setIsChanged:e,selectLyricIndex:n}=qt(),{actuallyEndRef:r,actuallyStartRef:s,growList:i,text:o,cut:l}=Kt();return{updateLyricTune:async()=>{if(typeof n!="number")throw new Error("selectLyricIndex is undefine");const u={tune:{start:s.current,end:r.current,grow:i},cut:l,text:o};t(n,u),e(!0)}}}function AG({closeModal:t}){const{setSelectLyricIndex:e,selectLyricIndex:n,lyrics:r}=qt(),{isChangedRef:s,playerRef:i}=Kt(),{updateLyricTune:o}=NG(),l=()=>{o(),t()},c=u=>{var d;if(typeof n=="number")switch(s.current&&(s.current=!1,o()),(d=i.current)==null||d.pause(),u){case"next":if(n===r.length-1)return;e(m=>m+1);break;case"prev":if(n===0)return;e(m=>m-1);break}};return a.jsxs("div",{className:"flex justify-end space-x-2 mt-5 ",children:[a.jsxs(se,{color:"primary",disabled:n===0,onClick:()=>c("prev"),children:[a.jsx(dv,{className:"w-6"}),a.jsx("span",{className:"hidden md:block",children:"Previous"})]}),a.jsxs(se,{color:"primary",disabled:n===r.length-1,onClick:()=>c("next"),children:[a.jsx("span",{className:"hidden md:block",children:"Next"}),a.jsx(Gk,{className:"w-6"})]}),a.jsxs(se,{disabled:!s.current,color:"primary",onClick:l,children:[a.jsx(oa,{className:"w-6"}),a.jsx("span",{children:"Ok"})]})]})}function PG(){const{isOpenEditLyricModal:t,playerRef:e,eleRefs:{currentWordRef:n},eventRefs:r}=Kt(),s=o=>{var l;if(o.key===" "){if(!r.playWhenSpaceRef.current)return;o.preventDefault(),console.log("handle play pause"),(l=e.current)==null||l.handlePlayPause()}if(o.key==="ArrowRight"||o.key==="ArrowLeft"){if(!r.moveArrowToGrowRef.current)return;const c=n.current;if(!c)return;switch(o.key){case"ArrowRight":o.preventDefault(),c!=null&&c.nextSibling&&(c==null?void 0:c.nextSibling).click();break;case"ArrowLeft":o.preventDefault(),c!=null&&c.previousSibling&&(c==null?void 0:c.previousSibling).click();break}}},i=o=>{if(!r.moveArrowToGrowRef.current)return;const l=o.target,c=document.querySelectorAll(".word-item");let u=!1;c.forEach(d=>d.contains(l)?u=!0:{}),!u&&(r.moveArrowToGrowRef.current=!1)};h.useEffect(()=>(window.addEventListener("mousedown",i),window.addEventListener("keydown",s),()=>{window.removeEventListener("mousedown",i),window.removeEventListener("keydown",s)}),[t])}const bN=t=>{const e=t.clientWidth,n=[];return t.childNodes.forEach(r=>{n.push(Math.round(r.offsetWidth/e*100))}),n};function qw(t,e,n){const r=[];if(!n.length)return[];let s=0;return t.forEach((i,o)=>{const l=e[o].length;if(l===0)r.push(n[s]),s++;else if(l>0){const u=n.slice(s,s+l+1).reduce((d,m)=>(s++,+(d+m).toFixed(1)),0);r.push(u)}}),r}function FG(){const{selectLyricIndex:t,currentLyric:e}=qt(),{eleRefs:n,actuallyEndRef:r,mergedGrowListRef:s,actuallyStartRef:i,wordsRatioRef:o,setGrowList:l,setCut:c,setText:u,currentWords:d}=Kt(),{tempWordRef:m,endTimeRangeRef:p,startTimeRangeRef:g,startRefText:x,endRefText:w}=n;h.useEffect(()=>{if(!m.current)return;const v=bN(m.current);o.current=v},[d]),h.useEffect(()=>{if(!e)return;const v=e.tune.grow,S=e.text.split(" ").filter(E=>E.trim());u(e.text),c(e.cut);const _=qw(S,e.cut,v);l(v),s.current=_,w.current&&x.current&&g.current&&p.current&&(i.current=e!=null&&e.tune?e.tune.start:e.start,x.current.innerText=`${xs(e.start)} / ${xs(i.current)}`,g.current.max=e.end+"",g.current.value=i.current+"",r.current=e!=null&&e.tune?e.tune.end:e.end,w.current.innerText=`${xs(r.current)} / ${xs(e.end)}`,p.current.max=e.end+"",p.current.value=r.current+"")},[t])}function MG({audioEle:t}){const{playerRef:e,isChangedRef:n,tabProps:{tab:r,setTab:s},setGrowList:i,cut:o,actuallyStartRef:l,mergedGrowListRef:c,currentSplitWords:u,currentWords:d}=Kt(),[m,p]=h.useState(!1),[g,x]=h.useState([]),w=h.useRef(Date.now()),v=h.useRef(!1),S=h.useRef(!1),_=()=>{const M=+(t.currentTime-w.current).toFixed(2);x(P=>[...P,M])},E=()=>{var M;w.current=t.currentTime,v.current||(v.current=!0,(M=e.current)==null||M.play(),p(!0))},I=()=>{v.current&&_()},N=M=>{M.key===" "&&(S.current||(M.preventDefault(),S.current=!0,E()))},F=M=>{M.key===" "&&(M.preventDefault(),I(),S.current=!1)},C={onPointerDown:()=>{E()},onPointerUp:()=>{I()}},R=()=>{var M;(M=e.current)==null||M.pause(),v.current=!1,x([]),p(!1)},A=()=>{n.current=!0,i(g);const M=qw(d,o,g);c.current=M,s("Edit"),R()};return h.useEffect(()=>{g.length===u.length&&A()},[g]),h.useEffect(()=>{var M;if(r==="Record")return(M=e.current)==null||M.pause(),window.addEventListener("keydown",N),window.addEventListener("keyup",F),t.currentTime=l.current,()=>{var P;(P=e.current)==null||P.pause(),window.removeEventListener("keydown",N),window.removeEventListener("keyup",F)}},[r]),{localGrowList:g,buttonProps:C,clear:R,isRecording:m}}function DG({audioEle:t}){const{currentSplitWords:e}=Kt(),{buttonProps:n,localGrowList:r,isRecording:s,clear:i}=MG({audioEle:t});return a.jsxs(a.Fragment,{children:[a.jsx(se,{disabled:!s,size:"clear",className:"p-1.5",onClick:i,color:"primary",children:a.jsx(oo,{className:"w-6"})}),a.jsxs("div",{className:"flex-grow flex flex-col justify-center",children:[a.jsx("div",{className:"md:text-xl font-[700] text-center",children:e.map((o,l)=>a.jsxs("span",{className:`${l<r.length?"text-[--primary-cl]":""} leading-[1]`,children:[o," "]},l))}),a.jsx("p",{className:"mt-5 text-center md:hidden",children:a.jsx(se,{...n,color:"primary",children:"Record"})})]})]})}function LG(){const{currentLyric:t}=qt(),{eleRefs:e,isChangedRef:n,actuallyEndRef:r,actuallyStartRef:s,tempActuallyStartRef:i,setGrowList:o}=Kt(),{startRefText:l,endRefText:c}=e;return{setEndPoint:g=>{if(!t)return;const x=+g.toFixed(1);n.current=!0,r.current=x,c.current&&(c.current.textContent=`${xs(x)} / ${xs(t.end)}`),i.current&&(r.current=x,s.current=x-1)},setStartPoint:g=>{if(!t)return;const x=+g.toFixed(1);n.current=!0,s.current=x,l.current&&(l.current.textContent=`${xs(t.start)} / ${xs(x)}`)},endTimeRangeProps:{onFocus:()=>{i.current=s.current,s.current=r.current-1},onBlur:()=>{s.current=i.current,i.current=0}},handleGrowWord:g=>{n.current=!0,o(x=>{const w=[...x];let v=w[g.index];switch(g.variant){case"range":v=g.value;break;case"button":v=+(g.action==="minus"?v-.1:v+.1).toFixed(1)}return v<0&&(v=0),w[g.index]=v,w})}}}function OG(){const{setStartPoint:t,setEndPoint:e,endTimeRangeProps:n,handleGrowWord:r}=LG(),{currentLyric:s}=qt(),{wordIndex:i,growList:o,eleRefs:l}=Kt();return s?a.jsxs("div",{className:"[&>div]:flex [&>div]:space-x-2 space-y-3 [&_label]:w-[160px] [&_label]:flex-shrink-0",children:[a.jsxs("div",{children:[a.jsxs(Lt,{htmlFor:"start",children:["Start: ",a.jsx("span",{ref:l.startRefText})]}),a.jsx("input",{ref:l.startTimeRangeRef,type:"range",id:"start",min:s.start,max:s.end,step:.2,className:"w-full",onChange:c=>t(+c.target.value)})]}),a.jsxs("div",{children:[a.jsxs(Lt,{htmlFor:"end",children:["End: ",a.jsx("span",{ref:l.endRefText})]}),a.jsx("input",{id:"end",ref:l.endTimeRangeRef,type:"range",min:s.start,step:.2,className:"w-full",onChange:c=>e(+c.target.value),...n})]}),a.jsxs("div",{children:[a.jsxs(Lt,{htmlFor:"grow",children:["Grow: ",o[i]]}),a.jsx("input",{ref:l.growInputRef,type:"range",id:"grow",min:0,max:10,step:.1,className:"w-full",value:o[i]+"",onChange:c=>r({variant:"range",value:+c.target.value,index:i})})]})]}):a.jsx(a.Fragment,{})}function $G(){const{eleRefs:t,eventRefs:e,setText:n,mergedGrowListRef:r,setCut:s,setGrowList:i,text:o,isChangedRef:l}=Kt(),[c,u]=h.useState(!1),d=h.useRef(null),m=()=>{if(!d.current)return;const p=d.current.value.split(/\r?\n/).filter(w=>w).map(w=>w.trim()).join(" ").split(" ").filter(w=>w).join(" ");n(p);const g=p.split(" ").map(()=>0),x=p.split(" ").map(()=>[]);s(x),i(g),r.current=g,u(!1),l.current=!0};return h.useEffect(()=>{c?(e.playWhenSpaceRef.current=!1,e.moveArrowToGrowRef.current=!1,d.current&&(d.current.value=o)):(e.playWhenSpaceRef.current=!0,e.moveArrowToGrowRef.current=!0)},[c]),a.jsxs("div",{className:"mt-3 relative pt-5 font-[Inter,system-ui]",children:[a.jsx("div",{className:"absolute top-0 right-0 flex justify-end w space-x-2 hover:[&>button]:bg-black/10 [&>button]:rounded-full [&>button]:p-1",children:c?a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>u(!1),children:a.jsx(oo,{className:"w-5"})}),a.jsx("button",{onClick:m,children:a.jsx(oa,{className:"w-5"})})]}):a.jsx("button",{onClick:()=>u(!0),children:a.jsx(Dr,{className:"w-5"})})}),a.jsx("div",{className:"flex justify-center",children:c?a.jsx("textarea",{ref:d,rows:1,className:`${dl} w-full mt-3 bg-[--a-5-cl]`}):a.jsx(a.Fragment,{children:a.jsxs("div",{className:"relative whitespace-nowrap  sm:text-2xl font-[700]",children:[o,a.jsx("div",{ref:t.overlayRef,className:"absolute  top-0 left-0 overflow-hidden text-[--primary-cl] whitespace-nowrap w-0",children:o})]})})})]})}function zG({text:t,openModal:e,isShowScissor:n,index:r}){const{growList:s,setWordIndex:i,wordIndex:o,eventRefs:l,eleRefs:c}=Kt(),u=o===r,d=()=>{var m;r!==-1&&(i(r),l.moveArrowToGrowRef.current=!0,(m=c.growInputRef.current)==null||m.focus())};return a.jsxs("div",{ref:m=>u?c.currentWordRef.current=m:{},style:{flexGrow:s[r]!==0?s[r]:.05},onClick:d,className:`word-item cursor-pointer relative rounded-full flex items-center justify-center 
      ${u?"bg-[--primary-cl] text-white":"bg-[--a-5-cl]"}`,children:[a.jsx("span",{children:t}),n&&u&&a.jsx(se,{onClick:e,size:"clear",className:"!absolute bottom-0 translate-y-[16px] bg-[--popup-cl] text-[--text-cl] shadow-[0_0_6px__rgba(0,0,0,0.3)] p-1.5",children:a.jsx(nT,{className:"w-5"})})]})}function BG({wordData:t,wordIndex:e,closeModal:n}){const{currentLyric:r,selectLyricIndex:s}=qt(),{setCut:i,cut:o}=Kt(),[l,c]=h.useState(t.positions),u=h.useMemo(()=>wN(t.text,l).filter(g=>g),[l]),d=h.useMemo(()=>t.text.split(""),[]),m=g=>{const x=[...l],w=l.findIndex(v=>v===g);w===-1?x.push(g):x.splice(w,1),c(x)},p=()=>{if(!r||s===void 0)return;const g=l.sort((w,v)=>w-v),x=[...o];x[e]=g,i(x),n()};return a.jsxs(ve,{className:"w-[500px]",children:[a.jsx(Z,{title:"Split word "}),a.jsx("div",{className:"flex justify-center space-x-5",children:u.map((g,x)=>a.jsx("span",{className:"text-xl md:text-2xl font-[700]",children:g},x))}),a.jsx("div",{className:"mt-3 flex justify-center",children:d.map((g,x)=>{const w=l.includes(x);return a.jsxs("div",{children:[d.length>1&&x?a.jsx("button",{onClick:()=>m(x),className:` p-1 rounded-full ${w?"bg-[--primary-cl] text-white":"hover:bg-black/10"}`,children:a.jsx(nT,{className:"w-5"})}):"",a.jsx("span",{className:"text-[50px] font-[500]",children:g})]},x)})}),a.jsx("p",{className:"mt-5 text-right",children:a.jsx(se,{onClick:p,color:"primary",className:"font-playwireCU",children:"OK"})})]})}function VG(){const{currentSplitWords:t,currentWordsData:e,currentWords:n}=Kt(),[r,s]=h.useState(),i=h.useRef(null),o=h.useMemo(()=>{const u={},d=e.map(p=>p.positions.length);let m=0;return d.forEach((p,g)=>{p===0?(u[m]=g,m++):p>0&&[...Array(p+1).keys()].forEach(()=>{u[m]=g,m++})}),u},[e]),l=h.useMemo(()=>r!==void 0?e[r]:void 0,[r,e]),c=u=>{var d;s(u),(d=i.current)==null||d.open()};return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"flex justify-center h-[36px] mt-5",children:t.map((u,d)=>{const m=o[d],p=n[m];return a.jsx(zG,{isShowScissor:p?p.length>1:!1,index:d,openModal:()=>c(m),text:u},d)})}),a.jsx(re,{variant:"animation",ref:i,children:l&&r!==void 0&&a.jsx(BG,{wordIndex:r,closeModal:()=>{var u;return(u=i.current)==null?void 0:u.close()},wordData:l})})]})}function UG(){const{eventRefs:t,tabProps:{tab:e}}=Kt();h.useEffect(()=>{switch(e){case"Edit":t.playWhenSpaceRef.current=!0,t.moveArrowToGrowRef.current=!0;break;case"Record":t.playWhenSpaceRef.current=!1,t.moveArrowToGrowRef.current=!1;break}},[e])}function HG({closeModal:t}){const{song:e}=qt(),{eleRefs:n,currentWords:r,tabProps:s}=Kt();PG(),FG(),UG();const i=h.useRef(null);return a.jsx(a.Fragment,{children:a.jsxs(ve,{className:"w-[800px] overflow-auto",children:[a.jsx(Be,{title:"Edit lyric",closeModal:t}),a.jsx("audio",{src:e==null?void 0:e.song_url,ref:i}),a.jsx("div",{ref:n.tempWordRef,className:"absolute inline-block opacity-0",children:r.map((o,l)=>a.jsx("span",{children:o},l))}),i.current&&a.jsx(RG,{audioEle:i.current}),a.jsxs("div",{className:"mt-5",children:[i.current&&a.jsx("div",{className:`${s.tab==="Record"?"block":"hidden"}`,children:a.jsx(DG,{audioEle:i.current})}),a.jsxs("div",{className:`${s.tab==="Edit"?"block":"hidden"}`,children:[a.jsx(OG,{}),a.jsx($G,{}),a.jsx(VG,{})]})]}),a.jsx(AG,{closeModal:t})]})})}function GG(t){return a.jsx(kG,{children:a.jsx(HG,{...t})})}const xs=t=>{const e=Math.floor(t/60),n=Math.floor(t%60),[r,s="0"]=t.toString().split(".");return`${e}:${n.toString().padStart(2,"0")},${s}`};function WG({children:t}){const[e,n]=h.useState(""),r=h.useRef(null),s=h.useRef(null),i=h.useRef(null),{isFetching:o,isChanged:l,song:c,isSubmitting:u}=bG({audioRef:s}),d=()=>{var g,x;(g=r.current)==null||g.pause(),(x=r.current)==null||x.submit()},m=g=>{var x;n(g),(x=i.current)==null||x.open()},p=()=>{var g;return(g=i.current)==null?void 0:g.close()};return a.jsxs(a.Fragment,{children:[a.jsx("audio",{className:"hidden",ref:s,src:c==null?void 0:c.song_url}),o?a.jsx(Ve,{children:a.jsx(Ie,{className:"w-6 animate-spin"})}):c&&a.jsxs(a.Fragment,{children:[t,a.jsx(Z,{className:"line-clamp-1 flex-shrink-0",title:`Edit lyric - ${c.name}`}),a.jsx("div",{className:"mt-3",children:s.current&&a.jsxs(a.Fragment,{children:[a.jsx(xG,{audioEle:s.current,ref:r}),a.jsx(re,{persisted:!0,variant:"animation",ref:i,children:e==="edit-lyric"&&a.jsx(GG,{closeModal:p})})]})}),s.current&&a.jsx(SG,{controlRef:r,audioEle:s.current,openEditModal:()=>{m("edit-lyric")}}),a.jsx("p",{className:"mt-5 text-right",children:a.jsx(se,{className:"rounded-full ",color:"primary",disabled:!l,isLoading:u,onClick:d,children:"Save"})})]})]})}function EN(t){return a.jsx(aG,{children:a.jsx(WG,{...t})})}function qG(){return a.jsxs("div",{className:"fixed left-[10px] top-[10px] bottom-[10px] right-[10px] flex flex-col md:right-0 md:top-0 md:left-[unset] md:right-[unset] md:relative md:h-full md:pb-4",children:[a.jsx(pN,{className:"mb-1 self-start"}),a.jsx(EN,{})]})}const KG=["All","Song","Playlist","Singer"],QG={songs:[],playlists:[],singers:[]};function XG(){const[t,e]=h.useState(!1),[n,r]=h.useState("Song"),s=Vk(),[i,o]=h.useState(QG),l=h.useRef(!0),c=h.useRef(!0),u=h.useRef(!0),d=h.useRef(!0),m=g=>{o(x=>({...x,...g}))},p=async()=>{try{const g=s[0].get("q");if(!g)return;switch(e(!0),await xr(500),n){case"All":{if(!l.current)return;l.current=!1;const[x,w,v]=await Promise.all([zt(lr(_t,[X("is_official","==",!0),Mt(6)],g)),Dn(lr(vn,[Mt(3)],g)),bu(lr(Qa,[Mt(3)],g))]);m({playlists:w,songs:x,singers:v});break}case"Song":{if(!c.current)return;c.current=!1;const x=lr(_t,[X("is_official","==",!0)],g),w=await zt(x);m({songs:w});break}case"Playlist":{if(!u.current)return;u.current=!1;const x=lr(vn,[X("is_public","==",!0)],g),w=await Dn(x);m({playlists:w});break}case"Singer":{if(!d.current)return;d.current=!1;const x=lr(Qa,[],g),w=await bu(x);m({singers:w});break}}}catch(g){console.log({message:g})}finally{e(!1)}};return h.useEffect(()=>{p()},[s[0].get("q"),n]),h.useEffect(()=>()=>{r("All"),l.current=!0,c.current=!0,u.current=!0,d.current=!0},[s[0].get("q")]),{isFetching:t,setIsFetching:e,tab:n,setTab:r,getResult:p,result:i,tabs:KG}}function YG(){const[t,e]=h.useState(""),[n,r]=h.useState(!1),[s,i]=h.useState(!1),[o,l]=h.useState([]),[c,u]=h.useState([]),d=h.useRef(null),m=h.useRef(null),p=h.useRef(null),g=h.useRef(!0),x=h.useRef(!0),w=Vk(),v=AR(t,700),S=new AbortController,_=I=>{const N=document.querySelector(".popup-content"),F=I.target,k=document.querySelectorAll(".modal-content");let j=!1;k.forEach(C=>C.contains(F)?j=!0:{}),!(d.current&&m.current&&(d.current.contains(F)||j||m.current.contains(F)||N!=null&&N.contains(F)))&&i(!1)},E=async()=>{try{const I=ue(St(oe,"Trending_Keywords"),Ot("today_count","desc"),Mt(5)),N=await bt(I);if(N.empty)return;const F=N.docs.map(k=>k.id);u(F)}catch{console.log("error")}};return h.useEffect(()=>{console.log(x.current),x.current&&(x.current=!1,E())},[]),h.useEffect(()=>{if(!v.trim()){r(!1),l([]);return}const I=async()=>{try{r(!0);const N=lr(_t,[X("is_official","==",!0)],t),F=await zt(N);l(F)}catch(N){console.log(N)}finally{r(!1)}};return g.current?I():g.current=!0,()=>{console.log("abort"),S.abort()}},[v]),h.useEffect(()=>(s&&document.addEventListener("click",_),()=>{document.removeEventListener("click",_)}),[s]),h.useEffect(()=>(e(w[0].get("q")||""),()=>{var I;g.current=!1,(I=p.current)==null||I.blur(),i(!1)}),[w[0].get("q")]),h.useEffect(()=>{w[0].get("q")!==t&&s&&(g.current=!0)},[t,s]),{isFetching:n,searchResult:o,value:t,setValue:e,isFocus:s,setIsFocus:i,formRef:d,searchResultRef:m,inputRef:p,trendingKeywords:c}}function JG({songs:t}){const{handleSetSong:e}=Sr({variant:"search-bar"}),{getRelatigeSongs:n}=cd(),r=s=>{e(s.queue_id,[s]);const i=It()["recent-search"]||[];i.unshift({variant:"song",item:s}),tt("recent-search",i),n(s)};return a.jsx(jn,{children:t.length?a.jsx(br,{songVariant:"recent-song",isHasCheckBox:!1,setSong:r,songs:t}):a.jsx(Ce,{})})}const ZG={itemContainer:"w-full sm:group/container flex flex-row rounded-md justify-between py-2 px-3 last:border-none hover:bg-white/10"};function eW({item:t}){return a.jsxs(Y,{to:`/${t.variant}/${t.item.id}`,className:`${ZG.itemContainer}`,children:[a.jsx("div",{className:"w-10 h-10",children:a.jsx(Ae,{src:t.item.image_url,blurHashEncode:t.item.blurhash_encode})}),a.jsxs("div",{className:"ml-10",children:[a.jsx("h5",{className:"line-clamp-1 font-medium overflow-hidden text-sm",children:t.item.name}),a.jsx("p",{className:"opacity-[.7] line-clamp-1 text-xs",children:t.variant})]})]})}function tW({item:t}){const{user:e}=pe(),{currentSongData:n}=ce(qe),{handleSetSong:r}=Sr({variant:"search-bar"}),{getRelatigeSongs:s}=cd(),i=l=>{r(l.queue_id,[l]),s(l)},o=()=>{switch(t.variant){case"song":return a.jsx(eN,{isHasCheckBox:!1,isLiked:(e==null?void 0:e.liked_song_ids.includes(t.item.id))||!1,variant:"recent-song",index:0,active:t.item.id===(n==null?void 0:n.song.id),onClick:()=>i(t.item),song:t.item});default:return a.jsx(eW,{item:t})}};return a.jsx(jn,{children:o()})}function nW({words:t,recentSearchs:e}){const n={listWrapper:"[&>*]:px-3 *:text-sm [&>*]:py-2 [&>*]:flex [&>*]:items-center [&>*]:space-x-1 [&>*]:rounded-md "};return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"text-sm font-semibold mb-2",children:"Suggestion keyword"}),a.jsx("div",{className:`${n.listWrapper} hover:[&>*]:bg-[--a-5-cl]`,children:t.map((r,s)=>a.jsxs(Y,{to:`/search?q=${r}`,children:[a.jsx(gm,{className:"w-5"}),a.jsx("span",{className:"text-sm",children:r})]},s))}),a.jsx("div",{className:"text-sm font-semibold my-2",children:"Recent search"}),a.jsx("div",{className:n.listWrapper,children:e.map((r,s)=>a.jsx(tW,{item:r},s))})]})}function jN(){const t=Wt(),{isFetching:e,inputRef:n,formRef:r,searchResultRef:s,value:i,searchResult:o,setIsFocus:l,isFocus:c,setValue:u,trendingKeywords:d}=YG(),m=h.useMemo(()=>It()["recent-search"]||[],[c]),p={container:"relative z-[9] h-[40px] flex px-3 w-full md:w-[300px] shadow-md",unFocusContainer:"bg-[--sidebar-cl] rounded-[20px]",focusedContainer:"bg-[--popup-cl] rounded-[20px_20px_0_0]",input:"bg-transparent outline-none placeholder:[#666] w-full",searchResultContainer:"overflow-auto bg-[--popup-cl] shadow-md  rounded-[0_0_20px_20px] p-3 position absolute top-full left-0 w-full max-h-[60vh] flex flex-col"},g=async x=>{x.preventDefault(),Is({collectionName:"Search_Logs",data:{keyword:bn(i)},msg:"Add search log"}),t(`/search?q=${i}`),l(!1)};return a.jsx(a.Fragment,{children:a.jsxs("form",{ref:r,onSubmit:g,className:`${p.container} ${c?p.focusedContainer:p.unFocusContainer}`,children:[a.jsx("button",{className:"mr-2",children:a.jsx(Lu,{className:"w-6"})}),a.jsx("input",{ref:n,value:i,onFocus:()=>l(!0),onChange:x=>u(x.target.value),placeholder:"...",className:p.input,type:"text"}),a.jsx("button",{type:"button",onClick:()=>u(""),className:`${i?"opacity-100":"!opacity-0"} ${Tf(!i)}`,children:e?a.jsx(Ie,{className:"w-5 animate-spin"}):a.jsx(oo,{className:"w-5"})}),a.jsx("div",{ref:s,className:`${ta(!c)} ${p.searchResultContainer}`,children:o.length?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"text-sm font-semibold mb-2",children:"Suggestion results"}),a.jsx("div",{className:"overflow-auto no-scrollbar",children:a.jsx(JG,{songs:o})})]}):a.jsx(nW,{recentSearchs:m,words:d})})]})})}function rW(){const{isOnMobile:t}=is(),{isFetching:e,setIsFetching:n,result:r,tab:s,setTab:i,tabs:o}=XG(),{handleSetSong:l}=Sr({variant:"search-bar"}),{getRelatigeSongs:c}=cd(),u=p=>{l(p.queue_id,[p]),c(p)},d=p=>s==="All"||s===p?"":"hidden",m=p=>s!=="All"||s==="All"&&!p?"hidden":"mb-3";return a.jsxs(a.Fragment,{children:[a.jsxs(po,{className:"space-y-8",children:[t&&a.jsx(jN,{}),a.jsxs("div",{className:"md:flex items-center",children:[a.jsx(Z,{title:"Result",className:"mt-1 md:mt-0"}),a.jsx(tr,{className:"w-fit [&_button]:text-sm mt-3 md:[&_button]:text-base md:mt-0 md:ml-4",tabs:o,render:p=>p,tab:s,setTab:p=>{i(p),n(!0)}})]}),a.jsx(jn,{children:a.jsxs("div",{className:"space-y-5",children:[a.jsxs("div",{className:d("Song"),children:[a.jsx(Z,{variant:"h3",className:m(!!r.songs.length),title:"Songs"}),e&&a.jsx(as,{}),!e&&a.jsx(a.Fragment,{children:r.songs.length?a.jsx(br,{setSong:u,songs:r.songs}):s==="Song"&&a.jsx(Ce,{variant:"less",className:"mx-auto"})})]}),a.jsxs("div",{className:d("Playlist"),children:[a.jsx(Z,{variant:"h3",className:m(!!r.playlists.length),title:"Playlist"}),a.jsx(Wl,{whenEmpty:s!=="Playlist"?a.jsx(a.Fragment,{}):void 0,loading:e,playlists:r.playlists})]}),a.jsxs("div",{className:d("Singer"),children:[a.jsx(Z,{variant:"h3",className:m(!!r.singers.length),title:"Singers"}),a.jsx(Xx,{singers:r.singers,loading:e,skeNumber:2,whenEmpty:s==="All"?a.jsx(a.Fragment,{}):void 0})]})]})})]}),a.jsx(ci,{})]})}function sW(){return a.jsx(Ve,{children:a.jsx(Ce,{variant:"with-home-button"})})}function iW(){return a.jsxs("div",{className:"bg-[--layout-cl] text-[--text-cl] flex flex-col justify-center items-center min-h-screen",children:[a.jsx(Z,{title:"Unauthorized"}),a.jsx(Y,{to:"/",children:a.jsxs(se,{variant:"primary",color:"primary",className:"mt-10",children:[a.jsx(xz,{className:"w-6"}),a.jsx("span",{children:"Go home"})]})})]})}function aW(){const[t]=Ow(na),{action:e}=ld(),n=Wt(),r=async()=>{try{await e("login")}catch(s){console.log(s)}};return h.useEffect(()=>{if(t){n("/");return}},[]),a.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-[--layout-cl]",children:[a.jsx(se,{onClick:r,variant:"default",className:"bg-[--primary-cl] font-bold text-[#fff] text-[30px] rounded-full",children:"Login with google"})," "]})}function oW(){const[t,e]=h.useState(),[n,r]=h.useState(!0),[s,i]=h.useState([]),[o,l]=h.useState([]),[c,u]=h.useState([]);return{singer:t,setSinger:e,isFetching:n,setIsFetching:r,songs:s,setSongs:i,playlists:o,albums:c,setAlbums:u,setPlaylists:l}}const kN=h.createContext(null);function lW({children:t}){return a.jsx(kN.Provider,{value:oW(),children:t})}function xi(){const t=h.useContext(kN);if(!t)throw new Error("SingerProvider not provided");return t}let cW="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",uW=(t=21)=>{let e="",n=t|0;for(;n--;)e+=cW[Math.random()*64|0];return e};function dW(){const{setIsFetching:t,setSinger:e,setAlbums:n,isFetching:r,setSongs:s,singer:i,setPlaylists:o}=xi(),{setErrorToast:l}=te(),c=li(),u=h.useRef(!1),d=async()=>{try{if(!c.id)return;const m=await Gt({collectionName:"Singers",id:c.id});if(!m.exists())return;const p={...m.data(),id:c.id},g=ue(_t,X(`singer_map.${p.id}`,"==",!0)),x=await zt(g,{getQueueId:()=>uW(4)+"_"+p.id}),w=ue(vn,X(`singer_map.${p.id}`,"==",!0)),v=await Dn(w),S=[],_=[];v.forEach(E=>E.is_album?_.push(E):S.push(E)),s(x),e(p),o(S),n(_)}catch(m){console.log({error:m}),l()}finally{t(!1)}};return h.useEffect(()=>{u.current||(u.current=!0,d())},[]),{singer:i,isFetching:r}}function qg({onClick:t,children:e}){const{songs:n}=xi();return a.jsx(se,{onClick:t,disabled:!n.length,size:"clear",color:"primary",className:"p-3",children:e})}function hW(){const{songs:t,singer:e}=xi(),{playStatus:n}=ce(Hn),{currentSongData:r}=ce(qe),{handleSetSong:s}=Sr({variant:"playlist"}),{handlePlayPause:i}=gi(),o=()=>{const l=t[0];s(l.queue_id,t)};if(e&&r!=null&&r.song.queue_id.includes(e.id))switch(n){case"loading":case"paused":return a.jsx(qg,{onClick:i,children:a.jsx(qa,{className:"w-7"})});default:return a.jsx(qg,{onClick:i,children:a.jsx(Ju,{className:"w-7"})})}else return a.jsx(qg,{onClick:o,children:a.jsx(qa,{className:"w-7"})})}function fW(){const{user:t,updateUserData:e}=pe(),{setSingers:n}=at(),{setSuccessToast:r}=te(),[s,i]=h.useState(!1);return{likeSinger:async({singer:l})=>{try{if(i(!0),!t)return;const c=fi(oe),u=it(oe,"Users",t.email),d=it(oe,"Singers",l.id),m=[...t.liked_singer_ids],p=m.findIndex(v=>v===l.id),g=p===-1;g?m.unshift(l.id):m.splice(p,1);const x={liked_singer_ids:m},w={like:Qs(g?1:-1)};c.update(u,x),c.update(d,w),await c.commit(),g?(r("Liked"),n(v=>[l,...v])):(n(v=>v.filter(S=>S.id!==l.id)),r("Disliked")),e(x)}catch(c){console.log({error:c})}finally{i(!1)}},isFetching:s,user:t}}function mW(){const{singer:t}=xi(),{likeSinger:e,isFetching:n,user:r}=fW(),s=h.useMemo(()=>r&&t?r.liked_singer_ids.includes(t.id):!1,[r]);return t?a.jsx("button",{onClick:()=>e({singer:t}),className:`${s?"text-[--primary-cl]":""}`,children:n?a.jsx(Ie,{className:"animate-spin"}):a.jsx(a.Fragment,{children:s?a.jsx(Bl,{}):a.jsx(Mu,{})})}):a.jsx(a.Fragment,{})}function pW(){const[t,e]=h.useState(""),n=h.useRef(null),{singer:r}=xi(),s=i=>{var o;e(i),(o=n.current)==null||o.open()};return a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>s("more"),className:"text-sm ml-auto !mt-0",children:"See more"}),a.jsx("div",{className:"!mt-auto",children:a.jsxs("div",{className:"flex items-end",children:[a.jsx(hW,{}),a.jsxs("div",{className:"flex space-x-2 ml-3 [&_button]:p-2 [&_svg]:w-6 hover:[&_button]:bg-[--a-5-cl] [&_button]:rounded-full",children:[a.jsx(mW,{}),a.jsxs(Ln,{appendOnPortal:!0,children:[a.jsx(On,{children:a.jsx("button",{children:a.jsx(ao,{})})}),a.jsx($n,{position:"right-bottom",origin:"top left",children:a.jsx(er,{className:"w-[140px]",children:a.jsx(Or,{children:a.jsx(zw,{})})})})]})]})]})}),t&&a.jsx(re,{ref:n,variant:"animation",children:t==="more"&&r&&a.jsx(ve,{children:r.description})})]})}function gW(){const{isFetching:t,singer:e}=xi();return!t&&!e?a.jsx(a.Fragment,{}):a.jsx(a.Fragment,{children:a.jsxs("div",{className:"md:flex bg-transparent relative z-0 pb-5 md:p-10 items-start",children:[a.jsx("div",{className:"absolute overflow-hidden -left-10 -top-[100px] -right-10 inset-0",children:a.jsxs("div",{className:"relative h-full w-full",children:[a.jsx("div",{className:"absolute z-[-5] inset-0 bg-white/50 dark:bg-black/50  "}),a.jsx("img",{src:(e==null?void 0:e.image_url)||Lw,className:"blur-[50px] absolute z-[-10] w-full h-full object-center object-cover"})]})}),a.jsx("div",{className:"w-[70%] aspect-[1/1] rounded-full overflow-hidden z-0 relative mx-auto md:w-1/4 md:flex-shrink-0 md:m-unset",children:t?a.jsx(ye,{className:"pt-[100%] "}):a.jsx(Ae,{src:e==null?void 0:e.image_url,blurHashEncode:e==null?void 0:e.blurhash_encode,className:"object-cover h-full"})}),a.jsx("div",{className:"flex-grow z-0 relative flex flex-col mt-5 space-y-2.5  md:mt-0 md:ml-5",children:t?a.jsxs(a.Fragment,{children:[a.jsx(ye,{className:"h-[60px] w-full md:w-[200px]"}),a.jsx(ye,{className:"h-[24px] w-[200px]"}),a.jsx(ye,{className:"h-[120px] w-full md:w-[100%]"})]}):e&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-3xl font-bold",children:e.name}),a.jsxs("span",{className:"ml-4",children:["❤️ ",rs(e.like)]})]}),a.jsx("p",{className:"line-clamp-2",children:e.description}),a.jsx(pW,{})]})})]})})}function xW(){const{handleSetSong:t}=Sr({variant:"songs"}),{isFetching:e,songs:n}=xi();return a.jsx(a.Fragment,{children:a.jsxs("div",{children:[a.jsx(Z,{variant:"h2",className:`mb-3 ${ta(!n.length)}`,title:"Popular Songs"}),a.jsx(jn,{children:e?a.jsx(as,{}):a.jsx(br,{whenEmpty:a.jsx(a.Fragment,{}),songs:n,setSong:r=>t(r.queue_id,[r])})})]})})}function yW(){const{isFetching:t,playlists:e}=xi();return a.jsx(a.Fragment,{children:a.jsxs("div",{children:[a.jsx(Z,{variant:"h2",title:"Popular Playlists",className:ta(!e.length)}),a.jsx(Wl,{whenEmpty:a.jsx(a.Fragment,{}),playlists:e,loading:t})]})})}function vW(){const{albums:t,isFetching:e}=xi();return a.jsxs("div",{children:[a.jsx(Z,{variant:"h2",title:"Albums",className:ta(!t.length)}),a.jsx(Wl,{whenEmpty:a.jsx(a.Fragment,{}),playlists:t,loading:e})]})}function wW(){const{isFetching:t,singer:e}=dW();return!t&&!e?a.jsx(Ve,{children:a.jsx(Ce,{variant:"with-home-button"})}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"space-y-5",children:[a.jsx(gW,{}),a.jsx(xW,{}),a.jsx(vW,{}),a.jsx(yW,{})]}),a.jsx(ci,{})]})}function _W(){return a.jsx(lW,{children:a.jsx(wW,{})})}function SW(){const[t,e]=h.useState(),[n,r]=h.useState([]),[s,i]=h.useState(!0),{setErrorToast:o}=te(),l=li(),c=h.useRef(!1),u=async()=>{try{if(!l.id)return;const d=await Gt({collectionName:"Users",id:l.id});if(!d.exists())return;const m={...d.data()},p=ue(vn,X("owner_email","==",m.email),X("is_public","==",!0),X("is_official","==",!1)),g=await Dn(p),x=[],w=[];g.forEach(v=>v.is_album?w.push(v):x.push(v)),r(x),e(m)}catch(d){console.log({error:d}),o()}finally{i(!1)}};return h.useEffect(()=>{c.current||(c.current=!0,u())},[]),{user:t,playlists:n,isFetching:s}}function bW(){const{playlists:t,isFetching:e,user:n}=SW();return!e&&!n?a.jsx(Ve,{children:a.jsx(Ce,{variant:"with-home-button"})}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"mb-5",children:a.jsx(pN,{})}),a.jsxs("div",{className:"space-y-5",children:[a.jsxs("div",{className:"flex flex-col md:flex-row items-center",children:[e?a.jsx(ye,{className:"w-[160px] h-[160px] rounded-full"}):n&&a.jsx("div",{className:"w-[160px] h-[160px] rounded-full overflow-hidden",children:a.jsx(Ae,{fallback:y2.image,blurHashEncode:n.photo_url?"":y2.blurhash,src:n.photo_url})}),a.jsx("div",{className:"text-center mt-3 md:mt-0 md:ml-3 md:text-left ",children:e?a.jsxs(a.Fragment,{children:[a.jsx(ye,{className:"w-[300px] h-[30px]"}),a.jsx(ye,{className:"w-[200px] h-[22px] mt-1"})]}):n&&a.jsxs(a.Fragment,{children:[a.jsx("p",{className:"font-semibold text-2xl",children:n.display_name}),a.jsxs("p",{className:"text-[#666]",children:["Last seen: ",dN(n.last_seen)]})]})})]}),a.jsxs("div",{children:[a.jsx(Z,{title:"Playlists"}),a.jsx(Wl,{loading:e,playlists:t})]})]}),a.jsx(ci,{})]})}function EW({category:t}){return a.jsxs(Y,{to:`/category/${t.id}`,className:"aspect-[5/3]  group relative rounded-lg overflow-hidden",children:[a.jsx(Ae,{className:"h-full group-hover:scale-[1.1] transition-transform duration-[.3s] object-cover",src:t.image_url}),a.jsx("div",{className:"absolute z-[0] inset-0 bg-black/20",children:a.jsx(Ve,{children:a.jsx("p",{className:"text-xl font-bold text-white whitespace-nowrap",children:t.name})})})]})}function jW({title:t,category_ids:e}){const{isFetching:n,categories:r}=nN({category_ids:e}),s=[...Array(3).keys()].map(i=>a.jsx(ye,{className:"aspect-[5/3]"},i));return a.jsx(a.Fragment,{children:a.jsxs("div",{children:[a.jsx(Z,{variant:"h2",title:t}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-3 md:grid-cols-4   gap-4 mt-3",children:n?s:r.map((i,o)=>a.jsx(EW,{category:i},o))})]})})}function kW(){const{categoryPage:t}=En(),{isFetching:e}=sN();return e?a.jsx(Ve,{children:a.jsx(ha,{})}):a.jsxs(a.Fragment,{children:[a.jsxs(po,{children:[a.jsx(rN,{categoryIds:t!=null&&t.category_ids?t==null?void 0:t.category_ids.split("_"):[]}),t==null?void 0:t.category_sections.map((n,r)=>a.jsx(jW,{title:n.name,category_ids:n.target_ids?n.target_ids.split("_"):[]},r)),t==null?void 0:t.playlist_sections.map((n,r)=>a.jsx(Hw,{title:n.name,playlistIds:n.target_ids?n.target_ids.split("_"):[]},r))]}),a.jsx(ci,{})]})}function TW(){const{setErrorToast:t}=te(),{genres:e,setGenres:n}=at(),[r,s]=h.useState(),[i,o]=h.useState(),[l,c]=h.useState(""),[u,d]=h.useState(""),[m,p]=h.useState(!0),g=h.useRef(""),x=h.useMemo(()=>e.length?e.map(N=>N.name):[],[e]),w=N=>{var F;return((F=e.find(k=>bn(N)===bn(k.name)))==null?void 0:F.id)||""},v=h.useMemo(()=>w(l),[e,l]),S=()=>x.reduce((N,F)=>{const k={songs:[],shouldFetching:!0};return{...N,[w(F)]:k}},{}),_=h.useRef(!1),E=async()=>{try{const N=ue(uR,X("is_main","==",!0)),F=await bt(N);if(F.empty)return;const k=F.docs.map(j=>({...j.data(),id:j.id}));n(k),c(k[0].name)}catch{console.log("Error when get genres")}},I=async()=>{try{if(!u||!l||!v)return;p(!0);const N=r?{...r}:S(),F={...N[v]};let k=i?{...i}:void 0;if(g.current!==u){g.current=u;const j=await Gt({collectionName:"Trending_Metrics",id:u,msg:"Get trending data"});j.exists()?k=j.data().trending_songs:k=void 0}if(!k){o(void 0),N&&s(void 0);return}if(F.shouldFetching){F.shouldFetching=!1;const j=k[v];if(!j||!j.length){F.songs=[],Object.assign(N,{[v]:F}),s(N);return}const C=j.map(M=>M.song_id),R=ue(_t,X(Lr(),"in",C)),A=await zt(R);F.songs=A,Object.assign(N,{[v]:F}),s(N),o(k)}else await xr(100)}catch(N){console.log({message:N}),t()}finally{p(!1)}};return h.useEffect(()=>{_.current||(_.current=!0,e.length?c(x[0]):E())},[]),h.useEffect(()=>{!u||!l||I()},[u,l]),{isFetching:m,songMap:r,tabs:x,KEY:v,tab:l,setTab:c,setWeek:d}}function IW(){const t=new Date(Date.now()),e=t.getFullYear(),n=new Date(e,0,1);return n.setDate(n.getDate()+n.getDay()%7),{currentWeek:Math.round((t.getTime()-n.getTime())/(7*24*3600*1e3)),currentYear:e}}function CW({submit:t}){const[e,n]=h.useState([]),[r,s]=h.useState(0),i=h.useMemo(()=>e[r],[r]);return h.useEffect(()=>{const o=[],{currentWeek:l,currentYear:c}=IW();for(let u=1;u<=l;u++)o.push({label:`Week ${u}, ${c}`,value:`${c}-W${u}`});n(o),s(o.length-1),t(o[o.length-1].value)},[]),{weekOptions:e,currentWeekData:i,setCurrentIndex:s,currentIndex:r}}function RW({weekOptions:t,submit:e,currentIndex:n}){const{state:{isOpen:r}}=Gl(),s=h.useRef(null);return h.useEffect(()=>{r&&s.current&&s.current.scrollIntoView({behavior:"instant",block:"center"})},[r]),a.jsx(a.Fragment,{children:t.map((i,o)=>{const l=n===o;return a.jsx("button",{ref:l?s:void 0,className:`${l?"text-[--primary-cl] font-bold":""}`,onClick:()=>e(o),children:i.label},o)})})}function NW(t){const{weekOptions:e,currentIndex:n,currentWeekData:r,setCurrentIndex:s}=CW(t);return a.jsxs(Ln,{appendOnPortal:!0,children:[a.jsx(On,{children:a.jsx("button",{className:"py-2 text-sm font-semibold px-4 rounded-full bg-[--a-5-cl]",children:r==null?void 0:r.label})}),a.jsx($n,{position:"right-bottom",origin:"top left",children:a.jsx(er,{children:a.jsx(Or,{className:"w-[160px] h-[30vh] overflow-auto",children:a.jsx(RW,{weekOptions:e,currentIndex:n,submit:i=>{s(i),t.submit(e[i].value)}})})})})]})}function AW(){var i;const{isFetching:t,songMap:e,setWeek:n,KEY:r,...s}=TW();return a.jsxs("div",{children:[a.jsx(Z,{title:"Week Table",className:"mb-3"}),a.jsxs("div",{className:"mb-5 space-y-3",children:[a.jsx(tr,{className:"w-fit",render:o=>o,...s}),a.jsx(NW,{submit:o=>n(o)})]}),a.jsxs(jn,{children:[t&&a.jsx(as,{}),!t&&a.jsx(a.Fragment,{children:e&&((i=e[r])!=null&&i.songs.length)?a.jsx(br,{songs:e[r].songs,setSong:()=>{}}):a.jsx(Ce,{})})]})]})}function PW(){return a.jsxs(a.Fragment,{children:[a.jsxs(po,{children:[a.jsx(tN,{amount:10}),a.jsx(AW,{})]}),a.jsx(ci,{})]})}function FW({songIds:t}){const[e,n]=h.useState([]),{handleSetSong:r}=Sr({variant:"songs"}),{isFetching:s}=LR({setSongs:n,songIds:t});return s?a.jsx(as,{}):e.length?a.jsx(jn,{children:a.jsxs("div",{className:"mt-5",children:[a.jsx(hp,{variant:"system-song",children:a.jsx(Z,{variant:"h2",title:"Hot songs"})}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-4 mt-3",children:a.jsx(br,{songs:e,setSong:i=>r(i.queue_id,e)})})]})}):a.jsx(a.Fragment,{})}function MW(){const[t,e]=h.useState(),{isFetching:n}=DR({setCategory:e}),[r,s]=h.useMemo(()=>[t!=null&&t.song_ids?t.song_ids.split("_"):[],t!=null&&t.playlist_ids?t.playlist_ids.split("_"):[]],[t]);return n?a.jsx(Ve,{children:a.jsx(ha,{})}):t?a.jsxs(a.Fragment,{children:[a.jsxs(po,{children:[a.jsxs("div",{children:[a.jsx(Z,{title:t.name}),a.jsx("div",{className:"relative rounded-lg overflow-hidden aspect-[16/4] mt-5",children:a.jsx(Ae,{src:t.banner_image_url,blurHashEncode:t.banner_blurhash_encode,className:"object-cover h-full"})})]}),a.jsx(FW,{songIds:r}),a.jsx(Hw,{playlistIds:s})]}),a.jsx(ci,{})]}):a.jsx(Ve,{children:a.jsx(Ce,{variant:"with-home-button"})})}function DW(){const{setErrorToast:t}=te(),[e,n]=h.useState(!1),[r,s]=h.useState([]),i=h.useRef(!0),o=async()=>{try{n(!0);const l=ue(St(oe,"Trending_Keywords"),Ot("today_count","desc"),Mt(5)),c=await bt(l);if(c.empty)return;const u=c.docs.map(d=>d.id);s(u)}catch{console.log("error"),t("")}finally{n(!1)}};return h.useEffect(()=>{console.log(i.current),i.current&&(i.current=!1,o())},[]),{trendingKeywords:r,isFetching:e}}function LW(){const{trendingKeywords:t,isFetching:e}=DW();return a.jsxs(a.Fragment,{children:[a.jsx("h1",{className:"text-xl font-bold text-[#333]",children:"Trending search now"}),e&&a.jsx(Un,{}),!e&&a.jsx($t,{children:a.jsx("div",{className:"flex flex-wrap -ml-2",children:t.map((n,r)=>a.jsx(ks,{children:a.jsxs("span",{children:[n," 🔥🔥🔥"]})},r))})})]})}function os({className:t="",children:e,...n}){return a.jsx($t,{className:"overflow-x-auto w-full",children:a.jsx("div",{className:"rounded-md overflow-hidden",children:a.jsx(WR,{className:`[&_td]:text-sm hover:[&_tr:not(.no-hover)]:bg-black/5 [&_tbody_tr:not(.no-hover)]:border-t [&_tr]:border-black/5 [&_th]:text-sm [&_th]:text-left [&_td]:p-2 [&_th]:p-2 [&_th]:font-bold  ${t}`,...n,children:e})})})}function OW(){const{songs:t,isFetching:e}=JR({amount:5});return a.jsxs(a.Fragment,{children:[a.jsx("h1",{className:"text-xl font-bold text-[#333]",children:"Trending song now"}),e&&a.jsx(Ve,{children:a.jsx(Un,{})}),!e&&a.jsx(os,{colList:["Name","Singers","Today plays"],children:t.length?t.map((n,r)=>a.jsxs("tr",{children:[a.jsx("td",{children:a.jsx(Y,{to:`/dashboard/song/${n.id}/edit`,className:"hover:underline",children:n.name})}),a.jsx("td",{children:n.singers.map((s,i)=>a.jsxs(Y,{className:"hover:underline",to:`/dashboard/singer/${s.id}`,children:[!!i&&", ",s.name]},i))}),a.jsx("td",{children:n.today_play})]},r)):a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"text-center",children:a.jsx(Ce,{})})})})]})}function $W(){return a.jsx(a.Fragment,{children:a.jsxs("div",{className:"space-y-5",children:[a.jsx(OW,{}),a.jsx(LW,{})]})})}const eh=6,zW=["All","Result"];function BW(){const{setUploadedSongs:t,lastDoc:e,shouldFetchUserSongs:n,setHasMore:r}=at(),{setErrorToast:s}=te(),[i,o]=h.useState(""),[l,c]=h.useState(!0),[u,d]=h.useState("All"),[m,p]=h.useState([]),g=async w=>{try{if(w.preventDefault(),l)return;c(!0);const v=lr(_t,[X("is_official","==",!0)],i),S=await zt(v);p(S),d("Result")}catch(v){console.log({message:v}),s()}finally{c(!1)}},x=async()=>{try{c(!0);const w=St(oe,"Songs"),v=e.current?ue(w,X("is_official","==",!0),Ot("updated_at","desc"),qm(e.current),Mt(eh)):ue(w,X("is_official","==",!0),Ot("updated_at","desc"),Mt(eh)),S=await bt(v),_=S.docs.map(E=>({...E.data(),id:E.id,queue_id:""}));e.current?t(E=>[...E,..._]):t(_),_.length<eh?r(!1):e.current=S.docs[eh-1]}catch(w){console.log({message:w}),s()}finally{c(!1)}};return h.useEffect(()=>{n.current?(n.current=!1,x()):c(!1)},[]),{isFetching:l,value:i,setValue:o,handleSubmit:g,tab:u,setTab:d,tabs:zW,getSong:x,searchResult:m}}function VW(){const{hasMore:t,uploadedSongs:e}=at(),{isFetching:n,getSong:r,searchResult:s,tabs:i,setTab:o,tab:l,...c}=BW(),u=h.useMemo(()=>l==="All"?e:s,[l,e,s]);return a.jsxs(a.Fragment,{children:[a.jsx(Z,{title:"Songs"}),a.jsxs("div",{className:"flex justify-between items-start mt-3",children:[a.jsx(mo,{loading:l==="Result"&&n,...c}),a.jsxs(q,{href:"/dashboard/song/add-song",className:"p-1.5 ml-5",size:"clear",children:[a.jsx(js,{className:"w-6"}),a.jsx("div",{className:"hidden md:block",children:"Add song"})]})]}),a.jsx("div",{className:"mt-5 w-fit self-start",children:a.jsx(tr,{disable:l==="All",tabs:i,render:d=>d,tab:l,setTab:o})}),a.jsx("div",{className:"mt-3",children:a.jsx(os,{colList:["Name","Singers","Genre",""],children:u.length?a.jsxs(a.Fragment,{children:[u.map((d,m)=>a.jsx(yU,{variant:"songs",song:d},m)),l==="All"&&n&&a.jsx("tr",{className:"no-hover border-none",children:a.jsx("td",{colSpan:9,children:a.jsx(Ie,{className:"animate-spin w-7 mx-auto"})})}),l==="All"&&a.jsx("tr",{className:"no-hover",children:a.jsx("td",{colSpan:9,className:"text-center hover:bg-none",children:a.jsx(q,{disabled:!t,onClick:r,children:"Get more"})})})]}):a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"text-center",children:a.jsx(Ce,{})})})})})]})}function UW(){const[t,e]=h.useState(),[n,r]=h.useState(),[s,i]=h.useState([]),[o,l]=h.useState(),[c,u]=h.useState([]),[d,m]=h.useState(),[p,g]=h.useState(),[x,w]=h.useState(),v=h.useRef("add"),S=h.useRef(null);return{imageFile:d,setImageFile:m,songFile:t,setSongFile:e,songData:n,song:p,setSong:g,variant:v,setSongData:r,updateSongData:F=>{n&&r({...n,...F})},singers:s,setSingers:i,setGenres:u,genres:c,selectGenre:F=>{const k=[...c],j=k.findIndex(C=>C.id===F.id);j===-1?k.push(F):k.splice(j,1),u(k)},selectSinger:F=>{const k=[...s],j=k.findIndex(C=>C.id===F.id);j===-1?k.push(F):k.splice(j,1),i(k)},imageBlob:x,setImageBlob:w,resetAddSongContext:()=>{e(void 0),i([]),u([])},audioRef:S,mainGenre:o,setMainGenre:l}}const TN=h.createContext(null);function HW({children:t}){return a.jsx(TN.Provider,{value:UW(),children:t})}const ls=()=>{const t=h.useContext(TN);if(!t)throw new Error("AddSongProvider not provided");return t};function IN({afterSearched:t=()=>{},setIsFetchingParent:e}){const{setErrorToast:n}=te(),[r,s]=h.useState(""),[i,o]=h.useState(!1),[l,c]=h.useState(!1),[u,d]=h.useState([]),m=e||o;return{value:r,isShowResult:l,setValue:s,result:u,handleSubmit:async g=>{try{if(g.preventDefault(),g.stopPropagation(),i)return;m(!0),c(!0);const x=lr(Qa,[],r),w=await bu(x);console.log(w),d(w),t()}catch(x){console.log({message:x}),n()}finally{m(!1)}},isFetching:i}}const GW=6;function WW(){const[t,e]=h.useState([]),[n,r]=h.useState(),[s,i]=h.useState([]),[o,l]=h.useState([]),[c,u]=h.useState([]),[d,m]=h.useState(!0),p=h.useRef(),g=h.useRef(!0);return{singer:n,setSinger:r,singers:t,setSingers:e,songs:s,setSongs:i,playlists:o,setPlaylists:l,albums:c,setAlbums:u,hasMore:d,setHasMore:m,lastDoc:p,shouldGetSingers:g,PAGE_SIZE:GW}}const CN=h.createContext(null);function qW({children:t}){return a.jsx(CN.Provider,{value:WW(),children:t})}function cs(){const t=h.useContext(CN);if(!t)throw new Error("SingerProvider not provided");return t}const KW=["Newest","Result"];function QW(){const{singers:t,PAGE_SIZE:e,setSingers:n,setHasMore:r,lastDoc:s,shouldGetSingers:i}=cs(),[o,l]=h.useState(!1),[c,u]=h.useState("Newest"),{isFetching:d,...m}=IN({setIsFetchingParent:l,afterSearched:()=>{u("Result")}}),p=async()=>{try{l(!0),r(w=>s.current&&!w?(s.current=void 0,!w):w);const g=ue(Qa,Ot("created_at","desc"),Mt(e)),x=await bu(g);n(x)}catch(g){console.log(g)}finally{l(!1)}};return h.useEffect(()=>{i.current&&(i.current=!1,p())},[]),{...m,isFetching:o,singers:t,getNewestSingers:p,tabs:KW,tab:c,setTab:u}}function RN(t){const{setErrorToast:e,setSuccessToast:n}=te(),{singer:r,setSinger:s,setSingers:i,shouldGetSingers:o,lastDoc:l}=cs(),[c,u]=h.useState(),[d,m]=h.useState(),[p,g]=h.useState(!1),x=h.useRef(null),w=N=>{c&&u({...c,...N})},v=h.useMemo(()=>t.variant==="add"?!0:!r||!c?!1:c.name!==r.name||c.description!==r.description||c.like!==r.like,[c]),S=!!d,_=h.useMemo(()=>{const N=!!(c!=null&&c.name)&&v;return t.variant==="add"?N:N||S},[S,v,c]),E=async()=>{var N;try{if(!_||!c)return;g(!0);const F={...c,name:c.name.trim(),meta:bn(c.name.trim()).split(" ")};if(d){c.image_file_id&&Dt({fileId:c.image_file_id});const k=await mi({imageFile:d});Object.assign(F,k)}switch(t.variant){case"add":{const k=await Is({collectionName:"Singers",data:F}),j={...c,id:k.id};i(C=>[j,...C]),t.afterSubmit&&(Object.assign(j,{created_at:""}),t.afterSubmit(j)),n("Add singer successful");break}case"edit":{if(!r)return;await je({collectionName:"Singers",id:r.id,data:F}),s({...r,...F}),o.current=!0,l.current=void 0,n("Edit singer successful")}}}catch(F){console.log(F),e()}finally{g(!1),(N=t.modalRef.current)==null||N.close()}},I=()=>{switch(t.variant){case"add":return Kx({name:t.name});case"edit":if(!r)throw new Error("");const{id:N,...F}=r;return Kx(F)}};return h.useEffect(()=>{var N,F;t.variant==="add"&&((N=x.current)==null||N.focus(),(F=t.modalRef.current)==null||F.setModalPersist(!0)),u(I())},[]),h.useEffect(()=>{var N;t.variant==="edit"&&(v||S)&&((N=t.modalRef.current)==null||N.setModalPersist(!0))},[v,S]),h.useEffect(()=>{d&&w({image_url:URL.createObjectURL(d)})},[d]),h.useEffect(()=>{var N;(N=x.current)==null||N.focus()},[]),{singerData:c,imageFile:d,setImageFile:m,updateSingerData:w,setSingerData:u,inputRef:x,handleSubmit:E,isFetching:p,isValidToSubmit:_}}function XW({modalRef:t,afterSubmit:e,singerName:n}){const{handleSubmit:r,isFetching:s,isValidToSubmit:i,singerData:o,updateSingerData:l}=RN({variant:"add",modalRef:t,afterSubmit:e,name:n}),c=(u,d)=>{l({...o,[u]:d})};return a.jsxs(ve,{className:"w-[450px]",children:[a.jsx(Be,{closeModal:()=>{var u;return(u=t.current)==null?void 0:u.close()},title:"Add singer"}),a.jsx("div",{className:"space-y-3 overflow-auto",children:a.jsxs("div",{className:"space-y-1",children:[a.jsx(Lt,{htmlFor:"name",children:"Singer name"}),a.jsx(_n,{id:"name",value:(o==null?void 0:o.name)||"",onChange:u=>c("name",u.target.value),placeholder:"name..."})]})}),a.jsx("div",{className:"text-center mt-5",children:a.jsxs(q,{disabled:!i,loading:s,onClick:()=>i&&r(),children:[a.jsx(oa,{className:"w-6"}),a.jsx("p",{className:"text-white",children:"Ok"})]})})]})}function NN({choose:t,closeModal:e}){const{result:n,isShowResult:r,isFetching:s,setTab:i,getNewestSingers:o,tab:l,singers:c,tabs:u,...d}=QW(),m=h.useRef(null),p=g=>g.map((x,w)=>a.jsx("button",{onClick:()=>t(x),className:"rounded-md w-full p-1 text-sm font-semibold text-left hover:bg-[--a-5-cl]",children:x.name},w));return a.jsxs(a.Fragment,{children:[a.jsxs(ve,{children:[a.jsx(Be,{title:"Singers",closeModal:e}),a.jsx(mo,{...d}),a.jsx(tr,{className:"w-fit mt-3",buttonClasses:"[&_button]:px-3 [&_button]:py-1/2",tabs:u,setTab:i,tab:l,render:g=>g}),a.jsx("div",{className:"h-[40vh] mt-2 space-y-1.5 overflow-auto bg-[--a-5-cl] p-2 rounded-md",children:s?a.jsx(Un,{className:"h-full"}):a.jsxs(a.Fragment,{children:[l==="Newest"&&a.jsxs(a.Fragment,{children:[c.length?p(c):a.jsx(Ce,{variant:"less"}),a.jsx("p",{className:"text-center mt-3",children:a.jsx(q,{onClick:o,children:a.jsx(Ie,{className:"w-5"})})})]}),l==="Result"&&r&&a.jsx(a.Fragment,{children:n.length?p(n):a.jsxs(a.Fragment,{children:[a.jsx(Ce,{variant:"less"}),a.jsx("p",{className:"text-center mt-auto",children:a.jsxs(q,{onClick:()=>{var g;return(g=m.current)==null?void 0:g.open()},children:[a.jsx(js,{className:"w-6"}),a.jsx("span",{children:"Add new singer"})]})})]})})]})})]}),a.jsx(re,{ref:m,variant:"animation",children:a.jsx(XW,{afterSubmit:t,singerName:d.value,modalRef:m})})]})}function YW(){const{singers:t,selectSinger:e}=ls(),n=h.useRef(null),r=()=>{var i;return(i=n.current)==null?void 0:i.close()},s=i=>{e(i),r()};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("div",{children:"Singer"}),a.jsxs("div",{className:"-ml-2 flex flex-wrap",children:[t.map((i,o)=>a.jsxs(ks,{children:[a.jsx("span",{children:i.name}),a.jsx("div",{className:"flex",children:a.jsx("button",{onClick:()=>e(i),children:a.jsx(ut,{className:"w-5"})})})]},o)),a.jsx(q,{onClick:()=>{var i;return(i=n.current)==null?void 0:i.open()},className:"mt-2 ml-2 h-[38px] w-[38px] justify-center",size:"clear",children:a.jsx(js,{className:"w-5"})})]})]}),a.jsx(mw,{ref:n,children:a.jsx(NN,{closeModal:r,choose:s})})]})}function JW({audioEle:t}){const{status:e,handlePlayPause:n,progressLineRef:r,currentTimeRef:s,durationRef:i}=Jm({audioEle:t}),o=()=>{switch(e){case"error":return a.jsx(vm,{className:"w-6"});case"playing":return a.jsx(yv,{className:"w-6"});case"paused":return a.jsx(hf,{className:"w-6"});case"waiting":return a.jsx(Ie,{className:"w-6 animate-spin"})}};return a.jsx(a.Fragment,{children:a.jsxs("div",{className:"flex items-end justify-between",children:[a.jsx(q,{className:"p-1.5",size:"clear",onClick:n,children:o()}),a.jsxs("div",{className:"flex flex-grow items-center ml-4",children:[a.jsx("div",{className:"text-sm w-[50px]",ref:s,children:"00:00"}),a.jsx(od,{elelRef:r,className:"h-1"}),a.jsx("div",{className:"text-sm w-[50px] text-right",ref:i,children:"00:00"})]})]})})}function ZW(){const[t,e]=h.useState([]),{mains:n,subs:r}=h.useMemo(()=>{const i=[],o=[];return t.forEach(l=>{l.is_main?i.push(l):o.push(l)}),{mains:i,subs:o}},[t]),s=h.useRef(!0);return{genres:t,mains:n,subs:r,shouldFetchGenre:s,setGenres:e}}const AN=h.createContext(null);function eq({children:t}){return a.jsx(AN.Provider,{value:ZW(),children:t})}const pp=()=>{const t=h.useContext(AN);if(!t)throw new Error("GenreProvider is not provided");return t};function PN(){const{setGenres:t,genres:e}=pp(),{setErrorToast:n,setSuccessToast:r}=te(),[s,i]=h.useState(!1);return{isFetching:s,action:async l=>{try{switch(i(!0),l.type){case"add":{if(e.find(m=>m.name===l.genre.name))return await xr(100),n("Genre already exist");const u=await Is({collectionName:"Genres",data:l.genre}),d={...l.genre,id:u.id};return t(m=>[d,...m]),i(!1),r("Add genre successful"),d}case"edit":{await je({collectionName:"Genres",data:l.genre,id:l.id});const c=[...e],u=c.findIndex(m=>m.id===l.id),d={...e[u]};Object.assign(d,l.genre),c[u]=d,t(c),r("Edit genre successful");break}case"delete":{await kw({collectionName:"Genres",id:l.id}),t(c=>c.filter(u=>u.id!==l.id)),r("Delete genre successful");break}}}catch{}finally{i(!1)}}}}function gp({closeModal:t,afterSubmit:e,...n}){const[r,s]=h.useState(n.type==="add"?n.genreName||"":n.genre.name),[i,o]=h.useState(n.type==="add"?n.isMain||!1:n.genre.is_main),{action:l,isFetching:c}=PN(),{setErrorToast:u}=te(),d=h.useRef(null),m=!!r,p=async()=>{try{if(!r.trim())return;const w={is_main:i,name:r};switch(n.type){case"add":const v=await l({type:"add",genre:w});v&&e&&e(v);break;case"edit":await l({type:"edit",genre:w,id:n.genre.id});break}}catch(w){console.log(w),u()}finally{t()}},g={inputGroup:"space-y-1"};h.useEffect(()=>{var w;(w=d.current)==null||w.focus()},[]);const x=n.type==="edit"?`Edit '${n.genre.name}'`:"Add genre";return a.jsxs(ve,{className:"w-[450px]",children:[a.jsx(Be,{closeModal:t,title:x}),a.jsxs("div",{className:"space-y-3 overflow-auto mt-5",children:[a.jsxs("div",{className:g.inputGroup,children:[a.jsx(Lt,{children:"Name"}),a.jsx(_n,{ref:d,value:r,onChange:w=>s(w.target.value),placeholder:"name..."})]}),a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx(Lt,{children:"Main"}),a.jsx(Ho,{inActiveBg:"bg-black/10",active:i,cb:()=>o(!i)})]})]}),a.jsx("div",{className:"text-right mt-10",children:a.jsxs(q,{disabled:!m,loading:c,onClick:()=>m&&p(),children:[a.jsx(oa,{className:"w-6"}),a.jsx("p",{className:"text-white",children:"Ok"})]})}),c&&a.jsx(pi,{})]})}function xp(){const{setGenres:t,shouldFetchGenre:e}=pp(),[n,r]=h.useState(!0);return{api:async()=>{try{if(e.current){e.current=!1;const i=St(oe,"Genres"),o=ue(i);console.log(">>> fetch genres");const l=await bt(o);if(l.docs){const c=l.docs.map(u=>({...u.data(),id:u.id}));t(c)}}else await xr(100)}catch(i){console.log(i)}finally{r(!1)}},isFetching:n}}function FN(){const{genres:t,subs:e,mains:n}=pp(),[r,s]=h.useState(""),i=AR(r,800),o=h.useMemo(()=>i?t.filter(l=>bn(l.name).includes(bn(i))):[],[i,t]);return{value:r,setValue:s,_genres:o,mains:n,subs:e}}function tq({closeModal:t,choose:e}){const{subs:n,...r}=FN(),s=h.useRef(null),i=h.useRef(null),o=()=>{var u;return(u=s.current)==null?void 0:u.close()},{api:l,isFetching:c}=xp();return h.useEffect(()=>{var u;l(),(u=i.current)==null||u.focus()},[]),a.jsxs(a.Fragment,{children:[a.jsxs(ve,{children:[a.jsx(Be,{title:"Genre",closeModal:t}),a.jsx(zR,{inputRef:i,...r}),a.jsx("div",{className:"h-[40vh] mt-3 space-y-1.5 overflow-auto",children:c?a.jsx(Un,{className:"h-full"}):a.jsx(a.Fragment,{children:n.length?n.map((u,d)=>a.jsx("button",{className:"w-full text-left",onClick:()=>e(u),children:a.jsx($t,{children:a.jsx("p",{className:"text-lg",children:u.name})})},d)):a.jsx(a.Fragment,{children:a.jsx(Ce,{})})})}),a.jsx("p",{className:"text-center mt-auto",children:a.jsxs(q,{onClick:()=>{var u;return(u=s.current)==null?void 0:u.open()},children:[a.jsx(Nt,{className:"w-6"}),a.jsx("span",{children:"Add new genre"})]})})]}),a.jsx(re,{ref:s,variant:"animation",children:a.jsx(gp,{afterSubmit:e,genreName:r.value,type:"add",closeModal:o})})]})}function nq({closeModal:t,choose:e}){const{mains:n}=pp(),r=h.useRef(null),s=()=>{var l;return(l=r.current)==null?void 0:l.close()},{api:i,isFetching:o}=xp();return h.useEffect(()=>{i()},[]),a.jsxs(a.Fragment,{children:[a.jsxs(ve,{children:[a.jsx(Be,{title:"Genre",closeModal:t}),a.jsx("div",{className:"h-[40vh] mt-3 space-y-1.5 overflow-auto",children:o?a.jsx(Un,{className:"h-full"}):a.jsx(a.Fragment,{children:n.length?n.map((l,c)=>a.jsx("button",{onClick:()=>{e(l),t()},className:"w-full text-left",children:a.jsx($t,{children:a.jsx("p",{className:"text-lg",children:l.name})})},c)):a.jsx(a.Fragment,{children:a.jsx(Ce,{})})})}),a.jsx("p",{className:"text-center mt-auto",children:a.jsxs(q,{onClick:()=>{var l;return(l=r.current)==null?void 0:l.open()},children:[a.jsx(Nt,{className:"w-6"}),a.jsx("span",{children:"Add new genre"})]})})]}),a.jsx(re,{ref:r,variant:"animation",children:a.jsx(gp,{afterSubmit:e,type:"add",isMain:!0,closeModal:s})})]})}function rq(){const{genres:t,songData:e,updateSongData:n,selectGenre:r}=ls(),[s,i]=h.useState(""),o=h.useRef(null),l=d=>{var m;i(d),(m=o.current)==null||m.open()},c=d=>{r(d),u()},u=()=>{var d;return(d=o.current)==null?void 0:d.close()};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex w-full",children:[a.jsxs("div",{className:"w-1/2",children:[a.jsx("div",{children:"Main genre"}),a.jsxs("div",{className:"-ml-2 flex flex-wrap",children:[(e==null?void 0:e.main_genre)&&a.jsxs(ks,{className:"w-fit",children:[a.jsx("span",{children:e.main_genre.name}),a.jsx("div",{children:a.jsx("button",{onClick:()=>n({main_genre:void 0}),children:a.jsx(ut,{className:"w-5"})})})]}),!(e!=null&&e.main_genre)&&a.jsx(q,{onClick:()=>l("main"),className:"mt-2 ml-2 h-[38px] w-[38px] justify-center",size:"clear",children:a.jsx(js,{className:"w-5"})})]})]}),a.jsxs("div",{className:"flex-grow",children:[a.jsx("div",{children:"Sub genres"}),a.jsxs("div",{className:"flex flex-wrap -ml-2",children:[t.map((d,m)=>a.jsxs(ks,{children:[a.jsx("span",{children:d.name}),a.jsx("div",{children:a.jsx("button",{onClick:()=>r(d),children:a.jsx(ut,{className:"w-5"})})})]},m)),a.jsx(q,{onClick:()=>l("sub"),className:"mt-2 ml-2 h-[38px] w-[38px] justify-center",size:"clear",children:a.jsx(js,{className:"w-5"})})]})]})]}),a.jsxs(mw,{ref:o,children:[s==="sub"&&a.jsx(tq,{closeModal:u,choose:c}),s==="main"&&a.jsx(nq,{closeModal:u,choose:d=>n({main_genre:d})})]})]})}const sq="End-Of-Stream";class vt extends Error{constructor(){super(sq)}}class iq{constructor(){this.maxStreamReadSize=1*1024*1024,this.endOfStream=!1,this.peekQueue=[]}async peek(e,n,r){const s=await this.read(e,n,r);return this.peekQueue.push(e.subarray(n,n+s)),s}async read(e,n,r){if(r===0)return 0;let s=this.readFromPeekBuffer(e,n,r);if(s+=await this.readRemainderFromStream(e,n+s,r-s),s===0)throw new vt;return s}readFromPeekBuffer(e,n,r){let s=r,i=0;for(;this.peekQueue.length>0&&s>0;){const o=this.peekQueue.pop();if(!o)throw new Error("peekData should be defined");const l=Math.min(o.length,s);e.set(o.subarray(0,l),n+i),i+=l,s-=l,l<o.length&&this.peekQueue.push(o.subarray(l))}return i}async readRemainderFromStream(e,n,r){let s=r,i=0;for(;s>0&&!this.endOfStream;){const o=Math.min(s,this.maxStreamReadSize),l=await this.readFromStream(e,n+i,o);if(l===0)break;i+=l,s-=l}return i}}class aq extends iq{constructor(e){super(),this.reader=e.getReader({mode:"byob"})}async readFromStream(e,n,r){if(this.endOfStream)throw new vt;const s=await this.reader.read(new Uint8Array(r));return s.done&&(this.endOfStream=s.done),s.value?(e.set(s.value,n),s.value.byteLength):0}}class MN{constructor(e){this.position=0,this.numBuffer=new Uint8Array(8),this.fileInfo=(e==null?void 0:e.fileInfo)??{},this.onClose=e==null?void 0:e.onClose}async readToken(e,n=this.position){const r=new Uint8Array(e.len);if(await this.readBuffer(r,{position:n})<e.len)throw new vt;return e.get(r,0)}async peekToken(e,n=this.position){const r=new Uint8Array(e.len);if(await this.peekBuffer(r,{position:n})<e.len)throw new vt;return e.get(r,0)}async readNumber(e){if(await this.readBuffer(this.numBuffer,{length:e.len})<e.len)throw new vt;return e.get(this.numBuffer,0)}async peekNumber(e){if(await this.peekBuffer(this.numBuffer,{length:e.len})<e.len)throw new vt;return e.get(this.numBuffer,0)}async ignore(e){if(this.fileInfo.size!==void 0){const n=this.fileInfo.size-this.position;if(e>n)return this.position+=n,n}return this.position+=e,e}async close(){var e;await((e=this.onClose)==null?void 0:e.call(this))}normalizeOptions(e,n){if(n&&n.position!==void 0&&n.position<this.position)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");return n?{mayBeLess:n.mayBeLess===!0,offset:n.offset?n.offset:0,length:n.length?n.length:e.length-(n.offset?n.offset:0),position:n.position?n.position:this.position}:{mayBeLess:!1,offset:0,length:e.length,position:this.position}}}const oq=256e3;class lq extends MN{constructor(e,n){super(n),this.streamReader=e}async readBuffer(e,n){const r=this.normalizeOptions(e,n),s=r.position-this.position;if(s>0)return await this.ignore(s),this.readBuffer(e,n);if(s<0)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");if(r.length===0)return 0;const i=await this.streamReader.read(e,r.offset,r.length);if(this.position+=i,(!n||!n.mayBeLess)&&i<r.length)throw new vt;return i}async peekBuffer(e,n){const r=this.normalizeOptions(e,n);let s=0;if(r.position){const i=r.position-this.position;if(i>0){const o=new Uint8Array(r.length+i);return s=await this.peekBuffer(o,{mayBeLess:r.mayBeLess}),e.set(o.subarray(i),r.offset),s-i}if(i<0)throw new Error("Cannot peek from a negative offset in a stream")}if(r.length>0){try{s=await this.streamReader.peek(e,r.offset,r.length)}catch(i){if(n!=null&&n.mayBeLess&&i instanceof vt)return 0;throw i}if(!r.mayBeLess&&s<r.length)throw new vt}return s}async ignore(e){const n=Math.min(oq,e),r=new Uint8Array(n);let s=0;for(;s<e;){const i=e-s,o=await this.readBuffer(r,{length:Math.min(n,i)});if(o<0)return o;s+=o}return s}}class cq extends MN{constructor(e,n){super(n),this.uint8Array=e,this.fileInfo.size=this.fileInfo.size?this.fileInfo.size:e.length}async readBuffer(e,n){if(n!=null&&n.position){if(n.position<this.position)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");this.position=n.position}const r=await this.peekBuffer(e,n);return this.position+=r,r}async peekBuffer(e,n){const r=this.normalizeOptions(e,n),s=Math.min(this.uint8Array.length-r.position,r.length);if(!r.mayBeLess&&s<r.length)throw new vt;return e.set(this.uint8Array.subarray(r.position,r.position+s),r.offset),s}close(){return super.close()}}function DN(t,e){return new lq(new aq(t),e)}function kl(t,e){return new cq(t,e)}/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */var yp=function(t,e,n,r,s){var i,o,l=s*8-r-1,c=(1<<l)-1,u=c>>1,d=-7,m=n?s-1:0,p=n?-1:1,g=t[e+m];for(m+=p,i=g&(1<<-d)-1,g>>=-d,d+=l;d>0;i=i*256+t[e+m],m+=p,d-=8);for(o=i&(1<<-d)-1,i>>=-d,d+=r;d>0;o=o*256+t[e+m],m+=p,d-=8);if(i===0)i=1-u;else{if(i===c)return o?NaN:(g?-1:1)*(1/0);o=o+Math.pow(2,r),i=i-u}return(g?-1:1)*o*Math.pow(2,i-r)},vp=function(t,e,n,r,s,i){var o,l,c,u=i*8-s-1,d=(1<<u)-1,m=d>>1,p=s===23?Math.pow(2,-24)-Math.pow(2,-77):0,g=r?0:i-1,x=r?1:-1,w=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(l=isNaN(e)?1:0,o=d):(o=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-o))<1&&(o--,c*=2),o+m>=1?e+=p/c:e+=p*Math.pow(2,1-m),e*c>=2&&(o++,c/=2),o+m>=d?(l=0,o=d):o+m>=1?(l=(e*c-1)*Math.pow(2,s),o=o+m):(l=e*Math.pow(2,m-1)*Math.pow(2,s),o=0));s>=8;t[n+g]=l&255,g+=x,l/=256,s-=8);for(o=o<<s|l,u+=s;u>0;t[n+g]=o&255,g+=x,o/=256,u-=8);t[n+g-x]|=w*128};function ke(t){return new DataView(t.buffer,t.byteOffset)}const Te={len:1,get(t,e){return ke(t).getUint8(e)},put(t,e,n){return ke(t).setUint8(e,n),e+1}},Ue={len:2,get(t,e){return ke(t).getUint16(e,!0)},put(t,e,n){return ke(t).setUint16(e,n,!0),e+2}},We={len:2,get(t,e){return ke(t).getUint16(e)},put(t,e,n){return ke(t).setUint16(e,n),e+2}},zf={len:3,get(t,e){const n=ke(t);return n.getUint8(e)+(n.getUint16(e+1,!0)<<8)},put(t,e,n){const r=ke(t);return r.setUint8(e,n&255),r.setUint16(e+1,n>>8,!0),e+3}},Mn={len:3,get(t,e){const n=ke(t);return(n.getUint16(e)<<8)+n.getUint8(e+2)},put(t,e,n){const r=ke(t);return r.setUint16(e,n>>8),r.setUint8(e+2,n&255),e+3}},ie={len:4,get(t,e){return ke(t).getUint32(e,!0)},put(t,e,n){return ke(t).setUint32(e,n,!0),e+4}},de={len:4,get(t,e){return ke(t).getUint32(e)},put(t,e,n){return ke(t).setUint32(e,n),e+4}},Eu={len:1,get(t,e){return ke(t).getInt8(e)},put(t,e,n){return ke(t).setInt8(e,n),e+1}},Ws={len:2,get(t,e){return ke(t).getInt16(e)},put(t,e,n){return ke(t).setInt16(e,n),e+2}},uq={len:2,get(t,e){return ke(t).getInt16(e,!0)},put(t,e,n){return ke(t).setInt16(e,n,!0),e+2}},dq={len:3,get(t,e){const n=zf.get(t,e);return n>8388607?n-16777216:n},put(t,e,n){const r=ke(t);return r.setUint8(e,n&255),r.setUint16(e+1,n>>8,!0),e+3}},Kw={len:3,get(t,e){const n=Mn.get(t,e);return n>8388607?n-16777216:n},put(t,e,n){const r=ke(t);return r.setUint16(e,n>>8),r.setUint8(e+2,n&255),e+3}},pr={len:4,get(t,e){return ke(t).getInt32(e)},put(t,e,n){return ke(t).setInt32(e,n),e+4}},gt={len:4,get(t,e){return ke(t).getInt32(e,!0)},put(t,e,n){return ke(t).setInt32(e,n,!0),e+4}},Nn={len:8,get(t,e){return ke(t).getBigUint64(e,!0)},put(t,e,n){return ke(t).setBigUint64(e,n,!0),e+8}},Bf={len:8,get(t,e){return ke(t).getBigInt64(e,!0)},put(t,e,n){return ke(t).setBigInt64(e,n,!0),e+8}},Qw={len:8,get(t,e){return ke(t).getBigUint64(e)},put(t,e,n){return ke(t).setBigUint64(e,n),e+8}},LN={len:8,get(t,e){return ke(t).getBigInt64(e)},put(t,e,n){return ke(t).setBigInt64(e,n),e+8}},hq={len:2,get(t,e){return yp(t,e,!1,10,this.len)},put(t,e,n){return vp(t,n,e,!1,10,this.len),e+this.len}},fq={len:2,get(t,e){return yp(t,e,!0,10,this.len)},put(t,e,n){return vp(t,n,e,!0,10,this.len),e+this.len}},ON={len:4,get(t,e){return ke(t).getFloat32(e)},put(t,e,n){return ke(t).setFloat32(e,n),e+4}},mq={len:4,get(t,e){return ke(t).getFloat32(e,!0)},put(t,e,n){return ke(t).setFloat32(e,n,!0),e+4}},Yx={len:8,get(t,e){return ke(t).getFloat64(e)},put(t,e,n){return ke(t).setFloat64(e,n),e+8}},pq={len:8,get(t,e){return ke(t).getFloat64(e,!0)},put(t,e,n){return ke(t).setFloat64(e,n,!0),e+8}},gq={len:10,get(t,e){return yp(t,e,!1,63,this.len)},put(t,e,n){return vp(t,n,e,!1,63,this.len),e+this.len}},xq={len:10,get(t,e){return yp(t,e,!0,63,this.len)},put(t,e,n){return vp(t,n,e,!0,63,this.len),e+this.len}};class yq{constructor(e){this.len=e}get(e,n){}}class Gn{constructor(e){this.len=e}get(e,n){return e.subarray(n,n+this.len)}}class le{constructor(e,n){this.len=e,this.encoding=n,this.textDecoder=new TextDecoder(n)}get(e,n){return this.textDecoder.decode(e.subarray(n,n+this.len))}}class vq{constructor(e){this.len=e,this.textDecoder=new TextDecoder("windows-1252")}get(e,n=0){return this.textDecoder.decode(e.subarray(n,n+this.len))}}const wq=Object.freeze(Object.defineProperty({__proto__:null,AnsiStringType:vq,Float16_BE:hq,Float16_LE:fq,Float32_BE:ON,Float32_LE:mq,Float64_BE:Yx,Float64_LE:pq,Float80_BE:gq,Float80_LE:xq,INT16_BE:Ws,INT16_LE:uq,INT24_BE:Kw,INT24_LE:dq,INT32_BE:pr,INT32_LE:gt,INT64_BE:LN,INT64_LE:Bf,INT8:Eu,IgnoreType:yq,StringType:le,UINT16_BE:We,UINT16_LE:Ue,UINT24_BE:Mn,UINT24_LE:zf,UINT32_BE:de,UINT32_LE:ie,UINT64_BE:Qw,UINT64_LE:Nn,UINT8:Te,Uint8ArrayType:Gn},Symbol.toStringTag,{value:"Module"})),_q=Object.prototype.toString,Sq="[object Uint8Array]",bq="[object ArrayBuffer]";function $N(t,e,n){return t?t.constructor===e?!0:_q.call(t)===n:!1}function zN(t){return $N(t,Uint8Array,Sq)}function Eq(t){return $N(t,ArrayBuffer,bq)}function jq(t){return zN(t)||Eq(t)}function kq(t){if(!zN(t))throw new TypeError(`Expected \`Uint8Array\`, got \`${typeof t}\``)}function Tq(t){if(!jq(t))throw new TypeError(`Expected \`Uint8Array\` or \`ArrayBuffer\`, got \`${typeof t}\``)}const th={utf8:new globalThis.TextDecoder("utf8")};function Xw(t,e="utf8"){return Tq(t),th[e]??(th[e]=new globalThis.TextDecoder(e)),th[e].decode(t)}function BN(t){if(typeof t!="string")throw new TypeError(`Expected \`string\`, got \`${typeof t}\``)}const Iq=new globalThis.TextEncoder;function Cq(t){return BN(t),Iq.encode(t)}const Rq=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Yw(t){kq(t);let e="";for(let n=0;n<t.length;n++)e+=Rq[t[n]];return e}const T2={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,a:10,b:11,c:12,d:13,e:14,f:15,A:10,B:11,C:12,D:13,E:14,F:15};function I2(t){if(BN(t),t.length%2!==0)throw new Error("Invalid Hex string length.");const e=t.length/2,n=new Uint8Array(e);for(let r=0;r<e;r++){const s=T2[t[r*2]],i=T2[t[r*2+1]];if(s===void 0||i===void 0)throw new Error(`Invalid Hex character encountered at position ${r*2}`);n[r]=s<<4|i}return n}function C2(t){const{byteLength:e}=t;if(e===6)return t.getUint16(0)*2**32+t.getUint32(2);if(e===5)return t.getUint8(0)*2**32+t.getUint32(1);if(e===4)return t.getUint32(0);if(e===3)return t.getUint8(0)*2**16+t.getUint16(1);if(e===2)return t.getUint16(0);if(e===1)return t.getUint8(0)}function VN(t,e){const n=t.length,r=e.length;if(r===0||r>n)return-1;const s=n-r;for(let i=0;i<=s;i++){let o=!0;for(let l=0;l<r;l++)if(t[i+l]!==e[l]){o=!1;break}if(o)return i}return-1}function Nq(t,e){return VN(t,e)!==-1}function Aq(t){return[...t].map(e=>e.charCodeAt(0))}function Pq(t,e=0){const n=Number.parseInt(new le(6).get(t,148).replace(/\0.*$/,"").trim(),8);if(Number.isNaN(n))return!1;let r=8*32;for(let s=e;s<e+148;s++)r+=t[s];for(let s=e+156;s<e+512;s++)r+=t[s];return n===r}const Fq={get:(t,e)=>t[e+3]&127|t[e+2]<<7|t[e+1]<<14|t[e]<<21,len:4},Mq=["jpg","png","apng","gif","webp","flif","xcf","cr2","cr3","orf","arw","dng","nef","rw2","raf","tif","bmp","icns","jxr","psd","indd","zip","tar","rar","gz","bz2","7z","dmg","mp4","mid","mkv","webm","mov","avi","mpg","mp2","mp3","m4a","oga","ogg","ogv","opus","flac","wav","spx","amr","pdf","epub","elf","macho","exe","swf","rtf","wasm","woff","woff2","eot","ttf","otf","ico","flv","ps","xz","sqlite","nes","crx","xpi","cab","deb","ar","rpm","Z","lz","cfb","mxf","mts","blend","bpg","docx","pptx","xlsx","3gp","3g2","j2c","jp2","jpm","jpx","mj2","aif","qcp","odt","ods","odp","xml","mobi","heic","cur","ktx","ape","wv","dcm","ics","glb","pcap","dsf","lnk","alias","voc","ac3","m4v","m4p","m4b","f4v","f4p","f4b","f4a","mie","asf","ogm","ogx","mpc","arrow","shp","aac","mp1","it","s3m","xm","ai","skp","avif","eps","lzh","pgp","asar","stl","chm","3mf","zst","jxl","vcf","jls","pst","dwg","parquet","class","arj","cpio","ace","avro","icc","fbx","vsdx"],Dq=["image/jpeg","image/png","image/gif","image/webp","image/flif","image/x-xcf","image/x-canon-cr2","image/x-canon-cr3","image/tiff","image/bmp","image/vnd.ms-photo","image/vnd.adobe.photoshop","application/x-indesign","application/epub+zip","application/x-xpinstall","application/vnd.oasis.opendocument.text","application/vnd.oasis.opendocument.spreadsheet","application/vnd.oasis.opendocument.presentation","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/zip","application/x-tar","application/x-rar-compressed","application/gzip","application/x-bzip2","application/x-7z-compressed","application/x-apple-diskimage","application/x-apache-arrow","video/mp4","audio/midi","video/x-matroska","video/webm","video/quicktime","video/vnd.avi","audio/wav","audio/qcelp","audio/x-ms-asf","video/x-ms-asf","application/vnd.ms-asf","video/mpeg","video/3gpp","audio/mpeg","audio/mp4","audio/opus","video/ogg","audio/ogg","application/ogg","audio/x-flac","audio/ape","audio/wavpack","audio/amr","application/pdf","application/x-elf","application/x-mach-binary","application/x-msdownload","application/x-shockwave-flash","application/rtf","application/wasm","font/woff","font/woff2","application/vnd.ms-fontobject","font/ttf","font/otf","image/x-icon","video/x-flv","application/postscript","application/eps","application/x-xz","application/x-sqlite3","application/x-nintendo-nes-rom","application/x-google-chrome-extension","application/vnd.ms-cab-compressed","application/x-deb","application/x-unix-archive","application/x-rpm","application/x-compress","application/x-lzip","application/x-cfb","application/x-mie","application/mxf","video/mp2t","application/x-blender","image/bpg","image/j2c","image/jp2","image/jpx","image/jpm","image/mj2","audio/aiff","application/xml","application/x-mobipocket-ebook","image/heif","image/heif-sequence","image/heic","image/heic-sequence","image/icns","image/ktx","application/dicom","audio/x-musepack","text/calendar","text/vcard","model/gltf-binary","application/vnd.tcpdump.pcap","audio/x-dsf","application/x.ms.shortcut","application/x.apple.alias","audio/x-voc","audio/vnd.dolby.dd-raw","audio/x-m4a","image/apng","image/x-olympus-orf","image/x-sony-arw","image/x-adobe-dng","image/x-nikon-nef","image/x-panasonic-rw2","image/x-fujifilm-raf","video/x-m4v","video/3gpp2","application/x-esri-shape","audio/aac","audio/x-it","audio/x-s3m","audio/x-xm","video/MP1S","video/MP2P","application/vnd.sketchup.skp","image/avif","application/x-lzh-compressed","application/pgp-encrypted","application/x-asar","model/stl","application/vnd.ms-htmlhelp","model/3mf","image/jxl","application/zstd","image/jls","application/vnd.ms-outlook","image/vnd.dwg","application/x-parquet","application/java-vm","application/x-arj","application/x-cpio","application/x-ace-compressed","application/avro","application/vnd.iccprofile","application/x.autodesk.fbx","application/vnd.visio"],R2=4100;async function UN(t){return new Lq().fromBuffer(t)}function hs(t,e,n){n={offset:0,...n};for(const[r,s]of e.entries())if(n.mask){if(s!==(n.mask[r]&t[r+n.offset]))return!1}else if(s!==t[r+n.offset])return!1;return!0}class Lq{constructor(e){this.detectors=e==null?void 0:e.customDetectors,this.fromTokenizer=this.fromTokenizer.bind(this),this.fromBuffer=this.fromBuffer.bind(this),this.parse=this.parse.bind(this)}async fromTokenizer(e){const n=e.position;for(const r of this.detectors||[]){const s=await r(e);if(s)return s;if(n!==e.position)return}return this.parse(e)}async fromBuffer(e){if(!(e instanceof Uint8Array||e instanceof ArrayBuffer))throw new TypeError(`Expected the \`input\` argument to be of type \`Uint8Array\` or \`ArrayBuffer\`, got \`${typeof e}\``);const n=e instanceof Uint8Array?e:new Uint8Array(e);if((n==null?void 0:n.length)>1)return this.fromTokenizer(kl(n))}async fromBlob(e){return this.fromStream(e.stream())}async fromStream(e){const n=await DN(e);try{return await this.fromTokenizer(n)}finally{await n.close()}}async toDetectionStream(e,n){const{sampleSize:r=R2}=n;let s,i;const o=e.getReader({mode:"byob"});try{const{value:u,done:d}=await o.read(new Uint8Array(r));if(i=u,!d&&u)try{s=await this.fromBuffer(u.slice(0,r))}catch(m){if(!(m instanceof vt))throw m;s=void 0}i=u}finally{o.releaseLock()}const l=new TransformStream({async start(u){u.enqueue(i)},transform(u,d){d.enqueue(u)}}),c=e.pipeThrough(l);return c.fileType=s,c}check(e,n){return hs(this.buffer,e,n)}checkString(e,n){return this.check(Aq(e),n)}async parse(e){if(this.buffer=new Uint8Array(R2),e.fileInfo.size===void 0&&(e.fileInfo.size=Number.MAX_SAFE_INTEGER),this.tokenizer=e,await e.peekBuffer(this.buffer,{length:12,mayBeLess:!0}),this.check([66,77]))return{ext:"bmp",mime:"image/bmp"};if(this.check([11,119]))return{ext:"ac3",mime:"audio/vnd.dolby.dd-raw"};if(this.check([120,1]))return{ext:"dmg",mime:"application/x-apple-diskimage"};if(this.check([77,90]))return{ext:"exe",mime:"application/x-msdownload"};if(this.check([37,33]))return await e.peekBuffer(this.buffer,{length:24,mayBeLess:!0}),this.checkString("PS-Adobe-",{offset:2})&&this.checkString(" EPSF-",{offset:14})?{ext:"eps",mime:"application/eps"}:{ext:"ps",mime:"application/postscript"};if(this.check([31,160])||this.check([31,157]))return{ext:"Z",mime:"application/x-compress"};if(this.check([199,113]))return{ext:"cpio",mime:"application/x-cpio"};if(this.check([96,234]))return{ext:"arj",mime:"application/x-arj"};if(this.check([239,187,191]))return this.tokenizer.ignore(3),this.parse(e);if(this.check([71,73,70]))return{ext:"gif",mime:"image/gif"};if(this.check([73,73,188]))return{ext:"jxr",mime:"image/vnd.ms-photo"};if(this.check([31,139,8]))return{ext:"gz",mime:"application/gzip"};if(this.check([66,90,104]))return{ext:"bz2",mime:"application/x-bzip2"};if(this.checkString("ID3")){await e.ignore(6);const n=await e.readToken(Fq);return e.position+n>e.fileInfo.size?{ext:"mp3",mime:"audio/mpeg"}:(await e.ignore(n),this.fromTokenizer(e))}if(this.checkString("MP+"))return{ext:"mpc",mime:"audio/x-musepack"};if((this.buffer[0]===67||this.buffer[0]===70)&&this.check([87,83],{offset:1}))return{ext:"swf",mime:"application/x-shockwave-flash"};if(this.check([255,216,255]))return this.check([247],{offset:3})?{ext:"jls",mime:"image/jls"}:{ext:"jpg",mime:"image/jpeg"};if(this.check([79,98,106,1]))return{ext:"avro",mime:"application/avro"};if(this.checkString("FLIF"))return{ext:"flif",mime:"image/flif"};if(this.checkString("8BPS"))return{ext:"psd",mime:"image/vnd.adobe.photoshop"};if(this.checkString("WEBP",{offset:8}))return{ext:"webp",mime:"image/webp"};if(this.checkString("MPCK"))return{ext:"mpc",mime:"audio/x-musepack"};if(this.checkString("FORM"))return{ext:"aif",mime:"audio/aiff"};if(this.checkString("icns",{offset:0}))return{ext:"icns",mime:"image/icns"};if(this.check([80,75,3,4])){try{for(;e.position+30<e.fileInfo.size;){await e.readBuffer(this.buffer,{length:30});const n=new DataView(this.buffer.buffer),r={compressedSize:n.getUint32(18,!0),uncompressedSize:n.getUint32(22,!0),filenameLength:n.getUint16(26,!0),extraFieldLength:n.getUint16(28,!0)};if(r.filename=await e.readToken(new le(r.filenameLength,"utf-8")),await e.ignore(r.extraFieldLength),r.filename==="META-INF/mozilla.rsa")return{ext:"xpi",mime:"application/x-xpinstall"};if(r.filename.endsWith(".rels")||r.filename.endsWith(".xml"))switch(r.filename.split("/")[0]){case"_rels":break;case"word":return{ext:"docx",mime:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"};case"ppt":return{ext:"pptx",mime:"application/vnd.openxmlformats-officedocument.presentationml.presentation"};case"xl":return{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"};case"visio":return{ext:"vsdx",mime:"application/vnd.visio"};default:break}if(r.filename.startsWith("xl/"))return{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"};if(r.filename.startsWith("3D/")&&r.filename.endsWith(".model"))return{ext:"3mf",mime:"model/3mf"};if(r.filename==="mimetype"&&r.compressedSize===r.uncompressedSize){let s=await e.readToken(new le(r.compressedSize,"utf-8"));switch(s=s.trim(),s){case"application/epub+zip":return{ext:"epub",mime:"application/epub+zip"};case"application/vnd.oasis.opendocument.text":return{ext:"odt",mime:"application/vnd.oasis.opendocument.text"};case"application/vnd.oasis.opendocument.spreadsheet":return{ext:"ods",mime:"application/vnd.oasis.opendocument.spreadsheet"};case"application/vnd.oasis.opendocument.presentation":return{ext:"odp",mime:"application/vnd.oasis.opendocument.presentation"};default:}}if(r.compressedSize===0){let s=-1;for(;s<0&&e.position<e.fileInfo.size;)await e.peekBuffer(this.buffer,{mayBeLess:!0}),s=VN(this.buffer,new Uint8Array([80,75,3,4])),await e.ignore(s>=0?s:this.buffer.length)}else await e.ignore(r.compressedSize)}}catch(n){if(!(n instanceof vt))throw n}return{ext:"zip",mime:"application/zip"}}if(this.checkString("OggS")){await e.ignore(28);const n=new Uint8Array(8);return await e.readBuffer(n),hs(n,[79,112,117,115,72,101,97,100])?{ext:"opus",mime:"audio/opus"}:hs(n,[128,116,104,101,111,114,97])?{ext:"ogv",mime:"video/ogg"}:hs(n,[1,118,105,100,101,111,0])?{ext:"ogm",mime:"video/ogg"}:hs(n,[127,70,76,65,67])?{ext:"oga",mime:"audio/ogg"}:hs(n,[83,112,101,101,120,32,32])?{ext:"spx",mime:"audio/ogg"}:hs(n,[1,118,111,114,98,105,115])?{ext:"ogg",mime:"audio/ogg"}:{ext:"ogx",mime:"application/ogg"}}if(this.check([80,75])&&(this.buffer[2]===3||this.buffer[2]===5||this.buffer[2]===7)&&(this.buffer[3]===4||this.buffer[3]===6||this.buffer[3]===8))return{ext:"zip",mime:"application/zip"};if(this.checkString("ftyp",{offset:4})&&this.buffer[8]&96){const n=new le(4,"latin1").get(this.buffer,8).replace("\0"," ").trim();switch(n){case"avif":case"avis":return{ext:"avif",mime:"image/avif"};case"mif1":return{ext:"heic",mime:"image/heif"};case"msf1":return{ext:"heic",mime:"image/heif-sequence"};case"heic":case"heix":return{ext:"heic",mime:"image/heic"};case"hevc":case"hevx":return{ext:"heic",mime:"image/heic-sequence"};case"qt":return{ext:"mov",mime:"video/quicktime"};case"M4V":case"M4VH":case"M4VP":return{ext:"m4v",mime:"video/x-m4v"};case"M4P":return{ext:"m4p",mime:"video/mp4"};case"M4B":return{ext:"m4b",mime:"audio/mp4"};case"M4A":return{ext:"m4a",mime:"audio/x-m4a"};case"F4V":return{ext:"f4v",mime:"video/mp4"};case"F4P":return{ext:"f4p",mime:"video/mp4"};case"F4A":return{ext:"f4a",mime:"audio/mp4"};case"F4B":return{ext:"f4b",mime:"audio/mp4"};case"crx":return{ext:"cr3",mime:"image/x-canon-cr3"};default:return n.startsWith("3g")?n.startsWith("3g2")?{ext:"3g2",mime:"video/3gpp2"}:{ext:"3gp",mime:"video/3gpp"}:{ext:"mp4",mime:"video/mp4"}}}if(this.checkString("MThd"))return{ext:"mid",mime:"audio/midi"};if(this.checkString("wOFF")&&(this.check([0,1,0,0],{offset:4})||this.checkString("OTTO",{offset:4})))return{ext:"woff",mime:"font/woff"};if(this.checkString("wOF2")&&(this.check([0,1,0,0],{offset:4})||this.checkString("OTTO",{offset:4})))return{ext:"woff2",mime:"font/woff2"};if(this.check([212,195,178,161])||this.check([161,178,195,212]))return{ext:"pcap",mime:"application/vnd.tcpdump.pcap"};if(this.checkString("DSD "))return{ext:"dsf",mime:"audio/x-dsf"};if(this.checkString("LZIP"))return{ext:"lz",mime:"application/x-lzip"};if(this.checkString("fLaC"))return{ext:"flac",mime:"audio/x-flac"};if(this.check([66,80,71,251]))return{ext:"bpg",mime:"image/bpg"};if(this.checkString("wvpk"))return{ext:"wv",mime:"audio/wavpack"};if(this.checkString("%PDF")){try{await e.ignore(1350);const n=10*1024*1024,r=new Uint8Array(Math.min(n,e.fileInfo.size));if(await e.readBuffer(r,{mayBeLess:!0}),Nq(r,new TextEncoder().encode("AIPrivateData")))return{ext:"ai",mime:"application/postscript"}}catch(n){if(!(n instanceof vt))throw n}return{ext:"pdf",mime:"application/pdf"}}if(this.check([0,97,115,109]))return{ext:"wasm",mime:"application/wasm"};if(this.check([73,73])){const n=await this.readTiffHeader(!1);if(n)return n}if(this.check([77,77])){const n=await this.readTiffHeader(!0);if(n)return n}if(this.checkString("MAC "))return{ext:"ape",mime:"audio/ape"};if(this.check([26,69,223,163])){async function n(){const l=await e.peekNumber(Te);let c=128,u=0;for(;!(l&c)&&c!==0;)++u,c>>=1;const d=new Uint8Array(u+1);return await e.readBuffer(d),d}async function r(){const l=await n(),c=await n();c[0]^=128>>c.length-1;const u=Math.min(6,c.length),d=new DataView(l.buffer),m=new DataView(c.buffer,c.length-u,u);return{id:C2(d),len:C2(m)}}async function s(l){for(;l>0;){const c=await r();if(c.id===17026)return(await e.readToken(new le(c.len))).replaceAll(/\00.*$/g,"");await e.ignore(c.len),--l}}const i=await r();switch(await s(i.len)){case"webm":return{ext:"webm",mime:"video/webm"};case"matroska":return{ext:"mkv",mime:"video/x-matroska"};default:return}}if(this.check([82,73,70,70])){if(this.check([65,86,73],{offset:8}))return{ext:"avi",mime:"video/vnd.avi"};if(this.check([87,65,86,69],{offset:8}))return{ext:"wav",mime:"audio/wav"};if(this.check([81,76,67,77],{offset:8}))return{ext:"qcp",mime:"audio/qcelp"}}if(this.checkString("SQLi"))return{ext:"sqlite",mime:"application/x-sqlite3"};if(this.check([78,69,83,26]))return{ext:"nes",mime:"application/x-nintendo-nes-rom"};if(this.checkString("Cr24"))return{ext:"crx",mime:"application/x-google-chrome-extension"};if(this.checkString("MSCF")||this.checkString("ISc("))return{ext:"cab",mime:"application/vnd.ms-cab-compressed"};if(this.check([237,171,238,219]))return{ext:"rpm",mime:"application/x-rpm"};if(this.check([197,208,211,198]))return{ext:"eps",mime:"application/eps"};if(this.check([40,181,47,253]))return{ext:"zst",mime:"application/zstd"};if(this.check([127,69,76,70]))return{ext:"elf",mime:"application/x-elf"};if(this.check([33,66,68,78]))return{ext:"pst",mime:"application/vnd.ms-outlook"};if(this.checkString("PAR1"))return{ext:"parquet",mime:"application/x-parquet"};if(this.check([207,250,237,254]))return{ext:"macho",mime:"application/x-mach-binary"};if(this.check([79,84,84,79,0]))return{ext:"otf",mime:"font/otf"};if(this.checkString("#!AMR"))return{ext:"amr",mime:"audio/amr"};if(this.checkString("{\\rtf"))return{ext:"rtf",mime:"application/rtf"};if(this.check([70,76,86,1]))return{ext:"flv",mime:"video/x-flv"};if(this.checkString("IMPM"))return{ext:"it",mime:"audio/x-it"};if(this.checkString("-lh0-",{offset:2})||this.checkString("-lh1-",{offset:2})||this.checkString("-lh2-",{offset:2})||this.checkString("-lh3-",{offset:2})||this.checkString("-lh4-",{offset:2})||this.checkString("-lh5-",{offset:2})||this.checkString("-lh6-",{offset:2})||this.checkString("-lh7-",{offset:2})||this.checkString("-lzs-",{offset:2})||this.checkString("-lz4-",{offset:2})||this.checkString("-lz5-",{offset:2})||this.checkString("-lhd-",{offset:2}))return{ext:"lzh",mime:"application/x-lzh-compressed"};if(this.check([0,0,1,186])){if(this.check([33],{offset:4,mask:[241]}))return{ext:"mpg",mime:"video/MP1S"};if(this.check([68],{offset:4,mask:[196]}))return{ext:"mpg",mime:"video/MP2P"}}if(this.checkString("ITSF"))return{ext:"chm",mime:"application/vnd.ms-htmlhelp"};if(this.check([202,254,186,190]))return{ext:"class",mime:"application/java-vm"};if(this.check([253,55,122,88,90,0]))return{ext:"xz",mime:"application/x-xz"};if(this.checkString("<?xml "))return{ext:"xml",mime:"application/xml"};if(this.check([55,122,188,175,39,28]))return{ext:"7z",mime:"application/x-7z-compressed"};if(this.check([82,97,114,33,26,7])&&(this.buffer[6]===0||this.buffer[6]===1))return{ext:"rar",mime:"application/x-rar-compressed"};if(this.checkString("solid "))return{ext:"stl",mime:"model/stl"};if(this.checkString("AC")){const n=new le(4,"latin1").get(this.buffer,2);if(n.match("^d*")&&n>=1e3&&n<=1050)return{ext:"dwg",mime:"image/vnd.dwg"}}if(this.checkString("070707"))return{ext:"cpio",mime:"application/x-cpio"};if(this.checkString("BLENDER"))return{ext:"blend",mime:"application/x-blender"};if(this.checkString("!<arch>"))return await e.ignore(8),await e.readToken(new le(13,"ascii"))==="debian-binary"?{ext:"deb",mime:"application/x-deb"}:{ext:"ar",mime:"application/x-unix-archive"};if(this.checkString("**ACE",{offset:7})&&(await e.peekBuffer(this.buffer,{length:14,mayBeLess:!0}),this.checkString("**",{offset:12})))return{ext:"ace",mime:"application/x-ace-compressed"};if(this.check([137,80,78,71,13,10,26,10])){await e.ignore(8);async function n(){return{length:await e.readToken(pr),type:await e.readToken(new le(4,"latin1"))}}do{const r=await n();if(r.length<0)return;switch(r.type){case"IDAT":return{ext:"png",mime:"image/png"};case"acTL":return{ext:"apng",mime:"image/apng"};default:await e.ignore(r.length+4)}}while(e.position+8<e.fileInfo.size);return{ext:"png",mime:"image/png"}}if(this.check([65,82,82,79,87,49,0,0]))return{ext:"arrow",mime:"application/x-apache-arrow"};if(this.check([103,108,84,70,2,0,0,0]))return{ext:"glb",mime:"model/gltf-binary"};if(this.check([102,114,101,101],{offset:4})||this.check([109,100,97,116],{offset:4})||this.check([109,111,111,118],{offset:4})||this.check([119,105,100,101],{offset:4}))return{ext:"mov",mime:"video/quicktime"};if(this.check([73,73,82,79,8,0,0,0,24]))return{ext:"orf",mime:"image/x-olympus-orf"};if(this.checkString("gimp xcf "))return{ext:"xcf",mime:"image/x-xcf"};if(this.check([73,73,85,0,24,0,0,0,136,231,116,216]))return{ext:"rw2",mime:"image/x-panasonic-rw2"};if(this.check([48,38,178,117,142,102,207,17,166,217])){async function n(){const r=new Uint8Array(16);return await e.readBuffer(r),{id:r,size:Number(await e.readToken(Nn))}}for(await e.ignore(30);e.position+24<e.fileInfo.size;){const r=await n();let s=r.size-24;if(hs(r.id,[145,7,220,183,183,169,207,17,142,230,0,192,12,32,83,101])){const i=new Uint8Array(16);if(s-=await e.readBuffer(i),hs(i,[64,158,105,248,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"audio/x-ms-asf"};if(hs(i,[192,239,25,188,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"video/x-ms-asf"};break}await e.ignore(s)}return{ext:"asf",mime:"application/vnd.ms-asf"}}if(this.check([171,75,84,88,32,49,49,187,13,10,26,10]))return{ext:"ktx",mime:"image/ktx"};if((this.check([126,16,4])||this.check([126,24,4]))&&this.check([48,77,73,69],{offset:4}))return{ext:"mie",mime:"application/x-mie"};if(this.check([39,10,0,0,0,0,0,0,0,0,0,0],{offset:2}))return{ext:"shp",mime:"application/x-esri-shape"};if(this.check([255,79,255,81]))return{ext:"j2c",mime:"image/j2c"};if(this.check([0,0,0,12,106,80,32,32,13,10,135,10]))switch(await e.ignore(20),await e.readToken(new le(4,"ascii"))){case"jp2 ":return{ext:"jp2",mime:"image/jp2"};case"jpx ":return{ext:"jpx",mime:"image/jpx"};case"jpm ":return{ext:"jpm",mime:"image/jpm"};case"mjp2":return{ext:"mj2",mime:"image/mj2"};default:return}if(this.check([255,10])||this.check([0,0,0,12,74,88,76,32,13,10,135,10]))return{ext:"jxl",mime:"image/jxl"};if(this.check([254,255]))return this.check([0,60,0,63,0,120,0,109,0,108],{offset:2})?{ext:"xml",mime:"application/xml"}:void 0;if(this.check([0,0,1,186])||this.check([0,0,1,179]))return{ext:"mpg",mime:"video/mpeg"};if(this.check([0,1,0,0,0]))return{ext:"ttf",mime:"font/ttf"};if(this.check([0,0,1,0]))return{ext:"ico",mime:"image/x-icon"};if(this.check([0,0,2,0]))return{ext:"cur",mime:"image/x-icon"};if(this.check([208,207,17,224,161,177,26,225]))return{ext:"cfb",mime:"application/x-cfb"};if(await e.peekBuffer(this.buffer,{length:Math.min(256,e.fileInfo.size),mayBeLess:!0}),this.check([97,99,115,112],{offset:36}))return{ext:"icc",mime:"application/vnd.iccprofile"};if(this.checkString("BEGIN:")){if(this.checkString("VCARD",{offset:6}))return{ext:"vcf",mime:"text/vcard"};if(this.checkString("VCALENDAR",{offset:6}))return{ext:"ics",mime:"text/calendar"}}if(this.checkString("FUJIFILMCCD-RAW"))return{ext:"raf",mime:"image/x-fujifilm-raf"};if(this.checkString("Extended Module:"))return{ext:"xm",mime:"audio/x-xm"};if(this.checkString("Creative Voice File"))return{ext:"voc",mime:"audio/x-voc"};if(this.check([4,0,0,0])&&this.buffer.length>=16){const n=new DataView(this.buffer.buffer).getUint32(12,!0);if(n>12&&this.buffer.length>=n+16)try{const r=new TextDecoder().decode(this.buffer.slice(16,n+16));if(JSON.parse(r).files)return{ext:"asar",mime:"application/x-asar"}}catch{}}if(this.check([6,14,43,52,2,5,1,1,13,1,2,1,1,2]))return{ext:"mxf",mime:"application/mxf"};if(this.checkString("SCRM",{offset:44}))return{ext:"s3m",mime:"audio/x-s3m"};if(this.check([71])&&this.check([71],{offset:188}))return{ext:"mts",mime:"video/mp2t"};if(this.check([71],{offset:4})&&this.check([71],{offset:196}))return{ext:"mts",mime:"video/mp2t"};if(this.check([66,79,79,75,77,79,66,73],{offset:60}))return{ext:"mobi",mime:"application/x-mobipocket-ebook"};if(this.check([68,73,67,77],{offset:128}))return{ext:"dcm",mime:"application/dicom"};if(this.check([76,0,0,0,1,20,2,0,0,0,0,0,192,0,0,0,0,0,0,70]))return{ext:"lnk",mime:"application/x.ms.shortcut"};if(this.check([98,111,111,107,0,0,0,0,109,97,114,107,0,0,0,0]))return{ext:"alias",mime:"application/x.apple.alias"};if(this.checkString("Kaydara FBX Binary  \0"))return{ext:"fbx",mime:"application/x.autodesk.fbx"};if(this.check([76,80],{offset:34})&&(this.check([0,0,1],{offset:8})||this.check([1,0,2],{offset:8})||this.check([2,0,2],{offset:8})))return{ext:"eot",mime:"application/vnd.ms-fontobject"};if(this.check([6,6,237,245,216,29,70,229,189,49,239,231,254,116,183,29]))return{ext:"indd",mime:"application/x-indesign"};if(await e.peekBuffer(this.buffer,{length:Math.min(512,e.fileInfo.size),mayBeLess:!0}),Pq(this.buffer))return{ext:"tar",mime:"application/x-tar"};if(this.check([255,254]))return this.check([60,0,63,0,120,0,109,0,108,0],{offset:2})?{ext:"xml",mime:"application/xml"}:this.check([255,14,83,0,107,0,101,0,116,0,99,0,104,0,85,0,112,0,32,0,77,0,111,0,100,0,101,0,108,0],{offset:2})?{ext:"skp",mime:"application/vnd.sketchup.skp"}:void 0;if(this.checkString("-----BEGIN PGP MESSAGE-----"))return{ext:"pgp",mime:"application/pgp-encrypted"};if(this.buffer.length>=2&&this.check([255,224],{offset:0,mask:[255,224]})){if(this.check([16],{offset:1,mask:[22]}))return this.check([8],{offset:1,mask:[8]})?{ext:"aac",mime:"audio/aac"}:{ext:"aac",mime:"audio/aac"};if(this.check([2],{offset:1,mask:[6]}))return{ext:"mp3",mime:"audio/mpeg"};if(this.check([4],{offset:1,mask:[6]}))return{ext:"mp2",mime:"audio/mpeg"};if(this.check([6],{offset:1,mask:[6]}))return{ext:"mp1",mime:"audio/mpeg"}}}async readTiffTag(e){const n=await this.tokenizer.readToken(e?We:Ue);switch(this.tokenizer.ignore(10),n){case 50341:return{ext:"arw",mime:"image/x-sony-arw"};case 50706:return{ext:"dng",mime:"image/x-adobe-dng"}}}async readTiffIFD(e){const n=await this.tokenizer.readToken(e?We:Ue);for(let r=0;r<n;++r){const s=await this.readTiffTag(e);if(s)return s}}async readTiffHeader(e){const n=(e?We:Ue).get(this.buffer,2),r=(e?de:ie).get(this.buffer,4);if(n===42){if(r>=6){if(this.checkString("CR",{offset:8}))return{ext:"cr2",mime:"image/x-canon-cr2"};if(r>=8&&(this.check([28,0,254,0],{offset:8})||this.check([31,0,11,0],{offset:8})))return{ext:"nef",mime:"image/x-nikon-nef"}}return await this.tokenizer.ignore(r),await this.readTiffIFD(e)??{ext:"tif",mime:"image/tiff"}}if(n===43)return{ext:"tif",mime:"image/tiff"}}}new Set(Mq);new Set(Dq);var Jw={};/*!
 * content-type
 * Copyright(c) 2015 Douglas Christopher Wilson
 * MIT Licensed
 */var N2=/; *([!#$%&'*+.^_`|~0-9A-Za-z-]+) *= *("(?:[\u000b\u0020\u0021\u0023-\u005b\u005d-\u007e\u0080-\u00ff]|\\[\u000b\u0020-\u00ff])*"|[!#$%&'*+.^_`|~0-9A-Za-z-]+) */g,Oq=/^[\u000b\u0020-\u007e\u0080-\u00ff]+$/,HN=/^[!#$%&'*+.^_`|~0-9A-Za-z-]+$/,$q=/\\([\u000b\u0020-\u00ff])/g,zq=/([\\"])/g,GN=/^[!#$%&'*+.^_`|~0-9A-Za-z-]+\/[!#$%&'*+.^_`|~0-9A-Za-z-]+$/;Jw.format=Bq;Jw.parse=Vq;function Bq(t){if(!t||typeof t!="object")throw new TypeError("argument obj is required");var e=t.parameters,n=t.type;if(!n||!GN.test(n))throw new TypeError("invalid type");var r=n;if(e&&typeof e=="object")for(var s,i=Object.keys(e).sort(),o=0;o<i.length;o++){if(s=i[o],!HN.test(s))throw new TypeError("invalid parameter name");r+="; "+s+"="+Hq(e[s])}return r}function Vq(t){if(!t)throw new TypeError("argument string is required");var e=typeof t=="object"?Uq(t):t;if(typeof e!="string")throw new TypeError("argument string is required to be a string");var n=e.indexOf(";"),r=n!==-1?e.slice(0,n).trim():e.trim();if(!GN.test(r))throw new TypeError("invalid media type");var s=new Gq(r.toLowerCase());if(n!==-1){var i,o,l;for(N2.lastIndex=n;o=N2.exec(e);){if(o.index!==n)throw new TypeError("invalid parameter format");n+=o[0].length,i=o[1].toLowerCase(),l=o[2],l.charCodeAt(0)===34&&(l=l.slice(1,-1),l.indexOf("\\")!==-1&&(l=l.replace($q,"$1"))),s.parameters[i]=l}if(n!==e.length)throw new TypeError("invalid parameter format")}return s}function Uq(t){var e;if(typeof t.getHeader=="function"?e=t.getHeader("content-type"):typeof t.headers=="object"&&(e=t.headers&&t.headers["content-type"]),typeof e!="string")throw new TypeError("content-type header is missing from object");return e}function Hq(t){var e=String(t);if(HN.test(e))return e;if(e.length>0&&!Oq.test(e))throw new TypeError("invalid parameter value");return'"'+e.replace(zq,"\\$1")+'"'}function Gq(t){this.parameters=Object.create(null),this.type=t}/*!
 * media-typer
 * Copyright(c) 2014-2017 Douglas Christopher Wilson
 * MIT Licensed
 */var Wq=/^ *([A-Za-z0-9][A-Za-z0-9!#$&^_-]{0,126})\/([A-Za-z0-9][A-Za-z0-9!#$&^_.+-]{0,126}) *$/,qq=Kq;function Kq(t){if(!t)throw new TypeError("argument string is required");if(typeof t!="string")throw new TypeError("argument string is required to be a string");var e=Wq.exec(t.toLowerCase());if(!e)throw new TypeError("invalid media type");var n=e[1],r=e[2],s,i=r.lastIndexOf("+");return i!==-1&&(s=r.substr(i+1),r=r.substr(0,i)),new Qq(n,r,s)}function Qq(t,e,n){this.type=t,this.subtype=e,this.suffix=n}var Jx={exports:{}},Kg,A2;function Xq(){if(A2)return Kg;A2=1;var t=1e3,e=t*60,n=e*60,r=n*24,s=r*7,i=r*365.25;Kg=function(d,m){m=m||{};var p=typeof d;if(p==="string"&&d.length>0)return o(d);if(p==="number"&&isFinite(d))return m.long?c(d):l(d);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(d))};function o(d){if(d=String(d),!(d.length>100)){var m=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(d);if(m){var p=parseFloat(m[1]),g=(m[2]||"ms").toLowerCase();switch(g){case"years":case"year":case"yrs":case"yr":case"y":return p*i;case"weeks":case"week":case"w":return p*s;case"days":case"day":case"d":return p*r;case"hours":case"hour":case"hrs":case"hr":case"h":return p*n;case"minutes":case"minute":case"mins":case"min":case"m":return p*e;case"seconds":case"second":case"secs":case"sec":case"s":return p*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return p;default:return}}}}function l(d){var m=Math.abs(d);return m>=r?Math.round(d/r)+"d":m>=n?Math.round(d/n)+"h":m>=e?Math.round(d/e)+"m":m>=t?Math.round(d/t)+"s":d+"ms"}function c(d){var m=Math.abs(d);return m>=r?u(d,m,r,"day"):m>=n?u(d,m,n,"hour"):m>=e?u(d,m,e,"minute"):m>=t?u(d,m,t,"second"):d+" ms"}function u(d,m,p,g){var x=m>=p*1.5;return Math.round(d/p)+" "+g+(x?"s":"")}return Kg}function Yq(t){n.debug=n,n.default=n,n.coerce=c,n.disable=i,n.enable=s,n.enabled=o,n.humanize=Xq(),n.destroy=u,Object.keys(t).forEach(d=>{n[d]=t[d]}),n.names=[],n.skips=[],n.formatters={};function e(d){let m=0;for(let p=0;p<d.length;p++)m=(m<<5)-m+d.charCodeAt(p),m|=0;return n.colors[Math.abs(m)%n.colors.length]}n.selectColor=e;function n(d){let m,p=null,g,x;function w(...v){if(!w.enabled)return;const S=w,_=Number(new Date),E=_-(m||_);S.diff=E,S.prev=m,S.curr=_,m=_,v[0]=n.coerce(v[0]),typeof v[0]!="string"&&v.unshift("%O");let I=0;v[0]=v[0].replace(/%([a-zA-Z%])/g,(F,k)=>{if(F==="%%")return"%";I++;const j=n.formatters[k];if(typeof j=="function"){const C=v[I];F=j.call(S,C),v.splice(I,1),I--}return F}),n.formatArgs.call(S,v),(S.log||n.log).apply(S,v)}return w.namespace=d,w.useColors=n.useColors(),w.color=n.selectColor(d),w.extend=r,w.destroy=n.destroy,Object.defineProperty(w,"enabled",{enumerable:!0,configurable:!1,get:()=>p!==null?p:(g!==n.namespaces&&(g=n.namespaces,x=n.enabled(d)),x),set:v=>{p=v}}),typeof n.init=="function"&&n.init(w),w}function r(d,m){const p=n(this.namespace+(typeof m>"u"?":":m)+d);return p.log=this.log,p}function s(d){n.save(d),n.namespaces=d,n.names=[],n.skips=[];let m;const p=(typeof d=="string"?d:"").split(/[\s,]+/),g=p.length;for(m=0;m<g;m++)p[m]&&(d=p[m].replace(/\*/g,".*?"),d[0]==="-"?n.skips.push(new RegExp("^"+d.slice(1)+"$")):n.names.push(new RegExp("^"+d+"$")))}function i(){const d=[...n.names.map(l),...n.skips.map(l).map(m=>"-"+m)].join(",");return n.enable(""),d}function o(d){if(d[d.length-1]==="*")return!0;let m,p;for(m=0,p=n.skips.length;m<p;m++)if(n.skips[m].test(d))return!1;for(m=0,p=n.names.length;m<p;m++)if(n.names[m].test(d))return!0;return!1}function l(d){return d.toString().substring(2,d.toString().length-2).replace(/\.\*\?$/,"*")}function c(d){return d instanceof Error?d.stack||d.message:d}function u(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return n.enable(n.load()),n}var Jq=Yq;(function(t,e){e.formatArgs=r,e.save=s,e.load=i,e.useColors=n,e.storage=o(),e.destroy=(()=>{let c=!1;return()=>{c||(c=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function n(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function r(c){if(c[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+c[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;const u="color: "+this.color;c.splice(1,0,u,"color: inherit");let d=0,m=0;c[0].replace(/%[a-zA-Z%]/g,p=>{p!=="%%"&&(d++,p==="%c"&&(m=d))}),c.splice(m,0,u)}e.log=console.debug||console.log||(()=>{});function s(c){try{c?e.storage.setItem("debug",c):e.storage.removeItem("debug")}catch{}}function i(){let c;try{c=e.storage.getItem("debug")}catch{}return!c&&typeof process<"u"&&"env"in process&&(c={}.DEBUG),c}function o(){try{return localStorage}catch{}}t.exports=Jq(e);const{formatters:l}=t.exports;l.j=function(c){try{return JSON.stringify(c)}catch(u){return"[UnexpectedJSONParseError]: "+u.message}}})(Jx,Jx.exports);var Zq=Jx.exports;const Qe=wE(Zq);var Zx;(function(t){t[t.shot=10]="shot",t[t.scene=20]="scene",t[t.track=30]="track",t[t.part=40]="part",t[t.album=50]="album",t[t.edition=60]="edition",t[t.collection=70]="collection"})(Zx||(Zx={}));var Za;(function(t){t[t.video=1]="video",t[t.audio=2]="audio",t[t.complex=3]="complex",t[t.logo=4]="logo",t[t.subtitle=17]="subtitle",t[t.button=18]="button",t[t.control=32]="control"})(Za||(Za={}));function pt(t,e,n){return(t[e]&1<<n)!==0}function sr(t,e,n,r){let s=e;if(r==="utf-16le"){for(;t[s]!==0||t[s+1]!==0;){if(s>=n)return n;s+=2}return s}for(;t[s]!==0;){if(s>=n)return n;s++}return s}function WN(t){const e=t.indexOf("\0");return e===-1?t:t.substr(0,e)}function eK(t){const e=t.length;if(e&1)throw new Error("Buffer length must be even");for(let n=0;n<e;n+=2){const r=t[n];t[n]=t[n+1],t[n+1]=r}return t}function At(t,e){if(t[0]===255&&t[1]===254)return At(t.subarray(2),e);if(e==="utf-16le"&&t[0]===254&&t[1]===255){if(t.length&1)throw new Error("Expected even number of octets for 16-bit unicode string");return At(eK(t),e)}return new le(t.length,e).get(t,0)}function Ni(t){return t=t.replace(/^\x00+/g,""),t=t.replace(/\x00+$/g,""),t}function Me(t,e,n,r){const s=e+~~(n/8),i=n%8;let o=t[s];o&=255>>i;const l=8-i,c=r-l;return c<0?o>>=8-i-r:c>0&&(o<<=c,o|=Me(t,e,n+l,c)),o}function cr(t,e,n){return Me(t,e,n,1)===1}function tK(t){const e=[];for(let n=0,r=t.length;n<r;n++){const s=Number(t.charCodeAt(n)).toString(16);e.push(s.length===1?`0${s}`:s)}return e.join(" ")}function nK(t){return 10*Math.log10(t)}function rK(t){return 10**(t/10)}function sK(t){const e=t.split(" ").map(n=>n.trim().toLowerCase());if(e.length>=1){const n=Number.parseFloat(e[0]);return e.length===2&&e[1]==="db"?{dB:n,ratio:rK(n)}:{dB:nK(n),ratio:n}}}var ju;(function(t){t[t.Other=0]="Other",t[t["32x32 pixels 'file icon' (PNG only)"]=1]="32x32 pixels 'file icon' (PNG only)",t[t["Other file icon"]=2]="Other file icon",t[t["Cover (front)"]=3]="Cover (front)",t[t["Cover (back)"]=4]="Cover (back)",t[t["Leaflet page"]=5]="Leaflet page",t[t["Media (e.g. label side of CD)"]=6]="Media (e.g. label side of CD)",t[t["Lead artist/lead performer/soloist"]=7]="Lead artist/lead performer/soloist",t[t["Artist/performer"]=8]="Artist/performer",t[t.Conductor=9]="Conductor",t[t["Band/Orchestra"]=10]="Band/Orchestra",t[t.Composer=11]="Composer",t[t["Lyricist/text writer"]=12]="Lyricist/text writer",t[t["Recording Location"]=13]="Recording Location",t[t["During recording"]=14]="During recording",t[t["During performance"]=15]="During performance",t[t["Movie/video screen capture"]=16]="Movie/video screen capture",t[t["A bright coloured fish"]=17]="A bright coloured fish",t[t.Illustration=18]="Illustration",t[t["Band/artist logotype"]=19]="Band/artist logotype",t[t["Publisher/Studio logotype"]=20]="Publisher/Studio logotype"})(ju||(ju={}));var P2;(function(t){t[t.other=0]="other",t[t.lyrics=1]="lyrics",t[t.text=2]="text",t[t.movement_part=3]="movement_part",t[t.events=4]="events",t[t.chord=5]="chord",t[t.trivia_pop=6]="trivia_pop"})(P2||(P2={}));var F2;(function(t){t[t.notSynchronized0=0]="notSynchronized0",t[t.mpegFrameNumber=1]="mpegFrameNumber",t[t.milliseconds=2]="milliseconds"})(F2||(F2={}));const qN={get:(t,e)=>t[e+3]&127|t[e+2]<<7|t[e+1]<<14|t[e]<<21,len:4},ey={len:10,get:(t,e)=>({fileIdentifier:new le(3,"ascii").get(t,e),version:{major:Eu.get(t,e+3),revision:Eu.get(t,e+4)},flags:{unsynchronisation:pt(t,e+5,7),isExtendedHeader:pt(t,e+5,6),expIndicator:pt(t,e+5,5),footer:pt(t,e+5,4)},size:qN.get(t,e+6)})},M2={len:10,get:(t,e)=>({size:de.get(t,e),extendedFlags:We.get(t,e+4),sizeOfPadding:de.get(t,e+6),crcDataPresent:pt(t,e+4,31)})},KN={len:1,get:(t,e)=>{switch(t[e]){case 0:return{encoding:"latin1"};case 1:return{encoding:"utf-16le",bom:!0};case 2:return{encoding:"utf-16le",bom:!1};case 3:return{encoding:"utf8",bom:!1};default:return{encoding:"utf8",bom:!1}}}},ty={len:4,get:(t,e)=>({encoding:KN.get(t,e),language:new le(3,"latin1").get(t,e+1)})},D2={len:6,get:(t,e)=>{const n=ty.get(t,e);return{encoding:n.encoding,language:n.language,timeStampFormat:Te.get(t,e+4),contentType:Te.get(t,e+5)}}},Vf={year:{multiple:!1},track:{multiple:!1},disk:{multiple:!1},title:{multiple:!1},artist:{multiple:!1},artists:{multiple:!0,unique:!0},albumartist:{multiple:!1},album:{multiple:!1},date:{multiple:!1},originaldate:{multiple:!1},originalyear:{multiple:!1},releasedate:{multiple:!1},comment:{multiple:!0,unique:!1},genre:{multiple:!0,unique:!0},picture:{multiple:!0,unique:!0},composer:{multiple:!0,unique:!0},lyrics:{multiple:!0,unique:!1},albumsort:{multiple:!1,unique:!0},titlesort:{multiple:!1,unique:!0},work:{multiple:!1,unique:!0},artistsort:{multiple:!1,unique:!0},albumartistsort:{multiple:!1,unique:!0},composersort:{multiple:!1,unique:!0},lyricist:{multiple:!0,unique:!0},writer:{multiple:!0,unique:!0},conductor:{multiple:!0,unique:!0},remixer:{multiple:!0,unique:!0},arranger:{multiple:!0,unique:!0},engineer:{multiple:!0,unique:!0},producer:{multiple:!0,unique:!0},technician:{multiple:!0,unique:!0},djmixer:{multiple:!0,unique:!0},mixer:{multiple:!0,unique:!0},label:{multiple:!0,unique:!0},grouping:{multiple:!1},subtitle:{multiple:!0},discsubtitle:{multiple:!1},totaltracks:{multiple:!1},totaldiscs:{multiple:!1},compilation:{multiple:!1},rating:{multiple:!0},bpm:{multiple:!1},mood:{multiple:!1},media:{multiple:!1},catalognumber:{multiple:!0,unique:!0},tvShow:{multiple:!1},tvShowSort:{multiple:!1},tvSeason:{multiple:!1},tvEpisode:{multiple:!1},tvEpisodeId:{multiple:!1},tvNetwork:{multiple:!1},podcast:{multiple:!1},podcasturl:{multiple:!1},releasestatus:{multiple:!1},releasetype:{multiple:!0},releasecountry:{multiple:!1},script:{multiple:!1},language:{multiple:!1},copyright:{multiple:!1},license:{multiple:!1},encodedby:{multiple:!1},encodersettings:{multiple:!1},gapless:{multiple:!1},barcode:{multiple:!1},isrc:{multiple:!0},asin:{multiple:!1},musicbrainz_recordingid:{multiple:!1},musicbrainz_trackid:{multiple:!1},musicbrainz_albumid:{multiple:!1},musicbrainz_artistid:{multiple:!0},musicbrainz_albumartistid:{multiple:!0},musicbrainz_releasegroupid:{multiple:!1},musicbrainz_workid:{multiple:!1},musicbrainz_trmid:{multiple:!1},musicbrainz_discid:{multiple:!1},acoustid_id:{multiple:!1},acoustid_fingerprint:{multiple:!1},musicip_puid:{multiple:!1},musicip_fingerprint:{multiple:!1},website:{multiple:!1},"performer:instrument":{multiple:!0,unique:!0},averageLevel:{multiple:!1},peakLevel:{multiple:!1},notes:{multiple:!0,unique:!1},key:{multiple:!1},originalalbum:{multiple:!1},originalartist:{multiple:!1},discogs_artist_id:{multiple:!0,unique:!0},discogs_release_id:{multiple:!1},discogs_label_id:{multiple:!1},discogs_master_release_id:{multiple:!1},discogs_votes:{multiple:!1},discogs_rating:{multiple:!1},replaygain_track_peak:{multiple:!1},replaygain_track_gain:{multiple:!1},replaygain_album_peak:{multiple:!1},replaygain_album_gain:{multiple:!1},replaygain_track_minmax:{multiple:!1},replaygain_album_minmax:{multiple:!1},replaygain_undo:{multiple:!1},description:{multiple:!0},longDescription:{multiple:!1},category:{multiple:!0},hdVideo:{multiple:!1},keywords:{multiple:!0},movement:{multiple:!1},movementIndex:{multiple:!1},movementTotal:{multiple:!1},podcastId:{multiple:!1},showMovement:{multiple:!1},stik:{multiple:!1}};function iK(t){return Vf[t]&&!Vf[t].multiple}function aK(t){return!Vf[t].multiple||Vf[t].unique||!1}class hr{static toIntOrNull(e){const n=Number.parseInt(e,10);return Number.isNaN(n)?null:n}static normalizeTrack(e){const n=e.toString().split("/");return{no:Number.parseInt(n[0],10)||null,of:Number.parseInt(n[1],10)||null}}constructor(e,n){this.tagTypes=e,this.tagMap=n}mapGenericTag(e,n){e={id:e.id,value:e.value},this.postMap(e,n);const r=this.getCommonName(e.id);return r?{id:r,value:e.value}:null}getCommonName(e){return this.tagMap[e]}postMap(e,n){}}hr.maxRatingScore=1;const oK={title:"title",artist:"artist",album:"album",year:"year",comment:"comment",track:"track",genre:"genre"};class lK extends hr{constructor(){super(["ID3v1"],oK)}}class ud extends hr{constructor(e,n){const r={};for(const s of Object.keys(n))r[s.toUpperCase()]=n[s];super(e,r)}getCommonName(e){return this.tagMap[e.toUpperCase()]}}const cK={TIT2:"title",TPE1:"artist","TXXX:Artists":"artists",TPE2:"albumartist",TALB:"album",TDRV:"date",TORY:"originalyear",TPOS:"disk",TCON:"genre",APIC:"picture",TCOM:"composer",USLT:"lyrics",TSOA:"albumsort",TSOT:"titlesort",TOAL:"originalalbum",TSOP:"artistsort",TSO2:"albumartistsort",TSOC:"composersort",TEXT:"lyricist","TXXX:Writer":"writer",TPE3:"conductor",TPE4:"remixer","IPLS:arranger":"arranger","IPLS:engineer":"engineer","IPLS:producer":"producer","IPLS:DJ-mix":"djmixer","IPLS:mix":"mixer",TPUB:"label",TIT1:"grouping",TIT3:"subtitle",TRCK:"track",TCMP:"compilation",POPM:"rating",TBPM:"bpm",TMED:"media","TXXX:CATALOGNUMBER":"catalognumber","TXXX:MusicBrainz Album Status":"releasestatus","TXXX:MusicBrainz Album Type":"releasetype","TXXX:MusicBrainz Album Release Country":"releasecountry","TXXX:RELEASECOUNTRY":"releasecountry","TXXX:SCRIPT":"script",TLAN:"language",TCOP:"copyright",WCOP:"license",TENC:"encodedby",TSSE:"encodersettings","TXXX:BARCODE":"barcode","TXXX:ISRC":"isrc",TSRC:"isrc","TXXX:ASIN":"asin","TXXX:originalyear":"originalyear","UFID:http://musicbrainz.org":"musicbrainz_recordingid","TXXX:MusicBrainz Release Track Id":"musicbrainz_trackid","TXXX:MusicBrainz Album Id":"musicbrainz_albumid","TXXX:MusicBrainz Artist Id":"musicbrainz_artistid","TXXX:MusicBrainz Album Artist Id":"musicbrainz_albumartistid","TXXX:MusicBrainz Release Group Id":"musicbrainz_releasegroupid","TXXX:MusicBrainz Work Id":"musicbrainz_workid","TXXX:MusicBrainz TRM Id":"musicbrainz_trmid","TXXX:MusicBrainz Disc Id":"musicbrainz_discid","TXXX:ACOUSTID_ID":"acoustid_id","TXXX:Acoustid Id":"acoustid_id","TXXX:Acoustid Fingerprint":"acoustid_fingerprint","TXXX:MusicIP PUID":"musicip_puid","TXXX:MusicMagic Fingerprint":"musicip_fingerprint",WOAR:"website",TDRC:"date",TYER:"year",TDOR:"originaldate","TIPL:arranger":"arranger","TIPL:engineer":"engineer","TIPL:producer":"producer","TIPL:DJ-mix":"djmixer","TIPL:mix":"mixer",TMOO:"mood",SYLT:"lyrics",TSST:"discsubtitle",TKEY:"key",COMM:"comment",TOPE:"originalartist","PRIV:AverageLevel":"averageLevel","PRIV:PeakLevel":"peakLevel","TXXX:DISCOGS_ARTIST_ID":"discogs_artist_id","TXXX:DISCOGS_ARTISTS":"artists","TXXX:DISCOGS_ARTIST_NAME":"artists","TXXX:DISCOGS_ALBUM_ARTISTS":"albumartist","TXXX:DISCOGS_CATALOG":"catalognumber","TXXX:DISCOGS_COUNTRY":"releasecountry","TXXX:DISCOGS_DATE":"originaldate","TXXX:DISCOGS_LABEL":"label","TXXX:DISCOGS_LABEL_ID":"discogs_label_id","TXXX:DISCOGS_MASTER_RELEASE_ID":"discogs_master_release_id","TXXX:DISCOGS_RATING":"discogs_rating","TXXX:DISCOGS_RELEASED":"date","TXXX:DISCOGS_RELEASE_ID":"discogs_release_id","TXXX:DISCOGS_VOTES":"discogs_votes","TXXX:CATALOGID":"catalognumber","TXXX:STYLE":"genre","TXXX:REPLAYGAIN_TRACK_PEAK":"replaygain_track_peak","TXXX:REPLAYGAIN_TRACK_GAIN":"replaygain_track_gain","TXXX:REPLAYGAIN_ALBUM_PEAK":"replaygain_album_peak","TXXX:REPLAYGAIN_ALBUM_GAIN":"replaygain_album_gain","TXXX:MP3GAIN_MINMAX":"replaygain_track_minmax","TXXX:MP3GAIN_ALBUM_MINMAX":"replaygain_album_minmax","TXXX:MP3GAIN_UNDO":"replaygain_undo",MVNM:"movement",MVIN:"movementIndex",PCST:"podcast",TCAT:"category",TDES:"description",TDRL:"releasedate",TGID:"podcastId",TKWD:"keywords",WFED:"podcasturl",GRP1:"grouping"};class Zw extends ud{static toRating(e){return{source:e.email,rating:e.rating>0?(e.rating-1)/254*hr.maxRatingScore:void 0}}constructor(){super(["ID3v2.3","ID3v2.4"],cK)}postMap(e,n){switch(e.id){case"UFID":{const r=e.value;r.owner_identifier==="http://musicbrainz.org"&&(e.id+=`:${r.owner_identifier}`,e.value=At(r.identifier,"latin1"))}break;case"PRIV":{const r=e.value;switch(r.owner_identifier){case"AverageLevel":case"PeakValue":e.id+=`:${r.owner_identifier}`,e.value=r.data.length===4?ie.get(r.data,0):null,e.value===null&&n.addWarning("Failed to parse PRIV:PeakValue");break;default:n.addWarning(`Unknown PRIV owner-identifier: ${r.data}`)}}break;case"POPM":e.value=Zw.toRating(e.value);break}}}const uK={Title:"title",Author:"artist","WM/AlbumArtist":"albumartist","WM/AlbumTitle":"album","WM/Year":"date","WM/OriginalReleaseTime":"originaldate","WM/OriginalReleaseYear":"originalyear",Description:"comment","WM/TrackNumber":"track","WM/PartOfSet":"disk","WM/Genre":"genre","WM/Composer":"composer","WM/Lyrics":"lyrics","WM/AlbumSortOrder":"albumsort","WM/TitleSortOrder":"titlesort","WM/ArtistSortOrder":"artistsort","WM/AlbumArtistSortOrder":"albumartistsort","WM/ComposerSortOrder":"composersort","WM/Writer":"lyricist","WM/Conductor":"conductor","WM/ModifiedBy":"remixer","WM/Engineer":"engineer","WM/Producer":"producer","WM/DJMixer":"djmixer","WM/Mixer":"mixer","WM/Publisher":"label","WM/ContentGroupDescription":"grouping","WM/SubTitle":"subtitle","WM/SetSubTitle":"discsubtitle","WM/IsCompilation":"compilation","WM/SharedUserRating":"rating","WM/BeatsPerMinute":"bpm","WM/Mood":"mood","WM/Media":"media","WM/CatalogNo":"catalognumber","MusicBrainz/Album Status":"releasestatus","MusicBrainz/Album Type":"releasetype","MusicBrainz/Album Release Country":"releasecountry","WM/Script":"script","WM/Language":"language",Copyright:"copyright",LICENSE:"license","WM/EncodedBy":"encodedby","WM/EncodingSettings":"encodersettings","WM/Barcode":"barcode","WM/ISRC":"isrc","MusicBrainz/Track Id":"musicbrainz_recordingid","MusicBrainz/Release Track Id":"musicbrainz_trackid","MusicBrainz/Album Id":"musicbrainz_albumid","MusicBrainz/Artist Id":"musicbrainz_artistid","MusicBrainz/Album Artist Id":"musicbrainz_albumartistid","MusicBrainz/Release Group Id":"musicbrainz_releasegroupid","MusicBrainz/Work Id":"musicbrainz_workid","MusicBrainz/TRM Id":"musicbrainz_trmid","MusicBrainz/Disc Id":"musicbrainz_discid","Acoustid/Id":"acoustid_id","Acoustid/Fingerprint":"acoustid_fingerprint","MusicIP/PUID":"musicip_puid","WM/ARTISTS":"artists","WM/InitialKey":"key",ASIN:"asin","WM/Work":"work","WM/AuthorURL":"website","WM/Picture":"picture"};class e1 extends hr{static toRating(e){return{rating:Number.parseFloat(e+1)/5}}constructor(){super(["asf"],uK)}postMap(e){switch(e.id){case"WM/SharedUserRating":{const n=e.id.split(":");e.value=e1.toRating(e.value),e.id=n[0];break}}}}const dK={TT2:"title",TP1:"artist",TP2:"albumartist",TAL:"album",TYE:"year",COM:"comment",TRK:"track",TPA:"disk",TCO:"genre",PIC:"picture",TCM:"composer",TOR:"originaldate",TOT:"originalalbum",TXT:"lyricist",TP3:"conductor",TPB:"label",TT1:"grouping",TT3:"subtitle",TLA:"language",TCR:"copyright",WCP:"license",TEN:"encodedby",TSS:"encodersettings",WAR:"website",PCS:"podcast",TCP:"compilation",TDR:"date",TS2:"albumartistsort",TSA:"albumsort",TSC:"composersort",TSP:"artistsort",TST:"titlesort",WFD:"podcasturl",TBP:"bpm"};class hK extends ud{constructor(){super(["ID3v2.2"],dK)}}const fK={Title:"title",Artist:"artist",Artists:"artists","Album Artist":"albumartist",Album:"album",Year:"date",Originalyear:"originalyear",Originaldate:"originaldate",Releasedate:"releasedate",Comment:"comment",Track:"track",Disc:"disk",DISCNUMBER:"disk",Genre:"genre","Cover Art (Front)":"picture","Cover Art (Back)":"picture",Composer:"composer",Lyrics:"lyrics",ALBUMSORT:"albumsort",TITLESORT:"titlesort",WORK:"work",ARTISTSORT:"artistsort",ALBUMARTISTSORT:"albumartistsort",COMPOSERSORT:"composersort",Lyricist:"lyricist",Writer:"writer",Conductor:"conductor",MixArtist:"remixer",Arranger:"arranger",Engineer:"engineer",Producer:"producer",DJMixer:"djmixer",Mixer:"mixer",Label:"label",Grouping:"grouping",Subtitle:"subtitle",DiscSubtitle:"discsubtitle",Compilation:"compilation",BPM:"bpm",Mood:"mood",Media:"media",CatalogNumber:"catalognumber",MUSICBRAINZ_ALBUMSTATUS:"releasestatus",MUSICBRAINZ_ALBUMTYPE:"releasetype",RELEASECOUNTRY:"releasecountry",Script:"script",Language:"language",Copyright:"copyright",LICENSE:"license",EncodedBy:"encodedby",EncoderSettings:"encodersettings",Barcode:"barcode",ISRC:"isrc",ASIN:"asin",musicbrainz_trackid:"musicbrainz_recordingid",musicbrainz_releasetrackid:"musicbrainz_trackid",MUSICBRAINZ_ALBUMID:"musicbrainz_albumid",MUSICBRAINZ_ARTISTID:"musicbrainz_artistid",MUSICBRAINZ_ALBUMARTISTID:"musicbrainz_albumartistid",MUSICBRAINZ_RELEASEGROUPID:"musicbrainz_releasegroupid",MUSICBRAINZ_WORKID:"musicbrainz_workid",MUSICBRAINZ_TRMID:"musicbrainz_trmid",MUSICBRAINZ_DISCID:"musicbrainz_discid",Acoustid_Id:"acoustid_id",ACOUSTID_FINGERPRINT:"acoustid_fingerprint",MUSICIP_PUID:"musicip_puid",Weblink:"website",REPLAYGAIN_TRACK_GAIN:"replaygain_track_gain",REPLAYGAIN_TRACK_PEAK:"replaygain_track_peak",MP3GAIN_MINMAX:"replaygain_track_minmax",MP3GAIN_UNDO:"replaygain_undo"};class mK extends ud{constructor(){super(["APEv2"],fK)}}const pK={"©nam":"title","©ART":"artist",aART:"albumartist","----:com.apple.iTunes:Band":"albumartist","©alb":"album","©day":"date","©cmt":"comment","©com":"comment",trkn:"track",disk:"disk","©gen":"genre",covr:"picture","©wrt":"composer","©lyr":"lyrics",soal:"albumsort",sonm:"titlesort",soar:"artistsort",soaa:"albumartistsort",soco:"composersort","----:com.apple.iTunes:LYRICIST":"lyricist","----:com.apple.iTunes:CONDUCTOR":"conductor","----:com.apple.iTunes:REMIXER":"remixer","----:com.apple.iTunes:ENGINEER":"engineer","----:com.apple.iTunes:PRODUCER":"producer","----:com.apple.iTunes:DJMIXER":"djmixer","----:com.apple.iTunes:MIXER":"mixer","----:com.apple.iTunes:LABEL":"label","©grp":"grouping","----:com.apple.iTunes:SUBTITLE":"subtitle","----:com.apple.iTunes:DISCSUBTITLE":"discsubtitle",cpil:"compilation",tmpo:"bpm","----:com.apple.iTunes:MOOD":"mood","----:com.apple.iTunes:MEDIA":"media","----:com.apple.iTunes:CATALOGNUMBER":"catalognumber",tvsh:"tvShow",tvsn:"tvSeason",tves:"tvEpisode",sosn:"tvShowSort",tven:"tvEpisodeId",tvnn:"tvNetwork",pcst:"podcast",purl:"podcasturl","----:com.apple.iTunes:MusicBrainz Album Status":"releasestatus","----:com.apple.iTunes:MusicBrainz Album Type":"releasetype","----:com.apple.iTunes:MusicBrainz Album Release Country":"releasecountry","----:com.apple.iTunes:SCRIPT":"script","----:com.apple.iTunes:LANGUAGE":"language",cprt:"copyright","©cpy":"copyright","----:com.apple.iTunes:LICENSE":"license","©too":"encodedby",pgap:"gapless","----:com.apple.iTunes:BARCODE":"barcode","----:com.apple.iTunes:ISRC":"isrc","----:com.apple.iTunes:ASIN":"asin","----:com.apple.iTunes:NOTES":"comment","----:com.apple.iTunes:MusicBrainz Track Id":"musicbrainz_recordingid","----:com.apple.iTunes:MusicBrainz Release Track Id":"musicbrainz_trackid","----:com.apple.iTunes:MusicBrainz Album Id":"musicbrainz_albumid","----:com.apple.iTunes:MusicBrainz Artist Id":"musicbrainz_artistid","----:com.apple.iTunes:MusicBrainz Album Artist Id":"musicbrainz_albumartistid","----:com.apple.iTunes:MusicBrainz Release Group Id":"musicbrainz_releasegroupid","----:com.apple.iTunes:MusicBrainz Work Id":"musicbrainz_workid","----:com.apple.iTunes:MusicBrainz TRM Id":"musicbrainz_trmid","----:com.apple.iTunes:MusicBrainz Disc Id":"musicbrainz_discid","----:com.apple.iTunes:Acoustid Id":"acoustid_id","----:com.apple.iTunes:Acoustid Fingerprint":"acoustid_fingerprint","----:com.apple.iTunes:MusicIP PUID":"musicip_puid","----:com.apple.iTunes:fingerprint":"musicip_fingerprint","----:com.apple.iTunes:replaygain_track_gain":"replaygain_track_gain","----:com.apple.iTunes:replaygain_track_peak":"replaygain_track_peak","----:com.apple.iTunes:replaygain_album_gain":"replaygain_album_gain","----:com.apple.iTunes:replaygain_album_peak":"replaygain_album_peak","----:com.apple.iTunes:replaygain_track_minmax":"replaygain_track_minmax","----:com.apple.iTunes:replaygain_album_minmax":"replaygain_album_minmax","----:com.apple.iTunes:replaygain_undo":"replaygain_undo",gnre:"genre","----:com.apple.iTunes:ALBUMARTISTSORT":"albumartistsort","----:com.apple.iTunes:ARTISTS":"artists","----:com.apple.iTunes:ORIGINALDATE":"originaldate","----:com.apple.iTunes:ORIGINALYEAR":"originalyear","----:com.apple.iTunes:RELEASEDATE":"releasedate",desc:"description",ldes:"longDescription","©mvn":"movement","©mvi":"movementIndex","©mvc":"movementTotal","©wrk":"work",catg:"category",egid:"podcastId",hdvd:"hdVideo",keyw:"keywords",shwm:"showMovement",stik:"stik",rate:"rating"},gK="iTunes";class L2 extends ud{constructor(){super([gK],pK)}postMap(e,n){switch(e.id){case"rate":e.value={source:void 0,rating:Number.parseFloat(e.value)/100};break}}}const xK={TITLE:"title",ARTIST:"artist",ARTISTS:"artists",ALBUMARTIST:"albumartist","ALBUM ARTIST":"albumartist",ALBUM:"album",DATE:"date",ORIGINALDATE:"originaldate",ORIGINALYEAR:"originalyear",RELEASEDATE:"releasedate",COMMENT:"comment",TRACKNUMBER:"track",DISCNUMBER:"disk",GENRE:"genre",METADATA_BLOCK_PICTURE:"picture",COMPOSER:"composer",LYRICS:"lyrics",ALBUMSORT:"albumsort",TITLESORT:"titlesort",WORK:"work",ARTISTSORT:"artistsort",ALBUMARTISTSORT:"albumartistsort",COMPOSERSORT:"composersort",LYRICIST:"lyricist",WRITER:"writer",CONDUCTOR:"conductor",REMIXER:"remixer",ARRANGER:"arranger",ENGINEER:"engineer",PRODUCER:"producer",DJMIXER:"djmixer",MIXER:"mixer",LABEL:"label",GROUPING:"grouping",SUBTITLE:"subtitle",DISCSUBTITLE:"discsubtitle",TRACKTOTAL:"totaltracks",DISCTOTAL:"totaldiscs",COMPILATION:"compilation",RATING:"rating",BPM:"bpm",KEY:"key",MOOD:"mood",MEDIA:"media",CATALOGNUMBER:"catalognumber",RELEASESTATUS:"releasestatus",RELEASETYPE:"releasetype",RELEASECOUNTRY:"releasecountry",SCRIPT:"script",LANGUAGE:"language",COPYRIGHT:"copyright",LICENSE:"license",ENCODEDBY:"encodedby",ENCODERSETTINGS:"encodersettings",BARCODE:"barcode",ISRC:"isrc",ASIN:"asin",MUSICBRAINZ_TRACKID:"musicbrainz_recordingid",MUSICBRAINZ_RELEASETRACKID:"musicbrainz_trackid",MUSICBRAINZ_ALBUMID:"musicbrainz_albumid",MUSICBRAINZ_ARTISTID:"musicbrainz_artistid",MUSICBRAINZ_ALBUMARTISTID:"musicbrainz_albumartistid",MUSICBRAINZ_RELEASEGROUPID:"musicbrainz_releasegroupid",MUSICBRAINZ_WORKID:"musicbrainz_workid",MUSICBRAINZ_TRMID:"musicbrainz_trmid",MUSICBRAINZ_DISCID:"musicbrainz_discid",ACOUSTID_ID:"acoustid_id",ACOUSTID_ID_FINGERPRINT:"acoustid_fingerprint",MUSICIP_PUID:"musicip_puid",WEBSITE:"website",NOTES:"notes",TOTALTRACKS:"totaltracks",TOTALDISCS:"totaldiscs",DISCOGS_ARTIST_ID:"discogs_artist_id",DISCOGS_ARTISTS:"artists",DISCOGS_ARTIST_NAME:"artists",DISCOGS_ALBUM_ARTISTS:"albumartist",DISCOGS_CATALOG:"catalognumber",DISCOGS_COUNTRY:"releasecountry",DISCOGS_DATE:"originaldate",DISCOGS_LABEL:"label",DISCOGS_LABEL_ID:"discogs_label_id",DISCOGS_MASTER_RELEASE_ID:"discogs_master_release_id",DISCOGS_RATING:"discogs_rating",DISCOGS_RELEASED:"date",DISCOGS_RELEASE_ID:"discogs_release_id",DISCOGS_VOTES:"discogs_votes",CATALOGID:"catalognumber",STYLE:"genre",REPLAYGAIN_TRACK_GAIN:"replaygain_track_gain",REPLAYGAIN_TRACK_PEAK:"replaygain_track_peak",REPLAYGAIN_ALBUM_GAIN:"replaygain_album_gain",REPLAYGAIN_ALBUM_PEAK:"replaygain_album_peak",REPLAYGAIN_MINMAX:"replaygain_track_minmax",REPLAYGAIN_ALBUM_MINMAX:"replaygain_album_minmax",REPLAYGAIN_UNDO:"replaygain_undo"};class Uf extends hr{static toRating(e,n,r){return{source:e?e.toLowerCase():void 0,rating:Number.parseFloat(n)/r*hr.maxRatingScore}}constructor(){super(["vorbis"],xK)}postMap(e){if(e.id==="RATING")e.value=Uf.toRating(void 0,e.value,100);else if(e.id.indexOf("RATING:")===0){const n=e.id.split(":");e.value=Uf.toRating(n[1],e.value,1),e.id=n[0]}}}const yK={IART:"artist",ICRD:"date",INAM:"title",TITL:"title",IPRD:"album",ITRK:"track",IPRT:"track",COMM:"comment",ICMT:"comment",ICNT:"releasecountry",GNRE:"genre",IWRI:"writer",RATE:"rating",YEAR:"year",ISFT:"encodedby",CODE:"encodedby",TURL:"website",IGNR:"genre",IENG:"engineer",ITCH:"technician",IMED:"media",IRPD:"album"};class vK extends hr{constructor(){super(["exif"],yK)}}const wK={"segment:title":"title","album:ARTIST":"albumartist","album:ARTISTSORT":"albumartistsort","album:TITLE":"album","album:DATE_RECORDED":"originaldate","album:DATE_RELEASED":"releasedate","album:PART_NUMBER":"disk","album:TOTAL_PARTS":"totaltracks","track:ARTIST":"artist","track:ARTISTSORT":"artistsort","track:TITLE":"title","track:PART_NUMBER":"track","track:MUSICBRAINZ_TRACKID":"musicbrainz_recordingid","track:MUSICBRAINZ_ALBUMID":"musicbrainz_albumid","track:MUSICBRAINZ_ARTISTID":"musicbrainz_artistid","track:PUBLISHER":"label","track:GENRE":"genre","track:ENCODER":"encodedby","track:ENCODER_OPTIONS":"encodersettings","edition:TOTAL_PARTS":"totaldiscs",picture:"picture"};class _K extends ud{constructor(){super(["matroska"],wK)}}const SK={NAME:"title",AUTH:"artist","(c) ":"copyright",ANNO:"comment"};class bK extends hr{constructor(){super(["AIFF"],SK)}}class EK{constructor(){this.tagMappers={},[new lK,new hK,new Zw,new L2,new L2,new Uf,new mK,new e1,new vK,new _K,new bK].forEach(e=>{this.registerTagMapper(e)})}mapTag(e,n,r){if(this.tagMappers[e])return this.tagMappers[e].mapGenericTag(n,r);throw new Error(`No generic tag mapper defined for tag-format: ${e}`)}registerTagMapper(e){for(const n of e.tagTypes)this.tagMappers[n]=e}}const ya=Qe("music-metadata:collector"),jK=["matroska","APEv2","vorbis","ID3v2.4","ID3v2.3","ID3v2.2","exif","asf","iTunes","AIFF","ID3v1"];class kK{constructor(e){this.opts=e,this.format={tagTypes:[],trackInfo:[]},this.native={},this.common={track:{no:null,of:null},disk:{no:null,of:null},movementIndex:{no:null,of:null}},this.quality={warnings:[]},this.commonOrigin={},this.originPriority={},this.tagMapper=new EK;let n=1;for(const r of jK)this.originPriority[r]=n++;this.originPriority.artificial=500,this.originPriority.id3v1=600}hasAny(){return Object.keys(this.native).length>0}addStreamInfo(e){ya(`streamInfo: type=${e.type?Za[e.type]:"?"}, codec=${e.codecName}`),this.format.trackInfo.push(e)}setFormat(e,n){var r;ya(`format: ${e} = ${n}`),this.format[e]=n,(r=this.opts)!=null&&r.observer&&this.opts.observer({metadata:this,tag:{type:"format",id:e,value:n}})}async addTag(e,n,r){ya(`tag ${e}.${n} = ${r}`),this.native[e]||(this.format.tagTypes.push(e),this.native[e]=[]),this.native[e].push({id:n,value:r}),await this.toCommon(e,n,r)}addWarning(e){this.quality.warnings.push({message:e})}async postMap(e,n){switch(n.id){case"artist":if(this.commonOrigin.artist===this.originPriority[e])return this.postMap("artificial",{id:"artists",value:n.value});this.common.artists||this.setGenericTag("artificial",{id:"artists",value:n.value});break;case"artists":if((!this.common.artist||this.commonOrigin.artist===this.originPriority.artificial)&&(!this.common.artists||this.common.artists.indexOf(n.value)===-1)){const r=(this.common.artists||[]).concat([n.value]),i={id:"artist",value:TK(r)};this.setGenericTag("artificial",i)}break;case"picture":return this.postFixPicture(n.value).then(r=>{r!==null&&(n.value=r,this.setGenericTag(e,n))});case"totaltracks":this.common.track.of=hr.toIntOrNull(n.value);return;case"totaldiscs":this.common.disk.of=hr.toIntOrNull(n.value);return;case"movementTotal":this.common.movementIndex.of=hr.toIntOrNull(n.value);return;case"track":case"disk":case"movementIndex":{const r=this.common[n.id].of;this.common[n.id]=hr.normalizeTrack(n.value),this.common[n.id].of=r??this.common[n.id].of;return}case"bpm":case"year":case"originalyear":n.value=Number.parseInt(n.value,10);break;case"date":{const r=Number.parseInt(n.value.substr(0,4),10);Number.isNaN(r)||(this.common.year=r);break}case"discogs_label_id":case"discogs_release_id":case"discogs_master_release_id":case"discogs_artist_id":case"discogs_votes":n.value=typeof n.value=="string"?Number.parseInt(n.value,10):n.value;break;case"replaygain_track_gain":case"replaygain_track_peak":case"replaygain_album_gain":case"replaygain_album_peak":n.value=sK(n.value);break;case"replaygain_track_minmax":n.value=n.value.split(",").map(r=>Number.parseInt(r,10));break;case"replaygain_undo":{const r=n.value.split(",").map(s=>Number.parseInt(s,10));n.value={leftChannel:r[0],rightChannel:r[1]};break}case"gapless":case"compilation":case"podcast":case"showMovement":n.value=n.value==="1"||n.value===1;break;case"isrc":{const r=this.common[n.id];if(r&&r.indexOf(n.value)!==-1)return;break}case"comment":typeof n.value=="string"&&(n.value={text:n.value}),n.value.descriptor==="iTunPGAP"&&this.setGenericTag(e,{id:"gapless",value:n.value.text==="1"});break}n.value!==null&&this.setGenericTag(e,n)}toCommonMetadata(){return{format:this.format,native:this.native,quality:this.quality,common:this.common}}async postFixPicture(e){if(e.data&&e.data.length>0){if(!e.format){const n=await UN(Uint8Array.from(e.data));if(n)e.format=n.mime;else return null}switch(e.format=e.format.toLocaleLowerCase(),e.format){case"image/jpg":e.format="image/jpeg"}return e}return this.addWarning("Empty picture tag found"),null}async toCommon(e,n,r){const s={id:n,value:r},i=this.tagMapper.mapTag(e,s,this);i&&await this.postMap(e,i)}setGenericTag(e,n){var i;ya(`common.${n.id} = ${n.value}`);const r=this.commonOrigin[n.id]||1e3,s=this.originPriority[e];if(iK(n.id))if(s<=r)this.common[n.id]=n.value,this.commonOrigin[n.id]=s;else return ya(`Ignore native tag (singleton): ${e}.${n.id} = ${n.value}`);else if(s===r)!aK(n.id)||this.common[n.id].indexOf(n.value)===-1?this.common[n.id].push(n.value):ya(`Ignore duplicate value: ${e}.${n.id} = ${n.value}`);else if(s<r)this.common[n.id]=[n.value],this.commonOrigin[n.id]=s;else return ya(`Ignore native tag (list): ${e}.${n.id} = ${n.value}`);(i=this.opts)!=null&&i.observer&&this.opts.observer({metadata:this,tag:{type:"common",id:n.id,value:n.value}})}}function TK(t){return t.length>2?`${t.slice(0,t.length-1).join(", ")} & ${t[t.length-1]}`:t.join(" & ")}class Er{constructor(){this.metadata=void 0,this.tokenizer=void 0,this.options=void 0}init(e,n,r){return this.metadata=e,this.tokenizer=n,this.options=r,this}}const IK=/^[\x21-\x7e©][\x20-\x7e\x00()]{3}/,nt={len:4,get:(t,e)=>{const n=Xw(t.slice(e,e+nt.len),"latin1");if(!n.match(IK))throw new Error(`FourCC contains invalid characters: ${tK(n)} "${n}"`);return n},put:(t,e,n)=>{const r=Cq(n);if(r.length!==4)throw new Error("Invalid length");return t.set(r,e),e+4}};var Wo;(function(t){t[t.text_utf8=0]="text_utf8",t[t.binary=1]="binary",t[t.external_info=2]="external_info",t[t.reserved=3]="reserved"})(Wo||(Wo={}));const O2={len:52,get:(t,e)=>({ID:nt.get(t,e),version:ie.get(t,e+4)/1e3,descriptorBytes:ie.get(t,e+8),headerBytes:ie.get(t,e+12),seekTableBytes:ie.get(t,e+16),headerDataBytes:ie.get(t,e+20),apeFrameDataBytes:ie.get(t,e+24),apeFrameDataBytesHigh:ie.get(t,e+28),terminatingDataBytes:ie.get(t,e+32),fileMD5:new Gn(16).get(t,e+36)})},CK={len:24,get:(t,e)=>({compressionLevel:Ue.get(t,e),formatFlags:Ue.get(t,e+2),blocksPerFrame:ie.get(t,e+4),finalFrameBlocks:ie.get(t,e+8),totalFrames:ie.get(t,e+12),bitsPerSample:Ue.get(t,e+16),channel:Ue.get(t,e+18),sampleRate:ie.get(t,e+20)})},Ir={len:32,get:(t,e)=>({ID:new le(8,"ascii").get(t,e),version:ie.get(t,e+8),size:ie.get(t,e+12),fields:ie.get(t,e+16),flags:QN(ie.get(t,e+20))})},Qg={len:8,get:(t,e)=>({size:ie.get(t,e),flags:QN(ie.get(t,e+4))})};function QN(t){return{containsHeader:nh(t,31),containsFooter:nh(t,30),isHeader:nh(t,29),readOnly:nh(t,0),dataType:(t&6)>>1}}function nh(t,e){return(t&1<<e)!==0}const va=Qe("music-metadata:parser:APEv2"),$2="APEv2",z2="APETAGEX";class ys extends Er{constructor(){super(...arguments),this.ape={}}static tryParseApeHeader(e,n,r){const s=new ys;return s.init(e,n,r),s.tryParseApeHeader()}static calculateDuration(e){let n=e.totalFrames>1?e.blocksPerFrame*(e.totalFrames-1):0;return n+=e.finalFrameBlocks,n/e.sampleRate}static async findApeFooterOffset(e,n){const r=new Uint8Array(Ir.len);await e.randomRead(r,0,Ir.len,n-Ir.len);const s=Ir.get(r,0);if(s.ID==="APETAGEX")return s.flags.isHeader?va(`APE Header found at offset=${n-Ir.len}`):(va(`APE Footer found at offset=${n-Ir.len}`),n-=s.size),{footer:s,offset:n}}static parseTagFooter(e,n,r){const s=Ir.get(n,n.length-Ir.len);if(s.ID!==z2)throw new Error("Unexpected APEv2 Footer ID preamble value.");kl(n);const i=new ys;return i.init(e,kl(n),r),i.parseTags(s)}async tryParseApeHeader(){if(this.tokenizer.fileInfo.size&&this.tokenizer.fileInfo.size-this.tokenizer.position<Ir.len){va("No APEv2 header found, end-of-file reached");return}const e=await this.tokenizer.peekToken(Ir);if(e.ID===z2)return await this.tokenizer.ignore(Ir.len),this.parseTags(e);if(va(`APEv2 header not found at offset=${this.tokenizer.position}`),this.tokenizer.fileInfo.size){const n=this.tokenizer.fileInfo.size-this.tokenizer.position,r=new Uint8Array(n);return await this.tokenizer.readBuffer(r),ys.parseTagFooter(this.metadata,r,this.options)}}async parse(){const e=await this.tokenizer.readToken(O2);if(e.ID!=="MAC ")throw new Error("Unexpected descriptor ID");this.ape.descriptor=e;const n=e.descriptorBytes-O2.len,r=await(n>0?this.parseDescriptorExpansion(n):this.parseHeader());return await this.tokenizer.ignore(r.forwardBytes),this.tryParseApeHeader()}async parseTags(e){const n=new Uint8Array(256);let r=e.size-Ir.len;va(`Parse APE tags at offset=${this.tokenizer.position}, size=${r}`);for(let s=0;s<e.fields;s++){if(r<Qg.len){this.metadata.addWarning(`APEv2 Tag-header: ${e.fields-s} items remaining, but no more tag data to read.`);break}const i=await this.tokenizer.readToken(Qg);r-=Qg.len+i.size,await this.tokenizer.peekBuffer(n,{length:Math.min(n.length,r)});let o=sr(n,0,n.length);const l=await this.tokenizer.readToken(new le(o,"ascii"));switch(await this.tokenizer.ignore(1),r-=l.length+1,i.flags.dataType){case Wo.text_utf8:{const u=(await this.tokenizer.readToken(new le(i.size,"utf8"))).split(/\x00/g);await Promise.all(u.map(d=>this.metadata.addTag($2,l,d)));break}case Wo.binary:if(this.options.skipCovers)await this.tokenizer.ignore(i.size);else{const c=new Uint8Array(i.size);await this.tokenizer.readBuffer(c),o=sr(c,0,c.length);const u=Xw(c.slice(0,o)),d=c.slice(o+1);await this.metadata.addTag($2,l,{description:u,data:d})}break;case Wo.external_info:va(`Ignore external info ${l}`),await this.tokenizer.ignore(i.size);break;case Wo.reserved:va(`Ignore external info ${l}`),this.metadata.addWarning(`APEv2 header declares a reserved datatype for "${l}"`),await this.tokenizer.ignore(i.size);break}}}async parseDescriptorExpansion(e){return await this.tokenizer.ignore(e),this.parseHeader()}async parseHeader(){const e=await this.tokenizer.readToken(CK);if(this.metadata.setFormat("lossless",!0),this.metadata.setFormat("container","Monkey's Audio"),this.metadata.setFormat("bitsPerSample",e.bitsPerSample),this.metadata.setFormat("sampleRate",e.sampleRate),this.metadata.setFormat("numberOfChannels",e.channel),this.metadata.setFormat("duration",ys.calculateDuration(e)),!this.ape.descriptor)throw new Error("Missing APE descriptor");return{forwardBytes:this.ape.descriptor.seekTableBytes+this.ape.descriptor.headerDataBytes+this.ape.descriptor.apeFrameDataBytes+this.ape.descriptor.terminatingDataBytes}}}const rh=Qe("music-metadata:parser:ID3v1"),Hf=["Blues","Classic Rock","Country","Dance","Disco","Funk","Grunge","Hip-Hop","Jazz","Metal","New Age","Oldies","Other","Pop","R&B","Rap","Reggae","Rock","Techno","Industrial","Alternative","Ska","Death Metal","Pranks","Soundtrack","Euro-Techno","Ambient","Trip-Hop","Vocal","Jazz+Funk","Fusion","Trance","Classical","Instrumental","Acid","House","Game","Sound Clip","Gospel","Noise","Alt. Rock","Bass","Soul","Punk","Space","Meditative","Instrumental Pop","Instrumental Rock","Ethnic","Gothic","Darkwave","Techno-Industrial","Electronic","Pop-Folk","Eurodance","Dream","Southern Rock","Comedy","Cult","Gangsta Rap","Top 40","Christian Rap","Pop/Funk","Jungle","Native American","Cabaret","New Wave","Psychedelic","Rave","Showtunes","Trailer","Lo-Fi","Tribal","Acid Punk","Acid Jazz","Polka","Retro","Musical","Rock & Roll","Hard Rock","Folk","Folk/Rock","National Folk","Swing","Fast-Fusion","Bebob","Latin","Revival","Celtic","Bluegrass","Avantgarde","Gothic Rock","Progressive Rock","Psychedelic Rock","Symphonic Rock","Slow Rock","Big Band","Chorus","Easy Listening","Acoustic","Humour","Speech","Chanson","Opera","Chamber Music","Sonata","Symphony","Booty Bass","Primus","Porn Groove","Satire","Slow Jam","Club","Tango","Samba","Folklore","Ballad","Power Ballad","Rhythmic Soul","Freestyle","Duet","Punk Rock","Drum Solo","A Cappella","Euro-House","Dance Hall","Goa","Drum & Bass","Club-House","Hardcore","Terror","Indie","BritPop","Negerpunk","Polsk Punk","Beat","Christian Gangsta Rap","Heavy Metal","Black Metal","Crossover","Contemporary Christian","Christian Rock","Merengue","Salsa","Thrash Metal","Anime","JPop","Synthpop","Abstract","Art Rock","Baroque","Bhangra","Big Beat","Breakbeat","Chillout","Downtempo","Dub","EBM","Eclectic","Electro","Electroclash","Emo","Experimental","Garage","Global","IDM","Illbient","Industro-Goth","Jam Band","Krautrock","Leftfield","Lounge","Math Rock","New Romantic","Nu-Breakz","Post-Punk","Post-Rock","Psytrance","Shoegaze","Space Rock","Trop Rock","World Music","Neoclassical","Audiobook","Audio Theatre","Neue Deutsche Welle","Podcast","Indie Rock","G-Funk","Dubstep","Garage Rock","Psybient"],sh={len:128,get:(t,e)=>{const n=new jo(3).get(t,e);return n==="TAG"?{header:n,title:new jo(30).get(t,e+3),artist:new jo(30).get(t,e+33),album:new jo(30).get(t,e+63),year:new jo(4).get(t,e+93),comment:new jo(28).get(t,e+97),zeroByte:Te.get(t,e+127),track:Te.get(t,e+126),genre:Te.get(t,e+127)}:null}};class jo{constructor(e){this.len=e,this.stringType=new le(e,"latin1")}get(e,n){let r=this.stringType.get(e,n);return r=WN(r),r=r.trim(),r.length>0?r:void 0}}class t1 extends Er{static getGenre(e){if(e<Hf.length)return Hf[e]}async parse(){if(!this.tokenizer.fileInfo.size){rh("Skip checking for ID3v1 because the file-size is unknown");return}if(this.options.apeHeader){this.tokenizer.ignore(this.options.apeHeader.offset-this.tokenizer.position);const r=new ys;r.init(this.metadata,this.tokenizer,this.options),await r.parseTags(this.options.apeHeader.footer)}const e=this.tokenizer.fileInfo.size-sh.len;if(this.tokenizer.position>e){rh("Already consumed the last 128 bytes");return}const n=await this.tokenizer.readToken(sh,e);if(n){rh("ID3v1 header found at: pos=%s",this.tokenizer.fileInfo.size-sh.len);const r=["title","artist","album","comment","track","year"];for(const i of r)n[i]&&n[i]!==""&&await this.addTag(i,n[i]);const s=t1.getGenre(n.genre);s&&await this.addTag("genre",s)}else rh("ID3v1 header not found at: pos=%s",this.tokenizer.fileInfo.size-sh.len)}async addTag(e,n){await this.metadata.addTag("ID3v1",e,n)}}const B2=Qe("music-metadata:id3v2:frame-parser"),Ur="latin1";function RK(t){const e=[];let n,r="";for(const s of t)if(typeof n=="string")if(s==="("&&n==="")r+="(",n=void 0;else if(s===")"){r!==""&&(e.push(r),r="");const i=V2(n);i&&e.push(i),n=void 0}else n+=s;else s==="("?n="":r+=s;return r&&(e.length===0&&r.match(/^\d*$/)&&(r=V2(r)),r&&e.push(r)),e}function V2(t){if(t==="RX")return"Remix";if(t==="CR")return"Cover";if(t.match(/^\d*$/))return Hf[Number.parseInt(t)]}class ir{constructor(e,n){this.major=e,this.warningCollector=n}readData(e,n,r){if(e.length===0){this.warningCollector.addWarning(`id3v2.${this.major} header has empty tag type=${n}`);return}const{encoding:s,bom:i}=KN.get(e,0),o=e.length;let l=0,c=[];const u=ir.getNullTerminatorLength(s);let d;switch(B2(`Parsing tag type=${n}, encoding=${s}, bom=${i}`),n!=="TXXX"&&n[0]==="T"?"T*":n){case"T*":case"GRP1":case"IPLS":case"MVIN":case"MVNM":case"PCS":case"PCST":{let m;try{m=At(e.slice(1),s).replace(/\x00+$/,"")}catch(p){if(p instanceof Error){this.warningCollector.addWarning(`id3v2.${this.major} type=${n} header has invalid string value: ${p.message}`);break}throw p}switch(n){case"TMCL":case"TIPL":case"IPLS":c=ir.functionList(this.splitValue(n,m));break;case"TRK":case"TRCK":case"TPOS":c=m;break;case"TCOM":case"TEXT":case"TOLY":case"TOPE":case"TPE1":case"TSRC":c=this.splitValue(n,m);break;case"TCO":case"TCON":c=this.splitValue(n,m).map(p=>RK(p)).reduce((p,g)=>p.concat(g),[]);break;case"PCS":case"PCST":c=this.major>=4?this.splitValue(n,m):[m],c=Array.isArray(c)&&c[0]===""?1:0;break;default:c=this.major>=4?this.splitValue(n,m):[m]}break}case"TXXX":{const m=ir.readIdentifierAndData(e,l+1,o,s);c={description:m.id,text:this.splitValue(n,At(m.data,s).replace(/\x00+$/,""))};break}case"PIC":case"APIC":if(r){const m={};switch(l+=1,this.major){case 2:m.format=At(e.slice(l,l+3),"latin1"),l+=3;break;case 3:case 4:d=sr(e,l,o,Ur),m.format=At(e.slice(l,d),Ur),l=d+1;break;default:throw new Error(`Warning: unexpected major versionIndex: ${this.major}`)}m.format=ir.fixPictureMimeType(m.format),m.type=ju[e[l]],l+=1,d=sr(e,l,o,s),m.description=At(e.slice(l,d),s),l=d+u,m.data=e.slice(l,o),c=m}break;case"CNT":case"PCNT":c=de.get(e,0);break;case"SYLT":{const m=D2.get(e,0);l+=D2.len;const p={descriptor:"",language:m.language,contentType:m.contentType,timeStampFormat:m.timeStampFormat,syncText:[]};let g=!1;for(;l<o;){const x=ir.readNullTerminatedString(e.subarray(l),m.encoding);if(l+=x.len,g){const w=de.get(e,l);l+=de.len,p.syncText.push({text:x.text,timestamp:w})}else p.descriptor=x.text,g=!0}c=p;break}case"ULT":case"USLT":case"COM":case"COMM":{const m=ty.get(e,l);l+=ty.len;const p=ir.readNullTerminatedString(e.subarray(l),m.encoding);l+=p.len;const g=ir.readNullTerminatedString(e.subarray(l),m.encoding);c={language:m.language,descriptor:p.text,text:g.text};break}case"UFID":{const m=ir.readIdentifierAndData(e,l,o,Ur);c={owner_identifier:m.id,identifier:m.data};break}case"PRIV":{const m=ir.readIdentifierAndData(e,l,o,Ur);c={owner_identifier:m.id,data:m.data};break}case"POPM":{d=sr(e,l,o,Ur);const m=At(e.slice(l,d),Ur);l=d+1;const p=o-l;c={email:m,rating:Te.get(e,l),counter:p>=5?de.get(e,l+1):void 0};break}case"GEOB":{d=sr(e,l+1,o,s);const m=At(e.slice(l+1,d),Ur);l=d+1,d=sr(e,l,o-l,s);const p=At(e.slice(l,d),Ur);l=d+1,d=sr(e,l,o-l,s);const g=At(e.slice(l,d),Ur);c={type:m,filename:p,description:g,data:e.slice(l+1,o)};break}case"WCOM":case"WCOP":case"WOAF":case"WOAR":case"WOAS":case"WORS":case"WPAY":case"WPUB":d=sr(e,l+1,o,s),c=At(e.slice(l,d),Ur);break;case"WXXX":{d=sr(e,l+1,o,s);const m=At(e.slice(l+1,d),s);l=d+(s==="utf-16le"?2:1),c={description:m,url:At(e.slice(l,o),Ur)};break}case"WFD":case"WFED":c=At(e.slice(l+1,sr(e,l+1,o,s)),s);break;case"MCDI":{c=e.slice(0,o);break}default:B2(`Warning: unsupported id3v2-tag-type: ${n}`);break}return c}static readNullTerminatedString(e,n){let r=n.bom?2:0;const s=sr(e,r,e.length,n.encoding),i=e.slice(r,s);return n.encoding==="utf-16le"?r=s+2:r=s+1,{text:At(i,n.encoding),len:r}}static fixPictureMimeType(e){switch(e=e.toLocaleLowerCase(),e){case"jpg":return"image/jpeg";case"png":return"image/png"}return e}static functionList(e){const n={};for(let r=0;r+1<e.length;r+=2){const s=e[r+1].split(",");n[e[r]]=n[e[r]]?n[e[r]].concat(s):s}return n}splitValue(e,n){let r;return this.major<4?(r=n.split(/\x00/g),r.length>1?this.warningCollector.addWarning(`ID3v2.${this.major} ${e} uses non standard null-separator.`):r=n.split(/\//g)):r=n.split(/\x00/g),ir.trimArray(r)}static trimArray(e){return e.map(n=>n.replace(/\x00+$/,"").trim())}static readIdentifierAndData(e,n,r,s){const i=sr(e,n,r,s),o=At(e.slice(n,i),s);return n=i+ir.getNullTerminatorLength(s),{id:o,data:e.slice(n,r)}}static getNullTerminatorLength(e){return e==="utf-16le"?2:1}}const U2=new TextDecoder("ascii");class Qr{constructor(){this.tokenizer=void 0,this.id3Header=void 0,this.metadata=void 0,this.headerType=void 0,this.options=void 0}static removeUnsyncBytes(e){let n=0,r=0;for(;n<e.length-1;)n!==r&&(e[r]=e[n]),n+=e[n]===255&&e[n+1]===0?2:1,r++;return n<e.length&&(e[r++]=e[n]),e.slice(0,r)}static getFrameHeaderLength(e){switch(e){case 2:return 6;case 3:case 4:return 10;default:throw new Error("header versionIndex is incorrect")}}static readFrameFlags(e){return{status:{tag_alter_preservation:pt(e,0,6),file_alter_preservation:pt(e,0,5),read_only:pt(e,0,4)},format:{grouping_identity:pt(e,1,7),compression:pt(e,1,3),encryption:pt(e,1,2),unsynchronisation:pt(e,1,1),data_length_indicator:pt(e,1,0)}}}static readFrameData(e,n,r,s,i){var l,c;const o=new ir(r,i);switch(r){case 2:return o.readData(e,n.id,s);case 3:case 4:return(l=n.flags)!=null&&l.format.unsynchronisation&&(e=Qr.removeUnsyncBytes(e)),(c=n.flags)!=null&&c.format.data_length_indicator&&(e=e.slice(4,e.length)),o.readData(e,n.id,s);default:throw new Error(`Unexpected majorVer: ${r}`)}}static makeDescriptionTagName(e,n){return e+(n?`:${n}`:"")}async parse(e,n,r){this.tokenizer=n,this.metadata=e,this.options=r;const s=await this.tokenizer.readToken(ey);if(s.fileIdentifier!=="ID3")throw new Error("expected ID3-header file-identifier 'ID3' was not found");return this.id3Header=s,this.headerType=`ID3v2.${s.version.major}`,s.flags.isExtendedHeader?this.parseExtendedHeader():this.parseId3Data(s.size)}async parseExtendedHeader(){const e=await this.tokenizer.readToken(M2),n=e.size-M2.len;return n>0?this.parseExtendedHeaderData(n,e.size):this.parseId3Data(this.id3Header.size-e.size)}async parseExtendedHeaderData(e,n){return await this.tokenizer.ignore(e),this.parseId3Data(this.id3Header.size-n)}async parseId3Data(e){const n=await this.tokenizer.readToken(new Gn(e));for(const r of this.parseMetadata(n))switch(r.id){case"TXXX":r.value&&await this.handleTag(r,r.value.text,()=>r.value.description);break;default:await(Array.isArray(r.value)?Promise.all(r.value.map(s=>this.addTag(r.id,s))):this.addTag(r.id,r.value))}}async handleTag(e,n,r,s=i=>i){await Promise.all(n.map(i=>this.addTag(Qr.makeDescriptionTagName(e.id,r(i)),s(i))))}async addTag(e,n){await this.metadata.addTag(this.headerType,e,n)}parseMetadata(e){let n=0;const r=[];for(;n!==e.length;){const s=Qr.getFrameHeaderLength(this.id3Header.version.major);if(n+s>e.length){this.metadata.addWarning("Illegal ID3v2 tag length");break}const i=e.slice(n,n+s);n+=s;const o=this.readFrameHeader(i,this.id3Header.version.major),l=e.slice(n,n+o.length);n+=o.length;const c=Qr.readFrameData(l,o,this.id3Header.version.major,!this.options.skipCovers,this.metadata);c&&r.push({id:o.id,value:c})}return r}readFrameHeader(e,n){let r;switch(n){case 2:r={id:U2.decode(e.slice(0,3)),length:Mn.get(e,3)},r.id.match(/[A-Z0-9]{3}/g)||this.metadata.addWarning(`Invalid ID3v2.${this.id3Header.version.major} frame-header-ID: ${r.id}`);break;case 3:case 4:r={id:U2.decode(e.slice(0,4)),length:(n===4?qN:de).get(e,4),flags:Qr.readFrameFlags(e.slice(8,10))},r.id.match(/[A-Z0-9]{4}/g)||this.metadata.addWarning(`Invalid ID3v2.${this.id3Header.version.major} frame-header-ID: ${r.id}`);break;default:throw new Error(`Unexpected majorVer: ${n}`)}return r}}const NK={NONE:"not compressed	PCM	Apple Computer",sowt:"PCM (byte swapped)",fl32:"32-bit floating point IEEE 32-bit float",fl64:"64-bit floating point IEEE 64-bit float	Apple Computer",alaw:"ALaw 2:1	8-bit ITU-T G.711 A-law",ulaw:"µLaw 2:1	8-bit ITU-T G.711 µ-law	Apple Computer",ULAW:"CCITT G.711 u-law 8-bit ITU-T G.711 µ-law",ALAW:"CCITT G.711 A-law 8-bit ITU-T G.711 A-law",FL32:"Float 32	IEEE 32-bit float "};class AK{constructor(e,n){this.isAifc=n;const r=n?22:18;if(e.chunkSize<r)throw new Error(`COMMON CHUNK size should always be at least ${r}`);this.len=e.chunkSize}get(e,n){const r=We.get(e,n+8)-16398,s=We.get(e,n+8+2),i={numChannels:We.get(e,n),numSampleFrames:de.get(e,n+2),sampleSize:We.get(e,n+6),sampleRate:r<0?s>>Math.abs(r):s<<r};if(this.isAifc){if(i.compressionType=nt.get(e,n+18),this.len>22){const o=Te.get(e,n+22);if(o>0){const l=(o+1)%2;if(23+o+l===this.len)i.compressionName=new le(o,"latin1").get(e,n+23);else throw new Error("Illegal pstring length")}else i.compressionName=void 0}}else i.compressionName="PCM";return i}}const Xg={len:8,get:(t,e)=>({chunkID:nt.get(t,e),chunkSize:Number(BigInt(de.get(t,e+4)))})},Yg=Qe("music-metadata:parser:aiff");class PK extends Er{constructor(){super(...arguments),this.isCompressed=null}async parse(){if((await this.tokenizer.readToken(Xg)).chunkID!=="FORM")throw new Error("Invalid Chunk-ID, expected 'FORM'");const n=await this.tokenizer.readToken(nt);switch(n){case"AIFF":this.metadata.setFormat("container",n),this.isCompressed=!1;break;case"AIFC":this.metadata.setFormat("container","AIFF-C"),this.isCompressed=!0;break;default:throw new Error(`Unsupported AIFF type: ${n}`)}this.metadata.setFormat("lossless",!this.isCompressed);try{for(;!this.tokenizer.fileInfo.size||this.tokenizer.fileInfo.size-this.tokenizer.position>=Xg.len;){Yg(`Reading AIFF chunk at offset=${this.tokenizer.position}`);const r=await this.tokenizer.readToken(Xg),s=2*Math.round(r.chunkSize/2),i=await this.readData(r);await this.tokenizer.ignore(s-i)}}catch(r){if(r instanceof vt)Yg("End-of-stream");else throw r}}async readData(e){switch(e.chunkID){case"COMM":{if(this.isCompressed===null)throw new Error("Failed to parse AIFF.COMM chunk when compression type is unknown");const n=await this.tokenizer.readToken(new AK(e,this.isCompressed));return this.metadata.setFormat("bitsPerSample",n.sampleSize),this.metadata.setFormat("sampleRate",n.sampleRate),this.metadata.setFormat("numberOfChannels",n.numChannels),this.metadata.setFormat("numberOfSamples",n.numSampleFrames),this.metadata.setFormat("duration",n.numSampleFrames/n.sampleRate),(n.compressionName||n.compressionType)&&this.metadata.setFormat("codec",n.compressionName??NK[n.compressionType]),e.chunkSize}case"ID3 ":{const n=await this.tokenizer.readToken(new Gn(e.chunkSize)),r=kl(n);return await new Qr().parse(this.metadata,r,this.options),e.chunkSize}case"SSND":return this.metadata.format.duration&&this.metadata.setFormat("bitrate",8*e.chunkSize/this.metadata.format.duration),0;case"NAME":case"AUTH":case"(c) ":case"ANNO":return this.readTextChunk(e);default:return Yg(`Ignore chunk id=${e.chunkID}, size=${e.chunkSize}`),0}}async readTextChunk(e){const r=(await this.tokenizer.readToken(new le(e.chunkSize,"ascii"))).split("\0").map(s=>s.trim()).filter(s=>s==null?void 0:s.length);return await Promise.all(r.map(s=>this.metadata.addTag("AIFF",e.chunkID,s))),e.chunkSize}}class z{static fromBin(e,n=0){return new z(z.decode(e,n))}static decode(e,n=0){const r=new DataView(e.buffer,n);return`${r.getUint32(0,!0).toString(16)}-${r.getUint16(4,!0).toString(16)}-${r.getUint16(6,!0).toString(16)}-${r.getUint16(8).toString(16)}-${Yw(e.slice(n+10,n+16))}`.toUpperCase()}static decodeMediaType(e){switch(e.str){case z.AudioMedia.str:return"audio";case z.VideoMedia.str:return"video";case z.CommandMedia.str:return"command";case z.Degradable_JPEG_Media.str:return"degradable-jpeg";case z.FileTransferMedia.str:return"file-transfer";case z.BinaryMedia.str:return"binary"}}static encode(e){const n=new Uint8Array(16),r=new DataView(n.buffer);return r.setUint32(0,Number.parseInt(e.slice(0,8),16),!0),r.setUint16(4,Number.parseInt(e.slice(9,13),16),!0),r.setUint16(6,Number.parseInt(e.slice(14,18),16),!0),n.set(I2(e.slice(19,23)),8),n.set(I2(e.slice(24)),10),n}constructor(e){this.str=e}equals(e){return this.str===e.str}toBin(){return z.encode(this.str)}}z.HeaderObject=new z("75B22630-668E-11CF-A6D9-00AA0062CE6C");z.DataObject=new z("75B22636-668E-11CF-A6D9-00AA0062CE6C");z.SimpleIndexObject=new z("33000890-E5B1-11CF-89F4-00A0C90349CB");z.IndexObject=new z("D6E229D3-35DA-11D1-9034-00A0C90349BE");z.MediaObjectIndexObject=new z("FEB103F8-12AD-4C64-840F-2A1D2F7AD48C");z.TimecodeIndexObject=new z("3CB73FD0-0C4A-4803-953D-EDF7B6228F0C");z.FilePropertiesObject=new z("8CABDCA1-A947-11CF-8EE4-00C00C205365");z.StreamPropertiesObject=new z("B7DC0791-A9B7-11CF-8EE6-00C00C205365");z.HeaderExtensionObject=new z("5FBF03B5-A92E-11CF-8EE3-00C00C205365");z.CodecListObject=new z("86D15240-311D-11D0-A3A4-00A0C90348F6");z.ScriptCommandObject=new z("1EFB1A30-0B62-11D0-A39B-00A0C90348F6");z.MarkerObject=new z("F487CD01-A951-11CF-8EE6-00C00C205365");z.BitrateMutualExclusionObject=new z("D6E229DC-35DA-11D1-9034-00A0C90349BE");z.ErrorCorrectionObject=new z("75B22635-668E-11CF-A6D9-00AA0062CE6C");z.ContentDescriptionObject=new z("75B22633-668E-11CF-A6D9-00AA0062CE6C");z.ExtendedContentDescriptionObject=new z("D2D0A440-E307-11D2-97F0-00A0C95EA850");z.ContentBrandingObject=new z("2211B3FA-BD23-11D2-B4B7-00A0C955FC6E");z.StreamBitratePropertiesObject=new z("7BF875CE-468D-11D1-8D82-006097C9A2B2");z.ContentEncryptionObject=new z("2211B3FB-BD23-11D2-B4B7-00A0C955FC6E");z.ExtendedContentEncryptionObject=new z("298AE614-2622-4C17-B935-DAE07EE9289C");z.DigitalSignatureObject=new z("2211B3FC-BD23-11D2-B4B7-00A0C955FC6E");z.PaddingObject=new z("1806D474-CADF-4509-A4BA-9AABCB96AAE8");z.ExtendedStreamPropertiesObject=new z("14E6A5CB-C672-4332-8399-A96952065B5A");z.AdvancedMutualExclusionObject=new z("A08649CF-4775-4670-8A16-6E35357566CD");z.GroupMutualExclusionObject=new z("D1465A40-5A79-4338-B71B-E36B8FD6C249");z.StreamPrioritizationObject=new z("D4FED15B-88D3-454F-81F0-ED5C45999E24");z.BandwidthSharingObject=new z("A69609E6-517B-11D2-B6AF-00C04FD908E9");z.LanguageListObject=new z("7C4346A9-EFE0-4BFC-B229-393EDE415C85");z.MetadataObject=new z("C5F8CBEA-5BAF-4877-8467-AA8C44FA4CCA");z.MetadataLibraryObject=new z("44231C94-9498-49D1-A141-1D134E457054");z.IndexParametersObject=new z("D6E229DF-35DA-11D1-9034-00A0C90349BE");z.MediaObjectIndexParametersObject=new z("6B203BAD-3F11-48E4-ACA8-D7613DE2CFA7");z.TimecodeIndexParametersObject=new z("F55E496D-9797-4B5D-8C8B-604DFE9BFB24");z.CompatibilityObject=new z("26F18B5D-4584-47EC-9F5F-0E651F0452C9");z.AdvancedContentEncryptionObject=new z("43058533-6981-49E6-9B74-AD12CB86D58C");z.AudioMedia=new z("F8699E40-5B4D-11CF-A8FD-00805F5C442B");z.VideoMedia=new z("BC19EFC0-5B4D-11CF-A8FD-00805F5C442B");z.CommandMedia=new z("59DACFC0-59E6-11D0-A3AC-00A0C90348F6");z.JFIF_Media=new z("B61BE100-5B4E-11CF-A8FD-00805F5C442B");z.Degradable_JPEG_Media=new z("35907DE0-E415-11CF-A917-00805F5C442B");z.FileTransferMedia=new z("91BD222C-F21C-497A-8B6D-5AA86BFC0185");z.BinaryMedia=new z("3AFB65E2-47EF-40F2-AC2C-70A90D71D343");z.ASF_Index_Placeholder_Object=new z("D9AADE20-7C17-4F9C-BC28-8555DD98E2A2");function FK(t){return MK[t]}function wp(t){return Ni(At(t,"utf-16le"))}const MK=[wp,H2,DK,LK,OK,XN,H2];function H2(t){return new Uint8Array(t)}function DK(t,e=0){return XN(t,e)===1}function LK(t,e=0){return ie.get(t,e)}function OK(t,e=0){return Nn.get(t,e)}function XN(t,e=0){return Ue.get(t,e)}var G2;(function(t){t[t.UnicodeString=0]="UnicodeString",t[t.ByteArray=1]="ByteArray",t[t.Bool=2]="Bool",t[t.DWord=3]="DWord",t[t.QWord=4]="QWord",t[t.Word=5]="Word"})(G2||(G2={}));const $K={len:30,get:(t,e)=>({objectId:z.fromBin(t,e),objectSize:Number(Nn.get(t,e+16)),numberOfHeaderObjects:ie.get(t,e+24)})},ja={len:24,get:(t,e)=>({objectId:z.fromBin(t,e),objectSize:Number(Nn.get(t,e+16))})};class go{constructor(e){this.len=Number(e.objectSize)-ja.len}postProcessTag(e,n,r,s){if(n==="WM/Picture")e.push({id:n,value:n1.fromBuffer(s)});else{const i=FK(r);if(!i)throw new Error(`unexpected value headerType: ${r}`);e.push({id:n,value:i(s)})}}}class W2 extends go{get(e,n){return null}}class ny extends go{get(e,n){return{fileId:z.fromBin(e,n),fileSize:Nn.get(e,n+16),creationDate:Nn.get(e,n+24),dataPacketsCount:Nn.get(e,n+32),playDuration:Nn.get(e,n+40),sendDuration:Nn.get(e,n+48),preroll:Nn.get(e,n+56),flags:{broadcast:pt(e,n+64,24),seekable:pt(e,n+64,25)},minimumDataPacketSize:ie.get(e,n+68),maximumDataPacketSize:ie.get(e,n+72),maximumBitrate:ie.get(e,n+76)}}}ny.guid=z.FilePropertiesObject;class ry extends go{get(e,n){return{streamType:z.decodeMediaType(z.fromBin(e,n)),errorCorrectionType:z.fromBin(e,n+8)}}}ry.guid=z.StreamPropertiesObject;class sy{constructor(){this.len=22}get(e,n){const r=new DataView(e.buffer,n);return{reserved1:z.fromBin(e,n),reserved2:r.getUint16(16,!0),extensionDataSize:r.getUint16(18,!0)}}}sy.guid=z.HeaderExtensionObject;const zK={len:20,get:(t,e)=>({entryCount:new DataView(t.buffer,e).getUint16(16,!0)})};async function q2(t){const e=await t.readNumber(Ue);return(await t.readToken(new le(e*2,"utf-16le"))).replace("\0","")}async function BK(t){const e=await t.readToken(zK),n=[];for(let r=0;r<e.entryCount;++r)n.push(await UK(t));return n}async function VK(t){const e=await t.readNumber(Ue),n=new Uint8Array(e);return await t.readBuffer(n),n}async function UK(t){const e=await t.readNumber(Ue);return{type:{videoCodec:(e&1)===1,audioCodec:(e&2)===2},codecName:await q2(t),description:await q2(t),information:await VK(t)}}class eo extends go{get(e,n){const r=[],s=new DataView(e.buffer,n);let i=10;for(let o=0;o<eo.contentDescTags.length;++o){const l=s.getUint16(o*2,!0);if(l>0){const c=eo.contentDescTags[o],u=i+l;r.push({id:c,value:wp(e.slice(n+i,n+u))}),i=u}}return r}}eo.guid=z.ContentDescriptionObject;eo.contentDescTags=["Title","Author","Copyright","Description","Rating"];class iy extends go{get(e,n){const r=[],s=new DataView(e.buffer,n),i=s.getUint16(0,!0);let o=2;for(let l=0;l<i;l+=1){const c=s.getUint16(o,!0);o+=2;const u=wp(e.slice(n+o,n+o+c));o+=c;const d=s.getUint16(o,!0);o+=2;const m=s.getUint16(o,!0);o+=2;const p=e.slice(n+o,n+o+m);o+=m,this.postProcessTag(r,u,d,p)}return r}}iy.guid=z.ExtendedContentDescriptionObject;class ay extends go{get(e,n){const r=new DataView(e.buffer,n);return{startTime:Nn.get(e,n),endTime:Nn.get(e,n+8),dataBitrate:r.getInt32(12,!0),bufferSize:r.getInt32(16,!0),initialBufferFullness:r.getInt32(20,!0),alternateDataBitrate:r.getInt32(24,!0),alternateBufferSize:r.getInt32(28,!0),alternateInitialBufferFullness:r.getInt32(32,!0),maximumObjectSize:r.getInt32(36,!0),flags:{reliableFlag:pt(e,n+40,0),seekableFlag:pt(e,n+40,1),resendLiveCleanpointsFlag:pt(e,n+40,2)},streamNumber:r.getInt16(42,!0),streamLanguageId:r.getInt16(44,!0),averageTimePerFrame:r.getInt32(52,!0),streamNameCount:r.getInt32(54,!0),payloadExtensionSystems:r.getInt32(56,!0),streamNames:[],streamPropertiesObject:null}}}ay.guid=z.ExtendedStreamPropertiesObject;class Gf extends go{get(e,n){const r=[],s=new DataView(e.buffer,n),i=s.getUint16(0,!0);let o=2;for(let l=0;l<i;l+=1){o+=4;const c=s.getUint16(o,!0);o+=2;const u=s.getUint16(o,!0);o+=2;const d=s.getUint32(o,!0);o+=4;const m=wp(e.slice(n+o,n+o+c));o+=c;const p=e.slice(n+o,n+o+d);o+=d,this.postProcessTag(r,m,u,p)}return r}}Gf.guid=z.MetadataObject;class oy extends Gf{}oy.guid=z.MetadataLibraryObject;class n1{static fromBuffer(e){return new n1(e.length).get(e,0)}constructor(e){this.len=e}get(e,n){const r=new DataView(e.buffer,n),s=r.getUint8(0),i=r.getInt32(1,!0);let o=5;for(;r.getUint16(o)!==0;)o+=2;const l=new le(o-5,"utf-16le").get(e,5);for(;r.getUint16(o)!==0;)o+=2;const c=new le(o-5,"utf-16le").get(e,5);return{type:ju[s],format:l,description:c,size:i,data:e.slice(o+4)}}}const ih=Qe("music-metadata:parser:ASF"),HK="asf";class GK extends Er{async parse(){const e=await this.tokenizer.readToken($K);if(!e.objectId.equals(z.HeaderObject))throw new Error(`expected asf header; but was not found; got: ${e.objectId.str}`);try{await this.parseObjectHeader(e.numberOfHeaderObjects)}catch(n){ih("Error while parsing ASF: %s",n)}}async parseObjectHeader(e){let n;do{const r=await this.tokenizer.readToken(ja);switch(ih("header GUID=%s",r.objectId.str),r.objectId.str){case ny.guid.str:{const s=await this.tokenizer.readToken(new ny(r));this.metadata.setFormat("duration",Number(s.playDuration/BigInt(1e3))/1e4-Number(s.preroll)/1e3),this.metadata.setFormat("bitrate",s.maximumBitrate);break}case ry.guid.str:{const s=await this.tokenizer.readToken(new ry(r));this.metadata.setFormat("container",`ASF/${s.streamType}`);break}case sy.guid.str:{const s=await this.tokenizer.readToken(new sy);await this.parseExtensionObject(s.extensionDataSize);break}case eo.guid.str:n=await this.tokenizer.readToken(new eo(r)),await this.addTags(n);break;case iy.guid.str:n=await this.tokenizer.readToken(new iy(r)),await this.addTags(n);break;case z.CodecListObject.str:{const s=await BK(this.tokenizer);s.forEach(o=>{this.metadata.addStreamInfo({type:o.type.videoCodec?Za.video:Za.audio,codecName:o.codecName})});const i=s.filter(o=>o.type.audioCodec).map(o=>o.codecName).join("/");this.metadata.setFormat("codec",i);break}case z.StreamBitratePropertiesObject.str:await this.tokenizer.ignore(r.objectSize-ja.len);break;case z.PaddingObject.str:ih("Padding: %s bytes",r.objectSize-ja.len),await this.tokenizer.ignore(r.objectSize-ja.len);break;default:this.metadata.addWarning(`Ignore ASF-Object-GUID: ${r.objectId.str}`),ih("Ignore ASF-Object-GUID: %s",r.objectId.str),await this.tokenizer.readToken(new W2(r))}}while(--e)}async addTags(e){await Promise.all(e.map(({id:n,value:r})=>this.metadata.addTag(HK,n,r)))}async parseExtensionObject(e){do{const n=await this.tokenizer.readToken(ja),r=n.objectSize-ja.len;switch(n.objectId.str){case ay.guid.str:await this.tokenizer.readToken(new ay(n));break;case Gf.guid.str:{const s=await this.tokenizer.readToken(new Gf(n));await this.addTags(s);break}case oy.guid.str:{const s=await this.tokenizer.readToken(new oy(n));await this.addTags(s);break}case z.PaddingObject.str:await this.tokenizer.ignore(r);break;case z.CompatibilityObject.str:this.tokenizer.ignore(r);break;case z.ASF_Index_Placeholder_Object.str:await this.tokenizer.ignore(r);break;default:this.metadata.addWarning(`Ignore ASF-Object-GUID: ${n.objectId.str}`),await this.tokenizer.readToken(new W2(n));break}e-=n.objectSize}while(e>0)}}class ku{static fromBase64(e){return ku.fromBuffer(Uint8Array.from(atob(e),n=>n.charCodeAt(0)))}static fromBuffer(e){return new ku(e.length).get(e,0)}constructor(e){this.len=e}get(e,n){const r=ju[de.get(e,n)];n+=4;const s=de.get(e,n);n+=4;const i=new le(s,"utf-8").get(e,n);n+=s;const o=de.get(e,n);n+=4;const l=new le(o,"utf-8").get(e,n);n+=o;const c=de.get(e,n);n+=4;const u=de.get(e,n);n+=4;const d=de.get(e,n);n+=4;const m=de.get(e,n);n+=4;const p=de.get(e,n);n+=4;const g=Uint8Array.from(e.slice(n,n+p));return{type:r,format:i,description:l,width:c,height:u,colour_depth:d,indexed_color:m,data:g}}}const ah={len:7,get:(t,e)=>({packetType:Te.get(t,e),vorbis:new le(6,"ascii").get(t,e+1)})},WK={len:23,get:(t,e)=>({version:ie.get(t,e+0),channelMode:Te.get(t,e+4),sampleRate:ie.get(t,e+5),bitrateMax:ie.get(t,e+9),bitrateNominal:ie.get(t,e+13),bitrateMin:ie.get(t,e+17)})},Jg=Qe("music-metadata:parser:ID3");class _p extends Er{constructor(){super(...arguments),this.id3parser=new Qr}static async startsWithID3v2Header(e){return(await e.peekToken(ey)).fileIdentifier==="ID3"}async parse(){try{await this.parseID3v2()}catch(e){if(e instanceof vt)Jg("End-of-stream");else throw e}}finalize(){}async parseID3v2(){await this.tryReadId3v2Headers(),Jg("End of ID3v2 header, go to MPEG-parser: pos=%s",this.tokenizer.position),await this.postId3v2Parse(),this.options.skipPostHeaders&&this.metadata.hasAny()?this.finalize():(await new t1().init(this.metadata,this.tokenizer,this.options).parse(),this.finalize())}async tryReadId3v2Headers(){if((await this.tokenizer.peekToken(ey)).fileIdentifier==="ID3")return Jg("Found ID3v2 header, pos=%s",this.tokenizer.position),await this.id3parser.parse(this.metadata,this.tokenizer,this.options),this.tryReadId3v2Headers()}}class YN{constructor(e,n){this.data=e,this.offset=n}readInt32(){const e=ie.get(this.data,this.offset);return this.offset+=4,e}readStringUtf8(){const e=this.readInt32(),n=new TextDecoder("utf-8").decode(this.data.subarray(this.offset,this.offset+e));return this.offset+=e,n}parseUserComment(){const e=this.offset,n=this.readStringUtf8(),r=n.indexOf("=");return{key:n.slice(0,r).toUpperCase(),value:n.slice(r+1),len:this.offset-e}}}const ko=Qe("music-metadata:parser:ogg:vorbis1");class to{constructor(e,n){this.metadata=e,this.options=n,this.pageSegments=[]}async parsePage(e,n){if(e.headerType.firstPage)this.parseFirstPage(e,n);else{if(e.headerType.continued){if(this.pageSegments.length===0)throw new Error("Cannot continue on previous page");this.pageSegments.push(n)}if(e.headerType.lastPage||!e.headerType.continued){if(this.pageSegments.length>0){const r=to.mergeUint8Arrays(this.pageSegments);await this.parseFullPage(r)}this.pageSegments=e.headerType.lastPage?[]:[n]}}e.headerType.lastPage&&this.calculateDuration(e)}static mergeUint8Arrays(e){const n=e.reduce((s,i)=>s+i.length,0),r=new Uint8Array(n);return e.forEach((s,i,o)=>{const l=o.slice(0,i).reduce((c,u)=>c+u.length,0);r.set(s,l)}),r}async flush(){await this.parseFullPage(to.mergeUint8Arrays(this.pageSegments))}async parseUserComment(e,n){const s=new YN(e,n).parseUserComment();return await this.addTag(s.key,s.value),s.len}async addTag(e,n){if(e==="METADATA_BLOCK_PICTURE"&&typeof n=="string"){if(this.options.skipCovers){ko("Ignore picture");return}n=ku.fromBase64(n),ko(`Push picture: id=${e}, format=${n.format}`)}else ko(`Push tag: id=${e}, value=${n}`);await this.metadata.addTag("vorbis",e,n)}calculateDuration(e){this.metadata.format.sampleRate&&e.absoluteGranulePosition>=0&&(this.metadata.setFormat("numberOfSamples",e.absoluteGranulePosition),this.metadata.setFormat("duration",e.absoluteGranulePosition/this.metadata.format.sampleRate))}parseFirstPage(e,n){this.metadata.setFormat("codec","Vorbis I"),ko("Parse first page");const r=ah.get(n,0);if(r.vorbis!=="vorbis")throw new Error("Metadata does not look like Vorbis");if(r.packetType===1){const s=WK.get(n,ah.len);this.metadata.setFormat("sampleRate",s.sampleRate),this.metadata.setFormat("bitrate",s.bitrateNominal),this.metadata.setFormat("numberOfChannels",s.channelMode),ko("sample-rate=%s[hz], bitrate=%s[b/s], channel-mode=%s",s.sampleRate,s.bitrateNominal,s.channelMode)}else throw new Error("First Ogg page should be type 1: the identification header")}async parseFullPage(e){const n=ah.get(e,0);switch(ko("Parse full page: type=%s, byteLength=%s",n.packetType,e.byteLength),n.packetType){case 3:return this.parseUserCommentList(e,ah.len)}}async parseUserCommentList(e,n){const r=ie.get(e,n);n+=4,n+=r;let s=ie.get(e,n);for(n+=4;s-- >0;)n+=await this.parseUserComment(e,n)}}const qK=Qe("music-metadata:parser:FLAC");var Ls;(function(t){t[t.STREAMINFO=0]="STREAMINFO",t[t.PADDING=1]="PADDING",t[t.APPLICATION=2]="APPLICATION",t[t.SEEKTABLE=3]="SEEKTABLE",t[t.VORBIS_COMMENT=4]="VORBIS_COMMENT",t[t.CUESHEET=5]="CUESHEET",t[t.PICTURE=6]="PICTURE"})(Ls||(Ls={}));class KK extends _p{constructor(){super(...arguments),this.padding=0}init(e,n,r){return super.init(e,n,r),this.vorbisParser=new to(e,r),this}async postId3v2Parse(){if((await this.tokenizer.readToken(nt)).toString()!=="fLaC")throw new Error("Invalid FLAC preamble");let n;do n=await this.tokenizer.readToken(QK),await this.parseDataBlock(n);while(!n.lastBlock);if(this.tokenizer.fileInfo.size&&this.metadata.format.duration){const r=this.tokenizer.fileInfo.size-this.tokenizer.position;this.metadata.setFormat("bitrate",8*r/this.metadata.format.duration)}}async parseDataBlock(e){switch(qK(`blockHeader type=${e.type}, length=${e.length}`),e.type){case Ls.STREAMINFO:return this.parseBlockStreamInfo(e.length);case Ls.PADDING:this.padding+=e.length;break;case Ls.APPLICATION:break;case Ls.SEEKTABLE:break;case Ls.VORBIS_COMMENT:return this.parseComment(e.length);case Ls.CUESHEET:break;case Ls.PICTURE:await this.parsePicture(e.length);return;default:this.metadata.addWarning(`Unknown block type: ${e.type}`)}return this.tokenizer.ignore(e.length).then()}async parseBlockStreamInfo(e){if(e!==K2.len)throw new Error("Unexpected block-stream-info length");const n=await this.tokenizer.readToken(K2);this.metadata.setFormat("container","FLAC"),this.metadata.setFormat("codec","FLAC"),this.metadata.setFormat("lossless",!0),this.metadata.setFormat("numberOfChannels",n.channels),this.metadata.setFormat("bitsPerSample",n.bitsPerSample),this.metadata.setFormat("sampleRate",n.sampleRate),n.totalSamples>0&&this.metadata.setFormat("duration",n.totalSamples/n.sampleRate)}async parseComment(e){const n=await this.tokenizer.readToken(new Gn(e)),r=new YN(n,0);r.readStringUtf8();const s=r.readInt32(),i=new Array(s);for(let o=0;o<s;o++)i[o]=r.parseUserComment();await Promise.all(i.map(o=>this.vorbisParser.addTag(o.key,o.value)))}async parsePicture(e){if(this.options.skipCovers)return this.tokenizer.ignore(e);const n=await this.tokenizer.readToken(new ku(e));this.vorbisParser.addTag("METADATA_BLOCK_PICTURE",n)}}const QK={len:4,get:(t,e)=>({lastBlock:pt(t,e,7),type:Me(t,e,1,7),length:Mn.get(t,e+1)})},K2={len:34,get:(t,e)=>({minimumBlockSize:We.get(t,e),maximumBlockSize:We.get(t,e+2)/1e3,minimumFrameSize:Mn.get(t,e+4),maximumFrameSize:Mn.get(t,e+7),sampleRate:Mn.get(t,e+10)>>4,channels:Me(t,e+12,4,3)+1,bitsPerSample:Me(t,e+12,7,5)+1,totalSamples:Me(t,e+13,4,36),fileMD5:new Gn(16).get(t,e+18)})},JN=Qe("music-metadata:parser:MP4:atom"),Wf={len:8,get:(t,e)=>{const n=de.get(t,e);if(n<0)throw new Error("Invalid atom header length");return{length:BigInt(n),name:new le(4,"latin1").get(t,e+4)}},put:(t,e,n)=>(de.put(t,e,Number(n.length)),nt.put(t,e+4,n.name))},XK=Qw,Q2={len:4,get:(t,e)=>({type:new le(4,"ascii").get(t,e)})};class ZN{constructor(e,n,r){if(this.len=e,e<n)throw new Error(`Atom ${r} expected to be ${n}, but specifies ${e} bytes long.`);e>n&&JN(`Warning: atom ${r} expected to be ${n}, but was actually ${e} bytes long.`)}}const Tl={len:4,get:(t,e)=>{const n=de.get(t,e)-2082844800;return new Date(n*1e3)}};class YK extends ZN{constructor(e){super(e,24,"mdhd"),this.len=e}get(e,n){return{version:Te.get(e,n+0),flags:Mn.get(e,n+1),creationTime:Tl.get(e,n+4),modificationTime:Tl.get(e,n+8),timeScale:de.get(e,n+12),duration:de.get(e,n+16),language:We.get(e,n+20),quality:We.get(e,n+22)}}}class JK extends ZN{constructor(e){super(e,100,"mvhd"),this.len=e}get(e,n){return{version:Te.get(e,n),flags:Mn.get(e,n+1),creationTime:Tl.get(e,n+4),modificationTime:Tl.get(e,n+8),timeScale:de.get(e,n+12),duration:de.get(e,n+16),preferredRate:de.get(e,n+20),preferredVolume:We.get(e,n+24),previewTime:de.get(e,n+72),previewDuration:de.get(e,n+76),posterTime:de.get(e,n+80),selectionTime:de.get(e,n+84),selectionDuration:de.get(e,n+88),currentTime:de.get(e,n+92),nextTrackID:de.get(e,n+96)}}}class ZK{constructor(e){this.len=e}get(e,n){return{type:{set:Te.get(e,n+0),type:Mn.get(e,n+1)},locale:Mn.get(e,n+4),value:new Gn(this.len-8).get(e,n+8)}}}class eQ{constructor(e){this.len=e}get(e,n){return{version:Te.get(e,n),flags:Mn.get(e,n+1),name:new le(this.len-4,"utf-8").get(e,n+4)}}}class tQ{constructor(e){this.len=e}get(e,n){return{version:Te.get(e,n),flags:Mn.get(e,n+1),creationTime:Tl.get(e,n+4),modificationTime:Tl.get(e,n+8),trackId:de.get(e,n+12),duration:de.get(e,n+20),layer:We.get(e,n+24),alternateGroup:We.get(e,n+26),volume:We.get(e,n+28)}}}const X2={len:8,get:(t,e)=>({version:Te.get(t,e),flags:Mn.get(t,e+1),numberOfEntries:de.get(t,e+4)})};class nQ{constructor(e){this.len=e}get(e,n){return{dataFormat:nt.get(e,n),dataReferenceIndex:We.get(e,n+10),description:new Gn(this.len-12).get(e,n+12)}}}class rQ{constructor(e){this.len=e}get(e,n){const r=X2.get(e,n);n+=X2.len;const s=[];for(let i=0;i<r.numberOfEntries;++i){const o=de.get(e,n);n+=de.len,s.push(new nQ(o).get(e,n)),n+=o}return{header:r,table:s}}}const Y2={len:8,get(t,e){return{version:Ws.get(t,e),revision:Ws.get(t,e+2),vendor:pr.get(t,e+4)}}},sQ={len:12,get(t,e){return{numAudioChannels:Ws.get(t,e+0),sampleSize:Ws.get(t,e+2),compressionId:Ws.get(t,e+4),packetSize:Ws.get(t,e+6),sampleRate:We.get(t,e+8)+We.get(t,e+10)/1e4}}};class r1{constructor(e,n){this.len=e,this.token=n}get(e,n){const r=pr.get(e,n+4);return{version:Eu.get(e,n+0),flags:Kw.get(e,n+1),numberOfEntries:r,entries:eA(e,this.token,n+8,this.len-8,r)}}}const iQ={len:8,get(t,e){return{count:pr.get(t,e+0),duration:pr.get(t,e+4)}}};class aQ extends r1{constructor(e){super(e,iQ),this.len=e}}const oQ={len:12,get(t,e){return{firstChunk:pr.get(t,e),samplesPerChunk:pr.get(t,e+4),sampleDescriptionId:pr.get(t,e+8)}}};class lQ extends r1{constructor(e){super(e,oQ),this.len=e}}class cQ{constructor(e){this.len=e}get(e,n){const r=pr.get(e,n+8);return{version:Eu.get(e,n),flags:Kw.get(e,n+1),sampleSize:pr.get(e,n+4),numberOfEntries:r,entries:eA(e,pr,n+12,this.len-12,r)}}}class uQ extends r1{constructor(e){super(e,pr),this.len=e}}class dQ{constructor(e){this.len=e}get(e,n){const r=Ws.get(e,n+0);return new le(r,"utf-8").get(e,n+2)}}function eA(t,e,n,r,s){if(JN(`remainingLen=${r}, numberOfEntries=${s} * token-len=${e.len}`),r===0)return[];if(r!==s*e.len)throw new Error("mismatch number-of-entries with remaining atom-length");const i=[];for(let o=0;o<s;++o)i.push(e.get(t,n)),n+=e.len;return i}const hQ=Qe("music-metadata:parser:MP4:Atom");class qf{static async readAtom(e,n,r,s){const i=e.position,o=await e.readToken(Wf);o.length===BigInt(1)&&(o.length=await e.readToken(XK));const c=new qf(o,o.length===BigInt(1),r),u=c.getPayloadLength(s);return hQ(`parse atom name=${c.atomPath}, extended=${c.extended}, offset=${i}, len=${c.header.length}`),await c.readData(e,n,u),c}constructor(e,n,r){this.header=e,this.extended=n,this.parent=r,this.children=[],this.atomPath=(this.parent?`${this.parent.atomPath}.`:"")+this.header.name}getHeaderLength(){return this.extended?16:8}getPayloadLength(e){return(this.header.length===BigInt(0)?e:Number(this.header.length))-this.getHeaderLength()}async readAtoms(e,n,r){for(;r>0;){const s=await qf.readAtom(e,n,this,r);this.children.push(s),r-=s.header.length===BigInt(0)?r:Number(s.header.length)}}async readData(e,n,r){switch(this.header.name){case"moov":case"udta":case"trak":case"mdia":case"minf":case"stbl":case"<id>":case"ilst":case"tref":return this.readAtoms(e,n,this.getPayloadLength(r));case"meta":{const i=(await e.peekToken(Wf)).name==="hdlr"?0:4;return await e.ignore(i),this.readAtoms(e,n,this.getPayloadLength(r)-i)}default:return n(this,r)}}}const fs=Qe("music-metadata:parser:MP4"),fQ="iTunes",J2={raw:{lossy:!1,format:"raw"},MAC3:{lossy:!0,format:"MACE 3:1"},MAC6:{lossy:!0,format:"MACE 6:1"},ima4:{lossy:!0,format:"IMA 4:1"},ulaw:{lossy:!0,format:"uLaw 2:1"},alaw:{lossy:!0,format:"uLaw 2:1"},Qclp:{lossy:!0,format:"QUALCOMM PureVoice"},".mp3":{lossy:!0,format:"MPEG-1 layer 3"},alac:{lossy:!1,format:"ALAC"},"ac-3":{lossy:!0,format:"AC-3"},mp4a:{lossy:!0,format:"MPEG-4/AAC"},mp4s:{lossy:!0,format:"MP4S"},c608:{lossy:!0,format:"CEA-608"},c708:{lossy:!0,format:"CEA-708"}};function Z2(t,e,n){return n.indexOf(t)===e}class Kf extends Er{constructor(){super(...arguments),this.tracks=[],this.atomParsers={mvhd:async e=>{const n=await this.tokenizer.readToken(new JK(e));this.metadata.setFormat("creationTime",n.creationTime),this.metadata.setFormat("modificationTime",n.modificationTime)},mdhd:async e=>{const n=await this.tokenizer.readToken(new YK(e)),r=this.getTrackDescription();r.creationTime=n.creationTime,r.modificationTime=n.modificationTime,r.timeScale=n.timeScale,r.duration=n.duration},chap:async e=>{const n=this.getTrackDescription(),r=[];for(;e>=de.len;)r.push(await this.tokenizer.readNumber(de)),e-=de.len;n.chapterList=r},tkhd:async e=>{const n=await this.tokenizer.readToken(new tQ(e));this.tracks.push(n)},mdat:async e=>{if(this.audioLengthInBytes=e,this.calculateBitRate(),this.options.includeChapters){const n=this.tracks.filter(r=>r.chapterList);if(n.length===1){const r=n[0].chapterList,s=this.tracks.filter(i=>r.indexOf(i.trackId)!==-1);if(s.length===1)return this.parseChapterTrack(s[0],n[0],e)}}await this.tokenizer.ignore(e)},ftyp:async e=>{const n=[];for(;e>0;){const s=await this.tokenizer.readToken(Q2);e-=Q2.len;const i=s.type.replace(/\W/g,"");i.length>0&&n.push(i)}fs(`ftyp: ${n.join("/")}`);const r=n.filter(Z2).join("/");this.metadata.setFormat("container",r)},stsd:async e=>{const n=await this.tokenizer.readToken(new rQ(e)),r=this.getTrackDescription();r.soundSampleDescription=n.table.map(s=>this.parseSoundSampleDescription(s))},stsc:async e=>{const n=await this.tokenizer.readToken(new lQ(e));this.getTrackDescription().sampleToChunkTable=n.entries},stts:async e=>{const n=await this.tokenizer.readToken(new aQ(e));this.getTrackDescription().timeToSampleTable=n.entries},stsz:async e=>{const n=await this.tokenizer.readToken(new cQ(e)),r=this.getTrackDescription();r.sampleSize=n.sampleSize,r.sampleSizeTable=n.entries},stco:async e=>{const n=await this.tokenizer.readToken(new uQ(e));this.getTrackDescription().chunkOffsetTable=n.entries},date:async e=>{const n=await this.tokenizer.readToken(new le(e,"utf-8"));await this.addTag("date",n)}}}static read_BE_Integer(e,n){const r=(n?"INT":"UINT")+e.length*8+(e.length>1?"_BE":""),s=wq[r];if(!s)throw new Error(`Token for integer type not found: "${r}"`);return Number(s.get(e,0))}async parse(){this.tracks=[];let e=this.tokenizer.fileInfo.size||0;for(;!this.tokenizer.fileInfo.size||e>0;){try{if((await this.tokenizer.peekToken(Wf)).name==="\0\0\0\0"){const o=`Error at offset=${this.tokenizer.position}: box.id=0`;fs(o),this.addWarning(o);break}}catch(i){if(i instanceof Error){const o=`Error at offset=${this.tokenizer.position}: ${i.message}`;fs(o),this.addWarning(o)}else throw i;break}const s=await qf.readAtom(this.tokenizer,(i,o)=>this.handleAtom(i,o),null,e);e-=s.header.length===BigInt(0)?e:Number(s.header.length)}const n=[];this.tracks.forEach(s=>{const i=[];s.soundSampleDescription.forEach(o=>{const l={},c=J2[o.dataFormat];if(c?(i.push(c.format),l.codecName=c.format):l.codecName=`<${o.dataFormat}>`,o.description){const{description:u}=o;u.sampleRate>0&&(l.type=Za.audio,l.audio={samplingFrequency:u.sampleRate,bitDepth:u.sampleSize,channels:u.numAudioChannels})}this.metadata.addStreamInfo(l)}),i.length>=1&&n.push(i.join("/"))}),n.length>0&&this.metadata.setFormat("codec",n.filter(Z2).join("+"));const r=this.tracks.filter(s=>s.soundSampleDescription.length>=1&&s.soundSampleDescription[0].description&&s.soundSampleDescription[0].description.numAudioChannels>0);if(r.length>=1){const s=r[0];if(s.timeScale>0){const l=s.duration/s.timeScale;this.metadata.setFormat("duration",l)}const i=s.soundSampleDescription[0];if(i.description&&(this.metadata.setFormat("sampleRate",i.description.sampleRate),this.metadata.setFormat("bitsPerSample",i.description.sampleSize),this.metadata.setFormat("numberOfChannels",i.description.numAudioChannels),s.timeScale===0&&s.timeToSampleTable.length>0)){const c=s.timeToSampleTable.map(u=>u.count*u.duration).reduce((u,d)=>u+d)/i.description.sampleRate;this.metadata.setFormat("duration",c)}const o=J2[i.dataFormat];o&&this.metadata.setFormat("lossless",!o.lossy),this.calculateBitRate()}}async handleAtom(e,n){if(e.parent)switch(e.parent.header.name){case"ilst":case"<id>":return this.parseMetadataItemData(e)}if(this.atomParsers[e.header.name])return this.atomParsers[e.header.name](n);fs(`No parser for atom path=${e.atomPath}, payload-len=${n}, ignoring atom`),await this.tokenizer.ignore(n)}getTrackDescription(){return this.tracks[this.tracks.length-1]}calculateBitRate(){this.audioLengthInBytes&&this.metadata.format.duration&&this.metadata.setFormat("bitrate",8*this.audioLengthInBytes/this.metadata.format.duration)}async addTag(e,n){await this.metadata.addTag(fQ,e,n)}addWarning(e){fs(`Warning: ${e}`),this.metadata.addWarning(e)}parseMetadataItemData(e){let n=e.header.name;return e.readAtoms(this.tokenizer,async(r,s)=>{const i=r.getPayloadLength(s);switch(r.header.name){case"data":return this.parseValueAtom(n,r);case"name":case"mean":case"rate":{const o=await this.tokenizer.readToken(new eQ(i));n+=`:${o.name}`;break}default:{const o=await this.tokenizer.readToken(new Gn(i));this.addWarning(`Unsupported meta-item: ${n}[${r.header.name}] => value=${Yw(o)} ascii=${Xw(o,"ascii")}`)}}},e.getPayloadLength(0))}async parseValueAtom(e,n){const r=await this.tokenizer.readToken(new ZK(Number(n.header.length)-Wf.len));if(r.type.set!==0)throw new Error(`Unsupported type-set != 0: ${r.type.set}`);switch(r.type.type){case 0:switch(e){case"trkn":case"disk":{const s=Te.get(r.value,3),i=Te.get(r.value,5);await this.addTag(e,`${s}/${i}`);break}case"gnre":{const s=Te.get(r.value,1),i=Hf[s-1];await this.addTag(e,i);break}case"rate":{const s=new TextDecoder("ascii").decode(r.value);await this.addTag(e,s);break}default:fs(`unknown proprietary value type for: ${n.atomPath}`)}break;case 1:case 18:await this.addTag(e,new TextDecoder("utf-8").decode(r.value));break;case 13:if(this.options.skipCovers)break;await this.addTag(e,{format:"image/jpeg",data:Uint8Array.from(r.value)});break;case 14:if(this.options.skipCovers)break;await this.addTag(e,{format:"image/png",data:Uint8Array.from(r.value)});break;case 21:await this.addTag(e,Kf.read_BE_Integer(r.value,!0));break;case 22:await this.addTag(e,Kf.read_BE_Integer(r.value,!1));break;case 65:await this.addTag(e,Te.get(r.value,0));break;case 66:await this.addTag(e,We.get(r.value,0));break;case 67:await this.addTag(e,de.get(r.value,0));break;default:this.addWarning(`atom key=${e}, has unknown well-known-type (data-type): ${r.type.type}`)}}parseSoundSampleDescription(e){const n={dataFormat:e.dataFormat,dataReferenceIndex:e.dataReferenceIndex};let r=0;const s=Y2.get(e.description,r);return r+=Y2.len,s.version===0||s.version===1?n.description=sQ.get(e.description,r):fs(`Warning: sound-sample-description ${s} not implemented`),n}async parseChapterTrack(e,n,r){if(!e.sampleSize&&e.chunkOffsetTable.length!==e.sampleSizeTable.length)throw new Error("Expected equal chunk-offset-table & sample-size-table length.");const s=[];for(let i=0;i<e.chunkOffsetTable.length&&r>0;++i){const l=e.chunkOffsetTable[i]-this.tokenizer.position,c=e.sampleSize>0?e.sampleSize:e.sampleSizeTable[i];if(r-=l+c,r<0)throw new Error("Chapter chunk exceeding token length");await this.tokenizer.ignore(l);const u=await this.tokenizer.readToken(new dQ(c));fs(`Chapter ${i+1}: ${u}`);const d={title:u,sampleOffset:this.findSampleOffset(n,this.tokenizer.position)};fs(`Chapter title=${d.title}, offset=${d.sampleOffset}/${this.tracks[0].duration}`),s.push(d)}this.metadata.setFormat("chapters",s),await this.tokenizer.ignore(r)}findSampleOffset(e,n){let r=0;e.timeToSampleTable.forEach(i=>{r+=i.count*i.duration}),fs(`Total duration=${r}`);let s=0;for(;s<e.chunkOffsetTable.length&&e.chunkOffsetTable[s]<n;)++s;return this.getChunkDuration(s+1,e)}getChunkDuration(e,n){let r=0,s=n.timeToSampleTable[r].count,i=n.timeToSampleTable[r].duration,o=1,l=this.getSamplesPerChunk(o,n.sampleToChunkTable),c=0;for(;o<e;){const u=Math.min(s,l);c+=u*i,s-=u,l-=u,l===0?(++o,l=this.getSamplesPerChunk(o,n.sampleToChunkTable)):(++r,s=n.timeToSampleTable[r].count,i=n.timeToSampleTable[r].duration)}return c}getSamplesPerChunk(e,n){for(let r=0;r<n.length-1;++r)if(e>=n[r].firstChunk&&e<n[r+1].firstChunk)return n[r].samplesPerChunk;return n[n.length-1].samplesPerChunk}}var eE;(function(t){t[t.not_set=0]="not_set",t[t.radio=1]="radio",t[t.audiophile=2]="audiophile"})(eE||(eE={}));var tE;(function(t){t[t.unspecified=0]="unspecified",t[t.engineer=1]="engineer",t[t.user=2]="user",t[t.automatic=3]="automatic",t[t.rms_average=4]="rms_average"})(tE||(tE={}));const nE={len:2,get:(t,e)=>{const n=Me(t,e,0,3),r=Me(t,e,6,1),s=Me(t,e,7,9)/10;if(n>0)return{type:Me(t,e,0,3),origin:Me(t,e,3,3),adjustment:r?-s:s}}},mQ={len:27,get:(t,e)=>{const n=de.get(t,e+2);return{revision:Me(t,e,0,4),vbr_method:Me(t,e,4,4),lowpass_filter:100*Te.get(t,e+1),track_peak:n===0?null:n/2**23,track_gain:nE.get(t,6),album_gain:nE.get(t,8),music_length:de.get(t,e+20),music_crc:Te.get(t,e+24),header_crc:We.get(t,e+24)}}},rE=new le(4,"ascii"),Zg=new le(6,"ascii"),pQ={len:4,get:(t,e)=>({frames:cr(t,e,31),bytes:cr(t,e,30),toc:cr(t,e,29),vbrScale:cr(t,e,28)})};async function gQ(t){const e=await t.readToken(pQ),n={numFrames:null,streamSize:null,vbrScale:null};if(e.frames&&(n.numFrames=await t.readToken(de)),e.bytes&&(n.streamSize=await t.readToken(de)),e.toc&&(n.toc=new Uint8Array(100),await t.readBuffer(n.toc)),e.vbrScale&&(n.vbrScale=await t.readToken(de)),await t.peekToken(new le(4,"ascii"))==="LAME"){await t.ignore(4),n.lame={version:await t.readToken(new le(5,"ascii"))};const s=n.lame.version.match(/\d+.\d+/g);if(s!==null){const o=s[0].split(".").map(l=>Number.parseInt(l,10));o[0]>=3&&o[1]>=90&&(n.lame.extended=await t.readToken(mQ))}}return n}const ar=Qe("music-metadata:parser:mpeg"),sE=1024,iE={AudioObjectTypes:["AAC Main","AAC LC","AAC SSR","AAC LTP"],SamplingFrequencies:[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350,null,null,-1]},xQ=[void 0,["front-center"],["front-left","front-right"],["front-center","front-left","front-right"],["front-center","front-left","front-right","back-center"],["front-center","front-left","front-right","back-left","back-right"],["front-center","front-left","front-right","back-left","back-right","LFE-channel"],["front-center","front-left","front-right","side-left","side-right","back-left","back-right","LFE-channel"]];class Ut{constructor(e,n){this.bitrateIndex=null,this.sampRateFreqIndex=null,this.padding=null,this.privateBit=null,this.channelModeIndex=null,this.modeExtension=null,this.isOriginalMedia=null,this.version=null,this.bitrate=null,this.samplingRate=null,this.frameLength=0,this.versionIndex=Me(e,n+1,3,2),this.layer=Ut.LayerDescription[Me(e,n+1,5,2)],this.versionIndex>1&&this.layer===0?this.parseAdtsHeader(e,n):this.parseMpegHeader(e,n),this.isProtectedByCRC=!cr(e,n+1,7)}calcDuration(e){return this.samplingRate==null?null:e*this.calcSamplesPerFrame()/this.samplingRate}calcSamplesPerFrame(){return Ut.samplesInFrameTable[this.version===1?0:1][this.layer]}calculateSideInfoLength(){if(this.layer!==3)return 2;if(this.channelModeIndex===3){if(this.version===1)return 17;if(this.version===2||this.version===2.5)return 9}else{if(this.version===1)return 32;if(this.version===2||this.version===2.5)return 17}return null}calcSlotSize(){return[null,4,1,1][this.layer]}parseMpegHeader(e,n){this.container="MPEG",this.bitrateIndex=Me(e,n+2,0,4),this.sampRateFreqIndex=Me(e,n+2,4,2),this.padding=cr(e,n+2,6),this.privateBit=cr(e,n+2,7),this.channelModeIndex=Me(e,n+3,0,2),this.modeExtension=Me(e,n+3,2,2),this.isCopyrighted=cr(e,n+3,4),this.isOriginalMedia=cr(e,n+3,5),this.emphasis=Me(e,n+3,7,2),this.version=Ut.VersionID[this.versionIndex],this.channelMode=Ut.ChannelMode[this.channelModeIndex],this.codec=`MPEG ${this.version} Layer ${this.layer}`;const r=this.calcBitrate();if(!r)throw new Error("Cannot determine bit-rate");if(this.bitrate=r*1e3,this.samplingRate=this.calcSamplingRate(),this.samplingRate==null)throw new Error("Cannot determine sampling-rate")}parseAdtsHeader(e,n){ar("layer=0 => ADTS"),this.version=this.versionIndex===2?4:2,this.container=`ADTS/MPEG-${this.version}`;const r=Me(e,n+2,0,2);this.codec="AAC",this.codecProfile=iE.AudioObjectTypes[r],ar(`MPEG-4 audio-codec=${this.codec}`);const s=Me(e,n+2,2,4);this.samplingRate=iE.SamplingFrequencies[s],ar(`sampling-rate=${this.samplingRate}`);const i=Me(e,n+2,7,3);this.mp4ChannelConfig=xQ[i],ar(`channel-config=${this.mp4ChannelConfig?this.mp4ChannelConfig.join("+"):"?"}`),this.frameLength=Me(e,n+3,6,2)<<11}calcBitrate(){if(this.bitrateIndex===0||this.bitrateIndex===15)return null;if(this.version&&this.bitrateIndex){const e=10*Math.floor(this.version)+this.layer;return Ut.bitrate_index[this.bitrateIndex][e]}return null}calcSamplingRate(){return this.sampRateFreqIndex===3||this.version===null||this.sampRateFreqIndex==null?null:Ut.sampling_rate_freq_index[this.version][this.sampRateFreqIndex]}}Ut.SyncByte1=255;Ut.SyncByte2=224;Ut.VersionID=[2.5,null,2,1];Ut.LayerDescription=[0,3,2,1];Ut.ChannelMode=["stereo","joint_stereo","dual_channel","mono"];Ut.bitrate_index={1:{11:32,12:32,13:32,21:32,22:8,23:8},2:{11:64,12:48,13:40,21:48,22:16,23:16},3:{11:96,12:56,13:48,21:56,22:24,23:24},4:{11:128,12:64,13:56,21:64,22:32,23:32},5:{11:160,12:80,13:64,21:80,22:40,23:40},6:{11:192,12:96,13:80,21:96,22:48,23:48},7:{11:224,12:112,13:96,21:112,22:56,23:56},8:{11:256,12:128,13:112,21:128,22:64,23:64},9:{11:288,12:160,13:128,21:144,22:80,23:80},10:{11:320,12:192,13:160,21:160,22:96,23:96},11:{11:352,12:224,13:192,21:176,22:112,23:112},12:{11:384,12:256,13:224,21:192,22:128,23:128},13:{11:416,12:320,13:256,21:224,22:144,23:144},14:{11:448,12:384,13:320,21:256,22:160,23:160}};Ut.sampling_rate_freq_index={1:{0:44100,1:48e3,2:32e3},2:{0:22050,1:24e3,2:16e3},2.5:{0:11025,1:12e3,2:8e3}};Ut.samplesInFrameTable=[[0,384,1152,1152],[0,384,1152,576]];const aE={len:4,get:(t,e)=>new Ut(t,e)};function yQ(t){return`V${Math.floor((100-t)/10)}`}class vQ extends _p{constructor(){super(...arguments),this.frameCount=0,this.syncFrameCount=-1,this.countSkipFrameData=0,this.totalDataLength=0,this.bitrates=[],this.offset=0,this.frame_size=0,this.crc=null,this.calculateEofDuration=!1,this.samplesPerFrame=null,this.buf_frame_header=new Uint8Array(4),this.mpegOffset=null,this.syncPeek={buf:new Uint8Array(sE),len:0}}async postId3v2Parse(){this.metadata.setFormat("lossless",!1);try{let e=!1;for(;!e;)await this.sync(),e=await this.parseCommonMpegHeader()}catch(e){if(e instanceof vt){if(ar("End-of-stream"),this.calculateEofDuration&&this.samplesPerFrame!==null){const n=this.frameCount*this.samplesPerFrame;if(this.metadata.setFormat("numberOfSamples",n),this.metadata.format.sampleRate){const r=n/this.metadata.format.sampleRate;ar(`Calculate duration at EOF: ${r} sec.`,r),this.metadata.setFormat("duration",r)}}}else throw e}}finalize(){const e=this.metadata.format,n=!!this.metadata.native.ID3v1;if(this.mpegOffset!==null){if(e.duration&&this.tokenizer.fileInfo.size){const r=this.tokenizer.fileInfo.size-this.mpegOffset-(n?128:0);e.codecProfile&&e.codecProfile[0]==="V"&&this.metadata.setFormat("bitrate",r*8/e.duration)}else if(this.tokenizer.fileInfo.size&&e.codecProfile==="CBR"){const r=this.tokenizer.fileInfo.size-this.mpegOffset-(n?128:0);if(this.frame_size!==null&&this.samplesPerFrame!==null){const s=Math.round(r/this.frame_size)*this.samplesPerFrame;if(this.metadata.setFormat("numberOfSamples",s),e.sampleRate){const i=s/e.sampleRate;ar("Calculate CBR duration based on file size: %s",i),this.metadata.setFormat("duration",i)}}}}}async sync(){let e=!1;for(;;){let n=0;if(this.syncPeek.len=await this.tokenizer.peekBuffer(this.syncPeek.buf,{length:sE,mayBeLess:!0}),this.syncPeek.len<=163)throw new vt;for(;;){if(e&&(this.syncPeek.buf[n]&224)===224){this.buf_frame_header[0]=Ut.SyncByte1,this.buf_frame_header[1]=this.syncPeek.buf[n],await this.tokenizer.ignore(n),ar(`Sync at offset=${this.tokenizer.position-1}, frameCount=${this.frameCount}`),this.syncFrameCount===this.frameCount&&(ar(`Re-synced MPEG stream, frameCount=${this.frameCount}`),this.frameCount=0,this.frame_size=0),this.syncFrameCount=this.frameCount;return}if(e=!1,n=this.syncPeek.buf.indexOf(Ut.SyncByte1,n),n===-1){if(this.syncPeek.len<this.syncPeek.buf.length)throw new vt;await this.tokenizer.ignore(this.syncPeek.len);break}++n,e=!0}}}async parseCommonMpegHeader(){this.frameCount===0&&(this.mpegOffset=this.tokenizer.position-1),await this.tokenizer.peekBuffer(this.buf_frame_header,{offset:1,length:3});let e;try{e=aE.get(this.buf_frame_header,0)}catch(n){if(await this.tokenizer.ignore(1),n instanceof Error)return this.metadata.addWarning(`Parse error: ${n.message}`),!1;throw n}return await this.tokenizer.ignore(3),this.metadata.setFormat("container",e.container),this.metadata.setFormat("codec",e.codec),this.metadata.setFormat("lossless",!1),this.metadata.setFormat("sampleRate",e.samplingRate),this.frameCount++,e.version!==null&&e.version>=2&&e.layer===0?this.parseAdts(e):this.parseAudioFrameHeader(e)}async parseAudioFrameHeader(e){this.metadata.setFormat("numberOfChannels",e.channelMode==="mono"?1:2),this.metadata.setFormat("bitrate",e.bitrate),this.frameCount<20*1e4&&ar("offset=%s MP%s bitrate=%s sample-rate=%s",this.tokenizer.position-4,e.layer,e.bitrate,e.samplingRate);const n=e.calcSlotSize();if(n===null)throw new Error("invalid slot_size");const r=e.calcSamplesPerFrame();ar(`samples_per_frame=${r}`);const s=r/8;if(e.bitrate!==null&&e.samplingRate!=null){const i=s*e.bitrate/e.samplingRate+(e.padding?n:0);this.frame_size=Math.floor(i)}if(this.audioFrameHeader=e,e.bitrate!==null&&this.bitrates.push(e.bitrate),this.frameCount===1)return this.offset=aE.len,await this.skipSideInformation(),!1;if(this.frameCount===3){if(this.areAllSame(this.bitrates)){if(this.samplesPerFrame=r,this.metadata.setFormat("codecProfile","CBR"),this.tokenizer.fileInfo.size)return!0}else if(this.metadata.format.duration)return!0;if(!this.options.duration)return!0}return this.options.duration&&this.frameCount===4&&(this.samplesPerFrame=r,this.calculateEofDuration=!0),this.offset=4,e.isProtectedByCRC?(await this.parseCrc(),!1):(await this.skipSideInformation(),!1)}async parseAdts(e){const n=new Uint8Array(3);if(await this.tokenizer.readBuffer(n),e.frameLength+=Me(n,0,0,11),this.totalDataLength+=e.frameLength,this.samplesPerFrame=1024,e.samplingRate!==null){const r=e.samplingRate/this.samplesPerFrame,i=8*(this.frameCount===0?0:this.totalDataLength/this.frameCount)*r+.5;this.metadata.setFormat("bitrate",i),ar(`frame-count=${this.frameCount}, size=${e.frameLength} bytes, bit-rate=${i}`)}if(await this.tokenizer.ignore(e.frameLength>7?e.frameLength-7:1),this.frameCount===3)if(this.metadata.setFormat("codecProfile",e.codecProfile),e.mp4ChannelConfig&&this.metadata.setFormat("numberOfChannels",e.mp4ChannelConfig.length),this.options.duration)this.calculateEofDuration=!0;else return!0;return!1}async parseCrc(){return this.crc=await this.tokenizer.readNumber(Ws),this.offset+=2,this.skipSideInformation()}async skipSideInformation(){if(this.audioFrameHeader){const e=this.audioFrameHeader.calculateSideInfoLength();if(e!==null){await this.tokenizer.readToken(new Gn(e)),this.offset+=e,await this.readXtraInfoHeader();return}}}async readXtraInfoHeader(){const e=await this.tokenizer.readToken(rE);switch(this.offset+=rE.len,e){case"Info":return this.metadata.setFormat("codecProfile","CBR"),this.readXingInfoHeader();case"Xing":{const r=await this.readXingInfoHeader();if(r.vbrScale!==null){const s=yQ(r.vbrScale);this.metadata.setFormat("codecProfile",s)}return null}case"Xtra":break;case"LAME":{const r=await this.tokenizer.readToken(Zg);if(this.frame_size!==null&&this.frame_size>=this.offset+Zg.len)return this.offset+=Zg.len,this.metadata.setFormat("tool",`LAME ${r}`),await this.skipFrameData(this.frame_size-this.offset),null;this.metadata.addWarning("Corrupt LAME header");break}}const n=this.frame_size-this.offset;return n<0?this.metadata.addWarning(`Frame ${this.frameCount}corrupt: negative frameDataLeft`):await this.skipFrameData(n),null}async readXingInfoHeader(){const e=this.tokenizer.position,n=await gQ(this.tokenizer);if(this.offset+=this.tokenizer.position-e,n.lame&&(this.metadata.setFormat("tool",`LAME ${Ni(n.lame.version)}`),n.lame.extended&&(this.metadata.setFormat("trackPeakLevel",n.lame.extended.track_peak),n.lame.extended.track_gain&&this.metadata.setFormat("trackGain",n.lame.extended.track_gain.adjustment),n.lame.extended.album_gain&&this.metadata.setFormat("albumGain",n.lame.extended.album_gain.adjustment),this.metadata.setFormat("duration",n.lame.extended.music_length/1e3))),n.streamSize&&this.audioFrameHeader&&n.numFrames!==null){const s=this.audioFrameHeader.calcDuration(n.numFrames);return this.metadata.setFormat("duration",s),ar("Get duration from Xing header: %s",this.metadata.format.duration),n}const r=this.frame_size-this.offset;return await this.skipFrameData(r),n}async skipFrameData(e){if(e<0)throw new Error("frame-data-left cannot be negative");await this.tokenizer.ignore(e),this.countSkipFrameData+=e}areAllSame(e){const n=e[0];return e.every(r=>r===n)}}const oE=Qe("music-metadata:parser:musepack:sv8"),wQ=new le(2,"latin1"),lE={len:5,get:(t,e)=>({crc:ie.get(t,e),streamVersion:Te.get(t,e+4)})},cE={len:2,get:(t,e)=>({sampleFrequency:[44100,48e3,37800,32e3][Me(t,e,0,3)],maxUsedBands:Me(t,e,3,5),channelCount:Me(t,e+1,0,4)+1,msUsed:cr(t,e+1,4),audioBlockFrames:Me(t,e+1,5,3)})};class _Q{constructor(e){this.tokenizer=e}async readPacketHeader(){const e=await this.tokenizer.readToken(wQ),n=await this.readVariableSizeField();return{key:e,payloadLength:n.value-2-n.len}}async readStreamHeader(e){const n={};oE(`Reading SH at offset=${this.tokenizer.position}`);const r=await this.tokenizer.readToken(lE);e-=lE.len,Object.assign(n,r),oE(`SH.streamVersion = ${r.streamVersion}`);const s=await this.readVariableSizeField();e-=s.len,n.sampleCount=s.value;const i=await this.readVariableSizeField();e-=i.len,n.beginningOfSilence=i.value;const o=await this.tokenizer.readToken(cE);return e-=cE.len,Object.assign(n,o),await this.tokenizer.ignore(e),n}async readVariableSizeField(e=1,n=0){let r=await this.tokenizer.readNumber(Te);return r&128?(r&=127,r+=n,this.readVariableSizeField(e+1,r<<7)):{len:e,value:n+r}}}const SQ=Qe("music-metadata:parser:musepack");class bQ extends Er{constructor(){super(...arguments),this.audioLength=0}async parse(){if(await this.tokenizer.readToken(nt)!=="MPCK")throw new Error("Invalid Magic number");return this.metadata.setFormat("container","Musepack, SV8"),this.parsePacket()}async parsePacket(){const e=new _Q(this.tokenizer);do{const n=await e.readPacketHeader();switch(SQ(`packet-header key=${n.key}, payloadLength=${n.payloadLength}`),n.key){case"SH":{const r=await e.readStreamHeader(n.payloadLength);this.metadata.setFormat("numberOfSamples",r.sampleCount),this.metadata.setFormat("sampleRate",r.sampleFrequency),this.metadata.setFormat("duration",r.sampleCount/r.sampleFrequency),this.metadata.setFormat("numberOfChannels",r.channelCount);break}case"AP":this.audioLength+=n.payloadLength,await this.tokenizer.ignore(n.payloadLength);break;case"RG":case"EI":case"SO":case"ST":case"CT":await this.tokenizer.ignore(n.payloadLength);break;case"SE":return this.metadata.format.duration&&this.metadata.setFormat("bitrate",this.audioLength*8/this.metadata.format.duration),ys.tryParseApeHeader(this.metadata,this.tokenizer,this.options);default:throw new Error(`Unexpected header: ${n.key}`)}}while(!0)}}class EQ{constructor(e){this.tokenizer=e,this.pos=0,this.dword=null}async read(e){for(;this.dword===null;)this.dword=await this.tokenizer.readToken(ie);let n=this.dword;return this.pos+=e,this.pos<32?(n>>>=32-this.pos,n&(1<<e)-1):(this.pos-=32,this.pos===0?(this.dword=null,n&(1<<e)-1):(this.dword=await this.tokenizer.readToken(ie),this.pos&&(n<<=this.pos,n|=this.dword>>>32-this.pos),n&(1<<e)-1))}async ignore(e){if(this.pos>0){const s=32-this.pos;this.dword=null,e-=s,this.pos=0}const n=e%32,r=(e-n)/32;return await this.tokenizer.ignore(r*4),this.read(n)}}const jQ={len:6*4,get:(t,e)=>{const n={signature:new TextDecoder("latin1").decode(t.subarray(e,e+3)),streamMinorVersion:Me(t,e+3,0,4),streamMajorVersion:Me(t,e+3,4,4),frameCount:ie.get(t,e+4),maxLevel:Ue.get(t,e+8),sampleFrequency:[44100,48e3,37800,32e3][Me(t,e+10,0,2)],link:Me(t,e+10,2,2),profile:Me(t,e+10,4,4),maxBand:Me(t,e+11,0,6),intensityStereo:cr(t,e+11,6),midSideStereo:cr(t,e+11,7),titlePeak:Ue.get(t,e+12),titleGain:Ue.get(t,e+14),albumPeak:Ue.get(t,e+16),albumGain:Ue.get(t,e+18),lastFrameLength:ie.get(t,e+20)>>>20&2047,trueGapless:cr(t,e+23,0)};return n.lastFrameLength=n.trueGapless?ie.get(t,20)>>>20&2047:0,n}},uE=Qe("music-metadata:parser:musepack");class kQ extends Er{constructor(){super(...arguments),this.bitreader=null,this.audioLength=0,this.duration=null}async parse(){const e=await this.tokenizer.readToken(jQ);if(e.signature!=="MP+")throw new Error("Unexpected magic number");uE(`stream-version=${e.streamMajorVersion}.${e.streamMinorVersion}`),this.metadata.setFormat("container","Musepack, SV7"),this.metadata.setFormat("sampleRate",e.sampleFrequency);const n=1152*(e.frameCount-1)+e.lastFrameLength;this.metadata.setFormat("numberOfSamples",n),this.duration=n/e.sampleFrequency,this.metadata.setFormat("duration",this.duration),this.bitreader=new EQ(this.tokenizer),this.metadata.setFormat("numberOfChannels",e.midSideStereo||e.intensityStereo?2:1);const r=await this.bitreader.read(8);return this.metadata.setFormat("codec",(r/100).toFixed(2)),await this.skipAudioData(e.frameCount),uE(`End of audio stream, switching to APEv2, offset=${this.tokenizer.position}`),ys.tryParseApeHeader(this.metadata,this.tokenizer,this.options)}async skipAudioData(e){for(;e-- >0;){const r=await this.bitreader.read(20);this.audioLength+=20+r,await this.bitreader.ignore(r)}const n=await this.bitreader.read(11);this.audioLength+=n,this.duration!==null&&this.metadata.setFormat("bitrate",this.audioLength/this.duration)}}const dE=Qe("music-metadata:parser:musepack");class TQ extends _p{async postId3v2Parse(){const e=await this.tokenizer.peekToken(new le(3,"latin1"));let n;switch(e){case"MP+":{dE("Musepack stream-version 7"),n=new kQ;break}case"MPC":{dE("Musepack stream-version 8"),n=new bQ;break}default:throw new Error("Invalid Musepack signature prefix")}return n.init(this.metadata,this.tokenizer,this.options),n.parse()}}class IQ{constructor(e){if(this.len=e,e<19)throw new Error("ID-header-page 0 should be at least 19 bytes long")}get(e,n){return{magicSignature:new le(8,"ascii").get(e,n+0),version:Te.get(e,n+8),channelCount:Te.get(e,n+9),preSkip:Ue.get(e,n+10),inputSampleRate:ie.get(e,n+12),outputGain:Ue.get(e,n+16),channelMapping:Te.get(e,n+18)}}}class CQ extends to{constructor(e,n,r){super(e,n),this.tokenizer=r,this.idHeader=null,this.lastPos=-1}parseFirstPage(e,n){if(this.metadata.setFormat("codec","Opus"),this.idHeader=new IQ(n.length).get(n,0),this.idHeader.magicSignature!=="OpusHead")throw new Error("Illegal ogg/Opus magic-signature");this.metadata.setFormat("sampleRate",this.idHeader.inputSampleRate),this.metadata.setFormat("numberOfChannels",this.idHeader.channelCount)}async parseFullPage(e){switch(new le(8,"ascii").get(e,0)){case"OpusTags":await this.parseUserCommentList(e,8),this.lastPos=this.tokenizer.position-e.length;break}}calculateDuration(e){if(this.metadata.format.sampleRate&&e.absoluteGranulePosition>=0){const n=e.absoluteGranulePosition-this.idHeader.preSkip;if(this.metadata.setFormat("numberOfSamples",n),this.metadata.setFormat("duration",n/48e3),this.lastPos!==-1&&this.tokenizer.fileInfo.size&&this.metadata.format.duration){const r=this.tokenizer.fileInfo.size-this.lastPos;this.metadata.setFormat("bitrate",8*r/this.metadata.format.duration)}}}}const RQ={len:80,get:(t,e)=>({speex:new le(8,"ascii").get(t,e+0),version:WN(new le(20,"ascii").get(t,e+8)),version_id:gt.get(t,e+28),header_size:gt.get(t,e+32),rate:gt.get(t,e+36),mode:gt.get(t,e+40),mode_bitstream_version:gt.get(t,e+44),nb_channels:gt.get(t,e+48),bitrate:gt.get(t,e+52),frame_size:gt.get(t,e+56),vbr:gt.get(t,e+60),frames_per_packet:gt.get(t,e+64),extra_headers:gt.get(t,e+68),reserved1:gt.get(t,e+72),reserved2:gt.get(t,e+76)})},NQ=Qe("music-metadata:parser:ogg:speex");class AQ extends to{constructor(e,n,r){super(e,n),this.tokenizer=r}parseFirstPage(e,n){NQ("First Ogg/Speex page");const r=RQ.get(n,0);this.metadata.setFormat("codec",`Speex ${r.version}`),this.metadata.setFormat("numberOfChannels",r.nb_channels),this.metadata.setFormat("sampleRate",r.rate),r.bitrate!==-1&&this.metadata.setFormat("bitrate",r.bitrate)}}const PQ={len:42,get:(t,e)=>({id:new le(7,"ascii").get(t,e),vmaj:Te.get(t,e+7),vmin:Te.get(t,e+8),vrev:Te.get(t,e+9),vmbw:We.get(t,e+10),vmbh:We.get(t,e+17),nombr:Mn.get(t,e+37),nqual:Te.get(t,e+40)})},e0=Qe("music-metadata:parser:ogg:theora");class FQ{constructor(e,n,r){this.metadata=e,this.tokenizer=r}async parsePage(e,n){e.headerType.firstPage&&await this.parseFirstPage(e,n)}async flush(){e0("flush")}calculateDuration(e){e0("duration calculation not implemented")}async parseFirstPage(e,n){e0("First Ogg/Theora page"),this.metadata.setFormat("codec","Theora");const r=PQ.get(n,0);this.metadata.setFormat("bitrate",r.nombr)}}const Fs=Qe("music-metadata:parser:ogg");class s1{static sum(e,n,r){const s=new DataView(e.buffer,0);let i=0;for(let o=n;o<n+r;++o)i+=s.getUint8(o);return i}constructor(e){this.len=e.page_segments}get(e,n){return{totalPageSize:s1.sum(e,n,this.len)}}}class Sp extends Er{constructor(){super(...arguments),this.header=null,this.pageNumber=0,this.pageConsumer=null}async parse(){Fs("pos=%s, parsePage()",this.tokenizer.position);try{let e;do{if(e=await this.tokenizer.readToken(Sp.Header),e.capturePattern!=="OggS")throw new Error("Invalid Ogg capture pattern");this.metadata.setFormat("container","Ogg"),this.header=e,this.pageNumber=e.pageSequenceNo,Fs("page#=%s, Ogg.id=%s",e.pageSequenceNo,e.capturePattern);const n=await this.tokenizer.readToken(new s1(e));Fs("totalPageSize=%s",n.totalPageSize);const r=await this.tokenizer.readToken(new Gn(n.totalPageSize));if(Fs("firstPage=%s, lastPage=%s, continued=%s",e.headerType.firstPage,e.headerType.lastPage,e.headerType.continued),e.headerType.firstPage){const s=new TextDecoder("ascii").decode(r.subarray(0,7));switch(s){case"vorbis":Fs("Set page consumer to Ogg/Vorbis"),this.pageConsumer=new to(this.metadata,this.options);break;case"OpusHea":Fs("Set page consumer to Ogg/Opus"),this.pageConsumer=new CQ(this.metadata,this.options,this.tokenizer);break;case"Speex  ":Fs("Set page consumer to Ogg/Speex"),this.pageConsumer=new AQ(this.metadata,this.options,this.tokenizer);break;case"fishead":case"\0theora":Fs("Set page consumer to Ogg/Theora"),this.pageConsumer=new FQ(this.metadata,this.options,this.tokenizer);break;default:throw new Error(`gg audio-codec not recognized (id=${s})`)}}await this.pageConsumer.parsePage(e,r)}while(!e.headerType.lastPage)}catch(e){if(e instanceof Error)e instanceof vt?(this.metadata.addWarning("Last OGG-page is not marked with last-page flag"),Fs("End-of-stream"),this.metadata.addWarning("Last OGG-page is not marked with last-page flag"),this.header&&this.pageConsumer.calculateDuration(this.header)):e.message.startsWith("FourCC")&&this.pageNumber>0&&(this.metadata.addWarning("Invalid FourCC ID, maybe last OGG-page is not marked with last-page flag"),await this.pageConsumer.flush());else throw e}}}Sp.Header={len:27,get:(t,e)=>({capturePattern:nt.get(t,e),version:Te.get(t,e+4),headerType:{continued:pt(t,e+5,0),firstPage:pt(t,e+5,1),lastPage:pt(t,e+5,2)},absoluteGranulePosition:Number(Nn.get(t,e+6)),streamSerialNumber:ie.get(t,e+14),pageSequenceNo:ie.get(t,e+18),pageChecksum:ie.get(t,e+22),page_segments:Te.get(t,e+26)})};const yc={len:8,get:(t,e)=>({chunkID:new le(4,"latin1").get(t,e),chunkSize:ie.get(t,e+4)})};class MQ{constructor(e){this.tagHeader=e,this.len=e.chunkSize,this.len+=this.len&1}get(e,n){return new le(this.tagHeader.chunkSize,"ascii").get(e,n)}}var ly;(function(t){t[t.PCM=1]="PCM",t[t.ADPCM=2]="ADPCM",t[t.IEEE_FLOAT=3]="IEEE_FLOAT",t[t.MPEG_ADTS_AAC=5632]="MPEG_ADTS_AAC",t[t.MPEG_LOAS=5634]="MPEG_LOAS",t[t.RAW_AAC1=255]="RAW_AAC1",t[t.DOLBY_AC3_SPDIF=146]="DOLBY_AC3_SPDIF",t[t.DVM=8192]="DVM",t[t.RAW_SPORT=576]="RAW_SPORT",t[t.ESST_AC3=577]="ESST_AC3",t[t.DRM=9]="DRM",t[t.DTS2=8193]="DTS2",t[t.MPEG=80]="MPEG"})(ly||(ly={}));class DQ{constructor(e){if(e.chunkSize<16)throw new Error("Invalid chunk size");this.len=e.chunkSize}get(e,n){return{wFormatTag:Ue.get(e,n),nChannels:Ue.get(e,n+2),nSamplesPerSec:ie.get(e,n+4),nAvgBytesPerSec:ie.get(e,n+8),nBlockAlign:Ue.get(e,n+12),wBitsPerSample:Ue.get(e,n+14)}}}class LQ{constructor(e){if(e.chunkSize<4)throw new Error("Invalid fact chunk size.");this.len=e.chunkSize}get(e,n){return{dwSampleLength:ie.get(e,n)}}}const hE={len:420,get:(t,e)=>({description:Ni(new le(256,"ascii").get(t,e)).trim(),originator:Ni(new le(32,"ascii").get(t,e+256)).trim(),originatorReference:Ni(new le(32,"ascii").get(t,e+288)).trim(),originationDate:Ni(new le(10,"ascii").get(t,e+320)).trim(),originationTime:Ni(new le(8,"ascii").get(t,e+330)).trim(),timeReferenceLow:ie.get(t,e+338),timeReferenceHigh:ie.get(t,e+342),version:Ue.get(t,e+346),umid:new Gn(64).get(t,e+348),loudnessValue:Ue.get(t,e+412),maxTruePeakLevel:Ue.get(t,e+414),maxMomentaryLoudness:Ue.get(t,e+416),maxShortTermLoudness:Ue.get(t,e+418)})},bi=Qe("music-metadata:parser:RIFF");class OQ extends Er{constructor(){super(...arguments),this.blockAlign=0}async parse(){const e=await this.tokenizer.readToken(yc);if(bi(`pos=${this.tokenizer.position}, parse: chunkID=${e.chunkID}`),e.chunkID==="RIFF")return this.parseRiffChunk(e.chunkSize).catch(n=>{if(!(n instanceof vt))throw n})}async parseRiffChunk(e){const n=await this.tokenizer.readToken(nt);switch(this.metadata.setFormat("container",n),n){case"WAVE":return this.readWaveChunk(e-nt.len);default:throw new Error(`Unsupported RIFF format: RIFF/${n}`)}}async readWaveChunk(e){for(;e>=yc.len;){const n=await this.tokenizer.readToken(yc);switch(e-=yc.len+n.chunkSize,n.chunkSize>e&&this.metadata.addWarning("Data chunk size exceeds file size"),this.header=n,bi(`pos=${this.tokenizer.position}, readChunk: chunkID=RIFF/WAVE/${n.chunkID}`),n.chunkID){case"LIST":await this.parseListTag(n);break;case"fact":this.metadata.setFormat("lossless",!1),this.fact=await this.tokenizer.readToken(new LQ(n));break;case"fmt ":{const r=await this.tokenizer.readToken(new DQ(n));let s=ly[r.wFormatTag];s||(bi(`WAVE/non-PCM format=${r.wFormatTag}`),s=`non-PCM (${r.wFormatTag})`),this.metadata.setFormat("codec",s),this.metadata.setFormat("bitsPerSample",r.wBitsPerSample),this.metadata.setFormat("sampleRate",r.nSamplesPerSec),this.metadata.setFormat("numberOfChannels",r.nChannels),this.metadata.setFormat("bitrate",r.nBlockAlign*r.nSamplesPerSec*8),this.blockAlign=r.nBlockAlign;break}case"id3 ":case"ID3 ":{const r=await this.tokenizer.readToken(new Gn(n.chunkSize)),s=kl(r);await new Qr().parse(this.metadata,s,this.options);break}case"data":{this.metadata.format.lossless!==!1&&this.metadata.setFormat("lossless",!0);let r=n.chunkSize;if(this.tokenizer.fileInfo.size){const i=this.tokenizer.fileInfo.size-this.tokenizer.position;i<r&&(this.metadata.addWarning("data chunk length exceeding file length"),r=i)}const s=this.fact?this.fact.dwSampleLength:r===4294967295?void 0:r/this.blockAlign;s&&(this.metadata.setFormat("numberOfSamples",s),this.metadata.format.sampleRate&&this.metadata.setFormat("duration",s/this.metadata.format.sampleRate)),this.metadata.format.codec==="ADPCM"?this.metadata.setFormat("bitrate",352e3):this.metadata.format.sampleRate&&this.metadata.setFormat("bitrate",this.blockAlign*this.metadata.format.sampleRate*8),await this.tokenizer.ignore(n.chunkSize);break}case"bext":{const r=await this.tokenizer.readToken(hE);Object.keys(r).forEach(i=>{this.metadata.addTag("exif",`bext.${i}`,r[i])});const s=n.chunkSize-hE.len;await this.tokenizer.ignore(s);break}case"\0\0\0\0":bi(`Ignore padding chunk: RIFF/${n.chunkID} of ${n.chunkSize} bytes`),this.metadata.addWarning(`Ignore chunk: RIFF/${n.chunkID}`),await this.tokenizer.ignore(n.chunkSize);break;default:bi(`Ignore chunk: RIFF/${n.chunkID} of ${n.chunkSize} bytes`),this.metadata.addWarning(`Ignore chunk: RIFF/${n.chunkID}`),await this.tokenizer.ignore(n.chunkSize)}this.header.chunkSize%2===1&&(bi("Read odd padding byte"),await this.tokenizer.ignore(1))}}async parseListTag(e){const n=await this.tokenizer.readToken(new le(4,"latin1"));switch(bi("pos=%s, parseListTag: chunkID=RIFF/WAVE/LIST/%s",this.tokenizer.position,n),n){case"INFO":return this.parseRiffInfoTags(e.chunkSize-4);default:return this.metadata.addWarning(`Ignore chunk: RIFF/WAVE/LIST/${n}`),bi(`Ignoring chunkID=RIFF/WAVE/LIST/${n}`),this.tokenizer.ignore(e.chunkSize-4).then()}}async parseRiffInfoTags(e){for(;e>=8;){const n=await this.tokenizer.readToken(yc),r=new MQ(n),s=await this.tokenizer.readToken(r);this.addTag(n.chunkID,Ni(s)),e-=8+r.len}if(e!==0)throw new Error(`Illegal remaining size: ${e}`)}addTag(e,n){this.metadata.addTag("exif",e,n)}}const $Q=[6e3,8e3,9600,11025,12e3,16e3,22050,24e3,32e3,44100,48e3,64e3,88200,96e3,192e3,-1],oh={len:32,get:(t,e)=>{const n=ie.get(t,e+24),r={BlockID:nt.get(t,e),blockSize:ie.get(t,e+4),version:Ue.get(t,e+8),totalSamples:ie.get(t,e+12),blockIndex:ie.get(t,e+16),blockSamples:ie.get(t,e+20),flags:{bitsPerSample:(1+Qf(n,0,2))*8,isMono:ps(n,2),isHybrid:ps(n,3),isJointStereo:ps(n,4),crossChannel:ps(n,5),hybridNoiseShaping:ps(n,6),floatingPoint:ps(n,7),samplingRate:$Q[Qf(n,23,4)],isDSD:ps(n,31)},crc:new Gn(4).get(t,e+28)};return r.flags.isDSD&&(r.totalSamples*=8),r}},t0={len:1,get:(t,e)=>({functionId:Qf(t[e],0,6),isOptional:ps(t[e],5),isOddSize:ps(t[e],6),largeBlock:ps(t[e],7)})};function ps(t,e){return Qf(t,e,1)===1}function Qf(t,e,n){return t>>>e&4294967295>>>32-n}const wa=Qe("music-metadata:parser:WavPack");class zQ extends Er{constructor(){super(...arguments),this.audioDataSize=0}async parse(){return this.audioDataSize=0,await this.parseWavPackBlocks(),ys.tryParseApeHeader(this.metadata,this.tokenizer,this.options)}async parseWavPackBlocks(){do{if(await this.tokenizer.peekToken(nt)!=="wvpk")break;const n=await this.tokenizer.readToken(oh);if(n.BlockID!=="wvpk")throw new Error("Invalid WavPack Block-ID");wa(`WavPack header blockIndex=${n.blockIndex}, len=${oh.len}`),n.blockIndex===0&&!this.metadata.format.container&&(this.metadata.setFormat("container","WavPack"),this.metadata.setFormat("lossless",!n.flags.isHybrid),this.metadata.setFormat("bitsPerSample",n.flags.bitsPerSample),n.flags.isDSD||(this.metadata.setFormat("sampleRate",n.flags.samplingRate),this.metadata.setFormat("duration",n.totalSamples/n.flags.samplingRate)),this.metadata.setFormat("numberOfChannels",n.flags.isMono?1:2),this.metadata.setFormat("numberOfSamples",n.totalSamples),this.metadata.setFormat("codec",n.flags.isDSD?"DSD":"PCM"));const r=n.blockSize-(oh.len-8);await(n.blockIndex===0?this.parseMetadataSubBlock(n,r):this.tokenizer.ignore(r)),n.blockSamples>0&&(this.audioDataSize+=n.blockSize)}while(!this.tokenizer.fileInfo.size||this.tokenizer.fileInfo.size-this.tokenizer.position>=oh.len);this.metadata.format.duration&&this.metadata.setFormat("bitrate",this.audioDataSize*8/this.metadata.format.duration)}async parseMetadataSubBlock(e,n){let r=n;for(;r>t0.len;){const s=await this.tokenizer.readToken(t0),i=await this.tokenizer.readNumber(s.largeBlock?zf:Te),o=new Uint8Array(i*2-(s.isOddSize?1:0));switch(await this.tokenizer.readBuffer(o),wa(`Metadata Sub-Blocks functionId=0x${s.functionId.toString(16)}, id.largeBlock=${s.largeBlock},data-size=${o.length}`),s.functionId){case 0:break;case 14:{wa("ID_DSD_BLOCK");const l=1<<Te.get(o,0),c=e.flags.samplingRate*l*8;if(!e.flags.isDSD)throw new Error("Only expect DSD block if DSD-flag is set");this.metadata.setFormat("sampleRate",c),this.metadata.setFormat("duration",e.totalSamples/c);break}case 36:wa("ID_ALT_TRAILER: trailer for non-wav files");break;case 38:this.metadata.setFormat("audioMD5",o);break;case 47:wa(`ID_BLOCK_CHECKSUM: checksum=${Yw(o)}`);break;default:wa(`Ignore unsupported meta-sub-block-id functionId=0x${s.functionId.toString(16)}`);break}r-=t0.len+(s.largeBlock?zf.len:Te.len)+i*2,wa(`remainingLength=${r}`),s.isOddSize&&this.tokenizer.ignore(1)}if(r!==0)throw new Error("metadata-sub-block should fit it remaining length")}}const lh={len:12,get:(t,e)=>({id:nt.get(t,e),size:Nn.get(t,e+4)})},BQ={len:16,get:(t,e)=>({fileSize:Bf.get(t,e),metadataPointer:Bf.get(t,e+8)})};var fE;(function(t){t[t.mono=1]="mono",t[t.stereo=2]="stereo",t[t.channels=3]="channels",t[t.quad=4]="quad",t[t["4 channels"]=5]="4 channels",t[t["5 channels"]=6]="5 channels",t[t["5.1 channels"]=7]="5.1 channels"})(fE||(fE={}));const VQ={len:40,get:(t,e)=>({formatVersion:gt.get(t,e),formatID:gt.get(t,e+4),channelType:gt.get(t,e+8),channelNum:gt.get(t,e+12),samplingFrequency:gt.get(t,e+16),bitsPerSample:gt.get(t,e+20),sampleCount:Bf.get(t,e+24),blockSizePerChannel:gt.get(t,e+32)})},n0=Qe("music-metadata:parser:DSF");class UQ extends _p{async postId3v2Parse(){const e=this.tokenizer.position,n=await this.tokenizer.readToken(lh);if(n.id!=="DSD ")throw new Error("Invalid chunk signature");this.metadata.setFormat("container","DSF"),this.metadata.setFormat("lossless",!0);const r=await this.tokenizer.readToken(BQ);if(r.metadataPointer===BigInt(0))n0("No ID3v2 tag present");else return n0(`expect ID3v2 at offset=${r.metadataPointer}`),await this.parseChunks(r.fileSize-n.size),await this.tokenizer.ignore(Number(r.metadataPointer)-this.tokenizer.position-e),new Qr().parse(this.metadata,this.tokenizer,this.options)}async parseChunks(e){for(;e>=lh.len;){const n=await this.tokenizer.readToken(lh);switch(n0(`Parsing chunk name=${n.id} size=${n.size}`),n.id){case"fmt ":{const r=await this.tokenizer.readToken(VQ);this.metadata.setFormat("numberOfChannels",r.channelNum),this.metadata.setFormat("sampleRate",r.samplingFrequency),this.metadata.setFormat("bitsPerSample",r.bitsPerSample),this.metadata.setFormat("numberOfSamples",r.sampleCount),this.metadata.setFormat("duration",Number(r.sampleCount)/r.samplingFrequency);const s=r.bitsPerSample*r.samplingFrequency*r.channelNum;this.metadata.setFormat("bitrate",s);return}default:this.tokenizer.ignore(Number(n.size)-lh.len);break}e-=n.size}}}const To={len:12,get:(t,e)=>({chunkID:nt.get(t,e),chunkSize:LN.get(t,e+4)})},Cn=Qe("music-metadata:parser:aiff");class HQ extends Er{async parse(){const e=await this.tokenizer.readToken(To);if(e.chunkID!=="FRM8")throw new Error("Unexpected chunk-ID");const n=(await this.tokenizer.readToken(nt)).trim();switch(n){case"DSD":return this.metadata.setFormat("container",`DSDIFF/${n}`),this.metadata.setFormat("lossless",!0),this.readFmt8Chunks(e.chunkSize-BigInt(nt.len));default:throw new Error(`Unsupported DSDIFF type: ${n}`)}}async readFmt8Chunks(e){for(;e>=To.len;){const n=await this.tokenizer.readToken(To);Cn(`Chunk id=${n.chunkID}`),await this.readData(n),e-=BigInt(To.len)+n.chunkSize}}async readData(e){Cn(`Reading data of chunk[ID=${e.chunkID}, size=${e.chunkSize}]`);const n=this.tokenizer.position;switch(e.chunkID.trim()){case"FVER":{const s=await this.tokenizer.readToken(ie);Cn(`DSDIFF version=${s}`);break}case"PROP":{if(await this.tokenizer.readToken(nt)!=="SND ")throw new Error("Unexpected PROP-chunk ID");await this.handleSoundPropertyChunks(e.chunkSize-BigInt(nt.len));break}case"ID3":{const s=await this.tokenizer.readToken(new Gn(Number(e.chunkSize))),i=kl(s);await new Qr().parse(this.metadata,i,this.options);break}case"DSD":this.metadata.format.numberOfChannels&&this.metadata.setFormat("numberOfSamples",Number(e.chunkSize*BigInt(8)/BigInt(this.metadata.format.numberOfChannels))),this.metadata.format.numberOfSamples&&this.metadata.format.sampleRate&&this.metadata.setFormat("duration",this.metadata.format.numberOfSamples/this.metadata.format.sampleRate);break;default:Cn(`Ignore chunk[ID=${e.chunkID}, size=${e.chunkSize}]`);break}const r=e.chunkSize-BigInt(this.tokenizer.position-n);r>0&&(Cn(`After Parsing chunk, remaining ${r} bytes`),await this.tokenizer.ignore(Number(r)))}async handleSoundPropertyChunks(e){for(Cn(`Parsing sound-property-chunks, remainingSize=${e}`);e>0;){const n=await this.tokenizer.readToken(To);Cn(`Sound-property-chunk[ID=${n.chunkID}, size=${n.chunkSize}]`);const r=this.tokenizer.position;switch(n.chunkID.trim()){case"FS":{const i=await this.tokenizer.readToken(de);this.metadata.setFormat("sampleRate",i);break}case"CHNL":{const i=await this.tokenizer.readToken(We);this.metadata.setFormat("numberOfChannels",i),await this.handleChannelChunks(n.chunkSize-BigInt(We.len));break}case"CMPR":{const i=(await this.tokenizer.readToken(nt)).trim(),o=await this.tokenizer.readToken(Te),l=await this.tokenizer.readToken(new le(o,"ascii"));i==="DSD"&&(this.metadata.setFormat("lossless",!0),this.metadata.setFormat("bitsPerSample",1)),this.metadata.setFormat("codec",`${i} (${l})`);break}case"ABSS":{const i=await this.tokenizer.readToken(We),o=await this.tokenizer.readToken(Te),l=await this.tokenizer.readToken(Te),c=await this.tokenizer.readToken(de);Cn(`ABSS ${i}:${o}:${l}.${c}`);break}case"LSCO":{const i=await this.tokenizer.readToken(We);Cn(`LSCO lsConfig=${i}`);break}default:Cn(`Unknown sound-property-chunk[ID=${n.chunkID}, size=${n.chunkSize}]`),await this.tokenizer.ignore(Number(n.chunkSize))}const s=n.chunkSize-BigInt(this.tokenizer.position-r);s>0&&(Cn(`After Parsing sound-property-chunk ${n.chunkSize}, remaining ${s} bytes`),await this.tokenizer.ignore(Number(s))),e-=BigInt(To.len)+n.chunkSize,Cn(`Parsing sound-property-chunks, remainingSize=${e}`)}if(this.metadata.format.lossless&&this.metadata.format.sampleRate&&this.metadata.format.numberOfChannels&&this.metadata.format.bitsPerSample){const n=this.metadata.format.sampleRate*this.metadata.format.numberOfChannels*this.metadata.format.bitsPerSample;this.metadata.setFormat("bitrate",n)}}async handleChannelChunks(e){Cn(`Parsing channel-chunks, remainingSize=${e}`);const n=[];for(;e>=nt.len;){const r=await this.tokenizer.readToken(nt);Cn(`Channel[ID=${r}]`),n.push(r),e-=BigInt(nt.len)}return Cn(`Channels: ${n.join(", ")}`),n}}var B;(function(t){t[t.string=0]="string",t[t.uint=1]="uint",t[t.uid=2]="uid",t[t.bool=3]="bool",t[t.binary=4]="binary",t[t.float=5]="float"})(B||(B={}));const GQ={name:"dtd",container:{440786851:{name:"ebml",container:{17030:{name:"ebmlVersion",value:B.uint},17143:{name:"ebmlReadVersion",value:B.uint},17138:{name:"ebmlMaxIDWidth",value:B.uint},17139:{name:"ebmlMaxSizeWidth",value:B.uint},17026:{name:"docType",value:B.string},17031:{name:"docTypeVersion",value:B.uint},17029:{name:"docTypeReadVersion",value:B.uint}}},408125543:{name:"segment",container:{290298740:{name:"seekHead",container:{19899:{name:"seek",multiple:!0,container:{21419:{name:"id",value:B.binary},21420:{name:"position",value:B.uint}}}}},357149030:{name:"info",container:{29604:{name:"uid",value:B.uid},29572:{name:"filename",value:B.string},3979555:{name:"prevUID",value:B.uid},3965867:{name:"prevFilename",value:B.string},4110627:{name:"nextUID",value:B.uid},4096955:{name:"nextFilename",value:B.string},2807729:{name:"timecodeScale",value:B.uint},17545:{name:"duration",value:B.float},17505:{name:"dateUTC",value:B.uint},31657:{name:"title",value:B.string},19840:{name:"muxingApp",value:B.string},22337:{name:"writingApp",value:B.string}}},524531317:{name:"cluster",multiple:!0,container:{231:{name:"timecode",value:B.uid},22743:{name:"silentTracks ",multiple:!0},167:{name:"position",value:B.uid},171:{name:"prevSize",value:B.uid},160:{name:"blockGroup"},163:{name:"simpleBlock"}}},374648427:{name:"tracks",container:{174:{name:"entries",multiple:!0,container:{215:{name:"trackNumber",value:B.uint},29637:{name:"uid",value:B.uid},131:{name:"trackType",value:B.uint},185:{name:"flagEnabled",value:B.bool},136:{name:"flagDefault",value:B.bool},21930:{name:"flagForced",value:B.bool},156:{name:"flagLacing",value:B.bool},28135:{name:"minCache",value:B.uint},28136:{name:"maxCache",value:B.uint},2352003:{name:"defaultDuration",value:B.uint},2306383:{name:"timecodeScale",value:B.float},21358:{name:"name",value:B.string},2274716:{name:"language",value:B.string},134:{name:"codecID",value:B.string},25506:{name:"codecPrivate",value:B.binary},2459272:{name:"codecName",value:B.string},3839639:{name:"codecSettings",value:B.string},3883072:{name:"codecInfoUrl",value:B.string},2536e3:{name:"codecDownloadUrl",value:B.string},170:{name:"codecDecodeAll",value:B.bool},28587:{name:"trackOverlay",value:B.uint},224:{name:"video",container:{154:{name:"flagInterlaced",value:B.bool},21432:{name:"stereoMode",value:B.uint},176:{name:"pixelWidth",value:B.uint},186:{name:"pixelHeight",value:B.uint},21680:{name:"displayWidth",value:B.uint},21690:{name:"displayHeight",value:B.uint},21683:{name:"aspectRatioType",value:B.uint},3061028:{name:"colourSpace",value:B.uint},3126563:{name:"gammaValue",value:B.float}}},225:{name:"audio",container:{181:{name:"samplingFrequency",value:B.float},30901:{name:"outputSamplingFrequency",value:B.float},159:{name:"channels",value:B.uint},148:{name:"channels",value:B.uint},32123:{name:"channelPositions",value:B.binary},25188:{name:"bitDepth",value:B.uint}}},28032:{name:"contentEncodings",container:{25152:{name:"contentEncoding",container:{20529:{name:"order",value:B.uint},20530:{name:"scope",value:B.bool},20531:{name:"type",value:B.uint},20532:{name:"contentEncoding",container:{16980:{name:"contentCompAlgo",value:B.uint},16981:{name:"contentCompSettings",value:B.binary}}},20533:{name:"contentEncoding",container:{18401:{name:"contentEncAlgo",value:B.uint},18402:{name:"contentEncKeyID",value:B.binary},18403:{name:"contentSignature ",value:B.binary},18404:{name:"ContentSigKeyID  ",value:B.binary},18405:{name:"contentSigAlgo ",value:B.uint},18406:{name:"contentSigHashAlgo ",value:B.uint}}},25188:{name:"bitDepth",value:B.uint}}}}}}}}},475249515:{name:"cues",container:{187:{name:"cuePoint",container:{179:{name:"cueTime",value:B.uid},183:{name:"positions",container:{247:{name:"track",value:B.uint},241:{name:"clusterPosition",value:B.uint},21368:{name:"blockNumber",value:B.uint},234:{name:"codecState",value:B.uint},219:{name:"reference",container:{150:{name:"time",value:B.uint},151:{name:"cluster",value:B.uint},21343:{name:"number",value:B.uint},235:{name:"codecState",value:B.uint}}},240:{name:"relativePosition",value:B.uint}}}}}}},423732329:{name:"attachments",container:{24999:{name:"attachedFiles",multiple:!0,container:{18046:{name:"description",value:B.string},18030:{name:"name",value:B.string},18016:{name:"mimeType",value:B.string},18012:{name:"data",value:B.binary},18094:{name:"uid",value:B.uid}}}}},272869232:{name:"chapters",container:{17849:{name:"editionEntry",container:{182:{name:"chapterAtom",container:{29636:{name:"uid",value:B.uid},145:{name:"timeStart",value:B.uint},146:{name:"timeEnd",value:B.uid},152:{name:"hidden",value:B.bool},17816:{name:"enabled",value:B.uid},143:{name:"track",container:{137:{name:"trackNumber",value:B.uid},128:{name:"display",container:{133:{name:"string",value:B.string},17276:{name:"language ",value:B.string},17278:{name:"country ",value:B.string}}}}}}}}}}},307544935:{name:"tags",container:{29555:{name:"tag",multiple:!0,container:{25536:{name:"target",container:{25541:{name:"tagTrackUID",value:B.uid},25540:{name:"tagChapterUID",value:B.uint},25542:{name:"tagAttachmentUID",value:B.uid},25546:{name:"targetType",value:B.string},26826:{name:"targetTypeValue",value:B.uint},25545:{name:"tagEditionUID",value:B.uid}}},26568:{name:"simpleTags",multiple:!0,container:{17827:{name:"name",value:B.string},17543:{name:"string",value:B.string},17541:{name:"binary",value:B.binary},17530:{name:"language",value:B.string},17531:{name:"languageIETF",value:B.string},17540:{name:"default",value:B.bool}}}}}}}}}}},Io=Qe("music-metadata:parser:ebml");var Xr;(function(t){t[t.ReadNext=0]="ReadNext",t[t.IgnoreElement=2]="IgnoreElement",t[t.SkipSiblings=3]="SkipSiblings",t[t.TerminateParsing=4]="TerminateParsing",t[t.SkipElement=5]="SkipElement"})(Xr||(Xr={}));class WQ{constructor(e){this.tokenizer=e,this.padding=0,this.parserMap=new Map,this.ebmlMaxIDLength=4,this.ebmlMaxSizeLength=8,this.parserMap.set(B.uint,n=>this.readUint(n)),this.parserMap.set(B.string,n=>this.readString(n)),this.parserMap.set(B.binary,n=>this.readBuffer(n)),this.parserMap.set(B.uid,async n=>this.readBuffer(n)),this.parserMap.set(B.bool,n=>this.readFlag(n)),this.parserMap.set(B.float,n=>this.readFloat(n))}async iterate(e,n,r){return this.parseContainer(tA(e),n,r)}async parseContainer(e,n,r){const s={};for(;this.tokenizer.position<n;){let i;const o=this.tokenizer.position;try{i=await this.readElement()}catch(c){if(c instanceof vt)break;throw c}const l=e.container[i.id];if(l)switch(r.startNext(l)){case Xr.ReadNext:if(i.id,Io(`Read element: name=${ka(l)}{id=0x${i.id.toString(16)}, container=${!!l.container}} at position=${o}`),l.container){const u=await this.parseContainer(l,i.len>=0?this.tokenizer.position+i.len:-1,r);l.multiple?(s[l.name]||(s[l.name]=[]),s[l.name].push(u)):s[l.name]=u,await r.elementValue(l,u,o)}else{const u=this.parserMap.get(l.value);if(typeof u=="function"){const d=await u(i);s[l.name]=d,await r.elementValue(l,d,o)}}break;case Xr.SkipElement:Io(`Go to next element: name=${ka(l)}, element.id=0x${i.id}, container=${!!l.container} at position=${o}`);break;case Xr.IgnoreElement:Io(`Ignore element: name=${ka(l)}, element.id=0x${i.id}, container=${!!l.container} at position=${o}`),await this.tokenizer.ignore(i.len);break;case Xr.SkipSiblings:Io(`Ignore remaining container, at: name=${ka(l)}, element.id=0x${i.id}, container=${!!l.container} at position=${o}`),await this.tokenizer.ignore(n-this.tokenizer.position);break;case Xr.TerminateParsing:return Io(`Terminate parsing at element: name=${ka(l)}, element.id=0x${i.id}, container=${!!l.container} at position=${o}`),s}else switch(i.id){case 236:this.padding+=i.len,await this.tokenizer.ignore(i.len);break;default:Io(`parseEbml: parent=${ka(e)}, unknown child: id=${i.id.toString(16)} at position=${o}`),this.padding+=i.len,await this.tokenizer.ignore(i.len)}}return s}async readVintData(e){const n=await this.tokenizer.peekNumber(Te);let r=128,s=1;for(;!(n&r);){if(s>e)throw new Error("VINT value exceeding maximum size");++s,r>>=1}const i=new Uint8Array(s);return await this.tokenizer.readBuffer(i),i}async readElement(){const e=await this.readVintData(this.ebmlMaxIDLength),n=await this.readVintData(this.ebmlMaxSizeLength);return n[0]^=128>>n.length-1,{id:r0(e,e.length),len:r0(n,n.length)}}async readFloat(e){switch(e.len){case 0:return 0;case 4:return this.tokenizer.readNumber(ON);case 8:return this.tokenizer.readNumber(Yx);case 10:return this.tokenizer.readNumber(Yx);default:throw new Error(`Invalid IEEE-754 float length: ${e.len}`)}}async readFlag(e){return await this.readUint(e)===1}async readUint(e){const n=await this.readBuffer(e);return r0(n,e.len)}async readString(e){return(await this.tokenizer.readToken(new le(e.len,"utf-8"))).replace(/\x00.*$/g,"")}async readBuffer(e){const n=new Uint8Array(e.len);return await this.tokenizer.readBuffer(n),n}}function r0(t,e){return Number(qQ(t,e))}function qQ(t,e){const n=new Uint8Array(8),r=t.subarray(0,e);try{return n.set(r,8-e),Qw.get(n,0)}catch{return BigInt(-1)}}function tA(t){return t.container&&Object.keys(t.container).map(e=>{const n=t.container[e];return n.id=Number.parseInt(e),n}).forEach(e=>{e.parent=t,tA(e)}),t}function ka(t){let e="";return t.parent&&t.parent.name!=="dtd"&&(e+=`${ka(t.parent)}/`),e+t.name}const ch=Qe("music-metadata:parser:matroska");class KQ extends Er{constructor(){super(...arguments),this.seekHeadOffset=0,this.flagUseIndexToSkipClusters=!1}init(e,n,r){return super.init(e,n,r),this.flagUseIndexToSkipClusters=r.mkvUseIndex??!1,this}async parse(){const e=this.tokenizer.fileInfo.size??Number.MAX_SAFE_INTEGER,n=new WQ(this.tokenizer);ch("Initializing DTD end MatroskaIterator"),await n.iterate(GQ,e,{startNext:r=>{switch(r.id){case 475249515:return ch(`Skip element: name=${r.name}, id=0x${r.id.toString(16)}`),Xr.IgnoreElement;case 524531317:if(this.flagUseIndexToSkipClusters&&this.seekHead){const s=this.seekHead.seek.find(i=>i.position+this.seekHeadOffset>this.tokenizer.position);if(s){const i=s.position+this.seekHeadOffset-this.tokenizer.position;return ch(`Use index to go to next position, ignoring ${i} bytes`),this.tokenizer.ignore(i),Xr.SkipElement}}return Xr.IgnoreElement;default:return Xr.ReadNext}},elementValue:async(r,s,i)=>{switch(ch(`Received: name=${r.name}, value=${s}`),r.id){case 17026:this.metadata.setFormat("container",`EBML/${s}`);break;case 290298740:this.seekHead=s,this.seekHeadOffset=i;break;case 357149030:{const o=s,l=o.timecodeScale?o.timecodeScale:1e6;if(typeof o.duration=="number"){const c=o.duration*l/1e9;await this.addTag("segment:title",o.title),this.metadata.setFormat("duration",Number(c))}}break;case 374648427:{const o=s;if(o!=null&&o.entries){o.entries.forEach(c=>{const u={codecName:c.codecID.replace("A_","").replace("V_",""),codecSettings:c.codecSettings,flagDefault:c.flagDefault,flagLacing:c.flagLacing,flagEnabled:c.flagEnabled,language:c.language,name:c.name,type:c.trackType,audio:c.audio,video:c.video};this.metadata.addStreamInfo(u)});const l=o.entries.filter(c=>c.trackType===Za.audio).reduce((c,u)=>!c||u.flagDefault&&!c.flagDefault||u.trackNumber<c.trackNumber?u:c,null);l&&(this.metadata.setFormat("codec",l.codecID.replace("A_","")),this.metadata.setFormat("sampleRate",l.audio.samplingFrequency),this.metadata.setFormat("numberOfChannels",l.audio.channels))}}break;case 307544935:{const o=s;await Promise.all(o.tag.map(async l=>{const c=l.target,u=c!=null&&c.targetTypeValue?Zx[c.targetTypeValue]:c!=null&&c.targetType?c.targetType:"track";await Promise.all(l.simpleTags.map(async d=>{const m=d.string?d.string:d.binary;await this.addTag(`${u}:${d.name}`,m)}))}))}break;case 423732329:{const o=s;await Promise.all(o.attachedFiles.filter(l=>l.mimeType.startsWith("image/")).map(l=>this.addTag("picture",{data:l.data,format:l.mimeType,description:l.description,name:l.name})))}break}}})}async addTag(e,n){await this.metadata.addTag("matroska",e,n)}}const Xf=Qe("music-metadata:parser:factory");function QQ(t){const e=Jw.parse(t),n=qq(e.type);return{type:n.type,subtype:n.subtype,suffix:n.suffix,parameters:e.parameters}}async function XQ(t,e){const{mimeType:n,path:r,url:s}=t.fileInfo,i=nA(n)||cy(r)||cy(s);return i||Xf(`No parser found for MIME-type / extension: ${n}`),YQ(t,i,e)}async function YQ(t,e,n){if(!e){Xf("Guess parser on content...");const i=new Uint8Array(4100);if(await t.peekBuffer(i,{mayBeLess:!0}),t.fileInfo.path&&(e=cy(t.fileInfo.path)),!e){const o=await UN(i);if(!o)throw new Error("Failed to determine audio format");if(Xf(`Guessed file type is mime=${o.mime}, extension=${o.ext}`),e=nA(o.mime),!e)throw new Error(`Guessed MIME-type not supported: ${o.mime}`)}}const r=await JQ(e),s=new kK(n);return await r.init(s,t,n??{}).parse(),s.toCommonMetadata()}function cy(t){if(!t)return;switch(ZQ(t).toLocaleLowerCase()||t){case".mp2":case".mp3":case".m2a":case".aac":return"mpeg";case".ape":return"apev2";case".mp4":case".m4a":case".m4b":case".m4pa":case".m4v":case".m4r":case".3gp":return"mp4";case".wma":case".wmv":case".asf":return"asf";case".flac":return"flac";case".ogg":case".ogv":case".oga":case".ogm":case".ogx":case".opus":case".spx":return"ogg";case".aif":case".aiff":case".aifc":return"aiff";case".wav":case".bwf":return"riff";case".wv":case".wvp":return"wavpack";case".mpc":return"musepack";case".dsf":return"dsf";case".dff":return"dsdiff";case".mka":case".mkv":case".mk3d":case".mks":case".webm":return"matroska"}}async function JQ(t){switch(t){case"aiff":return new PK;case"adts":case"mpeg":return new vQ;case"apev2":return new ys;case"asf":return new GK;case"dsf":return new UQ;case"dsdiff":return new HQ;case"flac":return new KK;case"mp4":return new Kf;case"musepack":return new TQ;case"ogg":return new Sp;case"riff":return new OQ;case"wavpack":return new zQ;case"matroska":return new KQ;default:throw new Error(`Unknown parser type: ${t}`)}}function ZQ(t){const e=t.lastIndexOf(".");return e===-1?"":t.slice(e)}function nA(t){let e;if(!t)return;try{e=QQ(t)}catch{Xf(`Invalid HTTP Content-Type header value: ${t}`);return}const n=e.subtype.indexOf("x-")===0?e.subtype.substring(2):e.subtype;switch(e.type){case"audio":switch(n){case"mp3":case"mpeg":return"mpeg";case"aac":case"aacp":return"adts";case"flac":return"flac";case"ape":case"monkeys-audio":return"apev2";case"mp4":case"m4a":return"mp4";case"ogg":case"opus":case"speex":return"ogg";case"ms-wma":case"ms-wmv":case"ms-asf":return"asf";case"aiff":case"aif":case"aifc":return"aiff";case"vnd.wave":case"wav":case"wave":return"riff";case"wavpack":return"wavpack";case"musepack":return"musepack";case"matroska":case"webm":return"matroska";case"dsf":return"dsf"}break;case"video":switch(n){case"ms-asf":case"ms-wmv":return"asf";case"m4v":case"mp4":return"mp4";case"ogg":return"ogg";case"matroska":case"webm":return"matroska"}break;case"application":switch(n){case"vnd.ms-asf":return"asf";case"ogg":return"ogg"}break}}async function eX(t,e={}){const n={mimeType:t.type,size:t.size};return t instanceof File&&(n.path=t.name),tX(t.stream(),n,e)}function tX(t,e,n={}){return nX(DN(t,{fileInfo:typeof e=="string"?{mimeType:e}:e}),n)}function nX(t,e){return XQ(t,e)}const rA=async t=>{var l;if(!t)return;const e=await eX(t);if(!e)return;const{common:{title:n,artist:r,picture:s},format:{duration:i}}=e;return Object.assign({},{name:n||t.name,singer:r||"...",duration:i||0,image:s?(l=s[0])==null?void 0:l.data:null})};function rX(t){const{resetPage:e}=at(),{setErrorToast:n,setSuccessToast:r}=te(),{songFile:s,imageFile:i,setImageFile:o,updateSongData:l,setSongData:c,songData:u,singers:d,song:m,genres:p,setGenres:g,setSingers:x,imageBlob:w,setImageBlob:v,audioRef:S,setSongFile:_}=ls(),[E,I]=h.useState(!1),N=h.useRef(null),F=h.useMemo(()=>{var H,K;if(t.variant==="add")return!0;if(!m||!u)return!1;if(u.name!==m.name||d.length!==m.singers.length||u.like!==m.like||p.length!==m.genres.length||u.release_year!==m.release_year||((H=u.main_genre)==null?void 0:H.id)!==((K=m.main_genre)==null?void 0:K.id))return!0;const he=d.find(ee=>m.singers.find(be=>be.id!==ee.id)),ge=p.find(ee=>m.genres.find(be=>be.id!==ee.id));return he||ge},[u,m,d,p]),k=!!i,j=h.useMemo(()=>{const ne=!!(u!=null&&u.name)&&!!d.length&&!!p.length&&!!u.release_year&&!!u.main_genre&&F;return t.variant==="add"?ne:ne||k},[k,F,d,p,u]),C=()=>{switch(t.variant){case"add":return Wx({owner_email:t.ownerEmail,distributor:t.distributor,is_official:!0});case"edit":S.current&&(S.current.src=t.song.song_url);const{id:ne,updated_at:he,...ge}=t.song;return x(ge.singers),g(ge.genres),Wx(ge)}},R=()=>{var ne,he;switch(t.variant){case"add":(ne=N.current)==null||ne.close(),setTimeout(()=>{_(void 0),o(void 0),v(void 0),x([]),g([]),c(C())},500);break;case"edit":(he=N.current)==null||he.close()}},A=async()=>{if(!s)return;const ne=await rA(s);if(ne){const he={name:ne.name+" "+ne.singer,duration:Math.floor(ne.duration),size:Math.floor(s.size/1024),image_url:""};if(ne.image){const ge=new Blob([ne.image]);v(ge),he.image_url=URL.createObjectURL(ge)}l(he)}},M=()=>{if(!u)return[];const ne=[];return ne.push(...bn(u.name).split(" ")),d.forEach(he=>ne.push(...bn(he.name).split(" "))),ne},P=()=>{const ne={};d.forEach(ge=>ne[ge.id]=!0);const he=p.map(ge=>ge.id);return{singer_map:ne,genre_ids:he}},we=async()=>{var ne;try{if(!j||!u)return;const he={...u};I(!0);let ge;switch((i||w)&&(m!=null&&m.image_file_id&&Dt({fileId:m.image_file_id,msg:">>> api: Delete image file"}),ge=mi({imageFile:i,blob:w})),t.variant){case"add":{if(!s)return;const H=rd({file:s,folder:"/songs/",msg:"upload song file"}),[K,{fileId:ee,url:be}]=await Promise.all([ge,H]),Re={singers:d,genres:p,song_url:be,song_file_id:ee,...P(),meta:M()};if(Object.assign(he,Re),K){const Oe={image_url:K.image_url,image_file_id:K.image_file_id,blurhash_encode:K.blurhash_encode};Object.assign(he,Oe)}await Is({collectionName:"Songs",data:he,msg:">>> api: set song doc"}),r(),(ne=N.current)==null||ne.open();break}case"edit":{if(!m)return;if(F){const H={singers:d,genres:p,...P(),meta:M()};Object.assign(he,H)}if(ge){const{blurhash_encode:H,image_file_id:K,image_url:ee}=await ge;Object.assign(he,{image_url:ee,image_file_id:K,blurhash_encode:H})}o(void 0),v(void 0),await je({collectionName:"Songs",id:m.id,data:he}),l(he),r("Song updated")}}e()}catch(he){console.log(he),n()}finally{I(!1)}};return h.useEffect(()=>{c(C())},[]),h.useEffect(()=>{!s||!S.current||(S.current.src=URL.createObjectURL(s),A())},[s]),h.useEffect(()=>{!u||!S.current||(S.current.src=u.song_url)},[u==null?void 0:u.song_url]),h.useEffect(()=>{i&&l({image_url:URL.createObjectURL(i)})},[i]),h.useEffect(()=>{if(!F)return;const ne=he=>{he.preventDefault()};return window.addEventListener("beforeunload",ne),()=>{window.removeEventListener("beforeunload",ne)}},[F]),{isValidToSubmit:j,handleSubmit:we,isFetching:E,updateSongData:l,handleCloseModalAfterFinished:R,modalRef:N}}function sX({handleCloseModal:t,variant:e}){return a.jsxs(ve,{children:[a.jsx(Be,{closeModal:t,title:"Successful"}),a.jsx(Ae,{width:"w-[120px]",className:"mx-auto w-[120px]",src:"https://zalo-api.zadn.vn/api/emoticon/sticker/webpc?eid=46985&size=130"}),a.jsxs("div",{className:"flex justify-center mt-5 space-x-2",children:[a.jsxs(q,{href:"/dashboard/song",children:[a.jsx(dv,{className:"w-6"}),a.jsx("span",{children:"Songs"})]}),a.jsxs(q,{onClick:t,children:[a.jsx(oa,{className:"w-6"}),a.jsx("span",{children:e==="add"?"Add more":"Ok"})]})]})]})}function iX({closeModal:t}){const{songData:e,updateSongData:n}=ls(),[r,s]=h.useState({name:"",release_year:0}),i=l=>{s(c=>({...c,...l}))},o=()=>{!r.name||!r.release_year||(n({name:r.name,release_year:r.release_year}),t())};return h.useEffect(()=>{e&&s({name:e.name,release_year:e.release_year})},[e]),a.jsxs(ve,{children:[a.jsx(Be,{title:"Edit song",closeModal:t}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx(Lt,{children:"Name"}),a.jsx(_n,{value:r==null?void 0:r.name,onChange:l=>i({name:l.target.value})})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx(Lt,{children:"Release year"}),a.jsx(_n,{type:"number",value:r.release_year+""||"0",onChange:l=>i({release_year:+l.target.value||0})})]})]}),a.jsx("p",{className:"mt-6 text-right",children:a.jsx(q,{onClick:o,children:"Ok"})})]})}function aX({closeModal:t}){const{setErrorToast:e,setSuccessToast:n}=te(),{song:r,updateSongData:s}=ls(),[i,o]=h.useState(),[l,c]=h.useState(!1);return{songFile:i,isFetching:l,submit:async()=>{try{if(!i||!r)return;c(!0),Dt({fileId:r.song_file_id});const{url:d,fileId:m}=await rd({file:i,folder:"/songs/"}),p={song_url:d,song_file_path:m};await je({collectionName:"Songs",data:p,id:r.id}),s(p),n("Change song file successful"),t()}catch(d){console.log(d),e()}finally{c(!1)}},setSongFile:o}}function oX({closeModal:t}){const{songFile:e,setSongFile:n,isFetching:r,submit:s}=aX({closeModal:t}),i=h.useMemo(()=>e?URL.createObjectURL(e):"",[e]),o=l=>{var c;(c=l.target.files)!=null&&c.length&&n(l.target.files[0])};return a.jsx(a.Fragment,{children:a.jsxs(ve,{children:[a.jsx(Be,{title:"Change song file",closeModal:t}),!e&&a.jsx("input",{accept:"audio",type:"file",onChange:o}),e&&a.jsx("audio",{src:i,controls:!0}),a.jsx("p",{className:"text-right",children:a.jsx(q,{loading:r,className:"mt-5",onClick:s,children:"Save"})})]})})}function lX(){const{shouldFetchUserSongs:t,lastDoc:e}=at(),{setSuccessToast:n,setErrorToast:r}=te(),[s,i]=h.useState(!1),o=Wt();return{actions:async c=>{try{i(!0);const u=fi(oe),d=it(oe,"Songs",c.song.id),m=await bt(ue(Xa,X("target_id","==",c.song.id)));switch(c.variant){case"delete":{if(u.delete(d),c.song.lyric_id){const p=it(oe,"Lyrics",c.song.lyric_id);u.delete(p)}m.empty||(console.log(`Delete ${m.docs.length} comments`),m.forEach(p=>u.delete(p.ref))),await Promise.all([u.commit(),dR(c.song)]),t.current=!0,e.current=void 0,n(`'${c.song.name}' deleted`),o("/dashboard/song");break}}}catch(u){console.log({message:u}),r()}finally{i(!1)}},isFetching:s}}function cX(){const{song:t}=ls(),{actions:e,isFetching:n}=lX(),[r,s]=h.useState(""),i=h.useRef(null),o=c=>{var u;s(c),(u=i.current)==null||u.open()},l=()=>{var c;return(c=i.current)==null?void 0:c.close()};return a.jsxs(a.Fragment,{children:[a.jsxs(q,{onClick:()=>o("edit"),size:"clear",children:[a.jsx(Dr,{}),a.jsx("span",{children:"Edit"})]}),a.jsx(Y,{to:`/dashboard/lyric/${t==null?void 0:t.id}`,children:a.jsxs(q,{size:"clear",children:[a.jsx(CF,{}),a.jsx("span",{children:"Lyric"})]})}),a.jsxs(q,{onClick:()=>o("change-file"),size:"clear",children:[a.jsx(la,{}),a.jsx("span",{children:"Change song file"})]}),a.jsxs(q,{onClick:()=>o("delete"),size:"clear",children:[a.jsx(ut,{}),a.jsx("span",{children:"Delete"})]}),a.jsxs(re,{variant:"animation",ref:i,children:[r==="edit"&&a.jsx(iX,{closeModal:l}),r==="change-file"&&a.jsx(oX,{closeModal:l}),r==="delete"&&t&&a.jsx(an,{loading:n,label:`Delete '${t.name}' ?`,desc:"This action cannot be undone",callback:()=>e({variant:"delete",song:t}),closeModal:l})]})]})}function uX(){const{setImageFile:t,songData:e,updateSongData:n,imageBlob:r,setImageBlob:s}=ls(),i=h.useRef(null);Mw({setImageFileFromParent:t,modalRef:i});const o=()=>{e&&(s(void 0),URL.revokeObjectURL(e.image_url),n({image_url:""}))},l=c=>{e&&(s(void 0),URL.revokeObjectURL(e.image_url),t(c))};return a.jsxs(a.Fragment,{children:[a.jsxs(q,{onClick:()=>{var c;return(c=i.current)==null?void 0:c.open()},children:[a.jsx(ui,{}),a.jsx("span",{children:"Change image"})]}),r&&a.jsxs(q,{onClick:o,size:"clear",children:[a.jsx(oo,{}),a.jsx("span",{children:"Discard image"})]}),a.jsx(re,{variant:"animation",ref:i,children:a.jsx(Hl,{modalRef:i,setImageFile:l,title:"Song image"})})]})}function sA({title:t}){const{setSongFile:e}=ls(),n=h.useRef(null),r=s=>{var i,o,l;(o=(i=s.target)==null?void 0:i.files)!=null&&o.length&&e((l=s.target)==null?void 0:l.files[0])};return a.jsxs(a.Fragment,{children:[a.jsx("label",{ref:n,htmlFor:"song_upload",className:"hidden",children:a.jsx(fv,{className:"w-6"})}),a.jsx("input",{onChange:r,type:"file",multiple:!0,accept:"audio",id:"song_upload",className:"hidden"}),a.jsxs(q,{onClick:()=>{var s;return(s=n.current)==null?void 0:s.click()},children:[a.jsx(ym,{}),a.jsx("span",{children:t})]})]})}function dX({isEdit:t}){return a.jsx(a.Fragment,{children:a.jsxs(Vl,{className:"[&_span]:text-sm",children:[a.jsx(uX,{}),t&&a.jsx(cX,{}),!t&&a.jsx(sA,{title:"Change song file"})]})})}function Tu({children:t,className:e="space-y-1"}){return a.jsx($t,{className:"text-sm  [&_span]:font-semibold [&_span]:text-[#666] [&_span]:mr-1 "+e,children:t})}function hX(){const{songData:t,updateSongData:e,variant:n}=ls();return a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("div",{children:"Name"}),n.current==="edit"?a.jsx(Z,{variant:"h1",title:(t==null?void 0:t.name)||""}):a.jsx(_n,{className:"mt-2",placeholder:"...",value:(t==null?void 0:t.name)||"",onChange:r=>e({name:r.target.value})})]}),a.jsxs("div",{children:[a.jsx("div",{children:"Release year"}),n.current==="edit"?a.jsx(Z,{variant:"h2",title:(t==null?void 0:t.release_year)+""}):a.jsx(_n,{className:"mt-2 md:w-[50%]",placeholder:"...",type:"number",step:1,value:(t==null?void 0:t.release_year)+"",onChange:r=>isNaN(+r.target.value)?{}:e({release_year:+r.target.value})})]})]})}function iA(t){const{isFetching:e,handleSubmit:n,isValidToSubmit:r,modalRef:s,handleCloseModalAfterFinished:i,updateSongData:o}=rX(t),{songFile:l,songData:c,song:u,audioRef:d}=ls(),{api:m,isFetching:p}=xp(),g=h.useMemo(()=>u?u.updated_at:"",[u]);return h.useEffect(()=>{m()}),a.jsxs(a.Fragment,{children:[p?a.jsx(Ve,{children:a.jsx(Un,{})}):a.jsx(a.Fragment,{children:!l&&t.variant==="add"&&a.jsx(Ve,{children:a.jsx(Vl,{children:a.jsx(sA,{title:"Upload song file"})})})}),a.jsxs("div",{className:`w-full md:max-w-[800px] md:mx-auto ${t.variant==="add"&&(l?"":"hidden")}`,children:[a.jsx("audio",{ref:d,className:"hidden"}),a.jsxs("div",{className:`relative mt-5 md:flex md:space-x-5 ${Qi(e,"disable")}`,children:[a.jsxs("div",{className:"flex flex-col items-center md:w-1/3 md:block space-y-3",children:[a.jsx("div",{className:"max-w-[200px] w-full aspect-[1/1]  rounded-lg overflow-hidden",children:a.jsx(Ae,{className:"object-cover h-full",blurHashEncode:c==null?void 0:c.blurhash_encode,src:c==null?void 0:c.image_url})}),a.jsxs("div",{className:"flex md:block mt-5",children:[t.variant==="edit"&&a.jsxs(Tu,{children:[a.jsxs("p",{children:[a.jsx("span",{children:"Total plays:"}),c==null?void 0:c.today_play]}),a.jsxs("p",{children:[a.jsx("span",{children:"Week plays:"}),c==null?void 0:c.week_play]}),a.jsxs("p",{children:[a.jsx("span",{children:"Today plays:"}),c==null?void 0:c.today_play]}),a.jsxs("p",{children:[a.jsx("span",{children:"Ranking:"}),c==null?void 0:c.last_week_rank]}),a.jsx(op,{init:(u==null?void 0:u.like)||0,loading:!1,submit:(x,w)=>{o({like:x}),w()}}),a.jsxs("p",{children:[a.jsx("span",{children:"Comments:"}),rs((c==null?void 0:c.comment)||0)]}),a.jsxs("p",{children:[a.jsx("span",{children:"Last listen:"}),jl(c==null?void 0:c.last_active)]}),a.jsxs("p",{children:[a.jsx("span",{children:"Last update:"}),jl(g)]})]}),a.jsx("div",{className:"ml-3 md:ml-0 md:mt-3",children:a.jsx(dX,{isEdit:t.variant==="edit"})})]})]}),a.jsxs("div",{className:"mt-5 md:mt-0 space-y-5 flex-grow",children:[a.jsx($t,{children:d.current&&a.jsx(JW,{audioEle:d.current})}),a.jsxs("div",{children:[a.jsx(Z,{variant:"h2",className:"mb-3",title:"Info"}),a.jsxs($t,{className:"space-y-5",children:[a.jsx(hX,{}),a.jsx(YW,{}),a.jsx(rq,{})]})]})]})]}),a.jsx("p",{className:"text-center mt-5",children:a.jsxs(q,{onClick:n,disabled:!r,loading:e,children:[a.jsx(Yu,{className:"w-6"}),a.jsx("span",{children:"Save"})]})})]}),a.jsx(re,{persisted:t.variant==="add",ref:s,variant:"animation",children:a.jsx(sX,{variant:t.variant,handleCloseModal:i})})]})}function fX(){const{user:t}=pe();if(t)return a.jsxs(a.Fragment,{children:[a.jsx(Z,{className:"mb-5",title:"Add Song"}),a.jsx(iA,{distributor:t.display_name,ownerEmail:t.email,variant:"add"})]})}function mX(){const[t,e]=h.useState(!0),[n,r]=h.useState(),s=h.useRef(!1),i=Wt(),{setErrorToast:o}=te();return{song:n,isFetching:t,getSong:async c=>{try{const u=await Gt({collectionName:"Songs",id:c,msg:"useGetSong, Get song doc"});if(!u.exists())return i("/dashboard/song");const d={...u.data(),id:u.id,queue_id:""};r(d)}catch(u){console.log(u),o()}finally{e(!1)}},ranEffect:s}}function pX(){const{getSong:t,isFetching:e,song:n,ranEffect:r}=mX(),{variant:s,setSong:i}=ls(),o=li();return h.useEffect(()=>{if(!r.current){if(s.current="edit",r.current=!0,!o.songId)return;t(o.songId)}},[]),h.useEffect(()=>{n&&i(n)},[n]),e?a.jsx(Ve,{children:a.jsx(Un,{})}):n?a.jsxs(a.Fragment,{children:[a.jsx(Z,{className:"mb-5",title:"Song Detail"}),a.jsx(iA,{song:n,variant:"edit"})]}):a.jsx(Ve,{children:a.jsx(Ce,{})})}const gX=["All","Result"];function xX(){const{setPlaylists:t,lastDoc:e,PAGE_SIZE:n,setHasMore:r,shouldGetPlaylists:s}=sd(),[i,o]=h.useState(""),[l,c]=h.useState(!0),[u,d]=h.useState("All"),[m,p]=h.useState([]),{setErrorToast:g}=te(),x=async v=>{try{if(v.preventDefault(),l)return;c(!0);const S=lr(vn,[X("is_official","==",!0)],i),_=await Dn(S);p(_),d("Result")}catch(S){console.log({message:S}),g()}finally{c(!1)}},w=async()=>{try{c(!0);const v=e.current?ue(vn,X("is_official","==",!0),X("is_album","==",!1),Ot("updated_at","desc"),qm(e.current),Mt(n)):ue(vn,X("is_official","==",!0),X("is_album","==",!1),Ot("updated_at","desc"),Mt(n)),S=await bt(v),_=S.docs.map(E=>({...E.data(),id:E.id}));e.current?t(E=>[...E,..._]):t(_),_.length<n?r(!1):e.current=S.docs[n-1]}catch(v){console.log({message:v}),g()}finally{c(!1)}};return h.useEffect(()=>{s.current?(s.current=!1,w()):c(!1)},[u]),{isFetching:l,value:i,setValue:o,handleSubmit:x,getPlaylists:w,tab:u,searchResult:m,setTab:d,tabs:gX}}function yX(){const{user:t}=pe(),{setPlaylists:e}=sd(),{addPlaylist:n,isFetching:r}=sp(),s=h.useRef(null),i=()=>{var l;return(l=s.current)==null?void 0:l.close()},o=async(l,c)=>{l.is_official=!0;const u=await n({variant:"add",playlist:l,imageFile:c},{push:!1});u&&e(d=>[u,...d]),i()};if(t)return a.jsxs(a.Fragment,{children:[a.jsxs(q,{onClick:()=>{var l;return(l=s.current)==null?void 0:l.open()},className:"self-start p-1.5 ml-5",size:"clear",color:"primary",children:[a.jsx(js,{className:"w-6"}),a.jsx("div",{className:"hidden md:block",children:"Add new playlist"})]}),a.jsx(re,{ref:s,variant:"animation",children:a.jsx(ve,{className:"w-[600px]",children:a.jsx(ql,{modalRef:s,isLoading:r,variant:"add",user:t,submit:o})})})]})}function vX(){const{playlists:t,hasMore:e}=sd(),{isFetching:n,getPlaylists:r,searchResult:s,tab:i,tabs:o,setTab:l,...c}=xX(),u=h.useMemo(()=>i==="All"?t:s,[i,t,s]);return a.jsxs(a.Fragment,{children:[a.jsx(Z,{title:"Playlists"}),a.jsxs("div",{className:"flex justify-between mt-3",children:[a.jsx(mo,{loading:i==="Result"&&n,...c}),a.jsx(yX,{})]}),a.jsx("div",{className:"mt-5 w-fit self-start",children:a.jsx(tr,{disable:i==="All",tabs:o,render:d=>d,tab:i,setTab:l})}),a.jsx("div",{className:"mt-3",children:a.jsx(os,{colList:["Name","Like",""],children:u.length?a.jsxs(a.Fragment,{children:[u.map((d,m)=>a.jsxs("tr",{children:[a.jsx("td",{children:a.jsx(Y,{className:"hover:underline",to:`/dashboard/playlist/${d.id}`,children:d.name})}),a.jsx("td",{children:rs(d.like)}),a.jsx("td",{children:"-"})]},m)),i==="All"&&n&&a.jsx("tr",{className:"no-hover border-none",children:a.jsx("td",{colSpan:9,children:a.jsx(Ie,{className:"animate-spin w-7 mx-auto"})})}),i==="All"&&a.jsx("tr",{className:"no-hover",children:a.jsx("td",{colSpan:9,className:"text-center hover:bg-none",children:a.jsx(q,{disabled:!e,onClick:r,children:"Get more"})})})]}):a.jsx("tr",{children:a.jsx("td",{colSpan:4,children:a.jsx(Ce,{})})})})})]})}const wX=["Newest","Result"];function _X(){const{uploadedSongs:t,setUploadedSongs:e,shouldFetchUserSongs:n,lastDoc:r,PAGE_SIZE:s,setHasMore:i}=at(),[o,l]=h.useState("Newest"),[c,u]=h.useState([]),[d,m]=h.useState(""),[p,g]=h.useState(!1),{setErrorToast:x}=te(),w=async()=>{try{g(!0),i(E=>r.current&&!E?(r.current=void 0,!E):E);const S=ue(_t,X("is_official","==",!0),Ot("updated_at","desc"),Mt(s)),_=await zt(S);e(_)}catch(S){console.log(S)}finally{g(!1)}},v=async S=>{try{S.preventDefault(),g(!0),l("Result");const _=lr(_t,[X("is_official","==",!0)],d),E=await zt(_);u(E)}catch(_){console.log({message:_}),x()}finally{g(!1)}};return h.useEffect(()=>{n.current&&(n.current=!1,w())},[]),{isFetching:p,value:d,getNewestSongs:w,result:c,uploadedSongs:t,setValue:m,handleSubmit:v,tabs:wX,tab:o,setTab:l}}function SX({closeModal:t,submit:e,isLoading:n,current:r}){const{uploadedSongs:s,result:i,getNewestSongs:o,isFetching:l,setTab:c,tabs:u,tab:d,...m}=_X(),{selectedSongs:p,selectSong:g}=ho(),x=async()=>{p.length&&(e(p),t())},w={col:"md:w-1/2 flex-1 flex flex-col px-2 overflow-hidden",box:"rounded-lg bg-[--a-5-cl] p-2",songItem:"rounded-md w-full p-1 text-sm font-semibold text-left hover:bg-[--a-5-cl]"},v=S=>S.length?S.map((_,E)=>{const I=r.includes(_.id);return a.jsx("button",{onClick:()=>g(_),className:`${w.songItem} ${I||p.find(N=>N.id===_.id)?"text-[--primary-cl]":""} `,children:_.name},E)}):a.jsx(Ce,{variant:"less"});return a.jsx(a.Fragment,{children:a.jsxs(ve,{className:"w-[600px] min-h-[400px]",children:[a.jsx(Be,{closeModal:t,title:"Add songs"}),a.jsx(mo,{className:"w-fit",...m}),a.jsxs("div",{className:"flex-grow flex flex-col md:flex-row -mx-2 overflow-hidden mt-3",children:[a.jsxs("div",{className:`${w.col}`,children:[a.jsx(tr,{className:"w-fit mb-1",buttonClasses:"[&_button]:px-3 [&_button]:py-1/2",tabs:u,setTab:c,disable:d==="Newest",tab:d,render:S=>S}),a.jsx("div",{className:`${w.box} flex-grow overflow-auto`,children:l?a.jsx(Un,{className:"h-full"}):a.jsx(a.Fragment,{children:d==="Result"?v(i):a.jsxs(a.Fragment,{children:[v(s),a.jsx("p",{className:"text-center mt-3",children:a.jsx(q,{onClick:o,size:"clear",className:"p-1",children:a.jsx(Ie,{className:"w-5"})})})]})})})]}),a.jsxs("div",{className:`${w.col} mt-3 md:mt-0`,children:[a.jsx(Lt,{className:"mb-1 md:h-[36px]",children:"Selected"}),a.jsx("div",{className:`${w.box} flex-grow overflow-auto`,children:v(p)})]})]}),a.jsx("p",{className:"text-right mt-3 flex-shrink-0",children:a.jsxs(q,{disabled:!p.length,loading:n,onClick:x,children:[a.jsx(oa,{className:"w-6"}),a.jsx("span",{children:"Add"})]})}),n&&a.jsx(pi,{})]})})}function i1(t){return a.jsx(jn,{children:a.jsx(SX,{...t})})}function bX(){const{songs:t}=Ym(),[e,n]=h.useState(""),r=h.useRef(null),{action:s,playlist:i,isFetching:o}=ap(),l=m=>{var p,g;n(m),e==="add-song-to-playlist"&&((p=r.current)==null||p.setModalPersist(!0)),(g=r.current)==null||g.open()},c=()=>{var m;return(m=r.current)==null?void 0:m.close()},u=async m=>{await s(m),c()},d=()=>{switch(e){case"":return a.jsx(a.Fragment,{});case"edit":return i?a.jsx(a.Fragment,{children:a.jsx(ve,{className:"w-[600px]",children:a.jsx(ql,{submit:(m,p)=>u({variant:"edit-playlist",playlist:m,imageFile:p}),variant:"edit",isLoading:o,playlist:i,modalRef:r})})}):"Playlist is undefined";case"delete":return a.jsx(an,{loading:o,label:"Delete playlist ?",callback:()=>u({variant:"delete-playlist"}),closeModal:c});case"add-song-to-playlist":return a.jsx(i1,{isLoading:o,submit:m=>u({variant:"add-songs",songs:m}),closeModal:c,current:t.map(m=>m.id)})}};return a.jsxs(a.Fragment,{children:[a.jsxs(Vl,{children:[a.jsxs(q,{onClick:()=>l("edit"),size:"clear",children:[a.jsx(Dr,{}),a.jsx("span",{children:"Edit"})]}),a.jsxs(q,{onClick:()=>l("delete"),size:"clear",children:[a.jsx(ut,{}),a.jsx("span",{children:"Delete"})]}),a.jsxs(q,{onClick:()=>l("add-song-to-playlist"),size:"clear",children:[a.jsx(iH,{}),a.jsx("span",{children:"Add song"})]})]}),a.jsx(re,{variant:"animation",ref:r,children:d()})]})}function EX(){const[t,e]=h.useState(!0),{setSongs:n,setPlaylist:r}=Ym(),s=h.useRef(!1),i=li(),o=Wt(),{setErrorToast:l}=te(),c=async()=>{try{if(!i.id)return;const u=await Gt({collectionName:"Playlists",id:i.id,msg:"useGetPlaylist, get playlist doc"});if(!u.exists())return o("/dashboard/playlist");const d={...u.data(),id:u.id};if(d.song_ids.length){const m=ue(_t,X(Lr(),"in",d.song_ids)),p=await zt(m);n(p)}r(d)}catch(u){console.log(u),l()}finally{e(!1)}};return h.useEffect(()=>{s.current||(s.current=!0,c())},[]),{isFetching:t}}function jX({singer:t}){const{action:e}=ap();return a.jsxs(a.Fragment,{children:[a.jsx(Y,{className:"hover:underline",to:`/dashboard/singer/${t.id}`,children:t.name}),a.jsx("div",{children:a.jsx("button",{onClick:()=>e({variant:"remove-singer",singer:t}),children:a.jsx(ut,{className:"w-5"})})})]})}function kX(){const{playlist:t,songs:e}=Ym(),{isFetching:n}=EX(),{action:r,isFetching:s}=ap(),i=async(l,c)=>{await r({variant:"edit-playlist",playlist:{like:l,updated_at:st()}}),c()},o=h.useMemo(()=>t==null?void 0:t.updated_at,[t==null?void 0:t.id]);return n?a.jsx(Ve,{children:a.jsx(Un,{})}):t?a.jsxs(a.Fragment,{children:[a.jsx(Z,{title:"Edit playlist",className:"mb-8"}),a.jsxs("div",{className:"md:flex md:-mx-3",children:[a.jsxs("div",{className:"space-y-3 md:px-3",children:[a.jsx("div",{className:"w-[200px] h-[200px] mx-auto rounded-md overflow-hidden",children:a.jsx(Ae,{className:"object-cover h-full",blurHashEncode:t.blurhash_encode,src:t.image_url})}),a.jsx(Z,{variant:"h2",title:t.name}),a.jsxs(Tu,{children:[a.jsxs("p",{children:[a.jsx("span",{children:"Public:"}),t.is_public?"Public":"Private"]}),a.jsxs("p",{children:[a.jsx("span",{children:"Songs:"}),e.length," songs"]}),a.jsxs("p",{children:[a.jsx("span",{children:"Comments:"}),rs(t.comment)]}),a.jsx(op,{init:t.like,loading:s,submit:i}),a.jsxs("p",{children:[a.jsx("span",{children:"Last update:"}),o?jl(o):""]})]}),a.jsx(bX,{})]}),a.jsxs("div",{className:"w-full mt-3 md:mt-0 md:w-3/4 md:px-3",children:[a.jsx(Z,{variant:"h3",title:"Singers"}),a.jsx($t,{className:"mt-1",children:t.singers.length?a.jsx("div",{className:"-mt-2 -ml-2 flex ",children:t.singers.map((l,c)=>a.jsx(ks,{children:a.jsx(jX,{singer:l})},c))}):a.jsx(Ce,{})}),a.jsx(Z,{title:"Songs",variant:"h3",className:"mt-3"}),a.jsx($t,{className:"mt-1",children:a.jsx("div",{className:"overflow-hidden",children:a.jsx(WR,{className:"[&_td]:text-sm [&_tbody>tr]:border-t [&_tr]:border-black/10 [&_th]:text-sm [&_th]:text-left [&_td]:p-2 [&_th]:p-2 hover:[&_tr:not(div.absolute)]:bg-black/5",colList:["Name","Singer","Genre",""],children:e.length?e.map((l,c)=>{var u;return a.jsxs("tr",{children:[a.jsx("td",{children:a.jsx(Y,{to:`/dashboard/song/${l.id}/edit`,className:"hover:underline",children:l.name})}),a.jsx("td",{children:l.singers.map((d,m)=>a.jsxs(Y,{className:"hover:underline",to:`/dashboard/singer/${d.id}`,children:[!!m&&", ",d.name]},m))}),a.jsx("td",{children:(u=l.main_genre)==null?void 0:u.name}),a.jsx("td",{children:a.jsx($R,{variant:"playlist",song:l})})]},c)}):a.jsx("tr",{children:a.jsx("td",{colSpan:4,children:a.jsx(Ce,{})})})})})})]})]})]}):a.jsx(a.Fragment,{})}function TX(){return a.jsx(V8,{children:a.jsx(kX,{})})}function aA(t){const{setImageFile:e,singerData:n,handleSubmit:r,isFetching:s,isValidToSubmit:i,updateSingerData:o,inputRef:l}=RN(t),c=h.useRef(null);if(n)return a.jsxs(a.Fragment,{children:[a.jsxs(ve,{className:"w-[700px]",children:[a.jsx(Be,{closeModal:()=>{var u;return(u=t.modalRef.current)==null?void 0:u.close()},title:t.variant==="add"?"Add singer":"Edit singer"}),a.jsxs("div",{className:"flex-grow overflow-auto md:flex md:flex-[unset]",children:[a.jsxs("div",{className:"space-y-2.5",children:[a.jsx("div",{className:"w-[200px] h-[200px] rounded-lg border overflow-hidden",children:a.jsx(Ae,{className:"object-cover object-center h-full",blurHashEncode:n.blurhash_encode,src:n.image_url})}),a.jsxs(q,{onClick:()=>{var u;return(u=c.current)==null?void 0:u.open()},children:[a.jsx(ui,{className:"w-5"}),a.jsx("span",{children:"Change image"})]})]}),a.jsxs("div",{className:"flex-grow flex flex-col mt-3  space-y-3 md:mt-0 md:ml-5",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx(Lt,{htmlFor:"name",children:"Name"}),a.jsx(_n,{ref:l,type:"text",id:"name",placeholder:"",value:n.name,onChange:u=>o({name:u.target.value})})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx(Lt,{htmlFor:"description",children:"Description"}),a.jsx("textarea",{placeholder:"...",id:"description",className:`${dl} rounded-md min-h-[100px]`,value:n.description,onChange:u=>o({description:u.target.value})})]})]})]}),a.jsx("p",{className:"text-right mt-3",children:a.jsx(q,{loading:s,color:"primary",onClick:r,disabled:!i,className:"font-playwriteCU rounded-full",children:"Save"})})]}),a.jsx(re,{variant:"animation",ref:c,children:a.jsx(Hl,{modalRef:c,title:"Album image",setImageFile:e})})]})}function IX(){const t=h.useRef(null);return a.jsxs(a.Fragment,{children:[a.jsxs(q,{onClick:()=>{var e;return(e=t.current)==null?void 0:e.open()},className:"self-start p-1.5 ml-5",size:"clear",children:[a.jsx(js,{className:"w-6"}),a.jsx("div",{className:"hidden md:block",children:"Add new singer"})]}),a.jsx(re,{ref:t,variant:"animation",children:a.jsx(aA,{modalRef:t,variant:"add"})})]})}const CX=["All","Result"];function RX(){const{setSingers:t,PAGE_SIZE:e,singers:n,setHasMore:r,shouldGetSingers:s,lastDoc:i}=cs(),[o,l]=h.useState(!0),[c,u]=h.useState("All"),{handleSubmit:d,result:m,value:p,setValue:g}=IN({afterSearched:()=>{u("Result")},setIsFetchingParent:l}),{setErrorToast:x}=te(),w=async()=>{try{l(!0);const v=i.current?ue(Qa,Ot("created_at","desc"),qm(i.current),Mt(e)):ue(Qa,Ot("created_at","desc"),Mt(e)),S=await bt(v),_=S.docs.map(E=>({...E.data(),id:E.id}));i.current?t(E=>[...E,..._]):t(_),_.length<e?r(!1):i.current=S.docs[e-1]}catch(v){console.log({message:v}),x()}finally{l(!1)}};return h.useEffect(()=>{s.current?(s.current=!1,w()):l(!1)},[]),{isFetching:o,value:p,setValue:g,handleSubmit:d,singers:n,tab:c,getSingers:w,setTab:u,result:m,tabs:CX}}function NX(){const{hasMore:t,singers:e}=cs(),{isFetching:n,result:r,getSingers:s,tabs:i,tab:o,setTab:l,...c}=RX(),u=h.useMemo(()=>o==="All"?e:r,[o,e,r]);return a.jsxs(a.Fragment,{children:[a.jsx(Z,{title:"Singers"}),a.jsxs("div",{className:"flex justify-between mt-3",children:[a.jsx(mo,{loading:o==="Result"&&n,...c}),a.jsx(IX,{})]}),a.jsx("div",{className:"mt-5 w-fit self-start",children:a.jsx(tr,{disable:o==="All",tabs:i,render:d=>d,tab:o,setTab:l})}),a.jsx("div",{className:"mt-3",children:a.jsx(os,{colList:["Name","Like"],children:u.length?a.jsxs(a.Fragment,{children:[u.map((d,m)=>a.jsxs("tr",{children:[a.jsx("td",{children:a.jsx(Y,{className:"hover:underline",to:`/dashboard/singer/${d.id}`,children:d.name})}),a.jsx("td",{children:rs(d.like)})]},m)),n&&a.jsx("tr",{className:"no-hover border-none",children:a.jsx("td",{colSpan:9,children:a.jsx(Ie,{className:"animate-spin w-7 mx-auto"})})}),o==="All"&&a.jsx("tr",{className:"no-hover",children:a.jsx("td",{colSpan:9,className:"text-center hover:bg-none",children:a.jsx(q,{disabled:!t,onClick:s,children:"Get more"})})})]}):a.jsx("tr",{children:a.jsx("td",{colSpan:2,children:a.jsx(Ce,{})})})})})]})}function AX({value:t}){const e=h.useRef(null);return a.jsxs(a.Fragment,{children:[a.jsxs(q,{onClick:()=>{var n;return(n=e.current)==null?void 0:n.open()},className:"p-1.5 ml-5",size:"clear",children:[a.jsx(Nt,{className:"w-6"}),a.jsx("div",{className:"hidden md:block",children:"Add genre"})]}),a.jsx(re,{ref:e,variant:"animation",children:a.jsx(gp,{genreName:t,type:"add",closeModal:()=>{var n;return(n=e.current)==null?void 0:n.close()}})})]})}function s0({genre:t}){const[e,n]=h.useState(""),r=h.useRef(null),{action:s,isFetching:i}=PN(),o=u=>{var d;n(u),(d=r.current)==null||d.open()},l=()=>{var u;return(u=r.current)==null?void 0:u.close()},c=async()=>{await s({type:"delete",id:t.id})};return a.jsxs(a.Fragment,{children:[a.jsxs(ks,{children:[a.jsx("span",{children:t.name}),a.jsxs("div",{children:[a.jsx("button",{className:"",onClick:()=>o("edit"),children:a.jsx(Dr,{className:"w-5"})}),a.jsx("button",{onClick:()=>o("delete"),children:a.jsx(ut,{className:"w-5"})})]})]}),a.jsxs(re,{variant:"animation",ref:r,children:[e==="edit"&&a.jsx(gp,{type:"edit",genre:t,closeModal:l}),e==="delete"&&a.jsx(an,{callback:c,closeModal:l,loading:i,label:`Delete genre '${t.name}'`})]})]})}function PX(){const{isFetching:t,api:e}=xp(),{_genres:n,mains:r,subs:s,...i}=FN();return h.useEffect(()=>{e()},[]),a.jsxs(a.Fragment,{children:[a.jsx(Z,{title:"Genres"}),a.jsxs("div",{className:"flex justify-between items-start mt-3",children:[a.jsx(zR,{...i}),a.jsx(AX,{value:i.value})]}),a.jsxs("div",{className:"mt-5 space-y-5",children:[t&&a.jsx(ye,{className:"h-[200px] rounded-xl"}),!t&&a.jsx(a.Fragment,{children:n.length?a.jsx("div",{className:"flex flex-wrap -mt-2 -mx-2",children:n.map(o=>a.jsx(s0,{genre:o},o.id))}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx(Z,{variant:"h3",className:"mb-1",title:"Main genres"}),a.jsx($t,{className:"mt-1",children:r.length?a.jsx("div",{className:"flex flex-wrap -mt-2  -mx-2",children:r.map(o=>a.jsx(s0,{genre:o},o.id))}):a.jsx(Ce,{})})]}),a.jsxs("div",{children:[a.jsx(Z,{variant:"h3",className:"mb-1",title:"Sub genres"}),a.jsx($t,{className:"mt-1",children:s.length?a.jsx("div",{className:"flex flex-wrap -mt-2 -mx-2",children:s.map(o=>a.jsx(s0,{genre:o},o.id))}):a.jsx(Ce,{})})]})]})})]})]})}function mE(){return a.jsx(EN,{})}function FX(){const{setErrorToast:t}=te(),{singer:e,setSinger:n,shouldGetSingers:r,lastDoc:s}=cs(),[i,o]=h.useState(!1),l=Wt();return{isFetching:i,action:async u=>{try{switch(u.variant){case"delete":{if(!e)throw new Error("");o(!0),await kw({collectionName:"Singers",id:e.id}),e.image_file_id&&Dt({fileId:e.image_file_id}),o(!1),r.current=!0,s.current=void 0,l("/dashboard/singer");break}}}catch(d){console.log({message:d}),t("")}finally{o(!1)}},singer:e,setSinger:n}}function MX(){const[t,e]=h.useState(""),n=h.useRef(null),{action:r,isFetching:s,singer:i}=FX(),o=c=>{var u;e(c),(u=n.current)==null||u.open()},l=()=>{var c;return(c=n.current)==null?void 0:c.close()};return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"mt-3",children:a.jsxs(Vl,{children:[a.jsxs(q,{onClick:()=>o("edit"),className:"md:px-3",size:"clear",children:[a.jsx(Dr,{className:"w-6"}),a.jsx("span",{children:"Edit singer"})]}),a.jsxs(q,{onClick:()=>o("delete"),className:"md:px-3",size:"clear",children:[a.jsx(ut,{className:"w-6"}),a.jsx("span",{children:"Delete"})]})]})}),a.jsxs(re,{variant:"animation",ref:n,children:[t==="more"&&i&&a.jsx(ve,{children:i.description}),t==="edit"&&a.jsx(aA,{modalRef:n,variant:"edit"}),t==="delete"&&i&&a.jsx(an,{label:`Delete singer '${i.name}'`,loading:s,callback:()=>r({variant:"delete"}),closeModal:l})]})]})}function DX(){const{setSinger:t,setSongs:e,setPlaylists:n,setAlbums:r}=cs(),{setErrorToast:s}=te(),{setIsFetching:i}=dd(),o=li(),l=Wt(),c=h.useRef(!1),u=async()=>{try{if(!o.id)return;const d=await Gt({collectionName:"Singers",id:o.id});d.exists()||l("/dashboard/singer");const m={...d.data(),id:o.id},p=ue(_t,X(`singer_map.${m.id}`,"==",!0)),g=await zt(p),x=ue(vn,X(`singer_map.${m.id}`,"==",!0)),w=await Dn(x),v=[],S=[];w.forEach(_=>_.is_album?S.push(_):v.push(_)),t(m),n(v),r(S),e(g)}catch(d){console.log({error:d}),s()}finally{i(!1)}};h.useEffect(()=>{c.current||(c.current=!0,u())},[])}function LX(){const[t,e]=h.useState(!0);return{isFetching:t,setIsFetching:e}}const oA=h.createContext(null);function OX({children:t}){return DX(),t}function $X({children:t}){return a.jsx(oA.Provider,{value:LX(),children:a.jsx(OX,{children:t})})}function dd(){const t=h.useContext(oA);if(!t)throw new Error;return t}function zX(){const{singer:t,setSinger:e}=cs(),{isFetching:n}=dd(),r=async(s,i)=>{t&&(await je({collectionName:"Singers",id:t.id,data:{like:s}}),e({...t,like:s}),i())};return!n&&!t?a.jsx(a.Fragment,{}):a.jsx(a.Fragment,{children:a.jsxs("div",{className:"md:flex",children:[a.jsx("div",{className:"flex-shrink-0 w-[260px] h-[260px] rounded-md overflow-hidden mx-auto md:m-unset",children:n?a.jsx(ye,{className:"pt-[100%] "}):a.jsx(Ae,{className:"object-cover",src:t==null?void 0:t.image_url,blurHashEncode:(t==null?void 0:t.blurhash_encode)||""})}),a.jsx("div",{className:"flex-grow flex flex-col mt-5 space-y-2.5  md:mt-0 md:ml-5",children:n?a.jsxs(a.Fragment,{children:[a.jsx(ye,{className:"h-[60px] w-full md:w-[200px]"}),a.jsx(ye,{className:"h-[120px] w-full md:w-[70%]"}),a.jsx(ye,{className:"h-[17px] w-[200px]"})]}):t&&a.jsxs(a.Fragment,{children:[a.jsxs(Tu,{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("span",{children:"Name"}),a.jsx(Z,{variant:"h1",title:t.name})]}),a.jsx(op,{init:t.like,loading:!1,submit:r}),a.jsxs("p",{children:[a.jsx("span",{children:"Description"})," ",a.jsx("br",{}),t.description]})]}),a.jsx(MX,{})]})})]})})}function BX(){const{songs:t}=cs(),{isFetching:e}=dd();return a.jsxs(a.Fragment,{children:[a.jsx(Z,{variant:"h2",title:"Songs"}),a.jsx(jn,{children:e?a.jsx(ye,{className:"h-[100px]"}):a.jsx(os,{colList:["Name","Singers","Genres"],children:t.length?t.map((n,r)=>a.jsxs("tr",{className:"hover:bg-black/10",children:[a.jsx("td",{children:a.jsx(Y,{to:`/dashboard/song/${n.id}/edit`,children:n.name})}),a.jsx("td",{children:n.singers.map((s,i)=>a.jsx(Y,{to:`/dashboard/singer/${s.id}`,className:"hover:text-green-500 hover:underline",children:(i?", ":"")+s.name},i))}),a.jsx("td",{children:n.genres.map((s,i)=>a.jsxs("span",{children:[!!i&&", ",s.name]},i))})]},r)):a.jsx("tr",{children:a.jsx("td",{colSpan:4,children:a.jsx(Ce,{})})})})})]})}function VX(){const{playlists:t}=cs(),{isFetching:e}=dd();return a.jsxs(a.Fragment,{children:[a.jsx(Z,{variant:"h2",title:"Playlists"}),e&&a.jsx(ye,{className:"h-[100px]"}),!e&&a.jsx(os,{colList:["Name",""],children:t.length?t.map((n,r)=>a.jsxs("tr",{className:"hover:bg-black/10",children:[a.jsx("td",{children:a.jsx(Y,{to:`/dashboard/playlist/${n.id}`,children:n.name})}),a.jsx("td",{children:"-"})]},r)):a.jsx("tr",{children:a.jsx("td",{colSpan:2,children:a.jsx(Ce,{})})})})]})}function UX(){const[t,e]=h.useState(),[n,r]=h.useState(),[s,i]=h.useState();return{singer:t,setSinger:e,updateAlbumData:l=>{n&&r({...n,...l})},albumData:n,imageFile:s,setImageFile:i,setAlbumData:r}}const lA=h.createContext(null);function HX({children:t}){return a.jsx(lA.Provider,{value:UX(),children:t})}function a1(){const t=h.useContext(lA);if(!t)throw new Error("AddAlbumProvider not provided");return t}function GX(t){const{imageFile:e,updateAlbumData:n,setSinger:r,albumData:s,singer:i,setImageFile:o,setAlbumData:l}=a1(),{setSuccessToast:c,setErrorToast:u}=te(),[d,m]=h.useState(!1),p=h.useRef(!1),g=h.useMemo(()=>t.variant==="add"?!0:!t.album||!s?!1:s.name!==t.album.name||(i==null?void 0:i.id)!==t.album.singers[0].id||s.like!==t.album.like,[s,i]),x=!!e,w=h.useMemo(()=>{const _=!!g&&!!s&&!!s.name&&!!i;return t.variant==="add"?_:_||x},[x,g,s,i]),v=async()=>{var _;try{if(!s||!i)return;if(m(!0),e){s.image_file_id&&Dt({fileId:s.image_file_id});const E=await mi({imageFile:e});Object.assign(s,E)}switch(s.singers=[i],s.singer_map={[i.id]:!0},s.name=s.name.trim(),s.meta=bn(s.name).split(" "),t.variant){case"add":{const E=await Is({collectionName:"Playlists",data:s}),I=await _l(E),N={...I.data(),id:I.id};t.afterSubmit(N),c("Album created");break}case"edit":{if(!t.album)return;await je({collectionName:"Playlists",data:{...s,updated_at:st()},id:t.album.id}),t.afterSubmit(s),c("Album edited");break}}(_=t.modalRef.current)==null||_.close()}catch(E){console.log(E),u()}finally{m(!1),o(void 0)}},S=async()=>{switch(t.variant){case"add":l(oH({owner_email:t.user.email,distributor:t.user.email})),r(t.singer);break;case"edit":const{id:_,...E}=t.album;r(E.singers[0]),l(E);break}};return h.useEffect(()=>{var _;p.current||(p.current=!0,S(),t.variant==="add"&&((_=t.modalRef.current)==null||_.setModalPersist(!0)))},[]),h.useEffect(()=>{var _;(g||e)&&((_=t.modalRef.current)==null||_.setModalPersist(!0))},[s,i,e]),h.useEffect(()=>{e&&n({image_url:URL.createObjectURL(e)})},[e]),{submit:v,isFetching:d,isValidToSubmit:w}}function WX(){const{singer:t,setSinger:e,albumData:n}=a1(),r=h.useRef(null),s=i=>{var o;e(i),(o=r.current)==null||o.close()};if(n)return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center space-x-1.5",children:[a.jsx(Lt,{children:"Singer"}),t?a.jsxs(ks,{className:"!mt-0",children:[a.jsx("span",{children:t.name}),a.jsx("div",{children:a.jsx("button",{onClick:()=>e(void 0),children:a.jsx(ut,{className:"w-5"})})})]}):a.jsx(q,{size:"clear",className:"p-1.5",onClick:()=>{var i;return(i=r.current)==null?void 0:i.open()},children:a.jsx(Nt,{className:"w-5"})})]}),a.jsx(re,{variant:"animation",ref:r,children:a.jsx(NN,{choose:s,closeModal:()=>{var i;return(i=r.current)==null?void 0:i.close()}})})]})}function qX({className:t="",...e}){const{albumData:n,setImageFile:r,updateAlbumData:s}=a1(),{submit:i,isFetching:o,isValidToSubmit:l}=GX(e),c=h.useRef(null),u=a.jsxs(q,{size:"clear",className:"py-1.5 px-3",onClick:i,loading:o,disabled:!l||o,children:[a.jsx(Yu,{className:"w-6"}),a.jsx("span",{children:"Save"})]});return n?a.jsxs(a.Fragment,{children:[a.jsx(Be,{closeModal:()=>{var d;return(d=e.modalRef.current)==null?void 0:d.close()},title:e.variant==="add"?"Add album":"Edit albm"}),a.jsxs("div",{className:`md:flex ${t} overflow-auto`,children:[a.jsxs("div",{className:"space-y-3",children:[a.jsx($t,{p:"clear",className:"w-[200px] mx-auto h-[200px] rounded-lg overflow-hidden",children:a.jsx(Ae,{className:"object-cover object-center h-full",blurHashEncode:n.blurhash_encode,src:n.image_url})}),a.jsxs(q,{onClick:()=>{var d;return(d=c.current)==null?void 0:d.open()},children:[a.jsx(ui,{className:"w-6"}),a.jsx("span",{children:"Change image"})]})]}),a.jsx("div",{className:"md:w-3/4 mt-5 md:mt-0 md:ml-5 flex-grow flex flex-col space-y-5",children:a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx(Lt,{htmlFor:"name",children:"Name"}),a.jsx(_n,{type:"text",placeholder:"name...",id:"name",className:"text-[#333]",value:n.name,onChange:d=>s({name:d.target.value})})]}),a.jsx(WX,{})]})})]}),a.jsx("p",{className:"text-right mt-3",children:u}),o&&a.jsx(pi,{}),a.jsx(re,{variant:"animation",ref:c,children:a.jsx(Hl,{modalRef:c,title:"Album image",setImageFile:r})})]}):a.jsx(a.Fragment,{})}function o1(t){return a.jsx(HX,{children:a.jsx(qX,{...t})})}function KX(){const{user:t}=pe(),{singer:e,setAlbums:n}=cs(),r=h.useRef(null),s=i=>{n(o=>[i,...o])};return a.jsxs(a.Fragment,{children:[a.jsxs(q,{onClick:()=>{var i;return(i=r.current)==null?void 0:i.open()},className:"px-3 py-1",size:"clear",children:[a.jsx(Nt,{className:"w-5"}),a.jsx("span",{children:"Add album"})]}),a.jsx(re,{variant:"animation",ref:r,children:a.jsx(ve,{className:"w-[700px]",children:t&&e&&a.jsxs(a.Fragment,{children:[a.jsx(Be,{title:"Add album",closeModal:()=>{var i;return(i=r.current)==null?void 0:i.close()}}),a.jsx(o1,{className:"flex-grow overflow-auto no-scrollbar md:overflow-hidden",variant:"add",modalRef:r,singer:e,afterSubmit:s,user:t})]})})})]})}function QX(){const{albums:t}=cs(),{isFetching:e}=dd();return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx(Z,{variant:"h2",title:"Albums"}),a.jsx(KX,{})]}),e&&a.jsx(ye,{className:"h-[100px]"}),!e&&a.jsx(os,{colList:["Name",""],children:t.length?t.map((n,r)=>a.jsxs("tr",{className:"hover:bg-black/10",children:[a.jsx("td",{children:a.jsx(Y,{to:`/dashboard/album/${n.id}`,children:n.name})}),a.jsx("td",{children:"-"})]},r)):a.jsx("tr",{children:a.jsx("td",{colSpan:2,children:a.jsx(Ce,{})})})})]})}function XX(){return a.jsx(a.Fragment,{children:a.jsxs("div",{className:"space-y-5",children:[a.jsx(zX,{}),a.jsx(QX,{}),a.jsx(BX,{}),a.jsx(VX,{})]})})}function YX(){return a.jsx($X,{children:a.jsx(XX,{})})}function JX({setAlbums:t}){const{user:e}=pe(),n=h.useRef(null),r=()=>{var i;return(i=n.current)==null?void 0:i.close()},s=i=>{t(o=>[i,...o]),r()};if(e)return a.jsxs(a.Fragment,{children:[a.jsxs(q,{onClick:()=>{var i;return(i=n.current)==null?void 0:i.open()},className:"self-start p-1.5 ml-5",size:"clear",children:[a.jsx(js,{className:"w-6"}),a.jsx("div",{className:"hidden md:block",children:"Add new album"})]}),a.jsx(re,{ref:n,variant:"animation",persisted:!0,children:a.jsx(ve,{className:"w-[600px]",children:a.jsx(o1,{className:"overflow-auto",variant:"add",user:e,modalRef:n,afterSubmit:s})})})]})}const ZX=["All","Result"];function eY(){const[t,e]=h.useState([]),[n,r]=h.useState(""),[s,i]=h.useState(!0),[o,l]=h.useState("All"),{setErrorToast:c}=te(),u=async m=>{try{if(m.preventDefault(),s)return;i(!0);const p=lr(vn,[X("is_album","==",!0)],n),g=await Dn(p);e(g),l("Result")}catch(p){console.log({message:p}),c()}finally{i(!1)}},d=async()=>{try{i(!0);const m=ue(vn,X("is_album","==",!0),Ot("created_at","desc")),p=await Dn(m);e(p)}catch(m){console.log({message:m}),c()}finally{i(!1)}};return h.useEffect(()=>{o==="All"&&d()},[o]),{isFetching:s,value:n,setValue:r,handleSubmit:u,albums:t,tab:o,setTab:l,tabs:ZX,setAlbums:e}}function tY(){const{isFetching:t,albums:e,tab:n,tabs:r,setTab:s,setAlbums:i,...o}=eY();return a.jsxs(a.Fragment,{children:[a.jsx(Z,{title:"Albums"}),a.jsxs("div",{className:"flex justify-between mt-3",children:[a.jsx(mo,{loading:n==="Result"&&t,...o}),a.jsx(JX,{setAlbums:i})]}),a.jsx("div",{className:"mt-5 w-fit  self-start",children:a.jsx(tr,{disable:n==="All",tabs:r,render:l=>l,tab:n,setTab:s})}),a.jsxs("div",{className:"mt-3",children:[t&&a.jsx(ye,{className:"h-[200px] rounded-xl"}),!t&&a.jsx(os,{colList:["Name","Singer","Like"],children:e.length?e.map((l,c)=>a.jsxs("tr",{children:[a.jsx("td",{children:a.jsx(Y,{className:"hover:underline",to:`/dashboard/album/${l.id}`,children:l.name})}),a.jsx("td",{children:a.jsx(Y,{to:`/dashboard/singer/${l.singers[0].id}`,children:l.singers[0].name})}),a.jsx("td",{children:rs(l.like)})]},c)):a.jsx("tr",{children:a.jsx("td",{colSpan:4,children:a.jsx(Ce,{})})})})]})]})}function cA(){const{setErrorToast:t}=te(),{setCategoryPage:e,shouldFetch:n,setHomePage:r,setCategories:s}=En(),[i,o]=h.useState(!0),l=h.useRef(!1),c=async()=>{try{if(o(!0),n.current)n.current=!1;else{await xr(100);return}const u={category_ids:"",category_sections:[],playlist_sections:[],updated_at:st()};let d={...u},m={...u},p=[];const g=it(oe,"Page_Config","category"),x=it(oe,"Page_Config","home"),[w,v]=await Promise.all([Gt({collectionName:"Page_Config",id:"category",msg:"Get category config"}),Gt({collectionName:"Page_Config",id:"home",msg:"Get home config"})]),S=await bt(ue(St(oe,"Categories")));w.exists()?d=w.data():await Nx(g,d),v.exists()?m=v.data():await Nx(x,m),S.empty||(p=S.docs.map(_=>({..._.data(),id:_.id}))),s(p),e(d),r(m)}catch(u){console.log(u),t()}finally{o(!1)}};return h.useEffect(()=>{l.current||(l.current=!1,c())},[]),{isFetching:i}}function nY({closeModal:t,choose:e}){const{categories:n}=En();return a.jsx(a.Fragment,{children:a.jsxs(ve,{children:[a.jsx(Be,{title:"Category",closeModal:t}),a.jsx("div",{className:"h-[40vh] mt-3 space-y-1.5 overflow-auto",children:n.length?n.map((r,s)=>a.jsx($t,{onClick:()=>e(r),children:a.jsx("p",{className:"text-lg",children:r.name})},s)):a.jsx(Ce,{})})]})})}function uA(t){const e=location.hash.includes("homepage")?"home":"category",{categoryPage:n,homePage:r,setCategoryPage:s,setHomePage:i,categorySliders:o,homeSliders:l}=En(),{setErrorToast:c,setSuccessToast:u}=te(),[d,m]=h.useState(!1),p=e==="home"?r:n,g=e==="home"?i:s,x=e==="home"?l:o,w=async S=>{if(!p)return;const _={...p};_.category_ids=S.map(E=>E.id).join("_"),await je({collectionName:"Page_Config",data:_,id:e}),g(_)};return{isFetching:d,action:async S=>{var _;try{if(!p)return;switch(console.log(e),m(!0),S.variant){case"add-category":{const E=[...x,...S.categories];w(E),u("Add category successful");break}case"remove-category":{const E=x.filter(I=>I.id!==S.id);w(E),u("Remove category successful");break}case"arrange":{const E={...p};E.category_ids=S.order.join("_"),await je({collectionName:"Page_Config",data:E,id:e}),g(E);break}}(_=t==null?void 0:t.modalRef.current)==null||_.close()}catch(E){console.log(E),c()}finally{m(!1)}}}}function rY({orderedCategories:t}){const[e,n]=h.useState(""),r=h.useRef(null),{action:s,isFetching:i}=uA({modalRef:r}),o=c=>{var u;n(c),(u=r.current)==null||u.open()},l=()=>{var c;return(c=r.current)==null?void 0:c.close()};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex space-x-2 justify-center mt-3",children:[a.jsxs(q,{onClick:()=>o("add"),children:[a.jsx(Nt,{className:"w-6"}),a.jsx("span",{children:"Add"})]}),a.jsxs(q,{onClick:()=>o("arrange"),disabled:t.length<2,children:[a.jsx(Ie,{className:"w-6"}),a.jsx("span",{children:"Arrange"})]})]}),a.jsxs(re,{variant:"animation",ref:r,children:[e==="add"&&a.jsx(nY,{choose:c=>s({variant:"add-category",categories:[c]}),closeModal:l}),e==="arrange"&&a.jsx(lp,{closeModal:l,isLoading:i,data:t.map(c=>({id:c.id,label:c.name})),submit:c=>s({variant:"arrange",order:c})})]})]})}function sY({category:t}){const[e,n]=h.useState(""),r=h.useRef(null),{action:s,isFetching:i}=uA({modalRef:r}),o=c=>{var u;n(c),(u=r.current)==null||u.open()},l=()=>{var c;return(c=r.current)==null?void 0:c.close()};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("div",{className:"aspect-[16/4]",children:a.jsx(Ae,{src:t.banner_image_url,blurHashEncode:t.banner_blurhash_encode,className:"rounded-md h-full object-cover"})}),a.jsxs(ks,{margin:!1,className:"w-fit mx-auto mt-2",children:[a.jsx(Y,{to:`/dashboard/category/${t.id}`,className:"hover:underline",children:t.name}),a.jsx("div",{children:a.jsx("button",{onClick:()=>o("delete"),children:a.jsx(ut,{className:"w-5"})})})]})]}),a.jsx(re,{variant:"animation",ref:r,children:e==="delete"&&a.jsx(an,{callback:()=>s({variant:"remove-category",id:t.id}),closeModal:l,loading:i,label:`Remove category '${t.name}'`})})]})}function dA(){const{categorySliders:t,homeSliders:e}=En(),r=(location.hash.includes("homepage")?"home":"category")==="home"?e:t;return a.jsxs(a.Fragment,{children:[a.jsx(Z,{title:"Slider",variant:"h2",className:"mb-3"}),a.jsxs($t,{children:[a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:r.length?r.map((s,i)=>a.jsx(sY,{category:s},i)):""}),a.jsx("div",{className:"mt-3",children:a.jsx(rY,{orderedCategories:r})})]})]})}function l1(t){const{categoryPage:e,homePage:n,setHomePage:r,setCategoryPage:s,setCategories:i}=En(),{setErrorToast:o,setSuccessToast:l}=te(),[c,u]=h.useState(!1),d=location.hash.includes("homepage")?"home":"category",m=d==="home"?n:e,p=d==="home"?r:s;return{isFetching:c,action:async x=>{var w;try{if(!m)return;switch(u(!0),x.type){case"add-section":{const v={...m};switch(x.variant){case"category":v.category_sections.push(x.section);break;case"playlist":v.playlist_sections.push(x.section);break}await je({collectionName:"Page_Config",data:v,id:d}),u(!1),p(v),l("Add section successful");break}case"edit-section":{const{index:v,section:S}=x,_={...m};switch(x.variant){case"category":Object.assign(_.category_sections[v],S);break;case"playlist":Object.assign(_.playlist_sections[v],S);break}await je({collectionName:"Page_Config",data:_,id:d}),u(!1),p(_),l("Update section successful");break}case"delete":{const v=fi(oe),S={...m};switch(x.variant){case"category":const _=S.category_sections[x.index].target_ids;_&&_.split("_").forEach(E=>v.delete(it(oe,"Categories",E))),S.category_sections.splice(x.index,1);break;case"playlist":S.playlist_sections.splice(x.index,1);break}v.update(it(oe,"Page_Config",d),S),await v.commit(),l("Delete section successful");break}case"add-category":{const{category:v,sectionIndex:S}=x,_={...m},E={..._.category_sections[S]};E.target_ids=E.target_ids?E.target_ids+`_${v.id}`:v.id,Object.assign(_.category_sections[S],E),await je({collectionName:"Page_Config",data:_,id:d}),i(I=>[...I,v]),p(_),l("Add new category successful")}}(w=t==null?void 0:t.modalRef.current)==null||w.close()}catch(v){console.log(v),o()}finally{u(!1)}}}}function hA(){const t=location.hash.includes("homepage")?"home":"category",[e,n]=h.useState(""),r=h.useRef(null),{action:s,isFetching:i}=l1({modalRef:r}),o=l=>{var c;n(l),(c=r.current)==null||c.open()};return a.jsxs(a.Fragment,{children:[a.jsxs(Ln,{children:[a.jsx(On,{children:a.jsxs(q,{size:"clear",className:"p-1.5",children:[a.jsx(Nt,{className:"w-6"}),a.jsx("span",{children:"Add new section"})]})}),a.jsx($n,{className:"top-[calc(100%+8px)]",children:a.jsx(er,{className:"w-[140px]",children:a.jsxs(Or,{children:[t==="category"&&a.jsxs("button",{onClick:()=>o("category"),children:[a.jsx(wm,{}),a.jsx("span",{children:"Category"})]}),a.jsxs("button",{onClick:()=>o("playlist"),children:[a.jsx(Xk,{}),a.jsx("span",{children:"Playlist"})]})]})})})]}),a.jsx(re,{variant:"animation",ref:r,children:e&&a.jsx(rT,{loading:i,cbWhenSubmit:l=>s({type:"add-section",variant:e,section:lH(l)}),closeModal:()=>{var l;return(l=r.current)==null?void 0:l.close()},title:e==="category"?"Add category section":"Add playlist section"})})]})}function iY(){const[t,e]=h.useState([]);return{playlists:t,setPlaylists:e}}const fA=h.createContext(null);function aY({children:t}){return a.jsx(fA.Provider,{value:iY(),children:t})}const mA=()=>{const t=h.useContext(fA);if(!t)throw new Error("PlaylistSectionProvider is not provided");return t};function pA(t){const{categoryPage:e,setCategoryPage:n,homePage:r,setHomePage:s}=En(),{setErrorToast:i,setSuccessToast:o}=te(),{playlists:l,setPlaylists:c}=mA(),[u,d]=h.useState(!1),m=location.hash.includes("homepage")?"home":"category",p=m==="home"?r:e,g=m==="home"?s:n,x=async(v,S)=>{if(!p)return;const _={...p},E={target_ids:v.map(I=>I.id).join("_")};Object.assign(_.playlist_sections[S],E),await je({collectionName:"Page_Config",data:_,id:m}),c(v),g(_)};return{isFetching:u,action:async v=>{var S;try{if(!p)return;switch(d(!0),v.variant){case"add-playlist":{const _=[...l,...v.playlists];x(_,v.sectionIndex),o("Add playlist successful");break}case"remove-playlist":{const _=l.filter(E=>E.id!==v.id);x(_,v.sectionIndex),o("Remove playlist successful");break}case"arrange-playlist":{const _={...p};Object.assign(_.playlist_sections[v.sectionIndex],v.section),await je({collectionName:"Page_Config",data:_,id:m}),g(_);break}}(S=t==null?void 0:t.modalRef.current)==null||S.close()}catch(_){console.log(_),i()}finally{d(!1)}}}}function oY({playlist:t,sectionIndex:e}){const[n,r]=h.useState(""),s=h.useRef(null),{action:i,isFetching:o}=pA({modalRef:s}),l=u=>{var d;r(u),(d=s.current)==null||d.open()},c=()=>{var u;return(u=s.current)==null?void 0:u.close()};return a.jsxs(a.Fragment,{children:[a.jsxs(ks,{children:[a.jsx(Y,{to:`/dashboard/playlist/${t.id}`,className:"hover:underline",children:t.name}),a.jsx("div",{children:a.jsx("button",{onClick:()=>l("delete"),children:a.jsx(ut,{className:"w-5"})})})]}),a.jsx(re,{variant:"animation",ref:s,children:n==="delete"&&a.jsx(an,{callback:()=>i({variant:"remove-playlist",id:t.id,sectionIndex:e}),closeModal:c,loading:o,label:`Remove playlist '${t.name}'`})})]})}const lY=()=>{const[t,e]=h.useState(!1),[n,r]=h.useState(!1),[s,i]=h.useState([]);return{isChecked:t,setIsChecked:e,isSelectAll:n,setIsSelectAll:r,setSelectedPlaylists:i,selectedPlaylists:s,selectAllPlaylist:u=>{e(!0),r(!0),i(u)},selectPlaylist:u=>{const d=[...s],m=d.findIndex(p=>p.id===u.id);m===-1?d.push(u):d.splice(m,1),e(!!d.length),i(d)},resetSelect:()=>{e(!1),r(!1),i([])}}},gA=h.createContext(null);function cY({children:t}){return a.jsx(gA.Provider,{value:lY(),children:t})}const uY=()=>{const t=h.useContext(gA);if(!t)throw new Error("PlaylistSelectProvider not provided");return t},dY=["Newest","Result"];function hY(){const{setErrorToast:t}=te(),{playlists:e,setPlaylists:n,setHasMore:r,shouldGetPlaylists:s,PAGE_SIZE:i,lastDoc:o}=sd(),[l,c]=h.useState([]),[u,d]=h.useState(""),[m,p]=h.useState(""),[g,x]=h.useState(!1),[w,v]=h.useState("Newest"),S=async()=>{try{x(!0),r(N=>o.current&&!N?(o.current=void 0,!N):N);const E=ue(vn,X("is_official","==",!0),X("is_album","==",!1),Ot("updated_at","desc"),Mt(i)),I=await Dn(E);n(I)}catch(E){console.log(E)}finally{x(!1)}},_=async E=>{try{E.preventDefault(),x(!0),v("Result");const I=lr(vn,[X("is_official","==",!0)],u),N=await Dn(I);c(N),p(u)}catch(I){console.log({message:I}),t()}finally{x(!1)}};return h.useEffect(()=>{s.current&&(s.current=!1,S())},[]),{isFetching:g,value:u,playlists:e,result:l,setValue:d,lastSubmit:m,handleSubmit:_,getNewestPlaylists:S,tabs:dY,tab:w,setTab:v}}function fY({closeModal:t,submit:e,isLoading:n,current:r}){const{user:s}=pe(),i=h.useRef(null),{playlists:o,isFetching:l,getNewestPlaylists:c,result:u,lastSubmit:d,tabs:m,setTab:p,tab:g,...x}=hY(),{selectedPlaylists:w,selectPlaylist:v}=uY(),{addPlaylist:S,isFetching:_}=sp(),E=async()=>{w.length&&(e(w),t())},I=async(j,C)=>{var A;j.is_official=!0;const R=await S({variant:"add",playlist:j,imageFile:C},{push:!1});R&&e([R]),(A=i.current)==null||A.close(),t()},N=h.useMemo(()=>{const j=w.map(C=>C.id);return u.filter(C=>!j.includes(C.id))},[u,w]),F={col:"md:w-1/2 flex-1 flex flex-col px-2 overflow-hidden",box:"rounded-lg bg-black/5 p-2",boxItem:"w-full px-3 py-1.5 text-left hover:bg-[--a-5-cl] rounded-md text-sm"},k=j=>j.length?j.map((C,R)=>{const A=r.includes(C.id);return a.jsx("button",{onClick:()=>!A&&v(C),className:`${F.boxItem} ${A||w.includes(C)?"text-[--primary-cl]":""} `,children:C.name},R)}):a.jsx(Ce,{variant:"less"});return a.jsxs(a.Fragment,{children:[a.jsxs(ve,{className:"w-[600px] h-[500px]",children:[a.jsx(Be,{closeModal:t,title:"Add playlists"}),a.jsx(mo,{className:"w-fit",...x}),a.jsxs("div",{className:"flex-grow flex flex-col md:flex-row -mx-2 overflow-hidden mt-3",children:[a.jsxs("div",{className:`${F.col}`,children:[a.jsx(tr,{className:"w-fit mb-1",buttonClasses:"[&_button]:px-3 [&_button]:py-1/2",tabs:m,setTab:p,disable:g==="Newest",tab:g,render:j=>j}),a.jsxs("div",{className:`${F.box} relative flex-grow overflow-auto`,children:[l?a.jsx(Un,{className:"h-full"}):a.jsx(a.Fragment,{children:g==="Result"?k(N):a.jsxs(a.Fragment,{children:[k(o),a.jsx("p",{className:"mt-3 text-center",children:a.jsx(q,{onClick:c,size:"clear",className:"p-1",children:a.jsx(Ie,{className:"w-5"})})})]})}),!l&&d&&x.value==d&&!N.length&&a.jsx("p",{className:"mt-3 text-center",children:a.jsxs(q,{onClick:()=>{var j;return(j=i.current)==null?void 0:j.open()},children:[a.jsx(Nt,{className:"w-6"}),a.jsx("span",{children:"Add new playlist"})]})})]})]}),a.jsxs("div",{className:`${F.col} mt-3 md:mt-0`,children:[a.jsx("p",{className:"font-bold mb-1 h-[36px]",children:"Selected"}),a.jsx("div",{className:`${F.box} flex-grow overflow-auto`,children:k(w)})]})]}),a.jsx("p",{className:"text-right mt-3 flex-shrink-0",children:a.jsxs(q,{disabled:!w.length,loading:n,onClick:E,children:[a.jsx(oa,{className:"w-6"}),a.jsx("span",{children:"Add"})]})}),n&&a.jsx(pi,{})]}),a.jsx(re,{variant:"animation",ref:i,children:a.jsx(ve,{className:"w-[650px]",children:a.jsx(ql,{modalRef:i,isLoading:_,variant:"add",submit:I,user:s,name:x.value})})})]})}function xA(t){return a.jsx(cY,{children:a.jsx(fY,{...t})})}function mY({sectionIndex:t,orderedPlaylists:e}){const[n,r]=h.useState(""),s=h.useRef(null),{action:i,isFetching:o}=pA({modalRef:s}),l=c=>{var u;r(c),(u=s.current)==null||u.open()};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex space-x-2 justify-center mt-3",children:[a.jsxs(q,{onClick:()=>l("add"),children:[a.jsx(Nt,{className:"w-6"}),a.jsx("span",{children:"Add playlist "})]}),a.jsxs(q,{onClick:()=>l("arrange"),disabled:e.length<2,children:[a.jsx(Ie,{className:"w-6"}),a.jsx("span",{children:"Arrange"})]})]}),a.jsxs(re,{variant:"animation",ref:s,children:[n==="add"&&a.jsx(xA,{current:e.map(c=>c.id),closeModal:()=>{var c;return(c=s.current)==null?void 0:c.close()},isLoading:o,submit:c=>i({variant:"add-playlist",playlists:c,sectionIndex:t})}),n==="arrange"&&a.jsx(lp,{closeModal:()=>{var c;return(c=s.current)==null?void 0:c.close()},isLoading:o,data:e.map(c=>({id:c.id,label:c.name})),submit:c=>i({variant:"arrange-playlist",section:{target_ids:c.join("_")},sectionIndex:t})})]})]})}function yA({name:t,index:e,variant:n,section:r}){const[s,i]=h.useState(""),o=h.useRef(null),{action:l,isFetching:c}=l1({modalRef:o}),u=m=>{var p;i(m),(p=o.current)==null||p.open()},d=()=>{var m;return(m=o.current)==null?void 0:m.close()};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex space-x-2 ml-4",children:[a.jsx(q,{onClick:()=>u("edit"),className:"p-1",size:"clear",children:a.jsx(Dr,{className:"w-6"})}),a.jsx(q,{onClick:()=>u("delete"),className:"p-1",size:"clear",children:a.jsx(ut,{className:"w-6"})})]}),a.jsxs(re,{variant:"animation",ref:o,children:[s==="edit"&&a.jsx(rT,{initValue:t,loading:c,cbWhenSubmit:m=>l({type:"edit-section",section:{name:m},index:e,variant:n}),closeModal:d,title:n==="category"?"Edit category section":"Edit playlist section"}),s==="delete"&&a.jsx(an,{callback:()=>l({type:"delete",index:e,variant:n}),closeModal:d,loading:c,label:`Delete section '${r.name}'`})]})]})}function pY({section:t,index:e}){const{categoryPage:n}=En(),{playlists:r,setPlaylists:s}=mA(),i=h.useMemo(()=>{const l=[];return(t.target_ids?t.target_ids.split("_"):[]).forEach(u=>{const d=r.find(m=>m.id===u);d&&l.push(d)}),l},[n,r]),{isFetching:o}=Fw({setPlaylists:s,playlistIds:t.target_ids?t.target_ids.split("_"):[]});return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx(Z,{variant:"h2",title:t.name}),a.jsx(yA,{section:t,index:e,name:t.name,variant:"playlist"})]}),a.jsxs($t,{children:[o&&a.jsx(Un,{}),!o&&a.jsxs(a.Fragment,{children:[!!i.length&&a.jsx("div",{className:"flex flex-wrap -mt-2 -mx-2",children:i.map((l,c)=>a.jsx(oY,{playlist:l,sectionIndex:e},c))}),a.jsx(mY,{sectionIndex:e,orderedPlaylists:i})]})]})]})}function vA(t){return a.jsx(aY,{children:a.jsx(pY,{...t})})}function gY(){const{homePage:t}=En(),{isFetching:e}=cA();return e?a.jsx(Ve,{children:a.jsx(Un,{})}):a.jsx(a.Fragment,{children:a.jsxs("div",{className:"space-y-5",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx(Z,{title:"Home Page"}),a.jsx(hA,{})]}),a.jsx(dA,{}),t==null?void 0:t.playlist_sections.map((n,r)=>a.jsx(vA,{section:n,index:r},r))]})})}function xY(t){const[e,n]=h.useState(),[r,s]=h.useState(),i=h.useRef(null),o=m=>{e&&n({...e,...m})},l=h.useMemo(()=>t.variant==="add"?!0:!t.category||!e?!1:e.name!==t.category.name,[e]),c=!!r,u=h.useMemo(()=>{const m=!!(e!=null&&e.name)&&l;return t.variant==="add"?m:m||c},[c,l,e]),d=()=>{switch(t.variant){case"add":return b2({});case"edit":const{id:m,updated_at:p,...g}=t.category;return b2(g)}};return h.useEffect(()=>{var m;t.variant==="add"&&((m=i.current)==null||m.focus()),n(d())},[]),h.useEffect(()=>{r&&o({image_url:URL.createObjectURL(r)})},[r]),h.useEffect(()=>{var m,p,g,x;l?(p=(m=t==null?void 0:t.modalRef)==null?void 0:m.current)==null||p.setModalPersist(!0):(x=(g=t==null?void 0:t.modalRef)==null?void 0:g.current)==null||x.setModalPersist(!1)},[l]),{categoryData:e,imageFile:r,setImageFile:s,updateData:o,setCategoryData:n,inputRef:i,isValidToSubmit:u,isChanged:l,isChangeImage:c}}function c1({isLoading:t,submit:e,...n}){const{imageFile:r,setImageFile:s,categoryData:i,updateData:o,isChanged:l,isChangeImage:c,inputRef:u,isValidToSubmit:d}=xY(n),m=h.useRef(null),p=async()=>{i&&(!l&&!c||e(i,r))};if(i)return a.jsxs(a.Fragment,{children:[a.jsxs(ve,{className:"w-[500px]",children:[a.jsx(Be,{closeModal:()=>{var g,x;return(x=(g=n.modalRef)==null?void 0:g.current)==null?void 0:x.close()},title:n.variant==="add"?"Add category":"Edit category"}),a.jsxs("div",{className:"md:flex md:space-x-3",children:[a.jsxs("div",{className:"space-y-2.5",children:[a.jsx("div",{className:"w-[200px] aspect-[5/3] rounded-lg overflow-hidden",children:a.jsx(Ae,{className:"object-cover object-center h-full",blurHashEncode:i.blurhash_encode,src:i.image_url})}),a.jsxs(q,{onClick:()=>{var g;return(g=m.current)==null?void 0:g.open()},children:[a.jsx(ui,{className:"w-6"}),a.jsx("span",{children:"Change image"})]})]}),a.jsx("div",{className:"mt-3 md:mt-0 flex-grow flex flex-col space-y-2.5",children:a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Lt,{htmlFor:"name",children:"Name"}),a.jsx(_n,{id:"name",ref:u,type:"text",placeholder:"name...",value:i.name,onChange:g=>o({name:g.target.value})})]})})]}),a.jsx("p",{className:"text-right mt-5 md:mt-0",children:a.jsx(q,{loading:t,onClick:p,disabled:!d,children:"Save"})}),t&&a.jsx(pi,{})]}),a.jsx(re,{variant:"animation",ref:m,children:a.jsx(Hl,{modalRef:m,setImageFile:s,title:"Category iamge"})})]})}function wA(t){const{setErrorToast:e}=te(),[n,r]=h.useState(!1),s=(t==null?void 0:t.setIsFetching)||r;return{addCategory:async({imageFile:o,...l})=>{try{if(s(!0),o){l.category.image_file_id&&Dt({fileId:l.category.image_file_id});const c=await mi({imageFile:o,width:870,height:490});Object.assign(l.category,c)}switch(l.variant){case"add":const c=await Is({collectionName:"Categories",data:l.category});return{...l.category,id:c.id};case"edit":return await je({collectionName:"Categories",data:l.category,id:l.id}),!0}}catch(c){console.log(c),e()}finally{r(!1)}},isFetching:n}}function yY({sectionIndex:t,orderedCategories:e}){const n=h.useRef(null),{action:r,isFetching:s}=l1({modalRef:n}),{isFetching:i,addCategory:o}=wA(),[l,c]=h.useState(""),u=m=>{var p;c(m),(p=n.current)==null||p.open()},d=async(m,p)=>{var x;const g=await o({variant:"add",category:m,imageFile:p});g&&r({type:"add-category",category:g,sectionIndex:t}),(x=n.current)==null||x.close()};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex space-x-2 justify-center mt-3",children:[a.jsxs(q,{onClick:()=>u("add"),children:[a.jsx(Nt,{className:"w-6"}),a.jsx("span",{children:"Add new category"})]}),a.jsxs(q,{onClick:()=>u("arrange"),disabled:e.length<2,children:[a.jsx(Ie,{className:"w-6"}),a.jsx("span",{children:"Arrange"})]})]}),a.jsxs(re,{variant:"animation",ref:n,children:[l==="add"&&a.jsx(c1,{modalRef:n,isLoading:s||i,variant:"add",submit:d}),l==="arrange"&&a.jsx(lp,{closeModal:()=>{var m;return(m=n.current)==null?void 0:m.close()},data:e.map(m=>({id:m.id,label:m.name})),isLoading:s,submit:m=>r({variant:"category",type:"edit-section",section:{target_ids:m.join("_")},index:t})})]})]})}function vY(t){const{categories:e,setCategories:n}=En(),{setErrorToast:r,setSuccessToast:s}=te(),[i,o]=h.useState(!1);return{isFetching:i,action:async c=>{var u;try{switch(o(!0),c.type){case"edit":{await je({collectionName:"Categories",data:c.category,id:c.id});const d=[...e],m=d.findIndex(g=>g.id===c.id),p={...e[m]};Object.assign(p,c.category),d[m]=p,n(d),s("Edit category successful");break}case"delete":break}(u=t==null?void 0:t.modalRef.current)==null||u.close()}catch(d){console.log(d),r()}finally{o(!1)}}}}function wY({category:t}){const[e,n]=h.useState(""),r=h.useRef(null),{action:s,isFetching:i}=vY({modalRef:r}),o=l=>{var c;n(l),(c=r.current)==null||c.open()};return a.jsxs(a.Fragment,{children:[a.jsxs(ks,{children:[a.jsx(Y,{to:`/dashboard/category/${t.id}`,className:"hover:underline",children:t.name}),a.jsx("div",{children:a.jsx("button",{className:"",onClick:()=>o("edit"),children:a.jsx(Dr,{className:"w-5"})})})]}),a.jsx(re,{variant:"animation",ref:r,children:e==="edit"&&a.jsx(c1,{variant:"edit",category:t,modalRef:r,isLoading:i,submit:l=>s({type:"edit",category:l,id:t.id})})})]})}function _Y({section:t,index:e}){const{categoryPage:n,categories:r}=En(),s=h.useMemo(()=>{const i=[];return(t.target_ids?t.target_ids.split("_"):[]).forEach(l=>{const c=r.find(u=>u.id===l);c&&i.push(c)}),i},[n,r]);return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx("h1",{children:t.name}),a.jsx(yA,{section:t,index:e,name:t.name,variant:"category"})]}),a.jsxs($t,{children:[a.jsx("div",{className:"flex flex-wrap -mt-2 -mx-2",children:s.map((i,o)=>a.jsx(wY,{category:i},o))}),a.jsx(yY,{orderedCategories:s,sectionIndex:e})]})]})}function SY(){const{categoryPage:t}=En(),{isFetching:e}=cA();return e?a.jsx(Ve,{children:a.jsx(Un,{})}):t?a.jsx(a.Fragment,{children:a.jsxs("div",{className:"space-y-5 [&_h1]:text-lg [&_h1]:font-bold [&_h1]:text-[#333] ",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(Z,{title:"Category"}),a.jsx(hA,{})]}),a.jsx(dA,{}),t.category_sections.map((n,r)=>a.jsx(_Y,{section:n,index:r},r)),t.playlist_sections.map((n,r)=>a.jsx(vA,{section:n,index:r},r))]})}):a.jsx(a.Fragment,{})}function bY(){return a.jsx(a.Fragment,{children:a.jsx(SY,{})})}function EY(){const[t,e]=h.useState(),[n,r]=h.useState([]),[s,i]=h.useState([]),o=h.useMemo(()=>t!=null&&t.playlist_ids?t.playlist_ids.split("_"):[],[t]),l=h.useMemo(()=>{const c=[];return o.forEach(u=>{const d=n.find(m=>m.id===u);d&&c.push(d)}),c},[o,n]);return{category:t,setCategory:e,playlists:n,setPlaylists:r,songs:s,setSongs:i,orderedPlaylists:l,playlistIds:o}}const _A=h.createContext(null);function jY({children:t}){return a.jsx(_A.Provider,{value:EY(),children:t})}const xo=()=>{const t=h.useContext(_A);if(!t)throw new Error("CategoryProvider is not provided");return t};function kY({closeModal:t}){const{category:e,setCategory:n}=xo(),{setErrorToast:r,setSuccessToast:s}=te(),[i,o]=h.useState(),[l,c]=h.useState(!1),u=async()=>{try{if(!i||!e)throw new Error;c(!0);const{image_url:m,image_file_id:p,blurhash_encode:g}=await mi({imageFile:i,height:400,width:1600}),x={banner_image_url:m,banner_file_id:p,banner_blurhash_encode:g};await je({collectionName:"Categories",id:e.id,data:x}),e.banner_file_id&&Dt({fileId:e.banner_file_id}),n(()=>({...e,...x})),s("Update banner successful"),t()}catch(m){console.log({error:m}),r()}finally{c(!1)}},d=h.useMemo(()=>i&&URL.createObjectURL(i)||(e==null?void 0:e.banner_image_url)||"",[i]);return{category:e,imageUrl:d,imageFile:i,setImageFile:o,isFetching:l,handleSubmit:u}}function TY({closeModal:t}){const{imageUrl:e,setImageFile:n,handleSubmit:r,isFetching:s}=kY({closeModal:t});Mw({setImageFileFromParent:n});const i=h.useRef(null);return a.jsxs(a.Fragment,{children:[a.jsxs(ve,{className:"w-[500px]",children:[a.jsx(Be,{closeModal:t,title:"Category banner"}),a.jsxs("div",{className:"overflow-auto",children:[a.jsx("div",{className:"aspect-[16/4]",children:a.jsx(Ae,{className:"h-full object-cover rounded-lg",src:e})}),a.jsx("p",{className:"mt-3",children:a.jsx(q,{className:"p-1",size:"clear",onClick:()=>{var o;return(o=i.current)==null?void 0:o.open()},children:a.jsx(ui,{className:"w-6"})})}),a.jsx("p",{className:"text-right mt-5",children:a.jsx(q,{loading:s,onClick:r,children:"Ok"})})]})]}),a.jsx(re,{variant:"animation",ref:i,children:a.jsx(Hl,{modalRef:i,setImageFile:n,title:"Category banner"})})]})}function hd(t){const{songs:e,setSongs:n,playlists:r,setPlaylists:s,orderedPlaylists:i,category:o,setCategory:l}=xo(),{categories:c,setCategories:u}=En(),{setErrorToast:d,setSuccessToast:m}=te(),[p,g]=h.useState(!1),x=Wt();return{isFetching:p,action:async v=>{var S;try{if(!o)return;switch(g(!0),v.variant){case"add-songs":{const _={...o},E=[...e,...v.songs],N={song_ids:E.map(F=>F.id).join("_"),updated_at:st()};await je({collectionName:"Categories",data:N,id:o.id}),Object.assign(_,N),l(_),n(E),m("Add song successful");break}case"add-playlists":{const _={...o},E=[...r,...v.playlists],N={playlist_ids:E.map(F=>F.id).join("_"),updated_at:st()};await je({collectionName:"Categories",data:N,id:o.id}),Object.assign(_,N),l(_),s(E),m("Add playlist successful");break}case"arrange-playlist":{const _={...o},E={...v.category,updated_at:st()};await je({collectionName:"Categories",data:E,id:o.id}),Object.assign(_,v.category),l(_),m("Category updated");break}case"remove-song":{const _={...o},E=[...e];E.splice(v.index,1);const N={song_ids:E.map(F=>F.id).join("_"),updated_at:st()};await je({collectionName:"Categories",data:N,id:o.id}),Object.assign(_,N),l(_),n(E),m("Category updated");break}case"remove-playlist":{const _={...o},E=[...i];E.splice(v.index,1);const N={playlist_ids:E.map(F=>F.id).join("_"),updated_at:st()};await je({collectionName:"Categories",data:N,id:o.id}),Object.assign(_,N),l(_),s(E),m("Category updated");break}case"delete":{if(!o)return;o.banner_file_id&&Dt({fileId:o.banner_file_id}),o.image_file_id&&Dt({fileId:o.image_file_id}),await kw({collectionName:"Categories",id:o.id});const _=c.filter(E=>E.id!==o.id);u(_),m("Category deleted"),x("/dashboard/category");break}}(S=t==null?void 0:t.modalRef.current)==null||S.close()}catch(_){console.log(_),d()}finally{g(!1)}}}}function IY(){const{categories:t,setCategories:e}=En(),{setSuccessToast:n}=te(),{category:r,setCategory:s}=xo(),[i,o]=h.useState(""),{addCategory:l,isFetching:c}=wA(),{action:u,isFetching:d}=hd(),m=v=>{var S;o(v),(S=g.current)==null||S.open()},p=()=>{var v;return(v=g.current)==null?void 0:v.close()},g=h.useRef(null),x=async(v,S)=>{if(!r)return;if(await l({variant:"edit",category:v,id:r.id,imageFile:S})){const E=[...t],I={...r};Object.assign(I,v);const N=E.findIndex(F=>F.id===r.id);N!==-1&&(Object.assign(E[N],v),e(E)),s(I),n("Category updated"),p()}},w=()=>{switch(i){case"":return a.jsx(a.Fragment,{});case"banner":return a.jsx(TY,{closeModal:p});case"edit":return r?a.jsx(a.Fragment,{children:a.jsx(c1,{submit:x,variant:"edit",isLoading:c,category:r,modalRef:g})}):"Playlist is undefined";case"delete":return a.jsx(an,{loading:d,label:"Delete playlist ?",callback:()=>u({variant:"delete"}),closeModal:p})}};return a.jsxs(a.Fragment,{children:[a.jsx("div",{children:a.jsxs(Vl,{className:"!-mt-4",children:[a.jsxs(q,{onClick:()=>m("edit"),size:"clear",children:[a.jsx(Dr,{}),a.jsx("span",{children:"Edit"})]}),a.jsxs(q,{onClick:()=>m("banner"),size:"clear",children:[a.jsx(ui,{}),a.jsx("span",{children:"Banner"})]}),a.jsxs(q,{onClick:()=>m("delete"),size:"clear",children:[a.jsx(ut,{}),a.jsx("span",{children:"Delete"})]})]})}),a.jsx(re,{variant:"animation",ref:g,children:w()})]})}function CY(){const{orderedPlaylists:t}=xo(),[e,n]=h.useState(""),r=h.useRef(null),{action:s,isFetching:i}=hd({modalRef:r}),o=l=>{var c;n(l),(c=r.current)==null||c.open()};return a.jsxs(a.Fragment,{children:[a.jsxs(Ln,{children:[a.jsx(On,{children:a.jsxs(q,{size:"clear",className:"p-1",children:[a.jsx(ao,{className:"w-6"}),a.jsx("span",{className:"hidden md:block",children:"Menu"})]})}),a.jsx($n,{className:"top-[calc(100%+8px)] right-0",children:a.jsx(er,{className:"w-[160px]",children:a.jsxs(Or,{children:[a.jsxs("button",{onClick:()=>o("add"),children:[a.jsx(Nt,{}),a.jsx("span",{children:"Add playlist"})]}),a.jsxs("button",{disabled:t.length<2,onClick:()=>o("arrange"),children:[a.jsx(Ie,{}),a.jsx("span",{children:"Arrange"})]})]})})})]}),a.jsxs(re,{variant:"animation",ref:r,children:[e==="add"&&a.jsx(xA,{current:t.map(l=>l.id),closeModal:()=>{var l;return(l=r.current)==null?void 0:l.close()},isLoading:i,submit:l=>s({variant:"add-playlists",playlists:l})}),e==="arrange"&&a.jsx(lp,{closeModal:()=>{var l;return(l=r.current)==null?void 0:l.close()},isLoading:i,data:t.map(l=>({id:l.id,label:l.name})),submit:l=>s({variant:"arrange-playlist",category:{playlist_ids:l.join("_")}})})]})]})}function RY(){const{setPlaylists:t,orderedPlaylists:e,playlistIds:n}=xo(),{isFetching:r}=Fw({setPlaylists:t,playlistIds:n}),s=h.useRef(null),{action:i,isFetching:o}=hd();return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h1",{className:"text-lg font-bold text-[#333]",children:"Playlists"}),a.jsx(CY,{})]}),r&&a.jsx(Un,{}),!r&&a.jsx(os,{colList:["Name","Like",""],children:e.length?e.map((l,c)=>a.jsxs("tr",{children:[a.jsx("td",{children:a.jsx(Y,{className:"hover:underline",to:`/dashboard/playlist/${l.id}`,children:l.name})}),a.jsx("td",{children:rs(l.like)}),a.jsxs("td",{className:"text-right",children:[a.jsx(q,{onClick:()=>{var u;return(u=s.current)==null?void 0:u.open()},size:"clear",className:"p-1",children:a.jsx(ut,{className:"w-5"})}),a.jsx(re,{variant:"animation",ref:s,children:a.jsx(an,{callback:()=>i({variant:"remove-playlist",playlist:l,index:c}),closeModal:()=>{var u;return(u=s.current)==null?void 0:u.close()},loading:o,label:`Remove playlist '${l.name}'`})})]})]},c)):a.jsx("tr",{children:a.jsx("td",{colSpan:4,children:a.jsx(Ce,{})})})})]})}function NY({songs:t}){const[e,n]=h.useState(""),r=h.useRef(null),{action:s,isFetching:i}=hd({modalRef:r}),o=l=>{var c;n(l),(c=r.current)==null||c.open()};return a.jsxs(a.Fragment,{children:[a.jsxs(Ln,{children:[a.jsx(On,{children:a.jsxs(q,{size:"clear",className:"p-1",children:[a.jsx(ao,{className:"w-6"}),a.jsx("span",{className:"hidden md:block",children:"Menu"})]})}),a.jsx($n,{className:"top-[calc(100%+8px)] right-0",children:a.jsx(er,{className:"w-[140px]",children:a.jsx(Or,{children:a.jsxs("button",{onClick:()=>o("add"),children:[a.jsx(Nt,{}),a.jsx("span",{children:"Add songs"})]})})})})]}),a.jsx(re,{variant:"animation",ref:r,children:e==="add"&&a.jsx(i1,{closeModal:()=>{var l;return(l=r.current)==null?void 0:l.close()},isLoading:i,submit:l=>s({variant:"add-songs",songs:l}),current:t.map(l=>l.id)})})]})}function AY(){const{setSongs:t,category:e,songs:n}=xo(),r=h.useRef(null),{action:s,isFetching:i}=hd(),o=h.useMemo(()=>e!=null&&e.song_ids?e.song_ids.split("_"):[],[e]),{isFetching:l}=LR({setSongs:t,songIds:o});return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h1",{className:"text-lg font-bold text-[#333]",children:"Songs"}),a.jsx(NY,{songs:n})]}),l&&a.jsx(Un,{}),!l&&a.jsx(os,{colList:["Name","Singers",""],children:n.length?n.map((c,u)=>a.jsxs("tr",{children:[a.jsx("td",{children:a.jsx(Y,{to:`/dashboard/song/${c.id}/edit`,className:"hover:underline",children:c.name})}),a.jsx("td",{children:c.singers.map((d,m)=>a.jsxs(Y,{className:"hover:underline",to:`/dashboard/singer/${d.id}`,children:[!!m&&", ",d.name]},m))}),a.jsxs("td",{className:"text-right",children:[a.jsx(q,{onClick:()=>{var d;return(d=r.current)==null?void 0:d.open()},size:"clear",className:"p-1",children:a.jsx(ut,{className:"w-5"})}),a.jsx(re,{variant:"animation",ref:r,children:a.jsx(an,{callback:()=>s({variant:"remove-song",song:c,index:u}),closeModal:()=>{var d;return(d=r.current)==null?void 0:d.close()},loading:i,label:`Remove song '${c.name}'`})})]})]},u)):a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"text-center",children:a.jsx(Ce,{})})})})]})}function PY(){const{category:t,setCategory:e}=xo(),{isFetching:n}=DR({setCategory:e}),r=h.useMemo(()=>t==null?void 0:t.updated_at,[t==null?void 0:t.id]);return n?a.jsx(ha,{}):t?a.jsxs(a.Fragment,{children:[a.jsx(Z,{title:"Category Detail"}),a.jsxs("div",{className:"md:flex md:-mx-3 mt-5",children:[a.jsxs("div",{className:"md:px-3 md:w-2/3",children:[a.jsx("div",{className:"aspect-[16/4] mt-5 md:mt-0",children:a.jsx(Ae,{className:"h-full object-cover rounded-lg",src:t.banner_image_url})}),a.jsx("div",{className:"w-[260px] aspect-[5/3] mt-3",children:a.jsx(Ae,{className:"object-cover h-full rounded-lg",blurHashEncode:t.blurhash_encode,src:t.image_url})}),a.jsxs("div",{className:"mt-5 space-y-3",children:[a.jsx("div",{className:"text-2xl font-bold text-[#333]",children:t.name}),a.jsx(IY,{}),a.jsxs("p",{className:"text-sm",children:["Last updated: ",jl(r)]})]})]}),a.jsxs("div",{className:"w-full mt-3 md:mt-0 md:px-3 space-y-3",children:[a.jsx(AY,{}),a.jsx(RY,{})]})]})]}):a.jsx(cv,{to:"/dashoboard/category"})}function FY(){return a.jsx(jY,{children:a.jsx(PY,{})})}function pE({children:t}){return a.jsx(HW,{children:t})}function MY(){const[t,e]=h.useState(),[n,r]=h.useState([]),[s,i]=h.useState();return{imageFile:s,setImageFile:i,album:t,setAlbum:e,updateAlbumData:l=>{t&&e({...t,...l})},songs:n,setSongs:r}}const SA=h.createContext(null);function DY({children:t}){return a.jsx(SA.Provider,{value:MY(),children:t})}const fd=()=>{const t=h.useContext(SA);if(!t)throw new Error("AlbumProvider not provided");return t};function LY(){const{setAlbum:t,setSongs:e}=fd(),[n,r]=h.useState(!0),s=h.useRef(!1),i=li(),o=Wt(),{setErrorToast:l}=te(),c=async()=>{try{if(!i.id)return;const u=await Gt({collectionName:"Playlists",id:i.id});if(!u.exists())return o("/dashboard/album");const d={...u.data(),id:u.id};if(!d.is_album)return o(`/dashboard/playlist/${d.id}`);if(d.song_ids.length){const m=ue(_t,X(Lr(),"in",d.song_ids)),p=await zt(m);e(p)}t(d)}catch(u){console.log(u),l()}finally{r(!1)}};return h.useEffect(()=>{s.current||(s.current=!0,c())},[]),{isFetching:n}}function bA(){const{resetSelect:t}=ho(),{setErrorToast:e,setSuccessToast:n}=te(),{album:r,songs:s,setSongs:i,updateAlbumData:o}=fd(),[l,c]=h.useState(!1),u=Wt();return{isFetching:l,action:async m=>{try{if(!r)throw new Error("album not found");switch(c(!0),m.variant){case"delete":{const p=fi(oe),g=it(oe,"Playlists",r.id),x=await bt(ue(Xa,X("target_id","==",r.id)));p.delete(g),x.empty||(console.log(`Delete ${x.docs.length} comments`),x.forEach(w=>p.delete(w.ref))),await Promise.all([p.commit(),r.image_file_id?Dt({fileId:r.image_file_id}):()=>{}]),n("Delete album sucessful"),u("/dashboard/album");break}case"add-songs":{const p=[...s,...m.songs],x={song_ids:p.map(w=>w.id)};await je({collectionName:"Playlists",id:r.id,data:x,msg:">>> api: update album doc"}),o(x),i(p),n("Songs added");break}case"remove-songs":{const p=m.songs.map(w=>w.id),g=s.filter(w=>!p.includes(w.id)),x={song_ids:g.map(w=>w.id)};await je({collectionName:"Playlists",id:r.id,data:x,msg:">>> api: update album doc"}),i(g),n(`${m.songs.length} ${m.songs.length>1?"songs":"song"}  removed`),t();break}}}catch(p){console.log({message:p}),e("")}finally{c(!1)}}}}function OY(){const{album:t,songs:e,updateAlbumData:n}=fd(),[r,s]=h.useState(""),i=h.useRef(null),{isFetching:o,action:l}=bA(),c=p=>{var g;s(p),(g=i.current)==null||g.open()},u=()=>{var p;(p=i.current)==null||p.close()},d=async p=>{await l(p),u()},m=()=>{switch(r){case"":return a.jsx(a.Fragment,{});case"edit":return t?a.jsx(a.Fragment,{children:a.jsx(ve,{className:"w-[600px]",children:a.jsx(o1,{modalRef:i,variant:"edit",afterSubmit:p=>{n(p)},album:t})})}):"Playlist is undefined";case"delete":return a.jsx(an,{loading:o,label:"Delete playlist ?",callback:()=>d({variant:"delete"}),closeModal:u});case"add-songs":return a.jsx(i1,{isLoading:o,submit:p=>d({variant:"add-songs",songs:p}),closeModal:u,current:e.map(p=>p.id)})}};return a.jsxs(a.Fragment,{children:[a.jsx("div",{children:a.jsxs(Vl,{children:[a.jsxs(q,{onClick:()=>c("edit"),size:"clear",children:[a.jsx(Dr,{}),a.jsx("span",{children:"Edit"})]}),a.jsxs(q,{onClick:()=>c("delete"),size:"clear",children:[a.jsx(ut,{}),a.jsx("span",{children:"Delete"})]}),a.jsxs(q,{onClick:()=>c("add-songs"),size:"clear",children:[a.jsx(Nt,{}),a.jsx("span",{children:"Add song"})]})]})}),a.jsx(re,{ref:i,variant:"animation",children:m()})]})}function $Y(){const{songs:t}=fd(),{selectedSongs:e,selectSong:n}=ho(),{action:r,isFetching:s}=bA(),i=h.useRef(null),o=async()=>{var l;await r({variant:"remove-songs",songs:e}),(l=i.current)==null||l.close()};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between items-center mb-3",children:[a.jsx(Z,{title:"Songs",variant:"h2"}),!!e.length&&a.jsx(q,{onClick:()=>{var l;return(l=i.current)==null?void 0:l.open()},className:"p-1",size:"clear",children:a.jsx(ut,{className:"w-5"})})]}),a.jsx(os,{colList:["Name","Singer","Genre",""],children:t.length?t.map((l,c)=>{var d;const u=e.find(m=>m.id===l.id);return a.jsxs("tr",{className:u?"bg-[--a-5-cl]":"",children:[a.jsx("td",{children:a.jsx(Y,{to:`/dashboard/song/${l.id}/edit`,className:"hover:underline",children:l.name})}),a.jsx("td",{children:l.singers.map((m,p)=>a.jsxs(Y,{className:"hover:underline",to:`/dashboard/singer/${m.id}`,children:[!!p&&", ",m.name]},p))}),a.jsx("td",{children:(d=l.main_genre)==null?void 0:d.name}),a.jsx("td",{children:a.jsx("button",{onClick:()=>n(l),children:u?a.jsx(Yu,{className:"w-5"}):a.jsx(vv,{className:"w-5"})})})]},c)}):a.jsx("tr",{children:a.jsx("td",{colSpan:4,children:a.jsx(Ce,{variant:"less"})})})})]}),a.jsx(re,{variant:"animation",ref:i,children:a.jsx(an,{callback:o,closeModal:()=>{var l;return(l=i.current)==null?void 0:l.close()},loading:s,label:"Remove selected songs ?"})})]})}function zY(){const{album:t,songs:e}=fd(),{isFetching:n}=LY(),r=h.useMemo(()=>t==null?void 0:t.updated_at,[t==null?void 0:t.id]);return n?a.jsx(Ve,{children:a.jsx(Ie,{className:"w-6 animate-spin"})}):t?a.jsxs(a.Fragment,{children:[a.jsx(Z,{title:"Edit album",className:"mb-3"}),a.jsxs("div",{className:"md:flex md:-mx-3",children:[a.jsxs("div",{className:"space-y-5 md:px-3",children:[a.jsx("div",{className:"w-[200px] h-[200px] mx-auto rounded-md overflow-hidden",children:a.jsx(Ae,{className:"object-cover h-full rounded-lg",blurHashEncode:t.blurhash_encode,src:t.image_url})}),a.jsxs(Tu,{className:"space-y-2",children:[a.jsxs("p",{children:[a.jsx("span",{children:"Public:"}),t.is_public?"Public":"Private"]}),a.jsxs("p",{children:[a.jsx("span",{children:"Song:"}),e.length]}),a.jsxs("p",{children:[a.jsx("span",{children:"Comments:"}),rs(t.comment)]}),a.jsx(op,{init:t.like,loading:!1,submit:()=>{}}),a.jsxs("p",{children:[a.jsx("span",{children:"Last update:"}),r?jl(r):""]})]}),a.jsx(OY,{})]}),a.jsxs("div",{className:"w-full mt-3 md:mt-0 md:w-3/4 md:px-3 space-y-5",children:[a.jsxs("div",{children:[a.jsx(Z,{title:"Info",variant:"h2",className:"mb-3"}),a.jsxs(Tu,{children:[a.jsxs("div",{children:[a.jsx("span",{children:"Name:"}),a.jsx(Z,{variant:"h1",title:t.name})]}),a.jsxs("div",{children:[a.jsx("span",{children:"Singer:"}),a.jsx(Z,{variant:"h2",title:t.singers[0].name})]})]})]}),a.jsx($Y,{})]})]})]}):a.jsx(a.Fragment,{})}function BY(){return a.jsx(DY,{children:a.jsx(jn,{children:a.jsx(zY,{})})})}function VY(){const[t,e]=h.useState([]),[n,r]=h.useState(999),[s,i]=h.useState(!1),o=h.useRef(!0);return{currentSong:h.useMemo(()=>t[n],[t,n]),songs:t,isPlaying:s,setIsPlaying:i,setSongs:e,currentIndex:n,setCurrentIndex:r,firstTimeSongLoaded:o}}const EA=h.createContext(null);function UY({children:t}){return a.jsx(EA.Provider,{value:VY(),children:t})}function fa(){const t=h.useContext(EA);if(!t)throw new Error("SongsContextProvider not provided");return t}function HY(){const{currentSong:t}=fa(),{setComments:e,isOpenComment:n,setIsFetching:r,shouldFetchComment:s}=zn(),{fetchComment:i}=ip({setIsFetchingFromParent:r}),o=async()=>{const l=await i({target_id:t.id});l&&e(l)};h.useEffect(()=>{!n||!t||s.current&&(s.current=!1,o())},[t,n]),h.useEffect(()=>()=>{s.current=!0,e([])},[t])}function GY(){const{user:t}=pe(),{currentSong:e}=fa(),{isOpenComment:n,setIsOpenComment:r}=zn();HY();const{comments:s,isFetching:i}=zn(),o=n?"semi-lg:right-0 block":"semi-lg:right-[-100%] hidden semi-lg:block",l={border:"border-black/20 dark:border-white/20"};return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:`${n?"fixed":""} semi-lg:hidden bg-black/60 inset-0 z-[90]`}),a.jsx("div",{className:`transition-[right] max-h-[80vh] sm:max-h-[unset] max-w-[90vw] duration-[.3s] z-[99] semi-lg:z-[0] absolute rounded-xl  left-1/2 top-1/2 translate-y-[-50%] translate-x-[-50%] semi-lg:left-[unset] semi-lg:top-0 semi-lg:transform-none semi-lg:h-full semi-lg:min-h-[360px] w-[400px] xl:w-[480px] semi-lg:p-4 top-0 ${o}`,children:a.jsxs("div",{className:`semi-lg:border text-white h-[400px] bg-[#333] p-5 semi-lg:p-3 semi-lg:h-full w-full rounded-xl flex flex-col ${l.border}`,children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(Z,{variant:"h2",title:"Comments"}),a.jsx(se,{onClick:()=>r(!1),className:"p-1.5 hover:bg-black/20",size:"clear",children:a.jsx(Zu,{className:"w-8"})})]}),a.jsx(Gw,{variant:"dark-bg",isFetching:i,comments:s,className:"pr-2"}),t&&e&&a.jsx(mp,{bg:"bg-white/10",variant:"comment",targetId:e.id})]})})]})}function WY(){const[t,e]=h.useState("idle"),[n,r]=h.useState(!1),[s,i]=h.useState([]),o=h.useRef(null),l=h.useRef("idle"),c=h.useRef(!0),u=h.useRef(!0);return{status:t,setStatus:e,statusRef:l,controlRef:o,canPlay:n,setCanPlay:r,lyrics:s,setLyrics:i,shouldGetLyric:c,shouldPlayAfterLoaded:u}}const jA=h.createContext(null);function qY({children:t}){return a.jsx(jA.Provider,{value:WY(),children:t})}function Kl(){const t=h.useContext(jA);if(!t)throw new Error("PlayerProvider not provided");return t}function KY({audioEle:t}){const{setStatus:e,shouldPlayAfterLoaded:n,canPlay:r}=Kl(),{firstTimeSongLoaded:s,currentSong:i}=fa(),o=()=>{e("loading")},l=()=>{if(s.current){s.current=!1,e("paused");return}n.current&&(n.current=!1,t==null||t.play())},c=()=>{e("error")};h.useEffect(()=>{r&&i&&(t.src=i.song_url)},[r]),h.useEffect(()=>(t.addEventListener("error",c),t.addEventListener("loadstart",o),t.addEventListener("loadedmetadata",l),()=>{t.removeEventListener("error",c),t.removeEventListener("loadstart",o),t.removeEventListener("loadedmetadata",l)}),[])}function QY({isLiked:t,song:e}){const{action:n,loading:r}=up();return a.jsx("button",{className:" ",onClick:()=>n({variant:"like",song:e}),children:r?a.jsx(Ie,{className:" animate-spin"}):a.jsx(Bl,{className:t?"text-[--primary-cl]":""})})}function XY({song:t}){const{setIsOpenComment:e}=zn(),{user:n}=pe();return a.jsxs("div",{className:`flex 
			space-x-2
			[&_button]:rounded-full
			[&_button]:p-2
			[&_svg]:w-6
			hover:[&_button]:bg-white/10
			[&_div]:flex-col
			[&_div]:flex
			[&_span]:text-center
			[&_span]:font-medium
		 `,children:[n&&a.jsx("div",{children:a.jsx(QY,{isLiked:n.liked_song_ids.includes(t.id),song:t})}),a.jsx("div",{children:a.jsx("button",{onClick:()=>e(!0),children:a.jsx(Z$,{})})})]})}function YY({audioEle:t,song:e}){const{status:n,controlRef:r,setStatus:s,statusRef:i}=Kl();KY({audioEle:t});const{pause:o,play:l,handlePlayPause:c,progressLineRef:u}=Jm({audioEle:t,setStatusFromParent:s,statusFromParent:n,statusRefFromParent:i,baseColor:"rgba(255,255,255,0.1)",color:"#fff"});h.useImperativeHandle(r,()=>({pause:o,play:l,handlePlayPause:c}));const d=()=>{switch(n){case"playing":return a.jsx(Ju,{});case"paused":return a.jsx(qa,{});case"error":return a.jsx(NC,{});case"loading":return a.jsx(Ie,{className:"animate-spin"});default:return a.jsx(la,{})}};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex",children:[a.jsx("button",{onClick:c,className:"[&_svg]:w-7",children:d()}),a.jsx("div",{className:"flex space-x-2 ml-auto",children:a.jsx(XY,{song:e})})]}),a.jsx("div",{className:"h-2 flex items-center mt-3",children:a.jsx(od,{bg:"rgba(255,255,255,0.1)",elelRef:u,className:`h-1 ${n==="idle"?"hidden":""}`})})]})}const uh=.3;function JY({audioEle:t,lyrics:e,isActive:n}){const[r,s]=h.useState(0),i=h.useRef(0),o=h.useRef(0),l=()=>{const c=t.currentTime>i.current?"forward":"backward";i.current=t.currentTime;let u=o.current;switch(c){case"forward":for(;e[u+1]&&e[u+1].start-uh<i.current+uh;)u+=1;break;case"backward":for(;e[u-1]&&e[u-1].end-uh>i.current+uh;)u-=1;break}u!==o.current&&(o.current=u,s(u))};return h.useEffect(()=>{if(!(!n||!e.length))return t.addEventListener("timeupdate",l),()=>{t.removeEventListener("timeupdate",l)}},[e,n]),{currentIndex:r}}function ZY(){const{canPlay:t,setLyrics:e,shouldGetLyric:n}=Kl(),{currentSong:r}=fa(),s=h.useRef(),{loading:i,getLyric:o}=FR({}),l=async()=>{if(r&&r.lyric_id){const c=await o(r);c&&e(JSON.parse(c==null?void 0:c.lyrics))}};return h.useEffect(()=>{t&&n.current&&(n.current=!1,s.current=setTimeout(l,500))},[t]),{isFetching:i}}function eJ({audioEle:t}){const{lyrics:e,canPlay:n}=Kl(),{isFetching:r}=ZY(),s=h.useRef(null),i=h.useRef(null),o=h.useRef(40),{currentIndex:l}=JY({audioEle:t,lyrics:e,isActive:n}),c=h.useMemo(()=>e[l]?a.jsxs(a.Fragment,{children:[a.jsx("p",{style:{transform:`translateY(calc(${o.current}px)`},className:"transition-transform origin-bottom-left duration-[.4s]",ref:s,children:e[l].text},l+"1"),e[l+1]&&a.jsx("p",{ref:i,className:"mt-3 transition-transform duration-[.4s] opacity-[.4] translate-y-[-10px]",children:e[l+1].text},l+"11")]}):a.jsx(a.Fragment,{}),[l,e]),u={container:"no-scrollbar leading-[1.1] [&_p]:w-[70%] [&_p]:select-none [&_p]:font-bold pt-3"};return h.useEffect(()=>{setTimeout(()=>{s.current&&(Object.assign(s.current.style,{transform:"scale(1.3) translateY(0px)"}),o.current=+(s.current.offsetHeight*1.3).toFixed(1)),i.current&&Object.assign(i.current.style,{transform:"translateY(0px)"})},30)},[l,e]),a.jsxs("div",{className:`${u.container}`,children:[r&&a.jsx("div",{className:"relative w-full h-full",children:a.jsx(Ie,{className:"w-7 animate-spin"})}),!r&&a.jsx(a.Fragment,{children:e.length?c:a.jsx("div",{children:"..."})})]})}function tJ({index:t,songItemRef:e}){const{currentIndex:n,setCurrentIndex:r}=fa(),{setCanPlay:s,canPlay:i,controlRef:o,statusRef:l}=Kl(),[c,u]=h.useState(!1),d=h.useRef(),m=h.useMemo(()=>n===t,[n]),p=g=>{const[x]=g;u(x.isIntersecting)};h.useEffect(()=>{var g,x;m?i?(g=o.current)==null||g.play():s(!0):i&&l.current==="playing"&&((x=o.current)==null||x.pause())},[m]),h.useEffect(()=>{e.current&&new IntersectionObserver(p,{threshold:1}).observe(e.current)},[]),h.useEffect(()=>(d.current=setTimeout(()=>{c&&r(t)},600),()=>{clearTimeout(d.current)}),[c])}function nJ({song:t,index:e,songItemRef:n}){const{controlRef:r}=Kl(),s=h.useRef(null);return tJ({index:e,songItemRef:n}),a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"relative z-0 flex items-center flex-shrink-0 text-white h-full w-full sm:w-auto sm:aspect-[3/5] rounded-xl overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0 z-[-1] overflow-hidden ",children:t.blurhash_encode&&a.jsx(ad,{hash:t.blurhash_encode,height:"100%",width:"100%"})}),a.jsx("div",{className:"absolute top-0 left-0 w-full z-[99]",children:a.jsxs("div",{className:"relative p-4",children:[s.current&&a.jsx(eJ,{audioEle:s.current}),a.jsx("div",{className:"absolute inset-0 z-[-1] bg-gradient-to-b from-black/20 to-transparent"})]})}),a.jsx("div",{className:"w-full aspect [1/1] overflow relative mask-image",children:a.jsx("img",{onClick:()=>{var i;return(i=r.current)==null?void 0:i.handlePlayPause()},className:"w-full object-cover",src:t.image_url})}),a.jsx("div",{className:"absolute z-0 bottom-0 left-0 w-full",children:a.jsxs("div",{className:"relative p-4",children:[a.jsx("div",{className:"absolute inset-0 z-[-1] bg-gradient-to-b to-black/60 from-transparent"}),a.jsx("div",{className:"text-xl font-semibold",children:t.name}),a.jsx("div",{className:"opacity-[.8]",children:t.singers.map((i,o)=>a.jsxs("span",{children:[" ",(o?", ":"")+i.name]},o))}),a.jsx("div",{className:"mt-2",children:s.current&&a.jsx(YY,{song:t,audioEle:s.current})})]})})]}),a.jsx("audio",{className:"hidden",ref:s})]})}function rJ(t,e){const{isOpenComment:n}=zn(),r=h.useRef(null);return h.useImperativeHandle(e,()=>r.current),a.jsx(a.Fragment,{children:a.jsx("div",{className:"h-full flex-shrink-0 p-4 min-h-[360px] snap-center",children:a.jsx("div",{"data-index":t.index,className:`relative h-full w-full transition-[right] duration-[.3s]  ${n?"semi-lg:right-[calc(400px*0.5)] ":"right-0"}`,ref:r,children:a.jsx(qY,{children:a.jsx(nJ,{...t,songItemRef:r})})})})})}const gE=h.forwardRef(rJ);function sJ(){const{setSongs:t}=fa(),{setErrorToast:e}=te(),[n,r]=h.useState(!0),s=h.useRef(!1),i=h.useRef(),o=h.useRef(null),l=h.useCallback(u=>{o.current&&o.current.disconnect(),o.current=new IntersectionObserver(d=>{d[0].isIntersecting&&c()},{threshold:1}),u&&o.current.observe(u)},[]),c=async()=>{try{r(!0);const u=i.current?ue(_t,X("is_official","==",!0),Ot("updated_at","desc"),qm(i.current),Mt(3)):ue(_t,X("is_official","==",!0),Ot("updated_at","desc"),Mt(3)),d=await bt(u);if(d.docs){i.current=d.docs[d.docs.length-1];const m=d.docs.map(p=>({...p.data(),id:p.id,queue_id:fo(4)}));t(p=>[...p,...m])}}catch(u){console.log({message:u}),e()}finally{r(!1)}};return h.useEffect(()=>{s.current||(s.current=!0,c())},[]),{isFetching:n,getSong:c,lastElementRef:l}}function kA(){const{user:t,updateUserData:e}=pe();return{pushRecentSong:async r=>{if(r.is_official)if(t){const s=[...t.recent_song_ids];if(!s.includes(r.id)){s.unshift(r.id);const o={recent_song_ids:s.slice(0,10)};e(o),je({collectionName:"Users",data:o,id:t.email})}}else{const s=It()["recent-songs"]||[];s.find(o=>o.id===r.id)||s.unshift(r),tt("recent-songs",s)}}}}function iJ(){const{currentSong:t}=fa(),{pushRecentSong:e}=kA(),n=h.useRef();h.useEffect(()=>{if(t)return n.current=setTimeout(()=>{hR(t.id),e(t)},5e3),()=>{clearTimeout(n.current)}},[t])}function aJ(){const{setCurrentIndex:t,songs:e}=fa(),{isFetching:n,lastElementRef:r}=sJ();iJ();const s=h.useMemo(()=>e.map((i,o)=>e.length===o+1?a.jsx(gE,{index:o,ref:r,song:i},o):a.jsx(gE,{index:o,song:i},o)),[e]);return h.useEffect(()=>{setTimeout(()=>{t(0)},1e3)},[]),a.jsxs("div",{className:"h-full snap-y snap-mandatory overflow-auto no-scrollbar flex flex-col md:items-center",children:[n&&a.jsx(Ve,{children:a.jsx(ha,{})}),s]})}function oJ(){return a.jsx(UY,{children:a.jsx(fp,{target:"song",children:a.jsxs("div",{className:"fixed bg-[--layout-cl] md:bg-transparent top-0 left-0 right-0 bottom-[47px] md:inset-0 sm:relative overflow-hidden flex-grow",children:[a.jsx(aJ,{}),a.jsx(GY,{})]})})})}const Ms={home:"/",discorver:"/discover",catogory:"/category",search:"/search",playlist:"/playlist/:id",login:"/login",unauthorized:"/unauthorized",singer:"/singer/:id",user:"/user/:id",trending:"/trending",catogoryDetail:"/category/:id"},xE={myMusic:"/my-music",songLyric:"/my-music/lyric/:id"},mn={dashboard:"/dashboard",genre:"/dashboard/genre",playlist:"/dashboard/playlist",song:"/dashboard/song",addSong:"/dashboard/song/add-song",editSong:"/dashboard/song/:songId/edit",playlistDetail:"/dashboard/playlist/:id",songLyric:"/dashboard/lyric/:id",singer:"/dashboard/singer",editSinger:"/dashboard/singer/:id",album:"/dashboard/album",editAlbum:"/dashboard/album/:id",homepage:"/dashboard/homepage",category:"/dashboard/category",categoryDetail:"/dashboard/category/:id"},lJ=[{path:Ms.home,component:oJ,layout:""},{path:Ms.discorver,component:IH,layout:""},{path:Ms.playlist,component:WH,layout:""},{path:Ms.search,component:rW,layout:""},{path:Ms.singer,component:_W,layout:""},{path:Ms.user,component:bW,layout:""},{path:Ms.catogory,component:kW,layout:""},{path:Ms.trending,component:PW,layout:""},{path:Ms.catogoryDetail,component:MW,layout:""}],cJ=[{path:xE.myMusic,component:sG,layout:""},{path:xE.songLyric,component:qG,layout:""}],uJ=[{path:mn.dashboard,component:$W,layout:""},{path:mn.playlist,component:vX,layout:""},{path:mn.genre,component:PX,layout:""},{path:mn.singer,component:NX,layout:""},{path:mn.editSinger,component:YX,layout:""},{path:mn.playlistDetail,component:TX,layout:""},{path:mn.album,component:tY,layout:""},{path:mn.editAlbum,component:BY,layout:""},{path:mn.song,component:VW,layout:""},{path:mn.addSong,component:fX,layout:pE},{path:mn.editSong,component:pX,layout:pE},{path:mn.songLyric,component:mE,layout:""},{path:mn.songLyric,component:mE,layout:""},{path:mn.homepage,component:gY,layout:""},{path:mn.category,component:bY,layout:""},{path:mn.categoryDetail,component:FY,layout:""}];function dJ(){const{user:t,loading:e}=pe();return e?a.jsx(Ve,{children:a.jsx(ha,{})}):t?a.jsx(pm,{}):a.jsx(cv,{state:{from:"/my-music"},replace:!0,to:"/login"})}function hJ(){const{user:t,loading:e}=pe();return e?a.jsx(Ve,{children:a.jsx(ha,{})}):t&&t.role==="ADMIN"?a.jsx(pm,{}):a.jsx(cv,{replace:!0,to:"/unauthorized"})}const TA=[{path:"/dashboard/homepage",title:"Home Page",icon:a.jsx(Du,{})},{path:"/dashboard/category",title:"Category",icon:a.jsx(wm,{})},{path:"/dashboard/song",title:"Songs",icon:a.jsx(la,{})},{path:"/dashboard/playlist",title:"Playlists",icon:a.jsx(pM,{})},{path:"/dashboard/album",title:"Albums",icon:a.jsx(Xk,{})},{path:"/dashboard/singer",title:"Singers",icon:a.jsx(sx,{})},{path:"/dashboard/genre",title:"Genres",icon:a.jsx(OM,{})}];function fJ(){const[t,e]=h.useState(!1);Zn();const n={container:"hidden md:block bg-[#f1f1f1] text-[#333] border-r border-black/10 transition-[width] relative flex-shrink-0",head:"h-[60px] flex items-center justify-center",logoText:"text-[22px] font-[500] whitespace-nowrap tracking-[-1px]",logoImage:"max-w-[50px] p-[4px]",item:"hover:bg-[--a-5-cl] flex whitespace-nowrap space-x-2 items-center justify-center p-2.5 text-sm",icon:"w-[24px] flex-shrink-0"};return a.jsxs("div",{className:`${n.container} ${t?"w-[150px]":"w-[70px]"}`,children:[a.jsx("div",{className:"h-[60px] flex items-center justify-center",children:a.jsx("div",{className:"w-10 flex items-center justify-center  bg-white rounded-full",children:a.jsx("span",{className:"font-bold text-[--primary-cl] leading-[40px] translate-y-[1px]",children:":D"})})}),a.jsxs("div",{className:"[&_svg]:w-5 [&_svg]:flex-shrink-0",children:[a.jsxs(Y,{className:`
              ${n.item} ${t?"!justify-start":""}
              ${location.hash==="#/dashboard"?"text-[--primary-cl]":""}`,to:"/dashboard",children:[a.jsx(xm,{}),t&&a.jsx("span",{children:"Dashboard"})]}),TA.map((r,s)=>a.jsxs(Y,{className:`
              ${n.item} ${t?"!justify-start":""}
              ${location.hash.includes(r.path)?"text-[--primary-cl]":""}`,to:r.path,children:[r.icon,t&&a.jsx("span",{children:r.title})]},s)),a.jsxs(Y,{to:"/",target:"_blank",className:`${n.item} ${t?"!justify-start":""}
               ${location.pathname==="/dashboard"?"text-[--primary-cl]":""}
               `,children:[a.jsx(Wk,{className:n.icon}),t&&a.jsx("span",{children:"Home"})]})]}),a.jsx(q,{onClick:()=>e(r=>!r),size:"clear",className:"!absolute p-1.5 bottom-5 right-0 translate-x-[50%]",children:t?a.jsx(XU,{className:"w-5 "}):a.jsx(ZU,{className:"w-5"})})]})}function IA({className:t=""}){const{behind:e,ahead:n,backward:r,forward:s}=mN();return a.jsxs("div",{className:`"flex space-x-3 [&>button]:p-1 ${t}`,children:[a.jsx("button",{onClick:r,className:`relative ${Tf(!e.length)}`,children:a.jsx(dv,{className:"w-5"})}),a.jsx("button",{onClick:s,className:`relative ${Tf(!n.length)}`,children:a.jsx(Gk,{className:"w-5"})})]})}function mJ(){const[t,e]=h.useState(0),n=r=>{const s=r.target.scrollTop||0;e(s)};return h.useEffect(()=>{const r=document.querySelector(".main-container");return r==null||r.addEventListener("scroll",n),()=>{r==null||r.removeEventListener("scroll",n)}},[]),a.jsx(a.Fragment,{children:a.jsx("div",{className:`hidden md:flex px-[40px] z-[99] h-[60px] flex-shrink-0 items-center justify-between ${t?" shadow-lg":""}`,children:a.jsxs("div",{className:"flex",children:[a.jsx(Y,{to:"/dashboard",className:"text-xl font-bold text-[--primary-cl]",children:"Dashboard"}),a.jsx(IA,{className:"ml-5"})]})})})}function pJ(){const[t,e]=h.useState(!1),n=h.useRef(null),r=s=>{var i;(i=n.current)!=null&&i.contains(s.target)||e(!1)};return h.useEffect(()=>(t&&window.addEventListener("click",r),()=>{window.removeEventListener("click",r)}),[t]),a.jsxs(a.Fragment,{children:[a.jsxs($t,{className:`[&_svg]:w-6 [&_span]:font-semibold text-sm absolute z-[99] duration-[.25] flex flex-col
        transition-[left,opacity] bg-[--popup-cl] bottom-[60px] 
        ${t?"left-[10px] opacity-[1] pointer-events-auto":"left-0 opacity-[0] pointer-events-none"}`,children:[a.jsxs(Y,{className:"inline-flex items-center py-1.5 space-x-2",to:"/dashboard",children:[a.jsx(xm,{}),a.jsx("span",{children:"Dashboard"})]}),TA.map((s,i)=>a.jsxs(Y,{className:"inline-flex items-center py-1.5 space-x-2",to:s.path,children:[s.icon,a.jsx("span",{children:s.title})]},i)),a.jsxs(Y,{className:"inline-flex items-center py-1.5 space-x-2",target:"_blank",to:"/",children:[a.jsx(Wk,{}),a.jsx("span",{children:"Go to app"})]})]}),a.jsx(q,{ref:n,size:"clear",onClick:()=>e(!t),className:"!absolute transition-[left] z-[99] bottom-[10px] left-[10px]  p-1.5",children:a.jsx(ao,{className:"w-6"})})]})}function gJ({className:t="",toast:e,onClick:n}){const[r,s]=h.useState(!1),i={icon:"w-6",container:"transition-[transform,opacity] shadow-[0_0_6px_0_rgba(0,0,0,0.3)] px-3 py-2 space-x-2 rounded-md flex items-center bg-[--popup-cl] text-[--text-cl] w-full",text:"font-semibold text-sm",open:"opacity-[1] translate-x-0",init:"opacity-0 translate-x-10"},o=()=>{switch(e.variant){case"success":return a.jsx(Yu,{className:`${i.icon} text-emerald-500`});case"error":return a.jsx(Zu,{className:`${i.icon} text-red-500`})}};return h.useEffect(()=>{setTimeout(()=>{s(!0)},0)},[]),a.jsxs("div",{onClick:()=>n?n(e.id):void 0,className:`whitespace-nowrap ${i.container} ${t} ${r?i.open:i.init} `,children:[o(),a.jsx("p",{className:i.text,children:e.desc})]})}const CA=({time:t=6e3,className:e=""})=>{const{setToasts:n,toasts:r}=te(),[s,i]=h.useState(""),o=l=>{n(c=>c.filter(u=>u.id!=l))};return h.useEffect(()=>{s&&n(l=>l.filter(c=>c.id!=s))},[s]),h.useEffect(()=>{if(!r.length)return;const l=r[r.length-1].id;setTimeout(()=>{i(l)},t)},[r]),a.jsx(a.Fragment,{children:so.createPortal(a.jsx("div",{className:`fixed z-[199] ${e}`,children:a.jsx("div",{className:"flex flex-col gap-[10px]",children:!!r.length&&r.map((l,c)=>a.jsx(gJ,{onClick:o,toast:l},c))})}),document.getElementById("portals"))})};function xJ({children:t}){return Zn().pathname.includes("lyric")?t:a.jsx("div",{className:"pb-[46px]",children:t})}function yJ(){const{isOnMobile:t}=is(),e=h.useRef(!1);return h.useEffect(()=>{if(!e.current){e.current=!0;const n=document.querySelector("body");n&&(n.setAttribute("data-theme","white"),n.classList.remove("dark")),document.title="Dashboard"}},[]),a.jsx(a.Fragment,{children:a.jsx(_C,{children:a.jsx(qW,{children:a.jsx(G8,{children:a.jsx(eq,{children:a.jsxs("div",{className:"bg-[--layout-cl] text-[--text-cl] fixed inset-full flex ",children:[t?a.jsx(pJ,{}):a.jsx(fJ,{}),a.jsxs("div",{className:"flex flex-col flex-grow",children:[a.jsx(mJ,{}),a.jsx("div",{className:"main-container flex flex-col flex-grow overflow-auto p-[10px] md:px-[40px] md:pt-0",children:a.jsx(xJ,{children:a.jsx(pm,{})})})]}),a.jsx(CA,{className:"left-[50%] translate-x-[-50%] top-[10px] md:top-[unset] md:bottom-[60px] md:left-[20px] md:translate-x-0"}),a.jsx(wC,{})]})})})})})})}function vJ({variant:t="desktop"}){const{desktopTabs:e,activeTab:n,setActiveTab:r,mobileActiveTab:s,mobileTabs:i,setMobileActiveTab:o,idle:l}=ht(),c=t==="desktop"?n:s,u=t==="desktop"?r:o,d=t==="desktop"?e:i,m={item:"px-3 md:px-8 leading-[30px] font-bold cursor-pointer  rounded-full",fadeTransition:"opacity-0 transition-opacity duration-[.3s]"};return a.jsx("ul",{className:`inline-flex mx-auto rounded-full space-x-1 bg-white/10 p-1 ${l?m.fadeTransition:""}`,children:d.map((p,g)=>{const x=p===c;return a.jsx("li",{onClick:()=>u(p),className:`${m.item} ${x?"bg-white/20":"hover:bg-white/5"}`,children:p},g)})})}function wJ({children:t}){const{isOpenComment:e,setIsOpenComment:n}=zn(),r={mainContainer:"hidden fixed w-[400px] md:flex flex-col bottom-0 right-[0] top-0 z-[99] p-3 pb-5 text-white border-l-[1px] border-[--a-5-cl] transition-[transform] duration-[.5s] linear delay-100"};return a.jsxs("div",{className:`text-white ${r.mainContainer} ${e?"translate-x-0":"translate-x-full"}     `,children:[a.jsx("div",{className:"bg-opacity-[0.8] backdrop-blur-[15px] z-[-1] bg-[#333] absolute inset-0"}),a.jsx("p",{children:a.jsx("button",{className:"p-1.5",onClick:()=>n(!1),children:a.jsx(Zu,{className:"w-7"})})}),t]})}function _J(){const{shouldFetchComment:t,setComments:e,isOpenComment:n,setIsFetching:r}=zn(),{currentSongData:s}=ce(qe),{fetchComment:i}=ip(),o=async()=>{try{if(!(s!=null&&s.song))return;const l=await i({target_id:s.song.id});e(l||[])}catch(l){console.log({error:l})}finally{r(!1)}};h.useEffect(()=>{!n||!(s!=null&&s.song)||t.current&&(t.current=!1,o())},[n]),h.useEffect(()=>()=>{t.current||(t.current=!0)},[s==null?void 0:s.song])}function RA(){const{isFetching:t,comments:e}=zn();return _J(),t?a.jsx(Ve,{children:a.jsx(Ie,{className:"w-6 animate-spin"})}):a.jsx(Gw,{comments:e})}function SJ({song:t}){const{setIsOpenComment:e}=zn();return a.jsxs(a.Fragment,{children:[a.jsx(Ys,{colorClasses:"bg-[#333] text-white",position:"top-[calc(100%+8px)]",content:"Comment",children:a.jsx("button",{onClick:()=>e(!0),className:"btn",children:a.jsx(mv,{})})}),so.createPortal(a.jsxs(wJ,{children:[a.jsx(RA,{}),a.jsx(mp,{variant:"comment",targetId:t.id})]}),document.getElementById("portals"))]})}function bJ(){const{user:t}=pe(),{activeTab:e,idle:n,setIsOpenFullScreen:r}=ht(),{currentSongData:s}=ce(qe),i=Wt(),o=s&&t?s.song.owner_email===t.email&&s.song.is_official===!1:!1,l=()=>{s!=null&&s.song&&(r(!1),setTimeout(()=>{i(`/my-music/lyric/${s==null?void 0:s.song.id}`)},300))},c={rightCta:"[&_button.btn]:h-[38px] [&_button.btn]:w-[38px] [&_button.btn]:bg-white/5 [&_button.btn]:p-2 [&_button.btn]:rounded-full  hover:[&_button]:bg-[--primary-cl]",button:"btn",headerWrapper:"relative z-[90] flex py-[25px] px-[40px] w-full items-center",fadeTransition:"opacity-0 transition-opacity duration-[.3s]"};return a.jsx(a.Fragment,{children:a.jsxs("div",{className:`${c.headerWrapper} ${n?"pointer-events-none":""}`,children:[n&&s&&a.jsx("div",{className:"absolute left-4",children:e!=="Songs"&&a.jsxs(a.Fragment,{children:[a.jsx("p",{className:"font-playwriteCU text-sm",children:s.song.name}),a.jsx("p",{className:"opacity-70 text-sm",children:s.song.singers.map((u,d)=>(d?", ":"")+u.name)})]})}),a.jsx(vJ,{}),a.jsxs("div",{className:`absolute flex right-4 space-x-3 ${n&&c.fadeTransition} ${c.rightCta}`,children:[a.jsx(fp,{target:"song",children:(s==null?void 0:s.song)&&a.jsx(SJ,{song:s.song})}),o&&e==="Lyric"&&a.jsx(Ys,{colorClasses:"bg-[#333] text-white",position:"top-[calc(100%+8px)]",content:"Edit lyric",children:a.jsx("button",{onClick:()=>l(),className:` ${c.button}`,children:a.jsx(ym,{})})}),a.jsxs(Ln,{children:[a.jsx(On,{children:a.jsx(Ys,{colorClasses:"bg-[#333] text-white",isWrapped:!0,position:"top-[calc(100%+8px)]",content:"Setting",children:a.jsx("button",{className:`${c.button} `,children:a.jsx(gv,{})})})}),a.jsx($n,{className:"top-[calc(100%+8px)] right-0",animationClassName:"origin-top-right",children:a.jsx(XR,{})})]}),a.jsx(Ys,{colorClasses:"bg-[#333] text-white",position:"top-[calc(100%+8px)]",content:"Close",children:a.jsx("button",{onClick:()=>r(!1),className:`p-2 ${c.button}`,children:a.jsx(Kk,{})})})]})]})})}function NA({className:t}){const{playerConfig:{lyricSize:e},audioRef:n,isOpenFullScreen:r,activeTab:s}=ht();if(!n.current)throw new Error("audioRef error");const{loading:i,songLyrics:o}=fw(),l=h.useMemo(()=>r&&s==="Lyric",[r,s]),{currentIndex:c,lyricRefs:u}=vN({audioEle:n.current,isActive:l,lyrics:o}),d={small:"text-[16px] sm:text-[26px]",medium:"text-[20px] sm:text-[30px]",large:"text-[26px] sm:text-[46px]"},m=()=>o.map((g,x)=>{let w="coming";return c===x?w="active":x<c&&(w="done"),a.jsx(yN,{ref:v=>u.current[x]=v,status:w,text:g.text,activeColor:"scale-[1.3]",className:"leading-[1.3] mb-5 w-[70%] last:mb-[50vh]"},x)}),p={container:"no-scrollbar pt-10 mask-image overflow-y-auto overflow-x-hidden font-['Inter',system-ui]"};return a.jsxs("div",{className:`${p.container} ${d[e||"medium"]} ${t}`,children:[i&&a.jsx("div",{className:"relative w-full h-full",children:a.jsx(Ve,{children:a.jsx(Ie,{className:"w-7 animate-spin"})})}),!i&&a.jsx(a.Fragment,{children:o.length?m():a.jsx("div",{className:"relative w-full h-full",children:a.jsx(Ve,{children:a.jsx("h1",{className:"text-[30px] opacity-60",children:"..."})})})})]})}const vc=.3,yE=t=>t%2!==0;function EJ(){const{songLyrics:t,loading:e}=fw(),{audioRef:n,isOpenFullScreen:r,activeTab:s}=ht();if(!n.current)throw new Error("useKaraoke !audioRef.current");const{playStatus:i}=ce(Hn),[o,l]=h.useState(0),c=h.useRef(null),u=h.useRef(null),d=h.useRef(null),m=h.useRef(null),p=h.useRef(0),g=h.useRef(0),x=h.useRef("paused"),w=h.useRef(!1),v=h.useMemo(()=>r&&s=="Karaoke",[r,s]),S=h.useMemo(()=>{if(t.length){if(o<0)return{odd:"",even:""};const N=yE(o);if(!t[o+1])return{odd:"",even:""};const F=N?[o,o+1]:[o+1,o],k=t[F[0]].text.trim(),j=t[F[1]].text.trim();return{odd:k,even:j}}else return{odd:"",even:""}},[o,t]),_=N=>{N.style.animation="none"},E=(N,F,k,j)=>{var A,M;let C="running";x.current==="paused"&&(C="paused"),k.style.animation=`${N} ${(((A=F==null?void 0:F.tune)==null?void 0:A.end)||F.end)-(((M=F==null?void 0:F.tune)==null?void 0:M.start)||F.start)}s linear ${C} forwards`;const R=+j.toFixed(1);Math.abs(R)>.2&&(k.style.animationDelay=`${R}s`)},I=()=>{if(!t.length)return;const N=n.current.currentTime>=p.current?"forward":"backward";p.current=n.current.currentTime;let F=g.current;switch(N){case"forward":for(;F<t.length&&t[F+1]&&t[F+1].start-vc<p.current+vc;)F+=1;break;case"backward":for(;F>0&&t[F-1]&&t[F-1].end-vc>p.current+vc;)F-=1;break}if(F!==g.current||w.current||x.current==="paused"||x.current==="waiting"){if(w.current=!1,g.current=F,l(F),!c.current||!u.current||!m.current||!d.current)return;const k=t[F],{tune:j,text:C,cut:R}=k,A=p.current+vc-j.start,M=C.split(" "),P=yE(F),we=bN(P?m.current:d.current),ne=qw(M,R,j.grow),he=P?[c.current,u.current]:[u.current,c.current],ge=SN(ne,we);E(ge,k,he[0],-A),_(he[1])}};return h.useEffect(()=>{x.current==="waiting"?setTimeout(()=>{x.current=i},300):x.current=i},[i]),h.useEffect(()=>{v&&(w.current=!0,i==="paused"&&I())},[v]),h.useEffect(()=>{if(!(!t.length||!v))return n.current.addEventListener("timeupdate",I),()=>{n.current.removeEventListener("timeupdate",I)}},[t,v]),h.useEffect(()=>()=>{p.current=0,g.current=-1,l(0)},[t]),{loading:e,currentIndexRef:g,oddOverlay:c,evenOverlay:u,currentIndex:o,textData:S,tempEventText:d,tempOddText:m}}function vE({text:t,overlayRef:e}){const{playStatus:n}=ce(Hn),[r,s]=h.useState(t),[i,o]=h.useState(!1),l=h.useRef(!0);h.useEffect(()=>{t&&o(!1)},[t]),h.useEffect(()=>{if(i)return;const u=()=>{s(t),o(!0)};l.current?setTimeout(u,300):(l.current=!0,u())},[i]),h.useEffect(()=>{n==="waiting"&&(l.current=!1),e.current&&(n==="playing"?e.current.style.animationPlayState="running":e.current.style.animationPlayState="paused")},[n]);const c={lyric:"relative duration-300 text-[44px] font-[700] pointer-none whitespace-nowrap"};return a.jsxs("div",{className:`${c.lyric} ${l.current?"transition-opacity":""} ${i?"opacity-[1]":"opacity-0"}`,children:[r||"...",a.jsx("p",{ref:e,className:"absolute whitespace-nowrap w-0 overflow-hidden text-[#ffed00] left-0 top-0 h-full",children:r||"..."})]})}function jJ(){const{loading:t,evenOverlay:e,oddOverlay:n,tempEventText:r,tempOddText:s,textData:i}=EJ();return t?a.jsx(Ve,{children:a.jsx(Ie,{className:"w-7 animate-spin"})}):a.jsxs(a.Fragment,{children:[a.jsx("div",{ref:r,className:"inline-flex h-0 opacity-0",children:i.even.split(" ").map((o,l)=>a.jsx("span",{className:"leading-1",children:o},l))}),a.jsx("div",{ref:s,className:"inline-flex h-0 opacity-0",children:i.odd.split(" ").map((o,l)=>a.jsx("span",{className:"k leading-1",children:o},l))}),a.jsx(vE,{overlayRef:e,text:i.even}),a.jsx("div",{className:"mt-8"}),a.jsx(vE,{overlayRef:n,text:i.odd})]})}const AA=()=>{window.dispatchEvent(new Event("mousemove"))};function uy(t,e,n=!1){const r=window.innerWidth,i=t.getBoundingClientRect().left,o=r-(i+t.offsetWidth),l=Math.abs(Math.ceil(i-o))/2;if(l<5)return!1;n&&(e.onscroll=()=>{},setTimeout(()=>{e.onscroll=AA},900)),n||Math.abs(i)>r||Math.abs(o)>r?e.style.scrollBehavior="auto":e.style.scrollBehavior="smooth";let c=e.scrollLeft;return o>i?setTimeout(()=>{e.scrollLeft=c-l},300):o<i&&setTimeout(()=>{e.scrollLeft=c+l},300),!0}function kJ(){const t=on(),{isOpenFullScreen:e,idle:n}=ht(),{currentQueueId:r}=ce(qe),{playStatus:s}=ce(Hn),i=h.useRef(null),o=h.useRef(null),l=h.useRef("paused"),c=()=>{!(o!=null&&o.current)||!(i!=null&&i.current)||uy(o.current,i.current,n)},u=p=>{let g=document.querySelector(".song-thumb.centered");if(!g)if(o.current)g=o.current;else return;let x;switch(p){case"ArrowRight":x=g.nextElementSibling;break;case"ArrowLeft":x=g.previousElementSibling;break}x&&i.current&&(g.classList.remove("centered"),x.classList.add("centered"),uy(x,i.current))},d=()=>{if(!o.current)return;const p=document.querySelector(".song-thumb.centered"),g=p==null?void 0:p.getAttribute("queue-id");g&&t(Cs(g))},m=p=>{if(p.key==="ArrowRight"||p.key==="ArrowLeft")return p.preventDefault(),u(p.key);p.key==="Enter"&&d()};return h.useEffect(()=>{e&&c()},[r,e]),h.useEffect(()=>{if(e)return document.addEventListener("keydown",m),()=>{var p;document.removeEventListener("keydown",m),(p=document.querySelector(".song-thumb.centered"))==null||p.classList.remove("centered")}},[r,e]),h.useEffect(()=>{const p=i==null?void 0:i.current;if(p)return p.onscroll=AA,()=>{p.onscroll=()=>{}}},[]),h.useEffect(()=>{l.current=s},[s]),{activeSongRef:o,containerRef:i}}function TJ(){const t=on(),{activeTab:e,isOpenFullScreen:n,playerConfig:r,idle:s}=ht(),{currentSongData:i}=ce(qe),{queueSongs:o,currentQueueId:l}=ce(qe),{activeSongRef:c,containerRef:u}=kJ(),d=v=>{l!==v&&t(Cs(v))},m=p2(()=>g("next"),200),p=p2(()=>g("previous"),200),g=(v="next")=>{const S=u.current;S.style.scrollBehavior="smooth",v==="next"?S.scrollLeft+=500:v==="previous"&&(S.scrollLeft-=500)},x={songsListTab:" relative h-full no-scrollbar flex items-center flex-row overflow-auto scroll-smooth px-[calc(50%-350px/2)]",absoluteButton:"absolute top-[50%] -translate-y-[50%] p-[8px] bg-white/5 rounded-full",lyricTabContainer:"px-[40px] min-[1536px]:container  min-[1536px]:px-[200px] h-full flex items-center justify-center flex-row",fadeTransition:"opacity-0 transition-opacity duration-[.3s]"},w=h.useMemo(()=>{if(i!=null&&i.song&&o.length)return o.map((v,S)=>v.queue_id===l?a.jsx(Gg,{ref:c,hasTitle:!0,onClick:()=>d(v.queue_id),active:!0,data:v},S):a.jsx(Gg,{idleClass:`${s?x.fadeTransition:""}`,hasTitle:!0,active:!1,data:v,onClick:()=>d(v.queue_id)},S))},[i==null?void 0:i.song,o,s]);return a.jsxs(a.Fragment,{children:[a.jsx("div",{ref:u,className:`song-list-container ${x.songsListTab} ${e!=="Songs"?"opacity-0":"opacity-100"}`,children:w}),e==="Songs"&&!s&&a.jsxs(a.Fragment,{children:[a.jsx(se,{hover:"scale",size:"clear",onClick:()=>p(),className:`${x.absoluteButton} left-[20px]`,children:a.jsx(pv,{className:"w-6"})}),a.jsx(se,{hover:"scale",size:"clear",onClick:()=>m(),className:`${x.absoluteButton} right-[20px]`,children:a.jsx(df,{className:"w-6"})})]}),a.jsx(kC,{children:a.jsxs(YR,{isOpenLyricTabs:n&&(e==="Lyric"||e==="Karaoke"),children:[a.jsx("div",{className:`absolute inset-0 z-20 ${e==="Lyric"?"":"hidden"}`,children:a.jsxs("div",{className:x.lyricTabContainer,children:[a.jsx(Gg,{classNames:r.songImage?"":"hidden",active:!0,data:i==null?void 0:i.song}),a.jsx(NA,{className:`w-full ml-[40px] h-full ${r.songImage,""}`})]})}),a.jsx("div",{className:`absolute font-[Inter,system-ui] inset-0 z-20 flex flex-col items-center justify-center ${e==="Karaoke"?"":"hidden"}`,children:a.jsx(jJ,{})})]})})]})}function IJ(){var o,l;const{isOpenFullScreen:t,idle:e,activeTab:n,playerConfig:{songBackground:r}}=ht(),{currentSongData:s}=ce(qe),i={wrapper:`fixed inset-0 z-50 overflow-hidden text-white bg-zinc-900
    } transition-transform duration-[.7s] linear delay-100`,bg:"absolute inset-0 -z-10 brightness-[70%]",container:"absolute w-full top-0 bottom-[90px] flex flex-col",content:"flex-grow relative overflow-hidden",fadeTransition:"opacity-0 transition-opacity duration-[.3s]"};return a.jsxs("div",{className:`${i.wrapper}  ${t?"translate-y-0":"translate-y-full"}`,children:[r&&a.jsx("div",{className:"absolute left-0 right-0 aspect-[1/1] -translate-y-1/2 top-1/2",children:a.jsx(ad,{radioGroup:"",height:"100%",width:"100%",hash:((o=s==null?void 0:s.song)==null?void 0:o.blurhash_encode)||Dw})}),a.jsxs("div",{className:i.container,children:[a.jsx(bJ,{}),a.jsx("div",{className:i.content,children:a.jsx(TJ,{})}),n!=="Songs"&&a.jsxs("p",{className:`text-center ${e&&i.fadeTransition}`,children:[((l=s==null?void 0:s.song)==null?void 0:l.name)||"...",a.jsxs("span",{className:"opacity-70 text-sm",children:[" - ",s==null?void 0:s.song.singers.map((c,u)=>(u?", ":"")+c.name)]})]})]})]})}function CJ(){const{user:t,updateUserData:e}=pe(),[n,r]=h.useState([]),[s,i]=h.useState(!0);return{isFetching:s,recentSongs:n,getRecentSongs:async()=>{try{if(t){if(t.recent_song_ids.length){const c=ue(_t,X(Lr(),"in",t.recent_song_ids)),u=await zt(c),d=[];t.recent_song_ids.forEach(m=>{const p=u.find(g=>g.id===m);p&&d.push(p)}),r(d)}}else{const c=It()["recent-songs"]||[];r(c)}}catch(c){console.log({message:c})}finally{i(!1)}},clearRecentSongs:async()=>{if(!t)return;r([]);const c={recent_song_ids:[]};await je({collectionName:"Users",data:c,id:t.email}),e(c)}}}function RJ({setTab:t}){const e=on(),n=h.useRef(!1),{getRecentSongs:r,isFetching:s,recentSongs:i,clearRecentSongs:o}=CJ(),l=c=>{e(rp({songs:[c]})),e(Cs(c.queue_id)),t("Queue")};return h.useEffect(()=>{n.current||(n.current=!0,r())},[]),s?a.jsx(as,{variant:"queue-song",hasCheckBox:!1}):a.jsxs(a.Fragment,{children:[a.jsx(br,{isHasCheckBox:!1,songVariant:"recent-song",songs:i,setSong:l}),a.jsx("div",{className:"text-center my-3",children:!!i.length&&a.jsxs(se,{onClick:o,color:"primary",children:[a.jsx(ut,{className:"w-6"}),a.jsx("span",{className:"",children:"Clear"})]})})]})}const NJ=["Queue","Recent"];function AJ(){const t=on(),{isOpenSongQueue:e,setIsOpenSongQueue:n}=ht(),{queueSongs:r,currentQueueId:s,isFetching:i}=ce(qe),{resetForNewSong:o}=gi(),[l,c]=h.useState("Queue"),u=h.useCallback(g=>{g!==s&&t(Cs(g))},[s]),d=h.useCallback(()=>{t(AV()),o(),n(!1)},[]),m=[...Array(5).keys()].map(g=>a.jsx(ye,{className:"h-[56px] mt-1 rounded-md"},g)),p={mainContainer:"hidden fixed w-[300px] md:flex flex-col bottom-[80px] right-[0] top-[0] z-20 px-3 pt-4 bg-[--layout-cl] border-l-[1px] border-[--a-5-cl] transition-[transform] duration-[.5s] linear delay-100",songListContainer:"flex-grow overflow-y-auto pb-[10px] overflow-x-hidden no-scrollbar mt-3"};return a.jsx(jn,{children:a.jsxs("div",{className:`${p.mainContainer} ${e?"translate-x-0---":"translate-x-full"}     `,children:[a.jsx(tr,{className:"w-fit mx-auto text-sm",tab:l,setTab:c,tabs:NJ,render:g=>g}),a.jsx("div",{className:p.songListContainer,children:l==="Queue"?a.jsxs(a.Fragment,{children:[a.jsx(br,{isHasCheckBox:!1,songs:r,setSong:g=>u(g.queue_id),songVariant:"queue-song",getActive:(g,x)=>g.queue_id===x.queue_id}),i&&m,a.jsx("div",{className:"text-center my-3",children:!!r.length&&a.jsxs(se,{onClick:d,color:"primary",children:[a.jsx(ut,{className:"w-6"}),a.jsx("span",{className:"",children:"Clear"})]})})]}):a.jsx(RJ,{setTab:c})})]})})}const PJ=h.memo(AJ);function FJ({vinylRef:t}){const{playStatus:e}=ce(Hn);h.useEffect(()=>{const n=t.current;n&&(e==="playing"?n.style.animationPlayState="running":n.style.animationPlayState="paused")},[e])}function MJ({textRef:t,textWrapperRef:e,content:n}){const r=h.useRef(),s=h.useRef(),i=h.useRef(!1),o=h.useRef(0),l=h.useRef(0),c=h.useRef(0),u=()=>{t.current&&(t.current.style.transition="none",t.current.style.transform="translateX(0)")},d=()=>{t.current&&(t.current.style.transition=`transform linear ${l.current}s`,t.current.style.transform=`translateX(-${c.current}px)`,s.current=setTimeout(u,l.current*1e3))},m=()=>{!t.current||!e.current||(c.current=t.current.offsetWidth-o.current,l.current=Math.ceil(c.current/35))},p=()=>{!i.current||!t.current||!e.current||(l.current=0,c.current=0,i.current=!1,clearInterval(r.current),clearTimeout(s.current),e.current.classList.remove("mask-image-horizontal"),u())},g=()=>{!t.current||!e.current||!n||!(t.current.offsetWidth>e.current.offsetWidth)||(i.current=!0,e.current.classList.add("mask-image-horizontal"),o.current=t.current.clientWidth,t.current.innerHTML=t.current.innerText+"&nbsp; &nbsp; &nbsp;"+t.current.innerText,m(),setTimeout(d,1e3),r.current=setInterval(d,l.current*1e3+3e3))};h.useEffect(()=>(g(),p),[n])}function DJ({content:t,className:e}){const n=h.useRef(null),r=h.useRef(null);return MJ({textRef:r,textWrapperRef:n,content:t}),a.jsx("div",{ref:n,className:"overflow-hidden relative h-full ",children:a.jsx("div",{ref:r,className:`absolute left-0 whitespace-nowrap ${e}`,children:t||"..."})})}const PA=h.memo(DJ);function LJ({isOpenFullScreen:t,song:e}){const n=h.useRef(null);FJ({vinylRef:n});const r={songInfoChild:"flex flex-row"};return a.jsx("div",{className:`w-1/4  ${ta(t)}`,children:a.jsxs("div",{className:`${r.songInfoChild} ${ta(t)}`,children:[a.jsx("div",{ref:n,className:"w-[56px] h-[56px] flex-shrink-0 animate-[spin_8s_linear_infinite]",children:a.jsx(Ae,{src:e==null?void 0:e.image_url,blurHashEncode:e==null?void 0:e.blurhash_encode,className:"rounded-full h-full object-cover"})}),a.jsxs("div",{className:"ml-2 flex-grow",children:[a.jsx("div",{className:"h-[32px]",children:a.jsx(PA,{className:"font-medium",content:(e==null?void 0:e.name)||"Name"})}),e&&a.jsx("div",{className:"leading-[1.2] text-sm opacity-[.7] line-clamp-1",children:e.singers.map((s,i)=>s.id?a.jsx(Y,{to:`/singer/${s.id}`,className:"hover:text-[--primary-cl] hover:underline",children:(i?", ":"")+s.name},i):a.jsx("span",{children:(i?", ":"")+s.name},i))})]})]})})}function OJ({audioEle:t,volumeLineRef:e}){const{theme:n}=is(),[r,s]=h.useState(!1),[i,o]=Mx("volume",1),l=d=>{const p=d.target.getBoundingClientRect(),g=e.current;if(g){let x=+((d.clientX-p.x)/g.clientWidth).toFixed(2);x>.9?x=1:x<.05?(x=0,s(!0)):s(!1),o(x)}},c=d=>{d.preventDefault();const m=.1;let p=i;d.deltaY>0?p-m>0?p-=m:p=0:p+m<1?p+=m:p=1,o(+p.toFixed(2))},u=()=>s(!r);return h.useEffect(()=>{if(e.current&&t){const d=i*100;e.current.style.background=Tw(d),t.volume=i,s(i===0)}},[i,n]),h.useEffect(()=>{t&&(t.muted=r)},[r]),{volume:i,handleSetVolume:l,isMute:r,handleMute:u,handleWheel:c}}function $J({audioEle:t}){const e=h.useRef(null),{handleMute:n,handleWheel:r,handleSetVolume:s,isMute:i}=OJ({audioEle:t,volumeLineRef:e});return a.jsxs("div",{className:"flex flex-grow items-center max-w-[100px] mr-2",children:[a.jsx("button",{onWheel:r,onClick:()=>n(),children:i?a.jsx(WM,{className:"w-6"}):a.jsx(UM,{className:"w-6"})}),a.jsx(od,{className:"h-1 ml-1",onClick:s,elelRef:e})]})}function zJ({handlePlayPause:t,playStatus:e}){const n={icon:"w-[50px] sm:w-10"},r=()=>{switch(e){case"playing":return a.jsx(tT,{className:`${n.icon}`});case"error":return a.jsx(vm,{className:`${n.icon}`});case"loading":case"waiting":return a.jsx(Ie,{className:`${n.icon} animate-spin`});case"paused":return a.jsx(IM,{className:`${n.icon}`})}};return a.jsx(a.Fragment,{children:a.jsx("button",{className:"inline-flex items-center justify-center",onClick:()=>t(),children:r()})})}function BJ(){var w;const{playerConfig:{isShuffle:t,repeat:e},isOpenFullScreen:n,timelineEleRef:r,currentTimeEleRef:s}=ht(),{currentSongData:i,queueSongs:o}=ce(qe),{playStatus:l}=ce(Hn),{next:c,previous:u,toggleRepeat:d,toggleShuffle:m,handlePlayPause:p,handleSeek:g}=gi(),x={button:"p-1 rounded-full md:bg-transparent ",buttonsContainer:"w-full flex justify-center items-center mb-3 sm:mb-0 space-x-3",progressContainer:"flex w-full flex-row items-center ",icon:"w-[44px] sm:w-7",before:"before:content-[''] before:w-[100%] before:h-[24px] before:absolute before:top-[50%] before:translate-y-[-50%]"};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:`${x.buttonsContainer}`,children:[a.jsxs("button",{disabled:o.length<=1,className:`relative ${x.button} ${e!=="no"&&"text-[--primary-cl]"}`,onClick:d,children:[a.jsx(Hk,{className:x.icon}),a.jsx("span",{className:"absolute font-bold text-[12px] top-1/2 left-1/2 -translate-x-[50%] -translate-y-[50%] ",children:e==="one"?"1":e==="all"?"-":""})]}),a.jsx("button",{disabled:o.length<=1,className:x.button,onClick:u,children:a.jsx(qk,{className:x.icon})}),a.jsx(zJ,{playStatus:l,handlePlayPause:p}),a.jsx("button",{disabled:o.length<=1,className:`${x.button}`,onClick:c,children:a.jsx(Yk,{className:x.icon})}),a.jsx("button",{disabled:o.length<=1,className:`${x.button} ${t&&"text-[--primary-cl]"}`,onClick:m,children:a.jsx(gm,{className:x.icon})})]}),a.jsxs("div",{className:`${x.progressContainer} ${n?"mb-0":"mb-5 sm:mb-2"} ${l==="error"||l==="loading"?"disable":""}`,children:[a.jsx("div",{className:"w-[44px] sm:w-9",children:a.jsx("span",{ref:s,className:"text-lg sm:text-sm",children:"0:00"})}),a.jsx(od,{className:"h-[6px] sm:h-1",onClick:g,elelRef:r}),a.jsx("div",{className:"w-[44px] sm:w-9 text-right",children:a.jsx("span",{className:"text-lg sm:text-sm",children:i!=null&&i.song?Sl((w=i.song)==null?void 0:w.duration):"0:00"})})]})]})}function VJ(){const{theme:t}=is(),e=h.useRef(null);return h.useEffect(()=>{if(e.current){if(!t.image){e.current.style.backgroundImage="";return}e.current.style.backgroundImage=`url(${t.image})`}},[t]),{containerRef:e}}function UJ(){const t=on(),{countDown:e}=ce(Hn),n=h.useRef(null),r=()=>{var i;e?t(Jt({countDown:0})):(i=n.current)==null||i.open()},s={container:"w-[54px] sm:w-[50px] flex justify-center",button:"rounded-[99px] p-[5px] hover:bg-[--a-5-cl]",itemContainer:"flex justify-between items-center min-h-[30px]",text:"text-base text-[#ccc]"};return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:s.container,children:e?a.jsx(Ys,{content:"Clear timer",children:a.jsxs("button",{className:"group flex items-center",onClick:r,children:[a.jsx("span",{className:"text-base opacity-70 sm:text-sm group-hover:hidden",children:e.toString().padStart(2,"0")}),a.jsx("span",{className:`hidden group-hover:block ${s.button}`,children:a.jsx(oo,{className:"w-8 sm:w-6"})})]})}):a.jsx(Ys,{content:"Sleep timer",children:a.jsx("button",{onClick:r,className:s.button,children:a.jsx(Qk,{className:"w-8 sm:w-6"})})})}),a.jsx(re,{ref:n,variant:"animation",children:a.jsx(CC,{active:i=>t(Jt({countDown:i})),closeModal:()=>{var i;return(i=n.current)==null?void 0:i.close()}})})]})}function HJ(){const{audioRef:t,idle:e}=ht();if(!t.current)throw new Error("BottomPlayer !audioRef.current");const{theme:n}=is(),{isOpenFullScreen:r,isOpenSongQueue:s,setIsOpenFullScreen:i,setIsOpenSongQueue:o}=ht(),{currentQueueId:l,currentSongData:c}=ce(qe),{containerRef:u}=VJ(),{shouldHide:d}=mU({audioEle:t.current}),m=()=>{s&&o(!1),i(!0)},p={wrapper:"bottom-player hidden md:block border-[--a-5-cl] fixed bottom-0 w-full border-t transition-transform z-50 md:px-3 lg:px-6 h-[90px]",container:"flex flex-row gap-[10px] h-full items-center",controlWrapper:`flex max-w-[420px] flex-grow ${r?"max-w-[600px] flex-col-reverse pb-[10px]":"flex-col justify-center"}`,right:"w-1/4 flex items-center justify-end",blurBg:"bg-opacity-[0.8] backdrop-blur-[15px] z-[-1] absolute inset-0 bg-[--player-cl]"};return a.jsxs("div",{ref:u,className:`${p.wrapper} ${r?"border-transparent":n.image?"bg-[--player-cl]":""} ${d&&"translate-y-[100%] "} `,children:[!n.image&&a.jsx("div",{className:`${p.blurBg} ${r?"opacity-0 transition-opacity delay-[.2s]":""}`}),a.jsxs("div",{className:`${p.container} ${r?"justify-center text-white":"justify-between"} ${e&&"transition-opacity duration-[.3s] opacity-0"}`,children:[a.jsx(LJ,{song:c==null?void 0:c.song,isOpenFullScreen:r}),a.jsx("div",{className:` ${p.controlWrapper} ${Tf(l===null)}`,children:a.jsx(BJ,{})}),a.jsxs("div",{className:`${p.right}  ${r?"hidden":""}`,children:[a.jsx($J,{audioEle:t.current}),a.jsxs("div",{className:`flex items-center ${l?"":"disable"}`,children:[a.jsx(Ys,{content:"Fullscreen mode",children:a.jsx("button",{onClick:m,className:"rounded-[99px]  hover:bg-[--a-5-cl]  p-[5px]",children:a.jsx(kF,{className:"w-6"})})}),a.jsx(Ys,{content:"Queue",children:a.jsx("button",{onClick:()=>o(!s),className:"ml-1 hover:bg-[--a-5-cl] rounded-md p-[5px]",children:a.jsx(MM,{className:"w-6"})})}),a.jsx("div",{className:"w-[2px] h-[26px] ml-2 bg-[--a-5-cl]"}),a.jsx(UJ,{})]})]})]})]})}function GJ({isOpenFullScreen:t}){const e=h.useRef(null);return h.useEffect(()=>{const n=e.current;n&&(t?(n.style.transform="translate(0)",n.style.zIndex="99"):(n.style.transform="translate(0, 100%)",setTimeout(()=>{n.style.zIndex="-10"},500)))},[t]),{wrapperRef:e}}function WJ({imageUrl:t}){const{mobileActiveTab:e,setMobileActiveTab:n}=ht(),r=e==="Playing";return a.jsx("div",{onClick:()=>n(r?"Lyric":"Playing"),className:` ${r?"w-full h-auto px-2 sm:w-[60px] sm:h-[60px] sm:px-0":"w-[60px] h-[60px] p-0 flex-shrink-0"}`,children:a.jsx(Ae,{src:t,className:"w-full rounded-md"})})}function qJ({song:t,onClick:e,active:n}){const r={itemContainer:`border-b 
    last:border-none border-white/10 rounded-md flex p-2 ${n?"bg-white/10":""}`,imageFrame:"w-[54px] h-[54px] relative rounded-md overflow-hidden flex-shrink-0"};return a.jsx(a.Fragment,{children:a.jsxs("div",{onClick:e,className:`${r.itemContainer} `,children:[a.jsx("div",{className:`${r.imageFrame}  `,children:a.jsx(Ae,{blurHashEncode:t.blurhash_encode,src:t.image_url})}),a.jsxs("div",{className:"ml-[10px]",children:[a.jsx("p",{className:"text-lg line-clamp-1 text-sm",children:t.name}),a.jsx("p",{className:"opacity-70 line-clamp-1 text-sm",children:t.singers.map((s,i)=>a.jsxs("span",{children:[" ",(i?", ":"")+s.name]},i))})]})]})})}function KJ({}){const t=on(),{queueSongs:e,isFetching:n,currentQueueId:r}=ce(qe),s=[...Array(5).keys()].map(o=>a.jsx(ye,{className:"h-[40px] mt-1"},o)),i=()=>a.jsx(a.Fragment,{children:e.map((o,l)=>a.jsx(qJ,{song:o,active:r===o.queue_id,onClick:()=>t(Cs(o.queue_id))},l))});return a.jsxs(a.Fragment,{children:[i(),n&&s]})}function QJ(){const t=h.useRef(null),e=on(),{countDown:n}=ce(Hn),r=()=>{var s;n?e(Jt({countDown:0})):(s=t.current)==null||s.open()};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("button",{className:Qi(!!n,"active"),onClick:r,children:n?a.jsx(oz,{className:"w-6"}):a.jsx(Qk,{className:"w-6"})}),a.jsx("span",{children:n?n.toString().padStart(2,"")+" songs":"Timer"})]}),a.jsx(re,{ref:t,variant:"animation",children:a.jsx(CC,{active:s=>e(Jt({countDown:s})),closeModal:()=>{var s;return(s=t.current)==null?void 0:s.close()}})})]})}function XJ({song:t}){const e=h.useRef(null);return a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("button",{onClick:()=>{var n;return(n=e.current)==null?void 0:n.open()},children:a.jsx(Nt,{className:"w-6"})}),a.jsx("span",{children:"Add to playlist"})]}),a.jsx(re,{variant:"animation",ref:e,children:a.jsx(cp,{closeModal:()=>{var n;return(n=e.current)==null?void 0:n.close()},songs:[t]})})]})}function YJ({isLiked:t,song:e}){const{action:n,loading:r}=up();return a.jsxs("div",{children:[a.jsx("button",{onClick:()=>n({variant:"like",song:e}),className:`${Qi(t,"active")}`,children:r?a.jsx(Ie,{className:"w-6 animate-spin"}):a.jsx(a.Fragment,{children:t?a.jsx(Bl,{className:"w-6"}):a.jsx(Mu,{className:"w-6"})})}),a.jsx("span",{children:t?"Dislike":"Like"})]})}function JJ(){const{user:t}=pe(),{currentSongData:e,queueSongs:n}=ce(qe),{toggleRepeat:r,repeat:s}=gi(),i={buttonList:"flex flex-shrink-0 overflow-auto space-x-2 [&_div]:flex [&_div]:w-[70px] [&_div]:flex-col [&_div]:items-center [&_div]:space-y-1.5 [&_div]:text-center [&_button]:p-3.5 [&_button]:bg-white/10 [&_button]:rounded-full [&_button.active]:text-[#198585] [&_span]:text-xs"};if(e)return a.jsx(a.Fragment,{children:a.jsxs("div",{className:"h-[70vh] overflow-hidden text-white rounded-[16px_16px_0_0] relative p-3 flex flex-col",children:[a.jsx("div",{className:"bg-opacity-[0.8] backdrop-blur-[15px] z-[-1] bg-[#1f1f1f] absolute inset-0"}),a.jsxs("div",{className:i.buttonList,children:[a.jsxs("div",{children:[a.jsx("button",{disabled:n.length<=1,className:`${Qi(s!=="no","active")}`,onClick:r,children:a.jsx(Hk,{className:"w-6"})}),a.jsx("span",{className:"break-word",children:s==="one"?"Repeat one":s==="all"?"Repeat all":"Play once"})]}),t&&a.jsxs(a.Fragment,{children:[a.jsx(XJ,{song:e.song}),a.jsx(YJ,{song:e.song,isLiked:!!(t!=null&&t.liked_song_ids.includes(e.song.id))})]}),a.jsx(QJ,{})]}),a.jsx("div",{className:"flex-grow overflow-auto mt-3 border-t border-white/60 pt-3",children:e&&a.jsx(KJ,{currentIndex:e.index})})]})})}function ZJ(){const{setIsOpenFullScreen:t}=ht(),{setIsOpenComment:e}=zn(),n=h.useRef(null),r=h.useRef(null),s=()=>{var i;(i=r.current)==null||i.open(),e(!0)};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex space-x-1 items-center",children:[a.jsx("button",{className:"p-1.5",onClick:s,children:a.jsx(mv,{className:"w-6"})}),a.jsx("button",{className:"p-1.5",onClick:()=>{var i;return(i=n.current)==null?void 0:i.open()},children:a.jsx(X$,{className:"w-6"})}),a.jsx("button",{onClick:()=>t(!1),className:"p-1.5",children:a.jsx(Kk,{className:"w-6"})})]}),a.jsx(Gx,{ref:n,children:a.jsx(JJ,{})}),a.jsx(Gx,{onClose:()=>e(!1),ref:r,children:a.jsx(cN,{children:a.jsx(RA,{})})})]})}function eZ({handlePlayPause:t,playStatus:e}){const n={icon:"w-10"},r=()=>{switch(e){case"playing":return a.jsx(Ju,{className:`${n.icon}`});case"error":return a.jsx(NC,{className:`${n.icon}`});case"loading":case"waiting":return a.jsx(RC,{className:`${n.icon} animate-spin`});case"paused":return a.jsx(qa,{className:`${n.icon}`})}};return a.jsx(a.Fragment,{children:a.jsx("button",{className:"inline-flex items-center justify-center",onClick:()=>t(),children:r()})})}function tZ(){var l;const{timelineEleRef:t,currentTimeEleRef:e}=ht(),{playStatus:n}=ce(Hn),{currentSongData:r}=ce(qe),{handleSeek:s,handlePlayPause:i}=gi(),o={buttonsContainer:"w-full flex items-center justify-between space-x-2 mt-2",progressContainer:"flex w-full flex-row items-center "};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:`${o.progressContainer}  ${n==="error"||n==="loading"?"disable":""}`,children:[a.jsx("div",{className:"w-[44px] flex-shrink-0 sm:w-9",children:a.jsx("span",{ref:e,className:"text-lg sm:text-sm",children:"0:00"})}),a.jsx(od,{onClick:s,elelRef:t,className:"h-1.5"}),a.jsx("div",{className:"w-[44px] flex-shrink-0 sm:w-9 text-right",children:a.jsx("span",{className:"text-lg sm:text-sm",children:r!=null&&r.song?Sl((l=r.song)==null?void 0:l.duration):"0:00"})})]}),a.jsxs("div",{className:`${o.buttonsContainer}`,children:[a.jsx(eZ,{playStatus:n,handlePlayPause:i}),a.jsx(fp,{target:"song",children:a.jsx(ZJ,{})})]})]})}function nZ(){const{isOpenFullScreen:t,playerConfig:{songBackground:e},mobileActiveTab:n}=ht(),{currentSongData:r}=ce(qe),s=h.useRef(null),{wrapperRef:i}=GJ({isOpenFullScreen:t}),o={headerWrapper:"flex mb-4",container:"flex-grow flex flex-col relative overflow-hidden",control:"mt-auto",bgImage:"absolute inset-0 z-[-9] brightness-[70%] blur-[4px] translate-3d-0"};return a.jsx(a.Fragment,{children:a.jsxs("div",{ref:i,style:{transform:"translate(0, 100%)",zIndex:"-10"},className:"block md:hidden fixed inset-0 bg-zinc-900 text-white overflow-hidden transition-[transform] duration-[.3s] ease-linear",children:[e&&a.jsx("div",{className:o.bgImage,children:a.jsx(ad,{width:"100%",height:"100%",hash:(r==null?void 0:r.song.blurhash_encode)||Dw})}),a.jsx("div",{className:"h-full z-10 p-4 flex flex-col",children:a.jsxs("div",{ref:s,className:o.container,children:[a.jsxs("div",{className:`${n!="Playing"?"flex items-center":"sm:flex"}`,children:[a.jsx(WJ,{imageUrl:r==null?void 0:r.song.image_url}),a.jsxs("div",{className:`ml-2 ${n!="Playing"?"block":"hidden sm:block"}`,children:[a.jsx("p",{className:"font-playwriteCU translate-y-[-6px] leading-[2.4] line-clamp-1",children:r==null?void 0:r.song.name}),a.jsx("div",{className:"opacity-[.7] line-clamp-1 text-sm",children:r==null?void 0:r.song.singers.map((l,c)=>a.jsxs("span",{children:[" ",(c?", ":"")+l.name]},c))})]}),n==="Lyric"&&a.jsxs(Ln,{appendOnPortal:!0,children:[a.jsx(On,{children:a.jsx("button",{className:" p-[6px] rounded-full ml-auto  bg-white/10",children:a.jsx(gv,{className:"w-6"})})}),a.jsx($n,{position:"left-bottom",origin:"top right",children:a.jsx(XR,{})})]})]}),a.jsx("div",{className:`mt-2 justify-between items-center ${n!="Playing"?"hidden":"flex sm:hidden"}`,children:a.jsxs("div",{className:"flex-grow",children:[a.jsx("div",{className:"h-[40px]",children:a.jsx(PA,{className:"text-xl leading-[1.5] font-playwriteCU",content:(r==null?void 0:r.song.name)||"..."})}),a.jsx("div",{className:"opacity-[.7] line-clamp-1 text-sm",children:r==null?void 0:r.song.singers.map((l,c)=>l.id?a.jsx(Y,{to:`/singer/${l.id}`,children:(c?", ":"")+l.name},c):a.jsxs("span",{children:[" ",(c?", ":"")+l.name]},c))})]})}),a.jsx(kC,{children:a.jsx(YR,{isOpenLyricTabs:t&&n=="Lyric",children:a.jsx(NA,{className:`text-left ${n==="Lyric"?"flex-1 block":"hidden"}`})})}),a.jsx("div",{className:`${o.control}`,children:a.jsx(tZ,{})})]})})]})})}function rZ({audioEle:t}){const e=Zn(),n=h.useMemo(()=>e.pathname==="/",[e]),r=h.useMemo(()=>e.pathname.includes("lyric"),[e]);return h.useEffect(()=>{(n||r)&&t.pause()},[e]),{shouldHidePlayer:n,location:e,shouldHideAll:r}}function sZ({ActiveClass:t}){const{user:e}=pe(),{action:n}=ld(),r=Wt(),s=h.useRef(null),i=async()=>{try{await n("login"),r("/my-music")}catch(o){console.log(o)}};return e?a.jsx(Y,{className:`
                  ${t}
                `,to:"/my-music",children:a.jsxs("div",{children:[a.jsx(sx,{}),a.jsx("span",{children:"My song"})]})}):a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>{var o;return(o=s.current)==null?void 0:o.open()},className:`
                  ${t}
                `,children:a.jsxs("div",{children:[a.jsx(sx,{}),a.jsx("span",{children:"Login"})]})}),a.jsx(re,{ref:s,variant:"animation",children:a.jsxs(ve,{children:[a.jsx(Be,{closeModal:()=>{var o;return(o=s.current)==null?void 0:o.close()},title:"Login"}),a.jsx("div",{className:"text-center my-5",children:a.jsx(se,{onClick:i,color:"primary",children:"Login with Google"})})]})})]})}function iZ(){const{isOpenFullScreen:t,setIsOpenFullScreen:e,audioRef:n}=ht();if(!n.current)return a.jsx(a.Fragment,{});const{playStatus:r}=ce(Hn),{currentSongData:s}=ce(qe),{handlePlayPause:i}=gi(),{shouldHideAll:o,shouldHidePlayer:l,location:c}=rZ({audioEle:n.current}),u=h.useMemo(()=>{switch(r){case"playing":return a.jsx(Ju,{className:""});case"error":return a.jsx(vm,{className:""});case"loading":case"waiting":return a.jsx(Ie,{className:" animate-spin"});case"paused":return a.jsx(qa,{className:""})}},[r]),d=p=>p?"text-[--primary-cl]":"",m={wrapper:`block  ${l?"bg-[--layout-cl]":"bg-transparent"}  md:hidden fixed bottom-0 w-full transition-transform overflow-hidden border-t border-[--a-5-cl] z-[9]`,container:"absolute inset-0 bg-[--player-cl] bg-opacity-[0.7] backdrop-blur-[15px] z-[-1]",songImageWrapper:"flex flex-row items-center flex-grow h-full",image:"w-[54px] h-[54px] flex-shrink-0",cta:"ml-2 flex-shrink-0"};return a.jsxs("div",{className:`${m.wrapper} ${o?"translate-y-[100%]":""}`,children:[a.jsx("div",{className:`${m.container} ${t?"opacity-0 transition-opacity delay-[.3s]":""}`}),a.jsxs("div",{className:`flex justify-between items-center px-4 py-3 ${l?"hidden":""}`,children:[a.jsx("div",{onClick:()=>s!=null&&s.song.name?e(!0):{},className:"mobile-current-song flex-grow",children:a.jsxs("div",{className:m.songImageWrapper,children:[a.jsx("div",{className:m.image,children:a.jsx(Ae,{src:s==null?void 0:s.song.image_url,className:"rounded-full"})}),a.jsx("div",{className:"flex-grow ml-2",children:(s==null?void 0:s.song.song_url)&&a.jsxs(a.Fragment,{children:[a.jsx("p",{className:"font-playwriteCU line-clamp-1",children:(s==null?void 0:s.song.name)||"..."}),a.jsx("p",{className:"opacity-70 text-sm line-clamp-1",children:s==null?void 0:s.song.singers.map((p,g)=>(g?", ":"")+p.name)})]})})]})}),a.jsx("div",{className:`${m.cta} ${!(s!=null&&s.song.name)&&"disable"}`,children:a.jsx("button",{className:"p-1.5 [&_svg]:w-9 text-[--primary-cl]",onClick:i,children:u})})]}),a.jsxs("div",{className:`flex items-center py-1 justify-evenly [&_div]:flex 
      [&_div]:flex-col 
      [&_div]:items-center
      [&_svg]:w-6
      [&_span]:text-[10px]
      ${l?"":"border-t border-[--a-5-cl]"}
      `,children:[a.jsx(Y,{className:`
              ${d(c.pathname==="/")}
            `,to:"/",children:a.jsxs("div",{children:[a.jsx(Du,{}),a.jsx("span",{children:"For You"})]})}),a.jsx(Y,{className:`
              ${d(c.pathname==="/discover")}
            `,to:"/discover",children:a.jsxs("div",{children:[a.jsx(Jk,{}),a.jsx("span",{children:"Discover"})]})}),a.jsx(Y,{className:`
              ${d(c.pathname==="/search")}
            `,to:"/search",children:a.jsxs("div",{children:[a.jsx(Lu,{}),a.jsx("span",{children:"Search"})]})}),a.jsx(sZ,{ActiveClass:d(c.pathname==="/my-music")})]})]})}function aZ(){const t=on(),{audioRef:e,firstTimeSongLoaded:n}=ht(),{playStatus:r,countDown:s}=ce(Hn),{handlePlayPause:i}=gi(),o=h.useRef(0),l=()=>(console.log("song end"),tt("timer",o.current-1),t(Jt({countDown:o.current-1})));h.useEffect(()=>{const c=It().timer||0;t(Jt({countDown:c}))},[]),h.useEffect(()=>{if(!(!s||!e.current))return e.current.addEventListener("ended",l),n.current||(tt("timer",s),tt("is_timer",!0),r==="paused"&&i()),()=>{var c;(c=e.current)==null||c.removeEventListener("ended",l)}},[!!s]),h.useEffect(()=>{o.current=s},[s])}function oZ(){const{playerConfig:{repeat:t,isShuffle:e,isCrossFade:n,isEnableBeat:r},audioRef:s,firstTimeSongLoaded:i,startFadeWhenEnd:o,isPlayingNewSong:l,timelineEleRef:c,currentTimeEleRef:u,shouldSyncSongDuration:d,isOpenFullScreen:m,timeLineColorRef:p}=ht();if(!s.current)throw new Error("Use Control audioRef.current is undefined");const g=on(),{queueSongs:x,currentSongData:w,currentQueueId:v}=ce(qe),{playStatus:S}=ce(Hn),{currentPlaylist:_}=ce(da),E=h.useRef(),I=h.useRef(!1),N=h.useRef(!1),F=h.useRef(!1),k=h.useRef("paused"),j=Zn(),{setErrorToast:C}=te(),{next:R,updateProgressElement:A,play:M,pause:P}=gi(),we=h.useMemo(()=>j.pathname.includes("edit"),[j]),ne=h.useMemo(()=>It(),[]),he=xe=>x[xe],ge=()=>{g(Jt({playStatus:"paused"}))},H=()=>{S!=="playing"&&(g(Jt({playStatus:"playing"})),F.current=!1)},K=()=>{c.current&&u.current&&(u.current.innerText="0:00",c.current.style.background="var-(--a-10-cl)")},ee=xe=>{const $r=It().volume||1;if(xe<=2){const Wn=xe/2*$r;s.current.volume=Wn}else if(xe<o.current){s.current.volume!=$r&&(s.current.volume=$r);return}if(xe>=o.current){const Wn=(s.current.duration-xe)/2*$r;s.current.volume=Wn}},be=()=>{const xe=s.current.currentTime;k.current!=="paused"&&g(Jt({playStatus:"playing"})),A(xe),n&&ee(xe),xe&&Math.round(xe)%3===0&&tt("current_time",Math.round(xe))},Re=()=>{if(console.log("end"),!E.current)return;const xe=It(),$r=xe.volume||1,Wn=xe.timer;if(t==="one"&&Wn&&Wn!==1)return M();if(s.current.volume=$r,N.current=!0,e){let zr=E.current.index;for(;zr===E.current.index;)zr=Math.round(Math.random()*x.length-1);const Ns=he(zr);return g(Cs(Ns.queue_id))}return Wn===0&&xe.is_timer?(I.current=!0,tt("is_timer",!1)):E.current.index===x.length-1&&(t==="all"||Wn>=1?I.current=!1:I.current=!0),x.length===1?K():R()},Oe=()=>{E.current&&g(Jt({playStatus:"loading"}))},kn=()=>{if(!E.current)return;const xe=s.current.duration;if(o.current=xe-3,tt("current_queue_id",E.current.song.queue_id),I.current)return I.current=!1,g(Jt({playStatus:"paused"}));if((we||i.current)&&(g(Jt({playStatus:"paused"})),i.current)){i.current=!1,d.current=!0,A(ne.current_time||0);return}M()},jr=()=>{g(Jt({playStatus:"waiting"}))},kr=()=>{if(E.current){if(F.current||(F.current=!0,C("Found internet error")),!N.current)return g(Jt({playStatus:"error"}));if(x.length>1){if(E.current.index===x.length-1){g(Jt({playStatus:"error"}));return}R()}else g(Jt({playStatus:"error"}))}};h.useEffect(()=>{const xe=ne.current_queue_id||null;xe&&x.length?g(Cs(xe)):i.current=!1},[]),h.useEffect(()=>(s.current.addEventListener("error",kr),s.current.addEventListener("pause",ge),s.current.addEventListener("play",H),s.current.addEventListener("loadstart",Oe),s.current.addEventListener("loadedmetadata",kn),s.current.addEventListener("waiting",jr),()=>{var xe,$r,Wn,zr,Ns,yo;(xe=s.current)==null||xe.removeEventListener("error",kr),($r=s.current)==null||$r.removeEventListener("pause",ge),(Wn=s.current)==null||Wn.removeEventListener("play",H),(zr=s.current)==null||zr.removeEventListener("loadstart",Oe),(Ns=s.current)==null||Ns.removeEventListener("loadedmetadata",kn),(yo=s.current)==null||yo.addEventListener("waiting",jr)}),[]),h.useEffect(()=>{if(!w||!v){k.current="paused",P();return}return s.current.src=r&&w.song.beat_url?w.song.beat_url:w.song.song_url,E.current=w,()=>{K(),l.current=!0,d.current&&(d.current=!1)}},[w==null?void 0:w.song]),h.useEffect(()=>{if(!w){S==="paused"&&K();return}let xe=`${w.song.name}`;S==="paused"&&_&&w.song.queue_id.includes(_.id)&&(xe=`${_.name}`),document.title=xe,k.current=S},[S]),h.useEffect(()=>(s.current.addEventListener("ended",Re),()=>{var xe;return(xe=s.current)==null?void 0:xe.removeEventListener("ended",Re)}),[t,e,v,x]),h.useEffect(()=>(s.current.addEventListener("timeupdate",be),()=>{var xe;(xe=s.current)==null||xe.removeEventListener("timeupdate",be)}),[n]),h.useEffect(()=>{we&&S==="playing"&&P()},[we]),h.useEffect(()=>{m?p.current="#fff":p.current="var(--primary-cl)"},[m])}function lZ(t,e){const{currentSongData:n}=ce(qe),{isOpenFullScreen:r,setIdle:s}=ht(),[i,o]=h.useState(0),l=h.useRef(),c=h.useRef(),u=()=>{s(!1),o(Math.random())},d=()=>{clearTimeout(c.current),clearTimeout(l.current)},m=async()=>{if(!r)return;const p=document.querySelector(".song-thumb.active"),g=document.querySelector(".song-list-container");if(p&&g){const x=uy(p,g,!0);let w=Pw.focusDelay;x||(w=0),l.current=setTimeout(()=>{s(!0)},w)}};if(h.useEffect(()=>{if(!(e||!n)){if(!r){s(!1);return}return setTimeout(()=>{window.addEventListener("mousemove",u),window.dispatchEvent(new Event("mousemove"))},1e3),()=>{window.removeEventListener("mousemove",u),d()}}},[r]),h.useEffect(()=>(c.current=setTimeout(()=>{m()},t),()=>{d()}),[i]),!r)return!1}function cZ({audioEle:t}){const{currentSongData:e,currentQueueId:n}=ce(qe),{pushRecentSong:r}=kA(),s=h.useRef(""),i=async()=>{if(!n||!(e!=null&&e.song))return;const o=e.song.id;e.song.is_official&&s.current!==n&&(s.current=n,hR(o),r(e.song))};h.useEffect(()=>(t.addEventListener("playing",i),()=>{t.removeEventListener("playing",i)}),[n])}function uZ({children:t,audioEle:e}){const{isOnMobile:n}=is();return oZ(),aZ(),lZ(Pw.focusDelay,n),cZ({audioEle:e}),h.useMemo(()=>t,[])}function dZ(){const{isOnMobile:t}=is(),{audioRef:e}=ht(),[n,r]=h.useState(!1),s=e.current&&a.jsxs(a.Fragment,{children:[a.jsx(IJ,{}),a.jsx(PJ,{}),a.jsx(HJ,{})]}),i=e.current&&a.jsxs(a.Fragment,{children:[a.jsx(nZ,{}),a.jsx(iZ,{})]});return h.useEffect(()=>{r(!0)},[]),a.jsxs(a.Fragment,{children:[a.jsx("audio",{ref:e,className:"hidden"}),e.current&&a.jsx(uZ,{audioEle:e.current,children:t?i:s})]})}function hZ({className:t}){const[e,n]=h.useState(!1),r=()=>{const i=document.querySelector(".main-container");if(!i)return;const o=i.scrollTop||0;n(o>100)},s=()=>{const i=document.querySelector(".main-container");i==null||i.scroll({behavior:"smooth",top:0})};return h.useEffect(()=>{const i=document.querySelector(".main-container");if(i)return i.addEventListener("scroll",r),()=>{i.removeEventListener("scroll",r)}},[]),a.jsx(se,{onClick:s,size:"clear",className:`absolute p-2 transition-[transform,opacity] 
         ${t||""} 
         w-[36px] 
         hover:bg-[--a-5-cl]  
      ${e?"opacity-[1]":"opacity-0 translate-y-[20px]"}`,children:a.jsx(q$,{className:"w-6"})})}function fZ(){const{user:t,loading:e}=pe(),n=Zn(),r=[...Array(4).keys()].map(o=>a.jsxs("div",{className:"h-[55px] lg:h-[55px] w-full ske",children:[a.jsx(ye,{className:"w-6 h-6 flex-shrink-0"}),a.jsx(ye,{className:"w-[60px] h-[22px] md:h-[14px] md:mt-[2px] lg:h-[16px] lg:w-[70px]"})]},o)),s=o=>o?"text-[--primary-cl]":"",i={container:"w-[80px] lg:w-[160px] relative flex-shrink-0 h-screen bg-[--sidebar-collapse-cl] lg:bg-[--sidebar-cl] ",linkList:`
      hover:[&_div:not(.ske)]:bg-[--a-5-cl]
      [&_div]:py-1.5
      [&_div]:leading-[2.2] 
      [&_div]:flex 
      [&_div]:flex-col 
      [&_div]:items-center
      [&_span]:text-xs
      [&_span]:mt-[2px]
      [&_span]:font-semibold

      lg:[&_div]:py-2
      lg:[&_div]:pl-4
      lg:[&_span]:mt-0
      lg:[&_div]:space-x-2 
      lg:[&_div]:px-3
      lg:[&_div]:flex-row 
      lg:[&_div]:items-center
      [&_svg]:w-6
      [&_a]:w-full
      lg:[&_span]:text-[14px]
      lg:[&_span]:inline-block
      `};return a.jsxs("div",{className:`${i.container}`,children:[a.jsx("div",{className:"px-[10px] h-[80px] flex items-center justify-center",children:a.jsx(Y,{to:"/",className:"bg-white dark:bg-[--layout-cl] w-12 flex h-12 rounded-full justify-center items-center",children:a.jsx("span",{className:"text-[--primary-cl] text-xl font-bold translate-y-[1px]",children:":D"})})}),a.jsxs("div",{className:`flex flex-col items-start ${i.linkList}`,children:[e&&r,!e&&a.jsxs(a.Fragment,{children:[a.jsx(Y,{className:`
              ${s(n.pathname==="/")}
            `,to:"/",children:a.jsxs("div",{children:[a.jsx(Du,{}),a.jsx("span",{children:"For You"})]})}),a.jsx(Y,{className:`
              ${s(n.pathname.includes("/discover"))}
            `,to:"/discover",children:a.jsxs("div",{children:[a.jsx(Jk,{}),a.jsx("span",{children:"Discover"})]})}),a.jsx(Y,{className:`
              ${s(n.pathname.includes("/category"))}
            `,to:"/category",children:a.jsxs("div",{children:[a.jsx(wm,{}),a.jsx("span",{children:"Category"})]})}),a.jsx(Y,{className:`
              ${s(n.pathname.includes("/trending"))}
            `,to:"/trending",children:a.jsxs("div",{children:[a.jsx(gm,{}),a.jsx("span",{children:"Trending"})]})}),t&&a.jsxs(a.Fragment,{children:[a.jsx(Y,{className:`
                  ${s(n.pathname.includes("/my-music"))}`,to:"/my-music",children:a.jsxs("div",{children:[a.jsx(la,{}),a.jsx("span",{children:"My Song"})]})}),t.role==="ADMIN"&&a.jsx(Y,{to:"/dashboard",target:"_blank",className:"border-transparent",children:a.jsxs("div",{children:[a.jsx(xm,{}),a.jsx("span",{className:"",children:"Dashboard"})]})})]})]})]}),a.jsx(hZ,{className:"left-[50%] translate-x-[-50%] bottom-[80px] md:bottom-[100px]"})]})}function mZ({contentRef:t}){const[e,n]=h.useState(0),[r,s]=Ow(na),[i,o]=h.useState(""),l=h.useRef(null),c=h.useRef(null),u=h.useRef(null),{action:d}=ld(),m=E=>{var I,N;o(E),(I=u.current)==null||I.toggle(),(N=l.current)==null||N.close()},p=()=>{var E;return(E=u.current)==null?void 0:E.close()},g=async()=>{var E;try{await d("logout")}catch(I){console.log("signOut error",{message:I})}finally{(E=u.current)==null||E.toggle()}},x=async()=>{var E;try{(E=c.current)==null||E.close(),await d("login")}catch(I){console.log({message:I})}},w=()=>{var I;const E=((I=t.current)==null?void 0:I.scrollTop)||0;n(E)},v=a.jsx(ye,{className:"h-[40px] w-[40px] rounded-full"}),S=h.useMemo(()=>{switch(i){case"":return a.jsx(a.Fragment,{});case"theme":return a.jsx(IC,{closeModal:p});case"info":return a.jsx(sT,{closeModal:p});case"confirm":return a.jsx(an,{closeModal:p,callback:g,loading:!1,label:"Sign out ?"})}},[i]);h.useEffect(()=>{var E;return(E=t.current)==null||E.addEventListener("scroll",w),()=>{document.removeEventListener("scroll",w)}},[]);const _={userName:"text-[16px] font-[500] ml-[8px] line-clamp-1",button:"h-[40px] w-[40px] rounded-full hover:bg-[--a-5-cl]",icon:"w-5 mr-1",divide:"h-[1px]  w-[calc(100%-20px)] mb-[10px] mt-[20px] mx-auto bg-[--a-5-cl]"};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:`h-[60px] fixed top-0 right-0  left-[80px] lg:left-[160px] z-[20] bg-transparent  ${e?"shadow-lg":""}`,children:[a.jsx("div",{className:`${e?"":"hidden "} absolute inset-0 bg-[--player-cl] bg-opacity-[0.8] backdrop-blur-[15px] z-[-1] `}),a.jsxs("div",{className:"px-[40px] items-center flex h-full",children:[a.jsx(IA,{className:"mr-5"}),a.jsx(jN,{}),a.jsxs("div",{className:"flex space-x-3 ml-auto",children:[a.jsxs(Ln,{children:[a.jsx(On,{ref:l,children:a.jsx(Ys,{isWrapped:!0,position:"top-[calc(100%+8px)]",content:"Settings",children:a.jsx("button",{className:`flex px-[6px] items-center ${_.button} `,children:a.jsx(uv,{className:"w-full"})})})}),a.jsx($n,{className:"top-[calc(100%+8px)] right-0",animationClassName:"origin-top-right",children:a.jsx(VU,{openModal:m,variant:"client"})})]}),a.jsxs(Ln,{children:[a.jsx(On,{ref:c,className:"flex items-center",children:a.jsx("button",{className:"flex hover:brightness-90",children:s?v:a.jsx(Hx,{className:"w-[40px] h-[40px]"})})}),a.jsx($n,{className:"top-[calc(100%+8px)] right-0",animationClassName:"origin-top-right",children:a.jsxs(er,{className:"w-[250px] px-3",children:[r&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center p-[10px] pb-0",children:[a.jsx(Hx,{className:"login-trigger w-[46px] h-[46px]"}),a.jsx("div",{className:"ml-[12px]",children:a.jsx("h5",{className:"font-semibold line-clamp-1",children:r==null?void 0:r.displayName})})]}),a.jsx("div",{className:_.divide})]}),a.jsxs(Or,{className:"[&_button]:rounded-md",children:[r&&a.jsxs("button",{onClick:()=>m("confirm"),children:[a.jsx(hv,{className:_.icon}),"Log out"]}),!r&&a.jsxs("button",{onClick:x,children:[a.jsx(B4,{className:_.icon}),"Log in"]})]})]})})]})]})]})]}),a.jsx(re,{variant:"animation",ref:u,children:S})]})}function pZ(){const{setErrorToast:t,setSuccessToast:e}=te(),{user:n,setUser:r}=pe(),{uploadedSongs:s,setUploadedSongs:i,shouldFetchFavoriteSongs:o}=at(),{setIsUploading:l,isUploading:c,setUploadingSongs:u,resetUploadContext:d}=bC(),[m,p]=h.useState(""),g=h.useRef(null),x=()=>{const v=g.current;v&&(v.value=""),d()},w=async v=>{try{if(!n)return;const S=[],_=[],E=v.target.files;if(!E.length)return;const I=[],N=[],F=Date.now(),k=A=>s.some(M=>M.size===A.size)||I.some(M=>M.size===A.size);for(let A=0;A<=E.length-1;A++){const M=E[A],P=await rA(M);if(!P)continue;const we={name:P.singer,created_at:""},ne={...Kx(we),id:""},he={name:P.name,singers:[ne],duration:Math.floor(P.duration),size:Math.floor(M.size/1024)},ge=P.image?new Blob([P.image]):null;ge&&(_.push(ge),he.image_url=URL.createObjectURL(ge));const H=Wx({...he,owner_email:n.email,distributor:n.display_name});if(k(H)){console.log(">>>duplicate");continue}I.push(H),S.push(A)}if(s.length+S.length>20)throw p("You have reach the upload limit"),new Error("Limit");if(!I.length)return;u(I),l(!0);for(let A=0;A<S.length;A++){const M=S[A],P=_[A];let we;const ne={...I[A]},he=rd({file:E[M],folder:"/songs/",msg:"upload song file"});P&&(we=mi({blob:P}));const[ge,{fileId:H,url:K}]=await Promise.all([we,he]);if(Object.assign(ne,{song_file_id:H,song_url:K}),ge){const Oe={image_url:ge.image_url,image_file_id:ge.image_file_id,blurhash_encode:ge.blurhash_encode};Object.assign(ne,Oe)}const ee=await Is({collectionName:"Songs",data:ne,msg:">>> api: set song doc"}),be=await _l(ee);N.push(be.id);const Re={...be.data(),id:ee.id,queue_id:fo(4)};i(Oe=>[...Oe,Re]),u(Oe=>{const kn=[...Oe];return kn.shift(),kn})}const C={liked_song_ids:[...N,...n.liked_song_ids]};await je({collectionName:"Users",data:C,id:n.email}),r({...n,...C}),o.current=!0,e(`${I.length} songs uploaded`);const R=Date.now()}catch(S){console.log({message:S}),t(m)}finally{x()}};return h.useEffect(()=>{if(!c)return;const v=document.querySelector(".temp-song");v&&v.scrollIntoView({behavior:"smooth",block:"center"})},[c]),{handleInputChange:w,inputRef:g}}function gZ(){const{handleInputChange:t,inputRef:e}=pZ(),n={container:"upload portal fixed z-[199] bottom-[120px] right-[30px] max-[549px]:bottom-[unset] max-[540px]:top-[10px] max-[540px]:right-[10px]"};return a.jsx(a.Fragment,{children:so.createPortal(a.jsx("div",{className:n.container,children:a.jsx("input",{ref:e,onChange:t,type:"file",multiple:!0,accept:"audio",id:"song_upload",className:"hidden"})}),document.getElementById("portals"))})}function xZ({children:t}){const{theme:e,isOnMobile:n}=is(),{isOpenFullScreen:r}=ht(),s=h.useRef(null),i={page:"md:flex md:h-screen bg-[--layout-cl] text-[--text-cl] transition-[color]",container:"main-container pt-5 overflow-x-hidden md:pt-0 md:h-full md:w-full md:flex md:flex-col px-[10px] md:px-[40px] md:pt-[60px] md:overflow-auto "};return h.useEffect(()=>{const o=document.querySelector(".my-tag"),l=document.querySelector("body");l&&(l.setAttribute("data-theme",e.id),e.type==="dark"?l.classList.add("dark"):l.classList.remove("dark"),r?l.classList.add("full-screen"):l.classList.remove("full-screen"),n&&(l.style.backgroundColor="var(--layout-cl)")),o&&o.setAttribute("content",e.container)},[e]),h.useEffect(()=>{const o=document.querySelector("body");o&&(r?o.classList.add("full-screen"):o.classList.remove("full-screen"))},[r]),a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:`${i.page}`,children:[!n&&a.jsx(fZ,{}),a.jsxs("div",{ref:s,className:`${i.container}`,children:[!n&&a.jsx(mZ,{contentRef:s}),t]}),a.jsx(dZ,{})]}),a.jsx(CA,{className:"left-[50%] translate-x-[-50%] top-[10px] md:top-[unset] md:bottom-[100px] md:left-[20px] md:translate-x-0"}),a.jsx(gZ,{}),!n&&a.jsx(wC,{})]})}function yZ(){return a.jsx($$,{children:a.jsx(_C,{children:a.jsx(xZ,{children:a.jsx(pm,{})})})})}function i0({children:t}){return t}function vZ(){return a.jsx(a.Fragment,{children:a.jsx(R4,{children:a.jsxs(b4,{children:[a.jsx(Hr,{path:"*",element:a.jsx(sW,{})}),a.jsx(Hr,{path:"/unauthorized",element:a.jsx(iW,{})}),a.jsx(Hr,{path:"/login",element:a.jsx(aW,{})}),a.jsxs(Hr,{element:a.jsx(yZ,{}),children:[lJ.map((t,e)=>{const n=t.layout||i0,r=t.component;return a.jsx(Hr,{path:t.path,element:a.jsx(n,{children:a.jsx(r,{})})},e)}),a.jsx(Hr,{element:a.jsx(dJ,{}),children:cJ.map((t,e)=>{const n=t.layout||i0,r=t.component;return a.jsx(Hr,{path:t.path,element:a.jsx(n,{children:a.jsx(r,{})})},e)})})]}),a.jsx(Hr,{element:a.jsx(hJ,{}),children:a.jsx(Hr,{element:a.jsx(yJ,{}),children:uJ.map((t,e)=>{const n=t.layout||i0,r=t.component;return a.jsx(Hr,{path:t.path,element:a.jsx(n,{children:a.jsx(r,{})})},e)})})})]})})})}const wZ=gV({reducer:{currentPlaylist:uU,playStatus:CV,songQueue:FV},middleware:t=>t({serializableCheck:!1})});function _Z(){const{setUser:t,setLoading:e,loading:n,user:r}=pe(),s=h.useRef(!1),i=async()=>{na.onAuthStateChanged(async o=>{if(o&&o.email){const l=await Gt({collectionName:"Users",id:o.email,msg:"usePersistAuth, get user"}),c=l.data(),u={email:o.email,display_name:o.displayName,photo_url:o.photoURL,liked_song_ids:(c==null?void 0:c.liked_song_ids)||[],recent_playlist_ids:(c==null?void 0:c.recent_playlist_ids)||[],recent_song_ids:(c==null?void 0:c.recent_song_ids)||[],liked_singer_ids:(c==null?void 0:c.liked_singer_ids)||[],role:(c==null?void 0:c.role)||"USER",liked_playlist_ids:(c==null?void 0:c.liked_playlist_ids)||[],liked_comment_ids:It().liked_comment_ids||[],last_seen:""};l.exists()?je({collectionName:"Users",id:u.email,data:{last_seen:st()},msg:"usePersistAuth, update user doc"}):await Nx(it(oe,"Users",u.email),u),t(u)}else t(null);e(!1)})};return h.useEffect(()=>{s.current||(s.current=!0,i())},[]),{user:r,loading:n}}function SZ({children:t}){return _Z(),t}a0.createRoot(document.getElementById("root")).render(a.jsx(RE.StrictMode,{children:a.jsx(eU,{store:wZ,children:a.jsx(lD,{children:a.jsx(I$,{children:a.jsx(dD,{children:a.jsx(R$,{children:a.jsx(M$,{children:a.jsx(A$,{children:a.jsx(SZ,{children:a.jsx(vZ,{})})})})})})})})})}));
